;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	254492640E89F15F3A0706AF18D48172
; Input	CRC32 :	659A665A

; File Name   :	C:\compspace\compare\pidgin\dlls\full\softokn3_full.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 0002289A ( 141466.)
; Section size in file		: 00022A00 ( 141824.)
; Offset to raw	data for section: 00000400
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; CODE XREF: sub_10003C60+AAp

var_124		= byte ptr -124h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 124h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+124h+var_4], eax
		push	ebx
		mov	ebx, [esp+128h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+130h+arg_C]
		xor	eax, eax
		push	edi
		mov	edi, [esp+134h+arg_10]
		test	edi, edi
		setnz	al
		lea	ebp, [eax+eax+1]
		test	edi, edi
		jnz	short loc_1000105F
		test	esi, esi
		jz	short loc_1000105F
		mov	ecx, [esi]
		push	ecx
		push	offset aPhobject ; "phObject"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	edx, [esp+140h+var_124]
		push	20h
		push	edx
		call	ds:PR_snprintf
		add	esp, 14h
		jmp	short loc_10001064
; ---------------------------------------------------------------------------

loc_1000105F:				; CODE XREF: sub_10001000+3Aj
					; sub_10001000+3Ej
		mov	[esp+134h+var_124], 0

loc_10001064:				; CODE XREF: sub_10001000+5Dj
		mov	ecx, [esp+134h+arg_8]
		mov	edx, [esp+134h+arg_0]
		lea	eax, [esp+134h+var_124]
		push	eax
		push	edi
		push	esi
		push	ecx
		push	ebx
		push	edx
		push	offset aC_createobject ; "C_CreateObject(hSession=0x%08lX, pTempl"...
		lea	eax, [esp+150h+var_104]
		push	100h
		push	eax
		call	ds:PR_snprintf
		lea	ecx, [esp+158h+var_104]
		push	ecx
		push	0Bh
		push	ebp
		call	nullsub_1
		mov	ecx, [esp+164h+var_4]
		add	esp, 30h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 124h
		retn
sub_10001000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100010C0	proc near		; CODE XREF: sub_10003D20+7Cp

var_124		= byte ptr -124h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 124h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+124h+var_4], eax
		push	ebx
		mov	ebx, [esp+128h+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+130h+arg_10]
		xor	eax, eax
		push	edi
		mov	edi, [esp+134h+arg_14]
		test	edi, edi
		setnz	al
		lea	ebp, [eax+eax+1]
		test	edi, edi
		jnz	short loc_1000111F
		test	esi, esi
		jz	short loc_1000111F
		mov	ecx, [esi]
		push	ecx
		push	offset aPhnewobject ; "phNewObject"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	edx, [esp+140h+var_124]
		push	20h
		push	edx
		call	ds:PR_snprintf
		add	esp, 14h
		jmp	short loc_10001124
; ---------------------------------------------------------------------------

loc_1000111F:				; CODE XREF: sub_100010C0+3Aj
					; sub_100010C0+3Ej
		mov	[esp+134h+var_124], 0

loc_10001124:				; CODE XREF: sub_100010C0+5Dj
		mov	ecx, [esp+134h+arg_C]
		mov	edx, [esp+134h+arg_4]
		lea	eax, [esp+134h+var_124]
		push	eax
		mov	eax, [esp+138h+arg_0]
		push	edi
		push	esi
		push	ecx
		push	ebx
		push	edx
		push	eax
		push	offset aC_copyobjectHs ; "C_CopyObject(hSession=0x%08lX, hObject="...
		lea	ecx, [esp+154h+var_104]
		push	100h
		push	ecx
		call	ds:PR_snprintf
		lea	edx, [esp+15Ch+var_104]
		push	edx
		push	2
		push	ebp
		call	nullsub_1
		mov	ecx, [esp+168h+var_4]
		add	esp, 34h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 124h
		retn
sub_100010C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001190	proc near		; CODE XREF: sub_10003DB0+61p

var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 104h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	eax, [esp+104h+arg_4]
		mov	ecx, [esp+104h+arg_0]
		push	esi
		mov	esi, [esp+108h+arg_8]
		push	esi
		push	eax
		push	ecx
		push	offset aC_destroyobjec ; "C_DestroyObject(hSession=0x%08lX, hObje"...
		lea	edx, [esp+118h+var_104]
		push	100h
		push	edx
		call	ds:PR_snprintf
		xor	ecx, ecx
		test	esi, esi
		setnz	cl
		lea	eax, [esp+120h+var_104]
		push	eax
		push	5
		lea	ecx, [ecx+ecx+1]
		push	ecx
		call	nullsub_1
		mov	ecx, [esp+12Ch+var_4]
		add	esp, 24h
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
sub_10001190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001210	proc near		; CODE XREF: sub_10003E20+68p

var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 104h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	eax, [esp+104h+arg_8]
		mov	ecx, [esp+104h+arg_0]
		push	esi
		mov	esi, [esp+108h+arg_C]
		push	esi
		push	eax
		mov	eax, [esp+110h+arg_4]
		push	eax
		push	ecx
		push	offset aC_getobjectsiz ; "C_GetObjectSize(hSession=0x%08lX, hObje"...
		lea	edx, [esp+11Ch+var_104]
		push	100h
		push	edx
		call	ds:PR_snprintf
		xor	ecx, ecx
		test	esi, esi
		setnz	cl
		lea	eax, [esp+124h+var_104]
		push	eax
		push	0
		lea	ecx, [ecx+ecx+1]
		push	ecx
		call	nullsub_1
		mov	ecx, [esp+130h+var_4]
		add	esp, 28h
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
sub_10001210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001290	proc near		; CODE XREF: sub_10003EA0+72p

var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 104h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	ecx, [esp+104h+arg_C]
		mov	eax, [esp+104h+arg_8]
		mov	edx, [esp+104h+arg_4]
		push	esi
		mov	esi, [esp+108h+arg_10]
		push	esi
		push	ecx
		push	eax
		mov	eax, [esp+114h+arg_0]
		push	edx
		push	eax
		push	offset aC_getattribute ; "C_GetAttributeValue(hSession=0x%08lX,	h"...
		lea	ecx, [esp+120h+var_104]
		push	100h
		push	ecx
		call	ds:PR_snprintf
		xor	eax, eax
		test	esi, esi
		setnz	al
		lea	edx, [esp+128h+var_104]
		push	edx
		push	0
		lea	eax, [eax+eax+1]
		push	eax
		call	nullsub_1
		mov	ecx, [esp+134h+var_4]
		add	esp, 2Ch
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
sub_10001290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001320	proc near		; CODE XREF: sub_10003F30+72p

var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 104h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	ecx, [esp+104h+arg_C]
		mov	eax, [esp+104h+arg_8]
		mov	edx, [esp+104h+arg_4]
		push	esi
		mov	esi, [esp+108h+arg_10]
		push	esi
		push	ecx
		push	eax
		mov	eax, [esp+114h+arg_0]
		push	edx
		push	eax
		push	offset aC_setattribute ; "C_SetAttributeValue(hSession=0x%08lX,	h"...
		lea	ecx, [esp+120h+var_104]
		push	100h
		push	ecx
		call	ds:PR_snprintf
		xor	eax, eax
		test	esi, esi
		setnz	al
		lea	edx, [esp+128h+var_104]
		push	edx
		push	1
		lea	eax, [eax+eax+1]
		push	eax
		call	nullsub_1
		mov	ecx, [esp+134h+var_4]
		add	esp, 2Ch
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
sub_10001320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100013B0	proc near		; CODE XREF: sub_10004050+4Dp
					; sub_10004140+4Dp ...

var_144		= byte ptr -144h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 144h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+144h+var_4], eax
		mov	eax, [esp+144h+arg_8]
		push	ebx
		mov	ebx, [esp+148h+arg_10]
		xor	ecx, ecx
		test	ebx, ebx
		setnz	cl
		push	ebp
		push	esi
		mov	esi, ds:PR_snprintf
		push	edi
		mov	edi, [esp+154h+arg_0]
		lea	ebp, [ecx+ecx+1]
		test	eax, eax
		jz	short loc_10001409
		mov	edx, [eax]
		push	edx
		push	eax
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	eax, [esp+160h+var_144]
		push	40h
		push	eax
		call	esi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_1000141C
; ---------------------------------------------------------------------------

loc_10001409:				; CODE XREF: sub_100013B0+40j
		push	0
		push	offset aP	; "%p"
		lea	ecx, [esp+15Ch+var_144]
		push	40h
		push	ecx
		call	esi ; PR_snprintf
		add	esp, 10h

loc_1000141C:				; CODE XREF: sub_100013B0+57j
		mov	edx, [esp+154h+arg_C]
		mov	ecx, [esp+154h+arg_4]
		push	ebx
		push	edx
		lea	eax, [esp+15Ch+var_144]
		push	eax
		push	ecx
		push	edi
		push	offset aC_SinitHsessio ; "C_%sInit(hSession=0x%08lX, pMechanism=%"...
		lea	edx, [esp+16Ch+var_104]
		push	100h
		push	edx
		call	esi ; PR_snprintf
		lea	eax, [esp+174h+var_104]
		push	eax
		push	3
		push	ebp
		call	nullsub_1
		mov	ecx, [esp+180h+var_4]
		add	esp, 2Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 144h
		retn
sub_100013B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001470	proc near		; CODE XREF: sub_100045B0+75p

var_168		= dword	ptr -168h
var_164		= byte ptr -164h
var_144		= byte ptr -144h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 168h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+168h+var_4], eax
		mov	eax, [esp+168h+arg_4]
		push	ebx
		mov	ebx, [esp+16Ch+arg_14]
		xor	ecx, ecx
		test	ebx, ebx
		setnz	cl
		push	ebp
		mov	ebp, [esp+170h+arg_8]
		push	esi
		mov	esi, [esp+174h+arg_10]
		push	edi
		mov	edi, ds:PR_snprintf
		lea	ecx, [ecx+ecx+1]
		mov	[esp+178h+var_168], ecx
		test	eax, eax
		jz	short loc_100014D4
		mov	edx, [eax]
		push	edx
		push	eax
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	eax, [esp+184h+var_144]
		push	40h
		push	eax
		call	edi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_100014E7
; ---------------------------------------------------------------------------

loc_100014D4:				; CODE XREF: sub_10001470+4Bj
		push	0
		push	offset aP	; "%p"
		lea	ecx, [esp+180h+var_144]
		push	40h
		push	ecx
		call	edi ; PR_snprintf
		add	esp, 10h

loc_100014E7:				; CODE XREF: sub_10001470+62j
		test	ebx, ebx
		jnz	short loc_1000150A
		test	esi, esi
		jz	short loc_1000150A
		mov	edx, [esi]
		push	edx
		push	offset aPhkey	; "phKey"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	eax, [esp+184h+var_164]
		push	20h
		push	eax
		call	edi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_1000150F
; ---------------------------------------------------------------------------

loc_1000150A:				; CODE XREF: sub_10001470+79j
					; sub_10001470+7Dj
		mov	[esp+178h+var_164], 0

loc_1000150F:				; CODE XREF: sub_10001470+98j
		mov	edx, [esp+178h+arg_C]
		lea	ecx, [esp+178h+var_164]
		push	ecx
		mov	ecx, [esp+17Ch+arg_0]
		push	ebx
		push	esi
		push	edx
		push	ebp
		lea	eax, [esp+18Ch+var_144]
		push	eax
		push	ecx
		push	offset aC_generatekeyH ; "C_GenerateKey(hSession=0x%08lX, pMechan"...
		lea	edx, [esp+198h+var_104]
		push	100h
		push	edx
		call	edi ; PR_snprintf
		mov	ecx, [esp+1A0h+var_168]
		lea	eax, [esp+1A0h+var_104]
		push	eax
		push	8
		push	ecx
		call	nullsub_1
		mov	ecx, [esp+1ACh+var_4]
		add	esp, 34h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 168h
		retn
sub_10001470	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001570	proc near		; CODE XREF: sub_10004650+A2p

var_290		= dword	ptr -290h
var_28C		= dword	ptr -28Ch
var_288		= dword	ptr -288h
var_284		= byte ptr -284h
var_264		= byte ptr -264h
var_244		= byte ptr -244h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 290h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+290h+var_4], eax
		mov	ecx, [esp+290h+arg_8]
		mov	eax, [esp+290h+arg_4]
		mov	edx, [esp+290h+arg_10]
		push	ebx
		mov	ebx, [esp+294h+arg_20]
		mov	[esp+294h+var_290], ecx
		xor	ecx, ecx
		test	ebx, ebx
		setnz	cl
		push	ebp
		mov	ebp, [esp+298h+arg_1C]
		push	esi
		mov	esi, ds:PR_snprintf
		push	edi
		mov	edi, [esp+2A0h+arg_18]
		lea	ecx, [ecx+ecx+1]
		mov	[esp+2A0h+var_28C], edx
		mov	[esp+2A0h+var_288], ecx
		test	eax, eax
		jz	short loc_100015EA
		mov	edx, [eax]
		push	edx
		push	eax
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	eax, [esp+2ACh+var_244]
		push	40h
		push	eax
		call	esi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_100015FD
; ---------------------------------------------------------------------------

loc_100015EA:				; CODE XREF: sub_10001570+61j
		push	0
		push	offset aP	; "%p"
		lea	ecx, [esp+2A8h+var_244]
		push	40h
		push	ecx
		call	esi ; PR_snprintf
		add	esp, 10h

loc_100015FD:				; CODE XREF: sub_10001570+78j
		test	ebx, ebx
		jnz	short loc_10001620
		test	edi, edi
		jz	short loc_10001620
		mov	edx, [edi]
		push	edx
		push	offset aPhpublickey ; "phPublicKey"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	eax, [esp+2ACh+var_264]
		push	20h
		push	eax
		call	esi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_10001629
; ---------------------------------------------------------------------------

loc_10001620:				; CODE XREF: sub_10001570+8Fj
					; sub_10001570+93j
		mov	[esp+2A0h+var_264], 0
		test	ebx, ebx
		jnz	short loc_10001649

loc_10001629:				; CODE XREF: sub_10001570+AEj
		test	ebp, ebp
		jz	short loc_10001649
		mov	ecx, [ebp+0]
		push	ecx
		push	offset aPhprivatekey ; "phPrivateKey"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	edx, [esp+2ACh+var_284]
		push	20h
		push	edx
		call	esi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_1000164E
; ---------------------------------------------------------------------------

loc_10001649:				; CODE XREF: sub_10001570+B7j
					; sub_10001570+BBj
		mov	[esp+2A0h+var_284], 0

loc_1000164E:				; CODE XREF: sub_10001570+D7j
		mov	edx, [esp+2A0h+arg_14]
		lea	eax, [esp+2A0h+var_284]
		push	eax
		mov	eax, [esp+2A4h+var_28C]
		lea	ecx, [esp+2A4h+var_264]
		push	ecx
		mov	ecx, [esp+2A8h+arg_C]
		push	ebx
		push	ebp
		push	edi
		push	edx
		mov	edx, [esp+2B8h+var_290]
		push	eax
		push	ecx
		mov	ecx, [esp+2C0h+arg_0]
		push	edx
		lea	eax, [esp+2C4h+var_244]
		push	eax
		push	ecx
		push	offset aC_generatekeyp ; "C_GenerateKeyPair(hSession=0x%08lX, pMe"...
		lea	edx, [esp+2D0h+var_204]
		push	200h
		push	edx
		call	esi ; PR_snprintf
		mov	ecx, [esp+2D8h+var_288]
		lea	eax, [esp+2D8h+var_204]
		push	eax
		push	8
		push	ecx
		call	nullsub_1
		mov	ecx, [esp+2E4h+var_4]
		add	esp, 44h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 290h
		retn
sub_10001570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100016D0	proc near		; CODE XREF: sub_10004720+66p

var_148		= dword	ptr -148h
var_144		= byte ptr -144h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 148h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+148h+var_4], eax
		mov	eax, [esp+148h+arg_4]
		push	ebx
		mov	ebx, [esp+14Ch+arg_14]
		push	ebp
		mov	ebp, [esp+150h+arg_18]
		xor	ecx, ecx
		test	ebp, ebp
		setnz	cl
		push	esi
		mov	esi, ds:PR_snprintf
		push	edi
		mov	edi, [esp+158h+arg_10]
		lea	ecx, [ecx+ecx+1]
		mov	[esp+158h+var_148], ecx
		test	eax, eax
		jz	short loc_10001734
		mov	edx, [eax]
		push	edx
		push	eax
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	eax, [esp+164h+var_144]
		push	40h
		push	eax
		call	esi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_10001747
; ---------------------------------------------------------------------------

loc_10001734:				; CODE XREF: sub_100016D0+4Bj
		push	0
		push	offset aP	; "%p"
		lea	ecx, [esp+160h+var_144]
		push	40h
		push	ecx
		call	esi ; PR_snprintf
		add	esp, 10h

loc_10001747:				; CODE XREF: sub_100016D0+62j
		mov	edx, [esp+158h+arg_C]
		mov	eax, [esp+158h+arg_8]
		push	ebp
		push	ebx
		push	edi
		push	edx
		mov	edx, [esp+168h+arg_0]
		push	eax
		lea	ecx, [esp+16Ch+var_144]
		push	ecx
		push	edx
		push	offset aC_wrapkeyHsess ; "C_WrapKey(hSession=0x%08lX, pMechanism="...
		lea	eax, [esp+178h+var_104]
		push	100h
		push	eax
		call	esi ; PR_snprintf
		mov	edx, [esp+180h+var_148]
		lea	ecx, [esp+180h+var_104]
		push	ecx
		push	11h
		push	edx
		call	nullsub_1
		mov	ecx, [esp+18Ch+var_4]
		add	esp, 34h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 148h
		retn
sub_100016D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100017B0	proc near		; CODE XREF: sub_100047A0+93p

var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= byte ptr -164h
var_144		= byte ptr -144h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 16Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+16Ch+var_4], eax
		mov	eax, [esp+16Ch+arg_4]
		mov	ecx, [esp+16Ch+arg_14]
		push	ebx
		mov	ebx, ds:PR_snprintf
		push	ebp
		mov	ebp, [esp+174h+arg_C]
		push	esi
		mov	esi, [esp+178h+arg_1C]
		xor	edx, edx
		push	edi
		mov	edi, [esp+17Ch+arg_20]
		test	edi, edi
		setnz	dl
		mov	[esp+17Ch+var_16C], ecx
		lea	edx, [edx+edx+1]
		mov	[esp+17Ch+var_168], edx
		test	eax, eax
		jz	short loc_1000181F
		mov	ecx, [eax]
		push	ecx
		push	eax
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	edx, [esp+188h+var_144]
		push	40h
		push	edx
		call	ebx ; PR_snprintf
		add	esp, 14h
		jmp	short loc_10001832
; ---------------------------------------------------------------------------

loc_1000181F:				; CODE XREF: sub_100017B0+56j
		push	0
		push	offset aP	; "%p"
		lea	eax, [esp+184h+var_144]
		push	40h
		push	eax
		call	ebx ; PR_snprintf
		add	esp, 10h

loc_10001832:				; CODE XREF: sub_100017B0+6Dj
		test	edi, edi
		jnz	short loc_10001855
		test	esi, esi
		jz	short loc_10001855
		mov	ecx, [esi]
		push	ecx
		push	offset aPhkey	; "phKey"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	edx, [esp+188h+var_164]
		push	20h
		push	edx
		call	ebx ; PR_snprintf
		add	esp, 14h
		jmp	short loc_1000185A
; ---------------------------------------------------------------------------

loc_10001855:				; CODE XREF: sub_100017B0+84j
					; sub_100017B0+88j
		mov	[esp+17Ch+var_164], 0

loc_1000185A:				; CODE XREF: sub_100017B0+A3j
		mov	ecx, [esp+17Ch+arg_18]
		mov	edx, [esp+17Ch+var_16C]
		lea	eax, [esp+17Ch+var_164]
		push	eax
		mov	eax, [esp+180h+arg_10]
		push	edi
		push	esi
		push	ecx
		mov	ecx, [esp+18Ch+arg_8]
		push	edx
		push	eax
		mov	eax, [esp+194h+arg_0]
		push	ebp
		push	ecx
		lea	edx, [esp+19Ch+var_144]
		push	edx
		push	eax
		push	offset aC_unwrapkeyHse ; "C_UnwrapKey(hSession=0x%08lX,	pMechanis"...
		lea	ecx, [esp+1A8h+var_104]
		push	100h
		push	ecx
		call	ebx ; PR_snprintf
		mov	eax, [esp+1B0h+var_168]
		lea	edx, [esp+1B0h+var_104]
		push	edx
		push	10h
		push	eax
		call	nullsub_1
		mov	ecx, [esp+1BCh+var_4]
		add	esp, 40h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 16Ch
		retn
sub_100017B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100018D0	proc near		; CODE XREF: sub_10004860+7Fp

var_2EC		= dword	ptr -2ECh
var_2E8		= dword	ptr -2E8h
var_2E4		= byte ptr -2E4h
var_2C4		= byte ptr -2C4h
var_284		= byte ptr -284h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 2ECh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2ECh+var_4], eax
		mov	eax, [esp+2ECh+arg_C]
		push	ebx
		mov	ebx, [esp+2F0h+arg_18]
		xor	ecx, ecx
		test	ebx, ebx
		setnz	cl
		push	ebp
		mov	ebp, [esp+2F4h+arg_14]
		push	esi
		mov	esi, [esp+2F8h+arg_4]
		push	edi
		mov	edi, ds:PR_snprintf
		lea	ecx, [ecx+ecx+1]
		mov	[esp+2FCh+var_2EC], eax
		mov	[esp+2FCh+var_2E8], ecx
		test	esi, esi
		jz	short loc_10001938
		mov	edx, [esi]
		push	edx
		push	esi
		push	offset aPMechanism0x08 ; "%p {mechanism=0x%08lX, ...}"
		lea	eax, [esp+308h+var_2C4]
		push	40h
		push	eax
		call	edi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_1000194B
; ---------------------------------------------------------------------------

loc_10001938:				; CODE XREF: sub_100018D0+4Fj
		push	0
		push	offset aP	; "%p"
		lea	ecx, [esp+304h+var_2C4]
		push	40h
		push	ecx
		call	edi ; PR_snprintf
		add	esp, 10h

loc_1000194B:				; CODE XREF: sub_100018D0+66j
		test	ebx, ebx
		jnz	short loc_1000196F
		test	ebp, ebp
		jz	short loc_1000196F
		mov	edx, [ebp+0]
		push	edx
		push	offset aPhkey	; "phKey"
		push	offset aS0x08lx	; " *%s=0x%08lX"
		lea	eax, [esp+308h+var_2E4]
		push	20h
		push	eax
		call	edi ; PR_snprintf
		add	esp, 14h
		jmp	short loc_10001978
; ---------------------------------------------------------------------------

loc_1000196F:				; CODE XREF: sub_100018D0+7Dj
					; sub_100018D0+81j
		mov	[esp+2FCh+var_2E4], 0
		test	ebx, ebx
		jnz	short loc_100019AE

loc_10001978:				; CODE XREF: sub_100018D0+9Dj
		cmp	dword ptr [esi], 376h
		jnz	short loc_100019AE
		mov	ecx, [esi+4]
		mov	eax, [ecx+1Dh]
		mov	edx, [eax+0Ch]
		mov	ecx, [eax+8]
		push	edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		push	ecx
		push	edx
		push	eax
		push	offset aHclientmacsecr ; " hClientMacSecret=0x%08lX hServerMacSec"...
		lea	ecx, [esp+310h+var_284]
		push	80h
		push	ecx
		call	edi ; PR_snprintf
		add	esp, 1Ch
		jmp	short loc_100019B3
; ---------------------------------------------------------------------------

loc_100019AE:				; CODE XREF: sub_100018D0+A6j
					; sub_100018D0+AEj
		mov	[esp+2FCh+var_284], 0

loc_100019B3:				; CODE XREF: sub_100018D0+DCj
		mov	ecx, [esp+2FCh+arg_10]
		lea	edx, [esp+2FCh+var_284]
		push	edx
		mov	edx, [esp+300h+var_2EC]
		lea	eax, [esp+300h+var_2E4]
		push	eax
		mov	eax, [esp+304h+arg_8]
		push	ebx
		push	ebp
		push	ecx
		push	edx
		mov	edx, [esp+314h+arg_0]
		push	eax
		lea	ecx, [esp+318h+var_2C4]
		push	ecx
		push	edx
		push	offset aC_derivekeyHse ; "C_DeriveKey(hSession=0x%08lX,	pMechanis"...
		lea	eax, [esp+324h+var_204]
		push	200h
		push	eax
		call	edi ; PR_snprintf
		mov	edx, [esp+32Ch+var_2E8]
		lea	ecx, [esp+32Ch+var_204]
		push	ecx
		push	4
		push	edx
		call	nullsub_1
		mov	ecx, [esp+338h+var_4]
		add	esp, 3Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2ECh
		retn
sub_100018D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001A30	proc near		; CODE XREF: sub_10004B50+41p

var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 104h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	eax, [esp+104h+arg_4]
		mov	ecx, [esp+104h+arg_0]
		push	esi
		mov	esi, [esp+108h+arg_8]
		push	esi
		push	eax
		push	ecx
		push	offset aC_digestkeyHse ; "C_DigestKey(hSession=0x%08lX,	hKey=0x%0"...
		lea	edx, [esp+118h+var_104]
		push	100h
		push	edx
		call	ds:PR_snprintf
		xor	ecx, ecx
		test	esi, esi
		setnz	cl
		lea	eax, [esp+120h+var_104]
		push	eax
		push	6
		lea	ecx, [ecx+ecx+1]
		push	ecx
		call	nullsub_1
		mov	ecx, [esp+12Ch+var_4]
		add	esp, 24h
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
sub_10001A30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001AB0	proc near		; CODE XREF: sub_10003390p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	esi
		push	5
		push	0
		push	0
		push	5
		push	offset aRsarc	; "RSARC"
		call	sub_10020E60
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10001AED
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001AED:				; CODE XREF: sub_10001AB0+28j
		push	ebx
		push	edi
		mov	ebx, 8
		push	ebx
		push	offset aNetscape ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020EC0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020E90
		add	esp, 20h
		test	edi, edi
		jnz	loc_10001CDD
		cmp	[esp+28h+var_18], ebx
		jnz	loc_10001CDD
		mov	eax, ebx
		xor	ecx, ecx
		mov	edi, edi

loc_10001B30:				; CODE XREF: sub_10001AB0+99j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_1002489C[ecx]
		jnz	loc_10001CDD
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001B30
		push	5
		push	0
		push	0
		push	5
		push	offset aRsarc	; "RSARC"
		call	sub_10020E60
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	loc_10001C69
		push	ebx
		push	offset dword_1002489C
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020EF0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020E90
		add	esp, 20h
		test	edi, edi
		jnz	loc_10001CDD
		cmp	[esp+28h+var_1C], ebx
		jnz	loc_10001CDD
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10001BB0
; ---------------------------------------------------------------------------
		align 10h

loc_10001BB0:				; CODE XREF: sub_10001AB0+F4j
					; sub_10001AB0+119j
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape[ecx] ; "Netscape"
		jnz	loc_10001CDD
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001BB0
		push	5
		push	1
		push	offset aSecurity ; "Security"
		push	5
		push	offset aRsarc	; "RSARC"
		call	sub_10020E60
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	loc_10001C69
		push	ebx
		push	offset aNetscape_0 ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020EC0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020E90
		add	esp, 20h
		test	edi, edi
		jnz	loc_10001CDD
		cmp	[esp+28h+var_18], ebx
		jnz	loc_10001CDD
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10001C30
; ---------------------------------------------------------------------------
		align 10h

loc_10001C30:				; CODE XREF: sub_10001AB0+177j
					; sub_10001AB0+199j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_100248A4[ecx]
		jnz	loc_10001CDD
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001C30
		push	5
		push	1
		push	offset aSecurity ; "Security"
		push	5
		push	offset aRsarc	; "RSARC"
		call	sub_10020E60
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10001C80

loc_10001C69:				; CODE XREF: sub_10001AB0+B4j
					; sub_10001AB0+137j
		pop	edi
		pop	ebx
		mov	eax, 2
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001C80:				; CODE XREF: sub_10001AB0+1B7j
		push	ebx
		push	offset dword_100248A4
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020EF0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020E90
		add	esp, 20h
		test	edi, edi
		jnz	short loc_10001CDD
		cmp	[esp+28h+var_1C], ebx
		jnz	short loc_10001CDD
		mov	eax, ebx
		xor	ecx, ecx

loc_10001CB2:				; CODE XREF: sub_10001AB0+217j
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape[ecx] ; "Netscape"
		jnz	short loc_10001CDD
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001CB2
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001CDD:				; CODE XREF: sub_10001AB0+6Aj
					; sub_10001AB0+74j ...
		mov	ecx, [esp+28h+var_4]
		pop	edi
		pop	ebx
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10001AB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001D00	proc near		; CODE XREF: sub_10003390+Dp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	esi
		push	5
		push	offset aRsarc_0	; "RSARC"
		call	sub_10020DA0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10001D37
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001D37:				; CODE XREF: sub_10001D00+22j
		push	edi
		push	8
		push	offset aNetscape_1 ; "Netscape"
		push	8
		lea	eax, [esp+30h+var_18]
		push	eax
		lea	ecx, [esp+34h+var_14]
		push	ecx
		push	esi
		call	sub_10020E00
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020DD0
		add	esp, 20h
		test	edi, edi
		jnz	loc_10001E2A
		cmp	[esp+24h+var_18], 8
		jnz	loc_10001E2A
		lea	eax, [edi+8]
		xor	ecx, ecx
		jmp	short loc_10001D80
; ---------------------------------------------------------------------------
		align 10h

loc_10001D80:				; CODE XREF: sub_10001D00+76j
					; sub_10001D00+99j
		mov	edx, [esp+ecx+24h+var_14]
		cmp	edx, ds:dword_100248C0[ecx]
		jnz	loc_10001E2A
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001D80
		push	5
		push	offset aRsarc_0	; "RSARC"
		call	sub_10020DA0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10001DC4
		pop	edi
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001DC4:				; CODE XREF: sub_10001D00+AEj
		push	8
		push	offset dword_100248C0
		push	8
		lea	eax, [esp+30h+var_1C]
		push	eax
		lea	ecx, [esp+34h+var_C]
		push	ecx
		push	esi
		call	sub_10020E30
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020DD0
		add	esp, 20h
		test	edi, edi
		jnz	short loc_10001E2A
		cmp	[esp+24h+var_1C], 8
		jnz	short loc_10001E2A
		lea	eax, [edi+8]
		xor	ecx, ecx
		lea	ebx, [ebx+0]

loc_10001E00:				; CODE XREF: sub_10001D00+115j
		mov	edx, [esp+ecx+24h+var_C]
		cmp	edx, dword ptr ds:aNetscape_1[ecx] ; "Netscape"
		jnz	short loc_10001E2A
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001E00
		pop	edi
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001E2A:				; CODE XREF: sub_10001D00+60j
					; sub_10001D00+6Bj ...
		mov	ecx, [esp+24h+var_4]
		pop	edi
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10001D00	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001E40	proc near		; CODE XREF: sub_10003390+1Ap

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	esi
		push	1
		push	0
		push	0
		push	offset aAnsiDes	; "ANSI	DES"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10001E7B
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001E7B:				; CODE XREF: sub_10001E40+26j
		push	ebx
		push	edi
		mov	ebx, 8
		push	ebx
		push	offset aNetscape_2 ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000206B
		cmp	[esp+28h+var_18], ebx
		jnz	loc_1000206B
		mov	eax, ebx
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10001EC0:				; CODE XREF: sub_10001E40+99j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_100248F8[ecx]
		jnz	loc_1000206B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001EC0
		push	0
		push	0
		push	0
		push	offset aAnsiDes	; "ANSI	DES"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_10001FF7
		push	ebx
		push	offset dword_100248F8
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020FB0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000206B
		cmp	[esp+28h+var_1C], ebx
		jnz	loc_1000206B
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10001F40
; ---------------------------------------------------------------------------
		db 8Dh,	0A4h, 24h, 4 dup(0)
; ---------------------------------------------------------------------------
		jmp	short loc_10001F40
; ---------------------------------------------------------------------------
		align 10h

loc_10001F40:				; CODE XREF: sub_10001E40+F2j
					; sub_10001E40+FBj ...
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape_2[ecx] ; "Netscape"
		jnz	loc_1000206B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001F40
		push	1
		push	1
		push	offset aSecurity_0 ; "Security"
		push	offset aAnsiDes	; "ANSI	DES"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_10001FF7
		push	ebx
		push	offset aNetscape_3 ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000206B
		cmp	[esp+28h+var_18], ebx
		jnz	loc_1000206B
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10001FC0
; ---------------------------------------------------------------------------
		align 10h

loc_10001FC0:				; CODE XREF: sub_10001E40+175j
					; sub_10001E40+199j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_10024900[ecx]
		jnz	loc_1000206B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10001FC0
		push	0
		push	1
		push	offset aSecurity_0 ; "Security"
		push	offset aAnsiDes	; "ANSI	DES"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000200E

loc_10001FF7:				; CODE XREF: sub_10001E40+B2j
					; sub_10001E40+135j
		pop	edi
		pop	ebx
		mov	eax, 2
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000200E:				; CODE XREF: sub_10001E40+1B5j
		push	ebx
		push	offset dword_10024900
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020FB0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	short loc_1000206B
		cmp	[esp+28h+var_1C], ebx
		jnz	short loc_1000206B
		mov	eax, ebx
		xor	ecx, ecx

loc_10002040:				; CODE XREF: sub_10001E40+215j
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape_3[ecx] ; "Netscape"
		jnz	short loc_1000206B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002040
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000206B:				; CODE XREF: sub_10001E40+68j
					; sub_10001E40+72j ...
		mov	ecx, [esp+28h+var_4]
		pop	edi
		pop	ebx
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10001E40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002090	proc near		; CODE XREF: sub_10003390+27p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	esi
		push	1
		push	2
		push	0
		push	offset aAnsiTripleDesK ; "ANSI Triple-DES Key Data"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_100020CB
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100020CB:				; CODE XREF: sub_10002090+26j
		push	ebx
		push	edi
		mov	ebx, 8
		push	ebx
		push	offset aNetscape_4 ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_100022BB
		cmp	[esp+28h+var_18], ebx
		jnz	loc_100022BB
		mov	eax, ebx
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10002110:				; CODE XREF: sub_10002090+99j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_10024948[ecx]
		jnz	loc_100022BB
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002110
		push	0
		push	2
		push	0
		push	offset aAnsiTripleDesK ; "ANSI Triple-DES Key Data"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_10002247
		push	ebx
		push	offset dword_10024948
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020FB0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_100022BB
		cmp	[esp+28h+var_1C], ebx
		jnz	loc_100022BB
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10002190
; ---------------------------------------------------------------------------
		db 8Dh,	0A4h, 24h, 4 dup(0)
; ---------------------------------------------------------------------------
		jmp	short loc_10002190
; ---------------------------------------------------------------------------
		align 10h

loc_10002190:				; CODE XREF: sub_10002090+F2j
					; sub_10002090+FBj ...
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape_4[ecx] ; "Netscape"
		jnz	loc_100022BB
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002190
		push	1
		push	3
		push	offset aSecurity_1 ; "Security"
		push	offset aAnsiTripleDesK ; "ANSI Triple-DES Key Data"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_10002247
		push	ebx
		push	offset aNetscape_5 ; "Netscape"
		push	ebx
		lea	eax, [esp+34h+var_18]
		push	eax
		lea	ecx, [esp+38h+var_14]
		push	ecx
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_100022BB
		cmp	[esp+28h+var_18], ebx
		jnz	loc_100022BB
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10002210
; ---------------------------------------------------------------------------
		align 10h

loc_10002210:				; CODE XREF: sub_10002090+175j
					; sub_10002090+199j
		mov	edx, [esp+ecx+28h+var_14]
		cmp	edx, ds:dword_10024950[ecx]
		jnz	loc_100022BB
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002210
		push	0
		push	3
		push	offset aSecurity_1 ; "Security"
		push	offset aAnsiTripleDesK ; "ANSI Triple-DES Key Data"
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000225E

loc_10002247:				; CODE XREF: sub_10002090+B2j
					; sub_10002090+135j
		pop	edi
		pop	ebx
		mov	eax, 2
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000225E:				; CODE XREF: sub_10002090+1B5j
		push	ebx
		push	offset dword_10024950
		push	ebx
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		push	esi
		call	sub_10020FB0
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	short loc_100022BB
		cmp	[esp+28h+var_1C], ebx
		jnz	short loc_100022BB
		mov	eax, ebx
		xor	ecx, ecx

loc_10002290:				; CODE XREF: sub_10002090+215j
		mov	edx, [esp+ecx+28h+var_C]
		cmp	edx, dword ptr ds:aNetscape_5[ecx] ; "Netscape"
		jnz	short loc_100022BB
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002290
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100022BB:				; CODE XREF: sub_10002090+68j
					; sub_10002090+72j ...
		mov	ecx, [esp+28h+var_4]
		pop	edi
		pop	ebx
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10002090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100022E0	proc near		; CODE XREF: sub_10003390+36p
					; sub_10003390+44p ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 30h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+30h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+38h+arg_0]
		cmp	ebp, 10h
		jnz	short loc_10002338
		mov	ebx, offset dword_100249A4
		mov	[esp+38h+var_28], offset dword_100249B4

loc_10002306:				; CODE XREF: sub_100022E0+6Aj
					; sub_100022E0+7Cj
		push	esi
		push	10h
		push	ebp
		push	1
		push	0
		push	0
		push	offset aAes128Rijndael ; "AES-128 RIJNDAELLEADNJIR 821-SEA"
		call	sub_100210D0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jnz	short loc_10002374
		lea	eax, [esi+2]
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+30h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10002338:				; CODE XREF: sub_100022E0+17j
		cmp	ebp, 18h
		jnz	short loc_1000234C
		mov	ebx, offset dword_100249C4
		mov	[esp+38h+var_28], offset dword_100249D4
		jmp	short loc_10002306
; ---------------------------------------------------------------------------

loc_1000234C:				; CODE XREF: sub_100022E0+5Bj
		mov	ebx, offset dword_100249E4
		mov	[esp+38h+var_28], offset dword_100249F4
		cmp	ebp, 20h
		jz	short loc_10002306
		pop	ebp
		mov	eax, 30h
		pop	ebx
		mov	ecx, [esp+30h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10002374:				; CODE XREF: sub_100022E0+41j
		push	edi
		push	10h
		push	offset aNetscapeepacst ; "NetscapeepacsteN"
		push	10h
		lea	eax, [esp+4Ch+var_2C]
		push	eax
		lea	ecx, [esp+50h+var_24]
		push	ecx
		push	esi
		call	sub_10021130
		push	1
		push	esi
		mov	edi, eax
		call	sub_10021100
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000256C
		cmp	[esp+40h+var_2C], 10h
		jnz	loc_1000256C
		lea	edx, [esp+40h+var_24]
		lea	ecx, [edi+10h]
		mov	eax, ebx
		sub	edx, ebx
		lea	esp, [esp+0]

loc_100023C0:				; CODE XREF: sub_100022E0+F4j
		mov	esi, [edx+eax]
		cmp	esi, [eax]
		jnz	loc_1000256C
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_100023C0
		push	10h
		push	ebp
		push	0
		push	0
		push	0
		push	offset aAes128Rijndael ; "AES-128 RIJNDAELLEADNJIR 821-SEA"
		call	sub_100210D0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	loc_100024F4
		push	10h
		push	ebx
		push	10h
		lea	edx, [esp+4Ch+var_30]
		push	edx
		lea	eax, [esp+50h+var_14]
		push	eax
		push	esi
		call	sub_10021170
		push	1
		push	esi
		mov	edi, eax
		call	sub_10021100
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000256C
		mov	ebx, 10h
		cmp	[esp+40h+var_30], ebx
		jnz	loc_1000256C
		mov	eax, ebx
		xor	ecx, ecx
		jmp	short loc_10002440
; ---------------------------------------------------------------------------
		align 10h

loc_10002440:				; CODE XREF: sub_100022E0+153j
					; sub_100022E0+179j
		mov	edx, [esp+ecx+40h+var_14]
		cmp	edx, dword ptr ds:aNetscapeepacst[ecx] ; "NetscapeepacsteN"
		jnz	loc_1000256C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002440
		push	ebx
		push	ebp
		push	1
		push	1
		push	offset aSecurityytiruc ; "SecurityytiruceS"
		push	offset aAes128Rijndael ; "AES-128 RIJNDAELLEADNJIR 821-SEA"
		call	sub_100210D0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_100024F4
		push	ebx
		push	offset aNetscapeepacst ; "NetscapeepacsteN"
		push	ebx
		lea	eax, [esp+4Ch+var_2C]
		push	eax
		lea	ecx, [esp+50h+var_24]
		push	ecx
		push	esi
		call	sub_10021130
		push	1
		push	esi
		mov	edi, eax
		call	sub_10021100
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000256C
		cmp	[esp+40h+var_2C], ebx
		jnz	loc_1000256C
		mov	edi, [esp+40h+var_28]
		lea	edx, [esp+40h+var_24]
		mov	ecx, ebx
		mov	eax, edi
		sub	edx, edi
		lea	ecx, [ecx+0]

loc_100024C0:				; CODE XREF: sub_100022E0+1F4j
		mov	esi, [edx+eax]
		cmp	esi, [eax]
		jnz	loc_1000256C
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_100024C0
		push	ebx
		push	ebp
		push	0
		push	1
		push	offset aSecurityytiruc ; "SecurityytiruceS"
		push	offset aAes128Rijndael ; "AES-128 RIJNDAELLEADNJIR 821-SEA"
		call	sub_100210D0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jnz	short loc_1000250C

loc_100024F4:				; CODE XREF: sub_100022E0+110j
					; sub_100022E0+197j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		mov	ecx, [esp+30h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000250C:				; CODE XREF: sub_100022E0+212j
		push	ebx
		push	edi
		push	ebx
		lea	edx, [esp+4Ch+var_30]
		push	edx
		lea	eax, [esp+50h+var_14]
		push	eax
		push	esi
		call	sub_10021170
		push	1
		push	esi
		mov	edi, eax
		call	sub_10021100
		add	esp, 20h
		test	edi, edi
		jnz	short loc_1000256C
		cmp	[esp+40h+var_30], ebx
		jnz	short loc_1000256C
		mov	eax, ebx
		xor	ecx, ecx
		lea	ebx, [ebx+0]

loc_10002540:				; CODE XREF: sub_100022E0+275j
		mov	edx, [esp+ecx+40h+var_14]
		cmp	edx, dword ptr ds:aNetscapeepacst[ecx] ; "NetscapeepacsteN"
		jnz	short loc_1000256C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002540
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+30h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000256C:				; CODE XREF: sub_100022E0+BDj
					; sub_100022E0+C8j ...
		mov	ecx, [esp+40h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn
sub_100022E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002590	proc near		; CODE XREF: sub_10003390+5Ep

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4

		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		push	esi
		call	sub_10021320
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100025BD
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_100025BD:				; CODE XREF: sub_10002590+18j
		push	esi
		call	sub_10021380
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	esi
		call	sub_100213B0
		push	10h
		lea	eax, [esp+30h+var_18]
		push	eax
		lea	ecx, [esp+34h+var_14]
		push	ecx
		push	esi
		call	sub_100213E0
		push	1
		push	esi
		call	sub_10021350
		add	esp, 28h
		cmp	[esp+1Ch+var_18], 10h
		jnz	short loc_10002629
		mov	eax, 10h
		xor	ecx, ecx
		jmp	short loc_10002600
; ---------------------------------------------------------------------------
		align 10h

loc_10002600:				; CODE XREF: sub_10002590+6Bj
					; sub_10002590+85j
		mov	edx, [esp+ecx+1Ch+var_14]
		cmp	edx, ds:dword_10024A5C[ecx]
		jnz	short loc_10002629
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002600
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10002629:				; CODE XREF: sub_10002590+62j
					; sub_10002590+7Aj
		mov	ecx, [esp+1Ch+var_4]
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
sub_10002590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002640	proc near		; CODE XREF: sub_10003390+67p

var_14		= dword	ptr -14h
var_4		= dword	ptr -4

		sub	esp, 14h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+14h+var_4], eax
		push	40h
		lea	eax, [esp+18h+var_14]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_100211B0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10002697
		mov	eax, 10h
		xor	ecx, ecx
		lea	ecx, [ecx+0]

loc_10002670:				; CODE XREF: sub_10002640+44j
		mov	edx, [esp+ecx+14h+var_14]
		cmp	edx, ds:dword_10024A6C[ecx]
		jnz	short loc_10002697
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002670
		xor	eax, eax
		mov	ecx, [esp+14h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10002697:				; CODE XREF: sub_10002640+24j
					; sub_10002640+39j
		mov	ecx, [esp+14h+var_4]
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 14h
		retn
sub_10002640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100026B0	proc near		; CODE XREF: sub_10002740+24p
					; DATA XREF: sub_10003390-30o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		mov	eax, [esp+4+arg_14]
		push	edi
		push	eax
		mov	[esp+0Ch+var_4], 0
		call	sub_10022040
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100026D3
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100026D3:				; CODE XREF: sub_100026B0+1Bj
		mov	ecx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		push	esi
		push	1
		push	ecx
		push	edx
		push	edi
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_100026F6
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100026F6:				; CODE XREF: sub_100026B0+3Dj
		push	esi
		call	sub_100220F0
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_C]
		push	eax
		push	ecx
		push	esi
		call	sub_10022120
		mov	edx, [edi]
		mov	ecx, [esp+1Ch+arg_0]
		push	edx
		lea	eax, [esp+20h+var_4]
		push	eax
		push	ecx
		push	esi
		call	sub_10022150
		push	1
		push	esi
		mov	edi, eax
		call	sub_10022080
		add	esp, 28h
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
sub_100026B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002740	proc near		; CODE XREF: sub_10003390+79p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_4		= dword	ptr -4

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	ebx
		push	3
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	25h
		lea	eax, [esp+5Ch+var_44]
		push	offset aFirefoxAndThun ; "Firefox and ThunderBird are awesome!"
		push	eax
		call	sub_100026B0
		add	esp, 18h
		test	eax, eax
		jnz	loc_10002A32
		xor	ebx, ebx
		mov	eax, 14h
		xor	ecx, ecx
		lea	ecx, [ecx+0]

loc_10002780:				; CODE XREF: sub_10002740+59j
		mov	edx, [esp+ecx+4Ch+var_44]
		cmp	edx, ds:dword_10024A04[ecx]
		jnz	loc_10002A32
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002780
		push	esi
		push	edi
		push	7
		mov	[esp+58h+var_48], ebx
		call	sub_10022040
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jz	loc_10002A1B
		push	1
		push	25h
		push	offset aFirefoxAndThun ; "Firefox and ThunderBird are awesome!"
		push	edi
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		cmp	esi, ebx
		jz	loc_10002A1B
		push	esi
		call	sub_100220F0
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	esi
		call	sub_10022120
		mov	eax, [edi]
		push	eax
		lea	ecx, [esp+68h+var_48]
		push	ecx
		lea	edx, [esp+6Ch+var_44]
		push	edx
		push	esi
		call	sub_10022150
		push	1
		push	esi
		mov	edi, eax
		call	sub_10022080
		add	esp, 28h
		cmp	edi, ebx
		jnz	loc_10002A1B
		mov	eax, 1Ch
		xor	ecx, ecx
		jmp	short loc_10002820
; ---------------------------------------------------------------------------
		align 10h

loc_10002820:				; CODE XREF: sub_10002740+D3j
					; sub_10002740+F9j
		mov	edx, [esp+ecx+54h+var_44]
		cmp	edx, ds:dword_10024AA4[ecx]
		jnz	loc_10002A1B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002820
		push	4
		mov	[esp+58h+var_48], ebx
		call	sub_10022040
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jz	loc_10002A1B
		push	1
		push	25h
		push	offset aFirefoxAndThun ; "Firefox and ThunderBird are awesome!"
		push	edi
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		cmp	esi, ebx
		jz	loc_10002A1B
		push	esi
		call	sub_100220F0
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	esi
		call	sub_10022120
		mov	eax, [edi]
		push	eax
		lea	ecx, [esp+68h+var_48]
		push	ecx
		lea	edx, [esp+6Ch+var_44]
		push	edx
		push	esi
		call	sub_10022150
		push	1
		push	esi
		mov	edi, eax
		call	sub_10022080
		add	esp, 28h
		cmp	edi, ebx
		jnz	loc_10002A1B
		mov	eax, 20h
		xor	ecx, ecx
		jmp	short loc_100028C0
; ---------------------------------------------------------------------------
		align 10h

loc_100028C0:				; CODE XREF: sub_10002740+171j
					; sub_10002740+199j
		mov	edx, [esp+ecx+54h+var_44]
		cmp	edx, ds:dword_10024AC0[ecx]
		jnz	loc_10002A1B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_100028C0
		push	5
		mov	[esp+58h+var_48], ebx
		call	sub_10022040
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jz	loc_10002A1B
		push	1
		push	25h
		push	offset aFirefoxAndThun ; "Firefox and ThunderBird are awesome!"
		push	edi
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		cmp	esi, ebx
		jz	loc_10002A1B
		push	esi
		call	sub_100220F0
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	esi
		call	sub_10022120
		mov	eax, [edi]
		push	eax
		lea	ecx, [esp+68h+var_48]
		push	ecx
		lea	edx, [esp+6Ch+var_44]
		push	edx
		push	esi
		call	sub_10022150
		push	1
		push	esi
		mov	edi, eax
		call	sub_10022080
		add	esp, 28h
		cmp	edi, ebx
		jnz	loc_10002A1B
		mov	eax, 30h
		xor	ecx, ecx
		jmp	short loc_10002960
; ---------------------------------------------------------------------------
		align 10h

loc_10002960:				; CODE XREF: sub_10002740+211j
					; sub_10002740+239j
		mov	edx, [esp+ecx+54h+var_44]
		cmp	edx, ds:dword_10024AE0[ecx]
		jnz	loc_10002A1B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002960
		push	6
		mov	[esp+58h+var_48], ebx
		call	sub_10022040
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jz	loc_10002A1B
		push	1
		push	25h
		push	offset aFirefoxAndThun ; "Firefox and ThunderBird are awesome!"
		push	edi
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		cmp	esi, ebx
		jz	short loc_10002A1B
		push	esi
		call	sub_100220F0
		push	40h
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	esi
		call	sub_10022120
		mov	eax, [edi]
		push	eax
		lea	ecx, [esp+68h+var_48]
		push	ecx
		lea	edx, [esp+6Ch+var_44]
		push	edx
		push	esi
		call	sub_10022150
		push	1
		push	esi
		mov	edi, eax
		call	sub_10022080
		add	esp, 28h
		cmp	edi, ebx
		jnz	short loc_10002A1B
		mov	eax, 40h
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_100029F0:				; CODE XREF: sub_10002740+2C5j
		mov	edx, [esp+ecx+54h+var_44]
		cmp	edx, ds:dword_10024B10[ecx]
		jnz	short loc_10002A1B
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_100029F0
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002A1B:				; CODE XREF: sub_10002740+6Fj
					; sub_10002740+8Bj ...
		pop	edi
		pop	esi
		mov	eax, 30h
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002A32:				; CODE XREF: sub_10002740+2Ej
					; sub_10002740+4Aj
		mov	ecx, [esp+4Ch+var_4]
		pop	ebx
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_10002740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002A50	proc near		; CODE XREF: sub_10003390+70p

var_44		= dword	ptr -44h
var_4		= dword	ptr -4

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		push	40h
		lea	eax, [esp+48h+var_44]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_10021450
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002B9C
		mov	eax, 14h
		xor	ecx, ecx

loc_10002A81:				; CODE XREF: sub_10002A50+49j
		mov	edx, [esp+ecx+44h+var_44]
		cmp	edx, ds:dword_10024B50[ecx]
		jnz	loc_10002B9C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002A81
		push	40h
		lea	eax, [esp+48h+var_44]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_10022470
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002B9C
		mov	eax, 1Ch
		xor	ecx, ecx
		mov	edi, edi

loc_10002AC0:				; CODE XREF: sub_10002A50+88j
		mov	edx, [esp+ecx+44h+var_44]
		cmp	edx, ds:dword_10024B64[ecx]
		jnz	loc_10002B9C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002AC0
		push	40h
		lea	eax, [esp+48h+var_44]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_10021870
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002B9C
		mov	eax, 20h
		xor	ecx, ecx
		lea	ecx, [ecx+0]

loc_10002B00:				; CODE XREF: sub_10002A50+C8j
		mov	edx, [esp+ecx+44h+var_44]
		cmp	edx, ds:dword_10024B80[ecx]
		jnz	loc_10002B9C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002B00
		push	40h
		lea	eax, [esp+48h+var_44]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_10021B50
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10002B9C
		mov	eax, 30h
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10002B40:				; CODE XREF: sub_10002A50+104j
		mov	edx, [esp+ecx+44h+var_44]
		cmp	edx, ds:dword_10024BA0[ecx]
		jnz	short loc_10002B9C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002B40
		push	40h
		lea	eax, [esp+48h+var_44]
		push	offset aTheTestMessage ; "The test message for the MD2,	MD5, and "...
		push	eax
		call	sub_100219E0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10002B9C
		mov	eax, 40h
		xor	ecx, ecx

loc_10002B75:				; CODE XREF: sub_10002A50+139j
		mov	edx, [esp+ecx+44h+var_44]
		cmp	edx, ds:dword_10024BD0[ecx]
		jnz	short loc_10002B9C
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002B75
		xor	eax, eax
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_10002B9C:				; CODE XREF: sub_10002A50+24j
					; sub_10002A50+3Aj ...
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
sub_10002A50	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002BB0	proc near		; CODE XREF: sub_10003390+82p

var_490		= dword	ptr -490h
var_48C		= dword	ptr -48Ch
var_488		= dword	ptr -488h
Dst		= byte ptr -484h
var_3F4		= dword	ptr -3F4h
var_3F0		= dword	ptr -3F0h
var_3EC		= byte ptr -3ECh
var_344		= byte ptr -344h
var_304		= dword	ptr -304h
var_204		= dword	ptr -204h
var_104		= dword	ptr -104h
var_4		= dword	ptr -4

		sub	esp, 490h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+490h+var_4], eax
		push	esi
		push	edi
		push	90h		; Size
		lea	eax, [esp+49Ch+Dst]
		push	0		; Val
		mov	esi, 1
		push	eax		; Dst
		mov	[esp+4A4h+var_48C], 0
		mov	[esp+4A4h+var_488], esi
		call	memset
		push	0A8h		; Size
		lea	ecx, [esp+4A8h+var_3EC]
		push	0		; Val
		push	ecx		; Dst
		mov	[esp+4B0h+var_3F4], 0
		mov	[esp+4B0h+var_3F0], esi
		call	memset
		push	offset dword_100250B0
		lea	edx, [esp+4B4h+var_204]
		mov	ecx, 7
		mov	esi, offset dword_10024D14
		lea	edi, [esp+4B4h+Dst]
		rep movsd
		push	edx
		lea	eax, [esp+4B8h+Dst]
		mov	ecx, 1Ch
		mov	esi, offset dword_100255B0
		lea	edi, [esp+4B8h+var_3EC]
		push	eax
		rep movsd
		call	sub_10020B70
		add	esp, 24h
		test	eax, eax
		jnz	loc_10002F06
		mov	esi, 100h
		mov	eax, esi
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10002C60:				; CODE XREF: sub_10002BB0+CCj
		mov	edx, [esp+ecx+498h+var_204]
		cmp	edx, ds:dword_100251B0[ecx]
		jnz	loc_10002F06
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002C60
		push	offset dword_100251B0
		lea	eax, [esp+49Ch+var_104]
		push	eax
		lea	ecx, [esp+4A0h+var_3EC]
		push	ecx
		call	sub_10020BA0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002F06
		mov	eax, esi
		xor	ecx, ecx
		jmp	short loc_10002CB0
; ---------------------------------------------------------------------------
		align 10h

loc_10002CB0:				; CODE XREF: sub_10002BB0+F7j
					; sub_10002BB0+11Cj
		mov	edx, [esp+ecx+498h+var_104]
		cmp	edx, ds:dword_100250B0[ecx]
		jnz	loc_10002F06
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002CB0
		push	esi
		lea	eax, [esp+49Ch+var_344]
		push	offset dword_100250B0
		push	eax
		call	sub_10021870
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002F06
		push	20h
		lea	ecx, [esp+49Ch+var_344]
		push	ecx
		push	esi
		lea	edx, [esp+4A4h+var_490]
		push	edx
		lea	eax, [esp+4A8h+var_304]
		push	eax
		lea	ecx, [esp+4ACh+var_3F4]
		push	ecx
		push	0BFh
		call	sub_1000E5E0
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_10002F06
		cmp	[esp+498h+var_490], esi
		jnz	loc_10002F06
		mov	eax, esi
		xor	ecx, ecx
		nop

loc_10002D30:				; CODE XREF: sub_10002BB0+19Cj
		mov	edx, [esp+ecx+498h+var_304]
		cmp	edx, ds:dword_100252B0[ecx]
		jnz	loc_10002F06
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002D30
		push	20h
		lea	eax, [esp+49Ch+var_344]
		push	eax
		push	esi
		lea	ecx, [esp+4A4h+var_304]
		push	ecx
		lea	edx, [esp+4A8h+var_48C]
		push	edx
		push	0BFh
		call	sub_1000EE00
		add	esp, 18h
		test	eax, eax
		jnz	loc_10002F06
		push	esi
		lea	eax, [esp+49Ch+var_344]
		push	offset dword_100250B0
		push	eax
		call	sub_10021B50
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002F06
		push	30h
		lea	ecx, [esp+49Ch+var_344]
		push	ecx
		push	esi
		lea	edx, [esp+4A4h+var_490]
		push	edx
		lea	eax, [esp+4A8h+var_304]
		push	eax
		lea	ecx, [esp+4ACh+var_3F4]
		push	ecx
		push	0C0h
		call	sub_1000E5E0
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_10002F06
		cmp	[esp+498h+var_490], esi
		jnz	loc_10002F06
		mov	eax, esi
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10002DE0:				; CODE XREF: sub_10002BB0+24Cj
		mov	edx, [esp+ecx+498h+var_304]
		cmp	edx, ds:dword_100253B0[ecx]
		jnz	loc_10002F06
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002DE0
		push	30h
		lea	eax, [esp+49Ch+var_344]
		push	eax
		push	esi
		lea	ecx, [esp+4A4h+var_304]
		push	ecx
		lea	edx, [esp+4A8h+var_48C]
		push	edx
		push	0C0h
		call	sub_1000EE00
		add	esp, 18h
		test	eax, eax
		jnz	loc_10002F06
		push	esi
		lea	eax, [esp+49Ch+var_344]
		push	offset dword_100250B0
		push	eax
		call	sub_100219E0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002F06
		push	40h
		lea	ecx, [esp+49Ch+var_344]
		push	ecx
		push	esi
		lea	edx, [esp+4A4h+var_490]
		push	edx
		lea	eax, [esp+4A8h+var_304]
		push	eax
		lea	ecx, [esp+4ACh+var_3F4]
		push	ecx
		push	0C1h
		call	sub_1000E5E0
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_10002F06
		cmp	[esp+498h+var_490], esi
		jnz	loc_10002F06
		mov	eax, esi
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_10002E90:				; CODE XREF: sub_10002BB0+2F8j
		mov	edx, [esp+ecx+498h+var_304]
		cmp	edx, ds:dword_100254B0[ecx]
		jnz	short loc_10002F06
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10002E90
		push	40h
		lea	eax, [esp+49Ch+var_344]
		push	eax
		push	esi
		lea	ecx, [esp+4A4h+var_304]
		push	ecx
		lea	edx, [esp+4A8h+var_48C]
		push	edx
		push	0C1h
		call	sub_1000EE00
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10002F06
		lea	eax, [esp+498h+var_48C]
		push	eax
		call	sub_10005180
		lea	ecx, [esp+49Ch+var_3F4]
		push	ecx
		call	sub_10005160
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+490h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 490h
		retn
; ---------------------------------------------------------------------------

loc_10002F06:				; CODE XREF: sub_10002BB0+9Dj
					; sub_10002BB0+BDj ...
		lea	edx, [esp+498h+var_48C]
		push	edx
		call	sub_10005180
		lea	eax, [esp+49Ch+var_3F4]
		push	eax
		call	sub_10005160
		mov	ecx, [esp+4A0h+var_4]
		add	esp, 8
		pop	edi
		pop	esi
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 490h
		retn
sub_10002BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002F40	proc near		; CODE XREF: sub_10003390+ADp

var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= byte ptr -138h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= byte ptr -0A8h
Dst		= byte ptr -94h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 164h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+164h+var_4], eax
		mov	eax, [esp+164h+arg_0]
		push	ebp
		lea	ecx, [esp+168h+var_160]
		xor	ebp, ebp
		mov	[esp+168h+var_140], eax
		mov	eax, [esp+168h+arg_4]
		push	ecx
		lea	edx, [esp+16Ch+var_144]
		push	edx
		mov	[esp+170h+var_160], ebp
		mov	[esp+170h+var_164], ebp
		mov	[esp+170h+var_144], ebp
		mov	[esp+170h+var_13C], eax
		call	sub_10022AA0
		add	esp, 8
		test	eax, eax
		jz	short loc_10002FA8
		lea	eax, [ebp+30h]
		pop	ebp
		mov	ecx, [esp+164h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 164h
		retn
; ---------------------------------------------------------------------------

loc_10002FA8:				; CODE XREF: sub_10002F40+4Dj
		mov	ecx, [esp+168h+var_160]
		push	esi
		push	20h
		push	offset dword_10025620
		lea	eax, [esp+174h+var_164]
		push	eax
		push	ecx
		call	sub_10021E70
		mov	edx, [esp+17Ch+var_160]
		mov	esi, eax
		mov	eax, [edx]
		push	ebp
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 18h
		mov	[esp+16Ch+var_160], ebp
		cmp	esi, ebp
		jz	short loc_10002FF5
		pop	esi
		mov	eax, 30h
		pop	ebp
		mov	ecx, [esp+164h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 164h
		retn
; ---------------------------------------------------------------------------

loc_10002FF5:				; CODE XREF: sub_10002F40+97j
		mov	eax, [esp+16Ch+var_164]
		mov	edx, [eax]
		push	eax
		lea	ecx, [esp+170h+var_138]
		push	ecx
		push	edx
		call	sub_10022AE0
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebp
		jnz	loc_10003176
		mov	eax, [esp+16Ch+var_164]
		mov	ecx, [eax+84h]
		mov	[esp+16Ch+var_B4], ecx
		mov	edx, [eax+88h]
		mov	[esp+16Ch+var_B0], edx
		mov	eax, [eax+8Ch]
		lea	ecx, [esp+16Ch+var_B4]
		push	ecx
		lea	edx, [esp+170h+var_138]
		push	edx
		mov	[esp+174h+var_AC], eax
		call	sub_10021EB0
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebp
		jnz	loc_10003176
		mov	eax, [esp+16Ch+var_164]
		lea	ecx, [eax+84h]
		push	ecx
		push	eax
		call	sub_10021EB0
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebp
		jnz	loc_10003176
		push	25h
		lea	edx, [esp+170h+var_A8]
		push	offset aFirefoxAndTh_0 ; "Firefox and ThunderBird are awesome!"
		push	edx
		call	sub_10021450
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebp
		jnz	loc_10003176
		push	90h		; Size
		lea	ecx, [esp+170h+Dst]
		lea	eax, [esp+170h+var_A8]
		push	ebp		; Val
		push	ecx		; Dst
		mov	[esp+178h+var_150], ebp
		mov	[esp+178h+var_14C], eax
		mov	[esp+178h+var_148], 14h
		call	memset
		push	20h
		push	offset dword_10025620
		lea	eax, [esp+180h+var_150]
		lea	edx, [esp+180h+Dst]
		push	eax
		lea	ecx, [esp+184h+var_15C]
		mov	[esp+184h+var_158], edx
		mov	edx, [esp+184h+var_164]
		push	ecx
		push	edx
		mov	[esp+18Ch+var_15C], ebp
		mov	[esp+18Ch+var_154], 90h
		call	sub_10021FB0
		mov	esi, eax
		add	esp, 20h
		cmp	esi, ebp
		jnz	short loc_10003176
		cmp	[esp+16Ch+var_154], edi
		jnz	short loc_10003173
		mov	ecx, [esp+16Ch+arg_8]
		mov	esi, [esp+16Ch+var_158]
		mov	eax, edi
		cmp	edi, 4
		jb	short loc_10003134
		lea	ebx, [ebx+0]

loc_10003120:				; CODE XREF: sub_10002F40+1F2j
		mov	edx, [esi]
		cmp	edx, [ecx]
		jnz	short loc_10003173
		sub	eax, 4
		add	ecx, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_10003120

loc_10003134:				; CODE XREF: sub_10002F40+1D8j
		cmp	eax, ebp
		jz	short loc_10003158
		mov	dl, [ecx]
		cmp	dl, [esi]
		jnz	short loc_10003173
		cmp	eax, 1
		jbe	short loc_10003158
		mov	dl, [ecx+1]
		cmp	dl, [esi+1]
		jnz	short loc_10003173
		cmp	eax, 2
		jbe	short loc_10003158
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jnz	short loc_10003173

loc_10003158:				; CODE XREF: sub_10002F40+1F6j
					; sub_10002F40+201j ...
		lea	ecx, [esp+16Ch+var_150]
		push	ecx
		lea	edx, [esp+170h+var_15C]
		push	edx
		lea	eax, [esp+174h+var_138]
		push	eax
		call	sub_10021F70
		add	esp, 0Ch
		mov	esi, eax
		jmp	short loc_10003176
; ---------------------------------------------------------------------------

loc_10003173:				; CODE XREF: sub_10002F40+1C6j
					; sub_10002F40+1E4j ...
		or	esi, 0FFFFFFFFh

loc_10003176:				; CODE XREF: sub_10002F40+CEj
					; sub_10002F40+118j ...
		mov	eax, [esp+16Ch+var_164]
		cmp	eax, ebp
		jz	short loc_1000318A
		mov	ecx, [eax]
		push	ebp
		push	ecx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000318A:				; CODE XREF: sub_10002F40+23Cj
		mov	ecx, [esp+16Ch+var_4]
		mov	eax, esi
		neg	eax
		pop	esi
		sbb	eax, eax
		pop	ebp
		xor	ecx, esp
		and	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 164h
		retn
sub_10002F40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100031B0	proc near		; CODE XREF: sub_10003390+8Bp

var_7C		= dword	ptr -7Ch
var_78		= byte ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_4		= dword	ptr -4

		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+7Ch+var_4], eax
		lea	eax, [esp+7Ch+var_7C]
		push	eax
		push	offset aMozillaRulesWo ; "Mozilla Rules	World!"
		push	offset dword_10025838
		call	sub_10020CA0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100031EC
		mov	eax, 2
		mov	ecx, [esp+7Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 7Ch
		retn
; ---------------------------------------------------------------------------

loc_100031EC:				; CODE XREF: sub_100031B0+26j
		mov	eax, [esp+7Ch+var_7C]
		push	esi
		push	edi
		mov	esi, eax
		mov	ecx, 0Ah
		lea	edi, [esp+84h+var_60]
		rep movsd
		mov	ecx, [eax+28h]
		mov	[esp+84h+var_38], ecx
		mov	edx, [eax+2Ch]
		mov	[esp+84h+var_34], edx
		mov	ecx, [eax+30h]
		mov	[esp+84h+var_30], ecx
		lea	edx, [esp+84h+var_2C]
		push	offset aRandomDsaSigna ; "Random DSA Signature"
		lea	ecx, [esp+88h+var_6C]
		mov	[esp+88h+var_74], edx
		push	ecx
		lea	edx, [esp+8Ch+var_78]
		push	edx
		mov	esi, 28h
		push	eax
		mov	[esp+94h+var_70], esi
		mov	[esp+94h+var_68], offset aDsaSignatureDi ; "DSA	Signature Digest"
		mov	[esp+94h+var_64], 14h
		call	sub_10020CD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10003292
		cmp	[esp+84h+var_70], esi
		jnz	short loc_10003292
		mov	eax, esi
		xor	ecx, ecx
		lea	ebx, [ebx+0]

loc_10003260:				; CODE XREF: sub_100031B0+C5j
		mov	edx, [esp+ecx+84h+var_2C]
		cmp	edx, ds:dword_10025810[ecx]
		jnz	short loc_10003292
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10003260
		lea	eax, [esp+84h+var_6C]
		push	eax
		lea	ecx, [esp+88h+var_78]
		push	ecx
		lea	edx, [esp+8Ch+var_60]
		push	edx
		call	sub_10020C70
		add	esp, 0Ch
		mov	esi, eax
		jmp	short loc_10003295
; ---------------------------------------------------------------------------

loc_10003292:				; CODE XREF: sub_100031B0+9Ej
					; sub_100031B0+A4j ...
		or	esi, 0FFFFFFFFh

loc_10003295:				; CODE XREF: sub_100031B0+E0j
		mov	eax, [esp+84h+var_7C]
		mov	ecx, [eax]
		push	1
		push	ecx
		call	PORT_FreeArena_Util
		mov	ecx, [esp+8Ch+var_4]
		add	esp, 8
		neg	esi
		sbb	eax, eax
		pop	edi
		pop	esi
		xor	ecx, esp
		and	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 7Ch
		retn
sub_100031B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100032D0	proc near		; CODE XREF: sub_10003390+94p

var_18		= dword	ptr -18h
var_4		= dword	ptr -4

		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		call	sub_10022620
		test	eax, eax
		jnz	short loc_10003337
		lea	eax, [esp+18h+var_18]
		push	eax
		push	offset dword_10025860
		push	offset dword_10025874
		call	sub_10022190
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10003337
		mov	eax, 14h
		xor	ecx, ecx
		jmp	short loc_10003310
; ---------------------------------------------------------------------------
		align 10h

loc_10003310:				; CODE XREF: sub_100032D0+38j
					; sub_100032D0+54j
		mov	edx, [esp+ecx+18h+var_18]
		cmp	edx, ds:dword_1002589C[ecx]
		jnz	short loc_10003337
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10003310
		xor	eax, eax
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10003337:				; CODE XREF: sub_100032D0+15j
					; sub_100032D0+2Fj ...
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		mov	eax, 30h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
sub_100032D0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_10003390

loc_10003350:				; CODE XREF: sub_10003390:loc_10003450j
		push	esi
		xor	esi, esi
		push	esi
		call	sub_10021DF0
		add	esp, 4
		test	eax, eax
		jz	short loc_10003376
		push	offset sub_100026B0
		push	offset aSoftokn3_dll_0 ; "softokn3.dll"
		call	sub_10021DB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000337D

loc_10003376:				; CODE XREF: sub_10003390-32j
		mov	eax, 30h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000337D:				; CODE XREF: sub_10003390-1Cj
		mov	eax, esi
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_10003390
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003390	proc near		; CODE XREF: sub_10003640+B2p

; FUNCTION CHUNK AT 10003350 SIZE 00000031 BYTES

		call	sub_10001AB0
		test	eax, eax
		jnz	locret_1000344F
		call	sub_10001D00
		test	eax, eax
		jnz	locret_1000344F
		call	sub_10001E40
		test	eax, eax
		jnz	locret_1000344F
		call	sub_10002090
		test	eax, eax
		jnz	locret_1000344F
		push	10h
		call	sub_100022E0
		add	esp, 4
		test	eax, eax
		jnz	short locret_1000344F
		push	18h
		call	sub_100022E0
		add	esp, 4
		test	eax, eax
		jnz	short locret_1000344F
		push	20h
		call	sub_100022E0
		add	esp, 4
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_10002590
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_10002640
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_10002A50
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_10002740
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_10002BB0
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_100031B0
		test	eax, eax
		jnz	short locret_1000344F
		call	sub_100032D0
		test	eax, eax
		jnz	short locret_1000344F
		push	edi
		push	offset dword_10025688
		push	0Ah
		push	offset dword_10025668
		lea	edi, [eax+40h]
		call	sub_10002F40
		add	esp, 0Ch
		pop	edi
		test	eax, eax
		jz	short loc_10003450
		mov	eax, 30h

locret_1000344F:			; CODE XREF: sub_10003390+7j
					; sub_10003390+14j ...
		retn
; ---------------------------------------------------------------------------

loc_10003450:				; CODE XREF: sub_10003390+B8j
		jmp	loc_10003350
sub_10003390	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003460	proc near		; CODE XREF: sub_10003910+4Cp
					; sub_100039C0+4Fp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		push	ebx
		push	ebp
		xor	eax, eax
		push	esi
		push	edi
		xor	ebp, ebp
		xor	esi, esi
		xor	edi, edi
		mov	[esp+24h+var_4], eax
		mov	[esp+24h+var_8], eax
		mov	[esp+24h+var_C], eax
		mov	[esp+24h+var_10], eax
		mov	[esp+24h+var_14], eax
		cmp	[esp+24h+arg_4], eax
		jbe	loc_10003567
		jmp	short loc_10003492
; ---------------------------------------------------------------------------
		align 10h

loc_10003490:				; CODE XREF: sub_10003460+EAj
		xor	eax, eax

loc_10003492:				; CODE XREF: sub_10003460+2Dj
		mov	ecx, [esp+24h+arg_0]
		movzx	ebx, byte ptr [edi+ecx]
		cmp	esi, eax
		jz	short loc_100034BB
		and	bl, 0C0h
		cmp	bl, 80h
		jnz	loc_10003555
		dec	esi
		jnz	loc_10003545
		inc	ebp
		inc	[esp+24h+var_14]
		jmp	loc_10003545
; ---------------------------------------------------------------------------

loc_100034BB:				; CODE XREF: sub_10003460+3Cj
		test	bl, bl
		js	short loc_1000350F
		push	ebx		; C
		inc	ebp
		call	ds:isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_100034DD
		mov	edx, [esp+24h+arg_4]
		dec	edx
		cmp	edi, edx
		jnb	short loc_10003545
		inc	[esp+24h+var_4]
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_100034DD:				; CODE XREF: sub_10003460+6Cj
		push	ebx		; C
		call	ds:islower
		add	esp, 4
		test	eax, eax
		jz	short loc_100034F1
		inc	[esp+24h+var_8]
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_100034F1:				; CODE XREF: sub_10003460+89j
		push	ebx		; C
		call	ds:isupper
		add	esp, 4
		test	eax, eax
		jz	short loc_10003509
		test	edi, edi
		jz	short loc_10003545
		inc	[esp+24h+var_C]
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_10003509:				; CODE XREF: sub_10003460+9Dj
		inc	[esp+24h+var_10]
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_1000350F:				; CODE XREF: sub_10003460+5Dj
		mov	eax, ebx
		and	eax, 0E0h
		cmp	al, 0C0h
		jnz	short loc_10003521
		mov	esi, 1
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_10003521:				; CODE XREF: sub_10003460+B8j
		mov	ecx, ebx
		and	ecx, 0F0h
		cmp	cl, 0E0h
		jnz	short loc_10003535
		mov	esi, 2
		jmp	short loc_10003545
; ---------------------------------------------------------------------------

loc_10003535:				; CODE XREF: sub_10003460+CCj
		and	ebx, 0F8h
		cmp	bl, 0F0h
		jnz	short loc_10003555
		mov	esi, 3

loc_10003545:				; CODE XREF: sub_10003460+4Bj
					; sub_10003460+56j ...
		inc	edi
		cmp	edi, [esp+24h+arg_4]
		jb	loc_10003490
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_10003562

loc_10003555:				; CODE XREF: sub_10003460+44j
					; sub_10003460+DEj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0A1h
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10003562:				; CODE XREF: sub_10003460+F3j
		cmp	ebp, 7
		jge	short loc_10003574

loc_10003567:				; CODE XREF: sub_10003460+27j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0A2h
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10003574:				; CODE XREF: sub_10003460+105j
		xor	edx, edx
		cmp	[esp+24h+var_14], edx
		pop	edi
		setnz	dl
		xor	eax, eax
		cmp	[esp+20h+var_10], eax
		pop	esi
		setnz	al
		xor	ecx, ecx
		pop	ebp
		pop	ebx
		add	edx, eax
		cmp	[esp+14h+var_C], ecx
		setnz	cl
		xor	eax, eax
		add	edx, ecx
		cmp	[esp+14h+var_8], eax
		setnz	al
		xor	ecx, ecx
		add	edx, eax
		cmp	[esp+14h+var_4], ecx
		setnz	cl
		xor	eax, eax
		add	edx, ecx
		cmp	edx, 3
		setnl	al
		dec	eax
		and	eax, 0A2h
		add	esp, 14h
		retn
sub_10003460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100035C0	proc near		; CODE XREF: sub_10003D20+2Cp
					; sub_10003DB0+2Bp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	esi
		mov	esi, eax
		push	1
		lea	eax, [esp+14h+var_C]
		push	eax
		push	ecx
		push	edx
		mov	[esp+20h+var_C], 0
		mov	[esp+20h+var_8], esi
		mov	[esp+20h+var_4], 4
		call	sub_10009390
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10003621
		mov	esi, [esi]
		cmp	esi, 3
		jz	short loc_100035FB
		cmp	esi, 4
		jnz	short loc_10003621

loc_100035FB:				; CODE XREF: sub_100035C0+34j
		cmp	dword_10029554,	0
		jz	short loc_1000360E
		mov	eax, 30h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000360E:				; CODE XREF: sub_100035C0+42j
		mov	eax, dword_10029550
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFEFFh
		add	eax, 101h

loc_10003621:				; CODE XREF: sub_100035C0+2Dj
					; sub_100035C0+39j
		pop	esi
		add	esp, 0Ch
		retn
sub_100035C0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. FC_GetFunctionList

; =============== S U B	R O U T	I N E =======================================


		public FC_GetFunctionList
FC_GetFunctionList proc	near		; DATA XREF: .rdata:off_10028EB8o
					; .data:1002900Eo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [eax], offset	byte_10029000
		xor	eax, eax
		retn
FC_GetFunctionList endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003640	proc near		; DATA XREF: .data:10029002o

var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 88h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+88h+var_4], eax
		push	esi
		mov	esi, [esp+8Ch+arg_0]
		lea	eax, [esp+8Ch+var_88]
		push	eax
		push	esi
		call	sub_10008590
		add	esp, 8
		cmp	dword_1002955C,	0
		jz	short loc_1000368E
		mov	eax, 191h
		pop	esi
		mov	ecx, [esp+88h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 88h
		retn
; ---------------------------------------------------------------------------

loc_1000368E:				; CODE XREF: sub_10003640+31j
		push	offset aNss_enable_aud ; "NSS_ENABLE_AUDIT"
		call	ds:PR_GetEnv
		add	esp, 4
		test	eax, eax
		jz	short loc_100036B5
		push	eax		; Str
		call	ds:atoi
		dec	eax
		add	esp, 4
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	dword_10029558,	eax

loc_100036B5:				; CODE XREF: sub_10003640+5Ej
		push	1
		push	esi
		call	sub_1000B0B0
		add	esp, 8
		mov	[esp+8Ch+var_88], eax
		test	eax, eax
		jz	short loc_100036E8
		mov	dword_10029554,	1
		pop	esi
		mov	ecx, [esp+88h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 88h
		retn
; ---------------------------------------------------------------------------

loc_100036E8:				; CODE XREF: sub_10003640+86j
		mov	dword_10029554,	0
		call	sub_10003390
		mov	[esp+8Ch+var_88], eax
		test	eax, eax
		jz	short loc_10003755
		push	1
		push	0
		call	sub_1000B270
		add	esp, 8
		cmp	dword_10029558,	0
		mov	dword_10029554,	1
		jz	short loc_1000373B
		mov	ecx, [esp+8Ch+var_88]
		push	ecx
		push	offset aC_initialize0x ; "C_Initialize()=0x%08lX power-up self-te"...
		lea	edx, [esp+94h+var_84]
		push	80h
		push	edx
		call	ds:PR_snprintf
		add	esp, 10h

loc_1000373B:				; CODE XREF: sub_10003640+DCj
		mov	eax, [esp+8Ch+var_88]
		pop	esi
		mov	ecx, [esp+88h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 88h
		retn
; ---------------------------------------------------------------------------

loc_10003755:				; CODE XREF: sub_10003640+BDj
		mov	ecx, [esp+8Ch+var_4]
		pop	esi
		xor	ecx, esp
		mov	dword_1002955C,	1
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 88h
		retn
sub_10003640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003780	proc near		; DATA XREF: .data:10029006o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		lea	eax, [esp+8+var_4]
		push	eax
		push	esi
		call	sub_10008590
		add	esp, 8
		test	eax, eax
		jz	short loc_1000379F
		mov	eax, [esp+8+var_4]
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000379F:				; CODE XREF: sub_10003780+16j
		cmp	dword_1002955C,	0
		jnz	short loc_100037AD
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100037AD:				; CODE XREF: sub_10003780+26j
		push	1
		push	esi
		call	sub_1000B270
		xor	ecx, ecx
		add	esp, 8
		test	eax, eax
		setnz	cl
		pop	esi
		mov	dword_1002955C,	ecx
		pop	ecx
		retn
sub_10003780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_100037D0	proc near		; DATA XREF: .data:1002900Ao
		jmp	sub_100085A0
sub_100037D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100037E0(int,	void *Dst, int)
sub_100037E0	proc near		; DATA XREF: .data:10029012o

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+Dst]
		mov	edx, [esp+arg_0]
		push	1		; int
		push	eax		; int
		push	ecx		; Dst
		push	edx		; int
		call	sub_10008600
		add	esp, 10h
		retn
sub_100037E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_10003800	proc near		; DATA XREF: .data:10029016o
		jmp	sub_10008680
sub_10003800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003810(int,	void *Dst)
sub_10003810	proc near		; DATA XREF: .data:1002901Ao

arg_0		= dword	ptr  4
Dst		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+Dst]
		push	esi		; Dst
		push	eax		; int
		call	sub_1000B3F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000382B
		or	dword ptr [esi+60h], 4

loc_1000382B:				; CODE XREF: sub_10003810+15j
		pop	esi
		retn
sub_10003810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003830	proc near		; DATA XREF: .data:1002901Eo

arg_0		= dword	ptr  4

		cmp	dword_10029554,	0
		jz	short loc_1000383F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000383F:				; CODE XREF: sub_10003830+7j
		mov	eax, [esp+arg_0]
		cmp	eax, 3
		jnz	short loc_1000384D
		mov	eax, 1

loc_1000384D:				; CODE XREF: sub_10003830+16j
		mov	[esp+arg_0], eax
		jmp	sub_10008740
sub_10003830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003860	proc near		; DATA XREF: .data:10029022o

arg_0		= dword	ptr  4

		cmp	dword_10029554,	0
		jz	short loc_1000386F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000386F:				; CODE XREF: sub_10003860+7j
		mov	eax, [esp+arg_0]
		cmp	eax, 3
		jnz	short loc_1000387D
		mov	eax, 1

loc_1000387D:				; CODE XREF: sub_10003860+16j
		mov	[esp+arg_0], eax
		jmp	sub_100087F0
sub_10003860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003890	proc near		; DATA XREF: .data:10029026o

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		mov	ecx, [esp+84h+arg_8]
		mov	eax, [esp+84h+arg_4]
		push	ebx
		mov	ebx, [esp+88h+arg_0]
		push	esi
		mov	esi, [esp+8Ch+arg_C]
		push	edi
		push	esi
		push	ecx
		push	eax
		push	ebx
		call	sub_10008930
		add	esp, 10h
		cmp	dword_10029558,	0
		mov	edi, eax
		jz	short loc_100038F7
		push	edi
		push	esi
		push	ebx
		push	offset aC_inittokenSlo ; "C_InitToken(slotID=%lu, pLabel=\"%.32s\"...
		lea	edx, [esp+0A0h+var_84]
		push	80h
		push	edx
		call	ds:PR_snprintf
		add	esp, 18h
		mov	eax, edi

loc_100038F7:				; CODE XREF: sub_10003890+48j
		mov	ecx, [esp+90h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_10003890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003910(int,	int, size_t Size)
sub_10003910	proc near		; DATA XREF: .data:1002902Ao

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Size		= dword	ptr  0Ch

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		cmp	dword_10029554,	0
		push	edi
		mov	edi, [esp+88h+arg_4]
		jz	short loc_10003950
		mov	eax, 30h
		pop	edi
		mov	ecx, [esp+84h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
; ---------------------------------------------------------------------------

loc_10003950:				; CODE XREF: sub_10003910+23j
		push	ebx
		mov	ebx, [esp+8Ch+Size]
		push	ebp
		push	esi
		push	ebx
		push	edi
		call	sub_10003460
		mov	ebp, [esp+9Ch+arg_0]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000397E
		push	ebx		; Size
		push	edi		; int
		push	ebp		; int
		call	sub_10008A20
		add	esp, 0Ch
		mov	esi, eax

loc_1000397E:				; CODE XREF: sub_10003910+5Fj
		cmp	dword_10029558,	0
		jz	short loc_100039A1
		push	esi
		push	ebp
		push	offset aC_initpinHsess ; "C_InitPIN(hSession=0x%08lX)=0x%08lX"
		lea	eax, [esp+0A0h+var_84]
		push	80h
		push	eax
		call	ds:PR_snprintf
		add	esp, 14h

loc_100039A1:				; CODE XREF: sub_10003910+75j
		mov	ecx, [esp+94h+var_4]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_10003910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100039C0(int,	int, size_t, int, size_t Size)
sub_100039C0	proc near		; DATA XREF: .data:1002902Eo

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Size		= dword	ptr  14h

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		cmp	dword_10029554,	0
		push	ebp
		mov	ebp, [esp+88h+arg_4]
		push	esi
		push	edi
		mov	edi, [esp+90h+arg_C]
		jz	short loc_100039F5
		mov	esi, 30h
		jmp	short loc_10003A3B
; ---------------------------------------------------------------------------

loc_100039F5:				; CODE XREF: sub_100039C0+2Cj
		cmp	dword_10029550,	0
		jnz	short loc_10003A05
		mov	esi, 101h
		jmp	short loc_10003A3B
; ---------------------------------------------------------------------------

loc_10003A05:				; CODE XREF: sub_100039C0+3Cj
		push	ebx
		mov	ebx, [esp+94h+Size]
		push	ebx
		push	edi
		call	sub_10003460
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10003A3A
		mov	eax, [esp+94h+arg_8]
		mov	ecx, [esp+94h+arg_0]
		push	ebx		; Size
		push	edi		; int
		push	eax		; size_t
		push	ebp		; int
		push	ecx		; int
		call	sub_10008B70
		add	esp, 14h
		mov	esi, eax

loc_10003A3A:				; CODE XREF: sub_100039C0+5Bj
		pop	ebx

loc_10003A3B:				; CODE XREF: sub_100039C0+33j
					; sub_100039C0+43j
		cmp	dword_10029558,	0
		jz	short loc_10003A65
		mov	edx, [esp+90h+arg_0]
		push	esi
		push	edx
		push	offset aC_setpinHsessi ; "C_SetPIN(hSession=0x%08lX)=0x%08lX"
		lea	eax, [esp+9Ch+var_84]
		push	80h
		push	eax
		call	ds:PR_snprintf
		add	esp, 14h

loc_10003A65:				; CODE XREF: sub_100039C0+82j
		mov	ecx, [esp+90h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_100039C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A80	proc near		; DATA XREF: .data:10029032o
		cmp	dword_10029554,	0
		jz	short loc_10003A8F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10003A8F:				; CODE XREF: sub_10003A80+7j
		jmp	sub_10008D80
sub_10003A80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_10003AA0	proc near		; DATA XREF: .data:10029036o
		jmp	sub_10008F10
sub_10003AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_10003AB0	proc near		; DATA XREF: .data:1002903Ao
		jmp	sub_10009040
sub_10003AB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003AC0	proc near		; DATA XREF: .data:1002903Eo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10029554,	0
		jz	short loc_10003ACF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10003ACF:				; CODE XREF: sub_10003AC0+7j
		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		push	eax
		call	sub_10009090
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003B07
		cmp	dword_10029550,	eax
		jz	short loc_10003B07
		cmp	[esi+4], eax
		jnz	short loc_10003AFA
		mov	dword ptr [esi+4], 1

loc_10003AFA:				; CODE XREF: sub_10003AC0+31j
		cmp	dword ptr [esi+4], 2
		jnz	short loc_10003B07
		mov	dword ptr [esi+4], 3

loc_10003B07:				; CODE XREF: sub_10003AC0+24j
					; sub_10003AC0+2Cj ...
		pop	esi
		retn
sub_10003AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003B10(int,	int, void *Src,	size_t Size)
sub_10003B10	proc near		; DATA XREF: .data:1002904Ao

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		cmp	dword_10029554,	0
		mov	eax, [esp+84h+Src]
		jz	short loc_10003B4E
		mov	eax, 30h
		mov	ecx, [esp+84h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
; ---------------------------------------------------------------------------

loc_10003B4E:				; CODE XREF: sub_10003B10+22j
		mov	ecx, [esp+84h+Size]
		push	ebx
		mov	ebx, [esp+88h+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+90h+arg_4]
		push	ecx		; Size
		push	eax		; Src
		push	edi		; int
		push	ebx		; int
		call	sub_100090D0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_10003B80
		cmp	esi, 100h
		jnz	short loc_10003B8A

loc_10003B80:				; CODE XREF: sub_10003B10+66j
		mov	dword_10029550,	1

loc_10003B8A:				; CODE XREF: sub_10003B10+6Ej
		cmp	dword_10029558,	0
		jz	short loc_10003BAE
		push	esi
		push	edi
		push	ebx
		push	offset aC_loginHsessio ; "C_Login(hSession=0x%08lX, userType=%lu)"...
		lea	edx, [esp+0A0h+var_84]
		push	80h
		push	edx
		call	ds:PR_snprintf
		add	esp, 18h

loc_10003BAE:				; CODE XREF: sub_10003B10+81j
		mov	ecx, [esp+90h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_10003B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003BD0	proc near		; DATA XREF: .data:1002904Eo

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		cmp	dword_10029554,	0
		push	esi
		push	edi
		mov	edi, [esp+8Ch+arg_0]
		jz	short loc_10003BFD
		mov	esi, 30h
		jmp	short loc_10003C22
; ---------------------------------------------------------------------------

loc_10003BFD:				; CODE XREF: sub_10003BD0+24j
		cmp	dword_10029550,	0
		jnz	short loc_10003C0D
		mov	esi, 101h
		jmp	short loc_10003C22
; ---------------------------------------------------------------------------

loc_10003C0D:				; CODE XREF: sub_10003BD0+34j
		push	edi
		call	sub_100092E0
		add	esp, 4
		mov	esi, eax
		mov	dword_10029550,	0

loc_10003C22:				; CODE XREF: sub_10003BD0+2Bj
					; sub_10003BD0+3Bj
		cmp	dword_10029558,	0
		jz	short loc_10003C45
		push	esi
		push	edi
		push	offset aC_logoutHsessi ; "C_Logout(hSession=0x%08lX)=0x%08lX"
		lea	eax, [esp+98h+var_84]
		push	80h
		push	eax
		call	ds:PR_snprintf
		add	esp, 14h

loc_10003C45:				; CODE XREF: sub_10003BD0+59j
		mov	ecx, [esp+8Ch+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_10003BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003C60	proc near		; DATA XREF: .data:10029052o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	dword_10029554,	0
		jz	short loc_10003C6F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10003C6F:				; CODE XREF: sub_10003C60+7j
		cmp	dword_10029550,	0
		jnz	short loc_10003C7E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10003C7E:				; CODE XREF: sub_10003C60+16j
		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		xor	eax, eax
		test	edi, edi
		jle	short loc_10003CB0
		mov	edx, [esp+8+arg_4]
		mov	ecx, edx

loc_10003C90:				; CODE XREF: sub_10003C60+3Bj
		cmp	dword ptr [ecx], 0
		jz	short loc_10003CA5
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edi
		jl	short loc_10003C90
		pop	edi
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003CA5:				; CODE XREF: sub_10003C60+33j
		lea	eax, [eax+eax*2]
		mov	esi, [edx+eax*4+4]
		test	esi, esi
		jnz	short loc_10003CB8

loc_10003CB0:				; CODE XREF: sub_10003C60+28j
		pop	edi
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003CB8:				; CODE XREF: sub_10003C60+4Ej
		mov	eax, [esi]
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_C]
		cmp	eax, 3
		jz	short loc_10003CE2
		cmp	eax, 4
		jz	short loc_10003CE2
		mov	ecx, [esp+10h+arg_0]
		push	ebp
		push	edi
		push	edx
		push	ecx
		call	sub_1000B800
		mov	edx, [esp+20h+arg_4]
		add	esp, 10h
		mov	ebx, eax
		jmp	short loc_10003CE7
; ---------------------------------------------------------------------------

loc_10003CE2:				; CODE XREF: sub_10003C60+63j
					; sub_10003C60+68j
		mov	ebx, 13h

loc_10003CE7:				; CODE XREF: sub_10003C60+80j
		cmp	dword_10029558,	0
		jz	short loc_10003D12
		mov	esi, [esi]
		cmp	esi, 2
		jz	short loc_10003D01
		cmp	esi, 3
		jz	short loc_10003D01
		cmp	esi, 4
		jnz	short loc_10003D12

loc_10003D01:				; CODE XREF: sub_10003C60+95j
					; sub_10003C60+9Aj
		push	ebx
		push	ebp
		push	edi
		push	edx
		mov	edx, [esp+20h+arg_0]
		push	edx
		call	sub_10001000
		add	esp, 14h

loc_10003D12:				; CODE XREF: sub_10003C60+8Ej
					; sub_10003C60+9Fj
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		retn
sub_10003C60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003D20	proc near		; DATA XREF: .data:10029056o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		cmp	dword_10029554,	0
		mov	[esp+4+var_4], 0
		jz	short loc_10003D38
		mov	eax, 30h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003D38:				; CODE XREF: sub_10003D20+Fj
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_4]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edi
		mov	edx, ebx
		call	sub_100035C0
		mov	ebp, [esp+14h+arg_10]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10003D72
		mov	eax, [esp+14h+arg_C]
		mov	ecx, [esp+14h+arg_8]
		push	ebp
		push	eax
		push	ecx
		push	edi
		push	ebx
		call	sub_1000B920
		add	esp, 14h
		mov	esi, eax

loc_10003D72:				; CODE XREF: sub_10003D20+39j
		cmp	dword_10029558,	0
		jz	short loc_10003DA4
		mov	eax, [esp+14h+var_4]
		cmp	eax, 2
		jz	short loc_10003D8E
		cmp	eax, 3
		jz	short loc_10003D8E
		cmp	eax, 4
		jnz	short loc_10003DA4

loc_10003D8E:				; CODE XREF: sub_10003D20+62j
					; sub_10003D20+67j
		mov	edx, [esp+14h+arg_C]
		mov	eax, [esp+14h+arg_8]
		push	esi
		push	ebp
		push	edx
		push	eax
		push	edi
		push	ebx
		call	sub_100010C0
		add	esp, 18h

loc_10003DA4:				; CODE XREF: sub_10003D20+59j
					; sub_10003D20+6Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10003D20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003DB0	proc near		; DATA XREF: .data:1002905Ao

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		cmp	dword_10029554,	0
		mov	[esp+4+var_4], 0
		jz	short loc_10003DC8
		mov	eax, 30h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003DC8:				; CODE XREF: sub_10003DB0+Fj
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		lea	eax, [esp+10h+var_4]
		mov	ecx, edi
		mov	edx, ebx
		call	sub_100035C0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10003DF2
		push	edi
		push	ebx
		call	sub_1000BE20
		add	esp, 8
		mov	esi, eax

loc_10003DF2:				; CODE XREF: sub_10003DB0+34j
		cmp	dword_10029558,	0
		jz	short loc_10003E19
		mov	eax, [esp+10h+var_4]
		cmp	eax, 2
		jz	short loc_10003E0E
		cmp	eax, 3
		jz	short loc_10003E0E
		cmp	eax, 4
		jnz	short loc_10003E19

loc_10003E0E:				; CODE XREF: sub_10003DB0+52j
					; sub_10003DB0+57j
		push	esi
		push	edi
		push	ebx
		call	sub_10001190
		add	esp, 0Ch

loc_10003E19:				; CODE XREF: sub_10003DB0+49j
					; sub_10003DB0+5Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_10003DB0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003E20	proc near		; DATA XREF: .data:1002905Eo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		cmp	dword_10029554,	0
		mov	[esp+4+var_4], 0
		jz	short loc_10003E38
		mov	eax, 30h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003E38:				; CODE XREF: sub_10003E20+Fj
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_4]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edi
		mov	edx, ebx
		call	sub_100035C0
		mov	ebp, [esp+14h+arg_8]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10003E68
		push	ebp
		push	edi
		push	ebx
		call	sub_10009380
		add	esp, 0Ch
		mov	esi, eax

loc_10003E68:				; CODE XREF: sub_10003E20+39j
		cmp	dword_10029558,	0
		jz	short loc_10003E90
		mov	eax, [esp+14h+var_4]
		cmp	eax, 2
		jz	short loc_10003E84
		cmp	eax, 3
		jz	short loc_10003E84
		cmp	eax, 4
		jnz	short loc_10003E90

loc_10003E84:				; CODE XREF: sub_10003E20+58j
					; sub_10003E20+5Dj
		push	esi
		push	ebp
		push	edi
		push	ebx
		call	sub_10001210
		add	esp, 10h

loc_10003E90:				; CODE XREF: sub_10003E20+4Fj
					; sub_10003E20+62j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10003E20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003EA0	proc near		; DATA XREF: .data:10029062o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		cmp	dword_10029554,	0
		mov	[esp+4+var_4], 0
		jz	short loc_10003EB8
		mov	eax, 30h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003EB8:				; CODE XREF: sub_10003EA0+Fj
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_4]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edi
		mov	edx, ebx
		call	sub_100035C0
		mov	ebp, [esp+14h+arg_C]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10003EED
		mov	eax, [esp+14h+arg_8]
		push	ebp
		push	eax
		push	edi
		push	ebx
		call	sub_10009390
		add	esp, 10h
		mov	esi, eax

loc_10003EED:				; CODE XREF: sub_10003EA0+39j
		cmp	dword_10029558,	0
		jz	short loc_10003F1A
		mov	eax, [esp+14h+var_4]
		cmp	eax, 2
		jz	short loc_10003F09
		cmp	eax, 3
		jz	short loc_10003F09
		cmp	eax, 4
		jnz	short loc_10003F1A

loc_10003F09:				; CODE XREF: sub_10003EA0+5Dj
					; sub_10003EA0+62j
		mov	ecx, [esp+14h+arg_8]
		push	esi
		push	ebp
		push	ecx
		push	edi
		push	ebx
		call	sub_10001290
		add	esp, 14h

loc_10003F1A:				; CODE XREF: sub_10003EA0+54j
					; sub_10003EA0+67j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10003EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003F30	proc near		; DATA XREF: .data:10029066o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		cmp	dword_10029554,	0
		mov	[esp+4+var_4], 0
		jz	short loc_10003F48
		mov	eax, 30h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003F48:				; CODE XREF: sub_10003F30+Fj
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_4]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edi
		mov	edx, ebx
		call	sub_100035C0
		mov	ebp, [esp+14h+arg_C]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10003F7D
		mov	eax, [esp+14h+arg_8]
		push	ebp
		push	eax
		push	edi
		push	ebx
		call	sub_100095C0
		add	esp, 10h
		mov	esi, eax

loc_10003F7D:				; CODE XREF: sub_10003F30+39j
		cmp	dword_10029558,	0
		jz	short loc_10003FAA
		mov	eax, [esp+14h+var_4]
		cmp	eax, 2
		jz	short loc_10003F99
		cmp	eax, 3
		jz	short loc_10003F99
		cmp	eax, 4
		jnz	short loc_10003FAA

loc_10003F99:				; CODE XREF: sub_10003F30+5Dj
					; sub_10003F30+62j
		mov	ecx, [esp+14h+arg_8]
		push	esi
		push	ebp
		push	ecx
		push	edi
		push	ebx
		call	sub_10001320
		add	esp, 14h

loc_10003FAA:				; CODE XREF: sub_10003F30+54j
					; sub_10003F30+67j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10003F30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003FC0	proc near		; DATA XREF: .data:1002906Ao

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_10003FCF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10003FCF:				; CODE XREF: sub_10003FC0+7j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		mov	esi, [esp+8+arg_8]
		xor	edx, edx
		test	esi, esi
		jz	short loc_10004008
		lea	eax, [ebx+4]

loc_10003FE2:				; CODE XREF: sub_10003FC0+46j
		cmp	dword ptr [eax-4], 0
		jnz	short loc_10004000
		cmp	dword ptr [eax+4], 4
		jnz	short loc_10004000
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10004000
		mov	ecx, [ecx]
		cmp	ecx, 3
		jz	short loc_1000401A
		cmp	ecx, 4
		jz	short loc_1000401A

loc_10004000:				; CODE XREF: sub_10003FC0+26j
					; sub_10003FC0+2Cj ...
		inc	edx
		add	eax, 0Ch
		cmp	edx, esi
		jb	short loc_10003FE2

loc_10004008:				; CODE XREF: sub_10003FC0+1Dj
					; sub_10003FC0+61j
		mov	eax, [esp+8+arg_0]
		push	esi
		push	ebx
		push	eax
		call	sub_10009A90
		add	esp, 0Ch
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000401A:				; CODE XREF: sub_10003FC0+39j
					; sub_10003FC0+3Ej
		cmp	dword_10029550,	0
		jnz	short loc_10004008
		pop	esi
		mov	eax, 101h
		pop	ebx
		retn
sub_10003FC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004030	proc near		; DATA XREF: .data:1002906Eo
		cmp	dword_10029554,	0
		jz	short loc_1000403F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000403F:				; CODE XREF: sub_10004030+7j
		jmp	sub_10009BC0
sub_10004030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004050	proc near		; DATA XREF: .data:10029076o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_1000405F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000405F:				; CODE XREF: sub_10004050+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000406E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000406E:				; CODE XREF: sub_10004050+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_1000CD90
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_100040A5
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aEncrypt	; "Encrypt"
		call	sub_100013B0
		add	esp, 14h

loc_100040A5:				; CODE XREF: sub_10004050+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100040B0	proc near		; DATA XREF: .data:1002907Ao
		cmp	dword_10029554,	0
		jz	short loc_100040BF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100040BF:				; CODE XREF: sub_100040B0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100040CE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100040CE:				; CODE XREF: sub_100040B0+16j
		jmp	sub_1000D060
sub_100040B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100040E0	proc near		; DATA XREF: .data:1002907Eo
		cmp	dword_10029554,	0
		jz	short loc_100040EF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100040EF:				; CODE XREF: sub_100040E0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100040FE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100040FE:				; CODE XREF: sub_100040E0+16j
		jmp	sub_1000CDC0
sub_100040E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004110	proc near		; DATA XREF: .data:10029082o
		cmp	dword_10029554,	0
		jz	short loc_1000411F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000411F:				; CODE XREF: sub_10004110+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000412E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000412E:				; CODE XREF: sub_10004110+16j
		jmp	sub_1000CF70
sub_10004110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004140	proc near		; DATA XREF: .data:10029086o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_1000414F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000414F:				; CODE XREF: sub_10004140+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000415E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000415E:				; CODE XREF: sub_10004140+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_1000D240
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_10004195
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aDecrypt	; "Decrypt"
		call	sub_100013B0
		add	esp, 14h

loc_10004195:				; CODE XREF: sub_10004140+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100041A0	proc near		; DATA XREF: .data:1002908Ao
		cmp	dword_10029554,	0
		jz	short loc_100041AF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100041AF:				; CODE XREF: sub_100041A0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100041BE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100041BE:				; CODE XREF: sub_100041A0+16j
		jmp	sub_1000D520
sub_100041A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100041D0	proc near		; DATA XREF: .data:1002908Eo
		cmp	dword_10029554,	0
		jz	short loc_100041DF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100041DF:				; CODE XREF: sub_100041D0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100041EE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100041EE:				; CODE XREF: sub_100041D0+16j
		jmp	sub_1000D270
sub_100041D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004200	proc near		; DATA XREF: .data:10029092o
		cmp	dword_10029554,	0
		jz	short loc_1000420F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000420F:				; CODE XREF: sub_10004200+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000421E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000421E:				; CODE XREF: sub_10004200+16j
		jmp	sub_1000D3E0
sub_10004200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004230	proc near		; DATA XREF: .data:10029096o
		cmp	dword_10029554,	0
		jz	short loc_1000423F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000423F:				; CODE XREF: sub_10004230+7j
		jmp	sub_1000D6D0
sub_10004230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004250	proc near		; DATA XREF: .data:1002909Ao
		cmp	dword_10029554,	0
		jz	short loc_1000425F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000425F:				; CODE XREF: sub_10004250+7j
		jmp	sub_1000DA50
sub_10004250	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004270	proc near		; DATA XREF: .data:1002909Eo
		cmp	dword_10029554,	0
		jz	short loc_1000427F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000427F:				; CODE XREF: sub_10004270+7j
		jmp	sub_1000DB10
sub_10004270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004290	proc near		; DATA XREF: .data:100290A6o
		cmp	dword_10029554,	0
		jz	short loc_1000429F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000429F:				; CODE XREF: sub_10004290+7j
		jmp	sub_1000DB70
sub_10004290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100042B0	proc near		; DATA XREF: .data:100290AAo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_100042BF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100042BF:				; CODE XREF: sub_100042B0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100042CE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100042CE:				; CODE XREF: sub_100042B0+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_10012FD0
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_10004305
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aSign	; "Sign"
		call	sub_100013B0
		add	esp, 14h

loc_10004305:				; CODE XREF: sub_100042B0+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_100042B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004310	proc near		; DATA XREF: .data:100290AEo
		cmp	dword_10029554,	0
		jz	short loc_1000431F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000431F:				; CODE XREF: sub_10004310+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000432E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000432E:				; CODE XREF: sub_10004310+16j
		jmp	sub_1000ECE0
sub_10004310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004340	proc near		; DATA XREF: .data:100290B2o
		cmp	dword_10029554,	0
		jz	short loc_1000434F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000434F:				; CODE XREF: sub_10004340+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000435E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000435E:				; CODE XREF: sub_10004340+16j
		jmp	sub_1000EA30
sub_10004340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004370	proc near		; DATA XREF: .data:100290B6o
		cmp	dword_10029554,	0
		jz	short loc_1000437F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000437F:				; CODE XREF: sub_10004370+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000438E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000438E:				; CODE XREF: sub_10004370+16j
		jmp	sub_1000EB90
sub_10004370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100043A0	proc near		; DATA XREF: .data:100290BAo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_100043AF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100043AF:				; CODE XREF: sub_100043A0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100043BE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100043BE:				; CODE XREF: sub_100043A0+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_100139D0
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_100043F5
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aSignrecover ; "SignRecover"
		call	sub_100013B0
		add	esp, 14h

loc_100043F5:				; CODE XREF: sub_100043A0+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_100043A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004400	proc near		; DATA XREF: .data:100290BEo
		cmp	dword_10029554,	0
		jz	short loc_1000440F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000440F:				; CODE XREF: sub_10004400+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000441E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000441E:				; CODE XREF: sub_10004400+16j
		jmp	sub_1000EDF0
sub_10004400	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004430	proc near		; DATA XREF: .data:100290C2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_1000443F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000443F:				; CODE XREF: sub_10004430+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000444E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000444E:				; CODE XREF: sub_10004430+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_10013A30
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_10004485
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aVerify	; "Verify"
		call	sub_100013B0
		add	esp, 14h

loc_10004485:				; CODE XREF: sub_10004430+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004490	proc near		; DATA XREF: .data:100290C6o
		cmp	dword_10029554,	0
		jz	short loc_1000449F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000449F:				; CODE XREF: sub_10004490+7j
		cmp	dword_10029550,	0
		jnz	short loc_100044AE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100044AE:				; CODE XREF: sub_10004490+16j
		jmp	sub_100142F0
sub_10004490	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100044C0	proc near		; DATA XREF: .data:100290CAo
		cmp	dword_10029554,	0
		jz	short loc_100044CF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100044CF:				; CODE XREF: sub_100044C0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100044DE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100044DE:				; CODE XREF: sub_100044C0+16j
		jmp	sub_1000EF80
sub_100044C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100044F0	proc near		; DATA XREF: .data:100290CEo
		cmp	dword_10029554,	0
		jz	short loc_100044FF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100044FF:				; CODE XREF: sub_100044F0+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000450E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000450E:				; CODE XREF: sub_100044F0+16j
		jmp	sub_1000F0E0
sub_100044F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004520	proc near		; DATA XREF: .data:100290D2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_1000452F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000452F:				; CODE XREF: sub_10004520+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000453E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000453E:				; CODE XREF: sub_10004520+16j
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		call	sub_1000F2B0
		add	esp, 0Ch
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_10004575
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	offset aVerifyrecover ;	"VerifyRecover"
		call	sub_100013B0
		add	esp, 14h

loc_10004575:				; CODE XREF: sub_10004520+42j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004580	proc near		; DATA XREF: .data:100290D6o
		cmp	dword_10029554,	0
		jz	short loc_1000458F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000458F:				; CODE XREF: sub_10004580+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000459E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000459E:				; CODE XREF: sub_10004580+16j
		jmp	sub_1000F4A0
sub_10004580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100045B0	proc near		; DATA XREF: .data:100290EAo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	dword_10029554,	0
		jz	short loc_100045BF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100045BF:				; CODE XREF: sub_100045B0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100045CE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100045CE:				; CODE XREF: sub_100045B0+16j
		mov	edx, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_C]
		xor	eax, eax
		test	esi, esi
		jle	short loc_100045F0
		mov	ecx, edx
		nop

loc_100045E0:				; CODE XREF: sub_100045B0+3Ej
		cmp	dword ptr [ecx], 103h
		jz	short loc_10004634
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jl	short loc_100045E0

loc_100045F0:				; CODE XREF: sub_100045B0+2Bj
					; sub_100045B0+8Dj ...
		mov	ecx, [esp+4+arg_0]
		push	ebx
		mov	ebx, [esp+8+arg_10]
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		push	edi
		push	ebx
		push	esi
		push	edx
		push	ebp
		push	ecx
		call	sub_100145A0
		add	esp, 14h
		cmp	dword_10029558,	0
		mov	edi, eax
		jz	short loc_1000462D
		mov	edx, [esp+10h+arg_8]
		mov	eax, [esp+10h+arg_0]
		push	edi
		push	ebx
		push	esi
		push	edx
		push	ebp
		push	eax
		call	sub_10001470
		add	esp, 18h

loc_1000462D:				; CODE XREF: sub_100045B0+65j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004634:				; CODE XREF: sub_100045B0+36j
		lea	eax, [eax+eax*2]
		mov	eax, [edx+eax*4+4]
		test	eax, eax
		jz	short loc_100045F0
		cmp	byte ptr [eax],	0
		jnz	short loc_100045F0
		mov	eax, 13h
		pop	esi
		retn
sub_100045B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004650	proc near		; DATA XREF: .data:100290EEo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		cmp	dword_10029554,	0
		jz	short loc_1000465F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000465F:				; CODE XREF: sub_10004650+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000466E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000466E:				; CODE XREF: sub_10004650+16j
		mov	edx, [esp+arg_10]
		push	edi
		mov	edi, [esp+4+arg_14]
		xor	eax, eax
		test	edi, edi
		jle	short loc_10004690
		mov	ecx, edx
		nop

loc_10004680:				; CODE XREF: sub_10004650+3Ej
		cmp	dword ptr [ecx], 103h
		jz	short loc_10004701
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edi
		jl	short loc_10004680

loc_10004690:				; CODE XREF: sub_10004650+2Bj
					; sub_10004650+BAj ...
		mov	ecx, [esp+4+arg_C]
		mov	eax, [esp+4+arg_4]
		push	ebx
		mov	ebx, [esp+8+arg_1C]
		push	ebp
		mov	ebp, [esp+0Ch+arg_18]
		push	esi
		push	ebx
		push	ebp
		push	edi
		push	edx
		mov	edx, [esp+20h+arg_8]
		push	ecx
		mov	ecx, [esp+24h+arg_0]
		push	edx
		push	eax
		push	ecx
		call	sub_10014FA0
		mov	esi, eax
		add	esp, 20h
		cmp	esi, 5
		jnz	short loc_100046CC
		mov	dword_10029554,	1

loc_100046CC:				; CODE XREF: sub_10004650+70j
		cmp	dword_10029558,	0
		jz	short loc_100046FA
		mov	edx, [esp+10h+arg_10]
		mov	eax, [esp+10h+arg_C]
		mov	ecx, [esp+10h+arg_8]
		push	esi
		push	ebx
		push	ebp
		push	edi
		push	edx
		mov	edx, [esp+24h+arg_4]
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	ecx
		push	edx
		push	eax
		call	sub_10001570
		add	esp, 24h

loc_100046FA:				; CODE XREF: sub_10004650+83j
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10004701:				; CODE XREF: sub_10004650+36j
		lea	eax, [eax+eax*2]
		mov	eax, [edx+eax*4+4]
		test	eax, eax
		jz	short loc_10004690
		cmp	byte ptr [eax],	0
		jnz	loc_10004690
		mov	eax, 13h
		pop	edi
		retn
sub_10004650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004720	proc near		; DATA XREF: .data:100290F2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		cmp	dword_10029554,	0
		jz	short loc_1000472F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000472F:				; CODE XREF: sub_10004720+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000473E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000473E:				; CODE XREF: sub_10004720+16j
		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	ebx
		mov	ebx, [esp+4+arg_10]
		push	ebp
		mov	ebp, [esp+8+arg_C]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_14]
		push	edi
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edx
		call	sub_1000FDE0
		add	esp, 18h
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_1000478E
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		push	esi
		push	edi
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edx
		call	sub_100016D0
		add	esp, 1Ch

loc_1000478E:				; CODE XREF: sub_10004720+51j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100047A0	proc near		; DATA XREF: .data:100290F6o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		cmp	dword_10029554,	0
		jz	short loc_100047AF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_100047AF:				; CODE XREF: sub_100047A0+7j
		cmp	dword_10029550,	0
		jnz	short loc_100047BE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_100047BE:				; CODE XREF: sub_100047A0+16j
		mov	edx, [esp+arg_14]
		push	esi
		mov	esi, [esp+4+arg_18]
		xor	eax, eax
		test	esi, esi
		jle	short loc_100047E0
		mov	ecx, edx
		nop

loc_100047D0:				; CODE XREF: sub_100047A0+3Ej
		cmp	dword ptr [ecx], 103h
		jz	short loc_10004842
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jl	short loc_100047D0

loc_100047E0:				; CODE XREF: sub_100047A0+2Bj
					; sub_100047A0+ABj ...
		mov	ecx, [esp+4+arg_C]
		mov	eax, [esp+4+arg_4]
		push	ebx
		mov	ebx, [esp+8+arg_1C]
		push	ebp
		mov	ebp, [esp+0Ch+arg_10]
		push	edi
		push	ebx
		push	esi
		push	edx
		mov	edx, [esp+1Ch+arg_8]
		push	ebp
		push	ecx
		mov	ecx, [esp+24h+arg_0]
		push	edx
		push	eax
		push	ecx
		call	sub_10010670
		add	esp, 20h
		cmp	dword_10029558,	0
		mov	edi, eax
		jz	short loc_1000483B
		mov	edx, [esp+10h+arg_14]
		mov	eax, [esp+10h+arg_C]
		mov	ecx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	esi
		push	edx
		mov	edx, [esp+20h+arg_4]
		push	ebp
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	ecx
		push	edx
		push	eax
		call	sub_100017B0
		add	esp, 24h

loc_1000483B:				; CODE XREF: sub_100047A0+74j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004842:				; CODE XREF: sub_100047A0+36j
		lea	eax, [eax+eax*2]
		mov	eax, [edx+eax*4+4]
		test	eax, eax
		jz	short loc_100047E0
		cmp	byte ptr [eax],	0
		jnz	short loc_100047E0
		mov	eax, 13h
		pop	esi
		retn
sub_100047A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004860	proc near		; DATA XREF: .data:100290FAo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		cmp	dword_10029554,	0
		jz	short loc_1000486F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000486F:				; CODE XREF: sub_10004860+7j
		cmp	dword_10029550,	0
		jnz	short loc_1000487E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_1000487E:				; CODE XREF: sub_10004860+16j
		mov	edx, [esp+arg_C]
		push	esi
		mov	esi, [esp+4+arg_10]
		xor	eax, eax
		test	esi, esi
		jle	short loc_100048A0
		mov	ecx, edx
		nop

loc_10004890:				; CODE XREF: sub_10004860+3Ej
		cmp	dword ptr [ecx], 103h
		jz	short loc_100048EE
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jl	short loc_10004890

loc_100048A0:				; CODE XREF: sub_10004860+2Bj
					; sub_10004860+97j ...
		mov	ecx, [esp+4+arg_4]
		push	ebx
		mov	ebx, [esp+8+arg_14]
		push	ebp
		mov	ebp, [esp+0Ch+arg_8]
		push	edi
		push	ebx
		push	esi
		push	edx
		mov	edx, [esp+1Ch+arg_0]
		push	ebp
		push	ecx
		push	edx
		call	sub_10010E70
		add	esp, 18h
		cmp	dword_10029558,	0
		mov	edi, eax
		jz	short loc_100048E7
		mov	eax, [esp+10h+arg_C]
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		push	edi
		push	ebx
		push	esi
		push	eax
		push	ebp
		push	ecx
		push	edx
		call	sub_100018D0
		add	esp, 1Ch

loc_100048E7:				; CODE XREF: sub_10004860+6Aj
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100048EE:				; CODE XREF: sub_10004860+36j
		lea	eax, [eax+eax*2]
		mov	eax, [edx+eax*4+4]
		test	eax, eax
		jz	short loc_100048A0
		cmp	byte ptr [eax],	0
		jnz	short loc_100048A0
		mov	eax, 13h
		pop	esi
		retn
sub_10004860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004910	proc near		; DATA XREF: .data:100290FEo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10029554,	0
		jz	short loc_1000491F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000491F:				; CODE XREF: sub_10004910+7j
		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	eax
		push	ecx
		push	edx
		call	sub_1000F560
		add	esp, 0Ch
		test	eax, eax
		jz	short locret_10004944
		mov	dword_10029554,	1

locret_10004944:			; CODE XREF: sub_10004910+28j
		retn
sub_10004910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004950	proc near		; DATA XREF: .data:10029102o

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		cmp	dword_10029554,	0
		push	edi
		mov	edi, [esp+88h+arg_4]
		jz	short loc_10004990
		mov	eax, 30h
		pop	edi
		mov	ecx, [esp+84h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
; ---------------------------------------------------------------------------

loc_10004990:				; CODE XREF: sub_10004950+23j
		push	ebx
		mov	ebx, [esp+8Ch+arg_8]
		push	ebp
		mov	ebp, [esp+90h+arg_0]
		push	esi
		push	ebx
		push	edi
		push	ebp
		call	sub_1000F590
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_100049E1
		cmp	dword_10029558,	0
		mov	dword_10029554,	1
		jz	short loc_100049E1
		push	esi
		push	ebx
		push	edi
		push	ebp
		push	offset aC_generaterand ; "C_GenerateRandom(hSession=0x%08lX, pRan"...
		lea	eax, [esp+0A8h+var_84]
		push	80h
		push	eax
		call	ds:PR_snprintf
		add	esp, 1Ch

loc_100049E1:				; CODE XREF: sub_10004950+60j
					; sub_10004950+73j
		mov	ecx, [esp+94h+var_4]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sub_10004950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004A00	proc near		; DATA XREF: .data:10029106o
					; .data:1002910Ao
		cmp	dword_10029554,	0
		jz	short loc_10004A0F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004A0F:				; CODE XREF: sub_10004A00+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004A1E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004A1E:				; CODE XREF: sub_10004A00+16j
		jmp	sub_10012BA0
sub_10004A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004A30	proc near		; DATA XREF: .data:10029042o
		cmp	dword_10029554,	0
		jz	short loc_10004A3F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004A3F:				; CODE XREF: sub_10004A30+7j
		jmp	sub_10012BB0
sub_10004A30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004A50	proc near		; DATA XREF: .data:10029046o
		cmp	dword_10029554,	0
		jz	short loc_10004A5F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004A5F:				; CODE XREF: sub_10004A50+7j
		jmp	sub_10012C50
sub_10004A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004A70	proc near		; DATA XREF: .data:10029072o
		cmp	dword_10029554,	0
		jz	short loc_10004A7F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004A7F:				; CODE XREF: sub_10004A70+7j
		jmp	sub_10009C70
sub_10004A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004A90	proc near		; DATA XREF: .data:100290DAo
		cmp	dword_10029554,	0
		jz	short loc_10004A9F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004A9F:				; CODE XREF: sub_10004A90+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004AAE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004AAE:				; CODE XREF: sub_10004A90+16j
		jmp	sub_10012DF0
sub_10004A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004AC0	proc near		; DATA XREF: .data:100290DEo
		cmp	dword_10029554,	0
		jz	short loc_10004ACF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004ACF:				; CODE XREF: sub_10004AC0+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004ADE
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004ADE:				; CODE XREF: sub_10004AC0+16j
		jmp	sub_10012E30
sub_10004AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004AF0	proc near		; DATA XREF: .data:100290E2o
		cmp	dword_10029554,	0
		jz	short loc_10004AFF
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004AFF:				; CODE XREF: sub_10004AF0+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004B0E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004B0E:				; CODE XREF: sub_10004AF0+16j
		jmp	sub_10012E70
sub_10004AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004B20	proc near		; DATA XREF: .data:100290E6o
		cmp	dword_10029554,	0
		jz	short loc_10004B2F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004B2F:				; CODE XREF: sub_10004B20+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004B3E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004B3E:				; CODE XREF: sub_10004B20+16j
		jmp	sub_10012EB0
sub_10004B20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004B50	proc near		; DATA XREF: .data:100290A2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10029554,	0
		jz	short loc_10004B5F
		mov	eax, 30h
		retn
; ---------------------------------------------------------------------------

loc_10004B5F:				; CODE XREF: sub_10004B50+7j
		cmp	dword_10029550,	0
		jnz	short loc_10004B6E
		mov	eax, 101h
		retn
; ---------------------------------------------------------------------------

loc_10004B6E:				; CODE XREF: sub_10004B50+16j
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		push	edi
		push	ebx
		call	sub_10012EF0
		add	esp, 8
		cmp	dword_10029558,	0
		mov	esi, eax
		jz	short loc_10004B99
		push	esi
		push	edi
		push	ebx
		call	sub_10001A30
		add	esp, 0Ch

loc_10004B99:				; CODE XREF: sub_10004B50+3Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10004B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_10004BA0	proc near		; DATA XREF: .data:1002910Eo
		jmp	sub_10009CB0
sub_10004BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10004BB0(char	*Str, void *Src)
sub_10004BB0	proc near		; CODE XREF: sub_10004C60+25p

var_4		= dword	ptr -4
Str		= dword	ptr  4
Src		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	ds:PR_GetDirectorySeparator
		mov	esi, [esp+1Ch+Str]
		movsx	eax, al
		push	eax		; Ch
		push	esi		; Str
		call	ds:strrchr
		add	esp, 8
		test	eax, eax
		jnz	short loc_10004BDD

loc_10004BD3:				; CODE XREF: sub_10004BB0+5Cj
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10004BDD:				; CODE XREF: sub_10004BB0+21j
		sub	eax, esi
		lea	edi, [eax+1]
		mov	eax, [esp+1Ch+Src]
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10004BF0:				; CODE XREF: sub_10004BB0+45j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004BF0
		sub	eax, edx
		mov	ebx, eax
		lea	ebp, [ebx+edi+1]
		push	ebp
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10004BD3
		mov	ecx, [esp+1Ch+Str]
		push	edi		; Size
		push	ecx		; Src
		push	esi		; Dst
		call	memcpy
		mov	edx, [esp+28h+Src]
		push	ebx		; Size
		push	edx		; Src
		add	edi, esi
		push	edi		; Dst
		call	memcpy
		add	esp, 18h
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	ecx, [esp+2Ch+var_4]
		mov	[eax+4], esi
		mov	byte ptr [esi+ebp-1], 0
		mov	[eax+8], ecx
		call	ds:PR_LoadLibraryWithFlags
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10004BB0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10004C60(void	*Src)
sub_10004C60	proc near		; CODE XREF: sub_10004DD0+5Bp
					; DATA XREF: sub_10004C60+6o

var_4		= dword	ptr -4
Src		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		push	offset sub_10004C60
		push	offset aSoftokn3_dll_0 ; "softokn3.dll"
		call	ds:PR_GetLibraryFilePathname
		mov	ebx, [esp+20h+Src]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10004C99
		push	ebx		; Src
		push	esi		; Str
		call	sub_10004BB0
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10004CBE

loc_10004C99:				; CODE XREF: sub_10004C60+21j
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		call	ds:PR_LoadLibraryWithFlags
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10004CBE:				; CODE XREF: sub_10004C60+37j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
sub_10004C60	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10004CD0:				; DATA XREF: sub_10004DD0+127o
		mov	eax, [esp+8]
		push	esi
		mov	esi, [eax+10h]
		test	esi, esi
		jz	short loc_10004D10
		cmp	dword ptr [esi+8], 40000000h
		jz	short loc_10004CE8
		mov	esi, [esi+28h]

loc_10004CE8:				; CODE XREF: .text:10004CE3j
		test	esi, esi
		jz	short loc_10004D10
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10004D10
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_10004D15
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4

loc_10004D10:				; CODE XREF: .text:10004CDAj
					; .text:10004CEAj ...
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004D15:				; CODE XREF: .text:10004D01j
		mov	eax, [esi+18h]
		test	eax, eax
		jnz	short loc_10004D1F
		lea	eax, [esi+0Ch]

loc_10004D1F:				; CODE XREF: .text:10004D1Aj
		mov	edx, [esp+14h]
		mov	ecx, [esp+10h]
		push	edi
		push	edx
		mov	edx, [esp+10h]
		push	ecx
		push	eax
		push	edx
		call	sub_1001E950
		mov	edi, eax
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10004D50:				; DATA XREF: sub_10004DD0:loc_10004EF2o
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax+10h]
		test	esi, esi
		jnz	short loc_10004D61
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004D61:				; CODE XREF: .text:10004D5Aj
		cmp	dword ptr [esi+8], 40000000h
		push	edi
		mov	edi, [esi+1Ch]
		jz	short loc_10004D71
		mov	esi, [esi+28h]

loc_10004D71:				; CODE XREF: .text:10004D6Cj
		test	esi, esi
		jz	short loc_10004D99
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10004D99
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_10004D9F
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4

loc_10004D99:				; CODE XREF: .text:10004D73j
					; .text:10004D7Aj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004D9F:				; CODE XREF: .text:10004D8Aj
		mov	eax, edi
		test	edi, edi
		jnz	short loc_10004DA8
		lea	eax, [esi+0Ch]

loc_10004DA8:				; CODE XREF: .text:10004DA3j
		mov	edx, [esp+14h]
		mov	ecx, [esp+10h]
		push	edx
		push	ecx
		push	eax
		call	sub_1001E8E0
		mov	edx, [esi+24h]
		push	edx
		mov	edi, eax
		call	ds:PR_Unlock
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004DD0	proc near		; CODE XREF: sub_10004F20+5p
					; sub_10004F80+3p ...
		cmp	dword_10029580,	0
		jz	short loc_10004E23
		test	ebx, ebx
		jz	short loc_10004E12
		cmp	dword_10029564,	0
		jnz	short loc_10004E12
		cmp	dword_10029560,	0
		jnz	short loc_10004E15
		mov	eax, dword_10029568
		mov	ecx, off_10029114
		push	eax
		push	ecx
		call	sub_10021DB0
		add	esp, 8
		test	eax, eax
		jz	short loc_10004E15
		mov	dword_10029564,	1

loc_10004E12:				; CODE XREF: sub_10004DD0+Bj
					; sub_10004DD0+14j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10004E15:				; CODE XREF: sub_10004DD0+1Dj
					; sub_10004DD0+36j
		mov	dword_10029560,	1
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10004E23:				; CODE XREF: sub_10004DD0+7j
		mov	edx, off_10029114
		push	esi
		push	edx		; Src
		call	sub_10004C60
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10004E3E
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004E3E:				; CODE XREF: sub_10004DD0+67j
		push	edi
		mov	edi, ds:PR_FindFunctionSymbol
		push	offset aLegacy_open ; "legacy_Open"
		push	esi
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_readsec ; "legacy_ReadSecmodDB"
		push	esi
		mov	dword_10029568,	eax
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_release ; "legacy_ReleaseSecmodDBData"
		push	esi
		mov	dword_1002956C,	eax
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_deletes ; "legacy_DeleteSecmodDB"
		push	esi
		mov	dword_10029570,	eax
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_addsecm ; "legacy_AddSecmodDB"
		push	esi
		mov	dword_10029574,	eax
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_shutdow ; "legacy_Shutdown"
		push	esi
		mov	dword_10029578,	eax
		call	edi ; PR_FindFunctionSymbol
		push	offset aLegacy_setcryp ; "legacy_SetCryptFunctions"
		push	esi
		mov	dword_1002957C,	eax
		call	edi ; PR_FindFunctionSymbol
		mov	edi, eax
		mov	eax, dword_10029568
		add	esp, 38h
		test	eax, eax
		jz	short loc_10004F0C
		cmp	dword_1002956C,	0
		jz	short loc_10004F0C
		cmp	dword_10029570,	0
		jz	short loc_10004F0C
		cmp	dword_10029574,	0
		jz	short loc_10004F0C
		cmp	dword_10029578,	0
		jz	short loc_10004F0C
		test	edi, edi
		jz	short loc_10004F0C
		test	ebx, ebx
		jz	short loc_10004EF2
		push	eax
		mov	eax, off_10029114
		push	eax
		call	sub_10021DB0
		add	esp, 8
		test	eax, eax
		jz	short loc_10004F0C
		mov	dword_10029564,	1

loc_10004EF2:				; CODE XREF: sub_10004DD0+103j
		push	offset loc_10004D50
		push	offset loc_10004CD0
		call	edi
		add	esp, 8
		pop	edi
		mov	dword_10029580,	esi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004F0C:				; CODE XREF: sub_10004DD0+D7j
					; sub_10004DD0+E0j ...
		push	esi
		call	ds:PR_UnloadLibrary
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10004DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004F20	proc near		; CODE XREF: sub_1001CFB0+BDp
					; sub_1001CFB0+105p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		push	ebx
		mov	ebx, [esp+4+arg_18]
		call	sub_10004DD0
		pop	ebx
		test	eax, eax
		jz	short loc_10004F35
		mov	eax, 5
		retn
; ---------------------------------------------------------------------------

loc_10004F35:				; CODE XREF: sub_10004F20+Dj
		mov	eax, dword_10029568
		test	eax, eax
		jnz	short loc_10004F4F
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10004F4F:				; CODE XREF: sub_10004F20+1Cj
		mov	ecx, [esp+arg_20]
		mov	edx, [esp+arg_1C]
		push	ecx
		mov	ecx, [esp+4+arg_14]
		push	edx
		mov	edx, [esp+8+arg_10]
		push	ecx
		mov	ecx, [esp+0Ch+arg_C]
		push	edx
		mov	edx, [esp+10h+arg_8]
		push	ecx
		mov	ecx, [esp+14h+arg_4]
		push	edx
		mov	edx, [esp+18h+arg_0]
		push	ecx
		push	edx
		call	eax ; dword_10029568
		add	esp, 20h
		retn
sub_10004F20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004F80	proc near		; CODE XREF: NSC_ModuleDBFunc+F1p
					; NSC_ModuleDBFunc+19Fp
		push	ebx
		xor	ebx, ebx
		call	sub_10004DD0
		pop	ebx
		test	eax, eax
		jnz	short loc_10004FA3
		mov	eax, dword_1002956C
		test	eax, eax
		jnz	short loc_10004FA6
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4

loc_10004FA3:				; CODE XREF: sub_10004F80+Bj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10004FA6:				; CODE XREF: sub_10004F80+14j
		jmp	eax
sub_10004F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004FB0	proc near		; CODE XREF: NSC_ModuleDBFunc+12Dp
					; NSC_ModuleDBFunc+208p
		push	ebx
		xor	ebx, ebx
		call	sub_10004DD0
		pop	ebx
		test	eax, eax
		jnz	short locret_10004FD6
		mov	eax, dword_10029570
		test	eax, eax
		jnz	short loc_10004FD7
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh

locret_10004FD6:			; CODE XREF: sub_10004FB0+Bj
		retn
; ---------------------------------------------------------------------------

loc_10004FD7:				; CODE XREF: sub_10004FB0+14j
		jmp	eax
sub_10004FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004FE0	proc near		; CODE XREF: NSC_ModuleDBFunc+1ECp
		push	ebx
		xor	ebx, ebx
		call	sub_10004DD0
		pop	ebx
		test	eax, eax
		jnz	short locret_10005006
		mov	eax, dword_10029574
		test	eax, eax
		jnz	short loc_10005007
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh

locret_10005006:			; CODE XREF: sub_10004FE0+Bj
		retn
; ---------------------------------------------------------------------------

loc_10005007:				; CODE XREF: sub_10004FE0+14j
		jmp	eax
sub_10004FE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005010	proc near		; CODE XREF: NSC_ModuleDBFunc+1C8p
		push	ebx
		xor	ebx, ebx
		call	sub_10004DD0
		pop	ebx
		test	eax, eax
		jnz	short locret_10005036
		mov	eax, dword_10029578
		test	eax, eax
		jnz	short loc_10005037
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh

locret_10005036:			; CODE XREF: sub_10005010+Bj
		retn
; ---------------------------------------------------------------------------

loc_10005037:				; CODE XREF: sub_10005010+14j
		jmp	eax
sub_10005010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005040	proc near		; CODE XREF: sub_1001D450+5p
		push	esi
		push	edi
		xor	esi, esi
		xor	edi, edi
		cmp	dword_10029580,	esi
		jnz	short loc_10005053
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005053:				; CODE XREF: sub_10005040+Cj
		mov	eax, dword_1002957C
		cmp	eax, esi
		jz	short loc_10005064
		push	esi
		call	eax ; dword_1002957C
		add	esp, 4
		mov	edi, eax

loc_10005064:				; CODE XREF: sub_10005040+1Aj
		push	offset aNss_disable_un ; "NSS_DISABLE_UNLOAD"
		call	ds:PR_GetEnv
		add	esp, 4
		test	eax, eax
		jnz	short loc_10005085
		mov	eax, dword_10029580
		push	eax
		call	ds:PR_UnloadLibrary
		add	esp, 4

loc_10005085:				; CODE XREF: sub_10005040+34j
		mov	eax, edi
		pop	edi
		mov	dword_10029580,	esi
		mov	dword_10029568,	esi
		mov	dword_1002956C,	esi
		mov	dword_10029570,	esi
		mov	dword_10029574,	esi
		mov	dword_10029578,	esi
		mov	dword_10029560,	esi
		mov	dword_10029564,	esi
		pop	esi
		retn
sub_10005040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100050C0	proc near		; CODE XREF: sub_1000FB90+169p
					; sub_10010100+13Cp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, 0Ah
		mov	[eax+18h], ecx
		mov	[eax+24h], ecx
		mov	[eax+30h], ecx
		mov	[eax+3Ch], ecx
		mov	[eax+48h], ecx
		mov	[eax+54h], ecx
		mov	[eax+60h], ecx
		mov	[eax+6Ch], ecx
		retn
sub_100050C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100050F0	proc near		; CODE XREF: sub_1000FB90+148p
					; sub_10010100+118p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, 0Ah
		mov	[eax+4], ecx
		mov	[eax+10h], ecx
		mov	[eax+1Ch], ecx
		retn
sub_100050F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005110	proc near		; CODE XREF: sub_1000FB90+12Bp
					; sub_10010100+10Ep

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [eax+3Ch], 0Ah
		retn
sub_10005110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005120	proc near		; CODE XREF: sub_10010100+E5p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, 0Ah
		mov	[eax+68h], ecx
		mov	[eax+78h], ecx
		retn
sub_10005120	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005130	proc near		; CODE XREF: sub_1000FB90+D8p
					; sub_10010100+DCp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, 0Ah
		mov	[eax+0A4h], ecx
		mov	[eax+70h], ecx
		mov	[eax+80h], ecx
		mov	[eax+98h], ecx
		mov	[eax+8Ch], ecx
		retn
sub_10005130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005160	proc near		; CODE XREF: sub_10002BB0+335p
					; sub_10002BB0+368p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short locret_10005179
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_10005179
		push	1
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

locret_10005179:			; CODE XREF: sub_10005160+6j
					; sub_10005160+Cj
		retn
sub_10005160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005180	proc near		; CODE XREF: sub_10002BB0+328p
					; sub_10002BB0+35Bp
					; DATA XREF: ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short locret_10005199
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_10005199
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

locret_10005199:			; CODE XREF: sub_10005180+6j
					; sub_10005180+Cj
		retn
sub_10005180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100051A0	proc near		; CODE XREF: sub_1000C4C0+19Dp
					; sub_1000C4C0+22Dp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		dec	ecx
		jz	short loc_100051AD
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100051AD:				; CODE XREF: sub_100051A0+8j
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx],	0
		mov	eax, [eax+14h]
		jnz	short locret_100051B9
		dec	eax

locret_100051B9:			; CODE XREF: sub_100051A0+16j
		retn
sub_100051A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100051C0	proc near		; CODE XREF: sub_1000C4C0+1D3p
					; sub_1000C4C0+278p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		dec	ecx
		jz	short loc_100051CD
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100051CD:				; CODE XREF: sub_100051C0+8j
		mov	ecx, [eax+1Ch]
		cmp	byte ptr [ecx],	0
		mov	eax, [eax+20h]
		jnz	short locret_100051D9
		dec	eax

locret_100051D9:			; CODE XREF: sub_100051C0+16j
		retn
sub_100051C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100051E0	proc near		; CODE XREF: sub_10005230+115p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+4]
		push	edi
		call	eax
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100051F7
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100051F7:				; CODE XREF: sub_100051E0+Fj
		mov	ecx, [esi+10h]
		push	edi
		call	ecx
		mov	edx, [esp+0Ch+arg_C]
		mov	eax, [esp+0Ch+arg_8]
		mov	ecx, [esi+14h]
		push	edx
		push	eax
		push	edi
		call	ecx
		mov	edx, [esi]
		mov	ecx, [esp+18h+arg_4]
		push	edx
		mov	edx, [esi+18h]
		lea	eax, [esp+1Ch+arg_0]
		push	eax
		push	ecx
		push	edi
		call	edx
		mov	eax, [esi+0Ch]
		push	1
		push	edi
		call	eax
		add	esp, 28h
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100051E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005230	proc near		; CODE XREF: sub_10005560+26p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		or	ebx, 0FFFFFFFFh
		cmp	[esp+4+arg_4], 0
		jz	loc_100053A8
		cmp	[esp+4+arg_8], 0
		jz	loc_100053A8
		cmp	[esp+4+arg_C], 0
		jl	loc_100053A8
		push	esi
		push	edi
		push	0Ch
		call	PORT_ZAlloc_Util
		push	0Ch
		mov	edi, eax
		call	PORT_ZAlloc_Util
		add	esp, 8
		mov	esi, eax
		test	edi, edi
		jz	loc_1000537E
		test	esi, esi
		jz	loc_10005391
		mov	ecx, [esp+0Ch+arg_4]
		mov	edx, [ecx+8]
		mov	ecx, [esp+0Ch+arg_8]
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [ecx+8]
		mov	eax, [eax]
		add	ecx, edx
		push	ebp
		mov	ebp, eax
		cmp	ecx, eax
		jbe	short loc_1000529B
		mov	ebp, ecx

loc_1000529B:				; CODE XREF: sub_10005230+67j
		push	eax
		or	ebx, 0FFFFFFFFh
		mov	[edi+8], eax
		call	PORT_ZAlloc_Util
		push	ebp
		mov	[edi+4], eax
		call	PORT_ZAlloc_Util
		add	esp, 8
		cmp	[esp+10h+arg_10], 0
		mov	[esi+4], eax
		jz	short loc_100052C6
		mov	[esi+8], ebp
		mov	ebp, [esp+10h+arg_8]
		jmp	short loc_100052D7
; ---------------------------------------------------------------------------

loc_100052C6:				; CODE XREF: sub_10005230+8Bj
		mov	edx, [esp+10h+arg_4]
		mov	ecx, [edx+8]
		mov	ebp, [esp+10h+arg_8]
		add	ecx, [ebp+8]
		mov	[esi+8], ecx

loc_100052D7:				; CODE XREF: sub_10005230+94j
		cmp	dword ptr [edi+4], 0
		jz	loc_1000537D
		test	eax, eax
		jz	loc_1000537D
		mov	ecx, [ebp+8]
		xor	ebx, ebx
		test	ecx, ecx
		jz	short loc_10005300
		mov	edx, [ebp+4]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10005300:				; CODE XREF: sub_10005230+C0j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [ecx+8]
		test	eax, eax
		jz	short loc_1000531F
		push	eax		; Size
		mov	eax, [ecx+4]
		mov	ecx, [esi+4]
		add	ecx, [ebp+8]
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000531F:				; CODE XREF: sub_10005230+D9j
		mov	[esp+10h+arg_4], ebx
		cmp	[esp+10h+arg_C], ebx
		jle	short loc_1000537D
		lea	esp, [esp+0]

loc_10005330:				; CODE XREF: sub_10005230+14Bj
		test	ebx, ebx
		jnz	short loc_1000537D
		mov	edx, [esi+8]
		mov	eax, [esi+4]
		mov	ecx, [edi+4]
		mov	ebp, [esp+10h+arg_0]
		push	edx
		push	eax
		push	ecx
		push	ebp
		call	sub_100051E0
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_1000536E
		mov	edx, [ebp+0]
		mov	[esi+8], edx
		mov	eax, [ebp+0]
		mov	ecx, [edi+4]
		mov	edx, [esi+4]
		push	eax		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000536E:				; CODE XREF: sub_10005230+122j
		mov	eax, [esp+10h+arg_4]
		inc	eax
		mov	[esp+10h+arg_4], eax
		cmp	eax, [esp+10h+arg_C]
		jl	short loc_10005330

loc_1000537D:				; CODE XREF: sub_10005230+ABj
					; sub_10005230+B3j ...
		pop	ebp

loc_1000537E:				; CODE XREF: sub_10005230+3Ej
		test	esi, esi
		jz	short loc_1000538D
		push	1
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1000538D:				; CODE XREF: sub_10005230+150j
		test	ebx, ebx
		jz	short loc_100053A2

loc_10005391:				; CODE XREF: sub_10005230+46j
		test	edi, edi
		jz	short loc_100053A2
		push	1
		push	edi
		call	SECITEM_FreeItem_Util
		add	esp, 8
		xor	edi, edi

loc_100053A2:				; CODE XREF: sub_10005230+15Fj
					; sub_10005230+163j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100053A8:				; CODE XREF: sub_10005230+9j
					; sub_10005230+14j ...
		xor	eax, eax
		pop	ebx
		retn
sub_10005230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100053B0	proc near		; CODE XREF: sub_10005560+44p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		mov	eax, [esp+14h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [eax]
		lea	eax, [edi+ecx-1]
		xor	edx, edx
		div	edi
		push	0Ch
		or	ebx, 0FFFFFFFFh
		xor	esi, esi
		mov	ebp, eax
		mov	[esp+28h+var_8], ebp
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esp+24h+var_10], eax
		test	eax, eax
		jz	short loc_10005408
		imul	ebp, edi
		lea	edx, [ebp+1]
		push	edx
		call	PORT_ZAlloc_Util
		mov	ecx, [esp+28h+var_10]
		add	esp, 4
		mov	[ecx+4], eax
		mov	[ecx+8], ebp
		test	eax, eax
		jnz	short loc_10005412
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_10005408:				; CODE XREF: sub_100053B0+30j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10005412:				; CODE XREF: sub_100053B0+4Dj
		mov	eax, [esp+24h+arg_4]
		mov	eax, [eax+0Ch]
		cmp	edi, eax
		jbe	short loc_1000541F
		mov	eax, edi

loc_1000541F:				; CODE XREF: sub_100053B0+6Bj
		push	eax
		mov	[esp+28h+var_14], eax
		call	PORT_ZAlloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_1000543A
		or	ebx, 0FFFFFFFFh
		jmp	loc_10005526
; ---------------------------------------------------------------------------

loc_1000543A:				; CODE XREF: sub_100053B0+80j
		mov	ecx, [esp+24h+arg_4]
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jz	short loc_10005453
		mov	ecx, [ecx+8]
		push	eax		; Size
		push	ecx		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10005453:				; CODE XREF: sub_100053B0+93j
		mov	eax, [esp+24h+arg_8]
		mov	edx, [eax+8]
		mov	eax, [eax+4]
		mov	ecx, [esp+24h+arg_0]
		push	1
		push	edx
		push	eax
		push	ecx
		call	sub_100220B0
		mov	esi, eax
		xor	eax, eax
		add	esp, 10h
		cmp	esi, eax
		jnz	short loc_1000547E
		or	ebx, 0FFFFFFFFh
		jmp	loc_10005518
; ---------------------------------------------------------------------------

loc_1000547E:				; CODE XREF: sub_100053B0+C4j
		mov	[esp+24h+var_C], eax
		cmp	[esp+24h+var_8], eax
		jbe	loc_10005518
		mov	[esp+24h+arg_0], eax

loc_10005490:				; CODE XREF: sub_100053B0+162j
		push	esi
		call	sub_100220F0
		mov	edx, [esp+28h+var_14]
		push	edx
		push	ebp
		push	esi
		call	sub_10022120
		mov	eax, [esp+34h+arg_4]
		mov	ecx, [eax+0Ch]
		mov	edx, [eax+8]
		push	ecx
		push	edx
		push	esi
		call	sub_10022120
		mov	ecx, [esp+40h+var_10]
		mov	edx, [ecx+4]
		add	edx, [esp+40h+arg_0]
		push	edi
		lea	eax, [esp+44h+var_4]
		push	eax
		push	edx
		push	esi
		call	sub_10022150
		mov	ebx, eax
		add	esp, 2Ch
		test	ebx, ebx
		jnz	short loc_10005518
		push	esi
		call	sub_100220F0
		mov	eax, [esp+28h+var_14]
		push	eax
		push	ebp
		push	esi
		call	sub_10022120
		mov	ecx, [esp+34h+var_14]
		push	ecx
		lea	edx, [esp+38h+var_14]
		push	edx
		push	ebp
		push	esi
		call	sub_10022150
		mov	ebx, eax
		add	esp, 20h
		test	ebx, ebx
		jnz	short loc_10005518
		mov	eax, [esp+24h+var_C]
		add	[esp+24h+arg_0], edi
		inc	eax
		mov	[esp+24h+var_C], eax
		cmp	eax, [esp+24h+var_8]
		jb	loc_10005490

loc_10005518:				; CODE XREF: sub_100053B0+C9j
					; sub_100053B0+D6j ...
		mov	eax, [esp+24h+var_14]
		push	eax
		push	ebp
		call	PORT_ZFree_Util
		add	esp, 8

loc_10005526:				; CODE XREF: sub_100053B0+85j
		push	1
		push	esi
		call	sub_10022080
		add	esp, 8
		test	ebx, ebx
		jz	short loc_1000554E
		mov	ecx, [esp+24h+var_10]
		push	1
		push	ecx
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000554E:				; CODE XREF: sub_100053B0+183j
		mov	eax, [esp+24h+var_10]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_100053B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005560	proc near		; CODE XREF: sub_10005B90+129p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	esi, eax
		mov	eax, [ebp+0]
		mov	edx, [esi+28h]
		mov	edi, [esi+30h]
		add	edi, [esi+2Ch]
		push	ecx
		push	edx
		mov	[esp+18h+arg_0], eax
		mov	eax, [esp+18h+arg_4]
		push	eax
		lea	ecx, [esi+4]
		push	ecx
		push	ebp
		call	sub_10005230
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jnz	short loc_10005599
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005599:				; CODE XREF: sub_10005560+32j
		cmp	edi, [esp+10h+arg_0]
		jle	short loc_100055BF
		push	ebx
		push	esi
		push	ebp
		mov	ecx, edi
		call	sub_100053B0
		mov	esi, eax
		add	esp, 0Ch
		cmp	ebx, esi
		jz	short loc_100055BD
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100055BD:				; CODE XREF: sub_10005560+50j
		mov	eax, esi

loc_100055BF:				; CODE XREF: sub_10005560+3Dj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10005560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100055D0	proc near		; CODE XREF: sub_10005B90+104p

Dst		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 30h
		push	ebx
		mov	ebx, [esp+34h+arg_0]
		push	ebp
		push	esi
		mov	esi, [ebx]
		push	edi
		mov	edi, [esp+40h+arg_4]
		mov	eax, [edi+28h]
		mov	[esp+40h+var_18], eax
		mov	eax, [edi+2Ch]
		mov	[esp+40h+var_4], eax
		lea	eax, [esi+eax-1]
		xor	edx, edx
		div	esi
		mov	[esp+40h+var_14], esi
		mov	[esp+40h+var_10], 0FFFFFFFFh
		mov	[esp+40h+var_8], eax
		imul	eax, esi
		push	eax
		push	0
		push	0
		call	SECITEM_AllocItem_Util
		mov	ebp, eax
		add	esp, 0Ch
		mov	[esp+40h+var_20], ebp
		test	ebp, ebp
		jnz	short loc_10005629
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10005629:				; CODE XREF: sub_100055D0+4Fj
		push	esi
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+40h+Dst], eax
		test	eax, eax
		jz	short loc_10005666
		mov	edx, [ebp+4]
		mov	ecx, 1
		mov	[esp+40h+var_24], ecx
		mov	[esp+40h+var_C], edx
		cmp	[esp+40h+var_8], ecx
		jnb	short loc_1000568B
		mov	ebx, [esp+40h+var_10]

loc_10005654:				; CODE XREF: sub_100055D0+22Bj
		push	esi
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8
		test	ebx, ebx
		jz	loc_10005800

loc_10005666:				; CODE XREF: sub_100055D0+68j
		push	1
		push	ebp
		call	SECITEM_FreeItem_Util
		add	esp, 8
		pop	edi
		mov	[esp+3Ch+var_20], 0
		mov	ebp, [esp+3Ch+var_20]
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10005687:				; CODE XREF: sub_100055D0+21Dj
		mov	ebx, [esp+40h+arg_0]

loc_1000568B:				; CODE XREF: sub_100055D0+7Ej
		mov	eax, [edi+0Ch]
		mov	ebp, [ebx]
		add	eax, 4
		mov	[esp+40h+var_2C], eax
		mov	eax, [esp+40h+arg_8]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		push	0
		push	ecx
		push	edx
		push	ebx
		mov	[esp+50h+var_10], 0FFFFFFFFh
		call	sub_100220B0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jz	loc_100057BD
		mov	eax, [esp+40h+Dst]
		push	ebp		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [esp+4Ch+var_2C]
		add	esp, 0Ch
		mov	[esp+40h+var_28], eax
		cmp	eax, ebp
		ja	short loc_100056E0
		mov	[esp+40h+var_28], ebp

loc_100056E0:				; CODE XREF: sub_100055D0+10Aj
		mov	ecx, [esp+40h+var_28]
		push	ecx
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_1000579C
		mov	edx, [edi+0Ch]
		mov	eax, [edi+8]
		push	edx		; Size
		push	eax		; Src
		push	esi		; Dst
		call	memcpy
		mov	eax, [esp+4Ch+var_24]
		mov	edx, [edi+0Ch]
		mov	ecx, eax
		shr	ecx, 18h
		mov	[esi+edx], cl
		mov	edx, [edi+0Ch]
		mov	ecx, eax
		shr	ecx, 10h
		mov	[edx+esi+1], cl
		mov	edx, [edi+0Ch]
		mov	ecx, eax
		shr	ecx, 8
		mov	[edx+esi+2], cl
		mov	ecx, [edi+0Ch]
		add	esp, 0Ch
		cmp	[esp+40h+var_18], 0
		mov	[ecx+esi+3], al
		mov	[esp+40h+var_1C], 0
		jle	short loc_1000579C

loc_10005745:				; CODE XREF: sub_100055D0+1CAj
		push	ebx
		call	sub_100220F0
		mov	edx, [esp+44h+var_2C]
		push	edx
		push	esi
		push	ebx
		call	sub_10022120
		push	ebp
		lea	eax, [esp+54h+var_2C]
		push	eax
		push	esi
		push	ebx
		call	sub_10022150
		add	esp, 20h
		mov	[esp+40h+var_10], eax
		test	eax, eax
		jnz	short loc_1000579C
		mov	eax, [esp+40h+Dst]
		mov	ecx, ebp
		test	ebp, ebp
		jz	short loc_1000578D
		mov	edi, esi
		sub	edi, eax
		lea	ecx, [ecx+0]

loc_10005780:				; CODE XREF: sub_100055D0+1B7j
		mov	dl, [edi+eax]
		xor	[eax], dl
		inc	eax
		dec	ecx
		jnz	short loc_10005780
		mov	edi, [esp+40h+arg_4]

loc_1000578D:				; CODE XREF: sub_100055D0+1A7j
		mov	eax, [esp+40h+var_1C]
		inc	eax
		mov	[esp+40h+var_1C], eax
		cmp	eax, [esp+40h+var_18]
		jl	short loc_10005745

loc_1000579C:				; CODE XREF: sub_100055D0+121j
					; sub_100055D0+173j ...
		push	1
		push	ebx
		call	sub_10022080
		add	esp, 8
		test	esi, esi
		jz	short loc_100057B9
		mov	eax, [esp+40h+var_28]
		push	eax
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8

loc_100057B9:				; CODE XREF: sub_100055D0+1D9j
		mov	esi, [esp+40h+var_14]

loc_100057BD:				; CODE XREF: sub_100055D0+EAj
		mov	eax, [esp+40h+var_10]
		mov	ebx, eax
		test	eax, eax
		jnz	short loc_100057F3
		mov	ecx, [esp+40h+Dst]
		mov	ebp, [esp+40h+var_C]
		push	esi		; Size
		push	ecx		; Src
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+4Ch+var_24]
		inc	eax
		add	ebp, esi
		add	esp, 0Ch
		mov	[esp+40h+var_24], eax
		mov	[esp+40h+var_C], ebp
		cmp	eax, [esp+40h+var_8]
		jbe	loc_10005687

loc_100057F3:				; CODE XREF: sub_100055D0+1F5j
		mov	eax, [esp+40h+Dst]
		mov	ebp, [esp+40h+var_20]
		jmp	loc_10005654
; ---------------------------------------------------------------------------

loc_10005800:				; CODE XREF: sub_100055D0+90j
		mov	edx, [esp+40h+var_4]
		pop	edi
		pop	esi
		mov	[ebp+8], edx
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
sub_100055D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005820	proc near		; CODE XREF: sub_10005B90+B0p
					; sub_10005B90+F1p

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Size		= dword	ptr -44h
Src		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Dst		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 4Ch
		push	ebp
		mov	ebp, [esp+50h+arg_0]
		push	esi
		mov	esi, [ebp+0]
		push	800h
		mov	[esp+58h+Size],	esi
		mov	[esp+58h+var_4C], 0
		call	PORT_NewArena_Util
		mov	ecx, eax
		add	esp, 4
		mov	[esp+54h+var_38], ecx
		test	ecx, ecx
		jnz	short loc_10005855
		pop	esi
		pop	ebp
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10005855:				; CODE XREF: sub_10005820+2Dj
		mov	eax, [esp+54h+arg_10]
		lea	eax, [esi+eax-1]
		xor	edx, edx
		div	esi
		push	edi
		push	80h
		push	ecx
		mov	edi, eax
		mov	[esp+60h+var_24], edi
		call	PORT_ArenaZAlloc_Util
		imul	edi, esi
		push	edi
		push	0
		push	0
		mov	[esp+6Ch+Dst], eax
		call	SECITEM_AllocItem_Util
		mov	esi, eax
		add	esp, 14h
		mov	[esp+58h+var_48], esi
		test	esi, esi
		jz	loc_10005B3E
		mov	ecx, [esp+58h+arg_4]
		mov	esi, [ecx+0Ch]
		mov	edx, [esp+58h+var_38]
		push	ebx
		mov	ebx, [esp+5Ch+arg_8]
		mov	edi, [ebx+8]
		add	esi, 3Fh
		add	edi, 3Fh
		and	esi, 0FFFFFFC0h
		and	edi, 0FFFFFFC0h
		lea	eax, [edi+esi]
		push	eax
		push	edx
		mov	[esp+64h+var_10], eax
		call	PORT_ArenaZAlloc_Util
		add	esp, 8
		mov	[esp+5Ch+var_14], eax
		test	eax, eax
		jz	loc_10005B39
		mov	ecx, [esp+5Ch+Dst]
		add	eax, esi
		mov	[esp+5Ch+var_28], eax
		movsx	eax, [esp+5Ch+arg_C]
		push	40h		; Size
		push	eax		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1000593B
		mov	edx, [esp+5Ch+arg_4]
		mov	eax, [edx+0Ch]
		mov	[esp+5Ch+var_4C], 0
		nop

loc_10005900:				; CODE XREF: sub_10005820+115j
		mov	ebx, [esp+5Ch+var_4C]
		mov	ecx, esi
		sub	ecx, ebx
		cmp	ecx, eax
		jnb	short loc_1000590E
		mov	eax, ecx

loc_1000590E:				; CODE XREF: sub_10005820+EAj
		mov	edx, [esp+5Ch+var_14]
		push	eax		; Size
		mov	eax, [esp+60h+arg_4]
		mov	ecx, [eax+8]
		push	ecx		; Src
		add	edx, ebx
		push	edx		; Dst
		call	memcpy
		mov	eax, [esp+68h+arg_4]
		mov	eax, [eax+0Ch]
		add	ebx, eax
		add	esp, 0Ch
		mov	[esp+5Ch+var_4C], ebx
		cmp	ebx, esi
		jb	short loc_10005900
		mov	ebx, [esp+5Ch+arg_8]

loc_1000593B:				; CODE XREF: sub_10005820+CEj
		test	edi, edi
		jz	short loc_1000597F
		mov	eax, [ebx+8]
		mov	[esp+5Ch+var_4C], 0
		lea	ebx, [ebx+0]

loc_10005950:				; CODE XREF: sub_10005820+15Dj
		mov	esi, [esp+5Ch+var_4C]
		mov	ecx, edi
		sub	ecx, esi
		cmp	ecx, eax
		jnb	short loc_1000595E
		mov	eax, ecx

loc_1000595E:				; CODE XREF: sub_10005820+13Aj
		mov	ecx, [ebx+4]
		mov	edx, [esp+5Ch+var_28]
		push	eax		; Size
		push	ecx		; Src
		add	edx, esi
		push	edx		; Dst
		call	memcpy
		mov	eax, [ebx+8]
		add	esi, eax
		add	esp, 0Ch
		mov	[esp+5Ch+var_4C], esi
		cmp	esi, edi
		jb	short loc_10005950

loc_1000597F:				; CODE XREF: sub_10005820+11Dj
		mov	eax, [esp+5Ch+Size]
		mov	ecx, [esp+5Ch+var_38]
		push	eax
		push	ecx
		call	PORT_ArenaZAlloc_Util
		mov	edi, eax
		add	esp, 8
		mov	[esp+5Ch+Src], edi
		test	edi, edi
		jz	loc_10005B39
		mov	edx, [ebp+4]
		call	edx
		mov	ebx, eax
		mov	[esp+5Ch+var_1C], ebx
		test	ebx, ebx
		jz	loc_10005B39
		mov	ecx, [esp+5Ch+var_24]
		xor	edx, edx
		mov	[esp+5Ch+var_4C], edx
		cmp	ecx, edx
		jbe	loc_10005B2E
		mov	eax, [esp+5Ch+var_10]
		shr	eax, 6
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+var_3C], edx
		mov	[esp+5Ch+var_28], ecx
		mov	[esp+5Ch+var_4C], ecx
		jmp	short loc_100059E4
; ---------------------------------------------------------------------------
		align 10h

loc_100059E0:				; CODE XREF: sub_10005820+308j
		mov	edi, [esp+5Ch+Src]

loc_100059E4:				; CODE XREF: sub_10005820+1BBj
		mov	eax, [esp+5Ch+var_48]
		mov	eax, [eax+4]
		add	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+arg_4]
		xor	esi, esi
		mov	[esp+5Ch+var_30], eax
		cmp	[ecx+28h], esi
		jle	short loc_10005A68
		mov	edi, edi

loc_10005A00:				; CODE XREF: sub_10005820+242j
		mov	edx, [ebp+10h]
		push	ebx
		call	edx
		add	esp, 4
		test	esi, esi
		jz	short loc_10005A1E
		mov	eax, [esp+5Ch+var_34]
		mov	ecx, [ebp+14h]
		push	eax
		push	edi
		push	ebx
		call	ecx
		add	esp, 0Ch
		jmp	short loc_10005A3E
; ---------------------------------------------------------------------------

loc_10005A1E:				; CODE XREF: sub_10005820+1EBj
		mov	edx, [esp+5Ch+Dst]
		mov	eax, [ebp+14h]
		push	40h
		push	edx
		push	ebx
		call	eax
		mov	ecx, [esp+68h+var_10]
		mov	edx, [esp+68h+var_14]
		mov	eax, [ebp+14h]
		push	ecx
		push	edx
		push	ebx
		call	eax
		add	esp, 18h

loc_10005A3E:				; CODE XREF: sub_10005820+1FCj
		mov	ecx, [ebp+0]
		mov	eax, [ebp+18h]
		push	ecx
		lea	edx, [esp+60h+var_34]
		push	edx
		push	edi
		push	ebx
		call	eax
		mov	ecx, [esp+6Ch+var_34]
		add	esp, 10h
		cmp	ecx, [ebp+0]
		jnz	short loc_10005A64
		mov	edx, [esp+5Ch+arg_4]
		inc	esi
		cmp	esi, [edx+28h]
		jl	short loc_10005A00

loc_10005A64:				; CODE XREF: sub_10005820+238j
		mov	eax, [esp+5Ch+var_30]

loc_10005A68:				; CODE XREF: sub_10005820+1DCj
		mov	edi, [esp+5Ch+Size]
		mov	ecx, [esp+5Ch+Src]
		push	edi		; Size
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		xor	esi, esi
		jmp	short loc_10005A84
; ---------------------------------------------------------------------------
		align 10h

loc_10005A80:				; CODE XREF: sub_10005820+291j
		mov	edi, [esp+5Ch+Size]

loc_10005A84:				; CODE XREF: sub_10005820+25Dj
		mov	eax, 40h
		sub	eax, esi
		cmp	eax, edi
		jb	short loc_10005A91
		mov	eax, edi

loc_10005A91:				; CODE XREF: sub_10005820+26Dj
		mov	edi, [esp+5Ch+Dst]
		mov	edx, [esp+5Ch+Src]
		push	eax		; Size
		add	edi, 40h
		push	edx		; Src
		lea	eax, [esi+edi]
		push	eax		; Dst
		call	memcpy
		add	esi, [esp+68h+Size]
		add	esp, 0Ch
		cmp	esi, 40h
		jb	short loc_10005A80
		mov	edx, [esp+5Ch+var_20]
		test	edx, edx
		jz	short loc_10005B1C
		mov	eax, [esp+5Ch+var_14]
		lea	ecx, [eax+3Fh]
		mov	[esp+5Ch+var_30], ecx
		sub	edi, eax
		mov	[esp+5Ch+var_2C], edx
		lea	esp, [esp+0]

loc_10005AD0:				; CODE XREF: sub_10005820+2F2j
		mov	esi, 3Fh
		lea	eax, [esi-3Eh]
		xor	edx, edx
		lea	ebx, [ebx+0]

loc_10005AE0:				; CODE XREF: sub_10005820+2DEj
		movzx	ebx, byte ptr [edi+ecx]
		movzx	ebp, byte ptr [ecx]
		add	ebx, edx
		add	ebp, ebx
		add	eax, ebp
		mov	edx, 0FFh
		cmp	edx, eax
		sbb	edx, edx
		mov	[ecx], al
		neg	edx
		dec	ecx
		xor	eax, eax
		dec	esi
		jns	short loc_10005AE0
		mov	ecx, [esp+5Ch+var_30]
		add	ecx, 40h
		sub	edi, 40h
		dec	[esp+5Ch+var_2C]
		mov	[esp+5Ch+var_30], ecx
		jnz	short loc_10005AD0
		mov	ebx, [esp+5Ch+var_1C]
		mov	ebp, [esp+5Ch+arg_0]

loc_10005B1C:				; CODE XREF: sub_10005820+299j
		mov	eax, [esp+5Ch+Size]
		add	[esp+5Ch+var_3C], eax
		dec	[esp+5Ch+var_28]
		jnz	loc_100059E0

loc_10005B2E:				; CODE XREF: sub_10005820+19Ej
		mov	ecx, [ebp+0Ch]
		push	1
		push	ebx
		call	ecx
		add	esp, 8

loc_10005B39:				; CODE XREF: sub_10005820+ABj
					; sub_10005820+179j ...
		mov	esi, [esp+5Ch+var_48]
		pop	ebx

loc_10005B3E:				; CODE XREF: sub_10005820+6Fj
		mov	edx, [esp+58h+var_38]
		push	1
		push	edx
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	edi
		test	esi, esi
		jz	short loc_10005B82
		mov	eax, [esp+54h+var_24]
		cmp	[esp+54h+var_4C], eax
		jz	short loc_10005B7B
		push	1
		push	esi
		call	SECITEM_ZfreeItem_Util
		mov	[esp+5Ch+var_48], 0
		mov	esi, [esp+5Ch+var_48]
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	ebp
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10005B7B:				; CODE XREF: sub_10005820+33Aj
		mov	ecx, [esp+54h+arg_10]
		mov	[esi+8], ecx

loc_10005B82:				; CODE XREF: sub_10005820+330j
		mov	eax, esi
		pop	esi
		pop	ebp
		add	esp, 4Ch
		retn
sub_10005820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005B90	proc near		; CODE XREF: sub_100065A0+42p
					; sub_1000F5C0+53p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	[esp+8+var_4], 0
		test	edi, edi
		jz	loc_10005DB0
		cmp	[esp+8+arg_4], 0
		jz	loc_10005DB0
		mov	eax, [edi+2Ch]
		push	ebp
		push	eax
		push	0
		push	0
		call	SECITEM_AllocItem_Util
		mov	ebp, eax
		add	esp, 0Ch
		mov	[esp+0Ch+arg_0], ebp
		test	ebp, ebp
		jnz	short loc_10005BD0
		pop	ebp
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005BD0:				; CODE XREF: sub_10005B90+3Aj
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	esi
		test	ebx, ebx
		jz	short loc_10005C09
		mov	eax, [edi+30h]
		test	eax, eax
		jz	short loc_10005C09
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_10005C09
		push	eax
		mov	[esp+18h+var_4], 1
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[ebx+4], eax
		test	eax, eax
		jz	loc_10005D5B
		mov	ecx, [edi+30h]
		mov	[ebx+8], ecx

loc_10005C09:				; CODE XREF: sub_10005B90+48j
					; sub_10005B90+4Fj ...
		mov	edx, [edi+38h]
		push	edx
		call	sub_10022040
		mov	esi, eax
		mov	eax, [edi+3Ch]
		add	esp, 4
		sub	eax, 0
		jz	loc_10005CAD
		dec	eax
		jz	short loc_10005C8D
		dec	eax
		jnz	loc_10005D54
		cmp	[esp+14h+var_4], eax
		jz	short loc_10005C72
		mov	eax, [ebx+8]
		mov	ecx, [esp+14h+arg_4]
		push	eax
		push	2
		push	ecx
		push	edi
		push	esi
		call	sub_10005820
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jz	loc_10005D50
		mov	edx, [ebx+8]
		mov	eax, [ebp+4]
		mov	ecx, [ebx+4]
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		push	1
		push	ebp
		call	SECITEM_ZfreeItem_Util
		mov	ebp, [esp+28h+arg_0]
		add	esp, 14h

loc_10005C72:				; CODE XREF: sub_10005B90+A1j
		mov	edx, [ebp+8]
		mov	eax, [edi+58h]
		mov	ecx, [esp+14h+arg_4]
		push	edx
		push	eax
		push	ecx
		push	edi
		push	esi
		call	sub_10005820
		add	esp, 14h
		mov	esi, eax
		jmp	short loc_10005CEB
; ---------------------------------------------------------------------------

loc_10005C8D:				; CODE XREF: sub_10005B90+94j
		mov	edx, [esp+14h+arg_4]
		push	edx
		push	edi
		push	esi
		call	sub_100055D0
		add	esp, 0Ch
		cmp	[esp+14h+var_4], 0
		mov	esi, eax
		jz	short loc_10005CEB
		mov	eax, [ebx+8]
		mov	ecx, [edi+34h]
		jmp	short loc_10005CDD
; ---------------------------------------------------------------------------

loc_10005CAD:				; CODE XREF: sub_10005B90+8Dj
		mov	eax, [esp+14h+arg_4]
		mov	ecx, [esp+14h+arg_C]
		push	eax
		push	esi
		mov	eax, edi
		call	sub_10005560
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_10005D54
		cmp	[esp+14h+var_4], 0
		jz	short loc_10005CEB
		mov	ecx, [esi+8]
		add	ecx, [esi+4]
		mov	eax, [ebx+8]
		sub	ecx, eax

loc_10005CDD:				; CODE XREF: sub_10005B90+11Bj
		mov	edx, [ebx+4]
		push	eax		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10005CEB:				; CODE XREF: sub_10005B90+FBj
					; sub_10005B90+113j ...
		test	esi, esi
		jz	short loc_10005D54
		cmp	dword ptr [edi+60h], 0
		jz	loc_10005D89
		mov	edx, [ebp+8]
		mov	ecx, [ebp+4]
		add	edx, edx
		mov	eax, 0AAAAAAABh
		mul	edx
		mov	eax, [esi+4]
		shr	edx, 1
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	ecx, [ebp+8]
		mov	edi, [ebp+4]
		mov	eax, 0AAAAAAABh
		mul	ecx
		shr	edx, 1
		push	edx		; Size
		lea	edx, [ecx+ecx]
		mov	eax, 0AAAAAAABh
		mul	edx
		shr	edx, 1
		add	edx, edi
		push	edi		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 18h
		push	1
		push	esi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		pop	esi
		pop	ebx
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005D50:				; CODE XREF: sub_10005B90+BCj
		mov	ebp, [esp+14h+arg_0]

loc_10005D54:				; CODE XREF: sub_10005B90+97j
					; sub_10005B90+135j ...
		cmp	[esp+14h+var_4], 0
		jz	short loc_10005D76

loc_10005D5B:				; CODE XREF: sub_10005B90+6Dj
		mov	eax, [ebx+4]
		test	eax, eax
		jz	short loc_10005D76
		mov	ecx, [ebx+8]
		push	ecx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8
		mov	dword ptr [ebx+4], 0

loc_10005D76:				; CODE XREF: sub_10005B90+1C9j
					; sub_10005B90+1D0j
		push	1
		push	ebp
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		pop	esi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005D89:				; CODE XREF: sub_10005B90+163j
		mov	eax, [ebp+8]
		mov	ecx, [esi+4]
		mov	edx, [ebp+4]
		push	eax		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		push	1
		push	esi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		pop	esi
		pop	ebx
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005DB0:				; CODE XREF: sub_10005B90+10j
					; sub_10005B90+1Bj
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
sub_10005B90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005DC0	proc near		; CODE XREF: sub_10005FA0+2Ep
					; sub_10006940+55p
		push	esi
		xor	esi, esi
		xor	edx, edx
		mov	dword ptr [eax+2Ch], 5
		mov	dword ptr [eax+30h], 8
		mov	dword ptr [eax+38h], 3
		mov	[eax+3Ch], esi
		mov	dword ptr [eax+5Ch], 5
		mov	[eax+60h], esi
		cmp	ecx, 125h
		jg	loc_10005EC8	; jumptable 10005E15 default case
		cmp	ecx, 123h
		jge	loc_10005EB0
		add	ecx, 0FFFFFFEBh	; switch 139 cases
		cmp	ecx, 8Ah
		ja	loc_10005EC8	; jumptable 10005E15 default case
		movzx	ecx, ds:byte_10005F0C[ecx]
		jmp	ds:off_10005ED0[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10005E1C:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+60h], 1 ; jumptable 10005E15 case 157

loc_10005E23:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+3Ch], 2 ; jumptable 10005E15 case 156

loc_10005E2A:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+2Ch], 18h ; jumptable 10005E15 case 117
		mov	dword ptr [eax+5Ch], 7
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E3C:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+38h], 1 ; jumptable 10005E15 case 21
		mov	dword ptr [eax+2Ch], 8
		mov	dword ptr [eax+5Ch], 0Ah
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E55:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+38h], 2 ; jumptable 10005E15 case 22

loc_10005E5C:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+2Ch], 8 ; jumptable 10005E15 case 23
		mov	dword ptr [eax+5Ch], 0Ah
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E6E:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+2Ch], 10h ; jumptable 10005E15 case 158

loc_10005E75:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+3Ch], 2 ; jumptable 10005E15 case 159
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E80:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+2Ch], 10h ; jumptable 10005E15 case 118
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E8B:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	edx, 1		; jumptable 10005E15 case 115

loc_10005E90:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+2Ch], 10h ; jumptable 10005E15 case 154
		cmp	edx, esi
		jnz	short loc_10005EA2 ; jumptable 10005E15	case 116

loc_10005E9B:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		mov	dword ptr [eax+3Ch], 2 ; jumptable 10005E15 case 155

loc_10005EA2:				; CODE XREF: sub_10005DC0+55j
					; sub_10005DC0+D9j
					; DATA XREF: ...
		mov	[eax+30h], esi	; jumptable 10005E15 case 116
		mov	dword ptr [eax+5Ch], 6
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005EB0:				; CODE XREF: sub_10005DC0+39j
		mov	dword ptr [eax+3Ch], 1
		mov	dword ptr [eax+5Ch], 123h
		mov	[eax+2Ch], esi
		mov	[eax+30h], esi

loc_10005EC4:				; CODE XREF: sub_10005DC0+55j
					; DATA XREF: .text:off_10005ED0o
		xor	eax, eax	; jumptable 10005E15 case 119
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005EC8:				; CODE XREF: sub_10005DC0+2Dj
					; sub_10005DC0+48j ...
		or	eax, 0FFFFFFFFh	; jumptable 10005E15 default case
		pop	esi
		retn
sub_10005DC0	endp

; ---------------------------------------------------------------------------
		align 10h
off_10005ED0	dd offset loc_10005E3C,	offset loc_10005E55, offset loc_10005E5C
					; DATA XREF: sub_10005DC0+55r
		dd offset loc_10005E8B,	offset loc_10005EA2, offset loc_10005E2A ; jump	table for switch statement
		dd offset loc_10005E80,	offset loc_10005EC4, offset loc_10005E90
		dd offset loc_10005E9B,	offset loc_10005E23, offset loc_10005E1C
		dd offset loc_10005E6E,	offset loc_10005E75, offset loc_10005EC8
byte_10005F0C	db	0,     1,     2,   0Eh ; DATA XREF: sub_10005DC0+4Er
		db    0Eh,   0Eh,   0Eh,   0Eh ; indirect table	for switch statement
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,     3,     4
		db	5,     6,     7,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,     8,     9,   0Ah
		db    0Bh,   0Ch,   0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005FA0	proc near		; CODE XREF: sub_100143D0+80p
					; sub_1001E950+5Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		push	800h
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10005FB6
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10005FB6:				; CODE XREF: sub_10005FA0+12j
		push	esi
		push	64h
		push	edi
		call	PORT_ArenaZAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10005FFF
		mov	ecx, [esp+8+arg_0]
		mov	[esi], edi
		call	sub_10005DC0
		test	eax, eax
		jnz	short loc_10005FFF
		mov	ecx, [esp+8+arg_8]
		mov	[esi+28h], ecx
		mov	ecx, [esp+8+arg_4]
		test	ecx, ecx
		jz	short loc_10005FF4
		push	ecx
		lea	edx, [esi+4]
		push	edx
		push	edi
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch

loc_10005FF4:				; CODE XREF: sub_10005FA0+44j
		mov	dword ptr [esi+58h], 1
		test	eax, eax
		jz	short loc_1000600C

loc_10005FFF:				; CODE XREF: sub_10005FA0+26j
					; sub_10005FA0+35j
		push	1
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		xor	esi, esi

loc_1000600C:				; CODE XREF: sub_10005FA0+5Dj
		mov	eax, esi
		pop	esi
		pop	edi
		retn
sub_10005FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006020	proc near		; CODE XREF: sub_10006940+147p
					; sub_1001EA40+13p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		add	eax, 0FFFFFEDAh	; switch 5 cases
		cmp	eax, 4
		ja	short loc_1000604D ; jumptable 1000602E	default	case
		jmp	ds:off_10006050[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006035:				; CODE XREF: sub_10006020+Ej
					; DATA XREF: .text:off_10006050o
		mov	eax, 3		; jumptable 1000602E case 294
		retn
; ---------------------------------------------------------------------------

loc_1000603B:				; CODE XREF: sub_10006020+Ej
					; DATA XREF: .text:off_10006050o
		mov	eax, 4		; jumptable 1000602E case 296
		retn
; ---------------------------------------------------------------------------

loc_10006041:				; CODE XREF: sub_10006020+Ej
					; DATA XREF: .text:off_10006050o
		mov	eax, 5		; jumptable 1000602E case 297
		retn
; ---------------------------------------------------------------------------

loc_10006047:				; CODE XREF: sub_10006020+Ej
					; DATA XREF: .text:off_10006050o
		mov	eax, 6		; jumptable 1000602E case 298
		retn
; ---------------------------------------------------------------------------

loc_1000604D:				; CODE XREF: sub_10006020+Cj
					; sub_10006020+Ej
					; DATA XREF: ...
		xor	eax, eax	; jumptable 1000602E default case
		retn
sub_10006020	endp

; ---------------------------------------------------------------------------
off_10006050	dd offset loc_10006035	; DATA XREF: sub_10006020+Er
		dd offset loc_1000604D	; jump table for switch	statement
		dd offset loc_1000603B
		dd offset loc_10006041
		dd offset loc_10006047
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006070	proc near		; CODE XREF: sub_100143D0+19Ap
					; sub_100145A0+36Cp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short locret_10006085
		mov	eax, [eax]
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

locret_10006085:			; CODE XREF: sub_10006070+6j
		retn
sub_10006070	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10006090:				; DATA XREF: sub_100065A0:loc_10006620o
					; sub_100065A0:loc_1000662Bo
		push	ecx
		mov	eax, [esp+10h]
		push	ebp
		test	eax, eax
		jz	loc_10006206
		cmp	dword ptr [esp+0Ch], 0
		jz	loc_10006206
		mov	ebp, [esp+10h]
		test	ebp, ebp
		jz	loc_10006206
		push	ebx
		push	eax
		call	SECITEM_DupItem_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_100060C9
		pop	ebx
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100060C9:				; CODE XREF: .text:100060C3j
		push	edi
		mov	edi, [esp+24h]
		test	edi, edi
		jz	short loc_10006102
		mov	ecx, [ebx+4]
		push	8
		lea	eax, [ebx+8]
		push	eax
		mov	eax, [eax]
		push	eax
		push	ecx
		push	0
		call	sub_10006AF0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_100060FF
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100060FF:				; CODE XREF: .text:100060EBj
		mov	[ebx+4], eax

loc_10006102:				; CODE XREF: .text:100060D0j
		push	esi
		push	0Ch
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_100061F1
		mov	edx, [ebx+8]
		add	edx, 40h
		push	edx
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_100061E6
		mov	ecx, [ebp+4]
		mov	edx, [esp+18h]
		xor	eax, eax
		cmp	[esp+24h], eax
		push	edi
		setnz	al
		lea	eax, [eax+eax+1]
		push	eax
		mov	eax, [edx+4]
		push	ecx
		push	eax
		call	sub_10020F20
		mov	ecx, eax
		add	esp, 10h
		mov	[esp+10h], ecx
		test	ecx, ecx
		jz	loc_100061E6
		mov	edx, offset sub_10020F80
		test	edi, edi
		jnz	short loc_10006170
		mov	edx, offset sub_10020FB0

loc_10006170:				; CODE XREF: .text:10006169j
		mov	eax, [ebx+8]
		mov	ebp, [ebx+4]
		push	eax
		push	ebp
		add	eax, 40h
		push	eax
		mov	eax, [esi+4]
		lea	edi, [esi+8]
		push	edi
		push	eax
		push	ecx
		call	edx ; sub_10020F80
		add	esp, 18h
		cmp	dword ptr [esp+28h], 0
		mov	ebp, eax
		mov	[esp+20h], ebp
		jnz	short loc_100061D2
		test	ebp, ebp
		jnz	short loc_100061D2
		mov	eax, [edi]
		mov	edx, [esi+4]
		movzx	ecx, byte ptr [edx+eax-1]
		add	edx, eax
		lea	ebp, [ecx-1]
		cmp	ebp, 7
		ja	short loc_100061C2
		sub	edx, ecx
		movzx	edx, byte ptr [edx]
		cmp	edx, ecx
		jnz	short loc_100061C2
		mov	ebp, [esp+20h]
		sub	eax, ecx
		mov	[edi], eax
		jmp	short loc_100061D2
; ---------------------------------------------------------------------------

loc_100061C2:				; CODE XREF: .text:100061ADj
					; .text:100061B6j
		push	0FFFFE00Fh
		or	ebp, 0FFFFFFFFh
		call	PORT_SetError_Util
		add	esp, 4

loc_100061D2:				; CODE XREF: .text:10006195j
					; .text:10006199j ...
		mov	eax, [esp+10h]
		push	1
		push	eax
		call	sub_10020F50
		add	esp, 8
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_100061F3

loc_100061E6:				; CODE XREF: .text:1000612Bj
					; .text:1000615Cj
		push	1
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100061F1:				; CODE XREF: .text:10006111j
		xor	esi, esi

loc_100061F3:				; CODE XREF: .text:100061E4j
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006206:				; CODE XREF: .text:10006098j
					; .text:100060A3j ...
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006210	proc near		; CODE XREF: sub_100065A0+BBp
					; sub_100065A0+E1p
					; DATA XREF: ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_10		= dword	ptr  14h

		push	ecx
		mov	eax, [esp+4+arg_8]
		push	ebp
		test	eax, eax
		jz	loc_10006380
		mov	ebp, [esp+8+arg_0]
		test	ebp, ebp
		jz	loc_10006380
		cmp	[esp+8+arg_4], 0
		jz	loc_10006380
		push	ebx
		push	eax
		call	SECITEM_DupItem_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10006249
		pop	ebx
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006249:				; CODE XREF: sub_10006210+33j
		push	edi
		mov	edi, [esp+10h+arg_10]
		test	edi, edi
		jz	short loc_10006282
		mov	ecx, [ebx+4]
		push	10h		; int
		lea	eax, [ebx+8]
		push	eax		; int
		mov	eax, [eax]
		push	eax		; Val
		push	ecx		; int
		push	0		; int
		call	sub_10006AF0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000627F
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000627F:				; CODE XREF: sub_10006210+5Bj
		mov	[ebx+4], eax

loc_10006282:				; CODE XREF: sub_10006210+40j
		push	esi
		push	0Ch
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_1000636B
		mov	edx, [ebx+8]
		add	edx, 40h
		push	edx
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_10006360
		mov	eax, [ebp+8]
		mov	ecx, [esp+14h+arg_4]
		mov	edx, [ecx+4]
		push	10h
		push	eax
		mov	eax, [ebp+4]
		push	edi
		push	1
		push	edx
		push	eax
		call	sub_100210D0
		mov	ebp, eax
		add	esp, 18h
		test	ebp, ebp
		jz	loc_10006360
		mov	ecx, offset sub_10021130
		test	edi, edi
		jnz	short loc_100062E6
		mov	ecx, offset sub_10021170

loc_100062E6:				; CODE XREF: sub_10006210+CFj
		mov	eax, [ebx+8]
		mov	edx, [ebx+4]
		push	eax
		push	edx
		add	eax, 40h
		push	eax
		mov	eax, [esi+4]
		lea	edi, [esi+8]
		push	edi
		push	eax
		push	ebp
		call	ecx ; sub_10021130
		add	esp, 18h
		cmp	[esp+14h+arg_10], 0
		mov	[esp+14h+arg_8], eax
		jnz	short loc_1000634E
		test	eax, eax
		jnz	short loc_1000634E
		mov	eax, [edi]
		mov	ecx, [esi+4]
		add	ecx, eax
		mov	[esp+14h+var_4], ecx
		movzx	ecx, byte ptr [ecx-1]
		lea	edx, [ecx-1]
		cmp	edx, 0Fh
		ja	short loc_10006339
		mov	edx, [esp+14h+var_4]
		sub	edx, ecx
		movzx	edx, byte ptr [edx]
		cmp	edx, ecx
		jnz	short loc_10006339
		sub	eax, ecx
		mov	[edi], eax
		jmp	short loc_1000634E
; ---------------------------------------------------------------------------

loc_10006339:				; CODE XREF: sub_10006210+114j
					; sub_10006210+121j
		push	0FFFFE00Fh
		mov	[esp+18h+arg_8], 0FFFFFFFFh
		call	PORT_SetError_Util
		add	esp, 4

loc_1000634E:				; CODE XREF: sub_10006210+F9j
					; sub_10006210+FDj ...
		push	1
		push	ebp
		call	sub_10021100
		add	esp, 8
		cmp	[esp+14h+arg_8], 0FFFFFFFFh
		jnz	short loc_1000636D

loc_10006360:				; CODE XREF: sub_10006210+9Bj
					; sub_10006210+C2j
		push	1
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1000636B:				; CODE XREF: sub_10006210+81j
		xor	esi, esi

loc_1000636D:				; CODE XREF: sub_10006210+14Ej
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006380:				; CODE XREF: sub_10006210+8j
					; sub_10006210+14j ...
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
sub_10006210	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10006390:				; DATA XREF: sub_100065A0:loc_10006636o
		mov	eax, [esp+0Ch]
		push	ebx
		push	ebp
		test	eax, eax
		jz	loc_100064DB
		mov	ebx, [esp+0Ch]
		test	ebx, ebx
		jz	loc_100064DB
		mov	ebp, [esp+10h]
		test	ebp, ebp
		jz	loc_100064DB
		push	edi
		push	eax
		call	SECITEM_DupItem_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_100063F3
		cmp	dword ptr [esp+20h], 0
		jz	short loc_100063FC
		mov	ecx, [edi+4]
		push	8
		lea	eax, [edi+8]
		push	eax
		mov	eax, [eax]
		push	eax
		push	ecx
		push	0
		call	sub_10006AF0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_100063F9
		push	1
		push	edi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100063F3:				; CODE XREF: .text:100063C4j
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100063F9:				; CODE XREF: .text:100063E6j
		mov	[edi+4], eax

loc_100063FC:				; CODE XREF: .text:100063CBj
		push	esi
		push	0Ch
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_100064C9
		mov	edx, [edi+8]
		add	edx, 40h
		push	edx
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_100064BC
		mov	eax, [ebx+8]
		mov	ecx, [ebp+4]
		mov	edx, [ebx+4]
		push	eax
		push	1
		push	ecx
		push	eax
		push	edx
		call	sub_10020E60
		add	esp, 14h
		test	eax, eax
		jz	short loc_100064BC
		cmp	dword ptr [esp+24h], 0
		mov	edx, offset sub_10020EC0
		jnz	short loc_10006457
		mov	edx, offset sub_10020EF0

loc_10006457:				; CODE XREF: .text:10006450j
		mov	ecx, [edi+8]
		mov	ebp, [edi+4]
		push	ecx
		push	ebp
		add	ecx, 40h
		push	ecx
		mov	ecx, [esi+4]
		lea	ebx, [esi+8]
		push	ebx
		push	ecx
		push	eax
		call	edx ; sub_10020EC0
		add	esp, 18h
		test	eax, eax
		jnz	short loc_100064BC
		cmp	dword ptr [esp+24h], 1
		jz	short loc_100064C9
		mov	eax, [ebx]
		mov	edx, [esi+4]
		movzx	ecx, byte ptr [edx+eax-1]
		add	edx, eax
		lea	ebp, [ecx-1]
		cmp	ebp, 7
		ja	short loc_100064AF
		sub	edx, ecx
		movzx	edx, byte ptr [edx]
		cmp	edx, ecx
		jnz	short loc_100064AF
		sub	eax, ecx
		push	1
		push	edi
		mov	[ebx], eax
		call	SECITEM_FreeItem_Util
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100064AF:				; CODE XREF: .text:1000648Ej
					; .text:10006497j
		push	0FFFFE00Fh
		call	PORT_SetError_Util
		add	esp, 4

loc_100064BC:				; CODE XREF: .text:10006425j
					; .text:10006444j ...
		push	1
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8
		xor	esi, esi

loc_100064C9:				; CODE XREF: .text:1000640Bj
					; .text:1000647Aj
		push	1
		push	edi
		call	SECITEM_FreeItem_Util
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100064DB:				; CODE XREF: .text:10006398j
					; .text:100063A4j ...
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn

; =============== S U B	R O U T	I N E =======================================


sub_100064E0	proc near		; DATA XREF: sub_100065A0:loc_1000663Do

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	edi
		test	ebx, ebx
		jz	loc_1000658E
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	loc_1000658E
		cmp	[esp+8+arg_4], 0
		jz	loc_1000658E
		push	esi
		push	0Ch
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10006588
		mov	eax, [ebx+8]
		add	eax, 40h
		push	eax
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jz	short loc_1000657B
		mov	ecx, [edi+8]
		mov	edx, [edi+4]
		push	ecx
		push	edx
		call	sub_10020DA0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1000657B
		cmp	[esp+0Ch+arg_10], 0
		mov	ecx, offset sub_10020E00
		jnz	short loc_10006553
		mov	ecx, offset sub_10020E30

loc_10006553:				; CODE XREF: sub_100064E0+6Cj
		mov	eax, [ebx+8]
		mov	edx, [ebx+4]
		push	eax
		push	edx
		mov	edx, [esi+4]
		add	eax, 40h
		push	eax
		lea	eax, [esi+8]
		push	eax
		push	edx
		push	edi
		call	ecx ; sub_10020E00
		push	1
		push	edi
		mov	ebx, eax
		call	sub_10020DD0
		add	esp, 20h
		test	ebx, ebx
		jz	short loc_10006588

loc_1000657B:				; CODE XREF: sub_100064E0+4Aj
					; sub_100064E0+60j
		push	1
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8
		xor	esi, esi

loc_10006588:				; CODE XREF: sub_100064E0+34j
					; sub_100064E0+99j
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000658E:				; CODE XREF: sub_100064E0+8j
					; sub_100064E0+14j ...
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
sub_100064E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100065A0	proc near		; CODE XREF: sub_1001E8E0+2Cp
					; sub_1001E950+85p

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_10]
		push	ebx
		xor	ebx, ebx
		push	ebp
		mov	ebp, 1
		mov	[esp+18h+var_10], ebp
		mov	[esp+18h+var_8], ebx
		cmp	eax, ebx
		jz	short loc_100065BE
		mov	[eax], ebx

loc_100065BE:				; CODE XREF: sub_100065A0+1Aj
		mov	eax, [esp+18h+arg_4]
		cmp	eax, ebx
		jz	loc_100066C5
		cmp	[esp+18h+arg_8], ebx
		jz	loc_100066C5
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		push	edi
		push	ebx
		lea	ecx, [esp+24h+var_C]
		push	ecx
		push	eax
		push	esi
		call	sub_10005B90
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebx
		jnz	short loc_100065FA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100065FA:				; CODE XREF: sub_100065A0+4Ej
		mov	eax, [esi+5Ch]
		add	eax, 0FFFFFFFBh	; switch 184 cases
		cmp	eax, 0B7h
		ja	loc_1000669A	; jumptable 10006612 default case
		movzx	edx, ds:byte_100066E8[eax]
		jmp	ds:off_100066D0[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006619:				; CODE XREF: sub_100065A0+72j
					; DATA XREF: .text:off_100066D0o
		mov	esi, offset sub_10006210 ; jumptable 10006612 cases 184,186,188
		jmp	short loc_10006642
; ---------------------------------------------------------------------------

loc_10006620:				; CODE XREF: sub_100065A0+72j
					; DATA XREF: .text:off_100066D0o
		mov	esi, offset loc_10006090 ; jumptable 10006612 case 7
		mov	[esp+20h+var_10], ebp
		jmp	short loc_10006642
; ---------------------------------------------------------------------------

loc_1000662B:				; CODE XREF: sub_100065A0+72j
					; DATA XREF: .text:off_100066D0o
		mov	esi, offset loc_10006090 ; jumptable 10006612 case 10
		mov	[esp+20h+var_10], ebx
		jmp	short loc_10006642
; ---------------------------------------------------------------------------

loc_10006636:				; CODE XREF: sub_100065A0+72j
					; DATA XREF: .text:off_100066D0o
		mov	esi, offset loc_10006390 ; jumptable 10006612 case 5
		jmp	short loc_10006642
; ---------------------------------------------------------------------------

loc_1000663D:				; CODE XREF: sub_100065A0+72j
					; DATA XREF: .text:off_100066D0o
		mov	esi, offset sub_100064E0 ; jumptable 10006612 case 6

loc_10006642:				; CODE XREF: sub_100065A0+7Ej
					; sub_100065A0+89j ...
		cmp	esi, ebx
		jz	short loc_1000669A ; jumptable 10006612	default	case
		mov	ebp, [esp+20h+arg_C]
		mov	eax, [esp+20h+var_10]
		mov	ecx, [esp+20h+arg_8]
		push	ebp
		push	eax
		push	ecx
		lea	edx, [esp+2Ch+var_C]
		push	edx
		push	edi
		call	esi ; sub_10006210
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jnz	short loc_1000669A ; jumptable 10006612	default	case
		test	ebp, ebp
		jnz	short loc_1000669A ; jumptable 10006612	default	case
		mov	eax, [esp+20h+arg_0]
		cmp	dword ptr [eax+5Ch], 7
		jnz	short loc_1000669A ; jumptable 10006612	default	case
		mov	ecx, [esp+20h+arg_8]
		push	ebx
		push	ebx
		push	ecx
		lea	edx, [esp+2Ch+var_C]
		push	edx
		push	edi
		call	esi ; sub_10006210
		mov	ebx, eax
		mov	eax, [esp+34h+arg_10]
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000669A ; jumptable 10006612	default	case
		test	ebx, ebx
		jz	short loc_1000669A ; jumptable 10006612	default	case
		mov	dword ptr [eax], 1

loc_1000669A:				; CODE XREF: sub_100065A0+65j
					; sub_100065A0+72j ...
		push	1		; jumptable 10006612 default case
		push	edi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		cmp	[esp+20h+var_8], 0
		jz	short loc_100066BB
		lea	eax, [esp+20h+var_C]
		push	0
		push	eax
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_100066BB:				; CODE XREF: sub_100065A0+10Aj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100066C5:				; CODE XREF: sub_100065A0+24j
					; sub_100065A0+2Ej
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
sub_100065A0	endp

; ---------------------------------------------------------------------------
		align 10h
off_100066D0	dd offset loc_10006636,	offset loc_1000663D, offset loc_10006620
					; DATA XREF: sub_100065A0+72r
		dd offset loc_1000662B,	offset loc_10006619, offset loc_1000669A ; jump	table for switch statement
byte_100066E8	db	0,     1,     2,     5 ; DATA XREF: sub_100065A0+6Br
		db	5,     3,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     4
		db	5,     4,     5,     4

; =============== S U B	R O U T	I N E =======================================


sub_100067A0	proc near		; CODE XREF: sub_1001E830+2Ap

var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Dst		= byte ptr -30h
var_18		= byte ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 3Ch
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+48h+arg_0]
		xor	ebx, ebx
		xor	ebp, ebp
		cmp	edi, ebx
		jnz	short loc_100067BB
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------

loc_100067BB:				; CODE XREF: sub_100067A0+10j
		push	18h
		push	edi
		mov	[esp+50h+var_38], ebx
		mov	[esp+50h+var_34], ebx
		call	PORT_ArenaZAlloc_Util
		add	esp, 8
		mov	[esp+48h+arg_0], eax
		cmp	eax, ebx
		jz	loc_10006933
		push	esi
		mov	esi, [esp+4Ch+arg_8]
		cmp	[esi+14h], ebx
		jnz	short loc_10006801
		mov	eax, [esi+28h]
		mov	edx, [esi]
		push	eax
		lea	ecx, [esi+10h]
		push	ecx
		push	edx
		call	SEC_ASN1EncodeInteger_Util
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_10006932

loc_10006801:				; CODE XREF: sub_100067A0+42j
		mov	eax, [esi+3Ch]
		sub	eax, 0
		jz	loc_100068CB
		dec	eax
		jz	short loc_10006821
		dec	eax
		jnz	loc_100068E1
		push	offset dword_10025E80
		jmp	loc_100068D0
; ---------------------------------------------------------------------------

loc_10006821:				; CODE XREF: sub_100067A0+6Ej
		cmp	[esi+20h], ebp
		jnz	short loc_10006841
		mov	ecx, [esi+2Ch]
		mov	eax, [esi]
		push	ecx
		lea	edx, [esi+1Ch]
		push	edx
		push	eax
		call	SEC_ASN1EncodeInteger_Util
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10006932

loc_10006841:				; CODE XREF: sub_100067A0+84j
		push	30h		; Size
		lea	ecx, [esp+50h+Dst]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		push	offset dword_10025F00
		push	esi
		lea	edx, [esp+60h+var_3C]
		push	edx
		push	edi
		call	SEC_ASN1EncodeItem_Util
		add	esp, 1Ch
		test	eax, eax
		jz	loc_10006932
		lea	eax, [esp+4Ch+var_3C]
		push	eax
		push	123h
		lea	ecx, [esp+54h+Dst]
		push	ecx
		push	edi
		call	SECOID_SetAlgorithmID_Util
		add	esp, 10h
		test	eax, eax
		jnz	loc_10006932
		mov	eax, [esi+30h]
		mov	edx, [esi+34h]
		mov	[esp+4Ch+var_34], eax
		neg	eax
		sbb	eax, eax
		lea	ecx, [esp+4Ch+var_3C]
		and	eax, ecx
		push	eax
		mov	[esp+50h+var_38], edx
		mov	edx, [esi+5Ch]
		push	edx
		lea	eax, [esp+54h+var_18]
		push	eax
		push	edi
		call	SECOID_SetAlgorithmID_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10006932
		push	offset dword_10025EC0
		lea	ecx, [esp+50h+Dst]
		push	ecx
		lea	edx, [esp+54h+var_3C]
		push	edx
		jmp	short loc_100068D6
; ---------------------------------------------------------------------------

loc_100068CB:				; CODE XREF: sub_100067A0+67j
		push	offset dword_10025E40

loc_100068D0:				; CODE XREF: sub_100067A0+7Cj
		push	esi
		lea	eax, [esp+54h+var_3C]
		push	eax

loc_100068D6:				; CODE XREF: sub_100067A0+129j
		push	edi
		call	SEC_ASN1EncodeItem_Util
		add	esp, 10h
		mov	ebx, eax

loc_100068E1:				; CODE XREF: sub_100067A0+71j
		test	ebx, ebx
		jz	short loc_10006932
		mov	edx, [esp+4Ch+arg_4]
		mov	eax, [esp+4Ch+arg_0]
		lea	ecx, [esp+4Ch+var_3C]
		push	ecx
		push	edx
		push	eax
		push	edi
		call	SECOID_SetAlgorithmID_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10006932
		push	18h
		call	PORT_ZAlloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_10006932
		mov	ecx, [esp+4Ch+arg_0]
		push	ecx
		push	ebp
		push	0
		call	SECOID_CopyAlgorithmID_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10006932
		push	1
		push	ebp
		call	SECOID_DestroyAlgorithmID_Util
		add	esp, 8
		xor	ebp, ebp

loc_10006932:				; CODE XREF: sub_100067A0+5Bj
					; sub_100067A0+9Bj ...
		pop	esi

loc_10006933:				; CODE XREF: sub_100067A0+34j
		pop	edi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 3Ch
		retn
sub_100067A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006940	proc near		; CODE XREF: sub_1001E780+52p

Dst		= byte ptr -30h
var_24		= byte ptr -24h
var_18		= byte ptr -18h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 30h
		push	ebx
		mov	ebx, [esp+34h+arg_0]
		test	ebx, ebx
		jnz	short loc_10006953
		xor	eax, eax
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10006953:				; CODE XREF: sub_10006940+Aj
		push	ebp
		push	esi
		push	edi
		push	ebx
		call	SECOID_GetAlgorithmTag_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10006AB0
		push	800h
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_10006AB0
		push	64h
		push	edi
		call	PORT_ArenaZAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_100069AB
		mov	ecx, ebp
		mov	[esi], edi
		call	sub_10005DC0
		test	eax, eax
		jnz	short loc_100069AB
		mov	eax, 1
		mov	[esi+28h], eax
		mov	[esi+58h], eax
		jmp	short loc_100069B8
; ---------------------------------------------------------------------------

loc_100069AB:				; CODE XREF: sub_10006940+4Fj
					; sub_10006940+5Cj
		push	1
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		xor	esi, esi

loc_100069B8:				; CODE XREF: sub_10006940+69j
		test	esi, esi
		jz	loc_10006AB0
		mov	eax, [esi+3Ch]
		sub	eax, 0
		jz	loc_10006ABC
		dec	eax
		jz	short loc_100069E4
		dec	eax
		jnz	loc_10006AA3
		add	ebx, 0Ch
		push	ebx
		push	offset dword_10025E80
		jmp	loc_10006AC5
; ---------------------------------------------------------------------------

loc_100069E4:				; CODE XREF: sub_10006940+8Dj
		push	30h		; Size
		lea	ecx, [esp+44h+Dst]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch
		add	ebx, 0Ch
		push	ebx
		cmp	ebp, 123h
		jnz	short loc_10006A16
		mov	edx, [esi]
		push	offset dword_10025F00
		push	esi
		push	edx
		call	SEC_ASN1DecodeItem_Util
		add	esp, 10h
		mov	edi, eax
		jmp	short loc_10006A7D
; ---------------------------------------------------------------------------

loc_10006A16:				; CODE XREF: sub_10006940+BFj
		mov	ecx, [esi]
		push	offset dword_10025EC0
		lea	eax, [esp+48h+Dst]
		push	eax
		push	ecx
		call	SEC_ASN1DecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10006AA3
		lea	edx, [esp+40h+var_18]
		push	edx
		call	SECOID_GetAlgorithmTag_Util
		mov	ecx, [esi]
		mov	[esi+5Ch], eax
		lea	eax, [esp+44h+var_24]
		push	eax
		push	offset dword_10025F00
		push	esi
		push	ecx
		call	SEC_ASN1DecodeItem_Util
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_10006AA3
		lea	edx, [esi+1Ch]
		push	edx
		call	DER_GetInteger_Util
		add	esp, 4
		mov	[esi+2Ch], eax
		cmp	ebp, 124h
		jnz	short loc_10006A7D
		mov	eax, [esp+40h+var_4]
		mov	[esi+30h], eax
		mov	ecx, [esp+40h+var_8]
		mov	[esi+34h], ecx

loc_10006A7D:				; CODE XREF: sub_10006940+D4j
					; sub_10006940+12Dj
		lea	edx, [esi+40h]
		push	edx
		call	SECOID_GetAlgorithmTag_Util
		push	eax
		call	sub_10006020
		add	esp, 8
		mov	[esi+38h], eax
		test	eax, eax
		jnz	short loc_10006AD3
		push	0FFFFE006h
		call	PORT_SetError_Util
		add	esp, 4

loc_10006AA3:				; CODE XREF: sub_10006940+90j
					; sub_10006940+EDj ...
		mov	edx, [esi]
		push	0
		push	edx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_10006AB0:				; CODE XREF: sub_10006940+23j
					; sub_10006940+3Aj ...
		xor	esi, esi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10006ABC:				; CODE XREF: sub_10006940+86j
		add	ebx, 0Ch
		push	ebx
		push	offset dword_10025E40

loc_10006AC5:				; CODE XREF: sub_10006940+9Fj
		mov	eax, [esi]
		push	esi
		push	eax
		call	SEC_ASN1DecodeItem_Util
		mov	edi, eax
		add	esp, 10h

loc_10006AD3:				; CODE XREF: sub_10006940+154j
		test	edi, edi
		jnz	short loc_10006AA3
		lea	ecx, [esi+10h]
		push	ecx
		call	DER_GetInteger_Util
		add	esp, 4
		pop	edi
		mov	[esi+28h], eax
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
sub_10006940	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10006AF0(int,	int, int Val, int, int)
sub_10006AF0	proc near		; CODE XREF: .text:100060E1p
					; sub_10006210+51p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Val		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		mov	ecx, [esp+Val]
		push	ebx
		lea	ebx, [ecx+eax]
		dec	eax
		not	eax
		and	ebx, eax
		mov	eax, [esp+4+arg_0]
		push	esi
		push	ebx
		test	eax, eax
		jz	short loc_10006B1C
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		push	ecx
		push	eax
		call	PORT_ArenaGrow_Util
		add	esp, 10h
		jmp	short loc_10006B29
; ---------------------------------------------------------------------------

loc_10006B1C:				; CODE XREF: sub_10006AF0+19j
		mov	edx, [esp+0Ch+arg_4]
		push	edx
		call	PORT_Realloc_Util
		add	esp, 8

loc_10006B29:				; CODE XREF: sub_10006AF0+2Aj
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10006B41
		push	0FFFFE013h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10006B41:				; CODE XREF: sub_10006AF0+3Dj
		mov	eax, [esp+8+Val]
		mov	cl, bl
		sub	cl, al
		mov	byte ptr [esp+8+Val], cl
		cmp	eax, ebx
		jnb	short loc_10006B67
		mov	edx, ebx
		sub	edx, eax
		lea	ecx, [esi+eax]
		mov	eax, [esp+8+Val]
		push	edx		; Size
		push	eax		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch

loc_10006B67:				; CODE XREF: sub_10006AF0+5Fj
		mov	ecx, [esp+8+arg_C]
		mov	eax, esi
		pop	esi
		mov	[ecx], ebx
		pop	ebx
		retn
sub_10006AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006B80	proc near		; CODE XREF: sub_1000B0B0+D1p
		test	edx, edx
		jz	loc_10006C14
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]
		mov	edi, edi

loc_10006B90:				; CODE XREF: sub_10006B80+15j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006B90
		sub	eax, esi
		pop	esi
		cmp	eax, 20h
		jle	short loc_10006BBF
		nop

loc_10006BA0:				; CODE XREF: sub_10006B80+3Dj
		test	eax, eax
		jle	short loc_10006BB7

loc_10006BA4:				; CODE XREF: sub_10006B80+33j
		mov	cl, [edx+eax-1]
		and	cl, 0C0h
		cmp	cl, 80h
		jnz	short loc_10006BB5
		dec	eax
		test	eax, eax
		jg	short loc_10006BA4

loc_10006BB5:				; CODE XREF: sub_10006B80+2Ej
		test	eax, eax

loc_10006BB7:				; CODE XREF: sub_10006B80+22j
		jz	short loc_10006BBA
		dec	eax

loc_10006BBA:				; CODE XREF: sub_10006B80:loc_10006BB7j
		cmp	eax, 20h
		jg	short loc_10006BA0

loc_10006BBF:				; CODE XREF: sub_10006B80+1Dj
		mov	ecx, 20202020h
		push	eax		; Size
		push	edx		; Src
		push	offset dword_10029588 ;	Dst
		mov	dword_10029588,	ecx
		mov	dword_1002958C,	ecx
		mov	dword_10029590,	ecx
		mov	dword_10029594,	ecx
		mov	dword_10029598,	ecx
		mov	dword_1002959C,	ecx
		mov	dword_100295A0,	ecx
		mov	dword_100295A4,	ecx
		mov	byte_100295A8, 0
		call	memcpy
		add	esp, 0Ch
		mov	off_10029118, offset dword_10029588

loc_10006C14:				; CODE XREF: sub_10006B80+2j
		test	edi, edi
		jz	loc_10006CA4
		mov	eax, edi
		lea	edx, [eax+1]

loc_10006C21:				; CODE XREF: sub_10006B80+A6j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006C21
		sub	eax, edx
		cmp	eax, 20h
		jle	short loc_10006C4F
		nop

loc_10006C30:				; CODE XREF: sub_10006B80+CDj
		test	eax, eax
		jle	short loc_10006C47

loc_10006C34:				; CODE XREF: sub_10006B80+C3j
		mov	dl, [edi+eax-1]
		and	dl, 0C0h
		cmp	dl, 80h
		jnz	short loc_10006C45
		dec	eax
		test	eax, eax
		jg	short loc_10006C34

loc_10006C45:				; CODE XREF: sub_10006B80+BEj
		test	eax, eax

loc_10006C47:				; CODE XREF: sub_10006B80+B2j
		jz	short loc_10006C4A
		dec	eax

loc_10006C4A:				; CODE XREF: sub_10006B80:loc_10006C47j
		cmp	eax, 20h
		jg	short loc_10006C30

loc_10006C4F:				; CODE XREF: sub_10006B80+ADj
		mov	ecx, 20202020h
		push	eax		; Size
		push	edi		; Src
		push	offset dword_100295AC ;	Dst
		mov	dword_100295AC,	ecx
		mov	dword_100295B0,	ecx
		mov	dword_100295B4,	ecx
		mov	dword_100295B8,	ecx
		mov	dword_100295BC,	ecx
		mov	dword_100295C0,	ecx
		mov	dword_100295C4,	ecx
		mov	dword_100295C8,	ecx
		mov	byte_100295CC, 0
		call	memcpy
		add	esp, 0Ch
		mov	off_1002911C, offset dword_100295AC

loc_10006CA4:				; CODE XREF: sub_10006B80+96j
		xor	eax, eax
		retn
sub_10006B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006CB0	proc near		; CODE XREF: sub_10006D60+C4p
					; sub_10009D10+1D0p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	esi
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006CDF
		mov	eax, [esp+8+arg_C]
		mov	ecx, [esp+8+arg_8]
		push	eax
		push	ecx
		push	esi
		push	edi
		call	sub_10016BB0
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006CDF:				; CODE XREF: sub_10006CB0+16j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10006CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006CF0	proc near		; CODE XREF: sub_1000A8F0:loc_1000AA9Fp
		push	2
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006D51
		push	1
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006D51
		push	10h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006D2E
		push	eax
		push	eax
		push	10h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	short locret_10006D56

loc_10006D2E:				; CODE XREF: sub_10006CF0+2Bj
		push	11h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006D4E
		push	eax
		push	eax
		push	11h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	short locret_10006D56

loc_10006D4E:				; CODE XREF: sub_10006CF0+4Bj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10006D51:				; CODE XREF: sub_10006CF0+Dj
					; sub_10006CF0+1Cj
		mov	eax, 13h

locret_10006D56:			; CODE XREF: sub_10006CF0+3Cj
					; sub_10006CF0+5Cj
		retn
sub_10006CF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006D60	proc near		; CODE XREF: sub_1000A8F0+1BDp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, eax
		push	80h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006D7C

loc_10006D75:				; CODE XREF: sub_10006D60+42j
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006D7C:				; CODE XREF: sub_10006D60+13j
		push	2
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006D92
		mov	eax, 13h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006D92:				; CODE XREF: sub_10006D60+29j
		push	80h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10006D75
		mov	ecx, [eax+18h]
		push	edi
		mov	edi, [ecx]
		push	eax
		call	sub_10015D70
		add	esp, 4
		test	edi, edi
		jz	short loc_10006DBF
		pop	edi
		mov	eax, 13h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006DBF:				; CODE XREF: sub_10006D60+55j
		push	11h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006E04
		push	101h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006E04
		push	81h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006E04
		push	82h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006E0C

loc_10006E04:				; CODE XREF: sub_10006D60+6Cj
					; sub_10006D60+7Ej ...
		pop	edi
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006E0C:				; CODE XREF: sub_10006D60+A2j
		push	0
		push	0
		push	102h
		push	esi
		mov	dword ptr [esi+1Ch], 0
		mov	dword ptr [esi+20h], 0
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10006E7A
		push	1
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006E78
		mov	edx, [esp+8+arg_0]
		mov	eax, [edx+30h]
		push	eax
		call	sub_1001CDC0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10006E5D
		pop	edi
		mov	eax, 0E2h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006E5D:				; CODE XREF: sub_10006D60+F3j
		lea	eax, [esi+0Ch]
		push	eax
		push	esi
		push	edi
		call	sub_1001B8C0
		push	edi
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006E78:				; CODE XREF: sub_10006D60+DDj
		xor	eax, eax

loc_10006E7A:				; CODE XREF: sub_10006D60+CEj
		pop	edi
		pop	esi
		retn
sub_10006D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006E80	proc near		; CODE XREF: sub_1000A8F0+1FDp

arg_0		= dword	ptr  4

		push	edi
		mov	edi, eax
		push	2
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006E99
		mov	eax, 13h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006E99:				; CODE XREF: sub_10006E80+10j
		push	81h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006EB2

loc_10006EAB:				; CODE XREF: sub_10006E80+42j
					; sub_10006E80+54j ...
		mov	eax, 0D0h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006EB2:				; CODE XREF: sub_10006E80+29j
		push	82h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006EAB
		push	0CE5363B4h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006EAB
		push	0CE5363B5h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006EAB
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006F31
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax+30h]
		push	esi
		push	eax
		call	sub_1001CDC0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10006F16
		pop	esi
		mov	eax, 0E2h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006F16:				; CODE XREF: sub_10006E80+8Cj
		lea	ecx, [edi+0Ch]
		push	ecx
		push	edi
		push	esi
		call	sub_1001B8C0
		push	esi
		mov	edi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	esi
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006F31:				; CODE XREF: sub_10006E80+75j
		xor	eax, eax
		pop	edi
		retn
sub_10006E80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006F40	proc near		; CODE XREF: sub_1000A8F0+20Bp

arg_0		= dword	ptr  4

		push	edi
		mov	edi, eax
		push	2
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006F59
		mov	eax, 13h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006F59:				; CODE XREF: sub_10006F40+10j
		push	101h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006F72

loc_10006F6B:				; CODE XREF: sub_10006F40+42j
		mov	eax, 0D0h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006F72:				; CODE XREF: sub_10006F40+29j
		push	0CE534352h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10006F6B
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006FD8
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax+30h]
		test	eax, eax
		jnz	short loc_10006FA5
		mov	eax, 0B3h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006FA5:				; CODE XREF: sub_10006F40+5Cj
		push	esi
		push	eax
		call	sub_1001CDC0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10006FBD
		pop	esi
		mov	eax, 0E2h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006FBD:				; CODE XREF: sub_10006F40+73j
		lea	ecx, [edi+0Ch]
		push	ecx
		push	edi
		push	esi
		call	sub_1001B8C0
		push	esi
		mov	edi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	esi
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006FD8:				; CODE XREF: sub_10006F40+51j
		xor	eax, eax
		pop	edi
		retn
sub_10006F40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006FE0	proc near		; CODE XREF: sub_1000A8F0+219p

arg_0		= dword	ptr  4

		push	edi
		mov	edi, eax
		push	2
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10006FF9
		mov	eax, 13h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006FF9:				; CODE XREF: sub_10006FE0+10j
		push	101h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10007012

loc_1000700B:				; CODE XREF: sub_10006FE0+3Fj
		mov	eax, 0D0h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10007012:				; CODE XREF: sub_10006FE0+29j
		push	11h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000700B
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000706A
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax+30h]
		push	esi
		push	eax
		call	sub_1001CDC0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000704F
		pop	esi
		mov	eax, 0E2h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000704F:				; CODE XREF: sub_10006FE0+65j
		lea	ecx, [edi+0Ch]
		push	ecx
		push	edi
		push	esi
		call	sub_1001B8C0
		push	esi
		mov	edi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	esi
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000706A:				; CODE XREF: sub_10006FE0+4Ej
		xor	eax, eax
		pop	edi
		retn
sub_10006FE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007070	proc near		; CODE XREF: sub_10007230+81p

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 5Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, eax
		push	130h
		mov	ebp, 0D0h
		xor	ebx, ebx
		push	esi
		mov	[esp+74h+var_5C], ebp
		mov	[esp+74h+var_58], ebx
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		mov	[esp+6Ch+var_4C], edi
		cmp	edi, ebx
		jz	loc_1000721E
		mov	eax, [edi+18h]
		mov	[esp+6Ch+var_20], eax
		mov	ecx, [edi+1Ch]
		push	131h
		push	esi
		mov	[esp+74h+var_1C], ecx
		call	sub_10016660
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	loc_10007209
		mov	edx, [ebp+18h]
		mov	[esp+6Ch+var_14], edx
		mov	eax, [ebp+1Ch]
		push	132h
		push	esi
		mov	[esp+74h+var_10], eax
		call	sub_10016660
		xor	edi, edi
		add	esp, 8
		mov	[esp+6Ch+var_50], eax
		cmp	eax, edi
		jz	short loc_10007100
		mov	ecx, [eax+18h]
		mov	[esp+6Ch+var_8], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+6Ch+var_4], edx
		jmp	short loc_1000710D
; ---------------------------------------------------------------------------

loc_10007100:				; CODE XREF: sub_10007070+7Ej
		mov	[esp+6Ch+var_8], edi
		mov	[esp+6Ch+var_4], edi
		mov	ebx, 1

loc_1000710D:				; CODE XREF: sub_10007070+8Ej
		push	0CE534364h
		push	esi
		call	sub_10016660
		add	esp, 8
		cmp	eax, edi
		jz	short loc_10007138
		mov	ecx, [eax+18h]
		mov	edx, [ecx]
		push	eax
		mov	[esp+70h+var_44], edx
		call	sub_10015D70
		add	esp, 4
		mov	ebx, 1
		jmp	short loc_10007140
; ---------------------------------------------------------------------------

loc_10007138:				; CODE XREF: sub_10007070+ADj
		mov	[esp+6Ch+var_44], 0FFFFFFFFh

loc_10007140:				; CODE XREF: sub_10007070+C6j
		push	0CE534366h
		push	esi
		call	sub_10016660
		mov	edi, eax
		xor	eax, eax
		add	esp, 8
		cmp	edi, eax
		jz	short loc_1000716B
		mov	eax, [edi+18h]
		mov	[esp+6Ch+var_30], eax
		mov	ecx, [edi+1Ch]
		mov	[esp+6Ch+var_2C], ecx
		mov	ebx, 1
		jmp	short loc_10007173
; ---------------------------------------------------------------------------

loc_1000716B:				; CODE XREF: sub_10007070+E4j
		mov	[esp+6Ch+var_30], eax
		mov	[esp+6Ch+var_2C], eax

loc_10007173:				; CODE XREF: sub_10007070+F9j
		push	0CE534365h
		push	esi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000719B
		mov	edx, [esi+18h]
		mov	[esp+6Ch+var_3C], edx
		mov	eax, [esi+1Ch]
		mov	[esp+6Ch+var_38], eax
		lea	eax, [esp+6Ch+var_48]
		jmp	short loc_100071A3
; ---------------------------------------------------------------------------

loc_1000719B:				; CODE XREF: sub_10007070+115j
		test	ebx, ebx
		jnz	short loc_100071D1
		mov	eax, [esp+6Ch+var_58]

loc_100071A3:				; CODE XREF: sub_10007070+129j
		lea	ecx, [esp+6Ch+var_54]
		push	ecx
		push	eax
		lea	edx, [esp+74h+var_28]
		push	edx
		mov	[esp+78h+var_5C], 6
		call	sub_10021730
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100071D1
		mov	eax, [esp+6Ch+var_54]
		neg	eax
		sbb	eax, eax
		and	eax, 13h
		mov	[esp+6Ch+var_5C], eax

loc_100071D1:				; CODE XREF: sub_10007070+12Dj
					; sub_10007070+150j
		test	edi, edi
		jz	short loc_100071DE
		push	edi
		call	sub_10015D70
		add	esp, 4

loc_100071DE:				; CODE XREF: sub_10007070+163j
		test	esi, esi
		jz	short loc_100071EB
		push	esi
		call	sub_10015D70
		add	esp, 4

loc_100071EB:				; CODE XREF: sub_10007070+170j
		mov	eax, [esp+6Ch+var_50]
		test	eax, eax
		jz	short loc_100071FC
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_100071FC:				; CODE XREF: sub_10007070+181j
		push	ebp
		call	sub_10015D70
		mov	edi, [esp+70h+var_4C]
		add	esp, 4

loc_10007209:				; CODE XREF: sub_10007070+54j
		push	edi
		call	sub_10015D70
		mov	eax, [esp+70h+var_5C]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_1000721E:				; CODE XREF: sub_10007070+2Ej
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 5Ch
		retn
sub_10007070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007230	proc near		; CODE XREF: sub_1000A8F0:loc_1000AABFp

var_1		= byte ptr -1

		push	ecx
		push	100h
		push	esi
		mov	[esp+0Ch+var_1], 0
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000724F
		mov	eax, 0D0h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000724F:				; CODE XREF: sub_10007230+16j
		push	163h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000727A
		push	1
		lea	eax, [esp+8+var_1]
		push	eax
		push	163h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100072B6

loc_1000727A:				; CODE XREF: sub_10007230+2Fj
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_10007293
		mov	eax, 13h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007293:				; CODE XREF: sub_10007230+5Aj
		mov	ecx, [eax+18h]
		push	edi
		mov	edi, [ecx]
		push	eax
		call	sub_10015D70
		mov	eax, edi
		add	esp, 4
		dec	eax
		pop	edi
		jz	short loc_100072AF
		mov	eax, 63h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100072AF:				; CODE XREF: sub_10007230+76j
		mov	eax, esi
		call	sub_10007070

loc_100072B6:				; CODE XREF: sub_10007230+48j
		pop	ecx
		retn
sub_10007230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100072C0	proc near		; CODE XREF: sub_10009D10+25Fp
					; sub_1000C4C0+16Dp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	edi
		mov	edi, 2
		cmp	[ebp+8], edi
		jz	short loc_100072E5
		mov	eax, [esp+14h+arg_8]
		pop	edi
		mov	dword ptr [eax], 63h
		xor	eax, eax
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100072E5:				; CODE XREF: sub_100072C0+11j
		cmp	dword ptr [ebp+1Ch], 0
		jz	short loc_100072FE
		mov	ecx, [esp+14h+arg_8]
		mov	dword ptr [ecx], 0
		mov	eax, [ebp+1Ch]
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100072FE:				; CODE XREF: sub_100072C0+29j
		push	ebx
		push	800h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000731F
		mov	edx, [esp+18h+arg_8]
		pop	ebx
		mov	[edx], edi
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000731F:				; CODE XREF: sub_100072C0+50j
		push	esi
		push	98h
		push	ebx
		call	PORT_ArenaAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000734E
		push	eax
		push	ebx
		call	PORT_FreeArena_Util
		mov	eax, [esp+24h+arg_8]
		add	esp, 8
		pop	esi
		pop	ebx
		mov	[eax], edi
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000734E:				; CODE XREF: sub_100072C0+72j
		mov	eax, [esp+1Ch+arg_4]
		mov	[esi], ebx
		cmp	eax, 3		; switch 4 cases
		ja	loc_1000755B	; jumptable 1000735D default case
		jmp	ds:off_10007594[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10007364:				; CODE XREF: sub_100072C0+9Dj
					; DATA XREF: .text:off_10007594o
		push	120h		; jumptable 1000735D case 0
		push	ebp
		lea	ecx, [esi+0Ch]
		push	ecx
		push	ebx
		mov	dword ptr [esi+4], 1
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	122h
		push	ebp
		lea	edx, [esi+18h]
		push	edx
		push	ebx
		call	sub_100168D0
		add	esp, 10h
		mov	edi, eax
		jmp	loc_10007560
; ---------------------------------------------------------------------------

loc_100073A2:				; CODE XREF: sub_100072C0+9Dj
					; DATA XREF: .text:off_10007594o
		push	130h		; jumptable 1000735D case 1
		push	ebp
		lea	eax, [esi+0Ch]
		push	eax
		push	ebx
		mov	[esi+4], edi
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	131h
		push	ebp
		lea	ecx, [esi+18h]
		push	ecx
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	132h
		push	ebp
		lea	edx, [esi+24h]
		push	edx
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	11h
		push	ebp
		lea	eax, [esi+30h]
		push	eax
		push	ebx
		call	sub_100168D0
		add	esp, 10h
		mov	edi, eax
		jmp	loc_10007560
; ---------------------------------------------------------------------------

loc_10007413:				; CODE XREF: sub_100072C0+9Dj
					; DATA XREF: .text:off_10007594o
		push	130h		; jumptable 1000735D case 2
		push	ebp
		lea	ecx, [esi+0Ch]
		push	ecx
		push	ebx
		mov	dword ptr [esi+4], 4
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	132h
		push	ebp
		lea	edx, [esi+18h]
		push	edx
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		push	11h
		push	ebp
		lea	eax, [esi+24h]
		push	eax
		push	ebx
		call	sub_100168D0
		add	esp, 10h
		mov	edi, eax
		jmp	loc_10007560
; ---------------------------------------------------------------------------

loc_1000746B:				; CODE XREF: sub_100072C0+9Dj
					; DATA XREF: .text:off_10007594o
		push	180h		; jumptable 1000735D case 3
		lea	eax, [esi+70h]
		push	ebp
		push	eax
		push	ebx
		mov	dword ptr [esi+4], 5
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		lea	ecx, [esi+8]
		push	ecx
		lea	eax, [esi+70h]
		push	eax
		push	ebx
		call	sub_10022A60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100074AE
		mov	edi, 130h
		jmp	loc_10007560
; ---------------------------------------------------------------------------

loc_100074AE:				; CODE XREF: sub_100072C0+1E2j
		push	181h
		lea	eax, [esi+8Ch]
		push	ebp
		push	eax
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007560
		mov	eax, [esi+10h]
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		mov	edx, [esi+90h]
		sar	eax, 3
		lea	ecx, [eax+eax+1]
		mov	al, [edx]
		mov	[esp+1Ch+arg_0], ecx
		cmp	al, 4
		jnz	short loc_10007554
		cmp	[esi+94h], ecx
		jz	short loc_10007560
		cmp	al, al
		jnz	short loc_10007554
		cmp	[esi+94h], ecx
		jbe	short loc_10007554
		lea	eax, [esi+8Ch]
		push	eax
		push	edi
		push	edi
		call	NSS_Get_SEC_OctetStringTemplate_Util
		add	esp, 8
		push	eax
		lea	eax, [esp+24h+var_C]
		push	eax
		push	ebx
		call	SEC_QuickDERDecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10007554
		mov	ecx, [esp+1Ch+var_8]
		cmp	byte ptr [ecx],	4
		jnz	short loc_10007554
		mov	eax, [esp+1Ch+var_4]
		cmp	eax, [esp+1Ch+arg_0]
		jnz	short loc_10007554
		mov	edx, [esp+1Ch+var_C]
		mov	[esi+8Ch], edx
		mov	[esi+90h], ecx
		mov	[esi+94h], eax
		jmp	short loc_10007560
; ---------------------------------------------------------------------------

loc_10007554:				; CODE XREF: sub_100072C0+22Fj
					; sub_100072C0+23Bj ...
		mov	edi, 13h
		jmp	short loc_10007560
; ---------------------------------------------------------------------------

loc_1000755B:				; CODE XREF: sub_100072C0+97j
		mov	edi, 63h	; jumptable 1000735D default case

loc_10007560:				; CODE XREF: sub_100072C0+C2j
					; sub_100072C0+DDj ...
		mov	eax, [esp+1Ch+arg_8]
		mov	[eax], edi
		test	edi, edi
		jz	short loc_1000757F
		push	0
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000757F:				; CODE XREF: sub_100072C0+2A8j
		mov	[ebp+1Ch], esi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	edi
		mov	dword ptr [ebp+20h], offset sub_10005180
		pop	ebp
		add	esp, 0Ch
		retn
sub_100072C0	endp

; ---------------------------------------------------------------------------
		align 4
off_10007594	dd offset loc_10007364	; DATA XREF: sub_100072C0+9Dr
		dd offset loc_100073A2	; jump table for switch	statement
		dd offset loc_10007413
		dd offset loc_1000746B
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100075B0	proc near		; CODE XREF: sub_10007C20+34p
					; sub_1000A010+45Cp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+60h+arg_0]
		push	edi
		mov	edi, ecx
		push	800h
		mov	[esp+68h+var_58], edi
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_100075F6
		mov	dword ptr [edi], 2
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+58h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_100075F6:				; CODE XREF: sub_100075B0+2Cj
		push	esi
		push	0B0h
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10007630
		push	eax
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		mov	dword ptr [edi], 2
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+58h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_10007630:				; CODE XREF: sub_100075B0+59j
		mov	eax, [esp+68h+arg_4]
		mov	[esi], ebx
		cmp	eax, 3		; switch 4 cases
		ja	loc_10007861	; jumptable 1000763F default case
		jmp	ds:off_10007880[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10007646:				; CODE XREF: sub_100075B0+8Fj
					; DATA XREF: .text:off_10007880o
		mov	dword ptr [esi+4], 1 ; jumptable 1000763F case 0
		lea	eax, [esi+18h]
		mov	[esp+68h+var_50], eax
		lea	ecx, [esi+24h]
		mov	[esp+68h+var_48], ecx
		lea	edx, [esi+30h]
		mov	[esp+68h+var_40], edx
		lea	eax, [esi+3Ch]
		lea	ecx, [esi+48h]
		mov	[esp+68h+var_38], eax
		mov	[esp+68h+var_30], ecx
		lea	edx, [esi+54h]
		mov	[esp+68h+var_28], edx
		lea	eax, [esi+60h]
		lea	ecx, [esi+6Ch]
		push	0
		lea	edx, [esi+0Ch]
		mov	[esp+6Ch+var_54], 120h
		mov	[esp+6Ch+var_4C], 122h
		mov	[esp+6Ch+var_44], 123h
		mov	[esp+6Ch+var_3C], 124h
		mov	[esp+6Ch+var_34], 125h
		mov	[esp+6Ch+var_2C], 126h
		mov	[esp+6Ch+var_24], 127h
		mov	[esp+6Ch+var_20], eax
		mov	[esp+6Ch+var_1C], 128h
		mov	[esp+6Ch+var_18], ecx
		mov	eax, [esi]
		push	edx
		push	eax
		mov	edi, 8
		call	DER_SetUInteger
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000772E
		mov	edi, 2
		jmp	short loc_10007740
; ---------------------------------------------------------------------------

loc_100076E6:				; CODE XREF: sub_100075B0+8Fj
					; DATA XREF: .text:off_10007880o
		mov	dword ptr [esi+4], 2 ; jumptable 1000763F case 1
		lea	ecx, [esi+0Ch]
		mov	[esp+68h+var_50], ecx
		lea	edx, [esi+18h]
		lea	eax, [esi+24h]
		lea	ecx, [esi+3Ch]
		mov	[esp+68h+var_54], 130h
		mov	[esp+68h+var_4C], 131h
		mov	[esp+68h+var_48], edx
		mov	[esp+68h+var_44], 132h
		mov	[esp+68h+var_40], eax
		mov	[esp+68h+var_3C], 11h
		mov	[esp+68h+var_38], ecx
		mov	edi, 4

loc_1000772E:				; CODE XREF: sub_100075B0+12Dj
					; sub_100075B0+1F7j
		push	edi
		lea	ecx, [esp+6Ch+var_54]
		push	ecx
		push	ebp
		push	ebx
		call	sub_100179E0
		add	esp, 10h
		mov	edi, eax

loc_10007740:				; CODE XREF: sub_100075B0+134j
					; sub_100075B0+217j ...
		mov	edx, [esp+68h+var_58]
		mov	[edx], edi
		test	edi, edi
		jz	loc_1000786B
		push	0
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+58h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_1000776E:				; CODE XREF: sub_100075B0+8Fj
					; DATA XREF: .text:off_10007880o
		mov	dword ptr [esi+4], 4 ; jumptable 1000763F case 2
		lea	edx, [esi+0Ch]
		lea	eax, [esi+18h]
		lea	ecx, [esi+30h]
		mov	[esp+68h+var_54], 130h
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+var_4C], 132h
		mov	[esp+68h+var_48], eax
		mov	[esp+68h+var_44], 11h
		mov	[esp+68h+var_40], ecx
		mov	edi, 3
		jmp	short loc_1000772E
; ---------------------------------------------------------------------------

loc_100077A9:				; CODE XREF: sub_100075B0+8Fj
					; DATA XREF: .text:off_10007880o
		push	180h		; jumptable 1000763F case 3
		lea	eax, [esi+70h]
		push	ebp
		push	eax
		push	ebx
		mov	dword ptr [esi+4], 5
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007740
		lea	edx, [esi+8]
		push	edx
		lea	eax, [esi+70h]
		push	eax
		push	ebx
		call	sub_10022A60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100077EC
		mov	edi, 130h
		jmp	loc_10007740
; ---------------------------------------------------------------------------

loc_100077EC:				; CODE XREF: sub_100075B0+230j
		push	11h
		push	ebp
		lea	eax, [esi+98h]
		push	eax
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007740
		push	0D5A0DB00h
		push	ebp
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000783B
		push	0D5A0DB00h
		push	ebp
		lea	ecx, [esi+8Ch]
		push	ecx
		push	ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10007740

loc_1000783B:				; CODE XREF: sub_100075B0+269j
		mov	eax, [esi]
		push	1
		lea	edx, [esi+0A4h]
		push	edx
		push	eax
		call	DER_SetUInteger
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10007740
		mov	edi, 2
		jmp	loc_10007740
; ---------------------------------------------------------------------------

loc_10007861:				; CODE XREF: sub_100075B0+89j
		mov	edi, 63h	; jumptable 1000763F default case
		jmp	loc_10007740
; ---------------------------------------------------------------------------

loc_1000786B:				; CODE XREF: sub_100075B0+198j
		mov	ecx, [esp+68h+var_4]
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
sub_100075B0	endp

; ---------------------------------------------------------------------------
off_10007880	dd offset loc_10007646	; DATA XREF: sub_100075B0+8Fr
		dd offset loc_100076E6	; jump table for switch	statement
		dd offset loc_1000776E
		dd offset loc_100077A9

; =============== S U B	R O U T	I N E =======================================


sub_10007890	proc near		; CODE XREF: sub_1000A010+19Ap

var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
Dst		= byte ptr -6Ch
Src		= dword	ptr -5Ch
Size		= dword	ptr -58h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 88h
		push	6Ch		; Size
		lea	eax, [esp+8Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		call	memset
		push	120h
		push	esi
		mov	[esp+9Ch+var_70], 0
		call	sub_10016660
		add	esp, 14h
		mov	[esp+88h+var_84], eax
		test	eax, eax
		jz	short loc_100078D0
		mov	ecx, [eax+18h]
		mov	[esp+88h+Src], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+Size],	edx

loc_100078D0:				; CODE XREF: sub_10007890+30j
		push	124h
		push	esi
		call	sub_10016660
		add	esp, 8
		mov	[esp+88h+var_74], eax
		test	eax, eax
		jz	short loc_100078F4
		mov	ecx, [eax+18h]
		mov	[esp+88h+var_38], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+var_34], edx

loc_100078F4:				; CODE XREF: sub_10007890+54j
		push	125h
		push	esi
		call	sub_10016660
		add	esp, 8
		mov	[esp+88h+var_7C], eax
		test	eax, eax
		jz	short loc_10007918
		mov	ecx, [eax+18h]
		mov	[esp+88h+var_2C], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+var_28], edx

loc_10007918:				; CODE XREF: sub_10007890+78j
		push	123h
		push	esi
		call	sub_10016660
		add	esp, 8
		mov	[esp+88h+var_88], eax
		test	eax, eax
		jz	short loc_1000793B
		mov	ecx, [eax+18h]
		mov	[esp+88h+var_44], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+var_40], edx

loc_1000793B:				; CODE XREF: sub_10007890+9Bj
		push	122h
		push	esi
		call	sub_10016660
		add	esp, 8
		mov	[esp+88h+var_80], eax
		test	eax, eax
		jz	short loc_1000795F
		mov	ecx, [eax+18h]
		mov	[esp+88h+var_50], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+var_4C], edx

loc_1000795F:				; CODE XREF: sub_10007890+BFj
		push	126h
		push	esi
		call	sub_10016660
		add	esp, 8
		mov	[esp+88h+var_78], eax
		test	eax, eax
		jz	short loc_10007983
		mov	ecx, [eax+18h]
		mov	[esp+88h+var_20], ecx
		mov	edx, [eax+1Ch]
		mov	[esp+88h+var_1C], edx

loc_10007983:				; CODE XREF: sub_10007890+E3j
		push	ebx
		push	ebp
		push	edi
		push	127h
		push	esi
		call	sub_10016660
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_100079AE
		mov	eax, [ebp+18h]
		mov	[esp+94h+var_14], eax
		mov	ecx, [ebp+1Ch]
		mov	[esp+94h+var_10], ecx

loc_100079AE:				; CODE XREF: sub_10007890+108j
		push	128h
		push	esi
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_100079D6
		mov	edx, [ebx+18h]
		mov	[esp+94h+var_8], edx
		mov	eax, [ebx+1Ch]
		mov	[esp+94h+var_4], eax

loc_100079D6:				; CODE XREF: sub_10007890+130j
		cmp	[esp+94h+arg_0], 0
		jz	short loc_100079F7
		lea	ecx, [esp+94h+var_70]
		push	ecx
		call	sub_100222F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	loc_10007B73

loc_100079F7:				; CODE XREF: sub_10007890+14Ej
		lea	edx, [esp+94h+var_70]
		push	edx
		call	sub_10020BD0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	loc_10007B73
		mov	ecx, [esp+94h+var_84]
		mov	eax, [esp+94h+Src]
		or	edi, 0FFFFFFFFh
		test	ecx, ecx
		jz	short loc_10007A22
		cmp	[ecx+18h], eax
		jz	short loc_10007A3E

loc_10007A22:				; CODE XREF: sub_10007890+18Bj
		mov	ecx, [esp+94h+Size]
		push	ecx		; Size
		push	eax		; Src
		push	120h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10007B73

loc_10007A3E:				; CODE XREF: sub_10007890+190j
		mov	ecx, [esp+94h+var_80]
		mov	eax, [esp+94h+var_50]
		test	ecx, ecx
		jz	short loc_10007A4F
		cmp	[ecx+18h], eax
		jz	short loc_10007A6B

loc_10007A4F:				; CODE XREF: sub_10007890+1B8j
		mov	edx, [esp+94h+var_4C]
		push	edx		; Size
		push	eax		; Src
		push	122h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10007B73

loc_10007A6B:				; CODE XREF: sub_10007890+1BDj
		mov	ecx, [esp+94h+var_88]
		mov	eax, [esp+94h+var_44]
		test	ecx, ecx
		jz	short loc_10007A7C
		cmp	[ecx+18h], eax
		jz	short loc_10007A98

loc_10007A7C:				; CODE XREF: sub_10007890+1E5j
		mov	ecx, [esp+94h+var_40]
		push	ecx		; Size
		push	eax		; Src
		push	123h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10007B73

loc_10007A98:				; CODE XREF: sub_10007890+1EAj
		mov	ecx, [esp+94h+var_74]
		mov	eax, [esp+94h+var_38]
		test	ecx, ecx
		jz	short loc_10007AA9
		cmp	[ecx+18h], eax
		jz	short loc_10007AC5

loc_10007AA9:				; CODE XREF: sub_10007890+212j
		mov	edx, [esp+94h+var_34]
		push	edx		; Size
		push	eax		; Src
		push	124h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10007B73

loc_10007AC5:				; CODE XREF: sub_10007890+217j
		mov	ecx, [esp+94h+var_7C]
		mov	eax, [esp+94h+var_2C]
		test	ecx, ecx
		jz	short loc_10007AD6
		cmp	[ecx+18h], eax
		jz	short loc_10007AF2

loc_10007AD6:				; CODE XREF: sub_10007890+23Fj
		mov	ecx, [esp+94h+var_28]
		push	ecx		; Size
		push	eax		; Src
		push	125h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10007B73

loc_10007AF2:				; CODE XREF: sub_10007890+244j
		mov	ecx, [esp+94h+var_78]
		mov	eax, [esp+94h+var_20]
		test	ecx, ecx
		jz	short loc_10007B03
		cmp	[ecx+18h], eax
		jz	short loc_10007B1B

loc_10007B03:				; CODE XREF: sub_10007890+26Cj
		mov	edx, [esp+94h+var_1C]
		push	edx		; Size
		push	eax		; Src
		push	126h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10007B73

loc_10007B1B:				; CODE XREF: sub_10007890+271j
		mov	eax, [esp+94h+var_14]
		test	ebp, ebp
		jz	short loc_10007B2B
		cmp	[ebp+18h], eax
		jz	short loc_10007B46

loc_10007B2B:				; CODE XREF: sub_10007890+294j
		mov	ecx, [esp+94h+var_10]
		push	ecx		; Size
		push	eax		; Src
		push	127h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10007B73

loc_10007B46:				; CODE XREF: sub_10007890+299j
		mov	eax, [esp+94h+var_8]
		test	ebx, ebx
		jz	short loc_10007B56
		cmp	[ebx+18h], eax
		jz	short loc_10007B71

loc_10007B56:				; CODE XREF: sub_10007890+2BFj
		mov	edx, [esp+94h+var_4]
		push	edx		; Size
		push	eax		; Src
		push	128h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10007B73

loc_10007B71:				; CODE XREF: sub_10007890+2C4j
		xor	edi, edi

loc_10007B73:				; CODE XREF: sub_10007890+161j
					; sub_10007890+178j ...
		mov	eax, [esp+94h+var_70]
		test	eax, eax
		jz	short loc_10007B86
		push	1
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_10007B86:				; CODE XREF: sub_10007890+2E9j
		mov	eax, [esp+94h+var_84]
		test	eax, eax
		jz	short loc_10007B97
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007B97:				; CODE XREF: sub_10007890+2FCj
		mov	eax, [esp+94h+var_74]
		test	eax, eax
		jz	short loc_10007BA8
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007BA8:				; CODE XREF: sub_10007890+30Dj
		mov	eax, [esp+94h+var_7C]
		test	eax, eax
		jz	short loc_10007BB9
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007BB9:				; CODE XREF: sub_10007890+31Ej
		mov	eax, [esp+94h+var_88]
		test	eax, eax
		jz	short loc_10007BCA
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007BCA:				; CODE XREF: sub_10007890+32Fj
		mov	eax, [esp+94h+var_80]
		test	eax, eax
		jz	short loc_10007BDB
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007BDB:				; CODE XREF: sub_10007890+340j
		mov	eax, [esp+94h+var_78]
		test	eax, eax
		jz	short loc_10007BEC
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10007BEC:				; CODE XREF: sub_10007890+351j
		test	ebp, ebp
		jz	short loc_10007BF9
		push	ebp
		call	sub_10015D70
		add	esp, 4

loc_10007BF9:				; CODE XREF: sub_10007890+35Ej
		test	ebx, ebx
		jz	short loc_10007C06
		push	ebx
		call	sub_10015D70
		add	esp, 4

loc_10007C06:				; CODE XREF: sub_10007890+36Bj
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 88h
		retn
sub_10007890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007C20	proc near		; CODE XREF: sub_1000C4C0+1B9p
					; sub_1000C4C0+265p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+8], 3
		jz	short loc_10007C39
		mov	eax, [esp+4+arg_8]
		mov	dword ptr [eax], 63h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007C39:				; CODE XREF: sub_10007C20+9j
		cmp	dword ptr [esi+1Ch], 0
		mov	ecx, [esp+4+arg_8]
		jz	short loc_10007C4E
		mov	dword ptr [ecx], 0
		mov	eax, [esi+1Ch]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007C4E:				; CODE XREF: sub_10007C20+21j
		mov	edx, [esp+4+arg_4]
		push	edx
		push	esi
		call	sub_100075B0
		add	esp, 8
		mov	[esi+1Ch], eax
		mov	dword ptr [esi+20h], offset sub_10005160
		pop	esi
		retn
sub_10007C20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007C70	proc near		; CODE XREF: sub_1000A4A0+218p
					; sub_1000BC30+1D2p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		xor	eax, eax
		test	esi, esi
		jle	short loc_10007C94
		mov	ecx, [esp+4+arg_0]
		nop

loc_10007C80:				; CODE XREF: sub_10007C70+22j
		movzx	edx, byte ptr [eax+ecx]
		shr	edx, 1
		mov	dl, ds:byte_10026150[edx]
		mov	[eax+ecx], dl
		inc	eax
		cmp	eax, esi
		jl	short loc_10007C80

loc_10007C94:				; CODE XREF: sub_10007C70+9j
		pop	esi
		retn
sub_10007C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007CA0	proc near		; CODE XREF: sub_10007D70+1Dp
					; sub_10007D70+2Dp ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	eax, [esp+8+arg_0]
		movzx	ecx, byte ptr [eax]
		shr	ecx, 1
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+1]
		shr	ecx, 1
		mov	[eax], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+2]
		shr	ecx, 1
		mov	[eax+1], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+3]
		shr	ecx, 1
		mov	[eax+2], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+4]
		shr	ecx, 1
		mov	[eax+3], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+5]
		shr	ecx, 1
		mov	[eax+4], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+6]
		shr	ecx, 1
		mov	[eax+5], dl
		movzx	edx, ds:byte_10026150[ecx]
		movzx	ecx, byte ptr [eax+7]
		shr	ecx, 1
		mov	[eax+6], dl
		movzx	edx, ds:byte_10026150[ecx]
		mov	esi, offset dword_100260C8
		mov	[eax+7], dl
		sub	eax, esi
		jmp	short loc_10007D30
; ---------------------------------------------------------------------------
		align 10h

loc_10007D30:				; CODE XREF: sub_10007CA0+8Bj
					; sub_10007CA0+B7j
		mov	edx, 8
		mov	ecx, esi

loc_10007D37:				; CODE XREF: sub_10007CA0+A9j
		cmp	edx, 4
		jb	short loc_10007D5E
		mov	edi, [eax+ecx]
		cmp	edi, [ecx]
		jnz	short loc_10007D4B
		sub	edx, 4
		add	ecx, 4
		jmp	short loc_10007D37
; ---------------------------------------------------------------------------

loc_10007D4B:				; CODE XREF: sub_10007CA0+A1j
		add	esi, 8
		sub	eax, 8
		cmp	esi, offset dword_10026148
		jl	short loc_10007D30
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007D5E:				; CODE XREF: sub_10007CA0+9Aj
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_10007CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007D70	proc near		; CODE XREF: sub_100145A0+3D8p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		sub	eax, 13h
		jz	short loc_10007DDD
		sub	eax, 11Dh
		push	esi
		jz	short loc_10007DB7
		dec	eax
		jz	short loc_10007D88
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007D88:				; CODE XREF: sub_10007D70+12j
		mov	esi, [esp+4+arg_0]
		push	esi
		call	sub_10007CA0
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007DC8
		lea	eax, [esi+8]
		push	eax
		call	sub_10007CA0
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007DC8
		add	esi, 10h
		push	esi
		call	sub_10007CA0
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007DB7:				; CODE XREF: sub_10007D70+Fj
		mov	esi, [esp+4+arg_0]
		push	esi
		call	sub_10007CA0
		add	esp, 4
		test	eax, eax
		jz	short loc_10007DCF

loc_10007DC8:				; CODE XREF: sub_10007D70+27j
					; sub_10007D70+37j
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007DCF:				; CODE XREF: sub_10007D70+56j
		add	esi, 8
		push	esi
		call	sub_10007CA0
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007DDD:				; CODE XREF: sub_10007D70+7j
		mov	ecx, [esp+arg_0]
		push	ecx
		call	sub_10007CA0
		add	esp, 4
		retn
sub_10007D70	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. C_GetFunctionList
; Exported entry   3. NSC_GetFunctionList

; =============== S U B	R O U T	I N E =======================================


		public NSC_GetFunctionList
NSC_GetFunctionList proc near		; DATA XREF: .rdata:10025FBEo
					; .rdata:off_10028EB8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0] ; C_GetFunctionList
		mov	dword ptr [eax], offset	byte_10025FB0
		xor	eax, eax
		retn
NSC_GetFunctionList endp

; ---------------------------------------------------------------------------
		align 10h

loc_10007E00:				; DATA XREF: sub_10007EF0+D1o
					; sub_1000ADD0+F5o
		mov	eax, [esp+4]
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007E10	proc near		; CODE XREF: sub_1000ADD0+13Fp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		dec	eax
		jz	short loc_10007E45
		dec	eax
		jz	short loc_10007E3F
		dec	eax
		jz	short loc_10007E39
		push	ecx
		push	offset aNssApplication ; "NSS Application Slot %08x		 "...
		push	offset Dest	; Dest
		call	ds:sprintf
		add	esp, 0Ch
		mov	eax, offset Dest
		retn
; ---------------------------------------------------------------------------

loc_10007E39:				; CODE XREF: sub_10007E10+Dj
		mov	eax, offset aNssFips1402Use ; "NSS FIPS	140-2 User Private Key Service"...
		retn
; ---------------------------------------------------------------------------

loc_10007E3F:				; CODE XREF: sub_10007E10+Aj
		mov	eax, offset aNssUserPrivate ; "NSS User	Private	Key and	Certificate Se"...
		retn
; ---------------------------------------------------------------------------

loc_10007E45:				; CODE XREF: sub_10007E10+7j
		mov	eax, offset aNssInternalCry ; "NSS Internal Cryptographic Services    "...
		retn
sub_10007E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007E50	proc near		; CODE XREF: sub_10016450+Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		cmp	ecx, 3
		jz	short loc_10007E62
		cmp	ecx, 65h
		jnb	short loc_10007E62
		xor	eax, eax
		jmp	short loc_10007E67
; ---------------------------------------------------------------------------

loc_10007E62:				; CODE XREF: sub_10007E50+7j
					; sub_10007E50+Cj
		mov	eax, 1

loc_10007E67:				; CODE XREF: sub_10007E50+10j
		mov	eax, dword_10029658[eax*4]
		test	eax, eax
		jz	short loc_10007E8D
		push	ecx
		push	eax
		call	PL_HashTableLookupConst
		add	esp, 8
		test	eax, eax
		jz	short locret_10007E8F
		cmp	[esp+arg_4], 0
		jnz	short locret_10007E8F
		cmp	dword ptr [eax+1Ch], 0
		jnz	short locret_10007E8F

loc_10007E8D:				; CODE XREF: sub_10007E50+20j
		xor	eax, eax

locret_10007E8F:			; CODE XREF: sub_10007E50+2Ej
					; sub_10007E50+35j ...
		retn
sub_10007E50	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E90	proc near		; CODE XREF: sub_100090D0+36p
					; sub_100092E0+7p ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		shr	eax, 18h
		and	eax, 7Fh
		shr	ecx, 1Fh
		cmp	eax, dword_10029640[ecx*4]
		jnb	short loc_10007EE4
		mov	ecx, Src[ecx*4]
		mov	eax, [ecx+eax*4]
		cmp	eax, 3
		jz	short loc_10007EC0
		cmp	eax, 65h
		jnb	short loc_10007EC0
		xor	ecx, ecx
		jmp	short loc_10007EC5
; ---------------------------------------------------------------------------

loc_10007EC0:				; CODE XREF: sub_10007E90+25j
					; sub_10007E90+2Aj
		mov	ecx, 1

loc_10007EC5:				; CODE XREF: sub_10007E90+2Ej
		mov	ecx, dword_10029658[ecx*4]
		test	ecx, ecx
		jz	short loc_10007EE4
		push	eax
		push	ecx
		call	PL_HashTableLookupConst
		add	esp, 8
		test	eax, eax
		jz	short locret_10007EE6
		cmp	dword ptr [eax+1Ch], 0
		jnz	short locret_10007EE6

loc_10007EE4:				; CODE XREF: sub_10007E90+16j
					; sub_10007E90+3Ej
		xor	eax, eax

locret_10007EE6:			; CODE XREF: sub_10007E90+4Cj
					; sub_10007E90+52j
		retn
sub_10007E90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007EF0	proc near		; CODE XREF: sub_1000ADD0+1BFp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	esi
		cmp	eax, 3
		jz	short loc_10007F06
		cmp	eax, 65h
		jnb	short loc_10007F06
		xor	esi, esi
		jmp	short loc_10007F0B
; ---------------------------------------------------------------------------

loc_10007F06:				; CODE XREF: sub_10007EF0+Bj
					; sub_10007EF0+10j
		mov	esi, 1

loc_10007F0B:				; CODE XREF: sub_10007EF0+14j
		cmp	[esp+8+arg_4], esi
		jz	short loc_10007F19
		mov	eax, 3
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007F19:				; CODE XREF: sub_10007EF0+1Fj
		cmp	Src[esi*4], 0
		push	edi
		lea	edi, Src[esi*4]
		jnz	short loc_10007F4F
		push	28h
		mov	dword_10029650[esi*4], 0Ah
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10007F4F
		pop	edi
		mov	eax, 2
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007F4F:				; CODE XREF: sub_10007EF0+39j
					; sub_10007EF0+54j
		mov	eax, dword_10029650[esi*4]
		push	ebx
		push	ebp
		lea	ebp, dword_10029650[esi*4]
		lea	ebx, dword_10029640[esi*4]
		mov	[esp+14h+var_4], eax
		cmp	[ebx], eax
		jb	short loc_10007FA9
		mov	ecx, [edi]
		add	eax, 0Ah
		lea	edx, ds:0[eax*4]
		push	edx
		push	ecx
		mov	[esp+1Ch+arg_4], ecx
		mov	[ebp+0], eax
		call	PORT_Realloc_Util
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10007FA9
		mov	eax, [esp+14h+arg_4]
		mov	ecx, [esp+14h+var_4]
		mov	[edi], eax
		mov	[ebp+0], ecx

loc_10007F9E:				; CODE XREF: sub_10007EF0+E9j
					; sub_10007EF0+106j
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 2
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007FA9:				; CODE XREF: sub_10007EF0+7Cj
					; sub_10007EF0+9Fj
		cmp	dword_10029658[esi*4], 0
		jnz	short loc_10007FDB
		push	0
		push	0
		push	offset PL_CompareValues
		push	offset PL_CompareValues
		push	offset loc_10007E00
		push	40h
		call	PL_NewHashTable
		add	esp, 18h
		mov	dword_10029658[esi*4], eax
		test	eax, eax
		jz	short loc_10007F9E

loc_10007FDB:				; CODE XREF: sub_10007EF0+C1j
		mov	ebp, [esp+14h+arg_0]
		mov	edx, [ebp+0]
		mov	eax, dword_10029658[esi*4]
		push	ebp
		push	edx
		push	eax
		call	PL_HashTableAdd
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10007F9E
		mov	ecx, [ebx]
		and	esi, 1
		shl	esi, 7
		and	ecx, 7Fh
		or	esi, ecx
		mov	ecx, [ebp+0]
		mov	[ebp+5Ch], esi
		mov	edx, [ebx]
		mov	eax, [edi]
		pop	ebp
		mov	[eax+edx*4], ecx
		inc	dword ptr [ebx]
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_10007EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008020	proc near		; CODE XREF: sub_10008120+17p
					; sub_10008A20+11Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, ds:PR_Unlock
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	ebp, ebp
		push	edi
		cmp	[esp+10h+arg_4], ebp
		jz	short loc_10008076
		push	esi
		call	sub_1001CE00
		mov	edi, eax
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		add	esp, 8
		mov	[esi+24h], ebp
		cmp	[esi+2Ch], ebp
		jz	short loc_10008060
		cmp	edi, ebp
		jz	short loc_10008060
		push	edi
		call	sub_1001FA20
		add	esp, 4

loc_10008060:				; CODE XREF: sub_10008020+31j
					; sub_10008020+35j
		mov	ecx, [esi+4]
		push	ecx
		call	ebx ; PR_Unlock
		add	esp, 4
		cmp	edi, ebp
		jz	short loc_10008076
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_10008076:				; CODE XREF: sub_10008020+14j
					; sub_10008020+4Bj
		mov	[esp+10h+arg_4], ebp
		cmp	[esi+70h], ebp
		jbe	loc_1000810E

loc_10008083:				; CODE XREF: sub_10008020+E8j
		mov	edx, [esi+10h]
		and	edx, [esp+10h+arg_4]
		mov	eax, [esi+8]
		mov	ebp, [eax+edx*4]

loc_10008090:				; CODE XREF: sub_10008020+D4j
		push	ebp
		call	ds:PR_Lock
		mov	ecx, [esi+6Ch]
		mov	edx, [esp+14h+arg_4]
		mov	edi, [ecx+edx*4]
		lea	eax, [ecx+edx*4]
		xor	ecx, ecx
		add	esp, 4
		cmp	edi, ecx
		jz	short loc_100080F6
		mov	edx, [edi]
		mov	[eax], edx
		mov	eax, [edi]
		cmp	eax, ecx
		jz	short loc_100080BA
		mov	[eax+4], ecx

loc_100080BA:				; CODE XREF: sub_10008020+95j
		push	ebp
		mov	[edi+4], ecx
		mov	[edi], ecx
		call	ebx ; PR_Unlock
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [esi+4]
		dec	dword ptr [esi+50h]
		push	ecx
		call	ebx ; PR_Unlock
		add	esp, 0Ch
		test	byte ptr [edi+20h], 2
		jz	short loc_100080EB
		lea	edx, [esi+54h]
		push	edx
		call	ds:PR_AtomicDecrement
		add	esp, 4

loc_100080EB:				; CODE XREF: sub_10008020+BCj
		push	edi
		call	sub_100177F0
		add	esp, 4
		jmp	short loc_10008090
; ---------------------------------------------------------------------------

loc_100080F6:				; CODE XREF: sub_10008020+8Bj
		push	ebp
		call	ebx ; PR_Unlock
		mov	eax, [esp+14h+arg_4]
		inc	eax
		add	esp, 4
		mov	[esp+10h+arg_4], eax
		cmp	eax, [esi+70h]
		jb	loc_10008083

loc_1000810E:				; CODE XREF: sub_10008020+5Dj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10008020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008120	proc near		; CODE XREF: sub_100081D0+8p
					; sub_1000AB70+1DAp ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		cmp	dword ptr [esi+6Ch], 0
		push	edi
		mov	dword ptr [esi+1Ch], 0
		jz	short loc_1000813F
		push	1
		push	esi
		call	sub_10008020
		add	esp, 8

loc_1000813F:				; CODE XREF: sub_10008120+12j
		cmp	dword ptr [esi+60h], 0
		jz	short loc_1000814E
		push	esi
		call	sub_10016110
		add	esp, 4

loc_1000814E:				; CODE XREF: sub_10008120+23j
		xor	eax, eax
		mov	[esi+74h], eax
		mov	[esi+78h], eax
		mov	[esi+7Ch], eax
		mov	[esi+80h], eax
		mov	[esi+84h], eax
		mov	[esi+88h], eax
		mov	[esi+8Ch], eax
		mov	[esi+90h], eax
		mov	[esi+94h], al
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [esi+4]
		mov	edi, [esi+3Ch]
		mov	ebx, [esi+40h]
		push	ecx
		mov	dword ptr [esi+3Ch], 0
		mov	dword ptr [esi+40h], 0
		call	ds:PR_Unlock
		add	esp, 8
		test	edi, edi
		jz	short loc_100081B5
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_100081B5:				; CODE XREF: sub_10008120+8Aj
		test	ebx, ebx
		jz	short loc_100081C2
		push	ebx
		call	sub_1001CD90
		add	esp, 4

loc_100081C2:				; CODE XREF: sub_10008120+97j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10008120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100081D0	proc near		; CODE XREF: sub_1000ADD0+111p
					; sub_1000ADD0+1CEp ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	esi
		call	sub_10008120
		mov	eax, [esi+60h]
		xor	ebx, ebx
		add	esp, 4
		cmp	eax, ebx
		jz	short loc_100081F5
		push	eax
		call	PL_HashTableDestroy
		add	esp, 4
		mov	[esi+60h], ebx

loc_100081F5:				; CODE XREF: sub_100081D0+17j
		mov	eax, [esi+64h]
		cmp	eax, ebx
		jz	short loc_10008208
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+64h], ebx

loc_10008208:				; CODE XREF: sub_100081D0+2Aj
		mov	eax, [esi+6Ch]
		mov	[esi+68h], ebx
		cmp	eax, ebx
		jz	short loc_1000821E
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+6Ch], ebx

loc_1000821E:				; CODE XREF: sub_100081D0+40j
		mov	eax, [esi+4]
		mov	ebp, ds:PR_DestroyLock
		push	eax
		mov	[esi+70h], ebx
		call	ebp ; PR_DestroyLock
		add	esp, 4
		mov	[esi+4], ebx
		cmp	[esi+8], ebx
		jz	short loc_1000826F
		push	edi
		xor	edi, edi
		cmp	[esi+0Ch], ebx
		jbe	short loc_1000825F

loc_10008240:				; CODE XREF: sub_100081D0+8Dj
		mov	ecx, [esi+8]
		cmp	[ecx+edi*4], ebx
		lea	eax, [ecx+edi*4]
		jz	short loc_10008259
		mov	edx, [eax]
		push	edx
		call	ebp ; PR_DestroyLock
		mov	eax, [esi+8]
		add	esp, 4
		mov	[eax+edi*4], ebx

loc_10008259:				; CODE XREF: sub_100081D0+79j
		inc	edi
		cmp	edi, [esi+0Ch]
		jb	short loc_10008240

loc_1000825F:				; CODE XREF: sub_100081D0+6Ej
		mov	ecx, [esi+8]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+8], ebx
		pop	edi

loc_1000826F:				; CODE XREF: sub_100081D0+66j
		mov	eax, [esi+14h]
		cmp	eax, ebx
		jz	short loc_1000827F
		push	eax
		call	ebp ; PR_DestroyLock
		add	esp, 4
		mov	[esi+14h], ebx

loc_1000827F:				; CODE XREF: sub_100081D0+A4j
		mov	eax, [esi+18h]
		cmp	eax, ebx
		jz	short loc_1000828F
		push	eax
		call	ebp ; PR_DestroyLock
		add	esp, 4
		mov	[esi+18h], ebx

loc_1000828F:				; CODE XREF: sub_100081D0+B4j
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_100081D0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   4. NSC_ModuleDBFunc

; =============== S U B	R O U T	I N E =======================================


		public NSC_ModuleDBFunc
NSC_ModuleDBFunc proc near		; DATA XREF: .rdata:off_10028EB8o

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 20h
		mov	eax, [esp+20h+arg_8]
		push	ebx
		mov	ebx, [esp+24h+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+30h+arg_4]
		push	eax
		xor	ebp, ebp
		push	edi
		push	ebx
		mov	[esp+3Ch+var_20], ebp
		mov	[esp+3Ch+var_1C], ebp
		mov	[esp+3Ch+var_18], ebp
		call	NSSUTIL_DoModuleDBFunction
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebp
		jnz	loc_100084F0
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE0B1h
		jnz	short loc_10008328
		lea	ecx, [esp+30h+var_10]
		push	ecx
		lea	edx, [esp+34h+var_1C]
		push	edx
		lea	eax, [esp+38h+var_20]
		push	eax
		lea	ecx, [esp+3Ch+var_18]
		push	ecx
		push	edi
		call	_NSSUTIL_GetSecmodName
		add	esp, 14h
		mov	ebp, eax
		mov	[esp+30h+var_4], ebp
		cmp	ebx, 3		; switch 4 cases
		ja	loc_100084BE	; jumptable 1000830E default case
		jmp	ds:off_100084F8[ebx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10008315:				; CODE XREF: NSC_ModuleDBFunc+6Ej
					; DATA XREF: .text:off_100084F8o
		xor	edx, edx	; jumptable 1000830E case 0
		cmp	ebp, edx
		jnz	short loc_10008332

loc_1000831B:				; CODE XREF: NSC_ModuleDBFunc+1ADj
					; NSC_ModuleDBFunc+1D1j
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_10008328:				; CODE XREF: NSC_ModuleDBFunc+40j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10008332:				; CODE XREF: NSC_ModuleDBFunc+79j
		mov	eax, [esp+30h+var_10]
		cmp	eax, edx
		jz	loc_10008432
		mov	ecx, [esp+30h+var_18]
		cmp	ecx, 3
		jz	loc_10008432
		cmp	ecx, 4
		jz	loc_10008432
		mov	[esp+30h+var_C], edx
		mov	[esp+30h+var_14], edx
		lea	edx, [esp+30h+var_8]
		push	edx
		lea	eax, [esp+34h+var_14]
		push	eax
		lea	ecx, [esp+38h+var_C]
		push	ecx
		lea	edx, [esp+3Ch+var_18]
		push	edx
		push	edi
		mov	[esp+44h+var_18], 3
		call	_NSSUTIL_GetSecmodName
		mov	ecx, [esp+44h+var_14]
		mov	edx, [esp+44h+var_20]
		mov	ebp, eax
		mov	eax, [esp+44h+var_8]
		push	eax
		push	edi
		push	ebp
		push	ecx
		push	edx
		call	sub_10004F80
		mov	ebx, eax
		add	esp, 28h
		test	ebx, ebx
		jz	short loc_100083D7
		mov	eax, [ebx]
		xor	esi, esi
		test	eax, eax
		jz	short loc_100083BC

loc_100083A7:				; CODE XREF: NSC_ModuleDBFunc+11Aj
		push	eax
		push	edi
		push	1
		call	NSSUTIL_DoModuleDBFunction
		mov	eax, [ebx+esi*4+4]
		inc	esi
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100083A7

loc_100083BC:				; CODE XREF: NSC_ModuleDBFunc+105j
		mov	eax, [esp+30h+var_8]
		mov	ecx, [esp+30h+var_14]
		mov	edx, [esp+30h+var_C]
		push	eax
		push	ebx
		push	ebp
		push	ecx
		push	edx
		call	sub_10004FB0
		add	esp, 14h
		jmp	short loc_100083E7
; ---------------------------------------------------------------------------

loc_100083D7:				; CODE XREF: NSC_ModuleDBFunc+FDj
		push	offset asc_10026FE4 ; "	"
		push	edi
		push	1
		call	NSSUTIL_DoModuleDBFunction
		add	esp, 0Ch

loc_100083E7:				; CODE XREF: NSC_ModuleDBFunc+135j
		test	ebp, ebp
		jz	short loc_100083F5
		push	ebp
		call	ds:PR_smprintf_free
		add	esp, 4

loc_100083F5:				; CODE XREF: NSC_ModuleDBFunc+149j
		mov	eax, [esp+30h+var_C]
		test	eax, eax
		jz	short loc_10008406
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10008406:				; CODE XREF: NSC_ModuleDBFunc+15Bj
		mov	eax, [esp+30h+var_14]
		test	eax, eax
		jz	short loc_10008417
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10008417:				; CODE XREF: NSC_ModuleDBFunc+16Cj
		mov	eax, [esp+30h+arg_8]
		push	eax
		push	edi
		push	0
		call	NSSUTIL_DoModuleDBFunction
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 0Ch
		mov	esi, eax
		jmp	loc_100084BE	; jumptable 1000830E default case
; ---------------------------------------------------------------------------

loc_10008432:				; CODE XREF: NSC_ModuleDBFunc+98j
					; NSC_ModuleDBFunc+A5j	...
		mov	ecx, [esp+30h+var_1C]
		mov	edx, [esp+30h+var_20]
		push	eax
		push	edi
		push	ebp
		push	ecx
		push	edx
		call	sub_10004F80
		add	esp, 14h
		mov	esi, eax
		jmp	short loc_100084BE ; jumptable 1000830E	default	case
; ---------------------------------------------------------------------------

loc_1000844B:				; CODE XREF: NSC_ModuleDBFunc+6Ej
					; DATA XREF: .text:off_100084F8o
		test	ebp, ebp	; jumptable 1000830E case 1
		jz	loc_1000831B
		mov	eax, [esp+30h+var_10]
		mov	ecx, [esp+30h+arg_8]
		mov	edx, [esp+30h+var_1C]
		push	eax
		mov	eax, [esp+34h+var_20]
		push	ecx
		push	ebp
		push	edx
		push	eax
		call	sub_10005010
		jmp	short loc_100084AD
; ---------------------------------------------------------------------------

loc_1000846F:				; CODE XREF: NSC_ModuleDBFunc+6Ej
					; DATA XREF: .text:off_100084F8o
		test	ebp, ebp	; jumptable 1000830E case 2
		jz	loc_1000831B
		mov	ecx, [esp+30h+var_10]
		mov	edx, [esp+30h+arg_8]
		mov	eax, [esp+30h+var_1C]
		push	ecx
		mov	ecx, [esp+34h+var_20]
		push	edx
		push	ebp
		push	eax
		push	ecx
		call	sub_10004FE0
		jmp	short loc_100084AD
; ---------------------------------------------------------------------------

loc_10008493:				; CODE XREF: NSC_ModuleDBFunc+6Ej
					; DATA XREF: .text:off_100084F8o
		mov	edx, [esp+30h+var_10] ;	jumptable 1000830E case	3
		mov	eax, [esp+30h+arg_8]
		mov	ecx, [esp+30h+var_1C]
		push	edx
		mov	edx, [esp+34h+var_20]
		push	eax
		push	ebp
		push	ecx
		push	edx
		call	sub_10004FB0

loc_100084AD:				; CODE XREF: NSC_ModuleDBFunc+1CDj
					; NSC_ModuleDBFunc+1F1j
		add	esp, 14h
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		not	esi
		and	esi, offset off_10029124

loc_100084BE:				; CODE XREF: NSC_ModuleDBFunc+68j
					; NSC_ModuleDBFunc+18Dj ...
		test	ebp, ebp	; jumptable 1000830E default case
		jz	short loc_100084CC
		push	ebp
		call	ds:PR_smprintf_free
		add	esp, 4

loc_100084CC:				; CODE XREF: NSC_ModuleDBFunc+220j
		mov	eax, [esp+30h+var_20]
		test	eax, eax
		jz	short loc_100084DD
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_100084DD:				; CODE XREF: NSC_ModuleDBFunc+232j
		mov	eax, [esp+30h+var_1C]
		test	eax, eax
		jz	short loc_100084EE
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_100084EE:				; CODE XREF: NSC_ModuleDBFunc+243j
		mov	eax, esi

loc_100084F0:				; CODE XREF: NSC_ModuleDBFunc+30j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
NSC_ModuleDBFunc endp

; ---------------------------------------------------------------------------
off_100084F8	dd offset loc_10008315	; DATA XREF: NSC_ModuleDBFunc+6Er
		dd offset loc_1000844B	; jump table for switch	statement
		dd offset loc_1000846F
		dd offset loc_10008493
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008510	proc near		; CODE XREF: sub_1000B0B0+F9p
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		neg	eax
		sbb	eax, eax
		push	esi
		add	eax, 3
		push	eax
		mov	ecx, dword_10029658[ecx*4]
		push	ecx
		call	PL_HashTableLookup
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000857F
		mov	edx, [esi+4]
		push	ebx
		push	edi
		push	edx
		call	ds:PR_Lock
		mov	eax, [esi+4]
		mov	edi, [esi+3Ch]
		mov	ebx, [esi+40h]
		push	eax
		mov	dword ptr [esi+3Ch], 0
		mov	dword ptr [esi+40h], 0
		call	ds:PR_Unlock
		add	esp, 8
		test	edi, edi
		jz	short loc_10008570
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_10008570:				; CODE XREF: sub_10008510+55j
		test	ebx, ebx
		jz	short loc_1000857D
		push	ebx
		call	sub_1001CD90
		add	esp, 4

loc_1000857D:				; CODE XREF: sub_10008510+62j
		pop	edi
		pop	ebx

loc_1000857F:				; CODE XREF: sub_10008510+24j
		pop	esi
		retn
sub_10008510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008590	proc near		; CODE XREF: sub_10003640+22p
					; sub_10003780+Cp ...
		xor	eax, eax
		retn
sub_10008590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100085A0	proc near		; CODE XREF: sub_100037D0j
					; DATA XREF: .rdata:10025FBAo

var_1		= byte ptr -1
arg_0		= dword	ptr  4

		push	ecx
		movsx	ecx, ds:byte_10027E20
		movsx	eax, ds:byte_10027E58
		add	eax, ecx
		push	esi
		mov	esi, off_10029118
		push	edi
		mov	[esp+0Ch+var_1], al
		mov	eax, [esp+0Ch+arg_0]
		mov	word ptr [eax],	1402h
		lea	edi, [eax+2]
		mov	ecx, 8
		rep movsd
		mov	esi, off_1002911C
		lea	edi, [eax+26h]
		mov	word ptr [eax+46h], 1103h
		mov	ecx, 8
		rep movsd
		pop	edi
		mov	dword ptr [eax+22h], 0
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_100085A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008600(int,	void *Dst, int,	int)
sub_10008600	proc near		; CODE XREF: sub_100037E0+11p

Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, dword_10029640[eax*4]
		mov	edx, [esp+arg_8]
		mov	[edx], ecx
		mov	ecx, [esp+Dst]
		test	ecx, ecx
		jz	short loc_10008636
		mov	edx, dword_10029640[eax*4]
		mov	eax, Src[eax*4]
		add	edx, edx
		add	edx, edx
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10008636:				; CODE XREF: sub_10008600+17j
		xor	eax, eax
		retn
sub_10008600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008640(int,	void *Dst, int)
sub_10008640	proc near		; DATA XREF: .rdata:10025FC2o

Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, dword_10029640
		mov	[eax], ecx
		mov	eax, [esp+Dst]
		test	eax, eax
		jz	short loc_10008672
		mov	edx, dword_10029640
		lea	ecx, ds:0[edx*4]
		mov	edx, Src
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10008672:				; CODE XREF: sub_10008640+12j
		xor	eax, eax
		retn
sub_10008640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008680	proc near		; CODE XREF: sub_10003800j
					; DATA XREF: .rdata:10025FC6o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		cmp	ebp, 3
		jz	short loc_10008693
		cmp	ebp, 65h
		jnb	short loc_10008693
		xor	eax, eax
		jmp	short loc_10008698
; ---------------------------------------------------------------------------

loc_10008693:				; CODE XREF: sub_10008680+8j
					; sub_10008680+Dj
		mov	eax, 1

loc_10008698:				; CODE XREF: sub_10008680+11j
		mov	eax, dword_10029658[eax*4]
		test	eax, eax
		jz	short loc_100086B1
		push	ebp
		push	eax
		call	PL_HashTableLookupConst
		add	esp, 8
		test	eax, eax
		jnz	short loc_100086B8

loc_100086B1:				; CODE XREF: sub_10008680+21j
		mov	eax, 3
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100086B8:				; CODE XREF: sub_10008680+2Fj
		push	ebx
		mov	ebx, [esp+8+arg_4]
		push	esi
		mov	esi, off_10029118
		push	edi
		lea	edi, [ebx+40h]
		mov	ecx, 8
		rep movsd
		lea	esi, [eax+0B6h]
		mov	ecx, 10h
		mov	edi, ebx
		rep movsd
		xor	ecx, ecx
		cmp	[eax+1Ch], ecx
		setnz	cl
		mov	[ebx+60h], ecx
		cmp	ebp, 4
		jb	short loc_10008702
		pop	edi
		or	ecx, 2
		pop	esi
		mov	[ebx+60h], ecx
		mov	dword ptr [ebx+64h], 11103h
		pop	ebx
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10008702:				; CODE XREF: sub_10008680+6Cj
		push	eax
		call	sub_1001CE00
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1000872B
		push	esi
		call	sub_1001EDC0
		add	esp, 4
		test	eax, eax
		jz	short loc_10008722
		or	dword ptr [ebx+60h], 2

loc_10008722:				; CODE XREF: sub_10008680+9Cj
		push	esi
		call	sub_1001CD90
		add	esp, 4

loc_1000872B:				; CODE XREF: sub_10008680+8Fj
		pop	edi
		pop	esi
		mov	dword ptr [ebx+64h], 11103h
		pop	ebx
		xor	eax, eax
		pop	ebp
		retn
sub_10008680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008740	proc near		; CODE XREF: sub_10003830+21j
					; DATA XREF: .rdata:10025FCEo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		dec	eax
		jz	short loc_100087BD
		mov	edx, [esp+arg_8]
		mov	eax, [esp+arg_4]
		mov	dword ptr [edx], 0
		xor	ecx, ecx
		push	esi
		jmp	short loc_10008760
; ---------------------------------------------------------------------------
		align 10h

loc_10008760:				; CODE XREF: sub_10008740+18j
					; sub_10008740+77j
		cmp	ds:dword_10026260[ecx],	0
		jz	short loc_1000877A
		inc	dword ptr [edx]
		test	eax, eax
		jz	short loc_1000877A
		mov	esi, ds:dword_10026250[ecx]
		mov	[eax], esi
		add	eax, 4

loc_1000877A:				; CODE XREF: sub_10008740+27j
					; sub_10008740+2Dj
		cmp	ds:dword_10026274[ecx],	0
		jz	short loc_10008794
		inc	dword ptr [edx]
		test	eax, eax
		jz	short loc_10008794
		mov	esi, ds:dword_10026264[ecx]
		mov	[eax], esi
		add	eax, 4

loc_10008794:				; CODE XREF: sub_10008740+41j
					; sub_10008740+47j
		cmp	ds:dword_10026288[ecx],	0
		jz	short loc_100087AE
		inc	dword ptr [edx]
		test	eax, eax
		jz	short loc_100087AE
		mov	esi, ds:dword_10026278[ecx]
		mov	[eax], esi
		add	eax, 4

loc_100087AE:				; CODE XREF: sub_10008740+5Bj
					; sub_10008740+61j
		add	ecx, 3Ch
		cmp	ecx, 0BF4h
		jb	short loc_10008760
		pop	esi
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100087BD:				; CODE XREF: sub_10008740+5j
		mov	ecx, [esp+arg_4]
		mov	eax, [esp+arg_8]
		mov	dword ptr [eax], 99h
		test	ecx, ecx
		jz	short loc_100087E6
		xor	eax, eax

loc_100087D1:				; CODE XREF: sub_10008740+A4j
		mov	edx, ds:dword_10026250[eax]
		mov	[ecx], edx
		add	eax, 14h
		add	ecx, 4
		cmp	eax, 0BF4h
		jb	short loc_100087D1

loc_100087E6:				; CODE XREF: sub_10008740+8Dj
		xor	eax, eax
		retn
sub_10008740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100087F0	proc near		; CODE XREF: sub_10003860+21j
					; DATA XREF: .rdata:10025FD2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		dec	eax
		push	esi
		jz	short loc_100087FF
		mov	esi, 1
		jmp	short loc_10008801
; ---------------------------------------------------------------------------

loc_100087FF:				; CODE XREF: sub_100087F0+6j
		xor	esi, esi

loc_10008801:				; CODE XREF: sub_100087F0+Dj
		mov	edx, [esp+4+arg_4]
		xor	ecx, ecx
		xor	eax, eax
		lea	esp, [esp+0]

loc_10008810:				; CODE XREF: sub_100087F0+31j
		cmp	edx, ds:dword_10026250[eax]
		jz	short loc_1000882A
		add	eax, 14h
		inc	ecx
		cmp	eax, 0BF4h
		jb	short loc_10008810

loc_10008823:				; CODE XREF: sub_100087F0+49j
		mov	eax, 70h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000882A:				; CODE XREF: sub_100087F0+26j
		test	esi, esi
		jz	short loc_1000883B
		lea	eax, [ecx+ecx*4]
		cmp	ds:dword_10026260[eax*4], 0
		jz	short loc_10008823

loc_1000883B:				; CODE XREF: sub_100087F0+3Cj
		lea	eax, [ecx+ecx*4]
		mov	edx, ds:dword_10026254[eax*4]
		mov	ecx, [esp+4+arg_8]
		lea	eax, dword_10026254[eax*4]
		mov	[ecx], edx
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		mov	eax, [eax+8]
		mov	[ecx+8], eax
		xor	eax, eax
		pop	esi
		retn
sub_100087F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008870	proc near		; CODE XREF: sub_1000C4C0+30p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		add	eax, 0FFFFFEFCh	; switch 9 cases
		cmp	eax, 8
		ja	loc_10008902	; jumptable 10008882 default case
		jmp	ds:off_10008908[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10008889:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 100h	; jumptable 10008882 case 260
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_10008890:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 200h	; jumptable 10008882 case 261
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_10008897:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 20000h	; jumptable 10008882 case 262
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_1000889E:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 40000h	; jumptable 10008882 case 263
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_100088A5:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 800h	; jumptable 10008882 case 264
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_100088AC:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 1000h	; jumptable 10008882 case 265
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_100088B3:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 2000h	; jumptable 10008882 case 266
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_100088BA:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 4000h	; jumptable 10008882 case 267
		jmp	short loc_100088C6
; ---------------------------------------------------------------------------

loc_100088C1:				; CODE XREF: sub_10008870+12j
					; DATA XREF: .text:off_10008908o
		mov	edx, 80000h	; jumptable 10008882 case 268

loc_100088C6:				; CODE XREF: sub_10008870+1Ej
					; sub_10008870+25j ...
		push	esi
		mov	esi, [esp+4+arg_0]
		xor	ecx, ecx
		xor	eax, eax
		nop

loc_100088D0:				; CODE XREF: sub_10008870+71j
		cmp	esi, ds:dword_10026250[eax]
		jz	short loc_100088EA
		add	eax, 14h
		inc	ecx
		cmp	eax, 0BF4h
		jb	short loc_100088D0
		mov	eax, 70h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100088EA:				; CODE XREF: sub_10008870+66j
		lea	eax, [ecx+ecx*4]
		mov	eax, ds:dword_1002625C[eax*4]
		and	eax, edx
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFF90h
		add	eax, 70h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008902:				; CODE XREF: sub_10008870+Cj
		mov	eax, 7		; jumptable 10008882 default case
		retn
sub_10008870	endp

; ---------------------------------------------------------------------------
off_10008908	dd offset loc_10008889	; DATA XREF: sub_10008870+12r
		dd offset loc_10008890	; jump table for switch	statement
		dd offset loc_10008897
		dd offset loc_1000889E
		dd offset loc_100088A5
		dd offset loc_100088AC
		dd offset loc_100088B3
		dd offset loc_100088BA
		dd offset loc_100088C1
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008930	proc near		; CODE XREF: sub_10003890+37p
					; DATA XREF: .rdata:10025FD6o

arg_0		= dword	ptr  4

		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		xor	ebp, ebp
		cmp	edi, 3
		jz	short loc_10008947
		cmp	edi, 65h
		jnb	short loc_10008947
		xor	eax, eax
		jmp	short loc_1000894C
; ---------------------------------------------------------------------------

loc_10008947:				; CODE XREF: sub_10008930+Cj
					; sub_10008930+11j
		mov	eax, 1

loc_1000894C:				; CODE XREF: sub_10008930+15j
		mov	eax, dword_10029658[eax*4]
		cmp	eax, ebp
		jz	short loc_1000896C
		push	edi
		push	eax
		call	PL_HashTableLookupConst
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebp
		jz	short loc_1000896C
		cmp	[esi+1Ch], ebp
		jnz	short loc_10008975

loc_1000896C:				; CODE XREF: sub_10008930+25j
					; sub_10008930+35j
		pop	edi
		pop	esi
		mov	eax, 3
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10008975:				; CODE XREF: sub_10008930+3Aj
		cmp	edi, 1
		jnz	short loc_10008983

loc_1000897A:				; CODE XREF: sub_10008930+B1j
		pop	edi
		pop	esi
		mov	eax, 0E2h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10008983:				; CODE XREF: sub_10008930+48j
		mov	eax, [esi+14h]
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		xor	edi, edi
		cmp	[esi+68h], ebp
		jbe	short loc_100089C7

loc_10008997:				; CODE XREF: sub_10008930+8Fj
					; sub_10008930+95j
		mov	ecx, [esi+64h]
		mov	eax, [ecx+edi*4]
		lea	ecx, [ecx+edi*4]
		cmp	eax, ebp
		jz	short loc_100089C1
		mov	edx, [eax]
		mov	[ecx], edx
		mov	ecx, [eax]
		cmp	ecx, ebp
		jz	short loc_100089B1
		mov	[ecx+4], ebp

loc_100089B1:				; CODE XREF: sub_10008930+7Cj
		push	eax
		mov	[eax+4], ebp
		mov	[eax], ebp
		call	sub_10016D30
		add	esp, 4
		jmp	short loc_10008997
; ---------------------------------------------------------------------------

loc_100089C1:				; CODE XREF: sub_10008930+72j
		inc	edi
		cmp	edi, [esi+68h]
		jb	short loc_10008997

loc_100089C7:				; CODE XREF: sub_10008930+65j
		mov	eax, [esi+14h]
		push	eax
		mov	[esi+30h], ebp
		call	ds:PR_Unlock
		push	esi
		call	sub_1001CE00
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jz	short loc_1000897A
		push	ebx
		push	edi
		call	sub_1001CE90
		push	edi
		mov	ebx, eax
		call	sub_1001CD90
		add	esp, 8
		cmp	ebx, ebp
		pop	ebx
		jz	short loc_10008A03
		pop	edi
		pop	esi
		mov	eax, 30h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10008A03:				; CODE XREF: sub_10008930+C8j
		push	esi
		call	sub_1001CDC0
		add	esp, 4
		cmp	eax, ebp
		jz	short loc_10008A19
		push	eax
		call	sub_1001CD90
		add	esp, 4

loc_10008A19:				; CODE XREF: sub_10008930+DEj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
sub_10008930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008A20(int,	int, size_t Size)
sub_10008A20	proc near		; CODE XREF: sub_10003910+64p
					; DATA XREF: .rdata:10025FDAo

var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
Src		= dword	ptr -108h
Dst		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Size		= dword	ptr  0Ch

		sub	esp, 110h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+110h+var_4], eax
		mov	eax, [esp+110h+arg_0]
		mov	ecx, [esp+110h+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+118h+Size]
		push	esi
		push	edi
		xor	edi, edi
		push	eax
		mov	[esp+124h+Src],	ecx
		mov	ebx, 0B3h
		mov	[esp+124h+var_110], edi
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10008AA0
		mov	eax, [esi+30h]
		mov	[esp+120h+var_10C], eax
		test	eax, eax
		jz	short loc_10008A8A
		push	eax
		call	sub_1001CE00
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10008ABB
		mov	ebx, 0A2h

loc_10008A8A:				; CODE XREF: sub_10008A20+54j
					; sub_10008A20+A6j
		push	esi
		call	sub_100177F0
		add	esp, 4

loc_10008A93:				; CODE XREF: sub_10008A20+BEj
					; sub_10008A20+CEj ...
		test	edi, edi
		jz	short loc_10008AA0
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_10008AA0:				; CODE XREF: sub_10008A20+49j
					; sub_10008A20+75j ...
		mov	eax, ebx

loc_10008AA2:				; CODE XREF: sub_10008A20+139j
		mov	ecx, [esp+120h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_10008ABB:				; CODE XREF: sub_10008A20+63j
		cmp	dword ptr [esi+1Ch], 4
		jz	short loc_10008AC8
		mov	ebx, 101h
		jmp	short loc_10008A8A
; ---------------------------------------------------------------------------

loc_10008AC8:				; CODE XREF: sub_10008A20+9Fj
		push	esi
		call	sub_100177F0
		add	esp, 4
		cmp	ebp, 0FFh
		jbe	short loc_10008AE0
		mov	ebx, 0A2h
		jmp	short loc_10008A93
; ---------------------------------------------------------------------------

loc_10008AE0:				; CODE XREF: sub_10008A20+B7j
		mov	ebx, [esp+120h+var_10C]
		cmp	ebp, [ebx+44h]
		jnb	short loc_10008AF0
		mov	ebx, 0A2h
		jmp	short loc_10008A93
; ---------------------------------------------------------------------------

loc_10008AF0:				; CODE XREF: sub_10008A20+C7j
		push	edi
		call	sub_1001EE90
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10008B05
		mov	ebx, 30h
		jmp	short loc_10008A93
; ---------------------------------------------------------------------------

loc_10008B05:				; CODE XREF: sub_10008A20+DCj
		mov	edx, [esp+120h+Src]
		push	ebp		; Size
		push	edx		; Src
		lea	eax, [esp+128h+Dst]
		push	eax		; Dst
		call	memcpy
		lea	ecx, [esp+12Ch+var_110]
		push	ecx
		lea	edx, [esp+130h+Dst]
		push	edx
		push	0
		push	edi
		mov	[esp+ebp+13Ch+Dst], 0
		call	sub_1001F7A0
		add	esp, 1Ch
		cmp	[esp+120h+var_110], 0
		mov	esi, eax
		jz	short loc_10008B43
		push	0
		push	ebx
		call	sub_10008020
		add	esp, 8

loc_10008B43:				; CODE XREF: sub_10008A20+116j
		push	edi
		call	sub_1001CD90
		add	esp, 4
		test	esi, esi
		jnz	short loc_10008B5E
		test	ebp, ebp
		jnz	short loc_10008B57
		mov	[ebx+2Ch], ebp

loc_10008B57:				; CODE XREF: sub_10008A20+132j
		xor	eax, eax
		jmp	loc_10008AA2
; ---------------------------------------------------------------------------

loc_10008B5E:				; CODE XREF: sub_10008A20+12Ej
		mov	ebx, 0A0h
		jmp	loc_10008AA0
sub_10008A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008B70(int,	int, size_t, int, size_t Size)
sub_10008B70	proc near		; CODE XREF: sub_100039C0+70p
					; DATA XREF: .rdata:10025FDEo

var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= dword	ptr -210h
Src		= dword	ptr -20Ch
var_208		= dword	ptr -208h
Dst		= byte ptr -204h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Size		= dword	ptr  14h

		sub	esp, 218h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+218h+var_4], eax
		mov	eax, [esp+218h+arg_0]
		mov	ecx, [esp+218h+arg_4]
		mov	edx, [esp+218h+arg_C]
		push	ebx
		mov	ebx, [esp+21Ch+arg_8]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+228h+Size]
		xor	esi, esi
		push	eax
		mov	[esp+22Ch+var_208], ecx
		mov	[esp+22Ch+Src],	edx
		mov	[esp+22Ch+var_214], esi
		mov	[esp+22Ch+var_218], 0B3h
		mov	[esp+22Ch+var_210], esi
		call	sub_100164F0
		mov	ebp, eax
		add	esp, 4
		cmp	ebp, esi
		jz	short loc_10008C2A
		mov	esi, [ebp+30h]
		test	esi, esi
		jz	short loc_10008C10
		push	esi
		call	sub_1001CE00
		add	esp, 4
		mov	[esp+228h+var_214], eax
		test	eax, eax
		jnz	short loc_10008BFC
		push	ebp
		call	sub_100177F0
		add	esp, 4
		mov	eax, 0A2h
		jmp	short loc_10008C2E
; ---------------------------------------------------------------------------

loc_10008BFC:				; CODE XREF: sub_10008B70+7Aj
		cmp	dword ptr [esi+2Ch], 0
		jz	short loc_10008C47
		cmp	dword ptr [ebp+1Ch], 3
		jz	short loc_10008C47
		mov	[esp+228h+var_218], 101h

loc_10008C10:				; CODE XREF: sub_10008B70+69j
		push	ebp
		call	sub_100177F0
		add	esp, 4

loc_10008C19:				; CODE XREF: sub_10008B70+FDj
		mov	ebp, [esp+228h+var_214]

loc_10008C1D:				; CODE XREF: sub_10008B70+203j
		test	ebp, ebp
		jz	short loc_10008C2A
		push	ebp
		call	sub_1001CD90
		add	esp, 4

loc_10008C2A:				; CODE XREF: sub_10008B70+62j
					; sub_10008B70+AFj
		mov	eax, [esp+228h+var_218]

loc_10008C2E:				; CODE XREF: sub_10008B70+8Aj
					; sub_10008B70+1F6j
		mov	ecx, [esp+228h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 218h
		retn
; ---------------------------------------------------------------------------

loc_10008C47:				; CODE XREF: sub_10008B70+90j
					; sub_10008B70+96j
		push	ebp
		call	sub_100177F0
		add	esp, 4
		cmp	edi, 0FFh
		ja	short loc_10008C65
		cmp	ebx, 0FFh
		ja	short loc_10008C65
		cmp	edi, [esi+44h]
		jnb	short loc_10008C6F

loc_10008C65:				; CODE XREF: sub_10008B70+E6j
					; sub_10008B70+EEj
		mov	[esp+228h+var_218], 0A2h
		jmp	short loc_10008C19
; ---------------------------------------------------------------------------

loc_10008C6F:				; CODE XREF: sub_10008B70+F3j
		mov	eax, [esp+228h+Src]
		push	edi		; Size
		push	eax		; Src
		lea	ecx, [esp+230h+Dst]
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+234h+var_208]
		push	ebx		; Size
		push	edx		; Src
		lea	eax, [esp+23Ch+var_104]
		push	eax		; Dst
		mov	[esp+edi+240h+Dst], 0
		call	memcpy
		mov	[esp+ebx+240h+var_104],	0
		mov	ecx, [esi+18h]
		push	ecx
		call	ds:PR_Lock
		mov	ebp, [esp+244h+var_214]
		lea	edx, [esp+244h+var_210]
		push	edx
		lea	eax, [esp+248h+Dst]
		push	eax
		lea	ecx, [esp+24Ch+var_104]
		push	ecx
		push	ebp
		call	sub_1001F7A0
		add	esp, 2Ch
		cmp	[esp+228h+var_210], 0
		mov	ebx, eax
		jz	short loc_10008CDC
		push	0
		push	esi
		call	sub_10008020
		add	esp, 8

loc_10008CDC:				; CODE XREF: sub_10008B70+15Fj
		test	ebx, ebx
		jz	short loc_10008CF5
		cmp	dword ptr [esi], 3
		jnz	short loc_10008CF5
		mov	edx, dword_10029614
		push	edx
		call	ds:PR_Sleep
		add	esp, 4

loc_10008CF5:				; CODE XREF: sub_10008B70+16Ej
					; sub_10008B70+173j
		mov	eax, [esi+18h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10008D6B
		xor	ecx, ecx
		test	edi, edi
		setnz	cl
		mov	[esi+2Ch], ecx
		test	edi, edi
		jnz	short loc_10008D55
		mov	edx, [esi+4]
		push	edx
		mov	[esp+22Ch+var_218], edi
		call	ds:PR_Lock
		mov	eax, [esi+4]
		push	eax
		mov	[esi+24h], edi
		mov	[esi+28h], edi
		call	ds:PR_Unlock
		lea	ecx, [esp+230h+var_218]
		push	ecx
		push	offset word_10026FE6
		push	ebp
		call	sub_1001EF70
		add	esp, 14h
		cmp	[esp+228h+var_218], edi
		jz	short loc_10008D55
		push	edi
		push	esi
		call	sub_10008020
		add	esp, 8

loc_10008D55:				; CODE XREF: sub_10008B70+1A2j
					; sub_10008B70+1D9j
		push	esi
		call	sub_100163D0
		push	ebp
		call	sub_1001CD90
		add	esp, 8
		xor	eax, eax
		jmp	loc_10008C2E
; ---------------------------------------------------------------------------

loc_10008D6B:				; CODE XREF: sub_10008B70+194j
		mov	[esp+228h+var_218], 0A0h
		jmp	loc_10008C1D
sub_10008B70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008D80	proc near		; CODE XREF: sub_10003A80:loc_10003A8Fj
					; DATA XREF: .rdata:10025FE2o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		cmp	edi, 3
		jz	short loc_10008D95
		cmp	edi, 65h
		jnb	short loc_10008D95
		xor	eax, eax
		jmp	short loc_10008D9A
; ---------------------------------------------------------------------------

loc_10008D95:				; CODE XREF: sub_10008D80+Aj
					; sub_10008D80+Fj
		mov	eax, 1

loc_10008D9A:				; CODE XREF: sub_10008D80+13j
		mov	eax, dword_10029658[eax*4]
		test	eax, eax
		jz	short loc_10008DBB
		push	edi
		push	eax
		call	PL_HashTableLookupConst
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10008DBB
		cmp	dword ptr [esi+1Ch], 0
		jnz	short loc_10008DC4

loc_10008DBB:				; CODE XREF: sub_10008D80+23j
					; sub_10008D80+33j
		pop	edi
		mov	eax, 3
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008DC4:				; CODE XREF: sub_10008D80+39j
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esp+0Ch+arg_C]
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		mov	eax, ebx
		or	eax, 4
		push	eax
		push	ecx
		push	edx
		push	edi
		call	sub_10016450
		mov	edi, eax
		add	esp, 10h
		mov	[esp+10h+arg_0], edi
		test	edi, edi
		jnz	short loc_10008DF4
		pop	ebx
		lea	eax, [edi+2]
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008DF4:				; CODE XREF: sub_10008D80+6Aj
		cmp	dword ptr [esi+34h], 0
		jz	short loc_10008E03
		test	bl, 2
		jz	short loc_10008E03
		and	dword ptr [edi+20h], 0FFFFFFFDh

loc_10008E03:				; CODE XREF: sub_10008D80+78j
					; sub_10008D80+7Dj
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [esi+4]
		inc	dword ptr [esi+50h]
		push	ecx
		call	ds:PR_Unlock
		mov	ebx, ds:PR_AtomicIncrement
		add	esp, 8
		test	byte ptr [edi+20h], 2
		jz	short loc_10008E32
		lea	edx, [esi+54h]
		push	edx
		call	ebx ; PR_AtomicIncrement
		add	esp, 4

loc_10008E32:				; CODE XREF: sub_10008D80+A7j
		push	ebp
		jmp	short loc_10008E40
; ---------------------------------------------------------------------------

loc_10008E35:				; CODE XREF: sub_10008D80+171j
		mov	ebx, ds:PR_AtomicIncrement
		jmp	short loc_10008E40
; ---------------------------------------------------------------------------
		align 10h

loc_10008E40:				; CODE XREF: sub_10008D80+B3j
					; sub_10008D80+BBj ...
		lea	eax, [esi+48h]
		push	eax
		call	ebx ; PR_AtomicIncrement
		mov	edi, eax
		mov	eax, [esi+5Ch]
		and	edi, 0FFFFFFh
		shl	eax, 18h
		add	esp, 4
		or	edi, eax
		jz	short loc_10008E40
		mov	ecx, [esi+10h]
		mov	edx, [esi+8]
		and	ecx, edi
		mov	eax, [edx+ecx*4]
		push	eax
		mov	[esp+18h+var_4], eax
		call	ds:PR_Lock
		mov	eax, [esi+70h]
		mov	ecx, [esi+6Ch]
		mov	ebx, edi
		imul	ebx, 6AC690C5h
		dec	eax
		and	eax, ebx
		mov	ebp, [ecx+eax*4]
		add	esp, 4
		test	ebp, ebp
		jz	short loc_10008E9C
		lea	esp, [esp+0]

loc_10008E90:				; CODE XREF: sub_10008D80+11Aj
		cmp	[ebp+8], edi
		jz	short loc_10008EDE
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	short loc_10008E90

loc_10008E9C:				; CODE XREF: sub_10008D80+10Aj
		mov	eax, [esp+14h+arg_0]
		push	eax
		push	esi
		mov	[eax+8], edi
		call	sub_10016390
		mov	eax, [esi+70h]
		mov	edx, [esi+6Ch]
		mov	ecx, [esp+1Ch+arg_0]
		dec	eax
		and	eax, ebx
		mov	edx, [edx+eax*4]
		mov	[ecx], edx
		mov	dword ptr [ecx+4], 0
		mov	edx, [esi+6Ch]
		lea	edx, [edx+eax*4]
		add	esp, 8
		cmp	dword ptr [edx], 0
		jz	short loc_10008ED6
		mov	edx, [edx]
		mov	[edx+4], ecx

loc_10008ED6:				; CODE XREF: sub_10008D80+14Fj
		mov	edx, [esi+6Ch]
		mov	[edx+eax*4], ecx
		jmp	short loc_10008EE1
; ---------------------------------------------------------------------------

loc_10008EDE:				; CODE XREF: sub_10008D80+113j
		inc	dword ptr [esi+4Ch]

loc_10008EE1:				; CODE XREF: sub_10008D80+15Cj
		mov	eax, [esp+14h+var_4]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		test	ebp, ebp
		jnz	loc_10008E35
		mov	ecx, [esp+14h+arg_10]
		pop	ebp
		pop	ebx
		mov	[ecx], edi
		pop	edi
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_10008D80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008F10	proc near		; CODE XREF: sub_10003AA0j
					; DATA XREF: .rdata:10025FE6o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	edi
		push	ebx
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10008F2F
		pop	edi
		mov	eax, 0B3h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008F2F:				; CODE XREF: sub_10008F10+14j
		push	ebp
		push	esi
		mov	esi, [edi+30h]
		mov	eax, [esi+10h]
		mov	ecx, [esi+8]
		and	eax, ebx
		mov	ebp, [ecx+eax*4]
		push	ebp
		mov	[esp+18h+var_4], 0
		call	ds:PR_Lock
		mov	eax, [edi]
		add	esp, 4
		test	eax, eax
		jnz	short loc_10008F72
		cmp	[edi+4], eax
		jnz	short loc_10008F72
		mov	edx, [esi+70h]
		mov	ecx, ebx
		imul	ecx, 6AC690C5h
		dec	edx
		and	edx, ecx
		mov	ecx, [esi+6Ch]
		cmp	[ecx+edx*4], edi
		jnz	short loc_10008FB3

loc_10008F72:				; CODE XREF: sub_10008F10+45j
					; sub_10008F10+4Aj
		mov	[esp+14h+var_4], 1
		test	eax, eax
		jz	short loc_10008F84
		mov	edx, [edi+4]
		mov	[eax+4], edx

loc_10008F84:				; CODE XREF: sub_10008F10+6Cj
		mov	eax, [edi+4]
		mov	ecx, [edi]
		test	eax, eax
		jz	short loc_10008F91
		mov	[eax], ecx
		jmp	short loc_10008FA3
; ---------------------------------------------------------------------------

loc_10008F91:				; CODE XREF: sub_10008F10+7Bj
		mov	edx, [esi+70h]
		imul	ebx, 6AC690C5h
		mov	eax, [esi+6Ch]
		dec	edx
		and	edx, ebx
		mov	[eax+edx*4], ecx

loc_10008FA3:				; CODE XREF: sub_10008F10+7Fj
		dec	dword ptr [edi+0Ch]
		mov	dword ptr [edi], 0
		mov	dword ptr [edi+4], 0

loc_10008FB3:				; CODE XREF: sub_10008F10+60j
		push	ebp
		mov	ebp, ds:PR_Unlock
		call	ebp ; PR_Unlock
		add	esp, 4
		cmp	[esp+14h+var_4], 0
		jz	short loc_10009023
		push	esi
		call	sub_1001CE00
		mov	edx, [esi+4]
		push	edx
		mov	ebx, eax
		call	ds:PR_Lock
		add	esp, 8
		dec	dword ptr [esi+50h]
		jnz	short loc_10008FFA
		cmp	dword ptr [esi+2Ch], 0
		mov	dword ptr [esi+24h], 0
		jz	short loc_10008FFA
		test	ebx, ebx
		jz	short loc_10008FFA
		push	ebx
		call	sub_1001FA20
		add	esp, 4

loc_10008FFA:				; CODE XREF: sub_10008F10+CEj
					; sub_10008F10+DBj ...
		mov	eax, [esi+4]
		push	eax
		call	ebp ; PR_Unlock
		add	esp, 4
		test	ebx, ebx
		jz	short loc_10009010
		push	ebx
		call	sub_1001CD90
		add	esp, 4

loc_10009010:				; CODE XREF: sub_10008F10+F5j
		test	byte ptr [edi+20h], 2
		jz	short loc_10009023
		add	esi, 54h
		push	esi
		call	ds:PR_AtomicDecrement
		add	esp, 4

loc_10009023:				; CODE XREF: sub_10008F10+B4j
					; sub_10008F10+104j
		push	edi
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebp
		pop	edi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_10008F10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009040	proc near		; CODE XREF: sub_10003AB0j
					; DATA XREF: .rdata:10025FEAo

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		cmp	ecx, 3
		jz	short loc_10009052
		cmp	ecx, 65h
		jnb	short loc_10009052
		xor	eax, eax
		jmp	short loc_10009057
; ---------------------------------------------------------------------------

loc_10009052:				; CODE XREF: sub_10009040+7j
					; sub_10009040+Cj
		mov	eax, 1

loc_10009057:				; CODE XREF: sub_10009040+10j
		mov	eax, dword_10029658[eax*4]
		test	eax, eax
		jz	short loc_10009076
		push	ecx
		push	eax
		call	PL_HashTableLookupConst
		add	esp, 8
		test	eax, eax
		jz	short loc_10009076
		cmp	dword ptr [eax+1Ch], 0
		jnz	short loc_1000907C

loc_10009076:				; CODE XREF: sub_10009040+20j
					; sub_10009040+2Ej
		mov	eax, 3
		retn
; ---------------------------------------------------------------------------

loc_1000907C:				; CODE XREF: sub_10009040+34j
		push	1
		push	eax
		call	sub_10008020
		add	esp, 8
		retn
sub_10009040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009090	proc near		; CODE XREF: sub_10003AC0+1Ap
					; DATA XREF: .rdata:10025FEEo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_100090A7
		mov	eax, 0B3h
		retn
; ---------------------------------------------------------------------------

loc_100090A7:				; CODE XREF: sub_10009090+Fj
		mov	edx, [eax+18h]
		mov	ecx, [esp+arg_4]
		mov	[ecx], edx
		mov	edx, [eax+1Ch]
		mov	[ecx+4], edx
		mov	edx, [eax+20h]
		mov	[ecx+8], edx
		mov	edx, [eax+24h]
		push	eax
		mov	[ecx+0Ch], edx
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax
		retn
sub_10009090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100090D0(int,	int, void *Src,	size_t Size)
sub_100090D0	proc near		; CODE XREF: sub_10003B10+5Ap
					; DATA XREF: .rdata:10025FFAo

var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
Dst		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h

		sub	esp, 10Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+110h+Src]
		push	ebp
		mov	ebp, [esp+114h+Size]
		push	esi
		push	edi
		mov	edi, [esp+11Ch+arg_0]
		push	edi
		mov	[esp+120h+var_10C], 0
		call	sub_10007E90
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000911E

loc_10009114:				; CODE XREF: sub_100090D0+59j
		mov	eax, 0B3h
		jmp	loc_100092C2
; ---------------------------------------------------------------------------

loc_1000911E:				; CODE XREF: sub_100090D0+42j
		push	edi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jz	short loc_10009114
		mov	ecx, [eax+20h]
		push	eax
		mov	[esp+120h+var_108], ecx
		call	sub_100177F0
		add	esp, 4
		cmp	dword ptr [esi], 1
		jnz	short loc_1000914A

loc_10009140:				; CODE XREF: sub_100090D0+D7j
		mov	eax, 103h
		jmp	loc_100092C2
; ---------------------------------------------------------------------------

loc_1000914A:				; CODE XREF: sub_100090D0+6Ej
		cmp	dword ptr [esi+24h], 0
		jz	short loc_1000915A
		mov	eax, 100h
		jmp	loc_100092C2
; ---------------------------------------------------------------------------

loc_1000915A:				; CODE XREF: sub_100090D0+7Ej
		cmp	dword ptr [esi+2Ch], 0
		jnz	short loc_10009170
		mov	eax, ebp
		neg	eax
		sbb	eax, eax
		and	eax, 0A0h
		jmp	loc_100092C2
; ---------------------------------------------------------------------------

loc_10009170:				; CODE XREF: sub_100090D0+8Ej
		mov	dword ptr [esi+28h], 0
		cmp	ebp, 0FFh
		jbe	short loc_10009189
		mov	eax, 0A2h
		jmp	loc_100092C2
; ---------------------------------------------------------------------------

loc_10009189:				; CODE XREF: sub_100090D0+ADj
		push	ebp		; Size
		lea	edx, [esp+120h+Dst]
		push	ebx		; Src
		push	edx		; Dst
		call	memcpy
		push	esi
		mov	[esp+ebp+12Ch+Dst], 0
		call	sub_1001CE00
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_10009140
		push	edi
		call	sub_1001EE90
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000921B
		mov	ebx, [esp+11Ch+arg_4]
		test	ebx, ebx
		jnz	short loc_100091C9
		test	byte ptr [esp+11Ch+var_108], 2
		jnz	short loc_100091CE

loc_100091C9:				; CODE XREF: sub_100090D0+F0j
		cmp	dword ptr [esi], 3
		jnz	short loc_10009211

loc_100091CE:				; CODE XREF: sub_100090D0+F7j
		test	ebp, ebp
		jnz	loc_100092B2
		push	edi
		call	sub_1001FA20
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		mov	edx, [esi+4]
		xor	ecx, ecx
		test	ebx, ebx
		setz	cl
		push	edx
		mov	dword ptr [esi+24h], 1
		mov	[esi+28h], ecx
		call	ds:PR_Unlock
		push	esi
		call	sub_100163D0
		add	esp, 10h
		xor	esi, esi
		jmp	loc_100092B7
; ---------------------------------------------------------------------------

loc_10009211:				; CODE XREF: sub_100090D0+FCj
					; sub_100090D0+153j
		mov	esi, 103h
		jmp	loc_100092B7
; ---------------------------------------------------------------------------

loc_1000921B:				; CODE XREF: sub_100090D0+E5j
		cmp	[esp+11Ch+arg_4], 1
		jnz	short loc_10009211
		mov	eax, [esi+18h]
		push	eax
		call	ds:PR_Lock
		lea	ecx, [esp+120h+var_10C]
		push	ecx
		lea	edx, [esp+124h+Dst]
		push	edx
		push	edi
		call	sub_1001EF70
		add	esp, 10h
		cmp	[esp+11Ch+var_10C], 0
		mov	ebp, eax
		jz	short loc_10009256
		push	0
		push	esi
		call	sub_10008020
		add	esp, 8

loc_10009256:				; CODE XREF: sub_100090D0+179j
		test	ebp, ebp
		jz	short loc_1000926E
		cmp	dword ptr [esi], 3
		jnz	short loc_1000926E
		mov	eax, dword_10029614
		push	eax
		call	ds:PR_Sleep
		add	esp, 4

loc_1000926E:				; CODE XREF: sub_100090D0+188j
					; sub_100090D0+18Dj
		mov	ecx, [esi+18h]
		mov	ebx, ds:PR_Unlock
		push	ecx
		call	ebx ; PR_Unlock
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_100092B2
		mov	edx, [esi+4]
		push	edx
		call	ds:PR_Lock
		push	edi
		call	sub_1001F1D0
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	[esi+24h], eax
		mov	eax, [esi+4]
		push	eax
		call	ebx ; PR_Unlock
		push	edi
		call	sub_1001CD90
		push	esi
		call	sub_100163D0
		add	esp, 14h
		xor	eax, eax
		jmp	short loc_100092C2
; ---------------------------------------------------------------------------

loc_100092B2:				; CODE XREF: sub_100090D0+100j
					; sub_100090D0+1AFj
		mov	esi, 0A0h

loc_100092B7:				; CODE XREF: sub_100090D0+13Cj
					; sub_100090D0+146j
		push	edi
		call	sub_1001CD90
		add	esp, 4
		mov	eax, esi

loc_100092C2:				; CODE XREF: sub_100090D0+49j
					; sub_100090D0+75j ...
		mov	ecx, [esp+11Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10Ch
		retn
sub_100090D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100092E0	proc near		; CODE XREF: sub_10003BD0+3Ep
					; DATA XREF: .rdata:10025FFEo

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		push	edi
		call	sub_10007E90
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100092FD

loc_100092F5:				; CODE XREF: sub_100092E0+28j
		pop	edi
		mov	eax, 0B3h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100092FD:				; CODE XREF: sub_100092E0+13j
		push	edi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jz	short loc_100092F5
		push	eax
		call	sub_100177F0
		add	esp, 4
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_10009321
		pop	edi
		mov	eax, 101h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10009321:				; CODE XREF: sub_100092E0+37j
		push	esi
		call	sub_1001CE00
		mov	edi, eax
		mov	eax, [esi+4]
		push	eax
		call	ds:PR_Lock
		add	esp, 8
		cmp	dword ptr [esi+2Ch], 0
		mov	dword ptr [esi+24h], 0
		mov	dword ptr [esi+28h], 0
		jz	short loc_10009357
		test	edi, edi
		jz	short loc_10009357
		push	edi
		call	sub_1001FA20
		add	esp, 4

loc_10009357:				; CODE XREF: sub_100092E0+68j
					; sub_100092E0+6Cj
		mov	ecx, [esi+4]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4
		test	edi, edi
		jz	short loc_10009371
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_10009371:				; CODE XREF: sub_100092E0+86j
		push	esi
		call	sub_100163D0
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100092E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009380	proc near		; CODE XREF: sub_10003E20+3Ep
					; DATA XREF: .rdata:1002600Eo

arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
sub_10009380	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009390	proc near		; CODE XREF: sub_100035C0+23p
					; sub_10003EA0+43p
					; DATA XREF: ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		push	esi
		call	sub_10007E90
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100093B3
		pop	edi
		mov	eax, 0B3h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100093B3:				; CODE XREF: sub_10009390+16j
		push	ebx
		push	esi
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		mov	[esp+18h+var_4], ebx
		test	ebx, ebx
		jnz	short loc_100093D3
		pop	ebx
		pop	edi
		mov	eax, 0B3h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100093D3:				; CODE XREF: sub_10009390+35j
		mov	esi, [esp+18h+arg_4]
		mov	eax, esi
		and	eax, 80000000h
		push	ebp
		cmp	eax, 80000000h
		jnz	loc_100094B2
		mov	edi, [ebx+30h]
		push	esi
		push	edi
		call	sub_1001CE40
		add	esp, 8
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	short loc_10009415
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 82h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009415:				; CODE XREF: sub_10009390+6Dj
		mov	ebx, [esp+1Ch+arg_C]
		mov	ebp, [esp+1Ch+arg_8]
		push	ebx
		push	ebp
		push	esi
		push	eax
		call	sub_1001BB30
		push	edi
		mov	[esp+30h+var_8], eax
		call	sub_1001CE00
		mov	edi, eax
		add	esp, 14h
		cmp	[esp+1Ch+var_C], edi
		jnz	short loc_10009482
		test	ebx, ebx
		jle	short loc_10009482
		lea	esi, [ebp+8]

loc_10009442:				; CODE XREF: sub_10009390+F0j
		mov	ecx, [esi-8]
		push	3
		push	ecx
		call	sub_100160C0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000947C
		mov	eax, [esi-4]
		mov	[esp+1Ch+var_8], 11h
		test	eax, eax
		jz	short loc_10009476
		mov	ecx, [esi]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10009476
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10009476:				; CODE XREF: sub_10009390+D1j
					; sub_10009390+D8j
		mov	dword ptr [esi], 0FFFFFFFFh

loc_1000947C:				; CODE XREF: sub_10009390+C2j
		add	esi, 0Ch
		dec	ebx
		jnz	short loc_10009442

loc_10009482:				; CODE XREF: sub_10009390+A9j
					; sub_10009390+ADj
		mov	edx, [esp+1Ch+var_4]
		push	edx
		call	sub_100177F0
		mov	eax, [esp+20h+var_C]
		push	eax
		call	sub_1001CD90
		add	esp, 8
		test	edi, edi
		jz	short loc_100094A6
		push	edi
		call	sub_1001CD90
		add	esp, 4

loc_100094A6:				; CODE XREF: sub_10009390+10Bj
		mov	eax, [esp+1Ch+var_8]
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100094B2:				; CODE XREF: sub_10009390+54j
		push	ebx
		push	esi
		call	sub_10017DA0
		push	ebx
		mov	ebp, eax
		call	sub_100177F0
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_100094D5
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 82h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100094D5:				; CODE XREF: sub_10009390+136j
		cmp	dword ptr [edi+24h], 0
		jnz	short loc_10009506
		cmp	dword ptr [edi+2Ch], 0
		jz	short loc_10009506
		push	2
		push	ebp
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10009506
		push	ebp
		call	sub_10016D30
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 101h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009506:				; CODE XREF: sub_10009390+149j
					; sub_10009390+14Fj ...
		push	103h
		push	ebp
		xor	ebx, ebx
		call	sub_100169F0
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_C]
		add	esp, 8
		test	eax, eax
		jle	loc_100095A6
		mov	esi, [esp+1Ch+arg_8]
		add	esi, 8
		mov	[esp+1Ch+var_8], eax

loc_10009531:				; CODE XREF: sub_10009390+214j
		cmp	[esp+1Ch+var_4], 0
		jz	short loc_10009559
		mov	ecx, [ebp+8]
		mov	edx, [esi-8]
		push	ecx
		push	edx
		call	sub_100160C0
		add	esp, 8
		test	eax, eax
		jz	short loc_10009559
		mov	ebx, 11h
		mov	dword ptr [esi], 0FFFFFFFFh
		jmp	short loc_1000959D
; ---------------------------------------------------------------------------

loc_10009559:				; CODE XREF: sub_10009390+1A6j
					; sub_10009390+1BAj
		mov	eax, [esi-8]
		push	eax
		push	ebp
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_10009577
		lea	ebx, [eax+12h]
		mov	dword ptr [esi], 0FFFFFFFFh
		jmp	short loc_1000959D
; ---------------------------------------------------------------------------

loc_10009577:				; CODE XREF: sub_10009390+1DAj
		mov	eax, [esi-4]
		test	eax, eax
		jz	short loc_1000958F
		mov	ecx, [edi+1Ch]
		mov	edx, [edi+18h]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000958F:				; CODE XREF: sub_10009390+1ECj
		mov	eax, [edi+1Ch]
		push	edi
		mov	[esi], eax
		call	sub_10015D70
		add	esp, 4

loc_1000959D:				; CODE XREF: sub_10009390+1C7j
					; sub_10009390+1E5j
		add	esi, 0Ch
		dec	[esp+1Ch+var_8]
		jnz	short loc_10009531

loc_100095A6:				; CODE XREF: sub_10009390+190j
		push	ebp
		call	sub_10016D30
		add	esp, 4
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
sub_10009390	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100095C0	proc near		; CODE XREF: sub_10003F30+43p
					; DATA XREF: .rdata:10026016o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	esi
		call	sub_10007E90
		mov	ebp, eax
		add	esp, 4
		xor	ebx, ebx
		test	ebp, ebp
		jnz	short loc_100095E1

loc_100095D8:				; CODE XREF: sub_100095C0+2Ej
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100095E1:				; CODE XREF: sub_100095C0+16j
		push	esi
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100095D8
		mov	eax, [esp+0Ch+arg_4]
		push	edi
		push	esi
		push	eax
		call	sub_10017DA0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_10009618
		push	esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 82h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009618:				; CODE XREF: sub_100095C0+43j
		cmp	[ebp+24h], ebx
		jnz	short loc_1000964A
		cmp	[ebp+2Ch], ebx
		jz	short loc_1000964A
		push	2
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000964A
		push	esi
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 101h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000964A:				; CODE XREF: sub_100095C0+5Bj
					; sub_100095C0+60j ...
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	byte ptr [esi+20h], 2
		jnz	short loc_10009678
		test	eax, eax
		jz	short loc_10009678
		push	esi
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B5h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009678:				; CODE XREF: sub_100095C0+99j
					; sub_100095C0+9Dj
		push	esi
		call	sub_100177F0
		push	170h
		push	edi
		call	sub_100169F0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100096A3
		push	edi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 10h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100096A3:				; CODE XREF: sub_100095C0+CEj
		xor	ebp, ebp
		cmp	[esp+10h+arg_C], ebx
		jle	loc_1000973E
		mov	esi, [esp+10h+arg_8]

loc_100096B3:				; CODE XREF: sub_100095C0+152j
		mov	ecx, [edi+8]
		mov	edx, [esi]
		push	ecx
		push	edx
		call	sub_10015EF0
		add	esp, 8
		sub	eax, 2
		jz	short loc_100096CA
		dec	eax
		jmp	short loc_100096D8
; ---------------------------------------------------------------------------

loc_100096CA:				; CODE XREF: sub_100095C0+105j
		cmp	dword ptr [esi], 162h
		mov	ecx, [esi+4]
		setnz	al
		cmp	[ecx], al

loc_100096D8:				; CODE XREF: sub_100095C0+108j
		jnz	short loc_10009724
		mov	edx, [esi]
		push	edx
		push	edi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10009739
		push	eax
		call	sub_10015D70
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		mov	edx, [esi]
		push	eax		; Size
		push	ecx		; Src
		push	edx		; int
		push	edi		; int
		call	sub_10017BD0
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jnz	short loc_1000973E
		inc	ebp
		add	esi, 0Ch
		cmp	ebp, [esp+10h+arg_C]
		jl	short loc_100096B3
		push	edi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009724:				; CODE XREF: sub_100095C0:loc_100096D8j
		push	edi
		mov	ebx, 10h
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009739:				; CODE XREF: sub_100095C0+128j
		mov	ebx, 12h

loc_1000973E:				; CODE XREF: sub_100095C0+E9j
					; sub_100095C0+148j
		push	edi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
sub_100095C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009750	proc near		; CODE XREF: sub_10009800+E9p
					; sub_10009800+162p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [edi+4]
		mov	ecx, [edi]
		sub	esp, 8
		push	ebx
		mov	ebx, [edi+0Ch]
		push	ebp
		lea	ebp, [ecx+eax*4]
		mov	ecx, [esp+10h+arg_4]
		lea	edx, [esp+10h+var_8]
		push	edx
		mov	edx, [esp+14h+arg_0]
		sub	ebx, eax
		mov	eax, [esp+14h+arg_8]
		push	eax
		push	ecx
		push	edx
		call	sub_1001BA20
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100097F9
		push	esi

loc_10009783:				; CODE XREF: sub_10009750+92j
		mov	ecx, [esp+14h+var_8]
		mov	edx, [esp+14h+arg_0]
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		push	ebp
		push	ecx
		push	edx
		call	sub_1001BAA0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_100097E4
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jz	short loc_100097E4
		add	[edi+4], eax
		sub	ebx, eax
		test	ebx, ebx
		jg	short loc_100097E4
		mov	ecx, [edi]
		mov	ebx, 5
		add	[edi+0Ch], ebx
		mov	eax, [edi+0Ch]
		add	eax, eax
		add	eax, eax
		push	eax
		push	ecx
		call	PORT_Realloc_Util
		mov	edx, [edi+4]
		add	esp, 8
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, 0FFFFFFFEh
		add	esi, 2
		mov	[edi], eax
		lea	ebp, [eax+edx*4]
		jz	short loc_10009783

loc_100097E4:				; CODE XREF: sub_10009750+50j
					; sub_10009750+58j ...
		mov	eax, [esp+14h+var_8]
		mov	ecx, [esp+14h+arg_0]
		push	eax
		push	ecx
		call	sub_1001BB10
		add	esp, 8
		mov	eax, esi
		pop	esi

loc_100097F9:				; CODE XREF: sub_10009750+30j
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10009750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009800	proc near		; CODE XREF: sub_100099C0+71p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 30h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+3Ch+arg_10]
		xor	ebx, ebx
		push	edi
		xor	ebp, ebp
		or	edi, 0FFFFFFFFh
		xor	edx, edx
		mov	[esp+40h+var_30], 0CE534352h
		mov	[esp+40h+var_28], ebx
		cmp	esi, ebx
		jbe	loc_100099B0
		mov	ecx, [esp+40h+arg_C]
		lea	esp, [esp+0]

loc_10009830:				; CODE XREF: sub_10009800+63j
		mov	eax, [ecx]
		cmp	eax, ebx
		jnz	short loc_1000984B
		cmp	dword ptr [ecx+8], 4
		jnz	short loc_10009865
		mov	eax, [ecx+4]
		cmp	dword ptr [eax], 1
		jnz	short loc_10009865
		mov	ebp, 1
		jmp	short loc_10009858
; ---------------------------------------------------------------------------

loc_1000984B:				; CODE XREF: sub_10009800+34j
		cmp	eax, 0CE534352h
		jnz	short loc_10009854
		mov	edi, edx

loc_10009854:				; CODE XREF: sub_10009800+50j
		cmp	ebp, ebx
		jz	short loc_1000985D

loc_10009858:				; CODE XREF: sub_10009800+49j
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10009865

loc_1000985D:				; CODE XREF: sub_10009800+56j
		inc	edx
		add	ecx, 0Ch
		cmp	edx, esi
		jb	short loc_10009830

loc_10009865:				; CODE XREF: sub_10009800+3Aj
					; sub_10009800+42j ...
		cmp	ebp, ebx
		jz	loc_100099B0
		cmp	edi, 0FFFFFFFFh
		jz	loc_100099B0
		mov	eax, [esp+40h+arg_C]
		lea	edx, [edi+edi*2]
		lea	esi, [eax+edx*4]
		mov	edx, [esi+4]
		mov	eax, [esi+8]
		lea	ecx, [esp+40h+var_30]
		mov	[esp+40h+var_14], ecx
		mov	ecx, [esi]
		push	14h
		mov	[esp+44h+var_18], ebx
		mov	[esp+44h+var_10], 4
		mov	[esp+44h+var_C], ecx
		mov	[esp+44h+var_8], edx
		mov	[esp+44h+var_4], eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+40h+var_28], eax
		cmp	eax, ebx
		jnz	short loc_100098C9
		mov	edi, 2
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_100098C9:				; CODE XREF: sub_10009800+B8j
		mov	ebp, [esp+40h+arg_4]
		push	2
		lea	ecx, [esp+44h+var_18]
		push	ecx
		push	ebp
		lea	edi, [esp+4Ch+var_28]
		mov	[esp+4Ch+var_20], ebx
		mov	[esp+4Ch+var_24], ebx
		mov	[esp+4Ch+var_1C], 5
		call	sub_10009750
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebx
		jnz	loc_10009995
		cmp	[esp+40h+var_24], ebx
		jz	loc_10009995
		mov	edx, [esp+40h+var_28]
		mov	eax, [edx]
		mov	ecx, [esp+40h+arg_0]
		push	eax
		push	ebx
		push	ecx
		call	sub_10017840
		add	esp, 0Ch
		mov	[esp+40h+var_2C], eax
		cmp	eax, ebx
		jnz	short loc_10009929
		mov	edi, 2
		jmp	short loc_10009995
; ---------------------------------------------------------------------------

loc_10009929:				; CODE XREF: sub_10009800+120j
		push	101h
		push	eax
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_10009942
		lea	edi, [eax+12h]
		jmp	short loc_10009986
; ---------------------------------------------------------------------------

loc_10009942:				; CODE XREF: sub_10009800+13Bj
		mov	edx, [ebx+14h]
		mov	edi, [esp+40h+arg_8]
		mov	[esi], edx
		mov	eax, [ebx+18h]
		mov	edx, [esp+40h+arg_10]
		mov	[esi+4], eax
		mov	eax, [esp+40h+arg_C]
		mov	ecx, [ebx+1Ch]
		push	edx
		push	eax
		push	ebp
		mov	[esi+8], ecx
		call	sub_10009750
		mov	ecx, [esp+4Ch+var_C]
		mov	edx, [esp+4Ch+var_8]
		mov	edi, eax
		mov	eax, [esp+4Ch+var_4]
		mov	[esi], ecx
		mov	[esi+4], edx
		push	ebx
		mov	[esi+8], eax
		call	sub_10015D70
		add	esp, 10h

loc_10009986:				; CODE XREF: sub_10009800+140j
		mov	ecx, [esp+40h+var_2C]
		push	ecx
		call	sub_10016D30
		add	esp, 4
		xor	ebx, ebx

loc_10009995:				; CODE XREF: sub_10009800+F5j
					; sub_10009800+FFj ...
		mov	eax, [esp+40h+var_28]
		cmp	eax, ebx
		jz	short loc_100099A6
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_100099A6:				; CODE XREF: sub_10009800+19Bj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_100099B0:				; CODE XREF: sub_10009800+22j
					; sub_10009800+67j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 30h
		retn
sub_10009800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100099C0	proc near		; CODE XREF: sub_10009A90+ACp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_8]
		push	esi
		push	edi
		mov	esi, eax
		xor	edi, edi
		xor	eax, eax
		mov	[esp+14h+var_4], 1
		cmp	esi, edi
		jbe	short loc_10009A0A
		mov	ecx, ebp
		lea	ecx, [ecx+0]

loc_100099E0:				; CODE XREF: sub_100099C0+2Fj
		cmp	[ecx], edi
		jnz	short loc_100099E9
		cmp	[ecx+4], edi
		jnz	short loc_100099F3

loc_100099E9:				; CODE XREF: sub_100099C0+22j
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_100099E0
		jmp	short loc_10009A0A
; ---------------------------------------------------------------------------

loc_100099F3:				; CODE XREF: sub_100099C0+27j
		lea	eax, [eax+eax*2]
		mov	ecx, [ebp+eax*4+4]
		mov	eax, [ecx]
		cmp	eax, 3
		jz	short loc_10009A4C
		cmp	eax, 4
		jz	short loc_10009A4C
		mov	[esp+14h+var_4], edi

loc_10009A0A:				; CODE XREF: sub_100099C0+19j
					; sub_100099C0+31j
		mov	edx, [esp+14h+arg_0]
		push	edx
		call	sub_1001CDC0
		mov	edi, [esp+18h+arg_4]
		push	esi
		mov	ebx, eax
		push	ebp
		push	ebx
		call	sub_10009750
		mov	ecx, [esp+24h+arg_0]
		push	esi
		mov	edi, eax
		mov	eax, [esp+28h+arg_4]
		push	ebp
		push	eax
		push	ebx
		push	ecx
		call	sub_10009800
		add	esp, 24h
		test	edi, edi
		jnz	short loc_10009A3F
		mov	edi, eax

loc_10009A3F:				; CODE XREF: sub_100099C0+7Bj
		push	ebx
		call	sub_1001CD90
		add	esp, 4
		test	edi, edi
		jnz	short loc_10009A85

loc_10009A4C:				; CODE XREF: sub_100099C0+3Fj
					; sub_100099C0+44j
		cmp	[esp+14h+arg_C], 0
		jz	short loc_10009A85
		cmp	[esp+14h+var_4], 0
		jz	short loc_10009A85
		mov	edx, [esp+14h+arg_0]
		push	edx
		call	sub_1001CE00
		mov	edi, [esp+18h+arg_4]
		push	esi
		mov	ebx, eax
		push	ebp
		push	ebx
		call	sub_10009750
		push	ebx
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 14h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009A85:				; CODE XREF: sub_100099C0+8Aj
					; sub_100099C0+91j ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100099C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009A90	proc near		; CODE XREF: sub_10003FC0+4Fp
					; DATA XREF: .rdata:1002601Ao

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	edi
		call	sub_10007E90
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10009AAF
		pop	edi
		mov	eax, 0B3h
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009AAF:				; CODE XREF: sub_10009A90+14j
		push	ebx
		push	ebp
		push	edi
		call	sub_100164F0
		mov	ebp, eax
		add	esp, 4
		mov	[esp+14h+var_4], ebp
		test	ebp, ebp
		jnz	short loc_10009AD1
		pop	ebp
		mov	edi, 0B3h
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009AD1:				; CODE XREF: sub_10009A90+32j
		push	10h
		call	PORT_Alloc_Util
		mov	ebx, eax
		xor	edi, edi
		add	esp, 4
		cmp	ebx, edi
		jnz	short loc_10009AF9
		push	ebp
		mov	edi, 2
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009AF9:				; CODE XREF: sub_10009A90+51j
		push	14h
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[ebx], eax
		cmp	eax, edi
		jnz	short loc_10009B10
		mov	edi, 2
		jmp	short loc_10009B74
; ---------------------------------------------------------------------------

loc_10009B10:				; CODE XREF: sub_10009A90+77j
		mov	[ebx+8], edi
		mov	[ebx+4], edi
		mov	dword ptr [ebx+0Ch], 5
		cmp	[esi+2Ch], edi
		jz	short loc_10009B2B
		cmp	[esi+24h], edi
		jnz	short loc_10009B2B
		xor	ebp, ebp
		jmp	short loc_10009B30
; ---------------------------------------------------------------------------

loc_10009B2B:				; CODE XREF: sub_10009A90+90j
					; sub_10009A90+95j
		mov	ebp, 1

loc_10009B30:				; CODE XREF: sub_10009A90+99j
		mov	eax, [esp+14h+arg_4]
		push	ebp
		push	eax
		mov	eax, [esp+1Ch+arg_8]
		push	ebx
		push	esi
		call	sub_100099C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10009B70
		mov	ecx, [esp+14h+arg_8]
		mov	edx, [esp+14h+arg_4]
		mov	eax, [esi+14h]
		push	ebp
		push	ecx
		mov	ecx, [esi+68h]
		push	edx
		mov	edx, [esi+64h]
		push	eax
		push	ecx
		push	edx
		push	ebx
		call	sub_100175B0
		mov	edi, eax
		add	esp, 1Ch
		test	edi, edi
		jz	short loc_10009B8E

loc_10009B70:				; CODE XREF: sub_10009A90+B8j
		mov	ebp, [esp+14h+var_4]

loc_10009B74:				; CODE XREF: sub_10009A90+7Ej
		push	ebx
		call	sub_10016370
		add	esp, 4
		push	ebp
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009B8E:				; CODE XREF: sub_10009A90+DEj
		mov	esi, [esp+14h+var_4]
		mov	eax, [esi+34h]
		test	eax, eax
		jz	short loc_10009BA9
		push	eax
		mov	dword ptr [esi+34h], 0
		call	sub_10016370
		add	esp, 4

loc_10009BA9:				; CODE XREF: sub_10009A90+107j
		push	esi
		mov	[esi+34h], ebx
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_10009A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009BC0(int,	void *Dst, int,	int)
sub_10009BC0	proc near		; CODE XREF: sub_10004030:loc_1000403Fj
					; DATA XREF: .rdata:1002601Eo

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_C]
		push	eax
		mov	dword ptr [ebp+0], 0
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10009BE8
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009BE8:				; CODE XREF: sub_10009BC0+1Ej
		push	esi
		mov	esi, [ebx+34h]
		test	esi, esi
		jnz	short loc_10009BFF
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009BFF:				; CODE XREF: sub_10009BC0+2Ej
		mov	eax, [esi+4]
		sub	eax, [esi+8]
		push	edi
		mov	edi, [esp+10h+arg_8]
		cmp	edi, eax
		jle	short loc_10009C10
		mov	edi, eax

loc_10009C10:				; CODE XREF: sub_10009BC0+4Cj
		test	edi, edi
		jle	short loc_10009C34
		mov	edx, [esi+8]
		mov	eax, [esi]
		lea	ecx, ds:0[edi*4]
		push	ecx		; Size
		lea	ecx, [eax+edx*4]
		mov	edx, [esp+14h+Dst]
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		jmp	short loc_10009C3E
; ---------------------------------------------------------------------------

loc_10009C34:				; CODE XREF: sub_10009BC0+52j
		mov	eax, [esp+10h+Dst]
		mov	dword ptr [eax], 0

loc_10009C3E:				; CODE XREF: sub_10009BC0+72j
		add	[esi+8], edi
		mov	eax, [esi+8]
		cmp	eax, [esi+4]
		jnz	short loc_10009C59
		push	esi
		mov	dword ptr [ebx+34h], 0
		call	sub_10016370
		add	esp, 4

loc_10009C59:				; CODE XREF: sub_10009BC0+87j
		push	ebx
		mov	[ebp+0], edi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10009BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009C70	proc near		; CODE XREF: sub_10004A70:loc_10004A7Fj
					; DATA XREF: .rdata:10026022o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_10009C87
		mov	eax, 0B3h
		retn
; ---------------------------------------------------------------------------

loc_10009C87:				; CODE XREF: sub_10009C70+Fj
		push	esi
		mov	esi, [eax+34h]
		push	eax
		mov	dword ptr [eax+34h], 0
		call	sub_100177F0
		add	esp, 4
		test	esi, esi
		jz	short loc_10009CA8
		push	esi
		call	sub_10016370
		add	esp, 4

loc_10009CA8:				; CODE XREF: sub_10009C70+2Dj
		xor	eax, eax
		pop	esi
		retn
sub_10009C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009CB0	proc near		; CODE XREF: sub_10004BA0j
					; DATA XREF: .rdata:100260BEo
		mov	eax, 54h
		retn
sub_10009CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009CC0	proc near		; CODE XREF: sub_1000AB70+203p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, eax
		push	esi
		call	sub_1001EE90
		add	esp, 4
		test	eax, eax
		jnz	short loc_10009D0A
		mov	[esp+8+var_4], eax
		lea	eax, [esp+8+var_4]
		push	eax
		push	offset word_10026FE6
		push	esi
		call	sub_1001EF70
		add	esp, 0Ch
		cmp	[esp+8+var_4], 0
		mov	esi, eax
		jz	short loc_10009D00
		mov	ecx, [esp+8+arg_0]
		push	0
		push	ecx
		call	sub_10008020
		add	esp, 8

loc_10009D00:				; CODE XREF: sub_10009CC0+2Fj
		xor	eax, eax
		test	esi, esi
		setz	al
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10009D0A:				; CODE XREF: sub_10009CC0+Fj
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_10009CC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009D10	proc near		; CODE XREF: sub_1000A7C0+123p

var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	edi, eax
		xor	ebx, ebx
		mov	esi, ecx
		mov	[esp+18h+var_9], 1
		mov	[esp+18h+var_8], 1
		mov	[esp+18h+var_7], 1
		mov	[esp+18h+var_5], bl
		mov	[esp+18h+var_6], 1
		cmp	edi, 3		; switch 4 cases
		ja	loc_10009FE9	; jumptable 10009D3D default case
		jmp	ds:off_10009FF8[edi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10009D44:				; CODE XREF: sub_10009D10+2Dj
					; DATA XREF: .text:off_10009FF8o
		push	ebx		; jumptable 10009D3D case 0
		push	ebx
		push	80h
		push	120h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	ebx
		push	ebx
		push	2
		push	122h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jz	loc_10009EA9
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009D82:				; CODE XREF: sub_10009D10+2Dj
					; DATA XREF: .text:off_10009FF8o
		push	ebx		; jumptable 10009D3D case 1
		push	100h
		push	0A0h
		push	131h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	40h
		push	0C00h
		push	200h
		push	130h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	ebx
		push	0C00h
		push	2
		push	132h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	ebx
		push	0C00h
		push	2
		push	11h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		jmp	loc_10009E9D
; ---------------------------------------------------------------------------

loc_10009E03:				; CODE XREF: sub_10009D10+2Dj
					; DATA XREF: .text:off_10009FF8o
		push	ebx		; jumptable 10009D3D case 2
		push	4000h
		push	80h
		push	130h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	ebx
		push	4000h
		push	2
		push	132h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	ebx
		push	4000h
		push	2
		push	11h
		push	esi
		call	sub_100166F0
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10009FEE
		mov	[esp+18h+var_6], bl
		jmp	short loc_10009E98
; ---------------------------------------------------------------------------

loc_10009E63:				; CODE XREF: sub_10009D10+2Dj
					; DATA XREF: .text:off_10009FF8o
		push	180h		; jumptable 10009D3D case 3
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10009E81

loc_10009E75:				; CODE XREF: sub_10009D10+181j
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009E81:				; CODE XREF: sub_10009D10+163j
		push	181h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10009E75
		mov	[esp+18h+var_6], 1

loc_10009E98:				; CODE XREF: sub_10009D10+151j
		mov	[esp+18h+var_5], 1

loc_10009E9D:				; CODE XREF: sub_10009D10+EEj
		mov	[esp+18h+var_9], bl
		mov	[esp+18h+var_8], bl
		mov	[esp+18h+var_7], bl

loc_10009EA9:				; CODE XREF: sub_10009D10+65j
		push	101h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10009ED3
		push	ebx
		push	ebx
		push	101h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_10009FEE

loc_10009ED3:				; CODE XREF: sub_10009D10+1A9j
		push	1
		lea	eax, [esp+1Ch+var_9]
		push	eax
		push	104h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	1
		lea	ecx, [esp+1Ch+var_6]
		push	ecx
		push	10Ah
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	1
		lea	edx, [esp+1Ch+var_8]
		push	edx
		push	10Bh
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	1
		lea	eax, [esp+1Ch+var_7]
		push	eax
		push	106h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_10009FEE
		push	1
		lea	ecx, [esp+1Ch+var_5]
		push	ecx
		push	10Ch
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		mov	[esp+18h+var_4], eax
		cmp	eax, ebx
		jnz	loc_10009FEE
		lea	edx, [esp+18h+var_4]
		push	edx
		push	edi
		push	esi
		call	sub_100072C0
		add	esp, 0Ch
		mov	[esi+1Ch], eax
		cmp	eax, ebx
		jnz	short loc_10009F89
		mov	eax, [esp+18h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009F89:				; CODE XREF: sub_10009D10+26Cj
		push	1
		push	esi
		mov	dword ptr [esi+20h], offset sub_10005180
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10009FE0
		mov	eax, [esp+18h+arg_0]
		mov	eax, [eax+30h]
		push	eax
		call	sub_1001CDC0
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_10009FC1
		pop	edi
		pop	esi
		mov	eax, 0E2h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009FC1:				; CODE XREF: sub_10009D10+2A3j
		lea	ecx, [esi+0Ch]
		push	ecx
		push	esi
		push	edi
		call	sub_1001B8C0
		push	edi
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009FE0:				; CODE XREF: sub_10009D10+28Dj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10009FE9:				; CODE XREF: sub_10009D10+27j
		mov	eax, 13h	; jumptable 10009D3D default case

loc_10009FEE:				; CODE XREF: sub_10009D10+4Bj
					; sub_10009D10+8Dj ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
sub_10009D10	endp

; ---------------------------------------------------------------------------
		align 4
off_10009FF8	dd offset loc_10009D44	; DATA XREF: sub_10009D10+2Dr
		dd offset loc_10009D82	; jump table for switch	statement
		dd offset loc_10009E03
		dd offset loc_10009E63
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A010	proc near		; CODE XREF: sub_1000A7C0+113p

var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
Src		= dword	ptr -8
Size		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, eax
		mov	eax, [esp+28h+arg_4]
		push	edi
		xor	ebx, ebx
		xor	edi, edi
		xor	ebp, ebp
		mov	[esp+2Ch+var_16], 1
		mov	[esp+2Ch+var_1A], 1
		mov	[esp+2Ch+var_1B], 0
		mov	[esp+2Ch+var_19], 1
		mov	[esp+2Ch+var_18], 1
		mov	[esp+2Ch+var_17], 1
		mov	[esp+2Ch+var_15], 0
		mov	[esp+2Ch+var_14], 1
		mov	[esp+2Ch+var_10], ebx
		cmp	eax, 3
		ja	loc_1000A24E
		jz	loc_1000A21E
		sub	eax, ebx
		jz	short loc_1000A0D5
		dec	eax
		jz	short loc_1000A076
		dec	eax
		jz	short loc_1000A091
		pop	edi
		pop	esi
		pop	ebp
		lea	eax, [ebx+13h]
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A076:				; CODE XREF: sub_1000A010+56j
		push	131h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A0C8
		mov	[esp+2Ch+var_1B], 1
		mov	[esp+2Ch+var_17], bl

loc_1000A091:				; CODE XREF: sub_1000A010+59j
		push	130h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A0C8
		push	132h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A0C8
		push	11h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	loc_1000A2B8

loc_1000A0C8:				; CODE XREF: sub_1000A010+76j
					; sub_1000A010+91j ...
		mov	eax, 0D0h

loc_1000A0CD:				; CODE XREF: sub_1000A010+1C0j
					; sub_1000A010+2D8j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A0D5:				; CODE XREF: sub_1000A010+53j
		push	120h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A0EA
		lea	edi, [eax+1]

loc_1000A0EA:				; CODE XREF: sub_1000A010+D5j
		push	122h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A0FF
		lea	ebp, [eax+1]

loc_1000A0FF:				; CODE XREF: sub_1000A010+EAj
		push	123h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A112
		inc	ebp

loc_1000A112:				; CODE XREF: sub_1000A010+FFj
		push	124h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A125
		inc	edi

loc_1000A125:				; CODE XREF: sub_1000A010+112j
		push	125h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A138
		inc	edi

loc_1000A138:				; CODE XREF: sub_1000A010+125j
		push	126h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A14D
		lea	ebx, [eax+1]

loc_1000A14D:				; CODE XREF: sub_1000A010+138j
		push	127h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A160
		inc	ebx

loc_1000A160:				; CODE XREF: sub_1000A010+14Dj
		push	128h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A173
		inc	ebx

loc_1000A173:				; CODE XREF: sub_1000A010+160j
		test	edi, edi
		jnz	short loc_1000A17F
		test	ebp, ebp
		jnz	short loc_1000A17F
		test	ebx, ebx
		jz	short loc_1000A1A5

loc_1000A17F:				; CODE XREF: sub_1000A010+165j
					; sub_1000A010+169j
		mov	eax, 2
		sub	eax, ebp
		jz	loc_1000A0C8
		mov	ecx, 5
		sub	ecx, ebp
		sub	ecx, edi
		cmp	ecx, 3
		jl	loc_1000A0C8
		mov	eax, 1
		jmp	short loc_1000A1A9
; ---------------------------------------------------------------------------

loc_1000A1A5:				; CODE XREF: sub_1000A010+16Dj
		mov	eax, [esp+2Ch+var_10]

loc_1000A1A9:				; CODE XREF: sub_1000A010+193j
		push	eax
		call	sub_10007890
		add	esp, 4
		test	eax, eax
		jnz	loc_1000A0C8
		push	120h
		push	esi
		lea	edx, [esp+34h+var_C]
		push	edx
		push	eax
		call	sub_100168D0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		mov	eax, [esp+2Ch+Size]
		mov	ecx, [esp+2Ch+Src]
		push	eax		; Size
		push	ecx		; Src
		push	0D5A0DB00h	; int
		push	esi		; int
		call	sub_10017BD0
		mov	edi, eax
		mov	eax, [esp+3Ch+Src]
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000A201
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000A201:				; CODE XREF: sub_1000A010+1E6j
		test	edi, edi
		jz	short loc_1000A20F
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A20F:				; CODE XREF: sub_1000A010+1F3j
		mov	[esp+2Ch+var_1B], 1
		mov	[esp+2Ch+var_17], 0
		jmp	loc_1000A2C4
; ---------------------------------------------------------------------------

loc_1000A21E:				; CODE XREF: sub_1000A010+4Bj
		push	180h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	loc_1000A0C8
		push	11h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	loc_1000A0C8
		mov	[esp+2Ch+var_1B], 1
		jmp	short loc_1000A2B8
; ---------------------------------------------------------------------------

loc_1000A24E:				; CODE XREF: sub_1000A010+45j
		cmp	eax, 0CE534352h
		jz	short loc_1000A269
		cmp	eax, 0CE534353h
		jz	short loc_1000A2AB
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 13h
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A269:				; CODE XREF: sub_1000A010+243j
		push	130h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	loc_1000A0C8
		push	131h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	loc_1000A0C8
		push	132h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	loc_1000A0C8

loc_1000A2AB:				; CODE XREF: sub_1000A010+24Aj
		mov	[esp+2Ch+var_1B], bl
		mov	[esp+2Ch+var_17], 1
		mov	[esp+2Ch+var_14], ebx

loc_1000A2B8:				; CODE XREF: sub_1000A010+B2j
					; sub_1000A010+23Cj
		mov	[esp+2Ch+var_18], bl
		mov	[esp+2Ch+var_19], bl
		mov	[esp+2Ch+var_1A], bl

loc_1000A2C4:				; CODE XREF: sub_1000A010+209j
		push	101h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A2EE
		push	eax
		push	eax
		push	101h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD

loc_1000A2EE:				; CODE XREF: sub_1000A010+2C4j
		push	103h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A31D
		push	1
		lea	edx, [esp+30h+var_16]
		push	edx
		push	103h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD

loc_1000A31D:				; CODE XREF: sub_1000A010+2EEj
		push	1
		lea	eax, [esp+30h+var_16]
		push	eax
		push	162h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		lea	ecx, [esp+30h+var_1A]
		push	ecx
		push	105h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		lea	edx, [esp+30h+var_1B]
		push	edx
		push	108h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		lea	eax, [esp+30h+var_19]
		push	eax
		push	109h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		lea	ecx, [esp+30h+var_18]
		push	ecx
		push	107h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		lea	edx, [esp+30h+var_17]
		push	edx
		push	10Ch
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1		; Size
		lea	eax, [esp+30h+var_15]
		push	eax		; Src
		push	165h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A0CD
		push	1		; Size
		lea	ecx, [esp+30h+var_15]
		push	ecx		; Src
		push	164h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+2Ch+var_10], eax
		test	eax, eax
		jnz	loc_1000A0CD
		push	1
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A45B
		mov	edx, [esp+2Ch+arg_0]
		mov	eax, [edx+30h]
		push	eax
		call	sub_1001CE00
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000A43B
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0E2h
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A43B:				; CODE XREF: sub_1000A010+41Cj
		lea	eax, [esi+0Ch]
		push	eax
		push	esi
		push	edi
		call	sub_1001B8C0
		push	edi
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 10h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A45B:				; CODE XREF: sub_1000A010+406j
		cmp	[esp+2Ch+var_14], 0
		jz	short loc_1000A48E
		mov	ecx, [esp+2Ch+arg_4]
		push	ecx
		push	esi
		lea	ecx, [esp+34h+var_10]
		call	sub_100075B0
		add	esp, 8
		mov	[esi+1Ch], eax
		test	eax, eax
		jnz	short loc_1000A487
		mov	eax, [esp+2Ch+var_10]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A487:				; CODE XREF: sub_1000A010+469j
		mov	dword ptr [esi+20h], offset sub_10005160

loc_1000A48E:				; CODE XREF: sub_1000A010+450j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
sub_1000A010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A4A0	proc near		; CODE XREF: sub_1000A750+8p

var_2		= byte ptr -2
Src		= byte ptr -1
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		xor	ebx, ebx
		push	edi
		mov	esi, eax
		mov	[esp+14h+var_2], 1
		mov	[esp+14h+Src], bl
		lea	edi, [esp+14h+var_2]
		cmp	[esp+14h+arg_4], ebx
		jnz	short loc_1000A4C4
		lea	edi, [esp+14h+Src]

loc_1000A4C4:				; CODE XREF: sub_1000A4A0+1Ej
		push	103h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A4EF
		push	1
		push	edi
		push	103h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727

loc_1000A4EF:				; CODE XREF: sub_1000A4A0+34j
		push	162h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A51E
		push	1
		lea	eax, [esp+18h+var_2]
		push	eax
		push	162h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727

loc_1000A51E:				; CODE XREF: sub_1000A4A0+5Fj
		push	104h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A54D
		push	1
		lea	ecx, [esp+18h+var_2]
		push	ecx
		push	104h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727

loc_1000A54D:				; CODE XREF: sub_1000A4A0+8Ej
		push	105h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A57C
		push	1
		lea	edx, [esp+18h+var_2]
		push	edx
		push	105h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727

loc_1000A57C:				; CODE XREF: sub_1000A4A0+BDj
		push	1
		lea	eax, [esp+18h+Src]
		push	eax
		push	108h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		push	1
		lea	ecx, [esp+18h+Src]
		push	ecx
		push	10Ah
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		push	1
		lea	edx, [esp+18h+var_2]
		push	edx
		push	106h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		push	1
		lea	eax, [esp+18h+var_2]
		push	eax
		push	107h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		push	11h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A60A

loc_1000A5FF:				; CODE XREF: sub_1000A4A0+1CDj
					; sub_1000A4A0+1E9j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0D0h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A60A:				; CODE XREF: sub_1000A4A0+15Dj
		push	1		; Size
		lea	ecx, [esp+18h+Src]
		push	ecx		; Src
		push	165h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		push	1		; Size
		lea	edx, [esp+18h+Src]
		push	edx		; Src
		push	164h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000A727
		lea	eax, [ebp-10h]	; switch 16 cases
		cmp	eax, 0Fh
		ja	loc_1000A725	; jumptable 1000A657 default case
		movzx	eax, ds:byte_1000A740[eax]
		jmp	ds:off_1000A730[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000A65E:				; CODE XREF: sub_1000A4A0+1B7j
					; DATA XREF: .text:off_1000A730o
		push	11h		; jumptable 1000A657 cases 16-18
		push	esi
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebx
		jz	short loc_1000A5FF
		push	4
		lea	ecx, [edi+1Ch]
		push	ecx
		jmp	loc_1000A70F
; ---------------------------------------------------------------------------

loc_1000A67A:				; CODE XREF: sub_1000A4A0+1B7j
					; DATA XREF: .text:off_1000A730o
		push	11h		; jumptable 1000A657 cases 19-21,30
		push	esi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jz	loc_1000A5FF
		push	ebp
		call	sub_10010BE0
		mov	ecx, [esi+1Ch]
		add	esp, 4
		cmp	ecx, eax
		jz	short loc_1000A6B3
		push	esi
		call	sub_10015D70
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 62h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A6B3:				; CODE XREF: sub_1000A4A0+1FDj
		mov	edx, [esi+18h]
		push	ecx
		push	edx
		call	sub_10007C70
		push	esi
		call	sub_10015D70
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A6CE:				; CODE XREF: sub_1000A4A0+1B7j
					; DATA XREF: .text:off_1000A730o
		push	11h		; jumptable 1000A657 case 31
		push	esi
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebx
		jz	loc_1000A5FF
		mov	ecx, [edi+1Ch]
		lea	eax, [edi+1Ch]
		cmp	ecx, 10h
		jz	short loc_1000A70C
		cmp	ecx, 18h
		jz	short loc_1000A70C
		cmp	ecx, 20h
		jz	short loc_1000A70C
		push	edi
		call	sub_10015D70
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 62h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A70C:				; CODE XREF: sub_1000A4A0+24Cj
					; sub_1000A4A0+251j ...
		push	4		; Size
		push	eax		; Src

loc_1000A70F:				; CODE XREF: sub_1000A4A0+1D5j
		push	161h		; int
		push	esi		; int
		call	sub_10017BD0
		push	edi
		mov	ebx, eax
		call	sub_10015D70
		add	esp, 14h

loc_1000A725:				; CODE XREF: sub_1000A4A0+1AAj
					; sub_1000A4A0+1B7j
					; DATA XREF: ...
		mov	eax, ebx	; jumptable 1000A657 default case

loc_1000A727:				; CODE XREF: sub_1000A4A0+49j
					; sub_1000A4A0+78j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1000A4A0	endp

; ---------------------------------------------------------------------------
		align 10h
off_1000A730	dd offset loc_1000A65E	; DATA XREF: sub_1000A4A0+1B7r
		dd offset loc_1000A67A	; jump table for switch	statement
		dd offset loc_1000A6CE
		dd offset loc_1000A725
byte_1000A740	db	0,     0,     0,     1 ; DATA XREF: sub_1000A4A0+1B0r
		db	1,     1,     3,     3 ; indirect table	for switch statement
		db	3,     3,     3,     3
		db	3,     3,     1,     2

; =============== S U B	R O U T	I N E =======================================


sub_1000A750	proc near		; CODE XREF: sub_1000A7C0+104p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	eax
		mov	edi, edx
		push	ecx
		mov	eax, edi
		call	sub_1000A4A0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000A7AE
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A7AE
		mov	edx, [esp+8+arg_0]
		mov	eax, [edx+30h]
		push	eax
		call	sub_1001CE00
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000A793
		pop	edi
		mov	eax, 0E2h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A793:				; CODE XREF: sub_1000A750+39j
		lea	eax, [edi+0Ch]
		push	eax
		push	edi
		push	esi
		call	sub_1001B8C0
		push	esi
		mov	edi, eax
		call	sub_1001CD90
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A7AE:				; CODE XREF: sub_1000A750+14j
					; sub_1000A750+23j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_1000A750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A7C0	proc near		; CODE XREF: sub_1000A8F0+1C8p

var_1		= byte ptr -1

		push	ecx
		push	100h
		push	esi
		mov	[esp+0Ch+var_1], 0
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A7DF
		mov	eax, 0D0h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A7DF:				; CODE XREF: sub_1000A7C0+16j
		push	102h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A809
		push	eax
		push	eax
		push	102h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A8EC

loc_1000A809:				; CODE XREF: sub_1000A7C0+2Fj
		push	110h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A833
		push	eax
		push	eax
		push	110h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A8EC

loc_1000A833:				; CODE XREF: sub_1000A7C0+59j
		push	111h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A85D
		push	eax
		push	eax
		push	111h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000A8EC

loc_1000A85D:				; CODE XREF: sub_1000A7C0+83j
		push	1
		lea	eax, [esp+8+var_1]
		push	eax
		push	163h
		push	esi
		call	sub_10006CB0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000A8EC
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A88F
		mov	eax, 13h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A88F:				; CODE XREF: sub_1000A7C0+C6j
		mov	ecx, [eax+18h]
		push	edi
		mov	edi, [ecx]
		push	eax
		call	sub_10015D70
		mov	eax, [esi+8]
		add	esp, 4
		sub	eax, 2
		jz	short loc_1000A8DE
		dec	eax
		jz	short loc_1000A8CF
		dec	eax
		jz	short loc_1000A8B4
		mov	eax, 13h
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A8B4:				; CODE XREF: sub_1000A7C0+EAj
		mov	edx, [ebx+30h]
		xor	eax, eax
		cmp	dword ptr [edx], 3
		push	ebx
		setz	al
		mov	ecx, edi
		mov	edx, esi
		call	sub_1000A750
		add	esp, 4
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A8CF:				; CODE XREF: sub_1000A7C0+E7j
		push	edi
		push	ebx
		mov	eax, esi
		call	sub_1000A010
		add	esp, 8
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A8DE:				; CODE XREF: sub_1000A7C0+E4j
		push	ebx
		mov	eax, edi
		mov	ecx, esi
		call	sub_10009D10
		add	esp, 4
		pop	edi

loc_1000A8EC:				; CODE XREF: sub_1000A7C0+43j
					; sub_1000A7C0+6Dj ...
		pop	ecx
		retn
sub_1000A7C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A8F0	proc near		; CODE XREF: sub_1000B800+E5p
					; sub_1000B920+188p ...

var_2		= byte ptr -2
var_1		= byte ptr -1
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	ebp, [edi+30h]
		push	1
		push	esi
		mov	[esp+18h+var_2], 0
		mov	[esp+18h+var_1], 1
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A932
		push	1
		lea	eax, [esp+14h+var_2]
		push	eax
		push	1
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000AB4A

loc_1000A932:				; CODE XREF: sub_1000A8F0+26j
		push	2
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A95B
		push	1
		lea	ecx, [esp+14h+var_2]
		push	ecx
		push	2
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000AB4A

loc_1000A95B:				; CODE XREF: sub_1000A8F0+4Fj
		push	3
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A97F
		push	eax
		push	eax
		push	3
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000AB4A

loc_1000A97F:				; CODE XREF: sub_1000A8F0+78j
		push	170h
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000A9AE
		push	1
		lea	edx, [esp+14h+var_1]
		push	edx
		push	170h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000AB4A

loc_1000A9AE:				; CODE XREF: sub_1000A8F0+9Fj
		cmp	dword ptr [ebp+24h], 0
		jnz	short loc_1000A9D3
		cmp	dword ptr [ebp+2Ch], 0
		jz	short loc_1000A9D3
		push	2
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A9D3
		pop	edi
		pop	esi
		mov	eax, 101h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A9D3:				; CODE XREF: sub_1000A8F0+C2j
					; sub_1000A8F0+C8j ...
		test	byte ptr [edi+20h], 2
		jnz	short loc_1000A9F2
		push	1
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A9F2
		pop	edi
		pop	esi
		mov	eax, 0B5h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A9F2:				; CODE XREF: sub_1000A8F0+E7j
					; sub_1000A8F0+F6j
		push	ebx

loc_1000A9F3:				; CODE XREF: sub_1000A8F0+16Aj
		mov	eax, [ebp+14h]
		push	eax
		xor	edi, edi
		call	ds:PR_Lock
		mov	eax, [ebp+58h]
		mov	ecx, eax
		add	esp, 4
		and	ecx, 80000000h
		and	eax, 7FFFFFFFh
		mov	ebx, eax
		jnz	short loc_1000AA1C
		mov	ebx, dword_10029120

loc_1000AA1C:				; CODE XREF: sub_1000A8F0+124j
		lea	edx, [ebx+1]
		or	edx, ecx
		mov	[ebp+58h], edx
		test	ecx, ecx
		jz	short loc_1000AA4B
		mov	eax, [ebp+68h]
		mov	edx, [ebp+64h]
		mov	ecx, ebx
		imul	ecx, 6AC690C5h
		dec	eax
		and	eax, ecx
		mov	edi, [edx+eax*4]
		test	edi, edi
		jz	short loc_1000AA4B

loc_1000AA40:				; CODE XREF: sub_1000A8F0+159j
		cmp	[edi+0Ch], ebx
		jz	short loc_1000AA4B
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_1000AA40

loc_1000AA4B:				; CODE XREF: sub_1000A8F0+136j
					; sub_1000A8F0+14Ej ...
		mov	eax, [ebp+14h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000A9F3
		push	edi
		push	esi
		mov	[esi+0Ch], ebx
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000AA78
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AA78:				; CODE XREF: sub_1000A8F0+17Bj
		mov	ecx, [eax+18h]
		mov	edx, [ecx]
		push	eax
		mov	[esi+8], edx
		call	sub_10015D70
		mov	eax, [esi+8]
		add	esp, 4
		cmp	eax, 6
		ja	short loc_1000AAC6
		jz	short loc_1000AABF
		cmp	eax, 4		; switch 5 cases
		ja	short loc_1000AADB ; jumptable 1000AA98	default	case
		jmp	ds:off_1000AB50[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000AA9F:				; CODE XREF: sub_1000A8F0+1A8j
					; DATA XREF: .text:off_1000AB50o
		call	sub_10006CF0	; jumptable 1000AA98 case 0
		jmp	short loc_1000AB11
; ---------------------------------------------------------------------------

loc_1000AAA6:				; CODE XREF: sub_1000A8F0+1A8j
					; DATA XREF: .text:off_1000AB50o
		mov	eax, [esp+14h+arg_4] ; jumptable 1000AA98 case 1
		push	eax
		mov	eax, esi
		call	sub_10006D60
		jmp	short loc_1000AB0E
; ---------------------------------------------------------------------------

loc_1000AAB4:				; CODE XREF: sub_1000A8F0+1A8j
					; DATA XREF: .text:off_1000AB50o
		mov	ebx, [esp+14h+arg_4] ; jumptable 1000AA98 cases	2-4
		call	sub_1000A7C0
		jmp	short loc_1000AB11
; ---------------------------------------------------------------------------

loc_1000AABF:				; CODE XREF: sub_1000A8F0+1A1j
		call	sub_10007230
		jmp	short loc_1000AB11
; ---------------------------------------------------------------------------

loc_1000AAC6:				; CODE XREF: sub_1000A8F0+19Fj
		cmp	eax, 0CE534351h
		jz	short loc_1000AB02
		cmp	eax, 0CE534352h
		jz	short loc_1000AAF4
		cmp	eax, 0CE534353h
		jz	short loc_1000AAE6

loc_1000AADB:				; CODE XREF: sub_1000A8F0+1A6j
		pop	ebx		; jumptable 1000AA98 default case
		pop	edi
		pop	esi
		mov	eax, 13h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AAE6:				; CODE XREF: sub_1000A8F0+1E9j
		mov	ecx, [esp+14h+arg_4]
		push	ecx
		mov	eax, esi
		call	sub_10006E80
		jmp	short loc_1000AB0E
; ---------------------------------------------------------------------------

loc_1000AAF4:				; CODE XREF: sub_1000A8F0+1E2j
		mov	edx, [esp+14h+arg_4]
		push	edx
		mov	eax, esi
		call	sub_10006F40
		jmp	short loc_1000AB0E
; ---------------------------------------------------------------------------

loc_1000AB02:				; CODE XREF: sub_1000A8F0+1DBj
		mov	eax, [esp+14h+arg_4]
		push	eax
		mov	eax, esi
		call	sub_10006FE0

loc_1000AB0E:				; CODE XREF: sub_1000A8F0+1C2j
					; sub_1000A8F0+202j ...
		add	esp, 4

loc_1000AB11:				; CODE XREF: sub_1000A8F0+1B4j
					; sub_1000A8F0+1CDj ...
		test	eax, eax
		jnz	short loc_1000AB49
		mov	ecx, [esi+0Ch]
		and	ecx, 80000000h
		push	esi
		cmp	ecx, 80000000h
		jnz	short loc_1000AB37
		call	sub_10017940
		add	esp, 4
		pop	ebx
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AB37:				; CODE XREF: sub_1000A8F0+235j
		mov	edx, [esp+18h+arg_4]
		push	edx
		mov	[esi+18h], ebp
		call	sub_10016D80
		add	esp, 8
		xor	eax, eax

loc_1000AB49:				; CODE XREF: sub_1000A8F0+223j
		pop	ebx

loc_1000AB4A:				; CODE XREF: sub_1000A8F0+3Cj
					; sub_1000A8F0+65j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_1000A8F0	endp

; ---------------------------------------------------------------------------
		align 10h
off_1000AB50	dd offset loc_1000AA9F	; DATA XREF: sub_1000A8F0+1A8r
		dd offset loc_1000AAA6	; jump table for switch	statement
		dd offset loc_1000AAB4
		dd offset loc_1000AAB4
		dd offset loc_1000AAB4
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000AB70	proc near		; CODE XREF: sub_1000ADD0+1AFp
					; sub_1000B680+149p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		xor	eax, eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_10]
		xor	ecx, ecx
		cmp	[esi+38h], eax
		push	edi
		mov	edi, [esp+14h+arg_0]
		setz	cl
		mov	[edi+20h], eax
		mov	[edi+4Ch], eax
		mov	[edi+50h], eax
		mov	[edi+54h], eax
		mov	[edi+2Ch], eax
		mov	[edi+24h], eax
		mov	[edi+28h], eax
		mov	[edi+30h], eax
		mov	[edi+3Ch], eax
		mov	[edi+40h], eax
		mov	[edi+44h], eax
		mov	edx, [esi+30h]
		mov	[edi+34h], edx
		mov	ebp, [esi+20h]
		mov	[esp+14h+var_4], ecx
		cmp	ebp, eax
		jnz	short loc_1000ABF4
		mov	ecx, [edi]
		mov	eax, ecx
		dec	eax
		jz	short loc_1000ABEF
		dec	eax
		jz	short loc_1000ABE8
		dec	eax
		jz	short loc_1000ABE1
		push	ecx
		push	offset aNssApplicati_0 ; "NSS Application Token	%08x  "
		push	offset byte_10029618 ; Dest
		call	ds:sprintf
		add	esp, 0Ch
		mov	ebp, offset byte_10029618
		jmp	short loc_1000ABF4
; ---------------------------------------------------------------------------

loc_1000ABE1:				; CODE XREF: sub_1000AB70+54j
		mov	ebp, offset aNssFips1402Cer ; "NSS FIPS	140-2 Certificate DB   "
		jmp	short loc_1000ABF4
; ---------------------------------------------------------------------------

loc_1000ABE8:				; CODE XREF: sub_1000AB70+51j
		mov	ebp, offset aNssCertificate ; "NSS Certificate DB	       "
		jmp	short loc_1000ABF4
; ---------------------------------------------------------------------------

loc_1000ABEF:				; CODE XREF: sub_1000AB70+4Ej
		mov	ebp, offset aNssGenericCryp ; "NSS Generic Crypto Services     "

loc_1000ABF4:				; CODE XREF: sub_1000AB70+47j
					; sub_1000AB70+6Fj ...
		mov	eax, ebp
		lea	edx, [edi+74h]
		lea	ebx, [eax+1]
		lea	esp, [esp+0]

loc_1000AC00:				; CODE XREF: sub_1000AB70+95j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000AC00
		sub	eax, ebx
		cmp	eax, 20h
		jle	short loc_1000AC2F
		mov	edi, edi

loc_1000AC10:				; CODE XREF: sub_1000AB70+BDj
		test	eax, eax
		jle	short loc_1000AC27

loc_1000AC14:				; CODE XREF: sub_1000AB70+B3j
		mov	cl, [eax+ebp-1]
		and	cl, 0C0h
		cmp	cl, 80h
		jnz	short loc_1000AC25
		dec	eax
		test	eax, eax
		jg	short loc_1000AC14

loc_1000AC25:				; CODE XREF: sub_1000AB70+AEj
		test	eax, eax

loc_1000AC27:				; CODE XREF: sub_1000AB70+A2j
		jz	short loc_1000AC2A
		dec	eax

loc_1000AC2A:				; CODE XREF: sub_1000AB70:loc_1000AC27j
		cmp	eax, 20h
		jg	short loc_1000AC10

loc_1000AC2F:				; CODE XREF: sub_1000AB70+9Cj
		mov	ecx, 20202020h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		push	eax		; Size
		mov	[edx+14h], ecx
		mov	[edx+18h], ecx
		push	ebp		; Src
		mov	[edx+1Ch], ecx
		push	edx		; Dst
		mov	byte ptr [edx+20h], 0
		call	memcpy
		mov	eax, [esi+28h]
		add	esp, 0Ch
		mov	ebp, eax
		test	eax, eax
		jnz	short loc_1000AC68
		mov	ebp, offset asc_10026FE4 ; " "

loc_1000AC68:				; CODE XREF: sub_1000AB70+F1j
		mov	ecx, ebp
		lea	edx, [edi+95h]
		lea	ebx, [ecx+1]

loc_1000AC73:				; CODE XREF: sub_1000AB70+108j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1000AC73
		sub	ecx, ebx
		cmp	ecx, 20h
		jle	short loc_1000AC9E

loc_1000AC81:				; CODE XREF: sub_1000AB70+12Cj
		test	ecx, ecx
		jle	short loc_1000AC96

loc_1000AC85:				; CODE XREF: sub_1000AB70+122j
		mov	al, [ecx+ebp-1]
		and	al, 0C0h
		cmp	al, 80h
		jnz	short loc_1000AC94
		dec	ecx
		test	ecx, ecx
		jg	short loc_1000AC85

loc_1000AC94:				; CODE XREF: sub_1000AB70+11Dj
		test	ecx, ecx

loc_1000AC96:				; CODE XREF: sub_1000AB70+113j
		jz	short loc_1000AC99
		dec	ecx

loc_1000AC99:				; CODE XREF: sub_1000AB70:loc_1000AC96j
		cmp	ecx, 20h
		jg	short loc_1000AC81

loc_1000AC9E:				; CODE XREF: sub_1000AB70+10Fj
		mov	eax, 20202020h
		mov	[edx], eax
		mov	[edx+4], eax
		mov	[edx+8], eax
		mov	[edx+0Ch], eax
		mov	[edx+10h], eax
		push	ecx		; Size
		mov	[edx+14h], eax
		mov	[edx+18h], eax
		push	ebp		; Src
		mov	[edx+1Ch], eax
		push	edx		; Dst
		mov	byte ptr [edx+20h], 0
		call	memcpy
		mov	eax, [esi+34h]
		xor	ebx, ebx
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_1000ACDB
		cmp	[esi+38h], ebx
		jnz	loc_1000AD68

loc_1000ACDB:				; CODE XREF: sub_1000AB70+160j
		mov	ecx, [esi+1Ch]
		mov	[esp+14h+arg_10], ebx
		mov	[esp+14h+arg_0], ebx
		mov	edx, ecx
		cmp	ecx, ebx
		jnz	short loc_1000ACF0
		mov	edx, [esp+14h+arg_C]

loc_1000ACF0:				; CODE XREF: sub_1000AB70+17Aj
		mov	ebp, [esi+10h]
		cmp	ebp, ebx
		jnz	short loc_1000ACFB
		mov	ebp, [esp+14h+arg_8]

loc_1000ACFB:				; CODE XREF: sub_1000AB70+185j
		mov	ecx, [esi+4]
		cmp	ecx, ebx
		jnz	short loc_1000AD06
		mov	ecx, [esp+14h+arg_4]

loc_1000AD06:				; CODE XREF: sub_1000AB70+190j
		lea	ebx, [esp+14h+arg_0]
		push	ebx
		lea	ebx, [esp+18h+arg_10]
		push	ebx
		xor	ebx, ebx
		cmp	[esp+1Ch+arg_14], 1
		setz	bl
		push	ebx
		mov	ebx, [esi+3Ch]
		push	ebx
		mov	ebx, [esi+38h]
		push	ebx
		push	eax
		mov	eax, [esi+30h]
		push	eax
		mov	eax, [esi+14h]
		push	edx
		mov	edx, [esi+18h]
		push	edx
		mov	edx, [esi+0Ch]
		push	eax
		mov	eax, [esi+8]
		push	ebp
		push	edx
		push	eax
		push	ecx
		call	sub_1001CFB0
		mov	ebp, eax
		add	esp, 38h
		test	ebp, ebp
		jz	short loc_1000AD5A
		push	edi
		call	sub_10008120
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AD5A:				; CODE XREF: sub_1000AB70+1D7j
		mov	ecx, [esp+14h+arg_10]
		mov	edx, [esp+14h+arg_0]
		mov	[edi+3Ch], ecx
		mov	[edi+40h], edx

loc_1000AD68:				; CODE XREF: sub_1000AB70+165j
		cmp	[esp+14h+var_4], 0
		jz	short loc_1000ADBB
		mov	eax, [edi+40h]
		push	edi
		call	sub_10009CC0
		add	esp, 4
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	[edi+2Ch], eax
		mov	eax, [esi+2Ch]
		test	eax, eax
		js	short loc_1000AD94
		cmp	eax, 0FFh
		jg	short loc_1000AD94
		mov	[edi+44h], eax

loc_1000AD94:				; CODE XREF: sub_1000AB70+218j
					; sub_1000AB70+21Fj
		cmp	dword ptr [edi+44h], 0
		jnz	short loc_1000ADA7
		cmp	dword ptr [esi+40h], 0
		jz	short loc_1000ADA7
		mov	dword ptr [edi+44h], 1

loc_1000ADA7:				; CODE XREF: sub_1000AB70+228j
					; sub_1000AB70+22Ej
		cmp	[esp+14h+arg_14], 1
		jnz	short loc_1000ADBB
		mov	eax, 7
		cmp	[edi+44h], eax
		jge	short loc_1000ADBB
		mov	[edi+44h], eax

loc_1000ADBB:				; CODE XREF: sub_1000AB70+1FDj
					; sub_1000AB70+23Cj ...
		mov	dword ptr [edi+1Ch], 1
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_1000AB70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000ADD0	proc near		; CODE XREF: sub_1000B0B0+14Fp
					; sub_1000B680:loc_1000B7D3p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_C]
		mov	eax, [ebx]
		push	esi
		push	0F8h
		mov	[esp+10h+var_4], eax
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000ADF7
		lea	eax, [esi+2]
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000ADF7:				; CODE XREF: sub_1000ADD0+1Ej
		mov	eax, [ebx+44h]
		mov	[esi+38h], eax
		test	eax, eax
		jz	short loc_1000AE0F
		mov	eax, 20h
		mov	dword ptr [esi+0Ch], 1
		jmp	short loc_1000AE1B
; ---------------------------------------------------------------------------

loc_1000AE0F:				; CODE XREF: sub_1000ADD0+2Fj
		mov	eax, 400h
		mov	dword ptr [esi+0Ch], 200h

loc_1000AE1B:				; CODE XREF: sub_1000ADD0+3Dj
		mov	ecx, [esi+0Ch]
		push	ebp
		mov	ebp, ds:PR_NewLock
		dec	ecx
		push	edi
		mov	[esi+70h], eax
		mov	[esi+68h], eax
		mov	[esi+10h], ecx
		call	ebp ; PR_NewLock
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_1000AEDB
		mov	edx, [esi+0Ch]
		add	edx, edx
		add	edx, edx
		push	edx
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+8], eax
		test	eax, eax
		jz	loc_1000AEDB
		xor	edi, edi
		cmp	[esi+0Ch], edi
		jbe	short loc_1000AE77
		nop

loc_1000AE60:				; CODE XREF: sub_1000ADD0+A5j
		call	ebp ; PR_NewLock
		mov	ecx, [esi+8]
		mov	[ecx+edi*4], eax
		mov	edx, [esi+8]
		cmp	dword ptr [edx+edi*4], 0
		jz	short loc_1000AEDB
		inc	edi
		cmp	edi, [esi+0Ch]
		jb	short loc_1000AE60

loc_1000AE77:				; CODE XREF: sub_1000ADD0+8Dj
		call	ebp ; PR_NewLock
		mov	[esi+14h], eax
		test	eax, eax
		jz	short loc_1000AEDB
		call	ebp ; PR_NewLock
		mov	[esi+18h], eax
		test	eax, eax
		jz	short loc_1000AEDB
		mov	eax, [esi+70h]
		add	eax, eax
		add	eax, eax
		push	eax
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+6Ch], eax
		test	eax, eax
		jz	short loc_1000AEDB
		mov	ecx, [esi+68h]
		add	ecx, ecx
		add	ecx, ecx
		push	ecx
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	[esi+64h], eax
		test	eax, eax
		jz	short loc_1000AEDB
		push	0
		push	0
		push	offset SECITEM_HashCompare
		push	offset PL_CompareValues
		push	offset loc_10007E00
		push	40h
		call	PL_NewHashTable
		add	esp, 18h
		mov	[esi+60h], eax
		test	eax, eax
		jnz	short loc_1000AEF1

loc_1000AEDB:				; CODE XREF: sub_1000ADD0+67j
					; sub_1000ADD0+82j ...
		push	esi
		mov	edi, 2
		call	sub_100081D0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AEF1:				; CODE XREF: sub_1000ADD0+109j
		mov	edx, dword_10029120
		mov	eax, [esp+14h+var_4]
		mov	dword ptr [esi+48h], 0
		mov	[esi+58h], edx
		mov	[esi], eax
		mov	ebp, [ebx+24h]
		test	ebp, ebp
		jnz	short loc_1000AF19
		push	eax
		call	sub_10007E10
		add	esp, 4
		mov	ebp, eax

loc_1000AF19:				; CODE XREF: sub_1000ADD0+13Cj
		mov	edi, ebp
		lea	ebx, [esi+0B6h]
		lea	ecx, [edi+1]

loc_1000AF24:				; CODE XREF: sub_1000ADD0+159j
		mov	al, [edi]
		inc	edi
		test	al, al
		jnz	short loc_1000AF24
		sub	edi, ecx
		cmp	edi, 40h
		jle	short loc_1000AF4F

loc_1000AF32:				; CODE XREF: sub_1000ADD0+17Dj
		test	edi, edi
		jle	short loc_1000AF47

loc_1000AF36:				; CODE XREF: sub_1000ADD0+173j
		mov	al, [edi+ebp-1]
		and	al, 0C0h
		cmp	al, 80h
		jnz	short loc_1000AF45
		dec	edi
		test	edi, edi
		jg	short loc_1000AF36

loc_1000AF45:				; CODE XREF: sub_1000ADD0+16Ej
		test	edi, edi

loc_1000AF47:				; CODE XREF: sub_1000ADD0+164j
		jz	short loc_1000AF4A
		dec	edi

loc_1000AF4A:				; CODE XREF: sub_1000ADD0:loc_1000AF47j
		cmp	edi, 40h
		jg	short loc_1000AF32

loc_1000AF4F:				; CODE XREF: sub_1000ADD0+160j
		push	40h		; Size
		push	20h		; Val
		push	ebx		; Dst
		call	memset
		push	edi		; Size
		push	ebp		; Src
		push	ebx		; Dst
		mov	byte ptr [ebx+40h], 0
		call	memcpy
		mov	ebp, [esp+2Ch+arg_10]
		mov	ecx, [esp+2Ch+arg_C]
		mov	edx, [esp+2Ch+arg_8]
		mov	eax, [esp+2Ch+arg_4]
		push	ebp
		push	ecx
		mov	ecx, [esp+34h+arg_0]
		push	edx
		push	eax
		push	ecx
		push	esi
		call	sub_1000AB70
		mov	edi, eax
		add	esp, 30h
		test	edi, edi
		jnz	short loc_1000AF9D
		push	ebp
		push	esi
		call	sub_10007EF0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1000AFAE

loc_1000AF9D:				; CODE XREF: sub_1000ADD0+1BBj
		push	esi
		call	sub_100081D0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000AFAE:				; CODE XREF: sub_1000ADD0+1CBj
		pop	edi
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_1000ADD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000AFC0	proc near		; CODE XREF: sub_1000B0B0+16Bp
					; sub_1000B270+26p ...

var_4		= dword	ptr -4

		push	ecx
		push	edi
		mov	edi, eax
		mov	eax, Src[edi*4]
		mov	[esp+8+var_4], eax
		test	eax, eax
		jz	loc_1000B0A0
		push	ebx
		mov	ebx, dword_10029640[edi*4]
		push	ebp
		mov	ebp, dword_10029658[edi*4]
		push	esi
		xor	esi, esi
		test	ebx, ebx
		jle	short loc_1000B039
		jmp	short loc_1000AFF4
; ---------------------------------------------------------------------------

loc_1000AFF0:				; CODE XREF: sub_1000AFC0+77j
		mov	eax, [esp+14h+var_4]

loc_1000AFF4:				; CODE XREF: sub_1000AFC0+2Ej
		mov	eax, [eax+esi*4]
		cmp	eax, 3
		jz	short loc_1000B005
		cmp	eax, 65h
		jnb	short loc_1000B005
		xor	ecx, ecx
		jmp	short loc_1000B00A
; ---------------------------------------------------------------------------

loc_1000B005:				; CODE XREF: sub_1000AFC0+3Aj
					; sub_1000AFC0+3Fj
		mov	ecx, 1

loc_1000B00A:				; CODE XREF: sub_1000AFC0+43j
		mov	ecx, dword_10029658[ecx*4]
		test	ecx, ecx
		jz	short loc_1000B034
		push	eax
		push	ecx
		call	PL_HashTableLookupConst
		add	esp, 8
		test	eax, eax
		jz	short loc_1000B034
		cmp	dword ptr [eax+1Ch], 0
		jz	short loc_1000B034
		push	1
		push	eax
		call	sub_10008020
		add	esp, 8

loc_1000B034:				; CODE XREF: sub_1000AFC0+53j
					; sub_1000AFC0+61j ...
		inc	esi
		cmp	esi, ebx
		jl	short loc_1000AFF0

loc_1000B039:				; CODE XREF: sub_1000AFC0+2Cj
		xor	eax, eax
		mov	Src[edi*4], eax
		mov	dword_10029640[edi*4], eax
		mov	dword_10029658[edi*4], eax
		mov	dword_10029650[edi*4], eax
		xor	edi, edi
		cmp	ebx, eax
		jle	short loc_1000B08A
		lea	ecx, [ecx+0]

loc_1000B060:				; CODE XREF: sub_1000AFC0+C8j
		mov	eax, [esp+14h+var_4]
		mov	esi, [eax+edi*4]
		push	esi
		push	ebp
		call	PL_HashTableLookup
		add	esp, 8
		test	eax, eax
		jz	short loc_1000B085
		push	eax
		call	sub_100081D0
		push	esi
		push	ebp
		call	PL_HashTableRemove
		add	esp, 0Ch

loc_1000B085:				; CODE XREF: sub_1000AFC0+B3j
		inc	edi
		cmp	edi, ebx
		jl	short loc_1000B060

loc_1000B08A:				; CODE XREF: sub_1000AFC0+9Bj
		mov	ecx, [esp+14h+var_4]
		push	ecx
		call	PORT_Free_Util
		push	ebp
		call	PL_HashTableDestroy
		add	esp, 8
		pop	esi
		pop	ebp
		pop	ebx

loc_1000B0A0:				; CODE XREF: sub_1000AFC0+11j
		pop	edi
		pop	ecx
		retn
sub_1000AFC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B0B0	proc near		; CODE XREF: sub_10003640+78p
					; sub_1000B240+16p

Dst		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		push	ebp
		xor	eax, eax
		push	esi
		mov	esi, [esp+40h+arg_4]
		test	esi, esi
		setnz	al
		mov	ebp, eax
		test	esi, esi
		jz	short loc_1000B0D6
		push	1
		call	ds:PR_SecondsToInterval
		add	esp, 4
		mov	dword_10029614,	eax

loc_1000B0D6:				; CODE XREF: sub_1000B0B0+14j
		call	SECOID_Init
		test	eax, eax
		jz	short loc_1000B0EA

loc_1000B0DF:				; CODE XREF: sub_1000B0B0+41j
					; sub_1000B0B0+4Aj
		pop	esi
		mov	eax, 30h
		pop	ebp
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000B0EA:				; CODE XREF: sub_1000B0B0+2Dj
		call	sub_100215C0
		test	eax, eax
		jnz	short loc_1000B0DF
		call	sub_10020B00
		test	eax, eax
		jnz	short loc_1000B0DF
		mov	eax, [esp+40h+arg_0]
		test	eax, eax
		jz	short loc_1000B149
		test	byte ptr [eax+10h], 2
		jnz	short loc_1000B149
		cmp	dword ptr [eax], 0
		jz	short loc_1000B12C
		cmp	dword ptr [eax+4], 0
		jz	short loc_1000B13E
		cmp	dword ptr [eax+8], 0
		jz	short loc_1000B13E
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1000B13E
		pop	esi
		mov	eax, 0Ah
		pop	ebp
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000B12C:				; CODE XREF: sub_1000B0B0+5Dj
		cmp	dword ptr [eax+4], 0
		jnz	short loc_1000B13E
		cmp	dword ptr [eax+8], 0
		jnz	short loc_1000B13E
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1000B149

loc_1000B13E:				; CODE XREF: sub_1000B0B0+63j
					; sub_1000B0B0+69j ...
		pop	esi
		mov	eax, 7
		pop	ebp
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000B149:				; CODE XREF: sub_1000B0B0+52j
					; sub_1000B0B0+58j ...
		push	edi
		mov	edi, 7
		test	eax, eax
		jz	loc_1000B237
		mov	eax, [eax+14h]
		test	eax, eax
		jz	loc_1000B237
		push	esi		; int
		lea	ecx, [esp+48h+Dst]
		push	ecx		; Dst
		push	eax		; int
		call	sub_1001DDF0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B239
		mov	edi, [esp+44h+var_24]
		mov	edx, [esp+44h+var_28]
		call	sub_10006B80
		mov	edi, eax
		test	edi, edi
		jnz	loc_1000B221
		test	esi, esi
		jz	short loc_1000B19E
		cmp	dword_1002963C,	eax
		jnz	short loc_1000B1A7
		jmp	short loc_1000B1DC
; ---------------------------------------------------------------------------

loc_1000B19E:				; CODE XREF: sub_1000B0B0+E2j
		cmp	dword_1002955C,	0
		jz	short loc_1000B1DC

loc_1000B1A7:				; CODE XREF: sub_1000B0B0+EAj
		mov	eax, esi
		call	sub_10008510
		cmp	dword_10029558,	0
		jz	short loc_1000B1DC
		test	esi, esi
		jz	short loc_1000B1CB
		cmp	dword_1002963C,	0
		jz	short loc_1000B1CB
		push	offset aEnabledFipsMod ; "enabled FIPS mode"
		jmp	short loc_1000B1D0
; ---------------------------------------------------------------------------

loc_1000B1CB:				; CODE XREF: sub_1000B0B0+109j
					; sub_1000B0B0+112j
		push	offset aDisabledFipsMo ; "disabled FIPS	mode"

loc_1000B1D0:				; CODE XREF: sub_1000B0B0+119j
		push	7
		push	1
		call	nullsub_1
		add	esp, 0Ch

loc_1000B1DC:				; CODE XREF: sub_1000B0B0+ECj
					; sub_1000B0B0+F5j ...
		push	ebx
		xor	ebx, ebx
		cmp	[esp+48h+var_4], ebx
		jle	short loc_1000B220
		xor	esi, esi

loc_1000B1E7:				; CODE XREF: sub_1000B0B0+165j
		mov	edx, [esp+48h+var_8]
		mov	ecx, [esp+48h+var_30]
		push	ebp
		lea	eax, [esi+edx]
		mov	edx, [esp+4Ch+var_34]
		push	eax
		mov	eax, [esp+50h+Dst]
		push	ecx
		push	edx
		push	eax
		call	sub_1000ADD0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_1000B219
		inc	ebx
		add	esi, 48h
		cmp	ebx, [esp+48h+var_4]
		jl	short loc_1000B1E7
		jmp	short loc_1000B220
; ---------------------------------------------------------------------------

loc_1000B219:				; CODE XREF: sub_1000B0B0+15Bj
		mov	eax, ebp
		call	sub_1000AFC0

loc_1000B220:				; CODE XREF: sub_1000B0B0+133j
					; sub_1000B0B0+167j
		pop	ebx

loc_1000B221:				; CODE XREF: sub_1000B0B0+DAj
		lea	ecx, [esp+44h+Dst]
		push	ecx
		call	sub_1001E500
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B237
		call	sub_10016140

loc_1000B237:				; CODE XREF: sub_1000B0B0+A1j
					; sub_1000B0B0+ACj ...
		mov	eax, edi

loc_1000B239:				; CODE XREF: sub_1000B0B0+C3j
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 38h
		retn
sub_1000B0B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000B240	proc near		; DATA XREF: .rdata:10025FB2o

arg_0		= dword	ptr  4

		cmp	dword_1002963C,	0
		jz	short loc_1000B24F
		mov	eax, 191h
		retn
; ---------------------------------------------------------------------------

loc_1000B24F:				; CODE XREF: sub_1000B240+7j
		mov	eax, [esp+arg_0]
		push	0
		push	eax
		call	sub_1000B0B0
		xor	ecx, ecx
		add	esp, 8
		test	eax, eax
		setz	cl
		mov	dword_1002963C,	ecx
		retn
sub_1000B240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B270	proc near		; CODE XREF: sub_10003640+C3p
					; sub_10003780+30p

arg_4		= dword	ptr  8

		mov	eax, dword_100299BC
		push	esi
		push	eax
		call	sub_100222C0
		mov	ecx, dword_100299BC
		push	ecx
		call	UTIL_SetForkState
		mov	esi, [esp+0Ch+arg_4]
		xor	eax, eax
		add	esp, 8
		test	esi, esi
		setnz	al
		call	sub_1000AFC0
		test	esi, esi
		pop	esi
		jz	short loc_1000B2AC
		cmp	dword_1002963C,	0
		jz	short loc_1000B2B5
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000B2AC:				; CODE XREF: sub_1000B270+2Ej
		cmp	dword_1002955C,	0
		jnz	short loc_1000B2EE

loc_1000B2B5:				; CODE XREF: sub_1000B270+37j
		call	sub_100161D0
		call	sub_1001D450
		call	sub_10021680
		call	sub_100217D0
		push	0
		call	sub_100222C0
		call	sub_10021800
		call	SECOID_Shutdown
		push	0
		call	UTIL_SetForkState
		add	esp, 8
		mov	dword_1002963C,	0

loc_1000B2EE:				; CODE XREF: sub_1000B270+43j
		xor	eax, eax
		retn
sub_1000B270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B300	proc near		; DATA XREF: .rdata:10025FB6o
		cmp	dword_1002963C,	0
		jz	short loc_1000B36C
		mov	eax, dword_100299BC
		push	eax
		call	sub_100222C0
		mov	ecx, dword_100299BC
		push	ecx
		call	UTIL_SetForkState
		add	esp, 8
		xor	eax, eax
		call	sub_1000AFC0
		cmp	dword_1002955C,	0
		jnz	short loc_1000B362
		call	sub_100161D0
		call	sub_1001D450
		call	sub_10021680
		call	sub_100217D0
		push	0
		call	sub_100222C0
		call	sub_10021800
		call	SECOID_Shutdown
		push	0
		call	UTIL_SetForkState
		add	esp, 8

loc_1000B362:				; CODE XREF: sub_1000B300+31j
		mov	dword_1002963C,	0

loc_1000B36C:				; CODE XREF: sub_1000B300+7j
		xor	eax, eax
		retn
sub_1000B300	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B370	proc near		; CODE XREF: sub_1000B3F0+174p

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, eax
		push	esi
		call	sub_1001F1D0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000B387
		mov	eax, [edi+2Ch]
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000B387:				; CODE XREF: sub_1000B370+Fj
		push	esi
		call	sub_1001EE90
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000B3D5
		mov	[esp+8+var_4], eax
		lea	eax, [esp+8+var_4]
		push	eax
		push	offset word_10026FE6
		push	esi
		call	sub_1001EF70
		add	esp, 0Ch
		cmp	[esp+8+var_4], 0
		mov	esi, eax
		jz	short loc_1000B3BF
		push	0
		push	edi
		call	sub_10008020
		add	esp, 8

loc_1000B3BF:				; CODE XREF: sub_1000B370+42j
		xor	eax, eax
		test	esi, esi
		setz	al
		xor	ecx, ecx
		pop	esi
		test	eax, eax
		setz	cl
		mov	eax, ecx
		mov	[edi+2Ch], eax
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000B3D5:				; CODE XREF: sub_1000B370+22j
		xor	eax, eax
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		pop	esi
		mov	eax, ecx
		mov	[edi+2Ch], eax
		pop	ecx
		retn
sub_1000B370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000B3F0(int,	void *Dst)
sub_1000B3F0	proc near		; CODE XREF: sub_10003810+Bp
					; DATA XREF: .rdata:10025FCAo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8

		push	ecx
		cmp	dword_1002963C,	0
		jnz	short loc_1000B40A
		cmp	dword_1002955C,	0
		jnz	short loc_1000B40A
		mov	eax, 190h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000B40A:				; CODE XREF: sub_1000B3F0+8j
					; sub_1000B3F0+11j
		mov	ecx, [esp+4+arg_0]
		cmp	ecx, 3
		jz	short loc_1000B41C
		cmp	ecx, 65h
		jnb	short loc_1000B41C
		xor	eax, eax
		jmp	short loc_1000B421
; ---------------------------------------------------------------------------

loc_1000B41C:				; CODE XREF: sub_1000B3F0+21j
					; sub_1000B3F0+26j
		mov	eax, 1

loc_1000B421:				; CODE XREF: sub_1000B3F0+2Aj
		mov	eax, dword_10029658[eax*4]
		push	ebx
		test	eax, eax
		jz	short loc_1000B443
		push	ecx
		push	eax
		call	PL_HashTableLookupConst
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_1000B443
		cmp	dword ptr [ebx+1Ch], 0
		jnz	short loc_1000B44B

loc_1000B443:				; CODE XREF: sub_1000B3F0+3Bj
					; sub_1000B3F0+4Bj
		mov	eax, 3
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000B44B:				; CODE XREF: sub_1000B3F0+51j
		push	ebp
		mov	ebp, [esp+0Ch+Dst]
		push	esi
		mov	esi, off_10029118
		push	edi
		lea	edi, [ebp+20h]
		mov	ecx, 8
		rep movsd
		mov	eax, ds:dword_10027024
		mov	[ebp+40h], eax
		mov	ecx, ds:dword_10027028
		mov	[ebp+44h], ecx
		mov	edx, ds:dword_1002702C
		mov	[ebp+48h], edx
		mov	eax, ds:dword_10027030
		mov	[ebp+4Ch], eax
		mov	ecx, ds:dword_10027010
		mov	[ebp+50h], ecx
		mov	edx, ds:dword_10027014
		mov	[ebp+54h], edx
		mov	eax, ds:dword_10027018
		mov	[ebp+58h], eax
		mov	ecx, ds:dword_1002701C
		mov	[ebp+5Ch], ecx
		mov	edx, ds:dword_10027010
		mov	[ebp+90h], edx
		mov	eax, ds:dword_10027014
		mov	[ebp+94h], eax
		mov	ecx, ds:dword_10027018
		mov	[ebp+98h], ecx
		mov	edx, ds:dword_1002701C
		xor	eax, eax
		mov	[ebp+9Ch], edx
		mov	[ebp+64h], eax
		mov	ecx, [ebx+50h]
		mov	[ebp+68h], ecx
		mov	[ebp+6Ch], eax
		mov	edx, [ebx+54h]
		mov	[ebp+70h], edx
		mov	[ebp+8Eh], ax
		lea	esi, [ebx+74h]
		mov	ecx, 8
		mov	edi, ebp
		push	ebx
		rep movsd
		call	sub_1001CE00
		mov	esi, eax
		xor	eax, eax
		add	esp, 4
		mov	[esp+14h+var_4], esi
		mov	dword ptr [ebp+60h], 201h
		cmp	esi, eax
		jnz	short loc_1000B549
		mov	dword ptr [ebp+60h], 203h
		mov	[ebp+74h], eax
		mov	[ebp+78h], eax
		mov	[ebp+7Ch], eax
		mov	[ebp+80h], eax
		mov	[ebp+84h], eax
		mov	[ebp+88h], eax
		mov	word ptr [ebp+8Ch], 4
		jmp	loc_1000B654
; ---------------------------------------------------------------------------

loc_1000B549:				; CODE XREF: sub_1000B3F0+127j
		push	esi
		call	sub_1001EE90
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000B560
		or	dword ptr [ebp+60h], 4
		jmp	loc_1000B61B
; ---------------------------------------------------------------------------

loc_1000B560:				; CODE XREF: sub_1000B3F0+165j
		mov	eax, esi
		mov	edi, ebx
		call	sub_1000B370
		test	eax, eax
		jnz	short loc_1000B576
		or	dword ptr [ebp+60h], 8
		jmp	loc_1000B61B
; ---------------------------------------------------------------------------

loc_1000B576:				; CODE XREF: sub_1000B3F0+17Bj
		or	dword ptr [ebp+60h], 0Ch
		push	esi
		call	sub_1001EDD0
		add	esp, 4
		test	eax, eax
		jz	loc_1000B61B
		xor	eax, eax
		lea	esi, [ebx+95h]

loc_1000B593:				; CODE XREF: sub_1000B3F0+1B1j
		cmp	byte ptr [esi+eax], 20h
		jnz	loc_1000B66F
		inc	eax
		cmp	eax, 20h
		jl	short loc_1000B593
		mov	eax, [esp+14h+var_4]
		push	eax
		call	sub_1001CD80
		add	esp, 4
		test	eax, eax
		jz	short loc_1000B617
		mov	ecx, eax
		lea	esi, [ecx+1]
		lea	esp, [esp+0]

loc_1000B5C0:				; CODE XREF: sub_1000B3F0+1D5j
		mov	dl, [ecx]
		inc	ecx
		test	dl, dl
		jnz	short loc_1000B5C0
		sub	ecx, esi
		cmp	ecx, 20h
		jle	short loc_1000B5EF
		mov	edi, edi

loc_1000B5D0:				; CODE XREF: sub_1000B3F0+1FDj
		test	ecx, ecx
		jle	short loc_1000B5E7

loc_1000B5D4:				; CODE XREF: sub_1000B3F0+1F3j
		mov	dl, [eax+ecx-1]
		and	dl, 0C0h
		cmp	dl, 80h
		jnz	short loc_1000B5E5
		dec	ecx
		test	ecx, ecx
		jg	short loc_1000B5D4

loc_1000B5E5:				; CODE XREF: sub_1000B3F0+1EEj
		test	ecx, ecx

loc_1000B5E7:				; CODE XREF: sub_1000B3F0+1E2j
		jz	short loc_1000B5EA
		dec	ecx

loc_1000B5EA:				; CODE XREF: sub_1000B3F0:loc_1000B5E7j
		cmp	ecx, 20h
		jg	short loc_1000B5D0

loc_1000B5EF:				; CODE XREF: sub_1000B3F0+1DCj
		mov	edx, 20202020h
		mov	[ebp+0], edx
		mov	[ebp+4], edx
		mov	[ebp+8], edx
		mov	[ebp+0Ch], edx
		push	ecx		; Size
		mov	[ebp+10h], edx
		mov	[ebp+14h], edx
		push	eax		; Src
		mov	[ebp+18h], edx
		push	ebp		; Dst
		mov	[ebp+1Ch], edx
		call	memcpy
		add	esp, 0Ch

loc_1000B617:				; CODE XREF: sub_1000B3F0+1C2j
					; sub_1000B3F0+288j
		mov	esi, [esp+14h+var_4]

loc_1000B61B:				; CODE XREF: sub_1000B3F0+16Bj
					; sub_1000B3F0+181j ...
		mov	dword ptr [ebp+74h], 0FFh
		mov	eax, [ebx+44h]
		mov	[ebp+78h], eax
		mov	eax, 1
		push	esi
		mov	[ebp+7Ch], eax
		mov	[ebp+80h], eax
		mov	[ebp+84h], eax
		mov	[ebp+88h], eax
		mov	word ptr [ebp+8Ch], 0
		call	sub_1001CD90
		add	esp, 4

loc_1000B654:				; CODE XREF: sub_1000B3F0+154j
		mov	eax, [ebp+60h]
		test	al, 4
		jz	short loc_1000B65F
		test	al, 8
		jz	short loc_1000B667

loc_1000B65F:				; CODE XREF: sub_1000B3F0+269j
		or	eax, 400h
		mov	[ebp+60h], eax

loc_1000B667:				; CODE XREF: sub_1000B3F0+26Dj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000B66F:				; CODE XREF: sub_1000B3F0+1A7j
		mov	ecx, 8
		mov	edi, ebp
		rep movsd
		jmp	short loc_1000B617
sub_1000B3F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B680	proc near		; CODE XREF: sub_1000B800+FBp

Dst		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		push	ebx
		push	ebp
		mov	ebp, [esp+40h+arg_0]
		push	esi
		xor	esi, esi
		mov	ebx, eax
		cmp	ebp, 0CE534356h
		jz	short loc_1000B6B2
		cmp	ebp, 0CE534355h
		jz	short loc_1000B6A8
		lea	eax, [esi+13h]
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000B6A8:				; CODE XREF: sub_1000B680+1Cj
		cmp	dword ptr [ebx], 3
		jnz	short loc_1000B6B2
		mov	esi, 1

loc_1000B6B2:				; CODE XREF: sub_1000B680+14j
					; sub_1000B680+2Bj
		mov	eax, [esp+44h+arg_4]
		push	0CE534368h
		push	eax
		call	sub_10016660
		add	esp, 8
		mov	[esp+44h+arg_0], eax
		test	eax, eax
		jnz	short loc_1000B6D8
		pop	esi
		pop	ebp
		mov	eax, 0D0h
		pop	ebx
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000B6D8:				; CODE XREF: sub_1000B680+4Aj
		mov	eax, [eax+18h]
		push	edi
		push	esi		; int
		lea	ecx, [esp+4Ch+Dst]
		push	ecx		; Dst
		push	eax		; int
		call	sub_1001DDF0
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	loc_1000B7DD
		cmp	[esp+48h+var_4], 1
		jnz	short loc_1000B75B
		mov	edi, [esp+48h+var_8]
		mov	edx, [edi]
		lea	eax, [edx-4]
		mov	ecx, 60h
		cmp	ecx, eax
		sbb	eax, eax
		inc	eax
		lea	ecx, [edx-65h]
		mov	esi, 1Ah
		cmp	esi, ecx
		sbb	ecx, ecx
		inc	ecx
		cmp	ebp, 0CE534356h
		jnz	short loc_1000B742
		cmp	[ebx], edx
		jnz	short loc_1000B75B
		test	eax, eax
		jnz	short loc_1000B730
		test	ecx, ecx
		jz	short loc_1000B75B

loc_1000B730:				; CODE XREF: sub_1000B680+AAj
		mov	ebx, [esp+48h+arg_0]

loc_1000B734:				; CODE XREF: sub_1000B680+D9j
		cmp	edx, 3
		jz	short loc_1000B762
		cmp	edx, 65h
		jnb	short loc_1000B762
		xor	eax, eax
		jmp	short loc_1000B767
; ---------------------------------------------------------------------------

loc_1000B742:				; CODE XREF: sub_1000B680+A2j
		mov	esi, [ebx]
		cmp	esi, 1
		jnz	short loc_1000B74D
		xor	ebx, ebx
		jmp	short loc_1000B757
; ---------------------------------------------------------------------------

loc_1000B74D:				; CODE XREF: sub_1000B680+C7j
		cmp	esi, 3
		jnz	short loc_1000B75B
		mov	eax, ecx
		lea	ebx, [esi-2]

loc_1000B757:				; CODE XREF: sub_1000B680+CBj
		test	eax, eax
		jnz	short loc_1000B734

loc_1000B75B:				; CODE XREF: sub_1000B680+7Aj
					; sub_1000B680+A6j ...
		mov	edi, 13h
		jmp	short loc_1000B7DD
; ---------------------------------------------------------------------------

loc_1000B762:				; CODE XREF: sub_1000B680+B7j
					; sub_1000B680+BCj
		mov	eax, 1

loc_1000B767:				; CODE XREF: sub_1000B680+C0j
		mov	eax, dword_10029658[eax*4]
		test	eax, eax
		jnz	short loc_1000B776
		xor	esi, esi
		jmp	short loc_1000B79F
; ---------------------------------------------------------------------------

loc_1000B776:				; CODE XREF: sub_1000B680+F0j
		push	edx
		push	eax
		call	PL_HashTableLookupConst
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000B79B
		cmp	dword ptr [esi+1Ch], 0
		jz	short loc_1000B79B
		push	esi
		call	sub_10008120
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B7DD

loc_1000B79B:				; CODE XREF: sub_1000B680+104j
					; sub_1000B680+10Aj
		mov	edi, [esp+48h+var_8]

loc_1000B79F:				; CODE XREF: sub_1000B680+F4j
		cmp	ebp, 0CE534356h
		jnz	short loc_1000B7B3
		neg	esi
		sbb	esi, esi
		and	esi, 0FFFFFFFDh
		lea	edi, [esi+3]
		jmp	short loc_1000B7DD
; ---------------------------------------------------------------------------

loc_1000B7B3:				; CODE XREF: sub_1000B680+125j
		mov	edx, [esp+48h+var_30]
		mov	eax, [esp+48h+var_34]
		mov	ecx, [esp+48h+Dst]
		push	ebx
		push	edi
		push	edx
		push	eax
		push	ecx
		test	esi, esi
		jz	short loc_1000B7D3
		push	esi
		call	sub_1000AB70
		add	esp, 18h
		jmp	short loc_1000B7DB
; ---------------------------------------------------------------------------

loc_1000B7D3:				; CODE XREF: sub_1000B680+146j
		call	sub_1000ADD0
		add	esp, 14h

loc_1000B7DB:				; CODE XREF: sub_1000B680+151j
		mov	edi, eax

loc_1000B7DD:				; CODE XREF: sub_1000B680+6Fj
					; sub_1000B680+E0j ...
		lea	edx, [esp+48h+Dst]
		push	edx
		call	sub_1001E500
		mov	eax, [esp+4Ch+arg_0]
		push	eax
		call	sub_10015D70
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 38h
		retn
sub_1000B680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B800	proc near		; CODE XREF: sub_10003C60+72p
					; DATA XREF: .rdata:10026002o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		push	eax
		call	sub_10007E90
		mov	ecx, [esp+0Ch+arg_C]
		add	esp, 4
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 80000000h
		mov	dword ptr [ecx], 0
		test	eax, eax
		jnz	short loc_1000B832
		mov	eax, 0B3h
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B832:				; CODE XREF: sub_1000B800+27j
		push	ebx
		push	eax
		call	sub_100161F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000B84A
		lea	eax, [ebx+2]
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B84A:				; CODE XREF: sub_1000B800+40j
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		cmp	[esp+18h+arg_8], ebp
		jle	short loc_1000B895
		mov	esi, [esp+18h+arg_4]
		add	esi, 4
		lea	esp, [esp+0]

loc_1000B860:				; CODE XREF: sub_1000B800+93j
		mov	edx, [esi+4]
		mov	eax, [esi]
		mov	ecx, [esi-4]
		push	edx
		push	eax
		push	ecx
		push	ebx
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1000B8BE
		cmp	[esi-4], eax
		jnz	short loc_1000B88B
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000B88B
		mov	edx, [eax]
		mov	[esp+18h+var_8], edx

loc_1000B88B:				; CODE XREF: sub_1000B800+7Dj
					; sub_1000B800+83j
		inc	ebp
		add	esi, 0Ch
		cmp	ebp, [esp+18h+arg_8]
		jl	short loc_1000B860

loc_1000B895:				; CODE XREF: sub_1000B800+53j
		mov	eax, [esp+18h+arg_0]
		push	eax
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B8D1
		push	ebx
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B8BE:				; CODE XREF: sub_1000B800+78j
		push	ebx
		call	sub_10016D30
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B8D1:				; CODE XREF: sub_1000B800+A6j
		mov	eax, [esp+18h+var_8]
		cmp	eax, 0CE534355h
		jz	short loc_1000B8F5
		cmp	eax, 0CE534356h
		jz	short loc_1000B8F5
		push	edi
		push	ebx
		call	sub_1000A8F0
		mov	ecx, [ebx+0Ch]
		mov	edx, [esp+20h+arg_C]
		mov	[edx], ecx
		jmp	short loc_1000B900
; ---------------------------------------------------------------------------

loc_1000B8F5:				; CODE XREF: sub_1000B800+DAj
					; sub_1000B800+E1j
		push	ebx
		push	eax
		mov	eax, [esp+20h+var_4]
		call	sub_1000B680

loc_1000B900:				; CODE XREF: sub_1000B800+F3j
		add	esp, 8
		push	edi
		mov	esi, eax
		call	sub_100177F0
		push	ebx
		call	sub_10016D30
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_1000B800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B920	proc near		; CODE XREF: sub_10003D20+48p
					; DATA XREF: .rdata:10026006o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		push	esi
		call	sub_10007E90
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B943

loc_1000B938:				; CODE XREF: sub_1000B920+34j
		pop	edi
		mov	eax, 0B3h
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B943:				; CODE XREF: sub_1000B920+16j
		push	esi
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		mov	[esp+10h+var_4], esi
		test	esi, esi
		jz	short loc_1000B938
		mov	eax, [esp+10h+arg_4]
		push	ebx
		push	esi
		push	eax
		call	sub_10017DA0
		mov	ebx, eax
		add	esp, 8
		mov	[esp+14h+var_8], ebx
		test	ebx, ebx
		jnz	short loc_1000B984
		push	esi
		call	sub_100177F0
		add	esp, 4
		pop	ebx
		pop	edi
		mov	eax, 82h
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B984:				; CODE XREF: sub_1000B920+4Dj
		push	edi
		call	sub_100161F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B9AC
		push	esi
		call	sub_100177F0
		push	ebx
		call	sub_10016D30
		add	esp, 8
		pop	ebx
		lea	eax, [edi+2]
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B9AC:				; CODE XREF: sub_1000B920+71j
		push	ebp
		xor	ebp, ebp
		cmp	[esp+18h+arg_C], ebp
		jle	short loc_1000B9FF
		mov	esi, [esp+18h+arg_8]
		lea	esp, [esp+0]

loc_1000B9C0:				; CODE XREF: sub_1000B920+D9j
		mov	ecx, [ebx+8]
		mov	edx, [esi]
		push	ecx
		push	edx
		call	sub_10015EF0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000BA45
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		mov	edx, [esi]
		push	eax
		push	ecx
		push	edx
		push	edi
		call	sub_10016BB0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_1000BA4A
		mov	ebx, [esp+18h+var_8]
		inc	ebp
		add	esi, 0Ch
		cmp	ebp, [esp+18h+arg_C]
		jl	short loc_1000B9C0
		mov	esi, [esp+18h+var_4]

loc_1000B9FF:				; CODE XREF: sub_1000B920+93j
		push	103h
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_1000BA71
		push	103h
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000BA71
		push	esi
		call	sub_100177F0
		push	ebx
		call	sub_10016D30
		push	edi
		call	sub_10016D30
		add	esp, 0Ch
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 10h
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000BA45:				; CODE XREF: sub_1000B920+B1j
		mov	ebx, 10h

loc_1000BA4A:				; CODE XREF: sub_1000B920+CBj
		mov	eax, [esp+18h+var_4]
		push	eax
		call	sub_100177F0
		mov	ecx, [esp+1Ch+var_8]
		push	ecx
		call	sub_10016D30
		push	edi
		call	sub_10016D30
		add	esp, 0Ch
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000BA71:				; CODE XREF: sub_1000B920+EFj
					; sub_1000B920+101j
		push	ebx
		push	edi
		call	sub_10017310
		mov	edx, [ebx+8]
		push	ebx
		mov	ebp, eax
		mov	[edi+8], edx
		call	sub_10016D30
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_1000BAA6
		push	edi
		call	sub_10016D30
		push	esi
		call	sub_100177F0
		add	esp, 8
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000BAA6:				; CODE XREF: sub_1000B920+16Bj
		push	esi
		push	edi
		call	sub_1000A8F0
		mov	ecx, [esp+20h+arg_10]
		mov	ebx, eax
		mov	eax, [edi+0Ch]
		push	esi
		mov	[ecx], eax
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 10h
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 8
		retn
sub_1000B920	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

loc_1000BAF0:				; DATA XREF: sub_10012FD0+511o
					; sub_10012FD0+78Ao
		mov	eax, [esp+4]
		push	eax
		call	sub_10005160
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BB00	proc near		; CODE XREF: sub_1000BC30+1B9p
					; sub_1000CDC0+11Ej ...
		add	eax, 1FFFh	; switch 142 cases
		cmp	eax, 8Dh
		ja	short loc_1000BB5C ; jumptable 1000BB13	default	case
		movzx	eax, ds:byte_1000BB94[eax]
		jmp	ds:off_1000BB64[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000BB1A:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 7		; jumptable 1000BB13 cases -8190,-8187
		retn
; ---------------------------------------------------------------------------

loc_1000BB20:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 21h	; jumptable 1000BB13 case -8188
		retn
; ---------------------------------------------------------------------------

loc_1000BB26:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 150h	; jumptable 1000BB13 case -8189
		retn
; ---------------------------------------------------------------------------

loc_1000BB2C:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 5		; jumptable 1000BB13 case -8191
		retn
; ---------------------------------------------------------------------------

loc_1000BB32:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 2		; jumptable 1000BB13 case -8173
		retn
; ---------------------------------------------------------------------------

loc_1000BB38:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 0C0h	; jumptable 1000BB13 case -8182
		retn
; ---------------------------------------------------------------------------

loc_1000BB3E:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 62h	; jumptable 1000BB13 cases -8178,-8152
		retn
; ---------------------------------------------------------------------------

loc_1000BB44:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 0D1h	; jumptable 1000BB13 case -8050
		retn
; ---------------------------------------------------------------------------

loc_1000BB4A:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 70h	; jumptable 1000BB13 case -8144
		retn
; ---------------------------------------------------------------------------

loc_1000BB50:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 130h	; jumptable 1000BB13 case -8051
		retn
; ---------------------------------------------------------------------------

loc_1000BB56:				; CODE XREF: sub_1000BB00+13j
					; DATA XREF: .text:off_1000BB64o
		mov	eax, 6		; jumptable 1000BB13 case -8129
		retn
; ---------------------------------------------------------------------------

loc_1000BB5C:				; CODE XREF: sub_1000BB00+Aj
					; sub_1000BB00+13j
					; DATA XREF: ...
		mov	eax, 30h	; jumptable 1000BB13 default case
		retn
sub_1000BB00	endp

; ---------------------------------------------------------------------------
		align 4
off_1000BB64	dd offset loc_1000BB2C,	offset loc_1000BB1A, offset loc_1000BB26
					; DATA XREF: sub_1000BB00+13r
		dd offset loc_1000BB20,	offset loc_1000BB38, offset loc_1000BB3E ; jump	table for switch statement
		dd offset loc_1000BB32,	offset loc_1000BB4A, offset loc_1000BB56
		dd offset loc_1000BB50,	offset loc_1000BB44, offset loc_1000BB5C
byte_1000BB94	db	0,     1,     2,     3 ; DATA XREF: sub_1000BB00+Cr
		db	1,   0Bh,   0Bh,   0Bh ; indirect table	for switch statement
		db    0Bh,     4,   0Bh,   0Bh
		db    0Bh,     5,   0Bh,   0Bh
		db    0Bh,   0Bh,     6,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,     5
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,     7
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,     8,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db	9,   0Ah
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BC30	proc near		; CODE XREF: sub_1000C4C0+4C1p

var_28		= byte ptr -28h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		mov	eax, [esp+28h+arg_0]
		movzx	ecx, byte ptr [eax]
		movzx	edx, byte ptr [eax+1]
		and	cl, 0FEh
		and	dl, 0FEh
		mov	[esp+28h+var_24], cl
		movzx	ecx, byte ptr [eax+2]
		mov	[esp+28h+var_23], dl
		movzx	edx, byte ptr [eax+3]
		and	cl, 0FEh
		and	dl, 0FEh
		mov	[esp+28h+var_22], cl
		movzx	ecx, byte ptr [eax+4]
		mov	[esp+28h+var_21], dl
		movzx	edx, byte ptr [eax+5]
		push	esi
		and	cl, 0FEh
		and	dl, 0FEh
		mov	[esp+2Ch+var_20], cl
		movzx	ecx, byte ptr [eax+6]
		mov	[esp+2Ch+var_1F], dl
		movzx	edx, byte ptr [eax+7]
		push	1
		push	0
		lea	eax, [esp+34h+var_1C]
		and	cl, 0FEh
		and	dl, 0FEh
		push	0
		push	eax
		mov	[esp+3Ch+var_1C], 54B008C4h
		mov	[esp+3Ch+var_18], 0AEE0A10Bh
		mov	[esp+3Ch+var_C], 1C042CEFh
		mov	[esp+3Ch+var_8], 0E62F38E6h
		mov	[esp+3Ch+var_1E], cl
		mov	[esp+3Ch+var_1D], dl
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000BCE6
		lea	eax, [esi+2]
		pop	esi
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000BCE6:				; CODE XREF: sub_1000BC30+A1j
		push	edi
		push	8
		lea	ecx, [esp+34h+var_24]
		push	ecx
		push	8
		lea	edx, [esp+3Ch+var_28]
		push	edx
		lea	eax, [esp+40h+var_14]
		push	eax
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jnz	loc_1000BDE4
		movzx	ecx, [esp+30h+var_14]
		xor	cl, [esp+30h+var_24]
		movzx	edx, [esp+30h+var_13]
		xor	dl, [esp+30h+var_23]
		movzx	eax, [esp+30h+var_12]
		xor	al, [esp+30h+var_22]
		and	cl, 0Eh
		and	dl, 0FEh
		mov	[esp+30h+var_24], cl
		movzx	ecx, [esp+30h+var_11]
		xor	cl, [esp+30h+var_21]
		mov	[esp+30h+var_23], dl
		movzx	edx, [esp+30h+var_10]
		xor	dl, [esp+30h+var_20]
		and	al, 0Eh
		mov	[esp+30h+var_22], al
		movzx	eax, [esp+30h+var_F]
		xor	al, [esp+30h+var_1F]
		and	cl, 0FEh
		and	dl, 0Eh
		mov	[esp+30h+var_21], cl
		movzx	ecx, [esp+30h+var_E]
		xor	cl, [esp+30h+var_1E]
		mov	[esp+30h+var_20], dl
		movzx	edx, [esp+30h+var_D]
		xor	dl, [esp+30h+var_1D]
		push	1
		and	al, 0FEh
		push	edi
		mov	[esp+38h+var_1F], al
		lea	eax, [esp+38h+var_C]
		and	cl, 0Eh
		and	dl, 0FEh
		push	edi
		push	eax
		mov	[esp+40h+var_1E], cl
		mov	[esp+40h+var_1D], dl
		call	sub_10020F20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000BDBE
		lea	eax, [edi+2]
		pop	edi
		pop	esi
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000BDBE:				; CODE XREF: sub_1000BC30+178j
		push	8
		lea	ecx, [esp+34h+var_24]
		push	ecx
		push	8
		lea	edx, [esp+3Ch+var_28]
		push	edx
		push	ebx
		push	esi
		call	sub_10020F80
		push	1
		push	esi
		mov	edi, eax
		call	sub_10020F50
		add	esp, 20h
		test	edi, edi
		jz	short loc_1000BDFF

loc_1000BDE4:				; CODE XREF: sub_1000BC30+DFj
		call	PORT_GetError_Util
		call	sub_1000BB00
		pop	edi
		pop	esi
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000BDFF:				; CODE XREF: sub_1000BC30+1B2j
		push	8
		push	ebx
		call	sub_10007C70
		mov	ecx, [esp+38h+var_4]
		add	esp, 8
		pop	edi
		pop	esi
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
sub_1000BC30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BE20	proc near		; CODE XREF: sub_10003DB0+38p
					; sub_10010A50+Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	esi
		call	sub_10007E90
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000BE3D

loc_1000BE35:				; CODE XREF: sub_1000BE20+2Aj
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000BE3D:				; CODE XREF: sub_1000BE20+13j
		push	esi
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1000BE35
		mov	eax, [esp+8+arg_4]
		push	edi
		push	esi
		push	eax
		call	sub_10017DA0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1000BE73
		push	esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 82h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000BE73:				; CODE XREF: sub_1000BE20+3Fj
		cmp	dword ptr [ebx+24h], 0
		jnz	short loc_1000BEA6
		cmp	dword ptr [ebx+2Ch], 0
		jz	short loc_1000BEA6
		push	2
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000BEA6
		push	esi
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		mov	eax, 101h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000BEA6:				; CODE XREF: sub_1000BE20+57j
					; sub_1000BE20+5Dj ...
		test	byte ptr [esi+20h], 2
		jnz	short loc_1000BED3
		push	1
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000BED3
		push	esi
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		mov	eax, 0B5h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000BED3:				; CODE XREF: sub_1000BE20+8Aj
					; sub_1000BE20+99j
		push	edi
		push	esi
		call	sub_10016E50
		push	esi
		call	sub_100177F0
		push	edi
		call	sub_10016D30
		add	esp, 10h
		neg	eax
		sbb	eax, eax
		pop	edi
		and	eax, 0FFFFFFD0h
		pop	esi
		add	eax, 30h
		pop	ebx
		retn
sub_1000BE20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BF00	proc near		; CODE XREF: sub_1000BFA0+6p
					; sub_1000BFA0+12p ...
		cmp	eax, 220h
		ja	short loc_1000BF1C
		jz	short loc_1000BF16 ; jumptable 1000BF0F	case 0
		dec	eax
		cmp	eax, 4		; switch 5 cases
		ja	short loc_1000BF4C ; jumptable 1000BF0F	default	case
		jmp	ds:off_1000BF50[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000BF16:				; CODE XREF: sub_1000BF00+7j
					; sub_1000BF00+Fj
					; DATA XREF: ...
		mov	eax, 3		; jumptable 1000BF0F case 0
		retn
; ---------------------------------------------------------------------------

loc_1000BF1C:				; CODE XREF: sub_1000BF00+5j
		add	eax, 0FFFFFDB0h	; switch 33 cases
		cmp	eax, 20h
		ja	short loc_1000BF4C ; jumptable 1000BF0F	default	case
		movzx	eax, ds:byte_1000BF78[eax]
		jmp	ds:off_1000BF64[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000BF34:				; CODE XREF: sub_1000BF00+Fj
					; sub_1000BF00+2Dj
					; DATA XREF: ...
		mov	eax, 7		; jumptable 1000BF0F case 4
					; jumptable 1000BF2D case 597
		retn
; ---------------------------------------------------------------------------

loc_1000BF3A:				; CODE XREF: sub_1000BF00+Fj
					; sub_1000BF00+2Dj
					; DATA XREF: ...
		mov	eax, 4		; jumptable 1000BF0F case 1
					; jumptable 1000BF2D case 592
		retn
; ---------------------------------------------------------------------------

loc_1000BF40:				; CODE XREF: sub_1000BF00+Fj
					; sub_1000BF00+2Dj
					; DATA XREF: ...
		mov	eax, 5		; jumptable 1000BF0F case 2
					; jumptable 1000BF2D case 608
		retn
; ---------------------------------------------------------------------------

loc_1000BF46:				; CODE XREF: sub_1000BF00+Fj
					; sub_1000BF00+2Dj
					; DATA XREF: ...
		mov	eax, 6		; jumptable 1000BF0F case 3
					; jumptable 1000BF2D case 624
		retn
; ---------------------------------------------------------------------------

loc_1000BF4C:				; CODE XREF: sub_1000BF00+Dj
					; sub_1000BF00+24j ...
		xor	eax, eax	; jumptable 1000BF0F default case
		retn
sub_1000BF00	endp

; ---------------------------------------------------------------------------
		align 10h
off_1000BF50	dd offset loc_1000BF16	; DATA XREF: sub_1000BF00+Fr
		dd offset loc_1000BF3A	; jump table for switch	statement
		dd offset loc_1000BF40
		dd offset loc_1000BF46
		dd offset loc_1000BF34
off_1000BF64	dd offset loc_1000BF3A	; DATA XREF: sub_1000BF00+2Dr
		dd offset loc_1000BF34	; jump table for switch	statement
		dd offset loc_1000BF40
		dd offset loc_1000BF46
		dd offset loc_1000BF4C
byte_1000BF78	db	0,     4,     4,     4 ; DATA XREF: sub_1000BF00+26r
		db	4,     1,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	2,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BFA0	proc near		; CODE XREF: sub_10012FD0+447p
					; sub_10013A30+40Dp
		test	ecx, ecx
		jz	short loc_1000BFC1
		mov	eax, [ecx]
		call	sub_1000BF00
		test	eax, eax
		jz	short loc_1000BFC1
		mov	eax, [ecx+4]
		call	sub_1000BF00
		test	eax, eax
		jz	short loc_1000BFC1
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1000BFC1:				; CODE XREF: sub_1000BFA0+2j
					; sub_1000BFA0+Dj ...
		xor	eax, eax
		retn
sub_1000BFA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BFD0	proc near		; CODE XREF: sub_1000C4C0+128p
		test	ecx, ecx
		jz	short loc_1000C00D
		cmp	dword ptr [ecx+8], 1
		jnz	short loc_1000C00D
		mov	eax, [ecx]
		call	sub_1000BF00
		test	eax, eax
		jz	short loc_1000C00D
		mov	eax, [ecx+4]
		call	sub_1000BF00
		test	eax, eax
		jz	short loc_1000C00D
		mov	eax, [ecx+10h]
		test	eax, eax
		jnz	short loc_1000C001
		cmp	[ecx+0Ch], eax
		jnz	short loc_1000C00D
		test	eax, eax
		jz	short loc_1000C007

loc_1000C001:				; CODE XREF: sub_1000BFD0+26j
		cmp	dword ptr [ecx+0Ch], 0
		jz	short loc_1000C00D

loc_1000C007:				; CODE XREF: sub_1000BFD0+2Fj
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1000C00D:				; CODE XREF: sub_1000BFD0+2j
					; sub_1000BFD0+8j ...
		xor	eax, eax
		retn
sub_1000BFD0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C010	proc near		; CODE XREF: sub_1000C4C0+834p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		cmp	eax, 6		; switch 7 cases
		ja	short locret_1000C043 ;	jumptable 1000C019 default case
		jmp	ds:off_1000C044[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000C020:				; CODE XREF: sub_1000C010+9j
					; DATA XREF: .text:off_1000C044o
		mov	eax, [esp+arg_8] ; jumptable 1000C019 cases 0,1
		mov	ecx, [esp+arg_0]
		mov	[ecx+38h], eax
		retn
; ---------------------------------------------------------------------------

loc_1000C02C:				; CODE XREF: sub_1000C010+9j
					; DATA XREF: .text:off_1000C044o
		mov	edx, [esp+arg_8] ; jumptable 1000C019 case 2
		mov	eax, [esp+arg_0]
		mov	[eax+3Ch], edx
		retn
; ---------------------------------------------------------------------------

loc_1000C038:				; CODE XREF: sub_1000C010+9j
					; DATA XREF: .text:off_1000C044o
		mov	ecx, [esp+arg_8] ; jumptable 1000C019 cases 3-6
		mov	edx, [esp+arg_0]
		mov	[edx+3Ch], ecx

locret_1000C043:			; CODE XREF: sub_1000C010+7j
		retn			; jumptable 1000C019 default case
sub_1000C010	endp

; ---------------------------------------------------------------------------
off_1000C044	dd offset loc_1000C020	; DATA XREF: sub_1000C010+9r
		dd offset loc_1000C020	; jump table for switch	statement
		dd offset loc_1000C02C
		dd offset loc_1000C038
		dd offset loc_1000C038
		dd offset loc_1000C038
		dd offset loc_1000C038

; =============== S U B	R O U T	I N E =======================================


sub_1000C060	proc near		; CODE XREF: sub_1000C4C0+98p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebp
		mov	ebp, [esp+4+arg_4]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		cmp	ebx, 6		; switch 7 cases
		ja	short loc_1000C08C ; jumptable 1000C070	default	case
		jmp	ds:off_1000C17C[ebx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000C077:				; CODE XREF: sub_1000C060+10j
					; DATA XREF: .text:off_1000C17Co
		mov	eax, [ecx+38h]	; jumptable 1000C070 cases 0,1
		jmp	short loc_1000C07F
; ---------------------------------------------------------------------------

loc_1000C07C:				; CODE XREF: sub_1000C060+10j
					; DATA XREF: .text:off_1000C17Co
		mov	eax, [ecx+3Ch]	; jumptable 1000C070 cases 2-6

loc_1000C07F:				; CODE XREF: sub_1000C060+1Aj
		cmp	eax, edi
		jz	short loc_1000C08C ; jumptable 1000C070	default	case
		pop	edi
		pop	esi
		mov	eax, 90h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C08C:				; CODE XREF: sub_1000C060+Ej
					; sub_1000C060+21j
		cmp	ebp, edi	; jumptable 1000C070 default case
		jz	loc_1000C129
		mov	eax, [esp+0Ch+arg_8]
		push	ecx
		push	eax
		call	sub_10017DA0
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_1000C0B1
		pop	edi
		pop	esi
		mov	eax, 60h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C0B1:				; CODE XREF: sub_1000C060+46j
		mov	eax, [esi+8]
		cmp	eax, 4
		jz	short loc_1000C0BF
		cmp	eax, [esp+0Ch+arg_10]
		jnz	short loc_1000C0D1

loc_1000C0BF:				; CODE XREF: sub_1000C060+57j
		mov	ecx, [esp+0Ch+arg_14]
		push	ecx
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000C0E3

loc_1000C0D1:				; CODE XREF: sub_1000C060+5Dj
					; sub_1000C060+93j
		push	esi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 63h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C0E3:				; CODE XREF: sub_1000C060+6Fj
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		cmp	eax, edi
		jz	short loc_1000C0D1
		cmp	dword ptr [eax+1Ch], 4
		push	eax
		jz	short loc_1000C113
		call	sub_10015D70
		push	esi
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		mov	eax, 13h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C113:				; CODE XREF: sub_1000C060+9Aj
		mov	edx, [eax+18h]
		mov	ecx, [edx]
		mov	edx, [esp+10h+arg_C]
		mov	[edx], ecx
		call	sub_10015D70
		add	esp, 4
		mov	[ebp+0], esi

loc_1000C129:				; CODE XREF: sub_1000C060+2Ej
		push	6Ch
		call	PORT_Alloc_Util
		add	esp, 4
		cmp	eax, edi
		jnz	short loc_1000C14D
		cmp	esi, edi
		jz	short loc_1000C144
		push	esi
		call	sub_10016D30
		add	esp, 4

loc_1000C144:				; CODE XREF: sub_1000C060+D9j
		pop	edi
		pop	esi
		mov	eax, 2
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C14D:				; CODE XREF: sub_1000C060+D5j
		mov	ecx, [esp+0Ch+arg_0]
		mov	[eax+8], edi
		mov	[eax+3Ch], edi
		mov	[eax+40h], edi
		mov	[eax+0Ch], edi
		mov	[eax+14h], edi
		mov	[eax+10h], edi
		mov	[eax+64h], edi
		mov	[eax+68h], esi
		pop	edi
		mov	[eax], ebx
		mov	dword ptr [eax+4], 1
		pop	esi
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
sub_1000C060	endp

; ---------------------------------------------------------------------------
		align 4
off_1000C17C	dd offset loc_1000C077	; DATA XREF: sub_1000C060+10r
		dd offset loc_1000C077	; jump table for switch	statement
		dd offset loc_1000C07C
		dd offset loc_1000C07C
		dd offset loc_1000C07C
		dd offset loc_1000C07C
		dd offset loc_1000C07C
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C1A0	proc near		; CODE XREF: sub_1000C4C0+725p
		add	eax, 0FFFFEF7Fh	; switch 9 cases
		cmp	eax, 8
		ja	short loc_1000C1CC ; jumptable 1000C1AA	default	case
		jmp	ds:off_1000C1D0[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000C1B1:				; CODE XREF: sub_1000C1A0+Aj
					; DATA XREF: .text:off_1000C1D0o
		mov	eax, 1		; jumptable 1000C1AA cases 4226,4229
		retn
; ---------------------------------------------------------------------------

loc_1000C1B7:				; CODE XREF: sub_1000C1A0+Aj
					; DATA XREF: .text:off_1000C1D0o
		xor	eax, eax	; jumptable 1000C1AA case 4225
		retn
; ---------------------------------------------------------------------------

loc_1000C1BA:				; CODE XREF: sub_1000C1A0+Aj
					; DATA XREF: .text:off_1000C1D0o
		mov	eax, 2		; jumptable 1000C1AA case 4233
		retn
; ---------------------------------------------------------------------------

loc_1000C1C0:				; CODE XREF: sub_1000C1A0+Aj
					; DATA XREF: .text:off_1000C1D0o
		mov	eax, 3		; jumptable 1000C1AA case 4230
		retn
; ---------------------------------------------------------------------------

loc_1000C1C6:				; CODE XREF: sub_1000C1A0+Aj
					; DATA XREF: .text:off_1000C1D0o
		mov	eax, 4		; jumptable 1000C1AA case 4231
		retn
; ---------------------------------------------------------------------------

loc_1000C1CC:				; CODE XREF: sub_1000C1A0+8j
					; sub_1000C1A0+Aj
					; DATA XREF: ...
		or	eax, 0FFFFFFFFh	; jumptable 1000C1AA default case
		retn
sub_1000C1A0	endp

; ---------------------------------------------------------------------------
off_1000C1D0	dd offset loc_1000C1B7	; DATA XREF: sub_1000C1A0+Ar
		dd offset loc_1000C1B1	; jump table for switch	statement
		dd offset loc_1000C1CC
		dd offset loc_1000C1CC
		dd offset loc_1000C1B1
		dd offset loc_1000C1C0
		dd offset loc_1000C1C6
		dd offset loc_1000C1CC
		dd offset loc_1000C1BA
		align 10h

loc_1000C200:				; DATA XREF: sub_1000C4C0+23Eo
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000C21B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000C21B:				; CODE XREF: .text:1000C208j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100227A0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000C25D
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000C25D
		mov	dword_10029554,	1

loc_1000C25D:				; CODE XREF: .text:1000C245j
					; .text:1000C251j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000C270:				; DATA XREF: sub_1000C4C0+289o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000C28B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000C28B:				; CODE XREF: .text:1000C278j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100227E0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000C2CD
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000C2CD
		mov	dword_10029554,	1

loc_1000C2CD:				; CODE XREF: .text:1000C2B5j
					; .text:1000C2C1j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000C2E0:				; DATA XREF: sub_1000C4C0+245o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000C2FB
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000C2FB:				; CODE XREF: .text:1000C2E8j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100228A0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000C33D
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000C33D
		mov	dword_10029554,	1

loc_1000C33D:				; CODE XREF: .text:1000C325j
					; .text:1000C331j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000C350:				; DATA XREF: sub_1000C4C0+290o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000C36B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000C36B:				; CODE XREF: .text:1000C358j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100228E0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000C3AD
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000C3AD
		mov	dword_10029554,	1

loc_1000C3AD:				; CODE XREF: .text:1000C395j
					; .text:1000C3A1j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000C3C0:				; DATA XREF: sub_1000C4C0:loc_1000C652o
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax+4]
		cmp	dword ptr [esi+4], 1
		jz	short loc_1000C3E0
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000C3E0:				; CODE XREF: .text:1000C3CCj
		mov	ecx, [eax]
		mov	eax, [ecx]
		push	edi
		call	sub_1000BF00
		mov	edx, eax
		mov	eax, [ecx+4]
		call	sub_1000BF00
		mov	edi, [esp+20h]
		push	edi
		mov	edi, [esp+20h]
		push	edi
		mov	edi, [esp+20h]
		push	edi
		mov	edi, [esp+20h]
		push	edi
		mov	edi, [esp+20h]
		push	edi
		mov	edi, [ecx+10h]
		mov	ecx, [ecx+0Ch]
		push	0
		push	0
		push	edi
		push	ecx
		push	eax
		push	edx
		add	esi, 8
		push	esi
		call	sub_10022820
		add	esp, 30h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000C430:				; DATA XREF: sub_1000C4C0+1C8o
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax+4]
		cmp	dword ptr [esi+4], 1
		jz	short loc_1000C450
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000C450:				; CODE XREF: .text:1000C43Cj
		mov	ecx, [eax]
		mov	eax, [ecx]
		push	ebx
		call	sub_1000BF00
		mov	edx, eax
		mov	eax, [ecx+4]
		call	sub_1000BF00
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [ecx+10h]
		mov	ecx, [ecx+0Ch]
		push	ebx
		push	ecx
		push	eax
		push	edx
		add	esi, 8
		push	esi
		call	sub_10022860
		add	esp, 28h
		mov	esi, eax
		pop	ebx
		test	esi, esi
		jz	short loc_1000C4B0
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000C4B0
		mov	dword_10029554,	1

loc_1000C4B0:				; CODE XREF: .text:1000C498j
					; .text:1000C4A4j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C4C0	proc near		; CODE XREF: sub_1000CD90+1Bp
					; sub_1000D240+1Bp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		mov	eax, [esp+38h+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+40h+arg_10]
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, ecx
		mov	ecx, [edi]
		push	eax
		xor	ebx, ebx
		push	ecx
		mov	[esp+50h+var_24], ebp
		mov	[esp+50h+var_38], ebx
		mov	[esp+50h+var_2C], ebx
		call	sub_10008870
		add	esp, 8
		mov	[esp+48h+var_38], eax
		cmp	eax, ebx
		jnz	loc_1000CD04
		push	esi
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		mov	[esp+48h+var_28], esi
		cmp	esi, ebx
		jnz	short loc_1000C52F
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000C52F:				; CODE XREF: sub_1000C4C0+55j
		mov	edx, [esp+48h+arg_8]
		mov	ebx, [esp+48h+arg_C]
		push	edx
		mov	edx, [esp+4Ch+arg_0]
		mov	eax, ebp
		neg	eax
		sbb	eax, eax
		add	eax, 3
		push	eax
		lea	ecx, [esp+50h+var_30]
		push	ecx
		push	edx
		lea	eax, [esp+58h+var_34]
		push	eax
		lea	ecx, [esp+5Ch+var_20]
		push	ecx
		mov	ecx, esi
		call	sub_1000C060
		add	esp, 18h
		mov	[esp+48h+var_38], eax
		test	eax, eax
		jz	short loc_1000C588
		push	esi
		call	sub_100177F0
		mov	eax, [esp+4Ch+var_38]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000C588:				; CODE XREF: sub_1000C4C0+A6j
		mov	esi, [esp+48h+var_20]
		xor	ebx, ebx
		mov	[esi+0Ch], ebx
		mov	eax, [edi]
		cmp	eax, 102h
		ja	loc_1000C764
		cmp	eax, 101h
		jnb	loc_1000C79E
		mov	edx, 1
		sub	eax, edx
		jz	loc_1000C6BA
		sub	eax, 2
		jz	loc_1000C6BA
		sub	eax, 6
		jnz	loc_1000CC39	; jumptable 1000C794 default case
		cmp	[esp+48h+var_30], ebx
		jz	short loc_1000C5DB

loc_1000C5CE:				; CODE XREF: sub_1000C4C0+1FEj
					; sub_1000C4C0+2EAj ...
		mov	[esp+48h+var_38], 63h
		jmp	loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000C5DB:				; CODE XREF: sub_1000C4C0+10Cj
		cmp	dword ptr [edi+8], 14h
		jnz	loc_1000C6AD
		mov	ecx, [edi+4]
		call	sub_1000BFD0
		test	eax, eax
		jz	loc_1000C6AD
		mov	[esi+4], ebx
		push	8
		mov	[esi+8], edx
		call	PORT_Alloc_Util
		add	esp, 4
		cmp	ebp, ebx
		mov	ebx, eax
		jz	short loc_1000C664
		test	ebx, ebx
		jnz	short loc_1000C61C

loc_1000C60F:				; CODE XREF: sub_1000C4C0+1A6j
					; sub_1000C4C0+342j ...
		mov	[esp+48h+var_38], 2
		jmp	loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000C61C:				; CODE XREF: sub_1000C4C0+14Dj
		mov	ecx, [esp+48h+var_34]
		mov	edx, [edi+4]
		lea	eax, [esp+48h+var_38]
		push	eax
		push	0
		push	ecx
		mov	[ebx], edx
		call	sub_100072C0
		add	esp, 0Ch
		mov	[ebx+4], eax
		test	eax, eax
		jnz	short loc_1000C652

loc_1000C63C:				; CODE XREF: sub_1000C4C0+1C6j
		push	ebx
		call	PORT_Free_Util
		add	esp, 4

loc_1000C645:				; CODE XREF: sub_1000C4C0+226j
					; sub_1000C4C0+271j ...
		mov	[esp+48h+var_38], 60h
		jmp	loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000C652:				; CODE XREF: sub_1000C4C0+17Aj
		mov	dword ptr [esi+4Ch], offset loc_1000C3C0
		mov	edx, [ebx+4]
		push	edx
		call	sub_100051A0
		jmp	short loc_1000C698
; ---------------------------------------------------------------------------

loc_1000C664:				; CODE XREF: sub_1000C4C0+149j
		test	ebx, ebx
		jz	short loc_1000C60F
		mov	edx, [esp+48h+var_34]
		mov	eax, [edi+4]
		lea	ecx, [esp+48h+var_38]
		push	ecx
		push	0
		push	edx
		mov	[ebx], eax
		call	sub_10007C20
		add	esp, 0Ch
		mov	[ebx+4], eax
		test	eax, eax
		jz	short loc_1000C63C
		mov	dword ptr [esi+4Ch], offset loc_1000C430
		mov	eax, [ebx+4]
		push	eax
		call	sub_100051C0

loc_1000C698:				; CODE XREF: sub_1000C4C0+1A2j
		mov	[esi+64h], eax
		mov	[esi+3Ch], ebx
		add	esp, 4
		mov	dword ptr [esi+58h], offset loc_1001D810
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C6AD:				; CODE XREF: sub_1000C4C0+11Fj
					; sub_1000C4C0+12Fj ...
		mov	[esp+48h+var_38], 71h
		jmp	loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000C6BA:				; CODE XREF: sub_1000C4C0+F0j
					; sub_1000C4C0+F9j
		cmp	[esp+48h+var_30], ebx
		jnz	loc_1000C5CE
		mov	[esi+4], ebx
		mov	[esi+8], edx
		cmp	ebp, ebx
		jz	short loc_1000C719
		mov	edx, [esp+48h+var_34]
		lea	ecx, [esp+48h+var_38]
		push	ecx
		push	0
		push	edx
		call	sub_100072C0
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_1000C645
		push	ebx
		call	sub_100051A0
		mov	[esi+64h], eax
		add	esp, 4
		mov	[esi+3Ch], ebx
		cmp	dword ptr [edi], 3
		mov	eax, offset loc_1000C200
		jz	short loc_1000C755
		mov	eax, offset loc_1000C2E0
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset nullsub_1
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C719:				; CODE XREF: sub_1000C4C0+20Cj
		mov	ecx, [esp+48h+var_34]
		lea	eax, [esp+48h+var_38]
		push	eax
		push	0
		push	ecx
		call	sub_10007C20
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_1000C645
		push	ebx
		call	sub_100051C0
		mov	[esi+64h], eax
		add	esp, 4
		mov	[esi+3Ch], ebx
		cmp	dword ptr [edi], 3
		mov	eax, offset loc_1000C270
		jz	short loc_1000C755
		mov	eax, offset loc_1000C350

loc_1000C755:				; CODE XREF: sub_1000C4C0+243j
					; sub_1000C4C0+28Ej
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset nullsub_1
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C764:				; CODE XREF: sub_1000C4C0+D8j
		mov	ecx, 10h
		cmp	eax, 551h
		ja	loc_1000CA10
		jz	loc_1000CA60
		sub	eax, 105h	; switch 65 cases
		cmp	eax, 40h
		ja	loc_1000CC39	; jumptable 1000C794 default case
		movzx	edx, ds:byte_1000CD44[eax]
		mov	ecx, 1
		jmp	ds:off_1000CD18[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000C79B:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	[esi+0Ch], ecx	; jumptable 1000C794 case 261

loc_1000C79E:				; CODE XREF: sub_1000C4C0+E3j
		cmp	[esp+48h+var_30], 11h
		mov	dword ptr [esi+10h], 8
		jnz	loc_1000C5CE
		mov	eax, [esp+48h+var_34]
		push	11h
		push	eax
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000C645
		mov	ecx, [edi+4]
		mov	eax, [ecx]
		add	eax, 7
		shr	eax, 3
		xor	edx, edx
		cmp	dword ptr [edi], 101h
		push	eax
		mov	eax, [ebx+1Ch]
		setnz	dl
		add	ecx, 4
		push	edx
		push	ecx
		mov	ecx, [ebx+18h]
		push	eax
		push	ecx
		call	sub_10020E60
		push	ebx
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 18h
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		mov	eax, offset sub_10020EC0
		test	ebp, ebp
		jnz	short loc_1000C816
		mov	eax, offset sub_10020EF0

loc_1000C816:				; CODE XREF: sub_1000C4C0+34Fj
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset sub_10020E90
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C825:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		cmp	[esp+48h+var_30], 12h ;	jumptable 1000C794 case	273
		jnz	loc_1000C5CE
		mov	edx, [esp+48h+var_34]
		push	11h
		push	edx
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebx
		jz	loc_1000C645
		mov	eax, [edi+1Ch]
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		call	sub_10020DA0
		push	edi
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 0Ch
		cmp	[esi+3Ch], ebx
		jz	loc_1000C60F
		mov	eax, offset sub_10020E00
		cmp	ebp, ebx
		jnz	short loc_1000C879
		mov	eax, offset sub_10020E30

loc_1000C879:				; CODE XREF: sub_1000C4C0+3B2j
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset sub_10020DD0
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C888:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	[esi+0Ch], ecx	; jumptable 1000C794 case 325

loc_1000C88B:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		cmp	[esp+48h+var_30], 1Eh ;	jumptable 1000C794 cases 321,322
		jnz	loc_1000C5CE
		xor	edx, edx
		cmp	dword ptr [edi], 141h
		setnz	dl
		mov	ebp, edx
		cmp	[esp+48h+var_38], ebx
		jnz	loc_1000CCBF
		jmp	short loc_1000C903
; ---------------------------------------------------------------------------

loc_1000C8AF:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		cmp	[esp+48h+var_30], 13h ;	jumptable 1000C794 case	289
		jnz	loc_1000C5CE
		xor	ebp, ebp
		jmp	short loc_1000C903
; ---------------------------------------------------------------------------

loc_1000C8BE:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	[esi+0Ch], ecx	; jumptable 1000C794 case 293

loc_1000C8C1:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		cmp	[esp+48h+var_30], 13h ;	jumptable 1000C794 case	290
		jnz	loc_1000C5CE
		mov	ebp, ecx
		jmp	short loc_1000C903
; ---------------------------------------------------------------------------

loc_1000C8D0:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	eax, [esp+48h+var_30] ;	jumptable 1000C794 case	306
		cmp	eax, 14h
		jz	short loc_1000C8E2
		cmp	eax, 15h
		jnz	loc_1000C5CE

loc_1000C8E2:				; CODE XREF: sub_1000C4C0+417j
		mov	ebp, 2
		jmp	short loc_1000C903
; ---------------------------------------------------------------------------

loc_1000C8E9:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	[esi+0Ch], ecx	; jumptable 1000C794 case 310

loc_1000C8EC:				; CODE XREF: sub_1000C4C0+2D4j
					; DATA XREF: .text:off_1000CD18o
		mov	eax, [esp+48h+var_30] ;	jumptable 1000C794 case	307
		cmp	eax, 14h
		jz	short loc_1000C8FE
		cmp	eax, 15h
		jnz	loc_1000C5CE

loc_1000C8FE:				; CODE XREF: sub_1000C4C0+433j
		mov	ebp, 3

loc_1000C903:				; CODE XREF: sub_1000C4C0+3EDj
					; sub_1000C4C0+3FCj ...
		mov	eax, [esp+48h+var_34]
		push	11h
		push	eax
		mov	dword ptr [esi+10h], 8
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		mov	[esp+48h+var_34], ebx
		test	ebx, ebx
		jz	loc_1000C645
		mov	eax, [esp+48h+var_30]
		cmp	eax, 14h
		jnz	short loc_1000C972
		cmp	ebp, 3
		jz	short loc_1000C93A
		cmp	ebp, 2
		jnz	short loc_1000C9A3

loc_1000C93A:				; CODE XREF: sub_1000C4C0+473j
		mov	eax, [ebx+18h]
		mov	ecx, [eax]
		mov	[esp+48h+var_1C], ecx
		mov	edx, [eax+4]
		mov	[esp+48h+var_18], edx
		mov	ebx, [eax+8]
		mov	[esp+48h+var_14], ebx
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_10], eax
		mov	[esp+48h+var_C], ecx
		mov	[esp+48h+var_8], edx

loc_1000C960:				; CODE XREF: sub_1000C4C0+4CFj
		mov	ebx, [esp+48h+var_34]
		mov	[esp+48h+var_2C], 1
		lea	eax, [esp+48h+var_1C]
		jmp	short loc_1000C9A6
; ---------------------------------------------------------------------------

loc_1000C972:				; CODE XREF: sub_1000C4C0+46Ej
		cmp	eax, 1Eh
		jnz	short loc_1000C9A3
		mov	ecx, ebx
		mov	edx, [ecx+18h]
		push	edx
		lea	ebx, [esp+4Ch+var_1C]
		call	sub_1000BC30
		add	esp, 4
		mov	[esp+48h+var_38], eax
		test	eax, eax
		jz	short loc_1000C960
		mov	eax, [esp+48h+var_34]
		push	eax
		call	sub_10015D70
		add	esp, 4
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000C9A3:				; CODE XREF: sub_1000C4C0+478j
					; sub_1000C4C0+4B5j
		mov	eax, [ebx+18h]

loc_1000C9A6:				; CODE XREF: sub_1000C4C0+4B0j
		mov	ecx, [esp+48h+var_24]
		mov	edx, [edi+4]
		push	ecx
		push	ebp
		push	edx
		push	eax
		call	sub_10020F20
		add	esp, 10h
		cmp	[esp+48h+var_2C], 0
		mov	[esi+3Ch], eax
		jz	short loc_1000C9DD
		xor	eax, eax
		mov	[esp+48h+var_1C], eax
		mov	[esp+48h+var_18], eax
		mov	[esp+48h+var_14], eax
		mov	[esp+48h+var_10], eax
		mov	[esp+48h+var_C], eax
		mov	[esp+48h+var_8], eax

loc_1000C9DD:				; CODE XREF: sub_1000C4C0+501j
		push	ebx
		call	sub_10015D70
		add	esp, 4
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		cmp	[esp+48h+var_24], 0
		mov	eax, offset sub_10020F80
		jnz	short loc_1000CA01
		mov	eax, offset sub_10020FB0

loc_1000CA01:				; CODE XREF: sub_1000C4C0+53Aj
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset sub_10020F50
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000CA10:				; CODE XREF: sub_1000C4C0+2AEj
		cmp	eax, 1082h
		ja	loc_1000CB75
		cmp	eax, 1081h
		jnb	loc_1000CBAA
		cmp	eax, 651h
		ja	loc_1000CAD8
		jz	loc_1000CB01
		sub	eax, 552h
		jz	short loc_1000CA4E
		sub	eax, 3
		jnz	loc_1000CC39	; jumptable 1000C794 default case
		mov	dword ptr [esi+0Ch], 1

loc_1000CA4E:				; CODE XREF: sub_1000C4C0+57Cj
		cmp	[edi+4], ebx
		jz	loc_1000C6AD
		cmp	[edi+8], ecx
		jnz	loc_1000C6AD

loc_1000CA60:				; CODE XREF: sub_1000C4C0+2B4j
		cmp	[esp+48h+var_30], 25h
		mov	[esi+10h], ecx
		jnz	loc_1000C5CE
		mov	eax, [esp+48h+var_34]
		push	11h
		push	eax
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000C645
		mov	ecx, [ebx+1Ch]
		mov	eax, [edi+4]
		xor	edx, edx
		cmp	dword ptr [edi], 551h
		push	ecx
		mov	ecx, [ebx+18h]
		setnz	dl
		push	ebp
		push	edx
		push	eax
		push	ecx
		call	sub_100221D0
		push	ebx
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 18h
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		mov	eax, offset loc_10022240
		test	ebp, ebp
		jnz	short loc_1000CAC9
		mov	eax, offset loc_10022280

loc_1000CAC9:				; CODE XREF: sub_1000C4C0+602j
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset loc_10022210
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000CAD8:				; CODE XREF: sub_1000C4C0+56Bj
		sub	eax, 652h
		jz	short loc_1000CAEF
		sub	eax, 3
		jnz	loc_1000CC39	; jumptable 1000C794 default case
		mov	dword ptr [esi+0Ch], 1

loc_1000CAEF:				; CODE XREF: sub_1000C4C0+61Dj
		cmp	[edi+4], ebx
		jz	loc_1000C6AD
		cmp	[edi+8], ecx
		jnz	loc_1000C6AD

loc_1000CB01:				; CODE XREF: sub_1000C4C0+571j
		cmp	[esp+48h+var_30], 26h
		mov	[esi+10h], ecx
		jnz	loc_1000C5CE
		mov	edx, [esp+48h+var_34]
		push	11h
		push	edx
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000C645
		mov	ecx, [edi+4]
		mov	edx, [ebx+18h]
		xor	eax, eax
		cmp	dword ptr [edi], 651h
		push	ebp
		setnz	al
		push	eax
		push	ecx
		push	edx
		call	sub_10020FE0
		push	ebx
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 14h
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		mov	eax, offset loc_10021050
		test	ebp, ebp
		jnz	short loc_1000CB66
		mov	eax, offset loc_10021090

loc_1000CB66:				; CODE XREF: sub_1000C4C0+69Fj
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset loc_10021020
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000CB75:				; CODE XREF: sub_1000C4C0+555j
		cmp	eax, 1089h
		ja	loc_1000CC2B
		jz	short loc_1000CBAD
		cmp	eax, 1085h
		jz	short loc_1000CBA3
		jbe	loc_1000CC39	; jumptable 1000C794 default case
		cmp	eax, 1087h
		jbe	short loc_1000CBAD
		mov	[esp+48h+var_38], 70h
		jmp	loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000CBA3:				; CODE XREF: sub_1000C4C0+6C7j
		mov	dword ptr [esi+0Ch], 1

loc_1000CBAA:				; CODE XREF: sub_1000C4C0+560j
		mov	[esi+10h], ecx

loc_1000CBAD:				; CODE XREF: sub_1000C4C0+6C0j
					; sub_1000C4C0+6D4j
		cmp	dword ptr [edi], 1087h
		jnz	short loc_1000CBB8
		mov	[esi+4], ebx

loc_1000CBB8:				; CODE XREF: sub_1000C4C0+6F3j
		cmp	[esp+48h+var_30], 1Fh
		jnz	loc_1000C5CE
		mov	eax, [esp+48h+var_34]
		push	11h
		push	eax
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000C645
		mov	ecx, [ebx+1Ch]
		mov	eax, [edi]
		push	10h
		push	ecx
		push	ebp
		call	sub_1000C1A0
		mov	edx, [edi+4]
		push	eax
		mov	eax, [ebx+18h]
		push	edx
		push	eax
		call	sub_100210D0
		push	ebx
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 1Ch
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		mov	eax, offset sub_10021130
		test	ebp, ebp
		jnz	short loc_1000CC1C
		mov	eax, offset sub_10021170

loc_1000CC1C:				; CODE XREF: sub_1000C4C0+755j
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset sub_10021100
		jmp	loc_1000CCB8
; ---------------------------------------------------------------------------

loc_1000CC2B:				; CODE XREF: sub_1000C4C0+6BAj
		cmp	eax, 0CE534351h
		jz	short loc_1000CC4A
		cmp	eax, 0CE534352h
		jz	short loc_1000CC43

loc_1000CC39:				; CODE XREF: sub_1000C4C0+102j
					; sub_1000C4C0+2C2j ...
		mov	[esp+48h+var_38], 70h ;	jumptable 1000C794 default case
		jmp	short loc_1000CCBF
; ---------------------------------------------------------------------------

loc_1000CC43:				; CODE XREF: sub_1000C4C0+777j
		mov	dword ptr [esi+0Ch], 1

loc_1000CC4A:				; CODE XREF: sub_1000C4C0+770j
		cmp	[esp+48h+var_30], 1Fh
		mov	[esi+4], ebx
		mov	dword ptr [esi+10h], 8
		jnz	loc_1000C5CE
		mov	ecx, [esp+48h+var_34]
		push	11h
		push	ecx
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000C645
		mov	edx, [ebx+1Ch]
		mov	eax, [edi+4]
		mov	ecx, [ebx+18h]
		push	edx
		push	ebp
		push	eax
		push	ecx
		call	sub_10021CC0
		push	ebx
		mov	[esi+3Ch], eax
		call	sub_10015D70
		add	esp, 14h
		cmp	dword ptr [esi+3Ch], 0
		jz	loc_1000C60F
		mov	eax, offset loc_10021D30
		test	ebp, ebp
		jnz	short loc_1000CCAE
		mov	eax, offset loc_10021D70

loc_1000CCAE:				; CODE XREF: sub_1000C4C0+7E7j
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset loc_10021D00

loc_1000CCB8:				; CODE XREF: sub_1000C4C0+1E8j
					; sub_1000C4C0+254j ...
		cmp	[esp+48h+var_38], 0
		jz	short loc_1000CCE9

loc_1000CCBF:				; CODE XREF: sub_1000C4C0+116j
					; sub_1000C4C0+157j ...
		push	esi
		call	sub_100176D0
		mov	edx, [esp+4Ch+var_28]
		push	edx
		call	sub_100177F0
		mov	eax, [esp+50h+var_38]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1000CCE9:				; CODE XREF: sub_1000C4C0+7FDj
		mov	eax, [esp+48h+arg_C]
		push	esi
		mov	esi, [esp+4Ch+var_28]
		push	eax
		push	esi
		call	sub_1000C010
		push	esi
		call	sub_100177F0
		add	esp, 10h
		xor	eax, eax

loc_1000CD04:				; CODE XREF: sub_1000C4C0+3Ej
		mov	ecx, [esp+48h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_1000C4C0	endp

; ---------------------------------------------------------------------------
		align 4
off_1000CD18	dd offset loc_1000C79B,	offset loc_1000C825, offset loc_1000C8AF
					; DATA XREF: sub_1000C4C0+2D4r
		dd offset loc_1000C8C1,	offset loc_1000C8BE, offset loc_1000C8D0 ; jump	table for switch statement
		dd offset loc_1000C8EC,	offset loc_1000C8E9, offset loc_1000C88B
		dd offset loc_1000C888,	offset loc_1000CC39
byte_1000CD44	db	0,   0Ah,   0Ah,   0Ah ; DATA XREF: sub_1000C4C0+2C8r
		db    0Ah,   0Ah,   0Ah,   0Ah ; indirect table	for switch statement
		db    0Ah,   0Ah,   0Ah,   0Ah
		db	1,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db	2,     3,   0Ah,   0Ah
		db	4,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,     5,     6,   0Ah
		db    0Ah,     7,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db	8,     8,   0Ah,   0Ah
		db	9
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CD90	proc near		; CODE XREF: sub_10004050+31p
					; DATA XREF: .rdata:10026026o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	1
		push	0
		push	104h
		push	104h
		push	eax
		call	sub_1000C4C0
		add	esp, 14h
		retn
sub_1000CD90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CDC0	proc near		; CODE XREF: sub_100040E0:loc_100040FEj
					; sub_1000D060+BCp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0Ch
		mov	ecx, [esp+0Ch+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_10]
		mov	eax, [edi]
		push	ecx
		mov	[esp+18h+var_C], 0
		mov	[esp+18h+var_8], eax
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000CDF3
		pop	edi
		mov	eax, 0B3h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CDF3:				; CODE XREF: sub_1000CDC0+26j
		mov	esi, [eax+38h]
		test	esi, esi
		jz	short loc_1000CE38
		cmp	dword ptr [esi], 0
		jnz	short loc_1000CE38
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000CE38
		push	eax
		call	sub_100177F0
		add	esp, 4
		push	ebp
		mov	ebp, [esp+18h+arg_C]
		test	ebp, ebp
		jnz	short loc_1000CE5B
		cmp	[esi+0Ch], ebp
		jz	short loc_1000CE4C
		mov	eax, [esi+14h]
		mov	ecx, [esi+10h]
		add	eax, [esp+18h+arg_8]
		xor	edx, edx
		div	ecx
		pop	ebp
		imul	eax, ecx
		mov	[edi], eax
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CE38:				; CODE XREF: sub_1000CDC0+38j
					; sub_1000CDC0+3Dj ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	edi
		mov	eax, 91h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CE4C:				; CODE XREF: sub_1000CDC0+5Aj
		mov	edx, [esp+18h+arg_8]
		pop	ebp
		mov	[edi], edx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CE5B:				; CODE XREF: sub_1000CDC0+55j
		cmp	dword ptr [esi+0Ch], 0
		mov	edi, [esp+18h+arg_8]
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		jz	loc_1000CF2A
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_1000CEED
		test	edi, edi
		jz	short loc_1000CE9A
		mov	ebp, 1
		mov	edi, edi

loc_1000CE80:				; CODE XREF: sub_1000CDC0+D4j
		cmp	eax, [esi+10h]
		jnb	short loc_1000CE96
		mov	cl, [ebx]
		mov	[esi+eax+18h], cl
		add	[esi+14h], ebp
		add	ebx, ebp
		add	eax, ebp
		sub	edi, ebp
		jnz	short loc_1000CE80

loc_1000CE96:				; CODE XREF: sub_1000CDC0+C3j
		mov	ebp, [esp+1Ch+arg_C]

loc_1000CE9A:				; CODE XREF: sub_1000CDC0+B7j
		mov	eax, [esi+10h]
		cmp	[esi+14h], eax
		jz	short loc_1000CEB6
		mov	edx, [esp+1Ch+arg_10]
		pop	ebx
		pop	ebp
		pop	edi
		mov	dword ptr [edx], 0
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CEB6:				; CODE XREF: sub_1000CDC0+E0j
		push	eax
		lea	ecx, [esi+18h]
		push	ecx
		mov	ecx, [esi+4Ch]
		push	eax
		mov	eax, [esi+3Ch]
		lea	edx, [esp+28h+var_C]
		push	edx
		push	ebp
		push	eax
		call	ecx
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000CEE3

loc_1000CED2:				; CODE XREF: sub_1000CDC0+193j
		call	PORT_GetError_Util
		pop	ebx
		pop	ebp
		pop	edi
		pop	esi
		add	esp, 0Ch
		jmp	sub_1000BB00
; ---------------------------------------------------------------------------

loc_1000CEE3:				; CODE XREF: sub_1000CDC0+110j
		mov	eax, [esp+1Ch+var_C]
		add	ebp, eax
		sub	[esp+1Ch+var_8], eax

loc_1000CEED:				; CODE XREF: sub_1000CDC0+B3j
		xor	edx, edx
		mov	eax, edi
		div	dword ptr [esi+10h]
		mov	[esi+14h], edx
		test	edx, edx
		jz	short loc_1000CF12
		mov	eax, ebx
		sub	eax, edx
		push	edx		; Size
		add	eax, edi
		push	eax		; Src
		lea	ecx, [esi+18h]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		sub	edi, [esi+14h]

loc_1000CF12:				; CODE XREF: sub_1000CDC0+139j
		test	edi, edi
		jnz	short loc_1000CF2A
		mov	eax, [esp+1Ch+arg_10]
		mov	edx, [esp+1Ch+var_C]
		pop	ebx
		pop	ebp
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CF2A:				; CODE XREF: sub_1000CDC0+A8j
					; sub_1000CDC0+154j
		mov	ecx, [esp+1Ch+var_8]
		mov	eax, [esi+3Ch]
		push	edi
		push	ebx
		push	ecx
		mov	ecx, [esi+4Ch]
		lea	edx, [esp+28h+var_4]
		push	edx
		push	ebp
		push	eax
		call	ecx
		mov	ecx, [esp+34h+var_4]
		add	ecx, [esp+34h+var_C]
		mov	edx, [esp+34h+arg_10]
		add	esp, 18h
		mov	[edx], ecx
		test	eax, eax
		jnz	loc_1000CED2
		pop	ebx
		pop	ebp
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
sub_1000CDC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CF70	proc near		; CODE XREF: sub_10004110:loc_1000412Ej
					; sub_1000D060+E5p
					; DATA XREF: ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	ecx, [esp+4+arg_0]
		mov	eax, [esp+4+arg_8]
		push	ebx
		push	ebp
		mov	ebp, [eax]
		push	esi
		push	edi
		push	ecx
		xor	edi, edi
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000CF9B
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000CF9B:				; CODE XREF: sub_1000CF70+1Ej
		mov	esi, [ebx+38h]
		test	esi, esi
		jz	short loc_1000CFAB
		cmp	[esi], edi
		jnz	short loc_1000CFAB
		cmp	[esi+4], edi
		jnz	short loc_1000CFBF

loc_1000CFAB:				; CODE XREF: sub_1000CF70+30j
					; sub_1000CF70+34j
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000CFBF:				; CODE XREF: sub_1000CF70+39j
		mov	edx, [esp+14h+arg_4]
		mov	ecx, [esp+14h+arg_8]
		mov	[ecx], edi
		test	edx, edx
		jnz	short loc_1000CFDD
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_1000D025
		cmp	[esi+0Ch], edi
		jz	short loc_1000D025
		mov	[ecx], eax
		jmp	short loc_1000D035
; ---------------------------------------------------------------------------

loc_1000CFDD:				; CODE XREF: sub_1000CF70+5Bj
		cmp	[esi+0Ch], edi
		jz	short loc_1000D025
		mov	cl, [esi+10h]
		mov	eax, [esi+14h]
		sub	cl, [esi+14h]
		cmp	eax, [esi+10h]
		jnb	short loc_1000CFFA

loc_1000CFF0:				; CODE XREF: sub_1000CF70+88j
		mov	[esi+eax+18h], cl
		inc	eax
		cmp	eax, [esi+10h]
		jb	short loc_1000CFF0

loc_1000CFFA:				; CODE XREF: sub_1000CF70+7Ej
		mov	eax, [esi+10h]
		push	eax
		lea	ecx, [esi+18h]
		push	ecx
		mov	ecx, [esi+3Ch]
		push	ebp
		lea	eax, [esp+20h+var_4]
		push	eax
		push	edx
		mov	edx, [esi+4Ch]
		push	ecx
		call	edx
		mov	edi, eax
		add	esp, 18h
		test	edi, edi
		jnz	short loc_1000D025
		mov	eax, [esp+14h+var_4]
		mov	ecx, [esp+14h+arg_8]
		mov	[ecx], eax

loc_1000D025:				; CODE XREF: sub_1000CF70+62j
					; sub_1000CF70+67j ...
		push	esi
		call	sub_100176D0
		add	esp, 4
		mov	dword ptr [ebx+38h], 0

loc_1000D035:				; CODE XREF: sub_1000CF70+6Bj
		push	ebx
		call	sub_100177F0
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000D04A
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000D04A:				; CODE XREF: sub_1000CF70+D0j
		call	PORT_GetError_Util
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 4
		jmp	sub_1000BB00
sub_1000CF70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000D060(int,	void *Src, size_t Size,	int, int)
sub_1000D060	proc near		; CODE XREF: sub_100040B0:loc_100040CEj
					; sub_1000FDE0+179p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_10]
		mov	edx, [esp+18h+arg_0]
		mov	ecx, [eax]
		push	ebx
		push	esi
		mov	esi, [esp+20h+Size]
		push	edi
		mov	edi, [esp+24h+Src]
		push	edx
		mov	[esp+28h+var_14], ecx
		mov	[esp+28h+var_4], esi
		call	sub_100164F0
		add	esp, 4
		mov	[esp+24h+var_18], eax
		test	eax, eax
		jnz	short loc_1000D09D
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000D09D:				; CODE XREF: sub_1000D060+2Fj
		mov	ebx, [eax+38h]
		test	ebx, ebx
		jz	short loc_1000D0CD
		cmp	dword ptr [ebx], 0
		jnz	short loc_1000D0CD
		push	ebp
		mov	ebp, [esp+28h+arg_C]
		mov	[esp+28h+Size],	0
		test	ebp, ebp
		jnz	short loc_1000D0F3
		cmp	[ebx+8], ebp
		jz	short loc_1000D0E2
		mov	ebx, [ebx+64h]
		mov	ecx, [esp+28h+arg_10]
		mov	[ecx], ebx
		jmp	loc_1000D21D
; ---------------------------------------------------------------------------

loc_1000D0CD:				; CODE XREF: sub_1000D060+42j
					; sub_1000D060+47j
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 91h
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000D0E2:				; CODE XREF: sub_1000D060+5Dj
		mov	eax, [ebx+10h]
		mov	ecx, [esp+28h+arg_10]
		lea	ebx, [esi+eax*2]
		mov	[ecx], ebx
		jmp	loc_1000D21D
; ---------------------------------------------------------------------------

loc_1000D0F3:				; CODE XREF: sub_1000D060+58j
		cmp	dword ptr [ebx+0Ch], 0
		jz	loc_1000D1B0
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000D169
		mov	edx, eax
		push	edx
		call	sub_100177F0
		mov	edi, [esp+2Ch+arg_10]
		mov	eax, [esp+2Ch+Src]
		mov	ebx, [esp+2Ch+arg_0]
		push	edi
		push	ebp
		push	esi
		push	eax
		push	ebx
		call	sub_1000CDC0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000D130
		mov	dword ptr [edi], 0

loc_1000D130:				; CODE XREF: sub_1000D060+C8j
		mov	eax, [edi]
		mov	ecx, [esp+28h+var_14]
		sub	ecx, eax
		mov	[esp+28h+arg_10], ecx
		lea	ecx, [esp+28h+arg_10]
		push	ecx
		add	ebp, eax
		push	ebp
		push	ebx
		call	sub_1000CF70
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000D157
		mov	edx, [esp+28h+arg_10]
		add	[edi], edx

loc_1000D157:				; CODE XREF: sub_1000D060+EFj
		test	esi, esi
		jz	loc_1000D22E
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000D169:				; CODE XREF: sub_1000D060+A1j
		cmp	dword ptr [ebx+10h], 1
		jbe	short loc_1000D1B0
		mov	ecx, [ebx+10h]
		xor	edx, edx
		mov	eax, esi
		div	ecx
		sub	ecx, edx
		mov	ebp, ecx
		lea	eax, [esi+ebp]
		push	eax
		mov	[esp+2Ch+var_4], eax
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1000D1D7
		mov	eax, [esp+28h+Src]
		push	esi		; Size
		push	eax		; Src
		push	edi		; Dst
		call	memcpy
		push	ebp		; Size
		lea	ecx, [edi+esi]
		push	ebp		; Val
		push	ecx		; Dst
		call	memset
		mov	ebp, [esp+40h+arg_C]
		add	esp, 18h

loc_1000D1B0:				; CODE XREF: sub_1000D060+97j
					; sub_1000D060+10Dj
		mov	esi, [esp+28h+var_4]
		mov	edx, [esp+28h+var_14]
		mov	ecx, [ebx+3Ch]
		push	esi
		push	edi
		push	edx
		mov	edx, [ebx+4Ch]
		lea	eax, [esp+34h+var_10]
		push	eax
		push	ebp
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1000D1E1
		mov	[esp+28h+Size],	eax
		jmp	short loc_1000D1EF
; ---------------------------------------------------------------------------

loc_1000D1D7:				; CODE XREF: sub_1000D060+130j
		mov	[esp+28h+Size],	2
		jmp	short loc_1000D209
; ---------------------------------------------------------------------------

loc_1000D1E1:				; CODE XREF: sub_1000D060+16Fj
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	[esp+28h+Size],	eax

loc_1000D1EF:				; CODE XREF: sub_1000D060+175j
		mov	eax, [esp+28h+var_10]
		mov	ecx, [esp+28h+arg_10]
		mov	[ecx], eax
		cmp	edi, [esp+28h+Src]
		jz	short loc_1000D209
		push	esi
		push	edi
		call	PORT_ZFree_Util
		add	esp, 8

loc_1000D209:				; CODE XREF: sub_1000D060+17Fj
					; sub_1000D060+19Dj
		push	ebx
		call	sub_100176D0
		mov	edx, [esp+2Ch+var_18]
		add	esp, 4
		mov	dword ptr [edx+38h], 0

loc_1000D21D:				; CODE XREF: sub_1000D060+68j
					; sub_1000D060+8Ej
		mov	eax, [esp+28h+var_18]
		push	eax
		call	sub_100177F0
		mov	eax, [esp+2Ch+Size]
		add	esp, 4

loc_1000D22E:				; CODE XREF: sub_1000D060+F9j
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 18h
		retn
sub_1000D060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D240	proc near		; CODE XREF: sub_10004140+31p
					; DATA XREF: .rdata:10026036o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	0
		push	1
		push	105h
		push	105h
		push	eax
		call	sub_1000C4C0
		add	esp, 14h
		retn
sub_1000D240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D270	proc near		; CODE XREF: sub_100041D0:loc_100041EEj
					; sub_1000D520+94p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0Ch
		mov	ecx, [esp+0Ch+arg_0]
		push	ebp
		mov	ebp, [esp+10h+arg_10]
		mov	eax, [ebp+0]
		push	esi
		push	ecx
		mov	[esp+18h+var_8], 0
		mov	[esp+18h+var_C], eax
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000D2A4
		pop	esi
		mov	eax, 0B3h
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D2A4:				; CODE XREF: sub_1000D270+27j
		mov	esi, [eax+38h]
		test	esi, esi
		jz	short loc_1000D2E6
		cmp	dword ptr [esi], 1
		jnz	short loc_1000D2E6
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000D2E6
		push	eax
		call	sub_100177F0
		mov	ecx, [esi+0Ch]
		add	esp, 4
		push	edi
		mov	edi, [esp+18h+arg_8]
		test	ecx, ecx
		jz	short loc_1000D2FA
		test	edi, edi
		jz	short loc_1000D2DA
		xor	edx, edx
		mov	eax, edi
		div	dword ptr [esi+10h]
		test	edx, edx
		jz	short loc_1000D2FA

loc_1000D2DA:				; CODE XREF: sub_1000D270+5Dj
		pop	edi
		pop	esi
		mov	eax, 41h
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D2E6:				; CODE XREF: sub_1000D270+39j
					; sub_1000D270+3Ej ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	esi
		mov	eax, 91h
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D2FA:				; CODE XREF: sub_1000D270+59j
					; sub_1000D270+68j
		push	ebx
		mov	ebx, [esp+1Ch+arg_C]
		test	ebx, ebx
		jnz	short loc_1000D329
		test	ecx, ecx
		jz	short loc_1000D31C
		mov	edx, [esi+14h]
		sub	edx, [esi+10h]
		pop	ebx
		add	edx, edi
		pop	edi
		pop	esi
		mov	[ebp+0], edx
		xor	eax, eax
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D31C:				; CODE XREF: sub_1000D270+95j
		pop	ebx
		mov	[ebp+0], edi
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D329:				; CODE XREF: sub_1000D270+91j
		mov	ebp, [esp+1Ch+arg_4]
		test	ecx, ecx
		jz	short loc_1000D39B
		cmp	dword ptr [esi+14h], 0
		jz	short loc_1000D37C
		mov	eax, [esi+10h]
		mov	edx, [esp+1Ch+var_C]
		push	eax
		lea	ecx, [esi+18h]
		push	ecx
		mov	ecx, [esi+3Ch]
		push	edx
		mov	edx, [esi+4Ch]
		lea	eax, [esp+28h+var_8]
		push	eax
		push	ebx
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000D372

loc_1000D35A:				; CODE XREF: sub_1000D270+154j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE002h
		jz	short loc_1000D3CE
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		jmp	sub_1000BB00
; ---------------------------------------------------------------------------

loc_1000D372:				; CODE XREF: sub_1000D270+E8j
		mov	eax, [esp+1Ch+var_8]
		add	ebx, eax
		sub	[esp+1Ch+var_C], eax

loc_1000D37C:				; CODE XREF: sub_1000D270+C5j
		mov	eax, [esi+10h]
		mov	ecx, ebp
		sub	ecx, eax
		push	eax		; Size
		add	ecx, edi
		push	ecx		; Src
		lea	edx, [esi+18h]
		push	edx		; Dst
		call	memcpy
		mov	eax, [esi+10h]
		add	esp, 0Ch
		mov	[esi+14h], eax
		sub	edi, eax

loc_1000D39B:				; CODE XREF: sub_1000D270+BFj
		mov	eax, [esp+1Ch+var_C]
		mov	edx, [esi+3Ch]
		push	edi
		push	ebp
		push	eax
		mov	eax, [esi+4Ch]
		lea	ecx, [esp+28h+var_4]
		push	ecx
		push	ebx
		push	edx
		call	eax
		mov	edx, [esp+34h+var_4]
		add	edx, [esp+34h+var_8]
		mov	ecx, [esp+34h+arg_10]
		add	esp, 18h
		mov	[ecx], edx
		test	eax, eax
		jnz	short loc_1000D35A
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D3CE:				; CODE XREF: sub_1000D270+F4j
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 40h
		pop	ebp
		add	esp, 0Ch
		retn
sub_1000D270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D3E0	proc near		; CODE XREF: sub_10004200:loc_1000421Ej
					; sub_1000D520+C1p
					; DATA XREF: ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		sub	esp, 8
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebp
		push	esi
		push	edi
		mov	edi, [ebx]
		push	eax
		call	sub_100164F0
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_1000D40D
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000D40D:				; CODE XREF: sub_1000D3E0+1Ej
		mov	esi, [ebp+38h]
		test	esi, esi
		jz	short loc_1000D45B
		cmp	dword ptr [esi], 1
		jnz	short loc_1000D45B
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000D45B
		mov	dword ptr [ebx], 0
		mov	ebx, [esp+18h+arg_4]
		mov	[esp+18h+var_8], 0
		test	ebx, ebx
		jnz	short loc_1000D471
		mov	esi, [esi+14h]
		test	esi, esi
		jz	loc_1000D508
		mov	ecx, [esp+18h+arg_8]
		push	ebp
		mov	[ecx], esi
		call	sub_100177F0
		mov	eax, [esp+1Ch+var_8]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000D45B:				; CODE XREF: sub_1000D3E0+32j
					; sub_1000D3E0+37j ...
		push	ebp
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000D471:				; CODE XREF: sub_1000D3E0+53j
		cmp	dword ptr [esi+0Ch], 0
		jz	loc_1000D4F8
		cmp	dword ptr [esi+14h], 0
		jz	short loc_1000D4F8
		mov	edx, [esi+10h]
		push	edx
		mov	edx, [esi+3Ch]
		lea	eax, [esi+18h]
		push	eax
		mov	eax, [esi+4Ch]
		push	edi
		lea	ecx, [esp+24h+var_4]
		push	ecx
		push	ebx
		push	edx
		call	eax
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000D4B7
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE002h
		jz	short loc_1000D4F0
		call	sub_1000BB00
		mov	[esp+18h+var_8], eax
		jmp	short loc_1000D4F8
; ---------------------------------------------------------------------------

loc_1000D4B7:				; CODE XREF: sub_1000D3E0+BEj
		mov	ecx, [esi+10h]
		movzx	eax, byte ptr [ecx+ebx-1]
		cmp	eax, ecx
		ja	short loc_1000D4F0
		test	eax, eax
		jz	short loc_1000D4F0
		xor	edi, edi
		test	eax, eax
		jz	short loc_1000D4E2
		lea	ecx, [ecx+ebx-1]
		mov	edx, eax

loc_1000D4D3:				; CODE XREF: sub_1000D3E0+FCj
		movzx	ebx, byte ptr [ecx]
		xor	ebx, eax
		or	edi, ebx
		dec	ecx
		dec	edx
		jnz	short loc_1000D4D3
		test	edi, edi
		jnz	short loc_1000D4F0

loc_1000D4E2:				; CODE XREF: sub_1000D3E0+EBj
		mov	edx, [esp+18h+var_4]
		sub	edx, eax
		mov	eax, [esp+18h+arg_8]
		mov	[eax], edx
		jmp	short loc_1000D4F8
; ---------------------------------------------------------------------------

loc_1000D4F0:				; CODE XREF: sub_1000D3E0+CAj
					; sub_1000D3E0+E1j ...
		mov	[esp+18h+var_8], 40h

loc_1000D4F8:				; CODE XREF: sub_1000D3E0+95j
					; sub_1000D3E0+9Fj ...
		push	esi
		call	sub_100176D0
		add	esp, 4
		mov	dword ptr [ebp+38h], 0

loc_1000D508:				; CODE XREF: sub_1000D3E0+5Aj
		push	ebp
		call	sub_100177F0
		mov	eax, [esp+1Ch+var_8]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_1000D3E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D520	proc near		; CODE XREF: sub_100041A0:loc_100041BEj
					; sub_10010670+10Dp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_10]
		push	ebx
		push	ebp
		mov	ebp, [esp+14h+arg_0]
		push	edi
		mov	edi, [eax]
		push	ebp
		call	sub_100164F0
		add	esp, 4
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jnz	short loc_1000D54D
		pop	edi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D54D:				; CODE XREF: sub_1000D520+1Fj
		mov	ebx, [eax+38h]
		test	ebx, ebx
		jz	short loc_1000D57C
		cmp	dword ptr [ebx], 1
		jnz	short loc_1000D57C
		push	esi
		mov	esi, [esp+1Ch+arg_C]
		mov	[esp+1Ch+var_8], 0
		test	esi, esi
		jnz	short loc_1000D591
		mov	ecx, [ebx+10h]
		add	ecx, [esp+1Ch+arg_8]
		mov	edx, [esp+1Ch+arg_10]
		mov	[edx], ecx
		jmp	loc_1000D6A8
; ---------------------------------------------------------------------------

loc_1000D57C:				; CODE XREF: sub_1000D520+32j
					; sub_1000D520+37j
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D591:				; CODE XREF: sub_1000D520+48j
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_1000D609
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000D609
		push	eax
		call	sub_100177F0
		mov	ecx, [esp+20h+arg_10]
		mov	edx, [esp+20h+arg_8]
		mov	eax, [esp+20h+arg_4]
		push	ecx
		push	esi
		push	edx
		push	eax
		push	ebp
		call	sub_1000D270
		mov	ebx, eax
		add	esp, 18h
		test	ebx, ebx
		jz	short loc_1000D5CC
		mov	ecx, [esp+1Ch+arg_10]
		mov	dword ptr [ecx], 0

loc_1000D5CC:				; CODE XREF: sub_1000D520+A0j
		mov	edx, [esp+1Ch+arg_10]
		mov	eax, [edx]
		add	esi, eax
		sub	edi, eax
		lea	eax, [esp+1Ch+var_4]
		push	eax
		push	esi
		push	ebp
		mov	[esp+28h+var_4], edi
		call	sub_1000D3E0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000D5F7
		mov	edx, [esp+1Ch+var_4]
		mov	ecx, [esp+1Ch+arg_10]
		add	[ecx], edx

loc_1000D5F7:				; CODE XREF: sub_1000D520+CBj
		test	ebx, ebx
		jz	loc_1000D6B9
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D609:				; CODE XREF: sub_1000D520+75j
					; sub_1000D520+7Bj
		mov	eax, [esp+1Ch+arg_8]
		mov	ecx, [esp+1Ch+arg_4]
		push	eax
		mov	eax, [ebx+3Ch]
		push	ecx
		mov	ecx, [ebx+4Ch]
		push	edi
		lea	edx, [esp+28h+var_C]
		push	edx
		push	esi
		push	eax
		call	ecx
		mov	edi, eax
		add	esp, 18h
		mov	ebp, 40h
		test	edi, edi
		jz	short loc_1000D646
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE002h
		jz	short loc_1000D644
		call	sub_1000BB00
		jmp	short loc_1000D646
; ---------------------------------------------------------------------------

loc_1000D644:				; CODE XREF: sub_1000D520+11Bj
		mov	eax, ebp

loc_1000D646:				; CODE XREF: sub_1000D520+10Fj
					; sub_1000D520+122j
		mov	[esp+1Ch+var_8], eax
		test	edi, edi
		jnz	short loc_1000D68A
		cmp	[ebx+0Ch], edi
		jz	short loc_1000D68A
		mov	edx, [esp+1Ch+var_C]
		movzx	eax, byte ptr [edx+esi-1]
		lea	ecx, [edx+esi-1]
		cmp	eax, [ebx+10h]
		ja	short loc_1000D686
		test	eax, eax
		jz	short loc_1000D686
		xor	esi, esi
		test	eax, eax
		jz	short loc_1000D680
		mov	edx, eax

loc_1000D671:				; CODE XREF: sub_1000D520+15Aj
		movzx	edi, byte ptr [ecx]
		xor	edi, eax
		or	esi, edi
		dec	ecx
		dec	edx
		jnz	short loc_1000D671
		test	esi, esi
		jnz	short loc_1000D686

loc_1000D680:				; CODE XREF: sub_1000D520+14Dj
		sub	[esp+1Ch+var_C], eax
		jmp	short loc_1000D68A
; ---------------------------------------------------------------------------

loc_1000D686:				; CODE XREF: sub_1000D520+143j
					; sub_1000D520+147j ...
		mov	[esp+1Ch+var_8], ebp

loc_1000D68A:				; CODE XREF: sub_1000D520+12Cj
					; sub_1000D520+131j ...
		mov	eax, [esp+1Ch+arg_10]
		mov	ecx, [esp+1Ch+var_C]
		push	ebx
		mov	[eax], ecx
		call	sub_100176D0
		mov	edx, [esp+20h+var_4]
		add	esp, 4
		mov	dword ptr [edx+38h], 0

loc_1000D6A8:				; CODE XREF: sub_1000D520+57j
		mov	eax, [esp+1Ch+var_4]
		push	eax
		call	sub_100177F0
		mov	eax, [esp+20h+var_8]
		add	esp, 4

loc_1000D6B9:				; CODE XREF: sub_1000D520+D9j
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000D520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D6D0	proc near		; CODE XREF: sub_10004230:loc_1000423Fj
					; sub_10012C50+BDp
					; DATA XREF: ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	ebx
		push	ebp
		push	eax
		call	sub_100164F0
		mov	ebp, eax
		xor	ebx, ebx
		add	esp, 4
		cmp	ebp, ebx
		jnz	short loc_1000D6EF
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D6EF:				; CODE XREF: sub_1000D6D0+15j
		push	esi
		cmp	[ebp+3Ch], ebx
		jz	short loc_1000D709
		push	ebp
		mov	esi, 90h
		call	sub_100177F0
		add	esp, 4
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D709:				; CODE XREF: sub_1000D6D0+23j
		push	6Ch
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_1000D72D
		push	ebp
		mov	esi, 2
		call	sub_100177F0
		add	esp, 4
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D72D:				; CODE XREF: sub_1000D6D0+47j
		mov	ecx, [esp+0Ch+arg_4]
		mov	dword ptr [esi], 2
		mov	dword ptr [esi+4], 1
		mov	[esi+8], ebx
		mov	[esi+3Ch], ebx
		mov	[esi+40h], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+14h], ebx
		mov	[esi+68h], ebx
		mov	[esi+10h], ebx
		mov	[esi+64h], ebx
		mov	eax, [ecx]
		add	eax, 0FFFFFE00h	; switch 113 cases
		push	edi
		cmp	eax, 70h
		ja	loc_1000D999	; jumptable 1000D76E default case
		movzx	edx, ds:byte_1000D9D4[eax]
		jmp	ds:off_1000D9B4[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000D775:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_10021320	; jumptable 1000D76E case 512
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_10021410
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 200h
		mov	dword ptr [esi+50h], offset sub_100213B0
		mov	dword ptr [esi+54h], offset sub_100213E0
		mov	dword ptr [esi+58h], offset sub_10021350
		mov	dword ptr [esi+64h], 10h
		cmp	edi, ebx
		jz	short loc_1000D7CE
		push	edi
		call	sub_10021380

loc_1000D7B8:				; CODE XREF: sub_1000D6D0+14Bj
					; sub_1000D6D0+194j ...
		add	esp, 4
		push	ebp
		mov	[ebp+3Ch], esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D7CE:				; CODE XREF: sub_1000D6D0+E0j
					; sub_1000D6D0+143j ...
		mov	edi, 2
		jmp	loc_1000D99E
; ---------------------------------------------------------------------------

loc_1000D7D8:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_100211F0	; jumptable 1000D76E case 528
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_100212E0
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 210h
		mov	dword ptr [esi+50h], offset sub_10021280
		mov	dword ptr [esi+54h], offset sub_100212B0
		mov	dword ptr [esi+58h], offset sub_10021220
		mov	dword ptr [esi+64h], 10h
		cmp	edi, ebx
		jz	short loc_1000D7CE
		push	edi
		call	sub_10021250
		jmp	short loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D81D:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_10021490	; jumptable 1000D76E case 544
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_10021580
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 220h
		mov	dword ptr [esi+50h], offset sub_10021520
		mov	dword ptr [esi+54h], offset sub_10021550
		mov	dword ptr [esi+58h], offset sub_100214C0
		mov	dword ptr [esi+64h], 14h
		cmp	edi, ebx
		jz	loc_1000D7CE
		push	edi
		call	sub_100214F0
		jmp	loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D869:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_100224B0	; jumptable 1000D76E case 597
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_100225A0
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 255h
		mov	dword ptr [esi+50h], offset loc_10022540
		mov	dword ptr [esi+54h], offset loc_10022570
		mov	dword ptr [esi+58h], offset sub_100224E0
		mov	dword ptr [esi+64h], 1Ch
		cmp	edi, ebx
		jz	loc_1000D7CE
		push	edi
		call	sub_10022510
		jmp	loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D8B5:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_100218B0	; jumptable 1000D76E case 592
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_100219A0
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 250h
		mov	dword ptr [esi+50h], offset loc_10021940
		mov	dword ptr [esi+54h], offset loc_10021970
		mov	dword ptr [esi+58h], offset sub_100218E0
		mov	dword ptr [esi+64h], 20h
		cmp	edi, ebx
		jz	loc_1000D7CE
		push	edi
		call	sub_10021910
		jmp	loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D901:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_10021B90	; jumptable 1000D76E case 608
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_10021C80
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 260h
		mov	dword ptr [esi+50h], offset loc_10021C20
		mov	dword ptr [esi+54h], offset loc_10021C50
		mov	dword ptr [esi+58h], offset sub_10021BC0
		mov	dword ptr [esi+64h], 30h
		cmp	edi, ebx
		jz	loc_1000D7CE
		push	edi
		call	sub_10021BF0
		jmp	loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D94D:				; CODE XREF: sub_1000D6D0+9Ej
					; DATA XREF: .text:off_1000D9B4o
		call	sub_10021A20	; jumptable 1000D76E case 624
		mov	edi, eax
		push	edi
		mov	[esi+3Ch], edi
		call	sub_10021B10
		add	esp, 4
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 270h
		mov	dword ptr [esi+50h], offset loc_10021AB0
		mov	dword ptr [esi+54h], offset loc_10021AE0
		mov	dword ptr [esi+58h], offset sub_10021A50
		mov	dword ptr [esi+64h], 40h
		cmp	edi, ebx
		jz	loc_1000D7CE
		push	edi
		call	sub_10021A80
		jmp	loc_1000D7B8
; ---------------------------------------------------------------------------

loc_1000D999:				; CODE XREF: sub_1000D6D0+91j
					; sub_1000D6D0+9Ej
					; DATA XREF: ...
		mov	edi, 70h	; jumptable 1000D76E default case

loc_1000D99E:				; CODE XREF: sub_1000D6D0+103j
		push	esi
		call	sub_100176D0
		push	ebp
		call	sub_100177F0
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1000D6D0	endp

; ---------------------------------------------------------------------------
off_1000D9B4	dd offset loc_1000D775,	offset loc_1000D7D8, offset loc_1000D81D
					; DATA XREF: sub_1000D6D0+9Er
		dd offset loc_1000D8B5,	offset loc_1000D869, offset loc_1000D901 ; jump	table for switch statement
		dd offset loc_1000D94D,	offset loc_1000D999
byte_1000D9D4	db	0,     7,     7,     7 ; DATA XREF: sub_1000D6D0+97r
		db	7,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	1,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	2,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	3,     7,     7,     7
		db	7,     4,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	5,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DA50	proc near		; CODE XREF: sub_10004250:loc_1000425Fj
					; DATA XREF: .rdata:1002604Ao

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	ebx
		mov	ebx, [esp+8+arg_10]
		mov	eax, [ebx]
		push	esi
		push	edi
		push	ecx
		mov	[esp+14h+arg_10], eax
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000DA7B
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DA7B:				; CODE XREF: sub_1000DA50+1Fj
		mov	esi, [edi+3Ch]
		test	esi, esi
		jz	short loc_1000DA87
		cmp	dword ptr [esi], 2
		jz	short loc_1000DA9A

loc_1000DA87:				; CODE XREF: sub_1000DA50+30j
		push	edi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 91h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DA9A:				; CODE XREF: sub_1000DA50+35j
		push	ebp
		mov	ebp, [esp+14h+arg_C]
		test	ebp, ebp
		jnz	short loc_1000DAB9
		mov	edx, [esi+64h]
		push	edi
		mov	[ebx], edx
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DAB9:				; CODE XREF: sub_1000DA50+51j
		mov	eax, [esp+14h+arg_8]
		mov	ecx, [esp+14h+arg_4]
		mov	edx, [esi+3Ch]
		push	eax
		mov	eax, [esi+50h]
		push	ecx
		push	edx
		call	eax
		mov	ecx, [esp+20h+arg_10]
		mov	eax, [esi+3Ch]
		push	ecx
		mov	ecx, [esi+54h]
		lea	edx, [esp+24h+var_4]
		push	edx
		push	ebp
		push	eax
		call	ecx
		mov	edx, [esp+30h+var_4]
		push	esi
		mov	[ebx], edx
		call	sub_100176D0
		add	esp, 20h
		push	edi
		mov	dword ptr [edi+3Ch], 0
		call	sub_100177F0
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_1000DA50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DB10	proc near		; CODE XREF: sub_10004270:loc_1000427Fj
					; sub_10012DF0+2Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000DB29
		mov	eax, 0B3h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DB29:				; CODE XREF: sub_1000DB10+10j
		mov	esi, [eax+3Ch]
		test	esi, esi
		jz	short loc_1000DB5E
		cmp	dword ptr [esi], 2
		jnz	short loc_1000DB5E
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000DB5E
		push	eax
		call	sub_100177F0
		mov	ecx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		mov	eax, [esi+3Ch]
		add	esp, 4
		push	ecx
		mov	ecx, [esi+50h]
		push	edx
		push	eax
		call	ecx
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DB5E:				; CODE XREF: sub_1000DB10+1Ej
					; sub_1000DB10+23j ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	eax, 91h
		pop	esi
		retn
sub_1000DB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DB70	proc near		; CODE XREF: sub_10004290:loc_1000429Fj
					; DATA XREF: .rdata:10026056o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [ebx]
		push	esi
		push	edi
		push	eax
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000DB97
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DB97:				; CODE XREF: sub_1000DB70+1Bj
		mov	esi, [edi+3Ch]
		test	esi, esi
		jz	short loc_1000DBA9
		cmp	dword ptr [esi], 2
		jnz	short loc_1000DBA9
		cmp	dword ptr [esi+4], 0
		jnz	short loc_1000DBBC

loc_1000DBA9:				; CODE XREF: sub_1000DB70+2Cj
					; sub_1000DB70+31j
		push	edi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DBBC:				; CODE XREF: sub_1000DB70+37j
		mov	eax, [esp+10h+arg_4]
		test	eax, eax
		jz	short loc_1000DBFA
		mov	edx, [esi+3Ch]
		push	ebp
		lea	ecx, [esp+14h+arg_8]
		push	ecx
		push	eax
		mov	eax, [esi+54h]
		push	edx
		call	eax
		mov	ecx, [esp+20h+arg_8]
		push	esi
		mov	[ebx], ecx
		call	sub_100176D0
		add	esp, 14h
		push	edi
		mov	dword ptr [edi+3Ch], 0
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DBFA:				; CODE XREF: sub_1000DB70+52j
		mov	edx, [esi+64h]
		push	edi
		mov	[ebx], edx
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_1000DB70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DC10	proc near		; CODE XREF: sub_10012FD0+22Dp
					; sub_10013A30+21Bp
		call	sub_10021320
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset sub_100213B0
		mov	dword ptr [esi+54h], offset sub_100213E0
		mov	dword ptr [esi+5Ch], offset sub_10021350
		test	eax, eax
		jnz	short loc_1000DC37
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DC37:				; CODE XREF: sub_1000DC10+1Fj
		push	eax
		call	sub_10021380
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DC10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DC50	proc near		; CODE XREF: sub_10012FD0+1E4p
					; sub_10013A30+1D3p
		call	sub_100211F0
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset sub_10021280
		mov	dword ptr [esi+54h], offset sub_100212B0
		mov	dword ptr [esi+5Ch], offset sub_10021220
		test	eax, eax
		jnz	short loc_1000DC77
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DC77:				; CODE XREF: sub_1000DC50+1Fj
		push	eax
		call	sub_10021250
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DC50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DC90	proc near		; CODE XREF: sub_10012FD0+269p
					; sub_10012FD0+4CCp ...
		call	sub_10021490
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset sub_10021520
		mov	dword ptr [esi+54h], offset sub_10021550
		mov	dword ptr [esi+5Ch], offset sub_100214C0
		test	eax, eax
		jnz	short loc_1000DCB7
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DCB7:				; CODE XREF: sub_1000DC90+1Fj
		push	eax
		call	sub_100214F0
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DC90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DCD0	proc near		; CODE XREF: sub_10012FD0+2A9p
					; sub_10013A30+295p
		call	sub_100224B0
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset loc_10022540
		mov	dword ptr [esi+54h], offset loc_10022570
		mov	dword ptr [esi+5Ch], offset sub_100224E0
		test	eax, eax
		jnz	short loc_1000DCF7
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DCF7:				; CODE XREF: sub_1000DCD0+1Fj
		push	eax
		call	sub_10022510
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DCD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DD10	proc near		; CODE XREF: sub_10012FD0+2E9p
					; sub_10013A30+2D4p
		call	sub_100218B0
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset loc_10021940
		mov	dword ptr [esi+54h], offset loc_10021970
		mov	dword ptr [esi+5Ch], offset sub_100218E0
		test	eax, eax
		jnz	short loc_1000DD37
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DD37:				; CODE XREF: sub_1000DD10+1Fj
		push	eax
		call	sub_10021910
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DD10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DD50	proc near		; CODE XREF: sub_10012FD0+329p
					; sub_10013A30+313p
		call	sub_10021B90
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset loc_10021C20
		mov	dword ptr [esi+54h], offset loc_10021C50
		mov	dword ptr [esi+5Ch], offset sub_10021BC0
		test	eax, eax
		jnz	short loc_1000DD77
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DD77:				; CODE XREF: sub_1000DD50+1Fj
		push	eax
		call	sub_10021BF0
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DD50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DD90	proc near		; CODE XREF: sub_10012FD0+366p
					; sub_10013A30+34Fp
		call	sub_10021A20
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset loc_10021AB0
		mov	dword ptr [esi+54h], offset loc_10021AE0
		mov	dword ptr [esi+5Ch], offset sub_10021A50
		test	eax, eax
		jnz	short loc_1000DDB7
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1000DDB7:				; CODE XREF: sub_1000DD90+1Fj
		push	eax
		call	sub_10021A80
		add	esp, 4
		xor	eax, eax
		retn
sub_1000DD90	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000DDD0:				; DATA XREF: sub_1000DE90+D0o
					; sub_10012FD0+85Do
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax]
		mov	eax, [esp+14h]
		cmp	esi, eax
		jbe	short loc_1000DDE1
		mov	esi, eax

loc_1000DDE1:				; CODE XREF: .text:1000DDDDj
		mov	eax, [esp+1Ch]
		cmp	esi, eax
		jbe	short loc_1000DDEB
		mov	esi, eax

loc_1000DDEB:				; CODE XREF: .text:1000DDE7j
		mov	ecx, [esp+18h]
		mov	edx, [esp+0Ch]
		push	esi
		push	ecx
		push	edx
		call	memcpy
		mov	eax, [esp+1Ch]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000DE08
		mov	[eax], esi

loc_1000DE08:				; CODE XREF: .text:1000DE04j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000DE10:				; DATA XREF: sub_1000DE90+D7o
		mov	eax, [esp+4]
		mov	ecx, [esp+10h]
		mov	edx, [esp+8]
		push	esi
		mov	esi, [eax]
		push	edi
		cmp	esi, 4
		jb	short loc_1000DE39

loc_1000DE25:				; CODE XREF: .text:1000DE37j
		mov	eax, [edx]
		cmp	eax, [ecx]
		jnz	short loc_1000DE3D
		sub	esi, 4
		add	ecx, 4
		add	edx, 4
		cmp	esi, 4
		jnb	short loc_1000DE25

loc_1000DE39:				; CODE XREF: .text:1000DE23j
		test	esi, esi
		jz	short loc_1000DE85

loc_1000DE3D:				; CODE XREF: .text:1000DE29j
		movzx	eax, byte ptr [edx]
		movzx	edi, byte ptr [ecx]
		sub	eax, edi
		jnz	short loc_1000DE78
		cmp	esi, 1
		jbe	short loc_1000DE85
		movzx	eax, byte ptr [edx+1]
		movzx	edi, byte ptr [ecx+1]
		sub	eax, edi
		jnz	short loc_1000DE78
		cmp	esi, 2
		jbe	short loc_1000DE85
		movzx	eax, byte ptr [edx+2]
		movzx	edi, byte ptr [ecx+2]
		sub	eax, edi
		jnz	short loc_1000DE78
		cmp	esi, 3
		jbe	short loc_1000DE85
		movzx	eax, byte ptr [edx+3]
		movzx	ecx, byte ptr [ecx+3]
		sub	eax, ecx

loc_1000DE78:				; CODE XREF: .text:1000DE45j
					; .text:1000DE56j ...
		sar	eax, 1Fh
		or	eax, 1
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DE85:				; CODE XREF: .text:1000DE3Bj
					; .text:1000DE4Aj ...
		xor	eax, eax
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DE90	proc near		; CODE XREF: sub_10012FD0+55Cp
					; sub_10012FD0+57Ap ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	edi
		push	eax
		mov	edi, ecx
		call	sub_10022040
		mov	ecx, [edi+18h]
		xor	ebx, ebx
		add	esp, 4
		cmp	dword ptr [ecx], 3
		mov	ebp, eax
		setz	bl
		test	ebx, ebx
		jz	short loc_1000DECA
		mov	eax, [esp+0Ch+arg_0]
		cmp	eax, 4
		jb	short loc_1000DEC1
		mov	edx, [ebp+0]
		shr	edx, 1
		cmp	eax, edx
		jnb	short loc_1000DECA

loc_1000DEC1:				; CODE XREF: sub_1000DE90+26j
		pop	edi
		pop	ebp
		mov	eax, 150h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DECA:				; CODE XREF: sub_1000DE90+1Dj
					; sub_1000DE90+2Fj
		push	11h
		push	edi
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1000DEE2
		lea	eax, [edi+62h]
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DEE2:				; CODE XREF: sub_1000DE90+49j
		mov	eax, [edi+1Ch]
		mov	ecx, [edi+18h]
		push	ebx
		push	eax
		push	ecx
		push	ebp
		call	sub_100220B0
		mov	ebx, eax
		push	edi
		mov	[esi+40h], ebx
		mov	dword ptr [esi+4], 1
		call	sub_10015D70
		add	esp, 14h
		cmp	dword ptr [esi+40h], 0
		jnz	short loc_1000DF24
		call	PORT_GetError_Util
		sub	eax, 0FFFFE005h
		neg	eax
		sbb	eax, eax
		pop	edi
		and	eax, 0FFFFFFA0h
		pop	ebp
		add	eax, 62h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DF24:				; CODE XREF: sub_1000DE90+7Aj
		push	4
		mov	dword ptr [esi+50h], offset sub_10022120
		mov	dword ptr [esi+54h], offset sub_10022150
		mov	dword ptr [esi+5Ch], offset sub_10022080
		call	PORT_Alloc_Util
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000DF50
		pop	edi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DF50:				; CODE XREF: sub_1000DE90+B5j
		mov	edx, [esp+0Ch+arg_0]
		mov	[eax], edx
		mov	[esi+3Ch], eax
		mov	dword ptr [esi+58h], offset loc_1001D810
		mov	dword ptr [esi+4Ch], offset loc_1000DDD0
		mov	dword ptr [esi+60h], offset loc_1000DE10
		mov	eax, [ebp+0]
		push	ebx
		mov	[esi+64h], eax
		call	sub_100220F0
		add	esp, 4
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_1000DE90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000DF90(int,	void *Dst, int,	int, int, int)
sub_1000DF90	proc near		; DATA XREF: sub_1000E150+13Bo

var_48		= byte ptr -48h
Src		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	ebx
		mov	ebx, [esp+4Ch+arg_8]
		push	ebp
		mov	ebp, [esp+50h+arg_10]
		push	esi
		mov	esi, [esp+54h+arg_0]
		mov	eax, [esi]
		mov	ecx, [esi+4]
		push	edi
		mov	edi, [esp+58h+Dst]
		push	eax
		call	ecx
		mov	edx, [esi+118h]
		mov	ecx, [esi]
		push	edx
		mov	edx, [esi+8]
		lea	eax, [esi+18h]
		push	eax
		push	ecx
		call	edx
		mov	eax, [esi+14h]
		mov	ecx, [esi]
		mov	edx, [esi+8]
		push	eax
		push	offset dword_10029164
		push	ecx
		call	edx
		mov	eax, [esp+74h+arg_14]
		mov	ecx, [esi]
		mov	edx, [esi+8]
		push	eax
		push	ebp
		push	ecx
		call	edx
		mov	edx, [esi]
		push	40h
		lea	eax, [esp+84h+var_48]
		push	eax
		mov	eax, [esi+0Ch]
		lea	ecx, [esp+88h+Src]
		push	ecx
		push	edx
		call	eax
		mov	ecx, [esi+10h]
		push	ecx		; Size
		lea	edx, [esp+94h+Src]
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		mov	eax, [esi+10h]
		mov	ecx, [esp+9Ch+var_4]
		add	esp, 44h
		pop	edi
		pop	esi
		mov	[ebx], eax
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_1000DF90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E040	proc near		; DATA XREF: sub_1000E150+142o

var_48		= byte ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	esi
		mov	esi, [esp+4Ch+arg_0]
		mov	eax, [esi]
		mov	ecx, [esi+4]
		push	edi
		mov	edi, [esp+50h+arg_C]
		push	eax
		call	ecx
		mov	edx, [esi+118h]
		mov	ecx, [esi]
		push	edx
		mov	edx, [esi+8]
		lea	eax, [esi+18h]
		push	eax
		push	ecx
		call	edx
		mov	eax, [esi+14h]
		mov	ecx, [esi]
		mov	edx, [esi+8]
		push	eax
		push	offset dword_10029164
		push	ecx
		call	edx
		mov	eax, [esp+6Ch+arg_10]
		mov	ecx, [esi]
		mov	edx, [esi+8]
		push	eax
		push	edi
		push	ecx
		call	edx
		mov	edx, [esi]
		push	40h
		lea	eax, [esp+7Ch+var_48]
		push	eax
		mov	eax, [esi+0Ch]
		lea	ecx, [esp+80h+var_44]
		push	ecx
		push	edx
		call	eax
		mov	esi, [esi+10h]
		mov	edx, [esp+88h+arg_4]
		add	esp, 38h
		lea	ecx, [esp+50h+var_44]
		cmp	esi, 4
		jb	short loc_1000E0D4
		nop

loc_1000E0C0:				; CODE XREF: sub_1000E040+92j
		mov	eax, [edx]
		cmp	eax, [ecx]
		jnz	short loc_1000E0D8
		sub	esi, 4
		add	ecx, 4
		add	edx, 4
		cmp	esi, 4
		jnb	short loc_1000E0C0

loc_1000E0D4:				; CODE XREF: sub_1000E040+7Dj
		test	esi, esi
		jz	short loc_1000E12E

loc_1000E0D8:				; CODE XREF: sub_1000E040+84j
		movzx	edi, byte ptr [ecx]
		movzx	eax, byte ptr [edx]
		sub	eax, edi
		jnz	short loc_1000E113
		cmp	esi, 1
		jbe	short loc_1000E12E
		movzx	eax, byte ptr [edx+1]
		movzx	edi, byte ptr [ecx+1]
		sub	eax, edi
		jnz	short loc_1000E113
		cmp	esi, 2
		jbe	short loc_1000E12E
		movzx	eax, byte ptr [edx+2]
		movzx	edi, byte ptr [ecx+2]
		sub	eax, edi
		jnz	short loc_1000E113
		cmp	esi, 3
		jbe	short loc_1000E12E
		movzx	eax, byte ptr [edx+3]
		movzx	ecx, byte ptr [ecx+3]
		sub	eax, ecx

loc_1000E113:				; CODE XREF: sub_1000E040+A0j
					; sub_1000E040+B1j ...
		sar	eax, 1Fh
		or	eax, 1
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000E12E:				; CODE XREF: sub_1000E040+96j
					; sub_1000E040+A5j ...
		mov	ecx, [esp+50h+var_4]
		xor	eax, eax
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_1000E040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E150	proc near		; CODE XREF: sub_10012FD0+6C6p
					; sub_10012FD0+6F4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	[esp+arg_0], 4
		push	ebp
		jnz	short loc_1000E198
		call	sub_10021490
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset sub_10021520
		mov	dword ptr [esi+54h], offset sub_10021550
		mov	dword ptr [esi+5Ch], offset sub_100214C0
		test	eax, eax
		jz	short loc_1000E191
		push	eax
		call	sub_100214F0
		add	esp, 4
		mov	[esp+4+arg_0], offset sub_100214F0
		mov	ebp, 28h
		jmp	short loc_1000E1CF
; ---------------------------------------------------------------------------

loc_1000E191:				; CODE XREF: sub_1000E150+27j
					; sub_1000E150+67j
		mov	eax, 2
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E198:				; CODE XREF: sub_1000E150+6j
		call	sub_100211F0
		mov	[esi+40h], eax
		mov	dword ptr [esi+50h], offset sub_10021280
		mov	dword ptr [esi+54h], offset sub_100212B0
		mov	dword ptr [esi+5Ch], offset sub_10021220
		test	eax, eax
		jz	short loc_1000E191
		push	eax
		call	sub_10021250
		add	esp, 4
		mov	[esp+4+arg_0], offset sub_10021250
		mov	ebp, 30h

loc_1000E1CF:				; CODE XREF: sub_1000E150+3Fj
		mov	eax, [esp+4+arg_4]
		push	ebx
		push	11h
		push	eax
		mov	dword ptr [esi+4], 1
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_1000E1F2
		lea	eax, [ebx+62h]
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E1F2:				; CODE XREF: sub_1000E150+9Aj
		mov	ecx, [ebx+1Ch]
		mov	edx, [ebx+18h]
		mov	eax, [esi+40h]
		push	edi
		push	ecx
		mov	ecx, [esi+50h]
		push	edx
		push	eax
		call	ecx
		mov	edx, [esi+40h]
		mov	eax, [esi+50h]
		push	ebp
		push	offset dword_10029128
		push	edx
		call	eax
		push	11Ch
		call	PORT_Alloc_Util
		mov	edi, eax
		add	esp, 1Ch
		test	edi, edi
		jnz	short loc_1000E236
		push	ebx
		call	sub_10015D70
		add	esp, 4
		lea	eax, [edi+2]
		pop	edi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E236:				; CODE XREF: sub_1000E150+D4j
		mov	ecx, [esp+0Ch+arg_8]
		mov	[edi+10h], ecx
		mov	edx, [esi+40h]
		mov	[edi], edx
		mov	eax, [ebx+1Ch]
		mov	ecx, [ebx+18h]
		push	eax		; Size
		push	ecx		; Src
		lea	edx, [edi+18h]
		push	edx		; Dst
		call	memcpy
		mov	eax, [ebx+1Ch]
		mov	ecx, [esp+18h+arg_0]
		mov	[edi+118h], eax
		mov	[edi+4], ecx
		mov	edx, [esi+54h]
		mov	[edi+0Ch], edx
		mov	eax, [esi+50h]
		push	ebx
		mov	[edi+8], eax
		mov	[edi+14h], ebp
		call	sub_10015D70
		mov	ecx, [esp+1Ch+arg_8]
		add	esp, 10h
		mov	[esi+3Ch], edi
		pop	edi
		pop	ebx
		mov	dword ptr [esi+58h], offset loc_1001D810
		mov	dword ptr [esi+4Ch], offset sub_1000DF90
		mov	dword ptr [esi+60h], offset sub_1000E040
		mov	[esi+64h], ecx
		xor	eax, eax
		pop	ebp
		retn
sub_1000E150	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E2A0	proc near		; CODE XREF: sub_10012FD0+29p
					; sub_10013A30+25p

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	eax, [ecx]
		push	ebx
		push	ebp
		mov	ebp, [esp+34h+arg_8]
		push	esi
		or	ebx, 0FFFFFFFFh
		push	edi
		mov	edi, edx
		cmp	eax, 144h
		ja	loc_1000E392
		jz	loc_1000E379
		sub	eax, 103h	; switch 65 cases
		cmp	eax, 40h
		ja	loc_1000E439	; jumptable 1000E2E3 default case
		movzx	eax, ds:byte_1000E578[eax]
		jmp	ds:off_1000E558[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000E2EA:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		mov	edx, [ecx+4]	; jumptable 1000E2E3 case 260
		mov	ebx, [edx+4]

loc_1000E2F0:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		mov	eax, [ecx+4]	; jumptable 1000E2E3 case 259
		mov	ecx, [eax]
		xor	eax, eax
		mov	[esp+3Ch+var_20], ecx
		mov	[esp+3Ch+var_1C], eax
		mov	[esp+3Ch+var_18], eax
		mov	[esp+3Ch+var_2C], 102h
		lea	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_24], 0Ch
		lea	esi, [eax+8]
		jmp	loc_1000E47D
; ---------------------------------------------------------------------------

loc_1000E31F:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		mov	eax, [ecx+4]	; jumptable 1000E2E3 case 292
		mov	ebx, [eax]

loc_1000E324:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		xor	eax, eax	; jumptable 1000E2E3 case 291
		mov	esi, 8
		lea	ecx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_14], eax
		mov	[esp+3Ch+var_10], eax
		mov	[esp+3Ch+var_2C], 122h
		mov	[esp+3Ch+var_28], ecx
		mov	[esp+3Ch+var_24], esi
		jmp	loc_1000E481
; ---------------------------------------------------------------------------

loc_1000E34C:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		mov	edx, [ecx+4]	; jumptable 1000E2E3 case 309
		mov	ebx, [edx]

loc_1000E351:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		xor	eax, eax	; jumptable 1000E2E3 case 308
		mov	[esp+3Ch+var_14], eax
		mov	[esp+3Ch+var_10], eax
		mov	esi, 8
		lea	eax, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_2C], 133h
		mov	[esp+3Ch+var_28], eax
		mov	[esp+3Ch+var_24], esi
		jmp	loc_1000E481
; ---------------------------------------------------------------------------

loc_1000E379:				; CODE XREF: sub_1000E2A0+28j
		mov	ecx, [ecx+4]
		mov	ebx, [ecx]

loc_1000E37E:				; CODE XREF: sub_1000E2A0+43j
					; DATA XREF: .text:off_1000E558o
		mov	esi, 8		; jumptable 1000E2E3 case 323
		xor	eax, eax
		mov	[esp+3Ch+var_2C], 142h
		jmp	loc_1000E46D
; ---------------------------------------------------------------------------

loc_1000E392:				; CODE XREF: sub_1000E2A0+22j
		cmp	eax, 654h
		ja	loc_1000E42F
		jz	short loc_1000E3FD
		sub	eax, 553h
		jz	short loc_1000E3CD
		dec	eax
		jz	short loc_1000E3C8
		sub	eax, 0FFh
		jz	short loc_1000E402
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 54h
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E3C8:				; CODE XREF: sub_1000E2A0+107j
		mov	eax, [ecx+4]
		mov	ebx, [eax]

loc_1000E3CD:				; CODE XREF: sub_1000E2A0+104j
		xor	eax, eax
		mov	esi, 10h
		lea	ecx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_14], eax
		mov	[esp+3Ch+var_10], eax
		mov	[esp+3Ch+var_C], eax
		mov	[esp+3Ch+var_8], eax
		mov	[esp+3Ch+var_2C], 552h
		mov	[esp+3Ch+var_28], ecx
		mov	[esp+3Ch+var_24], esi
		jmp	loc_1000E481
; ---------------------------------------------------------------------------

loc_1000E3FD:				; CODE XREF: sub_1000E2A0+FDj
		mov	edx, [ecx+4]
		mov	ebx, [edx]

loc_1000E402:				; CODE XREF: sub_1000E2A0+10Ej
		xor	eax, eax
		mov	[esp+3Ch+var_14], eax
		mov	[esp+3Ch+var_10], eax
		mov	[esp+3Ch+var_C], eax
		mov	[esp+3Ch+var_8], eax
		mov	esi, 10h
		lea	eax, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_2C], 652h
		mov	[esp+3Ch+var_28], eax
		mov	[esp+3Ch+var_24], esi
		jmp	short loc_1000E481
; ---------------------------------------------------------------------------

loc_1000E42F:				; CODE XREF: sub_1000E2A0+F7j
		sub	eax, 1083h
		jz	short loc_1000E456
		dec	eax
		jz	short loc_1000E451

loc_1000E439:				; CODE XREF: sub_1000E2A0+36j
					; sub_1000E2A0+43j
					; DATA XREF: ...
		pop	edi		; jumptable 1000E2E3 default case
		pop	esi
		pop	ebp
		mov	eax, 54h
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E451:				; CODE XREF: sub_1000E2A0+197j
		mov	ecx, [ecx+4]
		mov	ebx, [ecx]

loc_1000E456:				; CODE XREF: sub_1000E2A0+194j
		xor	eax, eax
		mov	esi, 10h
		mov	[esp+3Ch+var_C], eax
		mov	[esp+3Ch+var_8], eax
		mov	[esp+3Ch+var_2C], 1082h

loc_1000E46D:				; CODE XREF: sub_1000E2A0+EDj
		mov	[esp+3Ch+var_24], esi
		lea	edx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_10], eax
		mov	[esp+3Ch+var_14], eax

loc_1000E47D:				; CODE XREF: sub_1000E2A0+7Aj
		mov	[esp+3Ch+var_28], edx

loc_1000E481:				; CODE XREF: sub_1000E2A0+A7j
					; sub_1000E2A0+D4j ...
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_1000E4D3
		mov	ebx, esi
		shr	ebx, 1

loc_1000E48A:				; CODE XREF: sub_1000E2A0+235j
		mov	eax, [esp+3Ch+arg_4]
		mov	ecx, [esp+3Ch+arg_0]
		push	1
		push	ebp
		push	eax
		push	104h
		push	ecx
		lea	edx, [esp+50h+var_2C]
		mov	ecx, edi
		call	sub_1000C4C0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000E522
		push	edi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000E4EF
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E4D3:				; CODE XREF: sub_1000E2A0+1E4j
		cmp	ebx, esi
		jbe	short loc_1000E48A
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 71h
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E4EF:				; CODE XREF: sub_1000E2A0+219j
		cmp	ebp, 6		; switch 7 cases
		ja	short loc_1000E535 ; jumptable 1000E4F4	default	case
		jmp	ds:off_1000E5BC[ebp*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000E4FB:				; CODE XREF: sub_1000E2A0+254j
					; DATA XREF: .text:off_1000E5BCo
		mov	edi, [eax+38h]	; jumptable 1000E4F4 cases 0,1
		jmp	short loc_1000E503
; ---------------------------------------------------------------------------

loc_1000E500:				; CODE XREF: sub_1000E2A0+254j
					; DATA XREF: .text:off_1000E5BCo
		mov	edi, [eax+3Ch]	; jumptable 1000E4F4 cases 2-6

loc_1000E503:				; CODE XREF: sub_1000E2A0+25Ej
		test	edi, edi
		jz	short loc_1000E535 ; jumptable 1000E4F4	default	case
		cmp	[edi], ebp
		jnz	short loc_1000E535 ; jumptable 1000E4F4	default	case
		cmp	dword ptr [edi+4], 0
		jz	short loc_1000E535 ; jumptable 1000E4F4	default	case
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	[edi+10h], esi
		mov	[edi+38h], ebx
		xor	eax, eax

loc_1000E522:				; CODE XREF: sub_1000E2A0+20Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E535:				; CODE XREF: sub_1000E2A0+252j
					; sub_1000E2A0+265j ...
		push	eax		; jumptable 1000E4F4 default case
		call	sub_100177F0
		mov	ecx, [esp+40h+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		mov	eax, 91h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_1000E2A0	endp

; ---------------------------------------------------------------------------
		align 4
off_1000E558	dd offset loc_1000E2F0,	offset loc_1000E2EA, offset loc_1000E324
					; DATA XREF: sub_1000E2A0+43r
		dd offset loc_1000E31F,	offset loc_1000E351, offset loc_1000E34C ; jump	table for switch statement
		dd offset loc_1000E37E,	offset loc_1000E439
byte_1000E578	db	0,     1,     7,     7 ; DATA XREF: sub_1000E2A0+3Cr
		db	7,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	2,     3,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     4,     5,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	6
		align 4
off_1000E5BC	dd offset loc_1000E4FB	; DATA XREF: sub_1000E2A0+254r
		dd offset loc_1000E4FB	; jump table for switch	statement
		dd offset loc_1000E500
		dd offset loc_1000E500
		dd offset loc_1000E500
		dd offset loc_1000E500
		dd offset loc_1000E500
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E5E0	proc near		; CODE XREF: sub_10002BB0+161p
					; sub_10002BB0+20Ep ...

var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		push	800h
		or	esi, 0FFFFFFFFh
		mov	[esp+1Ch+var_8], ebx
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1000E67E
		mov	eax, [esp+18h+arg_18]
		mov	ecx, [esp+18h+arg_14]
		mov	edx, [esp+18h+arg_0]
		push	eax
		push	ecx
		push	edx
		call	SGN_CreateDigestInfo_Util
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_1000E67E
		push	ebx
		push	offset dword_100291E0
		lea	eax, [esp+20h+var_C]
		push	eax
		push	edi
		call	DER_Encode_Util
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000E67E
		mov	ecx, [esp+18h+var_4]
		mov	edx, [esp+18h+var_8]
		mov	eax, [esp+18h+arg_10]
		push	ecx
		mov	ecx, [esp+1Ch+arg_C]
		push	edx
		mov	edx, [esp+20h+arg_8]
		push	eax
		mov	eax, [esp+24h+arg_4]
		push	ecx
		push	edx
		add	eax, 8
		push	eax
		call	sub_100229A0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000E67E
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E67E
		mov	dword_10029554,	1

loc_1000E67E:				; CODE XREF: sub_1000E5E0+20j
					; sub_1000E5E0+3Dj ...
		push	ebx
		call	SGN_DestroyDigestInfo_Util
		add	esp, 4
		test	edi, edi
		jz	short loc_1000E696
		push	0
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000E696:				; CODE XREF: sub_1000E5E0+A9j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000E5E0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000E6A0:				; DATA XREF: sub_10012FD0:loc_1001336Co
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000E6BB
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000E6BB:				; CODE XREF: .text:1000E6A8j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100229A0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000E6FD
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E6FD
		mov	dword_10029554,	1

loc_1000E6FD:				; CODE XREF: .text:1000E6E5j
					; .text:1000E6F1j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000E710:				; DATA XREF: sub_10012FD0:loc_10013375o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000E72B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000E72B:				; CODE XREF: .text:1000E718j
		mov	ecx, [esp+18h]
		mov	edx, [esp+14h]
		push	esi
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	ecx
		mov	ecx, [esp+18h]
		push	edx
		push	ecx
		add	eax, 8
		push	eax
		call	sub_100226E0
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_1000E76D
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E76D
		mov	dword_10029554,	1

loc_1000E76D:				; CODE XREF: .text:1000E755j
					; .text:1000E761j
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000E780:				; DATA XREF: sub_10012FD0+49Do
		mov	eax, [esp+4]
		mov	edx, [eax+8]
		cmp	dword ptr [edx+4], 1
		mov	ecx, [eax+4]
		jz	short loc_1000E7A1
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000E7A1:				; CODE XREF: .text:1000E78Ej
		mov	eax, [ecx]
		push	ebx
		push	esi
		call	sub_1000BF00
		mov	esi, eax
		mov	eax, [ecx+4]
		call	sub_1000BF00
		mov	ebx, [esp+20h]
		mov	ecx, [ecx+8]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		mov	ebx, [esp+20h]
		push	ebx
		push	ecx
		push	0
		push	eax
		add	edx, 8
		push	esi
		push	edx
		call	sub_10022920
		mov	esi, eax
		add	esp, 28h
		test	esi, esi
		jz	short loc_1000E7FD
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E7FD
		mov	dword_10029554,	1

loc_1000E7FD:				; CODE XREF: .text:1000E7E5j
					; .text:1000E7F1j
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E810	proc near		; DATA XREF: sub_10013A30+4B3o

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_8]
		mov	edx, [esp+18h+arg_C]
		mov	[esp+18h+var_8], eax
		mov	eax, [esp+18h+arg_10]
		mov	[esp+18h+var_4], ecx
		mov	[esp+18h+var_10], eax
		mov	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_18]
		mov	[esp+18h+var_14], edx
		push	ecx
		lea	edx, [esp+1Ch+var_C]
		push	edx
		add	eax, 8
		push	eax
		call	sub_10020C70
		add	esp, 24h
		retn
sub_1000E810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E850	proc near		; DATA XREF: sub_10012FD0+500o

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_C]
		mov	edx, [esp+18h+arg_10]
		mov	[esp+18h+var_14], eax
		mov	eax, [esp+18h+arg_14]
		push	esi
		mov	[esp+1Ch+var_10], ecx
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_0]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_8], edx
		push	ecx
		lea	edx, [esp+20h+var_18]
		push	edx
		add	eax, 8
		push	eax
		call	sub_10020C40
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1000E8BB
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E8CC
		mov	ecx, [esp+1Ch+arg_8]
		mov	edx, [esp+1Ch+var_10]
		mov	dword_10029554,	1
		mov	eax, esi
		mov	[ecx], edx
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000E8BB:				; CODE XREF: sub_1000E850+42j
		mov	eax, [esp+1Ch+arg_8]
		mov	ecx, [esp+1Ch+var_10]
		mov	[eax], ecx
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000E8CC:				; CODE XREF: sub_1000E850+4Ej
		mov	eax, [esp+1Ch+var_10]
		mov	edx, [esp+1Ch+arg_8]
		mov	[edx], eax
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
sub_1000E850	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E8E0	proc near		; DATA XREF: sub_10013A30+72Do

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_8]
		mov	edx, [esp+18h+arg_C]
		mov	[esp+18h+var_8], eax
		mov	eax, [esp+18h+arg_10]
		mov	[esp+18h+var_4], ecx
		mov	[esp+18h+var_10], eax
		mov	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_18]
		mov	[esp+18h+var_14], edx
		push	ecx
		lea	edx, [esp+1Ch+var_C]
		push	edx
		add	eax, 8
		push	eax
		call	sub_10021F70
		add	esp, 24h
		retn
sub_1000E8E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E920	proc near		; DATA XREF: sub_10012FD0+779o

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_C]
		mov	edx, [esp+18h+arg_10]
		mov	[esp+18h+var_14], eax
		mov	eax, [esp+18h+arg_14]
		push	esi
		mov	[esp+1Ch+var_10], ecx
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_0]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_8], edx
		push	ecx
		lea	edx, [esp+20h+var_18]
		push	edx
		add	eax, 8
		push	eax
		call	sub_10021F30
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1000E98B
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000E99C
		mov	ecx, [esp+1Ch+arg_8]
		mov	edx, [esp+1Ch+var_10]
		mov	dword_10029554,	1
		mov	eax, esi
		mov	[ecx], edx
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000E98B:				; CODE XREF: sub_1000E920+42j
		mov	eax, [esp+1Ch+arg_8]
		mov	ecx, [esp+1Ch+var_10]
		mov	[eax], ecx
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000E99C:				; CODE XREF: sub_1000E920+4Ej
		mov	eax, [esp+1Ch+var_10]
		mov	edx, [esp+1Ch+arg_8]
		mov	[edx], eax
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
sub_1000E920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E9B0	proc near		; CODE XREF: sub_1000EA30+B4p
					; sub_1000EF80+B4p

var_4		= byte ptr -4

		push	ecx
		mov	ecx, [eax+10h]
		push	ecx
		push	edx
		push	10h
		lea	ecx, [esp+10h+var_4]
		push	ecx
		mov	ecx, [eax+3Ch]
		lea	edx, [eax+28h]
		push	edx
		mov	edx, [eax+4Ch]
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1000E9D3
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E9D3:				; CODE XREF: sub_1000E9B0+1Fj
		call	PORT_GetError_Util
		add	esp, 4
		jmp	sub_1000BB00
sub_1000E9B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E9E0	proc near		; CODE XREF: sub_1000EB90+EFp
					; sub_1000F0E0:loc_1000F1CDp

var_4		= byte ptr -4

		push	ecx
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_1000EA2A
		mov	ecx, [esi+10h]
		sub	ecx, eax
		push	ecx		; Size
		lea	edx, [eax+esi+18h]
		push	0		; Val
		push	edx		; Dst
		call	memset
		mov	eax, [esi+10h]
		push	eax
		lea	ecx, [esi+18h]
		push	ecx
		mov	ecx, [esi+3Ch]
		push	10h
		lea	edx, [esp+1Ch+var_4]
		push	edx
		mov	edx, [esi+4Ch]
		lea	eax, [esi+28h]
		push	eax
		push	ecx
		call	edx
		add	esp, 24h
		test	eax, eax
		jz	short loc_1000EA2A
		call	PORT_GetError_Util
		add	esp, 4
		jmp	sub_1000BB00
; ---------------------------------------------------------------------------

loc_1000EA2A:				; CODE XREF: sub_1000E9E0+6j
					; sub_1000E9E0+3Bj
		xor	eax, eax
		pop	ecx
		retn
sub_1000E9E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000EA30(int,	void *Src, size_t Size)
sub_1000EA30	proc near		; CODE XREF: sub_10004340:loc_1000435Ej
					; sub_1000ECE0+84p ...

var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		push	ebx
		mov	ebx, [esp+0Ch+Size]
		push	ebp
		mov	ebp, [esp+10h+Src]
		push	eax
		call	sub_100164F0
		add	esp, 4
		mov	[esp+10h+var_8], eax
		test	eax, eax
		jnz	short loc_1000EA5D
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EA5D:				; CODE XREF: sub_1000EA30+20j
		push	esi
		mov	esi, [eax+3Ch]
		test	esi, esi
		jz	short loc_1000EA8F
		cmp	dword ptr [esi], 3
		jnz	short loc_1000EA8F
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000EA8F
		mov	eax, [esi+40h]
		mov	[esp+14h+Size],	0
		test	eax, eax
		jz	short loc_1000EAA4
		mov	ecx, [esi+50h]
		push	ebx
		push	ebp
		push	eax
		call	ecx
		add	esp, 0Ch
		jmp	loc_1000EB57
; ---------------------------------------------------------------------------

loc_1000EA8F:				; CODE XREF: sub_1000EA30+33j
					; sub_1000EA30+38j ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EAA4:				; CODE XREF: sub_1000EA30+4Dj
		mov	eax, [esi+14h]
		push	edi
		mov	edi, [esi+10h]
		mov	[esp+18h+Src], edi
		sub	edi, eax
		lea	ecx, [eax+esi+18h]
		cmp	ebx, edi
		jnb	short loc_1000EACC
		push	ebx		; Size
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		add	[esi+14h], ebx
		jmp	loc_1000EB56
; ---------------------------------------------------------------------------

loc_1000EACC:				; CODE XREF: sub_1000EA30+87j
		test	eax, eax
		jz	short loc_1000EAF1
		push	edi		; Size
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		lea	edx, [esi+18h]
		mov	eax, esi
		sub	ebx, edi
		add	ebp, edi
		call	sub_1000E9B0
		mov	[esp+18h+Size],	eax
		test	eax, eax
		jnz	short loc_1000EB6F

loc_1000EAF1:				; CODE XREF: sub_1000EA30+9Ej
		cmp	ebx, [esp+18h+Src]
		jb	short loc_1000EB41
		lea	edi, [esi+28h]
		lea	ebx, [ebx+0]

loc_1000EB00:				; CODE XREF: sub_1000EA30+10Fj
		mov	edx, [esi+10h]
		mov	ecx, [esi+3Ch]
		push	edx
		mov	edx, [esi+4Ch]
		push	ebp
		push	10h
		lea	eax, [esp+24h+var_4]
		push	eax
		push	edi
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1000EB23
		mov	[esp+18h+Size],	eax
		jmp	short loc_1000EB35
; ---------------------------------------------------------------------------

loc_1000EB23:				; CODE XREF: sub_1000EA30+EBj
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	[esp+18h+Size],	eax
		test	eax, eax
		jnz	short loc_1000EB6F

loc_1000EB35:				; CODE XREF: sub_1000EA30+F1j
		mov	eax, [esp+18h+Src]
		sub	ebx, eax
		add	ebp, eax
		cmp	ebx, eax
		jnb	short loc_1000EB00

loc_1000EB41:				; CODE XREF: sub_1000EA30+C5j
		mov	[esi+14h], ebx
		test	ebx, ebx
		jz	short loc_1000EB56
		push	ebx		; Size
		push	ebp		; Src
		add	esi, 18h
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000EB56:				; CODE XREF: sub_1000EA30+97j
					; sub_1000EA30+116j ...
		pop	edi

loc_1000EB57:				; CODE XREF: sub_1000EA30+5Aj
		mov	ecx, [esp+14h+var_8]
		push	ecx
		call	sub_100177F0
		mov	eax, [esp+18h+Size]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EB6F:				; CODE XREF: sub_1000EA30+BFj
					; sub_1000EA30+103j
		push	esi
		call	sub_100176D0
		mov	eax, [esp+1Ch+var_8]
		add	esp, 4
		mov	dword ptr [eax+3Ch], 0
		jmp	short loc_1000EB56
sub_1000EA30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000EB90(int,	void *Dst, int)
sub_1000EB90	proc near		; CODE XREF: sub_10004370:loc_1000438Ej
					; sub_1000ECE0+99p
					; DATA XREF: ...

Size		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		mov	eax, [esp+54h+arg_8]
		mov	ecx, [esp+54h+arg_0]
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+60h+Dst]
		mov	[esp+60h+var_48], eax
		mov	eax, [eax]
		push	ecx
		mov	[esp+64h+var_50], eax
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000EBDD
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000EBDD:				; CODE XREF: sub_1000EB90+34j
		mov	esi, [ebx+3Ch]
		test	esi, esi
		jz	short loc_1000EC09
		cmp	dword ptr [esi], 3
		jnz	short loc_1000EC09
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000EC09
		mov	eax, [esi+40h]
		push	ebp
		xor	ebp, ebp
		test	eax, eax
		jz	short loc_1000EC6E
		test	edi, edi
		jnz	short loc_1000EC29
		mov	eax, [esi+64h]
		mov	[esp+64h+Size],	eax
		jmp	loc_1000ECB7
; ---------------------------------------------------------------------------

loc_1000EC09:				; CODE XREF: sub_1000EB90+52j
					; sub_1000EB90+57j ...
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 91h
		pop	ebx
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000EC29:				; CODE XREF: sub_1000EB90+6Bj
		push	40h
		lea	edx, [esp+68h+var_4C]
		push	edx
		mov	edx, [esi+54h]
		lea	ecx, [esp+6Ch+var_44]
		push	ecx
		push	eax
		call	edx
		mov	eax, [esp+74h+var_4C]
		mov	edx, [esp+74h+var_50]
		push	eax
		lea	ecx, [esp+78h+var_44]
		push	ecx
		mov	ecx, [esi+3Ch]
		push	edx
		mov	edx, [esi+4Ch]
		lea	eax, [esp+80h+Size]
		push	eax
		push	edi
		push	ecx
		call	edx
		add	esp, 28h
		test	eax, eax
		jz	short loc_1000EC9C
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	ebp, eax
		jmp	short loc_1000EC9C
; ---------------------------------------------------------------------------

loc_1000EC6E:				; CODE XREF: sub_1000EB90+67j
		mov	eax, [esi+38h]
		mov	[esp+64h+Size],	eax
		test	edi, edi
		jz	short loc_1000ECB7
		cmp	[esp+64h+var_50], eax
		jb	short loc_1000ECB2
		call	sub_1000E9E0
		mov	ebp, eax
		test	ebp, ebp
		jnz	short loc_1000EC9C
		mov	eax, [esp+64h+Size]
		push	eax		; Size
		lea	ecx, [esi+28h]
		push	ecx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000EC9C:				; CODE XREF: sub_1000EB90+CEj
					; sub_1000EB90+DCj ...
		push	esi
		call	sub_100176D0
		mov	dword ptr [ebx+3Ch], 0
		mov	eax, [esp+68h+Size]
		add	esp, 4
		jmp	short loc_1000ECB7
; ---------------------------------------------------------------------------

loc_1000ECB2:				; CODE XREF: sub_1000EB90+EDj
		mov	ebp, 150h

loc_1000ECB7:				; CODE XREF: sub_1000EB90+74j
					; sub_1000EB90+E7j ...
		mov	edx, [esp+64h+var_48]
		push	ebx
		mov	[edx], eax
		call	sub_100177F0
		mov	ecx, [esp+68h+var_4]
		add	esp, 4
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
sub_1000EB90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ECE0(int,	void *Src, size_t Size,	void *Dst, int)
sub_1000ECE0	proc near		; CODE XREF: sub_10004310:loc_1000432Ej
					; sub_1000EDF0j ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch
Dst		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 8
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		push	ebp
		call	sub_100164F0
		add	esp, 4
		mov	[esp+10h+var_8], eax
		test	eax, eax
		jnz	short loc_1000ED05
		pop	esi
		mov	eax, 0B3h
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000ED05:				; CODE XREF: sub_1000ECE0+18j
		mov	esi, [eax+3Ch]
		test	esi, esi
		jz	short loc_1000ED35
		cmp	dword ptr [esi], 3
		jnz	short loc_1000ED35
		push	ebx
		push	edi
		mov	edi, [esp+18h+Dst]
		xor	ebx, ebx
		test	edi, edi
		jnz	short loc_1000ED54
		cmp	[esi+4], ebx
		jz	short loc_1000ED49
		cmp	[esi+40h], ebx
		jnz	short loc_1000ED49
		mov	esi, [esi+38h]
		mov	eax, [esp+18h+arg_10]
		mov	[eax], esi
		jmp	loc_1000EDD2
; ---------------------------------------------------------------------------

loc_1000ED35:				; CODE XREF: sub_1000ECE0+2Aj
					; sub_1000ECE0+2Fj
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	esi
		mov	eax, 91h
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000ED49:				; CODE XREF: sub_1000ECE0+40j
					; sub_1000ECE0+45j
		mov	esi, [esi+64h]
		mov	eax, [esp+18h+arg_10]
		mov	[eax], esi
		jmp	short loc_1000EDD2
; ---------------------------------------------------------------------------

loc_1000ED54:				; CODE XREF: sub_1000ECE0+3Bj
		mov	ecx, [esp+18h+Size]
		mov	edx, [esp+18h+Src]
		push	ecx		; Size
		push	edx		; Src
		cmp	[esi+4], ebx
		jz	short loc_1000ED85
		push	ebp		; int
		call	sub_1000EA30
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1000EDD2
		mov	eax, [esp+18h+arg_10]
		push	eax		; int
		push	edi		; Dst
		push	ebp		; int
		call	sub_1000EB90
		add	esp, 0Ch
		mov	ebx, eax
		jmp	short loc_1000EDD2
; ---------------------------------------------------------------------------

loc_1000ED85:				; CODE XREF: sub_1000ECE0+81j
		mov	ebp, [esp+20h+arg_10]
		mov	eax, [ebp+0]
		mov	ecx, [esi+3Ch]
		mov	edx, [esi+4Ch]
		push	eax
		lea	eax, [esp+24h+var_4]
		push	eax
		push	edi
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000EDAF
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	ebx, eax

loc_1000EDAF:				; CODE XREF: sub_1000ECE0+C1j
		mov	eax, [esp+18h+var_4]
		mov	[ebp+0], eax
		cmp	ebx, 150h
		jz	short loc_1000EDD2
		push	esi
		call	sub_100176D0
		mov	ecx, [esp+1Ch+var_8]
		add	esp, 4
		mov	dword ptr [ecx+3Ch], 0

loc_1000EDD2:				; CODE XREF: sub_1000ECE0+50j
					; sub_1000ECE0+72j ...
		mov	edx, [esp+18h+var_8]
		push	edx
		call	sub_100177F0
		add	esp, 4
		pop	edi
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 8
		retn
sub_1000ECE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_1000EDF0	proc near		; CODE XREF: sub_10004400:loc_1000441Ej
					; DATA XREF: .rdata:1002606Eo
		jmp	sub_1000ECE0
sub_1000EDF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000EE00	proc near		; CODE XREF: sub_10002BB0+1BBp
					; sub_10002BB0+26Bp ...

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 18h
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+14h]
		push	edi
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000EE33
		push	0FFFFE013h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000EE33:				; CODE XREF: sub_1000EE00+1Aj
		mov	eax, [esp+24h+arg_C]
		mov	ecx, [esp+24h+arg_8]
		push	eax
		push	ecx
		push	edi
		lea	edx, [esp+30h+var_10]
		push	edx
		push	esi
		add	ebx, 8
		push	ebx
		mov	[esp+3Ch+var_14], esi
		mov	[esp+3Ch+var_10], edi
		call	sub_10022A20
		mov	edi, eax
		add	esp, 18h
		test	edi, edi
		jz	short loc_1000EE7D
		push	0FFFFE00Ah
		call	PORT_SetError_Util
		add	esp, 4
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000EE7D:				; CODE XREF: sub_1000EE00+5Cj
		mov	eax, [esp+24h+arg_10]
		mov	ecx, [esp+24h+arg_14]
		push	1
		lea	edx, [esp+28h+var_18]
		mov	[esp+28h+var_8], eax
		push	edx
		lea	eax, [esp+2Ch+var_C]
		mov	[esp+2Ch+var_4], ecx
		mov	ecx, [esp+2Ch+arg_0]
		push	eax
		push	ecx
		call	_SGN_VerifyPKCS1DigestInfo
		add	esp, 10h
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 18h
		retn
sub_1000EE00	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000EEC0:				; DATA XREF: sub_10013A30:loc_10013DB4o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000EEDB
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000EEDB:				; CODE XREF: .text:1000EEC8j
		add	eax, 8
		mov	[esp+4], eax
		jmp	loc_100229E0
; ---------------------------------------------------------------------------
		align 10h

loc_1000EEF0:				; DATA XREF: sub_10013A30:loc_10013DBDo
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000EF0B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000EF0B:				; CODE XREF: .text:1000EEF8j
		add	eax, 8
		mov	[esp+4], eax
		jmp	loc_10022720
; ---------------------------------------------------------------------------
		align 10h

loc_1000EF20:				; DATA XREF: sub_10013A30+45Fo
		mov	eax, [esp+4]
		mov	edx, [eax+8]
		cmp	dword ptr [edx+4], 1
		mov	ecx, [eax+4]
		jz	short loc_1000EF41
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000EF41:				; CODE XREF: .text:1000EF2Ej
		mov	eax, [ecx]
		push	esi
		push	edi
		call	sub_1000BF00
		mov	esi, eax
		mov	eax, [ecx+4]
		call	sub_1000BF00
		mov	edi, [esp+1Ch]
		mov	ecx, [ecx+8]
		push	edi
		mov	edi, [esp+1Ch]
		push	edi
		mov	edi, [esp+1Ch]
		push	edi
		mov	edi, [esp+1Ch]
		push	edi
		push	ecx
		push	eax
		add	edx, 8
		push	esi
		push	edx
		call	sub_10022960
		add	esp, 20h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000EF80(int,	void *Src, size_t Size)
sub_1000EF80	proc near		; CODE XREF: sub_100044C0:loc_100044DEj
					; sub_10012EB0+2Dp ...

var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		push	ebx
		mov	ebx, [esp+0Ch+Size]
		push	ebp
		mov	ebp, [esp+10h+Src]
		push	eax
		call	sub_100164F0
		add	esp, 4
		mov	[esp+10h+var_8], eax
		test	eax, eax
		jnz	short loc_1000EFAD
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EFAD:				; CODE XREF: sub_1000EF80+20j
		push	esi
		mov	esi, [eax+3Ch]
		test	esi, esi
		jz	short loc_1000EFDF
		cmp	dword ptr [esi], 5
		jnz	short loc_1000EFDF
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000EFDF
		mov	eax, [esi+40h]
		mov	[esp+14h+Size],	0
		test	eax, eax
		jz	short loc_1000EFF4
		mov	ecx, [esi+50h]
		push	ebx
		push	ebp
		push	eax
		call	ecx
		add	esp, 0Ch
		jmp	loc_1000F0A7
; ---------------------------------------------------------------------------

loc_1000EFDF:				; CODE XREF: sub_1000EF80+33j
					; sub_1000EF80+38j ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EFF4:				; CODE XREF: sub_1000EF80+4Dj
		mov	eax, [esi+14h]
		push	edi
		mov	edi, [esi+10h]
		mov	[esp+18h+Src], edi
		sub	edi, eax
		lea	ecx, [eax+esi+18h]
		cmp	ebx, edi
		jnb	short loc_1000F01C
		push	ebx		; Size
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		add	[esi+14h], ebx
		jmp	loc_1000F0A6
; ---------------------------------------------------------------------------

loc_1000F01C:				; CODE XREF: sub_1000EF80+87j
		test	eax, eax
		jz	short loc_1000F041
		push	edi		; Size
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		lea	edx, [esi+18h]
		mov	eax, esi
		sub	ebx, edi
		add	ebp, edi
		call	sub_1000E9B0
		mov	[esp+18h+Size],	eax
		test	eax, eax
		jnz	short loc_1000F0BF

loc_1000F041:				; CODE XREF: sub_1000EF80+9Ej
		cmp	ebx, [esp+18h+Src]
		jb	short loc_1000F091
		lea	edi, [esi+28h]
		lea	ebx, [ebx+0]

loc_1000F050:				; CODE XREF: sub_1000EF80+10Fj
		mov	edx, [esi+10h]
		mov	ecx, [esi+3Ch]
		push	edx
		mov	edx, [esi+4Ch]
		push	ebp
		push	10h
		lea	eax, [esp+24h+var_4]
		push	eax
		push	edi
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1000F073
		mov	[esp+18h+Size],	eax
		jmp	short loc_1000F085
; ---------------------------------------------------------------------------

loc_1000F073:				; CODE XREF: sub_1000EF80+EBj
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	[esp+18h+Size],	eax
		test	eax, eax
		jnz	short loc_1000F0BF

loc_1000F085:				; CODE XREF: sub_1000EF80+F1j
		mov	eax, [esp+18h+Src]
		sub	ebx, eax
		add	ebp, eax
		cmp	ebx, eax
		jnb	short loc_1000F050

loc_1000F091:				; CODE XREF: sub_1000EF80+C5j
		mov	[esi+14h], ebx
		test	ebx, ebx
		jz	short loc_1000F0A6
		push	ebx		; Size
		push	ebp		; Src
		add	esi, 18h
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000F0A6:				; CODE XREF: sub_1000EF80+97j
					; sub_1000EF80+116j ...
		pop	edi

loc_1000F0A7:				; CODE XREF: sub_1000EF80+5Aj
		mov	ecx, [esp+14h+var_8]
		push	ecx
		call	sub_100177F0
		mov	eax, [esp+18h+Size]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000F0BF:				; CODE XREF: sub_1000EF80+BFj
					; sub_1000EF80+103j
		push	esi
		call	sub_100176D0
		mov	eax, [esp+1Ch+var_8]
		add	esp, 4
		mov	dword ptr [eax+3Ch], 0
		jmp	short loc_1000F0A6
sub_1000EF80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F0E0	proc near		; CODE XREF: sub_100044F0:loc_1000450Ej
					; sub_100142F0+57p
					; DATA XREF: ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	edi
		mov	edi, [esp+4Ch+arg_4]
		test	edi, edi
		jnz	short loc_1000F10A
		lea	eax, [edi+7]
		pop	edi
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000F10A:				; CODE XREF: sub_1000F0E0+15j
		mov	eax, [esp+4Ch+arg_0]
		push	ebx
		push	esi
		push	eax
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		mov	[esp+54h+var_48], ebx
		test	ebx, ebx
		jnz	short loc_1000F13A
		pop	esi
		pop	ebx
		mov	eax, 0B3h
		pop	edi
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000F13A:				; CODE XREF: sub_1000F0E0+41j
		mov	esi, [ebx+3Ch]
		test	esi, esi
		jz	short loc_1000F19D
		cmp	dword ptr [esi], 5
		jnz	short loc_1000F19D
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000F19D
		mov	eax, [esi+40h]
		push	ebp
		xor	ebp, ebp
		test	eax, eax
		jz	short loc_1000F1BD
		push	40h
		lea	ecx, [esp+5Ch+var_48]
		push	ecx
		lea	edx, [esp+60h+var_44]
		push	edx
		push	eax
		mov	eax, [esi+54h]
		call	eax
		mov	ecx, [esp+68h+var_48]
		mov	eax, [esp+68h+arg_8]
		push	ecx
		mov	ecx, [esi+3Ch]
		lea	edx, [esp+6Ch+var_44]
		push	edx
		mov	edx, [esi+60h]
		push	eax
		push	edi
		push	ecx
		call	edx
		add	esp, 24h
		test	eax, eax
		jz	loc_1000F223
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	ebp, eax
		jmp	loc_1000F223
; ---------------------------------------------------------------------------

loc_1000F19D:				; CODE XREF: sub_1000F0E0+5Fj
					; sub_1000F0E0+64j ...
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebx
		mov	eax, 91h
		pop	edi
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000F1BD:				; CODE XREF: sub_1000F0E0+74j
		mov	ebx, [esp+58h+arg_8]
		cmp	ebx, [esi+38h]
		jz	short loc_1000F1CD
		mov	ebp, 0C1h
		jmp	short loc_1000F21F
; ---------------------------------------------------------------------------

loc_1000F1CD:				; CODE XREF: sub_1000F0E0+E4j
		call	sub_1000E9E0
		mov	ebp, eax
		test	ebp, ebp
		jnz	short loc_1000F21F
		mov	eax, ebx
		lea	ecx, [esi+28h]
		cmp	ebx, 4
		jb	short loc_1000F1F6

loc_1000F1E2:				; CODE XREF: sub_1000F0E0+114j
		mov	edx, [edi]
		cmp	edx, [ecx]
		jnz	short loc_1000F21A
		sub	eax, 4
		add	ecx, 4
		add	edi, 4
		cmp	eax, 4
		jnb	short loc_1000F1E2

loc_1000F1F6:				; CODE XREF: sub_1000F0E0+100j
		test	eax, eax
		jz	short loc_1000F21F
		mov	dl, [ecx]
		cmp	dl, [edi]
		jnz	short loc_1000F21A
		cmp	eax, 1
		jbe	short loc_1000F21F
		mov	dl, [ecx+1]
		cmp	dl, [edi+1]
		jnz	short loc_1000F21A
		cmp	eax, 2
		jbe	short loc_1000F21F
		mov	al, [ecx+2]
		cmp	al, [edi+2]
		jz	short loc_1000F21F

loc_1000F21A:				; CODE XREF: sub_1000F0E0+106j
					; sub_1000F0E0+11Ej ...
		mov	ebp, 0C0h

loc_1000F21F:				; CODE XREF: sub_1000F0E0+EBj
					; sub_1000F0E0+F6j ...
		mov	ebx, [esp+58h+var_48]

loc_1000F223:				; CODE XREF: sub_1000F0E0+A6j
					; sub_1000F0E0+B8j
		push	esi
		call	sub_100176D0
		push	ebx
		mov	dword ptr [ebx+3Ch], 0
		call	sub_100177F0
		mov	ecx, [esp+60h+var_4]
		add	esp, 8
		mov	eax, ebp
		pop	ebp
		pop	esi
		pop	ebx
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_1000F0E0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000F250:				; DATA XREF: sub_1000F2B0+19Co
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000F26B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000F26B:				; CODE XREF: .text:1000F258j
		add	eax, 8
		mov	[esp+4], eax
		jmp	sub_10022A20
; ---------------------------------------------------------------------------
		align 10h

loc_1000F280:				; DATA XREF: sub_1000F2B0+195o
		mov	eax, [esp+4]
		cmp	dword ptr [eax+4], 1
		jz	short loc_1000F29B
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000F29B:				; CODE XREF: .text:1000F288j
		add	eax, 8
		mov	[esp+4], eax
		jmp	loc_10022760
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F2B0	proc near		; CODE XREF: sub_10004520+31p
					; DATA XREF: .rdata:10026082o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_0]
		push	ebx
		push	ebp
		xor	ebx, ebx
		push	eax
		mov	[esp+18h+var_C], ebx
		call	sub_100164F0
		mov	ebp, eax
		add	esp, 4
		cmp	ebp, ebx
		jnz	short loc_1000F2D9
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000F2D9:				; CODE XREF: sub_1000F2B0+1Cj
		push	esi
		cmp	[ebp+3Ch], ebx
		jz	short loc_1000F2ED
		mov	esi, [esp+18h+var_C]
		mov	eax, 90h
		jmp	loc_1000F3D4
; ---------------------------------------------------------------------------

loc_1000F2ED:				; CODE XREF: sub_1000F2B0+2Dj
		mov	ecx, [esp+18h+arg_8]
		push	ebp
		push	ecx
		call	sub_10017DA0
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	short loc_1000F30F
		mov	esi, [esp+18h+var_C]
		mov	eax, 60h
		jmp	loc_1000F3D4
; ---------------------------------------------------------------------------

loc_1000F30F:				; CODE XREF: sub_1000F2B0+4Fj
		mov	eax, [esi+8]
		cmp	eax, 4
		jz	short loc_1000F31C
		cmp	eax, 2
		jnz	short loc_1000F32E

loc_1000F31C:				; CODE XREF: sub_1000F2B0+65j
		push	10Bh
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000F345

loc_1000F32E:				; CODE XREF: sub_1000F2B0+6Aj
					; sub_1000F2B0+A5j
		push	esi
		call	sub_10016D30
		mov	esi, [esp+1Ch+var_C]
		mov	eax, 63h
		add	esp, 4
		jmp	loc_1000F3D4
; ---------------------------------------------------------------------------

loc_1000F345:				; CODE XREF: sub_1000F2B0+7Cj
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_1000F32E
		cmp	dword ptr [eax+1Ch], 4
		push	eax
		jz	short loc_1000F377
		call	sub_10015D70
		push	esi
		call	sub_10016D30
		mov	esi, [esp+20h+var_C]
		add	esp, 8
		mov	eax, 13h
		jmp	short loc_1000F3D4
; ---------------------------------------------------------------------------

loc_1000F377:				; CODE XREF: sub_1000F2B0+ACj
		mov	edx, [eax+18h]
		mov	ecx, [edx]
		mov	[esp+1Ch+var_8], ecx
		call	sub_10015D70
		push	6Ch
		mov	[esp+20h+var_4], esi
		call	PORT_Alloc_Util
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_1000F3AB
		push	esi
		call	sub_10016D30
		mov	esi, [esp+1Ch+var_C]
		mov	eax, 2
		add	esp, 4
		jmp	short loc_1000F3D4
; ---------------------------------------------------------------------------

loc_1000F3AB:				; CODE XREF: sub_1000F2B0+E5j
		mov	[eax+68h], esi
		mov	dword ptr [eax], 6
		mov	dword ptr [eax+4], 1
		mov	[eax+8], ebx
		mov	[eax+3Ch], ebx
		mov	[eax+40h], ebx
		mov	[eax+0Ch], ebx
		mov	[eax+14h], ebx
		mov	[eax+10h], ebx
		mov	[eax+64h], ebx
		mov	esi, eax
		xor	eax, eax

loc_1000F3D4:				; CODE XREF: sub_1000F2B0+38j
					; sub_1000F2B0+5Aj ...
		mov	[esp+18h+var_C], eax
		cmp	eax, ebx
		jz	short loc_1000F3F0
		push	ebp
		call	sub_100177F0
		mov	eax, [esp+1Ch+var_C]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000F3F0:				; CODE XREF: sub_1000F2B0+12Aj
		mov	ecx, 1
		push	edi
		mov	edi, [esp+1Ch+arg_4]
		mov	[esi+4], ecx
		mov	eax, [edi]
		sub	eax, ecx
		jz	short loc_1000F412
		sub	eax, 2
		jz	short loc_1000F412
		mov	[esp+1Ch+var_C], 70h
		jmp	short loc_1000F461
; ---------------------------------------------------------------------------

loc_1000F412:				; CODE XREF: sub_1000F2B0+151j
					; sub_1000F2B0+156j
		cmp	[esp+1Ch+var_8], ebx
		jz	short loc_1000F422
		mov	[esp+1Ch+var_C], 63h
		jmp	short loc_1000F461
; ---------------------------------------------------------------------------

loc_1000F422:				; CODE XREF: sub_1000F2B0+166j
		mov	eax, [esp+1Ch+var_4]
		lea	edx, [esp+1Ch+var_C]
		push	edx
		push	ebx
		push	eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		call	sub_100072C0
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_1000F45B
		mov	[esi+3Ch], eax
		cmp	dword ptr [edi], 3
		mov	eax, offset loc_1000F280
		jz	short loc_1000F451
		mov	eax, offset loc_1000F250

loc_1000F451:				; CODE XREF: sub_1000F2B0+19Aj
		mov	[esi+4Ch], eax
		mov	dword ptr [esi+58h], offset nullsub_1

loc_1000F45B:				; CODE XREF: sub_1000F2B0+18Dj
		cmp	[esp+1Ch+var_C], ebx
		jz	short loc_1000F47C

loc_1000F461:				; CODE XREF: sub_1000F2B0+160j
					; sub_1000F2B0+170j
		push	esi
		call	PORT_Free_Util
		push	ebp
		call	sub_100177F0
		mov	eax, [esp+24h+var_C]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000F47C:				; CODE XREF: sub_1000F2B0+1AFj
		push	ebp
		mov	[ebp+3Ch], esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000F2B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F4A0	proc near		; CODE XREF: sub_10004580:loc_1000459Ej
					; DATA XREF: .rdata:10026086o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_10]
		mov	ebx, [ebp+0]
		push	esi
		push	edi
		push	eax
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000F4C8
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F4C8:				; CODE XREF: sub_1000F4A0+1Cj
		mov	esi, [edi+3Ch]
		test	esi, esi
		jz	short loc_1000F4D4
		cmp	dword ptr [esi], 6
		jz	short loc_1000F4E7

loc_1000F4D4:				; CODE XREF: sub_1000F4A0+2Dj
		push	edi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F4E7:				; CODE XREF: sub_1000F4A0+32j
		mov	eax, [esp+10h+arg_C]
		test	eax, eax
		jnz	short loc_1000F4FA
		mov	ecx, [esp+10h+arg_8]
		mov	[ebp+0], ecx
		xor	ebx, ebx
		jmp	short loc_1000F52D
; ---------------------------------------------------------------------------

loc_1000F4FA:				; CODE XREF: sub_1000F4A0+4Dj
		mov	edx, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		push	edx
		push	ecx
		mov	ecx, [esi+4Ch]
		push	ebx
		lea	edx, [esp+1Ch+arg_10]
		push	edx
		push	eax
		mov	eax, [esi+3Ch]
		push	eax
		call	ecx
		mov	edx, [esp+28h+arg_10]
		push	esi
		mov	ebx, eax
		mov	[ebp+0], edx
		call	sub_100176D0
		add	esp, 1Ch
		mov	dword ptr [edi+3Ch], 0

loc_1000F52D:				; CODE XREF: sub_1000F4A0+58j
		push	edi
		call	sub_100177F0
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000F541
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F541:				; CODE XREF: sub_1000F4A0+98j
		call	PORT_GetError_Util
		call	sub_1000BB00
		cmp	eax, 30h
		jnz	short loc_1000F555
		mov	eax, 0C0h

loc_1000F555:				; CODE XREF: sub_1000F4A0+AEj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1000F4A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F560	proc near		; CODE XREF: sub_10004910+1Ep
					; DATA XREF: .rdata:100260AEo

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	eax
		push	ecx
		call	sub_10021600
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000F577
		retn
; ---------------------------------------------------------------------------

loc_1000F577:				; CODE XREF: sub_1000F560+14j
		call	PORT_GetError_Util
		jmp	sub_1000BB00
sub_1000F560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F590	proc near		; CODE XREF: sub_10004950+54p
					; sub_100145A0+39Ap
					; DATA XREF: ...

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	eax
		push	ecx
		call	sub_10021640
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000F5A7
		retn
; ---------------------------------------------------------------------------

loc_1000F5A7:				; CODE XREF: sub_1000F590+14j
		call	PORT_GetError_Util
		jmp	sub_1000BB00
sub_1000F590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000F5C0(int,	void *Dst, int)
sub_1000F5C0	proc near		; CODE XREF: sub_100145A0+364p

var_18		= byte ptr -18h
Src		= dword	ptr -14h
Size		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 18h
		push	esi
		push	edi
		xor	edi, edi
		mov	[ebx], edi
		cmp	dword ptr [eax], 3B0h
		mov	[esp+20h+Src], edi
		mov	[esp+20h+Size],	edi
		jnz	short loc_1000F5EE
		mov	eax, [eax+4]
		mov	ecx, [eax+1Ch]
		mov	[esp+20h+var_8], ecx
		mov	edx, [eax+20h]
		mov	eax, [edx]
		mov	[esp+20h+var_4], eax
		jmp	short loc_1000F5FF
; ---------------------------------------------------------------------------

loc_1000F5EE:				; CODE XREF: sub_1000F5C0+17j
		mov	edi, [eax+4]
		mov	ecx, [edi+4]
		mov	[esp+20h+var_8], ecx
		mov	edx, [edi+8]
		mov	[esp+20h+var_4], edx

loc_1000F5FF:				; CODE XREF: sub_1000F5C0+2Cj
		mov	eax, [esp+20h+arg_8]
		push	eax
		mov	eax, [esp+24h+arg_0]
		lea	ecx, [esp+24h+var_18]
		push	ecx
		lea	edx, [esp+28h+var_C]
		push	edx
		push	eax
		call	sub_10005B90
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000F62A
		pop	edi
		lea	eax, [esi+2]
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000F62A:				; CODE XREF: sub_1000F5C0+5Fj
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		mov	eax, [esp+20h+Dst]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esi+8]
		push	1
		push	esi
		mov	[ebx], ecx
		call	SECITEM_ZfreeItem_Util
		mov	eax, [esp+34h+Src]
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000F67A
		test	edi, edi
		jz	short loc_1000F671
		mov	edi, [edi]
		test	edi, edi
		jz	short loc_1000F671
		mov	edx, [esp+20h+Size]
		push	edx		; Size
		push	eax		; Src
		push	edi		; Dst
		call	memcpy
		mov	eax, [esp+2Ch+Src]
		add	esp, 0Ch

loc_1000F671:				; CODE XREF: sub_1000F5C0+96j
					; sub_1000F5C0+9Cj
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000F67A:				; CODE XREF: sub_1000F5C0+92j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
sub_1000F5C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F690	proc near		; CODE XREF: sub_1000F6D0+119p
		cmp	eax, 400h
		ja	short loc_1000F69D
		mov	eax, 0A0h
		retn
; ---------------------------------------------------------------------------

loc_1000F69D:				; CODE XREF: sub_1000F690+5j
		cmp	eax, 800h
		ja	short loc_1000F6AA
		mov	eax, 0E0h
		retn
; ---------------------------------------------------------------------------

loc_1000F6AA:				; CODE XREF: sub_1000F690+12j
		cmp	eax, 0C00h
		ja	short loc_1000F6B7
		mov	eax, 100h
		retn
; ---------------------------------------------------------------------------

loc_1000F6B7:				; CODE XREF: sub_1000F690+1Fj
		mov	ecx, 1E00h
		cmp	ecx, eax
		sbb	eax, eax
		and	eax, 80h
		add	eax, 180h
		retn
sub_1000F690	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F6D0	proc near		; CODE XREF: sub_100145A0+3EBp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 10h
		push	ebp
		push	edi
		xor	edi, edi
		push	133h
		push	esi
		mov	[esp+20h+var_8], edi
		lea	ebp, [edi+8]
		mov	[esp+20h+var_10], edi
		mov	[esp+20h+var_C], edi
		call	sub_10016660
		add	esp, 8
		cmp	eax, edi
		jnz	short loc_1000F703
		pop	edi
		mov	eax, 0D0h
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000F703:				; CODE XREF: sub_1000F6D0+26j
		mov	ecx, [eax+18h]
		push	ebx
		mov	ebx, [ecx]
		push	eax
		call	sub_10015D70
		add	esp, 4
		cmp	ebx, 400h
		jnb	short loc_1000F74E
		lea	edx, [ebx-200h]
		cmp	edx, 200h
		ja	short loc_1000F742
		test	bl, 3Fh
		jnz	short loc_1000F742
		lea	eax, [ebx-200h]
		cdq
		and	edx, 3Fh
		lea	ebp, [edx+eax]
		sar	ebp, 6
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_1000F74E

loc_1000F742:				; CODE XREF: sub_1000F6D0+56j
					; sub_1000F6D0+5Bj
		pop	ebx
		pop	edi
		mov	eax, 13h
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000F74E:				; CODE XREF: sub_1000F6D0+48j
					; sub_1000F6D0+70j
		push	0CE534367h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_1000F76E
		mov	ecx, [eax+18h]
		mov	edi, [ecx]
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_1000F76E:				; CODE XREF: sub_1000F6D0+8Ej
		push	134h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_1000F792
		mov	edx, [eax+18h]
		mov	ecx, [edx]
		push	eax
		mov	[esp+20h+var_8], ecx
		call	sub_10015D70
		add	esp, 4

loc_1000F792:				; CODE XREF: sub_1000F6D0+AEj
		push	133h
		push	esi
		call	sub_10016B50
		push	134h
		push	esi
		call	sub_10016B50
		push	0CE534367h
		push	esi
		call	sub_10016B50
		add	esp, 18h
		cmp	ebx, 400h
		jb	short loc_1000F7C7
		jnz	short loc_1000F7E0
		cmp	[esp+1Ch+var_8], 0
		jnz	short loc_1000F7F2

loc_1000F7C7:				; CODE XREF: sub_1000F6D0+ECj
		test	edi, edi
		jnz	short loc_1000F816
		lea	edx, [esp+1Ch+var_C]
		push	edx
		lea	eax, [esp+20h+var_10]
		push	eax
		push	ebp
		call	sub_100216B0
		add	esp, 0Ch
		jmp	short loc_1000F82D
; ---------------------------------------------------------------------------

loc_1000F7E0:				; CODE XREF: sub_1000F6D0+EEj
		cmp	[esp+1Ch+var_8], 0
		jnz	short loc_1000F7F2
		mov	eax, ebx
		call	sub_1000F690
		mov	[esp+1Ch+var_8], eax

loc_1000F7F2:				; CODE XREF: sub_1000F6D0+F5j
					; sub_1000F6D0+115j
		test	edi, edi
		jnz	short loc_1000F7F8
		mov	edi, ebx

loc_1000F7F8:				; CODE XREF: sub_1000F6D0+124j
		mov	ecx, [esp+1Ch+var_8]
		lea	edx, [esp+1Ch+var_C]
		push	edx
		lea	eax, [esp+20h+var_10]
		push	eax
		shr	edi, 3
		push	edi
		push	ecx
		push	ebx
		call	sub_100225E0
		add	esp, 14h
		jmp	short loc_1000F82D
; ---------------------------------------------------------------------------

loc_1000F816:				; CODE XREF: sub_1000F6D0+F9j
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		lea	edx, [esp+20h+var_10]
		push	edx
		shr	edi, 3
		push	edi
		push	ebp
		call	sub_100216F0
		add	esp, 10h

loc_1000F82D:				; CODE XREF: sub_1000F6D0+10Ej
					; sub_1000F6D0+144j
		test	eax, eax
		jz	short loc_1000F857
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1000F847
		mov	dword_10029554,	1

loc_1000F847:				; CODE XREF: sub_1000F6D0+16Bj
		call	PORT_GetError_Util
		pop	ebx
		pop	edi
		pop	ebp
		add	esp, 10h
		jmp	sub_1000BB00
; ---------------------------------------------------------------------------

loc_1000F857:				; CODE XREF: sub_1000F6D0+15Fj
		mov	eax, [esp+1Ch+var_10]
		mov	ecx, [eax+0Ch]
		mov	edx, [eax+8]
		push	ecx
		push	edx
		push	130h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_1000F914
		mov	eax, [esp+1Ch+var_10]
		mov	ecx, [eax+18h]
		mov	edx, [eax+14h]
		push	ecx
		push	edx
		push	131h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1000F914
		mov	eax, [esp+1Ch+var_10]
		mov	ecx, [eax+24h]
		mov	edx, [eax+20h]
		push	ecx
		push	edx
		push	132h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1000F914
		mov	eax, [esp+1Ch+var_C]
		mov	ecx, [eax+4]
		push	4
		lea	edx, [esp+20h+var_4]
		push	edx
		push	0CE534364h
		push	esi
		mov	[esp+2Ch+var_4], ecx
		call	sub_10016BB0
		mov	eax, [esp+2Ch+var_C]
		mov	ecx, [eax+10h]
		mov	edx, [eax+0Ch]
		push	ecx
		push	edx
		push	0CE534365h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 20h
		test	edi, edi
		jnz	short loc_1000F914
		mov	eax, [esp+1Ch+var_C]
		mov	ecx, [eax+1Ch]
		mov	edx, [eax+18h]
		push	ecx
		push	edx
		push	0CE534366h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax

loc_1000F914:				; CODE XREF: sub_1000F6D0+1A5j
					; sub_1000F6D0+1C9j ...
		mov	eax, [esp+1Ch+var_10]
		push	eax
		call	sub_10021770
		mov	eax, [esp+20h+var_C]
		add	esp, 4
		test	eax, eax
		jz	short loc_1000F932
		push	eax
		call	sub_100217A0
		add	esp, 4

loc_1000F932:				; CODE XREF: sub_1000F6D0+257j
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	ebp
		add	esp, 10h
		retn
sub_1000F6D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F940	proc near		; CODE XREF: sub_100145A0+191p
					; sub_100145A0+1F9p
		push	esi
		mov	esi, eax
		xor	eax, eax
		cmp	esi, 140h
		ja	short loc_1000F9BA
		jz	short loc_1000F9AC
		add	esi, 0FFFFFF00h	; switch 50 cases
		cmp	esi, 31h
		ja	loc_1000F9FA	; jumptable 1000F965 default case
		movzx	esi, ds:byte_1000FA2C[esi]
		jmp	ds:off_1000FA14[esi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000F96C:				; CODE XREF: sub_1000F940+25j
					; DATA XREF: .text:off_1000FA14o
		mov	dword ptr [edx], 11h ; jumptable 1000F965 case 256
		jmp	loc_1000FA07
; ---------------------------------------------------------------------------

loc_1000F977:				; CODE XREF: sub_1000F940+25j
					; DATA XREF: .text:off_1000FA14o
		mov	dword ptr [edx], 12h ; jumptable 1000F965 case 272
		jmp	loc_1000FA07
; ---------------------------------------------------------------------------

loc_1000F982:				; CODE XREF: sub_1000F940+25j
					; DATA XREF: .text:off_1000FA14o
		mov	dword ptr [edx], 13h ; jumptable 1000F965 case 288
		mov	dword ptr [ecx], 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F990:				; CODE XREF: sub_1000F940+25j
					; DATA XREF: .text:off_1000FA14o
		mov	dword ptr [edx], 14h ; jumptable 1000F965 case 304
		mov	dword ptr [ecx], 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F99E:				; CODE XREF: sub_1000F940+25j
					; DATA XREF: .text:off_1000FA14o
		mov	dword ptr [edx], 15h ; jumptable 1000F965 case 305
		mov	dword ptr [ecx], 18h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F9AC:				; CODE XREF: sub_1000F940+Dj
		mov	dword ptr [edx], 1Eh
		mov	dword ptr [ecx], 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F9BA:				; CODE XREF: sub_1000F940+Bj
		cmp	esi, 650h
		ja	short loc_1000F9F2
		jz	short loc_1000F9E4
		cmp	esi, 350h
		jz	short loc_1000F9DC
		cmp	esi, 550h
		jnz	short loc_1000F9FA ; jumptable 1000F965	default	case
		mov	dword ptr [edx], 25h
		jmp	short loc_1000FA07
; ---------------------------------------------------------------------------

loc_1000F9DC:				; CODE XREF: sub_1000F940+8Aj
		mov	dword ptr [edx], 10h
		jmp	short loc_1000FA07
; ---------------------------------------------------------------------------

loc_1000F9E4:				; CODE XREF: sub_1000F940+82j
		mov	dword ptr [edx], 26h
		mov	dword ptr [ecx], 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F9F2:				; CODE XREF: sub_1000F940+80j
		cmp	esi, 1080h
		jz	short loc_1000FA01

loc_1000F9FA:				; CODE XREF: sub_1000F940+18j
					; sub_1000F940+25j ...
		mov	eax, 70h	; jumptable 1000F965 default case
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000FA01:				; CODE XREF: sub_1000F940+B8j
		mov	dword ptr [edx], 1Fh

loc_1000FA07:				; CODE XREF: sub_1000F940+32j
					; sub_1000F940+3Dj ...
		cmp	[ecx], eax
		jnz	short loc_1000FA10
		mov	eax, 0D0h

loc_1000FA10:				; CODE XREF: sub_1000F940+C9j
		pop	esi
		retn
sub_1000F940	endp

; ---------------------------------------------------------------------------
		align 4
off_1000FA14	dd offset loc_1000F96C	; DATA XREF: sub_1000F940+25r
		dd offset loc_1000F977	; jump table for switch	statement
		dd offset loc_1000F982
		dd offset loc_1000F990
		dd offset loc_1000F99E
		dd offset loc_1000F9FA
byte_1000FA2C	db	0,     5,     5,     5 ; DATA XREF: sub_1000F940+1Er
		db	5,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	1,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	2,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	3,     4
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FA60	proc near		; CODE XREF: sub_100145A0+259p

var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		sub	esp, 0Ch
		push	ebx
		push	edi
		xor	ebx, ebx
		push	800h
		mov	[eax], ebx
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_1000FA89
		pop	edi
		lea	eax, [ebx+2]
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000FA89:				; CODE XREF: sub_1000FA60+1Ej
		push	esi
		push	64h
		push	edi
		call	PORT_ArenaZAlloc_Util
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jz	short loc_1000FAF0
		mov	[esi+30h], ebx
		mov	[esi+60h], ebx
		mov	ebx, [esp+18h+arg_0]
		mov	[esi], edi
		mov	dword ptr [esi+3Ch], 2
		mov	dword ptr [esi+38h], 3
		mov	dword ptr [esi+5Ch], 4
		mov	dword ptr [esi+58h], 3
		mov	eax, [ebx+4]
		mov	ecx, [eax+14h]
		mov	[esi+28h], ecx
		mov	edx, [eax+0Ch]
		mov	[esp+18h+var_8], edx
		mov	eax, [eax+10h]
		lea	ecx, [esp+18h+var_C]
		push	ecx
		lea	edx, [esi+4]
		push	edx
		push	edi
		mov	[esp+24h+var_4], eax
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000FB07

loc_1000FAF0:				; CODE XREF: sub_1000FA60+39j
		push	1
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		pop	edi
		mov	eax, 2
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000FB07:				; CODE XREF: sub_1000FA60+8Ej
		mov	eax, [ebx]
		cmp	eax, 8000000Ah
		ja	short loc_1000FB46
		jz	short loc_1000FB3D
		cmp	eax, 3C0h
		jz	short loc_1000FB20
		cmp	eax, 80000009h
		jnz	short loc_1000FB4D

loc_1000FB20:				; CODE XREF: sub_1000FA60+B7j
		mov	eax, [esp+18h+arg_4]
		mov	dword ptr [esi+38h], 3
		mov	dword ptr [esi+2Ch], 14h
		mov	[eax], esi
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000FB3D:				; CODE XREF: sub_1000FA60+B0j
		mov	dword ptr [esi+38h], 2
		jmp	short loc_1000FB6B
; ---------------------------------------------------------------------------

loc_1000FB46:				; CODE XREF: sub_1000FA60+AEj
		cmp	eax, 8000000Bh
		jz	short loc_1000FB64

loc_1000FB4D:				; CODE XREF: sub_1000FA60+BEj
		push	1
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		pop	edi
		mov	eax, 70h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000FB64:				; CODE XREF: sub_1000FA60+EBj
		mov	dword ptr [esi+38h], 1

loc_1000FB6B:				; CODE XREF: sub_1000FA60+E4j
		mov	eax, [esp+18h+arg_4]
		mov	dword ptr [esi+2Ch], 10h
		mov	[eax], esi
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000FA60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FB90	proc near		; CODE XREF: sub_1000FDE0+21Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	ebp
		push	edi
		mov	edi, [esp+10h+arg_0]
		xor	ebp, ebp
		mov	[esp+10h+var_4], ebp
		cmp	edi, ebp
		jnz	short loc_1000FBB5
		mov	eax, [esp+10h+arg_4]
		pop	edi
		mov	dword ptr [eax], 60h
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000FBB5:				; CODE XREF: sub_1000FB90+11j
		push	ebx
		push	100h
		push	edi
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, ebp
		jnz	short loc_1000FBDD
		mov	ecx, [esp+14h+arg_4]
		pop	ebx
		pop	edi
		mov	dword ptr [ecx], 63h
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000FBDD:				; CODE XREF: sub_1000FB90+38j
		mov	edx, [esp+14h+arg_4]
		mov	eax, [ebx+18h]
		mov	ecx, [eax]
		push	esi
		push	edx
		push	ecx
		push	edi
		call	sub_10007C20
		push	ebx
		mov	esi, eax
		call	sub_10015D70
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1000FC08
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000FC08:				; CODE XREF: sub_1000FB90+6Cj
		push	800h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000FC2D
		mov	edx, [esp+18h+arg_4]
		mov	dword ptr [edx], 2
		or	ebx, 0FFFFFFFFh
		jmp	loc_1000FDAE
; ---------------------------------------------------------------------------

loc_1000FC2D:				; CODE XREF: sub_1000FB90+89j
		push	38h
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1000FC4D
		mov	eax, [esp+18h+arg_4]
		mov	dword ptr [eax], 2
		jmp	loc_1000FD93
; ---------------------------------------------------------------------------

loc_1000FC4D:				; CODE XREF: sub_1000FB90+ACj
		mov	[edi], ebx
		mov	eax, [esi+4]
		xor	ebp, ebp
		dec	eax
		jz	loc_1000FCF8
		dec	eax
		jz	short loc_1000FCBA
		sub	eax, 3
		jnz	loc_1000FD89
		push	esi
		call	sub_10005130
		mov	ebp, [esi+88h]
		shl	dword ptr [esi+94h], 3
		push	offset dword_10025DD8
		push	esi
		lea	ecx, [edi+28h]
		push	ecx
		push	ebx
		mov	dword ptr [esi+88h], 0
		call	SEC_ASN1EncodeItem_Util
		shr	dword ptr [esi+94h], 3
		lea	edx, [esi+70h]
		push	edx
		mov	[esp+30h+var_8], eax
		mov	[esi+88h], ebp
		call	SECITEM_DupItem_Util
		mov	ebp, eax
		add	esp, 18h
		mov	eax, 0C8h
		jmp	short loc_1000FD1A
; ---------------------------------------------------------------------------

loc_1000FCBA:				; CODE XREF: sub_1000FB90+CCj
		push	esi
		call	sub_10005110
		push	offset dword_10025D38
		push	esi
		lea	eax, [edi+28h]
		push	eax
		push	ebx
		call	SEC_ASN1EncodeItem_Util
		lea	ebp, [esi+8]
		push	ebp
		mov	[esp+30h+var_8], eax
		call	sub_100050F0
		push	offset dword_10025BF8
		push	ebp
		push	0
		push	0
		call	SEC_ASN1EncodeItem_Util
		mov	ebp, eax
		add	esp, 28h
		mov	eax, 7Ch
		jmp	short loc_1000FD1A
; ---------------------------------------------------------------------------

loc_1000FCF8:				; CODE XREF: sub_1000FB90+C5j
		push	esi
		call	sub_100050C0
		push	offset dword_10025C48
		push	esi
		lea	ecx, [edi+28h]
		push	ecx
		push	ebx
		call	SEC_ASN1EncodeItem_Util
		mov	[esp+2Ch+var_8], eax
		add	esp, 14h
		mov	eax, 10h

loc_1000FD1A:				; CODE XREF: sub_1000FB90+128j
					; sub_1000FB90+166j
		cmp	[esp+18h+var_8], 0
		jz	short loc_1000FD89
		cmp	dword ptr [esi+4], 2
		jnz	short loc_1000FD2B
		test	ebp, ebp
		jz	short loc_1000FD89

loc_1000FD2B:				; CODE XREF: sub_1000FB90+195j
		push	ebp
		push	eax
		lea	edx, [edi+10h]
		push	edx
		push	ebx
		call	SECOID_SetAlgorithmID_Util
		add	esp, 10h
		mov	[esp+18h+var_8], eax
		test	eax, eax
		jz	short loc_1000FD4E
		mov	eax, [esp+18h+arg_4]
		mov	dword ptr [eax], 30h
		jmp	short loc_1000FD93
; ---------------------------------------------------------------------------

loc_1000FD4E:				; CODE XREF: sub_1000FB90+1B0j
		push	0
		lea	ecx, [edi+4]
		push	ecx
		push	ebx
		call	SEC_ASN1EncodeInteger_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000FD89
		push	offset dword_10025B98
		push	edi
		push	0
		push	0
		call	SEC_ASN1EncodeItem_Util
		mov	ecx, [esp+28h+arg_4]
		mov	[esp+28h+var_4], eax
		add	esp, 10h
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFD0h
		add	eax, 30h
		mov	[ecx], eax
		jmp	short loc_1000FD9B
; ---------------------------------------------------------------------------

loc_1000FD89:				; CODE XREF: sub_1000FB90+D1j
					; sub_1000FB90+18Fj ...
		mov	edx, [esp+18h+arg_4]
		mov	dword ptr [edx], 30h

loc_1000FD93:				; CODE XREF: sub_1000FB90+B8j
					; sub_1000FB90+1BCj
		mov	[esp+18h+var_8], 0FFFFFFFFh

loc_1000FD9B:				; CODE XREF: sub_1000FB90+1F7j
		push	1
		push	ebx
		call	PORT_FreeArena_Util
		mov	ebx, [esp+20h+var_8]
		mov	edi, [esp+20h+arg_0]
		add	esp, 8

loc_1000FDAE:				; CODE XREF: sub_1000FB90+98j
		cmp	esi, [edi+1Ch]
		jz	short loc_1000FDBC
		push	esi
		call	sub_10005160
		add	esp, 4

loc_1000FDBC:				; CODE XREF: sub_1000FB90+221j
		test	ebp, ebp
		jz	short loc_1000FDCB
		push	1
		push	ebp
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_1000FDCB:				; CODE XREF: sub_1000FB90+22Ej
		mov	eax, ebx
		neg	eax
		pop	esi
		sbb	eax, eax
		pop	ebx
		not	eax
		and	eax, [esp+10h+var_4]
		pop	edi
		pop	ebp
		add	esp, 8
		retn
sub_1000FB90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FDE0	proc near		; CODE XREF: sub_10004720+40p
					; DATA XREF: .rdata:100260A2o

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 14h
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		push	edi
		push	esi
		call	sub_100164F0
		mov	edi, eax
		xor	ebp, ebp
		add	esp, 4
		mov	[esp+20h+var_8], edi
		cmp	edi, ebp
		jnz	short loc_1000FE0B
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000FE0B:				; CODE XREF: sub_1000FDE0+1Dj
		mov	eax, [esp+20h+arg_C]
		push	ebx
		push	edi
		push	eax
		call	sub_10017DA0
		mov	ebx, eax
		push	edi
		mov	[esp+30h+var_C], ebx
		call	sub_100177F0
		add	esp, 0Ch
		cmp	ebx, ebp
		jnz	short loc_1000FE37
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 60h
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000FE37:				; CODE XREF: sub_1000FDE0+48j
		mov	eax, [ebx+8]
		sub	eax, 3
		jz	loc_1000FFF8
		dec	eax
		jz	short loc_1000FE53
		mov	[esp+24h+var_14], 63h
		jmp	loc_100100DE
; ---------------------------------------------------------------------------

loc_1000FE53:				; CODE XREF: sub_1000FDE0+64j
		push	11h
		push	ebx
		mov	[esp+2Ch+var_10], ebp
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		mov	[esp+24h+var_4], edi
		cmp	edi, ebp
		jnz	short loc_1000FE79
		mov	[esp+24h+var_14], 63h
		jmp	loc_100100DE
; ---------------------------------------------------------------------------

loc_1000FE79:				; CODE XREF: sub_1000FDE0+8Aj
		mov	ecx, [esp+24h+arg_8]
		mov	edx, [esp+24h+arg_4]
		push	1
		push	ebp
		push	106h
		push	106h
		push	ecx
		mov	ecx, esi
		call	sub_1000C4C0
		add	esp, 14h
		mov	[esp+24h+var_14], eax
		cmp	eax, ebp
		jz	short loc_1000FEAF
		push	edi
		call	sub_10015D70
		add	esp, 4
		jmp	loc_100100DE
; ---------------------------------------------------------------------------

loc_1000FEAF:				; CODE XREF: sub_1000FDE0+BFj
		mov	ebp, [edi+18h]
		mov	ebx, [edi+1Ch]
		push	esi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000FEC9
		mov	eax, 0B3h
		jmp	short loc_1000FEF4
; ---------------------------------------------------------------------------

loc_1000FEC9:				; CODE XREF: sub_1000FDE0+E0j
		mov	ecx, [eax+38h]
		test	ecx, ecx
		jz	short loc_1000FEE6
		cmp	dword ptr [ecx], 0
		jnz	short loc_1000FEE6
		push	eax
		mov	[esp+28h+var_10], ecx
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax
		jmp	short loc_1000FEF4
; ---------------------------------------------------------------------------

loc_1000FEE6:				; CODE XREF: sub_1000FDE0+EEj
					; sub_1000FDE0+F3j
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	eax, 91h

loc_1000FEF4:				; CODE XREF: sub_1000FDE0+E7j
					; sub_1000FDE0+104j
		mov	[esp+24h+var_14], eax
		test	eax, eax
		jnz	loc_100100DA
		mov	eax, [esp+24h+var_10]
		test	eax, eax
		jz	loc_100100DA
		mov	ecx, [eax+10h]
		cmp	ecx, 1
		jbe	short loc_1000FF4C
		xor	edx, edx
		mov	eax, ebx
		div	ecx
		mov	eax, [esp+24h+var_10]
		cmp	dword ptr [eax+0Ch], 0
		jnz	short loc_1000FF4C
		test	edx, edx
		jz	short loc_1000FF4C
		sub	ecx, edx
		add	ebx, ecx
		push	ebx
		call	PORT_ZAlloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_1000FF81
		mov	ecx, [edi+1Ch]
		mov	edx, [edi+18h]
		push	ecx		; Size
		push	edx		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000FF4C:				; CODE XREF: sub_1000FDE0+132j
					; sub_1000FDE0+142j ...
		mov	eax, [esp+24h+arg_14]
		mov	edi, [esp+24h+arg_10]
		push	eax		; int
		push	edi		; int
		push	ebx		; Size
		push	ebp		; Src
		push	esi		; int
		call	sub_1000D060
		add	esp, 14h
		mov	[esp+24h+var_14], eax
		test	eax, eax
		jnz	short loc_1000FF6D
		test	edi, edi
		jnz	short loc_1000FFD7

loc_1000FF6D:				; CODE XREF: sub_1000FDE0+187j
		push	esi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000FF8E
		mov	eax, 0B3h
		jmp	short loc_1000FFB7
; ---------------------------------------------------------------------------

loc_1000FF81:				; CODE XREF: sub_1000FDE0+159j
		mov	[esp+24h+var_14], 2
		jmp	loc_100100DA
; ---------------------------------------------------------------------------

loc_1000FF8E:				; CODE XREF: sub_1000FDE0+198j
		mov	ecx, [eax+38h]
		test	ecx, ecx
		jz	short loc_1000FFA9
		cmp	dword ptr [ecx], 0
		jnz	short loc_1000FFA9
		push	eax
		mov	esi, ecx
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax
		jmp	short loc_1000FFBB
; ---------------------------------------------------------------------------

loc_1000FFA9:				; CODE XREF: sub_1000FDE0+1B3j
					; sub_1000FDE0+1B8j
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	eax, 91h

loc_1000FFB7:				; CODE XREF: sub_1000FDE0+19Fj
		mov	esi, [esp+24h+var_10]

loc_1000FFBB:				; CODE XREF: sub_1000FDE0+1C7j
		mov	ecx, [esp+24h+var_8]
		mov	dword ptr [ecx+38h], 0
		test	eax, eax
		jnz	short loc_1000FFD7
		test	esi, esi
		jz	short loc_1000FFD7
		push	esi
		call	sub_100176D0
		add	esp, 4

loc_1000FFD7:				; CODE XREF: sub_1000FDE0+18Bj
					; sub_1000FDE0+1E8j ...
		mov	esi, [esp+24h+var_4]
		cmp	ebp, [esi+18h]
		jz	short loc_1000FFEA
		push	ebx
		push	ebp
		call	PORT_ZFree_Util
		add	esp, 8

loc_1000FFEA:				; CODE XREF: sub_1000FDE0+1FEj
		push	esi
		call	sub_10015D70
		add	esp, 4
		jmp	loc_100100DA
; ---------------------------------------------------------------------------

loc_1000FFF8:				; CODE XREF: sub_1000FDE0+5Dj
		lea	edx, [esp+24h+var_14]
		push	edx
		push	ebx
		call	sub_1000FB90
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jz	loc_100100DE
		mov	eax, [esp+24h+arg_8]
		mov	edx, [esp+24h+arg_4]
		push	1
		push	ebp
		push	106h
		push	106h
		push	eax
		mov	ecx, esi
		call	sub_1000C4C0
		add	esp, 14h
		mov	[esp+24h+var_14], eax
		test	eax, eax
		jz	short loc_10010050
		push	1
		push	edi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8
		mov	[esp+24h+var_14], 63h
		jmp	loc_100100DE
; ---------------------------------------------------------------------------

loc_10010050:				; CODE XREF: sub_1000FDE0+256j
		mov	ecx, [esp+24h+arg_14]
		mov	ebx, [esp+24h+arg_10]
		mov	edx, [edi+8]
		mov	eax, [edi+4]
		push	ecx		; int
		push	ebx		; int
		push	edx		; Size
		push	eax		; Src
		push	esi		; int
		call	sub_1000D060
		add	esp, 14h
		mov	[esp+24h+var_14], eax
		test	eax, eax
		jnz	short loc_10010077
		test	ebx, ebx
		jnz	short loc_100100CF

loc_10010077:				; CODE XREF: sub_1000FDE0+291j
		push	esi
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001008B
		mov	eax, 0B3h
		jmp	short loc_100100B3
; ---------------------------------------------------------------------------

loc_1001008B:				; CODE XREF: sub_1000FDE0+2A2j
		mov	ecx, [eax+38h]
		test	ecx, ecx
		jz	short loc_100100A5
		cmp	[ecx], ebp
		jnz	short loc_100100A5
		push	eax
		mov	ebp, ecx
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax
		jmp	short loc_100100B3
; ---------------------------------------------------------------------------

loc_100100A5:				; CODE XREF: sub_1000FDE0+2B0j
					; sub_1000FDE0+2B4j
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	eax, 91h

loc_100100B3:				; CODE XREF: sub_1000FDE0+2A9j
					; sub_1000FDE0+2C3j
		mov	ecx, [esp+24h+var_8]
		mov	dword ptr [ecx+38h], 0
		test	eax, eax
		jnz	short loc_100100CF
		test	ebp, ebp
		jz	short loc_100100CF
		push	ebp
		call	sub_100176D0
		add	esp, 4

loc_100100CF:				; CODE XREF: sub_1000FDE0+295j
					; sub_1000FDE0+2E0j ...
		push	1
		push	edi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_100100DA:				; CODE XREF: sub_1000FDE0+11Aj
					; sub_1000FDE0+126j ...
		mov	ebx, [esp+24h+var_C]

loc_100100DE:				; CODE XREF: sub_1000FDE0+6Ej
					; sub_1000FDE0+94j ...
		push	ebx
		call	sub_10016D30
		mov	eax, [esp+28h+var_14]
		add	esp, 4
		cmp	eax, 40h
		jnz	short loc_100100F5
		mov	eax, 110h

loc_100100F5:				; CODE XREF: sub_1000FDE0+30Ej
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 14h
		retn
sub_1000FDE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010100	proc near		; CODE XREF: sub_10010670+1A8p

var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 18h
		push	ebx
		push	ebp
		mov	ebp, [esp+20h+arg_0]
		push	esi
		push	800h
		mov	[esp+28h+var_15], 1
		mov	[esp+28h+var_14], 0
		mov	esi, 63h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1001014C
		push	38h
		push	ebx
		call	PORT_ArenaZAlloc_Util
		add	esp, 8
		mov	[esp+24h+var_C], eax
		test	eax, eax
		jnz	short loc_10010156
		push	eax
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1001014C:				; CODE XREF: sub_10010100+2Dj
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10010156:				; CODE XREF: sub_10010100+40j
		mov	ecx, [esp+24h+arg_4]
		push	ecx
		push	offset dword_10025B98
		push	eax
		push	ebx
		call	SEC_ASN1DecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jz	short loc_10010183
		push	1
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10010183:				; CODE XREF: sub_10010100+6Cj
		push	edi
		push	0B0h
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_1001064F
		mov	edx, [esp+28h+var_C]
		add	edx, 10h
		push	edx
		mov	[edi], ebx
		call	SECOID_GetAlgorithmTag_Util
		add	esp, 4
		sub	eax, 10h
		jz	short loc_10010222
		sub	eax, 6Ch
		jz	short loc_100101EF
		sub	eax, 4Ch
		jnz	loc_10010642
		mov	[esp+28h+var_4], eax
		lea	eax, [edi+70h]
		push	edi
		mov	[esp+2Ch+var_8], offset	dword_10025DD8
		mov	[esp+2Ch+var_10], eax
		mov	dword ptr [edi+4], 5
		call	sub_10005130
		lea	ecx, [edi+8]
		push	ecx
		call	sub_10005120
		add	esp, 8
		jmp	short loc_10010244
; ---------------------------------------------------------------------------

loc_100101EF:				; CODE XREF: sub_10010100+B6j
		lea	edx, [edi+8]
		push	edi
		mov	[esp+2Ch+var_8], offset	dword_10025D38
		mov	[esp+2Ch+var_4], offset	dword_10025BF8
		mov	[esp+2Ch+var_10], edx
		mov	dword ptr [edi+4], 2
		call	sub_10005110
		mov	eax, [esp+2Ch+var_10]
		push	eax
		call	sub_100050F0
		add	esp, 8
		jmp	short loc_10010244
; ---------------------------------------------------------------------------

loc_10010222:				; CODE XREF: sub_10010100+B1j
		xor	eax, eax
		push	edi
		mov	[esp+2Ch+var_8], offset	dword_10025C48
		mov	[esp+2Ch+var_4], eax
		mov	[esp+2Ch+var_10], eax
		mov	dword ptr [edi+4], 1
		call	sub_100050C0
		add	esp, 4

loc_10010244:				; CODE XREF: sub_10010100+EDj
					; sub_10010100+120j
		mov	ecx, [esp+28h+var_C]
		mov	edx, [esp+28h+var_8]
		add	ecx, 28h
		push	ecx
		push	edx
		push	edi
		push	ebx
		call	SEC_QuickDERDecodeItem_Util
		add	esp, 10h
		cmp	dword ptr [edi+4], 5
		jnz	short loc_1001027D
		mov	eax, [esp+28h+var_C]
		shr	dword ptr [edi+94h], 3
		add	eax, 1Ch
		push	eax
		lea	ecx, [edi+70h]
		push	ecx
		push	ebx
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch

loc_1001027D:				; CODE XREF: sub_10010100+15Fj
		test	eax, eax
		jnz	loc_10010642
		mov	ecx, [esp+28h+var_10]
		test	ecx, ecx
		jz	short loc_100102B0
		mov	eax, [esp+28h+var_4]
		test	eax, eax
		jz	short loc_100102B0
		mov	edx, [esp+28h+var_C]
		add	edx, 1Ch
		push	edx
		push	eax
		push	ecx
		push	ebx
		call	SEC_QuickDERDecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	loc_10010642

loc_100102B0:				; CODE XREF: sub_10010100+18Bj
					; sub_10010100+193j
		mov	eax, [edi+4]
		dec	eax
		jz	loc_10010497
		dec	eax
		jz	loc_100103A3
		sub	eax, 3
		jnz	loc_10010642
		push	0D5A0DB00h
		push	ebp
		mov	[esp+30h+var_14], 3
		call	sub_10016780
		add	esp, 8
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, 0FFFFFF9Dh
		add	esi, 63h
		jnz	loc_10010642
		push	4
		lea	eax, [esp+2Ch+var_14]
		push	eax
		push	100h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	ecx, [esp+2Ch+var_15]
		push	ecx
		push	108h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	edx, [esp+2Ch+var_15]
		push	edx
		push	109h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	eax, [esp+2Ch+var_15]
		push	eax
		push	10Ch
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	ecx, [edi+78h]
		mov	edx, [edi+74h]
		push	ecx
		push	edx
		push	180h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	eax, [edi+0A0h]
		mov	ecx, [edi+9Ch]
		push	eax
		push	ecx
		push	11h
		jmp	loc_10010637
; ---------------------------------------------------------------------------

loc_100103A3:				; CODE XREF: sub_10010100+1BBj
		push	0D5A0DB00h
		push	ebp
		mov	[esp+30h+var_14], 1
		call	sub_10016780
		add	esp, 8
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, 0FFFFFF9Dh
		add	esi, 63h
		jnz	loc_10010642
		push	4
		lea	edx, [esp+2Ch+var_14]
		push	edx
		push	100h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	eax, [esp+2Ch+var_15]
		push	eax
		push	108h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	ecx, [esp+2Ch+var_15]
		push	ecx
		push	109h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	edx, [edi+14h]
		mov	eax, [edi+10h]
		push	edx
		push	eax
		push	130h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	ecx, [edi+20h]
		mov	edx, [edi+1Ch]
		push	ecx
		push	edx
		push	131h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	eax, [edi+2Ch]
		mov	ecx, [edi+28h]
		push	eax
		push	ecx
		push	132h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	edx, [edi+44h]
		mov	eax, [edi+40h]
		push	edx
		push	eax
		push	11h
		jmp	loc_10010637
; ---------------------------------------------------------------------------

loc_10010497:				; CODE XREF: sub_10010100+1B4j
		push	0D5A0DB00h
		push	ebp
		mov	[esp+30h+var_14], 0
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_100104BF
		push	0D5A0DB00h
		push	ebp
		call	sub_10016B50
		add	esp, 8

loc_100104BF:				; CODE XREF: sub_10010100+3AFj
		push	4
		lea	ecx, [esp+2Ch+var_14]
		push	ecx
		push	100h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	edx, [esp+2Ch+var_15]
		push	edx
		push	107h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	eax, [esp+2Ch+var_15]
		push	eax
		push	105h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	ecx, [esp+2Ch+var_15]
		push	ecx
		push	108h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		push	1
		lea	edx, [esp+2Ch+var_15]
		push	edx
		push	109h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	eax, [edi+20h]
		mov	ecx, [edi+1Ch]
		push	eax
		push	ecx
		push	120h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	edx, [edi+2Ch]
		mov	eax, [edi+28h]
		push	edx
		push	eax
		push	122h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	ecx, [edi+38h]
		mov	edx, [edi+34h]
		push	ecx
		push	edx
		push	123h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010642
		mov	eax, [edi+44h]
		mov	ecx, [edi+40h]
		push	eax
		push	ecx
		push	124h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010642
		mov	edx, [edi+50h]
		mov	eax, [edi+4Ch]
		push	edx
		push	eax
		push	125h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010642
		mov	ecx, [edi+5Ch]
		mov	edx, [edi+58h]
		push	ecx
		push	edx
		push	126h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010642
		mov	eax, [edi+68h]
		mov	ecx, [edi+64h]
		push	eax
		push	ecx
		push	127h
		push	ebp
		call	sub_10016BB0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010642
		mov	edx, [edi+74h]
		mov	eax, [edi+70h]
		push	edx
		push	eax
		push	128h

loc_10010637:				; CODE XREF: sub_10010100+29Ej
					; sub_10010100+392j
		push	ebp
		call	sub_10016BB0
		add	esp, 10h
		mov	esi, eax

loc_10010642:				; CODE XREF: sub_10010100+BBj
					; sub_10010100+17Fj ...
		push	edi
		call	sub_10005160
		add	esp, 4
		test	esi, esi
		jz	short loc_1001065A

loc_1001064F:				; CODE XREF: sub_10010100+96j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1001065A:				; CODE XREF: sub_10010100+54Dj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
sub_10010100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010670	proc near		; CODE XREF: sub_100047A0+63p
					; DATA XREF: .rdata:100260A6o

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 14h
		mov	eax, [esp+14h+arg_0]
		push	ebp
		push	edi
		xor	ebp, ebp
		push	eax
		mov	[esp+20h+var_14], ebp
		xor	edi, edi
		call	sub_10007E90
		add	esp, 4
		mov	[esp+1Ch+var_10], 4
		cmp	eax, ebp
		jnz	short loc_100106A1
		pop	edi
		mov	eax, 0B3h
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100106A1:				; CODE XREF: sub_10010670+24j
		push	ebx
		push	eax
		call	sub_100161F0
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, ebp
		jnz	short loc_100106BD
		pop	ebx
		pop	edi
		mov	eax, 2
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100106BD:				; CODE XREF: sub_10010670+3Fj
		push	esi
		cmp	[esp+24h+arg_18], ebp
		jle	short loc_10010728
		mov	esi, [esp+24h+arg_14]
		add	esi, 4
		jmp	short loc_100106D0
; ---------------------------------------------------------------------------
		align 10h

loc_100106D0:				; CODE XREF: sub_10010670+5Bj
					; sub_10010670+9Fj
		mov	eax, [esi-4]
		cmp	eax, 161h
		jnz	short loc_100106E4
		mov	ecx, [esi]
		mov	edx, [ecx]
		mov	[esp+24h+var_14], edx
		jmp	short loc_10010707
; ---------------------------------------------------------------------------

loc_100106E4:				; CODE XREF: sub_10010670+68j
		test	eax, eax
		jnz	short loc_100106F0
		mov	ecx, [esi]
		mov	edx, [ecx]
		mov	[esp+24h+var_10], edx

loc_100106F0:				; CODE XREF: sub_10010670+76j
		mov	ecx, [esi+4]
		mov	edx, [esi]
		push	ecx
		push	edx
		push	eax
		push	ebx
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10010715

loc_10010707:				; CODE XREF: sub_10010670+72j
		inc	ebp
		add	esi, 0Ch
		cmp	ebp, [esp+24h+arg_18]
		jl	short loc_100106D0
		test	edi, edi
		jz	short loc_10010728

loc_10010715:				; CODE XREF: sub_10010670+95j
		push	ebx
		call	sub_10016D30
		add	esp, 4
		pop	esi
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10010728:				; CODE XREF: sub_10010670+52j
					; sub_10010670+A3j
		mov	eax, [esp+24h+arg_8]
		mov	edx, [esp+24h+arg_4]
		mov	ecx, [esp+24h+arg_0]
		push	0
		push	1
		push	107h
		push	107h
		push	eax
		call	sub_1000C4C0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1001075C
		push	ebx
		call	sub_10016D30
		add	esp, 4
		jmp	short loc_1001079A
; ---------------------------------------------------------------------------

loc_1001075C:				; CODE XREF: sub_10010670+DFj
		mov	esi, [esp+24h+arg_10]
		push	esi
		call	PORT_Alloc_Util
		mov	edx, [esp+28h+arg_C]
		lea	ecx, [esp+28h+arg_10]
		push	ecx
		mov	edi, eax
		mov	eax, [esp+2Ch+arg_0]
		push	edi
		push	esi
		push	edx
		push	eax
		mov	[esp+3Ch+arg_10], esi
		call	sub_1000D520
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jz	short loc_100107B2
		push	ebx
		call	sub_10016D30
		push	edi
		call	PORT_Free_Util
		add	esp, 8

loc_1001079A:				; CODE XREF: sub_10010670+EAj
		mov	eax, esi
		cmp	esi, 40h
		jnz	loc_10010896
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 110h
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100107B2:				; CODE XREF: sub_10010670+119j
		mov	eax, [esp+24h+var_10]
		sub	eax, 3
		mov	ebp, [esp+24h+arg_10]
		jz	short loc_10010808
		dec	eax
		jz	short loc_100107C9
		mov	esi, 0D1h
		jmp	short loc_10010829
; ---------------------------------------------------------------------------

loc_100107C9:				; CODE XREF: sub_10010670+150j
		push	100h
		push	ebx
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jz	short loc_10010824
		mov	eax, [esp+24h+var_14]
		test	eax, eax
		jz	short loc_100107E7
		cmp	eax, ebp
		jbe	short loc_100107E9

loc_100107E7:				; CODE XREF: sub_10010670+171j
		mov	eax, ebp

loc_100107E9:				; CODE XREF: sub_10010670+175j
		cmp	eax, 100h
		jbe	short loc_100107F7
		mov	esi, 0D1h
		jmp	short loc_10010829
; ---------------------------------------------------------------------------

loc_100107F7:				; CODE XREF: sub_10010670+17Ej
		push	eax
		push	edi
		push	11h
		push	ebx
		call	sub_10016BB0
		add	esp, 10h
		mov	esi, eax
		jmp	short loc_10010829
; ---------------------------------------------------------------------------

loc_10010808:				; CODE XREF: sub_10010670+14Dj
		lea	ecx, [esp+24h+var_C]
		push	ecx
		push	ebx
		mov	[esp+2Ch+var_8], edi
		mov	[esp+2Ch+var_4], ebp
		xor	esi, esi
		call	sub_10010100
		add	esp, 8
		test	eax, eax
		jz	short loc_10010829

loc_10010824:				; CODE XREF: sub_10010670+169j
		mov	esi, 0D0h

loc_10010829:				; CODE XREF: sub_10010670+157j
					; sub_10010670+185j ...
		push	ebp
		push	edi
		call	PORT_ZFree_Util
		add	esp, 8
		test	esi, esi
		jz	short loc_1001084A
		push	ebx
		call	sub_10016D30
		add	esp, 4
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1001084A:				; CODE XREF: sub_10010670+1C5j
		mov	edx, [esp+24h+arg_0]
		push	edx
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10010873
		push	ebx
		call	sub_10016D30
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 0B3h
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10010873:				; CODE XREF: sub_10010670+1EBj
		push	esi
		push	ebx
		call	sub_1000A8F0
		mov	ecx, [esp+2Ch+arg_1C]
		mov	edi, eax
		mov	eax, [ebx+0Ch]
		push	esi
		mov	[ecx], eax
		call	sub_100177F0
		push	ebx
		call	sub_10016D30
		add	esp, 10h
		mov	eax, edi

loc_10010896:				; CODE XREF: sub_10010670+12Fj
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		add	esp, 14h
		retn
sub_10010670	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100108A0(int,	int, void *, size_t Size, int)
sub_100108A0	proc near		; CODE XREF: sub_10010E70+174Cp
					; sub_10010E70+1778p ...

var_5		= byte ptr -5
Src		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 8
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_10]
		push	esi
		mov	esi, eax
		mov	dword ptr [ebp+0], 0
		mov	eax, [esi+18h]
		push	edi
		mov	ebx, 1
		push	eax
		mov	[esp+1Ch+Src], 10h
		mov	[esp+1Ch+var_5], bl
		mov	byte ptr [esp+1Ch+arg_10], 0
		call	sub_100161F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100108E7
		pop	edi
		pop	esi
		pop	ebp
		lea	eax, [ebx+1]
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100108E7:				; CODE XREF: sub_100108A0+3Aj
		push	edi
		call	sub_10016570
		push	esi
		push	edi
		mov	[eax+38h], ebx
		call	sub_10017310
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_10010A3C
		cmp	[esp+18h+arg_4], eax
		jz	loc_100109F3
		push	4		; Size
		lea	ecx, [esp+1Ch+Src]
		push	ecx		; Src
		push	100h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010A3C
		push	ebx		; Size
		lea	edx, [esp+1Ch+var_5]
		push	edx		; Src
		push	10Ch		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010A3C
		push	ebx		; Size
		lea	eax, [esp+1Ch+arg_10]
		push	eax		; Src
		push	104h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010A3C
		push	ebx		; Size
		lea	ecx, [esp+1Ch+arg_10]
		push	ecx		; Src
		push	105h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010A3C
		push	ebx		; Size
		lea	edx, [esp+1Ch+var_5]
		push	edx		; Src
		push	108h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10010A3C
		push	ebx		; Size
		lea	eax, [esp+1Ch+var_5]
		push	eax		; Src
		push	10Ah		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010A3C
		push	ebx		; Size
		lea	ecx, [esp+1Ch+arg_10]
		push	ecx		; Src
		push	106h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010A3C
		push	ebx		; Size
		lea	edx, [esp+1Ch+arg_10]
		push	edx		; Src
		push	107h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010A3C

loc_100109F3:				; CODE XREF: sub_100108A0+68j
		mov	eax, [esp+18h+Size]
		mov	ecx, [esp+18h+arg_8]
		push	eax		; Size
		push	ecx		; Src
		push	11h		; int
		push	edi		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10010A3C
		mov	edx, [esp+18h+arg_0]
		push	edx
		lea	esi, [eax+2]
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_10010A3C
		push	ebx
		push	edi
		call	sub_1000A8F0
		push	ebx
		mov	esi, eax
		call	sub_100177F0
		mov	eax, [edi+0Ch]
		add	esp, 0Ch
		mov	[ebp+0], eax

loc_10010A3C:				; CODE XREF: sub_100108A0+5Ej
					; sub_100108A0+87j ...
		push	edi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_100108A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010A50	proc near		; CODE XREF: sub_10010E70+162Bp
		push	esi
		mov	esi, eax
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10010A63
		push	eax
		push	edi
		call	sub_1000BE20
		add	esp, 8

loc_10010A63:				; CODE XREF: sub_10010A50+7j
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10010A74
		push	eax
		push	edi
		call	sub_1000BE20
		add	esp, 8

loc_10010A74:				; CODE XREF: sub_10010A50+18j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10010A85
		push	eax
		push	edi
		call	sub_1000BE20
		add	esp, 8

loc_10010A85:				; CODE XREF: sub_10010A50+29j
		mov	esi, [esi+0Ch]
		test	esi, esi
		jz	short loc_10010A96
		push	esi
		push	edi
		call	sub_1000BE20
		add	esp, 8

loc_10010A96:				; CODE XREF: sub_10010A50+3Aj
		pop	esi
		retn
sub_10010A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010AA0	proc near		; CODE XREF: sub_10010E70+34Fp
					; sub_10010E70+502p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		push	esi
		push	edi
		push	103h
		xor	esi, esi
		push	ebx
		lea	ebp, [esi+1]
		xor	edi, edi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10010ACE
		mov	ecx, [eax+18h]
		movzx	esi, byte ptr [ecx]
		push	eax
		mov	edi, ebp
		call	sub_10015D70
		add	esp, 4

loc_10010ACE:				; CODE XREF: sub_10010AA0+1Bj
		push	162h
		push	ebx
		mov	[esp+18h+var_4], 0
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10010AFB
		mov	edx, [eax+18h]
		mov	[esp+10h+var_4], ebp
		movzx	ebp, byte ptr [edx]
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10010AFB:				; CODE XREF: sub_10010AA0+46j
		mov	eax, [esp+10h+arg_0]
		push	103h
		push	eax
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10010B23
		test	edi, edi
		jz	short loc_10010B23
		test	esi, esi
		jnz	short loc_10010B23

loc_10010B19:				; CODE XREF: sub_10010AA0+A2j
		pop	edi
		pop	esi
		mov	eax, 68h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10010B23:				; CODE XREF: sub_10010AA0+6Fj
					; sub_10010AA0+73j ...
		mov	esi, [esp+10h+arg_0]
		push	162h
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10010B44
		cmp	[esp+10h+var_4], eax
		jz	short loc_10010B44
		cmp	ebp, 1
		jz	short loc_10010B19

loc_10010B44:				; CODE XREF: sub_10010AA0+97j
					; sub_10010AA0+9Dj
		test	edi, edi
		jnz	short loc_10010B92
		push	103h
		push	esi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10010B66

loc_10010B5C:				; CODE XREF: sub_10010AA0+10Bj
		pop	edi
		pop	esi
		mov	eax, 63h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10010B66:				; CODE XREF: sub_10010AA0+BAj
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		mov	eax, [esi+14h]
		push	ecx
		push	edx
		push	eax
		push	ebx
		call	sub_10006CB0
		push	esi
		mov	edi, eax
		call	sub_10015D70
		add	esp, 14h
		test	edi, edi
		jz	short loc_10010B8E

loc_10010B87:				; CODE XREF: sub_10010AA0+12Cj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10010B8E:				; CODE XREF: sub_10010AA0+E5j
		mov	esi, [esp+10h+arg_0]

loc_10010B92:				; CODE XREF: sub_10010AA0+A6j
		cmp	[esp+10h+var_4], 0
		jnz	short loc_10010BCE
		push	162h
		push	esi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10010B5C
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		mov	eax, [esi+14h]
		push	ecx
		push	edx
		push	eax
		push	ebx
		call	sub_10006CB0
		push	esi
		mov	edi, eax
		call	sub_10015D70
		add	esp, 14h
		test	edi, edi
		jnz	short loc_10010B87

loc_10010BCE:				; CODE XREF: sub_10010AA0+F7j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
sub_10010AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010BE0	proc near		; CODE XREF: sub_1000A4A0+1F0p
					; sub_100143D0+15Ap

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		add	eax, 0FFFFFFEDh	; switch 12 cases
		cmp	eax, 0Bh
		ja	short loc_10010C0C ; jumptable 10010BF3	default	case
		movzx	eax, ds:byte_10010C20[eax]
		jmp	ds:off_10010C10[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10010BFA:				; CODE XREF: sub_10010BE0+13j
					; DATA XREF: .text:off_10010C10o
		mov	eax, 8		; jumptable 10010BF3 cases 19,30
		retn
; ---------------------------------------------------------------------------

loc_10010C00:				; CODE XREF: sub_10010BE0+13j
					; DATA XREF: .text:off_10010C10o
		mov	eax, 10h	; jumptable 10010BF3 case 20
		retn
; ---------------------------------------------------------------------------

loc_10010C06:				; CODE XREF: sub_10010BE0+13j
					; DATA XREF: .text:off_10010C10o
		mov	eax, 18h	; jumptable 10010BF3 case 21
		retn
; ---------------------------------------------------------------------------

loc_10010C0C:				; CODE XREF: sub_10010BE0+Aj
					; sub_10010BE0+13j
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10010BF3 default case
		retn
sub_10010BE0	endp

; ---------------------------------------------------------------------------
		align 10h
off_10010C10	dd offset loc_10010BFA	; DATA XREF: sub_10010BE0+13r
		dd offset loc_10010C00	; jump table for switch	statement
		dd offset loc_10010C06
		dd offset loc_10010C0C
byte_10010C20	db	0,     1,     2,     3 ; DATA XREF: sub_10010BE0+Cr
		db	3,     3,     3,     3 ; indirect table	for switch statement
		db	3,     3,     3,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10010C30(int,	int, void *Src,	size_t Size, int, int)
sub_10010C30	proc near		; CODE XREF: sub_10010DD0+19p
					; sub_10010DD0+33p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_4]
		push	ebp
		mov	ebp, [esp+18h+arg_14]
		push	edi
		mov	edi, eax
		mov	eax, ebp
		imul	eax, 0FEh
		cmp	ebx, eax
		jbe	short loc_10010C58
		pop	edi
		pop	ebp
		mov	eax, 7
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10010C58:				; CODE XREF: sub_10010C30+1Aj
		cmp	[esp+1Ch+Src], 0
		jnz	short loc_10010C67
		mov	[esp+1Ch+Size],	0

loc_10010C67:				; CODE XREF: sub_10010C30+2Dj
		mov	ecx, [edi+8]
		mov	edx, [esp+1Ch+Size]
		lea	eax, [ecx+edx+4]
		push	esi
		push	eax
		mov	[esp+24h+var_8], eax
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10010C95
		mov	edi, 2
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10010C95:				; CODE XREF: sub_10010C30+54j
		xor	edx, edx
		mov	eax, ebx
		div	ebp
		mov	ecx, eax
		imul	ecx, ebp
		mov	[esp+20h+var_C], eax
		cmp	ebx, ecx
		jbe	short loc_10010CAD
		inc	eax
		mov	[esp+20h+var_C], eax

loc_10010CAD:				; CODE XREF: sub_10010C30+76j
		mov	ebx, eax
		imul	ebx, ebp
		push	ebx
		mov	[esp+24h+var_4], ebx
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		mov	[esp+20h+var_10], ebp
		test	ebp, ebp
		jnz	short loc_10010CD1
		lea	edi, [eax+2]
		jmp	loc_10010DA7
; ---------------------------------------------------------------------------

loc_10010CD1:				; CODE XREF: sub_10010C30+97j
		mov	edx, [edi+8]
		mov	eax, [edi+4]
		push	edx		; Size
		push	eax		; Src
		push	esi		; Dst
		call	memcpy
		mov	ecx, [edi+8]
		mov	byte ptr [esi+ecx], 0
		mov	edx, [edi+8]
		mov	byte ptr [edx+esi+1], 0
		mov	eax, [edi+8]
		mov	byte ptr [eax+esi+2], 0
		mov	eax, [esp+2Ch+Src]
		mov	ecx, [edi+8]
		add	esp, 0Ch
		mov	byte ptr [ecx+esi+3], 1
		test	eax, eax
		jz	short loc_10010D1F
		mov	edx, [esp+20h+Size]
		push	edx		; Size
		push	eax		; Src
		mov	eax, [edi+8]
		lea	ecx, [eax+esi+4]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10010D1F:				; CODE XREF: sub_10010C30+D7j
		xor	ebp, ebp
		cmp	[esp+20h+var_C], ebp
		jbe	short loc_10010D5C
		mov	ebx, [esp+20h+var_10]
		jmp	short loc_10010D30
; ---------------------------------------------------------------------------
		align 10h

loc_10010D30:				; CODE XREF: sub_10010C30+FBj
					; sub_10010C30+126j
		mov	edx, [esp+20h+var_8]
		push	edx
		push	esi
		push	ebx
		call	[esp+2Ch+arg_10]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10010D9A
		mov	eax, [edi+8]
		inc	byte ptr [eax+esi+3]
		add	ebx, [esp+20h+arg_14]
		lea	eax, [eax+esi+3]
		inc	ebp
		cmp	ebp, [esp+20h+var_C]
		jb	short loc_10010D30
		mov	ebx, [esp+20h+var_4]

loc_10010D5C:				; CODE XREF: sub_10010C30+F5j
		mov	edx, [esp+20h+var_8]
		push	edx
		push	esi
		call	PORT_ZFree_Util
		mov	eax, [esp+28h+arg_4]
		add	esp, 8
		cmp	eax, ebx
		jnb	short loc_10010D86
		mov	ecx, [esp+20h+var_10]
		sub	ebx, eax
		push	ebx		; Size
		add	ecx, eax
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch

loc_10010D86:				; CODE XREF: sub_10010C30+140j
		mov	eax, [esp+20h+var_10]
		mov	edx, [esp+20h+arg_0]
		pop	esi
		pop	edi
		pop	ebp
		mov	[edx], eax
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10010D9A:				; CODE XREF: sub_10010C30+110j
		mov	ebx, [esp+20h+var_4]
		mov	ebp, [esp+20h+var_10]
		mov	edi, 6

loc_10010DA7:				; CODE XREF: sub_10010C30+9Cj
		mov	ecx, [esp+20h+var_8]
		push	ecx
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8
		test	ebp, ebp
		jz	short loc_10010DC3
		push	ebx
		push	ebp
		call	PORT_ZFree_Util
		add	esp, 8

loc_10010DC3:				; CODE XREF: sub_10010C30+187j
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_10010C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10010DD0@<eax>(size_t Size@<ecx>, void *Src@<edx>,	int, int)
sub_10010DD0	proc near		; CODE XREF: sub_10010E70+C3Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	ebx, 2
		jnz	short loc_10010DF3
		push	14h		; int
		push	offset sub_10021450 ; int
		push	ecx		; Size
		push	edx		; Src
		push	esi		; int
		push	edi		; int
		call	sub_10010C30
		add	esp, 18h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010DF3:				; CODE XREF: sub_10010DD0+Cj
		cmp	ebx, 5
		jnz	short loc_10010E0D
		push	1Ch		; int
		push	offset sub_10022470 ; int
		push	ecx		; Size
		push	edx		; Src
		push	esi		; int
		push	edi		; int
		call	sub_10010C30
		add	esp, 18h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010E0D:				; CODE XREF: sub_10010DD0+26j
		cmp	ebx, 6
		jnz	short loc_10010E27
		push	20h		; int
		push	offset sub_10021870 ; int
		push	ecx		; Size
		push	edx		; Src
		push	esi		; int
		push	edi		; int
		call	sub_10010C30
		add	esp, 18h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010E27:				; CODE XREF: sub_10010DD0+40j
		cmp	ebx, 7
		jnz	short loc_10010E41
		push	30h		; int
		push	offset sub_10021B50 ; int
		push	ecx		; Size
		push	edx		; Src
		push	esi		; int
		push	edi		; int
		call	sub_10010C30
		add	esp, 18h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010E41:				; CODE XREF: sub_10010DD0+5Aj
		cmp	ebx, 8
		jnz	short loc_10010E5B
		push	40h		; int
		push	offset sub_100219E0 ; int
		push	ecx		; Size
		push	edx		; Src
		push	esi		; int
		push	edi		; int
		call	sub_10010C30
		add	esp, 18h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010E5B:				; CODE XREF: sub_10010DD0+74j
		mov	eax, 70h
		pop	edi
		retn
sub_10010DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010E70	proc near		; CODE XREF: sub_10004860+59p
					; DATA XREF: .rdata:100260AAo

var_1C4		= dword	ptr -1C4h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1B5		= byte ptr -1B5h
var_1B4		= dword	ptr -1B4h
var_1B0		= dword	ptr -1B0h
var_1A9		= byte ptr -1A9h
var_1A8		= dword	ptr -1A8h
var_1A4		= dword	ptr -1A4h
var_1A0		= dword	ptr -1A0h
var_19C		= dword	ptr -19Ch
Src		= dword	ptr -198h
Size		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= dword	ptr -18Ch
var_188		= dword	ptr -188h
var_184		= dword	ptr -184h
var_180		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
var_178		= dword	ptr -178h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= byte ptr -138h
var_128		= byte ptr -128h
Dst		= byte ptr -98h
var_78		= byte ptr -78h
var_58		= byte ptr -58h
var_44		= byte ptr -44h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 1C4h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1C4h+var_4], eax
		mov	ecx, [esp+1C4h+arg_4]
		mov	eax, [esp+1C4h+arg_0]
		mov	edx, [esp+1C4h+arg_8]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+1D4h+arg_14]
		mov	[esp+1D4h+var_1B0], ecx
		mov	ecx, [esp+1D4h+arg_C]
		push	eax
		mov	[esp+1D8h+var_1A0], eax
		mov	[esp+1D8h+var_1A4], edx
		mov	[esp+1D8h+var_160], ecx
		mov	[esp+1D8h+var_13C], edi
		call	sub_10007E90
		xor	esi, esi
		mov	ebx, eax
		add	esp, 4
		xor	ebp, ebp
		mov	[esp+1D4h+var_16C], esi
		mov	[esp+1D4h+var_1C4], esi
		mov	[esp+1D4h+var_1A9], 1
		mov	[esp+1D4h+var_168], 10h
		mov	[esp+1D4h+var_15C], 4
		mov	[esp+1D4h+var_1B4], esi
		mov	[esp+1D4h+var_17C], esi
		mov	[esp+1D4h+var_1BC], 1
		cmp	ebx, esi
		jz	loc_10011057
		cmp	edi, esi
		jz	short loc_10010F0C
		mov	[edi], esi

loc_10010F0C:				; CODE XREF: sub_10010E70+98j
		push	ebx
		call	sub_100161F0
		add	esp, 4
		mov	[esp+1D4h+var_1C0], eax
		test	eax, eax
		jz	loc_10012A92
		xor	edx, edx
		cmp	dword ptr [ebx], 3
		setz	dl
		xor	edi, edi
		mov	[esp+1D4h+var_180], edx
		cmp	[esp+1D4h+arg_10], esi
		jle	short loc_10010FA8
		mov	ebx, [esp+1D4h+var_160]
		add	ebx, 4
		nop

loc_10010F40:				; CODE XREF: sub_10010E70+118j
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		mov	edx, [ebx-4]
		push	eax
		mov	eax, [esp+1D8h+var_1C0]
		push	ecx
		push	edx
		push	eax
		call	sub_10016BB0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	short loc_10010FAE
		mov	eax, [ebx-4]
		cmp	eax, 100h
		jnz	short loc_10010F72
		mov	ecx, [ebx]
		mov	edx, [ecx]
		mov	[esp+1D4h+var_168], edx

loc_10010F72:				; CODE XREF: sub_10010E70+F8j
		cmp	eax, 161h
		jnz	short loc_10010F7D
		mov	eax, [ebx]
		mov	ebp, [eax]

loc_10010F7D:				; CODE XREF: sub_10010E70+107j
		inc	edi
		add	ebx, 0Ch
		cmp	edi, [esp+1D4h+arg_10]
		jl	short loc_10010F40
		test	ebp, ebp
		jnz	short loc_10010FD7

loc_10010F8E:				; CODE XREF: sub_10010E70+13Cj
		mov	eax, [esp+1D4h+var_168]
		add	eax, 0FFFFFFEDh	; switch 12 cases
		cmp	eax, 0Bh
		ja	short loc_10010FD5 ; jumptable 10010FA1	default	case
		movzx	edx, ds:byte_10012AEC[eax]
		jmp	ds:off_10012ADC[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10010FA8:				; CODE XREF: sub_10010E70+C6j
		cmp	[esp+1D4h+var_1C4], esi
		jz	short loc_10010F8E

loc_10010FAE:				; CODE XREF: sub_10010E70+EEj
		mov	ecx, [esp+1D4h+var_1C0]
		push	ecx
		call	sub_10016D30
		add	esp, 4
		jmp	loc_10012ABF
; ---------------------------------------------------------------------------

loc_10010FC0:				; CODE XREF: sub_10010E70+131j
					; DATA XREF: .text:off_10012ADCo
		mov	ebp, 8		; jumptable 10010FA1 cases 19,30
		jmp	short loc_10010FD7
; ---------------------------------------------------------------------------

loc_10010FC7:				; CODE XREF: sub_10010E70+131j
					; DATA XREF: .text:off_10012ADCo
		mov	ebp, 10h	; jumptable 10010FA1 case 20
		jmp	short loc_10010FD7
; ---------------------------------------------------------------------------

loc_10010FCE:				; CODE XREF: sub_10010E70+131j
					; DATA XREF: .text:off_10012ADCo
		mov	ebp, 18h	; jumptable 10010FA1 case 21
		jmp	short loc_10010FD7
; ---------------------------------------------------------------------------

loc_10010FD5:				; CODE XREF: sub_10010E70+128j
					; sub_10010E70+131j
					; DATA XREF: ...
		xor	ebp, ebp	; jumptable 10010FA1 default case

loc_10010FD7:				; CODE XREF: sub_10010E70+11Cj
					; sub_10010E70+155j ...
		mov	eax, [esp+1D4h+var_1B0]
		mov	eax, [eax]
		add	eax, 31ACBCA5h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_10011007 ; jumptable 10010FEE	default	case
		movzx	ecx, ds:byte_10012B00[eax]
		jmp	ds:off_10012AF8[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10010FF5:				; CODE XREF: sub_10010E70+17Ej
					; DATA XREF: .text:off_10012AF8o
		mov	[esp+1D4h+var_1BC], esi	; jumptable 10010FEE cases -833404069--833404066
		mov	[esp+1D4h+var_15C], 3
		jmp	short loc_1001100F
; ---------------------------------------------------------------------------

loc_10011003:				; CODE XREF: sub_10010E70+17Ej
					; DATA XREF: .text:off_10012AF8o
		mov	[esp+1D4h+var_1BC], esi	; jumptable 10010FEE cases -833404065--833404062

loc_10011007:				; CODE XREF: sub_10010E70+175j
		mov	[esp+1D4h+var_15C], 4 ;	jumptable 10010FEE default case

loc_1001100F:				; CODE XREF: sub_10010E70+191j
		mov	edi, [esp+1D4h+var_1C0]
		push	4		; Size
		lea	edx, [esp+1D8h+var_15C]
		push	edx		; Src
		push	0		; int
		push	edi		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jz	short loc_1001103B
		push	edi
		call	sub_10016D30
		add	esp, 4
		jmp	loc_10012ABF
; ---------------------------------------------------------------------------

loc_1001103B:				; CODE XREF: sub_10010E70+1BBj
		mov	eax, [esp+1D4h+var_1A0]
		push	eax
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10011061
		push	edi
		call	sub_10016D30
		add	esp, 4

loc_10011057:				; CODE XREF: sub_10010E70+90j
		mov	eax, 0B3h
		jmp	loc_10012AC3
; ---------------------------------------------------------------------------

loc_10011061:				; CODE XREF: sub_10010E70+1DCj
		mov	ecx, [esp+1D4h+var_1A4]
		push	ebx
		push	ecx
		call	sub_10017DA0
		mov	edi, eax
		push	ebx
		mov	[esp+1E0h+var_160], edi
		call	sub_100177F0
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10011097
		mov	edx, [esp+1D4h+var_1C0]
		push	edx
		call	sub_10016D30
		add	esp, 4
		lea	eax, [edi+60h]
		jmp	loc_10012AC3
; ---------------------------------------------------------------------------

loc_10011097:				; CODE XREF: sub_10010E70+210j
		cmp	[esp+1D4h+var_1BC], esi
		jz	short loc_100110CD
		push	11h
		push	edi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		mov	[esp+1D4h+var_16C], esi
		test	esi, esi
		jnz	short loc_100110CD
		mov	eax, [esp+1D4h+var_1C0]
		push	eax
		call	sub_10016D30
		push	edi
		call	sub_10016D30
		add	esp, 8
		lea	eax, [esi+60h]
		jmp	loc_10012AC3
; ---------------------------------------------------------------------------

loc_100110CD:				; CODE XREF: sub_10010E70+22Bj
					; sub_10010E70+240j
		mov	ebx, [esp+1D4h+var_1B0]
		mov	ecx, [ebx]
		mov	eax, ecx
		cmp	eax, 360h
		ja	loc_10011340
		jz	loc_100111BA
		cmp	eax, 21h
		jnz	loc_10012A21	; jumptable 10011366 default case
		push	130h
		push	edi
		lea	ecx, [esp+1DCh+var_18C]
		push	ecx
		push	0
		call	sub_10016AD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		push	11h
		push	edi
		lea	edx, [esp+1DCh+var_19C]
		push	edx
		push	eax
		call	sub_10016AD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jz	short loc_1001113B
		mov	eax, [esp+1D4h+var_188]
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001113B:				; CODE XREF: sub_10010E70+2B7j
		mov	ecx, [ebx+4]
		mov	edx, [ebx+8]
		push	ebp
		lea	eax, [esp+1D8h+var_178]
		push	eax
		mov	[esp+1DCh+var_148], ecx
		lea	ecx, [esp+1DCh+var_19C]
		mov	[esp+1DCh+var_144], edx
		push	ecx
		lea	edx, [esp+1E0h+var_18C]
		push	edx
		lea	eax, [esp+1E4h+var_14C]
		push	eax
		call	sub_10020D70
		mov	ecx, [esp+1E8h+var_188]
		push	ecx
		mov	esi, eax
		call	PORT_Free_Util
		mov	edx, [esp+1ECh+Src]
		push	edx
		call	PORT_Free_Util
		add	esp, 1Ch
		test	esi, esi
		jnz	loc_100120BA
		mov	eax, [esp+1D4h+var_170]
		mov	ecx, [esp+1D4h+var_174]
		mov	edx, [esp+1D4h+var_1C0]
		push	eax		; Size
		push	ecx		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		mov	eax, [esp+1E4h+var_170]
		mov	ecx, [esp+1E4h+var_174]
		push	eax
		push	ecx
		call	PORT_ZFree_Util
		add	esp, 18h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100111BA:				; CODE XREF: sub_10010E70+270j
		mov	ebx, [esp+1D4h+var_1C0]
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	edx, [esp+1D4h+var_1A0]
		push	edx
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_100111F3
		mov	[esp+1D4h+var_1C4], 0B3h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100111F3:				; CODE XREF: sub_10010E70+374j
		mov	eax, [esp+1D4h+var_1B0]
		mov	ecx, [eax+4]
		mov	edx, [ecx]
		push	ebx
		push	edx
		call	sub_10017DA0
		mov	edi, eax
		push	ebx
		mov	[esp+1E0h+var_1BC], edi
		call	sub_100177F0
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10011223
		mov	[esp+1D4h+var_1C4], 60h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011223:				; CODE XREF: sub_10010E70+3A4j
		push	103h
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10011260
		push	1		; Size
		lea	eax, [esp+1D8h+var_1A9]
		push	eax		; Src
		push	103h		; int
		push	edi		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jz	short loc_10011260
		push	edi
		call	sub_10016D30
		add	esp, 4
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011260:				; CODE XREF: sub_10010E70+3C3j
					; sub_10010E70+3E0j
		push	11h
		push	edi
		call	sub_10016660
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_10011287
		push	edi
		call	sub_10016D30
		add	esp, 4
		mov	[esp+1D4h+var_1C4], 60h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011287:				; CODE XREF: sub_10010E70+3FFj
		mov	eax, [esi+1Ch]
		add	eax, [ebx+1Ch]
		mov	[esp+1D4h+var_1A8], eax
		test	ebp, ebp
		jnz	short loc_100112CA
		mov	ebp, eax

loc_10011297:				; CODE XREF: sub_10010E70+45Cj
		mov	ecx, [esp+1D4h+var_1A8]
		push	ecx
		call	PORT_Alloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100112EA
		push	ebx
		call	sub_10015D70
		mov	edx, [esp+1D8h+var_1BC]
		push	edx
		call	sub_10016D30
		add	esp, 8
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100112CA:				; CODE XREF: sub_10010E70+423j
		cmp	ebp, eax
		jbe	short loc_10011297
		push	edi
		call	sub_10016D30
		push	ebx
		call	sub_10015D70
		add	esp, 8

loc_100112DD:				; CODE XREF: sub_10010E70+D99j
					; sub_10010E70+DA5j ...
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100112EA:				; CODE XREF: sub_10010E70+438j
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+18h]
		push	eax		; Size
		push	ecx		; Src
		push	edi		; Dst
		call	memcpy
		mov	edx, [ebx+1Ch]
		mov	eax, [ebx+18h]
		mov	ecx, [esi+1Ch]
		push	edx		; Size
		push	eax		; Src
		add	ecx, edi
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+1ECh+var_1C0]
		push	ebp		; Size
		push	edi		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		mov	[esp+1FCh+var_1C4], eax
		mov	eax, [esp+1FCh+var_1A8]
		push	eax
		push	edi
		call	PORT_ZFree_Util
		push	ebx
		call	sub_10015D70
		mov	ecx, [esp+208h+var_1BC]
		push	ecx
		call	sub_10016D30
		add	esp, 38h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011340:				; CODE XREF: sub_10010E70+26Aj
		cmp	eax, 396h
		ja	loc_1001184A
		jz	loc_100117F9
		sub	eax, 362h	; switch 52 cases
		cmp	eax, 33h
		ja	loc_10012A21	; jumptable 10011366 default case
		movzx	edx, ds:byte_10012B44[eax]
		jmp	ds:off_10012B08[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001136D:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	ebx, [esp+1D4h+var_1C0]	; jumptable 10011366 case 866
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	eax, [esp+1D4h+var_1B0]
		mov	eax, [eax+4]
		mov	edi, [esi+1Ch]
		add	edi, [eax+4]
		mov	[esp+1D4h+var_1B4], eax
		test	ebp, ebp
		jnz	short loc_100113B9
		mov	ebp, edi

loc_1001139D:				; CODE XREF: sub_10010E70+54Bj
		push	edi
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_100113CA
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100113B9:				; CODE XREF: sub_10010E70+529j
		cmp	ebp, edi
		jbe	short loc_1001139D
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100113CA:				; CODE XREF: sub_10010E70+53Aj
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		push	ecx		; Size
		push	edx		; Src
		push	ebx		; Dst
		call	memcpy
		mov	eax, [esp+1E0h+var_1B4]
		mov	ecx, [eax+4]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		push	ecx		; Size
		push	edx		; Src

loc_100113E6:				; CODE XREF: sub_10010E70+61Cj
		add	eax, ebx
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esp+1ECh+var_1C0]
		push	ebp		; Size
		push	ebx		; Src
		push	11h		; int
		push	ecx		; int
		call	sub_10017BD0
		push	edi
		push	ebx
		mov	[esp+204h+var_1C4], eax
		call	PORT_ZFree_Util
		add	esp, 30h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001140F:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	ebx, [esp+1D4h+var_1C0]	; jumptable 10011366 case 867
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	edx, [esp+1D4h+var_1B0]
		mov	eax, [edx+4]
		mov	edi, [esi+1Ch]
		add	edi, [eax+4]
		mov	[esp+1D4h+var_1B4], eax
		test	ebp, ebp
		jnz	short loc_1001145B
		mov	ebp, edi

loc_1001143F:				; CODE XREF: sub_10010E70+5EDj
		push	edi
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1001146C
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001145B:				; CODE XREF: sub_10010E70+5CBj
		cmp	ebp, edi
		jbe	short loc_1001143F
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001146C:				; CODE XREF: sub_10010E70+5DCj
		mov	eax, [esp+1D4h+var_1B4]
		mov	ecx, [eax+4]
		mov	edx, [eax]
		push	ecx		; Size
		push	edx		; Src
		push	ebx		; Dst
		call	memcpy
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+18h]
		mov	edx, [esp+1E0h+var_1B4]
		push	eax
		mov	eax, [edx+4]
		push	ecx
		jmp	loc_100113E6
; ---------------------------------------------------------------------------

loc_10011491:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	ebx, [esp+1D4h+var_1C0]	; jumptable 10011366 case 868
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	edx, [esp+1D4h+var_1B0]
		mov	edi, [edx+4]
		mov	eax, [edi+4]
		mov	ecx, [esi+1Ch]
		cmp	ecx, eax
		jnb	short loc_100114BD
		mov	eax, ecx

loc_100114BD:				; CODE XREF: sub_10010E70+649j
		test	ebp, ebp
		jnz	short loc_100114DF
		mov	ebp, eax

loc_100114C3:				; CODE XREF: sub_10010E70+671j
		push	ebp
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_100114F0
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100114DF:				; CODE XREF: sub_10010E70+64Fj
		cmp	ebp, eax
		jbe	short loc_100114C3
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100114F0:				; CODE XREF: sub_10010E70+660j
		mov	eax, [esi+18h]
		push	ebp		; Size
		push	eax		; Src
		push	ebx		; Dst
		call	memcpy
		add	esp, 0Ch
		xor	eax, eax
		test	ebp, ebp
		jle	short loc_10011511

loc_10011504:				; CODE XREF: sub_10010E70+69Fj
		mov	ecx, [edi]
		mov	dl, [ecx+eax]
		xor	[ebx+eax], dl
		inc	eax
		cmp	eax, ebp
		jl	short loc_10011504

loc_10011511:				; CODE XREF: sub_10010E70+692j
		mov	eax, [esp+1D4h+var_1C0]
		push	ebp		; Size
		push	ebx		; Src
		push	11h		; int
		push	eax		; int
		call	sub_10017BD0
		push	ebp
		push	ebx
		mov	[esp+1ECh+var_1C4], eax
		call	PORT_ZFree_Util
		add	esp, 18h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011532:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	ecx, ebx	; jumptable 10011366 case 869
		mov	edx, [ecx+4]
		mov	eax, [edx]
		mov	ebx, [esp+1D4h+var_1C0]
		mov	ecx, eax
		and	ecx, 7
		shr	eax, 3
		push	edi
		mov	[esp+1D8h+var_1A4], ecx
		mov	[esp+1D8h+var_1A8], eax
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		test	ebp, ebp
		jnz	short loc_10011573
		mov	[esp+1D4h+var_1C4], 0D0h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011573:				; CODE XREF: sub_10010E70+6F4j
		mov	ebx, [esp+1D4h+var_1A4]
		xor	eax, eax
		test	ebx, ebx
		setnz	al
		add	eax, [esp+1D4h+var_1A8]
		add	eax, ebp
		cmp	[esi+1Ch], eax
		jnb	short loc_10011596
		mov	[esp+1D4h+var_1C4], 71h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011596:				; CODE XREF: sub_10010E70+717j
		push	ebp
		call	PORT_Alloc_Util
		mov	ecx, eax
		add	esp, 4
		mov	[esp+1D4h+var_1BC], ecx
		test	ecx, ecx
		jnz	short loc_100115B6
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100115B6:				; CODE XREF: sub_10010E70+737j
		xor	edi, edi
		test	ebp, ebp
		jle	short loc_100115F2
		lea	esp, [esp+0]

loc_100115C0:				; CODE XREF: sub_10010E70+780j
		mov	eax, [esi+18h]
		add	eax, [esp+1D4h+var_1A8]
		test	ebx, ebx
		jz	short loc_100115E7
		mov	dl, [eax+edi+1]
		mov	al, [eax+edi]
		mov	cl, 8
		sub	cl, bl
		shr	dl, cl
		mov	ecx, ebx
		shl	al, cl
		mov	ecx, [esp+1D4h+var_1BC]
		or	dl, al
		mov	[ecx+edi], dl
		jmp	short loc_100115ED
; ---------------------------------------------------------------------------

loc_100115E7:				; CODE XREF: sub_10010E70+759j
		mov	dl, [eax+edi]
		mov	[ecx+edi], dl

loc_100115ED:				; CODE XREF: sub_10010E70+775j
		inc	edi
		cmp	edi, ebp
		jl	short loc_100115C0

loc_100115F2:				; CODE XREF: sub_10010E70+74Aj
		mov	eax, [esp+1D4h+var_1C0]
		push	ebp		; Size
		push	ecx		; Src
		push	11h		; int
		push	eax		; int
		call	sub_10017BD0
		mov	ecx, [esp+1E4h+var_1BC]
		push	ebp
		push	ecx
		mov	[esp+1ECh+var_1C4], eax
		call	PORT_ZFree_Util
		add	esp, 18h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011617:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 913
		jnz	short loc_10011638
		mov	ebp, 10h

loc_10011620:				; CODE XREF: sub_10010E70+7CBj
		call	sub_10021320
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_1001164A
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011638:				; CODE XREF: sub_10010E70+7A9j
		cmp	ebp, 10h
		jbe	short loc_10011620
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001164A:				; CODE XREF: sub_10010E70+7B9j
		push	ebx
		call	sub_10021380
		mov	edx, [esi+1Ch]
		mov	eax, [esi+18h]
		push	edx
		push	eax
		push	ebx
		call	sub_100213B0
		push	10h
		lea	ecx, [esp+1E8h+var_190]
		push	ecx
		lea	edx, [esp+1ECh+var_128]
		push	edx
		push	ebx
		call	sub_100213E0
		push	1
		push	ebx
		call	sub_10021350
		mov	ecx, [esp+1FCh+var_1C0]
		push	ebp		; Size
		lea	eax, [esp+200h+var_128]
		push	eax		; Src
		push	11h		; int
		push	ecx		; int
		call	sub_10017BD0
		add	esp, 38h
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001169C:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 912
		jnz	short loc_100116DB
		mov	ebp, 10h

loc_100116A5:				; CODE XREF: sub_10010E70+86Ej
		mov	edx, [esi+1Ch]
		mov	eax, [esi+18h]
		push	edx
		push	eax
		lea	ecx, [esp+1DCh+var_128]
		push	ecx
		call	sub_100211B0

loc_100116BA:				; CODE XREF: sub_10010E70+921j
		mov	eax, [esp+1E0h+var_1C0]
		push	ebp		; Size
		lea	edx, [esp+1E4h+var_128]
		push	edx		; Src
		push	11h		; int
		push	eax		; int
		call	sub_10017BD0
		add	esp, 1Ch
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100116DB:				; CODE XREF: sub_10010E70+82Ej
		cmp	ebp, 10h
		jbe	short loc_100116A5
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100116ED:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 914
		jnz	short loc_1001172C
		mov	ebp, 14h

loc_100116F6:				; CODE XREF: sub_10010E70+8BFj
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		push	ecx
		push	edx
		lea	eax, [esp+1DCh+var_128]
		push	eax
		call	sub_10021450
		mov	edx, [esp+1E0h+var_1C0]
		push	ebp		; Size
		lea	ecx, [esp+1E4h+var_128]
		push	ecx		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		add	esp, 1Ch
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001172C:				; CODE XREF: sub_10010E70+87Fj
		cmp	ebp, 14h
		jbe	short loc_100116F6
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001173E:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 915
		jnz	short loc_10011761
		mov	ebp, 20h

loc_10011747:				; CODE XREF: sub_10010E70+8F4j
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		lea	edx, [esp+1DCh+var_128]
		push	edx
		call	sub_10021870
		jmp	loc_10011817
; ---------------------------------------------------------------------------

loc_10011761:				; CODE XREF: sub_10010E70+8D0j
		cmp	ebp, 20h
		jbe	short loc_10011747
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011773:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 916
		jnz	short loc_10011796
		mov	ebp, 30h

loc_1001177C:				; CODE XREF: sub_10010E70+929j
		mov	edx, [esi+1Ch]
		mov	eax, [esi+18h]
		push	edx
		push	eax
		lea	ecx, [esp+1DCh+var_128]
		push	ecx
		call	sub_10021B50
		jmp	loc_100116BA
; ---------------------------------------------------------------------------

loc_10011796:				; CODE XREF: sub_10010E70+905j
		cmp	ebp, 30h
		jbe	short loc_1001177C
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100117A8:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		test	ebp, ebp	; jumptable 10011366 case 917
		jnz	short loc_100117E7
		mov	ebp, 40h

loc_100117B1:				; CODE XREF: sub_10010E70+97Aj
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		push	ecx
		push	edx
		lea	eax, [esp+1DCh+var_128]
		push	eax
		call	sub_100219E0
		mov	edx, [esp+1E0h+var_1C0]
		push	ebp		; Size
		lea	ecx, [esp+1E4h+var_128]
		push	ecx		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		add	esp, 1Ch
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100117E7:				; CODE XREF: sub_10010E70+93Aj
		cmp	ebp, 40h
		jbe	short loc_100117B1
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100117F9:				; CODE XREF: sub_10010E70+4DBj
		test	ebp, ebp
		jnz	short loc_10011838
		mov	ebp, 1Ch

loc_10011802:				; CODE XREF: sub_10010E70+9CBj
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		lea	edx, [esp+1DCh+var_128]
		push	edx
		call	sub_10022470

loc_10011817:				; CODE XREF: sub_10010E70+8ECj
		mov	ecx, [esp+1E0h+var_1C0]
		push	ebp		; Size
		lea	eax, [esp+1E4h+var_128]
		push	eax		; Src
		push	11h		; int
		push	ecx		; int
		call	sub_10017BD0
		add	esp, 1Ch
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011838:				; CODE XREF: sub_10010E70+98Bj
		cmp	ebp, 1Ch
		jbe	short loc_10011802
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001184A:				; CODE XREF: sub_10010E70+4D5j
		cmp	eax, 0CE53435Eh
		ja	loc_10011EC3
		jz	loc_10011E3A
		cmp	eax, 0CE534356h
		ja	loc_10011E0C
		jz	loc_10011B89
		cmp	eax, 0CE534354h
		ja	loc_10011B77
		jz	loc_10011B70
		cmp	eax, 1050h
		jb	loc_10012A21	; jumptable 10011366 default case
		cmp	eax, 1051h
		jbe	short loc_100118A4
		cmp	eax, 0CE534353h
		jnz	loc_10012A21	; jumptable 10011366 default case
		mov	eax, 3
		jmp	loc_10011B8E
; ---------------------------------------------------------------------------

loc_100118A4:				; CODE XREF: sub_10010E70+A1Dj
		xor	ecx, ecx
		mov	eax, ebx
		cmp	dword ptr [eax+8], 14h
		mov	ebx, [eax+4]
		mov	[esp+1D4h+var_1A8], ecx
		mov	[esp+1D4h+var_1BC], ecx
		mov	[esp+1D4h+var_1B4], ecx
		mov	[esp+1D4h+var_164], ebx
		jnz	loc_10011FE3
		cmp	dword ptr [ebx], 1
		jnz	short loc_100118DC
		cmp	[ebx+4], ecx
		jnz	loc_10011FE3
		cmp	[ebx+8], ecx
		jnz	loc_10011FE3

loc_100118DC:				; CODE XREF: sub_10010E70+A58j
		lea	edx, [esp+1D4h+var_1C4]
		push	edx
		push	3
		push	edi
		call	sub_10007C20
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	loc_10012A29
		lea	eax, [esi+98h]
		push	eax
		lea	ecx, [esp+1D8h+var_178]
		push	ecx
		push	0
		call	SECITEM_CopyItem_Util
		mov	edx, [ebx+10h]
		mov	[esp+1E0h+var_188], edx
		mov	ecx, [ebx+0Ch]
		mov	[esp+1E0h+var_184], ecx
		mov	eax, [esi+10h]
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		lea	eax, [eax+eax+1]
		add	esp, 0Ch
		cmp	ecx, eax
		jb	loc_10011A42
		jbe	short loc_100119A0
		push	800h
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esp+1D4h+var_1B4], eax
		test	eax, eax
		jz	loc_10011A42
		lea	eax, [esp+1D4h+var_18C]
		push	eax
		push	0
		push	0
		call	NSS_Get_SEC_OctetStringTemplate_Util
		mov	edx, [esp+1E0h+var_1B4]
		add	esp, 8
		push	eax
		lea	ecx, [esp+1DCh+var_14C]
		push	ecx
		push	edx
		call	SEC_QuickDERDecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	loc_10011A42
		mov	eax, [esp+1D4h+var_14C]
		mov	ecx, [esp+1D4h+var_148]
		mov	edx, [esp+1D4h+var_144]
		mov	[esp+1D4h+var_18C], eax
		mov	[esp+1D4h+var_188], ecx
		mov	[esp+1D4h+var_184], edx

loc_100119A0:				; CODE XREF: sub_10010E70+AC5j
		mov	eax, [esp+1D4h+var_1B0]
		cmp	dword ptr [eax], 1051h
		jnz	loc_10011A29
		mov	[esp+1D4h+var_1A8], 1

loc_100119B8:				; CODE XREF: sub_10010E70+BCCj
		mov	edx, [esp+1D4h+var_1A8]
		lea	ecx, [esp+1D4h+var_19C]
		push	ecx
		push	edx
		lea	eax, [esp+1DCh+var_178]
		push	eax
		lea	ecx, [esi+8]
		push	ecx
		lea	edx, [esp+1E4h+var_18C]
		push	edx
		call	sub_10021EF0
		mov	[esp+1E8h+var_1A4], eax
		mov	eax, [esp+1E8h+var_174]
		push	eax
		call	PORT_Free_Util
		add	esp, 18h
		mov	[esp+1D4h+var_174], 0
		cmp	esi, [edi+1Ch]
		jz	short loc_100119FC
		push	esi
		call	sub_10005160
		add	esp, 4

loc_100119FC:				; CODE XREF: sub_10010E70+B81j
		mov	eax, [esp+1D4h+var_1B4]
		test	eax, eax
		jz	short loc_10011A0F
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_10011A0F:				; CODE XREF: sub_10010E70+B92j
		cmp	[esp+1D4h+var_1A4], 0
		jz	short loc_10011A81
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011A29:				; CODE XREF: sub_10010E70+B3Aj
		lea	ecx, [esp+1D4h+var_18C]
		push	ecx
		lea	edx, [esi+8]
		push	edx
		call	sub_10021EB0
		add	esp, 8
		test	eax, eax
		jz	loc_100119B8

loc_10011A42:				; CODE XREF: sub_10010E70+ABFj
					; sub_10010E70+ADAj ...
		mov	eax, [esp+1D4h+var_174]
		push	eax
		mov	[esp+1D8h+var_1C4], 7
		call	PORT_Free_Util
		add	esp, 4
		cmp	esi, [edi+1Ch]
		jz	short loc_10011A65
		push	esi
		call	sub_10005160
		add	esp, 4

loc_10011A65:				; CODE XREF: sub_10010E70+BEAj
		mov	eax, [esp+1D4h+var_1B4]
		test	eax, eax
		jz	loc_10012A29
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011A81:				; CODE XREF: sub_10010E70+BA4j
		mov	ebx, [ebx]
		cmp	ebx, 1
		jnz	short loc_10011A92
		mov	ebx, [esp+1D4h+Src]
		mov	edi, [esp+1D4h+Size]
		jmp	short loc_10011ADC
; ---------------------------------------------------------------------------

loc_10011A92:				; CODE XREF: sub_10010E70+C16j
		mov	eax, [esp+1D4h+var_164]
		lea	ecx, [esp+1D4h+var_19C]
		push	ecx		; int
		mov	ecx, [eax+4]	; Size
		lea	edx, [esp+1D8h+var_1A4]
		push	edx		; int
		mov	edx, [eax+8]	; Src
		mov	esi, ebp
		mov	edi, ebp
		call	sub_10010DD0
		mov	ecx, [esp+1DCh+Src]
		mov	[esp+1DCh+var_1C4], eax
		mov	eax, [esp+1DCh+Size]
		push	eax
		push	ecx
		call	PORT_ZFree_Util
		add	esp, 10h
		cmp	[esp+1D4h+var_1C4], 0
		jnz	loc_10012A29
		mov	ebx, [esp+1D4h+var_1A4]
		mov	[esp+1D4h+Src],	ebx
		mov	[esp+1D4h+Size], ebp

loc_10011ADC:				; CODE XREF: sub_10010E70+C20j
		test	ebp, ebp
		jz	short loc_10011B35
		cmp	edi, ebp
		jnb	short loc_10011B29
		push	ebp
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10011B12
		mov	edx, [esp+1D4h+Size]
		mov	eax, [esp+1D4h+Src]
		push	edx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011B12:				; CODE XREF: sub_10010E70+C81j
		mov	ecx, esi
		push	edi		; Size
		sub	ecx, edi
		add	ecx, ebp
		push	ebx		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	ebx, esi
		mov	edi, ebp
		jmp	short loc_10011B39
; ---------------------------------------------------------------------------

loc_10011B29:				; CODE XREF: sub_10010E70+C72j
		mov	esi, [esp+1D4h+var_1BC]
		sub	edi, ebp
		add	ebx, edi
		mov	edi, ebp
		jmp	short loc_10011B39
; ---------------------------------------------------------------------------

loc_10011B35:				; CODE XREF: sub_10010E70+C6Ej
		mov	esi, [esp+1D4h+var_1BC]

loc_10011B39:				; CODE XREF: sub_10010E70+CB7j
					; sub_10010E70+CC3j
		mov	edx, [esp+1D4h+var_1C0]
		push	edi		; Size
		push	ebx		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		mov	eax, [esp+1E4h+Size]
		mov	ecx, [esp+1E4h+Src]
		push	eax
		push	ecx
		call	PORT_ZFree_Util
		add	esp, 18h
		test	esi, esi
		jz	loc_10012A29
		push	ebp
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011B70:				; CODE XREF: sub_10010E70+A07j
		mov	eax, 4
		jmp	short loc_10011B8E
; ---------------------------------------------------------------------------

loc_10011B77:				; CODE XREF: sub_10010E70+A01j
		cmp	eax, 0CE534355h
		jnz	loc_10012A21	; jumptable 10011366 default case
		mov	eax, 5
		jmp	short loc_10011B8E
; ---------------------------------------------------------------------------

loc_10011B89:				; CODE XREF: sub_10010E70+9F6j
		mov	eax, 6

loc_10011B8E:				; CODE XREF: sub_10010E70+A2Fj
					; sub_10010E70+D05j ...
		mov	edx, [ebx+4]
		push	eax
		mov	[esp+1D8h+var_1B4], edx
		call	sub_10022040
		add	esp, 4
		mov	[esp+1D4h+var_1BC], eax
		test	eax, eax
		jz	loc_100120A2
		mov	edi, [eax]
		cmp	edi, 40h
		ja	loc_100120A2
		mov	ecx, ebx
		cmp	dword ptr [ecx+8], 12h
		jnz	loc_10011FE3
		mov	eax, [esp+1D4h+var_1B4]
		test	eax, eax
		jz	loc_10011FE3
		mov	cl, [eax+9]
		test	cl, cl
		jnz	short loc_10011BDE
		cmp	[eax], cl
		jz	loc_10011FE3
		jmp	short loc_10011BE3
; ---------------------------------------------------------------------------

loc_10011BDE:				; CODE XREF: sub_10010E70+D62j
		cmp	byte ptr [eax],	0
		jz	short loc_10011BF3

loc_10011BE3:				; CODE XREF: sub_10010E70+D6Cj
		cmp	dword ptr [eax+5], 0
		jbe	short loc_10011BF3
		cmp	dword ptr [eax+1], 0
		jz	loc_10011FE3

loc_10011BF3:				; CODE XREF: sub_10010E70+D71j
					; sub_10010E70+D77j
		test	cl, cl
		jz	short loc_10011C07
		cmp	dword ptr [eax+0Eh], 0
		jbe	short loc_10011C07
		cmp	dword ptr [eax+0Ah], 0
		jz	loc_10011FE3

loc_10011C07:				; CODE XREF: sub_10010E70+D85j
					; sub_10010E70+D8Bj
		test	ebp, ebp
		jz	loc_100112DD
		cmp	ebp, 90h
		ja	loc_100112DD
		test	cl, cl
		jnz	short loc_10011C2B
		cmp	ebp, edi
		ja	loc_100112DD
		test	cl, cl
		jz	short loc_10011C3B

loc_10011C2B:				; CODE XREF: sub_10010E70+DADj
		mov	edx, edi
		imul	edx, 0FFh
		cmp	ebp, edx
		ja	loc_100112DD

loc_10011C3B:				; CODE XREF: sub_10010E70+DB9j
		mov	eax, [esp+1D4h+var_160]
		mov	ebx, [esp+1D4h+var_1C0]
		push	eax
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	eax, [esp+1D4h+var_1B4]
		cmp	byte ptr [eax],	0
		jz	loc_10011CFC
		mov	ebx, [eax+1]
		mov	ecx, [eax+5]
		mov	[esp+1D4h+var_1A8], ecx
		test	ebx, ebx
		jnz	short loc_10011C8C
		push	edi		; Size
		lea	ebx, [esp+1D8h+Dst]
		mov	edx, ebx
		push	0		; Val
		push	edx		; Dst
		mov	[esp+1E0h+var_1A8], edi
		call	memset
		add	esp, 0Ch

loc_10011C8C:				; CODE XREF: sub_10010E70+E01j
		mov	eax, [esp+1D4h+var_180]
		mov	ecx, [esp+1D4h+var_1A8]
		mov	edx, [esp+1D4h+var_1BC]
		push	eax
		push	ecx
		push	ebx
		push	edx
		call	sub_100220B0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_10011CB7
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011CB7:				; CODE XREF: sub_10010E70+E38j
		push	ebx
		call	sub_100220F0
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		push	ebx
		call	sub_10022120
		push	40h
		lea	edx, [esp+1E8h+var_1A4]
		push	edx
		lea	eax, [esp+1ECh+Dst]
		push	eax
		push	ebx
		call	sub_10022150
		push	1
		push	ebx
		call	sub_10022080
		mov	esi, [esp+1FCh+var_1A4]
		mov	eax, [esp+1FCh+var_1B4]
		add	esp, 28h
		lea	ecx, [esp+1D4h+Dst]
		jmp	short loc_10011D02
; ---------------------------------------------------------------------------

loc_10011CFC:				; CODE XREF: sub_10010E70+DEFj
		mov	ecx, [esi+18h]
		mov	esi, [esi+1Ch]

loc_10011D02:				; CODE XREF: sub_10010E70+E8Aj
		cmp	byte ptr [eax+9], 0
		jz	loc_10011DF2
		xor	edx, edx
		lea	eax, [edi+ebp-1]
		div	edi
		xor	edx, edx
		imul	eax, edi
		div	edi
		mov	edx, [esp+1D4h+var_180]
		push	edx
		push	esi
		push	ecx
		mov	ebx, eax
		mov	eax, [esp+1E0h+var_1BC]
		push	eax
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10011D44
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011D44:				; CODE XREF: sub_10010E70+EC5j
		mov	[esp+1D4h+var_1B5], 1
		cmp	ebx, 1
		jb	loc_10011DE0

loc_10011D52:				; CODE XREF: sub_10010E70+F6Aj
		push	esi
		call	sub_100220F0
		mov	al, [esp+1D8h+var_1B5]
		add	esp, 4
		cmp	al, 1
		jbe	short loc_10011D7E
		movzx	ecx, al
		sub	ecx, 2
		imul	ecx, edi
		push	edi
		lea	edx, [esp+ecx+1D8h+var_128]
		push	edx
		push	esi
		call	sub_10022120
		add	esp, 0Ch

loc_10011D7E:				; CODE XREF: sub_10010E70+EF1j
		mov	eax, [esp+1D4h+var_1B4]
		mov	eax, [eax+0Eh]
		test	eax, eax
		jz	short loc_10011D9B
		mov	ecx, [esp+1D4h+var_1B4]
		mov	edx, [ecx+0Ah]
		push	eax
		push	edx
		push	esi
		call	sub_10022120
		add	esp, 0Ch

loc_10011D9B:				; CODE XREF: sub_10010E70+F17j
		push	1
		lea	eax, [esp+1D8h+var_1B5]
		push	eax
		push	esi
		call	sub_10022120
		movzx	edx, [esp+1E0h+var_1B5]
		dec	edx
		imul	edx, edi
		push	edi
		lea	ecx, [esp+1E4h+var_154]
		push	ecx
		lea	eax, [esp+edx+1E8h+var_128]
		push	eax
		push	esi
		call	sub_10022150
		mov	al, [esp+1F0h+var_1B5]
		inc	al
		movzx	ecx, al
		add	esp, 1Ch
		mov	[esp+1D4h+var_1B5], al
		cmp	ecx, ebx
		jbe	loc_10011D52

loc_10011DE0:				; CODE XREF: sub_10010E70+EDCj
		push	1
		push	esi
		call	sub_10022080
		add	esp, 8
		lea	ecx, [esp+1D4h+var_128]

loc_10011DF2:				; CODE XREF: sub_10010E70+E96j
		mov	edx, [esp+1D4h+var_1C0]
		push	ebp		; Size
		push	ecx		; Src
		push	11h		; int
		push	edx		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011E0C:				; CODE XREF: sub_10010E70+9F0j
		cmp	eax, 0CE53435Bh
		jz	short loc_10011E33
		cmp	eax, 0CE53435Ch
		jz	short loc_10011E2C
		cmp	eax, 0CE53435Dh
		jnz	loc_10012A21	; jumptable 10011366 default case
		mov	esi, 5
		jmp	short loc_10011E3F
; ---------------------------------------------------------------------------

loc_10011E2C:				; CODE XREF: sub_10010E70+FA8j
		mov	esi, 4
		jmp	short loc_10011E3F
; ---------------------------------------------------------------------------

loc_10011E33:				; CODE XREF: sub_10010E70+FA1j
		mov	esi, 3
		jmp	short loc_10011E3F
; ---------------------------------------------------------------------------

loc_10011E3A:				; CODE XREF: sub_10010E70+9E5j
		mov	esi, 6

loc_10011E3F:				; CODE XREF: sub_10010E70+FBAj
					; sub_10010E70+FC1j ...
		cmp	dword ptr [ebx+4], 0
		jz	short loc_10011E4B
		cmp	dword ptr [ebx+8], 50h
		jz	short loc_10011E58

loc_10011E4B:				; CODE XREF: sub_10010E70+FD3j
		mov	[esp+1D4h+var_1C4], 71h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011E58:				; CODE XREF: sub_10010E70+FD9j
		cmp	[esp+1D4h+var_1C4], 0
		jnz	loc_10012A29
		mov	eax, [esp+1D4h+var_1C0]
		push	1
		push	eax
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10011E83
		mov	[esp+1D4h+var_1C4], 0D1h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011E83:				; CODE XREF: sub_10010E70+1004j
		cmp	[esp+1D4h+var_1C4], 0
		jnz	loc_10012A29
		mov	ebx, [esp+1D4h+var_1C0]
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	ecx, [esp+1D4h+var_1B0]
		mov	edx, [ecx+4]
		push	ebx
		push	edi
		push	edx
		push	esi
		call	sub_10020210
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011EC3:				; CODE XREF: sub_10010E70+9DFj
		add	eax, 31ACBCA1h	; switch 10 cases
		cmp	eax, 9
		ja	loc_10012A21	; jumptable 10011366 default case
		jmp	ds:off_10012B78[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10011ED8:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	[esp+1D4h+var_17C], 1 ;	jumptable 10011ED1 cases -833404058,-833404056

loc_10011EE0:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	[esp+1D4h+var_1B4], 1 ;	jumptable 10011366 cases 885,887

loc_10011EE8:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		cmp	ecx, 373h	; jumptable 10011366 cases 881,883
		jz	short loc_10011F13
		cmp	ecx, 377h
		jz	short loc_10011F13
		cmp	ecx, 0CE534368h
		jz	short loc_10011F13
		cmp	dword ptr [esi+1Ch], 30h
		jz	short loc_10011F13
		mov	[esp+1D4h+var_1C4], 63h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011F13:				; CODE XREF: sub_10010E70+107Ej
					; sub_10010E70+1086j ...
		push	100h
		push	edi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	loc_10012284
		mov	ecx, [eax+18h]
		cmp	dword ptr [ecx], 10h
		push	eax
		jnz	loc_1001227C
		call	sub_10015D70
		add	esp, 4
		cmp	[esp+1D4h+var_168], 10h
		jz	short loc_10011F52
		mov	[esp+1D4h+var_1C4], 68h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011F52:				; CODE XREF: sub_10010E70+10D3j
		test	ebp, ebp
		jz	short loc_10011F68
		cmp	ebp, 30h
		jz	short loc_10011F68
		mov	[esp+1D4h+var_1C4], 68h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011F68:				; CODE XREF: sub_10010E70+10E4j
					; sub_10010E70+10E9j
		mov	edx, ebx
		mov	ebx, [edx+4]
		mov	esi, [ebx]
		mov	ecx, 8
		lea	edi, [esp+1D4h+Dst]
		rep movsd
		mov	esi, [ebx+8]
		mov	ecx, 8
		lea	edi, [esp+1D4h+var_78]
		rep movsd
		cmp	dword ptr [ebx+10h], 0
		jz	short loc_10011FD5
		mov	eax, [esp+1D4h+var_1C0]
		push	eax
		call	sub_10016570
		mov	ebp, [esp+1D8h+var_16C]
		mov	ecx, [ebp+18h]
		add	esp, 4
		test	eax, eax
		jz	short loc_10011FC6
		cmp	dword ptr [eax+38h], 0
		jnz	short loc_10011FC6
		movzx	eax, byte ptr [ecx]
		mov	edx, [ebx+10h]
		mov	[edx], al
		movzx	eax, byte ptr [ecx+1]
		mov	edx, [ebx+10h]
		mov	[edx+1], al
		jmp	short loc_10011FD9
; ---------------------------------------------------------------------------

loc_10011FC6:				; CODE XREF: sub_10010E70+113Aj
					; sub_10010E70+1140j
		mov	ecx, [ebx+10h]
		mov	byte ptr [ecx],	0FFh
		mov	edx, [ebx+10h]
		mov	byte ptr [edx+1], 0FFh
		jmp	short loc_10011FD9
; ---------------------------------------------------------------------------

loc_10011FD5:				; CODE XREF: sub_10010E70+1122j
		mov	ebp, [esp+1D4h+var_16C]

loc_10011FD9:				; CODE XREF: sub_10010E70+1154j
					; sub_10010E70+1163j
		mov	eax, 20h
		cmp	[ebx+4], eax
		jz	short loc_10011FF0

loc_10011FE3:				; CODE XREF: sub_10010E70+A4Fj
					; sub_10010E70+A5Dj ...
		mov	[esp+1D4h+var_1C4], 71h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10011FF0:				; CODE XREF: sub_10010E70+1171j
		cmp	[ebx+0Ch], eax
		jz	short loc_10012002
		mov	[esp+1D4h+var_1C4], 71h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10012002:				; CODE XREF: sub_10010E70+1183j
		xor	eax, eax
		cmp	[esp+1D4h+var_1B4], eax
		jz	loc_100120AF
		lea	ecx, [esp+1D4h+Dst]
		lea	edx, [esp+1D4h+var_128]
		mov	[esp+1D4h+var_188], ecx
		mov	ecx, [ebp+18h]
		mov	[esp+1D4h+var_174], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1D4h+var_18C], eax
		mov	[esp+1D4h+var_178], eax
		mov	[esp+1D4h+var_19C], eax
		mov	[esp+1D4h+var_184], 40h
		mov	[esp+1D4h+var_170], 30h
		mov	[esp+1D4h+Src],	ecx
		mov	[esp+1D4h+Size], edx
		cmp	[esp+1D4h+var_17C], eax
		jz	short loc_10012079
		mov	eax, [esp+1D4h+var_180]
		push	eax
		lea	ecx, [esp+1D8h+var_178]
		push	ecx
		lea	edx, [esp+1DCh+var_18C]
		push	edx
		push	offset aMasterSecret ; "master secret"
		lea	eax, [esp+1E4h+var_19C]
		push	eax
		push	4
		call	sub_10022430
		add	esp, 18h
		jmp	short loc_1001209A
; ---------------------------------------------------------------------------

loc_10012079:				; CODE XREF: sub_10010E70+11E2j
		mov	ecx, [esp+1D4h+var_180]
		push	ecx
		lea	edx, [esp+1D8h+var_178]
		push	edx
		lea	eax, [esp+1DCh+var_18C]
		push	eax
		lea	ecx, [esp+1E0h+var_19C]
		push	offset aMasterSecret ; "master secret"
		push	ecx
		call	sub_10022000
		add	esp, 14h

loc_1001209A:				; CODE XREF: sub_10010E70+1207j
		test	eax, eax
		jz	loc_100121BB

loc_100120A2:				; CODE XREF: sub_10010E70+D34j
					; sub_10010E70+D3Fj
		mov	[esp+1D4h+var_1C4], 6
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100120AF:				; CODE XREF: sub_10010E70+1198j
		call	sub_100211F0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100120C7

loc_100120BA:				; CODE XREF: sub_10010E70+317j
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100120C7:				; CODE XREF: sub_10010E70+1248j
		call	sub_10021490
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100120E8
		push	edi
		call	PORT_Free_Util
		add	esp, 4
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100120E8:				; CODE XREF: sub_10010E70+1260j
		lea	edx, [esp+1D4h+var_128]
		mov	[esp+1D4h+var_1BC], edx
		mov	ebx, offset off_1002707C

loc_100120F8:				; CODE XREF: sub_10010E70+1336j
		push	esi
		call	sub_100214F0
		mov	ecx, [ebx]
		mov	eax, ecx
		lea	edx, [eax+1]
		add	esp, 4
		mov	[esp+1D4h+var_1A4], edx
		lea	esp, [esp+0]

loc_10012110:				; CODE XREF: sub_10010E70+12A5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10012110
		sub	eax, [esp+1D4h+var_1A4]
		push	eax
		push	ecx
		push	esi
		call	sub_10021520
		mov	eax, [ebp+1Ch]
		mov	ecx, [ebp+18h]
		push	eax
		push	ecx
		push	esi
		call	sub_10021520
		push	40h
		lea	edx, [esp+1F0h+Dst]
		push	edx
		push	esi
		call	sub_10021520
		push	14h
		lea	eax, [esp+1FCh+var_190]
		push	eax
		lea	ecx, [esp+200h+var_58]
		push	ecx
		push	esi
		call	sub_10021550
		push	edi
		call	sub_10021250
		mov	edx, [ebp+1Ch]
		mov	eax, [ebp+18h]
		push	edx
		push	eax
		push	edi
		call	sub_10021280
		mov	ecx, [esp+218h+var_190]
		add	esp, 44h
		push	ecx
		lea	edx, [esp+1D8h+var_58]
		push	edx
		push	edi
		call	sub_10021280
		mov	ecx, [esp+1E0h+var_1BC]
		push	10h
		lea	eax, [esp+1E4h+var_190]
		push	eax
		push	ecx
		push	edi
		call	sub_100212B0
		add	[esp+1F0h+var_1BC], 10h
		add	ebx, 4
		add	esp, 1Ch
		cmp	ebx, offset off_10027088
		jl	loc_100120F8
		push	edi
		call	PORT_Free_Util
		push	esi
		call	PORT_Free_Util
		add	esp, 8

loc_100121BB:				; CODE XREF: sub_10010E70+122Cj
		mov	eax, [esp+1D4h+var_1C0]
		push	30h		; Size
		lea	edx, [esp+1D8h+var_128]
		push	edx		; Src
		push	11h		; int
		push	eax		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	edx, [esp+1D4h+var_1C0]
		push	4		; Size
		lea	ecx, [esp+1D8h+var_168]
		push	ecx		; Src
		push	100h		; int
		push	edx		; int
		mov	[esp+1E4h+var_168], 10h
		call	sub_10017BD0
		add	esp, 10h
		cmp	[esp+1D4h+var_1B4], 0
		mov	[esp+1D4h+var_1C4], eax
		jz	loc_10012A29
		mov	ecx, [esp+1D4h+var_1C0]
		push	1		; Size
		lea	eax, [esp+1D8h+var_1A9]
		push	eax		; Src
		push	108h		; int
		push	ecx		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	eax, [esp+1D4h+var_1C0]
		push	1		; Size
		lea	edx, [esp+1D8h+var_1A9]
		push	edx		; Src
		push	10Ah		; int
		push	eax		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		mov	edx, [esp+1D4h+var_1C0]
		push	1		; Size
		lea	ecx, [esp+1D8h+var_1A9]
		push	ecx		; Src
		push	10Ch		; int
		push	edx		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001227C:				; CODE XREF: sub_10010E70+10C0j
					; sub_10010E70+1476j
		call	sub_10015D70
		add	esp, 4

loc_10012284:				; CODE XREF: sub_10010E70+10B3j
					; sub_10010E70+146Dj
		mov	[esp+1D4h+var_1C4], 68h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10012291:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	[esp+1D4h+var_17C], 1 ;	jumptable 10011ED1 case	-833404057

loc_10012299:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	[esp+1D4h+var_1B4], 1 ;	jumptable 10011366 case	886

loc_100122A1:				; CODE XREF: sub_10010E70+4F6j
					; DATA XREF: .text:off_10012B08o
		mov	ebx, [esp+1D4h+var_1C0]	; jumptable 10011366 case 882
		push	edi
		call	sub_10010AA0
		add	esp, 4
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012A29
		cmp	dword ptr [esi+1Ch], 30h
		jz	short loc_100122CD
		mov	[esp+1D4h+var_1C4], 68h
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_100122CD:				; CODE XREF: sub_10010E70+144Ej
		push	100h
		push	edi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10012284
		mov	ecx, [eax+18h]
		cmp	dword ptr [ecx], 10h
		push	eax
		jnz	short loc_1001227C
		call	sub_10015D70
		add	esp, 4
		call	sub_100211F0
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_10012308
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_10012308:				; CODE XREF: sub_10010E70+1489j
		call	sub_10021490
		mov	[esp+1D4h+var_1A4], eax
		test	eax, eax
		jnz	short loc_1001232B
		push	ebx
		call	PORT_Free_Util
		add	esp, 4
		mov	[esp+1D4h+var_1C4], 2
		jmp	loc_10012A29
; ---------------------------------------------------------------------------

loc_1001232B:				; CODE XREF: sub_10010E70+14A3j
		mov	edx, [esp+1D4h+var_1B0]
		mov	eax, [edx+4]
		mov	esi, [eax+15h]
		mov	ecx, 8
		lea	edi, [esp+1D4h+var_44]
		rep movsd
		mov	esi, [eax+0Dh]
		mov	ecx, 8
		lea	edi, [esp+1D4h+var_24]
		rep movsd
		mov	esi, [eax+0Dh]
		mov	ecx, 8
		lea	edi, [esp+1D4h+Dst]
		rep movsd
		mov	esi, [eax+15h]
		xor	edx, edx
		mov	ecx, 8
		lea	edi, [esp+1D4h+var_78]
		rep movsd
		mov	ecx, [eax+1Dh]
		mov	[ecx], edx
		mov	[ecx+4], edx
		mov	[ecx+8], edx
		mov	[ecx+0Ch], edx
		mov	edi, [eax]
		mov	esi, [eax+4]
		mov	[esp+1D4h+var_164], ecx
		mov	ecx, [eax+8]
		shr	edi, 3
		shr	esi, 3
		shr	ecx, 3
		mov	[esp+1D4h+var_154], eax
		mov	[esp+1D4h+var_140], edi
		mov	[esp+1D4h+var_1B0], esi
		mov	[esp+1D4h+var_1A8], ecx
		cmp	ebp, edx
		jnz	short loc_100123BB
		xor	esi, esi
		mov	[esp+1D4h+var_1B0], esi

loc_100123BB:				; CODE XREF: sub_10010E70+1543j
		xor	edx, edx
		cmp	[eax+0Ch], dl
		setz	dl
		imul	edx, ecx
		add	edx, esi
		add	edx, edi
		add	edx, edx
		mov	eax, edx
		mov	[esp+1D4h+var_158], edx
		cmp	eax, 90h
		jbe	short loc_100123E2
		mov	eax, 90h
		mov	[esp+1D4h+var_158], eax

loc_100123E2:				; CODE XREF: sub_10010E70+1567j
		xor	ecx, ecx
		cmp	[esp+1D4h+var_1B4], ecx
		jz	loc_100124A5
		lea	edx, [esp+1D4h+var_44]
		mov	[esp+1D4h+var_188], edx
		lea	edx, [esp+1D4h+var_128]
		mov	[esp+1D4h+var_170], eax
		mov	eax, [esp+1D4h+var_16C]
		mov	[esp+1D4h+var_174], edx
		mov	edx, [eax+18h]
		mov	eax, [eax+1Ch]
		mov	[esp+1D4h+var_18C], ecx
		mov	[esp+1D4h+var_178], ecx
		mov	[esp+1D4h+var_19C], ecx
		mov	[esp+1D4h+var_184], 40h
		mov	[esp+1D4h+Src],	edx
		mov	[esp+1D4h+Size], eax
		cmp	[esp+1D4h+var_17C], ecx
		jz	short loc_10012459
		mov	ecx, [esp+1D4h+var_180]
		push	ecx
		lea	edx, [esp+1D8h+var_178]
		push	edx
		lea	eax, [esp+1DCh+var_18C]
		push	eax
		push	offset aKeyExpansion ; "key expansion"
		lea	ecx, [esp+1E4h+var_19C]
		push	ecx
		push	4
		call	sub_10022430
		add	esp, 18h
		jmp	short loc_1001247A
; ---------------------------------------------------------------------------

loc_10012459:				; CODE XREF: sub_10010E70+15C2j
		mov	edx, [esp+1D4h+var_180]
		push	edx
		lea	eax, [esp+1D8h+var_178]
		push	eax
		lea	ecx, [esp+1DCh+var_18C]
		push	ecx
		lea	edx, [esp+1E0h+var_19C]
		push	offset aKeyExpansion ; "key expansion"
		push	edx
		call	sub_10022000
		add	esp, 14h

loc_1001247A:				; CODE XREF: sub_10010E70+15E7j
		test	eax, eax
		jz	loc_1001259C
		mov	edi, [esp+1D4h+var_164]

loc_10012486:				; CODE XREF: sub_10010E70+1A0Ej
					; sub_10010E70+1A89j ...
		cmp	[esp+1D4h+var_1C4], 0
		jnz	short loc_10012495
		mov	[esp+1D4h+var_1C4], 6

loc_10012495:				; CODE XREF: sub_10010E70+161Bj
					; sub_10010E70+175Aj ...
		mov	eax, edi
		mov	edi, [esp+1D4h+var_1A0]
		call	sub_10010A50
		jmp	loc_100129A8
; ---------------------------------------------------------------------------

loc_100124A5:				; CODE XREF: sub_10010E70+1578j
		mov	[esp+1D4h+var_1BC], ecx
		lea	ecx, [esp+1D4h+var_128]
		mov	[esp+1D4h+var_150], ecx
		mov	[esp+1D4h+var_17C], offset off_1002707C
		jmp	short loc_100124C5
; ---------------------------------------------------------------------------

loc_100124C1:				; CODE XREF: sub_10010E70+1726j
		mov	eax, [esp+1D4h+var_158]

loc_100124C5:				; CODE XREF: sub_10010E70+164Fj
		cmp	[esp+1D4h+var_1BC], eax
		jnb	loc_1001259C
		mov	esi, [esp+1D4h+var_1A4]
		push	esi
		call	sub_100214F0
		mov	edx, [esp+1D8h+var_17C]
		mov	edi, [edx]
		mov	eax, edi
		add	esp, 4
		lea	ecx, [eax+1]

loc_100124E7:				; CODE XREF: sub_10010E70+167Cj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_100124E7
		sub	eax, ecx
		push	eax
		push	edi
		push	esi
		call	sub_10021520
		mov	edi, [esp+1E0h+var_16C]
		mov	eax, [edi+1Ch]
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		push	esi
		call	sub_10021520
		push	40h
		lea	edx, [esp+1F0h+var_44]
		push	edx
		push	esi
		call	sub_10021520
		push	14h
		lea	eax, [esp+1FCh+var_190]
		push	eax
		lea	ecx, [esp+200h+var_58]
		push	ecx
		push	esi
		call	sub_10021550
		push	ebx
		call	sub_10021250
		mov	edx, [edi+1Ch]
		mov	eax, [edi+18h]
		push	edx
		push	eax
		push	ebx
		call	sub_10021280
		mov	ecx, [esp+218h+var_190]
		add	esp, 44h
		push	ecx
		lea	edx, [esp+1D8h+var_58]
		push	edx
		push	ebx
		call	sub_10021280
		mov	esi, [esp+1E0h+var_150]
		push	10h
		lea	eax, [esp+1E4h+var_190]
		push	eax
		push	esi
		push	ebx
		call	sub_100212B0
		mov	eax, [esp+1F0h+var_17C]
		mov	ecx, [esp+1F0h+var_190]
		add	[esp+1F0h+var_1BC], ecx
		add	eax, 4
		add	esi, 10h
		add	esp, 1Ch
		mov	[esp+1D4h+var_17C], eax
		mov	[esp+1D4h+var_150], esi
		cmp	eax, offset aIvBlock ; "IV block"
		jl	loc_100124C1

loc_1001259C:				; CODE XREF: sub_10010E70+160Cj
					; sub_10010E70+1659j
		mov	edi, [esp+1D4h+var_164]
		mov	esi, [esp+1D4h+var_140]
		mov	eax, [esp+1D4h+var_1A0]
		push	edi		; int
		push	esi		; Size
		lea	edx, [esp+1DCh+var_128]
		push	edx		; void *
		push	1		; int
		push	eax		; int
		mov	eax, [esp+1E8h+var_1C0]
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		mov	edx, [esp+1D4h+var_1A0]
		lea	eax, [edi+4]
		push	eax		; int
		mov	eax, [esp+1D8h+var_1C0]
		push	esi		; Size
		lea	ecx, [esp+esi+1DCh+var_128]
		push	ecx		; void *
		push	1		; int
		push	edx		; int
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		add	esi, esi
		test	ebp, ebp
		jz	loc_100129A0
		mov	eax, [esp+1D4h+var_154]
		cmp	byte ptr [eax+0Ch], 0
		jnz	loc_100126A5
		mov	edx, [esp+1D4h+var_1A0]
		lea	eax, [edi+8]
		push	eax		; int
		mov	eax, [esp+1D8h+var_1C0]
		push	ebp		; Size
		lea	ecx, [esp+esi+1DCh+var_128]
		push	ecx		; void *
		push	0		; int
		push	edx		; int
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		mov	ecx, [esp+1D4h+var_1A0]
		lea	eax, [edi+0Ch]
		push	eax		; int
		add	esi, ebp
		push	ebp		; Size
		lea	eax, [esp+esi+1DCh+var_128]
		push	eax		; void *
		mov	eax, [esp+1E0h+var_1C0]
		push	0		; int
		push	ecx		; int
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		add	esi, ebp
		mov	ebp, [esp+1D4h+var_1A8]
		test	ebp, ebp
		jz	loc_100129A0
		mov	eax, [edi+10h]
		push	ebp		; Size
		lea	edx, [esp+esi+1D8h+var_128]
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	edx, [edi+14h]
		add	esi, ebp
		push	ebp
		lea	ecx, [esp+esi+1E4h+var_128]
		push	ecx
		push	edx
		jmp	loc_10012998
; ---------------------------------------------------------------------------

loc_100126A5:				; CODE XREF: sub_10010E70+17A1j
		cmp	[esp+1D4h+var_1B4], 0
		jnz	loc_10012812
		push	ebx
		call	sub_10021250
		mov	eax, [esp+1D8h+var_1B0]
		push	eax
		lea	ecx, [esp+esi+1DCh+var_128]
		push	ecx
		push	ebx
		call	sub_10021280
		push	40h
		lea	edx, [esp+1E8h+Dst]
		push	edx
		push	ebx
		call	sub_10021280
		push	10h
		lea	eax, [esp+1F4h+var_190]
		push	eax
		lea	ecx, [esp+1F8h+var_138]
		push	ecx
		push	ebx
		call	sub_100212B0
		lea	eax, [edi+8]
		push	eax		; int
		mov	eax, [esp+204h+var_1A0]
		push	ebp		; Size
		lea	edx, [esp+208h+var_138]
		push	edx		; void *
		push	0		; int
		push	eax		; int
		mov	eax, [esp+214h+var_1C0]
		call	sub_100108A0
		add	esp, 40h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		push	ebx
		call	sub_10021250
		mov	eax, [esp+1D8h+var_1B0]
		push	eax
		add	eax, esi
		lea	ecx, [esp+eax+1DCh+var_128]
		push	ecx
		push	ebx
		call	sub_10021280
		push	40h
		lea	edx, [esp+1E8h+var_44]
		push	edx
		push	ebx
		call	sub_10021280
		push	10h
		lea	eax, [esp+1F4h+var_190]
		push	eax
		lea	ecx, [esp+1F8h+var_138]
		push	ecx
		push	ebx
		call	sub_100212B0
		lea	eax, [edi+0Ch]
		push	eax		; int
		mov	eax, [esp+204h+var_1A0]
		push	ebp		; Size
		lea	edx, [esp+208h+var_138]
		push	edx		; void *
		push	0		; int
		push	eax		; int
		mov	eax, [esp+214h+var_1C0]
		call	sub_100108A0
		add	esp, 40h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		push	ebx
		call	sub_10021250
		push	40h
		lea	ecx, [esp+1DCh+Dst]
		push	ecx
		push	ebx
		call	sub_10021280
		push	10h
		lea	edx, [esp+1E8h+var_190]
		push	edx
		lea	eax, [esp+1ECh+var_138]
		push	eax
		push	ebx
		call	sub_100212B0
		mov	esi, [esp+1F4h+var_1A8]
		mov	edx, [edi+10h]
		push	esi		; Size
		lea	ecx, [esp+1F8h+var_138]
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		push	ebx
		call	sub_10021250
		push	40h
		lea	eax, [esp+208h+var_44]
		push	eax
		push	ebx
		call	sub_10021280
		push	10h
		lea	ecx, [esp+214h+var_190]
		push	ecx
		lea	edx, [esp+218h+var_138]
		push	edx
		push	ebx
		call	sub_100212B0
		mov	ecx, [edi+14h]
		add	esp, 4Ch
		push	esi		; Size
		lea	eax, [esp+1D8h+var_138]
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		jmp	loc_100129A0
; ---------------------------------------------------------------------------

loc_10012812:				; CODE XREF: sub_10010E70+183Aj
		xor	eax, eax
		mov	[esp+1D4h+var_18C], eax
		mov	[esp+1D4h+var_178], eax
		mov	[esp+1D4h+var_19C], eax
		mov	eax, [esp+1D4h+var_1B0]
		lea	edx, [esp+esi+1D4h+var_128]
		mov	[esp+1D4h+var_184], eax
		add	esi, eax
		mov	[esp+1D4h+var_188], edx
		mov	edx, [esp+1D4h+var_180]
		push	edx
		lea	eax, [esp+1D8h+Dst]
		mov	[esp+1D8h+var_174], eax
		lea	ecx, [esp+1D8h+var_138]
		lea	eax, [esp+1D8h+var_19C]
		push	eax
		mov	[esp+1DCh+Src],	ecx
		lea	ecx, [esp+1DCh+var_178]
		push	ecx
		lea	edx, [esp+1E0h+var_18C]
		push	offset aClientWriteKey ; "client write key"
		push	edx
		mov	[esp+1E8h+var_170], 40h
		mov	[esp+1E8h+Size], 10h
		call	sub_10022000
		add	esp, 14h
		test	eax, eax
		jnz	loc_10012486
		mov	ecx, [esp+1D4h+var_1A0]
		lea	eax, [edi+8]
		push	eax		; int
		push	ebp		; Size
		lea	eax, [esp+1DCh+var_138]
		push	eax		; void *
		mov	eax, [esp+1E0h+var_1C0]
		push	0		; int
		push	ecx		; int
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		mov	eax, [esp+1D4h+var_1B0]
		lea	edx, [esp+esi+1D4h+var_128]
		mov	[esp+1D4h+var_188], edx
		mov	edx, [esp+1D4h+var_180]
		push	edx
		mov	[esp+1D8h+var_184], eax
		lea	ecx, [esp+1D8h+var_138]
		lea	eax, [esp+1D8h+var_19C]
		push	eax
		mov	[esp+1DCh+Src],	ecx
		lea	ecx, [esp+1DCh+var_178]
		push	ecx
		lea	edx, [esp+1E0h+var_18C]
		push	offset aServerWriteKey ; "server write key"
		push	edx
		mov	[esp+1E8h+Size], 10h
		call	sub_10022000
		add	esp, 14h
		test	eax, eax
		jnz	loc_10012486
		mov	ecx, [esp+1D4h+var_1A0]
		lea	eax, [edi+0Ch]
		push	eax		; int
		push	ebp		; Size
		lea	eax, [esp+1DCh+var_138]
		push	eax		; void *
		mov	eax, [esp+1E0h+var_1C0]
		push	0		; int
		push	ecx		; int
		call	sub_100108A0
		add	esp, 14h
		mov	[esp+1D4h+var_1C4], eax
		test	eax, eax
		jnz	loc_10012495
		mov	ebp, [esp+1D4h+var_1A8]
		cmp	ebp, eax
		jz	short loc_100129A0
		mov	edx, [esp+1D4h+var_1B0]
		add	edx, esi
		mov	[esp+1D4h+var_188], eax
		mov	[esp+1D4h+var_184], eax
		lea	eax, [esp+edx+1D4h+var_128]
		mov	edx, [esp+1D4h+var_180]
		push	edx
		mov	[esp+1D8h+Src],	eax
		lea	ecx, [ebp+ebp+0]
		lea	eax, [esp+1D8h+var_19C]
		push	eax
		mov	[esp+1DCh+Size], ecx
		lea	ecx, [esp+1DCh+var_178]
		push	ecx
		lea	edx, [esp+1E0h+var_18C]
		push	offset aIvBlock	; "IV block"
		push	edx
		call	sub_10022000
		add	esp, 14h
		test	eax, eax
		jnz	loc_10012486
		mov	eax, [esp+1D4h+Src]
		mov	ecx, [edi+10h]
		push	ebp		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+1E0h+Src]
		mov	eax, [edi+14h]
		push	ebp		; Size
		add	edx, ebp
		push	edx		; Src
		push	eax		; Dst

loc_10012998:				; CODE XREF: sub_10010E70+1830j
		call	memcpy
		add	esp, 18h

loc_100129A0:				; CODE XREF: sub_10010E70+1790j
					; sub_10010E70+1809j ...
		mov	[esp+1D4h+var_1C4], 0

loc_100129A8:				; CODE XREF: sub_10010E70+1630j
		push	1
		push	ebx
		call	sub_10021220
		mov	ecx, [esp+1DCh+var_1A4]
		push	1
		push	ecx
		call	sub_100214C0
		mov	edx, [esp+1E4h+var_1C0]
		push	edx
		call	sub_10016D30
		add	esp, 14h
		mov	[esp+1D4h+var_1C0], 0
		jmp	short loc_10012A29
; ---------------------------------------------------------------------------

loc_100129D3:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	ecx, 3		; jumptable 10011ED1 case -833404065
		jmp	short loc_100129ED
; ---------------------------------------------------------------------------

loc_100129DA:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	ecx, 4		; jumptable 10011ED1 case -833404064
		jmp	short loc_100129ED
; ---------------------------------------------------------------------------

loc_100129E1:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	ecx, 5		; jumptable 10011ED1 case -833404063
		jmp	short loc_100129ED
; ---------------------------------------------------------------------------

loc_100129E8:				; CODE XREF: sub_10010E70+1061j
					; DATA XREF: .text:off_10012B78o
		mov	ecx, 6		; jumptable 10011ED1 case -833404062

loc_100129ED:				; CODE XREF: sub_10010E70+1B68j
					; sub_10010E70+1B6Fj ...
		mov	eax, [ebx+4]
		test	eax, eax
		jz	short loc_100129FA
		cmp	dword ptr [ebx+8], 18h
		jz	short loc_10012A04

loc_100129FA:				; CODE XREF: sub_10010E70+1B82j
		mov	[esp+1D4h+var_1C4], 71h
		jmp	short loc_10012A29
; ---------------------------------------------------------------------------

loc_10012A04:				; CODE XREF: sub_10010E70+1B88j
		cmp	[esp+1D4h+var_1C4], 0
		jnz	short loc_10012A29
		mov	edx, [esp+1D4h+var_1C0]
		push	edx
		push	edi
		push	eax
		push	ecx
		call	sub_10020650
		add	esp, 10h
		mov	[esp+1D4h+var_1C4], eax
		jmp	short loc_10012A29
; ---------------------------------------------------------------------------

loc_10012A21:				; CODE XREF: sub_10010E70+279j
					; sub_10010E70+4E9j ...
		mov	[esp+1D4h+var_1C4], 70h	; jumptable 10011366 default case

loc_10012A29:				; CODE XREF: sub_10010E70+29Aj
					; sub_10010E70+2C6j ...
		mov	eax, [esp+1D4h+var_16C]
		test	eax, eax
		jz	short loc_10012A3A
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10012A3A:				; CODE XREF: sub_10010E70+1BBFj
		mov	eax, [esp+1D4h+var_160]
		push	eax
		call	sub_10016D30
		add	esp, 4
		cmp	[esp+1D4h+var_1C4], 0
		jz	short loc_10012A61
		mov	eax, [esp+1D4h+var_1C0]
		test	eax, eax
		jz	short loc_10012ABF
		push	eax
		call	sub_10016D30
		add	esp, 4
		jmp	short loc_10012ABF
; ---------------------------------------------------------------------------

loc_10012A61:				; CODE XREF: sub_10010E70+1BDCj
		mov	edi, [esp+1D4h+var_1C0]
		test	edi, edi
		jz	short loc_10012ABF
		push	edi
		call	sub_10016570
		mov	ecx, [esp+1D8h+var_1A0]
		push	ecx
		mov	dword ptr [eax+38h], 1
		call	sub_100164F0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10012A99
		push	edi
		call	sub_10016D30
		add	esp, 4

loc_10012A92:				; CODE XREF: sub_10010E70+ABj
		mov	eax, 2
		jmp	short loc_10012AC3
; ---------------------------------------------------------------------------

loc_10012A99:				; CODE XREF: sub_10010E70+1C17j
		push	esi
		push	edi
		call	sub_1000A8F0
		push	esi
		mov	[esp+1E0h+var_1C4], eax
		call	sub_100177F0
		mov	edx, [edi+0Ch]
		mov	eax, [esp+1E0h+var_13C]
		push	edi
		mov	[eax], edx
		call	sub_10016D30
		add	esp, 10h

loc_10012ABF:				; CODE XREF: sub_10010E70+14Bj
					; sub_10010E70+1C6j ...
		mov	eax, [esp+1D4h+var_1C4]

loc_10012AC3:				; CODE XREF: sub_10010E70+1ECj
					; sub_10010E70+222j ...
		mov	ecx, [esp+1D4h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1C4h
		retn
sub_10010E70	endp

; ---------------------------------------------------------------------------
off_10012ADC	dd offset loc_10010FC0	; DATA XREF: sub_10010E70+131r
		dd offset loc_10010FC7	; jump table for switch	statement
		dd offset loc_10010FCE
		dd offset loc_10010FD5
byte_10012AEC	db	0,     1,     2,     3 ; DATA XREF: sub_10010E70+12Ar
		db	3,     3,     3,     3 ; indirect table	for switch statement
		db	3,     3,     3,     0
off_10012AF8	dd offset loc_10010FF5	; DATA XREF: sub_10010E70+17Er
		dd offset loc_10011003	; jump table for switch	statement
byte_10012B00	db	0,     0,     0,     0 ; DATA XREF: sub_10010E70+177r
		db	1,     1,     1,     1 ; indirect table	for switch statement
off_10012B08	dd offset loc_1001136D,	offset loc_1001140F, offset loc_10011491
					; DATA XREF: sub_10010E70+4F6r
		dd offset loc_10011532,	offset loc_10011EE8, offset loc_100122A1 ; jump	table for switch statement
		dd offset loc_10011EE0,	offset loc_10012299, offset loc_1001169C
		dd offset loc_10011617,	offset loc_100116ED, offset loc_1001173E
		dd offset loc_10011773,	offset loc_100117A8, offset loc_10012A21
byte_10012B44	db	0,     1,     2,     3 ; DATA XREF: sub_10010E70+4EFr
		db    0Eh,   0Eh,   0Eh,   0Eh ; indirect table	for switch statement
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,     4
		db	5,     4,   0Eh,     6
		db	7,     6,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,   0Eh,   0Eh
		db    0Eh,   0Eh,     8,     9
		db    0Ah,   0Bh,   0Ch,   0Dh
off_10012B78	dd offset loc_100129D3	; DATA XREF: sub_10010E70+1061r
		dd offset loc_100129DA	; jump table for switch	statement
		dd offset loc_100129E1
		dd offset loc_100129E8
		dd offset loc_10012A21
		dd offset loc_10012A21
		dd offset loc_10012A21
		dd offset loc_10011ED8
		dd offset loc_10012291
		dd offset loc_10011ED8

; =============== S U B	R O U T	I N E =======================================


sub_10012BA0	proc near		; CODE XREF: sub_10004A00:loc_10004A1Ej
					; DATA XREF: .rdata:100260B6o ...
		mov	eax, 51h
		retn
sub_10012BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012BB0	proc near		; CODE XREF: sub_10004A30:loc_10004A3Fj
					; DATA XREF: .rdata:10025FF2o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		mov	ebx, [edi]
		push	eax
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10012BD5
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012BD5:				; CODE XREF: sub_10012BB0+1Aj
		mov	eax, [esi+3Ch]
		test	eax, eax
		jz	short loc_10012BE7
		cmp	dword ptr [eax], 2
		jnz	short loc_10012BE7
		cmp	dword ptr [eax+4], 0
		jnz	short loc_10012BF9

loc_10012BE7:				; CODE XREF: sub_10012BB0+2Aj
					; sub_10012BB0+2Fj
		push	esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 91h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012BF9:				; CODE XREF: sub_10012BB0+35j
		mov	edx, [eax+44h]
		mov	ecx, [esp+0Ch+arg_4]
		add	edx, 8
		mov	[edi], edx
		test	ecx, ecx
		jnz	short loc_10012C18
		push	esi
		call	sub_100177F0
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012C18:				; CODE XREF: sub_10012BB0+57j
		cmp	ebx, edx
		jnb	short loc_10012C25
		pop	edi
		pop	esi
		mov	eax, 150h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012C25:				; CODE XREF: sub_10012BB0+6Aj
		mov	edx, [eax]
		mov	[ecx], edx
		mov	edx, [eax+48h]
		mov	[ecx+4], edx
		mov	edx, [eax+44h]
		mov	eax, [eax+3Ch]
		push	edx		; Size
		push	eax		; Src
		add	ecx, 8
		push	ecx		; Dst
		call	memcpy
		push	esi
		call	sub_100177F0
		add	esp, 10h
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10012BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012C50(int,	void *Src, int)
sub_10012C50	proc near		; CODE XREF: sub_10004A50:loc_10004A5Fj
					; DATA XREF: .rdata:10025FF6o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+14h+arg_8]
		push	esi
		push	edi
		xor	edi, edi
		test	ebp, ebp
		jz	loc_10012D9B

loc_10012C65:				; CODE XREF: sub_10012C50+145j
		mov	eax, [esp+1Ch+arg_0]
		mov	edi, [esp+1Ch+Src]
		mov	esi, [edi]
		push	eax
		call	sub_100164F0
		mov	ebx, eax
		xor	ecx, ecx
		add	esp, 4
		cmp	ebx, ecx
		jz	loc_10012DA5
		cmp	esi, 6		; switch 7 cases
		ja	short loc_10012C9F ; jumptable 10012C89	default	case
		jmp	ds:off_10012DB4[esi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10012C90:				; CODE XREF: sub_10012C50+39j
					; DATA XREF: .text:off_10012DB4o
		mov	eax, [ebx+38h]	; jumptable 10012C89 cases 0,1
		jmp	short loc_10012CA1
; ---------------------------------------------------------------------------

loc_10012C95:				; CODE XREF: sub_10012C50+39j
					; DATA XREF: .text:off_10012DB4o
		mov	eax, [ebx+3Ch]	; jumptable 10012C89 case 2
		jmp	short loc_10012CA6
; ---------------------------------------------------------------------------

loc_10012C9A:				; CODE XREF: sub_10012C50+39j
					; DATA XREF: .text:off_10012DB4o
		mov	eax, [ebx+3Ch]	; jumptable 10012C89 cases 3-6
		jmp	short loc_10012CA1
; ---------------------------------------------------------------------------

loc_10012C9F:				; CODE XREF: sub_10012C50+37j
		xor	eax, eax	; jumptable 10012C89 default case

loc_10012CA1:				; CODE XREF: sub_10012C50+43j
					; sub_10012C50+4Dj
		cmp	esi, 6		; switch 7 cases
		ja	short loc_10012CB5 ; jumptable 10012CA6	default	case

loc_10012CA6:				; CODE XREF: sub_10012C50+48j
		jmp	ds:off_10012DD0[esi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10012CAD:				; CODE XREF: sub_10012C50:loc_10012CA6j
					; DATA XREF: .text:off_10012DD0o
		mov	[ebx+38h], ecx	; jumptable 10012CA6 cases 0,1
		jmp	short loc_10012CB5 ; jumptable 10012CA6	default	case
; ---------------------------------------------------------------------------

loc_10012CB2:				; CODE XREF: sub_10012C50:loc_10012CA6j
					; DATA XREF: .text:off_10012DD0o
		mov	[ebx+3Ch], ecx	; jumptable 10012CA6 cases 2-6

loc_10012CB5:				; CODE XREF: sub_10012C50+54j
					; sub_10012C50+60j
		cmp	eax, ecx	; jumptable 10012CA6 default case
		jz	short loc_10012CC4
		push	eax
		call	sub_100176D0
		add	esp, 4
		xor	ecx, ecx

loc_10012CC4:				; CODE XREF: sub_10012C50+67j
		cmp	ebp, 4
		jbe	short loc_10012CCE
		sub	ebp, 4
		jmp	short loc_10012CD0
; ---------------------------------------------------------------------------

loc_10012CCE:				; CODE XREF: sub_10012C50+77j
		xor	ebp, ebp

loc_10012CD0:				; CODE XREF: sub_10012C50+7Cj
		mov	edx, [edi+4]
		add	edi, 8
		mov	[esp+1Ch+var_C], edx
		mov	[esp+1Ch+Src], edi
		cmp	ebp, 4
		jbe	short loc_10012CE8
		sub	ebp, 4
		jmp	short loc_10012CEA
; ---------------------------------------------------------------------------

loc_10012CE8:				; CODE XREF: sub_10012C50+91j
		xor	ebp, ebp

loc_10012CEA:				; CODE XREF: sub_10012C50+96j
		mov	eax, esi
		sub	eax, 2
		mov	[esp+1Ch+var_8], ecx
		mov	[esp+1Ch+var_4], ecx
		jz	short loc_10012D03
		mov	edi, 160h
		jmp	loc_10012D86
; ---------------------------------------------------------------------------

loc_10012D03:				; CODE XREF: sub_10012C50+A7j
		mov	ecx, [esp+1Ch+arg_0]
		lea	eax, [esp+1Ch+var_C]
		push	eax
		push	ecx
		call	sub_1000D6D0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_10012D86
		mov	edx, [esp+1Ch+arg_0]
		push	edx
		call	sub_100164F0
		add	esp, 4
		test	eax, eax
		jnz	short loc_10012D33
		mov	edi, 0B3h
		jmp	short loc_10012D86
; ---------------------------------------------------------------------------

loc_10012D33:				; CODE XREF: sub_10012C50+DAj
		mov	esi, [eax+3Ch]
		test	esi, esi
		jz	short loc_10012D74
		cmp	dword ptr [esi], 2
		jnz	short loc_10012D74
		cmp	dword ptr [esi+4], 0
		jz	short loc_10012D74
		push	eax
		call	sub_100177F0
		mov	eax, [esi+44h]
		mov	ecx, [esp+20h+Src]
		mov	edx, [esi+3Ch]
		add	esp, 4
		push	eax		; Size
		push	ecx		; Src
		push	edx		; Dst
		xor	edi, edi
		call	memcpy
		mov	esi, [esi+44h]
		add	[esp+28h+Src], esi
		add	esp, 0Ch
		cmp	ebp, esi
		jbe	short loc_10012D84
		sub	ebp, esi
		jmp	short loc_10012D86
; ---------------------------------------------------------------------------

loc_10012D74:				; CODE XREF: sub_10012C50+E8j
					; sub_10012C50+EDj ...
		push	eax
		call	sub_100177F0
		add	esp, 4
		mov	edi, 91h
		jmp	short loc_10012D86
; ---------------------------------------------------------------------------

loc_10012D84:				; CODE XREF: sub_10012C50+11Ej
		xor	ebp, ebp

loc_10012D86:				; CODE XREF: sub_10012C50+AEj
					; sub_10012C50+C9j ...
		push	ebx
		call	sub_100177F0
		add	esp, 4
		test	edi, edi
		jnz	short loc_10012D9B
		test	ebp, ebp
		jnz	loc_10012C65

loc_10012D9B:				; CODE XREF: sub_10012C50+Fj
					; sub_10012C50+141j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10012DA5:				; CODE XREF: sub_10012C50+2Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 0Ch
		retn
sub_10012C50	endp

; ---------------------------------------------------------------------------
		align 4
off_10012DB4	dd offset loc_10012C90	; DATA XREF: sub_10012C50+39r
		dd offset loc_10012C90	; jump table for switch	statement
		dd offset loc_10012C95
		dd offset loc_10012C9A
		dd offset loc_10012C9A
		dd offset loc_10012C9A
		dd offset loc_10012C9A
off_10012DD0	dd offset loc_10012CAD	; DATA XREF: sub_10012C50:loc_10012CA6r
		dd offset loc_10012CAD	; jump table for switch	statement
		dd offset loc_10012CB2
		dd offset loc_10012CB2
		dd offset loc_10012CB2
		dd offset loc_10012CB2
		dd offset loc_10012CB2
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012DF0	proc near		; CODE XREF: sub_10004A90:loc_10004AAEj
					; DATA XREF: .rdata:1002608Ao

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		mov	ecx, [esp+arg_C]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+arg_8]
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		push	eax
		push	ecx
		push	esi
		push	edi
		push	ebx
		call	sub_1000CDC0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10012E23
		push	esi
		push	edi
		push	ebx
		call	sub_1000DB10
		add	esp, 0Ch

loc_10012E23:				; CODE XREF: sub_10012DF0+26j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10012DF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012E30	proc near		; CODE XREF: sub_10004AC0:loc_10004ADEj
					; DATA XREF: .rdata:1002608Eo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+arg_10]
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		push	esi
		push	edi
		push	eax
		push	ecx
		push	ebx
		call	sub_1000D270
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10012E65
		mov	edx, [esi]
		push	edx
		push	edi
		push	ebx
		call	sub_1000DB10
		add	esp, 0Ch

loc_10012E65:				; CODE XREF: sub_10012E30+26j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10012E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012E70(int,	void *Src, size_t Size,	int, int)
sub_10012E70	proc near		; CODE XREF: sub_10004AF0:loc_10004B0Ej
					; DATA XREF: .rdata:10026092o

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		mov	ecx, [esp+arg_C]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+Size]
		push	edi
		mov	edi, [esp+0Ch+Src]
		push	eax
		push	ecx
		push	esi
		push	edi
		push	ebx
		call	sub_1000CDC0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10012EA3
		push	esi		; Size
		push	edi		; Src
		push	ebx		; int
		call	sub_1000EA30
		add	esp, 0Ch

loc_10012EA3:				; CODE XREF: sub_10012E70+26j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10012E70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012EB0(int,	int, int, void *Src, int)
sub_10012EB0	proc near		; CODE XREF: sub_10004B20:loc_10004B3Ej
					; DATA XREF: .rdata:10026096o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Src		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+arg_10]
		push	edi
		mov	edi, [esp+0Ch+Src]
		push	esi
		push	edi
		push	eax
		push	ecx
		push	ebx
		call	sub_1000D270
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10012EE5
		mov	edx, [esi]
		push	edx		; Size
		push	edi		; Src
		push	ebx		; int
		call	sub_1000EF80
		add	esp, 0Ch

loc_10012EE5:				; CODE XREF: sub_10012EB0+26j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10012EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012EF0	proc near		; CODE XREF: sub_10004B50+2Bp
					; DATA XREF: .rdata:10026052o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	ebx
		call	sub_100164F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10012F0D
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012F0D:				; CODE XREF: sub_10012EF0+13j
		mov	eax, [esp+8+arg_4]
		push	edi
		push	esi
		push	eax
		call	sub_10017DA0
		push	esi
		mov	edi, eax
		call	sub_100177F0
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10012F57
		cmp	dword ptr [edi+8], 4
		jz	short loc_10012F40
		push	edi
		call	sub_10016D30
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 63h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012F40:				; CODE XREF: sub_10012EF0+3Cj
		push	11h
		push	edi
		call	sub_10016660
		push	edi
		mov	esi, eax
		call	sub_10016D30
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10012F60

loc_10012F57:				; CODE XREF: sub_10012EF0+36j
		pop	edi
		pop	esi
		mov	eax, 60h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10012F60:				; CODE XREF: sub_10012EF0+65j
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+18h]
		push	ecx
		push	edx
		push	ebx
		call	sub_1000DB10
		push	esi
		mov	edi, eax
		call	sub_10015D70
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10012EF0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10012F80:				; DATA XREF: sub_10012FD0+1F7o
					; sub_10012FD0+240o ...
		mov	ecx, [esp+4]
		mov	eax, [ecx+8]
		cmp	dword ptr [eax+4], 1
		jz	short loc_10012F9E
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10012F9E:				; CODE XREF: .text:10012F8Bj
		mov	edx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	edx
		mov	edx, [esp+18h]
		push	edx
		push	eax
		mov	eax, [ecx]
		push	eax
		call	sub_1000E5E0
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012FD0	proc near		; CODE XREF: sub_100042B0+31p
					; sub_100139D0+18j ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		push	edi
		mov	edi, [esp+1Ch+arg_8]
		push	3
		xor	ebp, ebp
		push	108h
		push	edi
		mov	ecx, ebx
		mov	edx, esi
		mov	[esp+28h+var_C], ebp
		mov	[esp+28h+var_8], ebp
		call	sub_1000E2A0
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		cmp	eax, 54h
		jnz	loc_10013892
		push	esi
		call	sub_100164F0
		mov	ecx, eax
		add	esp, 4
		mov	[esp+1Ch+var_4], ecx
		cmp	ecx, ebp
		jnz	short loc_1001302E
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001302E:				; CODE XREF: sub_10012FD0+4Fj
		cmp	[ecx+3Ch], ebp
		jz	short loc_10013049
		mov	ebp, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_8]
		mov	eax, 90h
		jmp	loc_1001315A
; ---------------------------------------------------------------------------

loc_10013049:				; CODE XREF: sub_10012FD0+61j
		push	ecx
		push	edi
		call	sub_10017DA0
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jnz	short loc_1001306F
		mov	ebp, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_8]
		mov	eax, 60h
		jmp	loc_1001315A
; ---------------------------------------------------------------------------

loc_1001306F:				; CODE XREF: sub_10012FD0+87j
		mov	eax, [edi+8]
		cmp	eax, 4
		jz	short loc_1001307C
		cmp	eax, 3
		jnz	short loc_1001308E

loc_1001307C:				; CODE XREF: sub_10012FD0+A5j
		push	108h
		push	edi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_100130AD

loc_1001308E:				; CODE XREF: sub_10012FD0+AAj
		push	edi
		call	sub_10016D30
		mov	ebp, [esp+20h+var_8]
		mov	edi, [esp+20h+var_8]
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 63h
		jmp	loc_1001315A
; ---------------------------------------------------------------------------

loc_100130AD:				; CODE XREF: sub_10012FD0+BCj
		push	100h
		push	edi
		call	sub_10016660
		add	esp, 8
		cmp	eax, ebp
		jnz	short loc_100130DB
		push	edi
		call	sub_10016D30
		mov	ebp, [esp+20h+var_8]
		mov	edi, [esp+20h+var_8]
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 63h
		jmp	short loc_1001315A
; ---------------------------------------------------------------------------

loc_100130DB:				; CODE XREF: sub_10012FD0+EDj
		cmp	dword ptr [eax+1Ch], 4
		push	eax
		jz	short loc_10013103
		call	sub_10015D70
		push	edi
		call	sub_10016D30
		mov	ebp, [esp+24h+var_8]
		mov	edi, [esp+24h+var_8]
		mov	esi, [esp+24h+var_8]
		add	esp, 8
		mov	eax, 13h
		jmp	short loc_1001315A
; ---------------------------------------------------------------------------

loc_10013103:				; CODE XREF: sub_10012FD0+110j
		mov	ecx, [eax+18h]
		mov	ebp, [ecx]
		call	sub_10015D70
		push	6Ch
		call	PORT_Alloc_Util
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001312F
		push	edi
		call	sub_10016D30
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 2
		jmp	short loc_1001315A
; ---------------------------------------------------------------------------

loc_1001312F:				; CODE XREF: sub_10012FD0+149j
		xor	ecx, ecx
		mov	dword ptr [eax], 3
		mov	dword ptr [eax+4], 1
		mov	[eax+8], ecx
		mov	[eax+3Ch], ecx
		mov	[eax+40h], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+14h], ecx
		mov	[eax+68h], edi
		mov	[eax+10h], ecx
		mov	[eax+64h], ecx
		mov	esi, eax
		xor	eax, eax

loc_1001315A:				; CODE XREF: sub_10012FD0+74j
					; sub_10012FD0+9Aj ...
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jz	short loc_1001317B
		mov	edx, [esp+1Ch+var_4]
		push	edx
		call	sub_100177F0
		mov	eax, [esp+20h+var_C]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001317B:				; CODE XREF: sub_10012FD0+190j
		mov	dword ptr [esi+4], 0
		mov	eax, [ebx]
		cmp	eax, 201h
		ja	loc_100134F2
		jz	loc_100134EE
		dec	eax
		cmp	eax, 45h	; switch 70 cases
		ja	loc_100137C5	; jumptable 100131A6 default case
		movzx	eax, ds:byte_100138D0[eax]
		jmp	ds:off_1001389C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100131AD:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 4
		call	sub_1000DC50
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jnz	short loc_100131EB

loc_100131DE:				; CODE XREF: sub_10012FD0+255j
					; sub_10012FD0+291j ...
		mov	[esp+1Ch+var_C], 2
		jmp	loc_10013861
; ---------------------------------------------------------------------------

loc_100131EB:				; CODE XREF: sub_10012FD0+20Cj
		mov	dword ptr [eax], 3
		jmp	loc_1001337C
; ---------------------------------------------------------------------------

loc_100131F6:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 3
		call	sub_1000DC10
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	short loc_100131DE
		mov	dword ptr [eax], 1
		jmp	loc_1001337C
; ---------------------------------------------------------------------------

loc_10013232:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 5
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_100131DE
		mov	dword ptr [eax], 4
		jmp	loc_1001337C
; ---------------------------------------------------------------------------

loc_10013272:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 69
		call	sub_1000DCD0
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_100131DE
		mov	dword ptr [eax], 135h
		jmp	loc_1001337C
; ---------------------------------------------------------------------------

loc_100132B2:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 63
		call	sub_1000DD10
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_100131DE
		mov	dword ptr [eax], 0BFh
		jmp	loc_1001337C
; ---------------------------------------------------------------------------

loc_100132F2:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 64
		call	sub_1000DD50
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_100131DE
		mov	dword ptr [eax], 0C0h
		jmp	short loc_1001337C
; ---------------------------------------------------------------------------

loc_1001332F:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 65
		call	sub_1000DD90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861
		push	0Ch
		mov	dword ptr [esi+4Ch], offset loc_10012F80
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_100131DE
		mov	dword ptr [eax], 0C1h
		jmp	short loc_1001337C
; ---------------------------------------------------------------------------

loc_1001336C:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4Ch], offset loc_1000E6A0 ; jumptable 100131A6 case 0
		jmp	short loc_1001337C
; ---------------------------------------------------------------------------

loc_10013375:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4Ch], offset loc_1000E710 ; jumptable 100131A6 case 2

loc_1001337C:				; CODE XREF: sub_10012FD0+221j
					; sub_10012FD0+25Dj ...
		test	ebp, ebp
		jz	short loc_1001338D
		mov	[esp+1Ch+var_C], 63h
		jmp	loc_10013850
; ---------------------------------------------------------------------------

loc_1001338D:				; CODE XREF: sub_10012FD0+3AEj
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		push	0
		push	edi
		mov	dword ptr [esi+8], 1
		call	sub_10007C20
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100133B5
		mov	[esp+1Ch+var_C], 63h
		jmp	loc_10013850
; ---------------------------------------------------------------------------

loc_100133B5:				; CODE XREF: sub_10012FD0+3D6j
		mov	ecx, [esp+1Ch+var_8]
		test	ecx, ecx
		jz	short loc_100133DB
		mov	[ecx+8], eax
		push	eax
		mov	[esi+3Ch], ecx
		mov	dword ptr [esi+58h], offset loc_1001D810
		call	sub_100051C0
		add	esp, 4
		mov	[esi+64h], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100133DB:				; CODE XREF: sub_10012FD0+3EBj
		push	eax
		mov	[esi+3Ch], eax
		mov	dword ptr [esi+58h], offset nullsub_1
		call	sub_100051C0
		add	esp, 4
		mov	[esi+64h], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100133F6:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		test	ebp, ebp	; jumptable 100131A6 case 12
		jz	short loc_10013407

loc_100133FA:				; CODE XREF: sub_10012FD0+4E0j
					; sub_10012FD0+759j
		mov	[esp+1Ch+var_C], 63h
		jmp	loc_10013861
; ---------------------------------------------------------------------------

loc_10013407:				; CODE XREF: sub_10012FD0+428j
		mov	dword ptr [esi+8], 1
		cmp	dword ptr [ebx+8], 0Ch
		jnz	short loc_10013488
		mov	ecx, [ebx+4]
		call	sub_1000BFA0
		test	eax, eax
		jz	short loc_10013488
		push	0Ch
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		mov	[esp+1Ch+var_8], ebp
		test	ebp, ebp
		jz	loc_100131DE
		mov	edx, [ebx+4]
		lea	eax, [esp+1Ch+var_C]
		push	eax
		push	0
		push	edi
		mov	[ebp+4], edx
		call	sub_10007C20
		add	esp, 0Ch
		mov	[ebp+8], eax
		test	eax, eax
		jnz	short loc_10013463
		push	ebp
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013463:				; CODE XREF: sub_10012FD0+483j
		mov	[esi+3Ch], ebp
		mov	dword ptr [esi+58h], offset loc_1001D810
		mov	dword ptr [esi+4Ch], offset loc_1000E780
		mov	ecx, [ebp+8]
		push	ecx
		call	sub_100051C0
		add	esp, 4
		mov	[esi+64h], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013488:				; CODE XREF: sub_10012FD0+442j
					; sub_10012FD0+44Ej
		mov	[esp+1Ch+var_C], 71h
		jmp	loc_10013861
; ---------------------------------------------------------------------------

loc_10013495:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		mov	dword ptr [esi+4], 1 ; jumptable 100131A6 case 17
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861

loc_100134AD:				; CODE XREF: sub_10012FD0+1D6j
					; DATA XREF: .text:off_1001389Co
		cmp	ebp, 1		; jumptable 100131A6 case 16
		jnz	loc_100133FA
		lea	edx, [esp+1Ch+var_C]
		push	edx
		push	ebp
		push	edi
		call	sub_10007C20
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10013849
		mov	[esi+3Ch], eax
		mov	dword ptr [esi+4Ch], offset sub_1000E850
		cmp	eax, [edi+1Ch]
		mov	eax, offset nullsub_1
		jz	short loc_100134E6
		mov	eax, offset loc_1000BAF0

loc_100134E6:				; CODE XREF: sub_10012FD0+50Fj
		mov	[esi+58h], eax
		jmp	loc_10013842
; ---------------------------------------------------------------------------

loc_100134EE:				; CODE XREF: sub_10012FD0+1BFj
		push	10h
		jmp	short loc_10013525
; ---------------------------------------------------------------------------

loc_100134F2:				; CODE XREF: sub_10012FD0+1B9j
		cmp	eax, 380h
		ja	loc_100136A7
		jz	loc_1001368D
		sub	eax, 202h	; switch 113 cases
		cmp	eax, 70h
		ja	loc_100137C5	; jumptable 100131A6 default case
		movzx	eax, ds:byte_10013950[eax]
		jmp	ds:off_10013918[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001351F:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	ecx, [ebx+4]	; jumptable 10013518 case 514
		mov	edx, [ecx]
		push	edx

loc_10013525:				; CODE XREF: sub_10012FD0+520j
		mov	eax, 1
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001353D:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	eax, [ebx+4]	; jumptable 10013518 case 530
		mov	ecx, [eax]
		push	ecx
		mov	eax, 2
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001355B:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	10h		; jumptable 10013518 case 529
		mov	eax, 2
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013575:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	edx, [ebx+4]	; jumptable 10013518 case 599
		mov	eax, [edx]
		push	eax
		mov	eax, 7
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013593:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	1Ch		; jumptable 10013518 case 598
		mov	eax, 7
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100135AD:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	ecx, [ebx+4]	; jumptable 10013518 case 594
		mov	edx, [ecx]
		push	edx
		mov	eax, 4
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100135CB:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	20h		; jumptable 10013518 case 593
		mov	eax, 4
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100135E5:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	eax, [ebx+4]	; jumptable 10013518 case 610
		mov	ecx, [eax]
		push	ecx
		mov	eax, 5
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013603:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	30h		; jumptable 10013518 case 609
		mov	eax, 5
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001361D:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	edx, [ebx+4]	; jumptable 10013518 case 626
		mov	eax, [edx]
		push	eax
		mov	eax, 6
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001363B:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	40h		; jumptable 10013518 case 625
		mov	eax, 6
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013655:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		mov	ecx, [ebx+4]	; jumptable 10013518 case 546
		mov	edx, [ecx]
		push	edx
		mov	eax, 3
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013673:				; CODE XREF: sub_10012FD0+548j
					; DATA XREF: .text:off_10013918o
		push	14h		; jumptable 10013518 case 545
		mov	eax, 3
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001368D:				; CODE XREF: sub_10012FD0+52Dj
		mov	eax, [ebx+4]
		mov	ecx, [eax]
		push	ecx
		push	edi
		push	3
		call	sub_1000E150
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100136A7:				; CODE XREF: sub_10012FD0+527j
		cmp	eax, 1041h
		ja	short loc_100136D5
		jz	short loc_10013726
		cmp	eax, 381h
		jnz	loc_100137C5	; jumptable 100131A6 default case
		mov	edx, [ebx+4]
		mov	eax, [edx]
		push	eax
		push	edi
		push	4
		call	sub_1000E150
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_100136D5:				; CODE XREF: sub_10012FD0+6DCj
		cmp	eax, 0CE534363h
		ja	loc_100137B7
		jz	loc_1001376E
		cmp	eax, 1042h
		jz	short loc_1001370E
		cmp	eax, 80000373h
		jnz	loc_100137C5	; jumptable 100131A6 default case
		push	0
		push	ebp
		push	edi
		push	esi
		call	sub_1001FCD0
		add	esp, 10h
		mov	[esp+1Ch+var_C], eax
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001370E:				; CODE XREF: sub_10012FD0+71Bj
		mov	dword ptr [esi+4], 1
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10013861

loc_10013726:				; CODE XREF: sub_10012FD0+6DEj
		cmp	ebp, 3
		jnz	loc_100133FA
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		push	ebp
		push	edi
		call	sub_10007C20
		add	esp, 0Ch
		test	eax, eax
		jz	loc_100131DE
		mov	[esi+3Ch], eax
		mov	dword ptr [esi+4Ch], offset sub_1000E920
		cmp	eax, [edi+1Ch]
		mov	eax, offset nullsub_1
		jz	short loc_1001375F
		mov	eax, offset loc_1000BAF0

loc_1001375F:				; CODE XREF: sub_10012FD0+788j
		mov	[esi+58h], eax
		mov	dword ptr [esi+64h], 90h
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_1001376E:				; CODE XREF: sub_10012FD0+710j
		push	edi
		push	ebx
		call	sub_1001D620
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001378B

loc_1001377E:				; CODE XREF: sub_10012FD0+823j
		mov	[esp+1Ch+var_C], 7
		jmp	loc_10013861
; ---------------------------------------------------------------------------

loc_1001378B:				; CODE XREF: sub_10012FD0+7ACj
		push	4
		call	PORT_Alloc_Util
		add	esp, 4
		test	eax, eax
		jz	loc_100131DE
		mov	edx, [edi]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	[esi+3Ch], eax
		mov	[esi+40h], edi
		mov	edx, [ebx]
		mov	[esi+48h], edx
		mov	dword ptr [esi+50h], offset loc_1001D730
		jmp	short loc_1001381F
; ---------------------------------------------------------------------------

loc_100137B7:				; CODE XREF: sub_10012FD0+70Aj
		cmp	eax, 0CE534364h
		jz	short loc_100137E5
		cmp	eax, 0CE534365h
		jz	short loc_100137D2

loc_100137C5:				; CODE XREF: sub_10012FD0+1C9j
					; sub_10012FD0+1D6j ...
		mov	[esp+1Ch+var_C], 70h ; jumptable 100131A6 default case
		jmp	loc_10013861
; ---------------------------------------------------------------------------

loc_100137D2:				; CODE XREF: sub_10012FD0+7F3j
		push	4
		push	ebp
		push	edi
		push	esi
		call	sub_1001FCD0
		add	esp, 10h
		mov	[esp+1Ch+var_C], eax
		jmp	short loc_10013849
; ---------------------------------------------------------------------------

loc_100137E5:				; CODE XREF: sub_10012FD0+7ECj
		push	edi
		push	ebx
		call	sub_1001D670
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1001377E
		push	4
		call	PORT_Alloc_Util
		add	esp, 4
		test	eax, eax
		jz	loc_100131DE
		mov	ecx, [edi]
		mov	edx, [ecx]
		mov	[eax], edx
		mov	[esi+3Ch], eax
		mov	[esi+40h], edi
		mov	eax, [ebx]
		mov	[esi+48h], eax
		mov	dword ptr [esi+50h], offset loc_1001D780

loc_1001381F:				; CODE XREF: sub_10012FD0+7E5j
		mov	dword ptr [esi+4], 1
		mov	dword ptr [esi+58h], offset loc_1001D810
		mov	dword ptr [esi+4Ch], offset loc_1000DDD0
		mov	dword ptr [esi+54h], offset loc_1001D7D0
		mov	dword ptr [esi+5Ch], offset loc_1001D810

loc_10013842:				; CODE XREF: sub_10012FD0+519j
		mov	dword ptr [esi+64h], 40h

loc_10013849:				; CODE XREF: sub_10012FD0+406j
					; sub_10012FD0+421j ...
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_10013880

loc_10013850:				; CODE XREF: sub_10012FD0+3B8j
					; sub_10012FD0+3E0j
		mov	eax, [esp+1Ch+var_8]
		test	eax, eax
		jz	short loc_10013861
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10013861:				; CODE XREF: sub_10012FD0+1EFj
					; sub_10012FD0+216j ...
		push	esi
		call	sub_100176D0
		mov	ecx, [esp+20h+var_4]
		push	ecx
		call	sub_100177F0
		mov	eax, [esp+24h+var_C]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013880:				; CODE XREF: sub_10012FD0+87Ej
		mov	eax, [esp+1Ch+var_4]
		push	eax
		mov	[eax+3Ch], esi
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax

loc_10013892:				; CODE XREF: sub_10012FD0+38j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10012FD0	endp

; ---------------------------------------------------------------------------
		align 4
off_1001389C	dd offset loc_1001336C,	offset loc_10013375, offset loc_100131F6
					; DATA XREF: sub_10012FD0+1D6r
		dd offset loc_100131AD,	offset loc_10013232, offset loc_100133F6 ; jump	table for switch statement
		dd offset loc_100134AD,	offset loc_10013495, offset loc_100132B2
		dd offset loc_100132F2,	offset loc_1001332F, offset loc_10013272
		dd offset loc_100137C5
byte_100138D0	db	0,   0Ch,     1,     2 ; DATA XREF: sub_10012FD0+1CFr
		db	3,     4,   0Ch,   0Ch ; indirect table	for switch statement
		db    0Ch,   0Ch,   0Ch,   0Ch
		db	5,   0Ch,   0Ch,   0Ch
		db	6,     7,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,     8
		db	9,   0Ah,   0Ch,   0Ch
		db    0Ch,   0Bh
		align 4
off_10013918	dd offset loc_1001351F,	offset loc_1001355B, offset loc_1001353D
					; DATA XREF: sub_10012FD0+548r
		dd offset loc_10013673,	offset loc_10013655, offset loc_100135CB ; jump	table for switch statement
		dd offset loc_100135AD,	offset loc_10013593, offset loc_10013575
		dd offset loc_10013603,	offset loc_100135E5, offset loc_1001363B
		dd offset loc_1001361D,	offset loc_100137C5
byte_10013950	db	0,   0Dh,   0Dh,   0Dh ; DATA XREF: sub_10012FD0+541r
		db    0Dh,   0Dh,   0Dh,   0Dh ; indirect table	for switch statement
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     1
		db	2,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     3
		db	4,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     5
		db	6,   0Dh,   0Dh,   0Dh
		db	7,     8,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     9
		db    0Ah,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Bh
		db    0Ch
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100139D0	proc near		; CODE XREF: sub_100043A0+31p
					; DATA XREF: .rdata:1002606Ao

arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [ecx]
		dec	eax
		jz	short loc_100139E4
		sub	eax, 2
		jz	short loc_100139E4
		mov	eax, 70h
		retn
; ---------------------------------------------------------------------------

loc_100139E4:				; CODE XREF: sub_100139D0+7j
					; sub_100139D0+Cj
		mov	[esp+arg_4], ecx
		jmp	sub_10012FD0
sub_100139D0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100139F0:				; DATA XREF: sub_10013A30+1E6o
					; sub_10013A30+22Eo ...
		mov	ecx, [esp+4]
		mov	eax, [ecx+8]
		cmp	dword ptr [eax+4], 1
		jz	short loc_10013A0E
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10013A0E:				; CODE XREF: .text:100139FBj
		mov	edx, [esp+14h]
		push	edx
		mov	edx, [esp+14h]
		push	edx
		mov	edx, [esp+14h]
		push	edx
		mov	edx, [esp+14h]
		push	edx
		push	eax
		mov	eax, [ecx]
		push	eax
		call	sub_1000EE00
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10013A30	proc near		; CODE XREF: sub_10004430+31p
					; sub_10014BA0+38Ap
					; DATA XREF: ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		push	edi
		mov	edi, [esp+1Ch+arg_8]
		push	5
		push	10Ah
		xor	ebp, ebp
		push	edi
		mov	ecx, ebx
		mov	edx, esi
		mov	[esp+28h+var_C], ebp
		call	sub_1000E2A0
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		cmp	eax, 54h
		jnz	loc_100141B3
		push	esi
		call	sub_100164F0
		add	esp, 4
		mov	[esp+1Ch+var_4], eax
		test	eax, eax
		jnz	short loc_10013A88
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013A88:				; CODE XREF: sub_10013A30+49j
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_10013AA1
		mov	edi, [esp+1Ch+var_4]
		mov	esi, [esp+1Ch+var_8]
		mov	eax, 90h
		jmp	loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013AA1:				; CODE XREF: sub_10013A30+5Dj
		mov	ecx, [esp+1Ch+var_4]
		push	ecx
		push	edi
		call	sub_10017DA0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10013AC5
		mov	edi, [esp+1Ch+var_4]
		lea	eax, [esi+60h]
		mov	esi, [esp+1Ch+var_8]
		jmp	loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013AC5:				; CODE XREF: sub_10013A30+83j
		mov	eax, [esi+8]
		cmp	eax, 4
		jz	short loc_10013AD2
		cmp	eax, 2
		jnz	short loc_10013AE4

loc_10013AD2:				; CODE XREF: sub_10013A30+9Bj
		push	10Ah
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10013AFF

loc_10013AE4:				; CODE XREF: sub_10013A30+A0j
		push	esi
		call	sub_10016D30
		mov	edi, [esp+20h+var_4]
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 63h
		jmp	loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013AFF:				; CODE XREF: sub_10013A30+B2j
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_10013B2C
		push	esi
		call	sub_10016D30
		mov	edi, [esp+20h+var_4]
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 63h
		jmp	loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013B2C:				; CODE XREF: sub_10013A30+DFj
		cmp	dword ptr [eax+1Ch], 4
		push	eax
		jz	short loc_10013B50
		call	sub_10015D70
		push	esi
		call	sub_10016D30
		mov	edi, [esp+24h+var_4]
		mov	esi, [esp+24h+var_8]
		add	esp, 8
		mov	eax, 13h
		jmp	short loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013B50:				; CODE XREF: sub_10013A30+101j
		mov	edx, [eax+18h]
		mov	ecx, [edx]
		mov	[esp+20h+var_8], ecx
		call	sub_10015D70
		push	6Ch
		mov	edi, esi
		call	PORT_Alloc_Util
		add	esp, 8
		test	eax, eax
		jnz	short loc_10013B82
		push	esi
		call	sub_10016D30
		mov	esi, [esp+20h+var_8]
		add	esp, 4
		mov	eax, 2
		jmp	short loc_10013BAD
; ---------------------------------------------------------------------------

loc_10013B82:				; CODE XREF: sub_10013A30+13Cj
		xor	ecx, ecx
		mov	[eax+68h], esi
		mov	dword ptr [eax], 5
		mov	dword ptr [eax+4], 1
		mov	[eax+8], ecx
		mov	[eax+3Ch], ecx
		mov	[eax+40h], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+14h], ecx
		mov	[eax+10h], ecx
		mov	[eax+64h], ecx
		mov	esi, eax
		xor	eax, eax

loc_10013BAD:				; CODE XREF: sub_10013A30+6Cj
					; sub_10013A30+90j ...
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jz	short loc_10013BCE
		mov	edx, [esp+1Ch+var_4]
		push	edx
		call	sub_100177F0
		mov	eax, [esp+20h+var_C]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013BCE:				; CODE XREF: sub_10013A30+183j
		mov	[esi+4], ebp
		mov	eax, [ebx]
		cmp	eax, 201h
		ja	loc_10013EF3
		jz	loc_10013EEF
		dec	eax
		cmp	eax, 45h	; switch 70 cases
		ja	loc_100140EB	; jumptable 10013BF5 default case
		movzx	eax, ds:byte_100141F0[eax]
		jmp	ds:off_100141BC[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10013BFC:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 4
		call	sub_1000DC50
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_10013C38

loc_10013C2B:				; CODE XREF: sub_10013A30+241j
					; sub_10013A30+27Cj ...
		mov	[esp+1Ch+var_C], 2
		jmp	loc_10014182
; ---------------------------------------------------------------------------

loc_10013C38:				; CODE XREF: sub_10013A30+1F9j
		mov	dword ptr [ebp+0], 3
		jmp	loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013C44:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 3
		call	sub_1000DC10
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_10013C2B
		mov	dword ptr [ebp+0], 1
		jmp	loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013C7F:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 5
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	dword ptr [ebp+0], 4
		jmp	loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013CBE:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 69
		call	sub_1000DCD0
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	dword ptr [ebp+0], 135h
		jmp	loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013CFD:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 63
		call	sub_1000DD10
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	dword ptr [ebp+0], 0BFh
		jmp	loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013D3C:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 64
		call	sub_1000DD50
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	dword ptr [ebp+0], 0C0h
		jmp	short loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013D78:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 65
		call	sub_1000DD90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182
		push	0Ch
		mov	dword ptr [esi+60h], offset loc_100139F0
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	dword ptr [ebp+0], 0C1h
		jmp	short loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013DB4:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+60h], offset loc_1000EEC0 ; jumptable 10013BF5 case 0
		jmp	short loc_10013DC4
; ---------------------------------------------------------------------------

loc_10013DBD:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+60h], offset loc_1000EEF0 ; jumptable 10013BF5 case 2

loc_10013DC4:				; CODE XREF: sub_10013A30+20Fj
					; sub_10013A30+24Aj ...
		cmp	[esp+1Ch+var_8], 0
		jz	short loc_10013DE5

loc_10013DCB:				; CODE XREF: sub_10013A30+3CEj
		test	ebp, ebp
		jz	short loc_10013DD8
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_10013DD8:				; CODE XREF: sub_10013A30+39Dj
		mov	[esp+1Ch+var_C], 63h
		jmp	loc_10014175
; ---------------------------------------------------------------------------

loc_10013DE5:				; CODE XREF: sub_10013A30+399j
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		push	0
		push	edi
		mov	dword ptr [esi+8], 1
		call	sub_100072C0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10013DCB
		test	ebp, ebp
		jz	loc_10014164
		mov	[ebp+8], eax
		mov	[esi+3Ch], ebp
		mov	dword ptr [esi+58h], offset loc_1001D810
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013E1A:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		cmp	[esp+1Ch+var_8], ebp ; jumptable 10013BF5 case 12
		jz	short loc_10013E2D

loc_10013E20:				; CODE XREF: sub_10013A30+495j
					; sub_10013A30+70Fj
		mov	[esp+1Ch+var_C], 63h
		jmp	loc_10014182
; ---------------------------------------------------------------------------

loc_10013E2D:				; CODE XREF: sub_10013A30+3EEj
		mov	dword ptr [esi+8], 1
		cmp	dword ptr [ebx+8], 0Ch
		jnz	short loc_10013E9B
		mov	ecx, [ebx+4]
		call	sub_1000BFA0
		test	eax, eax
		jz	short loc_10013E9B
		push	0Ch
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10013C2B
		mov	edx, [ebx+4]
		lea	eax, [esp+1Ch+var_C]
		push	eax
		push	0
		push	edi
		mov	[ebp+4], edx
		call	sub_100072C0
		add	esp, 0Ch
		mov	[ebp+8], eax
		test	eax, eax
		jnz	short loc_10013E85
		push	ebp
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013E85:				; CODE XREF: sub_10013A30+445j
		mov	[esi+3Ch], ebp
		mov	dword ptr [esi+58h], offset loc_1001D810
		mov	dword ptr [esi+60h], offset loc_1000EF20
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013E9B:				; CODE XREF: sub_10013A30+408j
					; sub_10013A30+414j
		mov	[esp+1Ch+var_C], 71h
		jmp	loc_10014182
; ---------------------------------------------------------------------------

loc_10013EA8:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		mov	dword ptr [esi+4], 1 ; jumptable 10013BF5 case 17
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	loc_10014182

loc_10013EC0:				; CODE XREF: sub_10013A30+1C5j
					; DATA XREF: .text:off_100141BCo
		cmp	[esp+1Ch+var_8], 1 ; jumptable 10013BF5	case 16
		jnz	loc_10013E20
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		push	1
		push	edi
		call	sub_100072C0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_1001416E
		mov	dword ptr [esi+60h], offset sub_1000E810
		jmp	loc_10014164
; ---------------------------------------------------------------------------

loc_10013EEF:				; CODE XREF: sub_10013A30+1AEj
		push	10h
		jmp	short loc_10013F26
; ---------------------------------------------------------------------------

loc_10013EF3:				; CODE XREF: sub_10013A30+1A8j
		cmp	eax, 380h
		ja	loc_100140A8
		jz	loc_1001408E
		sub	eax, 202h	; switch 113 cases
		cmp	eax, 70h
		ja	loc_100140EB	; jumptable 10013BF5 default case
		movzx	edx, ds:byte_10014270[eax]
		jmp	ds:off_10014238[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10013F20:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	eax, [ebx+4]	; jumptable 10013F19 case 514
		mov	ecx, [eax]
		push	ecx

loc_10013F26:				; CODE XREF: sub_10013A30+4C1j
		mov	eax, 1
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013F3E:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	edx, [ebx+4]	; jumptable 10013F19 case 530
		mov	eax, [edx]
		push	eax
		mov	eax, 2
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013F5C:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	10h		; jumptable 10013F19 case 529
		mov	eax, 2
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013F76:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	ecx, [ebx+4]	; jumptable 10013F19 case 599
		mov	edx, [ecx]
		push	edx
		mov	eax, 7
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013F94:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	1Ch		; jumptable 10013F19 case 598
		mov	eax, 7
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013FAE:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	eax, [ebx+4]	; jumptable 10013F19 case 594
		mov	ecx, [eax]
		push	ecx
		mov	eax, 4
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013FCC:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	20h		; jumptable 10013F19 case 593
		mov	eax, 4
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10013FE6:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	edx, [ebx+4]	; jumptable 10013F19 case 610
		mov	eax, [edx]
		push	eax
		mov	eax, 5
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10014004:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	30h		; jumptable 10013F19 case 609
		mov	eax, 5
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_1001401E:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	ecx, [ebx+4]	; jumptable 10013F19 case 626
		mov	edx, [ecx]
		push	edx
		mov	eax, 6
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_1001403C:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	40h		; jumptable 10013F19 case 625
		mov	eax, 6
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10014056:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		mov	eax, [ebx+4]	; jumptable 10013F19 case 546
		mov	ecx, [eax]
		push	ecx
		mov	eax, 3
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_10014074:				; CODE XREF: sub_10013A30+4E9j
					; DATA XREF: .text:off_10014238o
		push	14h		; jumptable 10013F19 case 545
		mov	eax, 3
		mov	ecx, edi
		call	sub_1000DE90
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_1001408E:				; CODE XREF: sub_10013A30+4CEj
		mov	edx, [ebx+4]
		mov	eax, [edx]
		push	eax
		push	edi
		push	3
		call	sub_1000E150
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_100140A8:				; CODE XREF: sub_10013A30+4C8j
		cmp	eax, 1041h
		ja	short loc_100140D6
		jz	loc_1001413A
		cmp	eax, 381h
		jnz	short loc_100140EB ; jumptable 10013BF5	default	case
		mov	ecx, [ebx+4]
		mov	edx, [ecx]
		push	edx
		push	edi
		push	4
		call	sub_1000E150
		add	esp, 0Ch
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1001416E
; ---------------------------------------------------------------------------

loc_100140D6:				; CODE XREF: sub_10013A30+67Dj
		cmp	eax, 1042h
		jz	short loc_10014126
		cmp	eax, 80000373h
		jz	short loc_1001410F
		cmp	eax, 0CE534365h
		jz	short loc_100140F8

loc_100140EB:				; CODE XREF: sub_10013A30+1B8j
					; sub_10013A30+1C5j ...
		mov	[esp+1Ch+var_C], 70h ; jumptable 10013BF5 default case
		jmp	loc_10014182
; ---------------------------------------------------------------------------

loc_100140F8:				; CODE XREF: sub_10013A30+6B9j
		mov	eax, [esp+1Ch+var_8]
		push	4
		push	eax
		push	edi
		push	esi
		call	sub_1001FCD0
		add	esp, 10h
		mov	[esp+1Ch+var_C], eax
		jmp	short loc_1001416E
; ---------------------------------------------------------------------------

loc_1001410F:				; CODE XREF: sub_10013A30+6B2j
		mov	ecx, [esp+1Ch+var_8]
		push	0
		push	ecx
		push	edi
		push	esi
		call	sub_1001FCD0
		add	esp, 10h
		mov	[esp+1Ch+var_C], eax
		jmp	short loc_1001416E
; ---------------------------------------------------------------------------

loc_10014126:				; CODE XREF: sub_10013A30+6ABj
		mov	dword ptr [esi+4], 1
		call	sub_1000DC90
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	short loc_10014182

loc_1001413A:				; CODE XREF: sub_10013A30+67Fj
		cmp	[esp+1Ch+var_8], 3
		jnz	loc_10013E20
		lea	edx, [esp+1Ch+var_C]
		push	edx
		push	3
		push	edi
		call	sub_100072C0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10013C2B
		mov	dword ptr [esi+60h], offset sub_1000E8E0

loc_10014164:				; CODE XREF: sub_10013A30+3D2j
					; sub_10013A30+4BAj
		mov	[esi+3Ch], eax
		mov	dword ptr [esi+58h], offset nullsub_1

loc_1001416E:				; CODE XREF: sub_10013A30+3E5j
					; sub_10013A30+450j ...
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_100141A1

loc_10014175:				; CODE XREF: sub_10013A30+3B0j
		test	ebp, ebp
		jz	short loc_10014182
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_10014182:				; CODE XREF: sub_10013A30+1DEj
					; sub_10013A30+203j ...
		push	esi
		call	sub_100176D0
		mov	eax, [esp+20h+var_4]
		push	eax
		call	sub_100177F0
		mov	eax, [esp+24h+var_C]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100141A1:				; CODE XREF: sub_10013A30+743j
		mov	eax, [esp+1Ch+var_4]
		push	eax
		mov	[eax+3Ch], esi
		call	sub_100177F0
		add	esp, 4
		xor	eax, eax

loc_100141B3:				; CODE XREF: sub_10013A30+34j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10013A30	endp

; ---------------------------------------------------------------------------
		align 4
off_100141BC	dd offset loc_10013DB4,	offset loc_10013DBD, offset loc_10013C44
					; DATA XREF: sub_10013A30+1C5r
		dd offset loc_10013BFC,	offset loc_10013C7F, offset loc_10013E1A ; jump	table for switch statement
		dd offset loc_10013EC0,	offset loc_10013EA8, offset loc_10013CFD
		dd offset loc_10013D3C,	offset loc_10013D78, offset loc_10013CBE
		dd offset loc_100140EB
byte_100141F0	db	0,   0Ch,     1,     2 ; DATA XREF: sub_10013A30+1BEr
		db	3,     4,   0Ch,   0Ch ; indirect table	for switch statement
		db    0Ch,   0Ch,   0Ch,   0Ch
		db	5,   0Ch,   0Ch,   0Ch
		db	6,     7,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,   0Ch
		db    0Ch,   0Ch,   0Ch,     8
		db	9,   0Ah,   0Ch,   0Ch
		db    0Ch,   0Bh
		align 4
off_10014238	dd offset loc_10013F20,	offset loc_10013F5C, offset loc_10013F3E
					; DATA XREF: sub_10013A30+4E9r
		dd offset loc_10014074,	offset loc_10014056, offset loc_10013FCC ; jump	table for switch statement
		dd offset loc_10013FAE,	offset loc_10013F94, offset loc_10013F76
		dd offset loc_10014004,	offset loc_10013FE6, offset loc_1001403C
		dd offset loc_1001401E,	offset loc_100140EB
byte_10014270	db	0,   0Dh,   0Dh,   0Dh ; DATA XREF: sub_10013A30+4E2r
		db    0Dh,   0Dh,   0Dh,   0Dh ; indirect table	for switch statement
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     1
		db	2,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     3
		db	4,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     5
		db	6,   0Dh,   0Dh,   0Dh
		db	7,     8,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,     9
		db    0Ah,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Dh
		db    0Dh,   0Dh,   0Dh,   0Bh
		db    0Ch
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100142F0(int,	void *Src, size_t Size,	int, int)
sub_100142F0	proc near		; CODE XREF: sub_10004490:loc_100044AEj
					; sub_10014BA0+3A9p
					; DATA XREF: ...

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	ebp
		call	sub_100164F0
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1001430F
		pop	esi
		pop	ebp
		mov	eax, 0B3h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001430F:				; CODE XREF: sub_100142F0+14j
		mov	esi, [ebx+3Ch]
		test	esi, esi
		jz	short loc_10014361
		cmp	dword ptr [esi], 5
		jnz	short loc_10014361
		push	edi
		xor	edi, edi
		cmp	[esi+4], edi
		jz	short loc_10014373
		mov	eax, [esp+10h+Size]
		mov	ecx, [esp+10h+Src]
		push	eax		; Size
		push	ecx		; Src
		push	ebp		; int
		call	sub_1000EF80
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_100143B3
		mov	edx, [esp+10h+arg_10]
		mov	eax, [esp+10h+arg_C]
		push	edx
		push	eax
		push	ebp
		call	sub_1000F0E0
		add	esp, 0Ch
		push	ebx
		mov	edi, eax
		call	sub_100177F0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10014361:				; CODE XREF: sub_100142F0+24j
					; sub_100142F0+29j
		push	ebx
		call	sub_100177F0
		add	esp, 4
		pop	esi
		pop	ebp
		mov	eax, 91h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10014373:				; CODE XREF: sub_100142F0+31j
		mov	ecx, [esp+10h+Size]
		mov	edx, [esp+10h+Src]
		mov	eax, [esp+10h+arg_10]
		push	ecx
		mov	ecx, [esp+14h+arg_C]
		push	edx
		mov	edx, [esi+3Ch]
		push	eax
		mov	eax, [esi+60h]
		push	ecx
		push	edx
		call	eax
		add	esp, 14h
		test	eax, eax
		jz	short loc_100143A3
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax

loc_100143A3:				; CODE XREF: sub_100142F0+A5j
		push	esi
		call	sub_100176D0
		add	esp, 4
		mov	dword ptr [ebx+3Ch], 0

loc_100143B3:				; CODE XREF: sub_100142F0+4Aj
		push	ebx
		call	sub_100177F0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_100142F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100143D0	proc near		; CODE XREF: sub_100145A0+284p

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 10h
		push	ebp
		mov	ebp, [esp+14h+arg_4]
		push	esi
		push	edi
		mov	edi, eax
		mov	eax, [esp+1Ch+arg_0]
		xor	esi, esi
		mov	[eax], esi
		mov	ecx, [edi]
		push	ecx
		mov	[esp+20h+var_10], esi
		call	SECOID_FindOIDByMechanism
		add	esp, 4
		test	eax, eax
		jnz	short loc_10014403

loc_100143F7:				; CODE XREF: sub_100143D0+8Cj
		pop	edi
		pop	esi
		mov	eax, 70h
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10014403:				; CODE XREF: sub_100143D0+25j
		cmp	dword ptr [edi], 3B0h
		jnz	short loc_10014432
		mov	esi, [edi+4]
		cmp	dword ptr [esi], 1
		jz	short loc_1001441F
		pop	edi
		pop	esi
		mov	eax, 71h
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001441F:				; CODE XREF: sub_100143D0+41j
		mov	edx, [esi+4]
		mov	[esp+1Ch+var_8], edx
		mov	ecx, [esi+8]
		mov	[esp+1Ch+var_4], ecx
		mov	edi, [esi+0Ch]
		jmp	short loc_10014446
; ---------------------------------------------------------------------------

loc_10014432:				; CODE XREF: sub_100143D0+39j
		mov	edi, [edi+4]
		mov	edx, [edi+0Ch]
		mov	[esp+1Ch+var_8], edx
		mov	ecx, [edi+10h]
		mov	[esp+1Ch+var_4], ecx
		mov	edi, [edi+14h]

loc_10014446:				; CODE XREF: sub_100143D0+60j
		mov	eax, [eax+0Ch]
		push	edi
		lea	edx, [esp+20h+var_C]
		push	edx
		push	eax
		call	sub_10005FA0
		mov	ecx, eax
		add	esp, 0Ch
		test	ecx, ecx
		jz	short loc_100143F7
		mov	eax, [ecx+5Ch]
		cmp	eax, 123h
		jg	loc_10014561	; jumptable 1001447E default case
		jz	loc_100144FF
		sub	eax, 5		; switch 6 cases
		cmp	eax, 5
		ja	loc_10014561	; jumptable 1001447E default case
		jmp	ds:off_10014580[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10014485:				; CODE XREF: sub_100143D0+AEj
					; DATA XREF: .text:off_10014580o
		mov	eax, [esp+1Ch+var_10] ;	jumptable 1001447E case	10
		mov	dword ptr [ebp+0], 13h
		mov	edx, [ecx+2Ch]
		pop	edi
		mov	[ebx], edx
		mov	edx, [esp+18h+arg_0]
		pop	esi
		mov	[edx], ecx
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100144A2:				; CODE XREF: sub_100143D0+AEj
					; DATA XREF: .text:off_10014580o
		mov	eax, [ecx+60h]	; jumptable 1001447E case 7
		neg	eax
		sbb	eax, eax
		add	eax, 15h
		mov	[ebp+0], eax
		mov	edx, [ecx+2Ch]
		mov	eax, [esp+1Ch+var_10]
		pop	edi
		mov	[ebx], edx
		mov	edx, [esp+18h+arg_0]
		pop	esi
		mov	[edx], ecx
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100144C5:				; CODE XREF: sub_100143D0+AEj
					; DATA XREF: .text:off_10014580o
		mov	edx, [esp+1Ch+arg_0] ; jumptable 1001447E case 5
		mov	dword ptr [ebp+0], 11h
		mov	eax, [ecx+2Ch]
		pop	edi
		mov	[ebx], eax
		mov	eax, [esp+18h+var_10]
		pop	esi
		mov	[edx], ecx
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100144E2:				; CODE XREF: sub_100143D0+AEj
					; DATA XREF: .text:off_10014580o
		mov	eax, [esp+1Ch+var_10] ;	jumptable 1001447E case	6
		mov	dword ptr [ebp+0], 12h
		mov	edx, [ecx+2Ch]
		pop	edi
		mov	[ebx], edx
		mov	edx, [esp+18h+arg_0]
		pop	esi
		mov	[edx], ecx
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100144FF:				; CODE XREF: sub_100143D0+9Cj
		test	esi, esi
		jz	short loc_1001454E
		cmp	dword ptr [esi+10h], 1
		jnz	short loc_1001454E
		mov	eax, [ebp+0]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10014524

loc_10014511:				; CODE XREF: sub_100143D0+166j
		pop	edi
		mov	[esp+18h+var_10], 0D0h
		mov	eax, [esp+18h+var_10]
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10014524:				; CODE XREF: sub_100143D0+13Fj
		cmp	dword ptr [ebx], 0
		jnz	short loc_10014538
		push	eax
		call	sub_10010BE0
		add	esp, 4
		mov	[ebx], eax
		test	eax, eax
		jz	short loc_10014511

loc_10014538:				; CODE XREF: sub_100143D0+157j
		mov	eax, [ebx]
		mov	edx, [esp+1Ch+arg_0]
		pop	edi
		mov	[ecx+2Ch], eax
		mov	eax, [esp+18h+var_10]
		pop	esi
		mov	[edx], ecx
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001454E:				; CODE XREF: sub_100143D0+131j
					; sub_100143D0+137j
		pop	edi
		mov	[esp+18h+var_10], 71h
		mov	eax, [esp+18h+var_10]
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10014561:				; CODE XREF: sub_100143D0+96j
					; sub_100143D0+A8j ...
		push	ecx		; jumptable 1001447E default case
		mov	[esp+20h+var_10], 70h
		call	sub_10006070
		mov	eax, [esp+20h+var_10]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
sub_100143D0	endp

; ---------------------------------------------------------------------------
		align 10h
off_10014580	dd offset loc_100144C5	; DATA XREF: sub_100143D0+AEr
		dd offset loc_100144E2	; jump table for switch	statement
		dd offset loc_100144A2
		dd offset loc_10014561
		dd offset loc_10014561
		dd offset loc_10014485
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100145A0	proc near		; CODE XREF: sub_100045B0+54p
					; DATA XREF: .rdata:1002609Ao

Src		= byte ptr -129h
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
Dst		= byte ptr -104h
var_103		= byte ptr -103h
var_102		= byte ptr -102h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 12Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+12Ch+var_4], eax
		mov	eax, [esp+12Ch+arg_0]
		mov	ecx, [esp+12Ch+arg_4]
		mov	edx, [esp+12Ch+arg_10]
		push	ebx
		push	edi
		mov	edi, [esp+134h+arg_8]
		xor	ebx, ebx
		push	eax
		mov	[esp+138h+var_10C], eax
		mov	[esp+138h+var_11C], ecx
		mov	[esp+138h+var_108], edx
		mov	[esp+138h+var_110], ebx
		mov	[esp+138h+var_124], ebx
		mov	[esp+138h+var_128], 0FFFFFFFFh
		mov	[esp+138h+var_118], 4
		mov	[esp+138h+Src],	1
		call	sub_10007E90
		add	esp, 4
		mov	[esp+134h+var_114], ebx
		cmp	eax, ebx
		jnz	short loc_1001462A
		pop	edi
		mov	eax, 0B3h
		pop	ebx
		mov	ecx, [esp+12Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 12Ch
		retn
; ---------------------------------------------------------------------------

loc_1001462A:				; CODE XREF: sub_100145A0+6Cj
		push	esi
		push	eax
		call	sub_100161F0
		mov	esi, eax
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_10014657
		pop	esi
		pop	edi
		mov	eax, 2
		pop	ebx
		mov	ecx, [esp+12Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 12Ch
		retn
; ---------------------------------------------------------------------------

loc_10014657:				; CODE XREF: sub_100145A0+98j
		push	ebp
		xor	ebp, ebp
		cmp	[esp+13Ch+arg_C], ebx
		jle	short loc_100146B9
		add	edi, 4

loc_10014666:				; CODE XREF: sub_100145A0+10Fj
		mov	eax, [edi-4]
		cmp	eax, 161h
		jnz	short loc_1001467A
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	[esp+13Ch+var_124], ecx
		jmp	short loc_100146A4
; ---------------------------------------------------------------------------

loc_1001467A:				; CODE XREF: sub_100145A0+CEj
		mov	edx, [edi]
		cmp	eax, 100h
		jnz	short loc_1001468B
		mov	eax, [edx]
		mov	[esp+13Ch+var_128], eax
		jmp	short loc_100146A4
; ---------------------------------------------------------------------------

loc_1001468B:				; CODE XREF: sub_100145A0+E1j
		mov	ecx, [edi+4]
		push	ecx
		push	edx
		push	eax
		push	esi
		call	sub_10016BB0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	loc_10014A92

loc_100146A4:				; CODE XREF: sub_100145A0+D8j
					; sub_100145A0+E9j
		inc	ebp
		add	edi, 0Ch
		cmp	ebp, [esp+13Ch+arg_C]
		jl	short loc_10014666
		test	ebx, ebx
		jnz	loc_10014A92

loc_100146B9:				; CODE XREF: sub_100145A0+C1j
		push	0
		push	esi
		call	sub_10016B50
		push	100h
		push	esi
		call	sub_10016B50
		push	11h
		push	esi
		call	sub_10016B50
		mov	edx, [esp+154h+var_11C]
		mov	eax, [edx]
		mov	ecx, eax
		add	esp, 18h
		mov	ebp, 2
		cmp	ecx, 550h
		ja	loc_10014773
		jz	loc_10014791	; jumptable 1001471A cases 256,272
		cmp	ecx, 350h
		ja	short loc_1001473D
		jz	loc_10014791	; jumptable 1001471A cases 256,272
		sub	ecx, 100h	; switch 65 cases
		cmp	ecx, 40h
		ja	loc_1001484E	; jumptable 1001471A default case
		movzx	ecx, ds:byte_10014AC4[ecx]
		jmp	ds:off_10014AB8[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10014721:				; CODE XREF: sub_100145A0+17Aj
					; DATA XREF: .text:off_10014AB8o
		lea	ecx, [esp+13Ch+var_124]	; jumptable 1001471A cases 288,304,305,320
		lea	edx, [esp+13Ch+var_128]
		mov	[esp+13Ch+var_110], 1
		call	sub_1000F940
		mov	edi, eax
		jmp	loc_100148AC
; ---------------------------------------------------------------------------

loc_1001473D:				; CODE XREF: sub_100145A0+15Cj
		sub	ecx, 370h	; switch 81 cases
		cmp	ecx, 50h
		ja	loc_1001484E	; jumptable 1001471A default case
		movzx	eax, ds:byte_10014B18[ecx]
		jmp	ds:off_10014B08[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001475A:				; CODE XREF: sub_100145A0+1B3j
					; DATA XREF: .text:off_10014B08o
		mov	ebx, 30h	; jumptable 10014753 case 880
		mov	[esp+13Ch+var_128], 10h
		mov	[esp+13Ch+var_124], ebx
		lea	ebp, [ebx-2Fh]
		jmp	loc_100148E6
; ---------------------------------------------------------------------------

loc_10014773:				; CODE XREF: sub_100145A0+14Aj
		cmp	ecx, 2000h
		ja	short loc_100147C1
		jz	short loc_100147A5
		cmp	ecx, 650h
		jz	short loc_10014791 ; jumptable 1001471A	cases 256,272
		cmp	ecx, 1080h
		jnz	loc_1001484E	; jumptable 1001471A default case

loc_10014791:				; CODE XREF: sub_100145A0+150j
					; sub_100145A0+15Ej ...
		lea	ecx, [esp+13Ch+var_124]	; jumptable 1001471A cases 256,272
		lea	edx, [esp+13Ch+var_128]
		call	sub_1000F940
		mov	edi, eax
		jmp	loc_100148AC
; ---------------------------------------------------------------------------

loc_100147A5:				; CODE XREF: sub_100145A0+1DBj
		mov	ebp, 3
		mov	[esp+13Ch+var_128], 1
		mov	[esp+13Ch+var_118], 6
		xor	edi, edi
		jmp	loc_100148AC
; ---------------------------------------------------------------------------

loc_100147C1:				; CODE XREF: sub_100145A0+1D9j
		mov	eax, 3
		cmp	ecx, 0CE534357h
		ja	short loc_10014836
		jz	short loc_10014830
		add	ecx, 7FFFFFFEh	; switch 10 cases
		cmp	ecx, 9
		ja	short loc_1001484E ; jumptable 1001471A	default	case
		movzx	ecx, ds:byte_10014B78[ecx]
		jmp	ds:off_10014B6C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100147E9:				; CODE XREF: sub_100145A0+1B3j
					; sub_100145A0+242j
					; DATA XREF: ...
		lea	eax, [esp+13Ch+var_120]	; jumptable 10014753 case 960
					; jumptable 100147E2 cases -2147483639--2147483637
		push	eax
		push	edx
		xor	ebp, ebp
		mov	[esp+144h+var_128], 10h
		call	sub_1000FA60
		add	esp, 8
		mov	edi, eax
		jmp	loc_100148AC
; ---------------------------------------------------------------------------

loc_10014808:				; CODE XREF: sub_100145A0+242j
					; DATA XREF: .text:off_10014B6Co
		mov	[esp+13Ch+var_114], 1 ;	jumptable 100147E2 case	-2147483640

loc_10014810:				; CODE XREF: sub_100145A0+1B3j
					; sub_100145A0+242j
					; DATA XREF: ...
		mov	eax, [esp+13Ch+var_11C]	; jumptable 10014753 cases 928,929,934-939,944
					; jumptable 100147E2 cases -2147483646--2147483641
		lea	ecx, [esp+13Ch+var_128]
		push	ecx
		lea	edx, [esp+140h+var_120]
		push	edx
		lea	ebx, [esp+144h+var_124]
		xor	ebp, ebp
		call	sub_100143D0
		add	esp, 8
		mov	edi, eax
		jmp	short loc_100148AC
; ---------------------------------------------------------------------------

loc_10014830:				; CODE XREF: sub_100145A0+22Ej
		mov	[esp+13Ch+var_120], eax
		jmp	short loc_10014871
; ---------------------------------------------------------------------------

loc_10014836:				; CODE XREF: sub_100145A0+22Cj
		cmp	ecx, 0CE534358h
		jz	short loc_10014869
		cmp	ecx, 0CE534359h
		jz	short loc_1001485F
		cmp	ecx, 0CE53435Ah
		jz	short loc_10014855

loc_1001484E:				; CODE XREF: sub_100145A0+16Dj
					; sub_100145A0+17Aj ...
		mov	edi, 70h	; jumptable 1001471A default case
		jmp	short loc_100148AC
; ---------------------------------------------------------------------------

loc_10014855:				; CODE XREF: sub_100145A0+2ACj
		mov	[esp+13Ch+var_120], 6
		jmp	short loc_10014871
; ---------------------------------------------------------------------------

loc_1001485F:				; CODE XREF: sub_100145A0+2A4j
		mov	[esp+13Ch+var_120], 5
		jmp	short loc_10014871
; ---------------------------------------------------------------------------

loc_10014869:				; CODE XREF: sub_100145A0+29Cj
		mov	[esp+13Ch+var_120], 4

loc_10014871:				; CODE XREF: sub_100145A0+294j
					; sub_100145A0+2BDj ...
		cmp	dword ptr [edx+4], 0
		mov	ebp, 4
		mov	[esp+13Ch+var_128], 0CE534352h
		mov	[esp+13Ch+var_118], eax
		jz	short loc_100148A7
		cmp	dword ptr [edx+8], 30h
		jnz	short loc_100148A7
		push	1
		push	esi
		call	sub_100169F0
		add	esp, 8
		mov	edi, eax
		neg	edi
		sbb	edi, edi
		and	edi, 0D1h
		jmp	short loc_100148AC
; ---------------------------------------------------------------------------

loc_100148A7:				; CODE XREF: sub_100145A0+2E6j
					; sub_100145A0+2ECj
		mov	edi, 71h

loc_100148AC:				; CODE XREF: sub_100145A0+198j
					; sub_100145A0+200j ...
		cmp	[esp+13Ch+var_124], 100h
		jbe	short loc_100148C8
		push	esi
		mov	edi, 0D1h
		call	sub_10016D30
		mov	eax, edi
		jmp	loc_10014A9A
; ---------------------------------------------------------------------------

loc_100148C8:				; CODE XREF: sub_100145A0+314j
		test	edi, edi
		jz	short loc_100148D9

loc_100148CC:				; CODE XREF: sub_100145A0+3C1j
					; sub_100145A0+40Cj ...
		push	esi
		call	sub_10016D30
		mov	eax, edi
		jmp	loc_10014A9A
; ---------------------------------------------------------------------------

loc_100148D9:				; CODE XREF: sub_100145A0+32Aj
		mov	ebx, [esp+13Ch+var_124]
		cmp	ebp, 4		; switch 5 cases
		ja	loc_100149B2	; jumptable 100148E6 default case

loc_100148E6:				; CODE XREF: sub_100145A0+1CEj
		jmp	ds:off_10014B84[ebp*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100148ED:				; CODE XREF: sub_100145A0:loc_100148E6j
					; DATA XREF: .text:off_10014B84o
		mov	eax, [esp+13Ch+var_114]	; jumptable 100148E6 case 0
		mov	ebp, [esp+13Ch+var_120]
		push	eax		; int
		mov	eax, [esp+140h+var_11C]
		lea	ecx, [esp+140h+Dst]
		push	ecx		; Dst
		push	ebp		; int
		lea	ebx, [esp+148h+var_124]
		call	sub_1000F5C0
		push	ebp
		mov	edi, eax
		call	sub_10006070
		mov	ebx, [esp+14Ch+var_124]
		add	esp, 10h
		jmp	loc_100149AA
; ---------------------------------------------------------------------------

loc_1001491D:				; CODE XREF: sub_100145A0:loc_100148E6j
					; DATA XREF: .text:off_10014B84o
		mov	edx, [esp+13Ch+var_11C]	; jumptable 100148E6 case 1
		mov	eax, [edx+4]
		mov	cl, [eax]
		mov	[esp+13Ch+Dst],	cl
		mov	dl, [eax+1]
		push	2Eh
		lea	eax, [esp+140h+var_102]
		push	eax
		push	0
		mov	[esp+148h+var_103], dl
		call	sub_1000F590
		jmp	short loc_100149A5
; ---------------------------------------------------------------------------

loc_10014941:				; CODE XREF: sub_100145A0:loc_100148E6j
					; sub_100145A0+3E2j
					; DATA XREF: ...
		lea	ecx, [esp+13Ch+Dst] ; jumptable	100148E6 case 2
		push	ebx
		push	ecx
		call	sub_10021640
		add	esp, 8
		test	eax, eax
		jz	short loc_10014967
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		test	edi, edi
		jnz	loc_100148CC

loc_10014967:				; CODE XREF: sub_100145A0+3B1j
		cmp	[esp+13Ch+var_110], 0
		jz	short loc_100149B2 ; jumptable 100148E6	default	case
		mov	edx, [esp+13Ch+var_128]
		push	edx
		lea	eax, [esp+140h+Dst]
		push	eax
		call	sub_10007D70
		add	esp, 8
		test	eax, eax
		jnz	short loc_10014941 ; jumptable 100148E6	case 2
		jmp	short loc_100149B2 ; jumptable 100148E6	default	case
; ---------------------------------------------------------------------------

loc_10014986:				; CODE XREF: sub_100145A0:loc_100148E6j
					; DATA XREF: .text:off_10014B84o
		mov	[esp+13Ch+Dst],	0 ; jumptable 100148E6 case 3
		call	sub_1000F6D0
		jmp	short loc_100149A8
; ---------------------------------------------------------------------------

loc_10014992:				; CODE XREF: sub_100145A0:loc_100148E6j
					; DATA XREF: .text:off_10014B84o
		mov	ecx, [esp+13Ch+var_11C]	; jumptable 100148E6 case 4
		mov	edx, [ecx+4]
		mov	eax, [esp+13Ch+var_120]
		push	esi
		push	edx
		push	eax
		call	sub_1001FF90

loc_100149A5:				; CODE XREF: sub_100145A0+39Fj
		add	esp, 0Ch

loc_100149A8:				; CODE XREF: sub_100145A0+3F0j
		mov	edi, eax

loc_100149AA:				; CODE XREF: sub_100145A0+378j
		test	edi, edi
		jnz	loc_100148CC

loc_100149B2:				; CODE XREF: sub_100145A0+340j
					; sub_100145A0+3CCj ...
		push	4		; jumptable 100148E6 default case
		lea	ecx, [esp+140h+var_118]
		push	ecx
		push	0
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100148CC
		push	4
		lea	edx, [esp+140h+var_128]
		push	edx
		push	100h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100148CC
		test	ebx, ebx
		jz	short loc_10014A0C
		push	ebx
		lea	eax, [esp+140h+Dst]
		push	eax
		push	11h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100148CC

loc_10014A0C:				; CODE XREF: sub_100145A0+44Fj
		mov	ecx, [esp+13Ch+var_10C]
		push	ecx
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10014A2C
		push	esi
		call	sub_10016D30
		mov	eax, 0B3h
		jmp	short loc_10014A9A
; ---------------------------------------------------------------------------

loc_10014A2C:				; CODE XREF: sub_100145A0+47Dj
		push	edi
		push	esi
		call	sub_1000A8F0
		push	edi
		mov	ebx, eax
		call	sub_100177F0
		push	103h
		push	esi
		call	sub_100169F0
		add	esp, 14h
		test	eax, eax
		jz	short loc_10014A62
		push	1		; Size
		lea	edx, [esp+140h+Src]
		push	edx		; Src
		push	165h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10014A62:				; CODE XREF: sub_100145A0+4ABj
		push	162h
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10014A89
		push	1		; Size
		lea	eax, [esp+140h+Src]
		push	eax		; Src
		push	164h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10014A89:				; CODE XREF: sub_100145A0+4D2j
		mov	ecx, [esi+0Ch]
		mov	edx, [esp+13Ch+var_108]
		mov	[edx], ecx

loc_10014A92:				; CODE XREF: sub_100145A0+FEj
					; sub_100145A0+113j
		push	esi
		call	sub_10016D30
		mov	eax, ebx

loc_10014A9A:				; CODE XREF: sub_100145A0+323j
					; sub_100145A0+334j ...
		mov	ecx, [esp+140h+var_4]
		add	esp, 4
		pop	ebp
		pop	esi
		pop	edi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 12Ch
		retn
sub_100145A0	endp

; ---------------------------------------------------------------------------
		align 4
off_10014AB8	dd offset loc_10014791,	offset loc_10014721, offset loc_1001484E
					; DATA XREF: sub_100145A0+17Ar
					; jump table for switch	statement
byte_10014AC4	db	0,     2,     2,     2 ; DATA XREF: sub_100145A0+173r
		db	2,     2,     2,     2 ; indirect table	for switch statement
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	0,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	1,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	1,     1,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	1
		align 4
off_10014B08	dd offset loc_1001475A,	offset loc_10014810, offset loc_100147E9
					; DATA XREF: sub_100145A0+1B3r
		dd offset loc_1001484E	; jump table for switch	statement
byte_10014B18	db	0,     3,     3,     3 ; DATA XREF: sub_100145A0+1ACr
		db	3,     3,     3,     3 ; indirect table	for switch statement
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	1,     1,     3,     3
		db	3,     3,     1,     1
		db	1,     1,     1,     1
		db	3,     3,     3,     3
		db	1,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	2
		align 4
off_10014B6C	dd offset loc_10014810	; DATA XREF: sub_100145A0+242r
		dd offset loc_10014808	; jump table for switch	statement
		dd offset loc_100147E9
byte_10014B78	db	0,     0,     0,     0 ; DATA XREF: sub_100145A0+23Br
		db	0,     0,     1,     2 ; indirect table	for switch statement
		db	2,     2
		align 4
off_10014B84	dd offset loc_100148ED	; DATA XREF: sub_100145A0:loc_100148E6r
		dd offset loc_1001491D	; jump table for switch	statement
		dd offset loc_10014941
		dd offset loc_10014986
		dd offset loc_10014992
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014BA0	proc near		; CODE XREF: sub_10014FA0+D12p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		push	ebp
		mov	ebp, [esp+3Ch+arg_4]
		push	esi
		mov	esi, [esp+40h+arg_8]
		push	edi
		xor	edi, edi
		mov	[esp+44h+var_20], ebp
		mov	[esp+44h+var_2C], edi
		mov	[esp+44h+var_28], edi
		mov	[esp+44h+var_24], edi
		mov	[esp+44h+Size],	14h
		cmp	esi, edi
		jnz	short loc_10014C15
		push	120h
		push	ebp
		call	sub_10016660
		add	esp, 8
		cmp	eax, edi
		jnz	short loc_10014C00

loc_10014BE9:				; CODE XREF: sub_10014BA0+8Aj
					; sub_10014BA0+C5j ...
		pop	edi
		pop	esi
		mov	eax, 30h
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014C00:				; CODE XREF: sub_10014BA0+47j
		mov	edx, [eax+18h]
		cmp	byte ptr [edx],	0
		mov	ecx, [eax+1Ch]
		mov	[esp+44h+var_38], ecx
		jnz	short loc_10014C44
		dec	[esp+44h+var_38]
		jmp	short loc_10014C44
; ---------------------------------------------------------------------------

loc_10014C15:				; CODE XREF: sub_10014BA0+35j
		cmp	esi, 1
		jnz	short loc_10014C4D
		push	131h
		push	ebp
		call	sub_10016660
		add	esp, 8
		cmp	eax, edi
		jz	short loc_10014BE9
		mov	ecx, [eax+1Ch]
		mov	[esp+44h+var_1C], ecx
		cmp	ecx, esi
		jbe	short loc_10014C44
		mov	edx, [eax+18h]
		cmp	byte ptr [edx],	0
		jnz	short loc_10014C44
		dec	ecx
		mov	[esp+44h+var_1C], ecx

loc_10014C44:				; CODE XREF: sub_10014BA0+6Dj
					; sub_10014BA0+73j ...
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_10014C4D:				; CODE XREF: sub_10014BA0+78j
		push	105h
		push	ebp
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	loc_10014E05
		cmp	esi, edi
		jnz	short loc_10014BE9
		mov	eax, [esp+44h+var_38]
		push	eax
		mov	[esp+48h+var_34], eax
		mov	[esp+48h+var_2C], 1
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10014C9D

loc_10014C86:				; CODE XREF: sub_10014BA0+322j
		pop	edi
		pop	esi
		mov	eax, 2
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014C9D:				; CODE XREF: sub_10014BA0+E4j
		mov	eax, [esp+44h+arg_0]
		mov	eax, [eax+0Ch]
		push	1
		push	0
		push	104h
		push	104h
		push	eax
		lea	edx, [esp+58h+var_2C]
		mov	ecx, ebx
		call	sub_1000C4C0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_10014CE4

loc_10014CC7:				; CODE XREF: sub_10014BA0+15Ej
					; sub_10014BA0+1F0j
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_10014CD0:				; CODE XREF: sub_10014BA0+231j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014CE4:				; CODE XREF: sub_10014BA0+125j
		lea	ecx, [esp+44h+var_34]
		push	ecx		; int
		push	edi		; int
		push	14h		; Size
		push	offset aKnownCryptoMes ; "Known	Crypto Message"
		push	ebx		; int
		call	sub_1000D060
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10014CC7
		mov	ebp, [esp+44h+var_34]
		mov	ecx, ebp
		cmp	ebp, 14h
		jb	short loc_10014D10
		mov	ecx, 14h

loc_10014D10:				; CODE XREF: sub_10014BA0+169j
		mov	eax, edi
		sub	eax, ecx
		add	eax, ebp
		mov	esi, offset aKnownCryptoMes ; "Known Crypto Message"
		cmp	ecx, 4
		jb	short loc_10014D34

loc_10014D20:				; CODE XREF: sub_10014BA0+192j
		mov	edx, [eax]
		cmp	edx, [esi]
		jnz	short loc_10014D68
		sub	ecx, 4
		add	esi, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_10014D20

loc_10014D34:				; CODE XREF: sub_10014BA0+17Ej
		test	ecx, ecx
		jz	loc_10014E64
		mov	dl, [esi]
		cmp	dl, [eax]
		jnz	short loc_10014D68
		cmp	ecx, 1
		jbe	loc_10014E64
		mov	dl, [esi+1]
		cmp	dl, [eax+1]
		jnz	short loc_10014D68
		cmp	ecx, 2
		jbe	loc_10014E64
		mov	cl, [esi+2]
		cmp	cl, [eax+2]
		jz	loc_10014E64

loc_10014D68:				; CODE XREF: sub_10014BA0+184j
					; sub_10014BA0+1A0j ...
		mov	edx, [esp+44h+var_20]
		mov	eax, [edx+0Ch]
		push	0
		push	1
		push	105h
		push	105h
		push	eax
		lea	edx, [esp+58h+var_2C]
		mov	ecx, ebx
		call	sub_1000C4C0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10014CC7
		mov	[esp+44h+var_18], eax
		mov	[esp+44h+var_14], eax
		mov	[esp+44h+var_10], eax
		mov	[esp+44h+var_C], eax
		mov	[esp+44h+var_8], eax
		lea	eax, [esp+44h+var_34]
		push	eax
		lea	ecx, [esp+48h+var_18]
		push	ecx
		push	ebp
		push	edi
		push	ebx
		mov	[esp+58h+var_34], 14h
		call	sub_1000D520
		push	edi
		mov	esi, eax
		call	PORT_Free_Util
		add	esp, 18h
		test	esi, esi
		jnz	loc_10014CD0
		mov	eax, 14h
		cmp	[esp+44h+var_34], eax
		jnz	short loc_10014E40
		xor	ecx, ecx

loc_10014DE4:				; CODE XREF: sub_10014BA0+259j
		mov	edx, [esp+ecx+44h+var_18]
		cmp	edx, dword ptr ds:aKnownCryptoMes[ecx] ; "Known	Crypto Message"
		jnz	short loc_10014E40
		sub	eax, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_10014DE4
		mov	esi, [esp+44h+arg_8]
		mov	ebp, [esp+44h+var_20]
		xor	edi, edi

loc_10014E05:				; CODE XREF: sub_10014BA0+BDj
		push	108h
		push	ebp
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	loc_10014F79
		mov	eax, esi
		sub	eax, edi
		jz	loc_10014EA5
		dec	eax
		jz	short loc_10014E8E
		sub	eax, 2
		jnz	loc_10014BE9
		mov	eax, 90h
		mov	[esp+44h+var_2C], 1041h
		jmp	short loc_10014EB1
; ---------------------------------------------------------------------------

loc_10014E40:				; CODE XREF: sub_10014BA0+240j
					; sub_10014BA0+24Ej
		push	0FFFFE00Eh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 5
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014E64:				; CODE XREF: sub_10014BA0+196j
					; sub_10014BA0+1A5j ...
		push	0FFFFE028h
		call	PORT_SetError_Util
		push	edi
		call	PORT_Free_Util
		add	esp, 8

loc_10014E77:				; CODE XREF: sub_10014BA0+3BFj
					; sub_10014BA0+3CBj
		pop	edi
		pop	esi
		mov	eax, 5
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014E8E:				; CODE XREF: sub_10014BA0+286j
		mov	ecx, [esp+44h+var_1C]
		mov	eax, 40h
		mov	[esp+44h+Size],	ecx
		mov	[esp+44h+var_2C], 11h
		jmp	short loc_10014EB1
; ---------------------------------------------------------------------------

loc_10014EA5:				; CODE XREF: sub_10014BA0+27Fj
		mov	eax, [esp+44h+var_38]
		mov	[esp+44h+var_2C], 1

loc_10014EB1:				; CODE XREF: sub_10014BA0+29Ej
					; sub_10014BA0+303j
		push	eax
		mov	[esp+48h+var_38], eax
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jz	loc_10014C86
		mov	edx, [ebp+0Ch]
		push	edx
		lea	eax, [esp+48h+var_2C]
		push	eax
		push	ebx
		call	sub_10012FD0
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10014EFD

loc_10014EE0:				; CODE XREF: sub_10014BA0+37Aj
					; sub_10014BA0+396j
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10014EE9:				; CODE XREF: sub_10014BA0+3D3j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10014EFD:				; CODE XREF: sub_10014BA0+33Ej
		mov	edx, [esp+44h+Size]
		lea	ecx, [esp+44h+var_38]
		push	ecx		; int
		push	esi		; Dst
		push	edx		; Size
		push	offset aMozillaRulesTh ; "Mozilla Rules	the World through NSS!"
		push	ebx		; int
		call	sub_1000ECE0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_10014EE0
		mov	eax, [esp+44h+arg_0]
		mov	ecx, [eax+0Ch]
		push	ecx
		lea	edx, [esp+48h+var_2C]
		push	edx
		push	ebx
		call	sub_10013A30
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10014EE0
		mov	eax, [esp+44h+var_38]
		mov	ecx, [esp+44h+Size]
		push	eax		; int
		push	esi		; int
		push	ecx		; Size
		push	offset aMozillaRulesTh ; "Mozilla Rules	the World through NSS!"
		push	ebx		; int
		call	sub_100142F0
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 18h
		cmp	edi, 0C1h
		jz	loc_10014E77
		cmp	edi, 0C0h
		jz	loc_10014E77
		test	edi, edi
		jnz	loc_10014EE9

loc_10014F79:				; CODE XREF: sub_10014BA0+275j
		push	10Ch
		push	ebp
		call	sub_100169F0
		mov	ecx, [esp+4Ch+var_4]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_10014BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014FA0	proc near		; CODE XREF: sub_10004650+63p
					; DATA XREF: .rdata:1002609Eo

Src		= byte ptr -119h
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= byte ptr -0FCh
var_F8		= byte ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= byte ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= byte ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= byte ptr -0D4h
var_D0		= byte ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= byte ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= byte ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 11Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+11Ch+var_4], eax
		mov	ecx, [esp+11Ch+arg_4]
		mov	edx, [esp+11Ch+arg_10]
		mov	eax, [esp+11Ch+arg_0]
		push	ebx
		push	esi
		mov	esi, [esp+124h+arg_8]
		push	edi
		mov	[esp+128h+var_B8], ecx
		mov	ecx, [esp+128h+arg_18]
		mov	[esp+128h+var_8C], edx
		mov	edx, [esp+128h+arg_1C]
		push	eax
		mov	[esp+12Ch+var_100], eax
		mov	[esp+12Ch+var_88], ecx
		mov	[esp+12Ch+var_98], edx
		xor	edi, edi
		xor	ebx, ebx
		mov	[esp+12Ch+Src],	1
		mov	[esp+12Ch+var_94], 2
		mov	[esp+12Ch+var_90], 3
		call	sub_10007E90
		add	esp, 4
		mov	[esp+128h+var_104], eax
		mov	[esp+128h+var_110], edi
		cmp	eax, edi
		jnz	short loc_1001504F
		pop	edi
		pop	esi
		mov	eax, 0B3h
		pop	ebx
		mov	ecx, [esp+11Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 11Ch
		retn
; ---------------------------------------------------------------------------

loc_1001504F:				; CODE XREF: sub_10014FA0+90j
		push	ebp
		push	eax
		call	sub_100161F0
		mov	ebp, eax
		add	esp, 4
		cmp	ebp, edi
		jz	loc_10015139
		cmp	[esp+12Ch+arg_C], edi
		jle	short loc_100150AC
		add	esi, 4
		nop

loc_10015070:				; CODE XREF: sub_10014FA0+106j
		mov	eax, [esi-4]
		cmp	eax, 121h
		jnz	short loc_10015084
		mov	eax, [esi]
		mov	ecx, [eax]
		mov	[esp+12Ch+var_110], ecx
		jmp	short loc_1001509B
; ---------------------------------------------------------------------------

loc_10015084:				; CODE XREF: sub_10014FA0+D8j
		mov	edx, [esi+4]
		mov	ecx, [esi]
		push	edx
		push	ecx
		push	eax
		push	ebp
		call	sub_10016BB0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_100150BF

loc_1001509B:				; CODE XREF: sub_10014FA0+E2j
		inc	edi
		add	esi, 0Ch
		cmp	edi, [esp+12Ch+arg_C]
		jl	short loc_10015070
		test	ebx, ebx
		jnz	short loc_100150BF

loc_100150AC:				; CODE XREF: sub_10014FA0+CAj
		mov	edx, [esp+12Ch+var_104]
		push	edx
		call	sub_100161F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100150D2

loc_100150BF:				; CODE XREF: sub_10014FA0+F9j
					; sub_10014FA0+10Aj
		push	ebp
		call	sub_10016D30
		add	esp, 4
		mov	eax, 2
		jmp	loc_10015D4E
; ---------------------------------------------------------------------------

loc_100150D2:				; CODE XREF: sub_10014FA0+11Dj
		cmp	[esp+12Ch+arg_14], 0
		mov	[esp+12Ch+var_104], 0
		jle	short loc_10015143
		mov	edi, [esp+12Ch+var_8C]
		jmp	short loc_100150F0
; ---------------------------------------------------------------------------
		align 10h

loc_100150F0:				; CODE XREF: sub_10014FA0+14Bj
					; sub_10014FA0+184j
		mov	eax, [edi]
		cmp	eax, 160h
		jz	short loc_10015111
		mov	ecx, [edi+8]
		mov	edx, [edi+4]
		push	ecx
		push	edx
		push	eax
		push	esi
		call	sub_10016BB0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_1001512A

loc_10015111:				; CODE XREF: sub_10014FA0+157j
		mov	eax, [esp+12Ch+var_104]
		inc	eax
		add	edi, 0Ch
		mov	[esp+12Ch+var_104], eax
		cmp	eax, [esp+12Ch+arg_14]
		jl	short loc_100150F0
		test	ebx, ebx
		jz	short loc_10015143

loc_1001512A:				; CODE XREF: sub_10014FA0+16Fj
		push	ebp
		call	sub_10016D30
		push	esi
		call	sub_10016D30
		add	esp, 8

loc_10015139:				; CODE XREF: sub_10014FA0+BDj
		mov	eax, 2
		jmp	loc_10015D4E
; ---------------------------------------------------------------------------

loc_10015143:				; CODE XREF: sub_10014FA0+142j
					; sub_10014FA0+188j
		mov	edi, [esp+12Ch+var_110]
		push	0
		push	esi
		call	sub_10016B50
		push	100h
		push	esi
		call	sub_10016B50
		push	11h
		push	esi
		call	sub_10016B50
		push	0
		push	ebp
		call	sub_10016B50
		push	100h
		push	ebp
		call	sub_10016B50
		push	11h
		push	ebp
		call	sub_10016B50
		mov	eax, [esp+15Ch+var_B8]
		mov	eax, [eax]
		add	esp, 30h
		cmp	eax, 20h
		ja	loc_1001590F
		jz	loc_100156F4
		test	eax, eax
		jz	loc_10015473
		cmp	eax, 10h
		jnz	loc_10015916
		push	11h
		push	ebp
		call	sub_10016B50
		push	0D5A0DB00h
		push	esi
		call	sub_10016B50
		push	130h
		push	esi
		call	sub_10016B50
		push	131h
		push	esi
		call	sub_10016B50
		push	132h
		push	esi
		call	sub_10016B50
		push	130h
		push	ebp
		lea	ecx, [esp+15Ch+var_F8]
		push	ecx
		mov	ebx, 1
		push	0
		mov	[esp+164h+var_118], ebx
		call	sub_100168D0
		mov	edi, eax
		add	esp, 38h
		test	edi, edi
		jnz	loc_10015B90
		push	131h
		push	ebp
		lea	edx, [esp+134h+var_EC]
		push	edx
		push	eax
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_10015231
		mov	eax, [esp+12Ch+var_F4]
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_10015231:				; CODE XREF: sub_10014FA0+27Dj
		push	132h
		push	ebp
		lea	ecx, [esp+134h+var_E0]
		push	ecx
		push	0
		call	sub_100168D0
		mov	edx, [esp+13Ch+var_F4]
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_10015265
		push	edx
		call	PORT_Free_Util
		mov	eax, [esp+130h+var_E8]
		push	eax
		call	PORT_Free_Util
		jmp	loc_10015B03
; ---------------------------------------------------------------------------

loc_10015265:				; CODE XREF: sub_10014FA0+2AEj
		mov	ecx, [esp+12Ch+var_F0]
		push	ecx
		push	edx
		push	130h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_100152A5
		mov	eax, [esp+12Ch+var_F4]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+130h+var_E8]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esp+134h+var_DC]
		push	edx
		call	PORT_Free_Util
		add	esp, 0Ch
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100152A5:				; CODE XREF: sub_10014FA0+2DDj
		mov	eax, [esp+12Ch+var_E4]
		mov	ecx, [esp+12Ch+var_E8]
		push	eax
		push	ecx
		push	131h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_100152E9
		mov	edx, [esp+12Ch+var_F4]
		push	edx
		call	PORT_Free_Util
		mov	eax, [esp+130h+var_E8]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+134h+var_DC]
		push	ecx
		call	PORT_Free_Util
		add	esp, 0Ch
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100152E9:				; CODE XREF: sub_10014FA0+321j
		mov	edx, [esp+12Ch+var_D8]
		mov	eax, [esp+12Ch+var_DC]
		push	edx
		push	eax
		push	132h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_1001532D
		mov	ecx, [esp+12Ch+var_F4]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esp+130h+var_E8]
		push	edx
		call	PORT_Free_Util
		mov	eax, [esp+134h+var_DC]
		push	eax
		call	PORT_Free_Util
		add	esp, 0Ch
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_1001532D:				; CODE XREF: sub_10014FA0+365j
		mov	ecx, [esp+12Ch+var_E4]
		mov	edx, [esp+12Ch+var_E8]
		push	ecx
		push	edx
		call	sub_10015EB0
		add	eax, 0FFFFFF60h
		add	esp, 8
		cmp	eax, 60h
		ja	loc_10015448
		mov	eax, [esp+12Ch+var_F0]
		mov	ecx, [esp+12Ch+var_F4]
		push	eax
		push	ecx
		call	sub_10015EB0
		add	eax, 0FFFFFE00h
		add	esp, 8
		cmp	eax, 0A00h
		ja	loc_10015448
		mov	edx, [esp+12Ch+var_D8]
		mov	eax, [esp+12Ch+var_DC]
		push	edx
		push	eax
		call	sub_10015EB0
		add	eax, 0FFFFFFFEh
		add	esp, 8
		cmp	eax, 0BFEh
		ja	loc_10015448
		lea	ecx, [esp+12Ch+var_108]
		push	ecx
		lea	edx, [esp+130h+var_FC]
		push	edx
		call	sub_10020C10
		mov	edi, eax
		mov	eax, [esp+134h+var_F4]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+138h+var_E8]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esp+13Ch+var_DC]
		push	edx
		call	PORT_Free_Util
		add	esp, 14h
		test	edi, edi
		jz	short loc_100153E8
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_100153D7
		mov	dword_10029554,	ebx

loc_100153D7:				; CODE XREF: sub_10014FA0+42Fj
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100153E8:				; CODE XREF: sub_10014FA0+423j
		mov	eax, [esp+12Ch+var_108]
		mov	ecx, [eax+30h]
		mov	edx, [eax+2Ch]
		push	ecx
		push	edx
		push	11h
		push	ebp
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1001543E
		mov	eax, [esp+12Ch+var_108]
		mov	ecx, [eax+30h]
		mov	edx, [eax+2Ch]
		push	ecx
		push	edx
		push	0D5A0DB00h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1001543E
		mov	eax, [esp+12Ch+var_108]
		mov	ecx, [eax+3Ch]
		mov	edx, [eax+38h]
		push	ecx
		push	edx
		push	11h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax

loc_1001543E:				; CODE XREF: sub_10014FA0+463j
					; sub_10014FA0+483j
		mov	eax, [esp+12Ch+var_108]
		push	ebx
		jmp	loc_10015AFB
; ---------------------------------------------------------------------------

loc_10015448:				; CODE XREF: sub_10014FA0+3A7j
					; sub_10014FA0+3C9j ...
		mov	edx, [esp+12Ch+var_F4]
		push	edx
		mov	edi, 0D0h
		call	PORT_Free_Util
		mov	eax, [esp+130h+var_E8]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+134h+var_DC]
		push	ecx
		call	PORT_Free_Util
		add	esp, 0Ch
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_10015473:				; CODE XREF: sub_10014FA0+1FAj
		push	120h
		push	ebp
		call	sub_10016B50
		push	0D5A0DB00h
		push	esi
		call	sub_10016B50
		push	120h
		push	esi
		call	sub_10016B50
		push	123h
		push	esi
		call	sub_10016B50
		push	122h
		push	esi
		call	sub_10016B50
		push	124h
		push	esi
		call	sub_10016B50
		push	125h
		push	esi
		call	sub_10016B50
		push	126h
		push	esi
		call	sub_10016B50
		add	esp, 40h
		push	127h
		push	esi
		call	sub_10016B50
		push	128h
		push	esi
		call	sub_10016B50
		add	esp, 10h
		mov	[esp+12Ch+var_118], 0
		test	edi, edi
		jnz	short loc_100154FD
		mov	edi, 0D0h
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_100154FD:				; CODE XREF: sub_10014FA0+551j
		cmp	edi, 80h
		jge	short loc_1001550F

loc_10015505:				; CODE XREF: sub_10014FA0:loc_1001551Cj
					; sub_10014FA0+5BBj
		mov	edi, 13h
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_1001550F:				; CODE XREF: sub_10014FA0+563j
		and	edi, 80000001h
		jns	short loc_1001551C
		dec	edi
		or	edi, 0FFFFFFFEh
		inc	edi

loc_1001551C:				; CODE XREF: sub_10014FA0+575j
		jnz	short loc_10015505
		push	122h
		push	ebp
		lea	edx, [esp+134h+var_B0]
		push	edx
		push	0
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10015B90
		mov	eax, [esp+12Ch+var_A8]
		mov	ecx, [esp+12Ch+var_AC]
		push	eax
		push	ecx
		call	sub_10015EB0
		add	esp, 8
		cmp	eax, 2
		jb	short loc_10015505
		mov	edx, [esp+12Ch+var_A8]
		mov	eax, [esp+12Ch+var_AC]
		push	edx
		push	eax
		push	122h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_10015596
		mov	ecx, [esp+12Ch+var_AC]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_10015596:				; CODE XREF: sub_10014FA0+5DFj
		mov	eax, [esp+12Ch+var_110]
		lea	edx, [esp+12Ch+var_B0]
		push	edx
		push	eax
		call	sub_10020B40
		mov	ecx, [esp+134h+var_AC]
		push	ecx
		mov	ebx, eax
		call	PORT_Free_Util
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_100155E2
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_100155D1
		mov	dword_10029554,	1

loc_100155D1:				; CODE XREF: sub_10014FA0+625j
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100155E2:				; CODE XREF: sub_10014FA0+619j
		mov	edx, [ebx+18h]
		mov	eax, [ebx+14h]
		push	edx
		push	eax
		push	120h
		push	ebp
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100156EA
		mov	ecx, [ebx+18h]
		mov	edx, [ebx+14h]
		push	ecx
		push	edx
		push	0D5A0DB00h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100156EA
		mov	eax, [ebx+18h]
		mov	ecx, [ebx+14h]
		push	eax
		push	ecx
		push	120h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100156EA
		mov	edx, [ebx+30h]
		mov	eax, [ebx+2Ch]
		push	edx
		push	eax
		push	123h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100156EA
		mov	ecx, [ebx+3Ch]
		mov	edx, [ebx+38h]
		push	ecx
		push	edx
		push	124h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100156EA
		mov	eax, [ebx+48h]
		mov	ecx, [ebx+44h]
		push	eax
		push	ecx
		push	125h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100156EA
		mov	edx, [ebx+54h]
		mov	eax, [ebx+50h]
		push	edx
		push	eax
		push	126h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100156EA
		mov	ecx, [ebx+60h]
		mov	edx, [ebx+5Ch]
		push	ecx
		push	edx
		push	127h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100156EA
		mov	eax, [ebx+6Ch]
		mov	ecx, [ebx+68h]
		push	eax
		push	ecx
		push	128h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax

loc_100156EA:				; CODE XREF: sub_10014FA0+65Cj
					; sub_10014FA0+67Cj ...
		mov	edx, [ebx]
		push	1
		push	edx
		jmp	loc_10015AFE
; ---------------------------------------------------------------------------

loc_100156F4:				; CODE XREF: sub_10014FA0+1F2j
		push	130h
		push	esi
		call	sub_10016B50
		push	132h
		push	esi
		call	sub_10016B50
		push	11h
		push	esi
		call	sub_10016B50
		push	0D5A0DB00h
		push	esi
		call	sub_10016B50
		push	130h
		push	ebp
		lea	eax, [esp+154h+var_D0]
		push	eax
		push	0
		mov	[esp+15Ch+var_118], 2
		call	sub_100168D0
		mov	edi, eax
		add	esp, 30h
		test	edi, edi
		jnz	loc_10015B90
		push	132h
		push	ebp
		lea	ecx, [esp+134h+var_C4]
		push	ecx
		push	eax
		call	sub_100168D0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_10015773
		mov	edx, [esp+12Ch+var_CC]
		push	edx
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_10015773:				; CODE XREF: sub_10014FA0+7BFj
		mov	eax, [esp+12Ch+var_C8]
		mov	ecx, [esp+12Ch+var_CC]
		push	eax
		push	ecx
		push	130h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_100157AA
		mov	edx, [esp+12Ch+var_CC]
		push	edx
		call	PORT_Free_Util
		mov	eax, [esp+130h+var_C0]
		push	eax
		call	PORT_Free_Util
		jmp	loc_10015B03
; ---------------------------------------------------------------------------

loc_100157AA:				; CODE XREF: sub_10014FA0+7EFj
		mov	ecx, [esp+12Ch+var_BC]
		mov	edx, [esp+12Ch+var_C0]
		push	ecx
		push	edx
		push	132h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		mov	eax, [esp+13Ch+var_CC]
		add	esp, 10h
		test	edi, edi
		jz	short loc_100157E1
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+130h+var_C0]
		push	ecx
		call	PORT_Free_Util
		jmp	loc_10015B03
; ---------------------------------------------------------------------------

loc_100157E1:				; CODE XREF: sub_10014FA0+82Aj
		mov	edx, [esp+12Ch+var_C8]
		push	edx
		push	eax
		call	sub_10015EB0
		add	eax, 0FFFFFF80h
		add	esp, 8
		cmp	eax, 3F80h
		ja	loc_100158EE
		mov	ecx, [esp+12Ch+var_BC]
		mov	edx, [esp+12Ch+var_C0]
		push	ecx
		push	edx
		call	sub_10015EB0
		dec	eax
		add	esp, 8
		cmp	eax, 3FFFh
		ja	loc_100158CD
		lea	eax, [esp+12Ch+var_10C]
		push	eax
		lea	ecx, [esp+130h+var_D4]
		push	ecx
		call	sub_10020D40
		mov	edx, [esp+134h+var_CC]
		push	edx
		mov	edi, eax
		call	PORT_Free_Util
		mov	eax, [esp+138h+var_C0]
		push	eax
		call	PORT_Free_Util
		add	esp, 10h
		test	edi, edi
		jz	short loc_1001586E
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_1001585D
		mov	dword_10029554,	1

loc_1001585D:				; CODE XREF: sub_10014FA0+8B1j
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_1001586E:				; CODE XREF: sub_10014FA0+8A5j
		mov	eax, [esp+12Ch+var_10C]
		mov	ecx, [eax+24h]
		mov	edx, [eax+20h]
		push	ecx
		push	edx
		push	11h
		push	ebp
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100158C4
		mov	eax, [esp+12Ch+var_10C]
		mov	ecx, [eax+24h]
		mov	edx, [eax+20h]
		push	ecx
		push	edx
		push	0D5A0DB00h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100158C4
		mov	eax, [esp+12Ch+var_10C]
		mov	ecx, [eax+30h]
		mov	edx, [eax+2Ch]
		push	ecx
		push	edx
		push	11h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax

loc_100158C4:				; CODE XREF: sub_10014FA0+8E9j
					; sub_10014FA0+909j
		mov	eax, [esp+12Ch+var_10C]
		jmp	loc_10015AF9
; ---------------------------------------------------------------------------

loc_100158CD:				; CODE XREF: sub_10014FA0+875j
		mov	edx, [esp+12Ch+var_CC]
		push	edx
		mov	edi, 0D0h
		call	PORT_Free_Util
		mov	eax, [esp+130h+var_C0]
		push	eax
		call	PORT_Free_Util
		add	esp, 8
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_100158EE:				; CODE XREF: sub_10014FA0+857j
		mov	ecx, [esp+12Ch+var_CC]
		push	ecx
		mov	edi, 0D0h
		call	PORT_Free_Util
		mov	edx, [esp+130h+var_C0]
		push	edx
		call	PORT_Free_Util
		add	esp, 8
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_1001590F:				; CODE XREF: sub_10014FA0+1ECj
		cmp	eax, 1040h
		jz	short loc_10015920

loc_10015916:				; CODE XREF: sub_10014FA0+203j
		mov	edi, 70h
		jmp	loc_10015B90
; ---------------------------------------------------------------------------

loc_10015920:				; CODE XREF: sub_10014FA0+974j
		push	180h
		push	esi
		call	sub_10016B50
		push	11h
		push	esi
		call	sub_10016B50
		push	0D5A0DB00h
		push	esi
		call	sub_10016B50
		push	180h
		push	ebp
		lea	eax, [esp+14Ch+var_A4]
		push	eax
		push	0
		mov	[esp+154h+var_118], 3
		call	sub_100168D0
		mov	edi, eax
		add	esp, 28h
		test	edi, edi
		jnz	loc_10015B90
		mov	ecx, [esp+12Ch+var_9C]
		mov	edx, [esp+12Ch+var_A0]
		push	ecx
		push	edx
		push	180h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_100159A1
		mov	eax, [esp+12Ch+var_A0]
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100159A1:				; CODE XREF: sub_10014FA0+9EAj
		lea	ecx, [esp+12Ch+var_B4]
		push	ecx
		lea	edx, [esp+130h+var_A4]
		push	edx
		call	sub_10022AA0
		mov	edi, eax
		mov	eax, [esp+134h+var_A0]
		push	eax
		call	PORT_Free_Util
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_100159DA
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_100159DA:				; CODE XREF: sub_10014FA0+A27j
		mov	edx, [esp+12Ch+var_B4]
		lea	ecx, [esp+12Ch+var_114]
		push	ecx
		push	edx
		call	sub_10021E30
		mov	edi, eax
		mov	eax, [esp+134h+var_B4]
		mov	ecx, [eax]
		push	1
		push	ecx
		call	PORT_FreeArena_Util
		add	esp, 10h
		test	edi, edi
		jz	short loc_10015A2A
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE001h
		jnz	short loc_10015A19
		mov	dword_10029554,	1

loc_10015A19:				; CODE XREF: sub_10014FA0+A6Dj
		call	PORT_GetError_Util
		call	sub_1000BB00
		mov	edi, eax
		jmp	loc_10015B06
; ---------------------------------------------------------------------------

loc_10015A2A:				; CODE XREF: sub_10014FA0+A61j
		push	offset VarName	; "NSS_USE_DECODED_CKA_EC_POINT"
		call	ds:getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_10015A60
		mov	eax, [esp+12Ch+var_114]
		mov	edx, [eax+8Ch]
		mov	eax, [eax+88h]
		push	edx
		push	eax
		push	181h
		push	ebp
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax
		jmp	short loc_10015AAC
; ---------------------------------------------------------------------------

loc_10015A60:				; CODE XREF: sub_10014FA0+A9Aj
		push	0
		push	0
		call	NSS_Get_SEC_OctetStringTemplate_Util
		mov	ecx, [esp+134h+var_114]
		push	eax
		add	ecx, 84h
		push	ecx
		push	0
		push	0
		call	SEC_ASN1EncodeItem_Util
		mov	ebx, eax
		add	esp, 18h
		test	ebx, ebx
		jnz	short loc_10015A8C
		lea	edi, [eax+7]
		jmp	short loc_10015AF5
; ---------------------------------------------------------------------------

loc_10015A8C:				; CODE XREF: sub_10014FA0+AE5j
		mov	edx, [ebx+8]
		mov	eax, [ebx+4]
		push	edx
		push	eax
		push	181h
		push	ebp
		call	sub_10016BB0
		push	1
		push	ebx
		mov	edi, eax
		call	SECITEM_FreeItem_Util
		add	esp, 18h

loc_10015AAC:				; CODE XREF: sub_10014FA0+ABEj
		test	edi, edi
		jnz	short loc_10015AF5
		mov	eax, [esp+12Ch+var_114]
		mov	ecx, [eax+98h]
		mov	edx, [eax+94h]
		push	ecx
		push	edx
		push	11h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015AF5
		mov	eax, [esp+12Ch+var_114]
		mov	ecx, [eax+8Ch]
		mov	edx, [eax+88h]
		push	ecx
		push	edx
		push	0D5A0DB00h
		push	esi
		call	sub_10016BB0
		add	esp, 10h
		mov	edi, eax

loc_10015AF5:				; CODE XREF: sub_10014FA0+AEAj
					; sub_10014FA0+B0Ej ...
		mov	eax, [esp+12Ch+var_114]

loc_10015AF9:				; CODE XREF: sub_10014FA0+928j
		push	1

loc_10015AFB:				; CODE XREF: sub_10014FA0+4A3j
		mov	ecx, [eax]
		push	ecx

loc_10015AFE:				; CODE XREF: sub_10014FA0+74Fj
		call	PORT_FreeArena_Util

loc_10015B03:				; CODE XREF: sub_10014FA0+2C0j
					; sub_10014FA0+805j ...
		add	esp, 8

loc_10015B06:				; CODE XREF: sub_10014FA0+28Cj
					; sub_10014FA0+300j ...
		test	edi, edi
		jnz	loc_10015B90
		push	4
		lea	edx, [esp+130h+var_90]
		push	edx
		push	edi
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015B90
		push	4
		lea	eax, [esp+130h+var_94]
		push	eax
		push	edi
		push	ebp
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015B90
		push	4
		lea	ecx, [esp+130h+var_118]
		push	ecx
		push	100h
		push	esi
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015B90
		push	4
		lea	edx, [esp+130h+var_118]
		push	edx
		push	100h
		push	ebp
		call	sub_10016BB0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015B90
		mov	eax, [esp+12Ch+var_100]
		push	eax
		call	sub_100164F0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10015BA6
		mov	edi, 0B3h

loc_10015B90:				; CODE XREF: sub_10014FA0+25Fj
					; sub_10014FA0+4CEj ...
		push	esi
		call	sub_10016D30
		push	ebp
		call	sub_10016D30
		add	esp, 8
		mov	eax, edi
		jmp	loc_10015D4E
; ---------------------------------------------------------------------------

loc_10015BA6:				; CODE XREF: sub_10014FA0+BE9j
		push	edi
		push	esi
		call	sub_1000A8F0
		add	esp, 8
		mov	ebx, eax
		push	edi
		test	ebx, ebx
		jz	short loc_10015BD2
		call	sub_100177F0
		push	esi
		call	sub_10016D30
		push	ebp
		call	sub_10016D30
		add	esp, 0Ch
		mov	eax, ebx
		jmp	loc_10015D4E
; ---------------------------------------------------------------------------

loc_10015BD2:				; CODE XREF: sub_10014FA0+C15j
		push	ebp
		call	sub_1000A8F0
		push	edi
		mov	ebx, eax
		call	sub_100177F0
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_10015C0B
		push	ebp
		call	sub_10016D30
		mov	ecx, [esi+0Ch]
		mov	edx, [esp+130h+var_100]
		push	ecx
		push	edx
		call	sub_1000BE20
		push	esi
		call	sub_10016D30
		add	esp, 10h
		mov	eax, ebx
		jmp	loc_10015D4E
; ---------------------------------------------------------------------------

loc_10015C0B:				; CODE XREF: sub_10014FA0+C45j
		push	103h
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10015C32
		push	1		; Size
		lea	eax, [esp+130h+Src]
		push	eax		; Src
		push	165h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10015C32:				; CODE XREF: sub_10014FA0+C7Bj
		push	103h
		push	ebp
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jz	short loc_10015C59
		push	1		; Size
		lea	ecx, [esp+130h+Src]
		push	ecx		; Src
		push	165h		; int
		push	ebp		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10015C59:				; CODE XREF: sub_10014FA0+CA2j
		push	162h
		push	esi
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10015C80
		push	1		; Size
		lea	edx, [esp+130h+Src]
		push	edx		; Src
		push	164h		; int
		push	esi		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10015C80:				; CODE XREF: sub_10014FA0+CC9j
		push	162h
		push	ebp
		call	sub_100169F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10015CA7
		push	1		; Size
		lea	eax, [esp+130h+Src]
		push	eax		; Src
		push	164h		; int
		push	ebp		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10015CA7:				; CODE XREF: sub_10014FA0+CF0j
		mov	ecx, [esp+12Ch+var_118]
		mov	ebx, [esp+12Ch+var_100]
		push	ecx
		push	esi
		push	ebp
		call	sub_10014BA0
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10015D25
		mov	edx, [ebp+0Ch]
		push	edx
		push	ebx
		call	sub_1000BE20
		push	ebp
		call	sub_10016D30
		mov	eax, [esi+0Ch]
		push	eax
		push	ebx
		call	sub_1000BE20
		push	esi
		call	sub_10016D30
		add	esp, 18h
		cmp	dword_10029558,	0
		jz	short loc_10015D21
		mov	ecx, [esp+12Ch+var_B8]
		mov	edx, [ecx]
		push	edi
		push	edx
		push	ebx
		push	offset aC_generateke_0 ; "C_GenerateKeyPair(hSession=0x%08lX, pMe"...
		lea	eax, [esp+13Ch+var_84]
		push	80h
		push	eax
		call	ds:PR_snprintf
		lea	ecx, [esp+144h+var_84]
		push	ecx
		push	0Eh
		push	3
		call	nullsub_1
		add	esp, 24h

loc_10015D21:				; CODE XREF: sub_10014FA0+D4Aj
		mov	eax, edi
		jmp	short loc_10015D4E
; ---------------------------------------------------------------------------

loc_10015D25:				; CODE XREF: sub_10014FA0+D1Ej
		mov	edx, [esi+0Ch]
		mov	eax, [esp+12Ch+var_98]
		mov	[eax], edx
		mov	ecx, [ebp+0Ch]
		mov	edx, [esp+12Ch+var_88]
		push	ebp
		mov	[edx], ecx
		call	sub_10016D30
		push	esi
		call	sub_10016D30
		add	esp, 8
		xor	eax, eax

loc_10015D4E:				; CODE XREF: sub_10014FA0+12Dj
					; sub_10014FA0+19Ej ...
		mov	ecx, [esp+12Ch+var_4]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 11Ch
		retn
sub_10014FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015D70	proc near		; CODE XREF: sub_10006D60+4Bp
					; sub_10007070+B9p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+8], 0
		jz	short loc_10015DAC
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10015DA3
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_10015D97
		mov	ecx, [esi+1Ch]
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10015D97:				; CODE XREF: sub_10015D70+16j
		mov	edx, [esi+18h]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_10015DA3:				; CODE XREF: sub_10015D70+Fj
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10015DAC:				; CODE XREF: sub_10015D70+9j
		pop	esi
		retn
sub_10015D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015DB0	proc near		; CODE XREF: sub_10016660+2Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		push	54h
		mov	edi, eax
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_10015EA5
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp+18h]
		push	ebx
		push	eax
		push	ecx
		call	sub_1001CE40
		xor	ecx, ecx
		lea	ebx, [esi+14h]
		lea	edx, [esi+20h]
		push	1
		mov	[esi+10h], edi
		mov	[ebx], edi
		mov	[esi+18h], edx
		mov	dword ptr [esi+1Ch], 32h
		mov	[esi+4], ecx
		mov	[esi], ecx
		mov	dword ptr [esi+8], 1
		mov	[esi+0Ch], ecx
		mov	ecx, [ebp+0Ch]
		push	ebx
		push	ecx
		push	eax
		mov	[esp+2Ch+var_4], eax
		call	sub_1001BB30
		mov	edi, eax
		add	esp, 18h
		cmp	edi, 150h
		jnz	short loc_10015E76
		mov	eax, [esp+14h+var_4]
		push	1
		mov	dword ptr [esi+18h], 0
		mov	edx, [ebp+0Ch]
		push	ebx
		push	edx
		push	eax
		call	sub_1001BB30
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10015E76
		mov	ecx, [esi+1Ch]
		push	ecx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+18h], eax
		test	eax, eax
		jnz	short loc_10015E59
		lea	edi, [eax+2]
		jmp	short loc_10015E76
; ---------------------------------------------------------------------------

loc_10015E59:				; CODE XREF: sub_10015DB0+A2j
		mov	eax, [esp+14h+var_4]
		push	1
		mov	dword ptr [esi+0Ch], 1
		mov	edx, [ebp+0Ch]
		push	ebx
		push	edx
		push	eax
		call	sub_1001BB30
		add	esp, 10h
		mov	edi, eax

loc_10015E76:				; CODE XREF: sub_10015DB0+6Ej
					; sub_10015DB0+8Fj ...
		mov	eax, [esp+14h+var_4]
		pop	ebx
		test	eax, eax
		jz	short loc_10015E88
		push	eax
		call	sub_1001CD90
		add	esp, 4

loc_10015E88:				; CODE XREF: sub_10015DB0+CDj
		test	edi, edi
		jz	short loc_10015EA3
		push	esi
		mov	dword ptr [esi+1Ch], 0
		call	sub_10015D70
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10015EA3:				; CODE XREF: sub_10015DB0+DAj
		mov	eax, esi

loc_10015EA5:				; CODE XREF: sub_10015DB0+18j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_10015DB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015EB0	proc near		; CODE XREF: sub_10014FA0+397p
					; sub_10014FA0+3B7p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		xor	ecx, ecx
		lea	eax, ds:0[esi*8]
		test	esi, esi
		jz	short loc_10015EEA
		push	edi
		mov	edi, [esp+8+arg_0]

loc_10015EC7:				; CODE XREF: sub_10015EB0+24j
		mov	dl, [edi]
		inc	edi
		test	dl, dl
		jnz	short loc_10015ED9
		inc	ecx
		sub	eax, 8
		cmp	ecx, esi
		jb	short loc_10015EC7
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015ED9:				; CODE XREF: sub_10015EB0+1Cj
		mov	cl, 80h
		jmp	short loc_10015EE0
; ---------------------------------------------------------------------------
		align 10h

loc_10015EE0:				; CODE XREF: sub_10015EB0+2Bj
					; sub_10015EB0+37j
		test	dl, cl
		jnz	short loc_10015EE9
		dec	eax
		shr	cl, 1
		jnz	short loc_10015EE0

loc_10015EE9:				; CODE XREF: sub_10015EB0+32j
		pop	edi

loc_10015EEA:				; CODE XREF: sub_10015EB0+10j
		pop	esi
		retn
sub_10015EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015EF0	proc near		; CODE XREF: sub_100095C0+FAp
					; sub_1000B920+A7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, 3
		cmp	ecx, 80h
		ja	short loc_10015F2D
		jz	loc_10015FA5	; jumptable 10015F17 case 0
					; jumptable 10015F52 case 256
					; jumptable 10015F88 cases 304-306,353
		cmp	ecx, 11h	; switch 18 cases
		ja	locret_10015FAD	; jumptable 10015F17 default case
		movzx	ecx, ds:byte_10015FC4[ecx]
		jmp	ds:off_10015FB0[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10015F1E:				; CODE XREF: sub_10015EF0+27j
					; DATA XREF: .text:off_10015FB0o
		mov	eax, [esp+arg_4] ; jumptable 10015F17 case 17
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFFDh
		add	eax, 3
		retn
; ---------------------------------------------------------------------------

loc_10015F2D:				; CODE XREF: sub_10015EF0+Fj
		cmp	ecx, 128h
		ja	short loc_10015F66
		cmp	ecx, 120h
		jnb	short loc_10015FA5 ; jumptable 10015F17	case 0
					; jumptable 10015F52 case 256
					; jumptable 10015F88 cases 304-306,353
		add	ecx, 0FFFFFF7Eh	; switch 144 cases
		cmp	ecx, 8Fh
		ja	short locret_10015FAD ;	jumptable 10015F17 default case
		movzx	edx, ds:byte_10015FEC[ecx]
		jmp	ds:off_10015FD8[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10015F59:				; CODE XREF: sub_10015EF0+62j
					; DATA XREF: .text:off_10015FD8o
		mov	eax, [esp+arg_4] ; jumptable 10015F52 case 257
		dec	eax
		neg	eax
		sbb	eax, eax
		and	eax, 3
		retn
; ---------------------------------------------------------------------------

loc_10015F66:				; CODE XREF: sub_10015EF0+43j
		cmp	ecx, 165h
		ja	short loc_10015F95
		cmp	ecx, 164h
		jnb	short loc_10015FA5 ; jumptable 10015F17	case 0
					; jumptable 10015F52 case 256
					; jumptable 10015F88 cases 304-306,353
		add	ecx, 0FFFFFED0h	; switch 51 cases
		cmp	ecx, 32h
		ja	short locret_10015FAD ;	jumptable 10015F17 default case
		movzx	ecx, ds:byte_10016088[ecx]
		jmp	ds:off_1001607C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10015F8F:				; CODE XREF: sub_10015EF0+62j
					; sub_10015EF0+98j
					; DATA XREF: ...
		mov	eax, 2		; jumptable 10015F52 case 259
					; jumptable 10015F88 case 354
		retn
; ---------------------------------------------------------------------------

loc_10015F95:				; CODE XREF: sub_10015EF0+7Cj
		cmp	ecx, 170h
		jz	short loc_10015FA8 ; jumptable 10015F17	cases 1,2
		cmp	ecx, 0D5A0DB00h
		jnz	short locret_10015FAD ;	jumptable 10015F17 default case

loc_10015FA5:				; CODE XREF: sub_10015EF0+11j
					; sub_10015EF0+27j ...
		xor	eax, eax	; jumptable 10015F17 case 0
					; jumptable 10015F52 case 256
					; jumptable 10015F88 cases 304-306,353
		retn
; ---------------------------------------------------------------------------

loc_10015FA8:				; CODE XREF: sub_10015EF0+27j
					; sub_10015EF0+ABj
					; DATA XREF: ...
		mov	eax, 1		; jumptable 10015F17 cases 1,2

locret_10015FAD:			; CODE XREF: sub_10015EF0+1Aj
					; sub_10015EF0+27j ...
		retn			; jumptable 10015F17 default case
sub_10015EF0	endp

; ---------------------------------------------------------------------------
		align 10h
off_10015FB0	dd offset loc_10015FA5	; DATA XREF: sub_10015EF0+27r
		dd offset loc_10015FA8	; jump table for switch	statement
		dd offset locret_10015FAD
		dd offset loc_10015F1E
		dd offset locret_10015FAD
byte_10015FC4	db	0,     1,     1,     2 ; DATA XREF: sub_10015EF0+20r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	2,     3
		align 4
off_10015FD8	dd offset locret_10015FAD, offset loc_10015FA5,	offset loc_10015F59
					; DATA XREF: sub_10015EF0+62r
		dd offset loc_10015F8F,	offset locret_10015FAD ; jump table for	switch statement
byte_10015FEC	db	0,     4,     4,     4 ; DATA XREF: sub_10015EF0+5Br
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     1,     2
		db	0,     3,     0,     0
		db	0,     0,     0,     0
		db	0,     0,     0,     4
		db	4,     4,     0,     0
off_1001607C	dd offset loc_10015FA5,	offset loc_10015F8F, offset locret_10015FAD
					; DATA XREF: sub_10015EF0+98r
					; jump table for switch	statement
byte_10016088	db	0,     0,     0,     2 ; DATA XREF: sub_10015EF0+91r
		db	2,     2,     2,     2 ; indirect table	for switch statement
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     0,     1
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100160C0	proc near		; CODE XREF: sub_10009390+B8p
					; sub_10009390+1B0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, 11h
		jz	short loc_100160DA
		cmp	eax, 122h
		jbe	short loc_100160D7
		cmp	eax, 128h
		jbe	short loc_100160E8

loc_100160D7:				; CODE XREF: sub_100160C0+Ej
					; sub_100160C0+26j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100160DA:				; CODE XREF: sub_100160C0+7j
		mov	eax, [esp+arg_4]
		cmp	eax, 3
		jz	short loc_100160E8
		cmp	eax, 4
		jnz	short loc_100160D7

loc_100160E8:				; CODE XREF: sub_100160C0+15j
					; sub_100160C0+21j
		mov	eax, 1
		retn
sub_100160C0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100160F0:				; DATA XREF: sub_10016110+14o
		mov	eax, [esp+4]
		mov	ecx, [eax+0Ch]
		push	1
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016110	proc near		; CODE XREF: sub_10008120+26p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+14h]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [esi+60h]
		push	0
		push	offset loc_100160F0
		push	ecx
		call	PL_HashTableEnumerateEntries
		mov	edx, [esi+14h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
sub_10016110	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016140	proc near		; CODE XREF: sub_1000B0B0+182p
		push	esi
		mov	esi, ds:PR_NewLock
		call	esi ; PR_NewLock
		mov	dword_10029664,	eax
		call	esi ; PR_NewLock
		mov	dword_10029670,	eax
		pop	esi
		retn
sub_10016140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016160	proc near		; CODE XREF: sub_100161D0+8p
					; sub_100161D0+14p

arg_0		= dword	ptr  4

		mov	eax, [ebx+4]
		test	eax, eax
		jz	short locret_100161CA
		push	ebp
		push	esi
		push	eax
		call	ds:PR_Lock
		mov	esi, [ebx]
		mov	ebp, ds:PR_DestroyLock
		add	esp, 4
		test	esi, esi
		jz	short loc_100161AB
		push	edi

loc_10016180:				; CODE XREF: sub_10016160+48j
		mov	eax, [esi+14h]
		push	eax
		call	ebp ; PR_DestroyLock
		add	esp, 4
		cmp	[esp+0Ch+arg_0], 0
		jz	short loc_10016199
		mov	ecx, [esi+30h]
		push	ecx
		call	ebp ; PR_DestroyLock
		add	esp, 4

loc_10016199:				; CODE XREF: sub_10016160+2Ej
		mov	edi, [esi]
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10016180
		pop	edi

loc_100161AB:				; CODE XREF: sub_10016160+1Dj
		mov	edx, [ebx+4]
		xor	esi, esi
		push	edx
		mov	[ebx+8], esi
		mov	[ebx], esi
		call	ds:PR_Unlock
		mov	eax, [ebx+4]
		push	eax
		call	ebp ; PR_DestroyLock
		add	esp, 8
		mov	[ebx+4], esi
		pop	esi
		pop	ebp

locret_100161CA:			; CODE XREF: sub_10016160+5j
		retn
sub_10016160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100161D0	proc near		; CODE XREF: sub_1000B270:loc_1000B2B5p
					; sub_1000B300+33p
		push	ebx
		push	1
		mov	ebx, offset dword_10029660
		call	sub_10016160
		push	0
		mov	ebx, offset dword_1002966C
		call	sub_10016160
		add	esp, 8
		pop	ebx
		retn
sub_100161D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100161F0	proc near		; CODE XREF: sub_1000B800+34p
					; sub_1000B920+65p ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		cmp	[ebp+38h], edi
		jnz	short loc_10016246
		mov	eax, dword_10029664
		push	eax
		call	ds:PR_Lock
		mov	esi, dword_10029660
		add	esp, 4
		cmp	esi, edi
		jz	short loc_10016226
		mov	ecx, [esi]
		dec	dword_10029668
		mov	dword_10029660,	ecx

loc_10016226:				; CODE XREF: sub_100161F0+26j
		mov	edx, dword_10029664
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		cmp	esi, edi
		jz	short loc_10016246
		mov	[esi+4], edi
		mov	[esi], edi
		mov	ebx, 1
		jmp	short loc_10016265
; ---------------------------------------------------------------------------

loc_10016246:				; CODE XREF: sub_100161F0+Dj
					; sub_100161F0+48j
		push	0F90h
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jz	short loc_10016263
		mov	dword ptr [esi+0F08h], 20h

loc_10016263:				; CODE XREF: sub_100161F0+67j
		xor	ebx, ebx

loc_10016265:				; CODE XREF: sub_100161F0+54j
		cmp	esi, edi
		jz	short loc_100162C6
		mov	[esi+3Ch], edi
		lea	eax, [esi+4Ch]
		mov	ecx, 2Dh

loc_10016274:				; CODE XREF: sub_100161F0+8Dj
		mov	[eax+0Ch], edi
		mov	[eax], edi
		add	eax, 54h
		dec	ecx
		jnz	short loc_10016274
		mov	eax, [ebp+38h]
		mov	[esi+18h], ebp
		mov	ebp, ds:PR_NewLock
		mov	[esi+0F04h], eax
		mov	[esi+0Ch], edi
		mov	[esi+4], edi
		mov	[esi], edi
		mov	dword ptr [esi+10h], 1
		mov	[esi+24h], edi
		mov	[esi+28h], edi
		mov	[esi+2Ch], esi
		mov	[esi+34h], edi
		mov	[esi+38h], edi
		cmp	ebx, edi
		jnz	short loc_100162B8
		call	ebp ; PR_NewLock
		mov	[esi+14h], eax

loc_100162B8:				; CODE XREF: sub_100161F0+C1j
		cmp	[esi+14h], edi
		jnz	short loc_100162CD
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_100162C6:				; CODE XREF: sub_100161F0+77j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100162CD:				; CODE XREF: sub_100161F0+CBj
		cmp	ebx, edi
		jnz	short loc_100162D6
		call	ebp ; PR_NewLock
		mov	[esi+30h], eax

loc_100162D6:				; CODE XREF: sub_100161F0+DFj
		cmp	[esi+30h], edi
		jnz	short loc_100162F5
		mov	ecx, [esi+14h]
		push	ecx
		call	ds:PR_DestroyLock
		push	esi
		call	PORT_Free_Util
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100162F5:				; CODE XREF: sub_100161F0+E9j
		xor	eax, eax
		cmp	[esi+0F08h], edi
		jbe	short loc_10016313
		lea	ecx, [esi+0F0Ch]

loc_10016305:				; CODE XREF: sub_100161F0+121j
		mov	[ecx], edi
		inc	eax
		add	ecx, 4
		cmp	eax, [esi+0F08h]
		jb	short loc_10016305

loc_10016313:				; CODE XREF: sub_100161F0+10Dj
		mov	[esi+1Ch], edi
		mov	[esi+20h], edi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_100161F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016320	proc near		; CODE XREF: sub_10016BF0+44p
					; sub_10017940+1Dp
		push	ebx
		push	esi
		push	edi
		lea	esi, [eax+58h]
		mov	ebx, 2Dh
		jmp	short loc_10016330
; ---------------------------------------------------------------------------
		align 10h

loc_10016330:				; CODE XREF: sub_10016320+Bj
					; sub_10016320+45j
		mov	edi, [esi]
		test	edi, edi
		jz	short loc_10016361
		mov	eax, [esi+4]
		push	eax		; Size
		push	0		; Val
		push	edi		; Dst
		call	memset
		add	esp, 0Ch
		cmp	dword ptr [esi-0Ch], 0
		jz	short loc_10016354
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_10016354:				; CODE XREF: sub_10016320+29j
		mov	dword ptr [esi], 0
		mov	dword ptr [esi-0Ch], 0

loc_10016361:				; CODE XREF: sub_10016320+14j
		add	esi, 54h
		dec	ebx
		jnz	short loc_10016330
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10016320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016370	proc near		; CODE XREF: sub_10009A90+E5p
					; sub_10009A90+111p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10016384
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10016384:				; CODE XREF: sub_10016370+9j
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	esi
		retn
sub_10016370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016390	proc near		; CODE XREF: sub_10008D80+125p
					; sub_10016450+8Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+24h], 0
		jz	short loc_100163BA
		cmp	dword ptr [eax+28h], 0
		mov	eax, [esp+arg_4]
		jz	short loc_100163AC
		mov	dword ptr [eax+1Ch], 4
		retn
; ---------------------------------------------------------------------------

loc_100163AC:				; CODE XREF: sub_10016390+12j
		movzx	ecx, byte ptr [eax+20h]
		and	ecx, 2
		or	ecx, 1
		mov	[eax+1Ch], ecx
		retn
; ---------------------------------------------------------------------------

loc_100163BA:				; CODE XREF: sub_10016390+8j
		mov	eax, [esp+arg_4]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 2
		mov	[eax+1Ch], edx
		retn
sub_10016390	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100163D0	proc near		; CODE XREF: sub_10008B70+1E6p
					; sub_100090D0+132p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		cmp	[esi+70h], edi
		jbe	short loc_10016446
		push	ebx
		push	ebp
		mov	ebp, ds:PR_Lock

loc_100163E5:				; CODE XREF: sub_100163D0+72j
		mov	ecx, [esi+8]
		mov	eax, edi
		and	eax, [esi+10h]
		mov	ebx, [ecx+eax*4]
		push	ebx
		call	ebp ; PR_Lock
		mov	edx, [esi+6Ch]
		mov	eax, [edx+edi*4]
		add	esp, 4
		test	eax, eax
		jz	short loc_10016434

loc_10016400:				; CODE XREF: sub_100163D0+62j
		cmp	dword ptr [esi+24h], 0
		jz	short loc_10016424
		cmp	dword ptr [esi+28h], 0
		jz	short loc_10016415
		mov	dword ptr [eax+1Ch], 4
		jmp	short loc_1001642E
; ---------------------------------------------------------------------------

loc_10016415:				; CODE XREF: sub_100163D0+3Aj
		movzx	ecx, byte ptr [eax+20h]
		and	ecx, 2
		or	ecx, 1
		mov	[eax+1Ch], ecx
		jmp	short loc_1001642E
; ---------------------------------------------------------------------------

loc_10016424:				; CODE XREF: sub_100163D0+34j
		movzx	edx, byte ptr [eax+20h]
		and	edx, 2
		mov	[eax+1Ch], edx

loc_1001642E:				; CODE XREF: sub_100163D0+43j
					; sub_100163D0+52j
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_10016400

loc_10016434:				; CODE XREF: sub_100163D0+2Ej
		push	ebx
		call	ds:PR_Unlock
		inc	edi
		add	esp, 4
		cmp	edi, [esi+70h]
		jb	short loc_100163E5
		pop	ebp
		pop	ebx

loc_10016446:				; CODE XREF: sub_100163D0+Bj
		pop	edi
		pop	esi
		retn
sub_100163D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016450	proc near		; CODE XREF: sub_10008D80+5Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	edi
		xor	edi, edi
		push	edi
		push	ebp
		call	sub_10007E50
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, edi
		jnz	short loc_1001646F
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001646F:				; CODE XREF: sub_10016450+17j
		push	esi
		push	48h
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jz	short loc_100164B2
		mov	eax, 1
		mov	[esi+4], edi
		mov	[esi], edi
		mov	[esi+0Ch], eax
		mov	[esi+38h], edi
		mov	[esi+3Ch], edi
		mov	[esi+40h], edi
		mov	[esi+34h], edi
		mov	[esi+14h], eax
		call	ds:PR_NewLock
		mov	[esi+10h], eax
		push	esi
		cmp	eax, edi
		jnz	short loc_100164B9
		call	PORT_Free_Util
		add	esp, 4

loc_100164B2:				; CODE XREF: sub_10016450+2Ej
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100164B9:				; CODE XREF: sub_10016450+58j
		mov	eax, [esp+14h+arg_4]
		mov	ecx, [esp+14h+arg_8]
		mov	edx, [esp+14h+arg_C]
		push	ebx
		mov	[esi+44h], edi
		mov	[esi+30h], ebx
		mov	[esi+28h], eax
		mov	[esi+2Ch], ecx
		mov	[esi+20h], edx
		mov	[esi+18h], ebp
		mov	[esi+24h], edi
		call	sub_10016390
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_10016450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100164F0	proc near		; CODE XREF: sub_10008A20+3Dp
					; sub_10008B70+56p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		push	edi
		call	sub_10007E90
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10016508
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016508:				; CODE XREF: sub_100164F0+13j
		mov	eax, [esi+10h]
		mov	ecx, [esi+8]
		and	eax, edi
		push	ebx
		mov	ebx, [ecx+eax*4]
		push	ebx
		call	ds:PR_Lock
		mov	edx, [esi+70h]
		mov	ecx, [esi+6Ch]
		mov	eax, edi
		imul	eax, 6AC690C5h
		dec	edx
		and	edx, eax
		mov	esi, [ecx+edx*4]
		add	esp, 4
		test	esi, esi
		jz	short loc_10016554

loc_10016536:				; CODE XREF: sub_100164F0+4Fj
		cmp	[esi+8], edi
		jz	short loc_10016551
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10016536
		push	ebx
		call	ds:PR_Unlock
		add	esp, 4
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016551:				; CODE XREF: sub_100164F0+49j
		inc	dword ptr [esi+0Ch]

loc_10016554:				; CODE XREF: sub_100164F0+44j
		push	ebx
		call	ds:PR_Unlock
		add	esp, 4
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100164F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016570	proc near		; CODE XREF: sub_100108A0+48p
					; sub_10010E70+1129p ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+0Ch]
		and	eax, 80000000h
		sub	eax, 80000000h
		neg	eax
		sbb	eax, eax
		and	eax, ecx
		retn
sub_10016570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016590	proc near		; CODE XREF: sub_10016BB0+16p
					; sub_10016F60+4Dp ...

arg_0		= dword	ptr  4
Size		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+Size]
		push	esi
		mov	esi, [eax+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		and	esi, eax
		jnz	short loc_100165B2
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100165B2:				; CODE XREF: sub_10016590+1Bj
		mov	eax, [esi+30h]
		push	edi
		push	eax
		call	ds:PR_Lock
		mov	edi, [esi+3Ch]
		mov	edx, [esi+30h]
		lea	ecx, [edi+1]
		push	edx
		mov	[esi+3Ch], ecx
		call	ds:PR_Unlock
		add	esp, 8
		cmp	edi, 2Dh
		jge	short loc_10016613
		mov	eax, [esp+0Ch+arg_0]
		imul	edi, 54h
		lea	esi, [edi+esi+40h]
		xor	edi, edi
		mov	[esi+14h], eax
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		cmp	ebx, edi
		jz	short loc_1001663C
		cmp	ebp, 32h
		ja	short loc_100165FC
		lea	eax, [esi+20h]
		jmp	short loc_1001660C
; ---------------------------------------------------------------------------

loc_100165FC:				; CODE XREF: sub_10016590+65j
		push	ebp
		call	PORT_Alloc_Util
		add	esp, 4
		mov	dword ptr [esi+0Ch], 1

loc_1001660C:				; CODE XREF: sub_10016590+6Aj
		mov	[esi+18h], eax
		cmp	eax, edi
		jnz	short loc_10016619

loc_10016613:				; CODE XREF: sub_10016590+46j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10016619:				; CODE XREF: sub_10016590+81j
		push	ebp		; Size
		push	ebx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+18h+arg_0]
		add	esp, 0Ch
		mov	[esi+4], edi
		mov	[esi], edi
		mov	[esi+14h], eax
		mov	[esi+10h], eax
		pop	edi
		mov	[esi+1Ch], ebp
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001663C:				; CODE XREF: sub_10016590+60j
		mov	[esi+18h], edi
		mov	[esi+1Ch], edi
		mov	[esi+4], edi
		mov	[esi], edi
		mov	[esi+14h], eax
		mov	[esi+10h], eax
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_10016590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016660	proc near		; CODE XREF: sub_10006D60+38p
					; sub_10007070+1Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+0Ch]
		push	esi
		and	eax, 80000000h
		lea	esi, [eax+80000000h]
		neg	esi
		sbb	esi, esi
		and	esi, ecx
		jnz	short loc_10016699
		xor	edx, edx
		cmp	eax, 80000000h
		setnz	dl
		lea	eax, [edx-1]
		and	eax, ecx
		push	eax
		mov	eax, [esp+8+arg_4]
		call	sub_10015DB0
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016699:				; CODE XREF: sub_10016660+19j
		mov	eax, [esi+30h]
		push	edi
		push	eax
		call	ds:PR_Lock
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esi+0F08h]
		mov	edx, eax
		imul	edx, 6AC690C5h
		dec	ecx
		and	ecx, edx
		mov	edi, [esi+ecx*4+0F0Ch]
		add	esp, 4
		test	edi, edi
		jz	short loc_100166D2

loc_100166C7:				; CODE XREF: sub_10016660+70j
		cmp	[edi+10h], eax
		jz	short loc_100166D2
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_100166C7

loc_100166D2:				; CODE XREF: sub_10016660+65j
					; sub_10016660+6Aj
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_10016660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100166F0	proc near		; CODE XREF: sub_10009D10+41p
					; sub_10009D10+5Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	esi
		push	eax
		push	ecx
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10016710
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016710:				; CODE XREF: sub_100166F0+17j
		mov	eax, [esi+18h]
		test	eax, eax
		jnz	short loc_10016727
		push	esi
		call	sub_10015D70
		add	esp, 4
		mov	eax, 13h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016727:				; CODE XREF: sub_100166F0+25j
		mov	edx, [esi+1Ch]
		push	edi
		push	edx
		push	eax
		call	sub_10015EB0
		push	esi
		mov	edi, eax
		call	sub_10015D70
		mov	eax, [esp+14h+arg_8]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10016749
		cmp	edi, eax
		jl	short loc_10016766

loc_10016749:				; CODE XREF: sub_100166F0+53j
		mov	eax, [esp+8+arg_C]
		test	eax, eax
		jz	short loc_10016755
		cmp	edi, eax
		jg	short loc_10016766

loc_10016755:				; CODE XREF: sub_100166F0+5Fj
		mov	ecx, [esp+8+arg_10]
		test	ecx, ecx
		jz	short loc_1001676E
		mov	eax, edi
		cdq
		idiv	ecx
		test	edx, edx
		jz	short loc_1001676E

loc_10016766:				; CODE XREF: sub_100166F0+57j
					; sub_100166F0+63j
		pop	edi
		mov	eax, 13h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001676E:				; CODE XREF: sub_100166F0+6Bj
					; sub_100166F0+74j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100166F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016780	proc near		; CODE XREF: sub_10006CB0+Cp
					; sub_10006CF0+21p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+0Ch]
		sub	esp, 0Ch
		push	esi
		and	eax, 80000000h
		lea	esi, [eax+80000000h]
		neg	esi
		sbb	esi, esi
		and	esi, ecx
		push	edi
		jnz	short loc_100167FE
		xor	edx, edx
		cmp	eax, 80000000h
		setnz	dl
		lea	esi, [edx-1]
		and	esi, ecx
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		call	sub_1001CE40
		mov	ecx, [esi+0Ch]
		mov	edx, [esp+1Ch+arg_4]
		mov	edi, eax
		push	1
		lea	eax, [esp+20h+var_C]
		push	eax
		push	ecx
		push	edi
		mov	[esp+2Ch+var_C], edx
		mov	[esp+2Ch+var_8], 0
		mov	[esp+2Ch+var_4], 0
		call	sub_1001BB30
		push	edi
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 1Ch
		xor	eax, eax
		test	esi, esi
		pop	edi
		setz	al
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100167FE:				; CODE XREF: sub_10016780+1Dj
		mov	edx, [esi+30h]
		push	edx
		call	ds:PR_Lock
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esi+0F08h]
		mov	edx, eax
		imul	edx, 6AC690C5h
		dec	ecx
		and	ecx, edx
		mov	edi, [esi+ecx*4+0F0Ch]
		add	esp, 4
		test	edi, edi
		jz	short loc_1001683B
		jmp	short loc_10016830
; ---------------------------------------------------------------------------
		align 10h

loc_10016830:				; CODE XREF: sub_10016780+ABj
					; sub_10016780+B9j
		cmp	[edi+10h], eax
		jz	short loc_1001683B
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_10016830

loc_1001683B:				; CODE XREF: sub_10016780+A9j
					; sub_10016780+B3j
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		xor	eax, eax
		test	edi, edi
		pop	edi
		setnz	al
		pop	esi
		add	esp, 0Ch
		retn
sub_10016780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016860	proc near		; CODE XREF: sub_10016BB0+2Fp
					; sub_10016F60+96p
		push	esi
		mov	esi, [eax+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		and	esi, eax
		jz	short loc_100168C9
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Lock
		mov	eax, [edi+10h]
		mov	ecx, [esi+0F08h]
		imul	eax, 6AC690C5h
		dec	ecx
		and	eax, ecx
		mov	edx, [esi+eax*4+0F0Ch]
		mov	[edi], edx
		mov	dword ptr [edi+4], 0
		mov	ecx, [esi+eax*4+0F0Ch]
		add	esp, 4
		test	ecx, ecx
		jz	short loc_100168B5
		mov	[ecx+4], edi

loc_100168B5:				; CODE XREF: sub_10016860+50j
		mov	[esi+eax*4+0F0Ch], edi
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4

loc_100168C9:				; CODE XREF: sub_10016860+16j
		pop	esi
		retn
sub_10016860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100168D0	proc near		; CODE XREF: sub_100072C0+B6p
					; sub_100072C0+D3p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		push	eax
		push	ecx
		mov	dword ptr [edi+4], 0
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_100168FD
		pop	edi
		mov	eax, 0D0h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100168FD:				; CODE XREF: sub_100168D0+23j
		mov	edx, [esi+1Ch]
		mov	eax, [esp+8+arg_0]
		push	edx
		push	edi
		push	eax
		call	SECITEM_AllocItem_Util
		mov	eax, [edi+4]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016927
		push	esi
		call	sub_10015D70
		add	esp, 4
		pop	edi
		mov	eax, 2
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016927:				; CODE XREF: sub_100168D0+44j
		mov	ecx, [edi+8]
		mov	edx, [esi+18h]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		push	esi
		call	sub_10015D70
		add	esp, 10h
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100168D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016950	proc near		; CODE XREF: sub_10016B50+1Cp
		push	esi
		mov	esi, [eax+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		and	esi, eax
		jz	short loc_100169E3
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Lock
		mov	eax, [edi]
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001699D
		cmp	[edi+4], eax
		jnz	short loc_100169A3
		mov	ecx, [edi+10h]
		mov	edx, [esi+0F08h]
		imul	ecx, 6AC690C5h
		dec	edx
		and	ecx, edx
		cmp	[esi+ecx*4+0F0Ch], edi
		jnz	short loc_100169D6
		jmp	short loc_100169A3
; ---------------------------------------------------------------------------

loc_1001699D:				; CODE XREF: sub_10016950+29j
		mov	ecx, [edi+4]
		mov	[eax+4], ecx

loc_100169A3:				; CODE XREF: sub_10016950+2Ej
					; sub_10016950+4Bj
		mov	eax, [edi+4]
		mov	edx, [edi]
		test	eax, eax
		jz	short loc_100169B0
		mov	[eax], edx
		jmp	short loc_100169C9
; ---------------------------------------------------------------------------

loc_100169B0:				; CODE XREF: sub_10016950+5Aj
		mov	eax, [edi+10h]
		mov	ecx, [esi+0F08h]
		imul	eax, 6AC690C5h
		dec	ecx
		and	eax, ecx
		mov	[esi+eax*4+0F0Ch], edx

loc_100169C9:				; CODE XREF: sub_10016950+5Ej
		mov	dword ptr [edi], 0
		mov	dword ptr [edi+4], 0

loc_100169D6:				; CODE XREF: sub_10016950+49j
		mov	eax, [esi+30h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4

loc_100169E3:				; CODE XREF: sub_10016950+16j
		pop	esi
		retn
sub_10016950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100169F0	proc near		; CODE XREF: sub_10006CF0+3p
					; sub_10006CF0+12p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	esi
		push	eax
		push	ecx
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10016A0B
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016A0B:				; CODE XREF: sub_100169F0+17j
		cmp	dword ptr [esi+8], 0
		mov	eax, [esi+18h]
		push	edi
		movzx	edi, byte ptr [eax]
		jz	short loc_10016A46
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10016A3D
		test	eax, eax
		jz	short loc_10016A31
		mov	edx, [esi+1Ch]
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10016A31:				; CODE XREF: sub_100169F0+30j
		mov	eax, [esi+18h]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10016A3D:				; CODE XREF: sub_100169F0+2Cj
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10016A46:				; CODE XREF: sub_100169F0+26j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_100169F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016A50	proc near		; CODE XREF: sub_10017BD0+47p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	esi
		mov	esi, eax
		mov	eax, [esi+0Ch]
		mov	ecx, eax
		and	ecx, 80000000h
		sub	ecx, 80000000h
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		test	esi, ecx
		jnz	short loc_10016A7B
		mov	eax, 30h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10016A7B:				; CODE XREF: sub_10016A50+1Fj
		mov	edx, [esi+18h]
		push	edi
		push	eax
		push	edx
		call	sub_1001CE40
		mov	ecx, [esp+1Ch+arg_4]
		mov	edx, [esp+1Ch+arg_8]
		mov	edi, eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_C], eax
		push	1
		lea	eax, [esp+20h+var_C]
		push	eax
		push	esi
		push	edi
		mov	[esp+2Ch+var_8], ecx
		mov	[esp+2Ch+var_4], edx
		call	sub_1001BC40
		push	edi
		mov	esi, eax
		call	sub_1001CD90
		add	esp, 1Ch
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 0Ch
		retn
sub_10016A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016AD0	proc near		; CODE XREF: sub_10010E70+28Cp
					; sub_10010E70+2A9p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		push	edi
		push	eax
		push	ecx
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_10016AF0
		mov	eax, 0D0h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10016AF0:				; CODE XREF: sub_10016AD0+17j
		mov	eax, [esp+4+arg_0]
		push	ebx
		mov	ebx, [esp+8+arg_4]
		push	esi
		mov	esi, [edi+1Ch]
		push	esi
		test	eax, eax
		jz	short loc_10016B0D
		push	eax
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		jmp	short loc_10016B15
; ---------------------------------------------------------------------------

loc_10016B0D:				; CODE XREF: sub_10016AD0+30j
		call	PORT_Alloc_Util
		add	esp, 4

loc_10016B15:				; CODE XREF: sub_10016AD0+3Bj
		mov	[ebx+4], eax
		test	eax, eax
		jnz	short loc_10016B2E
		push	edi
		call	sub_10015D70
		add	esp, 4
		pop	esi
		pop	ebx
		mov	eax, 2
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10016B2E:				; CODE XREF: sub_10016AD0+4Aj
		mov	[ebx+8], esi
		mov	edx, [edi+18h]
		push	esi		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		push	edi
		call	sub_10015D70
		add	esp, 10h
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	edi
		retn
sub_10016AD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016B50	proc near		; CODE XREF: sub_1000F6D0+C8p
					; sub_1000F6D0+D3p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	eax
		push	esi
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_10016BA8
		mov	eax, esi
		call	sub_10016950
		cmp	dword ptr [edi+8], 0
		jz	short loc_10016BA8
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_10016B9F
		mov	eax, [edi+18h]
		test	eax, eax
		jz	short loc_10016B93
		mov	ecx, [edi+1Ch]
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10016B93:				; CODE XREF: sub_10016B50+32j
		mov	edx, [edi+18h]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_10016B9F:				; CODE XREF: sub_10016B50+2Bj
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_10016BA8:				; CODE XREF: sub_10016B50+18j
					; sub_10016B50+25j
		pop	edi
		pop	esi
		retn
sub_10016B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016BB0	proc near		; CODE XREF: sub_10006CB0+24p
					; sub_10006CF0+32p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		mov	esi, [esp+8+arg_0]
		push	eax
		push	ecx
		mov	eax, esi
		call	sub_10016590
		add	esp, 8
		test	eax, eax
		jnz	short loc_10016BDA
		pop	esi
		mov	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016BDA:				; CODE XREF: sub_10016BB0+20j
		push	edi
		mov	edi, eax
		mov	eax, esi
		call	sub_10016860
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10016BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016BF0	proc near		; CODE XREF: sub_10016D30+34p
					; sub_100176D0+61p ...
		mov	eax, [esi+0Ch]
		push	ebx
		and	eax, 80000000h
		push	ebp
		push	edi
		lea	edi, [eax+80000000h]
		neg	edi
		sbb	edi, edi
		xor	ebx, ebx
		and	edi, esi
		cmp	eax, 80000000h
		setnz	bl
		mov	ebp, 0
		dec	ebx
		and	ebx, esi
		jz	short loc_10016C2E
		mov	eax, [ebx+28h]
		cmp	eax, ebp
		jz	short loc_10016C2E
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[ebx+28h], ebp

loc_10016C2E:				; CODE XREF: sub_10016BF0+29j
					; sub_10016BF0+30j
		cmp	edi, ebp
		jz	short loc_10016C39
		mov	eax, edi
		call	sub_10016320

loc_10016C39:				; CODE XREF: sub_10016BF0+40j
		mov	eax, [esi+1Ch]
		cmp	eax, ebp
		jz	short loc_10016C4F
		push	eax
		mov	eax, [esi+20h]
		call	eax
		add	esp, 4
		mov	[esi+1Ch], ebp
		mov	[esi+20h], ebp

loc_10016C4F:				; CODE XREF: sub_10016BF0+4Ej
		cmp	edi, ebp
		jz	short loc_10016CC7
		xor	eax, eax
		cmp	[esi+0F04h], ebp
		setnz	al
		cmp	[esi+14h], ebp
		jz	short loc_10016CA9
		cmp	eax, ebp
		jnz	short loc_10016CA9
		cmp	dword_10029668,	320h
		jge	short loc_10016CA9
		mov	ecx, dword_10029664
		push	ecx
		call	ds:PR_Lock
		mov	edx, dword_10029660
		mov	[esi], edx
		mov	eax, dword_10029664
		inc	dword_10029668
		push	eax
		mov	dword_10029660,	esi
		call	ds:PR_Unlock
		add	esp, 8
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016CA9:				; CODE XREF: sub_10016BF0+71j
					; sub_10016BF0+75j ...
		mov	ecx, [esi+30h]
		mov	edi, ds:PR_DestroyLock
		push	ecx
		call	edi ; PR_DestroyLock
		mov	eax, [esi+14h]
		add	esp, 4
		mov	[esi+30h], ebp
		cmp	eax, ebp
		jz	short loc_10016D21
		push	eax
		call	edi ; PR_DestroyLock
		jmp	short loc_10016D1B
; ---------------------------------------------------------------------------

loc_10016CC7:				; CODE XREF: sub_10016BF0+61j
		mov	eax, [esi+14h]
		cmp	eax, ebp
		jz	short loc_10016D21
		cmp	dword_10029674,	320h
		jge	short loc_10016D10
		mov	edx, dword_10029670
		push	edx
		call	ds:PR_Lock
		mov	eax, dword_1002966C
		mov	[esi], eax
		mov	ecx, dword_10029670
		inc	dword_10029674
		push	ecx
		mov	dword_1002966C,	esi
		call	ds:PR_Unlock
		add	esp, 8
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016D10:				; CODE XREF: sub_10016BF0+E8j
		cmp	eax, ebp
		jz	short loc_10016D21
		push	eax
		call	ds:PR_DestroyLock

loc_10016D1B:				; CODE XREF: sub_10016BF0+D5j
		add	esp, 4
		mov	[esi+14h], ebp

loc_10016D21:				; CODE XREF: sub_10016BF0+D0j
					; sub_10016BF0+DCj ...
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10016BF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016D30	proc near		; CODE XREF: sub_10008930+87p
					; sub_10009390+161p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+14h]
		push	edi
		push	eax
		xor	edi, edi
		call	ds:PR_Lock
		mov	eax, [esi+10h]
		add	esp, 4
		cmp	eax, 1
		jnz	short loc_10016D4F
		mov	edi, eax

loc_10016D4F:				; CODE XREF: sub_10016D30+1Bj
		mov	ecx, [esi+14h]
		dec	eax
		push	ecx
		mov	[esi+10h], eax
		call	ds:PR_Unlock
		add	esp, 4
		test	edi, edi
		jz	short loc_10016D71
		call	sub_10016BF0
		neg	eax
		sbb	eax, eax
		pop	edi
		inc	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016D71:				; CODE XREF: sub_10016D30+32j
		pop	edi
		mov	eax, 2
		pop	esi
		retn
sub_10016D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016D80	proc near		; CODE XREF: sub_1000A8F0+24Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		mov	ebx, [ebp+30h]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	esi, [edi+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		and	esi, edi
		jz	short loc_10016DE3
		mov	eax, [ebp+10h]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [ebp+44h]
		lea	eax, [esi+24h]
		mov	[eax], ecx
		mov	dword ptr [esi+28h], 0
		mov	ecx, [ebp+44h]
		add	esp, 4
		test	ecx, ecx
		jz	short loc_10016DCC
		mov	[ecx+4], eax

loc_10016DCC:				; CODE XREF: sub_10016D80+47j
		mov	[ebp+44h], eax
		mov	[esi+34h], ebp
		mov	edx, [ebp+10h]
		mov	ebp, ds:PR_Unlock
		push	edx
		call	ebp ; PR_Unlock
		add	esp, 4
		jmp	short loc_10016DE9
; ---------------------------------------------------------------------------

loc_10016DE3:				; CODE XREF: sub_10016D80+24j
		mov	ebp, ds:PR_Unlock

loc_10016DE9:				; CODE XREF: sub_10016D80+61j
		mov	eax, [edi+0Ch]
		mov	esi, [ebx+68h]
		imul	eax, 6AC690C5h
		mov	dword ptr [edi+4], 0
		mov	ecx, [ebx+14h]
		dec	esi
		push	ecx
		and	esi, eax
		call	ds:PR_Lock
		mov	edx, [ebx+64h]
		mov	eax, [edx+esi*4]
		mov	[edi], eax
		mov	ecx, [ebx+64h]
		add	esp, 4
		cmp	dword ptr [ecx+esi*4], 0
		jz	short loc_10016E23
		mov	eax, [ecx+esi*4]
		mov	[eax+4], edi

loc_10016E23:				; CODE XREF: sub_10016D80+9Bj
		mov	ecx, [ebx+64h]
		mov	[ecx+esi*4], edi
		mov	edx, [ebx+14h]
		push	edx
		call	ebp ; PR_Unlock
		mov	eax, [edi+14h]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [edi+14h]
		inc	dword ptr [edi+10h]
		push	ecx
		call	ebp ; PR_Unlock
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10016D80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016E50	proc near		; CODE XREF: sub_1000BE20+B5p
					; sub_10017750+24p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	ebx
		mov	ebx, [eax+30h]
		push	ebp
		mov	ebp, [ebx+68h]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	eax, [edi+0Ch]
		mov	esi, eax
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		mov	ecx, eax
		imul	ecx, 6AC690C5h
		dec	ebp
		and	ebp, ecx
		and	esi, edi
		jz	loc_10016F34
		mov	ecx, [esi+34h]
		mov	[esp+10h+arg_0], ecx
		test	ecx, ecx
		jz	loc_10016F34
		mov	edx, [ecx+10h]
		push	edx
		call	ds:PR_Lock
		mov	eax, [esi+24h]
		xor	ecx, ecx
		add	esp, 4
		cmp	eax, ecx
		jz	short loc_10016EB5
		mov	edx, [esi+28h]
		mov	[eax+4], edx

loc_10016EB5:				; CODE XREF: sub_10016E50+5Dj
		mov	eax, [esi+28h]
		cmp	eax, ecx
		jz	short loc_10016EC3
		mov	edx, [esi+24h]
		mov	[eax], edx
		jmp	short loc_10016ECD
; ---------------------------------------------------------------------------

loc_10016EC3:				; CODE XREF: sub_10016E50+6Aj
		mov	eax, [esi+24h]
		mov	edx, [esp+10h+arg_0]
		mov	[edx+44h], eax

loc_10016ECD:				; CODE XREF: sub_10016E50+71j
		mov	eax, [esp+10h+arg_0]
		mov	[esi+24h], ecx
		mov	[esi+28h], ecx
		mov	ecx, [eax+10h]
		mov	esi, ds:PR_Unlock
		push	ecx
		call	esi ; PR_Unlock
		mov	edx, [ebx+14h]
		push	edx
		call	ds:PR_Lock
		mov	eax, [edi]
		add	esp, 8
		test	eax, eax
		jz	short loc_10016EFC
		mov	ecx, [edi+4]
		mov	[eax+4], ecx

loc_10016EFC:				; CODE XREF: sub_10016E50+A4j
		mov	eax, [edi+4]
		test	eax, eax
		jz	short loc_10016F09
		mov	edx, [edi]
		mov	[eax], edx
		jmp	short loc_10016F11
; ---------------------------------------------------------------------------

loc_10016F09:				; CODE XREF: sub_10016E50+B1j
		mov	eax, [ebx+64h]
		mov	ecx, [edi]
		mov	[eax+ebp*4], ecx

loc_10016F11:				; CODE XREF: sub_10016E50+B7j
		mov	edx, [ebx+14h]
		push	edx
		call	esi ; PR_Unlock
		push	edi
		mov	dword ptr [edi], 0
		mov	dword ptr [edi+4], 0
		call	sub_10016D30
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016F34:				; CODE XREF: sub_10016E50+34j
					; sub_10016E50+43j
		push	eax
		push	ebx
		call	sub_1001CE40
		mov	esi, eax
		mov	eax, [edi+0Ch]
		push	eax
		push	esi
		call	sub_1001BD80
		push	esi
		mov	edi, eax
		call	sub_1001CD90
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10016E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016F60	proc near		; CODE XREF: sub_10017020+13p
					; sub_10017020+2Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		cmp	[esp+10h+arg_C], ebp
		jbe	loc_10017006

loc_10016F70:				; CODE XREF: sub_10016F60+A0j
		mov	esi, [esp+10h+arg_8]
		mov	eax, [esi+ebp*4]
		mov	edi, [esp+10h+arg_0]
		push	eax
		push	edi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	short loc_10016FFB
		mov	ecx, [esi+ebp*4]
		mov	edx, [esp+10h+arg_4]
		push	ecx
		push	edx
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10016FFB
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+14h]
		mov	ebx, [esi+18h]
		push	eax
		push	ecx
		mov	eax, edi
		call	sub_10016590
		add	esp, 8
		cmp	dword ptr [esi+8], 0
		mov	edi, eax
		jz	short loc_10016FEE
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10016FE5
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_10016FD9
		mov	edx, [esi+1Ch]
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10016FD9:				; CODE XREF: sub_10016F60+68j
		mov	eax, [esi+18h]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10016FE5:				; CODE XREF: sub_10016F60+61j
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10016FEE:				; CODE XREF: sub_10016F60+5Bj
		test	edi, edi
		jz	short loc_1001700D
		mov	eax, [esp+10h+arg_0]
		call	sub_10016860

loc_10016FFB:				; CODE XREF: sub_10016F60+27j
					; sub_10016F60+3Ej
		inc	ebp
		cmp	ebp, [esp+10h+arg_C]
		jb	loc_10016F70

loc_10017006:				; CODE XREF: sub_10016F60+Aj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001700D:				; CODE XREF: sub_10016F60+90j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
sub_10016F60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017020	proc near		; CODE XREF: sub_10017310-9Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	6
		push	offset dword_100271E8
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	loc_100170EB
		push	8
		push	offset dword_10027280
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	loc_100170EB
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_10017076
		pop	edi
		mov	eax, 30h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017076:				; CODE XREF: sub_10017020+4Cj
		mov	ecx, [eax+18h]
		push	ebx
		mov	ebx, [ecx]
		push	eax
		call	sub_10015D70
		add	esp, 4
		cmp	ebx, 3		; switch 4 cases
		ja	short loc_100170E5 ; jumptable 1001708A	default	case
		jmp	ds:off_100170F0[ebx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10017091:				; CODE XREF: sub_10017020+6Aj
					; DATA XREF: .text:off_100170F0o
		push	8		; jumptable 1001708A case 0
		push	offset dword_100272A4
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100170A6:				; CODE XREF: sub_10017020+6Aj
					; DATA XREF: .text:off_100170F0o
		push	4		; jumptable 1001708A case 1
		push	offset dword_100272C8
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100170BB:				; CODE XREF: sub_10017020+6Aj
					; DATA XREF: .text:off_100170F0o
		push	3		; jumptable 1001708A case 2
		push	offset dword_100272DC
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100170D0:				; CODE XREF: sub_10017020+6Aj
					; DATA XREF: .text:off_100170F0o
		push	2		; jumptable 1001708A case 3
		push	offset dword_100272EC
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100170E5:				; CODE XREF: sub_10017020+68j
		mov	eax, 30h	; jumptable 1001708A default case
		pop	ebx

loc_100170EB:				; CODE XREF: sub_10017020+1Dj
					; sub_10017020+36j
		pop	edi
		pop	esi
		retn
sub_10017020	endp

; ---------------------------------------------------------------------------
		align 10h
off_100170F0	dd offset loc_10017091	; DATA XREF: sub_10017020+6Ar
		dd offset loc_100170A6	; jump table for switch	statement
		dd offset loc_100170BB
		dd offset loc_100170D0

; =============== S U B	R O U T	I N E =======================================


sub_10017100	proc near		; CODE XREF: sub_10017310-8Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	6
		push	offset dword_100271E8
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	loc_100171CB
		push	5
		push	offset dword_1002722C
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	loc_100171CB
		push	100h
		push	esi
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jnz	short loc_10017156
		pop	edi
		mov	eax, 30h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017156:				; CODE XREF: sub_10017100+4Cj
		mov	ecx, [eax+18h]
		push	ebx
		mov	ebx, [ecx]
		push	eax
		call	sub_10015D70
		add	esp, 4
		cmp	ebx, 3		; switch 4 cases
		ja	short loc_100171C5 ; jumptable 1001716A	default	case
		jmp	ds:off_100171D0[ebx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10017171:				; CODE XREF: sub_10017100+6Aj
					; DATA XREF: .text:off_100171D0o
		push	2		; jumptable 1001716A case 0
		push	offset dword_10027244
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017186:				; CODE XREF: sub_10017100+6Aj
					; DATA XREF: .text:off_100171D0o
		push	4		; jumptable 1001716A case 1
		push	offset dword_10027250
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001719B:				; CODE XREF: sub_10017100+6Aj
					; DATA XREF: .text:off_100171D0o
		push	3		; jumptable 1001716A case 2
		push	offset dword_10027264
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100171B0:				; CODE XREF: sub_10017100+6Aj
					; DATA XREF: .text:off_100171D0o
		push	2		; jumptable 1001716A case 3
		push	offset dword_10027274
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100171C5:				; CODE XREF: sub_10017100+68j
		mov	eax, 30h	; jumptable 1001716A default case
		pop	ebx

loc_100171CB:				; CODE XREF: sub_10017100+1Dj
					; sub_10017100+36j
		pop	edi
		pop	esi
		retn
sub_10017100	endp

; ---------------------------------------------------------------------------
		align 10h
off_100171D0	dd offset loc_10017171	; DATA XREF: sub_10017100+6Ar
		dd offset loc_10017186	; jump table for switch	statement
		dd offset loc_1001719B
		dd offset loc_100171B0

; =============== S U B	R O U T	I N E =======================================


sub_100171E0	proc near		; CODE XREF: sub_10017310-6Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	6
		push	offset dword_100271E8
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10017210
		push	9
		push	offset dword_10027204
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h

loc_10017210:				; CODE XREF: sub_100171E0+1Dj
		pop	edi
		pop	esi
		retn
sub_100171E0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_10017310

loc_10017220:				; CODE XREF: sub_10017310+2Bj
		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [eax+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		not	esi
		and	esi, eax
		jnz	short loc_10017243
		lea	eax, [esi+30h]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017243:				; CODE XREF: sub_10017310-D4j
		push	edi
		mov	edi, [esp+8+arg_0]
		push	5
		push	offset dword_100271D0
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		test	eax, eax
		jnz	loc_10017305
		mov	eax, [esi+8]
		cmp	eax, 4
		ja	short loc_100172AF
		jz	short loc_100172A2
		dec	eax
		jz	short loc_1001728E
		dec	eax
		jz	short loc_10017281
		dec	eax
		jnz	short loc_100172C4
		push	esi
		push	edi
		call	sub_10017020
		add	esp, 8
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017281:				; CODE XREF: sub_10017310-A1j
		push	esi
		push	edi
		call	sub_10017100
		add	esp, 8
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001728E:				; CODE XREF: sub_10017310-A4j
		push	5
		push	offset dword_100272F8
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100172A2:				; CODE XREF: sub_10017310-A7j
		push	esi
		push	edi
		call	sub_100171E0
		add	esp, 8
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100172AF:				; CODE XREF: sub_10017310-A9j
		cmp	eax, 0CE534351h
		jz	short loc_100172F4
		cmp	eax, 0CE534352h
		jz	short loc_100172E0
		cmp	eax, 0CE534353h
		jz	short loc_100172CC

loc_100172C4:				; CODE XREF: sub_10017310-9Ej
		pop	edi
		mov	eax, 30h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100172CC:				; CODE XREF: sub_10017310-4Ej
		push	9
		push	offset dword_10027310
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100172E0:				; CODE XREF: sub_10017310-55j
		push	4
		push	offset dword_10027338
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100172F4:				; CODE XREF: sub_10017310-5Cj
		push	4
		push	offset dword_1002734C
		push	esi
		push	edi
		call	sub_10016F60
		add	esp, 10h

loc_10017305:				; CODE XREF: sub_10017310-B5j
		pop	edi
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_10017310
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017310	proc near		; CODE XREF: sub_1000B920+153p
					; sub_100108A0+52p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

; FUNCTION CHUNK AT 10017220 SIZE 000000E8 BYTES

		sub	esp, 8
		mov	eax, [esp+8+arg_4]
		push	edi
		mov	edi, [eax+0Ch]
		and	edi, 80000000h
		sub	edi, 80000000h
		neg	edi
		sbb	edi, edi
		and	edi, eax
		mov	[esp+0Ch+var_8], edi
		jnz	short loc_10017340
		pop	edi
		add	esp, 8
		mov	[esp+arg_4], eax
		jmp	loc_10017220
; ---------------------------------------------------------------------------

loc_10017340:				; CODE XREF: sub_10017310+21j
		mov	ecx, [edi+30h]
		push	ebx
		push	ebp
		push	esi
		push	ecx
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [edi+0F08h], 0
		mov	[esp+18h+var_4], 0
		jbe	loc_10017449
		lea	edx, [edi+0F0Ch]
		mov	[esp+18h+arg_4], edx
		nop

loc_10017370:				; CODE XREF: sub_10017310+133j
		mov	eax, [esp+18h+arg_4]
		mov	ebp, [eax]
		test	ebp, ebp
		jz	loc_1001742F

loc_1001737E:				; CODE XREF: sub_10017310+119j
		mov	ecx, [ebp+10h]
		mov	esi, [esp+18h+arg_0]
		push	ecx
		push	esi
		call	sub_10016780
		add	esp, 8
		test	eax, eax
		jnz	loc_10017424
		mov	edx, [ebp+1Ch]
		mov	eax, [ebp+14h]
		mov	ebx, [ebp+18h]
		push	edx
		push	eax
		mov	eax, esi
		call	sub_10016590
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_10017460
		mov	esi, [esi+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		and	esi, [esp+18h+arg_0]
		jz	short loc_10017420
		mov	ecx, [esi+30h]
		push	ecx
		call	ds:PR_Lock
		mov	eax, [edi+10h]
		mov	edx, [esi+0F08h]
		imul	eax, 6AC690C5h
		dec	edx
		and	eax, edx
		mov	ecx, [esi+eax*4+0F0Ch]
		mov	[edi], ecx
		mov	dword ptr [edi+4], 0
		mov	ecx, [esi+eax*4+0F0Ch]
		add	esp, 4
		test	ecx, ecx
		jz	short loc_1001740C
		mov	[ecx+4], edi

loc_1001740C:				; CODE XREF: sub_10017310+F7j
		mov	[esi+eax*4+0F0Ch], edi
		mov	edx, [esi+30h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4

loc_10017420:				; CODE XREF: sub_10017310+BDj
		mov	edi, [esp+18h+var_8]

loc_10017424:				; CODE XREF: sub_10017310+81j
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	loc_1001737E

loc_1001742F:				; CODE XREF: sub_10017310+68j
		mov	eax, [esp+18h+var_4]
		add	[esp+18h+arg_4], 4
		inc	eax
		mov	[esp+18h+var_4], eax
		cmp	eax, [edi+0F08h]
		jb	loc_10017370

loc_10017449:				; CODE XREF: sub_10017310+4Fj
		mov	edx, [edi+30h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10017460:				; CODE XREF: sub_10017310+A0j
		mov	eax, [esp+18h+var_8]
		mov	ecx, [eax+30h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, 2
		pop	edi
		add	esp, 8
		retn
sub_10017310	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017480	proc near		; CODE XREF: sub_100175B0+4Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		cmp	[esp+4+arg_8], 0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+14h+var_4], 0
		jle	loc_10017559
		mov	ebx, [esp+14h+arg_4]
		add	ebx, 8
		nop

loc_100174A0:				; CODE XREF: sub_10017480+D3j
		mov	eax, [ebx-8]
		mov	ecx, [esp+14h+arg_0]
		push	eax
		push	ecx
		call	sub_10016660
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_1001759B
		mov	eax, [ebx]
		cmp	[edi+1Ch], eax
		jnz	loc_10017564
		mov	ebp, [edi+18h]
		mov	ecx, [ebx-4]
		mov	esi, ebp
		cmp	eax, 4
		jb	short loc_100174EB

loc_100174D3:				; CODE XREF: sub_10017480+69j
		mov	edx, [esi]
		cmp	edx, [ecx]
		jnz	loc_10017564
		sub	eax, 4
		add	ecx, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_100174D3

loc_100174EB:				; CODE XREF: sub_10017480+51j
		test	eax, eax
		jz	short loc_1001750F
		mov	dl, [ecx]
		cmp	dl, [esi]
		jnz	short loc_10017564
		cmp	eax, 1
		jbe	short loc_1001750F
		mov	dl, [ecx+1]
		cmp	dl, [esi+1]
		jnz	short loc_10017564
		cmp	eax, 2
		jbe	short loc_1001750F
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jnz	short loc_10017564

loc_1001750F:				; CODE XREF: sub_10017480+6Dj
					; sub_10017480+78j ...
		cmp	dword ptr [edi+8], 0
		jz	short loc_10017543
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_1001753A
		test	ebp, ebp
		jz	short loc_1001752E
		mov	eax, [edi+1Ch]
		push	eax		; Size
		push	0		; Val
		push	ebp		; Dst
		call	memset
		add	esp, 0Ch

loc_1001752E:				; CODE XREF: sub_10017480+9Dj
		mov	ecx, [edi+18h]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001753A:				; CODE XREF: sub_10017480+99j
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_10017543:				; CODE XREF: sub_10017480+93j
		mov	eax, [esp+14h+var_4]
		inc	eax
		add	ebx, 0Ch
		mov	[esp+14h+var_4], eax
		cmp	eax, [esp+14h+arg_8]
		jl	loc_100174A0

loc_10017559:				; CODE XREF: sub_10017480+12j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017564:				; CODE XREF: sub_10017480+40j
					; sub_10017480+57j ...
		cmp	dword ptr [edi+8], 0
		jz	short loc_1001759B
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_10017592
		mov	eax, [edi+18h]
		test	eax, eax
		jz	short loc_10017586
		mov	edx, [edi+1Ch]
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10017586:				; CODE XREF: sub_10017480+F5j
		mov	eax, [edi+18h]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10017592:				; CODE XREF: sub_10017480+EEj
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_1001759B:				; CODE XREF: sub_10017480+35j
					; sub_10017480+E8j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_10017480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100175B0	proc near		; CODE XREF: sub_10009A90+D2p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		push	esi
		xor	esi, esi
		mov	[esp+8+var_4], esi
		cmp	[esp+8+arg_8], esi
		jbe	loc_100176C5
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+14h+arg_0]
		lea	esp, [esp+0]

loc_100175D0:				; CODE XREF: sub_100175B0+10Cj
		mov	eax, [esp+14h+arg_C]
		push	eax
		call	ds:PR_Lock
		mov	ecx, [esp+18h+arg_4]
		mov	ebx, [ecx+esi*4]
		add	esp, 4
		test	ebx, ebx
		jz	loc_100176A5
		lea	ecx, [ecx+0]

loc_100175F0:				; CODE XREF: sub_100175B0+EBj
		mov	edx, [esp+14h+arg_14]
		mov	eax, [esp+14h+arg_10]
		push	edx
		push	eax
		push	ebx
		call	sub_10017480
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10017697
		cmp	[esp+14h+arg_18], 0
		jnz	short loc_10017661
		push	2
		push	ebx
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10017661
		cmp	dword ptr [esi+8], 0
		mov	eax, [esi+18h]
		movzx	ebp, byte ptr [eax]
		jz	short loc_1001765D
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10017654
		test	eax, eax
		jz	short loc_10017648
		mov	ecx, [esi+1Ch]
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10017648:				; CODE XREF: sub_100175B0+87j
		mov	edx, [esi+18h]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_10017654:				; CODE XREF: sub_100175B0+83j
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1001765D:				; CODE XREF: sub_100175B0+7Dj
		test	ebp, ebp
		jnz	short loc_10017697

loc_10017661:				; CODE XREF: sub_100175B0+60j
					; sub_100175B0+71j
		mov	ecx, [edi]
		mov	esi, [ebx+0Ch]
		test	ecx, ecx
		jz	short loc_10017697
		mov	eax, [edi+0Ch]
		cmp	[edi+4], eax
		jl	short loc_1001768C
		add	eax, 5
		mov	[edi+0Ch], eax
		add	eax, eax
		add	eax, eax
		push	eax
		push	ecx
		call	PORT_Realloc_Util
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jz	short loc_10017697

loc_1001768C:				; CODE XREF: sub_100175B0+C0j
		mov	ecx, [edi+4]
		mov	edx, [edi]
		mov	[edx+ecx*4], esi
		inc	dword ptr [edi+4]

loc_10017697:				; CODE XREF: sub_100175B0+55j
					; sub_100175B0+AFj ...
		mov	ebx, [ebx]
		test	ebx, ebx
		jnz	loc_100175F0
		mov	esi, [esp+14h+var_4]

loc_100176A5:				; CODE XREF: sub_100175B0+37j
		mov	eax, [esp+14h+arg_C]
		push	eax
		call	ds:PR_Unlock
		inc	esi
		add	esp, 4
		mov	[esp+14h+var_4], esi
		cmp	esi, [esp+14h+arg_8]
		jb	loc_100175D0
		pop	edi
		pop	ebp
		pop	ebx

loc_100176C5:				; CODE XREF: sub_100175B0+Cj
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_100175B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100176D0	proc near		; CODE XREF: sub_1000C4C0+800p
					; sub_1000CF70+B6p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+3Ch]
		test	eax, eax
		jz	short loc_100176E8
		push	1
		push	eax
		mov	eax, [edi+58h]
		call	eax
		add	esp, 8

loc_100176E8:				; CODE XREF: sub_100176D0+Bj
		mov	eax, [edi+40h]
		test	eax, eax
		jz	short loc_100176FA
		mov	ecx, [edi+5Ch]
		push	1
		push	eax
		call	ecx
		add	esp, 8

loc_100176FA:				; CODE XREF: sub_100176D0+1Dj
		mov	esi, [edi+68h]
		test	esi, esi
		jz	short loc_1001773D
		mov	edx, [esi+14h]
		push	ebx
		push	edx
		xor	ebx, ebx
		call	ds:PR_Lock
		mov	eax, [esi+10h]
		add	esp, 4
		cmp	eax, 1
		jnz	short loc_1001771B
		mov	ebx, eax

loc_1001771B:				; CODE XREF: sub_100176D0+47j
		dec	eax
		mov	[esi+10h], eax
		mov	eax, [esi+14h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		test	ebx, ebx
		pop	ebx
		jz	short loc_10017736
		call	sub_10016BF0

loc_10017736:				; CODE XREF: sub_100176D0+5Fj
		mov	dword ptr [edi+68h], 0

loc_1001773D:				; CODE XREF: sub_100176D0+2Fj
		push	edi
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	esi
		retn
sub_100176D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017750	proc near		; CODE XREF: sub_100177F0+3Ep
		mov	eax, [edi+44h]
		push	esi
		test	eax, eax
		jz	short loc_10017782
		jmp	short loc_10017760
; ---------------------------------------------------------------------------
		align 10h

loc_10017760:				; CODE XREF: sub_10017750+8j
					; sub_10017750+30j
		mov	esi, [eax]
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	eax, [eax+8]
		push	eax
		push	edi
		call	sub_10016E50
		add	esp, 8
		mov	eax, esi
		test	esi, esi
		jnz	short loc_10017760

loc_10017782:				; CODE XREF: sub_10017750+6j
		mov	ecx, [edi+10h]
		push	ecx
		call	ds:PR_DestroyLock
		mov	eax, [edi+38h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001779F
		push	eax
		call	sub_100176D0
		add	esp, 4

loc_1001779F:				; CODE XREF: sub_10017750+44j
		mov	eax, [edi+3Ch]
		test	eax, eax
		jz	short loc_100177AF
		push	eax
		call	sub_100176D0
		add	esp, 4

loc_100177AF:				; CODE XREF: sub_10017750+54j
		mov	eax, [edi+40h]
		test	eax, eax
		jz	short loc_100177BF
		push	eax
		call	sub_100176D0
		add	esp, 4

loc_100177BF:				; CODE XREF: sub_10017750+64j
		mov	esi, [edi+34h]
		test	esi, esi
		jz	short loc_100177DE
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100177D5
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_100177D5:				; CODE XREF: sub_10017750+7Aj
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_100177DE:				; CODE XREF: sub_10017750+74j
		push	edi
		call	PORT_Free_Util
		add	esp, 4
		pop	esi
		retn
sub_10017750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100177F0	proc near		; CODE XREF: sub_10008020+CCp
					; sub_10008A20+6Bp ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	eax, [edi+30h]
		mov	ecx, [eax+10h]
		and	ecx, [edi+8]
		mov	edx, [eax+8]
		mov	esi, [edx+ecx*4]
		push	esi
		xor	ebx, ebx
		call	ds:PR_Lock
		mov	eax, [edi+0Ch]
		add	esp, 4
		cmp	eax, 1
		jnz	short loc_1001781C
		mov	ebx, eax

loc_1001781C:				; CODE XREF: sub_100177F0+28j
		dec	eax
		push	esi
		mov	[edi+0Ch], eax
		call	ds:PR_Unlock
		add	esp, 4
		test	ebx, ebx
		jz	short loc_10017833
		call	sub_10017750

loc_10017833:				; CODE XREF: sub_100177F0+3Cj
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100177F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017840	proc near		; CODE XREF: sub_10009800+112p
					; sub_10017D10+23p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10029670
		sub	esp, 10h
		push	esi
		push	edi
		push	eax
		call	ds:PR_Lock
		mov	esi, dword_1002966C
		xor	edi, edi
		add	esp, 4
		cmp	esi, edi
		jz	short loc_1001786E
		mov	ecx, [esi]
		dec	dword_10029674
		mov	dword_1002966C,	ecx

loc_1001786E:				; CODE XREF: sub_10017840+1Ej
		mov	edx, dword_10029670
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		cmp	esi, edi
		jz	short loc_10017891
		mov	[esi+4], edi
		mov	[esi], edi
		mov	[esp+18h+var_10], 1
		jmp	short loc_100178A1
; ---------------------------------------------------------------------------

loc_10017891:				; CODE XREF: sub_10017840+40j
		push	30h
		mov	[esp+1Ch+var_10], edi
		call	PORT_ZAlloc_Util
		add	esp, 4
		mov	esi, eax

loc_100178A1:				; CODE XREF: sub_10017840+4Fj
		cmp	esi, edi
		jnz	short loc_100178AD
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100178AD:				; CODE XREF: sub_10017840+63j
		mov	edi, [esp+18h+arg_8]
		mov	eax, [esp+18h+arg_0]
		push	ebx
		push	ebp
		push	edi
		push	eax
		mov	[esi+0Ch], edi
		lea	ebx, [esi+8]
		call	sub_1001CE40
		push	1
		lea	ecx, [esp+2Ch+var_C]
		push	ecx
		mov	ebp, eax
		push	edi
		push	ebp
		mov	dword ptr [ebx], 0
		mov	[esp+38h+var_C], 0
		mov	[esp+38h+var_8], ebx
		mov	[esp+38h+var_4], 4
		call	sub_1001BB30
		push	ebp
		mov	edi, eax
		call	sub_1001CD90
		xor	ebx, ebx
		add	esp, 1Ch
		cmp	edi, ebx
		jnz	short loc_10017920
		mov	edx, [esp+20h+arg_0]
		mov	[esi+18h], edx
		mov	[esi+1Ch], ebx
		mov	[esi+20h], ebx
		cmp	[esp+20h+var_10], ebx
		jnz	short loc_1001791B
		call	ds:PR_NewLock
		mov	[esi+14h], eax

loc_1001791B:				; CODE XREF: sub_10017840+D0j
		cmp	[esi+14h], ebx
		jnz	short loc_1001792F

loc_10017920:				; CODE XREF: sub_10017840+BDj
		call	sub_10016BF0
		pop	ebp
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001792F:				; CODE XREF: sub_10017840+DEj
		pop	ebp
		pop	ebx
		pop	edi
		mov	dword ptr [esi+10h], 1
		mov	eax, esi
		pop	esi
		add	esp, 10h
		retn
sub_10017840	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017940	proc near		; CODE XREF: sub_1000A8F0+237p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, [edi+0Ch]
		and	esi, 80000000h
		sub	esi, 80000000h
		neg	esi
		sbb	esi, esi
		mov	eax, edi
		not	esi
		call	sub_10016320
		mov	eax, [edi+30h]
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4
		and	esi, edi
		jz	short loc_100179A7
		mov	ecx, [edi+18h]
		mov	edx, [ecx+14h]
		push	edx
		call	ds:PR_Lock
		mov	eax, [edi+0Ch]
		mov	ecx, [edi+18h]
		push	eax
		mov	eax, [ecx+60h]
		push	eax
		call	PL_HashTableLookup
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100179AC
		mov	ecx, [edi+18h]
		mov	edx, [ecx+14h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4

loc_100179A7:				; CODE XREF: sub_10017940+31j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100179AC:				; CODE XREF: sub_10017940+55j
		push	ebx
		push	eax
		lea	eax, [esi+24h]
		push	eax
		push	0
		call	SECITEM_CopyItem_Util
		mov	ecx, [edi+18h]
		mov	edx, [ecx+14h]
		push	edx
		mov	ebx, eax
		call	ds:PR_Unlock
		add	esp, 10h
		lea	eax, [ebx+1]
		neg	eax
		pop	ebx
		sbb	eax, eax
		pop	edi
		and	eax, esi
		pop	esi
		retn
sub_10017940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100179E0	proc near		; CODE XREF: sub_100075B0+186p
					; sub_1001FF90+E0p ...

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 8Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		mov	eax, [esp+8Ch+arg_0]
		push	ebx
		mov	ebx, [esp+90h+arg_4]
		mov	ecx, [ebx+0Ch]
		push	ebp
		mov	ebp, [esp+94h+arg_8]
		and	ecx, 80000000h
		push	esi
		mov	esi, [esp+98h+arg_C]
		sub	ecx, 80000000h
		push	edi
		xor	edi, edi
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		mov	[esp+9Ch+var_84], eax
		mov	[esp+9Ch+var_88], edi
		test	ebx, ecx
		jnz	short loc_10017A6C
		cmp	esi, edi
		jle	short loc_10017A65
		jmp	short loc_10017A40
; ---------------------------------------------------------------------------
		align 10h

loc_10017A40:				; CODE XREF: sub_100179E0+5Bj
					; sub_100179E0+83j
		mov	edx, [ebp+edi*8+0]
		mov	eax, [ebp+edi*8+4]
		mov	ecx, [esp+9Ch+var_84]
		push	edx
		push	ebx
		push	eax
		push	ecx
		call	sub_10016AD0
		add	esp, 10h
		test	eax, eax
		jnz	loc_10017BB0
		inc	edi
		cmp	edi, esi
		jl	short loc_10017A40

loc_10017A65:				; CODE XREF: sub_100179E0+59j
					; sub_100179E0+8Ej
		xor	eax, eax
		jmp	loc_10017BB0
; ---------------------------------------------------------------------------

loc_10017A6C:				; CODE XREF: sub_100179E0+55j
		cmp	esi, edi
		jz	short loc_10017A65
		cmp	esi, 0Ah
		jle	short loc_10017A97
		lea	edx, [esi+esi*2]
		add	edx, edx
		add	edx, edx
		push	edx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+9Ch+var_8C], eax
		test	eax, eax
		jnz	short loc_10017A9F

loc_10017A8D:				; CODE XREF: sub_100179E0+14Dj
		mov	edi, 2
		jmp	loc_10017B88
; ---------------------------------------------------------------------------

loc_10017A97:				; CODE XREF: sub_100179E0+93j
		lea	eax, [esp+9Ch+var_7C]
		mov	[esp+9Ch+var_8C], eax

loc_10017A9F:				; CODE XREF: sub_100179E0+ABj
		mov	ecx, [ebx+0Ch]
		mov	edx, [ebx+18h]
		push	ecx
		push	edx
		call	sub_1001CE40
		mov	edx, eax
		add	esp, 8
		mov	[esp+9Ch+var_88], edx
		test	edx, edx
		jnz	short loc_10017AC3
		mov	edi, 82h
		jmp	loc_10017B88
; ---------------------------------------------------------------------------

loc_10017AC3:				; CODE XREF: sub_100179E0+D7j
		xor	ecx, ecx
		test	esi, esi
		jle	short loc_10017AEC
		mov	eax, [esp+9Ch+var_8C]
		add	eax, 8

loc_10017AD0:				; CODE XREF: sub_100179E0+10Aj
		mov	edi, [ebp+ecx*8+0]
		mov	[eax-8], edi
		mov	dword ptr [eax-4], 0
		mov	dword ptr [eax], 0
		inc	ecx
		add	eax, 0Ch
		cmp	ecx, esi
		jl	short loc_10017AD0

loc_10017AEC:				; CODE XREF: sub_100179E0+E7j
		mov	eax, [esp+9Ch+var_8C]
		mov	ecx, [ebx+0Ch]
		push	esi
		push	eax
		push	ecx
		push	edx
		call	sub_1001BB30
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_10017B88
		mov	[esp+9Ch+var_80], eax
		test	esi, esi
		jle	short loc_10017B43
		mov	edi, [esp+9Ch+var_8C]
		add	edi, 4

loc_10017B18:				; CODE XREF: sub_100179E0+161j
		mov	edx, [edi+4]
		mov	eax, [esp+9Ch+var_84]
		push	edx
		push	eax
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jz	loc_10017A8D
		mov	eax, [esp+9Ch+var_80]
		inc	eax
		add	edi, 0Ch
		mov	[esp+9Ch+var_80], eax
		cmp	eax, esi
		jl	short loc_10017B18

loc_10017B43:				; CODE XREF: sub_100179E0+12Fj
		mov	ecx, [esp+9Ch+var_8C]
		mov	edx, [ebx+0Ch]
		mov	eax, [esp+9Ch+var_88]
		push	esi
		push	ecx
		push	edx
		push	eax
		call	sub_1001BB30
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_10017B88
		test	esi, esi
		jle	short loc_10017B88
		mov	eax, [esp+9Ch+var_8C]
		lea	ecx, [ebp+4]
		add	eax, 8
		mov	edi, edi

loc_10017B70:				; CODE XREF: sub_100179E0+1A6j
		mov	edx, [ecx]
		mov	ebx, [eax-4]
		mov	[edx+4], ebx
		mov	edx, [ecx]
		mov	ebx, [eax]
		add	eax, 0Ch
		add	ecx, 8
		dec	esi
		mov	[edx+8], ebx
		jnz	short loc_10017B70

loc_10017B88:				; CODE XREF: sub_100179E0+B2j
					; sub_100179E0+DEj ...
		mov	eax, [esp+9Ch+var_8C]
		lea	ecx, [esp+9Ch+var_7C]
		cmp	eax, ecx
		jz	short loc_10017B9D
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10017B9D:				; CODE XREF: sub_100179E0+1B2j
		mov	eax, [esp+9Ch+var_88]
		test	eax, eax
		jz	short loc_10017BAE
		push	eax
		call	sub_1001CD90
		add	esp, 4

loc_10017BAE:				; CODE XREF: sub_100179E0+1C3j
		mov	eax, edi

loc_10017BB0:				; CODE XREF: sub_100179E0+7Aj
					; sub_100179E0+87j
		mov	ecx, [esp+9Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
sub_100179E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017BD0(int,	int, void *Src,	size_t Size)
sub_10017BD0	proc near		; CODE XREF: sub_10007890+19Ep
					; sub_10007890+1CBp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ecx
		push	ebx
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		xor	ebx, ebx
		mov	[esp+0Ch+var_4], ebx
		cmp	edi, ebx
		jz	loc_10017D04
		cmp	[edi+10h], ebx
		jz	loc_10017D04
		cmp	[edi+18h], ebx
		jz	loc_10017D04
		mov	eax, [edi+0Ch]
		and	eax, 80000000h
		cmp	eax, 80000000h
		jnz	short loc_10017C23
		mov	ecx, [esp+0Ch+Size]
		mov	edx, [esp+0Ch+Src]
		mov	eax, [esp+0Ch+arg_4]
		push	ecx
		push	edx
		push	eax
		mov	eax, edi
		call	sub_10016A50
		add	esp, 0Ch
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017C23:				; CODE XREF: sub_10017BD0+34j
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		push	esi
		push	ebp
		push	edi
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10017C53
		mov	ecx, [esp+14h+Size]
		mov	edx, [esp+14h+Src]
		push	ecx
		push	edx
		push	ebp
		push	edi
		call	sub_10016BB0
		add	esp, 10h
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017C53:				; CODE XREF: sub_10017BD0+67j
		mov	edi, [esp+14h+Src]
		mov	ebp, [esp+14h+Size]
		test	edi, edi
		jz	short loc_10017CAA
		cmp	ebp, 32h
		ja	short loc_10017C69
		lea	ebx, [esi+20h]
		jmp	short loc_10017C7C
; ---------------------------------------------------------------------------

loc_10017C69:				; CODE XREF: sub_10017BD0+92j
		push	ebp
		call	PORT_Alloc_Util
		add	esp, 4
		mov	ebx, eax
		mov	[esp+14h+var_4], 1

loc_10017C7C:				; CODE XREF: sub_10017BD0+97j
		test	ebx, ebx
		jnz	short loc_10017C89
		pop	esi
		pop	ebp
		pop	edi
		lea	eax, [ebx+2]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017C89:				; CODE XREF: sub_10017BD0+AEj
		mov	eax, [esi+18h]
		cmp	eax, ebx
		jnz	short loc_10017C9F
		mov	ecx, [esi+1Ch]
		push	ecx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10017C9F:				; CODE XREF: sub_10017BD0+BEj
		push	ebp		; Size
		push	edi		; Src
		push	ebx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10017CAA:				; CODE XREF: sub_10017BD0+8Dj
		mov	eax, [esi+18h]
		xor	ecx, ecx
		cmp	eax, ecx
		jz	short loc_10017CE2
		cmp	eax, ebx
		jz	short loc_10017CC5
		mov	edx, [esi+1Ch]
		push	edx		; Size
		push	ecx		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10017CC5:				; CODE XREF: sub_10017BD0+E5j
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10017CD7
		mov	eax, [esi+18h]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10017CD7:				; CODE XREF: sub_10017BD0+F9j
		xor	ecx, ecx
		mov	[esi+0Ch], ecx
		mov	[esi+18h], ecx
		mov	[esi+1Ch], ecx

loc_10017CE2:				; CODE XREF: sub_10017BD0+E1j
		cmp	ebx, ecx
		jz	short loc_10017CF3
		mov	ecx, [esp+14h+var_4]
		mov	[esi+18h], ebx
		mov	[esi+1Ch], ebp
		mov	[esi+0Ch], ecx

loc_10017CF3:				; CODE XREF: sub_10017BD0+114j
		push	esi
		call	sub_10015D70
		add	esp, 4
		pop	esi
		pop	ebp
		pop	edi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017D04:				; CODE XREF: sub_10017BD0+Fj
					; sub_10017BD0+18j ...
		pop	edi
		mov	eax, 30h
		pop	ebx
		pop	ecx
		retn
sub_10017BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017D10	proc near		; CODE XREF: sub_10017DA0+Dp
		mov	eax, ebx
		imul	eax, 6AC690C5h
		push	esi
		mov	esi, [edi+68h]
		dec	esi
		mov	ecx, ebx
		and	ecx, 80000000h
		and	esi, eax
		cmp	ecx, 80000000h
		jnz	short loc_10017D3D
		push	ebx
		push	0
		push	edi
		call	sub_10017840
		add	esp, 0Ch
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017D3D:				; CODE XREF: sub_10017D10+1Dj
		mov	edx, [edi+14h]
		push	ebp
		mov	ebp, ds:PR_Lock
		push	edx
		call	ebp ; PR_Lock
		mov	eax, [edi+64h]
		mov	esi, [eax+esi*4]
		add	esp, 4
		test	esi, esi
		jz	short loc_10017D8A

loc_10017D57:				; CODE XREF: sub_10017D10+50j
		cmp	[esi+0Ch], ebx
		jz	short loc_10017D74
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10017D57
		mov	eax, [edi+14h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		pop	ebp
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017D74:				; CODE XREF: sub_10017D10+4Aj
		mov	ecx, [esi+14h]
		push	ecx
		call	ebp ; PR_Lock
		mov	edx, [esi+14h]
		inc	dword ptr [esi+10h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 8

loc_10017D8A:				; CODE XREF: sub_10017D10+45j
		mov	eax, [edi+14h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		pop	ebp
		mov	eax, esi
		pop	esi
		retn
sub_10017D10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017DA0	proc near		; CODE XREF: sub_10009390+124p
					; sub_100095C0+37p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	edi
		mov	edi, [eax+30h]
		call	sub_10017D10
		pop	edi
		pop	ebx
		retn
sub_10017DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017DC0	proc near		; CODE XREF: sub_10017E50+1Ep

var_109		= byte ptr -109h
var_108		= byte ptr -108h
var_4		= dword	ptr -4

		sub	esp, 108h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+108h+var_4], eax
		lea	eax, [esp+108h+var_108]
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetTempPathA
		cmp	eax, 104h
		ja	short loc_10017E2D
		test	eax, eax
		jz	short loc_10017E2D
		lea	eax, [esp+108h+var_108]
		lea	edx, [eax+1]

loc_10017DF4:				; CODE XREF: sub_10017DC0+39j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10017DF4
		sub	eax, edx
		jz	short loc_10017E2D
		cmp	[esp+eax+108h+var_109],	5Ch
		lea	eax, [esp+eax+108h+var_109]
		jnz	short loc_10017E0C
		mov	[eax], cl

loc_10017E0C:				; CODE XREF: sub_10017DC0+48j
		lea	ecx, [esp+108h+var_108]
		push	ecx
		call	PORT_Strdup_Util
		add	esp, 4
		mov	ecx, [esp+108h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 108h
		retn
; ---------------------------------------------------------------------------

loc_10017E2D:				; CODE XREF: sub_10017DC0+28j
					; sub_10017DC0+2Cj ...
		mov	ecx, [esp+108h+var_4]
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 108h
		retn
sub_10017DC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017E50	proc near		; CODE XREF: sub_10019E70+41Fp

Str		= dword	ptr -4

		push	ecx
		push	esi
		lea	eax, [esp+8+Str]
		push	eax
		xor	esi, esi
		push	10h
		push	esi
		push	ecx
		mov	[esp+18h+Str], esi
		call	sqlite3_file_control
		add	esp, 10h
		cmp	eax, 0Ch
		jnz	short loc_10017E76
		call	sub_10017DC0
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017E76:				; CODE XREF: sub_10017E50+1Cj
		test	eax, eax
		jz	short loc_10017E7F
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017E7F:				; CODE XREF: sub_10017E50+28j
		call	ds:PR_GetDirectorySeparator
		movsx	edx, al
		mov	eax, [esp+8+Str]
		push	edx		; Ch
		push	eax		; Str
		call	ds:strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_10017EAE
		mov	byte ptr [eax+1], 0
		mov	ecx, [esp+8+Str]
		push	ecx
		call	PORT_Strdup_Util
		add	esp, 4
		mov	esi, eax

loc_10017EAE:				; CODE XREF: sub_10017E50+49j
		mov	edx, [esp+8+Str]
		push	edx
		call	sqlite3_free
		add	esp, 4
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
sub_10017E50	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017EC0	proc near		; CODE XREF: sub_10018080+43p
					; sub_10018180+48p ...

arg_0		= dword	ptr  4

		cmp	eax, 65h	; switch 102 cases
		ja	short loc_10017EF8 ; jumptable 10017ECC	default	case
		movzx	eax, ds:byte_10017F18[eax]
		jmp	ds:off_10017F00[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10017ED3:				; CODE XREF: sub_10017EC0+Cj
					; DATA XREF: .text:off_10017F00o
		xor	eax, eax	; jumptable 10017ECC cases 0,101
		retn
; ---------------------------------------------------------------------------

loc_10017ED6:				; CODE XREF: sub_10017EC0+Cj
					; DATA XREF: .text:off_10017F00o
		mov	eax, 2		; jumptable 10017ECC case 7
		retn
; ---------------------------------------------------------------------------

loc_10017EDC:				; CODE XREF: sub_10017EC0+Cj
					; DATA XREF: .text:off_10017F00o
		mov	eax, 0E2h	; jumptable 10017ECC case 8
		retn
; ---------------------------------------------------------------------------

loc_10017EE2:				; CODE XREF: sub_10017EC0+Cj
					; DATA XREF: .text:off_10017F00o
		xor	eax, eax	; jumptable 10017ECC cases 3,12,14,23
		cmp	[esp+arg_0], 1
		setnz	al
		add	eax, 0CE534351h
		retn
; ---------------------------------------------------------------------------

loc_10017EF2:				; CODE XREF: sub_10017EC0+Cj
					; DATA XREF: .text:off_10017F00o
		mov	eax, 30h	; jumptable 10017ECC case 10
		retn
; ---------------------------------------------------------------------------

loc_10017EF8:				; CODE XREF: sub_10017EC0+3j
					; sub_10017EC0+Cj
					; DATA XREF: ...
		mov	eax, 5		; jumptable 10017ECC default case
		retn
sub_10017EC0	endp

; ---------------------------------------------------------------------------
		align 10h
off_10017F00	dd offset loc_10017ED3,	offset loc_10017EE2, offset loc_10017ED6
					; DATA XREF: sub_10017EC0+Cr
		dd offset loc_10017EDC,	offset loc_10017EF2, offset loc_10017EF8 ; jump	table for switch statement
byte_10017F18	db	0,     5,     5,     1 ; DATA XREF: sub_10017EC0+5r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		db 12h dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_10017F90	proc near		; CODE XREF: sub_10019E70+42Fp
					; sub_1001A510+BDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		push	21h
		call	ds:PR_MillisecondsToInterval
		mov	ebp, [esp+0Ch+arg_0]
		add	esp, 4
		mov	[esp+8+var_4], eax
		test	ebp, ebp
		jnz	short loc_10017FAF
		lea	eax, [ebp+1]
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017FAF:				; CODE XREF: sub_10017F90+17j
		mov	eax, ebp
		lea	edx, [eax+1]

loc_10017FB4:				; CODE XREF: sub_10017F90+29j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10017FB4
		push	ebx
		push	esi
		sub	eax, edx
		mov	esi, eax
		push	edi
		lea	edi, [esi+1Eh]
		push	edi
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_1001806C
		mov	edx, ebx
		mov	eax, ebp
		sub	edx, ebp
		mov	edi, edi

loc_10017FE0:				; CODE XREF: sub_10017F90+58j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10017FE0
		mov	ebp, ds:PR_GetDirectorySeparator
		call	ebp ; PR_GetDirectorySeparator
		mov	ecx, [esp+14h+arg_0]
		cmp	[esi+ecx-1], al
		jz	short loc_10018002
		call	ebp ; PR_GetDirectorySeparator
		mov	[ebx+esi], al
		inc	esi

loc_10018002:				; CODE XREF: sub_10017F90+6Aj
		sub	edi, esi
		lea	ebp, [ebx+esi]
		mov	[esp+14h+arg_0], edi
		call	ds:PR_IntervalNow
		mov	esi, eax
		xor	edi, edi
		jmp	short loc_10018020
; ---------------------------------------------------------------------------
		align 10h

loc_10018020:				; CODE XREF: sub_10017F90+85j
					; sub_10017F90+CBj
		mov	eax, [esp+14h+arg_0]
		push	offset a_doesnotexist_ ; "_dOeSnotExist_.db"
		lea	edx, [edi+esi]
		push	edx
		push	offset a_LuS	; ".%lu%s"
		push	eax
		push	ebp
		call	ds:PR_snprintf
		push	1
		push	ebx
		call	ds:PR_Access
		add	esp, 1Ch
		call	ds:PR_IntervalNow
		sub	eax, esi
		cmp	eax, [esp+14h+var_4]
		jnb	short loc_1001805D
		inc	edi
		cmp	edi, 2710h
		jb	short loc_10018020

loc_1001805D:				; CODE XREF: sub_10017F90+C2j
		push	ebx
		call	PORT_Free_Util
		add	esp, 4
		mov	eax, edi
		test	edi, edi
		jnz	short loc_10018071

loc_1001806C:				; CODE XREF: sub_10017F90+42j
		mov	eax, 1

loc_10018071:				; CODE XREF: sub_10017F90+DAj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		pop	ecx
		retn
sub_10017F90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018080	proc near		; CODE XREF: sub_10018180+60p
					; sub_10019E70+494p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	eax
		mov	esi, ecx
		push	esi
		push	offset aCreateTemporar ; "CREATE TEMPORARY TABLE %s AS SELECT *	F"...
		call	sqlite3_mprintf
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1001809F
		pop	esi
		lea	eax, [ebx+2]
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001809F:				; CODE XREF: sub_10018080+17j
		push	ebp
		push	0
		push	0
		push	0
		push	ebx
		push	edi
		call	sqlite3_exec
		push	ebx
		mov	ebp, eax
		call	sqlite3_free
		add	esp, 18h
		test	ebp, ebp
		jz	short loc_100180CF
		mov	ecx, [esp+0Ch+arg_0]
		push	ecx
		mov	eax, ebp
		call	sub_10017EC0
		add	esp, 4
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100180CF:				; CODE XREF: sub_10018080+3Aj
		push	esi
		push	offset aCreateIndexIss ; "CREATE INDEX issuer ON %s (a81)"
		call	sqlite3_mprintf
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_10018172
		push	0
		push	0
		push	0
		push	ebx
		push	edi
		call	sqlite3_exec
		push	ebx
		call	sqlite3_free
		push	esi
		push	offset aCreateIndexSub ; "CREATE INDEX subject ON %s (a101)"
		call	sqlite3_mprintf
		mov	ebx, eax
		add	esp, 20h
		test	ebx, ebx
		jz	short loc_10018172
		push	0
		push	0
		push	0
		push	ebx
		push	edi
		call	sqlite3_exec
		push	ebx
		call	sqlite3_free
		push	esi
		push	offset aCreateIndexLab ; "CREATE INDEX label ON	%s (a3)"
		call	sqlite3_mprintf
		mov	ebx, eax
		add	esp, 20h
		test	ebx, ebx
		jz	short loc_10018172
		push	0
		push	0
		push	0
		push	ebx
		push	edi
		call	sqlite3_exec
		push	ebx
		call	sqlite3_free
		push	esi
		push	offset aCreateIndexCka ; "CREATE INDEX ckaid ON	%s (a102)"
		call	sqlite3_mprintf
		mov	esi, eax
		add	esp, 20h
		test	esi, esi
		jz	short loc_10018172
		push	0
		push	0
		push	0
		push	esi
		push	edi
		call	sqlite3_exec
		push	esi
		call	sqlite3_free
		add	esp, 18h

loc_10018172:				; CODE XREF: sub_10018080+61j
					; sub_10018080+8Cj ...
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10018080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018180	proc near		; CODE XREF: sub_10018200+5Ep
					; sub_100195E0+DFp
		mov	eax, [esi+20h]
		push	edi
		push	eax
		push	offset aDropTableS ; "DROP TABLE %s"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001819D
		lea	eax, [edi+2]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001819D:				; CODE XREF: sub_10018180+16j
		mov	ecx, [esi+0Ch]
		push	ebx
		push	0
		push	0
		push	0
		push	edi
		push	ecx
		call	sqlite3_exec
		push	edi
		mov	ebx, eax
		call	sqlite3_free
		add	esp, 18h
		test	ebx, ebx
		jz	short loc_100181D3
		cmp	ebx, 1
		jz	short loc_100181D3
		mov	edx, [esi+18h]
		push	edx
		mov	eax, ebx
		call	sub_10017EC0
		add	esp, 4
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100181D3:				; CODE XREF: sub_10018180+3Bj
					; sub_10018180+40j
		mov	eax, [esi+18h]
		mov	ecx, [esi+20h]
		mov	edi, [esi+0Ch]
		push	eax
		mov	eax, [esi+1Ch]
		call	sub_10018080
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100181F7
		call	ds:PR_IntervalNow
		mov	[esi+10h], eax

loc_100181F7:				; CODE XREF: sub_10018180+6Cj
		pop	ebx
		mov	eax, edi
		pop	edi
		retn
sub_10018180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018200	proc near		; CODE XREF: sub_10018320+2Ep
					; sub_10018850+32p
		push	esi
		mov	esi, eax
		mov	dword ptr [ebx], 0
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4
		test	edi, edi
		jz	short loc_1001821F
		mov	ecx, [esi+1Ch]
		mov	[edi], ecx

loc_1001821F:				; CODE XREF: sub_10018200+18j
		cmp	dword ptr [esi+4], 0
		jz	short loc_10018246
		call	ds:PR_GetCurrentThread
		cmp	[esi+8], eax
		jnz	short loc_10018246
		mov	edx, [esi+4]
		mov	[ebx], edx
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018246:				; CODE XREF: sub_10018200+23j
					; sub_10018200+2Ej
		test	edi, edi
		jz	short loc_10018268
		cmp	dword ptr [esi+20h], 0
		jz	short loc_10018268
		call	ds:PR_IntervalNow
		sub	eax, [esi+10h]
		cmp	eax, [esi+14h]
		jbe	short loc_10018263
		call	sub_10018180

loc_10018263:				; CODE XREF: sub_10018200+5Cj
		mov	ecx, [esi+20h]
		mov	[edi], ecx

loc_10018268:				; CODE XREF: sub_10018200+48j
					; sub_10018200+4Ej
		mov	edx, [esi+0Ch]
		mov	[ebx], edx
		xor	eax, eax
		pop	esi
		retn
sub_10018200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018280	proc near		; CODE XREF: sub_10019740+80p

var_4		= dword	ptr -4

		push	ecx
		mov	eax, [esi]
		push	edi
		lea	ecx, [esp+8+var_4]
		push	ecx
		push	eax
		mov	[esp+10h+var_4], 0
		call	sqlite3_open
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_100182C5
		mov	edx, [esp+8+var_4]
		push	3E8h
		push	edx
		call	sqlite3_busy_timeout
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_100182CA
		mov	eax, [esp+8+var_4]
		push	eax
		call	sqlite3_close
		add	esp, 4

loc_100182C5:				; CODE XREF: sub_10018280+1Ej
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100182CA:				; CODE XREF: sub_10018280+36j
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_EnterMonitor
		mov	eax, [ebx]
		add	esp, 4
		cmp	[esi+0Ch], eax
		jnz	short loc_100182E7
		mov	edx, [esp+8+var_4]
		mov	[esi+0Ch], edx
		jmp	short loc_100182F3
; ---------------------------------------------------------------------------

loc_100182E7:				; CODE XREF: sub_10018280+5Cj
		cmp	[esi+4], eax
		jnz	short loc_100182F3
		mov	eax, [esp+8+var_4]
		mov	[esi+4], eax

loc_100182F3:				; CODE XREF: sub_10018280+65j
					; sub_10018280+6Aj
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		mov	edx, [ebx]
		push	edx
		call	sqlite3_close
		mov	eax, [esp+10h+var_4]
		add	esp, 8
		mov	[ebx], eax
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
sub_10018280	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018320	proc near		; DATA XREF: sub_10019E70+517o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_0]
		mov	eax, [eax]
		mov	edx, [esp+10h+arg_C]
		push	ebx
		push	ebp
		xor	ecx, ecx
		push	esi
		push	edi
		lea	edi, [esp+20h+var_8]
		lea	ebx, [esp+20h+var_C]
		mov	[esp+20h+var_4], eax
		mov	[esp+20h+var_C], ecx
		mov	[esp+20h+arg_0], ecx
		mov	ebp, offset word_10026FE6
		mov	[edx], ecx
		call	sub_10018200
		mov	esi, eax
		test	esi, esi
		jnz	loc_100184D8
		push	ebp
		call	sqlite3_mprintf
		mov	esi, eax
		add	esp, 4
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_100183BA ; jumptable 10018473	case 7
		mov	eax, [esp+20h+arg_4]
		mov	[esp+20h+var_10], eax

loc_10018376:				; CODE XREF: sub_10018320+8Cj
		mov	eax, [esp+20h+arg_8]
		cmp	ebx, eax
		jnb	short loc_100183B6
		mov	ecx, [esp+20h+var_10]
		mov	edx, [ecx]
		push	ebx
		push	edx
		push	ebp
		push	esi
		push	offset aSSaXDataD ; "%s%sa%x=$DATA%d"
		call	sqlite3_mprintf
		push	esi
		mov	edi, eax
		mov	ebp, offset aAnd ; " AND "
		call	sqlite3_free
		add	[esp+38h+var_10], 0Ch
		add	esp, 18h
		inc	ebx
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10018376
		lea	esi, [edi+2]
		jmp	loc_100184D8
; ---------------------------------------------------------------------------

loc_100183B6:				; CODE XREF: sub_10018320+5Cj
		test	esi, esi
		jnz	short loc_100183C4

loc_100183BA:				; CODE XREF: sub_10018320+4Cj
					; sub_10018320+153j
					; DATA XREF: ...
		mov	esi, 2		; jumptable 10018473 case 7
		jmp	loc_100184D8
; ---------------------------------------------------------------------------

loc_100183C4:				; CODE XREF: sub_10018320+98j
		test	eax, eax
		jnz	short loc_100183DC
		mov	eax, [esp+20h+var_8]
		push	eax
		push	offset aSelectAllFro_0 ; "SELECT ALL * FROM %s;"
		call	sqlite3_mprintf
		add	esp, 8
		jmp	short loc_100183EF
; ---------------------------------------------------------------------------

loc_100183DC:				; CODE XREF: sub_10018320+A6j
		mov	ecx, [esp+20h+var_8]
		push	esi
		push	ecx
		push	offset aSelectAllFro_1 ; "SELECT ALL * FROM %s WHERE %s;"
		call	sqlite3_mprintf
		add	esp, 0Ch

loc_100183EF:				; CODE XREF: sub_10018320+BAj
		push	esi
		mov	ebx, eax
		call	sqlite3_free
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10018406
		lea	esi, [ebx+2]
		jmp	loc_100184D8
; ---------------------------------------------------------------------------

loc_10018406:				; CODE XREF: sub_10018320+DCj
		mov	ebp, [esp+20h+var_C]
		push	0
		lea	edx, [esp+24h+arg_0]
		push	edx
		push	0FFFFFFFFh
		push	ebx
		push	ebp
		call	sqlite3_prepare_v2
		push	ebx
		mov	edi, eax
		call	sqlite3_free
		add	esp, 18h
		xor	esi, esi
		test	edi, edi
		jnz	short loc_10018467
		mov	ebx, [esp+20h+arg_4]
		add	ebx, 8

loc_10018432:				; CODE XREF: sub_10018320+145j
		cmp	esi, [esp+20h+arg_8]
		jnb	short loc_1001847A
		mov	eax, [ebx]
		mov	ecx, [ebx-4]
		test	eax, eax
		jnz	short loc_1001844B
		mov	eax, 3
		mov	ecx, offset dword_10027530

loc_1001844B:				; CODE XREF: sub_10018320+11Fj
		push	0FFFFFFFFh
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	ecx
		inc	esi
		push	esi
		push	eax
		call	sqlite3_bind_blob
		mov	edi, eax
		add	esp, 14h
		add	ebx, 0Ch
		test	edi, edi
		jz	short loc_10018432

loc_10018467:				; CODE XREF: sub_10018320+109j
					; sub_10018320+15Cj
		cmp	edi, 65h	; switch 102 cases
		ja	short loc_100184D3 ; jumptable 10018473	default	case
		movzx	ecx, ds:byte_10018534[edi]
		jmp	ds:off_1001851C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001847A:				; CODE XREF: sub_10018320+116j
		test	edi, edi
		jnz	short loc_10018467
		push	8
		call	PORT_Alloc_Util
		mov	ecx, [esp+24h+arg_C]
		add	esp, 4
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10018497
		lea	esi, [edi+2]
		jmp	short loc_100184D8
; ---------------------------------------------------------------------------

loc_10018497:				; CODE XREF: sub_10018320+170j
		mov	edx, [esp+20h+arg_0]
		mov	[eax+4], edx
		mov	eax, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ebp
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100184AC:				; CODE XREF: sub_10018320+153j
					; DATA XREF: .text:off_1001851Co
		xor	esi, esi	; jumptable 10018473 cases 0,101
		jmp	short loc_100184D8
; ---------------------------------------------------------------------------

loc_100184B0:				; CODE XREF: sub_10018320+153j
					; DATA XREF: .text:off_1001851Co
		mov	esi, 0E2h	; jumptable 10018473 case 8
		jmp	short loc_100184D8
; ---------------------------------------------------------------------------

loc_100184B7:				; CODE XREF: sub_10018320+153j
					; DATA XREF: .text:off_1001851Co
		mov	eax, [esp+20h+var_4] ; jumptable 10018473 cases	3,12,14,23
		xor	edx, edx
		cmp	dword ptr [eax+18h], 1
		setnz	dl
		lea	esi, [edx-31ACBCAFh]
		jmp	short loc_100184D8
; ---------------------------------------------------------------------------

loc_100184CC:				; CODE XREF: sub_10018320+153j
					; DATA XREF: .text:off_1001851Co
		mov	esi, 30h	; jumptable 10018473 case 10
		jmp	short loc_100184D8
; ---------------------------------------------------------------------------

loc_100184D3:				; CODE XREF: sub_10018320+14Aj
					; sub_10018320+153j
					; DATA XREF: ...
		mov	esi, 5		; jumptable 10018473 default case

loc_100184D8:				; CODE XREF: sub_10018320+37j
					; sub_10018320+91j ...
		mov	eax, [esp+20h+arg_0]
		test	eax, eax
		jz	short loc_100184F3
		push	eax
		call	sqlite3_reset
		mov	ecx, [esp+24h+arg_0]
		push	ecx
		call	sqlite3_finalize
		add	esp, 8

loc_100184F3:				; CODE XREF: sub_10018320+1BEj
		mov	ecx, [esp+20h+var_C]
		test	ecx, ecx
		jz	short loc_10018511
		mov	eax, [esp+20h+var_4]
		cmp	[eax+4], ecx
		jz	short loc_10018511
		mov	edx, [eax+24h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10018511:				; CODE XREF: sub_10018320+1D9j
					; sub_10018320+1E2j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_10018320	endp

; ---------------------------------------------------------------------------
		align 4
off_1001851C	dd offset loc_100184AC,	offset loc_100184B7, offset loc_100183BA
					; DATA XREF: sub_10018320+153r
		dd offset loc_100184B0,	offset loc_100184CC, offset loc_100184D3 ; jump	table for switch statement
byte_10018534	db	0,     5,     5,     1 ; DATA XREF: sub_10018320+14Cr
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

loc_100185A0:				; DATA XREF: sub_10019E70+51Eo
		push	ecx
		mov	eax, [esp+8]
		mov	ecx, [eax]
		mov	edx, [esp+0Ch]
		push	ebp
		mov	ebp, [edx+4]
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, [esp+24h]
		mov	[esp+0Ch], ecx
		mov	[edi], esi
		cmp	[esp+20h], esi
		jnz	short loc_100185CA
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100185CA:				; CODE XREF: .text:100185C1j
		push	ebx
		mov	ebx, [esp+20h]
		nop

loc_100185D0:				; CODE XREF: .text:100185F7j
		push	ebp
		call	sqlite3_step
		add	esp, 4
		mov	[esp+18h], eax
		cmp	eax, 5
		jnz	short loc_10018623
		push	eax
		call	ds:PR_Sleep
		inc	esi
		add	esp, 4
		cmp	esi, 0Ah
		jge	short loc_10018611

loc_100185F2:				; CODE XREF: .text:10018640j
		cmp	dword ptr [esp+24h], 0
		ja	short loc_100185D0
		mov	eax, [esp+18h]
		cmp	eax, 64h
		jnz	short loc_10018642
		cmp	dword ptr [esp+24h], 0
		jnz	short loc_10018615
		mov	dword ptr [esp+18h], 65h

loc_10018611:				; CODE XREF: .text:100185F0j
		mov	eax, [esp+18h]

loc_10018615:				; CODE XREF: .text:10018607j
					; .text:10018645j
		movzx	eax, ds:byte_100186AC[eax]
		jmp	ds:off_10018694[eax*4]
; ---------------------------------------------------------------------------

loc_10018623:				; CODE XREF: .text:100185E0j
		cmp	eax, 64h
		jnz	short loc_10018642
		push	0
		push	ebp
		call	sqlite3_column_int
		dec	dword ptr [esp+2Ch]
		mov	[ebx], eax
		inc	dword ptr [edi]
		add	esp, 8
		add	ebx, 4
		xor	esi, esi
		jmp	short loc_100185F2
; ---------------------------------------------------------------------------

loc_10018642:				; CODE XREF: .text:10018600j
					; .text:10018626j
		cmp	eax, 65h
		jbe	short loc_10018615

loc_10018647:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:100186A8o
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 5
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018652:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:off_10018694o
		pop	ebx
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001865A:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:1001869Co
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 2
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018665:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:100186A0o
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 0E2h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018670:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:10018698o
		mov	ecx, [esp+10h]
		xor	eax, eax
		cmp	dword ptr [ecx+18h], 1
		pop	ebx
		setnz	al
		pop	edi
		pop	esi
		pop	ebp
		add	eax, 0CE534351h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018688:				; CODE XREF: .text:1001861Cj
					; DATA XREF: .text:100186A4o
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 30h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 4
off_10018694	dd offset loc_10018652	; DATA XREF: .text:1001861Cr
		dd offset loc_10018670
		dd offset loc_1001865A
		dd offset loc_10018665
		dd offset loc_10018688
		dd offset loc_10018647
byte_100186AC	db 0			; DATA XREF: .text:loc_10018615r
		db 2 dup(5), 1
		dd 2050505h, 5040503h, 5010501h, 5050505h, 1050505h, 13h dup(5050505h)
		dd 0CCCC0005h, 3 dup(0CCCCCCCCh)
; ---------------------------------------------------------------------------

loc_10018720:				; DATA XREF: sub_10019E70+525o
		mov	eax, [esp+4]
		mov	eax, [eax]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h]
		mov	esi, [edi+4]
		mov	ebx, [edi]
		xor	ebp, ebp
		mov	[esp+14h], eax
		test	esi, esi
		jz	short loc_10018752
		push	esi
		call	sqlite3_reset
		push	esi
		call	sqlite3_finalize
		mov	ebp, eax
		mov	eax, [esp+1Ch]
		add	esp, 8

loc_10018752:				; CODE XREF: .text:1001873Bj
		test	ebx, ebx
		jz	short loc_10018768
		cmp	[eax+4], ebx
		jz	short loc_10018768
		mov	ecx, [eax+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10018768:				; CODE XREF: .text:10018754j
					; .text:10018759j
		push	edi
		call	PORT_Free_Util
		add	esp, 4
		cmp	ebp, 65h	; switch 102 cases
		ja	short loc_100187C0 ; jumptable 1001877D	default	case
		movzx	edx, ss:byte_100187E4[ebp]
		jmp	ds:off_100187CC[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10018784:				; CODE XREF: .text:1001877Dj
					; DATA XREF: .text:off_100187CCo
		pop	edi		; jumptable 1001877D cases 0,101
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001878B:				; CODE XREF: .text:1001877Dj
					; DATA XREF: .text:off_100187CCo
		pop	edi		; jumptable 1001877D case 7
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018795:				; CODE XREF: .text:1001877Dj
					; DATA XREF: .text:off_100187CCo
		pop	edi		; jumptable 1001877D case 8
		pop	esi
		pop	ebp
		mov	eax, 0E2h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001879F:				; CODE XREF: .text:1001877Dj
					; DATA XREF: .text:off_100187CCo
		mov	ecx, [esp+14h]	; jumptable 1001877D cases 3,12,14,23
		xor	eax, eax
		cmp	dword ptr [ecx+18h], 1
		pop	edi
		setnz	al
		pop	esi
		pop	ebp
		pop	ebx
		add	eax, 0CE534351h
		retn
; ---------------------------------------------------------------------------

loc_100187B6:				; CODE XREF: .text:1001877Dj
					; DATA XREF: .text:off_100187CCo
		pop	edi		; jumptable 1001877D case 10
		pop	esi
		pop	ebp
		mov	eax, 30h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100187C0:				; CODE XREF: .text:10018774j
					; .text:1001877Dj
					; DATA XREF: ...
		pop	edi		; jumptable 1001877D default case
		pop	esi
		pop	ebp
		mov	eax, 5
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 4
off_100187CC	dd offset loc_10018784,	offset loc_1001879F, offset loc_1001878B
					; DATA XREF: .text:1001877Dr
		dd offset loc_10018795,	offset loc_100187B6, offset loc_100187C0 ; jump	table for switch statement
byte_100187E4	db	0,     5,     5,     1 ; DATA XREF: .text:10018776r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018850	proc near		; CODE XREF: .text:10018B8Dj
					; sub_10018EB0+51p ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	ecx, [eax]
		xor	eax, eax
		push	ebx
		push	ebp
		push	edi
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_10], eax
		mov	[esp+28h+var_8], eax
		mov	[esp+28h+var_18], eax
		lea	edi, [esp+28h+var_10]
		lea	ebx, [esp+28h+var_14]
		mov	eax, ecx
		mov	[esp+28h+var_4], ecx
		xor	ebp, ebp
		call	sub_10018200
		mov	[esp+28h+arg_0], eax
		test	eax, eax
		jnz	loc_10018AB1
		push	esi
		mov	[esp+2Ch+var_C], ebp
		cmp	[esp+2Ch+arg_C], ebp
		jbe	loc_10018A39
		mov	ebx, [esp+2Ch+arg_8]
		add	ebx, 8
		lea	esp, [esp+0]

loc_100188B0:				; CODE XREF: sub_10018850+1D6j
		mov	ecx, [ebx-8]
		push	ecx
		push	offset aAX	; "a%x"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_10018A47
		mov	edx, [esp+2Ch+var_10]
		push	edx
		push	edi
		push	offset aSelectAllSFrom ; "SELECT ALL %s	FROM %s	WHERE id=$ID;"
		call	sqlite3_mprintf
		push	edi
		mov	esi, eax
		call	sqlite3_free
		xor	edi, edi
		add	esp, 10h
		cmp	esi, edi
		jz	loc_10018A47
		mov	ecx, [esp+2Ch+var_14]
		push	edi
		lea	eax, [esp+30h+var_1C]
		push	eax
		push	0FFFFFFFFh
		push	esi
		push	ecx
		call	sqlite3_prepare_v2
		push	esi
		mov	ebp, eax
		call	sqlite3_free
		add	esp, 18h
		cmp	ebp, 1
		jnz	short loc_10018926
		mov	dword ptr [ebx], 0FFFFFFFFh
		mov	[esp+2Ch+arg_0], 12h
		jmp	loc_10018A16
; ---------------------------------------------------------------------------

loc_10018926:				; CODE XREF: sub_10018850+C1j
		cmp	ebp, edi
		jnz	loc_10018A2E
		mov	edx, [esp+2Ch+arg_4]
		mov	eax, [esp+2Ch+var_1C]
		push	edx
		push	1
		push	eax
		call	sqlite3_bind_int
		mov	ebp, eax
		add	esp, 0Ch
		cmp	ebp, edi
		jnz	loc_10018A2E
		lea	esp, [esp+0]

loc_10018950:				; CODE XREF: sub_10018850+12Aj
					; sub_10018850+18Ej
		mov	ecx, [esp+2Ch+var_1C]
		push	ecx
		call	sqlite3_step
		mov	ebp, eax
		add	esp, 4
		cmp	ebp, 5
		jnz	short loc_1001897E
		push	eax
		call	ds:PR_Sleep
		mov	eax, [esp+30h+var_18]
		inc	eax
		add	esp, 4
		mov	[esp+2Ch+var_18], eax
		cmp	eax, 0Ah
		jl	short loc_10018950
		jmp	short loc_100189FB
; ---------------------------------------------------------------------------

loc_1001897E:				; CODE XREF: sub_10018850+112j
		cmp	ebp, 64h
		jnz	short loc_100189FB
		mov	edx, [esp+2Ch+var_1C]
		push	edi
		push	edx
		call	sqlite3_column_bytes
		mov	esi, eax
		mov	eax, [esp+34h+var_1C]
		push	edi
		push	eax
		call	sqlite3_column_blob
		add	esp, 10h
		cmp	eax, edi
		jz	short loc_100189E3
		cmp	esi, 3
		jnz	short loc_100189BA
		cmp	byte ptr [eax],	0A5h
		jnz	short loc_100189BA
		cmp	byte ptr [eax+1], 0
		jnz	short loc_100189BA
		cmp	byte ptr [eax+2], 5Ah
		jnz	short loc_100189BA
		xor	esi, esi

loc_100189BA:				; CODE XREF: sub_10018850+155j
					; sub_10018850+15Aj ...
		mov	ecx, [ebx-4]
		cmp	ecx, edi
		jz	short loc_100189D0
		cmp	[ebx], esi
		jb	short loc_100189ED
		push	esi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_100189D0:				; CODE XREF: sub_10018850+16Fj
		mov	[ebx], esi
		mov	[esp+2Ch+var_8], 1
		mov	[esp+2Ch+var_18], edi
		jmp	loc_10018950
; ---------------------------------------------------------------------------

loc_100189E3:				; CODE XREF: sub_10018850+150j
		mov	[esp+2Ch+arg_0], 12h
		jmp	short loc_100189F5
; ---------------------------------------------------------------------------

loc_100189ED:				; CODE XREF: sub_10018850+173j
		mov	[esp+2Ch+arg_0], 150h

loc_100189F5:				; CODE XREF: sub_10018850+19Bj
		mov	dword ptr [ebx], 0FFFFFFFFh

loc_100189FB:				; CODE XREF: sub_10018850+12Cj
					; sub_10018850+131j
		mov	ecx, [esp+2Ch+var_1C]
		push	ecx
		call	sqlite3_reset
		mov	edx, [esp+30h+var_1C]
		push	edx
		call	sqlite3_finalize
		add	esp, 8
		mov	[esp+2Ch+var_1C], edi

loc_10018A16:				; CODE XREF: sub_10018850+D1j
		mov	eax, [esp+2Ch+var_C]
		inc	eax
		add	ebx, 0Ch
		mov	[esp+2Ch+var_C], eax
		cmp	eax, [esp+2Ch+arg_C]
		jb	loc_100188B0
		xor	edi, edi

loc_10018A2E:				; CODE XREF: sub_10018850+D8j
					; sub_10018850+F6j
		cmp	[esp+2Ch+arg_0], edi
		jnz	short loc_10018AB0
		cmp	ebp, 65h	; switch 102 cases
		ja	short loc_10018A92 ; jumptable 10018A40	default	case

loc_10018A39:				; CODE XREF: sub_10018850+4Cj
		movzx	eax, ss:byte_10018B10[ebp]
		jmp	ds:off_10018AF8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10018A47:				; CODE XREF: sub_10018850+75j
					; sub_10018850+9Aj
		mov	[esp+2Ch+arg_0], 2
		jmp	short loc_10018AB0
; ---------------------------------------------------------------------------

loc_10018A51:				; CODE XREF: sub_10018850+1F0j
					; DATA XREF: .text:off_10018AF8o
		mov	[esp+2Ch+arg_0], 0 ; jumptable 10018A40	cases 0,101
		jmp	short loc_10018A9A
; ---------------------------------------------------------------------------

loc_10018A5B:				; CODE XREF: sub_10018850+1F0j
					; DATA XREF: .text:off_10018AF8o
		mov	[esp+2Ch+arg_0], 2 ; jumptable 10018A40	case 7
		jmp	short loc_10018A9A
; ---------------------------------------------------------------------------

loc_10018A65:				; CODE XREF: sub_10018850+1F0j
					; DATA XREF: .text:off_10018AF8o
		mov	[esp+2Ch+arg_0], 0E2h ;	jumptable 10018A40 case	8
		jmp	short loc_10018A9A
; ---------------------------------------------------------------------------

loc_10018A6F:				; CODE XREF: sub_10018850+1F0j
					; DATA XREF: .text:off_10018AF8o
		mov	edx, [esp+2Ch+var_4] ; jumptable 10018A40 cases	3,12,14,23
		xor	ecx, ecx
		cmp	dword ptr [edx+18h], 1
		setnz	cl
		add	ecx, 0CE534351h
		mov	[esp+2Ch+arg_0], ecx
		jmp	short loc_10018A9A
; ---------------------------------------------------------------------------

loc_10018A88:				; CODE XREF: sub_10018850+1F0j
					; DATA XREF: .text:off_10018AF8o
		mov	[esp+2Ch+arg_0], 30h ; jumptable 10018A40 case 10
		jmp	short loc_10018A9A
; ---------------------------------------------------------------------------

loc_10018A92:				; CODE XREF: sub_10018850+1E7j
					; sub_10018850+1F0j
					; DATA XREF: ...
		mov	[esp+2Ch+arg_0], 5 ; jumptable 10018A40	default	case

loc_10018A9A:				; CODE XREF: sub_10018850+209j
					; sub_10018850+213j ...
		cmp	[esp+2Ch+var_8], 0
		jnz	short loc_10018AB0
		cmp	[esp+2Ch+arg_0], 0
		jnz	short loc_10018AB0
		mov	[esp+2Ch+arg_0], 82h

loc_10018AB0:				; CODE XREF: sub_10018850+1E2j
					; sub_10018850+1FFj ...
		pop	esi

loc_10018AB1:				; CODE XREF: sub_10018850+3Dj
		mov	eax, [esp+28h+var_1C]
		pop	edi
		pop	ebp
		pop	ebx
		test	eax, eax
		jz	short loc_10018ACF
		push	eax
		call	sqlite3_reset
		mov	eax, [esp+20h+var_1C]
		push	eax
		call	sqlite3_finalize
		add	esp, 8

loc_10018ACF:				; CODE XREF: sub_10018850+26Aj
		mov	eax, [esp+1Ch+var_14]
		test	eax, eax
		jz	short loc_10018AED
		mov	ecx, [esp+1Ch+var_4]
		cmp	[ecx+4], eax
		jz	short loc_10018AED
		mov	ecx, [ecx+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10018AED:				; CODE XREF: sub_10018850+285j
					; sub_10018850+28Ej
		mov	eax, [esp+1Ch+arg_0]
		add	esp, 1Ch
		retn
sub_10018850	endp

; ---------------------------------------------------------------------------
		align 4
off_10018AF8	dd offset loc_10018A51,	offset loc_10018A6F, offset loc_10018A5B
					; DATA XREF: sub_10018850+1F0r
		dd offset loc_10018A65,	offset loc_10018A88, offset loc_10018A92 ; jump	table for switch statement
byte_10018B10	db	0,     5,     5,     1 ; DATA XREF: sub_10018850:loc_10018A39r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

loc_10018B80:				; DATA XREF: sub_10019E70+52Co
		mov	eax, [esp+10h]
		test	eax, eax
		jnz	short loc_10018B89
		retn
; ---------------------------------------------------------------------------

loc_10018B89:				; CODE XREF: .text:10018B86j
		mov	[esp+10h], eax
		jmp	sub_10018850
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018BA0	proc near		; DATA XREF: sub_10019E70+533o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_0]
		test	byte ptr [eax+0Ch], 1
		mov	ecx, [eax]
		mov	[esp+10h+var_10], ecx
		mov	[esp+10h+arg_0], 0
		mov	[esp+10h+var_C], 0
		jz	short loc_10018BCB
		mov	eax, 0E2h
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10018BCB:				; CODE XREF: sub_10018BA0+20j
		cmp	[esp+10h+arg_C], 0
		jnz	short loc_10018BD8
		xor	eax, eax
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10018BD8:				; CODE XREF: sub_10018BA0+30j
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	offset word_10026FE6
		call	sqlite3_mprintf
		mov	esi, eax
		add	esp, 4
		xor	edi, edi
		test	esi, esi
		jz	loc_10018C7F
		mov	ebx, [esp+20h+arg_8]
		lea	esp, [esp+0]

loc_10018C00:				; CODE XREF: sub_10018BA0+A8j
		cmp	edi, [esp+20h+arg_C]
		jnb	short loc_10018C55
		test	edi, edi
		jnz	short loc_10018C25
		push	esi
		call	sqlite3_free
		mov	edx, [ebx]
		push	edi
		push	edx
		push	offset aAXValueD ; "a%x=$VALUE%d"
		call	sqlite3_mprintf
		add	esp, 10h
		mov	esi, eax
		jmp	short loc_10018C45
; ---------------------------------------------------------------------------

loc_10018C25:				; CODE XREF: sub_10018BA0+68j
		lea	eax, [edi+edi*2]
		mov	ecx, [ebx+eax*4]
		push	edi
		push	ecx
		push	esi
		push	offset aSAXValueD ; "%s,a%x=$VALUE%d"
		call	sqlite3_mprintf
		push	esi
		mov	ebp, eax
		call	sqlite3_free
		add	esp, 14h
		mov	esi, ebp

loc_10018C45:				; CODE XREF: sub_10018BA0+83j
		inc	edi
		test	esi, esi
		jnz	short loc_10018C00
		pop	edi
		lea	eax, [esi+2]
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10018C55:				; CODE XREF: sub_10018BA0+64j
		test	esi, esi
		jz	short loc_10018C7F
		mov	edx, [esp+20h+var_10]
		mov	eax, [edx+1Ch]
		push	esi
		push	eax
		push	offset aUpdateSSetSWhe ; "UPDATE %s SET	%s WHERE id=$ID;"
		call	sqlite3_mprintf
		mov	ebp, eax
		push	esi
		mov	[esp+30h+var_4], ebp
		call	sqlite3_free
		add	esp, 10h
		test	ebp, ebp
		jnz	short loc_10018C8C

loc_10018C7F:				; CODE XREF: sub_10018BA0+4Fj
					; sub_10018BA0+B7j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10018C8C:				; CODE XREF: sub_10018BA0+DDj
		mov	edi, [esp+20h+var_10]
		mov	ecx, [edi+24h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	dword ptr [edi+4], 0
		jz	short loc_10018CC4
		call	ds:PR_GetCurrentThread
		cmp	[edi+8], eax
		jnz	short loc_10018CC4
		mov	eax, [edi+24h]
		mov	edx, [edi+4]
		push	eax
		mov	[esp+24h+var_8], edx
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_10018CCB
; ---------------------------------------------------------------------------

loc_10018CC4:				; CODE XREF: sub_10018BA0+101j
					; sub_10018BA0+10Cj
		mov	ecx, [edi+0Ch]
		mov	[esp+20h+var_8], ecx

loc_10018CCB:				; CODE XREF: sub_10018BA0+122j
		mov	eax, [esp+20h+var_8]
		push	0
		lea	edx, [esp+24h+arg_0]
		push	edx
		push	0FFFFFFFFh
		push	ebp
		push	eax
		call	sqlite3_prepare_v2
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10018DA1
		xor	edi, edi
		cmp	[esp+20h+arg_C], edi
		jbe	short loc_10018D3C
		lea	ebp, [ebx+8]

loc_10018CF7:				; CODE XREF: sub_10018BA0+196j
		mov	eax, [ebp+0]
		push	0
		test	eax, eax
		jz	short loc_10018D10
		mov	ecx, [ebp-4]
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	ecx
		lea	edx, [edi+1]
		push	edx
		push	eax
		jmp	short loc_10018D20
; ---------------------------------------------------------------------------

loc_10018D10:				; CODE XREF: sub_10018BA0+15Ej
		mov	edx, [esp+24h+arg_0]
		push	3
		push	offset dword_10027530
		lea	ecx, [edi+2]
		push	ecx
		push	edx

loc_10018D20:				; CODE XREF: sub_10018BA0+16Ej
		call	sqlite3_bind_blob
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10018D99
		inc	edi
		add	ebp, 0Ch
		cmp	edi, [esp+20h+arg_C]
		jb	short loc_10018CF7
		mov	ebp, [esp+20h+var_4]

loc_10018D3C:				; CODE XREF: sub_10018BA0+152j
		mov	eax, [esp+20h+arg_4]
		mov	ecx, [esp+20h+arg_0]
		push	eax
		inc	edi
		push	edi
		push	ecx
		call	sqlite3_bind_int
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10018D9D
		mov	edi, ds:PR_Sleep
		lea	esp, [esp+0]

loc_10018D60:				; CODE XREF: sub_10018BA0+1E6j
					; sub_10018BA0+1F7j
		mov	edx, [esp+20h+arg_0]
		push	edx
		call	sqlite3_step
		mov	esi, eax
		add	esp, 4
		cmp	esi, 5
		jnz	short loc_10018D8A
		push	eax
		call	edi ; PR_Sleep
		mov	eax, [esp+24h+var_C]
		inc	eax
		add	esp, 4
		mov	[esp+20h+var_C], eax
		cmp	eax, 0Ah
		jl	short loc_10018D60
		jmp	short loc_10018D9D
; ---------------------------------------------------------------------------

loc_10018D8A:				; CODE XREF: sub_10018BA0+1D2j
		cmp	esi, 64h
		jnz	short loc_10018D9D
		mov	[esp+20h+var_C], 0
		jmp	short loc_10018D60
; ---------------------------------------------------------------------------

loc_10018D99:				; CODE XREF: sub_10018BA0+18Cj
		mov	ebp, [esp+20h+var_4]

loc_10018D9D:				; CODE XREF: sub_10018BA0+1B4j
					; sub_10018BA0+1E8j ...
		mov	edi, [esp+20h+var_10]

loc_10018DA1:				; CODE XREF: sub_10018BA0+146j
		push	ebp
		call	sqlite3_free
		add	esp, 4
		cmp	esi, 65h	; switch 102 cases
		ja	short loc_10018DE7 ; jumptable 10018DB6	default	case
		movzx	eax, ds:byte_10018E44[esi]
		jmp	ds:off_10018E2C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10018DBD:				; CODE XREF: sub_10018BA0+216j
					; DATA XREF: .text:off_10018E2Co
		xor	esi, esi	; jumptable 10018DB6 cases 0,101
		jmp	short loc_10018DEC
; ---------------------------------------------------------------------------

loc_10018DC1:				; CODE XREF: sub_10018BA0+216j
					; DATA XREF: .text:off_10018E2Co
		mov	esi, 2		; jumptable 10018DB6 case 7
		jmp	short loc_10018DEC
; ---------------------------------------------------------------------------

loc_10018DC8:				; CODE XREF: sub_10018BA0+216j
					; DATA XREF: .text:off_10018E2Co
		mov	esi, 0E2h	; jumptable 10018DB6 case 8
		jmp	short loc_10018DEC
; ---------------------------------------------------------------------------

loc_10018DCF:				; CODE XREF: sub_10018BA0+216j
					; DATA XREF: .text:off_10018E2Co
		xor	ecx, ecx	; jumptable 10018DB6 cases 3,12,14,23
		cmp	dword ptr [edi+18h], 1
		setnz	cl
		lea	esi, [ecx-31ACBCAFh]
		jmp	short loc_10018DEC
; ---------------------------------------------------------------------------

loc_10018DE0:				; CODE XREF: sub_10018BA0+216j
					; DATA XREF: .text:off_10018E2Co
		mov	esi, 30h	; jumptable 10018DB6 case 10
		jmp	short loc_10018DEC
; ---------------------------------------------------------------------------

loc_10018DE7:				; CODE XREF: sub_10018BA0+20Dj
					; sub_10018BA0+216j
					; DATA XREF: ...
		mov	esi, 5		; jumptable 10018DB6 default case

loc_10018DEC:				; CODE XREF: sub_10018BA0+21Fj
					; sub_10018BA0+226j ...
		mov	eax, [esp+20h+arg_0]
		test	eax, eax
		jz	short loc_10018E07
		push	eax
		call	sqlite3_reset
		mov	edx, [esp+24h+arg_0]
		push	edx
		call	sqlite3_finalize
		add	esp, 8

loc_10018E07:				; CODE XREF: sub_10018BA0+252j
		mov	eax, [esp+20h+var_8]
		test	eax, eax
		jz	short loc_10018E21
		cmp	[edi+4], eax
		jz	short loc_10018E21
		mov	eax, [edi+24h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10018E21:				; CODE XREF: sub_10018BA0+26Dj
					; sub_10018BA0+272j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_10018BA0	endp

; ---------------------------------------------------------------------------
		align 4
off_10018E2C	dd offset loc_10018DBD,	offset loc_10018DCF, offset loc_10018DC1
					; DATA XREF: sub_10018BA0+216r
		dd offset loc_10018DC8,	offset loc_10018DE0, offset loc_10018DE7 ; jump	table for switch statement
byte_10018E44	db	0,     5,     5,     1 ; DATA XREF: sub_10018BA0+20Fr
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018EB0	proc near		; CODE XREF: sub_10018F40+63p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, dword_10029678
		sub	esp, 0Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+14h+arg_0]
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	eax, ebx
		jnz	short loc_10018ED1
		call	ds:PR_Now
		and	eax, 3FFFFFFFh

loc_10018ED1:				; CODE XREF: sub_10018EB0+14j
		mov	esi, eax
		inc	eax
		mov	dword_10029678,	eax
		xor	edi, edi
		jmp	short loc_10018EE0
; ---------------------------------------------------------------------------
		align 10h

loc_10018EE0:				; CODE XREF: sub_10018EB0+2Bj
					; sub_10018EB0+74j
		and	esi, 3FFFFFFFh
		jz	short loc_10018F15
		push	1
		lea	eax, [esp+20h+var_C]
		push	eax
		push	esi
		push	ebp
		mov	[esp+2Ch+var_C], 3
		mov	[esp+2Ch+var_8], ebx
		mov	[esp+2Ch+var_4], ebx
		call	sub_10018850
		add	esp, 10h
		cmp	eax, 82h
		jz	short loc_10018F30
		mov	eax, dword_10029678

loc_10018F15:				; CODE XREF: sub_10018EB0+36j
		inc	edi
		mov	esi, eax
		inc	eax
		mov	dword_10029678,	eax
		cmp	edi, 40000000h
		jl	short loc_10018EE0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10018F30:				; CODE XREF: sub_10018EB0+5Ej
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10018EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018F40	proc near		; DATA XREF: sub_10019E70+53Ao

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 1Ch
		push	esi
		mov	esi, [esp+20h+arg_0]
		mov	eax, [esi]
		push	edi
		xor	edi, edi
		test	byte ptr [esi+0Ch], 1
		mov	[esp+24h+var_14], eax
		mov	[esp+24h+arg_0], edi
		mov	[esp+24h+var_18], edi
		jz	short loc_10018F6A
		pop	edi
		mov	eax, 0E2h
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10018F6A:				; CODE XREF: sub_10018F40+1Dj
		push	ebx
		mov	ebx, [esp+28h+arg_4]
		mov	eax, [ebx]
		push	ebp
		cmp	eax, edi
		jz	short loc_10018FA2
		push	1
		lea	ecx, [esp+30h+var_C]
		push	ecx
		push	eax
		push	esi
		mov	[esp+3Ch+var_C], 3
		mov	[esp+3Ch+var_8], edi
		mov	[esp+3Ch+var_4], edi
		call	sub_10018850
		add	esp, 10h
		cmp	eax, 82h
		jnz	short loc_10018FA2
		mov	ebp, [ebx]
		jmp	short loc_10018FAD
; ---------------------------------------------------------------------------

loc_10018FA2:				; CODE XREF: sub_10018F40+34j
					; sub_10018F40+5Cj
		push	esi
		call	sub_10018EB0
		add	esp, 4
		mov	ebp, eax

loc_10018FAD:				; CODE XREF: sub_10018F40+60j
		cmp	ebp, edi
		jz	loc_1001903C
		push	offset word_10026FE6
		call	sqlite3_mprintf
		push	offset word_10026FE6
		mov	esi, eax
		call	sqlite3_mprintf
		mov	[ebx], ebp
		add	esp, 8
		xor	ebp, ebp
		mov	edi, eax
		test	esi, esi
		jz	short loc_1001902F
		mov	edx, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_1C], edx
		jmp	short loc_10018FE6
; ---------------------------------------------------------------------------

loc_10018FE2:				; CODE XREF: sub_10018F40+EDj
		mov	ebx, [esp+2Ch+arg_4]

loc_10018FE6:				; CODE XREF: sub_10018F40+A0j
		test	edi, edi
		jz	short loc_10019049
		cmp	ebp, [esp+2Ch+arg_C]
		jnb	short loc_10019049
		mov	eax, [esp+2Ch+var_1C]
		mov	ecx, [eax]
		push	ecx
		push	esi
		push	offset aSAX_0	; "%s,a%x"
		call	sqlite3_mprintf
		push	esi
		mov	ebx, eax
		call	sqlite3_free
		push	ebp
		push	edi
		push	offset aSValueD	; "%s,$VALUE%d"
		mov	esi, ebx
		call	sqlite3_mprintf
		push	edi
		mov	ebx, eax
		call	sqlite3_free
		add	[esp+4Ch+var_1C], 0Ch
		add	esp, 20h
		inc	ebp
		mov	edi, ebx
		test	esi, esi
		jnz	short loc_10018FE2

loc_1001902F:				; CODE XREF: sub_10018F40+96j
					; sub_10018F40+10Bj
		test	edi, edi
		jz	short loc_1001903C
		push	edi

loc_10019034:				; CODE XREF: sub_10018F40+2E0j
		call	sqlite3_free
		add	esp, 4

loc_1001903C:				; CODE XREF: sub_10018F40+6Fj
					; sub_10018F40+F1j
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 2
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10019049:				; CODE XREF: sub_10018F40+A8j
					; sub_10018F40+AEj
		test	esi, esi
		jz	short loc_1001902F
		test	edi, edi
		jz	loc_1001921F
		mov	ebp, [esp+2Ch+var_14]
		mov	edx, [ebp+1Ch]
		push	edi
		push	esi
		push	edx
		push	offset aInsertIntoSIdS ; "INSERT INTO %s (id%s)	VALUES($ID%s);"
		call	sqlite3_mprintf
		push	esi
		mov	[esp+40h+var_10], eax
		call	sqlite3_free
		push	edi
		call	sqlite3_free
		mov	eax, [ebp+24h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 1Ch
		cmp	dword ptr [ebp+4], 0
		jz	short loc_100190AD
		call	ds:PR_GetCurrentThread
		cmp	[ebp+8], eax
		jnz	short loc_100190AD
		mov	edx, [ebp+24h]
		mov	ecx, [ebp+4]
		push	edx
		mov	[esp+30h+var_1C], ecx
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_100190B4
; ---------------------------------------------------------------------------

loc_100190AD:				; CODE XREF: sub_10018F40+14Aj
					; sub_10018F40+155j
		mov	eax, [ebp+0Ch]
		mov	[esp+2Ch+var_1C], eax

loc_100190B4:				; CODE XREF: sub_10018F40+16Bj
		mov	edx, [esp+2Ch+var_10]
		mov	eax, [esp+2Ch+var_1C]
		push	0
		lea	ecx, [esp+30h+arg_0]
		push	ecx
		push	0FFFFFFFFh
		push	edx
		push	eax
		call	sqlite3_prepare_v2
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_1001918D
		mov	ecx, [ebx]
		mov	edx, [esp+2Ch+arg_0]
		push	ecx
		push	1
		push	edx
		call	sqlite3_bind_int
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_1001918D
		mov	ebx, [esp+2Ch+arg_C]
		test	ebx, ebx
		jz	short loc_10019147
		mov	ebp, [esp+2Ch+arg_8]
		lea	edi, [eax+2]
		add	ebp, 8

loc_10019107:				; CODE XREF: sub_10018F40+201j
		mov	eax, [ebp+0]
		push	0
		test	eax, eax
		jz	short loc_1001911D
		mov	ecx, [esp+30h+arg_0]
		push	eax
		mov	eax, [ebp-4]
		push	eax
		push	edi
		push	ecx
		jmp	short loc_1001912A
; ---------------------------------------------------------------------------

loc_1001911D:				; CODE XREF: sub_10018F40+1CEj
		mov	edx, [esp+30h+arg_0]
		push	3
		push	offset dword_10027530
		push	edi
		push	edx

loc_1001912A:				; CODE XREF: sub_10018F40+1DBj
		call	sqlite3_bind_blob
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10019189
		inc	edi
		lea	eax, [edi-2]
		add	ebp, 0Ch
		cmp	eax, ebx
		jb	short loc_10019107
		mov	ebp, [esp+2Ch+var_14]

loc_10019147:				; CODE XREF: sub_10018F40+1BBj
		mov	edi, ds:PR_Sleep
		lea	ecx, [ecx+0]

loc_10019150:				; CODE XREF: sub_10018F40+236j
					; sub_10018F40+247j
		mov	ecx, [esp+2Ch+arg_0]
		push	ecx
		call	sqlite3_step
		mov	esi, eax
		add	esp, 4
		cmp	esi, 5
		jnz	short loc_1001917A
		push	eax
		call	edi ; PR_Sleep
		mov	eax, [esp+30h+var_18]
		inc	eax
		add	esp, 4
		mov	[esp+2Ch+var_18], eax
		cmp	eax, 0Ah
		jl	short loc_10019150
		jmp	short loc_1001918D
; ---------------------------------------------------------------------------

loc_1001917A:				; CODE XREF: sub_10018F40+222j
		cmp	esi, 64h
		jnz	short loc_1001918D
		mov	[esp+2Ch+var_18], 0
		jmp	short loc_10019150
; ---------------------------------------------------------------------------

loc_10019189:				; CODE XREF: sub_10018F40+1F6j
		mov	ebp, [esp+2Ch+var_14]

loc_1001918D:				; CODE XREF: sub_10018F40+193j
					; sub_10018F40+1AFj ...
		mov	eax, [esp+2Ch+var_10]
		test	eax, eax
		jz	short loc_1001919E
		push	eax
		call	sqlite3_free
		add	esp, 4

loc_1001919E:				; CODE XREF: sub_10018F40+253j
		cmp	esi, 65h	; switch 102 cases
		ja	short loc_100191DB ; jumptable 100191AA	default	case
		movzx	edx, ds:byte_10019240[esi]
		jmp	ds:off_10019228[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100191B1:				; CODE XREF: sub_10018F40+26Aj
					; DATA XREF: .text:off_10019228o
		xor	esi, esi	; jumptable 100191AA cases 0,101
		jmp	short loc_100191E0
; ---------------------------------------------------------------------------

loc_100191B5:				; CODE XREF: sub_10018F40+26Aj
					; DATA XREF: .text:off_10019228o
		mov	esi, 2		; jumptable 100191AA case 7
		jmp	short loc_100191E0
; ---------------------------------------------------------------------------

loc_100191BC:				; CODE XREF: sub_10018F40+26Aj
					; DATA XREF: .text:off_10019228o
		mov	esi, 0E2h	; jumptable 100191AA case 8
		jmp	short loc_100191E0
; ---------------------------------------------------------------------------

loc_100191C3:				; CODE XREF: sub_10018F40+26Aj
					; DATA XREF: .text:off_10019228o
		xor	eax, eax	; jumptable 100191AA cases 3,12,14,23
		cmp	dword ptr [ebp+18h], 1
		setnz	al
		lea	esi, [eax-31ACBCAFh]
		jmp	short loc_100191E0
; ---------------------------------------------------------------------------

loc_100191D4:				; CODE XREF: sub_10018F40+26Aj
					; DATA XREF: .text:off_10019228o
		mov	esi, 30h	; jumptable 100191AA case 10
		jmp	short loc_100191E0
; ---------------------------------------------------------------------------

loc_100191DB:				; CODE XREF: sub_10018F40+261j
					; sub_10018F40+26Aj
					; DATA XREF: ...
		mov	esi, 5		; jumptable 100191AA default case

loc_100191E0:				; CODE XREF: sub_10018F40+273j
					; sub_10018F40+27Aj ...
		mov	eax, [esp+2Ch+arg_0]
		test	eax, eax
		jz	short loc_100191FB
		push	eax
		call	sqlite3_reset
		mov	ecx, [esp+30h+arg_0]
		push	ecx
		call	sqlite3_finalize
		add	esp, 8

loc_100191FB:				; CODE XREF: sub_10018F40+2A6j
		mov	eax, [esp+2Ch+var_1C]
		test	eax, eax
		jz	short loc_10019215
		cmp	[ebp+4], eax
		jz	short loc_10019215
		mov	edx, [ebp+24h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019215:				; CODE XREF: sub_10018F40+2C1j
					; sub_10018F40+2C6j
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001921F:				; CODE XREF: sub_10018F40+10Fj
		push	esi
		jmp	loc_10019034
sub_10018F40	endp

; ---------------------------------------------------------------------------
		align 4
off_10019228	dd offset loc_100191B1,	offset loc_100191C3, offset loc_100191B5
					; DATA XREF: sub_10018F40+26Ar
		dd offset loc_100191BC,	offset loc_100191D4, offset loc_100191DB ; jump	table for switch statement
byte_10019240	db	0,     5,     5,     1 ; DATA XREF: sub_10018F40+263r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

loc_100192B0:				; DATA XREF: sub_10019E70+541o
		push	ecx
		mov	eax, [esp+8]
		push	ebx
		mov	ebx, [eax]
		push	ebp
		xor	ebp, ebp
		test	byte ptr [eax+0Ch], 1
		mov	[esp+10h], ebp
		jz	short loc_100192CE
		pop	ebp
		mov	eax, 0E2h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100192CE:				; CODE XREF: .text:100192C3j
		mov	eax, [ebx+24h]
		push	esi
		push	edi
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	[ebx+4], ebp
		jz	short loc_10019303
		call	ds:PR_GetCurrentThread
		cmp	[ebx+8], eax
		jnz	short loc_10019303
		mov	ecx, [ebx+24h]
		mov	esi, [ebx+4]
		push	ecx
		mov	[esp+14h], esi
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_1001930C
; ---------------------------------------------------------------------------

loc_10019303:				; CODE XREF: .text:100192E0j
					; .text:100192EBj
		mov	edx, [ebx+0Ch]
		mov	[esp+10h], edx
		mov	esi, edx

loc_1001930C:				; CODE XREF: .text:10019301j
		mov	eax, [ebx+1Ch]
		push	eax
		push	offset aDeleteFromSWhe ; "DELETE FROM %s WHERE (id=$ID);"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jnz	short loc_1001932A
		mov	edi, 2
		jmp	short loc_100193A4
; ---------------------------------------------------------------------------

loc_1001932A:				; CODE XREF: .text:10019321j
		push	ebp
		lea	ecx, [esp+1Ch]
		push	ecx
		push	0FFFFFFFFh
		push	edi
		push	esi
		call	sqlite3_prepare_v2
		push	edi
		mov	esi, eax
		call	sqlite3_free
		add	esp, 18h
		test	esi, esi
		jnz	short loc_10019390
		mov	edx, [esp+1Ch]
		mov	eax, [esp+18h]
		push	edx
		push	1
		push	eax
		call	sqlite3_bind_int
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10019390
		mov	edi, ds:PR_Sleep
		jmp	short loc_10019370
; ---------------------------------------------------------------------------
		align 10h

loc_10019370:				; CODE XREF: .text:10019368j
					; .text:1001938Ej ...
		mov	ecx, [esp+18h]
		push	ecx
		call	sqlite3_step
		mov	esi, eax
		add	esp, 4
		cmp	esi, 5
		jnz	short loc_100193DD
		push	eax
		call	edi ; PR_Sleep
		inc	ebp
		add	esp, 4
		cmp	ebp, 0Ah
		jl	short loc_10019370

loc_10019390:				; CODE XREF: .text:10019346j
					; .text:10019360j ...
		mov	edx, [ebx+18h]
		push	edx
		mov	eax, esi
		call	sub_10017EC0
		mov	esi, [esp+14h]
		add	esp, 4
		mov	edi, eax

loc_100193A4:				; CODE XREF: .text:10019328j
		mov	eax, [esp+18h]
		test	eax, eax
		jz	short loc_100193BF
		push	eax
		call	sqlite3_reset
		mov	eax, [esp+1Ch]
		push	eax
		call	sqlite3_finalize
		add	esp, 8

loc_100193BF:				; CODE XREF: .text:100193AAj
		test	esi, esi
		jz	short loc_100193D5
		cmp	[ebx+4], esi
		jz	short loc_100193D5
		mov	ecx, [ebx+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100193D5:				; CODE XREF: .text:100193C1j
					; .text:100193C6j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100193DD:				; CODE XREF: .text:10019382j
		cmp	esi, 64h
		jnz	short loc_10019390
		xor	ebp, ebp
		jmp	short loc_10019370
; ---------------------------------------------------------------------------
		align 10h

loc_100193F0:				; DATA XREF: sub_10019E70+556o
		push	ecx
		mov	eax, [esp+8]
		push	ebx
		mov	ebx, [eax]
		push	edi
		xor	edi, edi
		test	byte ptr [eax+0Ch], 1
		mov	[esp+10h], edi
		mov	[esp+8], edi
		jz	short loc_10019412
		pop	edi
		mov	eax, 0E2h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10019412:				; CODE XREF: .text:10019407j
		mov	eax, [ebx]
		push	esi
		lea	ecx, [esp+14h]
		push	ecx
		push	eax
		mov	[esp+1Ch], edi
		call	sqlite3_open
		add	esp, 8
		cmp	eax, edi
		jz	short loc_10019432
		mov	esi, eax
		jmp	loc_100194BE
; ---------------------------------------------------------------------------

loc_10019432:				; CODE XREF: .text:10019429j
		mov	edx, [esp+14h]
		push	3E8h
		push	edx
		call	sqlite3_busy_timeout
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jz	short loc_1001945D
		mov	eax, [esp+14h]
		push	eax
		call	sqlite3_close
		add	esp, 4
		mov	[esp+14h], edi
		jmp	short loc_100194BE
; ---------------------------------------------------------------------------

loc_1001945D:				; CODE XREF: .text:10019448j
		mov	edx, [esp+14h]
		push	ebp
		push	edi
		lea	ecx, [esp+14h]
		push	ecx
		push	0FFFFFFFFh
		push	offset aBeginImmediate ; "BEGIN	IMMEDIATE TRANSACTION;"
		push	edx
		call	sqlite3_prepare_v2
		mov	ebp, ds:PR_Sleep
		add	esp, 14h
		mov	edi, edi

loc_10019480:				; CODE XREF: .text:1001949Ej
					; .text:100194DCj
		mov	eax, [esp+10h]
		push	eax
		call	sqlite3_step
		mov	esi, eax
		add	esp, 4
		cmp	esi, 5
		jnz	short loc_100194D5
		push	eax
		call	ebp ; PR_Sleep
		inc	edi
		add	esp, 4
		cmp	edi, 0Ah
		jl	short loc_10019480

loc_100194A0:				; CODE XREF: .text:100194D8j
		mov	eax, [esp+10h]
		pop	ebp
		test	eax, eax
		jz	short loc_100194BC
		push	eax
		call	sqlite3_reset
		mov	ecx, [esp+10h]
		push	ecx
		call	sqlite3_finalize
		add	esp, 8

loc_100194BC:				; CODE XREF: .text:100194A7j
		xor	edi, edi

loc_100194BE:				; CODE XREF: .text:1001942Dj
					; .text:1001945Bj
		cmp	esi, 65h	; switch 102 cases
		ja	loc_1001954E	; jumptable 100194CE default case
		movzx	edx, ds:byte_10019570[esi]
		jmp	ds:off_10019558[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100194D5:				; CODE XREF: .text:10019492j
		cmp	esi, 64h
		jnz	short loc_100194A0
		xor	edi, edi
		jmp	short loc_10019480
; ---------------------------------------------------------------------------

loc_100194DE:				; CODE XREF: .text:100194CEj
					; DATA XREF: .text:off_10019558o
		xor	esi, esi	; jumptable 100194CE cases 0,101
		jmp	short loc_10019519
; ---------------------------------------------------------------------------

loc_100194E2:				; CODE XREF: .text:100194CEj
					; DATA XREF: .text:off_10019558o
		mov	esi, 2		; jumptable 100194CE case 7

loc_100194E7:				; CODE XREF: .text:10019504j
					; .text:10019517j ...
		mov	eax, [esp+14h]
		cmp	eax, edi
		jz	short loc_100194F8
		push	eax
		call	sqlite3_close
		add	esp, 4

loc_100194F8:				; CODE XREF: .text:100194EDj
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100194FF:				; CODE XREF: .text:100194CEj
					; DATA XREF: .text:off_10019558o
		mov	esi, 0E2h	; jumptable 100194CE case 8
		jmp	short loc_100194E7
; ---------------------------------------------------------------------------

loc_10019506:				; CODE XREF: .text:100194CEj
					; DATA XREF: .text:off_10019558o
		xor	eax, eax	; jumptable 100194CE cases 3,12,14,23
		cmp	dword ptr [ebx+18h], 1
		setnz	al
		lea	esi, [eax-31ACBCAFh]
		cmp	esi, edi
		jnz	short loc_100194E7

loc_10019519:				; CODE XREF: .text:100194E0j
		mov	ecx, [ebx+24h]
		push	ecx
		call	ds:PR_EnterMonitor
		mov	edx, [esp+18h]
		mov	[ebx+4], edx
		call	ds:PR_GetCurrentThread
		mov	[ebx+8], eax
		mov	eax, [ebx+24h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10019547:				; CODE XREF: .text:100194CEj
					; DATA XREF: .text:off_10019558o
		mov	esi, 30h	; jumptable 100194CE case 10
		jmp	short loc_100194E7
; ---------------------------------------------------------------------------

loc_1001954E:				; CODE XREF: .text:100194C1j
					; .text:100194CEj
					; DATA XREF: ...
		mov	esi, 5		; jumptable 100194CE default case
		jmp	short loc_100194E7
; ---------------------------------------------------------------------------
		align 4
off_10019558	dd offset loc_100194DE,	offset loc_10019506, offset loc_100194E2
					; DATA XREF: .text:100194CEr
		dd offset loc_100194FF,	offset loc_10019547, offset loc_1001954E ; jump	table for switch statement
byte_10019570	db	0,     5,     5,     1 ; DATA XREF: .text:100194C7r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100195E0	proc near		; CODE XREF: .text:10019709p
					; .text:10019729p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, [eax]
		push	edi
		xor	edi, edi
		test	byte ptr [eax+0Ch], 1
		mov	[esp+0Ch+var_4], edi
		jz	short loc_100195FA
		pop	edi
		mov	eax, 0E2h
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100195FA:				; CODE XREF: sub_100195E0+Fj
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	[esi+4], edi
		jnz	short loc_10019622
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4
		pop	edi
		mov	eax, 5
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10019622:				; CODE XREF: sub_100195E0+2Aj
		call	ds:PR_GetCurrentThread
		cmp	[esi+8], eax
		jz	short loc_10019643
		mov	edx, [esi+24h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4
		pop	edi
		mov	eax, 5
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10019643:				; CODE XREF: sub_100195E0+4Bj
		mov	eax, [esi+24h]
		push	ebx
		push	ebp
		mov	ebp, [esi+4]
		push	eax
		mov	[esi+4], edi
		mov	[esi+8], edi
		call	ds:PR_ExitMonitor
		mov	edx, [esp+18h+arg_0]
		push	edi
		lea	ecx, [esp+1Ch+var_4]
		push	ecx
		push	0FFFFFFFFh
		push	edx
		push	ebp
		call	sqlite3_prepare_v2
		add	esp, 18h
		mov	edi, edi

loc_10019670:				; CODE XREF: sub_100195E0+B2j
					; sub_100195E0+116j
		mov	eax, [esp+14h+var_4]
		push	eax
		call	sqlite3_step
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, 5
		jnz	short loc_100196EF
		push	eax
		call	ds:PR_Sleep
		inc	edi
		add	esp, 4
		cmp	edi, 0Ah
		jl	short loc_10019670

loc_10019694:				; CODE XREF: sub_100195E0+112j
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jz	short loc_100196AF
		push	eax
		call	sqlite3_reset
		mov	ecx, [esp+18h+var_4]
		push	ecx
		call	sqlite3_finalize
		add	esp, 8

loc_100196AF:				; CODE XREF: sub_100195E0+BAj
		cmp	dword ptr [esi+20h], 0
		jz	short loc_100196D1
		mov	edx, [esi+24h]
		push	edx
		call	ds:PR_EnterMonitor
		call	sub_10018180
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 8

loc_100196D1:				; CODE XREF: sub_100195E0+D3j
		mov	ecx, [esi+18h]
		push	ecx
		mov	eax, ebx
		call	sub_10017EC0
		push	ebp
		mov	esi, eax
		call	sqlite3_close
		add	esp, 8
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100196EF:				; CODE XREF: sub_100195E0+A2j
		cmp	ebx, 64h
		jnz	short loc_10019694
		xor	edi, edi
		jmp	loc_10019670
sub_100195E0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10019700:				; DATA XREF: sub_10019E70+55Do
		mov	eax, [esp+4]
		push	offset aCommitTransact ; "COMMIT TRANSACTION;"
		call	sub_100195E0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10019720:				; DATA XREF: sub_10019E70+564o
		mov	eax, [esp+4]
		push	offset aRollbackTransa ; "ROLLBACK TRANSACTION;"
		call	sub_100195E0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019740	proc near		; DATA XREF: sub_10019E70+548o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [eax]
		xor	ebx, ebx
		mov	[esp+1Ch+var_10], ebx
		mov	ecx, [esi+24h]
		push	ecx
		mov	[esp+20h+var_8], esi
		mov	[esp+20h+var_4], ebx
		xor	ebp, ebp
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	[esi+4], ebx
		jz	short loc_1001978F
		call	ds:PR_GetCurrentThread
		cmp	[esi+8], eax
		jnz	short loc_1001978F
		mov	eax, [esi+24h]
		mov	edx, [esi+4]
		push	eax
		mov	[esp+20h+var_C], edx
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_10019796
; ---------------------------------------------------------------------------

loc_1001978F:				; CODE XREF: sub_10019740+2Cj
					; sub_10019740+37j
		mov	ecx, [esi+0Ch]
		mov	[esp+1Ch+var_C], ecx

loc_10019796:				; CODE XREF: sub_10019740+4Dj
		mov	eax, [esp+1Ch+var_C]
		push	edi
		push	ebx
		lea	edx, [esp+24h+var_10]
		push	edx
		push	0FFFFFFFFh
		push	offset aSelectAllFromM ; "SELECT ALL * FROM metaData WHERE id=$ID"...
		push	eax
		mov	[esp+34h+arg_0], ebx
		call	sqlite3_prepare_v2
		mov	edi, eax
		add	esp, 14h
		cmp	edi, 11h
		jnz	short loc_100197ED
		lea	ebx, [esp+20h+var_C]
		call	sub_10018280
		mov	edi, eax
		test	edi, edi
		jnz	loc_10019857
		mov	edx, [esp+20h+var_C]
		push	eax
		lea	ecx, [esp+24h+var_10]
		push	ecx
		push	0FFFFFFFFh
		push	offset aSelectAllFromM ; "SELECT ALL * FROM metaData WHERE id=$ID"...
		push	edx
		call	sqlite3_prepare_v2
		add	esp, 14h
		mov	edi, eax
		xor	ebx, ebx

loc_100197ED:				; CODE XREF: sub_10019740+7Aj
		cmp	edi, ebx
		jnz	short loc_10019859
		mov	edx, [esp+20h+arg_4]
		mov	eax, edx
		lea	esi, [eax+1]
		lea	ebx, [ebx+0]

loc_10019800:				; CODE XREF: sub_10019740+C5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10019800
		push	ebx
		sub	eax, esi
		push	eax
		mov	eax, [esp+28h+var_10]
		push	edx
		push	1
		push	eax
		call	sqlite3_bind_text
		mov	ebx, [esp+34h+arg_C]
		mov	esi, [esp+34h+arg_8]
		add	esp, 14h

loc_10019823:				; CODE XREF: sub_10019740+105j
					; sub_10019740+158j ...
		mov	ecx, [esp+20h+var_10]
		push	ecx
		call	sqlite3_step
		mov	edi, eax
		add	esp, 4
		cmp	edi, 5
		jnz	short loc_10019870
		push	eax
		call	ds:PR_Sleep
		inc	ebp
		add	esp, 4
		cmp	ebp, 0Ah
		jl	short loc_10019823

loc_10019847:				; CODE XREF: sub_10019740+133j
		mov	ebx, [esp+20h+arg_0]
		mov	esi, [esp+20h+var_8]
		test	ebx, ebx
		jnz	loc_10019968

loc_10019857:				; CODE XREF: sub_10019740+89j
		xor	ebx, ebx

loc_10019859:				; CODE XREF: sub_10019740+AFj
		cmp	edi, 65h	; switch 102 cases
		ja	loc_10019948	; jumptable 10019869 default case
		movzx	ecx, ds:byte_100199C0[edi]
		jmp	ds:off_100199A8[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10019870:				; CODE XREF: sub_10019740+F5j
		cmp	edi, 64h
		jnz	short loc_10019847
		mov	edx, [esp+20h+var_10]
		mov	edi, [esi+8]
		push	1
		push	edx
		call	sqlite3_column_bytes
		add	esp, 8
		mov	[esi+8], eax
		cmp	eax, edi
		jbe	short loc_1001989A
		mov	[esp+20h+arg_0], 150h
		xor	ebp, ebp
		jmp	short loc_10019823
; ---------------------------------------------------------------------------

loc_1001989A:				; CODE XREF: sub_10019740+14Cj
		mov	eax, [esp+20h+var_10]
		push	1
		push	eax
		call	sqlite3_column_blob
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		push	ecx		; Size
		push	eax		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 14h
		test	ebx, ebx
		jz	short loc_10019900
		mov	eax, [esp+20h+var_10]
		mov	edi, [ebx+8]
		push	2
		push	eax
		call	sqlite3_column_bytes
		add	esp, 8
		mov	[ebx+8], eax
		cmp	eax, edi
		jbe	short loc_100198E3
		mov	[esp+20h+arg_0], 150h
		xor	ebp, ebp
		jmp	loc_10019823
; ---------------------------------------------------------------------------

loc_100198E3:				; CODE XREF: sub_10019740+192j
		mov	ecx, [esp+20h+var_10]
		push	2
		push	ecx
		call	sqlite3_column_blob
		mov	edx, [ebx+8]
		push	edx		; Size
		push	eax		; Src
		mov	eax, [ebx+4]
		push	eax		; Dst
		call	memcpy
		add	esp, 14h

loc_10019900:				; CODE XREF: sub_10019740+179j
		mov	[esp+20h+var_4], 1
		xor	ebp, ebp
		jmp	loc_10019823
; ---------------------------------------------------------------------------

loc_1001990F:				; CODE XREF: sub_10019740+129j
					; DATA XREF: .text:off_100199A8o
		mov	[esp+20h+arg_0], ebx ; jumptable 10019869 cases	0,101
		jmp	short loc_10019950
; ---------------------------------------------------------------------------

loc_10019915:				; CODE XREF: sub_10019740+129j
					; DATA XREF: .text:off_100199A8o
		mov	[esp+20h+arg_0], 2 ; jumptable 10019869	case 7
		jmp	short loc_10019950
; ---------------------------------------------------------------------------

loc_1001991F:				; CODE XREF: sub_10019740+129j
					; DATA XREF: .text:off_100199A8o
		mov	[esp+20h+arg_0], 0E2h ;	jumptable 10019869 case	8
		jmp	short loc_10019950
; ---------------------------------------------------------------------------

loc_10019929:				; CODE XREF: sub_10019740+129j
					; DATA XREF: .text:off_100199A8o
		xor	edx, edx	; jumptable 10019869 cases 3,12,14,23
		cmp	dword ptr [esi+18h], 1
		setnz	dl
		add	edx, 0CE534351h
		mov	[esp+20h+arg_0], edx
		jmp	short loc_10019950
; ---------------------------------------------------------------------------

loc_1001993E:				; CODE XREF: sub_10019740+129j
					; DATA XREF: .text:off_100199A8o
		mov	[esp+20h+arg_0], 30h ; jumptable 10019869 case 10
		jmp	short loc_10019950
; ---------------------------------------------------------------------------

loc_10019948:				; CODE XREF: sub_10019740+11Cj
					; sub_10019740+129j
					; DATA XREF: ...
		mov	[esp+20h+arg_0], 5 ; jumptable 10019869	default	case

loc_10019950:				; CODE XREF: sub_10019740+1D3j
					; sub_10019740+1DDj ...
		cmp	[esp+20h+var_4], ebx
		jnz	short loc_10019964
		cmp	[esp+20h+arg_0], ebx
		jnz	short loc_10019964
		mov	[esp+20h+arg_0], 82h

loc_10019964:				; CODE XREF: sub_10019740+214j
					; sub_10019740+21Aj
		mov	ebx, [esp+20h+arg_0]

loc_10019968:				; CODE XREF: sub_10019740+111j
		mov	eax, [esp+20h+var_10]
		pop	edi
		test	eax, eax
		jz	short loc_10019984
		push	eax
		call	sqlite3_reset
		mov	eax, [esp+20h+var_10]
		push	eax
		call	sqlite3_finalize
		add	esp, 8

loc_10019984:				; CODE XREF: sub_10019740+22Fj
		mov	eax, [esp+1Ch+var_C]
		test	eax, eax
		jz	short loc_1001999E
		cmp	[esi+4], eax
		jz	short loc_1001999E
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001999E:				; CODE XREF: sub_10019740+24Aj
					; sub_10019740+24Fj
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 10h
		retn
sub_10019740	endp

; ---------------------------------------------------------------------------
		align 4
off_100199A8	dd offset loc_1001990F,	offset loc_10019929, offset loc_10019915
					; DATA XREF: sub_10019740+129r
		dd offset loc_1001991F,	offset loc_1001993E, offset loc_10019948 ; jump	table for switch statement
byte_100199C0	db	0,     5,     5,     1 ; DATA XREF: sub_10019740+122r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

loc_10019A30:				; DATA XREF: sub_10019E70+56Bo
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax]
		push	edi
		mov	edi, 2
		cmp	[esi+18h], edi
		jz	short loc_10019A4A
		pop	edi
		mov	eax, 82h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019A4A:				; CODE XREF: .text:10019A40j
		mov	ecx, [esi+24h]
		push	ebp
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	dword ptr [esi+4], 0
		jz	short loc_10019A7B
		call	ds:PR_GetCurrentThread
		cmp	[esi+8], eax
		jnz	short loc_10019A7B
		mov	edx, [esi+24h]
		mov	ebp, [esi+4]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_10019A7E
; ---------------------------------------------------------------------------

loc_10019A7B:				; CODE XREF: .text:10019A5Cj
					; .text:10019A67j
		mov	ebp, [esi+0Ch]

loc_10019A7E:				; CODE XREF: .text:10019A79j
		mov	eax, [esi+1Ch]
		push	ebx
		push	eax
		push	offset aDropTableIfExi ; "DROP TABLE IF	EXISTS %s;"
		call	sqlite3_mprintf
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_10019AD5
		push	0
		push	0
		push	0
		push	ebx
		push	ebp
		call	sqlite3_exec
		push	ebx
		mov	edi, eax
		call	sqlite3_free
		add	esp, 18h
		test	edi, edi
		jnz	short loc_10019AC5
		push	edi
		push	edi
		push	edi
		push	offset aDropTableIfE_0 ; "DROP TABLE IF	EXISTS metaData;"
		push	ebp
		call	sqlite3_exec
		add	esp, 14h
		mov	edi, eax

loc_10019AC5:				; CODE XREF: .text:10019AB0j
		mov	ecx, [esi+18h]
		push	ecx
		mov	eax, edi
		call	sub_10017EC0
		add	esp, 4
		mov	edi, eax

loc_10019AD5:				; CODE XREF: .text:10019A94j
		pop	ebx
		test	ebp, ebp
		jz	short loc_10019AEC
		cmp	[esi+4], ebp
		jz	short loc_10019AEC
		mov	edx, [esi+24h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019AEC:				; CODE XREF: .text:10019AD8j
					; .text:10019ADDj
		pop	ebp
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019B00(void	*Memory)
sub_10019B00	proc near		; CODE XREF: sub_1001A510+156p
					; sub_1001A510+16Dp
					; DATA XREF: ...

Memory		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+Memory]
		push	ebp
		push	esi
		mov	esi, [ebx]
		mov	eax, [esi+0Ch]
		mov	ebp, [esi+18h]
		push	edi
		push	eax
		call	sqlite3_close
		mov	ecx, [esi]
		push	ecx
		mov	edi, eax
		call	PORT_Free_Util
		mov	eax, [esi+20h]
		add	esp, 8
		test	eax, eax
		jz	short loc_10019B33
		push	eax
		call	sqlite3_free
		add	esp, 4

loc_10019B33:				; CODE XREF: sub_10019B00+28j
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10019B44
		push	eax
		call	ds:PR_DestroyMonitor
		add	esp, 4

loc_10019B44:				; CODE XREF: sub_10019B00+38j
		push	esi		; Memory
		mov	esi, ds:free
		call	esi ; free
		push	ebx		; Memory
		call	esi ; free
		add	esp, 8
		cmp	edi, 65h	; switch 102 cases
		ja	short loc_10019B9D ; jumptable 10019B5F	default	case
		movzx	edx, ds:byte_10019BC0[edi]
		jmp	ds:off_10019BA8[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10019B66:				; CODE XREF: sub_10019B00+5Fj
					; DATA XREF: .text:off_10019BA8o
		pop	edi		; jumptable 10019B5F cases 0,101
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019B6D:				; CODE XREF: sub_10019B00+5Fj
					; DATA XREF: .text:off_10019BA8o
		pop	edi		; jumptable 10019B5F case 7
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019B77:				; CODE XREF: sub_10019B00+5Fj
					; DATA XREF: .text:off_10019BA8o
		pop	edi		; jumptable 10019B5F case 8
		pop	esi
		pop	ebp
		mov	eax, 0E2h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019B81:				; CODE XREF: sub_10019B00+5Fj
					; DATA XREF: .text:off_10019BA8o
		xor	eax, eax	; jumptable 10019B5F cases 3,12,14,23
		cmp	ebp, 1
		setnz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	eax, 0CE534351h
		retn
; ---------------------------------------------------------------------------

loc_10019B93:				; CODE XREF: sub_10019B00+5Fj
					; DATA XREF: .text:off_10019BA8o
		pop	edi		; jumptable 10019B5F case 10
		pop	esi
		pop	ebp
		mov	eax, 30h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019B9D:				; CODE XREF: sub_10019B00+56j
					; sub_10019B00+5Fj
					; DATA XREF: ...
		pop	edi		; jumptable 10019B5F default case
		pop	esi
		pop	ebp
		mov	eax, 5
		pop	ebx
		retn
sub_10019B00	endp

; ---------------------------------------------------------------------------
		align 4
off_10019BA8	dd offset loc_10019B66,	offset loc_10019B81, offset loc_10019B6D
					; DATA XREF: sub_10019B00+5Fr
		dd offset loc_10019B77,	offset loc_10019B93, offset loc_10019B9D ; jump	table for switch statement
byte_10019BC0	db	0,     5,     5,     1 ; DATA XREF: sub_10019B00+58r
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019C30	proc near		; CODE XREF: sub_10019E70+3C9p

arg_0		= dword	ptr  4

		push	esi
		push	eax
		push	offset aSelectAllFromS ; "SELECT ALL * FROM %s LIMIT 0;"
		call	sqlite3_mprintf
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10019C47
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019C47:				; CODE XREF: sub_10019C30+13j
		mov	ecx, [esp+4+arg_0]
		push	edi
		push	0
		push	0
		push	0
		push	esi
		push	ecx
		call	sqlite3_exec
		push	esi
		mov	edi, eax
		call	sqlite3_free
		add	esp, 18h
		xor	eax, eax
		test	edi, edi
		pop	edi
		setz	al
		pop	esi
		retn
sub_10019C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019C70	proc near		; DATA XREF: sub_10019E70+54Fo

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [eax]
		push	esi
		xor	esi, esi
		test	byte ptr [eax+0Ch], 1
		mov	[esp+14h+arg_0], esi
		mov	[esp+14h+var_4], esi
		mov	ebx, offset aInsertIntoMeta ; "INSERT INTO metaData (id,item1,item2) V"...
		jz	short loc_10019C9D
		pop	esi
		pop	ebp
		mov	eax, 0E2h
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10019C9D:				; CODE XREF: sub_10019C70+1Fj
		mov	eax, [ebp+24h]
		push	edi
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4
		cmp	[ebp+4], esi
		jz	short loc_10019CD1
		call	ds:PR_GetCurrentThread
		cmp	[ebp+8], eax
		jnz	short loc_10019CD1
		mov	ecx, [ebp+24h]
		mov	edi, [ebp+4]
		push	ecx
		mov	[esp+1Ch+var_8], edi
		call	ds:PR_ExitMonitor
		add	esp, 4
		jmp	short loc_10019CDA
; ---------------------------------------------------------------------------

loc_10019CD1:				; CODE XREF: sub_10019C70+3Ej
					; sub_10019C70+49j
		mov	edx, [ebp+0Ch]
		mov	[esp+18h+var_8], edx
		mov	edi, edx

loc_10019CDA:				; CODE XREF: sub_10019C70+5Fj
		push	offset aMetadata ; "metaData"
		push	offset aSelectAllFromS ; "SELECT ALL * FROM %s LIMIT 0;"
		call	sqlite3_mprintf
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10019D19
		push	0
		push	0
		push	0
		push	esi
		push	edi
		call	sqlite3_exec
		push	esi
		mov	edi, eax
		call	sqlite3_free
		xor	eax, eax
		add	esp, 18h
		test	edi, edi
		setz	al
		test	eax, eax
		jnz	short loc_10019D37
		mov	edi, [esp+18h+var_8]

loc_10019D19:				; CODE XREF: sub_10019C70+80j
		push	0
		push	0
		push	0
		push	offset aCreateTableMet ; "CREATE TABLE metaData	(id PRIMARY KEY	U"...
		push	edi
		call	sqlite3_exec
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10019E0C

loc_10019D37:				; CODE XREF: sub_10019C70+A3j
		mov	edi, [esp+18h+arg_C]
		test	edi, edi
		jnz	short loc_10019D44
		mov	ebx, offset aInsertIntoMe_0 ; "INSERT INTO metaData (id,item1) VALUES("...

loc_10019D44:				; CODE XREF: sub_10019C70+CDj
		mov	ecx, [esp+18h+var_8]
		push	0
		lea	eax, [esp+1Ch+arg_0]
		push	eax
		push	0FFFFFFFFh
		push	ebx
		push	ecx
		call	sqlite3_prepare_v2
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10019E08
		mov	edx, [esp+18h+arg_4]
		mov	eax, edx
		lea	esi, [eax+1]
		mov	edi, edi

loc_10019D70:				; CODE XREF: sub_10019C70+105j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10019D70
		push	0
		sub	eax, esi
		push	eax
		push	edx
		mov	edx, [esp+24h+arg_0]
		push	1
		push	edx
		call	sqlite3_bind_text
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10019E08
		push	eax
		mov	eax, [esp+1Ch+arg_8]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [esp+1Ch+arg_0]
		push	ecx
		push	edx
		push	2
		push	eax
		call	sqlite3_bind_blob
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10019E08
		test	edi, edi
		jz	short loc_10019DD6
		mov	ecx, [edi+8]
		mov	edx, [edi+4]
		push	eax
		mov	eax, [esp+1Ch+arg_0]
		push	ecx
		push	edx
		push	3
		push	eax
		call	sqlite3_bind_blob
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10019E08

loc_10019DD6:				; CODE XREF: sub_10019C70+146j
		mov	edi, ds:PR_Sleep
		lea	esp, [esp+0]

loc_10019DE0:				; CODE XREF: sub_10019C70+196j
					; sub_10019C70+1F4j
		mov	ecx, [esp+18h+arg_0]
		push	ecx
		call	sqlite3_step
		mov	esi, eax
		add	esp, 4
		cmp	esi, 5
		jnz	short loc_10019E57
		push	eax
		call	edi ; PR_Sleep
		mov	eax, [esp+1Ch+var_4]
		inc	eax
		add	esp, 4
		mov	[esp+18h+var_4], eax
		cmp	eax, 0Ah
		jl	short loc_10019DE0

loc_10019E08:				; CODE XREF: sub_10019C70+EFj
					; sub_10019C70+120j ...
		mov	edi, [esp+18h+var_8]

loc_10019E0C:				; CODE XREF: sub_10019C70+C1j
		mov	edx, [ebp+18h]
		push	edx
		mov	eax, esi
		call	sub_10017EC0
		mov	esi, eax
		mov	eax, [esp+1Ch+arg_0]
		add	esp, 4
		test	eax, eax
		jz	short loc_10019E37
		push	eax
		call	sqlite3_reset
		mov	eax, [esp+1Ch+arg_0]
		push	eax
		call	sqlite3_finalize
		add	esp, 8

loc_10019E37:				; CODE XREF: sub_10019C70+1B2j
		test	edi, edi
		jz	short loc_10019E4D
		cmp	[ebp+4], edi
		jz	short loc_10019E4D
		mov	ecx, [ebp+24h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019E4D:				; CODE XREF: sub_10019C70+1C9j
					; sub_10019C70+1CEj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10019E57:				; CODE XREF: sub_10019C70+182j
		cmp	esi, 64h
		jnz	short loc_10019E08
		mov	[esp+18h+var_4], 0
		jmp	loc_10019DE0
sub_10019C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019E70(char	*, int,	int, int, int, int, int, int)
sub_10019E70	proc near		; CODE XREF: sub_1001A510+EAp
					; sub_1001A510+115p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_1C]
		mov	ecx, [esp+10h+arg_C]
		push	ebx
		push	ebp
		mov	ebp, [esp+18h+arg_0]
		push	esi
		xor	esi, esi
		push	edi
		push	1
		mov	[eax], esi
		push	ebp
		mov	[esp+28h+var_C], esi
		xor	ebx, ebx
		mov	[esp+28h+var_10], esi
		mov	[esp+28h+var_8], esi
		mov	[esp+28h+var_4], esi
		mov	[ecx], esi
		call	ds:PR_Access
		add	esp, 8
		neg	eax
		sbb	edi, edi
		mov	eax, 1
		neg	edi
		cmp	[esp+20h+arg_14], eax
		jnz	short loc_10019ED0
		test	edi, edi
		jz	short loc_10019ED0
		xor	edx, edx
		cmp	[esp+20h+arg_8], eax
		setnz	dl
		lea	edi, [edx-31ACBCAFh]
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019ED0:				; CODE XREF: sub_10019E70+46j
					; sub_10019E70+4Aj
		lea	eax, [esp+20h+var_10]
		push	eax
		push	ebp
		mov	[esp+28h+var_10], ebx
		call	sqlite3_open
		add	esp, 8
		test	eax, eax
		jnz	short loc_10019F15
		mov	ecx, [esp+20h+var_10]
		push	3E8h
		push	ecx
		call	sqlite3_busy_timeout
		add	esp, 8
		mov	[esp+20h+arg_C], eax
		test	eax, eax
		jz	short loc_10019F6C
		mov	edx, [esp+20h+var_10]
		push	edx
		call	sqlite3_close
		mov	eax, [esp+24h+arg_C]
		add	esp, 4
		mov	[esp+20h+var_10], ebx

loc_10019F15:				; CODE XREF: sub_10019E70+74j
		cmp	eax, 65h	; switch 102 cases
		ja	short loc_10019F62 ; jumptable 10019F21	default	case
		movzx	eax, ds:byte_1001A4A0[eax]
		jmp	ds:off_1001A488[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10019F28:				; CODE XREF: sub_10019E70+B1j
					; DATA XREF: .text:off_1001A488o
		xor	edi, edi	; jumptable 10019F21 cases 0,101
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F2F:				; CODE XREF: sub_10019E70+B1j
					; DATA XREF: .text:off_1001A488o
		mov	edi, 2		; jumptable 10019F21 case 7
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F39:				; CODE XREF: sub_10019E70+B1j
					; DATA XREF: .text:off_1001A488o
		mov	edi, 0E2h	; jumptable 10019F21 case 8
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F43:				; CODE XREF: sub_10019E70+B1j
					; DATA XREF: .text:off_1001A488o
		xor	ecx, ecx	; jumptable 10019F21 cases 3,12,14,23
		cmp	[esp+20h+arg_8], 1
		setnz	cl
		lea	edi, [ecx-31ACBCAFh]
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F58:				; CODE XREF: sub_10019E70+B1j
					; DATA XREF: .text:off_1001A488o
		mov	edi, 30h	; jumptable 10019F21 case 10
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F62:				; CODE XREF: sub_10019E70+A8j
					; sub_10019E70+B1j
					; DATA XREF: ...
		mov	edi, 5		; jumptable 10019F21 default case
		jmp	loc_1001A456
; ---------------------------------------------------------------------------

loc_10019F6C:				; CODE XREF: sub_10019E70+8Ej
		test	edi, edi
		jz	short loc_10019F7F
		push	180h		; int
		push	ebp		; char *
		call	ds:_chmod
		add	esp, 8

loc_10019F7F:				; CODE XREF: sub_10019E70+FEj
		mov	edi, 1
		cmp	[esp+20h+arg_14], edi
		jz	short loc_10019FBB
		mov	edx, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	offset aBeginImmediate ; "BEGIN	IMMEDIATE TRANSACTION;"
		push	edx
		call	sqlite3_exec
		add	esp, 14h
		test	eax, eax
		jz	short loc_10019FB7
		mov	ecx, [esp+20h+arg_8]
		push	ecx
		call	sub_10017EC0
		mov	edi, eax
		jmp	loc_1001A453
; ---------------------------------------------------------------------------

loc_10019FB7:				; CODE XREF: sub_10019E70+134j
		mov	[esp+20h+var_C], edi

loc_10019FBB:				; CODE XREF: sub_10019E70+118j
		mov	ebp, [esp+20h+arg_4]
		mov	edx, [esp+20h+var_10]
		push	ebp
		push	offset aSelectAllFromS ; "SELECT ALL * FROM %s LIMIT 0;"
		mov	[esp+28h+arg_C], edx
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1001A00A
		mov	eax, [esp+20h+arg_C]
		push	0
		push	0
		push	0
		push	edi
		push	eax
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		xor	eax, eax
		add	esp, 18h
		cmp	[esp+20h+arg_C], eax
		setz	al
		test	eax, eax
		jnz	loc_1001A228

loc_1001A00A:				; CODE XREF: sub_10019E70+169j
		cmp	[esp+20h+arg_14], 4
		mov	ecx, [esp+20h+arg_10]
		mov	dword ptr [ecx], 1
		jz	short loc_1001A030
		xor	edx, edx
		cmp	[esp+20h+arg_8], 1
		setnz	dl
		lea	edi, [edx-31ACBCAFh]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A030:				; CODE XREF: sub_10019E70+1A9j
		push	offset word_10026FE6
		call	sqlite3_mprintf
		mov	edi, eax
		xor	eax, eax
		add	esp, 4
		mov	[esp+20h+arg_C], eax
		test	edi, edi
		jz	short loc_1001A094
		jmp	short loc_1001A058
; ---------------------------------------------------------------------------
		jmp	short loc_1001A050
; ---------------------------------------------------------------------------
		align 10h

loc_1001A050:				; CODE XREF: sub_10019E70+1DBj
					; sub_10019E70+216j
		mov	eax, [esp+20h+arg_C]
		mov	ebp, [esp+20h+arg_4]

loc_1001A058:				; CODE XREF: sub_10019E70+1D9j
		cmp	eax, dword_10029220
		jge	short loc_1001A090
		mov	eax, ds:dword_10027360[eax*4]
		push	eax
		push	edi
		push	offset aSAX	; "%s, a%x"
		call	sqlite3_mprintf
		push	edi
		mov	ebp, eax
		call	sqlite3_free
		inc	[esp+30h+arg_C]
		add	esp, 10h
		mov	edi, ebp
		test	ebp, ebp
		jnz	short loc_1001A050
		lea	edi, [ebp+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A090:				; CODE XREF: sub_10019E70+1EEj
		test	edi, edi
		jnz	short loc_1001A09E

loc_1001A094:				; CODE XREF: sub_10019E70+1D7j
		mov	edi, 2
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A09E:				; CODE XREF: sub_10019E70+222j
		push	edi
		push	ebp
		push	offset aCreateTableSId ; "CREATE TABLE %s (id PRIMARY KEY UNIQUE "...
		call	sqlite3_mprintf
		push	edi
		mov	[esp+30h+arg_C], eax
		call	sqlite3_free
		mov	edi, [esp+30h+arg_C]
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1001A0C9
		mov	edi, 2
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A0C9:				; CODE XREF: sub_10019E70+24Dj
		mov	ecx, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	edi
		push	ecx
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		mov	eax, [esp+38h+arg_C]
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001A0F8
		mov	edx, [esp+20h+arg_8]
		jmp	loc_1001A412
; ---------------------------------------------------------------------------

loc_1001A0F8:				; CODE XREF: sub_10019E70+27Dj
		push	ebp
		push	offset aCreateIndexIss ; "CREATE INDEX issuer ON %s (a81)"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001A114
		lea	edi, [eax+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A114:				; CODE XREF: sub_10019E70+29Aj
		mov	eax, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	edi
		push	eax
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		mov	eax, [esp+38h+arg_C]
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001A144
		mov	ecx, [esp+20h+arg_8]
		push	ecx
		jmp	loc_1001A413
; ---------------------------------------------------------------------------

loc_1001A144:				; CODE XREF: sub_10019E70+2C8j
		push	ebp
		push	offset aCreateIndexSub ; "CREATE INDEX subject ON %s (a101)"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001A160
		lea	edi, [eax+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A160:				; CODE XREF: sub_10019E70+2E6j
		mov	edx, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	edi
		push	edx
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		mov	eax, [esp+38h+arg_C]
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001A190
		mov	ecx, [esp+20h+arg_8]
		push	ecx
		jmp	loc_1001A413
; ---------------------------------------------------------------------------

loc_1001A190:				; CODE XREF: sub_10019E70+314j
		push	ebp
		push	offset aCreateIndexLab ; "CREATE INDEX label ON	%s (a3)"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001A1AC
		lea	edi, [eax+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A1AC:				; CODE XREF: sub_10019E70+332j
		mov	edx, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	edi
		push	edx
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		mov	eax, [esp+38h+arg_C]
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001A1DC
		mov	ecx, [esp+20h+arg_8]
		push	ecx
		jmp	loc_1001A413
; ---------------------------------------------------------------------------

loc_1001A1DC:				; CODE XREF: sub_10019E70+360j
		push	ebp
		push	offset aCreateIndexCka ; "CREATE INDEX ckaid ON	%s (a102)"
		call	sqlite3_mprintf
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001A1F8
		lea	edi, [eax+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A1F8:				; CODE XREF: sub_10019E70+37Ej
		mov	edx, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	edi
		push	edx
		call	sqlite3_exec
		push	edi
		mov	[esp+38h+arg_C], eax
		call	sqlite3_free
		mov	eax, [esp+38h+arg_C]
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001A228
		mov	ecx, [esp+20h+arg_8]
		push	ecx
		jmp	loc_1001A413
; ---------------------------------------------------------------------------

loc_1001A228:				; CODE XREF: sub_10019E70+194j
					; sub_10019E70+3ACj
		cmp	[esp+20h+arg_8], 2
		jnz	short loc_1001A24F
		mov	edx, [esp+20h+var_10]
		push	edx
		mov	eax, offset aMetadata ;	"metaData"
		call	sub_10019C30
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001A24F
		mov	eax, [esp+20h+arg_10]
		mov	dword ptr [eax], 1

loc_1001A24F:				; CODE XREF: sub_10019E70+3BDj
					; sub_10019E70+3D3j
		push	offset aNss_sdb_use_ca ; "NSS_SDB_USE_CACHE"
		call	ds:PR_GetEnv
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1001A28B
		push	offset aNo	; "no"
		push	edi
		call	PL_strcasecmp
		add	esp, 8
		test	eax, eax
		jz	loc_1001A320
		push	offset aYes	; "yes"
		push	edi
		call	PL_strcasecmp
		add	esp, 8
		test	eax, eax
		jz	short loc_1001A2C4

loc_1001A28B:				; CODE XREF: sub_10019E70+3F1j
		mov	ecx, [esp+20h+var_10]
		call	sub_10017E50
		mov	edi, eax
		test	edi, edi
		jz	loc_1001A320
		push	edi
		call	sub_10017F90
		push	edi
		mov	[esp+28h+arg_C], eax
		call	PORT_Free_Util
		mov	eax, [esp+28h+arg_18]
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		add	esp, 8
		cmp	ecx, [esp+20h+arg_C]
		sbb	edx, edx
		neg	edx
		jz	short loc_1001A320

loc_1001A2C4:				; CODE XREF: sub_10019E70+419j
		mov	eax, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	offset aPragmaTemp_sto ; "PRAGMA temp_store=MEMORY"
		push	eax
		call	sqlite3_exec
		push	ebp
		push	offset aScache	; "%sCache"
		call	sqlite3_mprintf
		mov	ecx, eax
		add	esp, 1Ch
		mov	[esp+20h+var_8], ecx
		test	ecx, ecx
		jnz	short loc_1001A2F9
		lea	edi, [eax+2]
		jmp	loc_1001A41D
; ---------------------------------------------------------------------------

loc_1001A2F9:				; CODE XREF: sub_10019E70+47Fj
		mov	edx, [esp+20h+arg_8]
		mov	edi, [esp+20h+var_10]
		push	edx
		mov	eax, ebp
		call	sub_10018080
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	loc_1001A41D
		call	ds:PR_IntervalNow
		mov	[esp+20h+var_4], eax

loc_1001A320:				; CODE XREF: sub_10019E70+403j
					; sub_10019E70+428j ...
		mov	edi, ds:malloc
		push	50h		; Size
		call	edi ; malloc
		push	28h		; Size
		mov	esi, eax
		call	edi ; malloc
		mov	ebx, eax
		mov	eax, [esp+28h+arg_0]
		push	eax
		call	PORT_Strdup_Util
		mov	ecx, [esp+2Ch+arg_8]
		mov	edx, [esp+2Ch+var_8]
		mov	[ebx], eax
		mov	eax, [esp+2Ch+var_4]
		push	0Ah
		mov	[ebx+18h], ecx
		mov	[ebx+1Ch], ebp
		mov	[ebx+20h], edx
		mov	[ebx+10h], eax
		call	ds:PR_SecondsToInterval
		add	esp, 10h
		mov	[ebx+14h], eax
		call	ds:PR_NewMonitor
		mov	[ebx+24h], eax
		mov	eax, [esp+20h+arg_14]
		xor	edi, edi
		mov	[ebx+4], edi
		mov	[ebx+8], edi
		or	eax, 8
		mov	[esi], ebx
		mov	[esi+4], edi
		mov	[esi+0Ch], eax
		mov	[esi+10h], edi
		mov	dword ptr [esi+14h], offset sub_10018320
		mov	dword ptr [esi+18h], offset loc_100185A0
		mov	dword ptr [esi+1Ch], offset loc_10018720
		mov	dword ptr [esi+20h], offset loc_10018B80
		mov	dword ptr [esi+24h], offset sub_10018BA0
		mov	dword ptr [esi+28h], offset sub_10018F40
		mov	dword ptr [esi+2Ch], offset loc_100192B0
		mov	dword ptr [esi+30h], offset sub_10019740
		mov	dword ptr [esi+34h], offset sub_10019C70
		mov	dword ptr [esi+38h], offset loc_100193F0
		mov	dword ptr [esi+3Ch], offset loc_10019700
		mov	dword ptr [esi+40h], offset loc_10019720
		mov	dword ptr [esi+44h], offset loc_10019A30
		mov	dword ptr [esi+48h], offset sub_10019B00
		mov	dword ptr [esi+4Ch], offset nullsub_1
		cmp	[esp+20h+var_C], edi
		jz	short loc_1001A471
		mov	ecx, [esp+20h+var_10]
		push	edi
		push	edi
		push	edi
		push	offset aCommitTransact ; "COMMIT TRANSACTION;"
		push	ecx
		call	sqlite3_exec
		add	esp, 14h
		cmp	eax, edi
		jz	short loc_1001A471
		mov	edx, [ebx+18h]

loc_1001A412:				; CODE XREF: sub_10019E70+283j
		push	edx

loc_1001A413:				; CODE XREF: sub_10019E70+2CFj
					; sub_10019E70+31Bj ...
		call	sub_10017EC0
		mov	edi, eax
		add	esp, 4

loc_1001A41D:				; CODE XREF: sub_10019E70+1BBj
					; sub_10019E70+21Bj ...
		cmp	[esp+20h+var_C], 0
		jz	short loc_1001A43C
		mov	eax, [esp+20h+var_10]
		push	0
		push	0
		push	0
		push	offset aRollbackTransa ; "ROLLBACK TRANSACTION;"
		push	eax
		call	sqlite3_exec
		add	esp, 14h

loc_1001A43C:				; CODE XREF: sub_10019E70+5B2j
		mov	ebp, ds:free
		test	esi, esi
		jz	short loc_1001A44C
		push	esi		; Memory
		call	ebp ; free
		add	esp, 4

loc_1001A44C:				; CODE XREF: sub_10019E70+5D4j
		test	ebx, ebx
		jz	short loc_1001A456
		push	ebx		; Memory
		call	ebp ; free

loc_1001A453:				; CODE XREF: sub_10019E70+142j
		add	esp, 4

loc_1001A456:				; CODE XREF: sub_10019E70+5Bj
					; sub_10019E70+BAj ...
		mov	eax, [esp+20h+var_10]
		test	eax, eax
		jz	short loc_1001A467
		push	eax
		call	sqlite3_close
		add	esp, 4

loc_1001A467:				; CODE XREF: sub_10019E70+5ECj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001A471:				; CODE XREF: sub_10019E70+584j
					; sub_10019E70+59Dj
		mov	ecx, [esp+20h+var_10]
		mov	edx, [esp+20h+arg_1C]
		pop	edi
		mov	[ebx+0Ch], ecx
		mov	[edx], esi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
sub_10019E70	endp

; ---------------------------------------------------------------------------
off_1001A488	dd offset loc_10019F28,	offset loc_10019F43, offset loc_10019F2F
					; DATA XREF: sub_10019E70+B1r
		dd offset loc_10019F39,	offset loc_10019F58, offset loc_10019F62 ; jump	table for switch statement
byte_1001A4A0	db	0,     5,     5,     1 ; DATA XREF: sub_10019E70+AAr
		db	5,     5,     5,     2 ; indirect table	for switch statement
		db	3,     5,     4,     5
		db	1,     5,     1,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A510	proc near		; CODE XREF: sub_1001CFB0+151p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 8
		mov	eax, [esp+8+arg_C]
		mov	ecx, [esp+8+arg_4]
		push	esi
		mov	esi, ds:PR_GetDirectorySeparator
		push	edi
		push	eax
		push	offset aCert	; "cert"
		push	ecx
		call	esi ; PR_GetDirectorySeparator
		mov	edi, [esp+1Ch+arg_0]
		movzx	edx, al
		push	edx
		push	edi
		push	offset aSCSSD_db ; "%s%c%s%s%d.db"
		call	sqlite3_mprintf
		mov	ecx, [esp+28h+arg_8]
		add	esp, 18h
		mov	[esp+10h+var_8], eax
		mov	eax, [esp+10h+arg_10]
		push	eax
		push	offset aKey	; "key"
		push	ecx
		call	esi ; PR_GetDirectorySeparator
		movzx	edx, al
		push	edx
		push	edi
		push	offset aSCSSD_db ; "%s%c%s%s%d.db"
		call	sqlite3_mprintf
		mov	[esp+28h+var_4], eax
		mov	eax, [esp+28h+arg_18]
		add	esp, 18h
		xor	esi, esi
		test	eax, eax
		jz	short loc_1001A579
		mov	[eax], esi

loc_1001A579:				; CODE XREF: sub_1001A510+65j
		mov	eax, [esp+10h+arg_1C]
		test	eax, eax
		jz	short loc_1001A583
		mov	[eax], esi

loc_1001A583:				; CODE XREF: sub_1001A510+6Fj
		push	ebx
		mov	ebx, [esp+14h+arg_20]
		push	ebp
		push	offset aNss_sdb_use_ca ; "NSS_SDB_USE_CACHE"
		mov	[ebx], esi
		mov	edi, 1
		call	ds:PR_GetEnv
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_1001A5C8
		push	offset aNo	; "no"
		push	ebp
		call	PL_strcasecmp
		add	esp, 8
		test	eax, eax
		jz	short loc_1001A5D7
		push	offset aYes	; "yes"
		push	ebp
		call	PL_strcasecmp
		add	esp, 8
		test	eax, eax
		jz	short loc_1001A5D7

loc_1001A5C8:				; CODE XREF: sub_1001A510+92j
		mov	eax, [esp+18h+arg_0]
		push	eax
		call	sub_10017F90
		add	esp, 4
		mov	edi, eax

loc_1001A5D7:				; CODE XREF: sub_1001A510+A4j
					; sub_1001A510+B6j
		mov	ebp, [esp+18h+arg_14]
		cmp	[esp+18h+arg_18], esi
		jz	short loc_1001A608
		mov	ecx, [esp+18h+arg_18]
		mov	eax, [esp+18h+var_8]
		push	ecx		; int
		push	edi		; int
		push	ebp		; int
		push	ebx		; int
		lea	edx, [esp+28h+arg_20]
		push	edx		; int
		push	1		; int
		push	offset aNsspublic ; "nssPublic"
		push	eax		; char *
		call	sub_10019E70
		mov	esi, eax
		add	esp, 20h
		test	esi, esi
		jnz	short loc_1001A62F

loc_1001A608:				; CODE XREF: sub_1001A510+CFj
		mov	eax, [esp+18h+arg_1C]
		test	eax, eax
		jz	short loc_1001A62F
		mov	edx, [esp+18h+var_4]
		push	eax		; int
		push	edi		; int
		push	ebp		; int
		push	ebx		; int
		lea	ecx, [esp+28h+arg_20]
		push	ecx		; int
		push	2		; int
		push	offset aNssprivate ; "nssPrivate"
		push	edx		; char *
		call	sub_10019E70
		add	esp, 20h
		mov	esi, eax

loc_1001A62F:				; CODE XREF: sub_1001A510+F6j
					; sub_1001A510+FEj
		mov	eax, [esp+18h+var_8]
		pop	ebp
		pop	ebx
		test	eax, eax
		jz	short loc_1001A642
		push	eax
		call	sqlite3_free
		add	esp, 4

loc_1001A642:				; CODE XREF: sub_1001A510+127j
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jz	short loc_1001A653
		push	eax
		call	sqlite3_free
		add	esp, 4

loc_1001A653:				; CODE XREF: sub_1001A510+138j
		test	esi, esi
		jz	short loc_1001A685
		mov	eax, [esp+10h+arg_1C]
		test	eax, eax
		jz	short loc_1001A66E
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1001A66E
		push	eax		; Memory
		call	sub_10019B00
		add	esp, 4

loc_1001A66E:				; CODE XREF: sub_1001A510+14Dj
					; sub_1001A510+153j
		mov	eax, [esp+10h+arg_18]
		test	eax, eax
		jz	short loc_1001A685
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1001A685
		push	eax		; Memory
		call	sub_10019B00
		add	esp, 4

loc_1001A685:				; CODE XREF: sub_1001A510+145j
					; sub_1001A510+164j ...
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
sub_1001A510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A690	proc near		; CODE XREF: sub_1001A730+2Ep
					; sub_1001A730+CFp ...
		cmp	eax, 134h
		ja	short loc_1001A6C6
		cmp	eax, 133h
		jnb	short loc_1001A6F2
		cmp	eax, 88h
		ja	short loc_1001A6BA
		cmp	eax, 87h
		jnb	short loc_1001A6F2
		test	eax, eax
		jz	short loc_1001A6F2
		cmp	eax, 80h

loc_1001A6B5:				; CODE XREF: sub_1001A690+34j
					; sub_1001A690+52j
		jz	short loc_1001A6F2

loc_1001A6B7:				; CODE XREF: sub_1001A690+44j
					; sub_1001A690+59j ...
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001A6BA:				; CODE XREF: sub_1001A690+13j
		sub	eax, 100h
		jz	short loc_1001A6F2
		sub	eax, 21h
		jmp	short loc_1001A6B5
; ---------------------------------------------------------------------------

loc_1001A6C6:				; CODE XREF: sub_1001A690+5j
		cmp	eax, 500h
		ja	short loc_1001A6E4
		jz	short loc_1001A6F2
		cmp	eax, 160h
		jb	short loc_1001A6B7
		cmp	eax, 161h
		jbe	short loc_1001A6F2
		cmp	eax, 166h
		jmp	short loc_1001A6B5
; ---------------------------------------------------------------------------

loc_1001A6E4:				; CODE XREF: sub_1001A690+3Bj
		cmp	eax, 0CE536351h
		jb	short loc_1001A6B7
		cmp	eax, 0CE536360h
		ja	short loc_1001A6B7

loc_1001A6F2:				; CODE XREF: sub_1001A690+Cj
					; sub_1001A690+1Aj ...
		mov	eax, 1
		retn
sub_1001A690	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A700	proc near		; CODE XREF: sub_1001B4C0+131p
					; sub_1001EA40+94p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		mov	edx, eax
		shr	edx, 18h
		mov	[ecx], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[ecx+1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[ecx+2], dl
		mov	[ecx+3], al
		retn
sub_1001A700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A730	proc near		; CODE XREF: sub_1001BA20+35p
					; sub_1001BB30+9Cp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	eax, [esp+4+arg_8]
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		xor	esi, esi
		mov	[eax], esi
		test	edi, edi
		jle	short loc_1001A772
		lea	ecx, [ebx+8]
		mov	edx, edi
		lea	ecx, [ecx+0]

loc_1001A750:				; CODE XREF: sub_1001A730+3Cj
		cmp	dword ptr [ecx-4], 0
		jz	short loc_1001A768
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001A768
		mov	eax, [ecx-8]
		call	sub_1001A690
		test	eax, eax
		jz	short loc_1001A768
		inc	esi

loc_1001A768:				; CODE XREF: sub_1001A730+24j
					; sub_1001A730+29j ...
		add	ecx, 0Ch
		dec	edx
		jnz	short loc_1001A750
		test	esi, esi
		jnz	short loc_1001A779

loc_1001A772:				; CODE XREF: sub_1001A730+16j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001A779:				; CODE XREF: sub_1001A730+40j
		lea	ecx, ds:0[esi*4]
		push	ecx
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001A794
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001A794:				; CODE XREF: sub_1001A730+5Dj
		lea	edx, [edi+edi*2]
		add	edx, edx
		add	edx, edx
		push	ebp
		push	edx
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		mov	[esp+14h+var_4], ebp
		test	ebp, ebp
		jnz	short loc_1001A7C0
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001A7C0:				; CODE XREF: sub_1001A730+7Dj
		mov	eax, [esp+14h+arg_8]
		mov	edx, [esp+14h+arg_4]
		mov	[eax], esi
		lea	ecx, [esi+2]
		lea	esi, [ebx+4]
		mov	ebx, ebp
		sub	ebx, [esp+14h+arg_0]
		mov	edi, ebp
		mov	[esp+14h+arg_8], edx
		lea	esp, [esp+0]

loc_1001A7E0:				; CODE XREF: sub_1001A730+112j
		mov	eax, [esi-4]
		mov	[edi], eax
		mov	edx, [esi]
		mov	[edi+4], edx
		mov	eax, [esi+4]
		mov	[edi+8], eax
		mov	edx, [esi]
		test	edx, edx
		jz	short loc_1001A838
		cmp	dword ptr [esi+4], 4
		jnz	short loc_1001A838
		mov	eax, [esi-4]
		call	sub_1001A690
		test	eax, eax
		jz	short loc_1001A838
		mov	eax, [edx]
		lea	ebp, [ecx-2]
		mov	edx, eax
		shr	edx, 18h
		mov	[ebp+0], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[ecx-1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[ecx], dl
		mov	[ecx+1], al
		mov	[ebx+esi], ebp
		mov	ebp, [esp+14h+var_4]
		mov	dword ptr [edi+8], 4
		add	ecx, 4

loc_1001A838:				; CODE XREF: sub_1001A730+C4j
					; sub_1001A730+CAj ...
		add	esi, 0Ch
		add	edi, 0Ch
		dec	[esp+14h+arg_8]
		jnz	short loc_1001A7E0
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_1001A730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A850	proc near		; CODE XREF: sub_1001AC80+145p
					; sub_1001F1E0+1F7p

Dest		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		cmp	dword ptr [eax+8], 40000000h
		push	esi
		mov	esi, [esp+28h+arg_4]
		push	edi
		mov	edi, [esp+2Ch+arg_10]
		mov	eax, offset aKey ; "key"
		jz	short loc_1001A87F
		mov	eax, offset aCert ; "cert"

loc_1001A87F:				; CODE XREF: sub_1001A850+28j
		mov	ecx, [esp+2Ch+arg_C]
		mov	edx, [esp+2Ch+arg_8]
		push	ecx
		push	edx
		push	eax
		lea	eax, [esp+38h+Dest]
		push	offset Format	; "sig_%s_%08x_%08x"
		push	eax		; Dest
		call	ds:sprintf
		mov	edx, [esi+34h]
		push	0
		push	edi
		lea	ecx, [esp+48h+Dest]
		push	ecx
		push	esi
		call	edx
		mov	ecx, [esp+50h+var_4]
		add	esp, 24h
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001A850	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A8C0	proc near		; CODE XREF: sub_1001BB30+D5p

var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= byte ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= byte ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= byte ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
Dest		= byte ptr -124h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 168h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+168h+var_4], eax
		mov	eax, [esp+168h+arg_0]
		push	ebx
		mov	ebx, [esp+16Ch+arg_8]
		push	esi
		mov	esi, 1
		push	edi
		xor	edi, edi
		cmp	dword ptr [edx+8], 40000000h
		mov	[esp+174h+var_15C], esi
		mov	[esp+174h+var_150], esi
		mov	esi, edx
		mov	[esp+174h+var_160], edx
		mov	[esp+174h+var_168], edi
		mov	[esp+174h+var_164], esi
		jz	short loc_1001A918
		mov	edx, [edx+28h]
		mov	[esp+174h+var_150], edi
		mov	[esp+174h+var_164], edx
		mov	esi, edx

loc_1001A918:				; CODE XREF: sub_1001A8C0+49j
		cmp	esi, edi
		jz	short loc_1001A930
		mov	edx, [esi+2Ch]
		cmp	edx, edi
		jnz	short loc_1001A925
		mov	edx, [esi]

loc_1001A925:				; CODE XREF: sub_1001A8C0+61j
		test	byte ptr [edx+0Ch], 8
		jz	short loc_1001A930
		cmp	[esi+10h], edi
		jnz	short loc_1001A934

loc_1001A930:				; CODE XREF: sub_1001A8C0+5Aj
					; sub_1001A8C0+69j
		mov	[esp+174h+var_15C], edi

loc_1001A934:				; CODE XREF: sub_1001A8C0+6Ej
		cmp	ebx, edi
		jle	loc_1001AC59
		push	ebp
		mov	ebp, eax
		sub	ebp, ecx
		lea	esi, [eax+8]
		lea	edi, [ecx+4]
		mov	[esp+178h+var_154], ebp
		mov	[esp+178h+var_14C], ebx
		nop

loc_1001A950:				; CODE XREF: sub_1001A8C0+376j
		mov	eax, [edi+4]
		mov	ebx, [esi]
		mov	[esi], eax
		cmp	dword ptr [edi+4], 4
		jnz	short loc_1001A9AE
		mov	eax, [esi-8]
		call	sub_1001A690
		test	eax, eax
		jz	short loc_1001A9AE
		mov	edx, [edi+ebp]
		test	edx, edx
		jz	short loc_1001A9A8
		mov	ecx, [edi]
		movzx	eax, byte ptr [ecx]
		movzx	ebp, byte ptr [ecx+1]
		shl	eax, 8
		or	eax, ebp
		movzx	ebp, byte ptr [ecx+2]
		movzx	ecx, byte ptr [ecx+3]
		shl	eax, 8
		or	eax, ebp
		mov	ebp, [esp+178h+var_154]
		shl	eax, 8
		or	eax, ecx
		cmp	ebx, 4
		jnb	short loc_1001A9A6
		mov	[esp+178h+var_168], 150h
		jmp	loc_1001AC26
; ---------------------------------------------------------------------------

loc_1001A9A6:				; CODE XREF: sub_1001A8C0+D7j
		mov	[edx], eax

loc_1001A9A8:				; CODE XREF: sub_1001A8C0+AEj
		mov	dword ptr [esi], 4

loc_1001A9AE:				; CODE XREF: sub_1001A8C0+9Bj
					; sub_1001A8C0+A7j
		cmp	dword ptr [edi+ebp], 0
		jz	loc_1001AC2C
		cmp	dword ptr [esi], 0FFFFFFFFh
		jz	loc_1001AC2C
		cmp	[esp+178h+var_150], 0
		jz	loc_1001AAC0
		mov	eax, [edi-4]
		cmp	eax, 11h
		jz	short loc_1001A9EA
		cmp	eax, 122h
		jbe	loc_1001AAC0
		cmp	eax, 128h
		ja	loc_1001AAC0

loc_1001A9EA:				; CODE XREF: sub_1001A8C0+112j
		mov	ebx, [esp+178h+var_160]
		mov	ecx, [ebx+24h]
		mov	edx, [edi]
		mov	eax, [edi+4]
		push	ecx
		mov	[esp+17Ch+var_12C], edx
		mov	[esp+17Ch+var_128], eax
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [ebx+10h], 0
		jnz	short loc_1001AA28
		mov	edx, [ebx+24h]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		mov	[esp+178h+var_168], 101h
		jmp	loc_1001AC26
; ---------------------------------------------------------------------------

loc_1001AA28:				; CODE XREF: sub_1001A8C0+14Cj
		lea	eax, [esp+178h+var_158]
		push	eax
		lea	ecx, [esp+17Ch+var_130]
		push	ecx
		add	ebx, 0Ch
		push	ebx
		call	sub_1001E8E0
		mov	edx, [esp+184h+var_160]
		mov	ebx, eax
		mov	eax, [edx+24h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 10h
		test	ebx, ebx
		jz	short loc_1001AA6D
		mov	ecx, [esi]
		mov	edx, [edi+ebp]
		push	ecx		; Size
		push	0		; Val
		push	edx		; Dst
		call	memset
		mov	[esp+184h+var_168], 5
		jmp	loc_1001AC23
; ---------------------------------------------------------------------------

loc_1001AA6D:				; CODE XREF: sub_1001A8C0+190j
		mov	eax, [esp+178h+var_158]
		mov	ecx, [eax+8]
		cmp	[esi], ecx
		jnb	short loc_1001AA9E
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		mov	eax, [esi]
		mov	ecx, [edi+ebp]
		push	eax		; Size
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 14h
		mov	[esp+178h+var_168], 5
		jmp	loc_1001AC26
; ---------------------------------------------------------------------------

loc_1001AA9E:				; CODE XREF: sub_1001A8C0+1B6j
		mov	edx, [eax+4]
		mov	eax, [edi+ebp]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+184h+var_158]
		mov	ecx, [eax+8]
		push	1
		push	eax
		mov	[esi], ecx
		call	SECITEM_FreeItem_Util
		add	esp, 14h

loc_1001AAC0:				; CODE XREF: sub_1001A8C0+106j
					; sub_1001A8C0+119j ...
		cmp	[esp+178h+var_15C], 0
		jz	loc_1001AC2C
		mov	eax, [edi-4]
		cmp	eax, 0CE536360h
		ja	short loc_1001AB0B
		jz	short loc_1001AB1A
		cmp	eax, 0CE534369h
		ja	short loc_1001AAF4
		jz	short loc_1001AB1A
		mov	ecx, eax
		sub	ecx, 120h
		jz	short loc_1001AB1A
		sub	ecx, 2
		jz	short loc_1001AB1A
		jmp	loc_1001AC2C
; ---------------------------------------------------------------------------

loc_1001AAF4:				; CODE XREF: sub_1001A8C0+21Cj
		cmp	eax, 0CE536358h
		jb	loc_1001AC2C
		cmp	eax, 0CE53635Bh
		jbe	short loc_1001AB1A
		jmp	loc_1001AC2C
; ---------------------------------------------------------------------------

loc_1001AB0B:				; CODE XREF: sub_1001A8C0+213j
		lea	edx, [eax+31AC9C4Ch]
		cmp	edx, 1
		ja	loc_1001AC2C

loc_1001AB1A:				; CODE XREF: sub_1001A8C0+215j
					; sub_1001A8C0+21Ej ...
		lea	ecx, [esp+178h+var_104]
		mov	[esp+178h+var_144], ecx
		mov	ecx, [esp+178h+var_164]
		mov	ebx, [ecx+2Ch]
		mov	[esp+178h+var_140], 100h
		test	ebx, ebx
		jnz	short loc_1001AB37
		mov	ebx, [ecx]

loc_1001AB37:				; CODE XREF: sub_1001A8C0+273j
		mov	edx, [esp+178h+var_160]
		cmp	dword ptr [edx+8], 40000000h
		mov	ecx, offset aKey ; "key"
		jz	short loc_1001AB4E
		mov	ecx, offset aCert ; "cert"

loc_1001AB4E:				; CODE XREF: sub_1001A8C0+287j
		push	eax
		mov	eax, [esp+17Ch+arg_4]
		push	eax
		push	ecx
		lea	ecx, [esp+184h+Dest]
		push	offset Format	; "sig_%s_%08x_%08x"
		push	ecx		; Dest
		call	ds:sprintf
		mov	ecx, [ebx+30h]
		push	0
		lea	edx, [esp+190h+var_148]
		push	edx
		lea	eax, [esp+194h+Dest]
		push	eax
		push	ebx
		call	ecx
		add	esp, 24h
		test	eax, eax
		jz	short loc_1001AB9C
		mov	edx, [esi]
		mov	eax, [edi+ebp]
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		mov	[esp+184h+var_168], 20h
		jmp	loc_1001AC23
; ---------------------------------------------------------------------------

loc_1001AB9C:				; CODE XREF: sub_1001A8C0+2BFj
		mov	ebx, [esp+178h+var_164]
		mov	eax, [ebx+24h]
		mov	ecx, [edi]
		mov	edx, [edi+4]
		push	eax
		mov	[esp+17Ch+var_138], ecx
		mov	[esp+17Ch+var_134], edx
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [ebx+10h], 0
		jnz	short loc_1001ABD7
		mov	ecx, [ebx+24h]
		push	ecx
		mov	[esp+17Ch+var_15C], 0
		call	ds:PR_Unlock
		add	esp, 4
		jmp	short loc_1001AC2C
; ---------------------------------------------------------------------------

loc_1001ABD7:				; CODE XREF: sub_1001A8C0+2FEj
		mov	ecx, [edi-4]
		lea	edx, [esp+178h+var_148]
		push	edx
		mov	edx, [esp+17Ch+arg_4]
		lea	eax, [esp+17Ch+var_13C]
		push	eax
		push	ecx
		push	edx
		add	ebx, 0Ch
		push	ebx
		call	sub_1001EB50
		mov	ebx, eax
		mov	eax, [esp+18Ch+var_164]
		mov	ecx, [eax+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 18h
		test	ebx, ebx
		jz	short loc_1001AC2C
		mov	edx, [esi]
		mov	eax, [edi+ebp]
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		mov	[esp+184h+var_168], 0C0h

loc_1001AC23:				; CODE XREF: sub_1001A8C0+1A8j
					; sub_1001A8C0+2D7j
		add	esp, 0Ch

loc_1001AC26:				; CODE XREF: sub_1001A8C0+E1j
					; sub_1001A8C0+163j ...
		mov	dword ptr [esi], 0FFFFFFFFh

loc_1001AC2C:				; CODE XREF: sub_1001A8C0+F2j
					; sub_1001A8C0+FBj ...
		add	edi, 0Ch
		add	esi, 0Ch
		dec	[esp+178h+var_14C]
		jnz	loc_1001A950
		mov	eax, [esp+178h+var_168]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+168h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 168h
		retn
; ---------------------------------------------------------------------------

loc_1001AC59:				; CODE XREF: sub_1001A8C0+76j
		mov	ecx, [esp+174h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 168h
		retn
sub_1001A8C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001AC80	proc near		; CODE XREF: sub_1001AE50+2Ep
					; sub_1001B880+2Bp ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 1Ch
		push	ebx
		mov	ebx, [esp+20h+arg_4]
		push	esi
		xor	esi, esi
		xor	eax, eax
		cmp	dword ptr [ebx+8], 40000000h
		mov	[esp+24h+var_18], esi
		jz	short loc_1001ACA0
		mov	ebx, [ebx+28h]
		lea	eax, [esi+1]

loc_1001ACA0:				; CODE XREF: sub_1001AC80+18j
		cmp	ebx, esi
		jnz	short loc_1001ACAC
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001ACAC:				; CODE XREF: sub_1001AC80+22j
		push	edi
		cmp	[esp+28h+arg_8], esi
		jz	short loc_1001ACC2
		mov	ecx, [ebx+2Ch]
		cmp	ecx, esi
		jz	short loc_1001ACC2
		mov	edi, ecx
		mov	[esp+28h+var_1C], edi
		jmp	short loc_1001ACCA
; ---------------------------------------------------------------------------

loc_1001ACC2:				; CODE XREF: sub_1001AC80+31j
					; sub_1001AC80+38j
		mov	ecx, [ebx]
		mov	[esp+28h+var_1C], ecx
		mov	edi, ecx

loc_1001ACCA:				; CODE XREF: sub_1001AC80+40j
		test	byte ptr [edi+0Ch], 8
		jnz	short loc_1001ACD9
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001ACD9:				; CODE XREF: sub_1001AC80+4Ej
		cmp	eax, esi
		jz	short loc_1001ACF6
		mov	edx, [edi+38h]
		push	edi
		call	edx
		add	esp, 4
		cmp	eax, esi
		jnz	loc_1001AE1E
		mov	[esp+28h+var_18], 1

loc_1001ACF6:				; CODE XREF: sub_1001AC80+5Bj
		push	ebp
		mov	[esp+2Ch+var_14], esi
		cmp	[esp+2Ch+arg_14], esi
		jbe	loc_1001ADEB
		mov	esi, [esp+2Ch+arg_10]
		mov	ebp, ds:PR_Unlock
		nop

loc_1001AD10:				; CODE XREF: sub_1001AC80+165j
		mov	eax, [esi]
		cmp	eax, 0CE536360h
		ja	short loc_1001AD4C
		jz	short loc_1001AD56
		cmp	eax, 0CE534369h
		ja	short loc_1001AD35
		jz	short loc_1001AD56
		sub	eax, 120h
		jz	short loc_1001AD56
		sub	eax, 2
		jz	short loc_1001AD56
		jmp	loc_1001ADD5
; ---------------------------------------------------------------------------

loc_1001AD35:				; CODE XREF: sub_1001AC80+A0j
		cmp	eax, 0CE536358h
		jb	loc_1001ADD5
		cmp	eax, 0CE53635Bh
		jbe	short loc_1001AD56
		jmp	loc_1001ADD5
; ---------------------------------------------------------------------------

loc_1001AD4C:				; CODE XREF: sub_1001AC80+97j
		add	eax, 31AC9C4Ch
		cmp	eax, 1
		ja	short loc_1001ADD5

loc_1001AD56:				; CODE XREF: sub_1001AC80+99j
					; sub_1001AC80+A2j ...
		mov	edx, [ebx+24h]
		mov	eax, [esi+4]
		mov	ecx, [esi+8]
		push	edx
		mov	[esp+30h+var_8], eax
		mov	[esp+30h+var_4], ecx
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [ebx+10h], 0
		jz	loc_1001AE25
		mov	edx, [esi]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	eax, [esp+30h+arg_C]
		lea	ecx, [esp+30h+var_C]
		push	ecx
		push	edx
		mov	edx, [esp+38h+arg_0]
		push	eax
		lea	ecx, [ebx+0Ch]
		push	ecx
		push	edx
		call	sub_1001EC20
		mov	edi, eax
		mov	eax, [ebx+24h]
		push	eax
		call	ebp ; PR_Unlock
		add	esp, 1Ch
		test	edi, edi
		jnz	loc_1001AE35
		mov	ecx, [esp+2Ch+var_10]
		mov	edx, [esi]
		mov	eax, [esp+2Ch+arg_C]
		push	ecx
		mov	ecx, [esp+30h+var_1C]
		push	edx
		mov	edx, [esp+34h+arg_4]
		push	eax
		push	ecx
		push	edx
		call	sub_1001A850
		mov	edi, [esp+40h+var_1C]
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001AE40

loc_1001ADD5:				; CODE XREF: sub_1001AC80+B0j
					; sub_1001AC80+BAj ...
		mov	eax, [esp+2Ch+var_14]
		inc	eax
		add	esi, 0Ch
		mov	[esp+2Ch+var_14], eax
		cmp	eax, [esp+2Ch+arg_14]
		jb	loc_1001AD10

loc_1001ADEB:				; CODE XREF: sub_1001AC80+7Fj
		xor	eax, eax
		cmp	[esp+2Ch+var_18], eax
		jz	short loc_1001AE1D
		mov	ecx, [edi+3Ch]
		push	edi
		call	ecx
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1001AE1B

loc_1001AE02:				; CODE XREF: sub_1001AC80+1B3j
					; sub_1001AC80+1BEj ...
		cmp	[esp+2Ch+var_18], 0
		jz	short loc_1001AE1B
		mov	edx, [edi+40h]
		push	edi
		call	edx
		add	esp, 4
		mov	eax, 5
		test	esi, esi
		jz	short loc_1001AE1D

loc_1001AE1B:				; CODE XREF: sub_1001AC80+180j
					; sub_1001AC80+187j
		mov	eax, esi

loc_1001AE1D:				; CODE XREF: sub_1001AC80+171j
					; sub_1001AC80+199j
		pop	ebp

loc_1001AE1E:				; CODE XREF: sub_1001AC80+68j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001AE25:				; CODE XREF: sub_1001AC80+F5j
		mov	eax, [ebx+24h]
		push	eax
		call	ebp ; PR_Unlock
		add	esp, 4
		mov	esi, 101h
		jmp	short loc_1001AE02
; ---------------------------------------------------------------------------

loc_1001AE35:				; CODE XREF: sub_1001AC80+128j
		mov	edi, [esp+2Ch+var_1C]
		mov	esi, 5
		jmp	short loc_1001AE02
; ---------------------------------------------------------------------------

loc_1001AE40:				; CODE XREF: sub_1001AC80+153j
		mov	esi, 5
		jmp	short loc_1001AE02
sub_1001AC80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001AE50	proc near		; CODE XREF: sub_1001B8C0+EAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esi+28h]
		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	esi
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001AE86
		mov	eax, [esp+4+arg_4]
		mov	ecx, [ebp+0]
		xor	edx, edx
		cmp	esi, [eax+2Ch]
		push	edi
		setz	dl
		push	ebx
		push	ecx
		push	edx
		push	eax
		mov	eax, [esp+18h+arg_0]
		push	eax
		call	sub_1001AC80
		add	esp, 18h

loc_1001AE86:				; CODE XREF: sub_1001AE50+13j
		pop	ebp
		retn
sub_1001AE50	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001AE90	proc near		; CODE XREF: sub_1001B8C0+6Ep

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
Dst		= dword	ptr -8
Size		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 30h
		mov	eax, [esp+30h+arg_4]
		push	esi
		push	eax
		call	sub_10016570
		mov	esi, eax
		mov	eax, [esp+38h+arg_10]
		add	esp, 4
		mov	[esp+34h+var_30], esi
		mov	[esp+34h+var_24], 1
		mov	dword ptr [eax], 0
		test	esi, esi
		jnz	short loc_1001AECA
		mov	dword ptr [eax], 5
		xor	eax, eax
		pop	esi
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1001AECA:				; CODE XREF: sub_1001AE90+2Bj
		push	ebx
		mov	ebx, [esp+38h+arg_8]
		cmp	dword ptr [ebx+8], 40000000h
		jz	short loc_1001AEE0
		mov	[esp+38h+var_24], 0

loc_1001AEE0:				; CODE XREF: sub_1001AE90+46j
		mov	ecx, [esi+30h]
		push	ebp
		push	ecx
		call	ds:PR_Lock
		mov	eax, [esi+0F08h]
		xor	ebp, ebp
		add	esp, 4
		mov	[esp+3Ch+var_1C], ebp
		test	eax, eax
		jz	short loc_1001AF21
		lea	ecx, [esi+0F0Ch]
		mov	edx, eax

loc_1001AF06:				; CODE XREF: sub_1001AE90+8Bj
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1001AF17
		lea	esp, [esp+0]

loc_1001AF10:				; CODE XREF: sub_1001AE90+85j
		mov	eax, [eax]
		inc	ebp
		test	eax, eax
		jnz	short loc_1001AF10

loc_1001AF17:				; CODE XREF: sub_1001AE90+7Aj
		add	ecx, 4
		dec	edx
		jnz	short loc_1001AF06
		mov	[esp+3Ch+var_1C], ebp

loc_1001AF21:				; CODE XREF: sub_1001AE90+6Cj
		mov	eax, [esp+3Ch+arg_0]
		lea	edx, [ebp+ebp*2+0]
		add	edx, edx
		push	edi
		add	edx, edx
		push	edx
		push	eax
		call	PORT_ArenaAlloc_Util
		mov	edi, eax
		xor	eax, eax
		add	esp, 8
		mov	[esp+40h+var_18], edi
		cmp	edi, eax
		jnz	short loc_1001AF65
		mov	ecx, [esi+30h]
		push	ecx
		call	ds:PR_Unlock
		mov	edx, [esp+44h+arg_10]
		add	esp, 4
		mov	dword ptr [edx], 2

loc_1001AF5B:				; CODE XREF: sub_1001AE90+2F7j
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1001AF65:				; CODE XREF: sub_1001AE90+B2j
		mov	[esp+40h+var_2C], eax
		mov	[esp+40h+var_20], eax
		cmp	[esi+0F08h], eax
		jbe	loc_1001B173
		lea	eax, [esi+0F0Ch]
		mov	[esp+40h+var_28], eax

loc_1001AF83:				; CODE XREF: sub_1001AE90+2D9j
		mov	ecx, [esp+40h+var_28]
		mov	ebp, [ecx]
		test	ebp, ebp
		jz	loc_1001B151
		mov	eax, [esp+40h+var_2C]
		lea	edx, [eax+eax*2]
		lea	edi, [edi+edx*4]
		jmp	short loc_1001AFA0
; ---------------------------------------------------------------------------
		align 10h

loc_1001AFA0:				; CODE XREF: sub_1001AE90+10Bj
					; sub_1001AE90+282j
		mov	eax, [ebp+14h]
		inc	[esp+40h+var_2C]
		mov	esi, edi
		mov	[esi], eax
		mov	ecx, [ebp+18h]
		mov	[esi+4], ecx
		mov	edx, [ebp+1Ch]
		add	edi, 0Ch
		mov	[esp+40h+var_10], edi
		mov	[esi+8], edx
		cmp	edx, 4
		jnz	loc_1001B06E
		mov	eax, [esi]
		cmp	eax, 134h
		ja	short loc_1001B000
		cmp	eax, 133h
		jnb	short loc_1001B02A
		cmp	eax, 88h
		ja	short loc_1001AFF2
		cmp	eax, 87h
		jnb	short loc_1001B02A
		test	eax, eax
		jz	short loc_1001B02A
		cmp	eax, 80h
		jz	short loc_1001B02A
		jmp	short loc_1001B06E
; ---------------------------------------------------------------------------

loc_1001AFF2:				; CODE XREF: sub_1001AE90+14Cj
		sub	eax, 100h
		jz	short loc_1001B02A
		sub	eax, 21h
		jz	short loc_1001B02A
		jmp	short loc_1001B06E
; ---------------------------------------------------------------------------

loc_1001B000:				; CODE XREF: sub_1001AE90+13Ej
		cmp	eax, 500h
		ja	short loc_1001B020
		jz	short loc_1001B02A
		cmp	eax, 160h
		jb	short loc_1001B06E
		cmp	eax, 161h
		jbe	short loc_1001B02A
		cmp	eax, 166h
		jz	short loc_1001B02A
		jmp	short loc_1001B06E
; ---------------------------------------------------------------------------

loc_1001B020:				; CODE XREF: sub_1001AE90+175j
		add	eax, 31AC9CAFh
		cmp	eax, 0Fh
		ja	short loc_1001B06E

loc_1001B02A:				; CODE XREF: sub_1001AE90+145j
					; sub_1001AE90+153j ...
		mov	ecx, [esp+40h+arg_0]
		mov	eax, [esi+4]
		mov	ebx, [eax]
		push	4
		push	ecx
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_1001B11A
		mov	edx, ebx
		shr	edx, 18h
		mov	[eax], dl
		mov	ecx, ebx
		mov	edx, ebx
		shr	ecx, 10h
		shr	edx, 8
		mov	[eax+3], bl
		mov	ebx, [esp+40h+arg_8]
		mov	[eax+1], cl
		mov	[eax+2], dl
		mov	dword ptr [esi+8], 4

loc_1001B06E:				; CODE XREF: sub_1001AE90+131j
					; sub_1001AE90+160j ...
		cmp	[esp+40h+var_24], 0
		jz	loc_1001B10D
		mov	eax, [esi]
		cmp	eax, 11h
		jz	short loc_1001B092
		cmp	eax, 122h
		jbe	loc_1001B10D
		cmp	eax, 128h
		ja	short loc_1001B10D

loc_1001B092:				; CODE XREF: sub_1001AE90+1EEj
		mov	edx, [ebx+24h]
		mov	eax, [esi+4]
		mov	ecx, [esi+8]
		push	edx
		mov	[esp+44h+Dst], eax
		mov	[esp+44h+Size],	ecx
		call	ds:PR_Lock
		add	esp, 4
		cmp	dword ptr [ebx+10h], 0
		jz	short loc_1001B126
		mov	edx, [esp+40h+arg_0]
		lea	eax, [esp+40h+var_14]
		push	eax
		lea	ecx, [esp+44h+var_C]
		push	ecx
		add	ebx, 0Ch
		push	ebx
		push	edx
		call	sub_1001E950
		mov	edi, eax
		mov	eax, [esp+50h+arg_8]
		mov	ecx, [eax+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 14h
		test	edi, edi
		jnz	short loc_1001B13F
		mov	eax, [esp+40h+var_14]
		mov	edx, [eax+4]
		mov	ecx, [esp+40h+Size]
		push	ecx		; Size
		mov	[esi+4], edx
		mov	edx, [esp+44h+Dst]
		mov	eax, [eax+8]
		push	edi		; Val
		push	edx		; Dst
		mov	[esi+8], eax
		call	memset
		mov	edi, [esp+4Ch+var_10]
		mov	ebx, [esp+4Ch+arg_8]
		add	esp, 0Ch

loc_1001B10D:				; CODE XREF: sub_1001AE90+1E3j
					; sub_1001AE90+1F5j ...
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	loc_1001AFA0
		jmp	short loc_1001B14D
; ---------------------------------------------------------------------------

loc_1001B11A:				; CODE XREF: sub_1001AE90+1B3j
		mov	eax, [esp+40h+arg_10]
		mov	dword ptr [eax], 2
		jmp	short loc_1001B149
; ---------------------------------------------------------------------------

loc_1001B126:				; CODE XREF: sub_1001AE90+221j
		mov	ecx, [ebx+24h]
		push	ecx
		call	ds:PR_Unlock
		mov	edx, [esp+44h+arg_10]
		add	esp, 4
		mov	dword ptr [edx], 101h
		jmp	short loc_1001B14D
; ---------------------------------------------------------------------------

loc_1001B13F:				; CODE XREF: sub_1001AE90+250j
		mov	eax, [esp+40h+arg_10]
		mov	dword ptr [eax], 5

loc_1001B149:				; CODE XREF: sub_1001AE90+294j
		mov	ebx, [esp+40h+arg_8]

loc_1001B14D:				; CODE XREF: sub_1001AE90+288j
					; sub_1001AE90+2ADj
		mov	esi, [esp+40h+var_30]

loc_1001B151:				; CODE XREF: sub_1001AE90+FBj
		mov	eax, [esp+40h+var_20]
		add	[esp+40h+var_28], 4
		mov	edi, [esp+40h+var_18]
		inc	eax
		mov	[esp+40h+var_20], eax
		cmp	eax, [esi+0F08h]
		jb	loc_1001AF83
		mov	ebp, [esp+40h+var_1C]

loc_1001B173:				; CODE XREF: sub_1001AE90+E3j
		mov	ecx, [esi+30h]
		push	ecx
		call	ds:PR_Unlock
		mov	edx, [esp+44h+arg_10]
		add	esp, 4
		cmp	dword ptr [edx], 0
		jnz	loc_1001AF5B
		mov	eax, [esp+40h+arg_C]
		test	eax, eax
		jz	short loc_1001B197
		mov	[eax], ebp

loc_1001B197:				; CODE XREF: sub_1001AE90+303j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 30h
		retn
sub_1001AE90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B1B0	proc near		; CODE XREF: sub_1001B1D0+64p
		xor	eax, eax
		test	edx, edx
		jz	short loc_1001B1C4
		mov	ecx, edi

loc_1001B1B8:				; CODE XREF: sub_1001B1B0+12j
		cmp	esi, [ecx]
		jz	short loc_1001B1C7
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001B1B8

loc_1001B1C4:				; CODE XREF: sub_1001B1B0+4j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001B1C7:				; CODE XREF: sub_1001B1B0+Aj
		lea	eax, [eax+eax*2]
		lea	eax, [edi+eax*4]
		retn
sub_1001B1B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B1D0	proc near		; CODE XREF: sub_1001B400+49p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		mov	esi, edx
		mov	edx, eax
		shr	edx, 18h
		mov	[ecx], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[ecx+1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[ecx+2], dl
		mov	[ecx+3], al
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		mov	dword ptr [ebp+0], 0
		mov	[ebp+4], ecx
		mov	dword ptr [ebp+8], 4
		cmp	eax, 0CE534351h
		ja	loc_1001B2C5
		jz	short loc_1001B270
		cmp	eax, 1
		jz	loc_1001B30D
		jbe	loc_1001B2D7
		cmp	eax, 4
		ja	loc_1001B2D7
		mov	edx, esi
		mov	esi, 102h
		call	sub_1001B1B0
		test	eax, eax
		jz	loc_1001B304
		cmp	dword ptr [eax+8], 0
		jnz	short loc_1001B24E
		pop	edi
		lea	eax, [esi-80h]
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B24E:				; CODE XREF: sub_1001B1D0+75j
					; sub_1001B1D0+12Ej
		mov	ecx, [eax]
		mov	[ebp+0Ch], ecx
		mov	edx, [eax+4]
		mov	ecx, [esp+0Ch+arg_4]
		mov	[ebp+10h], edx
		mov	eax, [eax+8]
		mov	[ebp+14h], eax
		pop	edi
		mov	eax, 2
		pop	esi
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B270:				; CODE XREF: sub_1001B1D0+43j
		xor	eax, eax
		test	esi, esi
		jz	loc_1001B304
		mov	ecx, edi
		lea	esp, [esp+0]

loc_1001B280:				; CODE XREF: sub_1001B1D0+BEj
		cmp	dword ptr [ecx], 101h
		jz	short loc_1001B299
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B280
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B299:				; CODE XREF: sub_1001B1D0+B6j
		lea	ecx, [eax+eax*2]
		lea	eax, [edi+ecx*4]
		test	eax, eax
		jz	short loc_1001B304
		mov	edx, [eax]
		mov	[ebp+0Ch], edx
		mov	ecx, [eax+4]
		mov	[ebp+10h], ecx
		mov	edx, [eax+8]
		mov	ecx, [esp+0Ch+arg_4]
		pop	edi
		mov	eax, 2
		mov	[ebp+14h], edx
		pop	esi
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B2C5:				; CODE XREF: sub_1001B1D0+3Dj
		cmp	eax, 0CE534352h
		jz	loc_1001B369
		cmp	eax, 0CE534353h
		jz	short loc_1001B30D

loc_1001B2D7:				; CODE XREF: sub_1001B1D0+4Ej
					; sub_1001B1D0+57j
		xor	eax, eax
		test	esi, esi
		jz	short loc_1001B304
		mov	ecx, edi
		nop

loc_1001B2E0:				; CODE XREF: sub_1001B1D0+11Bj
		cmp	dword ptr [ecx], 11h
		jz	short loc_1001B2F6
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B2E0
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B2F6:				; CODE XREF: sub_1001B1D0+113j
		lea	eax, [eax+eax*2]
		lea	eax, [edi+eax*4]
		test	eax, eax
		jnz	loc_1001B24E

loc_1001B304:				; CODE XREF: sub_1001B1D0+6Bj
					; sub_1001B1D0+A4j ...
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B30D:				; CODE XREF: sub_1001B1D0+48j
					; sub_1001B1D0+105j
		xor	eax, eax
		test	esi, esi
		jz	short loc_1001B304
		mov	ecx, edi

loc_1001B315:				; CODE XREF: sub_1001B1D0+153j
		cmp	dword ptr [ecx], 81h
		jz	short loc_1001B32E
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B315
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B32E:				; CODE XREF: sub_1001B1D0+14Bj
		lea	ecx, [eax+eax*2]
		lea	eax, [edi+ecx*4]
		test	eax, eax
		jz	short loc_1001B304
		mov	edx, [eax]
		mov	[ebp+0Ch], edx
		mov	ecx, [eax+4]
		mov	[ebp+10h], ecx
		mov	edx, [eax+8]
		mov	[ebp+14h], edx
		xor	eax, eax
		mov	ecx, edi
		lea	ecx, [ecx+0]

loc_1001B350:				; CODE XREF: sub_1001B1D0+18Ej
		cmp	dword ptr [ecx], 82h
		jz	short loc_1001B3C9
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B350
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B369:				; CODE XREF: sub_1001B1D0+FAj
		xor	eax, eax
		test	esi, esi
		jz	short loc_1001B304
		mov	ecx, edi

loc_1001B371:				; CODE XREF: sub_1001B1D0+1AFj
		cmp	dword ptr [ecx], 101h
		jz	short loc_1001B38A
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B371
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B38A:				; CODE XREF: sub_1001B1D0+1A7j
		lea	ecx, [eax+eax*2]
		lea	eax, [edi+ecx*4]
		test	eax, eax
		jz	loc_1001B304
		mov	edx, [eax]
		mov	[ebp+0Ch], edx
		mov	ecx, [eax+4]
		mov	[ebp+10h], ecx
		mov	edx, [eax+8]
		mov	[ebp+14h], edx
		xor	eax, eax
		mov	ecx, edi
		lea	ecx, [ecx+0]

loc_1001B3B0:				; CODE XREF: sub_1001B1D0+1EEj
		cmp	dword ptr [ecx], 0CE534352h
		jz	short loc_1001B3C9
		inc	eax
		add	ecx, 0Ch
		cmp	eax, esi
		jb	short loc_1001B3B0
		pop	edi
		pop	esi
		mov	eax, 0D0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B3C9:				; CODE XREF: sub_1001B1D0+186j
					; sub_1001B1D0+1E6j
		lea	eax, [eax+eax*2]
		lea	eax, [edi+eax*4]
		test	eax, eax
		jz	loc_1001B304
		mov	ecx, [eax]
		mov	[ebp+18h], ecx
		mov	edx, [eax+4]
		mov	ecx, [esp+0Ch+arg_4]
		mov	[ebp+1Ch], edx
		mov	eax, [eax+8]
		mov	[ebp+20h], eax
		pop	edi
		mov	eax, 3
		pop	esi
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
sub_1001B1D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B400	proc near		; CODE XREF: sub_1001B8C0+C1p
					; sub_1001C770+6Cp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= byte ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		mov	eax, [esp+38h+arg_0]
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], 0
		mov	dword ptr [edi], 0
		cmp	eax, 0CE534351h
		jz	short loc_1001B4A4
		push	ecx
		lea	ecx, [esp+3Ch+var_30]
		push	ecx
		lea	edx, [esp+40h+var_28]
		push	edx
		mov	edx, [esp+44h+arg_4]
		lea	ecx, [esp+44h+var_2C]
		call	sub_1001B1D0
		add	esp, 0Ch
		cmp	eax, 82h
		jz	short loc_1001B4A4
		test	eax, eax
		jnz	short loc_1001B4A6
		mov	ecx, [esp+38h+var_30]
		lea	eax, [esp+38h+var_38]
		push	eax
		mov	eax, [esi+14h]
		push	ecx
		lea	edx, [esp+40h+var_28]
		push	edx
		push	esi
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001B4A6
		mov	edx, [esp+38h+var_38]
		mov	eax, [esi+18h]
		lea	ecx, [esp+38h+var_34]
		push	ecx
		push	1
		push	edi
		push	edx
		push	esi
		call	eax
		mov	ecx, [esp+4Ch+var_38]
		mov	edx, [esi+1Ch]
		push	ecx
		push	esi
		call	edx
		add	esp, 1Ch
		cmp	[esp+38h+var_34], 0
		jnz	short loc_1001B4A4
		mov	dword ptr [edi], 0

loc_1001B4A4:				; CODE XREF: sub_1001B400+34j
					; sub_1001B400+56j ...
		xor	eax, eax

loc_1001B4A6:				; CODE XREF: sub_1001B400+5Aj
					; sub_1001B400+75j
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_1001B400	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B4C0	proc near		; CODE XREF: sub_1001B8C0+A0p
					; sub_1001BC40+93p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, eax
		xor	eax, eax
		cmp	[esp+40h+arg_0], 1
		mov	[esp+40h+var_30], esi
		mov	[esp+40h+var_2C], esi
		mov	[esp+40h+var_34], esi
		mov	[esp+40h+var_38], esi
		jnz	short loc_1001B500
		push	ebp
		cmp	edx, esi
		jbe	short loc_1001B4FD
		mov	ecx, edi
		lea	esp, [esp+0]

loc_1001B4F0:				; CODE XREF: sub_1001B4C0+3Bj
		cmp	dword ptr [ecx], 3
		jz	short loc_1001B506
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001B4F0

loc_1001B4FD:				; CODE XREF: sub_1001B4C0+25j
					; sub_1001B4C0+4Ej ...
		xor	eax, eax
		pop	ebp

loc_1001B500:				; CODE XREF: sub_1001B4C0+20j
		pop	edi
		pop	esi
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1001B506:				; CODE XREF: sub_1001B4C0+33j
		lea	eax, [eax+eax*2]
		lea	ebp, [edi+eax*4]
		cmp	ebp, esi
		jz	short loc_1001B4FD
		cmp	[ebp+8], esi
		jz	short loc_1001B4FD
		xor	eax, eax
		mov	ecx, edi
		lea	esp, [esp+0]

loc_1001B520:				; CODE XREF: sub_1001B4C0+6Ej
		cmp	dword ptr [ecx], 101h
		jz	short loc_1001B551
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001B520
		xor	edi, edi

loc_1001B532:				; CODE XREF: sub_1001B4C0+97j
		mov	eax, [esp+44h+arg_4]
		cmp	eax, esi
		jnz	short loc_1001B559
		cmp	edi, esi
		jz	short loc_1001B547
		cmp	[edi+8], esi
		jge	loc_1001B5EA

loc_1001B547:				; CODE XREF: sub_1001B4C0+7Cj
		mov	esi, 0D0h
		jmp	loc_1001B6C3
; ---------------------------------------------------------------------------

loc_1001B551:				; CODE XREF: sub_1001B4C0+66j
		lea	ecx, [eax+eax*2]
		lea	edi, [edi+ecx*4]
		jmp	short loc_1001B532
; ---------------------------------------------------------------------------

loc_1001B559:				; CODE XREF: sub_1001B4C0+78j
		cmp	edi, esi
		jz	short loc_1001B566
		cmp	[edi+8], esi
		jg	loc_1001B5EA

loc_1001B566:				; CODE XREF: sub_1001B4C0+9Bj
		push	1
		lea	edx, [esp+48h+var_24]
		push	edx
		push	eax
		mov	eax, [ebx+20h]
		push	ebx
		mov	[esp+54h+var_24], 101h
		mov	[esp+54h+var_20], esi
		mov	[esp+54h+var_1C], esi
		call	eax
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_1001B73C
		mov	eax, [esp+44h+var_1C]
		test	eax, eax
		jns	short loc_1001B5A3
		mov	esi, 30h
		jmp	loc_1001B6C3
; ---------------------------------------------------------------------------

loc_1001B5A3:				; CODE XREF: sub_1001B4C0+D7j
		inc	eax
		push	eax
		mov	[esp+48h+var_1C], eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+44h+var_20], eax
		mov	[esp+44h+var_30], eax
		test	eax, eax
		jnz	short loc_1001B5C7

loc_1001B5BD:				; CODE XREF: sub_1001B4C0+1D5j
		mov	esi, 2
		jmp	loc_1001B6C3
; ---------------------------------------------------------------------------

loc_1001B5C7:				; CODE XREF: sub_1001B4C0+FBj
		mov	edx, [esp+44h+arg_4]
		mov	eax, [ebx+20h]
		push	1
		lea	ecx, [esp+48h+var_24]
		push	ecx
		push	edx
		push	ebx
		call	eax
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_1001B73C
		lea	edi, [esp+44h+var_24]

loc_1001B5EA:				; CODE XREF: sub_1001B4C0+81j
					; sub_1001B4C0+A0j
		lea	ecx, [esp+44h+arg_0]
		push	1
		push	ecx
		call	sub_1001A700
		mov	eax, [ebp+0]
		mov	ecx, [ebp+4]
		mov	[esp+4Ch+var_C], eax
		lea	eax, [esp+4Ch+var_38]
		push	eax
		lea	edx, [esp+50h+arg_0]
		mov	[esp+50h+var_14], edx
		mov	edx, [ebp+8]
		mov	[esp+50h+var_8], ecx
		push	2
		lea	ecx, [esp+54h+var_18]
		push	ecx
		mov	[esp+58h+var_4], edx
		mov	edx, [ebx+14h]
		push	ebx
		mov	[esp+5Ch+var_18], esi
		mov	[esp+5Ch+var_10], 4
		call	edx
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jnz	loc_1001B73C
		mov	edx, [esp+44h+var_38]
		lea	eax, [esp+44h+var_34]
		push	eax
		mov	eax, [ebx+18h]
		push	1
		lea	ecx, [esp+4Ch+var_28]
		push	ecx
		push	edx
		push	ebx
		call	eax
		mov	ecx, [esp+58h+var_38]
		mov	edx, [ebx+1Ch]
		push	ecx
		push	ebx
		call	edx
		add	esp, 1Ch
		cmp	[esp+44h+var_34], esi
		jz	loc_1001B738
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[esp+44h+var_18], eax
		mov	eax, [edi+8]
		inc	eax
		push	eax
		mov	[esp+48h+var_14], ecx
		mov	[esp+48h+var_10], eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+44h+var_14], eax
		mov	[esp+44h+var_2C], eax
		test	eax, eax
		jz	loc_1001B5BD
		mov	eax, [esp+44h+var_28]
		mov	ecx, [ebx+20h]
		push	1
		lea	edx, [esp+48h+var_18]
		push	edx
		push	eax
		push	ebx
		call	ecx
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_1001B6E3
		cmp	esi, 150h
		jnz	short loc_1001B73C

loc_1001B6BE:				; CODE XREF: sub_1001B4C0+22Aj
					; sub_1001B4C0+244j ...
		mov	esi, 13h

loc_1001B6C3:				; CODE XREF: sub_1001B4C0+8Cj
					; sub_1001B4C0+DEj ...
		mov	ecx, [esp+44h+var_30]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esp+48h+var_2C]
		push	edx
		call	PORT_Free_Util
		add	esp, 8
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1001B6E3:				; CODE XREF: sub_1001B4C0+1F4j
		mov	eax, [edi+8]
		cmp	[esp+44h+var_10], eax
		jnz	short loc_1001B6BE
		test	eax, eax
		jz	short loc_1001B738
		mov	edi, [edi+4]
		mov	ecx, [esp+44h+var_14]
		cmp	eax, 4
		jb	short loc_1001B714
		lea	esp, [esp+0]

loc_1001B700:				; CODE XREF: sub_1001B4C0+252j
		mov	edx, [ecx]
		cmp	edx, [edi]
		jnz	short loc_1001B6BE
		sub	eax, 4
		add	edi, 4
		add	ecx, 4
		cmp	eax, 4
		jnb	short loc_1001B700

loc_1001B714:				; CODE XREF: sub_1001B4C0+23Aj
		test	eax, eax
		jz	short loc_1001B738
		mov	dl, [edi]
		cmp	dl, [ecx]
		jnz	short loc_1001B6BE
		cmp	eax, 1
		jbe	short loc_1001B738
		mov	dl, [edi+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1001B6BE
		cmp	eax, 2
		jbe	short loc_1001B738
		mov	al, [edi+2]
		cmp	al, [ecx+2]
		jnz	short loc_1001B6BE

loc_1001B738:				; CODE XREF: sub_1001B4C0+1A7j
					; sub_1001B4C0+22Ej ...
		xor	esi, esi
		jmp	short loc_1001B6C3
; ---------------------------------------------------------------------------

loc_1001B73C:				; CODE XREF: sub_1001B4C0+CBj
					; sub_1001B4C0+120j ...
		cmp	esi, 13h
		jnz	short loc_1001B6C3
		mov	esi, 5
		jmp	loc_1001B6C3
sub_1001B4C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B750	proc near		; CODE XREF: sub_1001C770+39p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 1
		push	ebx
		push	edi
		mov	edi, eax
		mov	ebx, edx
		jz	short loc_1001B765

loc_1001B75D:				; CODE XREF: sub_1001B750+1Bj
					; sub_1001B750+3Dj ...
		pop	edi
		mov	eax, 5
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B765:				; CODE XREF: sub_1001B750+Bj
		mov	edx, [ecx]
		xor	eax, eax
		test	edx, edx
		jz	short loc_1001B75D
		mov	ecx, edi
		nop

loc_1001B770:				; CODE XREF: sub_1001B750+2Bj
		cmp	dword ptr [ecx], 3
		jz	short loc_1001B785
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001B770
		pop	edi
		mov	eax, 5
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B785:				; CODE XREF: sub_1001B750+23j
		lea	edx, [eax+eax*2]
		lea	edi, [edi+edx*4]
		test	edi, edi
		jz	short loc_1001B75D
		mov	edx, [edi+8]
		test	edx, edx
		jz	short loc_1001B75D
		push	ebp
		mov	ebp, [edi+4]
		push	esi
		lea	esi, [edx-1]
		mov	eax, esi
		cmp	eax, 2
		jl	short loc_1001B7B7

loc_1001B7A5:				; CODE XREF: sub_1001B750+65j
		movsx	ecx, byte ptr [eax+ebp]
		add	ecx, 0FFFFFFD0h
		cmp	ecx, 9
		ja	short loc_1001B7B7
		dec	eax
		cmp	eax, 2
		jge	short loc_1001B7A5

loc_1001B7B7:				; CODE XREF: sub_1001B750+53j
					; sub_1001B750+5Fj
		cmp	edx, 3
		jb	short loc_1001B83A
		lea	ecx, [edx-1]
		cmp	eax, ecx
		jnb	short loc_1001B83A
		cmp	byte ptr [eax+ebp], 23h
		jnz	short loc_1001B83A
		cmp	byte ptr [eax+ebp-1], 20h
		jnz	short loc_1001B83A
		test	esi, esi
		js	short loc_1001B7ED

loc_1001B7D4:				; CODE XREF: sub_1001B750+9Bj
		movsx	eax, byte ptr [esi+ebp]
		lea	edx, [eax-30h]
		cmp	edx, 9
		ja	short loc_1001B7ED
		cmp	eax, 39h
		jl	short loc_1001B830
		dec	esi
		mov	byte ptr [esi+ebp+1], 30h
		jns	short loc_1001B7D4

loc_1001B7ED:				; CODE XREF: sub_1001B750+82j
					; sub_1001B750+8Ej
		mov	eax, [edi+8]
		inc	eax
		push	eax
		push	ebx
		call	PORT_ArenaAlloc_Util
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_1001B84D
		inc	esi
		push	esi		; Size
		push	ebp		; Src
		push	ebx		; Dst
		call	memcpy
		mov	byte ptr [ebx+esi], 31h
		mov	ecx, [edi+8]
		sub	ecx, esi
		push	ecx		; Size
		lea	edx, [ebx+esi+1]
		push	30h		; Val
		push	edx		; Dst
		call	memset
		inc	dword ptr [edi+8]
		add	esp, 18h
		pop	esi
		pop	ebp
		mov	[edi+4], ebx
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B830:				; CODE XREF: sub_1001B750+93j
		inc	byte ptr [esi+ebp]
		pop	esi
		pop	ebp
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B83A:				; CODE XREF: sub_1001B750+6Aj
					; sub_1001B750+71j ...
		add	edx, 4
		push	edx
		push	ebx
		call	PORT_ArenaAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1001B857

loc_1001B84D:				; CODE XREF: sub_1001B750+AFj
		pop	esi
		pop	ebp
		pop	edi
		mov	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B857:				; CODE XREF: sub_1001B750+FBj
		mov	eax, [edi+8]
		push	eax		; Size
		push	ebp		; Src
		push	esi		; Dst
		call	memcpy
		mov	ecx, [edi+8]
		add	esp, 0Ch
		mov	dword ptr [esi+ecx], 322320h
		add	dword ptr [edi+8], 3
		mov	[edi+4], esi
		pop	esi
		pop	ebp
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
sub_1001B750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B880	proc near		; CODE XREF: sub_1001B8C0+FAp
					; sub_1001BC40+DBp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esi+24h]
		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	esi
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001B8B3
		mov	eax, [esp+4+arg_4]
		mov	edx, [esp+4+arg_0]
		xor	ecx, ecx
		cmp	esi, [eax+2Ch]
		push	edi
		setz	cl
		push	ebx
		push	ebp
		push	ecx
		push	eax
		push	edx
		call	sub_1001AC80
		add	esp, 18h

loc_1001B8B3:				; CODE XREF: sub_1001B880+13j
		pop	ebp
		retn
sub_1001B880	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B8C0	proc near		; CODE XREF: sub_10006D60+103p
					; sub_10006E80+9Cp ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		sub	esp, 10h
		push	edi
		mov	edi, [esp+14h+arg_0]
		mov	dword ptr [eax], 0
		test	edi, edi
		jnz	short loc_1001B8E0
		mov	eax, 0E2h
		pop	edi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001B8E0:				; CODE XREF: sub_1001B8C0+14j
		mov	eax, [edi+2Ch]
		push	esi
		mov	esi, eax
		test	eax, eax
		jnz	short loc_1001B8EC
		mov	esi, [edi]

loc_1001B8EC:				; CODE XREF: sub_1001B8C0+28j
		cmp	esi, eax
		jnz	short loc_1001B8FB
		pop	esi
		mov	eax, 101h
		pop	edi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001B8FB:				; CODE XREF: sub_1001B8C0+2Ej
		push	100h
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esp+18h+var_10], eax
		test	eax, eax
		jnz	short loc_1001B91B
		pop	esi
		mov	eax, 2
		pop	edi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001B91B:				; CODE XREF: sub_1001B8C0+4Ej
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		push	ebp
		lea	ecx, [esp+20h+var_4]
		push	ecx
		lea	edx, [esp+24h+var_C]
		push	edx
		push	edi
		push	ebx
		push	eax
		call	sub_1001AE90
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jz	loc_1001B9E9
		mov	eax, [esi+38h]
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	loc_1001B9ED
		mov	ecx, [ebx+8]
		mov	edx, [esp+20h+var_C]
		push	eax
		push	ecx
		mov	eax, ebp
		mov	ebx, esi
		call	sub_1001B4C0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001B9D5
		mov	edx, [esp+20h+arg_4]
		mov	ebx, [esp+20h+var_C]
		mov	eax, [edx+8]
		push	ebx
		push	eax
		mov	ecx, ebp
		lea	edi, [esp+28h+var_8]
		call	sub_1001B400
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001B9D5
		mov	eax, [esp+20h+var_8]
		mov	ecx, [esp+20h+arg_8]
		mov	edx, [esp+20h+arg_0]
		mov	edi, ebx
		mov	ebx, ebp
		test	eax, eax
		jnz	short loc_1001B9B1
		mov	eax, [esp+20h+var_10]
		push	ecx
		push	edx
		push	eax
		call	sub_1001AE50
		jmp	short loc_1001B9BF
; ---------------------------------------------------------------------------

loc_1001B9B1:				; CODE XREF: sub_1001B8C0+E1j
		push	eax
		mov	[ecx], eax
		mov	eax, [esp+24h+var_10]
		push	edx
		push	eax
		call	sub_1001B880

loc_1001B9BF:				; CODE XREF: sub_1001B8C0+EFj
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1001B9D5
		mov	ecx, [esi+3Ch]
		push	esi
		call	ecx
		add	esp, 4
		mov	edi, eax
		jmp	short loc_1001B9ED
; ---------------------------------------------------------------------------

loc_1001B9D5:				; CODE XREF: sub_1001B8C0+ACj
					; sub_1001B8C0+CDj ...
		mov	edx, [esi+40h]
		push	esi
		call	edx
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001B9ED
		mov	edi, 5
		jmp	short loc_1001B9ED
; ---------------------------------------------------------------------------

loc_1001B9E9:				; CODE XREF: sub_1001B8C0+7Aj
		mov	edi, [esp+20h+var_4]

loc_1001B9ED:				; CODE XREF: sub_1001B8C0+8Dj
					; sub_1001B8C0+113j ...
		mov	eax, [esp+20h+var_10]
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8
		pop	ebp
		pop	ebx
		test	edi, edi
		jnz	short loc_1001BA15
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [ecx+8]
		mov	eax, [esp+18h+arg_8]
		or	edx, 80000000h
		or	[eax], edx

loc_1001BA15:				; CODE XREF: sub_1001B8C0+140j
		pop	esi
		mov	eax, edi
		pop	edi
		add	esp, 10h
		retn
sub_1001B8C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BA20	proc near		; CODE XREF: sub_10009750+26p
					; sub_1001CB20+BAp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, [esp+4+arg_0]
		push	ebp
		push	esi
		xor	ebp, ebp
		xor	esi, esi
		mov	[esp+0Ch+var_4], ebp
		test	eax, eax
		jnz	short loc_1001BA37
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BA37:				; CODE XREF: sub_1001BA20+11j
		push	edi
		mov	edi, [eax+2Ch]
		test	edi, edi
		jnz	short loc_1001BA41
		mov	edi, [eax]

loc_1001BA41:				; CODE XREF: sub_1001BA20+1Dj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		test	ebx, ebx
		jz	short loc_1001BA70
		mov	ecx, [esp+14h+arg_4]
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		push	ecx
		call	sub_1001A730
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001BA6C
		pop	ebx
		pop	edi
		lea	eax, [esi+2]
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BA6C:				; CODE XREF: sub_1001BA20+41j
		mov	ebp, [esp+14h+var_4]

loc_1001BA70:				; CODE XREF: sub_1001BA20+28j
		mov	edx, [esp+14h+arg_C]
		mov	eax, [edi+14h]
		push	edx
		push	ebx
		push	esi
		push	edi
		call	eax
		add	esp, 10h
		mov	edi, eax
		test	ebp, ebp
		jz	short loc_1001BA95
		push	esi
		call	PORT_Free_Util
		push	ebp
		call	PORT_Free_Util
		add	esp, 8

loc_1001BA95:				; CODE XREF: sub_1001BA20+64j
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_1001BA20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BAA0	proc near		; CODE XREF: sub_10009750+44p
					; sub_1001CB20+E6p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_0]
		test	ebx, ebx
		jnz	short loc_1001BAB3
		mov	eax, [esp+4+arg_10]
		mov	[eax], ebx
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001BAB3:				; CODE XREF: sub_1001BAA0+7j
		mov	eax, [ebx+2Ch]
		test	eax, eax
		jnz	short loc_1001BABC
		mov	eax, [ebx]

loc_1001BABC:				; CODE XREF: sub_1001BAA0+18j
		mov	ecx, [esp+4+arg_C]
		mov	edx, [esp+4+arg_4]
		push	esi
		mov	esi, [esp+8+arg_8]
		push	edi
		mov	edi, [esp+0Ch+arg_10]
		push	edi
		push	ecx
		push	esi
		push	edx
		push	eax
		mov	eax, [eax+18h]
		call	eax
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001BB01
		xor	ecx, ecx
		cmp	[edi], ecx
		jbe	short loc_1001BB01
		jmp	short loc_1001BAF0
; ---------------------------------------------------------------------------
		align 10h

loc_1001BAF0:				; CODE XREF: sub_1001BAA0+45j
					; sub_1001BAA0+5Fj
		mov	edx, [ebx+8]
		or	edx, 80000000h
		or	[esi+ecx*4], edx
		inc	ecx
		cmp	ecx, [edi]
		jb	short loc_1001BAF0

loc_1001BB01:				; CODE XREF: sub_1001BAA0+3Dj
					; sub_1001BAA0+43j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_1001BAA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BB10	proc near		; CODE XREF: sub_10009750+9Ep
					; sub_1001F660+114p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1001BB1B
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001BB1B:				; CODE XREF: sub_1001BB10+6j
		mov	eax, [ecx+2Ch]
		test	eax, eax
		jnz	short loc_1001BB24
		mov	eax, [ecx]

loc_1001BB24:				; CODE XREF: sub_1001BB10+10j
		mov	edx, [eax+1Ch]
		mov	[esp+arg_0], eax
		jmp	edx
sub_1001BB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BB30	proc near		; CODE XREF: sub_10009390+91p
					; sub_10015DB0+5Ep ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	edx, [esp+4+arg_0]
		mov	[esp+4+var_4], 0
		test	edx, edx
		jnz	short loc_1001BB45
		lea	eax, [edx+5]
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BB45:				; CODE XREF: sub_1001BB30+Ej
		mov	ecx, [esp+4+arg_8]
		push	ebx
		mov	ebx, [esp+8+arg_C]
		push	ebp
		mov	ebp, 1
		push	esi
		push	edi
		cmp	ebx, ebp
		jnz	short loc_1001BBB8
		mov	eax, [ecx]
		cmp	eax, ebp
		jz	short loc_1001BB6C
		cmp	eax, 2
		jz	short loc_1001BB6C
		cmp	eax, 103h
		jnz	short loc_1001BBB8

loc_1001BB6C:				; CODE XREF: sub_1001BB30+2Ej
					; sub_1001BB30+33j
		mov	esi, [ecx+4]
		mov	bl, 1
		test	esi, esi
		jz	short loc_1001BBAD
		cmp	[ecx+8], ebp
		jnb	short loc_1001BB8C
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [ecx+8], 0FFFFFFFFh
		mov	eax, 150h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BB8C:				; CODE XREF: sub_1001BB30+48j
		mov	edi, 40000000h
		cmp	eax, 2
		jnz	short loc_1001BB9D
		cmp	[edx+8], edi
		jz	short loc_1001BB9D
		xor	bl, bl

loc_1001BB9D:				; CODE XREF: sub_1001BB30+64j
					; sub_1001BB30+69j
		cmp	eax, 103h
		jnz	short loc_1001BBAB
		cmp	[edx+8], edi
		jz	short loc_1001BBAB
		xor	bl, bl

loc_1001BBAB:				; CODE XREF: sub_1001BB30+72j
					; sub_1001BB30+77j
		mov	[esi], bl

loc_1001BBAD:				; CODE XREF: sub_1001BB30+43j
		mov	[ecx+8], ebp

loc_1001BBB0:				; CODE XREF: sub_1001BB30+93j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BBB8:				; CODE XREF: sub_1001BB30+28j
					; sub_1001BB30+3Aj
		mov	ebp, [edx+2Ch]
		test	ebp, ebp
		jnz	short loc_1001BBC1
		mov	ebp, [edx]

loc_1001BBC1:				; CODE XREF: sub_1001BB30+8Dj
		test	ebx, ebx
		jz	short loc_1001BBB0
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		push	ecx
		call	sub_1001A730
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1001BBE3
		lea	eax, [edi+2]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BBE3:				; CODE XREF: sub_1001BB30+A8j
		mov	esi, [esp+14h+arg_4]
		mov	ecx, [ebp+20h]
		push	ebx
		push	edi
		and	esi, 3FFFFFFFh
		push	esi
		push	ebp
		call	ecx
		mov	edx, [esp+24h+arg_8]
		push	ebx
		push	esi
		push	edx
		mov	edx, [esp+30h+arg_0]
		mov	ecx, edi
		mov	ebp, eax
		call	sub_1001A8C0
		add	esp, 1Ch
		test	ebp, ebp
		jnz	short loc_1001BC13
		mov	ebp, eax

loc_1001BC13:				; CODE XREF: sub_1001BB30+DFj
		mov	esi, [esp+14h+var_4]
		test	esi, esi
		jz	short loc_1001BC2A
		push	edi
		call	PORT_Free_Util
		push	esi
		call	PORT_Free_Util
		add	esp, 8

loc_1001BC2A:				; CODE XREF: sub_1001BB30+E9j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1001BB30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BC40	proc near		; CODE XREF: sub_10016A50+59p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_4]
		push	edi
		mov	edi, [eax+0Ch]
		mov	eax, [esp+10h+arg_0]
		xor	edx, edx
		and	edi, 3FFFFFFFh
		mov	[esp+10h+var_8], edx
		mov	[esp+10h+var_C], edx
		cmp	eax, edx
		jnz	short loc_1001BC6D
		mov	eax, 0E2h
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BC6D:				; CODE XREF: sub_1001BC40+21j
		mov	ecx, [eax+2Ch]
		push	esi
		mov	esi, ecx
		cmp	ecx, edx
		jnz	short loc_1001BC79
		mov	esi, [eax]

loc_1001BC79:				; CODE XREF: sub_1001BC40+35j
		push	ebp
		mov	ebp, [esp+18h+arg_C]
		cmp	ebp, edx
		jnz	short loc_1001BC8B
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BC8B:				; CODE XREF: sub_1001BC40+40j
		cmp	esi, ecx
		jnz	short loc_1001BC9B
		pop	ebp
		pop	esi
		mov	eax, 101h
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BC9B:				; CODE XREF: sub_1001BC40+4Dj
		push	ebx
		mov	ebx, [esp+1Ch+arg_8]
		lea	ecx, [esp+1Ch+var_8]
		push	ecx
		push	ebp
		push	ebx
		call	sub_1001A730
		add	esp, 0Ch
		mov	[esp+1Ch+var_4], eax
		test	eax, eax
		jnz	short loc_1001BCC4
		pop	ebx
		pop	ebp
		pop	esi
		mov	eax, 2
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BCC4:				; CODE XREF: sub_1001BC40+75j
		mov	edx, [esp+1Ch+arg_4]
		mov	eax, [edx+8]
		push	edi
		push	eax
		mov	eax, ebx
		mov	edx, ebp
		mov	ebx, esi
		call	sub_1001B4C0
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_1001BD41
		push	100h
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jnz	short loc_1001BCFB
		lea	ebx, [eax+2]
		jmp	short loc_1001BD41
; ---------------------------------------------------------------------------

loc_1001BCFB:				; CODE XREF: sub_1001BC40+B4j
		mov	ecx, [esi+38h]
		push	esi
		call	ecx
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1001BD41
		mov	edx, [esp+1Ch+arg_0]
		mov	eax, [esp+1Ch+var_C]
		mov	ebx, [esp+1Ch+arg_8]
		push	edi
		push	edx
		push	eax
		mov	edi, ebp
		call	sub_1001B880
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1001BD38
		mov	ecx, [esi+3Ch]
		push	esi
		call	ecx
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1001BD41

loc_1001BD38:				; CODE XREF: sub_1001BC40+E7j
		mov	edx, [esi+40h]
		push	esi
		call	edx
		add	esp, 4

loc_1001BD41:				; CODE XREF: sub_1001BC40+9Fj
					; sub_1001BC40+B9j ...
		mov	esi, [esp+1Ch+var_8]
		test	esi, esi
		jz	short loc_1001BD5C
		mov	eax, [esp+1Ch+var_4]
		push	eax
		call	PORT_Free_Util
		push	esi
		call	PORT_Free_Util
		add	esp, 8

loc_1001BD5C:				; CODE XREF: sub_1001BC40+107j
		mov	eax, [esp+1Ch+var_C]
		test	eax, eax
		jz	short loc_1001BD6F
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1001BD6F:				; CODE XREF: sub_1001BC40+122j
		mov	eax, ebx
		pop	ebx
		pop	ebp
		pop	esi
		pop	edi
		add	esp, 0Ch
		retn
sub_1001BC40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BD80	proc near		; CODE XREF: sub_10016E50+F2p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_1001BD8E
		mov	eax, 0E2h
		retn
; ---------------------------------------------------------------------------

loc_1001BD8E:				; CODE XREF: sub_1001BD80+6j
		push	esi
		mov	esi, [eax+2Ch]
		push	edi
		test	esi, esi
		jnz	short loc_1001BD99
		mov	esi, [eax]

loc_1001BD99:				; CODE XREF: sub_1001BD80+15j
		mov	eax, [esi+38h]
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001BDD1
		mov	ecx, [esp+8+arg_4]
		mov	edx, [esi+2Ch]
		and	ecx, 3FFFFFFFh
		push	ecx
		push	esi
		call	edx
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001BDD1
		mov	eax, [esi+3Ch]
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1001BDDA

loc_1001BDD1:				; CODE XREF: sub_1001BD80+26j
					; sub_1001BD80+40j
		mov	ecx, [esi+40h]
		push	esi
		call	ecx
		add	esp, 4

loc_1001BDDA:				; CODE XREF: sub_1001BD80+4Fj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_1001BD80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BDE0	proc near		; CODE XREF: sub_1001CD90+1Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	loc_1001BE7E
		cmp	dword ptr [esi+2Ch], 0
		jz	short loc_1001BE0F
		mov	eax, [esi]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_1001BE03
		push	0
		call	eax
		add	esp, 4

loc_1001BE03:				; CODE XREF: sub_1001BDE0+1Aj
		mov	eax, [esi+2Ch]
		mov	ecx, [eax+48h]
		push	eax
		call	ecx
		add	esp, 4

loc_1001BE0F:				; CODE XREF: sub_1001BDE0+11j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1001BE2E
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_1001BE23
		push	0
		call	eax
		add	esp, 4

loc_1001BE23:				; CODE XREF: sub_1001BDE0+3Aj
		mov	eax, [esi]
		mov	edx, [eax+48h]
		push	eax
		call	edx
		add	esp, 4

loc_1001BE2E:				; CODE XREF: sub_1001BDE0+33j
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_1001BE42
		mov	ecx, [esi+14h]
		push	ecx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001BE42:				; CODE XREF: sub_1001BDE0+53j
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_1001BE53
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4

loc_1001BE53:				; CODE XREF: sub_1001BDE0+67j
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1001BE65
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1001BE65:				; CODE XREF: sub_1001BDE0+78j
		mov	eax, [esi+30h]
		test	eax, eax
		jz	short loc_1001BE75
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001BE75:				; CODE XREF: sub_1001BDE0+8Aj
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1001BE7E:				; CODE XREF: sub_1001BDE0+7j
		xor	eax, eax
		pop	esi
		retn
sub_1001BDE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BE90	proc near		; CODE XREF: sub_1001CE90:loc_1001CEA1p
		test	eax, eax
		jnz	short loc_1001BE9A
		mov	eax, 0E2h
		retn
; ---------------------------------------------------------------------------

loc_1001BE9A:				; CODE XREF: sub_1001BE90+2j
		push	esi
		mov	esi, [eax+2Ch]
		push	edi
		test	esi, esi
		jnz	short loc_1001BEA5
		mov	esi, [eax]

loc_1001BEA5:				; CODE XREF: sub_1001BE90+11j
		mov	eax, [esi+38h]
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001BED2
		mov	ecx, [esi+44h]
		push	esi
		call	ecx
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001BED2
		mov	edx, [esi+3Ch]
		push	esi
		call	edx
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1001BEDB

loc_1001BED2:				; CODE XREF: sub_1001BE90+22j
					; sub_1001BE90+31j
		mov	eax, [esi+40h]
		push	esi
		call	eax
		add	esp, 4

loc_1001BEDB:				; CODE XREF: sub_1001BE90+40j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_1001BE90	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001BEE0	proc near		; CODE XREF: sub_1001C8C0+8Ap
					; sub_1001C8C0+D0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	edx, dword_10029224
		push	edi
		mov	edi, ecx
		cmp	[eax], edx
		jnb	short loc_1001BEFA
		mov	[eax], edx
		mov	eax, 150h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001BEFA:				; CODE XREF: sub_1001BEE0+Fj
		push	ebp
		push	esi
		xor	esi, esi
		xor	ecx, ecx
		cmp	edx, esi
		jle	short loc_1001BF27
		lea	eax, [ebx+8]
		jmp	short loc_1001BF10
; ---------------------------------------------------------------------------
		align 10h

loc_1001BF10:				; CODE XREF: sub_1001BEE0+27j
					; sub_1001BEE0+45j
		mov	ebp, ds:dword_100279D0[ecx*4]
		mov	[eax-8], ebp
		mov	[eax-4], esi
		mov	[eax], esi
		inc	ecx
		add	eax, 0Ch
		cmp	ecx, edx
		jl	short loc_1001BF10

loc_1001BF27:				; CODE XREF: sub_1001BEE0+22j
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [edi+20h]
		push	edx
		push	ebx
		push	eax
		push	edi
		call	ecx
		add	esp, 10h
		cmp	eax, esi
		jz	short loc_1001BF40
		cmp	eax, 12h
		jnz	short loc_1001BFA9

loc_1001BF40:				; CODE XREF: sub_1001BEE0+59j
		mov	edx, dword_10029224
		xor	eax, eax
		xor	edi, edi
		cmp	edx, esi
		jle	short loc_1001BFA1
		mov	esi, ebx
		cmp	eax, edx
		jge	short loc_1001BFA1

loc_1001BF54:				; CODE XREF: sub_1001BEE0+BFj
		lea	ecx, [eax+eax*2]
		lea	ecx, [ebx+ecx*4+8]
		jmp	short loc_1001BF60
; ---------------------------------------------------------------------------
		align 10h

loc_1001BF60:				; CODE XREF: sub_1001BEE0+7Bj
					; sub_1001BEE0+8Bj
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jnz	short loc_1001BF79
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jl	short loc_1001BF60
		mov	edx, [esp+0Ch+arg_4]
		pop	esi
		pop	ebp
		mov	[edx], edi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001BF79:				; CODE XREF: sub_1001BEE0+83j
		cmp	eax, edx
		jge	short loc_1001BFA1
		cmp	eax, edi
		jz	short loc_1001BF98
		lea	ecx, [eax+eax*2]
		mov	ebp, [ebx+ecx*4]
		lea	ecx, [ebx+ecx*4]
		mov	[esi], ebp
		mov	ebp, [ecx+4]
		mov	[esi+4], ebp
		mov	ecx, [ecx+8]
		mov	[esi+8], ecx

loc_1001BF98:				; CODE XREF: sub_1001BEE0+9Fj
		inc	eax
		inc	edi
		add	esi, 0Ch
		cmp	eax, edx
		jl	short loc_1001BF54

loc_1001BFA1:				; CODE XREF: sub_1001BEE0+6Cj
					; sub_1001BEE0+72j ...
		mov	edx, [esp+0Ch+arg_4]
		mov	[edx], edi
		xor	eax, eax

loc_1001BFA9:				; CODE XREF: sub_1001BEE0+5Ej
		pop	esi
		pop	ebp
		pop	edi
		retn
sub_1001BEE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BFB0	proc near		; CODE XREF: sub_1001CB20+8Ep
					; sub_1001CFB0+219p ...

var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 110h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+110h+var_4], eax
		mov	eax, [esp+110h+arg_0]
		push	edi
		mov	edi, edx
		mov	[esp+114h+var_110], 0
		mov	[esp+114h+var_10C], 0
		mov	[esp+114h+var_108], 0
		test	eax, eax
		jnz	short loc_1001C000
		pop	edi
		mov	ecx, [esp+110h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_1001C000:				; CODE XREF: sub_1001BFB0+38j
		push	esi
		push	eax
		push	ecx
		push	offset aUpd_S_S	; "upd_%s_%s"
		call	ds:PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001C02E
		pop	esi
		pop	edi
		mov	ecx, [esp+110h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_1001C02E:				; CODE XREF: sub_1001BFB0+65j
		mov	edx, [edi+30h]
		push	0
		lea	ecx, [esp+11Ch+var_110]
		push	ecx
		lea	eax, [esp+120h+var_104]
		push	esi
		push	edi
		mov	[esp+128h+var_10C], eax
		mov	[esp+128h+var_108], 100h
		call	edx
		push	esi
		mov	edi, eax
		call	ds:PR_smprintf_free
		mov	ecx, [esp+12Ch+var_4]
		add	esp, 14h
		xor	eax, eax
		test	edi, edi
		pop	esi
		setz	al
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
sub_1001BFB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C080	proc near		; CODE XREF: sub_1001CB20+1D1p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	edi
		mov	edi, eax
		mov	[esp+10h+var_C], 0
		mov	[esp+10h+var_8], 0
		mov	[esp+10h+var_4], 0
		test	ecx, ecx
		jnz	short loc_1001C0A9
		xor	eax, eax
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C0A9:				; CODE XREF: sub_1001C080+20j
		mov	eax, ecx
		push	esi
		mov	[esp+14h+var_8], ecx
		lea	esi, [eax+1]

loc_1001C0B3:				; CODE XREF: sub_1001C080+38j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001C0B3
		sub	eax, esi
		mov	[esp+14h+var_4], eax
		mov	eax, [esp+14h+arg_0]
		push	ecx
		push	eax
		push	offset aUpd_S_S	; "upd_%s_%s"
		call	ds:PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001C0E0
		pop	esi
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C0E0:				; CODE XREF: sub_1001C080+58j
		mov	edx, [edi+34h]
		push	0
		lea	ecx, [esp+18h+var_C]
		push	ecx
		push	esi
		push	edi
		call	edx
		push	esi
		mov	edi, eax
		call	ds:PR_smprintf_free
		add	esp, 14h
		pop	esi
		mov	eax, edi
		pop	edi
		add	esp, 0Ch
		retn
sub_1001C080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C110	proc near		; CODE XREF: sub_1001C8C0+140p
		xor	eax, eax
		test	edx, edx
		jz	short loc_1001C124
		mov	ecx, esi

loc_1001C118:				; CODE XREF: sub_1001C110+12j
		cmp	edi, [ecx]
		jz	short loc_1001C128
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001C118

loc_1001C124:				; CODE XREF: sub_1001C110+4j
					; sub_1001C110+20j ...
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001C128:				; CODE XREF: sub_1001C110+Aj
		lea	eax, [eax+eax*2]
		lea	eax, [esi+eax*4]
		test	eax, eax
		jz	short loc_1001C124
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_1001C124
		cmp	dword ptr [eax+8], 4
		jnz	short loc_1001C124
		movzx	eax, byte ptr [ecx]
		movzx	edx, byte ptr [ecx+1]
		shl	eax, 8
		or	eax, edx
		movzx	edx, byte ptr [ecx+2]
		movzx	ecx, byte ptr [ecx+3]
		shl	eax, 8
		or	eax, edx
		shl	eax, 8
		or	eax, ecx
		retn
sub_1001C110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C160	proc near		; CODE XREF: sub_1001C770+CAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_4]
		mov	ecx, [ebp+4]
		push	esi
		mov	esi, [ebp+8]
		test	ecx, ecx
		jz	short loc_1001C197
		cmp	esi, 0FFFFFFFFh
		jz	short loc_1001C197
		test	esi, esi
		jz	short loc_1001C199
		mov	edx, 1
		lea	eax, [esi+ecx-1]
		sub	edx, ecx

loc_1001C184:				; CODE XREF: sub_1001C160+2Ej
		inc	byte ptr [eax]
		jnz	short loc_1001C192
		dec	eax
		lea	ecx, [edx+eax]
		test	ecx, ecx
		jnz	short loc_1001C184
		jmp	short loc_1001C199
; ---------------------------------------------------------------------------

loc_1001C192:				; CODE XREF: sub_1001C160+26j
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001C197:				; CODE XREF: sub_1001C160+Ej
					; sub_1001C160+13j
		xor	esi, esi

loc_1001C199:				; CODE XREF: sub_1001C160+17j
					; sub_1001C160+30j
		mov	edx, [esp+8+arg_0]
		push	ebx
		push	edi
		lea	ebx, [esi+1]
		push	ebx
		push	edx
		call	PORT_ArenaAlloc_Util
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001C1BA
		lea	eax, [edi+2]
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001C1BA:				; CODE XREF: sub_1001C160+50j
		test	esi, esi
		jz	short loc_1001C1CC
		mov	eax, [ebp+4]
		push	esi		; Size
		push	eax		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001C1CC:				; CODE XREF: sub_1001C160+5Cj
		mov	byte ptr [esi+edi], 0
		mov	[ebp+4], edi
		pop	edi
		mov	[ebp+8], ebx
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
sub_1001C160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C1E0	proc near		; CODE XREF: sub_1001C5F0+E4p
					; sub_1001C5F0+138p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_8]
		mov	edx, [ebx]
		push	esi
		xor	eax, eax
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		test	edx, edx
		jz	short loc_1001C20C
		mov	ecx, [esp+0Ch+arg_0]
		mov	esi, [ecx]
		mov	ecx, edi
		jmp	short loc_1001C200
; ---------------------------------------------------------------------------
		align 10h

loc_1001C200:				; CODE XREF: sub_1001C1E0+1Bj
					; sub_1001C1E0+2Aj
		cmp	esi, [ecx]
		jz	short loc_1001C20C
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001C200

loc_1001C20C:				; CODE XREF: sub_1001C1E0+11j
					; sub_1001C1E0+22j
		cmp	eax, edx
		jz	short loc_1001C231
		inc	eax
		cmp	eax, edx
		jnb	short loc_1001C22E
		lea	ecx, [eax+eax*2]
		lea	esi, [edi+ecx*4]
		mov	ecx, edx
		sub	ecx, eax
		lea	ecx, [ecx+ecx*2]
		add	ecx, ecx
		add	ecx, ecx
		lea	edi, [esi-0Ch]
		shr	ecx, 2
		rep movsd

loc_1001C22E:				; CODE XREF: sub_1001C1E0+33j
		dec	edx
		mov	[ebx], edx

loc_1001C231:				; CODE XREF: sub_1001C1E0+2Ej
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_1001C1E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C240	proc near		; CODE XREF: sub_1001C340+154p

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, [edx]
		xor	eax, eax
		mov	ecx, edx
		lea	esp, [esp+0]

loc_1001C250:				; CODE XREF: sub_1001C240+1Bj
		cmp	edi, [ecx]
		jz	short loc_1001C281
		inc	eax
		add	ecx, 0Ch
		cmp	eax, 1
		jb	short loc_1001C250

loc_1001C25D:				; CODE XREF: sub_1001C240+49j
					; sub_1001C240+50j ...
		or	edx, 0FFFFFFFFh

loc_1001C260:				; CODE XREF: sub_1001C240+76j
		mov	esi, [esp+8+arg_8]
		xor	eax, eax
		mov	ecx, esi

loc_1001C268:				; CODE XREF: sub_1001C240+33j
		cmp	edi, [ecx]
		jz	short loc_1001C2B8
		inc	eax
		add	ecx, 0Ch
		cmp	eax, 1
		jb	short loc_1001C268

loc_1001C275:				; CODE XREF: sub_1001C240+80j
					; sub_1001C240+87j ...
		or	eax, 0FFFFFFFFh

loc_1001C278:				; CODE XREF: sub_1001C240+ADj
		pop	edi
		pop	esi
		cmp	edx, eax
		jnz	short loc_1001C2EF
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001C281:				; CODE XREF: sub_1001C240+12j
		lea	eax, [eax+eax*2]
		lea	ecx, [edx+eax*4]
		test	ecx, ecx
		jz	short loc_1001C25D
		mov	eax, [ecx+4]
		test	eax, eax
		jz	short loc_1001C25D
		cmp	dword ptr [ecx+8], 4
		jnz	short loc_1001C25D
		movzx	ecx, byte ptr [eax]
		movzx	edx, byte ptr [eax+1]
		shl	ecx, 8
		or	edx, ecx
		movzx	ecx, byte ptr [eax+2]
		movzx	eax, byte ptr [eax+3]
		shl	edx, 8
		or	edx, ecx
		shl	edx, 8
		or	edx, eax
		jmp	short loc_1001C260
; ---------------------------------------------------------------------------

loc_1001C2B8:				; CODE XREF: sub_1001C240+2Aj
		lea	ecx, [eax+eax*2]
		lea	eax, [esi+ecx*4]
		test	eax, eax
		jz	short loc_1001C275
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_1001C275
		cmp	dword ptr [eax+8], 4
		jnz	short loc_1001C275
		movzx	eax, byte ptr [ecx]
		movzx	esi, byte ptr [ecx+1]
		shl	eax, 8
		or	eax, esi
		movzx	esi, byte ptr [ecx+2]
		movzx	ecx, byte ptr [ecx+3]
		shl	eax, 8
		or	eax, esi
		shl	eax, 8
		or	eax, ecx
		jmp	short loc_1001C278
; ---------------------------------------------------------------------------

loc_1001C2EF:				; CODE XREF: sub_1001C240+3Cj
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001C32C
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_1001C2FF

loc_1001C2F9:				; CODE XREF: sub_1001C240+CCj
					; sub_1001C240+E2j ...
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_1001C2FF:				; CODE XREF: sub_1001C240+B7j
		cmp	eax, 0CE534355h
		jz	short loc_1001C32C
		cmp	edx, 0CE534355h
		jz	short loc_1001C2F9
		cmp	eax, 0CE534353h
		jz	short loc_1001C32C
		cmp	eax, 0CE53435Bh
		jz	short loc_1001C32C
		cmp	edx, 0CE534353h
		jz	short loc_1001C2F9
		cmp	edx, 0CE53435Bh
		jz	short loc_1001C2F9

loc_1001C32C:				; CODE XREF: sub_1001C240+B2j
					; sub_1001C240+C4j ...
		mov	eax, 3
		retn
sub_1001C240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C340	proc near		; CODE XREF: sub_1001C770+135p

var_89		= byte ptr -89h
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= byte ptr -1Ch
var_18		= byte ptr -18h
var_14		= byte ptr -14h
var_10		= byte ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		push	edi
		mov	edi, edx
		lea	edx, [esp+90h+var_1C]
		mov	[esp+90h+var_64], edx
		lea	edx, [esp+90h+var_18]
		mov	[esp+90h+var_58], edx
		lea	edx, [esp+90h+var_14]
		mov	[esp+90h+var_4C], edx
		lea	edx, [esp+90h+var_10]
		mov	[esp+90h+var_40], edx
		lea	eax, [esp+90h+var_20]
		mov	[esp+90h+var_70], eax
		mov	eax, 4
		lea	edx, [esp+90h+var_C]
		mov	[esp+90h+var_34], edx
		mov	[esp+90h+var_6C], eax
		mov	[esp+90h+var_60], eax
		mov	[esp+90h+var_54], eax
		mov	[esp+90h+var_48], eax
		mov	[esp+90h+var_3C], eax
		mov	[esp+90h+var_30], eax
		mov	[esp+90h+var_24], eax
		lea	edx, [esp+90h+var_8]
		push	7
		lea	eax, [esp+94h+var_74]
		push	eax
		mov	eax, [ecx+20h]
		mov	[esp+98h+var_28], edx
		mov	edx, [esp+98h+arg_4]
		push	edx
		push	ecx
		mov	[esp+0A0h+var_7C], ecx
		mov	[esp+0A0h+var_78], edi
		mov	[esp+0A0h+var_88], 0
		mov	[esp+0A0h+var_74], 0CE536358h
		mov	[esp+0A0h+var_68], 0CE536359h
		mov	[esp+0A0h+var_5C], 0CE53635Ah
		mov	[esp+0A0h+var_50], 0CE53635Bh
		mov	[esp+0A0h+var_44], 0CE53635Dh
		mov	[esp+0A0h+var_38], 0CE53635Eh
		mov	[esp+0A0h+var_2C], 0CE53635Fh
		call	eax
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001C42F
		cmp	eax, 12h
		jz	short loc_1001C42F
		mov	[esp+90h+var_88], 2
		jmp	loc_1001C5D0
; ---------------------------------------------------------------------------

loc_1001C42F:				; CODE XREF: sub_1001C340+DBj
					; sub_1001C340+E0j
		lea	ecx, [esp+90h+var_74]
		push	ebp
		mov	[esp+94h+var_84], ecx
		mov	[esp+94h+var_80], 7
		push	esi

loc_1001C441:				; CODE XREF: sub_1001C340+1B4j
		mov	ebp, [ebx]
		xor	eax, eax
		test	ebp, ebp
		jz	short loc_1001C45D
		mov	edx, [esp+98h+var_84]
		mov	edx, [edx]
		mov	ecx, edi

loc_1001C451:				; CODE XREF: sub_1001C340+11Bj
		cmp	edx, [ecx]
		jz	short loc_1001C47E
		inc	eax
		add	ecx, 0Ch
		cmp	eax, ebp
		jb	short loc_1001C451

loc_1001C45D:				; CODE XREF: sub_1001C340+107j
		xor	esi, esi

loc_1001C45F:				; CODE XREF: sub_1001C340+144j
		mov	ecx, [esp+98h+var_84]
		or	eax, 0FFFFFFFFh
		cmp	[ecx+8], eax
		jnz	short loc_1001C486
		test	esi, esi
		jz	short loc_1001C4EB
		cmp	[esi+8], eax
		jz	short loc_1001C4EB
		mov	[esp+98h+var_88], 2
		jmp	short loc_1001C4EB
; ---------------------------------------------------------------------------

loc_1001C47E:				; CODE XREF: sub_1001C340+113j
		lea	eax, [eax+eax*2]
		lea	esi, [edi+eax*4]
		jmp	short loc_1001C45F
; ---------------------------------------------------------------------------

loc_1001C486:				; CODE XREF: sub_1001C340+129j
		test	esi, esi
		jz	short loc_1001C4EB
		push	esi
		push	ecx
		mov	ecx, [esp+0A0h+arg_0]
		push	ecx
		call	sub_1001C240
		add	esp, 0Ch
		cmp	eax, 2
		jnz	short loc_1001C4A7
		mov	[esp+98h+var_88], eax
		jmp	short loc_1001C4EB
; ---------------------------------------------------------------------------

loc_1001C4A7:				; CODE XREF: sub_1001C340+15Fj
		cmp	eax, 3
		jnz	short loc_1001C4EB
		xor	eax, eax
		test	ebp, ebp
		jz	short loc_1001C4C2
		mov	esi, [esi]
		mov	ecx, edi

loc_1001C4B6:				; CODE XREF: sub_1001C340+180j
		cmp	esi, [ecx]
		jz	short loc_1001C4C2
		inc	eax
		add	ecx, 0Ch
		cmp	eax, ebp
		jb	short loc_1001C4B6

loc_1001C4C2:				; CODE XREF: sub_1001C340+170j
					; sub_1001C340+178j
		cmp	eax, ebp
		jz	short loc_1001C4EB
		inc	eax
		cmp	eax, ebp
		jnb	short loc_1001C4E8
		mov	ecx, ebp
		sub	ecx, eax
		lea	ecx, [ecx+ecx*2]
		add	ecx, ecx
		lea	edx, [eax+eax*2]
		lea	esi, [edi+edx*4]
		add	ecx, ecx
		lea	edi, [esi-0Ch]
		shr	ecx, 2
		rep movsd
		mov	edi, [esp+98h+var_78]

loc_1001C4E8:				; CODE XREF: sub_1001C340+189j
		dec	ebp
		mov	[ebx], ebp

loc_1001C4EB:				; CODE XREF: sub_1001C340+12Dj
					; sub_1001C340+132j ...
		add	[esp+98h+var_84], 0Ch
		dec	[esp+98h+var_80]
		jnz	loc_1001C441
		mov	edx, 2
		cmp	[esp+98h+var_88], edx
		jnz	loc_1001C593
		mov	edx, [esp+98h+arg_4]
		push	1
		lea	ecx, [esp+9Ch+var_74]
		lea	eax, [esp+9Ch+var_89]
		push	ecx
		mov	[esp+0A0h+var_70], eax
		mov	eax, [esp+0A0h+var_7C]
		push	edx
		push	eax
		mov	eax, [eax+20h]
		mov	[esp+0A8h+var_89], 0
		mov	[esp+0A8h+var_74], 0CE536360h
		mov	[esp+0A8h+var_6C], 1
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	loc_1001C5CE
		cmp	[esp+98h+var_89], 1
		jnz	short loc_1001C5CE
		mov	edx, [ebx]
		test	edx, edx
		jz	short loc_1001C56C
		mov	esi, [esp+98h+var_74]
		mov	ecx, edi
		lea	ecx, [ecx+0]

loc_1001C560:				; CODE XREF: sub_1001C340+22Aj
		cmp	esi, [ecx]
		jz	short loc_1001C56C
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001C560

loc_1001C56C:				; CODE XREF: sub_1001C340+215j
					; sub_1001C340+222j
		cmp	eax, edx
		jz	short loc_1001C5CE
		inc	eax
		cmp	eax, edx
		jnb	short loc_1001C58E
		lea	ecx, [eax+eax*2]
		lea	esi, [edi+ecx*4]
		mov	ecx, edx
		sub	ecx, eax
		lea	ecx, [ecx+ecx*2]
		add	ecx, ecx
		add	ecx, ecx
		lea	edi, [esi-0Ch]
		shr	ecx, 2
		rep movsd

loc_1001C58E:				; CODE XREF: sub_1001C340+233j
		dec	edx
		mov	[ebx], edx
		jmp	short loc_1001C5CE
; ---------------------------------------------------------------------------

loc_1001C593:				; CODE XREF: sub_1001C340+1C3j
		xor	eax, eax
		cmp	[ebx], eax
		jbe	short loc_1001C5CE
		mov	ecx, edi
		jmp	short loc_1001C5A0
; ---------------------------------------------------------------------------
		align 10h

loc_1001C5A0:				; CODE XREF: sub_1001C340+25Bj
					; sub_1001C340+26Ej
		cmp	dword ptr [ecx], 0CE536360h
		jz	short loc_1001C5B2
		inc	eax
		add	ecx, 0Ch
		cmp	eax, [ebx]
		jb	short loc_1001C5A0
		jmp	short loc_1001C5CE
; ---------------------------------------------------------------------------

loc_1001C5B2:				; CODE XREF: sub_1001C340+266j
		lea	eax, [eax+eax*2]
		lea	eax, [edi+eax*4]
		test	eax, eax
		jz	short loc_1001C5CE
		cmp	dword ptr [eax+8], 1
		jnz	short loc_1001C5CE
		mov	ecx, [eax+4]
		cmp	byte ptr [ecx],	1
		jnz	short loc_1001C5CE
		mov	[esp+98h+var_88], edx

loc_1001C5CE:				; CODE XREF: sub_1001C340+204j
					; sub_1001C340+20Fj ...
		pop	esi
		pop	ebp

loc_1001C5D0:				; CODE XREF: sub_1001C340+EAj
		mov	ecx, [esp+90h+var_4]
		mov	eax, [esp+90h+var_88]
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
sub_1001C340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C5F0	proc near		; CODE XREF: sub_1001C770+107p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+28h+arg_4]
		xor	ebx, ebx
		push	edi
		mov	edi, eax
		mov	eax, [esp+2Ch+arg_8]
		mov	eax, [eax]
		xor	ecx, ecx
		mov	[esp+2Ch+var_1C], ebx
		mov	[esp+2Ch+var_18], 102h
		mov	[esp+2Ch+var_14], ebx
		mov	[esp+2Ch+var_10], ebx
		mov	[esp+2Ch+var_C], 3
		mov	[esp+2Ch+var_8], ebx
		mov	[esp+2Ch+var_4], ebx
		cmp	eax, ebx
		jbe	short loc_1001C642
		mov	edx, esi

loc_1001C631:				; CODE XREF: sub_1001C5F0+50j
		cmp	dword ptr [edx], 3
		jz	loc_1001C6DE
		inc	ecx
		add	edx, 0Ch
		cmp	ecx, eax
		jb	short loc_1001C631

loc_1001C642:				; CODE XREF: sub_1001C5F0+3Dj
		xor	ebp, ebp

loc_1001C644:				; CODE XREF: sub_1001C5F0+F4j
		xor	ecx, ecx
		cmp	eax, ebx
		jbe	short loc_1001C664
		mov	edx, esi
		lea	esp, [esp+0]

loc_1001C650:				; CODE XREF: sub_1001C5F0+72j
		cmp	dword ptr [edx], 102h
		jz	loc_1001C6E9
		inc	ecx
		add	edx, 0Ch
		cmp	ecx, eax
		jb	short loc_1001C650

loc_1001C664:				; CODE XREF: sub_1001C5F0+58j
		xor	esi, esi

loc_1001C666:				; CODE XREF: sub_1001C5F0+FFj
		cmp	ebp, ebx
		jz	short loc_1001C66F
		cmp	[ebp+8], ebx
		jnz	short loc_1001C680

loc_1001C66F:				; CODE XREF: sub_1001C5F0+78j
		cmp	esi, ebx
		jz	loc_1001C766
		cmp	[esi+8], ebx
		jz	loc_1001C766

loc_1001C680:				; CODE XREF: sub_1001C5F0+7Dj
		mov	ecx, [esp+2Ch+arg_0]
		mov	edx, [edi+20h]
		push	2
		lea	eax, [esp+30h+var_18]
		push	eax
		push	ecx
		push	edi
		call	edx
		mov	eax, [esp+3Ch+var_10]
		mov	edi, [esp+3Ch+var_4]
		add	esp, 10h
		cmp	eax, ebx
		jz	short loc_1001C6A6
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001C6B7

loc_1001C6A6:				; CODE XREF: sub_1001C5F0+AFj
		cmp	edi, ebx
		jz	loc_1001C759
		cmp	edi, 0FFFFFFFFh
		jz	loc_1001C759

loc_1001C6B7:				; CODE XREF: sub_1001C5F0+B4j
		cmp	eax, ebx
		jz	short loc_1001C6F4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001C6F4
		cmp	ebp, ebx
		jz	short loc_1001C705
		cmp	[ebp+8], ebx
		jnz	short loc_1001C705
		mov	eax, [esp+2Ch+arg_8]
		mov	ecx, [esp+2Ch+arg_4]
		push	eax
		push	ecx
		push	ebp
		call	sub_1001C1E0
		add	esp, 0Ch
		jmp	short loc_1001C705
; ---------------------------------------------------------------------------

loc_1001C6DE:				; CODE XREF: sub_1001C5F0+44j
		lea	ecx, [ecx+ecx*2]
		lea	ebp, [esi+ecx*4]
		jmp	loc_1001C644
; ---------------------------------------------------------------------------

loc_1001C6E9:				; CODE XREF: sub_1001C5F0+66j
		lea	edx, [ecx+ecx*2]
		lea	esi, [esi+edx*4]
		jmp	loc_1001C666
; ---------------------------------------------------------------------------

loc_1001C6F4:				; CODE XREF: sub_1001C5F0+C9j
					; sub_1001C5F0+CEj
		cmp	ebp, ebx
		jz	short loc_1001C705
		cmp	[ebp+8], ebx
		jz	short loc_1001C705
		mov	[esp+2Ch+var_1C], 2

loc_1001C705:				; CODE XREF: sub_1001C5F0+D2j
					; sub_1001C5F0+D7j ...
		cmp	edi, ebx
		jz	short loc_1001C73C
		cmp	edi, 0FFFFFFFFh
		jz	short loc_1001C73C
		cmp	[esp+2Ch+var_1C], ebx
		jz	short loc_1001C766
		cmp	esi, ebx
		jz	short loc_1001C74D
		cmp	[esi+8], ebx
		jnz	short loc_1001C74D
		mov	edx, [esp+2Ch+arg_8]
		mov	eax, [esp+2Ch+arg_4]
		push	edx
		push	eax
		push	esi
		call	sub_1001C1E0
		mov	eax, [esp+38h+var_1C]
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C73C:				; CODE XREF: sub_1001C5F0+117j
					; sub_1001C5F0+11Cj
		cmp	esi, ebx
		jz	short loc_1001C74D
		cmp	[esi+8], ebx
		jz	short loc_1001C74D
		mov	[esp+2Ch+var_1C], 2

loc_1001C74D:				; CODE XREF: sub_1001C5F0+126j
					; sub_1001C5F0+12Bj ...
		mov	eax, [esp+2Ch+var_1C]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C759:				; CODE XREF: sub_1001C5F0+B8j
					; sub_1001C5F0+C1j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C766:				; CODE XREF: sub_1001C5F0+81j
					; sub_1001C5F0+8Aj ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
sub_1001C5F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001C770	proc near		; CODE XREF: sub_1001C8C0+1AAp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_C]
		push	esi
		push	edi
		lea	esp, [esp+0]

loc_1001C780:				; CODE XREF: sub_1001C770+43j
		mov	esi, [esp+14h+arg_8]
		mov	edi, [esp+14h+arg_10]
		mov	edx, [edi]
		mov	ebx, [esp+14h+arg_4]
		push	0
		push	esi
		mov	eax, ebp
		call	sub_1001B4C0
		add	esp, 8
		cmp	eax, 13h
		jnz	short loc_1001C7BD
		mov	edx, [esp+14h+arg_0]
		push	esi
		mov	ecx, edi
		mov	eax, ebp
		call	sub_1001B750
		add	esp, 4
		test	eax, eax
		jz	short loc_1001C780
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C7BD:				; CODE XREF: sub_1001C770+2Ej
		test	eax, eax
		jz	short loc_1001C7D0

loc_1001C7C1:				; CODE XREF: sub_1001C770+76j
					; sub_1001C770+9Dj ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1001C7D0:				; CODE XREF: sub_1001C770+4Fj
					; sub_1001C770+E2j
		mov	eax, [edi]
		push	eax
		push	esi
		mov	ecx, ebp
		lea	edi, [esp+1Ch+var_4]
		mov	esi, ebx
		call	sub_1001B400
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001C7C1
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jz	loc_1001C8B3
		mov	ecx, [esp+14h+arg_8]
		cmp	ecx, 4
		ja	loc_1001C885
		jnz	short loc_1001C857
		mov	ecx, [esp+14h+arg_10]
		mov	edx, [ecx]
		xor	eax, eax
		test	edx, edx
		jz	short loc_1001C7C1
		mov	ecx, ebp

loc_1001C811:				; CODE XREF: sub_1001C770+AFj
		cmp	dword ptr [ecx], 102h
		jz	short loc_1001C829
		inc	eax
		add	ecx, 0Ch
		cmp	eax, edx
		jb	short loc_1001C811
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C829:				; CODE XREF: sub_1001C770+A7j
		lea	edx, [eax+eax*2]
		lea	eax, [ebp+edx*4+0]
		test	eax, eax
		jz	short loc_1001C7C1
		push	eax
		mov	eax, [esp+18h+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 8
		test	eax, eax
		jnz	loc_1001C7C1
		mov	edi, [esp+14h+arg_10]
		mov	esi, [esp+14h+arg_8]
		jmp	loc_1001C7D0
; ---------------------------------------------------------------------------

loc_1001C857:				; CODE XREF: sub_1001C770+91j
		test	ecx, ecx
		jz	loc_1001C7C1
		cmp	ecx, 3
		ja	loc_1001C7C1
		mov	edx, [esp+14h+arg_10]
		mov	ecx, [esp+14h+arg_14]
		push	edx
		push	ebp
		mov	[ecx], eax
		push	eax
		mov	eax, esi
		call	sub_1001C5F0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C885:				; CODE XREF: sub_1001C770+8Bj
		cmp	ecx, 0CE534353h
		jnz	loc_1001C7C1
		mov	ecx, [esp+14h+arg_14]
		mov	edx, [esp+14h+arg_0]
		mov	ebx, [esp+14h+arg_10]
		push	eax
		mov	[ecx], eax
		push	edx
		mov	edx, ebp
		mov	ecx, esi
		call	sub_1001C340
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C8B3:				; CODE XREF: sub_1001C770+7Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
sub_1001C770	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C8C0	proc near		; CODE XREF: sub_1001CB20+104p

var_1784	= dword	ptr -1784h
var_1780	= dword	ptr -1780h
var_177C	= dword	ptr -177Ch
var_1778	= dword	ptr -1778h
var_1774	= byte ptr -1774h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 1784h
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1784h+var_4], eax
		mov	eax, [esp+1784h+arg_0]
		push	ebp
		mov	ebp, [eax]
		push	edi
		mov	edi, [eax+2Ch]
		push	100h
		mov	[esp+1790h+var_1778], eax
		mov	[esp+1790h+var_1784], 1F4h
		mov	[esp+1790h+var_177C], edi
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esp+178Ch+var_1780], eax
		test	eax, eax
		jnz	short loc_1001C927
		pop	edi
		mov	eax, 2
		pop	ebp
		mov	ecx, [esp+1784h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1784h
		retn
; ---------------------------------------------------------------------------

loc_1001C927:				; CODE XREF: sub_1001C8C0+49j
		mov	eax, [esp+178Ch+arg_4]
		push	ebx
		push	esi
		lea	ecx, [esp+1794h+var_1784]
		and	eax, 3FFFFFFFh
		push	ecx
		lea	esi, [esp+1798h+var_1774]
		push	eax
		mov	ebx, esi
		mov	ecx, edi
		mov	[esp+179Ch+arg_4], eax
		call	sub_1001BEE0
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, 150h
		jnz	short loc_1001C99A
		mov	eax, [esp+1794h+var_1784]
		lea	edx, [eax+eax*2]
		mov	eax, [esp+1794h+var_1780]
		add	edx, edx
		add	edx, edx
		push	edx
		push	eax
		call	PORT_ArenaAlloc_Util
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_1001CA4B
		mov	edx, [esp+1794h+arg_4]
		lea	ecx, [esp+1794h+var_1784]
		push	ecx
		push	edx
		mov	ebx, esi
		mov	ecx, edi
		call	sub_1001BEE0
		add	esp, 8
		mov	ebx, eax

loc_1001C99A:				; CODE XREF: sub_1001C8C0+9Aj
		test	ebx, ebx
		jnz	loc_1001CAE9
		xor	edi, edi
		cmp	[esp+1794h+var_1784], edi
		jbe	short loc_1001C9D5
		lea	ebx, [esi+4]
		lea	ecx, [ecx+0]

loc_1001C9B0:				; CODE XREF: sub_1001C8C0+113j
		mov	eax, [ebx+4]
		mov	ecx, [esp+1794h+var_1780]
		push	eax
		push	ecx
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[ebx], eax
		test	eax, eax
		jz	loc_1001CA4B
		inc	edi
		add	ebx, 0Ch
		cmp	edi, [esp+1794h+var_1784]
		jb	short loc_1001C9B0

loc_1001C9D5:				; CODE XREF: sub_1001C8C0+E8j
		mov	edx, [esp+1794h+var_1784]
		mov	eax, [esp+1794h+arg_4]
		push	edx
		push	esi
		push	eax
		mov	eax, [esp+17A0h+var_177C]
		mov	ecx, [eax+20h]
		push	eax
		call	ecx
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	loc_1001CAE9
		mov	edx, [esp+1794h+var_1784]
		xor	edi, edi
		call	sub_1001C110
		mov	edi, [esp+1794h+var_1778]
		cmp	[edi+30h], ebx
		jnz	short loc_1001CA55
		mov	ebx, [esp+1794h+var_1784]
		mov	eax, [ebp+28h]
		push	ebx
		push	esi
		lea	edx, [esp+179Ch+arg_4]
		push	edx
		push	ebp
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	loc_1001CAE7
		mov	ecx, [esp+1794h+arg_4]
		mov	eax, [esp+1794h+var_1780]
		xor	edx, edx
		cmp	ebp, [edi+2Ch]
		push	ebx
		setz	dl
		push	esi
		push	ecx
		push	edx
		push	edi
		push	eax
		jmp	loc_1001CADF
; ---------------------------------------------------------------------------

loc_1001CA4B:				; CODE XREF: sub_1001C8C0+B9j
					; sub_1001C8C0+105j
		mov	ebx, 2
		jmp	loc_1001CAE9
; ---------------------------------------------------------------------------

loc_1001CA55:				; CODE XREF: sub_1001C8C0+14Cj
		lea	ecx, [esp+1794h+arg_4]
		push	ecx
		lea	edx, [esp+1798h+var_1784]
		push	edx
		push	esi
		push	eax
		mov	eax, [esp+17A4h+var_1780]
		push	ebp
		push	eax
		call	sub_1001C770
		add	esp, 18h
		dec	eax
		jz	short loc_1001CAAD
		dec	eax
		jnz	short loc_1001CAE9
		mov	ecx, [esp+1794h+var_1784]
		mov	eax, [esp+1794h+arg_4]
		mov	edx, [ebp+24h]
		push	ecx
		push	esi
		push	eax
		push	ebp
		mov	ebx, eax
		call	edx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001CAE7
		mov	eax, [esp+1794h+var_1784]
		mov	edx, [esp+1794h+var_1780]
		xor	ecx, ecx
		cmp	ebp, [edi+2Ch]
		push	eax
		setz	cl
		push	esi
		push	ebx
		push	ecx
		push	edi
		push	edx
		jmp	short loc_1001CADF
; ---------------------------------------------------------------------------

loc_1001CAAD:				; CODE XREF: sub_1001C8C0+1B3j
		mov	ebx, [esp+1794h+var_1784]
		mov	ecx, [ebp+28h]
		push	ebx
		push	esi
		lea	eax, [esp+179Ch+arg_4]
		push	eax
		push	ebp
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001CAE7
		cmp	ebp, [edi+2Ch]
		mov	edx, [esp+1794h+arg_4]
		mov	ecx, [esp+1794h+var_1780]
		push	ebx
		setz	al
		push	esi
		push	edx
		push	eax
		push	edi
		push	ecx

loc_1001CADF:				; CODE XREF: sub_1001C8C0+186j
					; sub_1001C8C0+1EBj
		call	sub_1001AC80
		add	esp, 18h

loc_1001CAE7:				; CODE XREF: sub_1001C8C0+167j
					; sub_1001C8C0+1D3j ...
		mov	ebx, eax

loc_1001CAE9:				; CODE XREF: sub_1001C8C0+DCj
					; sub_1001C8C0+134j ...
		mov	edx, [esp+1794h+var_1780]
		push	1
		push	edx
		call	PORT_FreeArena_Util
		mov	ecx, [esp+179Ch+var_4]
		add	esp, 8
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1784h
		retn
sub_1001C8C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CB20	proc near		; CODE XREF: sub_1001CFB0+460p
					; sub_1001EE90+AFp ...

var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= byte ptr -244h
var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= byte ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_204		= byte ptr -204h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 254h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+254h+var_4], eax
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	esi, [esp+25Ch+arg_0]
		mov	[esp+25Ch+var_254], ebp
		mov	[esp+25Ch+var_250], 0Ah
		mov	[esp+25Ch+var_248], ebp
		mov	[esp+25Ch+var_24C], ebp
		cmp	esi, ebp
		jnz	short loc_1001CB70

loc_1001CB57:				; CODE XREF: sub_1001CB20+53j
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+254h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 254h
		retn
; ---------------------------------------------------------------------------

loc_1001CB70:				; CODE XREF: sub_1001CB20+35j
		cmp	[esi+2Ch], ebp
		jz	short loc_1001CB57
		mov	eax, [esi]
		push	ebx
		push	edi
		push	eax
		mov	eax, [eax+38h]
		call	eax
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebp
		jnz	loc_1001CC50
		mov	ebx, 40000000h
		mov	[esp+264h+var_24C], 1
		mov	ecx, offset aKey ; "key"
		cmp	[esi+8], ebx
		jz	short loc_1001CBA8
		mov	ecx, offset aCert ; "cert"

loc_1001CBA8:				; CODE XREF: sub_1001CB20+81j
		mov	edx, [esi+30h]
		push	edx
		mov	edx, [esi]
		call	sub_1001BFB0
		add	esp, 4
		test	eax, eax
		jnz	loc_1001CCDC
		push	esi
		call	sub_1001EDF0
		add	esp, 4
		mov	[esp+264h+var_248], eax
		cmp	eax, ebp
		jz	short loc_1001CBD2
		mov	[esi+1Ch], eax

loc_1001CBD2:				; CODE XREF: sub_1001CB20+ADj
		lea	eax, [esp+264h+var_254]
		push	eax
		push	ebp
		push	ebp
		push	esi
		call	sub_1001BA20
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebp
		jnz	short loc_1001CC50
		mov	eax, [esp+264h+var_250]
		lea	esp, [esp+0]

loc_1001CBF0:				; CODE XREF: sub_1001CB20+FCj
		cmp	eax, 0Ah
		jnz	short loc_1001CC33
		lea	ecx, [esp+264h+var_250]
		push	ecx
		push	eax
		mov	eax, [esp+26Ch+var_254]
		lea	edx, [esp+26Ch+var_22C]
		push	edx
		push	eax
		push	esi
		call	sub_1001BAA0
		mov	edi, eax
		add	esp, 14h
		xor	ebx, ebx
		cmp	edi, ebp
		jnz	short loc_1001CC33

loc_1001CC16:				; CODE XREF: sub_1001CB20+111j
		mov	eax, [esp+264h+var_250]
		cmp	ebx, eax
		jnb	short loc_1001CBF0
		mov	ecx, [esp+ebx*4+264h+var_22C]
		push	ecx
		push	esi
		call	sub_1001C8C0
		mov	edi, eax
		add	esp, 8
		inc	ebx
		cmp	edi, ebp
		jz	short loc_1001CC16

loc_1001CC33:				; CODE XREF: sub_1001CB20+D3j
					; sub_1001CB20+F4j
		mov	eax, [esi+2Ch]
		cmp	eax, ebp
		jnz	short loc_1001CC3C
		mov	eax, [esi]

loc_1001CC3C:				; CODE XREF: sub_1001CB20+118j
		mov	edx, [esp+264h+var_254]
		push	edx
		push	eax
		mov	eax, [eax+1Ch]
		call	eax
		add	esp, 8
		cmp	edi, ebp
		jnz	short loc_1001CC50
		mov	edi, eax

loc_1001CC50:				; CODE XREF: sub_1001CB20+66j
					; sub_1001CB20+C6j ...
		mov	ebx, 40000000h
		mov	[esi+1Ch], ebp
		cmp	[esi+8], ebx
		jnz	short loc_1001CCD8
		lea	ecx, [esp+264h+var_204]
		mov	[esp+264h+var_234], ecx
		lea	edx, [esp+264h+var_104]
		mov	[esp+264h+var_240], edx
		lea	ecx, [esp+264h+var_244]
		push	ecx
		mov	eax, 100h
		lea	edx, [esp+268h+var_238]
		push	edx
		mov	[esp+26Ch+var_230], eax
		mov	[esp+26Ch+var_23C], eax
		mov	eax, [esi]
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+30h]
		call	eax
		add	esp, 10h
		cmp	eax, ebp
		jz	short loc_1001CCDC
		mov	eax, [esi+2Ch]
		lea	ecx, [esp+264h+var_244]
		push	ecx
		lea	edx, [esp+268h+var_238]
		push	edx
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+30h]
		call	eax
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebp
		jnz	short loc_1001CCFB
		mov	eax, [esi]
		lea	ecx, [esp+264h+var_244]
		push	ecx
		lea	edx, [esp+268h+var_238]
		push	edx
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+34h]
		call	eax
		add	esp, 10h
		mov	edi, eax

loc_1001CCD8:				; CODE XREF: sub_1001CB20+13Bj
		cmp	edi, ebp
		jnz	short loc_1001CCFB

loc_1001CCDC:				; CODE XREF: sub_1001CB20+98j
					; sub_1001CB20+179j
		mov	eax, offset aKey ; "key"
		cmp	[esi+8], ebx
		jz	short loc_1001CCEB
		mov	eax, offset aCert ; "cert"

loc_1001CCEB:				; CODE XREF: sub_1001CB20+1C4j
		mov	ecx, [esi+30h]
		push	eax
		mov	eax, [esi]
		call	sub_1001C080
		add	esp, 4
		mov	edi, eax

loc_1001CCFB:				; CODE XREF: sub_1001CB20+19Aj
					; sub_1001CB20+1BAj
		cmp	[esp+264h+var_24C], ebp
		jz	short loc_1001CD19
		mov	eax, [esi]
		push	eax
		cmp	edi, ebp
		jnz	short loc_1001CD11
		mov	ecx, [eax+3Ch]
		call	ecx
		mov	edi, eax
		jmp	short loc_1001CD16
; ---------------------------------------------------------------------------

loc_1001CD11:				; CODE XREF: sub_1001CB20+1E6j
		mov	edx, [eax+40h]
		call	edx

loc_1001CD16:				; CODE XREF: sub_1001CB20+1EFj
		add	esp, 4

loc_1001CD19:				; CODE XREF: sub_1001CB20+1DFj
		mov	eax, [esi+2Ch]
		cmp	eax, ebp
		jz	short loc_1001CD2C
		push	eax
		mov	eax, [eax+48h]
		call	eax
		add	esp, 4
		mov	[esi+2Ch], ebp

loc_1001CD2C:				; CODE XREF: sub_1001CB20+1FEj
		mov	eax, [esi+30h]
		cmp	eax, ebp
		jz	short loc_1001CD3F
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+30h], ebp

loc_1001CD3F:				; CODE XREF: sub_1001CB20+211j
		push	esi
		call	sub_1001EE40
		mov	eax, [esp+268h+var_248]
		add	esp, 4
		cmp	eax, ebp
		jz	short loc_1001CD5B
		push	1
		push	eax
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_1001CD5B:				; CODE XREF: sub_1001CB20+22Ej
		mov	ecx, [esp+264h+var_4]
		mov	eax, edi
		pop	edi
		pop	ebx
		mov	[esi+34h], ebp
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 254h
		retn
sub_1001CB20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CD80	proc near		; CODE XREF: sub_1000B3F0+1B8p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+30h]
		retn
sub_1001CD80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CD90	proc near		; CODE XREF: sub_10006D60+10Bp
					; sub_10006E80+A4p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_1001CDB3
		lea	eax, [esi+4]
		push	eax
		call	ds:PR_AtomicDecrement
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001CDB3
		push	esi
		call	sub_1001BDE0
		add	esp, 4

loc_1001CDB3:				; CODE XREF: sub_1001CD90+7j
					; sub_1001CD90+18j
		pop	esi
		retn
sub_1001CD90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CDC0	proc near		; CODE XREF: sub_10006D60+E7p
					; sub_10006E80+80p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+4]
		push	eax
		call	ds:PR_Lock
		mov	esi, [edi+3Ch]
		add	esp, 4
		test	esi, esi
		jz	short loc_1001CDE7
		lea	ecx, [esi+4]
		push	ecx
		call	ds:PR_AtomicIncrement
		add	esp, 4

loc_1001CDE7:				; CODE XREF: sub_1001CDC0+18j
		mov	edx, [edi+4]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_1001CDC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CE00	proc near		; CODE XREF: sub_10008020+17p
					; sub_10008680+83p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+4]
		push	eax
		call	ds:PR_Lock
		mov	esi, [edi+40h]
		add	esp, 4
		test	esi, esi
		jz	short loc_1001CE27
		lea	ecx, [esi+4]
		push	ecx
		call	ds:PR_AtomicIncrement
		add	esp, 4

loc_1001CE27:				; CODE XREF: sub_1001CE00+18j
		mov	edx, [edi+4]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_1001CE00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CE40	proc near		; CODE XREF: sub_10009390+5Fp
					; sub_10015DB0+27p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+4]
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		test	[esp+8+arg_4], 40000000h
		jz	short loc_1001CE62
		mov	esi, [edi+40h]
		jmp	short loc_1001CE65
; ---------------------------------------------------------------------------

loc_1001CE62:				; CODE XREF: sub_1001CE40+1Bj
		mov	esi, [edi+3Ch]

loc_1001CE65:				; CODE XREF: sub_1001CE40+20j
		test	esi, esi
		jz	short loc_1001CE76
		lea	ecx, [esi+4]
		push	ecx
		call	ds:PR_AtomicIncrement
		add	esp, 4

loc_1001CE76:				; CODE XREF: sub_1001CE40+27j
		mov	edx, [edi+4]
		push	edx
		call	ds:PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_1001CE40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CE90	proc near		; CODE XREF: sub_10008930+B5p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+8], 40000000h
		jz	short loc_1001CEA1
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CEA1:				; CODE XREF: sub_1001CE90+Bj
		call	sub_1001BE90
		neg	eax
		sbb	eax, eax
		retn
sub_1001CE90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CEB0	proc near		; CODE XREF: sub_1001CF10+40p
					; sub_1001CF10+85p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebx, eax
		push	esi
		push	edi
		cmp	ebx, 1
		jle	short loc_1001CEF6
		mov	ebp, ds:PR_smprintf

loc_1001CEC1:				; CODE XREF: sub_1001CEB0+44j
		mov	eax, [esp+10h+arg_0]
		push	ebx
		push	eax
		push	offset aSD_db	; "%s%d.db"
		call	ebp ; PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1001CEF0
		push	1
		push	esi
		call	ds:PR_Access
		push	esi
		mov	edi, eax
		call	ds:PR_smprintf_free
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_1001CEFD

loc_1001CEF0:				; CODE XREF: sub_1001CEB0+25j
		dec	ebx
		cmp	ebx, 1
		jg	short loc_1001CEC1

loc_1001CEF6:				; CODE XREF: sub_1001CEB0+9j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001CEFD:				; CODE XREF: sub_1001CEB0+3Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
sub_1001CEB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CF10	proc near		; CODE XREF: sub_1001CFB0+17Ap
					; sub_1001CFB0+1F7p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		test	eax, eax
		jnz	short loc_1001CF19
		mov	eax, offset word_10026FE6

loc_1001CF19:				; CODE XREF: sub_1001CF10+2j
		cmp	[esp+arg_4], 0
		jnz	short loc_1001CF28
		mov	[esp+arg_4], offset word_10026FE6

loc_1001CF28:				; CODE XREF: sub_1001CF10+Ej
		push	ebx
		mov	ebx, ds:PR_smprintf
		push	esi
		push	eax
		mov	eax, [esp+0Ch+arg_0]
		push	eax
		push	offset aSScert	; "%s/%scert"
		call	ebx ; PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001CF49
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001CF49:				; CODE XREF: sub_1001CF10+34j
		mov	eax, [esp+8+arg_8]
		push	ebp
		push	edi
		push	esi
		call	sub_1001CEB0
		mov	ebp, ds:PR_smprintf_free
		push	esi
		mov	edi, eax
		call	ebp ; PR_smprintf_free
		add	esp, 8
		test	edi, edi
		jz	short loc_1001CF71
		pop	edi
		pop	ebp
		pop	esi
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001CF71:				; CODE XREF: sub_1001CF10+55j
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		push	ecx
		push	edx
		push	offset aSSkey	; "%s/%skey"
		call	ebx ; PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001CF90
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001CF90:				; CODE XREF: sub_1001CF10+79j
		mov	eax, [esp+10h+arg_C]
		push	esi
		call	sub_1001CEB0
		push	esi
		mov	edi, eax
		call	ebp ; PR_smprintf_free
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
sub_1001CF10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CFB0	proc near		; CODE XREF: sub_1000AB70+1CBp

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch
arg_2C		= dword	ptr  30h
arg_30		= dword	ptr  34h
arg_34		= dword	ptr  38h

		sub	esp, 20h
		push	ebx
		push	ebp
		push	edi
		xor	edi, edi
		mov	[esp+2Ch+var_10], edi
		mov	[esp+2Ch+var_4], edi
		mov	[esp+2Ch+var_20], 1
		mov	[esp+2Ch+var_C], edi
		mov	[esp+2Ch+var_14], edi
		cmp	[esp+2Ch+arg_1C], edi
		jnz	short loc_1001CFDE
		mov	[esp+2Ch+var_20], 4

loc_1001CFDE:				; CODE XREF: sub_1001CFB0+24j
		mov	eax, [esp+2Ch+arg_30]
		mov	ebp, [esp+2Ch+arg_24]
		mov	ecx, [esp+2Ch+arg_34]
		mov	ebx, [esp+2Ch+arg_20]
		mov	[eax], edi
		mov	[ecx], edi
		cmp	ebp, edi
		jz	short loc_1001D003
		cmp	ebx, edi
		jz	short loc_1001D003
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1001D003:				; CODE XREF: sub_1001CFB0+44j
					; sub_1001CFB0+48j
		push	esi
		mov	esi, [esp+30h+arg_0]
		lea	edx, [esp+30h+var_4]
		push	edx
		lea	eax, [esp+34h+var_10]
		push	eax
		push	esi
		call	_NSSUTIL_EvaluateConfigDir
		mov	ecx, eax
		mov	eax, [esp+3Ch+var_10]
		dec	eax
		add	esp, 0Ch
		mov	[esp+30h+arg_1C], ecx
		cmp	eax, 3		; switch 4 cases
		ja	loc_1001D278	; jumptable 1001D02F default case
		jmp	ds:off_1001D440[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001D036:				; CODE XREF: sub_1001CFB0+7Fj
					; DATA XREF: .text:off_1001D440o
		mov	edx, ebp	; jumptable 1001D02F case 2
		neg	edx
		sbb	edx, edx
		not	edx
		lea	eax, [esp+30h+var_18]
		and	edx, eax
		push	edx
		mov	edx, ebx
		neg	edx
		sbb	edx, edx
		not	edx
		lea	eax, [esp+34h+var_1C]
		and	edx, eax
		mov	eax, [esp+34h+var_20]
		push	edx
		mov	edx, [esp+38h+arg_2C]
		push	edx
		mov	edx, [esp+3Ch+arg_8]
		push	eax
		mov	eax, [esp+40h+arg_4]
		push	3
		push	8
		push	edx
		push	eax
		push	ecx
		call	sub_10004F20
		add	esp, 24h
		mov	[esp+30h+arg_24], eax
		jmp	loc_1001D160
; ---------------------------------------------------------------------------

loc_1001D07E:				; CODE XREF: sub_1001CFB0+7Fj
					; DATA XREF: .text:off_1001D440o
		mov	ecx, ebp	; jumptable 1001D02F case 3
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		lea	edx, [esp+30h+var_18]
		and	ecx, edx
		mov	edx, [esp+30h+arg_2C]
		push	ecx
		mov	eax, ebx
		neg	eax
		sbb	eax, eax
		not	eax
		lea	ecx, [esp+34h+var_1C]
		and	eax, ecx
		mov	ecx, [esp+34h+arg_8]
		push	eax
		mov	eax, [esp+38h+var_20]
		push	edx
		mov	edx, [esp+3Ch+arg_4]
		push	eax
		push	3
		push	8
		push	ecx
		push	edx
		push	esi
		call	sub_10004F20
		add	esp, 24h
		mov	[esp+30h+arg_24], eax
		jmp	loc_1001D160
; ---------------------------------------------------------------------------

loc_1001D0C6:				; CODE XREF: sub_1001CFB0+7Fj
					; DATA XREF: .text:off_1001D440o
		mov	esi, ebp	; jumptable 1001D02F cases 0,1
		neg	esi
		sbb	esi, esi
		lea	eax, [esp+30h+var_18]
		not	esi
		and	esi, eax
		mov	eax, [esp+30h+var_20]
		mov	edi, ebx
		neg	edi
		sbb	edi, edi
		lea	edx, [esp+30h+var_C]
		push	edx
		mov	edx, [esp+34h+arg_4]
		push	esi
		lea	ecx, [esp+38h+var_1C]
		not	edi
		and	edi, ecx
		mov	ecx, [esp+38h+arg_8]
		push	edi
		push	eax
		mov	eax, [esp+40h+arg_1C]
		push	4
		push	9
		push	ecx
		push	edx
		push	eax
		call	sub_1001A510
		add	esp, 24h
		mov	[esp+30h+arg_24], eax
		test	eax, eax
		jz	short loc_1001D16F
		cmp	[esp+30h+var_20], 1
		jnz	short loc_1001D15E
		mov	ecx, [esp+30h+arg_8]
		mov	edx, [esp+30h+arg_1C]
		mov	eax, [esp+30h+arg_4]
		push	3
		push	8
		push	ecx
		push	edx
		call	sub_1001CF10
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001D15E
		mov	eax, [esp+30h+arg_2C]
		mov	ecx, [esp+30h+arg_8]
		mov	edx, [esp+30h+arg_4]
		push	esi
		push	edi
		push	eax
		mov	eax, [esp+3Ch+arg_1C]
		push	1
		push	3
		push	8
		push	ecx
		push	edx
		push	eax
		call	sub_10004F20
		add	esp, 24h
		mov	[esp+30h+arg_24], eax

loc_1001D15E:				; CODE XREF: sub_1001CFB0+166j
					; sub_1001CFB0+184j
		xor	edi, edi

loc_1001D160:				; CODE XREF: sub_1001CFB0+C9j
					; sub_1001CFB0+111j
		cmp	[esp+30h+arg_24], edi
		jnz	loc_1001D418
		jmp	loc_1001D20D
; ---------------------------------------------------------------------------

loc_1001D16F:				; CODE XREF: sub_1001CFB0+15Fj
		mov	edi, [esp+30h+arg_C]
		test	edi, edi
		jz	loc_1001D251
		cmp	byte ptr [edi],	0
		jz	loc_1001D251
		mov	eax, [esp+30h+arg_18]
		test	eax, eax
		jz	loc_1001D251
		cmp	byte ptr [eax],	0
		jz	loc_1001D251
		mov	esi, [esp+30h+arg_14]
		mov	eax, [esp+30h+arg_10]
		push	3
		push	8
		push	esi
		push	edi
		call	sub_1001CF10
		add	esp, 10h
		test	eax, eax
		jz	loc_1001D251
		test	ebp, ebp
		jnz	short loc_1001D1F3
		mov	ecx, [esp+30h+arg_18]
		mov	edx, [esp+30h+var_18]
		push	ecx
		mov	ecx, offset aKey ; "key"
		call	sub_1001BFB0
		add	esp, 4
		test	eax, eax
		jz	short loc_1001D1F3
		test	ebx, ebx
		jnz	short loc_1001D1F3
		mov	edx, [esp+30h+arg_18]
		push	edx
		mov	edx, [esp+34h+var_1C]
		mov	ecx, offset aCert ; "cert"
		call	sub_1001BFB0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001D251

loc_1001D1F3:				; CODE XREF: sub_1001CFB0+209j
					; sub_1001CFB0+223j ...
		mov	eax, [esp+30h+arg_10]
		mov	[esp+30h+arg_1C], edi
		mov	[esp+30h+arg_4], eax
		mov	[esp+30h+arg_8], esi

loc_1001D203:				; CODE XREF: sub_1001CFB0+2C6j
		mov	[esp+30h+var_14], 1

loc_1001D20B:				; CODE XREF: sub_1001CFB0+2A6j
					; sub_1001CFB0+2C4j
		xor	edi, edi

loc_1001D20D:				; CODE XREF: sub_1001CFB0+1BAj
		cmp	ebx, edi
		jnz	short loc_1001D285
		mov	esi, [esp+30h+var_1C]
		push	38h
		call	PORT_Alloc_Util
		mov	ecx, [esp+34h+arg_30]
		mov	dword ptr [eax+4], 1
		mov	[eax], esi
		mov	[eax+2Ch], edi
		mov	[eax+28h], edi
		mov	[eax+18h], edi
		mov	[eax+1Ch], edi
		mov	[eax+20h], edi
		mov	[eax+30h], edi
		mov	[eax+8], edi
		mov	[eax+10h], edi
		mov	[eax+14h], edi
		mov	[eax+24h], edi
		mov	[esi+10h], eax
		add	esp, 4
		mov	[ecx], eax
		jmp	short loc_1001D28B
; ---------------------------------------------------------------------------

loc_1001D251:				; CODE XREF: sub_1001CFB0+1C5j
					; sub_1001CFB0+1CEj ...
		cmp	[esp+30h+var_C], 0
		jz	short loc_1001D20B
		mov	ecx, [esp+30h+arg_8]
		mov	edx, [esp+30h+arg_1C]
		mov	eax, [esp+30h+arg_4]
		push	3
		push	8
		push	ecx
		push	edx
		call	sub_1001CF10
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001D20B
		jmp	short loc_1001D203
; ---------------------------------------------------------------------------

loc_1001D278:				; CODE XREF: sub_1001CFB0+79j
		mov	[esp+30h+arg_24], 5 ; jumptable	1001D02F default case
		jmp	loc_1001D418
; ---------------------------------------------------------------------------

loc_1001D285:				; CODE XREF: sub_1001CFB0+25Fj
		mov	edx, [esp+30h+arg_30]
		mov	[edx], edi

loc_1001D28B:				; CODE XREF: sub_1001CFB0+29Fj
		cmp	ebp, edi
		jnz	short loc_1001D2EC
		mov	eax, [esp+30h+var_18]
		push	38h
		mov	[esp+34h+var_8], eax
		call	PORT_Alloc_Util
		mov	ecx, [esp+34h+var_8]
		mov	esi, eax
		add	esp, 4
		mov	dword ptr [esi+4], 1
		mov	[esi], ecx
		mov	[esi+2Ch], edi
		mov	[esi+28h], edi
		mov	[esi+18h], edi
		mov	[esi+1Ch], edi
		mov	[esi+20h], edi
		mov	[esi+30h], edi
		mov	dword ptr [esi+8], 40000000h
		mov	[esi+10h], edi
		mov	[esi+14h], edi
		mov	[esi+24h], edi
		call	ds:PR_NewLock
		mov	edx, [esp+30h+var_8]
		mov	[esi+24h], eax
		mov	eax, [esp+30h+arg_34]
		mov	[edx+10h], esi
		mov	[eax], esi
		mov	esi, eax
		jmp	short loc_1001D2F2
; ---------------------------------------------------------------------------

loc_1001D2EC:				; CODE XREF: sub_1001CFB0+2DDj
		mov	esi, [esp+30h+arg_34]
		mov	[esi], edi

loc_1001D2F2:				; CODE XREF: sub_1001CFB0+33Aj
		mov	ecx, [esp+30h+arg_30]
		mov	eax, [ecx]
		cmp	eax, edi
		jz	short loc_1001D301
		mov	edx, [esi]
		mov	[eax+28h], edx

loc_1001D301:				; CODE XREF: sub_1001CFB0+34Aj
		mov	eax, [esi]
		cmp	eax, edi
		jz	short loc_1001D30C
		mov	ecx, [ecx]
		mov	[eax+28h], ecx

loc_1001D30C:				; CODE XREF: sub_1001CFB0+355j
		cmp	[esp+30h+var_14], edi
		jz	loc_1001D418
		mov	ecx, [esp+30h+arg_2C]
		neg	ebp
		sbb	ebp, ebp
		lea	edx, [esp+30h+var_14]
		not	ebp
		and	ebp, edx
		mov	edx, [esp+30h+var_20]
		neg	ebx
		push	ebp
		sbb	ebx, ebx
		lea	eax, [esp+34h+arg_34]
		not	ebx
		and	ebx, eax
		mov	eax, [esp+34h+arg_8]
		push	ebx
		push	ecx
		mov	ecx, [esp+3Ch+arg_4]
		push	edx
		mov	edx, [esp+40h+arg_1C]
		push	3
		push	8
		push	eax
		push	ecx
		push	edx
		mov	[esp+54h+arg_34], edi
		mov	[esp+54h+var_14], edi
		call	sub_10004F20
		add	esp, 24h
		test	eax, eax
		jnz	loc_1001D418
		mov	ebp, [esp+30h+arg_30]
		mov	eax, [ebp+0]
		mov	ebx, [esp+30h+arg_18]
		cmp	eax, edi
		jz	short loc_1001D3A4
		mov	ecx, [esp+30h+arg_34]
		mov	[eax+2Ch], ecx
		cmp	ebx, edi
		jz	short loc_1001D392
		cmp	byte ptr [ebx],	0
		jz	short loc_1001D392
		push	ebx
		call	PORT_Strdup_Util
		add	esp, 4
		jmp	short loc_1001D394
; ---------------------------------------------------------------------------

loc_1001D392:				; CODE XREF: sub_1001CFB0+3D0j
					; sub_1001CFB0+3D5j
		xor	eax, eax

loc_1001D394:				; CODE XREF: sub_1001CFB0+3E0j
		mov	edx, [ebp+0]
		mov	[edx+30h], eax
		mov	eax, [ebp+0]
		mov	ecx, [esp+30h+arg_34]
		mov	[ecx+10h], eax

loc_1001D3A4:				; CODE XREF: sub_1001CFB0+3C5j
		mov	eax, [esi]
		cmp	eax, edi
		jz	short loc_1001D40B
		mov	edx, [esp+30h+var_14]
		mov	[esp+30h+arg_30], edi
		mov	[eax+2Ch], edx
		cmp	ebx, edi
		jz	short loc_1001D3C9
		cmp	byte ptr [ebx],	0
		jz	short loc_1001D3C9
		push	ebx
		call	PORT_Strdup_Util
		add	esp, 4
		jmp	short loc_1001D3CB
; ---------------------------------------------------------------------------

loc_1001D3C9:				; CODE XREF: sub_1001CFB0+407j
					; sub_1001CFB0+40Cj
		xor	eax, eax

loc_1001D3CB:				; CODE XREF: sub_1001CFB0+417j
		mov	ecx, [esi]
		mov	[ecx+30h], eax
		mov	edx, [esi]
		mov	eax, [esp+30h+var_14]
		mov	[eax+10h], edx
		mov	ecx, [esi]
		mov	dword ptr [ecx+34h], 1
		mov	edx, [esi]
		push	edx
		call	sub_1001EE90
		mov	ecx, [esi]
		neg	eax
		sbb	eax, eax
		inc	eax
		lea	edx, [esp+34h+arg_30]
		push	edx
		mov	[ecx+34h], eax
		mov	eax, [esi]
		push	offset word_10026FE6
		push	eax
		call	sub_1001EF70
		add	esp, 10h
		jmp	short loc_1001D418
; ---------------------------------------------------------------------------

loc_1001D40B:				; CODE XREF: sub_1001CFB0+3F8j
		mov	ecx, [ebp+0]
		push	edi
		push	ecx
		call	sub_1001CB20
		add	esp, 8

loc_1001D418:				; CODE XREF: sub_1001CFB0+1B4j
					; sub_1001CFB0+2D0j ...
		mov	eax, [esp+30h+var_4]
		pop	esi
		cmp	eax, edi
		jz	short loc_1001D42A
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001D42A:				; CODE XREF: sub_1001CFB0+46Fj
		mov	eax, [esp+2Ch+arg_28]
		neg	eax
		sbb	eax, eax
		pop	edi
		not	eax
		and	eax, [esp+28h+arg_24]
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_1001CFB0	endp

; ---------------------------------------------------------------------------
		align 10h
off_1001D440	dd offset loc_1001D0C6	; DATA XREF: sub_1001CFB0+7Fr
		dd offset loc_1001D0C6	; jump table for switch	statement
		dd offset loc_1001D036
		dd offset loc_1001D07E

; =============== S U B	R O U T	I N E =======================================


sub_1001D450	proc near		; CODE XREF: sub_1000B270+4Ap
					; sub_1000B300+38p
		call	sub_10008590
		call	sub_10005040
		xor	eax, eax
		retn
sub_1001D450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D460	proc near		; CODE XREF: sub_1001D520+31p
		cmp	eax, 261h
		ja	short loc_1001D493
		jz	short loc_1001D48D
		add	eax, 0FFFFFDEFh	; switch 70 cases
		cmp	eax, 45h
		ja	short loc_1001D4A4 ; jumptable 1001D47A	default	case
		movzx	eax, ds:byte_1001D4D0[eax]
		jmp	ds:off_1001D4BC[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001D481:				; CODE XREF: sub_1001D460+1Aj
					; DATA XREF: .text:off_1001D4BCo
		mov	eax, 7		; jumptable 1001D47A case 598
		retn
; ---------------------------------------------------------------------------

loc_1001D487:				; CODE XREF: sub_1001D460+1Aj
					; DATA XREF: .text:off_1001D4BCo
		mov	eax, 4		; jumptable 1001D47A case 593
		retn
; ---------------------------------------------------------------------------

loc_1001D48D:				; CODE XREF: sub_1001D460+7j
		mov	eax, 5
		retn
; ---------------------------------------------------------------------------

loc_1001D493:				; CODE XREF: sub_1001D460+5j
		sub	eax, 271h
		jz	short loc_1001D4B3
		sub	eax, 10Fh
		jz	short loc_1001D4AD ; jumptable 1001D47A	case 529
		dec	eax
		jz	short loc_1001D4A7 ; jumptable 1001D47A	case 545

loc_1001D4A4:				; CODE XREF: sub_1001D460+11j
					; sub_1001D460+1Aj
					; DATA XREF: ...
		xor	eax, eax	; jumptable 1001D47A default case
		retn
; ---------------------------------------------------------------------------

loc_1001D4A7:				; CODE XREF: sub_1001D460+1Aj
					; sub_1001D460+42j
					; DATA XREF: ...
		mov	eax, 3		; jumptable 1001D47A case 545
		retn
; ---------------------------------------------------------------------------

loc_1001D4AD:				; CODE XREF: sub_1001D460+1Aj
					; sub_1001D460+3Fj
					; DATA XREF: ...
		mov	eax, 2		; jumptable 1001D47A case 529
		retn
; ---------------------------------------------------------------------------

loc_1001D4B3:				; CODE XREF: sub_1001D460+38j
		mov	eax, 6
		retn
sub_1001D460	endp

; ---------------------------------------------------------------------------
		align 4
off_1001D4BC	dd offset loc_1001D4AD,	offset loc_1001D4A7, offset loc_1001D487
					; DATA XREF: sub_1001D460+1Ar
		dd offset loc_1001D481,	offset loc_1001D4A4 ; jump table for switch statement
byte_1001D4D0	db	0,     4,     4,     4 ; DATA XREF: sub_1001D460+13r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	1,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	2,     4,     4,     4
		db	4,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D520	proc near		; CODE XREF: sub_1001D620+18p
					; sub_1001D670+29p

Dst		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [esp+44h+arg_0]
		cmp	dword ptr [eax+8], 10h
		push	ebx
		mov	ebx, [eax+4]
		jz	short loc_1001D54E
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1001D54E:				; CODE XREF: sub_1001D520+1Aj
		mov	eax, [ebx]
		push	ebp
		call	sub_1001D460
		mov	ebp, eax
		test	ebp, ebp
		jnz	short loc_1001D56D
		pop	ebp
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1001D56D:				; CODE XREF: sub_1001D520+3Aj
		push	esi
		push	11h
		push	ecx
		call	sub_10016660
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1001D591
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1001D591:				; CODE XREF: sub_1001D520+5Dj
		push	edi
		mov	edi, [esi+1Ch]
		cmp	edi, 40h
		jbe	short loc_1001D5B8
		push	esi
		call	sub_10015D70
		add	esp, 4

loc_1001D5A3:				; CODE XREF: sub_1001D520+BEj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1001D5B8:				; CODE XREF: sub_1001D520+78j
		mov	eax, [esi+18h]
		push	edi		; Size
		push	eax		; Src
		lea	ecx, [esp+5Ch+Dst]
		push	ecx		; Dst
		call	memcpy
		push	esi
		call	sub_10015D70
		push	0DCh
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1001D5A3
		push	edi		; Size
		lea	edx, [esp+58h+Dst]
		push	edx		; Src
		lea	eax, [esi+44h]
		push	eax		; Dst
		call	memcpy
		push	ebp
		mov	[esi+88h], edi
		call	sub_10022040
		add	esp, 10h
		mov	[esi], eax
		mov	ecx, [ebx+4]
		pop	edi
		mov	[esi+8Ch], ecx
		mov	ecx, [esp+50h+var_4]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
sub_1001D520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D620	proc near		; CODE XREF: sub_10012FD0+7A0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	edi
		mov	edi, [eax+4]
		cmp	dword ptr [edi+0Ch], 4Bh
		jbe	short loc_1001D632
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001D632:				; CODE XREF: sub_1001D620+Cj
		mov	ecx, [esp+4+arg_4]
		push	esi
		push	eax
		call	sub_1001D520
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001D649
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001D649:				; CODE XREF: sub_1001D620+24j
		mov	eax, [edi+0Ch]
		mov	[esi+84h], eax
		mov	ecx, [edi+0Ch]
		mov	edx, [edi+8]
		push	ecx		; Size
		push	edx		; Src
		lea	eax, [esi+90h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		pop	edi
		retn
sub_1001D620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D670	proc near		; CODE XREF: sub_10012FD0+817p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		push	ebx
		push	edi
		mov	edi, [ecx+4]
		mov	eax, [edi]
		mov	ebx, 28h
		cmp	eax, 380h
		jz	short loc_1001D693
		cmp	eax, 381h
		jz	short loc_1001D693
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D693:				; CODE XREF: sub_1001D670+15j
					; sub_1001D670+1Cj
		push	esi
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		call	sub_1001D520
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1001D6D5
		cmp	dword ptr [edi], 380h
		jnz	short loc_1001D6B4
		mov	ebx, 30h

loc_1001D6B4:				; CODE XREF: sub_1001D670+3Dj
		mov	ecx, [edi+0Ch]
		mov	eax, [esi+88h]
		add	ecx, eax
		add	ecx, ebx
		mov	[esi+84h], ecx
		cmp	ecx, 4Bh
		jbe	short loc_1001D6DB
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1001D6D5:				; CODE XREF: sub_1001D670+35j
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D6DB:				; CODE XREF: sub_1001D670+5Aj
		push	ebp
		push	eax		; Size
		lea	edx, [esi+44h]
		push	edx		; Src
		lea	eax, [esi+90h]
		push	eax		; Dst
		call	memcpy
		mov	ebp, [esi+88h]
		push	ebx		; Size
		add	ebp, esi
		lea	ecx, [ebp+90h]
		push	36h		; Val
		push	ecx		; Dst
		call	memset
		mov	edx, [edi+0Ch]
		mov	eax, [edi+8]
		push	edx		; Size
		push	eax		; Src
		lea	ecx, [ebx+ebp+90h]
		push	ecx		; Dst
		call	memcpy
		add	esp, 24h
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_1001D670	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001D730:				; DATA XREF: sub_10012FD0+7DEo
		mov	eax, [esp+4]
		mov	ecx, [eax+8Ch]
		mov	edx, [esp+0Ch]
		push	ecx
		mov	ecx, [esp+0Ch]
		push	edx
		mov	edx, [eax+84h]
		push	ecx
		push	edx
		mov	edx, [eax+88h]
		lea	ecx, [eax+90h]
		push	ecx
		push	edx
		mov	edx, [eax]
		lea	ecx, [eax+44h]
		push	ecx
		push	edx
		push	40h
		add	eax, 4
		push	0
		push	eax
		call	sub_100226A0
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1001D780:				; DATA XREF: sub_10012FD0+848o
		mov	eax, [esp+4]
		mov	ecx, [eax+8Ch]
		mov	edx, [esp+0Ch]
		push	ecx
		mov	ecx, [esp+0Ch]
		push	edx
		mov	edx, [eax+84h]
		push	ecx
		push	edx
		mov	edx, [eax+88h]
		lea	ecx, [eax+90h]
		push	ecx
		push	edx
		mov	edx, [eax]
		lea	ecx, [eax+44h]
		push	ecx
		push	edx
		push	40h
		add	eax, 4
		push	0
		push	eax
		call	sub_10022660
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1001D7D0:				; DATA XREF: sub_10012FD0+864o
		mov	eax, [esp+4]
		mov	ecx, [eax]
		push	esi
		mov	esi, [ecx]
		mov	ecx, [esp+14h]
		cmp	esi, ecx
		jbe	short loc_1001D7E3
		mov	esi, ecx

loc_1001D7E3:				; CODE XREF: .text:1001D7DFj
		mov	edx, [esp+0Ch]
		push	esi
		add	eax, 4
		push	eax
		push	edx
		call	memcpy
		mov	eax, [esp+1Ch]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001D7FF
		mov	[eax], esi

loc_1001D7FF:				; CODE XREF: .text:1001D7FBj
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1001D810:				; DATA XREF: sub_1000C4C0+1E1o
					; sub_1000DE90+C9o ...
		mov	eax, [esp+4]
		push	eax
		call	PORT_Free_Util
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D820	proc near		; CODE XREF: sub_1001D920+339p
		push	edi
		push	offset aReadonly ; "readOnly"
		push	offset aFlags_0	; "flags"
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aNocertdb ; "noCertDB"
		push	offset aFlags_0	; "flags"
		mov	[esi+30h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aNokeydb	; "noKeyDB"
		push	offset aFlags_0	; "flags"
		mov	[esi+34h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aForceopen ; "forceOpen"
		push	offset aFlags_0	; "flags"
		mov	[esi+38h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aPasswordrequir ; "passwordRequired"
		push	offset aFlags_0	; "flags"
		mov	[esi+3Ch], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aOptimizespace ;	"optimizeSpace"
		push	offset aFlags_0	; "flags"
		mov	[esi+40h], eax
		call	NSSUTIL_ArgHasFlag
		add	esp, 48h
		mov	[esi+44h], eax
		retn
sub_1001D820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D8A0	proc near		; CODE XREF: sub_1001DDF0+4D6p
		push	edi
		push	offset aNomoddb	; "noModDB"
		push	offset aFlags_0	; "flags"
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aReadonly ; "readOnly"
		push	offset aFlags_0	; "flags"
		mov	[esi+1Ch], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aNocertdb ; "noCertDB"
		push	offset aFlags_0	; "flags"
		mov	[esi+18h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aForceopen ; "forceOpen"
		push	offset aFlags_0	; "flags"
		mov	[esi+20h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aPasswordrequir ; "passwordRequired"
		push	offset aFlags_0	; "flags"
		mov	[esi+24h], eax
		call	NSSUTIL_ArgHasFlag
		push	edi
		push	offset aOptimizespace ;	"optimizeSpace"
		push	offset aFlags_0	; "flags"
		mov	[esi+28h], eax
		call	NSSUTIL_ArgHasFlag
		add	esp, 48h
		mov	[esi+2Ch], eax
		retn
sub_1001D8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D920	proc near		; CODE XREF: sub_1001DCA0+F1p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		push	edi
		mov	esi, eax
		xor	ebp, ebp
		call	NSSUTIL_ArgStrip
		mov	ebx, eax
		add	esp, 4
		cmp	byte ptr [ebx],	0
		jz	loc_1001DC8A
		nop

loc_1001D940:				; CODE XREF: sub_1001D920+364j
		push	0Ah
		push	offset aConfigdir ; "configDir="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001D981
		mov	eax, [esi+4]
		add	ebx, 0Ah
		test	eax, eax
		jz	short loc_1001D967
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001D967:				; CODE XREF: sub_1001D920+3Cj
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+4], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001D981:				; CODE XREF: sub_1001D920+32j
		push	0Ah
		push	offset aUpdatedir ; "updateDir="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001D9C2
		mov	eax, [esi+10h]
		add	ebx, 0Ah
		test	eax, eax
		jz	short loc_1001D9A8
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001D9A8:				; CODE XREF: sub_1001D920+7Dj
		lea	ecx, [esp+14h+var_4]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+10h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001D9C2:				; CODE XREF: sub_1001D920+73j
		push	11h
		push	offset aUpdatecertpref ; "updateCertPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DA03
		mov	eax, [esi+14h]
		add	ebx, 11h
		test	eax, eax
		jz	short loc_1001D9E9
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001D9E9:				; CODE XREF: sub_1001D920+BEj
		lea	edx, [esp+14h+var_4]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+14h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DA03:				; CODE XREF: sub_1001D920+B4j
		push	10h
		push	offset aUpdatekeyprefi ; "updateKeyPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DA44
		mov	eax, [esi+18h]
		add	ebx, 10h
		test	eax, eax
		jz	short loc_1001DA2A
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DA2A:				; CODE XREF: sub_1001D920+FFj
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+18h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DA44:				; CODE XREF: sub_1001D920+F5j
		push	9
		push	offset aUpdateid ; "updateID="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DA85
		mov	eax, [esi+1Ch]
		add	ebx, 9
		test	eax, eax
		jz	short loc_1001DA6B
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DA6B:				; CODE XREF: sub_1001D920+140j
		lea	ecx, [esp+14h+var_4]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+1Ch], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DA85:				; CODE XREF: sub_1001D920+136j
		push	0Bh
		push	offset aCertprefix ; "certPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DAC6
		mov	eax, [esi+8]
		add	ebx, 0Bh
		test	eax, eax
		jz	short loc_1001DAAC
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DAAC:				; CODE XREF: sub_1001D920+181j
		lea	edx, [esp+14h+var_4]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+8], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DAC6:				; CODE XREF: sub_1001D920+177j
		push	0Ah
		push	offset aKeyprefix ; "keyPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DB07
		mov	eax, [esi+0Ch]
		add	ebx, 0Ah
		test	eax, eax
		jz	short loc_1001DAED
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DAED:				; CODE XREF: sub_1001D920+1C2j
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+0Ch], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DB07:				; CODE XREF: sub_1001D920+1B8j
		push	11h
		push	offset aTokendescripti ; "tokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DB48
		mov	eax, [esi+20h]
		add	ebx, 11h
		test	eax, eax
		jz	short loc_1001DB2E
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DB2E:				; CODE XREF: sub_1001D920+203j
		lea	ecx, [esp+14h+var_4]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+20h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DB48:				; CODE XREF: sub_1001D920+1F9j
		push	17h
		push	offset aUpdatetokendes ; "updateTokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DB89
		mov	eax, [esi+28h]
		add	ebx, 17h
		test	eax, eax
		jz	short loc_1001DB6F
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DB6F:				; CODE XREF: sub_1001D920+244j
		lea	edx, [esp+14h+var_4]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+28h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DB89:				; CODE XREF: sub_1001D920+23Aj
		push	10h
		push	offset aSlotdescriptio ; "slotDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DBCA
		mov	eax, [esi+24h]
		add	ebx, 10h
		test	eax, eax
		jz	short loc_1001DBB0
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DBB0:				; CODE XREF: sub_1001D920+285j
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+14h+var_4]
		mov	[esi+24h], eax
		jmp	loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DBCA:				; CODE XREF: sub_1001D920+27Bj
		push	9
		push	offset aMinpwlen ; "minPWLen="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DC1D
		add	ebx, 9
		test	ebp, ebp
		jz	short loc_1001DBEE
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_1001DBEE:				; CODE XREF: sub_1001D920+2C3j
		lea	ecx, [esp+14h+var_4]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	ebx, [esp+1Ch+var_4]
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_1001DC76
		push	ebp		; Str
		call	ds:atoi
		push	ebp
		mov	[esi+2Ch], eax
		call	PORT_Free_Util
		add	esp, 8
		xor	ebp, ebp
		jmp	short loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DC1D:				; CODE XREF: sub_1001D920+2BCj
		push	6
		push	offset aFlags	; "flags="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DC6B
		add	ebx, 6
		test	ebp, ebp
		jz	short loc_1001DC41
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_1001DC41:				; CODE XREF: sub_1001D920+316j
		lea	edx, [esp+14h+var_4]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	ebx, [esp+1Ch+var_4]
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_1001DC76
		call	sub_1001D820
		push	ebp
		call	PORT_Free_Util
		add	esp, 4
		xor	ebp, ebp
		jmp	short loc_1001DC76
; ---------------------------------------------------------------------------

loc_1001DC6B:				; CODE XREF: sub_1001D920+30Fj
		push	ebx
		call	NSSUTIL_ArgSkipParameter
		add	esp, 4
		mov	ebx, eax

loc_1001DC76:				; CODE XREF: sub_1001D920+5Cj
					; sub_1001D920+9Dj ...
		push	ebx
		call	NSSUTIL_ArgStrip
		mov	ebx, eax
		add	esp, 4
		cmp	byte ptr [ebx],	0
		jnz	loc_1001D940

loc_1001DC8A:				; CODE XREF: sub_1001D920+19j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_1001D920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DCA0	proc near		; CODE XREF: sub_1001DDF0+534p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	esi
		mov	esi, eax
		xor	ebx, ebx
		mov	[esp+1Ch+var_C], ebx
		test	esi, esi
		jz	loc_1001DDDF
		cmp	[esi], bl
		jz	loc_1001DDDF
		push	esi
		call	NSSUTIL_ArgStrip
		add	esp, 4
		cmp	[eax], bl
		jz	short loc_1001DCE9
		lea	ebx, [ebx+0]

loc_1001DCD0:				; CODE XREF: sub_1001DCA0+43j
		push	eax
		inc	ebx
		call	NSSUTIL_ArgSkipParameter
		push	eax
		call	NSSUTIL_ArgStrip
		add	esp, 8
		cmp	byte ptr [eax],	0
		jnz	short loc_1001DCD0
		mov	[esp+1Ch+var_C], ebx

loc_1001DCE9:				; CODE XREF: sub_1001DCA0+28j
		lea	eax, [ebx+ebx*8]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		push	edi
		push	eax
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		mov	[esp+20h+var_4], edi
		test	edi, edi
		jz	loc_1001DDDE
		push	esi
		call	NSSUTIL_ArgStrip
		mov	esi, eax
		add	esp, 4
		cmp	byte ptr [esi],	0
		mov	[esp+20h+var_14], 0
		jz	loc_1001DDCC
		push	ebp
		add	edi, 34h
		jmp	short loc_1001DD34
; ---------------------------------------------------------------------------
		align 10h

loc_1001DD30:				; CODE XREF: sub_1001DCA0+125j
		mov	ebx, [esp+24h+var_C]

loc_1001DD34:				; CODE XREF: sub_1001DCA0+8Aj
		cmp	[esp+24h+var_14], ebx
		jge	loc_1001DDCB
		lea	ecx, [esp+24h+var_10]
		push	ecx
		push	esi
		call	NSSUTIL_ArgGetLabel
		add	esi, [esp+2Ch+var_10]
		mov	ebp, eax
		push	ebp
		call	NSSUTIL_ArgDecodeNumber
		mov	[edi-34h], eax
		xor	eax, eax
		mov	[edi-4], eax
		mov	[edi], eax
		mov	[edi+4], eax
		movzx	edx, byte ptr [esi]
		push	edx
		call	NSSUTIL_ArgIsBlank
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001DDA3
		lea	eax, [esp+24h+var_10]
		push	eax
		push	esi
		call	NSSUTIL_ArgFetchValue
		add	esi, [esp+2Ch+var_10]
		mov	ecx, eax
		add	esp, 8
		mov	[esp+24h+var_8], ecx
		test	ecx, ecx
		jz	short loc_1001DDA3
		lea	eax, [edi-34h]
		call	sub_1001D920
		mov	ecx, [esp+24h+var_8]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001DDA3:				; CODE XREF: sub_1001DCA0+D0j
					; sub_1001DCA0+ECj
		test	ebp, ebp
		jz	short loc_1001DDB0
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_1001DDB0:				; CODE XREF: sub_1001DCA0+105j
		push	esi
		call	NSSUTIL_ArgStrip
		inc	[esp+28h+var_14]
		mov	esi, eax
		add	esp, 4
		add	edi, 48h
		cmp	byte ptr [esi],	0
		jnz	loc_1001DD30

loc_1001DDCB:				; CODE XREF: sub_1001DCA0+98j
		pop	ebp

loc_1001DDCC:				; CODE XREF: sub_1001DCA0+80j
		mov	eax, [esp+20h+arg_0]
		mov	edx, [esp+20h+var_14]
		mov	ecx, [esp+20h+var_4]
		mov	[eax+34h], edx
		mov	[eax+30h], ecx

loc_1001DDDE:				; CODE XREF: sub_1001DCA0+64j
		pop	edi

loc_1001DDDF:				; CODE XREF: sub_1001DCA0+Fj
					; sub_1001DCA0+17j
		pop	esi
		pop	ebx
		add	esp, 14h
		retn
sub_1001DCA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001DDF0(int,	void *Dst, int)
sub_1001DDF0	proc near		; CODE XREF: sub_1000B0B0+B9p
					; sub_1000B680+63p

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Str		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	eax, [esp+2Ch+arg_0]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		xor	edi, edi
		push	eax
		mov	[esp+40h+var_4], edi
		mov	[esp+40h+var_18], esi
		mov	[esp+40h+var_14], esi
		mov	[esp+40h+var_10], esi
		mov	[esp+40h+var_28], esi
		mov	[esp+40h+var_C], esi
		mov	[esp+40h+var_8], esi
		mov	[esp+40h+var_24], esi
		mov	[esp+40h+var_20], esi
		mov	[esp+40h+Str], esi
		call	NSSUTIL_ArgStrip
		mov	ebp, [esp+40h+Dst]
		push	38h		; Size
		push	esi		; Val
		push	ebp		; Dst
		mov	ebx, eax
		call	memset
		add	esp, 10h
		cmp	byte ptr [ebx],	0
		jz	loc_1001E355

loc_1001DE48:				; CODE XREF: sub_1001DDF0+55Fj
		push	0Ah
		push	offset aConfigdir ; "configDir="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DE89
		mov	eax, [ebp+0]
		add	ebx, 0Ah
		test	eax, eax
		jz	short loc_1001DE6F
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DE6F:				; CODE XREF: sub_1001DDF0+74j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+0], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DE89:				; CODE XREF: sub_1001DDF0+6Aj
		push	0Ah
		push	offset aUpdatedir ; "updateDir="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DECA
		mov	eax, [ebp+4]
		add	ebx, 0Ah
		test	eax, eax
		jz	short loc_1001DEB0
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DEB0:				; CODE XREF: sub_1001DDF0+B5j
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+4], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DECA:				; CODE XREF: sub_1001DDF0+ABj
		push	9
		push	offset aUpdateid ; "updateID="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DF0B
		mov	eax, [ebp+8]
		add	ebx, 9
		test	eax, eax
		jz	short loc_1001DEF1
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DEF1:				; CODE XREF: sub_1001DDF0+F6j
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+8], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DF0B:				; CODE XREF: sub_1001DDF0+ECj
		push	7
		push	offset aSecmod	; "secmod="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DF4C
		mov	eax, [ebp+0Ch]
		add	ebx, 7
		test	eax, eax
		jz	short loc_1001DF32
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DF32:				; CODE XREF: sub_1001DDF0+137j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+0Ch], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DF4C:				; CODE XREF: sub_1001DDF0+12Dj
		push	0Fh
		push	offset aManufacturerid ; "manufacturerID="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DF8D
		mov	eax, [ebp+10h]
		add	ebx, 0Fh
		test	eax, eax
		jz	short loc_1001DF73
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DF73:				; CODE XREF: sub_1001DDF0+178j
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+10h], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DF8D:				; CODE XREF: sub_1001DDF0+16Ej
		push	13h
		push	offset aLibrarydescrip ; "libraryDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001DFCE
		mov	eax, [ebp+14h]
		add	ebx, 13h
		test	eax, eax
		jz	short loc_1001DFB4
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001DFB4:				; CODE XREF: sub_1001DDF0+1B9j
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[ebp+14h], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001DFCE:				; CODE XREF: sub_1001DDF0+1AFj
		push	0Bh
		push	offset aCertprefix ; "certPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E00F
		add	ebx, 0Bh
		test	edi, edi
		jz	short loc_1001DFF2
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_1001DFF2:				; CODE XREF: sub_1001DDF0+1F7j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		mov	edi, eax
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_4], edi
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E00F:				; CODE XREF: sub_1001DDF0+1F0j
		push	0Ah
		push	offset aKeyprefix ; "keyPrefix="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E054
		add	ebx, 0Ah
		cmp	[esp+3Ch+var_18], eax
		jz	short loc_1001E039
		mov	edx, [esp+3Ch+var_18]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E039:				; CODE XREF: sub_1001DDF0+23Aj
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_18], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E054:				; CODE XREF: sub_1001DDF0+231j
		push	17h
		push	offset aCryptotokendes ; "cryptoTokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E099
		add	ebx, 17h
		cmp	[esp+3Ch+var_14], eax
		jz	short loc_1001E07E
		mov	ecx, [esp+3Ch+var_14]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E07E:				; CODE XREF: sub_1001DDF0+27Fj
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_14], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E099:				; CODE XREF: sub_1001DDF0+276j
		push	13h
		push	offset aDbtokendescrip ; "dbTokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E0DE
		add	ebx, 13h
		cmp	[esp+3Ch+var_10], eax
		jz	short loc_1001E0C3
		mov	eax, [esp+3Ch+var_10]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E0C3:				; CODE XREF: sub_1001DDF0+2C4j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_10], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E0DE:				; CODE XREF: sub_1001DDF0+2BBj
		push	16h
		push	offset aCryptoslotdesc ; "cryptoSlotDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E123
		add	ebx, 16h
		cmp	[esp+3Ch+var_C], eax
		jz	short loc_1001E108
		mov	edx, [esp+3Ch+var_C]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E108:				; CODE XREF: sub_1001DDF0+309j
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_C], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E123:				; CODE XREF: sub_1001DDF0+300j
		push	12h
		push	offset aDbslotdescript ; "dbSlotDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E168
		add	ebx, 12h
		cmp	[esp+3Ch+var_8], eax
		jz	short loc_1001E14D
		mov	ecx, [esp+3Ch+var_8]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E14D:				; CODE XREF: sub_1001DDF0+34Ej
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_8], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E168:				; CODE XREF: sub_1001DDF0+345j
		push	14h
		push	offset aFipsslotdescri ; "FIPSSlotDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E1AD
		add	ebx, 14h
		cmp	[esp+3Ch+var_24], eax
		jz	short loc_1001E192
		mov	eax, [esp+3Ch+var_24]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E192:				; CODE XREF: sub_1001DDF0+393j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_24], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E1AD:				; CODE XREF: sub_1001DDF0+38Aj
		push	15h
		push	offset aFipstokendescr ; "FIPSTokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E1F2
		add	ebx, 15h
		cmp	[esp+3Ch+var_20], eax
		jz	short loc_1001E1D7
		mov	edx, [esp+3Ch+var_20]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E1D7:				; CODE XREF: sub_1001DDF0+3D8j
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_20], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E1F2:				; CODE XREF: sub_1001DDF0+3CFj
		push	17h
		push	offset aUpdatetokendes ; "updateTokenDescription="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E237
		add	ebx, 17h
		cmp	[esp+3Ch+var_28], eax
		jz	short loc_1001E21C
		mov	ecx, [esp+3Ch+var_28]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001E21C:				; CODE XREF: sub_1001DDF0+41Dj
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+var_28], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E237:				; CODE XREF: sub_1001DDF0+414j
		push	9
		push	offset aMinpwlen ; "minPWLen="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E27C
		add	ebx, 9
		cmp	[esp+3Ch+Str], eax
		jz	short loc_1001E261
		mov	eax, [esp+3Ch+Str]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E261:				; CODE XREF: sub_1001DDF0+462j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	esp, 8
		add	ebx, [esp+3Ch+var_2C]
		mov	[esp+3Ch+Str], eax
		jmp	loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E27C:				; CODE XREF: sub_1001DDF0+459j
		push	6
		push	offset aFlags	; "flags="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E2E7
		add	ebx, 6
		test	esi, esi
		jz	short loc_1001E2A0
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1001E2A0:				; CODE XREF: sub_1001DDF0+4A5j
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	ebx, [esp+44h+var_2C]
		mov	esi, eax
		add	esp, 8
		mov	[esp+3Ch+Dst], esi
		test	esi, esi
		jz	loc_1001E341
		mov	edi, [esp+3Ch+arg_0]
		mov	esi, ebp
		call	sub_1001D8A0
		mov	eax, [esp+3Ch+Dst]
		push	eax
		call	PORT_Free_Util
		mov	edi, [esp+40h+var_4]
		mov	[esp+40h+Dst], 0
		mov	esi, [esp+40h+Dst]
		jmp	short loc_1001E33E
; ---------------------------------------------------------------------------

loc_1001E2E7:				; CODE XREF: sub_1001DDF0+49Ej
		push	7
		push	offset aTokens	; "tokens="
		push	ebx
		call	PL_strncasecmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001E336
		add	ebx, 7
		test	esi, esi
		jz	short loc_1001E30B
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1001E30B:				; CODE XREF: sub_1001DDF0+510j
		lea	ecx, [esp+3Ch+var_2C]
		push	ecx
		push	ebx
		call	NSSUTIL_ArgFetchValue
		add	ebx, [esp+44h+var_2C]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001E341
		push	ebp
		call	sub_1001DCA0
		push	esi
		call	PORT_Free_Util
		add	esp, 8
		xor	esi, esi
		jmp	short loc_1001E341
; ---------------------------------------------------------------------------

loc_1001E336:				; CODE XREF: sub_1001DDF0+509j
		push	ebx
		call	NSSUTIL_ArgSkipParameter
		mov	ebx, eax

loc_1001E33E:				; CODE XREF: sub_1001DDF0+4F5j
		add	esp, 4

loc_1001E341:				; CODE XREF: sub_1001DDF0+94j
					; sub_1001DDF0+D5j ...
		push	ebx
		call	NSSUTIL_ArgStrip
		mov	ebx, eax
		add	esp, 4
		cmp	byte ptr [ebx],	0
		jnz	loc_1001DE48

loc_1001E355:				; CODE XREF: sub_1001DDF0+52j
		cmp	dword ptr [ebp+30h], 0
		jnz	loc_1001E44E
		mov	esi, [esp+3Ch+arg_8]
		mov	edi, esi
		neg	edi
		sbb	edi, edi
		add	edi, 2
		lea	edx, [edi+edi*8]
		add	edx, edx
		add	edx, edx
		add	edx, edx
		push	edx
		call	PORT_ZAlloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_1001E44A
		xor	edx, edx
		xor	ecx, ecx
		cmp	esi, ecx
		setnz	dl
		mov	[ebp+34h], edi
		lea	eax, [edi+edi*8-9]
		lea	edi, [ebx+eax*8]
		mov	eax, [esp+3Ch+var_4]
		mov	[ebp+30h], ebx
		mov	[edi+8], eax
		add	edx, 2
		mov	[edi], edx
		mov	edx, [esp+3Ch+var_18]
		mov	[edi+0Ch], edx
		cmp	[esp+3Ch+Str], ecx
		jz	short loc_1001E3C9
		mov	eax, [esp+3Ch+Str]
		push	eax		; Str
		call	ds:atoi
		add	esp, 4
		xor	ecx, ecx
		jmp	short loc_1001E3CB
; ---------------------------------------------------------------------------

loc_1001E3C9:				; CODE XREF: sub_1001DDF0+5C5j
		xor	eax, eax

loc_1001E3CB:				; CODE XREF: sub_1001DDF0+5D7j
		mov	[edi+2Ch], eax
		mov	edx, [ebp+18h]
		mov	[edi+30h], edx
		mov	eax, [ebp+20h]
		mov	[edi+34h], eax
		mov	edx, [ebp+20h]
		mov	[edi+38h], edx
		mov	eax, [ebp+24h]
		mov	[edi+3Ch], eax
		mov	edx, [ebp+28h]
		mov	[edi+40h], edx
		mov	eax, [ebp+2Ch]
		mov	[edi+44h], eax
		mov	edx, [ebp+2Ch]
		mov	[ebx+44h], edx
		mov	edx, [esp+3Ch+var_28]
		mov	[edi+28h], edx
		cmp	esi, ecx
		jz	short loc_1001E41F
		mov	eax, [esp+3Ch+var_20]
		mov	[edi+20h], eax
		mov	eax, [esp+3Ch+var_24]
		mov	[edi+24h], eax
		mov	[esp+3Ch+var_24], ecx
		mov	[esp+3Ch+var_20], ecx
		mov	[esp+3Ch+var_28], ecx
		jmp	short loc_1001E46C
; ---------------------------------------------------------------------------

loc_1001E41F:				; CODE XREF: sub_1001DDF0+611j
		mov	ecx, [esp+3Ch+var_10]
		mov	eax, [esp+3Ch+var_8]
		mov	edx, [esp+3Ch+var_C]
		mov	[edi+20h], ecx
		mov	ecx, [esp+3Ch+var_14]
		mov	[edi+24h], eax
		mov	eax, 1
		mov	[ebx], eax
		mov	[ebx+20h], ecx
		mov	[ebx+24h], edx
		mov	[ebx+34h], eax
		mov	[ebx+38h], eax
		jmp	short loc_1001E4C1
; ---------------------------------------------------------------------------

loc_1001E44A:				; CODE XREF: sub_1001DDF0+592j
		mov	edi, [esp+3Ch+var_4]

loc_1001E44E:				; CODE XREF: sub_1001DDF0+569j
		test	edi, edi
		jz	short loc_1001E45B
		push	edi
		call	PORT_Free_Util
		add	esp, 4

loc_1001E45B:				; CODE XREF: sub_1001DDF0+660j
		mov	eax, [esp+3Ch+var_18]
		test	eax, eax
		jz	short loc_1001E46C
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E46C:				; CODE XREF: sub_1001DDF0+62Dj
					; sub_1001DDF0+671j
		mov	eax, [esp+3Ch+var_14]
		test	eax, eax
		jz	short loc_1001E47D
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E47D:				; CODE XREF: sub_1001DDF0+682j
		mov	eax, [esp+3Ch+var_10]
		test	eax, eax
		jz	short loc_1001E48E
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E48E:				; CODE XREF: sub_1001DDF0+693j
		mov	eax, [esp+3Ch+var_28]
		test	eax, eax
		jz	short loc_1001E49F
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E49F:				; CODE XREF: sub_1001DDF0+6A4j
		mov	eax, [esp+3Ch+var_C]
		test	eax, eax
		jz	short loc_1001E4B0
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E4B0:				; CODE XREF: sub_1001DDF0+6B5j
		mov	eax, [esp+3Ch+var_8]
		test	eax, eax
		jz	short loc_1001E4C1
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E4C1:				; CODE XREF: sub_1001DDF0+658j
					; sub_1001DDF0+6C6j
		mov	eax, [esp+3Ch+var_24]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		test	eax, eax
		jz	short loc_1001E4D6
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E4D6:				; CODE XREF: sub_1001DDF0+6DBj
		mov	eax, [esp+2Ch+var_20]
		test	eax, eax
		jz	short loc_1001E4E7
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E4E7:				; CODE XREF: sub_1001DDF0+6ECj
		mov	eax, [esp+2Ch+Str]
		test	eax, eax
		jz	short loc_1001E4F8
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001E4F8:				; CODE XREF: sub_1001DDF0+6FDj
		xor	eax, eax
		add	esp, 2Ch
		retn
sub_1001DDF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E500	proc near		; CODE XREF: sub_1000B0B0+176p
					; sub_1000B680+162p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	ebx, ebx
		xor	ebp, ebp
		cmp	[esi+34h], ebx
		jle	loc_1001E633
		push	edi
		xor	edi, edi

loc_1001E517:				; CODE XREF: sub_1001E500+12Cj
		mov	eax, [esi+30h]
		mov	eax, [edi+eax+4]
		cmp	eax, ebx
		jz	short loc_1001E532
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esi+30h]
		add	esp, 4
		mov	[edi+ecx+4], ebx

loc_1001E532:				; CODE XREF: sub_1001E500+20j
		mov	edx, [esi+30h]
		mov	eax, [edi+edx+8]
		cmp	eax, ebx
		jz	short loc_1001E54D
		push	eax
		call	PORT_Free_Util
		mov	eax, [esi+30h]
		add	esp, 4
		mov	[edi+eax+8], ebx

loc_1001E54D:				; CODE XREF: sub_1001E500+3Bj
		mov	ecx, [esi+30h]
		mov	eax, [edi+ecx+0Ch]
		cmp	eax, ebx
		jz	short loc_1001E568
		push	eax
		call	PORT_Free_Util
		mov	edx, [esi+30h]
		add	esp, 4
		mov	[edi+edx+0Ch], ebx

loc_1001E568:				; CODE XREF: sub_1001E500+56j
		mov	eax, [esi+30h]
		mov	eax, [edi+eax+20h]
		cmp	eax, ebx
		jz	short loc_1001E583
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esi+30h]
		add	esp, 4
		mov	[edi+ecx+20h], ebx

loc_1001E583:				; CODE XREF: sub_1001E500+71j
		mov	edx, [esi+30h]
		mov	eax, [edi+edx+24h]
		cmp	eax, ebx
		jz	short loc_1001E59E
		push	eax
		call	PORT_Free_Util
		mov	eax, [esi+30h]
		add	esp, 4
		mov	[edi+eax+24h], ebx

loc_1001E59E:				; CODE XREF: sub_1001E500+8Cj
		mov	ecx, [esi+30h]
		mov	eax, [edi+ecx+10h]
		cmp	eax, ebx
		jz	short loc_1001E5B9
		push	eax
		call	PORT_Free_Util
		mov	edx, [esi+30h]
		add	esp, 4
		mov	[edi+edx+10h], ebx

loc_1001E5B9:				; CODE XREF: sub_1001E500+A7j
		mov	eax, [esi+30h]
		mov	eax, [edi+eax+14h]
		cmp	eax, ebx
		jz	short loc_1001E5D4
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esi+30h]
		add	esp, 4
		mov	[edi+ecx+14h], ebx

loc_1001E5D4:				; CODE XREF: sub_1001E500+C2j
		mov	edx, [esi+30h]
		mov	eax, [edi+edx+18h]
		cmp	eax, ebx
		jz	short loc_1001E5EF
		push	eax
		call	PORT_Free_Util
		mov	eax, [esi+30h]
		add	esp, 4
		mov	[edi+eax+18h], ebx

loc_1001E5EF:				; CODE XREF: sub_1001E500+DDj
		mov	ecx, [esi+30h]
		mov	eax, [edi+ecx+1Ch]
		cmp	eax, ebx
		jz	short loc_1001E60A
		push	eax
		call	PORT_Free_Util
		mov	edx, [esi+30h]
		add	esp, 4
		mov	[edi+edx+1Ch], ebx

loc_1001E60A:				; CODE XREF: sub_1001E500+F8j
		mov	eax, [esi+30h]
		mov	eax, [edi+eax+28h]
		cmp	eax, ebx
		jz	short loc_1001E625
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esi+30h]
		add	esp, 4
		mov	[edi+ecx+28h], ebx

loc_1001E625:				; CODE XREF: sub_1001E500+113j
		inc	ebp
		add	edi, 48h
		cmp	ebp, [esi+34h]
		jl	loc_1001E517
		pop	edi

loc_1001E633:				; CODE XREF: sub_1001E500+Ej
		mov	eax, [esi]
		cmp	eax, ebx
		jz	short loc_1001E644
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi], ebx

loc_1001E644:				; CODE XREF: sub_1001E500+137j
		mov	eax, [esi+0Ch]
		cmp	eax, ebx
		jz	short loc_1001E657
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+0Ch], ebx

loc_1001E657:				; CODE XREF: sub_1001E500+149j
		mov	eax, [esi+10h]
		cmp	eax, ebx
		jz	short loc_1001E66A
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+10h], ebx

loc_1001E66A:				; CODE XREF: sub_1001E500+15Cj
		mov	eax, [esi+14h]
		cmp	eax, ebx
		jz	short loc_1001E67D
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+14h], ebx

loc_1001E67D:				; CODE XREF: sub_1001E500+16Fj
		mov	eax, [esi+30h]
		cmp	eax, ebx
		jz	short loc_1001E690
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+30h], ebx

loc_1001E690:				; CODE XREF: sub_1001E500+182j
		mov	eax, [esi+4]
		cmp	eax, ebx
		jz	short loc_1001E6A3
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+4], ebx

loc_1001E6A3:				; CODE XREF: sub_1001E500+195j
		mov	eax, [esi+8]
		cmp	eax, ebx
		jz	short loc_1001E6B6
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+8], ebx

loc_1001E6B6:				; CODE XREF: sub_1001E500+1A8j
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001E500	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E6C0	proc near		; CODE XREF: sub_1001EF70+CDp
					; sub_1001F7A0+106p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		push	14h
		mov	edi, eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[edi+4], eax
		test	eax, eax
		jz	short loc_1001E753
		lea	ebx, [edi+8]
		mov	dword ptr [ebx], 14h
		call	sub_10021490
		mov	esi, eax
		test	esi, esi
		jz	short loc_1001E753
		push	esi
		call	sub_100214F0
		add	esp, 4
		test	ebp, ebp
		jz	short loc_1001E711
		mov	eax, [ebp+4]
		test	eax, eax
		jz	short loc_1001E711
		mov	ecx, [ebp+8]
		push	ecx
		push	eax
		push	esi
		call	sub_10021520
		add	esp, 0Ch

loc_1001E711:				; CODE XREF: sub_1001E6C0+3Aj
					; sub_1001E6C0+41j
		mov	ebp, [esp+10h+arg_4]
		mov	eax, ebp
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_1001E720:				; CODE XREF: sub_1001E6C0+65j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001E720
		sub	eax, edx
		push	eax
		push	ebp
		push	esi
		call	sub_10021520
		mov	edx, [ebx]
		mov	eax, [edi+4]
		push	edx
		push	ebx
		push	eax
		push	esi
		call	sub_10021550
		push	1
		push	esi
		xor	edi, edi
		call	sub_100214C0
		add	esp, 24h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001E753:				; CODE XREF: sub_1001E6C0+19j
					; sub_1001E6C0+2Dj
		mov	eax, [edi+4]
		test	eax, eax
		jz	short loc_1001E767
		mov	ecx, [edi+8]
		push	ecx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001E767:				; CODE XREF: sub_1001E6C0+98j
		mov	dword ptr [edi+4], 0
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_1001E6C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E780	proc near		; CODE XREF: sub_1001E8E0+Dp
					; sub_1001EB50+2Bp

var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		push	edi
		push	800h
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1001E803
		mov	eax, [esp+28h+arg_0]
		push	eax
		push	offset dword_10027DD0
		lea	ecx, [esp+30h+var_24]
		push	ecx
		push	edi
		mov	dword ptr [esi], 0
		mov	dword ptr [esi+8], 0
		call	SEC_QuickDERDecodeItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001E7E1
		lea	edx, [esp+28h+var_24]
		push	edx
		call	SECOID_GetAlgorithmTag_Util
		mov	[esi+4], eax
		lea	eax, [esp+2Ch+var_24]
		push	eax
		call	sub_10006940
		add	esp, 8
		mov	[esi+8], eax
		test	eax, eax
		jnz	short loc_1001E80B

loc_1001E7E1:				; CODE XREF: sub_1001E780+3Ej
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_1001E7F8
		push	eax
		call	sub_10006070
		add	esp, 4
		mov	dword ptr [esi+8], 0

loc_1001E7F8:				; CODE XREF: sub_1001E780+66j
		push	0
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1001E803:				; CODE XREF: sub_1001E780+15j
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001E80B:				; CODE XREF: sub_1001E780+5Fj
		mov	ecx, [esp+28h+var_C]
		mov	edx, [esp+28h+var_8]
		mov	eax, [esp+28h+var_4]
		mov	[esi+18h], ecx
		mov	[esi+1Ch], edx
		mov	[esi+20h], eax
		mov	[esi], edi
		xor	eax, eax
		pop	edi
		add	esp, 24h
		retn
sub_1001E780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E830	proc near		; CODE XREF: sub_1001E950+BAp
					; sub_1001EC20+129p

var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		push	edi
		push	800h
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001E84F
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001E84F:				; CODE XREF: sub_1001E830+15j
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edi
		call	sub_100067A0
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_1001E8BC
		push	ebx
		lea	edx, [esp+34h+var_24]
		push	edx
		push	edi
		call	SECOID_CopyAlgorithmID_Util
		push	1
		push	ebx
		mov	ebp, eax
		call	SECOID_DestroyAlgorithmID_Util
		add	esp, 14h
		test	ebp, ebp
		jnz	short loc_1001E8BF
		mov	eax, [esi+18h]
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+20h]
		mov	[esp+30h+var_C], eax
		push	offset dword_10027DD0
		lea	eax, [esp+34h+var_24]
		push	eax
		mov	[esp+38h+var_8], ecx
		mov	ecx, [esp+38h+arg_0]
		push	ebp
		push	ecx
		mov	[esp+40h+var_4], edx
		call	SEC_ASN1EncodeItem_Util
		mov	edx, [esp+40h+arg_4]
		add	esp, 10h
		mov	[edx], eax
		test	eax, eax
		jnz	short loc_1001E8BF

loc_1001E8BC:				; CODE XREF: sub_1001E830+36j
		or	ebp, 0FFFFFFFFh

loc_1001E8BF:				; CODE XREF: sub_1001E830+53j
					; sub_1001E830+8Aj
		push	0
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 24h
		retn
sub_1001E830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E8E0	proc near		; CODE XREF: .text:10004DB3p
					; sub_1001A8C0+176p ...

var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		sub	esp, 24h
		push	esi
		push	eax
		lea	esi, [esp+2Ch+var_24]
		call	sub_1001E780
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001E921
		mov	edx, [esp+28h+arg_0]
		push	eax
		push	eax
		mov	eax, [esp+30h+var_1C]
		lea	ecx, [esp+30h+var_C]
		push	ecx
		push	edx
		push	eax
		call	sub_100065A0
		mov	ecx, [esp+3Ch+arg_8]
		add	esp, 14h
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_1001E921
		or	esi, 0FFFFFFFFh

loc_1001E921:				; CODE XREF: sub_1001E8E0+19j
					; sub_1001E8E0+3Cj
		mov	eax, [esp+28h+var_1C]
		test	eax, eax
		jz	short loc_1001E932
		push	eax
		call	sub_10006070
		add	esp, 4

loc_1001E932:				; CODE XREF: sub_1001E8E0+47j
		mov	eax, [esp+28h+var_24]
		test	eax, eax
		jz	short loc_1001E945
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1001E945:				; CODE XREF: sub_1001E8E0+58j
		mov	eax, esi
		pop	esi
		add	esp, 24h
		retn
sub_1001E8E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E950	proc near		; CODE XREF: .text:10004D30p
					; sub_1001AE90+236p ...

var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [esp+6Ch+arg_C]
		push	ebx
		push	ebp
		mov	ebp, [esp+74h+arg_0]
		push	esi
		mov	esi, [esp+78h+arg_4]
		push	edi
		mov	edi, [esp+7Ch+arg_8]
		lea	ecx, [esp+7Ch+var_44]
		mov	edx, ecx
		push	14h
		push	edx
		mov	[esp+84h+var_6C], eax
		mov	[esp+84h+var_64], 75h
		mov	[esp+84h+var_54], 14h
		mov	[esp+84h+var_58], ecx
		call	sub_10021640
		mov	ecx, [esp+84h+var_64]
		push	1
		lea	eax, [esp+88h+var_5C]
		push	eax
		push	ecx
		call	sub_10005FA0
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jnz	short loc_1001E9CE
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+6Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn
; ---------------------------------------------------------------------------

loc_1001E9CE:				; CODE XREF: sub_1001E950+66j
		push	0
		push	1
		push	edi
		push	esi
		push	ebx
		call	sub_100065A0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_1001E9E8
		or	esi, 0FFFFFFFFh
		jmp	short loc_1001EA1C
; ---------------------------------------------------------------------------

loc_1001E9E8:				; CODE XREF: sub_1001E950+91j
		mov	edx, [edi]
		mov	[esp+7Ch+var_50], edx
		mov	eax, [edi+4]
		mov	edx, [esp+7Ch+var_6C]
		mov	[esp+7Ch+var_4C], eax
		mov	ecx, [edi+8]
		push	edx
		push	ebp
		lea	esi, [esp+84h+var_68]
		mov	[esp+84h+var_48], ecx
		mov	[esp+84h+var_60], ebx
		call	sub_1001E830
		push	1
		push	edi
		mov	esi, eax
		call	SECITEM_FreeItem_Util
		add	esp, 10h

loc_1001EA1C:				; CODE XREF: sub_1001E950+96j
		push	ebx
		call	sub_10006070
		mov	ecx, [esp+80h+var_4]
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn
sub_1001E950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EA40	proc near		; CODE XREF: sub_1001EB50+64p
					; sub_1001EC20+109p

var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 8
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_10]
		push	esi
		mov	esi, eax
		mov	eax, [esi+5Ch]
		push	eax
		or	ebx, 0FFFFFFFFh
		call	sub_10006020
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001EA75
		push	0FFFFE006h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	ebp
		or	eax, ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001EA75:				; CODE XREF: sub_1001EA40+1Dj
		push	eax
		call	sub_10022040
		add	esp, 4
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	loc_1001EB42
		mov	ecx, [esp+14h+arg_0]
		push	edi
		push	0
		push	0
		push	ecx
		push	esi
		call	sub_10005B90
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	loc_1001EB41
		mov	edx, [edi+8]
		mov	eax, [edi+4]
		mov	ecx, [esp+18h+var_4]
		push	1
		push	edx
		push	eax
		push	ecx
		call	sub_100220B0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_1001EB36
		push	esi
		call	sub_100220F0
		mov	edx, [esp+1Ch+arg_4]
		push	edx
		lea	eax, [esp+20h+var_8]
		push	eax
		call	sub_1001A700
		push	4
		lea	ecx, [esp+28h+var_8]
		push	ecx
		push	esi
		call	sub_10022120
		mov	edx, [esp+30h+arg_8]
		push	edx
		lea	eax, [esp+34h+var_8]
		push	eax
		call	sub_1001A700
		push	4
		lea	ecx, [esp+3Ch+var_8]
		push	ecx
		push	esi
		call	sub_10022120
		mov	eax, [esp+44h+arg_C]
		mov	edx, [eax+8]
		mov	eax, [eax+4]
		push	edx
		push	eax
		push	esi
		call	sub_10022120
		mov	ecx, [ebp+8]
		mov	edx, [ebp+4]
		lea	eax, [ebp+8]
		push	ecx
		push	eax
		push	edx
		push	esi
		call	sub_10022150
		add	esp, 48h
		push	1
		push	esi
		mov	ebx, eax
		call	sub_10022080
		add	esp, 8

loc_1001EB36:				; CODE XREF: sub_1001EA40+82j
		push	1
		push	edi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1001EB41:				; CODE XREF: sub_1001EA40+61j
		pop	edi

loc_1001EB42:				; CODE XREF: sub_1001EA40+44j
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
sub_1001EA40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EB50	proc near		; CODE XREF: sub_1001A8C0+331p

var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_50		= byte ptr -50h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		mov	eax, [esp+74h+arg_10]
		push	ebx
		mov	ebx, [esp+78h+arg_C]
		push	esi
		push	edi
		mov	edi, [esp+80h+arg_0]
		push	eax
		lea	esi, [esp+84h+var_68]
		call	sub_1001E780
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001EBE8
		mov	edx, [esp+80h+arg_8]
		lea	ecx, [esp+80h+var_74]
		push	ecx
		lea	eax, [esp+84h+var_44]
		push	ebx
		mov	[esp+88h+var_70], eax
		mov	eax, [esp+88h+arg_4]
		push	edx
		push	eax
		mov	eax, [esp+90h+var_60]
		push	edi
		mov	[esp+94h+var_6C], 40h
		call	sub_1001EA40
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_1001EBE8
		lea	ecx, [esp+80h+var_74]
		push	ecx
		lea	edx, [esp+84h+var_50]
		push	edx
		call	SECITEM_CompareItem_Util
		add	esp, 8
		test	eax, eax
		jz	short loc_1001EBE8
		push	0FFFFE00Ah
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh

loc_1001EBE8:				; CODE XREF: sub_1001EB50+37j
					; sub_1001EB50+70j ...
		mov	eax, [esp+80h+var_60]
		test	eax, eax
		jz	short loc_1001EBF9
		push	eax
		call	sub_10006070
		add	esp, 4

loc_1001EBF9:				; CODE XREF: sub_1001EB50+9Ej
		mov	eax, [esp+80h+var_68]
		test	eax, eax
		jz	short loc_1001EC0C
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1001EC0C:				; CODE XREF: sub_1001EB50+AFj
		mov	ecx, [esp+80h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
sub_1001EB50	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001EC20	proc near		; CODE XREF: sub_1001AC80+116p
					; sub_1001F1E0+1D7p

var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= byte ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= byte ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= byte ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 0B8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B8h+var_4], eax
		mov	eax, [esp+0B8h+arg_0]
		mov	ecx, [esp+0B8h+arg_4]
		mov	edx, [esp+0B8h+arg_10]
		push	ebx
		push	ebp
		push	esi
		mov	[esp+0C4h+var_B8], eax
		mov	eax, [esp+0C4h+arg_14]
		push	edi
		push	128h
		mov	[esp+0CCh+var_AC], ecx
		mov	[esp+0CCh+var_B4], edx
		mov	[esp+0CCh+var_B0], eax
		call	sub_10006020
		mov	ebx, eax
		push	ebx
		call	sub_10022040
		mov	esi, [eax]
		push	128h
		call	sub_10006020
		push	eax
		call	sub_10022040
		mov	ebp, [eax]
		lea	ecx, [esp+0D8h+var_84]
		mov	eax, ecx
		lea	edx, [esp+0D8h+var_44]
		push	esi
		push	eax
		mov	[esp+0E0h+var_A4], 125h
		mov	[esp+0E0h+var_94], esi
		mov	[esp+0E0h+var_98], ecx
		mov	[esp+0E0h+var_8C], edx
		mov	[esp+0E0h+var_88], ebp
		call	sub_10021640
		mov	edx, [esp+0E0h+var_A4]
		push	1
		lea	ecx, [esp+0E4h+var_9C]
		push	ecx
		push	edx
		call	sub_10005FA0
		mov	edi, eax
		add	esp, 24h
		test	edi, edi
		jnz	short loc_1001ECD8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001ED5E
; ---------------------------------------------------------------------------

loc_1001ECD8:				; CODE XREF: sub_1001EC20+AEj
		mov	ecx, [edi]
		push	0
		push	128h
		lea	eax, [edi+40h]
		push	eax
		push	ecx
		mov	dword ptr [edi+58h], 3
		mov	dword ptr [edi+5Ch], 128h
		mov	[edi+38h], ebx
		mov	[edi+2Ch], ebp
		call	SECOID_SetAlgorithmID_Util
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1001ED53
		mov	eax, [esp+0C8h+var_B4]
		mov	ecx, [esp+0C8h+arg_C]
		lea	edx, [esp+0C8h+var_90]
		push	edx
		mov	edx, [esp+0CCh+arg_8]
		push	eax
		mov	eax, [esp+0D0h+var_AC]
		push	ecx
		push	edx
		push	eax
		mov	eax, edi
		call	sub_1001EA40
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_1001ED53
		mov	ecx, [esp+0C8h+var_B0]
		mov	edx, [esp+0C8h+var_B8]
		push	ecx
		push	edx
		lea	esi, [esp+0D0h+var_A8]
		mov	[esp+0D0h+var_A0], edi
		call	sub_1001E830
		add	esp, 8
		mov	esi, eax

loc_1001ED53:				; CODE XREF: sub_1001EC20+E6j
					; sub_1001EC20+115j
		push	edi
		call	sub_10006070
		add	esp, 4
		mov	eax, esi

loc_1001ED5E:				; CODE XREF: sub_1001EC20+B3j
		mov	ecx, [esp+0C8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B8h
		retn
sub_1001EC20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001ED80	proc near		; CODE XREF: sub_1001EF70+1D5p
					; sub_1001F7A0+221p
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short locret_1001EDB3
		push	eax
		call	ds:PR_Lock
		mov	edx, [edi+4]
		mov	eax, [esi+10h]
		mov	ecx, [esi+14h]
		mov	[esi+10h], edx
		mov	edx, [edi+8]
		mov	[esi+14h], edx
		mov	[edi+4], eax
		mov	[edi+8], ecx
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 8

locret_1001EDB3:			; CODE XREF: sub_1001ED80+5j
		retn
sub_1001ED80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EDC0	proc near		; CODE XREF: sub_10008680+92p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		cmp	[ecx+30h], eax
		setnz	al
		retn
sub_1001EDC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EDD0	proc near		; CODE XREF: sub_1000B3F0+18Bp
					; sub_1001EF70+159p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+30h], 0
		jz	short loc_1001EDEC
		cmp	dword ptr [eax+34h], 0
		jz	short loc_1001EDEC
		cmp	dword ptr [eax+20h], 0
		jnz	short loc_1001EDEC
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1001EDEC:				; CODE XREF: sub_1001EDD0+8j
					; sub_1001EDD0+Ej ...
		xor	eax, eax
		retn
sub_1001EDD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EDF0	proc near		; CODE XREF: sub_1001CB20+9Fp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		cmp	[esi+8], edi
		jnz	short loc_1001EE00
		mov	esi, [esi+28h]

loc_1001EE00:				; CODE XREF: sub_1001EDF0+Bj
		test	esi, esi
		jnz	short loc_1001EE09
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001EE09:				; CODE XREF: sub_1001EDF0+12j
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_Lock
		mov	eax, [esi+20h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EE28
		push	eax
		call	SECITEM_DupItem_Util
		add	esp, 4
		mov	edi, eax

loc_1001EE28:				; CODE XREF: sub_1001EDF0+2Bj
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_1001EDF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EE40	proc near		; CODE XREF: sub_1001CB20+220p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		test	esi, esi
		jz	short loc_1001EE8A
		cmp	[esi+8], edi
		jz	short loc_1001EE8A
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_Lock
		mov	eax, [esi+20h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EE6E
		mov	edi, eax
		mov	dword ptr [esi+20h], 0

loc_1001EE6E:				; CODE XREF: sub_1001EE40+23j
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4
		test	edi, edi
		jz	short loc_1001EE8A
		push	1
		push	edi
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_1001EE8A:				; CODE XREF: sub_1001EE40+Aj
					; sub_1001EE40+Fj ...
		pop	edi
		pop	esi
		retn
sub_1001EE40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EE90	proc near		; CODE XREF: sub_10008A20+D1p
					; sub_100090D0+DAp ...

var_21C		= byte ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= byte ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= dword	ptr -208h
var_204		= byte ptr -204h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 21Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+21Ch+var_4], eax
		push	esi
		mov	esi, [esp+220h+arg_0]
		test	esi, esi
		jnz	short loc_1001EEC9

loc_1001EEB0:				; CODE XREF: sub_1001EE90+56j
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+21Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 21Ch
		retn
; ---------------------------------------------------------------------------

loc_1001EEC9:				; CODE XREF: sub_1001EE90+1Ej
		mov	eax, [esi+2Ch]
		test	eax, eax
		jz	short loc_1001EEE2
		cmp	dword ptr [esi+30h], 0
		jz	short loc_1001EEE4
		cmp	dword ptr [esi+34h], 0
		jz	short loc_1001EEE2
		cmp	dword ptr [esi+20h], 0
		jz	short loc_1001EEE4

loc_1001EEE2:				; CODE XREF: sub_1001EE90+3Ej
					; sub_1001EE90+4Aj
		mov	eax, [esi]

loc_1001EEE4:				; CODE XREF: sub_1001EE90+44j
					; sub_1001EE90+50j
		test	eax, eax
		jz	short loc_1001EEB0
		lea	ecx, [esp+220h+var_204]
		mov	[esp+220h+var_218], ecx
		mov	ecx, 100h
		push	edi
		mov	[esp+224h+var_214], ecx
		mov	[esp+224h+var_208], ecx
		lea	edx, [esp+224h+var_104]
		mov	[esp+224h+var_20C], edx
		lea	ecx, [esp+224h+var_210]
		push	ecx
		lea	edx, [esp+228h+var_21C]
		push	edx
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+30h]
		call	eax
		mov	ecx, [esi]
		add	esp, 10h
		test	byte ptr [ecx+0Ch], 1
		mov	edi, eax
		jnz	short loc_1001EF52
		cmp	dword ptr [esi+2Ch], 0
		jz	short loc_1001EF52
		test	edi, edi
		jz	short loc_1001EF52
		mov	eax, [esi+28h]
		test	eax, eax
		jz	short loc_1001EF47
		push	0
		push	eax
		call	sub_1001CB20
		add	esp, 8

loc_1001EF47:				; CODE XREF: sub_1001EE90+AAj
		push	0
		push	esi
		call	sub_1001CB20
		add	esp, 8

loc_1001EF52:				; CODE XREF: sub_1001EE90+99j
					; sub_1001EE90+9Fj ...
		mov	ecx, [esp+224h+var_4]
		neg	edi
		sbb	eax, eax
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 21Ch
		retn
sub_1001EE90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EF70	proc near		; CODE XREF: sub_10008B70+1CDp
					; sub_100090D0+16Ap ...

var_230		= dword	ptr -230h
var_22C		= byte ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= byte ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= byte ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= dword	ptr -208h
var_204		= byte ptr -204h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 230h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+230h+var_4], eax
		mov	eax, [esp+230h+arg_8]
		push	ebx
		push	esi
		mov	esi, [esp+238h+arg_0]
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+23Ch+arg_4]
		mov	[esp+23Ch+var_220], eax
		mov	[esp+23Ch+var_230], ebx
		cmp	esi, ebx
		jnz	short loc_1001EFC5

loc_1001EFAA:				; CODE XREF: sub_1001EF70+6Fj
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+230h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 230h
		retn
; ---------------------------------------------------------------------------

loc_1001EFC5:				; CODE XREF: sub_1001EF70+38j
		mov	eax, [esi+2Ch]
		cmp	eax, ebx
		jz	short loc_1001EFDB
		cmp	[esi+30h], ebx
		jz	short loc_1001EFDD
		cmp	[esi+34h], ebx
		jz	short loc_1001EFDB
		cmp	[esi+20h], ebx
		jz	short loc_1001EFDD

loc_1001EFDB:				; CODE XREF: sub_1001EF70+5Aj
					; sub_1001EF70+64j
		mov	eax, [esi]

loc_1001EFDD:				; CODE XREF: sub_1001EF70+5Fj
					; sub_1001EF70+69j
		cmp	eax, ebx
		jz	short loc_1001EFAA
		mov	[esp+23Ch+var_228], ebx
		mov	[esp+23Ch+var_224], ebx
		cmp	edi, ebx
		jnz	short loc_1001EFF2
		mov	edi, offset word_10026FE6

loc_1001EFF2:				; CODE XREF: sub_1001EF70+7Bj
		lea	ecx, [esp+23Ch+var_204]
		mov	[esp+23Ch+var_218], ecx
		mov	ecx, 100h
		push	ebp
		mov	[esp+240h+var_214], ecx
		mov	[esp+240h+var_208], ecx
		lea	edx, [esp+240h+var_104]
		mov	[esp+240h+var_20C], edx
		lea	ecx, [esp+240h+var_210]
		push	ecx
		lea	edx, [esp+244h+var_21C]
		push	edx
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+30h]
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	loc_1001F17B
		lea	ecx, [esp+240h+var_21C]
		push	edi
		push	ecx
		lea	eax, [esp+248h+var_22C]
		call	sub_1001E6C0
		mov	ebp, eax
		add	esp, 8
		cmp	ebp, ebx
		jnz	loc_1001F17E
		lea	edx, [esp+240h+var_230]
		push	edx
		lea	eax, [esp+244h+var_210]
		push	eax
		lea	ecx, [esp+248h+var_22C]
		push	ecx
		call	sub_1001E8E0
		mov	ebp, eax
		add	esp, 0Ch
		cmp	ebp, ebx
		jnz	loc_1001F17E
		mov	ecx, [esp+240h+var_230]
		mov	edx, 0Eh
		cmp	[ecx+8], edx
		jnz	loc_1001F17B
		mov	ecx, [ecx+4]
		mov	eax, offset aPasswordCheck ; "password-check"
		lea	ebx, [ebx+0]

loc_1001F090:				; CODE XREF: sub_1001EF70+136j
		mov	ebx, [ecx]
		cmp	ebx, [eax]
		jnz	loc_1001F17B
		sub	edx, 4
		add	eax, 4
		add	ecx, 4
		cmp	edx, 4
		jnb	short loc_1001F090
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	loc_1001F17B
		mov	al, [eax+1]
		cmp	al, [ecx+1]
		jnz	loc_1001F17B
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Lock
		push	esi
		call	sub_1001EDD0
		add	esp, 8
		test	eax, eax
		jz	short loc_1001F134
		lea	edx, [esp+240h+var_22C]
		push	edx
		call	SECITEM_DupItem_Util
		mov	[esi+20h], eax
		mov	eax, [esi+24h]
		push	eax
		call	ds:PR_Unlock
		add	esp, 8
		cmp	dword ptr [esi+20h], 0
		jz	loc_1001F17B
		mov	ebx, [esp+240h+var_220]
		push	esi
		mov	dword ptr [ebx], 1
		call	sub_1001EE90
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001F141
		push	ebx
		push	edi
		push	esi
		call	sub_1001EF70
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_1001F17E
		push	ebx
		push	offset word_10026FE6
		push	esi
		call	sub_1001EF70
		add	esp, 0Ch
		xor	ebp, ebp
		jmp	short loc_1001F17E
; ---------------------------------------------------------------------------

loc_1001F134:				; CODE XREF: sub_1001EF70+163j
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PR_Unlock
		add	esp, 4

loc_1001F141:				; CODE XREF: sub_1001EF70+19Ej
		lea	edi, [esp+240h+var_22C]
		call	sub_1001ED80
		mov	edx, [esi]
		test	byte ptr [edx+0Ch], 1
		jnz	short loc_1001F17E
		cmp	dword ptr [esi+2Ch], 0
		jz	short loc_1001F17E
		mov	eax, [esi+28h]
		test	eax, eax
		jz	short loc_1001F16B
		mov	ecx, edi
		push	ecx
		push	eax
		call	sub_1001CB20
		add	esp, 8

loc_1001F16B:				; CODE XREF: sub_1001EF70+1EDj
		lea	edx, [esp+240h+var_22C]
		push	edx
		push	esi
		call	sub_1001CB20
		add	esp, 8
		jmp	short loc_1001F17E
; ---------------------------------------------------------------------------

loc_1001F17B:				; CODE XREF: sub_1001EF70+BDj
					; sub_1001EF70+10Cj ...
		or	ebp, 0FFFFFFFFh

loc_1001F17E:				; CODE XREF: sub_1001EF70+D9j
					; sub_1001EF70+FAj ...
		mov	eax, [esp+240h+var_228]
		test	eax, eax
		jz	short loc_1001F194
		mov	ecx, [esp+240h+var_224]
		push	ecx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001F194:				; CODE XREF: sub_1001EF70+214j
		mov	eax, [esp+240h+var_230]
		test	eax, eax
		jz	short loc_1001F1A7
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1001F1A7:				; CODE XREF: sub_1001EF70+22Aj
		mov	ecx, [esp+240h+var_4]
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 230h
		retn
sub_1001EF70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001F1D0	proc near		; CODE XREF: sub_100090D0+1BCp
					; sub_1000B370+5p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+10h]
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
sub_1001F1D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001F1E0	proc near		; CODE XREF: sub_1001F660+C0p

var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= byte ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 9Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+9Ch+var_4], eax
		mov	eax, [esp+9Ch+arg_0]
		and	[esp+9Ch+arg_4], 3FFFFFFFh
		push	esi
		xor	esi, esi
		cmp	dword ptr [ecx+8], 40000000h
		mov	[esp+0A0h+var_98], eax
		mov	[esp+0A0h+var_94], ecx
		mov	[esp+0A0h+var_90], edx
		mov	[esp+0A0h+var_7C], 120h
		mov	[esp+0A0h+var_78], esi
		mov	[esp+0A0h+var_74], esi
		mov	[esp+0A0h+var_70], 122h
		mov	[esp+0A0h+var_6C], esi
		mov	[esp+0A0h+var_68], esi
		mov	[esp+0A0h+var_64], 0CE5363B4h
		mov	[esp+0A0h+var_60], esi
		mov	[esp+0A0h+var_5C], esi
		mov	[esp+0A0h+var_58], 0CE5363B5h
		mov	[esp+0A0h+var_54], esi
		mov	[esp+0A0h+var_50], esi
		mov	[esp+0A0h+var_4C], 0CE536358h
		mov	[esp+0A0h+var_48], esi
		mov	[esp+0A0h+var_44], esi
		mov	[esp+0A0h+var_40], 0CE536359h
		mov	[esp+0A0h+var_3C], esi
		mov	[esp+0A0h+var_38], esi
		mov	[esp+0A0h+var_34], 0CE53635Bh
		mov	[esp+0A0h+var_30], esi
		mov	[esp+0A0h+var_2C], esi
		mov	[esp+0A0h+var_28], 0CE53635Ah
		mov	[esp+0A0h+var_24], esi
		mov	[esp+0A0h+var_20], esi
		mov	[esp+0A0h+var_1C], 0CE536360h
		mov	[esp+0A0h+var_18], esi
		mov	[esp+0A0h+var_14], esi
		mov	[esp+0A0h+var_10], 0CE534369h
		mov	[esp+0A0h+var_C], esi
		mov	[esp+0A0h+var_8], esi
		mov	eax, ecx
		jz	short loc_1001F2D8
		mov	eax, [ecx+28h]

loc_1001F2D8:				; CODE XREF: sub_1001F1E0+F3j
		cmp	eax, esi
		jnz	short loc_1001F2F4

loc_1001F2DC:				; CODE XREF: sub_1001F1E0+12Fj
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+9Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 9Ch
		retn
; ---------------------------------------------------------------------------

loc_1001F2F4:				; CODE XREF: sub_1001F1E0+FAj
		mov	edx, [eax+2Ch]
		cmp	edx, esi
		jz	short loc_1001F301
		mov	[esp+0A0h+var_9C], edx
		jmp	short loc_1001F307
; ---------------------------------------------------------------------------

loc_1001F301:				; CODE XREF: sub_1001F1E0+119j
		mov	eax, [eax]
		mov	[esp+0A0h+var_9C], eax

loc_1001F307:				; CODE XREF: sub_1001F1E0+11Fj
		mov	edx, [esp+0A0h+var_9C]
		test	byte ptr [edx+0Ch], 8
		jz	short loc_1001F2DC
		mov	edx, [esp+0A0h+arg_4]
		push	ebx
		push	ebp
		push	edi
		push	0Ah
		lea	eax, [esp+0B0h+var_7C]
		push	eax
		push	edx
		push	ecx
		call	sub_1001BB30
		add	esp, 10h
		xor	ebp, ebp
		xor	ebx, ebx
		lea	edi, [esp+0ACh+var_74]

loc_1001F334:				; CODE XREF: sub_1001F1E0+17Cj
		mov	eax, [edi]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001F355
		cmp	eax, esi
		jz	short loc_1001F355
		push	eax
		mov	eax, [esp+0B0h+var_98]
		push	eax
		inc	ebp
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[edi-4], eax
		cmp	eax, esi
		jz	short loc_1001F35E

loc_1001F355:				; CODE XREF: sub_1001F1E0+159j
					; sub_1001F1E0+15Dj
		inc	ebx
		add	edi, 0Ch
		cmp	ebx, 0Ah
		jb	short loc_1001F334

loc_1001F35E:				; CODE XREF: sub_1001F1E0+173j
		cmp	ebp, esi
		jz	loc_1001F3EC
		mov	ebp, [esp+0ACh+arg_4]
		mov	edx, [esp+0ACh+var_94]
		push	0Ah
		lea	ecx, [esp+0B0h+var_7C]
		push	ecx
		push	ebp
		push	edx
		call	sub_1001BB30
		add	esp, 10h
		xor	ebx, ebx
		lea	edi, [esp+0ACh+var_74]

loc_1001F388:				; CODE XREF: sub_1001F1E0+20Aj
		mov	eax, [edi]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001F3E3
		cmp	eax, esi
		jz	short loc_1001F3E3
		mov	ecx, [edi-4]
		mov	[esp+0ACh+var_80], eax
		lea	edx, [esp+0ACh+var_8C]
		push	edx
		mov	edx, [esp+0B0h+var_90]
		lea	eax, [esp+0B0h+var_88]
		push	eax
		mov	eax, [esp+0B4h+var_98]
		mov	[esp+0B4h+var_84], ecx
		mov	ecx, [edi-8]
		push	ecx
		push	ebp
		push	edx
		push	eax
		call	sub_1001EC20
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1001F407
		mov	ecx, [esp+0ACh+var_8C]
		mov	edx, [edi-8]
		mov	eax, [esp+0ACh+var_9C]
		push	ecx
		mov	ecx, [esp+0B0h+var_94]
		push	edx
		push	ebp
		push	eax
		push	ecx
		call	sub_1001A850
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001F407

loc_1001F3E3:				; CODE XREF: sub_1001F1E0+1ADj
					; sub_1001F1E0+1B1j
		inc	ebx
		add	edi, 0Ch
		cmp	ebx, 0Ah
		jb	short loc_1001F388

loc_1001F3EC:				; CODE XREF: sub_1001F1E0+180j
		xor	eax, eax

loc_1001F3EE:				; CODE XREF: sub_1001F1E0+22Cj
		mov	ecx, [esp+0ACh+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 9Ch
		retn
; ---------------------------------------------------------------------------

loc_1001F407:				; CODE XREF: sub_1001F1E0+1E1j
					; sub_1001F1E0+201j
		mov	eax, 5
		jmp	short loc_1001F3EE
sub_1001F1E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001F410	proc near		; CODE XREF: sub_1001F660+DEp

var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= byte ptr -64h
Dst		= dword	ptr -60h
Size		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 80h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+80h+var_4], eax
		mov	eax, [esp+80h+arg_0]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		push	7
		lea	edx, [esp+94h+var_58]
		mov	[esp+94h+var_74], ecx
		mov	ecx, [esp+94h+arg_8]
		push	edx
		mov	[esp+98h+var_70], eax
		mov	eax, [esp+98h+arg_4]
		push	ecx
		push	eax
		mov	[esp+0A0h+var_68], eax
		mov	[esp+0A0h+var_58], 11h
		mov	[esp+0A0h+var_54], esi
		mov	[esp+0A0h+var_50], esi
		mov	[esp+0A0h+var_4C], 123h
		mov	[esp+0A0h+var_48], esi
		mov	[esp+0A0h+var_44], esi
		mov	[esp+0A0h+var_40], 124h
		mov	[esp+0A0h+var_3C], esi
		mov	[esp+0A0h+var_38], esi
		mov	[esp+0A0h+var_34], 125h
		mov	[esp+0A0h+var_30], esi
		mov	[esp+0A0h+var_2C], esi
		mov	[esp+0A0h+var_28], 126h
		mov	[esp+0A0h+var_24], esi
		mov	[esp+0A0h+var_20], esi
		mov	[esp+0A0h+var_1C], 127h
		mov	[esp+0A0h+var_18], esi
		mov	[esp+0A0h+var_14], esi
		mov	[esp+0A0h+var_10], 128h
		mov	[esp+0A0h+var_C], esi
		mov	[esp+0A0h+var_8], esi
		call	sub_1001BB30
		add	esp, 10h
		xor	ebx, ebx
		xor	ebp, ebp
		mov	[esp+90h+var_78], eax
		mov	[esp+90h+var_80], ebp
		mov	[esp+90h+var_6C], esi
		lea	edi, [esp+90h+var_50]

loc_1001F4F2:				; CODE XREF: sub_1001F410+146j
		mov	eax, [edi]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001F53C
		cmp	eax, esi
		jz	short loc_1001F53C
		cmp	ebp, esi
		jnz	short loc_1001F50A
		lea	edx, [edi-8]
		mov	[esp+90h+var_80], edx
		mov	ebp, edx

loc_1001F50A:				; CODE XREF: sub_1001F410+EFj
		cmp	ebx, esi
		jnz	short loc_1001F55C
		push	eax
		mov	eax, [esp+94h+var_70]
		push	eax
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[edi-4], eax
		cmp	eax, esi
		jnz	short loc_1001F547
		mov	[esp+90h+var_7C], 2
		mov	eax, [esp+90h+var_7C]

loc_1001F52F:				; CODE XREF: sub_1001F410+14Aj
					; sub_1001F410+151j
		cmp	ebp, esi
		jnz	short loc_1001F563
		mov	eax, [esp+90h+var_78]
		jmp	loc_1001F63A
; ---------------------------------------------------------------------------

loc_1001F53C:				; CODE XREF: sub_1001F410+E7j
					; sub_1001F410+EBj
		cmp	ebp, esi
		jz	short loc_1001F547
		cmp	ebx, esi
		jnz	short loc_1001F547
		lea	ebx, [edi-14h]

loc_1001F547:				; CODE XREF: sub_1001F410+111j
					; sub_1001F410+12Ej ...
		mov	eax, [esp+90h+var_6C]
		inc	eax
		add	edi, 0Ch
		mov	[esp+90h+var_6C], eax
		cmp	eax, 7
		jb	short loc_1001F4F2
		mov	eax, esi
		jmp	short loc_1001F52F
; ---------------------------------------------------------------------------

loc_1001F55C:				; CODE XREF: sub_1001F410+FCj
		mov	eax, 5
		jmp	short loc_1001F52F
; ---------------------------------------------------------------------------

loc_1001F563:				; CODE XREF: sub_1001F410+121j
		cmp	ebx, esi
		jnz	short loc_1001F56E
		lea	ebx, [esp+90h+var_10]

loc_1001F56E:				; CODE XREF: sub_1001F410+155j
		cmp	eax, esi
		jnz	loc_1001F63A
		sub	ebx, ebp
		mov	eax, 2AAAAAABh
		imul	ebx
		mov	eax, [esp+90h+var_68]
		sar	edx, 1
		mov	ecx, edx
		shr	ecx, 1Fh
		lea	ebx, [edx+ecx+1]
		mov	edx, [esp+90h+arg_8]
		push	ebx
		push	ebp
		push	edx
		push	eax
		call	sub_1001BB30
		add	esp, 10h
		cmp	eax, esi
		jnz	loc_1001F63A
		xor	ebp, ebp
		cmp	ebx, esi
		jle	short loc_1001F60D
		mov	edi, [esp+90h+var_80]
		add	edi, 8

loc_1001F5B6:				; CODE XREF: sub_1001F410+1FBj
		mov	ecx, [edi-4]
		mov	edx, [edi]
		lea	eax, [esp+90h+var_78]
		push	eax
		mov	eax, [esp+94h+var_70]
		mov	[esp+94h+Dst], ecx
		lea	ecx, [esp+94h+var_64]
		mov	[esp+94h+Size],	edx
		mov	edx, [esp+94h+var_74]
		push	ecx
		push	edx
		push	eax
		call	sub_1001E950
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001F653
		mov	eax, [esp+90h+var_78]
		mov	ecx, [eax+4]
		mov	[edi-4], ecx
		mov	edx, [eax+8]
		mov	eax, [esp+90h+Size]
		mov	ecx, [esp+90h+Dst]
		push	eax		; Size
		push	esi		; Val
		push	ecx		; Dst
		mov	[edi], edx
		call	memset
		inc	ebp
		add	esp, 0Ch
		add	edi, 0Ch
		cmp	ebp, ebx
		jl	short loc_1001F5B6

loc_1001F60D:				; CODE XREF: sub_1001F410+19Dj
		mov	ecx, [esp+90h+var_80]
		mov	edi, [esp+90h+var_68]
		mov	edx, [esp+90h+var_74]
		mov	eax, [edi]
		push	ebx
		push	ecx
		mov	ecx, [esp+98h+arg_8]
		and	ecx, 3FFFFFFFh
		push	ecx
		mov	[edi+18h], edx
		mov	edx, [eax+24h]
		push	eax
		call	edx
		add	esp, 10h
		mov	[edi+18h], esi

loc_1001F63A:				; CODE XREF: sub_1001F410+127j
					; sub_1001F410+160j ...
		mov	ecx, [esp+90h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 80h
		retn
; ---------------------------------------------------------------------------

loc_1001F653:				; CODE XREF: sub_1001F410+1D1j
		mov	eax, 5
		jmp	short loc_1001F63A
sub_1001F410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001F660	proc near		; CODE XREF: sub_1001F7A0+122p
					; sub_1001F7A0+166p ...

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		mov	ecx, [esp+3Ch+arg_C]
		mov	eax, [esp+3Ch+arg_4]
		push	ebp
		mov	ebp, [esp+40h+arg_0]
		push	esi
		lea	edx, [esp+44h+var_3C]
		push	edx
		mov	[esp+48h+var_30], ecx
		mov	ecx, [esp+48h+arg_8]
		push	ecx
		push	eax
		push	ebp
		mov	[esp+54h+var_3C], 0
		mov	[esp+54h+var_38], 0Ah
		call	sub_1001BA20
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_1001F786
		mov	ecx, [esp+44h+var_38]
		push	ebx
		push	edi

loc_1001F6B4:				; CODE XREF: sub_1001F660+9Aj
		cmp	ecx, 0Ah
		jnz	loc_1001F76E
		lea	edx, [esp+4Ch+var_38]
		push	edx
		push	ecx
		mov	ecx, [esp+54h+var_3C]
		lea	eax, [esp+54h+var_2C]
		push	eax
		push	ecx
		push	ebp
		call	sub_1001BAA0
		mov	esi, eax
		xor	eax, eax
		add	esp, 14h
		mov	[esp+4Ch+var_34], eax
		test	esi, esi
		jnz	loc_1001F76E
		jmp	short loc_1001F6F4
; ---------------------------------------------------------------------------
		jmp	short loc_1001F6F0
; ---------------------------------------------------------------------------
		align 10h

loc_1001F6F0:				; CODE XREF: sub_1001F660+88j
					; sub_1001F660+10Cj
		mov	eax, [esp+4Ch+var_34]

loc_1001F6F4:				; CODE XREF: sub_1001F660+86j
		mov	ecx, [esp+4Ch+var_38]
		cmp	eax, ecx
		jnb	short loc_1001F6B4
		mov	ebx, [esp+eax*4+4Ch+var_2C]
		push	400h
		call	PORT_NewArena_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001F718
		lea	esi, [eax+2]
		jmp	short loc_1001F766
; ---------------------------------------------------------------------------

loc_1001F718:				; CODE XREF: sub_1001F660+B1j
		mov	edx, [esp+4Ch+var_30]
		push	ebx
		push	edi
		mov	ecx, ebp
		call	sub_1001F1E0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1001F74C
		cmp	dword ptr [ebp+8], 40000000h
		jnz	short loc_1001F759
		mov	ecx, [esp+4Ch+var_30]
		push	ebx
		push	ebp
		push	edi
		call	sub_1001F410
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1001F759

loc_1001F74C:				; CODE XREF: sub_1001F660+CCj
		push	1
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		jmp	short loc_1001F766
; ---------------------------------------------------------------------------

loc_1001F759:				; CODE XREF: sub_1001F660+D5j
					; sub_1001F660+EAj
		push	0
		push	edi
		call	PORT_FreeArena_Util
		add	esp, 8
		xor	esi, esi

loc_1001F766:				; CODE XREF: sub_1001F660+B6j
					; sub_1001F660+F7j
		inc	[esp+4Ch+var_34]
		test	esi, esi
		jz	short loc_1001F6F0

loc_1001F76E:				; CODE XREF: sub_1001F660+57j
					; sub_1001F660+80j
		mov	edx, [esp+4Ch+var_3C]
		push	edx
		push	ebp
		call	sub_1001BB10
		add	esp, 8
		pop	edi
		pop	ebx
		test	esi, esi
		jnz	short loc_1001F784
		mov	esi, eax

loc_1001F784:				; CODE XREF: sub_1001F660+120j
		mov	eax, esi

loc_1001F786:				; CODE XREF: sub_1001F660+48j
		mov	ecx, [esp+44h+var_4]
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
sub_1001F660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001F7A0	proc near		; CODE XREF: sub_10008A20+107p
					; sub_10008B70+150p

var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_240		= byte ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= byte ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= byte ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= byte ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= dword	ptr -208h
var_204		= byte ptr -204h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 248h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+248h+var_4], eax
		mov	eax, [esp+248h+arg_8]
		push	ebx
		mov	ebx, [esp+24Ch+arg_4]
		push	ebp
		mov	ebp, [esp+250h+arg_C]
		push	esi
		mov	esi, [esp+254h+arg_0]
		mov	[esp+254h+var_248], eax
		xor	eax, eax
		mov	[esp+254h+var_244], eax
		cmp	esi, eax
		jnz	short loc_1001F7FC
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+248h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 248h
		retn
; ---------------------------------------------------------------------------

loc_1001F7FC:				; CODE XREF: sub_1001F7A0+3Fj
		push	edi
		mov	edi, [esi+2Ch]
		cmp	edi, eax
		jnz	short loc_1001F812
		mov	edi, [esi]
		cmp	edi, eax
		jnz	short loc_1001F812
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA00
; ---------------------------------------------------------------------------

loc_1001F812:				; CODE XREF: sub_1001F7A0+62j
					; sub_1001F7A0+68j
		mov	[esp+258h+var_23C], eax
		mov	eax, [esi]
		mov	ecx, [eax+38h]
		push	eax
		call	ecx
		add	esp, 4
		test	eax, eax
		jz	short loc_1001F82D
		or	ebx, 0FFFFFFFFh
		jmp	loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F82D:				; CODE XREF: sub_1001F7A0+83j
		lea	edx, [esp+258h+var_204]
		mov	[esp+258h+var_230], edx
		mov	eax, 100h
		mov	[esp+258h+var_22C], eax
		mov	[esp+258h+var_220], eax
		lea	edx, [esp+258h+var_228]
		push	edx
		lea	eax, [esp+25Ch+var_234]
		push	eax
		lea	ecx, [esp+260h+var_104]
		mov	[esp+260h+var_224], ecx
		mov	ecx, [edi+30h]
		push	offset aPassword ; "password"
		push	edi
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001F881
		push	ebp
		push	ebx
		push	esi
		call	sub_1001EF70
		mov	ebx, eax
		add	esp, 0Ch
		cmp	ebx, 0FFFFFFFFh
		jz	loc_1001F9C6
		jmp	short loc_1001F898
; ---------------------------------------------------------------------------

loc_1001F881:				; CODE XREF: sub_1001F7A0+C7j
		mov	edx, [esp+258h+var_230]
		push	14h
		push	edx
		mov	[esp+260h+var_22C], 14h
		call	sub_10021640
		add	esp, 8

loc_1001F898:				; CODE XREF: sub_1001F7A0+DFj
		mov	eax, [esp+258h+var_248]
		push	eax
		lea	ecx, [esp+25Ch+var_234]
		push	ecx
		lea	eax, [esp+260h+var_240]
		call	sub_1001E6C0
		mov	ebx, eax
		xor	ebp, ebp
		add	esp, 8
		cmp	ebx, ebp
		jnz	loc_1001F9C6
		lea	edx, [esp+258h+var_240]
		push	edx
		push	ebp
		push	ebp
		push	esi
		call	sub_1001F660
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001F8D6
		or	ebx, 0FFFFFFFFh
		jmp	loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F8D6:				; CODE XREF: sub_1001F7A0+12Cj
		mov	edi, [esi+28h]
		cmp	edi, ebp
		jz	short loc_1001F943
		lea	ecx, [esp+258h+var_240]
		push	ecx
		push	1
		lea	edx, [esp+260h+var_21C]
		push	edx
		lea	eax, [esp+264h+var_248]
		push	edi
		mov	[esp+268h+var_21C], ebp
		mov	[esp+268h+var_214], 4
		mov	[esp+268h+var_248], 0CE534353h
		mov	[esp+268h+var_218], eax
		call	sub_1001F660
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001F91A
		or	ebx, 0FFFFFFFFh
		jmp	loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F91A:				; CODE XREF: sub_1001F7A0+170j
		lea	eax, [esp+258h+var_240]
		push	eax
		push	1
		lea	ecx, [esp+260h+var_21C]
		push	ecx
		push	edi
		mov	[esp+268h+var_248], 2
		call	sub_1001F660
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001F943
		or	ebx, 0FFFFFFFFh
		jmp	loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F943:				; CODE XREF: sub_1001F7A0+13Bj
					; sub_1001F7A0+199j
		lea	edx, [esp+258h+var_244]
		push	edx
		lea	eax, [esp+25Ch+var_210]
		push	eax
		lea	ecx, [esp+260h+var_240]
		push	ecx
		push	ebp
		mov	[esp+268h+var_20C], offset aPasswordCheck ; "password-check"
		mov	[esp+268h+var_208], 0Eh
		call	sub_1001E950
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, ebp
		jnz	short loc_1001F9C6
		mov	eax, [esp+258h+var_244]
		mov	edx, [eax+4]
		mov	[esp+258h+var_224], edx
		mov	eax, [eax+8]
		lea	ecx, [esp+258h+var_228]
		push	ecx
		lea	edx, [esp+25Ch+var_234]
		push	edx
		mov	[esp+260h+var_220], eax
		mov	eax, [esi]
		push	offset aPassword ; "password"
		push	eax
		mov	eax, [eax+34h]
		call	eax
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001F9A6
		or	ebx, 0FFFFFFFFh
		jmp	short loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F9A6:				; CODE XREF: sub_1001F7A0+1FFj
		mov	eax, [esi]
		mov	ecx, [eax+3Ch]
		push	eax
		call	ecx
		add	esp, 4
		test	eax, eax
		jz	short loc_1001F9BA
		or	ebx, 0FFFFFFFFh
		jmp	short loc_1001F9C6
; ---------------------------------------------------------------------------

loc_1001F9BA:				; CODE XREF: sub_1001F7A0+213j
		lea	edi, [esp+258h+var_240]
		mov	[esi+18h], ebp
		call	sub_1001ED80

loc_1001F9C6:				; CODE XREF: sub_1001F7A0+88j
					; sub_1001F7A0+D9j ...
		mov	eax, [esp+258h+var_23C]
		test	eax, eax
		jz	short loc_1001F9DC
		mov	edx, [esp+258h+var_238]
		push	edx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001F9DC:				; CODE XREF: sub_1001F7A0+22Cj
		mov	eax, [esp+258h+var_244]
		test	eax, eax
		jz	short loc_1001F9EF
		push	0
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1001F9EF:				; CODE XREF: sub_1001F7A0+242j
		test	ebx, ebx
		jz	short loc_1001F9FE
		mov	esi, [esi]
		mov	eax, [esi+40h]
		push	esi
		call	eax
		add	esp, 4

loc_1001F9FE:				; CODE XREF: sub_1001F7A0+251j
		mov	eax, ebx

loc_1001FA00:				; CODE XREF: sub_1001F7A0+6Dj
		mov	ecx, [esp+258h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 248h
		retn
sub_1001F7A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FA20	proc near		; CODE XREF: sub_10008020+38p
					; sub_10008F10+E2p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_1001FA6A
		push	ebx
		push	edi
		push	eax
		call	ds:PR_Lock
		mov	eax, [esi+24h]
		mov	edi, [esi+10h]
		mov	ebx, [esi+14h]
		push	eax
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0
		call	ds:PR_Unlock
		add	esp, 8
		test	edi, edi
		jz	short loc_1001FA64
		push	ebx
		push	edi
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001FA64:				; CODE XREF: sub_1001FA20+38j
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA6A:				; CODE XREF: sub_1001FA20+Aj
		xor	eax, eax
		pop	esi
		retn
sub_1001FA20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001FA70(int,	void *Src, size_t Size)
sub_1001FA70	proc near		; CODE XREF: sub_1001FBB0+2Fp
					; DATA XREF: sub_1001FCD0+B0o

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, [esi+0Ch]
		add	edi, [esi+10h]
		cmp	dword ptr [esi+14h], 0
		jnz	short loc_1001FAF6
		push	ebx
		mov	ebx, [esp+0Ch+Size]
		lea	eax, [edi+ebx]
		push	ebp
		cmp	eax, [esi+4]
		jbe	short loc_1001FADD
		lea	ebp, [eax+200h]
		push	ebp
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1001FAB1
		pop	ebp
		pop	ebx
		pop	edi
		mov	dword ptr [esi+14h], 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FAB1:				; CODE XREF: sub_1001FA70+33j
		mov	eax, [esi+8]
		push	edi		; Size
		push	eax		; Src
		push	ebx		; Dst
		call	memcpy
		mov	eax, [esi+8]
		lea	ecx, [esi+20h]
		add	esp, 0Ch
		cmp	eax, ecx
		jz	short loc_1001FAD3
		push	edi
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001FAD3:				; CODE XREF: sub_1001FA70+57j
		mov	[esi+8], ebx
		mov	ebx, [esp+10h+Size]
		mov	[esi+4], ebp

loc_1001FADD:				; CODE XREF: sub_1001FA70+1Ej
		mov	edx, [esp+10h+Src]
		mov	eax, [esi+8]
		push	ebx		; Size
		push	edx		; Src
		add	eax, edi
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		add	[esi+10h], ebx
		pop	ebp
		pop	ebx

loc_1001FAF6:				; CODE XREF: sub_1001FA70+10j
		pop	edi
		pop	esi
		retn
sub_1001FA70	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001FB00:				; DATA XREF: sub_1001FCD0+B7o
		mov	eax, [esp+0Ch]
		mov	dword ptr [eax], 0
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FB10	proc near		; CODE XREF: sub_1001FBB0+43p
					; DATA XREF: sub_1001FCD0+BEo

var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+14h]
		sub	esp, 24h
		test	eax, eax
		jnz	loc_1001FBA3
		mov	eax, [ecx+8]
		mov	edx, [ecx+0Ch]
		mov	[esp+24h+var_8], eax
		mov	[esp+24h+var_4], edx
		add	edx, eax
		mov	eax, [ecx+10h]
		mov	[esp+24h+var_10], eax
		mov	eax, [esp+24h+arg_C]
		mov	[esp+24h+var_1C], eax
		mov	eax, [ecx+1Ch]
		mov	[esp+24h+var_14], edx
		mov	edx, [esp+24h+arg_4]
		mov	[esp+24h+var_20], edx
		test	eax, eax
		jz	short loc_1001FB74
		mov	ecx, [ecx+18h]
		push	ecx
		lea	edx, [esp+28h+var_24]
		push	edx
		lea	ecx, [esp+2Ch+var_18]
		push	ecx
		push	0
		lea	edx, [esp+34h+var_C]
		push	edx
		push	eax
		call	sub_10022430
		add	esp, 18h
		jmp	short loc_1001FB91
; ---------------------------------------------------------------------------

loc_1001FB74:				; CODE XREF: sub_1001FB10+42j
		mov	eax, [ecx+18h]
		push	eax
		lea	ecx, [esp+28h+var_24]
		push	ecx
		lea	edx, [esp+2Ch+var_18]
		push	edx
		lea	eax, [esp+30h+var_C]
		push	0
		push	eax
		call	sub_10022000
		add	esp, 14h

loc_1001FB91:				; CODE XREF: sub_1001FB10+62j
		test	eax, eax
		jnz	short loc_1001FBA3
		mov	ecx, [esp+24h+arg_8]
		test	ecx, ecx
		jz	short loc_1001FBA3
		mov	edx, [esp+24h+var_1C]
		mov	[ecx], edx

loc_1001FBA3:				; CODE XREF: sub_1001FB10+Cj
					; sub_1001FB10+83j ...
		add	esp, 24h
		retn
sub_1001FB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001FBB0(int,	int, int, void *Src, size_t Size)
sub_1001FBB0	proc near		; DATA XREF: sub_1001FCD0+C5o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Src		= dword	ptr  10h
Size		= dword	ptr  14h

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_8]
		push	edi
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1001FBCB
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001FBCB:				; CODE XREF: sub_1001FBB0+13j
		mov	eax, [esp+8+Size]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	eax, eax
		jz	short loc_1001FBE7
		push	eax		; Size
		mov	eax, [esp+10h+Src]
		push	eax		; Src
		push	esi		; int
		call	sub_1001FA70
		add	esp, 0Ch

loc_1001FBE7:				; CODE XREF: sub_1001FBB0+26j
		push	0
		push	0
		push	edi
		lea	ecx, [esp+18h+arg_8]
		push	ecx
		push	ebx
		push	esi
		call	sub_1001FB10
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jnz	short loc_1001FC7C
		mov	ecx, [esp+0Ch+arg_4]
		push	ebp
		mov	esi, edi
		mov	edx, ebx
		cmp	edi, 4
		jb	short loc_1001FC24
		nop

loc_1001FC10:				; CODE XREF: sub_1001FBB0+72j
		mov	eax, [edx]
		cmp	eax, [ecx]
		jnz	short loc_1001FC28
		sub	esi, 4
		add	ecx, 4
		add	edx, 4
		cmp	esi, 4
		jnb	short loc_1001FC10

loc_1001FC24:				; CODE XREF: sub_1001FBB0+5Dj
		test	esi, esi
		jz	short loc_1001FC6B

loc_1001FC28:				; CODE XREF: sub_1001FBB0+64j
		movzx	eax, byte ptr [edx]
		movzx	ebp, byte ptr [ecx]
		sub	eax, ebp
		jnz	short loc_1001FC63
		cmp	esi, 1
		jbe	short loc_1001FC6B
		movzx	eax, byte ptr [edx+1]
		movzx	ebp, byte ptr [ecx+1]
		sub	eax, ebp
		jnz	short loc_1001FC63
		cmp	esi, 2
		jbe	short loc_1001FC6B
		movzx	eax, byte ptr [edx+2]
		movzx	ebp, byte ptr [ecx+2]
		sub	eax, ebp
		jnz	short loc_1001FC63
		cmp	esi, 3
		jbe	short loc_1001FC6B
		movzx	eax, byte ptr [edx+3]
		movzx	ecx, byte ptr [ecx+3]
		sub	eax, ecx

loc_1001FC63:				; CODE XREF: sub_1001FBB0+80j
					; sub_1001FBB0+91j ...
		sar	eax, 1Fh
		or	eax, 1
		jmp	short loc_1001FC6D
; ---------------------------------------------------------------------------

loc_1001FC6B:				; CODE XREF: sub_1001FBB0+76j
					; sub_1001FBB0+85j ...
		xor	eax, eax

loc_1001FC6D:				; CODE XREF: sub_1001FBB0+B9j
		xor	edx, edx
		test	eax, eax
		setz	dl
		mov	esi, 1
		pop	ebp
		sub	esi, edx

loc_1001FC7C:				; CODE XREF: sub_1001FBB0+4Fj
		push	edi
		push	ebx
		call	PORT_ZFree_Util
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_1001FBB0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001FC90:				; DATA XREF: sub_1001FCD0+D3o
		cmp	dword ptr [esp+8], 0
		jz	short locret_1001FCC0
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+8]
		lea	ecx, [esi+20h]
		cmp	eax, ecx
		jz	short loc_1001FCB3
		mov	edx, [esi+4]
		push	edx
		push	eax
		call	PORT_ZFree_Util
		add	esp, 8

loc_1001FCB3:				; CODE XREF: .text:1001FCA4j
		mov	eax, [esi]
		push	eax
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8
		pop	esi

locret_1001FCC0:			; CODE XREF: .text:1001FC95j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FCD0	proc near		; CODE XREF: sub_10012FD0+72Dp
					; sub_10012FD0+807p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		cmp	[esp+4+arg_8], 10h
		mov	[esp+4+var_4], 2
		jz	short loc_1001FCE6
		mov	eax, 63h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001FCE6:				; CODE XREF: sub_1001FCD0+Dj
		mov	eax, [esp+4+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_0]
		push	11h
		push	eax
		mov	dword ptr [edi+4], 1
		call	sub_10016660
		add	esp, 8
		mov	[esp+14h+arg_8], eax
		test	eax, eax
		jnz	short loc_1001FD10
		xor	ebx, ebx
		jmp	short loc_1001FD13
; ---------------------------------------------------------------------------

loc_1001FD10:				; CODE XREF: sub_1001FCD0+3Aj
		mov	ebx, [eax+1Ch]

loc_1001FD13:				; CODE XREF: sub_1001FCD0+3Ej
		lea	ebp, [ebx+220h]
		push	ebp
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_1001FDAE
		mov	ecx, [esp+14h+arg_4]
		mov	[esi], ebp
		add	ebp, 0FFFFFFE0h
		xor	eax, eax
		mov	[esi+0Ch], ebx
		mov	dword ptr [esi+10h], 0
		mov	[esi+4], ebp
		mov	dword ptr [esi+14h], 0
		mov	edx, [ecx+18h]
		cmp	dword ptr [edx], 3
		mov	ecx, [esp+14h+arg_C]
		setz	al
		mov	[esi+1Ch], ecx
		mov	[esi+18h], eax
		lea	eax, [esi+20h]
		mov	[esi+8], eax
		test	ebx, ebx
		jz	short loc_1001FD7A
		mov	edx, [esp+14h+arg_8]
		mov	ecx, [edx+18h]
		push	ebx		; Size
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001FD7A:				; CODE XREF: sub_1001FCD0+96j
		mov	[edi+40h], esi
		mov	[edi+3Ch], esi
		mov	dword ptr [edi+50h], offset sub_1001FA70
		mov	dword ptr [edi+54h], offset loc_1001FB00
		mov	dword ptr [edi+4Ch], offset sub_1001FB10
		mov	dword ptr [edi+60h], offset sub_1001FBB0
		mov	dword ptr [edi+58h], offset nullsub_1
		mov	dword ptr [edi+5Ch], offset loc_1001FC90
		xor	esi, esi
		jmp	short loc_1001FDB2
; ---------------------------------------------------------------------------

loc_1001FDAE:				; CODE XREF: sub_1001FCD0+56j
		mov	esi, [esp+14h+var_4]

loc_1001FDB2:				; CODE XREF: sub_1001FCD0+DCj
		mov	eax, [esp+14h+arg_8]
		test	eax, eax
		jz	short loc_1001FDC3
		push	eax
		call	sub_10015D70
		add	esp, 4

loc_1001FDC3:				; CODE XREF: sub_1001FCD0+E8j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1001FCD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FDD0	proc near		; CODE XREF: sub_1001FF90+182p
					; sub_1001FF90+1EDp ...

var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
Src		= dword	ptr -8
Size		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 24h
		push	edi
		lea	eax, [esp+28h+var_18]
		push	eax
		mov	eax, [esp+2Ch+arg_10]
		lea	ecx, [esp+2Ch+var_24]
		push	ecx
		mov	ecx, [esp+30h+arg_C]
		xor	edi, edi
		lea	edx, [esp+30h+var_C]
		push	edx
		mov	edx, [esp+34h+arg_8]
		push	edi
		push	edi
		push	eax
		mov	eax, [esp+40h+arg_4]
		push	ecx
		mov	ecx, [esp+44h+arg_0]
		push	edx
		push	eax
		push	ecx
		mov	[esp+50h+Src], edi
		mov	[esp+50h+var_20], edi
		mov	[esp+50h+var_14], edi
		call	sub_10022330
		add	esp, 28h
		test	eax, eax
		jz	short loc_1001FE4F
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	loc_1001FECB
		cmp	eax, 0FFFFE00Ah
		jz	short loc_1001FE45
		xor	edx, edx
		cmp	eax, 0FFFFE013h
		setnz	dl
		pop	edi
		lea	eax, ds:2[edx*4]
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001FE45:				; CODE XREF: sub_1001FDD0+5Dj
		mov	eax, 0C0h
		pop	edi
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001FE4F:				; CODE XREF: sub_1001FDD0+46j
		mov	eax, [esi]
		mov	ecx, [esp+28h+Size]
		cmp	eax, edi
		jz	short loc_1001FE5E
		cmp	[esi+4], ecx
		jnb	short loc_1001FE7A

loc_1001FE5E:				; CODE XREF: sub_1001FDD0+87j
		cmp	[esi+8], edi
		jz	short loc_1001FE6C
		mov	edx, [esi+0Ch]
		cmp	edx, [esp+28h+var_1C]
		jnb	short loc_1001FE7A

loc_1001FE6C:				; CODE XREF: sub_1001FDD0+91j
		cmp	[esi+10h], edi
		jz	short loc_1001FECB
		mov	edx, [esi+14h]
		cmp	edx, [esp+28h+var_10]
		jb	short loc_1001FECB

loc_1001FE7A:				; CODE XREF: sub_1001FDD0+8Cj
					; sub_1001FDD0+9Aj
		push	ecx		; Size
		mov	ecx, [esp+2Ch+Src]
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		mov	edx, [esp+34h+var_1C]
		mov	eax, [esp+34h+var_20]
		mov	ecx, [esi+8]
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+40h+var_10]
		mov	eax, [esp+40h+var_14]
		mov	ecx, [esi+10h]
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esp+4Ch+var_1C]
		mov	edx, [esp+4Ch+Size]
		mov	ecx, [esp+4Ch+var_10]
		add	esp, 24h
		mov	[esi+0Ch], eax
		mov	eax, edi
		mov	[esi+4], edx
		mov	[esi+14h], ecx
		pop	edi
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001FECB:				; CODE XREF: sub_1001FDD0+52j
					; sub_1001FDD0+9Fj ...
		mov	eax, 71h
		pop	edi
		add	esp, 24h
		retn
sub_1001FDD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FEE0	proc near		; CODE XREF: sub_10020210+232p
					; sub_10020210+262p ...

var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 30h
		mov	[esp+30h+var_8], ecx
		mov	ecx, [eax]
		mov	[esp+30h+var_4], edx
		mov	edx, [eax+4]
		mov	[esp+30h+var_14], ecx
		mov	ecx, [eax+8]
		mov	[esp+30h+var_10], edx
		mov	edx, [eax+0Ch]
		mov	[esp+30h+var_20], ecx
		mov	ecx, [eax+10h]
		mov	[esp+30h+var_1C], edx
		mov	edx, [eax+14h]
		mov	[esp+30h+var_2C], ecx
		lea	eax, [esp+30h+var_30]
		push	eax
		mov	[esp+34h+var_28], edx
		lea	ecx, [esp+34h+var_24]
		push	ecx
		mov	ecx, [esp+38h+arg_C]
		lea	edx, [esp+38h+var_18]
		push	edx
		mov	edx, [esp+3Ch+arg_8]
		lea	eax, [esp+3Ch+var_C]
		push	eax
		mov	eax, [esp+40h+arg_4]
		push	ecx
		mov	ecx, [esp+44h+arg_0]
		push	edx
		push	eax
		push	ecx
		call	sub_10022370
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1001FF4B
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1001FF4B:				; CODE XREF: sub_1001FEE0+65j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	short loc_1001FF7C
		cmp	eax, 0FFFFE00Ah
		jz	short loc_1001FF73
		xor	edx, edx
		cmp	eax, 0FFFFE013h
		setnz	dl
		lea	eax, ds:2[edx*4]
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1001FF73:				; CODE XREF: sub_1001FEE0+7Cj
		mov	eax, 0C0h
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1001FF7C:				; CODE XREF: sub_1001FEE0+75j
		mov	eax, 71h
		add	esp, 30h
		retn
sub_1001FEE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FF90	proc near		; CODE XREF: sub_100145A0+400p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= byte ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= byte ptr -94h
var_90		= dword	ptr -90h
var_88		= byte ptr -88h
var_84		= dword	ptr -84h
var_7C		= byte ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= byte ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= byte ptr -60h
var_54		= byte ptr -54h
var_48		= byte ptr -48h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0A8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0A8h+var_4], eax
		push	ebx
		mov	ebx, [esp+0ACh+arg_4]
		push	ebp
		lea	eax, [esp+0B0h+var_60]
		mov	[esp+0B0h+var_20], eax
		push	esi
		mov	esi, [esp+0B4h+arg_8]
		lea	ecx, [esp+0B4h+var_54]
		lea	edx, [esp+0B4h+var_48]
		lea	eax, [esp+0B4h+var_A0]
		mov	[esp+0B4h+var_18], ecx
		mov	[esp+0B4h+var_10], edx
		mov	[esp+0B4h+var_8], eax
		push	edi
		lea	ecx, [esp+0B8h+var_94]
		lea	edx, [esp+0B8h+var_70]
		lea	eax, [esp+0B8h+var_7C]
		push	800h
		mov	[esp+0BCh+var_A4], esi
		mov	[esp+0BCh+var_24], 130h
		mov	[esp+0BCh+var_1C], 131h
		mov	[esp+0BCh+var_14], 132h
		mov	[esp+0BCh+var_C], 0CE53436Ah
		mov	[esp+0BCh+var_3C], 0CE534370h
		mov	[esp+0BCh+var_38], ecx
		mov	[esp+0BCh+var_34], 0CE53436Ch
		mov	[esp+0BCh+var_30], edx
		mov	[esp+0BCh+var_2C], 0CE53436Dh
		mov	[esp+0BCh+var_28], eax
		call	PORT_NewArena_Util
		push	4
		lea	ecx, [esp+0C0h+var_24]
		push	ecx
		mov	ebp, eax
		push	esi
		push	ebp
		mov	[esp+0CCh+var_A8], ebp
		call	sub_100179E0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	loc_100201DD
		cmp	[esp+0B8h+var_9C], eax
		jz	short loc_1002008E
		cmp	[esp+0B8h+var_98], eax
		jnz	short loc_10020098

loc_1002008E:				; CODE XREF: sub_1001FF90+F6j
		mov	edi, 0D0h
		jmp	loc_100201DD
; ---------------------------------------------------------------------------

loc_10020098:				; CODE XREF: sub_1001FF90+FCj
		lea	edx, [esp+0B8h+var_88]
		push	edx
		lea	eax, [esp+0BCh+var_54]
		push	eax
		push	ebp
		mov	[esp+0C4h+var_84], 0
		call	sub_10020D00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100200F4
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	short loc_100200EA
		cmp	eax, 0FFFFE00Ah
		jz	short loc_100200E0
		xor	ecx, ecx
		cmp	eax, 0FFFFE013h
		setnz	cl
		lea	edi, ds:2[ecx*4]
		jmp	loc_100201DD
; ---------------------------------------------------------------------------

loc_100200E0:				; CODE XREF: sub_1001FF90+138j
					; sub_1001FF90+1C4j
		mov	edi, 0C0h
		jmp	loc_100201DD
; ---------------------------------------------------------------------------

loc_100200EA:				; CODE XREF: sub_1001FF90+131j
					; sub_1001FF90+1BDj
		mov	edi, 0D1h
		jmp	loc_100201DD
; ---------------------------------------------------------------------------

loc_100200F4:				; CODE XREF: sub_1001FF90+125j
		mov	ebp, [esp+0B8h+arg_0]
		lea	edx, [esp+0B8h+var_88]
		push	edx
		mov	edx, [esp+0BCh+var_A8]
		lea	eax, [esp+0BCh+var_A0]
		push	eax
		push	ebp
		lea	ecx, [esp+0C4h+var_64]
		push	ecx
		push	edx
		mov	esi, ebx
		call	sub_1001FDD0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	loc_100201DD
		mov	edi, [esp+0B8h+var_A8]
		mov	[esp+0B8h+var_90], eax
		lea	eax, [esp+0B8h+var_94]
		push	eax
		lea	ecx, [esp+0BCh+var_54]
		push	ecx
		push	edi
		call	sub_10020D00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10020169
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	short loc_100200EA
		cmp	eax, 0FFFFE00Ah
		jz	short loc_100200E0
		xor	edx, edx
		cmp	eax, 0FFFFE013h
		setnz	dl
		lea	edi, ds:2[edx*4]
		jmp	short loc_100201DD
; ---------------------------------------------------------------------------

loc_10020169:				; CODE XREF: sub_1001FF90+1B1j
		lea	eax, [esp+0B8h+var_94]
		push	eax
		lea	ecx, [esp+0BCh+var_A0]
		push	ecx
		push	ebp
		lea	edx, [esp+0C4h+var_64]
		push	edx
		lea	esi, [ebx+18h]
		push	edi
		call	sub_1001FDD0
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_100201DD
		mov	eax, [ebx]
		mov	edx, [esi]
		mov	ecx, [ebx+4]
		mov	[esp+0B8h+var_6C], eax
		mov	eax, [ebx+1Ch]
		mov	[esp+0B8h+var_68], ecx
		mov	[esp+0B8h+var_78], edx
		mov	[esp+0B8h+var_74], eax
		xor	esi, esi
		jmp	short loc_100201B0
; ---------------------------------------------------------------------------
		align 10h

loc_100201B0:				; CODE XREF: sub_1001FF90+217j
					; sub_1001FF90+249j
		mov	eax, [esp+esi*8+0B8h+var_38]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [esp+esi*8+0B8h+var_3C]
		push	ecx		; Size
		mov	ecx, [esp+0BCh+var_A4]
		push	edx		; Src
		push	eax		; int
		push	ecx		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10020207
		inc	esi
		cmp	esi, 3
		jb	short loc_100201B0
		xor	edi, edi

loc_100201DD:				; CODE XREF: sub_1001FF90+ECj
					; sub_1001FF90+103j ...
		mov	edx, [esp+0B8h+var_A8]
		push	1
		push	edx
		call	PORT_FreeArena_Util
		mov	ecx, [esp+0C0h+var_4]
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A8h
		retn
; ---------------------------------------------------------------------------

loc_10020207:				; CODE XREF: sub_1001FF90+243j
		mov	edi, eax
		jmp	short loc_100201DD
sub_1001FF90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020210	proc near		; CODE XREF: sub_10010E70+1042p

var_11C		= dword	ptr -11Ch
var_118		= byte ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= byte ptr -10Ch
var_100		= byte ptr -100h
var_FC		= byte ptr -0FCh
Src		= dword	ptr -0F8h
Size		= dword	ptr -0F4h
var_F0		= byte ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= byte ptr -0E4h
var_E0		= dword	ptr -0E0h
var_D8		= byte ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= byte ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C0		= byte ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= byte ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= byte ptr -0A8h
var_9C		= byte ptr -9Ch
var_90		= byte ptr -90h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 11Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+11Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		lea	eax, [esp+12Ch+var_FC]
		mov	[esp+12Ch+var_38], eax
		lea	ecx, [esp+12Ch+var_F0]
		mov	[esp+12Ch+var_30], ecx
		lea	edx, [esp+12Ch+var_E4]
		mov	[esp+12Ch+var_28], edx
		mov	edx, 0CE534370h
		lea	eax, [esp+12Ch+var_10C]
		mov	[esp+12Ch+var_20], eax
		mov	[esp+12Ch+var_1C], edx
		lea	ecx, [esp+12Ch+var_A8]
		mov	[esp+12Ch+var_18], ecx
		lea	ebx, [esp+12Ch+var_90]
		mov	[esp+12Ch+var_8], ebx
		mov	[esp+12Ch+var_6C], edx
		mov	ebp, [esp+12Ch+arg_C]
		mov	ecx, 0CE53436Ch
		lea	eax, [esp+12Ch+var_9C]
		lea	ebx, [esp+12Ch+var_10C]
		lea	edx, [esp+12Ch+var_A8]
		mov	[esp+12Ch+var_14], ecx
		mov	[esp+12Ch+var_10], eax
		mov	[esp+12Ch+var_68], edx
		mov	[esp+12Ch+var_5C], ecx
		mov	esi, [esp+12Ch+arg_8]
		mov	eax, 0CE53436Dh
		mov	[esp+12Ch+var_80], ebx
		lea	ebx, [esp+12Ch+var_FC]
		lea	edx, [esp+12Ch+var_CC]
		lea	ecx, [esp+12Ch+var_9C]
		mov	edi, [esp+12Ch+arg_4]
		mov	[esp+12Ch+var_C], eax
		mov	[esp+12Ch+var_60], edx
		mov	[esp+12Ch+var_58], ecx
		mov	[esp+12Ch+var_54], eax
		mov	[esp+12Ch+var_78], ebx
		lea	edx, [esp+12Ch+var_90]
		lea	eax, [esp+12Ch+var_C0]
		lea	ecx, [esp+12Ch+var_D8]
		lea	ebx, [esp+12Ch+var_F0]
		push	800h
		mov	[esp+130h+var_3C], 130h
		mov	[esp+130h+var_34], 131h
		mov	[esp+130h+var_2C], 132h
		mov	[esp+130h+var_24], 0CE53436Ah
		mov	[esp+130h+var_84], 0CE53436Ah
		mov	[esp+130h+var_7C], 130h
		mov	[esp+130h+var_74], 131h
		mov	[esp+130h+var_70], ebx
		mov	[esp+130h+var_64], 0CE534371h
		mov	[esp+130h+var_50], edx
		mov	[esp+130h+var_4C], 0CE53436Eh
		mov	[esp+130h+var_48], eax
		mov	[esp+130h+var_44], 0CE53436Fh
		mov	[esp+130h+var_40], ecx
		call	PORT_NewArena_Util
		push	7
		lea	edx, [esp+134h+var_3C]
		push	edx
		mov	ebx, eax
		push	esi
		push	ebx
		call	sub_100179E0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10020629
		push	0CE53436Bh
		push	ebp
		lea	eax, [esp+134h+var_118]
		push	eax
		push	ebx
		call	sub_10016AD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10020629
		cmp	[esp+12Ch+var_114], eax
		jz	short loc_100203FA
		cmp	[esp+12Ch+var_110], eax
		jnz	short loc_10020404

loc_100203FA:				; CODE XREF: sub_10020210+1E2j
		mov	esi, 0D0h
		jmp	loc_10020629
; ---------------------------------------------------------------------------

loc_10020404:				; CODE XREF: sub_10020210+1E8j
		lea	ecx, [esp+12Ch+var_118]
		push	ecx
		lea	edx, [esp+130h+var_10C]
		push	edx
		call	SECITEM_CompareItem_Util
		add	esp, 8
		test	eax, eax
		jnz	short loc_10020424
		mov	esi, 0D1h
		jmp	loc_10020629
; ---------------------------------------------------------------------------

loc_10020424:				; CODE XREF: sub_10020210+208j
		mov	edx, [esp+12Ch+arg_0]
		lea	ecx, [esp+12Ch+var_10C]
		push	ecx
		push	edx
		mov	edx, [esp+134h+var_110]
		lea	ecx, [esp+134h+var_100]
		push	ecx
		mov	ecx, [esp+138h+var_114]
		lea	eax, [edi+8]
		push	ebx
		call	sub_1001FEE0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10020629
		mov	ecx, [esp+12Ch+arg_0]
		lea	edx, [esp+12Ch+var_10C]
		push	edx
		push	ecx
		mov	ecx, [esp+134h+var_114]
		lea	edx, [esp+134h+var_100]
		push	edx
		mov	edx, [esp+138h+var_110]
		lea	eax, [edi+20h]
		push	ebx
		call	sub_1001FEE0
		mov	esi, eax
		xor	eax, eax
		add	esp, 10h
		cmp	esi, eax
		jnz	loc_10020629
		mov	ecx, [edi]
		mov	edx, [edi+4]
		mov	[esp+12Ch+var_B0], ecx
		mov	ecx, [edi+8]
		mov	[esp+12Ch+var_AC], edx
		mov	edx, [edi+0Ch]
		mov	[esp+12Ch+var_BC], ecx
		mov	ecx, [edi+20h]
		mov	[esp+12Ch+var_B8], edx
		mov	edx, [edi+24h]
		mov	[esp+12Ch+var_E0], eax
		mov	[esp+12Ch+var_C8], eax
		mov	[esp+12Ch+var_D4], ecx
		lea	eax, [esp+12Ch+var_CC]
		push	eax
		mov	[esp+130h+var_D0], edx
		lea	ecx, [esp+130h+var_B4]
		push	ecx
		lea	edx, [esp+134h+var_A8]
		push	edx
		lea	eax, [esp+138h+var_E4]
		push	eax
		lea	ecx, [esp+13Ch+var_D8]
		push	ecx
		lea	edx, [esp+140h+var_C0]
		push	edx
		lea	eax, [esp+144h+var_9C]
		push	eax
		lea	ecx, [esp+148h+var_F0]
		push	ecx
		lea	edx, [esp+14Ch+var_FC]
		push	edx
		push	ebx
		call	sub_100223B0
		add	esp, 28h
		test	eax, eax
		jz	short loc_1002053A
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	short loc_10020530
		cmp	eax, 0FFFFE00Ah
		jz	short loc_10020526
		xor	ecx, ecx
		cmp	eax, 0FFFFE013h
		setnz	cl
		lea	esi, ds:2[ecx*4]
		jmp	loc_10020629
; ---------------------------------------------------------------------------

loc_10020526:				; CODE XREF: sub_10020210+2FEj
		mov	esi, 0C0h
		jmp	loc_10020629
; ---------------------------------------------------------------------------

loc_10020530:				; CODE XREF: sub_10020210+2F7j
		mov	esi, 71h
		jmp	loc_10020629
; ---------------------------------------------------------------------------

loc_1002053A:				; CODE XREF: sub_10020210+2EBj
		mov	ecx, [esp+12Ch+arg_0]
		lea	edx, [esp+12Ch+var_CC]
		push	edx
		lea	eax, [esp+130h+var_10C]
		push	eax
		push	ecx
		lea	edx, [esp+138h+var_100]
		push	edx
		lea	esi, [edi+38h]
		push	ebx
		call	sub_1001FDD0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10020629
		mov	eax, [esp+12Ch+Size]
		mov	ecx, [esp+12Ch+Src]
		push	eax		; Size
		push	ecx		; Src
		push	130h		; int
		push	ebp		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10020629
		mov	edx, [esp+12Ch+var_E8]
		mov	eax, [esp+12Ch+var_EC]
		push	edx		; Size
		push	eax		; Src
		push	131h		; int
		push	ebp		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10020629
		xor	edi, edi
		lea	ecx, [ecx+0]

loc_100205B0:				; CODE XREF: sub_10020210+3C8j
		mov	eax, [esp+edi*8+12Ch+var_80]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [esp+edi*8+12Ch+var_84]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; int
		push	ebp		; int
		call	sub_10017BD0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10020627
		inc	edi
		cmp	edi, 9
		jb	short loc_100205B0
		push	100h
		push	ebp
		mov	[esp+134h+var_11C], 0CE534353h
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_10020612
		mov	ecx, [eax+18h]
		mov	esi, [ecx]
		sub	esi, [esp+12Ch+var_11C]
		push	eax
		neg	esi
		sbb	esi, esi
		and	esi, 0D1h
		call	sub_10015D70
		add	esp, 4
		jmp	short loc_10020629
; ---------------------------------------------------------------------------

loc_10020612:				; CODE XREF: sub_10020210+3E2j
		push	4		; Size
		lea	edx, [esp+130h+var_11C]
		push	edx		; Src
		push	100h		; int
		push	ebp		; int
		call	sub_10017BD0
		add	esp, 10h

loc_10020627:				; CODE XREF: sub_10020210+3C2j
		mov	esi, eax

loc_10020629:				; CODE XREF: sub_10020210+1BAj
					; sub_10020210+1D8j ...
		push	1
		push	ebx
		call	PORT_FreeArena_Util
		mov	ecx, [esp+134h+var_4]
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 11Ch
		retn
sub_10020210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020650	proc near		; CODE XREF: sub_10010E70+1BA3p

var_F8		= dword	ptr -0F8h
var_F4		= byte ptr -0F4h
Src		= dword	ptr -0F0h
Size		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= byte ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= byte ptr -0D0h
var_CC		= byte ptr -0CCh
var_C0		= byte ptr -0C0h
var_B4		= byte ptr -0B4h
var_B0		= dword	ptr -0B0h
var_A8		= byte ptr -0A8h
var_9C		= byte ptr -9Ch
var_90		= byte ptr -90h
var_84		= byte ptr -84h
var_78		= byte ptr -78h
var_6C		= byte ptr -6Ch
var_60		= byte ptr -60h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0F8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0F8h+var_4], eax
		push	ebx
		mov	ebx, [esp+0FCh+arg_C]
		lea	eax, [esp+0FCh+var_E8]
		mov	[esp+0FCh+var_50], eax
		push	ebp
		lea	ecx, [esp+100h+var_60]
		lea	edx, [esp+100h+var_CC]
		lea	eax, [esp+100h+var_C0]
		mov	[esp+100h+var_48], ecx
		mov	[esp+100h+var_40], edx
		mov	[esp+100h+var_38], eax
		push	esi
		mov	esi, [esp+104h+arg_8]
		lea	ecx, [esp+104h+var_84]
		lea	edx, [esp+104h+var_78]
		lea	eax, [esp+104h+var_A8]
		push	edi
		mov	edi, [esp+108h+arg_4]
		mov	[esp+108h+var_30], ecx
		mov	[esp+108h+var_28], edx
		mov	[esp+108h+var_20], eax
		lea	ecx, [esp+108h+var_6C]
		lea	edx, [esp+108h+var_90]
		lea	eax, [esp+108h+var_9C]
		push	800h
		mov	[esp+10Ch+var_54], 0CE53436Bh
		mov	[esp+10Ch+var_4C], 0CE53436Ah
		mov	[esp+10Ch+var_44], 130h
		mov	[esp+10Ch+var_3C], 131h
		mov	[esp+10Ch+var_34], 0CE534370h
		mov	[esp+10Ch+var_2C], 0CE534371h
		mov	[esp+10Ch+var_24], 0CE53436Ch
		mov	[esp+10Ch+var_1C], 0CE53436Dh
		mov	[esp+10Ch+var_18], ecx
		mov	[esp+10Ch+var_14], 0CE53436Eh
		mov	[esp+10Ch+var_10], edx
		mov	[esp+10Ch+var_C], 0CE53436Fh
		mov	[esp+10Ch+var_8], eax
		call	PORT_NewArena_Util
		push	0Ah
		lea	ecx, [esp+110h+var_54]
		push	ecx
		mov	ebp, eax
		push	esi
		push	ebp
		call	sub_100179E0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_10020915
		push	eax
		push	eax
		push	eax
		mov	[esp+114h+var_B0], eax
		lea	edx, [esp+114h+var_B4]
		push	edx
		lea	eax, [esp+118h+var_90]
		push	eax
		lea	ecx, [esp+11Ch+var_6C]
		push	ecx
		lea	edx, [esp+120h+var_A8]
		push	edx
		lea	eax, [esp+124h+var_C0]
		push	eax
		lea	ecx, [esp+128h+var_CC]
		push	ecx
		push	ebp
		call	sub_100223B0
		add	esp, 28h
		test	eax, eax
		jz	short loc_10020804
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	short loc_100207FA
		cmp	eax, 0FFFFE00Ah
		jz	short loc_100207F0
		xor	edx, edx
		cmp	eax, 0FFFFE013h
		setnz	dl
		lea	esi, ds:2[edx*4]
		jmp	loc_10020915
; ---------------------------------------------------------------------------

loc_100207F0:				; CODE XREF: sub_10020650+188j
					; sub_10020650+242j
		mov	esi, 0C0h
		jmp	loc_10020915
; ---------------------------------------------------------------------------

loc_100207FA:				; CODE XREF: sub_10020650+181j
					; sub_10020650+237j
		mov	esi, 71h
		jmp	loc_10020915
; ---------------------------------------------------------------------------

loc_10020804:				; CODE XREF: sub_10020650+175j
		mov	ecx, [esp+108h+arg_0]
		lea	eax, [esp+108h+var_60]
		push	eax
		push	ecx
		mov	ecx, [esp+110h+var_E4]
		lea	edx, [esp+110h+var_D0]
		push	edx
		mov	edx, [esp+114h+var_E0]
		push	ebp
		mov	eax, edi
		call	sub_1001FEE0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_10020915
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[esp+108h+var_D8], eax
		lea	edx, [esp+108h+var_F4]
		push	edx
		mov	[esp+10Ch+var_D4], ecx
		lea	eax, [esp+10Ch+var_DC]
		push	eax
		lea	ecx, [esp+110h+var_78]
		push	ecx
		lea	edx, [esp+114h+var_9C]
		push	edx
		lea	eax, [esp+118h+var_84]
		push	eax
		lea	ecx, [esp+11Ch+var_C0]
		push	ecx
		lea	edx, [esp+120h+var_CC]
		push	edx
		push	ebp
		mov	[esp+128h+Src],	esi
		call	sub_100223F0
		add	esp, 20h
		test	eax, eax
		jz	short loc_100208AB
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE005h
		jz	loc_100207FA
		cmp	eax, 0FFFFE00Ah
		jz	loc_100207F0
		xor	ecx, ecx
		cmp	eax, 0FFFFE013h
		setnz	cl
		lea	esi, ds:2[ecx*4]
		jmp	short loc_10020915
; ---------------------------------------------------------------------------

loc_100208AB:				; CODE XREF: sub_10020650+22Bj
		mov	edx, [esp+108h+Size]
		mov	eax, [esp+108h+Src]
		push	edx		; Size
		push	eax		; Src
		push	11h		; int
		push	ebx		; int
		call	sub_10017BD0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10020915
		push	100h
		push	ebx
		mov	[esp+110h+var_F8], 10h
		call	sub_10016660
		add	esp, 8
		test	eax, eax
		jz	short loc_100208FE
		mov	ecx, [eax+18h]
		mov	esi, [ecx]
		sub	esi, [esp+108h+var_F8]
		push	eax
		neg	esi
		sbb	esi, esi
		and	esi, 0D1h
		call	sub_10015D70
		add	esp, 4
		jmp	short loc_10020915
; ---------------------------------------------------------------------------

loc_100208FE:				; CODE XREF: sub_10020650+28Ej
		push	4		; Size
		lea	edx, [esp+10Ch+var_F8]
		push	edx		; Src
		push	100h		; int
		push	ebx		; int
		call	sub_10017BD0
		add	esp, 10h
		mov	esi, eax

loc_10020915:				; CODE XREF: sub_10020650+139j
					; sub_10020650+19Bj ...
		push	1
		push	ebp
		call	PORT_FreeArena_Util
		mov	ecx, [esp+110h+var_4]
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
sub_10020650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10020940(char	*Str)
sub_10020940	proc near		; CODE XREF: sub_100209F0+25p

var_4		= dword	ptr -4
Str		= dword	ptr  4

		sub	esp, 0Ch
		push	ebp
		mov	ebp, [esp+10h+Str]
		push	esi
		push	edi
		xor	esi, esi
		call	ds:PR_GetDirectorySeparator
		movsx	eax, al
		push	eax		; Ch
		push	ebp		; Str
		call	ds:strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_100209E2
		sub	eax, ebp
		lea	edi, [eax+1]
		mov	eax, ebx
		lea	edx, [eax+1]
		mov	edi, edi

loc_10020970:				; CODE XREF: sub_10020940+35j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10020970
		sub	eax, edx
		lea	ecx, [eax+edi+1]
		push	ecx
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100209D9
		push	edi		; Size
		push	ebp		; Src
		push	esi		; Dst
		call	memcpy
		lea	edx, [edi+esi]
		add	esp, 0Ch
		mov	eax, ebx
		sub	edx, ebx
		mov	edi, edi

loc_100209A0:				; CODE XREF: sub_10020940+68j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_100209A0
		mov	edx, [esp+18h+var_4]
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], esi
		mov	[eax+8], edx
		call	ds:PR_LoadLibraryWithFlags
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100209D9:				; CODE XREF: sub_10020940+4Aj
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100209E2:				; CODE XREF: sub_10020940+22j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
sub_10020940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100209F0	proc near		; CODE XREF: sub_10020A60+22p
					; DATA XREF: sub_100209F0+Bo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, off_1002922C
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		push	offset sub_100209F0
		push	eax
		call	ds:PR_GetLibraryFilePathname
		mov	ebx, [esp+20h+arg_0]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10020A2A
		push	esi		; Str
		call	sub_10020940
		push	esi
		mov	edi, eax
		call	ds:PR_Free
		add	esp, 8
		test	edi, edi
		jnz	short loc_10020A4F

loc_10020A2A:				; CODE XREF: sub_100209F0+22j
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		call	ds:PR_LoadLibraryWithFlags
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10020A4F:				; CODE XREF: sub_100209F0+38j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
sub_100209F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020A60	proc near		; DATA XREF: sub_10020B00+9o
					; sub_10020B40+9o ...
		mov	eax, off_10029228
		push	edi
		mov	edi, eax
		test	eax, eax
		jnz	short loc_10020A80
		push	eax
		push	0FFFFE8A7h
		call	ds:PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10020A80:				; CODE XREF: sub_10020A60+Aj
		push	esi
		push	eax
		call	sub_100209F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10020AEC
		push	offset aFreebl_getvect ; "FREEBL_GetVector"
		push	esi
		call	ds:PR_FindFunctionSymbol
		add	esp, 8
		test	eax, eax
		jz	short loc_10020AE2
		call	eax
		test	eax, eax
		jz	short loc_10020AE2
		movzx	ecx, word ptr [eax+2]
		mov	edx, ecx
		and	edx, 0FF00h
		cmp	edx, 300h
		jnz	short loc_10020AE2
		cmp	cl, 11h
		jb	short loc_10020AE2
		mov	edx, 348h
		cmp	[eax], dx
		jb	short loc_10020AE2
		mov	dword_10029688,	esi
		pop	esi
		mov	dword_1002968C,	eax
		mov	dword_10029690,	edi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10020AE2:				; CODE XREF: sub_10020A60+41j
					; sub_10020A60+47j ...
		push	esi
		call	ds:PR_UnloadLibrary
		add	esp, 4

loc_10020AEC:				; CODE XREF: sub_10020A60+2Ej
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_10020A60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020B00	proc near		; CODE XREF: sub_1000B0B0+43p
		cmp	dword_1002968C,	0
		jnz	short loc_10020B24
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020B24
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020B24:				; CODE XREF: sub_10020B00+7j
					; sub_10020B00+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+28Ch]
		jmp	ecx
sub_10020B00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020B40	proc near		; CODE XREF: sub_10014FA0+600p
		cmp	dword_1002968C,	0
		jnz	short loc_10020B63
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020B63
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10020B63:				; CODE XREF: sub_10020B40+7j
					; sub_10020B40+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+4]
		jmp	eax
sub_10020B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020B70	proc near		; CODE XREF: sub_10002BB0+93p
		cmp	dword_1002968C,	0
		jnz	short loc_10020B94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020B94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020B94:				; CODE XREF: sub_10020B70+7j
					; sub_10020B70+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+8]
		jmp	ecx
sub_10020B70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020BA0	proc near		; CODE XREF: sub_10002BB0+E3p
		cmp	dword_1002968C,	0
		jnz	short loc_10020BC4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020BC4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020BC4:				; CODE XREF: sub_10020BA0+7j
					; sub_10020BA0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+0Ch]
		jmp	ecx
sub_10020BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020BD0	proc near		; CODE XREF: sub_10007890+16Cp
		cmp	dword_1002968C,	0
		jnz	short loc_10020BF4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020BF4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020BF4:				; CODE XREF: sub_10020BD0+7j
					; sub_10020BD0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+124h]
		jmp	edx
sub_10020BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020C10	proc near		; CODE XREF: sub_10014FA0+3F9p
		cmp	dword_1002968C,	0
		jnz	short loc_10020C34
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020C34
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020C34:				; CODE XREF: sub_10020C10+7j
					; sub_10020C10+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+10h]
		jmp	eax
sub_10020C10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020C40	proc near		; CODE XREF: sub_1000E850+36p
		cmp	dword_1002968C,	0
		jnz	short loc_10020C64
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020C64
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020C64:				; CODE XREF: sub_10020C40+7j
					; sub_10020C40+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+14h]
		jmp	ecx
sub_10020C40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020C70	proc near		; CODE XREF: sub_100031B0+D6p
					; sub_1000E810+34p
		cmp	dword_1002968C,	0
		jnz	short loc_10020C94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020C94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020C94:				; CODE XREF: sub_10020C70+7j
					; sub_10020C70+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+18h]
		jmp	ecx
sub_10020C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020CA0	proc near		; CODE XREF: sub_100031B0+1Cp
		cmp	dword_1002968C,	0
		jnz	short loc_10020CC4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020CC4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020CC4:				; CODE XREF: sub_10020CA0+7j
					; sub_10020CA0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+1Ch]
		jmp	ecx
sub_10020CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020CD0	proc near		; CODE XREF: sub_100031B0+94p
		cmp	dword_1002968C,	0
		jnz	short loc_10020CF4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020CF4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020CF4:				; CODE XREF: sub_10020CD0+7j
					; sub_10020CD0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+20h]
		jmp	edx
sub_10020CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020D00	proc near		; CODE XREF: sub_1001FF90+11Bp
					; sub_1001FF90+1A7p
		cmp	dword_1002968C,	0
		jnz	short loc_10020D24
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020D24
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020D24:				; CODE XREF: sub_10020D00+7j
					; sub_10020D00+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+2A8h]
		jmp	ecx
sub_10020D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020D40	proc near		; CODE XREF: sub_10014FA0+885p
		cmp	dword_1002968C,	0
		jnz	short loc_10020D64
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020D64
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020D64:				; CODE XREF: sub_10020D40+7j
					; sub_10020D40+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+28h]
		jmp	eax
sub_10020D40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020D70	proc near		; CODE XREF: sub_10010E70+2F7p
		cmp	dword_1002968C,	0
		jnz	short loc_10020D94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020D94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020D94:				; CODE XREF: sub_10020D70+7j
					; sub_10020D70+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+2Ch]
		jmp	eax
sub_10020D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020DA0	proc near		; CODE XREF: sub_10001D00+16p
					; sub_10001D00+A2p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020DC3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020DC3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10020DC3:				; CODE XREF: sub_10020DA0+7j
					; sub_10020DA0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+38h]
		jmp	eax
sub_10020DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020DD0	proc near		; CODE XREF: sub_10001D00+56p
					; sub_10001D00+E2p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020DF0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10020DFB

loc_10020DF0:				; CODE XREF: sub_10020DD0+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+3Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10020DFB:			; CODE XREF: sub_10020DD0+1Ej
		retn
sub_10020DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020E00	proc near		; CODE XREF: sub_10001D00+4Cp
					; sub_100064E0+88p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020E24
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020E24
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020E24:				; CODE XREF: sub_10020E00+7j
					; sub_10020E00+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+40h]
		jmp	ecx
sub_10020E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020E30	proc near		; CODE XREF: sub_10001D00+D8p
					; DATA XREF: sub_100064E0+6Eo ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020E54
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020E54
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020E54:				; CODE XREF: sub_10020E30+7j
					; sub_10020E30+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+44h]
		jmp	ecx
sub_10020E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020E60	proc near		; CODE XREF: sub_10001AB0+1Cp
					; sub_10001AB0+A8p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020E83
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020E83
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10020E83:				; CODE XREF: sub_10020E60+7j
					; sub_10020E60+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+48h]
		jmp	eax
sub_10020E60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020E90	proc near		; CODE XREF: sub_10001AB0+60p
					; sub_10001AB0+D6p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020EB0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10020EBB

loc_10020EB0:				; CODE XREF: sub_10020E90+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+4Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10020EBB:			; CODE XREF: sub_10020E90+1Ej
		retn
sub_10020E90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020EC0	proc near		; CODE XREF: sub_10001AB0+56p
					; sub_10001AB0+14Fp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020EE4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020EE4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020EE4:				; CODE XREF: sub_10020EC0+7j
					; sub_10020EC0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+50h]
		jmp	ecx
sub_10020EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020EF0	proc near		; CODE XREF: sub_10001AB0+CCp
					; sub_10001AB0+1E2p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020F14
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020F14
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020F14:				; CODE XREF: sub_10020EF0+7j
					; sub_10020EF0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+54h]
		jmp	ecx
sub_10020EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020F20	proc near		; CODE XREF: sub_10001E40+1Ap
					; sub_10001E40+A6p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020F43
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020F43
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10020F43:				; CODE XREF: sub_10020F20+7j
					; sub_10020F20+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+68h]
		jmp	edx
sub_10020F20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020F50	proc near		; CODE XREF: sub_10001E40+5Ep
					; sub_10001E40+D4p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020F70
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10020F7B

loc_10020F70:				; CODE XREF: sub_10020F50+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+6Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10020F7B:			; CODE XREF: sub_10020F50+1Ej
		retn
sub_10020F50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020F80	proc near		; CODE XREF: sub_10001E40+54p
					; sub_10001E40+14Dp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020FA4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020FA4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020FA4:				; CODE XREF: sub_10020F80+7j
					; sub_10020F80+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+70h]
		jmp	ecx
sub_10020F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020FB0	proc near		; CODE XREF: sub_10001E40+CAp
					; sub_10001E40+1E0p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10020FD4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10020FD4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10020FD4:				; CODE XREF: sub_10020FB0+7j
					; sub_10020FB0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+74h]
		jmp	ecx
sub_10020FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020FE0	proc near		; CODE XREF: sub_1000C4C0+67Dp
		cmp	dword_1002968C,	0
		jnz	short loc_10021003
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021003
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021003:				; CODE XREF: sub_10020FE0+7j
					; sub_10020FE0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+27Ch]
		jmp	edx
sub_10020FE0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10021020:				; DATA XREF: sub_1000C4C0+6A9o
		cmp	dword_1002968C,	0
		jnz	short loc_10021040
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002104E

loc_10021040:				; CODE XREF: .text:10021027j
		mov	edx, dword_1002968C
		mov	eax, [edx+280h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002104E:			; CODE XREF: .text:1002103Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10021050:				; DATA XREF: sub_1000C4C0+698o
		cmp	dword_1002968C,	0
		jnz	short loc_10021074
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021074
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021074:				; CODE XREF: .text:10021057j
					; .text:1002106Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+284h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10021090:				; DATA XREF: sub_1000C4C0+6A1o
		cmp	dword_1002968C,	0
		jnz	short loc_100210B4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100210B4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100210B4:				; CODE XREF: .text:10021097j
					; .text:100210AEj
		mov	eax, dword_1002968C
		mov	ecx, [eax+288h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100210D0	proc near		; CODE XREF: sub_100022E0+35p
					; sub_100022E0+104p ...
		cmp	dword_1002968C,	0
		jnz	short loc_100210F3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100210F3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100210F3:				; CODE XREF: sub_100210D0+7j
					; sub_100210D0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+78h]
		jmp	ecx
sub_100210D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021100	proc near		; CODE XREF: sub_100022E0+B3p
					; sub_100022E0+130p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021120
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002112B

loc_10021120:				; CODE XREF: sub_10021100+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+7Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002112B:			; CODE XREF: sub_10021100+1Ej
		retn
sub_10021100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021130	proc near		; CODE XREF: sub_100022E0+A9p
					; sub_100022E0+1ABp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021154
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021154
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021154:				; CODE XREF: sub_10021130+7j
					; sub_10021130+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+80h]
		jmp	ecx
sub_10021130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021170	proc near		; CODE XREF: sub_100022E0+126p
					; sub_100022E0+23Ap
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021194
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021194
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021194:				; CODE XREF: sub_10021170+7j
					; sub_10021170+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+84h]
		jmp	ecx
sub_10021170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100211B0	proc near		; CODE XREF: sub_10002640+1Ap
					; sub_10010E70+845p
		cmp	dword_1002968C,	0
		jnz	short loc_100211D4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100211D4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100211D4:				; CODE XREF: sub_100211B0+7j
					; sub_100211B0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+8Ch]
		jmp	ecx
sub_100211B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100211F0	proc near		; CODE XREF: sub_1000D6D0:loc_1000D7D8p
					; sub_1000DC50p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021213
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021213
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021213:				; CODE XREF: sub_100211F0+7j
					; sub_100211F0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+90h]
		jmp	ecx
sub_100211F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021220	proc near		; CODE XREF: sub_10010E70+1B3Bp
					; DATA XREF: sub_1000D6D0+133o	...
		cmp	dword_1002968C,	0
		jnz	short loc_10021240
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002124E

loc_10021240:				; CODE XREF: sub_10021220+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+94h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002124E:			; CODE XREF: sub_10021220+1Ej
		retn
sub_10021220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021250	proc near		; CODE XREF: sub_1000D6D0+146p
					; sub_1000DC50+28p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021270
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002127E

loc_10021270:				; CODE XREF: sub_10021250+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+98h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002127E:			; CODE XREF: sub_10021250+1Ej
		retn
sub_10021250	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021280	proc near		; CODE XREF: sub_10010E70+12F5p
					; sub_10010E70+130Ep ...
		cmp	dword_1002968C,	0
		jnz	short loc_100212A0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100212AD

loc_100212A0:				; CODE XREF: sub_10021280+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+9Ch]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100212AD:			; CODE XREF: sub_10021280+1Ej
		retn
sub_10021280	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100212B0	proc near		; CODE XREF: sub_10010E70+1320p
					; sub_10010E70+16FCp ...
		cmp	dword_1002968C,	0
		jnz	short loc_100212D0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100212DE

loc_100212D0:				; CODE XREF: sub_100212B0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0A0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100212DE:			; CODE XREF: sub_100212B0+1Ej
		retn
sub_100212B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100212E0	proc near		; CODE XREF: sub_1000D6D0+113p
		cmp	dword_1002968C,	0
		jnz	short loc_10021303
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021303
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021303:				; CODE XREF: sub_100212E0+7j
					; sub_100212E0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0A4h]
		jmp	edx
sub_100212E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021320	proc near		; CODE XREF: sub_10002590+Fp
					; sub_1000D6D0:loc_1000D775p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021343
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021343
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021343:				; CODE XREF: sub_10021320+7j
					; sub_10021320+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+0B8h]
		jmp	ecx
sub_10021320	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021350	proc near		; CODE XREF: sub_10002590+55p
					; sub_10010E70+806p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021370
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002137E

loc_10021370:				; CODE XREF: sub_10021350+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+0BCh]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002137E:			; CODE XREF: sub_10021350+1Ej
		retn
sub_10021350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021380	proc near		; CODE XREF: sub_10002590+2Ep
					; sub_1000D6D0+E3p ...
		cmp	dword_1002968C,	0
		jnz	short loc_100213A0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100213AE

loc_100213A0:				; CODE XREF: sub_10021380+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0C0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100213AE:			; CODE XREF: sub_10021380+1Ej
		retn
sub_10021380	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100213B0	proc near		; CODE XREF: sub_10002590+3Bp
					; sub_10010E70+7E9p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_100213D0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100213DD

loc_100213D0:				; CODE XREF: sub_100213B0+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+0C4h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100213DD:			; CODE XREF: sub_100213B0+1Ej
		retn
sub_100213B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100213E0	proc near		; CODE XREF: sub_10002590+4Dp
					; sub_10010E70+7FEp
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021400
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002140E

loc_10021400:				; CODE XREF: sub_100213E0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0C8h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002140E:			; CODE XREF: sub_100213E0+1Ej
		retn
sub_100213E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021410	proc near		; CODE XREF: sub_1000D6D0+B0p
		cmp	dword_1002968C,	0
		jnz	short loc_10021433
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021433
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021433:				; CODE XREF: sub_10021410+7j
					; sub_10021410+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0CCh]
		jmp	edx
sub_10021410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021450	proc near		; CODE XREF: sub_10002A50+1Ap
					; sub_10002F40+14Bp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021474
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021474
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021474:				; CODE XREF: sub_10021450+7j
					; sub_10021450+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+0DCh]
		jmp	ecx
sub_10021450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021490	proc near		; CODE XREF: sub_1000D6D0:loc_1000D81Dp
					; sub_1000DC90p ...
		cmp	dword_1002968C,	0
		jnz	short loc_100214B3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100214B3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100214B3:				; CODE XREF: sub_10021490+7j
					; sub_10021490+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+0E0h]
		jmp	ecx
sub_10021490	endp


; =============== S U B	R O U T	I N E =======================================


sub_100214C0	proc near		; CODE XREF: sub_10010E70+1B47p
					; sub_1001E6C0+84p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_100214E0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100214EE

loc_100214E0:				; CODE XREF: sub_100214C0+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+0E4h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_100214EE:			; CODE XREF: sub_100214C0+1Ej
		retn
sub_100214C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100214F0	proc near		; CODE XREF: sub_1000D6D0+18Fp
					; sub_1000DC90+28p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021510
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002151E

loc_10021510:				; CODE XREF: sub_100214F0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0E8h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002151E:			; CODE XREF: sub_100214F0+1Ej
		retn
sub_100214F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021520	proc near		; CODE XREF: sub_10010E70+12AEp
					; sub_10010E70+12BCp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021540
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002154D

loc_10021540:				; CODE XREF: sub_10021520+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+0ECh]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_1002154D:			; CODE XREF: sub_10021520+1Ej
		retn
sub_10021520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021550	proc near		; CODE XREF: sub_10010E70+12E1p
					; sub_10010E70+16BAp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021570
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002157E

loc_10021570:				; CODE XREF: sub_10021550+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0F0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002157E:			; CODE XREF: sub_10021550+1Ej
		retn
sub_10021550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021580	proc near		; CODE XREF: sub_1000D6D0+158p
		cmp	dword_1002968C,	0
		jnz	short loc_100215A3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100215A3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100215A3:				; CODE XREF: sub_10021580+7j
					; sub_10021580+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+0F8h]
		jmp	edx
sub_10021580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100215C0	proc near		; CODE XREF: sub_1000B0B0:loc_1000B0EAp
		cmp	dword_1002968C,	0
		jnz	short loc_100215E4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100215E4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100215E4:				; CODE XREF: sub_100215C0+7j
					; sub_100215C0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+104h]
		jmp	ecx
sub_100215C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021600	proc near		; CODE XREF: sub_1000F560+Ap
		cmp	dword_1002968C,	0
		jnz	short loc_10021624
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021624
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021624:				; CODE XREF: sub_10021600+7j
					; sub_10021600+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+108h]
		jmp	eax
sub_10021600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021640	proc near		; CODE XREF: sub_1000F590+Ap
					; sub_100145A0+3A7p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021664
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021664
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021664:				; CODE XREF: sub_10021640+7j
					; sub_10021640+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+10Ch]
		jmp	eax
sub_10021640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021680	proc near		; CODE XREF: sub_1000B270+4Fp
					; sub_1000B300+3Dp
		cmp	dword_1002968C,	0
		jnz	short loc_100216A0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100216AD

loc_100216A0:				; CODE XREF: sub_10021680+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+110h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100216AD:			; CODE XREF: sub_10021680+1Ej
		retn
sub_10021680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100216B0	proc near		; CODE XREF: sub_1000F6D0+106p
		cmp	dword_1002968C,	0
		jnz	short loc_100216D4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100216D4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100216D4:				; CODE XREF: sub_100216B0+7j
					; sub_100216B0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+114h]
		jmp	ecx
sub_100216B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100216F0	proc near		; CODE XREF: sub_1000F6D0+155p
		cmp	dword_1002968C,	0
		jnz	short loc_10021714
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021714
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021714:				; CODE XREF: sub_100216F0+7j
					; sub_100216F0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+118h]
		jmp	edx
sub_100216F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021730	proc near		; CODE XREF: sub_10007070+146p
		cmp	dword_1002968C,	0
		jnz	short loc_10021754
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021754
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021754:				; CODE XREF: sub_10021730+7j
					; sub_10021730+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+11Ch]
		jmp	ecx
sub_10021730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021770	proc near		; CODE XREF: sub_1000F6D0+249p
		cmp	dword_1002968C,	0
		jnz	short loc_10021790
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002179E

loc_10021790:				; CODE XREF: sub_10021770+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+26Ch]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002179E:			; CODE XREF: sub_10021770+1Ej
		retn
sub_10021770	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100217A0	proc near		; CODE XREF: sub_1000F6D0+25Ap
		cmp	dword_1002968C,	0
		jnz	short loc_100217C0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100217CE

loc_100217C0:				; CODE XREF: sub_100217A0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+270h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100217CE:			; CODE XREF: sub_100217A0+1Ej
		retn
sub_100217A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100217D0	proc near		; CODE XREF: sub_1000B270+54p
					; sub_1000B300+42p
		cmp	dword_1002968C,	0
		jnz	short loc_100217F0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100217FD

loc_100217F0:				; CODE XREF: sub_100217D0+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+128h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100217FD:			; CODE XREF: sub_100217D0+1Ej
		retn
sub_100217D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021800	proc near		; CODE XREF: sub_1000B270+60p
					; sub_1000B300+4Ep
		cmp	dword_10029688,	0
		mov	dword_1002968C,	0
		jz	short loc_1002183E
		push	offset aNss_disable_un ; "NSS_DISABLE_UNLOAD"
		call	ds:PR_GetEnv
		add	esp, 4
		test	eax, eax
		jnz	short loc_10021834
		mov	eax, dword_10029688
		push	eax
		call	ds:PR_UnloadLibrary
		add	esp, 4

loc_10021834:				; CODE XREF: sub_10021800+23j
		mov	dword_10029688,	0

loc_1002183E:				; CODE XREF: sub_10021800+11j
		mov	ecx, ds:dword_10027EA8
		mov	edx, ds:dword_10027EAC
		mov	eax, ds:dword_10027EB0
		mov	dword_1002967C,	ecx
		mov	dword_10029680,	edx
		mov	dword_10029684,	eax
		retn
sub_10021800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021870	proc near		; CODE XREF: sub_10002A50+96p
					; sub_10002BB0+12Cp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021894
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021894
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021894:				; CODE XREF: sub_10021870+7j
					; sub_10021870+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+140h]
		jmp	ecx
sub_10021870	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100218B0	proc near		; CODE XREF: sub_1000D6D0:loc_1000D8B5p
					; sub_1000DD10p
		cmp	dword_1002968C,	0
		jnz	short loc_100218D3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100218D3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100218D3:				; CODE XREF: sub_100218B0+7j
					; sub_100218B0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+12Ch]
		jmp	ecx
sub_100218B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100218E0	proc near		; DATA XREF: sub_1000D6D0+210o
					; sub_1000DD10+16o
		cmp	dword_1002968C,	0
		jnz	short loc_10021900
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002190E

loc_10021900:				; CODE XREF: sub_100218E0+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+130h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002190E:			; CODE XREF: sub_100218E0+1Ej
		retn
sub_100218E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021910	proc near		; CODE XREF: sub_1000D6D0+227p
					; sub_1000DD10+28p
		cmp	dword_1002968C,	0
		jnz	short loc_10021930
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002193E

loc_10021930:				; CODE XREF: sub_10021910+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+134h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002193E:			; CODE XREF: sub_10021910+1Ej
		retn
sub_10021910	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10021940:				; DATA XREF: sub_1000D6D0+202o
					; sub_1000DD10+8o
		cmp	dword_1002968C,	0
		jnz	short loc_10021960
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002196D

loc_10021960:				; CODE XREF: .text:10021947j
		mov	eax, dword_1002968C
		mov	ecx, [eax+138h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_1002196D:			; CODE XREF: .text:1002195Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10021970:				; DATA XREF: sub_1000D6D0+209o
					; sub_1000DD10+Fo
		cmp	dword_1002968C,	0
		jnz	short loc_10021990
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002199E

loc_10021990:				; CODE XREF: .text:10021977j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+13Ch]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002199E:			; CODE XREF: .text:1002198Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100219A0	proc near		; CODE XREF: sub_1000D6D0+1F0p
		cmp	dword_1002968C,	0
		jnz	short loc_100219C3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100219C3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100219C3:				; CODE XREF: sub_100219A0+7j
					; sub_100219A0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+14Ch]
		jmp	edx
sub_100219A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100219E0	proc near		; CODE XREF: sub_10002A50+112p
					; sub_10002BB0+289p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021A04
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021A04
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021A04:				; CODE XREF: sub_100219E0+7j
					; sub_100219E0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+16Ch]
		jmp	ecx
sub_100219E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021A20	proc near		; CODE XREF: sub_1000D6D0:loc_1000D94Dp
					; sub_1000DD90p
		cmp	dword_1002968C,	0
		jnz	short loc_10021A43
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021A43
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021A43:				; CODE XREF: sub_10021A20+7j
					; sub_10021A20+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+158h]
		jmp	ecx
sub_10021A20	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021A50	proc near		; DATA XREF: sub_1000D6D0+2A8o
					; sub_1000DD90+16o
		cmp	dword_1002968C,	0
		jnz	short loc_10021A70
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021A7E

loc_10021A70:				; CODE XREF: sub_10021A50+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+15Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10021A7E:			; CODE XREF: sub_10021A50+1Ej
		retn
sub_10021A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021A80	proc near		; CODE XREF: sub_1000D6D0+2BFp
					; sub_1000DD90+28p
		cmp	dword_1002968C,	0
		jnz	short loc_10021AA0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021AAE

loc_10021AA0:				; CODE XREF: sub_10021A80+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+160h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_10021AAE:			; CODE XREF: sub_10021A80+1Ej
		retn
sub_10021A80	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10021AB0:				; DATA XREF: sub_1000D6D0+29Ao
					; sub_1000DD90+8o
		cmp	dword_1002968C,	0
		jnz	short loc_10021AD0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021ADD

loc_10021AD0:				; CODE XREF: .text:10021AB7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+164h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_10021ADD:			; CODE XREF: .text:10021ACEj
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10021AE0:				; DATA XREF: sub_1000D6D0+2A1o
					; sub_1000DD90+Fo
		cmp	dword_1002968C,	0
		jnz	short loc_10021B00
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021B0E

loc_10021B00:				; CODE XREF: .text:10021AE7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+168h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_10021B0E:			; CODE XREF: .text:10021AFEj
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021B10	proc near		; CODE XREF: sub_1000D6D0+288p
		cmp	dword_1002968C,	0
		jnz	short loc_10021B33
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021B33
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021B33:				; CODE XREF: sub_10021B10+7j
					; sub_10021B10+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+178h]
		jmp	edx
sub_10021B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021B50	proc near		; CODE XREF: sub_10002A50+D6p
					; sub_10002BB0+1D9p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021B74
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021B74
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021B74:				; CODE XREF: sub_10021B50+7j
					; sub_10021B50+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+198h]
		jmp	ecx
sub_10021B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021B90	proc near		; CODE XREF: sub_1000D6D0:loc_1000D901p
					; sub_1000DD50p
		cmp	dword_1002968C,	0
		jnz	short loc_10021BB3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021BB3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021BB3:				; CODE XREF: sub_10021B90+7j
					; sub_10021B90+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+184h]
		jmp	ecx
sub_10021B90	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021BC0	proc near		; DATA XREF: sub_1000D6D0+25Co
					; sub_1000DD50+16o
		cmp	dword_1002968C,	0
		jnz	short loc_10021BE0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021BEE

loc_10021BE0:				; CODE XREF: sub_10021BC0+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+188h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10021BEE:			; CODE XREF: sub_10021BC0+1Ej
		retn
sub_10021BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021BF0	proc near		; CODE XREF: sub_1000D6D0+273p
					; sub_1000DD50+28p
		cmp	dword_1002968C,	0
		jnz	short loc_10021C10
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021C1E

loc_10021C10:				; CODE XREF: sub_10021BF0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+18Ch]
		jmp	edx
; ---------------------------------------------------------------------------

locret_10021C1E:			; CODE XREF: sub_10021BF0+1Ej
		retn
sub_10021BF0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10021C20:				; DATA XREF: sub_1000D6D0+24Eo
					; sub_1000DD50+8o
		cmp	dword_1002968C,	0
		jnz	short loc_10021C40
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021C4D

loc_10021C40:				; CODE XREF: .text:10021C27j
		mov	eax, dword_1002968C
		mov	ecx, [eax+190h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_10021C4D:			; CODE XREF: .text:10021C3Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10021C50:				; DATA XREF: sub_1000D6D0+255o
					; sub_1000DD50+Fo
		cmp	dword_1002968C,	0
		jnz	short loc_10021C70
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021C7E

loc_10021C70:				; CODE XREF: .text:10021C57j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+194h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_10021C7E:			; CODE XREF: .text:10021C6Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021C80	proc near		; CODE XREF: sub_1000D6D0+23Cp
		cmp	dword_1002968C,	0
		jnz	short loc_10021CA3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021CA3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021CA3:				; CODE XREF: sub_10021C80+7j
					; sub_10021C80+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+1A4h]
		jmp	edx
sub_10021C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021CC0	proc near		; CODE XREF: sub_1000C4C0+7C5p
		cmp	dword_1002968C,	0
		jnz	short loc_10021CE3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021CE3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021CE3:				; CODE XREF: sub_10021CC0+7j
					; sub_10021CC0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+1B0h]
		jmp	edx
sub_10021CC0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10021D00:				; DATA XREF: sub_1000C4C0+7F1o
		cmp	dword_1002968C,	0
		jnz	short loc_10021D20
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10021D2E

loc_10021D20:				; CODE XREF: .text:10021D07j
		mov	edx, dword_1002968C
		mov	eax, [edx+1B4h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10021D2E:			; CODE XREF: .text:10021D1Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10021D30:				; DATA XREF: sub_1000C4C0+7E0o
		cmp	dword_1002968C,	0
		jnz	short loc_10021D54
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021D54
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021D54:				; CODE XREF: .text:10021D37j
					; .text:10021D4Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+1B8h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10021D70:				; DATA XREF: sub_1000C4C0+7E9o
		cmp	dword_1002968C,	0
		jnz	short loc_10021D94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021D94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021D94:				; CODE XREF: .text:10021D77j
					; .text:10021D8Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+1BCh]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021DB0	proc near		; CODE XREF: sub_10003390-26p
					; sub_10004DD0+2Cp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021DD3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021DD3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021DD3:				; CODE XREF: sub_10021DB0+7j
					; sub_10021DB0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+1C0h]
		jmp	eax
sub_10021DB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021DF0	proc near		; CODE XREF: sub_10003390-3Cp

arg_0		= dword	ptr  4

		cmp	dword_1002968C,	0
		jnz	short loc_10021E13
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021E13
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10021E13:				; CODE XREF: sub_10021DF0+7j
					; sub_10021DF0+1Ej
		mov	eax, dword_10029690
		mov	ecx, dword_1002968C
		mov	edx, [ecx+1C4h]
		mov	[esp+arg_0], eax
		jmp	edx
sub_10021DF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021E30	proc near		; CODE XREF: sub_10014FA0+A44p
		cmp	dword_1002968C,	0
		jnz	short loc_10021E54
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021E54
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021E54:				; CODE XREF: sub_10021E30+7j
					; sub_10021E30+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+1C8h]
		jmp	eax
sub_10021E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021E70	proc near		; CODE XREF: sub_10002F40+7Ap
		cmp	dword_1002968C,	0
		jnz	short loc_10021E94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021E94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021E94:				; CODE XREF: sub_10021E70+7j
					; sub_10021E70+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+1CCh]
		jmp	edx
sub_10021E70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021EB0	proc near		; CODE XREF: sub_10002F40+10Cp
					; sub_10002F40+12Ap ...
		cmp	dword_1002968C,	0
		jnz	short loc_10021ED4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021ED4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021ED4:				; CODE XREF: sub_10021EB0+7j
					; sub_10021EB0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+1D0h]
		jmp	eax
sub_10021EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021EF0	proc near		; CODE XREF: sub_10010E70+B60p
		cmp	dword_1002968C,	0
		jnz	short loc_10021F14
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021F14
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021F14:				; CODE XREF: sub_10021EF0+7j
					; sub_10021EF0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+1D4h]
		jmp	eax
sub_10021EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021F30	proc near		; CODE XREF: sub_1000E920+36p
		cmp	dword_1002968C,	0
		jnz	short loc_10021F54
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021F54
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021F54:				; CODE XREF: sub_10021F30+7j
					; sub_10021F30+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+1D8h]
		jmp	ecx
sub_10021F30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021F70	proc near		; CODE XREF: sub_10002F40+227p
					; sub_1000E8E0+34p
		cmp	dword_1002968C,	0
		jnz	short loc_10021F94
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021F94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021F94:				; CODE XREF: sub_10021F70+7j
					; sub_10021F70+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+1DCh]
		jmp	ecx
sub_10021F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021FB0	proc near		; CODE XREF: sub_10002F40+1B4p
		cmp	dword_1002968C,	0
		jnz	short loc_10021FD4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10021FD4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021FD4:				; CODE XREF: sub_10021FB0+7j
					; sub_10021FB0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+1E0h]
		jmp	eax
sub_10021FB0	endp

; ---------------------------------------------------------------------------
		align 20h

; =============== S U B	R O U T	I N E =======================================


sub_10022000	proc near		; CODE XREF: sub_10010E70+1222p
					; sub_10010E70+1602p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022024
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022024
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022024:				; CODE XREF: sub_10022000+7j
					; sub_10022000+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+224h]
		jmp	eax
sub_10022000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022040	proc near		; CODE XREF: sub_100026B0+Fp
					; sub_10002740+63p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022063
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022063
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10022063:				; CODE XREF: sub_10022040+7j
					; sub_10022040+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+228h]
		jmp	edx
sub_10022040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022080	proc near		; CODE XREF: sub_100026B0+74p
					; sub_10002740+BCp ...
		cmp	dword_1002968C,	0
		jnz	short loc_100220A0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100220AE

loc_100220A0:				; CODE XREF: sub_10022080+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+244h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_100220AE:			; CODE XREF: sub_10022080+1Ej
		retn
sub_10022080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100220B0	proc near		; CODE XREF: sub_100026B0+31p
					; sub_10002740+7Fp ...
		cmp	dword_1002968C,	0
		jnz	short loc_100220D3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100220D3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100220D3:				; CODE XREF: sub_100220B0+7j
					; sub_100220B0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+22Ch]
		jmp	edx
sub_100220B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100220F0	proc near		; CODE XREF: sub_100026B0+47p
					; sub_10002740+92p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022110
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002211E

loc_10022110:				; CODE XREF: sub_100220F0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+234h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002211E:			; CODE XREF: sub_100220F0+1Ej
		retn
sub_100220F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022120	proc near		; CODE XREF: sub_100026B0+57p
					; sub_10002740+9Fp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022140
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002214D

loc_10022140:				; CODE XREF: sub_10022120+7j
		mov	eax, dword_1002968C
		mov	ecx, [eax+238h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_1002214D:			; CODE XREF: sub_10022120+1Ej
		retn
sub_10022120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022150	proc near		; CODE XREF: sub_100026B0+6Ap
					; sub_10002740+B2p ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022174
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022174
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022174:				; CODE XREF: sub_10022150+7j
					; sub_10022150+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+240h]
		jmp	edx
sub_10022150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022190	proc near		; CODE XREF: sub_100032D0+25p
		cmp	dword_1002968C,	0
		jnz	short loc_100221B4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100221B4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100221B4:				; CODE XREF: sub_10022190+7j
					; sub_10022190+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+250h]
		jmp	ecx
sub_10022190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100221D0	proc near		; CODE XREF: sub_1000C4C0+5E0p
		cmp	dword_1002968C,	0
		jnz	short loc_100221F3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100221F3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100221F3:				; CODE XREF: sub_100221D0+7j
					; sub_100221D0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+25Ch]
		jmp	eax
sub_100221D0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022210:				; DATA XREF: sub_1000C4C0+60Co
		cmp	dword_1002968C,	0
		jnz	short loc_10022230
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002223E

loc_10022230:				; CODE XREF: .text:10022217j
		mov	edx, dword_1002968C
		mov	eax, [edx+260h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002223E:			; CODE XREF: .text:1002222Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10022240:				; DATA XREF: sub_1000C4C0+5FBo
		cmp	dword_1002968C,	0
		jnz	short loc_10022264
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022264
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022264:				; CODE XREF: .text:10022247j
					; .text:1002225Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+264h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022280:				; DATA XREF: sub_1000C4C0+604o
		cmp	dword_1002968C,	0
		jnz	short loc_100222A4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100222A4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100222A4:				; CODE XREF: .text:10022287j
					; .text:1002229Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+268h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100222C0	proc near		; CODE XREF: sub_1000B270+7p
					; sub_1000B270+5Bp ...
		cmp	dword_1002968C,	0
		jnz	short loc_100222E0
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100222EE

loc_100222E0:				; CODE XREF: sub_100222C0+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+290h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100222EE:			; CODE XREF: sub_100222C0+1Ej
		retn
sub_100222C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100222F0	proc near		; CODE XREF: sub_10007890+155p
		cmp	dword_1002968C,	0
		jnz	short loc_10022314
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022314
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022314:				; CODE XREF: sub_100222F0+7j
					; sub_100222F0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2A4h]
		jmp	edx
sub_100222F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022330	proc near		; CODE XREF: sub_1001FDD0+3Cp
		cmp	dword_1002968C,	0
		jnz	short loc_10022354
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022354
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022354:				; CODE XREF: sub_10022330+7j
					; sub_10022330+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2ACh]
		jmp	edx
sub_10022330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022370	proc near		; CODE XREF: sub_1001FEE0+5Bp
		cmp	dword_1002968C,	0
		jnz	short loc_10022394
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022394
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022394:				; CODE XREF: sub_10022370+7j
					; sub_10022370+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+2B0h]
		jmp	eax
sub_10022370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100223B0	proc near		; CODE XREF: sub_10020210+2E1p
					; sub_10020650+16Bp
		cmp	dword_1002968C,	0
		jnz	short loc_100223D4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100223D4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100223D4:				; CODE XREF: sub_100223B0+7j
					; sub_100223B0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2B4h]
		jmp	edx
sub_100223B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100223F0	proc near		; CODE XREF: sub_10020650+221p
		cmp	dword_1002968C,	0
		jnz	short loc_10022414
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022414
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022414:				; CODE XREF: sub_100223F0+7j
					; sub_100223F0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+2B8h]
		jmp	eax
sub_100223F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022430	proc near		; CODE XREF: sub_10010E70+11FFp
					; sub_10010E70+15DFp ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022454
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022454
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022454:				; CODE XREF: sub_10022430+7j
					; sub_10022430+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+2BCh]
		jmp	ecx
sub_10022430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022470	proc near		; CODE XREF: sub_10002A50+57p
					; sub_10010E70+9A2p
					; DATA XREF: ...
		cmp	dword_1002968C,	0
		jnz	short loc_10022494
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022494
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022494:				; CODE XREF: sub_10022470+7j
					; sub_10022470+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+2D4h]
		jmp	ecx
sub_10022470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100224B0	proc near		; CODE XREF: sub_1000D6D0:loc_1000D869p
					; sub_1000DCD0p
		cmp	dword_1002968C,	0
		jnz	short loc_100224D3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100224D3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100224D3:				; CODE XREF: sub_100224B0+7j
					; sub_100224B0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+2C0h]
		jmp	ecx
sub_100224B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100224E0	proc near		; DATA XREF: sub_1000D6D0+1C4o
					; sub_1000DCD0+16o
		cmp	dword_1002968C,	0
		jnz	short loc_10022500
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002250E

loc_10022500:				; CODE XREF: sub_100224E0+7j
		mov	edx, dword_1002968C
		mov	eax, [edx+2C4h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002250E:			; CODE XREF: sub_100224E0+1Ej
		retn
sub_100224E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022510	proc near		; CODE XREF: sub_1000D6D0+1DBp
					; sub_1000DCD0+28p
		cmp	dword_1002968C,	0
		jnz	short loc_10022530
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002253E

loc_10022530:				; CODE XREF: sub_10022510+7j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2C8h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002253E:			; CODE XREF: sub_10022510+1Ej
		retn
sub_10022510	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022540:				; DATA XREF: sub_1000D6D0+1B6o
					; sub_1000DCD0+8o
		cmp	dword_1002968C,	0
		jnz	short loc_10022560
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002256D

loc_10022560:				; CODE XREF: .text:10022547j
		mov	eax, dword_1002968C
		mov	ecx, [eax+2CCh]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_1002256D:			; CODE XREF: .text:1002255Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10022570:				; DATA XREF: sub_1000D6D0+1BDo
					; sub_1000DCD0+Fo
		cmp	dword_1002968C,	0
		jnz	short loc_10022590
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002259E

loc_10022590:				; CODE XREF: .text:10022577j
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2D0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002259E:			; CODE XREF: .text:1002258Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100225A0	proc near		; CODE XREF: sub_1000D6D0+1A4p
		cmp	dword_1002968C,	0
		jnz	short loc_100225C3
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100225C3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100225C3:				; CODE XREF: sub_100225A0+7j
					; sub_100225A0+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+2E0h]
		jmp	edx
sub_100225A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100225E0	proc near		; CODE XREF: sub_1000F6D0+13Cp
		cmp	dword_1002968C,	0
		jnz	short loc_10022604
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022604
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022604:				; CODE XREF: sub_100225E0+7j
					; sub_100225E0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+2F4h]
		jmp	eax
sub_100225E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022620	proc near		; CODE XREF: sub_100032D0+Ep
		cmp	dword_1002968C,	0
		jnz	short loc_10022644
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022644
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022644:				; CODE XREF: sub_10022620+7j
					; sub_10022620+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+2F8h]
		jmp	ecx
sub_10022620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022660	proc near		; CODE XREF: .text:1001D7B9p
		cmp	dword_1002968C,	0
		jnz	short loc_10022684
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022684
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022684:				; CODE XREF: sub_10022660+7j
					; sub_10022660+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+300h]
		jmp	eax
sub_10022660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100226A0	proc near		; CODE XREF: .text:1001D769p
		cmp	dword_1002968C,	0
		jnz	short loc_100226C4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100226C4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100226C4:				; CODE XREF: sub_100226A0+7j
					; sub_100226A0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+2FCh]
		jmp	eax
sub_100226A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100226E0	proc near		; CODE XREF: .text:1000E749p
		cmp	dword_1002968C,	0
		jnz	short loc_10022704
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022704
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022704:				; CODE XREF: sub_100226E0+7j
					; sub_100226E0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+304h]
		jmp	ecx
sub_100226E0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022720:				; CODE XREF: .text:1000EF12j
		cmp	dword_1002968C,	0
		jnz	short loc_10022744
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022744
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022744:				; CODE XREF: .text:10022727j
					; .text:1002273Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+308h]
		jmp	eax
; ---------------------------------------------------------------------------
		align 10h

loc_10022760:				; CODE XREF: .text:1000F2A2j
		cmp	dword_1002968C,	0
		jnz	short loc_10022784
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022784
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022784:				; CODE XREF: .text:10022767j
					; .text:1002277Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+30Ch]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100227A0	proc near		; CODE XREF: .text:1000C239p
		cmp	dword_1002968C,	0
		jnz	short loc_100227C4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100227C4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100227C4:				; CODE XREF: sub_100227A0+7j
					; sub_100227A0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+310h]
		jmp	ecx
sub_100227A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100227E0	proc near		; CODE XREF: .text:1000C2A9p
		cmp	dword_1002968C,	0
		jnz	short loc_10022804
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022804
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022804:				; CODE XREF: sub_100227E0+7j
					; sub_100227E0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+314h]
		jmp	ecx
sub_100227E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022820	proc near		; CODE XREF: .text:1000C41Fp
		cmp	dword_1002968C,	0
		jnz	short loc_10022844
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022844
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022844:				; CODE XREF: sub_10022820+7j
					; sub_10022820+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+318h]
		jmp	ecx
sub_10022820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022860	proc near		; CODE XREF: .text:1000C48Bp
		cmp	dword_1002968C,	0
		jnz	short loc_10022884
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022884
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022884:				; CODE XREF: sub_10022860+7j
					; sub_10022860+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+31Ch]
		jmp	edx
sub_10022860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100228A0	proc near		; CODE XREF: .text:1000C319p
		cmp	dword_1002968C,	0
		jnz	short loc_100228C4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100228C4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100228C4:				; CODE XREF: sub_100228A0+7j
					; sub_100228A0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+320h]
		jmp	ecx
sub_100228A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100228E0	proc near		; CODE XREF: .text:1000C389p
		cmp	dword_1002968C,	0
		jnz	short loc_10022904
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022904
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022904:				; CODE XREF: sub_100228E0+7j
					; sub_100228E0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+324h]
		jmp	ecx
sub_100228E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022920	proc near		; CODE XREF: .text:1000E7D9p
		cmp	dword_1002968C,	0
		jnz	short loc_10022944
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022944
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022944:				; CODE XREF: sub_10022920+7j
					; sub_10022920+1Ej
		mov	ecx, dword_1002968C
		mov	edx, [ecx+328h]
		jmp	edx
sub_10022920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022960	proc near		; CODE XREF: .text:1000EF72p
		cmp	dword_1002968C,	0
		jnz	short loc_10022984
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022984
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022984:				; CODE XREF: sub_10022960+7j
					; sub_10022960+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+32Ch]
		jmp	eax
sub_10022960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100229A0	proc near		; CODE XREF: sub_1000E5E0+7Ap
					; .text:1000E6D9p
		cmp	dword_1002968C,	0
		jnz	short loc_100229C4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100229C4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100229C4:				; CODE XREF: sub_100229A0+7j
					; sub_100229A0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+330h]
		jmp	ecx
sub_100229A0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100229E0:				; CODE XREF: .text:1000EEE2j
		cmp	dword_1002968C,	0
		jnz	short loc_10022A04
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022A04
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022A04:				; CODE XREF: .text:100229E7j
					; .text:100229FEj
		mov	edx, dword_1002968C
		mov	eax, [edx+334h]
		jmp	eax
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022A20	proc near		; CODE XREF: sub_1000EE00+50p
					; .text:1000F272j
		cmp	dword_1002968C,	0
		jnz	short loc_10022A44
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022A44
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022A44:				; CODE XREF: sub_10022A20+7j
					; sub_10022A20+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+338h]
		jmp	ecx
sub_10022A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022A60	proc near		; CODE XREF: sub_100072C0+1D8p
					; sub_100075B0+226p
		cmp	dword_1002968C,	0
		jnz	short loc_10022A84
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022A84
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022A84:				; CODE XREF: sub_10022A60+7j
					; sub_10022A60+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+33Ch]
		jmp	ecx
sub_10022A60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022AA0	proc near		; CODE XREF: sub_10002F40+43p
					; sub_10014FA0+A0Ep
		cmp	dword_1002968C,	0
		jnz	short loc_10022AC4
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022AC4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022AC4:				; CODE XREF: sub_10022AA0+7j
					; sub_10022AA0+1Ej
		mov	edx, dword_1002968C
		mov	eax, [edx+340h]
		jmp	eax
sub_10022AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022AE0	proc near		; CODE XREF: sub_10002F40+C2p
		cmp	dword_1002968C,	0
		jnz	short loc_10022B04
		push	offset sub_10020A60
		push	offset dword_1002967C
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022B04
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022B04:				; CODE XREF: sub_10022AE0+7j
					; sub_10022AE0+1Ej
		mov	eax, dword_1002968C
		mov	ecx, [eax+344h]
		jmp	ecx
sub_10022AE0	endp

; ---------------------------------------------------------------------------
		align 2
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_free]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_file_control]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_mprintf]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_exec]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_close]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_busy_timeout]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_open]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_finalize]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_reset]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_bind_blob]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_prepare_v2]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_column_int]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_step]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_column_blob]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_column_bytes]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_bind_int]
; [00000006 BYTES: COLLAPSED FUNCTION sqlite3_bind_text]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_FreeArena_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Free_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Alloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_SetError_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_Get_SECOID_AlgorithmIDTemplate_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_Get_SEC_ObjectIDTemplate_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_Get_SEC_BitStringTemplate_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_Get_SEC_AnyTemplate_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_CopyItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ArenaZAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_NewArena_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_FreeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ZAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_ZfreeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ZFree_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_AllocItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_DupItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_DestroyAlgorithmID_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_CopyAlgorithmID_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_SetAlgorithmID_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SEC_ASN1EncodeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SEC_ASN1EncodeInteger_Util]
; [00000006 BYTES: COLLAPSED FUNCTION DER_GetInteger_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SEC_ASN1DecodeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_GetAlgorithmTag_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Realloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ArenaGrow_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SEC_QuickDERDecodeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_Get_SEC_OctetStringTemplate_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ArenaAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION DER_SetUInteger]
; [00000006 BYTES: COLLAPSED FUNCTION _NSSUTIL_GetSecmodName]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_GetError_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_DoModuleDBFunction]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_HashCompare]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_Init]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_Shutdown]
; [00000006 BYTES: COLLAPSED FUNCTION UTIL_SetForkState]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_DestroyDigestInfo_Util]
; [00000006 BYTES: COLLAPSED FUNCTION DER_Encode_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_CreateDigestInfo_Util]
; [00000006 BYTES: COLLAPSED FUNCTION _SGN_VerifyPKCS1DigestInfo]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_FindOIDByMechanism]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Strdup_Util]
; [00000006 BYTES: COLLAPSED FUNCTION _NSSUTIL_EvaluateConfigDir]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgHasFlag]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgSkipParameter]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgFetchValue]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgStrip]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgIsBlank]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgDecodeNumber]
; [00000006 BYTES: COLLAPSED FUNCTION NSSUTIL_ArgGetLabel]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_CompareItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PL_strcasecmp]
; [00000006 BYTES: COLLAPSED FUNCTION PL_strncasecmp]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableLookupConst]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableAdd]
; [00000006 BYTES: COLLAPSED FUNCTION PL_NewHashTable]
; [00000006 BYTES: COLLAPSED FUNCTION PL_CompareValues]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableDestroy]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableLookup]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableRemove]
; [00000006 BYTES: COLLAPSED FUNCTION PL_HashTableEnumerateEntries]
; [00000010 BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]
; [00000006 BYTES: COLLAPSED FUNCTION memset]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 10h
; [0000002B BYTES: COLLAPSED FUNCTION __alloca_probe]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022D40	proc near		; CODE XREF: sub_10022DD0+2Dp
					; .text:10022E26p ...

var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+0Ch+arg_0]
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_8]
		push	ebp
		push	edx
		push	eax
		push	ecx
		push	ecx
		push	offset sub_10022DD0
		push	large dword ptr	fs:0
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_20], eax
		mov	large fs:0, esp

loc_10022D72:				; CODE XREF: sub_10022D40+64j
					; sub_10022D40+80j
		mov	eax, [esp+28h+arg_4]
		mov	ebx, [eax+8]
		mov	ecx, [esp+28h+arg_0]
		xor	ebx, [ecx]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFEh
		jz	short loc_10022DC2
		mov	edx, [esp+28h+arg_8]
		cmp	edx, 0FFFFFFFEh
		jz	short loc_10022D94
		cmp	esi, edx
		jbe	short loc_10022DC2

loc_10022D94:				; CODE XREF: sub_10022D40+4Ej
		lea	esi, [esi+esi*2]
		lea	ebx, [ebx+esi*4+10h]
		mov	ecx, [ebx]
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_10022D72
		push	101h
		mov	eax, [ebx+8]
		call	sub_10023611
		mov	ecx, 1
		mov	eax, [ebx+8]
		call	sub_10023630
		jmp	short loc_10022D72
; ---------------------------------------------------------------------------

loc_10022DC2:				; CODE XREF: sub_10022D40+45j
					; sub_10022D40+52j
		pop	large dword ptr	fs:0
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10022D40	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022DD0	proc near		; DATA XREF: sub_10022D40+14o
					; .rdata:___safe_se_handler_tableo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_10022E15
		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		xor	ecx, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		push	ebp
		mov	ebp, [eax+18h]
		push	dword ptr [eax+0Ch]
		push	dword ptr [eax+10h]
		push	dword ptr [eax+14h]
		call	sub_10022D40
		add	esp, 0Ch
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_10022E15:			; CODE XREF: sub_10022DD0+10j
		retn
sub_10022DD0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		push	dword ptr [ecx+1Ch]
		push	dword ptr [ecx+18h]
		push	dword ptr [ecx+28h]
		call	sub_10022D40
		add	esp, 0Ch
		pop	ebp
		retn	4

; =============== S U B	R O U T	I N E =======================================


sub_10022E32	proc near		; CODE XREF: sub_10022EA0+89p
		push	ebp
		push	esi
		push	edi
		push	ebx
		mov	ebp, edx
		xor	eax, eax
		xor	ebx, ebx
		xor	edx, edx
		xor	esi, esi
		xor	edi, edi
		call	ecx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10022E32	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022E49	proc near		; CODE XREF: sub_10022EA0+15Ep
		mov	ebp, edx
		mov	esi, ecx
		mov	eax, ecx
		push	1
		call	sub_10023611
		xor	eax, eax
		xor	ebx, ebx
		xor	ecx, ecx
		xor	edx, edx
		xor	edi, edi
		jmp	esi
sub_10022E49	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10022E62(PVOID TargetFrame)
sub_10022E62	proc near		; CODE XREF: sub_10022EA0+112p
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	0		; ReturnValue
		push	0		; ExceptionRecord
		push	offset loc_10022E77 ; TargetIp
		push	ecx		; TargetFrame
		call	RtlUnwind

loc_10022E77:				; DATA XREF: sub_10022E62+Ao
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10022E62	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022E7C	proc near		; CODE XREF: sub_10022EA0+128p
					; sub_10022EA0+178p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		call	sub_10022D40
		add	esp, 0Ch
		pop	ebp
		retn	8
sub_10022E7C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022EA0(int,	int, int, PVOID	TargetFrame, int)
sub_10022EA0	proc near		; CODE XREF: sub_100237A1+1Bp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
TargetFrame	= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+TargetFrame]
		push	esi
		mov	esi, [ebx+8]
		xor	esi, [eax]
		push	edi
		mov	eax, [esi]
		mov	[ebp+var_1], 0
		mov	[ebp+var_C], 1
		lea	edi, [ebx+10h]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10022ED6
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10022ED6:				; CODE XREF: sub_10022EA0+29j
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+arg_8]
		test	byte ptr [eax+4], 66h
		jnz	loc_10023003
		lea	ecx, [ebp+var_18]
		mov	[ebx-4], ecx
		mov	ebx, [ebx+0Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_14], eax
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_10022F68
		jmp	short loc_10022F10
; ---------------------------------------------------------------------------
		align 10h

loc_10022F10:				; CODE XREF: sub_10022EA0+68j
					; sub_10022EA0+A0j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+edx*4+14h]
		lea	eax, [esi+edx*4+10h]
		mov	[ebp+var_10], eax
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_10022F3B
		mov	edx, edi
		call	sub_10022E32
		mov	[ebp+var_1], 1
		test	eax, eax
		jl	short loc_10022F72
		jg	short loc_10022F7B
		mov	eax, [ebp+var_8]

loc_10022F3B:				; CODE XREF: sub_10022EA0+85j
		mov	ebx, eax
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10022F10
		cmp	[ebp+var_1], 0
		jz	short loc_10022F68

loc_10022F48:				; CODE XREF: sub_10022EA0+D9j
					; sub_10022EA0+17Dj
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10022F5A
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10022F5A:				; CODE XREF: sub_10022EA0+ADj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]

loc_10022F68:				; CODE XREF: sub_10022EA0+66j
					; sub_10022EA0+A6j ...
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10022F72:				; CODE XREF: sub_10022EA0+94j
		mov	[ebp+var_C], 0
		jmp	short loc_10022F48
; ---------------------------------------------------------------------------

loc_10022F7B:				; CODE XREF: sub_10022EA0+96j
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0E06D7363h
		jnz	short loc_10022FAF
		cmp	dword_100299D8,	0
		jz	short loc_10022FAF
		push	offset dword_100299D8
		call	sub_100236C4
		add	esp, 4
		test	eax, eax
		jz	short loc_10022FAF
		mov	ecx, [ebp+arg_8]
		push	1
		push	ecx
		call	dword_100299D8
		add	esp, 8

loc_10022FAF:				; CODE XREF: sub_10022EA0+E4j
					; sub_10022EA0+EDj ...
		mov	ecx, [ebp+TargetFrame] ; TargetFrame
		call	sub_10022E62
		mov	eax, [ebp+TargetFrame]
		cmp	[eax+0Ch], ebx
		jz	short loc_10022FD0
		mov	edx, [ebp+arg_0]
		push	edx
		push	edi
		mov	edx, ebx
		mov	ecx, eax
		call	sub_10022E7C
		mov	eax, [ebp+TargetFrame]

loc_10022FD0:				; CODE XREF: sub_10022EA0+11Dj
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], ecx
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10022FE8
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10022FE8:				; CODE XREF: sub_10022EA0+13Bj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	edx, edi
		call	sub_10022E49

loc_10023003:				; CODE XREF: sub_10022EA0+4Bj
		mov	edx, 0FFFFFFFEh
		cmp	[ebx+0Ch], edx
		jz	loc_10022F68
		mov	ecx, [ebp+arg_0]
		push	ecx
		push	edi
		mov	ecx, ebx
		call	sub_10022E7C
		jmp	loc_10022F48
sub_10022EA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023022	proc near		; CODE XREF: sub_10023270+Cp
					; sub_100232B2+Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0E06D7363h
		cmp	[ebp+arg_0], eax
		jnz	short loc_1002303E
		push	[ebp+arg_4]
		push	eax
		call	_XcptFilter
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1002303E:				; CODE XREF: sub_10023022+Dj
		xor	eax, eax
		pop	ebp
		retn
sub_10023022	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023042	proc near		; CODE XREF: sub_10023088+A5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		jmp	short loc_1002305E
; ---------------------------------------------------------------------------

loc_1002304F:				; CODE XREF: sub_10023042+1Fj
		test	eax, eax
		jnz	short loc_10023063
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_1002305B
		call	ecx

loc_1002305B:				; CODE XREF: sub_10023042+15j
		add	esi, 4

loc_1002305E:				; CODE XREF: sub_10023042+Bj
		cmp	esi, [ebp+arg_4]
		jb	short loc_1002304F

loc_10023063:				; CODE XREF: sub_10023042+Fj
		pop	esi
		pop	ebp
		retn
sub_10023042	endp


; =============== S U B	R O U T	I N E =======================================


sub_10023066	proc near		; DATA XREF: .rdata:10024250o
		push	80h		; Size
		call	ds:malloc
		pop	ecx
		mov	Memory,	eax
		mov	dword_100299C8,	eax
		test	eax, eax
		jnz	short loc_10023082
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10023082:				; CODE XREF: sub_10023066+18j
		and	dword ptr [eax], 0
		xor	eax, eax
		retn
sub_10023066	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023088	proc near		; CODE XREF: DllEntryPoint-1C3p
					; DllEntryPoint-109p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		xor	eax, eax
		push	esi
		push	edi
		cmp	[ebp+arg_4], eax
		jnz	short loc_100230BD
		cmp	dword_10029694,	eax
		jle	short loc_100230B6
		dec	dword_10029694
		mov	edi, ds:InterlockedCompareExchange
		push	eax
		mov	esi, offset Target
		jmp	loc_1002319B
; ---------------------------------------------------------------------------

loc_100230B6:				; CODE XREF: sub_10023088+15j
					; sub_10023088+AEj
		xor	eax, eax
		jmp	loc_10023208
; ---------------------------------------------------------------------------

loc_100230BD:				; CODE XREF: sub_10023088+Dj
		cmp	[ebp+arg_4], 1
		jnz	loc_10023205
		mov	ecx, large fs:18h
		mov	ebx, [ecx+4]
		mov	edi, ds:InterlockedCompareExchange
		mov	[ebp+arg_4], eax
		push	eax
		mov	esi, offset Target
		jmp	short loc_100230F3
; ---------------------------------------------------------------------------

loc_100230E2:				; CODE XREF: sub_10023088+71j
		cmp	eax, ebx
		jz	short loc_100230FD
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_100230F3:				; CODE XREF: sub_10023088+58j
		push	ebx		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_100230E2
		jmp	short loc_10023104
; ---------------------------------------------------------------------------

loc_100230FD:				; CODE XREF: sub_10023088+5Cj
		mov	[ebp+arg_4], 1

loc_10023104:				; CODE XREF: sub_10023088+73j
		mov	eax, dword_100299C0
		push	2
		pop	edi
		test	eax, eax
		jz	short loc_10023119
		push	1Fh
		call	_amsg_exit
		jmp	short loc_10023152
; ---------------------------------------------------------------------------

loc_10023119:				; CODE XREF: sub_10023088+86j
		push	offset dword_10024254
		push	offset dword_1002424C
		mov	dword_100299C0,	1
		call	sub_10023042
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	loc_100230B6
		push	offset dword_10024248
		push	offset dword_10024244
		call	_initterm
		pop	ecx
		mov	dword_100299C0,	edi

loc_10023152:				; CODE XREF: sub_10023088+8Fj
		xor	ebx, ebx
		pop	ecx
		cmp	[ebp+arg_4], ebx
		jnz	short loc_10023162
		push	ebx		; Value
		push	esi		; Target
		call	ds:InterlockedExchange

loc_10023162:				; CODE XREF: sub_10023088+D0j
		cmp	dword_100299D4,	ebx
		jz	short loc_10023186
		push	offset dword_100299D4
		call	sub_100236C4
		pop	ecx
		test	eax, eax
		jz	short loc_10023186
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_100299D4

loc_10023186:				; CODE XREF: sub_10023088+E0j
					; sub_10023088+EFj
		inc	dword_10029694
		jmp	short loc_10023205
; ---------------------------------------------------------------------------

loc_1002318E:				; CODE XREF: sub_10023088+11Aj
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_1002319B:				; CODE XREF: sub_10023088+29j
		push	1		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_1002318E
		mov	eax, dword_100299C0
		cmp	eax, 2
		jz	short loc_100231B8
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	short loc_10023205
; ---------------------------------------------------------------------------

loc_100231B8:				; CODE XREF: sub_10023088+124j
		mov	ebx, Memory
		test	ebx, ebx
		jz	short loc_100231F2
		mov	edi, dword_100299C8
		add	edi, 0FFFFFFFCh
		jmp	short loc_100231D8
; ---------------------------------------------------------------------------

loc_100231CD:				; CODE XREF: sub_10023088+152j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_100231D5
		call	eax

loc_100231D5:				; CODE XREF: sub_10023088+149j
		sub	edi, 4

loc_100231D8:				; CODE XREF: sub_10023088+143j
		cmp	edi, ebx
		jnb	short loc_100231CD
		push	ebx		; Memory
		call	ds:free
		and	dword_100299C8,	0
		and	Memory,	0
		pop	ecx

loc_100231F2:				; CODE XREF: sub_10023088+138j
		push	0		; Value
		push	esi		; Target
		mov	dword_100299C0,	0
		call	ds:InterlockedExchange

loc_10023205:				; CODE XREF: sub_10023088+39j
					; sub_10023088+104j ...
		xor	eax, eax
		inc	eax

loc_10023208:				; CODE XREF: sub_10023088+30j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	0Ch
sub_10023088	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002320F:				; CODE XREF: DllEntryPoint+11j
		push	2Ch
		push	offset dword_10027F78
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_4]
		xor	edx, edx
		inc	edx
		mov	[ebp+var_1C], edx
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	dword_10029250,	ecx
		cmp	ecx, esi
		jnz	short loc_10023243
		cmp	dword_10029694,	esi
		jnz	short loc_10023243
		mov	[ebp+var_1C], esi
		jmp	loc_10023449
; ---------------------------------------------------------------------------

loc_10023243:				; CODE XREF: DllEntryPoint-23Aj
					; DllEntryPoint-232j
		cmp	ecx, edx
		jz	short loc_10023250
		cmp	ecx, 2
		jnz	loc_100232DD

loc_10023250:				; CODE XREF: DllEntryPoint-226j
		mov	eax, dword_100299D0
		cmp	eax, esi
		jz	short loc_1002328F
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	dword_10029698,	edx
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	eax ; dword_100299D0
		mov	[ebp+var_1C], eax
		jmp	short loc_1002328C
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10023270	proc near		; DATA XREF: .rdata:10027F98o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-20h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_10023270	endp


; =============== S U B	R O U T	I N E =======================================


sub_10023284	proc near		; DATA XREF: .rdata:10027F9Co
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10023284	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002328C:				; CODE XREF: DllEntryPoint-1FDj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_1002328F:				; CODE XREF: DllEntryPoint-214j
		cmp	[ebp+var_1C], esi
		jz	loc_10023449
		mov	[ebp+ms_exc.registration.TryLevel], 2
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10023088
		mov	[ebp+var_1C], eax
		jmp	short loc_100232CE
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100232B2	proc near		; DATA XREF: .rdata:10027FA4o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-24h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_100232B2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100232C6	proc near		; DATA XREF: .rdata:10027FA8o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_100232C6	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100232CE:				; CODE XREF: DllEntryPoint-1BBj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+var_1C], esi
		jz	loc_10023449
		mov	ecx, [ebp+arg_4]

loc_100232DD:				; CODE XREF: DllEntryPoint-221j
		mov	[ebp+ms_exc.registration.TryLevel], 3
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	sub_10023742
		mov	[ebp+var_1C], eax
		jmp	short loc_10023311
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100232F5	proc near		; DATA XREF: .rdata:10027FB0o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-28h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_100232F5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10023309	proc near		; DATA XREF: .rdata:10027FB4o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10023309	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10023311:				; CODE XREF: DllEntryPoint-178j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+arg_4], 1
		jnz	loc_100233BA
		cmp	[ebp+var_1C], esi
		jnz	loc_100233BA
		mov	[ebp+ms_exc.registration.TryLevel], 4
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10023742
		jmp	short loc_10023353
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002333A	proc near		; DATA XREF: .rdata:10027FBCo
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-2Ch], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_1002333A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002334E	proc near		; DATA XREF: .rdata:10027FC0o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_1002334E	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10023353:				; CODE XREF: DllEntryPoint-133j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	[ebp+ms_exc.registration.TryLevel], 5
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10023088
		jmp	short loc_10023382
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10023369	proc near		; DATA XREF: .rdata:10027FC8o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-30h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_10023369	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002337D	proc near		; DATA XREF: .rdata:10027FCCo
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_1002337D	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10023382:				; CODE XREF: DllEntryPoint-104j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_100299D0
		cmp	eax, esi
		jz	short loc_100233BA
		mov	[ebp+ms_exc.registration.TryLevel], 6
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	eax ; dword_100299D0
		jmp	short loc_100233B7
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002339E	proc near		; DATA XREF: .rdata:10027FD4o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-34h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_1002339E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100233B2	proc near		; DATA XREF: .rdata:10027FD8o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_100233B2	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100233B7:				; CODE XREF: DllEntryPoint-CFj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_100233BA:				; CODE XREF: DllEntryPoint-153j
					; DllEntryPoint-14Aj ...
		cmp	[ebp+arg_4], esi
		jz	short loc_100233C9
		cmp	[ebp+arg_4], 3
		jnz	loc_10023449

loc_100233C9:				; CODE XREF: DllEntryPoint-AEj
		mov	[ebp+ms_exc.registration.TryLevel], 7
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10023088
		mov	[ebp+var_1C], eax
		jmp	short loc_100233FF
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100233E3	proc near		; DATA XREF: .rdata:10027FE0o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-38h], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_100233E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_100233F7	proc near		; DATA XREF: .rdata:10027FE4o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_100233F7	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100233FF:				; CODE XREF: DllEntryPoint-8Aj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_100299D0
		cmp	eax, esi
		jz	short loc_10023449
		cmp	dword_10029698,	esi
		jz	short loc_10023449
		mov	[ebp+ms_exc.registration.TryLevel], 8
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	eax ; dword_100299D0
		mov	[ebp+var_1C], eax
		jmp	short loc_10023446
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002342A	proc near		; DATA XREF: .rdata:10027FECo
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-3Ch], ecx
		push	eax
		push	ecx
		call	sub_10023022
		pop	ecx
		pop	ecx
		retn
sub_1002342A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002343E	proc near		; DATA XREF: .rdata:10027FF0o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_1002343E	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10023446:				; CODE XREF: DllEntryPoint-43j
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_10023449:				; CODE XREF: DllEntryPoint-22Dj
					; DllEntryPoint-1D9j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	sub_10023460
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn	0Ch
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10023460	proc near		; CODE XREF: DllEntryPoint-1Bp
					; DATA XREF: .rdata:10027F90o
		mov	dword_10029250,	0FFFFFFFFh
		retn
sub_10023460	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 1002320F SIZE 00000061 BYTES
; FUNCTION CHUNK AT 1002328C SIZE 00000026 BYTES
; FUNCTION CHUNK AT 100232CE SIZE 00000027 BYTES
; FUNCTION CHUNK AT 10023311 SIZE 00000029 BYTES
; FUNCTION CHUNK AT 10023353 SIZE 00000016 BYTES
; FUNCTION CHUNK AT 10023382 SIZE 0000001C BYTES
; FUNCTION CHUNK AT 100233B7 SIZE 0000002C BYTES
; FUNCTION CHUNK AT 100233FF SIZE 0000002B BYTES
; FUNCTION CHUNK AT 10023446 SIZE 0000001A BYTES

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_1002347B
		call	sub_100237C6

loc_1002347B:				; CODE XREF: DllEntryPoint+9j
		pop	ebp
		jmp	loc_1002320F
DllEntryPoint	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023481	proc near		; CODE XREF: __security_check_cookie(x):$failure$3j

var_328		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_s0		= dword	ptr  0
arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 328h
		mov	dword_100297A0,	eax
		mov	dword_1002979C,	ecx
		mov	dword_10029798,	edx
		mov	dword_10029794,	ebx
		mov	dword_10029790,	esi
		mov	dword_1002978C,	edi
		mov	word_100297B8, ss
		mov	word_100297AC, cs
		mov	word_10029788, ds
		mov	word_10029784, es
		mov	word_10029780, fs
		mov	word_1002977C, gs
		pushf
		pop	dword_100297B0
		mov	eax, [ebp+var_s0]
		mov	dword_100297A4,	eax
		mov	eax, [ebp+4]
		mov	dword_100297A8,	eax
		lea	eax, [ebp+arg_0]
		mov	dword_100297B4,	eax
		mov	eax, [ebp+var_320]
		mov	dword_100296F0,	10001h
		mov	eax, dword_100297A8
		mov	dword_100296AC,	eax
		mov	dword_100296A0,	0C0000409h
		mov	dword_100296A4,	1
		mov	eax, ___security_cookie
		mov	[ebp+var_328], eax
		mov	eax, dword_10029234
		mov	[ebp+var_324], eax
		push	0		; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		push	offset ExceptionInfo ; ExceptionInfo
		call	ds:UnhandledExceptionFilter
		push	0C0000409h	; uExitCode
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:TerminateProcess
		leave
		retn
sub_10023481	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		mov	eax, [esp+14h]
		or	eax, eax
		jnz	short loc_100235A1
		mov	ecx, [esp+10h]
		mov	eax, [esp+0Ch]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	dword ptr [esp+10h]
		mov	ecx, eax
		mov	eax, esi
		mul	dword ptr [esp+10h]
		add	edx, ecx
		jmp	short loc_100235E8
; ---------------------------------------------------------------------------

loc_100235A1:				; CODE XREF: .text:10023577j
		mov	ecx, eax
		mov	ebx, [esp+10h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]

loc_100235AF:				; CODE XREF: .text:100235B9j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_100235AF
		div	ebx
		mov	esi, eax
		mul	dword ptr [esp+14h]
		mov	ecx, eax
		mov	eax, [esp+10h]
		mul	esi
		add	edx, ecx
		jb	short loc_100235DD
		cmp	edx, [esp+0Ch]
		ja	short loc_100235DD
		jb	short loc_100235E6
		cmp	eax, [esp+8]
		jbe	short loc_100235E6

loc_100235DD:				; CODE XREF: .text:100235CDj
					; .text:100235D3j
		dec	esi
		sub	eax, [esp+10h]
		sbb	edx, [esp+14h]

loc_100235E6:				; CODE XREF: .text:100235D5j
					; .text:100235DBj
		xor	ebx, ebx

loc_100235E8:				; CODE XREF: .text:1002359Fj
		sub	eax, [esp+8]
		sbb	edx, [esp+0Ch]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------
		align 4
		push	ebx
		push	ecx
		mov	ebx, offset dword_10029240
		jmp	short loc_1002361C

; =============== S U B	R O U T	I N E =======================================


sub_10023611	proc near		; CODE XREF: sub_10022D40+6Ep
					; sub_10022E49+8p

arg_0		= dword	ptr  4

		push	ebx
		push	ecx
		mov	ebx, offset dword_10029240
		mov	ecx, [esp+8+arg_0]

loc_1002361C:				; CODE XREF: .text:1002360Fj
		mov	[ebx+8], ecx
		mov	[ebx+4], eax
		mov	[ebx+0Ch], ebp
		push	ebp
		push	ecx
		push	eax
		pop	eax
		pop	ecx
		pop	ebp
		pop	ecx
		pop	ebx
		retn	4
sub_10023611	endp


; =============== S U B	R O U T	I N E =======================================


sub_10023630	proc near		; CODE XREF: sub_10022D40+7Bp
		call	eax
		retn
sub_10023630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023640	proc near		; CODE XREF: sub_100236C4+16p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_10023656

loc_10023652:				; CODE XREF: sub_10023640+21j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10023656:				; CODE XREF: sub_10023640+10j
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_10023652
		xor	edx, edx
		mov	ecx, 10Bh
		cmp	[eax+18h], cx
		setz	dl
		mov	eax, edx
		pop	ebp
		retn
sub_10023640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023680	proc near		; CODE XREF: sub_100236C4+27p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		push	ebx
		push	esi
		movzx	esi, word ptr [ecx+6]
		xor	edx, edx
		push	edi
		lea	eax, [eax+ecx+18h]
		test	esi, esi
		jbe	short loc_100236BD
		mov	edi, [ebp+arg_4]

loc_100236A5:				; CODE XREF: sub_10023680+3Bj
		mov	ecx, [eax+0Ch]
		cmp	edi, ecx
		jb	short loc_100236B5
		mov	ebx, [eax+8]
		add	ebx, ecx
		cmp	edi, ebx
		jb	short loc_100236BF

loc_100236B5:				; CODE XREF: sub_10023680+2Aj
		inc	edx
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_100236A5

loc_100236BD:				; CODE XREF: sub_10023680+20j
		xor	eax, eax

loc_100236BF:				; CODE XREF: sub_10023680+33j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10023680	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100236C4	proc near		; CODE XREF: sub_10022EA0+F4p
					; sub_10023088+E7p

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_10027FF8
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, 10000000h
		push	esi
		call	sub_10023640
		pop	ecx
		test	eax, eax
		jz	short loc_10023721
		mov	eax, [ebp+arg_0]
		sub	eax, esi
		push	eax
		push	esi
		call	sub_10023680
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10023721
		mov	eax, [eax+24h]
		shr	eax, 1Fh
		not	eax
		and	eax, 1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_1002372A
; ---------------------------------------------------------------------------

loc_1002370A:				; DATA XREF: .rdata:stru_10027FF8o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 100236C4
		mov	eax, [eax]
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	eax, 0C0000005h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1002371E:				; DATA XREF: .rdata:stru_10027FF8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100236C4

loc_10023721:				; CODE XREF: sub_100236C4+1Ej
					; sub_100236C4+30j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	eax, eax

loc_1002372A:				; CODE XREF: sub_100236C4+44j
		call	__SEH_epilog4
		retn
sub_100236C4	endp

; [00000006 BYTES: COLLAPSED FUNCTION _XcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]

; =============== S U B	R O U T	I N E =======================================


sub_10023742	proc near		; CODE XREF: DllEntryPoint-180p
					; DllEntryPoint-138p
		xor	eax, eax
		inc	eax
		retn	0Ch
sub_10023742	endp

; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100237A1(int,	PVOID TargetFrame, int,	int)
sub_100237A1	proc near		; DATA XREF: __SEH_prolog4o
					; .rdata:10027F74o

arg_0		= dword	ptr  8
TargetFrame	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]	; int
		push	[ebp+TargetFrame] ; TargetFrame
		push	[ebp+arg_0]	; int
		push	offset @__security_check_cookie@4 ; int
		push	offset ___security_cookie ; int
		call	sub_10022EA0
		add	esp, 18h
		pop	ebp
		retn
sub_100237A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100237C6	proc near		; CODE XREF: DllEntryPoint+Bp

PerformanceCount= LARGE_INTEGER	ptr -10h
SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		push	ebx
		push	edi
		mov	edi, 0BB40E64Eh
		mov	ebx, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_100237F8
		test	ebx, eax
		jz	short loc_100237F8
		not	eax
		mov	dword_10029234,	eax
		jmp	short loc_10023853
; ---------------------------------------------------------------------------

loc_100237F8:				; CODE XREF: sub_100237C6+23j
					; sub_100237C6+27j
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		call	ds:GetCurrentProcessId
		xor	esi, eax
		call	ds:GetCurrentThreadId
		xor	esi, eax
		call	ds:GetTickCount
		xor	esi, eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	eax, dword ptr [ebp+PerformanceCount+4]
		xor	eax, dword ptr [ebp+PerformanceCount]
		xor	esi, eax
		cmp	esi, edi
		jz	short loc_1002383F
		test	___security_cookie, ebx
		jnz	short loc_10023844

loc_1002383F:				; CODE XREF: sub_100237C6+6Fj
		mov	esi, 0BB40E64Fh

loc_10023844:				; CODE XREF: sub_100237C6+77j
		mov	___security_cookie, esi
		not	esi
		mov	dword_10029234,	esi
		pop	esi

loc_10023853:				; CODE XREF: sub_100237C6+30j
		pop	edi
		pop	ebx
		leave
		retn
sub_100237C6	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		or	ecx, eax
		mov	ecx, [esp+0Ch]
		jnz	short loc_10023879
		mov	eax, [esp+4]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10023879:				; CODE XREF: .text:1002386Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		mul	dword ptr [esp+14h]
		add	ebx, eax
		mov	eax, [esp+8]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 200h
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 00024000)
; Virtual size			: 00004F37 (  20279.)
; Section size in file		: 00005000 (  20480.)
; Offset to raw	data for section: 00022E00
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: sub_10023481+C8p
					; DATA XREF: sub_10023481+C8r ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_100237C6+37p
					; DATA XREF: sub_100237C6+37r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_100237C6+43p
					; DATA XREF: sub_100237C6+43r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_100237C6+4Bp
					; DATA XREF: sub_100237C6+4Br
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_100237C6+53p
					; DATA XREF: sub_100237C6+53r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_100237C6+5Fp
					; DATA XREF: sub_100237C6+5Fr
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_10023481+BDp
					; DATA XREF: sub_10023481+BDr
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_10017DC0+1Dp
					; DATA XREF: sub_10017DC0+1Dr
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_10023481+D3p
					; DATA XREF: sub_10023481+D3r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10023481+DAp
					; DATA XREF: sub_10023481+DAr
; LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination,	LONG Exchange, LONG Comperand)
		extrn InterlockedCompareExchange:dword ; CODE XREF: sub_10023088+6Dp
					; sub_10023088+116p
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_10023088+63p
					; sub_10023088+10Bp
					; DATA XREF: ...
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword	; CODE XREF: sub_10023088+D4p
					; sub_10023088+177p
					; DATA XREF: ...
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr

;
; Imports from libnspr4.dll
;
		extrn PR_DestroyLock:dword ; CODE XREF:	sub_100081D0+5Bp
					; sub_100081D0+7Ep ...
		extrn PR_CallOnce:dword	; CODE XREF: sub_10020B00+13p
					; sub_10020B40+13p ...
		extrn PR_SetError:dword	; CODE XREF: sub_10020A60+12p
					; DATA XREF: sub_10020A60+12r
		extrn PR_Free:dword	; CODE XREF: sub_100209F0+2Dp
					; DATA XREF: sub_100209F0+2Dr
		extrn PR_smprintf:dword	; CODE XREF: sub_1001BFB0+58p
					; sub_1001C080+4Bp ...
		extrn PR_NewMonitor:dword ; CODE XREF: sub_10019E70+4F4p
					; DATA XREF: sub_10019E70+4F4r
		extrn PR_DestroyMonitor:dword ;	CODE XREF: sub_10019B00+3Bp
					; DATA XREF: sub_10019B00+3Br
		extrn PR_Now:dword	; CODE XREF: sub_10018EB0+16p
					; DATA XREF: sub_10018EB0+16r
		extrn PR_EnterMonitor:dword ; CODE XREF: sub_10018200+Dp
					; sub_10018280+4Ep ...
		extrn PR_GetCurrentThread:dword	; CODE XREF: sub_10018200+25p
					; sub_10018BA0+103p ...
		extrn PR_ExitMonitor:dword ; CODE XREF:	sub_10018200+39p
					; sub_10018280+77p ...
		extrn PR_MillisecondsToInterval:dword ;	CODE XREF: sub_10017F90+4p
					; DATA XREF: sub_10017F90+4r
		extrn PR_IntervalNow:dword ; CODE XREF:	sub_10017F90+7Bp
					; sub_10017F90+B6p ...
		extrn PR_Access:dword	; CODE XREF: sub_10017F90+ADp
					; sub_10019E70+2Ep ...
		extrn PR_SecondsToInterval:dword ; CODE	XREF: sub_1000B0B0+18p
					; sub_10019E70+4E8p
					; DATA XREF: ...
		extrn PR_NewLock:dword	; CODE XREF: sub_1000ADD0+60p
					; sub_1000ADD0:loc_1000AE60p ...
		extrn PR_AtomicIncrement:dword ; CODE XREF: sub_10008D80+ADp
					; sub_10008D80+C4p ...
		extrn PR_Sleep:dword	; CODE XREF: sub_10008B70+17Cp
					; sub_100090D0+195p ...
		extrn PR_smprintf_free:dword ; CODE XREF: NSC_ModuleDBFunc+14Cp
					; NSC_ModuleDBFunc+223p ...
		extrn PR_AtomicDecrement:dword ; CODE XREF: sub_10008020+C2p
					; sub_10008F10+10Ap ...
		extrn PR_FindFunctionSymbol:dword ; CODE XREF: sub_10004DD0+7Bp
					; sub_10004DD0+88p ...
		extrn PR_UnloadLibrary:dword ; CODE XREF: sub_10004DD0+13Dp
					; sub_10005040+3Cp ...
		extrn PR_Lock:dword	; CODE XREF: .text:10004CF4p
					; .text:10004D7Dp ...
		extrn PR_Unlock:dword	; CODE XREF: .text:10004D07p
					; .text:10004D3Bp ...
		extrn PR_GetLibraryFilePathname:dword ;	CODE XREF: sub_10004C60+10p
					; sub_100209F0+11p
					; DATA XREF: ...
		extrn PR_GetDirectorySeparator:dword ; CODE XREF: sub_10004BB0+7p
					; sub_10017E50:loc_10017E7Fp ...
		extrn PR_LoadLibraryWithFlags:dword ; CODE XREF: sub_10004BB0+95p
					; sub_10004C60+4Ep ...
		extrn PR_GetEnv:dword	; CODE XREF: sub_10003640+53p
					; sub_10005040+29p ...
		extrn PR_snprintf:dword	; CODE XREF: sub_10001000+54p
					; sub_10001000+8Bp ...

;
; Imports from libplc4.dll
;
		extrn __imp_PL_strcasecmp:dword	; DATA XREF: PL_strcasecmpr
					; .rdata:1002804Co
		extrn __imp_PL_strncasecmp:dword ; DATA	XREF: PL_strncasecmpr

;
; Imports from libplds4.dll
;
		extrn __imp_PL_CompareValues:dword ; DATA XREF:	PL_CompareValuesr
					; .rdata:10028060o
		extrn __imp_PL_HashTableRemove:dword ; DATA XREF: PL_HashTableRemover
		extrn __imp_PL_HashTableAdd:dword ; DATA XREF: PL_HashTableAddr
		extrn __imp_PL_HashTableLookupConst:dword
					; DATA XREF: PL_HashTableLookupConstr
		extrn __imp_PL_HashTableEnumerateEntries:dword
					; DATA XREF: PL_HashTableEnumerateEntriesr
		extrn __imp_PL_NewHashTable:dword ; DATA XREF: PL_NewHashTabler
		extrn __imp_PL_HashTableDestroy:dword ;	DATA XREF: PL_HashTableDestroyr
		extrn __imp_PL_HashTableLookup:dword ; DATA XREF: PL_HashTableLookupr

;
; Imports from msvcrt.dll
;
; void *__cdecl	malloc(size_t Size)
		extrn malloc:dword	; CODE XREF: sub_10019E70+4B8p
					; sub_10019E70+4BEp ...
; char *__cdecl	getenv(const char *VarName)
		extrn getenv:dword	; CODE XREF: sub_10014FA0+A8Fp
					; DATA XREF: sub_10014FA0+A8Fr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn sprintf:dword	; CODE XREF: sub_10007E10+1Ap
					; sub_1000AB70+61p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn strrchr:dword	; CODE XREF: sub_10004BB0+16p
					; sub_10017E50+3Ep ...
; int __cdecl atoi(const char *Str)
		extrn atoi:dword	; CODE XREF: sub_10003640+61p
					; sub_1001D920+2E7p ...
; int __cdecl isdigit(int C)
		extrn isdigit:dword	; CODE XREF: sub_10003460+61p
					; DATA XREF: sub_10003460+61r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __imp__XcptFilter:dword ;	DATA XREF: _XcptFilterr
; void __cdecl free(void *Memory)
		extrn free:dword	; CODE XREF: sub_10019B00+4Bp
					; sub_10019B00+4Ep ...
; int __cdecl chmod(const char *, int)
		extrn _chmod:dword	; CODE XREF: sub_10019E70+106p
					; DATA XREF: sub_10019E70+106r
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl isupper(int C)
		extrn isupper:dword	; CODE XREF: sub_10003460+92p
					; DATA XREF: sub_10003460+92r
; int __cdecl islower(int C)
		extrn islower:dword	; CODE XREF: sub_10003460+7Ep
					; DATA XREF: sub_10003460+7Er

;
; Imports from nssutil3.dll
;
		extrn __imp_SECITEM_CompareItem_Util:dword
					; DATA XREF: SECITEM_CompareItem_Utilr
					; .rdata:10028038o
		extrn __imp_NSSUTIL_ArgGetLabel:dword ;	DATA XREF: NSSUTIL_ArgGetLabelr
		extrn __imp_NSSUTIL_ArgDecodeNumber:dword
					; DATA XREF: NSSUTIL_ArgDecodeNumberr
		extrn __imp_NSSUTIL_ArgIsBlank:dword ; DATA XREF: NSSUTIL_ArgIsBlankr
		extrn __imp_NSSUTIL_ArgStrip:dword ; DATA XREF:	NSSUTIL_ArgStripr
		extrn __imp_NSSUTIL_ArgFetchValue:dword	; DATA XREF: NSSUTIL_ArgFetchValuer
		extrn __imp_NSSUTIL_ArgSkipParameter:dword
					; DATA XREF: NSSUTIL_ArgSkipParameterr
		extrn __imp_NSSUTIL_ArgHasFlag:dword ; DATA XREF: NSSUTIL_ArgHasFlagr
		extrn __imp__NSSUTIL_EvaluateConfigDir:dword
					; DATA XREF: _NSSUTIL_EvaluateConfigDirr
		extrn __imp_PORT_Strdup_Util:dword ; DATA XREF:	PORT_Strdup_Utilr
		extrn __imp_SECOID_FindOIDByMechanism:dword
					; DATA XREF: SECOID_FindOIDByMechanismr
		extrn __imp__SGN_VerifyPKCS1DigestInfo:dword
					; DATA XREF: _SGN_VerifyPKCS1DigestInfor
		extrn __imp_SGN_CreateDigestInfo_Util:dword
					; DATA XREF: SGN_CreateDigestInfo_Utilr
		extrn __imp_DER_Encode_Util:dword ; DATA XREF: DER_Encode_Utilr
		extrn __imp_SGN_DestroyDigestInfo_Util:dword
					; DATA XREF: SGN_DestroyDigestInfo_Utilr
		extrn __imp_UTIL_SetForkState:dword ; DATA XREF: UTIL_SetForkStater
		extrn __imp_SECOID_Shutdown:dword ; DATA XREF: SECOID_Shutdownr
		extrn __imp_SECOID_Init:dword ;	DATA XREF: SECOID_Initr
		extrn __imp_SECITEM_HashCompare:dword ;	DATA XREF: SECITEM_HashComparer
		extrn __imp_NSSUTIL_DoModuleDBFunction:dword
					; DATA XREF: NSSUTIL_DoModuleDBFunctionr
		extrn __imp_PORT_GetError_Util:dword ; DATA XREF: PORT_GetError_Utilr
		extrn __imp__NSSUTIL_GetSecmodName:dword
					; DATA XREF: _NSSUTIL_GetSecmodNamer
		extrn __imp_DER_SetUInteger:dword ; DATA XREF: DER_SetUIntegerr
		extrn __imp_PORT_ArenaAlloc_Util:dword ; DATA XREF: PORT_ArenaAlloc_Utilr
		extrn __imp_NSS_Get_SEC_OctetStringTemplate_Util:dword
					; DATA XREF: NSS_Get_SEC_OctetStringTemplate_Utilr
		extrn __imp_SEC_QuickDERDecodeItem_Util:dword
					; DATA XREF: SEC_QuickDERDecodeItem_Utilr
		extrn __imp_PORT_ArenaGrow_Util:dword ;	DATA XREF: PORT_ArenaGrow_Utilr
		extrn __imp_PORT_Realloc_Util:dword ; DATA XREF: PORT_Realloc_Utilr
		extrn __imp_SECOID_GetAlgorithmTag_Util:dword
					; DATA XREF: SECOID_GetAlgorithmTag_Utilr
		extrn __imp_SEC_ASN1DecodeItem_Util:dword
					; DATA XREF: SEC_ASN1DecodeItem_Utilr
		extrn __imp_DER_GetInteger_Util:dword ;	DATA XREF: DER_GetInteger_Utilr
		extrn __imp_SEC_ASN1EncodeInteger_Util:dword
					; DATA XREF: SEC_ASN1EncodeInteger_Utilr
		extrn __imp_SEC_ASN1EncodeItem_Util:dword
					; DATA XREF: SEC_ASN1EncodeItem_Utilr
		extrn __imp_SECOID_SetAlgorithmID_Util:dword
					; DATA XREF: SECOID_SetAlgorithmID_Utilr
		extrn __imp_SECOID_CopyAlgorithmID_Util:dword
					; DATA XREF: SECOID_CopyAlgorithmID_Utilr
		extrn __imp_SECOID_DestroyAlgorithmID_Util:dword
					; DATA XREF: SECOID_DestroyAlgorithmID_Utilr
		extrn __imp_SECITEM_DupItem_Util:dword ; DATA XREF: SECITEM_DupItem_Utilr
		extrn __imp_SECITEM_AllocItem_Util:dword
					; DATA XREF: SECITEM_AllocItem_Utilr
		extrn __imp_PORT_ZFree_Util:dword ; DATA XREF: PORT_ZFree_Utilr
		extrn __imp_SECITEM_ZfreeItem_Util:dword
					; DATA XREF: SECITEM_ZfreeItem_Utilr
		extrn __imp_PORT_ZAlloc_Util:dword ; DATA XREF:	PORT_ZAlloc_Utilr
		extrn __imp_SECITEM_FreeItem_Util:dword	; DATA XREF: SECITEM_FreeItem_Utilr
		extrn __imp_PORT_NewArena_Util:dword ; DATA XREF: PORT_NewArena_Utilr
		extrn __imp_PORT_ArenaZAlloc_Util:dword	; DATA XREF: PORT_ArenaZAlloc_Utilr
		extrn __imp_SECITEM_CopyItem_Util:dword	; DATA XREF: SECITEM_CopyItem_Utilr
		extrn __imp_NSS_Get_SEC_AnyTemplate_Util:dword
					; DATA XREF: NSS_Get_SEC_AnyTemplate_Utilr
		extrn __imp_NSS_Get_SEC_BitStringTemplate_Util:dword
					; DATA XREF: NSS_Get_SEC_BitStringTemplate_Utilr
		extrn __imp_NSS_Get_SEC_ObjectIDTemplate_Util:dword
					; DATA XREF: NSS_Get_SEC_ObjectIDTemplate_Utilr
		extrn __imp_NSS_Get_SECOID_AlgorithmIDTemplate_Util:dword
					; DATA XREF: NSS_Get_SECOID_AlgorithmIDTemplate_Utilr
		extrn __imp_PORT_SetError_Util:dword ; DATA XREF: PORT_SetError_Utilr
		extrn __imp_PORT_Alloc_Util:dword ; DATA XREF: PORT_Alloc_Utilr
		extrn __imp_PORT_Free_Util:dword ; DATA	XREF: PORT_Free_Utilr
		extrn __imp_PORT_FreeArena_Util:dword ;	DATA XREF: PORT_FreeArena_Utilr

;
; Imports from sqlite3.dll
;
		extrn __imp_sqlite3_bind_text:dword ; DATA XREF: sqlite3_bind_textr
					; .rdata:10028024o
		extrn __imp_sqlite3_bind_int:dword ; DATA XREF:	sqlite3_bind_intr
		extrn __imp_sqlite3_column_bytes:dword ; DATA XREF: sqlite3_column_bytesr
		extrn __imp_sqlite3_column_blob:dword ;	DATA XREF: sqlite3_column_blobr
		extrn __imp_sqlite3_step:dword ; DATA XREF: sqlite3_stepr
		extrn __imp_sqlite3_column_int:dword ; DATA XREF: sqlite3_column_intr
		extrn __imp_sqlite3_prepare_v2:dword ; DATA XREF: sqlite3_prepare_v2r
		extrn __imp_sqlite3_bind_blob:dword ; DATA XREF: sqlite3_bind_blobr
		extrn __imp_sqlite3_reset:dword	; DATA XREF: sqlite3_resetr
		extrn __imp_sqlite3_finalize:dword ; DATA XREF:	sqlite3_finalizer
		extrn __imp_sqlite3_open:dword ; DATA XREF: sqlite3_openr
		extrn __imp_sqlite3_busy_timeout:dword ; DATA XREF: sqlite3_busy_timeoutr
		extrn __imp_sqlite3_close:dword	; DATA XREF: sqlite3_closer
		extrn __imp_sqlite3_exec:dword ; DATA XREF: sqlite3_execr
		extrn __imp_sqlite3_mprintf:dword ; DATA XREF: sqlite3_mprintfr
		extrn __imp_sqlite3_file_control:dword ; DATA XREF: sqlite3_file_controlr
		extrn __imp_sqlite3_free:dword ; DATA XREF: sqlite3_freer


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10024244h
dword_10024244	dd 0			; DATA XREF: sub_10023088+B9o
dword_10024248	dd 0			; DATA XREF: sub_10023088+B4o
dword_1002424C	dd 0			; DATA XREF: sub_10023088+96o
		dd offset sub_10023066
dword_10024254	dd 0			; DATA XREF: sub_10023088:loc_10023119o
aS0x08lx	db ' *%s=0x%08lX',0     ; DATA XREF: sub_10001000+48o
					; sub_100010C0+48o ...
		align 4
aP		db '%p',0               ; DATA XREF: sub_100013B0+5Bo
					; sub_10001470+66o ...
		align 4
aPMechanism0x08	db '%p {mechanism=0x%08lX, ...}',0 ; DATA XREF: sub_100013B0+46o
					; sub_10001470+51o ...
aC_createobject	db 'C_CreateObject(hSession=0x%08lX, pTemplate=%p, ulCount=%lu, phObj'
					; DATA XREF: sub_10001000+7Co
		db 'ect=%p)=0x%08lX%s',0
		align 4
aPhobject	db 'phObject',0         ; DATA XREF: sub_10001000+43o
		align 4
aC_copyobjectHs	db 'C_CopyObject(hSession=0x%08lX, hObject=0x%08lX, pTemplate=%p, ulC'
					; DATA XREF: sub_100010C0+84o
		db 'ount=%lu, phNewObject=%p)=0x%08lX%s',0
		align 10h
aPhnewobject	db 'phNewObject',0      ; DATA XREF: sub_100010C0+43o
aC_destroyobjec	db 'C_DestroyObject(hSession=0x%08lX, hObject=0x%08lX)=0x%08lX',0
					; DATA XREF: sub_10001190+2Do
		align 4
aC_getobjectsiz	db 'C_GetObjectSize(hSession=0x%08lX, hObject=0x%08lX, pulSize=%p)=0x'
					; DATA XREF: sub_10001210+35o
		db '%08lX',0
		align 10h
aC_getattribute	db 'C_GetAttributeValue(hSession=0x%08lX, hObject=0x%08lX, pTemplate='
					; DATA XREF: sub_10001290+3Do
		db '%p, ulCount=%lu)=0x%08lX',0
		align 10h
aC_setattribute	db 'C_SetAttributeValue(hSession=0x%08lX, hObject=0x%08lX, pTemplate='
					; DATA XREF: sub_10001320+3Do
		db '%p, ulCount=%lu)=0x%08lX',0
		align 10h
aC_SinitHsessio	db 'C_%sInit(hSession=0x%08lX, pMechanism=%s, hKey=0x%08lX)=0x%08lX',0
					; DATA XREF: sub_100013B0+83o
aC_generatekeyH	db 'C_GenerateKey(hSession=0x%08lX, pMechanism=%s, pTemplate=%p, ulCo'
					; DATA XREF: sub_10001470+BCo
		db 'unt=%lu, phKey=%p)=0x%08lX%s',0
		align 10h
aPhkey		db 'phKey',0            ; DATA XREF: sub_10001470+82o
					; sub_100017B0+8Do ...
		align 4
aC_generatekeyp	db 'C_GenerateKeyPair(hSession=0x%08lX, pMechanism=%s, pPublicKeyTemp'
					; DATA XREF: sub_10001570+115o
		db 'late=%p, ulPublicKeyAttributeCount=%lu, pPrivateKeyTemplate=%p, u'
		db 'lPrivateKeyAttributeCount=%lu, phPublicKey=%p, phPrivateKey=%p)=0'
		db 'x%08lX%s%s',0
		align 4
aPhprivatekey	db 'phPrivateKey',0     ; DATA XREF: sub_10001570+C1o
		align 4
aPhpublickey	db 'phPublicKey',0      ; DATA XREF: sub_10001570+98o
		align 8
aC_wrapkeyHsess	db 'C_WrapKey(hSession=0x%08lX, pMechanism=%s, hWrappingKey=0x%08lX, '
					; DATA XREF: sub_100016D0+97o
		db 'hKey=0x%08lX, pWrappedKey=%p, pulWrappedKeyLen=%p)=0x%08lX',0
		align 8
aC_unwrapkeyHse	db 'C_UnwrapKey(hSession=0x%08lX, pMechanism=%s, hUnwrappingKey=0x%08'
					; DATA XREF: sub_100017B0+DCo
		db 'lX, pWrappedKey=%p, ulWrappedKeyLen=%lu, pTemplate=%p, ulAttribut'
		db 'eCount=%lu, phKey=%p)=0x%08lX%s',0
		align 10h
aC_derivekeyHse	db 'C_DeriveKey(hSession=0x%08lX, pMechanism=%s, hBaseKey=0x%08lX, pT'
					; DATA XREF: sub_100018D0+111o
		db 'emplate=%p, ulAttributeCount=%lu, phKey=%p)=0x%08lX%s%s',0
		align 10h
aHclientmacsecr	db ' hClientMacSecret=0x%08lX hServerMacSecret=0x%08lX hClientKey=0x%'
					; DATA XREF: sub_100018D0+C5o
		db '08lX hServerKey=0x%08lX',0
		align 4
aC_digestkeyHse	db 'C_DigestKey(hSession=0x%08lX, hKey=0x%08lX)=0x%08lX',0
					; DATA XREF: sub_10001A30+2Do
aRsarc		db 'RSARC',0            ; DATA XREF: sub_10001AB0+17o
					; sub_10001AB0+A3o ...
asc_10024876	db '%',0                ; DATA XREF: .rdata:100255B8o
aSecurity	db 'Security',0         ; DATA XREF: sub_10001AB0+11Fo
					; sub_10001AB0+19Fo
		align 4
aNetscape	db 'Netscape',0         ; DATA XREF: sub_10001AB0+45o
					; sub_10001AB0+104r ...
		align 10h
aNetscape_0	db 'Netscape',0         ; DATA XREF: sub_10001AB0+13Eo
		align 4
dword_1002489C	dd 5433711Ah		; DATA XREF: sub_10001AB0+84r
					; sub_10001AB0+BBo
		dd 30D25C8Dh
dword_100248A4	dd 94DB41FFh		; DATA XREF: sub_10001AB0+184r
					; sub_10001AB0+1D1o
		dd 0B3334C8Ah
aRsarc_0	db 'RSARC',0            ; DATA XREF: sub_10001D00+11o
					; sub_10001D00+9Do
		align 4
aNetscape_1	db 'Netscape',0         ; DATA XREF: sub_10001D00+3Ao
					; sub_10001D00+104r
		align 10h
dword_100248C0	dd 9AC73329h		; DATA XREF: sub_10001D00+84r
					; sub_10001D00+C6o
		dd 0DD096C9Dh
aAnsiDes	db 'ANSI DES',0         ; DATA XREF: sub_10001E40+15o
					; sub_10001E40+A1o ...
		align 4
aSecurity_0	db 'Security',0         ; DATA XREF: sub_10001E40+11Fo
					; sub_10001E40+19Fo
		align 10h
aNetscape_2	db 'Netscape',0         ; DATA XREF: sub_10001E40+43o
					; sub_10001E40+104r
		align 4
aNetscape_3	db 'Netscape',0         ; DATA XREF: sub_10001E40+13Co
					; sub_10001E40+204r
		align 4
dword_100248F8	dd 0C3E91426h		; DATA XREF: sub_10001E40+84r
					; sub_10001E40+B9o
		dd 0B0508028h
dword_10024900	dd 5D94955Eh		; DATA XREF: sub_10001E40+184r
					; sub_10001E40+1CFo
		dd 7DD3A276h
aAnsiTripleDesK	db 'ANSI Triple-DES Key Data',0 ; DATA XREF: sub_10002090+15o
					; sub_10002090+A1o ...
		align 4
aSecurity_1	db 'Security',0         ; DATA XREF: sub_10002090+11Fo
					; sub_10002090+19Fo
		align 10h
aNetscape_4	db 'Netscape',0         ; DATA XREF: sub_10002090+43o
					; sub_10002090+104r
		align 4
aNetscape_5	db 'Netscape',0         ; DATA XREF: sub_10002090+13Co
					; sub_10002090+204r
		align 4
dword_10024948	dd 3CAD8E55h		; DATA XREF: sub_10002090+84r
					; sub_10002090+B9o
		dd 0BE6949EEh
dword_10024950	dd 0C16ADC43h		; DATA XREF: sub_10002090+184r
					; sub_10002090+1CFo
		dd 0F532A6AFh
aAes128Rijndael	db 'AES-128 RIJNDAELLEADNJIR 821-SEA',0 ; DATA XREF: sub_100022E0+30o
					; sub_100022E0+FFo ...
		align 4
aSecurityytiruc	db 'SecurityytiruceS',0 ; DATA XREF: sub_100022E0+181o
					; sub_100022E0+1FCo
		align 10h
aNetscapeepacst	db 'NetscapeepacsteN',0 ; DATA XREF: sub_100022E0+97o
					; sub_100022E0+164r ...
		align 4
dword_100249A4	dd 0F396A53Ch, 0C1966A34h, 7B168803h, 4735BF20h
					; DATA XREF: sub_100022E0+19o
dword_100249B4	dd 4F1D15CFh, 634FE496h, 1D145415h, 0EAD5D84Eh ; DATA XREF: sub_100022E0+1Eo
dword_100249C4	dd 0ED6218A0h, 62CB1988h, 0FE4D1D88h, 0E890284h
					; DATA XREF: sub_100022E0+5Do
dword_100249D4	dd 76A4F783h, 0BE076FD1h, 2F43BC07h, 0E129AD6Dh
					; DATA XREF: sub_100022E0+62o
dword_100249E4	dd 152A6DBh, 66AE708Ah,	95D8993Ah, 6701FB7Fh
					; DATA XREF: sub_100022E0:loc_1000234Co
dword_100249F4	dd 607EA37h, 27591C31h,	7168C5C5h, 1640346Eh ; DATA XREF: sub_100022E0+71o
dword_10024A04	dd 5BF685D5h		; DATA XREF: sub_10002740+44r
		dd 5B9FA39h, 611D573Bh,	1E84B8E7h, 111E0E5Dh
aTheTestMessage	db 'The test message for the MD2, MD5, and SHA-1 hashing algorithms.',0
					; DATA XREF: sub_10002590+35o
					; sub_10002640+14o ...
		align 4
dword_10024A5C	dd 0B2125A41h		; DATA XREF: sub_10002590+74r
		dd 1797283Fh, 0CC4E710Ch, 1B1DC840h
dword_10024A6C	dd 10C0C825h		; DATA XREF: sub_10002640+33r
		dd 28686EC5h, 0D2A5A428h, 2DEA9A98h
aFirefoxAndThun	db 'Firefox and ThunderBird are awesome!',0 ; DATA XREF: sub_10002740+1Eo
					; sub_10002740+79o ...
		align 4
dword_10024AA4	dd 8E06C31Ch		; DATA XREF: sub_10002740+E4r
		dd 0FB6837CEh, 0BE4A821Ah, 0F851002Bh, 90E0B69Dh, 64C9000Dh
		dd 4E98B89Ah
dword_10024AC0	dd 9E9A7505h		; DATA XREF: sub_10002740+184r
		dd 44E75E70h, 924B46E2h, 0E0221422h, 0C8A921Bh,	0E949F5FEh
		dd 7D561BA7h, 4840291Dh
dword_10024AE0	dd 0EC1456CDh		; DATA XREF: sub_10002740+224r
		dd 2B065305h, 188A9C7Eh, 91F3EA5Eh, 0F664FB33h,	0B899FE3h
		dd 4D83BEAFh, 4D433C3Fh, 98560C4Ah, 0AAB4CAF8h,	0AF0AF49Ah
		dd 87CA694Fh
dword_10024B10	dd 12970EF6h		; DATA XREF: sub_10002740+2B4r
		dd 0B96E6700h, 0F063B20Ch, 6275AC60h, 522A9570h, 0D2DDEE22h
		dd 26E8B171h, 2713D333h, 0EF44FFCBh, 0FB169787h, 0BE480BD3h
		dd 0B1DA4E12h, 6FB9089h, 0C4E5BE0Ch, 3D3724FFh,	37E4E4C7h
dword_10024B50	dd 0BA076D0Ah		; DATA XREF: sub_10002A50+34r
		dd 1B8ABD1Eh, 22C7F672h, 0F09F27F1h, 7A4768E0h
dword_10024B64	dd 0FD7F5E89h		; DATA XREF: sub_10002A50+73r
		dd 6F35D80Eh, 0DEF26D64h, 7FA6ED5Eh, 7312D129h,	4F958442h
		dd 0CBE5088Eh
dword_10024B80	dd 0F0C1A938h		; DATA XREF: sub_10002A50+B3r
		dd 615DF635h, 0DC0BD411h, 8D1435CEh, 0AFAFDDF2h, 0E987B7CFh
		dd 83D2A596h, 79564662h
dword_10024BA0	dd 1CFE11h		; DATA XREF: sub_10002A50+F3r
		dd 0B3DE4889h, 181CEE99h, 0FEFB10B4h, 0F32CA8E3h, 0C82FB004h
		dd 0EA5EC4A3h, 7B48607Eh, 0F7622CCEh, 0A3E8A7BCh, 9CCE24CFh
		dd 72098BE2h
dword_10024BD0	dd 0F927B3C8h		; DATA XREF: sub_10002A50+128r
dword_10024BD4	dd 0BFC8240Bh, 5433BA4Ch, 0DBBF31F2h, 15B3FDABh, 9948FAD7h
		dd 570F6007h, 28DD1A41h, 0AC255512h, 12993ABAh,	758F7A2Ch
		dd 6F06E13Ah, 33C93130h, 1A901BC6h, 879A986Ch, 7F8B2D0h
		dd 330015B8h, 0A59D0CDAh, 1FDE8C14h, 0E2540723h, 451B9C6h
		dd 6E2465C9h, 5C34460Ah, 886B8637h, 0A5AC2724h,	0EDFB7902h
		dd 6E3FC575h, 0F5F05DFh, 5BA07020h, 0B9ACDB85h,	64C2025Fh
		dd 3E5B841Eh, 2EF6BFADh, 0F7ADD651h, 867586A7h,	0F7E1A7ECh
		dd 56DCBF08h, 0D8CA3BB1h, 9ADF51FCh, 0F206372Ah, 5E9A6BD1h
		dd 5720E52Ah, 981F9F35h, 0D6C740CFh, 0F5DEDB98h, 9DF75364h
		dd 78D6F345h, 20A3E3B9h, 354379CDh, 0B9FBD7EFh,	2F278880h
		dd 3D67A863h, 0C606FA4Ah, 0A70B86D2h, 1EE0FD28h, 2E174B93h
		dd 0C66F11B0h, 150F982Bh, 7A1687E3h, 123E677Ch,	48BEF82Bh
		dd 0F44797C1h, 1280811Fh, 1E7BE428h, 0DEA400B7h, 770FFBAAh
		dd 0B2D6A384h, 53DD4803h, 2841468Bh, 0F053C452h, 36D9951Ch
		dd 46260FE0h, 800E619Ch, 39AF86CAh, 4360E595h, 0B42B3E61h
		dd 778DBDE8h, 4332F562h, 82654B2Fh, 5B29DD14h, 10001h
dword_10024D14	dd 2 dup(0)		; DATA XREF: sub_10002BB0+6Fo
		dd offset dword_10024BD4+3Ch
		dd 100h, 0
		dd offset dword_10024BD4+13Ch
dword_10024D2C	dd 3, 53050829h, 6CE67689h, 0CAF077B5h,	67F2F3DFh, 9BD403DAh
					; DATA XREF: .rdata:100255DCo
		dd 0E5CE884Ch, 0C74D44F8h, 0FFE55880h, 5BF58F22h, 35BE8192h
		dd 9967DADFh, 83E3FC3Eh, 16AFA76Bh, 0C08F6FB7h,	770BFD81h
		dd 0FB9565h, 35EC99ADh,	3E23E8C6h, 98888E0h, 0B75016DBh
		dd 6174ABCFh, 67C57F9Eh, 90C75638h, 845E7885h, 0CEEA4921h
		dd 0E4FFA0B2h, 7B577F70h, 54B836A8h, 44F51D8Dh,	0F959689Dh
		dd 8F856E24h, 2C8A5FC3h, 0EBCB794h, 693EFA5h, 0C07CD38h
		dd 1A44B8AEh, 9AF5E7D8h, 0C7189C1Eh, 287FC26Ah,	0B8B44F01h
		dd 435A9790h, 95E8AD38h, 1B1A8368h, 2E60710h, 76BF1F52h
		dd 0FBD6466Bh, 0ACB5BEC3h, 1C015352h, 64EBC5F3h, 38C41EF2h
		dd 0C3D9AAE9h, 44A55172h, 1B0B6958h, 23F27F98h,	75F0EBFFh
		dd 1EC5CF24h, 2FC56AB8h, 7D50234Fh, 7A199D15h, 21E0820Bh
		dd 509D5F5Bh, 48E4832Bh, 0FBE539CCh, 816F7B13h,	6221BFE4h
		dd 4077A99Bh, 0A1CE2A8Dh, 964C5A67h, 0BD679845h, 6F332275h
		dd 0DE77CBE6h, 967D979Eh, 345D5E8Ch, 6DFC27FBh,	2E9DDB74h
		dd 0FCEAF66Dh, 0A7DA9ECEh, 58F4A225h, 13F0A6Dh,	38ABB4C2h
		dd 0B68514C1h, 85C394FAh, 962E3CF9h, 0D6E70156h, 0FB4F7114h
		dd 0C452854Ch, 1EA51E61h, 8F0D1396h, 0CDA0AE66h, 1966257Dh
		dd 0C3CFC215h, 0A4E83C12h, 28CB4C52h, 95BFC43Ch, 0EA81E333h
		dd 5A26C0Ch, 0F49403CEh, 61E2CA9h, 13040E7h, 8C68BBF7h
		dd 0E315D227h, 0A85B4928h, 7E429AC1h, 3408F931h, 40FA281h
		dd 36E33461h, 2B09B192h, 8884EFE9h, 60989CBEh, 0E98460A6h
		dd 81CC6F75h, 0DDEF96D1h, 0F5C4CA2Eh, 2B13FB42h, 5E14BF57h
		dd 35777FC2h, 0E0E5C429h, 4A156DF9h, 3E1C5642h,	70CEC50Ch
		dd 731E6308h, 5747EDBh,	36C60132h, 0ED6B7532h, 7E7CFE9Dh
		dd 0E9B457A9h, 0FEE7E422h, 0DF9B0736h, 0A93A5A04h, 0D1D9AA64h
		dd 0E5999E09h, 8A8650EAh, 0EE777289h, 0A9B5EEDBh, 0B1606BD8h
		dd 37FFB484h, 8AFE1DC1h, 3D618906h, 0D301EF37h,	6C0256A3h
		dd 0C5D405A3h, 59156B3Fh, 86FF6125h, 1840CEAh, 84FD7285h
		dd 0DA41CA58h, 68E4BE27h, 63E9E409h, 8A316A62h,	0DE558F67h
		dd 903FB6D4h, 62F66C10h, 7E152317h, 0B5657633h,	76117BEEh
		dd 0F2E0BEF5h, 978C7A57h, 0F8F5680Ch, 667FCF41h, 7D31AC53h
		dd 6E145493h, 4B4D9D73h, 0C8F88CFAh, 0EA22762Fh, 8F118038h
		dd 4490FC05h, 452A503Bh, 2AF4F3Dh, 0A27BC27Dh, 5C9431D2h
		dd 9FD4C32Eh, 6A370947h, 0A3F185E3h, 0B4F1D80Ch, 71C47B53h
		dd 0BB428602h, 0A303FF96h, 0EA0367B2h, 4BFB3177h, 7F72459h
		dd 0BAA9FB59h, 9758261Eh, 4956A166h, 552CB139h,	18786A0Ah
		dd 0F4CFDBBAh, 0A23532F7h, 0A7DCAB04h, 6D5D96Dh, 407DEC6Fh
		dd 0D00EE84Ch, 59DFAAC9h, 0AF5D717h, 969768F0h,	771829C4h
		dd 0F3E31F9Ah, 7E0F1312h, 91C1B97Bh, 5608C7F9h,	83BCA45Ch
		dd 0D978F971h, 6BFEEC2Bh, 0C9632FDCh, 5B1450CDh, 4D856ED3h
		dd 0A00BA20Ch, 34CAB609h, 4AC1C29Ch, 9345BCB0h,	0B5997EA5h
		dd 2969E4BDh, 0CDD22808h, 487824ABh, 370B2641h,	95D143A3h
		dd 22EED61Ah, 0C20B001Ch, 21A3A4B7h, 69E4CDA9h,	0B10245D3h
		dd 51BF3AB7h, 0C2781B35h, 600D0CCFh, 244A909h
dword_100250B0	dd 776F6E4Bh		; DATA XREF: sub_10002BB0+5Eo
					; sub_10002BB0+107r ...
		dd 6C70206Eh, 746E6961h, 20747865h, 7373656Dh, 20656761h
		dd 6C697475h, 64657A69h, 20726F66h, 20415352h, 72636E45h
		dd 69747079h, 26206E6Fh, 65442020h, 70797263h, 6E6F6974h
		dd 636F6C62h, 5320736Bh, 35324148h, 53202C36h, 38334148h
		dd 61202034h, 2020646Eh, 20202020h, 35414853h, 52203231h
		dd 53204153h, 616E6769h, 65727574h, 54414B20h, 73657420h
		dd 202E7374h, 776F6E4Bh, 6C70206Eh, 746E6961h, 20747865h
		dd 7373656Dh, 20656761h, 6C697475h, 64657A69h, 20726F66h
		dd 20415352h, 72636E45h, 69747079h, 26206E6Fh, 65442020h
		dd 70797263h, 6E6F6974h, 636F6C62h, 5320736Bh, 35324148h
		dd 53202C36h, 38334148h, 61202034h, 2020646Eh, 20202020h
		dd 35414853h, 52203231h, 53204153h, 616E6769h, 65727574h
		dd 54414B20h, 65742020h, 2E737473h
dword_100251B0	dd 0E3461204h		; DATA XREF: sub_10002BB0+B7r
					; sub_10002BB0+CEo
		dd 0DDDEEE6Ah, 83D9A149h, 70F935F7h, 12D0388h, 0DBBFD18Bh
		dd 0BE851CE5h, 45480BB5h, 0E3A0F07Ah, 0F64BBBA2h, 121BD027h
		dd 345277E3h, 0D2038E9Eh, 396E79F8h, 443C5379h,	8DBB9414h
		dd 0A04414AAh, 938CA57Bh, 0A3A4995Fh, 40387A6Eh, 9136FA78h
		dd 0BA9C9A5Eh, 0DAF9D41Eh, 0A3A80F4Bh, 0D13AF31Ch, 1651B4A5h
		dd 0ECCF4BEDh, 21907B93h, 0BF43ABCh, 0BA2B3AD1h, 535B7DA6h
		dd 29F964D8h, 3E777F7Bh, 949A4C51h, 8D4A4BD2h, 0AE977461h
		dd 90F46A53h, 0E2492CC2h, 0C591EBFAh, 0C91383E5h, 2C954B44h
		dd 5C157057h, 0FD1A8D64h, 9CB2C72Ah, 4AD3995Ch,	82F6DDFDh
		dd 0C45A8C87h, 0EF2A0DA8h, 8E7EA2C3h, 636F9F67h, 311DBBDBh
		dd 13BCBBC4h, 0F6C6543Fh, 0AB3228C5h, 36104296h, 57BB9240h
		dd 43F53855h, 65C4437Eh, 0FAA6447h, 1649E94Ch, 0FD506AECh
		dd 0DBCA4914h, 0BECA5444h, 0EF5F0EA3h
dword_100252B0	dd 0FB2E2D8Ch		; DATA XREF: sub_10002BB0+187r
		dd 386FB537h, 0F35A069Fh, 7AD0A08Ch, 14F9CFDEh,	5FD35995h
		dd 0AD5D5D51h, 503371D8h, 3A3B031Dh, 0DEB40032h, 0E5B1E47Fh
		dd 80F4836Bh, 8AB83B10h, 420AE8DBh, 0BED78D9Eh,	3D5ADEEDh
		dd 49FEDBC6h, 751EE96Ah, 9E3FF166h, 6505FF3Fh, 6262CADEh
		dd 953ECF3h, 66D537A0h,	0B6147262h, 50673251h, 9E2FE1C1h
		dd 96534E98h, 92C44B55h, 0F080B4C3h, 4B00C935h,	0B192855Ch
		dd 51A56EE8h, 11C99F38h, 34DF14B6h, 82824064h, 936916DEh
		dd 325C4E89h, 9E4E0AF2h, 4F9963BDh, 0C29015F3h,	0F4B76FFEh
		dd 0B8ED4ADh, 0D222F5D2h, 0F7136571h, 0B6757B82h, 0BD45B4C1h
		dd 5BCF958Fh, 18EF3295h, 7EDFD35Fh, 0EB25DD22h,	9A3BBFE1h
		dd 3C4F7555h, 4576738h,	0F6275704h, 8A570E34h, 0CA7DFF7Ch
		dd 9DF8068Ch, 19D8E4DBh, 8FFD4DDDh, 0E85306A0h,	3F700033h
		dd 9ABDC36Bh, 0EFA9B578h, 9267DA6Dh
dword_100253B0	dd 3A212D20h		; DATA XREF: sub_10002BB0+237r
		dd 15051EAAh, 8684CA5Ch, 0DF8115C0h, 0E09F06D4h, 0FEFEDC1h
		dd 0BBC3B3FEh, 0BF56A528h, 0C25C11E3h, 0FAFA0BC0h, 2006D33Dh
		dd 66E4C9E2h, 3BC0B728h, 49C6963Ch, 4986CF3Bh, 0A35BAF31h
		dd 0DF1063ECh, 0AC682FDAh, 0FA493A7Bh, 37FE0DE6h, 5C8E5617h
		dd 0F7439748h, 4BE3BCA0h, 1D58DE42h, 8B35DD9h, 0E1A4BD35h
		dd 0AB64C380h, 0FBAD9721h, 3DA3EE71h, 16FAAA9Ch, 0DA324660h
		dd 92102E44h, 8098D820h, 705B7584h, 19330091h, 0EC2AC969h
		dd 0F5FE53Dh, 1F97A79Ah, 651DC379h, 0A1C56274h,	844B6523h
		dd 0F39803A1h, 0CA2402F1h, 0A2C8D4E5h, 7D72AD30h, 8E1A6029h
		dd 0DAA4236Fh, 9C45A468h, 18447039h, 0F8FE734Bh, 7E1D5333h
		dd 0C7AC9393h, 0FD6B6E1Eh, 71A6BA9Eh, 0D66A4770h, 6EA23282h
		dd 0BAB07220h, 6BBB91ECh, 330A84CCh, 0EB8D8A2Bh, 67CACD71h
		dd 0D410AD1Bh, 29C04FCEh, 0FAEDFAECh
dword_100254B0	dd 9D740E35h		; DATA XREF: sub_10002BB0+2E7r
		dd 3167C7EBh, 0BB0BFF9Fh, 2FB4665Eh, 4F6072BFh,	0C8ECBDE9h
		dd 395F7917h, 2E54B483h, 20D3B901h, 42D4CB47h, 0C1366EF2h
		dd 8EEFAD97h, 5EEE51E6h, 9DB4889Eh, 4B773EDAh, 5348AEE8h
		dd 25D3C42Ch, 54B7236Bh, 0FB8F953Ch, 56C56D6Fh,	0E286939h
		dd 0E8319B74h, 0C12B7776h, 93818944h, 5FECF6FCh, 1DFC898Fh
		dd 8C5853A4h, 26C0C0E9h, 276DDFE6h, 0B63E8EB1h,	9602E147h
		dd 3D7F5FC2h, 0EA2F6CC5h, 0FC395EAAh, 200CA77h,	0CE7C645Ch
		dd 582637Dh, 555BF7EDh,	76EBC058h, 375595D7h, 0AD177D85h
		dd 97FD11D2h, 5EC2B548h, 0E0C062C7h, 1461A868h,	3A25CA41h
		dd 225448ECh, 54692B83h, 9A99C8FDh, 0A30337EEh,	0B0320F8Fh
		dd 43974AAh, 8FC2D97Ch,	0BEC4F2BEh, 7F7A7ADDh, 5980D372h
		dd 2DA1A018h, 48A9A36Fh, 0EAA620EDh, 988310AAh,	6E69130Ch
		dd 0D06B31CDh, 305EA666h, 81D5820Ch
dword_100255B0	dd 2 dup(0)		; DATA XREF: sub_10002BB0+84o
		dd offset asc_10024876+1 ; ""
		dd 1, 0
		dd offset dword_10024BD4+3Ch
		dd 100h, 0
		dd offset dword_10024BD4+13Ch
		dd 3, 0
		dd offset dword_10024D2C+4
		dd 100h, 0
		dd offset dword_10024D2C+104h
		dd 80h,	0
		dd offset dword_10024D2C+184h
		dd 80h,	0
		dd offset dword_10024D2C+204h
		dd 80h,	0
		dd offset dword_10024D2C+284h
		dd 80h,	0
		dd offset dword_10024D2C+304h
		dd 80h
dword_10025620	dd 0F7F69B6Ah, 1179EDCEh, 9AC8C7F0h, 0B157D1A5h, 763B5A7Bh
					; DATA XREF: sub_10002F40+6Fo
					; sub_10002F40+189o
		dd 0BC7C7B4Eh, 1C1C76F2h, 2F53C57Fh
aFirefoxAndTh_0	db 'Firefox and ThunderBird are awesome!',0 ; DATA XREF: sub_10002F40+145o
		align 4
dword_10025668	dd 862A0806h, 33DCE48h,	701h, 0DF5922ADh, 6E4CECE5h, 4BF043F9h
					; DATA XREF: sub_10003390+A5o
					; .rdata:1002584Co
		dd 0C651502Dh, 0CF8B9991h
dword_10025688	dd 57CBB107h, 0D610A720h, 1C4B379Dh, 0FF9035DCh, 95982D1Ah
					; DATA XREF: sub_10003390+9Eo
		dd 7FEB2F1Bh, 0C0CA81BBh, 0C5EA7569h, 49626A59h, 0E1C9503Dh
		dd 9BFF3B27h, 0DD676613h, 2D0DD17Dh, 1B04447Ch,	0C5122116h
		dd 759EBDCBh, 9DD1B080h, 28F3A46Eh, 8AA9249Fh, 630CD049h
		dd 0F90459E8h, 0C05E4A89h, 6B67D26Dh, 0C838137h, 0FD8A3AFEh
		dd 91083BA0h, 63B5CB1Ch, 0D0701CB0h, 2E60E1AEh,	0C754EB12h
		dd 0AECCC6CFh, 63325297h, 0EA55EBD3h, 0D7D54C2Fh, 49ECDA3Fh
		dd 56140B27h, 4DBE09C5h, 2B751509h, 30D42A3h, 0F40FDF71h
		dd 460CE90Eh, 0A63F3D93h, 0E5CADB6Ch, 64C896ACh, 354BEC5Ch
		dd 5AFBFC65h, 0A11B041Bh, 1588FD0Eh, 0D8A96E78h, 0A4854ACDh
		dd 5D6EB645h, 0F6615021h, 7A5CDF5Fh, 0D3190DDEh, 0CC143BC1h
		dd 17DBED8Eh, 86BACAB6h, 2D51EAA9h, 0DA16A9C1h,	8A597BF8h
		dd 67A4CBDFh, 24EA4400h, 4BCBE573h, 25312AAFh, 163F2822h
		dd 0EBF78210h, 9DD0D94h, 79081422h, 0F10B11BAh,	0AC672DFFh
		dd 5155B6EBh, 25A79769h, 9BA09C6Bh, 279B08D5h, 697A1C42h
		dd 0ED2EE657h, 0E8255BA9h, 1FEDD21Fh, 1780E7DFh, 384D0DBAh
aMozillaRulesWo	db 'Mozilla Rules World!',0 ; DATA XREF: sub_100031B0+12o
		align 10h
aRandomDsaSigna	db 'Random DSA Signature',0 ; DATA XREF: sub_100031B0+67o
		align 4
aDsaSignatureDi	db 'DSA Signature Digest',0 ; DATA XREF: sub_100031B0+84o
		align 10h
dword_10025810	dd 793A7C25h		; DATA XREF: sub_100031B0+B4r
		dd 32B74532h, 6362CA70h, 2C29F62Bh, 0CE032A22h,	72111548h
		dd 7AF57E7Bh, 0DE3B10F3h, 0D79EC134h, 38779E27h
dword_10025838	dd 2 dup(0)		; DATA XREF: sub_100031B0+17o
		dd offset dword_10025688+40h
		dd 80h,	0
		dd offset dword_10025668+0Ch
		dd 14h,	0
		dd offset dword_10025688+0C0h
		dd 80h
dword_10025860	dd 779C8985h, 1AFF79A3h, 3E2F6F86h, 9C8CF92Eh, 0EDEBEF9Dh
					; DATA XREF: sub_100032D0+1Bo
dword_10025874	dd 0CAE34865h, 0F72D64ACh, 794ED37Bh, 0A8A67DC9h, 8F1FC2A2h
					; DATA XREF: sub_100032D0+20o
		dd 0A1D3B9E9h, 0CD0CF73Fh, 0CEBFCAA6h, 0F1B60E84h, 0A3A9BE0Dh
dword_1002589C	dd 7FF1867Ah		; DATA XREF: sub_100032D0+43r
		dd 0D96E4EBDh, 0D021260Ah, 7386CB19h, 0D7601F10h
aSoftokn3_dll_0	db 'softokn3.dll',0     ; DATA XREF: sub_10003390-2Bo
					; sub_10004C60+Bo ...
		align 10h
aC_initialize0x	db 'C_Initialize()=0x%08lX power-up self-tests failed',0
					; DATA XREF: sub_10003640+E3o
		align 4
aNss_enable_aud	db 'NSS_ENABLE_AUDIT',0 ; DATA XREF: sub_10003640:loc_1000368Eo
		align 4
aC_inittokenSlo	db 'C_InitToken(slotID=%lu, pLabel="%.32s")=0x%08lX',0
					; DATA XREF: sub_10003890+4Do
aC_initpinHsess	db 'C_InitPIN(hSession=0x%08lX)=0x%08lX',0 ; DATA XREF: sub_10003910+79o
aC_setpinHsessi	db 'C_SetPIN(hSession=0x%08lX)=0x%08lX',0 ; DATA XREF: sub_100039C0+8Do
		align 10h
aC_loginHsessio	db 'C_Login(hSession=0x%08lX, userType=%lu)=0x%08lX',0
					; DATA XREF: sub_10003B10+86o
aC_logoutHsessi	db 'C_Logout(hSession=0x%08lX)=0x%08lX',0 ; DATA XREF: sub_10003BD0+5Do
		align 4
aEncrypt	db 'Encrypt',0          ; DATA XREF: sub_10004050+48o
aDecrypt	db 'Decrypt',0          ; DATA XREF: sub_10004140+48o
aSign		db 'Sign',0             ; DATA XREF: sub_100042B0+48o
		align 4
aSignrecover	db 'SignRecover',0      ; DATA XREF: sub_100043A0+48o
aVerify		db 'Verify',0           ; DATA XREF: sub_10004430+48o
		align 10h
aVerifyrecover	db 'VerifyRecover',0    ; DATA XREF: sub_10004520+48o
		align 10h
aC_generaterand	db 'C_GenerateRandom(hSession=0x%08lX, pRandomData=%p, ulRandomLen=%l'
					; DATA XREF: sub_10004950+79o
		db 'u)=0x%08lX self-test: continuous RNG test failed',0
		align 4
aNssdbm3_dll	db 'nssdbm3.dll',0      ; DATA XREF: .data:off_10029114o
aLegacy_setcryp	db 'legacy_SetCryptFunctions',0 ; DATA XREF: sub_10004DD0+BEo
		align 4
aLegacy_shutdow	db 'legacy_Shutdown',0  ; DATA XREF: sub_10004DD0+B1o
aLegacy_addsecm	db 'legacy_AddSecmodDB',0 ; DATA XREF: sub_10004DD0+A4o
		align 10h
aLegacy_deletes	db 'legacy_DeleteSecmodDB',0 ; DATA XREF: sub_10004DD0+97o
		align 4
aLegacy_release	db 'legacy_ReleaseSecmodDBData',0 ; DATA XREF: sub_10004DD0+8Ao
		align 4
aLegacy_readsec	db 'legacy_ReadSecmodDB',0 ; DATA XREF: sub_10004DD0+7Do
aLegacy_open	db 'legacy_Open',0      ; DATA XREF: sub_10004DD0+75o
aNss_disable_un	db 'NSS_DISABLE_UNLOAD',0 ; DATA XREF: sub_10005040:loc_10005064o
					; sub_10021800+13o
		align 4
off_10025B38	dd offset NSS_Get_SEC_AnyTemplate_Util ; DATA XREF: .rdata:10025B70o
off_10025B3C	dd offset NSS_Get_SEC_BitStringTemplate_Util ; DATA XREF: .rdata:10025E20o
off_10025B40	dd offset NSS_Get_SEC_ObjectIDTemplate_Util ; DATA XREF: .rdata:10025E10o
off_10025B44	dd offset NSS_Get_SECOID_AlgorithmIDTemplate_Util
					; DATA XREF: .rdata:10025BC0o
dword_10025B48	dd 10h,	2 dup(0)	; DATA XREF: .rdata:10025B90o
		dd 10h,	6, 3 dup(0)
		dd 6011h, 0Ch
		dd offset off_10025B38
		dd 5 dup(0)
dword_10025B88	dd 2011h, 0		; DATA XREF: .rdata:10025BE0o
		dd offset dword_10025B48
		align 8
dword_10025B98	dd 10h,	2 dup(0)	; DATA XREF: sub_1000FB90+1D1o
					; sub_10010100+5Bo
		dd 38h,	2, 4, 2	dup(0)
		dd 4800h, 10h
		dd offset off_10025B44
		align 8
		dd 4, 28h, 2 dup(0)
		dd 1A0h, 34h
		dd offset dword_10025B88
		dd 5 dup(0)
dword_10025BF8	dd 10h,	2 dup(0)	; DATA XREF: sub_1000FB90+14Do
					; sub_10010100+FBo
		dd 28h,	2, 4, 2	dup(0)
		dd 2, 10h, 2 dup(0)
		dd 2, 1Ch, 6 dup(0)
dword_10025C48	dd 10h,	2 dup(0)	; DATA XREF: sub_1000FB90+16Eo
					; sub_10010100+125o
		dd 0B0h, 2, 0Ch, 2 dup(0)
		dd 2, 18h, 2 dup(0)
		dd 2, 24h, 2 dup(0)
		dd 2, 30h, 2 dup(0)
		dd 2, 3Ch, 2 dup(0)
		dd 2, 48h, 2 dup(0)
		dd 2, 54h, 2 dup(0)
		dd 2, 60h, 2 dup(0)
		dd 2, 6Ch, 6 dup(0)
		dd 10h,	2 dup(0)
		dd 0B0h, 2, 30h, 2 dup(0)
		dd 2, 3Ch, 6 dup(0)
dword_10025D38	dd 2, 3Ch, 2 dup(0)	; DATA XREF: sub_1000FB90+130o
					; sub_10010100+F3o
		dd 10h,	2 dup(0)
		dd 0B0h, 2, 24h, 2 dup(0)
		dd 2, 30h, 2 dup(0)
		dd 2, 18h, 2 dup(0)
		dd 2, 0Ch, 6 dup(0)
		dd 100000h, 4, 0
		dd 84h,	6, 78h,	0
		dd 1, 4	dup(0)
dword_10025DD8	dd 10h,	2 dup(0)	; DATA XREF: sub_1000FB90+EAo
					; sub_10010100+C9o
		dd 0B0h, 2, 0A4h, 2 dup(0)
		dd 4, 98h, 2 dup(0)
		dd 43A0h, 80h
		dd offset off_10025B40
		align 8
		dd 43A1h, 8Ch
		dd offset off_10025B3C
		dd 5 dup(0)
off_10025E38	dd offset NSS_Get_SECOID_AlgorithmIDTemplate_Util
					; DATA XREF: .rdata:10025ED8o
					; .rdata:10025EE8o ...
		align 10h
dword_10025E40	dd 10h,	2 dup(0)	; DATA XREF: sub_100067A0:loc_100068CBo
					; sub_10006940+180o
		dd 64h,	2 dup(4), 2 dup(0)
		dd 2, 10h, 6 dup(0)
dword_10025E80	dd 10h,	2 dup(0)	; DATA XREF: sub_100067A0+77o
					; sub_10006940+9Ao
		dd 64h,	2 dup(4), 2 dup(0)
		dd 2, 10h, 6 dup(0)
dword_10025EC0	dd 10h,	2 dup(0)	; DATA XREF: sub_100067A0+11Ao
					; sub_10006940+D8o
		dd 30h,	4800h, 0
		dd offset off_10025E38
		dd 0
		dd 4800h, 18h
		dd offset off_10025E38
		align 20h
dword_10025F00	dd 10h,	2 dup(0)	; DATA XREF: sub_100067A0+AFo
					; sub_10006940+C3o ...
		dd 64h,	2 dup(4), 2 dup(0)
		dd 2, 10h, 2 dup(0)
		dd 2, 1Ch, 2 dup(0)
		dd 4800h, 40h
		dd offset off_10025E38
		align 20h
aSuccess	db 'Success',0          ; DATA XREF: .data:off_10029124o
aNssInternalC_0	db 'NSS Internal Crypto Services    ',0 ; DATA XREF: .data:off_1002911Co
		align 4
aMozillaFoundat	db 'Mozilla Foundation              ',0 ; DATA XREF: .data:off_10029118o
		align 10h
byte_10025FB0	db 1, 0Ah		; DATA XREF: NSC_GetFunctionList+4o
		dd offset sub_1000B240
		dd offset sub_1000B300
		dd offset sub_100085A0
		dd offset NSC_GetFunctionList
		dd offset sub_10008640
		dd offset sub_10008680
		dd offset sub_1000B3F0
		dd offset sub_10008740
		dd offset sub_100087F0
		dd offset sub_10008930
		dd offset sub_10008A20
		dd offset sub_10008B70
		dd offset sub_10008D80
		dd offset sub_10008F10
		dd offset sub_10009040
		dd offset sub_10009090
		dd offset sub_10012BB0
		dd offset sub_10012C50
		dd offset sub_100090D0
		dd offset sub_100092E0
		dd offset sub_1000B800
		dd offset sub_1000B920
		dd offset sub_1000BE20
		dd offset sub_10009380
		dd offset sub_10009390
		dd offset sub_100095C0
		dd offset sub_10009A90
		dd offset sub_10009BC0
		dd offset sub_10009C70
		dd offset sub_1000CD90
		dd offset sub_1000D060
		dd offset sub_1000CDC0
		dd offset sub_1000CF70
		dd offset sub_1000D240
		dd offset sub_1000D520
		dd offset sub_1000D270
		dd offset sub_1000D3E0
		dd offset sub_1000D6D0
		dd offset sub_1000DA50
		dd offset sub_1000DB10
		dd offset sub_10012EF0
		dd offset sub_1000DB70
		dd offset sub_10012FD0
		dd offset sub_1000ECE0
		dd offset sub_1000EA30
		dd offset sub_1000EB90
		dd offset sub_100139D0
		dd offset sub_1000EDF0
		dd offset sub_10013A30
		dd offset sub_100142F0
		dd offset sub_1000EF80
		dd offset sub_1000F0E0
		dd offset sub_1000F2B0
		dd offset sub_1000F4A0
		dd offset sub_10012DF0
		dd offset sub_10012E30
		dd offset sub_10012E70
		dd offset sub_10012EB0
		dd offset sub_100145A0
		dd offset sub_10014FA0
		dd offset sub_1000FDE0
		dd offset sub_10010670
		dd offset sub_10010E70
		dd offset sub_1000F560
		dd offset sub_1000F590
		dd offset sub_10012BA0
		dd offset sub_10012BA0
		dd offset sub_10009CB0
		align 8
dword_100260C8	dd 2 dup(1010101h), 1F1F1F1Fh, 0E0E0E0Eh, 0E0E0E0E0h, 0F1F1F1F1h
					; DATA XREF: sub_10007CA0+81o
		dd 2 dup(0FEFEFEFEh), 2	dup(0FE01FE01h), 2 dup(1FE01FEh)
		dd 0E01FE01Fh, 0F10EF10Eh, 1FE01FE0h, 0EF10EF1h, 0E001E001h
		dd 0F101F101h, 1E001E0h, 1F101F1h, 0FE1FFE1Fh, 0FE0EFE0Eh
		dd 1FFE1FFEh, 0EFE0EFEh, 1F011F01h, 0E010E01h, 11F011Fh
		dd 10E010Eh, 0FEE0FEE0h, 0FEF1FEF1h, 0E0FEE0FEh, 0F1FEF1FEh
dword_10026148	dd 10h,	99h		; DATA XREF: sub_10007CA0+B1o
byte_10026150	db 1			; DATA XREF: sub_10007C70+16r
					; sub_10007CA0+Br ...
		db 2, 4, 7
		dd 0E0D0B08h, 16151310h, 1F1C1A19h, 26252320h, 2F2C2A29h
		dd 37343231h, 3E3D3B38h, 46454340h, 4F4C4A49h, 57545251h
		dd 5E5D5B58h, 67646261h, 6E6D6B68h, 76757370h, 7F7C7A79h
		dd 86858380h, 8F8C8A89h, 97949291h, 9E9D9B98h, 0A7A4A2A1h
		dd 0AEADABA8h, 0B6B5B3B0h, 0BFBCBAB9h, 0C7C4C2C1h, 0CECDCBC8h
		dd 0D6D5D3D0h, 0DFDCDAD9h, 0E6E5E3E0h, 0EFECEAE9h, 0F7F4F2F1h
		dd 0FEFDFBF8h, 20h dup(0)
dword_10026250	dd 0			; DATA XREF: sub_10008740+2Fr
					; sub_10008740:loc_100087D1r ...
dword_10026254	dd 80h			; DATA XREF: sub_100087F0+4Er
					; sub_100087F0+59o
		dd 0FFFFFFFFh
dword_1002625C	dd 10000h		; DATA XREF: sub_10008870+7Dr
dword_10026260	dd 1			; DATA XREF: sub_10008740:loc_10008760r
					; sub_100087F0+41r
dword_10026264	dd 1			; DATA XREF: sub_10008740+49r
		dd 80h,	0FFFFFFFFh, 67B00h
dword_10026274	dd 1			; DATA XREF: sub_10008740:loc_1000877Ar
dword_10026278	dd 0Dh			; DATA XREF: sub_10008740+63r
		dd 80h,	0FFFFFFFFh, 2800h
dword_10026288	dd 1			; DATA XREF: sub_10008740:loc_10008794r
		dd 9, 80h, 0FFFFFFFFh, 60300h, 1, 3, 80h, 0FFFFFFFFh, 67B00h
		dd 1, 4, 80h, 0FFFFFFFFh, 2800h, 1, 5, 80h, 0FFFFFFFFh
		dd 2800h, 1, 6,	80h, 0FFFFFFFFh, 2800h,	1, 46h,	80h, 0FFFFFFFFh
		dd 2800h, 1, 40h, 80h, 0FFFFFFFFh, 2800h, 1, 41h, 80h
		dd 0FFFFFFFFh, 2800h, 1, 42h, 80h, 0FFFFFFFFh, 2800h, 1
		dd 10h,	200h, 0C00h, 10000h, 1,	11h, 200h, 0C00h, 2800h
		dd 1, 2000h, 200h, 0C00h, 8000h, 1, 12h, 200h, 0C00h, 2800h
		dd 1, 20h, 80h,	4000h, 10000h, 1, 21h, 80h, 4000h, 80000h
		dd 1, 1040h, 100h, 209h, 1B10000h, 1, 1050h, 100h, 209h
		dd 1B80000h, 1,	1041h, 100h, 209h, 1B02800h, 1,	1042h
		dd 100h, 209h, 1B02800h, 1, 100h, 1, 80h, 8000h, 1, 101h
		dd 1, 80h, 60300h, 1, 102h, 1, 80h, 60300h, 1, 103h, 1
		dd 80h,	2800h, 1, 104h,	1, 80h,	2800h, 1, 105h,	1, 80h
		dd 60300h, 1, 110h, 1, 100h, 8000h, 0
		dd 111h, 1, 100h, 60300h, 0
		dd 120h, 2 dup(8), 8000h, 1, 121h, 2 dup(8), 60300h, 1
		dd 122h, 2 dup(8), 60300h, 1, 123h, 2 dup(8), 2800h, 1
		dd 124h, 2 dup(8), 2800h, 1, 125h, 2 dup(8), 60300h, 1
		dd 130h, 2 dup(18h), 8000h, 1, 131h, 2 dup(18h), 8000h
		dd 1, 132h, 2 dup(18h),	60300h,	1, 133h, 2 dup(18h), 60300h
		dd 1, 134h, 2 dup(18h),	2800h, 1, 135h,	2 dup(18h), 2800h
		dd 1, 136h, 2 dup(18h),	60300h,	1, 140h, 2 dup(8), 8000h
		dd 1, 141h, 2 dup(8), 60300h, 1, 142h, 2 dup(8), 60300h
		dd 1, 143h, 2 dup(8), 2800h, 1,	144h, 2	dup(8),	2800h
		dd 1, 145h, 2 dup(8), 60300h, 1, 1080h,	10h, 20h, 8000h
		dd 1, 1081h, 10h, 20h, 60300h, 1, 1082h, 10h, 20h, 60300h
		dd 1, 1083h, 10h, 20h, 2800h, 1, 1084h,	10h, 20h, 2800h
		dd 1, 1085h, 10h, 20h, 60300h, 1, 1089h, 10h, 20h, 300h
		dd 1, 1086h, 10h, 20h, 300h, 1,	1087h, 10h, 20h, 300h
		dd 1, 550h, 10h, 20h, 8000h, 1,	551h, 10h, 20h,	60300h
		dd 1, 552h, 10h, 20h, 60300h, 1, 553h, 10h, 20h, 2800h
		dd 1, 554h, 10h, 20h, 2800h, 1,	555h, 10h, 20h,	60300h
		dd 1, 650h, 2 dup(10h),	8000h, 1, 651h,	2 dup(10h), 60300h
		dd 1, 652h, 2 dup(10h),	60300h,	1, 653h, 2 dup(10h), 2800h
		dd 1, 654h, 2 dup(10h),	2800h, 1, 655h,	2 dup(10h), 60300h
		dd 1, 200h, 2 dup(0)
		dd 400h, 0
		dd 201h, 1, 80h, 2800h,	1, 202h, 1, 80h, 2800h,	1, 210h
		dd 2 dup(0)
		dd 400h, 0
		dd 211h, 1, 80h, 2800h,	1, 212h, 1, 80h, 2800h,	1, 220h
		dd 2 dup(0)
		dd 400h, 0
		dd 221h, 1, 80h, 2800h,	1, 222h, 1, 80h, 2800h,	1, 255h
		dd 2 dup(0)
		dd 400h, 0
		dd 256h, 1, 80h, 2800h,	1, 257h, 1, 80h, 2800h,	1, 250h
		dd 2 dup(0)
		dd 400h, 0
		dd 251h, 1, 80h, 2800h,	1, 252h, 1, 80h, 2800h,	1, 260h
		dd 2 dup(0)
		dd 400h, 0
		dd 261h, 1, 80h, 2800h,	1, 262h, 1, 80h, 2800h,	1, 270h
		dd 2 dup(0)
		dd 400h, 0
		dd 271h, 1, 80h, 2800h,	1, 272h, 1, 80h, 2800h,	1, 80000373h
		dd 0
		dd 200h, 2800h,	0
aEcs		db 'eCS',0
		align 4
		dd 200h, 2800h,	0
		dd 0CE534353h, 1, 80h, 80000h, 1, 0CE534354h, 1, 80h, 80000h
		dd 1, 0CE534355h, 1, 80h, 80000h, 1, 0CE534356h, 1, 80h
		dd 80000h, 1, 350h, 1, 20h, 8000h, 1, 360h, 1, 20h, 8000h
		dd 0
		dd 362h, 1, 20h, 8000h,	0
		dd 363h, 1, 20h, 8000h,	0
		dd 364h, 1, 20h, 8000h,	0
		dd 365h, 1, 20h, 80000h, 0
		dd 370h, 2 dup(30h), 8000h, 0
		dd 371h, 2 dup(30h), 80000h, 0
		dd 373h, 8, 80h, 80000h, 0
		dd 372h, 2 dup(30h), 80000h, 0
		dd 380h, 0
		dd 10h,	80000h,	0
		dd 381h, 0
		dd 14h,	80000h,	0
		dd 390h, 0
		dd 10h,	80000h,	0
		dd 391h, 0
		dd 10h,	80000h,	0
		dd 392h, 0
		dd 14h,	80000h,	0
		dd 396h, 0
		dd 1Ch,	80000h,	0
		dd 393h, 0
		dd 20h,	80000h,	0
		dd 394h, 0
		dd 30h,	80000h,	0
		dd 395h, 0
		dd 40h,	80000h,	0
		dd 375h, 2 dup(30h), 80000h, 0
aFcs0		db 'fCS0',0
		align 4
a0		db '0',0
		align 10h
		dd 80000h, 0
		dd 377h, 8, 80h, 80000h, 0
aHcs		db 'hCS',8,0
		align 4
aA		db '',0
		align 4
		dd 80000h, 0
		dd 376h, 2 dup(30h), 80000h, 0
aGcs0		db 'gCS0',0
		align 4
a0_0		db '0',0
		align 10h
		dd 80000h, 0
		dd 3A0h, 2 dup(8), 80000h, 1, 3A1h, 2 dup(8), 80000h, 1
		dd 80000002h, 2	dup(8),	8000h, 1, 80000008h, 2 dup(18h)
		dd 8000h, 1, 3A8h, 2 dup(18h), 8000h, 1, 3A9h, 2 dup(18h)
		dd 8000h, 1, 3ABh, 2 dup(28h), 8000h, 1, 3AAh, 2 dup(80h)
		dd 8000h, 1, 3A7h, 2 dup(28h), 8000h, 1, 3A6h, 2 dup(80h)
		dd 8000h, 1, 3C0h, 2 dup(14h), 8000h, 1, 3B0h, 1, 100h
		dd 8000h, 1, 80000009h,	2 dup(14h), 8000h, 1, 8000000Ah
		dd 2 dup(10h), 8000h, 1, 8000000Bh, 2 dup(10h),	8000h
		dd 1, 0CE534351h, 10h, 20h, 60300h, 1, 0CE534352h, 10h
		dd 20h,	60300h,	1, 0CE534357h, 2 dup(0)
		dd 8000h, 1, 0CE534358h, 2 dup(0)
		dd 8000h, 1, 0CE534359h, 2 dup(0)
		dd 8000h, 1, 0CE53435Ah, 2 dup(0)
		dd 8000h, 1, 0CE53435Bh, 2 dup(0)
		dd 80000h, 1, 0CE53435Ch, 2 dup(0)
		dd 80000h, 1, 0CE53435Dh, 2 dup(0)
		dd 80000h, 1, 0CE53435Eh, 2 dup(0)
		dd 80000h, 1, 0CE53435Fh, 2 dup(0)
		dd 80000h, 1, 0CE534360h, 2 dup(0)
		dd 80000h, 1, 0CE534361h, 2 dup(0)
		dd 80000h, 1, 0CE534362h, 2 dup(0)
		dd 80000h, 1, 0CE534363h, 2 dup(0)
		dd 400h, 1, 0CE534364h,	2 dup(0)
		dd 400h, 1
aNssGenericCryp	db 'NSS Generic Crypto Services     ',0
					; DATA XREF: sub_1000AB70:loc_1000ABEFo
		align 4
aNssCertificate	db 'NSS Certificate DB              ',0
					; DATA XREF: sub_1000AB70:loc_1000ABE8o
		align 4
aNssFips1402Cer	db 'NSS FIPS 140-2 Certificate DB   ',0
					; DATA XREF: sub_1000AB70:loc_1000ABE1o
		align 10h
; char aNssApplicati_0[]
aNssApplicati_0	db 'NSS Application Token %08x  ',0 ; DATA XREF: sub_1000AB70+57o
		align 10h
aNssInternalCry	db 'NSS Internal Cryptographic Services                             ',0
					; DATA XREF: sub_10007E10:loc_10007E45o
		align 8
aNssUserPrivate	db 'NSS User Private Key and Certificate Services                   ',0
					; DATA XREF: sub_10007E10:loc_10007E3Fo
		align 10h
aNssFips1402Use	db 'NSS FIPS 140-2 User Private Key Services                        ',0
					; DATA XREF: sub_10007E10:loc_10007E39o
		align 4
; char aNssApplication[]
aNssApplication	db 'NSS Application Slot %08x                                   ',0
					; DATA XREF: sub_10007E10+10o
		align 4
asc_10026FE4	db ' ',0                ; DATA XREF: NSC_ModuleDBFunc:loc_100083D7o
					; sub_1000AB70+F3o
word_10026FE6	dw 0			; DATA XREF: sub_10008B70+1C7o
					; sub_10009CC0+1Ao ...
aDisabledFipsMo	db 'disabled FIPS mode',0 ; DATA XREF: sub_1000B0B0:loc_1000B1CBo
		align 4
aEnabledFipsMod	db 'enabled FIPS mode',0 ; DATA XREF: sub_1000B0B0+114o
		align 10h
dword_10027010	dd 30303030h		; DATA XREF: sub_1000B3F0+94r
					; sub_1000B3F0+B7r
dword_10027014	dd 30303030h		; DATA XREF: sub_1000B3F0+9Dr
					; sub_1000B3F0+C3r
dword_10027018	dd 30303030h		; DATA XREF: sub_1000B3F0+A6r
					; sub_1000B3F0+CEr
dword_1002701C	dd 30303030h		; DATA XREF: sub_1000B3F0+AEr
					; sub_1000B3F0+DAr
		dd 0
dword_10027024	dd 2053534Eh		; DATA XREF: sub_1000B3F0+72r
dword_10027028	dd 20202033h		; DATA XREF: sub_1000B3F0+7Ar
dword_1002702C	dd 20202020h		; DATA XREF: sub_1000B3F0+83r
dword_10027030	dd 20202020h		; DATA XREF: sub_1000B3F0+8Cr
		align 8
aIiiiiiiii	db 'IIIIIIIII',0        ; DATA XREF: .rdata:1002709Co
		align 4
aHhhhhhhh	db 'HHHHHHHH',0         ; DATA XREF: .rdata:10027098o
		align 10h
aGgggggg	db 'GGGGGGG',0          ; DATA XREF: .rdata:10027094o
aFfffff		db 'FFFFFF',0           ; DATA XREF: .rdata:10027090o
		align 10h
aEeeee		db 'EEEEE',0            ; DATA XREF: .rdata:1002708Co
		align 4
aDddd		db 'DDDD',0             ; DATA XREF: .rdata:off_10027088o
		align 10h
aCcc		db 'CCC',0              ; DATA XREF: .rdata:10027084o
aBb		db 'BB',0               ; DATA XREF: .rdata:10027080o
		align 4
aA_0		db 'A',0                ; DATA XREF: .rdata:off_1002707Co
		align 4
off_1002707C	dd offset aA_0		; DATA XREF: sub_10010E70+1283o
					; sub_10010E70+1647o
					; "A"
		dd offset aBb		; "BB"
		dd offset aCcc		; "CCC"
off_10027088	dd offset aDddd		; DATA XREF: sub_10010E70+1330o
					; "DDDD"
		dd offset aEeeee	; "EEEEE"
		dd offset aFfffff	; "FFFFFF"
		dd offset aGgggggg	; "GGGGGGG"
		dd offset aHhhhhhhh	; "HHHHHHHH"
		dd offset aIiiiiiiii	; "IIIIIIIII"
aIvBlock	db 'IV block',0         ; DATA XREF: sub_10010E70+1721o
					; sub_10010E70+1AF7o
		align 4
aServerWriteKey	db 'server write key',0 ; DATA XREF: sub_10010E70+1A71o
		align 10h
aClientWriteKey	db 'client write key',0 ; DATA XREF: sub_10010E70+19EEo
		align 4
aKeyExpansion	db 'key expansion',0    ; DATA XREF: sub_10010E70+15D3o
					; sub_10010E70+15FCo
		align 4
aMasterSecret	db 'master secret',0    ; DATA XREF: sub_10010E70+11F3o
					; sub_10010E70+121Co
		align 4
aMozillaRulesTh	db 'Mozilla Rules the World through NSS!',0 ; DATA XREF: sub_10014BA0+368o
					; sub_10014BA0+3A3o
		align 4
aKnownCryptoMes	db 'Known Crypto Message',0 ; DATA XREF: sub_10014BA0+14Co
					; sub_10014BA0+176o ...
		align 8
aC_generateke_0	db 'C_GenerateKeyPair(hSession=0x%08lX, pMechanism->mechanism=0x%08lX'
					; DATA XREF: sub_10014FA0+D55o
		db ')=0x%08lX self-test: pair-wise consistency test failed',0
; char VarName[]
VarName		db 'NSS_USE_DECODED_CKA_EC_POINT',0 ; DATA XREF: sub_10014FA0:loc_10015A2Ao
		align 10h
dword_100271D0	dd 0			; DATA XREF: sub_10017310-C6o
		dd 1, 2, 3, 170h, 5
dword_100271E8	dd 102h, 110h, 111h, 10Ch, 163h, 100h, 6 ; DATA	XREF: sub_10017020+Co
					; sub_10017100+Co ...
dword_10027204	dd 103h, 162h, 104h, 105h, 108h, 10Ah, 106h, 107h, 11h
					; DATA XREF: sub_100171E0+21o
		dd 9
dword_1002722C	dd 104h, 10Ah, 10Bh, 106h, 101h, 5 ; DATA XREF:	sub_10017100+25o
dword_10027244	dd 120h, 122h, 2	; DATA XREF: sub_10017100+73o
dword_10027250	dd 131h, 130h, 132h, 11h, 4 ; DATA XREF: sub_10017100+88o
dword_10027264	dd 130h, 132h, 11h, 3	; DATA XREF: sub_10017100+9Do
dword_10027274	dd 180h, 181h, 2	; DATA XREF: sub_10017100+B2o
dword_10027280	dd 105h, 108h, 109h, 107h, 101h, 103h, 162h, 0D5A0DB00h
					; DATA XREF: sub_10017020+25o
		dd 8
dword_100272A4	dd 120h, 122h, 123h, 124h, 125h, 126h, 127h, 128h, 8
					; DATA XREF: sub_10017020+73o
dword_100272C8	dd 131h, 130h, 132h, 11h, 4 ; DATA XREF: sub_10017020+88o
dword_100272DC	dd 130h, 132h, 11h, 3	; DATA XREF: sub_10017020+9Do
dword_100272EC	dd 180h, 11h, 2		; DATA XREF: sub_10017020+B2o
dword_100272F8	dd 80h,	11h, 101h, 81h,	82h, 5 ; DATA XREF: sub_10017310-80o
dword_10027310	dd 81h,	82h, 0CE5363B4h, 0CE5363B5h, 0CE536358h, 0CE536359h
					; DATA XREF: sub_10017310-42o
		dd 0CE53635Bh, 0CE53635Ah, 0CE536360h, 9
dword_10027338	dd 101h, 0CE534352h, 0CE534354h, 11h, 4	; DATA XREF: sub_10017310-2Eo
dword_1002734C	dd 101h, 11h, 0CE534351h, 0CE534358h, 4	; DATA XREF: sub_10017310-1Ao
dword_10027360	dd 0			; DATA XREF: sub_10019E70+1F0r
		dd 1, 2, 3, 10h, 11h, 12h, 80h,	81h, 82h, 83h, 84h, 85h
		dd 86h,	87h, 88h, 89h, 8Ah, 8Bh, 90h, 100h, 101h, 102h
		dd 103h, 104h, 105h, 106h, 107h, 108h, 109h, 10Ah, 10Bh
		dd 10Ch, 110h, 111h, 120h, 121h, 122h, 123h, 124h, 125h
		dd 126h, 127h, 128h, 130h, 131h, 132h, 133h, 134h, 160h
		dd 161h, 162h, 163h, 164h, 165h, 166h, 170h, 180h, 181h
		dd 200h, 201h, 202h, 210h, 40000211h, 40000212h, 300h
		dd 301h, 302h, 400h, 401h, 402h, 403h, 404h, 405h, 406h
		dd 480h, 481h, 482h, 500h, 501h, 502h, 503h, 0CE534351h
		dd 0CE534352h, 0CE534353h, 0CE534354h, 0CE534355h, 0CE534356h
		dd 0CE534357h, 0CE534358h, 0CE534364h, 0CE534365h, 0CE534366h
		dd 0CE534367h, 0CE534368h, 0CE536351h, 0CE536352h, 0CE536353h
		dd 0CE536354h, 0CE536355h, 0CE536356h, 0CE536357h, 0CE536358h
		dd 0CE536359h, 0CE53635Ah, 0CE53635Bh, 0CE53635Ch, 0CE53635Dh
		dd 0CE53635Eh, 0CE53635Fh, 0CE536360h, 0CE5363B4h, 0CE5363B5h
		dd 0D5A0DB00h, 80000001h, 0CE534369h
dword_10027530	dd 5A00A5h		; DATA XREF: sub_10018320+126o
					; sub_10018BA0+176o ...
aDropTableS	db 'DROP TABLE %s',0    ; DATA XREF: sub_10018180+5o
		align 4
aCreateTemporar	db 'CREATE TEMPORARY TABLE %s AS SELECT * FROM %s',0
					; DATA XREF: sub_10018080+6o
		align 4
aCreateIndexIss	db 'CREATE INDEX issuer ON %s (a81)',0 ; DATA XREF: sub_10018080+50o
					; sub_10019E70+289o
aCreateIndexSub	db 'CREATE INDEX subject ON %s (a101)',0 ; DATA XREF: sub_10018080+7Bo
					; sub_10019E70+2D5o
		align 4
aCreateIndexLab	db 'CREATE INDEX label ON %s (a3)',0 ; DATA XREF: sub_10018080+A2o
					; sub_10019E70+321o
		align 4
aCreateIndexCka	db 'CREATE INDEX ckaid ON %s (a102)',0 ; DATA XREF: sub_10018080+C9o
					; sub_10019E70+36Do
aSelectAllFro_1	db 'SELECT ALL * FROM %s WHERE %s;',0 ; DATA XREF: sub_10018320+C2o
		align 4
aSelectAllFro_0	db 'SELECT ALL * FROM %s;',0 ; DATA XREF: sub_10018320+ADo
		align 10h
aSelectAllSFrom	db 'SELECT ALL %s FROM %s WHERE id=$ID;',0 ; DATA XREF: sub_10018850+81o
aUpdateSSetSWhe	db 'UPDATE %s SET %s WHERE id=$ID;',0 ; DATA XREF: sub_10018BA0+C2o
		align 4
aInsertIntoSIdS	db 'INSERT INTO %s (id%s) VALUES($ID%s);',0 ; DATA XREF: sub_10018F40+11Fo
		align 4
aDeleteFromSWhe	db 'DELETE FROM %s WHERE (id=$ID);',0 ; DATA XREF: .text:10019310o
		align 4
aBeginImmediate	db 'BEGIN IMMEDIATE TRANSACTION;',0 ; DATA XREF: .text:1001946Ao
					; sub_10019E70+124o
		align 4
aCommitTransact	db 'COMMIT TRANSACTION;',0 ; DATA XREF: .text:10019704o
					; sub_10019E70+58Do
aRollbackTransa	db 'ROLLBACK TRANSACTION;',0 ; DATA XREF: .text:10019724o
					; sub_10019E70+5BEo
		align 4
aSelectAllFromM	db 'SELECT ALL * FROM metaData WHERE id=$ID;',0
					; DATA XREF: sub_10019740+63o
					; sub_10019740+9Bo
		align 8
aCreateTableMet	db 'CREATE TABLE metaData (id PRIMARY KEY UNIQUE ON CONFLICT REPLACE,'
					; DATA XREF: sub_10019C70+AFo
		db ' item1, item2);',0
		align 10h
aInsertIntoMeta	db 'INSERT INTO metaData (id,item1,item2) VALUES($ID,$ITEM1,$ITEM2);',0
					; DATA XREF: sub_10019C70+1Ao
		align 4
aInsertIntoMe_0	db 'INSERT INTO metaData (id,item1) VALUES($ID,$ITEM1);',0
					; DATA XREF: sub_10019C70+CFo
aDropTableIfExi	db 'DROP TABLE IF EXISTS %s;',0 ; DATA XREF: .text:10019A83o
		align 4
aSelectAllFromS	db 'SELECT ALL * FROM %s LIMIT 0;',0 ; DATA XREF: sub_10019C30+2o
					; sub_10019C70+6Fo ...
		align 4
aCreateTableSId	db 'CREATE TABLE %s (id PRIMARY KEY UNIQUE ON CONFLICT ABORT%s)',0
					; DATA XREF: sub_10019E70+230o
aAlterTableSAdd	db 'ALTER TABLE %s ADD COLUMN a%x',0
		align 10h
aSCSSD_db	db '%s%c%s%s%d.db',0    ; DATA XREF: sub_1001A510+25o
					; sub_1001A510+4Co
		align 10h
a_LuS		db '.%lu%s',0           ; DATA XREF: sub_10017F90+9Do
		align 4
a_doesnotexist_	db '_dOeSnotExist_.db',0 ; DATA XREF: sub_10017F90+94o
		align 4
aAnd		db ' AND ',0            ; DATA XREF: sub_10018320+75o
		align 4
aSSaXDataD	db '%s%sa%x=$DATA%d',0  ; DATA XREF: sub_10018320+68o
aAX		db 'a%x',0              ; DATA XREF: sub_10018850+64o
aSAXValueD	db '%s,a%x=$VALUE%d',0  ; DATA XREF: sub_10018BA0+8Eo
aAXValueD	db 'a%x=$VALUE%d',0     ; DATA XREF: sub_10018BA0+74o
		align 4
aSValueD	db '%s,$VALUE%d',0      ; DATA XREF: sub_10018F40+CCo
aSAX_0		db '%s,a%x',0           ; DATA XREF: sub_10018F40+B8o
		align 4
aDropTableIfE_0	db 'DROP TABLE IF EXISTS metaData;',0 ; DATA XREF: .text:10019AB5o
		align 4
aMetadata	db 'metaData',0         ; DATA XREF: sub_10019C70:loc_10019CDAo
					; sub_10019E70+3C4o
		align 4
aScache		db '%sCache',0          ; DATA XREF: sub_10019E70+46Ao
aPragmaTemp_sto	db 'PRAGMA temp_store=MEMORY',0 ; DATA XREF: sub_10019E70+45Eo
		align 4
aYes		db 'yes',0              ; DATA XREF: sub_10019E70+409o
					; sub_1001A510+A6o
aNo		db 'no',0               ; DATA XREF: sub_10019E70+3F3o
					; sub_1001A510+94o
		align 4
aNss_sdb_use_ca	db 'NSS_SDB_USE_CACHE',0 ; DATA XREF: sub_10019E70:loc_1001A24Fo
					; sub_1001A510+79o
		align 4
aSAX		db '%s, a%x',0          ; DATA XREF: sub_10019E70+1F9o
aNssprivate	db 'nssPrivate',0       ; DATA XREF: sub_1001A510+10Fo
		align 4
aNsspublic	db 'nssPublic',0        ; DATA XREF: sub_1001A510+E4o
		align 4
aKey		db 'key',0              ; DATA XREF: sub_1001A510+3Fo
					; sub_1001A850+23o ...
aCert		db 'cert',0             ; DATA XREF: sub_1001A510+14o
					; sub_1001A850+2Ao ...
		align 8
; char Format[]
Format		db 'sig_%s_%08x_%08x',0 ; DATA XREF: sub_1001A850+3Eo
					; sub_1001A8C0+29Co
		align 4
a2		db ' #2',0
dword_100279D0	dd 0			; DATA XREF: sub_1001BEE0:loc_1001BF10r
		dd 1, 2, 3, 10h, 11h, 12h, 80h,	81h, 82h, 83h, 84h, 85h
		dd 86h,	87h, 88h, 89h, 8Ah, 8Bh, 90h, 100h, 101h, 102h
		dd 103h, 104h, 105h, 106h, 107h, 108h, 109h, 10Ah, 10Bh
		dd 10Ch, 110h, 111h, 120h, 121h, 122h, 123h, 124h, 125h
		dd 126h, 127h, 128h, 130h, 131h, 132h, 133h, 134h, 160h
		dd 161h, 162h, 163h, 164h, 165h, 166h, 170h, 180h, 181h
		dd 200h, 201h, 202h, 210h, 40000211h, 40000212h, 300h
		dd 301h, 302h, 400h, 401h, 402h, 403h, 404h, 405h, 406h
		dd 480h, 481h, 482h, 500h, 501h, 502h, 503h, 0CE534351h
		dd 0CE534352h, 0CE534353h, 0CE534354h, 0CE534355h, 0CE534356h
		dd 0CE534357h, 0CE534358h, 0CE534364h, 0CE534365h, 0CE534366h
		dd 0CE534367h, 0CE534368h, 0CE536351h, 0CE536352h, 0CE536353h
		dd 0CE536354h, 0CE536355h, 0CE536356h, 0CE536357h, 0CE536358h
		dd 0CE536359h, 0CE53635Ah, 0CE53635Bh, 0CE53635Ch, 0CE53635Dh
		dd 0CE53635Eh, 0CE53635Fh, 0CE536360h, 0CE5363B4h, 0CE5363B5h
		dd 0D5A0DB00h, 80000001h, 0CE534369h
aUpd_S_S	db 'upd_%s_%s',0        ; DATA XREF: sub_1001BFB0+53o
					; sub_1001C080+46o
		align 4
		dd 0CE536358h, 0CE536359h, 0CE53635Ah, 0CE53635Bh, 0CE53635Dh
		dd 0CE53635Eh, 0CE53635Fh
aPassword	db 'password',0         ; DATA XREF: sub_1001CB20+169o
					; sub_1001CB20+188o ...
		align 4
aSD_db		db '%s%d.db',0          ; DATA XREF: sub_1001CEB0+17o
aSSkey		db '%s/%skey',0         ; DATA XREF: sub_1001CF10+6Bo
		align 4
aSScert		db '%s/%scert',0        ; DATA XREF: sub_1001CF10+26o
		align 4
aOptimizespace	db 'optimizeSpace',0    ; DATA XREF: sub_1001D820+5Do
					; sub_1001D8A0+5Do
		align 4
aPasswordrequir	db 'passwordRequired',0 ; DATA XREF: sub_1001D820+4Ao
					; sub_1001D8A0+4Ao
		align 4
aForceopen	db 'forceOpen',0        ; DATA XREF: sub_1001D820+37o
					; sub_1001D8A0+37o
		align 4
aNokeydb	db 'noKeyDB',0          ; DATA XREF: sub_1001D820+24o
aNocertdb	db 'noCertDB',0         ; DATA XREF: sub_1001D820+11o
					; sub_1001D8A0+24o
		align 4
aFlags_0	db 'flags',0            ; DATA XREF: sub_1001D820+6o
					; sub_1001D820+16o ...
		align 10h
aReadonly	db 'readOnly',0         ; DATA XREF: sub_1001D820+1o
					; sub_1001D8A0+11o
		align 4
aNomoddb	db 'noModDB',0          ; DATA XREF: sub_1001D8A0+1o
aFlags		db 'flags=',0           ; DATA XREF: sub_1001D920+2FFo
					; sub_1001DDF0+48Eo
		align 4
aMinpwlen	db 'minPWLen=',0        ; DATA XREF: sub_1001D920+2ACo
					; sub_1001DDF0+449o
		align 4
aSlotdescriptio	db 'slotDescription=',0 ; DATA XREF: sub_1001D920+26Bo
		align 4
aUpdatetokendes	db 'updateTokenDescription=',0 ; DATA XREF: sub_1001D920+22Ao
					; sub_1001DDF0+404o
aTokendescripti	db 'tokenDescription=',0 ; DATA XREF: sub_1001D920+1E9o
		align 4
aKeyprefix	db 'keyPrefix=',0       ; DATA XREF: sub_1001D920+1A8o
					; sub_1001DDF0+221o
		align 4
aCertprefix	db 'certPrefix=',0      ; DATA XREF: sub_1001D920+167o
					; sub_1001DDF0+1E0o
aUpdateid	db 'updateID=',0        ; DATA XREF: sub_1001D920+126o
					; sub_1001DDF0+DCo
		align 4
aUpdatekeyprefi	db 'updateKeyPrefix=',0 ; DATA XREF: sub_1001D920+E5o
		align 10h
aUpdatecertpref	db 'updateCertPrefix=',0 ; DATA XREF: sub_1001D920+A4o
		align 4
aUpdatedir	db 'updateDir=',0       ; DATA XREF: sub_1001D920+63o
					; sub_1001DDF0+9Bo
		align 10h
aConfigdir	db 'configDir=',0       ; DATA XREF: sub_1001D920+22o
					; sub_1001DDF0+5Ao
		align 4
aTokens		db 'tokens=',0          ; DATA XREF: sub_1001DDF0+4F9o
aFipstokendescr	db 'FIPSTokenDescription=',0 ; DATA XREF: sub_1001DDF0+3BFo
		align 4
aFipsslotdescri	db 'FIPSSlotDescription=',0 ; DATA XREF: sub_1001DDF0+37Ao
		align 4
aDbslotdescript	db 'dbSlotDescription=',0 ; DATA XREF: sub_1001DDF0+335o
		align 4
aCryptoslotdesc	db 'cryptoSlotDescription=',0 ; DATA XREF: sub_1001DDF0+2F0o
		align 10h
aDbtokendescrip	db 'dbTokenDescription=',0 ; DATA XREF: sub_1001DDF0+2ABo
aCryptotokendes	db 'cryptoTokenDescription=',0 ; DATA XREF: sub_1001DDF0+266o
aLibrarydescrip	db 'libraryDescription=',0 ; DATA XREF: sub_1001DDF0+19Fo
aManufacturerid	db 'manufacturerID=',0  ; DATA XREF: sub_1001DDF0+15Eo
aSecmod		db 'secmod=',0          ; DATA XREF: sub_1001DDF0+11Do
off_10027DC8	dd offset NSS_Get_SECOID_AlgorithmIDTemplate_Util
					; DATA XREF: .rdata:10027DE8o
		align 10h
dword_10027DD0	dd 10h,	2 dup(0)	; DATA XREF: sub_1001E780+1Co
					; sub_1001E830+62o
		dd 24h,	4800h, 0
		dd offset off_10027DC8
		align 10h
		dd 4, 18h, 6 dup(0)
aPasswordCheck	db 'password-check',0   ; DATA XREF: sub_1001EF70+115o
					; sub_1001F7A0+1B3o
		align 10h
byte_10027E20	db 24h			; DATA XREF: sub_100085A0+1r
aHeaderNss3_17_	db 'Header: NSS 3.17.1 Basic ECC  Sep 27 2014 21:02:54 $',0
		align 4
byte_10027E58	db 40h			; DATA XREF: sub_100085A0+8r
aNss3_17_1Basic	db '(#)NSS 3.17.1 Basic ECC  Sep 27 2014 21:02:54',0
		align 4
aFreebl3_dll	db 'freebl3.dll',0      ; DATA XREF: .data:off_10029228o
aFreebl_getvect	db 'FREEBL_GetVector',0 ; DATA XREF: sub_10020A60+30o
		align 4
dword_10027EA8	dd 0			; DATA XREF: sub_10021800:loc_1002183Er
dword_10027EAC	dd 0			; DATA XREF: sub_10021800+44r
dword_10027EB0	dd 0			; DATA XREF: sub_10021800+4Ar
		align 8
; struct _EXCEPTION_POINTERS ExceptionInfo
ExceptionInfo	_EXCEPTION_POINTERS <offset dword_100296A0, offset dword_100296F0>
					; DATA XREF: sub_10023481+C3o
		dd 86808006h, 808180h, 86031000h, 80828680h, 45050514h
		dd 85854545h, 585h, 50803030h, 8008080h, 38272800h, 805750h
		dd 30370007h, 88505030h, 20000000h, 80888028h, 80h
aHhhXppwpp	db '```hhh',8,8,7,'xppwpp',8,8,0
		dw 800h
		dd 7000800h, 8,	0
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 2			; SEHandlerCount
		align 10h
___safe_se_handler_table dd rva	sub_10022DD0 ; DATA XREF: .rdata:10027F60o
		dd rva sub_100237A1
dword_10027F78	dd 0FFFFFFFEh, 0	; DATA XREF: DllEntryPoint-25Ao
		dd 0FFFFFFB4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10023460
		align 8
		dd offset sub_10023270
		dd offset sub_10023284
		dd 0
		dd offset sub_100232B2
		dd offset sub_100232C6
		align 10h
		dd offset sub_100232F5
		dd offset sub_10023309
		dd 0
		dd offset sub_1002333A
		dd offset sub_1002334E
		align 8
		dd offset sub_10023369
		dd offset sub_1002337D
		dd 0
		dd offset sub_1002339E
		dd offset sub_100233B2
		align 10h
		dd offset sub_100233E3
		dd offset sub_100233F7
		dd 0
		dd offset sub_1002342A
		dd offset sub_1002343E
		align 8
stru_10027FF8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100236C4+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100236C4
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1002370A	; ScopeRecord.FilterFunc
		dd offset loc_1002371E	; ScopeRecord.HandlerFunc
__IMPORT_DESCRIPTOR_sqlite3 dd rva off_100282B0	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aSqlite3_dll	; DLL Name
		dd rva __imp_sqlite3_bind_text ; Import	Address	Table
__IMPORT_DESCRIPTOR_nssutil3 dd	rva off_100281D8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aNssutil3_dll	; DLL Name
		dd rva __imp_SECITEM_CompareItem_Util ;	Import Address Table
__IMPORT_DESCRIPTOR_libplc4 dd rva off_10028168	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aLibplc4_dll	; DLL Name
		dd rva __imp_PL_strcasecmp ; Import Address Table
__IMPORT_DESCRIPTOR_libplds4 dd	rva off_10028174 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aLibplds4_dll	; DLL Name
		dd rva __imp_PL_CompareValues ;	Import Address Table
__IMPORT_DESCRIPTOR_libnspr4 dd	rva off_100280F0 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aLibnspr4_dll	; DLL Name
		dd rva PR_DestroyLock	; Import Address Table
__IMPORT_DESCRIPTOR_msvcrt dd rva off_10028198 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcrt_dll	; DLL Name
		dd rva malloc		; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_100280B4 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva UnhandledExceptionFilter	; Import Address Table
		dd 5 dup(0)
;
; Import names for KERNEL32.dll
;
off_100280B4	dd rva word_10028DC4	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_10028E54
		dd rva word_10028E3E
		dd rva word_10028E28
		dd rva word_10028E18
		dd rva word_10028DFE
		dd rva word_10028DE0
		dd rva word_10028D44
		dd rva word_10028DB0
		dd rva word_10028D9C
		dd rva word_10028D7E
		dd rva word_10028D76
		dd rva word_10028D60
		dd rva word_10028D54
		dd 0
;
; Import names for libnspr4.dll
;
off_100280F0	dd rva word_10028B54	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_libnspr4o
		dd rva word_10028C8A
		dd rva word_10028C7C
		dd rva word_10028C72
		dd rva word_10028C64
		dd rva word_10028C54
		dd rva word_10028C40
		dd rva word_10028C36
		dd rva word_10028C24
		dd rva word_10028C0E
		dd rva word_10028BFC
		dd rva word_10028BE0
		dd rva word_10028BCE
		dd rva word_10028BC2
		dd rva word_10028BAA
		dd rva word_10028B9C
		dd rva word_10028B86
		dd rva word_10028B7A
		dd rva word_10028B66
		dd rva word_10028B3E
		dd rva word_10028B26
		dd rva word_10028B12
		dd rva word_10028B08
		dd rva word_10028AFC
		dd rva word_10028AE0
		dd rva word_10028AC4
		dd rva word_10028AAA
		dd rva word_10028A9E
		dd rva word_10028A90
		dd 0
;
; Import names for libplc4.dll
;
off_10028168	dd rva word_100289A0	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_libplc4o
		dd rva word_100289B0
		dd 0
;
; Import names for libplds4.dll
;
off_10028174	dd rva word_10028A0C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_libplds4o
		dd rva word_10028A4C
		dd rva word_100289E8
		dd rva word_100289CE
		dd rva word_10028A62
		dd rva word_100289FA
		dd rva word_10028A20
		dd rva word_10028A36
		dd 0
;
; Import names for msvcrt.dll
;
off_10028198	dd rva word_10028D06	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_msvcrto
		dd rva word_10028CF4
		dd rva word_10028CEA
		dd rva word_10028CE0
		dd rva word_10028CD6
		dd rva word_10028CCE
		dd rva word_10028CC4
		dd rva word_10028D36
		dd rva word_10028D2A
		dd rva word_10028D1C
		dd rva word_10028CFE
		dd rva word_10028E7C
		dd rva word_10028CA6
		dd rva word_10028CB0
		dd rva word_10028CBA
		dd 0
;
; Import names for nssutil3.dll
;
off_100281D8	dd rva word_10028976	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_nssutil3o
		dd rva word_10028960
		dd rva word_10028946
		dd rva word_10028930
		dd rva word_1002891C
		dd rva word_10028904
		dd rva word_100288E8
		dd rva word_100288D2
		dd rva word_100288B4
		dd rva word_100288A0
		dd rva word_10028884
		dd rva word_10028866
		dd rva word_1002884A
		dd rva word_10028838
		dd rva word_1002881A
		dd rva word_10028806
		dd rva word_100287F4
		dd rva word_100287E6
		dd rva word_100287D0
		dd rva word_100287B2
		dd rva word_1002879C
		dd rva word_10028782
		dd rva word_10028770
		dd rva word_10028758
		dd rva word_10028730
		dd rva word_10028712
		dd rva word_100286FC
		dd rva word_100286E8
		dd rva word_100286CA
		dd rva word_100286B0
		dd rva word_1002869A
		dd rva word_1002867C
		dd rva word_10028662
		dd rva word_10028644
		dd rva word_10028626
		dd rva word_10028604
		dd rva word_100285EC
		dd rva word_100285D2
		dd rva word_100285C0
		dd rva word_100285A6
		dd rva word_10028592
		dd rva word_1002857A
		dd rva word_10028564
		dd rva word_1002854C
		dd rva word_10028534
		dd rva word_10028514
		dd rva word_100284EE
		dd rva word_100284CA
		dd rva word_100284A0
		dd rva word_1002848A
		dd rva word_10028478
		dd rva word_10028466
		dd rva word_10028450
		dd 0
;
; Import names for sqlite3.dll
;
off_100282B0	dd rva word_10028430	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_sqlite3o
		dd rva word_1002841C
		dd rva word_10028404
		dd rva word_100283EE
		dd rva word_100283DE
		dd rva word_100283C8
		dd rva word_100283B2
		dd rva word_1002839E
		dd rva word_1002838E
		dd rva word_1002837A
		dd rva word_1002836A
		dd rva word_10028352
		dd rva word_10028342
		dd rva word_10028332
		dd rva word_10028320
		dd rva word_10028308
		dd rva word_100282F8
		dd 0
word_100282F8	dw 39h			; DATA XREF: .rdata:100282F0o
		db 'sqlite3_free',0
		align 4
word_10028308	dw 37h			; DATA XREF: .rdata:100282ECo
		db 'sqlite3_file_control',0
		align 10h
word_10028320	dw 45h			; DATA XREF: .rdata:100282E8o
		db 'sqlite3_mprintf',0
word_10028332	dw 34h			; DATA XREF: .rdata:100282E4o
		db 'sqlite3_exec',0
		align 2
word_10028342	dw 12h			; DATA XREF: .rdata:100282E0o
		db 'sqlite3_close',0
word_10028352	dw 0Fh			; DATA XREF: .rdata:100282DCo
		db 'sqlite3_busy_timeout',0
		align 2
word_1002836A	dw 46h			; DATA XREF: .rdata:100282D8o
		db 'sqlite3_open',0
		align 2
word_1002837A	dw 38h			; DATA XREF: .rdata:100282D4o
		db 'sqlite3_finalize',0
		align 2
word_1002838E	dw 51h			; DATA XREF: .rdata:100282D0o
		db 'sqlite3_reset',0
word_1002839E	dw 3			; DATA XREF: .rdata:100282CCo
		db 'sqlite3_bind_blob',0
word_100283B2	dw 4Dh			; DATA XREF: .rdata:100282C8o
		db 'sqlite3_prepare_v2',0
		align 4
word_100283C8	dw 1Ch			; DATA XREF: .rdata:100282C4o
		db 'sqlite3_column_int',0
		align 2
word_100283DE	dw 64h			; DATA XREF: .rdata:100282C0o
		db 'sqlite3_step',0
		align 2
word_100283EE	dw 15h			; DATA XREF: .rdata:100282BCo
		db 'sqlite3_column_blob',0
word_10028404	dw 16h			; DATA XREF: .rdata:100282B8o
		db 'sqlite3_column_bytes',0
		align 4
word_1002841C	dw 5			; DATA XREF: .rdata:100282B4o
		db 'sqlite3_bind_int',0
		align 10h
word_10028430	dw 0Bh			; DATA XREF: .rdata:off_100282B0o
		db 'sqlite3_bind_text',0
aSqlite3_dll	db 'sqlite3.dll',0      ; DATA XREF: .rdata:10028020o
word_10028450	dw 65h			; DATA XREF: .rdata:100282A8o
		db 'PORT_FreeArena_Util',0
word_10028466	dw 66h			; DATA XREF: .rdata:100282A4o
		db 'PORT_Free_Util',0
		align 4
word_10028478	dw 5Dh			; DATA XREF: .rdata:100282A0o
		db 'PORT_Alloc_Util',0
word_1002848A	dw 6Fh			; DATA XREF: .rdata:1002829Co
		db 'PORT_SetError_Util',0
		align 10h
word_100284A0	dw 40h			; DATA XREF: .rdata:10028298o
		db 'NSS_Get_SECOID_AlgorithmIDTemplate_Util',0
word_100284CA	dw 4Ah			; DATA XREF: .rdata:10028294o
		db 'NSS_Get_SEC_ObjectIDTemplate_Util',0
word_100284EE	dw 43h			; DATA XREF: .rdata:10028290o
		db 'NSS_Get_SEC_BitStringTemplate_Util',0
		align 4
word_10028514	dw 41h			; DATA XREF: .rdata:1002828Co
		db 'NSS_Get_SEC_AnyTemplate_Util',0
		align 4
word_10028534	dw 7Dh			; DATA XREF: .rdata:10028288o
		db 'SECITEM_CopyItem_Util',0
word_1002854C	dw 64h			; DATA XREF: .rdata:10028284o
		db 'PORT_ArenaZAlloc_Util',0
word_10028564	dw 6Ah			; DATA XREF: .rdata:10028280o
		db 'PORT_NewArena_Util',0
		align 2
word_1002857A	dw 81h			; DATA XREF: .rdata:1002827Co
		db 'SECITEM_FreeItem_Util',0
word_10028592	dw 77h			; DATA XREF: .rdata:10028278o
		db 'PORT_ZAlloc_Util',0
		align 2
word_100285A6	dw 88h			; DATA XREF: .rdata:10028274o
		db 'SECITEM_ZfreeItem_Util',0
		align 10h
word_100285C0	dw 78h			; DATA XREF: .rdata:10028270o
		db 'PORT_ZFree_Util',0
word_100285D2	dw 7Ah			; DATA XREF: .rdata:1002826Co
		db 'SECITEM_AllocItem_Util',0
		align 4
word_100285EC	dw 7Fh			; DATA XREF: .rdata:10028268o
		db 'SECITEM_DupItem_Util',0
		align 4
word_10028604	dw 8Ch			; DATA XREF: .rdata:10028264o
		db 'SECOID_DestroyAlgorithmID_Util',0
		align 2
word_10028626	dw 8Bh			; DATA XREF: .rdata:10028260o
		db 'SECOID_CopyAlgorithmID_Util',0
word_10028644	dw 95h			; DATA XREF: .rdata:1002825Co
		db 'SECOID_SetAlgorithmID_Util',0
		align 2
word_10028662	dw 0A3h			; DATA XREF: .rdata:10028258o
		db 'SEC_ASN1EncodeItem_Util',0
word_1002867C	dw 0A2h			; DATA XREF: .rdata:10028254o
		db 'SEC_ASN1EncodeInteger_Util',0
		align 2
word_1002869A	dw 0Bh			; DATA XREF: .rdata:10028250o
		db 'DER_GetInteger_Util',0
word_100286B0	dw 98h			; DATA XREF: .rdata:1002824Co
		db 'SEC_ASN1DecodeItem_Util',0
word_100286CA	dw 92h			; DATA XREF: .rdata:10028248o
		db 'SECOID_GetAlgorithmTag_Util',0
word_100286E8	dw 6Bh			; DATA XREF: .rdata:10028244o
		db 'PORT_Realloc_Util',0
word_100286FC	dw 5Fh			; DATA XREF: .rdata:10028240o
		db 'PORT_ArenaGrow_Util',0
word_10028712	dw 0B1h			; DATA XREF: .rdata:1002823Co
		db 'SEC_QuickDERDecodeItem_Util',0
word_10028730	dw 4Bh			; DATA XREF: .rdata:10028238o
		db 'NSS_Get_SEC_OctetStringTemplate_Util',0
		align 4
word_10028758	dw 5Eh			; DATA XREF: .rdata:10028234o
		db 'PORT_ArenaAlloc_Util',0
		align 10h
word_10028770	dw 0Fh			; DATA XREF: .rdata:10028230o
		db 'DER_SetUInteger',0
word_10028782	dw 0BAh			; DATA XREF: .rdata:1002822Co
		db '_NSSUTIL_GetSecmodName',0
		align 4
word_1002879C	dw 67h			; DATA XREF: .rdata:10028228o
		db 'PORT_GetError_Util',0
		align 2
word_100287B2	dw 34h			; DATA XREF: .rdata:10028224o
		db 'NSSUTIL_DoModuleDBFunction',0
		align 10h
word_100287D0	dw 83h			; DATA XREF: .rdata:10028220o
		db 'SECITEM_HashCompare',0
word_100287E6	dw 93h			; DATA XREF: .rdata:1002821Co
		db 'SECOID_Init',0
word_100287F4	dw 96h			; DATA XREF: .rdata:10028218o
		db 'SECOID_Shutdown',0
word_10028806	dw 0B8h			; DATA XREF: .rdata:10028214o
		db 'UTIL_SetForkState',0
word_1002881A	dw 0B7h			; DATA XREF: .rdata:10028210o
		db 'SGN_DestroyDigestInfo_Util',0
		align 4
word_10028838	dw 8			; DATA XREF: .rdata:1002820Co
		db 'DER_Encode_Util',0
word_1002884A	dw 0B5h			; DATA XREF: .rdata:10028208o
		db 'SGN_CreateDigestInfo_Util',0
word_10028866	dw 0BBh			; DATA XREF: .rdata:10028204o
		db '_SGN_VerifyPKCS1DigestInfo',0
		align 4
word_10028884	dw 8Dh			; DATA XREF: .rdata:10028200o
		db 'SECOID_FindOIDByMechanism',0
word_100288A0	dw 73h			; DATA XREF: .rdata:100281FCo
		db 'PORT_Strdup_Util',0
		align 4
word_100288B4	dw 0B9h			; DATA XREF: .rdata:100281F8o
		db '_NSSUTIL_EvaluateConfigDir',0
		align 2
word_100288D2	dw 2Bh			; DATA XREF: .rdata:100281F4o
		db 'NSSUTIL_ArgHasFlag',0
		align 4
word_100288E8	dw 32h			; DATA XREF: .rdata:100281F0o
		db 'NSSUTIL_ArgSkipParameter',0
		align 4
word_10028904	dw 28h			; DATA XREF: .rdata:100281ECo
		db 'NSSUTIL_ArgFetchValue',0
word_1002891C	dw 33h			; DATA XREF: .rdata:100281E8o
		db 'NSSUTIL_ArgStrip',0
		align 10h
word_10028930	dw 2Ch			; DATA XREF: .rdata:100281E4o
		db 'NSSUTIL_ArgIsBlank',0
		align 2
word_10028946	dw 27h			; DATA XREF: .rdata:100281E0o
		db 'NSSUTIL_ArgDecodeNumber',0
word_10028960	dw 29h			; DATA XREF: .rdata:100281DCo
		db 'NSSUTIL_ArgGetLabel',0
word_10028976	dw 7Ch			; DATA XREF: .rdata:off_100281D8o
		db 'SECITEM_CompareItem_Util',0
		align 2
aNssutil3_dll	db 'nssutil3.dll',0     ; DATA XREF: .rdata:10028034o
		align 10h
word_100289A0	dw 8			; DATA XREF: .rdata:off_10028168o
		db 'PL_strcasecmp',0
word_100289B0	dw 13h			; DATA XREF: .rdata:1002816Co
		db 'PL_strncasecmp',0
		align 2
aLibplc4_dll	db 'libplc4.dll',0      ; DATA XREF: .rdata:10028048o
word_100289CE	dw 10h			; DATA XREF: .rdata:10028180o
		db 'PL_HashTableLookupConst',0
word_100289E8	dw 0Bh			; DATA XREF: .rdata:1002817Co
		db 'PL_HashTableAdd',0
word_100289FA	dw 17h			; DATA XREF: .rdata:10028188o
		db 'PL_NewHashTable',0
word_10028A0C	dw 7			; DATA XREF: .rdata:off_10028174o
		db 'PL_CompareValues',0
		align 10h
word_10028A20	dw 0Ch			; DATA XREF: .rdata:1002818Co
		db 'PL_HashTableDestroy',0
word_10028A36	dw 0Fh			; DATA XREF: .rdata:10028190o
		db 'PL_HashTableLookup',0
		align 4
word_10028A4C	dw 15h			; DATA XREF: .rdata:10028178o
		db 'PL_HashTableRemove',0
		align 2
word_10028A62	dw 0Eh			; DATA XREF: .rdata:10028184o
		db 'PL_HashTableEnumerateEntries',0
		align 2
aLibplds4_dll	db 'libplds4.dll',0     ; DATA XREF: .rdata:1002805Co
		align 10h
word_10028A90	dw 187h			; DATA XREF: .rdata:10028160o
		db 'PR_snprintf',0
word_10028A9E	dw 95h			; DATA XREF: .rdata:1002815Co
		db 'PR_GetEnv',0
word_10028AAA	dw 0E5h			; DATA XREF: .rdata:10028158o
		db 'PR_LoadLibraryWithFlags',0
word_10028AC4	dw 93h			; DATA XREF: .rdata:10028154o
		db 'PR_GetDirectorySeparator',0
		align 10h
word_10028AE0	dw 0A4h			; DATA XREF: .rdata:10028150o
		db 'PR_GetLibraryFilePathname',0
word_10028AFC	dw 16Eh			; DATA XREF: .rdata:1002814Co
		db 'PR_Unlock',0
word_10028B08	dw 0E8h			; DATA XREF: .rdata:10028148o
		db 'PR_Lock',0
word_10028B12	dw 16Dh			; DATA XREF: .rdata:10028144o
		db 'PR_UnloadLibrary',0
		align 2
word_10028B26	dw 7Ah			; DATA XREF: .rdata:10028140o
		db 'PR_FindFunctionSymbol',0
word_10028B3E	dw 16h			; DATA XREF: .rdata:1002813Co
		db 'PR_AtomicDecrement',0
		align 4
word_10028B54	dw 52h			; DATA XREF: .rdata:off_100280F0o
		db 'PR_DestroyLock',0
		align 2
word_10028B66	dw 186h			; DATA XREF: .rdata:10028138o
		db 'PR_smprintf_free',0
		align 2
word_10028B7A	dw 159h			; DATA XREF: .rdata:10028134o
		db 'PR_Sleep',0
		align 2
word_10028B86	dw 17h			; DATA XREF: .rdata:10028130o
		db 'PR_AtomicIncrement',0
		align 4
word_10028B9C	dw 0FBh			; DATA XREF: .rdata:1002812Co
		db 'PR_NewLock',0
		align 2
word_10028BAA	dw 136h			; DATA XREF: .rdata:10028128o
		db 'PR_SecondsToInterval',0
		align 2
word_10028BC2	dw 0Eh			; DATA XREF: .rdata:10028124o
		db 'PR_Access',0
word_10028BCE	dw 0DAh			; DATA XREF: .rdata:10028120o
		db 'PR_IntervalNow',0
		align 10h
word_10028BE0	dw 0F2h			; DATA XREF: .rdata:1002811Co
		db 'PR_MillisecondsToInterval',0
word_10028BFC	dw 6Fh			; DATA XREF: .rdata:10028118o
		db 'PR_ExitMonitor',0
		align 2
word_10028C0E	dw 90h			; DATA XREF: .rdata:10028114o
		db 'PR_GetCurrentThread',0
word_10028C24	dw 65h			; DATA XREF: .rdata:10028110o
		db 'PR_EnterMonitor',0
word_10028C36	dw 10Ch			; DATA XREF: .rdata:1002810Co
		db 'PR_Now',0
		align 10h
word_10028C40	dw 54h			; DATA XREF: .rdata:10028108o
		db 'PR_DestroyMonitor',0
word_10028C54	dw 0FDh			; DATA XREF: .rdata:10028104o
		db 'PR_NewMonitor',0
word_10028C64	dw 185h			; DATA XREF: .rdata:10028100o
		db 'PR_smprintf',0
word_10028C72	dw 85h			; DATA XREF: .rdata:100280FCo
		db 'PR_Free',0
word_10028C7C	dw 143h			; DATA XREF: .rdata:100280F8o
		db 'PR_SetError',0
word_10028C8A	dw 27h			; DATA XREF: .rdata:100280F4o
		db 'PR_CallOnce',0
aLibnspr4_dll	db 'libnspr4.dll',0     ; DATA XREF: .rdata:10028070o
		align 2
word_10028CA6	dw 4EEh			; DATA XREF: .rdata:100281C8o
		db 'memset',0
		align 10h
word_10028CB0	dw 4C7h			; DATA XREF: .rdata:100281CCo
		db 'isupper',0
word_10028CBA	dw 4C3h			; DATA XREF: .rdata:100281D0o
		db 'islower',0
word_10028CC4	dw 4C0h			; DATA XREF: .rdata:100281B0o
		db 'isdigit',0
word_10028CCE	dw 480h			; DATA XREF: .rdata:100281ACo
		db 'atoi',0
		align 2
word_10028CD6	dw 524h			; DATA XREF: .rdata:100281A8o
		db 'strrchr',0
word_10028CE0	dw 4EAh			; DATA XREF: .rdata:100281A4o
		db 'memcpy',0
		align 2
word_10028CEA	dw 50Bh			; DATA XREF: .rdata:100281A0o
		db 'sprintf',0
word_10028CF4	dw 4B6h			; DATA XREF: .rdata:1002819Co
		db 'getenv',0
		align 2
word_10028CFE	dw 4A6h			; DATA XREF: .rdata:100281C0o
		db 'free',0
		align 2
word_10028D06	dw 4DEh			; DATA XREF: .rdata:off_10028198o
		db 'malloc',0
		align 10h
aMsvcrt_dll	db 'msvcrt.dll',0       ; DATA XREF: .rdata:10028084o
		align 4
word_10028D1C	dw 6Ah			; DATA XREF: .rdata:100281BCo
		db '_XcptFilter',0
word_10028D2A	dw 1D5h			; DATA XREF: .rdata:100281B8o
		db '_initterm',0
word_10028D36	dw 101h			; DATA XREF: .rdata:100281B4o
		db '_amsg_exit',0
		align 4
word_10028D44	dw 1CBh			; DATA XREF: .rdata:100280D0o
		db 'GetTempPathA',0
		align 4
word_10028D54	dw 2C7h			; DATA XREF: .rdata:100280E8o
		db 'RtlUnwind',0
word_10028D60	dw 21Dh			; DATA XREF: .rdata:100280E4o
		db 'InterlockedExchange',0
word_10028D76	dw 342h			; DATA XREF: .rdata:100280E0o
		db 'Sleep',0
word_10028D7E	dw 21Bh			; DATA XREF: .rdata:100280DCo
		db 'InterlockedCompareExchange',0
		align 4
word_10028D9C	dw 34Ah			; DATA XREF: .rdata:100280D8o
		db 'TerminateProcess',0
		align 10h
word_10028DB0	dw 13Bh			; DATA XREF: .rdata:100280D4o
		db 'GetCurrentProcess',0
word_10028DC4	dw 35Bh			; DATA XREF: .rdata:off_100280B4o
		db 'UnhandledExceptionFilter',0
		align 10h
word_10028DE0	dw 336h			; DATA XREF: .rdata:100280CCo
		db 'SetUnhandledExceptionFilter',0
word_10028DFE	dw 294h			; DATA XREF: .rdata:100280C8o
		db 'QueryPerformanceCounter',0
word_10028E18	dw 1D4h			; DATA XREF: .rdata:100280C4o
		db 'GetTickCount',0
		align 4
word_10028E28	dw 13Eh			; DATA XREF: .rdata:100280C0o
		db 'GetCurrentThreadId',0
		align 2
word_10028E3E	dw 13Ch			; DATA XREF: .rdata:100280BCo
		db 'GetCurrentProcessId',0
word_10028E54	dw 1C0h			; DATA XREF: .rdata:100280B8o
		db 'GetSystemTimeAsFileTime',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:10028098o
		align 4
word_10028E7C	dw 11Dh			; DATA XREF: .rdata:100281C4o
		db '_chmod',0
		align 10h
;
; Export directory for softokn3.dll
;
		dd 0			; Characteristics
		dd 54275E3Eh		; TimeDateStamp: Sun Sep 28 01:02:54 2014
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSoftokn3_dll	; Name
		dd 1			; Base
		dd 4			; NumberOfFunctions
		dd 4			; NumberOfNames
		dd rva off_10028EB8	; AddressOfFunctions
		dd rva off_10028EC8	; AddressOfNames
		dd rva word_10028ED8	; AddressOfNameOrdinals
;
; Export Address Table for softokn3.dll
;
off_10028EB8	dd rva NSC_GetFunctionList, rva	FC_GetFunctionList, rva	NSC_GetFunctionList
					; DATA XREF: .rdata:10028EACo
		dd rva NSC_ModuleDBFunc
;
; Export Names Table for softokn3.dll
;
off_10028EC8	dd rva aC_getfunctionl,	rva aFc_getfunction, rva aNsc_getfunctio
					; DATA XREF: .rdata:10028EB0o
		dd rva aNsc_moduledbfu	; "C_GetFunctionList"
;
; Export Ordinals Table	for softokn3.dll
;
word_10028ED8	dw 0, 1, 2, 3		; DATA XREF: .rdata:10028EB4o
aSoftokn3_dll	db 'softokn3.dll',0     ; DATA XREF: .rdata:10028E9Co
aC_getfunctionl	db 'C_GetFunctionList',0 ; DATA XREF: .rdata:off_10028EC8o
aFc_getfunction	db 'FC_GetFunctionList',0 ; DATA XREF: .rdata:off_10028EC8o
aNsc_getfunctio	db 'NSC_GetFunctionList',0 ; DATA XREF: .rdata:off_10028EC8o
aNsc_moduledbfu	db 'NSC_ModuleDBFunc',0 ; DATA XREF: .rdata:off_10028EC8o
		align 100h
_rdata		ends

; Section 3. (virtual address 00029000)
; Virtual size			: 000009DC (   2524.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00027E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 10029000h
byte_10029000	db 1, 0Ah		; DATA XREF: FC_GetFunctionList+4o
		dd offset sub_10003640
		dd offset sub_10003780
		dd offset sub_100037D0
		dd offset FC_GetFunctionList
		dd offset sub_100037E0
		dd offset sub_10003800
		dd offset sub_10003810
		dd offset sub_10003830
		dd offset sub_10003860
		dd offset sub_10003890
		dd offset sub_10003910
		dd offset sub_100039C0
		dd offset sub_10003A80
		dd offset sub_10003AA0
		dd offset sub_10003AB0
		dd offset sub_10003AC0
		dd offset sub_10004A30
		dd offset sub_10004A50
		dd offset sub_10003B10
		dd offset sub_10003BD0
		dd offset sub_10003C60
		dd offset sub_10003D20
		dd offset sub_10003DB0
		dd offset sub_10003E20
		dd offset sub_10003EA0
		dd offset sub_10003F30
		dd offset sub_10003FC0
		dd offset sub_10004030
		dd offset sub_10004A70
		dd offset sub_10004050
		dd offset sub_100040B0
		dd offset sub_100040E0
		dd offset sub_10004110
		dd offset sub_10004140
		dd offset sub_100041A0
		dd offset sub_100041D0
		dd offset sub_10004200
		dd offset sub_10004230
		dd offset sub_10004250
		dd offset sub_10004270
		dd offset sub_10004B50
		dd offset sub_10004290
		dd offset sub_100042B0
		dd offset sub_10004310
		dd offset sub_10004340
		dd offset sub_10004370
		dd offset sub_100043A0
		dd offset sub_10004400
		dd offset sub_10004430
		dd offset sub_10004490
		dd offset sub_100044C0
		dd offset sub_100044F0
		dd offset sub_10004520
		dd offset sub_10004580
		dd offset sub_10004A90
		dd offset sub_10004AC0
		dd offset sub_10004AF0
		dd offset sub_10004B20
		dd offset sub_100045B0
		dd offset sub_10004650
		dd offset sub_10004720
		dd offset sub_100047A0
		dd offset sub_10004860
		dd offset sub_10004910
		dd offset sub_10004950
		dd offset sub_10004A00
		dd offset sub_10004A00
		dd offset sub_10004BA0
		align 4
; void *off_10029114
off_10029114	dd offset aNssdbm3_dll	; DATA XREF: sub_10004DD0+24r
					; sub_10004DD0:loc_10004E23r ...
					; "nssdbm3.dll"
off_10029118	dd offset aMozillaFoundat ; DATA XREF: sub_10006B80+8Aw
					; sub_100085A0+12r ...
					; "Mozilla Foundation		   "
off_1002911C	dd offset aNssInternalC_0 ; DATA XREF: sub_10006B80+11Aw
					; sub_100085A0+30r
					; "NSS Internal	Crypto Services	   "
dword_10029120	dd 1			; DATA XREF: sub_1000A8F0+126r
					; sub_1000ADD0:loc_1000AEF1r
off_10029124	dd offset aSuccess	; DATA XREF: NSC_ModuleDBFunc+218o
					; "Success"
dword_10029128	dd 0Fh dup(36363636h)	; DATA XREF: sub_1000E150+BBo
dword_10029164	dd 0Fh dup(5C5C5C5Ch), 10h, 2 dup(0) ; DATA XREF: sub_1000DF90+46o
					; sub_1000E040+3Co
		dd 18h,	6, 3 dup(0)
		dd 500h, 0Ch, 6	dup(0)
dword_100291E0	dd 10h,	2 dup(0)	; DATA XREF: sub_1000E5E0+40o
		dd 28h,	800h, 4
		dd offset dword_10029164+3Ch
		align 10h
		dd 4, 1Ch, 6 dup(0)
dword_10029220	dd 74h			; DATA XREF: sub_10019E70:loc_1001A058r
dword_10029224	dd 74h			; DATA XREF: sub_1001BEE0+4r
					; sub_1001BEE0:loc_1001BF40r
off_10029228	dd offset aFreebl3_dll	; DATA XREF: sub_10020A60r
					; "freebl3.dll"
off_1002922C	dd offset aSoftokn3_dll_0 ; DATA XREF: sub_100209F0r
					; "softokn3.dll"
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10001000+6r
					; sub_100010C0+6r ...
dword_10029234	dd 44BF19B1h		; DATA XREF: sub_10023481+B0r
					; sub_100237C6+2Bw ...
		align 10h
dword_10029240	dd 19930520h, 3	dup(0)	; DATA XREF: .text:1002360Ao
					; sub_10023611+2o
dword_10029250	dd 0FFFFFFFFh		; DATA XREF: DllEntryPoint-242w
					; sub_10023460w
		dd 0FFFFFFFFh, 400h, 0FFFFFC01h, 35h, 0Bh, 40h,	3FFh, 80h
		dd 0FFFFFF81h, 18h, 8, 20h, 7Fh, 2 dup(0)
		dd 4002A000h, 2	dup(0)
		dd 4005C800h, 2	dup(0)
		dd 4008FA00h, 2	dup(0)
		dd 400C9C40h, 2	dup(0)
		dd 400FC350h, 2	dup(0)
		dd 4012F424h, 0
		dd 80000000h, 40169896h, 0
		dd 20000000h, 4019BEBCh, 0
		dd 0C9BF0400h, 40348E1Bh, 0A1000000h, 1BCECCEDh, 404ED3C2h
		dd 0B59EF020h, 0ADA82B70h, 40699DC5h, 25FD5DD0h, 4F8E1AE5h
		dd 4083EB19h, 95D79671h, 8D050E43h, 409EAF29h, 44A0BFF9h
		dd 8F1281EDh, 40B98281h, 0A6D53CBFh, 1F49FFCFh,	40D3C278h
		dd 8CE0C66Fh, 47C980E9h, 41A893BAh, 556B85BCh, 0F78D3927h
		dd 427CE070h, 0DE8EDDBCh, 0EBFB9DF9h, 4351AA7Eh, 0E376E6A1h
		dd 2F29F2CCh, 44268184h, 0AA171028h, 0E310AEF8h, 44FAC4C5h
		dd 0F3D4A7EBh, 4AE1EBF7h, 45CF957Ah, 91C7CC65h,	0A0AEA60Eh
		dd 46A3E319h, 0C17650Dh, 75868175h, 4D48C976h, 0A7E44258h
		dd 353B3993h, 53EDB2B8h, 5DE5A74Dh, 3B5DC53Dh, 5A929E8Bh
		dd 0F0A65DFFh, 54C020A1h, 61378CA5h, 5A8BFDD1h,	5D25D88Bh
		dd 67DBF989h, 0F3F895AAh, 0C8A2BF27h, 6E80DD5Dh, 979BC94Ch
		dd 52028A20h, 7525C460h, 0
		dd 0CCCDCCCDh, 0CCCCCCCCh, 3FFBCCCCh, 0D70A3D71h, 0A3D70A3h
		dd 3FF8A3D7h, 0DF3B645Ah, 6E978D4Fh, 3FF58312h,	652CD3C3h
		dd 1758E219h, 3FF1D1B7h, 84230FD0h, 0AC471B47h,	3FEEA7C5h
		dd 69B6A640h, 0BD05AF6Ch, 3FEB8637h, 42BC3D33h,	94D5E57Ah
		dd 3FE7D6BFh, 0CEFDFDC2h, 77118461h, 3FE4ABCCh,	0E15B4C2Fh
		dd 94BEC44Dh, 3FC9E695h, 3B53C492h, 14CD4475h, 3FAF9ABEh
		dd 94BA67DEh, 1EAD4539h, 3F94CFB1h, 0E2C62324h,	313BBABCh
		dd 3F7A8B61h, 0C1595561h, 7C53B17Eh, 3F5FBB12h,	8D2FEED7h
		dd 8592BE06h, 3F44FB15h, 0E9A53F24h, 0EA27A539h, 3F2AA87Fh
		dd 0E4A1AC7Dh, 467C64BCh, 3E55DDD0h, 0CC067B63h, 83775423h
		dd 3D8191FFh, 193AFA91h, 4325637Ah, 3CACC031h, 38D18921h
		dd 0B8974782h, 3BD7FD00h, 85888DCh, 0E3E8B11Bh,	3B03A686h
		dd 424584C6h, 7599B607h, 3A2EDB37h, 0D21C7133h,	0EE32DB23h
		dd 395A9049h, 0C0BE87A6h, 82A5DA57h, 32B5A2A6h,	11B268E2h
		dd 449F52A7h, 2C10B759h, 2DE44925h, 534F3436h, 256BCEAEh
		dd 0A404598Fh, 7DC2DEC0h, 1EC6E8FBh, 5A88E79Eh,	0BF3C9157h
		dd 18228350h, 62654B4Eh, 0AF8F83FDh, 117D9406h,	9FDE2DE4h
		dd 4C8D2CEh, 0AD8A6DDh,	3 dup(0)
dword_10029550	dd 0			; DATA XREF: sub_100035C0:loc_1000360Er
					; sub_100039C0:loc_100039F5r ...
dword_10029554	dd 0			; DATA XREF: sub_100035C0:loc_100035FBr
					; sub_10003640+88w ...
dword_10029558	dd 0			; DATA XREF: sub_10003640+70w
					; sub_10003640+CBr ...
dword_1002955C	dd 0			; DATA XREF: sub_10003640+2Ar
					; sub_10003640+11Fw ...
dword_10029560	dd 0			; DATA XREF: sub_10004DD0+16r
					; sub_10004DD0:loc_10004E15w ...
dword_10029564	dd 0			; DATA XREF: sub_10004DD0+Dr
					; sub_10004DD0+38w ...
dword_10029568	dd 0			; DATA XREF: sub_10004DD0+1Fr
					; sub_10004DD0+83w ...
dword_1002956C	dd 0			; DATA XREF: sub_10004DD0+90w
					; sub_10004DD0+D9r ...
dword_10029570	dd 0			; DATA XREF: sub_10004DD0+9Dw
					; sub_10004DD0+E2r ...
dword_10029574	dd 0			; DATA XREF: sub_10004DD0+AAw
					; sub_10004DD0+EBr ...
dword_10029578	dd 0			; DATA XREF: sub_10004DD0+B7w
					; sub_10004DD0+F4r ...
dword_1002957C	dd 0			; DATA XREF: sub_10004DD0+C4w
					; sub_10005040:loc_10005053r
dword_10029580	dd 0			; DATA XREF: sub_10004DD0r
					; sub_10004DD0+132w ...
		align 8
dword_10029588	dd 0			; DATA XREF: sub_10006B80+46o
					; sub_10006B80+4Bw ...
dword_1002958C	dd 0			; DATA XREF: sub_10006B80+51w
dword_10029590	dd 0			; DATA XREF: sub_10006B80+57w
dword_10029594	dd 0			; DATA XREF: sub_10006B80+5Dw
dword_10029598	dd 0			; DATA XREF: sub_10006B80+63w
dword_1002959C	dd 0			; DATA XREF: sub_10006B80+69w
dword_100295A0	dd 0			; DATA XREF: sub_10006B80+6Fw
dword_100295A4	dd 0			; DATA XREF: sub_10006B80+75w
byte_100295A8	db 0			; DATA XREF: sub_10006B80+7Bw
		align 4
dword_100295AC	dd 0			; DATA XREF: sub_10006B80+D6o
					; sub_10006B80+DBw ...
dword_100295B0	dd 0			; DATA XREF: sub_10006B80+E1w
dword_100295B4	dd 0			; DATA XREF: sub_10006B80+E7w
dword_100295B8	dd 0			; DATA XREF: sub_10006B80+EDw
dword_100295BC	dd 0			; DATA XREF: sub_10006B80+F3w
dword_100295C0	dd 0			; DATA XREF: sub_10006B80+F9w
dword_100295C4	dd 0			; DATA XREF: sub_10006B80+FFw
dword_100295C8	dd 0			; DATA XREF: sub_10006B80+105w
byte_100295CC	db 0			; DATA XREF: sub_10006B80+10Bw
		align 10h
; char Dest[68]
Dest		db 30h dup(0), 14h dup(?) ; DATA XREF: sub_10007E10+15o
					; sub_10007E10+23o
dword_10029614	dd ?			; DATA XREF: sub_10008B70+175r
					; sub_100090D0+18Fr ...
; char byte_10029618[36]
byte_10029618	db 24h dup(?)		; DATA XREF: sub_1000AB70+5Co
					; sub_1000AB70+6Ao
dword_1002963C	dd ?			; DATA XREF: sub_1000B0B0+E4r
					; sub_1000B0B0+10Br ...
dword_10029640	dd ?			; DATA XREF: sub_10007E90+Fr
					; sub_10007EF0+6Fo ...
		align 8
; void *Src
Src		dd ?			; DATA XREF: sub_10007E90+18r
					; sub_10007EF0:loc_10007F19r ...
		align 10h
dword_10029650	dd ?			; DATA XREF: sub_10007EF0+3Dw
					; sub_10007EF0:loc_10007F4Fr ...
		align 8
dword_10029658	dd ?			; DATA XREF: sub_10007E50:loc_10007E67r
					; sub_10007E90:loc_10007EC5r ...
		align 10h
dword_10029660	dd ?			; DATA XREF: sub_100161D0+3o
					; sub_100161F0+1Br ...
dword_10029664	dd ?			; DATA XREF: sub_10016140+9w
					; sub_100161F0+Fr ...
dword_10029668	dd ?			; DATA XREF: sub_100161F0+2Aw
					; sub_10016BF0+77r ...
dword_1002966C	dd ?			; DATA XREF: sub_100161D0+Fo
					; sub_10016BF0+F7r ...
dword_10029670	dd ?			; DATA XREF: sub_10016140+10w
					; sub_10016BF0+EAr ...
dword_10029674	dd ?			; DATA XREF: sub_10016BF0+DEr
					; sub_10016BF0+104w ...
dword_10029678	dd ?			; DATA XREF: sub_10018EB0r
					; sub_10018EB0+24w ...
dword_1002967C	dd ?			; DATA XREF: sub_10020B00+Eo
					; sub_10020B40+Eo ...
dword_10029680	dd ?			; DATA XREF: sub_10021800+55w
dword_10029684	dd ?			; DATA XREF: sub_10021800+5Bw
dword_10029688	dd ?			; DATA XREF: sub_10020A60+6Cw
					; sub_10021800r ...
dword_1002968C	dd ?			; DATA XREF: sub_10020A60+73w
					; sub_10020B00r ...
dword_10029690	dd ?			; DATA XREF: sub_10020A60+78w
					; sub_10021DF0:loc_10021E13r
dword_10029694	dd ?			; DATA XREF: sub_10023088+Fr
					; sub_10023088+17w ...
dword_10029698	dd ?			; DATA XREF: DllEntryPoint-20Fw
					; DllEntryPoint-60r
		align 10h
dword_100296A0	dd ?			; DATA XREF: sub_10023481+91w
					; .rdata:ExceptionInfoo
dword_100296A4	dd ?			; DATA XREF: sub_10023481+9Bw
		dd ?
dword_100296AC	dd ?			; DATA XREF: sub_10023481+8Cw
		dd 10h dup(?)
dword_100296F0	dd ?			; DATA XREF: sub_10023481+7Dw
					; .rdata:ExceptionInfoo
		dd 22h dup(?)
word_1002977C	dw ?			; DATA XREF: sub_10023481+51w
		align 10h
word_10029780	dw ?			; DATA XREF: sub_10023481+4Aw
		align 4
word_10029784	dw ?			; DATA XREF: sub_10023481+43w
		align 4
word_10029788	dw ?			; DATA XREF: sub_10023481+3Cw
		align 4
dword_1002978C	dd ?			; DATA XREF: sub_10023481+28w
dword_10029790	dd ?			; DATA XREF: sub_10023481+22w
dword_10029794	dd ?			; DATA XREF: sub_10023481+1Cw
dword_10029798	dd ?			; DATA XREF: sub_10023481+16w
dword_1002979C	dd ?			; DATA XREF: sub_10023481+10w
dword_100297A0	dd ?			; DATA XREF: sub_10023481+Bw
dword_100297A4	dd ?			; DATA XREF: sub_10023481+62w
dword_100297A8	dd ?			; DATA XREF: sub_10023481+6Aw
					; sub_10023481+87r
word_100297AC	dw ?			; DATA XREF: sub_10023481+35w
		align 10h
dword_100297B0	dd ?			; DATA XREF: sub_10023481+59w
dword_100297B4	dd ?			; DATA XREF: sub_10023481+72w
word_100297B8	dw ?			; DATA XREF: sub_10023481+2Ew
		align 4
		dd 80h dup(?)
dword_100299BC	dd ?			; DATA XREF: sub_1000B270r
					; sub_1000B270+Cr ...
dword_100299C0	dd ?			; DATA XREF: sub_10023088:loc_10023104r
					; sub_10023088+9Bw ...
; volatile LONG	Target
Target		dd ?			; DATA XREF: sub_10023088+24o
					; sub_10023088+53o
dword_100299C8	dd ?			; DATA XREF: sub_10023066+11w
					; sub_10023088+13Ar ...
; void *Memory
Memory		dd ?			; DATA XREF: sub_10023066+Cw
					; sub_10023088:loc_100231B8r ...
dword_100299D0	dd ?			; DATA XREF: DllEntryPoint:loc_10023250r
					; DllEntryPoint-E6r ...
dword_100299D4	dd ?			; DATA XREF: sub_10023088:loc_10023162r
					; sub_10023088+E2o ...
dword_100299D8	dd ?			; DATA XREF: sub_10022EA0+E6r
					; sub_10022EA0+EFo ...
		align 800h
_data		ends


		end DllEntryPoint
