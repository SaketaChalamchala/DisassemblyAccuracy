;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	71C14B20E7A80EEE267898BA81D7BF38
; Input	CRC32 :	BC5B1D3B

; File Name   :	C:\compspace\compare\pidgin\dlls\full\ssl3_full.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 00028D2A ( 167210.)
; Section size in file		: 00028E00 ( 167424.)
; Offset to raw	data for section: 00000400
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001000	proc near		; CODE XREF: sub_100087C0+ABp

var_2D8		= dword	ptr -2D8h
var_2D4		= dword	ptr -2D4h
var_2D0		= dword	ptr -2D0h
var_2CC		= dword	ptr -2CCh
var_2C8		= dword	ptr -2C8h
var_2C4		= dword	ptr -2C4h
var_2C0		= dword	ptr -2C0h
var_2BC		= dword	ptr -2BCh
var_2B8		= dword	ptr -2B8h
var_2B4		= dword	ptr -2B4h
var_2B0		= dword	ptr -2B0h
var_2AC		= dword	ptr -2ACh
var_2A8		= dword	ptr -2A8h
var_2A4		= dword	ptr -2A4h
var_2A0		= dword	ptr -2A0h
var_29C		= dword	ptr -29Ch
var_298		= dword	ptr -298h
var_294		= dword	ptr -294h
var_290		= byte ptr -290h
var_1E0		= byte ptr -1E0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_88		= byte ptr -88h
var_68		= byte ptr -68h
var_48		= byte ptr -48h
var_28		= byte ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 2DCh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2DCh+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		movzx	eax, word ptr [ebx+58h]
		mov	ecx, [ebx]
		push	esi
		xor	edx, edx
		mov	esi, 303h
		cmp	ax, si
		sbb	eax, eax
		inc	eax
		push	edi
		mov	[esp+2E8h+var_2D8], edx
		mov	[esp+2E8h+var_29C], 0FFFFFFFFh
		mov	[esp+2E8h+var_2C8], eax
		cmp	[ebx+1134h], edx
		jz	loc_100016E9
		cmp	dword ptr [ebx+1138h], 30h
		jnz	loc_100016E9
		mov	edi, [ecx+0Ch]
		mov	eax, [ecx+8]
		mov	esi, [ebx+0Ch]
		mov	[esp+2E8h+var_2D4], edi
		mov	edi, [ecx+14h]
		mov	[esp+2E8h+var_298], esi
		mov	[esp+2E8h+var_2CC], eax
		mov	[esp+2E8h+var_2D0], edi
		cmp	eax, edx
		jnz	short loc_10001084
		mov	[esp+2E8h+var_2D0], edx
		mov	[esp+2E8h+var_2D4], edx

loc_10001084:				; CODE XREF: sub_10001000+7Aj
		mov	eax, 1
		cmp	[ecx+10h], eax
		jnz	short loc_100010A0
		movzx	ecx, word ptr [ebx+58h]
		mov	edi, 302h
		cmp	cx, di
		jb	short loc_100010A0
		mov	[esp+2E8h+var_2D8], eax

loc_100010A0:				; CODE XREF: sub_10001000+8Cj
					; sub_10001000+9Aj
		cmp	[ebp+arg_10], edx
		jnz	short loc_100010AB
		cmp	[esp+2E8h+var_2D8], edx
		jz	short loc_100010AD

loc_100010AB:				; CODE XREF: sub_10001000+A3j
		xor	eax, eax

loc_100010AD:				; CODE XREF: sub_10001000+A9j
		imul	eax, [esp+2E8h+var_2D0]
		add	eax, [esp+2E8h+var_2D4]
		mov	ecx, ds:dword_1002A470
		mov	edi, ds:dword_1002A478
		add	eax, esi
		mov	esi, ds:dword_1002A474
		mov	[ebx+6Ch], ecx
		mov	[ebx+84h], ecx
		mov	[ebx+8D4h], ecx
		mov	[ebx+8ECh], ecx
		add	eax, eax
		mov	[ebx+70h], esi
		mov	[ebx+88h], esi
		mov	[ebx+8D8h], esi
		mov	[ebx+8F0h], esi
		mov	[ebx+74h], edi
		mov	[ebx+8Ch], edi
		mov	[ebx+8DCh], edi
		mov	[ebx+8F4h], edi
		mov	[esp+2E8h+var_2C4], eax
		lea	eax, [esp+2E8h+var_88]
		mov	[esp+2E8h+var_2BC], eax
		mov	eax, [ebp+arg_8]
		mov	ecx, 8
		mov	esi, eax
		lea	edi, [esp+2E8h+var_88]
		rep movsd
		mov	esi, [ebp+arg_4]
		mov	ecx, 8
		lea	edi, [esp+2E8h+var_68]
		rep movsd
		mov	esi, [ebp+arg_4]
		lea	ecx, [esp+2E8h+var_48]
		mov	[esp+2E8h+var_2B0], ecx
		mov	ecx, 8
		lea	edi, [esp+2E8h+var_48]
		rep movsd
		mov	ecx, 8
		mov	esi, eax
		lea	edi, [esp+2E8h+var_28]
		mov	[esp+2E8h+var_2C0], edx
		mov	[esp+2E8h+var_2B8], 40h
		mov	[esp+2E8h+var_2B4], edx
		mov	[esp+2E8h+var_2AC], 40h
		rep movsd
		cmp	[ebp+arg_C], edx
		jz	short loc_100011F0
		cmp	[esp+2E8h+var_2C8], edx
		push	edx
		lea	eax, [ebx+113Ch]
		lea	ecx, [esp+2ECh+var_9C]
		push	ecx
		mov	[esp+2F0h+var_9C], edx
		mov	[esp+2F0h+var_98], eax
		mov	eax, [esp+2F0h+var_2C4]
		lea	edx, [esp+2F0h+var_2C0]
		push	edx
		mov	[esp+2F4h+var_94], eax
		lea	eax, [ebx+1130h]
		push	offset aKeyExpansion ; "key expansion"
		push	eax
		jz	short loc_100011D2
		push	4
		call	sub_10022DA0
		add	esp, 18h
		jmp	short loc_100011DA
; ---------------------------------------------------------------------------

loc_100011D2:				; CODE XREF: sub_10001000+1C4j
		call	sub_10022B20
		add	esp, 14h

loc_100011DA:				; CODE XREF: sub_10001000+1D0j
		test	eax, eax
		jnz	loc_1000169E
		mov	esi, [esp+2E8h+var_94]
		xor	edx, edx
		jmp	loc_100012F4
; ---------------------------------------------------------------------------

loc_100011F0:				; CODE XREF: sub_10001000+185j
		xor	edi, edi
		xor	esi, esi
		cmp	[esp+2E8h+var_2C4], edx
		jbe	loc_100012F2
		mov	edi, edi

loc_10001200:				; CODE XREF: sub_10001000+2ECj
		cmp	esi, 9
		jnb	loc_100012F2
		lea	ecx, [esp+2E8h+var_1E0]
		push	ecx
		call	sub_10022790
		mov	edx, ds:off_1002A44C[esi*4]
		lea	eax, [esi+1]
		push	eax
		mov	[esp+2F0h+var_294], eax
		push	edx
		lea	eax, [esp+2F4h+var_1E0]
		push	eax
		call	sub_100227C0
		mov	ecx, [ebx+1138h]
		mov	edx, [ebx+1134h]
		push	ecx
		push	edx
		lea	eax, [esp+300h+var_1E0]
		push	eax
		call	sub_100227C0
		mov	ecx, [esp+304h+var_2B8]
		mov	edx, [esp+304h+var_2BC]
		push	ecx
		push	edx
		lea	eax, [esp+30Ch+var_1E0]
		push	eax
		call	sub_100227C0
		push	14h
		lea	ecx, [esp+314h+var_2C8]
		push	ecx
		lea	edx, [esp+318h+var_9C]
		push	edx
		lea	eax, [esp+31Ch+var_1E0]
		push	eax
		call	sub_100227F0
		lea	ecx, [esp+320h+var_290]
		push	ecx
		call	sub_10022690
		mov	edx, [ebx+1138h]
		mov	eax, [ebx+1134h]
		push	edx
		push	eax
		lea	ecx, [esp+32Ch+var_290]
		push	ecx
		call	sub_100226C0
		mov	edx, [esp+330h+var_2C8]
		add	esp, 48h
		push	edx
		lea	eax, [esp+2ECh+var_9C]
		push	eax
		lea	ecx, [esp+2F0h+var_290]
		push	ecx
		call	sub_100226C0
		push	10h
		lea	edx, [esp+2F8h+var_2C8]
		push	edx
		lea	eax, [edi+ebx+113Ch]
		push	eax
		lea	ecx, [esp+300h+var_290]
		push	ecx
		call	sub_100226F0
		mov	esi, [esp+304h+var_294]
		add	edi, 10h
		add	esp, 1Ch
		xor	edx, edx
		cmp	edi, [esp+2E8h+var_2C4]
		jb	loc_10001200

loc_100012F2:				; CODE XREF: sub_10001000+1F8j
					; sub_10001000+203j
		mov	esi, edi

loc_100012F4:				; CODE XREF: sub_10001000+1EBj
		mov	ecx, [esp+2E8h+var_298]
		lea	eax, [ebx+113Ch]
		lea	edi, [ecx+eax]
		mov	[ebx+8F0h], edi
		mov	[ebx+8Ch], ecx
		mov	[ebx+8F4h], ecx
		lea	edi, [ecx+ecx]
		mov	ecx, [esp+2E8h+var_2CC]
		add	esi, eax
		mov	[ebx+84h], edx
		mov	[ebx+88h], eax
		mov	[ebx+8ECh], edx
		cmp	ecx, edx
		jnz	short loc_10001372
		mov	[ebx+6Ch], edx
		mov	[ebx+70h], edx
		mov	[ebx+74h], edx
		mov	[ebx+8D4h], edx
		mov	[ebx+8D8h], edx
		mov	[ebx+8DCh], edx
		mov	[ebx+78h], edx
		mov	[ebx+7Ch], edx
		mov	[ebx+80h], edx
		mov	[ebx+8E0h], edx
		mov	[ebx+8E4h], edx
		mov	[ebx+8E8h], edx
		xor	esi, esi
		jmp	loc_100016A4
; ---------------------------------------------------------------------------

loc_10001372:				; CODE XREF: sub_10001000+330j
		cmp	[ebp+arg_10], edx
		jnz	short loc_100013EF
		lea	esi, [edi+eax]
		add	edi, ecx
		mov	[ebx+70h], esi
		lea	esi, [edi+eax]
		add	edi, ecx
		mov	[ebx+74h], ecx
		mov	[ebx+8DCh], ecx
		mov	ecx, [esp+2E8h+var_2D0]
		mov	[ebx+6Ch], edx
		mov	[ebx+8D4h], edx
		mov	[ebx+8D8h], esi
		cmp	ecx, edx
		jbe	loc_1000169A
		mov	[ebx+78h], edx
		mov	[ebx+80h], ecx
		mov	[ebx+8E0h], edx
		mov	[ebx+8E8h], ecx
		cmp	[esp+2E8h+var_2D8], edx
		jz	short loc_100013D8
		mov	eax, offset dword_100374B0
		mov	[ebx+7Ch], eax
		mov	[ebx+8E4h], eax
		xor	esi, esi
		jmp	loc_100016A4
; ---------------------------------------------------------------------------

loc_100013D8:				; CODE XREF: sub_10001000+3C1j
		lea	esi, [edi+eax]
		add	edi, ecx
		add	edi, eax
		mov	[ebx+7Ch], esi
		mov	[ebx+8E4h], edi
		xor	esi, esi
		jmp	loc_100016A4
; ---------------------------------------------------------------------------

loc_100013EF:				; CODE XREF: sub_10001000+375j
		cmp	[ebp+arg_C], edx
		jnz	loc_1000156D
		lea	edx, [esp+2E8h+var_290]
		push	edx
		call	sub_10022690
		mov	eax, [esp+2ECh+var_2D4]
		push	eax
		lea	ecx, [edi+ebx+113Ch]
		push	ecx
		lea	edx, [esp+2F4h+var_290]
		push	edx
		call	sub_100226C0
		mov	eax, [esp+2F8h+var_2AC]
		mov	ecx, [esp+2F8h+var_2B0]
		push	eax
		push	ecx
		lea	edx, [esp+300h+var_290]
		push	edx
		call	sub_100226C0
		push	10h
		lea	eax, [esp+308h+var_2D8]
		push	eax
		lea	ecx, [esp+30Ch+var_290]
		push	esi
		push	ecx
		call	sub_100226F0
		mov	eax, [esp+314h+var_2CC]
		lea	edx, [esp+314h+var_290]
		mov	[ebx+70h], esi
		push	edx
		mov	dword ptr [ebx+6Ch], 0
		mov	[ebx+74h], eax
		add	esi, eax
		call	sub_10022690
		mov	eax, [esp+318h+var_2D4]
		push	eax
		add	edi, eax
		lea	eax, [ebx+113Ch]
		add	edi, eax
		lea	eax, [esp+31Ch+var_290]
		push	edi
		push	eax
		call	sub_100226C0
		mov	ecx, [esp+324h+var_2B8]
		mov	edx, [esp+324h+var_2BC]
		push	ecx
		push	edx
		lea	eax, [esp+32Ch+var_290]
		push	eax
		call	sub_100226C0
		add	esp, 48h
		push	10h
		lea	ecx, [esp+2ECh+var_2D8]
		push	ecx
		lea	edx, [esp+2F0h+var_290]
		push	esi
		push	edx
		call	sub_100226F0
		mov	eax, [esp+2F8h+var_2CC]
		mov	edi, [esp+2F8h+var_2D0]
		mov	[ebx+8D8h], esi
		add	esp, 10h
		add	esi, eax
		mov	dword ptr [ebx+8D4h], 0
		mov	[ebx+8DCh], eax
		test	edi, edi
		jz	loc_10001698
		lea	eax, [esp+2E8h+var_290]
		push	eax
		call	sub_10022690
		mov	ecx, [esp+2ECh+var_2AC]
		mov	edx, [esp+2ECh+var_2B0]
		push	ecx
		push	edx
		lea	eax, [esp+2F4h+var_290]
		push	eax
		call	sub_100226C0
		push	10h
		lea	ecx, [esp+2FCh+var_2D8]
		push	ecx
		lea	edx, [esp+300h+var_290]
		push	esi
		push	edx
		call	sub_100226F0
		lea	eax, [esp+308h+var_290]
		mov	[ebx+7Ch], esi
		push	eax
		mov	dword ptr [ebx+78h], 0
		mov	[ebx+80h], edi
		add	esi, edi
		call	sub_10022690
		mov	ecx, [esp+30Ch+var_2B8]
		mov	edx, [esp+30Ch+var_2BC]
		push	ecx
		push	edx
		lea	eax, [esp+314h+var_290]
		push	eax
		call	sub_100226C0
		push	10h
		lea	ecx, [esp+31Ch+var_2D8]
		push	ecx
		lea	edx, [esp+320h+var_290]
		push	esi
		push	edx
		call	sub_100226F0
		add	esp, 40h
		mov	[ebx+8E4h], esi
		xor	edx, edx
		mov	dword ptr [ebx+8E0h], 0
		mov	[ebx+8E8h], edi
		xor	esi, esi
		jmp	loc_100016A4
; ---------------------------------------------------------------------------

loc_1000156D:				; CODE XREF: sub_10001000+3F2j
		push	edx
		add	eax, edi
		mov	[esp+2ECh+var_2A0], ecx
		lea	ecx, [esp+2ECh+var_2A8]
		push	ecx
		mov	[esp+2F0h+var_9C], edx
		mov	[esp+2F0h+var_2A8], edx
		mov	[esp+2F0h+var_98], eax
		mov	eax, [esp+2F0h+var_2D4]
		lea	edx, [esp+2F0h+var_2B4]
		push	edx
		mov	[esp+2F4h+var_94], eax
		lea	eax, [esp+2F4h+var_9C]
		push	offset aClientWriteKey ; "client write key"
		push	eax
		mov	[esp+2FCh+var_2A4], esi
		call	sub_10022B20
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000169E
		mov	ecx, [esp+2E8h+var_2D4]
		add	edi, ecx
		push	0
		lea	edx, [ebx+113Ch]
		mov	[esp+2ECh+var_94], ecx
		add	edi, edx
		lea	ecx, [esp+2ECh+var_2A8]
		push	ecx
		mov	[ebx+6Ch], eax
		mov	eax, [esp+2F0h+var_2CC]
		lea	edx, [esp+2F0h+var_2B4]
		push	edx
		mov	[ebx+70h], esi
		add	esi, eax
		mov	[ebx+74h], eax
		mov	[esp+2F4h+var_2A0], eax
		lea	eax, [esp+2F4h+var_9C]
		push	offset aServerWriteKey ; "server write key"
		push	eax
		mov	[esp+2FCh+var_98], edi
		mov	[esp+2FCh+var_2A4], esi
		call	sub_10022B20
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000169E
		mov	edi, [esp+2E8h+var_2D0]
		mov	[ebx+8D4h], eax
		mov	eax, [esp+2E8h+var_2CC]
		mov	[ebx+8D8h], esi
		add	esi, eax
		mov	[ebx+8DCh], eax
		test	edi, edi
		jz	short loc_10001698
		xor	eax, eax
		push	eax
		lea	edx, [esp+2ECh+var_2A8]
		push	edx
		mov	[esp+2F0h+var_98], eax
		mov	[esp+2F0h+var_94], eax
		lea	eax, [esp+2F0h+var_2B4]
		lea	ecx, [edi+edi]
		push	eax
		mov	[esp+2F4h+var_2A0], ecx
		lea	ecx, [esp+2F4h+var_9C]
		push	offset aIvBlock	; "IV block"
		push	ecx
		mov	[esp+2FCh+var_2A4], esi
		call	sub_10022B20
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000169E
		lea	edx, [edi+esi]
		mov	[ebx+78h], eax
		mov	[ebx+7Ch], esi
		mov	[ebx+80h], edi
		mov	[ebx+8E0h], eax
		mov	[ebx+8E4h], edx
		mov	[ebx+8E8h], edi

loc_10001698:				; CODE XREF: sub_10001000+4CDj
					; sub_10001000+636j
		xor	edx, edx

loc_1000169A:				; CODE XREF: sub_10001000+3A2j
		xor	esi, esi
		jmp	short loc_100016A4
; ---------------------------------------------------------------------------

loc_1000169E:				; CODE XREF: sub_10001000+1DCj
					; sub_10001000+5B6j ...
		mov	esi, [esp+2E8h+var_29C]
		xor	edx, edx

loc_100016A4:				; CODE XREF: sub_10001000+36Dj
					; sub_10001000+3D3j ...
		push	edx
		lea	eax, [esp+2ECh+var_290]
		push	eax
		call	sub_10022660
		lea	ecx, [esp+2F0h+var_1E0]
		push	0
		push	ecx
		call	sub_10022760
		add	esp, 10h
		test	esi, esi
		jz	short loc_100016D2
		push	0FFFFD051h
		call	PORT_SetError_Util
		add	esp, 4

loc_100016D2:				; CODE XREF: sub_10001000+6C3j
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+2DCh+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100016E9:				; CODE XREF: sub_10001000+49j
					; sub_10001000+56j
		push	0FFFFE005h
		call	PORT_SetError_Util
		mov	ecx, [esp+2ECh+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10001000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001710	proc near		; CODE XREF: sub_1000BF70+14Fp

var_26C		= dword	ptr -26Ch
var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= byte ptr -250h
var_1A0		= byte ptr -1A0h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_48		= byte ptr -48h
var_28		= byte ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+arg_C]
		push	esi
		xor	ecx, ecx
		mov	esi, 303h
		cmp	[eax+58h], si
		mov	[esp+274h+var_264], eax
		lea	edx, [eax+113Ch]
		sbb	eax, eax
		inc	eax
		push	edi
		mov	[esp+278h+var_26C], ecx
		cmp	[ebp+arg_14], ecx
		jz	short loc_1000177F
		cmp	dword ptr [ebx+8], 30h
		jz	short loc_1000177F
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+26Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000177F:				; CODE XREF: sub_10001710+42j
					; sub_10001710+48j
		mov	esi, [ebp+arg_4]
		mov	[esp+278h+var_260], ecx
		lea	ecx, [esp+278h+var_48]
		mov	[esp+278h+var_25C], ecx
		mov	ecx, 8
		lea	edi, [esp+278h+var_48]
		rep movsd
		mov	esi, [ebp+arg_8]
		mov	ecx, 8
		lea	edi, [esp+278h+var_28]
		rep movsd
		xor	esi, esi
		mov	[esp+278h+var_258], 40h
		cmp	[ebp+arg_10], esi
		jz	short loc_10001833
		mov	[esp+278h+var_5C], esi
		mov	[esp+278h+var_58], edx
		mov	[esp+278h+var_54], 30h
		push	esi
		cmp	eax, esi
		jz	short loc_100017FC
		lea	edx, [esp+27Ch+var_5C]
		push	edx
		lea	eax, [esp+280h+var_260]
		push	eax
		push	offset aMasterSecret ; "master secret"
		push	ebx
		push	4
		call	sub_10022DA0
		add	esp, 18h
		jmp	short loc_10001817
; ---------------------------------------------------------------------------

loc_100017FC:				; CODE XREF: sub_10001710+CBj
		lea	ecx, [esp+27Ch+var_5C]
		push	ecx
		lea	edx, [esp+280h+var_260]
		push	edx
		push	offset aMasterSecret ; "master secret"
		push	ebx
		call	sub_10022B20
		add	esp, 14h

loc_10001817:				; CODE XREF: sub_10001710+EAj
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_10001912
		push	0FFFFD051h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	loc_10001912
; ---------------------------------------------------------------------------

loc_10001833:				; CODE XREF: sub_10001710+ADj
		xor	edi, edi

loc_10001835:				; CODE XREF: sub_10001710+1F8j
		lea	eax, [esp+278h+var_1A0]
		push	eax
		call	sub_10022790
		mov	ecx, ds:off_1002A44C[esi*4]
		lea	eax, [esi+1]
		push	eax
		push	ecx
		lea	edx, [esp+284h+var_1A0]
		push	edx
		mov	[esp+288h+var_254], eax
		call	sub_100227C0
		mov	eax, [ebx+8]
		mov	ecx, [ebx+4]
		push	eax
		push	ecx
		lea	edx, [esp+290h+var_1A0]
		push	edx
		call	sub_100227C0
		mov	eax, [esp+294h+var_258]
		mov	ecx, [esp+294h+var_25C]
		push	eax
		push	ecx
		lea	edx, [esp+29Ch+var_1A0]
		push	edx
		call	sub_100227C0
		push	14h
		lea	eax, [esp+2A4h+var_268]
		push	eax
		lea	ecx, [esp+2A8h+var_5C]
		push	ecx
		lea	edx, [esp+2ACh+var_1A0]
		push	edx
		call	sub_100227F0
		lea	eax, [esp+2B0h+var_250]
		push	eax
		call	sub_10022690
		mov	ecx, [ebx+8]
		mov	edx, [ebx+4]
		push	ecx
		push	edx
		lea	eax, [esp+2BCh+var_250]
		push	eax
		call	sub_100226C0
		mov	ecx, [esp+2C0h+var_268]
		add	esp, 48h
		push	ecx
		lea	edx, [esp+27Ch+var_5C]
		push	edx
		lea	eax, [esp+280h+var_250]
		push	eax
		call	sub_100226C0
		mov	eax, [esp+284h+var_264]
		push	10h
		lea	ecx, [esp+288h+var_268]
		push	ecx
		lea	edx, [edi+eax+113Ch]
		push	edx
		lea	eax, [esp+290h+var_250]
		push	eax
		call	sub_100226F0
		mov	esi, [esp+294h+var_254]
		add	edi, [esp+294h+var_268]
		add	esp, 1Ch
		cmp	esi, 3
		jl	loc_10001835
		mov	ebx, [esp+278h+var_26C]

loc_10001912:				; CODE XREF: sub_10001710+10Bj
					; sub_10001710+11Ej
		mov	eax, [esp+278h+var_264]
		lea	edx, [eax+11CCh]
		lea	esi, [eax+113Ch]
		mov	ecx, 0Ch
		mov	edi, edx
		rep movsd
		mov	ecx, [esp+278h+var_4]
		pop	edi
		mov	[eax+1134h], edx
		mov	dword ptr [eax+1138h], 30h
		pop	esi
		mov	eax, ebx
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10001710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001960	proc near		; CODE XREF: SSL_CanBypass+34Ap
					; SSL_CanBypass+53Cp

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_4]
		push	esi
		mov	esi, edx
		mov	[esp+50h+var_3C], eax
		mov	[esp+50h+var_4C], 0
		mov	[esp+50h+var_48], 0
		mov	[esp+50h+var_44], 0
		test	esi, esi
		jnz	short loc_100019A8
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_100019A8:				; CODE XREF: sub_10001960+33j
		xor	eax, eax
		mov	[esp+50h+var_24], eax
		mov	[esp+50h+var_20], eax
		mov	[esp+50h+var_1C], eax
		mov	[esp+50h+var_18], eax
		mov	[esp+50h+var_14], eax
		mov	[esp+50h+var_10], eax
		mov	[esp+50h+var_C], eax
		mov	[esp+50h+var_8], eax
		cmp	[esp+50h+arg_0], eax
		jz	short loc_100019E8
		test	ecx, ecx
		setnz	al
		mov	ecx, 376h
		mov	edx, 2800h
		lea	eax, [eax+eax+375h]
		jmp	short loc_100019FD
; ---------------------------------------------------------------------------

loc_100019E8:				; CODE XREF: sub_10001960+6Ej
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		mov	ecx, 372h
		xor	edx, edx
		lea	eax, [eax+eax+371h]

loc_100019FD:				; CODE XREF: sub_10001960+86j
		push	ebp
		push	edi
		push	edx
		push	0
		push	10Ch
		lea	edi, [esp+64h+var_40]
		mov	[esp+64h+var_28], edi
		push	ecx
		lea	edi, [esp+68h+var_24]
		mov	[esp+68h+var_38], edi
		lea	ecx, [esp+68h+var_4C]
		mov	edi, 20h
		push	ecx
		mov	[esp+6Ch+var_34], edi
		mov	[esp+6Ch+var_2C], edi
		push	eax
		lea	ebp, [esp+70h+var_24]
		lea	edi, [esp+70h+var_38]
		push	esi
		mov	[esp+74h+var_30], ebp
		mov	[esp+74h+var_48], edi
		mov	[esp+74h+var_44], 14h
		call	PK11_DeriveWithFlags
		mov	esi, eax
		add	esp, 1Ch
		test	esi, esi
		jnz	short loc_10001A67
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10001A67:				; CODE XREF: sub_10001960+F0j
		push	esi
		call	PK11_ExtractKeyValue
		mov	edi, eax
		mov	eax, [esp+5Ch+var_3C]
		xor	edx, edx
		test	edi, edi
		setz	dl
		push	esi
		mov	[eax], edx
		call	PK11_FreeSymKey
		mov	ecx, [esp+60h+var_4]
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
sub_10001960	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  15. SSL_CanBypass

; =============== S U B	R O U T	I N E =======================================


		public SSL_CanBypass
SSL_CanBypass	proc near		; DATA XREF: .rdata:off_10035848o

var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= word ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= byte ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
Dst		= byte ptr -6Ch
var_6A		= word ptr -6Ah
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_34		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 0D0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0D0h+var_4], eax
		mov	eax, [esp+0D0h+arg_0]
		mov	ecx, [esp+0D0h+arg_18]
		push	ebx
		mov	ebx, [esp+0D4h+arg_14]
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	esi, [esp+0DCh+arg_4]
		push	edi
		mov	edi, [esp+0E0h+arg_C]
		mov	[esp+0E0h+var_C0], esi
		mov	[esp+0E0h+var_B8], ebx
		mov	[esp+0E0h+var_88], ecx
		mov	[esp+0E0h+var_D0], ebp
		mov	[esp+0E0h+var_B4], ebp
		mov	[esp+0E0h+var_B0], ebp
		mov	[esp+0E0h+var_AC], ebp
		mov	[esp+0E0h+var_A0], ebp
		mov	[esp+0E0h+var_A4], ebp
		mov	[esp+0E0h+var_9C], ebp
		mov	[esp+0E0h+var_CC], ebp
		mov	[esp+0E0h+var_98], ebp
		mov	[esp+0E0h+var_94], ebp
		mov	[esp+0E0h+var_90], ebp
		cmp	eax, ebp
		jz	loc_100020DA
		cmp	esi, ebp
		jz	loc_100020DA
		cmp	edi, ebp
		jz	loc_100020DA
		cmp	ebx, ebp
		jz	loc_100020DA
		push	eax
		call	CERT_ExtractPublicKey
		add	esp, 4
		mov	[esp+0E0h+var_C4], eax
		cmp	eax, ebp
		jz	loc_100020E7
		mov	dword ptr [ebx], 1
		mov	ebx, [esp+0E0h+arg_10]
		cmp	ebx, ebp
		jle	loc_10001C36
		nop

loc_10001B60:				; CODE XREF: SSL_CanBypass+18Cj
		movzx	esi, word ptr [edi]
		add	edi, 2
		test	si, si
		jz	loc_10001C32
		push	38h		; Size
		lea	edx, [esp+0E4h+Dst]
		push	edx		; Dst
		push	esi		; __int16
		call	SSL_GetCipherSuiteInfo
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10001C29
		and	esi, 0FFF0h
		cmp	esi, 0FF00h
		jz	loc_10001C29
		mov	eax, [esp+0E0h+var_58]
		mov	ecx, 1
		sub	eax, ecx
		jz	short loc_10001BFD
		sub	eax, 3
		jnz	short loc_10001C29
		mov	eax, [esp+0E0h+var_5C]
		mov	ecx, offset aEcdhe ; "ECDHE"
		lea	ebx, [ebx+0]

loc_10001BC0:				; CODE XREF: SSL_CanBypass+13Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10001BE0
		test	dl, dl
		jz	short loc_10001BDC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10001BE0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10001BC0

loc_10001BDC:				; CODE XREF: SSL_CanBypass+128j
		xor	eax, eax
		jmp	short loc_10001BE5
; ---------------------------------------------------------------------------

loc_10001BE0:				; CODE XREF: SSL_CanBypass+124j
					; SSL_CanBypass+130j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10001BE5:				; CODE XREF: SSL_CanBypass+13Ej
		test	eax, eax
		jnz	short loc_10001BF3
		mov	[esp+0E0h+var_CC], 1
		jmp	short loc_10001C29
; ---------------------------------------------------------------------------

loc_10001BF3:				; CODE XREF: SSL_CanBypass+147j
		mov	[esp+0E0h+var_9C], 1
		jmp	short loc_10001C29
; ---------------------------------------------------------------------------

loc_10001BFD:				; CODE XREF: SSL_CanBypass+107j
		movzx	eax, [esp+0E0h+var_6A]
		add	eax, 0FFFFFFFDh	; switch 98 cases
		cmp	eax, 61h
		ja	short loc_10001C1E ; jumptable 10001C11	default	case
		movzx	eax, ds:byte_1000210C[eax]
		jmp	ds:off_10002104[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10001C18:				; CODE XREF: SSL_CanBypass+171j
					; DATA XREF: .text:off_10002104o
		mov	[esp+0E0h+var_A4], ecx ; jumptable 10001C11 cases 3,6,98,100
		jmp	short loc_10001C29
; ---------------------------------------------------------------------------

loc_10001C1E:				; CODE XREF: SSL_CanBypass+168j
					; SSL_CanBypass+171j
					; DATA XREF: ...
		cmp	[esp+0E0h+var_A4], 0 ; jumptable 10001C11 default case
		jnz	short loc_10001C29
		mov	[esp+0E0h+var_A0], ecx

loc_10001C29:				; CODE XREF: SSL_CanBypass+E1j
					; SSL_CanBypass+F3j ...
		inc	ebp
		cmp	ebp, ebx
		jl	loc_10001B60

loc_10001C32:				; CODE XREF: SSL_CanBypass+C9j
		mov	esi, [esp+0E0h+var_C0]

loc_10001C36:				; CODE XREF: SSL_CanBypass+B9j
		push	esi
		call	SECKEY_GetPrivateKeyType
		mov	[esp+0E4h+var_8C], eax
		mov	eax, [esp+0E4h+arg_8]
		add	esp, 4
		and	eax, 3
		jz	loc_1000209A

loc_10001C53:				; CODE XREF: SSL_CanBypass+5D4j
		test	al, 1
		jz	short loc_10001C5E
		xor	ebp, ebp
		xor	eax, 1
		jmp	short loc_10001C66
; ---------------------------------------------------------------------------

loc_10001C5E:				; CODE XREF: SSL_CanBypass+1B5j
		mov	ebp, 1
		xor	eax, 2

loc_10001C66:				; CODE XREF: SSL_CanBypass+1BCj
		cmp	[esp+0E0h+var_8C], 1
		mov	[esp+0E0h+arg_8], eax
		jnz	loc_10001DFE
		cmp	[esp+0E0h+var_A4], 0
		jz	short loc_10001C9F
		mov	ecx, [esp+0E0h+var_C0]
		push	ecx
		call	PK11_GetPrivateModulusLen
		add	esp, 4
		cmp	eax, 40h
		jg	loc_1000207C
		mov	[esp+0E0h+var_A0], 1
		jmp	short loc_10001CAA
; ---------------------------------------------------------------------------

loc_10001C9F:				; CODE XREF: SSL_CanBypass+1DDj
		cmp	[esp+0E0h+var_A0], 0
		jz	loc_10001DFE

loc_10001CAA:				; CODE XREF: SSL_CanBypass+1FDj
		mov	edi, [esp+0E0h+var_88]
		push	edi
		lea	edx, [esp+0E4h+var_80]
		push	2
		xor	ebx, ebx
		push	edx
		mov	[esp+0ECh+var_84], ebx
		mov	[esp+0ECh+var_80], 370h
		mov	[esp+0ECh+var_7C], 1
		call	PK11_GetBestSlotMultiple
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebx
		jnz	short loc_10001CEC
		push	0FFFFD054h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	loc_10001DFE
; ---------------------------------------------------------------------------

loc_10001CEC:				; CODE XREF: SSL_CanBypass+238j
		push	edi
		push	ebx
		lea	ecx, [esp+0E8h+var_78]
		push	ecx
		lea	eax, [esp+0ECh+var_BC]
		push	370h
		push	esi
		mov	[esp+0F4h+var_BC], 3
		mov	[esp+0F4h+var_74], eax
		mov	[esp+0F4h+var_70], 2
		call	PK11_KeyGen
		mov	edi, eax
		push	esi
		mov	[esp+0F8h+var_D0], edi
		call	PK11_FreeSlot
		add	esp, 18h
		cmp	edi, ebx
		jz	loc_10001DFE
		mov	esi, [esp+0E0h+var_C4]
		push	esi
		call	SECKEY_PublicKeyStrength
		push	eax
		mov	[esp+0E8h+var_AC], eax
		call	PORT_Alloc_Util
		add	esp, 8
		mov	[esp+0E0h+var_B0], eax
		cmp	eax, ebx
		jnz	short loc_10001D63
		push	0FFFFE890h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	loc_10001DFE
; ---------------------------------------------------------------------------

loc_10001D63:				; CODE XREF: SSL_CanBypass+2AFj
		lea	edx, [esp+0E0h+var_B4]
		push	edx
		push	edi
		push	esi
		push	1
		call	PK11_PubWrapSymKey
		add	esp, 10h
		test	eax, eax
		jnz	loc_10001DFE
		push	edi
		call	PK11_FreeSymKey
		mov	eax, [esp+0E4h+var_AC]
		mov	ecx, [esp+0E4h+var_B0]
		mov	esi, [esp+0E4h+var_C0]
		push	eax
		push	ecx
		push	30h
		lea	edx, [esp+0F0h+var_84]
		push	edx
		lea	eax, [esp+0F4h+var_34]
		push	eax
		push	esi
		mov	[esp+0FCh+var_D0], ebx
		call	PK11_PrivDecryptPKCS1
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_10001DBC
		mov	ecx, [esp+0E0h+var_B8]
		mov	dword ptr [ecx], 1
		jmp	short loc_10001DFE
; ---------------------------------------------------------------------------

loc_10001DBC:				; CODE XREF: SSL_CanBypass+30Ej
		xor	edx, edx
		cmp	ebp, ebx
		setnz	dl
		push	ebx
		push	10Ch
		lea	eax, [esp+0E8h+var_B4]
		lea	edx, ds:371h[edx*4]
		push	edx
		push	eax
		push	esi
		call	PK11_PubUnwrapSymKey
		mov	esi, [esp+0F4h+var_B8]
		push	esi
		push	ebp
		xor	ecx, ecx
		mov	edx, eax
		mov	[esp+0FCh+var_D0], eax
		call	sub_10001960
		add	esp, 1Ch
		cmp	eax, ebx
		jnz	short loc_10001DFE
		cmp	[esi], ebx
		jz	loc_10002086

loc_10001DFE:				; CODE XREF: SSL_CanBypass+1D2j
					; SSL_CanBypass+204j ...
		xor	edi, edi
		cmp	[esp+0E0h+var_B0], edi
		jz	short loc_10001E14
		lea	ecx, [esp+0E0h+var_B4]
		push	edi
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10001E14:				; CODE XREF: SSL_CanBypass+364j
		mov	eax, [esp+0E0h+var_8C]
		cmp	eax, 6
		jnz	short loc_10001E30
		mov	esi, [esp+0E0h+var_CC]
		cmp	[esp+0E0h+var_9C], edi
		jnz	short loc_10001E45
		cmp	esi, edi
		jnz	short loc_10001E45
		jmp	loc_10002041
; ---------------------------------------------------------------------------

loc_10001E30:				; CODE XREF: SSL_CanBypass+37Bj
		cmp	eax, 1
		jnz	loc_10002041
		mov	esi, [esp+0E0h+var_CC]
		cmp	esi, edi
		jz	loc_10002041

loc_10001E45:				; CODE XREF: SSL_CanBypass+385j
					; SSL_CanBypass+389j
		mov	[esp+0E0h+var_C8], edi
		mov	[esp+0E0h+var_A8], edi
		cmp	eax, 6
		jnz	short loc_10001E66
		cmp	esi, edi
		jz	loc_10001F6C
		mov	ebx, [esp+0E0h+var_C4]
		lea	edi, [ebx+10h]
		jmp	loc_10001F28
; ---------------------------------------------------------------------------

loc_10001E66:				; CODE XREF: SSL_CanBypass+3B0j
		cmp	eax, 1
		jnz	loc_10001F24
		cmp	esi, edi
		jz	loc_10001F6C
		mov	edx, [esp+0E0h+var_C0]
		push	edx
		call	PK11_GetPrivateModulusLen
		add	esp, 4
		cmp	eax, edi
		jl	loc_10002041
		mov	ebx, [esp+0E0h+var_C4]
		mov	edx, [ebx+18h]
		cmp	byte ptr [edx],	0
		lea	ecx, ds:0[eax*8]
		mov	eax, [ebx+1Ch]
		jnz	short loc_10001EA3
		dec	eax

loc_10001EA3:				; CODE XREF: SSL_CanBypass+400j
		add	eax, eax
		add	eax, eax
		add	eax, eax
		cmp	eax, 400h
		jg	short loc_10001EB7
		mov	eax, 0A0h
		jmp	short loc_10001EEE
; ---------------------------------------------------------------------------

loc_10001EB7:				; CODE XREF: SSL_CanBypass+40Ej
		cmp	eax, 800h
		jg	short loc_10001EC5
		mov	eax, 0E0h
		jmp	short loc_10001EEE
; ---------------------------------------------------------------------------

loc_10001EC5:				; CODE XREF: SSL_CanBypass+41Cj
		cmp	eax, 0C00h
		jg	short loc_10001ED3
		mov	eax, 100h
		jmp	short loc_10001EEE
; ---------------------------------------------------------------------------

loc_10001ED3:				; CODE XREF: SSL_CanBypass+42Aj
		mov	esi, [esp+0E0h+var_CC]
		xor	edx, edx
		cmp	eax, 1C00h
		setnle	dl
		lea	eax, [edx-1]
		and	eax, 0FFFFFF77h
		add	eax, 209h

loc_10001EEE:				; CODE XREF: SSL_CanBypass+415j
					; SSL_CanBypass+423j ...
		cmp	ecx, eax
		jle	short loc_10001EF4
		mov	ecx, eax

loc_10001EF4:				; CODE XREF: SSL_CanBypass+450j
		push	ecx
		push	0
		call	sub_100219E0
		add	esp, 4
		push	eax
		call	sub_10020E30
		lea	ecx, [esp+0E8h+var_98]
		push	ecx
		push	eax
		push	0
		call	sub_10020930
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jz	loc_10002041
		lea	edi, [esp+0E0h+var_98]
		jmp	short loc_10001F28
; ---------------------------------------------------------------------------

loc_10001F24:				; CODE XREF: SSL_CanBypass+3C9j
		mov	ebx, [esp+0E0h+var_C4]

loc_10001F28:				; CODE XREF: SSL_CanBypass+3C1j
					; SSL_CanBypass+482j
		test	esi, esi
		jz	short loc_10001F70
		push	0
		lea	edx, [esp+0E4h+var_C8]
		push	edx
		push	edi
		call	SECKEY_CreateECPrivateKey
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_10001F52
		cmp	[esp+0E0h+var_C8], 0
		jnz	short loc_10001F7B
		push	esi
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10001F52:				; CODE XREF: SSL_CanBypass+4A0j
		mov	eax, [esp+0E0h+var_C8]
		test	eax, eax
		jz	loc_10002034
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		jmp	loc_10002034
; ---------------------------------------------------------------------------

loc_10001F6C:				; CODE XREF: SSL_CanBypass+3B4j
					; SSL_CanBypass+3D1j
		mov	ebx, [esp+0E0h+var_C4]

loc_10001F70:				; CODE XREF: SSL_CanBypass+48Aj
		mov	esi, [esp+0E0h+var_C0]
		mov	[esp+0E0h+var_C8], ebx
		lea	edi, [ebx+10h]

loc_10001F7B:				; CODE XREF: SSL_CanBypass+4A7j
		push	0
		lea	eax, [esp+0E4h+var_A8]
		push	eax
		push	edi
		call	SECKEY_CreateECPrivateKey
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	loc_1000201A
		mov	eax, [esp+0E0h+var_A8]
		test	eax, eax
		jz	short loc_1000201A
		push	0
		push	0
		xor	ecx, ecx
		push	1
		test	ebp, ebp
		push	0
		setnz	cl
		push	10Ch
		lea	ecx, ds:373h[ecx*4]
		push	ecx
		push	1050h
		push	0
		push	0
		push	0
		push	eax
		push	esi
		call	PK11_PubDeriveWithKDF
		mov	ebx, [esp+110h+var_B8]
		push	ebx
		push	ebp
		mov	ecx, 1
		mov	edx, eax
		mov	[esp+118h+var_D0], eax
		call	sub_10001960
		push	edi
		mov	ebp, eax
		call	SECKEY_DestroyPrivateKey
		mov	edx, [esp+11Ch+var_A8]
		push	edx
		call	SECKEY_DestroyPublicKey
		add	esp, 40h
		cmp	[esp+0E0h+var_CC], 0
		jz	short loc_10002010
		push	esi
		call	SECKEY_DestroyPrivateKey
		mov	eax, [esp+0E4h+var_C8]
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 8

loc_10002010:				; CODE XREF: SSL_CanBypass+55Bj
		test	ebp, ebp
		jnz	short loc_10002041
		cmp	[ebx], ebp
		jz	short loc_10002086
		jmp	short loc_10002041
; ---------------------------------------------------------------------------

loc_1000201A:				; CODE XREF: SSL_CanBypass+4EFj
					; SSL_CanBypass+4FBj
		cmp	[esp+0E0h+var_CC], 0
		jz	short loc_10002034
		push	esi
		call	SECKEY_DestroyPrivateKey
		mov	ecx, [esp+0E4h+var_C8]
		push	ecx
		call	SECKEY_DestroyPublicKey
		add	esp, 8

loc_10002034:				; CODE XREF: SSL_CanBypass+4B8j
					; SSL_CanBypass+4C7j ...
		push	0FFFFE064h
		call	PORT_SetError_Util
		add	esp, 4

loc_10002041:				; CODE XREF: SSL_CanBypass+38Bj
					; SSL_CanBypass+393j ...
		mov	eax, [esp+0E0h+var_94]
		test	eax, eax
		jz	short loc_1000205A
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esp+0E0h+var_94], 0

loc_1000205A:				; CODE XREF: SSL_CanBypass+5A7j
		mov	eax, [esp+0E0h+var_D0]
		test	eax, eax
		jz	short loc_1000206B
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4

loc_1000206B:				; CODE XREF: SSL_CanBypass+5C0j
		mov	eax, [esp+0E0h+arg_8]
		test	eax, eax
		jnz	loc_10001C53
		jmp	short loc_10002086
; ---------------------------------------------------------------------------

loc_1000207C:				; CODE XREF: SSL_CanBypass+1EFj
		mov	edx, [esp+0E0h+var_B8]
		mov	dword ptr [edx], 0

loc_10002086:				; CODE XREF: SSL_CanBypass+358j
					; SSL_CanBypass+576j ...
		cmp	[esp+0E0h+var_D0], 0
		jz	short loc_1000209A
		mov	eax, [esp+0E0h+var_D0]
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4

loc_1000209A:				; CODE XREF: SSL_CanBypass+1ADj
					; SSL_CanBypass+5EBj
		cmp	[esp+0E0h+var_B0], 0
		jz	short loc_100020B0
		lea	ecx, [esp+0E0h+var_B4]
		push	0
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100020B0:				; CODE XREF: SSL_CanBypass+5FFj
		mov	eax, [esp+0E0h+var_94]
		test	eax, eax
		jz	short loc_100020C9
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esp+0E0h+var_94], 0

loc_100020C9:				; CODE XREF: SSL_CanBypass+616j
		mov	edx, [esp+0E0h+var_C4]
		push	edx
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		xor	eax, eax
		jmp	short loc_100020EA
; ---------------------------------------------------------------------------

loc_100020DA:				; CODE XREF: SSL_CanBypass+77j
					; SSL_CanBypass+7Fj ...
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_100020E7:				; CODE XREF: SSL_CanBypass+A4j
		or	eax, 0FFFFFFFFh

loc_100020EA:				; CODE XREF: SSL_CanBypass+638j
		mov	ecx, [esp+0E0h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0D0h
		retn
SSL_CanBypass	endp

; ---------------------------------------------------------------------------
		align 4
off_10002104	dd offset loc_10001C18,	offset loc_10001C1E ; DATA XREF: SSL_CanBypass+171r
					; jump table for switch	statement
byte_1000210C	db	0,     1,     1,     0 ; DATA XREF: SSL_CanBypass+16Ar
		db	1,     1,     1,     1 ; indirect table	for switch statement
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     0
		db	1,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002170	proc near		; CODE XREF: sub_10004180+64p
					; sub_10004CF0+3C1p ...

arg_0		= word ptr  4

		mov	ax, [esp+arg_0]
		mov	ecx, 302h
		cmp	ax, cx
		jnz	short loc_10002185
		mov	eax, 0FEFFh
		retn
; ---------------------------------------------------------------------------

loc_10002185:				; CODE XREF: sub_10002170+Dj
		mov	edx, 303h
		cmp	ax, dx
		jnz	short loc_10002195
		mov	eax, 0FEFDh
		retn
; ---------------------------------------------------------------------------

loc_10002195:				; CODE XREF: sub_10002170+1Dj
		mov	ecx, 304h
		cmp	ax, cx
		mov	eax, 0FEFCh
		jz	short locret_100021A9
		mov	eax, 0FFFFh

locret_100021A9:			; CODE XREF: sub_10002170+32j
		retn
sub_10002170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100021B0	proc near		; CODE XREF: sub_10008220+16Bp
					; sub_1000A6D0+BCp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, eax
		shr	ecx, 8
		cmp	cl, 0FFh
		jnz	short loc_100021C1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100021C1:				; CODE XREF: sub_100021B0+Cj
		mov	edx, 0FEFFh
		cmp	ax, dx
		jnz	short loc_100021D1
		mov	eax, 302h
		retn
; ---------------------------------------------------------------------------

loc_100021D1:				; CODE XREF: sub_100021B0+19j
		mov	ecx, 0FEFDh
		cmp	ax, cx
		jnz	short loc_100021E1
		mov	eax, 303h
		retn
; ---------------------------------------------------------------------------

loc_100021E1:				; CODE XREF: sub_100021B0+29j
		mov	edx, 0FEFCh
		cmp	ax, dx
		mov	eax, 304h
		retn
sub_100021B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100021F0	proc near		; CODE XREF: sub_10009320+3BCp
					; sub_1000D820+549p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, offset dword_1002A4E0
		mov	eax, 0C007h

loc_10002200:				; CODE XREF: sub_100021F0+26j
		push	0
		push	eax
		push	edi
		call	sub_10007740
		movzx	eax, word ptr [esi+2]
		add	esi, 2
		add	esp, 0Ch
		test	ax, ax
		jnz	short loc_10002200
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100021F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002220	proc near		; CODE XREF: sub_10002B90+F4p
					; sub_10002B90+2FAp ...

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	[edi], edi
		jz	short loc_1000225E
		push	esi
		lea	ebx, [ebx+0]

loc_10002230:				; CODE XREF: sub_10002220+3Bj
		mov	esi, [edi+4]
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax
		movzx	ecx, word ptr [esi+14h]
		mov	edx, [esi+10h]
		push	ecx
		push	edx
		call	PORT_ZFree_Util
		push	esi
		call	PORT_Free_Util
		add	esp, 0Ch
		cmp	[edi], edi
		jnz	short loc_10002230
		pop	esi

loc_1000225E:				; CODE XREF: sub_10002220+7j
		pop	edi
		retn
sub_10002220	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002260(int,	int, void *Src,	size_t Size)
sub_10002260	proc near		; CODE XREF: sub_10002300+1Ep
					; sub_10002F60+1Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	eax, [edi+450h]
		movzx	ebp, word ptr [eax+1210h]
		push	18h
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100022A2
		mov	ebx, [esp+10h+Size]
		push	ebx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+10h], eax
		test	eax, eax
		jnz	short loc_100022B7
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_100022A2:				; CODE XREF: sub_10002260+23j
		push	0FFFFE013h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100022B7:				; CODE XREF: sub_10002260+37j
		mov	ecx, [esp+10h+Src]
		push	ebx		; Size
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		mov	edx, [esp+1Ch+arg_4]
		mov	[esi+14h], bx
		mov	[esi+8], bp
		mov	[esi+0Ch], edx
		lea	eax, [edi+8D8h]
		mov	[esi], eax
		mov	ecx, [edi+8DCh]
		mov	[esi+4], ecx
		mov	edx, [edi+8DCh]
		add	esp, 0Ch
		mov	[edx], esi
		mov	[edi+8DCh], esi
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10002260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002300	proc near		; CODE XREF: sub_10008FF0+12p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, [esi+0D0h]
		test	ecx, ecx
		jz	short loc_10002332
		mov	eax, [esi+0D4h]
		test	eax, eax
		jz	short loc_10002332
		push	eax		; Size
		push	ecx		; Src
		push	16h		; int
		push	esi		; int
		call	sub_10002260
		add	esp, 10h
		mov	dword ptr [esi+0D4h], 0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002332:				; CODE XREF: sub_10002300+Dj
					; sub_10002300+17j
		xor	eax, eax
		pop	esi
		retn
sub_10002300	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002340	proc near		; CODE XREF: sub_10007C90+1F6p

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		or	edi, 0FFFFFFFFh
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000235E
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000235E:				; CODE XREF: sub_10002340+Dj
		cmp	[esp+8+arg_8], 0
		mov	eax, [esi+450h]
		jz	short loc_10002388
		mov	cx, [esp+8+arg_4]
		cmp	[eax+1210h], cx
		jz	short loc_10002388
		mov	eax, [esi+454h]
		cmp	[eax+1210h], cx
		jnz	short loc_100023B5

loc_10002388:				; CODE XREF: sub_10002340+29j
					; sub_10002340+37j
		test	eax, eax
		jz	short loc_100023B5
		mov	ecx, [esp+8+arg_18]
		mov	edx, [esp+8+arg_14]
		push	ecx
		mov	ecx, [esp+0Ch+arg_10]
		push	edx
		mov	edx, [esp+10h+arg_C]
		push	ecx
		mov	ecx, [esi+4Ch]
		push	edx
		push	0
		push	1
		push	ecx
		push	eax
		call	sub_10004CF0
		add	esp, 20h
		mov	edi, eax
		jmp	short loc_100023C2
; ---------------------------------------------------------------------------

loc_100023B5:				; CODE XREF: sub_10002340+46j
					; sub_10002340+4Aj
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4

loc_100023C2:				; CODE XREF: sub_10002340+73j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100023D7
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_100023D7:				; CODE XREF: sub_10002340+86j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_10002340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100023E0	proc near		; CODE XREF: sub_10002B90+18Dp
					; sub_10008C10+CDp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		call	ds:PR_IntervalNow
		mov	ecx, [esp+arg_0]
		mov	[ecx+918h], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+91Ch], eax
		xor	eax, eax
		retn
sub_100023E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002400	proc near		; CODE XREF: sub_10010190+233p
					; sub_10010450+22Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+91Ch], 0
		jz	short loc_10002448
		mov	eax, [esi+920h]
		push	edi
		push	eax
		call	ds:PR_MillisecondsToInterval
		add	esp, 4
		mov	edi, eax
		call	ds:PR_IntervalNow
		sub	eax, [esi+918h]
		cmp	eax, edi
		pop	edi
		jbe	short loc_10002448
		mov	eax, [esi+91Ch]
		push	esi
		mov	dword ptr [esi+91Ch], 0
		call	eax
		add	esp, 4

loc_10002448:				; CODE XREF: sub_10002400+Cj
					; sub_10002400+30j
		pop	esi
		retn
sub_10002400	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10002450:				; DATA XREF: sub_10002B90+160o
					; sub_10002B90+187o ...
		mov	eax, [esp+4]
		mov	ecx, [eax+454h]
		push	0
		push	ecx
		call	sub_10003D00
		add	esp, 8
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002470	proc near		; CODE XREF: sub_10009C70+B0p
					; sub_1000D070+41p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+454h]
		push	0
		push	eax
		mov	dword ptr [esi+91Ch], 0
		call	sub_10003D00
		xor	ecx, ecx
		xor	edx, edx
		add	esp, 8
		mov	[esi+8D4h], cx
		mov	[esi+8E2h], dx
		pop	esi
		retn
sub_10002470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100024B0	proc near		; CODE XREF: sub_10002B10+2Cp
					; sub_10007320+FCp

arg_0		= dword	ptr  4
arg_4		= word ptr  8

		mov	cx, [esp+arg_4]
		test	cx, cx
		jnz	short loc_100024CB
		mov	ecx, [esp+arg_0]
		mov	eax, 5C0h
		mov	[ecx+2E88h], ax
		retn
; ---------------------------------------------------------------------------

loc_100024CB:				; CODE XREF: sub_100024B0+8j
		xor	eax, eax
		lea	ecx, [ecx+0]

loc_100024D0:				; CODE XREF: sub_100024B0+2Ej
		cmp	ds:word_1002A4D8[eax*2], cx
		jbe	short loc_100024F1
		inc	eax
		cmp	eax, 4
		jb	short loc_100024D0
		mov	edx, [esp+arg_0]
		mov	ecx, 0E4h
		mov	[edx+2E88h], cx
		retn
; ---------------------------------------------------------------------------

loc_100024F1:				; CODE XREF: sub_100024B0+28j
		mov	dx, ds:word_1002A4D8[eax*2]
		mov	eax, [esp+arg_0]
		mov	[eax+2E88h], dx
		retn
sub_100024B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002510	proc near		; CODE XREF: sub_1000F030+2DAp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Src		= dword	ptr -8
Size		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= byte ptr  0Ch

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		push	edi
		xor	edi, edi
		cmp	dword ptr [esi+4C0h], 6
		mov	[esp+20h+var_10], 0FFFFD07Ah
		mov	[esp+20h+var_C], edi
		mov	[esp+20h+Src], edi
		mov	[esp+20h+Size],	edi
		lea	ebp, [edi+2Fh]
		jz	short loc_1000256E
		mov	[esp+20h+var_10], 0FFFFD07Bh
		mov	ebp, 0Ah

loc_1000254A:				; CODE XREF: sub_10002510+83j
					; sub_10002510+AFj ...
		push	ebp
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_10002556:				; CODE XREF: sub_10002510+75j
					; sub_10002510+A1j
		mov	eax, [esp+20h+var_10]
		push	eax
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000256E:				; CODE XREF: sub_10002510+2Bj
		lea	eax, [esp+20h+arg_8]
		push	eax
		lea	ecx, [esp+24h+arg_4]
		push	ecx
		push	2
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, edi
		jl	short loc_10002556
		cmp	eax, 0FEFFh
		jz	short loc_10002595
		cmp	eax, 0FEFDh
		jnz	short loc_1000254A

loc_10002595:				; CODE XREF: sub_10002510+7Cj
		lea	edx, [esp+20h+arg_8]
		push	edx
		lea	eax, [esp+24h+arg_4]
		push	eax
		push	1
		lea	ecx, [esp+2Ch+var_C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10002556
		mov	ebx, [esp+20h+Size]
		cmp	ebx, 20h
		jbe	short loc_100025C1
		lea	ebp, [eax+32h]
		jmp	short loc_1000254A
; ---------------------------------------------------------------------------

loc_100025C1:				; CODE XREF: sub_10002510+AAj
		mov	edx, [esp+20h+Src]
		push	ebx		; Size
		push	edx		; Src
		lea	eax, [esi+8F4h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		test	byte ptr [esi+16h], 1
		mov	[esi+914h], bl
		jnz	short loc_100025F2
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100025F2:				; CODE XREF: sub_10002510+D0j
		push	1
		push	esi
		call	sub_10009320
		add	esp, 8
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_10002615
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10002615:				; CODE XREF: sub_10002510+F3j
		test	edi, edi
		jnz	loc_1000254A
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
sub_10002510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002630(void	*Dst)
sub_10002630	proc near		; CODE XREF: sub_10007290+73p
					; sub_100087C0+139p

Dst		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Dst]
		push	80h		; Size
		push	0		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		mov	dword ptr [esi+80h], 0
		mov	dword ptr [esi+84h], 0
		mov	dword ptr [esi+88h], 3FFh
		mov	dword ptr [esi+8Ch], 0
		pop	esi
		retn
sub_10002630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002670	proc near		; CODE XREF: sub_1000F790+1B9p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	eax, [edi+84h]
		ja	short loc_10002696
		jb	short loc_10002690
		cmp	esi, [edi+80h]
		jnb	short loc_10002696

loc_10002690:				; CODE XREF: sub_10002670+16j
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002696:				; CODE XREF: sub_10002670+14j
					; sub_10002670+1Ej
		cmp	eax, [edi+8Ch]
		jb	short loc_100026AD
		ja	short loc_100026A8
		cmp	esi, [edi+88h]
		jbe	short loc_100026AD

loc_100026A8:				; CODE XREF: sub_10002670+2Ej
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100026AD:				; CODE XREF: sub_10002670+2Cj
					; sub_10002670+36j
		and	esi, 3FFh
		xor	eax, eax
		mov	ecx, esi
		shrd	esi, eax, 3
		and	ecx, 7
		mov	edx, 1
		shl	edx, cl
		shr	eax, 3
		mov	eax, 0
		test	[esi+edi], dl
		pop	edi
		setnz	al
		pop	esi
		retn
sub_10002670	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100026E0	proc near		; CODE XREF: sub_1000F790+620p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_8]
		sub	esp, 8
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		cmp	edx, [edi+84h]
		jb	loc_100027B4
		mov	ecx, [esp+0Ch+arg_4]
		ja	short loc_1000270A
		cmp	ecx, [edi+80h]
		jb	loc_100027B4

loc_1000270A:				; CODE XREF: sub_100026E0+1Cj
		mov	eax, [edi+8Ch]
		push	esi
		mov	esi, [edi+88h]
		cmp	edx, eax
		jb	short loc_10002798
		ja	short loc_10002721
		cmp	ecx, esi
		jbe	short loc_10002798

loc_10002721:				; CODE XREF: sub_100026E0+3Bj
		or	ecx, 7
		push	ebx
		push	ebp
		mov	ebx, ecx
		add	ebx, 0FFFFFC01h
		mov	ebp, edx
		adc	ebp, 0FFFFFFFFh
		add	esi, 8
		adc	eax, 0
		mov	[esp+18h+var_8], ebx
		mov	[esp+18h+var_4], ebp
		cmp	eax, edx
		ja	short loc_1000277A
		jb	short loc_10002750
		cmp	esi, ecx
		ja	short loc_1000277A
		jmp	short loc_10002750
; ---------------------------------------------------------------------------
		align 10h

loc_10002750:				; CODE XREF: sub_100026E0+65j
					; sub_100026E0+6Bj ...
		mov	ebx, esi
		mov	ebp, eax
		shrd	ebx, ebp, 3
		and	ebx, 7Fh
		shr	ebp, 3
		add	esi, 8
		adc	eax, 0
		mov	byte ptr [ebx+edi], 0
		cmp	eax, edx
		jb	short loc_10002750
		ja	short loc_10002772
		cmp	esi, ecx
		jbe	short loc_10002750

loc_10002772:				; CODE XREF: sub_100026E0+8Cj
		mov	ebx, [esp+18h+var_8]
		mov	ebp, [esp+18h+var_4]

loc_1000277A:				; CODE XREF: sub_100026E0+63j
					; sub_100026E0+69j
		mov	[edi+84h], ebp
		pop	ebp
		mov	[edi+88h], ecx
		mov	ecx, [esp+14h+arg_4]
		mov	[edi+80h], ebx
		mov	[edi+8Ch], edx
		pop	ebx

loc_10002798:				; CODE XREF: sub_100026E0+39j
					; sub_100026E0+3Fj
		and	ecx, 3FFh
		xor	eax, eax
		mov	edx, ecx
		shrd	edx, eax, 3
		shr	eax, 3
		and	ecx, 7
		mov	al, 1
		shl	al, cl
		pop	esi
		or	[edi+edx], al

loc_100027B4:				; CODE XREF: sub_100026E0+12j
					; sub_100026E0+24j
		pop	edi
		add	esp, 8
		retn
sub_100026E0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. DTLS_GetHandshakeTimeout

; =============== S U B	R O U T	I N E =======================================


		public DTLS_GetHandshakeTimeout
DTLS_GetHandshakeTimeout proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	edi
		push	eax
		call	sub_1001C160
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100027D9

loc_100027D4:				; CODE XREF: DTLS_GetHandshakeTimeout+20j
					; DTLS_GetHandshakeTimeout+29j
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100027D9:				; CODE XREF: DTLS_GetHandshakeTimeout+12j
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_100027D4
		cmp	dword ptr [edi+91Ch], 0
		jz	short loc_100027D4
		push	esi
		call	ds:PR_IntervalNow
		mov	ecx, [edi+920h]
		mov	esi, eax
		sub	esi, [edi+918h]
		push	ecx
		call	ds:PR_MillisecondsToInterval
		add	esp, 4
		cmp	esi, eax
		jbe	short loc_1000281D
		mov	edx, [esp+8+arg_4]
		pop	esi
		mov	dword ptr [edx], 0
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000281D:				; CODE XREF: DTLS_GetHandshakeTimeout+4Cj
		mov	ecx, [esp+8+arg_4]
		sub	eax, esi
		pop	esi
		mov	[ecx], eax
		xor	eax, eax
		pop	edi
		retn
DTLS_GetHandshakeTimeout endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002830	proc near		; CODE XREF: sub_10002B10+35p
					; sub_10002B90+177p ...

var_5EC		= dword	ptr -5ECh
var_5E8		= dword	ptr -5E8h
var_5E4		= dword	ptr -5E4h
var_5E0		= dword	ptr -5E0h
var_5DC		= word ptr -5DCh
var_5DA		= byte ptr -5DAh
var_5D9		= byte ptr -5D9h
var_5D8		= byte ptr -5D8h
var_5D7		= byte ptr -5D7h
var_5D6		= byte ptr -5D6h
var_5D5		= byte ptr -5D5h
Dst		= byte ptr -5D4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5ECh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5ECh+var_4], eax
		push	ebp
		mov	ebp, [esp+5F0h+arg_0]
		movzx	eax, word ptr [ebp+2E88h]
		push	edi
		xor	edi, edi
		test	byte ptr [ebp+16h], 1
		mov	[esp+5F4h+var_5EC], eax
		jnz	short loc_10002885
		mov	ecx, [ebp+250h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4
		test	byte ptr [ebp+16h], 1
		jnz	short loc_10002885
		mov	edx, [ebp+25Ch]
		push	edx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_10002885:				; CODE XREF: sub_10002830+2Ej
					; sub_10002830+44j
		push	ebx
		lea	eax, [ebp+8D8h]
		push	esi
		mov	esi, [eax]
		cmp	esi, eax
		jz	loc_10002A70
		jmp	short loc_100028A0
; ---------------------------------------------------------------------------
		align 10h

loc_100028A0:				; CODE XREF: sub_10002830+67j
					; sub_10002830+236j
		movzx	eax, word ptr [esi+14h]
		movzx	ecx, word ptr [esp+5FCh+var_5EC]
		add	eax, 81h
		cmp	eax, ecx
		jle	short loc_100028EF
		push	ebp
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		js	loc_10002A7D
		cmp	dword ptr [ebp+2E4h], 0
		ja	loc_10002AA1
		movzx	edx, word ptr [ebp+8E0h]
		cmp	eax, edx
		jle	short loc_100028E2
		mov	[ebp+8E0h], ax

loc_100028E2:				; CODE XREF: sub_10002830+A9j
		movzx	eax, word ptr [ebp+2E88h]
		xor	edi, edi
		mov	[esp+5FCh+var_5EC], eax

loc_100028EF:				; CODE XREF: sub_10002830+80j
		movzx	ecx, word ptr [esi+14h]
		movzx	edx, word ptr [esp+5FCh+var_5EC]
		lea	eax, [ecx+81h]
		cmp	eax, edx
		jg	short loc_10002944
		mov	edx, [esi+0Ch]
		movzx	eax, word ptr [esi+8]
		push	50000000h
		push	ecx
		mov	ecx, [esi+10h]
		push	ecx
		push	edx
		push	eax
		push	ebp
		call	sub_10007C90
		movzx	ecx, word ptr [esi+14h]
		add	esp, 18h
		cmp	eax, ecx
		jnz	loc_10002A82
		mov	dx, [ebp+2E88h]
		sub	dx, [ebp+2E4h]
		movzx	eax, dx
		mov	[esp+5FCh+var_5EC], eax
		jmp	loc_10002A5C
; ---------------------------------------------------------------------------

loc_10002944:				; CODE XREF: sub_10002830+D0j
		xor	eax, eax
		mov	[esp+5FCh+var_5E8], eax
		cmp	ecx, 0Ch
		jbe	loc_10002A5C
		add	edx, 0FFFFFF77h
		mov	[esp+5FCh+var_5E4], edx
		lea	ecx, [ecx+0]

loc_10002960:				; CODE XREF: sub_10002830+201j
		mov	edi, [esi+10h]
		lea	ebx, [ecx-0Ch]
		sub	ebx, eax
		cmp	edx, ebx
		jnb	short loc_1000296E
		mov	ebx, edx

loc_1000296E:				; CODE XREF: sub_10002830+13Aj
		cmp	ebx, 5D0h
		jb	short loc_1000297B
		mov	ebx, 5D0h

loc_1000297B:				; CODE XREF: sub_10002830+144j
		mov	ecx, [edi]
		mov	[esp+5FCh+var_5E0], ecx
		mov	dx, [edi+4]
		mov	ecx, eax
		shr	ecx, 10h
		mov	[esp+5FCh+var_5DC], dx
		mov	[esp+5FCh+var_5DA], cl
		mov	edx, eax
		shr	edx, 8
		mov	ecx, ebx
		shr	ecx, 10h
		mov	[esp+5FCh+var_5D9], dl
		mov	[esp+5FCh+var_5D8], al
		push	ebx		; Size
		lea	eax, [edi+eax+0Ch]
		mov	[esp+600h+var_5D7], cl
		mov	edx, ebx
		push	eax		; Src
		lea	ecx, [esp+604h+Dst]
		shr	edx, 8
		push	ecx		; Dst
		mov	[esp+608h+var_5D6], dl
		mov	[esp+608h+var_5D5], bl
		call	memcpy
		mov	eax, [esi+0Ch]
		movzx	ecx, word ptr [esi+8]
		push	50000000h
		lea	edi, [ebx+0Ch]
		push	edi
		lea	edx, [esp+610h+var_5E0]
		push	edx
		push	eax
		push	ecx
		push	ebp
		call	sub_10007C90
		add	esp, 24h
		cmp	eax, edi
		jnz	short loc_10002A48
		push	ebp
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		js	short loc_10002A43
		cmp	dword ptr [ebp+2E4h], 0
		ja	short loc_10002A36
		movzx	edx, word ptr [ebp+8E0h]
		cmp	eax, edx
		jle	short loc_10002A12
		mov	[ebp+8E0h], ax

loc_10002A12:				; CODE XREF: sub_10002830+1D9j
		mov	eax, [esp+5FCh+var_5E8]
		movzx	ecx, word ptr [esi+14h]
		add	eax, ebx
		mov	[esp+5FCh+var_5E8], eax
		add	eax, 0Ch
		xor	edi, edi
		cmp	eax, ecx
		jnb	short loc_10002A5C
		mov	eax, [esp+5FCh+var_5E8]
		mov	edx, [esp+5FCh+var_5E4]
		jmp	loc_10002960
; ---------------------------------------------------------------------------

loc_10002A36:				; CODE XREF: sub_10002830+1CEj
		push	0FFFFD048h
		call	sub_100147C0
		add	esp, 4

loc_10002A43:				; CODE XREF: sub_10002830+1C5j
		or	edi, 0FFFFFFFFh
		jmp	short loc_10002A5C
; ---------------------------------------------------------------------------

loc_10002A48:				; CODE XREF: sub_10002830+1B8j
		or	edi, 0FFFFFFFFh
		cmp	eax, edi
		jz	short loc_10002A5C
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4

loc_10002A5C:				; CODE XREF: sub_10002830+10Fj
					; sub_10002830+11Dj ...
		mov	esi, [esi]
		lea	eax, [ebp+8D8h]
		cmp	esi, eax
		jnz	loc_100028A0
		test	edi, edi
		jnz	short loc_10002AC7

loc_10002A70:				; CODE XREF: sub_10002830+61j
		push	ebp
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		jns	short loc_10002A98

loc_10002A7D:				; CODE XREF: sub_10002830+8Dj
		or	edi, 0FFFFFFFFh
		jmp	short loc_10002AC7
; ---------------------------------------------------------------------------

loc_10002A82:				; CODE XREF: sub_10002830+F4j
		or	edi, 0FFFFFFFFh
		cmp	eax, edi
		jz	short loc_10002AC7
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	short loc_10002AC7
; ---------------------------------------------------------------------------

loc_10002A98:				; CODE XREF: sub_10002830+24Bj
		cmp	dword ptr [ebp+2E4h], 0
		jbe	short loc_10002AB3

loc_10002AA1:				; CODE XREF: sub_10002830+9Aj
		push	0FFFFD048h
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10002AC7
; ---------------------------------------------------------------------------

loc_10002AB3:				; CODE XREF: sub_10002830+26Fj
		movzx	ecx, word ptr [ebp+8E0h]
		cmp	eax, ecx
		jle	short loc_10002AC5
		mov	[ebp+8E0h], ax

loc_10002AC5:				; CODE XREF: sub_10002830+28Cj
		xor	edi, edi

loc_10002AC7:				; CODE XREF: sub_10002830+23Ej
					; sub_10002830+250j ...
		test	byte ptr [ebp+16h], 1
		pop	esi
		pop	ebx
		jnz	short loc_10002AF4
		mov	edx, [ebp+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4
		test	byte ptr [ebp+16h], 1
		jnz	short loc_10002AF4
		mov	eax, [ebp+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10002AF4:				; CODE XREF: sub_10002830+29Dj
					; sub_10002830+2B2j
		mov	ecx, [esp+5F4h+var_4]
		mov	eax, edi
		pop	edi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5ECh
		retn
sub_10002830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B10	proc near		; CODE XREF: sub_10002B90+377p
					; DATA XREF: sub_10002B10+6Co ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		inc	dword ptr [esi+924h]
		mov	eax, [esi+924h]
		xor	edx, edx
		mov	ecx, 3
		div	ecx
		test	edx, edx
		jnz	short loc_10002B44
		mov	dx, [esi+8E0h]
		dec	dx
		movzx	eax, dx
		push	eax
		push	esi
		call	sub_100024B0
		add	esp, 8

loc_10002B44:				; CODE XREF: sub_10002B10+1Cj
		push	esi
		call	sub_10002830
		add	esp, 4
		test	eax, eax
		jnz	short loc_10002B86
		mov	eax, [esi+920h]
		add	eax, eax
		mov	[esi+920h], eax
		cmp	eax, 0EA60h
		jbe	short loc_10002B70
		mov	dword ptr [esi+920h], 0EA60h

loc_10002B70:				; CODE XREF: sub_10002B10+54j
		call	ds:PR_IntervalNow
		mov	[esi+918h], eax
		mov	dword ptr [esi+91Ch], offset sub_10002B10

loc_10002B86:				; CODE XREF: sub_10002B10+3Fj
		pop	esi
		retn
sub_10002B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B90	proc near		; CODE XREF: sub_1000F790+78Cp

var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		mov	ecx, [eax+4]
		push	ebx
		mov	ebx, [eax]
		mov	eax, [eax+8]
		push	ebp
		push	esi
		push	edi
		mov	[esp+2Ch+var_8], ecx
		mov	[esp+2Ch+var_4], eax
		mov	[esp+2Ch+var_18], 0
		test	ecx, ecx
		jz	loc_10002F3B
		mov	esi, [esp+2Ch+arg_0]
		nop

loc_10002BC0:				; CODE XREF: sub_10002B90+32Fj
		cmp	ecx, 0Ch
		jb	loc_10002F26
		movzx	edi, byte ptr [ebx+1]
		movzx	edx, byte ptr [ebx+2]
		mov	cl, [ebx]
		movzx	eax, byte ptr [ebx+3]
		movzx	ebp, byte ptr [ebx+6]
		mov	[esp+2Ch+var_19], cl
		movzx	ecx, byte ptr [ebx+4]
		shl	edi, 8
		or	edi, edx
		movzx	edx, byte ptr [ebx+5]
		shl	cx, 8
		shl	edi, 8
		or	edi, eax
		movzx	eax, byte ptr [ebx+7]
		or	cx, dx
		shl	ebp, 8
		or	ebp, eax
		movzx	eax, byte ptr [ebx+9]
		movzx	edx, cx
		movzx	ecx, byte ptr [ebx+8]
		shl	ebp, 8
		or	ebp, ecx
		movzx	ecx, byte ptr [ebx+0Ah]
		shl	eax, 8
		or	eax, ecx
		movzx	ecx, byte ptr [ebx+0Bh]
		shl	eax, 8
		or	eax, ecx
		mov	[esp+2Ch+var_14], eax
		cmp	edi, 1FFFFh
		ja	loc_10002EC7
		mov	ecx, [esp+2Ch+var_8]
		sub	ecx, 0Ch
		add	ebx, 0Ch
		mov	[esp+2Ch+var_8], ecx
		cmp	ecx, eax
		jb	loc_10002F26
		lea	ecx, [eax+ebp]
		mov	[esp+2Ch+var_10], ecx
		cmp	ecx, edi
		ja	loc_10002F26
		movzx	ecx, word ptr [esi+8E2h]
		cmp	dx, cx
		jnz	short loc_10002CD4
		test	ebp, ebp
		jnz	short loc_10002CD1
		cmp	eax, edi
		jnz	short loc_10002CD1
		movzx	edx, [esp+2Ch+var_19]
		lea	eax, [esi+8D8h]
		push	eax
		mov	[esi+828h], edx
		mov	[esi+82Ch], edi
		call	sub_10002220
		add	esp, 4
		mov	dword ptr [esi+8F0h], 0FFFFFFFFh
		mov	[esi+91Ch], ebp
		cmp	[esi+924h], ebp
		jnz	short loc_10002CAE
		mov	dword ptr [esi+920h], 3E8h

loc_10002CAE:				; CODE XREF: sub_10002B90+112j
		mov	ecx, [esi+82Ch]
		push	ecx		; Size
		push	ebx		; Src
		push	esi		; int
		call	sub_1000F030
		add	esp, 0Ch
		mov	[esp+2Ch+var_18], eax
		cmp	eax, 0FFFFFFFFh
		jz	loc_10002F3B
		jmp	loc_10002EAF
; ---------------------------------------------------------------------------

loc_10002CD1:				; CODE XREF: sub_10002B90+D6j
					; sub_10002B90+DAj
		cmp	dx, cx

loc_10002CD4:				; CODE XREF: sub_10002B90+D2j
		jnb	short loc_10002D39
		mov	ecx, [esi+91Ch]
		test	ecx, ecx
		jz	loc_10002EB3
		cmp	ecx, offset sub_10002B10
		jz	loc_10002EE5
		cmp	ecx, offset loc_10002450
		jnz	loc_10002EB3
		push	esi
		mov	dword ptr [esi+91Ch], 0
		call	sub_10002830
		add	esp, 4
		test	eax, eax
		jnz	loc_10002F4A
		push	offset loc_10002450
		push	esi
		call	sub_100023E0
		add	esp, 8
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jz	loc_10002F3B
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10002D39:				; CODE XREF: sub_10002B90:loc_10002CD4j
		cmp	dx, cx
		ja	loc_10002EB3
		cmp	dword ptr [esi+8F0h], 0FFFFFFFFh
		jnz	short loc_10002DBB
		lea	edx, [esi+818h]
		push	edi
		push	edx
		call	sub_10018960
		add	esp, 8
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	loc_10002F3B
		mov	ecx, edi
		shr	ecx, 3
		inc	ecx
		lea	eax, [esi+8E4h]
		push	ecx
		push	eax
		call	sub_10018960
		add	esp, 8
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	loc_10002F3B
		mov	edx, [esi+8ECh]
		push	edx		; Size
		push	eax		; Val
		mov	[esi+8F0h], eax
		mov	eax, [esi+8E4h]
		push	eax		; Dst
		call	memset
		movzx	ecx, [esp+38h+var_19]
		mov	eax, [esp+38h+var_14]
		add	esp, 0Ch
		mov	[esi+828h], ecx
		mov	[esi+82Ch], edi

loc_10002DBB:				; CODE XREF: sub_10002B90+1B9j
		cmp	edi, [esi+82Ch]
		jnz	loc_10002F1C
		mov	edx, [esi+818h]
		push	eax		; Size
		add	edx, ebp
		push	ebx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		cmp	ebp, [esi+8F0h]
		ja	short loc_10002DEE
		mov	eax, [esp+2Ch+var_10]
		mov	[esi+8F0h], eax
		jmp	short loc_10002E15
; ---------------------------------------------------------------------------

loc_10002DEE:				; CODE XREF: sub_10002B90+250j
		mov	edx, [esp+2Ch+var_10]
		mov	al, 1
		mov	ecx, ebp
		rol	al, cl
		cmp	ebp, edx
		jnb	short loc_10002E15
		lea	esp, [esp+0]

loc_10002E00:				; CODE XREF: sub_10002B90+283j
		mov	edi, [esi+8E4h]
		mov	ecx, ebp
		shr	ecx, 3
		or	[ecx+edi], al
		inc	ebp
		rol	al, 1
		cmp	ebp, edx
		jb	short loc_10002E00

loc_10002E15:				; CODE XREF: sub_10002B90+25Cj
					; sub_10002B90+26Aj
		mov	edi, [esi+8F0h]
		mov	eax, [esi+82Ch]
		cmp	edi, eax
		jnb	short loc_10002E53
		mov	ebp, [esi+8E4h]
		jmp	short loc_10002E30
; ---------------------------------------------------------------------------
		align 10h

loc_10002E30:				; CODE XREF: sub_10002B90+29Bj
					; sub_10002B90+2C1j
		mov	ecx, edi
		and	ecx, 7
		mov	edx, 1
		shl	edx, cl
		mov	ecx, edi
		shr	ecx, 3
		mov	cl, [ecx+ebp]
		test	cl, dl
		jz	short loc_10002E53
		inc	dword ptr [esi+8F0h]
		inc	edi
		cmp	edi, eax
		jb	short loc_10002E30

loc_10002E53:				; CODE XREF: sub_10002B90+293j
					; sub_10002B90+2B6j
		cmp	[esi+8F0h], eax
		jnz	short loc_10002EAF
		mov	edx, [esi+818h]
		push	eax		; Size
		push	edx		; Src
		push	esi		; int
		mov	dword ptr [esi+8F0h], 0FFFFFFFFh
		call	sub_1000F030
		add	esp, 0Ch
		mov	[esp+2Ch+var_18], eax
		cmp	eax, 0FFFFFFFFh
		jz	loc_10002F3B
		lea	eax, [esi+8D8h]
		push	eax
		call	sub_10002220
		add	esp, 4
		cmp	dword ptr [esi+924h], 0
		mov	dword ptr [esi+91Ch], 0
		jnz	short loc_10002EAF
		mov	dword ptr [esi+920h], 3E8h

loc_10002EAF:				; CODE XREF: sub_10002B90+13Cj
					; sub_10002B90+2C9j ...
		mov	eax, [esp+2Ch+var_14]

loc_10002EB3:				; CODE XREF: sub_10002B90+14Ej
					; sub_10002B90+166j ...
		mov	ecx, [esp+2Ch+var_8]
		add	ebx, eax
		sub	ecx, eax
		mov	[esp+2Ch+var_8], ecx
		jnz	loc_10002BC0
		jmp	short loc_10002F3B
; ---------------------------------------------------------------------------

loc_10002EC7:				; CODE XREF: sub_10002B90+9Dj
		push	esi
		call	sub_10008BD0
		push	0FFFFD019h
		call	PORT_SetError_Util
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10002EE5:				; CODE XREF: sub_10002B90+15Aj
		call	ds:PR_IntervalNow
		mov	ecx, [esi+920h]
		sub	eax, [esi+918h]
		shr	ecx, 2
		cmp	eax, ecx
		jbe	short loc_10002F12
		xor	edi, edi
		push	esi
		mov	[esi+91Ch], edi
		call	sub_10002B10
		mov	[esp+30h+var_18], edi
		jmp	short loc_10002F38
; ---------------------------------------------------------------------------

loc_10002F12:				; CODE XREF: sub_10002B90+36Cj
		mov	[esp+2Ch+var_18], 0
		jmp	short loc_10002F3B
; ---------------------------------------------------------------------------

loc_10002F1C:				; CODE XREF: sub_10002B90+231j
		mov	dword ptr [esi+8F0h], 0FFFFFFFFh

loc_10002F26:				; CODE XREF: sub_10002B90+33j
					; sub_10002B90+B3j ...
		push	0FFFFD027h
		call	PORT_SetError_Util
		mov	[esp+30h+var_18], 0FFFFFFFFh

loc_10002F38:				; CODE XREF: sub_10002B90+380j
		add	esp, 4

loc_10002F3B:				; CODE XREF: sub_10002B90+25j
					; sub_10002B90+136j ...
		mov	edx, [esp+2Ch+arg_4]
		mov	eax, [esp+2Ch+var_18]
		mov	dword ptr [edx+4], 0

loc_10002F4A:				; CODE XREF: sub_10002B90+181j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_10002B90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002F60	proc near		; CODE XREF: sub_10008940+Ep
					; sub_10008960+78p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, [esi+0D0h]
		test	ecx, ecx
		jz	short loc_10002F94
		mov	eax, [esi+0D4h]
		test	eax, eax
		jz	short loc_10002F94
		push	eax		; Size
		push	ecx		; Src
		push	16h		; int
		push	esi		; int
		call	sub_10002260
		add	esp, 10h
		mov	dword ptr [esi+0D4h], 0
		test	eax, eax
		jnz	short loc_10002FD5

loc_10002F94:				; CODE XREF: sub_10002F60+Dj
					; sub_10002F60+17j
		push	ebx
		mov	ebx, [esp+8+arg_4]
		test	ebx, 40000000h
		jnz	short loc_10002FD2
		push	esi
		call	sub_10002830
		add	esp, 4
		test	eax, eax
		jnz	short loc_10002FD4
		test	ebx, 8000000h
		jnz	short loc_10002FD2
		mov	[esi+924h], eax
		call	ds:PR_IntervalNow
		mov	[esi+918h], eax
		mov	dword ptr [esi+91Ch], offset sub_10002B10

loc_10002FD2:				; CODE XREF: sub_10002F60+3Fj
					; sub_10002F60+54j
		xor	eax, eax

loc_10002FD4:				; CODE XREF: sub_10002F60+4Cj
		pop	ebx

loc_10002FD5:				; CODE XREF: sub_10002F60+32j
		pop	esi
		retn
sub_10002F60	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  59. SSL_PreencryptedFileToStream
; Exported entry  60. SSL_PreencryptedStreamToFile

; =============== S U B	R O U T	I N E =======================================


		public SSL_PreencryptedStreamToFile
SSL_PreencryptedStreamToFile proc near	; DATA XREF: .rdata:off_10035848o
		push	0FFFFE898h	; SSL_PreencryptedFileToStream
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		retn
SSL_PreencryptedStreamToFile endp


; =============== S U B	R O U T	I N E =======================================


sub_10002FF0	proc near		; CODE XREF: sub_10009320+439p
					; sub_10009320+7FEp ...
		sub	eax, 0
		jz	short loc_10003010
		dec	eax
		jnz	short loc_1000300D
		mov	eax, 304h
		cmp	[ecx+44h], ax
		jnb	short loc_1000300D
		mov	eax, [ecx+14h]
		shr	eax, 12h
		and	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1000300D:				; CODE XREF: sub_10002FF0+6j
					; sub_10002FF0+11j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003010:				; CODE XREF: sub_10002FF0+3j
		mov	eax, 1
		retn
sub_10002FF0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  43. SSL_GetStatistics

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetStatistics
SSL_GetStatistics proc near		; CODE XREF: sub_10016CD0:loc_10016E8Cp
					; DATA XREF: .rdata:off_10035848o
		mov	eax, offset dword_100374D0
		retn
SSL_GetStatistics endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION PR_AtomicIncrement]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003040	proc near		; CODE XREF: sub_10003370+49p
					; sub_10007810+79p ...
		movzx	eax, ax
		cmp	eax, 9Eh
		jg	short loc_10003070
		jz	short loc_10003097 ; jumptable 10003081	cases 49195,49199
		sub	eax, 3		; switch 154 cases
		cmp	eax, 99h
		ja	short loc_100030C2 ; jumptable 1000305D	default	case
		movzx	eax, ds:byte_100030DC[eax]
		jmp	ds:off_100030D0[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10003064:				; CODE XREF: sub_10003040+1Dj
					; DATA XREF: .text:off_100030D0o
		mov	edx, 301h	; jumptable 1000305D cases 3,6
		cmp	dx, [ecx]
		sbb	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10003070:				; CODE XREF: sub_10003040+8j
		sub	eax, 0C001h	; switch 47 cases
		cmp	eax, 2Eh
		ja	short loc_100030C2 ; jumptable 1000305D	default	case
		movzx	eax, ds:byte_10003188[eax]
		jmp	ds:off_10003178[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10003088:				; CODE XREF: sub_10003040+1Dj
					; sub_10003040+41j
					; DATA XREF: ...
		mov	edx, 303h	; jumptable 1000305D cases 59-61,103,107,156
					; jumptable 10003081 cases 49187,49191
		xor	eax, eax
		cmp	[ecx+2], dx
		setz	al
		retn
; ---------------------------------------------------------------------------

loc_10003097:				; CODE XREF: sub_10003040+Aj
					; sub_10003040+41j
					; DATA XREF: ...
		mov	eax, 303h	; jumptable 10003081 cases 49195,49199
		cmp	[ecx+2], ax
		sbb	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100030A4:				; CODE XREF: sub_10003040+41j
					; DATA XREF: .text:off_10003178o
		mov	edx, 301h	; jumptable 10003081 cases 49153-49172
		cmp	[ecx+2], dx
		jb	short loc_100030BF
		mov	eax, 304h
		cmp	[ecx], ax
		jnb	short loc_100030BF
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_100030BF:				; CODE XREF: sub_10003040+6Dj
					; sub_10003040+77j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100030C2:				; CODE XREF: sub_10003040+14j
					; sub_10003040+1Dj ...
		mov	edx, 304h	; jumptable 1000305D default case
		cmp	[ecx], dx
		sbb	eax, eax
		neg	eax
		retn
sub_10003040	endp

; ---------------------------------------------------------------------------
		align 10h
off_100030D0	dd offset loc_10003064,	offset loc_10003088, offset loc_100030C2
					; DATA XREF: sub_10003040+1Dr
					; jump table for switch	statement
byte_100030DC	db	0,     2,     2,     0 ; DATA XREF: sub_10003040+16r
		db	2,     2,     2,     2 ; indirect table	for switch statement
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	1,     1,     1,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	1,     2,     2,     2
		db	1,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     2,     2,     2
		db	2,     1
		align 4
off_10003178	dd offset loc_100030A4	; DATA XREF: sub_10003040+41r
		dd offset loc_10003088	; jump table for switch	statement
		dd offset loc_10003097
		dd offset loc_100030C2
byte_10003188	db	0,     0,     0,     0 ; DATA XREF: sub_10003040+3Ar
		db	0,     0,     0,     0 ; indirect table	for switch statement
		db	0,     0,     0,     0
		db	0,     0,     0,     0
		db	0,     0,     0,     0
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     1,     3
		db	3,     3,     1,     3
		db	3,     3,     2,     3
		db	3,     3,     2
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100031C0	proc near		; CODE XREF: sub_1000A6D0+275p
					; sub_1000D820+6CBp ...
		xor	eax, eax
		mov	ecx, offset dword_1002AA18

loc_100031C7:				; CODE XREF: sub_100031C0+16j
		cmp	[ecx], dx
		jz	short loc_100031E8
		add	ecx, 10h
		inc	eax
		cmp	ecx, offset dword_1002ADF8
		jl	short loc_100031C7
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100031E8:				; CODE XREF: sub_100031C0+Aj
		shl	eax, 4
		add	eax, offset dword_1002AA18
		retn
sub_100031C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003200	proc near		; CODE XREF: sub_10009320+311p
					; sub_1000A6D0+1D2p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		mov	[esp+0Ch+var_8], 0
		test	ebx, ebx
		jnz	short loc_10003228
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10003228:				; CODE XREF: sub_10003200+12j
		xor	eax, eax
		cmp	[ebx+18h], ax
		jz	loc_1000335F
		cmp	[ebx+4Ch], eax
		push	ebp
		setnz	al
		push	esi
		push	edi
		lea	edi, [ebx+350h]
		mov	[esp+18h+arg_0], 3Dh
		mov	[esp+18h+var_4], eax
		nop

loc_10003250:				; CODE XREF: sub_10003200+13Fj
		test	byte ptr [edi+3], 1
		jz	loc_10003338
		movzx	edx, word ptr [edi]
		xor	ecx, ecx
		mov	eax, offset dword_1002AA18

loc_10003264:				; CODE XREF: sub_10003200+72j
		cmp	[eax], dx
		jz	short loc_1000328A
		add	eax, 10h
		inc	ecx
		cmp	eax, offset dword_1002ADF8
		jl	short loc_10003264
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		and	byte ptr [edi+3], 0FDh
		jmp	loc_10003338
; ---------------------------------------------------------------------------

loc_1000328A:				; CODE XREF: sub_10003200+67j
		shl	ecx, 4
		add	ecx, offset dword_1002AA18
		test	ecx, ecx
		jnz	short loc_100032A0
		and	byte ptr [edi+3], 0FDh
		jmp	loc_10003338
; ---------------------------------------------------------------------------

loc_100032A0:				; CODE XREF: sub_10003200+95j
		mov	eax, [ecx+4]
		lea	edx, [eax+eax*8]
		mov	eax, [ecx+0Ch]
		mov	esi, ds:dword_1002A5D4[edx*4]
		mov	ebp, ds:dword_1002ADFC[esi*8]
		lea	ecx, [eax+eax*2]
		mov	ecx, ds:dword_1002A83C[ecx*8]
		cmp	eax, 12h
		jz	short loc_100032D3
		mov	edx, ecx
		add	edx, edx
		lea	edx, [ebx+edx*8+2ECh]
		jmp	short loc_100032D9
; ---------------------------------------------------------------------------

loc_100032D3:				; CODE XREF: sub_10003200+C4j
		lea	edx, [ebx+2FCh]

loc_100032D9:				; CODE XREF: sub_10003200+D1j
		test	ecx, ecx
		jz	short loc_1000330A
		cmp	[esp+18h+var_4], 0
		jz	short loc_100032F6
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_1000331B
		cmp	dword ptr [eax], 0
		jz	short loc_1000331B
		cmp	dword ptr [edx+4], 0
		jz	short loc_1000331B

loc_100032F6:				; CODE XREF: sub_10003200+E2j
		mov	eax, ds:dword_1002A5BC[ecx*4]
		push	eax
		call	PK11_TokenExists
		add	esp, 4
		test	eax, eax
		jz	short loc_1000331B

loc_1000330A:				; CODE XREF: sub_10003200+DBj
		test	esi, esi
		jz	short loc_1000331F
		push	ebp
		call	PK11_TokenExists
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000331F

loc_1000331B:				; CODE XREF: sub_10003200+E9j
					; sub_10003200+EEj ...
		xor	eax, eax
		jmp	short loc_10003324
; ---------------------------------------------------------------------------

loc_1000331F:				; CODE XREF: sub_10003200+10Cj
					; sub_10003200+119j
		mov	eax, 1

loc_10003324:				; CODE XREF: sub_10003200+11Dj
		add	al, al
		xor	al, [edi+3]
		and	al, 2
		xor	[edi+3], al
		test	byte ptr [edi+3], 2
		jz	short loc_10003338
		inc	[esp+18h+var_8]

loc_10003338:				; CODE XREF: sub_10003200+54j
					; sub_10003200+85j ...
		add	edi, 4
		dec	[esp+18h+arg_0]
		jnz	loc_10003250
		mov	esi, [esp+18h+var_8]
		test	esi, esi
		jg	short loc_1000335A
		push	0FFFFD017h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000335A:				; CODE XREF: sub_10003200+14Bj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp

loc_1000335F:				; CODE XREF: sub_10003200+2Ej
		pop	ebx
		add	esp, 8
		retn
sub_10003200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003370	proc near		; CODE XREF: sub_10007810+3Dp
					; sub_10009320+3CFp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		xor	ebx, ebx
		lea	ecx, [eax+18h]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		cmp	[ecx], bx
		jnz	short loc_10003385
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003385:				; CODE XREF: sub_10003370+Ej
		push	esi
		push	edi
		lea	esi, [eax+352h]
		mov	edi, 3Dh

loc_10003392:				; CODE XREF: sub_10003370+57j
		test	ebp, ebp
		jz	short loc_100033C3
		cmp	[esp+10h+arg_4], 0
		jz	short loc_100033C3
		mov	al, [esi+1]
		test	al, 1
		jz	short loc_100033C3
		test	al, 2
		jz	short loc_100033C3
		mov	al, [esi]
		test	al, al
		jz	short loc_100033C3
		movzx	eax, al
		cmp	eax, ebp
		jg	short loc_100033C3
		mov	ax, [esi-2]
		call	sub_10003040
		test	eax, eax
		jz	short loc_100033C3
		inc	ebx

loc_100033C3:				; CODE XREF: sub_10003370+24j
					; sub_10003370+2Bj ...
		add	esi, 4
		dec	edi
		jnz	short loc_10003392
		pop	edi
		pop	esi
		test	ebx, ebx
		jg	short loc_100033DC
		push	0FFFFD014h
		call	PORT_SetError_Util
		add	esp, 4

loc_100033DC:				; CODE XREF: sub_10003370+5Dj
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
sub_10003370	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100033F0:				; DATA XREF: sub_100044F0+DCo
					; sub_10007290o ...
		mov	eax, [esp+18h]
		cmp	eax, [esp+10h]
		jle	short loc_10003415
		mov	eax, [esp+0Ch]
		push	0FFFFE003h
		mov	dword ptr [eax], 0
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10003415:				; CODE XREF: .text:100033F8j
		mov	ecx, [esp+0Ch]
		mov	edx, [esp+8]
		mov	[ecx], eax
		mov	ecx, [esp+14h]
		cmp	ecx, edx
		jz	short loc_10003432
		push	eax
		push	ecx
		push	edx
		call	memcpy
		add	esp, 0Ch

loc_10003432:				; CODE XREF: .text:10003425j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003440	proc near		; CODE XREF: sub_10009320+26Cp
					; sub_10017580+30p

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		movzx	eax, word ptr [edx+18h]
		test	ax, ax
		jnz	short loc_1000345E
		push	0FFFFD014h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000345E:				; CODE XREF: sub_10003440+Bj
		mov	cx, [esp+arg_4]
		cmp	cx, ax
		jb	short loc_10003487
		movzx	eax, word ptr [edx+1Ah]
		cmp	cx, ax
		jbe	short loc_1000347B
		cmp	[esp+arg_8], 0
		jz	short loc_10003487
		cmp	cx, ax

loc_1000347B:				; CODE XREF: sub_10003440+2Fj
		jnb	short loc_10003480
		movzx	eax, cx

loc_10003480:				; CODE XREF: sub_10003440:loc_1000347Bj
		mov	[edx+44h], ax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003487:				; CODE XREF: sub_10003440+26j
					; sub_10003440+36j
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_10003440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100034A0	proc near		; CODE XREF: sub_10009320+55Ep
		push	esi
		push	20h
		push	eax
		call	PK11_GenerateRandom
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_100034C1
		push	0FFFFD041h
		call	sub_100147C0
		add	esp, 4
		mov	eax, esi

loc_100034C1:				; CODE XREF: sub_100034A0+10j
		pop	esi
		retn
sub_100034A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100034D0	proc near		; CODE XREF: sub_1000A4D0+BFp
					; sub_1000B9F0+148p ...

var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 18h
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+24h+arg_8]
		xor	ebp, ebp
		mov	[esi+4], ebp
		mov	eax, [ebx+4]
		push	edi
		or	edi, 0FFFFFFFFh
		dec	eax
		jz	short loc_1000354E
		dec	eax
		jz	short loc_1000352F
		sub	eax, 4
		jz	short loc_10003504
		push	0FFFFE028h
		call	PORT_SetError_Util
		jmp	loc_1000362E
; ---------------------------------------------------------------------------

loc_10003504:				; CODE XREF: sub_100034D0+23j
		mov	eax, [esp+28h+arg_0]
		cmp	dword ptr [eax+4], 0
		mov	ebp, 1
		jnz	short loc_10003520
		lea	ecx, [eax+18h]
		mov	[esp+28h+var_10], 14h
		jmp	short loc_1000355B
; ---------------------------------------------------------------------------

loc_10003520:				; CODE XREF: sub_100034D0+41j
		mov	ecx, [eax]
		lea	edx, [eax+8]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_10], ecx
		jmp	short loc_1000355F
; ---------------------------------------------------------------------------

loc_1000352F:				; CODE XREF: sub_100034D0+1Ej
		mov	eax, [esp+28h+arg_0]
		cmp	dword ptr [eax+4], 0
		mov	ebp, [esp+28h+arg_C]
		jnz	short loc_10003552
		lea	edx, [eax+18h]
		mov	[esp+28h+var_14], edx
		mov	[esp+28h+var_10], 14h
		jmp	short loc_1000355F
; ---------------------------------------------------------------------------

loc_1000354E:				; CODE XREF: sub_100034D0+1Bj
		mov	eax, [esp+28h+arg_0]

loc_10003552:				; CODE XREF: sub_100034D0+6Bj
		mov	edx, [eax]
		mov	[esp+28h+var_10], edx
		lea	ecx, [eax+8]

loc_1000355B:				; CODE XREF: sub_100034D0+4Ej
		mov	[esp+28h+var_14], ecx

loc_1000355F:				; CODE XREF: sub_100034D0+5Dj
					; sub_100034D0+7Cj
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_100035AA
		push	ebx
		call	PK11_SignatureLen
		add	esp, 4
		test	eax, eax
		jg	short loc_10003582
		push	0FFFFE028h
		call	PORT_SetError_Util
		jmp	loc_1000362E
; ---------------------------------------------------------------------------

loc_10003582:				; CODE XREF: sub_100034D0+A1j
		push	eax
		mov	[esi+8], eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jz	loc_10003631
		lea	eax, [esp+28h+var_18]
		push	eax
		push	esi
		push	ebx
		call	PK11_Sign
		add	esp, 0Ch
		jmp	short loc_100035BA
; ---------------------------------------------------------------------------

loc_100035AA:				; CODE XREF: sub_100034D0+94j
		lea	ecx, [esp+28h+var_18]
		push	ecx
		push	esi
		push	eax
		push	ebx
		call	SGN_Digest
		add	esp, 10h

loc_100035BA:				; CODE XREF: sub_100034D0+D8j
		mov	edi, eax
		xor	ebx, ebx
		cmp	edi, ebx
		jz	short loc_100035CE
		push	0FFFFD042h
		call	sub_100147C0
		jmp	short loc_1000362E
; ---------------------------------------------------------------------------

loc_100035CE:				; CODE XREF: sub_100034D0+F0j
		cmp	ebp, ebx
		jz	short loc_10003648
		mov	edx, [esi+8]
		push	edx
		lea	eax, [esp+2Ch+var_C]
		push	esi
		push	eax
		mov	[esp+34h+var_C], ebx
		mov	[esp+34h+var_8], ebx
		mov	[esp+34h+var_4], ebx
		call	DSAU_EncodeDerSigWithLen
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebx
		jnz	short loc_10003620
		mov	ecx, [esi+4]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esp+2Ch+var_C]
		mov	eax, [esp+2Ch+var_8]
		mov	ecx, [esp+2Ch+var_4]
		mov	[esi], edx
		add	esp, 4
		mov	[esi+4], eax
		mov	eax, edi
		pop	edi
		mov	[esi+8], ecx
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10003620:				; CODE XREF: sub_100034D0+124j
		mov	eax, [esp+28h+var_8]
		cmp	eax, ebx
		jz	short loc_10003631
		push	eax
		call	PORT_Free_Util

loc_1000362E:				; CODE XREF: sub_100034D0+2Fj
					; sub_100034D0+ADj ...
		add	esp, 4

loc_10003631:				; CODE XREF: sub_100034D0+C3j
					; sub_100034D0+156j
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10003648
		push	eax
		call	PORT_Free_Util
		mov	dword ptr [esi+4], 0
		add	esp, 4

loc_10003648:				; CODE XREF: sub_100034D0+100j
					; sub_100034D0+166j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_100034D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003660	proc near		; CODE XREF: sub_1000AE00+2D2p
					; sub_1000AE00+4CBp ...

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_4]
		push	esi
		push	eax
		mov	[esp+18h+var_10], 0
		call	CERT_ExtractPublicKey
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10003694
		push	0FFFFD043h
		call	sub_100147C0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10003694:				; CODE XREF: sub_10003660+1Dj
		mov	ecx, [esi+4]
		dec	ecx
		mov	eax, [esp+14h+arg_0]
		push	ebx
		mov	ebx, [eax+4]
		push	ebp
		push	edi
		jz	loc_1000376C
		dec	ecx
		jz	short loc_100036F8
		sub	ecx, 4
		jz	short loc_100036CE
		push	esi
		call	SECKEY_DestroyPublicKey
		push	0FFFFE030h
		call	PORT_SetError_Util
		add	esp, 8
		pop	edi
		pop	ebp
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100036CE:				; CODE XREF: sub_10003660+4Ej
		mov	edi, [esp+20h+arg_8]
		mov	ebp, 0C8h
		test	ebx, ebx
		jnz	loc_10003775
		add	eax, 18h
		mov	ebx, 4
		mov	[esp+20h+var_8], eax
		mov	[esp+20h+var_4], 14h
		jmp	loc_10003786
; ---------------------------------------------------------------------------

loc_100036F8:				; CODE XREF: sub_10003660+49j
		mov	ebp, 7Ch
		test	ebx, ebx
		jnz	short loc_10003712
		add	eax, 18h
		mov	[esp+20h+var_8], eax
		mov	[esp+20h+var_4], 14h
		jmp	short loc_1000371F
; ---------------------------------------------------------------------------

loc_10003712:				; CODE XREF: sub_10003660+9Fj
		mov	edx, [eax]
		lea	ecx, [eax+8]
		mov	[esp+20h+var_8], ecx
		mov	[esp+20h+var_4], edx

loc_1000371F:				; CODE XREF: sub_10003660+B0j
		cmp	[esp+20h+arg_C], 0
		mov	edi, [esp+20h+arg_8]
		jnz	short loc_10003738
		push	esi
		call	SECKEY_SignatureLen
		add	esp, 4
		cmp	[edi+8], eax
		jz	short loc_10003782

loc_10003738:				; CODE XREF: sub_10003660+C8j
		push	esi
		call	SECKEY_SignatureLen
		push	eax
		push	edi
		call	DSAU_DecodeDerSigToLen
		add	esp, 0Ch
		mov	[esp+20h+var_10], eax
		test	eax, eax
		jnz	short loc_10003768
		push	0FFFFD057h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebp
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10003768:				; CODE XREF: sub_10003660+EEj
		mov	edi, eax
		jmp	short loc_10003782
; ---------------------------------------------------------------------------

loc_1000376C:				; CODE XREF: sub_10003660+42j
		mov	edi, [esp+20h+arg_8]
		mov	ebp, 10h

loc_10003775:				; CODE XREF: sub_10003660+79j
		mov	edx, [eax]
		lea	ecx, [eax+8]
		mov	[esp+20h+var_4], edx
		mov	[esp+20h+var_8], ecx

loc_10003782:				; CODE XREF: sub_10003660+D6j
					; sub_10003660+10Aj
		test	ebx, ebx
		jz	short loc_100037A4

loc_10003786:				; CODE XREF: sub_10003660+93j
		cmp	dword ptr [esi+4], 2
		jz	short loc_100037A4
		mov	eax, [esp+20h+arg_10]
		push	eax
		push	ebx
		push	ebp
		push	edi
		lea	ecx, [esp+30h+var_C]
		push	esi
		push	ecx
		call	VFY_VerifyDigestDirect
		add	esp, 18h
		jmp	short loc_100037B8
; ---------------------------------------------------------------------------

loc_100037A4:				; CODE XREF: sub_10003660+124j
					; sub_10003660+12Aj
		mov	edx, [esp+20h+arg_10]
		push	edx
		lea	eax, [esp+24h+var_C]
		push	eax
		push	edi
		push	esi
		call	PK11_Verify
		add	esp, 10h

loc_100037B8:				; CODE XREF: sub_10003660+142j
		push	esi
		mov	edi, eax
		call	SECKEY_DestroyPublicKey
		mov	eax, [esp+24h+var_10]
		add	esp, 4
		test	eax, eax
		jz	short loc_100037D6
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100037D6:				; CODE XREF: sub_10003660+169j
		test	edi, edi
		jz	short loc_100037E7
		push	0FFFFD057h
		call	sub_100147C0
		add	esp, 4

loc_100037E7:				; CODE XREF: sub_10003660+178j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 10h
		retn
sub_10003660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003800	proc near		; CODE XREF: sub_10003A00+121p
					; sub_10003B60+164p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		cmp	[esp+10h+arg_10], edi
		jz	loc_1000392B
		test	ebp, ebp
		jnz	short loc_10003851
		mov	ebx, [esp+10h+arg_8]
		mov	eax, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	ebx
		push	eax
		lea	ecx, [esi+8]
		push	ecx
		call	sub_10022620
		mov	edx, [esp+1Ch+arg_4]
		push	ebx
		push	edx
		lea	eax, [esi+18h]
		push	eax
		call	sub_10022720
		add	esp, 18h
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 24h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003851:				; CODE XREF: sub_10003800+16j
		cmp	ebp, 4
		jnz	short loc_10003880
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	ecx
		push	edx
		lea	eax, [esi+8]
		push	eax
		call	sub_10022720
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 14h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003880:				; CODE XREF: sub_10003800+54j
		cmp	ebp, 0BFh
		jnz	short loc_100038B2
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	ecx
		push	edx
		lea	eax, [esi+8]
		push	eax
		call	sub_10022890
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 20h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100038B2:				; CODE XREF: sub_10003800+86j
		cmp	ebp, 0C0h
		jnz	short loc_100038E4
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	ecx
		push	edx
		lea	eax, [esi+8]
		push	eax
		call	sub_10022910
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 30h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100038E4:				; CODE XREF: sub_10003800+B8j
		cmp	ebp, 0C1h
		jnz	short loc_10003916
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	ecx
		push	edx
		lea	eax, [esi+8]
		push	eax
		call	sub_100228D0
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 40h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003916:				; CODE XREF: sub_10003800+EAj
		push	0FFFFD07Eh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000392B:				; CODE XREF: sub_10003800+Ej
		test	ebp, ebp
		jnz	short loc_1000399C
		mov	edi, [esp+10h+arg_8]
		mov	ebx, [esp+10h+arg_4]
		mov	esi, [esp+10h+arg_C]
		push	edi
		push	ebx
		lea	ecx, [esi+8]
		push	ecx
		push	3
		call	PK11_HashBuf
		add	esp, 10h
		test	eax, eax
		jz	short loc_10003966
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003966:				; CODE XREF: sub_10003800+14Dj
		push	edi
		push	ebx
		lea	edx, [esi+18h]
		push	edx
		push	4
		call	PK11_HashBuf
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_1000398C
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh

loc_1000398C:				; CODE XREF: sub_10003800+17Aj
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		mov	dword ptr [esi], 24h
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000399C:				; CODE XREF: sub_10003800+12Dj
		push	ebp
		call	HASH_ResultLenByOidTag
		mov	esi, [esp+14h+arg_C]
		add	esp, 4
		mov	[esi], eax
		cmp	eax, 40h
		jbe	short loc_100039C7
		push	0FFFFD07Eh
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100039C7:				; CODE XREF: sub_10003800+1AEj
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		push	eax
		push	ecx
		lea	edx, [esi+8]
		push	edx
		push	ebp
		call	PK11_HashBuf
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_100039F4
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh

loc_100039F4:				; CODE XREF: sub_10003800+1E2j
		mov	eax, edi
		pop	edi
		mov	[esi+4], ebp
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10003800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003A00(int,	int, int, size_t Size, int, int, int, int, int,	int, int)
sub_10003A00	proc near		; CODE XREF: sub_1000AE00+4A9p
					; sub_1000B9F0+F2p

var_46C		= dword	ptr -46Ch
var_468		= dword	ptr -468h
var_464		= dword	ptr -464h
var_460		= dword	ptr -460h
var_45C		= dword	ptr -45Ch
var_458		= dword	ptr -458h
var_454		= dword	ptr -454h
Src		= dword	ptr -450h
var_448		= byte ptr -448h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 46Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+46Ch+var_4], eax
		mov	eax, [esp+46Ch+arg_4]
		mov	ecx, [esp+46Ch+arg_8]
		mov	edx, [esp+46Ch+arg_10]
		mov	[esp+46Ch+var_454], eax
		mov	eax, [esp+46Ch+arg_14]
		mov	[esp+46Ch+var_45C], eax
		mov	eax, [esp+46Ch+arg_18]
		push	ebx
		mov	ebx, [esp+470h+Size]
		mov	[esp+470h+var_458], eax
		lea	eax, [eax+ebx+44h]
		mov	[esp+470h+Src],	ecx
		mov	ecx, [esp+470h+arg_24]
		push	ebp
		mov	[esp+474h+var_460], edx
		mov	[esp+474h+var_464], ecx
		mov	[esp+474h+var_468], eax
		cmp	eax, 444h
		ja	short loc_10003A78
		lea	ebp, [esp+474h+var_448]
		mov	[esp+474h+var_46C], ebp
		jmp	short loc_10003AA5
; ---------------------------------------------------------------------------

loc_10003A78:				; CODE XREF: sub_10003A00+6Cj
		push	eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+474h+var_46C], eax
		test	eax, eax
		jnz	short loc_10003AA3
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+46Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 46Ch
		retn
; ---------------------------------------------------------------------------

loc_10003AA3:				; CODE XREF: sub_10003A00+87j
		mov	ebp, eax

loc_10003AA5:				; CODE XREF: sub_10003A00+76j
		mov	eax, [esp+474h+Src]
		push	esi
		mov	esi, [esp+478h+arg_1C]
		push	edi
		mov	edi, ebp
		mov	ecx, 8
		rep movsd
		mov	esi, [esp+47Ch+arg_20]
		lea	edi, [ebp+20h]
		mov	edx, ebx
		mov	ecx, 8
		rep movsd
		shr	edx, 8
		push	ebx		; Size
		mov	[ebp+40h], dl
		mov	[ebp+41h], bl
		push	eax		; Src
		add	ebp, 42h
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+488h+var_458]
		mov	edx, [esp+488h+var_45C]
		mov	ecx, eax
		add	ebp, ebx
		shr	ecx, 8
		push	eax		; Size
		mov	[ebp+0], cl
		mov	[ebp+1], al
		push	edx		; Src
		add	ebp, 2
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+494h+arg_28]
		mov	ecx, [esp+494h+var_464]
		mov	edx, [esp+494h+var_468]
		mov	esi, [esp+494h+var_46C]
		push	eax
		mov	eax, [esp+498h+arg_0]
		push	ecx
		push	edx
		push	esi
		push	eax
		call	sub_10003800
		lea	ecx, [esp+4A8h+var_448]
		add	esp, 2Ch
		mov	edi, eax
		cmp	esi, ecx
		jz	short loc_10003B3C
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10003B3C:				; CODE XREF: sub_10003A00+131j
		mov	ecx, [esp+47Ch+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 46Ch
		retn
sub_10003A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003B60(int,	int, int, size_t Size, int, int, int, int, int,	int, int, int, int, int)
sub_10003B60	proc near		; CODE XREF: sub_1000AE00+2ACp

var_478		= dword	ptr -478h
var_474		= dword	ptr -474h
var_470		= dword	ptr -470h
var_46C		= dword	ptr -46Ch
var_468		= dword	ptr -468h
var_464		= dword	ptr -464h
var_460		= dword	ptr -460h
var_45C		= dword	ptr -45Ch
var_458		= dword	ptr -458h
var_454		= dword	ptr -454h
Src		= dword	ptr -450h
var_448		= byte ptr -448h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch
arg_2C		= dword	ptr  30h
arg_30		= dword	ptr  34h
arg_34		= dword	ptr  38h

		sub	esp, 478h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+478h+var_4], eax
		mov	ecx, [esp+478h+arg_8]
		mov	eax, [esp+478h+arg_4]
		mov	edx, [esp+478h+arg_10]
		mov	[esp+478h+Src],	ecx
		mov	ecx, [esp+478h+arg_1C]
		mov	[esp+478h+var_454], eax
		mov	eax, [esp+478h+arg_14]
		mov	[esp+478h+var_460], ecx
		mov	ecx, [esp+478h+arg_24]
		mov	[esp+478h+var_468], eax
		mov	eax, [esp+478h+arg_18]
		push	ebx
		mov	ebx, [esp+47Ch+Size]
		mov	[esp+47Ch+var_46C], edx
		mov	edx, [esp+47Ch+arg_20]
		mov	[esp+47Ch+var_458], ecx
		add	ecx, eax
		mov	[esp+47Ch+var_464], eax
		lea	eax, [ecx+ebx+46h]
		mov	[esp+47Ch+var_45C], edx
		mov	edx, [esp+47Ch+arg_30]
		push	ebp
		mov	[esp+480h+var_474], edx
		mov	[esp+480h+var_470], eax
		cmp	eax, 444h
		ja	short loc_10003BFB
		lea	ebp, [esp+480h+var_448]
		mov	[esp+480h+var_478], ebp
		jmp	short loc_10003C28
; ---------------------------------------------------------------------------

loc_10003BFB:				; CODE XREF: sub_10003B60+8Fj
		push	eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+480h+var_478], eax
		test	eax, eax
		jnz	short loc_10003C26
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+478h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 478h
		retn
; ---------------------------------------------------------------------------

loc_10003C26:				; CODE XREF: sub_10003B60+AAj
		mov	ebp, eax

loc_10003C28:				; CODE XREF: sub_10003B60+99j
		push	esi
		mov	esi, [esp+484h+arg_28]
		push	edi
		mov	edi, ebp
		mov	ecx, 8
		rep movsd
		mov	esi, [esp+488h+arg_2C]
		lea	edi, [ebp+20h]
		mov	ecx, 8
		rep movsd
		mov	ecx, [esp+488h+Src]
		mov	eax, ebx
		shr	eax, 8
		push	ebx		; Size
		mov	[ebp+40h], al
		mov	[ebp+41h], bl
		push	ecx		; Src
		add	ebp, 42h
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+494h+var_468]
		add	ebp, ebx
		mov	ebx, [esp+494h+var_464]
		mov	edx, ebx
		shr	edx, 8
		push	ebx		; Size
		mov	[ebp+0], dl
		mov	[ebp+1], bl
		push	eax		; Src
		add	ebp, 2
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+4A0h+var_458]
		mov	edx, [esp+4A0h+var_45C]
		mov	ecx, eax
		add	ebp, ebx
		shr	ecx, 8
		push	eax		; Size
		mov	[ebp+0], cl
		mov	[ebp+1], al
		push	edx		; Src
		add	ebp, 2
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+4ACh+arg_34]
		mov	ecx, [esp+4ACh+var_474]
		mov	edx, [esp+4ACh+var_470]
		mov	esi, [esp+4ACh+var_478]
		push	eax
		mov	eax, [esp+4B0h+arg_0]
		push	ecx
		push	edx
		push	esi
		push	eax
		call	sub_10003800
		lea	ecx, [esp+4C0h+var_448]
		add	esp, 38h
		mov	edi, eax
		cmp	esi, ecx
		jz	short loc_10003CDF
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_10003CDF:				; CODE XREF: sub_10003B60+174j
		mov	ecx, [esp+488h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 478h
		retn
sub_10003B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003D00	proc near		; CODE XREF: .text:1000245Dp
					; sub_10002470+18p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+1Ch]
		push	edi
		xor	ebx, ebx
		xor	edi, edi
		cmp	[esi+40h], edi
		setz	bl
		cmp	eax, edi
		jz	short loc_10003D32
		mov	ecx, [esi+20h]
		push	ebx
		push	ecx
		call	eax
		mov	edx, [esi+24h]
		mov	eax, [esi+1Ch]
		push	ebx
		push	edx
		call	eax
		add	esp, 10h
		mov	[esi+20h], edi
		mov	[esi+24h], edi

loc_10003D32:				; CODE XREF: sub_10003D00+16j
		mov	eax, [esi+30h]
		cmp	eax, edi
		jz	short loc_10003D4B
		mov	ecx, [esi+34h]
		cmp	ecx, edi
		jz	short loc_10003D4B
		push	1
		push	ecx
		call	eax
		add	esp, 8
		mov	[esi+34h], edi

loc_10003D4B:				; CODE XREF: sub_10003D00+37j
					; sub_10003D00+3Ej
		mov	ecx, [esi+38h]
		cmp	ecx, edi
		jz	short loc_10003D64
		mov	eax, [esi+3Ch]
		cmp	eax, edi
		jz	short loc_10003D64
		push	1
		push	eax
		call	ecx
		add	esp, 8
		mov	[esi+3Ch], edi

loc_10003D64:				; CODE XREF: sub_10003D00+50j
					; sub_10003D00+57j
		cmp	[esp+0Ch+arg_4], edi
		jz	short loc_10003D82
		cmp	[esi+1208h], edi
		jz	short loc_10003D82
		lea	ecx, [esi+1204h]
		push	edi
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10003D82:				; CODE XREF: sub_10003D00+68j
					; sub_10003D00+70j
		mov	eax, [esi+44h]
		cmp	eax, edi
		jz	short loc_10003D95
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	[esi+44h], edi

loc_10003D95:				; CODE XREF: sub_10003D00+87j
		mov	[esi+1134h], edi
		mov	[esi+1138h], edi
		mov	eax, [esi+60h]
		cmp	eax, edi
		jz	short loc_10003DB4
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	[esi+60h], edi

loc_10003DB4:				; CODE XREF: sub_10003D00+A6j
		mov	eax, [esi+64h]
		cmp	eax, edi
		jz	short loc_10003DC7
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	[esi+64h], edi

loc_10003DC7:				; CODE XREF: sub_10003D00+B9j
		mov	eax, [esi+68h]
		cmp	eax, edi
		jz	short loc_10003DDC
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[esi+68h], edi

loc_10003DDC:				; CODE XREF: sub_10003D00+CCj
		mov	eax, [esi+8C8h]
		cmp	eax, edi
		jz	short loc_10003DF5
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	[esi+8C8h], edi

loc_10003DF5:				; CODE XREF: sub_10003D00+E4j
		mov	eax, [esi+8CCh]
		cmp	eax, edi
		jz	short loc_10003E0E
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	[esi+8CCh], edi

loc_10003E0E:				; CODE XREF: sub_10003D00+FDj
		mov	eax, [esi+8D0h]
		cmp	eax, edi
		jz	short loc_10003E29
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[esi+8D0h], edi

loc_10003E29:				; CODE XREF: sub_10003D00+116j
		mov	[esi+40h], edi
		mov	[esi+1Ch], edi
		mov	[esi+30h], edi
		mov	[esi+38h], edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10003D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003E40	proc near		; CODE XREF: sub_1000A6D0+3CDp
					; sub_1000B7E0:loc_1000B9DDp
		test	byte ptr [esi+16h], 1
		push	ebx
		push	ebp
		movzx	ebp, word ptr [esi+80Ch]
		push	edi
		jnz	short loc_10003E5F
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_10003E5F:				; CODE XREF: sub_10003E40+Ej
		mov	ecx, [esi+450h]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx], 0
		mov	eax, [esi+454h]
		jnz	short loc_10003E7B
		mov	dx, [esi+44h]
		mov	[ecx+58h], dx

loc_10003E7B:				; CODE XREF: sub_10003E40+31j
		movzx	ecx, word ptr [esi+44h]
		mov	edx, 300h
		cmp	dx, cx
		sbb	ebx, ebx
		mov	[eax+58h], cx
		neg	ebx
		xor	edi, edi
		mov	ecx, offset dword_1002AA18

loc_10003E96:				; CODE XREF: sub_10003E40+65j
		cmp	[ecx], bp
		jz	short loc_10003EB6
		add	ecx, 10h
		inc	edi
		cmp	ecx, offset dword_1002ADF8
		jl	short loc_10003E96
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	short loc_10003EC3
; ---------------------------------------------------------------------------

loc_10003EB6:				; CODE XREF: sub_10003E40+59j
		shl	edi, 4
		add	edi, offset dword_1002AA18
		test	edi, edi
		jnz	short loc_10003EDF

loc_10003EC3:				; CODE XREF: sub_10003E40+74j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10003ED8
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10003ED8:				; CODE XREF: sub_10003E40+87j
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10003EDF:				; CODE XREF: sub_10003E40+81j
		mov	ecx, [edi+8]
		mov	edx, [edi+4]
		mov	ebp, [edi+0Ch]
		cmp	ecx, 2
		jg	short loc_10003EF8
		test	ecx, ecx
		jz	short loc_10003EF8
		test	ebx, ebx
		jz	short loc_10003EF8
		add	ecx, 2

loc_10003EF8:				; CODE XREF: sub_10003E40+ABj
					; sub_10003E40+AFj ...
		mov	[esi+810h], edi
		shl	ecx, 4
		add	ecx, offset dword_1002AE50
		lea	edi, [ebp+ebp*2+0]
		lea	edi, dword_1002A838[edi*8]
		mov	[esi+808h], edi
		mov	[eax+4], ecx
		lea	edi, [edx+edx*8]
		lea	edi, dword_1002A5D0[edi*4]
		mov	[eax], edi
		mov	ecx, [edi+8]
		add	ecx, ecx
		add	ecx, ecx
		add	ecx, ecx
		mov	[esi+60h], ecx
		mov	ecx, [eax]
		mov	ecx, [ecx+0Ch]
		add	ecx, ecx
		mov	[esi+5Ch], edx
		add	ecx, ecx
		add	ecx, ecx
		mov	[esi+64h], ecx
		mov	edx, [eax+4]
		xor	ecx, ecx
		mov	[eax+20h], ecx
		mov	[eax+24h], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	edx, [esi+814h]
		mov	[eax+8], edx
		mov	[eax+34h], ecx
		mov	[eax+3Ch], ecx
		test	byte ptr [esi+16h], 1
		jnz	short loc_10003F79
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10003F79:				; CODE XREF: sub_10003E40+128j
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10003E40	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10003F80:				; DATA XREF: sub_10004090+29o
		mov	eax, [esp+18h]
		test	eax, eax
		jnz	short loc_10003F95
		mov	eax, [esp+0Ch]
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003F95:				; CODE XREF: .text:10003F86j
		mov	ecx, [esp+14h]
		mov	edx, [esp+8]
		push	esi
		mov	esi, [esp+8]
		push	edi
		mov	edi, [esp+18h]
		push	2
		push	esi
		mov	[esi], ecx
		mov	[esi+4], eax
		mov	[esi+0Ch], edx
		mov	[esi+10h], edi
		call	sub_100240F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003FC8
		mov	esi, [esi+10h]
		test	esi, esi
		jnz	short loc_10003FCE

loc_10003FC8:				; CODE XREF: .text:10003FBFj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003FCE:				; CODE XREF: .text:10003FC6j
		mov	eax, [esp+14h]
		sub	edi, esi
		mov	[eax], edi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10003FE0:				; DATA XREF: sub_10004090+30o
		mov	eax, [esp+18h]
		test	eax, eax
		jnz	short loc_10003FF5
		mov	eax, [esp+0Ch]
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003FF5:				; CODE XREF: .text:10003FE6j
		mov	ecx, [esp+14h]
		mov	edx, [esp+8]
		push	esi
		mov	esi, [esp+8]
		push	edi
		mov	edi, [esp+18h]
		push	2
		push	esi
		mov	[esi], ecx
		mov	[esi+4], eax
		mov	[esi+0Ch], edx
		mov	[esi+10h], edi
		call	sub_10024E50
		add	esp, 8
		test	eax, eax
		jz	short loc_10004034
		push	0FFFFD06Fh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004034:				; CODE XREF: .text:1000401Fj
		sub	edi, [esi+10h]
		mov	eax, [esp+14h]
		mov	[eax], edi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10004050:				; DATA XREF: sub_10004090+53o
		push	esi
		mov	esi, [esp+8]
		push	esi
		call	sub_10022E60
		push	esi
		call	PORT_Free_Util
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10004070:				; DATA XREF: sub_10004090+5Ao
		push	esi
		mov	esi, [esp+8]
		push	esi
		call	sub_10026430
		push	esi
		call	PORT_Free_Util
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004090	proc near		; CODE XREF: sub_100044F0+2C7p
					; sub_10007A40+41p ...
		push	esi
		mov	esi, eax
		mov	eax, [esi+8]
		push	edi
		xor	edi, edi
		sub	eax, edi
		jz	loc_10004128
		dec	eax
		jz	short loc_100040B7
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100040B7:				; CODE XREF: sub_10004090+12j
		push	38h
		mov	dword ptr [esi+28h], offset loc_10003F80
		mov	dword ptr [esi+2Ch], offset loc_10003FE0
		call	PORT_Alloc_Util
		push	38h
		mov	[esi+34h], eax
		call	PORT_Alloc_Util
		push	38h
		mov	[esi+3Ch], eax
		mov	eax, [esi+34h]
		push	offset a1_2_5	; "1.2.5"
		mov	dword ptr [esi+30h], offset loc_10004050
		mov	dword ptr [esi+38h], offset loc_10004070
		push	0FFFFFFFFh
		push	eax
		mov	[eax+20h], edi
		mov	[eax+24h], edi
		mov	[eax+28h], edi
		call	sub_10024B50
		mov	esi, [esi+3Ch]
		push	38h
		push	offset a1_2_5	; "1.2.5"
		push	esi
		mov	[esi+20h], edi
		mov	[esi+24h], edi
		mov	[esi+28h], edi
		mov	[esi], edi
		mov	[esi+4], edi
		call	sub_10024D40
		add	esp, 24h
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004128:				; CODE XREF: sub_10004090+Bj
		mov	[esi+28h], edi
		mov	[esi+2Ch], edi
		mov	[esi+34h], edi
		mov	[esi+3Ch], edi
		mov	[esi+30h], edi
		mov	[esi+38h], edi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10004090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004140	proc near		; CODE XREF: sub_100044F0+11Ap
					; sub_100044F0+1C8p

arg_0		= dword	ptr  4

		push	eax
		push	esi
		call	PK11_ParamFromIV
		add	esp, 8
		test	eax, eax
		jz	short locret_10004171
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_10004171
		cmp	dword ptr [eax+8], 4
		jb	short locret_10004171
		cmp	esi, 100h
		jb	short locret_10004171
		cmp	esi, 105h
		ja	short locret_10004171
		mov	edx, [esp+arg_0]
		mov	[ecx], edx

locret_10004171:			; CODE XREF: sub_10004140+Cj
					; sub_10004140+13j ...
		retn
sub_10004140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004180	proc near		; CODE XREF: sub_10004CF0+181p
					; sub_1000F790+3A4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_0]
		mov	edx, eax
		shr	edx, 18h
		mov	[esi], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esi+1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esi+2], dl
		mov	[esi+3], al
		mov	eax, [esp+arg_4]
		mov	edx, eax
		shr	edx, 18h
		mov	[esi+4], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[esi+5], dl
		mov	edx, eax
		shr	edx, 8
		cmp	[esp+arg_C], 0
		mov	[esi+7], al
		mov	al, [esp+arg_8]
		mov	[esi+6], dl
		mov	[esi+8], al
		jnz	short loc_100041DC
		mov	ecx, ebx
		shr	ecx, 8
		mov	[esi+9], cl
		mov	[esi+0Ah], bl
		mov	eax, 0Bh
		retn
; ---------------------------------------------------------------------------

loc_100041DC:				; CODE XREF: sub_10004180+49j
		cmp	[esp+arg_10], 0
		jz	short loc_1000420B
		push	ecx
		call	sub_10002170
		movzx	eax, ax
		mov	edx, eax
		shr	edx, 8
		mov	ecx, ebx
		add	esp, 4
		shr	ecx, 8
		mov	[esi+0Ah], al
		mov	[esi+9], dl
		mov	[esi+0Bh], cl
		mov	[esi+0Ch], bl
		mov	eax, 0Dh
		retn
; ---------------------------------------------------------------------------

loc_1000420B:				; CODE XREF: sub_10004180+61j
		mov	eax, ecx
		mov	[esi+0Ah], cl
		shr	eax, 8
		mov	ecx, ebx
		shr	ecx, 8
		mov	[esi+9], al
		mov	[esi+0Bh], cl
		mov	[esi+0Ch], bl
		mov	eax, 0Dh
		retn
sub_10004180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004230	proc near		; DATA XREF: sub_100044F0+43o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		cmp	[esp+38h+arg_4], 0
		mov	eax, [esp+38h+arg_8]
		mov	ecx, [esp+38h+arg_14]
		mov	edx, [esp+38h+arg_1C]
		push	ebx
		push	ebp
		mov	ebp, [esp+40h+arg_C]
		push	esi
		push	edi
		mov	edi, [esp+48h+arg_0]
		mov	esi, [edi+30h]
		mov	[esp+48h+var_34], ebp
		mov	[esp+48h+var_10], esi
		jz	short loc_1000428C
		mov	esi, [ecx]
		mov	ebx, [esp+48h+arg_18]
		mov	[esp+48h+var_C], esi
		mov	esi, [ecx+4]
		mov	[esp+48h+var_8], esi
		mov	esi, [esp+48h+arg_10]
		add	ecx, 8
		sub	ebx, 8
		mov	dword ptr [ebp+0], 0
		jmp	short loc_100042E0
; ---------------------------------------------------------------------------

loc_1000428C:				; CODE XREF: sub_10004230+36j
		mov	esi, [esp+48h+arg_10]
		cmp	esi, 8
		jge	short loc_100042B8
		push	0FFFFE004h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_100042B8:				; CODE XREF: sub_10004230+63j
		mov	ebx, [edx]
		mov	[esp+48h+var_C], ebx
		mov	ebx, [edx+4]
		mov	[esp+48h+var_8], ebx
		mov	ebx, [edx]
		mov	[eax], ebx
		mov	ebx, [edx+4]
		mov	[eax+4], ebx
		mov	ebx, [esp+48h+arg_18]
		add	eax, 8
		sub	esi, 8
		mov	dword ptr [ebp+0], 8

loc_100042E0:				; CODE XREF: sub_10004230+5Aj
		cmp	[esp+48h+arg_4], 0
		push	ebx
		push	ecx
		push	esi
		mov	[esp+54h+var_1C], edx
		mov	edx, [esp+54h+arg_20]
		lea	ecx, [esp+54h+var_38]
		push	ecx
		push	eax
		mov	eax, [edi]
		mov	[esp+5Ch+var_18], edx
		lea	ebp, [esp+5Ch+var_24]
		lea	edx, [esp+5Ch+var_30]
		push	edx
		mov	[esp+60h+var_2C], ebp
		lea	ebp, [esp+60h+var_10]
		push	1087h
		mov	[esp+64h+var_30], 0
		mov	[esp+64h+var_28], 14h
		mov	[esp+64h+var_24], ebp
		mov	[esp+64h+var_20], 0Ch
		mov	[esp+64h+var_14], 80h
		push	eax
		jz	short loc_10004340
		call	PK11_Decrypt
		jmp	short loc_10004345
; ---------------------------------------------------------------------------

loc_10004340:				; CODE XREF: sub_10004230+107j
		call	PK11_Encrypt

loc_10004345:				; CODE XREF: sub_10004230+10Ej
		mov	ecx, [esp+68h+var_34]
		mov	edx, [esp+68h+var_38]
		add	[ecx], edx
		mov	ecx, [esp+68h+var_4]
		add	esp, 20h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_10004230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004370	proc near		; DATA XREF: sub_10007A40+3Ao

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	ecx, [esp+2Ch+arg_0]
		cmp	dword ptr [ecx+20h], 4
		mov	eax, [esp+2Ch+arg_1C]
		push	ebx
		mov	ebx, [esp+30h+arg_14]
		push	esi
		mov	esi, [esp+34h+arg_C]
		push	edi
		mov	edi, [esp+38h+arg_8]
		mov	[esp+38h+var_28], esi
		jz	short loc_100043C1
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100043C1:				; CODE XREF: sub_10004370+2Dj
		cmp	[esp+38h+arg_4], 0
		mov	edx, [ecx+1Ch]
		mov	edx, [edx]
		push	ebp
		mov	ebp, [esp+3Ch+arg_10]
		mov	[esp+3Ch+var_10], edx
		jz	short loc_100043F3
		mov	edx, [ebx]
		mov	[esp+3Ch+var_C], edx
		mov	edx, [ebx+4]
		add	ebx, 8
		sub	[esp+3Ch+arg_18], 8
		mov	[esp+3Ch+var_8], edx
		mov	dword ptr [esi], 0
		jmp	short loc_1000443E
; ---------------------------------------------------------------------------

loc_100043F3:				; CODE XREF: sub_10004370+64j
		cmp	ebp, 8
		jge	short loc_1000441B
		push	0FFFFE004h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1000441B:				; CODE XREF: sub_10004370+86j
		mov	edx, [eax]
		mov	[esp+3Ch+var_C], edx
		mov	edx, [eax+4]
		mov	[esp+3Ch+var_8], edx
		mov	edx, [eax]
		mov	[edi], edx
		mov	edx, [eax+4]
		mov	[edi+4], edx
		add	edi, 8
		sub	ebp, 8
		mov	dword ptr [esi], 8

loc_1000443E:				; CODE XREF: sub_10004370+81j
		lea	edx, [esp+3Ch+var_10]
		mov	[esp+3Ch+var_24], edx
		xor	edx, edx
		cmp	[esp+3Ch+arg_4], edx
		push	10h
		setz	dl
		mov	[esp+40h+var_1C], eax
		mov	eax, [esp+40h+arg_20]
		mov	[esp+40h+var_18], eax
		lea	eax, [esp+40h+var_24]
		lea	esi, [ecx+48h]
		mov	[esp+40h+var_20], 0Ch
		push	edx
		mov	edx, [ecx+14h]
		push	4
		push	eax
		mov	eax, [ecx+10h]
		push	edx
		push	eax
		push	esi
		mov	[esp+58h+var_14], 80h
		call	sub_10022950
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_100044D7
		cmp	[esp+3Ch+arg_4], eax
		jz	short loc_100044A8
		mov	ecx, [esp+3Ch+arg_18]
		push	ecx
		push	ebx
		push	ebp
		lea	edx, [esp+48h+var_2C]
		push	edx
		push	edi
		push	esi
		call	sub_100225E0
		jmp	short loc_100044BB
; ---------------------------------------------------------------------------

loc_100044A8:				; CODE XREF: sub_10004370+121j
		mov	eax, [esp+3Ch+arg_18]
		push	eax
		push	ebx
		push	ebp
		lea	ecx, [esp+48h+var_2C]
		push	ecx
		push	edi
		push	esi
		call	sub_100225A0

loc_100044BB:				; CODE XREF: sub_10004370+136j
		add	esp, 18h
		push	0
		push	esi
		mov	edi, eax
		call	sub_10022570
		mov	eax, [esp+44h+var_28]
		mov	edx, [esp+44h+var_2C]
		add	esp, 8
		add	[eax], edx
		mov	eax, edi

loc_100044D7:				; CODE XREF: sub_10004370+11Bj
		mov	ecx, [esp+3Ch+var_4]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10004370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100044F0	proc near		; CODE XREF: sub_100087C0+D8p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
Size		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, [esp+24h+arg_0]
		push	ebx
		push	ebp
		push	edi
		mov	edi, [eax+454h]
		mov	ebx, [edi]
		mov	ecx, [edi+0Ch]
		mov	[esp+30h+var_20], ecx
		mov	eax, [ebx+4]
		xor	ebp, ebp
		mov	[esp+30h+var_1C], ebx
		mov	[esp+30h+var_24], eax
		mov	[edi+68h], ebp
		mov	[edi+8D0h], ebp
		cmp	eax, 0Ah
		jnz	short loc_10004543
		mov	[edi+10h], ebp
		mov	[edi+14h], ebp
		mov	[edi+1Ch], ebp
		mov	[edi+20h], ebp
		mov	[edi+24h], ebp
		mov	dword ptr [edi+18h], offset sub_10004230
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10004543:				; CODE XREF: sub_100044F0+32j
		mov	edx, [edi+4]
		push	esi
		mov	esi, [edx+4]
		lea	eax, [esp+34h+var_20]
		lea	ecx, [esp+34h+var_C]
		push	ecx
		mov	[esp+38h+var_8], eax
		mov	[esp+38h+var_4], 4
		mov	[esp+38h+var_C], ebp
		mov	edx, [edi+64h]
		push	edx
		push	108h
		push	esi
		call	PK11_CreateContextBySymKey
		add	esp, 10h
		mov	[edi+68h], eax
		cmp	eax, ebp
		jnz	short loc_1000458E
		push	0FFFFD04Ch
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10004746
; ---------------------------------------------------------------------------

loc_1000458E:				; CODE XREF: sub_100044F0+8Aj
		mov	ecx, [edi+8CCh]
		lea	eax, [esp+34h+var_C]
		push	eax
		push	ecx
		push	108h
		push	esi
		call	PK11_CreateContextBySymKey
		add	esp, 10h
		mov	[edi+8D0h], eax
		cmp	eax, ebp
		jnz	short loc_100045C4
		push	0FFFFD04Ch
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10004746
; ---------------------------------------------------------------------------

loc_100045C4:				; CODE XREF: sub_100044F0+C0j
		mov	eax, [esp+34h+var_24]
		cmp	eax, ebp
		jnz	short loc_100045E4
		mov	eax, offset loc_100033F0
		pop	esi
		mov	[edi+10h], eax
		mov	[edi+14h], eax
		mov	[edi+1Ch], ebp
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100045E4:				; CODE XREF: sub_100044F0+DAj
		mov	ebp, [ebx+8]
		mov	esi, ds:dword_1002ADFC[eax*8]
		add	ebp, ebp
		lea	eax, [edi+8F8h]
		add	ebp, ebp
		mov	[esp+34h+var_14], eax
		mov	edx, [ebx+14h]
		add	ebp, ebp
		push	ebp
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+Size],	edx
		call	sub_10004140
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000462A
		push	0FFFFD04Fh
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10004744
; ---------------------------------------------------------------------------

loc_1000462A:				; CODE XREF: sub_100044F0+126j
		mov	ecx, [esp+34h+arg_0]
		mov	edx, [ecx+4Ch]
		mov	eax, [edi+8C8h]
		neg	edx
		push	ebx
		sbb	edx, edx
		push	eax
		add	edx, 105h
		push	edx
		push	esi
		call	PK11_CreateContextBySymKey
		mov	[esp+44h+var_24], eax
		lea	eax, [esp+44h+Size]
		push	eax
		push	ebx
		push	esi
		call	PK11_IVFromParam
		add	esp, 1Ch
		mov	[esp+34h+var_14], eax
		test	eax, eax
		jz	short loc_1000467A
		mov	ecx, [esp+34h+Size]
		push	ecx		; Size
		push	eax		; Src
		lea	eax, [edi+8F8h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000467A:				; CODE XREF: sub_100044F0+173j
		push	1
		push	ebx
		call	SECITEM_FreeItem_Util
		add	esp, 8
		cmp	[esp+34h+var_24], 0
		jnz	short loc_1000469E
		push	0FFFFD04Ch
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10004744
; ---------------------------------------------------------------------------

loc_1000469E:				; CODE XREF: sub_100044F0+19Aj
		mov	edx, [esp+34h+var_1C]
		lea	ebx, [edi+90h]
		mov	[esp+34h+var_14], ebx
		mov	eax, [edx+14h]
		mov	[esp+34h+Size],	eax
		push	ebp
		lea	eax, [esp+38h+var_18]
		call	sub_10004140
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_100046CD
		push	0FFFFD04Fh
		jmp	short loc_1000472D
; ---------------------------------------------------------------------------

loc_100046CD:				; CODE XREF: sub_100044F0+1D4j
		mov	eax, [esp+34h+arg_0]
		mov	ecx, [edi+60h]
		xor	edx, edx
		cmp	[eax+4Ch], edx
		push	ebp
		setnz	dl
		push	ecx
		add	edx, 104h
		push	edx
		push	esi
		call	PK11_CreateContextBySymKey
		lea	ecx, [esp+44h+Size]
		push	ecx
		push	ebp
		push	esi
		mov	[esp+50h+var_1C], eax
		call	PK11_IVFromParam
		add	esp, 1Ch
		mov	[esp+34h+var_14], eax
		test	eax, eax
		jz	short loc_10004715
		mov	edx, [esp+34h+Size]
		push	edx		; Size
		push	eax		; Src
		push	ebx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10004715:				; CODE XREF: sub_100044F0+214j
		push	1
		push	ebp
		call	SECITEM_FreeItem_Util
		mov	edx, [esp+3Ch+var_1C]
		add	esp, 8
		test	edx, edx
		jnz	short loc_10004781
		push	0FFFFD04Ch

loc_1000472D:				; CODE XREF: sub_100044F0+1DBj
		call	sub_100147C0
		mov	eax, [esp+38h+var_24]
		add	esp, 4
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8

loc_10004744:				; CODE XREF: sub_100044F0+135j
					; sub_100044F0+1A9j
		xor	ebp, ebp

loc_10004746:				; CODE XREF: sub_100044F0+99j
					; sub_100044F0+CFj
		mov	eax, [edi+68h]
		cmp	eax, ebp
		jz	short loc_1000475B
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[edi+68h], ebp

loc_1000475B:				; CODE XREF: sub_100044F0+25Bj
		mov	eax, [edi+8D0h]
		cmp	eax, ebp
		jz	short loc_10004776
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[edi+8D0h], ebp

loc_10004776:				; CODE XREF: sub_100044F0+273j
		pop	esi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10004781:				; CODE XREF: sub_100044F0+236j
		mov	ecx, [esp+34h+arg_0]
		mov	eax, offset PK11_CipherOp
		mov	[edi+10h], eax
		mov	[edi+14h], eax
		mov	eax, [esp+34h+var_24]
		mov	dword ptr [edi+1Ch], offset PK11_DestroyContext
		cmp	dword ptr [ecx+4Ch], 0
		jnz	short loc_100047A3
		mov	eax, edx

loc_100047A3:				; CODE XREF: sub_100044F0+2AFj
		mov	[edi+20h], eax
		cmp	dword ptr [ecx+4Ch], 0
		mov	eax, edx
		jnz	short loc_100047B2
		mov	eax, [esp+34h+var_24]

loc_100047B2:				; CODE XREF: sub_100044F0+2BCj
		mov	[edi+24h], eax
		mov	eax, edi
		call	sub_10004090
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 24h
		retn
sub_100044F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100047D0	proc near		; CODE XREF: sub_10004B10+F4p
					; sub_10004CF0+239p ...

var_1EC		= dword	ptr -1ECh
var_1E8		= dword	ptr -1E8h
var_1E4		= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= byte ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D0		= dword	ptr -1D0h
var_1CC		= byte ptr -1CCh
var_48		= byte ptr -48h
var_3C		= byte ptr -3Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 1F0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1F0h+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F0h+var_1E8], eax
		mov	eax, [edi+4]
		mov	eax, [eax]
		mov	[esp+1F0h+var_1E0], ecx
		mov	ecx, [ebp+arg_10]
		push	ebx
		push	esi
		mov	[esp+1F8h+var_1EC], edx
		mov	[esp+1F8h+var_1E4], ecx
		test	eax, eax
		jnz	short loc_10004821
		mov	[ecx], eax
		pop	esi
		pop	ebx
		mov	ecx, [esp+1F0h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004821:				; CODE XREF: sub_100047D0+39j
		cmp	dword ptr [edi+40h], 0
		jz	loc_10004A74
		xor	ebx, ebx
		cmp	eax, 5		; switch 6 cases
		ja	short loc_10004873 ; jumptable 10004832	default	case
		jmp	ds:off_10004AF4[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10004839:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		mov	[ecx], ebx	; jumptable 10004832 case 0
		xor	eax, eax
		pop	esi
		pop	ebx
		mov	ecx, [esp+1F0h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004851:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		mov	ebx, 30h	; jumptable 10004832 case 1

loc_10004856:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		push	2		; jumptable 10004832 case 3
		jmp	short loc_10004865
; ---------------------------------------------------------------------------

loc_1000485A:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		mov	ebx, 28h	; jumptable 10004832 case 2

loc_1000485F:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		push	3		; jumptable 10004832 case 4
		jmp	short loc_10004865
; ---------------------------------------------------------------------------

loc_10004863:				; CODE XREF: sub_100047D0+62j
					; DATA XREF: .text:off_10004AF4o
		push	4		; jumptable 10004832 case 5

loc_10004865:				; CODE XREF: sub_100047D0+88j
					; sub_100047D0+91j
		call	sub_10022B60
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10004897

loc_10004873:				; CODE XREF: sub_100047D0+60j
		push	0FFFFE001h	; jumptable 10004832 default case
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ebx
		mov	ecx, [esp+1F0h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004897:				; CODE XREF: sub_100047D0+A1j
		mov	eax, 300h
		cmp	[edi+58h], ax
		ja	loc_100049DF
		mov	edx, [esi+10h]
		lea	ecx, [esp+1F8h+var_1D8]
		push	ecx
		call	edx
		add	esp, 4
		cmp	[ebp+arg_0], 0
		jz	short loc_100048D3
		mov	eax, [edi+8F4h]
		mov	ecx, [edi+8F0h]
		push	eax
		mov	eax, [esi+14h]
		push	ecx
		lea	edx, [esp+200h+var_1D8]
		push	edx
		call	eax
		jmp	short loc_100048EB
; ---------------------------------------------------------------------------

loc_100048D3:				; CODE XREF: sub_100047D0+E7j
		mov	ecx, [edi+8Ch]
		mov	edx, [edi+88h]
		push	ecx
		mov	ecx, [esi+14h]
		push	edx
		lea	eax, [esp+200h+var_1D8]
		push	eax
		call	ecx

loc_100048EB:				; CODE XREF: sub_100047D0+101j
		mov	eax, [esi+14h]
		add	esp, 0Ch
		push	ebx
		lea	edx, [esp+1FCh+var_1D8]
		push	offset a66666666666666 ; "666666666666666666666666666666666666666"...
		push	edx
		call	eax
		mov	ecx, [ebp+arg_8]
		mov	edx, [esp+204h+var_1E8]
		push	ecx
		mov	ecx, [esi+14h]
		push	edx
		lea	eax, [esp+20Ch+var_1D8]
		push	eax
		call	ecx
		mov	edx, [ebp+arg_C]
		mov	eax, [esp+210h+var_1E0]
		push	edx
		mov	edx, [esi+14h]
		push	eax
		lea	ecx, [esp+218h+var_1D8]
		push	ecx
		call	edx
		push	40h
		lea	eax, [esp+220h+var_1DC]
		push	eax
		mov	eax, [esi+18h]
		lea	ecx, [esp+224h+var_48]
		push	ecx
		lea	edx, [esp+228h+var_1D8]
		push	edx
		call	eax
		mov	edx, [esi+10h]
		lea	ecx, [esp+22Ch+var_1D8]
		push	ecx
		call	edx
		add	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_1000496A
		mov	eax, [edi+8F4h]
		mov	ecx, [edi+8F0h]
		push	eax
		mov	eax, [esi+14h]
		push	ecx
		lea	edx, [esp+200h+var_1D8]
		push	edx
		call	eax
		jmp	short loc_10004982
; ---------------------------------------------------------------------------

loc_1000496A:				; CODE XREF: sub_100047D0+17Ej
		mov	ecx, [edi+8Ch]
		mov	edx, [edi+88h]
		push	ecx
		mov	ecx, [esi+14h]
		push	edx
		lea	eax, [esp+200h+var_1D8]
		push	eax
		call	ecx

loc_10004982:				; CODE XREF: sub_100047D0+198j
		mov	eax, [esi+14h]
		add	esp, 0Ch
		push	ebx
		lea	edx, [esp+1F0h+var_1CC]
		push	(offset	a66666666666666+3Ch) ; "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"...
		push	edx
		call	eax
		mov	ecx, [esp+1F8h+var_1D0]
		push	ecx
		mov	ecx, [esi+14h]
		lea	edx, [esp+1FCh+var_3C]
		push	edx
		lea	eax, [esp+200h+var_1CC]
		push	eax
		call	ecx
		mov	edx, [edi+0Ch]
		mov	eax, [esp+204h+var_1D8]
		mov	ecx, [esp+204h+var_1E0]
		push	edx
		push	eax
		mov	eax, [esi+18h]
		push	ecx
		lea	edx, [esp+210h+var_1CC]
		push	edx
		call	eax
		add	esp, 28h
		xor	esi, esi
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	ecx, [esp+1E4h+arg_0]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100049DF:				; CODE XREF: sub_100047D0+D0j
		cmp	[ebp+arg_0], 0
		push	0
		lea	eax, [esp+1FCh+var_1D8]
		jz	short loc_100049F9
		mov	ecx, [edi+8F4h]
		mov	edx, [edi+8F0h]
		jmp	short loc_10004A05
; ---------------------------------------------------------------------------

loc_100049F9:				; CODE XREF: sub_100047D0+219j
		mov	ecx, [edi+8Ch]
		mov	edx, [edi+88h]

loc_10004A05:				; CODE XREF: sub_100047D0+227j
		push	ecx
		push	edx
		push	esi
		push	eax
		call	sub_10022BD0
		add	esp, 14h
		test	eax, eax
		jnz	loc_10004ACC
		lea	ecx, [esp+1F8h+var_1D8]
		push	ecx
		call	sub_10022C10
		mov	edx, [ebp+arg_8]
		mov	eax, [esp+1FCh+var_1E8]
		push	edx
		push	eax
		lea	ecx, [esp+204h+var_1D8]
		push	ecx
		call	sub_10022C40
		mov	edx, [ebp+arg_C]
		mov	eax, [esp+208h+var_1E0]
		push	edx
		push	eax
		lea	ecx, [esp+210h+var_1D8]
		push	ecx
		call	sub_10022C40
		mov	edx, [edi+0Ch]
		mov	eax, [esp+214h+var_1E4]
		mov	ecx, [esp+214h+var_1EC]
		push	edx
		push	eax
		push	ecx
		lea	edx, [esp+220h+var_1D8]
		push	edx
		call	sub_10022C70
		mov	esi, eax
		lea	eax, [esp+224h+var_1D8]
		push	0
		push	eax
		call	sub_10022BA0
		add	esp, 34h
		jmp	short loc_10004AC8
; ---------------------------------------------------------------------------

loc_10004A74:				; CODE XREF: sub_100047D0+55j
		cmp	[ebp+arg_0], 0
		jz	short loc_10004A82
		mov	ebx, [edi+8D0h]
		jmp	short loc_10004A85
; ---------------------------------------------------------------------------

loc_10004A82:				; CODE XREF: sub_100047D0+2A8j
		mov	ebx, [edi+68h]

loc_10004A85:				; CODE XREF: sub_100047D0+2B0j
		push	ebx
		call	PK11_DigestBegin
		mov	ecx, [ebp+arg_8]
		mov	edx, [esp+1FCh+var_1E8]
		push	ecx
		push	edx
		push	ebx
		mov	esi, eax
		call	PK11_DigestOp
		mov	ecx, [esp+208h+var_1E0]
		or	esi, eax
		mov	eax, [ebp+arg_C]
		push	eax
		push	ecx
		push	ebx
		call	PK11_DigestOp
		mov	edx, [edi+0Ch]
		mov	ecx, [esp+214h+var_1EC]
		push	edx
		or	esi, eax
		mov	eax, [esp+218h+var_1E4]
		push	eax
		push	ecx
		push	ebx
		call	PK11_DigestFinal
		add	esp, 2Ch
		or	esi, eax

loc_10004AC8:				; CODE XREF: sub_100047D0+2A2j
		test	esi, esi
		jz	short loc_10004ADC

loc_10004ACC:				; CODE XREF: sub_100047D0+243j
		push	0FFFFD04Bh
		or	esi, 0FFFFFFFFh
		call	sub_100147C0
		add	esp, 4

loc_10004ADC:				; CODE XREF: sub_100047D0+2FAj
		mov	ecx, [esp+1F8h+var_4]
		mov	eax, esi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100047D0	endp

; ---------------------------------------------------------------------------
		align 4
off_10004AF4	dd offset loc_10004839	; DATA XREF: sub_100047D0+62r
		dd offset loc_10004851	; jump table for switch	statement
		dd offset loc_1000485A
		dd offset loc_10004856
		dd offset loc_1000485F
		dd offset loc_10004863
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004B10	proc near		; CODE XREF: sub_1000F790+50Cp

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 34h
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+40h], 0
		mov	esi, eax
		jnz	loc_10004BE8
		mov	eax, [edi+4]
		cmp	dword ptr [eax], 0
		jnz	short loc_10004B39
		pop	edi
		mov	dword ptr [ebx], 0
		xor	eax, eax
		pop	esi
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_10004B39:				; CODE XREF: sub_10004B10+19j
		mov	edx, 300h
		mov	ecx, 0CE534363h
		cmp	[edi+58h], dx
		ja	short loc_10004B4E
		mov	ecx, 0CE534364h

loc_10004B4E:				; CODE XREF: sub_10004B10+37j
		cmp	[esp+3Ch+arg_0], 0
		mov	eax, [eax+4]
		mov	edx, [esp+3Ch+arg_10]
		mov	[esp+3Ch+var_10], eax
		mov	eax, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_C], edx
		mov	edx, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_8], eax
		mov	[esp+3Ch+var_4], edx
		mov	edx, [esp+3Ch+arg_C]
		lea	eax, [esp+3Ch+var_10]
		mov	[esp+3Ch+var_18], eax
		mov	eax, [esp+3Ch+arg_14]
		mov	[esp+3Ch+var_24], edx
		mov	edx, [ebx]
		mov	[esp+3Ch+var_30], eax
		mov	eax, [edi+8CCh]
		mov	[esp+3Ch+var_14], 10h
		mov	[esp+3Ch+var_1C], 0
		mov	[esp+3Ch+var_20], esi
		mov	[esp+3Ch+var_28], 0
		mov	[esp+3Ch+var_2C], edx
		mov	[esp+3Ch+var_34], 0
		jnz	short loc_10004BBF
		mov	eax, [edi+64h]

loc_10004BBF:				; CODE XREF: sub_10004B10+AAj
		lea	edx, [esp+3Ch+var_28]
		push	edx
		lea	edx, [esp+40h+var_34]
		push	edx
		lea	edx, [esp+44h+var_1C]
		push	edx
		push	ecx
		push	eax
		call	PK11_SignWithSymKey
		add	esp, 14h
		test	eax, eax
		jz	short loc_10004C2E
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE006h
		jnz	short loc_10004C12

loc_10004BE8:				; CODE XREF: sub_10004B10+Dj
		sub	esi, [edi+0Ch]
		mov	eax, [esp+3Ch+arg_8]
		mov	ecx, [esp+3Ch+arg_4]
		mov	edx, [esp+3Ch+arg_0]
		push	ebx
		push	esi
		push	eax
		push	ecx
		mov	ecx, [esp+4Ch+arg_C]
		push	edx
		mov	edx, [esp+50h+arg_14]
		call	sub_100047D0
		add	esp, 14h
		pop	edi
		pop	esi
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_10004C12:				; CODE XREF: sub_10004B10+D6j
		push	0FFFFD04Bh
		mov	dword ptr [ebx], 0
		call	sub_100147C0
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_10004C2E:				; CODE XREF: sub_10004B10+CAj
		mov	eax, [esp+3Ch+var_2C]
		pop	edi
		mov	[ebx], eax
		xor	eax, eax
		pop	esi
		add	esp, 34h
		retn
sub_10004B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004C40	proc near		; CODE XREF: sub_10007C90+3Dp
					; sub_10009320+19Ep ...
		push	ebx
		mov	ebx, 1
		test	edi, edi
		jz	loc_10004CE7
		cmp	byte ptr [edi+0DFh], 0
		jz	loc_10004CE7
		mov	eax, [edi+0D8h]
		mov	ecx, [edi+0D4h]
		push	esi
		push	eax
		push	ecx
		call	SECMOD_LookupSlot
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10004CD7
		push	esi
		call	PK11_IsPresent
		add	esp, 4
		test	eax, eax
		jz	short loc_10004CD7
		push	esi
		call	PK11_GetSlotSeries
		movzx	edx, word ptr [edi+0DCh]
		add	esp, 4
		cmp	edx, eax
		jnz	short loc_10004CD7
		push	esi
		call	PK11_GetSlotID
		add	esp, 4
		cmp	[edi+0D8h], eax
		jnz	short loc_10004CD7
		push	esi
		call	PK11_GetModuleID
		add	esp, 4
		cmp	[edi+0D4h], eax
		jnz	short loc_10004CD7
		push	esi
		call	PK11_NeedLogin
		add	esp, 4
		test	eax, eax
		jz	short loc_10004CD9
		push	0
		push	esi
		call	PK11_IsLoggedIn
		add	esp, 8
		test	eax, eax
		jnz	short loc_10004CD9

loc_10004CD7:				; CODE XREF: sub_10004C40+36j
					; sub_10004C40+43j ...
		xor	ebx, ebx

loc_10004CD9:				; CODE XREF: sub_10004C40+86j
					; sub_10004C40+95j
		test	esi, esi
		jz	short loc_10004CE6
		push	esi
		call	PK11_FreeSlot
		add	esp, 4

loc_10004CE6:				; CODE XREF: sub_10004C40+9Bj
		pop	esi

loc_10004CE7:				; CODE XREF: sub_10004C40+8j
					; sub_10004C40+15j
		mov	eax, ebx
		pop	ebx
		retn
sub_10004C40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004CF0	proc near		; CODE XREF: sub_10002340+69p
					; sub_10007C90+14Cp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		mov	eax, [esp+38h+arg_14]
		xor	ecx, ecx
		mov	[esp+38h+var_24], eax
		xor	eax, eax
		cmp	[esp+38h+arg_8], eax
		push	ebx
		mov	ebx, [esp+3Ch+arg_18]
		setnz	cl
		push	ebp
		mov	ebp, [esp+40h+arg_1C]
		push	esi
		push	edi
		mov	edi, [esp+48h+arg_0]
		mov	esi, [edi]
		lea	ecx, ds:5[ecx*8]
		movzx	ecx, cx
		mov	[esp+48h+var_1C], eax
		mov	[esp+48h+var_38], eax
		cmp	dword ptr [esi+10h], 1
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_2C], eax
		mov	[esp+48h+var_30], esi
		mov	[esp+48h+var_34], ecx
		jnz	loc_10004E04
		mov	edx, 302h
		cmp	[edi+58h], dx
		jb	loc_10004E04
		mov	esi, [esi+14h]
		movzx	eax, cx
		mov	ecx, [ebp+8]
		sub	ecx, eax
		mov	[esp+48h+var_2C], esi
		cmp	esi, ecx
		jbe	short loc_10004D94

loc_10004D71:				; CODE XREF: sub_10004CF0+1ABj
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10004D94:				; CODE XREF: sub_10004CF0+7Fj
		mov	edx, [ebp+0]
		add	edx, eax
		push	esi
		push	edx
		call	PK11_GenerateRandom
		add	esp, 8
		mov	[esp+48h+var_28], eax
		test	eax, eax
		jz	short loc_10004DCF
		push	0FFFFD041h
		call	sub_100147C0
		mov	eax, [esp+4Ch+var_28]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10004DCF:				; CODE XREF: sub_10004CF0+B9j
		movzx	eax, word ptr [esp+48h+var_34]
		add	eax, [ebp+0]
		mov	ecx, [edi+10h]
		push	esi
		push	eax
		push	esi
		lea	edx, [esp+54h+var_38]
		push	edx
		push	eax
		mov	eax, [edi+20h]
		push	eax
		call	ecx
		add	esp, 18h
		test	eax, eax
		jnz	loc_10004EE6
		cmp	[esp+48h+var_38], esi
		jnz	loc_10004EE6
		mov	ecx, [esp+48h+var_34]
		mov	eax, esi

loc_10004E04:				; CODE XREF: sub_10004CF0+59j
					; sub_10004CF0+68j
		mov	edx, [edi+28h]
		test	edx, edx
		jz	short loc_10004E4B
		movzx	esi, cx
		mov	ecx, [esp+48h+var_24]
		push	ebx
		push	ecx
		mov	ecx, [ebp+8]
		sub	ecx, esi
		sub	ecx, eax
		push	ecx
		lea	ecx, [esp+54h+var_18]
		push	ecx
		mov	ecx, [ebp+0]
		add	ecx, esi
		add	ecx, eax
		mov	eax, [edi+34h]
		push	ecx
		push	eax
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	loc_10005188
		mov	eax, [ebp+0]
		mov	ebx, [esp+48h+var_18]
		add	eax, esi
		add	eax, [esp+48h+var_2C]
		mov	[esp+48h+var_24], eax

loc_10004E4B:				; CODE XREF: sub_10004CF0+119j
		movzx	ecx, word ptr [edi+58h]
		mov	edx, [esp+48h+arg_8]
		push	edx
		mov	eax, 301h
		cmp	cx, ax
		mov	eax, [esp+4Ch+arg_10]
		sbb	edx, edx
		inc	edx
		push	edx
		mov	edx, [edi+4Ch]
		push	eax
		mov	eax, [edi+48h]
		push	edx
		push	eax
		lea	esi, [esp+5Ch+var_14]
		call	sub_10004180
		mov	edx, [esp+5Ch+var_30]
		movzx	esi, word ptr [esp+5Ch+var_34]
		add	esp, 14h
		cmp	dword ptr [edx+10h], 2
		mov	[esp+48h+var_28], eax
		jnz	short loc_10004F09
		mov	eax, [edx+20h]
		add	eax, [edx+1Ch]
		mov	ecx, [ebp+8]
		add	eax, esi
		add	eax, ebx
		cmp	eax, ecx
		ja	loc_10004D71
		cmp	[esp+48h+arg_4], 0
		mov	[esp+48h+var_38], ebx
		lea	eax, [edi+8C8h]
		jnz	short loc_10004EB5
		lea	eax, [edi+60h]

loc_10004EB5:				; CODE XREF: sub_10004CF0+1C0j
		mov	edx, [esp+48h+var_28]
		push	edx
		lea	edx, [esp+4Ch+var_14]
		push	edx
		mov	edx, [esp+50h+var_24]
		push	ebx
		push	edx
		mov	edx, [ebp+0]
		sub	ecx, esi
		push	ecx
		lea	ecx, [esp+5Ch+var_38]
		push	ecx
		add	edx, esi
		push	edx
		push	0
		push	eax
		mov	eax, [edi+18h]
		call	eax
		add	esp, 24h
		test	eax, eax
		jz	loc_10005091

loc_10004EE6:				; CODE XREF: sub_10004CF0+FEj
					; sub_10004CF0+108j ...
		push	0FFFFD046h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10004F09:				; CODE XREF: sub_10004CF0+19Aj
		mov	edx, [ebp+0]
		lea	ecx, [esp+48h+var_1C]
		push	ecx
		mov	ecx, [esp+4Ch+arg_4]
		push	ebx
		push	eax
		add	edx, esi
		lea	eax, [esp+54h+var_14]
		add	edx, ebx
		add	edx, [esp+54h+var_2C]
		push	eax
		push	ecx
		mov	ecx, [esp+5Ch+var_24]
		call	sub_100047D0
		add	esp, 14h
		test	eax, eax
		jz	short loc_10004F58
		push	0FFFFD04Bh
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10004F58:				; CODE XREF: sub_10004CF0+243j
		mov	eax, [esp+48h+var_1C]
		mov	ecx, [esp+48h+var_30]
		cmp	dword ptr [ecx+10h], 1
		lea	edx, [ebx+eax]
		mov	[esp+48h+var_34], eax
		mov	[esp+48h+var_28], edx
		jnz	short loc_10004FC2
		xor	edx, edx
		mov	eax, ebx
		div	dword ptr [ecx+18h]
		mov	eax, [ecx+18h]
		mov	ecx, [esp+48h+var_28]
		mov	[esp+48h+Size],	edx
		lea	edx, [eax-1]
		and	edx, ecx
		sub	eax, edx
		mov	edx, [ebp+0]
		dec	eax
		lea	ecx, [ecx+eax+1]
		add	edx, esi
		add	edx, ecx
		mov	[esp+48h+var_28], ecx
		mov	ecx, [esp+48h+var_2C]
		lea	edx, [edx+ecx-1]
		lea	ecx, [eax+1]
		test	ecx, ecx
		jle	short loc_10004FB8
		lea	esp, [esp+0]

loc_10004FB0:				; CODE XREF: sub_10004CF0+2C6j
		mov	[edx], al
		dec	ecx
		dec	edx
		test	ecx, ecx
		jg	short loc_10004FB0

loc_10004FB8:				; CODE XREF: sub_10004CF0+2B7j
		mov	eax, [esp+48h+var_28]
		sub	eax, ebx
		mov	[esp+48h+var_34], eax

loc_10004FC2:				; CODE XREF: sub_10004CF0+27Fj
		mov	eax, [esp+48h+Size]
		cmp	ebx, 100h
		jnb	short loc_10004FDA
		mov	[esp+48h+Size],	ebx
		mov	eax, [esp+48h+Size]
		xor	ebx, ebx
		jmp	short loc_10004FDC
; ---------------------------------------------------------------------------

loc_10004FDA:				; CODE XREF: sub_10004CF0+2DCj
		sub	ebx, eax

loc_10004FDC:				; CODE XREF: sub_10004CF0+2E8j
		test	eax, eax
		jz	short loc_10005001
		add	[esp+48h+var_34], eax
		mov	edx, [esp+48h+var_24]
		push	eax		; Size
		mov	eax, [ebp+0]
		add	eax, esi
		add	eax, ebx
		add	eax, [esp+4Ch+var_2C]
		add	edx, ebx
		push	edx		; Src
		push	eax		; Dst
		call	ds:memmove
		add	esp, 0Ch

loc_10005001:				; CODE XREF: sub_10004CF0+2EEj
		test	ebx, ebx
		jz	short loc_10005047
		mov	ecx, [esp+48h+var_24]
		mov	eax, [ebp+0]
		push	ebx
		push	ecx
		mov	ecx, [edi+20h]
		push	ebx
		add	eax, esi
		add	eax, [esp+54h+var_2C]
		lea	edx, [esp+54h+var_30]
		push	edx
		mov	edx, [edi+10h]
		push	eax
		push	ecx
		mov	[esp+60h+var_30], 0FFFFFFFFh
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	loc_10004EE6
		mov	eax, [esp+48h+var_30]
		cmp	eax, ebx
		jnz	loc_10004EE6
		add	[esp+48h+var_38], eax

loc_10005047:				; CODE XREF: sub_10004CF0+313j
		mov	ecx, [esp+48h+var_34]
		test	ecx, ecx
		jz	short loc_10005091
		mov	eax, [ebp+0]
		mov	edx, [edi+20h]
		add	eax, esi
		push	ecx
		add	eax, ebx
		add	eax, [esp+4Ch+var_2C]
		mov	[esp+4Ch+var_30], 0FFFFFFFFh
		push	eax
		push	ecx
		lea	ecx, [esp+54h+var_30]
		push	ecx
		push	eax
		mov	eax, [edi+10h]
		push	edx
		call	eax
		add	esp, 18h
		test	eax, eax
		jnz	loc_10004EE6
		mov	eax, [esp+48h+var_30]
		cmp	eax, [esp+48h+var_34]
		jnz	loc_10004EE6
		add	[esp+48h+var_38], eax

loc_10005091:				; CODE XREF: sub_10004CF0+1F0j
					; sub_10004CF0+35Dj
		add	esi, [esp+48h+var_38]
		cmp	[esp+48h+arg_8], 0
		mov	edx, [ebp+0]
		mov	al, byte ptr [esp+48h+arg_10]
		mov	[ebp+4], esi
		mov	[edx], al
		jz	loc_1000513A
		movzx	ecx, word ptr [edi+58h]
		push	ecx
		call	sub_10002170
		mov	ecx, [ebp+0]
		movzx	eax, ax
		mov	edx, eax
		shr	edx, 8
		mov	[ecx+1], dl
		mov	edx, [ebp+0]
		mov	[edx+2], al
		movzx	ecx, byte ptr [edi+4Bh]
		mov	eax, [ebp+0]
		mov	[eax+3], cl
		movzx	eax, byte ptr [edi+4Ah]
		mov	edx, [ebp+0]
		mov	[edx+4], al
		mov	ecx, [edi+48h]
		mov	edx, [ebp+0]
		shr	ecx, 8
		mov	[edx+5], cl
		movzx	ecx, byte ptr [edi+48h]
		mov	eax, [ebp+0]
		mov	[eax+6], cl
		movzx	eax, byte ptr [edi+4Fh]
		mov	edx, [ebp+0]
		mov	[edx+7], al
		mov	ecx, [ebp+0]
		mov	dl, [edi+4Eh]
		mov	[ecx+8], dl
		mov	eax, [edi+4Ch]
		mov	ecx, [ebp+0]
		shr	eax, 8
		mov	[ecx+9], al
		movzx	eax, byte ptr [edi+4Ch]
		mov	edx, [ebp+0]
		mov	[edx+0Ah], al
		mov	ecx, [esp+4Ch+var_38]
		mov	edx, [ebp+0]
		add	esp, 4
		shr	ecx, 8
		mov	[edx+0Bh], cl
		movzx	ecx, byte ptr [esp+48h+var_38]
		mov	eax, [ebp+0]
		mov	[eax+0Ch], cl
		jmp	short loc_10005179
; ---------------------------------------------------------------------------

loc_1000513A:				; CODE XREF: sub_10004CF0+3B6j
		cmp	[esp+48h+arg_C], 0
		movzx	eax, word ptr [edi+58h]
		jz	short loc_10005151
		mov	edx, 301h
		cmp	dx, ax
		jnb	short loc_10005151
		mov	eax, edx

loc_10005151:				; CODE XREF: sub_10004CF0+453j
					; sub_10004CF0+45Dj
		mov	edx, [ebp+0]
		mov	ecx, eax
		shr	ecx, 8
		mov	[edx+1], cl
		mov	ecx, [ebp+0]
		mov	[ecx+2], al
		mov	edx, [esp+48h+var_38]
		mov	eax, [ebp+0]
		shr	edx, 8
		mov	[eax+3], dl
		mov	ecx, [ebp+0]
		mov	dl, byte ptr [esp+48h+var_38]
		mov	[ecx+4], dl

loc_10005179:				; CODE XREF: sub_10004CF0+448j
		mov	eax, 1
		add	[edi+4Ch], eax
		jnz	short loc_10005186
		add	[edi+48h], eax

loc_10005186:				; CODE XREF: sub_10004CF0+491j
		xor	eax, eax

loc_10005188:				; CODE XREF: sub_10004CF0+144j
		mov	ecx, [esp+48h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_10004CF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100051A0	proc near		; CODE XREF: sub_100087C0+CCp

var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_17		= dword	ptr -17h
var_13		= dword	ptr -13h
var_F		= dword	ptr -0Fh
var_B		= dword	ptr -0Bh
var_7		= dword	ptr -7

		sub	esp, 60h
		mov	ecx, [eax+808h]
		lea	edx, [eax+4A0h]
		push	ebx
		mov	[esp+64h+var_54], edx
		lea	edx, [eax+480h]
		push	ebp
		mov	[esp+68h+var_50], edx
		push	esi
		mov	esi, [eax+454h]
		xor	edx, edx
		push	edi
		mov	[esp+70h+var_58], ecx
		cmp	[ecx+14h], edx
		jnz	short loc_100051E3
		mov	edi, 300h
		cmp	[esi+58h], di
		ja	short loc_100051E3
		mov	[esp+70h+var_5C], edx
		jmp	short loc_100051FB
; ---------------------------------------------------------------------------

loc_100051E3:				; CODE XREF: sub_100051A0+30j
					; sub_100051A0+3Bj
		mov	edi, 1
		mov	ebx, 303h
		mov	[esp+70h+var_5C], edi
		mov	[esp+70h+var_60], edi
		cmp	[esi+58h], bx
		jnb	short loc_100051FF

loc_100051FB:				; CODE XREF: sub_100051A0+41j
		mov	[esp+70h+var_60], edx

loc_100051FF:				; CODE XREF: sub_100051A0+59j
		mov	edi, [esi]
		mov	ebp, [eax+22Ch]
		xor	ebx, ebx
		cmp	[edi+4], edx
		setz	bl
		mov	[esp+70h+var_4C], ebx
		cmp	[esi+44h], edx
		jnz	short loc_10005230
		push	0FFFFD051h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_10005230:				; CODE XREF: sub_100051A0+76j
		mov	eax, [esi+0Ch]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		mov	[esp+70h+var_24], eax
		mov	eax, [edi+0Ch]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		mov	[esp+70h+var_20], eax
		mov	eax, [edi+14h]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		mov	[esp+70h+var_1C], eax
		cmp	dword ptr [edi+10h], 1
		jnz	short loc_10005298
		mov	eax, 302h
		cmp	[esi+58h], ax
		jb	short loc_10005298
		mov	[esp+70h+var_1C], edx
		mov	ecx, [edi+14h]
		push	ecx		; Size
		push	edx		; Val
		lea	edx, [esi+90h]
		push	edx		; Dst
		call	memset
		mov	eax, [edi+14h]
		push	eax		; Size
		lea	ecx, [esi+8F8h]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		mov	ecx, [esp+88h+var_58]
		add	esp, 18h
		xor	edx, edx

loc_10005298:				; CODE XREF: sub_100051A0+BBj
					; sub_100051A0+C6j
		mov	al, [ecx+0Ch]
		mov	ecx, [esp+70h+var_54]
		mov	[esp+70h+var_18], al
		mov	eax, 20h
		mov	[esp+70h+var_17], ecx
		mov	ecx, [esp+70h+var_50]
		mov	[esp+70h+var_13], eax
		mov	[esp+70h+var_B], eax
		lea	eax, [esp+70h+var_3C]
		mov	[esp+70h+var_F], ecx
		mov	[esp+70h+var_7], eax
		lea	eax, [esi+8F8h]
		lea	ecx, [esi+90h]
		mov	[esp+70h+var_2C], ecx
		mov	[esp+70h+var_28], eax
		mov	eax, [edi+8]
		cmp	ebx, edx
		jz	short loc_100052F1
		xor	eax, eax
		mov	[esp+70h+var_20], edx
		mov	[esp+70h+var_1C], edx
		mov	[esp+70h+var_2C], edx
		mov	[esp+70h+var_28], edx

loc_100052F1:				; CODE XREF: sub_100051A0+13Dj
		mov	ecx, [edi+4]
		mov	edi, ds:dword_1002ADFC[ecx*8]
		lea	ecx, [esp+70h+var_24]
		mov	[esp+70h+var_58], edi
		mov	[esp+70h+var_44], ecx
		mov	[esp+70h+var_40], 21h
		cmp	[esp+70h+var_60], edx
		jz	short loc_1000531C
		mov	ecx, 0CE534367h
		jmp	short loc_1000532C
; ---------------------------------------------------------------------------

loc_1000531C:				; CODE XREF: sub_100051A0+173j
		xor	ecx, ecx
		cmp	[esp+70h+var_5C], edx
		setnz	cl
		lea	ecx, ds:372h[ecx*4]

loc_1000532C:				; CODE XREF: sub_100051A0+17Aj
		push	eax
		mov	eax, [esi+44h]
		push	104h
		push	edi
		lea	edx, [esp+7Ch+var_48]
		push	edx
		push	ecx
		push	eax
		call	PK11_Derive
		mov	edi, eax
		add	esp, 18h
		test	edi, edi
		jnz	short loc_10005363
		push	0FFFFD051h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_10005363:				; CODE XREF: sub_100051A0+1A9j
		push	edi
		call	PK11_GetSlotFromKey
		mov	ebx, eax
		push	ebx
		call	PK11_FreeSlot
		mov	ecx, [esp+78h+var_3C]
		push	ebp
		push	1
		push	ecx
		push	381h
		push	1
		push	edi
		push	ebx
		call	PK11_SymKeyFromHandle
		add	esp, 24h
		mov	[esi+64h], eax
		test	eax, eax
		jz	short loc_100053FE
		mov	edx, [esp+70h+var_38]
		push	ebp
		push	1
		push	edx
		push	381h
		push	1
		push	edi
		push	ebx
		call	PK11_SymKeyFromHandle
		add	esp, 1Ch
		mov	[esi+8CCh], eax
		test	eax, eax
		jz	short loc_100053FE
		cmp	[esp+70h+var_4C], 0
		jnz	short loc_1000541C
		mov	eax, [esp+70h+var_34]
		mov	ecx, [esp+70h+var_58]
		push	ebp
		push	1
		push	eax
		push	ecx
		push	1
		push	edi
		push	ebx
		call	PK11_SymKeyFromHandle
		add	esp, 1Ch
		mov	[esi+60h], eax
		test	eax, eax
		jz	short loc_100053FE
		mov	edx, [esp+70h+var_30]
		mov	eax, [esp+70h+var_58]
		push	ebp
		push	1
		push	edx
		push	eax
		push	1
		push	edi
		push	ebx
		call	PK11_SymKeyFromHandle
		add	esp, 1Ch
		mov	[esi+8C8h], eax
		test	eax, eax
		jnz	short loc_1000541C

loc_100053FE:				; CODE XREF: sub_100051A0+1EFj
					; sub_100051A0+212j ...
		push	edi
		call	PK11_FreeSymKey
		push	0FFFFD051h
		call	sub_100147C0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000541C:				; CODE XREF: sub_100051A0+219j
					; sub_100051A0+25Cj
		push	edi
		call	PK11_FreeSymKey
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 60h
		retn
sub_100051A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005430	proc near		; CODE XREF: sub_100086F0+2Dp
					; sub_10009320+58p ...
		mov	eax, [esi+800h]
		push	edi
		xor	edi, edi
		mov	[esi+4C4h], edi
		mov	[esi+4CCh], edi
		mov	[esi+7F8h], edi
		mov	[esi+7FCh], edi
		cmp	eax, edi
		jz	short loc_10005466
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[esi+800h], edi

loc_10005466:				; CODE XREF: sub_10005430+23j
		mov	eax, [esi+804h]
		cmp	eax, edi
		jz	short loc_10005481
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[esi+804h], edi

loc_10005481:				; CODE XREF: sub_10005430+3Ej
		xor	eax, eax
		pop	edi
		retn
sub_10005430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005490	proc near		; CODE XREF: sub_10008500+7Cp
					; sub_100086F0+A4p ...

Src		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+Src]
		push	esi
		mov	esi, eax
		mov	eax, [esi+4C4h]
		test	eax, eax
		jnz	short loc_100054B6
		push	ebx		; Size
		push	ebp		; Src
		add	esi, 4C8h
		push	esi		; int
		call	sub_100189B0
		add	esp, 0Ch
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100054B6:				; CODE XREF: sub_10005490+10j
		test	dword ptr [esi+14h], 8000h
		jz	short loc_10005502
		push	ebx
		push	ebp
		cmp	eax, 2
		jnz	short loc_100054E0
		mov	eax, [esi+7F8h]
		mov	ecx, [eax+14h]
		add	esi, 668h
		push	esi
		call	ecx
		add	esp, 0Ch
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100054E0:				; CODE XREF: sub_10005490+34j
		lea	edx, [esi+4D8h]
		push	edx
		call	sub_100226C0
		push	ebx
		push	ebp
		add	esi, 668h
		push	esi
		call	sub_100227C0
		add	esp, 18h
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005502:				; CODE XREF: sub_10005490+2Dj
		push	edi
		push	ebx
		push	ebp
		cmp	eax, 2
		jnz	short loc_10005541
		mov	eax, [esi+804h]
		push	eax
		call	PK11_DigestOp
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10005532
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005532:				; CODE XREF: sub_10005490+8Dj
		mov	esi, [esi+800h]
		test	esi, esi
		jz	short loc_1000558D
		push	ebx
		push	ebp
		push	esi
		jmp	short loc_10005572
; ---------------------------------------------------------------------------

loc_10005541:				; CODE XREF: sub_10005490+78j
		mov	ecx, [esi+800h]
		push	ecx
		call	PK11_DigestOp
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10005569
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005569:				; CODE XREF: sub_10005490+C4j
		mov	edx, [esi+804h]
		push	ebx
		push	ebp
		push	edx

loc_10005572:				; CODE XREF: sub_10005490+AFj
		call	PK11_DigestOp
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_1000558D
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4

loc_1000558D:				; CODE XREF: sub_10005490+AAj
					; sub_10005490+EEj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10005490	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100055A0	proc near		; CODE XREF: sub_100168B0+D2p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax

loc_100055A6:				; CODE XREF: sub_100055A0+13j
		cmp	ecx, ds:dword_1002AF8C[eax*8]
		jz	short loc_100055B8
		inc	eax
		cmp	eax, 6
		jb	short loc_100055A6
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100055B8:				; CODE XREF: sub_100055A0+Dj
		mov	eax, ds:dword_1002AF90[eax*8]
		retn
sub_100055A0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100055C0	proc near		; CODE XREF: sub_1000A4D0+172p
		dec	eax
		jz	short loc_100055EE
		dec	eax
		jz	short loc_100055E5
		sub	eax, 4
		jz	short loc_100055DC
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100055DC:				; CODE XREF: sub_100055C0+9j
		mov	dword ptr [ecx], 3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100055E5:				; CODE XREF: sub_100055C0+4j
		mov	dword ptr [ecx], 2
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100055EE:				; CODE XREF: sub_100055C0+1j
		mov	dword ptr [ecx], 1
		xor	eax, eax
		retn
sub_100055C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005600	proc near		; CODE XREF: sub_10005670+Ap
		push	eax
		call	CERT_ExtractPublicKey
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000561E
		push	0FFFFD043h
		call	sub_100147C0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000561E:				; CODE XREF: sub_10005600+Bj
		push	esi
		mov	esi, [eax+4]
		push	eax
		call	SECKEY_DestroyPublicKey
		mov	eax, esi
		add	esp, 4
		dec	eax
		pop	esi
		jz	short loc_1000565C
		dec	eax
		jz	short loc_10005653
		sub	eax, 4
		jz	short loc_1000564A
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000564A:				; CODE XREF: sub_10005600+37j
		mov	dword ptr [edi], 3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10005653:				; CODE XREF: sub_10005600+32j
		mov	dword ptr [edi], 2
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000565C:				; CODE XREF: sub_10005600+2Fj
		mov	dword ptr [edi], 1
		xor	eax, eax
		retn
sub_10005600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005670	proc near		; CODE XREF: sub_1000AE00+1F1p
					; sub_1000AE00+3F9p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, [esp+4+arg_4]
		push	edi
		lea	edi, [esp+8+var_4]
		call	sub_10005600
		pop	edi
		test	eax, eax
		jnz	short loc_100056A4
		mov	eax, [esp+4+arg_0]
		mov	ecx, [esp+4+var_4]
		cmp	ecx, [eax+4]
		jz	short loc_100056A2
		push	0FFFFD080h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100056A2:				; CODE XREF: sub_10005670+1Ej
		xor	eax, eax

loc_100056A4:				; CODE XREF: sub_10005670+12j
		pop	ecx
		retn
sub_10005670	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100056B0	proc near		; CODE XREF: sub_1000A4D0+5Ep
					; sub_1000C9C0+5Bp ...

var_638		= dword	ptr -638h
var_634		= byte ptr -634h
var_630		= dword	ptr -630h
var_62C		= byte ptr -62Ch
var_62B		= byte ptr -62Bh
var_62A		= byte ptr -62Ah
var_629		= byte ptr -629h
var_628		= dword	ptr -628h
var_624		= dword	ptr -624h
var_620		= dword	ptr -620h
var_61C		= dword	ptr -61Ch
var_618		= dword	ptr -618h
var_614		= byte ptr -614h
var_484		= byte ptr -484h
var_444		= byte ptr -444h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 638h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+638h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+640h+arg_0]
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ecx
		mov	eax, 300h
		cmp	ax, [edi+58h]
		mov	ebx, edx
		sbb	eax, eax
		neg	eax
		mov	[esp+648h+var_630], eax
		mov	[ebx+4], esi
		mov	eax, [ebp+14h]
		shr	eax, 0Fh
		and	eax, 1
		mov	[esp+648h+var_620], ebx
		lea	ecx, [esi+2]
		jz	short loc_10005762
		cmp	[ebp+4C4h], ecx
		jnz	short loc_10005762
		cmp	[edi+1134h], esi
		jnz	short loc_10005720

loc_1000570B:				; CODE XREF: sub_100056B0+C0j
					; sub_100056B0+2DBj ...
		push	0FFFFD035h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10005D2A
; ---------------------------------------------------------------------------

loc_10005720:				; CODE XREF: sub_100056B0+59j
		mov	eax, [ebp+7FCh]
		lea	ecx, [ebp+668h]
		push	ecx
		lea	edx, [esp+64Ch+var_404]
		push	edx
		call	eax
		mov	ecx, [ebp+7F8h]
		mov	ecx, [ecx+18h]
		push	40h
		push	ebx
		lea	edx, [ebx+8]
		push	edx
		lea	eax, [esp+65Ch+var_404]
		push	eax
		call	ecx
		add	esp, 18h
		mov	dword ptr [ebx+4], 0BFh
		xor	esi, esi
		jmp	loc_10005D28
; ---------------------------------------------------------------------------

loc_10005762:				; CODE XREF: sub_100056B0+49j
					; sub_100056B0+51j
		cmp	eax, esi
		jz	loc_1000597C
		cmp	[edi+1134h], esi
		jz	short loc_1000570B
		lea	edx, [ebp+4D8h]
		push	edx
		lea	eax, [esp+64Ch+var_614]
		push	eax
		call	sub_10022A90
		add	ebp, 668h
		lea	ecx, [esp+650h+var_404]
		push	ebp
		push	ecx
		call	sub_10022AC0
		mov	esi, [esp+658h+var_630]
		add	esp, 10h
		test	esi, esi
		jnz	loc_100058E2
		mov	eax, [esp+648h+arg_4]
		mov	edx, eax
		shr	edx, 18h
		mov	byte ptr [esp+648h+var_638], dl
		mov	ecx, eax
		mov	edx, eax
		shr	ecx, 10h
		shr	edx, 8
		mov	byte ptr [esp+648h+var_638+1], cl
		mov	byte ptr [esp+648h+var_638+2], dl
		mov	byte ptr [esp+648h+var_638+3], al
		test	eax, eax
		jz	short loc_100057E4
		push	4
		lea	eax, [esp+64Ch+var_638]
		push	eax
		lea	ecx, [esp+650h+var_614]
		push	ecx
		call	sub_100226C0
		add	esp, 0Ch

loc_100057E4:				; CODE XREF: sub_100056B0+11Ej
		mov	edx, [edi+1138h]
		mov	eax, [edi+1134h]
		push	edx
		push	eax
		lea	ecx, [esp+650h+var_614]
		push	ecx
		call	sub_100226C0
		push	30h
		lea	edx, [esp+658h+var_614]
		push	offset a66666666666666 ; "666666666666666666666666666666666666666"...
		push	edx
		call	sub_100226C0
		push	10h
		lea	eax, [esp+664h+var_634]
		push	eax
		lea	ecx, [esp+668h+var_444]
		push	ecx
		lea	edx, [esp+66Ch+var_614]
		push	edx
		call	sub_100226F0
		add	esp, 28h
		cmp	[esp+648h+arg_4], 0
		jz	short loc_1000584A
		push	4
		lea	eax, [esp+64Ch+var_638]
		push	eax
		lea	ecx, [esp+650h+var_404]
		push	ecx
		call	sub_100227C0
		add	esp, 0Ch

loc_1000584A:				; CODE XREF: sub_100056B0+181j
		mov	edx, [edi+1138h]
		mov	eax, [edi+1134h]
		push	edx
		push	eax
		lea	ecx, [esp+650h+var_404]
		push	ecx
		call	sub_100227C0
		push	28h
		lea	edx, [esp+658h+var_404]
		push	offset a66666666666666 ; "666666666666666666666666666666666666666"...
		push	edx
		call	sub_100227C0
		push	14h
		lea	eax, [esp+664h+var_634]
		push	eax
		lea	ecx, [esp+668h+var_484]
		push	ecx
		lea	edx, [esp+66Ch+var_404]
		push	edx
		call	sub_100227F0
		lea	eax, [esp+670h+var_614]
		push	eax
		call	sub_10022690
		mov	ecx, [edi+1138h]
		mov	edx, [edi+1134h]
		push	ecx
		push	edx
		lea	eax, [esp+67Ch+var_614]
		push	eax
		call	sub_100226C0
		push	30h
		lea	ecx, [esp+684h+var_614]
		push	(offset	a66666666666666+3Ch) ; "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"...
		push	ecx
		call	sub_100226C0
		add	esp, 44h
		push	10h
		lea	edx, [esp+64Ch+var_444]
		push	edx
		lea	eax, [esp+650h+var_614]
		push	eax
		call	sub_100226C0
		add	esp, 0Ch

loc_100058E2:				; CODE XREF: sub_100056B0+F0j
		push	10h
		lea	ecx, [esp+64Ch+var_634]
		push	ecx
		lea	edx, [ebx+8]
		push	edx
		lea	eax, [esp+654h+var_614]
		push	eax
		call	sub_100226F0
		add	esp, 10h
		test	esi, esi
		jnz	short loc_10005954
		lea	ecx, [esp+648h+var_404]
		push	ecx
		call	sub_10022790
		mov	edx, [edi+1138h]
		mov	eax, [edi+1134h]
		push	edx
		push	eax
		lea	ecx, [esp+654h+var_404]
		push	ecx
		call	sub_100227C0
		push	28h
		lea	edx, [esp+65Ch+var_404]
		push	(offset	a66666666666666+3Ch) ; "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"...
		push	edx
		call	sub_100227C0
		push	14h
		lea	eax, [esp+668h+var_484]
		push	eax
		lea	ecx, [esp+66Ch+var_404]
		push	ecx
		call	sub_100227C0
		add	esp, 28h

loc_10005954:				; CODE XREF: sub_100056B0+24Cj
		push	14h
		lea	edx, [esp+64Ch+var_634]
		push	edx
		lea	eax, [ebx+18h]
		push	eax
		lea	ecx, [esp+654h+var_404]
		push	ecx
		call	sub_100227F0
		add	esp, 10h
		mov	dword ptr [ebx], 24h
		xor	esi, esi
		jmp	loc_10005D28
; ---------------------------------------------------------------------------

loc_1000597C:				; CODE XREF: sub_100056B0+B4j
		cmp	[ebp+4C4h], ecx
		jnz	loc_10005A35
		cmp	[edi+44h], esi
		jz	loc_1000570B
		mov	ebp, [ebp+804h]
		lea	edx, [esp+648h+var_630]
		push	edx
		push	400h
		lea	eax, [esp+650h+var_404]
		push	eax
		push	ebp
		call	PK11_SaveContextAlloc
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100059CA
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10005D28
; ---------------------------------------------------------------------------

loc_100059CA:				; CODE XREF: sub_100056B0+306j
		push	40h
		push	ebx
		lea	ecx, [ebx+8]
		push	ecx
		push	ebp
		call	PK11_DigestFinal
		add	esp, 10h
		test	eax, eax
		jz	short loc_100059F0
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_100059F9
; ---------------------------------------------------------------------------

loc_100059F0:				; CODE XREF: sub_100056B0+32Cj
		mov	dword ptr [ebx+4], 0BFh
		xor	esi, esi

loc_100059F9:				; CODE XREF: sub_100056B0+33Ej
		mov	edx, [esp+648h+var_630]
		push	edx
		push	edi
		push	ebp
		call	PK11_RestoreContext
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005A1C
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh

loc_10005A1C:				; CODE XREF: sub_100056B0+35Aj
		lea	eax, [esp+648h+var_404]
		cmp	edi, eax
		jz	loc_10005D28
		mov	ecx, [esp+648h+var_630]
		push	ecx
		jmp	loc_10005D1F
; ---------------------------------------------------------------------------

loc_10005A35:				; CODE XREF: sub_100056B0+2D2j
		cmp	[edi+44h], esi
		jz	loc_1000570B
		mov	ecx, [ebp+800h]
		lea	edx, [esp+648h+var_624]
		push	edx
		push	100h
		lea	eax, [esp+650h+var_614]
		push	eax
		push	ecx
		call	PK11_SaveContextAlloc
		add	esp, 10h
		mov	[esp+648h+var_618], eax
		test	eax, eax
		jnz	short loc_10005A76
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10005D28
; ---------------------------------------------------------------------------

loc_10005A76:				; CODE XREF: sub_100056B0+3B2j
		mov	ecx, [ebp+804h]
		mov	ebx, [ebp+800h]
		lea	edx, [esp+648h+var_628]
		push	edx
		push	200h
		lea	eax, [esp+650h+var_404]
		push	eax
		push	ecx
		call	PK11_SaveContextAlloc
		add	esp, 10h
		mov	[esp+648h+var_61C], eax
		test	eax, eax
		jnz	short loc_10005AB7
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		jmp	loc_10005C9B
; ---------------------------------------------------------------------------

loc_10005AB7:				; CODE XREF: sub_100056B0+3F3j
		mov	edx, [ebp+804h]
		mov	[esp+648h+var_638], edx
		cmp	[esp+648h+var_630], esi
		jnz	loc_10005C03
		mov	eax, [esp+648h+arg_4]
		mov	ecx, eax
		shr	ecx, 18h
		mov	[esp+648h+var_62C], cl
		mov	edx, eax
		mov	ecx, eax
		shr	edx, 10h
		shr	ecx, 8
		mov	[esp+648h+var_62B], dl
		mov	[esp+648h+var_62A], cl
		mov	[esp+648h+var_629], al
		test	eax, eax
		jz	short loc_10005B07
		push	4
		lea	edx, [esp+64Ch+var_62C]
		push	edx
		push	ebx
		call	PK11_DigestOp
		add	esp, 0Ch
		mov	esi, eax

loc_10005B07:				; CODE XREF: sub_100056B0+443j
		mov	eax, [edi+44h]
		push	eax
		push	ebx
		call	PK11_DigestKey
		push	30h
		push	offset a66666666666666 ; "666666666666666666666666666666666666666"...
		push	ebx
		or	esi, eax
		call	PK11_DigestOp
		push	10h
		lea	ecx, [esp+660h+var_634]
		push	ecx
		lea	edx, [esp+664h+var_444]
		push	edx
		push	ebx
		or	esi, eax
		call	PK11_DigestFinal
		add	esp, 24h
		or	esi, eax
		jz	short loc_10005B53

loc_10005B3E:				; CODE XREF: sub_100056B0+56Dj
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	loc_10005C9B
; ---------------------------------------------------------------------------

loc_10005B53:				; CODE XREF: sub_100056B0+48Cj
		cmp	[esp+648h+arg_4], 0
		jz	short loc_10005B73
		mov	ecx, [esp+648h+var_638]
		push	4
		lea	eax, [esp+64Ch+var_62C]
		push	eax
		push	ecx
		call	PK11_DigestOp
		add	esp, 0Ch
		mov	esi, eax

loc_10005B73:				; CODE XREF: sub_100056B0+4ABj
		mov	edx, [edi+44h]
		mov	eax, [esp+648h+var_638]
		push	edx
		push	eax
		call	PK11_DigestKey
		mov	ecx, [esp+650h+var_638]
		push	28h
		push	offset a66666666666666 ; "666666666666666666666666666666666666666"...
		push	ecx
		or	esi, eax
		call	PK11_DigestOp
		mov	ecx, [esp+65Ch+var_638]
		push	14h
		lea	edx, [esp+660h+var_634]
		or	esi, eax
		push	edx
		lea	eax, [esp+664h+var_484]
		push	eax
		push	ecx
		call	PK11_DigestFinal
		add	esp, 24h
		or	esi, eax
		jz	short loc_10005BCB
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	loc_10005C9B
; ---------------------------------------------------------------------------

loc_10005BCB:				; CODE XREF: sub_100056B0+504j
		push	ebx
		call	PK11_DigestBegin
		mov	edx, [edi+44h]
		push	edx
		push	ebx
		mov	esi, eax
		call	PK11_DigestKey
		push	30h
		push	(offset	a66666666666666+3Ch) ; "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"...
		push	ebx
		or	esi, eax
		call	PK11_DigestOp
		or	esi, eax
		push	10h
		lea	eax, [esp+664h+var_444]
		push	eax
		push	ebx
		call	PK11_DigestOp
		add	esp, 24h
		or	esi, eax

loc_10005C03:				; CODE XREF: sub_100056B0+415j
		mov	edx, [esp+648h+var_620]
		push	10h
		lea	ecx, [esp+64Ch+var_634]
		push	ecx
		add	edx, 8
		push	edx
		push	ebx
		call	PK11_DigestFinal
		add	esp, 10h
		or	esi, eax
		jnz	loc_10005B3E
		mov	ebx, [esp+648h+var_638]
		cmp	[esp+648h+var_630], esi
		jnz	short loc_10005C65
		push	ebx
		call	PK11_DigestBegin
		mov	esi, eax
		mov	eax, [edi+44h]
		push	eax
		push	ebx
		call	PK11_DigestKey
		push	28h
		push	(offset	a66666666666666+3Ch) ; "\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"...
		push	ebx
		or	esi, eax
		call	PK11_DigestOp
		push	14h
		lea	ecx, [esp+664h+var_484]
		push	ecx
		push	ebx
		or	esi, eax
		call	PK11_DigestOp
		add	esp, 24h
		or	esi, eax

loc_10005C65:				; CODE XREF: sub_100056B0+57Bj
		mov	edi, [esp+648h+var_620]
		push	14h
		lea	edx, [esp+64Ch+var_634]
		push	edx
		lea	eax, [edi+18h]
		push	eax
		push	ebx
		call	PK11_DigestFinal
		add	esp, 10h
		or	eax, esi
		jz	short loc_10005C93
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_10005C9B
; ---------------------------------------------------------------------------

loc_10005C93:				; CODE XREF: sub_100056B0+5CFj
		mov	dword ptr [edi], 24h
		xor	esi, esi

loc_10005C9B:				; CODE XREF: sub_100056B0+402j
					; sub_100056B0+49Ej ...
		mov	ecx, [esp+648h+var_624]
		mov	edi, [esp+648h+var_618]
		mov	edx, [ebp+800h]
		push	ecx
		push	edi
		push	edx
		call	PK11_RestoreContext
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005CC8
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh

loc_10005CC8:				; CODE XREF: sub_100056B0+606j
		lea	eax, [esp+648h+var_614]
		cmp	edi, eax
		jz	short loc_10005CDE
		mov	ecx, [esp+648h+var_624]
		push	ecx
		push	edi
		call	PORT_ZFree_Util
		add	esp, 8

loc_10005CDE:				; CODE XREF: sub_100056B0+61Ej
		mov	edi, [esp+648h+var_61C]
		test	edi, edi
		jz	short loc_10005D28
		mov	edx, [esp+648h+var_628]
		mov	eax, [ebp+804h]
		push	edx
		push	edi
		push	eax
		call	PK11_RestoreContext
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005D0F
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh

loc_10005D0F:				; CODE XREF: sub_100056B0+64Dj
		lea	ecx, [esp+648h+var_404]
		cmp	edi, ecx
		jz	short loc_10005D28
		mov	edx, [esp+648h+var_628]
		push	edx

loc_10005D1F:				; CODE XREF: sub_100056B0+380j
		push	edi
		call	PORT_ZFree_Util
		add	esp, 8

loc_10005D28:				; CODE XREF: sub_100056B0+ADj
					; sub_100056B0+2C7j ...
		mov	eax, esi

loc_10005D2A:				; CODE XREF: sub_100056B0+6Bj
		mov	ecx, [esp+648h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 638h
		retn
sub_100056B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005D50	proc near		; CODE XREF: sub_1000A4D0+4Bp
		mov	ecx, [ebx+800h]
		push	esi
		push	40h
		push	edi
		lea	eax, [edi+8]
		push	eax
		push	ecx
		call	PK11_DigestFinal
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_10005D7F
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_10005D86
; ---------------------------------------------------------------------------

loc_10005D7F:				; CODE XREF: sub_10005D50+1Bj
		mov	dword ptr [edi+4], 4

loc_10005D86:				; CODE XREF: sub_10005D50+2Dj
		mov	edx, [ebx+800h]
		push	1
		push	edx
		call	PK11_DestroyContext
		add	esp, 8
		mov	eax, esi
		mov	dword ptr [ebx+800h], 0
		pop	esi
		retn
sub_10005D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005DB0	proc near		; CODE XREF: sub_10006050+6Dp
		mov	eax, offset dword_1002AFD0
		cmp	edx, 132h
		jz	short loc_10005DE0
		mov	ecx, 132h

loc_10005DC2:				; CODE XREF: sub_10005DB0+22j
		cmp	ecx, 7FFFFFFFh
		jz	short loc_10005DDC
		mov	ecx, [eax+4]
		add	eax, 4
		cmp	edx, ecx
		jnz	short loc_10005DC2
		cmp	ecx, 7FFFFFFFh
		jnz	short loc_10005DE0

loc_10005DDC:				; CODE XREF: sub_10005DB0+18j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10005DE0:				; CODE XREF: sub_10005DB0+Bj
					; sub_10005DB0+2Aj
		sub	eax, offset dword_1002AFD0
		sar	eax, 2
		retn
sub_10005DB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005DF0	proc near		; CODE XREF: sub_10006050+FAp
					; sub_10006050+391p

var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0BCh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0BCh+var_4], eax
		mov	eax, [esp+0BCh+arg_0]
		push	ebp
		push	esi
		mov	esi, [esp+0C4h+arg_4]
		xor	ebp, ebp
		push	edi
		mov	edi, edx
		cmp	[eax+200h], esi
		jnz	loc_10005F3C
		cmp	[eax+208h], ecx
		jnz	loc_10005F3C
		dec	ecx
		movzx	edx, word ptr [eax+210h]
		mov	[esp+0C8h+var_BC], ebp
		mov	[esp+0C8h+var_B8], eax
		mov	[esp+0C8h+var_B4], edx
		jz	loc_10005F0F
		sub	ecx, 3
		jnz	loc_10005F3C
		movzx	ecx, word ptr [eax+4]
		movzx	edx, word ptr [eax+2]
		push	ebx
		movzx	ebx, word ptr [eax+6]
		add	ecx, ebx
		add	edx, ecx
		cmp	edx, 1F8h
		jle	short loc_10005E81
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		mov	eax, ebp
		jmp	loc_10005F58
; ---------------------------------------------------------------------------

loc_10005E81:				; CODE XREF: sub_10005DF0+7Bj
		movzx	ecx, word ptr [eax]
		push	0
		push	0
		push	1
		push	0
		push	10Ch
		push	esi
		lea	edx, [eax+8]
		push	1050h
		mov	[esp+0E8h+var_9C], edx
		movzx	edx, word ptr [eax+4]
		mov	[esp+0E8h+var_94], ecx
		movzx	ecx, word ptr [eax+2]
		push	0
		lea	ebp, [ecx+eax+8]
		push	0
		mov	[esp+0F0h+var_88], edx
		add	edx, ecx
		mov	[esp+0F0h+var_98], ecx
		push	0
		lea	ecx, [esp+0F4h+var_B0]
		push	ecx
		lea	eax, [edx+eax+8]
		push	edi
		mov	[esp+0FCh+var_AC], 6
		mov	[esp+0FCh+var_8C], ebp
		mov	[esp+0FCh+var_B4], ebx
		mov	[esp+0FCh+var_B8], eax
		call	PK11_PubDeriveWithKDF
		mov	edi, eax
		add	esp, 30h
		test	edi, edi
		jz	short loc_10005F56
		push	0
		push	107h
		push	esi
		lea	edx, [esp+0D8h+var_BC]
		push	edx
		push	0
		push	esi
		push	edi
		call	PK11_UnwrapSymKey
		push	edi
		mov	esi, eax
		call	PK11_FreeSymKey
		add	esp, 20h
		mov	eax, esi
		jmp	short loc_10005F58
; ---------------------------------------------------------------------------

loc_10005F0F:				; CODE XREF: sub_10005DF0+55j
		push	ebp
		push	107h
		push	esi
		lea	eax, [esp+0D4h+var_BC]
		push	eax
		push	edi
		call	PK11_PubUnwrapSymKey
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebp
		mov	ecx, [esp+0BCh+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0BCh
		retn
; ---------------------------------------------------------------------------

loc_10005F3C:				; CODE XREF: sub_10005DF0+2Fj
					; sub_10005DF0+3Bj ...
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		mov	ecx, [esp+0BCh+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0BCh
		retn
; ---------------------------------------------------------------------------

loc_10005F56:				; CODE XREF: sub_10005DF0+F8j
		xor	eax, eax

loc_10005F58:				; CODE XREF: sub_10005DF0+8Cj
					; sub_10005DF0+11Dj
		mov	ecx, [esp+0CCh+var_4]
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0BCh
		retn
sub_10005DF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005F80	proc near		; CODE XREF: sub_10017D20+26p
					; sub_10017DA0:loc_10017DBAp ...
		mov	eax, dword_1003764C
		test	eax, eax
		jz	short loc_10005FA0
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4
		mov	dword_1003764C,	0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10005FA0:				; CODE XREF: sub_10005F80+7j
		push	0FFFFE09Ah
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_10005F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005FC0	proc near		; CODE XREF: SSL_ShutdownServerSessionIDCache+1p
		mov	eax, dword_1003764C
		test	eax, eax
		jz	short loc_1000601E
		push	esi
		push	edi
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		mov	esi, offset dword_10037508
		lea	ebx, [ebx+0]

loc_10005FE0:				; CODE XREF: sub_10005FC0+46j
		mov	edi, 5

loc_10005FE5:				; CODE XREF: sub_10005FC0+3Ej
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10005FFA
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword ptr [esi], 0

loc_10005FFA:				; CODE XREF: sub_10005FC0+29j
		add	esi, 4
		dec	edi
		jnz	short loc_10005FE5
		cmp	esi, offset dword_10037648
		jl	short loc_10005FE0
		mov	eax, dword_1003764C
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		call	sub_10017DA0
		pop	edi
		pop	esi

loc_1000601E:				; CODE XREF: sub_10005FC0+7j
		xor	eax, eax
		retn
sub_10005FC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006030	proc near		; CODE XREF: sub_10017D20+1p
		call	ds:PR_NewLock
		mov	dword_1003764C,	eax
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
sub_10006030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006050	proc near		; CODE XREF: sub_10006EA0+E7p
					; sub_1000D820+864p

var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
Dst		= word ptr -218h
var_216		= word ptr -216h
var_214		= word ptr -214h
var_212		= word ptr -212h
var_210		= byte ptr -210h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 240h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+240h+var_4], eax
		mov	eax, [esp+240h+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+24Ch+arg_4]
		mov	esi, edx
		mov	edx, edi
		add	edx, edx
		lea	ebp, [eax+edx*8+2F4h]
		mov	eax, [ebp+0]
		mov	[esp+24Ch+var_230], ecx
		xor	ecx, ecx
		mov	[esp+24Ch+var_240], ecx
		mov	eax, [eax]
		mov	[esp+24Ch+var_23C], edi
		mov	[esp+24Ch+var_238], ecx
		mov	[esp+24Ch+var_234], eax
		cmp	eax, ecx
		jnz	short loc_100060BB

loc_100060A1:				; CODE XREF: sub_10006050+78j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+240h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 240h
		retn
; ---------------------------------------------------------------------------

loc_100060BB:				; CODE XREF: sub_10006050+4Fj
		mov	edx, ebx
		call	sub_10005DB0
		mov	[esp+24Ch+var_22C], eax
		test	eax, eax
		js	short loc_100060A1
		lea	edi, [edi+eax*4]
		add	edi, eax
		lea	edi, dword_10037508[edi*4]
		push	1
		mov	[esp+250h+var_21C], edi
		call	sub_10017EA0
		mov	ecx, dword_1003764C
		push	ecx
		call	ds:PR_Lock
		mov	edi, [edi]
		add	esp, 8
		test	edi, edi
		jz	short loc_10006121
		push	edi
		call	PK11_VerifyKeyOK
		add	esp, 4
		push	edi
		test	eax, eax
		jz	short loc_10006111
		call	PK11_ReferenceSymKey
		mov	edi, eax
		jmp	loc_100063FB
; ---------------------------------------------------------------------------

loc_10006111:				; CODE XREF: sub_10006050+B3j
		call	PK11_FreeSymKey
		mov	edx, [esp+250h+var_21C]
		add	esp, 4
		xor	edi, edi
		mov	[edx], edi

loc_10006121:				; CODE XREF: sub_10006050+A5j
		mov	ecx, [esp+24Ch+var_23C]
		mov	edx, [esp+24Ch+var_22C]
		lea	eax, [esp+24Ch+Dst]
		push	eax
		push	ecx
		push	edx
		call	sub_1001BB10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000615C
		mov	ecx, [esp+24Ch+var_23C]
		mov	edx, [esp+24Ch+var_234]
		lea	eax, [esp+24Ch+Dst]
		push	ebx
		push	eax
		call	sub_10005DF0
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	loc_100063EF

loc_1000615C:				; CODE XREF: sub_10006050+EAj
		test	esi, esi
		jz	loc_100063FE
		push	ebx
		push	esi
		call	PK11_GetBestKeyLength
		mov	ecx, [esp+254h+var_230]
		push	ecx
		push	eax
		push	0
		push	ebx
		push	esi
		call	PK11_KeyGen
		mov	edi, eax
		add	esp, 1Ch
		test	edi, edi
		jz	loc_100063FE
		push	214h		; Size
		lea	edx, [esp+250h+Dst]
		push	0		; Val
		push	edx		; Dst
		call	memset
		mov	ebp, [ebp+0]
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_100061A9
		mov	esi, [ebp+4]
		test	esi, esi
		jnz	short loc_100061B8

loc_100061A9:				; CODE XREF: sub_10006050+150j
		push	0FFFFE001h
		call	PORT_SetError_Util
		jmp	loc_100063FB
; ---------------------------------------------------------------------------

loc_100061B8:				; CODE XREF: sub_10006050+157j
		push	esi
		mov	[esp+250h+var_228], 0
		call	SECKEY_PublicKeyStrength
		add	esp, 4
		lea	ecx, [esp+24Ch+Dst]
		mov	[esp+24Ch+var_220], eax
		mov	[esp+24Ch+var_224], ecx
		cmp	eax, 200h
		ja	loc_100063FE
		mov	eax, [esp+24Ch+var_23C]
		dec	eax
		jz	loc_10006366
		sub	eax, 3
		jnz	loc_10006381
		cmp	dword ptr [esi+4], 6
		jz	short loc_10006210
		push	0FFFFE001h
		call	PORT_SetError_Util
		mov	ebp, [esp+250h+var_238]
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_10006280
; ---------------------------------------------------------------------------

loc_10006210:				; CODE XREF: sub_10006050+1A8j
		push	0
		lea	edx, [esp+250h+var_240]
		push	edx
		lea	eax, [esi+10h]
		push	eax
		call	SECKEY_CreateECPrivateKey
		add	esp, 0Ch
		mov	[esp+24Ch+var_230], eax
		test	eax, eax
		mov	eax, [esp+24Ch+var_240]
		jz	short loc_10006268
		test	eax, eax
		jz	short loc_10006268
		cmp	dword ptr [eax+1Ch], 0
		jnz	short loc_10006249
		push	esi
		call	SECKEY_PublicKeyStrengthInBits
		mov	ecx, [esp+250h+var_240]
		add	esp, 4
		mov	[ecx+1Ch], eax

loc_10006249:				; CODE XREF: sub_10006050+1E7j
		mov	eax, [esp+24Ch+var_240]
		mov	edx, [eax+28h]
		add	edx, [eax+18h]
		cmp	edx, 1F8h
		jb	short loc_100062A5
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4

loc_10006268:				; CODE XREF: sub_10006050+1DDj
					; sub_10006050+1E1j
		mov	ebp, [esp+24Ch+var_238]

loc_1000626C:				; CODE XREF: sub_10006050+280j
		or	esi, 0FFFFFFFFh

loc_1000626F:				; CODE XREF: sub_10006050+301j
					; sub_10006050+311j
		mov	eax, [esp+24Ch+var_230]
		test	eax, eax
		jz	short loc_10006280
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10006280:				; CODE XREF: sub_10006050+1BEj
					; sub_10006050+225j
		mov	eax, [esp+24Ch+var_240]
		test	eax, eax
		jz	short loc_10006291
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_10006291:				; CODE XREF: sub_10006050+236j
		test	ebp, ebp
		jz	short loc_1000629E
		push	ebp
		call	PK11_FreeSymKey
		add	esp, 4

loc_1000629E:				; CODE XREF: sub_10006050+243j
		mov	ebp, ebx
		jmp	loc_1000637D
; ---------------------------------------------------------------------------

loc_100062A5:				; CODE XREF: sub_10006050+209j
		push	0
		push	0
		push	1
		push	0
		push	10Ch
		push	ebx
		push	1050h
		push	0
		push	0
		push	0
		push	eax
		mov	eax, [esp+278h+var_234]
		push	eax
		call	PK11_PubDeriveWithKDF
		mov	ebp, eax
		add	esp, 30h
		test	ebp, ebp
		jz	short loc_1000626C
		mov	esi, [esp+24Ch+var_240]
		mov	cx, [esi+1Ch]
		mov	[esp+24Ch+Dst],	cx
		mov	dx, [esi+18h]
		mov	[esp+24Ch+var_216], dx
		mov	eax, [esi+18h]
		mov	ecx, [esi+14h]
		push	eax		; Size
		push	ecx		; Src
		lea	edx, [esp+254h+var_210]
		push	edx		; Dst
		call	memcpy
		mov	ax, [esi+28h]
		mov	[esp+258h+var_214], ax
		mov	ecx, [esi+28h]
		movzx	eax, [esp+258h+var_216]
		mov	edx, [esi+24h]
		push	ecx		; Size
		push	edx		; Src
		lea	ecx, [esp+eax+260h+var_210]
		push	ecx		; Dst
		call	memcpy
		movzx	eax, [esp+264h+var_214]
		movzx	ecx, [esp+264h+var_216]
		mov	edx, 1F8h
		sub	edx, eax
		sub	edx, ecx
		add	eax, ecx
		lea	ecx, [esp+264h+var_228]
		push	ecx
		push	edi
		push	ebp
		lea	eax, [esp+eax+270h+var_210]
		push	0
		push	ebx
		mov	[esp+278h+var_220], edx
		mov	[esp+278h+var_224], eax
		call	PK11_WrapSymKey
		mov	esi, eax
		add	esp, 2Ch
		test	esi, esi
		jnz	loc_1000626F
		mov	dx, word ptr [esp+24Ch+var_220]
		mov	[esp+24Ch+var_212], dx
		jmp	loc_1000626F
; ---------------------------------------------------------------------------

loc_10006366:				; CODE XREF: sub_10006050+195j
		lea	eax, [esp+24Ch+var_228]
		push	eax
		push	edi
		mov	ebp, 1
		push	esi
		push	ebp
		call	PK11_PubWrapSymKey
		add	esp, 10h
		mov	esi, eax

loc_1000637D:				; CODE XREF: sub_10006050+250j
		test	esi, esi
		jz	short loc_1000638D

loc_10006381:				; CODE XREF: sub_10006050+19Ej
		push	0FFFFD045h
		call	sub_100147C0
		jmp	short loc_100063FB
; ---------------------------------------------------------------------------

loc_1000638D:				; CODE XREF: sub_10006050+32Fj
		mov	ecx, [esp+24Ch+var_22C]
		mov	dx, word ptr [esp+24Ch+var_220]
		mov	esi, [esp+24Ch+var_23C]
		lea	eax, [esp+24Ch+Dst]
		push	eax
		mov	[esp+250h+var_18], ebx
		mov	[esp+250h+var_C], ecx
		mov	[esp+250h+var_14], ebp
		mov	[esp+250h+var_10], esi
		mov	[esp+250h+var_8], dx
		call	sub_1001C070
		add	esp, 4
		test	eax, eax
		jz	short loc_100063EB
		push	edi
		call	PK11_FreeSymKey
		mov	edx, [esp+250h+var_234]
		lea	ecx, [esp+250h+Dst]
		push	ebx
		push	ecx
		mov	ecx, esi
		call	sub_10005DF0
		add	esp, 0Ch
		mov	edi, eax

loc_100063EB:				; CODE XREF: sub_10006050+37Dj
		test	edi, edi
		jz	short loc_100063FE

loc_100063EF:				; CODE XREF: sub_10006050+106j
		push	edi
		call	PK11_ReferenceSymKey
		mov	edx, [esp+250h+var_21C]
		mov	[edx], eax

loc_100063FB:				; CODE XREF: sub_10006050+BCj
					; sub_10006050+163j ...
		add	esp, 4

loc_100063FE:				; CODE XREF: sub_10006050+10Ej
					; sub_10006050+131j ...
		mov	eax, dword_1003764C
		push	eax
		call	ds:PR_Unlock
		mov	ecx, [esp+250h+var_4]
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 240h
		retn
sub_10006050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006430	proc near		; CODE XREF: sub_1000AE00+16Ep
					; sub_1000AE00+1B2p
		mov	edx, [ecx+8]
		xor	eax, eax
		test	edx, edx
		jz	short loc_10006455
		mov	ecx, [ecx+4]
		lea	esp, [esp+0]

loc_10006440:				; CODE XREF: sub_10006430+19j
		cmp	byte ptr [ecx+eax], 0
		jnz	short loc_1000644E
		inc	eax
		cmp	eax, edx
		jb	short loc_10006440
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000644E:				; CODE XREF: sub_10006430+14j
		mov	cl, [ecx+eax]
		test	cl, cl
		jnz	short loc_10006458

loc_10006455:				; CODE XREF: sub_10006430+7j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10006458:				; CODE XREF: sub_10006430+23j
		cmp	cl, 1
		jbe	short loc_10006463
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10006463:				; CODE XREF: sub_10006430+2Bj
		dec	edx
		cmp	eax, edx
		sbb	eax, eax
		neg	eax
		retn
sub_10006430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006470	proc near		; CODE XREF: sub_10006520+26p
		push	esi
		push	edi
		mov	edi, ecx
		mov	ecx, [eax+458h]
		push	ecx
		call	CERT_ExtractPublicKey
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000648F
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000648F:				; CODE XREF: sub_10006470+17j
		mov	eax, [esi+4]
		dec	eax
		jz	short loc_100064CB
		dec	eax
		jz	short loc_100064C3
		sub	eax, 4
		jz	short loc_100064BB
		push	0FFFFE028h
		call	PORT_SetError_Util
		add	esp, 4
		push	esi
		or	edi, 0FFFFFFFFh
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100064BB:				; CODE XREF: sub_10006470+2Bj
		mov	dword ptr [edi], 3
		jmp	short loc_100064D1
; ---------------------------------------------------------------------------

loc_100064C3:				; CODE XREF: sub_10006470+26j
		mov	dword ptr [edi], 2
		jmp	short loc_100064D1
; ---------------------------------------------------------------------------

loc_100064CB:				; CODE XREF: sub_10006470+23j
		mov	dword ptr [edi], 1

loc_100064D1:				; CODE XREF: sub_10006470+51j
					; sub_10006470+59j
		mov	eax, [esi+4]
		xor	edi, edi
		cmp	eax, 1
		jz	short loc_100064F0
		cmp	eax, 2
		jz	short loc_100064F0
		push	esi
		mov	[ebx], edi
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100064F0:				; CODE XREF: sub_10006470+69j
					; sub_10006470+6Ej
		push	esi
		call	SECKEY_PublicKeyStrength
		add	esp, 4
		mov	edx, 80h
		cmp	edx, eax
		sbb	eax, eax
		inc	eax
		push	esi
		mov	[ebx], eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_10006470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006520	proc near		; CODE XREF: sub_1000B3C0+359p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		xor	ebp, ebp
		test	dword ptr [edi+14h], 8000h
		mov	esi, eax
		mov	[esp+18h+var_C], ebp
		jnz	short loc_100065B6
		push	ebx
		lea	ebx, [esp+1Ch+var_4]
		lea	ecx, [esp+1Ch+var_8]
		mov	eax, edi
		call	sub_10006470
		lea	ebx, [ebp+1]
		test	eax, eax
		jnz	short loc_1000659B
		mov	edi, [esi+8]
		test	edi, edi
		jz	short loc_10006597
		mov	edx, [esi+4]
		mov	esi, [esp+1Ch+var_8]

loc_10006560:				; CODE XREF: sub_10006520+63j
		movzx	ecx, byte ptr [edx+eax+1]
		cmp	ecx, esi
		jnz	short loc_1000657E
		mov	cl, [edx+eax]
		cmp	cl, 2
		jnz	short loc_10006575
		mov	ebp, ebx
		jmp	short loc_1000657E
; ---------------------------------------------------------------------------

loc_10006575:				; CODE XREF: sub_10006520+4Fj
		cmp	cl, 4
		jnz	short loc_1000657E
		mov	[esp+1Ch+var_C], ebx

loc_1000657E:				; CODE XREF: sub_10006520+47j
					; sub_10006520+53j ...
		add	eax, 2
		cmp	eax, edi
		jb	short loc_10006560
		test	ebp, ebp
		jz	short loc_10006597
		cmp	[esp+1Ch+var_4], 0
		jnz	short loc_100065B5
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_100065B5

loc_10006597:				; CODE XREF: sub_10006520+37j
					; sub_10006520+67j
		mov	edi, [esp+1Ch+arg_0]

loc_1000659B:				; CODE XREF: sub_10006520+30j
		mov	edx, [edi+800h]
		push	ebx
		push	edx
		call	PK11_DestroyContext
		add	esp, 8
		mov	dword ptr [edi+800h], 0

loc_100065B5:				; CODE XREF: sub_10006520+6Ej
					; sub_10006520+75j
		pop	ebx

loc_100065B6:				; CODE XREF: sub_10006520+19j
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
sub_10006520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100065C0	proc near		; CODE XREF: sub_1000C7F0+F8p
					; sub_1000D520:loc_1000D687p
		cmp	dword ptr [esi+224h], 0
		jz	short loc_1000660C
		test	byte ptr [esi+16h], 1
		jnz	short loc_100065DE
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_100065DE:				; CODE XREF: sub_100065C0+Dj
		mov	ecx, [esi+450h]
		mov	edx, [ecx]
		xor	eax, eax
		cmp	dword ptr [edx+0Ch], 0Ah
		push	edi
		setnl	al
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_10006607
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10006607:				; CODE XREF: sub_100065C0+36j
		test	edi, edi
		pop	edi
		jnz	short loc_10006619

loc_1000660C:				; CODE XREF: sub_100065C0+7j
		mov	dword ptr [esi+8C8h], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10006619:				; CODE XREF: sub_100065C0+4Aj
		mov	eax, [esi+228h]
		mov	ecx, [esi]
		lea	edx, [esi+8C8h]
		push	edx
		mov	edx, [esi+224h]
		push	eax
		push	ecx
		call	edx
		add	esp, 0Ch
		retn
sub_100065C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006640	proc near		; CODE XREF: sub_1000C7F0+ECp
					; sub_10010190+1BEp ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+4C0h]
		cmp	eax, 4
		jz	short loc_1000665A
		xor	ecx, ecx
		cmp	eax, 0Ch
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1000665A:				; CODE XREF: sub_10006640+Dj
		push	23h
		push	ecx
		call	sub_10014AB0
		add	esp, 8
		neg	eax
		sbb	eax, eax
		inc	eax
		retn
sub_10006640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006670	proc near		; CODE XREF: sub_1000D820+C69p
					; sub_1000D820+D86p
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		xor	edx, edx
		test	esi, esi
		setz	dl
		cmp	ecx, edx
		jz	short loc_10006686

loc_10006682:				; CODE XREF: sub_10006670+1Fj
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10006686:				; CODE XREF: sub_10006670+10j
		test	eax, eax
		jnz	short loc_1000668B
		retn
; ---------------------------------------------------------------------------

loc_1000668B:				; CODE XREF: sub_10006670+18j
		mov	ecx, [eax]
		cmp	ecx, [esi]
		jnz	short loc_10006682
		push	esi
		push	eax
		call	SECITEM_CompareItem_Util
		add	esp, 8
		retn
sub_10006670	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100066A0	proc near		; CODE XREF: sub_10009320+27Ep
					; sub_1000A6D0+6B8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	108h
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100066B6
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100066B6:				; CODE XREF: sub_100066A0+12j
		cmp	[esp+4+arg_4], 0
		push	edi
		mov	edi, [esp+8+arg_0]
		jz	short loc_1000672B
		push	ebx
		xor	ebx, ebx
		test	byte ptr [edi+16h], 1
		jnz	short loc_100066DA
		mov	eax, [edi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_100066DA:				; CODE XREF: sub_100066A0+29j
		mov	eax, [edi+44Ch]
		add	eax, 1204h
		cmp	[eax+8], ebx
		jz	short loc_10006703
		cmp	[eax+4], ebx
		jz	short loc_10006703
		push	eax
		lea	ecx, [esi+0E0h]
		push	ecx
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		mov	ebx, eax

loc_10006703:				; CODE XREF: sub_100066A0+48j
					; sub_100066A0+4Dj
		test	byte ptr [edi+16h], 1
		jnz	short loc_10006718
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10006718:				; CODE XREF: sub_100066A0+67j
		test	ebx, ebx
		pop	ebx
		jz	short loc_1000672B
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000672B:				; CODE XREF: sub_100066A0+20j
					; sub_100066A0+7Bj
		mov	eax, [edi+1E8h]
		test	eax, eax
		jz	short loc_1000673E
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4

loc_1000673E:				; CODE XREF: sub_100066A0+93j
		mov	[esi+1Ch], eax
		mov	eax, [edi+1D8h]
		test	eax, eax
		jz	short loc_10006754
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4

loc_10006754:				; CODE XREF: sub_100066A0+A9j
		cmp	[esp+8+arg_4], 0
		mov	[esi+20h], eax
		mov	eax, [edi+0E0h]
		mov	[esi+28h], eax
		mov	ecx, [edi+0E4h]
		mov	[esi+2Ch], ecx
		mov	edx, [edi+0E8h]
		mov	[esi+30h], edx
		mov	eax, [edi+0ECh]
		mov	[esi+34h], eax
		mov	cx, [edi+0F0h]
		mov	eax, 1
		mov	[esi+38h], cx
		mov	[esi+8], eax
		mov	dword ptr [esi+4], 0
		mov	dx, [edi+44h]
		mov	[esi+3Ah], dx
		mov	[esi+0B3h], al
		mov	[esi+7Ch], eax
		mov	dword ptr [esi+0C0h], 0
		mov	dword ptr [esi+0C4h], 0
		jz	short loc_10006800
		call	ds:GetCurrentProcessId
		mov	ecx, eax
		lea	edx, [esi+57h]
		sar	ecx, 8
		push	1Eh
		push	edx
		mov	byte ptr [esi+54h], 20h
		mov	[esi+55h], cl
		mov	[esi+56h], al
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jz	short loc_10006800
		push	esi
		call	sub_10017FD0
		push	0FFFFD041h
		call	sub_100147C0
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006800:				; CODE XREF: sub_100066A0+11Fj
					; sub_100066A0+146j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100066A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006810	proc near		; CODE XREF: sub_1000B9F0+2Cp

arg_0		= dword	ptr  4

		mov	eax, [ebx+808h]
		mov	eax, [eax]
		mov	ecx, [esp+arg_0]
		dec	eax
		push	edi
		cmp	eax, 11h	; switch 18 cases
		ja	loc_100068C4	; jumptable 1000682E default case
		movzx	edx, ds:byte_100068E8[eax]
		jmp	ds:off_100068D8[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006835:				; CODE XREF: sub_10006810+1Ej
					; DATA XREF: .text:off_100068D8o
		mov	edi, 1		; jumptable 1000682E cases 0-2,5,6,9,10,13,16,17
		jmp	short loc_10006848
; ---------------------------------------------------------------------------

loc_1000683C:				; CODE XREF: sub_10006810+1Ej
					; DATA XREF: .text:off_100068D8o
		mov	edi, 2		; jumptable 1000682E cases 3,4,7,8
		jmp	short loc_10006848
; ---------------------------------------------------------------------------

loc_10006843:				; CODE XREF: sub_10006810+1Ej
					; DATA XREF: .text:off_100068D8o
		mov	edi, 3		; jumptable 1000682E cases 14,15

loc_10006848:				; CODE XREF: sub_10006810+2Aj
					; sub_10006810+31j
		mov	eax, 302h
		mov	[ecx+4], edi
		cmp	[ebx+44h], ax
		ja	short loc_10006860
		mov	dword ptr [ecx], 0
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006860:				; CODE XREF: sub_10006810+44j
		mov	edx, [ebx+8D0h]
		test	edx, edx
		jnz	short loc_10006874
		mov	dword ptr [ecx], 4
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10006874:				; CODE XREF: sub_10006810+58j
		push	esi
		xor	esi, esi
		push	ebp

loc_10006878:				; CODE XREF: sub_10006810+90j
		xor	ecx, ecx
		test	edx, edx
		jz	short loc_1000689C
		mov	eax, [ebx+8CCh]

loc_10006884:				; CODE XREF: sub_10006810+8Aj
		cmp	[eax+4], edi
		jnz	short loc_10006894
		movzx	ebp, ds:byte_1002B018[esi]
		cmp	[eax], ebp
		jz	short loc_100068B6

loc_10006894:				; CODE XREF: sub_10006810+77j
		inc	ecx
		add	eax, 8
		cmp	ecx, edx
		jb	short loc_10006884

loc_1000689C:				; CODE XREF: sub_10006810+6Cj
		inc	esi
		cmp	esi, 4
		jb	short loc_10006878
		push	0FFFFD07Eh
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100068B6:				; CODE XREF: sub_10006810+82j
		mov	ecx, [eax]
		mov	edx, [esp+0Ch+arg_0]
		pop	ebp
		pop	esi
		mov	[edx], ecx
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100068C4:				; CODE XREF: sub_10006810+11j
					; sub_10006810+1Ej
					; DATA XREF: ...
		push	0FFFFE030h	; jumptable 1000682E default case
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_10006810	endp

; ---------------------------------------------------------------------------
		align 4
off_100068D8	dd offset loc_10006835	; DATA XREF: sub_10006810+1Er
		dd offset loc_1000683C	; jump table for switch	statement
		dd offset loc_10006843
		dd offset loc_100068C4
byte_100068E8	db	0,     0,     0,     1 ; DATA XREF: sub_10006810+17r
		db	1,     0,     0,     1 ; indirect table	for switch statement
		db	1,     0,     0,     3
		db	3,     0,     2,     2
		db	0,     0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006900	proc near		; CODE XREF: sub_10008220+1A7p
					; sub_10008220+1F7p ...

var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+20h+var_4], eax
		mov	eax, [esp+20h+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+28h+arg_0]
		mov	ebx, [ebp+22Ch]
		push	esi
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10006992
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	ecx, ds:dword_1002ADFC[eax*8]
		push	ebx
		lea	edx, [esp+30h+var_10]
		push	3
		push	edx
		mov	[esp+38h+var_10], 370h
		mov	[esp+38h+var_C], 1
		mov	[esp+38h+var_8], ecx
		call	PK11_GetBestSlotMultiple
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10006992
		push	ebx
		lea	eax, [esp+30h+var_10]
		push	2
		push	eax
		call	PK11_GetBestSlotMultiple
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10006992
		push	0FFFFD054h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+20h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10006992:				; CODE XREF: sub_10006900+23j
					; sub_10006900+59j ...
		cmp	dword ptr [ebp+2F38h], 1
		jnz	short loc_100069BA
		movzx	ecx, word ptr [ebp+46h]
		push	ecx
		call	sub_10002170
		movzx	eax, ax
		mov	edx, eax
		add	esp, 4
		shr	edx, 8
		mov	[esp+2Ch+var_20], dl
		mov	[esp+2Ch+var_1F], al
		jmp	short loc_100069C8
; ---------------------------------------------------------------------------

loc_100069BA:				; CODE XREF: sub_10006900+99j
		mov	al, [ebp+47h]
		mov	cl, [ebp+46h]
		mov	[esp+2Ch+var_20], al
		mov	[esp+2Ch+var_1F], cl

loc_100069C8:				; CODE XREF: sub_10006900+B8j
		push	ebx
		push	0
		lea	eax, [esp+34h+var_1C]
		push	eax
		lea	edx, [esp+38h+var_20]
		push	370h
		push	esi
		mov	[esp+40h+var_18], edx
		mov	[esp+40h+var_14], 2
		call	PK11_KeyGen
		add	esp, 14h
		mov	ebx, eax
		test	edi, edi
		jnz	short loc_100069FD
		push	esi
		call	PK11_FreeSlot
		add	esp, 4

loc_100069FD:				; CODE XREF: sub_10006900+F2j
		test	ebx, ebx
		jnz	short loc_10006A0E
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4

loc_10006A0E:				; CODE XREF: sub_10006900+FFj
		mov	ecx, [esp+2Ch+var_4]
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 20h
		retn
sub_10006900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006A30	proc near		; CODE XREF: sub_100078C0+36p
		push	ebx
		mov	ebx, [edi+46Ch]
		push	ebp
		push	esi
		mov	esi, [edi+470h]
		xor	ebp, ebp
		cmp	esi, ebp
		jz	short loc_10006A57

loc_10006A45:				; CODE XREF: sub_10006A30+25j
		mov	eax, [esi+4]
		push	eax
		call	CERT_DestroyCertificate
		mov	esi, [esi]
		add	esp, 4
		cmp	esi, ebp
		jnz	short loc_10006A45

loc_10006A57:				; CODE XREF: sub_10006A30+13j
		cmp	ebx, ebp
		jz	short loc_10006A65
		push	ebp
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_10006A65:				; CODE XREF: sub_10006A30+29j
		pop	esi
		mov	[edi+470h], ebp
		mov	[edi+46Ch], ebp
		pop	ebp
		pop	ebx
		retn
sub_10006A30	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10006A80:				; DATA XREF: sub_1000C7F0+76o
		push	0FFFFE8D5h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006AA0	proc near		; CODE XREF: sub_1000C9C0+92p
					; sub_1000CB90+D0p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	eax, [esp+arg_0]
		mov	edx, [eax+44h]
		sub	esp, 18h
		push	esi
		push	edi
		xor	edi, edi
		cmp	edx, edi
		jz	loc_10006B59
		cmp	[eax+40h], edi
		jnz	loc_10006B59
		mov	esi, 303h
		mov	[esp+20h+var_C], edi
		mov	[esp+20h+var_8], edi
		mov	[esp+20h+var_4], edi
		mov	ecx, 80000373h
		cmp	[eax+58h], si
		jb	short loc_10006AE0
		mov	ecx, 0CE534365h

loc_10006AE0:				; CODE XREF: sub_10006AA0+39j
		lea	eax, [esp+20h+var_C]
		push	eax
		push	edx
		push	108h
		push	ecx
		call	PK11_CreateContextBySymKey
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	short loc_10006B03
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10006B03:				; CODE XREF: sub_10006AA0+58j
		push	esi
		call	PK11_DigestBegin
		mov	ecx, [esp+24h+arg_8]
		mov	edx, [esp+24h+arg_4]
		push	ecx
		push	edx
		push	esi
		mov	edi, eax
		call	PK11_DigestOp
		mov	ecx, [esp+30h+arg_C]
		or	edi, eax
		mov	eax, [esp+30h+arg_10]
		push	eax
		push	ecx
		push	esi
		call	PK11_DigestOp
		mov	edx, [esp+3Ch+arg_18]
		mov	ecx, [esp+3Ch+arg_14]
		push	edx
		or	edi, eax
		lea	eax, [esp+40h+arg_0]
		push	eax
		push	ecx
		push	esi
		call	PK11_DigestFinal
		push	1
		push	esi
		or	edi, eax
		call	PK11_DestroyContext
		add	esp, 34h
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10006B59:				; CODE XREF: sub_10006AA0+10j
					; sub_10006AA0+19j
		mov	edx, [esp+20h+arg_C]
		xor	ecx, ecx
		mov	[esp+20h+var_8], ecx
		mov	[esp+20h+var_4], ecx
		mov	[esp+20h+var_14], ecx
		mov	[esp+20h+var_10], ecx
		mov	ecx, [esp+20h+arg_10]
		mov	[esp+20h+var_8], edx
		mov	edx, [esp+20h+arg_14]
		mov	[esp+20h+var_14], edx
		mov	[esp+20h+var_4], ecx
		mov	ecx, [esp+20h+arg_18]
		mov	edx, 303h
		mov	[esp+20h+var_C], edi
		mov	[esp+20h+var_18], edi
		mov	[esp+20h+var_10], ecx
		push	edi
		cmp	[eax+58h], dx
		jb	short loc_10006BC6
		lea	ecx, [esp+24h+var_18]
		push	ecx
		mov	ecx, [esp+28h+arg_4]
		lea	edx, [esp+28h+var_C]
		push	edx
		push	ecx
		add	eax, 1130h
		push	eax
		push	4
		call	sub_10022DA0
		add	esp, 18h
		mov	edi, eax
		pop	edi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10006BC6:				; CODE XREF: sub_10006AA0+FDj
		lea	edx, [esp+24h+var_18]
		push	edx
		mov	edx, [esp+28h+arg_4]
		lea	ecx, [esp+28h+var_C]
		push	ecx
		push	edx
		add	eax, 1130h
		push	eax
		call	sub_10022B20
		add	esp, 14h
		mov	edi, eax
		pop	edi
		pop	esi
		add	esp, 18h
		retn
sub_10006AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006BF0	proc near		; CODE XREF: sub_1000C9C0+1AFp

Str		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= word ptr -0A8h
var_A6		= byte ptr -0A6h
var_66		= byte ptr -66h
var_65		= byte ptr -65h
var_5		= byte ptr -5
var_4		= dword	ptr -4

		sub	esp, 0B4h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B4h+var_4], eax
		cmp	File, 0
		jz	loc_10006E8A
		mov	eax, [ebx+450h]
		mov	ecx, [eax+44h]
		push	ecx
		call	PK11_ExtractKeyValue
		add	esp, 4
		test	eax, eax
		jnz	loc_10006E8A
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10006C40
		mov	edx, [ebx+25Ch]
		push	edx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_10006C40:				; CODE XREF: sub_10006BF0+3Fj
		mov	eax, [ebx+450h]
		mov	ecx, [eax+44h]
		push	ebp
		push	ecx
		call	PK11_GetKeyData
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10006E74
		cmp	dword ptr [ebp+4], 0
		jz	loc_10006E74
		cmp	dword ptr [ebp+8], 30h
		jnz	loc_10006E74
		mov	edx, ds:dword_1002B044
		mov	ecx, ds:dword_1002B04C
		mov	eax, ds:dword_1002B048
		mov	[esp+0B8h+Str],	edx
		mov	dx, ds:word_1002B050
		push	esi
		push	edi
		mov	[esp+0C0h+var_AC], ecx
		mov	[esp+0C0h+var_A8], dx
		mov	[esp+0C0h+var_B0], eax
		lea	ecx, [esp+0C0h+var_A6]
		lea	edx, [ebx+4A1h]
		mov	edi, 8
		jmp	short loc_10006CB0
; ---------------------------------------------------------------------------
		align 10h

loc_10006CB0:				; CODE XREF: sub_10006BF0+BBj
					; sub_10006BF0+145j
		movzx	esi, byte ptr [edx-1]
		mov	eax, esi
		shr	eax, 4
		movzx	eax, ds:byte_1002AFBC[eax]
		mov	[ecx], al
		and	esi, 0Fh
		movzx	eax, ds:byte_1002AFBC[esi]
		movzx	esi, byte ptr [edx]
		mov	[ecx+1], al
		mov	eax, esi
		shr	eax, 4
		movzx	eax, ds:byte_1002AFBC[eax]
		mov	[ecx+2], al
		and	esi, 0Fh
		movzx	eax, ds:byte_1002AFBC[esi]
		movzx	esi, byte ptr [edx+1]
		mov	[ecx+3], al
		mov	eax, esi
		shr	eax, 4
		movzx	eax, ds:byte_1002AFBC[eax]
		mov	[ecx+4], al
		and	esi, 0Fh
		movzx	eax, ds:byte_1002AFBC[esi]
		movzx	esi, byte ptr [edx+2]
		mov	[ecx+5], al
		mov	eax, esi
		shr	eax, 4
		movzx	eax, ds:byte_1002AFBC[eax]
		mov	[ecx+6], al
		and	esi, 0Fh
		movzx	eax, ds:byte_1002AFBC[esi]
		mov	[ecx+7], al
		add	ecx, 8
		add	edx, 4
		dec	edi
		jnz	loc_10006CB0
		mov	[esp+0C0h+var_66], 20h
		mov	ecx, [ebp+4]
		lea	eax, [esp+0C0h+var_65]
		inc	ecx
		lea	esi, [edi+8]
		jmp	short loc_10006D50
; ---------------------------------------------------------------------------
		align 10h

loc_10006D50:				; CODE XREF: sub_10006BF0+15Bj
					; sub_10006BF0+230j
		movzx	edx, byte ptr [ecx-1]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax], dl
		movzx	edx, byte ptr [ecx-1]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+1], dl
		movzx	edx, byte ptr [ecx]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+2], dl
		movzx	edx, byte ptr [ecx]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+3], dl
		movzx	edx, byte ptr [ecx+1]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+4], dl
		movzx	edx, byte ptr [ecx+1]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+5], dl
		movzx	edx, byte ptr [ecx+2]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+6], dl
		movzx	edx, byte ptr [ecx+2]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+7], dl
		movzx	edx, byte ptr [ecx+3]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+8], dl
		movzx	edx, byte ptr [ecx+3]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+9], dl
		movzx	edx, byte ptr [ecx+4]
		shr	edx, 4
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+0Ah], dl
		movzx	edx, byte ptr [ecx+4]
		and	edx, 0Fh
		movzx	edx, ds:byte_1002AFBC[edx]
		mov	[eax+0Bh], dl
		add	eax, 0Ch
		add	ecx, 6
		dec	esi
		jnz	loc_10006D50
		test	byte ptr [ebx+16h], 1
		pop	edi
		mov	[esp+0BCh+var_5], 0Ah
		pop	esi
		jnz	short loc_10006E45
		mov	eax, [ebx+25Ch]
		push	eax
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10006E45:				; CODE XREF: sub_10006BF0+244j
		mov	ecx, File
		push	ecx		; File
		push	1		; Count
		lea	edx, [esp+0C0h+Str]
		push	0B0h		; Size
		push	edx		; Str
		call	ds:fwrite
		add	esp, 10h
		cmp	eax, 1
		jnz	short loc_10006E89
		mov	eax, File
		push	eax		; File
		call	ds:fflush
		jmp	short loc_10006E86
; ---------------------------------------------------------------------------

loc_10006E74:				; CODE XREF: sub_10006BF0+67j
					; sub_10006BF0+71j ...
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10006E89
		mov	ecx, [ebx+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util

loc_10006E86:				; CODE XREF: sub_10006BF0+282j
		add	esp, 4

loc_10006E89:				; CODE XREF: sub_10006BF0+274j
					; sub_10006BF0+288j
		pop	ebp

loc_10006E8A:				; CODE XREF: sub_10006BF0+1Bj
					; sub_10006BF0+35j
		mov	ecx, [esp+0B4h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B4h
		retn
sub_10006BF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006EA0	proc near		; CODE XREF: sub_1000CB90+435p
					; sub_10015700+17Ap

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [eax+22Ch]
		mov	edx, [esp+10h+arg_8]
		push	ebx
		mov	ebx, [eax+4Ch]
		mov	eax, [edx+44h]
		push	ebp
		push	esi
		push	edi
		push	eax
		xor	edi, edi
		mov	[esp+24h+var_10], ecx
		call	PK11_GetSlotFromKey
		mov	ebp, [esp+24h+arg_4]
		add	esp, 4
		mov	esi, eax
		push	esi
		test	ebx, ebx
		jnz	loc_10006F68
		call	PK11_GetCurrentWrapIndex
		mov	ebx, eax
		push	esi
		mov	[esp+28h+arg_0], ebx
		mov	[ebp+0D0h], bx
		call	PK11_GetSlotSeries
		mov	edi, eax
		push	esi
		mov	[ebp+0D2h], di
		call	PK11_GetSlotID
		push	esi
		mov	[ebp+0CCh], eax
		call	PK11_GetModuleID
		mov	ecx, [esp+30h+var_10]
		push	ecx
		push	edi
		push	0FFFFFFFFh
		push	ebx
		push	esi
		mov	[ebp+0C8h], eax
		mov	byte ptr [ebp+0DEh], 1
		call	PK11_GetWrapKey
		mov	edi, eax
		add	esp, 24h
		test	edi, edi
		jnz	short loc_10006F95
		push	esi
		call	PK11_GetBestWrapMechanism
		mov	ebx, eax
		push	ebx
		push	esi
		call	PK11_GetBestKeyLength
		mov	edx, [esp+2Ch+var_10]
		push	edx
		push	eax
		push	edi
		push	ebx
		push	esi
		call	PK11_KeyGen
		mov	edi, eax
		add	esp, 20h
		test	edi, edi
		jz	short loc_10006FA0
		mov	eax, [esp+20h+arg_0]
		push	edi
		push	eax
		push	esi
		call	PK11_SetWrapKey
		add	esp, 0Ch
		jmp	short loc_10006FA0
; ---------------------------------------------------------------------------

loc_10006F68:				; CODE XREF: sub_10006EA0+33j
		call	PK11_GetBestWrapMechanism
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10006FA0
		mov	ecx, [esp+20h+arg_C]
		mov	edx, [esp+20h+arg_0]
		push	ecx
		mov	ecx, [esp+24h+var_10]
		push	edx
		mov	edx, esi
		call	sub_10006050
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_10006FA0

loc_10006F95:				; CODE XREF: sub_10006EA0+8Fj
		push	edi
		call	PK11_GetMechanism
		mov	ebx, eax
		add	esp, 4

loc_10006FA0:				; CODE XREF: sub_10006EA0+B5j
					; sub_10006EA0+C6j ...
		push	esi
		mov	[ebp+0B4h], ebx
		call	PK11_FreeSlot
		add	esp, 4
		test	edi, edi
		jz	short loc_10006FFC
		mov	edx, [esp+20h+arg_8]
		lea	eax, [ebp+80h]
		lea	ecx, [esp+20h+var_C]
		push	ecx
		mov	[esp+24h+var_8], eax
		mov	eax, [edx+44h]
		push	eax
		push	edi
		push	0
		push	ebx
		mov	[esp+34h+var_4], 30h
		call	PK11_WrapSymKey
		mov	cx, word ptr [esp+34h+var_4]
		push	edi
		mov	esi, eax
		mov	[ebp+0B0h], cx
		call	PK11_FreeSymKey
		add	esp, 18h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10006FFC:				; CODE XREF: sub_10006EA0+111j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 10h
		retn
sub_10006EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007010	proc near		; CODE XREF: sub_1000CB90+4C0p
					; DATA XREF: sub_1000CB90+49Fo

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		mov	[esi+1DCh], edi
		cmp	[esi+854h], edi
		jz	short loc_10007042
		mov	ecx, [esi+0F4h]
		lea	eax, [esi+858h]
		push	eax
		push	ecx
		call	sub_10018140
		add	esp, 8
		mov	[esi+854h], edi

loc_10007042:				; CODE XREF: sub_10007010+14j
		cmp	[esi+8C4h], edi
		jz	short loc_10007062
		mov	edx, [esi+0F4h]
		mov	eax, [esi+84h]
		push	edx
		call	eax
		add	esp, 4
		mov	[esi+8C4h], edi

loc_10007062:				; CODE XREF: sub_10007010+38j
		push	esi
		mov	[esi+8C8h], edi
		mov	dword ptr [esi+4C0h], 0Dh
		call	sub_100185A0
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10007010	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007080	proc near		; CODE XREF: sub_1000F790+46Bp
		mov	ecx, [edi+4]
		push	ebx
		lea	ebx, [eax+1]
		cmp	ebx, ecx
		jbe	short loc_10007090
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007090:				; CODE XREF: sub_10007080+9j
		mov	eax, [edi]
		push	esi
		movzx	esi, byte ptr [eax+ecx-1]
		sub	edx, esi
		mov	eax, ecx
		sub	eax, esi
		sub	eax, ebx
		dec	edx
		not	eax
		not	edx
		sar	eax, 1Fh
		sar	edx, 1Fh
		and	eax, edx
		inc	esi
		and	esi, eax
		sub	ecx, esi
		pop	esi
		mov	[edi+4], ecx
		not	eax
		pop	ebx
		retn
sub_10007080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100070C0	proc near		; CODE XREF: sub_1000F790+473p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, [ebp+4]
		inc	eax
		cmp	eax, esi
		jbe	short loc_100070D6
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100070D6:				; CODE XREF: sub_100070C0+Dj
		mov	ecx, [ebp+0]
		movzx	edx, byte ptr [ecx+esi-1]
		push	ebx
		push	edi
		lea	edi, [ecx+esi-1]
		mov	ecx, esi
		sub	ecx, edx
		sub	ecx, eax
		not	ecx
		mov	ebx, 0FFh
		lea	eax, [esi-1]
		sar	ecx, 1Fh
		cmp	eax, ebx
		jnb	short loc_100070FD
		mov	ebx, eax

loc_100070FD:				; CODE XREF: sub_100070C0+39j
		test	ebx, ebx
		jz	short loc_10007128
		mov	ebp, edx
		mov	[esp+14h+var_4], ebx

loc_10007107:				; CODE XREF: sub_100070C0+62j
		movzx	ebx, byte ptr [edi]
		mov	eax, ebp
		not	eax
		sar	eax, 1Fh
		movzx	eax, al
		xor	ebx, edx
		and	eax, ebx
		not	eax
		and	ecx, eax
		dec	edi
		dec	ebp
		dec	[esp+14h+var_4]
		jnz	short loc_10007107
		mov	ebp, [esp+14h+arg_0]

loc_10007128:				; CODE XREF: sub_100070C0+3Fj
		mov	eax, ecx
		shr	eax, 4
		and	ecx, eax
		mov	eax, ecx
		shr	eax, 2
		and	ecx, eax
		lea	eax, [ecx+ecx]
		and	eax, ecx
		shl	eax, 1Eh
		sar	eax, 1Fh
		inc	edx
		and	edx, eax
		pop	edi
		sub	esi, edx
		pop	ebx
		mov	[ebp+4], esi
		pop	esi
		not	eax
		pop	ebp
		pop	ecx
		retn
sub_100070C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007160	proc near		; CODE XREF: sub_1000F790+522p

var_55		= byte ptr -55h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Dst		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		mov	eax, [esp+58h+arg_8]
		mov	ecx, [esp+58h+arg_0]
		push	ebx
		mov	ebx, [ecx+4]
		push	ebp
		mov	[esp+60h+var_4C], eax
		mov	eax, [esp+60h+arg_4]
		mov	[esp+60h+var_54], ebx
		sub	ebx, esi
		lea	edx, [esi+100h]
		xor	ebp, ebp
		push	edi
		mov	[esp+64h+var_50], ebx
		cmp	eax, edx
		jbe	short loc_100071A4
		mov	ebp, eax
		sub	ebp, esi
		sub	ebp, 100h

loc_100071A4:				; CODE XREF: sub_10007160+38j
		mov	edi, esi
		and	edi, 0FFFFFFFEh
		shl	edi, 17h
		mov	eax, edi
		sub	eax, ebp
		add	eax, ebx
		xor	edx, edx
		div	esi
		push	esi		; Size
		lea	eax, [esp+68h+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+70h+var_48], edi
		mov	[esp+70h+var_55], dl
		call	memset
		add	esp, 0Ch
		cmp	ebp, [esp+64h+arg_4]
		jnb	short loc_1000721F

loc_100071D4:				; CODE XREF: sub_10007160+B9j
		xor	edi, edi
		test	esi, esi
		jz	short loc_10007215
		mov	eax, ebp
		mov	ecx, ebx
		sub	eax, ebx
		sub	ecx, [esp+64h+var_54]

loc_100071E4:				; CODE XREF: sub_10007160+AFj
		cmp	ebp, [esp+64h+arg_4]
		jnb	short loc_1000721B
		lea	edx, [ecx+eax]
		not	edx
		sar	edx, 1Fh
		mov	ebx, eax
		not	ebx
		sar	ebx, 1Fh
		not	dl
		and	dl, bl
		mov	ebx, [esp+64h+arg_0]
		mov	ebx, [ebx]
		and	dl, [ebx+ebp]
		inc	edi
		or	byte ptr [esp+edi+64h+var_48+3], dl
		inc	ebp
		inc	eax
		cmp	edi, esi
		jb	short loc_100071E4
		mov	ebx, [esp+64h+var_50]

loc_10007215:				; CODE XREF: sub_10007160+78j
		cmp	ebp, [esp+64h+arg_4]
		jb	short loc_100071D4

loc_1000721B:				; CODE XREF: sub_10007160+88j
		mov	edi, [esp+64h+var_48]

loc_1000721F:				; CODE XREF: sub_10007160+72j
		mov	ebx, [esp+64h+var_4C]
		push	esi		; Size
		push	0		; Val
		push	ebx		; Dst
		call	memset
		add	esp, 0Ch
		mov	[esp+64h+var_54], 0
		test	esi, esi
		jz	short loc_10007278
		movzx	eax, [esp+64h+var_55]
		sub	edi, eax
		add	edi, esi

loc_10007244:				; CODE XREF: sub_10007160+116j
		xor	edx, edx
		mov	eax, edi
		div	esi
		mov	ecx, [esp+64h+var_54]
		mov	cl, [esp+ecx+64h+Dst]
		xor	eax, eax
		movzx	ebp, dl

loc_10007257:				; CODE XREF: sub_10007160+108j
		movzx	edx, al
		xor	edx, ebp
		dec	edx
		sar	edx, 1Fh
		and	dl, cl
		or	[ebx+eax], dl
		inc	eax
		cmp	eax, esi
		jb	short loc_10007257
		mov	eax, [esp+64h+var_54]
		inc	eax
		inc	edi
		mov	[esp+64h+var_54], eax
		cmp	eax, esi
		jb	short loc_10007244

loc_10007278:				; CODE XREF: sub_10007160+D9j
		mov	ecx, [esp+64h+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
sub_10007160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007290	proc near		; CODE XREF: sub_10007320+5Bp
					; sub_10007320+67p

arg_0		= dword	ptr  4

		mov	eax, offset loc_100033F0
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		xor	eax, eax
		lea	ecx, [esi+1218h]
		push	ecx		; Dst
		mov	dword ptr [esi], offset	dword_1002A5D0
		mov	dword ptr [esi+4], offset dword_1002AE50
		mov	[esi+1Ch], eax
		mov	[esi+28h], eax
		mov	[esi+2Ch], eax
		mov	[esi+30h], eax
		mov	[esi+38h], eax
		mov	[esi+0Ch], eax
		mov	[esi+44h], eax
		mov	[esi+40h], eax
		mov	[esi+1134h], eax
		mov	[esi+1138h], eax
		mov	[esi+60h], eax
		mov	[esi+64h], eax
		mov	[esi+68h], eax
		mov	[esi+8C8h], eax
		mov	[esi+8CCh], eax
		mov	[esi+8D0h], eax
		mov	[esi+48h], eax
		mov	[esi+4Ch], eax
		mov	[esi+50h], eax
		mov	[esi+54h], eax
		mov	[esi+1210h], ax
		call	sub_10002630
		mov	edx, [esp+4+arg_0]
		mov	ax, [edx+1Ah]
		add	esp, 4
		mov	[esi+58h], ax
		retn
sub_10007290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007320	proc near		; CODE XREF: sub_10007C90+2Ep
					; sub_100086F0+1Ep ...
		push	ebp
		xor	ebp, ebp
		cmp	[edi+478h], ebp
		jnz	loc_1000745D
		push	ebx
		mov	ebx, 1
		mov	[edi+468h], ebx
		test	[edi+16h], bl
		jnz	short loc_1000734F
		mov	eax, [edi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1000734F:				; CODE XREF: sub_10007320+1Ej
		push	esi
		lea	esi, [edi+928h]
		lea	eax, [edi+1BD0h]
		push	edi
		mov	[edi+450h], esi
		mov	[edi+448h], esi
		mov	[edi+454h], eax
		mov	[edi+44Ch], eax
		mov	[edi+844h], ebp
		call	sub_10007290
		mov	esi, [edi+44Ch]
		push	edi
		call	sub_10007290
		mov	ecx, [edi+4Ch]
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 0FFFFFFFAh
		add	ecx, 6
		push	edi
		mov	[edi+4C0h], ecx
		call	sub_100219E0
		add	esp, 0Ch
		mov	[edi+8B8h], eax
		pop	esi
		test	[edi+16h], bl
		jnz	short loc_100073C3
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_100073C3:				; CODE XREF: sub_10007320+92j
		push	9Ch		; Size
		lea	eax, [edi+2E9Ch]
		push	ebp		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		cmp	[edi+2F38h], ebx
		jnz	short loc_10007424
		lea	eax, [edi+8D8h]
		xor	ecx, ecx
		xor	edx, edx
		push	ebp
		push	edi
		mov	[edi+8D4h], cx
		mov	[edi+8E2h], dx
		mov	dword ptr [edi+920h], 3E8h
		mov	[edi+924h], ebp
		mov	dword ptr [edi+8F0h], 0FFFFFFFFh
		mov	[eax], eax
		mov	[edi+8DCh], eax
		call	sub_100024B0
		add	esp, 8

loc_10007424:				; CODE XREF: sub_10007320+BEj
		xor	eax, eax
		mov	[edi+4C8h], ebp
		mov	[edi+4D0h], ebp
		mov	[edi+854h], ebp
		mov	[edi+858h], eax
		mov	[edi+85Ch], eax
		mov	[edi+860h], eax
		mov	[edi+864h], eax
		mov	[edi+868h], eax
		mov	[edi+478h], ebx
		pop	ebx

loc_1000745D:				; CODE XREF: sub_10007320+9j
		xor	eax, eax
		pop	ebp
		retn
sub_10007320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007470	proc near		; CODE XREF: sub_10007520+89p
					; SSL_ConfigSecureServerWithCertChain+133p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	short loc_1000749F
		mov	esi, [esp+8+arg_4]
		test	esi, esi
		jz	short loc_1000749F
		push	0Ch
		call	PORT_ZAlloc_Util
		add	esp, 4
		test	eax, eax
		jz	short loc_100074AC
		mov	[eax], edi
		pop	edi
		mov	[eax+4], esi
		mov	dword ptr [eax+8], 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000749F:				; CODE XREF: sub_10007470+8j
					; sub_10007470+10j
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4

loc_100074AC:				; CODE XREF: sub_10007470+1Ej
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10007470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100074C0	proc near		; CODE XREF: sub_10018D40+AFp
					; SSL_ReconfigFD+205p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+8]
		push	eax
		call	ds:__imp_PR_AtomicIncrement
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
sub_100074C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100074E0	proc near		; CODE XREF: sub_1000C1C0+148p
					; sub_10018D40+97p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+8]
		push	eax
		call	ds:PR_AtomicDecrement
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000751E
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10007505
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10007505:				; CODE XREF: sub_100074E0+1Aj
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10007515
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_10007515:				; CODE XREF: sub_100074E0+2Aj
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1000751E:				; CODE XREF: sub_100074E0+14j
		pop	esi
		retn
sub_100074E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007520	proc near		; CODE XREF: sub_10018D40+E6p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, [edi+1F8h]
		xor	ebx, ebx
		cmp	esi, ebx
		jz	short loc_1000756C
		lea	eax, [esi+8]
		push	eax
		call	ds:PR_AtomicDecrement
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000756C
		mov	eax, [esi]
		cmp	eax, ebx
		jz	short loc_10007553
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10007553:				; CODE XREF: sub_10007520+28j
		mov	eax, [esi+4]
		cmp	eax, ebx
		jz	short loc_10007563
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_10007563:				; CODE XREF: sub_10007520+38j
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_1000756C:				; CODE XREF: sub_10007520+11j
					; sub_10007520+22j
		mov	ecx, [edi+304h]
		mov	[edi+1F8h], ebx
		mov	edx, [ecx]
		push	edx
		call	PK11_GetPrivateModulusLen
		add	esp, 4
		cmp	eax, 40h
		jle	short loc_100075CF
		push	ebx
		lea	eax, [esp+10h+arg_0]
		push	eax
		push	200h
		call	SECKEY_CreateRSAPrivateKey
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_100075BB
		mov	ecx, [esp+0Ch+arg_0]
		cmp	ecx, ebx
		jz	short loc_100075BB
		push	ecx
		push	eax
		call	sub_10007470
		add	esp, 8
		mov	[edi+1F8h], eax
		cmp	eax, ebx
		jnz	short loc_100075CF

loc_100075BB:				; CODE XREF: sub_10007520+7Dj
					; sub_10007520+85j
		push	0FFFFE064h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100075CF:				; CODE XREF: sub_10007520+66j
					; sub_10007520+99j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_10007520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100075E0	proc near		; CODE XREF: SSL_CipherPolicySet+37j
					; NSS_SetDomesticPolicy:loc_1001FE10p

arg_0		= word ptr  4
arg_4		= byte ptr  8

		mov	cx, [esp+arg_0]
		xor	eax, eax
		jmp	short loc_100075F0
; ---------------------------------------------------------------------------
		align 10h

loc_100075F0:				; CODE XREF: sub_100075E0+7j
					; sub_100075E0+1Ej
		cmp	word_10037000[eax*4], cx
		jz	short loc_10007611
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_100075F0
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10007611:				; CODE XREF: sub_100075E0+18j
		lea	eax, word_10037000[eax*4]
		test	eax, eax
		jnz	short loc_10007620
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10007620:				; CODE XREF: sub_100075E0+3Aj
		mov	cl, [esp+arg_4]
		mov	[eax+2], cl
		xor	eax, eax
		retn
sub_100075E0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPolicyGet

loc_10007630:				; CODE XREF: SSL_CipherPolicyGet+55j
		mov	cx, word ptr [esp+arg_0]
		xor	eax, eax
		jmp	short loc_10007640
; END OF FUNCTION CHUNK	FOR SSL_CipherPolicyGet
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPolicyGet

loc_10007640:				; CODE XREF: SSL_CipherPolicyGet-152F9j
					; SSL_CipherPolicyGet-152E2j
		cmp	word_10037000[eax*4], cx
		jz	short loc_10007669
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_10007640
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000765D:				; CODE XREF: SSL_CipherPolicyGet-152BEj
		mov	edx, [esp+arg_4]
		xor	ecx, ecx
		or	eax, 0FFFFFFFFh
		mov	[edx], ecx
		retn
; ---------------------------------------------------------------------------

loc_10007669:				; CODE XREF: SSL_CipherPolicyGet-152E8j
		lea	eax, word_10037000[eax*4]
		test	eax, eax
		jz	short loc_1000765D
		movzx	ecx, byte ptr [eax+2]
		mov	edx, [esp+arg_4]
		xor	eax, eax
		mov	[edx], ecx
		retn
; END OF FUNCTION CHUNK	FOR SSL_CipherPolicyGet
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007690	proc near		; CODE XREF: SSL_CipherPrefSetDefault:loc_1001C9FAp

arg_0		= word ptr  4
arg_4		= byte ptr  8

		mov	cx, [esp+arg_0]
		xor	eax, eax
		jmp	short loc_100076A0
; ---------------------------------------------------------------------------
		align 10h

loc_100076A0:				; CODE XREF: sub_10007690+7j
					; sub_10007690+1Ej
		cmp	word_10037000[eax*4], cx
		jz	short loc_100076C1
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_100076A0
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100076C1:				; CODE XREF: sub_10007690+18j
		lea	eax, word_10037000[eax*4]
		test	eax, eax
		jnz	short loc_100076D0
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100076D0:				; CODE XREF: sub_10007690+3Aj
		mov	cl, [eax+3]
		xor	cl, [esp+arg_4]
		and	cl, 1
		xor	[eax+3], cl
		xor	eax, eax
		retn
sub_10007690	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR SSL_CipherPrefGetDefault

loc_100076E0:				; CODE XREF: SSL_CipherPrefGetDefault+55j
		mov	cx, word ptr [esp+arg_0]
		xor	eax, eax
		jmp	short loc_100076F0
; END OF FUNCTION CHUNK	FOR SSL_CipherPrefGetDefault
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPrefGetDefault

loc_100076F0:				; CODE XREF: SSL_CipherPrefGetDefault-15329j
					; SSL_CipherPrefGetDefault-15312j
		cmp	word_10037000[eax*4], cx
		jz	short loc_10007719
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_100076F0
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000770D:				; CODE XREF: SSL_CipherPrefGetDefault-152EEj
		mov	edx, [esp+arg_4]
		xor	ecx, ecx
		or	eax, 0FFFFFFFFh
		mov	[edx], ecx
		retn
; ---------------------------------------------------------------------------

loc_10007719:				; CODE XREF: SSL_CipherPrefGetDefault-15318j
		lea	eax, word_10037000[eax*4]
		test	eax, eax
		jz	short loc_1000770D
		movzx	ecx, byte ptr [eax+3]
		mov	edx, [esp+arg_4]
		and	ecx, 1
		xor	eax, eax
		mov	[edx], ecx
		retn
; END OF FUNCTION CHUNK	FOR SSL_CipherPrefGetDefault
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007740	proc near		; CODE XREF: sub_100021F0+14p
					; SSL_CipherPrefSet:loc_1001CB05p ...

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= byte ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	dx, [esp+arg_4]
		xor	eax, eax
		jmp	short loc_10007750
; ---------------------------------------------------------------------------
		align 10h

loc_10007750:				; CODE XREF: sub_10007740+Bj
					; sub_10007740+1Ej
		cmp	[ecx+eax*4+350h], dx
		jz	short loc_10007771
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_10007750
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10007771:				; CODE XREF: sub_10007740+18j
		lea	eax, [ecx+eax*4+350h]
		test	eax, eax
		jnz	short loc_10007780
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10007780:				; CODE XREF: sub_10007740+3Aj
		mov	cl, [eax+3]
		xor	cl, [esp+arg_8]
		and	cl, 1
		xor	[eax+3], cl
		xor	eax, eax
		retn
sub_10007740	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007790	proc near		; CODE XREF: SSL_CipherPrefGet+97j
					; sub_100218C0+42p

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

; FUNCTION CHUNK AT 100077A0 SIZE 00000044 BYTES

		mov	ecx, [esp+arg_0]
		mov	dx, [esp+arg_4]
		xor	eax, eax
		jmp	short loc_100077A0
sub_10007790	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_10007790

loc_100077A0:				; CODE XREF: sub_10007790+Bj
					; sub_10007790+1Ej
		cmp	[ecx+eax*4+350h], dx
		jz	short loc_100077C9
		inc	eax
		cmp	eax, 3Dh
		jl	short loc_100077A0
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4

loc_100077BD:				; CODE XREF: sub_10007790+42j
		mov	edx, [esp+arg_8]
		xor	ecx, ecx
		or	eax, 0FFFFFFFFh
		mov	[edx], ecx
		retn
; ---------------------------------------------------------------------------

loc_100077C9:				; CODE XREF: sub_10007790+18j
		lea	eax, [ecx+eax*4+350h]
		test	eax, eax
		jz	short loc_100077BD
		movzx	ecx, byte ptr [eax+3]
		mov	edx, [esp+arg_8]
		and	ecx, 1
		xor	eax, eax
		mov	[edx], ecx
		retn
; END OF FUNCTION CHUNK	FOR sub_10007790
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100077F0	proc near		; CODE XREF: sub_1001EB40+1B0p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		add	edi, 350h
		mov	ecx, 3Dh
		mov	esi, offset word_10037000
		rep movsd
		pop	edi
		pop	esi
		retn
sub_100077F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007810	proc near		; CODE XREF: sub_10010B90+47p
					; sub_10010B90+10Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	ebp
		xor	ebp, ebp
		test	eax, eax
		jnz	short loc_1000782D
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000782D:				; CODE XREF: sub_10007810+9j
		cmp	[eax+18h], bp
		lea	ecx, [eax+18h]
		jnz	short loc_10007840
		mov	eax, [esp+4+arg_8]
		mov	[eax], ebp
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10007840:				; CODE XREF: sub_10007810+24j
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jnz	short loc_10007860
		push	1
		push	1
		call	sub_10003370
		mov	ecx, [esp+10h+arg_8]
		add	esp, 8
		pop	edi
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10007860:				; CODE XREF: sub_10007810+37j
		push	ebx
		push	esi
		lea	esi, [eax+352h]
		mov	ebx, 3Dh
		lea	ecx, [ecx+0]

loc_10007870:				; CODE XREF: sub_10007810+9Dj
		mov	al, [esi+1]
		test	al, 1
		jz	short loc_100078A9
		test	al, 2
		jz	short loc_100078A9
		mov	al, [esi]
		test	al, al
		jz	short loc_100078A9
		cmp	al, 1
		ja	short loc_100078A9
		mov	ax, [esi-2]
		call	sub_10003040
		test	eax, eax
		jz	short loc_100078A9
		test	edi, edi
		jz	short loc_100078A8
		mov	byte ptr [edi],	0
		mov	dl, [esi-1]
		mov	[edi+1], dl
		mov	al, [esi-2]
		mov	[edi+2], al
		add	edi, 3

loc_100078A8:				; CODE XREF: sub_10007810+84j
		inc	ebp

loc_100078A9:				; CODE XREF: sub_10007810+65j
					; sub_10007810+69j ...
		add	esi, 4
		dec	ebx
		jnz	short loc_10007870
		mov	ecx, [esp+10h+arg_8]
		pop	esi
		pop	ebx
		pop	edi
		mov	[ecx], ebp
		xor	eax, eax
		pop	ebp
		retn
sub_10007810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100078C0	proc near		; CODE XREF: sub_1001C250+Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+458h]
		xor	esi, esi
		cmp	eax, esi
		jz	short loc_100078DB
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_100078DB:				; CODE XREF: sub_100078C0+10j
		mov	eax, [edi+45Ch]
		cmp	eax, esi
		jz	short loc_100078EE
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_100078EE:				; CODE XREF: sub_100078C0+23j
		cmp	[edi+46Ch], esi
		jz	short loc_100078FB
		call	sub_10006A30

loc_100078FB:				; CODE XREF: sub_100078C0+34j
		mov	eax, [edi+460h]
		cmp	eax, esi
		jz	short loc_10007914
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4
		mov	[edi+460h], esi

loc_10007914:				; CODE XREF: sub_100078C0+43j
		test	dword ptr [edi+14h], 8000h
		jz	short loc_10007962
		mov	eax, [edi+4C4h]
		cmp	eax, 1
		jnz	short loc_10007947
		lea	eax, [edi+668h]
		push	esi
		push	eax
		call	sub_10022760
		lea	ecx, [edi+4D8h]
		push	esi
		push	ecx
		call	sub_10022660
		add	esp, 10h
		jmp	short loc_10007962
; ---------------------------------------------------------------------------

loc_10007947:				; CODE XREF: sub_100078C0+66j
		cmp	eax, 2
		jnz	short loc_10007962
		mov	edx, [edi+7F8h]
		mov	ecx, [edx+0Ch]
		lea	eax, [edi+668h]
		push	esi
		push	eax
		call	ecx
		add	esp, 8

loc_10007962:				; CODE XREF: sub_100078C0+5Bj
					; sub_100078C0+85j ...
		mov	eax, [edi+800h]
		cmp	eax, esi
		jz	short loc_10007977
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8

loc_10007977:				; CODE XREF: sub_100078C0+AAj
		mov	eax, [edi+804h]
		cmp	eax, esi
		jz	short loc_1000798C
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8

loc_1000798C:				; CODE XREF: sub_100078C0+BFj
		mov	eax, [edi+8CCh]
		cmp	eax, esi
		jz	short loc_1000799F
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000799F:				; CODE XREF: sub_100078C0+D4j
		mov	eax, [edi+4C8h]
		cmp	eax, esi
		jz	short loc_100079C4
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[edi+4C8h], esi
		mov	[edi+4CCh], esi
		mov	[edi+4D0h], esi

loc_100079C4:				; CODE XREF: sub_100078C0+E7j
		mov	edx, [edi+818h]
		push	edx
		call	PORT_Free_Util
		lea	eax, [edi+860h]
		push	esi
		push	eax
		call	SECITEM_FreeItem_Util
		lea	ecx, [edi+928h]
		push	1
		push	ecx
		call	sub_10003D00
		lea	edx, [edi+1BD0h]
		push	1
		push	edx
		call	sub_10003D00
		add	esp, 1Ch
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_10007A27
		lea	eax, [edi+8D8h]
		push	eax
		call	sub_10002220
		mov	eax, [edi+8E4h]
		add	esp, 4
		cmp	eax, esi
		jz	short loc_10007A27
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10007A27:				; CODE XREF: sub_100078C0+143j
					; sub_100078C0+15Cj
		mov	[edi+478h], esi
		push	esi
		add	edi, 2E78h
		push	edi
		call	SECITEM_FreeItem_Util
		add	esp, 8
		pop	edi
		pop	esi
		retn
sub_100078C0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007A40	proc near		; CODE XREF: sub_100087C0+BEp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	ecx, [esp+8+arg_0]
		mov	eax, [ecx+4Ch]
		push	ebx
		push	esi
		mov	esi, [ecx+454h]
		mov	edx, [esi]
		mov	ecx, [edx+4]
		push	edi
		xor	edi, edi
		xor	ebx, ebx
		mov	[esp+14h+var_8], edi
		mov	[esp+14h+var_4], ecx
		cmp	ecx, 0Ah
		jnz	short loc_10007A8F
		mov	eax, esi
		mov	[esi+10h], edi
		mov	[esi+14h], edi
		mov	[esi+1Ch], edi
		mov	[esi+20h], edi
		mov	[esi+24h], edi
		mov	dword ptr [esi+18h], offset sub_10004370
		call	sub_10004090
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10007A8F:				; CODE XREF: sub_10007A40+27j
		push	ebp
		cmp	ecx, 9		; switch 10 cases
		ja	loc_10007C3F	; jumptable 10007A99 default case
		jmp	ds:off_10007C58[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10007AA0:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		pop	ebp		; jumptable 10007A99 case 0
		mov	eax, offset loc_100033F0
		pop	edi
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+1Ch], ebx
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10007AB8:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset sub_10022A50 ; jumptable 10007A99 case 1
		mov	dword ptr [esi+10h], offset loc_10022340
		mov	dword ptr [esi+14h], offset loc_10022370
		mov	dword ptr [esi+1Ch], offset loc_10022310
		jmp	loc_10007B99
; ---------------------------------------------------------------------------

loc_10007AD7:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	edi, [edx+8]	; jumptable 10007A99 case 2
		mov	ebp, offset loc_10022A10
		mov	dword ptr [esi+10h], offset loc_100223D0
		mov	dword ptr [esi+14h], offset loc_10022400
		mov	dword ptr [esi+1Ch], offset loc_100223A0
		jmp	loc_10007B94
; ---------------------------------------------------------------------------

loc_10007AF9:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset loc_10022990 ; jumptable 10007A99 case 3
		mov	dword ptr [esi+10h], offset loc_10022460
		mov	dword ptr [esi+14h], offset loc_10022490
		mov	dword ptr [esi+1Ch], offset loc_10022430
		jmp	short loc_10007B92
; ---------------------------------------------------------------------------

loc_10007B15:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset loc_10022990 ; jumptable 10007A99 case 4
		mov	ebx, 3
		mov	edi, eax
		mov	dword ptr [esi+10h], offset loc_10022460
		mov	dword ptr [esi+14h], offset loc_10022490
		mov	dword ptr [esi+1Ch], offset loc_10022430
		jmp	short loc_10007B99
; ---------------------------------------------------------------------------

loc_10007B38:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset sub_10022950 ; jumptable 10007A99 case 7
		mov	dword ptr [esi+10h], offset sub_100225A0
		mov	dword ptr [esi+14h], offset sub_100225E0
		mov	dword ptr [esi+1Ch], offset sub_10022570
		jmp	short loc_10007B8A
; ---------------------------------------------------------------------------

loc_10007B54:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset loc_10022CB0 ; jumptable 10007A99 case 8
		mov	dword ptr [esi+10h], offset loc_10022D20
		mov	dword ptr [esi+14h], offset loc_10022D60
		mov	dword ptr [esi+1Ch], offset loc_10022CF0
		jmp	short loc_10007B8A
; ---------------------------------------------------------------------------

loc_10007B70:				; CODE XREF: sub_10007A40+59j
					; DATA XREF: .text:off_10007C58o
		mov	ebp, offset loc_100229D0 ; jumptable 10007A99 case 9
		mov	dword ptr [esi+10h], offset loc_100224F0
		mov	dword ptr [esi+14h], offset loc_10022530
		mov	dword ptr [esi+1Ch], offset loc_100224C0

loc_10007B8A:				; CODE XREF: sub_10007A40+112j
					; sub_10007A40+12Ej
		mov	[esp+18h+var_8], 10h

loc_10007B92:				; CODE XREF: sub_10007A40+D3j
		mov	edi, eax

loc_10007B94:				; CODE XREF: sub_10007A40+B4j
		mov	ebx, 1

loc_10007B99:				; CODE XREF: sub_10007A40+92j
					; sub_10007A40+F6j
		mov	eax, [esp+18h+var_8]
		mov	ecx, [esi+8E4h]
		mov	edx, [esi+8DCh]
		push	eax
		mov	eax, [esi+8D8h]
		push	edi
		push	ebx
		push	ecx
		push	edx
		push	eax
		lea	eax, [esi+910h]
		push	eax
		call	ebp ; sub_10022A50
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_10007C3F ; jumptable 10007A99	default	case
		mov	eax, [esp+18h+var_4]
		add	eax, 0FFFFFFFDh	; switch 7 cases
		cmp	eax, 6
		ja	short loc_10007BE8 ; jumptable 10007BD8	default	case
		movzx	ecx, ds:byte_10007C88[eax]
		jmp	ds:off_10007C80[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10007BDF:				; CODE XREF: sub_10007A40+198j
					; DATA XREF: .text:off_10007C80o
		xor	edx, edx	; jumptable 10007BD8 cases 3,4,7-9
		test	edi, edi
		setz	dl
		mov	edi, edx

loc_10007BE8:				; CODE XREF: sub_10007A40+18Fj
					; sub_10007A40+198j
					; DATA XREF: ...
		mov	eax, [esp+18h+var_8] ; jumptable 10007BD8 default case
		mov	ecx, [esi+7Ch]
		mov	edx, [esi+74h]
		push	eax
		mov	eax, [esi+70h]
		push	edi
		push	ebx
		push	ecx
		push	edx
		push	eax
		lea	edi, [esi+0A8h]
		push	edi
		call	ebp ; sub_10022A50
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_10007C3F ; jumptable 10007A99	default	case
		mov	ecx, [esp+18h+arg_0]
		cmp	[ecx+4Ch], eax
		lea	eax, [esi+910h]
		jnz	short loc_10007C1C
		mov	eax, edi

loc_10007C1C:				; CODE XREF: sub_10007A40+1D8j
		mov	[esi+20h], eax
		cmp	dword ptr [ecx+4Ch], 0
		jnz	short loc_10007C2B
		lea	edi, [esi+910h]

loc_10007C2B:				; CODE XREF: sub_10007A40+1E3j
		mov	eax, esi
		mov	[esi+24h], edi
		call	sub_10004090
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10007C3F:				; CODE XREF: sub_10007A40+53j
					; sub_10007A40+59j ...
		push	0FFFFE001h	; jumptable 10007A99 default case
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 8
		retn
sub_10007A40	endp

; ---------------------------------------------------------------------------
		align 4
off_10007C58	dd offset loc_10007AA0	; DATA XREF: sub_10007A40+59r
		dd offset loc_10007AB8	; jump table for switch	statement
		dd offset loc_10007AD7
		dd offset loc_10007AF9
		dd offset loc_10007B15
		dd offset loc_10007C3F
		dd offset loc_10007C3F
		dd offset loc_10007B38
		dd offset loc_10007B54
		dd offset loc_10007B70
off_10007C80	dd offset loc_10007BDF	; DATA XREF: sub_10007A40+198r
		dd offset loc_10007BE8	; jump table for switch	statement
byte_10007C88	db	0,     0,     1,     1 ; DATA XREF: sub_10007A40+191r
		db	0,     0,     0	; indirect table for switch statement
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007C90	proc near		; CODE XREF: sub_10002830+E6p
					; sub_10002830+1AEp ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 14h
		mov	eax, [esp+14h+arg_14]
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		shr	eax, 1Ah
		and	eax, 1
		cmp	dword ptr [esi+478h], 0
		push	edi
		lea	ebp, [esi+50h]
		mov	[esp+20h+var_10], 0
		mov	[esp+20h+var_14], eax
		jnz	short loc_10007CC7
		mov	edi, esi
		call	sub_10007320
		test	eax, eax
		jnz	short loc_10007CE3

loc_10007CC7:				; CODE XREF: sub_10007C90+2Aj
		mov	edi, [esi+0F4h]
		call	sub_10004C40
		test	eax, eax
		jnz	short loc_10007CED
		push	0FFFFD053h
		call	PORT_SetError_Util
		add	esp, 4

loc_10007CE3:				; CODE XREF: sub_10007C90+35j
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10007CED:				; CODE XREF: sub_10007C90+44j
		mov	edi, [esp+20h+arg_10]
		push	ebx
		test	edi, edi
		jg	short loc_10007D06
		mov	eax, [esp+24h+var_10]
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10007D02:				; CODE XREF: sub_10007C90+30Aj
		mov	edi, [esp+24h+arg_10]

loc_10007D06:				; CODE XREF: sub_10007C90+64j
		mov	ebx, edi
		cmp	edi, 4000h
		jl	short loc_10007D15
		mov	ebx, 4000h

loc_10007D15:				; CODE XREF: sub_10007C90+7Ej
		test	byte ptr [esi+16h], 1
		jnz	short loc_10007D2A
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_10007D2A:				; CODE XREF: sub_10007C90+89j
		mov	edx, 1
		cmp	edi, edx
		jle	short loc_10007D63
		test	dword ptr [esi+14h], 800000h
		jz	short loc_10007D63
		mov	eax, [esi+450h]
		mov	ecx, 302h
		cmp	[eax+58h], cx
		jnb	short loc_10007D63
		cmp	[esp+24h+arg_8], 17h
		jnz	short loc_10007D63
		mov	eax, [eax]
		mov	[esp+24h+arg_0], 2
		cmp	[eax+10h], edx
		jz	short loc_10007D67

loc_10007D63:				; CODE XREF: sub_10007C90+A1j
					; sub_10007C90+AAj ...
		mov	[esp+24h+arg_0], edx

loc_10007D67:				; CODE XREF: sub_10007C90+D1j
		mov	ecx, [esp+24h+arg_0]
		mov	eax, [esi+450h]
		imul	ecx, 64h
		mov	edi, 302h
		lea	ecx, [ecx+ebx+1Dh]
		cmp	[eax+58h], di
		jb	short loc_10007D8D
		mov	eax, [eax]
		cmp	[eax+10h], edx
		jnz	short loc_10007D8D
		add	ecx, [eax+14h]

loc_10007D8D:				; CODE XREF: sub_10007C90+F1j
					; sub_10007C90+F8j
		cmp	ecx, [ebp+8]
		jbe	short loc_10007DA9
		push	ecx
		push	ebp
		call	sub_10018960
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	loc_10007E90
		lea	edx, [eax+1]

loc_10007DA9:				; CODE XREF: sub_10007C90+100j
		cmp	[esp+24h+arg_0], 2
		mov	eax, [esp+24h+arg_8]
		mov	ecx, [esp+24h+arg_C]
		push	ebp
		jnz	loc_10007E4F
		push	edx
		push	ecx
		xor	ecx, ecx
		cmp	[esi+2F38h], edx
		mov	edx, [esi+4Ch]
		push	eax
		mov	eax, [esp+34h+var_14]
		setz	cl
		push	eax
		mov	eax, [esi+450h]
		push	ecx
		push	edx
		push	eax
		call	sub_10004CF0
		mov	edi, eax
		add	esp, 20h
		test	edi, edi
		jnz	loc_10007E90
		mov	eax, [ebp+4]
		mov	ecx, [ebp+0]
		mov	edx, [ebp+8]
		sub	edx, eax
		add	ecx, eax
		mov	[esp+24h+var_4], edx
		mov	edx, [esp+24h+arg_C]
		mov	[esp+24h+var_C], ecx
		lea	eax, [esp+24h+var_C]
		push	eax
		mov	eax, [esp+28h+arg_8]
		inc	edx
		lea	ecx, [ebx-1]
		push	ecx
		mov	ecx, [esp+2Ch+var_14]
		push	edx
		xor	edx, edx
		cmp	dword ptr [esi+2F38h], 1
		push	eax
		mov	eax, [esi+4Ch]
		setz	dl
		push	ecx
		mov	ecx, [esi+450h]
		mov	[esp+38h+var_8], edi
		push	edx
		push	eax
		push	ecx
		call	sub_10004CF0
		mov	edi, eax
		add	esp, 20h
		test	edi, edi
		jnz	short loc_10007E90
		mov	edx, [esp+24h+var_8]
		add	[ebp+4], edx
		jmp	short loc_10007E90
; ---------------------------------------------------------------------------

loc_10007E4F:				; CODE XREF: sub_10007C90+127j
		push	ebx
		push	ecx
		push	eax
		cmp	[esi+2F38h], edx
		jz	short loc_10007E76
		mov	edx, [esp+34h+var_14]
		mov	eax, [esi+4Ch]
		mov	ecx, [esi+450h]
		push	edx
		push	0
		push	eax
		push	ecx
		call	sub_10004CF0
		add	esp, 20h
		jmp	short loc_10007E8E
; ---------------------------------------------------------------------------

loc_10007E76:				; CODE XREF: sub_10007C90+1C8j
		mov	eax, [esp+34h+arg_14]
		mov	ecx, [esp+34h+arg_4]
		shr	eax, 1Ch
		and	eax, edx
		push	eax
		push	ecx
		push	esi
		call	sub_10002340
		add	esp, 1Ch

loc_10007E8E:				; CODE XREF: sub_10007C90+1E4j
		mov	edi, eax

loc_10007E90:				; CODE XREF: sub_10007C90+110j
					; sub_10007C90+158j ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_10007EA5
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10007EA5:				; CODE XREF: sub_10007C90+204j
		test	edi, edi
		jnz	loc_10007FD4
		add	[esp+24h+arg_C], ebx
		sub	[esp+24h+arg_10], ebx
		cmp	dword ptr [esi+2E4h], 0
		mov	edi, [esp+24h+arg_14]
		ja	short loc_10007F39
		test	edi, 40000000h
		jnz	short loc_10007F39
		cmp	dword ptr [ebp+4], 0
		jbe	loc_10007F91
		mov	dword ptr [esi+2Ch], 1
		mov	eax, [ebp+4]
		mov	ecx, [ebp+0]
		and	edi, 80FFFFFFh
		push	edi
		push	eax
		push	ecx
		push	esi
		call	sub_10014560
		add	esp, 10h
		test	eax, eax
		jns	short loc_10007F0A
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	loc_10007FC7
		xor	eax, eax

loc_10007F0A:				; CODE XREF: sub_10007C90+265j
		sub	[ebp+4], eax
		mov	ecx, [ebp+4]
		jz	short loc_10007F91
		cmp	dword ptr [esi+2F38h], 1
		jz	loc_10007FAC
		mov	edx, [ebp+0]
		push	ecx
		add	edx, eax
		push	edx
		push	esi
		call	sub_10018A20
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10007FD4
		jmp	short loc_10007F91
; ---------------------------------------------------------------------------

loc_10007F39:				; CODE XREF: sub_10007C90+230j
					; sub_10007C90+238j
		mov	eax, [ebp+4]
		mov	ecx, [ebp+0]
		push	eax
		push	ecx
		push	esi
		call	sub_10018A20
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10007FD4
		mov	[ebp+4], eax
		test	edi, 40000000h
		jnz	short loc_10007F91
		push	esi
		mov	dword ptr [esi+2Ch], 1
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		jns	short loc_10007F7E
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_10007FC7

loc_10007F7E:				; CODE XREF: sub_10007C90+2DFj
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_10007F91
		or	edi, 40000000h
		mov	[esp+24h+arg_14], edi

loc_10007F91:				; CODE XREF: sub_10007C90+23Ej
					; sub_10007C90+280j ...
		add	[esp+24h+var_10], ebx
		cmp	[esp+24h+arg_10], 0
		jg	loc_10007D02
		mov	eax, [esp+24h+var_10]
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10007FAC:				; CODE XREF: sub_10007C90+289j
		push	0
		push	0FFFFE892h
		call	ds:PR_SetError
		add	esp, 8
		pop	ebx
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10007FC7:				; CODE XREF: sub_10007C90+272j
					; sub_10007C90+2ECj
		push	0FFFFD048h
		call	sub_100147C0
		add	esp, 4

loc_10007FD4:				; CODE XREF: sub_10007C90+217j
					; sub_10007C90+2A1j ...
		pop	ebx
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 14h
		retn
sub_10007C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007FE0	proc near		; DATA XREF: sub_10009320+303o
					; sub_1000D820:loc_1000DFAFo ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_8]
		push	edi
		xor	edi, edi
		mov	[esp+10h+var_4], edi
		cmp	ebp, edi
		jl	loc_1000814C
		mov	ebx, [esp+10h+arg_4]
		cmp	ebx, edi
		jz	loc_1000814C
		push	esi
		mov	esi, [esp+14h+arg_0]
		cmp	dword ptr [esi+2E4h], 400h
		jbe	short loc_10008024
		push	esi
		call	sub_1001E1F0
		add	esp, 4
		test	eax, eax
		jz	loc_10008123

loc_10008024:				; CODE XREF: sub_10007FE0+31j
		cmp	[esi+3Ch], edi
		jz	short loc_1000805C
		test	ebp, ebp
		jz	loc_100080F8
		mov	al, [ebx]
		cmp	al, [esi+3Ch]
		jz	short loc_1000804E
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4

loc_10008045:				; CODE XREF: sub_10007FE0+101j
					; sub_10007FE0+112j
		or	eax, 0FFFFFFFFh

loc_10008048:				; CODE XREF: sub_10007FE0+13Dj
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000804E:				; CODE XREF: sub_10007FE0+56j
		inc	ebx
		dec	ebp
		mov	[esp+14h+arg_8], ebp
		mov	[esp+14h+var_4], 1

loc_1000805C:				; CODE XREF: sub_10007FE0+47j
		test	ebp, ebp
		jle	loc_100080F8
		mov	ebp, [esp+14h+arg_C]

loc_10008068:				; CODE XREF: sub_10007FE0+FBj
		test	edi, edi
		jle	short loc_100080A3
		test	byte ptr [esi+16h], 1
		jnz	short loc_10008082
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10008082:				; CODE XREF: sub_10007FE0+90j
		push	0
		call	ds:PR_Sleep
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_100080A3
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100080A3:				; CODE XREF: sub_10007FE0+8Aj
					; sub_10007FE0+B1j
		mov	eax, [esp+14h+arg_8]
		sub	eax, edi
		cmp	eax, 4000h
		jl	short loc_100080B5
		mov	eax, 4000h

loc_100080B5:				; CODE XREF: sub_10007FE0+CEj
		push	ebp
		push	eax
		lea	eax, [edi+ebx]
		push	eax
		push	17h
		push	0
		push	esi
		call	sub_10007C90
		add	esp, 18h
		test	eax, eax
		js	short loc_100080DF
		add	edi, eax
		cmp	dword ptr [esi+2E4h], 0
		jnz	short loc_10008101
		cmp	[esp+14h+arg_8], edi
		jg	short loc_10008068
		jmp	short loc_100080F8
; ---------------------------------------------------------------------------

loc_100080DF:				; CODE XREF: sub_10007FE0+EAj
		test	edi, edi
		jle	loc_10008045
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	loc_10008045

loc_100080F8:				; CODE XREF: sub_10007FE0+4Bj
					; sub_10007FE0+7Ej ...
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_10008139

loc_10008101:				; CODE XREF: sub_10007FE0+F5j
		test	edi, edi
		jle	short loc_10008113
		movzx	ecx, byte ptr [edi+ebx-1]
		or	ecx, 100h
		mov	[esi+3Ch], ecx

loc_10008113:				; CODE XREF: sub_10007FE0+123j
		mov	edx, [esp+14h+var_4]
		lea	eax, [edi+edx-1]
		test	eax, eax
		jg	loc_10008048

loc_10008123:				; CODE XREF: sub_10007FE0+3Ej
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008139:				; CODE XREF: sub_10007FE0+11Fj
		mov	eax, [esp+14h+var_4]
		mov	dword ptr [esi+3Ch], 0
		pop	esi
		add	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000814C:				; CODE XREF: sub_10007FE0+10j
					; sub_10007FE0+1Cj
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
sub_10007FE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008170	proc near		; CODE XREF: sub_10008940:loc_10008958p
					; sub_10008960+87p ...
		mov	eax, [edi+0D0h]
		test	eax, eax
		jz	loc_1000821A
		mov	ecx, [edi+0D4h]
		test	ecx, ecx
		jz	loc_1000821A
		push	esi
		test	edx, 0BBFFFFFFh
		jz	short loc_100081A7
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_100081BD
; ---------------------------------------------------------------------------

loc_100081A7:				; CODE XREF: sub_10008170+23j
		push	edx
		push	ecx
		push	eax
		push	16h
		push	0
		push	edi
		call	sub_10007C90
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jns	short loc_100081E4

loc_100081BD:				; CODE XREF: sub_10008170+35j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_1000820C
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		mov	eax, esi
		mov	dword ptr [edi+0D4h], 0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100081E4:				; CODE XREF: sub_10008170+4Bj
		cmp	esi, [edi+0D4h]
		jnb	short loc_1000820A
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		mov	eax, esi
		mov	dword ptr [edi+0D4h], 0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000820A:				; CODE XREF: sub_10008170+7Aj
		xor	esi, esi

loc_1000820C:				; CODE XREF: sub_10008170+57j
		mov	eax, esi
		mov	dword ptr [edi+0D4h], 0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000821A:				; CODE XREF: sub_10008170+8j
					; sub_10008170+16j
		xor	eax, eax
		retn
sub_10008170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008220	proc near		; CODE XREF: sub_100087C0+46p

var_2C		= word ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		push	ebx
		mov	ebx, [esp+30h+arg_0]
		mov	eax, [ebx+808h]
		cmp	dword ptr [eax+14h], 0
		push	esi
		mov	esi, [ebx+454h]
		push	edi
		jnz	short loc_1000825C
		mov	ecx, 300h
		cmp	[esi+58h], cx
		ja	short loc_1000825C
		xor	edx, edx

loc_10008249:				; CODE XREF: sub_10008220+4Aj
		xor	ecx, ecx

loc_1000824B:				; CODE XREF: sub_10008220+4Ej
		mov	eax, [eax+4]
		cmp	eax, 2
		jz	short loc_10008270
		cmp	eax, 4
		jz	short loc_10008270
		xor	edi, edi
		jmp	short loc_10008275
; ---------------------------------------------------------------------------

loc_1000825C:				; CODE XREF: sub_10008220+1Aj
					; sub_10008220+25j
		mov	ecx, 303h
		mov	edx, 1
		cmp	[esi+58h], cx
		jb	short loc_10008249
		mov	ecx, edx
		jmp	short loc_1000824B
; ---------------------------------------------------------------------------

loc_10008270:				; CODE XREF: sub_10008220+31j
					; sub_10008220+36j
		mov	edi, 1

loc_10008275:				; CODE XREF: sub_10008220+3Aj
		push	ebp
		test	ecx, ecx
		jz	short loc_1000829A
		xor	edx, edx
		test	edi, edi
		setnz	dl
		mov	[esp+3Ch+var_24], 0CE534367h
		mov	[esp+3Ch+var_28], 2800h
		lea	ebp, [edx+edx-31ACBC9Ah]
		jmp	short loc_100082DC
; ---------------------------------------------------------------------------

loc_1000829A:				; CODE XREF: sub_10008220+58j
		test	edx, edx
		jz	short loc_100082BE
		xor	eax, eax
		test	edi, edi
		setnz	al
		mov	[esp+3Ch+var_24], 376h
		mov	[esp+3Ch+var_28], 2800h
		lea	ebp, [eax+eax+375h]
		jmp	short loc_100082DC
; ---------------------------------------------------------------------------

loc_100082BE:				; CODE XREF: sub_10008220+7Cj
		xor	ecx, ecx
		test	edi, edi
		setnz	cl
		mov	[esp+3Ch+var_24], 372h
		mov	[esp+3Ch+var_28], 0
		lea	ebp, [ecx+ecx+371h]

loc_100082DC:				; CODE XREF: sub_10008220+78j
					; sub_10008220+9Cj
		mov	eax, [esp+3Ch+arg_4]
		test	eax, eax
		jnz	short loc_100082ED
		cmp	[esi+44h], eax
		jnz	loc_10008464

loc_100082ED:				; CODE XREF: sub_10008220+C2j
		mov	edx, edi
		neg	edx
		sbb	edx, edx
		not	edx
		lea	ecx, [esp+3Ch+var_2C]
		and	edx, ecx
		mov	[esp+3Ch+var_4], edx
		mov	edx, 20h
		lea	ecx, [ebx+4A0h]
		mov	[esp+3Ch+var_14], ecx
		mov	[esp+3Ch+var_10], edx
		mov	[esp+3Ch+var_8], edx
		lea	ecx, [ebx+480h]
		lea	edx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_C], ecx
		mov	[esp+3Ch+var_1C], edx
		mov	[esp+3Ch+var_18], 14h
		test	eax, eax
		jz	loc_10008408
		mov	ecx, [esp+3Ch+var_28]
		mov	edx, [esp+3Ch+var_24]
		push	ecx
		push	0
		push	10Ch
		push	edx
		lea	ecx, [esp+4Ch+var_20]
		push	ecx
		push	ebp
		push	eax
		call	PK11_DeriveWithFlags
		add	esp, 1Ch
		mov	[esi+44h], eax
		test	edi, edi
		jnz	short loc_100083AF
		test	eax, eax
		jz	short loc_100083AF
		test	dword ptr [ebx+14h], 2000h
		jz	short loc_100083AF
		mov	ax, [esp+3Ch+var_2C]
		movzx	edx, al
		movzx	eax, ah
		shl	dx, 8
		or	dx, ax
		cmp	dword ptr [ebx+2F38h], 1
		movzx	eax, dx
		jnz	short loc_10008396
		push	eax
		call	sub_100021B0
		add	esp, 4
		movzx	eax, ax

loc_10008396:				; CODE XREF: sub_10008220+168j
		cmp	ax, [ebx+46h]
		jz	short loc_100083AF
		mov	ecx, [esi+44h]
		push	ecx
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword ptr [esi+44h], 0

loc_100083AF:				; CODE XREF: sub_10008220+13Dj
					; sub_10008220+141j ...
		cmp	dword ptr [esi+44h], 0
		jnz	loc_10008464
		mov	edx, [esp+3Ch+arg_4]
		push	edx
		call	PK11_GetSlotFromKey
		push	esi
		mov	edi, eax
		push	ebx
		call	sub_10006900
		push	edi
		mov	ebx, eax
		call	PK11_FreeSlot
		add	esp, 10h
		test	ebx, ebx
		jz	short loc_10008404
		mov	eax, [esp+3Ch+var_28]
		mov	ecx, [esp+3Ch+var_24]
		push	eax
		push	0
		push	10Ch
		push	ecx
		lea	edx, [esp+4Ch+var_20]
		push	edx
		push	ebp
		push	ebx
		call	PK11_DeriveWithFlags
		push	ebx
		mov	[esi+44h], eax
		call	PK11_FreeSymKey
		add	esp, 20h

loc_10008404:				; CODE XREF: sub_10008220+1B9j
		mov	ebx, [esp+3Ch+arg_0]

loc_10008408:				; CODE XREF: sub_10008220+112j
		cmp	dword ptr [esi+44h], 0
		jnz	short loc_10008464
		call	PK11_GetInternalSlot
		push	esi
		mov	edi, eax
		push	ebx
		call	sub_10006900
		push	edi
		mov	ebx, eax
		call	PK11_FreeSlot
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_10008460
		mov	eax, [esp+3Ch+var_28]
		mov	ecx, [esp+3Ch+var_24]
		push	eax
		push	0
		push	10Ch
		push	ecx
		lea	edx, [esp+4Ch+var_20]
		push	edx
		push	ebp
		push	ebx
		call	PK11_DeriveWithFlags
		add	esp, 1Ch
		mov	[esi+44h], eax
		test	eax, eax
		jnz	short loc_10008457
		mov	[esi+44h], ebx
		jmp	short loc_10008460
; ---------------------------------------------------------------------------

loc_10008457:				; CODE XREF: sub_10008220+230j
		push	ebx
		call	PK11_FreeSymKey
		add	esp, 4

loc_10008460:				; CODE XREF: sub_10008220+209j
					; sub_10008220+235j
		mov	ebx, [esp+3Ch+arg_0]

loc_10008464:				; CODE XREF: sub_10008220+C7j
					; sub_10008220+193j ...
		mov	eax, [esi+44h]
		pop	ebp
		test	eax, eax
		jnz	short loc_10008483
		push	0FFFFD051h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10008483:				; CODE XREF: sub_10008220+24Aj
		test	dword ptr [ebx+14h], 8000h
		jz	short loc_100084D6
		push	eax
		call	PK11_ExtractKeyValue
		add	esp, 4
		test	eax, eax
		jnz	short loc_100084D8
		mov	eax, [esi+44h]
		push	eax
		call	PK11_GetKeyData
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_100084DF
		mov	eax, [edi+8]
		cmp	eax, 38h
		ja	short loc_100084DF
		mov	ecx, [edi+4]
		push	eax		; Size
		push	ecx		; Src
		lea	ebx, [esi+11CCh]
		push	ebx		; Dst
		call	memcpy
		mov	[esi+1134h], ebx
		mov	edx, [edi+8]
		add	esp, 0Ch
		mov	[esi+1138h], edx

loc_100084D6:				; CODE XREF: sub_10008220+26Aj
		xor	eax, eax

loc_100084D8:				; CODE XREF: sub_10008220+277j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100084DF:				; CODE XREF: sub_10008220+289j
					; sub_10008220+291j
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 2Ch
		retn
sub_10008220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008500	proc near		; CODE XREF: sub_1000A6D0+103p
					; sub_1000D820+135p ...
		push	edi
		xor	edi, edi
		test	dword ptr [esi+14h], 8000h
		jz	loc_100085B9
		mov	eax, 303h
		cmp	[esi+44h], ax
		jb	short loc_10008592
		push	4
		call	sub_10022B60
		add	esp, 4
		mov	[esi+7F8h], eax
		cmp	eax, edi
		jnz	short loc_10008541

loc_1000852F:				; CODE XREF: sub_10008500+F0j
		push	0FFFFD07Fh
		call	sub_100147C0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10008541:				; CODE XREF: sub_10008500+2Dj
		lea	ecx, [esi+668h]
		mov	dword ptr [esi+7FCh], offset loc_10022AF0
		mov	dword ptr [esi+4C4h], 2
		mov	edx, [eax+10h]
		push	ecx
		call	edx
		add	esp, 4

loc_10008564:				; CODE XREF: sub_10008500+B7j
					; sub_10008500+F9j ...
		push	ebx
		mov	ebx, [esi+4CCh]
		cmp	ebx, edi
		jbe	loc_100086E0
		mov	eax, [esi+4C8h]
		push	eax
		mov	eax, esi
		call	sub_10005490
		add	esp, 4
		test	eax, eax
		jz	loc_100086BF
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10008592:				; CODE XREF: sub_10008500+19j
		lea	eax, [esi+4D8h]
		push	eax
		mov	dword ptr [esi+4C4h], 1
		call	sub_10022690
		lea	ecx, [esi+668h]
		push	ecx
		call	sub_10022790
		add	esp, 8
		jmp	short loc_10008564
; ---------------------------------------------------------------------------

loc_100085B9:				; CODE XREF: sub_10008500+Aj
		mov	edx, 303h
		cmp	[esi+44h], dx
		jb	short loc_10008636
		push	0BFh
		call	PK11_CreateDigestContext
		add	esp, 4
		mov	[esi+804h], eax
		cmp	eax, edi
		jz	short loc_10008624
		push	eax
		mov	dword ptr [esi+4C4h], 2
		call	PK11_DigestBegin
		add	esp, 4
		test	eax, eax
		jnz	loc_1000852F
		cmp	[esi+4Ch], edi
		jnz	loc_10008564
		push	4
		call	PK11_CreateDigestContext
		add	esp, 4
		mov	[esi+800h], eax
		cmp	eax, edi
		jz	short loc_10008624
		push	eax

loc_10008614:				; CODE XREF: sub_10008500+1BAj
		call	PK11_DigestBegin
		add	esp, 4
		test	eax, eax
		jz	loc_10008564

loc_10008624:				; CODE XREF: sub_10008500+D9j
					; sub_10008500+111j
		push	0FFFFD04Ah
		call	sub_100147C0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10008636:				; CODE XREF: sub_10008500+C2j
		push	3
		call	PK11_CreateDigestContext
		add	esp, 4
		mov	[esi+800h], eax
		cmp	eax, edi
		jnz	short loc_1000865C

loc_1000864A:				; CODE XREF: sub_10008500+1B1j
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000865C:				; CODE XREF: sub_10008500+148j
		push	4
		call	PK11_CreateDigestContext
		add	esp, 4
		mov	[esi+804h], eax
		cmp	eax, edi
		jnz	short loc_10008696
		mov	eax, [esi+800h]
		push	1
		push	eax
		call	PK11_DestroyContext
		push	0FFFFD04Ah
		mov	[esi+800h], edi
		call	sub_100147C0
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10008696:				; CODE XREF: sub_10008500+16Ej
		mov	ecx, [esi+800h]
		push	ecx
		mov	dword ptr [esi+4C4h], 1
		call	PK11_DigestBegin
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000864A
		mov	edx, [esi+804h]
		push	edx
		jmp	loc_10008614
; ---------------------------------------------------------------------------

loc_100086BF:				; CODE XREF: sub_10008500+86j
		mov	ecx, [esi+4C8h]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+4C8h], edi
		mov	[esi+4CCh], edi
		mov	[esi+4D0h], edi

loc_100086E0:				; CODE XREF: sub_10008500+6Dj
		pop	ebx
		xor	eax, eax
		pop	edi
		retn
sub_10008500	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100086F0	proc near		; CODE XREF: sub_100137A0+417p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	byte ptr [esi+16h], 1
		push	edi
		jnz	short loc_1000870C
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000870C:				; CODE XREF: sub_100086F0+Aj
		mov	edi, esi
		call	sub_10007320
		mov	edi, eax
		test	edi, edi
		jnz	loc_1000879F
		call	sub_10005430
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000879F
		mov	[esi+4A0h], eax
		mov	[esi+4A4h], eax
		mov	[esi+4A8h], eax
		mov	[esi+4ACh], eax
		mov	[esi+4B0h], eax
		mov	[esi+4B4h], eax
		mov	[esi+4B8h], eax
		mov	[esi+4BCh], eax
		mov	ecx, [esi+101h]
		mov	edx, [esi+105h]
		mov	eax, [esi+109h]
		mov	[esi+4B0h], ecx
		mov	ecx, [esi+10Dh]
		mov	[esi+4B4h], edx
		mov	edx, [esp+8+arg_4]
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		mov	[esi+4B8h], eax
		push	edx
		mov	eax, esi
		mov	[esi+4BCh], ecx
		call	sub_10005490
		add	esp, 4
		mov	edi, eax
		pop	ebx

loc_1000879F:				; CODE XREF: sub_100086F0+27j
					; sub_100086F0+36j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100087B5
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100087B5:				; CODE XREF: sub_100086F0+B3j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_100086F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100087C0	proc near		; CODE XREF: sub_10009D90+390p
					; sub_1000A1F0+D5p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		test	byte ptr [ebp+16h], 1
		push	esi
		push	edi
		jnz	short loc_100087DD
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_100087DD:				; CODE XREF: sub_100087C0+Cj
		mov	eax, [esp+10h+arg_4]
		mov	ecx, [ebp+450h]
		mov	esi, [ebp+454h]
		xor	ebx, ebx
		mov	[esp+10h+arg_0], ecx
		cmp	eax, ebx
		jnz	short loc_10008804
		cmp	[esi+1138h], ebx
		jnz	short loc_10008818
		cmp	[esi+44h], ebx
		jnz	short loc_10008818

loc_10008804:				; CODE XREF: sub_100087C0+35j
		push	eax
		push	ebp
		call	sub_10008220
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebx
		jnz	loc_10008907

loc_10008818:				; CODE XREF: sub_100087C0+3Dj
					; sub_100087C0+42j
		test	dword ptr [ebp+14h], 8000h
		jz	short loc_10008885
		cmp	[esi+1138h], ebx
		jz	short loc_10008885
		cmp	[esi+1134h], ebx
		jz	short loc_10008885
		mov	ecx, [ebp+808h]
		cmp	[ecx+14h], ebx
		jnz	short loc_1000884B
		mov	edx, 300h
		cmp	[esi+58h], dx
		ja	short loc_1000884B
		xor	eax, eax
		jmp	short loc_10008850
; ---------------------------------------------------------------------------

loc_1000884B:				; CODE XREF: sub_100087C0+7Aj
					; sub_100087C0+85j
		mov	eax, 1

loc_10008850:				; CODE XREF: sub_100087C0+89j
		mov	dword ptr [esi+40h], 1
		mov	ecx, [ecx+0Ch]
		push	ecx
		push	eax
		lea	edx, [ebp+480h]
		push	edx
		lea	eax, [ebp+4A0h]
		push	eax
		push	esi
		call	sub_10001000
		mov	edi, eax
		add	esp, 14h
		cmp	edi, ebx
		jnz	loc_10008907
		push	ebp
		call	sub_10007A40
		jmp	short loc_1000889D
; ---------------------------------------------------------------------------

loc_10008885:				; CODE XREF: sub_100087C0+5Fj
					; sub_100087C0+67j ...
		cmp	[esi+44h], ebx
		jz	short loc_100088CC
		mov	eax, ebp
		call	sub_100051A0
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_10008907
		push	ebp
		call	sub_100044F0

loc_1000889D:				; CODE XREF: sub_100087C0+C3j
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_10008907
		cmp	dword ptr [ebp+2F38h], 1
		jz	short loc_100088B7
		mov	[esi+48h], ebx
		mov	[esi+50h], ebx
		jmp	short loc_10008901
; ---------------------------------------------------------------------------

loc_100088B7:				; CODE XREF: sub_100087C0+EDj
		mov	ecx, [esp+10h+arg_0]
		movzx	eax, word ptr [ecx+1210h]
		mov	edx, 0FFFFh
		cmp	ax, dx
		jnz	short loc_100088DE

loc_100088CC:				; CODE XREF: sub_100087C0+C8j
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10008907
; ---------------------------------------------------------------------------

loc_100088DE:				; CODE XREF: sub_100087C0+10Aj
		inc	eax
		mov	[esi+1210h], ax
		movzx	eax, ax
		shl	eax, 10h
		mov	[esi+48h], eax
		mov	[esi+50h], eax
		lea	eax, [esi+1218h]
		push	eax		; Dst
		call	sub_10002630
		add	esp, 4

loc_10008901:				; CODE XREF: sub_100087C0+F5j
		mov	[esi+4Ch], ebx
		mov	[esi+54h], ebx

loc_10008907:				; CODE XREF: sub_100087C0+52j
					; sub_100087C0+B7j ...
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000891C
		mov	ecx, [ebp+25Ch]
		push	ecx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000891C:				; CODE XREF: sub_100087C0+14Bj
		cmp	edi, ebx
		jz	short loc_1000892D
		push	0FFFFD051h
		call	sub_100147C0
		add	esp, 4

loc_1000892D:				; CODE XREF: sub_100087C0+15Ej
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_100087C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008940	proc near		; CODE XREF: sub_10009320+92Dp
		push	edi
		mov	edi, eax
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_10008958
		push	edx
		push	edi
		call	sub_10002F60
		add	esp, 8
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10008958:				; CODE XREF: sub_10008940+Aj
		call	sub_10008170
		pop	edi
		retn
sub_10008940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008960	proc near		; CODE XREF: sub_10002510+3Ep
					; sub_10008A50+5p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	al, byte ptr [esp+arg_8]
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		mov	esi, ds:PR_EnterMonitor
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		test	byte ptr [edi+16h], 1
		mov	byte ptr [esp+0Ch+arg_4], bl
		mov	byte ptr [esp+0Ch+arg_4+1], al
		jnz	short loc_1000898F
		mov	ecx, [edi+258h]
		push	ecx
		call	esi ; PR_EnterMonitor
		add	esp, 4

loc_1000898F:				; CODE XREF: sub_10008960+21j
		cmp	ebx, 2
		jnz	short loc_100089B7
		test	dword ptr [edi+14h], 400h
		jnz	short loc_100089B7
		mov	ecx, [edi+0F4h]
		test	ecx, ecx
		jz	short loc_100089B7
		mov	eax, [edi+88h]
		test	eax, eax
		jz	short loc_100089B7
		push	ecx
		call	eax
		add	esp, 4

loc_100089B7:				; CODE XREF: sub_10008960+32j
					; sub_10008960+3Bj ...
		test	byte ptr [edi+16h], 1
		jnz	short loc_100089C9
		mov	edx, [edi+250h]
		push	edx
		call	esi ; PR_EnterMonitor
		add	esp, 4

loc_100089C9:				; CODE XREF: sub_10008960+5Bj
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_100089E2
		push	40000000h
		push	edi
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_100089EC
; ---------------------------------------------------------------------------

loc_100089E2:				; CODE XREF: sub_10008960+70j
		mov	edx, 40000000h
		call	sub_10008170

loc_100089EC:				; CODE XREF: sub_10008960+80j
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10008A20
		cmp	[esp+0Ch+arg_8], 29h
		lea	ecx, [esp+0Ch+arg_4]
		setnz	al
		dec	eax
		and	eax, 40000000h
		push	eax
		push	2
		push	ecx
		push	15h
		push	esi
		push	edi
		call	sub_10007C90
		xor	edx, edx
		add	esp, 18h
		test	eax, eax
		setns	dl
		lea	esi, [edx-1]
		and	esi, eax

loc_10008A20:				; CODE XREF: sub_10008960+90j
		test	byte ptr [edi+16h], 1
		mov	ebx, ds:PR_ExitMonitor
		jnz	short loc_10008A4A
		mov	eax, [edi+250h]
		push	eax
		call	ebx ; PR_ExitMonitor
		add	esp, 4
		test	byte ptr [edi+16h], 1
		jnz	short loc_10008A4A
		mov	ecx, [edi+258h]
		push	ecx
		call	ebx ; PR_ExitMonitor
		add	esp, 4

loc_10008A4A:				; CODE XREF: sub_10008960+CAj
					; sub_10008960+DCj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10008960	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008A50	proc near		; CODE XREF: sub_1000CB90+1EBp
		push	28h
		push	2
		push	esi
		call	sub_10008960
		mov	eax, [esi+4Ch]
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFD007h
		push	eax
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		retn
sub_10008A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008A80	proc near		; CODE XREF: sub_1000C640+11Ep
					; sub_1000C7F0+80p ...
		mov	eax, 301h
		cmp	[edx+44h], ax
		sbb	eax, eax
		add	ecx, 1FFFh
		inc	eax
		cmp	ecx, 5Ah	; switch 91 cases
		ja	loc_10008B37	; jumptable 10008AA2 default case
		movzx	ecx, ds:byte_10008B6C[ecx]
		jmp	ds:off_10008B4C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10008AA9:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		mov	eax, 2Bh	; jumptable 10008AA2 case 0
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008ABB:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		mov	eax, 2Dh	; jumptable 10008AA2 case 10
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008ACD:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		mov	eax, 2Ch	; jumptable 10008AA2 case 11
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008ADF:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		mov	eax, 2Eh	; jumptable 10008AA2 cases 89,90
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008AF1:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		neg	eax		; jumptable 10008AA2 case 20
		sbb	eax, eax
		and	eax, 3
		add	eax, 2Eh
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008B08:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		xor	ecx, ecx	; jumptable 10008AA2 cases 12,19
		test	eax, eax
		setnz	cl
		lea	eax, [ecx+ecx+2Eh]
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008B20:				; CODE XREF: sub_10008A80+22j
					; DATA XREF: .text:off_10008B4Co
		neg	eax		; jumptable 10008AA2 case 29
		sbb	eax, eax
		and	eax, 3
		add	eax, 2Dh
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10008B37:				; CODE XREF: sub_10008A80+15j
					; sub_10008A80+22j
					; DATA XREF: ...
		mov	eax, 2Ah	; jumptable 10008AA2 default case
		push	eax
		push	2
		push	edx
		call	sub_10008960
		add	esp, 0Ch
		retn
sub_10008A80	endp

; ---------------------------------------------------------------------------
		align 4
off_10008B4C	dd offset loc_10008AA9,	offset loc_10008ABB, offset loc_10008ACD
					; DATA XREF: sub_10008A80+22r
		dd offset loc_10008B08,	offset loc_10008AF1, offset loc_10008B20 ; jump	table for switch statement
		dd offset loc_10008ADF,	offset loc_10008B37
byte_10008B6C	db	0,     7,     7,     7 ; DATA XREF: sub_10008A80+1Br
		db	7,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     1,     2
		db	3,     7,     7,     7
		db	7,     7,     7,     3
		db	4,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     5,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     6,     6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008BD0	proc near		; CODE XREF: sub_10002B90+338p
					; sub_10009240+47p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, 300h
		cmp	ax, [esi+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx
		push	2
		push	esi
		call	sub_10008960
		mov	edx, [esi+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10008BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008C10	proc near		; CODE XREF: sub_1000CB90+27Ep
					; sub_1000D520+11Cp ...

Src		= byte ptr -1

		push	ecx
		push	ebx
		push	edi
		mov	ebx, 1
		mov	edi, eax
		mov	[esp+0Ch+Src], bl
		cmp	[edi+2F38h], ebx
		jnz	short loc_10008C36
		push	40000000h
		push	edi
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_10008C40
; ---------------------------------------------------------------------------

loc_10008C36:				; CODE XREF: sub_10008C10+14j
		mov	edx, 40000000h
		call	sub_10008170

loc_10008C40:				; CODE XREF: sub_10008C10+24j
		test	eax, eax
		jnz	loc_10008CFB
		cmp	[edi+2F38h], ebx
		jz	short loc_10008C70
		push	40000000h
		push	ebx
		lea	eax, [esp+14h+Src]
		push	eax
		push	14h
		push	0
		push	edi
		call	sub_10007C90
		add	esp, 18h
		test	eax, eax
		jns	short loc_10008C85
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008C70:				; CODE XREF: sub_10008C10+3Ej
		push	ebx		; Size
		lea	ecx, [esp+10h+Src]
		push	ecx		; Src
		push	14h		; int
		push	edi		; int
		call	sub_10002260
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10008CFB

loc_10008C85:				; CODE XREF: sub_10008C10+5Aj
		test	[edi+16h], bl
		jnz	short loc_10008C99
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_10008C99:				; CODE XREF: sub_10008C10+78j
		mov	eax, [edi+454h]
		mov	ecx, [edi+450h]
		mov	[edi+450h], eax
		mov	eax, ecx
		mov	[edi+454h], ecx
		cmp	[edi+44Ch], eax
		jnz	short loc_10008CE5
		cmp	[edi+2F38h], ebx
		jz	short loc_10008CCD
		push	0
		push	eax
		call	sub_10003D00
		jmp	short loc_10008CE2
; ---------------------------------------------------------------------------

loc_10008CCD:				; CODE XREF: sub_10008C10+B1j
		push	offset loc_10002450
		push	edi
		mov	dword ptr [edi+920h], 1D4C0h
		call	sub_100023E0

loc_10008CE2:				; CODE XREF: sub_10008C10+BBj
		add	esp, 8

loc_10008CE5:				; CODE XREF: sub_10008C10+A9j
		test	[edi+16h], bl
		jnz	short loc_10008CF9
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10008CF9:				; CODE XREF: sub_10008C10+D8j
		xor	eax, eax

loc_10008CFB:				; CODE XREF: sub_10008C10+32j
					; sub_10008C10+73j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10008C10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008D00	proc near		; CODE XREF: sub_1000F790+7A3p
		cmp	dword ptr [esi+4C0h], 4
		jz	short loc_10008D37
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_10008D1C
		mov	dword ptr [eax+4], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10008D1C:				; CODE XREF: sub_10008D00+10j
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD033h
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10008D37:				; CODE XREF: sub_10008D00+7j
		cmp	dword ptr [eax+4], 1
		jz	short loc_10008D7B
		mov	eax, 300h
		cmp	ax, [esi+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx

loc_10008D4F:				; CODE XREF: sub_10008D00+84j
		push	2
		push	esi
		call	sub_10008960
		mov	edx, [esi+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		push	0FFFFD025h
		call	PORT_SetError_Util
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10008D7B:				; CODE XREF: sub_10008D00+3Bj
		mov	ecx, [eax]
		cmp	byte ptr [ecx],	1
		jz	short loc_10008D86
		push	2Fh
		jmp	short loc_10008D4F
; ---------------------------------------------------------------------------

loc_10008D86:				; CODE XREF: sub_10008D00+80j
		mov	dword ptr [eax+4], 0
		test	byte ptr [esi+16h], 1
		jnz	short loc_10008DA2
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_10008DA2:				; CODE XREF: sub_10008D00+91j
		mov	eax, [esi+44Ch]
		mov	ecx, [esi+448h]
		mov	[esi+448h], eax
		mov	eax, ecx
		mov	[esi+44Ch], ecx
		mov	dword ptr [esi+4C0h], 5
		cmp	eax, [esi+454h]
		jnz	short loc_10008DD9
		push	0
		push	eax
		call	sub_10003D00
		add	esp, 8

loc_10008DD9:				; CODE XREF: sub_10008D00+CCj
		test	byte ptr [esi+16h], 1
		jnz	short loc_10008DEE
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10008DEE:				; CODE XREF: sub_10008D00+DDj
		xor	eax, eax
		retn
sub_10008D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008E00(int,	void *Src, size_t Size)
sub_10008E00	proc near		; CODE XREF: sub_10008F10+46p
					; sub_10008F70+47p ...

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+Size]
		push	ebp
		mov	ebp, [esp+8+Src]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	eax, [edi+0D8h]
		mov	ecx, [edi+0D4h]
		mov	esi, eax
		sub	esi, ecx
		test	ebx, ebx
		jz	loc_10008F03
		cmp	eax, 7D00h
		jnb	short loc_10008E7B
		cmp	esi, ebx
		jge	short loc_10008E7B
		lea	eax, [ecx+ebx]
		cmp	eax, 7D00h
		ja	short loc_10008E52
		cmp	eax, 0FA0h
		jnb	short loc_10008E4B
		mov	eax, 0FA0h
		jmp	short loc_10008E57
; ---------------------------------------------------------------------------

loc_10008E4B:				; CODE XREF: sub_10008E00+42j
		cmp	eax, 7D00h
		jbe	short loc_10008E57

loc_10008E52:				; CODE XREF: sub_10008E00+3Bj
		mov	eax, 7D00h

loc_10008E57:				; CODE XREF: sub_10008E00+49j
					; sub_10008E00+50j
		push	eax
		lea	eax, [edi+0D0h]
		push	eax
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jnz	loc_10008F05
		mov	esi, [edi+0D8h]
		sub	esi, [edi+0D4h]

loc_10008E7B:				; CODE XREF: sub_10008E00+2Dj
					; sub_10008E00+31j
		push	ebp
		mov	eax, edi
		call	sub_10005490
		add	esp, 4
		test	eax, eax
		jnz	short loc_10008F05
		cmp	ebx, esi
		jle	short loc_10008EE6
		mov	edi, edi

loc_10008E90:				; CODE XREF: sub_10008E00+E4j
		test	esi, esi
		jle	short loc_10008EAB
		mov	ecx, [edi+0D0h]
		add	ecx, [edi+0D4h]
		push	esi		; Size
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10008EAB:				; CODE XREF: sub_10008E00+92j
		add	[edi+0D4h], esi
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_10008ECA
		push	40000000h
		push	edi
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_10008ED4
; ---------------------------------------------------------------------------

loc_10008ECA:				; CODE XREF: sub_10008E00+B8j
		mov	edx, 40000000h
		call	sub_10008170

loc_10008ED4:				; CODE XREF: sub_10008E00+C8j
		test	eax, eax
		jnz	short loc_10008F05
		sub	ebx, esi
		add	ebp, esi
		mov	esi, [edi+0D8h]
		cmp	ebx, esi
		jg	short loc_10008E90

loc_10008EE6:				; CODE XREF: sub_10008E00+8Cj
		mov	edx, [edi+0D0h]
		add	edx, [edi+0D4h]
		push	ebx		; Size
		push	ebp		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		add	[edi+0D4h], ebx

loc_10008F03:				; CODE XREF: sub_10008E00+22j
		xor	eax, eax

loc_10008F05:				; CODE XREF: sub_10008E00+69j
					; sub_10008E00+88j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10008E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008F10(int,	int, int Src)
sub_10008F10	proc near		; CODE XREF: sub_10014AF0+89p
					; sub_10014AF0+9Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+Src]
		lea	edx, [esi-1]
		lea	eax, [esp+4+Src]
		cmp	edx, 3		; switch 4 cases
		ja	short loc_10008F4B ; jumptable 10008F25	default	case
		mov	ecx, [esp+4+arg_4]
		jmp	ds:off_10008F60[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10008F2C:				; CODE XREF: sub_10008F10+15j
					; DATA XREF: .text:off_10008F60o
		mov	eax, ecx	; jumptable 10008F25 case 3
		sar	eax, 18h
		mov	byte ptr [esp+4+Src], al
		lea	eax, [esp+4+Src+1]

loc_10008F39:				; CODE XREF: sub_10008F10+15j
					; DATA XREF: .text:off_10008F60o
		mov	edx, ecx	; jumptable 10008F25 case 2
		sar	edx, 10h
		mov	[eax], dl
		inc	eax

loc_10008F41:				; CODE XREF: sub_10008F10+15j
					; DATA XREF: .text:off_10008F60o
		mov	edx, ecx	; jumptable 10008F25 case 1
		sar	edx, 8
		mov	[eax], dl
		inc	eax

loc_10008F49:				; CODE XREF: sub_10008F10+15j
					; DATA XREF: .text:off_10008F60o
		mov	[eax], cl	; jumptable 10008F25 case 0

loc_10008F4B:				; CODE XREF: sub_10008F10+Fj
		mov	ecx, [esp+4+arg_0] ; jumptable 10008F25	default	case
		push	esi		; Size
		lea	eax, [esp+8+Src]
		push	eax		; Src
		push	ecx		; int
		call	sub_10008E00
		add	esp, 0Ch
		pop	esi
		retn
sub_10008F10	endp

; ---------------------------------------------------------------------------
off_10008F60	dd offset loc_10008F49	; DATA XREF: sub_10008F10+15r
		dd offset loc_10008F41	; jump table for switch	statement
		dd offset loc_10008F39
		dd offset loc_10008F2C

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008F70(int,	void *,	size_t Size, int Src)
sub_10008F70	proc near		; CODE XREF: sub_10014AF0+DAp
					; sub_10014E90+88p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Size		= dword	ptr  0Ch
Src		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+Size]
		push	esi
		mov	esi, [esp+8+Src]
		lea	ecx, [esi-1]
		lea	eax, [esp+8+Src]
		cmp	ecx, 3		; switch 4 cases
		ja	short loc_10008FAC ; jumptable 10008F86	default	case
		jmp	ds:off_10008FD8[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10008F8D:				; CODE XREF: sub_10008F70+16j
					; DATA XREF: .text:off_10008FD8o
		mov	eax, ebx	; jumptable 10008F86 case 3
		sar	eax, 18h
		mov	byte ptr [esp+8+Src], al
		lea	eax, [esp+8+Src+1]

loc_10008F9A:				; CODE XREF: sub_10008F70+16j
					; DATA XREF: .text:off_10008FD8o
		mov	ecx, ebx	; jumptable 10008F86 case 2
		sar	ecx, 10h
		mov	[eax], cl
		inc	eax

loc_10008FA2:				; CODE XREF: sub_10008F70+16j
					; DATA XREF: .text:off_10008FD8o
		mov	edx, ebx	; jumptable 10008F86 case 1
		sar	edx, 8
		mov	[eax], dl
		inc	eax

loc_10008FAA:				; CODE XREF: sub_10008F70+16j
					; DATA XREF: .text:off_10008FD8o
		mov	[eax], bl	; jumptable 10008F86 case 0

loc_10008FAC:				; CODE XREF: sub_10008F70+14j
		push	esi		; jumptable 10008F86 default case
		mov	esi, [esp+0Ch+arg_0]
		lea	eax, [esp+0Ch+Src]
		push	eax		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10008FD2
		mov	ecx, [esp+8+arg_4]
		push	ebx		; Size
		push	ecx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_10008FD2:				; CODE XREF: sub_10008F70+51j
		pop	esi
		pop	ebx
		retn
sub_10008F70	endp

; ---------------------------------------------------------------------------
		align 4
off_10008FD8	dd offset loc_10008FAA	; DATA XREF: sub_10008F70+16r
		dd offset loc_10008FA2	; jump table for switch	statement
		dd offset loc_10008F9A
		dd offset loc_10008F8D
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10008FF0(int Src, char, int)
sub_10008FF0	proc near		; CODE XREF: sub_10009320+47Dp
					; sub_10009D90+3C8p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+Src]
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_10009012
		push	esi
		call	sub_10002300
		add	esp, 4
		test	eax, eax
		jnz	loc_100090E3

loc_10009012:				; CODE XREF: sub_10008FF0+Fj
		mov	al, [esp+0Ch+arg_4]
		push	1		; Size
		lea	ecx, [esp+10h+Src]
		push	ecx		; Src
		push	esi		; int
		mov	byte ptr [esp+18h+Src],	al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100090E3
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		mov	eax, ebx
		sar	eax, 10h
		mov	[esp+10h+var_8], eax
		mov	byte ptr [esp+10h+Src],	al
		push	3		; Size
		lea	edx, [esp+14h+Src]
		mov	eax, ebx
		sar	eax, 8
		push	edx		; Src
		push	esi		; int
		mov	[esp+1Ch+var_4], eax
		mov	byte ptr [esp+1Ch+Src+1], al
		mov	byte ptr [esp+1Ch+Src+2], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100090E2
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_100090E2
		movzx	eax, word ptr [esi+8D4h]
		push	2		; Size
		lea	edx, [esp+14h+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+1Ch+Src],	cl
		mov	byte ptr [esp+1Ch+Src+1], al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100090E2
		inc	word ptr [esi+8D4h]
		mov	word ptr [esp+10h+Src],	ax
		mov	byte ptr [esp+10h+Src+2], al
		push	3		; Size
		lea	eax, [esp+14h+Src]
		push	eax		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100090E2
		mov	cl, byte ptr [esp+10h+var_8]
		mov	dl, byte ptr [esp+10h+var_4]
		push	3		; Size
		lea	eax, [esp+14h+Src]
		push	eax		; Src
		push	esi		; int
		mov	byte ptr [esp+1Ch+Src],	cl
		mov	byte ptr [esp+1Ch+Src+1], dl
		mov	byte ptr [esp+1Ch+Src+2], bl
		call	sub_10008E00
		add	esp, 0Ch

loc_100090E2:				; CODE XREF: sub_10008FF0+77j
					; sub_10008FF0+80j ...
		pop	ebx

loc_100090E3:				; CODE XREF: sub_10008FF0+1Cj
					; sub_10008FF0+3Cj
		pop	esi
		add	esp, 8
		retn
sub_10008FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100090F0	proc near		; CODE XREF: sub_1000A4D0+18Bp
					; sub_1000B9F0+21Dp ...

Src		= byte ptr -4
var_3		= byte ptr -3
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	edx, [esp+4+arg_4]
		mov	ecx, [edx]
		xor	eax, eax
		lea	esp, [esp+0]

loc_10009100:				; CODE XREF: sub_100090F0+1Dj
		cmp	ecx, ds:dword_1002AF90[eax*8]
		jz	short loc_1000912A
		inc	eax
		cmp	eax, 6
		jb	short loc_10009100
		xor	eax, eax

loc_10009111:				; CODE XREF: sub_100090F0+41j
		mov	[esp+4+Src], al
		test	al, al
		jnz	short loc_10009133
		push	0FFFFD07Eh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000912A:				; CODE XREF: sub_100090F0+17j
		mov	eax, ds:dword_1002AF8C[eax*8]
		jmp	short loc_10009111
; ---------------------------------------------------------------------------

loc_10009133:				; CODE XREF: sub_100090F0+26j
		mov	al, [edx+4]
		mov	edx, [esp+4+arg_0]
		push	2		; Size
		lea	ecx, [esp+8+Src]
		push	ecx		; Src
		push	edx		; int
		mov	[esp+10h+var_3], al
		call	sub_10008E00
		add	esp, 0Ch
		pop	ecx
		retn
sub_100090F0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009150(int,	void *Dst, size_t Size,	int, int)
sub_10009150	proc near		; CODE XREF: sub_100092B0+17p
					; sub_1000A6D0+164p ...

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_10]
		push	esi
		mov	esi, [esp+8+Size]
		cmp	esi, [ebx]
		jbe	short loc_10009198
		mov	esi, [esp+8+arg_0]
		mov	eax, 300h
		cmp	ax, [esi+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx
		push	2
		push	esi
		call	sub_10008960
		mov	edx, [esi+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		add	esp, 10h
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009198:				; CODE XREF: sub_10009150+Cj
		mov	ecx, [esp+8+Dst]
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		mov	eax, [edi]
		push	esi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	[edi], esi
		sub	[ebx], esi
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10009150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100091C0	proc near		; CODE XREF: sub_10002510+6Bp
					; sub_10009240+29p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	edx, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		mov	esi, [ebx]
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		xor	eax, eax
		cmp	edx, [edi]
		jbe	short loc_10009212
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, 300h
		cmp	ax, [esi+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx
		push	2
		push	esi
		call	sub_10008960
		mov	edx, [esi+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009212:				; CODE XREF: sub_100091C0+15j
		xor	ecx, ecx
		test	edx, edx
		jle	short loc_1000922F
		push	ebp
		lea	esp, [esp+0]

loc_10009220:				; CODE XREF: sub_100091C0+6Cj
		movzx	ebp, byte ptr [ecx+esi]
		shl	eax, 8
		inc	ecx
		add	eax, ebp
		cmp	ecx, edx
		jl	short loc_10009220
		pop	ebp

loc_1000922F:				; CODE XREF: sub_100091C0+56j
		add	esi, edx
		mov	[ebx], esi
		sub	[edi], edx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100091C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009240	proc near		; CODE XREF: sub_10002510+97p
					; sub_1000A6D0+186p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_0]
		push	ebx
		mov	ebx, [esp+4+arg_10]
		push	esi
		mov	esi, [esp+8+arg_4]
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		push	ebx
		push	edi
		push	eax
		push	ecx
		mov	dword ptr [esi+8], 0
		mov	dword ptr [esi+4], 0
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		jns	short loc_1000927C
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000927C:				; CODE XREF: sub_10009240+33j
		jle	short loc_1000929F
		cmp	eax, [ebx]
		jbe	short loc_10009293
		mov	edx, [esp+0Ch+arg_0]
		push	edx
		call	sub_10008BD0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009293:				; CODE XREF: sub_10009240+40j
		mov	ecx, [edi]
		mov	[esi+4], ecx
		mov	[esi+8], eax
		add	[edi], eax
		sub	[ebx], eax

loc_1000929F:				; CODE XREF: sub_10009240:loc_1000927Cj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10009240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100092B0	proc near		; CODE XREF: sub_1000AE00+1D8p
					; sub_1000AE00+3E0p ...

Dst		= word ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, [esp+4+arg_8]
		mov	ecx, [esp+4+arg_4]
		push	eax		; int
		mov	eax, [esp+8+arg_0]
		push	ecx		; int
		push	2		; Size
		lea	edx, [esp+10h+Dst]
		push	edx		; Dst
		push	eax		; int
		call	sub_10009150
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000931E
		mov	dx, [esp+4+Dst]
		movzx	ecx, dl
		lea	ebx, [ebx+0]

loc_100092E0:				; CODE XREF: sub_100092B0+3Dj
		cmp	ecx, ds:dword_1002AF8C[eax*8]
		jz	short loc_1000930D
		inc	eax
		cmp	eax, 6
		jb	short loc_100092E0
		xor	eax, eax

loc_100092F1:				; CODE XREF: sub_100092B0+64j
		mov	ecx, [esp+4+arg_C]
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10009316
		push	0FFFFD07Eh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000930D:				; CODE XREF: sub_100092B0+37j
		mov	eax, ds:dword_1002AF90[eax*8]
		jmp	short loc_100092F1
; ---------------------------------------------------------------------------

loc_10009316:				; CODE XREF: sub_100092B0+49j
		movzx	edx, dh
		mov	[ecx+4], edx
		xor	eax, eax

loc_1000931E:				; CODE XREF: sub_100092B0+21j
		pop	ecx
		retn
sub_100092B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009320	proc near		; CODE XREF: sub_10002510+E5p
					; sub_10009C70+D1p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Src		= word ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 20h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_0]
		push	edi
		xor	ebp, ebp
		xor	ebx, ebx
		mov	edi, esi
		mov	[esp+30h+var_1C], ebp
		mov	[esp+30h+var_4], ebx
		mov	[esp+30h+var_18], ebp
		call	sub_10007320
		cmp	eax, ebp
		jnz	loc_10009C60
		lea	eax, [esi+860h]
		push	ebp
		push	eax
		mov	[esi+844h], ebp
		call	SECITEM_FreeItem_Util
		push	9Ch		; Size
		lea	eax, [esi+2E9Ch]
		push	ebp		; Val
		push	eax		; Dst
		mov	[esi+854h], ebp
		call	memset
		add	esp, 14h
		call	sub_10005430
		cmp	eax, ebp
		jnz	loc_10009C60
		cmp	[esi+24h], ebp
		jz	short loc_100093D2
		movzx	eax, word ptr [esi+18h]
		cmp	ax, bp
		jnz	short loc_100093AB

loc_10009393:				; CODE XREF: sub_10009320+30Aj
		push	0FFFFD014h
		call	PORT_SetError_Util
		add	esp, 4

loc_100093A0:				; CODE XREF: sub_10009320+28Cj
					; sub_10009320+31Bj ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100093AB:				; CODE XREF: sub_10009320+71j
		movzx	ecx, word ptr [esi+46h]
		cmp	cx, ax
		jb	short loc_100093BA
		cmp	cx, [esi+1Ah]
		jbe	short loc_100093D2

loc_100093BA:				; CODE XREF: sub_10009320+92j
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100093D2:				; CODE XREF: sub_10009320+68j
					; sub_10009320+98j
		test	dword ptr [esi+14h], 400h
		jnz	loc_10009567
		mov	ecx, [esi+1D8h]
		mov	edx, [esi+1E8h]
		movzx	eax, word ptr [esi+0F0h]
		push	ecx
		push	edx
		push	eax
		lea	ecx, [esi+0E0h]
		push	ecx
		call	sub_100181D0
		mov	ebp, eax
		add	esp, 10h
		mov	[esp+30h+var_20], ebp
		test	ebp, ebp
		jz	loc_10009565
		mov	edi, 1
		cmp	[ebp+0B2h], bl
		jz	loc_100094BC
		cmp	[ebp+0DEh], bl
		jz	loc_1000953A
		test	dword ptr [esi+14h], 8000h
		jnz	loc_1000953A
		mov	edx, [ebp+0CCh]
		mov	eax, [ebp+0C8h]
		push	edx
		push	eax
		call	SECMOD_LookupSlot
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000953A
		push	ebx
		xor	ebp, ebp
		call	PK11_IsPresent
		add	esp, 4
		test	eax, eax
		jz	short loc_1000949C
		mov	eax, [esp+30h+var_20]
		mov	ecx, [esi+22Ch]
		movzx	edx, word ptr [eax+0D2h]
		push	ecx
		mov	ecx, [eax+0B4h]
		push	edx
		movzx	edx, word ptr [eax+0D0h]
		push	ecx
		push	edx
		push	ebx
		call	PK11_GetWrapKey
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jnz	short loc_100094A2

loc_1000949C:				; CODE XREF: sub_10009320+149j
		xor	edi, edi
		test	ebp, ebp
		jz	short loc_100094AB

loc_100094A2:				; CODE XREF: sub_10009320+17Aj
		push	ebp
		call	PK11_FreeSymKey
		add	esp, 4

loc_100094AB:				; CODE XREF: sub_10009320+180j
		push	ebx
		call	PK11_FreeSlot
		mov	ebp, [esp+34h+var_20]
		add	esp, 4
		test	edi, edi
		jz	short loc_1000953A

loc_100094BC:				; CODE XREF: sub_10009320+FDj
		mov	edi, ebp
		call	sub_10004C40
		test	eax, eax
		jz	short loc_1000953A
		cmp	dword ptr [esi+24h], 0
		movzx	eax, word ptr [ebp+3Ah]
		jz	short loc_10009505
		cmp	ax, [esi+18h]
		jb	short loc_1000953A
		movzx	ecx, word ptr [esi+46h]
		cmp	ax, cx
		ja	short loc_1000953A
		mov	[esi+44h], cx

loc_100094E4:				; CODE XREF: sub_10009320+20Bj
		push	offset dword_100374D0
		mov	ebx, 1
		call	ds:__imp_PR_AtomicIncrement
		mov	eax, [ebp+7Ch]
		add	esp, 4
		mov	[esi+468h], eax
		jmp	loc_100095B4
; ---------------------------------------------------------------------------

loc_10009505:				; CODE XREF: sub_10009320+1AFj
		movzx	ecx, word ptr [esi+18h]
		test	cx, cx
		jnz	short loc_10009515
		push	0FFFFD014h
		jmp	short loc_10009532
; ---------------------------------------------------------------------------

loc_10009515:				; CODE XREF: sub_10009320+1ECj
		cmp	ax, cx
		jb	short loc_1000952D
		movzx	ecx, word ptr [esi+1Ah]
		cmp	ax, cx
		ja	short loc_1000952D
		jb	short loc_10009527
		mov	eax, ecx

loc_10009527:				; CODE XREF: sub_10009320+203j
		mov	[esi+44h], ax
		jmp	short loc_100094E4
; ---------------------------------------------------------------------------

loc_1000952D:				; CODE XREF: sub_10009320+1F8j
					; sub_10009320+201j
		push	0FFFFD002h

loc_10009532:				; CODE XREF: sub_10009320+1F3j
		call	PORT_SetError_Util
		add	esp, 4

loc_1000953A:				; CODE XREF: sub_10009320+109j
					; sub_10009320+116j ...
		push	offset dword_100374D8
		call	ds:__imp_PR_AtomicIncrement
		mov	eax, [esi+88h]
		add	esp, 4
		test	eax, eax
		jz	short loc_10009558
		push	ebp
		call	eax
		add	esp, 4

loc_10009558:				; CODE XREF: sub_10009320+230j
		push	ebp
		call	sub_10017FD0
		mov	ebx, [esp+34h+var_4]
		add	esp, 4

loc_10009565:				; CODE XREF: sub_10009320+ECj
		xor	ebp, ebp

loc_10009567:				; CODE XREF: sub_10009320+B9j
		push	offset dword_100374D4
		call	ds:__imp_PR_AtomicIncrement
		add	esp, 4
		cmp	[esi+24h], ebp
		jz	short loc_10009584
		mov	cx, [esi+46h]
		mov	[esi+44h], cx
		jmp	short loc_1000959C
; ---------------------------------------------------------------------------

loc_10009584:				; CODE XREF: sub_10009320+258j
		push	1
		push	303h
		push	esi
		call	sub_10003440
		add	esp, 0Ch
		cmp	eax, ebp
		jnz	loc_10009C60

loc_1000959C:				; CODE XREF: sub_10009320+262j
		push	ebp
		push	esi
		call	sub_100066A0
		add	esp, 8
		mov	[esp+30h+var_20], eax
		cmp	eax, ebp
		jz	loc_100093A0
		mov	ebp, eax

loc_100095B4:				; CODE XREF: sub_10009320+1E0j
		mov	edx, 300h
		cmp	dx, [esi+44h]
		sbb	edi, edi
		neg	edi
		test	byte ptr [esi+16h], 1
		mov	[esp+30h+var_4], edi
		jnz	short loc_100095DA
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_100095DA:				; CODE XREF: sub_10009320+2A9j
		mov	eax, [esi+450h]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx], 0
		jnz	short loc_100095F0
		mov	dx, [esi+44h]
		mov	[eax+58h], dx

loc_100095F0:				; CODE XREF: sub_10009320+2C6j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10009605
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10009605:				; CODE XREF: sub_10009320+2D4j
		mov	eax, [esi+0F4h]
		test	eax, eax
		jz	short loc_10009618
		push	eax
		call	sub_10017FD0
		add	esp, 4

loc_10009618:				; CODE XREF: sub_10009320+2EDj
		cmp	word ptr [esi+18h], 0
		mov	[esi+0F4h], ebp
		mov	dword ptr [esi+48h], offset sub_10007FE0
		jz	loc_10009393
		push	esi
		call	sub_10003200
		add	esp, 4
		test	eax, eax
		jz	loc_100093A0
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_10009655
		test	edi, edi
		jnz	short loc_10009655
		mov	dword ptr [esi+844h], 1

loc_10009655:				; CODE XREF: sub_10009320+325j
					; sub_10009320+329j
		mov	eax, [ebp+0ECh]
		test	eax, eax
		jz	short loc_10009669
		push	eax
		call	ds:PR_RWLock_Rlock
		add	esp, 4

loc_10009669:				; CODE XREF: sub_10009320+33Dj
		test	edi, edi
		jnz	short loc_10009677
		cmp	[esi+24h], edi
		jz	short loc_100096C7
		cmp	[esi+40h], edi
		jz	short loc_100096C7

loc_10009677:				; CODE XREF: sub_10009320+34Bj
		push	0
		push	0FFFFh
		push	0
		push	esi
		call	sub_100162F0
		add	esp, 10h
		test	eax, eax
		jns	short loc_100096B0

loc_1000968D:				; CODE XREF: sub_10009320+3DFj
		mov	eax, [ebp+0ECh]

loc_10009693:				; CODE XREF: sub_10009320+874j
					; sub_10009320+8BEj
		test	eax, eax
		jz	loc_100093A0
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100096B0:				; CODE XREF: sub_10009320+36Bj
		mov	[esp+30h+var_18], eax
		test	eax, eax
		jle	short loc_100096C1
		add	eax, 2
		mov	[esp+30h+var_18], eax
		test	eax, eax

loc_100096C1:				; CODE XREF: sub_10009320+396j
		jz	short loc_100096C7
		test	edi, edi
		jnz	short loc_100096D2

loc_100096C7:				; CODE XREF: sub_10009320+350j
					; sub_10009320+355j ...
		push	0
		push	esi
		call	sub_10021700
		add	esp, 8

loc_100096D2:				; CODE XREF: sub_10009320+3A5j
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_100096E4
		push	esi
		call	sub_100021F0
		add	esp, 4

loc_100096E4:				; CODE XREF: sub_10009320+3B9j
		mov	ecx, [esi+468h]
		push	1
		push	ecx
		mov	eax, esi
		call	sub_10003370
		mov	edi, eax
		add	esp, 8
		mov	[esp+30h+var_14], eax
		test	edi, edi
		jz	short loc_1000968D
		test	dword ptr [esi+14h], 10000000h
		jz	short loc_1000971F
		test	ebx, ebx
		jz	short loc_10009718
		mov	dx, [esi+44h]
		cmp	dx, [ebp+3Ah]
		jnb	short loc_1000971F

loc_10009718:				; CODE XREF: sub_10009320+3ECj
		mov	eax, 1
		jmp	short loc_10009721
; ---------------------------------------------------------------------------

loc_1000971F:				; CODE XREF: sub_10009320+3E8j
					; sub_10009320+3F6j
		xor	eax, eax

loc_10009721:				; CODE XREF: sub_10009320+3FDj
		cmp	dword ptr [esi+844h], 0
		mov	[esp+30h+var_C], eax
		jz	short loc_10009733
		inc	edi
		mov	[esp+30h+var_14], edi

loc_10009733:				; CODE XREF: sub_10009320+40Cj
		test	eax, eax
		jz	short loc_1000973C
		inc	edi
		mov	[esp+30h+var_14], edi

loc_1000973C:				; CODE XREF: sub_10009320+415j
		xor	ebx, ebx
		mov	[esp+30h+var_8], ebx
		xor	edx, edx
		jmp	short loc_10009750
; ---------------------------------------------------------------------------
		align 10h

loc_10009750:				; CODE XREF: sub_10009320+424j
					; sub_10009320+447j
		movzx	eax, ds:byte_1002A5A8[edx]
		mov	ecx, esi
		call	sub_10002FF0
		test	eax, eax
		jz	short loc_10009763
		inc	ebx

loc_10009763:				; CODE XREF: sub_10009320+440j
		inc	edx
		cmp	edx, 2
		jl	short loc_10009750
		movzx	ebp, byte ptr [ebp+54h]
		mov	eax, [esi+2F38h]
		lea	ebp, [ebp+edi*2+26h]
		add	ebp, ebx
		add	ebp, [esp+30h+var_18]
		mov	[esp+30h+var_8], ebx
		cmp	eax, 1
		jnz	short loc_100097CD
		movzx	ecx, byte ptr [esi+914h]
		lea	ebp, [ecx+ebp+1]

loc_10009791:				; CODE XREF: sub_10009320+4B2j
					; sub_10009320+4B8j
		mov	[esp+30h+var_4], 0

loc_10009799:				; CODE XREF: sub_10009320+4CDj
		push	ebp		; int
		push	1		; char
		push	esi		; Src
		call	sub_10008FF0
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_100097EF
		mov	edx, [esp+30h+var_20]
		mov	eax, [edx+0ECh]
		test	eax, eax
		jz	short loc_100097C3
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_100097C3:				; CODE XREF: sub_10009320+497j
					; sub_10009320+537j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100097CD:				; CODE XREF: sub_10009320+464j
		cmp	[esp+30h+var_4], 0
		jz	short loc_10009791
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_10009791
		push	ebp
		call	sub_10016A90
		add	[esp+34h+var_18], eax
		add	esp, 4
		mov	[esp+30h+var_4], eax
		add	ebp, eax
		jmp	short loc_10009799
; ---------------------------------------------------------------------------

loc_100097EF:				; CODE XREF: sub_10009320+489j
		cmp	dword ptr [esi+2F38h], 1
		movzx	eax, word ptr [esi+44h]
		mov	[esi+46h], ax
		jnz	short loc_10009828
		push	eax
		call	sub_10002170
		movzx	eax, ax
		push	2		; Size
		lea	edx, [esp+38h+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+40h+Src],	cl
		mov	byte ptr [esp+40h+Src+1], al
		call	sub_10008E00
		add	esp, 10h
		jmp	short loc_10009845
; ---------------------------------------------------------------------------

loc_10009828:				; CODE XREF: sub_10009320+4DEj
		push	2		; Size
		lea	edx, [esp+34h+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+3Ch+Src],	cl
		mov	byte ptr [esp+3Ch+Src+1], al
		call	sub_10008E00
		add	esp, 0Ch

loc_10009845:				; CODE XREF: sub_10009320+506j
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_10009871

loc_1000984B:				; CODE XREF: sub_10009320+5A5j
					; sub_10009320+7EDj
		mov	eax, [esp+30h+var_20]
		mov	eax, [eax+0ECh]
		test	eax, eax
		jz	loc_100097C3
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10009871:				; CODE XREF: sub_10009320+529j
		cmp	[esp+30h+arg_4], 0
		jnz	short loc_100098AF
		lea	eax, [esi+4A0h]
		call	sub_100034A0
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_100098AF
		mov	ecx, [esp+30h+var_20]
		mov	eax, [ecx+0ECh]
		test	eax, eax
		jz	loc_100097C3
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100098AF:				; CODE XREF: sub_10009320+556j
					; sub_10009320+567j
		push	20h		; Size
		lea	edx, [esi+4A0h]
		push	edx		; Src
		push	esi		; int
		call	sub_10008E00
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1000984B
		mov	ebp, [esp+30h+var_20]
		movzx	ebx, byte ptr [ebp+54h]
		push	1		; Size
		lea	ecx, [esp+34h+Src]
		push	ecx		; Src
		push	esi		; int
		mov	byte ptr [esp+3Ch+Src],	bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100098F5
		push	ebx		; Size
		lea	edx, [ebp+55h]
		push	edx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_100098F5:				; CODE XREF: sub_10009320+5C5j
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1000991D

loc_100098FB:				; CODE XREF: sub_10009320+63Aj
					; sub_10009320+660j ...
		mov	eax, [ebp+0ECh]
		test	eax, eax
		jz	loc_100097C3
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000991D:				; CODE XREF: sub_10009320+5D9j
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_1000995C
		movzx	ebx, byte ptr [esi+914h]
		push	1		; Size
		lea	eax, [esp+34h+Src]
		push	eax		; Src
		push	esi		; int
		mov	byte ptr [esp+3Ch+Src],	bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10009956
		push	ebx		; Size
		lea	ecx, [esi+8F4h]
		push	ecx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_10009956:				; CODE XREF: sub_10009320+623j
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_100098FB

loc_1000995C:				; CODE XREF: sub_10009320+604j
		lea	eax, [edi+edi]
		mov	edx, eax
		mov	byte ptr [esp+30h+Src+1], al
		push	2		; Size
		lea	eax, [esp+34h+Src]
		push	eax		; Src
		sar	edx, 8
		push	esi		; int
		mov	byte ptr [esp+3Ch+Src],	dl
		call	sub_10008E00
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_100098FB
		cmp	[esi+844h], eax
		jz	short loc_100099B7
		push	2		; Size
		lea	ecx, [esp+34h+Src]
		push	ecx		; Src
		push	esi		; int
		mov	[esp+3Ch+Src], 0FF00h
		call	sub_10008E00
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_100098FB
		mov	[esp+30h+var_1C], 1

loc_100099B7:				; CODE XREF: sub_10009320+66Cj
		cmp	[esp+30h+var_C], 0
		jz	short loc_100099E3
		push	2		; Size
		lea	edx, [esp+34h+var_C]
		push	edx		; Src
		push	esi		; int
		mov	word ptr [esp+3Ch+var_C], 56h
		call	sub_10008E00
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_100098FB
		inc	[esp+30h+var_1C]

loc_100099E3:				; CODE XREF: sub_10009320+69Cj
		xor	edi, edi
		lea	ebx, [esi+352h]
		jmp	short loc_100099F0
; ---------------------------------------------------------------------------
		align 10h

loc_100099F0:				; CODE XREF: sub_10009320+6CBj
					; sub_10009320+73Fj
		mov	ecx, [esi+468h]
		test	ecx, ecx
		jz	short loc_10009A58
		mov	al, [ebx+1]
		test	al, 1
		jz	short loc_10009A58
		test	al, 2
		jz	short loc_10009A58
		mov	al, [ebx]
		test	al, al
		jz	short loc_10009A58
		movzx	eax, al
		cmp	eax, ecx
		jg	short loc_10009A58
		movzx	ebp, word ptr [ebx-2]
		lea	ecx, [esi+18h]
		mov	eax, ebp
		call	sub_10003040
		test	eax, eax
		jz	short loc_10009A58
		mov	eax, [esp+30h+var_1C]
		inc	eax
		mov	[esp+30h+var_1C], eax
		cmp	eax, [esp+30h+var_14]
		jg	short loc_10009A9F
		mov	eax, ebp
		push	2		; Size
		lea	edx, [esp+34h+var_C]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+3Ch+var_C], cl
		mov	byte ptr [esp+3Ch+var_C+1], al
		call	sub_10008E00
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_10009ACF

loc_10009A58:				; CODE XREF: sub_10009320+6D8j
					; sub_10009320+6DFj ...
		inc	edi
		add	ebx, 4
		cmp	edi, 3Dh
		jl	short loc_100099F0
		mov	edx, [esp+30h+var_14]
		cmp	[esp+30h+var_1C], edx
		jz	loc_10009AF1
		mov	eax, [esp+30h+var_20]
		mov	eax, [eax+0ECh]
		test	eax, eax
		jz	short loc_10009A87
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_10009A87:				; CODE XREF: sub_10009320+75Bj
		push	0FFFFD053h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10009A9F:				; CODE XREF: sub_10009320+711j
		mov	eax, [esp+30h+var_20]
		mov	eax, [eax+0ECh]
		test	eax, eax
		jz	short loc_10009AB7
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_10009AB7:				; CODE XREF: sub_10009320+78Bj
		push	0FFFFD053h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10009ACF:				; CODE XREF: sub_10009320+736j
		mov	ecx, [esp+30h+var_20]
		mov	eax, [ecx+0ECh]
		test	eax, eax
		jz	short loc_10009AE7
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_10009AE7:				; CODE XREF: sub_10009320+7BBj
					; sub_10009320+885j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10009AF1:				; CODE XREF: sub_10009320+749j
		mov	cl, byte ptr [esp+30h+var_8]
		push	1		; Size
		lea	edx, [esp+34h+var_8]
		push	edx		; Src
		push	esi		; int
		mov	byte ptr [esp+3Ch+var_8], cl
		call	sub_10008E00
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_1000984B

loc_10009B13:				; CODE XREF: sub_10009320+825j
		movzx	edx, ds:byte_1002A5A8[ebx]
		mov	eax, edx
		mov	ecx, esi
		call	sub_10002FF0
		test	eax, eax
		jz	short loc_10009B41
		push	1		; Size
		lea	ecx, [esp+34h+var_8]
		push	ecx		; Src
		push	esi		; int
		mov	byte ptr [esp+3Ch+var_8], dl
		call	sub_10008E00
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_10009B99

loc_10009B41:				; CODE XREF: sub_10009320+805j
		inc	ebx
		cmp	ebx, 2
		jl	short loc_10009B13
		mov	ebx, [esp+30h+var_18]
		test	ebx, ebx
		jz	loc_10009BE3
		add	ebx, 0FFFFFFFEh
		push	2		; Size
		lea	ecx, [esp+34h+var_8]
		mov	eax, ebx
		push	ecx		; Src
		sar	eax, 8
		push	esi		; int
		mov	byte ptr [esp+3Ch+var_8], al
		mov	byte ptr [esp+3Ch+var_8+1], bl
		call	sub_10008E00
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_10009B99
		push	eax
		push	ebx
		push	1
		push	esi
		call	sub_100162F0
		add	esp, 10h
		test	eax, eax
		jns	short loc_10009BBF
		mov	eax, [esp+30h+var_20]
		mov	eax, [eax+0ECh]
		jmp	loc_10009693
; ---------------------------------------------------------------------------

loc_10009B99:				; CODE XREF: sub_10009320+81Fj
					; sub_10009320+857j
		mov	edx, [esp+30h+var_20]
		mov	eax, [edx+0ECh]
		test	eax, eax
		jz	loc_10009AE7
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10009BBF:				; CODE XREF: sub_10009320+868j
		mov	ecx, [esp+30h+var_4]
		sub	ebx, eax
		push	ebx
		push	ecx
		push	esi
		call	sub_10016AC0
		add	esp, 0Ch
		test	eax, eax
		jns	short loc_10009BE3
		mov	edx, [esp+30h+var_20]
		mov	eax, [edx+0ECh]
		jmp	loc_10009693
; ---------------------------------------------------------------------------

loc_10009BE3:				; CODE XREF: sub_10009320+82Dj
					; sub_10009320+8B2j
		mov	eax, [esp+30h+var_20]
		mov	eax, [eax+0ECh]
		test	eax, eax
		jz	short loc_10009BFB
		push	eax
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_10009BFB:				; CODE XREF: sub_10009320+8CFj
		cmp	dword ptr [esi+2F2Ch], 0
		jz	short loc_10009C12
		push	offset dword_100374F4
		call	ds:__imp_PR_AtomicIncrement
		add	esp, 4

loc_10009C12:				; CODE XREF: sub_10009320+8E2j
		cmp	dword ptr [esi+844h], 0
		jz	short loc_10009C36
		movzx	ecx, word ptr [esi+2EF4h]
		mov	edx, 0FF01h
		mov	[esi+ecx*2+2EF8h], dx
		inc	word ptr [esi+2EF4h]

loc_10009C36:				; CODE XREF: sub_10009320+8F9j
		xor	edx, edx
		cmp	[esi+24h], edx
		jnz	short loc_10009C4B
		cmp	dword ptr [esi+2F38h], 1
		jz	short loc_10009C4B
		mov	edx, 4000000h

loc_10009C4B:				; CODE XREF: sub_10009320+91Bj
					; sub_10009320+924j
		mov	eax, esi
		call	sub_10008940
		test	eax, eax
		jnz	short loc_10009C60
		mov	dword ptr [esi+4C0h], 6

loc_10009C60:				; CODE XREF: sub_10009320+24j
					; sub_10009320+5Fj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10009320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009C70	proc near		; CODE XREF: sub_1000F030:loc_1000F267p
		mov	eax, [esi+4C0h]
		push	edi
		mov	edi, [esi+0F4h]
		cmp	eax, 6
		jnz	short loc_10009C86
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10009C86:				; CODE XREF: sub_10009C70+10j
		cmp	eax, 0Dh
		jnz	loc_10009D65
		cmp	dword ptr [esi+4Ch], 0
		jnz	loc_10009D65
		mov	eax, [esi+14h]
		test	eax, 180000h
		jnz	short loc_10009CEF
		test	eax, 10000h
		jnz	short loc_10009CBA
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10009CBA:				; CODE XREF: sub_10009C70+38j
		push	64h
		push	1
		push	esi
		call	sub_10008960
		add	esp, 0Ch
		test	byte ptr [esi+16h], 1
		jnz	short loc_10009CDD
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10009CDD:				; CODE XREF: sub_10009C70+5Bj
		push	0FFFFD070h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10009CEF:				; CODE XREF: sub_10009C70+31j
		test	edi, edi
		jz	short loc_10009D16
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_10009D03
		push	edi
		call	eax
		add	esp, 4

loc_10009D03:				; CODE XREF: sub_10009C70+8Bj
		push	edi
		call	sub_10017FD0
		add	esp, 4
		mov	dword ptr [esi+0F4h], 0

loc_10009D16:				; CODE XREF: sub_10009C70+81j
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_10009D28
		push	esi
		call	sub_10002470
		add	esp, 4

loc_10009D28:				; CODE XREF: sub_10009C70+ADj
		test	byte ptr [esi+16h], 1
		jnz	short loc_10009D3E
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10009D3E:				; CODE XREF: sub_10009C70+BCj
		push	0
		push	esi
		call	sub_10009320
		add	esp, 8
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_10009D61
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10009D61:				; CODE XREF: sub_10009C70+DFj
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10009D65:				; CODE XREF: sub_10009C70+19j
					; sub_10009C70+23j
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD029h
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_10009C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009D90	proc near		; CODE XREF: sub_1000A3A0+10Dp

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
Size		= dword	ptr -84h
Src		= dword	ptr -80h
Str		= dword	ptr -7Ch
var_78		= byte ptr -78h
var_77		= byte ptr -77h
var_76		= byte ptr -76h
var_75		= byte ptr -75h
var_74		= byte ptr -74h
var_73		= byte ptr -73h
var_72		= byte ptr -72h
var_71		= byte ptr -71h
var_70		= byte ptr -70h
var_6F		= byte ptr -6Fh
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_6C		= byte ptr -6Ch
var_6B		= byte ptr -6Bh
var_6A		= byte ptr -6Ah
var_69		= byte ptr -69h
var_68		= byte ptr -68h
var_67		= byte ptr -67h
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+94h+arg_0]
		xor	eax, eax
		push	esi
		or	esi, 0FFFFFFFFh
		test	byte ptr [ebp+16h], 1
		push	edi
		mov	ebx, ecx
		mov	[esp+9Ch+var_8C], eax
		mov	[esp+9Ch+var_88], eax
		mov	[esp+9Ch+Size],	eax
		jnz	short loc_10009DD7
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_10009DD7:				; CODE XREF: sub_10009D90+36j
		mov	eax, [ebp+454h]
		mov	ecx, 300h
		cmp	cx, [eax+58h]
		push	eax
		sbb	ecx, ecx
		neg	ecx
		push	ebp
		xor	edi, edi
		mov	[esp+0A4h+Src],	ecx
		call	sub_10006900
		add	esp, 8
		test	byte ptr [ebp+16h], 1
		mov	edi, eax
		jnz	short loc_10009E11
		mov	edx, [ebp+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_10009E11:				; CODE XREF: sub_10009D90+70j
		test	edi, edi
		jnz	short loc_10009E27
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4
		jmp	loc_1000A1AE
; ---------------------------------------------------------------------------

loc_10009E27:				; CODE XREF: sub_10009D90+83j
		push	ebx
		call	SECKEY_PublicKeyStrength
		push	eax
		mov	[esp+0A4h+Size], eax
		call	PORT_Alloc_Util
		add	esp, 8
		mov	[esp+9Ch+var_88], eax
		test	eax, eax
		jz	loc_1000A1BF
		lea	eax, [esp+9Ch+var_8C]
		push	eax
		push	edi
		push	ebx
		push	1
		call	PK11_PubWrapSymKey
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_10009E6F
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4
		jmp	loc_1000A1AE
; ---------------------------------------------------------------------------

loc_10009E6F:				; CODE XREF: sub_10009D90+CBj
		cmp	File, 0
		jz	loc_1000A11E
		push	edi
		call	PK11_ExtractKeyValue
		add	esp, 4
		test	eax, eax
		jnz	loc_1000A11E
		push	edi
		call	PK11_GetKeyData
		add	esp, 4
		test	eax, eax
		jz	loc_1000A11E
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	loc_1000A11E
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_1000A11E
		mov	edx, File
		test	edx, edx
		jz	loc_1000A11E
		mov	esi, 8
		cmp	[esp+9Ch+Size],	esi
		jb	loc_1000A11E
		cmp	eax, 30h
		jnz	loc_1000A11E
		mov	eax, ds:dword_1002B074
		mov	[esp+9Ch+Str], eax
		movzx	eax, ds:byte_1002B078
		mov	[esp+9Ch+var_78], al
		mov	eax, [esp+9Ch+var_88]
		movzx	ebx, byte ptr [eax]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_78], bl
		movzx	ebx, byte ptr [eax]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_77], bl
		movzx	ebx, byte ptr [eax+1]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_76], bl
		movzx	ebx, byte ptr [eax+1]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_75], bl
		movzx	ebx, byte ptr [eax+2]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_74], bl
		movzx	ebx, byte ptr [eax+2]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_73], bl
		movzx	ebx, byte ptr [eax+3]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_72], bl
		movzx	ebx, byte ptr [eax+3]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_71], bl
		movzx	ebx, byte ptr [eax+4]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_70], bl
		movzx	ebx, byte ptr [eax+4]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6F], bl
		movzx	ebx, byte ptr [eax+5]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6E], bl
		movzx	ebx, byte ptr [eax+5]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6D], bl
		movzx	ebx, byte ptr [eax+6]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6C], bl
		movzx	ebx, byte ptr [eax+6]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6B], bl
		movzx	ebx, byte ptr [eax+7]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[esp+9Ch+var_6A], bl
		movzx	eax, byte ptr [eax+7]
		and	eax, 0Fh
		movzx	eax, ds:byte_1002AFBC[eax]
		mov	[esp+9Ch+var_69], al
		mov	[esp+9Ch+var_68], 20h
		lea	eax, [esp+9Ch+var_67]
		inc	ecx
		lea	ebx, [ebx+0]

loc_1000A020:				; CODE XREF: sub_10009D90+360j
		movzx	ebx, byte ptr [ecx-1]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax], bl
		movzx	ebx, byte ptr [ecx-1]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+1], bl
		movzx	ebx, byte ptr [ecx]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+2], bl
		movzx	ebx, byte ptr [ecx]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+3], bl
		movzx	ebx, byte ptr [ecx+1]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+4], bl
		movzx	ebx, byte ptr [ecx+1]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+5], bl
		movzx	ebx, byte ptr [ecx+2]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+6], bl
		movzx	ebx, byte ptr [ecx+2]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+7], bl
		movzx	ebx, byte ptr [ecx+3]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+8], bl
		movzx	ebx, byte ptr [ecx+3]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+9], bl
		movzx	ebx, byte ptr [ecx+4]
		shr	ebx, 4
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+0Ah], bl
		movzx	ebx, byte ptr [ecx+4]
		and	ebx, 0Fh
		movzx	ebx, ds:byte_1002AFBC[ebx]
		mov	[eax+0Bh], bl
		add	eax, 0Ch
		add	ecx, 6
		dec	esi
		jnz	loc_1000A020
		push	edx		; File
		push	1		; Count
		lea	ecx, [esp+0A4h+Str]
		push	76h		; Size
		push	ecx		; Str
		mov	[esp+0ACh+var_7], 0Ah
		call	ds:fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h

loc_1000A11E:				; CODE XREF: sub_10009D90+E6j
					; sub_10009D90+F7j ...
		push	edi
		push	ebp
		call	sub_100087C0
		push	edi
		mov	esi, eax
		call	PK11_FreeSymKey
		add	esp, 0Ch
		xor	edi, edi
		test	esi, esi
		jz	short loc_1000A145
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4
		jmp	short loc_1000A1AE
; ---------------------------------------------------------------------------

loc_1000A145:				; CODE XREF: sub_10009D90+3A4j
		mov	ebx, [esp+9Ch+Src]
		mov	eax, [esp+9Ch+Size]
		test	ebx, ebx
		jz	short loc_1000A154
		add	eax, 2

loc_1000A154:				; CODE XREF: sub_10009D90+3BFj
		push	eax		; int
		push	10h		; char
		push	ebp		; Src
		call	sub_10008FF0
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1000A1AE
		mov	eax, [esp+9Ch+Size]
		test	ebx, ebx
		jz	short loc_1000A199
		mov	ebx, [esp+9Ch+var_88]
		push	2		; Size
		lea	edx, [esp+0A0h+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	ebp		; int
		mov	esi, eax
		mov	byte ptr [esp+0A8h+Src], cl
		mov	byte ptr [esp+0A8h+Src+1], al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000A1A8
		push	esi
		push	ebx
		jmp	short loc_1000A19F
; ---------------------------------------------------------------------------

loc_1000A199:				; CODE XREF: sub_10009D90+3DCj
		mov	ecx, [esp+9Ch+var_88]
		push	eax		; Size
		push	ecx		; Src

loc_1000A19F:				; CODE XREF: sub_10009D90+407j
		push	ebp		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000A1A8:				; CODE XREF: sub_10009D90+403j
		mov	esi, eax
		test	esi, esi
		jnz	short $+2

loc_1000A1AE:				; CODE XREF: sub_10009D90+92j
					; sub_10009D90+DAj ...
		mov	eax, [esp+9Ch+var_88]
		test	eax, eax
		jz	short loc_1000A1BF
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000A1BF:				; CODE XREF: sub_10009D90+B0j
					; sub_10009D90+424j
		test	edi, edi
		jz	short loc_1000A1CC
		push	edi
		call	PK11_FreeSymKey
		add	esp, 4

loc_1000A1CC:				; CODE XREF: sub_10009D90+431j
		mov	ecx, [esp+9Ch+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
sub_10009D90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A1F0	proc near		; CODE XREF: sub_1000A3A0+103p

Src		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 20h
		push	ebx
		push	ebp
		mov	ebp, [esp+28h+arg_0]
		push	esi
		mov	esi, eax
		mov	eax, [ebp+454h]
		or	ebx, 0FFFFFFFFh
		mov	ecx, 300h
		mov	[esp+2Ch+arg_0], 0
		cmp	cx, [eax+58h]
		push	edi
		sbb	edi, edi
		neg	edi
		cmp	dword ptr [esi+4], 4
		jz	short loc_1000A230
		push	0FFFFE00Eh
		call	PORT_SetError_Util
		jmp	loc_1000A375
; ---------------------------------------------------------------------------

loc_1000A230:				; CODE XREF: sub_1000A1F0+2Fj
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+24h]
		mov	edx, [esi+18h]
		mov	[esp+30h+var_10], eax
		push	0
		lea	eax, [esp+34h+arg_0]
		mov	[esp+34h+var_8], ecx
		mov	[esp+34h+var_14], edx
		mov	edx, [esi+28h]
		push	eax
		lea	ecx, [esp+38h+var_1C]
		push	ecx
		mov	[esp+3Ch+var_4], edx
		call	SECKEY_CreateDHPrivateKey
		add	esp, 0Ch
		mov	[esp+30h+Src], eax
		test	eax, eax
		jz	loc_1000A357
		cmp	[esp+30h+arg_0], 0
		jz	loc_1000A357
		xor	ecx, ecx
		push	0
		test	edi, edi
		setnz	cl
		push	0
		push	10Ch
		lea	ecx, ds:373h[ecx*4]
		push	ecx
		push	21h
		push	0
		push	0
		push	0
		push	esi
		push	eax
		call	PK11_PubDerive
		mov	esi, eax
		add	esp, 28h
		test	esi, esi
		jnz	short loc_1000A2B9
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4
		jmp	loc_1000A367
; ---------------------------------------------------------------------------

loc_1000A2B9:				; CODE XREF: sub_1000A1F0+B5j
		mov	edx, [esp+30h+Src]
		push	edx
		call	SECKEY_DestroyPrivateKey
		push	esi
		push	ebp
		call	sub_100087C0
		push	esi
		mov	ebx, eax
		call	PK11_FreeSymKey
		add	esp, 10h
		test	ebx, ebx
		jz	short loc_1000A2E8
		push	0FFFFD045h
		call	sub_100147C0
		jmp	loc_1000A375
; ---------------------------------------------------------------------------

loc_1000A2E8:				; CODE XREF: sub_1000A1F0+E7j
		mov	eax, [esp+30h+arg_0]
		mov	ecx, [eax+34h]
		add	ecx, 2
		push	ecx		; int
		push	10h		; char
		push	ebp		; Src
		call	sub_10008FF0
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1000A378
		mov	eax, [esp+30h+arg_0]
		mov	ebx, [eax+34h]
		mov	esi, [eax+30h]
		push	2		; Size
		lea	eax, [esp+34h+Src]
		mov	edx, ebx
		push	eax		; Src
		sar	edx, 8
		push	ebp		; int
		mov	byte ptr [esp+3Ch+Src],	dl
		mov	byte ptr [esp+3Ch+Src+1], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000A33A
		push	ebx		; Size
		push	esi		; Src
		push	ebp		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000A33A:				; CODE XREF: sub_1000A1F0+13Dj
		mov	ecx, [esp+30h+arg_0]
		push	ecx
		mov	esi, eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000A393
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000A357:				; CODE XREF: sub_1000A1F0+76j
					; sub_1000A1F0+81j
		push	0FFFFE064h
		call	sub_100147C0
		add	esp, 4
		or	ebx, 0FFFFFFFFh

loc_1000A367:				; CODE XREF: sub_1000A1F0+C4j
		mov	eax, [esp+30h+Src]
		test	eax, eax
		jz	short loc_1000A378
		push	eax
		call	SECKEY_DestroyPrivateKey

loc_1000A375:				; CODE XREF: sub_1000A1F0+3Bj
					; sub_1000A1F0+F3j
		add	esp, 4

loc_1000A378:				; CODE XREF: sub_1000A1F0+112j
					; sub_1000A1F0+17Dj
		mov	eax, [esp+30h+arg_0]
		test	eax, eax
		jz	short loc_1000A389
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_1000A389:				; CODE XREF: sub_1000A1F0+18Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000A393:				; CODE XREF: sub_1000A1F0+15Bj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_1000A1F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A3A0	proc near		; CODE XREF: sub_1000D520:loc_1000D61Cp
		push	ebp
		push	edi
		mov	edi, [esi+70h]
		or	ebp, 0FFFFFFFFh
		test	edi, edi
		jnz	short loc_1000A3D0
		mov	eax, [esi+6Ch]
		push	eax
		call	CERT_ExtractPublicKey
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000A3D7
		push	0FFFFD043h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		or	eax, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3D0:				; CODE XREF: sub_1000A3A0+Aj
		mov	dword ptr [esi+70h], 0

loc_1000A3D7:				; CODE XREF: sub_1000A3A0+1Cj
		mov	ecx, [esi+454h]
		mov	edx, 300h
		cmp	dx, [ecx+58h]
		mov	ecx, [esi+808h]
		push	ebx
		sbb	ebx, ebx
		neg	ebx
		cmp	dword ptr [ecx+0Ch], 0
		jz	short loc_1000A45D
		push	edi
		call	SECKEY_PublicKeyStrength
		mov	ecx, [esi+808h]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		add	esp, 4
		cmp	eax, [ecx+10h]
		jle	short loc_1000A45D
		test	ebx, ebx
		jz	short loc_1000A431
		push	3Ch
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch
		push	0FFFFD04Eh
		call	PORT_SetError_Util
		jmp	loc_1000A4B4
; ---------------------------------------------------------------------------

loc_1000A431:				; CODE XREF: sub_1000A3A0+73j
		push	28h
		push	2
		push	esi
		call	sub_10008960
		mov	ecx, [esi+4Ch]
		neg	ecx
		sbb	ecx, ecx
		add	ecx, 0FFFFD007h
		push	ecx
		call	PORT_SetError_Util
		add	esp, 10h
		push	0FFFFD04Eh
		call	PORT_SetError_Util
		jmp	short loc_1000A4B4
; ---------------------------------------------------------------------------

loc_1000A45D:				; CODE XREF: sub_1000A3A0+55j
					; sub_1000A3A0+6Fj
		mov	edx, [ecx+4]
		push	edi
		mov	[esi+7Ch], edx
		call	SECKEY_PublicKeyStrengthInBits
		mov	[esi+80h], eax
		mov	eax, [esi+808h]
		mov	eax, [eax+4]
		add	esp, 4
		dec	eax
		jz	short loc_1000A4AA
		dec	eax
		jz	short loc_1000A4A0
		sub	eax, 2
		jz	short loc_1000A492
		push	0FFFFE030h
		call	PORT_SetError_Util
		jmp	short loc_1000A4B4
; ---------------------------------------------------------------------------

loc_1000A492:				; CODE XREF: sub_1000A3A0+E4j
		push	edi		; int
		push	esi		; Src
		call	sub_10020B70
		add	esp, 8
		mov	ebp, eax
		jmp	short loc_1000A4B7
; ---------------------------------------------------------------------------

loc_1000A4A0:				; CODE XREF: sub_1000A3A0+DFj
		push	esi
		mov	eax, edi
		call	sub_1000A1F0
		jmp	short loc_1000A4B2
; ---------------------------------------------------------------------------

loc_1000A4AA:				; CODE XREF: sub_1000A3A0+DCj
		push	esi
		mov	ecx, edi
		call	sub_10009D90

loc_1000A4B2:				; CODE XREF: sub_1000A3A0+108j
		mov	ebp, eax

loc_1000A4B4:				; CODE XREF: sub_1000A3A0+8Cj
					; sub_1000A3A0+BBj ...
		add	esp, 4

loc_1000A4B7:				; CODE XREF: sub_1000A3A0+FEj
		pop	ebx
		test	edi, edi
		jz	short loc_1000A4C5
		push	edi
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_1000A4C5:				; CODE XREF: sub_1000A3A0+11Aj
		pop	edi
		mov	eax, ebp
		pop	ebp
		retn
sub_1000A3A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A4D0	proc near		; CODE XREF: sub_1000D520+10Fp

Src		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
Size		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_4		= dword	ptr -4

		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		push	ebx
		push	ebp
		xor	ebp, ebp
		test	byte ptr [esi+16h], 1
		push	edi
		mov	[esp+70h+var_60], ebp
		mov	[esp+70h+var_5C], ebp
		mov	[esp+70h+Size],	ebp
		jnz	short loc_1000A504
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000A504:				; CODE XREF: sub_1000A4D0+23j
		cmp	dword ptr [esi+4C4h], 2
		jnz	short loc_1000A522
		cmp	[esi+800h], ebp
		jz	short loc_1000A522
		lea	edi, [esp+70h+var_4C]
		mov	ebx, esi
		call	sub_10005D50
		jmp	short loc_1000A536
; ---------------------------------------------------------------------------

loc_1000A522:				; CODE XREF: sub_1000A4D0+3Bj
					; sub_1000A4D0+43j
		mov	ecx, [esi+454h]
		push	ebp
		push	esi
		lea	edx, [esp+78h+var_4C]
		call	sub_100056B0
		add	esp, 8

loc_1000A536:				; CODE XREF: sub_1000A4D0+50j
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1000A54D
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000A54D:				; CODE XREF: sub_1000A4D0+6Cj
		cmp	edi, ebp
		jnz	loc_1000A6A1
		mov	edx, [esi+454h]
		movzx	ecx, word ptr [edx+58h]
		mov	eax, 300h
		cmp	ax, cx
		sbb	eax, eax
		neg	eax
		push	eax
		mov	edx, 303h
		cmp	cx, dx
		mov	ecx, [esi+45Ch]
		mov	edx, [ecx+4]
		lea	eax, [esp+74h+var_60]
		push	eax
		push	ecx
		lea	ecx, [esp+7Ch+var_4C]
		sbb	ebx, ebx
		push	ecx
		inc	ebx
		mov	[esp+80h+var_54], edx
		call	sub_100034D0
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebp
		jnz	short loc_1000A5F6
		mov	edx, [esi+45Ch]
		mov	ebp, [esi+0F4h]
		push	edx
		call	PK11_GetSlotFromPrivateKey
		push	eax
		mov	[esp+78h+Src], eax
		call	PK11_GetSlotSeries
		mov	[ebp+0DCh], ax
		mov	eax, [esp+78h+Src]
		push	eax
		call	PK11_GetSlotID
		mov	ecx, [esp+7Ch+Src]
		push	ecx
		mov	[ebp+0D8h], eax
		call	PK11_GetModuleID
		mov	edx, [esp+80h+Src]
		push	edx
		mov	[ebp+0D4h], eax
		mov	byte ptr [ebp+0DFh], 1
		call	PK11_FreeSlot
		add	esp, 14h
		xor	ebp, ebp

loc_1000A5F6:				; CODE XREF: sub_1000A4D0+CBj
		mov	eax, [esi+45Ch]
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4
		mov	[esi+45Ch], ebp
		cmp	edi, ebp
		jnz	loc_1000A6A1
		mov	edx, [esp+70h+Size]
		mov	ecx, ebx
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 2
		lea	eax, [ecx+edx+2]
		push	eax		; int
		push	0Fh		; char
		push	esi		; Src
		call	sub_10008FF0
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebp
		jnz	short loc_1000A6A1
		cmp	ebx, ebp
		jz	short loc_1000A669
		mov	eax, [esp+70h+var_54]
		lea	ecx, [esp+70h+var_50]
		call	sub_100055C0
		mov	edi, eax
		cmp	edi, ebp
		jnz	short loc_1000A6A1
		mov	eax, [esp+70h+var_48]
		lea	ecx, [esp+70h+var_54]
		push	ecx
		push	esi
		mov	[esp+78h+var_54], eax
		call	sub_100090F0
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jnz	short loc_1000A6A1

loc_1000A669:				; CODE XREF: sub_1000A4D0+168j
		mov	eax, [esp+70h+Size]
		mov	ebx, [esp+70h+var_5C]
		mov	edx, eax
		mov	edi, eax
		mov	byte ptr [esp+70h+Src+1], al
		push	2		; Size
		lea	eax, [esp+74h+Src]
		push	eax		; Src
		sar	edx, 8
		push	esi		; int
		mov	byte ptr [esp+7Ch+Src],	dl
		call	sub_10008E00
		add	esp, 0Ch
		cmp	eax, ebp
		jnz	short loc_1000A69F
		push	edi		; Size
		push	ebx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000A69F:				; CODE XREF: sub_1000A4D0+1C2j
		mov	edi, eax

loc_1000A6A1:				; CODE XREF: sub_1000A4D0+7Fj
					; sub_1000A4D0+13Dj ...
		mov	eax, [esp+70h+var_5C]
		cmp	eax, ebp
		jz	short loc_1000A6B2
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000A6B2:				; CODE XREF: sub_1000A4D0+1D7j
		mov	ecx, [esp+70h+var_4]
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
sub_1000A4D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A6D0	proc near		; CODE XREF: sub_1000F030+2BCp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
Src		= dword	ptr -14h
Size		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 28h
		push	ebx
		push	ebp
		push	esi
		mov	esi, eax
		mov	ebp, [esi+0F4h]
		push	edi
		xor	edi, edi
		cmp	dword ptr [esi+4C0h], 6
		mov	[esp+38h+var_24], 0FFFFD01Dh
		mov	[esp+38h+Src], edi
		mov	[esp+38h+Size],	edi
		mov	[esp+38h+var_28], 2Fh
		jz	short loc_1000A717
		mov	[esp+38h+var_24], 0FFFFD02Bh
		mov	[esp+38h+var_28], 0Ah
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A717:				; CODE XREF: sub_1000A6D0+30j
		mov	eax, [esi+460h]
		cmp	eax, edi
		jz	short loc_1000A730
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4
		mov	[esi+460h], edi

loc_1000A730:				; CODE XREF: sub_1000A6D0+4Fj
		mov	eax, [esi+458h]
		cmp	eax, edi
		jz	short loc_1000A749
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi+458h], edi

loc_1000A749:				; CODE XREF: sub_1000A6D0+68j
		mov	eax, [esi+45Ch]
		cmp	eax, edi
		jz	short loc_1000A762
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4
		mov	[esi+45Ch], edi

loc_1000A762:				; CODE XREF: sub_1000A6D0+81j
		lea	eax, [esp+38h+arg_4]
		push	eax
		lea	ecx, [esp+3Ch+arg_0]
		push	ecx
		push	2
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, edi
		jl	loc_1000ADAA
		cmp	dword ptr [esi+2F38h], 1
		movzx	edi, ax
		jnz	short loc_1000A7A0
		push	eax
		call	sub_100021B0
		movzx	edi, ax
		add	esp, 4
		test	di, di
		jz	loc_1000AD9A

loc_1000A7A0:				; CODE XREF: sub_1000A6D0+B9j
		movzx	eax, word ptr [esi+18h]
		test	ax, ax
		jnz	short loc_1000A7B0
		push	0FFFFD014h
		jmp	short loc_1000A7F7
; ---------------------------------------------------------------------------

loc_1000A7B0:				; CODE XREF: sub_1000A6D0+D7j
		cmp	di, ax
		jb	short loc_1000A7F2
		movzx	eax, word ptr [esi+1Ah]
		cmp	di, ax
		ja	short loc_1000A7F2
		jnb	short loc_1000A7C3
		movzx	eax, di

loc_1000A7C3:				; CODE XREF: sub_1000A6D0+EEj
		mov	ecx, 300h
		cmp	cx, ax
		sbb	ebx, ebx
		mov	[esi+44h], ax
		neg	ebx
		call	sub_10008500
		test	eax, eax
		jz	short loc_1000A820
		mov	[esp+38h+var_28], 50h
		call	PORT_GetError_Util
		mov	[esp+38h+var_24], eax
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A7F2:				; CODE XREF: sub_1000A6D0+E3j
					; sub_1000A6D0+ECj
		push	0FFFFD002h

loc_1000A7F7:				; CODE XREF: sub_1000A6D0+DEj
		call	PORT_SetError_Util
		add	esp, 4
		mov	edx, 300h
		cmp	dx, di
		sbb	eax, eax
		and	eax, 1Eh
		add	eax, 28h
		mov	[esp+38h+var_28], eax
		mov	[esp+38h+var_24], 0FFFFD002h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A820:				; CODE XREF: sub_1000A6D0+10Aj
		lea	edx, [esp+38h+arg_4]
		push	edx		; int
		lea	eax, [esp+3Ch+arg_0]
		push	eax		; int
		push	20h		; Size
		lea	ecx, [esi+480h]
		push	ecx		; Dst
		push	esi		; int
		call	sub_10009150
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000ADAA
		lea	edx, [esp+38h+arg_4]
		push	edx
		lea	eax, [esp+3Ch+arg_0]
		push	eax
		push	1
		lea	ecx, [esp+44h+var_18]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000ADAA
		cmp	[esp+38h+Size],	20h
		jbe	short loc_1000A882
		test	ebx, ebx
		jz	loc_1000AD9A
		mov	[esp+38h+var_28], 32h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A882:				; CODE XREF: sub_1000A6D0+19Bj
		lea	edx, [esp+38h+arg_4]
		push	edx
		lea	eax, [esp+3Ch+arg_0]
		push	eax
		push	2
		push	esi
		call	sub_100091C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		js	loc_1000ADAA
		push	esi
		call	sub_10003200
		add	esp, 4
		xor	eax, eax
		lea	edx, [esi+350h]

loc_1000A8B2:				; CODE XREF: sub_1000A6D0+1F0j
		movzx	ecx, word ptr [edx]
		cmp	edi, ecx
		jz	short loc_1000A8D7
		inc	eax
		add	edx, 4
		cmp	eax, 3Dh
		jl	short loc_1000A8B2

loc_1000A8C2:				; CODE XREF: sub_1000A6D0+255j
		mov	[esp+38h+var_28], 28h
		mov	[esp+38h+var_24], 0FFFFD002h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A8D7:				; CODE XREF: sub_1000A6D0+1E7j
		movzx	eax, word ptr [esi+44h]
		mov	ecx, [esi+468h]
		mov	word ptr [esp+38h+var_20], ax
		mov	word ptr [esp+38h+var_20+2], ax
		test	ecx, ecx
		jz	short loc_1000A918
		mov	al, [edx+3]
		test	al, 1
		jz	short loc_1000A918
		test	al, 2
		jz	short loc_1000A918
		mov	al, [edx+2]
		test	al, al
		jz	short loc_1000A918
		movzx	eax, al
		cmp	eax, ecx
		jg	short loc_1000A918
		mov	ax, [edx]
		lea	ecx, [esp+38h+var_20]
		call	sub_10003040
		test	eax, eax
		jnz	short loc_1000A93C

loc_1000A918:				; CODE XREF: sub_1000A6D0+21Dj
					; sub_1000A6D0+224j ...
		lea	ecx, [esp+38h+var_20]
		mov	eax, edi
		call	sub_10003040
		test	eax, eax
		jnz	short loc_1000A8C2
		mov	[esp+38h+var_28], 28h
		mov	[esp+38h+var_24], 0FFFFD079h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A93C:				; CODE XREF: sub_1000A6D0+246j
		mov	edx, edi
		mov	[esi+80Ch], di
		call	sub_100031C0
		mov	[esi+810h], eax
		test	eax, eax
		jnz	short loc_1000A981
		push	0FFFFE001h
		mov	[esp+3Ch+var_24], 0FFFFE001h
		call	PORT_SetError_Util
		mov	edx, [esp+3Ch+var_24]
		add	esp, 4
		push	edx
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000A981:				; CODE XREF: sub_1000A6D0+282j
		lea	ecx, [esp+38h+arg_4]
		push	ecx
		lea	edx, [esp+3Ch+arg_0]
		push	edx
		push	1
		push	esi
		call	sub_100091C0
		mov	edx, eax
		add	esp, 10h
		test	edx, edx
		js	loc_1000ADAA
		xor	eax, eax

loc_1000A9A2:				; CODE XREF: sub_1000A6D0+2E1j
		movzx	ecx, ds:byte_1002A5A8[eax]
		cmp	edx, ecx
		jz	short loc_1000A9C8
		inc	eax
		cmp	eax, 2
		jl	short loc_1000A9A2
		mov	[esp+38h+var_28], 28h
		mov	[esp+38h+var_24], 0FFFFD055h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A9C8:				; CODE XREF: sub_1000A6D0+2DBj
		movzx	eax, ds:byte_1002A5A8[eax]
		mov	ecx, esi
		call	sub_10002FF0
		test	eax, eax
		jnz	short loc_1000A9EF
		mov	[esp+38h+var_28], 28h
		mov	[esp+38h+var_24], 0FFFFD055h
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000A9EF:				; CODE XREF: sub_1000A6D0+308j
		cmp	[esp+38h+arg_4], 0
		mov	[esi+814h], edx
		jz	short loc_1000AA44
		lea	edx, [esp+38h+arg_4]
		push	edx
		lea	eax, [esp+3Ch+arg_0]
		push	eax
		push	2
		lea	ecx, [esp+44h+var_C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000AA3C
		cmp	[esp+38h+arg_4], eax
		jnz	short loc_1000AA3C
		lea	edx, [esp+38h+var_4]
		push	edx
		lea	eax, [esp+3Ch+var_8]
		push	eax
		push	esi
		call	sub_10016190
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000AA44
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000AA3C:				; CODE XREF: sub_1000A6D0+348j
					; sub_1000A6D0+34Ej
		test	ebx, ebx
		jnz	loc_1000AD9A

loc_1000AA44:				; CODE XREF: sub_1000A6D0+32Aj
					; sub_1000A6D0+365j
		mov	eax, [esi+14h]
		test	eax, 200000h
		jnz	short loc_1000AA66
		cmp	dword ptr [esi+24h], 0
		jz	short loc_1000AA95
		cmp	dword ptr [esi+40h], 0
		jnz	short loc_1000AA66
		and	eax, 180000h
		cmp	eax, 100000h
		jnz	short loc_1000AA95

loc_1000AA66:				; CODE XREF: sub_1000A6D0+37Cj
					; sub_1000A6D0+388j
		push	0FF01h
		push	esi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000AA95
		mov	eax, [esi+24h]
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFD071h
		mov	[esp+38h+var_28], 28h
		mov	[esp+38h+var_24], eax
		jmp	loc_1000AD9A
; ---------------------------------------------------------------------------

loc_1000AA95:				; CODE XREF: sub_1000A6D0+382j
					; sub_1000A6D0+394j ...
		mov	[esp+38h+var_28], 28h
		call	sub_10003E40
		test	eax, eax
		jnz	loc_1000AD9A
		mov	ebx, [esp+38h+Size]
		test	ebx, ebx
		jz	loc_1000AD5A
		movzx	ecx, byte ptr [ebp+54h]
		cmp	ebx, ecx
		jnz	loc_1000AD5A
		mov	ecx, [esp+38h+Src]
		mov	eax, ebx
		lea	edi, [ebp+55h]
		cmp	ebx, 4
		jb	short loc_1000AAE8

loc_1000AAD0:				; CODE XREF: sub_1000A6D0+416j
		mov	edx, [edi]
		cmp	edx, [ecx]
		jnz	loc_1000AD5A
		sub	eax, 4
		add	ecx, 4
		add	edi, 4
		cmp	eax, 4
		jnb	short loc_1000AAD0

loc_1000AAE8:				; CODE XREF: sub_1000A6D0+3FEj
		test	eax, eax
		jz	short loc_1000AB18
		mov	dl, [ecx]
		cmp	dl, [edi]
		jnz	loc_1000AD5A
		cmp	eax, 1
		jbe	short loc_1000AB18
		mov	dl, [ecx+1]
		cmp	dl, [edi+1]
		jnz	loc_1000AD5A
		cmp	eax, 2
		jbe	short loc_1000AB18
		mov	al, [ecx+2]
		cmp	al, [edi+2]
		jnz	loc_1000AD5A

loc_1000AB18:				; CODE XREF: sub_1000A6D0+41Aj
					; sub_1000A6D0+429j ...
		mov	cx, [ebp+3Ah]
		cmp	cx, [esi+44h]
		jnz	loc_1000ABB0
		mov	dx, [ebp+76h]
		cmp	dx, [esi+80Ch]
		jnz	loc_1000ABB0
		mov	eax, [ebp+44h]
		mov	edi, [esi+454h]
		mov	[esi+74h], eax
		mov	ecx, [ebp+48h]
		mov	[esi+78h], ecx
		mov	edx, [ebp+4Ch]
		mov	[esi+7Ch], edx
		mov	eax, [ebp+50h]
		mov	[esi+80h], eax
		cmp	byte ptr [ebp+0B2h], 0
		jz	loc_1000AC5C
		test	dword ptr [esi+14h], 8000h
		mov	[esp+38h+var_1C], 0
		jnz	short loc_1000ABB0
		mov	ecx, [ebp+0CCh]
		mov	edx, [ebp+0C8h]
		push	ecx
		push	edx
		call	SECMOD_LookupSlot
		mov	ebx, eax
		add	esp, 8
		mov	[esp+38h+var_20], ebx
		test	ebx, ebx
		jz	short loc_1000ABAC
		push	ebx
		call	PK11_IsPresent
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000ABBA
		push	ebx
		call	PK11_FreeSlot
		add	esp, 4

loc_1000ABAC:				; CODE XREF: sub_1000A6D0+4C4j
					; sub_1000A6D0+523j ...
		mov	ebx, [esp+38h+Size]

loc_1000ABB0:				; CODE XREF: sub_1000A6D0+450j
					; sub_1000A6D0+461j ...
		push	offset dword_100374E4
		jmp	loc_1000AD5F
; ---------------------------------------------------------------------------

loc_1000ABBA:				; CODE XREF: sub_1000A6D0+4D1j
		mov	eax, [esi+22Ch]
		movzx	ecx, word ptr [ebp+0D2h]
		mov	edx, [ebp+0B4h]
		push	eax
		movzx	eax, word ptr [ebp+0D0h]
		push	ecx
		mov	ecx, [esp+40h+var_20]
		push	edx
		push	eax
		push	ecx
		call	PK11_GetWrapKey
		mov	edx, [esp+4Ch+var_20]
		push	edx
		mov	ebx, eax
		call	PK11_FreeSlot
		add	esp, 18h
		test	ebx, ebx
		jz	short loc_1000ABAC
		mov	eax, 300h
		cmp	[esi+44h], ax
		jbe	short loc_1000AC08
		mov	[esp+38h+var_1C], 2800h

loc_1000AC08:				; CODE XREF: sub_1000A6D0+52Ej
		mov	eax, [esp+38h+var_1C]
		movzx	edx, word ptr [ebp+0B0h]
		push	eax
		push	30h
		push	10Ch
		lea	ecx, [ebp+80h]
		push	371h
		mov	[esp+48h+var_8], ecx
		lea	ecx, [esp+48h+var_C]
		push	ecx
		mov	[esp+4Ch+var_4], edx
		mov	edx, [ebp+0B4h]
		push	0
		push	edx
		push	ebx
		call	PK11_UnwrapSymKeyWithFlags
		mov	[edi+44h], eax
		call	PORT_GetError_Util
		push	ebx
		mov	[esp+5Ch+var_24], eax
		call	PK11_FreeSymKey
		add	esp, 24h
		jmp	loc_1000ACDE
; ---------------------------------------------------------------------------

loc_1000AC5C:				; CODE XREF: sub_1000A6D0+48Fj
		test	dword ptr [esi+14h], 8000h
		jz	short loc_1000AC9D
		movzx	ecx, word ptr [ebp+0B0h]
		lea	eax, [ebp+80h]
		push	ecx		; Size
		push	eax		; Src
		lea	ebx, [edi+11CCh]
		push	ebx		; Dst
		mov	[esp+44h+var_8], eax
		mov	[esp+44h+var_4], ecx
		call	memcpy
		mov	[edi+1134h], ebx
		mov	eax, [esp+44h+var_4]
		add	esp, 0Ch
		mov	[edi+1138h], eax
		jmp	short loc_1000ACE8
; ---------------------------------------------------------------------------

loc_1000AC9D:				; CODE XREF: sub_1000A6D0+593j
		call	PK11_GetInternalSlot
		movzx	edx, word ptr [ebp+0B0h]
		push	0
		mov	ebx, eax
		lea	eax, [esp+3Ch+var_C]
		push	eax
		push	104h
		push	4
		lea	ecx, [ebp+80h]
		push	371h
		push	ebx
		mov	[esp+50h+var_8], ecx
		mov	[esp+50h+var_4], edx
		call	PK11_ImportSymKey
		push	ebx
		mov	[edi+44h], eax
		call	PK11_FreeSlot
		add	esp, 1Ch

loc_1000ACDE:				; CODE XREF: sub_1000A6D0+587j
		cmp	dword ptr [edi+44h], 0
		jz	loc_1000ABAC

loc_1000ACE8:				; CODE XREF: sub_1000A6D0+5CBj
		mov	edi, ds:__imp_PR_AtomicIncrement
		push	offset dword_100374DC
		call	edi ; __imp_PR_AtomicIncrement
		add	esp, 4
		cmp	dword ptr [esi+2F2Ch], 0
		jz	short loc_1000AD0B
		push	offset dword_100374F8
		call	edi ; __imp_PR_AtomicIncrement
		add	esp, 4

loc_1000AD0B:				; CODE XREF: sub_1000A6D0+62Fj
		push	23h
		push	esi
		call	sub_10014AB0
		add	esp, 8
		neg	eax
		sbb	eax, eax
		and	eax, 8
		add	eax, 4
		mov	[esi+4C0h], eax
		mov	dword ptr [esi+83Ch], 1
		mov	ebp, [ebp+10h]
		test	ebp, ebp
		jz	short loc_1000AD43
		push	ebp
		call	CERT_DupCertificate
		add	esp, 4
		mov	[esi+6Ch], eax

loc_1000AD43:				; CODE XREF: sub_1000A6D0+665j
		push	0
		push	esi
		call	sub_100087C0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000AD9A
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000AD5A:				; CODE XREF: sub_1000A6D0+3E0j
					; sub_1000A6D0+3ECj ...
		push	offset dword_100374E0

loc_1000AD5F:				; CODE XREF: sub_1000A6D0+4E5j
		call	ds:__imp_PR_AtomicIncrement
		mov	byte ptr [ebp+0B3h], 0
		mov	eax, [esi+88h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1000AD7F
		push	ebp
		call	eax
		add	esp, 4

loc_1000AD7F:				; CODE XREF: sub_1000A6D0+6A7j
		push	ebp
		call	sub_10017FD0
		push	0
		push	esi
		call	sub_100066A0
		add	esp, 0Ch
		mov	[esi+0F4h], eax
		test	eax, eax
		jnz	short loc_1000ADC2

loc_1000AD9A:				; CODE XREF: sub_1000A6D0+42j
					; sub_1000A6D0+CAj ...
		mov	ecx, [esp+38h+var_28]
		push	ecx
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_1000ADAA:				; CODE XREF: sub_1000A6D0+A9j
					; sub_1000A6D0+16Ej ...
		mov	edx, [esp+38h+var_24]
		push	edx
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000ADC2:				; CODE XREF: sub_1000A6D0+6C8j
		mov	cx, [esi+44h]
		mov	edx, [esp+38h+Src]
		push	ebx		; Size
		mov	[eax+3Ah], cx
		mov	[eax+54h], bl
		push	edx		; Src
		add	eax, 55h
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	edi
		mov	dword ptr [esi+83Ch], 0
		mov	dword ptr [esi+4C0h], 8
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 28h
		retn
sub_1000A6D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000AE00	proc near		; CODE XREF: sub_1000F030+36Cp

var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 90h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+90h+var_4], eax
		mov	eax, [esi+4C0h]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	edi
		mov	[esp+9Ch+var_8C], ecx
		mov	[esp+9Ch+var_90], 0FFFFD01Fh
		mov	edi, 2Fh
		mov	[esp+9Ch+var_58], ebp
		mov	[esp+9Ch+var_54], ebp
		mov	[esp+9Ch+var_50], ebp
		mov	[esp+9Ch+var_64], ebp
		cmp	eax, 9
		jz	short loc_1000AE5C
		cmp	eax, 8
		jz	short loc_1000AE5C

loc_1000AE4A:				; CODE XREF: sub_1000AE00+5Fj
		mov	[esp+9Ch+var_90], 0FFFFD02Dh
		mov	edi, 0Ah
		jmp	loc_1000B2E8
; ---------------------------------------------------------------------------

loc_1000AE5C:				; CODE XREF: sub_1000AE00+43j
					; sub_1000AE00+48j
		cmp	[esi+6Ch], ebp
		jz	short loc_1000AE4A
		mov	eax, [esi+44Ch]
		movzx	eax, word ptr [eax+58h]
		mov	edx, 300h
		cmp	dx, ax
		sbb	ebx, ebx
		neg	ebx
		mov	edx, 303h
		cmp	ax, dx
		sbb	eax, eax
		inc	eax
		mov	[esp+9Ch+var_5C], eax
		mov	eax, [esi+808h]
		mov	eax, [eax+4]
		dec	eax
		jz	loc_1000B165
		dec	eax
		jz	short loc_1000AEDA
		sub	eax, 2
		jz	short loc_1000AEB0
		mov	edi, 28h
		mov	[esp+9Ch+var_90], 0FFFFE030h
		jmp	loc_1000B2E8
; ---------------------------------------------------------------------------

loc_1000AEB0:				; CODE XREF: sub_1000AE00+9Cj
		mov	edx, [esp+9Ch+arg_0]
		push	edx
		push	ecx
		push	esi
		call	sub_10021190
		add	esp, 0Ch
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+90h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_1000AEDA:				; CODE XREF: sub_1000AE00+97j
		lea	eax, [esp+9Ch+arg_0]
		push	eax
		lea	ecx, [esp+0A0h+var_8C]
		push	ecx
		push	2
		lea	edx, [esp+0A8h+var_70]
		push	edx
		push	esi
		mov	[esp+0B0h+var_70], ebp
		mov	[esp+0B0h+var_6C], ebp
		mov	[esp+0B0h+var_68], ebp
		mov	[esp+0B0h+var_7C], ebp
		mov	[esp+0B0h+var_78], ebp
		mov	[esp+0B0h+var_74], ebp
		mov	[esp+0B0h+var_88], ebp
		mov	[esp+0B0h+var_84], ebp
		mov	[esp+0B0h+var_80], ebp
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		cmp	[esp+9Ch+var_68], 40h
		jnb	short loc_1000AF37
		mov	[esp+9Ch+var_90], 0FFFFD073h
		jmp	loc_1000B2E8
; ---------------------------------------------------------------------------

loc_1000AF37:				; CODE XREF: sub_1000AE00+128j
		lea	eax, [esp+9Ch+arg_0]
		push	eax
		lea	ecx, [esp+0A0h+var_8C]
		push	ecx
		push	2
		lea	edx, [esp+0A8h+var_7C]
		push	edx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		mov	eax, [esp+9Ch+var_74]
		cmp	eax, [esp+9Ch+var_68]
		ja	loc_1000B2E8
		lea	ecx, [esp+9Ch+var_7C]
		call	sub_10006430
		test	eax, eax
		jz	loc_1000B2E8
		lea	ecx, [esp+9Ch+arg_0]
		push	ecx
		lea	edx, [esp+0A0h+var_8C]
		push	edx
		push	2
		lea	eax, [esp+0A8h+var_88]
		push	eax
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		mov	ecx, [esp+9Ch+var_80]
		cmp	ecx, [esp+9Ch+var_68]
		ja	loc_1000B2E8
		lea	ecx, [esp+9Ch+var_88]
		call	sub_10006430
		test	eax, eax
		jz	loc_1000B2E8
		cmp	[esp+9Ch+var_5C], ebp
		jz	short loc_1000B001
		lea	edx, [esp+9Ch+var_64]
		push	edx
		lea	eax, [esp+0A0h+arg_0]
		push	eax
		lea	ecx, [esp+0A4h+var_8C]
		push	ecx
		push	esi
		call	sub_100092B0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000B2F4
		mov	edx, [esi+6Ch]
		push	edx
		lea	eax, [esp+0A0h+var_64]
		push	eax
		call	sub_10005670
		add	esp, 8
		test	eax, eax
		jnz	loc_1000B2F4

loc_1000B001:				; CODE XREF: sub_1000AE00+1C3j
		lea	ecx, [esp+9Ch+arg_0]
		push	ecx
		lea	edx, [esp+0A0h+var_8C]
		push	edx
		push	2
		lea	eax, [esp+0A8h+var_58]
		push	eax
		push	esi		; int
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		cmp	[esp+9Ch+arg_0], ebp
		jnz	loc_1000B237
		mov	ecx, [esi+14h]
		mov	edi, ebx
		neg	edi
		sbb	edi, edi
		shr	ecx, 0Fh
		and	ecx, 1
		push	ecx		; int
		lea	edx, [esp+0A0h+var_4C]
		push	edx		; int
		mov	edx, [esp+0A4h+var_88]
		lea	eax, [esi+480h]
		push	eax		; int
		lea	ecx, [esi+4A0h]
		push	ecx		; int
		mov	ecx, [esp+0ACh+var_84]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], edx
		mov	edx, [esp+0B8h+var_80]
		mov	[eax+4], ecx
		mov	ecx, [esp+0B8h+var_7C]
		mov	[eax+8], edx
		mov	edx, [esp+0B8h+var_78]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], ecx
		mov	ecx, [esp+0C4h+var_74]
		mov	[eax+4], edx
		mov	edx, [esp+0C4h+var_70]
		mov	[eax+8], ecx
		mov	ecx, [esp+0C4h+var_6C]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], edx
		mov	edx, [esp+0D0h+var_68]
		mov	[eax+4], ecx
		mov	[eax+8], edx
		mov	eax, [esp+0D0h+var_64]
		and	edi, 0Bh
		push	eax		; int
		add	edi, 28h
		call	sub_10003B60
		add	esp, 38h
		test	eax, eax
		jnz	loc_1000B2D7
		mov	ecx, [esi+22Ch]
		mov	eax, [esi+6Ch]
		push	ecx
		push	ebx
		lea	edx, [esp+0A4h+var_58]
		push	edx
		push	eax
		lea	ecx, [esp+0ACh+var_4C]
		push	ecx
		call	sub_10003660
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2D7
		push	800h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, ebp
		jz	loc_1000B394
		push	0ACh
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	edi, eax
		add	esp, 8
		mov	[esi+70h], edi
		cmp	edi, ebp
		jz	loc_1000B394
		lea	edx, [esp+9Ch+var_70]
		push	edx
		lea	eax, [edi+14h]
		push	eax
		push	ebx
		mov	[edi], ebx
		mov	dword ptr [edi+4], 4
		mov	[edi+8], ebp
		mov	[edi+0Ch], ebp
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B38A
		lea	ecx, [esp+9Ch+var_7C]
		push	ecx
		lea	edx, [edi+20h]
		push	edx
		push	ebx
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B38A
		lea	eax, [esp+9Ch+var_88]
		push	eax
		lea	ecx, [edi+2Ch]
		push	ecx
		jmp	loc_1000B358
; ---------------------------------------------------------------------------

loc_1000B165:				; CODE XREF: sub_1000AE00+90j
		lea	edx, [esp+9Ch+arg_0]
		push	edx
		lea	eax, [esp+0A0h+var_8C]
		push	eax
		push	2
		lea	ecx, [esp+0A8h+var_88]
		push	ecx
		push	esi
		mov	[esp+0B0h+var_88], ebp
		mov	[esp+0B0h+var_84], ebp
		mov	[esp+0B0h+var_80], ebp
		mov	[esp+0B0h+var_7C], ebp
		mov	[esp+0B0h+var_78], ebp
		mov	[esp+0B0h+var_74], ebp
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		lea	edx, [esp+9Ch+arg_0]
		push	edx
		lea	eax, [esp+0A0h+var_8C]
		push	eax
		push	2
		lea	ecx, [esp+0A8h+var_7C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		cmp	[esp+9Ch+var_5C], ebp
		jz	short loc_1000B209
		lea	edx, [esp+9Ch+var_64]
		push	edx
		lea	eax, [esp+0A0h+arg_0]
		push	eax
		lea	ecx, [esp+0A4h+var_8C]
		push	ecx
		push	esi
		call	sub_100092B0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000B2F4
		mov	edx, [esi+6Ch]
		push	edx
		lea	eax, [esp+0A0h+var_64]
		push	eax
		call	sub_10005670
		add	esp, 8
		test	eax, eax
		jnz	loc_1000B2F4

loc_1000B209:				; CODE XREF: sub_1000AE00+3CBj
		lea	ecx, [esp+9Ch+arg_0]
		push	ecx
		lea	edx, [esp+0A0h+var_8C]
		push	edx
		push	2
		lea	eax, [esp+0A8h+var_58]
		push	eax
		push	esi		; int
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B2F4
		cmp	[esp+9Ch+arg_0], ebp
		jz	short loc_1000B249

loc_1000B237:				; CODE XREF: sub_1000AE00+22Dj
		cmp	ebx, ebp
		jz	loc_1000B2E8
		mov	edi, 32h
		jmp	loc_1000B2E8
; ---------------------------------------------------------------------------

loc_1000B249:				; CODE XREF: sub_1000AE00+435j
		mov	ecx, [esi+14h]
		mov	edi, ebx
		neg	edi
		sbb	edi, edi
		shr	ecx, 0Fh
		and	ecx, 1
		push	ecx		; int
		lea	edx, [esp+0A0h+var_4C]
		push	edx		; int
		mov	edx, [esp+0A4h+var_7C]
		lea	eax, [esi+480h]
		push	eax		; int
		lea	ecx, [esi+4A0h]
		push	ecx		; int
		mov	ecx, [esp+0ACh+var_78]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], edx
		mov	edx, [esp+0B8h+var_74]
		mov	[eax+4], ecx
		mov	ecx, [esp+0B8h+var_88]
		mov	[eax+8], edx
		mov	edx, [esp+0B8h+var_84]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], ecx
		mov	ecx, [esp+0C4h+var_80]
		mov	[eax+4], edx
		mov	edx, [esp+0C4h+var_64]
		and	edi, 0Bh
		push	edx		; int
		add	edi, 28h
		mov	[eax+8], ecx
		call	sub_10003A00
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_1000B2D7
		mov	eax, [esi+22Ch]
		mov	edx, [esi+6Ch]
		push	eax
		push	ebx
		lea	ecx, [esp+0A4h+var_58]
		push	ecx
		push	edx
		lea	eax, [esp+0ACh+var_4C]
		push	eax
		call	sub_10003660
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000B303

loc_1000B2D7:				; CODE XREF: sub_1000AE00+2B6j
					; sub_1000AE00+2DCj ...
		push	0FFFFD044h
		call	sub_100147C0
		mov	[esp+0A0h+var_90], eax
		add	esp, 4

loc_1000B2E8:				; CODE XREF: sub_1000AE00+57j
					; sub_1000AE00+ABj ...
		push	edi
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_1000B2F4:				; CODE XREF: sub_1000AE00+11Dj
					; sub_1000AE00+156j ...
		mov	ecx, [esp+9Ch+var_90]
		push	ecx
		call	PORT_SetError_Util
		jmp	loc_1000B39E
; ---------------------------------------------------------------------------

loc_1000B303:				; CODE XREF: sub_1000AE00+4D5j
		push	800h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, ebp
		jz	short loc_1000B394
		push	0ACh
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jz	short loc_1000B38A
		lea	edx, [esp+9Ch+var_88]
		push	edx
		lea	eax, [edi+14h]
		push	eax
		push	ebx
		mov	[edi], ebx
		mov	dword ptr [edi+4], 1
		mov	[edi+8], ebp
		mov	[edi+0Ch], ebp
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B38A
		lea	ecx, [esp+9Ch+var_7C]
		push	ecx
		lea	edx, [edi+20h]
		push	edx

loc_1000B358:				; CODE XREF: sub_1000AE00+360j
		push	ebx
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B38A
		mov	dword ptr [esi+4C0h], 0Ah
		mov	[esi+70h], edi
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+90h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_1000B38A:				; CODE XREF: sub_1000AE00+337j
					; sub_1000AE00+351j ...
		push	ebp
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000B394:				; CODE XREF: sub_1000AE00+2F3j
					; sub_1000AE00+30Ej ...
		push	0FFFFD044h
		call	sub_100147C0

loc_1000B39E:				; CODE XREF: sub_1000AE00+4FEj
		mov	ecx, [esp+0A0h+var_4]
		add	esp, 4
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
sub_1000AE00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B3C0	proc near		; CODE XREF: sub_1000F030+3B0p

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, [ebx+4C0h]
		mov	ecx, [esp+2Ch+arg_4]
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		mov	[esp+38h+var_2C], ebp
		mov	[esp+38h+var_24], 0FFFFD020h
		mov	[esp+38h+var_28], 2Fh
		mov	[esp+38h+var_1C], ebp
		mov	[esp+38h+var_18], ebp
		mov	[esp+38h+var_14], ebp
		cmp	eax, 0Ah
		jz	short loc_1000B411
		cmp	eax, 9
		jz	short loc_1000B411
		mov	[esp+38h+var_28], 0Ah
		mov	[esp+38h+var_24], 0FFFFD02Eh
		jmp	loc_1000B667
; ---------------------------------------------------------------------------

loc_1000B411:				; CODE XREF: sub_1000B3C0+35j
					; sub_1000B3C0+3Aj
		mov	eax, [ebx+44Ch]
		movzx	eax, word ptr [eax+58h]
		mov	edx, 300h
		cmp	dx, ax
		sbb	edi, edi
		neg	edi
		mov	edx, 303h
		cmp	ax, dx
		sbb	esi, esi
		inc	esi
		mov	[esp+38h+var_20], edi
		cmp	ecx, 1
		jnb	short loc_1000B480
		mov	eax, 300h
		cmp	ax, [ebx+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx
		push	2
		push	ebx
		call	sub_10008960
		mov	edx, [ebx+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		mov	eax, [esp+48h+var_24]
		add	esp, 10h
		push	eax
		call	PORT_SetError_Util
		add	esp, 4
		or	ebp, 0FFFFFFFFh
		jmp	loc_1000B777
; ---------------------------------------------------------------------------

loc_1000B480:				; CODE XREF: sub_1000B3C0+79j
		mov	edx, [esp+38h+arg_0]
		movzx	eax, byte ptr [edx]
		inc	edx
		dec	ecx
		mov	[esp+38h+arg_0], edx
		mov	[esp+38h+arg_4], ecx
		test	eax, eax
		js	loc_1000B677
		jle	short loc_1000B4B4
		cmp	eax, ecx
		jbe	loc_1000B5D5
		push	ebx
		call	sub_10008BD0
		add	esp, 4
		test	eax, eax
		jnz	loc_1000B677

loc_1000B4B4:				; CODE XREF: sub_1000B3C0+D9j
					; sub_1000B3C0+21Fj
		test	esi, esi
		jz	short loc_1000B4EE
		lea	eax, [esp+38h+arg_4]
		push	eax
		lea	ecx, [esp+3Ch+arg_0]
		push	ecx
		push	2
		lea	edx, [esp+44h+var_1C]
		push	edx
		push	ebx
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000B677
		mov	eax, [esp+38h+var_14]
		test	eax, eax
		jz	loc_1000B65B
		test	al, 1
		jnz	loc_1000B65B

loc_1000B4EE:				; CODE XREF: sub_1000B3C0+F6j
		push	800h
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esp+38h+var_10], eax
		mov	[esp+38h+var_2C], eax
		test	eax, eax
		jz	loc_1000B60A
		lea	eax, [esp+38h+arg_4]
		push	eax
		lea	ecx, [esp+3Ch+arg_0]
		push	ecx
		push	2
		push	ebx
		call	sub_100091C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		js	loc_1000B677
		cmp	edi, [esp+38h+arg_4]
		ja	loc_1000B657
		mov	edx, [esp+38h+var_2C]
		push	10h
		push	edx
		call	PORT_ArenaZAlloc_Util
		mov	esi, eax
		add	esp, 8
		mov	[esp+38h+var_4], esi
		test	esi, esi
		jz	loc_1000B60A
		test	edi, edi
		jle	loc_1000B5E4
		lea	esp, [esp+0]

loc_1000B560:				; CODE XREF: sub_1000B3C0+201j
		cmp	edi, 2
		jl	loc_1000B657
		lea	eax, [esp+38h+arg_4]
		push	eax
		lea	ecx, [esp+3Ch+arg_0]
		push	ecx
		push	2
		push	ebx
		call	sub_100091C0
		add	esp, 10h
		mov	[esi+0Ch], eax
		test	eax, eax
		jle	loc_1000B677
		sub	edi, 2
		cmp	edi, eax
		jl	loc_1000B657
		mov	ecx, [esp+38h+arg_0]
		sub	[esp+38h+arg_4], eax
		mov	[esi+8], ecx
		add	ecx, eax
		sub	edi, eax
		inc	ebp
		mov	[esp+38h+arg_0], ecx
		test	edi, edi
		jle	short loc_1000B5E4
		mov	edx, [esp+38h+var_2C]
		push	10h
		push	edx
		call	PORT_ArenaZAlloc_Util
		mov	[esi], eax
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000B560
		push	0FFFFE013h
		or	ebp, 0FFFFFFFFh
		call	PORT_SetError_Util
		jmp	loc_1000B774
; ---------------------------------------------------------------------------

loc_1000B5D5:				; CODE XREF: sub_1000B3C0+DDj
		add	[esp+38h+arg_0], eax
		sub	ecx, eax
		mov	[esp+38h+arg_4], ecx
		jmp	loc_1000B4B4
; ---------------------------------------------------------------------------

loc_1000B5E4:				; CODE XREF: sub_1000B3C0+193j
					; sub_1000B3C0+1EAj
		mov	ecx, [esp+38h+var_2C]
		lea	eax, [ebp+ebp*2+0]
		add	eax, eax
		add	eax, eax
		push	eax
		push	ecx
		mov	[esp+40h+var_C], ebp
		call	PORT_ArenaAlloc_Util
		add	esp, 8
		mov	[esp+38h+var_8], eax
		test	ebp, ebp
		jle	short loc_1000B61C
		test	eax, eax
		jnz	short loc_1000B61C

loc_1000B60A:				; CODE XREF: sub_1000B3C0+145j
					; sub_1000B3C0+18Bj
		push	0FFFFE013h
		or	ebp, 0FFFFFFFFh
		call	PORT_SetError_Util
		jmp	loc_1000B774
; ---------------------------------------------------------------------------

loc_1000B61C:				; CODE XREF: sub_1000B3C0+244j
					; sub_1000B3C0+248j
		mov	ecx, [esp+38h+var_4]
		test	ebp, ebp
		jle	short loc_1000B650
		xor	edx, edx
		mov	esi, ebp
		jmp	short loc_1000B634
; ---------------------------------------------------------------------------
		align 10h

loc_1000B630:				; CODE XREF: sub_1000B3C0+28Ej
		mov	eax, [esp+38h+var_8]

loc_1000B634:				; CODE XREF: sub_1000B3C0+268j
		mov	edi, [ecx+4]
		mov	[eax+edx], edi
		mov	edi, [ecx+8]
		mov	[eax+edx+4], edi
		mov	edi, [ecx+0Ch]
		mov	[eax+edx+8], edi
		mov	ecx, [ecx]
		add	edx, 0Ch
		dec	esi
		jnz	short loc_1000B630

loc_1000B650:				; CODE XREF: sub_1000B3C0+262j
		cmp	[esp+38h+arg_4], 0
		jz	short loc_1000B68C

loc_1000B657:				; CODE XREF: sub_1000B3C0+16Ej
					; sub_1000B3C0+1A3j ...
		mov	edi, [esp+38h+var_20]

loc_1000B65B:				; CODE XREF: sub_1000B3C0+120j
					; sub_1000B3C0+128j
		test	edi, edi
		jz	short loc_1000B667
		mov	[esp+38h+var_28], 32h

loc_1000B667:				; CODE XREF: sub_1000B3C0+4Cj
					; sub_1000B3C0+29Dj
		mov	edx, [esp+38h+var_28]
		push	edx
		push	2
		push	ebx
		call	sub_10008960
		add	esp, 0Ch

loc_1000B677:				; CODE XREF: sub_1000B3C0+D3j
					; sub_1000B3C0+EEj ...
		mov	eax, [esp+38h+var_24]
		push	eax
		call	PORT_SetError_Util
		add	esp, 4
		or	ebp, 0FFFFFFFFh
		jmp	loc_1000B777
; ---------------------------------------------------------------------------

loc_1000B68C:				; CODE XREF: sub_1000B3C0+295j
		mov	eax, [ebx+204h]
		mov	dword ptr [ebx+4C0h], 0Bh
		test	eax, eax
		jz	loc_1000B748
		mov	edx, [ebx]
		lea	esi, [ebx+45Ch]
		push	esi
		lea	edi, [ebx+458h]
		push	edi
		lea	ecx, [esp+40h+var_10]
		push	ecx
		mov	ecx, [ebx+208h]
		push	edx
		push	ecx
		call	eax
		mov	ebp, eax
		add	esp, 14h
		cmp	ebp, 0FFFFFFFEh
		jz	loc_1000B76E
		test	ebp, ebp
		jnz	short loc_1000B748
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_1000B733
		cmp	[esi], ebp
		jz	short loc_1000B720
		push	ebp
		push	ebp
		push	eax
		call	CERT_CertChainFromCert
		add	esp, 0Ch
		mov	[ebx+460h], eax
		test	eax, eax
		jnz	short loc_1000B70B
		mov	edx, [edi]
		push	edx
		call	CERT_DestroyCertificate
		mov	eax, [esi]
		push	eax
		mov	[edi], ebp
		call	SECKEY_DestroyPrivateKey
		add	esp, 8
		jmp	short loc_1000B742
; ---------------------------------------------------------------------------

loc_1000B70B:				; CODE XREF: sub_1000B3C0+332j
		cmp	dword ptr [ebx+4C4h], 2
		jnz	short loc_1000B777
		push	ebx
		lea	eax, [esp+3Ch+var_1C]
		call	sub_10006520
		jmp	short loc_1000B774
; ---------------------------------------------------------------------------

loc_1000B720:				; CODE XREF: sub_1000B3C0+31Dj
		test	eax, eax
		jz	short loc_1000B733
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	dword ptr [edi], 0

loc_1000B733:				; CODE XREF: sub_1000B3C0+319j
					; sub_1000B3C0+362j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000B748
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_1000B742:				; CODE XREF: sub_1000B3C0+349j
		mov	dword ptr [esi], 0

loc_1000B748:				; CODE XREF: sub_1000B3C0+2DEj
					; sub_1000B3C0+313j ...
		cmp	[esp+38h+var_20], 0
		jz	short loc_1000B75D
		mov	dword ptr [ebx+464h], 1
		xor	ebp, ebp
		jmp	short loc_1000B777
; ---------------------------------------------------------------------------

loc_1000B75D:				; CODE XREF: sub_1000B3C0+38Dj
		push	29h
		push	1
		push	ebx
		call	sub_10008960
		add	esp, 0Ch
		xor	ebp, ebp
		jmp	short loc_1000B777
; ---------------------------------------------------------------------------

loc_1000B76E:				; CODE XREF: sub_1000B3C0+30Bj
		push	ebx
		call	sub_10018600

loc_1000B774:				; CODE XREF: sub_1000B3C0+210j
					; sub_1000B3C0+257j ...
		add	esp, 4

loc_1000B777:				; CODE XREF: sub_1000B3C0+BBj
					; sub_1000B3C0+2C7j ...
		mov	eax, [esp+38h+var_2C]
		test	eax, eax
		jz	short loc_1000B78A
		push	0
		push	eax
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000B78A:				; CODE XREF: sub_1000B3C0+3BDj
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		add	esp, 2Ch
		retn
sub_1000B3C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B7A0	proc near		; CODE XREF: sub_1000D070+B1p
		push	edi
		push	0		; int
		mov	edi, eax
		push	0		; char
		push	edi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B7DA
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_1000B7C9
		push	eax
		push	edi
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_1000B7D0
; ---------------------------------------------------------------------------

loc_1000B7C9:				; CODE XREF: sub_1000B7A0+1Bj
		xor	edx, edx
		call	sub_10008170

loc_1000B7D0:				; CODE XREF: sub_1000B7A0+27j
		test	eax, eax
		jnz	short loc_1000B7DA
		mov	[edi+4C0h], eax

loc_1000B7DA:				; CODE XREF: sub_1000B7A0+12j
					; sub_1000B7A0+32j
		pop	edi
		retn
sub_1000B7A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B7E0	proc near		; CODE XREF: sub_1000D710+3p
					; sub_1000D820+A9Ep

Src		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		push	ebp
		push	esi
		mov	esi, eax
		cmp	byte ptr [esi+45h], 3
		mov	ebp, 1
		jz	short loc_1000B808
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B808:				; CODE XREF: sub_1000B7E0+10j
		push	ebx
		push	edi
		mov	edi, [esi+0F4h]
		lea	eax, [esi+2E9Ch]
		push	eax
		push	0FFFFh
		push	0
		push	esi
		mov	[esp+28h+var_4], edi
		call	sub_100162F0
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jle	short loc_1000B834
		add	ebx, 2

loc_1000B834:				; CODE XREF: sub_1000B7E0+4Fj
		test	edi, edi
		jnz	short loc_1000B83C
		xor	eax, eax
		jmp	short loc_1000B840
; ---------------------------------------------------------------------------

loc_1000B83C:				; CODE XREF: sub_1000B7E0+56j
		movzx	eax, byte ptr [edi+54h]

loc_1000B840:				; CODE XREF: sub_1000B7E0+5Aj
		lea	eax, [eax+ebx+26h]
		push	eax		; int
		push	2		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B9E2
		cmp	[esi+2F38h], ebp
		jnz	short loc_1000B872
		movzx	ecx, word ptr [esi+44h]
		push	ecx
		call	sub_10002170
		add	esp, 4
		movzx	eax, ax
		jmp	short loc_1000B876
; ---------------------------------------------------------------------------

loc_1000B872:				; CODE XREF: sub_1000B7E0+7Ej
		movzx	eax, word ptr [esi+44h]

loc_1000B876:				; CODE XREF: sub_1000B7E0+90j
		movzx	eax, ax
		mov	edx, eax
		mov	byte ptr [esp+18h+Src+1], al
		push	2		; Size
		lea	eax, [esp+1Ch+Src]
		push	eax		; Src
		sar	edx, 8
		push	esi		; int
		mov	byte ptr [esp+24h+Src],	dl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B9E2
		lea	edi, [esi+480h]
		push	20h
		push	edi
		call	PK11_GenerateRandom
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_1000B8D6
		push	0FFFFD041h
		call	sub_100147C0
		push	0FFFFD041h
		call	sub_100147C0
		add	esp, 8
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, ebp
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B8D6:				; CODE XREF: sub_1000B7E0+D3j
		push	20h		; Size
		push	edi		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B9E2
		mov	edi, [esp+18h+var_4]
		push	1		; Size
		test	edi, edi
		jz	short loc_1000B921
		movzx	eax, byte ptr [edi+54h]
		lea	ecx, [esp+1Ch+var_4]
		push	ecx		; Src
		push	esi		; int
		mov	[esp+24h+Src], eax
		mov	byte ptr [esp+24h+var_4], al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B9E2
		mov	edx, [esp+18h+Src]
		push	edx
		add	edi, 55h
		push	edi
		jmp	short loc_1000B92B
; ---------------------------------------------------------------------------

loc_1000B921:				; CODE XREF: sub_1000B7E0+112j
		lea	eax, [esp+1Ch+var_4]
		mov	byte ptr [esp+1Ch+var_4], 0
		push	eax		; Src

loc_1000B92B:				; CODE XREF: sub_1000B7E0+13Fj
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000B9E2
		movzx	eax, word ptr [esi+80Ch]
		push	2		; Size
		lea	edx, [esp+1Ch+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+24h+Src],	cl
		mov	byte ptr [esp+24h+Src+1], al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B9E2
		mov	eax, [esi+814h]
		mov	byte ptr [esp+18h+var_4], al
		push	1		; Size
		lea	eax, [esp+1Ch+var_4]
		push	eax		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B9E2
		test	ebx, ebx
		jz	short loc_1000B9DD
		sub	ebx, 2
		push	2		; Size
		lea	edx, [esp+1Ch+Src]
		mov	ecx, ebx
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	byte ptr [esp+24h+Src],	cl
		mov	byte ptr [esp+24h+Src+1], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B9E2
		lea	eax, [esi+2E9Ch]
		push	eax
		push	ebx
		push	1
		push	esi
		call	sub_100162F0
		add	esp, 10h
		cmp	eax, ebx
		jz	short loc_1000B9DD
		test	eax, eax
		js	short loc_1000B9D2
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000B9D2:				; CODE XREF: sub_1000B7E0+1E3j
		pop	edi
		pop	ebx
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000B9DD:				; CODE XREF: sub_1000B7E0+1A4j
					; sub_1000B7E0+1DFj
		call	sub_10003E40

loc_1000B9E2:				; CODE XREF: sub_1000B7E0+72j
					; sub_1000B7E0+B8j ...
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 8
		retn
sub_1000B7E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B9F0	proc near		; CODE XREF: sub_1000D710+76p
					; sub_1000D710:loc_1000D7B0p

Src		= byte ptr -64h
var_63		= byte ptr -63h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
Size		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_4		= dword	ptr -4

		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esi+808h]
		xor	ebp, ebp
		lea	eax, [esp+70h+var_54]
		push	eax
		mov	ebx, esi
		mov	[esp+74h+var_60], ebp
		mov	[esp+74h+var_5C], ebp
		mov	[esp+74h+Size],	ebp
		call	sub_10006810
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000BA7F
		mov	eax, [edi+4]
		dec	eax
		jz	short loc_1000BA65
		sub	eax, 3
		jz	short loc_1000BA45
		push	0FFFFE030h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	loc_1000BC55
; ---------------------------------------------------------------------------

loc_1000BA45:				; CODE XREF: sub_1000B9F0+41j
		lea	ecx, [esp+70h+var_54]
		push	ecx
		push	esi
		call	sub_100214A0
		add	esp, 8
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1000BA65:				; CODE XREF: sub_1000B9F0+3Cj
		mov	edx, [esi+1F8h]
		mov	edi, [edx+4]
		cmp	edi, ebp
		jnz	short loc_1000BA94
		push	0FFFFD044h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000BA7F:				; CODE XREF: sub_1000B9F0+36j
					; sub_1000B9F0+26Bj
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1000BA94:				; CODE XREF: sub_1000B9F0+80j
		mov	eax, [esi+14h]
		shr	eax, 0Fh
		and	eax, 1
		push	eax		; int
		lea	ecx, [esp+74h+var_4C]
		push	ecx		; int
		mov	ecx, [edi+20h]
		lea	edx, [esi+480h]
		push	edx		; int
		mov	edx, [edi+24h]
		lea	eax, [esi+4A0h]
		push	eax		; int
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], ecx
		mov	ecx, [edi+28h]
		mov	[eax+4], edx
		mov	edx, [edi+14h]
		mov	[eax+8], ecx
		mov	ecx, [edi+18h]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], edx
		mov	edx, [edi+1Ch]
		mov	[eax+4], ecx
		mov	[eax+8], edx
		mov	eax, [esp+98h+var_54]
		push	eax		; int
		call	sub_10003A00
		mov	ebx, eax
		add	esp, 2Ch
		cmp	ebx, ebp
		jz	short loc_1000BB11
		push	0FFFFD044h
		call	sub_100147C0
		add	esp, 4
		mov	eax, ebx
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1000BB11:				; CODE XREF: sub_1000B9F0+FEj
		mov	ecx, [esi+454h]
		mov	edx, 300h
		cmp	dx, [ecx+58h]
		mov	ecx, [esi+304h]
		mov	edx, [ecx]
		sbb	eax, eax
		neg	eax
		push	eax
		lea	eax, [esp+74h+var_60]
		push	eax
		push	edx
		lea	eax, [esp+7Ch+var_4C]
		push	eax
		call	sub_100034D0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000BC55
		cmp	[esp+70h+var_5C], ebp
		jnz	short loc_1000BB60
		push	0FFFFD044h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	loc_1000BC55
; ---------------------------------------------------------------------------

loc_1000BB60:				; CODE XREF: sub_1000B9F0+15Cj
		mov	ecx, [edi+1Ch]
		add	ecx, [esp+70h+Size]
		mov	edx, [edi+28h]
		lea	eax, [ecx+edx+6]
		push	eax		; int
		push	0Ch		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BC55
		mov	ebx, [edi+1Ch]
		mov	ebp, [edi+18h]
		push	2		; Size
		lea	ecx, [esp+74h+Src]
		mov	eax, ebx
		push	ecx		; Src
		sar	eax, 8
		push	esi		; int
		mov	[esp+7Ch+Src], al
		mov	[esp+7Ch+var_63], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BC53
		push	ebx		; Size
		push	ebp		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BC53
		mov	ebx, [edi+28h]
		mov	edi, [edi+24h]
		push	2		; Size
		lea	eax, [esp+74h+Src]
		mov	edx, ebx
		push	eax		; Src
		sar	edx, 8
		push	esi		; int
		mov	[esp+7Ch+Src], dl
		mov	[esp+7Ch+var_63], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BC53
		push	ebx		; Size
		push	edi		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BC53
		mov	ecx, [esi+454h]
		mov	edx, 303h
		cmp	[ecx+58h], dx
		jb	short loc_1000BC19
		lea	eax, [esp+70h+var_54]
		push	eax
		push	esi
		call	sub_100090F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000BC53

loc_1000BC19:				; CODE XREF: sub_1000B9F0+215j
		mov	eax, [esp+70h+Size]
		mov	ebx, [esp+70h+var_5C]
		push	2		; Size
		lea	edx, [esp+74h+Src]
		mov	ecx, eax
		push	edx		; Src
		sar	ecx, 8
		push	esi		; int
		mov	edi, eax
		mov	[esp+7Ch+Src], cl
		mov	[esp+7Ch+var_63], al
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BC53
		push	edi		; Size
		push	ebx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000BC7F

loc_1000BC53:				; CODE XREF: sub_1000B9F0+1B7j
					; sub_1000B9F0+1CAj ...
		xor	ebp, ebp

loc_1000BC55:				; CODE XREF: sub_1000B9F0+50j
					; sub_1000B9F0+152j ...
		mov	eax, [esp+70h+var_5C]
		cmp	eax, ebp
		jz	loc_1000BA7F
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1000BC7F:				; CODE XREF: sub_1000B9F0+261j
		mov	eax, [esp+70h+var_5C]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+74h+var_4]
		add	esp, 4
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
sub_1000B9F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BCA0	proc near		; CODE XREF: sub_1000D710+B1p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
Src		= dword	ptr -4

		sub	esp, 10h
		mov	eax, [edi+454h]
		push	ebx
		xor	ebx, ebx
		push	ebp
		xor	ebp, ebp
		mov	ecx, 303h
		cmp	[eax+58h], cx
		mov	eax, [edi+474h]
		push	esi
		sbb	esi, esi
		inc	esi
		mov	[esp+1Ch+var_10], ebx
		mov	[esp+1Ch+var_C], ebp
		cmp	eax, ebx
		jnz	short loc_1000BCD7
		mov	eax, dword_10037648
		cmp	eax, ebx
		jz	short loc_1000BCE7

loc_1000BCD7:				; CODE XREF: sub_1000BCA0+2Cj
		mov	edx, [eax+8]
		mov	eax, [eax+4]
		mov	[esp+1Ch+var_10], edx
		mov	[esp+1Ch+var_C], eax
		mov	ebp, eax

loc_1000BCE7:				; CODE XREF: sub_1000BCA0+35j
		cmp	ebp, ebx
		jle	short loc_1000BD00
		mov	eax, [esp+1Ch+var_10]
		add	eax, 8
		mov	ecx, ebp

loc_1000BCF4:				; CODE XREF: sub_1000BCA0+5Ej
		mov	edx, [eax]
		add	eax, 0Ch
		dec	ecx
		lea	ebx, [ebx+edx+2]
		jnz	short loc_1000BCF4

loc_1000BD00:				; CODE XREF: sub_1000BCA0+49j
		lea	eax, [ebx+6]
		test	esi, esi
		jz	short loc_1000BD0A
		add	eax, 8

loc_1000BD0A:				; CODE XREF: sub_1000BCA0+65j
		push	eax		; int
		push	0Dh		; char
		push	edi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BE09
		push	1		; Size
		lea	eax, [esp+20h+Src]
		push	eax		; Src
		push	edi		; int
		mov	byte ptr [esp+28h+Src],	3
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BE09
		push	3		; Size
		push	offset dword_1002A5B0 ;	Src
		push	edi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BE09
		test	esi, esi
		jz	short loc_1000BD8A
		push	2		; Size
		lea	ecx, [esp+20h+var_8]
		push	ecx		; Src
		push	edi		; int
		mov	[esp+28h+var_8], 600h
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000BE09
		push	6		; Size
		push	offset dword_1002A5B4 ;	Src
		push	edi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BE09

loc_1000BD8A:				; CODE XREF: sub_1000BCA0+B5j
		push	2		; Size
		lea	eax, [esp+20h+var_8]
		mov	edx, ebx
		push	eax		; Src
		sar	edx, 8
		push	edi		; int
		mov	byte ptr [esp+28h+var_8], dl
		mov	byte ptr [esp+28h+var_8+1], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BE09
		mov	[esp+1Ch+Src], eax
		test	ebp, ebp
		jle	short loc_1000BE07
		mov	esi, [esp+1Ch+var_10]
		add	esi, 4
		lea	ebx, [ebx+0]

loc_1000BDC0:				; CODE XREF: sub_1000BCA0+165j
		mov	ebx, [esi+4]
		mov	ebp, [esi]
		push	2		; Size
		lea	edx, [esp+20h+var_8]
		mov	ecx, ebx
		push	edx		; Src
		sar	ecx, 8
		push	edi		; int
		mov	byte ptr [esp+28h+var_8], cl
		mov	byte ptr [esp+28h+var_8+1], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BE09
		push	ebx		; Size
		push	ebp		; Src
		push	edi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BE09
		mov	eax, [esp+1Ch+Src]
		inc	eax
		add	esi, 0Ch
		mov	[esp+1Ch+Src], eax
		cmp	eax, [esp+1Ch+var_C]
		jl	short loc_1000BDC0

loc_1000BE07:				; CODE XREF: sub_1000BCA0+111j
		xor	eax, eax

loc_1000BE09:				; CODE XREF: sub_1000BCA0+78j
					; sub_1000BCA0+95j ...
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_1000BCA0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BE10	proc near		; CODE XREF: sub_1000F030+46Ap

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		mov	eax, [edi+44Ch]
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	[esp+1Ch+var_C], ebp
		mov	[esp+1Ch+var_8], ebp
		mov	[esp+1Ch+var_4], ebp
		movzx	eax, word ptr [eax+58h]
		mov	ecx, 300h
		cmp	cx, ax
		push	esi
		sbb	esi, esi
		neg	esi
		cmp	dword ptr [edi+4C0h], 3
		mov	ebx, 0FFFFD022h
		jnz	loc_1000BF3B
		cmp	[edi+6Ch], ebp
		jz	loc_1000BF3B
		mov	edx, 303h
		cmp	ax, dx
		jb	short loc_1000BEBF
		lea	eax, [esp+20h+var_14]
		push	eax
		lea	ecx, [esp+24h+arg_4]
		push	ecx
		lea	edx, [esp+28h+arg_0]
		push	edx
		push	edi
		call	sub_100092B0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000BF51
		mov	eax, [edi+6Ch]
		push	eax
		lea	ecx, [esp+24h+var_14]
		push	ecx
		call	sub_10005670
		add	esp, 8
		test	eax, eax
		jz	short loc_1000BEA3
		call	PORT_GetError_Util
		mov	ebx, eax
		lea	esi, [ebp+33h]
		jmp	loc_1000BF45
; ---------------------------------------------------------------------------

loc_1000BEA3:				; CODE XREF: sub_1000BE10+82j
		mov	edx, [esp+20h+var_14]
		mov	eax, [esp+20h+arg_8]
		cmp	edx, [eax+4]
		jz	short loc_1000BEBF
		mov	ebx, 0FFFFD07Eh
		mov	esi, 33h
		jmp	loc_1000BF45
; ---------------------------------------------------------------------------

loc_1000BEBF:				; CODE XREF: sub_1000BE10+4Dj
					; sub_1000BE10+9Ej
		lea	ecx, [esp+20h+arg_4]
		push	ecx
		lea	edx, [esp+24h+arg_0]
		push	edx
		push	2
		lea	eax, [esp+2Ch+var_C]
		push	eax
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000BF51
		mov	ecx, [edi+22Ch]
		mov	eax, [edi+6Ch]
		push	ecx
		mov	ecx, [esp+24h+arg_8]
		push	esi
		lea	edx, [esp+28h+var_C]
		push	edx
		push	eax
		push	ecx
		call	sub_10003660
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000BF12
		call	PORT_GetError_Util
		neg	esi
		sbb	esi, esi
		and	esi, 0Bh
		mov	ebx, eax
		add	esi, 28h
		jmp	short loc_1000BF45
; ---------------------------------------------------------------------------

loc_1000BF12:				; CODE XREF: sub_1000BE10+EDj
		mov	[esp+20h+var_8], ebp
		cmp	[esp+20h+arg_4], ebp
		jz	short loc_1000BF28
		neg	esi
		sbb	esi, esi
		and	esi, 3
		add	esi, 2Fh
		jmp	short loc_1000BF45
; ---------------------------------------------------------------------------

loc_1000BF28:				; CODE XREF: sub_1000BE10+10Aj
		pop	esi
		pop	ebp
		mov	dword ptr [edi+4C0h], 4
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000BF3B:				; CODE XREF: sub_1000BE10+36j
					; sub_1000BE10+3Fj
		mov	esi, 0Ah
		mov	ebx, 0FFFFD030h

loc_1000BF45:				; CODE XREF: sub_1000BE10+8Ej
					; sub_1000BE10+AAj ...
		push	esi
		push	2
		push	edi
		call	sub_10008960
		add	esp, 0Ch

loc_1000BF51:				; CODE XREF: sub_1000BE10+69j
					; sub_1000BE10+CBj
		push	ebx
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 14h
		retn
sub_1000BE10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000BF70	proc near		; CODE XREF: sub_1000C1C0+16Dp

var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		mov	eax, [esp+54h+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, [esi+454h]
		xor	ecx, ecx
		mov	[esp+60h+var_4C], eax
		lea	eax, [esp+60h+var_34]
		mov	[esp+60h+var_44], ecx
		mov	[esp+60h+var_40], ecx
		mov	ecx, [esp+60h+arg_4]
		push	edi
		mov	[esp+64h+var_3C], eax
		mov	edi, edx
		mov	edx, [esi+44Ch]
		mov	eax, 300h
		mov	[esp+64h+var_48], ecx
		mov	[esp+64h+var_38], 30h
		lea	ebx, [esi+4A0h]
		cmp	[edx+58h], ax
		jbe	short loc_1000C021
		lea	ecx, [esp+64h+var_48]
		push	ecx
		lea	edx, [esp+68h+var_4C]
		push	edx
		push	2
		push	esi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		jns	short loc_1000C009
		push	0FFFFD045h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000C009:				; CODE XREF: sub_1000BF70+74j
		mov	ecx, [esp+64h+var_48]
		cmp	eax, ecx
		jnb	short loc_1000C017
		mov	ecx, eax
		mov	[esp+64h+var_48], ecx

loc_1000C017:				; CODE XREF: sub_1000BF70+9Fj
		mov	[esp+64h+var_54], 1
		jmp	short loc_1000C033
; ---------------------------------------------------------------------------

loc_1000C021:				; CODE XREF: sub_1000BF70+5Bj
		mov	eax, [esi+808h]
		xor	edx, edx
		cmp	[eax+14h], edx
		setnz	dl
		mov	[esp+64h+var_54], edx

loc_1000C033:				; CODE XREF: sub_1000BF70+AFj
		test	dword ptr [esi+14h], 8000h
		jz	loc_1000C0FE
		mov	eax, [esp+64h+var_4C]
		push	ecx
		push	eax
		push	30h
		lea	ecx, [esp+70h+var_44]
		push	ecx
		lea	edx, [esp+74h+var_34]
		push	edx
		push	edi
		call	PK11_PrivDecryptPKCS1
		add	esp, 18h
		test	eax, eax
		jnz	loc_1000C0FE
		test	dword ptr [esi+14h], 2000h
		jz	short loc_1000C0AA
		movzx	eax, [esp+64h+var_34]
		movzx	ecx, [esp+64h+var_33]
		shl	ax, 8
		or	ax, cx
		cmp	dword ptr [esi+2F38h], 1
		movzx	eax, ax
		jnz	short loc_1000C095
		push	eax
		call	sub_100021B0
		add	esp, 4
		movzx	eax, ax

loc_1000C095:				; CODE XREF: sub_1000BF70+117j
		cmp	ax, [esi+46h]
		jz	short loc_1000C0AA
		lea	edx, [esp+64h+var_34]
		push	30h
		push	edx
		call	PK11_GenerateRandom
		add	esp, 8

loc_1000C0AA:				; CODE XREF: sub_1000BF70+FAj
					; sub_1000BF70+129j
		mov	eax, [esp+64h+var_54]
		push	1
		push	eax
		lea	ecx, [esp+6Ch+var_40]
		push	ecx
		lea	eax, [esi+480h]
		push	eax
		push	ebx
		push	ebp
		call	sub_10001710
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000C0EC
		lea	eax, [ebp+11CCh]
		push	30h
		push	eax
		mov	[ebp+1134h], eax
		mov	dword ptr [ebp+1138h], 30h
		call	PK11_GenerateRandom
		add	esp, 8

loc_1000C0EC:				; CODE XREF: sub_1000BF70+159j
		push	0
		push	esi
		call	sub_100087C0
		add	esp, 8
		mov	esi, eax
		jmp	loc_1000C1A7
; ---------------------------------------------------------------------------

loc_1000C0FE:				; CODE XREF: sub_1000BF70+CAj
					; sub_1000BF70+EDj
		push	0
		push	10Ch
		push	371h
		lea	edx, [esp+70h+var_50]
		push	edx
		push	edi
		call	PK11_PubUnwrapSymKey
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jnz	short loc_1000C195
		push	edi
		call	PK11_GetSlotFromPrivateKey
		add	esp, 4
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1000C13E
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1000C13E:				; CODE XREF: sub_1000BF70+1BDj
		mov	ecx, [esi+44Ch]
		push	ecx
		push	esi
		call	sub_10006900
		add	esp, 8
		test	byte ptr [esi+16h], 1
		mov	ebp, eax
		jnz	short loc_1000C165
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000C165:				; CODE XREF: sub_1000BF70+1E4j
		push	edi
		call	PK11_FreeSlot
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_1000C195
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000C195:				; CODE XREF: sub_1000BF70+1ACj
					; sub_1000BF70+200j
		push	ebp
		push	esi
		call	sub_100087C0
		push	ebp
		mov	esi, eax
		call	PK11_FreeSymKey
		add	esp, 0Ch

loc_1000C1A7:				; CODE XREF: sub_1000BF70+189j
		mov	ecx, [esp+64h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		neg	eax
		pop	ebp
		sbb	eax, eax
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
sub_1000BF70	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C1C0	proc near		; CODE XREF: sub_1000F030+4ACp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword ptr [esi+4C0h], 2
		push	ebp
		mov	ebp, [esp+4+arg_4]
		jz	short loc_1000C1EA
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD031h
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C1EA:				; CODE XREF: sub_1000C1C0+Cj
		cmp	dword ptr [esi+840h], 0
		push	ebx
		mov	ebx, [esi+808h]
		push	edi
		jz	short loc_1000C21D
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_1000C21D
		cmp	dword ptr [ebx+4], 1
		jnz	short loc_1000C21D
		mov	edi, [esi+1F8h]
		test	edi, edi
		jz	short loc_1000C21D
		mov	dword ptr [esi+80h], 200h
		jmp	short loc_1000C26B
; ---------------------------------------------------------------------------

loc_1000C21D:				; CODE XREF: sub_1000C1C0+39j
					; sub_1000C1C0+3Fj ...
		mov	eax, [ebx]
		cmp	eax, 12h
		jz	short loc_1000C24B
		cmp	eax, 10h
		jz	short loc_1000C24B
		mov	eax, [ebx+4]
		add	eax, eax
		mov	ecx, [esi+eax*8+2F8h]
		mov	edi, [esi+eax*8+2F4h]
		lea	eax, [esi+eax*8+2ECh]
		mov	[esi+80h], ecx
		jmp	short loc_1000C26B
; ---------------------------------------------------------------------------

loc_1000C24B:				; CODE XREF: sub_1000C1C0+62j
					; sub_1000C1C0+67j
		mov	edi, [esi+444h]
		test	edi, edi
		jz	short loc_1000C275
		mov	eax, [edi+4]
		test	eax, eax
		jz	short loc_1000C26B
		push	eax
		call	SECKEY_PublicKeyStrengthInBits
		add	esp, 4
		mov	[esi+80h], eax

loc_1000C26B:				; CODE XREF: sub_1000C1C0+5Bj
					; sub_1000C1C0+89j ...
		test	edi, edi
		jz	short loc_1000C275
		mov	edx, [edi]
		test	edx, edx
		jnz	short loc_1000C289

loc_1000C275:				; CODE XREF: sub_1000C1C0+93j
					; sub_1000C1C0+ADj
		push	0FFFFD052h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C289:				; CODE XREF: sub_1000C1C0+B3j
		mov	eax, [ebx+4]
		mov	[esi+7Ch], eax
		mov	ebx, [ebx+4]
		dec	ebx
		jz	loc_1000C325
		sub	ebx, 3
		jz	short loc_1000C2CF
		push	28h
		push	2
		push	esi
		call	sub_10008960
		mov	ecx, [esi+4Ch]
		neg	ecx
		sbb	ecx, ecx
		add	ecx, 0FFFFD007h
		push	ecx
		call	PORT_SetError_Util
		push	0FFFFE030h
		call	PORT_SetError_Util
		add	esp, 14h
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C2CF:				; CODE XREF: sub_1000C1C0+DCj
		mov	edi, [edi+4]
		test	edi, edi
		jnz	short loc_1000C2EA
		push	0FFFFD043h
		call	PORT_SetError_Util
		add	esp, 4

loc_1000C2E3:				; CODE XREF: sub_1000C1C0+177j
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C2EA:				; CODE XREF: sub_1000C1C0+114j
		push	edx
		mov	edx, [esp+10h+arg_0]
		push	edi
		push	ebp
		push	edx
		push	esi
		call	sub_10020D10
		mov	edi, eax
		mov	eax, [esi+444h]
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000C31A
		push	eax
		call	sub_100074E0
		add	esp, 4
		mov	dword ptr [esi+444h], 0

loc_1000C31A:				; CODE XREF: sub_1000C1C0+145j
		test	edi, edi
		jz	short loc_1000C339
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C325:				; CODE XREF: sub_1000C1C0+D3j
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		push	eax
		mov	ecx, esi
		call	sub_1000BF70
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000C2E3

loc_1000C339:				; CODE XREF: sub_1000C1C0+15Cj
		mov	ecx, [esi+6Ch]
		neg	ecx
		sbb	ecx, ecx
		pop	edi
		add	ecx, 4
		pop	ebx
		mov	[esi+4C0h], ecx
		xor	eax, eax
		pop	ebp
		retn
sub_1000C1C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C350	proc near		; CODE XREF: sub_1000F030+4ECp

var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		cmp	dword ptr [esi+4C0h], 0Ch
		jz	short loc_1000C380
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD06Dh
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000C380:				; CODE XREF: sub_1000C350+Fj
		call	sub_10018130
		cmp	[esp+10h+arg_8], 4
		mov	[esi+858h], eax
		jb	short loc_1000C409
		lea	eax, [esp+10h+arg_8]
		push	eax
		lea	ecx, [esp+14h+arg_4]
		push	ecx
		push	4
		push	esi
		call	sub_100091C0
		lea	edx, [esp+20h+arg_8]
		push	edx
		mov	[esi+85Ch], eax
		lea	eax, [esp+24h+arg_4]
		push	eax
		push	2
		lea	ecx, [esp+2Ch+var_C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 24h
		test	eax, eax
		jnz	short loc_1000C409
		cmp	[esp+10h+arg_8], eax
		jnz	short loc_1000C409
		cmp	[esp+10h+var_4], eax
		jz	short loc_1000C3F8
		lea	edx, [esp+10h+var_C]
		push	edx
		lea	eax, [esi+860h]
		push	eax
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C423
		mov	dword ptr [esi+854h], 1

loc_1000C3F8:				; CODE XREF: sub_1000C350+82j
		mov	dword ptr [esi+4C0h], 4
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000C409:				; CODE XREF: sub_1000C350+40j
					; sub_1000C350+76j ...
		push	32h
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD06Eh
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh

loc_1000C423:				; CODE XREF: sub_1000C350+9Cj
		pop	esi
		add	esp, 0Ch
		retn
sub_1000C350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C430	proc near		; CODE XREF: sub_1000D520+EDp
					; sub_1000D710+10p

Src		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	eax, [esi+68h]
		sub	esp, 0Ch
		push	ebx
		push	ebp
		xor	ebp, ebp
		xor	ebx, ebx
		push	edi
		cmp	eax, ebp
		jz	short loc_1000C44A
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_1000C44A:				; CODE XREF: sub_1000C430+Fj
		cmp	[esi+4Ch], ebp
		jz	short loc_1000C490
		mov	ecx, [esi+808h]
		mov	eax, [ecx]
		cmp	eax, 12h
		jz	short loc_1000C466
		cmp	eax, 0Ah
		jz	short loc_1000C466
		mov	eax, [ecx+4]
		jmp	short loc_1000C46B
; ---------------------------------------------------------------------------

loc_1000C466:				; CODE XREF: sub_1000C430+2Aj
					; sub_1000C430+2Fj
		mov	eax, 1

loc_1000C46B:				; CODE XREF: sub_1000C430+34j
		add	eax, eax
		mov	edx, [esi+eax*8+2F8h]
		mov	edi, [esi+eax*8+2F0h]
		lea	eax, [esi+eax*8+2ECh]
		mov	[esi+78h], edx
		mov	ecx, [ecx+8]
		mov	[esi+74h], ecx
		mov	edx, [eax]
		push	edx
		jmp	short loc_1000C49D
; ---------------------------------------------------------------------------

loc_1000C490:				; CODE XREF: sub_1000C430+1Dj
		mov	eax, [esi+458h]
		mov	edi, [esi+460h]
		push	eax

loc_1000C49D:				; CODE XREF: sub_1000C430+5Ej
		call	CERT_DupCertificate
		add	esp, 4
		mov	[esi+68h], eax
		cmp	edi, ebp
		jz	short loc_1000C4C4
		mov	ecx, [edi+4]
		cmp	ecx, ebp
		jle	short loc_1000C4C4
		mov	eax, [edi]
		add	eax, 8

loc_1000C4B8:				; CODE XREF: sub_1000C430+92j
		mov	edx, [eax]
		add	eax, 0Ch
		dec	ecx
		lea	ebx, [ebx+edx+3]
		jnz	short loc_1000C4B8

loc_1000C4C4:				; CODE XREF: sub_1000C430+7Aj
					; sub_1000C430+81j
		lea	eax, [ebx+3]
		push	eax		; int
		push	0Bh		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		cmp	eax, ebp
		jnz	loc_1000C572
		push	3		; Size
		lea	eax, [esp+1Ch+Src]
		mov	ecx, ebx
		mov	edx, ebx
		push	eax		; Src
		sar	ecx, 10h
		sar	edx, 8
		push	esi		; int
		mov	[esp+24h+Src], cl
		mov	[esp+24h+var_B], dl
		mov	[esp+24h+var_A], bl
		call	sub_10008E00
		add	esp, 0Ch
		cmp	eax, ebp
		jnz	short loc_1000C572
		cmp	edi, ebp
		jz	short loc_1000C570
		mov	[esp+18h+var_4], ebp
		cmp	[edi+4], ebp
		jle	short loc_1000C570
		mov	[esp+18h+var_8], ebp

loc_1000C516:				; CODE XREF: sub_1000C430+13Ej
		mov	eax, [edi]
		mov	edx, [esp+18h+var_8]
		mov	ebx, [eax+edx+8]
		mov	ebp, [eax+edx+4]
		push	3		; Size
		lea	edx, [esp+1Ch+Src]
		mov	eax, ebx
		mov	ecx, ebx
		push	edx		; Src
		sar	eax, 10h
		sar	ecx, 8
		push	esi		; int
		mov	[esp+24h+Src], al
		mov	[esp+24h+var_B], cl
		mov	[esp+24h+var_A], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C572
		push	ebx		; Size
		push	ebp		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C572
		mov	eax, [esp+18h+var_4]
		add	[esp+18h+var_8], 0Ch
		inc	eax
		mov	[esp+18h+var_4], eax
		cmp	eax, [edi+4]
		jl	short loc_1000C516

loc_1000C570:				; CODE XREF: sub_1000C430+D7j
					; sub_1000C430+E0j
		xor	eax, eax

loc_1000C572:				; CODE XREF: sub_1000C430+A5j
					; sub_1000C430+D3j ...
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000C430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C580	proc near		; CODE XREF: sub_1000D710+1Dp

Src		= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2

		push	ecx
		push	5
		push	esi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000C592
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000C592:				; CODE XREF: sub_1000C580+Ej
		mov	eax, [esi+808h]
		mov	ecx, [eax]
		cmp	ecx, 12h
		jz	short loc_1000C5A9
		cmp	ecx, 0Ah
		jz	short loc_1000C5A9
		mov	eax, [eax+4]
		jmp	short loc_1000C5AE
; ---------------------------------------------------------------------------

loc_1000C5A9:				; CODE XREF: sub_1000C580+1Dj
					; sub_1000C580+22j
		mov	eax, 1

loc_1000C5AE:				; CODE XREF: sub_1000C580+27j
		push	edi
		mov	edi, [esi+eax*4+33Ch]
		test	edi, edi
		jz	short loc_1000C5C0
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1000C5C5

loc_1000C5C0:				; CODE XREF: sub_1000C580+38j
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000C5C5:				; CODE XREF: sub_1000C580+3Ej
		mov	eax, [edi]
		mov	eax, [eax+8]
		add	eax, 4
		push	eax		; int
		push	16h		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C635
		push	1		; Size
		lea	ecx, [esp+0Ch+Src]
		push	ecx		; Src
		push	esi		; int
		mov	[esp+14h+Src], 1
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C635
		mov	eax, [edi]
		mov	edi, [eax+4]
		push	ebx
		mov	ebx, [eax+8]
		push	3		; Size
		lea	ecx, [esp+10h+Src]
		mov	edx, ebx
		mov	eax, ebx
		push	ecx		; Src
		sar	edx, 10h
		sar	eax, 8
		push	esi		; int
		mov	[esp+18h+Src], dl
		mov	[esp+18h+var_3], al
		mov	[esp+18h+var_2], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C634
		push	ebx		; Size
		push	edi		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000C634:				; CODE XREF: sub_1000C580+A7j
		pop	ebx

loc_1000C635:				; CODE XREF: sub_1000C580+5Bj
					; sub_1000C580+74j
		pop	edi
		pop	ecx
		retn
sub_1000C580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C640	proc near		; CODE XREF: sub_1000EB90+12Dp
					; sub_1000ECD0:loc_1000EFE1p ...
		mov	ecx, [esi+200h]
		mov	edx, [esi+1FCh]
		xor	eax, eax
		cmp	[esi+4Ch], eax
		push	ebx
		setnz	al
		push	edi
		mov	dword ptr [esi+8BCh], 0
		push	eax
		mov	eax, [esi]
		push	1
		push	eax
		push	ecx
		call	edx
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jz	short loc_1000C6C8
		call	PORT_GetError_Util
		mov	edi, eax
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_1000C6A2
		mov	eax, [esi+214h]
		test	eax, eax
		jz	short loc_1000C699
		mov	ecx, [esi]
		mov	edx, [esi+218h]
		push	ecx
		push	edx
		call	eax
		add	esp, 8
		mov	ebx, eax

loc_1000C699:				; CODE XREF: sub_1000C640+46j
		cmp	ebx, 0FFFFFFFEh
		jnz	loc_1000C752

loc_1000C6A2:				; CODE XREF: sub_1000C640+3Cj
		cmp	dword ptr [esi+4Ch], 0
		jz	short loc_1000C6BC
		mov	edi, 0FFFFD076h
		push	edi
		call	sub_100147C0
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000C6BC:				; CODE XREF: sub_1000C640+66j
		mov	dword ptr [esi+8BCh], 1
		xor	ebx, ebx

loc_1000C6C8:				; CODE XREF: sub_1000C640+30j
					; sub_1000C640+114j
		mov	eax, [esi+6Ch]
		push	eax
		call	CERT_DupCertificate
		mov	ecx, [esi+0F4h]
		add	esp, 4
		mov	[ecx+10h], eax
		cmp	dword ptr [esi+4Ch], 0
		jnz	loc_1000C7BB
		mov	edi, [esi+6Ch]
		push	ebp
		push	edi
		call	CERT_ExtractPublicKey
		mov	ebp, eax
		mov	eax, [esi+808h]
		mov	edx, [eax+8]
		mov	[esi+74h], edx
		mov	eax, [eax+4]
		add	esp, 4
		mov	[esi+7Ch], eax
		test	ebp, ebp
		jz	short loc_1000C786
		push	ebp
		call	SECKEY_PublicKeyStrengthInBits
		add	esp, 4
		cmp	dword ptr [esi+7Ch], 4
		mov	[esi+78h], eax
		mov	[esi+80h], eax
		jnz	short loc_1000C77D
		mov	ecx, [esi+808h]
		mov	eax, [ecx]
		cmp	eax, 0Fh
		jnz	short loc_1000C772
		mov	edx, [edi+34h]
		movzx	eax, byte ptr [edx+3]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		mov	[esi+78h], eax
		mov	ecx, [edi+34h]
		cmp	byte ptr [ecx+4], 0
		jnz	short loc_1000C77D
		add	eax, 0FFFFFFF8h
		mov	[esi+78h], eax
		jmp	short loc_1000C77D
; ---------------------------------------------------------------------------

loc_1000C752:				; CODE XREF: sub_1000C640+5Cj
		test	ebx, ebx
		jz	loc_1000C6C8
		mov	ecx, edi
		mov	edx, esi
		call	sub_10008A80
		push	edi
		call	sub_100147C0
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000C772:				; CODE XREF: sub_1000C640+EFj
		cmp	eax, 11h
		jnz	short loc_1000C77D
		mov	edx, [edi+38h]
		mov	[esi+78h], edx

loc_1000C77D:				; CODE XREF: sub_1000C640+E2j
					; sub_1000C640+108j ...
		push	ebp
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_1000C786:				; CODE XREF: sub_1000C640+CAj
		mov	eax, [esi+808h]
		mov	dword ptr [esi+4C0h], 0Ah
		cmp	dword ptr [eax+0Ch], 0
		pop	ebp
		jnz	short loc_1000C7AF
		mov	ecx, [eax]
		cmp	ecx, 10h
		jz	short loc_1000C7AF
		cmp	ecx, 12h
		jz	short loc_1000C7AF
		cmp	dword ptr [eax+4], 2
		jnz	short loc_1000C7C5

loc_1000C7AF:				; CODE XREF: sub_1000C640+15Bj
					; sub_1000C640+162j ...
		mov	dword ptr [esi+4C0h], 9
		jmp	short loc_1000C7C5
; ---------------------------------------------------------------------------

loc_1000C7BB:				; CODE XREF: sub_1000C640+A1j
		mov	dword ptr [esi+4C0h], 2

loc_1000C7C5:				; CODE XREF: sub_1000C640+16Dj
					; sub_1000C640+179j
		test	ebx, ebx
		jz	short loc_1000C7DD
		mov	edi, 0FFFFE001h
		push	edi
		call	sub_100147C0
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000C7DD:				; CODE XREF: sub_1000C640+187j
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
sub_1000C640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C7F0	proc near		; CODE XREF: SSL_AuthCertificateComplete+6Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		xor	ebp, ebp
		cmp	[esi+4Ch], ebp
		jz	short loc_1000C810
		push	0FFFFD076h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C810:				; CODE XREF: sub_1000C7F0+Bj
		push	ebx
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_1000C83C
		mov	eax, [esi+24Ch]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1000C83C
		mov	ecx, [esi+258h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1000C83C:				; CODE XREF: sub_1000C7F0+2Dj
					; sub_1000C7F0+3Ej
		cmp	[esi+8BCh], ebp
		jnz	short loc_1000C856
		push	0FFFFE8D5h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_1000C877
; ---------------------------------------------------------------------------

loc_1000C856:				; CODE XREF: sub_1000C7F0+52j
		mov	ecx, [esp+10h+arg_4]
		mov	[esi+8BCh], ebp
		cmp	ecx, ebp
		jz	short loc_1000C8A6
		mov	edx, esi
		mov	dword ptr [esi+8C0h], offset loc_10006A80
		call	sub_10008A80

loc_1000C875:				; CODE XREF: sub_1000C7F0+D3j
					; sub_1000C7F0+DCj ...
		xor	edi, edi

loc_1000C877:				; CODE XREF: sub_1000C7F0+64j
					; sub_1000C7F0+D1j ...
		mov	ebp, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_1000C89F
		mov	edx, [esi+258h]
		push	edx
		call	ebp ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1000C89F
		mov	eax, [esi+24Ch]
		push	eax
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_1000C89F:				; CODE XREF: sub_1000C7F0+90j
					; sub_1000C7F0+A1j
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000C8A6:				; CODE XREF: sub_1000C7F0+72j
		mov	eax, [esi+8C0h]
		cmp	eax, ebp
		jz	short loc_1000C8C5
		push	esi
		mov	[esi+8C0h], ebp
		call	eax
		add	esp, 4
		mov	edi, eax
		cmp	edi, 0FFFFFFFEh
		jnz	short loc_1000C877
		jmp	short loc_1000C875
; ---------------------------------------------------------------------------

loc_1000C8C5:				; CODE XREF: sub_1000C7F0+BEj
		test	dword ptr [esi+14h], 400000h
		jz	short loc_1000C875
		cmp	[esi+24h], ebp
		jnz	short loc_1000C875
		cmp	[esi+83Ch], ebp
		jnz	short loc_1000C875
		push	esi
		call	sub_10006640
		add	esp, 4
		test	eax, eax
		jz	short loc_1000C875
		call	sub_100065C0
		mov	edi, eax
		jmp	short loc_1000C877
sub_1000C7F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C900	proc near		; CODE XREF: sub_1000CB90+2ACp
					; sub_1000D520+133p

Src		= byte ptr -8
Size		= dword	ptr -4

		sub	esp, 8
		cmp	dword ptr [esi+2E80h], 0
		jz	loc_1000C9AE
		cmp	dword ptr [esi+2E84h], 3
		jz	loc_1000C9AE
		mov	eax, [esi+2E80h]
		push	ebx
		lea	ecx, [eax+2]
		and	ecx, 1Fh
		mov	ebx, 20h
		sub	ebx, ecx
		lea	edx, [eax+ebx+2]
		push	edx		; int
		push	43h		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C9A9
		mov	eax, [esi+2E80h]
		push	edi
		mov	edi, [esi+2E7Ch]
		mov	[esp+10h+Size],	eax
		mov	[esp+10h+Src], al
		push	1		; Size
		lea	eax, [esp+14h+Src]
		push	eax		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C97D
		mov	ecx, [esp+10h+Size]
		push	ecx		; Size
		push	edi		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000C97D:				; CODE XREF: sub_1000C900+6Cj
		pop	edi
		test	eax, eax
		jnz	short loc_1000C9A9
		push	1		; Size
		lea	edx, [esp+10h+Size]
		push	edx		; Src
		push	esi		; int
		mov	byte ptr [esp+18h+Size], bl
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C9A9
		push	ebx		; Size
		push	offset dword_1002B01C ;	Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch

loc_1000C9A9:				; CODE XREF: sub_1000C900+43j
					; sub_1000C900+80j ...
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000C9AE:				; CODE XREF: sub_1000C900+Aj
					; sub_1000C900+17j
		xor	eax, eax
		add	esp, 8
		retn
sub_1000C900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C9C0	proc near		; CODE XREF: sub_1000CB90+2D0p
					; sub_1000D520+18Ap ...

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
Src		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+64h+arg_0]
		push	esi
		mov	esi, [ebp+4Ch]
		mov	[esp+68h+var_5C], esi
		neg	esi
		sbb	esi, esi
		and	esi, 100607FEh
		add	esi, 434C4E54h
		test	byte ptr [ebp+16h], 1
		push	edi
		jnz	short loc_1000CA02
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000CA02:				; CODE XREF: sub_1000C9C0+31j
		mov	ebx, [ebp+450h]
		mov	ecx, 300h
		cmp	cx, [ebx+58h]
		push	esi
		push	ebp
		lea	edx, [esp+74h+var_4C]
		mov	ecx, ebx
		sbb	edi, edi
		call	sub_100056B0
		add	esp, 8
		neg	edi
		mov	esi, eax
		jz	short loc_1000CA5C
		test	esi, esi
		jnz	short loc_1000CA5C
		cmp	[esp+6Ch+var_5C], eax
		mov	eax, offset aServerFinished ; "server finished"
		jnz	short loc_1000CA3D
		mov	eax, offset aClientFinished ; "client finished"

loc_1000CA3D:				; CODE XREF: sub_1000C9C0+76j
		mov	ecx, [esp+6Ch+var_4C]
		push	0Ch
		lea	edx, [esp+70h+var_58]
		push	edx
		push	ecx
		lea	edx, [esp+78h+Src]
		push	edx
		push	0Fh
		push	eax
		push	ebx
		call	sub_10006AA0
		add	esp, 1Ch
		mov	esi, eax

loc_1000CA5C:				; CODE XREF: sub_1000C9C0+67j
					; sub_1000C9C0+6Bj
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000CA71
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000CA71:				; CODE XREF: sub_1000C9C0+A0j
		test	esi, esi
		jnz	loc_1000CB58
		test	edi, edi
		jz	short loc_1000CAE0
		mov	ecx, [esp+6Ch+var_58]
		mov	edx, [esp+6Ch+var_54]
		mov	eax, [esp+6Ch+var_50]
		cmp	[esp+6Ch+var_5C], esi
		jz	short loc_1000CAA3
		mov	[ebp+87Ah], ecx
		mov	[ebp+87Eh], edx
		mov	[ebp+882h], eax
		jmp	short loc_1000CAB5
; ---------------------------------------------------------------------------

loc_1000CAA3:				; CODE XREF: sub_1000C9C0+CDj
		mov	[ebp+86Eh], ecx
		mov	[ebp+872h], edx
		mov	[ebp+876h], eax

loc_1000CAB5:				; CODE XREF: sub_1000C9C0+E1j
		mov	ecx, 0Ch
		push	ecx		; int
		push	14h		; char
		push	ebp		; Src
		mov	[ebp+86Ch], cx
		call	sub_10008FF0
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_1000CB58
		push	0Ch
		lea	edx, [esp+70h+var_58]
		push	edx
		jmp	short loc_1000CB23
; ---------------------------------------------------------------------------

loc_1000CAE0:				; CODE XREF: sub_1000C9C0+BBj
		cmp	[esp+6Ch+var_5C], 0
		mov	ecx, 9
		lea	esi, [esp+6Ch+Src]
		lea	edi, [ebp+892h]
		jnz	short loc_1000CAFC
		lea	edi, [ebp+86Eh]

loc_1000CAFC:				; CODE XREF: sub_1000C9C0+134j
		mov	eax, 24h
		push	eax		; int
		push	14h		; char
		push	ebp		; Src
		rep movsd
		mov	[ebp+86Ch], ax
		call	sub_10008FF0
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1000CB58
		push	24h		; Size
		lea	ecx, [esp+70h+Src]
		push	ecx		; Src

loc_1000CB23:				; CODE XREF: sub_1000C9C0+11Ej
		push	ebp		; int
		call	sub_10008E00
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1000CB58
		cmp	dword ptr [ebp+2F38h], 1
		mov	edx, [esp+6Ch+arg_4]
		jnz	short loc_1000CB4B
		push	edx
		push	ebp
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_1000CB52
; ---------------------------------------------------------------------------

loc_1000CB4B:				; CODE XREF: sub_1000C9C0+17Dj
		mov	edi, ebp
		call	sub_10008170

loc_1000CB52:				; CODE XREF: sub_1000C9C0+189j
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000CB6D

loc_1000CB58:				; CODE XREF: sub_1000C9C0+B3j
					; sub_1000C9C0+111j ...
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CB6D:				; CODE XREF: sub_1000C9C0+196j
		mov	ebx, ebp
		call	sub_10006BF0
		mov	ecx, [esp+6Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
sub_1000C9C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CB90	proc near		; CODE XREF: sub_1000F030+4FFp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_8]
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+arg_0]
		cmp	dword ptr [ebp+4C0h], 5
		mov	ecx, [ebp+4Ch]
		mov	ebx, [ebp+0F4h]
		mov	[esp+24h+var_14], edx
		mov	[esp+24h+var_18], 0
		mov	[esp+24h+var_1C], ecx
		jz	short loc_1000CBF5
		push	0Ah
		push	2
		push	ebp
		call	sub_10008960
		push	0FFFFD032h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CBF5:				; CODE XREF: sub_1000CB90+38j
		push	esi
		mov	esi, [ebp+448h]
		push	edi
		mov	edi, 300h
		cmp	[esi+58h], di
		jbe	loc_1000CCFC
		cmp	[esp+2Ch+arg_4], 0Ch
		jz	short loc_1000CC40
		push	32h
		push	2
		push	ebp
		call	sub_10008960
		push	0FFFFD024h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CC40:				; CODE XREF: sub_1000CB90+81j
		test	ecx, ecx
		mov	ecx, offset aServerFinished ; "server finished"
		jz	short loc_1000CC4E
		mov	ecx, offset aClientFinished ; "client finished"

loc_1000CC4E:				; CODE XREF: sub_1000CB90+B7j
		push	0Ch
		lea	edx, [esp+30h+var_10]
		push	edx
		mov	edx, [eax]
		push	edx
		add	eax, 8
		push	eax
		push	0Fh
		push	ecx
		push	esi
		call	sub_10006AA0
		mov	edi, [esp+48h+var_1C]
		mov	ecx, [esp+48h+var_C]
		mov	edx, [esp+48h+var_8]
		add	esp, 1Ch
		mov	esi, eax
		mov	eax, [esp+2Ch+var_10]
		test	edi, edi
		jnz	short loc_1000CC92
		mov	[ebp+87Ah], eax
		mov	[ebp+87Eh], ecx
		mov	[ebp+882h], edx
		jmp	short loc_1000CCA4
; ---------------------------------------------------------------------------

loc_1000CC92:				; CODE XREF: sub_1000CB90+ECj
		mov	[ebp+86Eh], eax
		mov	[ebp+872h], ecx
		mov	[ebp+876h], edx

loc_1000CCA4:				; CODE XREF: sub_1000CB90+100j
		mov	eax, 0Ch
		mov	[ebp+86Ch], ax
		test	esi, esi
		jnz	short loc_1000CCCF
		mov	ecx, [esp+2Ch+var_14]
		push	eax
		push	ecx
		lea	edx, [esp+34h+var_10]
		push	edx
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jz	loc_1000CDAB

loc_1000CCCF:				; CODE XREF: sub_1000CB90+122j
		push	33h
		push	2
		push	ebp
		call	sub_10008960
		push	0FFFFD057h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CCFC:				; CODE XREF: sub_1000CB90+76j
		cmp	[esp+2Ch+arg_4], 24h
		jz	short loc_1000CD42
		push	2Fh
		push	2
		push	ebp
		call	sub_10008960
		mov	eax, [ebp+4Ch]
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFD007h
		push	eax
		call	PORT_SetError_Util
		push	0FFFFD024h
		call	PORT_SetError_Util
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CD42:				; CODE XREF: sub_1000CB90+171j
		add	eax, 8
		test	ecx, ecx
		mov	esi, eax
		mov	ecx, 9
		lea	edi, [ebp+892h]
		jz	short loc_1000CD5C
		lea	edi, [ebp+86Eh]

loc_1000CD5C:				; CODE XREF: sub_1000CB90+1C4j
		rep movsd
		mov	ecx, 24h
		push	ecx
		push	edx
		push	eax
		mov	[ebp+86Ch], cx
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000CDA3
		mov	esi, ebp
		call	sub_10008A50
		push	0FFFFD057h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CDA3:				; CODE XREF: sub_1000CB90+1E7j
		mov	edi, [esp+2Ch+var_1C]
		mov	esi, [esp+2Ch+var_18]

loc_1000CDAB:				; CODE XREF: sub_1000CB90+139j
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000CDC1
		mov	edx, [ebp+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000CDC1:				; CODE XREF: sub_1000CB90+21Fj
		mov	eax, [ebp+83Ch]
		test	edi, edi
		jz	short loc_1000CDD4
		test	eax, eax
		jz	short loc_1000CDDC
		jmp	loc_1000CE70
; ---------------------------------------------------------------------------

loc_1000CDD4:				; CODE XREF: sub_1000CB90+239j
		test	eax, eax
		jz	loc_1000CE70

loc_1000CDDC:				; CODE XREF: sub_1000CB90+23Dj
		mov	[esp+2Ch+var_1C], 0
		test	edi, edi
		jz	short loc_1000CE0C
		test	eax, eax
		jnz	short loc_1000CE0C
		push	23h
		push	ebp
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000CE0C
		push	ebp
		call	sub_10015700
		add	esp, 4
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	short loc_1000CE6C

loc_1000CE0C:				; CODE XREF: sub_1000CB90+256j
					; sub_1000CB90+25Aj ...
		mov	eax, ebp
		call	sub_10008C10
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	short loc_1000CE6C
		call	ds:PR_GetCurrentThread
		cmp	[ebp+264h], eax
		jnz	short loc_1000CE31
		mov	[esp+2Ch+var_1C], 40000000h

loc_1000CE31:				; CODE XREF: sub_1000CB90+297j
		test	edi, edi
		jnz	short loc_1000CE49
		cmp	[ebp+24h], edi
		jnz	short loc_1000CE49
		mov	esi, ebp
		call	sub_1000C900
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	short loc_1000CE6C

loc_1000CE49:				; CODE XREF: sub_1000CB90+2A3j
					; sub_1000CB90+2A8j
		cmp	dword ptr [ebp+2F38h], 1
		jnz	short loc_1000CE5A
		or	[esp+2Ch+var_1C], 8000000h

loc_1000CE5A:				; CODE XREF: sub_1000CB90+2C0j
		mov	eax, [esp+2Ch+var_1C]
		push	eax
		push	ebp
		call	sub_1000C9C0
		add	esp, 8
		mov	[esp+2Ch+var_18], eax

loc_1000CE6C:				; CODE XREF: sub_1000CB90+27Aj
					; sub_1000CB90+289j ...
		mov	esi, [esp+2Ch+var_18]

loc_1000CE70:				; CODE XREF: sub_1000CB90+23Fj
					; sub_1000CB90+246j
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000CE86
		mov	ecx, [ebp+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000CE86:				; CODE XREF: sub_1000CB90+2E4j
		test	esi, esi
		jz	short loc_1000CE9F
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CE9F:				; CODE XREF: sub_1000CB90+2F8j
		mov	eax, [ebp+808h]
		cmp	dword ptr [eax], 12h
		mov	esi, 1
		jz	short loc_1000CEB2
		mov	esi, [eax+4]

loc_1000CEB2:				; CODE XREF: sub_1000CB90+31Dj
		cmp	dword ptr [ebx+4], 0
		jnz	loc_1000CFF8
		test	dword ptr [ebp+14h], 400h
		jnz	loc_1000CFF8
		cmp	dword ptr [ebp+84h], 0
		jz	loc_1000CFF8
		mov	dx, [ebp+80Ch]
		mov	[ebx+76h], dx
		mov	eax, [ebp+814h]
		mov	[ebx+78h], eax
		mov	ecx, [ebp+468h]
		mov	[ebx+7Ch], ecx
		mov	edx, [ebp+8B8h]
		mov	[ebx+0BCh], edx
		mov	[ebx+0B8h], esi
		mov	ax, [ebp+44h]
		mov	[ebx+3Ah], ax
		mov	ecx, [ebp+74h]
		mov	[ebx+44h], ecx
		mov	edx, [ebp+78h]
		mov	[ebx+48h], edx
		mov	eax, [ebp+7Ch]
		mov	[ebx+4Ch], eax
		mov	ecx, [ebp+80h]
		mov	[ebx+50h], ecx
		call	sub_10018130
		mov	[ebx+3Ch], eax
		mov	[ebx+0Ch], eax
		add	eax, dword_10037100
		mov	[ebx+40h], eax
		mov	eax, [ebp+68h]
		push	eax
		call	CERT_DupCertificate
		add	esp, 4
		mov	[ebx+24h], eax
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000CF60
		mov	ecx, [ebp+25Ch]
		push	ecx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000CF60:				; CODE XREF: sub_1000CB90+3BFj
		mov	eax, [ebp+448h]
		cmp	dword ptr [eax+1138h], 0
		jz	short loc_1000CFBB
		cmp	dword ptr [eax+1134h], 0
		jz	short loc_1000CFBB
		mov	dx, [eax+1138h]
		mov	[ebx+0B0h], dx
		mov	eax, [ebp+448h]
		mov	ecx, [eax+1138h]
		mov	edx, [eax+1134h]
		push	ecx		; Size
		push	edx		; Src
		lea	eax, [ebx+80h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	byte ptr [ebx+0DEh], 1
		mov	byte ptr [ebx+0B2h], 0
		xor	esi, esi
		jmp	short loc_1000CFD6
; ---------------------------------------------------------------------------

loc_1000CFBB:				; CODE XREF: sub_1000CB90+3DDj
					; sub_1000CB90+3E6j
		mov	ecx, [ebp+0F4h]
		push	esi
		push	eax
		push	ecx
		push	ebp
		call	sub_10006EA0
		add	esp, 10h
		mov	esi, eax
		mov	byte ptr [ebx+0B2h], 1

loc_1000CFD6:				; CODE XREF: sub_1000CB90+429j
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1000CFEB
		mov	edx, [ebp+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000CFEB:				; CODE XREF: sub_1000CB90+44Aj
		xor	eax, eax
		test	esi, esi
		setz	al
		mov	[ebp+8C4h], eax

loc_1000CFF8:				; CODE XREF: sub_1000CB90+326j
					; sub_1000CB90+333j ...
		cmp	dword ptr [ebp+8BCh], 0
		jz	short loc_1000D04F
		cmp	dword ptr [ebp+8C0h], 0
		jz	short loc_1000D02D
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D02D:				; CODE XREF: sub_1000CB90+478j
		pop	edi
		pop	esi
		mov	dword ptr [ebp+8C0h], offset sub_10007010
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000D04F:				; CODE XREF: sub_1000CB90+46Fj
		push	ebp
		call	sub_10007010
		mov	ecx, [esp+30h+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_1000CB90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D070	proc near		; CODE XREF: SSL_ReHandshake+7Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+24h], 0
		push	edi
		mov	edi, [esi+0F4h]
		jz	loc_1000D150
		mov	eax, 300h
		cmp	[esi+44h], ax
		jb	short loc_1000D0A7
		cmp	dword ptr [esi+478h], 0
		jz	short loc_1000D0A7
		cmp	dword ptr [esi+4C0h], 0Dh
		jnz	loc_1000D150

loc_1000D0A7:				; CODE XREF: sub_1000D070+1Fj
					; sub_1000D070+28j
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_1000D0B9
		push	esi
		call	sub_10002470
		add	esp, 4

loc_1000D0B9:				; CODE XREF: sub_1000D070+3Ej
		test	dword ptr [esi+14h], 180000h
		jnz	short loc_1000D0D5
		push	0FFFFD070h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D0D5:				; CODE XREF: sub_1000D070+50j
		test	edi, edi
		jz	short loc_1000D103
		cmp	[esp+8+arg_4], 0
		jz	short loc_1000D103
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_1000D0F0
		push	edi
		call	eax
		add	esp, 4

loc_1000D0F0:				; CODE XREF: sub_1000D070+78j
		push	edi
		call	sub_10017FD0
		add	esp, 4
		mov	dword ptr [esi+0F4h], 0

loc_1000D103:				; CODE XREF: sub_1000D070+67j
					; sub_1000D070+6Ej
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000D119
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000D119:				; CODE XREF: sub_1000D070+97j
		cmp	dword ptr [esi+4Ch], 0
		jz	short loc_1000D128
		mov	eax, esi
		call	sub_1000B7A0
		jmp	short loc_1000D133
; ---------------------------------------------------------------------------

loc_1000D128:				; CODE XREF: sub_1000D070+ADj
		push	0
		push	esi
		call	sub_10009320
		add	esp, 8

loc_1000D133:				; CODE XREF: sub_1000D070+B6j
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1000D14B
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000D14B:				; CODE XREF: sub_1000D070+C9j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D150:				; CODE XREF: sub_1000D070+10j
					; sub_1000D070+31j
		push	0FFFFD056h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_1000D070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D170	proc near		; CODE XREF: sub_1000D240+1D2p
					; sub_1000ECD0+100p
		push	ebx
		xor	ebx, ebx
		cmp	[esi+6Ch], ebx
		jz	short loc_1000D19A
		mov	eax, [esi+70h]
		cmp	eax, ebx
		jz	short loc_1000D18B
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	[esi+70h], ebx

loc_1000D18B:				; CODE XREF: sub_1000D170+Dj
		mov	eax, [esi+6Ch]
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi+6Ch], ebx

loc_1000D19A:				; CODE XREF: sub_1000D170+6j
		push	ebp
		mov	ebp, [esi+46Ch]
		push	edi
		mov	edi, [esi+470h]
		cmp	edi, ebx
		jz	short loc_1000D1C2
		lea	esp, [esp+0]

loc_1000D1B0:				; CODE XREF: sub_1000D170+50j
		mov	ecx, [edi+4]
		push	ecx
		call	CERT_DestroyCertificate
		mov	edi, [edi]
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_1000D1B0

loc_1000D1C2:				; CODE XREF: sub_1000D170+3Aj
		cmp	ebp, ebx
		jz	short loc_1000D1D0
		push	ebx
		push	ebp
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000D1D0:				; CODE XREF: sub_1000D170+54j
		mov	eax, [esi+14h]
		shr	eax, 3
		and	eax, 3
		pop	edi
		mov	[esi+46Ch], ebx
		mov	[esi+470h], ebx
		pop	ebp
		cmp	eax, 1
		jz	short loc_1000D1FA
		cmp	[esi+24h], ebx
		jnz	short loc_1000D1F6
		cmp	eax, 2
		jz	short loc_1000D1FA

loc_1000D1F6:				; CODE XREF: sub_1000D170+7Fj
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D1FA:				; CODE XREF: sub_1000D170+7Aj
					; sub_1000D170+84j
		mov	eax, [esi+88h]
		cmp	eax, ebx
		jz	short loc_1000D210
		mov	edx, [esi+0F4h]
		push	edx
		call	eax
		add	esp, 4

loc_1000D210:				; CODE XREF: sub_1000D170+92j
		push	2Ah
		push	2
		push	esi
		call	sub_10008960
		mov	eax, [esi]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	edx, [ecx+40h]
		push	1
		push	eax
		call	edx
		push	0FFFFD003h
		call	PORT_SetError_Util
		add	esp, 18h
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_1000D170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D240	proc near		; CODE XREF: sub_1000F790+79Ap
		cmp	dword ptr [ecx+4], 2
		push	esi
		mov	esi, eax
		jz	short loc_1000D288
		mov	eax, 300h
		cmp	ax, [esi+44h]
		sbb	ecx, ecx
		and	ecx, 3
		add	ecx, 2Fh
		push	ecx
		push	2
		push	esi
		call	sub_10008960
		mov	edx, [esi+4Ch]
		neg	edx
		sbb	edx, edx
		add	edx, 0FFFFD007h
		push	edx
		call	PORT_SetError_Util
		push	0FFFFD026h
		call	PORT_SetError_Util
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D288:				; CODE XREF: sub_1000D240+7j
		mov	eax, [ecx]
		movzx	edx, byte ptr [eax]
		push	ebx
		movzx	ebx, byte ptr [eax+1]
		push	edi
		mov	dword ptr [ecx+4], 0
		mov	eax, 1
		cmp	ebx, 72h	; switch 115 cases
		ja	loc_1000D3AF	; jumptable 1000D2AF default case
		movzx	ecx, ds:byte_1000D4A0[ebx]
		jmp	ds:off_1000D424[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000D2B6:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	[esi+34h], eax	; jumptable 1000D2AF case 0
		mov	edi, 0FFFFD03Ah
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2C3:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD03Bh	; jumptable 1000D2AF case 10
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2CD:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD010h	; jumptable 1000D2AF case 20
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2D7:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD05Bh	; jumptable 1000D2AF case 21
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2E1:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD05Ch	; jumptable 1000D2AF case 22
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2EB:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD03Ch	; jumptable 1000D2AF case 30
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2F5:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD03Dh	; jumptable 1000D2AF case 40
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D2FF:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD003h	; jumptable 1000D2AF case 41
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D309:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD011h	; jumptable 1000D2AF case 42
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D313:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD03Fh	; jumptable 1000D2AF case 43
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D31D:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD012h	; jumptable 1000D2AF case 44
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D327:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD013h	; jumptable 1000D2AF case 45
		jmp	loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D331:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD040h	; jumptable 1000D2AF case 46
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D338:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD03Eh	; jumptable 1000D2AF case 47
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D33F:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD083h	; jumptable 1000D2AF case 86
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D346:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD05Dh	; jumptable 1000D2AF case 48
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D34D:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD05Eh	; jumptable 1000D2AF case 49
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D354:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD05Fh	; jumptable 1000D2AF case 50
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D35B:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD060h	; jumptable 1000D2AF case 51
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D362:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD061h	; jumptable 1000D2AF case 60
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D369:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD062h	; jumptable 1000D2AF case 70
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D370:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD063h	; jumptable 1000D2AF case 71
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D377:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD064h	; jumptable 1000D2AF case 80
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D37E:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD065h	; jumptable 1000D2AF case 90
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D385:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD066h	; jumptable 1000D2AF case 100
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D38C:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD068h	; jumptable 1000D2AF case 110
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D393:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD069h	; jumptable 1000D2AF case 111
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D39A:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD06Ah	; jumptable 1000D2AF case 112
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D3A1:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD06Bh	; jumptable 1000D2AF case 113
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D3A8:				; CODE XREF: sub_1000D240+6Fj
					; DATA XREF: .text:off_1000D424o
		mov	edi, 0FFFFD06Ch	; jumptable 1000D2AF case 114
		jmp	short loc_1000D3B4
; ---------------------------------------------------------------------------

loc_1000D3AF:				; CODE XREF: sub_1000D240+62j
					; sub_1000D240+6Fj
					; DATA XREF: ...
		mov	edi, 0FFFFD039h	; jumptable 1000D2AF default case

loc_1000D3B4:				; CODE XREF: sub_1000D240+7Ej
					; sub_1000D240+88j ...
		cmp	edx, 2
		jnz	short loc_1000D3FB
		test	dword ptr [esi+14h], 400h
		jnz	short loc_1000D3D8
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_1000D3D8
		mov	edx, [esi+0F4h]
		push	edx
		call	eax
		add	esp, 4

loc_1000D3D8:				; CODE XREF: sub_1000D240+180j
					; sub_1000D240+18Aj
		cmp	dword ptr [esi+4C0h], 6
		jnz	short loc_1000D3EB
		cmp	ebx, 28h
		jnz	short loc_1000D3EB
		mov	edi, 0FFFFD002h

loc_1000D3EB:				; CODE XREF: sub_1000D240+19Fj
					; sub_1000D240+1A4j
		push	edi
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D3FB:				; CODE XREF: sub_1000D240+177j
		cmp	ebx, 29h
		jnz	short loc_1000D41B
		cmp	[esi+4C0h], eax
		jnz	short loc_1000D41B
		mov	dword ptr [esi+4C0h], 2
		call	sub_1000D170
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D41B:				; CODE XREF: sub_1000D240+1BEj
					; sub_1000D240+1C6j
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
sub_1000D240	endp

; ---------------------------------------------------------------------------
		align 4
off_1000D424	dd offset loc_1000D2B6,	offset loc_1000D2C3, offset loc_1000D2CD
					; DATA XREF: sub_1000D240+6Fr
		dd offset loc_1000D2D7,	offset loc_1000D2E1, offset loc_1000D2EB ; jump	table for switch statement
		dd offset loc_1000D2F5,	offset loc_1000D2FF, offset loc_1000D309
		dd offset loc_1000D313,	offset loc_1000D31D, offset loc_1000D327
		dd offset loc_1000D331,	offset loc_1000D338, offset loc_1000D346
		dd offset loc_1000D34D,	offset loc_1000D354, offset loc_1000D35B
		dd offset loc_1000D362,	offset loc_1000D369, offset loc_1000D370
		dd offset loc_1000D377,	offset loc_1000D33F, offset loc_1000D37E
		dd offset loc_1000D385,	offset loc_1000D38C, offset loc_1000D393
		dd offset loc_1000D39A,	offset loc_1000D3A1, offset loc_1000D3A8
		dd offset loc_1000D3AF
byte_1000D4A0	db	0,   1Eh,   1Eh,   1Eh ; DATA XREF: sub_1000D240+68r
		db    1Eh,   1Eh,   1Eh,   1Eh ; indirect table	for switch statement
		db    1Eh,   1Eh,     1,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db	2,     3,     4,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,     5,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db	6,     7,     8,     9
		db    0Ah,   0Bh,   0Ch,   0Dh
		db    0Eh,   0Fh,   10h,   11h
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    12h,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   13h,   14h
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    15h,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   16h,   1Eh
		db    1Eh,   1Eh,   17h,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    18h,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   1Eh,   1Eh
		db    1Eh,   1Eh,   19h,   1Ah
		db    1Bh,   1Ch,   1Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000D520(int Src)
sub_1000D520	proc near		; CODE XREF: sub_1000EFF0+36p
					; DATA XREF: sub_1000D520:loc_1000D5A1o

Src		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+Src]
		xor	ebx, ebx
		cmp	[esi+464h], ebx
		jnz	short loc_1000D546
		cmp	[esi+460h], ebx
		jz	short loc_1000D546
		cmp	[esi+45Ch], ebx
		jz	short loc_1000D546
		lea	ebp, [ebx+1]
		jmp	short loc_1000D56C
; ---------------------------------------------------------------------------

loc_1000D546:				; CODE XREF: sub_1000D520+Fj
					; sub_1000D520+17j ...
		xor	ebp, ebp
		cmp	dword ptr [esi+4C4h], 2
		jnz	short loc_1000D56C
		mov	eax, [esi+800h]
		cmp	eax, ebx
		jz	short loc_1000D56C
		push	1
		push	eax
		call	PK11_DestroyContext
		add	esp, 8
		mov	[esi+800h], ebx

loc_1000D56C:				; CODE XREF: sub_1000D520+24j
					; sub_1000D520+2Fj ...
		cmp	[esi+8C0h], ebx
		jz	short loc_1000D588
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D588:				; CODE XREF: sub_1000D520+52j
		cmp	[esi+8BCh], ebx
		jz	short loc_1000D5B4
		cmp	ebp, ebx
		jnz	short loc_1000D5A1
		cmp	[esi+464h], ebx
		jnz	short loc_1000D5A1
		cmp	[esi+24h], ebx
		jz	short loc_1000D5B4

loc_1000D5A1:				; CODE XREF: sub_1000D520+72j
					; sub_1000D520+7Aj
		mov	dword ptr [esi+8C0h], offset sub_1000D520
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D5B4:				; CODE XREF: sub_1000D520+6Ej
					; sub_1000D520+7Fj
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000D5CA
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000D5CA:				; CODE XREF: sub_1000D520+98j
		push	edi
		cmp	[esi+464h], ebx
		jz	short loc_1000D609
		push	3		; int
		push	0Bh		; char
		push	esi		; Src
		mov	[esi+464h], ebx
		call	sub_10008FF0
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	short loc_1000D603
		push	3		; Size
		lea	ecx, [esp+14h+Src]
		push	ecx		; Src
		push	esi		; int
		mov	word ptr [esp+1Ch+Src],	bx
		mov	byte ptr [esp+1Ch+Src+2], bl
		call	sub_10008E00
		add	esp, 0Ch

loc_1000D603:				; CODE XREF: sub_1000D520+C8j
		mov	edi, eax
		cmp	eax, ebx
		jmp	short loc_1000D616
; ---------------------------------------------------------------------------

loc_1000D609:				; CODE XREF: sub_1000D520+B1j
		cmp	ebp, ebx
		jz	short loc_1000D61C
		call	sub_1000C430
		mov	edi, eax
		cmp	edi, ebx

loc_1000D616:				; CODE XREF: sub_1000D520+E7j
		jnz	loc_1000D6B8

loc_1000D61C:				; CODE XREF: sub_1000D520+EBj
		call	sub_1000A3A0
		mov	edi, eax
		cmp	edi, ebx
		jnz	loc_1000D6B8
		cmp	ebp, ebx
		jz	short loc_1000D63A
		call	sub_1000A4D0
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_1000D6B8

loc_1000D63A:				; CODE XREF: sub_1000D520+10Dj
		mov	eax, esi
		call	sub_10008C10
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_1000D6B8
		mov	dword ptr [esi+28h], 1
		cmp	[esi+24h], ebx
		jnz	short loc_1000D6A8
		call	sub_1000C900
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_1000D6B8
		mov	eax, [esi+14h]
		test	eax, 400000h
		jz	short loc_1000D6A8
		cmp	[esi+8BCh], ebx
		jnz	short loc_1000D6A8
		test	eax, 10000h
		jnz	short loc_1000D687
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000D687:				; CODE XREF: sub_1000D520+155j
		call	sub_100065C0
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1000D6A4
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000D6A4:				; CODE XREF: sub_1000D520+172j
		cmp	edi, ebx
		jnz	short loc_1000D6B8

loc_1000D6A8:				; CODE XREF: sub_1000D520+131j
					; sub_1000D520+146j ...
		push	ebx
		push	esi
		call	sub_1000C9C0
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebx
		jz	short loc_1000D6D5

loc_1000D6B8:				; CODE XREF: sub_1000D520:loc_1000D616j
					; sub_1000D520+105j ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000D6CE
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000D6CE:				; CODE XREF: sub_1000D520+19Cj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D6D5:				; CODE XREF: sub_1000D520+196j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000D6EB
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000D6EB:				; CODE XREF: sub_1000D520+1B9j
		push	23h
		push	esi
		call	sub_10014AB0
		add	esp, 8
		neg	eax
		sbb	eax, eax
		and	eax, 8
		add	eax, 4
		pop	edi
		mov	[esi+4C0h], eax
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_1000D520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D710	proc near		; CODE XREF: sub_1000D820+EAEp
					; sub_1000E730+40Cp
		push	esi
		mov	esi, eax
		call	sub_1000B7E0
		test	eax, eax
		jnz	loc_1000D815
		call	sub_1000C430
		test	eax, eax
		jnz	loc_1000D815
		call	sub_1000C580
		test	eax, eax
		jnz	loc_1000D815
		push	edi
		mov	edi, [esi+808h]
		mov	[esi+840h], eax
		cmp	[edi+0Ch], eax
		jz	short loc_1000D7A4
		cmp	dword ptr [edi+4], 1
		jnz	short loc_1000D7A4
		mov	eax, [esi+304h]
		mov	ecx, [eax]
		push	ecx
		call	PK11_GetPrivateModulusLen
		add	esp, 4
		test	eax, eax
		jle	short loc_1000D773
		lea	edx, ds:0[eax*8]
		cmp	edx, [edi+10h]
		jle	short loc_1000D7B9

loc_1000D773:				; CODE XREF: sub_1000D710+55j
		cmp	dword ptr [esi+1F8h], 0
		jz	short loc_1000D792
		mov	dword ptr [esi+840h], 1
		call	sub_1000B9F0
		test	eax, eax
		jz	short loc_1000D7B9
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D792:				; CODE XREF: sub_1000D710+6Aj
		push	0FFFFD04Eh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D7A4:				; CODE XREF: sub_1000D710+3Aj
					; sub_1000D710+40j
		mov	edi, [edi]
		cmp	edi, 12h
		jz	short loc_1000D7B0
		cmp	edi, 10h
		jnz	short loc_1000D7B9

loc_1000D7B0:				; CODE XREF: sub_1000D710+99j
		call	sub_1000B9F0
		test	eax, eax
		jnz	short loc_1000D814

loc_1000D7B9:				; CODE XREF: sub_1000D710+61j
					; sub_1000D710+7Dj ...
		test	byte ptr [esi+14h], 4
		jz	short loc_1000D7CA
		mov	edi, esi
		call	sub_1000BCA0
		test	eax, eax
		jnz	short loc_1000D814

loc_1000D7CA:				; CODE XREF: sub_1000D710+ADj
		push	0		; int
		push	0Eh		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000D814
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_1000D7F0
		push	eax
		push	esi
		call	sub_10002F60
		add	esp, 8
		jmp	short loc_1000D7F9
; ---------------------------------------------------------------------------

loc_1000D7F0:				; CODE XREF: sub_1000D710+D2j
		xor	edx, edx
		mov	edi, esi
		call	sub_10008170

loc_1000D7F9:				; CODE XREF: sub_1000D710+DEj
		test	eax, eax
		jnz	short loc_1000D814
		mov	eax, [esi+14h]
		and	al, 4
		movzx	ecx, al
		neg	ecx
		sbb	ecx, ecx
		add	ecx, 2
		mov	[esi+4C0h], ecx
		xor	eax, eax

loc_1000D814:				; CODE XREF: sub_1000D710+A7j
					; sub_1000D710+B8j ...
		pop	edi

loc_1000D815:				; CODE XREF: sub_1000D710+Aj
					; sub_1000D710+17j ...
		pop	esi
		retn
sub_1000D710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D820	proc near		; CODE XREF: sub_1000F030+278p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
Src		= dword	ptr -20h
Size		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 48h
		push	ebx
		push	esi
		xor	esi, esi
		mov	ebx, 0FFFFD01Ch
		push	edi
		mov	[esp+54h+var_48], esi
		mov	[esp+54h+var_40], ebx
		mov	[esp+54h+var_3C], 2
		mov	[esp+54h+Src], esi
		mov	[esp+54h+Size],	esi
		mov	[esp+54h+var_2C], esi
		mov	[esp+54h+var_28], esi
		mov	[esp+54h+var_14], esi
		mov	[esp+54h+var_10], esi
		call	sub_1001DD10
		add	esp, 4
		cmp	eax, esi
		jnz	loc_1000E306
		push	ebp
		mov	ebp, 1
		cmp	[edi+2F38h], ebp
		jnz	short loc_1000D87F
		mov	[edi+1E0h], esi
		mov	[edi+1E4h], esi

loc_1000D87F:				; CODE XREF: sub_1000D820+51j
		push	9Ch		; Size
		lea	eax, [edi+2E9Ch]
		push	esi		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [edi+4C0h]
		add	esp, 0Ch
		mov	[edi+2E98h], esi
		cmp	eax, esi
		jz	short loc_1000D8BB
		cmp	eax, 0Dh
		jz	short loc_1000D8C0
		mov	[esp+54h+var_44], 0Ah
		mov	ebx, 0FFFFD02Ah
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000D8BB:				; CODE XREF: sub_1000D820+82j
		cmp	eax, 0Dh
		jnz	short loc_1000D8DF

loc_1000D8C0:				; CODE XREF: sub_1000D820+87j
		test	dword ptr [edi+14h], 180000h
		jnz	short loc_1000D8DF
		mov	[esp+54h+var_44], 64h
		mov	[esp+54h+var_3C], ebp
		mov	ebx, 0FFFFD070h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000D8DF:				; CODE XREF: sub_1000D820+9Ej
					; sub_1000D820+A7j
		cmp	[edi+2F38h], ebp
		jnz	short loc_1000D8F0
		push	edi
		call	sub_10002470
		add	esp, 4

loc_1000D8F0:				; CODE XREF: sub_1000D820+C5j
		lea	ecx, [esp+54h+arg_4]
		push	ecx
		lea	edx, [esp+58h+arg_0]
		push	edx
		push	2
		push	edi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, esi
		jl	loc_1000E2F9
		cmp	[edi+2F38h], ebp
		jnz	short loc_1000D927
		push	eax
		call	sub_100021B0
		movzx	esi, ax
		add	esp, 4
		mov	[edi+46h], si
		jmp	short loc_1000D92E
; ---------------------------------------------------------------------------

loc_1000D927:				; CODE XREF: sub_1000D820+F3j
		movzx	esi, ax
		mov	[edi+46h], ax

loc_1000D92E:				; CODE XREF: sub_1000D820+105j
		movzx	eax, word ptr [edi+18h]
		test	ax, ax
		jnz	short loc_1000D93E
		push	0FFFFD014h
		jmp	short loc_1000D977
; ---------------------------------------------------------------------------

loc_1000D93E:				; CODE XREF: sub_1000D820+115j
		cmp	si, ax
		jb	short loc_1000D972
		movzx	eax, word ptr [edi+1Ah]
		cmp	si, ax
		jnb	short loc_1000D94F
		movzx	eax, si

loc_1000D94F:				; CODE XREF: sub_1000D820+12Aj
		mov	esi, edi
		mov	[edi+44h], ax
		call	sub_10008500
		test	eax, eax
		jz	short loc_1000D99D
		mov	[esp+54h+var_44], 50h

loc_1000D966:				; CODE XREF: sub_1000D820+5BCj
		call	PORT_GetError_Util
		mov	ebx, eax
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000D972:				; CODE XREF: sub_1000D820+121j
		push	0FFFFD002h

loc_1000D977:				; CODE XREF: sub_1000D820+11Cj
		call	PORT_SetError_Util
		mov	eax, 300h
		add	esp, 4
		cmp	ax, si
		sbb	eax, eax
		and	eax, 1Eh
		add	eax, 28h
		mov	[esp+54h+var_44], eax
		mov	ebx, 0FFFFD002h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000D99D:				; CODE XREF: sub_1000D820+13Cj
		lea	ecx, [esp+54h+arg_4]
		push	ecx		; int
		lea	edx, [esp+58h+arg_0]
		push	edx		; int
		push	20h		; Size
		lea	eax, [edi+4A0h]
		push	eax		; Dst
		push	edi		; int
		call	sub_10009150
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000E2F9
		lea	ecx, [esp+54h+arg_4]
		push	ecx
		lea	edx, [esp+58h+arg_0]
		push	edx
		push	1
		lea	eax, [esp+60h+var_24]
		push	eax
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000E2F9
		cmp	[edi+2F38h], ebp
		jnz	short loc_1000DA0D
		lea	ecx, [esp+54h+arg_4]
		push	ecx
		lea	edx, [esp+58h+arg_0]
		push	edx
		push	1
		lea	eax, [esp+60h+var_C]
		push	eax
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000E2F9

loc_1000DA0D:				; CODE XREF: sub_1000D820+1C9j
		lea	ecx, [esp+54h+arg_4]
		push	ecx
		lea	edx, [esp+58h+arg_0]
		push	edx
		push	2
		lea	eax, [esp+60h+var_30]
		push	eax
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000E2F9
		mov	cx, [edi+1Ah]
		mov	edx, [esp+54h+var_28]
		cmp	cx, [edi+46h]
		jbe	short loc_1000DA76
		cmp	edx, 1
		jbe	short loc_1000DA76
		mov	eax, [esp+54h+var_2C]
		mov	ecx, ebp
		inc	eax
		lea	esp, [esp+0]

loc_1000DA50:				; CODE XREF: sub_1000D820+254j
		movzx	esi, byte ptr [eax-1]
		movzx	ebp, byte ptr [eax]
		shl	si, 8
		or	si, bp
		mov	ebp, 5600h
		cmp	si, bp
		jz	loc_1000DAFA
		add	ecx, 2
		add	eax, 2
		cmp	ecx, edx
		jb	short loc_1000DA50

loc_1000DA76:				; CODE XREF: sub_1000D820+21Bj
					; sub_1000D820+220j
		lea	edx, [esp+54h+arg_4]
		push	edx
		lea	eax, [esp+58h+arg_0]
		push	eax
		push	1
		lea	ecx, [esp+60h+var_18]
		push	ecx
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000E2F9
		mov	esi, [esp+54h+var_10]
		mov	ebp, [esp+54h+var_14]
		mov	edx, 304h
		cmp	[edi+44h], dx
		jb	short loc_1000DABD
		cmp	esi, 1
		jnz	loc_1000E2F9
		cmp	[ebp+0], al
		jnz	loc_1000E2F9

loc_1000DABD:				; CODE XREF: sub_1000D820+289j
		cmp	[esp+54h+arg_4], 0
		mov	[esp+54h+var_44], 28h
		jz	short loc_1000DB27
		lea	eax, [esp+54h+arg_4]
		push	eax
		lea	ecx, [esp+58h+arg_0]
		push	ecx
		push	2
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_1000E2F9
		cmp	eax, [esp+54h+arg_4]
		jz	short loc_1000DB0C
		push	edi
		call	sub_10008BD0
		jmp	loc_1000E2F6
; ---------------------------------------------------------------------------

loc_1000DAFA:				; CODE XREF: sub_1000D820+246j
		mov	[esp+54h+var_44], 56h
		mov	ebx, 0FFFFD083h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000DB0C:				; CODE XREF: sub_1000D820+2CDj
		lea	edx, [esp+54h+arg_4]
		push	edx
		lea	eax, [esp+58h+arg_0]
		push	eax
		push	edi
		call	sub_10016190
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000E2F9

loc_1000DB27:				; CODE XREF: sub_1000D820+2AAj
		push	0FF01h
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000DB99
		mov	ecx, 1
		cmp	[esp+54h+var_28], ecx
		jbe	short loc_1000DB99
		mov	eax, [esp+54h+var_2C]
		inc	eax
		lea	esp, [esp+0]

loc_1000DB50:				; CODE XREF: sub_1000D820+352j
		movzx	edx, byte ptr [eax-1]
		movzx	ebx, byte ptr [eax]
		shl	dx, 8
		or	dx, bx
		mov	ebx, 0FFh
		cmp	dx, bx
		jz	short loc_1000DB76
		add	ecx, 2
		add	eax, 2
		cmp	ecx, [esp+54h+var_28]
		jb	short loc_1000DB50
		jmp	short loc_1000DB99
; ---------------------------------------------------------------------------

loc_1000DB76:				; CODE XREF: sub_1000D820+346j
		lea	eax, [esp+54h+var_34]
		push	eax
		lea	ecx, [esp+58h+var_38]
		push	ecx
		push	edi
		mov	[esp+60h+var_38], offset dword_1002B010
		mov	[esp+60h+var_34], 5
		call	sub_10016190
		add	esp, 0Ch

loc_1000DB99:				; CODE XREF: sub_1000D820+317j
					; sub_1000D820+322j ...
		cmp	dword ptr [edi+24h], 0
		jz	short loc_1000DBDE
		mov	eax, [edi+14h]
		shr	eax, 13h
		and	eax, 3
		cmp	eax, 2
		jz	short loc_1000DBB2
		cmp	eax, 3
		jnz	short loc_1000DBDE

loc_1000DBB2:				; CODE XREF: sub_1000D820+38Bj
		push	0FF01h
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000DBDE
		mov	[esp+54h+var_44], 64h
		mov	[esp+54h+var_3C], 1
		mov	ebx, 0FFFFD070h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000DBDE:				; CODE XREF: sub_1000D820+37Dj
					; sub_1000D820+390j ...
		test	dword ptr [edi+14h], 200000h
		jnz	short loc_1000DBF3
		cmp	dword ptr [edi+24h], 0
		jz	short loc_1000DC17
		cmp	dword ptr [edi+40h], 0
		jz	short loc_1000DC17

loc_1000DBF3:				; CODE XREF: sub_1000D820+3C5j
		push	0FF01h
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000DC17
		mov	[esp+54h+var_44], 28h
		mov	ebx, 0FFFFD071h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000DC17:				; CODE XREF: sub_1000D820+3CBj
					; sub_1000D820+3D1j ...
		push	23h
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	loc_1000DCAA
		cmp	dword ptr [edi+2F28h], 0
		jnz	short loc_1000DCAA
		cmp	dword ptr [edi+2E98h], 0
		jz	short loc_1000DC7E
		mov	ebx, [esp+54h+Size]
		mov	eax, [edi+0F4h]
		lea	edx, [ebx-1]
		mov	[esp+54h+var_48], eax
		cmp	edx, 1Fh
		ja	short loc_1000DC70
		mov	ecx, [esp+54h+Src]
		push	ebx		; Size
		mov	[eax+54h], bl
		push	ecx		; Src
		add	eax, 55h
		push	eax		; Dst
		call	memcpy
		mov	edx, [esp+60h+var_48]
		add	esp, 0Ch
		mov	[edx+54h], bl
		jmp	short loc_1000DC74
; ---------------------------------------------------------------------------

loc_1000DC70:				; CODE XREF: sub_1000D820+430j
		mov	byte ptr [eax+54h], 0

loc_1000DC74:				; CODE XREF: sub_1000D820+44Ej
		mov	dword ptr [edi+0F4h], 0

loc_1000DC7E:				; CODE XREF: sub_1000D820+41Aj
					; sub_1000D820+490j ...
		mov	ebx, [esp+54h+var_48]

loc_1000DC82:				; CODE XREF: sub_1000D820+4C3j
		push	23h
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000DCFD
		test	ebx, ebx
		jnz	short loc_1000DD01
		push	offset sub_10014E90
		push	23h
		push	edi
		call	sub_100162A0
		add	esp, 0Ch
		jmp	loc_1000DD56
; ---------------------------------------------------------------------------

loc_1000DCAA:				; CODE XREF: sub_1000D820+404j
					; sub_1000D820+411j
		mov	ecx, [esp+54h+Size]
		test	ecx, ecx
		jz	short loc_1000DC7E
		test	dword ptr [edi+14h], 400h
		jnz	short loc_1000DC7E
		mov	eax, dword_10037EA8
		test	eax, eax
		jz	short loc_1000DCE5
		mov	edx, [edi+260h]
		push	edx
		push	ecx
		mov	ecx, [esp+5Ch+Src]
		push	ecx
		lea	edx, [edi+0E0h]
		push	edx
		call	eax ; dword_10037EA8
		mov	ebx, eax
		add	esp, 10h
		mov	[esp+54h+var_48], ebx
		jmp	short loc_1000DC82
; ---------------------------------------------------------------------------

loc_1000DCE5:				; CODE XREF: sub_1000D820+4A2j
		mov	ebx, 0FFFFD067h
		push	ebx
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000DCFD:				; CODE XREF: sub_1000D820+46Fj
		test	ebx, ebx
		jz	short loc_1000DD56

loc_1000DD01:				; CODE XREF: sub_1000D820+473j
		cmp	dword ptr [ebx+10h], 0
		jnz	short loc_1000DD56
		mov	eax, [edi+14h]
		test	al, 4
		jz	short loc_1000DD56
		shr	eax, 3
		and	eax, 3
		cmp	eax, 1
		jz	short loc_1000DD29
		cmp	eax, 3
		jz	short loc_1000DD29
		cmp	eax, 2
		jnz	short loc_1000DD56
		cmp	dword ptr [edi+24h], 0
		jnz	short loc_1000DD56

loc_1000DD29:				; CODE XREF: sub_1000D820+4F7j
					; sub_1000D820+4FCj
		push	offset dword_100374F0
		call	ds:__imp_PR_AtomicIncrement
		mov	eax, [edi+88h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1000DD47
		push	ebx
		call	eax
		add	esp, 4

loc_1000DD47:				; CODE XREF: sub_1000D820+51Fj
		push	ebx
		call	sub_10017FD0
		add	esp, 4
		xor	ebx, ebx
		mov	[esp+54h+var_48], ebx

loc_1000DD56:				; CODE XREF: sub_1000D820+485j
					; sub_1000D820+4DFj ...
		push	edi
		call	sub_10021740
		add	esp, 4
		cmp	dword ptr [edi+2F38h], 1
		jnz	short loc_1000DD71
		push	edi
		call	sub_100021F0
		add	esp, 4

loc_1000DD71:				; CODE XREF: sub_1000D820+546j
		test	ebx, ebx
		jz	short loc_1000DDD1
		mov	ecx, [ebx+78h]
		mov	eax, ecx
		sub	eax, 0
		jz	short loc_1000DD98
		dec	eax
		jnz	short loc_1000DDD1
		mov	eax, 304h
		cmp	[edi+44h], ax
		jnb	short loc_1000DDD1
		mov	eax, [edi+14h]
		shr	eax, 12h
		and	eax, 1
		jz	short loc_1000DDD1

loc_1000DD98:				; CODE XREF: sub_1000D820+55Dj
		xor	eax, eax
		test	esi, esi
		jz	short loc_1000DDAD
		mov	edi, edi

loc_1000DDA0:				; CODE XREF: sub_1000D820+58Bj
		movzx	edx, byte ptr [eax+ebp]
		cmp	edx, ecx
		jz	short loc_1000DDAD
		inc	eax
		cmp	eax, esi
		jb	short loc_1000DDA0

loc_1000DDAD:				; CODE XREF: sub_1000D820+57Cj
					; sub_1000D820+586j
		cmp	eax, esi
		jz	short loc_1000DDD1
		movzx	edx, word ptr [ebx+76h]
		lea	ecx, [edi+350h]
		mov	eax, 3Dh

loc_1000DDC0:				; CODE XREF: sub_1000D820+5AFj
		cmp	[ecx], dx
		jz	loc_1000DE92
		dec	eax
		add	ecx, 4
		test	eax, eax
		jg	short loc_1000DDC0

loc_1000DDD1:				; CODE XREF: sub_1000D820+553j
					; sub_1000D820+560j ...
		push	edi
		call	sub_10003200
		add	esp, 4
		test	eax, eax
		jle	loc_1000D966
		movzx	eax, word ptr [edi+44h]
		mov	[esp+54h+var_34], 0
		mov	word ptr [esp+54h+var_38+2], ax
		lea	esi, [edi+352h]
		lea	esp, [esp+0]

loc_1000DE00:				; CODE XREF: sub_1000D820+662j
		movzx	eax, word ptr [edi+44h]
		mov	ecx, [edi+468h]
		mov	word ptr [esp+54h+var_38], ax
		test	ecx, ecx
		jz	short loc_1000DE73
		mov	al, [esi+1]
		test	al, 1
		jz	short loc_1000DE73
		test	al, 2
		jz	short loc_1000DE73
		mov	al, [esi]
		test	al, al
		jz	short loc_1000DE73
		movzx	edx, al
		cmp	edx, ecx
		jg	short loc_1000DE73
		movzx	ebx, word ptr [esi-2]
		lea	ecx, [esp+54h+var_38]
		mov	eax, ebx
		call	sub_10003040
		test	eax, eax
		jz	short loc_1000DE73
		cmp	[esp+54h+var_28], 1
		jbe	short loc_1000DE73
		mov	eax, [esp+54h+var_2C]
		mov	ecx, 1
		inc	eax
		nop

loc_1000DE50:				; CODE XREF: sub_1000D820+651j
		movzx	edx, byte ptr [eax-1]
		movzx	ebp, byte ptr [eax]
		shl	dx, 8
		or	dx, bp
		cmp	dx, bx
		jz	loc_1000DF04
		add	ecx, 2
		add	eax, 2
		cmp	ecx, [esp+54h+var_28]
		jb	short loc_1000DE50

loc_1000DE73:				; CODE XREF: sub_1000D820+5F1j
					; sub_1000D820+5F8j ...
		mov	eax, [esp+54h+var_34]
		inc	eax
		add	esi, 4
		mov	[esp+54h+var_34], eax
		cmp	eax, 3Dh
		jl	loc_1000DE00
		mov	ebx, 0FFFFD002h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000DE92:				; CODE XREF: sub_1000D820+5A3j
		test	eax, eax
		jle	loc_1000DDD1
		test	byte ptr [ecx+3], 1
		jz	loc_1000DDD1
		cmp	[esp+54h+var_28], 1
		jbe	loc_1000DDD1
		mov	eax, [esp+54h+var_2C]
		movzx	edx, word ptr [ecx]
		mov	ecx, 1
		inc	eax
		lea	esp, [esp+0]

loc_1000DEC0:				; CODE XREF: sub_1000D820+6BDj
		movzx	esi, byte ptr [eax-1]
		movzx	ebp, byte ptr [eax]
		shl	si, 8
		or	si, bp
		cmp	si, dx
		jz	short loc_1000DEE4
		add	ecx, 2
		add	eax, 2
		cmp	ecx, [esp+54h+var_28]
		jb	short loc_1000DEC0
		jmp	loc_1000DDD1
; ---------------------------------------------------------------------------

loc_1000DEE4:				; CODE XREF: sub_1000D820+6B1j
		mov	[edi+80Ch], dx
		call	sub_100031C0
		mov	[edi+810h], eax
		mov	eax, [ebx+78h]
		mov	[edi+814h], eax
		jmp	loc_1000DFAF
; ---------------------------------------------------------------------------

loc_1000DF04:				; CODE XREF: sub_1000D820+641j
		movzx	eax, word ptr [esi-2]
		mov	[edi+80Ch], ax
		mov	edx, eax
		xor	ecx, ecx
		mov	eax, offset dword_1002AA18

loc_1000DF18:				; CODE XREF: sub_1000D820+706j
		cmp	[eax], dx
		jz	short loc_1000DF93
		add	eax, 10h
		inc	ecx
		cmp	eax, offset dword_1002ADF8
		jl	short loc_1000DF18
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		xor	ecx, ecx

loc_1000DF37:				; CODE XREF: sub_1000D820+77Cj
		mov	ebx, [esp+54h+var_10]
		xor	edx, edx
		mov	[edi+810h], ecx
		test	ebx, ebx
		jz	short loc_1000DF89
		mov	esi, [esp+54h+var_14]
		jmp	short loc_1000DF50
; ---------------------------------------------------------------------------
		align 10h

loc_1000DF50:				; CODE XREF: sub_1000D820+72Bj
					; sub_1000D820+767j
		mov	cl, [edx+esi]
		movzx	eax, cl
		sub	eax, 0
		jz	short loc_1000DF74
		dec	eax
		jnz	short loc_1000DF84
		mov	eax, 304h
		cmp	[edi+44h], ax
		jnb	short loc_1000DF84
		mov	eax, [edi+14h]
		shr	eax, 12h
		and	eax, 1
		jz	short loc_1000DF84

loc_1000DF74:				; CODE XREF: sub_1000D820+739j
		xor	eax, eax

loc_1000DF76:				; CODE XREF: sub_1000D820+762j
		cmp	cl, ds:byte_1002A5A8[eax]
		jz	short loc_1000DF9E
		inc	eax
		cmp	eax, 2
		jl	short loc_1000DF76

loc_1000DF84:				; CODE XREF: sub_1000D820+73Cj
					; sub_1000D820+747j ...
		inc	edx
		cmp	edx, ebx
		jb	short loc_1000DF50

loc_1000DF89:				; CODE XREF: sub_1000D820+725j
		mov	ebx, 0FFFFD055h
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000DF93:				; CODE XREF: sub_1000D820+6FBj
		shl	ecx, 4
		add	ecx, offset dword_1002AA18
		jmp	short loc_1000DF37
; ---------------------------------------------------------------------------

loc_1000DF9E:				; CODE XREF: sub_1000D820+75Cj
		movzx	ecx, ds:byte_1002A5A8[eax]
		mov	ebx, [esp+54h+var_48]
		mov	[edi+814h], ecx

loc_1000DFAF:				; CODE XREF: sub_1000D820+6DFj
		mov	dword ptr [edi+48h], offset sub_10007FE0
		test	ebx, ebx
		jz	loc_1000E3D3
		mov	dx, [ebx+3Ah]
		cmp	dx, [edi+44h]
		jnz	loc_1000E3A4
		mov	eax, [esp+54h+var_48]
		mov	cx, [eax+76h]
		cmp	cx, [edi+80Ch]
		jnz	loc_1000E3A4
		mov	edx, eax
		mov	eax, [edx+78h]
		cmp	eax, [edi+814h]
		jnz	loc_1000E3A4
		mov	ecx, [edi+0F4h]
		test	ecx, ecx
		jz	short loc_1000E02F
		mov	eax, [edi+88h]
		test	eax, eax
		jz	short loc_1000E00C
		push	ecx
		call	eax
		add	esp, 4

loc_1000E00C:				; CODE XREF: sub_1000D820+7E4j
		mov	eax, [edi+0F4h]
		mov	ebp, [esp+54h+var_48]
		cmp	eax, ebp
		jz	short loc_1000E023
		push	eax
		call	sub_10017FD0
		add	esp, 4

loc_1000E023:				; CODE XREF: sub_1000D820+7F8j
		mov	dword ptr [edi+0F4h], 0
		jmp	short loc_1000E033
; ---------------------------------------------------------------------------

loc_1000E02F:				; CODE XREF: sub_1000D820+7DAj
		mov	ebp, [esp+54h+var_48]

loc_1000E033:				; CODE XREF: sub_1000D820+80Dj
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E048
		mov	ecx, [edi+25Ch]
		push	ecx
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1000E048:				; CODE XREF: sub_1000D820+817j
		cmp	byte ptr [ebp+0B2h], 0
		mov	esi, [edi+454h]
		jz	loc_1000E0F1
		xor	ebp, ebp
		test	dword ptr [edi+14h], 8000h
		jnz	loc_1000E38F
		mov	eax, [esp+54h+var_48]
		mov	edx, [eax+0B8h]
		mov	ecx, [edi+22Ch]
		mov	ebx, [eax+0B4h]
		push	edx
		push	edi
		xor	edx, edx
		call	sub_10006050
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1000E38F
		mov	eax, 300h
		cmp	[edi+44h], ax
		jbe	short loc_1000E0A6
		mov	ebp, 2800h

loc_1000E0A6:				; CODE XREF: sub_1000D820+87Fj
		mov	eax, [esp+54h+var_48]
		movzx	edx, word ptr [eax+0B0h]
		push	ebp
		push	30h
		push	10Ch
		lea	ecx, [eax+80h]
		push	371h
		mov	[esp+64h+var_2C], ecx
		lea	ecx, [esp+64h+var_30]
		push	ecx
		mov	[esp+68h+var_28], edx
		mov	edx, [eax+0B4h]
		push	0
		push	edx
		push	ebx
		call	PK11_UnwrapSymKeyWithFlags
		push	ebx
		mov	[esi+44h], eax
		call	PK11_FreeSymKey
		add	esp, 24h
		jmp	loc_1000E173
; ---------------------------------------------------------------------------

loc_1000E0F1:				; CODE XREF: sub_1000D820+835j
		test	dword ptr [edi+14h], 8000h
		jz	short loc_1000E132
		movzx	ecx, word ptr [ebp+0B0h]
		lea	eax, [ebp+80h]
		push	ecx		; Size
		push	eax		; Src
		lea	ebx, [esi+11CCh]
		push	ebx		; Dst
		mov	[esp+60h+var_2C], eax
		mov	[esp+60h+var_28], ecx
		call	memcpy
		mov	[esi+1134h], ebx
		mov	eax, [esp+60h+var_28]
		add	esp, 0Ch
		mov	[esi+1138h], eax
		jmp	short loc_1000E181
; ---------------------------------------------------------------------------

loc_1000E132:				; CODE XREF: sub_1000D820+8D8j
		movzx	edx, word ptr [ebp+0B0h]
		lea	ecx, [ebp+80h]
		mov	[esp+54h+var_2C], ecx
		mov	[esp+54h+var_28], edx
		call	PK11_GetInternalSlot
		push	0
		mov	ebx, eax
		lea	eax, [esp+58h+var_30]
		push	eax
		push	104h
		push	4
		push	371h
		push	ebx
		call	PK11_ImportSymKey
		push	ebx
		mov	[esi+44h], eax
		call	PK11_FreeSlot
		add	esp, 1Ch

loc_1000E173:				; CODE XREF: sub_1000D820+8CCj
		cmp	dword ptr [esi+44h], 0
		jz	loc_1000E38F
		mov	ebp, [esp+54h+var_48]

loc_1000E181:				; CODE XREF: sub_1000D820+910j
		mov	[edi+0F4h], ebp
		mov	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_1000E19A
		push	eax
		call	CERT_DupCertificate
		add	esp, 4
		mov	[edi+6Ch], eax

loc_1000E19A:				; CODE XREF: sub_1000D820+96Cj
		mov	esi, ds:__imp_PR_AtomicIncrement
		push	offset dword_100374E8
		call	esi ; __imp_PR_AtomicIncrement
		add	esp, 4
		cmp	dword ptr [edi+2E98h], 0
		jz	short loc_1000E1BD
		push	offset dword_100374FC
		call	esi ; __imp_PR_AtomicIncrement
		add	esp, 4

loc_1000E1BD:				; CODE XREF: sub_1000D820+991j
		mov	dword ptr [edi+83Ch], 1
		mov	ecx, [ebp+44h]
		mov	[edi+74h], ecx
		mov	edx, [ebp+48h]
		mov	[edi+78h], edx
		mov	eax, [ebp+4Ch]
		mov	[edi+7Ch], eax
		mov	ecx, [ebp+50h]
		mov	[edi+80h], ecx
		mov	edx, [ebp+4Ch]
		add	edx, edx
		mov	eax, [edi+edx*8+2ECh]
		push	eax
		call	CERT_DupCertificate
		mov	ecx, 300h
		add	esp, 4
		mov	[edi+68h], eax
		cmp	[ebp+3Ah], cx
		jbe	short loc_1000E277
		cmp	dword ptr [ebp+0E8h], 0
		jz	short loc_1000E277
		cmp	dword ptr [ebp+0E4h], 0
		jz	short loc_1000E277
		mov	esi, [edi+454h]
		add	esi, 1204h
		cmp	dword ptr [esi+4], 0
		lea	ebx, [ebp+0E0h]
		jz	short loc_1000E23A
		push	0
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1000E23A:				; CODE XREF: sub_1000D820+A0Dj
		push	ebx
		push	esi
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000E277
		call	PORT_GetError_Util
		test	byte ptr [edi+16h], 1
		mov	ebx, eax
		mov	[esp+54h+var_44], 50h
		jnz	loc_1000E6FC
		mov	ecx, [edi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4
		jmp	loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000E277:				; CODE XREF: sub_1000D820+9E3j
					; sub_1000D820+9ECj ...
		xor	esi, esi
		push	esi
		push	edi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000E2A6
		mov	eax, [edi+2F30h]
		cmp	eax, esi
		jz	short loc_1000E2A6
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[edi+2F30h], esi
		mov	[edi+2F34h], esi

loc_1000E2A6:				; CODE XREF: sub_1000D820+A65j
					; sub_1000D820+A6Fj
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E2BC
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000E2BC:				; CODE XREF: sub_1000D820+A8Aj
		mov	eax, edi
		call	sub_1000B7E0
		test	eax, eax
		jz	short loc_1000E30C
		call	PORT_GetError_Util
		test	byte ptr [edi+16h], 1
		mov	ebx, eax
		jnz	short loc_1000E2F9
		mov	ecx, [edi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E2E3:				; CODE XREF: sub_1000D820+B16j
					; sub_1000D820+B2Aj ...
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E2F9
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_ExitMonitor

loc_1000E2F6:				; CODE XREF: sub_1000D820+2D5j
		add	esp, 4

loc_1000E2F9:				; CODE XREF: sub_1000D820+E7j
					; sub_1000D820+19Bj ...
		push	ebx
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ebp

loc_1000E306:				; CODE XREF: sub_1000D820+3Fj
		pop	esi
		pop	ebx
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000E30C:				; CODE XREF: sub_1000D820+AA5j
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E321
		mov	eax, [edi+25Ch]
		push	eax
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E321:				; CODE XREF: sub_1000D820+AF0j
		push	esi
		push	edi
		call	sub_100087C0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000E338
		call	PORT_GetError_Util
		mov	ebx, eax
		jmp	short loc_1000E2E3
; ---------------------------------------------------------------------------

loc_1000E338:				; CODE XREF: sub_1000D820+B0Dj
		mov	eax, edi
		call	sub_10008C10
		test	eax, eax
		jz	short loc_1000E34C
		call	PORT_GetError_Util
		mov	ebx, eax
		jmp	short loc_1000E2E3
; ---------------------------------------------------------------------------

loc_1000E34C:				; CODE XREF: sub_1000D820+B21j
		push	esi
		push	edi
		call	sub_1000C9C0
		add	esp, 8
		mov	dword ptr [edi+4C0h], 4
		cmp	eax, esi
		jz	short loc_1000E370
		call	PORT_GetError_Util
		mov	ebx, eax
		jmp	loc_1000E2E3
; ---------------------------------------------------------------------------

loc_1000E370:				; CODE XREF: sub_1000D820+B42j
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E386
		mov	ecx, [edi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000E386:				; CODE XREF: sub_1000D820+B54j
					; sub_1000D820+ECDj
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000E38F:				; CODE XREF: sub_1000D820+844j
					; sub_1000D820+870j ...
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E3A4
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E3A4:				; CODE XREF: sub_1000D820+7A6j
					; sub_1000D820+7BBj ...
		push	offset dword_100374F0
		call	ds:__imp_PR_AtomicIncrement
		mov	eax, [edi+88h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1000E3C6
		mov	ecx, [esp+54h+var_48]
		push	ecx
		call	eax
		add	esp, 4

loc_1000E3C6:				; CODE XREF: sub_1000D820+B9Aj
		mov	edx, [esp+54h+var_48]
		push	edx
		call	sub_10017FD0
		add	esp, 4

loc_1000E3D3:				; CODE XREF: sub_1000D820+798j
		push	offset dword_100374EC
		call	ds:__imp_PR_AtomicIncrement
		push	0
		push	edi
		call	sub_10014AB0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_1000E645
		mov	ecx, [edi+20Ch]
		xor	ebx, ebx
		test	ecx, ecx
		jz	loc_1000E512
		mov	eax, [edi+2F34h]
		mov	ebx, 0FFFFFFFEh
		test	eax, eax
		jz	short loc_1000E42E
		mov	edx, [edi+210h]
		push	edx
		mov	edx, [edi]
		push	eax
		mov	eax, [edi+2F30h]
		push	eax
		push	edx
		call	ecx
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, 0FFFFFFFEh
		jg	short loc_1000E443

loc_1000E42E:				; CODE XREF: sub_1000D820+BEEj
		mov	[esp+54h+var_40], 0FFFFD06Ah
		mov	[esp+54h+var_44], 70h
		jmp	loc_1000E512
; ---------------------------------------------------------------------------

loc_1000E443:				; CODE XREF: sub_1000D820+C0Cj
		cmp	ebx, 0FFFFFFFFh
		jnz	loc_1000E569
		test	byte ptr [edi+16h], 1
		mov	[esp+54h+var_34], 0
		jnz	short loc_1000E469
		mov	eax, [edi+25Ch]
		push	eax
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1000E469:				; CODE XREF: sub_1000D820+C38j
		mov	ebp, [edi+454h]
		mov	esi, [edi+450h]
		add	ebp, 1204h
		add	esi, 1204h
		cmp	dword ptr [edi+24h], 0
		jz	short loc_1000E4B9
		mov	eax, ebp
		call	sub_10006670
		test	eax, eax
		jz	short loc_1000E4B9
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E4A7
		mov	ecx, [edi+25Ch]
		push	ecx

loc_1000E49F:				; CODE XREF: sub_1000D820+DA0j
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E4A7:				; CODE XREF: sub_1000D820+C76j
					; sub_1000D820+D93j
		mov	[esp+54h+var_40], 0FFFFD06Ah
		mov	[esp+54h+var_44], 28h
		jmp	short loc_1000E50D
; ---------------------------------------------------------------------------

loc_1000E4B9:				; CODE XREF: sub_1000D820+C65j
					; sub_1000D820+C70j
		cmp	dword ptr [ebp+4], 0
		jz	short loc_1000E4CA
		push	0
		push	ebp
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1000E4CA:				; CODE XREF: sub_1000D820+C9Dj
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000E4E0
		push	esi
		push	ebp
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		mov	esi, eax
		jmp	short loc_1000E4E4
; ---------------------------------------------------------------------------

loc_1000E4E0:				; CODE XREF: sub_1000D820+CAEj
		mov	esi, [esp+54h+var_34]

loc_1000E4E4:				; CODE XREF: sub_1000D820+CBEj
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E4F9
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E4F9:				; CODE XREF: sub_1000D820+CC8j
		test	esi, esi
		jz	short loc_1000E512

loc_1000E4FD:				; CODE XREF: sub_1000D820+D4Fj
					; sub_1000D820+DE7j
		mov	[esp+54h+var_40], 0FFFFD064h
		mov	[esp+54h+var_44], 50h

loc_1000E50D:				; CODE XREF: sub_1000D820+C97j
					; sub_1000D820+E0Bj
		mov	ebx, 0FFFFFFFEh

loc_1000E512:				; CODE XREF: sub_1000D820+BDBj
					; sub_1000D820+C1Ej ...
		mov	eax, [edi+2F30h]
		xor	esi, esi
		cmp	eax, esi
		jz	short loc_1000E533
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[edi+2F30h], esi
		mov	[edi+2F34h], esi

loc_1000E533:				; CODE XREF: sub_1000D820+CFCj
		cmp	ebx, 0FFFFFFFEh
		jle	loc_1000E6F8

loc_1000E53C:				; CODE XREF: sub_1000D820+E29j
					; sub_1000D820+E71j
		push	1
		push	edi
		call	sub_100066A0
		add	esp, 8
		test	eax, eax
		jnz	loc_1000E6A6

loc_1000E54F:				; CODE XREF: sub_1000D820+ED3j
		call	PORT_GetError_Util
		mov	ebx, eax
		push	ebx
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000E569:				; CODE XREF: sub_1000D820+C26j
		cmp	ebx, [edi+2F34h]
		jnb	short loc_1000E4FD
		test	byte ptr [edi+16h], 1
		mov	ecx, [edi+2F30h]
		lea	eax, [ebx+ebx*2]
		lea	ebp, [ecx+eax*4]
		jnz	short loc_1000E592
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1000E592:				; CODE XREF: sub_1000D820+D61j
		cmp	dword ptr [edi+24h], 0
		jz	short loc_1000E5C5
		mov	esi, [edi+450h]
		add	esi, 1204h
		mov	eax, ebp
		call	sub_10006670
		test	eax, eax
		jz	short loc_1000E5C5
		test	byte ptr [edi+16h], 1
		jnz	loc_1000E4A7
		mov	eax, [edi+25Ch]
		push	eax
		jmp	loc_1000E49F
; ---------------------------------------------------------------------------

loc_1000E5C5:				; CODE XREF: sub_1000D820+D76j
					; sub_1000D820+D8Dj
		mov	esi, [edi+454h]
		add	esi, 1204h
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000E5E2
		push	0
		push	esi
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1000E5E2:				; CODE XREF: sub_1000D820+DB5j
		push	ebp
		push	esi
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	byte ptr [edi+16h], 1
		mov	esi, eax
		jnz	short loc_1000E605
		mov	ecx, [edi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1000E605:				; CODE XREF: sub_1000D820+DD4j
		test	esi, esi
		jnz	loc_1000E4FD
		push	edi
		call	sub_10003200
		add	esp, 4
		test	eax, eax
		jg	short loc_1000E630
		call	PORT_GetError_Util
		mov	[esp+54h+var_40], eax
		mov	[esp+54h+var_44], 28h
		jmp	loc_1000E50D
; ---------------------------------------------------------------------------

loc_1000E630:				; CODE XREF: sub_1000D820+DF8j
		push	offset sub_10014AF0
		push	0
		push	edi
		call	sub_100162A0
		add	esp, 0Ch
		jmp	loc_1000E512
; ---------------------------------------------------------------------------

loc_1000E645:				; CODE XREF: sub_1000D820+BCBj
		cmp	dword ptr [edi+24h], 0
		jz	loc_1000E53C
		test	byte ptr [edi+16h], 1
		mov	esi, 1
		jnz	short loc_1000E669
		mov	edx, [edi+25Ch]
		push	edx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000E669:				; CODE XREF: sub_1000D820+E38j
		mov	eax, [edi+450h]
		cmp	dword ptr [eax+1208h], 0
		jz	short loc_1000E67A
		xor	esi, esi

loc_1000E67A:				; CODE XREF: sub_1000D820+E56j
		test	byte ptr [edi+16h], 1
		jnz	short loc_1000E68F
		mov	ecx, [edi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000E68F:				; CODE XREF: sub_1000D820+E5Ej
		test	esi, esi
		jnz	loc_1000E53C
		mov	ebx, 0FFFFD06Ah
		mov	[esp+54h+var_44], 28h
		jmp	short loc_1000E6FC
; ---------------------------------------------------------------------------

loc_1000E6A6:				; CODE XREF: sub_1000D820+D29j
		test	byte ptr [edi+16h], 1
		mov	[edi+0F4h], eax
		mov	dword ptr [edi+83Ch], 0
		jnz	short loc_1000E6CC
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000E6CC:				; CODE XREF: sub_1000D820+E9Aj
		mov	eax, edi
		call	sub_1000D710
		test	byte ptr [edi+16h], 1
		mov	esi, eax
		jnz	short loc_1000E6EB
		mov	eax, [edi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000E6EB:				; CODE XREF: sub_1000D820+EB9j
		test	esi, esi
		jz	loc_1000E386
		jmp	loc_1000E54F
; ---------------------------------------------------------------------------

loc_1000E6F8:				; CODE XREF: sub_1000D820+D16j
		mov	ebx, [esp+54h+var_40]

loc_1000E6FC:				; CODE XREF: sub_1000D820+96j
					; sub_1000D820+BAj ...
		mov	edx, [esp+54h+var_44]
		mov	eax, [esp+54h+var_3C]
		push	edx
		push	eax
		push	edi
		call	sub_10008960
		add	esp, 0Ch
		push	ebx
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 48h
		retn
sub_1000D820	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E730	proc near		; CODE XREF: sub_10013DA0+89p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		test	byte ptr [esi+16h], 1
		push	edi
		mov	[esp+14h+var_C], 0FFFFD01Ch
		mov	[esp+14h+var_8], 28h
		jnz	short loc_1000E75F
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000E75F:				; CODE XREF: sub_1000E730+1Dj
		push	9Ch		; Size
		lea	ecx, [esi+2E9Ch]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch
		mov	edi, esi
		call	sub_10007320
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000E7A0
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000E798
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000E798:				; CODE XREF: sub_1000E730+56j
					; sub_1000E730+7Fj
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E7A0:				; CODE XREF: sub_1000E730+50j
		call	sub_10005430
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000E7C9
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000E798
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000E7C9:				; CODE XREF: sub_1000E730+79j
		cmp	dword ptr [esi+4C0h], 0
		push	ebx
		push	ebp
		jz	short loc_1000E7E1
		mov	[esp+1Ch+var_C], 0FFFFD02Ah
		jmp	loc_1000E9EA
; ---------------------------------------------------------------------------

loc_1000E7E1:				; CODE XREF: sub_1000E730+A2j
		mov	eax, [esp+1Ch+arg_4]
		movzx	ecx, byte ptr [eax+1]
		movzx	edx, byte ptr [eax+2]
		movzx	ebx, byte ptr [eax+5]
		movzx	edi, byte ptr [eax+7]
		shl	cx, 8
		or	cx, dx
		movzx	edx, byte ptr [eax+4]
		movzx	ebp, cx
		movzx	ecx, byte ptr [eax+3]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [eax+8]
		mov	[esp+1Ch+arg_0], ecx
		movzx	ecx, byte ptr [eax+6]
		movzx	eax, word ptr [esi+18h]
		shl	ebx, 8
		shl	edi, 8
		or	ebx, ecx
		or	edi, edx
		mov	[esi+46h], bp
		test	ax, ax
		jnz	short loc_1000E836
		push	0FFFFD014h
		jmp	short loc_1000E872
; ---------------------------------------------------------------------------

loc_1000E836:				; CODE XREF: sub_1000E730+FDj
		cmp	bp, ax
		jb	short loc_1000E86D
		movzx	eax, word ptr [esi+1Ah]
		cmp	bp, ax
		jnb	short loc_1000E846
		mov	eax, ebp

loc_1000E846:				; CODE XREF: sub_1000E730+112j
		mov	[esi+44h], ax
		call	sub_10008500
		test	eax, eax
		jz	short loc_1000E88F
		mov	[esp+1Ch+var_8], 50h
		call	PORT_GetError_Util
		mov	[esp+1Ch+var_C], eax
		mov	eax, [esp+1Ch+var_8]
		jmp	loc_1000E9DE
; ---------------------------------------------------------------------------

loc_1000E86D:				; CODE XREF: sub_1000E730+109j
		push	0FFFFD002h

loc_1000E872:				; CODE XREF: sub_1000E730+104j
		call	PORT_SetError_Util
		mov	eax, 300h
		add	esp, 4
		cmp	ax, bp
		sbb	eax, eax
		and	eax, 1Eh
		add	eax, 28h
		jmp	loc_1000E9D6
; ---------------------------------------------------------------------------

loc_1000E88F:				; CODE XREF: sub_1000E730+121j
		mov	ebp, [esp+1Ch+arg_0]
		lea	ecx, [edi+ebx]
		lea	edx, [ecx+ebp+9]
		cmp	[esp+1Ch+arg_8], edx
		jnz	loc_1000E9EA
		mov	ecx, [esp+1Ch+arg_4]
		lea	eax, [edi-10h]
		add	ecx, 9
		cmp	eax, 10h
		ja	loc_1000E9EA
		xor	eax, eax
		add	ecx, ebx
		mov	[esi+4A0h], eax
		add	ecx, ebp
		mov	[esi+4A4h], eax
		push	edi		; Size
		push	ecx		; Src
		mov	[esi+4A8h], eax
		mov	[esi+4ACh], eax
		mov	ecx, esi
		mov	[esi+4B0h], eax
		sub	ecx, edi
		mov	[esi+4B4h], eax
		add	ecx, 4C0h
		mov	[esi+4B8h], eax
		push	ecx		; Dst
		mov	[esi+4BCh], eax
		call	memcpy
		push	esi
		call	sub_10021740
		push	esi
		call	sub_10003200
		add	esp, 14h
		test	eax, eax
		jg	short loc_1000E924
		call	PORT_GetError_Util
		mov	[esp+1Ch+var_C], eax
		mov	eax, [esp+1Ch+var_8]
		jmp	loc_1000E9DE
; ---------------------------------------------------------------------------

loc_1000E924:				; CODE XREF: sub_1000E730+1E0j
		movzx	eax, word ptr [esi+44h]
		mov	[esp+1Ch+var_4], 0
		mov	word ptr [esp+1Ch+var_C+2], ax
		lea	ebx, [esi+352h]
		jmp	short loc_1000E940
; ---------------------------------------------------------------------------
		align 10h

loc_1000E940:				; CODE XREF: sub_1000E730+20Bj
					; sub_1000E730+29Cj
		movzx	eax, word ptr [esi+44h]
		mov	ecx, [esi+468h]
		mov	word ptr [esp+1Ch+var_C], ax
		test	ecx, ecx
		jz	short loc_1000E9BD
		mov	al, [ebx+1]
		test	al, 1
		jz	short loc_1000E9BD
		test	al, 2
		jz	short loc_1000E9BD
		mov	al, [ebx]
		test	al, al
		jz	short loc_1000E9BD
		movzx	edx, al
		cmp	edx, ecx
		jg	short loc_1000E9BD
		movzx	edi, word ptr [ebx-2]
		lea	ecx, [esp+1Ch+var_C]
		mov	eax, edi
		call	sub_10003040
		test	eax, eax
		jz	short loc_1000E9BD
		cmp	ebp, 2
		jle	short loc_1000E9BD
		mov	edx, edi
		mov	edi, [esp+1Ch+arg_4]
		add	edi, 9
		mov	ecx, 1
		lea	eax, [edi+1]
		sub	ecx, edi

loc_1000E996:				; CODE XREF: sub_1000E730+28Bj
		movzx	edi, byte ptr [eax-1]
		movzx	ebp, byte ptr [eax]
		shl	edi, 8
		or	edi, ebp
		movzx	ebp, byte ptr [eax+1]
		shl	edi, 8
		or	edi, ebp
		cmp	edi, edx
		jz	short loc_1000EA18
		mov	ebp, [esp+1Ch+arg_0]
		add	eax, 3
		lea	edi, [ecx+eax]
		cmp	edi, ebp
		jl	short loc_1000E996

loc_1000E9BD:				; CODE XREF: sub_1000E730+221j
					; sub_1000E730+228j ...
		mov	eax, [esp+1Ch+var_4]
		inc	eax
		add	ebx, 4
		mov	[esp+1Ch+var_4], eax
		cmp	eax, 3Dh
		jl	loc_1000E940
		mov	eax, [esp+1Ch+var_8]

loc_1000E9D6:				; CODE XREF: sub_1000E730+15Aj
		mov	[esp+1Ch+var_C], 0FFFFD002h

loc_1000E9DE:				; CODE XREF: sub_1000E730+138j
					; sub_1000E730+1EFj ...
		push	eax
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_1000E9EA:				; CODE XREF: sub_1000E730+ACj
					; sub_1000E730+16Ej ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000EA00
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000EA00:				; CODE XREF: sub_1000E730+2BEj
		mov	eax, [esp+1Ch+var_C]
		push	eax
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000EA18:				; CODE XREF: sub_1000E730+27Dj
		movzx	edx, word ptr [ebx-2]
		mov	[esi+80Ch], dx
		call	sub_100031C0
		mov	edi, [esp+1Ch+arg_4]
		lea	edx, [edi+9]
		mov	ecx, 1
		mov	[esi+810h], eax
		lea	eax, [edx+1]
		sub	ecx, edx
		mov	edx, [esp+1Ch+arg_0]

loc_1000EA43:				; CODE XREF: sub_1000E730+338j
		movzx	ebx, byte ptr [eax-1]
		movzx	ebp, byte ptr [eax]
		shl	ebx, 8
		or	ebx, ebp
		movzx	ebp, byte ptr [eax+1]
		shl	ebx, 8
		or	ebx, ebp
		cmp	ebx, 0FFh
		jz	short loc_1000EA6C
		add	eax, 3
		lea	ebx, [eax+ecx]
		cmp	ebx, edx
		jl	short loc_1000EA43
		jmp	short loc_1000EA8F
; ---------------------------------------------------------------------------

loc_1000EA6C:				; CODE XREF: sub_1000E730+32Ej
		lea	eax, [esp+1Ch+arg_0]
		push	eax
		lea	ecx, [esp+20h+var_4]
		push	ecx
		push	esi
		mov	[esp+28h+var_4], offset	dword_1002B010
		mov	[esp+28h+arg_0], 5
		call	sub_10016190
		add	esp, 0Ch

loc_1000EA8F:				; CODE XREF: sub_1000E730+33Aj
		test	dword ptr [esi+14h], 200000h
		jz	short loc_1000EAC3
		push	0FF01h
		push	esi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000EAC3
		mov	[esp+1Ch+var_8], 28h
		mov	eax, [esp+1Ch+var_8]
		mov	[esp+1Ch+var_C], 0FFFFD071h
		jmp	loc_1000E9DE
; ---------------------------------------------------------------------------

loc_1000EAC3:				; CODE XREF: sub_1000E730+366j
					; sub_1000E730+378j
		push	offset dword_100374EC
		mov	dword ptr [esi+814h], 0
		mov	dword ptr [esi+48h], offset sub_10007FE0
		call	ds:__imp_PR_AtomicIncrement
		push	1
		push	esi
		call	sub_100066A0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000EAFC
		call	PORT_GetError_Util
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1000E9EA
; ---------------------------------------------------------------------------

loc_1000EAFC:				; CODE XREF: sub_1000E730+3BCj
		mov	ebx, [esp+1Ch+arg_8]
		mov	[esi+0F4h], eax
		push	edi
		mov	eax, esi
		call	sub_10005490
		add	esp, 4
		test	eax, eax
		jz	short loc_1000EB23
		call	PORT_GetError_Util
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1000E9EA
; ---------------------------------------------------------------------------

loc_1000EB23:				; CODE XREF: sub_1000E730+3E3j
		mov	bl, 1
		test	[esi+16h], bl
		jnz	short loc_1000EB3A
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000EB3A:				; CODE XREF: sub_1000E730+3F8j
		mov	eax, esi
		call	sub_1000D710
		mov	edi, eax
		test	[esi+16h], bl
		jnz	short loc_1000EB58
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000EB58:				; CODE XREF: sub_1000E730+416j
		test	edi, edi
		jz	short loc_1000EB6A
		call	PORT_GetError_Util
		mov	[esp+1Ch+var_C], eax
		jmp	loc_1000E9EA
; ---------------------------------------------------------------------------

loc_1000EB6A:				; CODE XREF: sub_1000E730+42Aj
		test	[esi+16h], bl
		jnz	short loc_1000EB7F
		mov	ecx, [esi+258h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000EB7F:				; CODE XREF: sub_1000E730+43Dj
		pop	ebp
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
sub_1000E730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000EB90(void	*Src, size_t Size)
sub_1000EB90	proc near		; CODE XREF: sub_1000F030+329p

Src		= dword	ptr  4
Size		= dword	ptr  8

		push	esi
		mov	esi, eax
		cmp	dword ptr [esi+4C0h], 7
		jz	short loc_1000EBB8
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD07Dh
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000EBB8:				; CODE XREF: sub_1000EB90+Aj
		push	edi
		lea	eax, [esp+8+Size]
		push	eax
		lea	ecx, [esp+0Ch+Src]
		push	ecx
		push	1
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, 1
		jnz	short loc_1000EBF8
		lea	edx, [esp+8+Size]
		push	edx
		lea	eax, [esp+0Ch+Src]
		push	eax
		push	3
		push	esi
		call	sub_100091C0
		mov	edi, [esp+18h+Size]
		add	esp, 10h
		cmp	eax, edi
		jnz	short loc_1000EBF8
		cmp	edi, 1FFFFh
		jbe	short loc_1000EC2D

loc_1000EBF8:				; CODE XREF: sub_1000EB90+41j
					; sub_1000EB90+5Ej
		mov	ecx, 300h
		cmp	cx, [esi+44h]
		sbb	edx, edx
		and	edx, 3
		add	edx, 2Fh
		push	edx
		push	2
		push	esi
		call	sub_10008960
		mov	eax, [esi+4Ch]
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFD007h
		push	eax
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000EC2D:				; CODE XREF: sub_1000EB90+66j
		mov	ecx, [esi+0F4h]
		push	1
		add	ecx, 14h
		push	ecx
		push	0
		call	SECITEM_AllocArray
		mov	edx, [esi+0F4h]
		add	esp, 0Ch
		cmp	dword ptr [edx+14h], 0
		jz	short loc_1000EC81
		push	edi
		call	PORT_Alloc_Util
		mov	ecx, [esi+0F4h]
		mov	edx, [ecx+14h]
		mov	[edx+4], eax
		mov	eax, [esi+0F4h]
		mov	ecx, [eax+14h]
		add	esp, 4
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_1000EC87
		lea	edx, [eax+14h]
		push	0
		push	edx
		call	SECITEM_FreeArray
		add	esp, 8

loc_1000EC81:				; CODE XREF: sub_1000EB90+BDj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000EC87:				; CODE XREF: sub_1000EB90+E1j
		mov	ecx, [esi+0F4h]
		mov	eax, [esp+8+Src]
		mov	edx, [ecx+14h]
		push	edi		; Size
		push	eax		; Src
		mov	eax, [edx+4]
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esi+0F4h]
		mov	edx, [ecx+14h]
		mov	[edx+8], edi
		mov	eax, [esi+0F4h]
		mov	ecx, [eax+14h]
		add	esp, 0Ch
		mov	dword ptr [ecx], 0
		call	sub_1000C640
		pop	edi
		pop	esi
		retn
sub_1000EB90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000ECD0	proc near		; CODE XREF: sub_1000F030+318p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, eax
		xor	eax, eax
		xor	ebp, ebp
		cmp	[esi+4Ch], ebp
		push	edi
		setnz	al
		mov	[esp+2Ch+var_14], ebp
		mov	[esp+2Ch+var_1C], 0FFFFD01Eh
		mov	[esp+2Ch+var_10], eax
		mov	eax, [esi+4C0h]
		cmp	eax, 8
		jz	short loc_1000ED13
		cmp	eax, 1
		jz	short loc_1000ED13
		lea	eax, [ebp+0Ah]
		mov	[esp+2Ch+var_1C], 0FFFFD02Ch
		jmp	loc_1000EF50
; ---------------------------------------------------------------------------

loc_1000ED13:				; CODE XREF: sub_1000ECD0+2Cj
					; sub_1000ECD0+31j
		cmp	[esi+6Ch], ebp
		jz	short loc_1000ED3A
		mov	eax, [esi+70h]
		cmp	eax, ebp
		jz	short loc_1000ED2B
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	[esi+70h], ebp

loc_1000ED2B:				; CODE XREF: sub_1000ECD0+4Dj
		mov	ecx, [esi+6Ch]
		push	ecx
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi+6Ch], ebp

loc_1000ED3A:				; CODE XREF: sub_1000ECD0+46j
		mov	edi, [esi+470h]
		mov	ebx, [esi+46Ch]
		cmp	edi, ebp
		jz	short loc_1000ED62
		lea	ebx, [ebx+0]

loc_1000ED50:				; CODE XREF: sub_1000ECD0+90j
		mov	edx, [edi+4]
		push	edx
		call	CERT_DestroyCertificate
		mov	edi, [edi]
		add	esp, 4
		cmp	edi, ebp
		jnz	short loc_1000ED50

loc_1000ED62:				; CODE XREF: sub_1000ECD0+78j
		cmp	ebx, ebp
		jz	short loc_1000ED70
		push	ebp
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_1000ED70:				; CODE XREF: sub_1000ECD0+94j
		mov	eax, [esi+44Ch]
		mov	ecx, 300h
		mov	[esi+46Ch], ebp
		mov	[esi+470h], ebp
		cmp	cx, [eax+58h]
		sbb	edi, edi
		neg	edi
		mov	[esp+2Ch+var_18], edi
		cmp	[esp+2Ch+arg_4], ebp
		jz	short loc_1000EDC6
		lea	edx, [esp+2Ch+arg_4]
		push	edx
		lea	eax, [esp+30h+arg_0]
		push	eax
		push	3
		push	esi
		call	sub_100091C0
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, ebp
		jl	loc_1000EF5C
		cmp	ebx, [esp+2Ch+arg_4]
		ja	loc_1000EF42
		cmp	ebx, ebp
		jnz	short loc_1000EE16

loc_1000EDC6:				; CODE XREF: sub_1000ECD0+C7j
		cmp	edi, ebp
		jz	short loc_1000EE0C
		cmp	[esp+2Ch+var_10], ebp
		jz	short loc_1000EE0C
		call	sub_1000D170
		test	eax, eax
		jz	short loc_1000EDF8
		call	PORT_GetError_Util
		mov	ecx, eax
		push	ecx
		mov	[esp+30h+var_1C], eax
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000EDF8:				; CODE XREF: sub_1000ECD0+107j
		pop	edi
		mov	dword ptr [esi+4C0h], 2
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000EE0C:				; CODE XREF: sub_1000ECD0+F8j
					; sub_1000ECD0+FEj
		mov	eax, 2Ah
		jmp	loc_1000EF50
; ---------------------------------------------------------------------------

loc_1000EE16:				; CODE XREF: sub_1000ECD0+F4j
		push	800h
		call	PORT_NewArena_Util
		add	esp, 4
		mov	[esi+46Ch], eax
		cmp	eax, ebp
		jz	loc_1000EF5C
		sub	ebx, 3
		js	loc_1000EF42
		lea	ecx, [esp+2Ch+arg_4]
		push	ecx
		lea	edx, [esp+30h+arg_0]
		push	edx
		push	3
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, ebp
		jle	loc_1000EF5C
		cmp	ebx, eax
		jl	loc_1000EF42
		mov	ecx, [esp+2Ch+arg_0]
		sub	[esp+2Ch+arg_4], eax
		push	1
		mov	[esp+30h+var_8], ecx
		add	ecx, eax
		push	ebp
		mov	[esp+34h+var_4], eax
		sub	ebx, eax
		push	ebp
		lea	eax, [esp+38h+var_C]
		mov	[esp+38h+arg_0], ecx
		mov	ecx, [esi+260h]
		push	eax
		push	ecx
		call	CERT_NewTempCertificate
		add	esp, 14h
		mov	[esi+6Ch], eax
		cmp	eax, ebp
		jz	loc_1000EF78
		cmp	ebx, ebp
		jle	loc_1000EF40

loc_1000EEA2:				; CODE XREF: sub_1000ECD0+268j
		sub	ebx, 3
		js	loc_1000EF42
		lea	edx, [esp+2Ch+arg_4]
		push	edx
		lea	eax, [esp+30h+arg_0]
		push	eax
		push	3
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	eax, ebp
		jle	loc_1000EF5C
		cmp	ebx, eax
		jl	short loc_1000EF42
		mov	ecx, [esp+2Ch+arg_0]
		sub	[esp+2Ch+arg_4], eax
		mov	[esp+2Ch+var_8], ecx
		add	ecx, eax
		mov	[esp+2Ch+arg_0], ecx
		mov	ecx, [esi+46Ch]
		push	8
		push	ecx
		mov	[esp+34h+var_4], eax
		sub	ebx, eax
		call	PORT_ArenaAlloc_Util
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jz	short loc_1000EF5C
		mov	eax, [esi+260h]
		push	1
		push	ebp
		push	ebp
		lea	edx, [esp+38h+var_C]
		push	edx
		push	eax
		call	CERT_NewTempCertificate
		add	esp, 14h
		mov	[edi+4], eax
		cmp	eax, ebp
		jz	short loc_1000EF74
		mov	eax, [esp+2Ch+var_14]
		mov	[edi], ebp
		cmp	eax, ebp
		jz	short loc_1000EF28
		mov	[eax], edi
		jmp	short loc_1000EF2E
; ---------------------------------------------------------------------------

loc_1000EF28:				; CODE XREF: sub_1000ECD0+252j
		mov	[esi+470h], edi

loc_1000EF2E:				; CODE XREF: sub_1000ECD0+256j
		mov	[esp+2Ch+var_14], edi
		mov	edi, [esp+2Ch+var_18]
		cmp	ebx, ebp
		jg	loc_1000EEA2
		cmp	ebx, ebp

loc_1000EF40:				; CODE XREF: sub_1000ECD0+1CCj
		jz	short loc_1000EFAC

loc_1000EF42:				; CODE XREF: sub_1000ECD0+ECj
					; sub_1000ECD0+164j ...
		xor	eax, eax
		cmp	edi, ebp
		setnz	al
		lea	eax, ds:2Ah[eax*8]

loc_1000EF50:				; CODE XREF: sub_1000ECD0+3Ej
					; sub_1000ECD0+141j ...
		push	eax
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_1000EF5C:				; CODE XREF: sub_1000ECD0+E2j
					; sub_1000ECD0+15Bj ...
		mov	ecx, [esp+2Ch+var_1C]
		push	ecx
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000EF74:				; CODE XREF: sub_1000ECD0+248j
		mov	edi, [esp+2Ch+var_18]

loc_1000EF78:				; CODE XREF: sub_1000ECD0+1C4j
		call	PORT_GetError_Util
		mov	[esp+2Ch+var_1C], eax
		cmp	eax, 0FFFFE012h
		jl	short loc_1000EFA1
		cmp	eax, 0FFFFE013h
		jle	short loc_1000EF96
		cmp	eax, 0FFFFE890h
		jnz	short loc_1000EFA1

loc_1000EF96:				; CODE XREF: sub_1000ECD0+2BDj
		cmp	edi, ebp
		jz	short loc_1000EF5C
		mov	eax, 50h
		jmp	short loc_1000EF50
; ---------------------------------------------------------------------------

loc_1000EFA1:				; CODE XREF: sub_1000ECD0+2B6j
					; sub_1000ECD0+2C4j
		mov	ecx, eax
		mov	edx, esi
		call	sub_10008A80
		jmp	short loc_1000EF5C
; ---------------------------------------------------------------------------

loc_1000EFAC:				; CODE XREF: sub_1000ECD0:loc_1000EF40j
		mov	edx, [esi+6Ch]
		push	edx
		call	SECKEY_UpdateCertPQG
		add	esp, 4
		cmp	[esp+2Ch+var_10], ebp
		jnz	short loc_1000EFE1
		push	5
		push	esi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000EFE1
		pop	edi
		mov	dword ptr [esi+4C0h], 7
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000EFE1:				; CODE XREF: sub_1000ECD0+2ECj
					; sub_1000ECD0+2FBj
		call	sub_1000C640
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_1000ECD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000EFF0(int Src)
sub_1000EFF0	proc near		; CODE XREF: sub_1000F030+424p
		mov	eax, [ecx+4C0h]
		cmp	eax, 0Bh
		jz	short loc_1000F025
		cmp	eax, 8
		jz	short loc_1000F025
		cmp	eax, 9
		jz	short loc_1000F025
		cmp	eax, 0Ah
		jz	short loc_1000F025
		push	0Ah
		push	2
		push	ecx
		call	sub_10008960
		push	0FFFFD02Fh
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000F025:				; CODE XREF: sub_1000EFF0+9j
					; sub_1000EFF0+Ej ...
		push	ecx		; Src
		call	sub_1000D520
		add	esp, 4
		retn
sub_1000EFF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000F030(int,	void *Src, size_t Size)
sub_1000F030	proc near		; CODE XREF: sub_10002B90+127p
					; sub_10002B90+2DEp ...

var_60		= byte ptr -60h
var_5F		= byte ptr -5Fh
var_5E		= byte ptr -5Eh
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		sub	esp, 60h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+60h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+6Ch+arg_0]
		mov	ebx, [esi+828h]
		xor	ebp, ebp
		test	byte ptr [esi+16h], 1
		push	edi
		mov	edi, [esp+70h+Src]
		jnz	short loc_1000F067
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000F067:				; CODE XREF: sub_1000F030+26j
		cmp	ebx, 14h
		jz	short loc_1000F071
		cmp	ebx, 0Fh
		jnz	short loc_1000F0A5

loc_1000F071:				; CODE XREF: sub_1000F030+3Aj
		mov	ecx, [esi+44Ch]
		xor	eax, eax
		cmp	ebx, 14h
		jnz	short loc_1000F095
		mov	eax, [esi+4Ch]
		mov	ecx, [esi+448h]
		neg	eax
		sbb	eax, eax
		and	eax, 0EFF9F802h
		add	eax, 53525652h

loc_1000F095:				; CODE XREF: sub_1000F030+4Cj
		push	eax
		push	esi
		lea	edx, [esp+78h+var_54]
		call	sub_100056B0
		add	esp, 8
		mov	ebp, eax

loc_1000F0A5:				; CODE XREF: sub_1000F030+3Fj
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F0BA
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000F0BA:				; CODE XREF: sub_1000F030+79j
		test	ebp, ebp
		jz	short loc_1000F0D3
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F0D3:				; CODE XREF: sub_1000F030+8Cj
		mov	ebx, [esp+70h+Size]
		mov	dl, [esi+828h]
		mov	eax, ebx
		shr	eax, 10h
		mov	[esp+70h+var_58], eax
		mov	[esp+70h+var_5F], al
		mov	eax, ebx
		shr	eax, 8
		mov	ebp, 1
		mov	[esp+70h+var_60], dl
		mov	[esp+70h+var_5C], eax
		mov	[esp+70h+var_5E], al
		mov	[esp+70h+var_5D], bl
		cmp	[esi+828h], ebp
		jnz	short loc_1000F119
		call	sub_10005430
		test	eax, eax
		jnz	loc_1000F567

loc_1000F119:				; CODE XREF: sub_1000F030+DAj
		mov	eax, [esi+828h]
		test	eax, eax
		jz	loc_1000F1C1
		cmp	eax, 3
		jz	loc_1000F1C1
		lea	eax, [esp+70h+var_60]
		push	eax
		mov	ebx, 4
		mov	eax, esi
		call	sub_10005490
		xor	ecx, ecx
		add	esp, 4
		cmp	eax, ecx
		jnz	loc_1000F567
		cmp	[esi+2F38h], ebp
		jnz	short loc_1000F1AA
		movzx	eax, byte ptr [esi+8E2h]
		movzx	edx, byte ptr [esi+8E3h]
		mov	[esp+70h+var_A], cx
		mov	[esp+70h+var_8], cl
		mov	cl, byte ptr [esp+70h+var_58]
		mov	[esp+70h+var_B], al
		mov	al, byte ptr [esp+70h+Size]
		mov	[esp+70h+var_C], dl
		movzx	edx, byte ptr [esp+70h+var_5C]
		mov	[esp+70h+var_7], cl
		lea	ecx, [esp+70h+var_C]
		mov	[esp+70h+var_5], al
		push	ecx
		mov	ebx, 8
		mov	eax, esi
		mov	[esp+74h+var_6], dl
		call	sub_10005490
		add	esp, 4
		test	eax, eax
		jnz	loc_1000F567

loc_1000F1AA:				; CODE XREF: sub_1000F030+124j
		mov	ebx, [esp+70h+Size]
		push	edi
		mov	eax, esi
		call	sub_10005490
		add	esp, 4
		test	eax, eax
		jnz	loc_1000F567

loc_1000F1C1:				; CODE XREF: sub_1000F030+F1j
					; sub_1000F030+FAj
		push	0
		call	PORT_SetError_Util
		add	esp, 4
		cmp	dword ptr [esi+4C0h], 7
		jnz	short loc_1000F1EA
		cmp	dword ptr [esi+828h], 16h
		jz	short loc_1000F1EA
		call	sub_1000C640
		test	eax, eax
		jnz	loc_1000F567

loc_1000F1EA:				; CODE XREF: sub_1000F030+1A2j
					; sub_1000F030+1ABj
		mov	eax, [esi+828h]
		cmp	eax, 16h	; switch 23 cases
		ja	loc_1000F539	; jumptable 1000F200 default case
		movzx	edx, ds:byte_1000F5B4[eax]
		jmp	ds:off_1000F57C[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000F207:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		test	ebx, ebx	; jumptable 1000F200 case 0
		jz	short loc_1000F234
		push	esi
		call	sub_10008BD0
		push	0FFFFD01Bh
		call	PORT_SetError_Util
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F234:				; CODE XREF: sub_1000F030+1D9j
		cmp	dword ptr [esi+4Ch], 0
		jz	short loc_1000F267
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD029h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F267:				; CODE XREF: sub_1000F030+208j
		call	sub_10009C70
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F271:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 1
		jnz	short loc_1000F2A4
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD02Ah
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F2A4:				; CODE XREF: sub_1000F030+245j
		push	ebx
		push	edi
		mov	edi, esi
		call	sub_1000D820
		add	esp, 8
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F2B5:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 2
		jz	short loc_1000F2E8
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD02Bh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F2E8:				; CODE XREF: sub_1000F030+289j
		push	ebx
		push	edi
		mov	eax, esi
		call	sub_1000A6D0
		add	esp, 8
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F2F9:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	[esi+2F38h], ebp ; jumptable 1000F200 case 3
		jnz	short loc_1000F317
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_1000F317
		push	ebx
		push	edi
		push	esi
		call	sub_10002510
		add	esp, 0Ch
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F317:				; CODE XREF: sub_1000F030+2CFj
					; sub_1000F030+2D5j
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD07Bh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F344:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		push	ebx		; jumptable 1000F200 case 11
		push	edi
		mov	eax, esi
		call	sub_1000ECD0
		add	esp, 8
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F355:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		push	ebx		; jumptable 1000F200 case 22
		push	edi		; Src
		mov	eax, esi
		call	sub_1000EB90
		add	esp, 8
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F366:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 12
		jz	short loc_1000F399
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD02Dh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F399:				; CODE XREF: sub_1000F030+33Aj
		push	ebx
		mov	ecx, edi
		call	sub_1000AE00
		add	esp, 4
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F3A9:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 13
		jz	short loc_1000F3DC
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD02Eh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F3DC:				; CODE XREF: sub_1000F030+37Dj
		push	ebx
		push	edi
		mov	ebx, esi
		call	sub_1000B3C0
		add	esp, 8
		mov	ebp, 1
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F3F2:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		test	ebx, ebx	; jumptable 1000F200 case 14
		jz	short loc_1000F41F
		push	esi
		call	sub_10008BD0
		push	0FFFFD021h
		call	PORT_SetError_Util
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F41F:				; CODE XREF: sub_1000F030+3C4j
		cmp	dword ptr [esi+4Ch], 0
		jz	short loc_1000F452
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD02Fh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F452:				; CODE XREF: sub_1000F030+3F3j
		mov	ecx, esi	; Src
		call	sub_1000EFF0
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F45E:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 15
		jnz	short loc_1000F491
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD030h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F491:				; CODE XREF: sub_1000F030+432j
		lea	eax, [esp+70h+var_54]
		push	eax
		push	ebx
		push	edi
		mov	edi, esi
		call	sub_1000BE10
		add	esp, 0Ch
		jmp	loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F4A7:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 16
		jnz	short loc_1000F4DA
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD031h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F4DA:				; CODE XREF: sub_1000F030+47Bj
		push	ebx
		push	edi
		call	sub_1000C1C0
		add	esp, 8
		jmp	short loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F4E6:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		cmp	dword ptr [esi+4Ch], 0 ; jumptable 1000F200 case 4
		jz	short loc_1000F519
		push	0Ah
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD06Dh
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_1000F519:				; CODE XREF: sub_1000F030+4BAj
		push	ebx
		push	edi
		push	esi
		call	sub_1000C350
		add	esp, 0Ch
		jmp	short loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F526:				; CODE XREF: sub_1000F030+1D0j
					; DATA XREF: .text:off_1000F57Co
		lea	ecx, [esp+70h+var_54] ;	jumptable 1000F200 case	20
		push	ecx
		push	ebx
		push	esi
		mov	edx, edi
		call	sub_1000CB90
		add	esp, 0Ch
		jmp	short loc_1000F553
; ---------------------------------------------------------------------------

loc_1000F539:				; CODE XREF: sub_1000F030+1C3j
					; sub_1000F030+1D0j
					; DATA XREF: ...
		push	0Ah		; jumptable 1000F200 default case
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD038h
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh

loc_1000F553:				; CODE XREF: sub_1000F030+23Cj
					; sub_1000F030+280j ...
		cmp	[esi+2F38h], ebp
		jnz	short loc_1000F567
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000F567
		add	[esi+8E2h], bp

loc_1000F567:				; CODE XREF: sub_1000F030+E3j
					; sub_1000F030+118j ...
		mov	ecx, [esp+70h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
sub_1000F030	endp

; ---------------------------------------------------------------------------
		align 4
off_1000F57C	dd offset loc_1000F207	; DATA XREF: sub_1000F030+1D0r
		dd offset loc_1000F271	; jump table for switch	statement
		dd offset loc_1000F2B5
		dd offset loc_1000F2F9
		dd offset loc_1000F4E6
		dd offset loc_1000F344
		dd offset loc_1000F366
		dd offset loc_1000F3A9
		dd offset loc_1000F3F2
		dd offset loc_1000F45E
		dd offset loc_1000F4A7
		dd offset loc_1000F526
		dd offset loc_1000F355
		dd offset loc_1000F539
byte_1000F5B4	db	0,     1,     2,     3 ; DATA XREF: sub_1000F030+1C9r
		db	4,   0Dh,   0Dh,   0Dh ; indirect table	for switch statement
		db    0Dh,   0Dh,   0Dh,     5
		db	6,     7,     8,     9
		db    0Ah,   0Dh,   0Dh,   0Dh
		db    0Bh,   0Dh,   0Ch
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F5D0	proc near		; CODE XREF: sub_1000F790+781p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		xor	ebp, ebp
		push	edi
		cmp	[esi+848h], ebp
		jnz	short loc_1000F5FB
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [eax]
		mov	[esi+848h], ecx
		mov	edx, [eax+4]
		mov	[esi+84Ch], edx
		mov	eax, [eax+8]
		mov	[esi+850h], eax

loc_1000F5FB:				; CODE XREF: sub_1000F5D0+Bj
		cmp	[esi+84Ch], ebp
		jbe	loc_1000F75D

loc_1000F607:				; CODE XREF: sub_1000F5D0+187j
		cmp	dword ptr [esi+824h], 4
		jnb	short loc_1000F676
		mov	eax, [esi+848h]
		mov	dl, [eax]
		dec	dword ptr [esi+84Ch]
		inc	eax
		mov	[esi+848h], eax
		mov	eax, [esi+824h]
		lea	ecx, [eax+1]
		mov	[esi+824h], ecx
		movzx	edx, dl
		cmp	eax, ebp
		jnz	short loc_1000F643
		mov	[esi+828h], edx
		jmp	short loc_1000F654
; ---------------------------------------------------------------------------

loc_1000F643:				; CODE XREF: sub_1000F5D0+69j
		mov	eax, [esi+82Ch]
		shl	eax, 8
		add	eax, edx
		mov	[esi+82Ch], eax

loc_1000F654:				; CODE XREF: sub_1000F5D0+71j
		cmp	ecx, 4
		jb	loc_1000F751
		mov	eax, [esi+82Ch]
		cmp	eax, 1FFFFh
		ja	loc_1000F770
		cmp	eax, ebp
		ja	loc_1000F751

loc_1000F676:				; CODE XREF: sub_1000F5D0+3Ej
		mov	edx, [esi+81Ch]
		cmp	edx, ebp
		jnz	short loc_1000F6C2
		mov	eax, [esi+82Ch]
		cmp	[esi+84Ch], eax
		jb	short loc_1000F6C2
		push	eax		; Size
		mov	eax, [esi+848h]
		push	eax		; Src
		push	esi		; int
		call	sub_1000F030
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_1000F783
		mov	ecx, [esi+82Ch]
		add	[esi+848h], ecx
		mov	edx, [esi+82Ch]
		sub	[esi+84Ch], edx
		jmp	short loc_1000F741
; ---------------------------------------------------------------------------

loc_1000F6C2:				; CODE XREF: sub_1000F5D0+AEj
					; sub_1000F5D0+BCj
		mov	ecx, [esi+82Ch]
		mov	edi, [esi+84Ch]
		mov	eax, ecx
		sub	eax, edx
		cmp	edi, eax
		jb	short loc_1000F6D8
		mov	edi, eax

loc_1000F6D8:				; CODE XREF: sub_1000F5D0+104j
		push	ecx
		lea	ebx, [esi+818h]
		push	ebx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jnz	loc_1000F783
		mov	ecx, [esi+81Ch]
		mov	eax, [esi+848h]
		add	ecx, [ebx]
		push	edi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	[esi+81Ch], edi
		add	[esi+848h], edi
		sub	[esi+84Ch], edi
		mov	eax, [esi+82Ch]
		add	esp, 0Ch
		cmp	[esi+81Ch], eax
		jnz	short loc_1000F75D
		mov	edx, [ebx]
		push	eax		; Size
		push	edx		; Src
		push	esi		; int
		call	sub_1000F030
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000F783
		mov	[esi+81Ch], ebp

loc_1000F741:				; CODE XREF: sub_1000F5D0+F0j
		mov	[esi+824h], ebp
		mov	[esi+82Ch], ebp
		cmp	eax, ebp
		jnz	short loc_1000F76C

loc_1000F751:				; CODE XREF: sub_1000F5D0+87j
					; sub_1000F5D0+A0j
		cmp	[esi+84Ch], ebp
		ja	loc_1000F607

loc_1000F75D:				; CODE XREF: sub_1000F5D0+31j
					; sub_1000F5D0+157j
		mov	eax, [esp+0Ch+arg_0]
		mov	[eax+4], ebp
		mov	[esi+848h], ebp
		xor	eax, eax

loc_1000F76C:				; CODE XREF: sub_1000F5D0+17Fj
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F770:				; CODE XREF: sub_1000F5D0+98j
		push	esi
		call	sub_10008BD0
		push	0FFFFD019h
		call	PORT_SetError_Util
		add	esp, 8

loc_1000F783:				; CODE XREF: sub_1000F5D0+D2j
					; sub_1000F5D0+11Aj ...
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_1000F5D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F790	proc near		; CODE XREF: sub_10010190+177p
					; sub_10010450+177p

var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B0		= dword	ptr -0B0h
var_AC		= byte ptr -0ACh
var_9C		= byte ptr -9Ch
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0E8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0E8h+var_4], eax
		mov	eax, [esp+0E8h+arg_8]
		push	ebx
		mov	ebx, [esp+0ECh+arg_4]
		push	esi
		mov	esi, [esp+0F0h+arg_0]
		cmp	dword ptr [esi+478h], 0
		push	edi
		mov	[esp+0F4h+var_E8], esi
		mov	[esp+0F4h+var_DC], ebx
		mov	[esp+0F4h+var_D4], eax
		mov	[esp+0F4h+var_C8], 41h
		mov	[esp+0F4h+var_E0], 0
		jnz	short loc_1000F834
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F7F7
		mov	ecx, [esi+258h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000F7F7:				; CODE XREF: sub_1000F790+55j
		mov	edi, esi
		call	sub_10007320
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1000F816
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000F816:				; CODE XREF: sub_1000F790+74j
		test	edi, edi
		jz	short loc_1000F834
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+0E8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
; ---------------------------------------------------------------------------

loc_1000F834:				; CODE XREF: sub_1000F790+4Fj
					; sub_1000F790+88j
		mov	edi, [esi+0F4h]
		call	sub_10004C40
		test	eax, eax
		jnz	short loc_1000F86B
		push	0FFFFD053h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+0E8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
; ---------------------------------------------------------------------------

loc_1000F86B:				; CODE XREF: sub_1000F790+B1j
		push	ebp
		test	ebx, ebx
		jnz	short loc_1000F8C6
		mov	ebx, [esp+0F8h+var_D4]
		mov	[esp+0F8h+var_E0], 16h

loc_1000F87C:				; CODE XREF: sub_1000F790+747j
		mov	esi, [esp+0F8h+var_E8]
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F896
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1000F896:				; CODE XREF: sub_1000F790+F4j
		mov	eax, [esp+0F8h+var_E0]
		sub	eax, 14h
		jz	loc_1000FF31
		dec	eax
		jz	loc_1000FF26
		dec	eax
		jz	loc_1000FF07
		push	0FFFFD037h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	loc_1000FF3A
; ---------------------------------------------------------------------------

loc_1000F8C6:				; CODE XREF: sub_1000F790+DEj
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F8DB
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1000F8DB:				; CODE XREF: sub_1000F790+13Aj
		cmp	dword ptr [esi+2F38h], 1
		mov	ebp, [esi+448h]
		mov	edi, [ebp+0]
		mov	[esp+0F8h+var_CC], edi
		jnz	loc_1000F97C
		mov	cx, [ebp+1210h]
		cmp	cx, [ebx+0Ah]
		jz	short loc_1000F929
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F917
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000F917:				; CODE XREF: sub_1000F790+176j
					; sub_1000F790+5CFj
		mov	eax, [esp+0F8h+var_D4]
		mov	dword ptr [eax+4], 0

loc_1000F922:				; CODE XREF: sub_1000F790+755j
		xor	eax, eax
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000F929:				; CODE XREF: sub_1000F790+170j
		movzx	eax, word ptr [ebx+8]
		mov	edx, [ebx+0Ch]
		xor	ebx, ebx
		or	eax, ebx
		xor	ecx, ecx
		push	eax
		or	ecx, edx
		mov	[esp+0FCh+var_BC], eax
		push	ecx
		lea	eax, [ebp+1218h]
		push	eax
		mov	[esp+104h+var_C0], ecx
		call	sub_10002670
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F978
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000F96A
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000F96A:				; CODE XREF: sub_1000F790+1C9j
		mov	edx, [esp+0F8h+var_D4]
		mov	[edx+4], ebx
		xor	eax, eax
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000F978:				; CODE XREF: sub_1000F790+1C3j
		mov	ebx, [esp+0F8h+var_DC]

loc_1000F97C:				; CODE XREF: sub_1000F790+15Fj
		mov	ecx, [edi+10h]
		mov	eax, [ebp+0Ch]
		mov	[esp+0F8h+var_D8], 0FFFFFFFFh
		cmp	ecx, 1
		jnz	short loc_1000F9A0
		mov	edx, 302h
		inc	eax
		cmp	[ebp+58h], dx
		jb	short loc_1000F9AB
		add	eax, [edi+14h]
		jmp	short loc_1000F9AB
; ---------------------------------------------------------------------------

loc_1000F9A0:				; CODE XREF: sub_1000F790+1FDj
		cmp	ecx, 2
		jnz	short loc_1000F9AB
		mov	eax, [edi+20h]
		add	eax, [edi+1Ch]

loc_1000F9AB:				; CODE XREF: sub_1000F790+209j
					; sub_1000F790+20Ej ...
		mov	edx, [ebx+10h]
		cmp	[edx+4], eax
		jb	loc_1000FD3F
		cmp	ecx, 1
		jnz	short loc_1000F9FD
		mov	eax, 302h
		cmp	[ebp+58h], ax
		jb	short loc_1000F9FD
		mov	eax, [edi+14h]
		lea	ecx, [eax-8]
		mov	[esp+0F8h+var_E0], eax
		cmp	ecx, 10h
		ja	short loc_1000FA12
		mov	edx, [edx]
		push	eax
		push	edx
		mov	edx, [ebp+24h]
		push	18h
		lea	eax, [esp+104h+var_C4]
		push	eax
		mov	eax, [ebp+14h]
		lea	ecx, [esp+108h+var_5C]
		push	ecx
		push	edx
		call	eax
		dec	eax
		add	esp, 18h
		sar	eax, 1Fh
		mov	[esp+0F8h+var_D8], eax

loc_1000F9FD:				; CODE XREF: sub_1000F790+22Aj
					; sub_1000F790+235j
		xor	eax, eax
		cmp	[ebp+2Ch], eax
		jz	short loc_1000FA3E
		mov	[esp+0F8h+var_B8], eax
		mov	[esp+0F8h+var_B0], eax
		lea	esi, [esp+0F8h+var_B8]
		jmp	short loc_1000FA42
; ---------------------------------------------------------------------------

loc_1000FA12:				; CODE XREF: sub_1000F790+244j
		mov	eax, esi
		test	byte ptr [eax+16h], 1
		jnz	short loc_1000FA29
		mov	ecx, [eax+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000FA29:				; CODE XREF: sub_1000F790+288j
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FA3E:				; CODE XREF: sub_1000F790+272j
		mov	esi, [esp+0F8h+var_D4]

loc_1000FA42:				; CODE XREF: sub_1000F790+280j
		cmp	dword ptr [esi+8], 4000h
		mov	[esp+0F8h+var_E4], esi
		mov	[esi+4], eax
		jnb	short loc_1000FA89
		push	4800h
		push	esi
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_1000FA89
		mov	eax, [esp+0F8h+var_E8]
		test	byte ptr [eax+16h], 1
		jnz	loc_1000FECA
		mov	edx, [eax+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FA89:				; CODE XREF: sub_1000F790+2C0j
					; sub_1000F790+2D2j
		mov	ecx, [esp+0F8h+var_DC]
		mov	ebx, [esp+0F8h+var_E0]
		mov	eax, 300h
		cmp	ax, [ebp+58h]
		sbb	eax, eax
		neg	eax
		mov	[esp+0F8h+var_D0], eax
		jz	short loc_1000FAD6
		mov	edx, [ecx+10h]
		mov	eax, [edx+4]
		sub	eax, ebx
		cmp	eax, 4800h
		jbe	short loc_1000FAD6
		mov	esi, [esp+0F8h+var_E8]
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000FACC
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000FACC:				; CODE XREF: sub_1000F790+32Bj
		push	16h
		push	2
		push	esi
		jmp	loc_1000FEB8
; ---------------------------------------------------------------------------

loc_1000FAD6:				; CODE XREF: sub_1000F790+312j
					; sub_1000F790+321j
		mov	eax, [edi+10h]
		mov	edx, [ecx]
		mov	[esp+0F8h+var_E0], edx
		cmp	eax, 2
		jnz	loc_1000FB8A
		mov	eax, [ecx+10h]
		mov	eax, [eax+4]
		sub	eax, [edi+20h]
		mov	edx, [esp+0F8h+var_E8]
		mov	edx, [edx+2F38h]
		sub	eax, [edi+1Ch]
		cmp	edx, 1
		jnz	short loc_1000FB0B
		mov	esi, [ecx+8]
		mov	ecx, [ecx+0Ch]
		jmp	short loc_1000FB11
; ---------------------------------------------------------------------------

loc_1000FB0B:				; CODE XREF: sub_1000F790+371j
		mov	esi, [ebp+50h]
		mov	ecx, [ebp+54h]

loc_1000FB11:				; CODE XREF: sub_1000F790+379j
		mov	edi, [esp+0F8h+var_D0]
		xor	ebx, ebx
		cmp	edx, 1
		mov	edx, [esp+0F8h+var_E0]
		setz	bl
		push	ebx
		push	edi
		push	edx
		push	ecx
		mov	ebx, eax
		mov	eax, [esp+108h+var_DC]
		mov	cx, [eax+4]
		push	esi
		lea	esi, [esp+10Ch+var_AC]
		call	sub_10004180
		mov	ecx, [esp+10Ch+var_E8]
		add	esp, 14h
		cmp	dword ptr [ecx+4Ch], 0
		lea	edx, [ebp+60h]
		jnz	short loc_1000FB4F
		lea	edx, [ebp+8C8h]

loc_1000FB4F:				; CODE XREF: sub_1000F790+3B7j
		mov	ecx, [esp+0F8h+var_DC]
		mov	ecx, [ecx+10h]
		mov	esi, [esp+0F8h+var_E4]
		push	eax
		lea	eax, [esp+0FCh+var_AC]
		push	eax
		mov	eax, [ecx+4]
		mov	ecx, [ecx]
		push	eax
		mov	eax, [esi+8]
		push	ecx
		mov	ecx, [esi]
		push	eax
		lea	eax, [esi+4]
		push	eax
		push	ecx
		push	1
		push	edx
		mov	edx, [ebp+18h]
		call	edx
		add	esp, 24h
		test	eax, eax
		jnz	loc_1000FD3F
		jmp	loc_1000FD38
; ---------------------------------------------------------------------------

loc_1000FB8A:				; CODE XREF: sub_1000F790+352j
		cmp	eax, 1
		jnz	short loc_1000FBAC
		mov	eax, [ecx+10h]
		mov	eax, [eax+4]
		sub	eax, ebx
		xor	edx, edx
		div	dword ptr [edi+18h]
		test	edx, edx
		jnz	loc_1000FD3F
		mov	esi, [esp+0F8h+var_E4]
		mov	ecx, [esp+0F8h+var_DC]

loc_1000FBAC:				; CODE XREF: sub_1000F790+3FDj
		mov	ecx, [ecx+10h]
		mov	edx, [ecx+4]
		mov	eax, [ecx]
		mov	ecx, [esi+8]
		sub	edx, ebx
		push	edx
		mov	edx, [esi]
		add	eax, ebx
		push	eax
		push	ecx
		mov	ecx, [ebp+14h]
		lea	eax, [esi+4]
		push	eax
		mov	eax, [ebp+24h]
		push	edx
		push	eax
		call	ecx
		add	esp, 18h
		test	eax, eax
		jnz	loc_1000FD3F
		mov	edi, [esp+0F8h+var_E4]
		mov	eax, [esp+0F8h+var_CC]
		cmp	dword ptr [eax+10h], 1
		mov	edx, [edi+4]
		mov	[esp+0F8h+var_C4], edx
		jnz	short loc_1000FC13
		cmp	[esp+0F8h+var_D0], 0
		mov	edx, [eax+18h]
		mov	eax, [ebp+0Ch]
		jnz	short loc_1000FC02
		call	sub_10007080
		jmp	short loc_1000FC0B
; ---------------------------------------------------------------------------

loc_1000FC02:				; CODE XREF: sub_1000F790+469j
		push	edi
		call	sub_100070C0
		add	esp, 4

loc_1000FC0B:				; CODE XREF: sub_1000F790+470j
		dec	eax
		sar	eax, 1Fh
		and	[esp+0F8h+var_D8], eax

loc_1000FC13:				; CODE XREF: sub_1000F790+45Cj
		mov	eax, [esp+0F8h+var_E8]
		mov	ecx, [eax+2F38h]
		cmp	ecx, 1
		jnz	short loc_1000FC2E
		mov	edx, [esp+0F8h+var_DC]
		mov	eax, [edx+8]
		mov	esi, [edx+0Ch]
		jmp	short loc_1000FC34
; ---------------------------------------------------------------------------

loc_1000FC2E:				; CODE XREF: sub_1000F790+490j
		mov	eax, [ebp+50h]
		mov	esi, [ebp+54h]

loc_1000FC34:				; CODE XREF: sub_1000F790+49Cj
		mov	edi, [esp+0F8h+var_E4]
		mov	ebx, [edi+4]
		sub	ebx, [ebp+0Ch]
		xor	edx, edx
		cmp	ecx, 1
		mov	ecx, [esp+0F8h+var_D0]
		setz	dl
		push	edx
		mov	edx, [esp+0FCh+var_E0]
		push	ecx
		push	edx
		push	esi
		push	eax
		mov	eax, [esp+10Ch+var_DC]
		mov	cx, [eax+4]
		lea	esi, [esp+10Ch+var_AC]
		call	sub_10004180
		mov	ecx, [esp+10Ch+var_CC]
		add	esp, 14h
		cmp	dword ptr [ecx+10h], 1
		jnz	short loc_1000FCC9
		mov	esi, [esp+0F8h+var_C4]
		lea	edx, [esp+0F8h+var_9C]
		push	edx
		push	esi
		mov	ecx, edi
		mov	edx, [ecx]
		push	edx
		mov	edx, [esp+104h+var_E8]
		xor	ecx, ecx
		cmp	[edx+4Ch], ecx
		push	eax
		setz	cl
		lea	eax, [esp+108h+var_AC]
		push	eax
		mov	eax, [edi+4]
		lea	ebx, [esp+10Ch+var_C8]
		push	ecx
		mov	ecx, ebp
		call	sub_10004B10
		mov	ebx, eax
		lea	eax, [esp+110h+var_44]
		push	eax
		push	esi
		mov	esi, [ebp+0Ch]
		mov	ecx, edi
		push	ecx
		call	sub_10007160
		mov	edx, [ebp+0Ch]
		add	esp, 24h
		sub	[edi+4], edx
		lea	eax, [esp+0F8h+var_44]
		jmp	short loc_1000FD0C
; ---------------------------------------------------------------------------

loc_1000FCC9:				; CODE XREF: sub_1000F790+4DFj
		mov	edi, [esp+0F8h+var_E4]
		mov	ecx, [ebp+0Ch]
		sub	[edi+4], ecx
		mov	ecx, [edi+4]
		lea	esi, [edi+4]
		lea	edx, [esp+0F8h+var_C8]
		push	edx
		mov	edx, [esp+0FCh+var_E8]
		push	ecx
		xor	ecx, ecx
		cmp	[edx+4Ch], ecx
		push	eax
		setz	cl
		lea	eax, [esp+104h+var_AC]
		push	eax
		lea	edx, [esp+108h+var_9C]
		push	ecx
		mov	ecx, [edi]
		mov	edi, ebp
		call	sub_100047D0
		mov	ebx, eax
		mov	eax, [esp+10Ch+var_E4]
		mov	eax, [eax]
		add	esp, 14h
		add	eax, [esi]

loc_1000FD0C:				; CODE XREF: sub_1000F790+537j
		mov	ecx, [ebp+0Ch]
		dec	ebx
		sar	ebx, 1Fh
		and	[esp+0F8h+var_D8], ebx
		cmp	[esp+0F8h+var_C8], ecx
		jnz	short loc_1000FD3F
		push	ecx
		lea	ecx, [esp+0FCh+var_9C]
		push	ecx
		push	eax
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000FD3F
		mov	esi, [esp+0F8h+var_E4]
		mov	edi, [esp+0F8h+var_D0]

loc_1000FD38:				; CODE XREF: sub_1000F790+3F5j
		cmp	[esp+0F8h+var_D8], 0
		jnz	short loc_1000FD84

loc_1000FD3F:				; CODE XREF: sub_1000F790+221j
					; sub_1000F790+3EFj ...
		mov	esi, [esp+0F8h+var_E8]
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000FD58
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000FD58:				; CODE XREF: sub_1000F790+5B7j
		cmp	dword ptr [esi+2F38h], 1
		jz	loc_1000F917
		push	14h
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD00Fh
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FD84:				; CODE XREF: sub_1000F790+5ADj
		mov	eax, [esp+0F8h+var_E8]
		mov	ebx, 1
		cmp	[eax+2F38h], ebx
		jz	short loc_1000FD9F
		add	[ebp+54h], ebx
		jnz	short loc_1000FDBC
		add	[ebp+50h], ebx
		jmp	short loc_1000FDBC
; ---------------------------------------------------------------------------

loc_1000FD9F:				; CODE XREF: sub_1000F790+603j
		mov	ecx, [esp+0F8h+var_BC]
		mov	edx, [esp+0F8h+var_C0]
		push	ecx
		push	edx
		lea	eax, [ebp+1218h]
		push	eax
		call	sub_100026E0
		mov	eax, [esp+104h+var_E8]
		add	esp, 0Ch

loc_1000FDBC:				; CODE XREF: sub_1000F790+608j
					; sub_1000F790+60Dj
		test	[eax+16h], bl
		jnz	short loc_1000FDD0
		mov	ecx, [eax+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_1000FDD0:				; CODE XREF: sub_1000F790+62Fj
		cmp	dword ptr [ebp+2Ch], 0
		mov	ebx, [esp+0F8h+var_D4]
		jz	loc_1000FEA2
		mov	eax, [esi+4]
		add	eax, 1Dh
		cmp	[ebx+8], eax
		jnb	short loc_1000FE0A
		push	eax
		push	ebx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_1000FE0A
		mov	edx, [esi]
		push	edx
		call	PORT_Free_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FE0A:				; CODE XREF: sub_1000F790+657j
					; sub_1000F790+665j
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	edx, [ebx+8]
		push	eax
		push	ecx
		mov	ecx, [ebx]
		push	edx
		mov	edx, [ebp+3Ch]
		lea	eax, [ebx+4]
		push	eax
		mov	eax, [ebp+2Ch]
		push	ecx
		push	edx
		call	eax
		add	esp, 18h
		test	eax, eax
		jz	short loc_1000FE97
		push	0FFFFD06Fh
		call	sub_100147C0
		mov	ecx, [esp+0FCh+var_E8]
		neg	edi
		sbb	edi, edi
		and	edi, 0Ah
		add	edi, 14h
		push	edi
		push	2
		push	ecx
		mov	ebx, eax
		call	sub_10008960
		mov	eax, [esi+4]
		add	esp, 10h
		cmp	eax, 4
		jb	short loc_1000FE7E
		mov	ecx, [esi]
		movzx	edx, byte ptr [ecx+1]
		movzx	edi, byte ptr [ecx+2]
		movzx	ecx, byte ptr [ecx+3]
		shl	edx, 8
		or	edx, edi
		shl	edx, 8
		or	edx, ecx
		add	eax, 0FFFFFFFCh
		cmp	edx, eax
		jnz	short loc_1000FE7E
		mov	ebx, 0FFFFD072h

loc_1000FE7E:				; CODE XREF: sub_1000F790+6C8j
					; sub_1000F790+6E7j
		mov	edx, [esi]
		push	edx
		call	PORT_Free_Util
		push	ebx
		call	PORT_SetError_Util
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FE97:				; CODE XREF: sub_1000F790+69Aj
		mov	eax, [esi]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1000FEA2:				; CODE XREF: sub_1000F790+648j
		test	edi, edi
		jz	short loc_1000FED2
		cmp	dword ptr [ebx+4], 4400h
		jbe	short loc_1000FED2
		mov	ecx, [esp+0F8h+var_E8]
		push	16h
		push	2
		push	ecx

loc_1000FEB8:				; CODE XREF: sub_1000F790+341j
		call	sub_10008960
		push	0FFFFD019h
		call	PORT_SetError_Util
		add	esp, 10h

loc_1000FECA:				; CODE XREF: sub_1000F790+2DCj
		or	eax, 0FFFFFFFFh
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FED2:				; CODE XREF: sub_1000F790+714j
					; sub_1000F790+71Dj
		cmp	[esp+0F8h+var_E0], 17h
		jnz	loc_1000F87C
		mov	eax, [esp+0F8h+var_E8]
		cmp	dword ptr [eax+24h], 0
		jnz	loc_1000F922
		push	0Ah
		push	2
		push	eax
		call	sub_10008960
		push	0FFFFD036h
		call	PORT_SetError_Util
		add	esp, 10h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FF07:				; CODE XREF: sub_1000F790+11Bj
		cmp	dword ptr [esi+2F38h], 1
		push	ebx
		jz	short loc_1000FF1B
		call	sub_1000F5D0
		add	esp, 4
		jmp	short loc_1000FF38
; ---------------------------------------------------------------------------

loc_1000FF1B:				; CODE XREF: sub_1000F790+77Fj
		push	esi
		call	sub_10002B90
		add	esp, 8
		jmp	short loc_1000FF38
; ---------------------------------------------------------------------------

loc_1000FF26:				; CODE XREF: sub_1000F790+114j
		mov	ecx, ebx
		mov	eax, esi
		call	sub_1000D240
		jmp	short loc_1000FF38
; ---------------------------------------------------------------------------

loc_1000FF31:				; CODE XREF: sub_1000F790+10Dj
		mov	eax, ebx
		call	sub_10008D00

loc_1000FF38:				; CODE XREF: sub_1000F790+789j
					; sub_1000F790+794j ...
		mov	edi, eax

loc_1000FF3A:				; CODE XREF: sub_1000F790+131j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1000FF50
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1000FF50:				; CODE XREF: sub_1000F790+7AEj
		mov	eax, edi

loc_1000FF52:				; CODE XREF: sub_1000F790+194j
					; sub_1000F790+1E3j ...
		mov	ecx, [esp+0F8h+var_4]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
sub_1000F790	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FF70	proc near		; CODE XREF: sub_10010190+96p
					; sub_10010450+96p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	edi
		xor	edi, edi
		cmp	[esi], edi
		jnz	short loc_1000FF97
		mov	dword ptr [esi], 1
		mov	dword ptr [esi+14h], 5
		mov	[esi+10h], edi
		mov	[esi+30h], edi
		mov	[esi+2Ch], edi
		mov	[esi+38h], edi

loc_1000FF97:				; CODE XREF: sub_1000FF70+Cj
		mov	eax, [esi+34h]
		lea	ebx, [esi+34h]
		mov	[esp+10h+var_4], eax

loc_1000FFA1:				; CODE XREF: sub_1000FF70+78j
					; sub_1000FF70+80j ...
		cmp	dword ptr [esi], 1
		mov	ecx, [esp+10h+var_4]
		jnz	short loc_1000FFAD
		lea	ecx, [esi+40h]

loc_1000FFAD:				; CODE XREF: sub_1000FF70+38j
		mov	eax, [esi+10h]
		mov	edx, [esi+14h]
		add	eax, ecx
		mov	ecx, [esp+10h+arg_4]
		push	ecx
		push	edx
		push	eax
		push	ebp
		call	sub_100144F0
		add	esp, 10h
		cmp	eax, edi
		jle	loc_1001006C
		mov	ecx, [esi+14h]
		cmp	eax, ecx
		ja	short loc_10010041
		mov	edx, [esi]
		add	[esi+10h], eax
		sub	ecx, eax
		mov	[esi+14h], ecx
		cmp	edx, 3
		jnz	short loc_1000FFE6
		add	[esi+38h], eax

loc_1000FFE6:				; CODE XREF: sub_1000FF70+71j
		cmp	ecx, edi
		ja	short loc_1000FFA1
		dec	edx
		jz	short loc_1000FFFC
		sub	edx, 2
		jnz	short loc_1000FFA1
		mov	[esi], edi
		pop	edi
		pop	ebp
		lea	eax, [edx+1]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000FFFC:				; CODE XREF: sub_1000FF70+7Bj
		movzx	eax, byte ptr [esi+43h]
		movzx	ecx, byte ptr [esi+44h]
		shl	eax, 8
		or	eax, ecx
		mov	[esi+14h], eax
		cmp	eax, 4805h
		ja	short loc_1001004B
		mov	dword ptr [esi], 3
		mov	[esi+10h], edi
		mov	[esi+38h], edi
		cmp	eax, [esi+3Ch]
		jbe	loc_1000FFA1
		push	eax
		push	ebx
		call	sub_10018960
		add	esp, 8
		cmp	eax, edi
		jnz	short loc_10010070
		mov	edx, [ebx]
		mov	[esp+10h+var_4], edx
		jmp	loc_1000FFA1
; ---------------------------------------------------------------------------

loc_10010041:				; CODE XREF: sub_1000FF70+62j
		mov	[esi], edi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001004B:				; CODE XREF: sub_1000FF70+A1j
		push	0Ah
		push	2
		push	ebp
		call	sub_10008960
		push	0FFFFD019h
		mov	[esi], edi
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001006C:				; CODE XREF: sub_1000FF70+57j
		neg	eax
		sbb	eax, eax

loc_10010070:				; CODE XREF: sub_1000FF70+C4j
		pop	edi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1000FF70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010080	proc near		; CODE XREF: sub_10010190+A8p
					; sub_10010450+A8p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esi+5Ch]
		push	edi
		xor	edi, edi
		mov	dword ptr [esi], 1
		mov	[esi+10h], edi
		cmp	eax, [esi+54h]
		jnz	short loc_100100DD
		cmp	dword ptr [esi+58h], 480Dh
		mov	[esi+5Ch], edi
		mov	[esi+54h], edi
		jnb	short loc_100100BC
		lea	ecx, [esi+50h]
		push	480Dh
		push	ecx
		call	sub_10018960
		add	esp, 8
		cmp	eax, edi
		jnz	loc_10010186

loc_100100BC:				; CODE XREF: sub_10010080+21j
		mov	edx, [esp+4+arg_4]
		mov	eax, [esi+58h]
		mov	ecx, [esi+50h]
		push	edx
		mov	edx, [esp+8+arg_0]
		push	eax
		push	ecx
		push	edx
		call	sub_100144F0
		add	esp, 10h
		cmp	eax, edi
		jle	short loc_10010106
		mov	[esi+54h], eax

loc_100100DD:				; CODE XREF: sub_10010080+12j
		mov	ecx, [esi+54h]
		mov	edx, [esi+5Ch]
		mov	eax, ecx
		sub	eax, edx
		cmp	eax, 0Dh
		jnb	short loc_1001010C

loc_100100EC:				; CODE XREF: sub_10010080+C4j
		push	edi
		push	0FFFFE892h
		call	ds:PR_SetError
		add	esp, 8
		mov	[esi+5Ch], edi
		mov	[esi+54h], edi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10010106:				; CODE XREF: sub_10010080+58j
		neg	eax
		sbb	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001010C:				; CODE XREF: sub_10010080+6Aj
		mov	eax, [esi+50h]
		add	eax, edx
		push	ebx
		mov	ebx, [eax]
		mov	[esi+40h], ebx
		mov	ebx, [eax+4]
		mov	[esi+44h], ebx
		mov	ebx, [eax+8]
		mov	[esi+48h], ebx
		mov	al, [eax+0Ch]
		mov	[esi+4Ch], al
		movzx	eax, byte ptr [esi+4Bh]
		movzx	ebx, byte ptr [esi+4Ch]
		add	edx, 0Dh
		shl	eax, 8
		or	eax, ebx
		sub	ecx, edx
		mov	[esi+5Ch], edx
		mov	[esi+14h], eax
		pop	ebx
		cmp	ecx, eax
		jb	short loc_100100EC
		cmp	eax, [esi+3Ch]
		jbe	short loc_1001015C
		push	eax
		lea	ecx, [esi+34h]
		push	ecx
		call	sub_10018960
		add	esp, 8
		cmp	eax, edi
		jnz	short loc_10010186

loc_1001015C:				; CODE XREF: sub_10010080+C9j
		mov	eax, [esi+5Ch]
		mov	edx, [esi+14h]
		add	eax, [esi+50h]
		mov	ecx, [esi+34h]
		push	edx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi+14h]
		add	esp, 0Ch
		add	[esi+5Ch], eax
		mov	[esi+38h], eax
		mov	[esi+10h], eax
		mov	[esi], edi
		mov	eax, 1

loc_10010186:				; CODE XREF: sub_10010080+36j
					; sub_10010080+DAj
		pop	edi
		retn
sub_10010080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010190	proc near		; CODE XREF: sub_10011CC0+3Dp
					; SSL_ForceHandshake+D4p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		mov	ebx, 1
		push	edi
		mov	edi, [esp+28h+arg_0]
		mov	[esp+28h+var_18], ebx
		xor	ebp, ebp

loc_100101A6:				; CODE XREF: sub_10010190+1EFj
		xor	esi, esi
		test	[edi+16h], bl
		jnz	short loc_100101BD
		mov	eax, [edi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100101BD:				; CODE XREF: sub_10010190+1Bj
		cmp	[edi+8C0h], ebp
		jnz	loc_100103F7
		cmp	[edi+848h], ebp
		jz	short loc_100101E3
		cmp	[edi+84Ch], ebp
		jnz	short loc_100101E1
		mov	[edi+848h], ebp
		jmp	short loc_100101E3
; ---------------------------------------------------------------------------

loc_100101E1:				; CODE XREF: sub_10010190+47j
		mov	esi, ebx

loc_100101E3:				; CODE XREF: sub_10010190+3Fj
					; sub_10010190+4Fj
		test	[edi+16h], bl
		jnz	short loc_100101F8
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100101F8:				; CODE XREF: sub_10010190+56j
		cmp	esi, ebp
		jz	short loc_10010209
		lea	edx, [edi+278h]
		push	edx
		push	ebp
		jmp	loc_10010306
; ---------------------------------------------------------------------------

loc_10010209:				; CODE XREF: sub_10010190+6Aj
		cmp	[edi+34h], ebp
		jnz	loc_10010424
		lea	esi, [edi+274h]
		cmp	[edi+2F38h], ebx
		jz	short loc_10010232
		mov	eax, [esp+28h+arg_4]
		push	eax
		push	edi
		call	sub_1000FF70
		add	esp, 8
		mov	esi, eax
		jmp	short loc_1001024B
; ---------------------------------------------------------------------------

loc_10010232:				; CODE XREF: sub_10010190+8Ej
		mov	ecx, [esp+28h+arg_4]
		push	ecx
		push	edi
		call	sub_10010080
		mov	esi, eax
		add	esp, 8
		cmp	esi, 0FFFFFFFFh
		jz	loc_100103A1

loc_1001024B:				; CODE XREF: sub_10010190+A0j
		cmp	esi, ebp
		jle	loc_100103ED
		movzx	eax, byte ptr [edi+2B5h]
		movzx	ecx, byte ptr [edi+2B6h]
		movzx	edx, byte ptr [edi+2B4h]
		shl	ax, 8
		or	ax, cx
		mov	[esp+28h+var_14], edx
		mov	word ptr [esp+28h+var_10], ax
		cmp	[edi+2F38h], ebx
		jnz	short loc_100102F0
		mov	edx, [esp+28h+var_10]
		push	edx
		call	sub_100021B0
		movzx	edx, byte ptr [edi+2B8h]
		movzx	ecx, byte ptr [edi+2BBh]
		mov	word ptr [esp+2Ch+var_10], ax
		movzx	eax, byte ptr [edi+2B7h]
		shl	eax, 8
		or	eax, edx
		movzx	edx, byte ptr [edi+2BCh]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [edi+2B9h]
		shl	eax, 8
		or	eax, edx
		movzx	edx, byte ptr [edi+2BDh]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [edi+2BAh]
		shl	eax, 8
		or	eax, edx
		mov	[esp+2Ch+var_C], eax
		movzx	eax, byte ptr [edi+2BEh]
		shl	ecx, 8
		add	esp, 4
		or	ecx, eax
		mov	[esp+28h+var_8], ecx

loc_100102F0:				; CODE XREF: sub_10010190+EEj
		lea	edx, [edi+278h]
		lea	ecx, [edi+2A8h]
		push	edx
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_4], ecx
		push	eax

loc_10010306:				; CODE XREF: sub_10010190+74j
		push	edi
		call	sub_1000F790
		mov	ecx, eax
		add	esp, 0Ch
		cmp	ecx, ebp
		jl	loc_1001042E
		cmp	[edi+27Ch], ebp
		ja	short loc_10010385
		test	[edi+16h], bl
		jnz	short loc_10010336
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10010336:				; CODE XREF: sub_10010190+194j
		cmp	dword ptr [edi+4C0h], 0Dh
		jnz	short loc_10010345
		mov	[esp+28h+var_18], ebp
		jmp	short loc_10010366
; ---------------------------------------------------------------------------

loc_10010345:				; CODE XREF: sub_10010190+1ADj
		cmp	[edi+8C8h], ebp
		jz	short loc_10010366
		push	edi
		call	sub_10006640
		add	esp, 4
		test	eax, eax
		jz	short loc_10010360
		mov	[esp+28h+var_18], ebp
		jmp	short loc_10010366
; ---------------------------------------------------------------------------

loc_10010360:				; CODE XREF: sub_10010190+1C8j
		mov	[edi+8C8h], ebp

loc_10010366:				; CODE XREF: sub_10010190+1B3j
					; sub_10010190+1BBj ...
		test	[edi+16h], bl
		jnz	short loc_1001037B
		mov	edx, [edi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001037B:				; CODE XREF: sub_10010190+1D9j
		cmp	[esp+28h+var_18], ebp
		jnz	loc_100101A6

loc_10010385:				; CODE XREF: sub_10010190+18Fj
		mov	eax, [edi+27Ch]
		mov	[edi+2A0h], ebp
		mov	[edi+2A4h], eax
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_100103A1:				; CODE XREF: sub_10010190+B5j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_100103ED
		test	[edi+16h], bl
		jnz	short loc_100103C2
		mov	eax, [edi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100103C2:				; CODE XREF: sub_10010190+220j
		push	edi
		call	sub_10002400
		add	esp, 4
		test	[edi+16h], bl
		jnz	short loc_100103E0
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100103E0:				; CODE XREF: sub_10010190+23Ej
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4

loc_100103ED:				; CODE XREF: sub_10010190+BDj
					; sub_10010190+21Bj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_100103F7:				; CODE XREF: sub_10010190+33j
		test	[edi+16h], bl
		jnz	short loc_1001040C
		mov	edx, [edi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001040C:				; CODE XREF: sub_10010190+26Aj
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10010424:				; CODE XREF: sub_10010190+7Cj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1001042E:				; CODE XREF: sub_10010190+183j
		mov	eax, [edi+34h]
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		not	eax
		pop	ebp
		and	eax, ecx
		pop	ebx
		add	esp, 18h
		retn
sub_10010190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010450	proc near		; CODE XREF: sub_10018AA0+4Ep

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+24h+arg_0]
		mov	ebx, 1
		xor	ebp, ebp

loc_10010462:				; CODE XREF: sub_10010450+263j
		mov	[esp+24h+arg_0], ebx

loc_10010466:				; CODE XREF: sub_10010450+1EFj
		xor	esi, esi
		test	[edi+16h], bl
		jnz	short loc_1001047D
		mov	eax, [edi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001047D:				; CODE XREF: sub_10010450+1Bj
		cmp	[edi+8C0h], ebp
		jnz	loc_100106CE
		cmp	[edi+848h], ebp
		jz	short loc_100104A3
		cmp	[edi+84Ch], ebp
		jnz	short loc_100104A1
		mov	[edi+848h], ebp
		jmp	short loc_100104A3
; ---------------------------------------------------------------------------

loc_100104A1:				; CODE XREF: sub_10010450+47j
		mov	esi, ebx

loc_100104A3:				; CODE XREF: sub_10010450+3Fj
					; sub_10010450+4Fj
		test	[edi+16h], bl
		jnz	short loc_100104B8
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100104B8:				; CODE XREF: sub_10010450+56j
		cmp	esi, ebp
		jz	short loc_100104C9
		lea	edx, [edi+278h]
		push	edx
		push	ebp
		jmp	loc_100105C6
; ---------------------------------------------------------------------------

loc_100104C9:				; CODE XREF: sub_10010450+6Aj
		cmp	[edi+34h], ebp
		jnz	loc_100106FB
		lea	esi, [edi+274h]
		cmp	[edi+2F38h], ebx
		jz	short loc_100104F2
		mov	eax, [esp+24h+arg_4]
		push	eax
		push	edi
		call	sub_1000FF70
		add	esp, 8
		mov	esi, eax
		jmp	short loc_1001050B
; ---------------------------------------------------------------------------

loc_100104F2:				; CODE XREF: sub_10010450+8Ej
		mov	ecx, [esp+24h+arg_4]
		push	ecx
		push	edi
		call	sub_10010080
		mov	esi, eax
		add	esp, 8
		cmp	esi, 0FFFFFFFFh
		jz	loc_1001065B

loc_1001050B:				; CODE XREF: sub_10010450+A0j
		cmp	esi, ebp
		jle	loc_100106A7
		movzx	eax, byte ptr [edi+2B5h]
		movzx	ecx, byte ptr [edi+2B6h]
		movzx	edx, byte ptr [edi+2B4h]
		shl	ax, 8
		or	ax, cx
		mov	[esp+24h+var_14], edx
		mov	word ptr [esp+24h+var_10], ax
		cmp	[edi+2F38h], ebx
		jnz	short loc_100105B0
		mov	edx, [esp+24h+var_10]
		push	edx
		call	sub_100021B0
		movzx	edx, byte ptr [edi+2B8h]
		movzx	ecx, byte ptr [edi+2BBh]
		mov	word ptr [esp+28h+var_10], ax
		movzx	eax, byte ptr [edi+2B7h]
		shl	eax, 8
		or	eax, edx
		movzx	edx, byte ptr [edi+2BCh]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [edi+2B9h]
		shl	eax, 8
		or	eax, edx
		movzx	edx, byte ptr [edi+2BDh]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [edi+2BAh]
		shl	eax, 8
		or	eax, edx
		mov	[esp+28h+var_C], eax
		movzx	eax, byte ptr [edi+2BEh]
		shl	ecx, 8
		add	esp, 4
		or	ecx, eax
		mov	[esp+24h+var_8], ecx

loc_100105B0:				; CODE XREF: sub_10010450+EEj
		lea	edx, [edi+278h]
		lea	ecx, [edi+2A8h]
		push	edx
		lea	eax, [esp+28h+var_14]
		mov	[esp+28h+var_4], ecx
		push	eax

loc_100105C6:				; CODE XREF: sub_10010450+74j
		push	edi
		call	sub_1000F790
		mov	ecx, eax
		add	esp, 0Ch
		cmp	ecx, ebp
		jl	loc_100106C1
		cmp	[edi+27Ch], ebp
		ja	short loc_10010645
		test	[edi+16h], bl
		jnz	short loc_100105F6
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100105F6:				; CODE XREF: sub_10010450+194j
		cmp	dword ptr [edi+4C0h], 0Dh
		jnz	short loc_10010605
		mov	[esp+24h+arg_0], ebp
		jmp	short loc_10010626
; ---------------------------------------------------------------------------

loc_10010605:				; CODE XREF: sub_10010450+1ADj
		cmp	[edi+8C8h], ebp
		jz	short loc_10010626
		push	edi
		call	sub_10006640
		add	esp, 4
		test	eax, eax
		jz	short loc_10010620
		mov	[esp+24h+arg_0], ebp
		jmp	short loc_10010626
; ---------------------------------------------------------------------------

loc_10010620:				; CODE XREF: sub_10010450+1C8j
		mov	[edi+8C8h], ebp

loc_10010626:				; CODE XREF: sub_10010450+1B3j
					; sub_10010450+1BBj ...
		test	[edi+16h], bl
		jnz	short loc_1001063B
		mov	edx, [edi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001063B:				; CODE XREF: sub_10010450+1D9j
		cmp	[esp+24h+arg_0], ebp
		jnz	loc_10010466

loc_10010645:				; CODE XREF: sub_10010450+18Fj
		mov	edx, [edi+27Ch]
		mov	[edi+2A0h], ebp
		mov	[edi+2A4h], edx
		mov	eax, ebx
		jmp	short loc_100106AD
; ---------------------------------------------------------------------------

loc_1001065B:				; CODE XREF: sub_10010450+B5j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_100106A7
		test	[edi+16h], bl
		jnz	short loc_1001067C
		mov	eax, [edi+258h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001067C:				; CODE XREF: sub_10010450+21Aj
		push	edi
		call	sub_10002400
		add	esp, 4
		test	[edi+16h], bl
		jnz	short loc_1001069A
		mov	ecx, [edi+258h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001069A:				; CODE XREF: sub_10010450+238j
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4

loc_100106A7:				; CODE XREF: sub_10010450+BDj
					; sub_10010450+215j
		mov	eax, esi

loc_100106A9:				; CODE XREF: sub_10010450+27Cj
		cmp	eax, ebp
		jle	short loc_100106FD

loc_100106AD:				; CODE XREF: sub_10010450+209j
		cmp	[edi+27Ch], ebp
		jz	loc_10010462
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100106C1:				; CODE XREF: sub_10010450+183j
		mov	eax, [edi+34h]
		neg	eax
		sbb	eax, eax
		not	eax
		and	eax, ecx
		jmp	short loc_100106A9
; ---------------------------------------------------------------------------

loc_100106CE:				; CODE XREF: sub_10010450+33j
		test	[edi+16h], bl
		jnz	short loc_100106E3
		mov	eax, [edi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100106E3:				; CODE XREF: sub_10010450+281j
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100106FB:				; CODE XREF: sub_10010450+7Cj
		xor	eax, eax

loc_100106FD:				; CODE XREF: sub_10010450+25Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10010450	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  56. SSL_PeerCertificate

; =============== S U B	R O U T	I N E =======================================


		public SSL_PeerCertificate
SSL_PeerCertificate proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_10010737
		test	byte ptr [eax+14h], 1
		jz	short loc_10010737
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_10010737
		mov	[esp+arg_0], eax
		jmp	CERT_DupCertificate
; ---------------------------------------------------------------------------

loc_10010737:				; CODE XREF: SSL_PeerCertificate+Fj
					; SSL_PeerCertificate+15j ...
		xor	eax, eax
		retn
SSL_PeerCertificate endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  57. SSL_PeerCertificateChain

; =============== S U B	R O U T	I N E =======================================


		public SSL_PeerCertificateChain
SSL_PeerCertificateChain proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100107CD
		test	byte ptr [esi+14h], 1
		jz	short loc_100107C0
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_100107C0
		push	edi
		call	CERT_NewCertList
		mov	edi, eax
		test	edi, edi
		jz	short loc_100107BB
		mov	ecx, [esi+6Ch]
		push	ecx
		call	CERT_DupCertificate
		push	eax
		push	edi
		call	CERT_AddCertToListTail
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100107B2
		mov	esi, [esi+470h]
		test	esi, esi
		jz	short loc_100107AD
		lea	ecx, [ecx+0]

loc_10010790:				; CODE XREF: SSL_PeerCertificateChain+6Bj
		mov	edx, [esi+4]
		push	edx
		call	CERT_DupCertificate
		push	eax
		push	edi
		call	CERT_AddCertToListTail
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100107B2
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10010790

loc_100107AD:				; CODE XREF: SSL_PeerCertificateChain+4Bj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100107B2:				; CODE XREF: SSL_PeerCertificateChain+41j
					; SSL_PeerCertificateChain+65j
		push	edi
		call	CERT_DestroyCertList
		add	esp, 4

loc_100107BB:				; CODE XREF: SSL_PeerCertificateChain+2Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100107C0:				; CODE XREF: SSL_PeerCertificateChain+18j
					; SSL_PeerCertificateChain+1Ej
		push	0FFFFD003h
		call	PORT_SetError_Util
		add	esp, 4

loc_100107CD:				; CODE XREF: SSL_PeerCertificateChain+12j
		xor	eax, eax
		pop	esi
		retn
SSL_PeerCertificateChain endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  50. SSL_LocalCertificate

; =============== S U B	R O U T	I N E =======================================


		public SSL_LocalCertificate
SSL_LocalCertificate proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_10010821
		test	byte ptr [eax+14h], 1
		jz	short loc_10010821
		mov	ecx, [eax+68h]
		test	ecx, ecx
		jz	short loc_10010807
		mov	[esp+arg_0], ecx
		jmp	CERT_DupCertificate
; ---------------------------------------------------------------------------

loc_10010807:				; CODE XREF: SSL_LocalCertificate+1Cj
		mov	eax, [eax+0F4h]
		test	eax, eax
		jz	short loc_10010821
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_10010821
		mov	[esp+arg_0], eax
		jmp	CERT_DupCertificate
; ---------------------------------------------------------------------------

loc_10010821:				; CODE XREF: SSL_LocalCertificate+Fj
					; SSL_LocalCertificate+15j ...
		xor	eax, eax
		retn
SSL_LocalCertificate endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  72. SSL_SecurityStatus

; =============== S U B	R O U T	I N E =======================================


		public SSL_SecurityStatus
SSL_SecurityStatus proc	near		; DATA XREF: .rdata:off_10035848o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		mov	eax, [esp+4+arg_0]
		push	edi
		push	eax
		mov	[esp+0Ch+var_4], 0
		call	sub_1001C160
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10010853
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10010853:				; CODE XREF: SSL_SecurityStatus+1Bj
		mov	eax, [esp+8+arg_8]
		test	eax, eax
		jz	short loc_10010861
		mov	dword ptr [eax], 0

loc_10010861:				; CODE XREF: SSL_SecurityStatus+29j
		push	ebx
		mov	ebx, [esp+0Ch+arg_C]
		push	ebp
		test	ebx, ebx
		jz	short loc_10010871
		mov	dword ptr [ebx], 0

loc_10010871:				; CODE XREF: SSL_SecurityStatus+39j
		mov	ebp, [esp+10h+arg_10]
		test	ebp, ebp
		jz	short loc_10010880
		mov	dword ptr [ebp+0], 0

loc_10010880:				; CODE XREF: SSL_SecurityStatus+47j
		mov	eax, [esp+10h+arg_14]
		test	eax, eax
		jz	short loc_1001088E
		mov	dword ptr [eax], 0

loc_1001088E:				; CODE XREF: SSL_SecurityStatus+56j
		mov	eax, [esp+10h+arg_18]
		test	eax, eax
		jz	short loc_1001089C
		mov	dword ptr [eax], 0

loc_1001089C:				; CODE XREF: SSL_SecurityStatus+64j
		mov	eax, [esp+10h+arg_4]
		test	eax, eax
		jz	short loc_100108AA
		mov	dword ptr [eax], 0

loc_100108AA:				; CODE XREF: SSL_SecurityStatus+72j
		test	byte ptr [edi+14h], 1
		jz	loc_10010A05
		cmp	dword ptr [edi+28h], 0
		jz	loc_10010A05
		mov	ecx, 300h
		push	esi
		cmp	[edi+44h], cx
		jnb	short loc_100108D6
		mov	edx, [edi+5Ch]
		mov	esi, ds:Str[edx*4]
		jmp	short loc_100108E0
; ---------------------------------------------------------------------------

loc_100108D6:				; CODE XREF: SSL_SecurityStatus+98j
		mov	eax, [edi+5Ch]
		mov	esi, ds:off_1002AEC0[eax*4]

loc_100108E0:				; CODE XREF: SSL_SecurityStatus+A4j
		test	esi, esi
		jz	short loc_10010915
		push	offset SubStr	; "DES"
		push	esi		; Str
		call	ds:strstr
		add	esp, 8
		test	eax, eax
		jz	short loc_100108FF
		mov	[esp+14h+var_4], 1

loc_100108FF:				; CODE XREF: SSL_SecurityStatus+C5j
		cmp	[esp+14h+arg_8], 0
		jz	short loc_10010915
		push	esi
		call	PORT_Strdup_Util
		mov	ecx, [esp+18h+arg_8]
		add	esp, 4
		mov	[ecx], eax

loc_10010915:				; CODE XREF: SSL_SecurityStatus+B2j
					; SSL_SecurityStatus+D4j
		test	ebx, ebx
		jz	short loc_10010939
		cmp	[esp+14h+var_4], 0
		mov	ecx, [edi+60h]
		mov	[ebx], ecx
		jz	short loc_10010939
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		mov	[ebx], eax

loc_10010939:				; CODE XREF: SSL_SecurityStatus+E7j
					; SSL_SecurityStatus+F3j
		test	ebp, ebp
		jz	short loc_1001095F
		cmp	[esp+14h+var_4], 0
		mov	ecx, [edi+64h]
		mov	[ebp+0], ecx
		jz	short loc_1001095F
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		mov	[ebp+0], eax

loc_1001095F:				; CODE XREF: SSL_SecurityStatus+10Bj
					; SSL_SecurityStatus+118j
		mov	eax, [esp+14h+arg_4]
		test	eax, eax
		jz	short loc_10010981
		cmp	dword ptr [edi+60h], 0
		jnz	short loc_10010975
		mov	dword ptr [eax], 0
		jmp	short loc_10010981
; ---------------------------------------------------------------------------

loc_10010975:				; CODE XREF: SSL_SecurityStatus+13Bj
		xor	edx, edx
		cmp	dword ptr [edi+64h], 5Ah
		setl	dl
		inc	edx
		mov	[eax], edx

loc_10010981:				; CODE XREF: SSL_SecurityStatus+135j
					; SSL_SecurityStatus+143j
		mov	eax, [esp+14h+arg_14]
		test	eax, eax
		jnz	short loc_1001098F
		cmp	[esp+14h+arg_18], eax
		jz	short loc_10010A04

loc_1001098F:				; CODE XREF: SSL_SecurityStatus+157j
		mov	esi, [edi+6Ch]
		test	esi, esi
		jz	short loc_100109D3
		test	eax, eax
		jz	short loc_100109AF
		lea	eax, [esi+0A8h]
		push	eax
		call	CERT_NameToAscii
		mov	ecx, [esp+18h+arg_14]
		add	esp, 4
		mov	[ecx], eax

loc_100109AF:				; CODE XREF: SSL_SecurityStatus+168j
		cmp	[esp+14h+arg_18], 0
		jz	short loc_10010A04
		add	esi, 0CCh
		push	esi
		call	CERT_NameToAscii
		mov	edx, [esp+18h+arg_18]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		mov	[edx], eax
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100109D3:				; CODE XREF: SSL_SecurityStatus+164j
		test	eax, eax
		jz	short loc_100109EA
		push	offset aNoCertificate ;	"no certificate"
		call	PORT_Strdup_Util
		mov	ecx, [esp+18h+arg_14]
		add	esp, 4
		mov	[ecx], eax

loc_100109EA:				; CODE XREF: SSL_SecurityStatus+1A5j
		cmp	[esp+14h+arg_18], 0
		jz	short loc_10010A04
		push	offset aNoCertificate ;	"no certificate"
		call	PORT_Strdup_Util
		mov	edx, [esp+18h+arg_18]
		mov	[edx], eax
		add	esp, 4

loc_10010A04:				; CODE XREF: SSL_SecurityStatus+15Dj
					; SSL_SecurityStatus+184j ...
		pop	esi

loc_10010A05:				; CODE XREF: SSL_SecurityStatus+7Ej
					; SSL_SecurityStatus+88j
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
SSL_SecurityStatus endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. SSL_AuthCertificateHook

; =============== S U B	R O U T	I N E =======================================


		public SSL_AuthCertificateHook
SSL_AuthCertificateHook	proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jnz	short loc_10010A25
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010A25:				; CODE XREF: SSL_AuthCertificateHook+Fj
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	[eax+1FCh], ecx
		mov	[eax+200h], edx
		xor	eax, eax
		retn
SSL_AuthCertificateHook	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  35. SSL_GetClientAuthDataHook

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetClientAuthDataHook
SSL_GetClientAuthDataHook proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jnz	short loc_10010A55
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010A55:				; CODE XREF: SSL_GetClientAuthDataHook+Fj
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	[eax+204h], ecx
		mov	[eax+208h], edx
		xor	eax, eax
		retn
SSL_GetClientAuthDataHook endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  77. SSL_SetPKCS11PinArg

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetPKCS11PinArg
SSL_SetPKCS11PinArg proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jnz	short loc_10010A85
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010A85:				; CODE XREF: SSL_SetPKCS11PinArg+Fj
		mov	ecx, [esp+arg_4]
		mov	[eax+22Ch], ecx
		xor	eax, eax
		retn
SSL_SetPKCS11PinArg endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. SSL_AuthCertificate

; =============== S U B	R O U T	I N E =======================================


		public SSL_AuthCertificate
SSL_AuthCertificate proc near		; DATA XREF: sub_1001EB40+166o
					; .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		call	ds:PR_Now
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_4]
		push	eax
		mov	ebp, edx
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10010AC7
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10010AC7:				; CODE XREF: SSL_AuthCertificate+1Ej
		push	edi
		mov	edi, [esi+0F4h]
		cmp	dword ptr [edi+18h], 0
		jz	short loc_10010B03
		push	0
		call	PORT_SetError_Util
		mov	ecx, [esi+22Ch]
		mov	edx, [edi+14h]
		mov	eax, [esi+6Ch]
		push	ecx
		mov	ecx, [esp+18h+arg_0]
		push	edx
		push	ebp
		push	ebx
		push	eax
		push	ecx
		call	CERT_CacheOCSPResponseFromSideChannel
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_10010B03
		call	ds:PR_GetError

loc_10010B03:				; CODE XREF: SSL_AuthCertificate+32j
					; SSL_AuthCertificate+5Bj
		mov	edi, [esp+10h+arg_C]
		mov	edx, [esi+22Ch]
		mov	ecx, [esp+10h+arg_8]
		xor	eax, eax
		push	0
		push	edx
		mov	edx, [esi+6Ch]
		test	edi, edi
		setz	al
		push	ebp
		push	ebx
		push	eax
		mov	eax, [esp+24h+arg_0]
		push	ecx
		push	edx
		push	eax
		call	CERT_VerifyCert
		add	esp, 20h
		test	eax, eax
		jnz	short loc_10010B69
		test	edi, edi
		jnz	short loc_10010B69
		mov	eax, [esi+1D8h]
		test	eax, eax
		jz	short loc_10010B6E
		cmp	byte ptr [eax],	0
		jz	short loc_10010B6E
		mov	ecx, [esi+6Ch]
		push	eax
		push	ecx
		call	CERT_VerifyCertName
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10010B67
		push	0FFFFD00Ch
		call	PORT_SetError_Util
		add	esp, 4

loc_10010B67:				; CODE XREF: SSL_AuthCertificate+B8j
		mov	eax, esi

loc_10010B69:				; CODE XREF: SSL_AuthCertificate+92j
					; SSL_AuthCertificate+96j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10010B6E:				; CODE XREF: SSL_AuthCertificate+A0j
					; SSL_AuthCertificate+A5j
		push	0FFFFD00Ch
		or	esi, 0FFFFFFFFh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
SSL_AuthCertificate endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010B90	proc near		; CODE XREF: sub_10012520+28p
					; sub_10012610+21p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		push	ebx
		push	esi
		mov	bl, 80h
		xor	esi, esi
		mov	[esp+10h+var_8], 0
		test	[edi+14h], bl
		jz	short loc_10010BC9
		movzx	eax, word ptr [edi+26Eh]
		movzx	ecx, word ptr [edi+26Ah]
		and	eax, ecx
		and	eax, 0DEh
		jz	short loc_10010BC9
		lea	ecx, [ecx+0]

loc_10010BC0:				; CODE XREF: sub_10010B90+37j
		test	al, 1
		jz	short loc_10010BC5
		inc	esi

loc_10010BC5:				; CODE XREF: sub_10010B90+32j
		shr	eax, 1
		jnz	short loc_10010BC0

loc_10010BC9:				; CODE XREF: sub_10010B90+14j
					; sub_10010B90+2Bj
		push	edi
		call	sub_10003200
		lea	edx, [esp+14h+var_8]
		push	edx
		push	0
		push	edi
		call	sub_10007810
		add	esp, 10h
		test	eax, eax
		js	loc_10010CB4
		add	esi, [esp+10h+var_8]
		push	ebp
		jz	short loc_10010C0A
		lea	ebp, [esi+esi*2]
		push	ebp
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10010C21
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10010C0A:				; CODE XREF: sub_10010B90+5Cj
		push	0FFFFD014h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10010C21:				; CODE XREF: sub_10010B90+6Ej
		mov	eax, [edi+1ECh]
		test	eax, eax
		jz	short loc_10010C34
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10010C34:				; CODE XREF: sub_10010B90+99j
		mov	[edi+1ECh], esi
		mov	[edi+1F0h], ebp
		test	[edi+14h], bl
		jnz	short loc_10010C49
		xor	edx, edx
		jmp	short loc_10010C5F
; ---------------------------------------------------------------------------

loc_10010C49:				; CODE XREF: sub_10010B90+B3j
		movzx	edx, word ptr [edi+26Eh]
		movzx	eax, word ptr [edi+26Ah]
		and	edx, eax
		and	edx, 0DEh

loc_10010C5F:				; CODE XREF: sub_10010B90+B7j
		xor	eax, eax

loc_10010C61:				; CODE XREF: sub_10010B90+101j
		mov	cl, ds:byte_1002B104[eax]
		mov	ebx, 1
		shl	ebx, cl
		test	edx, ebx
		jz	short loc_10010C8B
		mov	[esi], cl
		movzx	ecx, ds:byte_1002B105[eax]
		mov	[esi+1], cl
		movzx	ecx, ds:byte_1002B106[eax]
		mov	[esi+2], cl
		add	esi, 3

loc_10010C8B:				; CODE XREF: sub_10010B90+E0j
		add	eax, 3
		cmp	eax, 12h
		jl	short loc_10010C61
		lea	edx, [esp+14h+var_4]
		push	edx
		push	esi
		push	edi
		call	sub_10007810
		mov	ecx, [esp+20h+var_4]
		sub	ecx, [esp+20h+var_8]
		add	esp, 0Ch
		lea	ecx, [ecx+ecx*2]
		add	[edi+1F0h], ecx
		pop	ebp

loc_10010CB4:				; CODE XREF: sub_10010B90+51j
		pop	esi
		pop	ebx
		add	esp, 8
		retn
sub_10010B90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010CC0	proc near		; CODE XREF: sub_100137A0+3Fp
					; sub_10014380:loc_100143E1p

var_4		= dword	ptr -4

		push	ecx
		cmp	dword ptr [esi+1ECh], 0
		mov	[esp+4+var_4], 0
		jz	short loc_10010D12
		mov	ax, [esi+26Eh]
		test	[esi+26Ah], ax
		jnz	short loc_10010CE8
		and	dword ptr [esi+14h], 0FFFFFF7Fh

loc_10010CE8:				; CODE XREF: sub_10010CC0+1Fj
		lea	ecx, [esp+4+var_4]
		push	ecx
		push	0
		push	esi
		call	sub_10007810
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10010D00
		cmp	[esp+4+var_4], eax
		jg	short loc_10010D05

loc_10010D00:				; CODE XREF: sub_10010CC0+39j
		xor	edx, edx
		mov	[esi+18h], edx

loc_10010D05:				; CODE XREF: sub_10010CC0+3Ej
		test	byte ptr [esi+14h], 80h
		jnz	short loc_10010D24
		cmp	word ptr [esi+18h], 0
		jnz	short loc_10010D24

loc_10010D12:				; CODE XREF: sub_10010CC0+Fj
		push	0FFFFD014h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10010D24:				; CODE XREF: sub_10010CC0+49j
					; sub_10010CC0+50j
		xor	eax, eax
		pop	ecx
		retn
sub_10010CC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010D30	proc near		; CODE XREF: SSL_CipherPolicySet+2Ej
					; NSS_SetDomesticPolicy+69p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		and	ecx, 0Fh
		mov	eax, 1
		shl	eax, cl
		test	al, 0DEh
		jnz	short loc_10010D53
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010D53:				; CODE XREF: sub_10010D30+10j
		mov	ecx, [esp+arg_4]
		cmp	ecx, 1
		jnz	short loc_10010D6C
		or	word_10037654, ax
		or	word_10037650, ax
		jmp	short loc_10010D95
; ---------------------------------------------------------------------------

loc_10010D6C:				; CODE XREF: sub_10010D30+2Aj
		cmp	ecx, 2
		jnz	short loc_10010D85
		mov	ecx, eax
		not	ecx
		and	word_10037654, cx
		or	word_10037650, ax
		jmp	short loc_10010D95
; ---------------------------------------------------------------------------

loc_10010D85:				; CODE XREF: sub_10010D30+3Fj
		not	eax
		and	word_10037654, ax
		and	word_10037650, ax

loc_10010D95:				; CODE XREF: sub_10010D30+3Aj
					; sub_10010D30+53j
		mov	edx, 0DEh
		and	word_10037654, dx
		mov	eax, edx
		and	word_10037650, ax
		mov	dword_10037658,	1
		xor	eax, eax
		retn
sub_10010D30	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPolicyGet

loc_10010DC0:				; CODE XREF: SSL_CipherPolicyGet+48j
		mov	ecx, [esp+arg_0]
		and	ecx, 0Fh
		mov	edx, 1
		shl	edx, cl
		test	dl, 0DEh
		jnz	short loc_10010DEE
		push	0FFFFD016h
		call	PORT_SetError_Util
		mov	eax, [esp+4+arg_4]
		add	esp, 4
		mov	dword ptr [eax], 0
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010DEE:				; CODE XREF: SSL_CipherPolicyGet-BB5Fj
		movzx	ecx, word_10037650
		test	edx, ecx
		jz	short loc_10010E12
		movzx	eax, word_10037654
		and	eax, edx
		mov	edx, [esp+arg_4]
		neg	eax
		sbb	eax, eax
		add	eax, 2
		mov	[edx], eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10010E12:				; CODE XREF: SSL_CipherPolicyGet-BB39j
		mov	edx, [esp+arg_4]
		xor	eax, eax
		mov	[edx], eax
		retn
; END OF FUNCTION CHUNK	FOR SSL_CipherPolicyGet
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010E20	proc near		; CODE XREF: SSL_CipherPrefSetDefault+5Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		and	ecx, 0Fh
		mov	eax, 1
		shl	eax, cl
		test	al, 0DEh
		jnz	short loc_10010E43
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010E43:				; CODE XREF: sub_10010E20+10j
		cmp	[esp+arg_4], 0
		jz	short loc_10010E60
		or	word_100370F8, ax
		mov	eax, 0DEh
		and	word_100370F8, ax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10010E60:				; CODE XREF: sub_10010E20+28j
		not	eax
		and	word_100370F8, ax
		mov	eax, 0DEh
		and	word_100370F8, ax
		xor	eax, eax
		retn
sub_10010E20	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPrefGetDefault

loc_10010E80:				; CODE XREF: SSL_CipherPrefGetDefault+48j
		mov	ecx, [esp+arg_0]
		and	ecx, 0Fh
		mov	eax, 1
		shl	eax, cl
		test	al, 0DEh
		jnz	short loc_10010EAD
		push	0FFFFD016h
		call	PORT_SetError_Util
		mov	eax, [esp+4+arg_4]
		add	esp, 4
		mov	dword ptr [eax], 0
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010EAD:				; CODE XREF: SSL_CipherPrefGetDefault-BB80j
		movzx	ecx, word_100370F8
		mov	edx, [esp+arg_4]
		and	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		neg	ecx
		mov	[edx], ecx
		xor	eax, eax
		retn
; END OF FUNCTION CHUNK	FOR SSL_CipherPrefGetDefault
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010ED0	proc near		; CODE XREF: SSL_CipherPrefSet+89p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_4]
		and	ecx, 0Fh
		mov	edx, 1
		shl	edx, cl
		test	dl, 0DEh
		jnz	short loc_10010EF4
		push	0FFFFD016h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010EF4:				; CODE XREF: sub_10010ED0+11j
		mov	eax, [esp+arg_0]
		add	eax, 26Eh
		cmp	[esp+arg_8], 0
		jz	short loc_10010F12
		or	[eax], dx
		mov	ecx, 0DEh
		and	[eax], cx
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10010F12:				; CODE XREF: sub_10010ED0+32j
		not	edx
		and	[eax], dx
		mov	ecx, 0DEh
		and	[eax], cx
		xor	eax, eax
		retn
sub_10010ED0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR SSL_CipherPrefGet

loc_10010F30:				; CODE XREF: SSL_CipherPrefGet+86j
		mov	ecx, [esp+arg_4]
		and	ecx, 0Fh
		mov	eax, 1
		shl	eax, cl
		test	al, 0DEh
		jnz	short loc_10010F5D
		push	0FFFFD016h
		call	PORT_SetError_Util
		mov	eax, [esp+4+arg_8]
		add	esp, 4
		mov	dword ptr [eax], 0
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010F5D:				; CODE XREF: SSL_CipherPrefGet-BBE0j
		mov	ecx, [esp+arg_0]
		movzx	edx, word ptr [ecx+26Eh]
		and	edx, eax
		mov	eax, [esp+arg_8]
		neg	edx
		sbb	edx, edx
		neg	edx
		mov	[eax], edx
		xor	eax, eax
		retn
; END OF FUNCTION CHUNK	FOR SSL_CipherPrefGet
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010F80	proc near		; CODE XREF: sub_1001EB40+1AAp

arg_0		= dword	ptr  4

		movzx	ecx, word_10037654
		mov	eax, [esp+arg_0]
		mov	dx, word_10037650
		mov	[eax+26Ah], cx
		movzx	ecx, word_100370F8
		mov	[eax+26Ch], dx
		mov	[eax+26Eh], cx
		retn
sub_10010F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010FB0	proc near		; CODE XREF: sub_10011FA0+E6p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		dec	eax
		cmp	eax, 6		; switch 7 cases
		ja	short loc_1001100F ; jumptable 10010FBD	default	case
		movzx	eax, ds:byte_10011028[eax]
		jmp	ds:off_10011020[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10010FC4:				; CODE XREF: sub_10010FB0+Dj
					; DATA XREF: .text:off_10011020o
		push	2		; jumptable 10010FBD cases 0-3,5,6
		call	HASH_GetHashObject
		mov	ecx, [esp+4+arg_4]
		push	ecx
		lea	edx, [esi+54h]
		push	edx
		push	0
		mov	[esi+4Ch], eax
		call	SECITEM_CopyItem_Util
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001101C
		mov	eax, [esp+arg_0]
		push	eax
		lea	ecx, [esi+60h]
		push	ecx
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001101C
		mov	edx, [esi+4Ch]
		mov	eax, [edx+4]
		call	eax
		mov	[esi+50h], eax
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
; ---------------------------------------------------------------------------

loc_1001100F:				; CODE XREF: sub_10010FB0+4j
					; sub_10010FB0+Dj
					; DATA XREF: ...
		push	0FFFFD002h	; jumptable 10010FBD default case
		call	PORT_SetError_Util
		add	esp, 4

loc_1001101C:				; CODE XREF: sub_10010FB0+33j
					; sub_10010FB0+4Aj
		or	eax, 0FFFFFFFFh
		retn
sub_10010FB0	endp

; ---------------------------------------------------------------------------
off_10011020	dd offset loc_10010FC4	; DATA XREF: sub_10010FB0+Dr
		dd offset loc_1001100F	; jump table for switch	statement
byte_10011028	db	0,     0,     0,     0 ; DATA XREF: sub_10010FB0+6r
		db	1,     0,     0	; indirect table for switch statement
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011030	proc near		; CODE XREF: sub_100137A0+305p
					; sub_10013DA0+409p
		xor	eax, eax
		cmp	ecx, 80h
		jnb	short loc_1001103F
		mov	ecx, 80h

loc_1001103F:				; CODE XREF: sub_10011030+8j
		cmp	ecx, [edx+0D8h]
		jbe	short locret_1001105E
		push	ecx
		add	edx, 0D0h
		push	edx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short locret_1001105E
		or	eax, 0FFFFFFFFh

locret_1001105E:			; CODE XREF: sub_10011030+15j
					; sub_10011030+29j
		retn
sub_10011030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011060	proc near		; CODE XREF: sub_10012960+AAp
					; sub_10012DA0+122p ...

var_4		= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, [esp+4+arg_4]
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ecx, eax
		shr	ecx, 8
		test	byte ptr [esi+16h], 1
		push	edi
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_3], cl
		mov	[esp+0Ch+var_2], al
		jnz	short loc_10011093
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011093:				; CODE XREF: sub_10011060+21j
		mov	ecx, [esi+48h]
		push	0
		push	3
		lea	eax, [esp+14h+var_4]
		push	eax
		push	esi
		mov	dword ptr [esi+2Ch], 1
		call	ecx
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		js	short loc_100110B4
		xor	edi, edi

loc_100110B4:				; CODE XREF: sub_10011060+50j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100110CA
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100110CA:				; CODE XREF: sub_10011060+58j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_10011060	endp


; =============== S U B	R O U T	I N E =======================================


sub_100110D0	proc near		; CODE XREF: sub_10012C80:loc_10012CA8p

var_18		= byte ptr -18h
var_17		= dword	ptr -17h
var_13		= dword	ptr -13h
var_F		= dword	ptr -0Fh
var_B		= dword	ptr -0Bh
var_4		= dword	ptr -4

		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		push	edi
		xor	edi, edi
		test	byte ptr [esi+16h], 1
		jnz	short loc_100110F7
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100110F7:				; CODE XREF: sub_100110D0+15j
		cmp	byte ptr [esi+0FBh], 0
		jnz	short loc_10011152
		mov	edx, [esi+125h]
		mov	ecx, [esi+121h]
		mov	eax, [esi+129h]
		push	0
		mov	[esp+20h+var_13], edx
		push	11h
		lea	edx, [esp+24h+var_18]
		mov	[esp+24h+var_17], ecx
		mov	ecx, [esi+12Dh]
		push	edx
		mov	[esp+28h+var_F], eax
		mov	eax, [esi+48h]
		push	esi
		mov	byte ptr [esi+0FBh], 1
		mov	[esp+2Ch+var_18], 3
		mov	[esp+2Ch+var_B], ecx
		call	eax
		xor	ecx, ecx
		add	esp, 10h
		test	eax, eax
		setns	cl
		lea	edi, [ecx-1]
		and	edi, eax

loc_10011152:				; CODE XREF: sub_100110D0+2Ej
		test	byte ptr [esi+16h], 1
		jnz	short loc_10011168
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10011168:				; CODE XREF: sub_100110D0+86j
		mov	ecx, [esp+1Ch+var_4]
		mov	eax, edi
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
sub_100110D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011180	proc near		; CODE XREF: .text:10013D2Ap
					; sub_10013DA0+507p
		test	byte ptr [esi+16h], 1
		jnz	short loc_10011196
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011196:				; CODE XREF: sub_10011180+4j
		xor	eax, eax
		cmp	dword ptr [esi+0D8h], 80h
		jnb	short loc_100111BF
		lea	ecx, [esi+0D0h]
		push	80h
		push	ecx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_100111BF
		or	eax, 0FFFFFFFFh

loc_100111BF:				; CODE XREF: sub_10011180+22j
					; sub_10011180+3Aj
		push	edi
		mov	edi, eax
		test	eax, eax
		jnz	short loc_1001120C
		mov	eax, [esi+0D0h]
		mov	byte ptr [eax],	5
		mov	edx, [esi+101h]
		mov	[eax+1], edx
		mov	ecx, [esi+105h]
		mov	[eax+5], ecx
		mov	edx, [esi+109h]
		push	edi
		mov	[eax+9], edx
		mov	ecx, [esi+10Dh]
		push	11h
		push	eax
		mov	[eax+0Dh], ecx
		mov	edx, [esi+48h]
		push	esi
		call	edx
		xor	ecx, ecx
		add	esp, 10h
		test	eax, eax
		setns	cl
		lea	edi, [ecx-1]
		and	edi, eax

loc_1001120C:				; CODE XREF: sub_10011180+44j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10011222
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10011222:				; CODE XREF: sub_10011180+90j
		mov	eax, edi
		pop	edi
		retn
sub_10011180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011230	proc near		; CODE XREF: sub_10012C80+21p
		push	ebx
		xor	ebx, ebx
		test	byte ptr [esi+16h], 1
		jnz	short loc_10011249
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011249:				; CODE XREF: sub_10011230+7j
		cmp	[esi+0FBh], bl
		jnz	loc_1001130D
		xor	eax, eax
		cmp	dword ptr [esi+0D8h], 80h
		push	edi
		mov	edi, [esi+0F4h]
		mov	byte ptr [esi+0FBh], 1
		jnb	short loc_1001128C
		lea	ecx, [esi+0D0h]
		push	80h
		push	ecx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_1001128C
		or	eax, 0FFFFFFFFh

loc_1001128C:				; CODE XREF: sub_10011230+3Fj
					; sub_10011230+57j
		mov	ebx, eax
		test	eax, eax
		jnz	short loc_1001130C
		mov	eax, [esi+0D0h]
		mov	byte ptr [eax],	6
		mov	edx, [edi+54h]
		mov	[eax+1], edx
		mov	ecx, [edi+58h]
		mov	[eax+5], ecx
		mov	edx, [edi+5Ch]
		push	ebp
		push	ebx
		mov	[eax+9], edx
		mov	ecx, [edi+60h]
		push	11h
		push	eax
		mov	[eax+0Dh], ecx
		mov	edx, [esi+48h]
		push	esi
		call	edx
		mov	ebp, eax
		add	esp, 10h
		test	ebp, ebp
		jns	short loc_100112DB
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_100112D7
		push	edi
		call	eax
		add	esp, 4

loc_100112D7:				; CODE XREF: sub_10011230+9Fj
		mov	ebx, ebp
		jmp	short loc_100112F8
; ---------------------------------------------------------------------------

loc_100112DB:				; CODE XREF: sub_10011230+95j
		test	dword ptr [esi+14h], 400h
		jnz	short loc_100112F8
		cmp	dword ptr [edi+4], 0
		jnz	short loc_100112F6
		mov	eax, [esi+84h]
		push	edi
		call	eax
		add	esp, 4

loc_100112F6:				; CODE XREF: sub_10011230+B8j
		xor	ebx, ebx

loc_100112F8:				; CODE XREF: sub_10011230+A9j
					; sub_10011230+B2j
		push	edi
		call	sub_10017FD0
		add	esp, 4
		mov	dword ptr [esi+0F4h], 0
		pop	ebp

loc_1001130C:				; CODE XREF: sub_10011230+60j
		pop	edi

loc_1001130D:				; CODE XREF: sub_10011230+1Fj
		test	byte ptr [esi+16h], 1
		jnz	short loc_10011323
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10011323:				; CODE XREF: sub_10011230+E1j
		mov	eax, ebx
		pop	ebx
		retn
sub_10011230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011330	proc near		; CODE XREF: sub_10012960+22Cp

var_4		= dword	ptr -4
arg_0		= byte ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Src		= dword	ptr  14h
Size		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		test	byte ptr [edi+16h], 1
		jnz	short loc_10011347
		mov	eax, [edi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011347:				; CODE XREF: sub_10011330+5j
		mov	ecx, [esp+4+Size]
		mov	edx, [esp+4+arg_C]
		add	edx, ecx
		lea	edx, [edx+ebx+0Ah]
		xor	eax, eax
		mov	[esp+4+var_4], edx
		cmp	edx, 80h
		jnb	short loc_10011367
		mov	edx, 80h

loc_10011367:				; CODE XREF: sub_10011330+30j
		cmp	edx, [edi+0D8h]
		jbe	short loc_1001138A
		push	edx
		lea	eax, [edi+0D0h]
		push	eax
		call	sub_10018960
		mov	ecx, [esp+0Ch+Size]
		add	esp, 8
		test	eax, eax
		jz	short loc_1001138A
		or	eax, 0FFFFFFFFh

loc_1001138A:				; CODE XREF: sub_10011330+3Dj
					; sub_10011330+55j
		push	esi
		mov	esi, eax
		test	eax, eax
		jnz	loc_10011431
		mov	esi, [edi+0D0h]
		mov	dl, [esp+8+arg_0]
		mov	eax, [esp+8+arg_4]
		mov	[esi+1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[esi+3], al
		mov	[esi+2], dl
		mov	eax, ecx
		shr	eax, 8
		mov	[esi+4], al
		mov	eax, [esp+8+arg_C]
		mov	edx, ebx
		shr	edx, 8
		push	ebp
		mov	[esi+6], dl
		mov	edx, eax
		push	ecx		; Size
		mov	[esi+9], al
		mov	eax, [esp+10h+Src]
		mov	[esi+5], cl
		push	eax		; Src
		lea	ecx, [esi+0Ah]
		shr	edx, 8
		push	ecx		; Dst
		mov	byte ptr [esi],	2
		mov	[esi+7], bl
		mov	[esi+8], dl
		call	memcpy
		mov	edx, [esp+18h+Size]
		mov	eax, [esp+18h+arg_18]
		lea	ebp, [esi+edx]
		push	ebx		; Size
		push	eax		; Src
		lea	ecx, [ebp+0Ah]
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+24h+arg_C]
		mov	eax, [esp+24h+arg_8]
		push	edx		; Size
		push	eax		; Src
		lea	ecx, [ebx+ebp+0Ah]
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esp+30h+var_4]
		mov	eax, [edi+48h]
		push	0
		push	edx
		push	esi
		push	edi
		call	eax
		xor	ecx, ecx
		add	esp, 34h
		test	eax, eax
		setns	cl
		pop	ebp
		lea	esi, [ecx-1]
		and	esi, eax

loc_10011431:				; CODE XREF: sub_10011330+5Fj
		test	byte ptr [edi+16h], 1
		jnz	short loc_10011447
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10011447:				; CODE XREF: sub_10011330+105j
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
sub_10011330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011450	proc near		; CODE XREF: sub_10012C50+1Ep
		test	byte ptr [edi+16h], 1
		jnz	short loc_10011466
		mov	eax, [edi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011466:				; CODE XREF: sub_10011450+4j
		xor	eax, eax
		cmp	dword ptr [edi+0D8h], 80h
		jnb	short loc_1001148F
		lea	ecx, [edi+0D0h]
		push	80h
		push	ecx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_1001148F
		or	eax, 0FFFFFFFFh

loc_1001148F:				; CODE XREF: sub_10011450+22j
					; sub_10011450+3Aj
		push	esi
		mov	esi, eax
		test	eax, eax
		jnz	short loc_100114E0
		lea	esi, [edi+131h]
		push	10h
		push	esi
		call	PK11_GenerateRandom
		mov	eax, [edi+0D0h]
		mov	word ptr [eax],	107h
		mov	edx, [esi]
		mov	[eax+2], edx
		mov	ecx, [esi+4]
		mov	[eax+6], ecx
		mov	edx, [esi+8]
		push	0
		mov	[eax+0Ah], edx
		mov	ecx, [esi+0Ch]
		push	12h
		push	eax
		mov	[eax+0Eh], ecx
		mov	edx, [edi+48h]
		push	edi
		call	edx
		xor	ecx, ecx
		add	esp, 18h
		test	eax, eax
		setns	cl
		lea	esi, [ecx-1]
		and	esi, eax

loc_100114E0:				; CODE XREF: sub_10011450+44j
		test	byte ptr [edi+16h], 1
		jnz	short loc_100114F6
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100114F6:				; CODE XREF: sub_10011450+94j
		mov	eax, esi
		pop	esi
		retn
sub_10011450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011500	proc near		; CODE XREF: sub_10012DA0+A9p

arg_0		= dword	ptr  4

		test	byte ptr [ebx+16h], 1
		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		jnz	short loc_1001151C
		mov	eax, [ebx+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001151C:				; CODE XREF: sub_10011500+Aj
		mov	ecx, [ebp+8]
		mov	edx, [edi+8]
		lea	ecx, [ecx+edx+6]
		xor	eax, eax
		mov	[esp+8+arg_0], ecx
		cmp	ecx, 80h
		jnb	short loc_10011539
		mov	ecx, 80h

loc_10011539:				; CODE XREF: sub_10011500+32j
		cmp	ecx, [ebx+0D8h]
		jbe	short loc_10011558
		push	ecx
		lea	eax, [ebx+0D0h]
		push	eax
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jz	short loc_10011558
		or	eax, 0FFFFFFFFh

loc_10011558:				; CODE XREF: sub_10011500+3Fj
					; sub_10011500+53j
		mov	esi, eax
		test	eax, eax
		jnz	short loc_100115C6
		mov	esi, [ebx+0D0h]
		mov	word ptr [esi],	108h
		mov	ecx, [edi+8]
		shr	ecx, 8
		mov	[esi+2], cl
		mov	dl, [edi+8]
		mov	[esi+3], dl
		mov	eax, [ebp+8]
		shr	eax, 8
		mov	[esi+4], al
		mov	cl, [ebp+8]
		mov	[esi+5], cl
		mov	edx, [edi+8]
		mov	eax, [edi+4]
		push	edx		; Size
		push	eax		; Src
		lea	ecx, [esi+6]
		push	ecx		; Dst
		call	memcpy
		mov	edx, [ebp+8]
		mov	eax, [ebp+4]
		mov	ecx, [edi+8]
		push	edx		; Size
		push	eax		; Src
		lea	edx, [ecx+esi+6]
		push	edx		; Dst
		call	memcpy
		mov	eax, [esp+20h+arg_0]
		mov	ecx, [ebx+48h]
		push	0
		push	eax
		push	esi
		push	ebx
		call	ecx
		mov	esi, eax
		add	esp, 28h
		test	esi, esi
		js	short loc_100115C6
		xor	esi, esi

loc_100115C6:				; CODE XREF: sub_10011500+5Cj
					; sub_10011500+C2j
		test	byte ptr [ebx+16h], 1
		jnz	short loc_100115DC
		mov	edx, [ebx+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100115DC:				; CODE XREF: sub_10011500+CAj
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_10011500	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100115F0	proc near		; CODE XREF: sub_10011810+ADp
					; sub_10011A00+104p

var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
Dst		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		mov	eax, [esp+38h+arg_4]
		mov	ecx, [esi+58h]
		mov	edx, [esi+5Ch]
		push	ebx
		mov	ebx, [esi+44h]
		mov	[esp+3Ch+var_30], eax
		mov	eax, [esi+4Ch]
		push	ebp
		mov	ebp, [esp+40h+arg_0]
		mov	[esp+40h+var_34], ecx
		mov	[esp+40h+var_2C], edx
		test	eax, eax
		jz	loc_100116E9
		cmp	dword ptr [eax], 0
		jz	loc_100116E9
		mov	ecx, [esi+50h]
		test	ecx, ecx
		jnz	short loc_1001164C
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_1001164C:				; CODE XREF: sub_100115F0+46j
		mov	eax, [eax+10h]
		push	ecx
		call	eax
		mov	edx, [esp+44h+var_2C]
		mov	eax, [esp+44h+var_34]
		mov	ecx, [esi+4Ch]
		push	edx
		mov	edx, [esi+50h]
		push	eax
		mov	eax, [ecx+14h]
		push	edx
		call	eax
		mov	edx, [esp+50h+arg_8]
		mov	eax, [esp+50h+var_30]
		mov	ecx, [esi+4Ch]
		push	edx
		mov	edx, [esi+50h]
		push	eax
		mov	eax, [ecx+14h]
		push	edx
		call	eax
		push	edi		; Size
		lea	ecx, [esp+60h+Dst]
		push	edi		; Val
		push	ecx		; Dst
		call	memset
		mov	edx, [esi+4Ch]
		mov	ecx, [esi+50h]
		mov	edx, [edx+14h]
		push	edi
		lea	eax, [esp+6Ch+Dst]
		push	eax
		push	ecx
		call	edx
		mov	ecx, ebx
		shr	ecx, 10h
		mov	eax, ebx
		shr	eax, 18h
		mov	[esp+74h+var_37], cl
		mov	edx, ebx
		shr	edx, 8
		mov	[esp+74h+var_38], al
		mov	eax, [esi+4Ch]
		mov	[esp+74h+var_36], dl
		mov	edx, [esi+50h]
		push	4
		lea	ecx, [esp+78h+var_38]
		push	ecx
		mov	[esp+7Ch+var_35], bl
		mov	eax, [eax+14h]
		push	edx
		call	eax
		mov	eax, [esi+4Ch]
		mov	ecx, [eax]
		add	esp, 40h
		push	ecx
		mov	ecx, [esi+50h]
		lea	edx, [esp+44h+var_28]
		push	edx
		mov	edx, [eax+18h]
		push	ebp
		push	ecx
		call	edx
		add	esp, 10h

loc_100116E9:				; CODE XREF: sub_100115F0+32j
					; sub_100115F0+3Bj
		mov	ecx, [esp+40h+var_4]
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_100115F0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10011700:				; DATA XREF: sub_10011CB0+4o
		push	ecx
		push	ebx
		mov	ebx, [esp+14h]
		xor	eax, eax
		mov	[esp+4], eax
		test	ebx, ebx
		jz	loc_10011800
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h]
		jmp	short loc_10011724
; ---------------------------------------------------------------------------
		align 10h

loc_10011720:				; CODE XREF: .text:100117B0j
		mov	ebx, [esp+20h]

loc_10011724:				; CODE XREF: .text:1001171Bj
		cmp	ebx, 7FE0h
		jl	short loc_10011731
		mov	ebx, 7FE0h

loc_10011731:				; CODE XREF: .text:1001172Aj
		lea	ebp, [ebx+2]
		cmp	ebp, [edi+58h]
		jbe	short loc_1001174E
		lea	eax, [edi+50h]
		push	ebp
		push	eax
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jnz	loc_100117FD

loc_1001174E:				; CODE XREF: .text:10011737j
		mov	esi, [edi+50h]
		mov	edx, [esp+1Ch]
		mov	ecx, ebx
		push	ebx
		shr	ecx, 8
		push	edx
		lea	eax, [esi+2]
		or	cl, 80h
		push	eax
		mov	[esi], cl
		mov	[esi+1], bl
		call	memcpy
		mov	ecx, [esp+30h]
		and	ecx, 80FFFFFFh
		push	ecx
		push	ebp
		push	esi
		push	edi
		call	sub_10014560
		mov	ebp, eax
		add	esp, 1Ch
		test	ebp, ebp
		jns	short loc_10011797
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_100117C0
		xor	ebp, ebp

loc_10011797:				; CODE XREF: .text:10011787j
		lea	eax, [ebx+2]
		cmp	ebp, eax
		jb	short loc_100117D0
		inc	dword ptr [edi+8Ch]
		add	[esp+1Ch], ebx
		add	[esp+10h], ebx
		sub	[esp+20h], ebx
		jnz	loc_10011720
		mov	eax, [esp+10h]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100117C0:				; CODE XREF: .text:10011793j
		mov	eax, [esp+10h]
		test	eax, eax
		jnz	short loc_100117FD
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100117D0:				; CODE XREF: .text:1001179Cj
		mov	edx, ebx
		sub	edx, ebp
		add	edx, 2
		push	edx
		add	esi, ebp
		push	esi
		push	edi
		call	sub_10018A20
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100117F1
		pop	edi
		pop	esi
		pop	ebp
		or	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100117F1:				; CODE XREF: .text:100117E7j
		mov	eax, [esp+10h]
		add	eax, ebx
		inc	dword ptr [edi+8Ch]

loc_100117FD:				; CODE XREF: .text:10011748j
					; .text:100117C6j
		pop	edi
		pop	esi
		pop	ebp

loc_10011800:				; CODE XREF: .text:1001170Ej
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011810	proc near		; DATA XREF: sub_10011C60+2Eo

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+24h+arg_8]
		mov	[esp+24h+var_14], 0
		test	edi, edi
		jz	loc_100119F0
		mov	ebp, [esp+24h+arg_0]
		jmp	short loc_10011835
; ---------------------------------------------------------------------------

loc_10011831:				; CODE XREF: sub_10011810+16Fj
		mov	edi, [esp+24h+arg_8]

loc_10011835:				; CODE XREF: sub_10011810+1Fj
		test	byte ptr [ebp+16h], 1
		jnz	short loc_1001184A
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_1001184A:				; CODE XREF: sub_10011810+29j
		mov	ecx, [ebp+94h]
		mov	al, [ecx]
		cmp	edi, 7FE0h
		jge	short loc_10011860
		mov	[esp+24h+var_10], edi
		jmp	short loc_1001186C
; ---------------------------------------------------------------------------

loc_10011860:				; CODE XREF: sub_10011810+48j
		mov	[esp+24h+var_10], 7FE0h
		mov	edi, [esp+24h+var_10]

loc_1001186C:				; CODE XREF: sub_10011810+4Ej
		movzx	eax, al
		lea	esi, [eax+edi]
		mov	[esp+24h+var_4], eax
		lea	eax, [esi+2]
		mov	[esp+24h+var_8], eax
		cmp	eax, [ebp+58h]
		jbe	short loc_10011897
		push	eax
		lea	edx, [ebp+50h]
		push	edx
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jnz	loc_10011991

loc_10011897:				; CODE XREF: sub_10011810+70j
		mov	ebx, [ebp+50h]
		mov	edx, [esp+24h+arg_4]
		mov	eax, esi
		shr	eax, 8
		mov	[esp+24h+var_C], esi
		or	al, 80h
		push	edi
		mov	[ebx], al
		mov	cl, byte ptr [esp+28h+var_C]
		lea	eax, [ebx+2]
		push	edx
		lea	esi, [ebp+48h]
		push	eax
		xor	edi, edi
		mov	[ebx+1], cl
		call	sub_100115F0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10011991
		mov	esi, [esp+24h+var_4]
		mov	edx, [ebp+0B8h]
		push	esi
		lea	eax, [ebx+2]
		push	eax
		push	esi
		lea	ecx, [esp+30h+var_C]
		push	ecx
		push	eax
		mov	eax, [ebp+0BCh]
		push	edx
		call	eax
		add	esp, 18h
		test	eax, eax
		jnz	loc_10011991
		mov	edi, [esp+24h+var_10]
		mov	ecx, [esp+24h+arg_4]
		push	edi
		push	ecx
		mov	ecx, [ebp+0B8h]
		push	edi
		lea	edx, [esp+30h+var_C]
		push	edx
		mov	edx, [ebp+0BCh]
		lea	eax, [esi+ebx+2]
		push	eax
		push	ecx
		call	edx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10011991
		test	byte ptr [ebp+16h], 1
		jnz	short loc_10011937
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10011937:				; CODE XREF: sub_10011810+116j
		mov	ecx, [esp+24h+arg_C]
		mov	edx, [esp+24h+var_8]
		and	ecx, 80FFFFFFh
		push	ecx
		push	edx
		push	ebx
		push	ebp
		call	sub_10014560
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jns	short loc_10011965
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_100119B1
		xor	esi, esi

loc_10011965:				; CODE XREF: sub_10011810+145j
		mov	eax, [esp+24h+var_8]
		cmp	esi, eax
		jb	short loc_100119C6
		inc	dword ptr [ebp+8Ch]
		add	[esp+24h+arg_4], edi
		add	[esp+24h+var_14], edi
		sub	[esp+24h+arg_8], edi
		jnz	loc_10011831
		mov	eax, [esp+24h+var_14]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10011991:				; CODE XREF: sub_10011810+81j
					; sub_10011810+B7j ...
		test	byte ptr [ebp+16h], 1
		jnz	short loc_100119A6
		mov	eax, [ebp+25Ch]
		push	eax
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_100119A6:				; CODE XREF: sub_10011810+185j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100119B1:				; CODE XREF: sub_10011810+151j
		cmp	[esp+24h+var_14], 0
		jnz	short loc_100119F0
		pop	edi
		mov	[esp+20h+var_14], esi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100119C6:				; CODE XREF: sub_10011810+15Bj
		sub	eax, esi
		push	eax
		add	ebx, esi
		push	ebx
		push	ebp
		call	sub_10018A20
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100119E6
		pop	edi
		pop	esi
		pop	ebp
		mov	[esp+18h+var_14], eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100119E6:				; CODE XREF: sub_10011810+1C8j
		add	[esp+24h+var_14], edi
		inc	dword ptr [ebp+8Ch]

loc_100119F0:				; CODE XREF: sub_10011810+15j
					; sub_10011810+1A6j
		mov	eax, [esp+24h+var_14]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10011810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011A00(int,	void *Src, int,	int)
sub_10011A00	proc near		; DATA XREF: sub_10011C60+21o

var_20		= dword	ptr -20h
Val		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Size		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 20h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_8]
		push	edi
		mov	[esp+30h+var_20], 0
		test	esi, esi
		jz	loc_10011C4F
		mov	ebx, [esp+30h+arg_0]
		jmp	short loc_10011A25
; ---------------------------------------------------------------------------

loc_10011A21:				; CODE XREF: sub_10011A00+1D4j
		mov	esi, [esp+30h+arg_8]

loc_10011A25:				; CODE XREF: sub_10011A00+1Fj
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10011A3A
		mov	eax, [ebx+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_10011A3A:				; CODE XREF: sub_10011A00+29j
		mov	ecx, [ebx+94h]
		mov	eax, [ecx]
		mov	[esp+30h+var_8], eax
		cmp	esi, 3FE0h
		jge	short loc_10011A56
		mov	edi, esi
		mov	[esp+30h+Size],	edi
		jmp	short loc_10011A62
; ---------------------------------------------------------------------------

loc_10011A56:				; CODE XREF: sub_10011A00+4Cj
		mov	[esp+30h+Size],	3FE0h
		mov	edi, [esp+30h+Size]

loc_10011A62:				; CODE XREF: sub_10011A00+54j
		mov	ecx, [ebx+0CCh]
		lea	esi, [edi+eax]
		lea	eax, [ecx-1]
		and	eax, esi
		mov	[esp+30h+var_18], esi
		mov	[esp+30h+Val], eax
		jz	short loc_10011A92
		sub	ecx, eax
		add	esi, ecx
		mov	[esp+30h+var_10], 3
		mov	[esp+30h+Val], ecx
		mov	[esp+30h+var_18], esi
		mov	eax, ecx
		jmp	short loc_10011A9A
; ---------------------------------------------------------------------------

loc_10011A92:				; CODE XREF: sub_10011A00+78j
		mov	[esp+30h+var_10], 2

loc_10011A9A:				; CODE XREF: sub_10011A00+90j
		mov	ecx, [esp+30h+var_10]
		add	ecx, esi
		mov	[esp+30h+var_4], ecx
		cmp	ecx, [ebx+58h]
		jbe	short loc_10011AC6
		push	ecx
		lea	eax, [ebx+50h]
		push	eax
		call	sub_10018960
		add	esp, 8
		test	eax, eax
		jnz	loc_10011BE6
		mov	esi, [esp+30h+var_18]
		mov	eax, [esp+30h+Val]

loc_10011AC6:				; CODE XREF: sub_10011A00+A7j
		mov	ebp, [ebx+50h]
		mov	ecx, esi
		shr	ecx, 8
		mov	[esp+30h+var_C], ebp
		test	eax, eax
		jz	short loc_10011AE8
		mov	[ebp+0], cl
		mov	dl, byte ptr [esp+30h+var_18]
		mov	[ebp+1], dl
		mov	[ebp+2], al
		add	ebp, 3
		jmp	short loc_10011AF8
; ---------------------------------------------------------------------------

loc_10011AE8:				; CODE XREF: sub_10011A00+D4j
		or	cl, 80h
		mov	[ebp+0], cl
		mov	dl, byte ptr [esp+30h+var_18]
		mov	[ebp+1], dl
		add	ebp, 2

loc_10011AF8:				; CODE XREF: sub_10011A00+E6j
		mov	ecx, [esp+30h+Src]
		push	edi
		push	ecx
		lea	esi, [ebx+48h]
		push	ebp
		mov	edi, eax
		call	sub_100115F0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10011BE6
		mov	esi, [esp+30h+Size]
		mov	edx, [esp+30h+Src]
		add	ebp, [esp+30h+var_8]
		push	esi		; Size
		push	edx		; Src
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+3Ch+Val]
		add	esp, 0Ch
		add	ebp, esi
		test	eax, eax
		jz	short loc_10011B44
		push	eax		; Size
		push	eax		; Val
		push	ebp		; Dst
		call	memset
		add	esp, 0Ch
		add	ebp, [esp+30h+Val]

loc_10011B44:				; CODE XREF: sub_10011A00+133j
		mov	edi, [esp+30h+var_C]
		mov	edx, [esp+30h+var_10]
		mov	esi, ebp
		sub	esi, edi
		mov	ecx, esi
		sub	ecx, edx
		push	ecx
		mov	ecx, [esp+34h+var_4]
		lea	eax, [edi+edx]
		push	eax
		sub	ecx, edx
		push	ecx
		mov	ecx, [ebx+0BCh]
		lea	edx, [esp+3Ch+var_18]
		push	edx
		push	eax
		mov	eax, [ebx+0B8h]
		push	eax
		call	ecx
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10011BE6
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10011B91
		mov	edx, [ebx+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10011B91:				; CODE XREF: sub_10011A00+180j
		mov	eax, [esp+30h+arg_C]
		and	eax, 80FFFFFFh
		push	eax
		push	esi
		push	edi
		push	ebx
		call	sub_10014560
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jns	short loc_10011BBA
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jnz	short loc_10011C06
		xor	edi, edi

loc_10011BBA:				; CODE XREF: sub_10011A00+1AAj
		cmp	edi, esi
		jl	short loc_10011C1B
		mov	eax, [esp+30h+Size]
		inc	dword ptr [ebx+8Ch]
		add	[esp+30h+Src], eax
		add	[esp+30h+var_20], eax
		sub	[esp+30h+arg_8], eax
		jnz	loc_10011A21
		mov	eax, [esp+30h+var_20]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10011BE6:				; CODE XREF: sub_10011A00+B8j
					; sub_10011A00+10Ej ...
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10011BFB
		mov	ecx, [ebx+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10011BFB:				; CODE XREF: sub_10011A00+1EAj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10011C06:				; CODE XREF: sub_10011A00+1B6j
		cmp	[esp+30h+var_20], 0
		jnz	short loc_10011C4F
		mov	[esp+30h+var_20], edi
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10011C1B:				; CODE XREF: sub_10011A00+1BCj
		mov	eax, [esp+30h+var_C]
		sub	ebp, eax
		sub	ebp, edi
		push	ebp
		add	eax, edi
		push	eax
		push	ebx
		call	sub_10018A20
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10011C41
		pop	edi
		pop	esi
		pop	ebp
		mov	[esp+24h+var_20], eax
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10011C41:				; CODE XREF: sub_10011A00+233j
		mov	edx, [esp+30h+Size]
		add	[esp+30h+var_20], edx
		inc	dword ptr [ebx+8Ch]

loc_10011C4F:				; CODE XREF: sub_10011A00+15j
					; sub_10011A00+20Bj
		mov	eax, [esp+30h+var_20]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10011A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011C60	proc near		; CODE XREF: sub_10013420:loc_100136F1p
					; .text:10013D25p ...
		push	ebx
		mov	ebx, 1
		test	[esi+16h], bl
		jnz	short loc_10011C7B
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011C7B:				; CODE XREF: sub_10011C60+9j
		mov	[esi+29Ch], ebx
		mov	eax, offset sub_10011A00
		cmp	[esi+0CCh], ebx
		jg	short loc_10011C93
		mov	eax, offset sub_10011810

loc_10011C93:				; CODE XREF: sub_10011C60+2Cj
		test	[esi+16h], bl
		mov	[esi+48h], eax
		pop	ebx
		jnz	short locret_10011CAA
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		pop	ecx

locret_10011CAA:			; CODE XREF: sub_10011C60+3Aj
		retn
sub_10011C60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011CB0	proc near		; CODE XREF: sub_10019070+7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [eax+48h], offset loc_10011700
		retn
sub_10011CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011CC0	proc near		; DATA XREF: sub_10013080:loc_1001328Ao
					; .text:100133D4o ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	byte ptr [esi+16h], 1
		push	edi
		jnz	short loc_10011CDC
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10011CDC:				; CODE XREF: sub_10011CC0+Aj
		mov	ecx, 300h
		cmp	[esi+44h], cx
		jnb	short loc_10011CFA
		cmp	dword ptr [esi+2F38h], 1
		jz	short loc_10011CFA
		push	0
		push	esi
		call	sub_100179F0
		jmp	short loc_10011D02
; ---------------------------------------------------------------------------

loc_10011CFA:				; CODE XREF: sub_10011CC0+25j
					; sub_10011CC0+2Ej
		push	0
		push	esi
		call	sub_10010190

loc_10011D02:				; CODE XREF: sub_10011CC0+38j
		add	esp, 8
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_10011D1D
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10011D1D:				; CODE XREF: sub_10011CC0+4Bj
		test	edi, edi
		jg	short loc_10011D42
		cmp	edi, 0FFFFFFFEh
		jnz	short loc_10011D2B
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10011D2B:				; CODE XREF: sub_10011CC0+64j
		test	edi, edi
		jnz	short loc_10011D3C
		push	0FFFFE8CEh
		call	PORT_SetError_Util
		add	esp, 4

loc_10011D3C:				; CODE XREF: sub_10011CC0+6Dj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10011D42:				; CODE XREF: sub_10011CC0+5Fj
		pop	edi
		mov	dword ptr [esi+1DCh], 0
		xor	eax, eax
		pop	esi
		retn
sub_10011CC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011D60	proc near		; CODE XREF: sub_10012280+236p
					; sub_10012960+14Ap

Src		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, 2
		push	edi
		mov	[esi+3Ah], ax
		mov	[esi+70h], ecx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+68h], eax
		test	eax, eax
		jnz	short loc_10011D80

loc_10011D7C:				; CODE XREF: sub_10011D60+88j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10011D80:				; CODE XREF: sub_10011D60+1Aj
		mov	edx, [esp+Src]
		push	edi		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+0Ch+arg_8]
		mov	ecx, [esp+0Ch+arg_C]
		mov	edx, [esp+0Ch+arg_10]
		mov	[esi+80h], eax
		mov	eax, [esp+0Ch+arg_14]
		mov	[esi+84h], ecx
		mov	ecx, [esp+0Ch+arg_18]
		mov	[esi+44h], edx
		mov	edx, [esp+0Ch+arg_1C]
		add	esp, 0Ch
		mov	[esi+6Ch], edi
		mov	[esi+48h], eax
		mov	[esi+4Ch], ecx
		mov	[esi+50h], edx
		call	sub_10018130
		mov	[esi+3Ch], eax
		mov	[esi+0Ch], eax
		add	eax, dword_100370FC
		mov	[esi+40h], eax
		test	ebx, ebx
		jz	short loc_10011DFC
		push	ebx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+78h], eax
		test	eax, eax
		jz	short loc_10011D7C
		mov	edx, [esp+arg_4]
		push	ebx		; Size
		push	edx		; Src
		push	eax		; Dst
		mov	[esi+7Ch], ebx
		call	memcpy
		add	esp, 0Ch

loc_10011DFC:				; CODE XREF: sub_10011D60+78j
		xor	eax, eax
		retn
sub_10011D60	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011E00	proc near		; CODE XREF: sub_10011FA0+91p

var_55		= byte ptr -55h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
Src		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		mov	eax, [esp+58h+arg_0]
		push	ebp
		mov	ebp, [esp+5Ch+arg_8]
		push	esi
		push	edi
		mov	[esp+64h+var_44], edx
		mov	edx, [esp+64h+arg_4]
		xor	edi, edi
		mov	[eax+4], edi
		push	3
		mov	[esp+68h+var_50], eax
		mov	[esp+68h+var_54], ecx
		mov	[esp+68h+var_3C], edx
		mov	[ecx+4], edi
		call	PK11_CreateDigestContext
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jnz	short loc_10011E67
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+58h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_10011E67:				; CODE XREF: sub_10011E00+43j
		lea	eax, [ebp+ebp*2+0]
		add	eax, eax
		movzx	ebp, ds:byte_1002B119[eax+eax]
		movzx	ecx, ds:byte_1002B118[eax+eax]
		add	eax, eax
		push	ebp
		mov	[esp+68h+var_4C], ecx
		mov	[esp+68h+var_40], ebp
		call	PORT_Alloc_Util
		mov	ecx, [esp+68h+var_50]
		add	esp, 4
		mov	[ecx+4], eax
		test	eax, eax
		jz	loc_10011F6D
		push	ebp
		mov	[ecx+8], ebp
		call	PORT_Alloc_Util
		mov	ecx, [esp+68h+var_54]
		add	esp, 4
		mov	[ecx+4], eax
		test	eax, eax
		jz	loc_10011F6D
		mov	[ecx+8], ebp
		mov	[esp+64h+var_55], 30h
		mov	[esp+64h+var_48], edi
		cmp	[esp+64h+var_4C], edi
		jbe	short loc_10011F44
		lea	ebp, [esp+64h+Src]

loc_10011ED0:				; CODE XREF: sub_10011E00+13Ej
		push	esi
		call	PK11_DigestBegin
		mov	edx, [ebx+8]
		mov	edi, eax
		mov	eax, [ebx+4]
		push	edx
		push	eax
		push	esi
		call	PK11_DigestOp
		push	1
		lea	ecx, [esp+78h+var_55]
		push	ecx
		push	esi
		or	edi, eax
		call	PK11_DigestOp
		mov	edx, [esp+80h+var_44]
		push	10h
		push	edx
		push	esi
		or	edi, eax
		call	PK11_DigestOp
		or	edi, eax
		mov	eax, [esp+8Ch+var_3C]
		push	10h
		push	eax
		push	esi
		call	PK11_DigestOp
		push	10h
		lea	ecx, [esp+9Ch+var_38]
		push	ecx
		push	ebp
		push	esi
		or	edi, eax
		call	PK11_DigestFinal
		add	esp, 44h
		or	edi, eax
		jnz	short loc_10011F8C
		mov	eax, [esp+64h+var_48]
		inc	[esp+64h+var_55]
		inc	eax
		add	ebp, 10h
		mov	[esp+64h+var_48], eax
		cmp	eax, [esp+64h+var_4C]
		jb	short loc_10011ED0
		mov	ebp, [esp+64h+var_40]

loc_10011F44:				; CODE XREF: sub_10011E00+CAj
		mov	eax, [esp+64h+var_50]
		mov	ecx, [eax+4]
		push	ebp		; Size
		lea	edx, [esp+68h+Src]
		push	edx		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esp+70h+var_54]
		mov	ecx, [eax+4]
		push	ebp		; Size
		lea	edx, [esp+ebp+74h+Src]
		push	edx		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 18h

loc_10011F6D:				; CODE XREF: sub_10011E00+99j
					; sub_10011E00+B4j ...
		push	1
		push	esi
		call	PK11_DestroyContext
		mov	ecx, [esp+6Ch+var_4]
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_10011F8C:				; CODE XREF: sub_10011E00+128j
		push	0FFFFD049h
		call	sub_100147C0
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10011F6D
sub_10011E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011FA0	proc near		; CODE XREF: sub_10012280+247p
					; sub_10012960+164p ...

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
Src		= dword	ptr -14h
Size		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	ecx, [esp+2Ch+arg_0]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		mov	ebx, eax
		mov	eax, [ecx+70h]
		xor	ebp, ebp
		mov	[esp+38h+var_2C], esi
		mov	[esp+38h+var_28], esi
		mov	[esp+38h+var_20], eax
		mov	[esp+38h+var_24], esi
		mov	[esp+38h+var_1C], esi
		mov	[esp+38h+Src], esi
		mov	[esp+38h+var_8], esi
		cmp	[edi+0F4h], esi
		jz	loc_1001222F
		lea	edx, [eax-1]	; switch 7 cases
		cmp	edx, 6
		ja	loc_10012219	; jumptable 10011FEE default case
		movzx	edx, ds:byte_1001226C[edx]
		jmp	ds:off_10012264[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10011FF5:				; CODE XREF: sub_10011FA0+4Ej
					; DATA XREF: .text:off_10012264o
		test	ebx, ebx	; jumptable 10011FEE cases 1-4,6,7
		jz	short loc_10012007
		lea	edx, [esp+38h+var_18]
		mov	[esp+38h+var_2C], edx
		lea	edx, [esp+38h+var_C]
		jmp	short loc_10012013
; ---------------------------------------------------------------------------

loc_10012007:				; CODE XREF: sub_10011FA0+57j
		lea	edx, [esp+38h+var_C]
		mov	[esp+38h+var_2C], edx
		lea	edx, [esp+38h+var_18]

loc_10012013:				; CODE XREF: sub_10011FA0+65j
		push	eax
		lea	eax, [edi+121h]
		lea	ebx, [ecx+64h]
		push	eax
		lea	ecx, [esp+40h+var_18]
		mov	[esp+40h+var_28], edx
		push	ecx
		lea	edx, [edi+101h]
		lea	ecx, [esp+44h+var_C]
		call	sub_10011E00
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1001216B
		mov	esi, [esp+38h+Size]
		mov	edx, [esp+38h+Src]
		push	esi		; Size
		push	edx		; Src
		lea	eax, [edi+151h]
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esp+44h+var_4]
		mov	edx, [esp+44h+var_8]
		push	ecx		; Size
		push	edx		; Src
		lea	eax, [edi+191h]
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esp+50h+var_28]
		mov	edx, [esp+50h+var_2C]
		mov	ebx, [esp+50h+var_20]
		push	ecx
		mov	[edi+1D4h], esi
		push	edx
		lea	esi, [edi+48h]
		mov	eax, ebx
		call	sub_10010FB0
		add	esp, 20h
		test	eax, eax
		jnz	loc_10012167
		mov	eax, [edi+22Ch]
		lea	ebx, [ebx+ebx*2]
		add	ebx, ebx
		mov	esi, ds:dword_1002B11C[ebx+ebx]
		add	ebx, ebx
		push	eax
		push	esi
		mov	dword ptr [edi+0C4h], offset PK11_DestroyContext
		call	PK11_GetBestSlot
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	loc_10012167
		mov	eax, [esp+38h+arg_0]
		add	eax, 74h
		push	eax
		push	esi
		call	PK11_ParamFromIV
		add	esp, 8
		mov	[esp+38h+var_20], eax
		test	eax, eax
		jz	loc_10012167
		mov	ecx, [edi+22Ch]
		mov	edx, [esp+38h+var_2C]
		push	ecx
		push	eax
		push	edx
		push	105h
		push	4
		push	esi
		push	ebp
		call	__PK11_CreateContextByRawKey
		mov	[esp+54h+var_24], eax
		mov	eax, [esp+54h+var_20]
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 24h
		cmp	[esp+38h+var_24], 0
		jz	short loc_10012167
		mov	eax, [esp+38h+arg_0]
		add	eax, 74h
		push	eax
		push	esi
		call	PK11_ParamFromIV
		add	esp, 8
		mov	[esp+38h+var_20], eax
		test	eax, eax
		jz	short loc_10012167
		mov	ecx, [edi+22Ch]
		mov	edx, [esp+38h+var_28]
		push	ecx
		push	eax
		push	edx
		push	104h
		push	4
		push	esi
		push	ebp
		call	__PK11_CreateContextByRawKey
		mov	esi, eax
		mov	eax, [esp+54h+var_20]
		push	1
		push	eax
		mov	[esp+5Ch+var_1C], esi
		call	SECITEM_FreeItem_Util
		add	esp, 24h
		test	esi, esi
		jnz	short loc_100121B1

loc_10012167:				; CODE XREF: sub_10011FA0+F0j
					; sub_10011FA0+122j ...
		mov	esi, [esp+38h+var_24]

loc_1001216B:				; CODE XREF: sub_10011FA0+9Bj
		mov	eax, [edi+0C4h]
		test	eax, eax
		jz	short loc_10012197
		test	esi, esi
		jz	short loc_10012181
		push	1
		push	esi
		call	eax
		add	esp, 8

loc_10012181:				; CODE XREF: sub_10011FA0+1D7j
		mov	eax, [esp+38h+var_1C]
		test	eax, eax
		jz	short loc_10012197
		mov	ecx, [edi+0C4h]
		push	1
		push	eax
		call	ecx
		add	esp, 8

loc_10012197:				; CODE XREF: sub_10011FA0+1D3j
					; sub_10011FA0+1E7j
		mov	dword ptr [edi+0C4h], 0
		test	ebp, ebp
		jz	loc_1001222F
		push	ebp
		call	PK11_FreeSlot
		jmp	short loc_1001222C
; ---------------------------------------------------------------------------

loc_100121B1:				; CODE XREF: sub_10011FA0+1C5j
		push	ebp
		call	PK11_FreeSlot
		mov	edx, [esp+3Ch+var_24]
		mov	eax, offset PK11_CipherOp
		mov	[edi+0BCh], eax
		mov	[edi+0C0h], eax
		mov	eax, [esp+3Ch+var_1C]
		mov	[edi+0B8h], eax
		mov	eax, [esp+3Ch+arg_0]
		mov	[edi+0B4h], edx
		movzx	ecx, ds:byte_1002B11A[ebx]
		mov	[edi+0CCh], ecx
		movzx	edx, ds:byte_1002B11B[ebx]
		mov	[edi+0C8h], edx
		mov	ecx, [eax+70h]
		mov	[edi+5Ch], ecx
		mov	edx, [eax+80h]
		mov	[edi+60h], edx
		mov	eax, [eax+84h]
		add	esp, 4
		xor	esi, esi
		mov	[edi+64h], eax
		jmp	short loc_10012232
; ---------------------------------------------------------------------------

loc_10012219:				; CODE XREF: sub_10011FA0+41j
					; sub_10011FA0+4Ej
					; DATA XREF: ...
		xor	ecx, ecx	; jumptable 10011FEE default case
		test	ebx, ebx
		setnz	cl
		add	ecx, 0FFFFD006h
		push	ecx
		call	PORT_SetError_Util

loc_1001222C:				; CODE XREF: sub_10011FA0+20Fj
		add	esp, 4

loc_1001222F:				; CODE XREF: sub_10011FA0+35j
					; sub_10011FA0+203j
		or	esi, 0FFFFFFFFh

loc_10012232:				; CODE XREF: sub_10011FA0+277j
		mov	eax, [esp+38h+var_2C]
		test	eax, eax
		jz	short loc_10012245
		push	0
		push	eax
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_10012245:				; CODE XREF: sub_10011FA0+298j
		mov	eax, [esp+38h+var_28]
		test	eax, eax
		jz	short loc_10012258
		push	0
		push	eax
		call	SECITEM_ZfreeItem_Util
		add	esp, 8

loc_10012258:				; CODE XREF: sub_10011FA0+2ABj
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 2Ch
		retn
sub_10011FA0	endp

; ---------------------------------------------------------------------------
		align 4
off_10012264	dd offset loc_10011FF5	; DATA XREF: sub_10011FA0+4Er
		dd offset loc_10012219	; jump table for switch	statement
byte_1001226C	db	0,     0,     0,     0 ; DATA XREF: sub_10011FA0+47r
		db	1,     0,     0	; indirect table for switch statement
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012280(int,	int, int, int, size_t Size, int, int)
sub_10012280	proc near		; CODE XREF: .text:10013CF0p

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
Src		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Dst		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Size		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 68h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_C]
		push	ebx
		push	ebp
		mov	ebp, [esp+70h+arg_0]
		push	esi
		mov	esi, [esp+74h+Size]
		mov	[esp+74h+Src], eax
		mov	eax, [ebp+0F4h]
		push	edi
		mov	edi, [esp+78h+arg_4]
		mov	[esp+78h+var_5C], eax
		lea	eax, [edi-1]	; switch 7 cases
		mov	[esp+78h+var_4C], edi
		mov	[esp+78h+var_60], ecx
		mov	[esp+78h+var_48], edx
		mov	[esp+78h+var_68], 0
		cmp	eax, 6
		ja	loc_100124D7	; jumptable 100122DD default case
		movzx	ecx, ds:byte_10012514[eax]
		jmp	ds:off_1001250C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100122E4:				; CODE XREF: sub_10012280+5Dj
					; DATA XREF: .text:off_1001250Co
		movzx	eax, word ptr [ebp+26Ah] ; jumptable 100122DD cases 1-4,6,7
		movzx	edx, word ptr [ebp+26Eh]
		and	edx, eax
		mov	eax, 1
		mov	ecx, edi
		shl	eax, cl
		and	edx, 0DEh
		test	al, dl
		jz	loc_100124D7	; jumptable 100122DD default case
		lea	eax, [edi+edi*2]
		add	eax, eax
		movzx	ebx, ds:byte_1002B120[eax+eax]
		add	eax, eax
		lea	ecx, ds:0[ebx*8]
		mov	[esp+78h+var_54], ebx
		cmp	[esp+78h+arg_8], ecx
		jnz	loc_100124D7	; jumptable 100122DD default case
		movzx	edx, ds:byte_1002B121[eax]
		cmp	esi, edx
		jnz	loc_100124D7	; jumptable 100122DD default case
		movzx	eax, ds:byte_1002B122[eax]
		cmp	[esp+78h+arg_18], eax
		jnz	loc_100124D7	; jumptable 100122DD default case
		mov	ecx, [ebp+304h]
		mov	edx, [ecx]
		push	edx
		call	PK11_GetPrivateModulusLen
		mov	edi, eax
		add	esp, 4
		mov	[esp+78h+var_64], edi
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10012380
		mov	eax, [esp+78h+arg_14]
		mov	[esp+78h+var_64], eax
		mov	edi, eax
		jmp	short loc_1001238D
; ---------------------------------------------------------------------------

loc_10012380:				; CODE XREF: sub_10012280+EFj
		cmp	[esp+78h+arg_14], edi
		ja	loc_100124D7	; jumptable 100122DD default case

loc_1001238D:				; CODE XREF: sub_10012280+FEj
		mov	ecx, [esp+78h+arg_14]
		lea	edx, [esi+ecx]
		cmp	edx, ebx
		jb	loc_100124D7	; jumptable 100122DD default case
		push	edi
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+78h+var_68], eax
		test	eax, eax
		jz	loc_100124E4
		mov	ecx, [esp+78h+arg_14]
		mov	edx, [esp+78h+var_60]
		push	ecx
		mov	ecx, [esp+7Ch+var_64]
		push	edx
		push	ecx
		lea	edx, [esp+84h+var_58]
		sub	ebx, esi
		push	edx
		sub	edi, ebx
		push	eax
		add	edi, eax
		mov	eax, [ebp+304h]
		mov	ecx, [eax]
		push	ecx
		call	PK11_PubDecryptRaw
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10012445
		mov	edx, [esp+78h+var_64]
		cmp	edx, [esp+78h+var_58]
		jnz	short loc_10012445
		mov	eax, [esp+78h+var_68]
		cmp	byte ptr [eax],	0
		jnz	short loc_10012438
		cmp	byte ptr [eax+1], 2
		jnz	short loc_10012438
		cmp	byte ptr [edi-1], 0
		jnz	short loc_10012438
		cmp	word ptr [ebp+18h], 0
		jz	short loc_1001244F
		mov	eax, offset dword_1002B1A0
		lea	edx, [edi-9]
		sub	edx, eax
		mov	ecx, 8
		mov	[esp+78h+var_60], edx
		jmp	short loc_10012426
; ---------------------------------------------------------------------------

loc_10012422:				; CODE XREF: sub_10012280+1B6j
		mov	edx, [esp+78h+var_60]

loc_10012426:				; CODE XREF: sub_10012280+1A0j
		mov	edx, [edx+eax]
		cmp	edx, [eax]
		jnz	short loc_1001244F
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_10012422

loc_10012438:				; CODE XREF: sub_10012280+178j
					; sub_10012280+17Ej ...
		push	0FFFFD006h
		call	PORT_SetError_Util
		add	esp, 4

loc_10012445:				; CODE XREF: sub_10012280+165j
					; sub_10012280+16Fj
		push	ebx
		push	edi
		call	PK11_GenerateRandom
		add	esp, 8

loc_1001244F:				; CODE XREF: sub_10012280+18Bj
					; sub_10012280+1ABj
		test	esi, esi
		jz	short loc_10012466
		mov	eax, [esp+78h+Src]
		push	esi		; Size
		push	eax		; Src
		lea	ecx, [esp+80h+Dst]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10012466:				; CODE XREF: sub_10012280+1D1j
		push	ebx		; Size
		lea	edx, [esp+esi+7Ch+Dst]
		push	edi		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [ebp+80h]
		mov	ecx, [ebp+7Ch]
		mov	edx, [ebp+78h]
		mov	ebx, [esp+84h+arg_18]
		mov	edi, [esp+84h+var_54]
		push	eax
		mov	eax, [ebp+74h]
		push	ecx
		push	edx
		push	eax
		mov	eax, [esp+94h+arg_8]
		lea	ecx, ds:0[esi*8]
		mov	esi, [esp+94h+var_5C]
		mov	edx, eax
		sub	edx, ecx
		push	edx
		push	eax
		mov	eax, [esp+9Ch+var_48]
		push	eax
		lea	ecx, [esp+0A0h+Dst]
		push	ecx
		mov	ecx, [esp+0A4h+var_4C]
		call	sub_10011D60
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_100124E4
		mov	edx, esi
		push	edx
		mov	edi, ebp
		call	sub_10011FA0
		add	esp, 4
		test	eax, eax
		jnz	short loc_100124E4
		xor	esi, esi
		jmp	short loc_100124E7
; ---------------------------------------------------------------------------

loc_100124D7:				; CODE XREF: sub_10012280+50j
					; sub_10012280+5Dj ...
		push	0FFFFD006h	; jumptable 100122DD default case
		call	PORT_SetError_Util
		add	esp, 4

loc_100124E4:				; CODE XREF: sub_10012280+12Ej
					; sub_10012280+240j ...
		or	esi, 0FFFFFFFFh

loc_100124E7:				; CODE XREF: sub_10012280+255j
		mov	eax, [esp+78h+var_68]
		push	eax
		call	PORT_Free_Util
		mov	ecx, [esp+7Ch+var_4]
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
sub_10012280	endp

; ---------------------------------------------------------------------------
		align 4
off_1001250C	dd offset loc_100122E4	; DATA XREF: sub_10012280+5Dr
		dd offset loc_100124D7	; jump table for switch	statement
byte_10012514	db	0,     0,     0,     0 ; DATA XREF: sub_10012280+56r
		db	1,     0,     0	; indirect table for switch statement
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012520	proc near		; CODE XREF: sub_10013DA0+1B3p
					; sub_10013DA0+20Cp

Dst		= dword	ptr -1Ch
Src		= byte ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_0]
		push	ebx
		mov	ebx, [esp+20h+arg_4]
		push	edi
		mov	edi, ecx
		mov	[esp+24h+Dst], eax
		mov	eax, [edi+1ECh]
		test	eax, eax
		jnz	short loc_1001256E
		call	sub_10010B90
		test	eax, eax
		jnz	short loc_1001255B
		mov	eax, [edi+1ECh]
		test	eax, eax
		jnz	short loc_1001256E

loc_1001255B:				; CODE XREF: sub_10012520+2Fj
		pop	edi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001256E:				; CODE XREF: sub_10012520+26j
					; sub_10012520+39j
		mov	edi, [edi+1F0h]
		push	ebp
		push	esi
		lea	ebp, [esp+2Ch+Src]
		mov	esi, eax
		test	edi, edi
		jle	short loc_100125DD
		dec	edi
		mov	eax, 0AAAAAAABh
		mul	edi
		mov	edi, edx
		shr	edi, 1
		inc	edi
		jmp	short loc_10012594
; ---------------------------------------------------------------------------
		align 10h

loc_10012590:				; CODE XREF: sub_10012520+BBj
		mov	ebx, [esp+2Ch+arg_4]

loc_10012594:				; CODE XREF: sub_10012520+6Dj
		mov	dl, [esi]
		test	dl, dl
		jz	short loc_100125D7
		mov	eax, [esp+2Ch+Dst]
		mov	ecx, ebx
		test	ebx, ebx
		jle	short loc_100125D7

loc_100125A4:				; CODE XREF: sub_10012520+A0j
		cmp	[eax], dl
		jnz	short loc_100125B8
		mov	bl, [eax+1]
		cmp	bl, [esi+1]
		jnz	short loc_100125B8
		mov	bl, [eax+2]
		cmp	bl, [esi+2]
		jz	short loc_100125C4

loc_100125B8:				; CODE XREF: sub_10012520+86j
					; sub_10012520+8Ej
		sub	ecx, 3
		add	eax, 3
		test	ecx, ecx
		jg	short loc_100125A4
		jmp	short loc_100125D7
; ---------------------------------------------------------------------------

loc_100125C4:				; CODE XREF: sub_10012520+96j
		mov	cl, [eax]
		mov	dl, [eax+1]
		mov	al, bl
		mov	[ebp+0], cl
		mov	[ebp+1], dl
		mov	[ebp+2], al
		add	ebp, 3

loc_100125D7:				; CODE XREF: sub_10012520+78j
					; sub_10012520+82j ...
		add	esi, 3
		dec	edi
		jnz	short loc_10012590

loc_100125DD:				; CODE XREF: sub_10012520+5Ej
		mov	eax, [esp+2Ch+Dst]
		lea	ecx, [esp+2Ch+Src]
		sub	ebp, ecx
		mov	esi, ebp
		push	esi		; Size
		mov	edx, ecx
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esp+38h+var_4]
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10012520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012610	proc near		; CODE XREF: sub_10012960+96p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 1Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+arg_8]
		push	esi
		push	edi
		mov	edi, [esp+2Ch+arg_0]
		mov	eax, [edi+1ECh]
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	short loc_10012650
		call	sub_10010B90
		test	eax, eax
		jnz	loc_10012818
		mov	eax, [edi+1ECh]
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jz	loc_10012818

loc_10012650:				; CODE XREF: sub_10012610+1Fj
		cmp	dword ptr [edi+1F4h], 0
		jnz	short loc_1001269B
		movzx	edx, word ptr [edi+26Eh]
		movzx	eax, word ptr [edi+26Ah]
		and	edx, eax
		and	edx, 0DEh
		jz	short loc_1001269B
		mov	eax, offset byte_1002B104
		mov	esi, 6
		jmp	short loc_10012680
; ---------------------------------------------------------------------------
		align 10h

loc_10012680:				; CODE XREF: sub_10012610+6Bj
					; sub_10012610+81j
		mov	cl, [eax]
		mov	ebx, 1
		shl	ebx, cl
		test	edx, ebx
		jnz	short loc_10012695
		add	eax, 3
		dec	esi
		jnz	short loc_10012680
		jmp	short loc_1001269B
; ---------------------------------------------------------------------------

loc_10012695:				; CODE XREF: sub_10012610+7Bj
		mov	[edi+1F4h], eax

loc_1001269B:				; CODE XREF: sub_10012610+47j
					; sub_10012610+5Fj ...
		mov	eax, [edi+1F4h]
		xor	ecx, ecx
		cmp	eax, ecx
		jz	short loc_100126AF
		mov	esi, eax
		mov	[esp+2Ch+var_1C], esi
		jmp	short loc_100126BB
; ---------------------------------------------------------------------------

loc_100126AF:				; CODE XREF: sub_10012610+95j
		mov	[esp+2Ch+var_1C], offset dword_1002B1A8
		mov	esi, [esp+2Ch+var_1C]

loc_100126BB:				; CODE XREF: sub_10012610+9Dj
		dec	[esp+2Ch+arg_4]
		mov	[esp+2Ch+var_C], ecx
		mov	[esp+2Ch+var_14], ecx
		mov	[esp+2Ch+var_10], 0FFFFFFFFh
		js	loc_100127A0
		mov	ecx, [edi+1F0h]
		mov	[esp+2Ch+var_8], ecx
		nop

loc_100126E0:				; CODE XREF: sub_10012610+17Ej
		xor	eax, eax
		cmp	[esp+2Ch+var_8], eax
		jbe	loc_10012787
		mov	dl, [esi]
		mov	edi, [esp+2Ch+var_18]
		mov	bl, [ebp+0]
		mov	byte ptr [esp+2Ch+arg_8], dl
		add	edi, 2
		lea	esp, [esp+0]

loc_10012700:				; CODE XREF: sub_10012610+171j
		cmp	bl, byte ptr [esp+2Ch+arg_8]
		jnz	short loc_1001271E
		mov	cl, [ebp+1]
		cmp	cl, [esi+1]
		jnz	short loc_1001271E
		mov	dl, [ebp+2]
		cmp	dl, [esi+2]
		jnz	short loc_1001271E
		test	bl, bl
		jnz	loc_100127CE

loc_1001271E:				; CODE XREF: sub_10012610+F4j
					; sub_10012610+FCj ...
		mov	ecx, [esp+2Ch+var_18]
		cmp	bl, [ecx+eax]
		jnz	short loc_10012771
		mov	cl, [ebp+1]
		cmp	cl, [edi-1]
		jnz	short loc_10012771
		mov	dl, [ebp+2]
		cmp	dl, [edi]
		jnz	short loc_10012771
		test	bl, bl
		jz	short loc_10012771
		movzx	ecx, cl
		movzx	edx, dl
		shl	ecx, 8
		movzx	esi, bl
		or	ecx, edx
		mov	edx, esi
		sub	edx, 2
		jz	short loc_10012756
		sub	edx, 2
		mov	edx, ecx
		jnz	short loc_1001275B

loc_10012756:				; CODE XREF: sub_10012610+13Dj
		mov	edx, 28h

loc_1001275B:				; CODE XREF: sub_10012610+144j
		cmp	edx, [esp+2Ch+var_14]
		jle	short loc_1001276D
		mov	[esp+2Ch+var_10], esi
		mov	[esp+2Ch+var_14], edx
		mov	[esp+2Ch+var_C], ecx

loc_1001276D:				; CODE XREF: sub_10012610+14Fj
		mov	esi, [esp+2Ch+var_1C]

loc_10012771:				; CODE XREF: sub_10012610+115j
					; sub_10012610+11Dj ...
		mov	ecx, [esp+2Ch+arg_0]
		add	eax, 3
		add	edi, 3
		cmp	eax, [ecx+1F0h]
		jb	loc_10012700

loc_10012787:				; CODE XREF: sub_10012610+D6j
		add	ebp, 3
		dec	[esp+2Ch+arg_4]
		jns	loc_100126E0
		mov	eax, [esp+2Ch+var_10]
		test	eax, eax
		jns	loc_10012823

loc_100127A0:				; CODE XREF: sub_10012610+BFj
		mov	edx, [esp+2Ch+var_4]
		mov	al, [edx]
		cmp	al, 1
		jz	short loc_1001280B
		cmp	al, 3
		jz	short loc_1001280B
		cmp	al, 2
		jz	short loc_100127F3
		cmp	al, 4
		jz	short loc_100127F3
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100127CE:				; CODE XREF: sub_10012610+108j
		movzx	edx, byte ptr [ebp+1]
		movzx	eax, byte ptr [ebp+2]
		mov	ecx, [esp+2Ch+arg_C]
		shl	edx, 8
		or	edx, eax
		add	edx, 7
		pop	edi
		sar	edx, 3
		pop	esi
		mov	[ecx], edx
		movzx	eax, byte ptr [ebp+0]
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100127F3:				; CODE XREF: sub_10012610+1A0j
					; sub_10012610+1A4j
		push	0FFFFD000h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1001280B:				; CODE XREF: sub_10012610+198j
					; sub_10012610+19Cj
		push	0FFFFD001h
		call	PORT_SetError_Util
		add	esp, 4

loc_10012818:				; CODE XREF: sub_10012610+28j
					; sub_10012610+3Aj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10012823:				; CODE XREF: sub_10012610+18Aj
		mov	ecx, [esp+2Ch+var_C]
		mov	edx, [esp+2Ch+arg_C]
		pop	edi
		pop	esi
		add	ecx, 7
		sar	ecx, 3
		pop	ebp
		mov	[edx], ecx
		pop	ebx
		add	esp, 1Ch
		retn
sub_10012610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012840	proc near		; CODE XREF: sub_10013420+23Ap

var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	1
		push	0
		push	0
		lea	edx, [esp+18h+var_C]
		mov	[esp+18h+var_8], eax
		mov	eax, [esi+260h]
		push	edx
		push	eax
		mov	[esp+20h+var_4], ecx
		call	CERT_NewTempCertificate
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001287D
		push	0FFFFD004h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001287D:				; CODE XREF: sub_10012840+27j
		mov	[esi+6Ch], eax
		xor	eax, eax
		add	esp, 0Ch
		retn
sub_10012840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012890	proc near		; CODE XREF: sub_10012960+19Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_4]
		mov	eax, [ebp+8]
		push	edi
		mov	edi, [esp+8+arg_0]
		add	eax, 0Bh
		cmp	edi, eax
		jnb	short loc_100128B6
		push	0FFFFE00Eh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100128B6:				; CODE XREF: sub_10012890+12j
		push	ebx
		push	edi
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		mov	[esp+0Ch+arg_0], ebx
		test	ebx, ebx
		jnz	short loc_100128CE
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100128CE:				; CODE XREF: sub_10012890+38j
		push	esi
		mov	byte ptr [ebx],	0
		lea	esi, [ebx+1]
		mov	byte ptr [esi],	2
		sub	edi, [ebp+8]
		inc	esi
		sub	edi, 3
		push	edi
		push	esi
		call	PK11_GenerateRandom
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10012944
		xor	ebp, ebp
		test	edi, edi
		jle	short loc_1001291E

loc_100128F4:				; CODE XREF: sub_10012890+88j
		cmp	byte ptr [esi+ebp], 0
		lea	ebx, [esi+ebp]
		jnz	short loc_10012915
		lea	ecx, [ecx+0]

loc_10012900:				; CODE XREF: sub_10012890+83j
		push	1
		push	ebx
		call	PK11_GenerateRandom
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10012940
		cmp	byte ptr [ebx],	0
		jz	short loc_10012900

loc_10012915:				; CODE XREF: sub_10012890+6Bj
		inc	ebp
		cmp	ebp, edi
		jl	short loc_100128F4
		mov	ebx, [esp+10h+arg_0]

loc_1001291E:				; CODE XREF: sub_10012890+62j
		mov	eax, [esp+10h+arg_4]
		add	esi, edi
		mov	byte ptr [esi],	0
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		push	ecx		; Size
		push	edx		; Src
		inc	esi
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10012940:				; CODE XREF: sub_10012890+7Ej
		mov	ebx, [esp+10h+arg_0]

loc_10012944:				; CODE XREF: sub_10012890+5Cj
		push	ebx
		call	PORT_Free_Util
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		retn
sub_10012890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012960	proc near		; CODE XREF: sub_10013420+267p

var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
Dst		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 80h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+80h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+88h+arg_0]
		mov	eax, [ebp+0F4h]
		push	esi
		mov	[esp+8Ch+var_64], eax
		mov	eax, [ebp+6Ch]
		xor	ebx, ebx
		push	edi
		push	eax
		mov	esi, ecx
		mov	[esp+94h+var_7C], ebx
		mov	[esp+94h+var_80], ebx
		mov	[esp+94h+var_78], ebx
		call	CERT_ExtractPublicKey
		mov	edi, eax
		add	esp, 4
		mov	[esp+90h+var_74], edi
		cmp	edi, ebx
		jnz	short loc_100129C1
		push	0FFFFD004h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	loc_10012BA7
; ---------------------------------------------------------------------------

loc_100129C1:				; CODE XREF: sub_10012960+4Aj
		mov	ebx, 1
		push	edi
		mov	[ebp+74h], ebx
		mov	[ebp+7Ch], ebx
		call	SECKEY_PublicKeyStrengthInBits
		mov	[ebp+78h], eax
		mov	[ebp+80h], eax
		mov	eax, 55555556h
		imul	[esp+94h+arg_4]
		lea	ecx, [esp+94h+var_6C]
		push	ecx
		mov	eax, edx
		shr	eax, 1Fh
		push	esi
		add	eax, edx
		push	eax
		push	ebp
		call	sub_10012610
		mov	esi, eax
		add	esp, 14h
		mov	[esp+90h+var_60], esi
		test	esi, esi
		jns	short loc_10012A1A
		push	ebx
		push	ebp
		call	sub_10011060
		add	esp, 8
		or	esi, 0FFFFFFFFh
		jmp	loc_10012BA7
; ---------------------------------------------------------------------------

loc_10012A1A:				; CODE XREF: sub_10012960+A6j
		lea	ecx, [esp+90h+Dst]
		push	40h
		push	ecx
		call	PK11_GenerateRandom
		lea	eax, [esi+esi*2]
		add	eax, eax
		movzx	ebx, ds:byte_1002B122[eax+eax]
		movzx	edx, ds:byte_1002B121[eax+eax]
		add	eax, eax
		add	esp, 8
		mov	[esp+90h+var_70], 0
		mov	[esp+90h+var_68], edx
		test	ebx, ebx
		jz	short loc_10012A66
		lea	eax, [esp+90h+var_4C]
		push	ebx
		push	eax
		call	PK11_GenerateRandom
		lea	ecx, [esp+98h+var_4C]
		add	esp, 8
		mov	[esp+90h+var_70], ecx

loc_10012A66:				; CODE XREF: sub_10012960+EEj
		mov	edi, [esp+90h+var_6C]
		mov	edx, [ebp+80h]
		push	edx
		mov	edx, [ebp+7Ch]
		push	edx
		mov	edx, [ebp+78h]
		mov	eax, edi
		sub	eax, [esp+98h+var_68]
		push	edx
		mov	edx, [ebp+74h]
		mov	[esp+9Ch+var_6C], eax
		add	eax, eax
		push	edx
		add	eax, eax
		add	eax, eax
		push	eax
		lea	ecx, ds:0[edi*8]
		push	ecx
		mov	[esp+0A8h+var_5C], ecx
		mov	ecx, [esp+0A8h+var_70]
		push	ecx
		lea	edx, [esp+0ACh+Dst]
		mov	ecx, esi
		mov	esi, [esp+0ACh+var_64]
		push	edx
		call	sub_10011D60
		add	esp, 20h
		test	eax, eax
		jnz	loc_10012B98
		mov	eax, esi
		push	eax
		mov	eax, 1
		mov	edi, ebp
		call	sub_10011FA0
		add	esp, 4
		test	eax, eax
		jnz	loc_10012B98
		mov	ecx, [esp+90h+var_74]
		push	ecx
		call	SECKEY_PublicKeyStrength
		mov	edi, [esp+94h+var_68]
		mov	esi, [esp+94h+var_6C]
		lea	ecx, [esp+94h+var_58]
		push	ecx
		lea	edx, [esp+edi+98h+Dst]
		push	eax
		mov	[esp+9Ch+var_80], eax
		mov	[esp+9Ch+var_54], edx
		mov	[esp+9Ch+var_50], esi
		call	sub_10012890
		add	esp, 0Ch
		mov	[esp+90h+var_78], eax
		test	eax, eax
		jz	loc_10012B98
		cmp	word ptr [ebp+18h], 0
		jz	short loc_10012B2F
		mov	edx, [esp+90h+var_78]
		mov	ecx, [esp+90h+var_80]
		sub	edx, esi
		mov	eax, 3030303h
		lea	ecx, [edx+ecx-9]
		mov	[ecx], eax
		mov	[ecx+4], eax

loc_10012B2F:				; CODE XREF: sub_10012960+1B5j
		mov	edx, [esp+90h+var_80]
		push	edx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+90h+var_7C], eax
		test	eax, eax
		jz	short loc_10012B98
		mov	eax, [ebp+22Ch]
		mov	ecx, [esp+90h+var_80]
		mov	edx, [esp+90h+var_78]
		push	eax
		mov	eax, [esp+94h+var_7C]
		push	ecx
		mov	ecx, [esp+98h+var_74]
		push	edx
		push	eax
		push	ecx
		call	PK11_PubEncryptRaw
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10012B98
		mov	edx, [esp+90h+var_7C]
		mov	ecx, [esp+90h+var_70]
		push	edx
		mov	edx, [esp+94h+var_5C]
		push	edi
		lea	eax, [esp+98h+Dst]
		push	eax
		mov	eax, [esp+9Ch+var_60]
		push	ebx
		mov	ebx, [esp+0A0h+var_80]
		push	ecx
		push	edx
		push	eax
		mov	edi, ebp
		call	sub_10011330
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_10012BA1

loc_10012B98:				; CODE XREF: sub_10012960+154j
					; sub_10012960+16Ej ...
		mov	edi, [esp+90h+var_74]
		or	esi, 0FFFFFFFFh
		jmp	short loc_10012BA7
; ---------------------------------------------------------------------------

loc_10012BA1:				; CODE XREF: sub_10012960+236j
		mov	edi, [esp+90h+var_74]
		xor	esi, esi

loc_10012BA7:				; CODE XREF: sub_10012960+5Cj
					; sub_10012960+B5j ...
		push	40h		; Size
		lea	ecx, [esp+94h+Dst]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		mov	ebx, [esp+9Ch+var_80]
		mov	edx, [esp+9Ch+var_7C]
		push	ebx
		push	edx
		call	PORT_ZFree_Util
		mov	eax, [esp+0A4h+var_78]
		push	ebx
		push	eax
		call	PORT_ZFree_Util
		push	edi
		call	SECKEY_DestroyPublicKey
		mov	ecx, [esp+0B0h+var_4]
		add	esp, 20h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 80h
		retn
sub_10012960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012C00	proc near		; CODE XREF: sub_10013080+DFp
		push	esi
		mov	esi, [edi+0F4h]
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_10012C33
		mov	ecx, [eax]
		mov	[esi+54h], ecx
		mov	edx, [eax+4]
		mov	[esi+58h], edx
		mov	ecx, [eax+8]
		mov	[esi+5Ch], ecx
		mov	edx, [eax+0Ch]
		mov	[esi+60h], edx
		mov	eax, [edi+6Ch]
		push	eax
		call	CERT_DupCertificate
		add	esp, 4
		mov	[esi+10h], eax

loc_10012C33:				; CODE XREF: sub_10012C00+Bj
		test	dword ptr [edi+14h], 400h
		jnz	short loc_10012C4E
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10012C4E
		mov	ecx, [edi+84h]
		push	esi
		call	ecx
		add	esp, 4

loc_10012C4E:				; CODE XREF: sub_10012C00+3Aj
					; sub_10012C00+40j
		pop	esi
		retn
sub_10012C00	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012C50	proc near		; CODE XREF: sub_10013080+223j
					; .text:10013D67j ...
		push	edi
		mov	edi, eax
		test	byte ptr [edi+0F9h], 2
		jz	short loc_10012C75
		mov	al, [edi+0FAh]
		test	al, 2
		jnz	short loc_10012C75
		or	al, 2
		mov	[edi+0FAh], al
		call	sub_10011450
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10012C75:				; CODE XREF: sub_10012C50+Aj
					; sub_10012C50+14j
		xor	eax, eax
		pop	edi
		retn
sub_10012C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012C80	proc near		; CODE XREF: sub_10013080+1D2p
					; .text:100133A5p ...
		push	ebx
		push	esi
		mov	esi, eax
		mov	bl, [esi+0F8h]
		mov	al, [esi+0F9h]
		mov	cl, bl
		or	cl, 4
		and	cl, al
		cmp	cl, al
		jnz	short loc_10012CC9
		cmp	dword ptr [esi+4Ch], 0
		jz	short loc_10012CA8
		call	sub_10011230
		jmp	short loc_10012CAD
; ---------------------------------------------------------------------------

loc_10012CA8:				; CODE XREF: sub_10012C80+1Fj
		call	sub_100110D0

loc_10012CAD:				; CODE XREF: sub_10012C80+26j
		test	eax, eax
		jnz	short loc_10012CCB
		mov	al, [esi+0F9h]
		mov	dl, al
		and	dl, bl
		cmp	dl, al
		jnz	short loc_10012CC9
		mov	dword ptr [esi+1DCh], 0

loc_10012CC9:				; CODE XREF: sub_10012C80+19j
					; sub_10012C80+3Dj
		xor	eax, eax

loc_10012CCB:				; CODE XREF: sub_10012C80+2Fj
		pop	esi
		pop	ebx
		retn
sub_10012C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012CD0	proc near		; CODE XREF: sub_10012DA0+88p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		push	eax
		mov	ebx, ecx
		mov	ebp, [ebx+0FCh]
		push	13h
		or	esi, 0FFFFFFFFh
		call	SGN_NewContext
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_10012D7E
		push	edi
		call	SGN_Begin
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10012D7E
		mov	ecx, [ebx+1D4h]
		push	ecx
		lea	edx, [ebx+151h]
		push	edx
		push	edi
		call	SGN_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10012D7E
		mov	eax, [ebx+1D4h]
		push	eax
		lea	ecx, [ebx+191h]
		push	ecx
		push	edi
		call	SGN_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10012D7E
		push	ebp
		lea	edx, [ebx+131h]
		push	edx
		push	edi
		call	SGN_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10012D7E
		mov	ebx, [ebx+6Ch]
		mov	eax, [ebx+44h]
		mov	ecx, [ebx+40h]
		push	eax
		push	ecx
		push	edi
		call	SGN_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10012D7E
		mov	edx, [esp+10h+arg_0]
		push	edx
		push	edi
		call	SGN_End
		add	esp, 8
		mov	esi, eax

loc_10012D7E:				; CODE XREF: sub_10012CD0+1Ej
					; sub_10012CD0+31j ...
		push	1
		push	edi
		call	SGN_DestroyContext
		add	esp, 8
		neg	esi
		pop	edi
		sbb	eax, eax
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10012CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012DA0	proc near		; CODE XREF: sub_10013080+123p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	ebx, eax
		cmp	byte ptr [ebx+100h], 1
		push	esi
		mov	[esp+20h+var_14], ebp
		mov	[esp+20h+var_10], ebp
		mov	[esp+20h+var_8], ebp
		jnz	loc_10012EBF
		mov	eax, [ebx+204h]
		cmp	eax, ebp
		jz	loc_10012EBF
		lea	ecx, [esp+20h+var_10]
		push	ecx
		mov	ecx, [ebx]
		lea	edx, [esp+24h+var_14]
		push	edx
		mov	edx, [ebx+208h]
		push	ebp
		push	ecx
		push	edx
		call	eax
		add	esp, 14h
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10012E05
		push	0FFFFD075h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	loc_10012ECC
; ---------------------------------------------------------------------------

loc_10012E05:				; CODE XREF: sub_10012DA0+4Ej
		cmp	eax, ebp
		jnz	loc_10012EBF
		mov	ecx, [esp+20h+var_14]
		cmp	ecx, ebp
		jz	loc_10012EAA
		mov	eax, [esp+20h+var_10]
		cmp	eax, ebp
		jz	short loc_10012E9D
		lea	ecx, [esp+20h+var_C]
		push	ecx
		mov	ecx, ebx
		call	sub_10012CD0
		add	esp, 4
		test	eax, eax
		jz	short loc_10012E3C
		or	esi, 0FFFFFFFFh
		jmp	loc_10012ECC
; ---------------------------------------------------------------------------

loc_10012E3C:				; CODE XREF: sub_10012DA0+92j
		push	edi
		mov	edi, [esp+24h+var_14]
		lea	edx, [esp+24h+var_C]
		push	edx
		add	edi, 3Ch
		call	sub_10011500
		mov	esi, eax
		mov	eax, [ebx+68h]
		add	esp, 4
		pop	edi
		cmp	eax, ebp
		jz	short loc_10012E64
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10012E64:				; CODE XREF: sub_10012DA0+B9j
		mov	eax, [esp+20h+var_14]
		push	eax
		call	CERT_DupCertificate
		mov	ecx, [ebx+0F4h]
		mov	[ebx+68h], eax
		mov	eax, [ecx+24h]
		add	esp, 4
		cmp	eax, ebp
		jz	short loc_10012E8A
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10012E8A:				; CODE XREF: sub_10012DA0+DFj
		mov	eax, [esp+20h+var_14]
		mov	edx, [ebx+0F4h]
		mov	[edx+24h], eax
		mov	[esp+20h+var_14], ebp
		jmp	short loc_10012EDD
; ---------------------------------------------------------------------------

loc_10012E9D:				; CODE XREF: sub_10012DA0+7Fj
		push	ecx
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esp+20h+var_14], ebp

loc_10012EAA:				; CODE XREF: sub_10012DA0+73j
		mov	eax, [esp+20h+var_10]
		cmp	eax, ebp
		jz	short loc_10012EBF
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4
		mov	[esp+20h+var_10], ebp

loc_10012EBF:				; CODE XREF: sub_10012DA0+1Dj
					; sub_10012DA0+2Bj ...
		push	2
		push	ebx
		call	sub_10011060
		add	esp, 8
		mov	esi, eax

loc_10012ECC:				; CODE XREF: sub_10012DA0+60j
					; sub_10012DA0+97j
		mov	eax, [esp+20h+var_14]
		cmp	eax, ebp
		jz	short loc_10012EDD
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10012EDD:				; CODE XREF: sub_10012DA0+FBj
					; sub_10012DA0+132j
		mov	eax, [esp+20h+var_10]
		cmp	eax, ebp
		jz	short loc_10012EEE
		push	eax
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10012EEE:				; CODE XREF: sub_10012DA0+143j
		mov	eax, [esp+20h+var_8]
		cmp	eax, ebp
		jz	short loc_10012EFF
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10012EFF:				; CODE XREF: sub_10012DA0+154j
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10012DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012F10	proc near		; CODE XREF: sub_10013080+1ADp

var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		push	1
		xor	ebx, ebx
		push	ebx
		push	ebx
		lea	edx, [esp+34h+var_18]
		mov	[esp+34h+var_14], eax
		mov	eax, [edi+260h]
		push	edx
		push	eax
		mov	[esp+3Ch+var_1C], ebx
		or	esi, 0FFFFFFFFh
		mov	[esp+3Ch+var_10], ecx
		call	CERT_NewTempCertificate
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jz	loc_10013046
		push	ebp
		mov	[edi+6Ch], ebp
		call	CERT_ExtractPublicKey
		add	esp, 4
		mov	[esp+28h+var_1C], eax
		test	eax, eax
		jz	loc_10013046
		mov	ecx, [esp+28h+arg_0]
		mov	edx, [esp+28h+arg_4]
		mov	[esp+28h+var_8], ecx
		mov	ecx, [edi+22Ch]
		push	ecx
		mov	[esp+2Ch+var_4], edx
		push	10h
		lea	edx, [esp+30h+var_C]
		push	edx
		push	eax
		call	VFY_CreateContext
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jz	loc_10013046
		push	ebx
		call	VFY_Begin
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	loc_10013046
		mov	eax, [edi+1D4h]
		push	eax
		lea	ecx, [edi+151h]
		push	ecx
		push	ebx
		call	VFY_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_10013046
		mov	edx, [edi+1D4h]
		push	edx
		lea	eax, [edi+191h]
		push	eax
		push	ebx
		call	VFY_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10013046
		push	10h
		lea	ecx, [edi+131h]
		push	ecx
		push	ebx
		call	VFY_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10013046
		mov	eax, [edi+2FCh]
		mov	edx, [eax+44h]
		mov	eax, [eax+40h]
		push	edx
		push	eax
		push	ebx
		call	VFY_Update
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10013046
		push	ebx
		call	VFY_End
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10013046
		mov	ecx, [edi]
		mov	edx, [edi+200h]
		mov	eax, [edi+1FCh]
		push	1
		push	1
		push	ecx
		push	edx
		call	eax
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_10013056

loc_10013046:				; CODE XREF: sub_10012F10+33j
					; sub_10012F10+4Bj ...
		push	ebp
		mov	dword ptr [edi+6Ch], 0
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10013056:				; CODE XREF: sub_10012F10+134j
		push	1
		push	ebx
		call	VFY_DestroyContext
		mov	ecx, [esp+30h+var_1C]
		push	ecx
		call	SECKEY_DestroyPublicKey
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_10012F10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10013080	proc near		; DATA XREF: sub_10013080+214o
					; .text:100133DEo ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		test	byte ptr [edi+16h], 1
		jnz	short loc_1001309D
		mov	eax, [edi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001309D:				; CODE XREF: sub_10013080+Bj
		mov	eax, [edi+298h]
		mov	esi, [edi+290h]
		add	eax, [edi+278h]
		cmp	esi, 1
		jb	loc_100132DE	; jumptable 100132BB default case
		movzx	ecx, byte ptr [eax]
		cmp	ecx, 8		; switch 9 cases
		ja	loc_100132F3	; jumptable 100130C4 default case
		jmp	ds:off_10013310[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100130CB:				; CODE XREF: sub_10013080+44j
					; DATA XREF: .text:off_10013310o
		mov	dl, [edi+0F8h]	; jumptable 100130C4 case 3
		test	dl, 4
		jnz	loc_100132DE	; jumptable 100132BB default case
		lea	ecx, [esi-1]
		cmp	ecx, 10h
		jnz	loc_100132DE	; jumptable 100132BB default case
		inc	eax
		lea	esi, [edi+121h]
		lea	ecx, [ecx+0]

loc_100130F0:				; CODE XREF: sub_10013080+86j
		mov	ebx, [esi]
		cmp	ebx, [eax]
		jnz	loc_100132DE	; jumptable 100132BB default case
		sub	ecx, 4
		add	eax, 4
		add	esi, 4
		cmp	ecx, 4
		jnb	short loc_100130F0
		test	ecx, ecx
		jz	short loc_10013138
		mov	bl, [eax]
		cmp	bl, [esi]
		jnz	loc_100132DE	; jumptable 100132BB default case
		cmp	ecx, 1
		jbe	short loc_10013138
		mov	bl, [eax+1]
		cmp	bl, [esi+1]
		jnz	loc_100132DE	; jumptable 100132BB default case
		cmp	ecx, 2
		jbe	short loc_10013138
		mov	cl, [eax+2]
		cmp	cl, [esi+2]
		jnz	loc_100132DE	; jumptable 100132BB default case

loc_10013138:				; CODE XREF: sub_10013080+8Aj
					; sub_10013080+99j ...
		or	dl, 4
		mov	[edi+0F8h], dl
		jmp	loc_10013250
; ---------------------------------------------------------------------------

loc_10013146:				; CODE XREF: sub_10013080+44j
					; DATA XREF: .text:off_10013310o
		mov	bl, 4		; jumptable 100130C4 case 6
		test	[edi+0F8h], bl
		jnz	loc_100132DE	; jumptable 100132BB default case
		dec	esi
		cmp	esi, 10h
		jnz	loc_100132DE	; jumptable 100132BB default case
		inc	eax
		call	sub_10012C00
		or	[edi+0F8h], bl
		jmp	loc_10013250
; ---------------------------------------------------------------------------

loc_1001316F:				; CODE XREF: sub_10013080+44j
					; DATA XREF: .text:off_10013310o
		lea	ecx, [esi-2]	; jumptable 100130C4 case 7
		lea	edx, [ecx-10h]
		cmp	edx, 10h
		ja	loc_100132DE	; jumptable 100132BB default case
		mov	dl, [eax+1]
		push	ecx		; Size
		add	eax, 2
		push	eax		; Src
		lea	eax, [edi+131h]
		push	eax		; Dst
		mov	[edi+100h], dl
		mov	[edi+0FCh], ecx
		call	memcpy
		add	esp, 0Ch
		mov	eax, edi
		call	sub_10012DA0
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_100131CC
		test	byte ptr [edi+16h], 1
		jnz	short loc_100131C3
		mov	ecx, [edi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100131C3:				; CODE XREF: sub_10013080+131j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100131CC:				; CODE XREF: sub_10013080+12Bj
		test	eax, eax
		jnz	loc_100132F3	; jumptable 100130C4 default case
		jmp	short loc_10013250
; ---------------------------------------------------------------------------

loc_100131D6:				; CODE XREF: sub_10013080+44j
					; DATA XREF: .text:off_10013310o
		cmp	dword ptr [edi+1FCh], 0	; jumptable 100130C4 case 8
		jnz	short loc_100131E9
		push	0FFFFD007h
		jmp	loc_100132EB
; ---------------------------------------------------------------------------

loc_100131E9:				; CODE XREF: sub_10013080+15Dj
		cmp	esi, 6
		jb	loc_100132F3	; jumptable 100130C4 default case
		movzx	ecx, byte ptr [eax+2]
		movzx	edx, byte ptr [eax+3]
		movzx	ebx, byte ptr [eax+5]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [eax+4]
		shl	edx, 8
		or	edx, ebx
		cmp	byte ptr [eax+1], 1
		jz	short loc_1001321C
		push	0FFFFD008h
		jmp	loc_100132EB
; ---------------------------------------------------------------------------

loc_1001321C:				; CODE XREF: sub_10013080+190j
		lea	ebx, [edx+ecx+6]
		cmp	ebx, esi
		ja	short loc_10013239
		push	edx
		lea	edx, [ecx+eax+6]
		push	edx
		add	eax, 6
		call	sub_10012F10
		add	esp, 8
		test	eax, eax
		jz	short loc_10013249

loc_10013239:				; CODE XREF: sub_10013080+1A2j
		push	4
		push	edi
		call	sub_10011060
		add	esp, 8
		jmp	loc_100132F3	; jumptable 100130C4 default case
; ---------------------------------------------------------------------------

loc_10013249:				; CODE XREF: sub_10013080+1B7j
		or	byte ptr [edi+0F8h], 2

loc_10013250:				; CODE XREF: sub_10013080+C1j
					; sub_10013080+EAj ...
		mov	eax, edi
		call	sub_10012C80
		test	eax, eax
		jnz	loc_100132F3	; jumptable 100130C4 default case
		test	byte ptr [edi+16h], 1
		mov	[edi+290h], eax
		jnz	short loc_1001327B
		mov	eax, [edi+24Ch]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001327B:				; CODE XREF: sub_10013080+1E9j
		cmp	dword ptr [edi+1DCh], 0
		jnz	short loc_1001328A
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001328A:				; CODE XREF: sub_10013080+202j
		mov	dword ptr [edi+1DCh], offset sub_10011CC0
		mov	dword ptr [edi+1E0h], offset sub_10013080
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		jmp	sub_10012C50
; ---------------------------------------------------------------------------

loc_100132A8:				; CODE XREF: sub_10013080+44j
					; DATA XREF: .text:off_10013310o
		movzx	ecx, byte ptr [eax+1] ;	jumptable 100130C4 case	0
		movzx	eax, byte ptr [eax+2]
		shl	ecx, 8
		or	eax, ecx
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	short loc_100132DE ; jumptable 100132BB	default	case
		jmp	ds:off_10013334[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100132C2:				; CODE XREF: sub_10013080+23Bj
					; DATA XREF: .text:off_10013334o
		mov	eax, 0FFFFD002h	; jumptable 100132BB case 0
		jmp	short loc_100132EA
; ---------------------------------------------------------------------------

loc_100132C9:				; CODE XREF: sub_10013080+23Bj
					; DATA XREF: .text:off_10013334o
		mov	eax, 0FFFFD003h	; jumptable 100132BB case 1
		jmp	short loc_100132EA
; ---------------------------------------------------------------------------

loc_100132D0:				; CODE XREF: sub_10013080+23Bj
					; DATA XREF: .text:off_10013334o
		mov	eax, 0FFFFD004h	; jumptable 100132BB case 3
		jmp	short loc_100132EA
; ---------------------------------------------------------------------------

loc_100132D7:				; CODE XREF: sub_10013080+23Bj
					; DATA XREF: .text:off_10013334o
		mov	eax, 0FFFFD008h	; jumptable 100132BB case 5
		jmp	short loc_100132EA
; ---------------------------------------------------------------------------

loc_100132DE:				; CODE XREF: sub_10013080+32j
					; sub_10013080+54j ...
		mov	eax, [edi+4Ch]	; jumptable 100132BB default case
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFD007h

loc_100132EA:				; CODE XREF: sub_10013080+247j
					; sub_10013080+24Ej ...
		push	eax

loc_100132EB:				; CODE XREF: sub_10013080+164j
					; sub_10013080+197j
		call	PORT_SetError_Util
		add	esp, 4

loc_100132F3:				; CODE XREF: sub_10013080+3Ej
					; sub_10013080+44j ...
		test	byte ptr [edi+16h], 1 ;	jumptable 100130C4 default case
		jnz	short loc_10013309
		mov	ecx, [edi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013309:				; CODE XREF: sub_10013080+277j
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_10013080	endp

; ---------------------------------------------------------------------------
off_10013310	dd offset loc_100132A8	; DATA XREF: sub_10013080+44r
		dd offset loc_100132F3	; jump table for switch	statement
		dd offset loc_100132F3
		dd offset loc_100130CB
		dd offset loc_100132F3
		dd offset loc_100132F3
		dd offset loc_10013146
		dd offset loc_1001316F
		dd offset loc_100131D6
off_10013334	dd offset loc_100132C2	; DATA XREF: sub_10013080+23Br
		dd offset loc_100132C9	; jump table for switch	statement
		dd offset loc_100132DE
		dd offset loc_100132D0
		dd offset loc_100132DE
		dd offset loc_100132D7
		align 10h

loc_10013350:				; DATA XREF: sub_10013420+314o
		push	esi
		mov	esi, [esp+8]
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001336B
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001336B:				; CODE XREF: .text:10013359j
		mov	eax, [esi+298h]
		add	eax, [esi+278h]
		cmp	dword ptr [esi+290h], 11h
		jnz	short loc_100133EA
		cmp	byte ptr [eax],	5
		jnz	short loc_100133EA
		push	10h
		lea	ecx, [esi+101h]
		push	ecx
		inc	eax
		push	eax
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100133EA
		or	byte ptr [esi+0F8h], 8
		mov	eax, esi
		call	sub_10012C80
		test	eax, eax
		jnz	short loc_100133F7
		test	byte ptr [esi+16h], 1
		mov	[esi+290h], eax
		jnz	short loc_100133CA
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100133CA:				; CODE XREF: .text:100133B8j
		xor	eax, eax
		cmp	[esi+1DCh], eax
		jz	short loc_10013410
		mov	dword ptr [esi+1DCh], offset sub_10011CC0
		mov	dword ptr [esi+1E0h], offset sub_10013080
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100133EA:				; CODE XREF: .text:1001337Ej
					; .text:10013383j ...
		push	0FFFFD007h
		call	PORT_SetError_Util
		add	esp, 4

loc_100133F7:				; CODE XREF: .text:100133ACj
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001340D
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001340D:				; CODE XREF: .text:100133FBj
		or	eax, 0FFFFFFFFh

loc_10013410:				; CODE XREF: .text:100133D2j
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10013420	proc near		; DATA XREF: sub_100137A0+489o
					; sub_100175D0+E3o ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		mov	eax, [esi+14h]
		test	al, al
		js	short loc_10013444
		push	0FFFFD00Eh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013444:				; CODE XREF: sub_10013420+Dj
		test	eax, 10000h
		jnz	short loc_1001345B
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001345B:				; CODE XREF: sub_10013420+29j
		mov	ecx, [esi+0F4h]
		mov	eax, [esi+298h]
		add	eax, [esi+278h]
		push	ebx
		mov	[esp+14h+arg_0], ecx
		mov	ecx, [esi+290h]
		push	ebp
		push	edi
		cmp	ecx, 0Bh
		jb	loc_10013743
		cmp	byte ptr [eax],	4
		jnz	loc_10013743
		movzx	ecx, byte ptr [eax+2]
		movzx	edx, byte ptr [eax+1]
		mov	[esp+1Ch+var_4], ecx
		movzx	ecx, byte ptr [eax+3]
		mov	[esp+1Ch+var_8], edx
		movzx	edx, byte ptr [eax+4]
		shl	cx, 8
		or	cx, dx
		mov	[esi+44h], cx
		movzx	ebx, byte ptr [eax+5]
		movzx	edx, byte ptr [eax+6]
		movzx	ebp, byte ptr [eax+7]
		movzx	edi, byte ptr [eax+9]
		shl	ebx, 8
		or	ebx, edx
		movzx	edx, byte ptr [eax+8]
		shl	ebp, 8
		or	ebp, edx
		movzx	edx, byte ptr [eax+0Ah]
		shl	edi, 8
		add	eax, 0Bh
		or	edi, edx
		mov	[esp+1Ch+var_C], eax
		cmp	cx, 2
		jz	short loc_100134EF
		jb	short loc_100134EF
		push	0FFFFD009h
		jmp	loc_1001376B
; ---------------------------------------------------------------------------

loc_100134EF:				; CODE XREF: sub_10013420+C1j
					; sub_10013420+C3j
		lea	eax, [edi+ebp]
		lea	ecx, [eax+ebx+0Bh]
		cmp	ecx, [esi+290h]
		ja	loc_10013766
		mov	eax, 55555556h
		imul	ebp
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		lea	edx, [eax+eax*2]
		mov	eax, ebp
		sub	eax, edx
		jnz	loc_10013766
		cmp	edi, 10h
		jnb	short loc_1001353C
		mov	[esi+121h], eax
		mov	[esi+125h], eax
		mov	[esi+129h], eax
		mov	[esi+12Dh], eax
		jmp	short loc_10013541
; ---------------------------------------------------------------------------

loc_1001353C:				; CODE XREF: sub_10013420+100j
		mov	edi, 10h

loc_10013541:				; CODE XREF: sub_10013420+11Aj
		push	edi		; Size
		mov	edi, [esp+20h+var_C]
		add	edi, ebx
		lea	edx, [edi+ebp]
		push	edx		; Src
		lea	eax, [esi+121h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		cmp	[esp+1Ch+var_8], 0
		jz	short loc_100135B8
		test	ebx, ebx
		jnz	loc_10013766
		test	ebp, ebp
		jnz	loc_10013766
		mov	edi, [esp+1Ch+arg_0]
		mov	ecx, [edi+10h]
		push	ecx
		call	CERT_DupCertificate
		mov	[esi+6Ch], eax
		mov	edx, [edi+44h]
		mov	[esi+74h], edx
		mov	eax, [edi+48h]
		mov	[esi+78h], eax
		mov	ecx, [edi+4Ch]
		mov	[esi+7Ch], ecx
		mov	edx, [edi+50h]
		push	edi
		lea	eax, [ebx+1]
		mov	edi, esi
		mov	[esi+80h], edx
		call	sub_10011FA0
		add	esp, 8
		test	eax, eax
		jnz	loc_10013773
		jmp	loc_10013693
; ---------------------------------------------------------------------------

loc_100135B8:				; CODE XREF: sub_10013420+140j
		cmp	[esp+1Ch+var_4], 1
		jz	short loc_100135C9
		push	0FFFFD008h
		jmp	loc_1001376B
; ---------------------------------------------------------------------------

loc_100135C9:				; CODE XREF: sub_10013420+19Dj
		test	ebp, ebp
		jnz	short loc_100135D7
		push	0FFFFD002h
		jmp	loc_1001376B
; ---------------------------------------------------------------------------

loc_100135D7:				; CODE XREF: sub_10013420+1ABj
		test	ebx, ebx
		jz	loc_10013766
		mov	ecx, [esp+1Ch+arg_0]
		cmp	dword ptr [ecx+4], 0
		jz	short loc_10013654
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_100135FD
		push	ecx
		call	eax
		mov	ecx, [esp+20h+arg_0]
		add	esp, 4

loc_100135FD:				; CODE XREF: sub_10013420+1D1j
		push	ecx
		call	sub_10017FD0
		push	108h
		call	PORT_ZAlloc_Util
		add	esp, 8
		mov	[esi+0F4h], eax
		test	eax, eax
		jz	loc_10013773
		mov	dword ptr [eax+8], 1
		mov	ecx, [esi+0E0h]
		mov	[eax+28h], ecx
		mov	edx, [esi+0E4h]
		mov	[eax+2Ch], edx
		mov	ecx, [esi+0E8h]
		mov	[eax+30h], ecx
		mov	edx, [esi+0ECh]
		mov	[eax+34h], edx
		mov	cx, [esi+0F0h]
		mov	[eax+38h], cx

loc_10013654:				; CODE XREF: sub_10013420+1C7j
		mov	eax, [esp+1Ch+var_C]
		mov	ecx, ebx
		call	sub_10012840
		test	eax, eax
		jz	short loc_10013683

loc_10013663:				; CODE XREF: sub_10013420+271j
		call	PORT_GetError_Util
		cmp	eax, 0FFFFD004h
		jnz	loc_10013773
		push	4
		push	esi
		call	sub_10011060
		add	esp, 8
		jmp	loc_10013773
; ---------------------------------------------------------------------------

loc_10013683:				; CODE XREF: sub_10013420+241j
		push	ebp
		push	esi
		mov	ecx, edi
		call	sub_10012960
		add	esp, 8
		test	eax, eax
		jnz	short loc_10013663

loc_10013693:				; CODE XREF: sub_10013420+193j
		cmp	[esp+1Ch+var_8], 0
		mov	word ptr [esi+0F8h], 0D01h
		jnz	short loc_100136F1
		mov	edx, [esi]
		mov	eax, [esi+200h]
		mov	ecx, [esi+1FCh]
		push	0
		push	1
		push	edx
		push	eax
		call	ecx
		add	esp, 10h
		test	eax, eax
		jz	short loc_100136F1
		mov	eax, [esi+214h]
		test	eax, eax
		jz	loc_10013773
		mov	edx, [esi]
		mov	ecx, [esi+218h]
		push	edx
		push	ecx
		call	eax
		add	esp, 8
		test	eax, eax
		jz	short loc_100136F1
		cmp	eax, 0FFFFFFFEh
		jnz	loc_10013773
		push	0FFFFD075h
		jmp	short loc_1001376B
; ---------------------------------------------------------------------------

loc_100136F1:				; CODE XREF: sub_10013420+281j
					; sub_10013420+29Ej ...
		call	sub_10011C60
		mov	eax, esi
		call	sub_10012C80
		test	eax, eax
		jnz	short loc_10013773
		test	byte ptr [esi+16h], 1
		mov	[esi+290h], eax
		jnz	short loc_1001371D
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001371D:				; CODE XREF: sub_10013420+2EBj
		xor	eax, eax
		cmp	[esi+1DCh], eax
		jz	short loc_1001378C
		pop	edi
		pop	ebp
		pop	ebx
		mov	dword ptr [esi+1DCh], offset sub_10011CC0
		mov	dword ptr [esi+1E0h], offset loc_10013350
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013743:				; CODE XREF: sub_10013420+5Dj
					; sub_10013420+66j
		cmp	byte ptr [eax],	0
		jnz	short loc_10013766
		cmp	ecx, 3
		jnz	short loc_10013766
		movzx	ecx, byte ptr [eax+1]
		movzx	edx, byte ptr [eax+2]
		shl	ecx, 8
		or	ecx, edx
		cmp	ecx, 1
		jnz	short loc_10013766
		push	0FFFFD002h
		jmp	short loc_1001376B
; ---------------------------------------------------------------------------

loc_10013766:				; CODE XREF: sub_10013420+DCj
					; sub_10013420+F7j ...
		push	0FFFFD007h

loc_1001376B:				; CODE XREF: sub_10013420+CAj
					; sub_10013420+1A4j ...
		call	PORT_SetError_Util
		add	esp, 4

loc_10013773:				; CODE XREF: sub_10013420+18Dj
					; sub_10013420+1F8j ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_10013789
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013789:				; CODE XREF: sub_10013420+357j
		or	eax, 0FFFFFFFFh

loc_1001378C:				; CODE XREF: sub_10013420+305j
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 0Ch
		retn
sub_10013420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100137A0	proc near		; DATA XREF: sub_10019390:loc_100193B7o
					; SSL_ResetHandshake:loc_10019B46o ...

Size		= dword	ptr -0Ch
Src		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+1Ch+arg_0]
		xor	ebx, ebx
		lea	eax, [edi+48h]
		push	eax
		mov	[edi+4Ch], ebx
		mov	[edi+8Ch], ebx
		mov	[edi+90h], ebx
		call	sub_10018460
		add	esp, 4
		cmp	[edi+1ECh], ebx
		jnz	short loc_100137DD
		call	sub_10010B90
		test	eax, eax
		jnz	loc_10013BC3

loc_100137DD:				; CODE XREF: sub_100137A0+2Ej
		mov	esi, edi
		call	sub_10010CC0
		test	eax, eax
		jnz	loc_10013BC3
		push	edi
		call	sub_1001DD10
		add	esp, 4
		test	eax, eax
		js	loc_10013BC3
		test	dword ptr [edi+14h], 400h
		jnz	loc_100138EC
		mov	eax, [edi+1D8h]
		mov	ecx, [edi+1E8h]
		movzx	edx, word ptr [edi+0F0h]
		push	eax
		push	ecx
		push	edx
		lea	eax, [edi+0E0h]
		push	eax
		call	sub_100181D0
		mov	esi, eax
		add	esp, 10h
		mov	[esp+1Ch+arg_0], eax
		cmp	esi, ebx
		jz	loc_100138EC
		movzx	eax, word ptr [edi+18h]
		cmp	ax, bx
		jz	short loc_10013855
		movzx	ecx, word ptr [esi+3Ah]
		cmp	cx, ax
		jb	short loc_10013855
		cmp	cx, [edi+1Ah]
		jbe	short loc_10013869

loc_10013855:				; CODE XREF: sub_100137A0+A4j
					; sub_100137A0+ADj
		movzx	ecx, word ptr [esi+3Ah]
		mov	edx, 300h
		cmp	cx, dx
		jnb	short loc_100138D3
		test	byte ptr [edi+14h], 80h
		jz	short loc_100138D3

loc_10013869:				; CODE XREF: sub_100137A0+B3j
		mov	eax, 300h
		cmp	cx, ax
		jnb	short loc_100138A3
		xor	eax, eax
		cmp	[edi+1F0h], ebx
		jbe	short loc_1001389B
		mov	edx, [esi+70h]
		mov	ebx, [edi+1ECh]

loc_10013886:				; CODE XREF: sub_100137A0+F7j
		movzx	ebp, byte ptr [ebx+eax]
		cmp	ebp, edx
		jz	short loc_10013899
		add	eax, 3
		cmp	eax, [edi+1F0h]
		jb	short loc_10013886

loc_10013899:				; CODE XREF: sub_100137A0+ECj
		xor	ebx, ebx

loc_1001389B:				; CODE XREF: sub_100137A0+DBj
		cmp	eax, [edi+1F0h]
		jnb	short loc_100138D3

loc_100138A3:				; CODE XREF: sub_100137A0+D1j
		mov	eax, [edi+68h]
		mov	[esp+1Ch+Size],	10h
		mov	[edi+44h], cx
		cmp	eax, ebx
		jz	short loc_100138BF
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_100138BF:				; CODE XREF: sub_100137A0+114j
		mov	ecx, [esi+24h]
		push	ecx
		call	CERT_DupCertificate
		add	esp, 4
		mov	[edi+68h], eax
		jmp	loc_10013978
; ---------------------------------------------------------------------------

loc_100138D3:				; CODE XREF: sub_100137A0+C1j
					; sub_100137A0+C7j ...
		mov	eax, [edi+88h]
		cmp	eax, ebx
		jz	short loc_100138E3
		push	esi
		call	eax
		add	esp, 4

loc_100138E3:				; CODE XREF: sub_100137A0+13Bj
		push	esi
		call	sub_10017FD0
		add	esp, 4

loc_100138EC:				; CODE XREF: sub_100137A0+64j
					; sub_100137A0+97j
		push	108h
		mov	[esp+20h+Size],	ebx
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		mov	[esp+1Ch+arg_0], esi
		cmp	esi, ebx
		jz	loc_10013BC3
		mov	dword ptr [esi+8], 1
		mov	[esi+4], ebx
		mov	edx, [edi+0E0h]
		mov	[esi+28h], edx
		mov	eax, [edi+0E4h]
		mov	[esi+2Ch], eax
		mov	ecx, [edi+0E8h]
		mov	[esi+30h], ecx
		mov	edx, [edi+0ECh]
		mov	[esi+34h], edx
		mov	ax, [edi+0F0h]
		mov	[esi+38h], ax
		mov	eax, [edi+1E8h]
		cmp	eax, ebx
		jz	short loc_1001395A
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4
		mov	[esi+1Ch], eax

loc_1001395A:				; CODE XREF: sub_100137A0+1ACj
		mov	eax, [edi+1D8h]
		cmp	eax, ebx
		jz	short loc_10013974
		push	eax
		call	PORT_Strdup_Util
		mov	ecx, [esp+20h+arg_0]
		add	esp, 4
		mov	[ecx+20h], eax

loc_10013974:				; CODE XREF: sub_100137A0+1C2j
		mov	esi, [esp+1Ch+arg_0]

loc_10013978:				; CODE XREF: sub_100137A0+12Ej
		mov	edx, 300h
		mov	[edi+0F4h], esi
		cmp	[esi+3Ah], dx
		jnb	short loc_10013996
		test	dword ptr [edi+14h], 1000h
		jnz	loc_10013A20

loc_10013996:				; CODE XREF: sub_100137A0+1E7j
		cmp	[edi+18h], bx
		jz	loc_10013A20
		test	byte ptr [edi+16h], 1
		mov	esi, ds:PR_EnterMonitor
		mov	eax, edx
		mov	[edi+274h], ebx
		mov	dword ptr [edi+1DCh], offset sub_10011CC0
		mov	[edi+44h], ax
		jnz	short loc_100139E0
		mov	ecx, [edi+258h]
		push	ecx
		call	esi ; PR_EnterMonitor
		add	esp, 4
		test	byte ptr [edi+16h], 1
		jnz	short loc_100139E0
		mov	edx, [edi+250h]
		push	edx
		call	esi ; PR_EnterMonitor
		add	esp, 4

loc_100139E0:				; CODE XREF: sub_100137A0+220j
					; sub_100137A0+232j
		push	ebx
		push	edi
		call	sub_10009320
		mov	ebx, ds:PR_ExitMonitor
		add	esp, 8
		test	byte ptr [edi+16h], 1
		mov	esi, eax
		jnz	short loc_10013A16
		mov	eax, [edi+250h]
		push	eax
		call	ebx ; PR_ExitMonitor
		add	esp, 4
		test	byte ptr [edi+16h], 1
		jnz	short loc_10013A16
		mov	ecx, [edi+258h]
		push	ecx
		call	ebx ; PR_ExitMonitor
		add	esp, 4

loc_10013A16:				; CODE XREF: sub_100137A0+256j
					; sub_100137A0+268j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013A20:				; CODE XREF: sub_100137A0+1F0j
					; sub_100137A0+1FAj
		push	ebx
		push	edi
		call	sub_10021700
		mov	eax, [edi+1ECh]
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_10013A49
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[edi+1ECh], ebx
		mov	[edi+1F0h], ebx

loc_10013A49:				; CODE XREF: sub_100137A0+292j
		cmp	[edi+1ECh], ebx
		jnz	short loc_10013A5E
		call	sub_10010B90
		cmp	eax, ebx
		jl	loc_10013C35

loc_10013A5E:				; CODE XREF: sub_100137A0+2AFj
		mov	ebx, [edi+1F0h]
		mov	eax, [esp+1Ch+Size]
		mov	edx, [edi+1ECh]
		lea	esi, [ebx+eax+1Ch]
		lea	eax, [edi+101h]
		push	10h
		push	eax
		mov	[esp+24h+Src], edx
		mov	[esp+24h+var_4], esi
		call	PK11_GenerateRandom
		add	esp, 8
		test	byte ptr [edi+16h], 1
		jnz	short loc_10013AA1
		mov	ecx, [edi+250h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10013AA1:				; CODE XREF: sub_100137A0+2EFj
		mov	ecx, esi
		mov	edx, edi
		call	sub_10011030
		test	eax, eax
		jz	short loc_10013AD3
		test	byte ptr [edi+16h], 1
		jnz	loc_10013BC3
		mov	edx, [edi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013AD3:				; CODE XREF: sub_100137A0+30Cj
		mov	ebp, [edi+0D0h]
		mov	byte ptr [ebp+0], 1
		cmp	word ptr [edi+18h], 0
		mov	eax, 2
		jz	short loc_10013AED
		movzx	eax, word ptr [edi+1Ah]

loc_10013AED:				; CODE XREF: sub_100137A0+347j
		mov	[edi+46h], ax
		shr	eax, 8
		mov	[ebp+1], al
		mov	al, [edi+46h]
		lea	ecx, [ebx+3]
		shr	ecx, 8
		lea	edx, [ebx+3]
		mov	[ebp+2], al
		mov	eax, [esp+1Ch+Size]
		mov	[ebp+3], cl
		mov	[ebp+4], dl
		mov	edx, [esp+1Ch+Src]
		push	ebx		; Size
		mov	ecx, eax
		push	edx		; Src
		shr	ecx, 8
		lea	esi, [ebp+9]
		push	esi		; Dst
		mov	[ebp+5], cl
		mov	[ebp+6], al
		mov	word ptr [ebp+7], 1000h
		call	memcpy
		add	esi, ebx
		mov	ebx, [esp+28h+Size]
		mov	word ptr [esi],	0
		mov	byte ptr [esi+2], 0FFh
		add	esp, 0Ch
		add	esi, 3
		test	ebx, ebx
		jz	short loc_10013B5D
		mov	eax, [esp+1Ch+arg_0]
		push	ebx		; Size
		add	eax, 54h
		push	eax		; Src
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	esi, ebx

loc_10013B5D:				; CODE XREF: sub_100137A0+3A7j
		mov	ecx, [edi+101h]
		mov	ebx, [esp+1Ch+var_4]
		mov	[esi], ecx
		mov	edx, [edi+105h]
		mov	[esi+4], edx
		mov	eax, [edi+109h]
		mov	[esi+8], eax
		mov	ecx, [edi+10Dh]
		push	0
		push	ebx
		mov	[esi+0Ch], ecx
		mov	edx, [edi+48h]
		push	ebp
		push	edi
		mov	dword ptr [edi+2Ch], 1
		call	edx
		add	esp, 10h
		test	byte ptr [edi+16h], 1
		mov	esi, eax
		jnz	short loc_10013BB0
		mov	eax, [edi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013BB0:				; CODE XREF: sub_100137A0+3FEj
		test	esi, esi
		js	short loc_10013BC3
		push	ebx
		push	ebp
		push	edi
		call	sub_100086F0
		add	esp, 0Ch
		test	eax, eax
		jns	short loc_10013BCE

loc_10013BC3:				; CODE XREF: sub_100137A0+37j
					; sub_100137A0+46j ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10013BCE:				; CODE XREF: sub_100137A0+421j
		movzx	ecx, word ptr [edi+2EF4h]
		mov	edx, 0FF01h
		mov	[edi+ecx*2+2EF8h], dx
		inc	word ptr [edi+2EF4h]
		test	byte ptr [edi+16h], 1
		jnz	short loc_10013BFF
		mov	eax, [edi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10013BFF:				; CODE XREF: sub_100137A0+44Dj
		test	byte ptr [edi+16h], 1
		mov	dword ptr [edi+290h], 0
		jnz	short loc_10013C1F
		mov	ecx, [edi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013C1F:				; CODE XREF: sub_100137A0+46Dj
		mov	dword ptr [edi+1DCh], offset sub_10011CC0
		mov	dword ptr [edi+1E0h], offset sub_10013420
		xor	eax, eax

loc_10013C35:				; CODE XREF: sub_100137A0+2B8j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_100137A0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10013C40:				; DATA XREF: sub_10013DA0+552o
		push	ecx
		push	ebx
		push	esi
		mov	esi, [esp+10h]
		test	byte ptr [esi+16h], 1
		push	edi
		jnz	short loc_10013C5E
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10013C5E:				; CODE XREF: .text:10013C4Cj
		mov	eax, [esi+298h]
		mov	ebx, [esi+290h]
		add	eax, [esi+278h]
		cmp	ebx, 0Ah
		jb	loc_10013D6C
		cmp	byte ptr [eax],	2
		jnz	loc_10013D6C
		movzx	ecx, byte ptr [eax+1]
		movzx	edx, byte ptr [eax+3]
		movzx	edi, byte ptr [eax+4]
		mov	[esp+0Ch], ecx
		movzx	ecx, byte ptr [eax+2]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [eax+7]
		mov	[esp+14h], ecx
		movzx	ecx, byte ptr [eax+5]
		shl	edi, 8
		or	edi, ecx
		movzx	ecx, byte ptr [eax+6]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [eax+8]
		push	ebp
		movzx	ebp, byte ptr [eax+9]
		shl	edx, 8
		or	edx, ebp
		lea	ebp, [edx+ecx]
		lea	ebp, [edi+ebp+0Ah]
		cmp	ebx, ebp
		pop	ebp
		jb	loc_10013D6C
		push	edx
		push	ecx
		lea	edx, [ecx+edi]
		lea	edx, [edx+eax+0Ah]
		lea	ecx, [edi+eax+0Ah]
		push	edi
		add	eax, 0Ah
		push	eax
		mov	eax, [esp+24h]
		push	eax
		mov	eax, [esp+20h]
		push	eax
		push	esi
		call	sub_10012280
		mov	bl, 1
		add	esp, 1Ch
		mov	edi, eax
		mov	dword ptr [esi+290h], 0
		test	[esi+16h], bl
		jnz	short loc_10013D1B
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013D1B:				; CODE XREF: .text:10013D09j
		test	edi, edi
		jnz	short loc_10013D8F
		or	[esi+0F8h], bl
		call	sub_10011C60
		call	sub_10011180
		test	eax, eax
		jnz	short loc_10013D8F
		mov	eax, esi
		call	sub_10012C80
		test	eax, eax
		jnz	short loc_10013D8F
		cmp	[esi+1DCh], eax
		jnz	short loc_10013D4B
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013D4B:				; CODE XREF: .text:10013D44j
		pop	edi
		mov	dword ptr [esi+1DCh], offset sub_10011CC0
		mov	dword ptr [esi+1E0h], offset sub_10013080
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 4
		jmp	sub_10012C50
; ---------------------------------------------------------------------------

loc_10013D6C:				; CODE XREF: .text:10013C73j
					; .text:10013C7Cj ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_10013D82
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013D82:				; CODE XREF: .text:10013D70j
		push	0FFFFD006h
		call	PORT_SetError_Util
		add	esp, 4

loc_10013D8F:				; CODE XREF: .text:10013D1Dj
					; .text:10013D31j ...
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10013DA0	proc near		; DATA XREF: sub_10014380+94o
					; sub_100175D0+393o

Size		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Src		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+38h+arg_0]
		mov	eax, [esi+2FCh]
		xor	ebx, ebx
		test	byte ptr [esi+16h], 1
		push	edi
		mov	[esp+3Ch+Src], ebx
		mov	[esp+3Ch+var_24], eax
		jnz	short loc_10013DDC
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10013DDC:				; CODE XREF: sub_10013DA0+2Aj
		mov	edi, [esi+298h]
		add	edi, [esi+278h]
		cmp	dword ptr [esi+290h], 9
		jb	loc_10014323
		cmp	byte ptr [edi],	1
		jnz	loc_10014323
		push	esi
		call	sub_1001DD10
		add	esp, 4
		test	eax, eax
		jnz	loc_10014345
		cmp	byte ptr [edi],	1
		jnz	short loc_10013E8D
		cmp	byte ptr [edi+1], 3
		jb	short loc_10013E8D
		cmp	[esi+18h], bx
		jz	short loc_10013E8D
		mov	edx, [esi+290h]
		push	edx
		push	edi
		push	esi
		call	sub_1000E730
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10013E62
		mov	eax, [esi+0F4h]
		mov	cx, [esi+44h]
		mov	[esi+1DCh], ebx
		mov	dword ptr [esi+1E0h], offset sub_10011CC0
		mov	[esi+1E4h], ebx
		mov	[esi+274h], ebx
		mov	[eax+3Ah], cx

loc_10013E62:				; CODE XREF: sub_10013DA0+96j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10013E78
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10013E78:				; CODE XREF: sub_10013DA0+C6j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10013E8D:				; CODE XREF: sub_10013DA0+72j
					; sub_10013DA0+78j ...
		movzx	eax, byte ptr [edi+1]
		movzx	ecx, byte ptr [edi+2]
		shl	ax, 8
		or	ax, cx
		mov	edx, 300h
		mov	[esi+44h], ax
		cmp	ax, dx
		jb	short loc_10013EB3
		mov	eax, 2
		mov	[esi+44h], ax

loc_10013EB3:				; CODE XREF: sub_10013DA0+108j
		movzx	ecx, byte ptr [edi+3]
		movzx	edx, byte ptr [edi+4]
		movzx	ebx, byte ptr [edi+5]
		movzx	eax, byte ptr [edi+6]
		movzx	ebp, byte ptr [edi+7]
		shl	ecx, 8
		or	ecx, edx
		movzx	edx, byte ptr [edi+8]
		shl	ebx, 8
		add	edi, 9
		shl	ebp, 8
		or	ebx, eax
		or	ebp, edx
		lea	eax, [edi+ecx]
		mov	[esp+3Ch+var_20], edi
		mov	[esp+3Ch+var_28], eax
		test	ecx, ecx
		jz	loc_10014323
		mov	eax, 55555556h
		imul	ecx
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		lea	edx, [eax+eax*2]
		mov	eax, ecx
		sub	eax, edx
		jnz	loc_10014323
		test	ebx, ebx
		jz	short loc_10013F18
		cmp	ebx, 10h
		jnz	loc_10014323

loc_10013F18:				; CODE XREF: sub_10013DA0+16Dj
		lea	edx, [ebp-10h]
		cmp	edx, 10h
		ja	loc_10014323
		lea	eax, [ebx+ebp]
		lea	edx, [eax+ecx+9]
		cmp	[esi+290h], edx
		jnz	loc_10014323
		movzx	eax, word ptr [esi+44h]
		cmp	eax, 2
		jz	short loc_10013F4F
		jbe	loc_10013FD6
		mov	eax, 2
		mov	[esi+44h], ax

loc_10013F4F:				; CODE XREF: sub_10013DA0+19Ej
		push	ecx
		push	edi
		mov	ecx, esi
		call	sub_10012520
		xor	edi, edi
		add	esp, 8
		mov	[esp+3Ch+Size],	eax
		cmp	eax, edi
		jnz	loc_10013FEC
		mov	edx, dword ptr ds:byte_1002B104
		mov	eax, ds:dword_1002B108
		lea	ecx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_20], ecx
		mov	ecx, ds:dword_1002B10C
		mov	[esp+3Ch+var_10], ecx
		lea	ecx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_18], edx
		mov	edx, ds:dword_1002B110
		mov	[esp+3Ch+var_14], eax
		mov	ax, ds:word_1002B114
		push	12h
		push	ecx
		mov	ecx, esi
		mov	[esp+44h+var_C], edx
		mov	[esp+44h+var_8], ax
		call	sub_10012520
		add	esp, 8
		mov	[esp+3Ch+Size],	eax
		cmp	eax, edi
		jnz	short loc_10013FE5
		push	1
		push	esi
		call	sub_10011060
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 0Ch
		jmp	loc_10014345
; ---------------------------------------------------------------------------

loc_10013FD6:				; CODE XREF: sub_10013DA0+1A0j
		push	0FFFFD009h
		call	PORT_SetError_Util
		jmp	loc_10014342
; ---------------------------------------------------------------------------

loc_10013FE5:				; CODE XREF: sub_10013DA0+21Aj
		or	dword ptr [esi+14h], 400h

loc_10013FEC:				; CODE XREF: sub_10013DA0+1C3j
		mov	eax, [esp+3Ch+var_28]
		add	eax, ebx
		push	ebp		; Size
		push	eax		; Src
		lea	eax, [esi+101h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	byte ptr [esi+0F8h], 0
		cmp	ebx, edi
		jle	short loc_1001408C
		test	dword ptr [esi+14h], 400h
		jnz	short loc_1001408C
		mov	ecx, [esi+260h]
		mov	edx, [esp+3Ch+var_28]
		push	ecx
		push	ebx
		push	edx
		lea	eax, [esi+0E0h]
		push	eax
		call	dword_10037EA8
		add	esp, 10h
		cmp	eax, edi
		jz	short loc_1001408C
		mov	[esi+0F4h], eax
		mov	byte ptr [esi+0F8h], 1
		mov	ecx, [eax+44h]
		mov	[esi+74h], ecx
		mov	edx, [eax+48h]
		mov	[esi+78h], edx
		mov	ecx, [eax+4Ch]
		mov	[esi+7Ch], ecx
		mov	edx, [eax+50h]
		push	eax
		mov	[esp+40h+Size],	edi
		xor	eax, eax
		mov	edi, esi
		mov	[esp+40h+var_28], 1
		xor	ebx, ebx
		mov	[esi+80h], edx
		call	sub_10011FA0
		add	esp, 4
		test	eax, eax
		jnz	loc_10014345
		mov	ebp, [esp+3Ch+var_24]
		jmp	loc_1001414E
; ---------------------------------------------------------------------------

loc_1001408C:				; CODE XREF: sub_10013DA0+26Cj
					; sub_10013DA0+275j ...
		mov	ebp, [esp+3Ch+var_24]
		cmp	ebp, edi
		jz	loc_10014345
		push	108h
		mov	[esp+40h+var_28], edi
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_10014345
		mov	dword ptr [edi+8], 1
		mov	eax, [esi+0E0h]
		mov	[edi+28h], eax
		mov	ecx, [esi+0E4h]
		mov	[edi+2Ch], ecx
		mov	edx, [esi+0E8h]
		mov	[edi+30h], edx
		mov	eax, [esi+0ECh]
		mov	[edi+34h], eax
		mov	cx, [esi+0F0h]
		lea	edx, [edi+56h]
		push	0Eh
		mov	[edi+38h], cx
		push	edx
		mov	[esi+0F4h], edi
		call	PK11_GenerateRandom
		add	esp, 8
		call	ds:GetCurrentProcessId
		mov	ecx, eax
		shr	ecx, 8
		mov	[edi+55h], al
		mov	eax, [edi+24h]
		mov	[edi+54h], cl
		mov	edx, [ebp+40h]
		mov	ebx, [ebp+44h]
		mov	[esp+3Ch+Src], edx
		test	eax, eax
		jz	short loc_10014128
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10014128:				; CODE XREF: sub_10013DA0+37Dj
		push	ebp
		call	CERT_DupCertificate
		mov	[edi+24h], eax
		mov	eax, 1
		mov	[esi+74h], eax
		mov	[esi+7Ch], eax
		mov	eax, [esi+308h]
		add	esp, 4
		mov	[esi+78h], eax
		mov	[esi+80h], eax

loc_1001414E:				; CODE XREF: sub_10013DA0+2E7j
		mov	eax, [esi+68h]
		test	eax, eax
		jz	short loc_1001415E
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_1001415E:				; CODE XREF: sub_10013DA0+3B3j
		push	ebp
		call	CERT_DupCertificate
		mov	[esi+68h], eax
		mov	eax, [esi+14h]
		add	esp, 4
		mov	byte ptr [esi+0F9h], 5
		test	al, 4
		jz	short loc_1001417F
		mov	byte ptr [esi+0F9h], 7

loc_1001417F:				; CODE XREF: sub_10013DA0+3D6j
		mov	ecx, [esp+3Ch+Size]
		mov	byte ptr [esi+0FAh], 0
		lea	ebp, [ebx+ecx+1Bh]
		test	eax, 10000h
		jnz	short loc_100141A5
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100141A5:				; CODE XREF: sub_10013DA0+3F3j
		mov	ecx, ebp
		mov	edx, esi
		call	sub_10011030
		test	eax, eax
		jnz	loc_1001432F
		mov	edi, [esi+0D0h]
		mov	al, byte ptr [esp+3Ch+var_28]
		mov	[edi+1], al
		mov	byte ptr [edi],	4
		mov	byte ptr [edi+2], 1
		mov	cl, [esi+45h]
		mov	[edi+3], cl
		mov	dl, [esi+44h]
		mov	eax, ebx
		shr	eax, 8
		mov	[edi+5], al
		mov	eax, [esp+3Ch+Size]
		mov	ecx, eax
		shr	ecx, 8
		mov	[edi+4], dl
		mov	[edi+6], bl
		mov	[edi+7], cl
		mov	[edi+8], al
		mov	word ptr [edi+9], 1000h
		test	ebx, ebx
		jz	short loc_10014210
		mov	edx, [esp+3Ch+Src]
		push	ebx		; Size
		push	edx		; Src
		lea	eax, [edi+0Bh]
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+48h+Size]
		add	esp, 0Ch

loc_10014210:				; CODE XREF: sub_10013DA0+458j
		test	eax, eax
		jz	short loc_1001422B
		mov	ecx, [esp+3Ch+var_20]
		push	eax		; Size
		push	ecx		; Src
		lea	edx, [edi+ebx+0Bh]
		push	edx		; Dst
		call	memcpy
		mov	eax, [esp+48h+Size]
		add	esp, 0Ch

loc_1001422B:				; CODE XREF: sub_10013DA0+472j
		mov	edx, [esi+121h]
		lea	ecx, [edi+ebx]
		lea	eax, [ecx+eax+0Bh]
		mov	[eax], edx
		mov	ecx, [esi+125h]
		mov	[eax+4], ecx
		mov	edx, [esi+129h]
		mov	[eax+8], edx
		mov	ecx, [esi+12Dh]
		push	0
		push	ebp
		mov	[eax+0Ch], ecx
		mov	edx, [esi+48h]
		push	edi
		push	esi
		mov	dword ptr [esi+2Ch], 1
		call	edx
		add	esp, 10h
		test	eax, eax
		js	loc_1001432F
		test	byte ptr [esi+16h], 1
		jnz	short loc_10014287
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10014287:				; CODE XREF: sub_10013DA0+4D5j
		cmp	[esp+3Ch+var_28], 0
		mov	dword ptr [esi+290h], 0
		mov	dword ptr [esi+1DCh], offset sub_10011CC0
		jz	short loc_100142EE
		call	sub_10011C60
		call	sub_10011180
		test	eax, eax
		jnz	loc_10014345
		test	byte ptr [esi+16h], 1
		mov	dword ptr [esi+1E0h], offset sub_10013080
		jnz	short loc_100142D4
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100142D4:				; CODE XREF: sub_10013DA0+522j
		mov	eax, esi
		call	sub_10012C50
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100142EE:				; CODE XREF: sub_10013DA0+500j
		test	byte ptr [esi+16h], 1
		mov	dword ptr [esi+1E0h], offset loc_10013C40
		jnz	short loc_1001430E
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001430E:				; CODE XREF: sub_10013DA0+55Cj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10014323:				; CODE XREF: sub_10013DA0+4Fj
					; sub_10013DA0+58j ...
		push	0FFFFD006h
		call	PORT_SetError_Util
		jmp	short loc_10014342
; ---------------------------------------------------------------------------

loc_1001432F:				; CODE XREF: sub_10013DA0+410j
					; sub_10013DA0+4CBj
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001435B
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_ExitMonitor

loc_10014342:				; CODE XREF: sub_10013DA0+240j
					; sub_10013DA0+58Dj
		add	esp, 4

loc_10014345:				; CODE XREF: sub_10013DA0+69j
					; sub_10013DA0+231j ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001435B
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001435B:				; CODE XREF: sub_10013DA0+593j
					; sub_10013DA0+5A9j
		mov	ecx, [esp+3Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10013DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014380	proc near		; DATA XREF: sub_10019390+11o
					; SSL_ResetHandshake+A0o ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+48h]
		push	eax
		mov	dword ptr [esi+4Ch], 1
		call	sub_10018460
		mov	dword ptr [esi+8Ch], 0
		mov	dword ptr [esi+90h], 0
		mov	eax, [esi+304h]
		add	esp, 4
		test	eax, eax
		jz	short loc_100143C4
		cmp	dword ptr [eax], 0
		jz	short loc_100143C4
		cmp	dword ptr [esi+2FCh], 0
		jnz	short loc_100143CB

loc_100143C4:				; CODE XREF: sub_10014380+34j
					; sub_10014380+39j
		and	dword ptr [esi+14h], 0FFFFFF7Fh

loc_100143CB:				; CODE XREF: sub_10014380+42j
		cmp	dword ptr [esi+1ECh], 0
		jnz	short loc_100143E1
		push	edi
		mov	edi, esi
		call	sub_10010B90
		pop	edi
		test	eax, eax
		jnz	short loc_100143EA

loc_100143E1:				; CODE XREF: sub_10014380+52j
		call	sub_10010CC0
		test	eax, eax
		jz	short loc_100143EF

loc_100143EA:				; CODE XREF: sub_10014380+5Fj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100143EF:				; CODE XREF: sub_10014380+68j
		lea	ecx, [esi+121h]
		push	10h
		push	ecx
		call	PK11_GenerateRandom
		add	esp, 8
		mov	dword ptr [esi+290h], 0
		mov	dword ptr [esi+1DCh], offset sub_10011CC0
		mov	dword ptr [esi+1E0h], offset sub_10013DA0
		xor	eax, eax
		pop	esi
		retn
sub_10014380	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   4. NSSSSL_VersionCheck

; =============== S U B	R O U T	I N E =======================================


		public NSSSSL_VersionCheck
NSSSSL_VersionCheck proc near		; DATA XREF: .rdata:off_10035848o

var_1		= byte ptr -1

		push	ecx
		movsx	eax, ds:byte_1002EBB8
		movsx	ecx, ds:byte_1002EB80
		add	eax, ecx
		mov	[esp+4+var_1], al
		add	esp, 4
		jmp	NSS_VersionCheck
NSSSSL_VersionCheck endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   3. NSSSSL_GetVersion

; =============== S U B	R O U T	I N E =======================================


		public NSSSSL_GetVersion
NSSSSL_GetVersion proc near		; DATA XREF: .rdata:off_10035848o
		mov	eax, offset a3_17_1BasicEcc ; "3.17.1 Basic ECC"
		retn
NSSSSL_GetVersion endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014460	proc near		; DATA XREF: .rdata:off_1002E9ACo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx]
		mov	ecx, [ecx+240h]
		mov	eax, [eax+8]
		mov	edx, [eax]
		mov	edx, [edx+30h]
		push	ecx
		mov	ecx, [esp+4+arg_4]
		push	ecx
		push	eax
		call	edx
		add	esp, 0Ch
		retn
sub_10014460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014490	proc near		; DATA XREF: .rdata:1002E9B4o
					; .rdata:1002E9E4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	edx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [edx+38h]
		jmp	edx
sub_10014490	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100144B0	proc near		; DATA XREF: .rdata:1002E9B8o
					; .rdata:1002E9E8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	edx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [edx+3Ch]
		jmp	edx
sub_100144B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100144D0	proc near		; DATA XREF: .rdata:1002E9BCo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	edx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [edx+40h]
		jmp	edx
sub_100144D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100144F0	proc near		; CODE XREF: sub_1000FF70+4Dp
					; sub_10010080+4Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx]
		mov	ecx, [ecx+238h]
		mov	eax, [eax+8]
		mov	edx, [eax]
		mov	edx, [edx+44h]
		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		push	ecx
		mov	ecx, [esp+0Ch+arg_C]
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		push	edi
		push	ecx
		push	eax
		call	edx
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jns	short loc_10014541
		call	ds:PR_GetError
		cmp	eax, 0FFFFE8D7h
		jnz	short loc_1001453C
		push	0FFFFE8B7h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001453C:				; CODE XREF: sub_100144F0+3Dj
		mov	eax, esi

loc_1001453E:				; CODE XREF: sub_100144F0+53j
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014541:				; CODE XREF: sub_100144F0+30j
		cmp	esi, edi
		jle	short loc_1001453E
		push	0FFFFE8B6h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_100144F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014560	proc near		; CODE XREF: sub_10007C90+25Bp
					; .text:1001177Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_0]
		mov	eax, [ebx]
		push	ebp
		mov	ebp, [eax+8]
		push	esi
		push	edi
		xor	esi, esi
		nop

loc_10014570:				; CODE XREF: sub_10014560+4Cj
		mov	edx, [ebx+23Ch]
		mov	eax, [esp+10h+arg_C]
		mov	ecx, [ebp+0]
		push	edx
		mov	edx, [esp+14h+arg_8]
		push	eax
		mov	eax, [esp+18h+arg_4]
		sub	edx, esi
		push	edx
		lea	edx, [esi+eax]
		mov	eax, [ecx+48h]
		push	edx
		push	ebp
		call	eax
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		js	short loc_100145D0
		add	esi, edi
		cmp	dword ptr [ebx+2F38h], 1
		jz	short loc_100145BC
		cmp	[esp+10h+arg_8], esi
		jg	short loc_10014570
		mov	dword ptr [ebx+30h], 0

loc_100145B5:				; CODE XREF: sub_10014560+60j
					; sub_10014560+86j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100145BC:				; CODE XREF: sub_10014560+46j
		cmp	[esp+10h+arg_8], esi
		jg	short loc_100145B5
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		mov	dword ptr [ebx+30h], 0
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100145D0:				; CODE XREF: sub_10014560+3Bj
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_100145F0
		mov	dword ptr [ebx+30h], 1
		test	esi, esi
		jnz	short loc_100145B5
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100145F0:				; CODE XREF: sub_10014560+7Bj
		mov	dword ptr [ebx+30h], 0
		cmp	eax, 0FFFFE8D8h
		jnz	short loc_1001460B
		push	0FFFFE8B7h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001460B:				; CODE XREF: sub_10014560+9Cj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10014560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014620	proc near		; DATA XREF: .rdata:1002E9CCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	ecx, [esp+arg_8]
		mov	edx, [eax]
		mov	edx, [edx+8]
		push	esi
		push	ecx
		mov	ecx, [esp+8+arg_4]
		push	ecx
		push	eax
		call	edx
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jns	short loc_10014661
		call	ds:PR_GetError
		cmp	eax, 0FFFFE8D7h
		jnz	short loc_1001465F
		push	0FFFFE8B7h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001465F:				; CODE XREF: sub_10014620+30j
		mov	eax, esi

loc_10014661:				; CODE XREF: sub_10014620+23j
		pop	esi
		retn
sub_10014620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014670	proc near		; DATA XREF: .rdata:1002E9D0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		push	ebx
		mov	ebx, [ecx+8]
		push	ebp
		mov	ebp, [esp+8+arg_8]
		push	esi
		push	edi
		xor	esi, esi

loc_10014683:				; CODE XREF: sub_10014670+35j
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [ebx]
		mov	eax, ebp
		sub	eax, esi
		push	eax
		lea	eax, [esi+ecx]
		mov	ecx, [edx+0Ch]
		push	eax
		push	ebx
		call	ecx
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		js	short loc_100146B9
		add	esi, edi
		cmp	ebp, esi
		jg	short loc_10014683
		mov	edx, [esp+10h+arg_0]
		mov	dword ptr [edx+30h], 0

loc_100146B2:				; CODE XREF: sub_10014670+63j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100146B9:				; CODE XREF: sub_10014670+2Fj
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_100146DD
		mov	edx, [esp+10h+arg_0]
		mov	dword ptr [edx+30h], 1
		test	esi, esi
		jnz	short loc_100146B2
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100146DD:				; CODE XREF: sub_10014670+54j
		mov	ecx, [esp+10h+arg_0]
		mov	dword ptr [ecx+30h], 0
		cmp	eax, 0FFFFE8D8h
		jnz	short loc_100146FC
		push	0FFFFE8B7h
		call	PORT_SetError_Util
		add	esp, 4

loc_100146FC:				; CODE XREF: sub_10014670+7Dj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10014670	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014710	proc near		; CODE XREF: SSL_ResetHandshake+18Dp
					; sub_1001DF80+7Fp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	edx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [edx+64h]
		jmp	edx
sub_10014710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014730	proc near		; DATA XREF: .rdata:1002E9D8o
					; .rdata:1002EA08o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx+8]
		mov	edx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [edx+60h]
		jmp	edx
sub_10014730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014750	proc near		; CODE XREF: sub_10019410+54p
					; DATA XREF: .rdata:1002E9C0o

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, [edi]
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10014771
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014771:				; CODE XREF: sub_10014750+Cj
		push	0FFFFFFFEh
		push	esi
		mov	dword ptr [edi], 0
		call	ds:PR_PopIOLayer
		push	eax
		mov	eax, [eax+10h]
		call	eax
		mov	ecx, [esi]
		mov	edx, [ecx+4]
		push	esi
		call	edx
		push	edi
		mov	esi, eax
		call	sub_1001C3A0
		add	esp, 14h
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_10014750	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  36. SSL_GetImplementedCiphers

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetImplementedCiphers
SSL_GetImplementedCiphers proc near	; DATA XREF: .rdata:off_10035848o
		mov	eax, offset SSL_ImplementedCiphers
		retn
SSL_GetImplementedCiphers endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  40. SSL_GetNumImplementedCiphers

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetNumImplementedCiphers
SSL_GetNumImplementedCiphers proc near	; DATA XREF: .rdata:off_10035848o
		mov	eax, 43h
		retn
SSL_GetNumImplementedCiphers endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100147C0	proc near		; CODE XREF: sub_10002510+4Bp
					; sub_10002830+20Bp ...

arg_0		= dword	ptr  4

		call	PORT_GetError_Util
		cmp	eax, 0FFFFE023h
		jg	short loc_100147F5
		jz	short loc_10014800
		cmp	eax, 0FFFFD05Ah
		jg	short loc_100147E6
		jz	short loc_10014800
		cmp	eax, 0FFFFD006h
		jl	short locret_10014811
		cmp	eax, 0FFFFD007h
		jle	short loc_10014800
		retn
; ---------------------------------------------------------------------------

loc_100147E6:				; CODE XREF: sub_100147C0+13j
		cmp	eax, 0FFFFE000h
		jl	short locret_10014811
		cmp	eax, 0FFFFE002h
		jle	short loc_10014800
		retn
; ---------------------------------------------------------------------------

loc_100147F5:				; CODE XREF: sub_100147C0+Aj
		cmp	eax, 0FFFFE899h
		jz	short loc_10014800
		test	eax, eax
		jnz	short locret_10014811

loc_10014800:				; CODE XREF: sub_100147C0+Cj
					; sub_100147C0+15j ...
		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	PORT_SetError_Util
		add	esp, 4
		mov	eax, esi
		pop	esi

locret_10014811:			; CODE XREF: sub_100147C0+1Cj
					; sub_100147C0+2Bj ...
		retn
sub_100147C0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10014820:				; DATA XREF: sub_10014830o
		push	offset off_1002E7D0
		call	ds:PR_ErrorInstallTable
		add	esp, 4
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014830	proc near		; CODE XREF: sub_10014850+9p
		push	offset loc_10014820
		push	offset dword_1003765C
		call	ds:PR_CallOnce
		add	esp, 8
		neg	eax
		sbb	eax, eax
		retn
sub_10014830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014850	proc near		; CODE XREF: sub_1001B480+3p
					; sub_1001B760+19p ...
		cmp	dword_10037668,	0
		jnz	short loc_1001487D
		call	sub_10014830
		test	eax, eax
		jz	short loc_10014873
		push	0FFFFE013h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014873:				; CODE XREF: sub_10014850+10j
		mov	dword_10037668,	1

loc_1001487D:				; CODE XREF: sub_10014850+7j
		xor	eax, eax
		retn
sub_10014850	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014880	proc near		; CODE XREF: sub_10015700+4D9p
					; sub_10015700+58Fp ...

Src		= dword	ptr  4

		cmp	edi, [esi+8]
		jbe	short loc_10014889
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014889:				; CODE XREF: sub_10014880+3j
		mov	eax, [esp+Src]
		mov	ecx, [esi+4]
		push	edi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	[esi+4], edi
		sub	[esi+8], edi
		add	esp, 0Ch
		xor	eax, eax
		retn
sub_10014880	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100148B0	proc near		; DATA XREF: sub_10014900+56o
		mov	eax, dword_100377D0
		test	eax, eax
		jz	short loc_100148CC
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword_100377D0,	0

loc_100148CC:				; CODE XREF: sub_100148B0+7j
		mov	eax, dword_100377D4
		test	eax, eax
		jz	short loc_100148E8
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword_100377D4,	0

loc_100148E8:				; CODE XREF: sub_100148B0+23j
		xor	eax, eax
		mov	dword_10037670,	eax
		mov	dword_10037674,	eax
		mov	dword_10037678,	eax
		retn
sub_100148B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014900	proc near		; DATA XREF: sub_100149C0+1o
					; sub_10015700+104o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+304h]
		mov	ecx, [eax]
		mov	eax, [eax+4]
		test	ecx, ecx
		jz	short loc_10014969
		test	eax, eax
		jz	short loc_10014969
		mov	edx, ds:dword_1002E950
		push	offset dword_100377D4
		mov	dword_100377A0,	edx
		mov	dl, ds:byte_1002E954
		push	offset dword_100377D0
		mov	byte_100377A4, dl
		mov	edx, [esi+22Ch]
		push	offset byte_100377A4
		push	edx
		push	eax
		push	ecx
		call	sub_1001BE20
		add	esp, 18h
		test	eax, eax
		jz	short loc_100149B2
		push	0
		push	offset sub_100148B0
		call	NSS_RegisterShutdown
		add	esp, 8
		test	eax, eax
		jnz	short loc_10014969
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014969:				; CODE XREF: sub_10014900+12j
					; sub_10014900+16j ...
		mov	eax, dword_100377D0
		test	eax, eax
		jz	short loc_10014985
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword_100377D0,	0

loc_10014985:				; CODE XREF: sub_10014900+70j
		mov	eax, dword_100377D4
		test	eax, eax
		jz	short loc_100149A1
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4
		mov	dword_100377D4,	0

loc_100149A1:				; CODE XREF: sub_10014900+8Cj
		xor	eax, eax
		mov	dword_10037670,	eax
		mov	dword_10037674,	eax
		mov	dword_10037678,	eax

loc_100149B2:				; CODE XREF: sub_10014900+52j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10014900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100149C0	proc near		; CODE XREF: sub_10016CD0+10Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	eax
		push	offset sub_10014900
		push	offset dword_10037670
		call	ds:PR_CallOnceWithArg
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100149FF
		mov	eax, dword_100377D0
		test	eax, eax
		jz	short loc_100149FF
		cmp	dword_100377D4,	0
		jz	short loc_100149FF
		mov	ecx, [esp+arg_0]
		mov	[ecx], eax
		mov	eax, [esp+arg_4]
		mov	edx, dword_100377D4
		mov	[eax], edx
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100149FF:				; CODE XREF: sub_100149C0+16j
					; sub_100149C0+1Fj ...
		or	eax, 0FFFFFFFFh
		retn
sub_100149C0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10014A10:				; DATA XREF: sub_10014A60o
		mov	eax, ds:dword_1002E950
		mov	cl, ds:byte_1002E954
		push	offset dword_100377B0
		push	offset dword_10037780
		push	offset byte_100377A4
		mov	dword_100377A0,	eax
		mov	byte_100377A4, cl
		call	sub_1001BF10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014A45
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014A45:				; CODE XREF: .text:10014A3Fj
		mov	dword_100377D8,	1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014A60	proc near		; CODE XREF: sub_10015700+B4p
					; sub_10016CD0+FAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	offset loc_10014A10
		push	offset dword_10037670
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10014A7B

loc_10014A77:				; CODE XREF: sub_10014A60+22j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014A7B:				; CODE XREF: sub_10014A60+15j
		cmp	dword_100377D8,	0
		jz	short loc_10014A77
		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	dword ptr [eax], offset	dword_10037780
		mov	eax, [esp+arg_C]
		mov	dword ptr [ecx], 20h
		mov	dword ptr [edx], offset	dword_100377B0
		mov	dword ptr [eax], 20h
		xor	eax, eax
		retn
sub_10014A60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014AB0	proc near		; CODE XREF: sub_10006640+1Dp
					; sub_1000A6D0+39Cp ...

arg_0		= dword	ptr  4
arg_4		= word ptr  8

		mov	ecx, [esp+arg_0]
		movzx	edx, word ptr [ecx+2EF6h]
		xor	eax, eax
		push	esi
		test	edx, edx
		jz	short loc_10014ADD
		mov	si, [esp+4+arg_4]
		add	ecx, 2F0Eh
		lea	ecx, [ecx+0]

loc_10014AD0:				; CODE XREF: sub_10014AB0+2Bj
		cmp	si, [ecx]
		jz	short loc_10014AE1
		inc	eax
		add	ecx, 2
		cmp	eax, edx
		jb	short loc_10014AD0

loc_10014ADD:				; CODE XREF: sub_10014AB0+10j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014AE1:				; CODE XREF: sub_10014AB0+23j
		mov	eax, 1
		pop	esi
		retn
sub_10014AB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014AF0	proc near		; DATA XREF: sub_1000D820:loc_1000E630o
					; .rdata:1002E894o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	esi
		mov	esi, [esp+28h+arg_0]
		test	esi, esi
		jnz	short loc_10014B19

loc_10014B07:				; CODE XREF: sub_10014AF0+3Bj
					; sub_10014AF0+40j ...
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10014B19:				; CODE XREF: sub_10014AF0+15j
		cmp	dword ptr [esi+4Ch], 0
		jnz	loc_10014C1C
		mov	eax, [esi+1D8h]
		test	eax, eax
		jz	short loc_10014B07
		cmp	byte ptr [eax],	0
		jz	short loc_10014B07
		lea	ecx, [esp+28h+var_24]
		push	ecx
		push	eax
		call	ds:PR_StringToNetAddr
		add	esp, 8
		test	eax, eax
		jz	short loc_10014B07
		mov	eax, [esi+1D8h]
		lea	edx, [eax+1]
		mov	edi, edi

loc_10014B50:				; CODE XREF: sub_10014AF0+65j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10014B50
		sub	eax, edx
		cmp	[esp+28h+arg_4], 0
		push	edi
		mov	edi, eax
		jz	loc_10014C08
		lea	edx, [edi+9]
		cmp	[esp+2Ch+arg_8], edx
		jb	loc_10014C08
		push	2		; Src
		push	0		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014BD6
		push	2		; Src
		lea	eax, [edi+5]
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014BD6
		push	2		; Src
		lea	ecx, [edi+3]
		push	ecx		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014BD6
		push	1		; Size
		push	offset dword_1002E958 ;	Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014BD6
		mov	edx, [esi+1D8h]
		push	2		; Src
		push	edi		; Size
		push	edx		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jz	short loc_10014BEA

loc_10014BD6:				; CODE XREF: sub_10014AF0+93j
					; sub_10014AF0+A6j ...
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10014BEA:				; CODE XREF: sub_10014AF0+E4j
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_10014C08
		movzx	eax, word ptr [esi+2EF4h]
		xor	ecx, ecx
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]

loc_10014C08:				; CODE XREF: sub_10014AF0+71j
					; sub_10014AF0+7Ej ...
		lea	eax, [edi+9]
		pop	edi
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10014C1C:				; CODE XREF: sub_10014AF0+2Dj
		cmp	[esp+28h+arg_4], 0
		jz	short loc_10014C5F
		cmp	[esp+28h+arg_8], 4
		jb	short loc_10014C5F
		push	2		; Src
		push	0		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10014C4E

loc_10014C3B:				; CODE XREF: sub_10014AF0+16Dj
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10014C4E:				; CODE XREF: sub_10014AF0+149j
		push	2		; Src
		push	0		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10014C3B

loc_10014C5F:				; CODE XREF: sub_10014AF0+131j
					; sub_10014AF0+138j
		mov	ecx, [esp+28h+var_4]
		pop	esi
		xor	ecx, esp
		mov	eax, 4
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10014AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014C80	proc near		; DATA XREF: .rdata:1002E7E4o
					; .rdata:1002E844o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		push	ebp
		push	esi
		mov	esi, [esp+34h+arg_0]
		xor	ebp, ebp
		mov	[esp+34h+var_28], ebp
		cmp	[esi+4Ch], ebp
		jnz	short loc_10014CC1
		mov	eax, [esp+34h+arg_8]
		cmp	[eax+4], ebp
		jnz	short loc_10014CB8
		cmp	[eax+8], ebp
		jnz	short loc_10014CB8
		push	ebp
		push	esi
		call	sub_10014AB0
		add	esp, 8
		test	eax, eax
		jz	short loc_10014CB8

loc_10014CB0:				; CODE XREF: sub_10014C80+47j
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10014CB8:				; CODE XREF: sub_10014C80+1Bj
					; sub_10014C80+20j ...
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10014CC1:				; CODE XREF: sub_10014C80+12j
		cmp	[esi+20Ch], ebp
		jz	short loc_10014CB0
		push	ebx
		mov	ebx, [esp+38h+arg_8]
		push	edi
		lea	eax, [ebx+8]
		push	eax
		lea	ecx, [ebx+4]
		push	ecx
		push	2
		push	esi
		mov	[esp+4Ch+var_24], eax
		mov	[esp+4Ch+var_20], ecx
		call	sub_100091C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	loc_10014E85
		mov	eax, [esp+3Ch+var_24]
		cmp	edi, [eax]
		jnz	loc_10014E85
		mov	ecx, [ebx]
		mov	edx, [ebx+4]
		mov	eax, [ebx+8]
		mov	[esp+3Ch+var_18], ecx
		mov	[esp+3Ch+var_14], edx
		mov	[esp+3Ch+var_10], eax
		test	edi, edi
		jle	loc_10014E85
		lea	esp, [esp+0]

loc_10014D20:				; CODE XREF: sub_10014C80+FFj
		lea	ecx, [esp+3Ch+var_10]
		push	ecx
		lea	edx, [esp+40h+var_14]
		push	edx
		push	1
		push	esi
		call	sub_100091C0
		add	esp, 10h
		cmp	[esp+3Ch+var_10], 0
		jz	loc_10014E85
		lea	eax, [esp+3Ch+var_10]
		push	eax
		lea	ecx, [esp+40h+var_14]
		push	ecx
		push	2
		lea	edx, [esp+48h+var_C]
		push	edx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10014E85
		mov	eax, 0FFFFFFFDh
		sub	eax, [esp+3Ch+var_4]
		add	edi, eax
		test	edi, edi
		jle	short loc_10014D7C
		cmp	[esp+3Ch+var_10], 0
		jz	loc_10014E85

loc_10014D7C:				; CODE XREF: sub_10014C80+EFj
		inc	ebp
		test	edi, edi
		jg	short loc_10014D20
		test	ebp, ebp
		jz	loc_10014E85
		lea	ecx, [ebp+ebp*2+0]
		add	ecx, ecx
		add	ecx, ecx
		push	ecx
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		mov	[esp+3Ch+var_2C], edi
		test	edi, edi
		jz	loc_10014E85
		mov	[esp+3Ch+var_1C], 0
		test	ebp, ebp
		jz	short loc_10014E30
		mov	[esp+3Ch+arg_0], edi
		jmp	short loc_10014DC0
; ---------------------------------------------------------------------------
		align 10h

loc_10014DC0:				; CODE XREF: sub_10014C80+138j
					; sub_10014C80+1AAj
		mov	ebx, [esp+3Ch+var_24]
		mov	edx, [esp+3Ch+var_20]
		push	ebx
		push	edx
		push	1
		push	esi
		xor	edi, edi
		call	sub_100091C0
		mov	ecx, [esp+4Ch+var_2C]
		add	esp, 10h
		xor	edx, edx
		lea	ecx, [ecx+0]

loc_10014DE0:				; CODE XREF: sub_10014C80+16Fj
		cmp	[ecx+4], edi
		jz	short loc_10014DF8
		cmp	[ecx], eax
		jz	short loc_10014DF3
		inc	edx
		add	ecx, 0Ch
		cmp	edx, ebp
		jb	short loc_10014DE0
		jmp	short loc_10014DF8
; ---------------------------------------------------------------------------

loc_10014DF3:				; CODE XREF: sub_10014C80+167j
		mov	edi, 1

loc_10014DF8:				; CODE XREF: sub_10014C80+163j
					; sub_10014C80+171j
		mov	eax, [esp+3Ch+var_20]
		mov	ecx, [esp+3Ch+arg_0]
		push	ebx
		push	eax
		push	2
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10014E78
		test	edi, edi
		jnz	short loc_10014E1F
		inc	[esp+3Ch+var_28]
		add	[esp+3Ch+arg_0], 0Ch

loc_10014E1F:				; CODE XREF: sub_10014C80+194j
		mov	eax, [esp+3Ch+var_1C]
		inc	eax
		mov	[esp+3Ch+var_1C], eax
		cmp	eax, ebp
		jb	short loc_10014DC0
		mov	edi, [esp+3Ch+var_2C]

loc_10014E30:				; CODE XREF: sub_10014C80+132j
		cmp	dword ptr [esi+2F30h], 0
		jz	short loc_10014E48
		mov	eax, [esi+2F30h]
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10014E48:				; CODE XREF: sub_10014C80+1B7j
		movzx	edx, word ptr [esi+2EF6h]
		mov	ecx, [esp+3Ch+var_28]
		mov	[esi+2F30h], edi
		pop	edi
		xor	eax, eax
		mov	[esi+2F34h], ecx
		mov	[esi+edx*2+2F0Eh], ax
		inc	word ptr [esi+2EF6h]
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10014E78:				; CODE XREF: sub_10014C80+190j
		mov	edx, [esp+3Ch+var_2C]
		push	edx
		call	PORT_Free_Util
		add	esp, 4

loc_10014E85:				; CODE XREF: sub_10014C80+6Ej
					; sub_10014C80+7Aj ...
		pop	edi
		pop	ebx
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 2Ch
		retn
sub_10014C80	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014E90	proc near		; DATA XREF: sub_1000D820+475o
					; .rdata:1002E8B4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		test	dword ptr [esi+14h], 20000h
		jnz	short loc_10014EA6
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014EA6:				; CODE XREF: sub_10014E90+Fj
		push	ebx
		mov	ebx, 4
		cmp	[esi+4Ch], edi
		jnz	short loc_10014ED2
		mov	edi, [esi+0F4h]
		add	edi, 0F0h
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_10014ED2
		cmp	dword ptr [esi+2F24h], 0
		jz	short loc_10014F36
		mov	ebx, [edi+10h]
		add	ebx, 4

loc_10014ED2:				; CODE XREF: sub_10014E90+1Fj
					; sub_10014E90+31j
		cmp	[esp+0Ch+arg_4], 0
		jz	loc_10014F61

loc_10014EDD:				; CODE XREF: sub_10014E90+ABj
		cmp	[esp+0Ch+arg_8], ebx
		jb	loc_10014F67
		push	2		; Src
		push	23h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10014F7E
		test	edi, edi
		jz	short loc_10014F6D
		mov	eax, [edi+0Ch]
		test	eax, eax
		jz	short loc_10014F6D
		cmp	dword ptr [esi+2F24h], 0
		jz	short loc_10014F6D
		mov	edx, [edi+10h]
		push	2		; Src
		push	edx		; Size
		push	eax		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		mov	dword ptr [esi+2F24h], 0
		mov	dword ptr [esi+2F2Ch], 1
		jmp	short loc_10014F7A
; ---------------------------------------------------------------------------

loc_10014F36:				; CODE XREF: sub_10014E90+3Aj
		cmp	[esp+0Ch+arg_4], 0
		jnz	short loc_10014EDD
		cmp	dword ptr [edi+4], 0
		jz	short loc_10014F51
		call	sub_10018130
		mov	ecx, [edi+4]
		add	ecx, [edi]
		cmp	ecx, eax
		jbe	short loc_10014F61

loc_10014F51:				; CODE XREF: sub_10014E90+B1j
		mov	ebx, [edi+10h]
		add	ebx, 4
		mov	dword ptr [esi+2F24h], 1

loc_10014F61:				; CODE XREF: sub_10014E90+47j
					; sub_10014E90+BFj
		cmp	[esp+0Ch+arg_8], ebx
		jnb	short loc_10014FB0

loc_10014F67:				; CODE XREF: sub_10014E90+51j
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014F6D:				; CODE XREF: sub_10014E90+6Ej
					; sub_10014E90+75j ...
		push	2		; Src
		push	0		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch

loc_10014F7A:				; CODE XREF: sub_10014E90+A4j
		test	eax, eax
		jz	short loc_10014F8F

loc_10014F7E:				; CODE XREF: sub_10014E90+66j
		pop	ebx
		pop	edi
		mov	dword ptr [esi+2F24h], 0
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014F8F:				; CODE XREF: sub_10014E90+ECj
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_10014FB0
		movzx	eax, word ptr [esi+2EF4h]
		mov	ecx, 23h
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]

loc_10014FB0:				; CODE XREF: sub_10014E90+D5j
					; sub_10014E90+103j
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		retn
sub_10014E90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014FC0	proc near		; DATA XREF: .rdata:1002E80Co

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+24h], 0
		jnz	short loc_10014FF2
		mov	ecx, [esp+arg_8]
		cmp	dword ptr [ecx+8], 0
		jnz	short loc_10014FF2
		movzx	edx, word ptr [eax+2EF6h]
		mov	cx, [esp+arg_4]
		mov	[eax+edx*2+2F0Eh], cx
		inc	word ptr [eax+2EF6h]
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10014FF2:				; CODE XREF: sub_10014FC0+8j
					; sub_10014FC0+12j
		push	0FFFFD074h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_10014FC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015010	proc near		; CODE XREF: SSL_SetNextProtoNego+55p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		push	esi
		xor	eax, eax
		push	edi
		test	edx, edx
		jz	short loc_10015036
		mov	esi, [esp+8+arg_0]

loc_10015020:				; CODE XREF: sub_10015010+24j
		mov	cl, [eax+esi]
		movzx	edi, cl
		lea	eax, [edi+eax+1]
		cmp	eax, edx
		ja	short loc_1001503B
		test	cl, cl
		jz	short loc_1001503B
		cmp	eax, edx
		jb	short loc_10015020

loc_10015036:				; CODE XREF: sub_10015010+Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001503B:				; CODE XREF: sub_10015010+1Cj
					; sub_10015010+20j
		push	0FFFFD074h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10015010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015050	proc near		; CODE XREF: sub_100151E0+6Ap
					; sub_10016C30+57p

var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= byte ptr -104h
var_4		= dword	ptr -4
arg_0		= word ptr  4

		sub	esp, 110h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+110h+var_4], eax
		push	ebp
		push	esi
		lea	eax, [esp+118h+var_104]
		push	edi
		mov	edi, [ecx+4]
		mov	[esp+11Ch+var_10C], eax
		mov	eax, [ecx+8]
		xor	ecx, ecx
		mov	esi, edx
		mov	[esp+11Ch+var_110], 0
		mov	[esp+11Ch+var_108], 0
		test	eax, eax
		jz	short loc_100150A6
		lea	ecx, [ecx+0]

loc_10015090:				; CODE XREF: sub_10015050+54j
		mov	dl, [ecx+edi]
		movzx	ebp, dl
		lea	ecx, [ecx+ebp+1]
		cmp	ecx, eax
		ja	short loc_10015106
		test	dl, dl
		jz	short loc_10015106
		cmp	ecx, eax
		jb	short loc_10015090

loc_100150A6:				; CODE XREF: sub_10015050+3Bj
		push	0FFh
		lea	ecx, [esp+120h+var_108]
		push	ecx
		mov	ecx, [esi+234h]
		lea	edx, [esp+124h+var_104]
		push	edx
		mov	edx, [esi+230h]
		push	eax
		mov	eax, [esi]
		push	edi
		push	eax
		push	ecx
		call	edx
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_100151BD
		cmp	[esp+11Ch+var_108], 0FFh
		jbe	short loc_1001512E
		push	0FFFFE003h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+110h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_10015106:				; CODE XREF: sub_10015050+4Cj
					; sub_10015050+50j
		push	0FFFFD074h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+110h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_1001512E:				; CODE XREF: sub_10015050+8Cj
		mov	cx, [esp+11Ch+arg_0]
		mov	eax, 1
		cmp	cx, 10h
		jnz	short loc_10015189
		cmp	[esi+2E84h], eax
		jz	short loc_10015189
		lea	eax, [esi+2E78h]
		push	0
		push	eax
		call	SECITEM_FreeItem_Util
		push	0FFFFD082h
		call	PORT_SetError_Util
		push	78h
		push	2
		push	esi
		call	sub_10008960
		add	esp, 18h
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+110h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_10015189:				; CODE XREF: sub_10015050+EFj
					; sub_10015050+F7j
		movzx	edx, word ptr [esi+2EF6h]
		mov	[esi+edx*2+2F0Eh], cx
		add	[esi+2EF6h], ax
		add	esi, 2E78h
		push	0
		push	esi
		call	SECITEM_FreeItem_Util
		lea	eax, [esp+124h+var_110]
		push	eax
		push	esi
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 14h

loc_100151BD:				; CODE XREF: sub_10015050+7Ej
		mov	ecx, [esp+11Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 110h
		retn
sub_10015050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100151E0	proc near		; DATA XREF: .rdata:1002E85Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		push	esi
		movzx	esi, word ptr [edx+2EF6h]
		xor	eax, eax
		push	edi
		test	esi, esi
		jz	short loc_10015212
		lea	ecx, [edx+2F0Eh]
		lea	esp, [esp+0]

loc_10015200:				; CODE XREF: sub_100151E0+30j
		mov	edi, 10h
		cmp	di, [ecx]
		jz	short loc_1001522E
		inc	eax
		add	ecx, 2
		cmp	eax, esi
		jb	short loc_10015200

loc_10015212:				; CODE XREF: sub_100151E0+11j
		cmp	dword ptr [edx+230h], 0
		jnz	short loc_10015241
		push	0FFFFD081h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001522E:				; CODE XREF: sub_100151E0+28j
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015241:				; CODE XREF: sub_100151E0+39j
		mov	eax, [esp+8+arg_4]
		mov	ecx, [esp+8+arg_8]
		push	eax
		call	sub_10015050
		add	esp, 4
		pop	edi
		pop	esi
		retn
sub_100151E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015260	proc near		; DATA XREF: .rdata:1002E864o

var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		movzx	ecx, word ptr [esi+2EF6h]
		xor	eax, eax
		push	edi
		mov	edi, [ebx+4]
		test	ecx, ecx
		jz	short loc_100152A6
		lea	edx, [esi+2F0Eh]
		jmp	short loc_10015290
; ---------------------------------------------------------------------------
		align 10h

loc_10015290:				; CODE XREF: sub_10015260+25j
					; sub_10015260+44j
		mov	ebp, 3374h
		cmp	bp, [edx]
		jz	loc_10015335
		inc	eax
		add	edx, 2
		cmp	eax, ecx
		jb	short loc_10015290

loc_100152A6:				; CODE XREF: sub_10015260+1Dj
		mov	eax, [ebx+8]
		cmp	eax, 4
		jb	loc_1001534D
		cmp	eax, 102h
		ja	loc_1001534D
		movzx	ecx, byte ptr [edi]
		shl	cx, 8
		movzx	edx, cx
		movzx	ecx, byte ptr [edi+1]
		or	edx, ecx
		lea	ecx, [eax-2]
		cmp	edx, ecx
		jnz	short loc_1001534D
		movzx	edx, byte ptr [edi+2]
		add	eax, 0FFFFFFFDh
		cmp	edx, eax
		jnz	short loc_1001534D
		add	edi, 3
		mov	[esp+1Ch+var_8], edi
		lea	edi, [esi+2E78h]
		push	0
		push	edi
		mov	[esp+24h+var_4], eax
		call	SECITEM_FreeItem_Util
		movzx	eax, word ptr [esi+2EF6h]
		mov	cx, [esp+24h+arg_4]
		lea	edx, [esp+24h+var_C]
		push	edx
		mov	dword ptr [esi+2E84h], 3
		push	edi
		mov	[esi+eax*2+2F0Eh], cx
		inc	word ptr [esi+2EF6h]
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10015335:				; CODE XREF: sub_10015260+38j
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001534D:				; CODE XREF: sub_10015260+4Cj
					; sub_10015260+57j ...
		push	0FFFFD074h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
sub_10015260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015370	proc near		; DATA XREF: .rdata:1002E8BCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	dword ptr [esi+14h], 2000000h
		jz	short loc_100153F4
		cmp	dword ptr [esi+230h], 0
		jz	short loc_100153F4
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_100153F4
		cmp	[esp+4+arg_4], 0
		jz	short loc_100153E6
		cmp	[esp+4+arg_8], 4
		jb	short loc_100153F4
		push	2		; Src
		push	3374h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100153BF
		push	2		; Src
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100153C4

loc_100153BF:				; CODE XREF: sub_10015370+3Dj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100153C4:				; CODE XREF: sub_10015370+4Dj
		movzx	eax, word ptr [esi+2EF4h]
		mov	ecx, 3374h
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]
		mov	eax, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100153E6:				; CODE XREF: sub_10015370+22j
		cmp	[esp+4+arg_8], 4
		jb	short loc_100153F4
		mov	eax, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100153F4:				; CODE XREF: sub_10015370+Cj
					; sub_10015370+15j ...
		xor	eax, eax
		pop	esi
		retn
sub_10015370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015400	proc near		; DATA XREF: .rdata:1002E8C4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	dword ptr [esi+14h], 4000000h
		jz	loc_10015519
		cmp	dword ptr [esi+0Ch], 0
		jz	loc_10015519
		cmp	dword ptr [esi+24h], 0
		jnz	loc_10015519
		cmp	[esp+4+arg_4], 0
		push	ebx
		mov	ebx, [esi+10h]
		push	ebp
		push	edi
		lea	edi, [ebx+6]
		jz	loc_1001550C
		cmp	[esp+10h+arg_8], edi
		jb	loc_10015512
		push	ebx
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_10015504
		test	ebx, ebx
		jz	short loc_10015499
		mov	ecx, [esi+0Ch]
		movzx	edi, byte ptr [ecx]
		inc	edi
		cmp	edi, ebx
		ja	short loc_1001548E
		mov	eax, ebx
		sub	eax, edi
		push	eax		; Size
		add	ecx, edi
		push	ecx		; Src
		push	ebp		; Dst
		mov	[esp+1Ch+arg_0], eax
		call	memcpy
		mov	eax, [esi+0Ch]
		mov	ecx, [esp+1Ch+arg_0]
		push	edi		; Size
		push	eax		; Src
		add	ecx, ebp
		push	ecx		; Dst
		call	memcpy
		add	esp, 18h
		jmp	short loc_10015499
; ---------------------------------------------------------------------------

loc_1001548E:				; CODE XREF: sub_10015400+64j
		push	ebx		; Size
		push	ecx		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch

loc_10015499:				; CODE XREF: sub_10015400+59j
					; sub_10015400+8Cj
		push	2		; Src
		push	10h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100154FB
		lea	edi, [ebx+6]
		push	2		; Src
		lea	edx, [edi-4]
		push	edx		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100154FB
		push	2		; Src
		push	ebx		; Size
		push	ebp		; void *
		push	esi		; int
		call	sub_10008F70
		push	ebp
		mov	ebx, eax
		call	PORT_Free_Util
		add	esp, 14h
		test	ebx, ebx
		jnz	short loc_10015504
		movzx	eax, word ptr [esi+2EF4h]
		mov	ecx, 10h
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]

loc_100154F4:				; CODE XREF: sub_10015400+110j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100154FB:				; CODE XREF: sub_10015400+A8j
					; sub_10015400+BEj
		push	ebp
		call	PORT_Free_Util
		add	esp, 4

loc_10015504:				; CODE XREF: sub_10015400+51j
					; sub_10015400+D7j
		pop	edi
		pop	ebp
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001550C:				; CODE XREF: sub_10015400+34j
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_100154F4

loc_10015512:				; CODE XREF: sub_10015400+3Ej
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015519:				; CODE XREF: sub_10015400+Cj
					; sub_10015400+16j ...
		xor	eax, eax
		pop	esi
		retn
sub_10015400	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10015520:				; DATA XREF: sub_10016C30+6Co
		push	esi
		mov	esi, [esp+8]
		push	edi
		mov	edi, [esi+2E80h]
		add	edi, 7
		cmp	dword ptr [esp+10h], 0
		jz	short loc_1001559A
		cmp	[esp+14h], edi
		jb	short loc_100155A0
		push	2
		push	10h
		push	esi
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10015594
		push	2
		lea	eax, [edi-4]
		push	eax
		push	esi
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10015594
		mov	ecx, [esi+2E80h]
		push	2
		inc	ecx
		push	ecx
		push	esi
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10015594
		mov	edx, [esi+2E80h]
		mov	eax, [esi+2E7Ch]
		push	1
		push	edx
		push	eax
		push	esi
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jz	short loc_100155A5

loc_10015594:				; CODE XREF: .text:1001554Bj
					; .text:1001555Ej ...
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001559A:				; CODE XREF: .text:10015534j
		cmp	[esp+14h], edi
		jnb	short loc_100155A5

loc_100155A0:				; CODE XREF: .text:1001553Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100155A5:				; CODE XREF: .text:10015592j
					; .text:1001559Ej
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100155B0	proc near		; DATA XREF: .rdata:1002E84Co
					; .rdata:1002E874o

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		cmp	dword ptr [eax+8], 0
		jz	short loc_100155BE
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100155BE:				; CODE XREF: sub_100155B0+8j
		mov	eax, [esp+arg_0]
		movzx	ecx, word ptr [eax+2EF6h]
		mov	dx, [esp+arg_4]
		mov	[eax+ecx*2+2F0Eh], dx
		inc	word ptr [eax+2EF6h]
		xor	eax, eax
		retn
sub_100155B0	endp

; ---------------------------------------------------------------------------

loc_100155E0:				; DATA XREF: sub_10016420+1Eo
		push	esi
		mov	esi, [esp+8]
		xor	eax, eax
		lea	ecx, [esi+33Ch]
		lea	ecx, [ecx+0]

loc_100155F0:				; CODE XREF: .text:10015603j
		mov	edx, [ecx]
		test	edx, edx
		jz	short loc_100155FC
		cmp	dword ptr [edx+4], 0
		jnz	short loc_10015609

loc_100155FC:				; CODE XREF: .text:100155F4j
		inc	eax
		add	ecx, 4
		cmp	eax, 5
		jl	short loc_100155F0
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015609:				; CODE XREF: .text:100155FAj
		cmp	dword ptr [esp+0Ch], 0
		jz	short loc_1001563E
		cmp	dword ptr [esp+10h], 4
		jb	short loc_1001563E
		push	2
		push	5
		push	esi
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001562D

loc_10015628:				; CODE XREF: .text:1001563Cj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001562D:				; CODE XREF: .text:10015626j
		push	2
		push	0
		push	esi
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10015628

loc_1001563E:				; CODE XREF: .text:1001560Ej
					; .text:10015615j
		mov	eax, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015650	proc near		; DATA XREF: .rdata:1002E8D4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	byte ptr [esi+17h], 1
		jnz	short loc_1001565F

loc_1001565B:				; CODE XREF: sub_10015650+1Bj
					; sub_10015650+9Aj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001565F:				; CODE XREF: sub_10015650+9j
		cmp	[esp+4+arg_4], 0
		jz	short loc_100156E5
		cmp	[esp+4+arg_8], 9
		jb	short loc_1001565B
		push	2		; Src
		push	5		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10015683

loc_1001567E:				; CODE XREF: sub_10015650+42j
					; sub_10015650+53j ...
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015683:				; CODE XREF: sub_10015650+2Cj
		push	2		; Src
		push	5		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001567E
		push	1		; Src
		push	1		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001567E
		push	2		; Src
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001567E
		push	2		; Src
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001567E
		movzx	eax, word ptr [esi+2EF4h]
		mov	ecx, 5
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]
		lea	eax, [ecx+4]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100156E5:				; CODE XREF: sub_10015650+14j
		cmp	[esp+4+arg_8], 9
		jb	loc_1001565B
		mov	eax, 9
		pop	esi
		retn
sub_10015650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015700	proc near		; CODE XREF: sub_1000CB90+26Cp

var_B98		= dword	ptr -0B98h
var_B94		= dword	ptr -0B94h
var_B90		= dword	ptr -0B90h
var_B8C		= dword	ptr -0B8Ch
var_B88		= dword	ptr -0B88h
var_B84		= dword	ptr -0B84h
var_B80		= dword	ptr -0B80h
var_B7C		= dword	ptr -0B7Ch
var_B78		= dword	ptr -0B78h
var_B74		= dword	ptr -0B74h
var_B70		= dword	ptr -0B70h
var_B6C		= dword	ptr -0B6Ch
var_B68		= dword	ptr -0B68h
var_B64		= dword	ptr -0B64h
var_B60		= byte ptr -0B60h
var_B5F		= byte ptr -0B5Fh
var_B5C		= dword	ptr -0B5Ch
Size		= dword	ptr -0B58h
var_B54		= dword	ptr -0B54h
var_B50		= byte ptr -0B50h
var_B4C		= dword	ptr -0B4Ch
var_B48		= dword	ptr -0B48h
var_B44		= dword	ptr -0B44h
var_B40		= dword	ptr -0B40h
var_B3C		= dword	ptr -0B3Ch
var_B38		= dword	ptr -0B38h
Val		= dword	ptr -0B30h
var_B2C		= dword	ptr -0B2Ch
var_B28		= byte ptr -0B28h
var_B24		= dword	ptr -0B24h
var_B20		= dword	ptr -0B20h
Dst		= byte ptr -0B1Ch
Src		= byte ptr -0A9Ch
var_A6C		= word ptr -0A6Ch
var_A68		= dword	ptr -0A68h
var_A14		= byte ptr -0A14h
var_884		= byte ptr -884h
var_64		= byte ptr -64h
var_54		= byte ptr -54h
var_34		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0B98h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B98h+var_4], eax
		push	ebp
		mov	ebp, [esp+0B9Ch+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		test	byte ptr [ebp+14h], 4
		mov	[esp+0BA4h+var_B78], edi
		mov	[esp+0BA4h+var_B74], edi
		mov	[esp+0BA4h+var_B70], edi
		mov	[esp+0BA4h+var_B84], edi
		mov	[esp+0BA4h+var_B80], edi
		mov	[esp+0BA4h+var_B7C], edi
		mov	[esp+0BA4h+var_B6C], edi
		mov	[esp+0BA4h+var_B64], edi
		mov	[esp+0BA4h+var_B88], edi
		jz	short loc_10015763
		mov	eax, [ebp+0F4h]
		mov	eax, [eax+10h]
		cmp	eax, edi
		jz	short loc_10015763
		mov	eax, [eax+44h]
		add	eax, 3
		mov	[esp+0BA4h+var_B98], eax
		jmp	short loc_10015767
; ---------------------------------------------------------------------------

loc_10015763:				; CODE XREF: sub_10015700+48j
					; sub_10015700+55j
		mov	[esp+0BA4h+var_B98], edi

loc_10015767:				; CODE XREF: sub_10015700+61j
		lea	ecx, [esp+0BA4h+var_64]
		mov	edx, ecx
		push	10h
		push	edx
		mov	[esp+0BACh+var_B24], ecx
		mov	[esp+0BACh+var_B20], 10h
		call	PK11_GenerateRandom
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	loc_100160D9
		test	dword ptr [ebp+14h], 8000h
		jz	short loc_10015803
		lea	eax, [esp+0BA4h+var_B44]
		push	eax
		lea	ecx, [esp+0BA8h+var_B68]
		push	ecx
		lea	edx, [esp+0BACh+var_B3C]
		push	edx
		lea	eax, [esp+0BB0h+var_B5C]
		push	eax
		call	sub_10014A60
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_100160D9

loc_100157C6:				; CODE XREF: sub_10015700+140j
		mov	edi, [ebp+454h]
		cmp	dword ptr [edi+1138h], 0
		push	ebx
		mov	ebx, 1
		jz	short loc_10015842
		cmp	dword ptr [edi+1134h], 0
		jz	short loc_10015842
		mov	eax, edi
		mov	ecx, [eax+1134h]
		mov	edi, [eax+1138h]
		mov	[esp+0BA8h+var_B4C], ecx
		mov	[esp+0BA8h+var_B54], 0
		jmp	loc_100158D4
; ---------------------------------------------------------------------------

loc_10015803:				; CODE XREF: sub_10015700+9Ej
		push	ebp
		push	offset sub_10014900
		push	offset dword_10037670
		call	ds:PR_CallOnceWithArg
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10015823

loc_1001581B:				; CODE XREF: sub_10015700+12Bj
					; sub_10015700+134j
		or	esi, 0FFFFFFFFh
		jmp	loc_100160D9
; ---------------------------------------------------------------------------

loc_10015823:				; CODE XREF: sub_10015700+119j
		mov	ecx, dword_100377D0
		test	ecx, ecx
		jz	short loc_1001581B
		mov	eax, dword_100377D4
		test	eax, eax
		jz	short loc_1001581B
		mov	[esp+0BA4h+var_B5C], ecx
		mov	[esp+0BA4h+var_B68], eax
		xor	esi, esi
		jmp	short loc_100157C6
; ---------------------------------------------------------------------------

loc_10015842:				; CODE XREF: sub_10015700+D9j
					; sub_10015700+E2j
		push	108h		; Size
		lea	edx, [esp+0BACh+Dst]
		push	0		; Val
		push	edx		; Dst
		call	memset
		mov	eax, [ebp+808h]
		add	esp, 0Ch
		cmp	dword ptr [eax], 12h
		jnz	short loc_10015868
		mov	eax, ebx
		jmp	short loc_1001586B
; ---------------------------------------------------------------------------

loc_10015868:				; CODE XREF: sub_10015700+162j
		mov	eax, [eax+4]

loc_1001586B:				; CODE XREF: sub_10015700+166j
		push	eax
		mov	[esp+0BACh+var_B6C], eax
		push	edi
		lea	eax, [esp+0BB0h+Dst]
		push	eax
		push	ebp
		call	sub_10006EA0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	loc_100160D8
		mov	ax, [esp+0BA8h+var_A6C]
		cmp	ax, 30h
		ja	loc_100160D8
		movzx	edi, ax
		push	edi		; Size
		lea	ecx, [esp+0BACh+Src]
		push	ecx		; Src
		lea	edx, [esp+0BB0h+var_34]
		push	edx		; Dst
		call	memcpy
		mov	ecx, [esp+0BB4h+var_A68]
		lea	eax, [esp+0BB4h+var_34]
		add	esp, 0Ch
		mov	[esp+0BA8h+var_B4C], eax
		mov	[esp+0BA8h+var_B88], ecx
		mov	[esp+0BA8h+var_B54], ebx

loc_100158D4:				; CODE XREF: sub_10015700+FEj
		mov	ecx, [ebp+454h]
		add	ecx, 1204h
		cmp	dword ptr [ecx+4], 0
		mov	[esp+0BA8h+var_B48], edi
		mov	[esp+0BA8h+var_B2C], ecx
		jz	short loc_100158FC
		mov	ecx, [ecx+8]
		test	ecx, ecx
		jz	short loc_100158FC
		add	ecx, 2
		mov	[esp+0BA8h+var_B64], ecx

loc_100158FC:				; CODE XREF: sub_10015700+1ECj
					; sub_10015700+1F3j
		mov	edx, [esp+0BA8h+var_B98]
		add	edx, [esp+0BA8h+var_B64]
		mov	ecx, 10h
		lea	eax, [edx+edi+1Fh]
		mov	edx, eax
		and	edx, 0Fh
		sub	ecx, edx
		add	eax, ecx
		push	eax
		lea	edx, [esp+0BACh+var_B78]
		mov	[esp+0BACh+Val], ecx
		push	edx
		lea	ecx, [eax+48h]
		push	0
		mov	[esp+0BB4h+var_B40], eax
		mov	[esp+0BB4h+var_B38], ecx
		call	SECITEM_AllocItem_Util
		add	esp, 0Ch
		test	eax, eax
		jz	loc_100160D8
		mov	eax, [esp+0BA8h+var_B78]
		mov	ecx, [esp+0BA8h+var_B70]
		mov	[esp+0BA8h+var_B94], eax
		mov	eax, [esp+0BA8h+var_B74]
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		mov	word ptr [esp+0BA8h+var_B98], bx
		cmp	ecx, 2
		jnb	short loc_10015964
		or	esi, 0FFFFFFFFh
		jmp	short loc_1001597C
; ---------------------------------------------------------------------------

loc_10015964:				; CODE XREF: sub_10015700+25Dj
		mov	dx, word ptr [esp+0BA8h+var_B98]
		mov	[eax], dx
		add	eax, 2
		sub	ecx, 2
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_1001597C:				; CODE XREF: sub_10015700+262j
		test	esi, esi
		jnz	loc_100160D8
		movzx	edx, word ptr [ebp+44h]
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B98], bl
		mov	byte ptr [esp+0BA8h+var_B98+1],	dl
		cmp	ecx, 2
		jnb	short loc_1001599F
		or	esi, 0FFFFFFFFh
		jmp	short loc_100159B7
; ---------------------------------------------------------------------------

loc_1001599F:				; CODE XREF: sub_10015700+298j
		mov	dx, word ptr [esp+0BA8h+var_B98]
		mov	[eax], dx
		add	eax, 2
		sub	ecx, 2
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_100159B7:				; CODE XREF: sub_10015700+29Dj
		test	esi, esi
		jnz	loc_100160D8
		movzx	edx, word ptr [ebp+80Ch]
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B98], bl
		mov	byte ptr [esp+0BA8h+var_B98+1],	dl
		cmp	ecx, 2
		jnb	short loc_100159DD
		or	esi, 0FFFFFFFFh
		jmp	short loc_100159F5
; ---------------------------------------------------------------------------

loc_100159DD:				; CODE XREF: sub_10015700+2D6j
		mov	dx, word ptr [esp+0BA8h+var_B98]
		mov	[eax], dx
		add	eax, 2
		sub	ecx, 2
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_100159F5:				; CODE XREF: sub_10015700+2DBj
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebp+814h]
		cmp	ecx, 1
		jnb	short loc_10015A0D
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015A1B
; ---------------------------------------------------------------------------

loc_10015A0D:				; CODE XREF: sub_10015700+306j
		mov	[eax], dl
		inc	eax
		dec	ecx
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015A1B:				; CODE XREF: sub_10015700+30Bj
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebp+74h]
		cmp	ecx, 1
		jnb	short loc_10015A30
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015A3E
; ---------------------------------------------------------------------------

loc_10015A30:				; CODE XREF: sub_10015700+329j
		mov	[eax], dl
		inc	eax
		dec	ecx
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015A3E:				; CODE XREF: sub_10015700+32Ej
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebp+78h]
		mov	ebx, edx
		shr	ebx, 18h
		mov	byte ptr [esp+0BA8h+var_B98], bl
		mov	ebx, edx
		shr	ebx, 10h
		mov	byte ptr [esp+0BA8h+var_B98+1],	bl
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B98+2],	bl
		mov	byte ptr [esp+0BA8h+var_B98+3],	dl
		cmp	ecx, 4
		jnb	short loc_10015A72
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015A88
; ---------------------------------------------------------------------------

loc_10015A72:				; CODE XREF: sub_10015700+36Bj
		mov	edx, [esp+0BA8h+var_B98]
		mov	[eax], edx
		add	eax, 4
		sub	ecx, 4
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015A88:				; CODE XREF: sub_10015700+370j
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebp+7Ch]
		cmp	ecx, 1
		jnb	short loc_10015A9D
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015AAB
; ---------------------------------------------------------------------------

loc_10015A9D:				; CODE XREF: sub_10015700+396j
		mov	[eax], dl
		inc	eax
		dec	ecx
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015AAB:				; CODE XREF: sub_10015700+39Bj
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebp+80h]
		mov	ebx, edx
		shr	ebx, 18h
		mov	byte ptr [esp+0BA8h+var_B98], bl
		mov	ebx, edx
		shr	ebx, 10h
		mov	byte ptr [esp+0BA8h+var_B98+1],	bl
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B98+2],	bl
		mov	byte ptr [esp+0BA8h+var_B98+3],	dl
		cmp	ecx, 4
		jnb	short loc_10015AE2
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015AF8
; ---------------------------------------------------------------------------

loc_10015AE2:				; CODE XREF: sub_10015700+3DBj
		mov	edx, [esp+0BA8h+var_B98]
		mov	[eax], edx
		add	eax, 4
		sub	ecx, 4
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015AF8:				; CODE XREF: sub_10015700+3E0j
		test	esi, esi
		jnz	loc_100160D8
		cmp	ecx, 1
		jnb	short loc_10015B0A
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015B1C
; ---------------------------------------------------------------------------

loc_10015B0A:				; CODE XREF: sub_10015700+403j
		mov	dl, byte ptr [esp+0BA8h+var_B54]
		mov	[eax], dl
		inc	eax
		dec	ecx
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015B1C:				; CODE XREF: sub_10015700+408j
		test	esi, esi
		jnz	loc_100160D8
		cmp	ecx, 1
		jnb	short loc_10015B2E
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015B40
; ---------------------------------------------------------------------------

loc_10015B2E:				; CODE XREF: sub_10015700+427j
		mov	dl, byte ptr [esp+0BA8h+var_B6C]
		mov	[eax], dl
		inc	eax
		dec	ecx
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015B40:				; CODE XREF: sub_10015700+42Cj
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [esp+0BA8h+var_B88]
		mov	ebx, edx
		shr	ebx, 18h
		mov	byte ptr [esp+0BA8h+var_B98], bl
		mov	ebx, edx
		shr	ebx, 10h
		mov	byte ptr [esp+0BA8h+var_B98+1],	bl
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B98+2],	bl
		mov	byte ptr [esp+0BA8h+var_B98+3],	dl
		cmp	ecx, 4
		jnb	short loc_10015B75
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015B8B
; ---------------------------------------------------------------------------

loc_10015B75:				; CODE XREF: sub_10015700+46Ej
		mov	edx, [esp+0BA8h+var_B98]
		mov	[eax], edx
		add	eax, 4
		sub	ecx, 4
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015B8B:				; CODE XREF: sub_10015700+473j
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [esp+0BA8h+var_B48]
		mov	ebx, edx
		shr	ebx, 8
		mov	byte ptr [esp+0BA8h+var_B88], bl
		mov	byte ptr [esp+0BA8h+var_B88+1],	dl
		cmp	ecx, 2
		jnb	short loc_10015BAE
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015BC6
; ---------------------------------------------------------------------------

loc_10015BAE:				; CODE XREF: sub_10015700+4A7j
		mov	si, word ptr [esp+0BA8h+var_B88]
		mov	[eax], si
		add	eax, 2
		sub	ecx, 2
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], ecx
		xor	esi, esi

loc_10015BC6:				; CODE XREF: sub_10015700+4ACj
		test	esi, esi
		jnz	loc_100160D8
		mov	eax, [esp+0BA8h+var_B4C]
		push	eax
		mov	edi, edx
		lea	esi, [esp+0BACh+var_B94]
		call	sub_10014880
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	loc_100160D8
		mov	ebx, ebp
		test	byte ptr [ebx+14h], 4
		jz	loc_10015CAB
		mov	ecx, [ebx+0F4h]
		cmp	[ecx+10h], eax
		jz	loc_10015CAB
		mov	edi, [esp+0BA8h+var_B8C]
		mov	eax, [esp+0BA8h+var_B90]
		mov	cl, 1
		cmp	edi, 1
		jnb	short loc_10015C1A
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015C28
; ---------------------------------------------------------------------------

loc_10015C1A:				; CODE XREF: sub_10015700+513j
		mov	[eax], cl
		inc	eax
		dec	edi
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], edi
		xor	esi, esi

loc_10015C28:				; CODE XREF: sub_10015700+518j
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ebx+0F4h]
		mov	ecx, [edx+10h]
		mov	ecx, [ecx+44h]
		mov	edx, ecx
		shr	edx, 10h
		mov	byte ptr [esp+0BA8h+var_B88], dl
		mov	edx, ecx
		shr	edx, 8
		mov	byte ptr [esp+0BA8h+var_B88+1],	dl
		cmp	edi, 3
		jnb	short loc_10015C58
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015C73
; ---------------------------------------------------------------------------

loc_10015C58:				; CODE XREF: sub_10015700+551j
		mov	dx, word ptr [esp+0BA8h+var_B88]
		mov	[eax], dx
		mov	[eax+2], cl
		add	eax, 3
		sub	edi, 3
		mov	[esp+0BA8h+var_B90], eax
		mov	[esp+0BA8h+var_B8C], edi
		xor	esi, esi

loc_10015C73:				; CODE XREF: sub_10015700+556j
		test	esi, esi
		jnz	loc_100160D8
		mov	eax, [ebx+0F4h]
		mov	eax, [eax+10h]
		mov	ecx, [eax+40h]
		mov	edi, [eax+44h]
		push	ecx
		lea	esi, [esp+0BACh+var_B94]
		call	sub_10014880
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	loc_100160D8
		mov	ebp, [esp+0BA8h+var_B8C]
		mov	edi, [esp+0BA8h+var_B90]
		jmp	short loc_10015CD5
; ---------------------------------------------------------------------------

loc_10015CAB:				; CODE XREF: sub_10015700+4F1j
					; sub_10015700+500j
		mov	ebp, [esp+0BA8h+var_B8C]
		mov	edi, [esp+0BA8h+var_B90]
		xor	al, al
		cmp	ebp, 1
		jnb	short loc_10015CBF
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015CCD
; ---------------------------------------------------------------------------

loc_10015CBF:				; CODE XREF: sub_10015700+5B8j
		mov	[edi], al
		inc	edi
		dec	ebp
		mov	[esp+0BA8h+var_B90], edi
		mov	[esp+0BA8h+var_B8C], ebp
		xor	esi, esi

loc_10015CCD:				; CODE XREF: sub_10015700+5BDj
		test	esi, esi
		jnz	loc_100160D8

loc_10015CD5:				; CODE XREF: sub_10015700+5A9j
		call	sub_10018130
		mov	edx, eax
		shr	edx, 18h
		mov	byte ptr [esp+0BA8h+var_B98], dl
		mov	ecx, eax
		mov	edx, eax
		shr	ecx, 10h
		shr	edx, 8
		mov	byte ptr [esp+0BA8h+var_B98+1],	cl
		mov	byte ptr [esp+0BA8h+var_B98+2],	dl
		mov	byte ptr [esp+0BA8h+var_B98+3],	al
		cmp	ebp, 4
		jnb	short loc_10015D03
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015D19
; ---------------------------------------------------------------------------

loc_10015D03:				; CODE XREF: sub_10015700+5FCj
		mov	eax, [esp+0BA8h+var_B98]
		mov	[edi], eax
		add	edi, 4
		sub	ebp, 4
		mov	[esp+0BA8h+var_B90], edi
		mov	[esp+0BA8h+var_B8C], ebp
		xor	esi, esi

loc_10015D19:				; CODE XREF: sub_10015700+601j
		test	esi, esi
		jnz	loc_100160D8
		cmp	[esp+0BA8h+var_B64], esi
		jz	loc_10015DAE
		mov	ecx, [esp+0BA8h+var_B2C]
		mov	eax, [ecx]
		cmp	ebp, 1
		jnb	short loc_10015D3B
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015D49
; ---------------------------------------------------------------------------

loc_10015D3B:				; CODE XREF: sub_10015700+634j
		mov	[edi], al
		inc	edi
		dec	ebp
		mov	[esp+0BA8h+var_B90], edi
		mov	[esp+0BA8h+var_B8C], ebp
		xor	esi, esi

loc_10015D49:				; CODE XREF: sub_10015700+639j
		test	esi, esi
		jnz	loc_100160D8
		mov	eax, [ecx+8]
		mov	edx, eax
		shr	edx, 8
		mov	byte ptr [esp+0BA8h+var_B88], dl
		mov	byte ptr [esp+0BA8h+var_B88+1],	al
		cmp	ebp, 2
		jnb	short loc_10015D6B
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015D83
; ---------------------------------------------------------------------------

loc_10015D6B:				; CODE XREF: sub_10015700+664j
		mov	ax, word ptr [esp+0BA8h+var_B88]
		mov	[edi], ax
		add	edi, 2
		sub	ebp, 2
		mov	[esp+0BA8h+var_B90], edi
		mov	[esp+0BA8h+var_B8C], ebp
		xor	esi, esi

loc_10015D83:				; CODE XREF: sub_10015700+669j
		test	esi, esi
		jnz	loc_100160D8
		mov	edx, [ecx+4]
		mov	edi, [ecx+8]
		push	edx
		lea	esi, [esp+0BACh+var_B94]
		call	sub_10014880
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	loc_100160D8
		mov	edi, [esp+0BA8h+var_B90]
		jmp	short loc_10015DC7
; ---------------------------------------------------------------------------

loc_10015DAE:				; CODE XREF: sub_10015700+625j
		or	al, 0FFh
		cmp	ebp, 1
		jnb	short loc_10015DBA
		or	esi, 0FFFFFFFFh
		jmp	short loc_10015DBF
; ---------------------------------------------------------------------------

loc_10015DBA:				; CODE XREF: sub_10015700+6B3j
		mov	[edi], al
		inc	edi
		xor	esi, esi

loc_10015DBF:				; CODE XREF: sub_10015700+6B8j
		test	esi, esi
		jnz	loc_100160D8

loc_10015DC7:				; CODE XREF: sub_10015700+6ACj
		mov	eax, [esp+0BA8h+Val]
		test	eax, eax
		jz	short loc_10015DDA
		push	eax		; Size
		push	eax		; Val
		push	edi		; Dst
		call	memset
		add	esp, 0Ch

loc_10015DDA:				; CODE XREF: sub_10015700+6CDj
		mov	eax, [esp+0BA8h+var_B40]
		push	eax
		lea	ecx, [esp+0BACh+var_B84]
		push	ecx
		push	0
		call	SECITEM_AllocItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10015DFA
		or	esi, 0FFFFFFFFh
		jmp	loc_100160D8
; ---------------------------------------------------------------------------

loc_10015DFA:				; CODE XREF: sub_10015700+6F0j
		mov	ecx, [esp+0BA8h+var_B5C]
		mov	ebp, 8000h
		test	[ebx+14h], ebp
		jz	short loc_10015E63
		mov	eax, [esp+0BA8h+var_B3C]
		push	10h
		push	1
		push	1
		lea	edx, [esp+0BB4h+var_64]
		push	edx
		push	eax
		push	ecx
		lea	edx, [esp+0BC0h+var_884]
		push	edx
		call	sub_10022950
		mov	esi, eax
		add	esp, 1Ch
		test	esi, esi
		jnz	loc_100160D8
		mov	eax, [esp+0BA8h+var_B70]
		mov	ecx, [esp+0BA8h+var_B74]
		mov	edx, [esp+0BA8h+var_B7C]
		push	eax
		push	ecx
		mov	ecx, [esp+0BB0h+var_B80]
		push	edx
		lea	eax, [esp+0BB4h+var_B7C]
		push	eax
		push	ecx
		lea	edx, [esp+0BBCh+var_884]
		push	edx
		call	sub_100225A0
		add	esp, 18h
		mov	esi, eax
		jmp	short loc_10015EBA
; ---------------------------------------------------------------------------

loc_10015E63:				; CODE XREF: sub_10015700+706j
		lea	eax, [esp+0BA8h+var_B28]
		push	eax
		push	ecx
		push	104h
		push	1082h
		call	PK11_CreateContextBySymKey
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	loc_100160D8
		mov	edx, [esp+0BA8h+var_B70]
		mov	eax, [esp+0BA8h+var_B74]
		mov	ecx, [esp+0BA8h+var_B7C]
		push	edx
		push	eax
		mov	eax, [esp+0BB0h+var_B80]
		push	ecx
		lea	edx, [esp+0BB4h+var_B7C]
		push	edx
		push	eax
		push	edi
		call	PK11_CipherOp
		push	edi
		mov	esi, eax
		call	PK11_Finalize
		push	1
		push	edi
		call	PK11_DestroyContext
		add	esp, 24h

loc_10015EBA:				; CODE XREF: sub_10015700+761j
		test	esi, esi
		jnz	loc_100160D8
		mov	eax, [esp+0BA8h+var_B7C]
		mov	ecx, eax
		shr	ecx, 8
		mov	[esp+0BA8h+var_B60], cl
		mov	[esp+0BA8h+var_B5F], al
		test	[ebx+14h], ebp
		jz	loc_10015F91
		push	4
		call	sub_10022B60
		mov	edx, [esp+0BACh+var_B44]
		mov	ecx, [esp+0BACh+var_B68]
		push	esi
		push	edx
		push	ecx
		push	eax
		lea	edx, [esp+0BBCh+var_A14]
		push	edx
		call	sub_10022BD0
		add	esp, 18h
		test	eax, eax
		jnz	loc_100160D8
		lea	eax, [esp+0BA8h+var_A14]
		push	eax
		call	sub_10022C10
		push	10h
		lea	ecx, [esp+0BB0h+var_A14]
		push	offset dword_100377A0
		push	ecx
		call	sub_10022C40
		push	10h
		lea	edx, [esp+0BBCh+var_64]
		push	edx
		lea	eax, [esp+0BC0h+var_A14]
		push	eax
		call	sub_10022C40
		push	2
		lea	ecx, [esp+0BC8h+var_B60]
		push	ecx
		lea	edx, [esp+0BCCh+var_A14]
		push	edx
		call	sub_10022C40
		mov	eax, [esp+0BD0h+var_B7C]
		mov	ecx, [esp+0BD0h+var_B80]
		push	eax
		push	ecx
		lea	edx, [esp+0BD8h+var_A14]
		push	edx
		call	sub_10022C40
		push	20h
		lea	eax, [esp+0BE0h+Size]
		push	eax
		lea	ecx, [esp+0BE4h+var_54]
		push	ecx
		lea	edx, [esp+0BE8h+var_A14]
		push	edx
		call	sub_10022C70
		add	esp, 44h
		jmp	loc_10016031
; ---------------------------------------------------------------------------

loc_10015F91:				; CODE XREF: sub_10015700+7D6j
		mov	ecx, [esp+0BA8h+var_B68]
		lea	eax, [esp+0BA8h+var_B50]
		push	eax
		push	ecx
		xor	ebp, ebp
		push	108h
		push	251h
		mov	[esp+0BB8h+var_B4C], ebp
		mov	[esp+0BB8h+var_B48], ebp
		call	PK11_CreateContextBySymKey
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebp
		jz	loc_100160D8
		push	edi
		call	PK11_DigestBegin
		push	10h
		push	offset dword_100377A0
		push	edi
		call	PK11_DigestOp
		push	10h
		lea	edx, [esp+0BBCh+var_64]
		push	edx
		push	edi
		call	PK11_DigestOp
		push	2
		lea	eax, [esp+0BC8h+var_B60]
		push	eax
		push	edi
		call	PK11_DigestOp
		mov	ecx, [esp+0BD0h+var_B7C]
		mov	edx, [esp+0BD0h+var_B80]
		push	ecx
		push	edx
		push	edi
		call	PK11_DigestOp
		push	20h
		lea	eax, [esp+0BE0h+Size]
		push	eax
		lea	ecx, [esp+0BE4h+var_54]
		push	ecx
		push	edi
		call	PK11_DigestFinal
		add	esp, 44h
		push	1
		push	edi
		mov	esi, eax
		call	PK11_DestroyContext
		add	esp, 8
		cmp	esi, ebp
		jnz	loc_100160D8

loc_10016031:				; CODE XREF: sub_10015700+88Cj
		mov	edi, [esp+0BA8h+var_B38]
		push	edi		; int
		push	4		; char
		push	ebx		; Src
		call	sub_10008FF0
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_100160D8
		push	4		; Src
		push	2A300h		; int
		push	ebx		; int
		call	sub_10008F10
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_100160D8
		push	2		; Src
		add	edi, 0FFFFFFFAh
		push	edi		; int
		push	ebx		; int
		call	sub_10008F10
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_100160D8
		push	10h		; Size
		push	offset dword_100377A0 ;	Src
		push	ebx		; int
		call	sub_10008E00
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_100160D8
		push	10h		; Size
		lea	edx, [esp+0BACh+var_64]
		push	edx		; Src
		push	ebx		; int
		call	sub_10008E00
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_100160D8
		mov	eax, [esp+0BA8h+var_B7C]
		mov	ecx, [esp+0BA8h+var_B80]
		push	2		; Src
		push	eax		; Size
		push	ecx		; void *
		push	ebx		; int
		call	sub_10008F70
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_100160D8
		mov	edx, [esp+0BA8h+Size]
		push	edx		; Size
		lea	eax, [esp+0BACh+var_54]
		push	eax		; Src
		push	ebx		; int
		call	sub_10008E00
		add	esp, 0Ch
		mov	esi, eax

loc_100160D8:				; CODE XREF: sub_10015700+186j
					; sub_10015700+198j ...
		pop	ebx

loc_100160D9:				; CODE XREF: sub_10015700+91j
					; sub_10015700+C0j ...
		cmp	[esp+0BA4h+var_B74], 0
		jz	short loc_100160EF
		lea	ecx, [esp+0BA4h+var_B78]
		push	0
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_100160EF:				; CODE XREF: sub_10015700+9DEj
		cmp	[esp+0BA4h+var_B80], 0
		jz	short loc_10016105
		lea	edx, [esp+0BA4h+var_B84]
		push	0
		push	edx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10016105:				; CODE XREF: sub_10015700+9F4j
		mov	ecx, [esp+0BA4h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B98h
		retn
sub_10015700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016120	proc near		; CODE XREF: sub_10016CD0+CBp
		cmp	dword ptr [eax+8], 10h
		push	edi
		lea	edi, [eax+8]
		jb	short loc_10016178
		push	esi
		lea	esi, [eax+4]
		mov	eax, [esi]
		mov	[ebx], eax
		add	dword ptr [edi], 0FFFFFFF0h
		add	dword ptr [esi], 10h
		mov	ecx, [edi]
		mov	eax, [esi]
		cmp	ecx, 10h
		jb	short loc_1001617D
		push	edi
		push	esi
		push	2
		lea	ecx, [ebx+8]
		push	ecx
		mov	[ebx+4], eax
		add	dword ptr [esi], 10h
		add	dword ptr [edi], 0FFFFFFF0h
		push	edx
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001617D
		cmp	dword ptr [edi], 20h
		jb	short loc_1001617D
		mov	eax, [esi]
		mov	[ebx+14h], eax
		add	dword ptr [edi], 0FFFFFFE0h
		add	dword ptr [esi], 20h
		mov	eax, [edi]
		neg	eax
		pop	esi
		sbb	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10016178:				; CODE XREF: sub_10016120+8j
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001617D:				; CODE XREF: sub_10016120+1Fj
					; sub_10016120+3Dj ...
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_10016120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016190	proc near		; CODE XREF: sub_1000A6D0+35Bp
					; sub_1000D820+2F7p ...

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		cmp	dword ptr [esi+4Ch], 0
		push	edi
		jz	short loc_100161AB
		mov	[esp+1Ch+arg_0], offset	dword_1002E7E0
		jmp	short loc_100161C6
; ---------------------------------------------------------------------------

loc_100161AB:				; CODE XREF: sub_10016190+Fj
		mov	eax, 300h
		mov	[esp+1Ch+arg_0], offset	dword_1002E840
		cmp	[esi+44h], ax
		ja	short loc_100161C6
		mov	[esp+1Ch+arg_0], offset	dword_1002E880

loc_100161C6:				; CODE XREF: sub_10016190+19j
					; sub_10016190+2Cj
		mov	ebx, [esp+1Ch+arg_8]
		cmp	dword ptr [ebx], 0
		jz	loc_1001628F
		mov	ebp, [esp+1Ch+arg_4]

loc_100161D7:				; CODE XREF: sub_10016190+F9j
		push	ebx
		push	ebp
		push	2
		push	esi
		call	sub_100091C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		js	short loc_1001622D
		push	ebx
		push	ebp
		push	2
		lea	ecx, [esp+28h+var_C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10016291
		cmp	[esi+4Ch], eax
		jnz	short loc_10016238
		movzx	edx, word ptr [esi+2EF4h]
		test	edx, edx
		jz	short loc_1001622D
		lea	ecx, [esi+2EF8h]
		lea	ebx, [ebx+0]

loc_10016220:				; CODE XREF: sub_10016190+9Bj
		cmp	di, [ecx]
		jz	short loc_10016238
		inc	eax
		add	ecx, 2
		cmp	eax, edx
		jb	short loc_10016220

loc_1001622D:				; CODE XREF: sub_10016190+58j
					; sub_10016190+82j ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10016238:				; CODE XREF: sub_10016190+77j
					; sub_10016190+93j
		movzx	edx, word ptr [esi+2EF6h]
		xor	eax, eax
		test	edx, edx
		jz	short loc_1001625D
		lea	ecx, [esi+2F0Eh]
		jmp	short loc_10016250
; ---------------------------------------------------------------------------
		align 10h

loc_10016250:				; CODE XREF: sub_10016190+BBj
					; sub_10016190+CBj
		cmp	di, [ecx]
		jz	short loc_1001622D
		inc	eax
		add	ecx, 2
		cmp	eax, edx
		jb	short loc_10016250

loc_1001625D:				; CODE XREF: sub_10016190+B3j
		mov	ecx, [esp+1Ch+arg_0]
		mov	eax, [ecx]
		test	eax, eax
		js	short loc_10016286

loc_10016267:				; CODE XREF: sub_10016190+E3j
		cmp	eax, edi
		jz	short loc_10016277
		mov	eax, [ecx+8]
		add	ecx, 8
		test	eax, eax
		jns	short loc_10016267
		jmp	short loc_10016286
; ---------------------------------------------------------------------------

loc_10016277:				; CODE XREF: sub_10016190+D9j
		mov	eax, [ecx+4]
		lea	edx, [esp+1Ch+var_C]
		push	edx
		push	edi
		push	esi
		call	eax
		add	esp, 0Ch

loc_10016286:				; CODE XREF: sub_10016190+D5j
					; sub_10016190+E5j
		cmp	dword ptr [ebx], 0
		jnz	loc_100161D7

loc_1001628F:				; CODE XREF: sub_10016190+3Dj
		xor	eax, eax

loc_10016291:				; CODE XREF: sub_10016190+6Ej
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10016190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100162A0	proc near		; CODE XREF: sub_1000D820+47Dp
					; sub_1000D820+E18p ...

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	dx, [esp+arg_4]
		add	eax, 2E9Ch
		xor	ecx, ecx
		push	esi

loc_100162B1:				; CODE XREF: sub_100162A0+25j
		cmp	dword ptr [eax+4], 0
		jz	short loc_100162D9
		movzx	esi, dx
		cmp	[eax], esi
		jz	short loc_100162C7
		inc	ecx
		add	eax, 8
		cmp	ecx, 0Bh
		jl	short loc_100162B1

loc_100162C7:				; CODE XREF: sub_100162A0+1Cj
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100162D9:				; CODE XREF: sub_100162A0+15j
		movzx	ecx, dx
		mov	edx, [esp+4+arg_8]
		mov	[eax], ecx
		mov	[eax+4], edx
		xor	eax, eax
		pop	esi
		retn
sub_100162A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100162F0	proc near		; CODE XREF: sub_10009320+361p
					; sub_10009320+85Ep ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, [esp+4+arg_C]
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		mov	[esp+14h+var_4], edi
		cmp	eax, edi
		jnz	short loc_1001631C
		mov	ecx, [esp+14h+arg_0]
		mov	eax, 300h
		cmp	[ecx+44h], ax
		mov	eax, offset dword_1002E890
		ja	short loc_1001631C
		mov	eax, offset dword_1002E8E8

loc_1001631C:				; CODE XREF: sub_100162F0+11j
					; sub_100162F0+25j
		mov	ebp, [esp+14h+arg_4]
		mov	esi, [esp+14h+arg_8]
		lea	ebx, [eax+4]

loc_10016327:				; CODE XREF: sub_100162F0+5Aj
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_10016343
		mov	edx, [esp+14h+arg_0]
		push	esi
		push	ebp
		push	edx
		call	eax
		add	esp, 0Ch
		test	eax, eax
		js	short loc_10016356
		sub	esi, eax
		add	[esp+14h+var_4], eax

loc_10016343:				; CODE XREF: sub_100162F0+3Bj
		inc	edi
		add	ebx, 8
		cmp	edi, 0Bh
		jl	short loc_10016327
		mov	eax, [esp+14h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10016356:				; CODE XREF: sub_100162F0+4Bj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
sub_100162F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016360	proc near		; DATA XREF: sub_10016460+74o
					; .rdata:1002E89Co ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	loc_10016411
		cmp	dword ptr [esi+844h], 0
		jnz	loc_10016411
		cmp	dword ptr [esi+24h], 0
		push	edi
		jnz	short loc_10016385
		xor	edi, edi
		jmp	short loc_10016394
; ---------------------------------------------------------------------------

loc_10016385:				; CODE XREF: sub_10016360+1Fj
		cmp	dword ptr [esi+4Ch], 0
		movzx	edi, word ptr [esi+86Ch]
		jz	short loc_10016394
		add	edi, edi

loc_10016394:				; CODE XREF: sub_10016360+23j
					; sub_10016360+30j
		cmp	[esp+8+arg_4], 0
		push	ebx
		lea	ebx, [edi+5]
		jz	short loc_1001640B
		cmp	[esp+0Ch+arg_8], ebx
		jb	short loc_1001640B
		push	2		; Src
		push	0FF01h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100163E3
		push	2		; Src
		lea	eax, [edi+1]
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100163E3
		push	1		; Src
		push	edi		; Size
		lea	ecx, [esi+86Eh]
		push	ecx		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jz	short loc_100163EA

loc_100163E3:				; CODE XREF: sub_10016360+57j
					; sub_10016360+6Aj
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100163EA:				; CODE XREF: sub_10016360+81j
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_1001640B
		movzx	edx, word ptr [esi+2EF4h]
		mov	eax, 0FF01h
		mov	[esi+edx*2+2EF8h], ax
		inc	word ptr [esi+2EF4h]

loc_1001640B:				; CODE XREF: sub_10016360+3Dj
					; sub_10016360+43j ...
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016411:				; CODE XREF: sub_10016360+7j
					; sub_10016360+14j
		xor	eax, eax
		pop	esi
		retn
sub_10016360	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016420	proc near		; DATA XREF: .rdata:1002E824o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		movzx	edx, word ptr [eax+2EF6h]
		mov	ecx, [esp+arg_4]
		mov	[eax+edx*2+2F0Eh], cx
		inc	word ptr [eax+2EF6h]
		mov	[esp+arg_8], offset loc_100155E0
		mov	[esp+arg_4], ecx
		mov	[esp+arg_0], eax
		jmp	sub_100162A0
sub_10016420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016460	proc near		; DATA XREF: .rdata:1002E804o
					; .rdata:1002E854o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	eax, eax
		xor	edi, edi
		cmp	[esi+24h], eax
		jz	short loc_1001647D
		cmp	[esi+4Ch], eax
		movzx	eax, word ptr [esi+86Ch]
		jnz	short loc_1001647D
		add	eax, eax

loc_1001647D:				; CODE XREF: sub_10016460+Dj
					; sub_10016460+19j
		mov	ecx, [esp+8+arg_8]
		lea	edx, [eax+1]
		cmp	[ecx+8], edx
		jnz	short loc_100164EA
		mov	ecx, [ecx+4]
		movzx	edx, byte ptr [ecx]
		cmp	edx, eax
		jnz	short loc_100164EA
		test	eax, eax
		jz	short loc_100164AD
		push	eax
		inc	ecx
		push	ecx
		lea	eax, [esi+86Eh]
		push	eax
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100164EA

loc_100164AD:				; CODE XREF: sub_10016460+35j
		movzx	edx, word ptr [esi+2EF6h]
		mov	eax, [esp+8+arg_4]
		mov	ecx, 1
		mov	[esi+40h], ecx
		mov	[esi+edx*2+2F0Eh], ax
		add	[esi+2EF6h], cx
		cmp	[esi+4Ch], edi
		jz	short loc_100164E5
		push	offset sub_10016360
		push	eax
		push	esi
		call	sub_100162A0
		add	esp, 0Ch
		mov	edi, eax

loc_100164E5:				; CODE XREF: sub_10016460+72j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100164EA:				; CODE XREF: sub_10016460+27j
					; sub_10016460+31j ...
		push	28h
		push	2
		push	esi
		call	sub_10008960
		push	0FFFFD057h
		call	PORT_SetError_Util
		add	esp, 10h
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10016460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016510	proc near		; DATA XREF: sub_10016680+1F5o
					; .rdata:1002E8CCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_1001651D

loc_10016519:				; CODE XREF: sub_10016510+1Ej
					; sub_10016510+2Aj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001651D:				; CODE XREF: sub_10016510+7j
		cmp	dword ptr [esi+4Ch], 0
		jnz	loc_10016604
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_10016519
		movzx	eax, word ptr [esi+2E92h]
		test	ax, ax
		jz	short loc_10016519
		cmp	[esp+4+arg_4], 0
		push	ebx
		mov	ebx, eax
		lea	ebx, [ebx+ebx+3]
		jz	loc_100165FE
		lea	eax, [ebx+4]
		cmp	[esp+8+arg_8], eax
		jb	loc_100165FE
		push	2		; Src
		push	0Eh		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016595
		push	2		; Src
		push	ebx		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016595
		movzx	ecx, word ptr [esi+2E92h]
		push	2		; Src
		add	ecx, ecx
		push	ecx		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001659B

loc_10016595:				; CODE XREF: sub_10016510+5Aj
					; sub_10016510+6Aj
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001659B:				; CODE XREF: sub_10016510+83j
		push	edi
		xor	edx, edx
		xor	edi, edi
		cmp	dx, [esi+2E92h]
		jnb	short loc_100165D3
		xor	eax, eax
		jmp	short loc_100165B0
; ---------------------------------------------------------------------------
		align 10h

loc_100165B0:				; CODE XREF: sub_10016510+9Bj
					; sub_10016510+C1j
		movzx	eax, word ptr [esi+eax*2+2E8Ah]
		push	2		; Src
		push	eax		; int
		push	esi		; int
		call	sub_10008F10
		movzx	ecx, word ptr [esi+2E92h]
		inc	edi
		movsx	eax, di
		add	esp, 0Ch
		cmp	eax, ecx
		jl	short loc_100165B0

loc_100165D3:				; CODE XREF: sub_10016510+97j
		push	1		; Src
		push	0		; Size
		push	0		; void *
		push	esi		; int
		call	sub_10008F70
		movzx	edx, word ptr [esi+2EF4h]
		add	esp, 10h
		mov	eax, 0Eh
		mov	[esi+edx*2+2EF8h], ax
		inc	word ptr [esi+2EF4h]
		pop	edi

loc_100165FE:				; CODE XREF: sub_10016510+38j
					; sub_10016510+45j
		lea	eax, [ebx+4]
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016604:				; CODE XREF: sub_10016510+11j
		cmp	[esp+4+arg_4], 0
		jz	short loc_1001666E
		cmp	[esp+4+arg_8], 9
		jb	short loc_1001666E
		push	2		; Src
		push	0Eh		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10016628

loc_10016623:				; CODE XREF: sub_10016510+127j
					; sub_10016510+138j ...
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016628:				; CODE XREF: sub_10016510+111j
		push	2		; Src
		push	5		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016623
		push	2		; Src
		push	2		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016623
		movzx	ecx, word ptr [esi+2E94h]
		push	2		; Src
		push	ecx		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016623
		push	1		; Src
		push	eax		; Size
		push	eax		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h

loc_1001666E:				; CODE XREF: sub_10016510+F9j
					; sub_10016510+100j
		mov	eax, 9
		pop	esi
		retn
sub_10016510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016680	proc near		; DATA XREF: .rdata:1002E81Co
					; .rdata:1002E86Co

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		sub	esp, 20h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_0]
		push	edi
		xor	edi, edi
		xor	ebx, ebx
		mov	[esp+30h+var_18], edi
		mov	[esp+30h+var_14], edi
		mov	[esp+30h+var_10], edi
		mov	[esp+30h+var_20], edi
		cmp	[esi+4Ch], edi
		jnz	loc_1001676E
		mov	ebx, [esp+30h+arg_8]
		cmp	[ebx+4], edi
		lea	ebp, [ebx+4]
		jz	short loc_10016717
		add	ebx, 8
		cmp	[ebx], edi
		jz	short loc_10016717
		push	ebx
		push	ebp
		push	2
		lea	eax, [esp+3Ch+var_18]
		push	eax
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10016717
		cmp	[esp+30h+var_10], 2
		jnz	short loc_10016717
		mov	eax, [esp+30h+var_14]
		movzx	ecx, byte ptr [eax]
		movzx	edx, byte ptr [eax+1]
		shl	cx, 8
		or	cx, dx
		movzx	edi, cx
		xor	ecx, ecx
		xor	eax, eax
		cmp	cx, [esi+2E92h]
		jnb	short loc_10016717
		lea	ebx, [ebx+0]

loc_10016700:				; CODE XREF: sub_10016680+95j
		movzx	edx, ax
		cmp	di, [esi+edx*2+2E8Ah]
		jz	short loc_10016722
		inc	eax
		cmp	ax, [esi+2E92h]
		jb	short loc_10016700

loc_10016717:				; CODE XREF: sub_10016680+32j
					; sub_10016680+39j ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10016722:				; CODE XREF: sub_10016680+8Bj
		push	ebx
		push	ebp
		push	1
		lea	eax, [esp+3Ch+var_C]
		push	eax
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10016717
		cmp	[esp+30h+var_4], eax
		jnz	short loc_10016717
		cmp	[ebx], eax
		jnz	short loc_10016717
		movzx	ecx, word ptr [esi+2EF6h]
		mov	edx, 0Eh
		mov	[esi+ecx*2+2F0Eh], dx
		inc	word ptr [esi+2EF6h]
		mov	[esi+2E94h], di

loc_10016764:				; CODE XREF: sub_10016680+F5j
					; sub_10016680+FEj ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1001676E:				; CODE XREF: sub_10016680+22j
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_10016764
		cmp	[esi+2E92h], di
		jz	short loc_10016764
		mov	eax, [esp+30h+arg_8]
		lea	ecx, [eax+4]
		mov	[esp+30h+var_1C], ecx
		cmp	[ecx], edi
		jz	short loc_10016717
		add	eax, 8
		cmp	dword ptr [eax], 5
		mov	[esp+30h+arg_0], eax
		jb	loc_10016717
		push	eax
		push	ecx
		push	2
		lea	eax, [esp+3Ch+var_18]
		push	eax
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10016717
		test	byte ptr [esp+30h+var_10], 1
		jnz	loc_10016717
		xor	ebp, ebp
		jmp	short loc_100167D0
; ---------------------------------------------------------------------------
		align 10h

loc_100167D0:				; CODE XREF: sub_10016680+146j
					; sub_10016680+1B4j
		movzx	eax, word ptr [esi+2E92h]
		cmp	bp, ax
		jnb	short loc_10016836
		mov	ecx, 1
		cmp	[esp+30h+var_10], ecx
		jbe	short loc_10016831
		mov	eax, [esp+30h+var_14]
		movzx	edx, bp
		movzx	edi, word ptr [esi+edx*2+2E8Ah]
		inc	eax
		jmp	short loc_10016800
; ---------------------------------------------------------------------------
		align 10h

loc_10016800:				; CODE XREF: sub_10016680+177j
					; sub_10016680+1A0j
		movzx	edx, byte ptr [eax-1]
		movzx	ebx, byte ptr [eax]
		shl	dx, 8
		or	dx, bx
		movzx	ebx, dx
		cmp	bx, di
		jz	short loc_10016828
		add	ecx, 2
		add	eax, 2
		cmp	ecx, [esp+30h+var_10]
		jb	short loc_10016800
		mov	edi, [esp+30h+var_20]
		jmp	short loc_10016831
; ---------------------------------------------------------------------------

loc_10016828:				; CODE XREF: sub_10016680+194j
		mov	edi, 1
		mov	[esp+30h+var_20], edi

loc_10016831:				; CODE XREF: sub_10016680+165j
					; sub_10016680+1A6j
		inc	ebp
		test	edi, edi
		jz	short loc_100167D0

loc_10016836:				; CODE XREF: sub_10016680+15Aj
		mov	ebp, [esp+30h+arg_0]
		mov	eax, [esp+30h+var_1C]
		push	ebp
		push	eax
		push	1
		lea	ecx, [esp+3Ch+var_C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10016717
		cmp	[ebp+0], eax
		jnz	loc_10016717
		test	edi, edi
		jz	loc_10016764
		movzx	edx, word ptr [esi+2EF6h]
		mov	eax, 0Eh
		push	offset sub_10016510
		push	eax
		mov	[esi+2E94h], bx
		mov	[esi+edx*2+2F0Eh], ax
		inc	word ptr [esi+2EF6h]
		push	esi
		call	sub_100162A0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10016680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100168B0	proc near		; DATA XREF: .rdata:1002E82Co

var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		mov	eax, 303h
		cmp	[esi+44h], ax
		jnb	short loc_100168CA
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100168CA:				; CODE XREF: sub_100168B0+11j
		mov	eax, [esp+10h+arg_8]
		movzx	ecx, word ptr [esi+2EF6h]
		mov	dx, [esp+10h+arg_4]
		push	edi
		lea	edi, [eax+8]
		push	edi
		add	eax, 4
		push	eax
		push	2
		lea	eax, [esp+20h+var_C]
		push	eax
		mov	[esi+ecx*2+2F0Eh], dx
		inc	word ptr [esi+2EF6h]
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jz	short loc_1001690F
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001690F:				; CODE XREF: sub_100168B0+54j
		push	ebx
		push	ebp
		xor	ebp, ebp
		cmp	[edi], ebp
		jnz	loc_100169DD
		mov	ebx, [esp+1Ch+var_4]
		cmp	ebx, ebp
		jz	loc_100169DD
		test	bl, 1
		jnz	loc_100169DD
		shr	ebx, 1
		mov	[esp+1Ch+arg_0], ebx
		cmp	ebx, 200h
		jbe	short loc_1001694A
		mov	[esp+1Ch+arg_0], 200h
		mov	ebx, [esp+1Ch+arg_0]

loc_1001694A:				; CODE XREF: sub_100168B0+8Cj
		lea	ecx, ds:0[ebx*8]
		push	ecx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esi+8CCh], eax
		cmp	eax, ebp
		jz	loc_100169EA
		mov	edi, [esp+1Ch+var_8]
		mov	[esi+8D0h], ebp
		cmp	ebx, ebp
		jbe	short loc_100169B1

loc_10016976:				; CODE XREF: sub_100168B0+FFj
		mov	al, [edi]
		mov	bl, [edi+1]
		movzx	edx, al
		push	edx
		add	edi, 2
		call	sub_100055A0
		add	esp, 4
		test	eax, eax
		jz	short loc_100169AA
		mov	ecx, [esi+8CCh]
		mov	[ecx+ebp*8], eax
		mov	eax, [esi+8CCh]
		movzx	edx, bl
		mov	[eax+ebp*8+4], edx
		inc	dword ptr [esi+8D0h]

loc_100169AA:				; CODE XREF: sub_100168B0+DCj
		inc	ebp
		cmp	ebp, [esp+1Ch+arg_0]
		jb	short loc_10016976

loc_100169B1:				; CODE XREF: sub_100168B0+C4j
		cmp	dword ptr [esi+8D0h], 0
		jnz	short loc_100169D3
		mov	ecx, [esi+8CCh]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4
		mov	dword ptr [esi+8CCh], 0

loc_100169D3:				; CODE XREF: sub_100168B0+108j
		pop	ebp
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100169DD:				; CODE XREF: sub_100168B0+65j
					; sub_100168B0+71j ...
		push	0FFFFD01Ch
		call	PORT_SetError_Util
		add	esp, 4

loc_100169EA:				; CODE XREF: sub_100168B0+B2j
		pop	ebp
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
sub_100168B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016A00	proc near		; DATA XREF: .rdata:1002E8DCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, 303h
		cmp	[esi+44h], ax
		jnb	short loc_10016A14

loc_10016A10:				; CODE XREF: sub_10016A00+20j
					; sub_10016A00+84j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016A14:				; CODE XREF: sub_10016A00+Ej
		cmp	[esp+4+arg_4], 0
		jz	short loc_10016A7F
		cmp	[esp+4+arg_8], 16h
		jb	short loc_10016A10
		push	2		; Src
		push	0Dh		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016A5A
		push	2		; Src
		push	12h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016A5A
		push	2		; Src
		push	10h		; Size
		push	offset dword_1002E940 ;	void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jz	short loc_10016A5F

loc_10016A5A:				; CODE XREF: sub_10016A00+31j
					; sub_10016A00+42j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016A5F:				; CODE XREF: sub_10016A00+58j
		movzx	ecx, word ptr [esi+2EF4h]
		mov	edx, 0Dh
		mov	[esi+ecx*2+2EF8h], dx
		inc	word ptr [esi+2EF4h]
		lea	eax, [edx+9]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016A7F:				; CODE XREF: sub_10016A00+19j
		cmp	[esp+4+arg_8], 16h
		jb	short loc_10016A10
		mov	eax, 16h
		pop	esi
		retn
sub_10016A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016A90	proc near		; CODE XREF: sub_10009320+4BBp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		add	ecx, 4
		lea	eax, [ecx-100h]
		cmp	eax, 0FFh
		ja	short loc_10016AB6
		mov	eax, 200h
		sub	eax, ecx
		cmp	eax, 4
		jnb	short locret_10016AB8
		mov	eax, 4
		retn
; ---------------------------------------------------------------------------

loc_10016AB6:				; CODE XREF: sub_10016A90+12j
		xor	eax, eax

locret_10016AB8:			; CODE XREF: sub_10016A90+1Ej
		retn
sub_10016A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016AC0	proc near		; CODE XREF: sub_10009320+8A8p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	edi
		lea	edi, [ebx-4]
		test	ebx, ebx
		jnz	short loc_10016AD2
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016AD2:				; CODE XREF: sub_10016AC0+Bj
		cmp	ebx, 4
		jb	short loc_10016B2B
		cmp	ebx, [esp+8+arg_8]
		ja	short loc_10016B2B
		cmp	edi, 100h
		ja	short loc_10016B2B
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	2		; Src
		push	15h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016B1E
		push	2		; Src
		push	edi		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016B1E
		push	edi		; Size
		push	offset dword_10037680 ;	Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10016B25

loc_10016B1E:				; CODE XREF: sub_10016AC0+39j
					; sub_10016AC0+49j
		pop	esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016B25:				; CODE XREF: sub_10016AC0+5Cj
		pop	esi
		pop	edi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016B2B:				; CODE XREF: sub_10016AC0+15j
					; sub_10016AC0+1Bj ...
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_10016AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016B40	proc near		; DATA XREF: .rdata:1002E8E4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, 304h
		cmp	[esi+44h], ax
		jz	short loc_10016B54

loc_10016B50:				; CODE XREF: sub_10016B40+20j
					; sub_10016B40+84j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016B54:				; CODE XREF: sub_10016B40+Ej
		cmp	[esp+4+arg_4], 0
		jz	short loc_10016BBF
		cmp	[esp+4+arg_8], 6
		jb	short loc_10016B50
		push	2		; Src
		push	0FF02h		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016B98
		push	2		; Src
		push	2		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10016B98
		push	2		; Src
		push	3		; int
		push	esi		; int
		call	sub_10008F10
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10016B9D

loc_10016B98:				; CODE XREF: sub_10016B40+34j
					; sub_10016B40+45j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016B9D:				; CODE XREF: sub_10016B40+56j
		movzx	ecx, word ptr [esi+2EF4h]
		mov	edx, 0FF02h
		mov	[esi+ecx*2+2EF8h], dx
		inc	word ptr [esi+2EF4h]
		mov	eax, 6
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10016BBF:				; CODE XREF: sub_10016B40+19j
		cmp	[esp+4+arg_8], 6
		jb	short loc_10016B50
		mov	eax, 6
		pop	esi
		retn
sub_10016B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016BD0	proc near		; DATA XREF: .rdata:1002E834o

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, 304h
		cmp	[esi+44h], ax
		jnz	short loc_10016C2A
		mov	ecx, [esp+4+arg_8]
		cmp	dword ptr [ecx+8], 2
		lea	eax, [ecx+8]
		jnz	short loc_10016C21
		push	eax
		add	ecx, 4
		push	ecx
		push	2
		push	esi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	short loc_10016C21
		movzx	ecx, word ptr [esi+2EF6h]
		mov	dx, [esp+4+arg_4]
		mov	[esi+ecx*2+2F0Eh], dx
		inc	word ptr [esi+2EF6h]
		cmp	eax, 3
		jz	short loc_10016C2A

loc_10016C21:				; CODE XREF: sub_10016BD0+1Bj
					; sub_10016BD0+2Fj
		mov	eax, 303h
		mov	[esi+44h], ax

loc_10016C2A:				; CODE XREF: sub_10016BD0+Ej
					; sub_10016BD0+4Fj
		xor	eax, eax
		pop	esi
		retn
sub_10016BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016C30	proc near		; DATA XREF: .rdata:1002E814o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		cmp	dword ptr [esi+24h], 0
		push	edi
		jnz	short loc_10016CAF
		mov	ebx, [esp+0Ch+arg_8]
		cmp	dword ptr [ebx+8], 0
		lea	edi, [ebx+8]
		jz	short loc_10016CAF
		push	edi
		lea	eax, [ebx+4]
		push	eax
		push	2
		push	esi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	short loc_10016CBC
		cmp	eax, [edi]
		jz	short loc_10016C6F
		push	esi
		call	sub_10008BD0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016C6F:				; CODE XREF: sub_10016C30+30j
		cmp	dword ptr [esi+230h], 0
		jnz	short loc_10016C7E

loc_10016C78:				; CODE XREF: sub_10016C30+6Aj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016C7E:				; CODE XREF: sub_10016C30+46j
		mov	edi, [esp+0Ch+arg_4]
		push	edi
		mov	ecx, ebx
		mov	edx, esi
		call	sub_10015050
		add	esp, 4
		test	eax, eax
		jnz	short loc_10016CBF
		cmp	dword ptr [esi+2E84h], 1
		jnz	short loc_10016C78
		push	offset loc_10015520
		push	edi
		push	esi
		call	sub_100162A0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016CAF:				; CODE XREF: sub_10016C30+Bj
					; sub_10016C30+18j
		push	0FFFFD074h
		call	PORT_SetError_Util
		add	esp, 4

loc_10016CBC:				; CODE XREF: sub_10016C30+2Cj
		or	eax, 0FFFFFFFFh

loc_10016CBF:				; CODE XREF: sub_10016C30+61j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10016C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016CD0	proc near		; DATA XREF: .rdata:1002E7FCo

var_A34		= dword	ptr -0A34h
Src		= dword	ptr -0A30h
var_A2C		= dword	ptr -0A2Ch
var_A28		= dword	ptr -0A28h
var_A24		= dword	ptr -0A24h
var_A20		= dword	ptr -0A20h
var_A1C		= dword	ptr -0A1Ch
var_A18		= byte ptr -0A18h
var_A14		= dword	ptr -0A14h
var_A10		= dword	ptr -0A10h
var_A08		= dword	ptr -0A08h
var_A04		= dword	ptr -0A04h
var_A00		= dword	ptr -0A00h
var_9FC		= dword	ptr -9FCh
var_9F4		= dword	ptr -9F4h
var_9F0		= dword	ptr -9F0h
var_9EC		= dword	ptr -9ECh
var_9E8		= byte ptr -9E8h
var_9E4		= byte ptr -9E4h
var_9E0		= byte ptr -9E0h
var_9D4		= byte ptr -9D4h
var_844		= byte ptr -844h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0A34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0A34h+var_4], eax
		push	ebp
		mov	ebp, [esp+0A38h+arg_8]
		push	esi
		push	edi
		mov	edi, [esp+0A40h+arg_0]
		xor	esi, esi
		test	dword ptr [edi+14h], 20000h
		mov	[esp+0A40h+var_A28], esi
		mov	[esp+0A40h+var_A20], esi
		jnz	short loc_10016D22
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+0A34h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A34h
		retn
; ---------------------------------------------------------------------------

loc_10016D22:				; CODE XREF: sub_10016CD0+36j
		movzx	eax, word ptr [edi+2EF6h]
		mov	cx, [esp+0A40h+arg_4]
		mov	[edi+eax*2+2F0Eh], cx
		mov	eax, 1
		add	[edi+2EF6h], ax
		push	ebx
		cmp	[ebp+8], esi
		jnz	short loc_10016D56
		mov	[edi+2F28h], eax
		jmp	loc_10016E9D
; ---------------------------------------------------------------------------

loc_10016D56:				; CODE XREF: sub_10016CD0+79j
		mov	ecx, [edi+0F4h]
		cmp	ecx, esi
		jz	short loc_10016D85
		mov	eax, [edi+88h]
		cmp	eax, esi
		jz	short loc_10016D70
		push	ecx
		call	eax
		add	esp, 4

loc_10016D70:				; CODE XREF: sub_10016CD0+98j
		mov	edx, [edi+0F4h]
		push	edx
		call	sub_10017FD0
		add	esp, 4
		mov	[edi+0F4h], esi

loc_10016D85:				; CODE XREF: sub_10016CD0+8Ej
		mov	eax, [ebp+4]
		mov	ecx, [ebp+8]
		mov	[esp+0A44h+var_A08], eax
		lea	ebx, [esp+0A44h+var_A00]
		mov	eax, ebp
		mov	edx, edi
		mov	[esp+0A44h+var_A04], ecx
		call	sub_10016120
		test	eax, eax
		jz	short loc_10016DAC
		or	eax, 0FFFFFFFFh
		jmp	loc_10016EF3
; ---------------------------------------------------------------------------

loc_10016DAC:				; CODE XREF: sub_10016CD0+D2j
		mov	ebp, 8000h
		lea	eax, [esp+0A44h+var_A2C]
		test	[edi+14h], ebp
		jz	short loc_10016DD4
		lea	edx, [esp+0A44h+var_9E8]
		push	edx
		push	eax
		lea	ecx, [esp+0A4Ch+var_9E4]
		push	ecx
		lea	edx, [esp+0A50h+var_A24]
		push	edx
		call	sub_10014A60
		add	esp, 10h
		jmp	short loc_10016DE4
; ---------------------------------------------------------------------------

loc_10016DD4:				; CODE XREF: sub_10016CD0+E8j
		push	eax
		lea	ecx, [esp+0A48h+var_A24]
		push	ecx
		mov	eax, edi
		call	sub_100149C0
		add	esp, 8

loc_10016DE4:				; CODE XREF: sub_10016CD0+102j
		mov	ebx, eax
		test	ebx, ebx
		jnz	loc_10016EF1
		mov	edx, [esp+0A44h+var_A00]
		lea	ecx, [eax+10h]
		mov	eax, offset dword_100377A0
		sub	edx, eax
		lea	esp, [esp+0]

loc_10016E00:				; CODE XREF: sub_10016CD0+144j
		mov	ebx, [eax+edx]
		cmp	ebx, [eax]
		jnz	loc_10016E8C
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_10016E00
		test	[edi+14h], ebp
		jz	loc_10016F0C
		push	4
		call	sub_10022B60
		mov	edx, [esp+0A48h+var_A2C]
		push	0
		push	20h
		push	edx
		push	eax
		lea	eax, [esp+0A58h+var_9D4]
		push	eax
		call	sub_10022BD0
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10016E8C
		lea	ecx, [esp+0A44h+var_9D4]
		push	ecx
		call	sub_10022C10
		mov	edx, [esp+0A48h+var_A04]
		mov	eax, [esp+0A48h+var_A08]
		add	edx, 0FFFFFFE0h
		push	edx
		push	eax
		lea	ecx, [esp+0A50h+var_9D4]
		push	ecx
		call	sub_10022C40
		push	20h
		lea	edx, [esp+0A58h+var_A1C]
		push	edx
		lea	eax, [esp+0A5Ch+var_24]
		push	eax
		lea	ecx, [esp+0A60h+var_9D4]
		push	ecx
		call	sub_10022C70
		add	esp, 20h
		test	eax, eax
		jz	loc_10016F9B

loc_10016E8C:				; CODE XREF: sub_10016CD0+135j
					; sub_10016CD0+172j ...
		call	SSL_GetStatistics
		add	eax, 30h
		push	eax
		call	PR_AtomicIncrement
		add	esp, 4

loc_10016E9D:				; CODE XREF: sub_10016CD0+81j
					; sub_10016CD0+6F9j ...
		xor	ebx, ebx

loc_10016E9F:				; CODE XREF: sub_10016CD0+805j
		mov	eax, [esp+0A44h+var_A20]
		test	eax, eax
		jz	short loc_10016EB8
		cmp	[edi+0F4h], eax
		jz	short loc_10016EB8
		push	eax
		call	sub_10017FD0
		add	esp, 4

loc_10016EB8:				; CODE XREF: sub_10016CD0+1D5j
					; sub_10016CD0+1DDj ...
		mov	eax, [esp+0A44h+var_A28]
		test	eax, eax
		jz	short loc_10016ECB
		push	1
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10016ECB:				; CODE XREF: sub_10016CD0+1EEj
		test	esi, esi
		jz	short loc_10016EF1
		cmp	dword ptr [esi+68h], 0
		jz	short loc_10016EE3
		lea	edx, [esi+64h]
		push	0
		push	edx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10016EE3:				; CODE XREF: sub_10016CD0+203j
		push	80h
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8

loc_10016EF1:				; CODE XREF: sub_10016CD0+118j
					; sub_10016CD0+1FDj
		mov	eax, ebx

loc_10016EF3:				; CODE XREF: sub_10016CD0+D7j
		mov	ecx, [esp+0A44h+var_4]
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A34h
		retn
; ---------------------------------------------------------------------------

loc_10016F0C:				; CODE XREF: sub_10016CD0+149j
		mov	eax, [esp+0A44h+var_A2C]
		lea	edx, [esp+0A44h+var_A18]
		push	edx
		push	eax
		xor	ebp, ebp
		push	108h
		push	251h
		mov	[esp+0A54h+var_A14], ebp
		mov	[esp+0A54h+var_A10], ebp
		call	PK11_CreateContextBySymKey
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, ebp
		jz	loc_10016E8C
		push	ebx
		call	PK11_DigestBegin
		mov	ecx, [esp+0A48h+var_A04]
		mov	edx, [esp+0A48h+var_A08]
		add	ecx, 0FFFFFFE0h
		push	ecx
		push	edx
		push	ebx
		call	PK11_DigestOp
		add	esp, 10h
		test	eax, eax
		jz	short loc_10016F6C
		push	1
		push	ebx
		call	PK11_DestroyContext
		add	esp, 8
		jmp	loc_10016E8C
; ---------------------------------------------------------------------------

loc_10016F6C:				; CODE XREF: sub_10016CD0+28Aj
		push	20h
		lea	eax, [esp+0A48h+var_A1C]
		push	eax
		lea	ecx, [esp+0A4Ch+var_24]
		push	ecx
		push	ebx
		call	PK11_DigestFinal
		push	1
		push	ebx
		mov	ebp, eax
		call	PK11_DestroyContext
		add	esp, 18h
		test	ebp, ebp
		jnz	loc_10016E8C
		mov	ebp, 8000h

loc_10016F9B:				; CODE XREF: sub_10016CD0+1B6j
		mov	edx, [esp+0A44h+var_A1C]
		mov	eax, [esp+0A44h+var_9EC]
		push	edx
		push	eax
		lea	ecx, [esp+0A4Ch+var_24]
		push	ecx
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10016E8C
		mov	edx, [esp+0A44h+var_9F0]
		push	edx
		push	eax
		push	eax
		call	SECITEM_AllocItem_Util
		add	esp, 0Ch
		mov	[esp+0A44h+var_A28], eax
		test	[edi+14h], ebp
		jz	short loc_1001702D
		mov	eax, [esp+0A44h+var_9FC]
		mov	ecx, [esp+0A44h+var_A24]
		push	10h
		push	0
		push	1
		push	eax
		push	20h
		push	ecx
		lea	edx, [esp+0A5Ch+var_844]
		push	edx
		call	sub_10022950
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_10016E8C
		mov	eax, [esp+0A44h+var_A28]
		mov	ecx, [esp+0A44h+var_9F0]
		mov	edx, [esp+0A44h+var_9F4]
		push	ecx
		mov	ecx, [eax+8]
		lea	ebx, [eax+8]
		push	edx
		mov	edx, [eax+4]
		push	ecx
		push	ebx
		push	edx
		lea	eax, [esp+0A58h+var_844]
		push	eax
		call	sub_100225E0
		add	esp, 18h
		test	eax, eax
		jmp	short loc_1001709C
; ---------------------------------------------------------------------------

loc_1001702D:				; CODE XREF: sub_10016CD0+303j
		mov	eax, [esp+0A44h+var_A24]
		mov	ecx, [esp+0A44h+var_9FC]
		lea	edx, [esp+0A44h+var_A18]
		push	edx
		push	eax
		push	105h
		push	1082h
		mov	[esp+0A54h+var_A14], ecx
		mov	[esp+0A54h+var_A10], 10h
		call	PK11_CreateContextBySymKey
		mov	ebp, eax
		add	esp, 10h
		test	ebp, ebp
		jz	loc_10016E8C
		mov	eax, [esp+0A44h+var_A28]
		mov	ecx, [esp+0A44h+var_9F0]
		mov	edx, [esp+0A44h+var_9F4]
		push	ecx
		mov	ecx, [eax+8]
		push	edx
		mov	edx, [eax+4]
		lea	ebx, [eax+8]
		push	ecx
		push	ebx
		push	edx
		push	ebp
		call	PK11_CipherOp
		push	ebp
		mov	[esp+0A60h+var_A24], eax
		call	PK11_Finalize
		push	1
		push	ebp
		call	PK11_DestroyContext
		add	esp, 24h
		cmp	[esp+0A44h+var_A24], esi

loc_1001709C:				; CODE XREF: sub_10016CD0+35Bj
		jnz	loc_10016E8C
		mov	eax, [esp+0A44h+var_A28]
		mov	edx, [eax+4]
		mov	ecx, [ebx]
		movzx	ebp, byte ptr [edx+ecx-1]
		lea	eax, [edx+ecx]
		mov	[esp+0A44h+var_A2C], ebp
		test	ebp, ebp
		jz	loc_10016E8C
		cmp	ebp, 10h
		ja	loc_10016E8C
		sub	eax, ebp
		xor	ecx, ecx
		test	ebp, ebp
		jz	short loc_100170E9

loc_100170D0:				; CODE XREF: sub_10016CD0+413j
		movzx	ebp, byte ptr [eax]
		cmp	[esp+0A44h+var_A2C], ebp
		jnz	loc_10016E8C
		inc	ecx
		inc	eax
		cmp	ecx, [esp+0A44h+var_A2C]
		jb	short loc_100170D0
		mov	ebp, [esp+0A44h+var_A2C]

loc_100170E9:				; CODE XREF: sub_10016CD0+3FEj
		mov	[esp+0A44h+Src], edx
		mov	edx, [ebx]
		push	80h
		mov	[esp+0A48h+var_A34], edx
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001710E
		or	ebx, 0FFFFFFFFh
		jmp	loc_10016EB8
; ---------------------------------------------------------------------------

loc_1001710E:				; CODE XREF: sub_10016CD0+434j
		lea	eax, [esp+0A44h+var_A34]
		push	eax
		lea	ecx, [esp+0A48h+Src]
		push	ecx
		push	2
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		mov	[esi], ax
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	2
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	ecx, [esp+0A44h+var_A34]
		push	ecx
		lea	edx, [esp+0A48h+Src]
		push	edx
		push	2
		push	edi
		mov	[esi+2], ax
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+4], ax
		lea	eax, [esp+0A44h+var_A34]
		push	eax
		lea	ecx, [esp+0A48h+Src]
		push	ecx
		push	1
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		mov	[esi+8], eax
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	1
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	ecx, [esp+0A44h+var_A34]
		push	ecx
		lea	edx, [esp+0A48h+Src]
		push	edx
		push	4
		push	edi
		mov	[esi+0Ch], eax
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+10h], eax
		lea	eax, [esp+0A44h+var_A34]
		push	eax
		lea	ecx, [esp+0A48h+Src]
		push	ecx
		push	1
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		mov	[esi+14h], eax
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	4
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	ecx, [esp+0A44h+var_A34]
		push	ecx
		lea	edx, [esp+0A48h+Src]
		push	edx
		push	1
		push	edi
		mov	[esi+18h], eax
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+1Ch], al
		lea	eax, [esp+0A44h+var_A34]
		push	eax
		lea	ecx, [esp+0A48h+Src]
		push	ecx
		push	1
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		mov	[esi+20h], eax
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	4
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		lea	ecx, [esp+0A44h+var_A34]
		push	ecx
		lea	edx, [esp+0A48h+Src]
		push	edx
		push	2
		push	edi
		mov	[esi+24h], eax
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+28h], ax
		test	ax, ax
		jz	loc_10016E8C
		cmp	ax, 30h
		ja	loc_10016E8C
		movzx	eax, ax
		cmp	[esp+0A44h+var_A34], eax
		jb	loc_10016E8C
		push	eax		; Size
		mov	eax, [esp+0A48h+Src]
		lea	ecx, [esi+2Ah]
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		movzx	ecx, word ptr [esi+28h]
		add	[esp+0A50h+Src], ecx
		movzx	edx, word ptr [esi+28h]
		sub	[esp+0A50h+var_A34], edx
		lea	eax, [esp+0A50h+var_A34]
		push	eax
		lea	ecx, [esp+0A54h+Src]
		push	ecx
		push	1
		push	edi
		call	sub_100091C0
		add	esp, 1Ch
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+5Ch], eax
		sub	eax, 0
		jz	short loc_10017339
		dec	eax
		jnz	loc_10016E8C
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	3
		lea	ecx, [esp+0A50h+var_9E0]
		push	ecx
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10016E8C
		lea	edx, [esp+0A44h+var_9E0]
		push	edx
		lea	eax, [esi+64h]
		push	eax
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10016E8C

loc_10017339:				; CODE XREF: sub_10016CD0+623j
		lea	ecx, [esp+0A44h+var_A34]
		push	ecx
		lea	edx, [esp+0A48h+Src]
		push	edx
		push	4
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10016E8C
		mov	[esi+70h], eax
		lea	eax, [esp+0A44h+var_A34]
		push	eax
		lea	ecx, [esp+0A48h+Src]
		push	ecx
		push	1
		push	edi
		call	sub_100091C0
		mov	bl, al
		add	esp, 10h
		cmp	bl, 0FFh
		jz	short loc_100173BB
		lea	edx, [esp+0A44h+var_A34]
		push	edx
		lea	eax, [esp+0A48h+Src]
		push	eax
		push	2
		lea	ecx, [esp+0A50h+var_A18]
		push	ecx
		push	edi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_10016E8C
		lea	edx, [esp+0A44h+var_A18]
		push	edx
		lea	ebp, [esi+74h]
		push	ebp
		push	eax
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10016E8C
		movsx	eax, bl
		mov	[ebp+0], eax
		mov	ebp, [esp+0A44h+var_A2C]

loc_100173BB:				; CODE XREF: sub_10016CD0+6A3j
		cmp	[esp+0A44h+var_A34], ebp
		jnz	loc_10016E8C
		cmp	dword ptr [esi+70h], 0
		jz	loc_10016E9D
		call	sub_10018130
		mov	ecx, [esi+70h]
		add	ecx, 2A300h
		cmp	ecx, eax
		jbe	loc_10016E9D
		push	1
		push	edi
		call	sub_100066A0
		add	esp, 8
		mov	[esp+0A44h+var_A20], eax
		test	eax, eax
		jnz	short loc_10017400
		or	ebx, 0FFFFFFFFh
		jmp	loc_10016EB8
; ---------------------------------------------------------------------------

loc_10017400:				; CODE XREF: sub_10016CD0+726j
		mov	dx, [esi+2]
		mov	[eax+3Ah], dx
		mov	cx, [esi+4]
		mov	[eax+76h], cx
		mov	edx, [esi+8]
		mov	[eax+78h], edx
		mov	ecx, [esi+0Ch]
		mov	[eax+44h], ecx
		mov	edx, [esi+10h]
		mov	[eax+48h], edx
		mov	ecx, [esi+14h]
		mov	[eax+4Ch], ecx
		mov	edx, [esi+18h]
		mov	[eax+50h], edx
		test	dword ptr [edi+14h], 8000h
		jz	short loc_10017441
		cmp	byte ptr [esi+1Ch], 0
		jnz	loc_10016E8C

loc_10017441:				; CODE XREF: sub_10016CD0+765j
		movzx	eax, word ptr [esi+28h]
		cmp	eax, 30h
		ja	loc_10016E8C
		mov	ebp, [esp+0A44h+var_A20]
		push	eax		; Size
		lea	eax, [esi+2Ah]
		push	eax		; Src
		lea	ecx, [ebp+80h]
		push	ecx		; Dst
		call	memcpy
		mov	dx, [esi+28h]
		mov	[ebp+0B0h], dx
		mov	eax, [esi+20h]
		mov	[ebp+0B8h], eax
		mov	ecx, [esi+24h]
		mov	[ebp+0B4h], ecx
		mov	dl, [esi+1Ch]
		mov	ebx, 1
		add	esp, 0Ch
		mov	[ebp+0B2h], dl
		mov	[ebp+0DEh], bl
		mov	[ebp+0B3h], bl
		cmp	dword ptr [esi+68h], 0
		jz	short loc_100174DA
		mov	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_100174B3
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_100174B3:				; CODE XREF: sub_10016CD0+7D8j
		mov	ecx, [edi+260h]
		push	ebx
		push	0
		push	0
		lea	eax, [esi+64h]
		push	eax
		push	ecx
		call	CERT_NewTempCertificate
		add	esp, 14h
		mov	[ebp+10h], eax
		test	eax, eax
		jnz	short loc_100174DA
		or	ebx, 0FFFFFFFFh
		jmp	loc_10016E9F
; ---------------------------------------------------------------------------

loc_100174DA:				; CODE XREF: sub_10016CD0+7D1j
					; sub_10016CD0+800j
		cmp	dword ptr [esi+78h], 0
		jz	short loc_100174FB
		mov	edx, [esi+74h]
		mov	[ebp+0E0h], edx
		mov	eax, [esi+78h]
		mov	[ebp+0E4h], eax
		mov	ecx, [esi+7Ch]
		mov	[ebp+0E8h], ecx

loc_100174FB:				; CODE XREF: sub_10016CD0+80Ej
		mov	[edi+2E98h], ebx
		mov	[edi+0F4h], ebp
		jmp	loc_10016E9D
sub_10016CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017510	proc near		; CODE XREF: SSL_ResetHandshake+EAp
					; sub_1001EB40+1E9p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+30h], ecx
		mov	[eax+2Ch], ecx
		mov	[eax+5Ch], ecx
		mov	[eax+54h], ecx
		add	eax, 4
		push	1000h
		push	eax
		call	sub_10018960
		add	esp, 8
		retn
sub_10017510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017540	proc near		; CODE XREF: sub_1001C250+31p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_1001756F
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+4]
		push	eax
		push	ecx
		call	PORT_ZFree_Util
		mov	edx, [esi+34h]
		push	edx
		call	PORT_Free_Util
		mov	eax, [esi+50h]
		add	esp, 0Ch
		pop	esi
		mov	[esp+arg_0], eax
		jmp	PORT_Free_Util
; ---------------------------------------------------------------------------

loc_1001756F:				; CODE XREF: sub_10017540+7j
		pop	esi
		retn
sub_10017540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017580	proc near		; CODE XREF: sub_100175D0:loc_10017971p
		push	1
		push	303h
		push	esi
		mov	dword ptr [esi+288h], 2
		mov	dword ptr [esi+28Ch], 0
		mov	dword ptr [esi+1E0h], 0
		mov	dword ptr [esi+1E4h], 0
		call	sub_10003440
		add	esp, 0Ch
		test	eax, eax
		jnz	short locret_100175C3
		mov	dword ptr [esi+48h], offset sub_10007FE0

locret_100175C3:			; CODE XREF: sub_10017580+3Aj
		retn
sub_10017580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100175D0	proc near		; CODE XREF: sub_100179F0+11p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_0]
		push	edi
		mov	edi, [esp+34h+arg_4]
		xor	ebx, ebx
		cmp	[edi], ebx
		jnz	short loc_10017613
		mov	eax, 3
		mov	dword ptr [edi], 1
		mov	[edi+14h], eax
		mov	[edi+18h], eax
		mov	[edi+10h], ebx
		mov	[edi+1Ch], ebx
		mov	[edi+20h], ebx
		mov	[edi+42h], bl
		mov	[edi+30h], ebx
		mov	[edi+2Ch], ebx

loc_10017613:				; CODE XREF: sub_100175D0+1Ej
		mov	ebp, [edi+4]
		mov	[esp+34h+var_1C], ebp
		lea	ebx, [ebx+0]

loc_10017620:				; CODE XREF: sub_100175D0+89j
					; sub_100175D0+98j ...
		cmp	dword ptr [edi], 1
		mov	ecx, ebp
		jnz	short loc_1001762A
		lea	ecx, [edi+40h]

loc_1001762A:				; CODE XREF: sub_100175D0+55j
		mov	eax, [edi+10h]
		mov	edx, [edi+14h]
		add	eax, ecx
		mov	ecx, [esp+34h+arg_8]
		push	ecx
		push	edx
		push	eax
		push	esi
		call	sub_100144F0
		add	esp, 10h
		cmp	eax, ebx
		jz	loc_1001777B
		jl	loc_100179A0
		add	[edi+10h], eax
		sub	[edi+14h], eax
		mov	ecx, [edi+10h]
		jnz	short loc_10017620
		mov	eax, [edi]
		dec	eax
		jz	short loc_10017699
		dec	eax
		jz	loc_10017790
		dec	eax
		jnz	short loc_10017620
		mov	[edi+24h], ebx
		mov	[edi+2Ch], ebx
		mov	[edi+20h], ebx
		mov	[edi], ebx
		mov	[edi+30h], ecx
		mov	[edi+1Ch], ecx
		inc	dword ptr [esi+90h]
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10017699:				; CODE XREF: sub_100175D0+8Ej
		cmp	[esi+18h], bx
		jz	short loc_100176C3
		cmp	[esi+24h], ebx
		jnz	short loc_100176C3
		mov	al, [edi+40h]
		cmp	al, 16h
		jz	loc_1001795D
		cmp	al, 15h
		jnz	short loc_100176C3
		cmp	dword ptr [esi+1E0h], offset sub_10013420
		jz	loc_10017993

loc_100176C3:				; CODE XREF: sub_100175D0+CDj
					; sub_100175D0+D2j ...
		mov	al, [edi+40h]
		test	al, al
		jns	short loc_100176E1
		movzx	ecx, byte ptr [edi+41h]
		movzx	eax, al
		and	eax, 7Fh
		shl	eax, 8
		or	eax, ecx
		mov	[edi+18h], eax
		mov	[edi+20h], ebx
		jmp	short loc_100176FA
; ---------------------------------------------------------------------------

loc_100176E1:				; CODE XREF: sub_100175D0+F8j
		movzx	ecx, byte ptr [edi+42h]
		movzx	edx, al
		movzx	eax, byte ptr [edi+41h]
		and	edx, 3Fh
		shl	edx, 8
		or	edx, eax
		mov	[edi+18h], edx
		mov	[edi+20h], ecx

loc_100176FA:				; CODE XREF: sub_100175D0+10Fj
		mov	eax, [edi+18h]
		cmp	eax, ebx
		jz	loc_100179B6
		cmp	eax, [edi+0Ch]
		jbe	short loc_10017728
		push	eax
		lea	ebp, [edi+4]
		push	ebp
		call	sub_10018960
		add	esp, 8
		cmp	eax, ebx
		jnz	loc_100179DD
		mov	edx, [ebp+0]
		mov	[esp+34h+var_1C], edx
		mov	ebp, edx

loc_10017728:				; CODE XREF: sub_100175D0+138j
		test	byte ptr [edi+40h], 80h
		jz	short loc_10017746
		mov	al, [edi+42h]
		mov	[ebp+0], al
		mov	eax, [edi+18h]
		lea	ecx, [eax-1]
		mov	dword ptr [edi+10h], 1
		mov	[edi+14h], ecx
		jmp	short loc_1001774F
; ---------------------------------------------------------------------------

loc_10017746:				; CODE XREF: sub_100175D0+15Cj
		mov	eax, [edi+18h]
		mov	[edi+10h], ebx
		mov	[edi+14h], eax

loc_1001774F:				; CODE XREF: sub_100175D0+174j
		cmp	[edi+28h], ebx
		jz	short loc_1001776D
		mov	dword ptr [edi], 2
		mov	edx, [esi+94h]
		sub	eax, [edx]
		sub	eax, [edi+20h]
		mov	[edi+1Ch], eax
		jmp	loc_10017620
; ---------------------------------------------------------------------------

loc_1001776D:				; CODE XREF: sub_100175D0+182j
		mov	dword ptr [edi], 3
		mov	[edi+1Ch], eax
		jmp	loc_10017620
; ---------------------------------------------------------------------------

loc_1001777B:				; CODE XREF: sub_100175D0+74j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10017790:				; CODE XREF: sub_100175D0+91j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100177A5
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_100177A5:				; CODE XREF: sub_100175D0+1C4j
		mov	ecx, [esi+0CCh]
		dec	ecx
		test	[edi+18h], ecx
		jz	short loc_100177C3
		push	0FFFFD018h
		call	PORT_SetError_Util
		add	esp, 4
		or	ebp, 0FFFFFFFFh
		jmp	short loc_100177EF
; ---------------------------------------------------------------------------

loc_100177C3:				; CODE XREF: sub_100175D0+1DFj
		mov	eax, [edi+10h]
		cmp	eax, ebx
		jnz	short loc_100177CE
		xor	ebp, ebp
		jmp	short loc_100177EF
; ---------------------------------------------------------------------------

loc_100177CE:				; CODE XREF: sub_100175D0+1F8j
		mov	ecx, [esi+0C0h]
		push	eax
		push	ebp
		push	eax
		mov	eax, [esi+0B4h]
		lea	edx, [esp+40h+var_18]
		push	edx
		push	ebp
		push	eax
		call	ecx
		mov	ebp, eax
		add	esp, 18h
		cmp	ebp, ebx
		jz	short loc_10017819

loc_100177EF:				; CODE XREF: sub_100175D0+1F1j
					; sub_100175D0+1FCj
		test	byte ptr [esi+16h], 1
		jnz	short loc_10017804
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10017804:				; CODE XREF: sub_100175D0+223j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10017819:				; CODE XREF: sub_100175D0+21Dj
		mov	edx, [esi+94h]
		mov	ecx, [edx]
		mov	[esp+34h+var_24], ecx
		cmp	[edi+10h], ecx
		jb	loc_1001791E
		mov	eax, [esi+90h]
		lea	ecx, [eax+1]
		mov	[esi+90h], ecx
		mov	ecx, eax
		shr	ecx, 18h
		mov	[esp+34h+var_20], cl
		mov	ecx, eax
		shr	ecx, 10h
		mov	[esp+34h+var_1F], cl
		mov	ecx, eax
		shr	ecx, 8
		mov	[esp+34h+var_1D], al
		mov	eax, [esi+98h]
		mov	[esp+34h+var_1E], cl
		mov	ecx, [edx+10h]
		push	eax
		call	ecx
		mov	eax, [esi+0B0h]
		mov	ecx, [esi+0ACh]
		mov	edx, [esi+94h]
		push	eax
		mov	eax, [esi+98h]
		push	ecx
		mov	ecx, [edx+14h]
		push	eax
		call	ecx
		mov	eax, [esp+44h+var_24]
		mov	ecx, [edi+10h]
		mov	ebp, [esp+44h+var_1C]
		mov	edx, [esi+94h]
		sub	ecx, eax
		push	ecx
		mov	ecx, [edx+14h]
		add	eax, ebp
		push	eax
		mov	eax, [esi+98h]
		push	eax
		call	ecx
		mov	edx, [esi+94h]
		mov	ecx, [esi+98h]
		mov	edx, [edx+14h]
		push	4
		lea	eax, [esp+54h+var_20]
		push	eax
		push	ecx
		call	edx
		mov	ecx, [esp+5Ch+var_24]
		mov	eax, [esi+94h]
		mov	eax, [eax+18h]
		push	ecx
		lea	edx, [esp+60h+var_24]
		push	edx
		mov	edx, [esi+98h]
		lea	ecx, [esp+64h+var_14]
		push	ecx
		push	edx
		call	eax
		add	esp, 38h
		test	byte ptr [esi+16h], 1
		jnz	short loc_100178FD
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_100178FD:				; CODE XREF: sub_100175D0+31Cj
		mov	edx, [esp+34h+var_24]
		push	edx
		lea	eax, [esp+38h+var_14]
		push	ebp
		push	eax
		call	NSS_SecureMemcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10017933
		push	0FFFFD00Fh
		jmp	loc_100179BB
; ---------------------------------------------------------------------------

loc_1001791E:				; CODE XREF: sub_100175D0+258j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10017937
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10017933:				; CODE XREF: sub_100175D0+342j
		mov	ecx, [esp+34h+var_24]

loc_10017937:				; CODE XREF: sub_100175D0+352j
		mov	edx, [edi+20h]
		mov	eax, [edi+10h]
		lea	esi, [edx+ecx]
		cmp	esi, eax
		ja	short loc_10017956
		sub	eax, edx
		mov	[edi+30h], eax
		mov	[edi+24h], ecx
		mov	[edi+2Ch], ecx
		mov	eax, 1
		jmp	short loc_100179CF
; ---------------------------------------------------------------------------

loc_10017956:				; CODE XREF: sub_100175D0+372j
		push	0FFFFD018h
		jmp	short loc_100179BB
; ---------------------------------------------------------------------------

loc_1001795D:				; CODE XREF: sub_100175D0+D9j
		mov	eax, [esi+1E0h]
		cmp	eax, offset sub_10013DA0
		jz	short loc_10017971
		cmp	eax, offset sub_10013420
		jnz	short loc_1001797B

loc_10017971:				; CODE XREF: sub_100175D0+398j
		call	sub_10017580
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100179A0

loc_1001797B:				; CODE XREF: sub_100175D0+39Fj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10017993:				; CODE XREF: sub_100175D0+EDj
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4

loc_100179A0:				; CODE XREF: sub_100175D0+7Aj
					; sub_100175D0+3A9j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100179B6:				; CODE XREF: sub_100175D0+12Fj
		push	0FFFFD019h

loc_100179BB:				; CODE XREF: sub_100175D0+349j
					; sub_100175D0+38Bj
		call	PORT_SetError_Util
		add	esp, 4
		mov	[edi+24h], ebx
		mov	[edi+2Ch], ebx
		mov	[edi+30h], ebx
		or	eax, 0FFFFFFFFh

loc_100179CF:				; CODE XREF: sub_100175D0+384j
		mov	edx, [edi+30h]
		sub	edx, [edi+2Ch]
		mov	[edi+20h], ebx
		mov	[edi+1Ch], edx
		mov	[edi], ebx

loc_100179DD:				; CODE XREF: sub_100175D0+149j
		mov	ecx, [esp+34h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_100175D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100179F0	proc near		; CODE XREF: sub_10011CC0+33p
					; sub_10018AA0:loc_10018AF5p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	eax
		mov	eax, [esp+4+arg_0]
		lea	ecx, [eax+274h]
		push	ecx
		push	eax
		call	sub_100175D0
		add	esp, 0Ch
		retn
sub_100179F0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_10017BE0

loc_10017A10:				; CODE XREF: sub_10017BE0+4Dj
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_10017A28
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10017A28:				; CODE XREF: sub_10017BE0-1CBj
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		xor	eax, eax
		retn
; END OF FUNCTION CHUNK	FOR sub_10017BE0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017A40	proc near		; CODE XREF: sub_1001B760+213p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_10017A50
		mov	dword ptr [esi+4], 0

loc_10017A50:				; CODE XREF: sub_10017A40+7j
		call	ds:PR_NewLock
		mov	[esi+4], eax
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	esi
		retn
sub_10017A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017A70	proc near		; CODE XREF: sub_1001B0B0+32Dp

MutexAttributes	= _SECURITY_ATTRIBUTES ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		xor	eax, eax
		cmp	[esp+0Ch+arg_4], eax
		push	esi
		mov	esi, [esp+10h+arg_0]
		setnz	al
		push	edi
		mov	[esp+14h+MutexAttributes.nLength], 0Ch
		mov	[esp+14h+MutexAttributes.lpSecurityDescriptor],	0
		mov	[esp+14h+MutexAttributes.bInheritHandle], 1
		mov	edi, eax
		mov	[esi], edi
		test	edi, edi
		jnz	short loc_10017AB8
		call	ds:PR_NewLock
		mov	[esi+4], eax
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	edi
		dec	eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10017AB8:				; CODE XREF: sub_10017A70+30j
		mov	dword ptr [esi+4], 0
		call	ds:PR_NewLock
		mov	[esi+4], eax
		test	eax, eax
		jz	short loc_10017B1F
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10017AD8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10017B12

loc_10017AD8:				; CODE XREF: sub_10017A70+61j
		push	0		; lpName
		push	0		; bInitialOwner
		lea	ecx, [esp+1Ch+MutexAttributes]
		push	ecx		; lpMutexAttributes
		mov	[esp+20h+MutexAttributes.bInheritHandle], edi
		call	ds:CreateMutexA
		test	eax, eax
		jnz	short loc_10017B07
		call	ds:GetLastError
		push	eax
		call	sub_10021C00
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10017B07:				; CODE XREF: sub_10017A70+7Dj
		mov	[esi+8], eax
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10017B12:				; CODE XREF: sub_10017A70+66j
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4

loc_10017B1F:				; CODE XREF: sub_10017A70+5Aj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
sub_10017A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017B30	proc near		; CODE XREF: sub_1001B010+2Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_10017B61
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_10017B53
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017B53:				; CODE XREF: sub_10017B30+Fj
		push	esi
		call	ds:PR_DestroyLock
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017B61:				; CODE XREF: sub_10017B30+8j
		mov	eax, [esi+4]
		test	eax, eax
		jnz	short loc_10017B7A
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10017B86
; ---------------------------------------------------------------------------

loc_10017B7A:				; CODE XREF: sub_10017B30+36j
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4
		xor	eax, eax

loc_10017B86:				; CODE XREF: sub_10017B30+48j
		push	edi
		mov	edi, eax
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10017BC9
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017BC9
		push	eax		; hObject
		call	ds:CloseHandle
		cmp	[esp+8+arg_4], 0
		jnz	short loc_10017BAE
		test	eax, eax
		jz	short loc_10017BB2
		mov	dword ptr [esi+8], 0FFFFFFFFh

loc_10017BAE:				; CODE XREF: sub_10017B30+71j
		test	eax, eax
		jnz	short loc_10017BC4

loc_10017BB2:				; CODE XREF: sub_10017B30+75j
		call	ds:GetLastError
		push	eax
		call	sub_10021C00
		add	esp, 4
		or	edi, 0FFFFFFFFh

loc_10017BC4:				; CODE XREF: sub_10017B30+80j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017BC9:				; CODE XREF: sub_10017B30+5Ej
					; sub_10017B30+63j
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10017B30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017BE0	proc near		; CODE XREF: sub_1001A1C0+Bp
					; sub_1001A1E0+102p ...

arg_0		= dword	ptr  4

; FUNCTION CHUNK AT 10017A10 SIZE 00000025 BYTES

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_10017BFF
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10017C32
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017BFF:				; CODE XREF: sub_10017BE0+8j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10017C32
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017C32
		push	eax		; hMutex
		call	ds:ReleaseMutex
		test	eax, eax
		jnz	short loc_10017C2A
		call	ds:GetLastError
		push	eax
		call	sub_10021C00
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017C2A:				; CODE XREF: sub_10017BE0+34j
		mov	eax, esi
		pop	esi
		jmp	loc_10017A10
; ---------------------------------------------------------------------------

loc_10017C32:				; CODE XREF: sub_10017BE0+Fj
					; sub_10017BE0+24j ...
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10017BE0	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017C50	proc near		; CODE XREF: sub_1001A180+7p
					; sub_1001A1E0+7Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_10017C81
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_10017C73
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017C73:				; CODE XREF: sub_10017C50+Fj
		push	esi
		call	ds:PR_Lock
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017C81:				; CODE XREF: sub_10017C50+8j
		mov	eax, [esi+4]
		push	edi
		test	eax, eax
		jnz	short loc_10017C9B
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10017CA7
; ---------------------------------------------------------------------------

loc_10017C9B:				; CODE XREF: sub_10017C50+37j
		push	eax
		call	ds:PR_Lock
		add	esp, 4
		xor	edi, edi

loc_10017CA7:				; CODE XREF: sub_10017C50+49j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10017D01
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017D01
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		test	eax, eax
		jz	short loc_10017CF2
		cmp	eax, 80h
		jz	short loc_10017CF2
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017CDE
		push	0FFFFE896h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_10017CF4
; ---------------------------------------------------------------------------

loc_10017CDE:				; CODE XREF: sub_10017C50+7Aj
		or	esi, 0FFFFFFFFh
		call	ds:GetLastError
		push	eax
		call	sub_10021C00
		add	esp, 4
		jmp	short loc_10017CF4
; ---------------------------------------------------------------------------

loc_10017CF2:				; CODE XREF: sub_10017C50+6Ej
					; sub_10017C50+75j
		xor	esi, esi

loc_10017CF4:				; CODE XREF: sub_10017C50+8Cj
					; sub_10017C50+A0j
		test	edi, edi
		jnz	short loc_10017D0E
		test	esi, esi
		jnz	short loc_10017D0E
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017D01:				; CODE XREF: sub_10017C50+5Cj
					; sub_10017C50+61j
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4

loc_10017D0E:				; CODE XREF: sub_10017C50+A6j
					; sub_10017C50+AAj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10017C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017D20	proc near		; CODE XREF: sub_10017E70p
					; sub_10017EA0:loc_10017EC8p
		push	esi
		call	sub_10006030
		mov	esi, eax
		call	ds:PR_NewLock
		mov	dword_100377EC,	eax
		test	esi, esi
		jnz	short loc_10017D3F
		test	eax, eax
		jz	short loc_10017D3F
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017D3F:				; CODE XREF: sub_10017D20+15j
					; sub_10017D20+19j
		call	PORT_GetError_Util
		mov	esi, eax
		call	sub_10005F80
		mov	eax, dword_100377EC
		test	eax, eax
		jz	short loc_10017D76
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4
		push	esi
		mov	dword_100377EC,	0
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017D76:				; CODE XREF: sub_10017D20+32j
		push	0FFFFE09Ah
		call	PORT_SetError_Util
		add	esp, 4
		push	esi
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10017D20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017DA0	proc near		; CODE XREF: sub_10005FC0+57p
		cmp	dword_100377F0,	0
		jnz	short loc_10017DBA
		push	0FFFFE09Ah
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10017DBA:				; CODE XREF: sub_10017DA0+7j
		call	sub_10005F80
		mov	eax, dword_100377EC
		test	eax, eax
		jz	short loc_10017DE9
		push	eax
		call	ds:PR_DestroyLock
		add	esp, 4
		mov	dword_100377EC,	0
		mov	dword_100377F0,	0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10017DE9:				; CODE XREF: sub_10017DA0+26j
		push	0FFFFE09Ah
		call	PORT_SetError_Util
		add	esp, 4
		mov	dword_100377F0,	0
		xor	eax, eax
		retn
sub_10017DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017E10	proc near		; DATA XREF: sub_10017E70+Fo
		cmp	dword_100377F0,	0
		jz	short loc_10017E2A
		push	0FFFFE001h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10017E2A:				; CODE XREF: sub_10017E10+7j
		call	sub_10005F80
		mov	eax, dword_100377EC
		test	eax, eax
		jz	short loc_10017E4B
		push	eax
		call	ds:PR_DestroyLock
		mov	dword_100377EC,	0
		jmp	short loc_10017E55
; ---------------------------------------------------------------------------

loc_10017E4B:				; CODE XREF: sub_10017E10+26j
		push	0FFFFE09Ah
		call	PORT_SetError_Util

loc_10017E55:				; CODE XREF: sub_10017E10+39j
		xor	eax, eax
		add	esp, 4
		mov	dword_100377DC,	eax
		mov	dword_100377E0,	eax
		mov	dword_100377E4,	eax
		retn
sub_10017E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017E70	proc near		; DATA XREF: sub_10017EA0+10o
					; sub_10017FD0+9o ...
		call	sub_10017D20
		test	eax, eax
		jz	short loc_10017E7D
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10017E7D:				; CODE XREF: sub_10017E70+7j
		push	0
		push	offset sub_10017E10
		call	NSS_RegisterShutdown
		add	esp, 8
		neg	eax
		sbb	eax, eax
		retn
sub_10017E70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017EA0	proc near		; CODE XREF: sub_10006050+8Cp
					; SSL_ConfigServerSessionIDCache+3p ...

arg_0		= dword	ptr  4

		cmp	dword_100377F0,	0
		jnz	short loc_10017EDB
		cmp	[esp+arg_0], 0
		jz	short loc_10017EC8
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8
		neg	eax
		sbb	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10017EC8:				; CODE XREF: sub_10017EA0+Ej
		call	sub_10017D20
		test	eax, eax
		jnz	short loc_10017EDE
		mov	dword_100377F0,	1

loc_10017EDB:				; CODE XREF: sub_10017EA0+7j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10017EDE:				; CODE XREF: sub_10017EA0+2Fj
		or	eax, 0FFFFFFFFh
		retn
sub_10017EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017EF0	proc near		; CODE XREF: sub_10017FD0+35p
					; .text:10018082p ...
		mov	eax, 300h
		cmp	[esi+3Ah], ax
		jnb	short loc_10017F16
		lea	ecx, [esi+64h]
		push	0
		push	ecx
		call	SECITEM_ZfreeItem_Util
		lea	edx, [esi+74h]
		push	0
		push	edx
		call	SECITEM_ZfreeItem_Util
		add	esp, 10h
		jmp	short loc_10017F5E
; ---------------------------------------------------------------------------

loc_10017F16:				; CODE XREF: sub_10017EF0+9j
		cmp	dword ptr [esi+0FCh], 0
		jz	short loc_10017F30
		lea	eax, [esi+0F8h]
		push	0
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10017F30:				; CODE XREF: sub_10017EF0+2Dj
		cmp	dword ptr [esi+0E4h], 0
		jz	short loc_10017F4A
		lea	ecx, [esi+0E0h]
		push	0
		push	ecx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10017F4A:				; CODE XREF: sub_10017EF0+47j
		mov	eax, [esi+0ECh]
		test	eax, eax
		jz	short loc_10017F5E
		push	eax
		call	ds:PR_DestroyRWLock
		add	esp, 4

loc_10017F5E:				; CODE XREF: sub_10017EF0+24j
					; sub_10017EF0+62j
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	short loc_10017F6E
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10017F6E:				; CODE XREF: sub_10017EF0+73j
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_10017F7E
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_10017F7E:				; CODE XREF: sub_10017EF0+83j
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_10017F8E
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10017F8E:				; CODE XREF: sub_10017EF0+93j
		cmp	dword ptr [esi+14h], 0
		lea	eax, [esi+14h]
		jz	short loc_10017FA2
		push	0
		push	eax
		call	SECITEM_FreeArray
		add	esp, 8

loc_10017FA2:				; CODE XREF: sub_10017EF0+A5j
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10017FB2
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_10017FB2:				; CODE XREF: sub_10017EF0+B7j
		push	108h
		push	esi
		call	PORT_ZFree_Util
		add	esp, 8
		retn
sub_10017EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017FD0	proc near		; CODE XREF: sub_100066A0+149p
					; sub_10009320+239p ...

arg_0		= dword	ptr  4

		cmp	dword_100377F0,	0
		jnz	short loc_10017FEC
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8

loc_10017FEC:				; CODE XREF: sub_10017FD0+7j
		mov	eax, dword_100377EC
		push	esi
		push	eax
		call	ds:PR_Lock
		mov	esi, [esp+8+arg_0]
		add	esp, 4
		dec	dword ptr [esi+8]
		jnz	short loc_1001800A
		call	sub_10017EF0

loc_1001800A:				; CODE XREF: sub_10017FD0+33j
		mov	ecx, dword_100377EC
		pop	esi
		mov	[esp+arg_0], ecx
		jmp	ds:PR_Unlock
sub_10017FD0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10018020:				; DATA XREF: sub_10018460+24o
		cmp	dword_100377F0,	0
		jnz	short loc_1001803C
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8

loc_1001803C:				; CODE XREF: .text:10018027j
		mov	eax, dword_100377EC
		push	esi
		push	eax
		call	ds:PR_Lock
		mov	esi, [esp+0Ch]
		add	esp, 4
		cmp	dword ptr [esi+4], 1
		mov	ecx, offset dword_100377E8
		jnz	short loc_10018087
		mov	eax, dword_100377E8
		test	eax, eax
		jz	short loc_10018087

loc_10018064:				; CODE XREF: .text:1001806Ej
		cmp	eax, esi
		jz	short loc_10018072
		mov	ecx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_10018064
		jmp	short loc_10018087
; ---------------------------------------------------------------------------

loc_10018072:				; CODE XREF: .text:10018066j
		mov	edx, [esi]
		mov	[ecx], edx
		dec	dword ptr [esi+8]
		mov	dword ptr [esi+4], 3
		jnz	short loc_10018087
		call	sub_10017EF0

loc_10018087:				; CODE XREF: .text:10018059j
					; .text:10018062j ...
		mov	eax, dword_100377EC
		pop	esi
		mov	[esp+4], eax
		jmp	ds:PR_Unlock
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  23. SSL_ClearSessionCache

; =============== S U B	R O U T	I N E =======================================


		public SSL_ClearSessionCache
SSL_ClearSessionCache proc near		; DATA XREF: .rdata:off_10035848o
		cmp	dword_100377F0,	0
		jnz	short loc_100180BC
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8

loc_100180BC:				; CODE XREF: SSL_ClearSessionCache+7j
		mov	eax, dword_100377EC
		push	eax
		call	ds:PR_Lock
		mov	ecx, dword_100377E8
		add	esp, 4
		test	ecx, ecx
		jz	short loc_1001811E
		push	esi
		push	edi

loc_100180D7:				; CODE XREF: SSL_ClearSessionCache+7Aj
		cmp	dword ptr [ecx+4], 1
		lea	edi, [ecx+4]
		mov	esi, ecx
		mov	edx, offset dword_100377E8
		jnz	short loc_10018118
		mov	eax, ecx
		lea	esp, [esp+0]

loc_100180F0:				; CODE XREF: SSL_ClearSessionCache+5Aj
		cmp	eax, ecx
		jz	short loc_100180FE
		mov	edx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_100180F0
		jmp	short loc_10018118
; ---------------------------------------------------------------------------

loc_100180FE:				; CODE XREF: SSL_ClearSessionCache+52j
		mov	ecx, [ecx]
		mov	[edx], ecx
		dec	dword ptr [esi+8]
		mov	dword ptr [edi], 3
		jnz	short loc_10018112
		call	sub_10017EF0

loc_10018112:				; CODE XREF: SSL_ClearSessionCache+6Bj
		mov	ecx, dword_100377E8

loc_10018118:				; CODE XREF: SSL_ClearSessionCache+45j
					; SSL_ClearSessionCache+5Cj
		test	ecx, ecx
		jnz	short loc_100180D7
		pop	edi
		pop	esi

loc_1001811E:				; CODE XREF: SSL_ClearSessionCache+33j
		mov	edx, dword_100377EC
		push	edx
		call	ds:PR_Unlock
		pop	ecx
		retn
SSL_ClearSessionCache endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018130	proc near		; CODE XREF: sub_1000C350:loc_1000C380p
					; sub_1000CB90+398p ...
		push	0		; Time
		call	ds:time
		add	esp, 4
		retn
sub_10018130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018140	proc near		; CODE XREF: sub_10007010+24p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0ECh]
		test	eax, eax
		jz	short loc_10018173
		push	eax
		call	ds:PR_RWLock_Wlock
		add	esp, 4
		cmp	dword ptr [esi+0FCh], 0
		jz	short loc_10018173
		lea	eax, [esi+0F8h]
		push	0
		push	eax
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_10018173:				; CODE XREF: sub_10018140+Dj
					; sub_10018140+20j
		mov	eax, [esp+4+arg_4]
		mov	ecx, [eax]
		mov	[esi+0F0h], ecx
		mov	edx, [eax+4]
		mov	[esi+0F4h], edx
		mov	ecx, [eax+8]
		mov	[esi+0F8h], ecx
		mov	edx, [eax+0Ch]
		mov	[esi+0FCh], edx
		mov	ecx, [eax+10h]
		mov	[esi+100h], ecx
		mov	dword ptr [eax+0Ch], 0
		mov	dword ptr [eax+10h], 0
		mov	esi, [esi+0ECh]
		test	esi, esi
		jz	short loc_100181C5
		push	esi
		call	ds:PR_RWLock_Unlock
		add	esp, 4

loc_100181C5:				; CODE XREF: sub_10018140+79j
		pop	esi
		retn
sub_10018140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100181D0	proc near		; CODE XREF: sub_10009320+DCp
					; sub_100137A0+87p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		cmp	[esp+4+arg_C], 0
		jnz	short loc_100181DC
		xor	eax, eax
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100181DC:				; CODE XREF: sub_100181D0+6j
		push	0		; Time
		call	ds:time
		add	esp, 4
		cmp	dword_100377F0,	0
		mov	[esp+4+var_4], eax
		jnz	short loc_10018206
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8

loc_10018206:				; CODE XREF: sub_100181D0+21j
		mov	eax, dword_100377EC
		push	esi
		push	edi
		push	eax
		call	ds:PR_Lock
		mov	esi, dword_100377E8
		add	esp, 4
		mov	edi, offset dword_100377E8
		test	esi, esi
		jz	loc_10018358
		push	ebx
		mov	ebx, [esp+10h+arg_0]
		push	ebp
		mov	ebp, [esp+14h+arg_8]

loc_10018234:				; CODE XREF: sub_100181D0+174j
		mov	ecx, [esp+14h+var_4]
		cmp	[esi+40h], ecx
		jnb	short loc_1001825B
		mov	edx, [esi]
		mov	[edi], edx
		dec	dword ptr [esi+8]
		mov	dword ptr [esi+4], 3
		jnz	loc_10018340
		call	sub_10017EF0
		jmp	loc_10018340
; ---------------------------------------------------------------------------

loc_1001825B:				; CODE XREF: sub_100181D0+6Bj
		mov	edx, esi
		sub	edx, ebx
		mov	ecx, 10h
		mov	eax, ebx
		add	edx, 28h
		lea	esp, [esp+0]

loc_10018270:				; CODE XREF: sub_100181D0+B4j
		mov	edi, [edx+eax]
		cmp	edi, [eax]
		jnz	loc_1001833E
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_10018270
		mov	ax, [esp+14h+arg_4]
		cmp	[esi+38h], ax
		jnz	loc_1001833E
		test	ebp, ebp
		jnz	short loc_100182A3
		cmp	[esi+1Ch], ebp
		jz	short loc_100182D9
		jmp	loc_1001833E
; ---------------------------------------------------------------------------

loc_100182A3:				; CODE XREF: sub_100181D0+C7j
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	loc_1001833E
		mov	ecx, ebp

loc_100182B0:				; CODE XREF: sub_100181D0+FAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100182D0
		test	dl, dl
		jz	short loc_100182CC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100182D0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100182B0

loc_100182CC:				; CODE XREF: sub_100181D0+E8j
		xor	eax, eax
		jmp	short loc_100182D5
; ---------------------------------------------------------------------------

loc_100182D0:				; CODE XREF: sub_100181D0+E4j
					; sub_100181D0+F0j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100182D5:				; CODE XREF: sub_100181D0+FEj
		test	eax, eax
		jnz	short loc_1001833E

loc_100182D9:				; CODE XREF: sub_100181D0+CCj
		mov	ecx, 300h
		cmp	[esi+3Ah], cx
		jb	short loc_100182ED
		cmp	byte ptr [esi+0B3h], 0
		jz	short loc_1001833E

loc_100182ED:				; CODE XREF: sub_100181D0+112j
		mov	ecx, [esi+20h]
		test	ecx, ecx
		jz	short loc_1001833E
		mov	edi, [esp+14h+arg_C]
		mov	eax, edi
		lea	ebx, [ebx+0]

loc_10018300:				; CODE XREF: sub_100181D0+14Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10018320
		test	dl, dl
		jz	short loc_1001831C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10018320
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10018300

loc_1001831C:				; CODE XREF: sub_100181D0+138j
		xor	eax, eax
		jmp	short loc_10018325
; ---------------------------------------------------------------------------

loc_10018320:				; CODE XREF: sub_100181D0+134j
					; sub_100181D0+140j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10018325:				; CODE XREF: sub_100181D0+14Ej
		test	eax, eax
		jz	short loc_1001834C
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_1001833E
		push	edi
		push	eax
		call	CERT_VerifyCertName
		add	esp, 8
		test	eax, eax
		jz	short loc_1001834C

loc_1001833E:				; CODE XREF: sub_100181D0+A5j
					; sub_100181D0+BFj ...
		mov	edi, esi

loc_10018340:				; CODE XREF: sub_100181D0+7Bj
					; sub_100181D0+86j
		mov	esi, [edi]
		test	esi, esi
		jnz	loc_10018234
		jmp	short loc_10018356
; ---------------------------------------------------------------------------

loc_1001834C:				; CODE XREF: sub_100181D0+157j
					; sub_100181D0+16Cj
		mov	edx, [esp+14h+var_4]
		inc	dword ptr [esi+8]
		mov	[esi+0Ch], edx

loc_10018356:				; CODE XREF: sub_100181D0+17Aj
		pop	ebp
		pop	ebx

loc_10018358:				; CODE XREF: sub_100181D0+54j
		mov	eax, dword_100377EC
		push	eax
		call	ds:PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
sub_100181D0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10018370:				; DATA XREF: sub_10018460:loc_1001847Do
		push	esi
		mov	esi, [esp+8]
		cmp	dword ptr [esi+20h], 0
		jz	loc_1001845E
		mov	eax, 300h
		push	edi
		cmp	[esi+3Ah], ax
		jnb	short loc_10018393
		mov	edi, dword_100370FC
		jmp	short loc_100183E2
; ---------------------------------------------------------------------------

loc_10018393:				; CODE XREF: .text:10018389j
		mov	al, [esi+54h]
		test	al, al
		jnz	short loc_100183C5
		cmp	dword ptr [esi+0FCh], 0
		jz	loc_1001845D
		test	al, al
		jnz	short loc_100183C5
		lea	ecx, [esi+55h]
		push	20h
		push	ecx
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jnz	loc_1001845D
		mov	byte ptr [esi+54h], 20h

loc_100183C5:				; CODE XREF: .text:10018398j
					; .text:100183A9j
		mov	edi, dword_10037100
		push	0
		push	0
		call	ds:PR_NewRWLock
		add	esp, 8
		mov	[esi+0ECh], eax
		test	eax, eax
		jz	short loc_1001845D

loc_100183E2:				; CODE XREF: .text:10018391j
		cmp	dword ptr [esi+3Ch], 0
		jnz	short loc_100183F9
		push	0
		call	ds:time
		add	esp, 4
		mov	[esi+3Ch], eax
		mov	[esi+0Ch], eax

loc_100183F9:				; CODE XREF: .text:100183E6j
		cmp	dword ptr [esi+40h], 0
		jnz	short loc_10018407
		mov	edx, [esi+3Ch]
		add	edx, edi
		mov	[esi+40h], edx

loc_10018407:				; CODE XREF: .text:100183FDj
		cmp	dword_100377F0,	0
		jnz	short loc_10018423
		push	offset sub_10017E70
		push	offset dword_100377DC
		call	ds:PR_CallOnce
		add	esp, 8

loc_10018423:				; CODE XREF: .text:1001840Ej
		mov	eax, dword_100377EC
		push	eax
		call	ds:PR_Lock
		mov	edx, dword_100377EC
		add	esp, 4
		mov	eax, 1
		add	[esi+8], eax
		mov	[esi+4], eax
		mov	ecx, dword_100377E8
		mov	[esi], ecx
		pop	edi
		mov	dword_100377E8,	esi
		pop	esi
		mov	[esp+4], edx
		jmp	ds:PR_Unlock
; ---------------------------------------------------------------------------

loc_1001845D:				; CODE XREF: .text:100183A1j
					; .text:100183BBj ...
		pop	edi

loc_1001845E:				; CODE XREF: .text:10018379j
		pop	esi
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10018460	proc near		; CODE XREF: sub_100137A0+20p
					; sub_10014380+10p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+4], 0
		jz	short loc_1001847D
		mov	ecx, dword_10037E9C
		mov	[eax+3Ch], ecx
		mov	edx, dword_10037EA4
		mov	[eax+40h], edx
		retn
; ---------------------------------------------------------------------------

loc_1001847D:				; CODE XREF: sub_10018460+8j
		mov	dword ptr [eax+3Ch], offset loc_10018370
		mov	dword ptr [eax+40h], offset loc_10018020
		retn
sub_10018460	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  68. SSL_RevealCert

; =============== S U B	R O U T	I N E =======================================


		public SSL_RevealCert
SSL_RevealCert	proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		xor	esi, esi
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_100184B5
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_100184B5
		pop	esi
		mov	[esp+arg_0], eax
		jmp	CERT_DupCertificate
; ---------------------------------------------------------------------------

loc_100184B5:				; CODE XREF: SSL_RevealCert+12j
					; SSL_RevealCert+19j
		mov	eax, esi
		pop	esi
		retn
SSL_RevealCert	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  69. SSL_RevealPinArg

; =============== S U B	R O U T	I N E =======================================


		public SSL_RevealPinArg
SSL_RevealPinArg proc near		; CODE XREF: NSS_GetClientAuthData+13p
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		xor	esi, esi
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_100184DC
		mov	eax, [eax+22Ch]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100184DC:				; CODE XREF: SSL_RevealPinArg+12j
		mov	eax, esi
		pop	esi
		retn
SSL_RevealPinArg endp

; Exported entry  70. SSL_RevealURL

; =============== S U B	R O U T	I N E =======================================


		public SSL_RevealURL
SSL_RevealURL	proc near		; CODE XREF: SSL_GetNegotiatedHostInfo+88p
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		xor	esi, esi
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_10018508
		mov	eax, [eax+1D8h]
		test	eax, eax
		jz	short loc_10018508
		pop	esi
		mov	[esp+arg_0], eax
		jmp	PL_strdup
; ---------------------------------------------------------------------------

loc_10018508:				; CODE XREF: SSL_RevealURL+12j
					; SSL_RevealURL+1Cj
		mov	eax, esi
		pop	esi
		retn
SSL_RevealURL	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  45. SSL_HandshakeNegotiatedExtension

; =============== S U B	R O U T	I N E =======================================


		public SSL_HandshakeNegotiatedExtension
SSL_HandshakeNegotiatedExtension proc near ; DATA XREF:	.rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_8]
		test	edi, edi
		jnz	short loc_1001852B
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001852B:				; CODE XREF: SSL_HandshakeNegotiatedExtension+7j
		mov	eax, [esp+4+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10018545
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10018545:				; CODE XREF: SSL_HandshakeNegotiatedExtension+2Dj
		mov	dword ptr [edi], 0
		mov	eax, [esi+14h]
		test	al, 1
		jz	short loc_10018598
		cmp	dword ptr [esi+478h], 0
		jz	short loc_10018598
		test	eax, 10000h
		jnz	short loc_10018572
		mov	ecx, [esi+258h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10018572:				; CODE XREF: SSL_HandshakeNegotiatedExtension+50j
		mov	edx, [esp+8+arg_4]
		push	edx
		push	esi
		call	sub_10014AB0
		add	esp, 8
		mov	[edi], eax
		test	byte ptr [esi+16h], 1
		jnz	short loc_10018598
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10018598:				; CODE XREF: SSL_HandshakeNegotiatedExtension+40j
					; SSL_HandshakeNegotiatedExtension+49j	...
		pop	esi
		xor	eax, eax
		pop	edi
		retn
SSL_HandshakeNegotiatedExtension endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100185A0	proc near		; CODE XREF: sub_10007010+63p
					; sub_100199C0+84p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, 1
		xor	edx, edx
		mov	[eax+24h], ecx
		mov	[eax+28h], ecx
		mov	ecx, [eax+21Ch]
		mov	[eax+2A4h], edx
		mov	[eax+2A0h], edx
		cmp	ecx, edx
		jz	short locret_100185D6
		mov	edx, [eax+220h]
		mov	eax, [eax]
		push	edx
		push	eax
		call	ecx
		add	esp, 8

locret_100185D6:			; CODE XREF: sub_100185A0+25j
		retn
sub_100185A0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100185E0:				; DATA XREF: sub_10018600+Ao
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018600	proc near		; CODE XREF: sub_1000B3C0+3AFp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+24h], 0
		jnz	short locret_1001861E
		mov	dword ptr [eax+1DCh], offset loc_100185E0
		mov	dword ptr [eax+1E0h], 0

locret_1001861E:			; CODE XREF: sub_10018600+8j
		retn
sub_10018600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018620	proc near		; CODE XREF: SSL_ReHandshakeWithTimeout+Bp
					; SSL_ForceHandshakeWithTimeout+Bp
		push	esi
		push	edi
		push	eax
		mov	edi, ecx
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10018639
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018639:				; CODE XREF: sub_10018620+11j
		mov	eax, [esi+244h]
		push	ebx
		mov	ebx, ds:PR_Lock
		test	eax, eax
		jz	short loc_10018650
		push	eax
		call	ebx ; PR_Lock
		add	esp, 4

loc_10018650:				; CODE XREF: sub_10018620+28j
		test	dword ptr [esi+14h], 800h
		mov	[esi+238h], edi
		jz	short loc_1001866F
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001866F
		push	eax
		call	ebx ; PR_Lock
		add	esp, 4

loc_1001866F:				; CODE XREF: sub_10018620+3Dj
					; sub_10018620+47j
		test	dword ptr [esi+14h], 800h
		mov	[esi+23Ch], edi
		mov	edi, ds:PR_Unlock
		pop	ebx
		jz	short loc_10018695
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_10018695
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_10018695:				; CODE XREF: sub_10018620+63j
					; sub_10018620+6Dj
		mov	esi, [esi+244h]
		test	esi, esi
		jz	short loc_100186A5
		push	esi
		call	edi ; PR_Unlock
		add	esp, 4

loc_100186A5:				; CODE XREF: sub_10018620+7Dj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10018620	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  61. SSL_ReHandshake

; =============== S U B	R O U T	I N E =======================================


		public SSL_ReHandshake
SSL_ReHandshake	proc near		; CODE XREF: SSL_ReHandshakeWithTimeout+1Fp
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100186C9
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100186C9:				; CODE XREF: SSL_ReHandshake+12j
		mov	eax, [esi+14h]
		test	al, 1
		jnz	short loc_100186D4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100186D4:				; CODE XREF: SSL_ReHandshake+1Ej
		push	ebp
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	eax, 10000h
		jnz	short loc_100186EF
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_100186EF:				; CODE XREF: SSL_ReHandshake+31j
		mov	ebp, ds:PR_ExitMonitor
		mov	edx, 300h
		cmp	[esi+44h], dx
		jnb	short loc_10018712
		push	0FFFFD075h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10018746
; ---------------------------------------------------------------------------

loc_10018712:				; CODE XREF: SSL_ReHandshake+4Ej
		test	byte ptr [esi+16h], 1
		jnz	short loc_10018724
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10018724:				; CODE XREF: SSL_ReHandshake+66j
		mov	ecx, [esp+0Ch+arg_4]
		push	ecx
		push	esi
		call	sub_1000D070
		add	esp, 8
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_10018758
		mov	edx, [esi+258h]
		push	edx
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_10018746:				; CODE XREF: SSL_ReHandshake+60j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10018758
		mov	eax, [esi+254h]
		push	eax
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_10018758:				; CODE XREF: SSL_ReHandshake+88j
					; SSL_ReHandshake+9Aj
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		retn
SSL_ReHandshake	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  62. SSL_ReHandshakeWithTimeout

; =============== S U B	R O U T	I N E =======================================


		public SSL_ReHandshakeWithTimeout
SSL_ReHandshakeWithTimeout proc	near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, esi
		call	sub_10018620
		test	eax, eax
		jz	short loc_10018779
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018779:				; CODE XREF: SSL_ReHandshakeWithTimeout+12j
		mov	eax, [esp+4+arg_4]
		push	eax
		push	esi
		call	SSL_ReHandshake
		add	esp, 8
		pop	esi
		retn
SSL_ReHandshakeWithTimeout endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  44. SSL_HandshakeCallback

; =============== S U B	R O U T	I N E =======================================


		public SSL_HandshakeCallback
SSL_HandshakeCallback proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100187B8
		mov	eax, [esi+14h]
		test	al, 1
		jnz	short loc_100187BD
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_100187B8:				; CODE XREF: SSL_HandshakeCallback+12j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100187BD:				; CODE XREF: SSL_HandshakeCallback+19j
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	eax, 10000h
		jnz	short loc_100187D7
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_100187D7:				; CODE XREF: SSL_HandshakeCallback+39j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100187E9
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_100187E9:				; CODE XREF: SSL_HandshakeCallback+4Bj
		test	byte ptr [esi+16h], 1
		mov	eax, [esp+8+arg_4]
		mov	ecx, [esp+8+arg_8]
		mov	edi, ds:PR_ExitMonitor
		mov	[esi+21Ch], eax
		mov	[esi+220h], ecx
		jnz	short loc_10018827
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_10018827
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_10018827:				; CODE XREF: SSL_HandshakeCallback+77j
					; SSL_HandshakeCallback+89j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
SSL_HandshakeCallback endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  73. SSL_SetCanFalseStartCallback

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetCanFalseStartCallback
SSL_SetCanFalseStartCallback proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10018858
		mov	eax, [esi+14h]
		test	al, 1
		jnz	short loc_1001885D
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_10018858:				; CODE XREF: SSL_SetCanFalseStartCallback+12j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001885D:				; CODE XREF: SSL_SetCanFalseStartCallback+19j
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	eax, 10000h
		jnz	short loc_10018877
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10018877:				; CODE XREF: SSL_SetCanFalseStartCallback+39j
		test	byte ptr [esi+16h], 1
		jnz	short loc_10018889
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10018889:				; CODE XREF: SSL_SetCanFalseStartCallback+4Bj
		test	byte ptr [esi+16h], 1
		mov	eax, [esp+8+arg_4]
		mov	ecx, [esp+8+arg_8]
		mov	edi, ds:PR_ExitMonitor
		mov	[esi+224h], eax
		mov	[esi+228h], ecx
		jnz	short loc_100188C7
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_100188C7
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_100188C7:				; CODE XREF: SSL_SetCanFalseStartCallback+77j
					; SSL_SetCanFalseStartCallback+89j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
SSL_SetCanFalseStartCallback endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  63. SSL_RecommendedCanFalseStart

; =============== S U B	R O U T	I N E =======================================


		public SSL_RecommendedCanFalseStart
SSL_RecommendedCanFalseStart proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_4]
		push	eax
		mov	dword ptr [esi], 0
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_10018902
		cmp	dword ptr [eax+478h], 0
		jnz	short loc_10018907
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_10018902:				; CODE XREF: SSL_RecommendedCanFalseStart+1Aj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018907:				; CODE XREF: SSL_RecommendedCanFalseStart+23j
		mov	ecx, 300h
		cmp	[eax+44h], cx
		jnb	short loc_10018924
		push	0FFFFD075h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018924:				; CODE XREF: SSL_RecommendedCanFalseStart+40j
		mov	edx, [eax+808h]
		mov	eax, [edx]
		cmp	eax, 8
		jz	short loc_10018946
		cmp	eax, 0Ah
		jz	short loc_10018946
		cmp	eax, 10h
		jz	short loc_10018946
		cmp	eax, 12h
		jz	short loc_10018946
		xor	eax, eax
		mov	[esi], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10018946:				; CODE XREF: SSL_RecommendedCanFalseStart+5Fj
					; SSL_RecommendedCanFalseStart+64j ...
		mov	eax, 1
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
SSL_RecommendedCanFalseStart endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018960	proc near		; CODE XREF: sub_10002B90+1C3p
					; sub_10002B90+1E5p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		cmp	esi, 4800h
		ja	short loc_10018973
		mov	esi, 4800h

loc_10018973:				; CODE XREF: sub_10018960+Cj
		mov	edi, [esp+8+arg_0]
		cmp	esi, [edi+8]
		jbe	short loc_100189A5
		mov	eax, [edi]
		push	esi
		test	eax, eax
		jz	short loc_1001898E
		push	eax
		call	PORT_Realloc_Util
		add	esp, 8
		jmp	short loc_10018996
; ---------------------------------------------------------------------------

loc_1001898E:				; CODE XREF: sub_10018960+21j
		call	PORT_Alloc_Util
		add	esp, 4

loc_10018996:				; CODE XREF: sub_10018960+2Cj
		test	eax, eax
		jnz	short loc_100189A0
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100189A0:				; CODE XREF: sub_10018960+38j
		mov	[edi], eax
		mov	[edi+8], esi

loc_100189A5:				; CODE XREF: sub_10018960+1Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10018960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100189B0(int,	void *Src, size_t Size)
sub_100189B0	proc near		; CODE XREF: sub_10005490+1Bp
					; sub_10018A20+Ej

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+Size]
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, [edi+4]
		add	esi, ebx
		cmp	esi, 4800h
		ja	short loc_100189CD
		mov	esi, 4800h

loc_100189CD:				; CODE XREF: sub_100189B0+16j
		cmp	esi, [edi+8]
		jbe	short loc_100189F5
		mov	eax, [edi]
		push	esi
		test	eax, eax
		jz	short loc_100189E4
		push	eax
		call	PORT_Realloc_Util
		add	esp, 8
		jmp	short loc_100189EC
; ---------------------------------------------------------------------------

loc_100189E4:				; CODE XREF: sub_100189B0+27j
		call	PORT_Alloc_Util
		add	esp, 4

loc_100189EC:				; CODE XREF: sub_100189B0+32j
		test	eax, eax
		jz	short loc_10018A12
		mov	[edi], eax
		mov	[edi+8], esi

loc_100189F5:				; CODE XREF: sub_100189B0+20j
		mov	ecx, [edi]
		mov	eax, [esp+0Ch+Src]
		add	ecx, [edi+4]
		push	ebx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	[edi+4], ebx
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018A12:				; CODE XREF: sub_100189B0+3Ej
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_100189B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018A20	proc near		; CODE XREF: sub_10007C90+297p
					; sub_10007C90+2B2p ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		add	edx, 2E0h
		mov	[esp+arg_0], edx ; int
		jmp	sub_100189B0
sub_10018A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018A40	proc near		; CODE XREF: sub_10002830+83p
					; sub_10002830+1BBp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+2E4h]
		push	edi
		xor	edi, edi
		test	eax, eax
		jz	short loc_10018A91
		push	edi
		push	eax
		mov	eax, [esi+2E0h]
		push	eax
		push	esi
		call	sub_10014560
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		js	short loc_10018A93
		sub	[esi+2E4h], edi
		mov	eax, [esi+2E4h]
		jz	short loc_10018A91
		test	edi, edi
		jle	short loc_10018A91
		mov	esi, [esi+2E0h]
		push	eax		; Size
		lea	ecx, [esi+edi]
		push	ecx		; Src
		push	esi		; Dst
		call	ds:memmove
		add	esp, 0Ch

loc_10018A91:				; CODE XREF: sub_10018A40+10j
					; sub_10018A40+36j ...
		mov	eax, edi

loc_10018A93:				; CODE XREF: sub_10018A40+28j
		pop	edi
		pop	esi
		retn
sub_10018A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10018AA0(void	*Dst, size_t Size, char)
sub_10018AA0	proc near		; CODE XREF: sub_10019E10+138p

Dst		= dword	ptr  4
Size		= dword	ptr  8
arg_8		= byte ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+Size]
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_10018AD1
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10018AD1
		mov	ecx, [esi+24Ch]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10018AD1:				; CODE XREF: sub_10018AA0+12j
					; sub_10018AA0+23j
		mov	ecx, [esi+2A0h]
		mov	eax, [esi+2A4h]
		sub	eax, ecx
		jnz	short loc_10018B39
		mov	edx, 300h
		push	eax
		push	esi
		cmp	[esi+44h], dx
		jb	short loc_10018AF5
		call	sub_10010450
		jmp	short loc_10018AFA
; ---------------------------------------------------------------------------

loc_10018AF5:				; CODE XREF: sub_10018AA0+4Cj
		call	sub_100179F0

loc_10018AFA:				; CODE XREF: sub_10018AA0+53j
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jg	short loc_10018B17
		jz	short loc_10018B65
		cmp	edi, 0FFFFFFFEh
		jz	short loc_10018B17
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_10018B65

loc_10018B17:				; CODE XREF: sub_10018AA0+61j
					; sub_10018AA0+68j
		mov	ecx, [esi+2A0h]
		mov	eax, [esi+2A4h]
		sub	eax, ecx
		jnz	short loc_10018B39
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10018B65
; ---------------------------------------------------------------------------

loc_10018B39:				; CODE XREF: sub_10018AA0+3Fj
					; sub_10018AA0+85j
		mov	edi, ebp
		cmp	ebp, eax
		jl	short loc_10018B41
		mov	edi, eax

loc_10018B41:				; CODE XREF: sub_10018AA0+9Dj
		mov	eax, [esi+278h]
		add	eax, ecx
		mov	ecx, [esp+0Ch+Dst]
		push	edi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		test	[esp+0Ch+arg_8], 2
		jnz	short loc_10018B65
		add	[esi+2A0h], edi

loc_10018B65:				; CODE XREF: sub_10018AA0+63j
					; sub_10018AA0+75j ...
		mov	ebp, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_10018B8D
		mov	edx, [esi+24Ch]
		push	edx
		call	ebp ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10018B8D
		mov	eax, [esi+254h]
		push	eax
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_10018B8D:				; CODE XREF: sub_10018AA0+CEj
					; sub_10018AA0+DFj
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_10018AA0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   6. NSS_FindCertKEAType

; =============== S U B	R O U T	I N E =======================================


		public NSS_FindCertKEAType
NSS_FindCertKEAType proc near		; CODE XREF: SSL_ConfigSecureServerWithCertChain+73p
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		test	ecx, ecx
		jz	short locret_10018BE5
		add	ecx, 0D8h
		push	ecx
		call	SECOID_GetAlgorithmTag_Util
		add	eax, 0FFFFFFF0h
		add	esp, 4
		cmp	eax, 0B8h	; switch 185 cases
		ja	short loc_10018BE3 ; jumptable 10018BCA	default	case
		movzx	eax, ds:byte_10018BF8[eax]
		jmp	ds:off_10018BE8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10018BD1:				; CODE XREF: NSS_FindCertKEAType+2Aj
					; DATA XREF: .text:off_10018BE8o
		mov	eax, 1		; jumptable 10018BCA cases 0,81
		retn
; ---------------------------------------------------------------------------

loc_10018BD7:				; CODE XREF: NSS_FindCertKEAType+2Aj
					; DATA XREF: .text:off_10018BE8o
		mov	eax, 2		; jumptable 10018BCA case 158
		retn
; ---------------------------------------------------------------------------

loc_10018BDD:				; CODE XREF: NSS_FindCertKEAType+2Aj
					; DATA XREF: .text:off_10018BE8o
		mov	eax, 4		; jumptable 10018BCA case 184
		retn
; ---------------------------------------------------------------------------

loc_10018BE3:				; CODE XREF: NSS_FindCertKEAType+21j
					; NSS_FindCertKEAType+2Aj
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10018BCA default case

locret_10018BE5:			; CODE XREF: NSS_FindCertKEAType+8j
		retn
NSS_FindCertKEAType endp

; ---------------------------------------------------------------------------
		align 4
off_10018BE8	dd offset loc_10018BD1,	offset loc_10018BD7, offset loc_10018BDD
					; DATA XREF: NSS_FindCertKEAType+2Ar
		dd offset loc_10018BE3	; jump table for switch	statement
byte_10018BF8	db	0,     3,     3,     3 ; DATA XREF: NSS_FindCertKEAType+23r
		db	3,     3,     3,     3 ; indirect table	for switch statement
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     0,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     1,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	2
		align 10h

loc_10018CC0:				; DATA XREF: .text:10018D12o
		mov	eax, dword_10037648
		test	eax, eax
		jz	short loc_10018CDC
		push	eax
		call	CERT_FreeDistNames
		add	esp, 4
		mov	dword_10037648,	0

loc_10018CDC:				; CODE XREF: .text:10018CC7j
		mov	eax, ds:dword_1002E95C
		mov	ecx, ds:dword_1002E960
		mov	edx, ds:dword_1002E964
		mov	dword_100377F4,	eax
		mov	dword_100377F8,	ecx
		mov	dword_100377FC,	edx
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10018D10:				; DATA XREF: SSL_ConfigSecureServerWithCertChain+176o
		push	0
		push	offset loc_10018CC0
		call	NSS_RegisterShutdown
		add	esp, 8
		test	eax, eax
		jnz	short loc_10018D38
		mov	eax, [esp+4]
		push	eax
		call	CERT_GetSSLCACerts
		add	esp, 4
		mov	dword_10037648,	eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10018D38:				; CODE XREF: .text:10018D21j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018D40	proc near		; CODE XREF: SSL_ConfigSecureServerWithCertChain+162p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		mov	ecx, [esp+arg_0]
		push	ebx
		push	ebp
		add	eax, eax
		push	esi
		lea	esi, [ecx+eax*8+2ECh]
		mov	eax, [esi]
		push	edi
		xor	ebp, ebp
		xor	edi, edi
		cmp	eax, ebp
		jz	short loc_10018D6D
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi], ebp
		mov	[esi+0Ch], ebp

loc_10018D6D:				; CODE XREF: sub_10018D40+1Dj
		mov	eax, [esi+4]
		cmp	eax, ebp
		jz	short loc_10018D80
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4
		mov	[esi+4], ebp

loc_10018D80:				; CODE XREF: sub_10018D40+32j
		mov	eax, [esp+10h+arg_4]
		mov	ebx, [esp+10h+arg_C]
		cmp	eax, ebp
		jz	short loc_10018DCF
		push	eax
		call	CERT_DupCertificate
		mov	[esi], eax
		mov	edx, [ebx+4]
		push	edx
		call	SECKEY_PublicKeyStrengthInBits
		mov	[esi+0Ch], eax
		mov	eax, [esp+18h+arg_8]
		add	esp, 8
		cmp	eax, ebp
		jnz	loc_10018E39
		mov	eax, [esi]
		push	1
		push	1
		push	eax
		call	CERT_CertChainFromCert
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebp
		jz	loc_10018E51

loc_10018DC8:				; CODE XREF: sub_10018D40+102j
		mov	[esi+4], eax
		cmp	eax, ebp
		jz	short loc_10018E44

loc_10018DCF:				; CODE XREF: sub_10018D40+4Aj
		mov	eax, [esi+8]
		cmp	eax, ebp
		jz	short loc_10018DE2
		push	eax
		call	sub_100074E0
		add	esp, 4
		mov	[esi+8], ebp

loc_10018DE2:				; CODE XREF: sub_10018D40+94j
		cmp	ebx, ebp
		jz	short loc_10018DFA
		mov	ecx, [ebx]
		push	ecx
		call	SECKEY_CacheStaticFlags
		push	ebx
		call	sub_100074C0
		add	esp, 8
		mov	[esi+8], eax

loc_10018DFA:				; CODE XREF: sub_10018D40+A4j
		cmp	[esp+10h+arg_10], 1
		jnz	short loc_10018E32
		cmp	[esp+10h+arg_4], ebp
		jz	short loc_10018E32
		cmp	dword ptr [esi+0Ch], 200h
		jbe	short loc_10018E32
		mov	eax, [esp+10h+arg_0]
		test	dword ptr [eax+14h], 4000h
		jnz	short loc_10018E32
		cmp	[eax+1F8h], ebp
		jnz	short loc_10018E32
		push	eax
		call	sub_10007520
		add	esp, 4
		test	eax, eax
		jnz	short loc_10018E51

loc_10018E32:				; CODE XREF: sub_10018D40+BFj
					; sub_10018D40+C5j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018E39:				; CODE XREF: sub_10018D40+69j
		push	eax
		call	CERT_DupCertList
		add	esp, 4
		jmp	short loc_10018DC8
; ---------------------------------------------------------------------------

loc_10018E44:				; CODE XREF: sub_10018D40+8Dj
		cmp	edi, ebp
		jz	short loc_10018E51
		push	edi
		call	CERT_DestroyCertificateList
		add	esp, 4

loc_10018E51:				; CODE XREF: sub_10018D40+82j
					; sub_10018D40+F0j ...
		mov	eax, [esi]
		cmp	eax, ebp
		jz	short loc_10018E62
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi], ebp

loc_10018E62:				; CODE XREF: sub_10018D40+115j
		mov	eax, [esi+4]
		cmp	eax, ebp
		jz	short loc_10018E75
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4
		mov	[esi+4], ebp

loc_10018E75:				; CODE XREF: sub_10018D40+127j
		mov	eax, [esi+8]
		cmp	eax, ebp
		jz	short loc_10018E88
		push	eax
		call	sub_100074E0
		add	esp, 4
		mov	[esi+8], ebp

loc_10018E88:				; CODE XREF: sub_10018D40+13Aj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_10018D40	endp

; Exported entry  26. SSL_ConfigSecureServerWithCertChain

; =============== S U B	R O U T	I N E =======================================


		public SSL_ConfigSecureServerWithCertChain
SSL_ConfigSecureServerWithCertChain proc near ;	CODE XREF: SSL_ConfigSecureServer+16p
					; DATA XREF: .rdata:off_10035848o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_0]
		push	ebx
		push	esi
		xor	ebx, ebx
		push	eax
		mov	[esp+18h+var_C], ebx
		mov	[esp+18h+var_8], 0FFFFFFFFh
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		mov	[esp+14h+var_4], esi
		cmp	esi, ebx
		jnz	short loc_10018EC3
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10018EC3:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+28j
		push	ebp
		mov	ebp, [esp+18h+arg_4]
		xor	ecx, ecx
		cmp	ebp, ebx
		setz	cl
		push	edi
		mov	edi, [esp+1Ch+arg_C]
		xor	edx, edx
		test	edi, edi
		setz	dl
		cmp	ecx, edx
		jz	short loc_10018EF7
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10018EF7:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+4Dj
		cmp	[esp+1Ch+arg_10], 4
		ja	loc_1001904B
		push	ebp
		call	NSS_FindCertKEAType
		add	esp, 4
		cmp	[esp+1Ch+arg_10], eax
		jz	short loc_10018F29
		push	0FFFFD058h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10018F29:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+7Fj
		test	ebp, ebp
		jz	short loc_10018F42
		push	ebp
		call	CERT_ExtractPublicKey
		add	esp, 4
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jz	loc_10019058

loc_10018F42:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+9Bj
		test	edi, edi
		jz	loc_10018FE5
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_10018F76
		push	eax
		call	PK11_ReferenceSlot
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_10018F76
		push	edi
		push	ebx
		call	PK11_CopyTokenPrivKeyToSessionPrivKey
		push	ebx
		mov	esi, eax
		call	PK11_FreeSlot
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10018FBD

loc_10018F76:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+BFj
					; SSL_ConfigSecureServerWithCertChain+CEj
		mov	eax, [edi+4]
		push	eax
		call	PK11_MapSignKeyType
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10018FAE
		push	0
		push	eax
		call	PK11_GetBestSlot
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_10018FAE
		push	edi
		push	ebx
		call	PK11_CopyTokenPrivKeyToSessionPrivKey
		push	ebx
		mov	esi, eax
		call	PK11_FreeSlot
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10018FBD

loc_10018FAE:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+F5j
					; SSL_ConfigSecureServerWithCertChain+106j
		push	edi
		call	SECKEY_CopyPrivateKey
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1001902E

loc_10018FBD:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+E4j
					; SSL_ConfigSecureServerWithCertChain+11Cj
		mov	ecx, [esp+1Ch+var_C]
		push	ecx
		push	esi
		call	sub_10007470
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_10018FD9
		push	esi
		call	SECKEY_DestroyPrivateKey
		jmp	short loc_1001902B
; ---------------------------------------------------------------------------

loc_10018FD9:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+13Fj
		mov	esi, [esp+1Ch+var_4]
		mov	[esp+1Ch+var_C], 0

loc_10018FE5:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+B4j
		mov	edx, [esp+1Ch+arg_10]
		mov	eax, [esp+1Ch+arg_8]
		push	edx
		push	ebx
		push	eax
		push	ebp
		push	esi
		call	sub_10018D40
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10019021
		mov	ecx, [esi+260h]
		push	ecx
		push	offset loc_10018D10
		push	offset dword_100377F4
		call	ds:PR_CallOnceWithArg
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10019021
		mov	[esp+1Ch+var_8], eax

loc_10019021:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+16Dj
					; SSL_ConfigSecureServerWithCertChain+18Bj
		test	ebx, ebx
		jz	short loc_1001902E
		push	ebx
		call	sub_100074E0

loc_1001902B:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+147j
		add	esp, 4

loc_1001902E:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+12Bj
					; SSL_ConfigSecureServerWithCertChain+193j
		mov	eax, [esp+1Ch+var_C]
		test	eax, eax
		jz	short loc_1001903F
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_1001903F:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+1A4j
		mov	eax, [esp+1Ch+var_8]
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001904B:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+6Cj
		push	0FFFFE030h
		call	PORT_SetError_Util
		add	esp, 4

loc_10019058:				; CODE XREF: SSL_ConfigSecureServerWithCertChain+ACj
		pop	edi
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
SSL_ConfigSecureServerWithCertChain endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019070	proc near		; CODE XREF: SSL_ResetHandshake+144p
					; sub_1001EB40+1D6p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		call	sub_10011CB0
		add	esp, 4
		test	byte ptr [esi+16h], 1
		mov	dword ptr [esi+0CCh], 1
		mov	dword ptr [esi+0C8h], 0
		jnz	short loc_100190A9
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100190A9:				; CODE XREF: sub_10019070+27j
		mov	edi, 4800h
		cmp	[esi+58h], edi
		jnb	short loc_100190DD
		mov	eax, [esi+50h]
		push	edi
		test	eax, eax
		jz	short loc_100190C6
		push	eax
		call	PORT_Realloc_Util
		add	esp, 8
		jmp	short loc_100190CE
; ---------------------------------------------------------------------------

loc_100190C6:				; CODE XREF: sub_10019070+49j
		call	PORT_Alloc_Util
		add	esp, 4

loc_100190CE:				; CODE XREF: sub_10019070+54j
		test	eax, eax
		jnz	short loc_100190D7
		or	edi, 0FFFFFFFFh
		jmp	short loc_100190DF
; ---------------------------------------------------------------------------

loc_100190D7:				; CODE XREF: sub_10019070+60j
		mov	[esi+50h], eax
		mov	[esi+58h], edi

loc_100190DD:				; CODE XREF: sub_10019070+41j
		xor	edi, edi

loc_100190DF:				; CODE XREF: sub_10019070+65j
		test	byte ptr [esi+16h], 1
		jnz	short loc_100190F5
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100190F5:				; CODE XREF: sub_10019070+73j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_10019070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019100	proc near		; CODE XREF: sub_1001ED60+33Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		mov	eax, [esi+48h]
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	[edi+48h], eax
		mov	ecx, [esi+4Ch]
		mov	[edi+4Ch], ecx
		mov	edx, [esi+60h]
		mov	[edi+60h], edx
		mov	eax, [esi+64h]
		mov	[edi+64h], eax
		mov	ecx, [esi+6Ch]
		push	ecx
		call	CERT_DupCertificate
		add	esp, 4
		mov	[edi+6Ch], eax
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_1001913F
		test	eax, eax
		jz	loc_10019203

loc_1001913F:				; CODE XREF: sub_10019100+35j
		mov	edx, [esi+84h]
		mov	[edi+84h], edx
		mov	eax, [esi+88h]
		mov	[edi+88h], eax
		mov	ecx, [esi+8Ch]
		mov	[edi+8Ch], ecx
		mov	edx, [esi+90h]
		mov	[edi+90h], edx
		cmp	dword ptr [esi+94h], 0
		jz	short loc_100191B7
		cmp	dword ptr [esi+98h], 0
		jz	short loc_100191B7
		mov	eax, [esi+94h]
		mov	[edi+94h], eax
		mov	ecx, [esi+94h]
		mov	edx, [esi+98h]
		mov	eax, [ecx+8]
		push	edx
		call	eax
		add	esp, 4
		mov	[edi+98h], eax
		cmp	dword ptr [esi+98h], 0
		jz	short loc_100191CB
		test	eax, eax
		jz	short loc_10019203
		jmp	short loc_100191CB
; ---------------------------------------------------------------------------

loc_100191B7:				; CODE XREF: sub_10019100+76j
					; sub_10019100+7Fj
		mov	dword ptr [edi+94h], 0
		mov	dword ptr [edi+98h], 0

loc_100191CB:				; CODE XREF: sub_10019100+AFj
					; sub_10019100+B5j
		lea	ecx, [esi+9Ch]
		push	ecx
		lea	edx, [edi+9Ch]
		push	edx
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10019203
		lea	eax, [esi+0A8h]
		push	eax
		lea	ecx, [edi+0A8h]
		push	ecx
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10019209

loc_10019203:				; CODE XREF: sub_10019100+39j
					; sub_10019100+B3j ...
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019209:				; CODE XREF: sub_10019100+101j
		mov	edx, [esi+0B4h]
		mov	[edi+0B4h], edx
		mov	eax, [esi+0B8h]
		mov	[edi+0B8h], eax
		mov	dword ptr [edi+0C4h], 0
		mov	ecx, [esi+0BCh]
		mov	[edi+0BCh], ecx
		mov	edx, [esi+0C0h]
		mov	[edi+0C0h], edx
		mov	eax, [esi+0C8h]
		mov	[edi+0C8h], eax
		mov	ecx, [esi+0CCh]
		mov	[edi+0CCh], ecx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10019100	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019260	proc near		; CODE XREF: sub_10019350+8p
					; SSL_ResetHandshake+13Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+4Ch]
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_10019288
		mov	ecx, [esi+50h]
		cmp	ecx, edi
		jz	short loc_10019288
		mov	eax, [eax+0Ch]
		push	1
		push	ecx
		call	eax
		add	esp, 8
		mov	[esi+50h], edi
		mov	[esi+4Ch], edi

loc_10019288:				; CODE XREF: sub_10019260+Ej
					; sub_10019260+15j
		lea	ecx, [esi+54h]
		push	edi
		push	ecx
		call	SECITEM_ZfreeItem_Util
		lea	edx, [esi+60h]
		push	edi
		push	edx
		call	SECITEM_ZfreeItem_Util
		mov	eax, [esi+7Ch]
		add	esp, 10h
		cmp	eax, edi
		jz	short loc_100192C2
		mov	ecx, [esi+6Ch]
		push	1
		push	ecx
		call	eax
		mov	edx, [esi+70h]
		mov	eax, [esi+7Ch]
		push	1
		push	edx
		call	eax
		add	esp, 10h
		mov	[esi+6Ch], edi
		mov	[esi+70h], edi

loc_100192C2:				; CODE XREF: sub_10019260+44j
		mov	eax, [esi+20h]
		mov	[esi+6Ch], edi
		mov	[esi+70h], edi
		cmp	eax, edi
		jz	short loc_100192DB
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi+20h], edi

loc_100192DB:				; CODE XREF: sub_10019260+6Dj
		mov	eax, [esi+24h]
		cmp	eax, edi
		jz	short loc_100192EE
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4
		mov	[esi+24h], edi

loc_100192EE:				; CODE XREF: sub_10019260+80j
		mov	eax, [esi+28h]
		cmp	eax, edi
		jz	short loc_10019301
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4
		mov	[esi+28h], edi

loc_10019301:				; CODE XREF: sub_10019260+93j
		mov	eax, [esi+0ACh]
		cmp	eax, edi
		jz	short loc_10019314
		push	eax
		call	sub_10017FD0
		add	esp, 4

loc_10019314:				; CODE XREF: sub_10019260+A9j
		mov	ecx, [esi+90h]
		mov	edx, [esi+88h]
		lea	ebx, [esi+88h]
		push	ecx
		push	edx
		call	PORT_ZFree_Util
		add	esp, 8
		cmp	[esp+0Ch+arg_4], edi
		jz	short loc_10019345
		push	108h		; Size
		push	edi		; Val
		push	ebx		; Dst
		call	memset
		add	esp, 0Ch

loc_10019345:				; CODE XREF: sub_10019260+D4j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10019260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019350(void	*Dst)
sub_10019350	proc near		; CODE XREF: sub_1001C250+7p

Dst		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Dst]
		push	0
		push	esi
		call	sub_10019260
		mov	eax, [esi+10h]
		mov	ecx, [esi+8]
		push	eax
		push	ecx
		call	PORT_ZFree_Util
		push	190h		; Size
		push	0		; Val
		push	esi		; Dst
		mov	dword ptr [esi+8], 0
		call	memset
		add	esp, 1Ch
		pop	esi
		retn
sub_10019350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019390	proc near		; DATA XREF: .rdata:off_1002E9DCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		test	byte ptr [esi+14h], 40h
		mov	eax, [esi]
		mov	eax, [eax+8]
		push	edi
		jz	short loc_100193B7
		mov	dword ptr [esi+1E4h], offset sub_10014380
		mov	dword ptr [esi+270h], 2
		jmp	short loc_100193CB
; ---------------------------------------------------------------------------

loc_100193B7:				; CODE XREF: sub_10019390+Fj
		mov	dword ptr [esi+1E4h], offset sub_100137A0
		mov	dword ptr [esi+270h], 1

loc_100193CB:				; CODE XREF: sub_10019390+25j
		mov	edx, [esi+240h]
		mov	ecx, [eax]
		push	edx
		mov	edx, [esp+0Ch+arg_4]
		push	edx
		push	eax
		mov	eax, [ecx+30h]
		call	eax
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_100193F7
		call	ds:PR_GetError
		cmp	eax, 0FFFFE8A0h
		mov	eax, edi
		jnz	short loc_100193FE

loc_100193F7:				; CODE XREF: sub_10019390+56j
		mov	dword ptr [esi+38h], 1

loc_100193FE:				; CODE XREF: sub_10019390+65j
		pop	edi
		pop	esi
		retn
sub_10019390	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019410	proc near		; DATA XREF: .rdata:1002E9F0o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, 300h
		cmp	[esi+44h], ax
		jb	short loc_10019463
		test	byte ptr [esi+268h], 2
		jnz	short loc_10019463
		cmp	dword ptr [esi+24h], 0
		jz	short loc_10019463
		cmp	dword ptr [esi+34h], 0
		jnz	short loc_10019463
		cmp	dword ptr [esi+478h], 0
		jz	short loc_10019463
		cmp	dword ptr [esi+20h], 0
		jnz	short loc_10019456
		push	0
		push	esi
		call	sub_1001C4B0
		add	esp, 8
		mov	dword ptr [esi+20h], 1

loc_10019456:				; CODE XREF: sub_10019410+32j
		push	0
		push	1
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_10019463:				; CODE XREF: sub_10019410+Ej
					; sub_10019410+17j ...
		push	esi
		call	sub_10014750
		add	esp, 4
		pop	esi
		retn
sub_10019410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019470	proc near		; DATA XREF: .rdata:1002E9ECo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi]
		push	edi
		mov	edi, [eax+8]
		lea	ebx, [ebp+1]
		cmp	ebp, 2
		jbe	short loc_1001949E
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001949E:				; CODE XREF: sub_10019470+17j
		test	bl, 2
		jz	short loc_100194D9
		mov	ecx, 300h
		cmp	[esi+44h], cx
		jb	short loc_100194D9
		test	byte ptr [esi+268h], 2
		jnz	short loc_100194D9
		cmp	dword ptr [esi+24h], 0
		jz	short loc_100194D9
		cmp	dword ptr [esi+34h], 0
		jnz	short loc_100194D9
		cmp	dword ptr [esi+478h], 0
		jz	short loc_100194D9
		push	0
		push	1
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_100194D9:				; CODE XREF: sub_10019470+31j
					; sub_10019470+3Cj ...
		mov	edx, [edi]
		mov	eax, [edx+40h]
		push	ebp
		push	edi
		call	eax
		or	[esi+268h], bx
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10019470	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  14. SSL_BadCertHook

; =============== S U B	R O U T	I N E =======================================


		public SSL_BadCertHook
SSL_BadCertHook	proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jnz	short loc_10019515
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10019515:				; CODE XREF: SSL_BadCertHook+Fj
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	[eax+214h], ecx
		mov	[eax+218h], edx
		xor	eax, eax
		retn
SSL_BadCertHook	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  82. SSL_SetURL

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetURL
SSL_SetURL	proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	ebp
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		xor	ebp, ebp
		test	esi, esi
		jnz	short loc_1001954D
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001954D:				; CODE XREF: SSL_SetURL+15j
		push	ebx
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_10019579
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019579
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019579:				; CODE XREF: SSL_SetURL+2Aj
					; SSL_SetURL+3Bj
		mov	eax, [esi+1D8h]
		test	eax, eax
		jz	short loc_1001958C
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001958C:				; CODE XREF: SSL_SetURL+51j
		mov	eax, [esp+10h+arg_4]
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4
		mov	[esi+1D8h], eax
		test	eax, eax
		jnz	short loc_100195A6
		or	ebp, 0FFFFFFFFh

loc_100195A6:				; CODE XREF: SSL_SetURL+71j
		mov	edi, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_100195CE
		mov	ecx, [esi+258h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_100195CE
		mov	edx, [esi+254h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_100195CE:				; CODE XREF: SSL_SetURL+7Fj
					; SSL_SetURL+90j
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, ebp
		pop	ebp
		retn
SSL_SetURL	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  81. SSL_SetTrustAnchors

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetTrustAnchors
SSL_SetTrustAnchors proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		mov	eax, [esp+8+arg_4]
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001960A
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_10019605:				; CODE XREF: SSL_SetTrustAnchors+2Cj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001960A:				; CODE XREF: SSL_SetTrustAnchors+16j
		test	esi, esi
		jz	short loc_10019605
		push	edi
		push	eax
		call	CERT_DistNamesFromCertList
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10019624
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019624:				; CODE XREF: SSL_SetTrustAnchors+3Cj
		push	ebx
		mov	bl, 1
		push	ebp
		mov	ebp, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_10019650
		mov	ecx, [esi+254h]
		push	ecx
		call	ebp ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019650
		mov	edx, [esi+258h]
		push	edx
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019650:				; CODE XREF: SSL_SetTrustAnchors+51j
					; SSL_SetTrustAnchors+62j
		mov	eax, [esi+474h]
		test	eax, eax
		jz	short loc_10019663
		push	eax
		call	CERT_FreeDistNames
		add	esp, 4

loc_10019663:				; CODE XREF: SSL_SetTrustAnchors+78j
		mov	[esi+474h], edi
		mov	edi, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_10019683
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl

loc_10019683:				; CODE XREF: SSL_SetTrustAnchors+92j
		pop	ebp
		pop	ebx
		jnz	short loc_10019693
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_10019693:				; CODE XREF: SSL_SetTrustAnchors+A5j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
SSL_SetTrustAnchors endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  29. SSL_DataPending

; =============== S U B	R O U T	I N E =======================================


		public SSL_DataPending
SSL_DataPending	proc near		; CODE XREF: sub_1001DF80+11Ep
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		push	eax
		xor	edi, edi
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100196F7
		mov	eax, [esi+14h]
		test	al, 1
		jz	short loc_100196F7
		test	eax, 10000h
		jnz	short loc_100196D5
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_100196D5:				; CODE XREF: SSL_DataPending+23j
		mov	edi, [esi+2A4h]
		sub	edi, [esi+2A0h]
		test	byte ptr [esi+16h], 1
		jnz	short loc_100196F7
		mov	edx, [esi+24Ch]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_100196F7:				; CODE XREF: SSL_DataPending+15j
					; SSL_DataPending+1Cj ...
		mov	eax, edi
		pop	edi
		pop	esi
		retn
SSL_DataPending	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  49. SSL_InvalidateSession

; =============== S U B	R O U T	I N E =======================================


		public SSL_InvalidateSession
SSL_InvalidateSession proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	ebp
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		or	ebp, 0FFFFFFFFh
		test	esi, esi
		jz	short loc_1001978F
		push	ebx
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_10019744
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019744
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019744:				; CODE XREF: SSL_InvalidateSession+25j
					; SSL_InvalidateSession+36j
		mov	ecx, [esi+0F4h]
		test	ecx, ecx
		jz	short loc_10019760
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_10019760
		push	ecx
		call	eax
		add	esp, 4
		xor	ebp, ebp

loc_10019760:				; CODE XREF: SSL_InvalidateSession+4Cj
					; SSL_InvalidateSession+56j
		mov	edi, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_10019788
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019788
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_10019788:				; CODE XREF: SSL_InvalidateSession+69j
					; SSL_InvalidateSession+7Aj
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001978F:				; CODE XREF: SSL_InvalidateSession+16j
		pop	esi
		mov	eax, ebp
		pop	ebp
		retn
SSL_InvalidateSession endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  42. SSL_GetSessionID

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetSessionID
SSL_GetSessionID proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		push	eax
		xor	edi, edi
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_10019881
		push	ebx
		mov	bl, 1
		push	ebp
		mov	ebp, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_100197E7
		mov	ecx, [esi+254h]
		push	ecx
		call	ebp ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_100197E7
		mov	edx, [esi+258h]
		push	edx
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_100197E7:				; CODE XREF: SSL_GetSessionID+28j
					; SSL_GetSessionID+39j
		test	[esi+14h], bl
		jz	short loc_10019852
		cmp	[esi+24h], edi
		jz	short loc_10019852
		cmp	[esi+0F4h], edi
		jz	short loc_10019852
		push	0Ch
		call	PORT_Alloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_10019852
		mov	ebp, [esi+0F4h]
		mov	eax, 300h
		cmp	[ebp+3Ah], ax
		jnb	short loc_10019831
		push	10h
		mov	dword ptr [edi+8], 10h
		call	PORT_Alloc_Util
		mov	ecx, [edi+8]
		push	ecx
		add	ebp, 54h
		jmp	short loc_10019845
; ---------------------------------------------------------------------------

loc_10019831:				; CODE XREF: SSL_GetSessionID+78j
		movzx	eax, byte ptr [ebp+54h]
		push	eax
		mov	[edi+8], eax
		call	PORT_Alloc_Util
		mov	edx, [edi+8]
		push	edx		; Size
		add	ebp, 55h

loc_10019845:				; CODE XREF: SSL_GetSessionID+8Fj
		push	ebp		; Src
		push	eax		; Dst
		mov	[edi+4], eax
		call	memcpy
		add	esp, 10h

loc_10019852:				; CODE XREF: SSL_GetSessionID+4Aj
					; SSL_GetSessionID+4Fj	...
		mov	ebp, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_1001987A
		mov	eax, [esi+258h]
		push	eax
		call	ebp ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001987A
		mov	ecx, [esi+254h]
		push	ecx
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_1001987A:				; CODE XREF: SSL_GetSessionID+BBj
					; SSL_GetSessionID+CCj
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019881:				; CODE XREF: SSL_GetSessionID+15j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
SSL_GetSessionID endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. SSL_CertDBHandleSet

; =============== S U B	R O U T	I N E =======================================


		public SSL_CertDBHandleSet
SSL_CertDBHandleSet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jz	short loc_100198B6
		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jnz	short loc_100198BA
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_100198B6:				; CODE XREF: SSL_CertDBHandleSet+Fj
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100198BA:				; CODE XREF: SSL_CertDBHandleSet+17j
		mov	[eax+260h], ecx
		xor	eax, eax
		retn
SSL_CertDBHandleSet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  66. SSL_RestartHandshakeAfterCertReq
; Exported entry  67. SSL_RestartHandshakeAfterServerCert

; =============== S U B	R O U T	I N E =======================================


		public SSL_RestartHandshakeAfterServerCert
SSL_RestartHandshakeAfterServerCert proc near ;	DATA XREF: .rdata:off_10035848o
		push	0FFFFE898h	; SSL_RestartHandshakeAfterCertReq
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
SSL_RestartHandshakeAfterServerCert endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  12. SSL_AuthCertificateComplete

; =============== S U B	R O U T	I N E =======================================


		public SSL_AuthCertificateComplete
SSL_AuthCertificateComplete proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10019909
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019909:				; CODE XREF: SSL_AuthCertificateComplete+12j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001991F
		mov	ecx, [esi+254h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001991F:				; CODE XREF: SSL_AuthCertificateComplete+1Dj
		cmp	dword ptr [esi+478h], 0
		push	edi
		jnz	short loc_1001993B
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10019968
; ---------------------------------------------------------------------------

loc_1001993B:				; CODE XREF: SSL_AuthCertificateComplete+37j
		mov	edx, 300h
		cmp	[esi+44h], dx
		jnb	short loc_10019958
		push	0FFFFD075h
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		jmp	short loc_10019968
; ---------------------------------------------------------------------------

loc_10019958:				; CODE XREF: SSL_AuthCertificateComplete+54j
		mov	eax, [esp+8+arg_4]
		push	eax
		push	esi
		call	sub_1000C7F0
		add	esp, 8
		mov	edi, eax

loc_10019968:				; CODE XREF: SSL_AuthCertificateComplete+49j
					; SSL_AuthCertificateComplete+66j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001997E
		mov	ecx, [esi+254h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001997E:				; CODE XREF: SSL_AuthCertificateComplete+7Cj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
SSL_AuthCertificateComplete endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  71. SSL_SNISocketConfigHook

; =============== S U B	R O U T	I N E =======================================


		public SSL_SNISocketConfigHook
SSL_SNISocketConfigHook	proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_1001C160
		add	esp, 4
		test	eax, eax
		jnz	short loc_100199A5
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100199A5:				; CODE XREF: SSL_SNISocketConfigHook+Fj
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	[eax+20Ch], ecx
		mov	[eax+210h], edx
		xor	eax, eax
		retn
SSL_SNISocketConfigHook	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100199C0	proc near		; CODE XREF: SSL_ForceHandshake+123p
					; sub_10019E10+F6p ...

arg_0		= dword	ptr  4

		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		xor	ebp, ebp
		xor	edi, edi
		jmp	short loc_100199D0
; ---------------------------------------------------------------------------
		align 10h

loc_100199D0:				; CODE XREF: sub_100199C0+Bj
					; sub_100199C0+53j
		mov	eax, [esi+1DCh]
		cmp	eax, ebp
		jnz	short loc_10019A08
		mov	eax, [esi+1E0h]
		mov	[esi+1DCh], eax
		mov	[esi+1E0h], ebp
		cmp	eax, ebp
		jnz	short loc_10019A08
		mov	ecx, [esi+1E4h]
		mov	eax, ecx
		mov	[esi+1DCh], ecx
		mov	[esi+1E4h], ebp
		cmp	eax, ebp
		jz	short loc_10019A17

loc_10019A08:				; CODE XREF: sub_100199C0+18j
					; sub_100199C0+2Ej
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 4
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100199D0
		jmp	short loc_10019A62
; ---------------------------------------------------------------------------

loc_10019A17:				; CODE XREF: sub_100199C0+46j
		cmp	[esi+24h], ebp
		jnz	short loc_10019A62
		mov	edx, 300h
		cmp	[esi+44h], dx
		jnb	short loc_10019A62
		test	byte ptr [esi+16h], 1
		jnz	short loc_10019A3D
		mov	eax, [esi+24Ch]
		push	eax
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_10019A3D:				; CODE XREF: sub_100199C0+6Bj
		push	esi
		mov	[esi+290h], ebp
		call	sub_100185A0
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_10019A62
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019A62:				; CODE XREF: sub_100199C0+55j
					; sub_100199C0+5Aj ...
		cmp	edi, 0FFFFFFFEh
		jnz	short loc_10019A7B
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019A7B:				; CODE XREF: sub_100199C0+A5j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_100199C0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  65. SSL_ResetHandshake

; =============== S U B	R O U T	I N E =======================================


		public SSL_ResetHandshake
SSL_ResetHandshake proc	near		; DATA XREF: .rdata:off_10035848o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10019AC5
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10019AC5:				; CODE XREF: SSL_ResetHandshake+20j
		push	ebx
		mov	ebx, 1
		test	[esi+14h], bl
		jnz	short loc_10019AE3
		pop	ebx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10019AE3:				; CODE XREF: SSL_ResetHandshake+3Ej
		mov	eax, [esi+244h]
		push	ebp
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_10019AFB
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_10019AFB:				; CODE XREF: SSL_ResetHandshake+63j
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_10019B0B
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_10019B0B:				; CODE XREF: SSL_ResetHandshake+73j
		mov	ebp, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_10019B22
		mov	eax, [esi+254h]
		push	eax
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019B22:				; CODE XREF: SSL_ResetHandshake+84j
		xor	eax, eax
		mov	[esi+24h], eax
		mov	[esi+28h], eax
		cmp	[esp+34h+arg_4], eax
		jz	short loc_10019B46
		mov	dword ptr [esi+1DCh], offset sub_10014380
		mov	dword ptr [esi+270h], 2
		jmp	short loc_10019B56
; ---------------------------------------------------------------------------

loc_10019B46:				; CODE XREF: SSL_ResetHandshake+9Ej
		mov	dword ptr [esi+1DCh], offset sub_100137A0
		mov	[esi+270h], ebx

loc_10019B56:				; CODE XREF: SSL_ResetHandshake+B4j
		mov	[esi+1E0h], eax
		mov	[esi+1E4h], eax
		test	[esi+16h], bl
		jnz	short loc_10019B73
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019B73:				; CODE XREF: SSL_ResetHandshake+D5j
		lea	edx, [esi+274h]
		push	edx
		call	sub_10017510
		mov	edi, ds:PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019BAA
		mov	eax, [esi+24Ch]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019BAA
		mov	ecx, [esi+258h]
		push	ecx
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019BAA:				; CODE XREF: SSL_ResetHandshake+FBj
					; SSL_ResetHandshake+10Cj
		xor	eax, eax
		mov	[esi+8C8h], eax
		mov	[esi+8C0h], eax
		test	[esi+16h], bl
		jnz	short loc_10019BC9
		mov	edx, [esi+250h]
		push	edx
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019BC9:				; CODE XREF: SSL_ResetHandshake+12Bj
		lea	eax, [esi+48h]
		push	ebx
		push	eax
		call	sub_10019260
		push	esi
		call	sub_10019070
		add	esp, 0Ch
		mov	ebp, eax
		test	[esi+16h], bl
		jnz	short loc_10019C11
		mov	ecx, [esi+250h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019C11
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_10019C11
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_10019C11:				; CODE XREF: SSL_ResetHandshake+151j
					; SSL_ResetHandshake+162j ...
		cmp	dword ptr [esi+38h], 0
		jnz	short loc_10019C2D
		lea	ecx, [esp+34h+var_24]
		push	ecx
		push	esi
		call	sub_10014710
		add	esp, 8
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	[esi+38h], eax

loc_10019C2D:				; CODE XREF: SSL_ResetHandshake+185j
		mov	eax, [esi+248h]
		mov	edi, ds:PR_Unlock
		test	eax, eax
		jz	short loc_10019C43
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_10019C43:				; CODE XREF: SSL_ResetHandshake+1ABj
		mov	esi, [esi+244h]
		test	esi, esi
		jz	short loc_10019C53
		push	esi
		call	edi ; PR_Unlock
		add	esp, 4

loc_10019C53:				; CODE XREF: SSL_ResetHandshake+1BBj
		mov	ecx, [esp+34h+var_4]
		pop	edi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
SSL_ResetHandshake endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  31. SSL_ForceHandshake

; =============== S U B	R O U T	I N E =======================================


		public SSL_ForceHandshake
SSL_ForceHandshake proc	near		; CODE XREF: SSL_ForceHandshakeWithTimeout+1Ap
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	ebp
		push	esi
		push	eax
		or	ebp, 0FFFFFFFFh
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10019C8D
		pop	esi
		or	eax, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019C8D:				; CODE XREF: SSL_ForceHandshake+16j
		push	ebx
		mov	bl, 1
		test	[esi+14h], bl
		jnz	short loc_10019C9B
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019C9B:				; CODE XREF: SSL_ForceHandshake+23j
		push	edi
		push	esi
		call	sub_1001E1F0
		mov	edi, ds:PR_EnterMonitor
		add	esp, 4
		test	eax, eax
		jnz	short loc_10019D14
		test	[esi+16h], bl
		jnz	short loc_10019CC0
		mov	ecx, [esi+250h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019CC0:				; CODE XREF: SSL_ForceHandshake+42j
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_10019CFF
		push	esi
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		jns	short loc_10019CFF
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jz	short loc_10019CFF
		test	[esi+16h], bl
		jnz	short loc_10019CF7
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019CF7:				; CODE XREF: SSL_ForceHandshake+75j
		pop	edi
		pop	ebx
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019CFF:				; CODE XREF: SSL_ForceHandshake+57j
					; SSL_ForceHandshake+64j ...
		test	[esi+16h], bl
		jnz	short loc_10019D25
		mov	eax, [esi+250h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019D14:				; CODE XREF: SSL_ForceHandshake+3Dj
		test	[esi+16h], bl
		jnz	short loc_10019D25
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019D25:				; CODE XREF: SSL_ForceHandshake+92j
					; SSL_ForceHandshake+A7j
		mov	edx, 300h
		cmp	[esi+44h], dx
		jb	short loc_10019D8C
		test	[esi+16h], bl
		jnz	short loc_10019D41
		mov	eax, [esi+24Ch]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019D41:				; CODE XREF: SSL_ForceHandshake+C3j
		push	0
		push	esi
		call	sub_10010190
		add	esp, 8
		mov	edi, eax
		test	[esi+16h], bl
		jnz	short loc_10019D63
		mov	ecx, [esi+24Ch]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019D63:				; CODE XREF: SSL_ForceHandshake+E1j
		test	edi, edi
		jg	short loc_10019D9F
		jnz	short loc_10019D78
		push	0FFFFE8CEh
		call	PORT_SetError_Util
		add	esp, 4
		jmp	short loc_10019DA1
; ---------------------------------------------------------------------------

loc_10019D78:				; CODE XREF: SSL_ForceHandshake+F7j
		cmp	edi, 0FFFFFFFEh
		jnz	short loc_10019DA1
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		jmp	short loc_10019DA1
; ---------------------------------------------------------------------------

loc_10019D8C:				; CODE XREF: SSL_ForceHandshake+BEj
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_10019D9F
		push	esi
		call	sub_100199C0
		add	esp, 4
		mov	ebp, eax
		jmp	short loc_10019DA1
; ---------------------------------------------------------------------------

loc_10019D9F:				; CODE XREF: SSL_ForceHandshake+F5j
					; SSL_ForceHandshake+120j
		xor	ebp, ebp

loc_10019DA1:				; CODE XREF: SSL_ForceHandshake+106j
					; SSL_ForceHandshake+10Bj ...
		test	[esi+16h], bl
		jnz	short loc_10019DB6
		mov	edx, [esi+254h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019DB6:				; CODE XREF: SSL_ForceHandshake+134j
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, ebp
		pop	ebp
		retn
SSL_ForceHandshake endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  32. SSL_ForceHandshakeWithTimeout

; =============== S U B	R O U T	I N E =======================================


		public SSL_ForceHandshakeWithTimeout
SSL_ForceHandshakeWithTimeout proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, esi
		call	sub_10018620
		test	eax, eax
		jz	short loc_10019DD9
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019DD9:				; CODE XREF: SSL_ForceHandshakeWithTimeout+12j
		push	esi
		call	SSL_ForceHandshake
		add	esp, 4
		pop	esi
		retn
SSL_ForceHandshakeWithTimeout endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  25. SSL_ConfigSecureServer

; =============== S U B	R O U T	I N E =======================================


		public SSL_ConfigSecureServer
SSL_ConfigSecureServer proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	eax
		mov	eax, [esp+4+arg_0]
		push	ecx
		push	0
		push	edx
		push	eax
		call	SSL_ConfigSecureServerWithCertChain
		add	esp, 14h
		retn
SSL_ConfigSecureServer endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019E10(int,	void *Dst, size_t Size,	char)
sub_10019E10	proc near		; CODE XREF: sub_10019F60+11p
					; DATA XREF: .rdata:1002E9F4o

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	bl, 1
		test	[esi+268h], bl
		jz	short loc_10019E33
		push	0FFFFE8D7h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019E33:				; CODE XREF: sub_10019E10+Ej
		test	dword ptr [esp+8+arg_C], 0FFFFFFFDh
		jz	short loc_10019E50
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019E50:				; CODE XREF: sub_10019E10+2Bj
		push	ebp
		push	esi
		call	sub_1001E1F0
		mov	ebp, ds:PR_EnterMonitor
		add	esp, 4
		test	eax, eax
		jnz	short loc_10019ED4
		mov	eax, [esi+14h]
		test	eax, 800h
		jnz	short loc_10019ED4
		test	eax, 10000h
		jnz	short loc_10019E81
		mov	eax, [esi+250h]
		push	eax
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019E81:				; CODE XREF: sub_10019E10+63j
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_10019EBF
		push	esi
		call	sub_10018A40
		add	esp, 4
		test	eax, eax
		jns	short loc_10019EBF
		call	PORT_GetError_Util
		cmp	eax, 0FFFFE892h
		jz	short loc_10019EBF
		test	[esi+16h], bl
		jnz	short loc_10019EB8
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019EB8:				; CODE XREF: sub_10019E10+96j
		pop	ebp
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019EBF:				; CODE XREF: sub_10019E10+78j
					; sub_10019E10+85j ...
		test	[esi+16h], bl
		jnz	short loc_10019ED4
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019ED4:				; CODE XREF: sub_10019E10+52j
					; sub_10019E10+5Cj ...
		push	edi
		xor	edi, edi
		cmp	[esi+24h], edi
		jnz	short loc_10019F30
		test	[esi+16h], bl
		jnz	short loc_10019EED
		mov	eax, [esi+254h]
		push	eax
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_10019EED:				; CODE XREF: sub_10019E10+CFj
		cmp	[esi+1DCh], edi
		jnz	short loc_10019F05
		cmp	[esi+1E0h], edi
		jnz	short loc_10019F05
		cmp	[esi+1E4h], edi
		jz	short loc_10019F10

loc_10019F05:				; CODE XREF: sub_10019E10+E3j
					; sub_10019E10+EBj
		push	esi
		call	sub_100199C0
		add	esp, 4
		mov	edi, eax

loc_10019F10:				; CODE XREF: sub_10019E10+F3j
		test	[esi+16h], bl
		jnz	short loc_10019F25
		mov	ecx, [esi+254h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_10019F25:				; CODE XREF: sub_10019E10+103j
		test	edi, edi
		jns	short loc_10019F30
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019F30:				; CODE XREF: sub_10019E10+CAj
					; sub_10019E10+117j
		mov	eax, [esp+10h+Size]
		test	eax, eax
		jnz	short loc_10019F3D
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10019F3D:				; CODE XREF: sub_10019E10+126j
		mov	edx, dword ptr [esp+10h+arg_C]
		push	edx		; char
		push	eax		; Size
		mov	eax, [esp+18h+Dst]
		push	eax		; Dst
		call	sub_10018AA0
		add	esp, 0Ch
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
sub_10019E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019F60(int,	void *Dst, size_t Size)
sub_10019F60	proc near		; DATA XREF: .rdata:1002E9FCo

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch

		mov	eax, [esp+Size]
		mov	ecx, [esp+Dst]
		mov	edx, [esp+arg_0]
		push	0		; char
		push	eax		; Size
		push	ecx		; Dst
		push	edx		; int
		call	sub_10019E10
		add	esp, 10h
		retn
sub_10019F60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019F80	proc near		; CODE XREF: sub_1001A160+11p
					; DATA XREF: .rdata:1002E9F8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		xor	ebp, ebp
		test	byte ptr [esi+268h], 2
		jz	short loc_10019FA4
		push	0FFFFE8D7h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019FA4:				; CODE XREF: sub_10019F80+Fj
		cmp	[esp+8+arg_C], ebp
		jz	short loc_10019FBD
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019FBD:				; CODE XREF: sub_10019F80+28j
		test	byte ptr [esi+16h], 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		jnz	short loc_10019FD6
		mov	eax, [esi+250h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_10019FD6:				; CODE XREF: sub_10019F80+48j
		cmp	[esi+2E4h], ebp
		jz	short loc_1001A006
		push	esi
		call	sub_10018A40
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		js	short loc_1001A006
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_1001A006
		push	0FFFFE892h
		call	PORT_SetError_Util
		add	esp, 4
		or	ebp, 0FFFFFFFFh

loc_1001A006:				; CODE XREF: sub_10019F80+5Cj
					; sub_10019F80+6Bj ...
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001A01C
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001A01C:				; CODE XREF: sub_10019F80+8Aj
		test	ebp, ebp
		js	loc_1001A159
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		test	ebx, ebx
		jle	short loc_1001A039
		call	ds:PR_GetCurrentThread
		mov	[esi+264h], eax

loc_1001A039:				; CODE XREF: sub_10019F80+ABj
		cmp	dword ptr [esi+24h], 0
		jnz	loc_1001A0D9
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001A055
		mov	edx, [esi+254h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001A055:				; CODE XREF: sub_10019F80+C7j
		mov	eax, [esi+14h]
		test	eax, 400000h
		jz	short loc_1001A09D
		mov	ecx, 300h
		cmp	[esi+44h], cx
		jb	short loc_1001A09D
		test	eax, 10000h
		jnz	short loc_1001A07D
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001A07D:				; CODE XREF: sub_10019F80+EFj
		test	byte ptr [esi+16h], 1
		mov	edi, [esi+8C8h]
		jnz	short loc_1001A099
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001A099:				; CODE XREF: sub_10019F80+107j
		test	edi, edi
		jnz	short loc_1001A0C3

loc_1001A09D:				; CODE XREF: sub_10019F80+DDj
					; sub_10019F80+E8j
		cmp	dword ptr [esi+1DCh], 0
		jnz	short loc_1001A0B8
		cmp	dword ptr [esi+1E0h], 0
		jnz	short loc_1001A0B8
		cmp	dword ptr [esi+1E4h], 0
		jz	short loc_1001A0C3

loc_1001A0B8:				; CODE XREF: sub_10019F80+124j
					; sub_10019F80+12Dj
		push	esi
		call	sub_100199C0
		add	esp, 4
		mov	ebp, eax

loc_1001A0C3:				; CODE XREF: sub_10019F80+11Bj
					; sub_10019F80+136j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001A0D9
		mov	ecx, [esi+254h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001A0D9:				; CODE XREF: sub_10019F80+BDj
					; sub_10019F80+147j
		xor	eax, eax
		cmp	ebp, eax
		jge	short loc_1001A0EC
		mov	[esi+264h], eax
		mov	eax, ebp

loc_1001A0E7:				; CODE XREF: sub_10019F80+16Ej
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001A0EC:				; CODE XREF: sub_10019F80+15Dj
		cmp	ebx, eax
		jz	short loc_1001A0E7
		mov	edi, [esp+10h+arg_4]
		test	edi, edi
		jnz	short loc_1001A10D
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebx
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001A10D:				; CODE XREF: sub_10019F80+176j
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001A123
		mov	edx, [esi+250h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001A123:				; CODE XREF: sub_10019F80+191j
		mov	eax, [esi+48h]
		push	0
		push	ebx
		push	edi
		push	esi
		call	eax
		add	esp, 10h
		test	byte ptr [esi+16h], 1
		mov	edi, eax
		jnz	short loc_1001A148
		mov	ecx, [esi+250h]
		push	ecx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001A148:				; CODE XREF: sub_10019F80+1B6j
		pop	ebx
		mov	eax, edi
		pop	edi
		mov	dword ptr [esi+264h], 0
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001A159:				; CODE XREF: sub_10019F80+9Ej
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		retn
sub_10019F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A160	proc near		; DATA XREF: .rdata:1002EA00o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	0
		push	eax
		push	ecx
		push	edx
		call	sub_10019F80
		add	esp, 10h
		retn
sub_1001A160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A180	proc near		; CODE XREF: sub_1001AA70+F4p
					; sub_1001AA70+1B7p ...
		push	esi
		mov	esi, eax
		lea	eax, [edi+4]
		push	eax
		call	sub_10017C50
		add	esp, 4
		test	eax, eax
		jz	short loc_1001A197
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001A197:				; CODE XREF: sub_1001A180+11j
		test	esi, esi
		jnz	short loc_1001A1A2
		call	sub_10018130
		mov	esi, eax

loc_1001A1A2:				; CODE XREF: sub_1001A180+19j
		mov	ecx, dword_10037800
		mov	[edi], esi
		mov	eax, esi
		mov	[edi+10h], ecx
		pop	esi
		retn
sub_1001A180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A1C0	proc near		; CODE XREF: sub_1001AA70+21Dp
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4
		retn
sub_1001A1C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A1E0	proc near		; CODE XREF: sub_1001AD50+D3p

var_1008	= dword	ptr -1008h
Src		= word ptr -1004h
var_1002	= word ptr -1002h
Dst		= byte ptr -1000h
var_FE0		= byte ptr -0FE0h
var_4		= dword	ptr -4

		mov	eax, 1008h
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1008h+var_4], eax
		push	ebp
		push	esi
		push	edi
		mov	edi, edx
		mov	eax, [edi+44h]
		mov	esi, ecx
		cmp	eax, 0FDCh
		ja	loc_1001A306
		test	eax, eax
		jz	loc_1001A306
		mov	ebp, [edi+40h]
		test	ebp, ebp
		jz	loc_1001A306
		movzx	eax, byte ptr [ebx+1Fh]
		mov	[esp+1014h+var_1002], ax
		movzx	eax, ax
		push	eax		; Size
		lea	ecx, [ebx+20h]
		push	ecx		; Src
		lea	edx, [esp+101Ch+Dst]
		push	edx		; Dst
		call	memcpy
		mov	di, [edi+44h]
		movzx	eax, di
		push	eax		; Size
		lea	ecx, [esp+1024h+var_FE0]
		push	ebp		; Src
		push	ecx		; Dst
		mov	[esp+102Ch+Src], di
		call	memcpy
		mov	edi, [esi+50h]
		lea	edx, [edi+4]
		push	edx
		call	sub_10017C50
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_1001A28A
		pop	edi
		mov	[esp+1010h+var_1008], 0
		mov	eax, [esp+1010h+var_1008]
		pop	esi
		pop	ebp
		mov	ecx, [esp+1008h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1008h
		retn
; ---------------------------------------------------------------------------

loc_1001A28A:				; CODE XREF: sub_1001A1E0+84j
		call	sub_10018130
		mov	ecx, dword_10037800
		mov	[edi], eax
		mov	[edi+10h], ecx
		mov	[esp+1014h+var_1008], eax
		test	eax, eax
		jz	short loc_1001A2EA
		mov	ebp, [esi+80h]
		mov	edi, [ebp+3Ch]
		mov	eax, edi
		shl	eax, 0Ch
		add	eax, [esi+60h]
		push	1000h		; Size
		lea	edx, [esp+1018h+Src]
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	[ebx+88h], edi
		xor	edx, edx
		lea	eax, [edi+1]
		div	dword ptr [esi+18h]
		mov	[ebp+3Ch], edx
		mov	esi, [esi+50h]
		mov	dword ptr [esi+10h], 0
		add	esi, 4
		push	esi
		call	sub_10017BE0
		add	esp, 10h

loc_1001A2EA:				; CODE XREF: sub_1001A1E0+C0j
		mov	eax, [esp+1014h+var_1008]
		pop	edi
		pop	esi
		pop	ebp
		mov	ecx, [esp+1008h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1008h
		retn
; ---------------------------------------------------------------------------

loc_1001A306:				; CODE XREF: sub_1001A1E0+27j
					; sub_1001A1E0+2Fj ...
		push	0FFFFE005h
		call	PORT_SetError_Util
		mov	ecx, [esp+1018h+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1008h
		retn
sub_1001A1E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A330	proc near		; CODE XREF: sub_1001AD50+B5p

var_43C		= dword	ptr -43Ch
var_438		= dword	ptr -438h
var_434		= word ptr -434h
var_432		= word ptr -432h
Dst		= byte ptr -430h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 43Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+43Ch+var_4], eax
		mov	eax, [esp+43Ch+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		mov	ebx, ecx
		mov	[esp+448h+var_438], eax
		test	esi, esi
		jz	loc_1001A47B
		mov	ebp, [esi+8]
		test	ebp, ebp
		jz	loc_1001A47B
		cmp	ebp, 400h
		ja	loc_1001A47B
		mov	cx, [esi]
		mov	ax, bp
		movzx	edx, ax
		push	edi
		mov	edi, [esi+4]
		push	edx		; Size
		mov	[esp+450h+var_432], ax
		lea	eax, [esp+450h+Dst]
		push	edi		; Src
		push	eax		; Dst
		mov	[esp+458h+var_434], cx
		call	memcpy
		push	ebp
		lea	ecx, [esp+45Ch+var_24]
		push	edi
		push	ecx
		call	sub_10022890
		push	esi
		call	SECITEM_Hash
		mov	dl, [esi]
		mov	[esp+468h+var_43C], eax
		mov	eax, [esi+8]
		and	eax, 3
		xor	byte ptr [esp+eax+468h+var_43C], dl
		mov	esi, [ebx+54h]
		lea	eax, [esp+eax+468h+var_43C]
		lea	eax, [esi+4]
		push	eax
		call	sub_10017C50
		add	esp, 20h
		test	eax, eax
		jz	short loc_1001A3F1
		pop	edi
		xor	ebp, ebp
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		mov	ecx, [esp+43Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 43Ch
		retn
; ---------------------------------------------------------------------------

loc_1001A3F1:				; CODE XREF: sub_1001A330+A2j
		call	sub_10018130
		mov	ecx, dword_10037800
		mov	[esi], eax
		mov	[esi+10h], ecx
		mov	ebp, eax
		test	eax, eax
		jz	short loc_1001A460
		mov	ecx, [ebx+28h]
		test	ecx, ecx
		jz	short loc_1001A44A
		mov	eax, [esp+44Ch+var_43C]
		xor	edx, edx
		div	ecx
		mov	eax, [esp+44Ch+var_438]
		mov	ecx, 10Ch
		lea	esi, [esp+44Ch+var_434]
		mov	edi, edx
		imul	edi, 430h
		add	edi, [ebx+78h]
		rep movsd
		lea	edi, [eax+90h]
		mov	ecx, 8
		lea	esi, [esp+44Ch+var_24]
		mov	[eax+8Ch], edx
		rep movsd

loc_1001A44A:				; CODE XREF: sub_1001A330+DCj
		mov	ebx, [ebx+54h]
		mov	dword ptr [ebx+10h], 0
		add	ebx, 4
		push	ebx
		call	sub_10017BE0
		add	esp, 4

loc_1001A460:				; CODE XREF: sub_1001A330+D5j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		mov	ecx, [esp+43Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 43Ch
		retn
; ---------------------------------------------------------------------------

loc_1001A47B:				; CODE XREF: sub_1001A330+28j
					; sub_1001A330+33j ...
		push	0FFFFE005h
		call	PORT_SetError_Util
		mov	ecx, [esp+44Ch+var_4]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 43Ch
		retn
sub_1001A330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A4B0	proc near		; CODE XREF: sub_1001AD50+86p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, eax
		mov	byte ptr [ebx+1Eh], 1
		push	ebp
		mov	ebp, [esp+8+arg_0]
		movzx	eax, word ptr [ebp+3Ah]
		mov	[ebx+1Ch], ax
		mov	ecx, [ebp+28h]
		mov	[ebx], ecx
		mov	edx, [ebp+2Ch]
		mov	[ebx+4], edx
		mov	eax, [ebp+30h]
		mov	[ebx+8], eax
		mov	ecx, [ebp+34h]
		mov	[ebx+0Ch], ecx
		mov	edx, [ebp+3Ch]
		mov	[ebx+10h], edx
		mov	eax, [ebp+0Ch]
		mov	[ebx+14h], eax
		mov	ecx, [ebp+40h]
		mov	[ebx+18h], ecx
		movzx	edx, word ptr [ebp+44h]
		mov	[ebx+40h], dx
		movzx	eax, word ptr [ebp+48h]
		mov	[ebx+42h], ax
		mov	cx, [ebp+4Ch]
		mov	[ebx+44h], cx
		movzx	edx, word ptr [ebp+50h]
		mov	eax, 300h
		mov	[ebx+46h], dx
		cmp	[ebp+3Ah], ax
		jnb	loc_1001A5B1
		cmp	dword ptr [ebp+6Ch], 40h
		ja	loc_1001A5AA
		cmp	dword ptr [ebp+7Ch], 20h
		ja	short loc_1001A5AA
		movzx	ecx, byte ptr [ebp+70h]
		mov	[ebx+0A8h], cl
		movzx	edx, byte ptr [ebp+6Ch]
		mov	[ebx+0A9h], dl
		mov	al, [ebp+7Ch]
		mov	[ebx+0ACh], al
		movzx	ecx, byte ptr [ebp+80h]
		mov	[ebx+0AAh], cl
		movzx	edx, byte ptr [ebp+84h]
		mov	[ebx+0ABh], dl
		mov	byte ptr [ebx+1Fh], 10h
		mov	eax, [ebp+54h]
		mov	[ebx+20h], eax
		mov	ecx, [ebp+58h]
		mov	[ebx+24h], ecx
		mov	edx, [ebp+5Ch]
		mov	[ebx+28h], edx
		mov	eax, [ebp+60h]
		mov	[ebx+2Ch], eax
		mov	ecx, [ebp+6Ch]
		mov	edx, [ebp+68h]
		push	ecx		; Size
		push	edx		; Src
		lea	eax, [ebx+48h]
		push	eax		; Dst
		call	memcpy
		mov	ecx, [ebp+7Ch]
		mov	edx, [ebp+78h]
		push	ecx		; Size
		push	edx		; Src
		add	ebx, 88h
		push	ebx		; Dst
		call	memcpy
		add	esp, 18h
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001A5AA:				; CODE XREF: sub_1001A4B0+70j
					; sub_1001A4B0+7Aj
		pop	ebp
		mov	byte ptr [ebx+1Eh], 0
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001A5B1:				; CODE XREF: sub_1001A4B0+66j
		mov	ax, [ebp+76h]
		mov	[ebx+48h], ax
		mov	cx, [ebp+78h]
		push	esi
		mov	[ebx+4Ah], cx
		push	edi
		lea	esi, [ebp+80h]
		lea	edi, [ebx+4Ch]
		mov	ecx, 0Dh
		rep movsd
		mov	edx, [ebp+0B4h]
		mov	[ebx+80h], edx
		mov	eax, [ebp+0B8h]
		mov	[ebx+84h], eax
		mov	cl, [ebp+54h]
		movzx	edx, cl
		or	eax, 0FFFFFFFFh
		push	edx		; Size
		mov	[ebx+1Fh], cl
		mov	[ebx+88h], eax
		mov	[ebx+8Ch], eax
		add	ebp, 55h
		push	ebp		; Src
		add	ebx, 20h
		push	ebx		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001A4B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A620	proc near		; CODE XREF: sub_1001AA70+296p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 10h
		push	ebp
		push	esi
		movzx	esi, word ptr [ebx+1Ch]
		push	108h
		mov	[esp+1Ch+var_10], esi
		call	PORT_ZAlloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_1001A646
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001A646:				; CODE XREF: sub_1001A620+1Ej
		mov	eax, 300h
		push	edi
		cmp	si, ax
		jnb	loc_1001A775
		movzx	ecx, byte ptr [ebx+0A9h]
		push	ecx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[ebp+68h], eax
		test	eax, eax
		jz	loc_1001A893
		mov	al, [ebx+0ACh]
		test	al, al
		jz	short loc_1001A6A9
		movzx	edx, al
		push	edx
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[ebp+78h], eax
		test	eax, eax
		jz	loc_1001A893
		movzx	ecx, byte ptr [ebx+0ACh]
		push	ecx		; Size
		lea	edx, [ebx+88h]
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001A6A9:				; CODE XREF: sub_1001A620+58j
		movzx	eax, byte ptr [ebx+0A8h]
		mov	[ebp+70h], eax
		movzx	ecx, byte ptr [ebx+0A9h]
		mov	[ebp+6Ch], ecx
		movzx	edx, byte ptr [ebx+0ACh]
		mov	[ebp+7Ch], edx
		movzx	eax, byte ptr [ebx+0AAh]
		mov	[ebp+80h], eax
		movzx	ecx, byte ptr [ebx+0ABh]
		mov	[ebp+84h], ecx
		mov	edx, [ebx+20h]
		mov	[ebp+54h], edx
		mov	eax, [ebx+24h]
		mov	[ebp+58h], eax
		mov	ecx, [ebx+28h]
		mov	[ebp+5Ch], ecx
		mov	edx, [ebx+2Ch]
		mov	[ebp+60h], edx
		movzx	eax, byte ptr [ebx+0A9h]
		mov	edx, [ebp+68h]
		push	eax		; Size
		lea	ecx, [ebx+48h]
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001A711:				; CODE XREF: sub_1001A620+22Ej
					; sub_1001A620+23Aj ...
		mov	ax, [ebx+1Ch]
		mov	[ebp+3Ah], ax
		mov	ecx, [ebx+10h]
		mov	[ebp+3Ch], ecx
		mov	edx, [ebx+14h]
		mov	[ebp+0Ch], edx
		mov	eax, [ebx+18h]
		mov	[ebp+40h], eax
		mov	dword ptr [ebp+4], 2
		mov	ecx, [ebx]
		mov	[ebp+28h], ecx
		mov	edx, [ebx+4]
		mov	[ebp+2Ch], edx
		mov	eax, [ebx+8]
		mov	[ebp+30h], eax
		mov	ecx, [ebx+0Ch]
		mov	[ebp+34h], ecx
		mov	dword ptr [ebp+8], 1
		movzx	edx, word ptr [ebx+40h]
		mov	[ebp+44h], edx
		movzx	eax, word ptr [ebx+42h]
		mov	[ebp+48h], eax
		movzx	ecx, word ptr [ebx+44h]
		mov	[ebp+4Ch], ecx
		movzx	edx, word ptr [ebx+46h]
		pop	edi
		pop	esi
		mov	[ebp+50h], edx
		mov	eax, ebp
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001A775:				; CODE XREF: sub_1001A620+2Fj
		mov	al, [ebx+1Fh]
		mov	[ebp+54h], al
		mov	cx, [ebx+48h]
		mov	[ebp+76h], cx
		movzx	edx, word ptr [ebx+4Ah]
		mov	[ebp+78h], edx
		lea	esi, [ebx+4Ch]
		lea	edi, [ebp+80h]
		mov	ecx, 0Dh
		rep movsd
		mov	eax, [ebx+80h]
		mov	[ebp+0B4h], eax
		mov	ecx, [ebx+84h]
		or	esi, 0FFFFFFFFh
		mov	[ebp+0B8h], ecx
		cmp	[ebx+8Ch], esi
		jz	short loc_1001A7FA
		mov	eax, [esp+1Ch+arg_4]
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_1001A7FC
		movzx	edx, word ptr [eax]
		movzx	ecx, word ptr [eax+2]
		add	eax, 4
		mov	[esp+1Ch+var_C], edx
		lea	edx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_8], eax
		push	edx
		lea	eax, [ebp+0E0h]
		push	eax
		push	edi
		mov	[esp+28h+var_4], ecx
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1001A88F

loc_1001A7FA:				; CODE XREF: sub_1001A620+19Bj
		xor	edi, edi

loc_1001A7FC:				; CODE XREF: sub_1001A620+1A5j
		movzx	ecx, byte ptr [ebx+1Fh]
		push	ecx		; Size
		lea	edx, [ebx+20h]
		push	edx		; Src
		lea	eax, [ebp+55h]
		push	eax		; Dst
		call	memcpy
		xor	ecx, ecx
		xor	eax, eax
		add	esp, 0Ch
		mov	[ebp+0C0h], edi
		mov	[ebp+0C4h], edi
		mov	[ebp+20h], edi
		mov	[ebp+0C8h], esi
		mov	[ebp+0CCh], esi
		mov	[ebp+0D0h], ecx
		mov	[ebp+0D4h], esi
		mov	[ebp+0D8h], esi
		mov	[ebp+0DCh], eax
		cmp	[ebx+88h], esi
		jz	loc_1001A711
		mov	eax, [esp+1Ch+arg_0]
		cmp	eax, edi
		jz	loc_1001A711
		movzx	ecx, word ptr [eax]
		push	1
		push	edi
		add	eax, 24h
		push	edi
		lea	edx, [esp+28h+var_C]
		mov	[esp+28h+var_8], eax
		mov	eax, [esp+28h+arg_8]
		push	edx
		push	eax
		mov	[esp+30h+var_4], ecx
		call	CERT_NewTempCertificate
		add	esp, 14h
		mov	[ebp+10h], eax
		cmp	eax, edi
		jnz	loc_1001A711

loc_1001A88F:				; CODE XREF: sub_1001A620+1D4j
		mov	esi, [esp+1Ch+var_10]

loc_1001A893:				; CODE XREF: sub_1001A620+4Aj
					; sub_1001A620+6Bj
		mov	ecx, 300h
		cmp	si, cx
		jnb	short loc_1001A8CF
		mov	eax, [ebp+68h]
		test	eax, eax
		jz	short loc_1001A8AD
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001A8AD:				; CODE XREF: sub_1001A620+282j
		mov	eax, [ebp+78h]
		test	eax, eax
		jz	short loc_1001A8E0
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		push	ebp
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001A8CF:				; CODE XREF: sub_1001A620+27Bj
		lea	edx, [ebp+0E0h]
		push	0
		push	edx
		call	SECITEM_FreeItem_Util
		add	esp, 8

loc_1001A8E0:				; CODE XREF: sub_1001A620+292j
		push	ebp
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 10h
		retn
sub_1001A620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1001A900@<eax>(size_t Size@<ecx>, void *Src@<edx>,	int)
sub_1001A900	proc near		; CODE XREF: sub_1001AA70+48p
					; sub_1001AD50+F0p ...

Dst		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		xor	eax, eax
		mov	[esp+24h+Dst], eax
		mov	[esp+24h+var_20], eax
		mov	[esp+24h+var_1C], eax
		mov	[esp+24h+var_18], eax
		mov	[esp+24h+var_14], eax
		mov	[esp+24h+var_10], eax
		mov	[esp+24h+var_C], eax
		mov	[esp+24h+var_8], eax
		cmp	ecx, 20h
		jbe	short loc_1001A939
		mov	ecx, 20h

loc_1001A939:				; CODE XREF: sub_1001A900+32j
		push	ecx		; Size
		push	edx		; Src
		lea	eax, [esp+2Ch+Dst]
		push	eax		; Dst
		call	memcpy
		mov	eax, [esi+0Ch]
		xor	eax, [esi+8]
		mov	ecx, [esp+30h+arg_0]
		xor	eax, [esi+4]
		xor	edx, edx
		xor	eax, [esi]
		add	esp, 0Ch
		xor	eax, [esp+24h+var_8]
		xor	eax, [esp+24h+var_C]
		xor	eax, [esp+24h+var_10]
		xor	eax, [esp+24h+var_14]
		xor	eax, [esp+24h+var_18]
		xor	eax, [esp+24h+var_1C]
		xor	eax, [esp+24h+var_20]
		xor	eax, [esp+24h+Dst]
		div	dword ptr [ecx+8]
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		mov	eax, edx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001A900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A990	proc near		; CODE XREF: sub_1001AA70+BAp
					; sub_1001AF10+9Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		mov	edx, [ecx+58h]
		push	ebp
		mov	ebp, [edx+eax*4]
		imul	eax, 6000h
		add	eax, [ecx+5Ch]
		push	esi
		push	edi
		mov	[esp+14h+var_4], eax
		mov	[esp+14h+var_8], 80h

loc_1001A9B1:				; CODE XREF: sub_1001A990+C3j
		dec	ebp
		and	ebp, 7Fh
		lea	eax, [ebp+ebp*2+0]
		shl	eax, 6
		add	eax, [esp+14h+var_4]
		cmp	byte ptr [eax+1Eh], 0
		jz	loc_1001AA48
		mov	ecx, [esp+14h+arg_0]
		cmp	ecx, [eax+18h]
		jbe	short loc_1001A9D9
		mov	byte ptr [eax+1Eh], 0
		jmp	short loc_1001AA48
; ---------------------------------------------------------------------------

loc_1001A9D9:				; CODE XREF: sub_1001A990+41j
		movzx	edx, byte ptr [eax+1Fh]
		cmp	ebx, edx
		jnz	short loc_1001AA48
		mov	ecx, [esp+14h+arg_4]
		mov	esi, eax
		mov	edx, 10h
		sub	esi, ecx
		mov	edi, edi

loc_1001A9F0:				; CODE XREF: sub_1001A990+70j
		mov	edi, [esi+ecx]
		cmp	edi, [ecx]
		jnz	short loc_1001AA48
		sub	edx, 4
		add	ecx, 4
		cmp	edx, 4
		jnb	short loc_1001A9F0
		mov	esi, [esp+14h+arg_8]
		mov	ecx, ebx
		lea	edi, [eax+20h]
		cmp	ebx, 4
		jb	short loc_1001AA24

loc_1001AA10:				; CODE XREF: sub_1001A990+92j
		mov	edx, [edi]
		cmp	edx, [esi]
		jnz	short loc_1001AA48
		sub	ecx, 4
		add	esi, 4
		add	edi, 4
		cmp	ecx, 4
		jnb	short loc_1001AA10

loc_1001AA24:				; CODE XREF: sub_1001A990+7Ej
		test	ecx, ecx
		jz	short loc_1001AA68
		mov	dl, [esi]
		cmp	dl, [edi]
		jnz	short loc_1001AA48
		cmp	ecx, 1
		jbe	short loc_1001AA68
		mov	dl, [esi+1]
		cmp	dl, [edi+1]
		jnz	short loc_1001AA48
		cmp	ecx, 2
		jbe	short loc_1001AA68
		mov	cl, [esi+2]
		cmp	cl, [edi+2]
		jz	short loc_1001AA68

loc_1001AA48:				; CODE XREF: sub_1001A990+34j
					; sub_1001A990+47j ...
		mov	eax, [esp+14h+var_8]
		dec	eax
		mov	[esp+14h+var_8], eax
		test	eax, eax
		jg	loc_1001A9B1
		push	0FFFFD05Ah
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax

loc_1001AA68:				; CODE XREF: sub_1001A990+96j
					; sub_1001A990+A1j ...
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 8
		retn
sub_1001A990	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001AA70(int,	void *Src, size_t Size,	int)
sub_1001AA70	proc near		; DATA XREF: sub_1001B480:loc_1001B4CFo
					; sub_1001B760+6Eo

var_1514	= dword	ptr -1514h
var_1510	= dword	ptr -1510h
var_150C	= dword	ptr -150Ch
var_1508	= dword	ptr -1508h
var_1504	= dword	ptr -1504h
var_1500	= dword	ptr -1500h
var_14FC	= dword	ptr -14FCh
var_14F8	= byte ptr -14F8h
var_1438	= byte ptr -1438h
Dst		= byte ptr -1008h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		mov	eax, 1514h
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1514h+var_4], eax
		mov	eax, [ebp+arg_C]
		push	ebx
		mov	ebx, [ebp+Src]
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		mov	edi, [ebp+Size]
		mov	[esp+1520h+var_1500], eax
		xor	eax, eax
		push	offset dword_10037808 ;	int
		mov	ecx, edi	; Size
		mov	edx, ebx	; Src
		mov	[esp+1524h+var_1508], eax
		mov	[esp+1524h+var_1514], eax
		mov	[esp+1524h+var_1510], eax
		call	sub_1001A900
		mov	[esp+1524h+var_1504], eax
		xor	edx, edx
		div	dword_1003780C
		lea	ecx, [edx+edx*4]
		mov	edx, dword_10037850
		lea	eax, [edx+ecx*4]
		mov	[esp+1524h+var_14FC], eax
		add	eax, 4
		push	eax
		call	sub_10017C50
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001AB05
		call	sub_10018130
		mov	ecx, [esp+1520h+var_14FC]
		mov	edx, dword_10037800
		mov	[esp+1520h+var_150C], eax
		mov	[ecx], eax
		mov	[ecx+10h], edx
		test	eax, eax
		jnz	short loc_1001AB1C

loc_1001AB05:				; CODE XREF: sub_1001AA70+77j
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+1514h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001AB1C:				; CODE XREF: sub_1001AA70+93j
		push	ebx
		push	esi
		push	eax
		mov	eax, [esp+152Ch+var_1504]
		mov	ebx, edi
		mov	ecx, offset dword_10037808
		call	sub_1001A990
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_1001ACAA
		mov	eax, 300h
		cmp	[ebx+1Ch], ax
		jb	loc_1001AC92
		mov	esi, [ebx+88h]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1001AC0A
		mov	eax, [esp+1520h+var_150C]
		mov	edi, dword_10037858
		call	sub_1001A180
		test	eax, eax
		jz	loc_1001AD2B
		movzx	edx, byte ptr [ebx+1Fh]
		shl	esi, 0Ch
		add	esi, dword_10037868
		mov	ecx, esi
		movzx	eax, word ptr [ecx+2]
		mov	[esp+1520h+var_1514], ecx
		cmp	ax, dx
		jnz	short loc_1001ABE8
		lea	edi, [ebx+20h]
		lea	esi, [ecx+4]
		cmp	eax, 4
		jb	short loc_1001ABAC

loc_1001AB98:				; CODE XREF: sub_1001AA70+13Aj
		mov	edx, [esi]
		cmp	edx, [edi]
		jnz	short loc_1001ABE8
		sub	eax, 4
		add	edi, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_1001AB98

loc_1001ABAC:				; CODE XREF: sub_1001AA70+126j
		test	eax, eax
		jz	short loc_1001ABD0
		mov	dl, [edi]
		cmp	dl, [esi]
		jnz	short loc_1001ABE8
		cmp	eax, 1
		jbe	short loc_1001ABD0
		mov	dl, [edi+1]
		cmp	dl, [esi+1]
		jnz	short loc_1001ABE8
		cmp	eax, 2
		jbe	short loc_1001ABD0
		mov	al, [edi+2]
		cmp	al, [esi+2]
		jnz	short loc_1001ABE8

loc_1001ABD0:				; CODE XREF: sub_1001AA70+13Ej
					; sub_1001AA70+149j ...
		push	1000h		; Size
		push	ecx		; Src
		lea	ecx, [esp+1528h+Dst]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		jmp	short loc_1001ABF2
; ---------------------------------------------------------------------------

loc_1001ABE8:				; CODE XREF: sub_1001AA70+11Bj
					; sub_1001AA70+12Cj ...
		mov	byte ptr [ebx+1Eh], 0
		xor	ebx, ebx
		mov	[esp+1520h+var_1514], ebx

loc_1001ABF2:				; CODE XREF: sub_1001AA70+176j
		mov	eax, dword_10037858
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4

loc_1001AC0A:				; CODE XREF: sub_1001AA70+E4j
		test	ebx, ebx
		jz	loc_1001ACAA
		mov	esi, [ebx+8Ch]
		cmp	esi, 0FFFFFFFFh
		jz	short loc_1001AC92
		mov	eax, [esp+1520h+var_150C]
		mov	edi, dword_1003785C
		call	sub_1001A180
		test	eax, eax
		jz	loc_1001AD45
		imul	esi, 430h
		add	esi, dword_10037880
		lea	eax, [ebx+90h]
		mov	edx, esi
		mov	[esp+1520h+var_1510], esi
		mov	ecx, 20h
		sub	edx, eax
		jmp	short loc_1001AC60
; ---------------------------------------------------------------------------
		align 10h

loc_1001AC60:				; CODE XREF: sub_1001AA70+1E3j
					; sub_1001AA70+208j
		mov	edi, [edx+eax+410h]
		cmp	edi, [eax]
		jnz	loc_1001AD36
		sub	ecx, 4
		add	eax, 4
		cmp	ecx, 4
		jnb	short loc_1001AC60
		mov	ecx, 10Ch
		lea	edi, [esp+1520h+var_1438]
		rep movsd

loc_1001AC88:				; CODE XREF: sub_1001AA70+2D0j
		mov	eax, dword_1003785C
		call	sub_1001A1C0

loc_1001AC92:				; CODE XREF: sub_1001AA70+D5j
					; sub_1001AA70+1ABj
		test	ebx, ebx
		jz	short loc_1001ACAA
		mov	eax, [esp+1520h+var_150C]
		mov	ecx, 30h
		mov	esi, ebx
		lea	edi, [esp+1520h+var_14F8]
		mov	[ebx+14h], eax
		rep movsd

loc_1001ACAA:				; CODE XREF: sub_1001AA70+C6j
					; sub_1001AA70+19Cj ...
		mov	eax, [esp+1520h+var_1504]
		xor	edx, edx
		div	dword_1003780C
		lea	ecx, [edx+edx*4]
		mov	edx, dword_10037850
		lea	eax, [edx+ecx*4]
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1001AD12
		mov	eax, [esp+1520h+var_1500]
		push	eax
		mov	eax, [esp+1524h+var_1510]
		neg	eax
		sbb	eax, eax
		lea	ecx, [esp+1524h+var_1438]
		and	eax, ecx
		push	eax
		mov	eax, [esp+1528h+var_1514]
		neg	eax
		sbb	eax, eax
		lea	edx, [esp+1528h+Dst]
		and	eax, edx
		push	eax
		lea	ebx, [esp+152Ch+var_14F8]
		call	sub_1001A620
		add	esp, 0Ch
		mov	[esp+1520h+var_1508], eax

loc_1001AD12:				; CODE XREF: sub_1001AA70+267j
		mov	ecx, [esp+1520h+var_4]
		mov	eax, [esp+1520h+var_1508]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001AD2B:				; CODE XREF: sub_1001AA70+FBj
		xor	ebx, ebx
		mov	[esp+1520h+var_1514], ebx
		jmp	loc_1001ACAA
; ---------------------------------------------------------------------------

loc_1001AD36:				; CODE XREF: sub_1001AA70+1F9j
		mov	byte ptr [ebx+1Eh], 0
		xor	ebx, ebx
		mov	[esp+1520h+var_1510], ebx
		jmp	loc_1001AC88
; ---------------------------------------------------------------------------

loc_1001AD45:				; CODE XREF: sub_1001AA70+1BEj
		xor	ebx, ebx
		mov	[esp+1520h+var_1510], ebx
		jmp	loc_1001ACAA
sub_1001AA70	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001AD50	proc near		; DATA XREF: sub_1001B480+59o
					; sub_1001B760+78o

var_C8		= dword	ptr -0C8h
var_C4		= byte ptr -0C4h
var_A5		= byte ptr -0A5h
Src		= byte ptr -0A4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0C8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0C8h+var_4], eax
		push	ebp
		mov	ebp, [esp+0CCh+arg_0]
		push	esi
		movzx	esi, word ptr [ebp+3Ah]
		push	edi
		xor	edi, edi
		mov	eax, 300h
		mov	[esp+0D4h+var_C8], edi
		cmp	si, ax
		jb	short loc_1001AD8C
		cmp	byte ptr [ebp+54h], 0
		jz	loc_1001AEEB

loc_1001AD8C:				; CODE XREF: sub_1001AD50+30j
		mov	eax, [ebp+4]
		test	eax, eax
		jz	short loc_1001AD9C
		cmp	eax, 3
		jnz	loc_1001AEEB

loc_1001AD9C:				; CODE XREF: sub_1001AD50+41j
		cmp	[ebp+3Ch], edi
		jnz	short loc_1001ADAC
		call	sub_10018130
		mov	[ebp+3Ch], eax
		mov	[ebp+0Ch], eax

loc_1001ADAC:				; CODE XREF: sub_1001AD50+4Fj
		mov	ecx, 300h
		cmp	si, cx
		jnb	short loc_1001ADC4
		mov	edx, [ebp+3Ch]
		add	edx, dword_10037838
		mov	[ebp+40h], edx
		jmp	short loc_1001ADD0
; ---------------------------------------------------------------------------

loc_1001ADC4:				; CODE XREF: sub_1001AD50+64j
		mov	eax, [ebp+3Ch]
		add	eax, dword_1003783C
		mov	[ebp+40h], eax

loc_1001ADD0:				; CODE XREF: sub_1001AD50+72j
		push	ebx
		push	ebp
		lea	eax, [esp+0DCh+var_C4]
		call	sub_1001A4B0
		mov	ecx, 300h
		add	esp, 4
		cmp	si, cx
		jb	short loc_1001AE2E
		cmp	[ebp+0E8h], edi
		lea	edx, [ebp+0E0h]
		jz	short loc_1001AE13
		cmp	[edx+4], edi
		jz	short loc_1001AE13
		lea	eax, [esp+0D8h+var_C4]
		push	eax
		mov	ecx, offset dword_10037808
		call	sub_1001A330
		add	esp, 4
		mov	edi, eax
		mov	[esp+0D8h+var_C8], eax

loc_1001AE13:				; CODE XREF: sub_1001AD50+A4j
					; sub_1001AD50+A9j
		mov	edx, [ebp+10h]
		test	edx, edx
		jz	short loc_1001AE2E
		lea	ebx, [esp+0D8h+var_C4]
		mov	ecx, offset dword_10037808
		call	sub_1001A1E0
		mov	edi, eax
		mov	[esp+0D8h+var_C8], edi

loc_1001AE2E:				; CODE XREF: sub_1001AD50+96j
					; sub_1001AD50+C8j
		movzx	ecx, [esp+0D8h+var_A5] ; Size
		push	offset dword_10037808 ;	int
		lea	edx, [esp+0DCh+Src] ; Src
		lea	esi, [esp+0DCh+var_C4]
		call	sub_1001A900
		xor	edx, edx
		mov	ebx, eax
		div	dword_1003780C
		lea	ecx, [edx+edx*4]
		mov	edx, dword_10037850
		lea	esi, [edx+ecx*4]
		lea	eax, [esi+4]
		push	eax
		call	sub_10017C50
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001AEEA
		cmp	[esp+0D8h+var_C8], eax
		jnz	short loc_1001AE78
		call	sub_10018130
		mov	edi, eax

loc_1001AE78:				; CODE XREF: sub_1001AD50+11Fj
		mov	ecx, dword_10037800
		mov	[esi], edi
		mov	[esi+10h], ecx
		test	edi, edi
		jz	short loc_1001AEEA
		mov	edx, dword_10037860
		mov	edx, [edx+ebx*4]
		mov	eax, ebx
		shl	eax, 7
		add	eax, edx
		lea	edi, [eax+eax*2]
		shl	edi, 6
		add	edi, dword_10037864
		inc	edx
		and	edx, 7Fh
		mov	ecx, 30h
		lea	esi, [esp+0D8h+var_C4]
		rep movsd
		mov	eax, dword_10037860
		mov	[eax+ebx*4], edx
		xor	edx, edx
		mov	eax, ebx
		div	dword_1003780C
		lea	ecx, [edx+edx*4]
		mov	edx, dword_10037850
		lea	eax, [edx+ecx*4]
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4
		mov	dword ptr [ebp+4], 2

loc_1001AEEA:				; CODE XREF: sub_1001AD50+119j
					; sub_1001AD50+135j
		pop	ebx

loc_1001AEEB:				; CODE XREF: sub_1001AD50+36j
					; sub_1001AD50+46j
		mov	ecx, [esp+0D4h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C8h
		retn
sub_1001AD50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001AF10	proc near		; DATA XREF: sub_1001B480+63o
					; sub_1001B760+82o

Size		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jz	loc_1001AFFF
		push	ebx
		push	ebp
		push	edi
		call	ds:PR_GetError
		mov	[esp+18h+var_4], eax
		mov	eax, 300h
		cmp	[esi+3Ah], ax
		jnb	short loc_1001AF45
		lea	ebp, [esi+54h]
		mov	[esp+18h+Size],	10h
		jmp	short loc_1001AF50
; ---------------------------------------------------------------------------

loc_1001AF45:				; CODE XREF: sub_1001AF10+26j
		movzx	ecx, byte ptr [esi+54h]
		lea	ebp, [esi+55h]
		mov	[esp+18h+Size],	ecx

loc_1001AF50:				; CODE XREF: sub_1001AF10+33j
		mov	ecx, [esp+18h+Size] ; Size
		add	esi, 28h
		push	offset dword_10037808 ;	int
		mov	edx, ebp	; Src
		call	sub_1001A900
		xor	edx, edx
		mov	edi, eax
		div	dword_1003780C
		mov	eax, dword_10037850
		lea	edx, [edx+edx*4]
		lea	ebx, [eax+edx*4]
		lea	ecx, [ebx+4]
		push	ecx
		call	sub_10017C50
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001AFE0
		call	sub_10018130
		mov	edx, dword_10037800
		mov	[ebx], eax
		mov	[ebx+10h], edx
		test	eax, eax
		jz	short loc_1001AFE0
		mov	ebx, [esp+18h+Size]
		push	ebp
		push	esi
		push	eax
		mov	eax, edi
		mov	ecx, offset dword_10037808
		call	sub_1001A990
		xor	ecx, ecx
		add	esp, 0Ch
		cmp	eax, ecx
		jz	short loc_1001AFBB
		mov	[eax+1Eh], cl

loc_1001AFBB:				; CODE XREF: sub_1001AF10+A6j
		xor	edx, edx
		mov	eax, edi
		div	dword_1003780C
		lea	eax, [edx+edx*4]
		mov	edx, dword_10037850
		lea	eax, [edx+eax*4]
		mov	[eax+10h], ecx
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4

loc_1001AFE0:				; CODE XREF: sub_1001AF10+76j
					; sub_1001AF10+8Aj
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [esp+18h+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		mov	dword ptr [eax+4], 3
		pop	esi
		add	esp, 8
		mov	[esp+arg_0], ecx
		jmp	PORT_SetError_Util
; ---------------------------------------------------------------------------

loc_1001AFFF:				; CODE XREF: sub_1001AF10+Aj
		pop	esi
		add	esp, 8
		retn
sub_1001AF10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B010	proc near		; CODE XREF: sub_1001B0B0+367p
					; SSL_ShutdownServerSessionIDCache+Bp ...
		cmp	dword ptr [esi+7Ch], 0
		push	edi
		mov	edi, [esi+38h]
		jz	short loc_1001B07A
		cmp	dword ptr [esi+80h], 0
		jz	short loc_1001B04C
		mov	eax, [esi+48h]
		test	edi, edi
		jle	short loc_1001B04C
		push	ebx
		lea	ebx, [eax+4]
		mov	edi, edi

loc_1001B030:				; CODE XREF: sub_1001B010+39j
		mov	eax, [esi+80h]
		mov	ecx, [eax+44h]
		push	ecx
		push	ebx
		call	sub_10017B30
		dec	edi
		add	esp, 8
		add	ebx, 14h
		test	edi, edi
		jg	short loc_1001B030
		pop	ebx

loc_1001B04C:				; CODE XREF: sub_1001B010+11j
					; sub_1001B010+18j
		cmp	dword ptr [esi+90h], 0
		jz	short loc_1001B067
		mov	edx, [esi]
		mov	eax, [esi+7Ch]
		push	edx
		push	eax
		call	ds:PR_MemUnmap
		add	esp, 8
		jmp	short loc_1001B073
; ---------------------------------------------------------------------------

loc_1001B067:				; CODE XREF: sub_1001B010+43j
		mov	ecx, [esi+7Ch]
		push	ecx
		call	PORT_Free_Util
		add	esp, 4

loc_1001B073:				; CODE XREF: sub_1001B010+55j
		mov	dword ptr [esi+7Ch], 0

loc_1001B07A:				; CODE XREF: sub_1001B010+8j
		mov	eax, [esi+84h]
		pop	edi
		test	eax, eax
		jz	short loc_1001B099
		push	eax
		call	ds:PR_CloseFileMap
		add	esp, 4
		mov	dword ptr [esi+84h], 0

loc_1001B099:				; CODE XREF: sub_1001B010+73j
		push	94h		; Size
		push	0		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		retn
sub_1001B010	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B0B0	proc near		; CODE XREF: sub_1001B480+3Ep

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 0Ch
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, eax
		mov	[esp+14h+var_C], edi
		cmp	ebx, edi
		jz	loc_1001B426
		cmp	esi, edi
		jl	loc_1001B426
		cmp	[esp+14h+arg_10], edi
		jz	loc_1001B426
		cmp	[ebx+7Ch], edi
		jz	short loc_1001B0E4
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001B0E4:				; CODE XREF: sub_1001B0B0+2Aj
		mov	eax, [esp+14h+arg_14]
		mov	[ebx+90h], eax
		mov	[ebx+7Ch], edi
		mov	[esp+14h+var_8], edi
		mov	[ebx+84h], edi
		mov	[ebx+80h], edi
		mov	[ebx+38h], edi
		mov	[ebx+3Ch], edi
		mov	[ebx+40h], edi
		mov	[ebx+44h], edi
		mov	[ebx+88h], edi
		mov	[ebx+8Ch], edi
		cmp	esi, edi
		jnz	short loc_1001B122
		mov	esi, 2710h

loc_1001B122:				; CODE XREF: sub_1001B0B0+6Bj
		mov	ecx, dword_10037104
		add	esi, 7Fh
		shr	esi, 7
		push	ebp
		mov	ebp, esi
		shl	ebp, 7
		mov	[ebx+8], esi
		mov	[ebx+10h], ebp
		cmp	esi, ecx
		jnb	short loc_1001B140
		mov	ecx, esi

loc_1001B140:				; CODE XREF: sub_1001B0B0+8Cj
		xor	edx, edx
		lea	eax, [esi+ecx-1]
		div	ecx
		xor	edx, edx
		mov	[ebx+4], ecx
		mov	[ebx+0Ch], eax
		mov	eax, [esp+18h+arg_0]
		cmp	eax, edi
		setle	dl
		dec	edx
		and	eax, edx
		mov	[esp+18h+var_4], eax
		mov	[ebx+18h], eax
		mov	eax, [esp+18h+arg_4]
		cmp	eax, edi
		mov	edi, eax
		jge	short loc_1001B172
		mov	edi, 3E8h

loc_1001B172:				; CODE XREF: sub_1001B0B0+BBj
		lea	eax, [ecx+ecx*4+28h]
		add	eax, eax
		add	eax, eax
		mov	[ebx+4Ch], eax
		add	eax, 14h
		mov	[ebx+50h], eax
		add	eax, 14h
		mov	[ebx+54h], eax
		add	eax, 23h
		cdq
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		mov	[ebx+58h], eax
		lea	eax, [eax+esi*4+0Fh]
		cdq
		and	edx, 0Fh
		lea	esi, [edx+eax]
		and	esi, 0FFFFFFF0h
		lea	eax, [ebp+ebp*2+0]
		shl	eax, 6
		lea	eax, [eax+esi+0Fh]
		cdq
		and	edx, 0Fh
		lea	ecx, [edx+eax]
		and	ecx, 0FFFFFFF0h
		mov	eax, ecx
		sub	eax, esi
		mov	edx, 7Dh
		mov	[ebx+28h], edi
		mov	dword ptr [ebx+7Ch], 0
		mov	dword ptr [ebx+48h], 0A0h
		mov	[ebx+5Ch], esi
		mov	[ebx+60h], ecx
		mov	[ebx+14h], eax
		cmp	[esp+18h+var_4], edx
		jnb	short loc_1001B1F1
		shr	eax, 0Ch
		mov	[ebx+18h], eax
		cmp	eax, edx
		jnb	short loc_1001B1F1
		mov	[ebx+18h], edx

loc_1001B1F1:				; CODE XREF: sub_1001B0B0+132j
					; sub_1001B0B0+13Cj
		mov	edx, [ebx+18h]
		shl	edx, 0Ch
		lea	eax, [edx+ecx+0Fh]
		cdq
		and	edx, 0Fh
		lea	esi, [edx+eax]
		and	esi, 0FFFFFFF0h
		mov	eax, esi
		sub	eax, ecx
		mov	[ebx+1Ch], eax
		lea	eax, [esi+0A64Fh]
		cdq
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		mov	ecx, eax
		mov	[ebx+68h], eax
		add	eax, 1Bh
		cdq
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		mov	[ebx+6Ch], eax
		add	eax, 213h
		cdq
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		mov	[ebx+70h], eax
		add	eax, 213h
		cdq
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		sub	ecx, esi
		mov	[ebx+74h], eax
		add	eax, 13h
		mov	[ebx+24h], ecx
		cdq
		mov	ecx, edi
		imul	ecx, 430h
		and	edx, 0Fh
		add	eax, edx
		and	eax, 0FFFFFFF0h
		mov	[ebx+78h], eax
		lea	eax, [ecx+eax+0Fh]
		cdq
		and	edx, 0Fh
		add	eax, edx
		mov	[ebx+2Ch], ecx
		mov	ecx, [esp+18h+arg_8]
		and	eax, 0FFFFFFF0h
		mov	[ebx+64h], esi
		mov	dword ptr [ebx+20h], 50h
		mov	[ebx], eax
		mov	edx, 5
		test	ecx, ecx
		jz	short loc_1001B2B7
		cmp	ecx, 64h
		jbe	short loc_1001B2AC
		mov	[esp+18h+arg_8], 64h
		mov	ecx, [esp+18h+arg_8]
		mov	[ebx+30h], ecx
		jmp	short loc_1001B2BE
; ---------------------------------------------------------------------------

loc_1001B2AC:				; CODE XREF: sub_1001B0B0+1E9j
		cmp	ecx, edx
		jnb	short loc_1001B2B2
		mov	ecx, edx

loc_1001B2B2:				; CODE XREF: sub_1001B0B0+1FEj
		mov	[ebx+30h], ecx
		jmp	short loc_1001B2BE
; ---------------------------------------------------------------------------

loc_1001B2B7:				; CODE XREF: sub_1001B0B0+1E4j
		mov	dword ptr [ebx+30h], 64h

loc_1001B2BE:				; CODE XREF: sub_1001B0B0+1FAj
					; sub_1001B0B0+205j
		mov	ecx, [esp+18h+arg_C]
		test	ecx, ecx
		jz	short loc_1001B2EA
		cmp	ecx, 15180h
		jbe	short loc_1001B2DF
		mov	[esp+18h+arg_C], 15180h
		mov	ecx, [esp+18h+arg_C]
		mov	[ebx+34h], ecx
		jmp	short loc_1001B2F1
; ---------------------------------------------------------------------------

loc_1001B2DF:				; CODE XREF: sub_1001B0B0+21Cj
		cmp	ecx, edx
		jnb	short loc_1001B2E5
		mov	ecx, edx

loc_1001B2E5:				; CODE XREF: sub_1001B0B0+231j
		mov	[ebx+34h], ecx
		jmp	short loc_1001B2F1
; ---------------------------------------------------------------------------

loc_1001B2EA:				; CODE XREF: sub_1001B0B0+214j
		mov	dword ptr [ebx+34h], 15180h

loc_1001B2F1:				; CODE XREF: sub_1001B0B0+22Dj
					; sub_1001B0B0+238j
		cmp	[esp+18h+arg_14], 0
		jz	short loc_1001B35A
		call	ds:GetCurrentThreadId
		mov	edx, dword_10037800
		push	eax
		mov	eax, [esp+1Ch+arg_10]
		push	edx
		push	eax
		push	offset aSSvrcache_D_X_ ; "%s/svrcache_%d_%x.ssl"
		call	ds:PR_smprintf
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_1001B415
		mov	ecx, [ebx]
		push	1
		push	ecx
		push	esi
		call	ds:PR_OpenAnonFileMap
		mov	edi, eax
		push	esi
		mov	[esp+28h+var_8], edi
		call	ds:PR_smprintf_free
		add	esp, 10h
		test	edi, edi
		jz	loc_1001B415
		mov	edx, [ebx]
		push	edx
		push	0
		push	0
		push	edi
		call	ds:PR_MemMap
		add	esp, 10h
		jmp	short loc_1001B363
; ---------------------------------------------------------------------------

loc_1001B35A:				; CODE XREF: sub_1001B0B0+246j
		push	eax
		call	PORT_Alloc_Util
		add	esp, 4

loc_1001B363:				; CODE XREF: sub_1001B0B0+2A8j
		mov	ebp, eax
		test	ebp, ebp
		jz	loc_1001B415
		mov	eax, [ebx]
		push	eax		; Size
		push	0		; Val
		push	ebp		; Dst
		call	memset
		mov	ecx, 25h
		mov	esi, ebx
		mov	edi, ebp
		rep movsd
		mov	ecx, [esp+24h+var_8]
		add	[ebx+48h], ebp
		add	[ebx+4Ch], ebp
		add	[ebx+50h], ebp
		add	[ebx+54h], ebp
		add	[ebx+58h], ebp
		add	[ebx+5Ch], ebp
		add	[ebx+60h], ebp
		add	[ebx+64h], ebp
		add	[ebx+68h], ebp
		add	[ebx+6Ch], ebp
		add	[ebx+70h], ebp
		add	[ebx+74h], ebp
		add	[ebx+78h], ebp
		add	esp, 0Ch
		mov	[ebx+84h], ecx
		mov	[ebx+7Ch], ebp
		mov	[ebx+80h], ebp
		call	sub_10018130
		mov	edi, [ebx+4]
		mov	esi, [ebx+48h]
		add	edi, 3
		mov	ebp, eax
		test	edi, edi
		jle	short loc_1001B3FE

loc_1001B3D4:				; CODE XREF: sub_1001B0B0+34Cj
		mov	edx, [esp+18h+arg_14]
		push	edx
		lea	eax, [esi+4]
		push	eax
		call	sub_10017A70
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001B40E
		mov	[esi+10h], eax
		mov	eax, [esp+18h+var_C]
		inc	eax
		mov	[esi], ebp
		add	esi, 14h
		mov	[esp+18h+var_C], eax
		cmp	eax, edi
		jl	short loc_1001B3D4

loc_1001B3FE:				; CODE XREF: sub_1001B0B0+322j
		mov	edx, [esp+18h+var_C]
		pop	ebp
		pop	edi
		mov	[ebx+38h], edx
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001B40E:				; CODE XREF: sub_1001B0B0+337j
		mov	ecx, [esp+18h+var_C]
		mov	[ebx+38h], ecx

loc_1001B415:				; CODE XREF: sub_1001B0B0+26Dj
					; sub_1001B0B0+291j ...
		mov	esi, ebx
		call	sub_1001B010
		pop	ebp
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001B426:				; CODE XREF: sub_1001B0B0+Fj
					; sub_1001B0B0+17j ...
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
sub_1001B0B0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  37. SSL_GetMaxServerCacheLocks

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetMaxServerCacheLocks
SSL_GetMaxServerCacheLocks proc	near	; DATA XREF: .rdata:off_10035848o
		mov	eax, dword_10037104
		add	eax, 2
		retn
SSL_GetMaxServerCacheLocks endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  74. SSL_SetMaxServerCacheLocks

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetMaxServerCacheLocks
SSL_SetMaxServerCacheLocks proc	near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 3
		jnb	short loc_1001B46A
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001B46A:				; CODE XREF: SSL_SetMaxServerCacheLocks+7j
		add	eax, 0FFFFFFFEh
		mov	dword_10037104,	eax
		xor	eax, eax
		retn
SSL_SetMaxServerCacheLocks endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B480	proc near		; CODE XREF: SSL_ConfigServerSessionIDCache+26p
					; sub_1001B550+40p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	esi
		mov	esi, eax
		call	sub_10014850
		test	eax, eax
		jnz	short loc_1001B4EF
		call	ds:GetCurrentProcessId
		mov	dword_10037800,	eax
		test	esi, esi
		jnz	short loc_1001B4A0
		mov	esi, offset aTemp ; "\\temp"

loc_1001B4A0:				; CODE XREF: sub_1001B480+19j
		mov	eax, [esp+4+arg_8]
		mov	ecx, [esp+4+arg_4]
		mov	edx, [esp+4+arg_0]
		push	eax
		mov	eax, [esp+8+arg_14]
		push	esi
		push	ecx
		mov	ecx, [esp+10h+arg_10]
		push	edx
		push	eax
		mov	eax, [esp+18h+arg_C]
		push	ecx
		call	sub_1001B0B0
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001B4CF
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001B4CF:				; CODE XREF: sub_1001B480+48j
		mov	dword_10037EA8,	offset sub_1001AA70
		mov	dword_10037E9C,	offset sub_1001AD50
		mov	dword_10037EA4,	offset sub_1001AF10
		xor	eax, eax

loc_1001B4EF:				; CODE XREF: sub_1001B480+Aj
		pop	esi
		retn
sub_1001B480	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  27. SSL_ConfigServerSessionIDCache

; =============== S U B	R O U T	I N E =======================================


		public SSL_ConfigServerSessionIDCache
SSL_ConfigServerSessionIDCache proc near ; DATA	XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	0
		call	sub_10017EA0
		mov	eax, [esp+8+arg_0]
		mov	ecx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		push	0FFFFFFFFh
		push	0FFFFFFFFh
		push	eax
		mov	eax, [esp+14h+arg_C]
		push	0
		push	ecx
		push	edx
		mov	ebx, offset dword_10037808
		call	sub_1001B480
		add	esp, 1Ch
		pop	ebx
		retn
SSL_ConfigServerSessionIDCache endp

; Exported entry  83. SSL_ShutdownServerSessionIDCache

; =============== S U B	R O U T	I N E =======================================


		public SSL_ShutdownServerSessionIDCache
SSL_ShutdownServerSessionIDCache proc near ; DATA XREF:	.rdata:off_10035848o
		push	esi
		call	sub_10005FC0
		mov	esi, offset dword_10037808
		call	sub_1001B010
		xor	eax, eax
		pop	esi
		retn
SSL_ShutdownServerSessionIDCache endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B550	proc near		; CODE XREF: SSL_ConfigMPServerSIDCache+16p
					; SSL_ConfigServerSessionIDCacheWithOpt+54p

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 90h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+90h+var_4], eax
		mov	eax, [esp+90h+arg_8]
		push	ebx
		push	edx
		mov	edx, [esp+98h+arg_0]
		push	ecx
		push	ecx
		mov	ecx, [esp+0A0h+arg_4]
		push	1
		push	ecx
		push	edx
		mov	ebx, offset dword_10037808
		mov	dword_1003789C,	1
		call	sub_1001B480
		mov	ebx, eax
		add	esp, 18h
		test	ebx, ebx
		jnz	loc_1001B673
		mov	ecx, dword_1003788C
		lea	eax, [esp+94h+var_84]
		push	eax
		push	80h
		push	ecx
		call	ds:PR_ExportFileMapAsString
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1001B6BE
		lea	eax, [esp+94h+var_84]
		lea	edx, [eax+1]
		jmp	short loc_1001B5D0
; ---------------------------------------------------------------------------
		align 10h

loc_1001B5D0:				; CODE XREF: sub_1001B550+7Bj
					; sub_1001B550+85j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B5D0
		sub	eax, edx
		jz	loc_1001B6BE
		mov	edx, dword_10037808
		push	edi
		mov	[esp+98h+var_88], eax
		lea	eax, [esp+98h+var_8C]
		push	8
		push	eax
		mov	[esp+0A0h+var_8C], edx
		call	BTOA_DataToAscii_Util
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_1001B6A4
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_1001B610:				; CODE XREF: sub_1001B550+C5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B610
		sub	eax, edx
		jz	loc_1001B6A4
		push	esi
		lea	ecx, [esp+9Ch+var_84]
		push	ecx
		push	edi
		push	offset aSS	; "%s,%s"
		call	ds:PR_smprintf
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1001B689
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_1001B640:				; CODE XREF: sub_1001B550+F5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B640
		sub	eax, edx
		jz	short loc_1001B689
		push	edi
		call	PORT_Free_Util
		push	esi
		push	offset VarName	; "SSL_INHERITANCE"
		call	NSS_PutEnv_Util
		push	esi
		mov	edi, eax
		call	ds:PR_smprintf_free
		add	esp, 10h
		test	edi, edi
		jz	short loc_1001B66F
		or	ebx, 0FFFFFFFFh

loc_1001B66F:				; CODE XREF: sub_1001B550+11Aj
		pop	esi
		mov	eax, ebx
		pop	edi

loc_1001B673:				; CODE XREF: sub_1001B550+4Cj
		pop	ebx
		mov	ecx, [esp+90h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_1001B689:				; CODE XREF: sub_1001B550+E8j
					; sub_1001B550+F9j
		pop	esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+90h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_1001B6A4:				; CODE XREF: sub_1001B550+B1j
					; sub_1001B550+C9j
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+90h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_1001B6BE:				; CODE XREF: sub_1001B550+6Ej
					; sub_1001B550+89j
		mov	ecx, [esp+94h+var_4]
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
sub_1001B550	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  24. SSL_ConfigMPServerSIDCache

; =============== S U B	R O U T	I N E =======================================


		public SSL_ConfigMPServerSIDCache
SSL_ConfigMPServerSIDCache proc	near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	eax
		push	ecx
		mov	ecx, [esp+8+arg_0]
		push	edx
		or	edx, 0FFFFFFFFh
		call	sub_1001B550
		add	esp, 0Ch
		retn
SSL_ConfigMPServerSIDCache endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  28. SSL_ConfigServerSessionIDCacheWithOpt

; =============== S U B	R O U T	I N E =======================================


		public SSL_ConfigServerSessionIDCacheWithOpt
SSL_ConfigServerSessionIDCacheWithOpt proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		cmp	[esp+arg_18], 0
		jnz	short loc_1001B73D
		push	ebx
		push	0
		call	sub_10017EA0
		mov	eax, [esp+8+arg_14]
		mov	ecx, [esp+8+arg_10]
		mov	edx, [esp+8+arg_C]
		push	eax
		mov	eax, [esp+0Ch+arg_4]
		push	ecx
		mov	ecx, [esp+10h+arg_0]
		push	edx
		push	0
		push	eax
		mov	eax, [esp+1Ch+arg_8]
		push	ecx
		mov	ebx, offset dword_10037808
		call	sub_1001B480
		add	esp, 1Ch
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B73D:				; CODE XREF: SSL_ConfigServerSessionIDCacheWithOpt+5j
		mov	edx, [esp+arg_8]
		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	edx
		mov	edx, [esp+4+arg_14]
		push	eax
		push	ecx
		mov	ecx, [esp+0Ch+arg_C]
		call	sub_1001B550
		add	esp, 0Ch
		retn
SSL_ConfigServerSessionIDCacheWithOpt endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001B760(void	*Dst, int)
sub_1001B760	proc near		; CODE XREF: SSL_InheritMPServerSIDCache+Ap

var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= byte ptr -98h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
Dst		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0B4h
		push	ebx
		push	esi
		xor	ebx, ebx
		push	edi
		mov	[esp+0C0h+var_B0], ebx
		mov	[esp+0C0h+var_A8], ebx
		call	sub_10014850
		cmp	eax, ebx
		jnz	loc_1001B9DD
		call	ds:GetCurrentProcessId
		mov	dword_10037800,	eax
		cmp	dword_1003789C,	ebx
		jz	short loc_1001B7C2
		mov	eax, [ebp+Dst]
		cmp	eax, ebx
		jz	loc_1001B9DB
		mov	eax, [eax+80h]
		cmp	eax, ebx
		jz	loc_1001B9DB
		mov	dword ptr [eax+44h], 1
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B7C2:				; CODE XREF: sub_1001B760+37j
		push	ebx
		call	sub_10017EA0
		mov	eax, [ebp+arg_4]
		add	esp, 4
		mov	dword_10037EA8,	offset sub_1001AA70
		mov	dword_10037E9C,	offset sub_1001AD50
		mov	dword_10037EA4,	offset sub_1001AF10
		cmp	eax, ebx
		jnz	short loc_1001B806
		push	offset VarName	; "SSL_INHERITANCE"
		call	ds:getenv
		add	esp, 4
		cmp	eax, ebx
		jz	loc_1001BA0C

loc_1001B806:				; CODE XREF: sub_1001B760+8Ej
		push	eax
		call	PORT_Strdup_Util
		mov	edi, eax
		add	esp, 4
		mov	[esp+0C0h+var_AC], edi
		cmp	edi, ebx
		jz	loc_1001BA0C
		push	2Ch		; Val
		push	edi		; Str
		call	ds:strchr
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		mov	ebx, [ebp+Dst]
		jz	loc_1001B9EB
		lea	eax, [esp+0C0h+var_A4]
		push	eax
		mov	byte ptr [esi],	0
		push	edi
		inc	esi
		call	ATOB_AsciiToData_Util
		add	esp, 8
		mov	[esp+0C0h+var_B0], eax
		test	eax, eax
		jz	loc_1001B9EB
		cmp	[esp+0C0h+var_A4], 8
		jnz	loc_1001B9EB
		mov	ecx, [eax]
		mov	edx, [eax+4]
		mov	eax, esi
		mov	[esp+0C0h+var_A0], ecx
		lea	edi, [eax+1]
		lea	ecx, [ecx+0]

loc_1001B870:				; CODE XREF: sub_1001B760+115j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B870
		sub	eax, edi
		cmp	eax, edx
		jnz	loc_1001B9E7
		push	94h		; Size
		push	0		; Val
		push	ebx		; Dst
		call	memset
		mov	edx, [esp+0CCh+var_A0]
		push	esi
		mov	[ebx], edx
		call	ds:PR_ImportFileMapFromString
		add	esp, 10h
		mov	[ebx+84h], eax
		test	eax, eax
		jz	loc_1001B9E7
		mov	ecx, [ebx]
		push	ecx
		push	0
		push	0
		push	eax
		call	ds:PR_MemMap
		add	esp, 10h
		mov	[ebx+7Ch], eax
		test	eax, eax
		jz	loc_1001B9E7
		mov	[ebx+80h], eax
		mov	edx, [eax]
		cmp	edx, [ebx]
		jnz	loc_1001B9E7
		mov	ecx, 25h
		mov	esi, ebx
		lea	edi, [esp+0C0h+var_98]
		rep movsd
		mov	esi, eax
		mov	eax, [esp+0C0h+var_1C]
		mov	ecx, 25h
		mov	edi, ebx
		rep movsd
		mov	esi, [ebx+4]
		mov	ecx, [esp+0C0h+var_14]
		add	[ebx+48h], eax
		add	[ebx+4Ch], eax
		add	[ebx+50h], eax
		add	[ebx+54h], eax
		add	[ebx+58h], eax
		add	[ebx+5Ch], eax
		add	[ebx+60h], eax
		add	[ebx+64h], eax
		add	[ebx+68h], eax
		add	[ebx+6Ch], eax
		add	[ebx+70h], eax
		add	[ebx+74h], eax
		add	[ebx+78h], eax
		add	esi, 3
		lea	edi, [esi+esi*4]
		add	edi, edi
		add	edi, edi
		push	edi
		mov	[ebx+84h], ecx
		mov	[ebx+7Ch], eax
		mov	[ebx+80h], eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[esp+0C0h+var_A0], eax
		test	eax, eax
		jz	loc_1001B9E7
		mov	edx, [ebx+48h]
		push	edi		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+0CCh+var_A0]
		add	esp, 0Ch
		mov	[ebx+48h], eax
		test	esi, esi
		jle	short loc_1001B98F
		lea	edi, [eax+4]

loc_1001B972:				; CODE XREF: sub_1001B760+22Dj
		push	edi
		call	sub_10017A40
		add	esp, 4
		test	eax, eax
		mov	eax, [esp+0C0h+var_A8]
		jnz	short loc_1001B9E4
		inc	eax
		add	edi, 14h
		mov	[esp+0C0h+var_A8], eax
		cmp	eax, esi
		jl	short loc_1001B972

loc_1001B98F:				; CODE XREF: sub_1001B760+20Dj
		mov	eax, [ebx+4]
		mov	ecx, [esp+0C0h+var_A8]
		lea	edx, [eax+eax*4]
		mov	eax, [ebx+48h]
		lea	eax, [eax+edx*4]
		mov	[ebx+4Ch], eax
		add	eax, 14h
		mov	[ebx+38h], ecx
		mov	ecx, [esp+0C0h+var_AC]
		mov	[ebx+50h], eax
		add	eax, 14h
		push	ecx
		mov	[ebx+54h], eax
		call	PORT_Free_Util
		mov	edx, [esp+0C4h+var_B0]
		push	edx
		call	PORT_Free_Util
		mov	ecx, [ebx+80h]
		mov	eax, 1
		add	esp, 8
		mov	[ecx+44h], eax
		mov	dword_1003789C,	eax

loc_1001B9DB:				; CODE XREF: sub_1001B760+3Ej
					; sub_1001B760+4Cj
		xor	eax, eax

loc_1001B9DD:				; CODE XREF: sub_1001B760+20j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001B9E4:				; CODE XREF: sub_1001B760+221j
		mov	[ebx+38h], eax

loc_1001B9E7:				; CODE XREF: sub_1001B760+11Bj
					; sub_1001B760+146j ...
		mov	edi, [esp+0C0h+var_AC]

loc_1001B9EB:				; CODE XREF: sub_1001B760+D0j
					; sub_1001B760+EEj ...
		push	edi
		call	PORT_Free_Util
		mov	eax, [esp+0C4h+var_B0]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001BA05
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001BA05:				; CODE XREF: sub_1001B760+29Aj
		mov	esi, ebx
		call	sub_1001B010

loc_1001BA0C:				; CODE XREF: sub_1001B760+A0j
					; sub_1001B760+B7j
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001B760	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  48. SSL_InheritMPServerSIDCache

; =============== S U B	R O U T	I N E =======================================


		public SSL_InheritMPServerSIDCache
SSL_InheritMPServerSIDCache proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax		; int
		push	offset dword_10037808 ;	Dst
		call	sub_1001B760
		add	esp, 8
		retn
SSL_InheritMPServerSIDCache endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BA40	proc near		; CODE XREF: sub_1001BB10+20p
					; sub_1001C070+8Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, ebp
		shl	esi, 4
		add	esi, [esp+0Ch+arg_0]
		mov	ebx, eax
		imul	esi, 214h
		add	esi, [ebx+64h]
		xor	eax, eax
		mov	[esp+0Ch+arg_4], eax
		cmp	[ebx+7Ch], eax
		jnz	short loc_1001BA79
		push	0FFFFD067h
		call	PORT_SetError_Util
		add	esp, 4
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001BA79:				; CODE XREF: sub_1001BA40+24j
		push	edi
		cmp	[esp+10h+arg_C], eax
		jnz	short loc_1001BAAE
		mov	edi, [ebx+4Ch]
		lea	eax, [edi+4]
		push	eax
		call	sub_10017C50
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001BAA7
		call	sub_10018130
		mov	ecx, dword_10037800
		mov	[edi], eax
		mov	[edi+10h], ecx
		test	eax, eax
		jnz	short loc_1001BAAE

loc_1001BAA7:				; CODE XREF: sub_1001BA40+51j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001BAAE:				; CODE XREF: sub_1001BA40+3Ej
					; sub_1001BA40+65j
		cmp	[esi+208h], ebp
		jnz	short loc_1001BADF
		mov	edx, [esp+10h+arg_0]
		cmp	[esi+20Ch], edx
		jnz	short loc_1001BADF
		cmp	word ptr [esi+210h], 0
		jz	short loc_1001BADF
		mov	edi, [esp+10h+arg_8]
		mov	ecx, 85h
		rep movsd
		mov	[esp+10h+arg_4], 1

loc_1001BADF:				; CODE XREF: sub_1001BA40+74j
					; sub_1001BA40+80j ...
		test	eax, eax
		jz	short loc_1001BAF9
		mov	ebx, [ebx+4Ch]
		mov	dword ptr [ebx+10h], 0
		add	ebx, 4
		push	ebx
		call	sub_10017BE0
		add	esp, 4

loc_1001BAF9:				; CODE XREF: sub_1001BA40+A1j
		mov	eax, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001BA40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BB10	proc near		; CODE XREF: sub_10006050+E0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_4]
		cmp	ecx, 5
		jnb	short loc_1001BB39
		mov	eax, [esp+arg_0]
		cmp	eax, 10h
		jnb	short loc_1001BB39
		mov	edx, [esp+arg_8]
		push	0
		push	edx
		push	ecx
		push	eax
		mov	eax, offset dword_10037808
		call	sub_1001BA40
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1001BB39:				; CODE XREF: sub_1001BB10+7j
					; sub_1001BB10+10j
		xor	eax, eax
		retn
sub_1001BB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BB40	proc near		; CODE XREF: sub_1001BCB0+43p
					; sub_1001BCB0+56p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		xor	eax, eax
		push	esi
		mov	[esp+10h+var_C], eax
		mov	[esp+10h+var_8], eax
		mov	[esp+10h+var_4], eax
		call	SECKEY_PublicKeyStrength
		add	esp, 4
		mov	[esp+0Ch+var_4], eax
		cmp	eax, 200h
		jbe	short loc_1001BB6B

loc_1001BB65:				; CODE XREF: sub_1001BB40+45j
		xor	eax, eax
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BB6B:				; CODE XREF: sub_1001BB40+23j
		mov	ecx, [esp+0Ch+arg_0]
		lea	eax, [esp+0Ch+var_C]
		push	eax
		push	ecx
		push	esi
		push	1
		mov	[esp+1Ch+var_8], edi
		call	PK11_PubWrapSymKey
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001BB65
		mov	edx, [esp+0Ch+var_4]
		mov	[edi+200h], edx
		mov	eax, 1
		add	esp, 0Ch
		retn
sub_1001BB40	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BBA0	proc near		; CODE XREF: sub_1001BCB0+20p
					; sub_1001BE20+22p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		cmp	dword_10037884,	0
		mov	eax, [esp+24h+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, edx
		mov	[esp+30h+var_14], eax
		mov	[esp+30h+var_18], ecx
		jnz	short loc_1001BBD2
		lea	edx, [esp+30h+var_10]
		mov	[esp+30h+var_24], edx
		jmp	short loc_1001BBDB
; ---------------------------------------------------------------------------

loc_1001BBD2:				; CODE XREF: sub_1001BBA0+26j
		mov	eax, dword_10037870
		mov	[esp+30h+var_24], eax

loc_1001BBDB:				; CODE XREF: sub_1001BBA0+30j
		mov	ecx, [esp+30h+var_24]
		push	0Ch
		push	ecx
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jnz	loc_1001BC94
		push	edi
		lea	edx, [esp+34h+var_20]
		push	2
		push	edx
		mov	[esp+3Ch+var_20], 1082h
		mov	[esp+3Ch+var_1C], 251h
		call	PK11_GetBestSlotMultiple
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_1001BC94
		mov	eax, [esp+30h+var_20]
		push	edi
		push	20h
		push	0
		push	eax
		push	esi
		call	PK11_KeyGen
		mov	ecx, [esp+44h+var_1C]
		push	edi
		push	20h
		push	0
		push	ecx
		push	esi
		mov	ebp, eax
		call	PK11_KeyGen
		push	esi
		mov	edi, eax
		call	PK11_FreeSlot
		add	esp, 2Ch
		test	ebp, ebp
		jz	short loc_1001BC87
		test	edi, edi
		jz	short loc_1001BC84
		mov	eax, [esp+30h+var_24]
		mov	edx, [eax]
		mov	[ebx], edx
		mov	ecx, [eax+4]
		mov	[ebx+4], ecx
		mov	edx, [eax+8]
		mov	eax, [esp+30h+var_14]
		mov	ecx, [esp+30h+var_18]
		mov	[ebx+8], edx
		mov	[eax], ebp
		mov	[ecx], edi
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebp
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001BC84:				; CODE XREF: sub_1001BBA0+ABj
		push	ebp
		jmp	short loc_1001BC8C
; ---------------------------------------------------------------------------

loc_1001BC87:				; CODE XREF: sub_1001BBA0+A7j
		test	edi, edi
		jz	short loc_1001BC94
		push	edi

loc_1001BC8C:				; CODE XREF: sub_1001BBA0+E5j
		call	PK11_FreeSymKey
		add	esp, 4

loc_1001BC94:				; CODE XREF: sub_1001BBA0+4Cj
					; sub_1001BBA0+76j ...
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001BBA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BCB0	proc near		; CODE XREF: sub_1001BE20+81p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		push	esi
		mov	esi, eax
		push	edi
		lea	eax, [esp+18h+var_8]
		xor	edi, edi
		push	eax
		lea	ecx, [esp+1Ch+var_4]
		mov	[esp+1Ch+var_8], edi
		mov	[esp+1Ch+var_4], edi
		call	sub_1001BBA0
		mov	ebx, [esp+1Ch+var_8]
		mov	ebp, [esp+1Ch+var_4]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001BD12
		cmp	dword_10037884,	edi
		jz	short loc_1001BD36
		mov	edi, dword_10037874
		push	ebx
		call	sub_1001BB40
		add	esp, 4
		test	eax, eax
		jz	short loc_1001BD12
		mov	edi, dword_10037878
		push	ebp
		call	sub_1001BB40
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001BD36

loc_1001BD12:				; CODE XREF: sub_1001BCB0+32j
					; sub_1001BCB0+4Dj
		test	ebx, ebx
		jz	short loc_1001BD1F
		push	ebx
		call	PK11_FreeSymKey
		add	esp, 4

loc_1001BD1F:				; CODE XREF: sub_1001BCB0+64j
		test	ebp, ebp
		jz	short loc_1001BD2C
		push	ebp
		call	PK11_FreeSymKey
		add	esp, 4

loc_1001BD2C:				; CODE XREF: sub_1001BCB0+71j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001BD36:				; CODE XREF: sub_1001BCB0+3Aj
					; sub_1001BCB0+60j
		mov	ecx, [esp+18h+arg_4]
		mov	edx, [esp+18h+arg_8]
		pop	edi
		mov	[ecx], ebx
		pop	esi
		mov	[edx], ebp
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 8
		retn
sub_1001BCB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BD50	proc near		; CODE XREF: sub_1001BE20+CFp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	eax, dword_10037874
		push	esi
		push	0
		push	105h
		push	1082h
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_4], 0
		mov	[esp+1Ch+var_C], 0
		mov	[esp+1Ch+var_8], eax
		mov	eax, [eax+200h]
		push	ecx
		push	edi
		mov	[esp+24h+var_4], eax
		call	PK11_PubUnwrapSymKey
		mov	esi, eax
		mov	eax, dword_10037878
		push	0
		mov	[esp+28h+var_8], eax
		mov	edx, [eax+200h]
		push	108h
		push	251h
		lea	eax, [esp+30h+var_C]
		push	eax
		push	edi
		mov	[esp+38h+var_4], edx
		call	PK11_PubUnwrapSymKey
		add	esp, 28h
		test	esi, esi
		jz	short loc_1001BE01
		test	eax, eax
		jz	short loc_1001BDF1
		mov	ecx, dword_10037870
		mov	edx, [ecx]
		mov	[ebx], edx
		mov	edx, [ecx+4]
		mov	[ebx+4], edx
		mov	ecx, [ecx+8]
		mov	edx, [esp+10h+arg_0]
		mov	[ebx+8], ecx
		mov	ecx, [esp+10h+arg_4]
		mov	[edx], esi
		mov	[ecx], eax
		mov	eax, 1
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BDF1:				; CODE XREF: sub_1001BD50+73j
		push	esi
		call	PK11_FreeSymKey
		add	esp, 4
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001BE01:				; CODE XREF: sub_1001BD50+6Fj
		test	eax, eax
		jz	short loc_1001BE0E
		push	eax
		call	PK11_FreeSymKey
		add	esp, 4

loc_1001BE0E:				; CODE XREF: sub_1001BD50+B3j
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
sub_1001BD50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BE20	proc near		; CODE XREF: sub_10014900+48p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ebx
		push	edi
		xor	edi, edi
		mov	[esp+0Ch+var_4], edi
		cmp	dword_10037884,	edi
		jnz	short loc_1001BE4E
		mov	eax, [esp+0Ch+arg_10]
		mov	ecx, [esp+0Ch+arg_14]
		mov	ebx, [esp+0Ch+arg_C]
		mov	edx, [esp+0Ch+arg_8]
		push	eax
		call	sub_1001BBA0
		add	esp, 4
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BE4E:				; CODE XREF: sub_1001BE20+Fj
		push	esi
		mov	esi, dword_10037854
		lea	ecx, [esi+4]
		push	ecx
		call	sub_10017C50
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001BE79
		call	sub_10018130
		mov	edx, dword_10037800
		mov	[esi], eax
		mov	[esi+10h], edx
		cmp	eax, edi
		jnz	short loc_1001BE80

loc_1001BE79:				; CODE XREF: sub_1001BE20+43j
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001BE80:				; CODE XREF: sub_1001BE20+57j
		mov	eax, dword_1003787C
		mov	esi, [esp+10h+arg_14]
		mov	ebx, [esp+10h+arg_C]
		push	ebp
		mov	ebp, [esp+14h+arg_10]
		cmp	[eax], edi
		jnz	short loc_1001BEC1
		mov	edx, [esp+14h+arg_8]
		mov	eax, [esp+14h+arg_4]
		push	esi
		push	ebp
		push	ebx
		call	sub_1001BCB0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BEC6
		mov	ecx, dword_1003787C
		mov	[esp+14h+var_4], 1
		mov	dword ptr [ecx], 1

loc_1001BEC1:				; CODE XREF: sub_1001BE20+74j
		mov	edi, 1

loc_1001BEC6:				; CODE XREF: sub_1001BE20+8Bj
		mov	eax, dword_10037854
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4
		test	edi, edi
		jz	short loc_1001BEF9
		cmp	[esp+14h+var_4], 0
		jnz	short loc_1001BEF9
		mov	edi, [esp+14h+arg_0]
		push	esi
		push	ebp
		call	sub_1001BD50
		add	esp, 8
		mov	edi, eax

loc_1001BEF9:				; CODE XREF: sub_1001BE20+C0j
					; sub_1001BE20+C7j
		pop	ebp
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1001BE20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BF10	proc near		; CODE XREF: .text:10014A35p

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_44		= byte ptr -44h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		mov	eax, [esp+64h+arg_4]
		mov	ecx, [esp+64h+arg_8]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+70h+arg_0]
		push	edi
		xor	edi, edi
		mov	[esp+74h+var_58], eax
		mov	[esp+74h+var_54], ecx
		mov	[esp+74h+var_64], edi
		mov	[esp+74h+var_5C], 1
		cmp	dword_10037884,	edi
		jnz	short loc_1001BF5E
		lea	edx, [esp+74h+var_24]
		lea	ebx, [esp+74h+var_50]
		lea	ebp, [esp+74h+var_44]
		mov	[esp+74h+var_60], edx
		jmp	short loc_1001BFC0
; ---------------------------------------------------------------------------

loc_1001BF5E:				; CODE XREF: sub_1001BF10+3Aj
		mov	edi, dword_10037854
		mov	eax, dword_10037878
		mov	ebx, dword_10037870
		mov	ebp, dword_10037874
		lea	ecx, [edi+4]
		push	ecx
		mov	[esp+78h+var_60], eax
		call	sub_10017C50
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001BF9D
		call	sub_10018130
		mov	edx, dword_10037800
		mov	[edi], eax
		mov	[edi+10h], edx
		test	eax, eax
		jnz	short loc_1001BFB2

loc_1001BF9D:				; CODE XREF: sub_1001BF10+77j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1001BFB2:				; CODE XREF: sub_1001BF10+8Bj
		mov	eax, dword_1003787C
		cmp	dword ptr [eax], 0
		mov	edi, [esp+74h+var_5C]
		jnz	short loc_1001C001

loc_1001BFC0:				; CODE XREF: sub_1001BF10+4Cj
		push	0Ch
		push	ebx
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001C009
		push	20h
		push	ebp
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001C009
		mov	ecx, [esp+74h+var_60]
		push	20h
		push	ecx
		call	PK11_GenerateRandom
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001C009
		test	edi, edi
		jz	short loc_1001C001
		mov	edx, dword_1003787C
		mov	dword ptr [edx], 1

loc_1001C001:				; CODE XREF: sub_1001BF10+AEj
					; sub_1001BF10+E3j
		mov	[esp+74h+var_64], 1

loc_1001C009:				; CODE XREF: sub_1001BF10+BDj
					; sub_1001BF10+CCj ...
		test	edi, edi
		jz	short loc_1001C025
		mov	eax, dword_10037854
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4

loc_1001C025:				; CODE XREF: sub_1001BF10+FBj
		cmp	[esp+74h+var_64], 0
		jz	short loc_1001C058
		mov	eax, [ebx]
		mov	edi, [esp+74h+var_58]
		mov	[esi], eax
		mov	ecx, [ebx+4]
		mov	[esi+4], ecx
		mov	edx, [ebx+8]
		mov	[esi+8], edx
		mov	ecx, 8
		mov	esi, ebp
		rep movsd
		mov	esi, [esp+74h+var_60]
		mov	edi, [esp+74h+var_54]
		mov	ecx, 8
		rep movsd

loc_1001C058:				; CODE XREF: sub_1001BF10+11Aj
		mov	ecx, [esp+74h+var_4]
		mov	eax, [esp+74h+var_64]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
sub_1001BF10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C070	proc near		; CODE XREF: sub_10006050+373p

var_218		= dword	ptr -218h
Dst		= byte ptr -214h
arg_0		= dword	ptr  4

		sub	esp, 218h
		push	ebx
		mov	ebx, [esp+21Ch+arg_0]
		mov	eax, [ebx+20Ch]
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	esi, [ebx+208h]
		mov	[esp+224h+var_218], eax
		cmp	dword_10037884,	ebp
		jnz	short loc_1001C0B3
		push	0FFFFD067h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001C0A7:				; CODE XREF: sub_1001C070+46j
					; sub_1001C070+4Bj
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 218h
		retn
; ---------------------------------------------------------------------------

loc_1001C0B3:				; CODE XREF: sub_1001C070+28j
		cmp	esi, 5
		jnb	short loc_1001C0A7
		cmp	eax, 10h
		jnb	short loc_1001C0A7
		push	edi
		push	214h		; Size
		lea	eax, [esp+22Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		call	memset
		mov	edi, dword_10037854
		add	esp, 0Ch
		xor	eax, eax
		call	sub_1001A180
		test	eax, eax
		jz	short loc_1001C148
		mov	edx, [ebx+208h]
		push	eax
		mov	eax, [ebx+20Ch]
		lea	ecx, [esp+22Ch+Dst]
		push	ecx
		push	edx
		push	eax
		mov	eax, offset dword_10037808
		call	sub_1001BA40
		mov	ebp, eax
		add	esp, 10h
		mov	ecx, 85h
		test	ebp, ebp
		jz	short loc_1001C117
		lea	esi, [esp+228h+Dst]
		mov	edi, ebx
		jmp	short loc_1001C12E
; ---------------------------------------------------------------------------

loc_1001C117:				; CODE XREF: sub_1001C070+9Dj
		mov	edi, esi
		shl	edi, 4
		add	edi, [esp+228h+var_218]
		mov	esi, ebx
		imul	edi, 214h
		add	edi, dword_1003786C

loc_1001C12E:				; CODE XREF: sub_1001C070+A5j
		rep movsd
		mov	eax, dword_10037854
		mov	dword ptr [eax+10h], 0
		add	eax, 4
		push	eax
		call	sub_10017BE0
		add	esp, 4

loc_1001C148:				; CODE XREF: sub_1001C070+71j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 218h
		retn
sub_1001C070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C160	proc near		; CODE XREF: DTLS_GetHandshakeTimeout+6p
					; SSL_PeerCertificate+5p ...

arg_0		= dword	ptr  4

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		mov	ecx, eax
		add	esp, 8
		test	ecx, ecx
		jnz	short loc_1001C18A
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001C18A:				; CODE XREF: sub_1001C160+18j
		mov	eax, [ecx+4]
		mov	[eax], ecx
		retn
sub_1001C160	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001C190	proc near		; CODE XREF: sub_1001C3A0:loc_1001C490p
					; sub_1001E8F0:loc_1001E974p ...
		mov	eax, [esi+254h]
		push	ebp
		mov	ebp, ds:PR_DestroyMonitor
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_1001C1B0
		push	eax
		call	ebp ; PR_DestroyMonitor
		add	esp, 4
		mov	[esi+254h], edi

loc_1001C1B0:				; CODE XREF: sub_1001C190+12j
		mov	eax, [esi+258h]
		cmp	eax, edi
		jz	short loc_1001C1C6
		push	eax
		call	ebp ; PR_DestroyMonitor
		add	esp, 4
		mov	[esi+258h], edi

loc_1001C1C6:				; CODE XREF: sub_1001C190+28j
		mov	eax, [esi+25Ch]
		cmp	eax, edi
		jz	short loc_1001C1DF
		push	eax
		call	NSSRWLock_Destroy_Util
		add	esp, 4
		mov	[esi+25Ch], edi

loc_1001C1DF:				; CODE XREF: sub_1001C190+3Ej
		mov	eax, [esi+244h]
		push	ebx
		mov	ebx, ds:PR_DestroyLock
		cmp	eax, edi
		jz	short loc_1001C1FC
		push	eax
		call	ebx ; PR_DestroyLock
		add	esp, 4
		mov	[esi+244h], edi

loc_1001C1FC:				; CODE XREF: sub_1001C190+5Ej
		mov	eax, [esi+248h]
		cmp	eax, edi
		jz	short loc_1001C212
		push	eax
		call	ebx ; PR_DestroyLock
		add	esp, 4
		mov	[esi+248h], edi

loc_1001C212:				; CODE XREF: sub_1001C190+74j
		mov	eax, [esi+250h]
		pop	ebx
		cmp	eax, edi
		jz	short loc_1001C229
		push	eax
		call	ebp ; PR_DestroyMonitor
		add	esp, 4
		mov	[esi+250h], edi

loc_1001C229:				; CODE XREF: sub_1001C190+8Bj
		mov	eax, [esi+24Ch]
		cmp	eax, edi
		jz	short loc_1001C23F
		push	eax
		call	ebp ; PR_DestroyMonitor
		add	esp, 4
		mov	[esi+24Ch], edi

loc_1001C23F:				; CODE XREF: sub_1001C190+A1j
		pop	edi
		pop	ebp
		retn
sub_1001C190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C250	proc near		; CODE XREF: sub_1001C3A0:loc_1001C407p
					; sub_1001EB40:loc_1001ED35p
		push	ebx
		push	ebp
		lea	eax, [esi+48h]
		push	edi
		push	eax		; Dst
		call	sub_10019350
		push	esi
		call	sub_100078C0
		mov	ecx, [esi+2D4h]
		push	ecx
		call	PORT_Free_Util
		mov	edx, [esi+2E0h]
		push	edx
		call	PORT_Free_Util
		lea	eax, [esi+274h]
		push	eax
		call	sub_10017540
		mov	eax, [esi+1E8h]
		xor	edi, edi
		add	esp, 14h
		cmp	eax, edi
		jz	short loc_1001C29E
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001C29E:				; CODE XREF: sub_1001C250+43j
		mov	eax, [esi+1D8h]
		cmp	eax, edi
		jz	short loc_1001C2B1
		push	eax
		call	PORT_Free_Util
		add	esp, 4

loc_1001C2B1:				; CODE XREF: sub_1001C250+56j
		mov	eax, [esi+1ECh]
		cmp	eax, edi
		jz	short loc_1001C2D0
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	[esi+1ECh], edi
		mov	[esi+1F0h], edi

loc_1001C2D0:				; CODE XREF: sub_1001C250+69j
		lea	ebx, [esi+33Ch]
		lea	edi, [esi+2F4h]
		mov	ebp, 5

loc_1001C2E1:				; CODE XREF: sub_1001C250+DEj
		mov	eax, [edi-8]
		test	eax, eax
		jz	short loc_1001C2F1
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_1001C2F1:				; CODE XREF: sub_1001C250+96j
		mov	eax, [edi-4]
		test	eax, eax
		jz	short loc_1001C301
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4

loc_1001C301:				; CODE XREF: sub_1001C250+A6j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_1001C310
		push	eax
		call	sub_100074E0
		add	esp, 4

loc_1001C310:				; CODE XREF: sub_1001C250+B5j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_1001C327
		push	1
		push	eax
		call	SECITEM_FreeArray
		add	esp, 8
		mov	dword ptr [ebx], 0

loc_1001C327:				; CODE XREF: sub_1001C250+C4j
		add	ebx, 4
		add	edi, 10h
		dec	ebp
		jnz	short loc_1001C2E1
		mov	eax, [esi+1F8h]
		pop	edi
		pop	ebp
		pop	ebx
		test	eax, eax
		jz	short loc_1001C350
		push	eax
		call	sub_100074E0
		add	esp, 4
		mov	dword ptr [esi+1F8h], 0

loc_1001C350:				; CODE XREF: sub_1001C250+EBj
		mov	eax, [esi+444h]
		test	eax, eax
		jz	short loc_1001C36D
		push	eax
		call	sub_100074E0
		add	esp, 4
		mov	dword ptr [esi+444h], 0

loc_1001C36D:				; CODE XREF: sub_1001C250+108j
		lea	ecx, [esi+8]
		push	0
		push	ecx
		call	SECITEM_FreeItem_Util
		mov	eax, [esi+2F30h]
		add	esp, 8
		test	eax, eax
		jz	short locret_1001C398
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	dword ptr [esi+2F30h], 0

locret_1001C398:			; CODE XREF: sub_1001C250+133j
		retn
sub_1001C250	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C3A0	proc near		; CODE XREF: sub_10014750+41p
					; sub_1001ED60+349p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_1001C407
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C407
		mov	ecx, [esi+24Ch]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C407
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C407
		mov	eax, [esi+250h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C407
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_LockWrite_Util
		add	esp, 4

loc_1001C407:				; CODE XREF: sub_1001C3A0+12j
					; sub_1001C3A0+23j ...
		call	sub_1001C250
		mov	eax, [esi+244h]
		mov	edi, ds:PR_Unlock
		test	eax, eax
		jz	short loc_1001C422
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_1001C422:				; CODE XREF: sub_1001C3A0+7Aj
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001C432
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_1001C432:				; CODE XREF: sub_1001C3A0+8Aj
		mov	edi, ds:PR_ExitMonitor
		test	[esi+16h], bl
		jnz	short loc_1001C490
		mov	edx, [esi+254h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C490
		mov	eax, [esi+24Ch]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C490
		mov	ecx, [esi+258h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C490
		mov	edx, [esi+250h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001C490
		mov	eax, [esi+25Ch]
		push	eax
		call	NSSRWLock_UnlockWrite_Util
		add	esp, 4

loc_1001C490:				; CODE XREF: sub_1001C3A0+9Bj
					; sub_1001C3A0+ACj ...
		call	sub_1001C190
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_1001C3A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C4B0	proc near		; CODE XREF: sub_10019410+37p

var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+8]
		xor	ecx, ecx
		push	esi
		or	esi, 0FFFFFFFFh
		cmp	[esp+50h+arg_4], ecx
		mov	[esp+50h+var_4C], 0Dh
		setz	cl
		mov	[esp+50h+var_44], ecx
		mov	edx, [eax]
		mov	ecx, [edx+74h]
		test	ecx, ecx
		jz	short loc_1001C504
		lea	edx, [esp+50h+var_4C]
		push	edx
		push	eax
		call	ecx
		add	esp, 8
		pop	esi
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_1001C504:				; CODE XREF: sub_1001C4B0+37j
		push	0
		push	0FFFFE898h
		call	ds:PR_SetError
		mov	ecx, [esp+58h+var_4]
		add	esp, 8
		mov	eax, esi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
sub_1001C4B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C530	proc near		; CODE XREF: SSL_OptionSet+9Bp
					; SSL_OptionSet+FCp
		test	byte ptr [eax+14h], 1
		mov	ecx, offset off_1002E9DC
		jnz	short loc_1001C540
		mov	ecx, offset off_1002E9AC

loc_1001C540:				; CODE XREF: sub_1001C530+9j
		mov	[eax+4], ecx
		xor	eax, eax
		retn
sub_1001C530	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C550	proc near		; DATA XREF: .text:1001C582o
		call	sub_10022820
		mov	eax, ds:dword_1002E9A0
		mov	ecx, ds:dword_1002E9A4
		mov	edx, ds:dword_1002E9A8
		mov	dword_100378AC,	eax
		mov	dword_100378B0,	ecx
		mov	dword_100378B4,	edx
		xor	eax, eax
		retn
sub_1001C550	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001C580:				; DATA XREF: sub_1001C5A0o
		push	0
		push	offset sub_1001C550
		call	NSS_RegisterShutdown
		add	esp, 8
		neg	eax
		sbb	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C5A0	proc near		; CODE XREF: SSL_OptionSet+2FCp
					; SSL_OptionSetDefault+229p
		push	offset loc_1001C580
		push	offset dword_100378AC
		call	ds:PR_CallOnce
		add	esp, 8
		retn
sub_1001C5A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C5C0	proc near		; CODE XREF: SSL_OptionSet+192p
					; SSL_OptionSetDefault+F8p
		movzx	ecx, word ptr [eax]
		test	cx, cx
		jnz	short loc_1001C5D3
		test	edx, edx
		jz	short locret_1001C604
		mov	dword ptr [eax], 3010301h
		retn
; ---------------------------------------------------------------------------

loc_1001C5D3:				; CODE XREF: sub_1001C5C0+6j
		test	edx, edx
		jz	short loc_1001C5F6
		mov	edx, 301h
		cmp	cx, dx
		jb	short loc_1001C5E3
		mov	ecx, edx

loc_1001C5E3:				; CODE XREF: sub_1001C5C0+1Fj
		mov	[eax], cx
		movzx	ecx, word ptr [eax+2]
		cmp	cx, dx
		ja	short loc_1001C5F1

loc_1001C5EF:				; CODE XREF: sub_1001C5C0+3Ej
		mov	ecx, edx

loc_1001C5F1:				; CODE XREF: sub_1001C5C0+2Dj
		mov	[eax+2], cx
		retn
; ---------------------------------------------------------------------------

loc_1001C5F6:				; CODE XREF: sub_1001C5C0+15j
		mov	edx, 300h
		cmp	cx, dx
		jz	short loc_1001C5EF
		xor	edx, edx
		mov	[eax], edx

locret_1001C604:			; CODE XREF: sub_1001C5C0+Aj
		retn
sub_1001C5C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C610	proc near		; CODE XREF: SSL_OptionSet+1ACp
					; SSL_OptionSetDefault+10Ap
		movzx	eax, word ptr [ecx]
		test	ax, ax
		jnz	short loc_1001C623
		test	edx, edx
		jz	short locret_1001C64F
		mov	dword ptr [ecx], 3000300h
		retn
; ---------------------------------------------------------------------------

loc_1001C623:				; CODE XREF: sub_1001C610+6j
		test	edx, edx
		jz	short loc_1001C630
		mov	eax, 300h
		mov	[ecx], ax
		retn
; ---------------------------------------------------------------------------

loc_1001C630:				; CODE XREF: sub_1001C610+15j
		mov	edx, 300h
		cmp	[ecx+2], dx
		jbe	short loc_1001C64B
		mov	edx, 301h
		cmp	ax, dx
		ja	short loc_1001C647
		mov	eax, edx

loc_1001C647:				; CODE XREF: sub_1001C610+33j
		mov	[ecx], ax
		retn
; ---------------------------------------------------------------------------

loc_1001C64B:				; CODE XREF: sub_1001C610+29j
		xor	eax, eax
		mov	[ecx], eax

locret_1001C64F:			; CODE XREF: sub_1001C610+Aj
		retn
sub_1001C610	endp

; Exported entry  52. SSL_OptionGet

; =============== S U B	R O U T	I N E =======================================


		public SSL_OptionGet
SSL_OptionGet	proc near		; DATA XREF: .rdata:off_10035848o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	eax, dword_10037948
		mov	ecx, [esp+4+arg_0]
		push	esi
		push	edi
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		xor	esi, esi
		add	esp, 8
		cmp	eax, esi
		jnz	short loc_1001C67E
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	edi, edi
		jmp	short loc_1001C683
; ---------------------------------------------------------------------------

loc_1001C67E:				; CODE XREF: SSL_OptionGet+1Bj
		mov	edi, [eax+4]
		mov	[edi], eax

loc_1001C683:				; CODE XREF: SSL_OptionGet+2Cj
		mov	eax, [esp+0Ch+arg_8]
		mov	[esp+0Ch+var_4], esi
		cmp	eax, esi
		jnz	short loc_1001C6A3
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C6A3:				; CODE XREF: SSL_OptionGet+3Dj
		cmp	edi, esi
		jnz	short loc_1001C6B0
		mov	[eax], esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C6B0:				; CODE XREF: SSL_OptionGet+55j
		push	ebx
		mov	ebx, 1
		push	ebp
		mov	ebp, ds:PR_EnterMonitor
		test	[edi+16h], bl
		jnz	short loc_1001C6DF
		mov	edx, [edi+254h]
		push	edx
		call	ebp ; PR_EnterMonitor
		add	esp, 4
		test	[edi+16h], bl
		jnz	short loc_1001C6DF
		mov	eax, [edi+258h]
		push	eax
		call	ebp ; PR_EnterMonitor
		add	esp, 4

loc_1001C6DF:				; CODE XREF: SSL_OptionGet+70j
					; SSL_OptionGet+81j
		mov	eax, [esp+14h+arg_4]
		dec	eax
		cmp	eax, 1Bh	; switch 28 cases
		ja	loc_1001C833	; jumptable 1001C6ED default case
		jmp	ds:off_1001C880[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001C6F4:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		xor	esi, esi	; jumptable 1001C6ED case 1
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C6FB:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 0
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C705:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 2
		shr	esi, 2
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C712:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 9
		shr	esi, 3
		and	esi, 3
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C720:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 4
		shr	esi, 5
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C72D:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 5
		shr	esi, 6
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C73A:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	ecx, 301h	; jumptable 1001C6ED case 12
		cmp	[edi+1Ah], cx
		sbb	esi, esi
		inc	esi
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C74B:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		xor	eax, eax	; jumptable 1001C6ED case 7
		mov	edx, 300h
		cmp	[edi+18h], dx
		setz	al
		mov	esi, eax
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C760:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 6
		shr	esi, 7
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C76D:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 8
		shr	esi, 0Ah
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C77A:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 10
		shr	esi, 0Bh
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C787:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 11
		shr	esi, 0Ch
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C794:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 13
		shr	esi, 0Dh
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7A1:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 14
		shr	esi, 0Eh
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7AE:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 15
		shr	esi, 0Fh
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7BB:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		movzx	esi, word ptr [edi+16h]	; jumptable 1001C6ED case 16
		and	esi, ebx
		jmp	loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7C6:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 17
		shr	esi, 11h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7D0:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 18
		shr	esi, 12h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7DA:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 19
		shr	esi, 13h
		and	esi, 3
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7E5:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 20
		shr	esi, 15h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7EF:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 21
		shr	esi, 16h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C7F9:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 22
		shr	esi, 17h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C803:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		movzx	esi, byte ptr [edi+17h]	; jumptable 1001C6ED case 23
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C80B:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 24
		shr	esi, 19h
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C815:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 25
		shr	esi, 1Ah
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C81F:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 26
		shr	esi, 1Bh
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C829:				; CODE XREF: SSL_OptionGet+9Dj
					; DATA XREF: .text:off_1001C880o
		mov	esi, [edi+14h]	; jumptable 1001C6ED case 27
		shr	esi, 1Ch
		and	esi, ebx
		jmp	short loc_1001C848
; ---------------------------------------------------------------------------

loc_1001C833:				; CODE XREF: SSL_OptionGet+97j
					; SSL_OptionGet+9Dj
					; DATA XREF: ...
		push	0FFFFE005h	; jumptable 1001C6ED default case
		call	PORT_SetError_Util
		add	esp, 4
		mov	[esp+14h+var_4], 0FFFFFFFFh

loc_1001C848:				; CODE XREF: SSL_OptionGet+A6j
					; SSL_OptionGet+B0j ...
		mov	ebp, ds:PR_ExitMonitor
		test	[edi+16h], bl
		jnz	short loc_1001C870
		mov	ecx, [edi+258h]
		push	ecx
		call	ebp ; PR_ExitMonitor
		add	esp, 4
		test	[edi+16h], bl
		jnz	short loc_1001C870
		mov	edx, [edi+254h]
		push	edx
		call	ebp ; PR_ExitMonitor
		add	esp, 4

loc_1001C870:				; CODE XREF: SSL_OptionGet+201j
					; SSL_OptionGet+212j
		mov	eax, [esp+14h+arg_8]
		pop	ebp
		pop	ebx
		mov	[eax], esi
		mov	eax, [esp+0Ch+var_4]
		pop	edi
		pop	esi
		pop	ecx
		retn
SSL_OptionGet	endp

; ---------------------------------------------------------------------------
off_1001C880	dd offset loc_1001C6FB	; DATA XREF: SSL_OptionGet+9Dr
		dd offset loc_1001C6F4	; jump table for switch	statement
		dd offset loc_1001C705
		dd offset loc_1001C833
		dd offset loc_1001C720
		dd offset loc_1001C72D
		dd offset loc_1001C760
		dd offset loc_1001C74B
		dd offset loc_1001C76D
		dd offset loc_1001C712
		dd offset loc_1001C77A
		dd offset loc_1001C787
		dd offset loc_1001C73A
		dd offset loc_1001C794
		dd offset loc_1001C7A1
		dd offset loc_1001C7AE
		dd offset loc_1001C7BB
		dd offset loc_1001C7C6
		dd offset loc_1001C7D0
		dd offset loc_1001C7DA
		dd offset loc_1001C7E5
		dd offset loc_1001C7EF
		dd offset loc_1001C7F9
		dd offset loc_1001C803
		dd offset loc_1001C80B
		dd offset loc_1001C815
		dd offset loc_1001C81F
		dd offset loc_1001C829
; Exported entry  18. SSL_CipherPolicySet

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPolicySet
SSL_CipherPolicySet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		call	sub_10014850
		test	eax, eax
		jnz	short locret_1001C909
		mov	eax, [esp+arg_0]
		cmp	eax, 1Ch
		jl	short loc_1001C90A
		cmp	eax, 1Eh
		jg	short loc_1001C90A
		xor	eax, eax

locret_1001C909:			; CODE XREF: SSL_CipherPolicySet+7j
		retn
; ---------------------------------------------------------------------------

loc_1001C90A:				; CODE XREF: SSL_CipherPolicySet+10j
					; SSL_CipherPolicySet+15j
		mov	ecx, eax
		and	ecx, 0FFF0h
		cmp	ecx, 0FF00h
		jnz	short loc_1001C923
		mov	[esp+arg_0], eax
		jmp	sub_10010D30
; ---------------------------------------------------------------------------

loc_1001C923:				; CODE XREF: SSL_CipherPolicySet+28j
		mov	[esp+arg_0], eax
		jmp	sub_100075E0
SSL_CipherPolicySet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  17. SSL_CipherPolicyGet

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPolicyGet
SSL_CipherPolicyGet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

; FUNCTION CHUNK AT 10007630 SIZE 00000009 BYTES
; FUNCTION CHUNK AT 10007640 SIZE 00000041 BYTES
; FUNCTION CHUNK AT 10010DC0 SIZE 0000005B BYTES

		mov	eax, [esp+arg_4]
		test	eax, eax
		jnz	short loc_1001C949
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001C949:				; CODE XREF: SSL_CipherPolicyGet+6j
		mov	ecx, [esp+arg_0]
		cmp	ecx, 1Ch
		jl	short loc_1001C960
		cmp	ecx, 1Eh
		jg	short loc_1001C960
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001C960:				; CODE XREF: SSL_CipherPolicyGet+20j
					; SSL_CipherPolicyGet+25j
		mov	edx, ecx
		and	edx, 0FFF0h
		cmp	edx, 0FF00h
		jnz	short loc_1001C97D
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], ecx
		jmp	loc_10010DC0
; ---------------------------------------------------------------------------

loc_1001C97D:				; CODE XREF: SSL_CipherPolicyGet+3Ej
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], ecx
		jmp	loc_10007630
SSL_CipherPolicyGet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  22. SSL_CipherPrefSetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPrefSetDefault
SSL_CipherPrefSetDefault proc near	; CODE XREF: sub_10020660+1Cp
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		call	sub_10014850
		test	eax, eax
		jnz	short locret_1001CA04
		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 1Ch
		jl	short loc_1001C9AA
		cmp	esi, 1Eh
		jg	short loc_1001C9AA
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001C9AA:				; CODE XREF: SSL_CipherPrefSetDefault+11j
					; SSL_CipherPrefSetDefault+16j
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_1001C9DF
		test	dword_10037114,	4000h
		jz	short loc_1001C9DF
		push	esi
		call	sub_100206D0
		add	esp, 4
		test	eax, eax
		jz	short loc_1001C9DF
		push	0FFFFE006h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001C9DF:				; CODE XREF: SSL_CipherPrefSetDefault+21j
					; SSL_CipherPrefSetDefault+2Dj	...
		mov	eax, esi
		and	eax, 0FFF0h
		push	edi
		push	esi
		cmp	eax, 0FF00h
		jnz	short loc_1001C9FA
		call	sub_10010E20
		add	esp, 8
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001C9FA:				; CODE XREF: SSL_CipherPrefSetDefault+5Dj
		call	sub_10007690
		add	esp, 8
		pop	edi
		pop	esi

locret_1001CA04:			; CODE XREF: SSL_CipherPrefSetDefault+7j
		retn
SSL_CipherPrefSetDefault endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  20. SSL_CipherPrefGetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPrefGetDefault
SSL_CipherPrefGetDefault proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

; FUNCTION CHUNK AT 100076E0 SIZE 00000009 BYTES
; FUNCTION CHUNK AT 100076F0 SIZE 00000044 BYTES
; FUNCTION CHUNK AT 10010E80 SIZE 00000045 BYTES

		mov	eax, [esp+arg_4]
		test	eax, eax
		jnz	short loc_1001CA29
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CA29:				; CODE XREF: SSL_CipherPrefGetDefault+6j
		mov	ecx, [esp+arg_0]
		cmp	ecx, 1Ch
		jl	short loc_1001CA40
		cmp	ecx, 1Eh
		jg	short loc_1001CA40
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001CA40:				; CODE XREF: SSL_CipherPrefGetDefault+20j
					; SSL_CipherPrefGetDefault+25j
		mov	edx, ecx
		and	edx, 0FFF0h
		cmp	edx, 0FF00h
		jnz	short loc_1001CA5D
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], ecx
		jmp	loc_10010E80
; ---------------------------------------------------------------------------

loc_1001CA5D:				; CODE XREF: SSL_CipherPrefGetDefault+3Ej
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], ecx
		jmp	loc_100076E0
SSL_CipherPrefGetDefault endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  21. SSL_CipherPrefSet

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPrefSet
SSL_CipherPrefSet proc near		; CODE XREF: sub_10020690+1Ep
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CA99
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CA99:				; CODE XREF: SSL_CipherPrefSet+16j
		push	edi
		mov	edi, [eax+4]
		push	esi
		mov	esi, [esp+8+arg_4]
		mov	[edi], eax
		cmp	esi, 1Ch
		jl	short loc_1001CAB3
		cmp	esi, 1Eh
		jg	short loc_1001CAB3
		pop	esi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001CAB3:				; CODE XREF: SSL_CipherPrefSet+37j
					; SSL_CipherPrefSet+3Cj
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		test	ebx, ebx
		jz	short loc_1001CAE6
		test	dword ptr [edi+14h], 4000h
		jz	short loc_1001CAE6
		push	esi
		call	sub_100206D0
		add	esp, 4
		test	eax, eax
		jz	short loc_1001CAE6
		push	0FFFFE006h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebx
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001CAE6:				; CODE XREF: SSL_CipherPrefSet+4Aj
					; SSL_CipherPrefSet+53j ...
		mov	edx, esi
		push	ebx
		and	edx, 0FFF0h
		push	esi
		push	edi
		cmp	edx, 0FF00h
		jnz	short loc_1001CB05
		call	sub_10010ED0
		add	esp, 0Ch
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001CB05:				; CODE XREF: SSL_CipherPrefSet+87j
		call	sub_10007740
		add	esp, 0Ch
		pop	ebx
		pop	esi
		pop	edi
		retn
SSL_CipherPrefSet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  19. SSL_CipherPrefGet

; =============== S U B	R O U T	I N E =======================================


		public SSL_CipherPrefGet
SSL_CipherPrefGet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

; FUNCTION CHUNK AT 10010F30 SIZE 00000049 BYTES

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CB49
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	ecx, ecx
		jmp	short loc_1001CB4E
; ---------------------------------------------------------------------------

loc_1001CB49:				; CODE XREF: SSL_CipherPrefGet+16j
		mov	ecx, [eax+4]
		mov	[ecx], eax

loc_1001CB4E:				; CODE XREF: SSL_CipherPrefGet+27j
		mov	eax, [esp+arg_8]
		test	eax, eax
		jnz	short loc_1001CB67
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CB67:				; CODE XREF: SSL_CipherPrefGet+34j
		test	ecx, ecx
		jnz	short loc_1001CB71
		mov	[eax], ecx
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CB71:				; CODE XREF: SSL_CipherPrefGet+49j
		mov	edx, [esp+arg_4]
		cmp	edx, 1Ch
		jl	short loc_1001CB88
		cmp	edx, 1Eh
		jg	short loc_1001CB88
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001CB88:				; CODE XREF: SSL_CipherPrefGet+58j
					; SSL_CipherPrefGet+5Dj
		push	esi
		mov	esi, edx
		and	esi, 0FFF0h
		cmp	esi, 0FF00h
		pop	esi
		jnz	short loc_1001CBAB
		mov	[esp+arg_8], eax
		mov	[esp+arg_4], edx
		mov	[esp+arg_0], ecx
		jmp	loc_10010F30
; ---------------------------------------------------------------------------

loc_1001CBAB:				; CODE XREF: SSL_CipherPrefGet+78j
		mov	[esp+arg_8], eax
		mov	[esp+arg_4], edx
		mov	[esp+arg_0], ecx
		jmp	sub_10007790
SSL_CipherPrefGet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  75. SSL_SetNextProtoCallback

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetNextProtoCallback
SSL_SetNextProtoCallback proc near	; CODE XREF: SSL_SetNextProtoNego+CBp
					; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CBE9
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CBE9:				; CODE XREF: SSL_SetNextProtoCallback+16j
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001CC05
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001CC05:				; CODE XREF: SSL_SetNextProtoCallback+33j
		test	byte ptr [esi+16h], 1
		mov	eax, [esp+4+arg_4]
		mov	ecx, [esp+4+arg_8]
		mov	[esi+230h], eax
		mov	[esi+234h], ecx
		jnz	short loc_1001CC2F
		mov	edx, [esi+258h]
		push	edx
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001CC2F:				; CODE XREF: SSL_SetNextProtoCallback+5Dj
		xor	eax, eax
		pop	esi
		retn
SSL_SetNextProtoCallback endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001CC40:				; DATA XREF: SSL_SetNextProtoNego+C5o
		mov	eax, dword_10037948
		mov	ecx, [esp+8]
		sub	esp, 0Ch
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CC6F
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001CC6F:				; CODE XREF: .text:1001CC59j
		push	ebx
		mov	ebx, [eax+4]
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		mov	[esp+14h], ebx
		mov	[ebx], eax
		cmp	[esp+2Ch], ebp
		jbe	loc_1001CD23
		mov	edx, [ebx+10h]
		mov	esi, [esp+28h]
		mov	[esp+18h], edx

loc_1001CC93:				; CODE XREF: .text:1001CD1Dj
		xor	edi, edi
		cmp	[esp+18h], edi
		jbe	short loc_1001CD11
		mov	ecx, [ebx+0Ch]
		mov	dl, [esi+ebp]
		mov	[esp+10h], ecx

loc_1001CCA5:				; CODE XREF: .text:1001CD0Fj
		cmp	dl, [ecx+edi]
		jnz	short loc_1001CCFC
		movzx	eax, dl
		lea	ecx, [ecx+edi+1]
		lea	esi, [esi+ebp+1]
		cmp	eax, 4
		jb	short loc_1001CCD4
		lea	ebx, [ebx+0]

loc_1001CCC0:				; CODE XREF: .text:1001CCD2j
		mov	ebx, [esi]
		cmp	ebx, [ecx]
		jnz	short loc_1001CCF8
		sub	eax, 4
		add	ecx, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_1001CCC0

loc_1001CCD4:				; CODE XREF: .text:1001CCB8j
		test	eax, eax
		jz	short loc_1001CD51
		mov	bl, [ecx]
		cmp	bl, [esi]
		jnz	short loc_1001CCF8
		cmp	eax, 1
		jbe	short loc_1001CD51
		mov	bl, [ecx+1]
		cmp	bl, [esi+1]
		jnz	short loc_1001CCF8
		cmp	eax, 2
		jbe	short loc_1001CD51
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jz	short loc_1001CD51

loc_1001CCF8:				; CODE XREF: .text:1001CCC4j
					; .text:1001CCDCj ...
		mov	ecx, [esp+10h]

loc_1001CCFC:				; CODE XREF: .text:1001CCA8j
		movzx	eax, byte ptr [ecx+edi]
		mov	ebx, [esp+14h]
		mov	esi, [esp+28h]
		lea	edi, [edi+eax+1]
		cmp	edi, [ebx+10h]
		jb	short loc_1001CCA5

loc_1001CD11:				; CODE XREF: .text:1001CC99j
		movzx	ecx, byte ptr [esi+ebp]
		lea	ebp, [ecx+ebp+1]
		cmp	ebp, [esp+2Ch]
		jb	loc_1001CC93

loc_1001CD23:				; CODE XREF: .text:1001CC82j
		mov	esi, [ebx+0Ch]
		mov	dword ptr [ebx+2E84h], 2

loc_1001CD30:				; CODE XREF: .text:1001CD65j
		movzx	eax, byte ptr [esi]
		cmp	[esp+38h], eax
		jnb	short loc_1001CD67
		push	0FFFFE003h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001CD51:				; CODE XREF: .text:1001CCD6j
					; .text:1001CCE1j ...
		mov	edx, [esp+14h]
		mov	esi, [esp+28h]
		mov	dword ptr [edx+2E84h], 1
		add	esi, ebp
		jmp	short loc_1001CD30
; ---------------------------------------------------------------------------

loc_1001CD67:				; CODE XREF: .text:1001CD37j
		mov	edx, [esp+30h]
		push	eax
		lea	ecx, [esi+1]
		push	ecx
		push	edx
		call	memcpy
		movzx	eax, byte ptr [esi]
		mov	ecx, [esp+40h]
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		mov	[ecx], eax
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  76. SSL_SetNextProtoNego

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetNextProtoNego
SSL_SetNextProtoNego proc near		; DATA XREF: .rdata:off_10035848o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		mov	eax, dword_10037948
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	ebp
		mov	ebp, [esp+14h+arg_0]
		push	edi
		mov	edi, [esp+18h+arg_4]
		push	eax
		push	ebp
		mov	[esp+20h+var_C], 0
		mov	[esp+20h+var_8], edi
		mov	[esp+20h+var_4], ebx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CDDD
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001CDDD:				; CODE XREF: SSL_SetNextProtoNego+34j
		push	esi
		mov	esi, [eax+4]
		push	ebx
		push	edi
		mov	[esi], eax
		call	sub_10015010
		add	esp, 8
		test	eax, eax
		jz	short loc_1001CDFC
		pop	esi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001CDFC:				; CODE XREF: SSL_SetNextProtoNego+5Fj
		mov	bl, 1
		test	[esi+16h], bl
		jnz	short loc_1001CE13
		mov	ecx, [esi+258h]
		push	ecx
		call	ds:PR_EnterMonitor
		add	esp, 4

loc_1001CE13:				; CODE XREF: SSL_SetNextProtoNego+71j
		lea	edi, [esi+8]
		push	0
		push	edi
		call	SECITEM_FreeItem_Util
		lea	edx, [esp+24h+var_C]
		push	edx
		push	edi
		push	0
		call	SECITEM_CopyItem_Util
		add	esp, 14h
		mov	edi, eax
		test	[esi+16h], bl
		jnz	short loc_1001CE45
		mov	eax, [esi+258h]
		push	eax
		call	ds:PR_ExitMonitor
		add	esp, 4

loc_1001CE45:				; CODE XREF: SSL_SetNextProtoNego+A3j
		test	edi, edi
		jz	short loc_1001CE53
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001CE53:				; CODE XREF: SSL_SetNextProtoNego+B7j
		push	0
		push	offset loc_1001CC40
		push	ebp
		call	SSL_SetNextProtoCallback
		add	esp, 0Ch
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
SSL_SetNextProtoNego endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  39. SSL_GetNextProto

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_GetNextProto(int, int, void *Dst, int, int)
		public SSL_GetNextProto
SSL_GetNextProto proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Dst		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CE99
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CE99:				; CODE XREF: SSL_GetNextProto+16j
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esp+4+arg_4]
		push	edi
		test	eax, eax
		jz	short loc_1001CF15
		mov	edx, [esp+8+Dst]
		test	edx, edx
		jz	short loc_1001CF15
		mov	edi, [esp+8+arg_C]
		test	edi, edi
		jz	short loc_1001CF15
		mov	ecx, [esi+2E84h]
		mov	[eax], ecx
		cmp	dword ptr [esi+2E84h], 0
		jz	short loc_1001CF0A
		mov	eax, [esi+2E7Ch]
		test	eax, eax
		jz	short loc_1001CF0A
		mov	ecx, [esi+2E80h]
		cmp	ecx, [esp+8+arg_10]
		jbe	short loc_1001CEF2
		push	0FFFFE003h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001CEF2:				; CODE XREF: SSL_GetNextProto+6Dj
		push	ecx		; Size
		push	eax		; Src
		push	edx		; Dst
		call	memcpy
		mov	edx, [esi+2E80h]
		add	esp, 0Ch
		mov	[edi], edx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001CF0A:				; CODE XREF: SSL_GetNextProto+57j
					; SSL_GetNextProto+61j
		mov	dword ptr [edi], 0
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001CF15:				; CODE XREF: SSL_GetNextProto+36j
					; SSL_GetNextProto+3Ej	...
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
SSL_GetNextProto endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  78. SSL_SetSRTPCiphers

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetSRTPCiphers
SSL_SetSRTPCiphers proc	near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	esi
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001CF68
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001CF56:				; CODE XREF: SSL_SetSRTPCiphers+44j
					; SSL_SetSRTPCiphers+4Dj ...
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001CF68:				; CODE XREF: SSL_SetSRTPCiphers+17j
		mov	esi, [eax+4]
		mov	[esi], eax
		cmp	dword ptr [esi+2F38h], 1
		jnz	short loc_1001CF56
		mov	eax, [esp+4+arg_8]
		cmp	eax, 4
		ja	short loc_1001CF56
		push	edi
		xor	edx, edx
		xor	edi, edi
		mov	[esi+2E92h], dx
		test	eax, eax
		jz	short loc_1001CFE7
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		jmp	short loc_1001CFA0
; ---------------------------------------------------------------------------
		align 10h

loc_1001CFA0:				; CODE XREF: SSL_SetSRTPCiphers+64j
					; SSL_SetSRTPCiphers+B4j
		movzx	edx, word ptr [ebx+edi*2]
		mov	ecx, offset dword_1002EA0C
		mov	eax, 1
		mov	edi, edi

loc_1001CFB0:				; CODE XREF: SSL_SetSRTPCiphers+8Fj
		cmp	dx, ax
		jz	short loc_1001CFC3
		movzx	eax, word ptr [ecx+2]
		add	ecx, 2
		test	ax, ax
		jnz	short loc_1001CFB0
		jmp	short loc_1001CFDF
; ---------------------------------------------------------------------------

loc_1001CFC3:				; CODE XREF: SSL_SetSRTPCiphers+83j
		cmp	word ptr [ecx],	0
		jz	short loc_1001CFDF
		movzx	eax, word ptr [esi+2E92h]
		mov	[esi+eax*2+2E8Ah], dx
		inc	word ptr [esi+2E92h]

loc_1001CFDF:				; CODE XREF: SSL_SetSRTPCiphers+91j
					; SSL_SetSRTPCiphers+97j
		inc	edi
		cmp	edi, [esp+0Ch+arg_8]
		jb	short loc_1001CFA0
		pop	ebx

loc_1001CFE7:				; CODE XREF: SSL_SetSRTPCiphers+5Dj
		cmp	word ptr [esi+2E92h], 0
		pop	edi
		jz	loc_1001CF56
		xor	eax, eax
		pop	esi
		retn
SSL_SetSRTPCiphers endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  41. SSL_GetSRTPCipher

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetSRTPCipher
SSL_GetSRTPCipher proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D036
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001D025:				; CODE XREF: SSL_GetSRTPCipher+45j
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001D036:				; CODE XREF: SSL_GetSRTPCipher+16j
		mov	ecx, [eax+4]
		mov	[ecx], eax
		movzx	eax, word ptr [ecx+2E94h]
		test	ax, ax
		jz	short loc_1001D025
		mov	edx, [esp+arg_4]
		mov	[edx], ax
		xor	eax, eax
		retn
SSL_GetSRTPCipher endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  64. SSL_ReconfigFD

; =============== S U B	R O U T	I N E =======================================


		public SSL_ReconfigFD
SSL_ReconfigFD	proc near		; DATA XREF: .rdata:off_10035848o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		sub	esp, 8
		test	eax, eax
		jnz	short loc_1001D080
		push	eax
		push	0FFFFE005h
		call	ds:PR_SetError
		add	esp, 8
		xor	eax, eax
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001D080:				; CODE XREF: SSL_ReconfigFD+9j
		mov	ecx, dword_10037948
		push	esi
		mov	esi, ds:PR_GetIdentitiesLayer
		push	ecx
		push	eax
		call	esi ; PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D0AC
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001D0AC:				; CODE XREF: SSL_ReconfigFD+36j
		mov	edx, dword_10037948
		push	ebx
		mov	ebx, [eax+4]
		mov	[ebx], eax
		mov	eax, [esp+10h+arg_4]
		push	edx
		push	eax
		call	esi ; PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D0E9
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001D0E9:				; CODE XREF: SSL_ReconfigFD+65j
		push	ebp
		mov	ebp, [eax+4]
		mov	[ebp+0], eax
		mov	ecx, [ebx+8]
		mov	[ebp+8], ecx
		mov	edx, [ebx+0Ch]
		mov	[ebp+0Ch], edx
		mov	eax, [ebx+10h]
		mov	[ebp+10h], eax
		mov	ecx, [ebx+14h]
		mov	[ebp+14h], ecx
		mov	edx, [ebx+18h]
		push	edi
		mov	[ebp+18h], edx
		lea	esi, [ebx+350h]
		lea	edi, [ebp+350h]
		mov	ecx, 3Dh
		rep movsd
		movzx	eax, word ptr [ebx+2E92h]
		add	eax, eax
		push	eax		; Size
		lea	ecx, [ebx+2E8Ah]
		push	ecx		; Src
		lea	edx, [ebp+2E8Ah]
		push	edx		; Dst
		call	memcpy
		mov	ax, [ebx+2E92h]
		add	esp, 0Ch
		test	byte ptr [ebp+14h], 1
		mov	[ebp+2E92h], ax
		jnz	short loc_1001D16D
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4

loc_1001D163:				; CODE XREF: SSL_ReconfigFD+1A2j
					; SSL_ReconfigFD+1DFj ...
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001D16D:				; CODE XREF: SSL_ReconfigFD+F4j
		mov	eax, ebx
		lea	ecx, [ebx+2F4h]
		sub	eax, ebp
		mov	[esp+18h+var_4], 0
		lea	edi, [ebp+33Ch]
		mov	[esp+18h+arg_0], ecx
		lea	esi, [ebp+2F0h]
		mov	[esp+18h+var_8], eax
		jmp	short loc_1001D1A4
; ---------------------------------------------------------------------------
		jmp	short loc_1001D1A0
; ---------------------------------------------------------------------------
		align 10h

loc_1001D1A0:				; CODE XREF: SSL_ReconfigFD+135j
					; SSL_ReconfigFD+231j
		mov	eax, [esp+18h+var_8]

loc_1001D1A4:				; CODE XREF: SSL_ReconfigFD+133j
		mov	edx, [esp+18h+arg_0]
		cmp	dword ptr [edx-8], 0
		jz	loc_1001D245
		cmp	dword ptr [eax+esi], 0
		jz	loc_1001D245
		mov	eax, [esi-4]
		test	eax, eax
		jz	short loc_1001D1CC
		push	eax
		call	CERT_DestroyCertificate
		add	esp, 4

loc_1001D1CC:				; CODE XREF: SSL_ReconfigFD+161j
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [eax-8]
		push	ecx
		call	CERT_DupCertificate
		mov	[esi-4], eax
		mov	eax, [esi]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001D1EE
		push	eax
		call	CERT_DestroyCertificateList
		add	esp, 4

loc_1001D1EE:				; CODE XREF: SSL_ReconfigFD+183j
		mov	edx, [esp+18h+var_8]
		mov	eax, [edx+esi]
		push	eax
		call	CERT_DupCertList
		add	esp, 4
		mov	[esi], eax
		test	eax, eax
		jz	loc_1001D163
		mov	ecx, [esp+18h+var_8]
		cmp	dword ptr [edi+ecx], 0
		jz	short loc_1001D245
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_1001D229
		push	1
		push	eax
		call	SECITEM_FreeArray
		add	esp, 8
		mov	dword ptr [edi], 0

loc_1001D229:				; CODE XREF: SSL_ReconfigFD+1B6j
		mov	edx, [esp+18h+var_8]
		mov	eax, [edi+edx]
		push	eax
		push	0
		call	SECITEM_DupArray
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jz	loc_1001D163

loc_1001D245:				; CODE XREF: SSL_ReconfigFD+14Cj
					; SSL_ReconfigFD+156j ...
		mov	ecx, [esp+18h+arg_0]
		cmp	dword ptr [ecx], 0
		jz	short loc_1001D27A
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_1001D25E
		push	eax
		call	sub_100074E0
		add	esp, 4

loc_1001D25E:				; CODE XREF: SSL_ReconfigFD+1F3j
		mov	edx, [esp+18h+arg_0]
		mov	eax, [edx]
		push	eax
		call	sub_100074C0
		mov	ecx, [esp+1Ch+arg_0]
		mov	[esi+4], eax
		mov	edx, [ecx+4]
		add	esp, 4
		mov	[esi+8], edx

loc_1001D27A:				; CODE XREF: SSL_ReconfigFD+1ECj
		mov	eax, [esp+18h+var_4]
		add	[esp+18h+arg_0], 10h
		inc	eax
		add	edi, 4
		add	esi, 10h
		mov	[esp+18h+var_4], eax
		cmp	eax, 5
		jl	loc_1001D1A0
		cmp	dword ptr [ebx+1F8h], 0
		jz	short loc_1001D2C8
		mov	eax, [ebp+1F8h]
		test	eax, eax
		jz	short loc_1001D2B3
		push	eax
		call	sub_100074E0
		add	esp, 4

loc_1001D2B3:				; CODE XREF: SSL_ReconfigFD+248j
		mov	eax, [ebx+1F8h]
		push	eax
		call	sub_100074C0
		add	esp, 4
		mov	[ebp+1F8h], eax

loc_1001D2C8:				; CODE XREF: SSL_ReconfigFD+23Ej
		cmp	dword ptr [ebx+444h], 0
		jz	short loc_1001D2F9
		mov	eax, [ebp+444h]
		test	eax, eax
		jz	short loc_1001D2E4
		push	eax
		call	sub_100074E0
		add	esp, 4

loc_1001D2E4:				; CODE XREF: SSL_ReconfigFD+279j
		mov	ecx, [ebx+444h]
		push	ecx
		call	sub_100074C0
		add	esp, 4
		mov	[ebp+444h], eax

loc_1001D2F9:				; CODE XREF: SSL_ReconfigFD+26Fj
		cmp	dword ptr [ebx+474h], 0
		jz	short loc_1001D332
		mov	eax, [ebp+474h]
		test	eax, eax
		jz	short loc_1001D315
		push	eax
		call	CERT_FreeDistNames
		add	esp, 4

loc_1001D315:				; CODE XREF: SSL_ReconfigFD+2AAj
		mov	edx, [ebx+474h]
		push	edx
		call	CERT_DupDistNames
		add	esp, 4
		mov	[ebp+474h], eax
		test	eax, eax
		jz	loc_1001D163

loc_1001D332:				; CODE XREF: SSL_ReconfigFD+2A0j
		mov	eax, [ebx+1FCh]
		test	eax, eax
		jz	short loc_1001D342
		mov	[ebp+1FCh], eax

loc_1001D342:				; CODE XREF: SSL_ReconfigFD+2DAj
		mov	eax, [ebx+200h]
		test	eax, eax
		jz	short loc_1001D352
		mov	[ebp+200h], eax

loc_1001D352:				; CODE XREF: SSL_ReconfigFD+2EAj
		mov	eax, [ebx+204h]
		test	eax, eax
		jz	short loc_1001D362
		mov	[ebp+204h], eax

loc_1001D362:				; CODE XREF: SSL_ReconfigFD+2FAj
		mov	eax, [ebx+208h]
		test	eax, eax
		jz	short loc_1001D372
		mov	[ebp+208h], eax

loc_1001D372:				; CODE XREF: SSL_ReconfigFD+30Aj
		mov	eax, [ebx+20Ch]
		test	eax, eax
		jz	short loc_1001D382
		mov	[ebp+20Ch], eax

loc_1001D382:				; CODE XREF: SSL_ReconfigFD+31Aj
		mov	eax, [ebx+210h]
		test	eax, eax
		jz	short loc_1001D392
		mov	[ebp+210h], eax

loc_1001D392:				; CODE XREF: SSL_ReconfigFD+32Aj
		mov	eax, [ebx+214h]
		test	eax, eax
		jz	short loc_1001D3A2
		mov	[ebp+214h], eax

loc_1001D3A2:				; CODE XREF: SSL_ReconfigFD+33Aj
		mov	eax, [ebx+218h]
		test	eax, eax
		jz	short loc_1001D3B2
		mov	[ebp+218h], eax

loc_1001D3B2:				; CODE XREF: SSL_ReconfigFD+34Aj
		mov	eax, [ebx+21Ch]
		test	eax, eax
		jz	short loc_1001D3C2
		mov	[ebp+21Ch], eax

loc_1001D3C2:				; CODE XREF: SSL_ReconfigFD+35Aj
		mov	eax, [ebx+220h]
		test	eax, eax
		jz	short loc_1001D3D2
		mov	[ebp+220h], eax

loc_1001D3D2:				; CODE XREF: SSL_ReconfigFD+36Aj
		mov	ebx, [ebx+22Ch]
		test	ebx, ebx
		jz	short loc_1001D3E2
		mov	[ebp+22Ch], ebx

loc_1001D3E2:				; CODE XREF: SSL_ReconfigFD+37Aj
		mov	eax, [esp+18h+arg_4]
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 8
		retn
SSL_ReconfigFD	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D3F0	proc near		; CODE XREF: sub_1001D430+3Bp
					; SSL_VersionRangeSetDefault+42p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		sub	eax, 0
		jz	short loc_1001D413
		dec	eax
		jz	short loc_1001D3FF
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001D3FF:				; CODE XREF: sub_1001D3F0+Aj
		mov	eax, [esp+arg_4]
		add	eax, 0FFFFFCFEh
		mov	cx, 1
		cmp	cx, ax
		sbb	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001D413:				; CODE XREF: sub_1001D3F0+7j
		mov	edx, [esp+arg_4]
		add	edx, 0FFFFFD00h
		mov	eax, 3
		cmp	ax, dx
		sbb	eax, eax
		inc	eax
		retn
sub_1001D3F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D430	proc near		; CODE XREF: SSL_VersionRangeSet+3Cp
		push	esi
		test	ecx, ecx
		jz	short loc_1001D459
		movzx	eax, word ptr [ecx]
		movzx	esi, word ptr [ecx+2]
		cmp	ax, si
		ja	short loc_1001D459
		mov	ecx, eax
		mov	eax, edx
		sub	eax, 0
		jz	short loc_1001D45D
		dec	eax
		jnz	short loc_1001D459
		add	ecx, 0FFFFFCFEh
		cmp	cx, 1
		jbe	short loc_1001D469

loc_1001D459:				; CODE XREF: sub_1001D430+3j
					; sub_1001D430+Fj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001D45D:				; CODE XREF: sub_1001D430+18j
		add	ecx, 0FFFFFD00h
		cmp	cx, 3
		ja	short loc_1001D459

loc_1001D469:				; CODE XREF: sub_1001D430+27j
		push	esi
		push	edx
		call	sub_1001D3F0
		add	esp, 8
		test	eax, eax
		jz	short loc_1001D459
		mov	eax, 1
		pop	esi
		retn
sub_1001D430	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  86. SSL_VersionRangeGetSupported

; =============== S U B	R O U T	I N E =======================================


		public SSL_VersionRangeGetSupported
SSL_VersionRangeGetSupported proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jnz	short loc_1001D499

loc_1001D488:				; CODE XREF: SSL_VersionRangeGetSupported+23j
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001D499:				; CODE XREF: SSL_VersionRangeGetSupported+6j
		mov	eax, [esp+arg_0]
		sub	eax, 0
		jz	short loc_1001D4AC
		dec	eax
		jnz	short loc_1001D488
		mov	dword ptr [ecx], 3030302h
		retn
; ---------------------------------------------------------------------------

loc_1001D4AC:				; CODE XREF: SSL_VersionRangeGetSupported+20j
		mov	dword ptr [ecx], 3030300h
		xor	eax, eax
		retn
SSL_VersionRangeGetSupported endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  85. SSL_VersionRangeGetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_VersionRangeGetDefault
SSL_VersionRangeGetDefault proc	near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_1001D4CD
		cmp	eax, 1
		jnz	short loc_1001D4D5

loc_1001D4CD:				; CODE XREF: SSL_VersionRangeGetDefault+6j
		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jnz	short loc_1001D4E6

loc_1001D4D5:				; CODE XREF: SSL_VersionRangeGetDefault+Bj
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001D4E6:				; CODE XREF: SSL_VersionRangeGetDefault+13j
		test	eax, eax
		mov	eax, offset word_10037118
		jz	short loc_1001D4F4
		mov	eax, offset dword_1003711C

loc_1001D4F4:				; CODE XREF: SSL_VersionRangeGetDefault+2Dj
		mov	eax, [eax]
		mov	[ecx], eax
		xor	eax, eax
		retn
SSL_VersionRangeGetDefault endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  88. SSL_VersionRangeSetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_VersionRangeSetDefault
SSL_VersionRangeSetDefault proc	near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_1001D54E
		movzx	eax, word ptr [edi]
		movzx	edx, word ptr [edi+2]
		cmp	ax, dx
		ja	short loc_1001D54E
		mov	esi, [esp+8+arg_0]
		mov	ecx, eax
		mov	eax, esi
		sub	eax, 0
		jz	short loc_1001D534
		dec	eax
		jnz	short loc_1001D54E
		add	ecx, 0FFFFFCFEh
		cmp	cx, 1
		jbe	short loc_1001D540
		jmp	short loc_1001D54E
; ---------------------------------------------------------------------------

loc_1001D534:				; CODE XREF: SSL_VersionRangeSetDefault+21j
		add	ecx, 0FFFFFD00h
		cmp	cx, 3
		ja	short loc_1001D54E

loc_1001D540:				; CODE XREF: SSL_VersionRangeSetDefault+30j
		push	edx
		push	esi
		call	sub_1001D3F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D561

loc_1001D54E:				; CODE XREF: SSL_VersionRangeSetDefault+8j
					; SSL_VersionRangeSetDefault+14j ...
		push	0FFFFD078h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001D561:				; CODE XREF: SSL_VersionRangeSetDefault+4Cj
		mov	eax, offset word_10037118
		test	esi, esi
		jz	short loc_1001D56F
		mov	eax, offset dword_1003711C

loc_1001D56F:				; CODE XREF: SSL_VersionRangeSetDefault+68j
		mov	ecx, [edi]
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
SSL_VersionRangeSetDefault endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  84. SSL_VersionRangeGet

; =============== S U B	R O U T	I N E =======================================


		public SSL_VersionRangeGet
SSL_VersionRangeGet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D5A9
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001D5A9:				; CODE XREF: SSL_VersionRangeGet+16j
		push	esi
		mov	esi, [eax+4]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		mov	[esi], eax
		test	ebp, ebp
		jnz	short loc_1001D5CB
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001D5CB:				; CODE XREF: SSL_VersionRangeGet+36j
		push	ebx
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_1001D5F7
		mov	edx, [esi+254h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001D5F7
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001D5F7:				; CODE XREF: SSL_VersionRangeGet+58j
					; SSL_VersionRangeGet+69j
		mov	ecx, [esi+18h]
		mov	edi, ds:PR_ExitMonitor
		mov	[ebp+0], ecx
		test	[esi+16h], bl
		jnz	short loc_1001D625
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001D625
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_1001D625:				; CODE XREF: SSL_VersionRangeGet+86j
					; SSL_VersionRangeGet+97j
		pop	edi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	esi
		retn
SSL_VersionRangeGet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  87. SSL_VersionRangeSet

; =============== S U B	R O U T	I N E =======================================


		public SSL_VersionRangeSet
SSL_VersionRangeSet proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D659
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001D659:				; CODE XREF: SSL_VersionRangeSet+16j
		push	esi
		mov	esi, [eax+4]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		mov	[esi], eax
		mov	edx, [esi+2F38h]
		mov	ecx, ebp
		call	sub_1001D430
		test	eax, eax
		jnz	short loc_1001D688
		push	0FFFFD078h
		call	PORT_SetError_Util
		add	esp, 4
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001D688:				; CODE XREF: SSL_VersionRangeSet+43j
		push	ebx
		mov	bl, 1
		push	edi
		mov	edi, ds:PR_EnterMonitor
		test	[esi+16h], bl
		jnz	short loc_1001D6B4
		mov	edx, [esi+254h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001D6B4
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001D6B4:				; CODE XREF: SSL_VersionRangeSet+65j
					; SSL_VersionRangeSet+76j
		mov	ecx, [ebp+0]
		mov	edi, ds:PR_ExitMonitor
		mov	[esi+18h], ecx
		test	[esi+16h], bl
		jnz	short loc_1001D6E2
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	[esi+16h], bl
		jnz	short loc_1001D6E2
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_1001D6E2:				; CODE XREF: SSL_VersionRangeSet+93j
					; SSL_VersionRangeSet+A4j
		pop	edi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	esi
		retn
SSL_VersionRangeSet endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  58. SSL_PeerStapledOCSPResponses

; =============== S U B	R O U T	I N E =======================================


		public SSL_PeerStapledOCSPResponses
SSL_PeerStapledOCSPResponses proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001D718
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001D718:				; CODE XREF: SSL_PeerStapledOCSPResponses+16j
		mov	ecx, [eax+4]
		mov	[ecx], eax
		mov	eax, [ecx+0F4h]
		test	eax, eax
		jnz	short loc_1001D737
		push	0FFFFE09Ah
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001D737:				; CODE XREF: SSL_PeerStapledOCSPResponses+35j
		add	eax, 14h
		retn
SSL_PeerStapledOCSPResponses endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D740	proc near		; DATA XREF: .rdata:off_1002EA48o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	loc_1001D7D0
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001D7D0
		push	ebx
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_1001D778
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D778:				; CODE XREF: sub_1001D740+30j
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001D788
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D788:				; CODE XREF: sub_1001D740+40j
		mov	edx, [esp+0Ch+arg_4]
		mov	eax, [esp+0Ch+arg_8]
		mov	ecx, [esi+4]
		push	edx
		mov	[esi+240h], eax
		mov	eax, [ecx]
		push	esi
		call	eax
		mov	ebx, ds:PR_Unlock
		mov	edi, eax
		mov	eax, [esi+248h]
		add	esp, 8
		test	eax, eax
		jz	short loc_1001D7BA
		push	eax
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D7BA:				; CODE XREF: sub_1001D740+72j
		mov	esi, [esi+244h]
		test	esi, esi
		jz	short loc_1001D7CA
		push	esi
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D7CA:				; CODE XREF: sub_1001D740+82j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D7D0:				; CODE XREF: sub_1001D740+9j
					; sub_1001D740+18j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001D740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D7F0	proc near		; DATA XREF: .rdata:off_1002EA50o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001D873
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001D873
		push	ebx
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_1001D824
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D824:				; CODE XREF: sub_1001D7F0+2Cj
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001D834
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D834:				; CODE XREF: sub_1001D7F0+3Cj
		mov	ecx, [esp+0Ch+arg_4]
		mov	eax, [esi+4]
		mov	edx, [eax+8]
		push	ecx
		push	esi
		call	edx
		mov	ebx, ds:PR_Unlock
		mov	edi, eax
		mov	eax, [esi+248h]
		add	esp, 8
		test	eax, eax
		jz	short loc_1001D85D
		push	eax
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D85D:				; CODE XREF: sub_1001D7F0+65j
		mov	esi, [esi+244h]
		test	esi, esi
		jz	short loc_1001D86D
		push	esi
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D86D:				; CODE XREF: sub_1001D7F0+75j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D873:				; CODE XREF: sub_1001D7F0+9j
					; sub_1001D7F0+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001D7F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D890	proc near		; DATA XREF: .rdata:off_1002EA54o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001D913
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001D913
		push	ebx
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_1001D8C4
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D8C4:				; CODE XREF: sub_1001D890+2Cj
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001D8D4
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001D8D4:				; CODE XREF: sub_1001D890+3Cj
		mov	ecx, [esp+0Ch+arg_4]
		mov	eax, [esi+4]
		mov	edx, [eax+0Ch]
		push	ecx
		push	esi
		call	edx
		mov	ebx, ds:PR_Unlock
		mov	edi, eax
		mov	eax, [esi+248h]
		add	esp, 8
		test	eax, eax
		jz	short loc_1001D8FD
		push	eax
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D8FD:				; CODE XREF: sub_1001D890+65j
		mov	esi, [esi+244h]
		test	esi, esi
		jz	short loc_1001D90D
		push	esi
		call	ebx ; PR_Unlock
		add	esp, 4

loc_1001D90D:				; CODE XREF: sub_1001D890+75j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D913:				; CODE XREF: sub_1001D890+9j
					; sub_1001D890+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001D890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D930	proc near		; DATA XREF: .rdata:off_1002EA58o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	loc_1001D9E3
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	loc_1001D9E3
		push	ebx
		mov	ebx, ds:PR_Lock
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, [eax+4]
		mov	[edi], eax
		test	esi, esi
		jz	short loc_1001D96A
		cmp	esi, 2
		jnz	short loc_1001D97A

loc_1001D96A:				; CODE XREF: sub_1001D930+33j
		mov	eax, [edi+244h]
		test	eax, eax
		jz	short loc_1001D97A
		push	eax
		call	ebx ; PR_Lock
		add	esp, 4

loc_1001D97A:				; CODE XREF: sub_1001D930+38j
					; sub_1001D930+42j
		cmp	esi, 1
		jz	short loc_1001D984
		cmp	esi, 2
		jnz	short loc_1001D994

loc_1001D984:				; CODE XREF: sub_1001D930+4Dj
		mov	eax, [edi+248h]
		test	eax, eax
		jz	short loc_1001D994
		push	eax
		call	ebx ; PR_Lock
		add	esp, 4

loc_1001D994:				; CODE XREF: sub_1001D930+52j
					; sub_1001D930+5Cj
		mov	eax, [edi+4]
		mov	ecx, [eax+10h]
		push	esi
		push	edi
		call	ecx
		mov	ebp, ds:PR_Unlock
		add	esp, 8
		mov	ebx, eax
		cmp	esi, 1
		jz	short loc_1001D9B3
		cmp	esi, 2
		jnz	short loc_1001D9C3

loc_1001D9B3:				; CODE XREF: sub_1001D930+7Cj
		mov	eax, [edi+248h]
		test	eax, eax
		jz	short loc_1001D9C3
		push	eax
		call	ebp ; PR_Unlock
		add	esp, 4

loc_1001D9C3:				; CODE XREF: sub_1001D930+81j
					; sub_1001D930+8Bj
		test	esi, esi
		jz	short loc_1001D9CC
		cmp	esi, 2
		jnz	short loc_1001D9DC

loc_1001D9CC:				; CODE XREF: sub_1001D930+95j
		mov	edi, [edi+244h]
		test	edi, edi
		jz	short loc_1001D9DC
		push	edi
		call	ebp ; PR_Unlock
		add	esp, 4

loc_1001D9DC:				; CODE XREF: sub_1001D930+9Aj
					; sub_1001D930+A4j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001D9E3:				; CODE XREF: sub_1001D930+9j
					; sub_1001D930+18j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001D930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DA00	proc near		; DATA XREF: .rdata:off_1002EA1Co

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001DA52
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DA52
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_1001DA33
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001DA33:				; CODE XREF: sub_1001DA00+2Bj
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001DA43
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001DA43:				; CODE XREF: sub_1001DA00+3Bj
		mov	eax, [esi+4]
		mov	ecx, [eax+14h]
		push	esi
		call	ecx
		add	esp, 4
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DA52:				; CODE XREF: sub_1001DA00+9j
					; sub_1001DA00+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DA00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DA70	proc near		; DATA XREF: .rdata:off_1002EA5Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001DAF0
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DAF0
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		test	eax, eax
		jz	short loc_1001DAA1
		push	eax
		call	ds:PR_Lock
		add	esp, 4

loc_1001DAA1:				; CODE XREF: sub_1001DA70+25j
		test	dword ptr [esi+14h], 800h
		mov	eax, [esp+8+arg_10]
		mov	[esi+238h], eax
		jnz	short loc_1001DABA
		mov	[esi+23Ch], eax

loc_1001DABA:				; CODE XREF: sub_1001DA70+42j
		mov	ecx, [esp+8+arg_C]
		mov	edx, [esp+8+arg_8]
		mov	eax, [esi+4]
		push	ecx
		mov	ecx, [esp+0Ch+arg_4]
		push	edx
		mov	edx, [eax+18h]
		push	ecx
		push	esi
		call	edx
		mov	esi, [esi+244h]
		add	esp, 10h
		mov	edi, eax
		test	esi, esi
		jz	short loc_1001DAEB
		push	esi
		call	ds:PR_Unlock
		add	esp, 4

loc_1001DAEB:				; CODE XREF: sub_1001DA70+6Fj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DAF0:				; CODE XREF: sub_1001DA70+9j
					; sub_1001DA70+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DA70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DB10	proc near		; CODE XREF: sub_1001E250+EDp
					; sub_1001E250+12Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001DB90
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DB90
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+248h]
		push	edi
		test	eax, eax
		jz	short loc_1001DB41
		push	eax
		call	ds:PR_Lock
		add	esp, 4

loc_1001DB41:				; CODE XREF: sub_1001DB10+25j
		test	dword ptr [esi+14h], 800h
		mov	eax, [esp+8+arg_10]
		mov	[esi+23Ch], eax
		jnz	short loc_1001DB5A
		mov	[esi+238h], eax

loc_1001DB5A:				; CODE XREF: sub_1001DB10+42j
		mov	ecx, [esp+8+arg_C]
		mov	edx, [esp+8+arg_8]
		mov	eax, [esi+4]
		push	ecx
		mov	ecx, [esp+0Ch+arg_4]
		push	edx
		mov	edx, [eax+1Ch]
		push	ecx
		push	esi
		call	edx
		mov	esi, [esi+248h]
		add	esp, 10h
		mov	edi, eax
		test	esi, esi
		jz	short loc_1001DB8B
		push	esi
		call	ds:PR_Unlock
		add	esp, 4

loc_1001DB8B:				; CODE XREF: sub_1001DB10+6Fj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DB90:				; CODE XREF: sub_1001DB10+9j
					; sub_1001DB10+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DB10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DBB0	proc near		; DATA XREF: .rdata:off_1002EA20o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001DC2A
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DC2A
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		test	eax, eax
		jz	short loc_1001DBE1
		push	eax
		call	ds:PR_Lock
		add	esp, 4

loc_1001DBE1:				; CODE XREF: sub_1001DBB0+25j
		or	eax, 0FFFFFFFFh
		test	dword ptr [esi+14h], 800h
		mov	[esi+238h], eax
		jnz	short loc_1001DBF9
		mov	[esi+23Ch], eax

loc_1001DBF9:				; CODE XREF: sub_1001DBB0+41j
		mov	ecx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		mov	eax, [esi+4]
		mov	eax, [eax+20h]
		push	ecx
		push	edx
		push	esi
		call	eax
		mov	esi, [esi+244h]
		add	esp, 0Ch
		mov	edi, eax
		test	esi, esi
		jz	short loc_1001DC25
		push	esi
		call	ds:PR_Unlock
		add	esp, 4

loc_1001DC25:				; CODE XREF: sub_1001DBB0+69j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DC2A:				; CODE XREF: sub_1001DBB0+9j
					; sub_1001DBB0+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DBB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DC40	proc near		; DATA XREF: .rdata:off_1002EA24o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		cmp	dword ptr [ecx], 4
		jnz	short loc_1001DCBA
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DCBA
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+248h]
		push	edi
		test	eax, eax
		jz	short loc_1001DC71
		push	eax
		call	ds:PR_Lock
		add	esp, 4

loc_1001DC71:				; CODE XREF: sub_1001DC40+25j
		or	eax, 0FFFFFFFFh
		test	dword ptr [esi+14h], 800h
		mov	[esi+23Ch], eax
		jnz	short loc_1001DC89
		mov	[esi+238h], eax

loc_1001DC89:				; CODE XREF: sub_1001DC40+41j
		mov	ecx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		mov	eax, [esi+4]
		mov	eax, [eax+24h]
		push	ecx
		push	edx
		push	esi
		call	eax
		mov	esi, [esi+248h]
		add	esp, 0Ch
		mov	edi, eax
		test	esi, esi
		jz	short loc_1001DCB5
		push	esi
		call	ds:PR_Unlock
		add	esp, 4

loc_1001DCB5:				; CODE XREF: sub_1001DC40+69j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DCBA:				; CODE XREF: sub_1001DC40+9j
					; sub_1001DC40+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DC40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DCD0	proc near		; DATA XREF: .rdata:off_1002EA7Co

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx]
		cmp	dword ptr [eax], 4
		jnz	short loc_1001DCF7
		mov	edx, [ecx+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DCF7
		mov	eax, [ecx+4]
		mov	[eax], ecx
		mov	ecx, [eax+4]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+28h]
		jmp	eax
; ---------------------------------------------------------------------------

loc_1001DCF7:				; CODE XREF: sub_1001DCD0+9j
					; sub_1001DCD0+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DCD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DD10	proc near		; CODE XREF: sub_1000D820+35p
					; sub_100137A0+4Dp ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	esi
		mov	esi, [esp+28h+arg_0]
		mov	eax, [esi]
		mov	ecx, [eax+8]
		xor	eax, eax
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_10], eax
		mov	[esp+28h+var_C], eax
		mov	[esp+28h+var_8], eax
		mov	edx, [ecx]
		lea	eax, [esp+28h+var_24]
		push	eax
		push	ecx
		mov	ecx, [edx+64h]
		call	ecx
		add	esp, 8
		test	eax, eax
		js	loc_1001DDFF
		mov	eax, [esp+28h+var_24]
		mov	dword ptr [esi+38h], 1
		cmp	ax, 2
		jnz	short loc_1001DDA6
		mov	eax, [esp+28h+var_20]
		lea	edx, [esi+0E0h]
		push	edx
		push	eax
		call	ds:PR_ConvertIPv4AddrToIPv6
		mov	cx, word ptr [esp+30h+var_24+2]
		add	esp, 8
		mov	[esi+0F0h], cx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001DDA6:				; CODE XREF: sub_1001DD10+61j
		cmp	ax, 17h
		jnz	short loc_1001DDF2
		mov	edx, [esp+28h+var_1C]
		mov	eax, [esp+28h+var_18]
		mov	ecx, [esp+28h+var_14]
		mov	[esi+0E0h], edx
		mov	edx, [esp+28h+var_10]
		mov	[esi+0E4h], eax
		mov	ax, word ptr [esp+28h+var_24+2]
		mov	[esi+0E8h], ecx
		mov	[esi+0F0h], ax
		mov	[esi+0ECh], edx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001DDF2:				; CODE XREF: sub_1001DD10+9Aj
		push	0FFFFE89Fh
		call	PORT_SetError_Util
		add	esp, 4

loc_1001DDFF:				; CODE XREF: sub_1001DD10+4Cj
		mov	ecx, [esp+28h+var_4]
		pop	esi
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001DD10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DE20	proc near		; DATA XREF: .rdata:off_1002EA78o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx]
		cmp	dword ptr [eax], 4
		jnz	short loc_1001DE47
		mov	edx, [ecx+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001DE47
		mov	eax, [ecx+4]
		mov	[eax], ecx
		mov	ecx, [eax+4]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+2Ch]
		jmp	eax
; ---------------------------------------------------------------------------

loc_1001DE47:				; CODE XREF: sub_1001DE20+9j
					; sub_1001DE20+14j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001DE20	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  80. SSL_SetStapledOCSPResponses

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetStapledOCSPResponses
SSL_SetStapledOCSPResponses proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001DE89
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001DE89:				; CODE XREF: SSL_SetStapledOCSPResponses+16j
		push	esi
		mov	esi, [eax+4]
		push	edi
		mov	edi, [esp+8+arg_8]
		lea	edx, [edi-1]
		mov	[esi], eax
		cmp	edx, 3
		ja	short loc_1001DEF3
		mov	eax, [esi+edi*4+33Ch]
		test	eax, eax
		jz	short loc_1001DEBD
		push	1
		push	eax
		call	SECITEM_FreeArray
		add	esp, 8
		mov	dword ptr [esi+edi*4+33Ch], 0

loc_1001DEBD:				; CODE XREF: SSL_SetStapledOCSPResponses+45j
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		test	ebx, ebx
		jz	short loc_1001DED8
		push	ebx
		push	0
		call	SECITEM_DupArray
		add	esp, 8
		mov	[esi+edi*4+33Ch], eax

loc_1001DED8:				; CODE XREF: SSL_SetStapledOCSPResponses+64j
		cmp	dword ptr [esi+edi*4+33Ch], 0
		jnz	short loc_1001DEED
		test	ebx, ebx
		jz	short loc_1001DEED
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DEED:				; CODE XREF: SSL_SetStapledOCSPResponses+80j
					; SSL_SetStapledOCSPResponses+84j
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DEF3:				; CODE XREF: SSL_SetStapledOCSPResponses+3Aj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
SSL_SetStapledOCSPResponses endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  79. SSL_SetSockPeerID

; =============== S U B	R O U T	I N E =======================================


		public SSL_SetSockPeerID
SSL_SetSockPeerID proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10037948
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001DF29
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001DF29:				; CODE XREF: SSL_SetSockPeerID+16j
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+1E8h]
		push	edi
		test	eax, eax
		jz	short loc_1001DF4D
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		mov	dword ptr [esi+1E8h], 0

loc_1001DF4D:				; CODE XREF: SSL_SetSockPeerID+38j
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_1001DF64
		push	edi
		call	PORT_Strdup_Util
		add	esp, 4
		mov	[esi+1E8h], eax

loc_1001DF64:				; CODE XREF: SSL_SetSockPeerID+53j
		cmp	dword ptr [esi+1E8h], 0
		jnz	short loc_1001DF77
		test	edi, edi
		jz	short loc_1001DF77
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001DF77:				; CODE XREF: SSL_SetSockPeerID+6Bj
					; SSL_SetSockPeerID+6Fj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
SSL_SetSockPeerID endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001DF80	proc near		; DATA XREF: .rdata:off_1002EA6Co

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	eax, [esp+2Ch+arg_8]
		mov	ecx, [esp+2Ch+arg_0]
		xor	edx, edx
		mov	[eax], dx
		push	ebx
		mov	ebx, [esp+30h+arg_4]
		mov	[esp+30h+var_28], eax
		mov	eax, [ecx]
		cmp	dword ptr [eax], 4
		push	edi
		mov	[esp+34h+var_2C], ecx
		movzx	edi, bx
		jnz	loc_1001E03A
		mov	edx, [ecx+14h]
		cmp	edx, dword_10037948
		jnz	short loc_1001E03A
		push	esi
		mov	esi, [ecx+4]
		mov	[esi], ecx
		test	byte ptr [esi+14h], 1
		push	ebp
		jz	loc_1001E096
		cmp	dword ptr [esi+270h], 0
		jz	loc_1001E096
		cmp	dword ptr [esi+24h], 0
		jnz	loc_1001E096
		test	bl, 3
		jz	loc_1001E096
		cmp	dword ptr [esi+38h], 0
		jnz	short loc_1001E01B
		lea	eax, [esp+3Ch+var_24]
		push	eax
		push	esi
		call	sub_10014710
		mov	ecx, [esp+44h+var_2C]
		add	esp, 8
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	[esi+38h], eax
		test	eax, eax
		jz	loc_1001E0EC

loc_1001E01B:				; CODE XREF: sub_1001DF80+77j
		cmp	dword ptr [esi+2Ch], 0
		jnz	short loc_1001E05A
		mov	edx, ebx
		and	edx, 0FFFFFFFCh
		cmp	dword ptr [esi+270h], 1
		movzx	edi, dx
		jnz	short loc_1001E091
		or	edi, 2
		jmp	loc_1001E0EC
; ---------------------------------------------------------------------------

loc_1001E03A:				; CODE XREF: sub_1001DF80+31j
					; sub_1001DF80+40j
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1001E05A:				; CODE XREF: sub_1001DF80+9Fj
		cmp	dword ptr [esi+30h], 0
		jz	short loc_1001E070
		test	bl, 1
		jz	loc_1001E0EC
		mov	eax, ebx
		xor	eax, 1
		jmp	short loc_1001E0E6
; ---------------------------------------------------------------------------

loc_1001E070:				; CODE XREF: sub_1001DF80+DEj
		test	bl, 2
		jz	short loc_1001E0EC
		mov	edx, 300h
		cmp	[esi+44h], dx
		jb	short loc_1001E089
		cmp	dword ptr [esi+8C8h], 0
		jnz	short loc_1001E091

loc_1001E089:				; CODE XREF: sub_1001DF80+FEj
		mov	eax, ebx
		xor	eax, 2
		movzx	edi, ax

loc_1001E091:				; CODE XREF: sub_1001DF80+B0j
					; sub_1001DF80+107j
		or	edi, 1
		jmp	short loc_1001E0EC
; ---------------------------------------------------------------------------

loc_1001E096:				; CODE XREF: sub_1001DF80+4Dj
					; sub_1001DF80+5Aj ...
		mov	ebp, ebx
		and	ebp, 1
		jz	short loc_1001E0D0
		push	ecx
		call	SSL_DataPending
		add	esp, 4
		test	eax, eax
		jle	short loc_1001E0CC
		mov	edx, [esp+3Ch+var_28]
		pop	ebp
		pop	esi
		mov	ecx, 1
		pop	edi
		mov	ax, bx
		mov	[edx], cx
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1001E0CC:				; CODE XREF: sub_1001DF80+128j
		mov	ecx, [esp+3Ch+var_2C]

loc_1001E0D0:				; CODE XREF: sub_1001DF80+11Bj
		cmp	dword ptr [esi+30h], 0
		jz	short loc_1001E0EC
		test	bp, bp
		jz	short loc_1001E0EC
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_1001E0EC
		mov	eax, ebx

loc_1001E0E6:				; CODE XREF: sub_1001DF80+EEj
		or	eax, 2
		movzx	edi, ax

loc_1001E0EC:				; CODE XREF: sub_1001DF80+95j
					; sub_1001DF80+B5j ...
		mov	edx, 300h
		cmp	[esi+44h], dx
		jb	short loc_1001E112
		cmp	dword ptr [esi+8C0h], 0
		jz	short loc_1001E112
		cmp	dword ptr [esi+30h], 0
		jz	short loc_1001E172
		cmp	dword ptr [esi+2E4h], 0
		jz	short loc_1001E172
		and	edi, 6

loc_1001E112:				; CODE XREF: sub_1001DF80+175j
					; sub_1001DF80+17Ej
		test	di, di
		jz	short loc_1001E17F
		mov	eax, [ecx+8]
		mov	edx, [eax]
		cmp	dword ptr [edx+54h], 0
		jz	short loc_1001E17F
		lea	edx, [esp+3Ch+var_2C]
		push	edx
		mov	[esp+40h+var_2C], 0
		mov	ecx, [eax]
		push	edi
		push	eax
		mov	eax, [ecx+54h]
		call	eax
		movzx	ecx, ax
		mov	eax, [esp+48h+var_2C]
		mov	edx, ecx
		and	edx, eax
		add	esp, 0Ch
		test	dx, dx
		jz	short loc_1001E176
		cmp	bx, di
		jz	short loc_1001E176
		mov	ecx, eax
		and	ecx, 0FFFFFFFCh
		movzx	ecx, cx
		test	al, 1
		jz	short loc_1001E15F
		or	ecx, 2

loc_1001E15F:				; CODE XREF: sub_1001DF80+1DAj
		test	al, 2
		jz	short loc_1001E166
		or	ecx, 1

loc_1001E166:				; CODE XREF: sub_1001DF80+1E1j
		mov	edx, [esp+3Ch+var_28]
		mov	[edx], cx
		movzx	edi, bx
		jmp	short loc_1001E17F
; ---------------------------------------------------------------------------

loc_1001E172:				; CODE XREF: sub_1001DF80+184j
					; sub_1001DF80+18Dj
		xor	edi, edi
		jmp	short loc_1001E17F
; ---------------------------------------------------------------------------

loc_1001E176:				; CODE XREF: sub_1001DF80+1C9j
					; sub_1001DF80+1CEj
		mov	edx, [esp+3Ch+var_28]
		mov	[edx], ax
		mov	edi, ecx

loc_1001E17F:				; CODE XREF: sub_1001DF80+195j
					; sub_1001DF80+1A0j ...
		mov	ecx, [esp+3Ch+var_4]
		pop	ebp
		pop	esi
		mov	ax, di
		pop	edi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_1001DF80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E1A0	proc near		; DATA XREF: .rdata:off_1002EA74o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+arg_C]
		mov	eax, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_C], edx
		mov	edx, [esp+1Ch+arg_14]
		push	edx
		mov	edx, [esp+20h+arg_10]
		mov	[esp+20h+var_1C], eax
		xor	eax, eax
		push	edx
		mov	[esp+24h+var_18], eax
		mov	[esp+24h+var_14], eax
		mov	[esp+24h+var_8], eax
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		lea	edx, [esp+24h+var_1C]
		mov	[esp+24h+var_10], ecx
		mov	ecx, [eax]
		push	edx
		push	eax
		mov	eax, [ecx+78h]
		call	eax
		add	esp, 2Ch
		retn
sub_1001E1A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E1F0	proc near		; CODE XREF: sub_10007FE0+34p
					; SSL_ForceHandshake+2Dp ...

var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_0]
		mov	eax, [eax]
		lea	ecx, [esp+4Ch+var_4C]
		push	ecx
		push	eax
		mov	[esp+54h+var_4C], 0
		mov	[esp+54h+var_44], 0
		call	ds:PR_GetSocketOption
		add	esp, 8
		test	eax, eax
		jz	short loc_1001E237
		xor	eax, eax
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_1001E237:				; CODE XREF: sub_1001E1F0+34j
		mov	ecx, [esp+4Ch+var_4]
		xor	eax, eax
		cmp	[esp+4Ch+var_44], eax
		setz	al
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
sub_1001E1F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E250	proc near		; DATA XREF: .rdata:off_1002EA44o

Size		= dword	ptr -4064h
var_4060	= dword	ptr -4060h
var_405C	= dword	ptr -405Ch
var_4058	= dword	ptr -4058h
var_4054	= dword	ptr -4054h
var_4050	= dword	ptr -4050h
var_404C	= dword	ptr -404Ch
var_4044	= dword	ptr -4044h
Dst		= byte ptr -4004h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4064h
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4064h+var_4], eax
		mov	eax, dword_1003713C
		mov	ecx, dword_10037140
		push	ebx
		push	ebp
		mov	ebp, [esp+406Ch+arg_0]
		push	esi
		mov	esi, [esp+4070h+arg_8]
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+4074h+arg_4]
		mov	[esp+4074h+var_4058], ebp
		mov	[esp+4074h+Size], ebx
		mov	[esp+4074h+var_4050], eax
		mov	[esp+4074h+var_405C], ecx
		cmp	esi, ebx
		jge	short loc_1001E2B7

loc_1001E2A2:				; CODE XREF: sub_1001E250+92j
		push	0FFFFE89Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E2B7:				; CODE XREF: sub_1001E250+50j
		cmp	esi, 10h
		jle	short loc_1001E2D1
		push	0FFFFE8B6h
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E2D1:				; CODE XREF: sub_1001E250+6Aj
		xor	eax, eax
		cmp	esi, ebx
		jle	short loc_1001E2EC
		lea	ecx, [edi+4]
		lea	ebx, [ebx+0]

loc_1001E2E0:				; CODE XREF: sub_1001E250+9Aj
		cmp	[ecx], ebx
		jl	short loc_1001E2A2
		inc	eax
		add	ecx, 8
		cmp	eax, esi
		jl	short loc_1001E2E0

loc_1001E2EC:				; CODE XREF: sub_1001E250+85j
		lea	edx, [esp+4074h+var_404C]
		push	edx
		push	ebp
		mov	[esp+407Ch+var_404C], ebx
		mov	[esp+407Ch+var_4044], ebx
		call	ds:PR_GetSocketOption
		add	esp, 8
		test	eax, eax
		jz	short loc_1001E30D
		mov	[esp+4074h+var_4054], ebx
		jmp	short loc_1001E31A
; ---------------------------------------------------------------------------

loc_1001E30D:				; CODE XREF: sub_1001E250+B5j
		xor	eax, eax
		cmp	[esp+4074h+var_4044], ebx
		setz	al
		mov	[esp+4074h+var_4054], eax

loc_1001E31A:				; CODE XREF: sub_1001E250+BBj
		cmp	esi, ebx
		jz	short loc_1001E331
		mov	edi, edi

loc_1001E320:				; CODE XREF: sub_1001E250+D9j
		cmp	[edi+4], ebx
		jnz	short loc_1001E32D
		add	edi, 8
		dec	esi
		jnz	short loc_1001E320
		jmp	short loc_1001E331
; ---------------------------------------------------------------------------

loc_1001E32D:				; CODE XREF: sub_1001E250+D3j
		cmp	esi, ebx
		jnz	short loc_1001E34A

loc_1001E331:				; CODE XREF: sub_1001E250+CCj
					; sub_1001E250+DBj
		mov	ecx, [esp+4074h+arg_C]
		push	ecx
		push	ebx
		push	ebx
		push	ebx
		push	ebp
		call	sub_1001DB10
		add	esp, 14h
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E34A:				; CODE XREF: sub_1001E250+DFj
		mov	ebp, [edi]
		mov	ebx, [edi+4]
		add	edi, 8
		dec	esi
		jz	short loc_1001E36E

loc_1001E355:				; CODE XREF: sub_1001E250+10Fj
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1001E363
		add	edi, 8
		dec	esi
		jnz	short loc_1001E355
		jmp	short loc_1001E36E
; ---------------------------------------------------------------------------

loc_1001E363:				; CODE XREF: sub_1001E250+109j
		mov	[esp+4074h+arg_8], esi
		test	esi, esi
		jnz	short loc_1001E38C

loc_1001E36E:				; CODE XREF: sub_1001E250+103j
					; sub_1001E250+111j
		mov	edx, [esp+4074h+arg_C]
		mov	eax, [esp+4074h+var_4058]
		push	edx
		push	0
		push	ebx
		push	ebp
		push	eax
		call	sub_1001DB10
		add	esp, 14h
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E38C:				; CODE XREF: sub_1001E250+11Cj
		cmp	ebx, [esp+4074h+var_4050]
		jge	loc_1001E463
		push	ebx		; Size
		lea	ecx, [esp+4078h+Dst]
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esp+4080h+var_4050]
		add	esp, 0Ch
		sub	eax, ebx
		mov	[esp+4074h+var_4060], ebx
		mov	[esp+4074h+Size], eax
		jmp	short loc_1001E3B9
; ---------------------------------------------------------------------------

loc_1001E3B5:				; CODE XREF: sub_1001E250+1C5j
		mov	eax, [esp+4074h+Size]

loc_1001E3B9:				; CODE XREF: sub_1001E250+163j
		test	eax, eax
		jz	short loc_1001E417
		mov	ebp, [edi]
		mov	ebx, [edi+4]
		add	edi, 8
		dec	esi
		mov	[esp+4074h+arg_8], esi
		jz	short loc_1001E3E3
		nop

loc_1001E3D0:				; CODE XREF: sub_1001E250+18Aj
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1001E3DC
		add	edi, 8
		dec	esi
		jnz	short loc_1001E3D0

loc_1001E3DC:				; CODE XREF: sub_1001E250+184j
		mov	[esp+4074h+arg_8], esi

loc_1001E3E3:				; CODE XREF: sub_1001E250+17Dj
		mov	esi, [esp+4074h+Size]
		cmp	eax, ebx
		jl	short loc_1001E3ED
		mov	esi, ebx

loc_1001E3ED:				; CODE XREF: sub_1001E250+199j
		mov	edx, [esp+4074h+var_4060]
		push	esi		; Size
		lea	eax, [esp+edx+4078h+Dst]
		push	ebp		; Src
		push	eax		; Dst
		call	memcpy
		add	[esp+4080h+var_4060], esi
		sub	[esp+4080h+Size], esi
		add	ebp, esi
		sub	ebx, esi
		mov	esi, [esp+4080h+arg_8]
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1001E3B5

loc_1001E417:				; CODE XREF: sub_1001E250+16Bj
		mov	ecx, [esp+4074h+arg_C]
		mov	edx, [esp+4074h+var_4060]
		push	ecx
		mov	ecx, [esp+4078h+var_4058]
		push	0
		push	edx
		lea	eax, [esp+4080h+Dst]
		push	eax
		push	ecx
		call	sub_1001DB10
		add	esp, 14h
		cmp	eax, [esp+4074h+var_4060]
		jz	short loc_1001E45B
		test	eax, eax
		jns	loc_1001E68D
		cmp	[esp+4074h+var_4054], 0
		jnz	short loc_1001E453
		call	ds:PR_GetError

loc_1001E453:				; CODE XREF: sub_1001E250+1FBj
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E45B:				; CODE XREF: sub_1001E250+1ECj
		mov	edx, [esp+4074h+var_4060]
		mov	[esp+4074h+Size], edx

loc_1001E463:				; CODE XREF: sub_1001E250+140j
					; sub_1001E250+29Aj ...
		test	esi, esi
		jnz	short loc_1001E474
		test	ebx, ebx
		jnz	short loc_1001E4A3
		mov	eax, [esp+4074h+Size]
		jmp	loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E474:				; CODE XREF: sub_1001E250+215j
		test	ebx, ebx
		jnz	short loc_1001E4A3
		mov	ebp, [edi]
		mov	ebx, [edi+4]
		add	edi, 8
		dec	esi
		mov	[esp+4074h+arg_8], esi
		jz	short loc_1001E4A3
		lea	ebx, [ebx+0]

loc_1001E490:				; CODE XREF: sub_1001E250+24Aj
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1001E49C
		add	edi, 8
		dec	esi
		jnz	short loc_1001E490

loc_1001E49C:				; CODE XREF: sub_1001E250+244j
		mov	[esp+4074h+arg_8], esi

loc_1001E4A3:				; CODE XREF: sub_1001E250+219j
					; sub_1001E250+226j ...
		cmp	ebx, 4000h
		jb	short loc_1001E4E8
		jmp	short loc_1001E4B0
; ---------------------------------------------------------------------------
		align 10h

loc_1001E4B0:				; CODE XREF: sub_1001E250+25Bj
					; sub_1001E250+296j
		mov	eax, [esp+4074h+arg_C]
		mov	ecx, [esp+4074h+var_4058]
		push	eax
		push	0
		push	4000h
		push	ebp
		push	ecx
		call	sub_1001DB10
		add	esp, 14h
		cmp	eax, 4000h
		jnz	loc_1001E664
		add	[esp+4074h+Size], eax
		sub	ebx, eax
		add	ebp, 4000h
		cmp	ebx, eax
		jnb	short loc_1001E4B0

loc_1001E4E8:				; CODE XREF: sub_1001E250+259j
		test	ebx, ebx
		jz	loc_1001E463
		test	esi, esi
		jz	short loc_1001E535
		cmp	ebx, [esp+4074h+var_405C]
		jg	short loc_1001E535
		mov	esi, [edi+4]
		and	esi, 3FFFh
		lea	edx, [esi+ebx]
		cmp	edx, [esp+4074h+var_405C]
		jle	short loc_1001E531
		cmp	[esp+4074h+arg_8], 1
		jle	short loc_1001E535
		mov	eax, [edi+0Ch]
		mov	ecx, [esp+4074h+var_405C]
		and	eax, 3FFFh
		add	eax, esi
		add	eax, ebx
		lea	edx, [ecx+ecx]
		cmp	eax, edx
		ja	short loc_1001E535
		mov	esi, ecx
		sub	esi, ebx

loc_1001E531:				; CODE XREF: sub_1001E250+2BAj
		test	esi, esi
		jnz	short loc_1001E568

loc_1001E535:				; CODE XREF: sub_1001E250+2A2j
					; sub_1001E250+2A8j ...
		mov	eax, [esp+4074h+arg_C]
		mov	ecx, [esp+4074h+var_4058]
		push	eax
		push	0
		push	ebx
		push	ebp
		push	ecx
		call	sub_1001DB10
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_1001E664
		add	[esp+4074h+Size], ebx
		mov	esi, [esp+4074h+arg_8]
		xor	ebx, ebx
		jmp	loc_1001E463
; ---------------------------------------------------------------------------

loc_1001E568:				; CODE XREF: sub_1001E250+2E3j
		push	ebx		; Size
		lea	edx, [esp+4078h+Dst]
		push	ebp		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[esp+4074h+var_4060], ebx
		jmp	short loc_1001E580
; ---------------------------------------------------------------------------
		align 10h

loc_1001E580:				; CODE XREF: sub_1001E250+32Bj
					; sub_1001E250+3D9j
		mov	eax, [esp+4074h+arg_8]
		mov	ebp, [edi]
		mov	ebx, [edi+4]
		add	edi, 8
		dec	eax
		mov	[esp+4074h+arg_8], eax
		jz	short loc_1001E5B3
		lea	esp, [esp+0]

loc_1001E5A0:				; CODE XREF: sub_1001E250+35Aj
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1001E5AC
		add	edi, 8
		dec	eax
		jnz	short loc_1001E5A0

loc_1001E5AC:				; CODE XREF: sub_1001E250+354j
		mov	[esp+4074h+arg_8], eax

loc_1001E5B3:				; CODE XREF: sub_1001E250+347j
		mov	eax, [esp+4074h+var_4060]
		push	esi		; Size
		lea	ecx, [esp+eax+4078h+Dst]
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		mov	ecx, [esp+4080h+var_4060]
		add	ecx, esi
		mov	eax, 4000h
		sub	eax, ecx
		add	esp, 0Ch
		add	ebp, esi
		sub	ebx, esi
		mov	[esp+4074h+var_4060], ecx
		cmp	[esp+4074h+var_405C], eax
		jnb	short loc_1001E5E5
		mov	eax, [esp+4074h+var_405C]

loc_1001E5E5:				; CODE XREF: sub_1001E250+38Fj
		mov	ecx, [esp+4074h+arg_8]
		test	ecx, ecx
		jz	short loc_1001E62F
		test	ebx, ebx
		jg	short loc_1001E62F
		cmp	[esp+4074h+var_4060], 4000h
		jnb	short loc_1001E62F
		mov	esi, [edi+4]
		and	esi, 3FFFh
		cmp	esi, eax
		jle	short loc_1001E627
		cmp	ecx, 1
		jle	short loc_1001E62F
		mov	edx, [edi+0Ch]
		mov	ecx, [esp+4074h+var_405C]
		and	edx, 3FFFh
		add	edx, esi
		add	ecx, eax
		cmp	edx, ecx
		ja	short loc_1001E62F
		mov	esi, eax

loc_1001E627:				; CODE XREF: sub_1001E250+3B9j
		test	esi, esi
		jnz	loc_1001E580

loc_1001E62F:				; CODE XREF: sub_1001E250+39Ej
					; sub_1001E250+3A2j ...
		mov	edx, [esp+4074h+arg_C]
		mov	esi, [esp+4074h+var_4060]
		mov	ecx, [esp+4074h+var_4058]
		push	edx
		push	0
		push	esi
		lea	eax, [esp+4080h+Dst]
		push	eax
		push	ecx
		call	sub_1001DB10
		add	esp, 14h
		cmp	eax, esi
		jnz	short loc_1001E664
		add	[esp+4074h+Size], esi
		mov	esi, [esp+4074h+arg_8]
		jmp	loc_1001E463
; ---------------------------------------------------------------------------

loc_1001E664:				; CODE XREF: sub_1001E250+282j
					; sub_1001E250+300j ...
		test	eax, eax
		jns	short loc_1001E689
		cmp	[esp+4074h+var_4054], 0
		jnz	short loc_1001E684
		call	ds:PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_1001E684
		mov	eax, [esp+4074h+Size]
		test	eax, eax
		jg	short loc_1001E68D

loc_1001E684:				; CODE XREF: sub_1001E250+41Dj
					; sub_1001E250+42Aj
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001E68D
; ---------------------------------------------------------------------------

loc_1001E689:				; CODE XREF: sub_1001E250+416j
		add	eax, [esp+4074h+Size]

loc_1001E68D:				; CODE XREF: sub_1001E250+62j
					; sub_1001E250+7Cj ...
		mov	ecx, [esp+4074h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4064h
		retn
sub_1001E250	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E6B0	proc near		; DATA XREF: .rdata:off_1002EA28o
					; .rdata:off_1002EA30o	...
		push	0
		push	0FFFFE898h
		call	ds:PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
sub_1001E6B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E6D0	proc near		; DATA XREF: .rdata:off_1002EA2Co
					; .rdata:off_1002EA38o
		push	0
		push	0FFFFE898h
		call	ds:PR_SetError
		or	eax, 0FFFFFFFFh
		add	esp, 8
		or	edx, eax
		retn
sub_1001E6D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E6F0	proc near		; CODE XREF: .text:1001E853p
		push	esi
		push	edi
		call	ds:PR_GetDefaultIOMethods
		mov	edx, ds:off_1002EA24
		mov	esi, eax
		mov	eax, ds:off_1002EA1C
		mov	ecx, 24h
		mov	edi, offset dword_100378B8
		rep movsd
		mov	ecx, ds:off_1002EA20
		mov	dword_100378BC,	eax
		mov	eax, ds:off_1002EA28
		mov	dword_100378C0,	ecx
		mov	ecx, ds:off_1002EA2C
		mov	dword_100378C4,	edx
		mov	edx, ds:off_1002EA30
		mov	dword_100378C8,	eax
		mov	eax, ds:off_1002EA34
		mov	dword_100378CC,	ecx
		mov	ecx, ds:off_1002EA38
		mov	dword_100378D0,	edx
		mov	edx, ds:off_1002EA3C
		mov	dword_100378D4,	eax
		mov	eax, ds:off_1002EA40
		mov	dword_100378D8,	ecx
		mov	ecx, ds:off_1002EA44
		mov	dword_100378DC,	edx
		mov	edx, ds:off_1002EA48
		mov	dword_100378E0,	eax
		mov	eax, ds:off_1002EA4C
		mov	dword_100378E4,	ecx
		mov	ecx, ds:off_1002EA50
		mov	dword_100378E8,	edx
		mov	edx, ds:off_1002EA54
		mov	dword_100378EC,	eax
		mov	eax, ds:off_1002EA58
		mov	dword_100378F0,	ecx
		mov	ecx, ds:off_1002EA5C
		mov	dword_100378F4,	edx
		mov	edx, ds:off_1002EA60
		mov	dword_100378F8,	eax
		mov	eax, ds:off_1002EA64
		mov	dword_100378FC,	ecx
		mov	ecx, ds:off_1002EA68
		mov	dword_10037900,	edx
		mov	edx, ds:off_1002EA6C
		mov	dword_10037904,	eax
		mov	eax, ds:off_1002EA70
		mov	dword_10037908,	ecx
		mov	ecx, ds:off_1002EA74
		mov	dword_1003790C,	edx
		mov	edx, ds:off_1002EA78
		mov	dword_10037910,	eax
		mov	eax, ds:off_1002EA7C
		mov	dword_10037914,	ecx
		mov	ecx, ds:off_1002EA90
		pop	edi
		mov	dword_100378B8,	4
		mov	dword_10037918,	edx
		mov	dword_1003791C,	eax
		mov	dword_10037930,	ecx
		pop	esi
		retn
sub_1001E6F0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1001E840:				; DATA XREF: sub_1001E870+Fo
					; sub_1001FF60+107o
		push	offset dword_1002EAA8
		call	ds:PR_GetUniqueIdentity
		add	esp, 4
		mov	dword_10037948,	eax
		call	sub_1001E6F0
		mov	dword_1003794C,	1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E870	proc near		; CODE XREF: sub_1001FE40+A1p

arg_0		= dword	ptr  4

		cmp	dword_1003794C,	0
		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		jnz	short loc_1001E896
		push	offset loc_1001E840
		push	offset dword_100378A0
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001E8D0

loc_1001E896:				; CODE XREF: sub_1001E870+Dj
		test	edi, edi
		jz	short loc_1001E8D0
		mov	eax, dword_10037948
		push	offset dword_100378B8
		push	eax
		call	ds:PR_CreateIOLayerStub
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001E8D0
		push	esi
		push	ebp
		push	ebx
		mov	[esi+4], edi
		call	ds:PR_PushIOLayer
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001E8D6
		mov	ecx, [esi+10h]
		push	esi
		call	ecx
		add	esp, 4

loc_1001E8D0:				; CODE XREF: sub_1001E870+24j
					; sub_1001E870+28j ...
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001E8D6:				; CODE XREF: sub_1001E870+55j
		cmp	ebp, 0FFFFFFFEh
		jnz	short loc_1001E8DD
		mov	esi, ebx

loc_1001E8DD:				; CODE XREF: sub_1001E870+69j
		mov	[edi], esi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
sub_1001E870	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E8F0	proc near		; CODE XREF: sub_1001EB40+1CCp
					; SSL_OptionSet+3B3p
		push	esi
		push	edi
		mov	edi, ds:PR_NewMonitor
		mov	esi, eax
		call	edi ; PR_NewMonitor
		mov	[esi+254h], eax
		test	eax, eax
		jz	short loc_1001E974
		call	edi ; PR_NewMonitor
		mov	[esi+258h], eax
		test	eax, eax
		jz	short loc_1001E974
		push	0
		push	0FFh
		call	NSSRWLock_New_Util
		add	esp, 8
		mov	[esi+25Ch], eax
		test	eax, eax
		jz	short loc_1001E974
		call	edi ; PR_NewMonitor
		mov	[esi+24Ch], eax
		test	eax, eax
		jz	short loc_1001E974
		call	edi ; PR_NewMonitor
		mov	[esi+250h], eax
		test	eax, eax
		jz	short loc_1001E974
		mov	dword ptr [esi+264h], 0
		cmp	dword_10037120,	0
		jz	short loc_1001E97F
		mov	edi, ds:PR_NewLock
		call	edi ; PR_NewLock
		mov	[esi+244h], eax
		test	eax, eax
		jz	short loc_1001E974
		call	edi ; PR_NewLock
		mov	[esi+248h], eax
		test	eax, eax
		jnz	short loc_1001E97F

loc_1001E974:				; CODE XREF: sub_1001E8F0+14j
					; sub_1001E8F0+20j ...
		call	sub_1001C190
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001E97F:				; CODE XREF: sub_1001E8F0+64j
					; sub_1001E8F0+82j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_1001E8F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001E990	proc near		; CODE XREF: sub_1001EB40+7p
					; SSL_OptionGetDefault:loc_1001F643p ...
		cmp	dword_10037144,	0
		jz	locret_1001EB32
		push	esi
		mov	esi, ds:getenv
		push	offset aSslkeylogfile ;	"SSLKEYLOGFILE"
		mov	dword_10037144,	0
		call	esi ; getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_1001E9FB
		cmp	byte ptr [eax],	0
		jz	short loc_1001E9FB
		push	offset Mode	; "a"
		push	eax		; Filename
		call	ds:fopen
		add	esp, 8
		mov	File, eax
		test	eax, eax
		jz	short loc_1001E9FB
		push	eax		; File
		call	ds:ftell
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001E9FB
		mov	eax, File
		push	eax		; File
		push	offset aSslTlsSecretsL ; "# SSL/TLS secrets log	file, generated	b"...
		call	ds:fputs
		add	esp, 8

loc_1001E9FB:				; CODE XREF: sub_1001E990+2Aj
					; sub_1001E990+2Fj ...
		push	offset aSslbypass ; "SSLBYPASS"
		call	esi ; getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EA2D
		mov	al, [eax]
		test	al, al
		jz	short loc_1001EA2D
		xor	ecx, ecx
		cmp	al, 31h
		mov	eax, dword_10037114
		setz	cl
		shl	ecx, 0Fh
		xor	ecx, eax
		and	ecx, 8000h
		xor	eax, ecx
		mov	dword_10037114,	eax

loc_1001EA2D:				; CODE XREF: sub_1001E990+77j
					; sub_1001E990+7Dj
		push	offset aSslforcelocks ;	"SSLFORCELOCKS"
		call	esi ; getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EA78
		cmp	byte ptr [eax],	31h
		jnz	short loc_1001EA78
		mov	edx, ds:dword_1002EB08
		mov	eax, ds:dword_1002EB0C
		mov	cx, ds:word_1002EB10
		and	dword_10037114,	0FFFEFFFFh
		mov	dword_10037EA0,	1
		mov	dword_1003712E,	edx
		mov	dword_10037132,	eax
		mov	word_10037136, cx

loc_1001EA78:				; CODE XREF: sub_1001E990+A9j
					; sub_1001E990+AEj
		push	offset aNss_ssl_enable ; "NSS_SSL_ENABLE_RENEGOTIATION"
		call	esi ; getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EAF7
		mov	al, [eax]
		cmp	al, 31h
		jz	short loc_1001EAE3
		mov	cl, al
		or	cl, 20h
		cmp	cl, 75h
		jz	short loc_1001EAE3
		cmp	al, 30h
		jz	short loc_1001EAD7
		cmp	cl, 6Eh
		jz	short loc_1001EAD7
		cmp	al, 32h
		jz	short loc_1001EABD
		cmp	cl, 72h
		jz	short loc_1001EABD
		cmp	al, 33h
		jz	short loc_1001EAB1
		cmp	cl, 74h
		jnz	short loc_1001EAF7

loc_1001EAB1:				; CODE XREF: sub_1001E990+11Aj
		or	dword_10037114,	180000h
		jmp	short loc_1001EAF7
; ---------------------------------------------------------------------------

loc_1001EABD:				; CODE XREF: sub_1001E990+111j
					; sub_1001E990+116j
		mov	edx, dword_10037114
		and	edx, 0FFF7FFFFh
		or	edx, 100000h
		mov	dword_10037114,	edx
		jmp	short loc_1001EAF7
; ---------------------------------------------------------------------------

loc_1001EAD7:				; CODE XREF: sub_1001E990+108j
					; sub_1001E990+10Dj
		and	dword_10037114,	0FFE7FFFFh
		jmp	short loc_1001EAF7
; ---------------------------------------------------------------------------

loc_1001EAE3:				; CODE XREF: sub_1001E990+FAj
					; sub_1001E990+104j
		mov	eax, dword_10037114
		and	eax, 0FFEFFFFFh
		or	eax, 80000h
		mov	dword_10037114,	eax

loc_1001EAF7:				; CODE XREF: sub_1001E990+F4j
					; sub_1001E990+11Fj ...
		push	offset aNss_ssl_requir ; "NSS_SSL_REQUIRE_SAFE_NEGOTIATION"
		call	esi ; getenv
		add	esp, 4
		test	eax, eax
		jz	short loc_1001EB14
		cmp	byte ptr [eax],	31h
		jnz	short loc_1001EB14
		or	dword_10037114,	200000h

loc_1001EB14:				; CODE XREF: sub_1001E990+173j
					; sub_1001E990+178j
		push	offset aNss_ssl_cbc_ra ; "NSS_SSL_CBC_RANDOM_IV"
		call	esi ; getenv
		add	esp, 4
		pop	esi
		test	eax, eax
		jz	short locret_1001EB32
		cmp	byte ptr [eax],	30h
		jnz	short locret_1001EB32
		and	dword_10037114,	0FF7FFFFFh

locret_1001EB32:			; CODE XREF: sub_1001E990+7j
					; sub_1001E990+191j ...
		retn
sub_1001E990	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001EB40	proc near		; CODE XREF: sub_1001ED60+1Bp
					; sub_1001FE40+44p

arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		push	edi
		call	sub_1001E990
		xor	edi, edi
		cmp	dword_10037EA0,	edi
		jz	short loc_1001EB59
		lea	ebp, [edi+1]

loc_1001EB59:				; CODE XREF: sub_1001EB40+14j
		push	2F40h
		call	PORT_ZAlloc_Util
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jz	loc_1001ED50
		mov	eax, dword_10037108
		mov	[esi+8], eax
		mov	ecx, dword_1003710C
		mov	[esi+0Ch], ecx
		mov	edx, dword_10037110
		xor	ecx, ecx
		cmp	ebp, edi
		setz	cl
		mov	[esi+10h], edx
		mov	eax, dword_10037114
		mov	edx, eax
		and	edx, 0FFFEFFFDh
		mov	eax, offset word_10037118
		and	ecx, 1
		shl	ecx, 10h
		or	ecx, edx
		mov	[esi+14h], ecx
		cmp	ebx, edi
		jz	short loc_1001EBB7
		mov	eax, offset dword_1003711C

loc_1001EBB7:				; CODE XREF: sub_1001EB40+70j
		mov	eax, [eax]
		mov	[esi+18h], eax
		mov	[esi+2F38h], ebx
		mov	[esi+1E8h], edi
		mov	[esi+1ECh], edi
		mov	[esi+1F0h], edi
		mov	[esi+1F4h], edi
		mov	[esi+1D8h], edi
		or	eax, 0FFFFFFFFh
		mov	[esi+238h], eax
		mov	[esi+23Ch], eax
		mov	[esi+240h], eax
		mov	[esi+2ECh], edi
		mov	[esi+2F0h], edi
		mov	[esi+2F4h], edi
		mov	[esi+2F8h], edi
		mov	[esi+33Ch], edi
		mov	[esi+2FCh], edi
		mov	[esi+300h], edi
		mov	[esi+304h], edi
		mov	[esi+308h], edi
		mov	[esi+340h], edi
		mov	[esi+30Ch], edi
		mov	[esi+310h], edi
		mov	[esi+314h], edi
		mov	[esi+318h], edi
		mov	[esi+344h], edi
		mov	[esi+31Ch], edi
		mov	[esi+320h], edi
		mov	[esi+324h], edi
		mov	[esi+328h], edi
		mov	[esi+348h], edi
		mov	[esi+32Ch], edi
		mov	[esi+330h], edi
		mov	[esi+334h], edi
		mov	[esi+338h], edi
		mov	[esi+34Ch], edi
		mov	[esi+1F8h], edi
		call	CERT_GetDefaultCertDB
		test	byte ptr [esi+14h], 1
		mov	[esi+260h], eax
		mov	[esi+200h], eax
		mov	dword ptr [esi+1FCh], offset SSL_AuthCertificate
		mov	[esi+20Ch], edi
		mov	[esi+210h], edi
		mov	[esi+204h], edi
		mov	[esi+214h], edi
		mov	[esi+218h], edi
		mov	[esi+22Ch], edi
		mov	[esi+444h], edi
		mov	eax, offset off_1002E9DC
		jnz	short loc_1001ECE6
		mov	eax, offset off_1002E9AC

loc_1001ECE6:				; CODE XREF: sub_1001EB40+19Fj
		push	esi
		mov	[esi+4], eax
		call	sub_10010F80
		push	esi
		call	sub_100077F0
		lea	eax, [esi+8D8h]
		add	esp, 8
		mov	[eax], eax
		mov	[esi+8DCh], eax
		cmp	ebp, edi
		jz	short loc_1001ED15
		mov	eax, esi
		call	sub_1001E8F0
		test	eax, eax
		jnz	short loc_1001ED35

loc_1001ED15:				; CODE XREF: sub_1001EB40+1C8j
		push	esi
		call	sub_10019070
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001ED35
		lea	ecx, [esi+274h]
		push	ecx
		call	sub_10017510
		add	esp, 4
		test	eax, eax
		jz	short loc_1001ED4E

loc_1001ED35:				; CODE XREF: sub_1001EB40+1D3j
					; sub_1001EB40+1E0j
		call	sub_1001C250
		call	sub_1001C190
		push	esi
		call	PORT_Free_Util
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001ED4E:				; CODE XREF: sub_1001EB40+1F3j
		mov	eax, esi

loc_1001ED50:				; CODE XREF: sub_1001EB40+2Aj
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1001EB40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001ED60	proc near		; CODE XREF: sub_1001FE40+8Fp
					; sub_1001FF60+A0p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+14h+arg_0]
		movzx	eax, word ptr [ebp+16h]
		mov	ebx, [ebp+2F38h]
		push	esi
		not	eax
		and	eax, 1
		push	edi
		push	eax
		call	sub_1001EB40
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_1001F0BB
		mov	ecx, [ebp+8]
		mov	[ebx+8], ecx
		mov	edx, [ebp+0Ch]
		mov	[ebx+0Ch], edx
		mov	eax, [ebp+10h]
		mov	[ebx+10h], eax
		mov	ecx, [ebp+14h]
		mov	[ebx+14h], ecx
		and	dword ptr [ebx+14h], 0FFFFFFFDh
		mov	edx, [ebp+18h]
		mov	[ebx+18h], edx
		mov	eax, [ebp+1E8h]
		test	eax, eax
		jz	short loc_1001EDC2
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4

loc_1001EDC2:				; CODE XREF: sub_1001ED60+57j
		mov	[ebx+1E8h], eax
		mov	eax, [ebp+1D8h]
		test	eax, eax
		jz	short loc_1001EDDB
		push	eax
		call	PORT_Strdup_Util
		add	esp, 4

loc_1001EDDB:				; CODE XREF: sub_1001ED60+70j
		mov	[ebx+1D8h], eax
		mov	eax, [ebp+4]
		mov	[ebx+4], eax
		mov	ecx, [ebp+238h]
		mov	[ebx+238h], ecx
		mov	edx, [ebp+23Ch]
		mov	[ebx+23Ch], edx
		mov	eax, [ebp+240h]
		mov	[ebx+240h], eax
		mov	ecx, [ebp+260h]
		mov	[ebx+260h], ecx
		movzx	edx, word ptr [ebp+26Ah]
		mov	[ebx+26Ah], dx
		mov	ax, [ebp+26Ch]
		mov	[ebx+26Ch], ax
		mov	cx, [ebp+26Eh]
		mov	[ebx+26Eh], cx
		lea	esi, [ebp+350h]
		lea	edi, [ebx+350h]
		mov	ecx, 3Dh
		rep movsd
		movzx	edx, word ptr [ebp+2E92h]
		add	edx, edx
		push	edx		; Size
		lea	eax, [ebp+2E8Ah]
		push	eax		; Src
		lea	ecx, [ebx+2E8Ah]
		push	ecx		; Dst
		call	memcpy
		movzx	edx, word ptr [ebp+2E92h]
		xor	esi, esi
		add	esp, 0Ch
		mov	[ebx+2E92h], dx
		cmp	[ebp+1ECh], esi
		jz	short loc_1001EED6
		mov	eax, [ebp+1F0h]
		push	eax
		call	PORT_Alloc_Util
		add	esp, 4
		mov	[ebx+1ECh], eax
		cmp	eax, esi
		jz	short loc_1001EEBC
		mov	ecx, [ebp+1F0h]
		mov	edx, [ebp+1ECh]
		push	ecx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001EEBC:				; CODE XREF: sub_1001ED60+143j
		mov	eax, [ebp+1F0h]
		mov	[ebx+1F0h], eax
		mov	ecx, [ebp+1F4h]
		mov	[ebx+1F4h], ecx
		jmp	short loc_1001EEE8
; ---------------------------------------------------------------------------

loc_1001EED6:				; CODE XREF: sub_1001ED60+12Aj
		mov	[ebx+1ECh], esi
		mov	[ebx+1F0h], esi
		mov	[ebx+1F4h], esi

loc_1001EEE8:				; CODE XREF: sub_1001ED60+174j
		test	byte ptr [ebx+14h], 1
		jz	loc_1001F0BB
		lea	eax, [ebp+33Ch]
		lea	edi, [ebp+2ECh]
		mov	[esp+1Ch+arg_0], eax
		mov	edx, edi
		mov	eax, ebx
		sub	edx, ebp
		sub	eax, ebp
		mov	ecx, ebp
		sub	ecx, ebx
		mov	[esp+1Ch+var_8], esi
		lea	esi, [edx+ebx+4]
		mov	[esp+1Ch+var_4], eax
		mov	[esp+1Ch+var_C], ecx
		jmp	short loc_1001EF24
; ---------------------------------------------------------------------------

loc_1001EF20:				; CODE XREF: sub_1001ED60+266j
		mov	ecx, [esp+1Ch+var_C]

loc_1001EF24:				; CODE XREF: sub_1001ED60+1BEj
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_1001EF55
		cmp	dword ptr [ecx+esi], 0
		jz	short loc_1001EF55
		push	eax
		call	CERT_DupCertificate
		mov	ecx, [esp+20h+var_C]
		mov	[esi-4], eax
		mov	edx, [ecx+esi]
		push	edx
		call	CERT_DupCertList
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jz	loc_1001F0A8
		jmp	short loc_1001EF62
; ---------------------------------------------------------------------------

loc_1001EF55:				; CODE XREF: sub_1001ED60+1C8j
					; sub_1001ED60+1CEj
		mov	dword ptr [esi-4], 0
		mov	dword ptr [esi], 0

loc_1001EF62:				; CODE XREF: sub_1001ED60+1F3j
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_1001EF74
		push	eax
		call	sub_100074C0
		add	esp, 4
		jmp	short loc_1001EF76
; ---------------------------------------------------------------------------

loc_1001EF74:				; CODE XREF: sub_1001ED60+207j
		xor	eax, eax

loc_1001EF76:				; CODE XREF: sub_1001ED60+212j
		mov	[esi+4], eax
		cmp	dword ptr [edi+8], 0
		jz	short loc_1001EF87
		test	eax, eax
		jz	loc_1001F0A8

loc_1001EF87:				; CODE XREF: sub_1001ED60+21Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [esp+1Ch+arg_0]
		mov	[esi+8], eax
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1001EFA2
		push	eax
		push	0
		call	SECITEM_DupArray
		add	esp, 8

loc_1001EFA2:				; CODE XREF: sub_1001ED60+235j
		mov	ecx, [esp+1Ch+arg_0]
		mov	edx, [esp+1Ch+var_4]
		mov	[edx+ecx], eax
		mov	eax, [esp+1Ch+var_8]
		inc	eax
		add	ecx, 4
		add	edi, 10h
		add	esi, 10h
		mov	[esp+1Ch+var_8], eax
		mov	[esp+1Ch+arg_0], ecx
		cmp	eax, 5
		jl	loc_1001EF20
		mov	eax, [ebp+1F8h]
		test	eax, eax
		jz	short loc_1001EFDF
		push	eax
		call	sub_100074C0
		add	esp, 4

loc_1001EFDF:				; CODE XREF: sub_1001ED60+274j
		mov	[ebx+1F8h], eax
		mov	eax, [ebp+444h]
		test	eax, eax
		jz	short loc_1001EFF8
		push	eax
		call	sub_100074C0
		add	esp, 4

loc_1001EFF8:				; CODE XREF: sub_1001ED60+28Dj
		mov	[ebx+444h], eax
		mov	eax, [ebp+1FCh]
		mov	[ebx+1FCh], eax
		mov	ecx, [ebp+200h]
		mov	[ebx+200h], ecx
		mov	edx, [ebp+204h]
		mov	[ebx+204h], edx
		mov	eax, [ebp+208h]
		mov	[ebx+208h], eax
		mov	ecx, [ebp+20Ch]
		mov	[ebx+20Ch], ecx
		mov	edx, [ebp+210h]
		mov	[ebx+210h], edx
		mov	eax, [ebp+214h]
		mov	[ebx+214h], eax
		mov	ecx, [ebp+218h]
		mov	[ebx+218h], ecx
		mov	edx, [ebp+21Ch]
		mov	[ebx+21Ch], edx
		mov	eax, [ebp+220h]
		mov	[ebx+220h], eax
		mov	ecx, [ebp+224h]
		mov	[ebx+224h], ecx
		mov	edx, [ebp+228h]
		mov	[ebx+228h], edx
		mov	eax, [ebp+22Ch]
		push	ebp
		push	ebx
		mov	[ebx+22Ch], eax
		call	sub_10019100
		add	esp, 8
		test	eax, eax
		jz	short loc_1001F0BB

loc_1001F0A8:				; CODE XREF: sub_1001ED60+1EDj
					; sub_1001ED60+221j
		push	ebx
		call	sub_1001C3A0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001F0BB:				; CODE XREF: sub_1001ED60+27j
					; sub_1001ED60+18Cj ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 0Ch
		retn
sub_1001ED60	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  54. SSL_OptionSet

; =============== S U B	R O U T	I N E =======================================


		public SSL_OptionSet
SSL_OptionSet	proc near		; DATA XREF: .rdata:off_10035848o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10037948
		sub	esp, 8
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		push	eax
		push	ebp
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001F0FE
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	esi, esi
		jmp	short loc_1001F103
; ---------------------------------------------------------------------------

loc_1001F0FE:				; CODE XREF: SSL_OptionSet+1Bj
		mov	esi, [eax+4]
		mov	[esi], eax

loc_1001F103:				; CODE XREF: SSL_OptionSet+2Cj
		mov	[esp+10h+var_8], 0
		test	esi, esi
		jnz	short loc_1001F118
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001F118:				; CODE XREF: SSL_OptionSet+3Dj
		movzx	eax, word ptr [esi+16h]
		push	ebx
		mov	ecx, eax
		mov	ebx, 1
		not	ecx
		and	ecx, ebx
		push	edi
		mov	edi, ds:PR_EnterMonitor
		mov	[esp+18h+var_4], ecx
		test	bl, al
		jnz	short loc_1001F143
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001F143:				; CODE XREF: SSL_OptionSet+65j
		test	[esi+16h], bl
		jnz	short loc_1001F154
		mov	edx, [esi+258h]
		push	edx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001F154:				; CODE XREF: SSL_OptionSet+76j
		mov	eax, [esp+18h+arg_4]
		dec	eax
		cmp	eax, 1Bh	; switch 28 cases
		ja	short loc_1001F17B ; jumptable 1001F15E	default	case
		jmp	ds:off_1001F5A8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001F165:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		and	dword ptr [esi+14h], 0FFFFFFFDh	; jumptable 1001F15E case 1
		mov	eax, esi
		call	sub_1001C530
		mov	[esp+18h+var_8], eax

loc_1001F174:				; CODE XREF: SSL_OptionSet+185j
					; SSL_OptionSet+19Fj ...
		cmp	[esp+18h+arg_8], 0
		jz	short loc_1001F190

loc_1001F17B:				; CODE XREF: SSL_OptionSet+8Cj
					; SSL_OptionSet+8Ej ...
		push	0FFFFE005h	; jumptable 1001F15E default case

loc_1001F180:				; CODE XREF: SSL_OptionSet+2EFj
		call	PORT_SetError_Util
		mov	[esp+1Ch+var_8], 0FFFFFFFFh

loc_1001F18D:				; CODE XREF: SSL_OptionSet+2DFj
		add	esp, 4

loc_1001F190:				; CODE XREF: SSL_OptionSet+A9j
					; SSL_OptionSet+105j ...
		cmp	[esp+18h+var_4], 0
		jz	short loc_1001F1B2

loc_1001F197:				; CODE XREF: SSL_OptionSet+3ABj
		mov	eax, [esi+258h]
		mov	edi, ds:PR_ExitMonitor
		push	eax
		call	edi ; PR_ExitMonitor
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 8

loc_1001F1B2:				; CODE XREF: SSL_OptionSet+C5j
					; SSL_OptionSet+3BEj
		mov	eax, [esp+18h+var_8]
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001F1BE:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esi+14h]	; jumptable 1001F15E case 0
		xor	eax, [esp+18h+arg_8]
		and	eax, ebx
		xor	[esi+14h], eax
		mov	eax, esi
		call	sub_1001C530
		mov	[esp+18h+var_8], eax
		jmp	short loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F1D7:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 2
		lea	edx, ds:0[ecx*4]
		xor	edx, [esi+14h]
		and	edx, 4
		xor	[esi+14h], edx
		jmp	short loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F1ED:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esp+18h+arg_8] ; jumptable 1001F15E case 9
		lea	ecx, ds:0[eax*8]
		xor	ecx, [esi+14h]
		and	ecx, 18h
		xor	[esi+14h], ecx
		jmp	short loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F203:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esi+14h]	; jumptable 1001F15E case 4
		mov	eax, [esp+18h+arg_8]
		test	cl, 40h
		jz	short loc_1001F217
		test	eax, eax
		jnz	loc_1001F17B	; jumptable 1001F15E default case

loc_1001F217:				; CODE XREF: SSL_OptionSet+13Dj
		shl	eax, 5
		xor	eax, ecx
		and	eax, 20h
		xor	eax, ecx
		mov	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F229:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esi+14h]	; jumptable 1001F15E case 5
		mov	eax, [esp+18h+arg_8]
		test	cl, 20h
		jz	short loc_1001F23D
		test	eax, eax
		jnz	loc_1001F17B	; jumptable 1001F15E default case

loc_1001F23D:				; CODE XREF: SSL_OptionSet+163j
		shl	eax, 6
		xor	eax, ecx
		and	eax, 40h
		xor	eax, ecx
		mov	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F24F:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		cmp	[esi+2F38h], ebx ; jumptable 1001F15E case 12
		jz	loc_1001F174
		mov	edx, [esp+18h+arg_8]
		lea	eax, [esi+18h]
		call	sub_1001C5C0
		jmp	short loc_1001F2BA
; ---------------------------------------------------------------------------

loc_1001F269:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		cmp	[esi+2F38h], ebx ; jumptable 1001F15E case 7
		jz	loc_1001F174
		mov	edx, [esp+18h+arg_8]
		lea	ecx, [esi+18h]
		call	sub_1001C610
		jmp	short loc_1001F2BA
; ---------------------------------------------------------------------------

loc_1001F283:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		cmp	[esi+2F38h], ebx ; jumptable 1001F15E case 6
		jz	loc_1001F174
		mov	edx, [esp+18h+arg_8]
		mov	eax, [esi+14h]
		mov	ecx, edx
		and	ecx, ebx
		mov	edi, ecx
		and	eax, 0FFFFFF7Fh
		shl	edi, 7
		or	eax, edi
		mov	[esi+14h], eax
		test	edx, edx
		jz	short loc_1001F2BA
		and	eax, 0FFFFEFFFh
		shl	ecx, 0Ch
		or	eax, ecx
		mov	[esi+14h], eax

loc_1001F2BA:				; CODE XREF: SSL_OptionSet+197j
					; SSL_OptionSet+1B1j ...
		mov	eax, [esi+1ECh]
		mov	dword ptr [esi+1F4h], 0
		test	eax, eax
		jz	loc_1001F190
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		xor	eax, eax
		mov	[esi+1ECh], eax
		mov	[esi+1F0h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F2EE:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edx, [esp+18h+arg_8] ; jumptable 1001F15E case 8
		shl	edx, 0Ah
		xor	edx, [esi+14h]
		and	edx, 400h
		xor	[esi+14h], edx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F306:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edi, [esp+18h+arg_8] ; jumptable 1001F15E case 10
		test	edi, edi
		jz	short loc_1001F328
		test	[esi+16h], bl
		jz	short loc_1001F328
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		mov	[esp+18h+var_8], 0FFFFFFFFh

loc_1001F328:				; CODE XREF: SSL_OptionSet+23Cj
					; SSL_OptionSet+241j
		shl	edi, 0Bh
		xor	edi, [esi+14h]
		and	edi, 800h
		xor	[esi+14h], edi
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F33C:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		cmp	[esi+2F38h], ebx ; jumptable 1001F15E case 11
		jz	loc_1001F174
		mov	ecx, [esp+18h+arg_8]
		mov	eax, ecx
		shl	eax, 0Ch
		xor	eax, [esi+14h]
		and	eax, 1000h
		xor	[esi+14h], eax
		mov	eax, [esi+14h]
		test	ecx, ecx
		jnz	loc_1001F190
		and	eax, 0FFFFFF7Fh
		mov	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F374:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 13
		shl	ecx, 0Dh
		xor	ecx, [esi+14h]
		and	ecx, 2000h
		xor	[esi+14h], ecx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F38C:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esp+18h+arg_8] ; jumptable 1001F15E case 14
		mov	edx, eax
		shl	edx, 0Eh
		xor	edx, [esi+14h]
		and	edx, 4000h
		xor	[esi+14h], edx
		test	eax, eax
		jz	loc_1001F190
		push	ebp
		call	sub_10020690
		jmp	loc_1001F18D
; ---------------------------------------------------------------------------

loc_1001F3B4:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		cmp	dword ptr [esi+2Ch], 0 ; jumptable 1001F15E case 15
		jz	short loc_1001F3C4
		push	0FFFFE8D5h
		jmp	loc_1001F180
; ---------------------------------------------------------------------------

loc_1001F3C4:				; CODE XREF: SSL_OptionSet+2E8j
		mov	edi, [esp+18h+arg_8]
		test	edi, edi
		jz	short loc_1001F3F6
		call	sub_1001C5A0
		test	eax, eax
		jnz	short loc_1001F3E9
		shl	edi, 0Fh
		xor	edi, [esi+14h]
		and	edi, 8000h
		xor	[esi+14h], edi
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F3E9:				; CODE XREF: SSL_OptionSet+303j
		mov	[esp+18h+var_8], 0FFFFFFFFh
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F3F6:				; CODE XREF: SSL_OptionSet+2FAj
		and	dword ptr [esi+14h], 0FFFF7FFFh
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F402:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edi, [esp+18h+arg_8] ; jumptable 1001F15E case 16
		test	edi, edi
		jz	short loc_1001F433
		test	dword ptr [esi+14h], 800h
		jz	short loc_1001F428
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		mov	[esp+18h+var_8], 0FFFFFFFFh

loc_1001F428:				; CODE XREF: SSL_OptionSet+341j
		cmp	dword_10037EA0,	0
		jz	short loc_1001F433
		xor	edi, edi

loc_1001F433:				; CODE XREF: SSL_OptionSet+338j
					; SSL_OptionSet+35Fj
		mov	eax, edi
		shl	eax, 10h
		xor	eax, [esi+14h]
		and	eax, 10000h
		xor	[esi+14h], eax
		test	edi, edi
		jz	short loc_1001F476
		mov	ecx, ds:dword_1002EB74
		mov	edx, ds:dword_1002EB78
		mov	ax, ds:word_1002EB7C
		mov	dword_10037E94,	ebx
		mov	dword_1003712E,	ecx
		mov	dword_10037132,	edx
		mov	word_10037136, ax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F476:				; CODE XREF: SSL_OptionSet+375j
		cmp	[esp+18h+var_4], 0
		jnz	loc_1001F197
		mov	eax, esi
		call	sub_1001E8F0
		mov	[esp+18h+var_8], eax
		test	eax, eax
		jz	loc_1001F1B2
		or	dword ptr [esi+14h], 10000h
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001F4A3:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 17
		shl	ecx, 11h
		xor	ecx, [esi+14h]
		and	ecx, 20000h
		xor	[esi+14h], ecx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F4BB:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edx, [esp+18h+arg_8] ; jumptable 1001F15E case 18
		shl	edx, 12h
		xor	edx, [esi+14h]
		and	edx, 40000h
		xor	[esi+14h], edx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F4D3:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esp+18h+arg_8] ; jumptable 1001F15E case 19
		shl	eax, 13h
		xor	eax, [esi+14h]
		and	eax, 180000h
		xor	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F4EA:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 20
		shl	ecx, 15h
		xor	ecx, [esi+14h]
		and	ecx, 200000h
		xor	[esi+14h], ecx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F502:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edx, [esp+18h+arg_8] ; jumptable 1001F15E case 21
		shl	edx, 16h
		xor	edx, [esi+14h]
		and	edx, 400000h
		xor	[esi+14h], edx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F51A:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esp+18h+arg_8] ; jumptable 1001F15E case 22
		shl	eax, 17h
		xor	eax, [esi+14h]
		and	eax, 800000h
		xor	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F531:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 23
		shl	ecx, 18h
		xor	ecx, [esi+14h]
		and	ecx, 1000000h
		xor	[esi+14h], ecx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F549:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edx, [esp+18h+arg_8] ; jumptable 1001F15E case 24
		shl	edx, 19h
		xor	edx, [esi+14h]
		and	edx, 2000000h
		xor	[esi+14h], edx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F561:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	eax, [esp+18h+arg_8] ; jumptable 1001F15E case 25
		shl	eax, 1Ah
		xor	eax, [esi+14h]
		and	eax, 4000000h
		xor	[esi+14h], eax
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F578:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	ecx, [esp+18h+arg_8] ; jumptable 1001F15E case 26
		shl	ecx, 1Bh
		xor	ecx, [esi+14h]
		and	ecx, 8000000h
		xor	[esi+14h], ecx
		jmp	loc_1001F190
; ---------------------------------------------------------------------------

loc_1001F590:				; CODE XREF: SSL_OptionSet+8Ej
					; DATA XREF: .text:off_1001F5A8o
		mov	edx, [esp+18h+arg_8] ; jumptable 1001F15E case 27
		shl	edx, 1Ch
		xor	edx, [esi+14h]
		and	edx, 10000000h
		xor	[esi+14h], edx
		jmp	loc_1001F190
SSL_OptionSet	endp

; ---------------------------------------------------------------------------
off_1001F5A8	dd offset loc_1001F1BE	; DATA XREF: SSL_OptionSet+8Er
		dd offset loc_1001F165	; jump table for switch	statement
		dd offset loc_1001F1D7
		dd offset loc_1001F17B
		dd offset loc_1001F203
		dd offset loc_1001F229
		dd offset loc_1001F283
		dd offset loc_1001F269
		dd offset loc_1001F2EE
		dd offset loc_1001F1ED
		dd offset loc_1001F306
		dd offset loc_1001F33C
		dd offset loc_1001F24F
		dd offset loc_1001F374
		dd offset loc_1001F38C
		dd offset loc_1001F3B4
		dd offset loc_1001F402
		dd offset loc_1001F4A3
		dd offset loc_1001F4BB
		dd offset loc_1001F4D3
		dd offset loc_1001F4EA
		dd offset loc_1001F502
		dd offset loc_1001F51A
		dd offset loc_1001F531
		dd offset loc_1001F549
		dd offset loc_1001F561
		dd offset loc_1001F578
		dd offset loc_1001F590
		align 10h
; Exported entry  53. SSL_OptionGetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_OptionGetDefault
SSL_OptionGetDefault proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		test	ebx, ebx
		jnz	short loc_1001F643
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F643:				; CODE XREF: SSL_OptionGetDefault+Dj
		call	sub_1001E990
		mov	eax, [esp+0Ch+arg_0]
		dec	eax
		cmp	eax, 1Bh	; switch 28 cases
		ja	loc_1001F872	; jumptable 1001F656 default case
		jmp	ds:off_1001F88C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001F65D:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		xor	esi, esi	; jumptable 1001F656 case 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F667:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 0
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F678:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 2
		shr	esi, 2
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F68C:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 9
		shr	esi, 3
		and	esi, 3
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F6A0:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 4
		shr	esi, 5
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F6B4:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 5
		shr	esi, 6
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F6C8:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	eax, 301h	; jumptable 1001F656 case 12
		cmp	word_1003711A, ax
		mov	eax, edi
		sbb	esi, esi
		inc	esi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F6DF:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		xor	edx, edx	; jumptable 1001F656 case 7
		mov	ecx, 300h
		cmp	word_10037118, cx
		mov	eax, edi
		setz	dl
		pop	edi
		mov	esi, edx
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F6FA:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 6
		shr	esi, 7
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F70E:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 8
		shr	esi, 0Ah
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F722:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 10
		shr	esi, 0Bh
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F736:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 11
		shr	esi, 0Ch
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F74A:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 13
		shr	esi, 0Dh
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F75E:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 14
		shr	esi, 0Eh
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F772:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 15
		shr	esi, 0Fh
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F786:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		movzx	esi, word ptr dword_10037114+2 ; jumptable 1001F656 case 16
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F798:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 17
		shr	esi, 11h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F7AC:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 18
		shr	esi, 12h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F7C0:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 19
		shr	esi, 13h
		and	esi, 3
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F7D4:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 20
		shr	esi, 15h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F7E8:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 21
		shr	esi, 16h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F7FC:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 22
		shr	esi, 17h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F810:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		movzx	esi, byte ptr dword_10037114+3 ; jumptable 1001F656 case 23
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F822:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 24
		shr	esi, 19h
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F836:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 25
		shr	esi, 1Ah
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F84A:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 26
		shr	esi, 1Bh
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F85E:				; CODE XREF: SSL_OptionGetDefault+36j
					; DATA XREF: .text:off_1001F88Co
		mov	esi, dword_10037114 ; jumptable	1001F656 case 27
		shr	esi, 1Ch
		and	esi, 1
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001F872:				; CODE XREF: SSL_OptionGetDefault+30j
					; SSL_OptionGetDefault+36j
					; DATA XREF: ...
		push	0FFFFE005h	; jumptable 1001F656 default case
		call	PORT_SetError_Util
		add	esp, 4
		or	edi, 0FFFFFFFFh
		mov	eax, edi
		pop	edi
		mov	[ebx], esi
		pop	esi
		pop	ebx
		retn
SSL_OptionGetDefault endp

; ---------------------------------------------------------------------------
		align 4
off_1001F88C	dd offset loc_1001F667	; DATA XREF: SSL_OptionGetDefault+36r
		dd offset loc_1001F65D	; jump table for switch	statement
		dd offset loc_1001F678
		dd offset loc_1001F872
		dd offset loc_1001F6A0
		dd offset loc_1001F6B4
		dd offset loc_1001F6FA
		dd offset loc_1001F6DF
		dd offset loc_1001F70E
		dd offset loc_1001F68C
		dd offset loc_1001F722
		dd offset loc_1001F736
		dd offset loc_1001F6C8
		dd offset loc_1001F74A
		dd offset loc_1001F75E
		dd offset loc_1001F772
		dd offset loc_1001F786
		dd offset loc_1001F798
		dd offset loc_1001F7AC
		dd offset loc_1001F7C0
		dd offset loc_1001F7D4
		dd offset loc_1001F7E8
		dd offset loc_1001F7FC
		dd offset loc_1001F810
		dd offset loc_1001F822
		dd offset loc_1001F836
		dd offset loc_1001F84A
		dd offset loc_1001F85E
		align 10h
; Exported entry  55. SSL_OptionSetDefault

; =============== S U B	R O U T	I N E =======================================


		public SSL_OptionSetDefault
SSL_OptionSetDefault proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		call	sub_10014850
		test	eax, eax
		jnz	short locret_1001F943
		push	esi
		call	sub_1001E990
		mov	eax, [esp+4+arg_0]
		dec	eax
		cmp	eax, 1Bh	; switch 28 cases
		ja	short loc_1001F932 ; jumptable 1001F919	default	case
		jmp	ds:off_1001FD28[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001F920:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		and	dword_10037114,	0FFFFFFFDh ; jumptable 1001F919	case 1
		cmp	[esp+4+arg_4], 0
		jz	loc_1001FD24

loc_1001F932:				; CODE XREF: SSL_OptionSetDefault+17j
					; SSL_OptionSetDefault+19j ...
		push	0FFFFE005h	; jumptable 1001F919 default case
		call	PORT_SetError_Util
		add	esp, 4

loc_1001F93F:				; CODE XREF: SSL_OptionSetDefault+230j
		or	eax, 0FFFFFFFFh
		pop	esi

locret_1001F943:			; CODE XREF: SSL_OptionSetDefault+7j
		retn
; ---------------------------------------------------------------------------

loc_1001F944:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	eax, dword_10037114 ; jumptable	1001F919 case 0
		mov	ecx, eax
		xor	ecx, [esp+4+arg_4]
		pop	esi
		and	ecx, 1
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001F95D:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 2
		mov	eax, dword_10037114
		lea	ecx, ds:0[edx*4]
		xor	ecx, eax
		and	ecx, 4
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001F97D:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 9
		mov	eax, dword_10037114
		lea	ecx, ds:0[edx*8]
		xor	ecx, eax
		and	ecx, 18h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001F99D:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, dword_10037114 ; jumptable	1001F919 case 4
		mov	eax, [esp+4+arg_4]
		test	cl, 40h
		jz	short loc_1001F9B0
		test	eax, eax
		jnz	short loc_1001F932 ; jumptable 1001F919	default	case

loc_1001F9B0:				; CODE XREF: SSL_OptionSetDefault+AAj
		shl	eax, 5
		xor	eax, ecx
		and	eax, 20h
		xor	ecx, eax
		mov	dword_10037114,	ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001F9C4:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, dword_10037114 ; jumptable	1001F919 case 5
		mov	eax, [esp+4+arg_4]
		test	cl, 20h
		jz	short loc_1001F9DB
		test	eax, eax
		jnz	loc_1001F932	; jumptable 1001F919 default case

loc_1001F9DB:				; CODE XREF: SSL_OptionSetDefault+D1j
		shl	eax, 6
		xor	eax, ecx
		and	eax, 40h
		xor	ecx, eax
		mov	dword_10037114,	ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001F9EF:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 12
		mov	eax, offset word_10037118
		call	sub_1001C5C0
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA01:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 7
		mov	ecx, offset word_10037118
		call	sub_1001C610
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA13:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 6
		mov	esi, dword_10037114
		mov	ecx, edx
		and	ecx, 1
		mov	eax, ecx
		shl	eax, 7
		and	esi, 0FFFFFF7Fh
		or	eax, esi
		mov	dword_10037114,	eax
		test	edx, edx
		jz	loc_1001FD24
		shl	ecx, 0Ch
		and	eax, 0FFFFEFFFh
		or	ecx, eax
		mov	dword_10037114,	ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA50:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 8
		mov	eax, dword_10037114
		shl	edx, 0Ah
		xor	edx, eax
		and	edx, 400h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA6F:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	eax, [esp+4+arg_4] ; jumptable 1001F919	case 10
		mov	ecx, dword_10037114
		test	eax, eax
		jz	short loc_1001FA89
		test	ecx, 10000h
		jnz	loc_1001F932	; jumptable 1001F919 default case

loc_1001FA89:				; CODE XREF: SSL_OptionSetDefault+17Bj
		shl	eax, 0Bh
		xor	eax, ecx
		and	eax, 800h
		xor	ecx, eax
		mov	dword_10037114,	ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FA9F:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	eax, [esp+4+arg_4] ; jumptable 1001F919	case 11
		mov	ecx, dword_10037114
		mov	edx, eax
		shl	edx, 0Ch
		xor	edx, ecx
		and	edx, 1000h
		xor	ecx, edx
		mov	dword_10037114,	ecx
		test	eax, eax
		jnz	loc_1001FD24
		and	dword_10037114,	0FFFFFF7Fh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FAD2:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 13
		mov	eax, dword_10037114
		shl	ecx, 0Dh
		xor	ecx, eax
		and	ecx, 2000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FAF1:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	eax, [esp+4+arg_4] ; jumptable 1001F919	case 14
		mov	ecx, dword_10037114
		mov	edx, eax
		shl	edx, 0Eh
		xor	edx, ecx
		and	edx, 4000h
		xor	ecx, edx
		mov	dword_10037114,	ecx
		test	eax, eax
		jz	loc_1001FD24
		call	sub_10020660
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FB21:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	esi, [esp+4+arg_4] ; jumptable 1001F919	case 15
		test	esi, esi
		jz	short loc_1001FB51
		call	sub_1001C5A0
		test	eax, eax
		jnz	loc_1001F93F
		mov	eax, dword_10037114
		shl	esi, 0Fh
		xor	esi, eax
		and	esi, 8000h
		xor	eax, esi
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FB51:				; CODE XREF: SSL_OptionSetDefault+227j
		and	dword_10037114,	0FFFF7FFFh
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FB5F:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	eax, [esp+4+arg_4] ; jumptable 1001F919	case 16
		mov	ecx, dword_10037114
		test	eax, eax
		jz	short loc_1001FB84
		test	ecx, 800h
		jnz	loc_1001F932	; jumptable 1001F919 default case
		cmp	dword_10037EA0,	0
		jz	short loc_1001FB84
		xor	eax, eax

loc_1001FB84:				; CODE XREF: SSL_OptionSetDefault+26Bj
					; SSL_OptionSetDefault+280j
		mov	edx, eax
		shl	edx, 10h
		xor	edx, ecx
		and	edx, 10000h
		xor	ecx, edx
		mov	dword_10037114,	ecx
		test	eax, eax
		jz	loc_1001FD24
		mov	eax, ds:dword_1002EB74
		mov	ecx, ds:dword_1002EB78
		mov	dx, ds:word_1002EB7C
		mov	dword_1003712E,	eax
		mov	dword_10037E94,	1
		mov	dword_10037132,	ecx
		mov	word_10037136, dx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FBD3:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 17
		mov	eax, dword_10037114
		shl	ecx, 11h
		xor	ecx, eax
		and	ecx, 20000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FBF2:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 18
		mov	eax, dword_10037114
		shl	edx, 12h
		xor	edx, eax
		and	edx, 40000h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FC11:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 19
		mov	eax, dword_10037114
		shl	ecx, 13h
		xor	ecx, eax
		and	ecx, 180000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FC30:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 20
		mov	eax, dword_10037114
		shl	edx, 15h
		xor	edx, eax
		and	edx, 200000h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FC4F:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 21
		mov	eax, dword_10037114
		shl	ecx, 16h
		xor	ecx, eax
		and	ecx, 400000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FC6E:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 22
		mov	eax, dword_10037114
		shl	edx, 17h
		xor	edx, eax
		and	edx, 800000h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FC8D:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 23
		mov	eax, dword_10037114
		shl	ecx, 18h
		xor	ecx, eax
		and	ecx, 1000000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FCAC:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 24
		mov	eax, dword_10037114
		shl	edx, 19h
		xor	edx, eax
		and	edx, 2000000h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FCCB:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 25
		mov	eax, dword_10037114
		shl	ecx, 1Ah
		xor	ecx, eax
		and	ecx, 4000000h
		xor	eax, ecx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FCEA:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	edx, [esp+4+arg_4] ; jumptable 1001F919	case 26
		mov	eax, dword_10037114
		shl	edx, 1Bh
		xor	edx, eax
		and	edx, 8000000h
		xor	eax, edx
		mov	dword_10037114,	eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001FD09:				; CODE XREF: SSL_OptionSetDefault+19j
					; DATA XREF: .text:off_1001FD28o
		mov	ecx, [esp+4+arg_4] ; jumptable 1001F919	case 27
		mov	eax, dword_10037114
		shl	ecx, 1Ch
		xor	ecx, eax
		and	ecx, 10000000h
		xor	eax, ecx
		mov	dword_10037114,	eax

loc_1001FD24:				; CODE XREF: SSL_OptionSetDefault+2Cj
					; SSL_OptionSetDefault+136j ...
		xor	eax, eax
		pop	esi
		retn
SSL_OptionSetDefault endp

; ---------------------------------------------------------------------------
off_1001FD28	dd offset loc_1001F944	; DATA XREF: SSL_OptionSetDefault+19r
		dd offset loc_1001F920	; jump table for switch	statement
		dd offset loc_1001F95D
		dd offset loc_1001F932
		dd offset loc_1001F99D
		dd offset loc_1001F9C4
		dd offset loc_1001FA13
		dd offset loc_1001FA01
		dd offset loc_1001FA50
		dd offset loc_1001F97D
		dd offset loc_1001FA6F
		dd offset loc_1001FA9F
		dd offset loc_1001F9EF
		dd offset loc_1001FAD2
		dd offset loc_1001FAF1
		dd offset loc_1001FB21
		dd offset loc_1001FB5F
		dd offset loc_1001FBD3
		dd offset loc_1001FBF2
		dd offset loc_1001FC11
		dd offset loc_1001FC30
		dd offset loc_1001FC4F
		dd offset loc_1001FC6E
		dd offset loc_1001FC8D
		dd offset loc_1001FCAC
		dd offset loc_1001FCCB
		dd offset loc_1001FCEA
		dd offset loc_1001FD09
		align 10h
; Exported entry   8. NSS_SetDomesticPolicy

; =============== S U B	R O U T	I N E =======================================


		public NSS_SetDomesticPolicy
NSS_SetDomesticPolicy proc near		; CODE XREF: NSS_SetFrancePolicyj
					; DATA XREF: .rdata:off_10035848o
		xor	eax, eax
		push	edi
		mov	edi, offset SSL_ImplementedCiphers
		cmp	ds:SSL_ImplementedCiphers, ax
		jz	short loc_1001FE26
		push	esi

loc_1001FDB2:				; CODE XREF: NSS_SetDomesticPolicy+83j
		movzx	esi, word ptr [edi]
		mov	eax, esi
		and	eax, 0FFFEh
		cmp	eax, 0FFE0h
		jnz	short loc_1001FDDB
		cmp	esi, eax
		jnz	short loc_1001FDCE
		mov	esi, 0FEFFh
		jmp	short loc_1001FDDB
; ---------------------------------------------------------------------------

loc_1001FDCE:				; CODE XREF: NSS_SetDomesticPolicy+25j
		cmp	esi, 0FFE1h
		jnz	short loc_1001FDDB
		mov	esi, 0FEFEh

loc_1001FDDB:				; CODE XREF: NSS_SetDomesticPolicy+21j
					; NSS_SetDomesticPolicy+2Cj ...
		lea	ecx, [esi-1Ch]
		cmp	ecx, 2
		ja	short loc_1001FDE7
		xor	eax, eax
		jmp	short loc_1001FE1C
; ---------------------------------------------------------------------------

loc_1001FDE7:				; CODE XREF: NSS_SetDomesticPolicy+41j
		call	sub_10014850
		test	eax, eax
		jnz	short loc_1001FE25
		lea	edx, [esi-1Ch]
		cmp	edx, 2
		jbe	short loc_1001FE18
		mov	eax, esi
		and	eax, 0FFF0h
		push	1
		push	esi
		cmp	eax, 0FF00h
		jnz	short loc_1001FE10
		call	sub_10010D30
		jmp	short loc_1001FE15
; ---------------------------------------------------------------------------

loc_1001FE10:				; CODE XREF: NSS_SetDomesticPolicy+67j
		call	sub_100075E0

loc_1001FE15:				; CODE XREF: NSS_SetDomesticPolicy+6Ej
		add	esp, 8

loc_1001FE18:				; CODE XREF: NSS_SetDomesticPolicy+56j
		test	eax, eax
		jnz	short loc_1001FE25

loc_1001FE1C:				; CODE XREF: NSS_SetDomesticPolicy+45j
		add	edi, 2
		cmp	word ptr [edi],	0
		jnz	short loc_1001FDB2

loc_1001FE25:				; CODE XREF: NSS_SetDomesticPolicy+4Ej
					; NSS_SetDomesticPolicy+7Aj
		pop	esi

loc_1001FE26:				; CODE XREF: NSS_SetDomesticPolicy+Fj
		pop	edi
		retn
NSS_SetDomesticPolicy endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   9. NSS_SetExportPolicy
; Exported entry  10. NSS_SetFrancePolicy

; =============== S U B	R O U T	I N E =======================================


		public NSS_SetFrancePolicy
NSS_SetFrancePolicy proc near		; DATA XREF: .rdata:off_10035848o
		jmp	NSS_SetDomesticPolicy ;	NSS_SetExportPolicy
NSS_SetFrancePolicy endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FE40	proc near		; CODE XREF: SSL_ImportFD+Cp
					; DTLS_ImportFD+Fp

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+2Ch+arg_0]
		mov	ebx, ecx
		call	sub_10014850
		test	eax, eax
		jz	short loc_1001FE72
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001FE72:				; CODE XREF: sub_1001FE40+1Dj
		push	edi
		test	esi, esi
		jnz	short loc_1001FE8B
		movzx	eax, word ptr dword_10037114+2
		not	eax
		and	eax, 1
		push	eax
		call	sub_1001EB40
		jmp	short loc_1001FED4
; ---------------------------------------------------------------------------

loc_1001FE8B:				; CODE XREF: sub_1001FE40+35j
		mov	ecx, dword_10037948
		push	ecx
		push	esi
		call	ds:PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_1001FEC1
		push	0FFFFE891h
		call	PORT_SetError_Util

loc_1001FEAA:				; CODE XREF: sub_1001FE40+B3j
		add	esp, 4

loc_1001FEAD:				; CODE XREF: sub_1001FE40+8Cj
					; sub_1001FE40+9Bj
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1001FEC1:				; CODE XREF: sub_1001FE40+5Ej
		mov	ecx, [eax+4]
		mov	[ecx], eax
		cmp	[ecx+2F38h], ebx
		jnz	short loc_1001FEAD
		push	ecx
		call	sub_1001ED60

loc_1001FED4:				; CODE XREF: sub_1001FE40+49j
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1001FEAD
		push	0FFFFFFFEh
		mov	ebx, ebp
		call	sub_1001E870
		add	esp, 4
		test	eax, eax
		jz	short loc_1001FEF5
		push	edi
		call	sub_1001C3A0
		jmp	short loc_1001FEAA
; ---------------------------------------------------------------------------

loc_1001FEF5:				; CODE XREF: sub_1001FE40+ABj
		lea	edx, [esp+30h+var_24]
		push	edx
		push	edi
		call	sub_10014710
		mov	ecx, [esp+38h+var_4]
		add	esp, 8
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	[edi+38h], eax
		pop	edi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001FE40	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  47. SSL_ImportFD

; =============== S U B	R O U T	I N E =======================================


		public SSL_ImportFD
SSL_ImportFD	proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	eax
		xor	ecx, ecx
		call	sub_1001FE40
		add	esp, 4
		pop	esi
		retn
SSL_ImportFD	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. DTLS_ImportFD

; =============== S U B	R O U T	I N E =======================================


		public DTLS_ImportFD
DTLS_ImportFD	proc near		; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	eax
		mov	ecx, 1
		call	sub_1001FE40
		add	esp, 4
		pop	esi
		retn
DTLS_ImportFD	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001FF60	proc near		; DATA XREF: .rdata:off_1002EA4Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		push	ebx
		xor	ebx, ebx
		cmp	dword ptr [ecx], 4
		jnz	loc_100200D4
		mov	edx, [eax+14h]
		cmp	edx, dword_10037948
		jnz	loc_100200D4
		push	esi
		mov	esi, [eax+4]
		mov	[esi], eax
		mov	eax, [esi+244h]
		push	edi
		mov	edi, ds:PR_Lock
		test	eax, eax
		jz	short loc_1001FF9E
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001FF9E:				; CODE XREF: sub_1001FF60+36j
		mov	eax, [esi+248h]
		test	eax, eax
		jz	short loc_1001FFAE
		push	eax
		call	edi ; PR_Lock
		add	esp, 4

loc_1001FFAE:				; CODE XREF: sub_1001FF60+46j
		test	byte ptr [esi+16h], 1
		mov	edi, ds:PR_EnterMonitor
		jnz	short loc_1001FFD8
		mov	eax, [esi+254h]
		push	eax
		call	edi ; PR_EnterMonitor
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_1001FFD8
		mov	ecx, [esi+258h]
		push	ecx
		call	edi ; PR_EnterMonitor
		add	esp, 4

loc_1001FFD8:				; CODE XREF: sub_1001FF60+58j
					; sub_1001FF60+6Aj
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esi]
		push	ebp
		mov	[esi+240h], ecx
		mov	eax, [edx+8]
		mov	edx, [eax]
		mov	edx, [edx+34h]
		push	ecx
		mov	ecx, [esp+14h+arg_4]
		push	ecx
		push	eax
		call	edx
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_1002000A
		push	esi
		call	sub_1001ED60
		add	esp, 4
		mov	ebx, eax

loc_1002000A:				; CODE XREF: sub_1001FF60+9Dj
		test	byte ptr [esi+16h], 1
		mov	edi, ds:PR_ExitMonitor
		jnz	short loc_10020034
		mov	eax, [esi+258h]
		push	eax
		call	edi ; PR_ExitMonitor
		add	esp, 4
		test	byte ptr [esi+16h], 1
		jnz	short loc_10020034
		mov	ecx, [esi+254h]
		push	ecx
		call	edi ; PR_ExitMonitor
		add	esp, 4

loc_10020034:				; CODE XREF: sub_1001FF60+B4j
					; sub_1001FF60+C6j
		mov	eax, [esi+248h]
		mov	edi, ds:PR_Unlock
		test	eax, eax
		jz	short loc_1002004A
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_1002004A:				; CODE XREF: sub_1001FF60+E2j
		mov	eax, [esi+244h]
		test	eax, eax
		jz	short loc_1002005A
		push	eax
		call	edi ; PR_Unlock
		add	esp, 4

loc_1002005A:				; CODE XREF: sub_1001FF60+F2j
		test	ebx, ebx
		jz	short loc_100200BF
		cmp	dword_1003794C,	0
		jnz	short loc_1002007E
		push	offset loc_1001E840
		push	offset dword_100378A0
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short loc_100200B6

loc_1002007E:				; CODE XREF: sub_1001FF60+105j
		mov	edx, dword_10037948
		push	offset dword_100378B8
		push	edx
		call	ds:PR_CreateIOLayerStub
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_100200B6
		push	edi
		push	0FFFFFFFEh
		push	ebp
		mov	[edi+4], ebx
		call	ds:PR_PushIOLayer
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100200E5
		mov	eax, [edi+10h]
		push	edi
		call	eax
		add	esp, 4

loc_100200B6:				; CODE XREF: sub_1001FF60+11Cj
					; sub_1001FF60+137j
		push	ebx
		call	sub_1001C3A0
		add	esp, 4

loc_100200BF:				; CODE XREF: sub_1001FF60+FCj
		test	ebp, ebp
		jz	short loc_100200CD
		push	ebp
		call	ds:PR_Close
		add	esp, 4

loc_100200CD:				; CODE XREF: sub_1001FF60+161j
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100200D4:				; CODE XREF: sub_1001FF60+Cj
					; sub_1001FF60+1Bj
		push	0FFFFE891h
		call	PORT_SetError_Util
		add	esp, 4
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100200E5:				; CODE XREF: sub_1001FF60+14Bj
		mov	eax, [ebx+14h]
		mov	[ebx], ebp
		test	al, 1
		jz	short loc_10020128
		test	al, 20h
		jz	short loc_10020114
		mov	eax, ebp
		pop	ebp
		mov	dword ptr [ebx+1DCh], offset sub_100137A0
		pop	edi
		mov	dword ptr [esi+270h], 1
		pop	esi
		mov	dword ptr [ebx+38h], 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10020114:				; CODE XREF: sub_1001FF60+190j
		mov	dword ptr [ebx+1DCh], offset sub_10014380
		mov	dword ptr [esi+270h], 2

loc_10020128:				; CODE XREF: sub_1001FF60+18Cj
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		mov	dword ptr [ebx+38h], 1
		pop	ebx
		retn
sub_1001FF60	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   7. NSS_GetClientAuthData

; =============== S U B	R O U T	I N E =======================================


		public NSS_GetClientAuthData
NSS_GetClientAuthData proc near		; DATA XREF: .rdata:off_10035848o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		mov	eax, [esp+4+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	esi, esi
		push	eax
		mov	[esp+18h+var_4], esi
		or	ebx, 0FFFFFFFFh
		call	SSL_RevealPinArg
		mov	edi, eax
		mov	eax, [esp+18h+arg_0]
		add	esp, 4
		push	edi
		test	eax, eax
		jz	short loc_100201B6
		push	esi
		push	esi
		push	eax
		call	CERT_GetDefaultCertDB
		push	eax
		call	CERT_FindUserCertByUsage
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	loc_10020278
		push	edi
		push	esi
		call	PK11_FindKeyByAnyCert
		add	esp, 8
		test	eax, eax
		jz	short loc_100201A5
		mov	edx, [esp+14h+arg_C]
		mov	ecx, [esp+14h+arg_10]
		pop	edi
		mov	[edx], esi
		pop	esi
		xor	ebx, ebx
		mov	[ecx], eax
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100201A5:				; CODE XREF: NSS_GetClientAuthData+4Dj
		push	esi
		call	CERT_DestroyCertificate
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100201B6:				; CODE XREF: NSS_GetClientAuthData+24j
		push	2
		call	CERT_GetDefaultCertDB
		push	eax
		call	CERT_GetCertNicknames
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	loc_10020278
		mov	[esp+14h+arg_0], esi
		cmp	[ebp+8], esi
		jle	loc_1002025B
		lea	ecx, [ecx+0]

loc_100201E0:				; CODE XREF: NSS_GetClientAuthData+119j
		mov	ecx, [ebp+0Ch]
		mov	edx, [esp+14h+arg_0]
		mov	eax, [ecx+edx*4]
		push	edi
		push	0
		push	0
		push	eax
		call	CERT_GetDefaultCertDB
		push	eax
		call	CERT_FindUserCertByUsage
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1002024D
		push	1
		call	ds:PR_Now
		push	edx
		push	eax
		push	esi
		call	CERT_CheckCertValidTimes
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10020244
		mov	ecx, [esp+14h+arg_8]
		push	ecx
		push	esi
		call	NSS_CmpCertChainWCANames
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_10020241
		push	edi
		push	esi
		call	PK11_FindKeyByAnyCert
		add	esp, 8
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jnz	short loc_1002025B

loc_10020241:				; CODE XREF: NSS_GetClientAuthData+EDj
		or	ebx, 0FFFFFFFFh

loc_10020244:				; CODE XREF: NSS_GetClientAuthData+D9j
		push	esi
		call	CERT_DestroyCertificate
		add	esp, 4

loc_1002024D:				; CODE XREF: NSS_GetClientAuthData+C2j
		mov	eax, [esp+14h+arg_0]
		inc	eax
		mov	[esp+14h+arg_0], eax
		cmp	eax, [ebp+8]
		jl	short loc_100201E0

loc_1002025B:				; CODE XREF: NSS_GetClientAuthData+97j
					; NSS_GetClientAuthData+FFj
		push	ebp
		call	CERT_FreeNicknames
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10020278
		mov	edx, [esp+14h+arg_C]
		mov	eax, [esp+14h+var_4]
		mov	ecx, [esp+14h+arg_10]
		mov	[edx], esi
		mov	[ecx], eax

loc_10020278:				; CODE XREF: NSS_GetClientAuthData+3Bj
					; NSS_GetClientAuthData+8Aj ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
NSS_GetClientAuthData endp

; Exported entry   5. NSS_CmpCertChainWCANames

; =============== S U B	R O U T	I N E =======================================


		public NSS_CmpCertChainWCANames
NSS_CmpCertChainWCANames proc near	; CODE XREF: NSS_GetClientAuthData+E1p
					; DATA XREF: .rdata:off_10035848o

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		sub	esp, 20h
		push	ebx
		xor	ebx, ebx
		push	esi
		cmp	ecx, ebx
		jz	loc_100203DB
		mov	esi, [esp+28h+arg_4]
		cmp	esi, ebx
		jz	loc_100203DB
		cmp	[esi+4], ebx
		jz	loc_100203DB
		mov	eax, [esi+8]
		cmp	eax, ebx
		jz	loc_100203DB
		cmp	[eax+4], ebx
		jz	loc_100203DB
		push	ebp
		push	edi
		push	ecx
		mov	[esp+34h+arg_0], ebx
		call	CERT_DupCertificate
		mov	edi, eax
		add	esp, 4
		cmp	edi, ebx
		jz	loc_100203B9

loc_100202D5:				; CODE XREF: NSS_CmpCertChainWCANames+12Bj
		mov	eax, [edi+48h]
		mov	[esp+30h+var_18], eax
		mov	ecx, [edi+4Ch]
		mov	[esp+30h+var_14], ecx
		mov	edx, [edi+50h]
		lea	eax, [esp+30h+var_1C]
		push	eax
		lea	ecx, [esp+34h+var_20]
		mov	[esp+34h+var_10], edx
		push	ecx
		lea	edx, [esp+38h+var_18]
		push	edx
		call	DER_Lengths_Util
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1002031F
		mov	eax, [esp+30h+var_20]
		mov	ecx, [esp+30h+var_14]
		mov	edx, [esp+30h+var_10]
		add	ecx, eax
		sub	edx, eax
		mov	[esp+30h+var_8], ecx
		mov	[esp+30h+var_4], edx
		jmp	short loc_10020327
; ---------------------------------------------------------------------------

loc_1002031F:				; CODE XREF: NSS_CmpCertChainWCANames+83j
		mov	[esp+30h+var_8], ebx
		mov	[esp+30h+var_4], ebx

loc_10020327:				; CODE XREF: NSS_CmpCertChainWCANames+9Dj
		cmp	[esi+4], ebx
		jle	short loc_1002036C
		xor	ebp, ebp
		mov	edi, edi

loc_10020330:				; CODE XREF: NSS_CmpCertChainWCANames+EAj
		mov	esi, [esi+8]
		add	esi, ebp
		lea	eax, [esp+30h+var_18]
		push	esi
		push	eax
		call	SECITEM_CompareItem_Util
		add	esp, 8
		test	eax, eax
		jz	loc_100203C6
		lea	ecx, [esp+30h+var_C]
		push	esi
		push	ecx
		call	SECITEM_CompareItem_Util
		add	esp, 8
		test	eax, eax
		jz	short loc_100203C6
		mov	edx, [esp+30h+arg_4]
		inc	ebx
		add	ebp, 0Ch
		mov	esi, edx
		cmp	ebx, [edx+4]
		jl	short loc_10020330

loc_1002036C:				; CODE XREF: NSS_CmpCertChainWCANames+AAj
		cmp	[esp+30h+arg_0], 14h
		jg	short loc_100203B0
		lea	eax, [edi+54h]
		push	eax
		lea	ebp, [edi+48h]
		push	ebp
		call	SECITEM_CompareItem_Util
		add	esp, 8
		test	eax, eax
		jz	short loc_100203B0
		mov	ecx, [edi+11Ch]
		push	ebp
		push	ecx
		mov	ebx, edi
		call	CERT_FindCertByName
		push	ebx
		mov	edi, eax
		call	CERT_DestroyCertificate
		inc	[esp+3Ch+arg_0]
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_100203B9
		xor	ebx, ebx
		jmp	loc_100202D5
; ---------------------------------------------------------------------------

loc_100203B0:				; CODE XREF: NSS_CmpCertChainWCANames+F1j
					; NSS_CmpCertChainWCANames+105j
		push	edi
		call	CERT_DestroyCertificate
		add	esp, 4

loc_100203B9:				; CODE XREF: NSS_CmpCertChainWCANames+4Fj
					; NSS_CmpCertChainWCANames+127j
		pop	edi
		or	esi, 0FFFFFFFFh
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100203C6:				; CODE XREF: NSS_CmpCertChainWCANames+C5j
					; NSS_CmpCertChainWCANames+DBj
		push	edi
		xor	esi, esi
		call	CERT_DestroyCertificate
		add	esp, 4
		pop	edi
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100203DB:				; CODE XREF: NSS_CmpCertChainWCANames+Dj
					; NSS_CmpCertChainWCANames+19j	...
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
NSS_CmpCertChainWCANames endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  33. SSL_GetChannelInfo

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_GetChannelInfo(int, void *, int)
		public SSL_GetChannelInfo
SSL_GetChannelInfo proc	near		; DATA XREF: .rdata:off_10035848o

Dst		= dword	ptr -4Ch
var_48		= word ptr -48h
var_46		= word ptr -46h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_0]
		push	ebp
		mov	ebp, [esp+50h+arg_4]
		push	edi
		test	ebp, ebp
		jz	loc_100205CF
		mov	edi, [esp+54h+arg_8]
		cmp	edi, 4
		jb	loc_100205CF
		push	esi
		push	eax
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10020442
		pop	esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10020442:				; CODE XREF: SSL_GetChannelInfo+3Bj
		push	48h		; Size
		lea	eax, [esp+5Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		mov	[esp+58h+Dst], 48h
		cmp	edi, 48h
		ja	short loc_10020464
		mov	[esp+58h+Dst], edi

loc_10020464:				; CODE XREF: SSL_GetChannelInfo+6Ej
		mov	ecx, [esi+14h]
		test	cl, 1
		jz	loc_100205A8
		cmp	dword ptr [esi+28h], 0
		jz	loc_100205A8
		mov	edx, [esi+78h]
		movzx	eax, word ptr [esi+44h]
		mov	edi, [esi+0F4h]
		mov	[esp+58h+var_44], edx
		mov	edx, [esi+80h]
		mov	[esp+58h+var_40], edx
		mov	edx, 300h
		mov	[esp+58h+var_48], ax
		cmp	ax, dx
		jnb	short loc_100204C4
		mov	eax, 0FF00h
		or	ax, [esi+5Ch]
		mov	[esp+58h+var_8], 0
		mov	[esp+58h+var_46], ax
		mov	[esp+58h+var_C], offset	aNA ; "N/A"
		jmp	short loc_1002053A
; ---------------------------------------------------------------------------

loc_100204C4:				; CODE XREF: SSL_GetChannelInfo+B2j
		cmp	dword ptr [esi+478h], 0
		jz	short loc_1002053A
		test	ecx, 10000h
		jnz	short loc_100204E4
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_100204E4:				; CODE XREF: SSL_GetChannelInfo+E3j
		test	byte ptr [esi+16h], 1
		mov	eax, [esi+450h]
		mov	dx, [esi+80Ch]
		push	ebx
		mov	ebx, [eax+8]
		mov	[esp+5Ch+var_46], dx
		mov	[esp+5Ch+var_8], ebx
		jnz	short loc_10020513
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10020513:				; CODE XREF: SSL_GetChannelInfo+112j
		mov	eax, ebx
		sub	eax, 0
		pop	ebx
		jz	short loc_10020532
		dec	eax
		jz	short loc_10020528
		mov	[esp+58h+var_C], offset	a??? ; "???"
		jmp	short loc_1002053A
; ---------------------------------------------------------------------------

loc_10020528:				; CODE XREF: SSL_GetChannelInfo+12Cj
		mov	[esp+58h+var_C], offset	aDeflate ; "DEFLATE"
		jmp	short loc_1002053A
; ---------------------------------------------------------------------------

loc_10020532:				; CODE XREF: SSL_GetChannelInfo+129j
		mov	[esp+58h+var_C], offset	aNull ;	"NULL"

loc_1002053A:				; CODE XREF: SSL_GetChannelInfo+D2j
					; SSL_GetChannelInfo+DBj ...
		test	edi, edi
		jz	short loc_100205A8
		mov	edx, [edi+3Ch]
		mov	eax, [edi+0Ch]
		mov	ecx, [edi+40h]
		mov	[esp+58h+var_3C], edx
		mov	edx, 300h
		mov	[esp+58h+var_38], eax
		mov	[esp+58h+var_34], ecx
		cmp	[esi+44h], dx
		jnb	short loc_10020584
		mov	eax, [edi+54h]
		mov	ecx, [edi+58h]
		mov	edx, [edi+5Ch]
		mov	[esp+58h+var_2C], eax
		mov	eax, [edi+60h]
		mov	[esp+58h+var_30], 10h
		mov	[esp+58h+var_28], ecx
		mov	[esp+58h+var_24], edx
		mov	[esp+58h+var_20], eax
		jmp	short loc_100205A8
; ---------------------------------------------------------------------------

loc_10020584:				; CODE XREF: SSL_GetChannelInfo+16Cj
		movzx	eax, byte ptr [edi+54h]
		cmp	eax, 20h
		jb	short loc_10020592
		mov	eax, 20h

loc_10020592:				; CODE XREF: SSL_GetChannelInfo+19Bj
		push	eax		; Size
		add	edi, 55h
		lea	ecx, [esp+5Ch+var_2C]
		push	edi		; Src
		push	ecx		; Dst
		mov	[esp+64h+var_30], eax
		call	memcpy
		add	esp, 0Ch

loc_100205A8:				; CODE XREF: SSL_GetChannelInfo+7Aj
					; SSL_GetChannelInfo+84j ...
		mov	edx, [esp+58h+Dst]
		push	edx		; Size
		lea	eax, [esp+5Ch+Dst]
		push	eax		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_100205CF:				; CODE XREF: SSL_GetChannelInfo+1Aj
					; SSL_GetChannelInfo+27j
		push	0FFFFE005h
		call	PORT_SetError_Util
		mov	ecx, [esp+58h+var_4]
		add	esp, 4
		pop	edi
		pop	ebp
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
SSL_GetChannelInfo endp

; Exported entry  34. SSL_GetCipherSuiteInfo

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_GetCipherSuiteInfo(__int16, void *Dst, size_t	Size)
		public SSL_GetCipherSuiteInfo
SSL_GetCipherSuiteInfo proc near	; CODE XREF: SSL_CanBypass+D7p
					; DATA XREF: .rdata:off_10035848o

arg_0		= word ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+Size]
		push	edi
		cmp	esi, 38h
		jb	short loc_10020600
		mov	esi, 38h

loc_10020600:				; CODE XREF: SSL_GetCipherSuiteInfo+9j
		mov	edi, [esp+8+Dst]
		test	edi, edi
		jz	short loc_1002062A
		cmp	esi, 2
		jb	short loc_1002062A
		mov	dx, [esp+8+arg_0]
		xor	ecx, ecx
		xor	eax, eax

loc_10020616:				; CODE XREF: SSL_GetCipherSuiteInfo+38j
		cmp	ds:word_1002F542[eax], dx
		jz	short loc_1002063D
		add	eax, 38h
		inc	ecx
		cmp	eax, 0EA8h
		jb	short loc_10020616

loc_1002062A:				; CODE XREF: SSL_GetCipherSuiteInfo+16j
					; SSL_GetCipherSuiteInfo+1Bj
		push	0FFFFE005h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002063D:				; CODE XREF: SSL_GetCipherSuiteInfo+2Dj
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		push	esi		; Size
		lea	ecx, byte_1002F540[eax*8]
		push	ecx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[edi], si
		pop	edi
		xor	eax, eax
		pop	esi
		retn
SSL_GetCipherSuiteInfo endp


; =============== S U B	R O U T	I N E =======================================


sub_10020660	proc near		; CODE XREF: SSL_OptionSetDefault+218p
		push	esi
		push	edi
		mov	esi, offset word_1002F542
		mov	edi, 43h
		lea	esp, [esp+0]

loc_10020670:				; CODE XREF: sub_10020660+28j
		test	byte ptr [esi+32h], 2
		jz	short loc_10020684
		movzx	eax, word ptr [esi]
		push	0
		push	eax
		call	SSL_CipherPrefSetDefault
		add	esp, 8

loc_10020684:				; CODE XREF: sub_10020660+14j
		add	esi, 38h
		dec	edi
		jnz	short loc_10020670
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10020660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020690	proc near		; CODE XREF: SSL_OptionSet+2DAp

arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		push	edi
		mov	esi, offset word_1002F542
		mov	edi, 43h

loc_100206A1:				; CODE XREF: sub_10020690+2Aj
		test	byte ptr [esi+32h], 2
		jz	short loc_100206B6
		movzx	eax, word ptr [esi]
		push	0
		push	eax
		push	ebp
		call	SSL_CipherPrefSet
		add	esp, 0Ch

loc_100206B6:				; CODE XREF: sub_10020690+15j
		add	esi, 38h
		dec	edi
		jnz	short loc_100206A1
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
sub_10020690	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100206D0	proc near		; CODE XREF: SSL_CipherPrefSetDefault+30p
					; SSL_CipherPrefSet+56p

arg_0		= word ptr  4

		mov	dx, [esp+arg_0]
		xor	ecx, ecx
		xor	eax, eax
		lea	esp, [esp+0]

loc_100206E0:				; CODE XREF: sub_100206D0+22j
		cmp	ds:word_1002F542[eax], dx
		jz	short loc_100206F7
		add	eax, 38h
		inc	ecx
		cmp	eax, 0EA8h
		jb	short loc_100206E0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100206F7:				; CODE XREF: sub_100206D0+17j
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		mov	eax, ds:dword_1002F574[eax*8]
		shr	eax, 1
		and	eax, 1
		retn
sub_100206D0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  38. SSL_GetNegotiatedHostInfo

; =============== S U B	R O U T	I N E =======================================


		public SSL_GetNegotiatedHostInfo
SSL_GetNegotiatedHostInfo proc near	; DATA XREF: .rdata:off_10035848o

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	edi
		push	ebx
		xor	edi, edi
		call	sub_1001C160
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	loc_100207BF
		cmp	[esi+4Ch], edi
		jz	short loc_10020797
		mov	eax, 300h
		cmp	[esi+44h], ax
		jbe	loc_100207DC
		cmp	[esi+478h], edi
		jz	loc_100207DC
		mov	bl, 1
		test	[esi+16h], bl
		jnz	short loc_10020762
		mov	ecx, [esi+25Ch]
		push	ecx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_10020762:				; CODE XREF: SSL_GetNegotiatedHostInfo+41j
		mov	eax, [esi+450h]
		add	eax, 1204h
		cmp	[eax+4], edi
		jz	short loc_1002077D
		push	eax
		call	SECITEM_DupItem_Util
		add	esp, 4
		mov	edi, eax

loc_1002077D:				; CODE XREF: SSL_GetNegotiatedHostInfo+60j
		test	[esi+16h], bl
		jnz	short loc_100207DC
		mov	edx, [esi+25Ch]
		push	edx
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10020797:				; CODE XREF: SSL_GetNegotiatedHostInfo+1Fj
		push	ebx
		call	SSL_RevealURL
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100207DC
		push	0Ch
		call	PORT_ZAlloc_Util
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100207C5
		push	esi
		call	PORT_Free_Util
		add	esp, 4

loc_100207BF:				; CODE XREF: SSL_GetNegotiatedHostInfo+16j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100207C5:				; CODE XREF: SSL_GetNegotiatedHostInfo+A4j
		mov	eax, esi
		mov	[edi+4], esi
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_100207D0:				; CODE XREF: SSL_GetNegotiatedHostInfo+C5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100207D0
		sub	eax, edx
		mov	[edi+8], eax

loc_100207DC:				; CODE XREF: SSL_GetNegotiatedHostInfo+2Aj
					; SSL_GetNegotiatedHostInfo+36j ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
SSL_GetNegotiatedHostInfo endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  30. SSL_ExportKeyingMaterial

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_ExportKeyingMaterial(int, int, int, int, void	*Src, size_t Size, int,	int)
		public SSL_ExportKeyingMaterial
SSL_ExportKeyingMaterial proc near	; DATA XREF: .rdata:off_10035848o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Src		= dword	ptr  14h
Size		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		mov	eax, [esp+4+arg_0]
		push	ebx
		push	eax
		call	sub_1001C160
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1002081D
		mov	ecx, 301h
		cmp	[ebx+44h], cx
		jnb	short loc_10020823
		push	0FFFFD07Ch
		call	PORT_SetError_Util
		add	esp, 4

loc_1002081D:				; CODE XREF: SSL_ExportKeyingMaterial+13j
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10020823:				; CODE XREF: SSL_ExportKeyingMaterial+1Ej
		cmp	[esp+8+arg_C], 0
		mov	[esp+8+var_4], 40h
		jz	short loc_1002083D
		mov	edx, [esp+8+Size]
		add	edx, 42h
		mov	[esp+8+var_4], edx

loc_1002083D:				; CODE XREF: SSL_ExportKeyingMaterial+40j
		mov	eax, [esp+8+var_4]
		push	ebp
		push	eax
		call	PORT_Alloc_Util
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_10020858
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10020858:				; CODE XREF: SSL_ExportKeyingMaterial+5Fj
		cmp	[esp+0Ch+arg_C], 0
		push	esi
		push	edi
		lea	esi, [ebx+4A0h]
		mov	ecx, 8
		mov	edi, ebp
		rep movsd
		lea	esi, [ebx+480h]
		lea	edi, [ebp+20h]
		mov	ecx, 8
		rep movsd
		jz	short loc_100208A1
		mov	eax, [esp+14h+Size]
		mov	edx, [esp+14h+Src]
		mov	ecx, eax
		shr	ecx, 8
		push	eax		; Size
		mov	[ebp+40h], cl
		mov	[ebp+41h], al
		push	edx		; Src
		lea	eax, [ebp+42h]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch

loc_100208A1:				; CODE XREF: SSL_ExportKeyingMaterial+8Ej
		test	byte ptr [ebx+16h], 1
		jnz	short loc_100208B6
		mov	ecx, [ebx+25Ch]
		push	ecx
		call	NSSRWLock_LockRead_Util
		add	esp, 4

loc_100208B6:				; CODE XREF: SSL_ExportKeyingMaterial+B5j
		mov	eax, [ebx+450h]
		cmp	dword ptr [eax+44h], 0
		jnz	short loc_100208DD
		cmp	dword ptr [eax+1138h], 0
		jnz	short loc_100208DD
		push	0FFFFD056h
		call	PORT_SetError_Util
		add	esp, 4
		or	esi, 0FFFFFFFFh
		jmp	short loc_10020902
; ---------------------------------------------------------------------------

loc_100208DD:				; CODE XREF: SSL_ExportKeyingMaterial+D0j
					; SSL_ExportKeyingMaterial+D9j
		mov	edx, [esp+14h+arg_1C]
		mov	ecx, [esp+14h+arg_18]
		push	edx
		mov	edx, [esp+18h+var_4]
		push	ecx
		mov	ecx, [esp+1Ch+arg_8]
		push	edx
		mov	edx, [esp+20h+arg_4]
		push	ebp
		push	ecx
		push	edx
		push	eax
		call	sub_10006AA0
		add	esp, 1Ch
		mov	esi, eax

loc_10020902:				; CODE XREF: SSL_ExportKeyingMaterial+EBj
		test	byte ptr [ebx+16h], 1
		jnz	short loc_10020917
		mov	eax, [ebx+25Ch]
		push	eax
		call	NSSRWLock_UnlockRead_Util
		add	esp, 4

loc_10020917:				; CODE XREF: SSL_ExportKeyingMaterial+116j
		mov	ecx, [esp+14h+var_4]
		push	ecx
		push	ebp
		call	PORT_ZFree_Util
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
SSL_ExportKeyingMaterial endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020930	proc near		; CODE XREF: SSL_CanBypass+46Dp
					; sub_10021000+1Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		lea	ecx, [eax-1]
		push	esi
		cmp	ecx, 18h
		ja	short loc_10020995
		mov	edx, ds:dword_100303F8[eax*4]
		push	edx
		call	SECOID_FindOIDByTag_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10020995
		mov	eax, [esi+8]
		mov	ecx, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_8]
		add	eax, 2
		push	eax
		push	edi
		push	ecx
		call	SECITEM_AllocItem_Util
		mov	edx, [edi+4]
		mov	byte ptr [edx],	6
		mov	eax, [edi+4]
		mov	cl, [esi+8]
		mov	[eax+1], cl
		mov	edx, [esi+8]
		mov	eax, [esi+4]
		mov	ecx, [edi+4]
		push	edx		; Size
		push	eax		; Src
		add	ecx, 2
		push	ecx		; Dst
		call	memcpy
		add	esp, 18h
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10020995:				; CODE XREF: sub_10020930+Bj
					; sub_10020930+21j
		push	0FFFFE08Dh
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10020930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100209B0	proc near		; CODE XREF: sub_10020EA0+2Ap
					; sub_100214A0+A6p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		mov	eax, [ecx+4]
		mov	[esp+0Ch+var_C], 0
		mov	[esp+0Ch+var_8], 0
		mov	[esp+0Ch+var_4], 0
		cmp	byte ptr [eax],	6
		jnz	short loc_10020A0F
		mov	ecx, [ecx+8]
		lea	edx, [esp+0Ch+var_C]
		sub	ecx, 2
		add	eax, 2
		push	edx
		mov	[esp+10h+var_4], ecx
		mov	[esp+10h+var_8], eax
		call	SECOID_FindOID_Util
		mov	ecx, eax
		add	esp, 4
		test	ecx, ecx
		jz	short loc_10020A0F
		mov	ecx, [ecx+0Ch]
		mov	eax, 1
		lea	ecx, [ecx+0]

loc_10020A00:				; CODE XREF: sub_100209B0+5Dj
		cmp	ds:dword_100303F8[eax*4], ecx
		jz	short loc_10020A11
		inc	eax
		cmp	eax, 1Ah
		jl	short loc_10020A00

loc_10020A0F:				; CODE XREF: sub_100209B0+20j
					; sub_100209B0+43j
		xor	eax, eax

loc_10020A11:				; CODE XREF: sub_100209B0+57j
		add	esp, 0Ch
		retn
sub_100209B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020A20	proc near		; CODE XREF: sub_10021190+1D6p
					; sub_100214A0+105p

var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
Src		= dword	ptr -15Ch
Size		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= byte ptr -148h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 168h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+168h+var_4], eax
		mov	ecx, [esp+168h+arg_8]
		mov	eax, [esp+168h+arg_4]
		mov	edx, [esp+168h+arg_10]
		mov	[esp+168h+Src],	ecx
		mov	ecx, [esp+168h+arg_14]
		mov	[esp+168h+var_160], eax
		mov	eax, [esp+168h+arg_C]
		mov	[esp+168h+var_150], ecx
		mov	ecx, [esp+168h+arg_18]
		mov	[esp+168h+Size], eax
		lea	eax, [ecx+eax+41h]
		mov	[esp+168h+var_154], edx
		mov	edx, [esp+168h+arg_24]
		push	ebx
		mov	[esp+16Ch+var_14C], ecx
		mov	[esp+16Ch+var_168], edx
		mov	[esp+16Ch+var_164], eax
		cmp	eax, 143h
		ja	loc_10020B39
		lea	ebx, [esp+16Ch+var_148]

loc_10020A99:				; CODE XREF: sub_10020A20+126j
		mov	eax, [esp+16Ch+Src]
		push	ebp
		push	esi
		mov	esi, [esp+174h+arg_1C]
		push	edi
		mov	ecx, 8
		mov	edi, ebx
		rep movsd
		mov	esi, [esp+178h+arg_20]
		lea	ebp, [ebx+20h]
		mov	edi, ebp
		mov	ecx, 8
		rep movsd
		mov	esi, [esp+178h+Size]
		push	esi		; Size
		push	eax		; Src
		add	ebp, 20h
		push	ebp		; Dst
		call	memcpy
		mov	eax, [esp+184h+var_14C]
		mov	ecx, [esp+184h+var_150]
		add	ebp, esi
		push	eax		; Size
		mov	[ebp+0], al
		push	ecx		; Src
		inc	ebp
		push	ebp		; Dst
		call	memcpy
		mov	edx, [esp+190h+arg_28]
		mov	eax, [esp+190h+var_168]
		mov	ecx, [esp+190h+var_164]
		push	edx
		mov	edx, [esp+194h+arg_0]
		push	eax
		push	ecx
		push	ebx
		push	edx
		call	sub_10003800
		mov	esi, eax
		lea	eax, [esp+1A4h+var_148]
		add	esp, 2Ch
		cmp	ebx, eax
		jz	short loc_10020B1E
		push	ebx
		call	PORT_Free_Util
		add	esp, 4

loc_10020B1E:				; CODE XREF: sub_10020A20+F3j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+168h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 168h
		retn
; ---------------------------------------------------------------------------

loc_10020B39:				; CODE XREF: sub_10020A20+6Fj
		push	eax
		call	PORT_Alloc_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	loc_10020A99
		mov	ecx, [esp+16Ch+var_4]
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 168h
		retn
sub_10020A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10020B70(int Src, int)
sub_10020B70	proc near		; CODE XREF: sub_1000A3A0+F4p

var_4		= dword	ptr -4
Src		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		mov	ebx, [esp+8+Src]
		mov	eax, [ebx+454h]
		mov	[esp+8+var_4], 0
		movzx	eax, word ptr [eax+58h]
		push	ebp
		or	ebp, 0FFFFFFFFh
		mov	ecx, 300h
		cmp	cx, ax
		push	esi
		sbb	esi, esi
		neg	esi
		mov	edx, 303h
		cmp	ax, dx
		mov	eax, [esp+10h+arg_4]
		push	edi
		sbb	edi, edi
		inc	edi
		cmp	dword ptr [eax+4], 6
		jz	short loc_10020BBE
		push	0FFFFE00Eh
		call	PORT_SetError_Util
		jmp	loc_10020CE2
; ---------------------------------------------------------------------------

loc_10020BBE:				; CODE XREF: sub_10020B70+3Dj
		mov	ecx, [ebx+22Ch]
		push	ecx
		lea	edx, [esp+18h+var_4]
		push	edx
		add	eax, 10h
		push	eax
		call	SECKEY_CreateECPrivateKey
		add	esp, 0Ch
		mov	[esp+14h+Src], eax
		test	eax, eax
		jz	loc_10020CC4
		cmp	[esp+14h+var_4], 0
		jz	loc_10020CC4
		test	edi, edi
		jz	short loc_10020BF8
		mov	ecx, 0CE534368h
		jmp	short loc_10020C06
; ---------------------------------------------------------------------------

loc_10020BF8:				; CODE XREF: sub_10020B70+7Fj
		xor	ecx, ecx
		test	esi, esi
		setnz	cl
		lea	ecx, ds:373h[ecx*4]

loc_10020C06:				; CODE XREF: sub_10020B70+86j
		push	0
		push	0
		push	1
		push	0
		push	10Ch
		push	ecx
		mov	ecx, [esp+2Ch+arg_4]
		push	1050h
		push	0
		push	0
		push	0
		push	ecx
		push	eax
		call	PK11_PubDeriveWithKDF
		mov	esi, eax
		add	esp, 30h
		test	esi, esi
		jnz	short loc_10020C4F
		push	2Fh
		push	2
		push	ebx
		call	sub_10008960
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 10h
		jmp	loc_10020CD4
; ---------------------------------------------------------------------------

loc_10020C4F:				; CODE XREF: sub_10020B70+C1j
		mov	edx, [esp+14h+Src]
		push	edx
		call	SECKEY_DestroyPrivateKey
		push	esi
		push	ebx
		call	sub_100087C0
		push	esi
		mov	ebp, eax
		call	PK11_FreeSymKey
		add	esp, 10h
		test	ebp, ebp
		jz	short loc_10020C7B
		push	0FFFFD045h
		call	sub_100147C0
		jmp	short loc_10020CE2
; ---------------------------------------------------------------------------

loc_10020C7B:				; CODE XREF: sub_10020B70+FDj
		mov	eax, [esp+14h+var_4]
		mov	ecx, [eax+28h]
		inc	ecx
		push	ecx		; int
		push	10h		; char
		push	ebx		; Src
		call	sub_10008FF0
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_10020CE5
		mov	eax, [esp+14h+var_4]
		mov	edx, [eax+28h]
		mov	eax, [eax+24h]
		push	1		; Src
		push	edx		; Size
		push	eax		; void *
		push	ebx		; int
		call	sub_10008F70
		mov	ecx, [esp+24h+var_4]
		push	ecx
		mov	esi, eax
		call	SECKEY_DestroyPublicKey
		add	esp, 14h
		test	esi, esi
		jnz	short loc_10020CFE
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10020CC4:				; CODE XREF: sub_10020B70+6Cj
					; sub_10020B70+77j
		push	0FFFFE064h
		call	sub_100147C0
		add	esp, 4
		or	ebp, 0FFFFFFFFh

loc_10020CD4:				; CODE XREF: sub_10020B70+DAj
		mov	eax, [esp+14h+Src]
		test	eax, eax
		jz	short loc_10020CE5
		push	eax
		call	SECKEY_DestroyPrivateKey

loc_10020CE2:				; CODE XREF: sub_10020B70+49j
					; sub_10020B70+109j
		add	esp, 4

loc_10020CE5:				; CODE XREF: sub_10020B70+123j
					; sub_10020B70+16Aj
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jz	short loc_10020CF6
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_10020CF6:				; CODE XREF: sub_10020B70+17Bj
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10020CFE:				; CODE XREF: sub_10020B70+14Aj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10020B70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020D10	proc near		; CODE XREF: sub_1000C1C0+133p

var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_90		= byte ptr -90h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0B4h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B4h+var_4], eax
		mov	eax, [esp+0B4h+arg_4]
		push	esi
		mov	esi, [esp+0B8h+arg_10]
		mov	[esp+0B8h+var_B4], eax
		mov	eax, [esp+0B8h+arg_C]
		mov	ecx, [eax+18h]
		mov	edx, [eax+14h]
		push	edi
		mov	edi, [esp+0BCh+arg_0]
		lea	eax, [esp+0BCh+arg_8]
		push	eax
		mov	[esp+0C0h+var_98], ecx
		lea	ecx, [esp+0C0h+var_B4]
		push	ecx
		mov	[esp+0C4h+var_9C], edx
		push	1
		lea	edx, [esp+0C8h+var_90]
		push	edx
		push	edi
		mov	[esp+0D0h+var_AC], 6
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10020DE4
		mov	eax, [edi+44Ch]
		movzx	eax, word ptr [eax+58h]
		mov	ecx, 303h
		cmp	ax, cx
		jb	short loc_10020D98
		mov	eax, 0CE534368h
		jmp	short loc_10020DAA
; ---------------------------------------------------------------------------

loc_10020D98:				; CODE XREF: sub_10020D10+7Fj
		mov	edx, 300h
		cmp	dx, ax
		sbb	eax, eax
		and	eax, 4
		add	eax, 373h

loc_10020DAA:				; CODE XREF: sub_10020D10+86j
		push	0
		push	0
		push	1
		push	0
		push	10Ch
		push	eax
		push	1050h
		push	0
		push	0
		push	0
		lea	eax, [esp+0E4h+var_B0]
		push	eax
		push	esi
		call	PK11_PubDeriveWithKDF
		mov	esi, eax
		add	esp, 30h
		test	esi, esi
		jnz	short loc_10020DFE
		push	0FFFFD045h
		call	sub_100147C0
		add	esp, 4

loc_10020DE4:				; CODE XREF: sub_10020D10+6Bj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+0B4h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B4h
		retn
; ---------------------------------------------------------------------------

loc_10020DFE:				; CODE XREF: sub_10020D10+C5j
		push	esi
		push	edi
		call	sub_100087C0
		push	esi
		mov	edi, eax
		call	PK11_FreeSymKey
		mov	ecx, [esp+0C8h+var_4]
		add	esp, 0Ch
		mov	eax, edi
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B4h
		retn
sub_10020D10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020E30	proc near		; CODE XREF: SSL_CanBypass+460p
					; sub_10020EA0+D7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		xor	edx, edx
		xor	eax, eax
		nop

loc_10020E40:				; CODE XREF: sub_10020E30+46j
		movzx	ecx, ds:word_10030498[eax]
		cmp	ecx, edi
		jl	short loc_10020E67
		mov	eax, ds:dword_1003049C[eax]
		test	eax, eax
		jle	short loc_10020E67
		cmp	eax, 1Ah
		jge	short loc_10020E67
		mov	ebx, 1
		mov	ecx, eax
		shl	ebx, cl
		test	esi, ebx
		jnz	short loc_10020E8B

loc_10020E67:				; CODE XREF: sub_10020E30+19j
					; sub_10020E30+23j ...
		inc	edx
		lea	eax, ds:0[edx*8]
		cmp	ds:dword_1003049C[eax],	0
		jnz	short loc_10020E40
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10020E8B:				; CODE XREF: sub_10020E30+35j
		mov	eax, ds:dword_1003049C[edx*8]
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10020E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020EA0	proc near		; CODE XREF: sub_100214A0+42p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+808h]
		push	edi
		mov	edi, [esi+64h]
		add	edi, edi
		cmp	dword ptr [eax], 10h
		jnz	short loc_10020F04
		mov	eax, [esi+334h]
		test	eax, eax
		jz	short loc_10020EF2
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_10020EF2
		lea	ecx, [eax+10h]
		call	sub_100209B0
		lea	ecx, [eax-1]
		cmp	ecx, 18h
		ja	short loc_10020EF2
		mov	edx, 1
		mov	ecx, eax
		shl	edx, cl
		test	[esi+8B8h], edx
		jz	short loc_10020EF2
		movzx	eax, ds:word_10030460[eax*2]
		jmp	short loc_10020F69
; ---------------------------------------------------------------------------

loc_10020EF2:				; CODE XREF: sub_10020EA0+1Ej
					; sub_10020EA0+25j ...
		push	0FFFFD002h
		call	PORT_SetError_Util
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10020F04:				; CODE XREF: sub_10020EA0+14j
		mov	eax, [esi+304h]
		test	eax, eax
		jz	short loc_10020EF2
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_10020EF2
		mov	ecx, [eax+1Ch]
		mov	eax, [eax+18h]
		cmp	byte ptr [eax],	0
		jnz	short loc_10020F21
		dec	ecx

loc_10020F21:				; CODE XREF: sub_10020EA0+7Ej
		lea	eax, ds:0[ecx*8]
		cmp	eax, 400h
		jg	short loc_10020F36
		mov	eax, 0A0h
		jmp	short loc_10020F69
; ---------------------------------------------------------------------------

loc_10020F36:				; CODE XREF: sub_10020EA0+8Dj
		cmp	eax, 800h
		jg	short loc_10020F44
		mov	eax, 0E0h
		jmp	short loc_10020F69
; ---------------------------------------------------------------------------

loc_10020F44:				; CODE XREF: sub_10020EA0+9Bj
		cmp	eax, 0C00h
		jg	short loc_10020F52
		mov	eax, 100h
		jmp	short loc_10020F69
; ---------------------------------------------------------------------------

loc_10020F52:				; CODE XREF: sub_10020EA0+A9j
		xor	ecx, ecx
		cmp	eax, 1C00h
		setnle	cl
		lea	eax, [ecx-1]
		and	eax, 0FFFFFF77h
		add	eax, 209h

loc_10020F69:				; CODE XREF: sub_10020EA0+50j
					; sub_10020EA0+94j ...
		cmp	edi, eax
		jle	short loc_10020F6F
		mov	edi, eax

loc_10020F6F:				; CODE XREF: sub_10020EA0+CBj
		mov	edx, [esi+8B8h]
		push	edi
		push	edx
		call	sub_10020E30
		add	esp, 8
		pop	edi
		pop	esi
		retn
sub_10020EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10020F90	proc near		; DATA XREF: .text:10020FD6o
		push	esi
		push	edi
		mov	esi, offset dword_10037950
		mov	edi, 1Ah
		lea	esp, [esp+0]

loc_10020FA0:				; CODE XREF: sub_10020F90+23j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10020FAF
		push	eax
		call	sub_100074E0
		add	esp, 4

loc_10020FAF:				; CODE XREF: sub_10020F90+14j
		add	esi, 14h
		dec	edi
		jnz	short loc_10020FA0
		push	208h		; Size
		push	edi		; Val
		push	offset dword_10037950 ;	Dst
		call	memset
		add	esp, 0Ch
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10020F90	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10020FD0:				; DATA XREF: sub_10021100+11o
		push	esi
		push	offset dword_10037950
		push	offset sub_10020F90
		call	NSS_RegisterShutdown
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10020FF5
		call	PORT_GetError_Util
		mov	dword_10037954,	eax
		mov	eax, esi

loc_10020FF5:				; CODE XREF: .text:10020FE7j
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021000	proc near		; CODE XREF: .text:100210C5p
					; sub_100214A0+6Ep

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 10h
		push	edi
		lea	eax, [esp+14h+var_C]
		xor	edi, edi
		push	eax
		push	ecx
		push	edi
		mov	[esp+20h+var_10], edi
		mov	[esp+20h+var_C], edi
		mov	[esp+20h+var_8], edi
		mov	[esp+20h+var_4], edi
		call	sub_10020930
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10021031
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10021031:				; CODE XREF: sub_10021000+27j
		push	esi
		push	edi
		lea	edx, [esp+1Ch+var_10]
		push	edx
		lea	eax, [esp+20h+var_C]
		push	eax
		call	SECKEY_CreateECPrivateKey
		lea	ecx, [esp+24h+var_C]
		push	edi
		push	ecx
		mov	esi, eax
		call	SECITEM_FreeItem_Util
		add	esp, 14h
		cmp	esi, edi
		jz	short loc_10021083
		mov	eax, [esp+18h+var_10]
		cmp	eax, edi
		jz	short loc_1002107A
		push	eax
		push	esi
		call	sub_10007470
		mov	edx, [esp+20h+arg_0]
		add	esp, 8
		mov	[edx], eax
		cmp	eax, edi
		jz	short loc_1002107A
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1002107A:				; CODE XREF: sub_10021000+5Cj
					; sub_10021000+70j
		push	esi
		call	SECKEY_DestroyPrivateKey
		add	esp, 4

loc_10021083:				; CODE XREF: sub_10021000+54j
		mov	eax, [esp+18h+var_10]
		cmp	eax, edi
		jz	short loc_10021094
		push	eax
		call	SECKEY_DestroyPublicKey
		add	esp, 4

loc_10021094:				; CODE XREF: sub_10021000+89j
		push	0FFFFE064h
		call	sub_100147C0
		add	esp, 4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 10h
		retn
sub_10021000	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100210B0:				; DATA XREF: sub_10021100+42o
		push	ecx
		push	esi
		mov	esi, [esp+0Ch]
		lea	eax, [esp+4]
		push	eax
		mov	ecx, esi
		mov	dword ptr [esp+8], 0
		call	sub_10021000
		add	esp, 4
		test	eax, eax
		jz	short loc_100210E6
		call	PORT_GetError_Util
		lea	ecx, [esi+esi*4]
		mov	dword_10037954[ecx*4], eax
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100210E6:				; CODE XREF: .text:100210CFj
		mov	eax, [esp+4]
		lea	edx, [esi+esi*4]
		mov	dword_10037950[edx*4], eax
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021100	proc near		; CODE XREF: sub_100214A0+5Ep

arg_0		= dword	ptr  4

		push	esi
		lea	esi, [edi+edi*4]
		add	esi, esi
		add	esi, esi
		cmp	dword_10037950[esi], 0
		jnz	short loc_10021169
		push	offset loc_10020FD0
		push	offset dword_10037958
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_1002113B
		mov	eax, dword_10037954
		push	eax
		call	PORT_SetError_Util
		add	esp, 4

loc_10021136:				; CODE XREF: sub_10021100+71j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002113B:				; CODE XREF: sub_10021100+26j
		push	edi
		lea	ecx, dword_10037958[esi]
		push	offset loc_100210B0
		push	ecx
		call	ds:PR_CallOnceWithArg
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10021169
		mov	edx, dword_10037954[esi]
		push	edx
		call	PORT_SetError_Util
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10021169:				; CODE XREF: sub_10021100+Fj
					; sub_10021100+53j
		mov	esi, dword_10037950[esi]
		test	esi, esi
		jz	short loc_10021136
		push	esi
		call	sub_100074C0
		mov	ecx, [esp+8+arg_0]
		add	esp, 4
		mov	[ecx+444h], eax
		xor	eax, eax
		pop	esi
		retn
sub_10021100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021190	proc near		; CODE XREF: sub_1000AE00+BAp

Dst		= byte ptr -78h
var_77		= byte ptr -77h
var_76		= byte ptr -76h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		mov	eax, [esp+78h+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+84h+arg_0]
		mov	ecx, [esi+44Ch]
		mov	[esp+84h+var_70], eax
		xor	eax, eax
		mov	[esp+84h+var_58], eax
		mov	[esp+84h+var_54], eax
		mov	[esp+84h+var_50], eax
		mov	[esp+84h+var_6C], eax
		mov	[esp+84h+var_68], eax
		mov	[esp+84h+var_64], eax
		mov	[esp+84h+var_60], eax
		movzx	eax, word ptr [ecx+58h]
		mov	edx, 300h
		cmp	dx, ax
		sbb	ebp, ebp
		push	edi
		mov	ecx, 303h
		neg	ebp
		cmp	ax, cx
		lea	edx, [esp+88h+arg_8]
		push	edx		; int
		lea	eax, [esp+8Ch+var_70]
		push	eax		; int
		push	3		; Size
		lea	ecx, [esp+94h+Dst]
		push	ecx		; Dst
		sbb	ebx, ebx
		push	esi		; int
		mov	[esp+9Ch+var_74], 0FFFFD01Fh
		mov	edi, 2Fh
		inc	ebx
		call	sub_10009150
		add	esp, 14h
		test	eax, eax
		jnz	loc_1002146D
		cmp	[esp+88h+Dst], 3
		jnz	loc_10021454
		cmp	[esp+88h+var_77], al
		jnz	loc_10021454
		mov	al, [esp+88h+var_76]
		test	al, al
		jz	loc_10021454
		cmp	al, 1Ah
		jnb	loc_10021454
		lea	edx, [esp+88h+arg_8]
		push	edx
		lea	eax, [esp+8Ch+var_70]
		push	eax
		push	1
		lea	ecx, [esp+94h+var_6C]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1002146D
		mov	edx, [esp+88h+var_68]
		cmp	byte ptr [edx],	4
		jz	short loc_10021289
		mov	[esp+88h+var_74], 0FFFFE08Eh
		jmp	loc_1002145C
; ---------------------------------------------------------------------------

loc_10021289:				; CODE XREF: sub_10021190+EAj
		test	ebx, ebx
		jz	short loc_100212C9
		lea	eax, [esp+88h+var_60]
		push	eax
		lea	ecx, [esp+8Ch+arg_8]
		push	ecx
		lea	edx, [esp+90h+var_70]
		push	edx
		push	esi
		call	sub_100092B0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1002146D
		mov	eax, [esi+6Ch]
		push	eax
		lea	ecx, [esp+8Ch+var_60]
		push	ecx
		call	sub_10005670
		add	esp, 8
		test	eax, eax
		jnz	loc_1002146D

loc_100212C9:				; CODE XREF: sub_10021190+FBj
		lea	edx, [esp+88h+arg_8]
		push	edx
		lea	eax, [esp+8Ch+var_70]
		push	eax
		push	2
		lea	ecx, [esp+94h+var_58]
		push	ecx
		push	esi
		call	sub_10009240
		add	esp, 14h
		test	eax, eax
		jnz	loc_1002146D
		cmp	[esp+88h+arg_8], eax
		jz	short loc_10021307
		test	ebp, ebp
		jz	loc_10021461
		lea	edi, [eax+32h]
		jmp	loc_10021461
; ---------------------------------------------------------------------------

loc_10021307:				; CODE XREF: sub_10021190+165j
		mov	edx, [esi+14h]
		mov	edi, ebp
		neg	edi
		sbb	edi, edi
		shr	edx, 0Fh
		and	edx, 1
		push	edx
		lea	eax, [esp+8Ch+var_4C]
		push	eax
		lea	ecx, [esi+480h]
		push	ecx
		mov	ecx, [esp+94h+var_6C]
		lea	edx, [esi+4A0h]
		push	edx
		mov	edx, [esp+98h+var_68]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], ecx
		mov	ecx, [esp+0A4h+var_64]
		mov	[eax+4], edx
		mov	edx, [esp+0A4h+var_60]
		mov	[eax+8], ecx
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		lea	ecx, [esp+0B0h+Dst]
		mov	[eax+4], ecx
		mov	ecx, 3
		and	edi, 0Bh
		push	edx
		add	edi, 28h
		mov	[eax+8], ecx
		call	sub_10020A20
		add	esp, 2Ch
		test	eax, eax
		jz	short loc_10021388

loc_10021372:				; CODE XREF: sub_10021190+218j
		push	0FFFFD044h
		call	sub_100147C0
		add	esp, 4
		mov	[esp+88h+var_74], eax
		jmp	loc_10021461
; ---------------------------------------------------------------------------

loc_10021388:				; CODE XREF: sub_10021190+1E0j
		mov	eax, [esi+22Ch]
		mov	edx, [esi+6Ch]
		push	eax
		push	ebp
		lea	ecx, [esp+90h+var_58]
		push	ecx
		push	edx
		lea	eax, [esp+98h+var_4C]
		push	eax
		call	sub_10003660
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10021372
		push	800h
		call	PORT_NewArena_Util
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_10021420
		push	0ACh
		push	ebx
		call	PORT_ArenaZAlloc_Util
		mov	ebp, eax
		add	esp, 8
		mov	[esi+70h], ebp
		test	ebp, ebp
		jz	short loc_10021420
		mov	[ebp+0], ebx
		mov	dword ptr [ebp+4], 6
		movzx	edx, [esp+88h+var_76]
		lea	ecx, [ebp+10h]
		push	ecx
		push	edx
		push	ebx
		call	sub_10020930
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100213FF
		mov	[esp+88h+var_74], 0FFFFE08Dh
		jmp	short loc_10021461
; ---------------------------------------------------------------------------

loc_100213FF:				; CODE XREF: sub_10021190+263j
		lea	eax, [esp+88h+var_6C]
		push	eax
		lea	ecx, [ebp+20h]
		push	ecx
		push	ebx
		call	SECITEM_CopyItem_Util
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1002142C
		push	0
		push	ebx
		call	PORT_FreeArena_Util
		add	esp, 8

loc_10021420:				; CODE XREF: sub_10021190+22Bj
					; sub_10021190+242j
		push	0FFFFD044h
		call	sub_100147C0
		jmp	short loc_10021477
; ---------------------------------------------------------------------------

loc_1002142C:				; CODE XREF: sub_10021190+283j
		xor	eax, eax
		mov	[ebp+8], eax
		mov	[ebp+0Ch], eax
		mov	[esi+70h], ebp
		mov	dword ptr [esi+4C0h], 0Ah
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+78h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
; ---------------------------------------------------------------------------

loc_10021454:				; CODE XREF: sub_10021190+9Aj
					; sub_10021190+A4j ...
		mov	[esp+88h+var_74], 0FFFFE08Dh

loc_1002145C:				; CODE XREF: sub_10021190+F4j
		mov	edi, 28h

loc_10021461:				; CODE XREF: sub_10021190+169j
					; sub_10021190+172j ...
		push	edi
		push	2
		push	esi
		call	sub_10008960
		add	esp, 0Ch

loc_1002146D:				; CODE XREF: sub_10021190+8Fj
					; sub_10021190+DDj ...
		mov	edx, [esp+88h+var_74]
		push	edx
		call	PORT_SetError_Util

loc_10021477:				; CODE XREF: sub_10021190+29Aj
		mov	ecx, [esp+8Ch+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
sub_10021190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100214A0	proc near		; CODE XREF: sub_1000B9F0+5Bp

Src		= word ptr -70h
var_6E		= byte ptr -6Eh
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
Size		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 70h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+7Ch+arg_0]
		mov	ecx, [esi+808h]
		xor	ebx, ebx
		push	edi
		push	esi
		mov	[esp+84h+var_5C], eax
		mov	[esp+84h+var_60], ecx
		mov	[esp+84h+var_6C], ebx
		mov	[esp+84h+var_68], ebx
		mov	[esp+84h+Size],	ebx
		mov	[esp+84h+var_54], ebx
		mov	[esp+84h+var_50], ebx
		call	sub_10020EA0
		add	esp, 4
		cmp	eax, ebx
		jz	loc_100216D6
		test	dword ptr [esi+14h], 8000000h
		jz	short loc_10021505
		push	esi
		mov	edi, eax
		call	sub_10021100
		jmp	short loc_10021513
; ---------------------------------------------------------------------------

loc_10021505:				; CODE XREF: sub_100214A0+59j
		lea	edx, [esi+444h]
		push	edx
		mov	ecx, eax
		call	sub_10021000

loc_10021513:				; CODE XREF: sub_100214A0+63j
		add	esp, 4
		cmp	eax, ebx
		jnz	loc_100216D6
		mov	eax, [esi+444h]
		mov	edi, [eax+4]
		cmp	edi, ebx
		jnz	short loc_1002153A
		push	0FFFFD044h
		call	PORT_SetError_Util
		jmp	loc_100216E4
; ---------------------------------------------------------------------------

loc_1002153A:				; CODE XREF: sub_100214A0+89j
		lea	ecx, [edi+10h]
		mov	ebp, 3
		lea	ebx, [esp+80h+Src]
		call	sub_100209B0
		test	eax, eax
		jz	loc_100216C9
		mov	ecx, [esi+14h]
		shr	ecx, 0Fh
		mov	[esp+80h+var_6E], al
		and	ecx, 1
		push	ecx
		lea	edx, [esp+84h+var_4C]
		push	edx
		lea	eax, [esi+480h]
		push	eax
		lea	ecx, [esi+4A0h]
		push	ecx
		mov	[esp+90h+Src], bp
		mov	edx, [edi+20h]
		mov	ecx, [edi+24h]
		sub	esp, 0Ch
		mov	eax, esp
		mov	[eax], edx
		mov	edx, [edi+28h]
		mov	[eax+4], ecx
		mov	[eax+8], edx
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], ebx
		mov	ebx, [esp+0A8h+var_5C]
		mov	[eax+8], ebp
		mov	eax, [ebx]
		push	eax
		call	sub_10020A20
		add	esp, 2Ch
		test	eax, eax
		jz	short loc_100215C0
		push	0FFFFD044h
		call	sub_100147C0
		jmp	loc_100216D3
; ---------------------------------------------------------------------------

loc_100215C0:				; CODE XREF: sub_100214A0+10Fj
		mov	ecx, [esi+454h]
		movzx	eax, word ptr [ecx+58h]
		mov	edx, 300h
		cmp	dx, ax
		sbb	ecx, ecx
		neg	ecx
		mov	edx, 303h
		cmp	ax, dx
		mov	eax, [esp+80h+var_60]
		mov	eax, [eax]
		sbb	ebp, ebp
		sub	eax, 12h
		inc	ebp
		neg	eax
		sbb	eax, eax
		and	eax, 3
		inc	eax
		push	ecx
		add	eax, eax
		mov	edx, [esi+eax*8+2F4h]
		mov	eax, [edx]
		lea	ecx, [esp+84h+var_6C]
		push	ecx
		push	eax
		lea	ecx, [esp+8Ch+var_4C]
		push	ecx
		call	sub_100034D0
		add	esp, 10h
		test	eax, eax
		jnz	loc_100216D6
		cmp	[esp+80h+var_68], eax
		jnz	short loc_10021629
		push	0FFFFD044h
		jmp	loc_100216CE
; ---------------------------------------------------------------------------

loc_10021629:				; CODE XREF: sub_100214A0+17Dj
		mov	eax, [esp+80h+Size]
		mov	edx, ebp
		neg	edx
		sbb	edx, edx
		and	edx, 2
		add	edx, [edi+28h]
		lea	eax, [edx+eax+6]
		push	eax		; int
		push	0Ch		; char
		push	esi		; Src
		call	sub_10008FF0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100216D6
		push	3		; Size
		lea	ecx, [esp+84h+Src]
		push	ecx		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100216D6
		mov	edx, [edi+28h]
		mov	eax, [edi+24h]
		push	1		; Src
		push	edx		; Size
		push	eax		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100216D6
		test	ebp, ebp
		jz	short loc_1002168E
		push	ebx
		push	esi
		call	sub_100090F0
		add	esp, 8
		test	eax, eax
		jnz	short loc_100216D6

loc_1002168E:				; CODE XREF: sub_100214A0+1DEj
		mov	ecx, [esp+80h+Size]
		mov	edx, [esp+80h+var_68]
		push	2		; Src
		push	ecx		; Size
		push	edx		; void *
		push	esi		; int
		call	sub_10008F70
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100216D6
		mov	eax, [esp+80h+var_68]
		push	eax
		call	PORT_Free_Util
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+70h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_100216C9:				; CODE XREF: sub_100214A0+ADj
		push	0FFFFE08Dh

loc_100216CE:				; CODE XREF: sub_100214A0+184j
		call	PORT_SetError_Util

loc_100216D3:				; CODE XREF: sub_100214A0+11Bj
		add	esp, 4

loc_100216D6:				; CODE XREF: sub_100214A0+4Cj
					; sub_100214A0+78j ...
		mov	eax, [esp+80h+var_68]
		test	eax, eax
		jz	short loc_100216E7
		push	eax
		call	PORT_Free_Util

loc_100216E4:				; CODE XREF: sub_100214A0+95j
		add	esp, 4

loc_100216E7:				; CODE XREF: sub_100214A0+23Cj
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
sub_100214A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021700	proc near		; CODE XREF: sub_10009320+3AAp
					; sub_100137A0+282p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		test	esi, esi
		jnz	short loc_10021710
		mov	esi, offset dword_100305B8
		jmp	short loc_10021716
; ---------------------------------------------------------------------------

loc_10021710:				; CODE XREF: sub_10021700+7j
		cmp	word ptr [esi],	0
		jz	short loc_10021739

loc_10021716:				; CODE XREF: sub_10021700+Ej
		movzx	eax, word ptr [esi]
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	edi, edi

loc_10021720:				; CODE XREF: sub_10021700+36j
		push	0
		push	eax
		push	edi
		call	sub_10007740
		movzx	eax, word ptr [esi+2]
		add	esi, 2
		add	esp, 0Ch
		test	ax, ax
		jnz	short loc_10021720
		pop	edi

loc_10021739:				; CODE XREF: sub_10021700+14j
		xor	eax, eax
		pop	esi
		retn
sub_10021700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021740	proc near		; CODE XREF: sub_1000D820+537p
					; sub_1000E730+1D0p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+2FCh], 0
		jnz	short loc_1002175C
		push	offset dword_100305A8
		push	esi
		call	sub_10021700
		add	esp, 8

loc_1002175C:				; CODE XREF: sub_10021740+Cj
		mov	eax, [esi+32Ch]
		test	eax, eax
		jnz	short loc_10021781
		push	offset dword_10030568
		push	esi
		call	sub_10021700
		push	offset dword_10030598
		push	esi
		call	sub_10021700
		add	esp, 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10021781:				; CODE XREF: sub_10021740+24j
		add	eax, 90h
		push	eax
		call	SECOID_GetAlgorithmTag_Util
		add	esp, 4
		cmp	eax, 0C9h
		jg	short loc_100217B0
		jz	short loc_100217D5
		sub	eax, 10h	; switch 181 cases
		cmp	eax, 0B4h
		ja	short loc_100217E5 ; jumptable 100217A9	default	case
		movzx	eax, ds:byte_10021800[eax]
		jmp	ds:off_100217F8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100217B0:				; CODE XREF: sub_10021740+54j
		cmp	eax, 113h
		jl	short loc_100217E5 ; jumptable 100217A9	default	case
		cmp	eax, 118h
		jle	short loc_100217D5
		cmp	eax, 134h
		jnz	short loc_100217E5 ; jumptable 100217A9	default	case

loc_100217C5:				; CODE XREF: sub_10021740+69j
					; DATA XREF: .text:off_100217F8o
		push	offset dword_10030580 ;	jumptable 100217A9 cases 16-20,194-196
		push	esi
		call	sub_10021700
		add	esp, 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100217D5:				; CODE XREF: sub_10021740+56j
					; sub_10021740+7Cj
		push	offset dword_1003058C
		push	esi
		call	sub_10021700
		add	esp, 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100217E5:				; CODE XREF: sub_10021740+60j
					; sub_10021740+69j ...
		push	offset dword_10030568 ;	jumptable 100217A9 default case
		push	esi
		call	sub_10021700
		add	esp, 8
		pop	esi
		retn
sub_10021740	endp

; ---------------------------------------------------------------------------
		align 4
off_100217F8	dd offset loc_100217C5,	offset loc_100217E5 ; DATA XREF: sub_10021740+69r
					; jump table for switch	statement
byte_10021800	db	0,     0,     0,     0 ; DATA XREF: sub_10021740+62r
		db	0,     1,     1,     1 ; indirect table	for switch statement
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     0,     0
		db	0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100218C0	proc near		; CODE XREF: sub_10021930+Ep
					; sub_10021A20+Ap

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		mov	eax, [edi+22Ch]
		push	eax
		push	1050h
		call	PK11_GetBestSlot
		add	esp, 8
		test	eax, eax
		jnz	short loc_100218DF
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100218DF:				; CODE XREF: sub_100218C0+1Bj
		push	esi
		push	eax
		call	PK11_FreeSlot
		add	esp, 4
		mov	esi, offset dword_100305B8
		mov	edi, edi

loc_100218F0:				; CODE XREF: sub_100218C0+5Bj
		movzx	edx, word ptr [esi]
		lea	ecx, [esp+8+arg_0]
		push	ecx
		push	edx
		push	edi
		mov	[esp+14h+arg_0], 0
		call	sub_10007790
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10021914
		cmp	[esp+8+arg_0], eax
		jnz	short loc_10021922

loc_10021914:				; CODE XREF: sub_100218C0+4Cj
		add	esi, 2
		cmp	word ptr [esi],	0
		jnz	short loc_100218F0
		pop	esi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10021922:				; CODE XREF: sub_100218C0+52j
		pop	esi
		mov	eax, 1
		pop	edi
		retn
sub_100218C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021930	proc near		; DATA XREF: .rdata:1002E8A4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	loc_100219D5
		push	esi
		call	sub_100218C0
		add	esp, 4
		test	eax, eax
		jz	loc_100219D5
		mov	eax, [esi+22Ch]
		push	edi
		push	eax
		push	0A3h
		push	0
		push	1050h
		call	PK11_GetBestSlotWithAttributes
		add	esp, 10h
		test	eax, eax
		jz	short loc_100219A3
		push	eax
		call	PK11_FreeSlot
		add	esp, 4
		mov	edi, 38h
		mov	eax, offset dword_100305F8

loc_10021981:				; CODE XREF: sub_10021930+7Dj
		cmp	[esp+8+arg_4], 0
		jz	short loc_100219D0
		cmp	[esp+8+arg_8], edi
		jb	short loc_100219D0
		push	edi		; Size
		push	eax		; Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100219AF
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100219A3:				; CODE XREF: sub_10021930+3Cj
		mov	edi, 0Ch
		mov	eax, offset dword_100305EC
		jmp	short loc_10021981
; ---------------------------------------------------------------------------

loc_100219AF:				; CODE XREF: sub_10021930+6Bj
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_100219D0
		movzx	ecx, word ptr [esi+2EF4h]
		mov	edx, 0Ah
		mov	[esi+ecx*2+2EF8h], dx
		inc	word ptr [esi+2EF4h]

loc_100219D0:				; CODE XREF: sub_10021930+56j
					; sub_10021930+5Cj ...
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100219D5:				; CODE XREF: sub_10021930+7j
					; sub_10021930+18j
		xor	eax, eax
		pop	esi
		retn
sub_10021930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100219E0	proc near		; CODE XREF: SSL_CanBypass+457p
					; sub_10007320+80p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100219F0
		mov	eax, [eax+22Ch]
		jmp	short loc_100219F2
; ---------------------------------------------------------------------------

loc_100219F0:				; CODE XREF: sub_100219E0+6j
		xor	eax, eax

loc_100219F2:				; CODE XREF: sub_100219E0+Ej
		push	eax
		push	0A3h
		push	0
		push	1050h
		call	PK11_GetBestSlotWithAttributes
		add	esp, 10h
		test	eax, eax
		jz	short loc_10021A1A
		push	eax
		call	PK11_FreeSlot
		add	esp, 4
		mov	eax, 3FFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_10021A1A:				; CODE XREF: sub_100219E0+29j
		mov	eax, 3800000h
		retn
sub_100219E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021A20	proc near		; DATA XREF: sub_10021A90:loc_10021AD8o
					; .rdata:1002E8ACo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_10021A85
		push	esi
		call	sub_100218C0
		add	esp, 4
		test	eax, eax
		jz	short loc_10021A85
		cmp	[esp+4+arg_4], 0
		jz	short loc_10021A7E
		cmp	[esp+4+arg_8], 6
		jb	short loc_10021A7E
		push	6		; Size
		push	offset dword_10030630 ;	Src
		push	esi		; int
		call	sub_10008E00
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10021A5D
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10021A5D:				; CODE XREF: sub_10021A20+36j
		cmp	dword ptr [esi+4Ch], 0
		jnz	short loc_10021A7E
		movzx	eax, word ptr [esi+2EF4h]
		mov	ecx, 0Bh
		mov	[esi+eax*2+2EF8h], cx
		inc	word ptr [esi+2EF4h]

loc_10021A7E:				; CODE XREF: sub_10021A20+1Bj
					; sub_10021A20+22j ...
		mov	eax, 6
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10021A85:				; CODE XREF: sub_10021A20+7j
					; sub_10021A20+14j
		xor	eax, eax
		pop	esi
		retn
sub_10021A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021A90	proc near		; DATA XREF: .rdata:1002E7F4o

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		mov	eax, [ecx+8]
		cmp	eax, 2
		jb	short loc_10021AC2
		cmp	eax, 0FFh
		ja	short loc_10021AC2
		mov	ecx, [ecx+4]
		test	ecx, ecx
		jz	short loc_10021AC2
		movzx	edx, byte ptr [ecx]
		inc	edx
		cmp	eax, edx
		jnz	short loc_10021AC2
		dec	eax
		test	eax, eax
		jle	short loc_10021AC2

loc_10021AB7:				; CODE XREF: sub_10021A90+30j
		cmp	byte ptr [ecx+eax], 0
		jz	short loc_10021AD8
		dec	eax
		test	eax, eax
		jg	short loc_10021AB7

loc_10021AC2:				; CODE XREF: sub_10021A90+Aj
					; sub_10021A90+11j ...
		mov	edx, [esp+arg_0]
		push	offset dword_100305B8
		push	edx
		call	sub_10021700
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10021AD8:				; CODE XREF: sub_10021A90+2Bj
		mov	[esp+arg_8], offset sub_10021A20
		jmp	sub_100162A0
sub_10021A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021AF0	proc near		; CODE XREF: sub_10021B10+94p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	ecx, [ecx+334h]
		xor	eax, eax
		test	ecx, ecx
		jz	short locret_10021B0F
		mov	ecx, [ecx+4]
		test	ecx, ecx
		jz	short locret_10021B0F
		add	ecx, 10h
		jmp	sub_100209B0
; ---------------------------------------------------------------------------

locret_10021B0F:			; CODE XREF: sub_10021AF0+Ej
					; sub_10021AF0+15j
		retn
sub_10021AF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10021B10	proc near		; DATA XREF: .rdata:1002E7ECo

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	ebx
		push	ebp
		push	esi
		xor	ebp, ebp
		lea	ebx, [eax+4]
		push	edi
		mov	edi, [esp+10h+arg_0]
		cmp	[ebx], ebp
		jz	loc_10021BE7
		lea	esi, [eax+8]
		mov	eax, [esi]
		cmp	eax, 4
		jb	loc_10021BE7
		cmp	eax, 0FFFFh
		ja	loc_10021BE7
		push	esi
		push	ebx
		push	2
		push	edi
		call	sub_100091C0
		add	esp, 10h
		test	eax, eax
		js	loc_10021BE7
		mov	ecx, [esi]
		cmp	ecx, eax
		jnz	loc_10021BE7
		test	cl, 1
		jnz	loc_10021BE7
		test	ecx, ecx
		jz	short loc_10021B95
		mov	edi, edi

loc_10021B70:				; CODE XREF: sub_10021B10+83j
		push	esi
		push	ebx
		push	2
		push	edi
		call	sub_100091C0
		lea	ecx, [eax-1]
		add	esp, 10h
		cmp	ecx, 18h
		ja	short loc_10021B90
		mov	edx, 1
		mov	ecx, eax
		shl	edx, cl
		or	ebp, edx

loc_10021B90:				; CODE XREF: sub_10021B10+73j
		cmp	dword ptr [esi], 0
		jnz	short loc_10021B70

loc_10021B95:				; CODE XREF: sub_10021B10+5Cj
		and	[edi+8B8h], ebp
		mov	esi, [edi+8B8h]
		jz	short loc_10021BE7
		push	edi
		call	sub_10021AF0
		movzx	ecx, ax
		add	esp, 4
		test	cx, cx
		jz	short loc_10021BC6
		mov	eax, 1
		shl	eax, cl
		test	esi, eax
		jz	short loc_10021BC6
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10021BC6:				; CODE XREF: sub_10021B10+A2j
					; sub_10021B10+ADj
		push	offset dword_10030580
		push	edi
		call	sub_10021700
		push	offset dword_10030598
		push	edi
		call	sub_10021700
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10021BE7:				; CODE XREF: sub_10021B10+13j
					; sub_10021B10+21j ...
		push	offset dword_100305B8
		push	edi
		call	sub_10021700
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_10021B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10021C00	proc near		; CODE XREF: sub_10017A70+86p
					; sub_10017B30+89p ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		cmp	ecx, 1E7h
		jg	loc_10021CFE
		jz	loc_10021CED	; jumptable 10021D2E cases 998,1001
					; jumptable 10021DCA case 10014
		lea	eax, [ecx-2]	; switch 211 cases
		cmp	eax, 0D2h
		ja	loc_10021F03	; jumptable 10021C2B default case
		movzx	eax, ds:byte_10021F50[eax]
		jmp	ds:off_10021F14[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10021C32:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+1CAj
					; DATA XREF: ...
		mov	eax, 0FFFFE8B2h	; jumptable 10021C2B cases 5,13,19
					; jumptable 10021DCA case 10013
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C43:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8C2h	; jumptable 10021C2B cases 2,3
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C54:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8C9h	; jumptable 10021C2B cases 80,183
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C65:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8BCh	; jumptable 10021C2B cases 39,112
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C76:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8BAh	; jumptable 10021C2B cases 108,212
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C87:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8C1h	; jumptable 10021C2B case 206
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021C98:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+1CAj
					; DATA XREF: ...
		mov	eax, 0FFFFE89Dh	; jumptable 10021C2B cases 87,123
					; jumptable 10021DCA cases 10022,10039,10041,10042,10044
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CA9:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+1CAj
					; DATA XREF: ...
		mov	eax, 0FFFFE8B7h	; jumptable 10021C2B case 64
					; jumptable 10021DCA case 10054
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CBA:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8CDh	; jumptable 10021C2B case 18
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CCB:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8D0h	; jumptable 10021C2B case 32
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CDC:				; CODE XREF: sub_10021C00+2Bj
					; DATA XREF: .text:off_10021F14o
		mov	eax, 0FFFFE8AEh	; jumptable 10021C2B case 4
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CED:				; CODE XREF: sub_10021C00+10j
					; sub_10021C00+12Ej ...
		mov	eax, 0FFFFE893h	; jumptable 10021D2E cases 998,1001
					; jumptable 10021DCA case 10014
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021CFE:				; CODE XREF: sub_10021C00+Aj
		cmp	ecx, 2719h
		jg	loc_10021DB4
		jz	short loc_10021D46 ; jumptable 10021C2B	case 6
					; jumptable 10021D2E case 1006
		cmp	ecx, 570h
		jg	short loc_10021D57
		jz	short loc_10021D35 ; jumptable 10021C2B	cases 21,110,132,148
					; jumptable 10021D2E case 1127
		lea	eax, [ecx-3E6h]	; switch 130 cases
		cmp	eax, 81h
		ja	loc_10021F03	; jumptable 10021C2B default case
		movzx	edx, ds:byte_10022034[eax]
		jmp	ds:off_10022024[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10021D35:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+114j ...
		mov	eax, 0FFFFE899h	; jumptable 10021C2B cases 21,110,132,148
					; jumptable 10021D2E case 1127
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021D46:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+10Aj ...
		mov	eax, 0FFFFE891h	; jumptable 10021C2B case 6
					; jumptable 10021D2E case 1006
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021D57:				; CODE XREF: sub_10021C00+112j
		cmp	ecx, 718h
		jg	short loc_10021D97
		jz	short loc_10021D86
		cmp	ecx, 571h
		jz	short loc_10021D35 ; jumptable 10021C2B	cases 21,110,132,148
					; jumptable 10021D2E case 1127
		cmp	ecx, 6F8h
		jnz	loc_10021F03	; jumptable 10021C2B default case

loc_10021D75:				; CODE XREF: sub_10021C00+2Bj
					; sub_10021C00+1CAj
					; DATA XREF: ...
		mov	eax, 0FFFFE8AAh	; jumptable 10021C2B cases 8,14
					; jumptable 10021DCA case 10055
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021D86:				; CODE XREF: sub_10021C00+15Fj
		mov	eax, 0FFFFE890h
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021D97:				; CODE XREF: sub_10021C00+15Dj
		cmp	ecx, 961h
		jnz	loc_10021F03	; jumptable 10021C2B default case
		mov	eax, 0FFFFE899h
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021DB4:				; CODE XREF: sub_10021C00+104j
		lea	eax, [ecx-271Dh] ; switch 53 cases
		cmp	eax, 34h
		ja	loc_10021F03	; jumptable 10021C2B default case
		movzx	eax, ds:byte_10022118[eax]
		jmp	ds:off_100220B8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10021DD1:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8A2h	; jumptable 10021DCA case 10048
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021DE2:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE89Eh	; jumptable 10021DCA case 10049
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021DF3:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE89Fh	; jumptable 10021DCA case 10047
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E04:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8D3h	; jumptable 10021DCA case 10037
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E15:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8D8h	; jumptable 10021DCA cases 10052,10053,10060
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E26:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8A3h	; jumptable 10021DCA case 10061
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E37:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8D9h	; jumptable 10021DCA case 10065
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E48:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8A0h	; jumptable 10021DCA case 10056
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E59:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8ADh	; jumptable 10021DCA case 10024
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E6A:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8B6h	; jumptable 10021DCA case 10040
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E7B:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8D6h	; jumptable 10021DCA case 10050
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E8C:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8A4h	; jumptable 10021DCA case 10051
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021E9D:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8A6h	; jumptable 10021DCA case 10057
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021EAE:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8AFh	; jumptable 10021DCA case 10038
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021EBF:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8B3h	; jumptable 10021DCA case 10045
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021ED0:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8B4h	; jumptable 10021DCA case 10043
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021EE1:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE8D7h	; jumptable 10021DCA case 10058
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021EF2:				; CODE XREF: sub_10021C00+1CAj
					; DATA XREF: .text:off_100220B8o
		mov	eax, 0FFFFE892h	; jumptable 10021DCA case 10035
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10021F03:				; CODE XREF: sub_10021C00+1Ej
					; sub_10021C00+2Bj ...
		mov	eax, 0FFFFE896h	; jumptable 10021C2B default case
		push	ecx
		push	eax
		call	ds:PR_SetError
		add	esp, 8
		retn
sub_10021C00	endp

; ---------------------------------------------------------------------------
off_10021F14	dd offset loc_10021C43,	offset loc_10021CDC, offset loc_10021C32
					; DATA XREF: sub_10021C00+2Br
		dd offset loc_10021D46,	offset loc_10021D75, offset loc_10021CBA ; jump	table for switch statement
		dd offset loc_10021D35,	offset loc_10021CCB, offset loc_10021C65
		dd offset loc_10021CA9,	offset loc_10021C54, offset loc_10021C98
		dd offset loc_10021C76,	offset loc_10021C87, offset loc_10021F03
byte_10021F50	db 0, 0, 1, 2, 3, 0Eh, 4, 0Eh, 0Eh, 0Eh, 0Eh, 2, 4, 0Eh
					; DATA XREF: sub_10021C00+24r
		db 0Eh,	0Eh, 5,	2, 0Eh,	6, 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh	; indirect table for switch statement
		db 0Eh,	0Eh, 0Eh, 0Eh, 7, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh
		db 8, 0Eh, 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 9, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Ah,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Bh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Ch, 0Eh, 6, 0Eh, 8, 0Eh, 0Eh, 0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Bh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 6, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	6, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Ah,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh,	0Eh, 0Eh
		db 0Eh,	0Dh, 0Eh, 0Eh, 0Eh, 0Eh, 0Eh, 0Ch
		align 4
off_10022024	dd offset loc_10021CED,	offset loc_10021D46, offset loc_10021D35
					; DATA XREF: sub_10021C00+12Er
		dd offset loc_10021F03	; jump table for switch	statement
byte_10022034	db	0,     3,     3,     0 ; DATA XREF: sub_10021C00+127r
		db	3,     3,     3,     3 ; indirect table	for switch statement
		db	1,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     2
		align 4
off_100220B8	dd offset loc_10021C32,	offset loc_10021CED, offset loc_10021C98
					; DATA XREF: sub_10021C00+1CAr
		dd offset loc_10021E59,	offset loc_10021EF2, offset loc_10021E04 ; jump	table for switch statement
		dd offset loc_10021EAE,	offset loc_10021E6A, offset loc_10021ED0
		dd offset loc_10021EBF,	offset loc_10021DF3, offset loc_10021DD1
		dd offset loc_10021DE2,	offset loc_10021E7B, offset loc_10021E8C
		dd offset loc_10021E15,	offset loc_10021CA9, offset loc_10021D75
		dd offset loc_10021E48,	offset loc_10021E9D, offset loc_10021EE1
		dd offset loc_10021E26,	offset loc_10021E37, offset loc_10021F03
byte_10022118	db	0,     1,   17h,   17h ; DATA XREF: sub_10021C00+1C3r
		db    17h,   17h,   17h,   17h ; indirect table	for switch statement
		db    17h,     2,   17h,     3
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,     4,   17h
		db	5,     6,     2,     7
		db	2,     2,     8,     2
		db	9,   17h,   0Ah,   0Bh
		db    0Ch,   0Dh,   0Eh,   0Fh
		db    0Fh,   10h,   11h,   12h
		db    13h,   14h,   17h,   0Fh
		db    15h,   17h,   17h,   17h
		db    16h
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10022150(char	*Str)
sub_10022150	proc near		; CODE XREF: sub_10022200+25p

var_4		= dword	ptr -4
Str		= dword	ptr  4

		sub	esp, 0Ch
		push	ebp
		mov	ebp, [esp+10h+Str]
		push	esi
		push	edi
		xor	esi, esi
		call	ds:PR_GetDirectorySeparator
		movsx	eax, al
		push	eax		; Ch
		push	ebp		; Str
		call	ds:strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_100221F2
		sub	eax, ebp
		lea	edi, [eax+1]
		mov	eax, ebx
		lea	edx, [eax+1]
		mov	edi, edi

loc_10022180:				; CODE XREF: sub_10022150+35j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10022180
		sub	eax, edx
		lea	ecx, [eax+edi+1]
		push	ecx
		call	PORT_Alloc_Util
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100221E9
		push	edi		; Size
		push	ebp		; Src
		push	esi		; Dst
		call	memcpy
		lea	edx, [edi+esi]
		add	esp, 0Ch
		mov	eax, ebx
		sub	edx, ebx
		mov	edi, edi

loc_100221B0:				; CODE XREF: sub_10022150+68j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_100221B0
		mov	edx, [esp+18h+var_4]
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], esi
		mov	[eax+8], edx
		call	ds:PR_LoadLibraryWithFlags
		push	esi
		mov	edi, eax
		call	PORT_Free_Util
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100221E9:				; CODE XREF: sub_10022150+4Aj
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100221F2:				; CODE XREF: sub_10022150+22j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
sub_10022150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022200	proc near		; CODE XREF: sub_10022270+22p
					; DATA XREF: sub_10022200+Bo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, off_1003714C
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		push	offset sub_10022200
		push	eax
		call	ds:PR_GetLibraryFilePathname
		mov	ebx, [esp+20h+arg_0]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1002223A
		push	esi		; Str
		call	sub_10022150
		push	esi
		mov	edi, eax
		call	ds:PR_Free
		add	esp, 8
		test	edi, edi
		jnz	short loc_1002225F

loc_1002223A:				; CODE XREF: sub_10022200+22j
		push	0Ah
		sub	esp, 0Ch
		mov	eax, esp
		xor	ecx, ecx
		mov	[eax], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		call	ds:PR_LoadLibraryWithFlags
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1002225F:				; CODE XREF: sub_10022200+38j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
sub_10022200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022270	proc near		; DATA XREF: .text:10022319o
					; .text:10022349o ...
		mov	eax, off_10037148
		push	edi
		mov	edi, eax
		test	eax, eax
		jnz	short loc_10022290
		push	eax
		push	0FFFFE8A7h
		call	ds:PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10022290:				; CODE XREF: sub_10022270+Aj
		push	esi
		push	eax
		call	sub_10022200
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100222FC
		push	offset aFreebl_getvect ; "FREEBL_GetVector"
		push	esi
		call	ds:PR_FindFunctionSymbol
		add	esp, 8
		test	eax, eax
		jz	short loc_100222F2
		call	eax
		test	eax, eax
		jz	short loc_100222F2
		movzx	ecx, word ptr [eax+2]
		mov	edx, ecx
		and	edx, 0FF00h
		cmp	edx, 300h
		jnz	short loc_100222F2
		cmp	cl, 11h
		jb	short loc_100222F2
		mov	edx, 348h
		cmp	[eax], dx
		jb	short loc_100222F2
		mov	dword_10037B64,	esi
		pop	esi
		mov	dword_10037B68,	eax
		mov	dword_10037B6C,	edi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100222F2:				; CODE XREF: sub_10022270+41j
					; sub_10022270+47j ...
		push	esi
		call	ds:PR_UnloadLibrary
		add	esp, 4

loc_100222FC:				; CODE XREF: sub_10022270+2Ej
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_10022270	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022310:				; DATA XREF: sub_10007A40+8Bo
		cmp	dword_10037B68,	0
		jnz	short loc_10022330
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002233B

loc_10022330:				; CODE XREF: .text:10022317j
		mov	edx, dword_10037B68
		mov	eax, [edx+3Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002233B:			; CODE XREF: .text:1002232Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10022340:				; DATA XREF: sub_10007A40+7Do
		cmp	dword_10037B68,	0
		jnz	short loc_10022364
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022364
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022364:				; CODE XREF: .text:10022347j
					; .text:1002235Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+40h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022370:				; DATA XREF: sub_10007A40+84o
		cmp	dword_10037B68,	0
		jnz	short loc_10022394
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022394
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022394:				; CODE XREF: .text:10022377j
					; .text:1002238Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+44h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_100223A0:				; DATA XREF: sub_10007A40+ADo
		cmp	dword_10037B68,	0
		jnz	short loc_100223C0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100223CB

loc_100223C0:				; CODE XREF: .text:100223A7j
		mov	edx, dword_10037B68
		mov	eax, [edx+4Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_100223CB:			; CODE XREF: .text:100223BEj
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_100223D0:				; DATA XREF: sub_10007A40+9Fo
		cmp	dword_10037B68,	0
		jnz	short loc_100223F4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100223F4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100223F4:				; CODE XREF: .text:100223D7j
					; .text:100223EEj
		mov	eax, dword_10037B68
		mov	ecx, [eax+50h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022400:				; DATA XREF: sub_10007A40+A6o
		cmp	dword_10037B68,	0
		jnz	short loc_10022424
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022424
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022424:				; CODE XREF: .text:10022407j
					; .text:1002241Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+54h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022430:				; DATA XREF: sub_10007A40+CCo
					; sub_10007A40+EFo
		cmp	dword_10037B68,	0
		jnz	short loc_10022450
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002245B

loc_10022450:				; CODE XREF: .text:10022437j
		mov	edx, dword_10037B68
		mov	eax, [edx+6Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002245B:			; CODE XREF: .text:1002244Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10022460:				; DATA XREF: sub_10007A40+BEo
					; sub_10007A40+E1o
		cmp	dword_10037B68,	0
		jnz	short loc_10022484
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022484
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022484:				; CODE XREF: .text:10022467j
					; .text:1002247Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+70h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022490:				; DATA XREF: sub_10007A40+C5o
					; sub_10007A40+E8o
		cmp	dword_10037B68,	0
		jnz	short loc_100224B4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100224B4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100224B4:				; CODE XREF: .text:10022497j
					; .text:100224AEj
		mov	eax, dword_10037B68
		mov	ecx, [eax+74h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_100224C0:				; DATA XREF: sub_10007A40+143o
		cmp	dword_10037B68,	0
		jnz	short loc_100224E0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100224EE

loc_100224E0:				; CODE XREF: .text:100224C7j
		mov	edx, dword_10037B68
		mov	eax, [edx+280h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_100224EE:			; CODE XREF: .text:100224DEj
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_100224F0:				; DATA XREF: sub_10007A40+135o
		cmp	dword_10037B68,	0
		jnz	short loc_10022514
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022514
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022514:				; CODE XREF: .text:100224F7j
					; .text:1002250Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+284h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022530:				; DATA XREF: sub_10007A40+13Co
		cmp	dword_10037B68,	0
		jnz	short loc_10022554
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022554
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022554:				; CODE XREF: .text:10022537j
					; .text:1002254Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+288h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022570	proc near		; CODE XREF: sub_10004370+153p
					; DATA XREF: sub_10007A40+10Bo
		cmp	dword_10037B68,	0
		jnz	short loc_10022590
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002259B

loc_10022590:				; CODE XREF: sub_10022570+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+7Ch]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002259B:			; CODE XREF: sub_10022570+1Ej
		retn
sub_10022570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100225A0	proc near		; CODE XREF: sub_10004370+146p
					; sub_10015700+757p
					; DATA XREF: ...
		cmp	dword_10037B68,	0
		jnz	short loc_100225C4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100225C4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100225C4:				; CODE XREF: sub_100225A0+7j
					; sub_100225A0+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+80h]
		jmp	ecx
sub_100225A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100225E0	proc near		; CODE XREF: sub_10004370+131p
					; sub_10016CD0+351p
					; DATA XREF: ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022604
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022604
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022604:				; CODE XREF: sub_100225E0+7j
					; sub_100225E0+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+84h]
		jmp	ecx
sub_100225E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022620	proc near		; CODE XREF: sub_10003800+2Ap
		cmp	dword_10037B68,	0
		jnz	short loc_10022644
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022644
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022644:				; CODE XREF: sub_10022620+7j
					; sub_10022620+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+8Ch]
		jmp	ecx
sub_10022620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022660	proc near		; CODE XREF: sub_10001000+6AAp
					; sub_100078C0+7Dp
		cmp	dword_10037B68,	0
		jnz	short loc_10022680
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002268E

loc_10022680:				; CODE XREF: sub_10022660+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+94h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002268E:			; CODE XREF: sub_10022660+1Ej
		retn
sub_10022660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022690	proc near		; CODE XREF: sub_10001000+289p
					; sub_10001000+3FDp ...
		cmp	dword_10037B68,	0
		jnz	short loc_100226B0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100226BE

loc_100226B0:				; CODE XREF: sub_10022690+7j
		mov	ecx, dword_10037B68
		mov	edx, [ecx+98h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100226BE:			; CODE XREF: sub_10022690+1Ej
		retn
sub_10022690	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100226C0	proc near		; CODE XREF: sub_10001000+2A4p
					; sub_10001000+2BEp ...
		cmp	dword_10037B68,	0
		jnz	short loc_100226E0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100226ED

loc_100226E0:				; CODE XREF: sub_100226C0+7j
		mov	eax, dword_10037B68
		mov	ecx, [eax+9Ch]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100226ED:			; CODE XREF: sub_100226C0+1Ej
		retn
sub_100226C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100226F0	proc near		; CODE XREF: sub_10001000+2D7p
					; sub_10001000+43Ap ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022710
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002271E

loc_10022710:				; CODE XREF: sub_100226F0+7j
		mov	ecx, dword_10037B68
		mov	edx, [ecx+0A0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002271E:			; CODE XREF: sub_100226F0+1Ej
		retn
sub_100226F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022720	proc near		; CODE XREF: sub_10003800+39p
					; sub_10003800+68p
		cmp	dword_10037B68,	0
		jnz	short loc_10022744
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022744
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022744:				; CODE XREF: sub_10022720+7j
					; sub_10022720+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+0DCh]
		jmp	ecx
sub_10022720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022760	proc near		; CODE XREF: sub_10001000+6B9p
					; sub_100078C0+70p
		cmp	dword_10037B68,	0
		jnz	short loc_10022780
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002278E

loc_10022780:				; CODE XREF: sub_10022760+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+0E4h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_1002278E:			; CODE XREF: sub_10022760+1Ej
		retn
sub_10022760	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022790	proc near		; CODE XREF: sub_10001000+211p
					; sub_10001710+12Dp ...
		cmp	dword_10037B68,	0
		jnz	short loc_100227B0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100227BE

loc_100227B0:				; CODE XREF: sub_10022790+7j
		mov	ecx, dword_10037B68
		mov	edx, [ecx+0E8h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_100227BE:			; CODE XREF: sub_10022790+1Ej
		retn
sub_10022790	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100227C0	proc near		; CODE XREF: sub_10001000+22Ep
					; sub_10001000+249p ...
		cmp	dword_10037B68,	0
		jnz	short loc_100227E0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_100227ED

loc_100227E0:				; CODE XREF: sub_100227C0+7j
		mov	eax, dword_10037B68
		mov	ecx, [eax+0ECh]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_100227ED:			; CODE XREF: sub_100227C0+1Ej
		retn
sub_100227C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100227F0	proc near		; CODE XREF: sub_10001000+27Cp
					; sub_10001710+192p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022810
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_1002281E

loc_10022810:				; CODE XREF: sub_100227F0+7j
		mov	ecx, dword_10037B68
		mov	edx, [ecx+0F0h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_1002281E:			; CODE XREF: sub_100227F0+1Ej
		retn
sub_100227F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022820	proc near		; CODE XREF: sub_1001C550p
		cmp	dword_10037B64,	0
		mov	dword_10037B68,	0
		jz	short loc_1002285E
		push	offset aNss_disable_un ; "NSS_DISABLE_UNLOAD"
		call	ds:PR_GetEnv
		add	esp, 4
		test	eax, eax
		jnz	short loc_10022854
		mov	eax, dword_10037B64
		push	eax
		call	ds:PR_UnloadLibrary
		add	esp, 4

loc_10022854:				; CODE XREF: sub_10022820+23j
		mov	dword_10037B64,	0

loc_1002285E:				; CODE XREF: sub_10022820+11j
		mov	ecx, ds:dword_10030668
		mov	edx, ds:dword_1003066C
		mov	eax, ds:dword_10030670
		mov	dword_10037B58,	ecx
		mov	dword_10037B5C,	edx
		mov	dword_10037B60,	eax
		retn
sub_10022820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022890	proc near		; CODE XREF: sub_10003800+9Ap
					; sub_1001A330+72p
		cmp	dword_10037B68,	0
		jnz	short loc_100228B4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100228B4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100228B4:				; CODE XREF: sub_10022890+7j
					; sub_10022890+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+140h]
		jmp	ecx
sub_10022890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100228D0	proc near		; CODE XREF: sub_10003800+FEp
		cmp	dword_10037B68,	0
		jnz	short loc_100228F4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100228F4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100228F4:				; CODE XREF: sub_100228D0+7j
					; sub_100228D0+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+16Ch]
		jmp	ecx
sub_100228D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022910	proc near		; CODE XREF: sub_10003800+CCp
		cmp	dword_10037B68,	0
		jnz	short loc_10022934
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022934
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022934:				; CODE XREF: sub_10022910+7j
					; sub_10022910+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+198h]
		jmp	ecx
sub_10022910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022950	proc near		; CODE XREF: sub_10004370+111p
					; sub_10015700+724p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022974
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022974
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022974:				; CODE XREF: sub_10022950+7j
					; sub_10022950+1Ej
		mov	ecx, dword_10037B68
		mov	edx, [ecx+1E4h]
		jmp	edx
sub_10022950	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022990:				; DATA XREF: sub_10007A40:loc_10007AF9o
					; sub_10007A40:loc_10007B15o
		cmp	dword_10037B68,	0
		jnz	short loc_100229B4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100229B4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100229B4:				; CODE XREF: .text:10022997j
					; .text:100229AEj
		mov	ecx, dword_10037B68
		mov	edx, [ecx+1ECh]
		jmp	edx
; ---------------------------------------------------------------------------
		align 10h

loc_100229D0:				; DATA XREF: sub_10007A40:loc_10007B70o
		cmp	dword_10037B68,	0
		jnz	short loc_100229F4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100229F4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100229F4:				; CODE XREF: .text:100229D7j
					; .text:100229EEj
		mov	ecx, dword_10037B68
		mov	edx, [ecx+274h]
		jmp	edx
; ---------------------------------------------------------------------------
		align 10h

loc_10022A10:				; DATA XREF: sub_10007A40+9Ao
		cmp	dword_10037B68,	0
		jnz	short loc_10022A34
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022A34
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022A34:				; CODE XREF: .text:10022A17j
					; .text:10022A2Ej
		mov	ecx, dword_10037B68
		mov	edx, [ecx+1F0h]
		jmp	edx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022A50	proc near		; CODE XREF: sub_10007A40+17Cp
					; sub_10007A40+1C2p
					; DATA XREF: ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022A74
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022A74
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022A74:				; CODE XREF: sub_10022A50+7j
					; sub_10022A50+1Ej
		mov	ecx, dword_10037B68
		mov	edx, [ecx+1F4h]
		jmp	edx
sub_10022A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022A90	proc near		; CODE XREF: sub_100056B0+CEp
		cmp	dword_10037B68,	0
		jnz	short loc_10022AB0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022ABE

loc_10022AB0:				; CODE XREF: sub_10022A90+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+210h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10022ABE:			; CODE XREF: sub_10022A90+1Ej
		retn
sub_10022A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022AC0	proc near		; CODE XREF: sub_100056B0+E2p
		cmp	dword_10037B68,	0
		jnz	short loc_10022AE0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022AEE

loc_10022AE0:				; CODE XREF: sub_10022AC0+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+214h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10022AEE:			; CODE XREF: sub_10022AC0+1Ej
		retn
sub_10022AC0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022AF0:				; DATA XREF: sub_10008500+47o
		cmp	dword_10037B68,	0
		jnz	short loc_10022B10
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022B1E

loc_10022B10:				; CODE XREF: .text:10022AF7j
		mov	edx, dword_10037B68
		mov	eax, [edx+218h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10022B1E:			; CODE XREF: .text:10022B0Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022B20	proc near		; CODE XREF: sub_10001000:loc_100011D2p
					; sub_10001000+5ACp ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022B44
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022B44
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022B44:				; CODE XREF: sub_10022B20+7j
					; sub_10022B20+1Ej
		mov	edx, dword_10037B68
		mov	eax, [edx+224h]
		jmp	eax
sub_10022B20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022B60	proc near		; CODE XREF: sub_100047D0:loc_10004865p
					; sub_10008500+1Dp ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022B83
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022B83
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10022B83:				; CODE XREF: sub_10022B60+7j
					; sub_10022B60+1Ej
		mov	ecx, dword_10037B68
		mov	edx, [ecx+228h]
		jmp	edx
sub_10022B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022BA0	proc near		; CODE XREF: sub_100047D0+29Ap
		cmp	dword_10037B68,	0
		jnz	short loc_10022BC0
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022BCE

loc_10022BC0:				; CODE XREF: sub_10022BA0+7j
		mov	edx, dword_10037B68
		mov	eax, [edx+244h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10022BCE:			; CODE XREF: sub_10022BA0+1Ej
		retn
sub_10022BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022BD0	proc near		; CODE XREF: sub_100047D0+239p
					; sub_10015700+7F7p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022BF4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022BF4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022BF4:				; CODE XREF: sub_10022BD0+7j
					; sub_10022BD0+1Ej
		mov	edx, dword_10037B68
		mov	eax, [edx+230h]
		jmp	eax
sub_10022BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022C10	proc near		; CODE XREF: sub_100047D0+24Ep
					; sub_10015700+80Fp ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022C30
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022C3E

loc_10022C30:				; CODE XREF: sub_10022C10+7j
		mov	ecx, dword_10037B68
		mov	edx, [ecx+234h]
		jmp	edx
; ---------------------------------------------------------------------------

locret_10022C3E:			; CODE XREF: sub_10022C10+1Ej
		retn
sub_10022C10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022C40	proc near		; CODE XREF: sub_100047D0+261p
					; sub_100047D0+274p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022C60
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022C6D

loc_10022C60:				; CODE XREF: sub_10022C40+7j
		mov	eax, dword_10037B68
		mov	ecx, [eax+238h]
		jmp	ecx
; ---------------------------------------------------------------------------

locret_10022C6D:			; CODE XREF: sub_10022C40+1Ej
		retn
sub_10022C40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022C70	proc near		; CODE XREF: sub_100047D0+28Cp
					; sub_10015700+884p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022C94
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022C94
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022C94:				; CODE XREF: sub_10022C70+7j
					; sub_10022C70+1Ej
		mov	ecx, dword_10037B68
		mov	edx, [ecx+240h]
		jmp	edx
sub_10022C70	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10022CB0:				; DATA XREF: sub_10007A40:loc_10007B54o
		cmp	dword_10037B68,	0
		jnz	short loc_10022CD4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022CD4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022CD4:				; CODE XREF: .text:10022CB7j
					; .text:10022CCEj
		mov	ecx, dword_10037B68
		mov	edx, [ecx+254h]
		jmp	edx
; ---------------------------------------------------------------------------
		align 10h

loc_10022CF0:				; DATA XREF: sub_10007A40+127o
		cmp	dword_10037B68,	0
		jnz	short loc_10022D10
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jnz	short locret_10022D1E

loc_10022D10:				; CODE XREF: .text:10022CF7j
		mov	edx, dword_10037B68
		mov	eax, [edx+260h]
		jmp	eax
; ---------------------------------------------------------------------------

locret_10022D1E:			; CODE XREF: .text:10022D0Ej
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10022D20:				; DATA XREF: sub_10007A40+119o
		cmp	dword_10037B68,	0
		jnz	short loc_10022D44
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022D44
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022D44:				; CODE XREF: .text:10022D27j
					; .text:10022D3Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+264h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

loc_10022D60:				; DATA XREF: sub_10007A40+120o
		cmp	dword_10037B68,	0
		jnz	short loc_10022D84
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022D84
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022D84:				; CODE XREF: .text:10022D67j
					; .text:10022D7Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+268h]
		jmp	ecx
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022DA0	proc near		; CODE XREF: sub_10001000+1C8p
					; sub_10001710+E2p ...
		cmp	dword_10037B68,	0
		jnz	short loc_10022DC4
		push	offset sub_10022270
		push	offset dword_10037B58
		call	ds:PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_10022DC4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10022DC4:				; CODE XREF: sub_10022DA0+7j
					; sub_10022DA0+1Ej
		mov	eax, dword_10037B68
		mov	ecx, [eax+2BCh]
		jmp	ecx
sub_10022DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022DE0	proc near		; CODE XREF: sub_100240F0+2F9p
					; sub_100240F0+308p ...
		push	esi
		mov	esi, [eax+8]
		push	edi
		mov	edi, [eax+14h]
		mov	edx, ecx
		shr	edx, 8
		mov	[esi+edi], dl
		mov	edi, [eax+8]
		mov	esi, 1
		add	[eax+14h], esi
		mov	edx, [eax+14h]
		mov	[edx+edi], cl
		add	[eax+14h], esi
		pop	edi
		pop	esi
		retn
sub_10022DE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022E10	proc near		; CODE XREF: sub_100232F0+1A8p
					; sub_100234D0+2F0p ...
		push	esi
		mov	esi, eax
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+10h]
		push	edi
		mov	edi, [eax+14h]
		cmp	edi, ecx
		jbe	short loc_10022E23
		mov	edi, ecx

loc_10022E23:				; CODE XREF: sub_10022E10+Fj
		test	edi, edi
		jz	short loc_10022E5C
		mov	eax, [eax+10h]
		mov	ecx, [esi+0Ch]
		push	edi		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi+1Ch]
		add	[esi+0Ch], edi
		add	[eax+10h], edi
		add	[esi+14h], edi
		sub	[esi+10h], edi
		mov	eax, [esi+1Ch]
		sub	[eax+14h], edi
		mov	esi, [esi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [esi+14h], 0
		jnz	short loc_10022E5C
		mov	edx, [esi+8]
		mov	[esi+10h], edx

loc_10022E5C:				; CODE XREF: sub_10022E10+15j
					; sub_10022E10+44j
		pop	edi
		pop	esi
		retn
sub_10022E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022E60	proc near		; CODE XREF: .text:10004056p
					; sub_10024920+201p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	loc_10022F29
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	loc_10022F29
		push	edi
		mov	edi, [eax+4]
		cmp	edi, 2Ah
		jz	short loc_10022EAA
		cmp	edi, 45h
		jz	short loc_10022EAA
		cmp	edi, 49h
		jz	short loc_10022EAA
		cmp	edi, 5Bh
		jz	short loc_10022EAA
		cmp	edi, 67h
		jz	short loc_10022EAA
		cmp	edi, 71h
		jz	short loc_10022EAA
		cmp	edi, 29Ah
		jz	short loc_10022EAA
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10022EAA:				; CODE XREF: sub_10022E60+1Fj
					; sub_10022E60+24j ...
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_10022EBE
		mov	ecx, [esi+24h]
		push	eax
		mov	eax, [esi+28h]
		push	eax
		call	ecx
		add	esp, 8

loc_10022EBE:				; CODE XREF: sub_10022E60+4Fj
		mov	edx, [esi+1Ch]
		mov	eax, [edx+44h]
		test	eax, eax
		jz	short loc_10022ED5
		mov	ecx, [esi+24h]
		push	eax
		mov	eax, [esi+28h]
		push	eax
		call	ecx
		add	esp, 8

loc_10022ED5:				; CODE XREF: sub_10022E60+66j
		mov	edx, [esi+1Ch]
		mov	eax, [edx+40h]
		test	eax, eax
		jz	short loc_10022EEC
		mov	ecx, [esi+24h]
		push	eax
		mov	eax, [esi+28h]
		push	eax
		call	ecx
		add	esp, 8

loc_10022EEC:				; CODE XREF: sub_10022E60+7Dj
		mov	edx, [esi+1Ch]
		mov	eax, [edx+38h]
		test	eax, eax
		jz	short loc_10022F03
		mov	ecx, [esi+24h]
		push	eax
		mov	eax, [esi+28h]
		push	eax
		call	ecx
		add	esp, 8

loc_10022F03:				; CODE XREF: sub_10022E60+94j
		mov	edx, [esi+1Ch]
		mov	eax, [esi+28h]
		mov	ecx, [esi+24h]
		push	edx
		push	eax
		call	ecx
		add	esp, 8
		xor	eax, eax
		cmp	edi, 71h
		setnz	al
		pop	edi
		mov	dword ptr [esi+1Ch], 0
		pop	esi
		dec	eax
		and	eax, 0FFFFFFFDh
		retn
; ---------------------------------------------------------------------------

loc_10022F29:				; CODE XREF: sub_10022E60+7j
					; sub_10022E60+12j
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
sub_10022E60	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022F30	proc near		; CODE XREF: sub_10024060+7Bp
		mov	eax, [esi+2Ch]
		mov	ecx, [esi+4Ch]
		mov	edx, [esi+44h]
		add	eax, eax
		mov	[esi+3Ch], eax
		xor	eax, eax
		mov	[edx+ecx*2-2], ax
		mov	ecx, [esi+4Ch]
		mov	eax, [esi+44h]
		push	edi
		lea	edx, [ecx+ecx-2]
		push	edx		; Size
		xor	edi, edi
		push	edi		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [esi+84h]
		lea	eax, [eax+eax*2]
		add	eax, eax
		movzx	ecx, ds:word_100306D2[eax+eax]
		add	eax, eax
		mov	[esi+80h], ecx
		movzx	edx, ds:word_100306D0[eax]
		mov	[esi+8Ch], edx
		movzx	ecx, ds:word_100306D4[eax]
		mov	[esi+90h], ecx
		movzx	edx, ds:word_100306D6[eax]
		mov	eax, 2
		add	esp, 0Ch
		mov	[esi+6Ch], edi
		mov	[esi+5Ch], edi
		mov	[esi+74h], edi
		mov	[esi+68h], edi
		mov	[esi+48h], edi
		mov	[esi+7Ch], edx
		mov	[esi+78h], eax
		mov	[esi+60h], eax
		pop	edi
		retn
sub_10022F30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10022FC0	proc near		; CODE XREF: sub_100234D0+A3p
					; sub_100237F0+C3p

var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 14h
		mov	ecx, [edi+7Ch]
		mov	edx, [edi+6Ch]
		push	ebx
		push	ebp
		mov	ebp, [edi+78h]
		push	esi
		mov	esi, [edi+90h]
		mov	[esp+20h+var_10], ecx
		mov	ecx, [edi+38h]
		mov	[esp+20h+var_C], esi
		mov	esi, [edi+2Ch]
		lea	ebx, [esi-106h]
		add	ecx, edx
		cmp	edx, ebx
		jbe	short loc_10022FFD
		sub	edx, esi
		add	edx, 106h
		mov	[esp+20h+var_8], edx
		jmp	short loc_10023005
; ---------------------------------------------------------------------------

loc_10022FFD:				; CODE XREF: sub_10022FC0+2Dj
		mov	[esp+20h+var_8], 0

loc_10023005:				; CODE XREF: sub_10022FC0+3Bj
		movzx	edx, byte ptr [ecx+ebp-1]
		mov	[esp+20h+var_12], dl
		movzx	edx, byte ptr [ecx+ebp]
		lea	esi, [ecx+102h]
		mov	[esp+20h+var_11], dl
		cmp	ebp, [edi+8Ch]
		jb	short loc_10023029
		shr	[esp+20h+var_10], 2

loc_10023029:				; CODE XREF: sub_10022FC0+62j
		mov	edx, [edi+74h]
		cmp	[esp+20h+var_C], edx
		jbe	short loc_10023036
		mov	[esp+20h+var_C], edx

loc_10023036:				; CODE XREF: sub_10022FC0+70j
					; sub_10022FC0+144j
		mov	edx, [edi+38h]
		mov	bl, [esp+20h+var_11]
		add	edx, eax
		cmp	[edx+ebp], bl
		jnz	loc_100230EE
		mov	bl, [esp+20h+var_12]
		cmp	[edx+ebp-1], bl
		jnz	loc_100230EE
		mov	bl, [edx]
		cmp	bl, [ecx]
		jnz	loc_100230EE
		mov	bl, [edx+1]
		cmp	bl, [ecx+1]
		jnz	loc_100230EE
		add	ecx, 2
		add	edx, 2

loc_10023072:				; CODE XREF: sub_10022FC0+FEj
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+1]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+2]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+3]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+4]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+5]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+6]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		cmp	bl, [edx+7]
		jnz	short loc_100230C0
		mov	bl, [ecx+1]
		inc	ecx
		add	edx, 8
		cmp	bl, [edx]
		jnz	short loc_100230C0
		cmp	ecx, esi
		jb	short loc_10023072

loc_100230C0:				; CODE XREF: sub_10022FC0+B9j
					; sub_10022FC0+C2j ...
		mov	edx, ecx
		sub	edx, esi
		add	edx, 102h
		lea	ecx, [esi-102h]
		cmp	edx, ebp
		jle	short loc_100230EE
		mov	[edi+70h], eax
		mov	ebp, edx
		cmp	edx, [esp+20h+var_C]
		jge	short loc_1002310A
		mov	bl, [edx+ecx-1]
		mov	dl, [edx+ecx]
		mov	[esp+20h+var_12], bl
		mov	[esp+20h+var_11], dl

loc_100230EE:				; CODE XREF: sub_10022FC0+82j
					; sub_10022FC0+90j ...
		mov	edx, [edi+34h]
		and	edx, eax
		mov	eax, [edi+40h]
		movzx	eax, word ptr [eax+edx*2]
		cmp	eax, [esp+20h+var_8]
		jbe	short loc_1002310A
		dec	[esp+20h+var_10]
		jnz	loc_10023036

loc_1002310A:				; CODE XREF: sub_10022FC0+11Dj
					; sub_10022FC0+13Ej
		mov	eax, [edi+74h]
		cmp	ebp, eax
		ja	short loc_10023113
		mov	eax, ebp

loc_10023113:				; CODE XREF: sub_10022FC0+14Fj
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10022FC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10023120	proc near		; CODE XREF: sub_100232F0+29p
					; sub_100234D0+1Ap ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		push	ebx
		push	ebp
		mov	ebp, [esi+2Ch]
		push	edi
		lea	esp, [esp+0]

loc_10023130:				; CODE XREF: sub_10023120+13Cj
		mov	edi, [esi+3Ch]
		sub	edi, [esi+74h]
		mov	eax, [esi+6Ch]
		mov	ecx, [esi+2Ch]
		sub	edi, eax
		lea	edx, [ecx+ebp-106h]
		mov	[esp+14h+var_8], edi
		cmp	eax, edx
		jb	short loc_100231AD
		mov	eax, [esi+38h]
		push	ebp		; Size
		lea	ecx, [eax+ebp]
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		mov	edx, [esi+4Ch]
		mov	eax, [esi+44h]
		sub	[esi+70h], ebp
		sub	[esi+6Ch], ebp
		add	esp, 0Ch
		sub	[esi+5Ch], ebp
		lea	ecx, [eax+edx*2]

loc_10023170:				; CODE XREF: sub_10023120+65j
		movzx	eax, word ptr [ecx-2]
		sub	ecx, 2
		cmp	eax, ebp
		jb	short loc_1002317F
		sub	eax, ebp
		jmp	short loc_10023181
; ---------------------------------------------------------------------------

loc_1002317F:				; CODE XREF: sub_10023120+59j
		xor	eax, eax

loc_10023181:				; CODE XREF: sub_10023120+5Dj
		dec	edx
		mov	[ecx], ax
		jnz	short loc_10023170
		mov	ecx, [esi+40h]
		mov	edx, ebp
		lea	ecx, [ecx+ebp*2]
		nop

loc_10023190:				; CODE XREF: sub_10023120+85j
		movzx	eax, word ptr [ecx-2]
		sub	ecx, 2
		cmp	eax, ebp
		jb	short loc_1002319F
		sub	eax, ebp
		jmp	short loc_100231A1
; ---------------------------------------------------------------------------

loc_1002319F:				; CODE XREF: sub_10023120+79j
		xor	eax, eax

loc_100231A1:				; CODE XREF: sub_10023120+7Dj
		dec	edx
		mov	[ecx], ax
		jnz	short loc_10023190
		add	edi, ebp
		mov	[esp+14h+var_8], edi

loc_100231AD:				; CODE XREF: sub_10023120+2Bj
		mov	edi, [esi]
		cmp	dword ptr [edi+4], 0
		jz	loc_100232DA
		mov	eax, [esi+74h]
		add	eax, [esi+6Ch]
		mov	ecx, [edi+4]
		add	eax, [esi+38h]
		mov	edx, [esp+14h+var_8]
		mov	ebx, ecx
		mov	[esp+14h+var_4], eax
		cmp	ebx, edx
		jbe	short loc_100231D5
		mov	ebx, edx

loc_100231D5:				; CODE XREF: sub_10023120+B1j
		test	ebx, ebx
		jz	short loc_10023226
		mov	edx, [edi+1Ch]
		sub	ecx, ebx
		mov	[edi+4], ecx
		mov	ecx, [edx+18h]
		cmp	ecx, 1
		jnz	short loc_100231F8
		mov	eax, [edi]
		mov	ecx, [edi+30h]
		push	ebx
		push	eax
		push	ecx
		call	sub_10026480
		jmp	short loc_1002320A
; ---------------------------------------------------------------------------

loc_100231F8:				; CODE XREF: sub_10023120+C7j
		cmp	ecx, 2
		jnz	short loc_10023214
		mov	edx, [edi]
		mov	eax, [edi+30h]
		push	ebx
		push	edx
		push	eax
		call	sub_100269A0

loc_1002320A:				; CODE XREF: sub_10023120+D6j
		mov	[edi+30h], eax
		mov	eax, [esp+20h+var_4]
		add	esp, 0Ch

loc_10023214:				; CODE XREF: sub_10023120+DBj
		mov	ecx, [edi]
		push	ebx		; Size
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		add	[edi], ebx
		add	esp, 0Ch
		add	[edi+8], ebx

loc_10023226:				; CODE XREF: sub_10023120+B7j
		add	[esi+74h], ebx
		mov	ebx, [esi+74h]
		cmp	ebx, 3
		jb	short loc_1002324E
		mov	edx, [esi+6Ch]
		add	edx, [esi+38h]
		mov	ecx, [esi+58h]
		movzx	eax, byte ptr [edx]
		mov	[esi+48h], eax
		shl	eax, cl
		movzx	ecx, byte ptr [edx+1]
		xor	eax, ecx
		and	eax, [esi+54h]
		mov	[esi+48h], eax

loc_1002324E:				; CODE XREF: sub_10023120+10Fj
		cmp	ebx, 106h
		jnb	short loc_10023262
		mov	edx, [esi]
		cmp	dword ptr [edx+4], 0
		jnz	loc_10023130

loc_10023262:				; CODE XREF: sub_10023120+134j
		mov	eax, [esi+16C0h]
		mov	ecx, [esi+3Ch]
		cmp	eax, ecx
		jnb	short loc_100232DA
		mov	edi, [esi+6Ch]
		add	edi, ebx
		cmp	eax, edi
		jnb	short loc_100232A9
		sub	ecx, edi
		mov	ebx, ecx
		cmp	ebx, 102h
		jbe	short loc_10023289
		mov	ebx, 102h

loc_10023289:				; CODE XREF: sub_10023120+162j
		mov	eax, [esi+38h]
		push	ebx		; Size
		add	eax, edi
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		add	ebx, edi
		pop	edi
		pop	ebp
		mov	[esi+16C0h], ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100232A9:				; CODE XREF: sub_10023120+156j
		lea	edx, [edi+102h]
		cmp	eax, edx
		jnb	short loc_100232DA
		sub	edi, eax
		add	edi, 102h
		sub	ecx, eax
		cmp	edi, ecx
		jbe	short loc_100232C3
		mov	edi, ecx

loc_100232C3:				; CODE XREF: sub_10023120+19Fj
		mov	ecx, [esi+38h]
		push	edi		; Size
		add	ecx, eax
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch
		add	[esi+16C0h], edi

loc_100232DA:				; CODE XREF: sub_10023120+93j
					; sub_10023120+14Dj ...
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10023120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100232F0	proc near		; CODE XREF: sub_100240F0+697p
					; DATA XREF: .rdata:off_100306D8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+0Ch]
		add	eax, 0FFFFFFFBh
		push	edi
		mov	[esp+10h+var_4], 0FFFFh
		cmp	eax, 0FFFFh
		jnb	short loc_10023311
		mov	[esp+10h+var_4], eax

loc_10023311:				; CODE XREF: sub_100232F0+1Bj
					; sub_100232F0+ECj ...
		mov	eax, [esi+74h]
		cmp	eax, 1
		ja	short loc_10023329
		call	sub_10023120
		mov	eax, [esi+74h]
		test	eax, eax
		jz	loc_1002345F

loc_10023329:				; CODE XREF: sub_100232F0+27j
		add	[esi+6Ch], eax
		mov	ecx, [esi+5Ch]
		mov	eax, [esp+10h+var_4]
		mov	edx, [esi+6Ch]
		mov	dword ptr [esi+74h], 0
		lea	eax, [ecx+eax]
		jz	short loc_1002334A
		cmp	edx, eax
		jb	loc_100233CA

loc_1002334A:				; CODE XREF: sub_100232F0+50j
		sub	edx, eax
		mov	[esi+74h], edx
		mov	[esi+6Ch], eax
		test	ecx, ecx
		js	short loc_1002335D
		mov	edx, [esi+38h]
		add	edx, ecx
		jmp	short loc_1002335F
; ---------------------------------------------------------------------------

loc_1002335D:				; CODE XREF: sub_100232F0+64j
		xor	edx, edx

loc_1002335F:				; CODE XREF: sub_100232F0+6Bj
		push	0
		sub	eax, ecx
		push	eax
		push	edx
		push	esi
		call	sub_10028260
		mov	ecx, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], ecx
		mov	eax, [edi+1Ch]
		mov	ebx, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebx, ecx
		jbe	short loc_10023385
		mov	ebx, ecx

loc_10023385:				; CODE XREF: sub_100232F0+91j
		test	ebx, ebx
		jz	short loc_100233BE
		mov	edx, [eax+10h]
		mov	eax, [edi+0Ch]
		push	ebx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebx
		add	[eax+10h], ebx
		add	[edi+14h], ebx
		sub	[edi+10h], ebx
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebx
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_100233BE
		mov	ecx, [edi+8]
		mov	[edi+10h], ecx

loc_100233BE:				; CODE XREF: sub_100232F0+97j
					; sub_100232F0+C6j
		mov	edx, [esi]
		cmp	dword ptr [edx+10h], 0
		jz	loc_10023458

loc_100233CA:				; CODE XREF: sub_100232F0+54j
		mov	edx, [esi+5Ch]
		mov	ecx, [esi+6Ch]
		mov	eax, [esi+2Ch]
		sub	ecx, edx
		sub	eax, 106h
		cmp	ecx, eax
		jb	loc_10023311
		test	edx, edx
		js	short loc_100233ED
		mov	eax, [esi+38h]
		add	eax, edx
		jmp	short loc_100233EF
; ---------------------------------------------------------------------------

loc_100233ED:				; CODE XREF: sub_100232F0+F4j
		xor	eax, eax

loc_100233EF:				; CODE XREF: sub_100232F0+FBj
		push	0
		push	ecx
		push	eax
		push	esi
		call	sub_10028260
		mov	ecx, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], ecx
		mov	eax, [edi+1Ch]
		mov	ebx, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebx, ecx
		jbe	short loc_10023413
		mov	ebx, ecx

loc_10023413:				; CODE XREF: sub_100232F0+11Fj
		test	ebx, ebx
		jz	short loc_1002344C
		mov	edx, [eax+10h]
		mov	eax, [edi+0Ch]
		push	ebx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebx
		add	[eax+10h], ebx
		add	[edi+14h], ebx
		sub	[edi+10h], ebx
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebx
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_1002344C
		mov	ecx, [edi+8]
		mov	[edi+10h], ecx

loc_1002344C:				; CODE XREF: sub_100232F0+125j
					; sub_100232F0+154j
		mov	edx, [esi]
		cmp	dword ptr [edx+10h], 0
		jnz	loc_10023311

loc_10023458:				; CODE XREF: sub_100232F0+D4j
					; sub_100232F0+175j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1002345F:				; CODE XREF: sub_100232F0+33j
		mov	edi, [esp+10h+arg_4]
		test	edi, edi
		jz	short loc_10023458
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023475
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_10023477
; ---------------------------------------------------------------------------

loc_10023475:				; CODE XREF: sub_100232F0+17Cj
		xor	eax, eax

loc_10023477:				; CODE XREF: sub_100232F0+183j
		xor	edx, edx
		cmp	edi, 4
		setz	dl
		push	edx
		mov	edx, [esi+6Ch]
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	[esi+5Ch], eax
		mov	eax, [esi]
		add	esp, 10h
		call	sub_10022E10
		mov	ecx, [esi]
		xor	eax, eax
		cmp	[ecx+10h], eax
		jnz	short loc_100234B5
		cmp	edi, 4
		setnz	al
		pop	edi
		pop	esi
		pop	ebx
		dec	eax
		and	eax, 2
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100234B5:				; CODE XREF: sub_100232F0+1B4j
		cmp	edi, 4
		setz	al
		pop	edi
		pop	esi
		pop	ebx
		lea	eax, [eax+eax+1]
		pop	ecx
		retn
sub_100232F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100234D0	proc near		; DATA XREF: .rdata:100306E4o
					; .rdata:100306F0o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		mov	ebx, 1
		lea	ecx, [ecx+0]

loc_100234E0:				; CODE XREF: sub_100234D0+234j
					; sub_100234D0+2B2j
		mov	eax, [esi+74h]
		cmp	eax, 106h
		jnb	short loc_1002350D
		call	sub_10023120
		mov	eax, [esi+74h]
		mov	edi, [esp+10h+arg_4]
		cmp	eax, 106h
		jnb	short loc_10023505
		test	edi, edi
		jz	loc_10023788

loc_10023505:				; CODE XREF: sub_100234D0+2Bj
		test	eax, eax
		jz	loc_1002378F

loc_1002350D:				; CODE XREF: sub_100234D0+18j
		cmp	eax, 3
		jb	short loc_1002357B
		mov	eax, [esi+48h]
		mov	ecx, [esi+58h]
		mov	edx, [esi+6Ch]
		mov	edi, [esi+34h]
		shl	eax, cl
		mov	ecx, [esi+38h]
		movzx	ecx, byte ptr [ecx+edx+2]
		xor	eax, ecx
		and	eax, [esi+54h]
		mov	ecx, [esi+44h]
		and	edi, edx
		mov	edx, [esi+40h]
		mov	[esi+48h], eax
		mov	ax, [ecx+eax*2]
		mov	[edx+edi*2], ax
		mov	ecx, [esi+6Ch]
		and	ecx, [esi+34h]
		mov	edx, [esi+40h]
		movzx	eax, word ptr [edx+ecx*2]
		mov	ecx, [esi+48h]
		mov	edx, [esi+44h]
		mov	di, [esi+6Ch]
		mov	[edx+ecx*2], di
		test	eax, eax
		jz	short loc_1002357B
		mov	ecx, [esi+6Ch]
		mov	edx, [esi+2Ch]
		sub	ecx, eax
		sub	edx, 106h
		cmp	ecx, edx
		ja	short loc_1002357B
		mov	edi, esi
		call	sub_10022FC0
		mov	[esi+60h], eax

loc_1002357B:				; CODE XREF: sub_100234D0+40j
					; sub_100234D0+8Dj ...
		cmp	dword ptr [esi+60h], 3
		jb	loc_100236A5
		mov	cx, [esi+6Ch]
		sub	cx, [esi+70h]
		mov	edx, [esi+16A0h]
		mov	al, [esi+60h]
		mov	edi, [esi+16A4h]
		movzx	ecx, cx
		mov	[edi+edx*2], cx
		mov	edx, [esi+1698h]
		mov	edi, [esi+16A0h]
		sub	al, 3
		mov	[edx+edi], al
		add	[esi+16A0h], ebx
		movzx	eax, al
		movzx	edx, ds:byte_10033A28[eax]
		add	[esi+edx*4+498h], bx
		lea	eax, [esi+edx*4+498h]
		add	ecx, 0FFFFh
		mov	eax, 100h
		cmp	cx, ax
		jnb	short loc_100235EF
		movzx	ecx, cx
		movzx	eax, ds:byte_10033828[ecx]
		jmp	short loc_100235FC
; ---------------------------------------------------------------------------

loc_100235EF:				; CODE XREF: sub_100234D0+111j
		movzx	edx, cx
		shr	edx, 7
		movzx	eax, ds:byte_10033928[edx]

loc_100235FC:				; CODE XREF: sub_100234D0+11Dj
		add	[esi+eax*4+988h], bx
		mov	eax, [esi+169Ch]
		xor	ecx, ecx
		sub	eax, ebx
		cmp	[esi+16A0h], eax
		mov	eax, [esi+60h]
		setz	cl
		sub	[esi+74h], eax
		mov	edi, ecx
		mov	ecx, [esi+74h]
		cmp	eax, [esi+80h]
		ja	short loc_1002367C
		cmp	ecx, 3
		jb	short loc_1002367C
		dec	eax
		mov	[esi+60h], eax

loc_10023633:				; CODE XREF: sub_100234D0+1A5j
		add	[esi+6Ch], ebx
		mov	edx, [esi+6Ch]
		mov	ebp, [esi+48h]
		mov	ecx, [esi+58h]
		mov	eax, [esi+38h]
		movzx	eax, byte ptr [edx+eax+2]
		shl	ebp, cl
		mov	ecx, [esi+44h]
		xor	eax, ebp
		and	eax, [esi+54h]
		mov	ebp, [esi+34h]
		mov	[esi+48h], eax
		movzx	eax, word ptr [ecx+eax*2]
		and	ebp, edx
		mov	edx, [esi+40h]
		mov	[edx+ebp*2], ax
		movzx	eax, word ptr [esi+6Ch]
		mov	ecx, [esi+48h]
		mov	edx, [esi+44h]
		mov	[edx+ecx*2], ax
		dec	dword ptr [esi+60h]
		jnz	short loc_10023633
		jmp	loc_100236FF
; ---------------------------------------------------------------------------

loc_1002367C:				; CODE XREF: sub_100234D0+158j
					; sub_100234D0+15Dj
		add	[esi+6Ch], eax
		mov	edx, [esi+38h]
		add	edx, [esi+6Ch]
		mov	ecx, [esi+58h]
		mov	dword ptr [esi+60h], 0
		movzx	eax, byte ptr [edx]
		mov	[esi+48h], eax
		shl	eax, cl
		movzx	ecx, byte ptr [edx+1]
		xor	eax, ecx
		and	eax, [esi+54h]
		mov	[esi+48h], eax
		jmp	short loc_10023702
; ---------------------------------------------------------------------------

loc_100236A5:				; CODE XREF: sub_100234D0+AFj
		mov	edx, [esi+6Ch]
		mov	eax, [esi+38h]
		mov	al, [edx+eax]
		mov	ecx, [esi+16A0h]
		mov	edx, [esi+16A4h]
		xor	edi, edi
		mov	[edx+ecx*2], di
		mov	edx, [esi+16A0h]
		mov	ecx, [esi+1698h]
		mov	[ecx+edx], al
		add	[esi+16A0h], ebx
		movzx	eax, al
		add	[esi+eax*4+94h], bx
		mov	ecx, [esi+169Ch]
		lea	eax, [esi+eax*4+94h]
		xor	edx, edx
		sub	ecx, ebx
		cmp	[esi+16A0h], ecx
		setz	dl
		dec	dword ptr [esi+74h]
		mov	edi, edx

loc_100236FF:				; CODE XREF: sub_100234D0+1A7j
		add	[esi+6Ch], ebx

loc_10023702:				; CODE XREF: sub_100234D0+1D3j
		test	edi, edi
		jz	loc_100234E0
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023718
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_1002371A
; ---------------------------------------------------------------------------

loc_10023718:				; CODE XREF: sub_100234D0+23Fj
		xor	eax, eax

loc_1002371A:				; CODE XREF: sub_100234D0+246j
		mov	edx, [esi+6Ch]
		push	0
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], eax
		mov	eax, [edi+1Ch]
		mov	ebp, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebp, ecx
		jbe	short loc_10023743
		mov	ebp, ecx

loc_10023743:				; CODE XREF: sub_100234D0+26Fj
		test	ebp, ebp
		jz	short loc_1002377C
		mov	ecx, [eax+10h]
		mov	edx, [edi+0Ch]
		push	ebp		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebp
		add	[eax+10h], ebp
		add	[edi+14h], ebp
		sub	[edi+10h], ebp
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebp
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_1002377C
		mov	eax, [edi+8]
		mov	[edi+10h], eax

loc_1002377C:				; CODE XREF: sub_100234D0+275j
					; sub_100234D0+2A4j
		mov	ecx, [esi]
		cmp	dword ptr [ecx+10h], 0
		jnz	loc_100234E0

loc_10023788:				; CODE XREF: sub_100234D0+2Fj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1002378F:				; CODE XREF: sub_100234D0+37j
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_1002379D
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_1002379F
; ---------------------------------------------------------------------------

loc_1002379D:				; CODE XREF: sub_100234D0+2C4j
		xor	eax, eax

loc_1002379F:				; CODE XREF: sub_100234D0+2CBj
		xor	edx, edx
		cmp	edi, 4
		setz	dl
		push	edx
		mov	edx, [esi+6Ch]
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	[esi+5Ch], eax
		mov	eax, [esi]
		add	esp, 10h
		call	sub_10022E10
		mov	ecx, [esi]
		xor	eax, eax
		cmp	[ecx+10h], eax
		jnz	short loc_100237DD
		cmp	edi, 4
		setnz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		dec	eax
		and	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_100237DD:				; CODE XREF: sub_100234D0+2FCj
		cmp	edi, 4
		setz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		lea	eax, [eax+eax+1]
		retn
sub_100234D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100237F0	proc near		; DATA XREF: .rdata:10030708o
					; .rdata:10030714o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		mov	ebp, 1
		lea	ecx, [ecx+0]

loc_10023800:				; CODE XREF: sub_100237F0+215j
					; sub_100237F0:loc_10023A80j ...
		mov	ecx, [esi+74h]
		cmp	ecx, 106h
		jnb	short loc_1002382F
		call	sub_10023120
		mov	ecx, [esi+74h]
		mov	edi, [esp+10h+arg_4]
		cmp	ecx, 106h
		jnb	short loc_10023827
		test	edi, edi
		jz	loc_10023A86

loc_10023827:				; CODE XREF: sub_100237F0+2Dj
		test	ecx, ecx
		jz	loc_10023B7B

loc_1002382F:				; CODE XREF: sub_100237F0+19j
		xor	eax, eax
		cmp	ecx, 3
		jb	short loc_1002387F
		mov	eax, [esi+48h]
		mov	ecx, [esi+58h]
		mov	edx, [esi+6Ch]
		mov	edi, [esi+34h]
		shl	eax, cl
		mov	ecx, [esi+38h]
		movzx	ecx, byte ptr [ecx+edx+2]
		xor	eax, ecx
		and	eax, [esi+54h]
		mov	ecx, [esi+44h]
		and	edi, edx
		mov	edx, [esi+40h]
		mov	[esi+48h], eax
		mov	ax, [ecx+eax*2]
		mov	[edx+edi*2], ax
		mov	ecx, [esi+6Ch]
		and	ecx, [esi+34h]
		mov	edx, [esi+40h]
		movzx	eax, word ptr [edx+ecx*2]
		mov	ecx, [esi+48h]
		mov	edx, [esi+44h]
		mov	di, [esi+6Ch]
		mov	[edx+ecx*2], di

loc_1002387F:				; CODE XREF: sub_100237F0+44j
		mov	ecx, [esi+60h]
		mov	edx, [esi+70h]
		mov	ebx, 2
		mov	[esi+78h], ecx
		mov	[esi+64h], edx
		mov	[esi+60h], ebx
		test	eax, eax
		jz	short loc_100238DE
		cmp	ecx, [esi+80h]
		jnb	short loc_100238DE
		mov	edx, [esi+6Ch]
		mov	ecx, [esi+2Ch]
		sub	edx, eax
		sub	ecx, 106h
		cmp	edx, ecx
		ja	short loc_100238DE
		mov	edi, esi
		call	sub_10022FC0
		mov	[esi+60h], eax
		cmp	eax, 5
		ja	short loc_100238DE
		cmp	[esi+88h], ebp
		jz	short loc_100238DB
		cmp	eax, 3
		jnz	short loc_100238DE
		mov	edx, [esi+6Ch]
		sub	edx, [esi+70h]
		cmp	edx, 1000h
		jbe	short loc_100238DE

loc_100238DB:				; CODE XREF: sub_100237F0+D6j
		mov	[esi+60h], ebx

loc_100238DE:				; CODE XREF: sub_100237F0+A5j
					; sub_100237F0+ADj ...
		mov	eax, [esi+78h]
		cmp	eax, 3
		jb	loc_10023A8D
		cmp	[esi+60h], eax
		ja	loc_10023A8D
		mov	dx, [esi+6Ch]
		sub	dx, [esi+64h]
		mov	eax, [esi+6Ch]
		mov	ecx, [esi+74h]
		mov	ebx, [esi+16A4h]
		lea	edi, [eax+ecx-3]
		mov	al, [esi+78h]
		sub	dx, bp
		movzx	ecx, dx
		mov	edx, [esi+16A0h]
		mov	[ebx+edx*2], cx
		mov	edx, [esi+1698h]
		mov	ebx, [esi+16A0h]
		sub	al, 3
		mov	[edx+ebx], al
		add	[esi+16A0h], ebp
		movzx	eax, al
		movzx	edx, ds:byte_10033A28[eax]
		add	[esi+edx*4+498h], bp
		lea	eax, [esi+edx*4+498h]
		add	ecx, 0FFFFh
		mov	eax, 100h
		cmp	cx, ax
		jnb	short loc_1002396A
		movzx	ecx, cx
		movzx	eax, ds:byte_10033828[ecx]
		jmp	short loc_10023977
; ---------------------------------------------------------------------------

loc_1002396A:				; CODE XREF: sub_100237F0+16Cj
		movzx	edx, cx
		shr	edx, 7
		movzx	eax, ds:byte_10033928[edx]

loc_10023977:				; CODE XREF: sub_100237F0+178j
		add	[esi+eax*4+988h], bp
		mov	eax, [esi+169Ch]
		sub	eax, ebp
		xor	ebx, ebx
		cmp	[esi+16A0h], eax
		mov	eax, [esi+78h]
		setz	bl
		mov	ecx, ebp
		sub	ecx, eax
		add	[esi+74h], ecx
		add	eax, 0FFFFFFFEh
		mov	[esi+78h], eax

loc_100239A2:				; CODE XREF: sub_100237F0+1FDj
		add	[esi+6Ch], ebp
		mov	edx, [esi+6Ch]
		cmp	edx, edi
		ja	short loc_100239EA
		mov	eax, [esi+48h]
		mov	ecx, [esi+58h]
		mov	ebp, [esi+34h]
		shl	eax, cl
		mov	ecx, [esi+38h]
		movzx	ecx, byte ptr [ecx+edx+2]
		xor	eax, ecx
		and	eax, [esi+54h]
		mov	ecx, [esi+44h]
		mov	[esi+48h], eax
		movzx	eax, word ptr [ecx+eax*2]
		and	ebp, edx
		mov	edx, [esi+40h]
		mov	[edx+ebp*2], ax
		movzx	eax, word ptr [esi+6Ch]
		mov	ecx, [esi+48h]
		mov	edx, [esi+44h]
		mov	[edx+ecx*2], ax
		mov	ebp, 1

loc_100239EA:				; CODE XREF: sub_100237F0+1BAj
		dec	dword ptr [esi+78h]
		jnz	short loc_100239A2
		add	[esi+6Ch], ebp
		mov	eax, [esi+6Ch]
		mov	dword ptr [esi+68h], 0
		mov	dword ptr [esi+60h], 2
		test	ebx, ebx
		jz	loc_10023800
		mov	edx, [esi+5Ch]
		test	edx, edx
		js	short loc_10023A19
		mov	ecx, [esi+38h]
		add	ecx, edx
		jmp	short loc_10023A1B
; ---------------------------------------------------------------------------

loc_10023A19:				; CODE XREF: sub_100237F0+220j
		xor	ecx, ecx

loc_10023A1B:				; CODE XREF: sub_100237F0+227j
		push	0
		sub	eax, edx
		push	eax
		push	ecx
		push	esi
		call	sub_10028260
		mov	ecx, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], ecx
		mov	eax, [edi+1Ch]
		mov	ebx, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebx, ecx
		jbe	short loc_10023A41
		mov	ebx, ecx

loc_10023A41:				; CODE XREF: sub_100237F0+24Dj
		test	ebx, ebx
		jz	short loc_10023A7A
		mov	edx, [eax+10h]
		mov	eax, [edi+0Ch]
		push	ebx		; Size
		push	edx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebx
		add	[eax+10h], ebx
		add	[edi+14h], ebx
		sub	[edi+10h], ebx
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebx
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_10023A7A
		mov	ecx, [edi+8]
		mov	[edi+10h], ecx

loc_10023A7A:				; CODE XREF: sub_100237F0+253j
					; sub_100237F0+282j
		mov	edx, [esi]
		cmp	dword ptr [edx+10h], 0

loc_10023A80:				; CODE XREF: sub_100237F0+378j
		jnz	loc_10023800

loc_10023A86:				; CODE XREF: sub_100237F0+31j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10023A8D:				; CODE XREF: sub_100237F0+F4j
					; sub_100237F0+FDj
		cmp	dword ptr [esi+68h], 0
		jz	loc_10023B6D
		mov	eax, [esi+6Ch]
		mov	ecx, [esi+38h]
		mov	al, [eax+ecx-1]
		mov	edx, [esi+16A0h]
		mov	ecx, [esi+16A4h]
		xor	edi, edi
		mov	[ecx+edx*2], di
		mov	edx, [esi+1698h]
		mov	ecx, [esi+16A0h]
		mov	[edx+ecx], al
		add	[esi+16A0h], ebp
		movzx	edx, al
		add	[esi+edx*4+94h], bp
		lea	eax, [esi+edx*4+94h]
		mov	eax, [esi+169Ch]
		sub	eax, ebp
		cmp	[esi+16A0h], eax
		jnz	short loc_10023B5C
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023AF8
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_10023AFA
; ---------------------------------------------------------------------------

loc_10023AF8:				; CODE XREF: sub_100237F0+2FFj
		xor	eax, eax

loc_10023AFA:				; CODE XREF: sub_100237F0+306j
		mov	edx, [esi+6Ch]
		push	0
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], eax
		mov	eax, [edi+1Ch]
		mov	ebx, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebx, ecx
		jbe	short loc_10023B23
		mov	ebx, ecx

loc_10023B23:				; CODE XREF: sub_100237F0+32Fj
		test	ebx, ebx
		jz	short loc_10023B5C
		mov	ecx, [eax+10h]
		mov	edx, [edi+0Ch]
		push	ebx		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebx
		add	[eax+10h], ebx
		add	[edi+14h], ebx
		sub	[edi+10h], ebx
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebx
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_10023B5C
		mov	eax, [edi+8]
		mov	[edi+10h], eax

loc_10023B5C:				; CODE XREF: sub_100237F0+2F8j
					; sub_100237F0+335j ...
		mov	ecx, [esi]
		add	[esi+6Ch], ebp
		dec	dword ptr [esi+74h]
		cmp	dword ptr [ecx+10h], 0
		jmp	loc_10023A80
; ---------------------------------------------------------------------------

loc_10023B6D:				; CODE XREF: sub_100237F0+2A1j
		add	[esi+6Ch], ebp
		dec	dword ptr [esi+74h]
		mov	[esi+68h], ebp
		jmp	loc_10023800
; ---------------------------------------------------------------------------

loc_10023B7B:				; CODE XREF: sub_100237F0+39j
		cmp	dword ptr [esi+68h], 0
		jz	short loc_10023BC7
		mov	edx, [esi+6Ch]
		mov	eax, [esi+38h]
		mov	al, [edx+eax-1]
		mov	ecx, [esi+16A0h]
		mov	edx, [esi+16A4h]
		xor	ebx, ebx
		mov	[edx+ecx*2], bx
		mov	edx, [esi+16A0h]
		mov	ecx, [esi+1698h]
		mov	[ecx+edx], al
		add	[esi+16A0h], ebp
		movzx	eax, al
		add	[esi+eax*4+94h], bp
		lea	eax, [esi+eax*4+94h]
		mov	[esi+68h], ebx

loc_10023BC7:				; CODE XREF: sub_100237F0+38Fj
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023BD5
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_10023BD7
; ---------------------------------------------------------------------------

loc_10023BD5:				; CODE XREF: sub_100237F0+3DCj
		xor	eax, eax

loc_10023BD7:				; CODE XREF: sub_100237F0+3E3j
		xor	edx, edx
		cmp	edi, 4
		setz	dl
		push	edx
		mov	edx, [esi+6Ch]
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	[esi+5Ch], eax
		mov	eax, [esi]
		add	esp, 10h
		call	sub_10022E10
		mov	ecx, [esi]
		xor	eax, eax
		cmp	[ecx+10h], eax
		jnz	short loc_10023C15
		cmp	edi, 4
		setnz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		dec	eax
		and	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_10023C15:				; CODE XREF: sub_100237F0+414j
		cmp	edi, 4
		setz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		lea	eax, [eax+eax+1]
		retn
sub_100237F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10023C30	proc near		; CODE XREF: sub_100240F0+67Cp

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, eax
		mov	ebx, 1
		jmp	short loc_10023C40
; ---------------------------------------------------------------------------
		align 10h

loc_10023C40:				; CODE XREF: sub_10023C30+Bj
					; sub_10023C30+1CDj ...
		mov	edi, [esi+74h]
		cmp	edi, 102h
		jnb	short loc_10023C6F
		call	sub_10023120
		mov	edi, [esi+74h]
		mov	ebp, [esp+10h+arg_0]
		cmp	edi, 102h
		jnb	short loc_10023C67
		test	ebp, ebp
		jz	loc_10023E81

loc_10023C67:				; CODE XREF: sub_10023C30+2Dj
		test	edi, edi
		jz	loc_10023E88

loc_10023C6F:				; CODE XREF: sub_10023C30+19j
		mov	dword ptr [esi+60h], 0
		cmp	edi, 3
		jb	loc_10023D25
		mov	eax, [esi+6Ch]
		test	eax, eax
		jz	loc_10023D25
		mov	edx, [esi+38h]
		add	edx, eax
		movzx	ecx, byte ptr [edx-1]
		lea	eax, [edx-1]
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	loc_10023D25
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D25
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D25
		add	edx, 102h
		mov	edi, edi

loc_10023CC0:				; CODE XREF: sub_10023C30+E2j
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		movzx	ebp, byte ptr [eax+ebx]
		add	eax, ebx
		cmp	ecx, ebp
		jnz	short loc_10023D14
		cmp	eax, edx
		jb	short loc_10023CC0

loc_10023D14:				; CODE XREF: sub_10023C30+98j
					; sub_10023C30+A2j ...
		sub	eax, edx
		add	eax, 102h
		mov	[esi+60h], eax
		cmp	eax, edi
		jbe	short loc_10023D25
		mov	[esi+60h], edi

loc_10023D25:				; CODE XREF: sub_10023C30+49j
					; sub_10023C30+54j ...
		cmp	dword ptr [esi+60h], 3
		mov	edx, [esi+16A0h]
		jb	short loc_10023DA6
		mov	al, [esi+60h]
		mov	ecx, [esi+16A4h]
		sub	al, 3
		mov	edi, ebx
		mov	[ecx+edx*2], di
		mov	ecx, [esi+16A0h]
		mov	edx, [esi+1698h]
		mov	[edx+ecx], al
		add	[esi+16A0h], ebx
		movzx	edx, al
		movzx	eax, ds:byte_10033A28[edx]
		add	[esi+eax*4+498h], bx
		lea	eax, [esi+eax*4+498h]
		movzx	eax, ds:byte_10033828
		add	[esi+eax*4+988h], bx
		mov	ecx, [esi+169Ch]
		mov	eax, [esi+60h]
		sub	ecx, ebx
		xor	edx, edx
		cmp	[esi+16A0h], ecx
		mov	dword ptr [esi+60h], 0
		setz	dl
		sub	[esi+74h], eax
		add	[esi+6Ch], eax
		mov	ecx, edx
		jmp	short loc_10023DFB
; ---------------------------------------------------------------------------

loc_10023DA6:				; CODE XREF: sub_10023C30+FFj
		mov	ecx, [esi+6Ch]
		mov	eax, [esi+38h]
		mov	al, [eax+ecx]
		mov	ecx, [esi+16A4h]
		xor	edi, edi
		mov	[ecx+edx*2], di
		mov	ecx, [esi+16A0h]
		mov	edx, [esi+1698h]
		mov	[edx+ecx], al
		add	[esi+16A0h], ebx
		movzx	edx, al
		add	[esi+edx*4+94h], bx
		lea	eax, [esi+edx*4+94h]
		mov	eax, [esi+169Ch]
		sub	eax, ebx
		xor	ecx, ecx
		cmp	[esi+16A0h], eax
		setz	cl
		dec	dword ptr [esi+74h]
		add	[esi+6Ch], ebx

loc_10023DFB:				; CODE XREF: sub_10023C30+174j
		test	ecx, ecx
		jz	loc_10023C40
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023E11
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_10023E13
; ---------------------------------------------------------------------------

loc_10023E11:				; CODE XREF: sub_10023C30+1D8j
		xor	eax, eax

loc_10023E13:				; CODE XREF: sub_10023C30+1DFj
		mov	edx, [esi+6Ch]
		push	0
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], eax
		mov	eax, [edi+1Ch]
		mov	ebp, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebp, ecx
		jbe	short loc_10023E3C
		mov	ebp, ecx

loc_10023E3C:				; CODE XREF: sub_10023C30+208j
		test	ebp, ebp
		jz	short loc_10023E75
		mov	ecx, [eax+10h]
		mov	edx, [edi+0Ch]
		push	ebp		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebp
		add	[eax+10h], ebp
		add	[edi+14h], ebp
		sub	[edi+10h], ebp
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebp
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_10023E75
		mov	eax, [edi+8]
		mov	[edi+10h], eax

loc_10023E75:				; CODE XREF: sub_10023C30+20Ej
					; sub_10023C30+23Dj
		mov	ecx, [esi]
		cmp	dword ptr [ecx+10h], 0
		jnz	loc_10023C40

loc_10023E81:				; CODE XREF: sub_10023C30+31j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10023E88:				; CODE XREF: sub_10023C30+39j
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10023E96
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_10023E98
; ---------------------------------------------------------------------------

loc_10023E96:				; CODE XREF: sub_10023C30+25Dj
		xor	eax, eax

loc_10023E98:				; CODE XREF: sub_10023C30+264j
		xor	edx, edx
		cmp	ebp, 4
		setz	dl
		push	edx
		mov	edx, [esi+6Ch]
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	[esi+5Ch], eax
		mov	eax, [esi]
		add	esp, 10h
		call	sub_10022E10
		mov	ecx, [esi]
		xor	eax, eax
		cmp	[ecx+10h], eax
		jnz	short loc_10023ED6
		cmp	ebp, 4
		setnz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		dec	eax
		and	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_10023ED6:				; CODE XREF: sub_10023C30+295j
		cmp	ebp, 4
		setz	al
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		lea	eax, [eax+eax+1]
		retn
sub_10023C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10023EF0	proc near		; CODE XREF: sub_100240F0+66Bp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	esi, eax

loc_10023EF5:				; CODE XREF: sub_10023EF0+7Fj
					; sub_10023EF0+F6j
		cmp	dword ptr [esi+74h], 0
		jnz	short loc_10023F0A
		call	sub_10023120
		cmp	dword ptr [esi+74h], 0
		jz	loc_10023FF2

loc_10023F0A:				; CODE XREF: sub_10023EF0+9j
		mov	eax, [esi+6Ch]
		mov	ecx, [esi+38h]
		mov	edx, [esi+16A0h]
		mov	dword ptr [esi+60h], 0
		mov	al, [eax+ecx]
		mov	ecx, [esi+16A4h]
		xor	edi, edi
		mov	[ecx+edx*2], di
		mov	ecx, [esi+16A0h]
		mov	edx, [esi+1698h]
		mov	[edx+ecx], al
		movzx	edx, al
		mov	ecx, 1
		add	[esi+16A0h], ecx
		add	[esi+edx*4+94h], cx
		add	[esi+6Ch], ecx
		dec	dword ptr [esi+74h]
		lea	eax, [esi+edx*4+94h]
		mov	edx, [esi+169Ch]
		mov	eax, [esi+6Ch]
		sub	edx, ecx
		cmp	[esi+16A0h], edx
		jnz	short loc_10023EF5
		mov	edx, [esi+5Ch]
		test	edx, edx
		js	short loc_10023F7F
		mov	ecx, [esi+38h]
		add	ecx, edx
		jmp	short loc_10023F81
; ---------------------------------------------------------------------------

loc_10023F7F:				; CODE XREF: sub_10023EF0+86j
		xor	ecx, ecx

loc_10023F81:				; CODE XREF: sub_10023EF0+8Dj
		push	0
		sub	eax, edx
		push	eax
		push	ecx
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	edi, [esi]
		mov	[esi+5Ch], eax
		mov	eax, [edi+1Ch]
		mov	ebx, [eax+14h]
		mov	ecx, [edi+10h]
		add	esp, 10h
		cmp	ebx, ecx
		jbe	short loc_10023FA7
		mov	ebx, ecx

loc_10023FA7:				; CODE XREF: sub_10023EF0+B3j
		test	ebx, ebx
		jz	short loc_10023FE0
		mov	ecx, [eax+10h]
		mov	edx, [edi+0Ch]
		push	ebx		; Size
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [edi+1Ch]
		add	[edi+0Ch], ebx
		add	[eax+10h], ebx
		add	[edi+14h], ebx
		sub	[edi+10h], ebx
		mov	eax, [edi+1Ch]
		sub	[eax+14h], ebx
		mov	edi, [edi+1Ch]
		add	esp, 0Ch
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_10023FE0
		mov	eax, [edi+8]
		mov	[edi+10h], eax

loc_10023FE0:				; CODE XREF: sub_10023EF0+B9j
					; sub_10023EF0+E8j
		mov	ecx, [esi]
		cmp	dword ptr [ecx+10h], 0
		jnz	loc_10023EF5

loc_10023FEC:				; CODE XREF: sub_10023EF0+108j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10023FF2:				; CODE XREF: sub_10023EF0+14j
		mov	edi, [esp+0Ch+arg_0]
		test	edi, edi
		jz	short loc_10023FEC
		mov	ecx, [esi+5Ch]
		test	ecx, ecx
		js	short loc_10024008
		mov	eax, [esi+38h]
		add	eax, ecx
		jmp	short loc_1002400A
; ---------------------------------------------------------------------------

loc_10024008:				; CODE XREF: sub_10023EF0+10Fj
		xor	eax, eax

loc_1002400A:				; CODE XREF: sub_10023EF0+116j
		xor	edx, edx
		cmp	edi, 4
		setz	dl
		push	edx
		mov	edx, [esi+6Ch]
		sub	edx, ecx
		push	edx
		push	eax
		push	esi
		call	sub_10028260
		mov	eax, [esi+6Ch]
		mov	[esi+5Ch], eax
		mov	eax, [esi]
		add	esp, 10h
		call	sub_10022E10
		mov	ecx, [esi]
		xor	eax, eax
		cmp	[ecx+10h], eax
		jnz	short loc_10024047
		cmp	edi, 4
		setnz	al
		pop	edi
		pop	esi
		pop	ebx
		dec	eax
		and	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_10024047:				; CODE XREF: sub_10023EF0+147j
		cmp	edi, 4
		setz	al
		pop	edi
		pop	esi
		pop	ebx
		lea	eax, [eax+eax+1]
		retn
sub_10023EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024060	proc near		; CODE XREF: sub_10024920+1E4p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		xor	ebx, ebx
		cmp	edi, ebx
		jz	short loc_100240E6
		mov	esi, [edi+1Ch]
		cmp	esi, ebx
		jz	short loc_100240E6
		cmp	[edi+20h], ebx
		jz	short loc_100240E6
		cmp	[edi+24h], ebx
		jz	short loc_100240E6
		mov	[edi+14h], ebx
		mov	[edi+8], ebx
		mov	[edi+18h], ebx
		mov	dword ptr [edi+2Ch], 2
		mov	eax, [esi+8]
		mov	[esi+10h], eax
		mov	eax, [esi+18h]
		mov	[esi+14h], ebx
		cmp	eax, ebx
		jge	short loc_100240A3
		neg	eax
		mov	[esi+18h], eax

loc_100240A3:				; CODE XREF: sub_10024060+3Cj
		mov	eax, [esi+18h]
		mov	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 0FFFFFFB9h
		push	ebx
		add	ecx, 71h
		push	ebx
		mov	[esi+4], ecx
		push	ebx
		cmp	eax, 2
		jnz	short loc_100240C4
		call	sub_100269A0
		jmp	short loc_100240C9
; ---------------------------------------------------------------------------

loc_100240C4:				; CODE XREF: sub_10024060+5Bj
		call	sub_10026480

loc_100240C9:				; CODE XREF: sub_10024060+62j
		add	esp, 0Ch
		mov	[edi+30h], eax
		push	esi
		mov	[esi+28h], ebx
		call	sub_10027BE0
		add	esp, 4
		call	sub_10022F30
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100240E6:				; CODE XREF: sub_10024060+Bj
					; sub_10024060+12j ...
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
sub_10024060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100240F0	proc near		; CODE XREF: .text:10003FB5p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	loc_10024910
		mov	esi, [edi+1Ch]
		test	esi, esi
		jz	loc_10024910
		mov	ecx, [esp+8+arg_4]
		cmp	ecx, 5
		ja	loc_10024910
		cmp	dword ptr [edi+0Ch], 0
		jz	loc_10024908
		cmp	dword ptr [edi], 0
		jnz	short loc_1002412F
		cmp	dword ptr [edi+4], 0
		jnz	loc_10024908

loc_1002412F:				; CODE XREF: sub_100240F0+33j
		mov	eax, [esi+4]
		cmp	eax, 29Ah
		jnz	short loc_10024142
		cmp	ecx, 4
		jnz	loc_10024908

loc_10024142:				; CODE XREF: sub_100240F0+47j
		cmp	dword ptr [edi+10h], 0
		jnz	short loc_10024158
		mov	eax, ds:off_10033CB4
		mov	[edi+18h], eax
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024158:				; CODE XREF: sub_100240F0+56j
		mov	edx, [esi+28h]
		push	ebx
		push	ebp
		mov	[esi], edi
		mov	[esp+10h+arg_0], edx
		mov	[esi+28h], ecx
		mov	ebx, 1
		cmp	eax, 2Ah
		jnz	loc_10024417
		mov	eax, 2
		cmp	[esi+18h], eax
		jnz	loc_10024380
		push	0
		push	0
		push	0
		call	sub_100269A0
		mov	[edi+30h], eax
		mov	ecx, [esi+14h]
		mov	eax, [esi+8]
		mov	byte ptr [eax+ecx], 1Fh
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	byte ptr [eax+edx], 8Bh
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	byte ptr [eax+ecx], 8
		add	[esi+14h], ebx
		mov	eax, [esi+1Ch]
		mov	ebp, [esi+14h]
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10024251
		mov	edx, [esi+8]
		mov	[edx+ebp], al
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	byte ptr [eax+ecx], 0
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	byte ptr [eax+edx], 0
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	byte ptr [eax+ecx], 0
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	byte ptr [eax+edx], 0
		add	[esi+14h], ebx
		mov	eax, [esi+84h]
		mov	ecx, [esi+14h]
		cmp	eax, 9
		jnz	short loc_10024218
		lea	eax, [ebx+1]
		jmp	short loc_1002422F
; ---------------------------------------------------------------------------

loc_10024218:				; CODE XREF: sub_100240F0+121j
		cmp	dword ptr [esi+88h], 2
		jge	short loc_1002422A
		cmp	eax, 2
		jl	short loc_1002422A
		xor	eax, eax
		jmp	short loc_1002422F
; ---------------------------------------------------------------------------

loc_1002422A:				; CODE XREF: sub_100240F0+12Fj
					; sub_100240F0+134j
		mov	eax, 4

loc_1002422F:				; CODE XREF: sub_100240F0+126j
					; sub_100240F0+138j
		mov	edx, [esi+8]
		mov	[ecx+edx], al
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	byte ptr [eax+ecx], 0Bh
		add	[esi+14h], ebx
		mov	dword ptr [esi+4], 71h
		jmp	loc_10024417
; ---------------------------------------------------------------------------

loc_10024251:				; CODE XREF: sub_100240F0+D2j
		mov	edx, [eax+24h]
		mov	ecx, [eax+2Ch]
		neg	edx
		sbb	dl, dl
		and	dl, 10h
		neg	ecx
		sbb	cl, cl
		and	cl, 2
		add	dl, cl
		mov	ecx, [eax+1Ch]
		neg	ecx
		sbb	cl, cl
		and	cl, 8
		add	dl, cl
		mov	ecx, [eax+10h]
		neg	ecx
		sbb	cl, cl
		and	cl, 4
		add	dl, cl
		cmp	dword ptr [eax], 0
		mov	ecx, [esi+8]
		setnz	al
		add	dl, al
		mov	[ecx+ebp], dl
		add	[esi+14h], ebx
		mov	eax, [esi+14h]
		mov	edx, [esi+1Ch]
		movzx	edx, byte ptr [edx+4]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebx
		mov	ecx, [esi+1Ch]
		movzx	ecx, byte ptr [ecx+5]
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	[eax+edx], cl
		add	[esi+14h], ebx
		mov	edx, [esi+1Ch]
		movzx	edx, byte ptr [edx+6]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebx
		mov	ecx, [esi+1Ch]
		movzx	ecx, byte ptr [ecx+7]
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	[eax+edx], cl
		add	[esi+14h], ebx
		mov	eax, [esi+84h]
		mov	ecx, [esi+14h]
		cmp	eax, 9
		jnz	short loc_100242F1
		mov	eax, 2
		jmp	short loc_10024308
; ---------------------------------------------------------------------------

loc_100242F1:				; CODE XREF: sub_100240F0+1F8j
		cmp	dword ptr [esi+88h], 2
		jge	short loc_10024303
		cmp	eax, 2
		jl	short loc_10024303
		xor	eax, eax
		jmp	short loc_10024308
; ---------------------------------------------------------------------------

loc_10024303:				; CODE XREF: sub_100240F0+208j
					; sub_100240F0+20Dj
		mov	eax, 4

loc_10024308:				; CODE XREF: sub_100240F0+1FFj
					; sub_100240F0+211j
		mov	edx, [esi+8]
		mov	[ecx+edx], al
		add	[esi+14h], ebx
		mov	ecx, [esi+1Ch]
		mov	eax, [esi+14h]
		mov	cl, [ecx+0Ch]
		mov	edx, [esi+8]
		mov	[eax+edx], cl
		add	[esi+14h], ebx
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+10h], 0
		mov	ecx, [esi+14h]
		jz	short loc_10024350
		mov	al, [eax+14h]
		mov	edx, [esi+8]
		mov	[ecx+edx], al
		add	[esi+14h], ebx
		mov	ecx, [esi+1Ch]
		mov	cl, [ecx+15h]
		mov	eax, [esi+14h]
		mov	edx, [esi+8]
		mov	[eax+edx], cl
		add	[esi+14h], ebx
		mov	ecx, [esi+14h]

loc_10024350:				; CODE XREF: sub_100240F0+23Dj
		mov	edx, [esi+1Ch]
		cmp	dword ptr [edx+2Ch], 0
		jz	short loc_1002436D
		mov	eax, [esi+8]
		push	ecx
		mov	ecx, [edi+30h]
		push	eax
		push	ecx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_1002436D:				; CODE XREF: sub_100240F0+267j
		mov	dword ptr [esi+20h], 0
		mov	dword ptr [esi+4], 45h
		jmp	loc_10024417
; ---------------------------------------------------------------------------

loc_10024380:				; CODE XREF: sub_100240F0+8Cj
		mov	ecx, [esi+30h]
		sub	ecx, 8
		shl	ecx, 0Ch
		add	ecx, 800h
		cmp	[esi+88h], eax
		jge	short loc_100243B6
		mov	ebp, [esi+84h]
		cmp	ebp, eax
		jl	short loc_100243B6
		cmp	ebp, 6
		jge	short loc_100243AA
		mov	eax, ebx
		jmp	short loc_100243B8
; ---------------------------------------------------------------------------

loc_100243AA:				; CODE XREF: sub_100240F0+2B4j
		xor	edx, edx
		cmp	ebp, 6
		setnz	dl
		add	eax, edx
		jmp	short loc_100243B8
; ---------------------------------------------------------------------------

loc_100243B6:				; CODE XREF: sub_100240F0+2A5j
					; sub_100240F0+2AFj
		xor	eax, eax

loc_100243B8:				; CODE XREF: sub_100240F0+2B8j
					; sub_100240F0+2C4j
		shl	eax, 6
		or	ecx, eax
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_100243C6
		or	ecx, 20h

loc_100243C6:				; CODE XREF: sub_100240F0+2D1j
		mov	eax, 8421085h
		mul	ecx
		sub	ecx, edx
		shr	ecx, 1
		lea	eax, [edx+ecx]
		shr	eax, 4
		add	eax, ebx
		mov	ecx, eax
		shl	ecx, 5
		sub	ecx, eax
		mov	eax, esi
		mov	dword ptr [esi+4], 71h
		call	sub_10022DE0
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_10024406
		movzx	ecx, word ptr [edi+32h]
		call	sub_10022DE0
		movzx	ecx, word ptr [edi+30h]
		call	sub_10022DE0

loc_10024406:				; CODE XREF: sub_100240F0+302j
		push	0
		push	0
		push	0
		call	sub_10026480
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_10024417:				; CODE XREF: sub_100240F0+7Ej
					; sub_100240F0+15Cj ...
		cmp	dword ptr [esi+4], 45h
		jnz	loc_100244E8
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+10h], 0
		jz	loc_100244E1
		movzx	eax, word ptr [eax+14h]
		mov	ecx, [esi+14h]
		cmp	[esi+20h], eax
		jnb	short loc_100244A7
		lea	ebx, [ebx+0]

loc_10024440:				; CODE XREF: sub_100240F0+3B5j
		mov	eax, [esi+14h]
		cmp	eax, [esi+0Ch]
		jnz	short loc_1002447E
		mov	edx, [esi+1Ch]
		cmp	dword ptr [edx+2Ch], 0
		jz	short loc_1002446D
		cmp	eax, ecx
		jbe	short loc_1002446D
		sub	eax, ecx
		push	eax
		mov	eax, [esi+8]
		add	eax, ecx
		mov	ecx, [edi+30h]
		push	eax
		push	ecx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_1002446D:				; CODE XREF: sub_100240F0+35Fj
					; sub_100240F0+363j
		mov	eax, edi
		call	sub_10022E10
		mov	eax, [esi+14h]
		mov	ecx, eax
		cmp	eax, [esi+0Ch]
		jz	short loc_100244A7

loc_1002447E:				; CODE XREF: sub_100240F0+356j
		mov	edx, [esi+1Ch]
		mov	edx, [edx+10h]
		mov	ebx, [esi+20h]
		mov	dl, [edx+ebx]
		mov	ebp, [esi+8]
		mov	[eax+ebp], dl
		mov	eax, 1
		add	[esi+14h], eax
		add	[esi+20h], eax
		mov	eax, [esi+1Ch]
		movzx	edx, word ptr [eax+14h]
		cmp	[esi+20h], edx
		jb	short loc_10024440

loc_100244A7:				; CODE XREF: sub_100240F0+348j
					; sub_100240F0+38Cj
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_100244CF
		mov	eax, [esi+14h]
		cmp	eax, ecx
		jbe	short loc_100244CF
		mov	edx, [esi+8]
		sub	eax, ecx
		push	eax
		mov	eax, [edi+30h]
		add	edx, ecx
		push	edx
		push	eax
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_100244CF:				; CODE XREF: sub_100240F0+3BEj
					; sub_100240F0+3C5j
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+20h]
		cmp	edx, [ecx+14h]
		jnz	short loc_100244E8
		mov	dword ptr [esi+20h], 0

loc_100244E1:				; CODE XREF: sub_100240F0+338j
		mov	dword ptr [esi+4], 49h

loc_100244E8:				; CODE XREF: sub_100240F0+32Bj
					; sub_100240F0+3E8j
		cmp	dword ptr [esi+4], 49h
		mov	ebp, 5Bh
		jnz	loc_1002459C
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+1Ch], 0
		jz	loc_10024599
		mov	edx, [esi+14h]

loc_10024507:				; CODE XREF: sub_100240F0+471j
		mov	eax, [esi+14h]
		cmp	eax, [esi+0Ch]
		jnz	short loc_10024545
		mov	ecx, [esi+1Ch]
		cmp	dword ptr [ecx+2Ch], 0
		jz	short loc_10024534
		cmp	eax, edx
		jbe	short loc_10024534
		mov	ecx, [edi+30h]
		sub	eax, edx
		push	eax
		mov	eax, [esi+8]
		add	eax, edx
		push	eax
		push	ecx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_10024534:				; CODE XREF: sub_100240F0+426j
					; sub_100240F0+42Aj
		mov	eax, edi
		call	sub_10022E10
		mov	eax, [esi+14h]
		mov	edx, eax
		cmp	eax, [esi+0Ch]
		jz	short loc_10024565

loc_10024545:				; CODE XREF: sub_100240F0+41Dj
		mov	ecx, [esi+20h]
		mov	ebx, [esi+1Ch]
		mov	ebx, [ebx+1Ch]
		movzx	ebx, byte ptr [ebx+ecx]
		inc	ecx
		mov	[esi+20h], ecx
		mov	ecx, [esi+8]
		mov	[eax+ecx], bl
		inc	dword ptr [esi+14h]
		test	ebx, ebx
		jnz	short loc_10024507
		jmp	short loc_1002456A
; ---------------------------------------------------------------------------

loc_10024565:				; CODE XREF: sub_100240F0+453j
		mov	ebx, 1

loc_1002456A:				; CODE XREF: sub_100240F0+473j
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_10024592
		mov	eax, [esi+14h]
		cmp	eax, edx
		jbe	short loc_10024592
		mov	ecx, [esi+8]
		sub	eax, edx
		push	eax
		add	ecx, edx
		mov	edx, [edi+30h]
		push	ecx
		push	edx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_10024592:				; CODE XREF: sub_100240F0+481j
					; sub_100240F0+488j
		test	ebx, ebx
		jnz	short loc_1002459C
		mov	[esi+20h], ebx

loc_10024599:				; CODE XREF: sub_100240F0+40Ej
		mov	[esi+4], ebp

loc_1002459C:				; CODE XREF: sub_100240F0+401j
					; sub_100240F0+4A4j
		cmp	[esi+4], ebp
		jnz	loc_1002464B
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+24h], 0
		jz	loc_10024644
		mov	edx, [esi+14h]

loc_100245B5:				; CODE XREF: sub_100240F0+51Fj
		mov	eax, [esi+14h]
		cmp	eax, [esi+0Ch]
		jnz	short loc_100245F3
		mov	ecx, [esi+1Ch]
		cmp	dword ptr [ecx+2Ch], 0
		jz	short loc_100245E2
		cmp	eax, edx
		jbe	short loc_100245E2
		mov	ecx, [edi+30h]
		sub	eax, edx
		push	eax
		mov	eax, [esi+8]
		add	eax, edx
		push	eax
		push	ecx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_100245E2:				; CODE XREF: sub_100240F0+4D4j
					; sub_100240F0+4D8j
		mov	eax, edi
		call	sub_10022E10
		mov	eax, [esi+14h]
		mov	edx, eax
		cmp	eax, [esi+0Ch]
		jz	short loc_10024613

loc_100245F3:				; CODE XREF: sub_100240F0+4CBj
		mov	ecx, [esi+20h]
		mov	ebx, [esi+1Ch]
		mov	ebx, [ebx+24h]
		movzx	ebx, byte ptr [ebx+ecx]
		inc	ecx
		mov	[esi+20h], ecx
		mov	ecx, [esi+8]
		mov	[eax+ecx], bl
		inc	dword ptr [esi+14h]
		test	ebx, ebx
		jnz	short loc_100245B5
		jmp	short loc_10024618
; ---------------------------------------------------------------------------

loc_10024613:				; CODE XREF: sub_100240F0+501j
		mov	ebx, 1

loc_10024618:				; CODE XREF: sub_100240F0+521j
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_10024640
		mov	eax, [esi+14h]
		cmp	eax, edx
		jbe	short loc_10024640
		mov	ecx, [esi+8]
		sub	eax, edx
		push	eax
		add	ecx, edx
		mov	edx, [edi+30h]
		push	ecx
		push	edx
		call	sub_100269A0
		add	esp, 0Ch
		mov	[edi+30h], eax

loc_10024640:				; CODE XREF: sub_100240F0+52Fj
					; sub_100240F0+536j
		test	ebx, ebx
		jnz	short loc_1002464B

loc_10024644:				; CODE XREF: sub_100240F0+4BCj
		mov	dword ptr [esi+4], 67h

loc_1002464B:				; CODE XREF: sub_100240F0+4AFj
					; sub_100240F0+552j
		cmp	dword ptr [esi+4], 67h
		jnz	short loc_100246BA
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_100246B3
		mov	ecx, [esi+14h]
		add	ecx, 2
		cmp	ecx, [esi+0Ch]
		jbe	short loc_1002466C
		mov	eax, edi
		call	sub_10022E10

loc_1002466C:				; CODE XREF: sub_100240F0+573j
		mov	eax, [esi+14h]
		lea	edx, [eax+2]
		mov	ebp, 1
		cmp	edx, [esi+0Ch]
		ja	short loc_100246BF
		movzx	edx, byte ptr [edi+30h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+31h]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		push	0
		push	0
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		push	0
		call	sub_100269A0
		mov	[edi+30h], eax
		add	esp, 0Ch
		mov	dword ptr [esi+4], 71h
		jmp	short loc_100246BF
; ---------------------------------------------------------------------------

loc_100246B3:				; CODE XREF: sub_100240F0+568j
		mov	dword ptr [esi+4], 71h

loc_100246BA:				; CODE XREF: sub_100240F0+55Fj
		mov	ebp, 1

loc_100246BF:				; CODE XREF: sub_100240F0+58Aj
					; sub_100240F0+5C1j
		cmp	dword ptr [esi+14h], 0
		jz	short loc_100246E0
		mov	eax, edi
		call	sub_10022E10
		cmp	dword ptr [edi+10h], 0
		jnz	short loc_10024707

loc_100246D2:				; CODE XREF: sub_100240F0+725j
		mov	dword ptr [esi+28h], 0FFFFFFFFh

loc_100246D9:				; CODE XREF: sub_100240F0+72Ej
					; sub_100240F0+804j
		pop	ebp
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100246E0:				; CODE XREF: sub_100240F0+5D3j
		cmp	dword ptr [edi+4], 0
		mov	ebx, [esp+10h+arg_4]
		jnz	short loc_1002470B
		cmp	ebx, [esp+10h+arg_0]
		jg	short loc_1002470B
		cmp	ebx, 4
		jz	short loc_1002470B
		mov	eax, ds:off_10033CB4
		pop	ebp
		pop	ebx
		mov	[edi+18h], eax
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024707:				; CODE XREF: sub_100240F0+5E0j
		mov	ebx, [esp+10h+arg_4]

loc_1002470B:				; CODE XREF: sub_100240F0+5F8j
					; sub_100240F0+5FEj ...
		mov	eax, [esi+4]
		cmp	eax, 29Ah
		jnz	short loc_1002472E
		cmp	dword ptr [edi+4], 0
		jz	short loc_10024734
		mov	ecx, ds:off_10033CB4
		pop	ebp
		pop	ebx
		mov	[edi+18h], ecx
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002472E:				; CODE XREF: sub_100240F0+623j
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1002474D

loc_10024734:				; CODE XREF: sub_100240F0+629j
		cmp	dword ptr [esi+74h], 0
		jnz	short loc_1002474D
		test	ebx, ebx
		jz	loc_1002481B
		cmp	eax, 29Ah
		jz	loc_1002481B

loc_1002474D:				; CODE XREF: sub_100240F0+642j
					; sub_100240F0+648j
		mov	eax, [esi+88h]
		push	ebx
		cmp	eax, 2
		jnz	short loc_10024765
		mov	eax, esi
		call	sub_10023EF0
		add	esp, 4
		jmp	short loc_1002478C
; ---------------------------------------------------------------------------

loc_10024765:				; CODE XREF: sub_100240F0+667j
		cmp	eax, 3
		jnz	short loc_10024776
		mov	eax, esi
		call	sub_10023C30
		add	esp, 4
		jmp	short loc_1002478C
; ---------------------------------------------------------------------------

loc_10024776:				; CODE XREF: sub_100240F0+678j
		mov	eax, [esi+84h]
		lea	edx, [eax+eax*2]
		mov	eax, ds:off_100306D8[edx*4]
		push	esi
		call	eax ; sub_100232F0
		add	esp, 8

loc_1002478C:				; CODE XREF: sub_100240F0+673j
					; sub_100240F0+684j
		cmp	eax, 2
		jz	short loc_10024796
		cmp	eax, 3
		jnz	short loc_1002479D

loc_10024796:				; CODE XREF: sub_100240F0+69Fj
		mov	dword ptr [esi+4], 29Ah

loc_1002479D:				; CODE XREF: sub_100240F0+6A4j
		test	eax, eax
		jz	loc_100248F0
		cmp	eax, 2
		jz	loc_100248F0
		cmp	eax, ebp
		jnz	short loc_1002481B
		cmp	ebx, ebp
		jnz	short loc_100247C1
		push	esi
		call	sub_10028060
		add	esp, 4
		jmp	short loc_1002480A
; ---------------------------------------------------------------------------

loc_100247C1:				; CODE XREF: sub_100240F0+6C4j
		cmp	ebx, 5
		jz	short loc_1002480A
		push	0
		push	0
		push	0
		push	esi
		call	sub_10027FB0
		add	esp, 10h
		cmp	ebx, 3
		jnz	short loc_1002480A
		mov	ecx, [esi+4Ch]
		mov	edx, [esi+44h]
		xor	eax, eax
		mov	[edx+ecx*2-2], ax
		mov	ecx, [esi+4Ch]
		lea	edx, [ecx+ecx-2]
		push	edx		; Size
		push	eax		; Val
		mov	eax, [esi+44h]
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		cmp	dword ptr [esi+74h], 0
		jnz	short loc_1002480A
		xor	eax, eax
		mov	[esi+6Ch], eax
		mov	[esi+5Ch], eax

loc_1002480A:				; CODE XREF: sub_100240F0+6CFj
					; sub_100240F0+6D4j ...
		mov	eax, edi
		call	sub_10022E10
		cmp	dword ptr [edi+10h], 0
		jz	loc_100246D2

loc_1002481B:				; CODE XREF: sub_100240F0+64Cj
					; sub_100240F0+657j ...
		cmp	ebx, 4
		jnz	loc_100246D9
		mov	eax, [esi+18h]
		test	eax, eax
		jg	short loc_10024832
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024832:				; CODE XREF: sub_100240F0+739j
		cmp	eax, 2
		jnz	loc_100248BC
		mov	edx, [esi+14h]
		mov	al, [edi+30h]
		mov	ecx, [esi+8]
		mov	[ecx+edx], al
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+31h]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+32h]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+33h]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+8]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+9]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+0Ah]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		movzx	edx, byte ptr [edi+0Bh]
		mov	eax, [esi+14h]
		mov	ecx, [esi+8]
		mov	[eax+ecx], dl
		add	[esi+14h], ebp
		jmp	short loc_100248D0
; ---------------------------------------------------------------------------

loc_100248BC:				; CODE XREF: sub_100240F0+745j
		movzx	ecx, word ptr [edi+32h]
		mov	eax, esi
		call	sub_10022DE0
		movzx	ecx, word ptr [edi+30h]
		call	sub_10022DE0

loc_100248D0:				; CODE XREF: sub_100240F0+7CAj
		mov	eax, edi
		call	sub_10022E10
		mov	eax, [esi+18h]
		test	eax, eax
		jle	short loc_100248E3
		neg	eax
		mov	[esi+18h], eax

loc_100248E3:				; CODE XREF: sub_100240F0+7ECj
		pop	ebp
		xor	eax, eax
		cmp	[esi+14h], eax
		pop	ebx
		pop	edi
		setz	al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100248F0:				; CODE XREF: sub_100240F0+6AFj
					; sub_100240F0+6B8j
		cmp	dword ptr [edi+10h], 0
		jnz	loc_100246D9
		pop	ebp
		pop	ebx
		pop	edi
		mov	dword ptr [esi+28h], 0FFFFFFFFh
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024908:				; CODE XREF: sub_100240F0+2Aj
					; sub_100240F0+39j ...
		mov	eax, ds:off_10033CA8
		mov	[edi+18h], eax

loc_10024910:				; CODE XREF: sub_100240F0+8j
					; sub_100240F0+13j ...
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
sub_100240F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024920	proc near		; CODE XREF: sub_10024B50+1Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, [esp+arg_18]
		xor	ecx, ecx
		push	ebp
		mov	ebp, 1
		cmp	eax, ecx
		jz	loc_10024B3C
		cmp	byte ptr [eax],	31h
		jnz	loc_10024B3C
		cmp	[esp+4+arg_1C],	38h
		jnz	loc_10024B3C
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	edi, ecx
		jnz	short loc_10024957
		pop	edi
		lea	eax, [ebp-3]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024957:				; CODE XREF: sub_10024920+2Fj
		mov	[edi+18h], ecx
		cmp	[edi+20h], ecx
		jnz	short loc_10024969
		mov	dword ptr [edi+20h], offset loc_10028470
		mov	[edi+28h], ecx

loc_10024969:				; CODE XREF: sub_10024920+3Dj
		cmp	[edi+24h], ecx
		jnz	short loc_10024975
		mov	dword ptr [edi+24h], offset loc_10028490

loc_10024975:				; CODE XREF: sub_10024920+4Cj
		cmp	[esp+8+arg_4], 0FFFFFFFFh
		jnz	short loc_10024984
		mov	[esp+8+arg_4], 6

loc_10024984:				; CODE XREF: sub_10024920+5Aj
		push	ebx
		mov	ebx, [esp+0Ch+arg_C]
		cmp	ebx, ecx
		jge	short loc_10024993
		xor	ebp, ebp
		neg	ebx
		jmp	short loc_100249A0
; ---------------------------------------------------------------------------

loc_10024993:				; CODE XREF: sub_10024920+6Bj
		cmp	ebx, 0Fh
		jle	short loc_100249A0
		mov	ebp, 2
		sub	ebx, 10h

loc_100249A0:				; CODE XREF: sub_10024920+71j
					; sub_10024920+76j
		mov	eax, [esp+0Ch+arg_10]
		dec	eax
		cmp	eax, 8
		ja	loc_10024B33
		cmp	[esp+0Ch+arg_8], 8
		jnz	loc_10024B33
		lea	ecx, [ebx-8]
		cmp	ecx, 7
		ja	loc_10024B33
		cmp	[esp+0Ch+arg_4], 9
		ja	loc_10024B33
		cmp	[esp+0Ch+arg_14], 4
		ja	loc_10024B33
		cmp	ebx, 8
		jnz	short loc_100249E5
		mov	ebx, 9

loc_100249E5:				; CODE XREF: sub_10024920+BEj
		mov	edx, [edi+28h]
		mov	eax, [edi+20h]
		push	esi
		push	16C4h
		push	1
		push	edx
		call	eax
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	loc_10024B29
		mov	[edi+1Ch], esi
		mov	[esi+18h], ebp
		mov	ecx, ebx
		mov	ebp, 1
		shl	ebp, cl
		mov	[esi+30h], ebx
		mov	ebx, [esp+10h+arg_10]
		mov	eax, 1
		lea	ecx, [ebp-1]
		mov	[esi+34h], ecx
		lea	ecx, [ebx+7]
		shl	eax, cl
		mov	[esi+50h], ecx
		add	ecx, 2
		mov	[esi], edi
		mov	[esi+4Ch], eax
		dec	eax
		mov	[esi+54h], eax
		mov	eax, 0AAAAAAABh
		mul	ecx
		shr	edx, 1
		mov	dword ptr [esi+1Ch], 0
		mov	[esi+2Ch], ebp
		mov	[esi+58h], edx
		mov	edx, [edi+28h]
		mov	eax, [edi+20h]
		push	2
		push	ebp
		push	edx
		call	eax
		mov	ecx, [esi+2Ch]
		mov	[esi+38h], eax
		mov	edx, [edi+28h]
		mov	eax, [edi+20h]
		push	2
		push	ecx
		push	edx
		call	eax
		mov	ecx, [esi+4Ch]
		mov	[esi+40h], eax
		mov	edx, [edi+28h]
		mov	eax, [edi+20h]
		push	2
		push	ecx
		push	edx
		call	eax
		mov	[esi+44h], eax
		lea	ecx, [ebx+6]
		mov	eax, 1
		shl	eax, cl
		mov	dword ptr [esi+16C0h], 0
		push	4
		mov	[esi+169Ch], eax
		mov	ecx, [edi+28h]
		mov	edx, [edi+20h]
		push	eax
		push	ecx
		call	edx
		mov	ecx, [esi+169Ch]
		add	esp, 30h
		cmp	dword ptr [esi+38h], 0
		lea	edx, ds:0[ecx*4]
		mov	[esi+8], eax
		mov	[esi+0Ch], edx
		jz	short loc_10024B11
		cmp	dword ptr [esi+40h], 0
		jz	short loc_10024B11
		cmp	dword ptr [esi+44h], 0
		jz	short loc_10024B11
		test	eax, eax
		jz	short loc_10024B11
		mov	edx, ecx
		shr	edx, 1
		lea	edx, [eax+edx*2]
		lea	eax, [eax+ecx*2]
		add	eax, ecx
		mov	ecx, [esp+10h+arg_4]
		mov	[esi+16A4h], edx
		mov	edx, [esp+10h+arg_14]
		push	edi
		mov	[esi+1698h], eax
		mov	[esi+84h], ecx
		mov	[esi+88h], edx
		mov	byte ptr [esi+24h], 8
		call	sub_10024060
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024B11:				; CODE XREF: sub_10024920+1A1j
					; sub_10024920+1A7j ...
		mov	dword ptr [esi+4], 29Ah
		mov	eax, ds:off_10033CB0
		push	edi
		mov	[edi+18h], eax
		call	sub_10022E60
		add	esp, 4

loc_10024B29:				; CODE XREF: sub_10024920+DDj
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024B33:				; CODE XREF: sub_10024920+88j
					; sub_10024920+93j ...
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024B3C:				; CODE XREF: sub_10024920+Ej
					; sub_10024920+17j ...
		mov	eax, 0FFFFFFFAh
		pop	ebp
		retn
sub_10024920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024B50	proc near		; CODE XREF: sub_10004090+6Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	eax
		mov	eax, [esp+4+arg_0]
		push	ecx
		push	0
		push	8
		push	0Fh
		push	8
		push	edx
		push	eax
		call	sub_10024920
		add	esp, 20h
		retn
sub_10024B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024B80	proc near		; CODE XREF: sub_10024C00+6Ep

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	ecx, ecx
		cmp	edx, ecx
		jz	short loc_10024BEB
		mov	eax, [edx+1Ch]
		cmp	eax, ecx
		jz	short loc_10024BEB
		mov	[eax+1Ch], ecx
		mov	[edx+14h], ecx
		mov	[edx+8], ecx
		mov	[edx+18h], ecx
		mov	dword ptr [edx+30h], 1
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+20h], ecx
		mov	[eax+28h], ecx
		mov	[eax+2Ch], ecx
		mov	[eax+30h], ecx
		mov	[eax+38h], ecx
		mov	[eax+3Ch], ecx
		lea	ecx, [eax+530h]
		mov	dword ptr [eax+14h], 8000h
		mov	[eax+6Ch], ecx
		mov	[eax+50h], ecx
		mov	[eax+4Ch], ecx
		mov	dword ptr [eax+1BC0h], 1
		mov	dword ptr [eax+1BC4h], 0FFFFFFFFh
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10024BEB:				; CODE XREF: sub_10024B80+8j
					; sub_10024B80+Fj
		mov	eax, 0FFFFFFFEh
		retn
sub_10024B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024C00	proc near		; CODE XREF: sub_10024C90+80p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edi
		test	ebp, ebp
		jz	short loc_10024C7B
		mov	edi, [ebp+1Ch]
		test	edi, edi
		jz	short loc_10024C7B
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_4]
		test	esi, esi
		jns	short loc_10024C21
		xor	ebx, ebx
		neg	esi
		jmp	short loc_10024C2F
; ---------------------------------------------------------------------------

loc_10024C21:				; CODE XREF: sub_10024C00+19j
		mov	ebx, esi
		sar	ebx, 4
		inc	ebx
		cmp	esi, 30h
		jge	short loc_10024C2F
		and	esi, 0Fh

loc_10024C2F:				; CODE XREF: sub_10024C00+1Fj
					; sub_10024C00+2Aj
		test	esi, esi
		jz	short loc_10024C47
		cmp	esi, 8
		jl	short loc_10024C3D
		cmp	esi, 0Fh
		jle	short loc_10024C47

loc_10024C3D:				; CODE XREF: sub_10024C00+36j
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024C47:				; CODE XREF: sub_10024C00+31j
					; sub_10024C00+3Bj
		mov	eax, [edi+34h]
		test	eax, eax
		jz	short loc_10024C67
		cmp	[edi+24h], esi
		jz	short loc_10024C67
		mov	ecx, [ebp+24h]
		push	eax
		mov	eax, [ebp+28h]
		push	eax
		call	ecx
		add	esp, 8
		mov	dword ptr [edi+34h], 0

loc_10024C67:				; CODE XREF: sub_10024C00+4Cj
					; sub_10024C00+51j
		push	ebp
		mov	[edi+8], ebx
		mov	[edi+24h], esi
		call	sub_10024B80
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024C7B:				; CODE XREF: sub_10024C00+8j
					; sub_10024C00+Fj
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
sub_10024C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024C90	proc near		; CODE XREF: sub_10024D40+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		push	ebp
		xor	ebp, ebp
		cmp	eax, ebp
		jz	loc_10024D35
		cmp	byte ptr [eax],	31h
		jnz	loc_10024D35
		cmp	[esp+4+arg_C], 38h
		jnz	loc_10024D35
		push	esi
		mov	esi, [esp+8+arg_0]
		cmp	esi, ebp
		jnz	short loc_10024CC2
		pop	esi
		lea	eax, [ebp-2]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024CC2:				; CODE XREF: sub_10024C90+2Aj
		mov	[esi+18h], ebp
		cmp	[esi+20h], ebp
		jnz	short loc_10024CD4
		mov	dword ptr [esi+20h], offset loc_10028470
		mov	[esi+28h], ebp

loc_10024CD4:				; CODE XREF: sub_10024C90+38j
		cmp	[esi+24h], ebp
		jnz	short loc_10024CE0
		mov	dword ptr [esi+24h], offset loc_10028490

loc_10024CE0:				; CODE XREF: sub_10024C90+47j
		mov	eax, [esi+28h]
		mov	ecx, [esi+20h]
		push	edi
		push	1BCCh
		push	1
		push	eax
		call	ecx
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebp
		jnz	short loc_10024D03
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024D03:				; CODE XREF: sub_10024C90+68j
		mov	edx, [esp+0Ch+arg_4]
		push	ebx
		push	edx
		mov	[esi+1Ch], edi
		push	esi
		mov	[edi+34h], ebp
		call	sub_10024C00
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, ebp
		jz	short loc_10024D2E
		mov	eax, [esi+28h]
		mov	ecx, [esi+24h]
		push	edi
		push	eax
		call	ecx
		add	esp, 8
		mov	[esi+1Ch], ebp

loc_10024D2E:				; CODE XREF: sub_10024C90+8Cj
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024D35:				; CODE XREF: sub_10024C90+9j
					; sub_10024C90+12j ...
		mov	eax, 0FFFFFFFAh
		pop	ebp
		retn
sub_10024C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024D40	proc near		; CODE XREF: sub_10004090+8Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	eax
		push	ecx
		push	0Fh
		push	edx
		call	sub_10024C90
		add	esp, 10h
		retn
sub_10024D40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024D60	proc near		; CODE XREF: sub_10024E50+145Dp
		push	ebp
		push	esi
		mov	esi, [ebx+1Ch]
		xor	ebp, ebp
		push	edi
		mov	edi, eax
		cmp	[esi+34h], ebp
		jnz	short loc_10024D96
		mov	ecx, [esi+24h]
		mov	edx, [ebx+20h]
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [ebx+28h]
		push	1
		push	eax
		push	ecx
		call	edx
		add	esp, 0Ch
		mov	[esi+34h], eax
		cmp	eax, ebp
		jnz	short loc_10024D96
		pop	edi
		pop	esi
		lea	eax, [ebp+1]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024D96:				; CODE XREF: sub_10024D60+Dj
					; sub_10024D60+2Dj
		cmp	[esi+28h], ebp
		jnz	short loc_10024DAE
		mov	ecx, [esi+24h]
		mov	eax, 1
		shl	eax, cl
		mov	[esi+30h], ebp
		mov	[esi+2Ch], ebp
		mov	[esi+28h], eax

loc_10024DAE:				; CODE XREF: sub_10024D60+39j
		sub	edi, [ebx+10h]
		mov	eax, [esi+28h]
		cmp	edi, eax
		jb	short loc_10024DDA
		mov	ecx, [ebx+0Ch]
		mov	edx, [esi+34h]
		push	eax		; Size
		sub	ecx, eax
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [esi+28h]
		add	esp, 0Ch
		pop	edi
		mov	[esi+30h], ebp
		mov	[esi+2Ch], eax
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024DDA:				; CODE XREF: sub_10024D60+56j
		sub	eax, [esi+30h]
		mov	ebp, eax
		cmp	ebp, edi
		jbe	short loc_10024DE5
		mov	ebp, edi

loc_10024DE5:				; CODE XREF: sub_10024D60+81j
		mov	ecx, [ebx+0Ch]
		mov	edx, [esi+34h]
		add	edx, [esi+30h]
		push	ebp		; Size
		sub	ecx, edi
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		sub	edi, ebp
		jz	short loc_10024E21
		mov	eax, [ebx+0Ch]
		mov	ecx, [esi+34h]
		push	edi		; Size
		sub	eax, edi
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	edx, [esi+28h]
		add	esp, 0Ch
		mov	[esi+30h], edi
		pop	edi
		mov	[esi+2Ch], edx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024E21:				; CODE XREF: sub_10024D60+9Dj
		mov	eax, [esi+28h]
		add	[esi+30h], ebp
		cmp	[esi+30h], eax
		jnz	short loc_10024E33
		mov	dword ptr [esi+30h], 0

loc_10024E33:				; CODE XREF: sub_10024D60+CAj
		mov	ecx, [esi+2Ch]
		cmp	ecx, eax
		jnb	short loc_10024E3F
		add	ecx, ebp
		mov	[esi+2Ch], ecx

loc_10024E3F:				; CODE XREF: sub_10024D60+D8j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
sub_10024D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024E50	proc near		; CODE XREF: .text:10004015p

var_2C		= dword	ptr -2Ch
Size		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= word ptr -20h
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
Dst		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		sub	esp, 2Ch
		push	edi
		test	edx, edx
		jz	loc_10026391
		mov	edi, [edx+1Ch]
		test	edi, edi
		jz	loc_10026391
		cmp	dword ptr [edx+0Ch], 0
		jz	loc_10026391
		cmp	dword ptr [edx], 0
		jnz	short loc_10024E84
		cmp	dword ptr [edx+4], 0
		jnz	loc_10026391

loc_10024E84:				; CODE XREF: sub_10024E50+28j
		cmp	dword ptr [edi], 0Bh
		jnz	short loc_10024E8F
		mov	dword ptr [edi], 0Ch

loc_10024E8F:				; CODE XREF: sub_10024E50+37j
		mov	ecx, [edx+10h]
		mov	eax, [edx+0Ch]
		push	ebx
		mov	ebx, [edi+38h]
		push	ebp
		mov	ebp, [edx]
		mov	[esp+38h+var_24], ecx
		mov	[esp+38h+var_14], ecx
		mov	ecx, [edi]
		mov	[esp+38h+Dst], eax
		mov	eax, [edx+4]
		push	esi
		mov	esi, [edi+3Ch]
		mov	[esp+3Ch+var_2C], eax
		mov	[esp+3Ch+var_4], eax
		mov	[esp+3Ch+var_C], 0
		cmp	ecx, 1Eh	; switch 31 cases
		jbe	short loc_10024ED7
		mov	eax, 0FFFFFFFEh	; jumptable 10024ED7 default case

loc_10024ECB:				; CODE XREF: sub_10024E50+1522j
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10024ED3:				; CODE XREF: sub_10024E50+13CFj
		mov	edx, [esp+3Ch+arg_0]

loc_10024ED7:				; CODE XREF: sub_10024E50+74j
		jmp	ds:off_1002639C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10024EDE:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	dword ptr [edi+8], 0 ; jumptable 10024ED7 case 0
		jnz	short loc_10024EEF
		mov	dword ptr [edi], 0Ch
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10024EEF:				; CODE XREF: sub_10024E50+92j
		cmp	esi, 10h
		jnb	short loc_10024F14

loc_10024EF4:				; CODE XREF: sub_10024E50+C2j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 10h
		jb	short loc_10024EF4

loc_10024F14:				; CODE XREF: sub_10024E50+A2j
		test	byte ptr [edi+8], 2
		jz	short loc_10024F5E
		cmp	ebx, 8B1Fh
		jnz	short loc_10024F5E
		push	0
		push	0
		push	0
		call	sub_100269A0
		mov	[edi+18h], eax
		push	2
		lea	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+var_20], bx
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		call	sub_100269A0
		add	esp, 18h
		mov	[edi+18h], eax
		mov	eax, [esp+3Ch+var_2C]
		xor	ebx, ebx
		xor	esi, esi
		mov	dword ptr [edi], 1
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10024F5E:				; CODE XREF: sub_10024E50+C8j
					; sub_10024E50+D0j
		mov	eax, [edi+20h]
		mov	dword ptr [edi+10h], 0
		test	eax, eax
		jz	short loc_10024F73
		mov	dword ptr [eax+30h], 0FFFFFFFFh

loc_10024F73:				; CODE XREF: sub_10024E50+11Aj
		test	byte ptr [edi+8], 1
		jz	loc_10025025
		movzx	eax, bl
		shl	eax, 8
		mov	edx, ebx
		shr	edx, 8
		add	eax, edx
		xor	edx, edx
		mov	ecx, 1Fh
		div	ecx
		test	edx, edx
		jnz	loc_10025025
		mov	edx, ebx
		and	dl, 0Fh
		cmp	dl, 8
		jz	short loc_10024FB9
		mov	eax, [esp+3Ch+arg_0]
		mov	dword ptr [eax+18h], offset aUnknownCompres ; "unknown compression method"
		mov	eax, [esp+3Ch+var_2C]
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10024FB9:				; CODE XREF: sub_10024E50+153j
		mov	eax, [edi+24h]
		shr	ebx, 4
		mov	ecx, ebx
		and	ecx, 0Fh
		sub	esi, 4
		add	ecx, 8
		test	eax, eax
		jnz	short loc_1002500D
		mov	[edi+24h], ecx

loc_10024FD1:				; CODE XREF: sub_10024E50+1BFj
		mov	edx, 1
		shl	edx, cl
		push	0
		push	0
		push	0
		mov	[edi+14h], edx
		call	sub_10026480
		mov	ecx, [esp+48h+arg_0]
		shr	ebx, 8
		not	ebx
		and	ebx, 2
		or	ebx, 9
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		mov	eax, [esp+48h+var_2C]
		mov	[edi], ebx
		add	esp, 0Ch
		xor	ebx, ebx
		xor	esi, esi
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_1002500D:				; CODE XREF: sub_10024E50+17Cj
		cmp	ecx, eax
		jbe	short loc_10024FD1
		mov	ecx, [esp+3Ch+arg_0]
		mov	eax, [esp+3Ch+var_2C]
		mov	dword ptr [ecx+18h], offset aInvalidWindowS ; "invalid window size"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025025:				; CODE XREF: sub_10024E50+127j
					; sub_10024E50+145j
		mov	edx, [esp+3Ch+arg_0]
		mov	eax, [esp+3Ch+var_2C]
		mov	dword ptr [edx+18h], offset aIncorrectHeade ; "incorrect header	check"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025039:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	esi, 10h	; jumptable 10024ED7 case 1
		jnb	short loc_10025060
		mov	edi, edi

loc_10025040:				; CODE XREF: sub_10024E50+20Ej
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 10h
		jb	short loc_10025040

loc_10025060:				; CODE XREF: sub_10024E50+1ECj
		mov	[edi+10h], ebx
		cmp	bl, 8
		jz	short loc_10025078
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aUnknownCompres ; "unknown compression method"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025078:				; CODE XREF: sub_10024E50+216j
		test	ebx, 0E000h
		jz	short loc_10025090
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aUnknownHeaderF ; "unknown header flags set"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025090:				; CODE XREF: sub_10024E50+22Ej
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_100250A1
		mov	edx, ebx
		shr	edx, 8
		and	edx, 1
		mov	[ecx], edx

loc_100250A1:				; CODE XREF: sub_10024E50+245j
		test	dword ptr [edi+10h], 200h
		jz	short loc_100250CF
		mov	byte ptr [esp+3Ch+var_20], bl
		shr	ebx, 8
		push	2
		lea	eax, [esp+40h+var_20]
		mov	byte ptr [esp+40h+var_20+1], bl
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_100250CF:				; CODE XREF: sub_10024E50+258j
		xor	ebx, ebx
		xor	esi, esi
		mov	dword ptr [edi], 2
		jmp	short loc_100250E0
; ---------------------------------------------------------------------------

loc_100250DB:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	esi, 20h	; jumptable 10024ED7 case 2
		jnb	short loc_10025100

loc_100250E0:				; CODE XREF: sub_10024E50+289j
					; sub_10024E50+2AEj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 20h
		jb	short loc_100250E0

loc_10025100:				; CODE XREF: sub_10024E50+28Ej
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_1002510A
		mov	[ecx+4], ebx

loc_1002510A:				; CODE XREF: sub_10024E50+2B5j
		test	dword ptr [edi+10h], 200h
		jz	short loc_1002514A
		mov	byte ptr [esp+3Ch+var_20], bl
		mov	eax, ebx
		mov	ecx, ebx
		shr	eax, 8
		shr	ecx, 10h
		shr	ebx, 18h
		push	4
		lea	edx, [esp+40h+var_20]
		mov	byte ptr [esp+40h+var_20+1], al
		mov	[esp+40h+var_1E], cl
		mov	[esp+40h+var_1D], bl
		mov	eax, [edi+18h]
		push	edx
		push	eax
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_1002514A:				; CODE XREF: sub_10024E50+2C1j
		xor	ebx, ebx
		xor	esi, esi
		mov	dword ptr [edi], 3
		jmp	short loc_10025160
; ---------------------------------------------------------------------------

loc_10025156:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	esi, 10h	; jumptable 10024ED7 case 3
		jnb	short loc_10025180
		jmp	short loc_10025160
; ---------------------------------------------------------------------------
		align 10h

loc_10025160:				; CODE XREF: sub_10024E50+304j
					; sub_10024E50+30Bj ...
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 10h
		jb	short loc_10025160

loc_10025180:				; CODE XREF: sub_10024E50+309j
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_1002519D
		mov	edx, ebx
		and	edx, 0FFh
		mov	[ecx+8], edx
		mov	edx, [edi+20h]
		mov	ecx, ebx
		shr	ecx, 8
		mov	[edx+0Ch], ecx

loc_1002519D:				; CODE XREF: sub_10024E50+335j
		test	dword ptr [edi+10h], 200h
		jz	short loc_100251CB
		mov	byte ptr [esp+3Ch+var_20], bl
		shr	ebx, 8
		push	2
		lea	eax, [esp+40h+var_20]
		mov	byte ptr [esp+40h+var_20+1], bl
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_100251CB:				; CODE XREF: sub_10024E50+354j
		xor	ebx, ebx
		xor	esi, esi
		mov	dword ptr [edi], 4

loc_100251D5:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		test	dword ptr [edi+10h], 400h ; jumptable 10024ED7 case 4
		jz	short loc_10025244
		cmp	esi, 10h
		jnb	short loc_10025203

loc_100251E3:				; CODE XREF: sub_10024E50+3B1j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 10h
		jb	short loc_100251E3

loc_10025203:				; CODE XREF: sub_10024E50+391j
		mov	ecx, [edi+20h]
		mov	[edi+40h], ebx
		test	ecx, ecx
		jz	short loc_10025210
		mov	[ecx+14h], ebx

loc_10025210:				; CODE XREF: sub_10024E50+3BBj
		test	dword ptr [edi+10h], 200h
		jz	short loc_1002523E
		mov	byte ptr [esp+3Ch+var_20], bl
		shr	ebx, 8
		push	2
		lea	eax, [esp+40h+var_20]
		mov	byte ptr [esp+40h+var_20+1], bl
		mov	ecx, [edi+18h]
		push	eax
		push	ecx
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_1002523E:				; CODE XREF: sub_10024E50+3C7j
		xor	ebx, ebx
		xor	esi, esi
		jmp	short loc_10025252
; ---------------------------------------------------------------------------

loc_10025244:				; CODE XREF: sub_10024E50+38Cj
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_10025252
		mov	dword ptr [ecx+10h], 0

loc_10025252:				; CODE XREF: sub_10024E50+3F2j
					; sub_10024E50+3F9j
		mov	dword ptr [edi], 5

loc_10025258:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		test	dword ptr [edi+10h], 400h ; jumptable 10024ED7 case 5
		jz	loc_10025301
		mov	ecx, [edi+40h]
		mov	[esp+3Ch+Size],	ecx
		cmp	ecx, eax
		jbe	short loc_10025276
		mov	ecx, eax
		mov	[esp+3Ch+Size],	eax

loc_10025276:				; CODE XREF: sub_10024E50+41Ej
		test	ecx, ecx
		jz	short loc_100252F7
		mov	edx, [edi+20h]
		test	edx, edx
		jz	short loc_100252C6
		mov	edx, [edx+10h]
		mov	[esp+3Ch+var_8], edx
		test	edx, edx
		jz	short loc_100252C6
		mov	eax, [edi+20h]
		mov	eax, [eax+14h]
		sub	eax, [edi+40h]
		mov	edx, [edi+20h]
		mov	edx, [edx+18h]
		mov	[esp+3Ch+var_18], eax
		add	eax, ecx
		cmp	eax, edx
		jbe	short loc_100252AB
		sub	edx, [esp+3Ch+var_18]
		mov	ecx, edx

loc_100252AB:				; CODE XREF: sub_10024E50+453j
		push	ecx		; Size
		mov	ecx, [esp+40h+var_8]
		add	ecx, [esp+40h+var_18]
		push	ebp		; Src
		push	ecx		; Dst
		call	memcpy
		mov	ecx, [esp+48h+Size]
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_100252C6:				; CODE XREF: sub_10024E50+42Fj
					; sub_10024E50+43Aj
		test	dword ptr [edi+10h], 200h
		jz	short loc_100252EC
		mov	eax, [esp+3Ch+Size]
		mov	ecx, [edi+18h]
		push	eax
		push	ebp
		push	ecx
		call	sub_100269A0
		mov	ecx, [esp+48h+Size]
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_100252EC:				; CODE XREF: sub_10024E50+47Dj
		sub	eax, ecx
		add	ebp, ecx
		sub	[edi+40h], ecx
		mov	[esp+3Ch+var_2C], eax

loc_100252F7:				; CODE XREF: sub_10024E50+428j
		cmp	dword ptr [edi+40h], 0
		jnz	loc_10026274

loc_10025301:				; CODE XREF: sub_10024E50+40Fj
		mov	dword ptr [edi+40h], 0
		mov	dword ptr [edi], 6

loc_1002530E:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		test	dword ptr [edi+10h], 800h ; jumptable 10024ED7 case 6
		jz	loc_100253A8
		test	eax, eax
		jz	loc_10026274
		xor	ecx, ecx

loc_10025325:				; CODE XREF: sub_10024E50+51Bj
		movzx	edx, byte ptr [ecx+ebp]
		inc	ecx
		mov	[esp+3Ch+Size],	ecx
		mov	ecx, [edi+20h]
		mov	[esp+3Ch+var_18], edx
		test	ecx, ecx
		jz	short loc_1002535E
		mov	edx, [ecx+1Ch]
		mov	[esp+3Ch+var_8], edx
		test	edx, edx
		jz	short loc_1002535E
		mov	edx, [edi+40h]
		cmp	edx, [ecx+20h]
		jnb	short loc_1002535E
		mov	eax, [esp+3Ch+var_8]
		mov	cl, byte ptr [esp+3Ch+var_18]
		mov	[eax+edx], cl
		inc	dword ptr [edi+40h]
		mov	eax, [esp+3Ch+var_2C]

loc_1002535E:				; CODE XREF: sub_10024E50+4E7j
					; sub_10024E50+4F2j ...
		cmp	[esp+3Ch+var_18], 0
		jz	short loc_1002536D
		mov	ecx, [esp+3Ch+Size]
		cmp	ecx, eax
		jb	short loc_10025325

loc_1002536D:				; CODE XREF: sub_10024E50+513j
		test	dword ptr [edi+10h], 200h
		jz	short loc_1002538F
		mov	edx, [esp+3Ch+Size]
		mov	eax, [edi+18h]
		push	edx
		push	ebp
		push	eax
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_1002538F:				; CODE XREF: sub_10024E50+524j
		mov	ecx, [esp+3Ch+Size]
		sub	eax, ecx
		add	ebp, ecx
		cmp	[esp+3Ch+var_18], 0
		mov	[esp+3Ch+var_2C], eax
		jnz	loc_10026274
		jmp	short loc_100253B6
; ---------------------------------------------------------------------------

loc_100253A8:				; CODE XREF: sub_10024E50+4C5j
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_100253B6
		mov	dword ptr [ecx+1Ch], 0

loc_100253B6:				; CODE XREF: sub_10024E50+556j
					; sub_10024E50+55Dj
		mov	dword ptr [edi+40h], 0
		mov	dword ptr [edi], 7

loc_100253C3:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		test	dword ptr [edi+10h], 1000h ; jumptable 10024ED7	case 7
		jz	loc_10025463
		test	eax, eax
		jz	loc_10026274
		xor	ecx, ecx
		lea	ebx, [ebx+0]

loc_100253E0:				; CODE XREF: sub_10024E50+5D6j
		movzx	edx, byte ptr [ecx+ebp]
		inc	ecx
		mov	[esp+3Ch+Size],	ecx
		mov	ecx, [edi+20h]
		mov	[esp+3Ch+var_18], edx
		test	ecx, ecx
		jz	short loc_10025419
		mov	edx, [ecx+24h]
		mov	[esp+3Ch+var_8], edx
		test	edx, edx
		jz	short loc_10025419
		mov	edx, [edi+40h]
		cmp	edx, [ecx+28h]
		jnb	short loc_10025419
		mov	eax, [esp+3Ch+var_8]
		mov	cl, byte ptr [esp+3Ch+var_18]
		mov	[eax+edx], cl
		inc	dword ptr [edi+40h]
		mov	eax, [esp+3Ch+var_2C]

loc_10025419:				; CODE XREF: sub_10024E50+5A2j
					; sub_10024E50+5ADj ...
		cmp	[esp+3Ch+var_18], 0
		jz	short loc_10025428
		mov	ecx, [esp+3Ch+Size]
		cmp	ecx, eax
		jb	short loc_100253E0

loc_10025428:				; CODE XREF: sub_10024E50+5CEj
		test	dword ptr [edi+10h], 200h
		jz	short loc_1002544A
		mov	edx, [esp+3Ch+Size]
		mov	eax, [edi+18h]
		push	edx
		push	ebp
		push	eax
		call	sub_100269A0
		mov	[edi+18h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_1002544A:				; CODE XREF: sub_10024E50+5DFj
		mov	ecx, [esp+3Ch+Size]
		sub	eax, ecx
		add	ebp, ecx
		cmp	[esp+3Ch+var_18], 0
		mov	[esp+3Ch+var_2C], eax
		jnz	loc_10026274
		jmp	short loc_10025471
; ---------------------------------------------------------------------------

loc_10025463:				; CODE XREF: sub_10024E50+57Aj
		mov	ecx, [edi+20h]
		test	ecx, ecx
		jz	short loc_10025471
		mov	dword ptr [ecx+24h], 0

loc_10025471:				; CODE XREF: sub_10024E50+611j
					; sub_10024E50+618j
		mov	dword ptr [edi], 8

loc_10025477:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		test	dword ptr [edi+10h], 200h ; jumptable 10024ED7 case 8
		jz	short loc_100254C1
		cmp	esi, 10h
		jnb	short loc_100254A5

loc_10025485:				; CODE XREF: sub_10024E50+653j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 10h
		jb	short loc_10025485

loc_100254A5:				; CODE XREF: sub_10024E50+633j
		movzx	ecx, word ptr [edi+18h]
		cmp	ebx, ecx
		jz	short loc_100254BD
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aHeaderCrcMisma ; "header crc mismatch"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_100254BD:				; CODE XREF: sub_10024E50+65Bj
		xor	ebx, ebx
		xor	esi, esi

loc_100254C1:				; CODE XREF: sub_10024E50+62Ej
		mov	eax, [edi+20h]
		test	eax, eax
		jz	short loc_100254DE
		mov	ecx, [edi+10h]
		sar	ecx, 9
		and	ecx, 1
		mov	[eax+2Ch], ecx
		mov	edx, [edi+20h]
		mov	dword ptr [edx+30h], 1

loc_100254DE:				; CODE XREF: sub_10024E50+676j
		push	0
		push	0
		push	0
		call	sub_100269A0
		mov	ecx, [esp+48h+arg_0]
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch
		mov	dword ptr [edi], 0Bh
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025505:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	esi, 20h	; jumptable 10024ED7 case 9
		jnb	short loc_10025530
		lea	ebx, [ebx+0]

loc_10025510:				; CODE XREF: sub_10024E50+6DEj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 20h
		jb	short loc_10025510

loc_10025530:				; CODE XREF: sub_10024E50+6B8j
		mov	ecx, ebx
		and	ecx, 0FF00h
		mov	edx, ebx
		shl	edx, 10h
		add	ecx, edx
		mov	edx, ebx
		shr	edx, 8
		shl	ecx, 8
		and	edx, 0FF00h
		add	ecx, edx
		mov	edx, [esp+3Ch+arg_0]
		shr	ebx, 18h
		add	ecx, ebx
		mov	[edi+18h], ecx
		mov	[edx+30h], ecx
		xor	ebx, ebx
		xor	esi, esi
		mov	dword ptr [edi], 0Ah

loc_10025568:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	dword ptr [edi+0Ch], 0 ; jumptable 10024ED7 case 10
		jz	loc_10026232
		push	0
		push	0
		push	0
		call	sub_10026480
		mov	ecx, [esp+48h+arg_0]
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch
		mov	dword ptr [edi], 0Bh

loc_10025594:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [esp+3Ch+arg_4] ; jumptable 10024ED7 case 11
		cmp	ecx, 5
		jz	loc_10026274
		cmp	ecx, 6
		jz	loc_10026274

loc_100255AA:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	dword ptr [edi+4], 0 ; jumptable 10024ED7 case 12
		jz	short loc_100255C4
		mov	ecx, esi
		and	ecx, 7
		shr	ebx, cl
		sub	esi, ecx
		mov	dword ptr [edi], 1Ah
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_100255C4:				; CODE XREF: sub_10024E50+75Ej
		cmp	esi, 3
		jnb	short loc_100255F0
		lea	esp, [esp+0]

loc_100255D0:				; CODE XREF: sub_10024E50+79Ej
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 3
		jb	short loc_100255D0

loc_100255F0:				; CODE XREF: sub_10024E50+777j
		mov	ecx, ebx
		and	ecx, 1
		shr	ebx, 1
		mov	[edi+4], ecx
		mov	ecx, ebx
		and	ecx, 3
		cmp	ecx, 3		; switch 4 cases
		ja	short loc_10025672 ; jumptable 10025604	default	case
		jmp	ds:off_10026418[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1002560B:				; CODE XREF: sub_10024E50+7B4j
					; DATA XREF: .text:off_10026418o
		shr	ebx, 2		; jumptable 10025604 case 0
		mov	dword ptr [edi], 0Dh
		sub	esi, 3
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_1002561C:				; CODE XREF: sub_10024E50+7B4j
					; DATA XREF: .text:off_10026418o
		cmp	[esp+3Ch+arg_4], 6 ; jumptable 10025604	case 1
		mov	dword ptr [edi+4Ch], offset asc_10030750 ; "`\a"
		mov	dword ptr [edi+54h], 9
		mov	dword ptr [edi+50h], offset dword_10030F50
		mov	dword ptr [edi+58h], 5
		mov	dword ptr [edi], 13h
		jnz	short loc_10025672 ; jumptable 10025604	default	case
		shr	ebx, 2
		sub	esi, 3
		jmp	loc_10026274
; ---------------------------------------------------------------------------

loc_10025650:				; CODE XREF: sub_10024E50+7B4j
					; DATA XREF: .text:off_10026418o
		shr	ebx, 2		; jumptable 10025604 case 2
		mov	dword ptr [edi], 10h
		sub	esi, 3
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025661:				; CODE XREF: sub_10024E50+7B4j
					; DATA XREF: .text:off_10026418o
		mov	edx, [esp+3Ch+arg_0] ; jumptable 10025604 case 3
		mov	dword ptr [edx+18h], offset aInvalidBlockTy ; "invalid block type"
		mov	dword ptr [edi], 1Dh

loc_10025672:				; CODE XREF: sub_10024E50+7B2j
					; sub_10024E50+7F3j
		shr	ebx, 2		; jumptable 10025604 default case
		sub	esi, 3
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_1002567D:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, esi	; jumptable 10024ED7 case 13
		and	ecx, 7
		sub	esi, ecx
		shr	ebx, cl
		cmp	esi, 20h
		jnb	short loc_100256B0
		jmp	short loc_10025690
; ---------------------------------------------------------------------------
		align 10h

loc_10025690:				; CODE XREF: sub_10024E50+83Bj
					; sub_10024E50+85Ej
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 20h
		jb	short loc_10025690

loc_100256B0:				; CODE XREF: sub_10024E50+839j
		mov	edx, ebx
		mov	ecx, ebx
		not	edx
		and	ecx, 0FFFFh
		shr	edx, 10h
		cmp	ecx, edx
		jz	short loc_100256D3
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidStoredB ; "invalid stored block lengths"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_100256D3:				; CODE XREF: sub_10024E50+871j
		xor	ebx, ebx
		xor	esi, esi
		cmp	[esp+3Ch+arg_4], 6
		mov	[edi+40h], ecx
		mov	dword ptr [edi], 0Eh
		jz	loc_10026274

loc_100256EB:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	dword ptr [edi], 0Fh ; jumptable 10024ED7 case 14

loc_100256F1:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [edi+40h]	; jumptable 10024ED7 case 15
		mov	[esp+3Ch+Size],	ecx
		test	ecx, ecx
		jz	loc_10025DB9
		cmp	ecx, eax
		jbe	short loc_1002570A
		mov	ecx, eax
		mov	[esp+3Ch+Size],	eax

loc_1002570A:				; CODE XREF: sub_10024E50+8B2j
		mov	edx, [esp+3Ch+var_24]
		cmp	ecx, edx
		jbe	short loc_10025718
		mov	ecx, edx
		mov	[esp+3Ch+Size],	ecx

loc_10025718:				; CODE XREF: sub_10024E50+8C0j
		test	ecx, ecx
		jz	loc_10026274
		mov	edx, [esp+3Ch+Size]
		mov	eax, [esp+3Ch+Dst]
		push	edx		; Size
		push	ebp		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esp+48h+Size]
		sub	[esp+48h+var_2C], eax
		sub	[esp+48h+var_24], eax
		add	[esp+48h+Dst], eax
		add	ebp, eax
		add	esp, 0Ch
		sub	[edi+40h], eax
		mov	eax, [esp+3Ch+var_2C]
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025751:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	esi, 0Eh	; jumptable 10024ED7 case 16
		jnb	short loc_10025776

loc_10025756:				; CODE XREF: sub_10024E50+924j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 0Eh
		jb	short loc_10025756

loc_10025776:				; CODE XREF: sub_10024E50+904j
		mov	ecx, ebx
		and	ecx, 1Fh
		shr	ebx, 5
		add	ecx, 101h
		mov	edx, ebx
		mov	[edi+60h], ecx
		shr	ebx, 5
		mov	ecx, ebx
		and	edx, 1Fh
		and	ecx, 0Fh
		inc	edx
		add	ecx, 4
		shr	ebx, 4
		sub	esi, 0Eh
		cmp	dword ptr [edi+60h], 11Eh
		mov	[edi+64h], edx
		mov	[edi+5Ch], ecx
		ja	loc_10025896
		cmp	edx, 1Eh
		ja	loc_10025896
		mov	dword ptr [edi+68h], 0
		mov	dword ptr [edi], 11h

loc_100257C7:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [edi+68h]	; jumptable 10024ED7 case 17
		cmp	ecx, [edi+5Ch]
		jnb	short loc_1002581B
		nop

loc_100257D0:				; CODE XREF: sub_10024E50+9C9j
		cmp	esi, 3
		jnb	short loc_100257F5

loc_100257D5:				; CODE XREF: sub_10024E50+9A3j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 3
		jb	short loc_100257D5

loc_100257F5:				; CODE XREF: sub_10024E50+983j
		mov	edx, [edi+68h]
		movzx	edx, ds:word_10030FD0[edx*2]
		mov	ecx, ebx
		and	ecx, 7
		mov	[edi+edx*2+70h], cx
		inc	dword ptr [edi+68h]
		mov	ecx, [edi+68h]
		shr	ebx, 3
		sub	esi, 3
		cmp	ecx, [edi+5Ch]
		jb	short loc_100257D0

loc_1002581B:				; CODE XREF: sub_10024E50+97Dj
		mov	eax, 13h
		cmp	[edi+68h], eax
		jnb	short loc_1002584A
		jmp	short loc_10025830
; ---------------------------------------------------------------------------
		align 10h

loc_10025830:				; CODE XREF: sub_10024E50+9D5j
					; sub_10024E50+9F8j
		mov	edx, [edi+68h]
		movzx	ecx, ds:word_10030FD0[edx*2]
		xor	edx, edx
		mov	[edi+ecx*2+70h], dx
		inc	dword ptr [edi+68h]
		cmp	[edi+68h], eax
		jb	short loc_10025830

loc_1002584A:				; CODE XREF: sub_10024E50+9D3j
		lea	eax, [edi+530h]
		lea	ecx, [edi+6Ch]
		mov	[ecx], eax
		mov	[edi+4Ch], eax
		lea	edx, [edi+2F0h]
		push	edx
		lea	eax, [edi+54h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 7
		push	13h
		lea	eax, [edi+70h]
		push	eax
		push	0
		call	sub_100288F0
		add	esp, 18h
		mov	[esp+3Ch+var_C], eax
		test	eax, eax
		mov	eax, [esp+3Ch+var_2C]
		jz	short loc_100258A6
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidCodeLen ; "invalid code lengths set"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025896:				; CODE XREF: sub_10024E50+95Bj
					; sub_10024E50+964j
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aTooManyLengthO ; "too many	length or distance symbols"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_100258A6:				; CODE XREF: sub_10024E50+A34j
		mov	dword ptr [edi+68h], 0
		mov	dword ptr [edi], 12h

loc_100258B3:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	edx, [edi+64h]	; jumptable 10024ED7 case 18
		add	edx, [edi+60h]
		cmp	[edi+68h], edx
		jnb	loc_10025AD5

loc_100258C2:				; CODE XREF: sub_10024E50+C7Fj
		mov	ecx, [edi+54h]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+4Ch]
		dec	edx
		and	edx, ebx
		mov	ecx, [ecx+edx*4]
		mov	edx, ecx
		shr	edx, 8
		movzx	edx, dl
		mov	[esp+3Ch+Size],	ecx
		cmp	edx, esi
		jbe	short loc_10025923

loc_100258E5:				; CODE XREF: sub_10024E50+AD1j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [edi+54h]
		dec	eax
		add	esi, 8
		add	ebx, edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+4Ch]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		dec	edx
		and	edx, ebx
		mov	ecx, [ecx+edx*4]
		mov	edx, ecx
		shr	edx, 8
		movzx	edx, dl
		mov	[esp+3Ch+Size],	ecx
		cmp	edx, esi
		ja	short loc_100258E5

loc_10025923:				; CODE XREF: sub_10024E50+A93j
		mov	edx, ecx
		shr	edx, 10h
		cmp	edx, 10h
		jnb	short loc_10025982
		mov	edx, ecx
		shr	edx, 8
		movzx	edx, dl
		cmp	esi, edx
		jnb	short loc_10025966
		lea	esp, [esp+0]

loc_10025940:				; CODE XREF: sub_10024E50+B14j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+Size]
		dec	eax
		add	esi, 8
		add	ebx, edx
		movzx	edx, ch
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, edx
		jb	short loc_10025940

loc_10025966:				; CODE XREF: sub_10024E50+AE7j
		mov	dx, word ptr [esp+3Ch+Size+2]
		movzx	ecx, ch
		shr	ebx, cl
		sub	esi, ecx
		mov	ecx, [edi+68h]
		mov	[edi+ecx*2+70h], dx
		inc	dword ptr [edi+68h]
		jmp	loc_10025AC6
; ---------------------------------------------------------------------------

loc_10025982:				; CODE XREF: sub_10024E50+ADBj
		mov	dx, word ptr [esp+3Ch+Size+2]
		movzx	ecx, ch
		mov	[esp+3Ch+var_10], ecx
		cmp	dx, 10h
		jnz	short loc_100259F5
		lea	edx, [ecx+2]
		cmp	esi, edx
		jnb	short loc_100259C6
		jmp	short loc_100259A0
; ---------------------------------------------------------------------------
		align 10h

loc_100259A0:				; CODE XREF: sub_10024E50+B4Bj
					; sub_10024E50+B74j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_10]
		dec	eax
		add	esi, 8
		add	ebx, edx
		lea	edx, [ecx+2]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, edx
		jb	short loc_100259A0

loc_100259C6:				; CODE XREF: sub_10024E50+B49j
		shr	ebx, cl
		sub	esi, ecx
		mov	ecx, [edi+68h]
		test	ecx, ecx
		jz	loc_10025AF8
		movzx	ecx, word ptr [edi+ecx*2+6Eh]
		mov	[esp+3Ch+var_18], ecx
		mov	ecx, ebx
		and	ecx, 3
		add	ecx, 3
		shr	ebx, 2
		mov	[esp+3Ch+Size],	ecx
		sub	esi, 2
		jmp	loc_10025A93
; ---------------------------------------------------------------------------

loc_100259F5:				; CODE XREF: sub_10024E50+B42j
		cmp	dx, 11h
		jnz	short loc_10025A40
		lea	edx, [ecx+3]
		cmp	esi, edx
		jnb	short loc_10025A28

loc_10025A02:				; CODE XREF: sub_10024E50+BD6j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_10]
		dec	eax
		add	esi, 8
		add	ebx, edx
		lea	edx, [ecx+3]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, edx
		jb	short loc_10025A02

loc_10025A28:				; CODE XREF: sub_10024E50+BB0j
		shr	ebx, cl
		mov	edx, ebx
		and	edx, 7
		add	edx, 3
		mov	[esp+3Ch+Size],	edx
		shr	ebx, 3
		mov	edx, 0FFFFFFFDh
		jmp	short loc_10025A83
; ---------------------------------------------------------------------------

loc_10025A40:				; CODE XREF: sub_10024E50+BA9j
		lea	edx, [ecx+7]
		cmp	esi, edx
		jnb	short loc_10025A6D

loc_10025A47:				; CODE XREF: sub_10024E50+C1Bj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_10]
		dec	eax
		add	esi, 8
		add	ebx, edx
		lea	edx, [ecx+7]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, edx
		jb	short loc_10025A47

loc_10025A6D:				; CODE XREF: sub_10024E50+BF5j
		shr	ebx, cl
		mov	edx, ebx
		and	edx, 7Fh
		add	edx, 0Bh
		mov	[esp+3Ch+Size],	edx
		shr	ebx, 7
		mov	edx, 0FFFFFFF9h

loc_10025A83:				; CODE XREF: sub_10024E50+BEEj
		sub	edx, ecx
		mov	ecx, [esp+3Ch+Size]
		add	esi, edx
		mov	[esp+3Ch+var_18], 0

loc_10025A93:				; CODE XREF: sub_10024E50+BA0j
		mov	edx, [edi+68h]
		add	edx, ecx
		mov	ecx, [edi+64h]
		add	ecx, [edi+60h]
		cmp	edx, ecx
		ja	short loc_10025B08
		cmp	[esp+3Ch+Size],	0
		jz	short loc_10025AC6
		mov	ecx, [esp+3Ch+var_18]
		lea	ecx, [ecx+0]

loc_10025AB0:				; CODE XREF: sub_10024E50+C74j
		mov	edx, [edi+68h]
		dec	[esp+3Ch+Size]
		mov	[edi+edx*2+70h], cx
		inc	dword ptr [edi+68h]
		cmp	[esp+3Ch+Size],	0
		jnz	short loc_10025AB0

loc_10025AC6:				; CODE XREF: sub_10024E50+B2Dj
					; sub_10024E50+C57j
		mov	ecx, [edi+64h]
		add	ecx, [edi+60h]
		cmp	[edi+68h], ecx
		jb	loc_100258C2

loc_10025AD5:				; CODE XREF: sub_10024E50+A6Cj
		cmp	dword ptr [edi], 1Dh
		jz	loc_1002621A
		cmp	word ptr [edi+270h], 0
		jnz	short loc_10025B18
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidCodeMis ; "invalid code -- missing end-of-block"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025AF8:				; CODE XREF: sub_10024E50+B7Fj
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidBitLeng ; "invalid bit length repeat"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025B08:				; CODE XREF: sub_10024E50+C50j
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidBitLeng ; "invalid bit length repeat"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025B18:				; CODE XREF: sub_10024E50+C96j
		lea	eax, [edi+530h]
		lea	ecx, [edi+6Ch]
		mov	[ecx], eax
		mov	[edi+4Ch], eax
		lea	edx, [edi+2F0h]
		push	edx
		lea	eax, [edi+54h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 9
		mov	eax, [edi+60h]
		push	eax
		lea	ecx, [edi+70h]
		push	ecx
		push	1
		call	sub_100288F0
		add	esp, 18h
		mov	[esp+3Ch+var_C], eax
		test	eax, eax
		jz	short loc_10025B66
		mov	edx, [esp+3Ch+arg_0]
		mov	eax, [esp+3Ch+var_2C]
		mov	dword ptr [edx+18h], offset aInvalidLiteral ; "invalid literal/lengths set"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025B66:				; CODE XREF: sub_10024E50+D00j
		mov	eax, [edi+6Ch]
		lea	ecx, [edi+6Ch]
		mov	[edi+50h], eax
		lea	edx, [edi+2F0h]
		push	edx
		mov	edx, [edi+60h]
		lea	eax, [edi+58h]
		push	eax
		push	ecx
		mov	ecx, [edi+64h]
		mov	dword ptr [eax], 6
		push	ecx
		lea	eax, [edi+edx*2+70h]
		push	eax
		push	2
		call	sub_100288F0
		add	esp, 18h
		mov	[esp+3Ch+var_C], eax
		test	eax, eax
		mov	eax, [esp+3Ch+var_2C]
		jz	short loc_10025BB3
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidDistanc ; "invalid distances set"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025BB3:				; CODE XREF: sub_10024E50+D51j
		cmp	[esp+3Ch+arg_4], 6
		mov	dword ptr [edi], 13h
		jz	loc_10026274

loc_10025BC4:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	dword ptr [edi], 14h ; jumptable 10024ED7 case 19

loc_10025BCA:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	eax, 6		; jumptable 10024ED7 case 20
		jb	short loc_10025C43
		cmp	[esp+3Ch+var_24], 102h
		jb	short loc_10025C43
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [esp+3Ch+var_24]
		mov	edx, [esp+3Ch+Dst]
		mov	[eax+10h], ecx
		mov	ecx, [esp+3Ch+var_14]
		mov	[eax+0Ch], edx
		mov	edx, [esp+3Ch+var_2C]
		push	ecx
		mov	[eax], ebp
		mov	[eax+4], edx
		push	eax
		mov	[edi+38h], ebx
		mov	[edi+3Ch], esi
		call	sub_100284A0
		mov	eax, [esp+44h+arg_0]
		mov	edx, [eax+0Ch]
		mov	ecx, [eax+10h]
		mov	ebp, [eax]
		mov	ebx, [edi+38h]
		mov	esi, [edi+3Ch]
		mov	[esp+44h+Dst], edx
		mov	edx, [eax+4]
		add	esp, 8
		cmp	dword ptr [edi], 0Bh
		mov	[esp+3Ch+var_24], ecx
		mov	[esp+3Ch+var_2C], edx
		mov	eax, edx
		jnz	loc_1002621A
		mov	dword ptr [edi+1BC4h], 0FFFFFFFFh
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025C43:				; CODE XREF: sub_10024E50+D7Dj
					; sub_10024E50+D87j
		mov	ecx, [edi+54h]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+4Ch]
		mov	dword ptr [edi+1BC4h], 0
		dec	edx
		and	edx, ebx
		mov	edx, [ecx+edx*4]
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+3Ch+Size],	edx
		cmp	ecx, esi
		jbe	short loc_10025CAE

loc_10025C70:				; CODE XREF: sub_10024E50+E5Cj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [edi+54h]
		dec	eax
		add	esi, 8
		add	ebx, edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+4Ch]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		dec	edx
		and	edx, ebx
		mov	edx, [ecx+edx*4]
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+3Ch+Size],	edx
		cmp	ecx, esi
		ja	short loc_10025C70

loc_10025CAE:				; CODE XREF: sub_10024E50+E1Ej
		test	dl, dl
		jz	loc_10025D7D
		test	dl, 0F0h
		jnz	loc_10025D7D
		mov	ecx, edx
		shr	ecx, 8
		mov	[esp+3Ch+var_8], ecx
		movzx	ecx, cl
		mov	[esp+3Ch+var_18], ecx
		movzx	ecx, dl
		add	ecx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_10], edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_18]
		dec	edx
		and	edx, ebx
		shr	edx, cl
		mov	ecx, [esp+3Ch+Size]
		shr	ecx, 10h
		add	edx, ecx
		mov	ecx, [edi+4Ch]
		mov	ecx, [ecx+edx*4]
		mov	[esp+3Ch+Size],	ecx
		shr	ecx, 8
		movzx	edx, cl
		movzx	ecx, byte ptr [esp+3Ch+var_8]
		add	edx, ecx
		cmp	edx, esi
		jbe	short loc_10025D6A
		mov	edi, edi

loc_10025D10:				; CODE XREF: sub_10024E50+F18j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_10]
		dec	eax
		add	esi, 8
		add	ebx, edx
		movzx	edx, ch
		movzx	ecx, cl
		add	ecx, edx
		mov	[esp+3Ch+var_18], edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_18]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		dec	edx
		and	edx, ebx
		shr	edx, cl
		movzx	ecx, word ptr [esp+3Ch+var_10+2]
		add	edx, ecx
		mov	ecx, [edi+4Ch]
		mov	ecx, [ecx+edx*4]
		mov	[esp+3Ch+Size],	ecx
		shr	ecx, 8
		movzx	edx, cl
		add	edx, [esp+3Ch+var_18]
		cmp	edx, esi
		ja	short loc_10025D10

loc_10025D6A:				; CODE XREF: sub_10024E50+EBCj
		movzx	ecx, byte ptr [esp+3Ch+var_10+1]
		mov	edx, [esp+3Ch+Size]
		shr	ebx, cl
		sub	esi, ecx
		mov	[edi+1BC4h], ecx

loc_10025D7D:				; CODE XREF: sub_10024E50+E60j
					; sub_10024E50+E69j
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		add	[edi+1BC4h], ecx
		shr	ebx, cl
		sub	esi, ecx
		mov	[esp+3Ch+var_18], ecx
		mov	ecx, edx
		shr	ecx, 10h
		mov	[edi+40h], ecx
		test	dl, dl
		jnz	short loc_10025DAA
		mov	dword ptr [edi], 19h
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025DAA:				; CODE XREF: sub_10024E50+F4Dj
		test	dl, 20h
		jz	short loc_10025DC4
		mov	dword ptr [edi+1BC4h], 0FFFFFFFFh

loc_10025DB9:				; CODE XREF: sub_10024E50+8AAj
		mov	dword ptr [edi], 0Bh
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_10025DC4:				; CODE XREF: sub_10024E50+F5Dj
		test	dl, 40h
		jz	short loc_10025DD9
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidLiter_0 ; "invalid literal/length code"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025DD9:				; CODE XREF: sub_10024E50+F77j
		movzx	ecx, dl
		and	ecx, 0Fh
		mov	[edi+48h], ecx
		mov	dword ptr [edi], 15h

loc_10025DE8:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [edi+48h]	; jumptable 10024ED7 case 21
		test	ecx, ecx
		jz	short loc_10025E2D
		cmp	esi, ecx
		jnb	short loc_10025E13

loc_10025DF3:				; CODE XREF: sub_10024E50+FC1j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, [edi+48h]
		jb	short loc_10025DF3

loc_10025E13:				; CODE XREF: sub_10024E50+FA1j
		mov	ecx, [edi+48h]
		mov	edx, 1
		shl	edx, cl
		sub	esi, ecx
		dec	edx
		and	edx, ebx
		add	[edi+40h], edx
		shr	ebx, cl
		add	[edi+1BC4h], ecx

loc_10025E2D:				; CODE XREF: sub_10024E50+F9Dj
		mov	ecx, [edi+40h]
		mov	[edi+1BC8h], ecx
		mov	dword ptr [edi], 16h

loc_10025E3C:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [edi+58h]	; jumptable 10024ED7 case 22
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+50h]
		dec	edx
		and	edx, ebx
		mov	edx, [ecx+edx*4]
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+3Ch+Size],	edx
		cmp	ecx, esi
		jbe	short loc_10025E9E
		nop

loc_10025E60:				; CODE XREF: sub_10024E50+104Cj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [edi+58h]
		dec	eax
		add	esi, 8
		add	ebx, edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [edi+50h]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		dec	edx
		and	edx, ebx
		mov	edx, [ecx+edx*4]
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		mov	[esp+3Ch+Size],	edx
		cmp	ecx, esi
		ja	short loc_10025E60

loc_10025E9E:				; CODE XREF: sub_10024E50+100Dj
		test	dl, 0F0h
		jnz	loc_10025F63
		mov	ecx, edx
		shr	ecx, 8
		mov	[esp+3Ch+var_8], ecx
		movzx	ecx, cl
		mov	[esp+3Ch+var_18], ecx
		movzx	ecx, dl
		add	ecx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_10], edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_18]
		dec	edx
		and	edx, ebx
		shr	edx, cl
		mov	ecx, [esp+3Ch+Size]
		shr	ecx, 10h
		add	edx, ecx
		mov	ecx, [edi+50h]
		mov	ecx, [ecx+edx*4]
		mov	[esp+3Ch+Size],	ecx
		shr	ecx, 8
		movzx	edx, cl
		movzx	ecx, byte ptr [esp+3Ch+var_8]
		add	edx, ecx
		cmp	edx, esi
		jbe	short loc_10025F50

loc_10025EF6:				; CODE XREF: sub_10024E50+10FEj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_10]
		dec	eax
		add	esi, 8
		add	ebx, edx
		movzx	edx, ch
		movzx	ecx, cl
		add	ecx, edx
		mov	[esp+3Ch+var_18], edx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+3Ch+var_18]
		inc	ebp
		mov	[esp+3Ch+var_2C], eax
		dec	edx
		and	edx, ebx
		shr	edx, cl
		movzx	ecx, word ptr [esp+3Ch+var_10+2]
		add	edx, ecx
		mov	ecx, [edi+50h]
		mov	ecx, [ecx+edx*4]
		mov	[esp+3Ch+Size],	ecx
		shr	ecx, 8
		movzx	edx, cl
		add	edx, [esp+3Ch+var_18]
		cmp	edx, esi
		ja	short loc_10025EF6

loc_10025F50:				; CODE XREF: sub_10024E50+10A4j
		movzx	ecx, byte ptr [esp+3Ch+var_10+1]
		mov	edx, [esp+3Ch+Size]
		shr	ebx, cl
		sub	esi, ecx
		add	[edi+1BC4h], ecx

loc_10025F63:				; CODE XREF: sub_10024E50+1051j
		mov	ecx, edx
		shr	ecx, 8
		movzx	ecx, cl
		add	[edi+1BC4h], ecx
		shr	ebx, cl
		sub	esi, ecx
		mov	[esp+3Ch+var_18], ecx
		test	dl, 40h
		jz	short loc_10025F8E
		mov	edx, [esp+3Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidDista_0 ; "invalid distance	code"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_10025F8E:				; CODE XREF: sub_10024E50+112Cj
		mov	ecx, edx
		movzx	edx, dl
		shr	ecx, 10h
		and	edx, 0Fh
		mov	[edi+44h], ecx
		mov	[edi+48h], edx
		mov	dword ptr [edi], 17h

loc_10025FA5:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	ecx, [edi+48h]	; jumptable 10024ED7 case 23
		test	ecx, ecx
		jz	short loc_10025FEA
		cmp	esi, ecx
		jnb	short loc_10025FD0

loc_10025FB0:				; CODE XREF: sub_10024E50+117Ej
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, [edi+48h]
		jb	short loc_10025FB0

loc_10025FD0:				; CODE XREF: sub_10024E50+115Ej
		mov	ecx, [edi+48h]
		mov	edx, 1
		shl	edx, cl
		sub	esi, ecx
		dec	edx
		and	edx, ebx
		add	[edi+44h], edx
		shr	ebx, cl
		add	[edi+1BC4h], ecx

loc_10025FEA:				; CODE XREF: sub_10024E50+115Aj
		mov	dword ptr [edi], 18h

loc_10025FF0:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	[esp+3Ch+var_24], 0 ; jumptable	10024ED7 case 24
		jz	loc_10026274
		mov	edx, [esp+3Ch+var_14]
		sub	edx, [esp+3Ch+var_24]
		mov	ecx, [edi+44h]
		cmp	ecx, edx
		jbe	short loc_10026064
		sub	ecx, edx
		mov	[esp+3Ch+Size],	ecx
		cmp	ecx, [edi+2Ch]
		jbe	short loc_1002602E
		cmp	dword ptr [edi+1BC0h], 0
		jz	short loc_1002602E
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aInvalidDista_1 ; "invalid distance	too far	back"
		jmp	loc_10026214
; ---------------------------------------------------------------------------

loc_1002602E:				; CODE XREF: sub_10024E50+11C3j
					; sub_10024E50+11CCj
		mov	edx, [edi+30h]
		cmp	ecx, edx
		jbe	short loc_10026045
		sub	ecx, edx
		mov	edx, [edi+34h]
		add	edx, [edi+28h]
		mov	[esp+3Ch+Size],	ecx
		sub	edx, ecx
		jmp	short loc_10026051
; ---------------------------------------------------------------------------

loc_10026045:				; CODE XREF: sub_10024E50+11E3j
		mov	edx, [edi+34h]
		sub	edx, ecx
		add	edx, [edi+30h]
		mov	ecx, [esp+3Ch+Size]

loc_10026051:				; CODE XREF: sub_10024E50+11F3j
		mov	[esp+3Ch+var_8], edx
		mov	edx, [edi+40h]
		mov	[esp+3Ch+var_10], edx
		cmp	ecx, edx
		jbe	short loc_10026079
		mov	ecx, edx
		jmp	short loc_10026075
; ---------------------------------------------------------------------------

loc_10026064:				; CODE XREF: sub_10024E50+11B8j
		mov	edx, [esp+3Ch+Dst]
		sub	edx, ecx
		mov	ecx, [edi+40h]
		mov	[esp+3Ch+var_8], edx
		mov	[esp+3Ch+var_10], ecx

loc_10026075:				; CODE XREF: sub_10024E50+1212j
		mov	[esp+3Ch+Size],	ecx

loc_10026079:				; CODE XREF: sub_10024E50+120Ej
		mov	edx, [esp+3Ch+var_24]
		cmp	ecx, edx
		jbe	short loc_10026087
		mov	ecx, edx
		mov	[esp+3Ch+Size],	ecx

loc_10026087:				; CODE XREF: sub_10024E50+122Fj
		sub	edx, ecx
		mov	[esp+3Ch+var_24], edx
		mov	edx, [esp+3Ch+var_10]
		sub	edx, ecx
		mov	ecx, [esp+3Ch+var_8]
		sub	ecx, [esp+3Ch+Dst]
		mov	[edi+40h], edx
		mov	[esp+3Ch+var_8], ecx
		jmp	short loc_100260A8
; ---------------------------------------------------------------------------

loc_100260A4:				; CODE XREF: sub_10024E50+126Ej
		mov	ecx, [esp+3Ch+var_8]

loc_100260A8:				; CODE XREF: sub_10024E50+1252j
		mov	edx, [esp+3Ch+Dst]
		mov	dl, [edx+ecx]
		mov	ecx, [esp+3Ch+Dst]
		mov	[ecx], dl
		inc	ecx
		dec	[esp+3Ch+Size]
		mov	[esp+3Ch+Dst], ecx
		jnz	short loc_100260A4
		cmp	dword ptr [edi+40h], 0
		jnz	loc_1002621A
		mov	dword ptr [edi], 14h
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_100260D5:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	[esp+3Ch+var_24], 0 ; jumptable	10024ED7 case 25
		jz	loc_10026274
		mov	ecx, [esp+3Ch+Dst]
		mov	dl, [edi+40h]
		mov	[ecx], dl
		inc	ecx
		dec	[esp+3Ch+var_24]
		mov	[esp+3Ch+Dst], ecx
		mov	dword ptr [edi], 14h
		jmp	loc_1002621A
; ---------------------------------------------------------------------------

loc_100260FD:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	dword ptr [edi+8], 0 ; jumptable 10024ED7 case 26
		jz	loc_100261C5
		cmp	esi, 20h
		jnb	short loc_10026130
		lea	esp, [esp+0]

loc_10026110:				; CODE XREF: sub_10024E50+12DEj
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 20h
		jb	short loc_10026110

loc_10026130:				; CODE XREF: sub_10024E50+12BAj
		mov	ecx, [esp+3Ch+var_14]
		sub	ecx, [esp+3Ch+var_24]
		mov	edx, [esp+3Ch+arg_0]
		add	[edx+14h], ecx
		add	[edi+1Ch], ecx
		mov	[esp+3Ch+var_14], ecx
		test	ecx, ecx
		jz	short loc_1002617B
		mov	edx, [edi+18h]
		mov	eax, ecx
		mov	ecx, [esp+3Ch+Dst]
		push	eax
		sub	ecx, eax
		cmp	dword ptr [edi+10h], 0
		push	ecx
		push	edx
		jz	short loc_10026165
		call	sub_100269A0
		jmp	short loc_1002616A
; ---------------------------------------------------------------------------

loc_10026165:				; CODE XREF: sub_10024E50+130Cj
		call	sub_10026480

loc_1002616A:				; CODE XREF: sub_10024E50+1313j
		mov	ecx, [esp+48h+arg_0]
		mov	[edi+18h], eax
		mov	[ecx+30h], eax
		mov	eax, [esp+48h+var_2C]
		add	esp, 0Ch

loc_1002617B:				; CODE XREF: sub_10024E50+12F8j
		cmp	dword ptr [edi+10h], 0
		mov	edx, [esp+3Ch+var_24]
		mov	[esp+3Ch+var_14], edx
		mov	ecx, ebx
		jnz	short loc_100261AF
		and	ecx, 0FF00h
		mov	edx, ebx
		shl	edx, 10h
		add	ecx, edx
		mov	edx, ebx
		shr	edx, 8
		and	edx, 0FF00h
		shl	ecx, 8
		add	ecx, edx
		mov	edx, ebx
		shr	edx, 18h
		add	ecx, edx

loc_100261AF:				; CODE XREF: sub_10024E50+1339j
		cmp	ecx, [edi+18h]
		jz	short loc_100261C1
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aIncorrectDataC ; "incorrect data check"
		jmp	short loc_10026214
; ---------------------------------------------------------------------------

loc_100261C1:				; CODE XREF: sub_10024E50+1362j
		xor	ebx, ebx
		xor	esi, esi

loc_100261C5:				; CODE XREF: sub_10024E50+12B1j
		mov	dword ptr [edi], 1Bh

loc_100261CB:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		cmp	dword ptr [edi+8], 0 ; jumptable 10024ED7 case 27
		jz	loc_1002625C
		cmp	dword ptr [edi+10h], 0
		jz	loc_1002625C
		cmp	esi, 20h
		jnb	short loc_10026204

loc_100261E4:				; CODE XREF: sub_10024E50+13B2j
		test	eax, eax
		jz	loc_10026274
		movzx	edx, byte ptr [ebp+0]
		mov	ecx, esi
		shl	edx, cl
		dec	eax
		add	esi, 8
		inc	ebp
		add	ebx, edx
		mov	[esp+3Ch+var_2C], eax
		cmp	esi, 20h
		jb	short loc_100261E4

loc_10026204:				; CODE XREF: sub_10024E50+1392j
		cmp	ebx, [edi+1Ch]
		jz	short loc_10026258
		mov	ecx, [esp+3Ch+arg_0]
		mov	dword ptr [ecx+18h], offset aIncorrectLengt ; "incorrect length	check"

loc_10026214:				; CODE XREF: sub_10024E50+164j
					; sub_10024E50+1D0j ...
		mov	dword ptr [edi], 1Dh

loc_1002621A:				; CODE XREF: sub_10024E50+9Aj
					; sub_10024E50+109j ...
		mov	ecx, [edi]
		cmp	ecx, 1Eh
		jbe	loc_10024ED3
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10026232:				; CODE XREF: sub_10024E50+71Cj
		mov	ecx, [esp+3Ch+Dst]
		mov	[edx+0Ch], ecx
		mov	ecx, [esp+3Ch+var_24]
		mov	[edx], ebp
		mov	[edx+4], eax
		mov	[edx+10h], ecx
		mov	[edi+3Ch], esi
		pop	esi
		pop	ebp
		mov	[edi+38h], ebx
		pop	ebx
		mov	eax, 2
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10026258:				; CODE XREF: sub_10024E50+13B7j
		xor	ebx, ebx
		xor	esi, esi

loc_1002625C:				; CODE XREF: sub_10024E50+137Fj
					; sub_10024E50+1389j
		mov	dword ptr [edi], 1Ch

loc_10026262:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	[esp+3Ch+var_C], 1 ; jumptable 10024ED7	case 28
		jmp	short loc_10026274
; ---------------------------------------------------------------------------

loc_1002626C:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		mov	[esp+3Ch+var_C], 0FFFFFFFDh ; jumptable	10024ED7 case 29

loc_10026274:				; CODE XREF: sub_10024E50+A6j
					; sub_10024E50+1F2j ...
		mov	ecx, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+Dst]
		mov	[ecx+0Ch], edx
		mov	edx, [esp+3Ch+var_24]
		mov	[ecx+10h], edx
		mov	[ecx], ebp
		mov	[ecx+4], eax
		cmp	dword ptr [edi+28h], 0
		mov	[edi+38h], ebx
		mov	[edi+3Ch], esi
		jnz	short loc_100262A5
		cmp	dword ptr [edi], 1Ah
		jge	short loc_100262C9
		mov	eax, [esp+3Ch+var_14]
		cmp	eax, [ecx+10h]
		jz	short loc_100262C9

loc_100262A5:				; CODE XREF: sub_10024E50+1445j
		mov	eax, [esp+3Ch+var_14]
		mov	ebx, [esp+3Ch+arg_0]
		call	sub_10024D60
		test	eax, eax
		jz	short loc_100262C9
		mov	dword ptr [edi], 1Eh

loc_100262BC:				; CODE XREF: sub_10024E50:loc_10024ED7j
					; DATA XREF: .text:off_1002639Co
		pop	esi		; jumptable 10024ED7 case 30
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFCh
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100262C9:				; CODE XREF: sub_10024E50+144Aj
					; sub_10024E50+1453j ...
		mov	esi, [esp+3Ch+arg_0]
		mov	eax, [esp+3Ch+var_4]
		sub	eax, [esi+4]
		mov	ebx, [esp+3Ch+var_14]
		sub	ebx, [esi+10h]
		add	[esi+8], eax
		add	[esi+14h], ebx
		add	[edi+1Ch], ebx
		cmp	dword ptr [edi+8], 0
		mov	[esp+3Ch+var_4], eax
		jz	short loc_10026322
		test	ebx, ebx
		jz	short loc_10026322
		cmp	dword ptr [edi+10h], 0
		push	ebx
		jz	short loc_1002630A
		mov	edx, [esi+0Ch]
		mov	eax, [edi+18h]
		sub	edx, ebx
		push	edx
		push	eax
		call	sub_100269A0
		jmp	short loc_10026319
; ---------------------------------------------------------------------------

loc_1002630A:				; CODE XREF: sub_10024E50+14A7j
		mov	ecx, [esi+0Ch]
		mov	edx, [edi+18h]
		sub	ecx, ebx
		push	ecx
		push	edx
		call	sub_10026480

loc_10026319:				; CODE XREF: sub_10024E50+14B8j
		mov	[edi+18h], eax
		add	esp, 0Ch
		mov	[esi+30h], eax

loc_10026322:				; CODE XREF: sub_10024E50+149Cj
					; sub_10024E50+14A0j
		mov	eax, [edi]
		cmp	eax, 13h
		jz	short loc_10026332
		cmp	eax, 0Eh
		jz	short loc_10026332
		xor	ebp, ebp
		jmp	short loc_10026337
; ---------------------------------------------------------------------------

loc_10026332:				; CODE XREF: sub_10024E50+14D7j
					; sub_10024E50+14DCj
		mov	ebp, 100h

loc_10026337:				; CODE XREF: sub_10024E50+14E0j
		mov	ecx, [edi+4]
		neg	ecx
		sbb	ecx, ecx
		xor	edx, edx
		and	ecx, 40h
		cmp	eax, 0Bh
		setnz	dl
		add	ecx, ebp
		dec	edx
		and	edx, 80h
		add	edx, ecx
		add	edx, [edi+3Ch]
		cmp	[esp+3Ch+var_4], 0
		mov	[esi+2Ch], edx
		jnz	short loc_10026365
		test	ebx, ebx
		jz	short loc_1002636C

loc_10026365:				; CODE XREF: sub_10024E50+150Fj
		cmp	[esp+3Ch+arg_4], 4
		jnz	short loc_10026385

loc_1002636C:				; CODE XREF: sub_10024E50+1513j
		mov	eax, [esp+3Ch+var_C]
		test	eax, eax
		jnz	loc_10024ECB
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFBh
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10026385:				; CODE XREF: sub_10024E50+151Aj
		mov	eax, [esp+3Ch+var_C]
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10026391:				; CODE XREF: sub_10024E50+Aj
					; sub_10024E50+15j ...
		mov	eax, 0FFFFFFFEh
		pop	edi
		add	esp, 2Ch
		retn
sub_10024E50	endp

; ---------------------------------------------------------------------------
		align 4
off_1002639C	dd offset loc_10024EDE	; DATA XREF: sub_10024E50:loc_10024ED7r
		dd offset loc_10025039	; jump table for switch	statement
		dd offset loc_100250DB
		dd offset loc_10025156
		dd offset loc_100251D5
		dd offset loc_10025258
		dd offset loc_1002530E
		dd offset loc_100253C3
		dd offset loc_10025477
		dd offset loc_10025505
		dd offset loc_10025568
		dd offset loc_10025594
		dd offset loc_100255AA
		dd offset loc_1002567D
		dd offset loc_100256EB
		dd offset loc_100256F1
		dd offset loc_10025751
		dd offset loc_100257C7
		dd offset loc_100258B3
		dd offset loc_10025BC4
		dd offset loc_10025BCA
		dd offset loc_10025DE8
		dd offset loc_10025E3C
		dd offset loc_10025FA5
		dd offset loc_10025FF0
		dd offset loc_100260D5
		dd offset loc_100260FD
		dd offset loc_100261CB
		dd offset loc_10026262
		dd offset loc_1002626C
		dd offset loc_100262BC
off_10026418	dd offset loc_1002560B	; DATA XREF: sub_10024E50+7B4r
		dd offset loc_1002561C	; jump table for switch	statement
		dd offset loc_10025650
		dd offset loc_10025661
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026430	proc near		; CODE XREF: .text:10004076p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_10026473
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	short loc_10026473
		mov	ecx, [esi+24h]
		test	ecx, ecx
		jz	short loc_10026473
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_10026458
		push	eax
		mov	eax, [esi+28h]
		push	eax
		call	ecx
		add	esp, 8

loc_10026458:				; CODE XREF: sub_10026430+1Cj
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+28h]
		mov	eax, [esi+24h]
		push	ecx
		push	edx
		call	eax
		add	esp, 8
		mov	dword ptr [esi+1Ch], 0
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10026473:				; CODE XREF: sub_10026430+7j
					; sub_10026430+Ej ...
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
sub_10026430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026480	proc near		; CODE XREF: sub_10023120+D1p
					; sub_10024060:loc_100240C4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	edi
		mov	edi, ecx
		shr	edi, 10h
		and	ecx, 0FFFFh
		cmp	ebx, 1
		jnz	short loc_100264CB
		mov	eax, [esp+8+arg_4]
		movzx	edx, byte ptr [eax]
		add	ecx, edx
		cmp	ecx, 0FFF1h
		jb	short loc_100264B1
		sub	ecx, 0FFF1h

loc_100264B1:				; CODE XREF: sub_10026480+29j
		add	edi, ecx
		cmp	edi, 0FFF1h
		jb	short loc_100264C1
		sub	edi, 0FFF1h

loc_100264C1:				; CODE XREF: sub_10026480+39j
		mov	eax, edi
		shl	eax, 10h
		pop	edi
		or	eax, ecx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100264CB:				; CODE XREF: sub_10026480+18j
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		test	esi, esi
		jnz	short loc_100264DB
		lea	eax, [esi+1]
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100264DB:				; CODE XREF: sub_10026480+52j
		cmp	ebx, 10h
		jnb	short loc_10026519
		test	ebx, ebx
		jz	short loc_100264EF

loc_100264E4:				; CODE XREF: sub_10026480+6Dj
		movzx	eax, byte ptr [esi]
		add	ecx, eax
		inc	esi
		add	edi, ecx
		dec	ebx
		jnz	short loc_100264E4

loc_100264EF:				; CODE XREF: sub_10026480+62j
		cmp	ecx, 0FFF1h
		jb	short loc_100264FD
		sub	ecx, 0FFF1h

loc_100264FD:				; CODE XREF: sub_10026480+75j
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		mov	eax, edx
		shl	eax, 4
		sub	eax, edx
		add	eax, edi
		pop	esi
		shl	eax, 10h
		pop	edi
		or	eax, ecx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10026519:				; CODE XREF: sub_10026480+5Ej
		cmp	ebx, 15B0h
		jb	loc_100265F5
		mov	eax, 5E6EA9AFh
		mul	ebx
		push	ebp
		mov	ebp, edx
		shr	ebp, 0Bh

loc_10026532:				; CODE XREF: sub_10026480+16Ej
		sub	ebx, 15B0h
		mov	eax, 15Bh
		lea	ecx, [ecx+0]

loc_10026540:				; CODE XREF: sub_10026480+143j
		movzx	edx, byte ptr [esi]
		add	ecx, edx
		movzx	edx, byte ptr [esi+1]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+2]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+3]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+4]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+5]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+6]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+7]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+8]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+9]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ah]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Bh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ch]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Dh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Eh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Fh]
		add	edi, ecx
		add	ecx, edx
		add	edi, ecx
		add	esi, 10h
		dec	eax
		jnz	loc_10026540
		mov	eax, 80078071h
		mul	ecx
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	ecx, edx
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	edi, edx
		dec	ebp
		jnz	loc_10026532
		pop	ebp

loc_100265F5:				; CODE XREF: sub_10026480+9Fj
		test	ebx, ebx
		jz	loc_100266CF
		cmp	ebx, 10h
		jb	loc_1002669C
		mov	eax, ebx
		shr	eax, 4
		jmp	short loc_10026610
; ---------------------------------------------------------------------------
		align 10h

loc_10026610:				; CODE XREF: sub_10026480+18Bj
					; sub_10026480+216j
		movzx	edx, byte ptr [esi]
		add	ecx, edx
		movzx	edx, byte ptr [esi+1]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+2]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+3]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+4]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+5]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+6]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+7]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+8]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+9]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ah]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Bh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Ch]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Dh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Eh]
		add	edi, ecx
		add	ecx, edx
		movzx	edx, byte ptr [esi+0Fh]
		add	edi, ecx
		add	ecx, edx
		sub	ebx, 10h
		add	edi, ecx
		add	esi, 10h
		dec	eax
		jnz	loc_10026610

loc_1002669C:				; CODE XREF: sub_10026480+180j
		test	ebx, ebx
		jz	short loc_100266AB

loc_100266A0:				; CODE XREF: sub_10026480+229j
		movzx	eax, byte ptr [esi]
		add	ecx, eax
		inc	esi
		add	edi, ecx
		dec	ebx
		jnz	short loc_100266A0

loc_100266AB:				; CODE XREF: sub_10026480+21Ej
		mov	eax, 80078071h
		mul	ecx
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	ecx, edx
		mov	eax, 80078071h
		mul	edi
		shr	edx, 0Fh
		imul	edx, 0FFFF000Fh
		add	edi, edx

loc_100266CF:				; CODE XREF: sub_10026480+177j
		mov	eax, edi
		pop	esi
		shl	eax, 10h
		pop	edi
		or	eax, ecx
		pop	ebx
		retn
sub_10026480	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_100269A0

loc_100266E0:				; CODE XREF: sub_100269A0+13j
		push	esi
		mov	esi, edx
		not	eax
		test	esi, esi
		jz	short loc_1002670E
		lea	esp, [esp+0]

loc_100266F0:				; CODE XREF: sub_100269A0-294j
		test	cl, 3
		jz	short loc_1002670E
		movzx	edx, byte ptr [ecx]
		xor	edx, eax
		and	edx, 0FFh
		shr	eax, 8
		xor	eax, ds:dword_100311E0[edx*4]
		inc	ecx
		dec	esi
		jnz	short loc_100266F0

loc_1002670E:				; CODE XREF: sub_100269A0-2B9j
					; sub_100269A0-2ADj
		push	ebx
		push	edi
		cmp	esi, 20h
		jb	loc_10026924
		mov	edi, esi
		shr	edi, 5
		mov	edi, edi

loc_10026720:				; CODE XREF: sub_100269A0-82j
		xor	eax, [ecx]
		mov	edx, eax
		shr	edx, 10h
		mov	ebx, eax
		shr	ebx, 8
		and	ebx, 0FFh
		and	edx, 0FFh
		mov	edx, ds:dword_100315E0[edx*4]
		xor	edx, ds:dword_100319E0[ebx*4]
		mov	ebx, eax
		shr	ebx, 18h
		xor	edx, ds:dword_100311E0[ebx*4]
		and	eax, 0FFh
		xor	edx, ds:dword_10031DE0[eax*4]
		xor	edx, [ecx+4]
		mov	eax, edx
		shr	eax, 10h
		and	eax, 0FFh
		mov	eax, ds:dword_100315E0[eax*4]
		mov	ebx, edx
		shr	ebx, 8
		and	ebx, 0FFh
		xor	eax, ds:dword_100319E0[ebx*4]
		mov	ebx, edx
		shr	ebx, 18h
		xor	eax, ds:dword_100311E0[ebx*4]
		and	edx, 0FFh
		xor	eax, ds:dword_10031DE0[edx*4]
		xor	eax, [ecx+8]
		mov	edx, eax
		shr	edx, 10h
		mov	ebx, eax
		shr	ebx, 8
		and	ebx, 0FFh
		and	edx, 0FFh
		mov	edx, ds:dword_100315E0[edx*4]
		xor	edx, ds:dword_100319E0[ebx*4]
		mov	ebx, eax
		shr	ebx, 18h
		xor	edx, ds:dword_100311E0[ebx*4]
		and	eax, 0FFh
		xor	edx, ds:dword_10031DE0[eax*4]
		xor	edx, [ecx+0Ch]
		mov	eax, edx
		shr	eax, 10h
		and	eax, 0FFh
		mov	eax, ds:dword_100315E0[eax*4]
		mov	ebx, edx
		shr	ebx, 8
		and	ebx, 0FFh
		xor	eax, ds:dword_100319E0[ebx*4]
		mov	ebx, edx
		shr	ebx, 18h
		xor	eax, ds:dword_100311E0[ebx*4]
		and	edx, 0FFh
		xor	eax, ds:dword_10031DE0[edx*4]
		xor	eax, [ecx+10h]
		mov	edx, eax
		shr	edx, 10h
		mov	ebx, eax
		shr	ebx, 8
		and	edx, 0FFh
		mov	edx, ds:dword_100315E0[edx*4]
		and	ebx, 0FFh
		xor	edx, ds:dword_100319E0[ebx*4]
		mov	ebx, eax
		shr	ebx, 18h
		xor	edx, ds:dword_100311E0[ebx*4]
		and	eax, 0FFh
		xor	edx, ds:dword_10031DE0[eax*4]
		xor	edx, [ecx+14h]
		mov	eax, edx
		shr	eax, 10h
		and	eax, 0FFh
		mov	eax, ds:dword_100315E0[eax*4]
		mov	ebx, edx
		shr	ebx, 8
		and	ebx, 0FFh
		xor	eax, ds:dword_100319E0[ebx*4]
		mov	ebx, edx
		shr	ebx, 18h
		xor	eax, ds:dword_100311E0[ebx*4]
		and	edx, 0FFh
		xor	eax, ds:dword_10031DE0[edx*4]
		add	ecx, 20h
		xor	eax, [ecx-8]
		sub	esi, 20h
		mov	edx, eax
		mov	ebx, eax
		shr	edx, 10h
		shr	ebx, 8
		and	edx, 0FFh
		mov	edx, ds:dword_100315E0[edx*4]
		and	ebx, 0FFh
		xor	edx, ds:dword_100319E0[ebx*4]
		mov	ebx, eax
		shr	ebx, 18h
		xor	edx, ds:dword_100311E0[ebx*4]
		and	eax, 0FFh
		xor	edx, ds:dword_10031DE0[eax*4]
		xor	edx, [ecx-4]
		mov	eax, edx
		shr	eax, 10h
		and	eax, 0FFh
		mov	eax, ds:dword_100315E0[eax*4]
		mov	ebx, edx
		shr	ebx, 8
		and	ebx, 0FFh
		xor	eax, ds:dword_100319E0[ebx*4]
		mov	ebx, edx
		shr	ebx, 18h
		xor	eax, ds:dword_100311E0[ebx*4]
		and	edx, 0FFh
		xor	eax, ds:dword_10031DE0[edx*4]
		dec	edi
		jnz	loc_10026720

loc_10026924:				; CODE XREF: sub_100269A0-28Dj
		cmp	esi, 4
		jb	short loc_10026979
		mov	edx, esi
		shr	edx, 2
		mov	edi, edi

loc_10026930:				; CODE XREF: sub_100269A0-29j
		xor	eax, [ecx]
		add	ecx, 4
		mov	edi, eax
		shr	edi, 10h
		and	edi, 0FFh
		mov	edi, ds:dword_100315E0[edi*4]
		mov	ebx, eax
		shr	ebx, 8
		and	ebx, 0FFh
		xor	edi, ds:dword_100319E0[ebx*4]
		mov	ebx, eax
		shr	ebx, 18h
		xor	edi, ds:dword_100311E0[ebx*4]
		and	eax, 0FFh
		xor	edi, ds:dword_10031DE0[eax*4]
		sub	esi, 4
		dec	edx
		mov	eax, edi
		jnz	short loc_10026930

loc_10026979:				; CODE XREF: sub_100269A0-79j
		pop	edi
		pop	ebx
		test	esi, esi
		jz	short loc_10026999
		nop

loc_10026980:				; CODE XREF: sub_100269A0-9j
		movzx	edx, byte ptr [ecx]
		xor	edx, eax
		and	edx, 0FFh
		shr	eax, 8
		xor	eax, ds:dword_100311E0[edx*4]
		inc	ecx
		dec	esi
		jnz	short loc_10026980

loc_10026999:				; CODE XREF: sub_100269A0-23j
		not	eax
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_100269A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100269A0	proc near		; CODE XREF: sub_10023120+E5p
					; sub_10024060+5Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

; FUNCTION CHUNK AT 100266E0 SIZE 000002BD BYTES

		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jnz	short loc_100269AB
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100269AB:				; CODE XREF: sub_100269A0+6j
		mov	edx, [esp+arg_8]
		mov	eax, [esp+arg_0]
		jmp	loc_100266E0
sub_100269A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100269C0	proc near		; CODE XREF: sub_10027BE0+5Fj
					; sub_10028260+1EDp
		lea	eax, [edx+94h]
		mov	ecx, 11Eh
		push	esi
		lea	esp, [esp+0]

loc_100269D0:				; CODE XREF: sub_100269C0+19j
		xor	esi, esi
		mov	[eax], si
		add	eax, 4
		dec	ecx
		jnz	short loc_100269D0
		lea	eax, [edx+988h]
		mov	ecx, 1Eh

loc_100269E6:				; CODE XREF: sub_100269C0+2Fj
		xor	esi, esi
		mov	[eax], si
		add	eax, 4
		dec	ecx
		jnz	short loc_100269E6
		lea	eax, [edx+0A7Ch]
		mov	ecx, 13h
		lea	esp, [esp+0]

loc_10026A00:				; CODE XREF: sub_100269C0+49j
		xor	esi, esi
		mov	[eax], si
		add	eax, 4
		dec	ecx
		jnz	short loc_10026A00
		mov	eax, 1
		mov	[edx+494h], ax
		xor	eax, eax
		mov	[edx+16ACh], eax
		mov	[edx+16A8h], eax
		mov	[edx+16B0h], eax
		mov	[edx+16A0h], eax
		pop	esi
		retn
sub_100269C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026A40	proc near		; CODE XREF: sub_10027CE0+E3p
					; sub_10027CE0+124p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		mov	edx, [eax+1450h]
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	ebp, [eax+esi*4+0B5Ch]
		lea	ecx, [esi+esi]
		mov	[esp+0Ch+var_4], ebp
		cmp	ecx, edx
		jg	loc_10026AF9
		push	ebx

loc_10026A64:				; CODE XREF: sub_10026A40+97j
		jge	short loc_10026A98
		mov	esi, [eax+ecx*4+0B60h]
		mov	ebp, [eax+ecx*4+0B5Ch]
		movzx	edx, word ptr [edi+esi*4]
		movzx	ebx, word ptr [edi+ebp*4]
		cmp	dx, bx
		jb	short loc_10026A93
		jnz	short loc_10026A94
		mov	dl, [esi+eax+1458h]
		cmp	dl, [eax+ebp+1458h]
		ja	short loc_10026A94

loc_10026A93:				; CODE XREF: sub_10026A40+3Fj
		inc	ecx

loc_10026A94:				; CODE XREF: sub_10026A40+41j
					; sub_10026A40+51j
		mov	ebp, [esp+10h+var_4]

loc_10026A98:				; CODE XREF: sub_10026A40:loc_10026A64j
		mov	esi, [eax+ecx*4+0B5Ch]
		movzx	edx, word ptr [edi+ebp*4]
		movzx	ebx, word ptr [edi+esi*4]
		cmp	dx, bx
		jb	short loc_10026AD9
		jnz	short loc_10026ABE
		mov	dl, [eax+ebp+1458h]
		cmp	dl, [esi+eax+1458h]
		jbe	short loc_10026AE9

loc_10026ABE:				; CODE XREF: sub_10026A40+6Cj
		mov	edx, [esp+10h+arg_0]
		mov	[eax+edx*4+0B5Ch], esi
		mov	edx, [eax+1450h]
		mov	[esp+10h+arg_0], ecx
		add	ecx, ecx
		cmp	ecx, edx
		jle	short loc_10026A64

loc_10026AD9:				; CODE XREF: sub_10026A40+6Aj
		mov	ecx, [esp+10h+arg_0]
		pop	ebx
		pop	esi
		mov	[eax+ecx*4+0B5Ch], ebp
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10026AE9:				; CODE XREF: sub_10026A40+7Cj
		mov	edx, [esp+10h+arg_0]
		pop	ebx
		pop	esi
		mov	[eax+edx*4+0B5Ch], ebp
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10026AF9:				; CODE XREF: sub_10026A40+1Dj
		mov	[eax+esi*4+0B5Ch], ebp
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_10026A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026B10	proc near		; CODE XREF: sub_10027CE0+1D6p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 20h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edx, [ecx+4]
		mov	ebx, [ecx]
		mov	ecx, [ecx+8]
		mov	[esp+30h+var_C], edx
		mov	edx, [ecx+4]
		mov	ebp, [ecx]
		mov	[esp+30h+var_4], edx
		mov	edx, [ecx+8]
		mov	esi, [ecx+10h]
		xor	ecx, ecx
		mov	[esp+30h+var_8], edx
		movzx	edx, cx
		mov	ecx, edx
		shl	edx, 10h
		or	ecx, edx
		mov	[eax+0B3Ch], ecx
		mov	[eax+0B40h], ecx
		mov	[eax+0B44h], ecx
		mov	[eax+0B48h], ecx
		mov	[eax+0B4Ch], ecx
		mov	[eax+0B50h], ecx
		mov	[eax+0B54h], ecx
		mov	[eax+0B58h], ecx
		mov	ecx, [eax+1454h]
		mov	edx, [eax+ecx*4+0B5Ch]
		xor	ecx, ecx
		mov	[ebx+edx*4+2], cx
		mov	edi, [eax+1454h]
		inc	edi
		mov	[esp+30h+var_14], esi
		mov	[esp+30h+var_18], 0
		cmp	edi, 23Dh
		jge	loc_10026D19
		mov	ecx, 23Dh
		sub	ecx, edi
		lea	edx, [eax+edi*4+0B5Ch]
		add	edi, ecx
		mov	[esp+30h+var_1C], edx
		mov	[esp+30h+var_10], ecx
		mov	[esp+30h+var_20], edi
		jmp	short loc_10026BC7
; ---------------------------------------------------------------------------

loc_10026BC3:				; CODE XREF: sub_10026B10+12Aj
		mov	esi, [esp+30h+var_14]

loc_10026BC7:				; CODE XREF: sub_10026B10+B1j
		mov	ecx, [esp+30h+var_1C]
		mov	edx, [ecx]
		movzx	ecx, word ptr [ebx+edx*4+2]
		movzx	ecx, word ptr [ebx+ecx*4+2]
		inc	ecx
		cmp	ecx, esi
		jle	short loc_10026BE2
		inc	[esp+30h+var_18]
		mov	ecx, esi

loc_10026BE2:				; CODE XREF: sub_10026B10+CAj
		mov	[ebx+edx*4+2], cx
		cmp	edx, [esp+30h+var_C]
		jg	short loc_10026C31
		mov	edi, [esp+30h+var_8]
		inc	word ptr [eax+ecx*2+0B3Ch]
		xor	esi, esi
		cmp	edx, edi
		jl	short loc_10026C0A
		mov	esi, edx
		sub	esi, edi
		mov	edi, [esp+30h+var_4]
		mov	esi, [edi+esi*4]

loc_10026C0A:				; CODE XREF: sub_10026B10+EDj
		movzx	edi, word ptr [ebx+edx*4]
		add	ecx, esi
		imul	ecx, edi
		add	[eax+16A8h], ecx
		test	ebp, ebp
		jz	short loc_10026C2D
		movzx	edx, word ptr [ebp+edx*4+2]
		add	edx, esi
		imul	edx, edi
		add	[eax+16ACh], edx

loc_10026C2D:				; CODE XREF: sub_10026B10+10Bj
		mov	edi, [esp+30h+var_20]

loc_10026C31:				; CODE XREF: sub_10026B10+DBj
		add	[esp+30h+var_1C], 4
		dec	[esp+30h+var_10]
		jnz	short loc_10026BC3
		mov	ebp, [esp+30h+var_18]
		test	ebp, ebp
		jz	loc_10026D19
		mov	ecx, [esp+30h+var_14]
		lea	edx, [ecx-1]
		mov	[esp+30h+var_4], edx
		lea	esi, [eax+ecx*2+0B3Ch]
		lea	ebx, [ebx+0]

loc_10026C60:				; CODE XREF: sub_10026B10+190j
		mov	ecx, [esp+30h+var_4]
		cmp	word ptr [eax+ecx*2+0B3Ch], 0
		lea	edx, [eax+ecx*2+0B3Ch]
		jnz	short loc_10026C80

loc_10026C76:				; CODE XREF: sub_10026B10+16Ej
		sub	edx, 2
		dec	ecx
		cmp	word ptr [edx],	0
		jz	short loc_10026C76

loc_10026C80:				; CODE XREF: sub_10026B10+164j
		add	word ptr [eax+ecx*2+0B3Eh], 2
		mov	edx, 0FFFFh
		add	[eax+ecx*2+0B3Ch], dx
		mov	ecx, edx
		add	[esi], cx
		sub	ebp, 2
		test	ebp, ebp
		jg	short loc_10026C60
		mov	edx, [esp+30h+var_14]
		test	edx, edx
		jz	short loc_10026D19
		mov	[esp+30h+var_10], esi
		mov	edi, edi

loc_10026CB0:				; CODE XREF: sub_10026B10+207j
		movzx	esi, word ptr [esi]
		mov	[esp+30h+var_14], esi
		test	esi, esi
		jz	short loc_10026D0B
		lea	ebp, [eax+edi*4+0B5Ch]

loc_10026CC2:				; CODE XREF: sub_10026B10+1F5j
		mov	ecx, [ebp-4]
		dec	[esp+30h+var_20]
		sub	ebp, 4
		mov	[esp+30h+var_4], ebp
		cmp	ecx, [esp+30h+var_C]
		jg	short loc_10026D03
		movzx	edi, word ptr [ebx+ecx*4+2]
		lea	esi, [ebx+ecx*4+2]
		cmp	edi, edx
		jz	short loc_10026CFB
		movzx	ecx, word ptr [ebx+ecx*4]
		mov	ebp, edx
		sub	ebp, edi
		imul	ebp, ecx
		add	[eax+16A8h], ebp
		mov	ebp, [esp+30h+var_4]
		mov	[esi], dx

loc_10026CFB:				; CODE XREF: sub_10026B10+1D1j
		dec	[esp+30h+var_14]
		mov	esi, [esp+30h+var_14]

loc_10026D03:				; CODE XREF: sub_10026B10+1C4j
		test	esi, esi
		jnz	short loc_10026CC2
		mov	edi, [esp+30h+var_20]

loc_10026D0B:				; CODE XREF: sub_10026B10+1A9j
		mov	esi, [esp+30h+var_10]
		sub	esi, 2
		dec	edx
		mov	[esp+30h+var_10], esi
		jnz	short loc_10026CB0

loc_10026D19:				; CODE XREF: sub_10026B10+8Fj
					; sub_10026B10+132j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10026B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026D30	proc near		; CODE XREF: sub_10027EE0+10p
					; sub_10027EE0+22p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		movzx	edi, word ptr [eax+2]
		xor	edx, edx
		mov	ebx, ecx
		mov	[esp+1Ch+var_4], 0FFFFFFFFh
		lea	ecx, [edx+7]
		lea	esi, [edx+4]
		test	edi, edi
		jnz	short loc_10026D59
		mov	ecx, 8Ah
		lea	esi, [edx+3]

loc_10026D59:				; CODE XREF: sub_10026D30+1Fj
		mov	ebp, 0FFFFh
		mov	[eax+ebx*4+6], bp
		test	ebx, ebx
		js	loc_10026E05
		mov	ebp, [esp+1Ch+var_4]
		add	eax, 6
		inc	ebx
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_C], eax
		nop

loc_10026D80:				; CODE XREF: sub_10026D30+CFj
		mov	eax, edi
		mov	edi, [esp+1Ch+var_C]
		movzx	edi, word ptr [edi]
		inc	edx
		cmp	edx, ecx
		jge	short loc_10026D92
		cmp	eax, edi
		jz	short loc_10026DF6

loc_10026D92:				; CODE XREF: sub_10026D30+5Cj
		cmp	edx, esi
		jge	short loc_10026DA0
		add	[ebx+eax*4+0A7Ch], dx
		jmp	short loc_10026DCE
; ---------------------------------------------------------------------------

loc_10026DA0:				; CODE XREF: sub_10026D30+64j
		test	eax, eax
		jz	short loc_10026DB9
		cmp	eax, ebp
		jz	short loc_10026DB0
		inc	word ptr [ebx+eax*4+0A7Ch]

loc_10026DB0:				; CODE XREF: sub_10026D30+76j
		inc	word ptr [ebx+0ABCh]
		jmp	short loc_10026DCE
; ---------------------------------------------------------------------------

loc_10026DB9:				; CODE XREF: sub_10026D30+72j
		cmp	edx, 0Ah
		jg	short loc_10026DC7
		inc	word ptr [ebx+0AC0h]
		jmp	short loc_10026DCE
; ---------------------------------------------------------------------------

loc_10026DC7:				; CODE XREF: sub_10026D30+8Cj
		inc	word ptr [ebx+0AC4h]

loc_10026DCE:				; CODE XREF: sub_10026D30+6Ej
					; sub_10026D30+87j ...
		xor	edx, edx
		mov	ebp, eax
		test	edi, edi
		jnz	short loc_10026DE0
		mov	ecx, 8Ah
		lea	esi, [edx+3]
		jmp	short loc_10026DF6
; ---------------------------------------------------------------------------

loc_10026DE0:				; CODE XREF: sub_10026D30+A4j
		cmp	eax, edi
		jnz	short loc_10026DEE
		mov	ecx, 6
		lea	esi, [ecx-3]
		jmp	short loc_10026DF6
; ---------------------------------------------------------------------------

loc_10026DEE:				; CODE XREF: sub_10026D30+B2j
		mov	ecx, 7
		lea	esi, [ecx-3]

loc_10026DF6:				; CODE XREF: sub_10026D30+60j
					; sub_10026D30+AEj ...
		add	[esp+1Ch+var_C], 4
		dec	[esp+1Ch+var_8]
		jnz	loc_10026D80

loc_10026E05:				; CODE XREF: sub_10026D30+35j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10026D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026E10	proc near		; CODE XREF: sub_10027340+240p
					; sub_10027340+257j

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		movzx	ebp, word ptr [esi+2]
		xor	edx, edx
		push	edi
		mov	ebx, ecx
		mov	[esp+28h+var_C], 0FFFFFFFFh
		mov	[esp+28h+var_14], ebp
		lea	ecx, [edx+7]
		lea	edi, [edx+4]
		test	ebp, ebp
		jnz	short loc_10026E3F
		mov	ecx, 8Ah
		lea	edi, [ebp+3]

loc_10026E3F:				; CODE XREF: sub_10026E10+25j
		test	ebx, ebx
		js	loc_10027335
		add	esi, 6
		inc	ebx
		mov	[esp+28h+var_10], esi
		mov	[esp+28h+var_8], ebx
		mov	ebp, 1
		jmp	short loc_10026E60
; ---------------------------------------------------------------------------
		align 10h

loc_10026E60:				; CODE XREF: sub_10026E10+48j
					; sub_10026E10+51Fj
		mov	ebx, [esp+28h+var_10]
		movzx	ebx, word ptr [ebx]
		mov	esi, [esp+28h+var_14]
		add	edx, ebp
		mov	[esp+28h+var_4], esi
		mov	[esp+28h+var_14], ebx
		mov	[esp+28h+var_18], edx
		cmp	edx, ecx
		jge	short loc_10026E85
		cmp	esi, ebx
		jz	loc_10027326

loc_10026E85:				; CODE XREF: sub_10026E10+6Bj
		cmp	edx, edi
		jge	loc_10026F31
		lea	ecx, [ecx+0]

loc_10026E90:				; CODE XREF: sub_10026E10+116j
		movzx	edi, word ptr [eax+esi*4+0A7Eh]
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		sub	ebx, edi
		cmp	ecx, ebx
		jle	short loc_10026F06
		movzx	esi, word ptr [eax+esi*4+0A7Ch]
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		lea	ecx, [edx+edi-10h]
		mov	edx, [esp+28h+var_18]
		mov	[eax+16B8h], si
		mov	esi, [esp+28h+var_4]
		jmp	short loc_10026F1A
; ---------------------------------------------------------------------------

loc_10026F06:				; CODE XREF: sub_10026E10+97j
		mov	bx, [eax+esi*4+0A7Ch]
		shl	bx, cl
		or	[eax+16B8h], bx
		add	ecx, edi

loc_10026F1A:				; CODE XREF: sub_10026E10+F4j
		sub	edx, ebp
		mov	[eax+16BCh], ecx
		mov	[esp+28h+var_18], edx
		jnz	loc_10026E90
		jmp	loc_100272F8
; ---------------------------------------------------------------------------

loc_10026F31:				; CODE XREF: sub_10026E10+77j
		test	esi, esi
		jz	loc_100270E5
		cmp	esi, [esp+28h+var_C]
		jz	loc_10026FDF
		movzx	edi, word ptr [eax+esi*4+0A7Eh]
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		sub	ebx, edi
		mov	[esp+28h+var_4], edi
		cmp	ecx, ebx
		jle	short loc_10026FC3
		movzx	edi, word ptr [eax+esi*4+0A7Ch]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		mov	ecx, [esp+28h+var_4]
		lea	edx, [edx+ecx-10h]
		mov	[eax+16BCh], edx
		mov	edx, [esp+28h+var_18]
		mov	[eax+16B8h], di
		jmp	short loc_10026FDD
; ---------------------------------------------------------------------------

loc_10026FC3:				; CODE XREF: sub_10026E10+14Ej
		mov	bx, [eax+esi*4+0A7Ch]
		shl	bx, cl
		or	[eax+16B8h], bx
		add	ecx, edi
		mov	[eax+16BCh], ecx

loc_10026FDD:				; CODE XREF: sub_10026E10+1B1j
		sub	edx, ebp

loc_10026FDF:				; CODE XREF: sub_10026E10+12Dj
		movzx	edi, word ptr [eax+0ABEh]
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		sub	ebx, edi
		mov	[esp+28h+var_18], edi
		cmp	ecx, ebx
		jle	short loc_10027058
		movzx	edi, word ptr [eax+0ABCh]
		mov	[esp+28h+var_4], edi
		shl	di, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], di
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edi, [eax+14h]
		mov	[ecx+edi], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edi, [eax+14h]
		mov	ecx, [eax+8]
		mov	[edi+ecx], bl
		mov	ebx, [eax+16BCh]
		mov	edi, [esp+28h+var_4]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, bl
		shr	di, cl
		mov	ecx, [esp+28h+var_18]
		lea	ecx, [ebx+ecx-10h]
		mov	[eax+16B8h], di
		jmp	short loc_1002706D
; ---------------------------------------------------------------------------

loc_10027058:				; CODE XREF: sub_10026E10+1E9j
		mov	di, [eax+0ABCh]
		shl	di, cl
		or	[eax+16B8h], di
		add	ecx, [esp+28h+var_18]

loc_1002706D:				; CODE XREF: sub_10026E10+246j
		mov	[eax+16BCh], ecx
		cmp	ecx, 0Eh
		jle	short loc_100270D0
		lea	edi, [edx-3]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		add	edx, 0FFFFFFF2h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	loc_100272F8
; ---------------------------------------------------------------------------

loc_100270D0:				; CODE XREF: sub_10026E10+266j
		add	edx, 0FFFFFFFDh
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 2
		jmp	loc_100272F2
; ---------------------------------------------------------------------------

loc_100270E5:				; CODE XREF: sub_10026E10+123j
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		cmp	edx, 0Ah
		jg	loc_100271F4
		movzx	edi, word ptr [eax+0AC2h]
		sub	ebx, edi
		mov	[esp+28h+var_18], edi
		cmp	ecx, ebx
		jle	short loc_10027167
		movzx	edi, word ptr [eax+0AC0h]
		mov	[esp+28h+var_4], edi
		shl	di, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], di
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edi, [eax+14h]
		mov	[ecx+edi], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edi, [eax+14h]
		mov	ecx, [eax+8]
		mov	[edi+ecx], bl
		mov	ebx, [eax+16BCh]
		mov	edi, [esp+28h+var_4]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, bl
		shr	di, cl
		mov	ecx, [esp+28h+var_18]
		lea	ecx, [ebx+ecx-10h]
		mov	[eax+16B8h], di
		jmp	short loc_1002717C
; ---------------------------------------------------------------------------

loc_10027167:				; CODE XREF: sub_10026E10+2F8j
		mov	di, [eax+0AC0h]
		shl	di, cl
		or	[eax+16B8h], di
		add	ecx, [esp+28h+var_18]

loc_1002717C:				; CODE XREF: sub_10026E10+355j
		mov	[eax+16BCh], ecx
		cmp	ecx, 0Dh
		jle	short loc_100271DF
		lea	edi, [edx-3]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		add	edx, 0FFFFFFF3h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	loc_100272F8
; ---------------------------------------------------------------------------

loc_100271DF:				; CODE XREF: sub_10026E10+375j
		add	edx, 0FFFFFFFDh
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 3
		jmp	loc_100272F2
; ---------------------------------------------------------------------------

loc_100271F4:				; CODE XREF: sub_10026E10+2E3j
		movzx	edi, word ptr [eax+0AC6h]
		sub	ebx, edi
		mov	[esp+28h+var_C], edi
		cmp	ecx, ebx
		jle	short loc_10027267
		movzx	edi, word ptr [eax+0AC4h]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		mov	ecx, [esp+28h+var_C]
		lea	edx, [edx+ecx-10h]
		mov	[eax+16BCh], edx
		mov	edx, [esp+28h+var_18]
		mov	[eax+16B8h], di
		jmp	short loc_10027282
; ---------------------------------------------------------------------------

loc_10027267:				; CODE XREF: sub_10026E10+3F3j
		mov	di, [eax+0AC4h]
		shl	di, cl
		or	[eax+16B8h], di
		add	ecx, [esp+28h+var_C]
		mov	[eax+16BCh], ecx

loc_10027282:				; CODE XREF: sub_10026E10+455j
		mov	ecx, [eax+16BCh]
		cmp	ecx, 9
		jle	short loc_100272E2
		lea	edi, [edx-0Bh]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		add	edx, 0FFFFFFF7h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	short loc_100272F8
; ---------------------------------------------------------------------------

loc_100272E2:				; CODE XREF: sub_10026E10+47Bj
		add	edx, 0FFFFFFF5h
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 7

loc_100272F2:				; CODE XREF: sub_10026E10+2D0j
					; sub_10026E10+3DFj
		mov	[eax+16BCh], ecx

loc_100272F8:				; CODE XREF: sub_10026E10+11Cj
					; sub_10026E10+2BBj ...
		mov	ecx, [esp+28h+var_14]
		xor	edx, edx
		mov	[esp+28h+var_C], esi
		test	ecx, ecx
		jnz	short loc_10027310
		mov	ecx, 8Ah
		lea	edi, [edx+3]
		jmp	short loc_10027326
; ---------------------------------------------------------------------------

loc_10027310:				; CODE XREF: sub_10026E10+4F4j
		cmp	esi, ecx
		jnz	short loc_1002731E
		mov	ecx, 6
		lea	edi, [ecx-3]
		jmp	short loc_10027326
; ---------------------------------------------------------------------------

loc_1002731E:				; CODE XREF: sub_10026E10+502j
		mov	ecx, 7
		lea	edi, [ecx-3]

loc_10027326:				; CODE XREF: sub_10026E10+6Fj
					; sub_10026E10+4FEj ...
		add	[esp+28h+var_10], 4
		sub	[esp+28h+var_8], ebp
		jnz	loc_10026E60

loc_10027335:				; CODE XREF: sub_10026E10+31j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_10026E10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027340	proc near		; CODE XREF: sub_10028260+13Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	ecx, [eax+16BCh]
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	ebp
		push	esi
		push	edi
		mov	ebp, 1
		cmp	ecx, 0Bh
		jle	short loc_100273B9
		mov	esi, [esp+14h+arg_0]
		add	esi, 0FFFFFEFFh
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+14h]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	ebx, [esp+14h+arg_8]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		add	edx, 0FFFFFFF5h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		jmp	short loc_100273D6
; ---------------------------------------------------------------------------

loc_100273B9:				; CODE XREF: sub_10027340+17j
		mov	edx, [esp+14h+arg_0]
		add	edx, 0FFFFFEFFh
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 5
		mov	[eax+16BCh], ecx

loc_100273D6:				; CODE XREF: sub_10027340+77j
		mov	ecx, [eax+16BCh]
		cmp	ecx, 0Bh
		jle	short loc_10027440
		mov	esi, [esp+14h+arg_4]
		dec	esi
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+14h]
		mov	[esp+14h+var_4], ebx
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	ebx, [esp+14h+var_4]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		add	edx, 0FFFFFFF5h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		jmp	short loc_10027458
; ---------------------------------------------------------------------------

loc_10027440:				; CODE XREF: sub_10027340+9Fj
		mov	edx, [esp+14h+arg_4]
		dec	edx
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 5
		mov	[eax+16BCh], ecx

loc_10027458:				; CODE XREF: sub_10027340+FEj
		mov	ecx, [eax+16BCh]
		cmp	ecx, 0Ch
		jle	short loc_100274C0
		lea	esi, [ebx-4]
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+14h]
		mov	[esp+14h+var_4], ebx
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	ebx, [esp+14h+var_4]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		add	edx, 0FFFFFFF4h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		jmp	short loc_100274D6
; ---------------------------------------------------------------------------

loc_100274C0:				; CODE XREF: sub_10027340+121j
		lea	edx, [ebx-4]
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 4
		mov	[eax+16BCh], ecx

loc_100274D6:				; CODE XREF: sub_10027340+17Ej
		xor	edi, edi
		test	ebx, ebx
		jle	loc_10027575

loc_100274E0:				; CODE XREF: sub_10027340+22Fj
		mov	ecx, [eax+16BCh]
		movzx	edx, ds:byte_10033254[edi]
		cmp	ecx, 0Dh
		jle	short loc_10027550
		movzx	esi, word ptr [eax+edx*4+0A7Eh]
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+14h]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], ebp
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], ebp
		mov	ebx, [esp+14h+arg_8]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		add	edx, 0FFFFFFF3h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		jmp	short loc_1002756B
; ---------------------------------------------------------------------------

loc_10027550:				; CODE XREF: sub_10027340+1B0j
		mov	dx, [eax+edx*4+0A7Eh]
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, 3
		mov	[eax+16BCh], ecx

loc_1002756B:				; CODE XREF: sub_10027340+20Ej
		add	edi, ebp
		cmp	edi, ebx
		jl	loc_100274E0

loc_10027575:				; CODE XREF: sub_10027340+19Aj
		mov	ecx, [esp+14h+arg_0]
		dec	ecx
		lea	edx, [eax+94h]
		call	sub_10026E10
		mov	ecx, [esp+14h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		dec	ecx
		lea	edx, [eax+988h]
		pop	ebx
		add	esp, 4
		jmp	sub_10026E10
sub_10027340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100275A0	proc near		; CODE XREF: sub_10028260+153p
					; sub_10028260+1E3p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	[eax+16A0h], ebx
		jz	loc_100278FD
		jmp	short loc_100275C0
; ---------------------------------------------------------------------------
		align 10h

loc_100275C0:				; CODE XREF: sub_100275A0+15j
					; sub_100275A0+357j
		mov	ecx, [eax+16A4h]
		movzx	ebp, word ptr [ecx+ebx*2]
		mov	edx, [eax+1698h]
		movzx	esi, byte ptr [ebx+edx]
		inc	ebx
		mov	[esp+1Ch+var_4], ebp
		mov	[esp+1Ch+var_C], ebx
		test	ebp, ebp
		jnz	loc_1002767C
		mov	edx, [esp+1Ch+arg_0]
		movzx	edi, word ptr [edx+esi*4+2]
		mov	ecx, [eax+16BCh]
		mov	ebp, 10h
		sub	ebp, edi
		cmp	ecx, ebp
		jle	short loc_10027661
		movzx	esi, word ptr [edx+esi*4]
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+8]
		mov	[esp+1Ch+var_C], ebx
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	ebx, [esp+1Ch+var_C]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		lea	ecx, [edx+edi-10h]
		mov	[eax+16BCh], ecx
		mov	[eax+16B8h], si
		jmp	loc_100278F1
; ---------------------------------------------------------------------------

loc_10027661:				; CODE XREF: sub_100275A0+5Dj
		mov	dx, [edx+esi*4]
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, edi
		mov	[eax+16BCh], ecx
		jmp	loc_100278F1
; ---------------------------------------------------------------------------

loc_1002767C:				; CODE XREF: sub_100275A0+3Fj
		movzx	edi, ds:byte_10033A28[esi]
		mov	ecx, [esp+1Ch+arg_0]
		movzx	edx, word ptr [ecx+edi*4+406h]
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		sub	ebx, edx
		mov	[esp+1Ch+var_8], edx
		cmp	ecx, ebx
		jle	short loc_1002770B
		mov	edx, [esp+1Ch+arg_0]
		movzx	ebp, word ptr [edx+edi*4+404h]
		mov	dx, bp
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	bp, cl
		mov	ecx, [esp+1Ch+var_8]
		lea	edx, [edx+ecx-10h]
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], bp
		mov	ebp, [esp+1Ch+var_4]
		jmp	short loc_10027729
; ---------------------------------------------------------------------------

loc_1002770B:				; CODE XREF: sub_100275A0+102j
		mov	ebx, [esp+1Ch+arg_0]
		mov	bx, [ebx+edi*4+404h]
		shl	bx, cl
		or	[eax+16B8h], bx
		add	ecx, edx
		mov	[eax+16BCh], ecx

loc_10027729:				; CODE XREF: sub_100275A0+169j
		mov	ebx, ds:dword_100331E0[edi*4]
		test	ebx, ebx
		jz	loc_100277B5
		mov	ecx, [eax+16BCh]
		sub	esi, ds:dword_10033B28[edi*4]
		mov	edx, 10h
		sub	edx, ebx
		cmp	ecx, edx
		jle	short loc_100277A3
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+8]
		mov	[esp+1Ch+var_4], ebx
		or	[eax+16B8h], dx
		mov	edx, [eax+14h]
		mov	bl, [eax+16B8h]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		mov	ecx, [eax+8]
		mov	dl, [eax+16B9h]
		mov	edi, [eax+14h]
		mov	ebx, [esp+1Ch+var_4]
		mov	[edi+ecx], dl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		lea	ecx, [edx+ebx-10h]
		mov	[eax+16B8h], si
		jmp	short loc_100277AF
; ---------------------------------------------------------------------------

loc_100277A3:				; CODE XREF: sub_100275A0+1AEj
		shl	si, cl
		or	[eax+16B8h], si
		add	ecx, ebx

loc_100277AF:				; CODE XREF: sub_100275A0+201j
		mov	[eax+16BCh], ecx

loc_100277B5:				; CODE XREF: sub_100275A0+192j
		dec	ebp
		cmp	ebp, 100h
		jnb	short loc_100277C7
		movzx	esi, ss:byte_10033828[ebp]
		jmp	short loc_100277D3
; ---------------------------------------------------------------------------

loc_100277C7:				; CODE XREF: sub_100275A0+21Cj
		mov	edx, ebp
		shr	edx, 7
		movzx	esi, ds:byte_10033928[edx]

loc_100277D3:				; CODE XREF: sub_100275A0+225j
		mov	edx, [esp+1Ch+arg_4]
		movzx	edi, word ptr [edx+esi*4+2]
		mov	ecx, [eax+16BCh]
		mov	ebx, 10h
		sub	ebx, edi
		mov	[esp+1Ch+var_4], edi
		cmp	ecx, ebx
		jle	short loc_1002784C
		movzx	edi, word ptr [edx+esi*4]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		mov	ecx, [esp+1Ch+var_4]
		lea	edx, [edx+ecx-10h]
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	short loc_10027862
; ---------------------------------------------------------------------------

loc_1002784C:				; CODE XREF: sub_100275A0+24Fj
		mov	dx, [edx+esi*4]
		shl	dx, cl
		or	[eax+16B8h], dx
		add	ecx, edi
		mov	[eax+16BCh], ecx

loc_10027862:				; CODE XREF: sub_100275A0+2AAj
		mov	edi, ds:dword_10033268[esi*4]
		test	edi, edi
		jz	loc_100278ED
		mov	ecx, [eax+16BCh]
		sub	ebp, ds:dword_10033BA0[esi*4]
		mov	edx, 10h
		sub	edx, edi
		cmp	ecx, edx
		jle	short loc_100278DB
		mov	dx, bp
		shl	dx, cl
		mov	ecx, [eax+8]
		mov	esi, 1
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		add	[eax+14h], esi
		mov	ecx, [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], esi
		mov	cl, 10h
		sub	cl, dl
		shr	bp, cl
		lea	ecx, [edx+edi-10h]
		mov	[eax+16B8h], bp
		jmp	short loc_100278E7
; ---------------------------------------------------------------------------

loc_100278DB:				; CODE XREF: sub_100275A0+2E7j
		shl	bp, cl
		or	[eax+16B8h], bp
		add	ecx, edi

loc_100278E7:				; CODE XREF: sub_100275A0+339j
		mov	[eax+16BCh], ecx

loc_100278ED:				; CODE XREF: sub_100275A0+2CBj
		mov	ebx, [esp+1Ch+var_C]

loc_100278F1:				; CODE XREF: sub_100275A0+BCj
					; sub_100275A0+D7j
		cmp	ebx, [eax+16A0h]
		jb	loc_100275C0

loc_100278FD:				; CODE XREF: sub_100275A0+Fj
		mov	esi, [esp+1Ch+arg_0]
		movzx	ebx, word ptr [esi+402h]
		mov	ecx, [eax+16BCh]
		mov	edx, 10h
		sub	edx, ebx
		cmp	ecx, edx
		jle	short loc_1002798C
		movzx	edi, word ptr [esi+400h]
		mov	dx, di
		shl	dx, cl
		mov	ecx, [eax+8]
		mov	[esp+1Ch+arg_0], ebx
		or	[eax+16B8h], dx
		mov	edx, [eax+14h]
		mov	bl, [eax+16B8h]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		mov	ebp, [eax+14h]
		mov	ecx, [eax+8]
		mov	dl, [eax+16B9h]
		mov	ebx, [esp+1Ch+arg_0]
		mov	[ecx+ebp], dl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	di, cl
		lea	ecx, [edx+ebx-10h]
		mov	[eax+16BCh], ecx
		mov	[eax+16B8h], di
		movzx	edx, word ptr [esi+402h]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax+16B4h], edx
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1002798C:				; CODE XREF: sub_100275A0+377j
		mov	dx, [esi+400h]
		shl	dx, cl
		pop	edi
		or	[eax+16B8h], dx
		add	ecx, ebx
		mov	[eax+16BCh], ecx
		movzx	ecx, word ptr [esi+402h]
		pop	esi
		pop	ebp
		mov	[eax+16B4h], ecx
		pop	ebx
		add	esp, 0Ch
		retn
sub_100275A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100279C0	proc near		; CODE XREF: sub_10028260+25p
		mov	edx, 0F3FFC07Fh
		xor	eax, eax
		lea	ecx, [esi+94h]
		lea	ecx, [ecx+0]

loc_100279D0:				; CODE XREF: sub_100279C0+24j
		test	dl, 1
		jz	short loc_100279DB
		cmp	word ptr [ecx],	0
		jnz	short loc_10027A21

loc_100279DB:				; CODE XREF: sub_100279C0+13j
		inc	eax
		add	ecx, 4
		shr	edx, 1
		cmp	eax, 1Fh
		jle	short loc_100279D0
		cmp	word ptr [esi+0B8h], 0
		jnz	short loc_10027A24
		cmp	word ptr [esi+0BCh], 0
		jnz	short loc_10027A24
		cmp	word ptr [esi+0C8h], 0
		jnz	short loc_10027A24
		mov	eax, 20h
		lea	ecx, [esi+114h]
		nop

loc_10027A10:				; CODE XREF: sub_100279C0+5Fj
		cmp	word ptr [ecx],	0
		jnz	short loc_10027A24
		inc	eax
		add	ecx, 4
		cmp	eax, 100h
		jl	short loc_10027A10

loc_10027A21:				; CODE XREF: sub_100279C0+19j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10027A24:				; CODE XREF: sub_100279C0+2Ej
					; sub_100279C0+38j ...
		mov	eax, 1
		retn
sub_100279C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027A30	proc near		; CODE XREF: sub_10028060:loc_10028140p
					; sub_10028060+1C2p ...
		mov	ecx, [eax+16BCh]
		push	ebx
		cmp	ecx, 10h
		jnz	short loc_10027A73
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		xor	ecx, ecx
		mov	[eax+16B8h], cx
		mov	[eax+16BCh], ecx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10027A73:				; CODE XREF: sub_10027A30+Aj
		cmp	ecx, 8
		jl	short loc_10027A9F
		mov	edx, [eax+8]
		mov	ecx, [eax+14h]
		mov	bl, [eax+16B8h]
		mov	[edx+ecx], bl
		movzx	edx, byte ptr [eax+16B9h]
		inc	dword ptr [eax+14h]
		add	dword ptr [eax+16BCh], 0FFFFFFF8h
		mov	[eax+16B8h], dx

loc_10027A9F:				; CODE XREF: sub_10027A30+46j
		pop	ebx
		retn
sub_10027A30	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_10028260

loc_10027AB0:				; CODE XREF: sub_10028260+1FEj
		mov	ecx, [eax+16BCh]
		push	ebx
		cmp	ecx, 8
		jle	short loc_10027ADE
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		movzx	ebx, byte ptr [eax+16B9h]
		jmp	short loc_10027AEE
; ---------------------------------------------------------------------------

loc_10027ADE:				; CODE XREF: sub_10028260-7A6j
		test	ecx, ecx
		jle	short loc_10027AF4
		mov	ecx, [eax+8]
		mov	edx, [eax+14h]
		mov	bl, [eax+16B8h]

loc_10027AEE:				; CODE XREF: sub_10028260-784j
		mov	[ecx+edx], bl
		inc	dword ptr [eax+14h]

loc_10027AF4:				; CODE XREF: sub_10028260-780j
		xor	ecx, ecx
		mov	[eax+16B8h], cx
		mov	[eax+16BCh], ecx
		pop	ebx
		retn
; END OF FUNCTION CHUNK	FOR sub_10028260
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027B10	proc near		; CODE XREF: sub_10027FB0+72p
					; sub_10027FB0+9Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [eax+16BCh]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	esi, 1
		cmp	edx, 8
		jle	short loc_10027B4D
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	edi, [eax+8]
		mov	[edx+edi], bl
		add	[eax+14h], esi
		movzx	ebx, byte ptr [eax+16B9h]
		mov	edi, [eax+14h]
		mov	edx, [eax+8]
		mov	[edi+edx], bl
		jmp	short loc_10027B60
; ---------------------------------------------------------------------------

loc_10027B4D:				; CODE XREF: sub_10027B10+16j
		test	edx, edx
		jle	short loc_10027B63
		mov	edx, [eax+8]
		mov	edi, [eax+14h]
		mov	bl, [eax+16B8h]
		mov	[edx+edi], bl

loc_10027B60:				; CODE XREF: sub_10027B10+3Bj
		add	[eax+14h], esi

loc_10027B63:				; CODE XREF: sub_10027B10+3Fj
		xor	edx, edx
		mov	[eax+16B8h], dx
		mov	[eax+16BCh], edx
		mov	dword ptr [eax+16B4h], 8
		cmp	[esp+10h+arg_4], edx
		jz	short loc_10027BC2
		mov	edx, [eax+14h]
		mov	edi, [eax+8]
		mov	[edx+edi], cl
		add	[eax+14h], esi
		mov	edi, [eax+14h]
		mov	ebx, [eax+8]
		mov	edx, ecx
		shr	edx, 8
		mov	[edi+ebx], dl
		add	[eax+14h], esi
		mov	edi, [eax+14h]
		mov	ebx, [eax+8]
		mov	dl, cl
		not	dl
		mov	[edi+ebx], dl
		add	[eax+14h], esi
		mov	edi, [eax+14h]
		mov	ebx, [eax+8]
		mov	edx, ecx
		not	edx
		shr	edx, 8
		mov	[edi+ebx], dl
		add	[eax+14h], esi

loc_10027BC2:				; CODE XREF: sub_10027B10+70j
		test	ecx, ecx
		jz	short loc_10027BDB

loc_10027BC6:				; CODE XREF: sub_10027B10+C9j
		mov	bl, [ebp+0]
		mov	edx, [eax+14h]
		mov	edi, [eax+8]
		mov	[edx+edi], bl
		add	[eax+14h], esi
		add	ebp, esi
		sub	ecx, esi
		jnz	short loc_10027BC6

loc_10027BDB:				; CODE XREF: sub_10027B10+B4j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10027B10	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027BE0	proc near		; CODE XREF: sub_10024060+73p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		lea	eax, [edx+94h]
		lea	ecx, [edx+988h]
		mov	[edx+0B18h], eax
		mov	[edx+0B24h], ecx
		xor	ecx, ecx
		lea	eax, [edx+0A7Ch]
		mov	dword ptr [edx+0B20h], offset off_10037150
		mov	dword ptr [edx+0B2Ch], offset off_10037164
		mov	[edx+0B30h], eax
		mov	dword ptr [edx+0B38h], offset dword_10037178
		mov	[edx+16B8h], cx
		mov	[edx+16BCh], ecx
		mov	dword ptr [edx+16B4h], 8
		jmp	sub_100269C0
sub_10027BE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027C50	proc near		; CODE XREF: sub_10027CE0+1E5p

var_24		= word ptr -24h
var_22		= byte ptr -22h
var_4		= dword	ptr -4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	esi
		lea	esi, [esp+28h+var_22]
		xor	ecx, ecx
		mov	eax, 1
		sub	edx, esi
		lea	esp, [esp+0]

loc_10027C70:				; CODE XREF: sub_10027C50+3Aj
		lea	esi, [edx+eax*2]
		mov	si, [esp+esi+28h+var_24]
		add	si, cx
		add	si, si
		movzx	ecx, si
		mov	[esp+eax*2+28h+var_24],	cx
		inc	eax
		cmp	eax, 0Fh
		jle	short loc_10027C70
		xor	esi, esi
		test	ebx, ebx
		js	short loc_10027CCC
		push	ebp

loc_10027C93:				; CODE XREF: sub_10027C50+79j
		movzx	edx, word ptr [edi+esi*4+2]
		test	edx, edx
		jz	short loc_10027CC6
		movzx	eax, [esp+edx*2+2Ch+var_24]
		mov	ecx, eax
		inc	eax
		mov	[esp+edx*2+2Ch+var_24],	ax
		xor	eax, eax
		jmp	short loc_10027CB0
; ---------------------------------------------------------------------------
		align 10h

loc_10027CB0:				; CODE XREF: sub_10027C50+5Bj
					; sub_10027C50+6Ej
		mov	ebp, ecx
		and	ebp, 1
		or	eax, ebp
		dec	edx
		shr	ecx, 1
		add	eax, eax
		test	edx, edx
		jg	short loc_10027CB0
		shr	eax, 1
		mov	[edi+esi*4], ax

loc_10027CC6:				; CODE XREF: sub_10027C50+4Aj
		inc	esi
		cmp	esi, ebx
		jle	short loc_10027C93
		pop	ebp

loc_10027CCC:				; CODE XREF: sub_10027C50+40j
		mov	ecx, [esp+28h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10027C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027CE0	proc near		; CODE XREF: sub_10027EE0+2Ep
					; sub_10028260+34p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		push	ebx
		push	ebp
		push	edi
		mov	edi, [eax]
		mov	eax, [eax+8]
		mov	ecx, [eax+0Ch]
		mov	edx, [eax]
		xor	ebx, ebx
		or	ebp, 0FFFFFFFFh
		xor	eax, eax
		mov	[esp+14h+var_4], ecx
		mov	[esp+14h+var_8], ebp
		mov	[esi+1450h], ebx
		mov	dword ptr [esi+1454h], 23Dh
		cmp	ecx, ebx
		jle	short loc_10027D4D

loc_10027D17:				; CODE XREF: sub_10027CE0+6Bj
		cmp	[edi+eax*4], bx
		jz	short loc_10027D3F
		inc	dword ptr [esi+1450h]
		mov	ecx, [esi+1450h]
		mov	[esi+ecx*4+0B5Ch], eax
		mov	[esp+14h+var_8], eax
		mov	[eax+esi+1458h], bl
		mov	ebp, eax
		jmp	short loc_10027D46
; ---------------------------------------------------------------------------

loc_10027D3F:				; CODE XREF: sub_10027CE0+3Bj
		xor	ecx, ecx
		mov	[edi+eax*4+2], cx

loc_10027D46:				; CODE XREF: sub_10027CE0+5Dj
		inc	eax
		cmp	eax, [esp+14h+var_4]
		jl	short loc_10027D17

loc_10027D4D:				; CODE XREF: sub_10027CE0+35j
		cmp	dword ptr [esi+1450h], 2
		jge	short loc_10027DA7

loc_10027D56:				; CODE XREF: sub_10027CE0+C1j
		cmp	ebp, 2
		jge	short loc_10027D60
		inc	ebp
		mov	eax, ebp
		jmp	short loc_10027D62
; ---------------------------------------------------------------------------

loc_10027D60:				; CODE XREF: sub_10027CE0+79j
		xor	eax, eax

loc_10027D62:				; CODE XREF: sub_10027CE0+7Ej
		inc	dword ptr [esi+1450h]
		mov	ecx, [esi+1450h]
		mov	[esi+ecx*4+0B5Ch], eax
		mov	ecx, 1
		mov	[edi+eax*4], cx
		mov	[esi+eax+1458h], bl
		dec	dword ptr [esi+16A8h]
		cmp	edx, ebx
		jz	short loc_10027D9A
		movzx	eax, word ptr [edx+eax*4+2]
		sub	[esi+16ACh], eax

loc_10027D9A:				; CODE XREF: sub_10027CE0+ADj
		cmp	dword ptr [esi+1450h], 2
		jl	short loc_10027D56
		mov	[esp+14h+var_8], ebp

loc_10027DA7:				; CODE XREF: sub_10027CE0+74j
		mov	ecx, [esp+14h+arg_0]
		mov	[ecx+4], ebp
		mov	eax, [esi+1450h]
		cdq
		sub	eax, edx
		mov	ebp, eax
		sar	ebp, 1
		cmp	ebp, 1
		jl	short loc_10027DD1

loc_10027DC0:				; CODE XREF: sub_10027CE0+EFj
		push	ebp
		mov	eax, esi
		call	sub_10026A40
		dec	ebp
		add	esp, 4
		cmp	ebp, 1
		jge	short loc_10027DC0

loc_10027DD1:				; CODE XREF: sub_10027CE0+DEj
		mov	ebx, [esp+14h+var_4]
		jmp	short loc_10027DE0
; ---------------------------------------------------------------------------
		align 10h

loc_10027DE0:				; CODE XREF: sub_10027CE0+F5j
					; sub_10027CE0+1B1j
		mov	eax, [esi+1450h]
		mov	edx, [esi+eax*4+0B5Ch]
		mov	ebp, [esi+0B60h]
		dec	eax
		mov	[esi+1450h], eax
		push	1
		mov	eax, esi
		mov	[esi+0B60h], edx
		call	sub_10026A40
		mov	eax, [esi+0B60h]
		or	edx, 0FFFFFFFFh
		add	[esi+1454h], edx
		mov	ecx, [esi+1454h]
		mov	[esi+ecx*4+0B5Ch], ebp
		add	[esi+1454h], edx
		mov	ecx, [esi+1454h]
		mov	[esi+ecx*4+0B5Ch], eax
		mov	cx, [edi+eax*4]
		add	cx, [edi+ebp*4]
		add	esp, 4
		mov	[edi+ebx*4], cx
		mov	cl, [esi+eax+1458h]
		mov	dl, [esi+ebp+1458h]
		cmp	dl, cl
		jb	short loc_10027E5E
		movzx	ecx, dl
		jmp	short loc_10027E61
; ---------------------------------------------------------------------------

loc_10027E5E:				; CODE XREF: sub_10027CE0+177j
		movzx	ecx, cl

loc_10027E61:				; CODE XREF: sub_10027CE0+17Cj
		inc	cl
		mov	[esi+ebx+1458h], cl
		movzx	ecx, bx
		mov	[edi+eax*4+2], cx
		mov	[edi+ebp*4+2], cx
		mov	[esi+0B60h], ebx
		push	1
		mov	eax, esi
		inc	ebx
		call	sub_10026A40
		add	esp, 4
		cmp	dword ptr [esi+1450h], 2
		jge	loc_10027DE0
		dec	dword ptr [esi+1454h]
		mov	eax, [esi+1454h]
		mov	edx, [esi+0B60h]
		mov	ecx, [esp+14h+arg_0]
		mov	[esi+eax*4+0B5Ch], edx
		mov	eax, esi
		call	sub_10026B10
		mov	ebx, [esp+14h+var_8]
		lea	edx, [esi+0B3Ch]
		call	sub_10027C50
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10027CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027EE0	proc near		; CODE XREF: sub_10028260+4Ap
		push	esi
		mov	esi, eax
		mov	ecx, [esi+0B1Ch]
		lea	eax, [esi+94h]
		push	esi
		call	sub_10026D30
		mov	ecx, [esi+0B28h]
		lea	eax, [esi+988h]
		push	esi
		call	sub_10026D30
		lea	eax, [esi+0B30h]
		push	eax
		call	sub_10027CE0
		add	esp, 0Ch
		mov	eax, 12h
		jmp	short loc_10027F20
; ---------------------------------------------------------------------------
		align 10h

loc_10027F20:				; CODE XREF: sub_10027EE0+3Bj
					; sub_10027EE0+8Ej
		movzx	ecx, ds:byte_10033254[eax]
		cmp	word ptr [esi+ecx*4+0A7Eh], 0
		jnz	short loc_10027F9B
		movzx	edx, ds:byte_10033253[eax]
		cmp	word ptr [esi+edx*4+0A7Eh], 0
		jnz	short loc_10027F7C
		movzx	ecx, ds:byte_10033252[eax]
		cmp	word ptr [esi+ecx*4+0A7Eh], 0
		jnz	short loc_10027F89
		movzx	edx, ds:byte_10033251[eax]
		cmp	word ptr [esi+edx*4+0A7Eh], 0
		jnz	short loc_10027F98
		sub	eax, 4
		cmp	eax, 3
		jge	short loc_10027F20
		lea	ecx, [eax+eax*2+11h]
		add	[esi+16A8h], ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10027F7C:				; CODE XREF: sub_10027EE0+62j
		dec	eax
		lea	ecx, [eax+eax*2+11h]
		add	[esi+16A8h], ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10027F89:				; CODE XREF: sub_10027EE0+74j
		sub	eax, 2
		lea	ecx, [eax+eax*2+11h]
		add	[esi+16A8h], ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10027F98:				; CODE XREF: sub_10027EE0+86j
		sub	eax, 3

loc_10027F9B:				; CODE XREF: sub_10027EE0+50j
		lea	ecx, [eax+eax*2+11h]
		add	[esi+16A8h], ecx
		pop	esi
		retn
sub_10027EE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10027FB0	proc near		; CODE XREF: sub_100240F0+6DDp
					; sub_10028260+8Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+16BCh]
		cmp	ecx, 0Dh
		jle	short loc_1002802B
		push	ebx
		push	esi
		mov	esi, [esp+8+arg_C]
		mov	dx, si
		shl	dx, cl
		mov	ecx, [eax+8]
		or	[eax+16B8h], dx
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	[ecx+edx], bl
		movzx	ebx, byte ptr [eax+16B9h]
		inc	dword ptr [eax+14h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		inc	dword ptr [eax+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	si, cl
		mov	ecx, [esp+8+arg_4]
		add	edx, 0FFFFFFF3h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		pop	esi
		pop	ebx
		push	1
		push	ecx
		mov	ecx, [esp+8+arg_8]
		call	sub_10027B10
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1002802B:				; CODE XREF: sub_10027FB0+Dj
		mov	dx, word ptr [esp+arg_C]
		shl	dx, cl
		add	ecx, 3
		mov	[eax+16BCh], ecx
		mov	ecx, [esp+arg_4]
		or	[eax+16B8h], dx
		push	1
		push	ecx
		mov	ecx, [esp+8+arg_8]
		call	sub_10027B10
		add	esp, 8
		retn
sub_10027FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10028060	proc near		; CODE XREF: sub_100240F0+6C7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+16BCh]
		mov	edx, 2
		shl	dx, cl
		push	ebx
		push	esi
		push	edi
		or	[eax+16B8h], dx
		mov	esi, 1
		cmp	ecx, 0Dh
		jle	short loc_100280D0
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], esi
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], esi
		mov	cl, 10h
		sub	cl, dl
		mov	edi, 2
		shr	di, cl
		add	edx, 0FFFFFFF3h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	short loc_100280D9
; ---------------------------------------------------------------------------

loc_100280D0:				; CODE XREF: sub_10028060+24j
		add	ecx, 3
		mov	[eax+16BCh], ecx

loc_100280D9:				; CODE XREF: sub_10028060+6Ej
		mov	ecx, [eax+16BCh]
		xor	edx, edx
		shl	dx, cl
		or	[eax+16B8h], dx
		cmp	ecx, 9
		jle	short loc_10028137
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], esi
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], esi
		mov	cl, 10h
		sub	cl, dl
		xor	edi, edi
		shr	di, cl
		add	edx, 0FFFFFFF7h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	short loc_10028140
; ---------------------------------------------------------------------------

loc_10028137:				; CODE XREF: sub_10028060+8Ej
		add	ecx, 7
		mov	[eax+16BCh], ecx

loc_10028140:				; CODE XREF: sub_10028060+D5j
		call	sub_10027A30
		mov	ecx, [eax+16BCh]
		mov	edx, [eax+16B4h]
		sub	edx, ecx
		add	edx, 0Bh
		cmp	edx, 9
		jge	loc_10028243
		mov	edx, 2
		shl	dx, cl
		or	[eax+16B8h], dx
		cmp	ecx, 0Dh
		jle	short loc_100281BD
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], esi
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], esi
		mov	cl, 10h
		sub	cl, dl
		mov	edi, 2
		shr	di, cl
		add	edx, 0FFFFFFF3h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], di
		jmp	short loc_100281C6
; ---------------------------------------------------------------------------

loc_100281BD:				; CODE XREF: sub_10028060+111j
		add	ecx, 3
		mov	[eax+16BCh], ecx

loc_100281C6:				; CODE XREF: sub_10028060+15Bj
		mov	ecx, [eax+16BCh]
		xor	edx, edx
		shl	dx, cl
		or	[eax+16B8h], dx
		cmp	ecx, 9
		jle	short loc_10028235
		movzx	ebx, byte ptr [eax+16B8h]
		mov	edx, [eax+14h]
		mov	ecx, [eax+8]
		mov	[ecx+edx], bl
		add	[eax+14h], esi
		movzx	ebx, byte ptr [eax+16B9h]
		mov	ecx, [eax+14h]
		mov	edx, [eax+8]
		mov	[ecx+edx], bl
		mov	edx, [eax+16BCh]
		add	[eax+14h], esi
		mov	cl, 10h
		sub	cl, dl
		xor	esi, esi
		shr	si, cl
		add	edx, 0FFFFFFF7h
		mov	[eax+16BCh], edx
		mov	[eax+16B8h], si
		call	sub_10027A30
		pop	edi
		pop	esi
		mov	dword ptr [eax+16B4h], 7
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10028235:				; CODE XREF: sub_10028060+17Bj
		add	ecx, 7
		mov	[eax+16BCh], ecx
		call	sub_10027A30

loc_10028243:				; CODE XREF: sub_10028060+F9j
		pop	edi
		pop	esi
		mov	dword ptr [eax+16B4h], 7
		pop	ebx
		retn
sub_10028060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10028260	proc near		; CODE XREF: sub_100232F0+76p
					; sub_100232F0+104p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

; FUNCTION CHUNK AT 10027AB0 SIZE 00000055 BYTES

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		cmp	dword ptr [esi+84h], 0
		push	edi
		mov	[esp+10h+var_4], 0
		jle	short loc_100282D1
		mov	edi, [esi]
		cmp	dword ptr [edi+2Ch], 2
		jnz	short loc_1002828D
		call	sub_100279C0
		mov	[edi+2Ch], eax

loc_1002828D:				; CODE XREF: sub_10028260+23j
		lea	eax, [esi+0B18h]
		push	eax
		call	sub_10027CE0
		lea	ecx, [esi+0B24h]
		push	ecx
		call	sub_10027CE0
		add	esp, 8
		mov	eax, esi
		call	sub_10027EE0
		mov	edx, [esi+16A8h]
		mov	ecx, [esi+16ACh]
		add	edx, 0Ah
		add	ecx, 0Ah
		shr	edx, 3
		shr	ecx, 3
		mov	[esp+10h+var_4], eax
		cmp	ecx, edx
		ja	short loc_100282D6
		jmp	short loc_100282D4
; ---------------------------------------------------------------------------

loc_100282D1:				; CODE XREF: sub_10028260+1Bj
		lea	ecx, [ebx+5]

loc_100282D4:				; CODE XREF: sub_10028260+6Fj
		mov	edx, ecx

loc_100282D6:				; CODE XREF: sub_10028260+6Dj
		lea	eax, [ebx+4]
		cmp	eax, edx
		ja	short loc_100282FA
		mov	eax, [esp+10h+arg_4]
		test	eax, eax
		jz	short loc_100282FA
		mov	edi, [esp+10h+arg_C]
		push	edi
		push	ebx
		push	eax
		push	esi
		call	sub_10027FB0
		add	esp, 10h
		jmp	loc_1002844B
; ---------------------------------------------------------------------------

loc_100282FA:				; CODE XREF: sub_10028260+7Bj
					; sub_10028260+83j
		cmp	dword ptr [esi+88h], 4
		jz	loc_100283C0
		cmp	ecx, edx
		jz	loc_100283C0
		mov	ecx, [esi+16BCh]
		mov	edi, [esp+10h+arg_C]
		lea	edx, [edi+4]
		cmp	ecx, 0Dh
		jle	short loc_10028373
		mov	ax, dx
		shl	ax, cl
		mov	ecx, [esi+14h]
		or	[esi+16B8h], ax
		movzx	ebx, byte ptr [esi+16B8h]
		mov	eax, [esi+8]
		mov	[ecx+eax], bl
		inc	dword ptr [esi+14h]
		movzx	ebx, byte ptr [esi+16B9h]
		mov	ecx, [esi+14h]
		mov	eax, [esi+8]
		mov	[ecx+eax], bl
		mov	ebx, [esi+16BCh]
		inc	dword ptr [esi+14h]
		mov	cl, 10h
		sub	cl, bl
		shr	dx, cl
		add	ebx, 0FFFFFFF3h
		mov	[esi+16BCh], ebx
		mov	[esi+16B8h], dx
		jmp	short loc_10028386
; ---------------------------------------------------------------------------

loc_10028373:				; CODE XREF: sub_10028260+BFj
		shl	dx, cl
		or	[esi+16B8h], dx
		add	ecx, 3
		mov	[esi+16BCh], ecx

loc_10028386:				; CODE XREF: sub_10028260+111j
		mov	eax, [esp+10h+var_4]
		mov	ecx, [esi+0B28h]
		mov	edx, [esi+0B1Ch]
		inc	eax
		push	eax
		inc	ecx
		push	ecx
		inc	edx
		push	edx
		mov	eax, esi
		call	sub_10027340
		lea	eax, [esi+988h]
		push	eax
		lea	ecx, [esi+94h]
		push	ecx
		mov	eax, esi
		call	sub_100275A0
		add	esp, 14h
		jmp	loc_1002844B
; ---------------------------------------------------------------------------

loc_100283C0:				; CODE XREF: sub_10028260+A1j
					; sub_10028260+A9j
		mov	ecx, [esi+16BCh]
		mov	edi, [esp+10h+arg_C]
		lea	eax, [edi+2]
		cmp	ecx, 0Dh
		jle	short loc_10028424
		mov	dx, ax
		shl	dx, cl
		mov	ecx, [esi+14h]
		or	[esi+16B8h], dx
		movzx	ebx, byte ptr [esi+16B8h]
		mov	edx, [esi+8]
		mov	[ecx+edx], bl
		inc	dword ptr [esi+14h]
		movzx	ebx, byte ptr [esi+16B9h]
		mov	ecx, [esi+14h]
		mov	edx, [esi+8]
		mov	[ecx+edx], bl
		mov	edx, [esi+16BCh]
		inc	dword ptr [esi+14h]
		mov	cl, 10h
		sub	cl, dl
		shr	ax, cl
		add	edx, 0FFFFFFF3h
		mov	[esi+16BCh], edx
		mov	[esi+16B8h], ax
		jmp	short loc_10028437
; ---------------------------------------------------------------------------

loc_10028424:				; CODE XREF: sub_10028260+170j
		shl	ax, cl
		or	[esi+16B8h], ax
		add	ecx, 3
		mov	[esi+16BCh], ecx

loc_10028437:				; CODE XREF: sub_10028260+1C2j
		push	offset dword_100337B0
		push	offset dword_10033330
		mov	eax, esi
		call	sub_100275A0
		add	esp, 8

loc_1002844B:				; CODE XREF: sub_10028260+95j
					; sub_10028260+15Bj
		mov	edx, esi
		call	sub_100269C0
		test	edi, edi
		pop	edi
		jz	short loc_10028463
		mov	eax, esi
		pop	esi
		pop	ebx
		add	esp, 4
		jmp	loc_10027AB0
; ---------------------------------------------------------------------------

loc_10028463:				; CODE XREF: sub_10028260+1F5j
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_10028260	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10028470:				; DATA XREF: sub_10024920+3Fo
					; sub_10024C90+3Ao
		mov	eax, [esp+8]
		imul	eax, [esp+0Ch]
		push	eax
		call	ds:malloc
		add	esp, 4
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10028490:				; DATA XREF: sub_10024920+4Eo
					; sub_10024C90+49o
		mov	eax, [esp+8]
		push	eax
		call	ds:free
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100284A0	proc near		; CODE XREF: sub_10024E50+DB0p

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 3Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ecx, [esp+4Ch+arg_0]
		mov	eax, [ecx+1Ch]
		mov	edx, [ecx+4]
		mov	ebx, [eax+38h]
		mov	ebp, [ecx]
		dec	ebp
		lea	edx, [edx+ebp-5]
		mov	[esp+4Ch+var_38], edx
		mov	esi, [ecx+0Ch]
		mov	ecx, [ecx+10h]
		mov	edx, ecx
		sub	edx, [esp+4Ch+arg_4]
		dec	esi
		add	edx, esi
		lea	ecx, [ecx+esi-101h]
		mov	[esp+4Ch+var_14], edx
		mov	edx, [eax+28h]
		mov	[esp+4Ch+var_20], ecx
		mov	ecx, [eax+2Ch]
		mov	[esp+4Ch+var_24], edx
		mov	edx, [eax+30h]
		mov	[esp+4Ch+var_10], ecx
		mov	ecx, [eax+34h]
		mov	[esp+4Ch+var_8], edx
		mov	edx, [eax+4Ch]
		mov	[esp+4Ch+var_C], ecx
		mov	ecx, [eax+50h]
		mov	[esp+4Ch+var_2C], edx
		mov	[esp+4Ch+var_28], ecx
		mov	ecx, [eax+54h]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [eax+58h]
		mov	[esp+4Ch+var_34], eax
		mov	edi, [eax+3Ch]
		mov	[esp+4Ch+arg_4], 1
		mov	eax, [esp+4Ch+arg_4]
		shl	eax, cl
		dec	edx
		mov	[esp+4Ch+var_3C], ebp
		mov	[esp+4Ch+var_4], edx
		dec	eax
		mov	[esp+4Ch+var_1C], eax

loc_10028537:				; CODE XREF: sub_100284A0+368j
		cmp	edi, 0Fh
		jnb	short loc_1002855B
		movzx	eax, byte ptr [ebp+1]
		mov	ecx, edi
		shl	eax, cl
		add	ebp, 2
		lea	ecx, [edi+8]
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, eax
		movzx	eax, byte ptr [ebp+0]
		shl	eax, cl
		add	ebx, eax
		add	edi, 10h

loc_1002855B:				; CODE XREF: sub_100284A0+9Aj
		mov	ecx, [esp+4Ch+var_2C]
		and	edx, ebx
		mov	eax, [ecx+edx*4]
		mov	edx, eax
		shr	edx, 8
		movzx	ecx, dl
		shr	ebx, cl
		sub	edi, ecx
		movzx	edx, al
		test	al, al
		jz	short loc_100285B0

loc_10028577:				; CODE XREF: sub_100284A0+10Ej
		test	dl, 10h
		jnz	short loc_100285BB
		test	dl, 40h
		jnz	loc_1002886F
		mov	ecx, edx
		mov	edx, 1
		shl	edx, cl
		shr	eax, 10h
		dec	edx
		and	edx, ebx
		add	edx, eax
		mov	eax, [esp+4Ch+var_2C]
		mov	eax, [eax+edx*4]
		mov	ecx, eax
		shr	ecx, 8
		movzx	ecx, cl
		shr	ebx, cl
		sub	edi, ecx
		movzx	edx, al
		test	al, al
		jnz	short loc_10028577

loc_100285B0:				; CODE XREF: sub_100284A0+D5j
		inc	esi
		shr	eax, 10h
		mov	[esi], al
		jmp	loc_100287EE
; ---------------------------------------------------------------------------

loc_100285BB:				; CODE XREF: sub_100284A0+DAj
		shr	eax, 10h
		and	edx, 0Fh
		mov	[esp+4Ch+arg_4], eax
		jz	short loc_100285F1
		cmp	edi, edx
		jnb	short loc_100285DD
		movzx	eax, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	eax, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, eax
		add	edi, 8

loc_100285DD:				; CODE XREF: sub_100284A0+129j
		mov	ecx, edx
		mov	eax, 1
		shl	eax, cl
		dec	eax
		and	eax, ebx
		add	[esp+4Ch+arg_4], eax
		shr	ebx, cl
		sub	edi, edx

loc_100285F1:				; CODE XREF: sub_100284A0+125j
		cmp	edi, 0Fh
		jnb	short loc_10028615
		movzx	edx, byte ptr [ebp+1]
		movzx	eax, byte ptr [ebp+2]
		add	ebp, 2
		mov	ecx, edi
		shl	edx, cl
		lea	ecx, [edi+8]
		shl	eax, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, edx
		add	ebx, eax
		add	edi, 10h

loc_10028615:				; CODE XREF: sub_100284A0+154j
		mov	ecx, [esp+4Ch+var_1C]
		mov	edx, [esp+4Ch+var_28]
		and	ecx, ebx
		mov	edx, [edx+ecx*4]
		mov	eax, edx
		shr	eax, 8
		movzx	ecx, al
		movzx	eax, dl
		shr	ebx, cl
		sub	edi, ecx
		mov	[esp+4Ch+var_30], edx
		test	al, 10h
		jnz	short loc_10028679
		lea	esp, [esp+0]

loc_10028640:				; CODE XREF: sub_100284A0+1D7j
		test	al, 40h
		jnz	loc_10028862
		mov	ecx, eax
		movzx	eax, word ptr [esp+4Ch+var_30+2]
		mov	edx, 1
		shl	edx, cl
		mov	ecx, [esp+4Ch+var_28]
		dec	edx
		and	edx, ebx
		add	edx, eax
		mov	edx, [ecx+edx*4]
		mov	eax, edx
		shr	eax, 8
		movzx	ecx, al
		movzx	eax, dl
		shr	ebx, cl
		sub	edi, ecx
		mov	[esp+4Ch+var_30], edx
		test	al, 10h
		jz	short loc_10028640

loc_10028679:				; CODE XREF: sub_100284A0+197j
		shr	edx, 10h
		and	eax, 0Fh
		mov	[esp+4Ch+var_30], edx
		cmp	edi, eax
		jnb	short loc_100286AF
		movzx	edx, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	edx, cl
		add	edi, 8
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, edx
		cmp	edi, eax
		jnb	short loc_100286AF
		movzx	edx, byte ptr [ebp+1]
		inc	ebp
		mov	ecx, edi
		shl	edx, cl
		mov	[esp+4Ch+var_3C], ebp
		add	ebx, edx
		add	edi, 8

loc_100286AF:				; CODE XREF: sub_100284A0+1E5j
					; sub_100284A0+1FBj
		mov	edx, 1
		mov	ecx, eax
		shl	edx, cl
		sub	edi, eax
		mov	eax, esi
		sub	eax, [esp+4Ch+var_14]
		dec	edx
		and	edx, ebx
		mov	[esp+4Ch+var_18], edx
		mov	edx, [esp+4Ch+var_30]
		add	edx, [esp+4Ch+var_18]
		shr	ebx, cl
		mov	[esp+4Ch+var_30], edx
		cmp	edx, eax
		jbe	loc_1002880D
		mov	ebp, edx
		sub	ebp, eax
		cmp	ebp, [esp+4Ch+var_10]
		jbe	short loc_100286F8
		mov	eax, [esp+4Ch+var_34]
		cmp	dword ptr [eax+1BC0h], 0
		jnz	loc_10028851

loc_100286F8:				; CODE XREF: sub_100284A0+245j
		mov	ecx, [esp+4Ch+var_C]
		mov	eax, [esp+4Ch+var_8]
		dec	ecx
		mov	[esp+4Ch+var_18], ecx
		test	eax, eax
		jnz	short loc_1002872C
		mov	eax, [esp+4Ch+var_24]
		sub	eax, ebp
		add	ecx, eax
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	short loc_10028790
		sub	[esp+4Ch+arg_4], ebp
		jmp	short loc_10028720
; ---------------------------------------------------------------------------
		align 10h

loc_10028720:				; CODE XREF: sub_100284A0+27Bj
					; sub_100284A0+288j
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		dec	ebp
		mov	[esi], al
		jnz	short loc_10028720
		jmp	short loc_1002878C
; ---------------------------------------------------------------------------

loc_1002872C:				; CODE XREF: sub_100284A0+267j
		cmp	eax, ebp
		jnb	short loc_10028774
		mov	edx, eax
		sub	edx, ebp
		add	edx, [esp+4Ch+var_24]
		sub	ebp, eax
		add	ecx, edx
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	short loc_10028790
		sub	[esp+4Ch+arg_4], ebp
		sub	ecx, esi

loc_10028748:				; CODE XREF: sub_100284A0+2B0j
		mov	dl, [ecx+esi+1]
		inc	esi
		dec	ebp
		mov	[esi], dl
		jnz	short loc_10028748
		mov	ecx, [esp+4Ch+var_18]
		cmp	eax, [esp+4Ch+arg_4]
		jnb	short loc_10028790
		sub	[esp+4Ch+arg_4], eax
		mov	ebp, eax

loc_10028762:				; CODE XREF: sub_100284A0+2CAj
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		dec	ebp
		mov	[esi], al
		jnz	short loc_10028762
		mov	ecx, esi
		sub	ecx, [esp+4Ch+var_30]
		jmp	short loc_10028790
; ---------------------------------------------------------------------------

loc_10028774:				; CODE XREF: sub_100284A0+28Ej
		sub	eax, ebp
		add	ecx, eax
		cmp	ebp, [esp+4Ch+arg_4]
		jnb	short loc_10028790
		sub	[esp+4Ch+arg_4], ebp

loc_10028782:				; CODE XREF: sub_100284A0+2EAj
		mov	al, [ecx+1]
		inc	ecx
		inc	esi
		dec	ebp
		mov	[esi], al
		jnz	short loc_10028782

loc_1002878C:				; CODE XREF: sub_100284A0+28Aj
		mov	ecx, esi
		sub	ecx, edx

loc_10028790:				; CODE XREF: sub_100284A0+275j
					; sub_100284A0+2A0j ...
		mov	eax, [esp+4Ch+arg_4]
		cmp	eax, 2
		jbe	short loc_100287D1
		lea	edx, [eax-3]
		mov	eax, 0AAAAAAABh
		mul	edx
		mov	ebp, edx
		shr	ebp, 1
		inc	ebp
		jmp	short loc_100287B0
; ---------------------------------------------------------------------------
		align 10h

loc_100287B0:				; CODE XREF: sub_100284A0+308j
					; sub_100284A0+32Fj
		movzx	eax, byte ptr [ecx+1]
		sub	[esp+4Ch+arg_4], 3
		mov	[esi+1], al
		mov	dl, [ecx+2]
		mov	[esi+2], dl
		movzx	eax, byte ptr [ecx+3]
		add	ecx, 3
		add	esi, 3
		dec	ebp
		mov	[esi], al
		jnz	short loc_100287B0

loc_100287D1:				; CODE XREF: sub_100284A0+2F7j
		mov	ebp, [esp+4Ch+arg_4]
		test	ebp, ebp
		jz	short loc_100287EA
		mov	dl, [ecx+1]
		inc	esi
		mov	[esi], dl
		cmp	ebp, 1
		jbe	short loc_100287EA
		mov	al, [ecx+2]
		inc	esi
		mov	[esi], al

loc_100287EA:				; CODE XREF: sub_100284A0+337j
					; sub_100284A0+342j
		mov	ebp, [esp+4Ch+var_3C]

loc_100287EE:				; CODE XREF: sub_100284A0+116j
					; sub_100284A0+39Cj ...
		mov	edx, [esp+4Ch+var_38]
		cmp	ebp, edx
		jnb	loc_10028899
		cmp	esi, [esp+4Ch+var_20]
		jnb	loc_10028899
		mov	edx, [esp+4Ch+var_4]
		jmp	loc_10028537
; ---------------------------------------------------------------------------

loc_1002880D:				; CODE XREF: sub_100284A0+237j
		mov	eax, esi
		sub	eax, edx

loc_10028811:				; CODE XREF: sub_100284A0+398j
		movzx	ecx, byte ptr [eax+1]
		mov	[esi+1], cl
		mov	dl, [eax+2]
		mov	[esi+2], dl
		movzx	ecx, byte ptr [eax+3]
		add	eax, 3
		add	esi, 3
		mov	[esi], cl
		mov	ecx, [esp+4Ch+arg_4]
		sub	ecx, 3
		mov	[esp+4Ch+arg_4], ecx
		cmp	ecx, 2
		ja	short loc_10028811
		test	ecx, ecx
		jz	short loc_100287EE
		mov	dl, [eax+1]
		inc	esi
		mov	[esi], dl
		cmp	ecx, 1
		jbe	short loc_100287EE
		mov	al, [eax+2]
		inc	esi
		mov	[esi], al
		jmp	short loc_100287EE
; ---------------------------------------------------------------------------

loc_10028851:				; CODE XREF: sub_100284A0+252j
		mov	ecx, [esp+4Ch+arg_0]
		mov	ebp, [esp+4Ch+var_3C]
		mov	dword ptr [ecx+18h], offset aInvalidDista_1 ; "invalid distance	too far	back"
		jmp	short loc_1002888F
; ---------------------------------------------------------------------------

loc_10028862:				; CODE XREF: sub_100284A0+1A2j
		mov	edx, [esp+4Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidDista_0 ; "invalid distance	code"
		jmp	short loc_1002888B
; ---------------------------------------------------------------------------

loc_1002886F:				; CODE XREF: sub_100284A0+DFj
		test	dl, 20h
		jz	short loc_10028880
		mov	ecx, [esp+4Ch+var_34]
		mov	dword ptr [ecx], 0Bh
		jmp	short loc_10028895
; ---------------------------------------------------------------------------

loc_10028880:				; CODE XREF: sub_100284A0+3D2j
		mov	edx, [esp+4Ch+arg_0]
		mov	dword ptr [edx+18h], offset aInvalidLiter_0 ; "invalid literal/length code"

loc_1002888B:				; CODE XREF: sub_100284A0+3CDj
		mov	eax, [esp+4Ch+var_34]

loc_1002888F:				; CODE XREF: sub_100284A0+3C0j
		mov	dword ptr [eax], 1Dh

loc_10028895:				; CODE XREF: sub_100284A0+3DEj
		mov	edx, [esp+4Ch+var_38]

loc_10028899:				; CODE XREF: sub_100284A0+354j
					; sub_100284A0+35Ej
		mov	eax, edi
		shr	eax, 3
		lea	ecx, ds:0[eax*8]
		sub	ebp, eax
		sub	edi, ecx
		mov	ecx, edi
		mov	eax, 1
		shl	eax, cl
		mov	ecx, [esp+4Ch+arg_0]
		sub	edx, ebp
		add	edx, 5
		dec	eax
		and	ebx, eax
		lea	eax, [ebp+1]
		mov	[ecx], eax
		lea	eax, [esi+1]
		mov	[ecx+0Ch], eax
		mov	eax, [esp+4Ch+var_20]
		sub	eax, esi
		add	eax, 101h
		mov	[ecx+10h], eax
		mov	eax, [esp+4Ch+var_34]
		mov	[ecx+4], edx
		mov	[eax+3Ch], edi
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax+38h], ebx
		pop	ebx
		add	esp, 3Ch
		retn
sub_100284A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100288F0	proc near		; CODE XREF: sub_10024E50+A22p
					; sub_10024E50+CF2p ...

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 8Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		mov	eax, [esp+8Ch+arg_14]
		mov	[esp+8Ch+var_80], eax
		xor	ecx, ecx
		mov	ax, cx
		movzx	edx, ax
		mov	eax, edx
		push	ebx
		mov	ebx, [esp+90h+arg_4]
		shl	edx, 10h
		or	eax, edx
		mov	edx, [esp+90h+arg_8]
		push	esi
		mov	esi, [esp+94h+arg_10]
		push	edi
		mov	edi, [esp+98h+arg_C]
		mov	[esp+98h+var_44], eax
		mov	[esp+98h+var_40], eax
		mov	[esp+98h+var_3C], eax
		mov	[esp+98h+var_38], eax
		mov	[esp+98h+var_34], eax
		mov	[esp+98h+var_30], eax
		mov	[esp+98h+var_2C], eax
		mov	[esp+98h+var_28], eax
		xor	eax, eax
		mov	[esp+98h+var_48], ebx
		mov	[esp+98h+var_68], edi
		mov	[esp+98h+var_50], esi
		test	edx, edx
		jz	short loc_10028982
		nop

loc_10028970:				; CODE XREF: sub_100288F0+90j
		movzx	ecx, word ptr [ebx+eax*2]
		inc	word ptr [esp+ecx*2+98h+var_44]
		lea	ecx, [esp+ecx*2+98h+var_44]
		inc	eax
		cmp	eax, edx
		jb	short loc_10028970

loc_10028982:				; CODE XREF: sub_100288F0+7Dj
		mov	eax, [esi]
		mov	[esp+98h+var_88], eax
		mov	edx, 0Fh
		lea	ecx, [ecx+0]

loc_10028990:				; CODE XREF: sub_100288F0+ACj
		cmp	word ptr [esp+edx*2+98h+var_44], 0
		jnz	short loc_1002899E
		dec	edx
		cmp	edx, 1
		jnb	short loc_10028990

loc_1002899E:				; CODE XREF: sub_100288F0+A6j
		mov	[esp+98h+var_78], edx
		cmp	eax, edx
		jbe	short loc_100289AC
		mov	[esp+98h+var_88], edx
		mov	eax, edx

loc_100289AC:				; CODE XREF: sub_100288F0+B4j
		test	edx, edx
		jnz	short loc_100289EA
		mov	ecx, [edi]
		mov	[esp+98h+var_8C], 140h
		mov	eax, [esp+98h+var_8C]
		mov	[ecx], eax
		add	dword ptr [edi], 4
		mov	ecx, [edi]
		mov	[ecx], eax
		add	dword ptr [edi], 4
		pop	edi
		mov	dword ptr [esi], 1
		pop	esi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+8Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
; ---------------------------------------------------------------------------

loc_100289EA:				; CODE XREF: sub_100288F0+BEj
		mov	ecx, 1
		cmp	edx, ecx
		jbe	short loc_10028A00

loc_100289F3:				; CODE XREF: sub_100288F0+10Ej
		cmp	word ptr [esp+ecx*2+98h+var_44], 0
		jnz	short loc_10028A00
		inc	ecx
		cmp	ecx, edx
		jb	short loc_100289F3

loc_10028A00:				; CODE XREF: sub_100288F0+101j
					; sub_100288F0+109j
		cmp	eax, ecx
		jnb	short loc_10028A08
		mov	[esp+98h+var_88], ecx

loc_10028A08:				; CODE XREF: sub_100288F0+112j
		mov	esi, 1
		mov	eax, esi
		push	ebp

loc_10028A10:				; CODE XREF: sub_100288F0+12Fj
		movzx	ebp, word ptr [esp+eax*2+9Ch+var_44]
		add	esi, esi
		sub	esi, ebp
		js	short loc_10028A35
		inc	eax
		cmp	eax, 0Fh
		jbe	short loc_10028A10
		test	esi, esi
		mov	esi, [esp+9Ch+arg_0]
		jle	short loc_10028A3D
		test	esi, esi
		jz	short loc_10028A35
		cmp	edx, 1
		jz	short loc_10028A3D

loc_10028A35:				; CODE XREF: sub_100288F0+129j
					; sub_100288F0+13Ej
		or	eax, 0FFFFFFFFh
		jmp	loc_10028D96
; ---------------------------------------------------------------------------

loc_10028A3D:				; CODE XREF: sub_100288F0+13Aj
					; sub_100288F0+143j
		xor	edx, edx
		mov	[esp+9Ch+var_22], dx
		mov	eax, 2
		lea	esp, [esp+0]

loc_10028A50:				; CODE XREF: sub_100288F0+175j
		mov	dx, [esp+eax+9Ch+var_24]
		add	dx, word ptr [esp+eax+9Ch+var_44]
		add	eax, 2
		mov	[esp+eax+9Ch+var_24], dx
		cmp	eax, 1Eh
		jb	short loc_10028A50
		mov	ebp, [esp+9Ch+var_80]
		xor	eax, eax
		cmp	[esp+9Ch+arg_8], eax
		jbe	short loc_10028AA2

loc_10028A76:				; CODE XREF: sub_100288F0+1B0j
		cmp	word ptr [ebx+eax*2], 0
		jz	short loc_10028A98
		movzx	edx, word ptr [ebx+eax*2]
		movzx	edx, [esp+edx*2+9Ch+var_24]
		mov	[ebp+edx*2+0], ax
		movzx	edx, word ptr [ebx+eax*2]
		inc	[esp+edx*2+9Ch+var_24]
		lea	edx, [esp+edx*2+9Ch+var_24]

loc_10028A98:				; CODE XREF: sub_100288F0+18Bj
		inc	eax
		cmp	eax, [esp+9Ch+arg_8]
		jb	short loc_10028A76

loc_10028AA2:				; CODE XREF: sub_100288F0+184j
		mov	eax, esi
		sub	eax, 0
		mov	edx, 0FFFFFFFFh
		jz	short loc_10028AED
		dec	eax
		jz	short loc_10028AC7
		mov	[esp+9Ch+var_64], offset dword_10033D70
		mov	[esp+9Ch+var_6C], offset dword_10033DB0
		mov	[esp+9Ch+var_70], edx
		jmp	short loc_10028AFD
; ---------------------------------------------------------------------------

loc_10028AC7:				; CODE XREF: sub_100288F0+1BFj
		mov	eax, offset dword_10033CF0
		sub	eax, 202h
		mov	[esp+9Ch+var_64], eax
		mov	eax, offset dword_10033D30
		sub	eax, 202h
		mov	[esp+9Ch+var_6C], eax
		mov	[esp+9Ch+var_70], 100h
		jmp	short loc_10028AFD
; ---------------------------------------------------------------------------

loc_10028AED:				; CODE XREF: sub_100288F0+1BCj
		mov	[esp+9Ch+var_6C], ebp
		mov	[esp+9Ch+var_64], ebp
		mov	[esp+9Ch+var_70], 13h

loc_10028AFD:				; CODE XREF: sub_100288F0+1D5j
					; sub_100288F0+1FBj
		mov	eax, [edi]
		mov	[esp+9Ch+var_84], ecx
		mov	ecx, [esp+9Ch+var_88]
		mov	[esp+9Ch+var_7C], eax
		mov	eax, 1
		shl	eax, cl
		xor	ebp, ebp
		xor	ebx, ebx
		mov	[esp+9Ch+var_74], edx
		lea	ecx, [eax-1]
		mov	[esp+9Ch+var_58], eax
		mov	[esp+9Ch+var_60], eax
		mov	[esp+9Ch+var_5C], ecx
		cmp	esi, 1
		jnz	short loc_10028B35
		cmp	eax, 354h
		jmp	short loc_10028B3F
; ---------------------------------------------------------------------------

loc_10028B35:				; CODE XREF: sub_100288F0+23Cj
		cmp	esi, 2
		jnz	short loc_10028B45
		cmp	eax, 250h

loc_10028B3F:				; CODE XREF: sub_100288F0+243j
		jnb	loc_10028D91

loc_10028B45:				; CODE XREF: sub_100288F0+248j
		mov	edx, [esp+9Ch+var_80]
		mov	[esp+9Ch+var_80], edx
		lea	ecx, [ecx+0]

loc_10028B50:				; CODE XREF: sub_100288F0+349j
					; sub_100288F0+35Dj ...
		mov	al, byte ptr [esp+9Ch+var_84]
		mov	esi, [esp+9Ch+var_80]
		mov	edx, [esp+9Ch+var_70]
		sub	al, bl
		mov	byte ptr [esp+9Ch+var_8C+1], al
		movzx	eax, word ptr [esi]
		mov	ecx, eax
		cmp	ecx, edx
		jge	short loc_10028B72
		mov	byte ptr [esp+9Ch+var_8C], 0
		jmp	short loc_10028B9A
; ---------------------------------------------------------------------------

loc_10028B72:				; CODE XREF: sub_100288F0+279j
		jle	short loc_10028B93
		movzx	eax, word ptr [esi]
		mov	ecx, [esp+9Ch+var_6C]
		add	eax, eax
		mov	dl, [eax+ecx]
		mov	ecx, [esp+9Ch+var_64]
		mov	byte ptr [esp+9Ch+var_8C], dl
		mov	dx, [eax+ecx]
		mov	word ptr [esp+9Ch+var_8C+2], dx
		jmp	short loc_10028B9F
; ---------------------------------------------------------------------------

loc_10028B93:				; CODE XREF: sub_100288F0:loc_10028B72j
		mov	byte ptr [esp+9Ch+var_8C], 60h
		xor	eax, eax

loc_10028B9A:				; CODE XREF: sub_100288F0+280j
		mov	word ptr [esp+9Ch+var_8C+2], ax

loc_10028B9F:				; CODE XREF: sub_100288F0+2A1j
		mov	ecx, [esp+9Ch+var_84]
		mov	eax, [esp+9Ch+var_58]
		sub	ecx, ebx
		mov	edx, 1
		shl	edx, cl
		mov	ecx, ebx
		mov	edi, ebp
		shr	edi, cl
		mov	ecx, [esp+9Ch+var_7C]
		mov	[esp+9Ch+var_4C], eax
		lea	esi, ds:0[edx*4]
		add	edi, eax
		lea	ecx, [ecx+edi*4]
		mov	edi, [esp+9Ch+var_8C]
		mov	edi, edi

loc_10028BD0:				; CODE XREF: sub_100288F0+2E6j
		sub	ecx, esi
		sub	eax, edx
		mov	[ecx], edi
		jnz	short loc_10028BD0
		mov	edx, [esp+9Ch+var_84]
		lea	ecx, [edx-1]
		mov	eax, 1
		shl	eax, cl
		test	ebp, eax
		jz	short loc_10028BF6
		lea	ebx, [ebx+0]

loc_10028BF0:				; CODE XREF: sub_100288F0+304j
		shr	eax, 1
		test	ebp, eax
		jnz	short loc_10028BF0

loc_10028BF6:				; CODE XREF: sub_100288F0+2F8j
		test	eax, eax
		jz	short loc_10028C03
		lea	ecx, [eax-1]
		and	ebp, ecx
		add	ebp, eax
		jmp	short loc_10028C05
; ---------------------------------------------------------------------------

loc_10028C03:				; CODE XREF: sub_100288F0+308j
		xor	ebp, ebp

loc_10028C05:				; CODE XREF: sub_100288F0+311j
		add	[esp+9Ch+var_80], 2
		mov	eax, 0FFFFh
		add	word ptr [esp+edx*2+9Ch+var_44], ax
		jnz	short loc_10028C35
		cmp	edx, [esp+9Ch+var_78]
		jz	loc_10028D06
		mov	ecx, [esp+9Ch+var_80]
		movzx	edx, word ptr [ecx]
		mov	eax, [esp+9Ch+var_48]
		movzx	ecx, word ptr [eax+edx*2]
		mov	[esp+9Ch+var_84], ecx
		mov	edx, ecx

loc_10028C35:				; CODE XREF: sub_100288F0+324j
		cmp	edx, [esp+9Ch+var_88]
		jbe	loc_10028B50
		mov	esi, [esp+9Ch+var_5C]
		and	esi, ebp
		mov	[esp+9Ch+var_54], esi
		cmp	esi, [esp+9Ch+var_74]
		jz	loc_10028B50
		test	ebx, ebx
		jnz	short loc_10028C5B
		mov	ebx, [esp+9Ch+var_88]

loc_10028C5B:				; CODE XREF: sub_100288F0+365j
		mov	edx, [esp+9Ch+var_7C]
		mov	eax, [esp+9Ch+var_4C]
		lea	ecx, [edx+eax*4]
		mov	[esp+9Ch+var_7C], ecx
		mov	ecx, [esp+9Ch+var_84]
		sub	ecx, ebx
		mov	eax, 1
		lea	edx, [ebx+ecx]
		shl	eax, cl
		cmp	edx, [esp+9Ch+var_78]
		jnb	short loc_10028C9E
		lea	esi, [esp+edx*2+9Ch+var_44]

loc_10028C84:				; CODE XREF: sub_100288F0+3A8j
		movzx	edi, word ptr [esi]
		sub	eax, edi
		test	eax, eax
		jle	short loc_10028C9A
		inc	edx
		inc	ecx
		add	esi, 2
		add	eax, eax
		cmp	edx, [esp+9Ch+var_78]
		jb	short loc_10028C84

loc_10028C9A:				; CODE XREF: sub_100288F0+39Bj
		mov	esi, [esp+9Ch+var_54]

loc_10028C9E:				; CODE XREF: sub_100288F0+38Ej
		mov	edx, [esp+9Ch+var_60]
		mov	eax, 1
		shl	eax, cl
		add	edx, eax
		mov	[esp+9Ch+var_58], eax
		mov	eax, [esp+9Ch+arg_0]
		mov	[esp+9Ch+var_60], edx
		cmp	eax, 1
		jnz	short loc_10028CC7
		cmp	edx, 354h
		jmp	short loc_10028CD2
; ---------------------------------------------------------------------------

loc_10028CC7:				; CODE XREF: sub_100288F0+3CDj
		cmp	eax, 2
		jnz	short loc_10028CD8
		cmp	edx, 250h

loc_10028CD2:				; CODE XREF: sub_100288F0+3D5j
		jnb	loc_10028D91

loc_10028CD8:				; CODE XREF: sub_100288F0+3DAj
		mov	edx, esi
		mov	esi, [esp+9Ch+var_68]
		mov	eax, [esi]
		mov	[eax+edx*4], cl
		mov	ecx, [esi]
		mov	al, byte ptr [esp+9Ch+var_88]
		mov	[ecx+edx*4+1], al
		mov	eax, [esi]
		mov	ecx, [esp+9Ch+var_7C]
		sub	ecx, eax
		sar	ecx, 2
		mov	[esp+9Ch+var_74], edx
		mov	[eax+edx*4+2], cx
		jmp	loc_10028B50
; ---------------------------------------------------------------------------

loc_10028D06:				; CODE XREF: sub_100288F0+32Aj
		mov	edi, [esp+9Ch+var_68]
		mov	al, dl
		sub	al, bl
		xor	ecx, ecx
		mov	byte ptr [esp+9Ch+var_8C], 40h
		mov	byte ptr [esp+9Ch+var_8C+1], al
		mov	word ptr [esp+9Ch+var_8C+2], cx
		test	ebp, ebp
		jz	short loc_10028D76
		mov	esi, [esp+9Ch+var_7C]

loc_10028D26:				; CODE XREF: sub_100288F0+484j
		test	ebx, ebx
		jz	short loc_10028D48
		mov	eax, [esp+9Ch+var_5C]
		and	eax, ebp
		cmp	eax, [esp+9Ch+var_74]
		jz	short loc_10028D48
		mov	eax, [esp+9Ch+var_88]
		mov	esi, [edi]
		xor	ebx, ebx
		mov	[esp+9Ch+var_84], eax
		mov	byte ptr [esp+9Ch+var_8C+1], al
		mov	edx, eax

loc_10028D48:				; CODE XREF: sub_100288F0+438j
					; sub_100288F0+444j
		mov	ecx, ebx
		mov	eax, ebp
		shr	eax, cl
		mov	ecx, [esp+9Ch+var_8C]
		mov	[esi+eax*4], ecx
		lea	ecx, [edx-1]
		mov	eax, 1
		shl	eax, cl
		test	ebp, eax
		jz	short loc_10028D69

loc_10028D63:				; CODE XREF: sub_100288F0+477j
		shr	eax, 1
		test	ebp, eax
		jnz	short loc_10028D63

loc_10028D69:				; CODE XREF: sub_100288F0+471j
		test	eax, eax
		jz	short loc_10028D76
		lea	ecx, [eax-1]
		and	ebp, ecx
		add	ebp, eax
		jnz	short loc_10028D26

loc_10028D76:				; CODE XREF: sub_100288F0+430j
					; sub_100288F0+47Bj
		mov	edx, [esp+9Ch+var_60]
		mov	ecx, [esp+9Ch+var_50]
		lea	eax, ds:0[edx*4]
		add	[edi], eax
		mov	edx, [esp+9Ch+var_88]
		mov	[ecx], edx
		xor	eax, eax
		jmp	short loc_10028D96
; ---------------------------------------------------------------------------

loc_10028D91:				; CODE XREF: sub_100288F0:loc_10028B3Fj
					; sub_100288F0:loc_10028CD2j
		mov	eax, 1

loc_10028D96:				; CODE XREF: sub_100288F0+148j
					; sub_100288F0+49Fj
		mov	ecx, [esp+9Ch+var_4]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
sub_100288F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION PK11_FreeSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_ExtractKeyValue]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DeriveWithFlags]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubDeriveWithKDF]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_DestroyPublicKey]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_DestroyPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_CreateECPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubUnwrapSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PrivDecryptPKCS1]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubWrapSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_PublicKeyStrength]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_FreeSlot]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_KeyGen]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetBestSlotMultiple]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetPrivateModulusLen]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_GetPrivateKeyType]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_ExtractPublicKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_TokenExists]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GenerateRandom]
; [00000006 BYTES: COLLAPSED FUNCTION DSAU_EncodeDerSigWithLen]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_Digest]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Sign]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_SignatureLen]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Verify]
; [00000006 BYTES: COLLAPSED FUNCTION VFY_VerifyDigestDirect]
; [00000006 BYTES: COLLAPSED FUNCTION DSAU_DecodeDerSigToLen]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_SignatureLen]
; [00000006 BYTES: COLLAPSED FUNCTION HASH_ResultLenByOidTag]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_HashBuf]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DestroyContext]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_ParamFromIV]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Encrypt]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Decrypt]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_CipherOp]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_IVFromParam]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_CreateContextBySymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DigestFinal]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DigestOp]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DigestBegin]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_SignWithSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_IsLoggedIn]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_NeedLogin]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetModuleID]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetSlotID]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetSlotSeries]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_IsPresent]
; [00000006 BYTES: COLLAPSED FUNCTION SECMOD_LookupSlot]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_SymKeyFromHandle]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetSlotFromKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Derive]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_DigestKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_RestoreContext]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_SaveContextAlloc]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_UnwrapSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_WrapSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_PublicKeyStrengthInBits]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetBestKeyLength]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_ReferenceSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_VerifyKeyOK]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DestroyCertificate]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetKeyData]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetMechanism]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_SetWrapKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetBestWrapMechanism]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetWrapKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetCurrentWrapIndex]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_CreateRSAPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DestroyCertificateList]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetInternalSlot]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_CreateDigestContext]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubDerive]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_CreateDHPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetSlotFromPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DupCertificate]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_ImportSymKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_UnwrapSymKeyWithFlags]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_CertChainFromCert]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_UpdateCertPQG]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_NewTempCertificate]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DestroyCertList]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_AddCertToListTail]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_NewCertList]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_NameToAscii]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_VerifyCertName]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_VerifyCert]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_CacheOCSPResponseFromSideChannel]
; [00000006 BYTES: COLLAPSED FUNCTION HASH_GetHashObject]
; [00000006 BYTES: COLLAPSED FUNCTION __PK11_CreateContextByRawKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetBestSlot]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubDecryptRaw]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_PubEncryptRaw]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_DestroyContext]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_End]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_Update]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_Begin]
; [00000006 BYTES: COLLAPSED FUNCTION SGN_NewContext]
; [00000006 BYTES: COLLAPSED FUNCTION VFY_DestroyContext]
; [00000006 BYTES: COLLAPSED FUNCTION VFY_End]
		db 2 dup(0CCh)
; [00000006 BYTES: COLLAPSED FUNCTION VFY_Update]
; [00000006 BYTES: COLLAPSED FUNCTION VFY_Begin]
; [00000006 BYTES: COLLAPSED FUNCTION VFY_CreateContext]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_VersionCheck]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_RegisterShutdown]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_Finalize]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_FreeDistNames]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_GetSSLCACerts]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DupCertList]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_CacheStaticFlags]
; [00000006 BYTES: COLLAPSED FUNCTION SECKEY_CopyPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_MapSignKeyType]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_CopyTokenPrivKeyToSessionPrivKey]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_ReferenceSlot]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DistNamesFromCertList]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_DupDistNames]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_GetDefaultCertDB]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_FreeNicknames]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_CheckCertValidTimes]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_GetCertNicknames]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_FindKeyByAnyCert]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_FindUserCertByUsage]
; [00000006 BYTES: COLLAPSED FUNCTION CERT_FindCertByName]
; [00000006 BYTES: COLLAPSED FUNCTION PK11_GetBestSlotWithAttributes]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_SetError_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Free_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_FreeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Alloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ZAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ZFree_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_UnlockRead_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_LockRead_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_UnlockWrite_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_LockWrite_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_GetError_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_CompareItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Strdup_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_CopyItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_FreeArena_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ArenaZAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_NewArena_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_ArenaAlloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_SecureMemcmp]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_FreeArray]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_AllocArray]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_ZfreeItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_AllocItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PORT_Realloc_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_GetAlgorithmTag_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_Hash]
; [00000006 BYTES: COLLAPSED FUNCTION NSS_PutEnv_Util]
; [00000006 BYTES: COLLAPSED FUNCTION BTOA_DataToAscii_Util]
; [00000006 BYTES: COLLAPSED FUNCTION ATOB_AsciiToData_Util]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_Destroy_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_DupArray]
; [00000006 BYTES: COLLAPSED FUNCTION NSSRWLock_New_Util]
; [00000006 BYTES: COLLAPSED FUNCTION DER_Lengths_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECITEM_DupItem_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_FindOIDByTag_Util]
; [00000006 BYTES: COLLAPSED FUNCTION SECOID_FindOID_Util]
; [00000006 BYTES: COLLAPSED FUNCTION PL_strdup]
; [00000006 BYTES: COLLAPSED FUNCTION PR_EmulateSendFile]
; [00000006 BYTES: COLLAPSED FUNCTION PR_EmulateAcceptRead]
; [00000010 BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [0000002B BYTES: COLLAPSED FUNCTION __alloca_probe]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100291D0	proc near		; CODE XREF: sub_10029260+2Dp
					; .text:100292B6p ...

var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+0Ch+arg_0]
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_8]
		push	ebp
		push	edx
		push	eax
		push	ecx
		push	ecx
		push	offset sub_10029260
		push	large dword ptr	fs:0
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_20], eax
		mov	large fs:0, esp

loc_10029202:				; CODE XREF: sub_100291D0+64j
					; sub_100291D0+80j
		mov	eax, [esp+28h+arg_4]
		mov	ebx, [eax+8]
		mov	ecx, [esp+28h+arg_0]
		xor	ebx, [ecx]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFEh
		jz	short loc_10029252
		mov	edx, [esp+28h+arg_8]
		cmp	edx, 0FFFFFFFEh
		jz	short loc_10029224
		cmp	esi, edx
		jbe	short loc_10029252

loc_10029224:				; CODE XREF: sub_100291D0+4Ej
		lea	esi, [esi+esi*2]
		lea	ebx, [ebx+esi*4+10h]
		mov	ecx, [ebx]
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_10029202
		push	101h
		mov	eax, [ebx+8]
		call	sub_10029AA1
		mov	ecx, 1
		mov	eax, [ebx+8]
		call	sub_10029AC0
		jmp	short loc_10029202
; ---------------------------------------------------------------------------

loc_10029252:				; CODE XREF: sub_100291D0+45j
					; sub_100291D0+52j
		pop	large dword ptr	fs:0
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100291D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029260	proc near		; DATA XREF: sub_100291D0+14o
					; .rdata:___safe_se_handler_tableo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_100292A5
		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		xor	ecx, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		push	ebp
		mov	ebp, [eax+18h]
		push	dword ptr [eax+0Ch]
		push	dword ptr [eax+10h]
		push	dword ptr [eax+14h]
		call	sub_100291D0
		add	esp, 0Ch
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_100292A5:			; CODE XREF: sub_10029260+10j
		retn
sub_10029260	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		push	dword ptr [ecx+1Ch]
		push	dword ptr [ecx+18h]
		push	dword ptr [ecx+28h]
		call	sub_100291D0
		add	esp, 0Ch
		pop	ebp
		retn	4

; =============== S U B	R O U T	I N E =======================================


sub_100292C2	proc near		; CODE XREF: sub_10029330+89p
		push	ebp
		push	esi
		push	edi
		push	ebx
		mov	ebp, edx
		xor	eax, eax
		xor	ebx, ebx
		xor	edx, edx
		xor	esi, esi
		xor	edi, edi
		call	ecx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_100292C2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100292D9	proc near		; CODE XREF: sub_10029330+15Ep
		mov	ebp, edx
		mov	esi, ecx
		mov	eax, ecx
		push	1
		call	sub_10029AA1
		xor	eax, eax
		xor	ebx, ebx
		xor	ecx, ecx
		xor	edx, edx
		xor	edi, edi
		jmp	esi
sub_100292D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_100292F2(PVOID TargetFrame)
sub_100292F2	proc near		; CODE XREF: sub_10029330+112p
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	0		; ReturnValue
		push	0		; ExceptionRecord
		push	offset loc_10029307 ; TargetIp
		push	ecx		; TargetFrame
		call	RtlUnwind

loc_10029307:				; DATA XREF: sub_100292F2+Ao
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100292F2	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002930C	proc near		; CODE XREF: sub_10029330+128p
					; sub_10029330+178p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		call	sub_100291D0
		add	esp, 0Ch
		pop	ebp
		retn	8
sub_1002930C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10029330(int,	int, int, PVOID	TargetFrame, int)
sub_10029330	proc near		; CODE XREF: sub_10029C31+1Bp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
TargetFrame	= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+TargetFrame]
		push	esi
		mov	esi, [ebx+8]
		xor	esi, [eax]
		push	edi
		mov	eax, [esi]
		mov	[ebp+var_1], 0
		mov	[ebp+var_C], 1
		lea	edi, [ebx+10h]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10029366
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10029366:				; CODE XREF: sub_10029330+29j
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+arg_8]
		test	byte ptr [eax+4], 66h
		jnz	loc_10029493
		lea	ecx, [ebp+var_18]
		mov	[ebx-4], ecx
		mov	ebx, [ebx+0Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_14], eax
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_100293F8
		jmp	short loc_100293A0
; ---------------------------------------------------------------------------
		align 10h

loc_100293A0:				; CODE XREF: sub_10029330+68j
					; sub_10029330+A0j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+edx*4+14h]
		lea	eax, [esi+edx*4+10h]
		mov	[ebp+var_10], eax
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_100293CB
		mov	edx, edi
		call	sub_100292C2
		mov	[ebp+var_1], 1
		test	eax, eax
		jl	short loc_10029402
		jg	short loc_1002940B
		mov	eax, [ebp+var_8]

loc_100293CB:				; CODE XREF: sub_10029330+85j
		mov	ebx, eax
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_100293A0
		cmp	[ebp+var_1], 0
		jz	short loc_100293F8

loc_100293D8:				; CODE XREF: sub_10029330+D9j
					; sub_10029330+17Dj
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_100293EA
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_100293EA:				; CODE XREF: sub_10029330+ADj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]

loc_100293F8:				; CODE XREF: sub_10029330+66j
					; sub_10029330+A6j ...
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10029402:				; CODE XREF: sub_10029330+94j
		mov	[ebp+var_C], 0
		jmp	short loc_100293D8
; ---------------------------------------------------------------------------

loc_1002940B:				; CODE XREF: sub_10029330+96j
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0E06D7363h
		jnz	short loc_1002943F
		cmp	dword_10037EC4,	0
		jz	short loc_1002943F
		push	offset dword_10037EC4
		call	sub_10029B54
		add	esp, 4
		test	eax, eax
		jz	short loc_1002943F
		mov	ecx, [ebp+arg_8]
		push	1
		push	ecx
		call	dword_10037EC4
		add	esp, 8

loc_1002943F:				; CODE XREF: sub_10029330+E4j
					; sub_10029330+EDj ...
		mov	ecx, [ebp+TargetFrame] ; TargetFrame
		call	sub_100292F2
		mov	eax, [ebp+TargetFrame]
		cmp	[eax+0Ch], ebx
		jz	short loc_10029460
		mov	edx, [ebp+arg_0]
		push	edx
		push	edi
		mov	edx, ebx
		mov	ecx, eax
		call	sub_1002930C
		mov	eax, [ebp+TargetFrame]

loc_10029460:				; CODE XREF: sub_10029330+11Dj
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], ecx
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10029478
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10029478:				; CODE XREF: sub_10029330+13Bj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	edx, edi
		call	sub_100292D9

loc_10029493:				; CODE XREF: sub_10029330+4Bj
		mov	edx, 0FFFFFFFEh
		cmp	[ebx+0Ch], edx
		jz	loc_100293F8
		mov	ecx, [ebp+arg_0]
		push	ecx
		push	edi
		mov	ecx, ebx
		call	sub_1002930C
		jmp	loc_100293D8
sub_10029330	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100294B2	proc near		; CODE XREF: sub_10029700+Cp
					; sub_10029742+Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0E06D7363h
		cmp	[ebp+arg_0], eax
		jnz	short loc_100294CE
		push	[ebp+arg_4]
		push	eax
		call	_XcptFilter
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100294CE:				; CODE XREF: sub_100294B2+Dj
		xor	eax, eax
		pop	ebp
		retn
sub_100294B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100294D2	proc near		; CODE XREF: sub_10029518+A5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		jmp	short loc_100294EE
; ---------------------------------------------------------------------------

loc_100294DF:				; CODE XREF: sub_100294D2+1Fj
		test	eax, eax
		jnz	short loc_100294F3
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_100294EB
		call	ecx

loc_100294EB:				; CODE XREF: sub_100294D2+15j
		add	esi, 4

loc_100294EE:				; CODE XREF: sub_100294D2+Bj
		cmp	esi, [ebp+arg_4]
		jb	short loc_100294DF

loc_100294F3:				; CODE XREF: sub_100294D2+Fj
		pop	esi
		pop	ebp
		retn
sub_100294D2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100294F6	proc near		; DATA XREF: .rdata:1002A400o
		push	80h		; Size
		call	ds:malloc
		pop	ecx
		mov	Memory,	eax
		mov	dword_10037EB4,	eax
		test	eax, eax
		jnz	short loc_10029512
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10029512:				; CODE XREF: sub_100294F6+18j
		and	dword ptr [eax], 0
		xor	eax, eax
		retn
sub_100294F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029518	proc near		; CODE XREF: DllEntryPoint-1C3p
					; DllEntryPoint-109p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		xor	eax, eax
		push	esi
		push	edi
		cmp	[ebp+arg_4], eax
		jnz	short loc_1002954D
		cmp	dword_10037B70,	eax
		jle	short loc_10029546
		dec	dword_10037B70
		mov	edi, ds:InterlockedCompareExchange
		push	eax
		mov	esi, offset Target
		jmp	loc_1002962B
; ---------------------------------------------------------------------------

loc_10029546:				; CODE XREF: sub_10029518+15j
					; sub_10029518+AEj
		xor	eax, eax
		jmp	loc_10029698
; ---------------------------------------------------------------------------

loc_1002954D:				; CODE XREF: sub_10029518+Dj
		cmp	[ebp+arg_4], 1
		jnz	loc_10029695
		mov	ecx, large fs:18h
		mov	ebx, [ecx+4]
		mov	edi, ds:InterlockedCompareExchange
		mov	[ebp+arg_4], eax
		push	eax
		mov	esi, offset Target
		jmp	short loc_10029583
; ---------------------------------------------------------------------------

loc_10029572:				; CODE XREF: sub_10029518+71j
		cmp	eax, ebx
		jz	short loc_1002958D
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_10029583:				; CODE XREF: sub_10029518+58j
		push	ebx		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_10029572
		jmp	short loc_10029594
; ---------------------------------------------------------------------------

loc_1002958D:				; CODE XREF: sub_10029518+5Cj
		mov	[ebp+arg_4], 1

loc_10029594:				; CODE XREF: sub_10029518+73j
		mov	eax, dword_10037EAC
		push	2
		pop	edi
		test	eax, eax
		jz	short loc_100295A9
		push	1Fh
		call	_amsg_exit
		jmp	short loc_100295E2
; ---------------------------------------------------------------------------

loc_100295A9:				; CODE XREF: sub_10029518+86j
		push	offset dword_1002A404
		push	offset dword_1002A3FC
		mov	dword_10037EAC,	1
		call	sub_100294D2
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	loc_10029546
		push	offset dword_1002A3F8
		push	offset dword_1002A3F4
		call	_initterm
		pop	ecx
		mov	dword_10037EAC,	edi

loc_100295E2:				; CODE XREF: sub_10029518+8Fj
		xor	ebx, ebx
		pop	ecx
		cmp	[ebp+arg_4], ebx
		jnz	short loc_100295F2
		push	ebx		; Value
		push	esi		; Target
		call	ds:InterlockedExchange

loc_100295F2:				; CODE XREF: sub_10029518+D0j
		cmp	dword_10037EC0,	ebx
		jz	short loc_10029616
		push	offset dword_10037EC0
		call	sub_10029B54
		pop	ecx
		test	eax, eax
		jz	short loc_10029616
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_10037EC0

loc_10029616:				; CODE XREF: sub_10029518+E0j
					; sub_10029518+EFj
		inc	dword_10037B70
		jmp	short loc_10029695
; ---------------------------------------------------------------------------

loc_1002961E:				; CODE XREF: sub_10029518+11Aj
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_1002962B:				; CODE XREF: sub_10029518+29j
		push	1		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_1002961E
		mov	eax, dword_10037EAC
		cmp	eax, 2
		jz	short loc_10029648
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	short loc_10029695
; ---------------------------------------------------------------------------

loc_10029648:				; CODE XREF: sub_10029518+124j
		mov	ebx, Memory
		test	ebx, ebx
		jz	short loc_10029682
		mov	edi, dword_10037EB4
		add	edi, 0FFFFFFFCh
		jmp	short loc_10029668
; ---------------------------------------------------------------------------

loc_1002965D:				; CODE XREF: sub_10029518+152j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_10029665
		call	eax

loc_10029665:				; CODE XREF: sub_10029518+149j
		sub	edi, 4

loc_10029668:				; CODE XREF: sub_10029518+143j
		cmp	edi, ebx
		jnb	short loc_1002965D
		push	ebx		; Memory
		call	ds:free
		and	dword_10037EB4,	0
		and	Memory,	0
		pop	ecx

loc_10029682:				; CODE XREF: sub_10029518+138j
		push	0		; Value
		push	esi		; Target
		mov	dword_10037EAC,	0
		call	ds:InterlockedExchange

loc_10029695:				; CODE XREF: sub_10029518+39j
					; sub_10029518+104j ...
		xor	eax, eax
		inc	eax

loc_10029698:				; CODE XREF: sub_10029518+30j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	0Ch
sub_10029518	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002969F:				; CODE XREF: DllEntryPoint+11j
		push	2Ch
		push	offset dword_10033EB8
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_4]
		xor	edx, edx
		inc	edx
		mov	[ebp+var_1C], edx
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	dword_100371B0,	ecx
		cmp	ecx, esi
		jnz	short loc_100296D3
		cmp	dword_10037B70,	esi
		jnz	short loc_100296D3
		mov	[ebp+var_1C], esi
		jmp	loc_100298D9
; ---------------------------------------------------------------------------

loc_100296D3:				; CODE XREF: DllEntryPoint-23Aj
					; DllEntryPoint-232j
		cmp	ecx, edx
		jz	short loc_100296E0
		cmp	ecx, 2
		jnz	loc_1002976D

loc_100296E0:				; CODE XREF: DllEntryPoint-226j
		mov	eax, dword_10037EBC
		cmp	eax, esi
		jz	short loc_1002971F
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	dword_10037B74,	edx
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	eax ; dword_10037EBC
		mov	[ebp+var_1C], eax
		jmp	short loc_1002971C
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10029700	proc near		; DATA XREF: .rdata:10033ED8o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-20h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_10029700	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029714	proc near		; DATA XREF: .rdata:10033EDCo
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10029714	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002971C:				; CODE XREF: DllEntryPoint-1FDj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_1002971F:				; CODE XREF: DllEntryPoint-214j
		cmp	[ebp+var_1C], esi
		jz	loc_100298D9
		mov	[ebp+ms_exc.registration.TryLevel], 2
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10029518
		mov	[ebp+var_1C], eax
		jmp	short loc_1002975E
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10029742	proc near		; DATA XREF: .rdata:10033EE4o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-24h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_10029742	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029756	proc near		; DATA XREF: .rdata:10033EE8o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10029756	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002975E:				; CODE XREF: DllEntryPoint-1BBj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+var_1C], esi
		jz	loc_100298D9
		mov	ecx, [ebp+arg_4]

loc_1002976D:				; CODE XREF: DllEntryPoint-221j
		mov	[ebp+ms_exc.registration.TryLevel], 3
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	sub_10029BD2
		mov	[ebp+var_1C], eax
		jmp	short loc_100297A1
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10029785	proc near		; DATA XREF: .rdata:10033EF0o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-28h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_10029785	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029799	proc near		; DATA XREF: .rdata:10033EF4o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10029799	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100297A1:				; CODE XREF: DllEntryPoint-178j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+arg_4], 1
		jnz	loc_1002984A
		cmp	[ebp+var_1C], esi
		jnz	loc_1002984A
		mov	[ebp+ms_exc.registration.TryLevel], 4
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10029BD2
		jmp	short loc_100297E3
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100297CA	proc near		; DATA XREF: .rdata:10033EFCo
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-2Ch], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_100297CA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100297DE	proc near		; DATA XREF: .rdata:10033F00o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_100297DE	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100297E3:				; CODE XREF: DllEntryPoint-133j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	[ebp+ms_exc.registration.TryLevel], 5
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10029518
		jmp	short loc_10029812
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100297F9	proc near		; DATA XREF: .rdata:10033F08o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-30h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_100297F9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002980D	proc near		; DATA XREF: .rdata:10033F0Co
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_1002980D	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10029812:				; CODE XREF: DllEntryPoint-104j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_10037EBC
		cmp	eax, esi
		jz	short loc_1002984A
		mov	[ebp+ms_exc.registration.TryLevel], 6
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	eax ; dword_10037EBC
		jmp	short loc_10029847
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002982E	proc near		; DATA XREF: .rdata:10033F14o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-34h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_1002982E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029842	proc near		; DATA XREF: .rdata:10033F18o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_10029842	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10029847:				; CODE XREF: DllEntryPoint-CFj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_1002984A:				; CODE XREF: DllEntryPoint-153j
					; DllEntryPoint-14Aj ...
		cmp	[ebp+arg_4], esi
		jz	short loc_10029859
		cmp	[ebp+arg_4], 3
		jnz	loc_100298D9

loc_10029859:				; CODE XREF: DllEntryPoint-AEj
		mov	[ebp+ms_exc.registration.TryLevel], 7
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10029518
		mov	[ebp+var_1C], eax
		jmp	short loc_1002988F
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10029873	proc near		; DATA XREF: .rdata:10033F20o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-38h], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_10029873	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029887	proc near		; DATA XREF: .rdata:10033F24o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10029887	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002988F:				; CODE XREF: DllEntryPoint-8Aj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_10037EBC
		cmp	eax, esi
		jz	short loc_100298D9
		cmp	dword_10037B74,	esi
		jz	short loc_100298D9
		mov	[ebp+ms_exc.registration.TryLevel], 8
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	eax ; dword_10037EBC
		mov	[ebp+var_1C], eax
		jmp	short loc_100298D6
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100298BA	proc near		; DATA XREF: .rdata:10033F2Co
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-3Ch], ecx
		push	eax
		push	ecx
		call	sub_100294B2
		pop	ecx
		pop	ecx
		retn
sub_100298BA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100298CE	proc near		; DATA XREF: .rdata:10033F30o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_100298CE	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100298D6:				; CODE XREF: DllEntryPoint-43j
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_100298D9:				; CODE XREF: DllEntryPoint-22Dj
					; DllEntryPoint-1D9j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	sub_100298F0
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn	0Ch
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100298F0	proc near		; CODE XREF: DllEntryPoint-1Bp
					; DATA XREF: .rdata:10033ED0o
		mov	dword_100371B0,	0FFFFFFFFh
		retn
sub_100298F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 1002969F SIZE 00000061 BYTES
; FUNCTION CHUNK AT 1002971C SIZE 00000026 BYTES
; FUNCTION CHUNK AT 1002975E SIZE 00000027 BYTES
; FUNCTION CHUNK AT 100297A1 SIZE 00000029 BYTES
; FUNCTION CHUNK AT 100297E3 SIZE 00000016 BYTES
; FUNCTION CHUNK AT 10029812 SIZE 0000001C BYTES
; FUNCTION CHUNK AT 10029847 SIZE 0000002C BYTES
; FUNCTION CHUNK AT 1002988F SIZE 0000002B BYTES
; FUNCTION CHUNK AT 100298D6 SIZE 0000001A BYTES

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_1002990B
		call	sub_10029C56

loc_1002990B:				; CODE XREF: DllEntryPoint+9j
		pop	ebp
		jmp	loc_1002969F
DllEntryPoint	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029911	proc near		; CODE XREF: __security_check_cookie(x):$failure$3j

var_328		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_s0		= dword	ptr  0
arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 328h
		mov	dword_10037C78,	eax
		mov	dword_10037C74,	ecx
		mov	dword_10037C70,	edx
		mov	dword_10037C6C,	ebx
		mov	dword_10037C68,	esi
		mov	dword_10037C64,	edi
		mov	word_10037C90, ss
		mov	word_10037C84, cs
		mov	word_10037C60, ds
		mov	word_10037C5C, es
		mov	word_10037C58, fs
		mov	word_10037C54, gs
		pushf
		pop	dword_10037C88
		mov	eax, [ebp+var_s0]
		mov	dword_10037C7C,	eax
		mov	eax, [ebp+4]
		mov	dword_10037C80,	eax
		lea	eax, [ebp+arg_0]
		mov	dword_10037C8C,	eax
		mov	eax, [ebp+var_320]
		mov	dword_10037BC8,	10001h
		mov	eax, dword_10037C80
		mov	dword_10037B84,	eax
		mov	dword_10037B78,	0C0000409h
		mov	dword_10037B7C,	1
		mov	eax, ___security_cookie
		mov	[ebp+var_328], eax
		mov	eax, dword_10037190
		mov	[ebp+var_324], eax
		push	0		; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		push	offset ExceptionInfo ; ExceptionInfo
		call	ds:UnhandledExceptionFilter
		push	0C0000409h	; uExitCode
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:TerminateProcess
		leave
		retn
sub_10029911	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		mov	eax, [esp+14h]
		or	eax, eax
		jnz	short loc_10029A31
		mov	ecx, [esp+10h]
		mov	eax, [esp+0Ch]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	dword ptr [esp+10h]
		mov	ecx, eax
		mov	eax, esi
		mul	dword ptr [esp+10h]
		add	edx, ecx
		jmp	short loc_10029A78
; ---------------------------------------------------------------------------

loc_10029A31:				; CODE XREF: .text:10029A07j
		mov	ecx, eax
		mov	ebx, [esp+10h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]

loc_10029A3F:				; CODE XREF: .text:10029A49j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_10029A3F
		div	ebx
		mov	esi, eax
		mul	dword ptr [esp+14h]
		mov	ecx, eax
		mov	eax, [esp+10h]
		mul	esi
		add	edx, ecx
		jb	short loc_10029A6D
		cmp	edx, [esp+0Ch]
		ja	short loc_10029A6D
		jb	short loc_10029A76
		cmp	eax, [esp+8]
		jbe	short loc_10029A76

loc_10029A6D:				; CODE XREF: .text:10029A5Dj
					; .text:10029A63j
		dec	esi
		sub	eax, [esp+10h]
		sbb	edx, [esp+14h]

loc_10029A76:				; CODE XREF: .text:10029A65j
					; .text:10029A6Bj
		xor	ebx, ebx

loc_10029A78:				; CODE XREF: .text:10029A2Fj
		sub	eax, [esp+8]
		sbb	edx, [esp+0Ch]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------
		align 4
		push	ebx
		push	ecx
		mov	ebx, offset dword_100371A0
		jmp	short loc_10029AAC

; =============== S U B	R O U T	I N E =======================================


sub_10029AA1	proc near		; CODE XREF: sub_100291D0+6Ep
					; sub_100292D9+8p

arg_0		= dword	ptr  4

		push	ebx
		push	ecx
		mov	ebx, offset dword_100371A0
		mov	ecx, [esp+8+arg_0]

loc_10029AAC:				; CODE XREF: .text:10029A9Fj
		mov	[ebx+8], ecx
		mov	[ebx+4], eax
		mov	[ebx+0Ch], ebp
		push	ebp
		push	ecx
		push	eax
		pop	eax
		pop	ecx
		pop	ebp
		pop	ecx
		pop	ebx
		retn	4
sub_10029AA1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10029AC0	proc near		; CODE XREF: sub_100291D0+7Bp
		call	eax
		retn
sub_10029AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029AD0	proc near		; CODE XREF: sub_10029B54+16p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_10029AE6

loc_10029AE2:				; CODE XREF: sub_10029AD0+21j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10029AE6:				; CODE XREF: sub_10029AD0+10j
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_10029AE2
		xor	edx, edx
		mov	ecx, 10Bh
		cmp	[eax+18h], cx
		setz	dl
		mov	eax, edx
		pop	ebp
		retn
sub_10029AD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029B10	proc near		; CODE XREF: sub_10029B54+27p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		push	ebx
		push	esi
		movzx	esi, word ptr [ecx+6]
		xor	edx, edx
		push	edi
		lea	eax, [eax+ecx+18h]
		test	esi, esi
		jbe	short loc_10029B4D
		mov	edi, [ebp+arg_4]

loc_10029B35:				; CODE XREF: sub_10029B10+3Bj
		mov	ecx, [eax+0Ch]
		cmp	edi, ecx
		jb	short loc_10029B45
		mov	ebx, [eax+8]
		add	ebx, ecx
		cmp	edi, ebx
		jb	short loc_10029B4F

loc_10029B45:				; CODE XREF: sub_10029B10+2Aj
		inc	edx
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_10029B35

loc_10029B4D:				; CODE XREF: sub_10029B10+20j
		xor	eax, eax

loc_10029B4F:				; CODE XREF: sub_10029B10+33j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10029B10	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029B54	proc near		; CODE XREF: sub_10029330+F4p
					; sub_10029518+E7p

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_10033F38
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, 10000000h
		push	esi
		call	sub_10029AD0
		pop	ecx
		test	eax, eax
		jz	short loc_10029BB1
		mov	eax, [ebp+arg_0]
		sub	eax, esi
		push	eax
		push	esi
		call	sub_10029B10
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10029BB1
		mov	eax, [eax+24h]
		shr	eax, 1Fh
		not	eax
		and	eax, 1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_10029BBA
; ---------------------------------------------------------------------------

loc_10029B9A:				; DATA XREF: .rdata:stru_10033F38o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10029B54
		mov	eax, [eax]
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	eax, 0C0000005h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_10029BAE:				; DATA XREF: .rdata:stru_10033F38o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10029B54

loc_10029BB1:				; CODE XREF: sub_10029B54+1Ej
					; sub_10029B54+30j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	eax, eax

loc_10029BBA:				; CODE XREF: sub_10029B54+44j
		call	__SEH_epilog4
		retn
sub_10029B54	endp

; [00000006 BYTES: COLLAPSED FUNCTION _XcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]

; =============== S U B	R O U T	I N E =======================================


sub_10029BD2	proc near		; CODE XREF: DllEntryPoint-180p
					; DllEntryPoint-138p
		xor	eax, eax
		inc	eax
		retn	0Ch
sub_10029BD2	endp

; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10029C31(int,	PVOID TargetFrame, int,	int)
sub_10029C31	proc near		; DATA XREF: __SEH_prolog4o
					; .rdata:10033EB4o

arg_0		= dword	ptr  8
TargetFrame	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]	; int
		push	[ebp+TargetFrame] ; TargetFrame
		push	[ebp+arg_0]	; int
		push	offset @__security_check_cookie@4 ; int
		push	offset ___security_cookie ; int
		call	sub_10029330
		add	esp, 18h
		pop	ebp
		retn
sub_10029C31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10029C56	proc near		; CODE XREF: DllEntryPoint+Bp

PerformanceCount= LARGE_INTEGER	ptr -10h
SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		push	ebx
		push	edi
		mov	edi, 0BB40E64Eh
		mov	ebx, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_10029C88
		test	ebx, eax
		jz	short loc_10029C88
		not	eax
		mov	dword_10037190,	eax
		jmp	short loc_10029CE3
; ---------------------------------------------------------------------------

loc_10029C88:				; CODE XREF: sub_10029C56+23j
					; sub_10029C56+27j
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		call	ds:GetCurrentProcessId
		xor	esi, eax
		call	ds:GetCurrentThreadId
		xor	esi, eax
		call	ds:GetTickCount
		xor	esi, eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	eax, dword ptr [ebp+PerformanceCount+4]
		xor	eax, dword ptr [ebp+PerformanceCount]
		xor	esi, eax
		cmp	esi, edi
		jz	short loc_10029CCF
		test	___security_cookie, ebx
		jnz	short loc_10029CD4

loc_10029CCF:				; CODE XREF: sub_10029C56+6Fj
		mov	esi, 0BB40E64Fh

loc_10029CD4:				; CODE XREF: sub_10029C56+77j
		mov	___security_cookie, esi
		not	esi
		mov	dword_10037190,	esi
		pop	esi

loc_10029CE3:				; CODE XREF: sub_10029C56+30j
		pop	edi
		pop	ebx
		leave
		retn
sub_10029C56	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		or	ecx, eax
		mov	ecx, [esp+0Ch]
		jnz	short loc_10029D09
		mov	eax, [esp+4]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10029D09:				; CODE XREF: .text:10029CFEj
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		mul	dword ptr [esp+14h]
		add	ebx, eax
		mov	eax, [esp+8]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 100h
		dd 80h dup(?)
_text		ends

; Section 2. (virtual address 0002A000)
; Virtual size			: 0000C38C (  50060.)
; Section size in file		: 0000C400 (  50176.)
; Offset to raw	data for section: 00029200
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from KERNEL32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_100066A0+121p
					; sub_10013DA0+35Dp ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_10017A70+7Fp
					; sub_10017B30:loc_10017BB2p ...
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: sub_10017A70+75p
					; DATA XREF: sub_10017A70+75r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_10017B30+66p
					; DATA XREF: sub_10017B30+66r
; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
		extrn ReleaseMutex:dword ; CODE	XREF: sub_10017BE0+2Cp
					; DATA XREF: sub_10017BE0+2Cr
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_10017C50+66p
					; DATA XREF: sub_10017C50+66r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_1001B0B0+248p
					; sub_10029C56+4Bp
					; DATA XREF: ...
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword	; CODE XREF: sub_10029518+D4p
					; sub_10029518+177p
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_10029518+63p
					; sub_10029518+10Bp
					; DATA XREF: ...
; LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination,	LONG Exchange, LONG Comperand)
		extrn InterlockedCompareExchange:dword ; CODE XREF: sub_10029518+6Dp
					; sub_10029518+116p
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10029911+DAp
					; DATA XREF: sub_10029911+DAr
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_10029911+D3p
					; DATA XREF: sub_10029911+D3r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: sub_10029911+C8p
					; DATA XREF: sub_10029911+C8r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_10029911+BDp
					; DATA XREF: sub_10029911+BDr
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_10029C56+5Fp
					; DATA XREF: sub_10029C56+5Fr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_10029C56+53p
					; DATA XREF: sub_10029C56+53r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_10029C56+37p
					; DATA XREF: sub_10029C56+37r

;
; Imports from libnspr4.dll
;
		extrn PR_Free:dword	; CODE XREF: sub_10022200+2Dp
					; DATA XREF: sub_10022200+2Dr ...
		extrn PR_NewMonitor:dword ; CODE XREF: sub_1001E8F0+Ap
					; sub_1001E8F0+16p ...
		extrn PR_IntervalNow:dword ; CODE XREF:	sub_100023E0p
					; sub_10002400+21p ...
		extrn PR_MillisecondsToInterval:dword ;	CODE XREF: sub_10002400+16p
					; DTLS_GetHandshakeTimeout+41p
					; DATA XREF: ...
		extrn PR_ExitMonitor:dword ; CODE XREF:	sub_10002510+FCp
					; sub_10002830+2BBp ...
		extrn PR_EnterMonitor:dword ; CODE XREF: sub_10002510+D9p
					; sub_10002830+37p ...
		extrn __imp_PR_AtomicIncrement:dword ; CODE XREF: sub_100074C0+9p
					; sub_10009320+1CEp ...
		extrn PR_DestroyLock:dword ; CODE XREF:	sub_10005F80+Ap
					; sub_10017B30+24p ...
		extrn PR_Unlock:dword	; CODE XREF: sub_10005FC0+4Ep
					; sub_10006050+3B4p ...
		extrn PR_Lock:dword	; CODE XREF: sub_10005FC0+Cp
					; sub_10006050+98p ...
		extrn PR_NewLock:dword	; CODE XREF: sub_10006030p
					; sub_10017A40:loc_10017A50p ...
		extrn PR_AtomicDecrement:dword ; CODE XREF: sub_100074E0+9p
					; sub_10007520+17p
					; DATA XREF: ...
		extrn PR_SetError:dword	; CODE XREF: sub_10007C90+323p
					; sub_10010080+72p ...
		extrn PR_GetError:dword	; CODE XREF: sub_10007C90+267p
					; sub_10007C90+2E1p ...
		extrn PR_Sleep:dword	; CODE XREF: sub_10007FE0+A4p
					; DATA XREF: sub_10007FE0+A4r
		extrn PR_RWLock_Unlock:dword ; CODE XREF: sub_10009320+37Cp
					; sub_10009320+49Ap ...
		extrn PR_RWLock_Rlock:dword ; CODE XREF: sub_10009320+340p
					; DATA XREF: sub_10009320+340r
		extrn PR_GetCurrentThread:dword	; CODE XREF: sub_1000CB90+28Bp
					; sub_10019F80+ADp
					; DATA XREF: ...
		extrn PR_Now:dword	; CODE XREF: SSL_AuthCertificate+3p
					; NSS_GetClientAuthData+C6p
					; DATA XREF: ...
		extrn PR_PopIOLayer:dword ; CODE XREF: sub_10014750+2Ap
					; DATA XREF: sub_10014750+2Ar
		extrn PR_ErrorInstallTable:dword ; CODE	XREF: .text:10014825p
					; DATA XREF: .text:10014825r
		extrn PR_CallOnce:dword	; CODE XREF: sub_10014830+Ap
					; sub_10014A60+Ap ...
		extrn PR_CallOnceWithArg:dword ; CODE XREF: sub_100149C0+Bp
					; sub_10015700+10Ep ...
		extrn PR_StringToNetAddr:dword ; CODE XREF: sub_10014AF0+48p
					; DATA XREF: sub_10014AF0+48r
		extrn PR_DestroyRWLock:dword ; CODE XREF: sub_10017EF0+65p
					; DATA XREF: sub_10017EF0+65r
		extrn PR_RWLock_Wlock:dword ; CODE XREF: sub_10018140+10p
					; DATA XREF: sub_10018140+10r
		extrn PR_NewRWLock:dword ; CODE	XREF: .text:100183CFp
					; DATA XREF: .text:100183CFr
		extrn PR_CloseFileMap:dword ; CODE XREF: sub_1001B010+76p
					; DATA XREF: sub_1001B010+76r
		extrn PR_MemUnmap:dword	; CODE XREF: sub_1001B010+4Cp
					; DATA XREF: sub_1001B010+4Cr
		extrn PR_MemMap:dword	; CODE XREF: sub_1001B0B0+29Fp
					; sub_1001B760+154p
					; DATA XREF: ...
		extrn PR_smprintf_free:dword ; CODE XREF: sub_1001B0B0+286p
					; sub_1001B550+10Fp
					; DATA XREF: ...
		extrn PR_OpenAnonFileMap:dword ; CODE XREF: sub_1001B0B0+279p
					; DATA XREF: sub_1001B0B0+279r
		extrn PR_smprintf:dword	; CODE XREF: sub_1001B0B0+260p
					; sub_1001B550+DBp
					; DATA XREF: ...
		extrn PR_ExportFileMapAsString:dword ; CODE XREF: sub_1001B550+63p
					; DATA XREF: sub_1001B550+63r
		extrn PR_ImportFileMapFromString:dword ; CODE XREF: sub_1001B760+135p
					; DATA XREF: sub_1001B760+135r
		extrn __imp_PR_EmulateSendFile:dword ; DATA XREF: PR_EmulateSendFiler
		extrn __imp_PR_EmulateAcceptRead:dword ; DATA XREF: PR_EmulateAcceptReadr
		extrn PR_GetIdentitiesLayer:dword ; CODE XREF: sub_1001C160+Bp
					; SSL_OptionGet+Ep ...
		extrn PR_DestroyMonitor:dword ;	CODE XREF: sub_1001C190+15p
					; sub_1001C190+2Bp ...
		extrn PR_ConvertIPv4AddrToIPv6:dword ; CODE XREF: sub_1001DD10+6Fp
					; DATA XREF: sub_1001DD10+6Fr
		extrn PR_GetSocketOption:dword ; CODE XREF: sub_1001E1F0+29p
					; sub_1001E250+AAp
					; DATA XREF: ...
		extrn PR_GetDefaultIOMethods:dword ; CODE XREF:	sub_1001E6F0+2p
					; DATA XREF: sub_1001E6F0+2r
		extrn PR_GetUniqueIdentity:dword ; CODE	XREF: .text:1001E845p
					; DATA XREF: .text:1001E845r
		extrn PR_PushIOLayer:dword ; CODE XREF:	sub_1001E870+4Ap
					; sub_1001FF60+140p
					; DATA XREF: ...
		extrn PR_GetEnv:dword	; CODE XREF: sub_10022820+18p
					; DATA XREF: sub_10022820+18r
		extrn PR_FindFunctionSymbol:dword ; CODE XREF: sub_10022270+36p
					; DATA XREF: sub_10022270+36r
		extrn PR_UnloadLibrary:dword ; CODE XREF: sub_10022270+83p
					; sub_10022820+2Bp
					; DATA XREF: ...
		extrn PR_GetLibraryFilePathname:dword ;	CODE XREF: sub_10022200+11p
					; DATA XREF: sub_10022200+11r
		extrn PR_Close:dword	; CODE XREF: sub_1001FF60+164p
					; DATA XREF: sub_1001FF60+164r
		extrn PR_GetDirectorySeparator:dword ; CODE XREF: sub_10022150+Cp
					; DATA XREF: sub_10022150+Cr
		extrn PR_LoadLibraryWithFlags:dword ; CODE XREF: sub_10022150+7Fp
					; sub_10022200+4Fp
					; DATA XREF: ...
		extrn PR_CreateIOLayerStub:dword ; CODE	XREF: sub_1001E870+35p
					; sub_1001FF60+12Ap
					; DATA XREF: ...

;
; Imports from libplc4.dll
;
		extrn __imp_PL_strdup:dword ; DATA XREF: PL_strdupr
					; .rdata:10033F8Co

;
; Imports from msvcrt.dll
;
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr .rdata:10033FB4o
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn memmove:dword	; CODE XREF: sub_10004CF0+308p
					; sub_10018A40+48p
					; DATA XREF: ...
; int __cdecl fflush(FILE *File)
		extrn fflush:dword	; CODE XREF: sub_10006BF0+27Cp
					; sub_10009D90+385p
					; DATA XREF: ...
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn fwrite:dword	; CODE XREF: sub_10006BF0+268p
					; sub_10009D90+378p
					; DATA XREF: ...
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn strstr:dword	; CODE XREF: SSL_SecurityStatus+BAp
					; DATA XREF: SSL_SecurityStatus+BAr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; CODE XREF: sub_10018130+2p
					; sub_100181D0+Ep ...
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn strchr:dword	; CODE XREF: sub_1001B760+C0p
					; DATA XREF: sub_1001B760+C0r
; char *__cdecl	getenv(const char *VarName)
		extrn getenv:dword	; CODE XREF: sub_1001B760+95p
					; sub_1001E990+23p ...
; int __cdecl fputs(const char *Str, FILE *File)
		extrn fputs:dword	; CODE XREF: sub_1001E990+62p
					; DATA XREF: sub_1001E990+62r
; __int32 __cdecl ftell(FILE *File)
		extrn ftell:dword	; CODE XREF: sub_1001E990+4Ap
					; DATA XREF: sub_1001E990+4Ar
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn fopen:dword	; CODE XREF: sub_1001E990+37p
					; DATA XREF: sub_1001E990+37r
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn strrchr:dword	; CODE XREF: sub_10022150+17p
					; DATA XREF: sub_10022150+17r
; void *__cdecl	malloc(size_t Size)
		extrn malloc:dword	; CODE XREF: .text:1002847Ap
					; sub_100294F6+5p
					; DATA XREF: ...
; void __cdecl free(void *Memory)
		extrn free:dword	; CODE XREF: .text:10028495p
					; sub_10029518+155p
					; DATA XREF: ...
		extrn __imp__XcptFilter:dword ;	DATA XREF: _XcptFilterr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr

;
; Imports from nss3.dll
;
		extrn __imp_SECKEY_CreateECPrivateKey:dword
					; DATA XREF: SECKEY_CreateECPrivateKeyr
					; .rdata:10033F64o
		extrn __imp_SECKEY_DestroyPrivateKey:dword
					; DATA XREF: SECKEY_DestroyPrivateKeyr
		extrn __imp_SECKEY_DestroyPublicKey:dword
					; DATA XREF: SECKEY_DestroyPublicKeyr
		extrn __imp_PK11_PubUnwrapSymKey:dword ; DATA XREF: PK11_PubUnwrapSymKeyr
		extrn __imp_PK11_DeriveWithFlags:dword ; DATA XREF: PK11_DeriveWithFlagsr
		extrn __imp_PK11_ExtractKeyValue:dword ; DATA XREF: PK11_ExtractKeyValuer
		extrn __imp_PK11_PrivDecryptPKCS1:dword	; DATA XREF: PK11_PrivDecryptPKCS1r
		extrn __imp_PK11_PubWrapSymKey:dword ; DATA XREF: PK11_PubWrapSymKeyr
		extrn __imp_SECKEY_PublicKeyStrength:dword
					; DATA XREF: SECKEY_PublicKeyStrengthr
		extrn __imp_PK11_FreeSlot:dword	; DATA XREF: PK11_FreeSlotr
		extrn __imp_PK11_KeyGen:dword ;	DATA XREF: PK11_KeyGenr
		extrn __imp_PK11_FreeSymKey:dword ; DATA XREF: PK11_FreeSymKeyr
		extrn __imp_PK11_GetBestSlotMultiple:dword
					; DATA XREF: PK11_GetBestSlotMultipler
		extrn __imp_PK11_GetPrivateModulusLen:dword
					; DATA XREF: PK11_GetPrivateModulusLenr
		extrn __imp_SECKEY_GetPrivateKeyType:dword
					; DATA XREF: SECKEY_GetPrivateKeyTyper
		extrn __imp_CERT_ExtractPublicKey:dword	; DATA XREF: CERT_ExtractPublicKeyr
		extrn __imp_PK11_TokenExists:dword ; DATA XREF:	PK11_TokenExistsr
		extrn __imp_PK11_GenerateRandom:dword ;	DATA XREF: PK11_GenerateRandomr
		extrn __imp_DSAU_EncodeDerSigWithLen:dword
					; DATA XREF: DSAU_EncodeDerSigWithLenr
		extrn __imp_SGN_Digest:dword ; DATA XREF: SGN_Digestr
		extrn __imp_PK11_GetBestSlotWithAttributes:dword
					; DATA XREF: PK11_GetBestSlotWithAttributesr
		extrn __imp_CERT_FindCertByName:dword ;	DATA XREF: CERT_FindCertByNamer
		extrn __imp_CERT_FindUserCertByUsage:dword
					; DATA XREF: CERT_FindUserCertByUsager
		extrn __imp_PK11_FindKeyByAnyCert:dword	; DATA XREF: PK11_FindKeyByAnyCertr
		extrn __imp_CERT_GetCertNicknames:dword	; DATA XREF: CERT_GetCertNicknamesr
		extrn __imp_CERT_CheckCertValidTimes:dword
					; DATA XREF: CERT_CheckCertValidTimesr
		extrn __imp_CERT_FreeNicknames:dword ; DATA XREF: CERT_FreeNicknamesr
		extrn __imp_CERT_GetDefaultCertDB:dword	; DATA XREF: CERT_GetDefaultCertDBr
		extrn __imp_CERT_DupDistNames:dword ; DATA XREF: CERT_DupDistNamesr
		extrn __imp_CERT_DistNamesFromCertList:dword
					; DATA XREF: CERT_DistNamesFromCertListr
		extrn __imp_PK11_ReferenceSlot:dword ; DATA XREF: PK11_ReferenceSlotr
		extrn __imp_PK11_CopyTokenPrivKeyToSessionPrivKey:dword
					; DATA XREF: PK11_CopyTokenPrivKeyToSessionPrivKeyr
		extrn __imp_PK11_MapSignKeyType:dword ;	DATA XREF: PK11_MapSignKeyTyper
		extrn __imp_SECKEY_CopyPrivateKey:dword	; DATA XREF: SECKEY_CopyPrivateKeyr
		extrn __imp_SECKEY_CacheStaticFlags:dword
					; DATA XREF: SECKEY_CacheStaticFlagsr
		extrn __imp_CERT_DupCertList:dword ; DATA XREF:	CERT_DupCertListr
		extrn __imp_CERT_GetSSLCACerts:dword ; DATA XREF: CERT_GetSSLCACertsr
		extrn __imp_CERT_FreeDistNames:dword ; DATA XREF: CERT_FreeDistNamesr
		extrn __imp_PK11_Finalize:dword	; DATA XREF: PK11_Finalizer
		extrn __imp_NSS_RegisterShutdown:dword ; DATA XREF: NSS_RegisterShutdownr
		extrn __imp_NSS_VersionCheck:dword ; DATA XREF:	NSS_VersionCheckr
		extrn __imp_VFY_CreateContext:dword ; DATA XREF: VFY_CreateContextr
		extrn __imp_VFY_Begin:dword ; DATA XREF: VFY_Beginr
		extrn __imp_VFY_Update:dword ; DATA XREF: VFY_Updater
		extrn __imp_VFY_End:dword ; DATA XREF: VFY_Endr
		extrn __imp_VFY_DestroyContext:dword ; DATA XREF: VFY_DestroyContextr
		extrn __imp_SGN_NewContext:dword ; DATA	XREF: SGN_NewContextr
		extrn __imp_SGN_Begin:dword ; DATA XREF: SGN_Beginr
		extrn __imp_SGN_Update:dword ; DATA XREF: SGN_Updater
		extrn __imp_SGN_End:dword ; DATA XREF: SGN_Endr
		extrn __imp_SGN_DestroyContext:dword ; DATA XREF: SGN_DestroyContextr
		extrn __imp_PK11_PubEncryptRaw:dword ; DATA XREF: PK11_PubEncryptRawr
		extrn __imp_PK11_PubDecryptRaw:dword ; DATA XREF: PK11_PubDecryptRawr
		extrn __imp_PK11_GetBestSlot:dword ; DATA XREF:	PK11_GetBestSlotr
		extrn __imp___PK11_CreateContextByRawKey:dword
					; DATA XREF: __PK11_CreateContextByRawKeyr
		extrn __imp_HASH_GetHashObject:dword ; DATA XREF: HASH_GetHashObjectr
		extrn __imp_CERT_CacheOCSPResponseFromSideChannel:dword
					; DATA XREF: CERT_CacheOCSPResponseFromSideChannelr
		extrn __imp_CERT_VerifyCert:dword ; DATA XREF: CERT_VerifyCertr
		extrn __imp_CERT_VerifyCertName:dword ;	DATA XREF: CERT_VerifyCertNamer
		extrn __imp_CERT_NameToAscii:dword ; DATA XREF:	CERT_NameToAsciir
		extrn __imp_CERT_NewCertList:dword ; DATA XREF:	CERT_NewCertListr
		extrn __imp_CERT_AddCertToListTail:dword
					; DATA XREF: CERT_AddCertToListTailr
		extrn __imp_CERT_DestroyCertList:dword ; DATA XREF: CERT_DestroyCertListr
		extrn __imp_CERT_NewTempCertificate:dword
					; DATA XREF: CERT_NewTempCertificater
		extrn __imp_SECKEY_UpdateCertPQG:dword ; DATA XREF: SECKEY_UpdateCertPQGr
		extrn __imp_CERT_CertChainFromCert:dword
					; DATA XREF: CERT_CertChainFromCertr
		extrn __imp_PK11_UnwrapSymKeyWithFlags:dword
					; DATA XREF: PK11_UnwrapSymKeyWithFlagsr
		extrn __imp_PK11_ImportSymKey:dword ; DATA XREF: PK11_ImportSymKeyr
		extrn __imp_CERT_DupCertificate:dword ;	DATA XREF: CERT_DupCertificater
		extrn __imp_PK11_GetSlotFromPrivateKey:dword
					; DATA XREF: PK11_GetSlotFromPrivateKeyr
		extrn __imp_SECKEY_CreateDHPrivateKey:dword
					; DATA XREF: SECKEY_CreateDHPrivateKeyr
		extrn __imp_PK11_PubDerive:dword ; DATA	XREF: PK11_PubDeriver
		extrn __imp_PK11_CreateDigestContext:dword
					; DATA XREF: PK11_CreateDigestContextr
		extrn __imp_PK11_GetInternalSlot:dword ; DATA XREF: PK11_GetInternalSlotr
		extrn __imp_CERT_DestroyCertificateList:dword
					; DATA XREF: CERT_DestroyCertificateListr
		extrn __imp_SECKEY_CreateRSAPrivateKey:dword
					; DATA XREF: SECKEY_CreateRSAPrivateKeyr
		extrn __imp_PK11_GetCurrentWrapIndex:dword
					; DATA XREF: PK11_GetCurrentWrapIndexr
		extrn __imp_PK11_GetWrapKey:dword ; DATA XREF: PK11_GetWrapKeyr
		extrn __imp_PK11_GetBestWrapMechanism:dword
					; DATA XREF: PK11_GetBestWrapMechanismr
		extrn __imp_PK11_SetWrapKey:dword ; DATA XREF: PK11_SetWrapKeyr
		extrn __imp_PK11_GetMechanism:dword ; DATA XREF: PK11_GetMechanismr
		extrn __imp_PK11_GetKeyData:dword ; DATA XREF: PK11_GetKeyDatar
		extrn __imp_CERT_DestroyCertificate:dword
					; DATA XREF: CERT_DestroyCertificater
		extrn __imp_PK11_VerifyKeyOK:dword ; DATA XREF:	PK11_VerifyKeyOKr
		extrn __imp_PK11_ReferenceSymKey:dword ; DATA XREF: PK11_ReferenceSymKeyr
		extrn __imp_PK11_GetBestKeyLength:dword	; DATA XREF: PK11_GetBestKeyLengthr
		extrn __imp_SECKEY_PublicKeyStrengthInBits:dword
					; DATA XREF: SECKEY_PublicKeyStrengthInBitsr
		extrn __imp_PK11_WrapSymKey:dword ; DATA XREF: PK11_WrapSymKeyr
		extrn __imp_PK11_UnwrapSymKey:dword ; DATA XREF: PK11_UnwrapSymKeyr
		extrn __imp_PK11_SaveContextAlloc:dword	; DATA XREF: PK11_SaveContextAllocr
		extrn __imp_PK11_RestoreContext:dword ;	DATA XREF: PK11_RestoreContextr
		extrn __imp_PK11_DigestKey:dword ; DATA	XREF: PK11_DigestKeyr
		extrn __imp_PK11_Derive:dword ;	DATA XREF: PK11_Deriver
		extrn __imp_PK11_GetSlotFromKey:dword ;	DATA XREF: PK11_GetSlotFromKeyr
		extrn __imp_PK11_SymKeyFromHandle:dword	; DATA XREF: PK11_SymKeyFromHandler
		extrn __imp_SECMOD_LookupSlot:dword ; DATA XREF: SECMOD_LookupSlotr
		extrn __imp_PK11_IsPresent:dword ; DATA	XREF: PK11_IsPresentr
		extrn __imp_PK11_GetSlotSeries:dword ; DATA XREF: PK11_GetSlotSeriesr
		extrn __imp_PK11_GetSlotID:dword ; DATA	XREF: PK11_GetSlotIDr
		extrn __imp_PK11_GetModuleID:dword ; DATA XREF:	PK11_GetModuleIDr
		extrn __imp_PK11_NeedLogin:dword ; DATA	XREF: PK11_NeedLoginr
		extrn __imp_PK11_IsLoggedIn:dword ; DATA XREF: PK11_IsLoggedInr
		extrn __imp_PK11_SignWithSymKey:dword ;	DATA XREF: PK11_SignWithSymKeyr
		extrn __imp_PK11_DigestBegin:dword ; DATA XREF:	PK11_DigestBeginr
		extrn __imp_PK11_DigestOp:dword	; DATA XREF: PK11_DigestOpr
		extrn __imp_PK11_DigestFinal:dword ; DATA XREF:	PK11_DigestFinalr
		extrn __imp_PK11_CreateContextBySymKey:dword
					; DATA XREF: PK11_CreateContextBySymKeyr
		extrn __imp_PK11_IVFromParam:dword ; DATA XREF:	PK11_IVFromParamr
		extrn __imp_PK11_CipherOp:dword	; DATA XREF: PK11_CipherOpr
		extrn __imp_PK11_Decrypt:dword ; DATA XREF: PK11_Decryptr
		extrn __imp_PK11_Encrypt:dword ; DATA XREF: PK11_Encryptr
		extrn __imp_PK11_ParamFromIV:dword ; DATA XREF:	PK11_ParamFromIVr
		extrn __imp_PK11_DestroyContext:dword ;	DATA XREF: PK11_DestroyContextr
		extrn __imp_PK11_HashBuf:dword ; DATA XREF: PK11_HashBufr
		extrn __imp_HASH_ResultLenByOidTag:dword
					; DATA XREF: HASH_ResultLenByOidTagr
		extrn __imp_SECKEY_SignatureLen:dword ;	DATA XREF: SECKEY_SignatureLenr
		extrn __imp_DSAU_DecodeDerSigToLen:dword
					; DATA XREF: DSAU_DecodeDerSigToLenr
		extrn __imp_VFY_VerifyDigestDirect:dword
					; DATA XREF: VFY_VerifyDigestDirectr
		extrn __imp_PK11_Verify:dword ;	DATA XREF: PK11_Verifyr
		extrn __imp_PK11_SignatureLen:dword ; DATA XREF: PK11_SignatureLenr
		extrn __imp_PK11_PubDeriveWithKDF:dword	; DATA XREF: PK11_PubDeriveWithKDFr
		extrn __imp_PK11_Sign:dword ; DATA XREF: PK11_Signr

;
; Imports from nssutil3.dll
;
		extrn __imp_SECOID_FindOID_Util:dword ;	DATA XREF: SECOID_FindOID_Utilr
					; .rdata:10033F78o
		extrn __imp_SECOID_FindOIDByTag_Util:dword
					; DATA XREF: SECOID_FindOIDByTag_Utilr
		extrn __imp_SECITEM_DupItem_Util:dword ; DATA XREF: SECITEM_DupItem_Utilr
		extrn __imp_DER_Lengths_Util:dword ; DATA XREF:	DER_Lengths_Utilr
		extrn __imp_NSSRWLock_New_Util:dword ; DATA XREF: NSSRWLock_New_Utilr
		extrn __imp_SECITEM_DupArray:dword ; DATA XREF:	SECITEM_DupArrayr
		extrn __imp_NSSRWLock_Destroy_Util:dword
					; DATA XREF: NSSRWLock_Destroy_Utilr
		extrn __imp_ATOB_AsciiToData_Util:dword	; DATA XREF: ATOB_AsciiToData_Utilr
		extrn __imp_BTOA_DataToAscii_Util:dword	; DATA XREF: BTOA_DataToAscii_Utilr
		extrn __imp_NSS_PutEnv_Util:dword ; DATA XREF: NSS_PutEnv_Utilr
		extrn __imp_SECOID_GetAlgorithmTag_Util:dword
					; DATA XREF: SECOID_GetAlgorithmTag_Utilr
		extrn __imp_PORT_Realloc_Util:dword ; DATA XREF: PORT_Realloc_Utilr
		extrn __imp_SECITEM_AllocItem_Util:dword
					; DATA XREF: SECITEM_AllocItem_Utilr
		extrn __imp_SECITEM_ZfreeItem_Util:dword
					; DATA XREF: SECITEM_ZfreeItem_Utilr
		extrn __imp_SECITEM_AllocArray:dword ; DATA XREF: SECITEM_AllocArrayr
		extrn __imp_SECITEM_FreeArray:dword ; DATA XREF: SECITEM_FreeArrayr
		extrn __imp_NSS_SecureMemcmp:dword ; DATA XREF:	NSS_SecureMemcmpr
		extrn __imp_PORT_ArenaAlloc_Util:dword ; DATA XREF: PORT_ArenaAlloc_Utilr
		extrn __imp_PORT_NewArena_Util:dword ; DATA XREF: PORT_NewArena_Utilr
		extrn __imp_PORT_ArenaZAlloc_Util:dword	; DATA XREF: PORT_ArenaZAlloc_Utilr
		extrn __imp_PORT_FreeArena_Util:dword ;	DATA XREF: PORT_FreeArena_Utilr
		extrn __imp_SECITEM_CopyItem_Util:dword	; DATA XREF: SECITEM_CopyItem_Utilr
		extrn __imp_PORT_Strdup_Util:dword ; DATA XREF:	PORT_Strdup_Utilr
		extrn __imp_SECITEM_CompareItem_Util:dword
					; DATA XREF: SECITEM_CompareItem_Utilr
		extrn __imp_PORT_GetError_Util:dword ; DATA XREF: PORT_GetError_Utilr
		extrn __imp_NSSRWLock_LockWrite_Util:dword
					; DATA XREF: NSSRWLock_LockWrite_Utilr
		extrn __imp_NSSRWLock_UnlockWrite_Util:dword
					; DATA XREF: NSSRWLock_UnlockWrite_Utilr
		extrn __imp_NSSRWLock_LockRead_Util:dword
					; DATA XREF: NSSRWLock_LockRead_Utilr
		extrn __imp_NSSRWLock_UnlockRead_Util:dword
					; DATA XREF: NSSRWLock_UnlockRead_Utilr
		extrn __imp_PORT_ZFree_Util:dword ; DATA XREF: PORT_ZFree_Utilr
		extrn __imp_PORT_ZAlloc_Util:dword ; DATA XREF:	PORT_ZAlloc_Utilr
		extrn __imp_PORT_Alloc_Util:dword ; DATA XREF: PORT_Alloc_Utilr
		extrn __imp_SECITEM_FreeItem_Util:dword	; DATA XREF: SECITEM_FreeItem_Utilr
		extrn __imp_PORT_Free_Util:dword ; DATA	XREF: PORT_Free_Utilr
		extrn __imp_PORT_SetError_Util:dword ; DATA XREF: PORT_SetError_Utilr
		extrn __imp_SECITEM_Hash:dword ; DATA XREF: SECITEM_Hashr


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1002A3F4h
dword_1002A3F4	dd 0			; DATA XREF: sub_10029518+B9o
dword_1002A3F8	dd 0			; DATA XREF: sub_10029518+B4o
dword_1002A3FC	dd 0			; DATA XREF: sub_10029518+96o
		dd offset sub_100294F6
dword_1002A404	dd 0			; DATA XREF: sub_10029518:loc_100295A9o
aIiiiiiiii	db 'IIIIIIIII',0        ; DATA XREF: .rdata:1002A46Co
		align 4
aHhhhhhhh	db 'HHHHHHHH',0         ; DATA XREF: .rdata:1002A468o
		align 10h
aGgggggg	db 'GGGGGGG',0          ; DATA XREF: .rdata:1002A464o
aFfffff		db 'FFFFFF',0           ; DATA XREF: .rdata:1002A460o
		align 10h
aEeeee		db 'EEEEE',0            ; DATA XREF: .rdata:1002A45Co
		align 4
aDddd		db 'DDDD',0             ; DATA XREF: .rdata:1002A458o
		align 10h
aCcc		db 'CCC',0              ; DATA XREF: .rdata:1002A454o
aBb		db 'BB',0               ; DATA XREF: .rdata:1002A450o
		align 4
aA		db 'A',0                ; DATA XREF: .rdata:off_1002A44Co
		align 4
off_1002A44C	dd offset aA		; DATA XREF: sub_10001000+216r
					; sub_10001710+132r
					; "A"
		dd offset aBb		; "BB"
		dd offset aCcc		; "CCC"
		dd offset aDddd		; "DDDD"
		dd offset aEeeee	; "EEEEE"
		dd offset aFfffff	; "FFFFFF"
		dd offset aGgggggg	; "GGGGGGG"
		dd offset aHhhhhhhh	; "HHHHHHHH"
		dd offset aIiiiiiiii	; "IIIIIIIII"
dword_1002A470	dd 0			; DATA XREF: sub_10001000+B6r
dword_1002A474	dd 0			; DATA XREF: sub_10001000+C4r
dword_1002A478	dd 0			; DATA XREF: sub_10001000+BCr
aIvBlock	db 'IV block',0         ; DATA XREF: sub_10001000+661o
		align 4
aServerWriteKey	db 'server write key',0 ; DATA XREF: sub_10001000+5F7o
		align 4
aClientWriteKey	db 'client write key',0 ; DATA XREF: sub_10001000+5A2o
		align 10h
aKeyExpansion	db 'key expansion',0    ; DATA XREF: sub_10001000+1BEo
		align 10h
aMasterSecret	db 'master secret',0    ; DATA XREF: sub_10001710+DAo
					; sub_10001710+F9o
		align 10h
aEcdhe		db 'ECDHE',0            ; DATA XREF: SSL_CanBypass+115o
					; .rdata:1002FD68o ...
		align 4
word_1002A4D8	dw 5C0h			; DATA XREF: sub_100024B0:loc_100024D0r
					; sub_100024B0:loc_100024F1r
		dw 4E4h
		dd 0E40224h
dword_1002A4E0	dd 0C011C007h, 0C00C0066h, 4C002h, 640005h, 3, 7373696Dh
					; DATA XREF: sub_100021F0+6o
		dd 676E69h, 2D534541h, 2D383231h, 4D4347h, 44454553h, 4342432Dh
		dd 0
aCamellia256	db 'Camellia-256',0     ; DATA XREF: .rdata:1002AEF4o
		align 4
aCamellia128	db 'Camellia-128',0     ; DATA XREF: .rdata:1002AEF0o
		align 4
aAes256		db 'AES-256',0          ; DATA XREF: .rdata:1002AEECo
aAes128		db 'AES-128',0          ; DATA XREF: .rdata:1002AEE8o
aIdeaCbc	db 'IDEA-CBC',0         ; DATA XREF: .rdata:1002AEE4o
					; .rdata:1002B18Co
		align 10h
aDesCbc40	db 'DES-CBC-40',0       ; DATA XREF: .rdata:1002AEE0o
		align 4
a3desEdeCbc	db '3DES-EDE-CBC',0     ; DATA XREF: .rdata:1002AEDCo
		align 4
aDesCbc		db 'DES-CBC',0          ; DATA XREF: .rdata:1002AED8o
					; .rdata:1002B190o
aRc2Cbc40	db 'RC2-CBC-40',0       ; DATA XREF: .rdata:1002AED4o
		align 10h
aRc2Cbc		db 'RC2-CBC',0          ; DATA XREF: .rdata:1002AED0o
					; .rdata:1002B184o
aRc456		db 'RC4-56',0           ; DATA XREF: .rdata:1002AECCo
		align 10h
aRc440		db 'RC4-40',0           ; DATA XREF: .rdata:1002AEC8o
		align 4
aRc4		db 'RC4',0              ; DATA XREF: .rdata:1002AEC4o
					; .rdata:1002B17Co ...
aNull		db 'NULL',0             ; DATA XREF: SSL_GetChannelInfo:loc_10020532o
					; .rdata:off_1002AEC0o	...
		align 8
byte_1002A5A8	db 1			; DATA XREF: sub_10009320:loc_10009750r
					; sub_10009320:loc_10009B13r ...
		align 4
		dd 2
dword_1002A5B0	dd 24001h		; DATA XREF: sub_1000BCA0+9Do
dword_1002A5B4	dd 3040104h, 204h	; DATA XREF: sub_1000BCA0+D8o
dword_1002A5BC	dd 80000000h		; DATA XREF: sub_10003200:loc_100032F6r
		dd 1, 21h, 1011h, 1050h
dword_1002A5D0	dd 0			; DATA XREF: sub_10003E40+DEo
					; sub_10007290+14o
dword_1002A5D4	dd 0			; DATA XREF: sub_10003200+A9r
		dd 7 dup(0)
		dd 2 dup(1), 2 dup(10h), 5 dup(0)
		dd 2, 1, 10h, 5, 5 dup(0)
		dd 3, 1, 10h, 7, 5 dup(0)
		dd 4, 2, 2 dup(10h), 1,	2 dup(8), 2 dup(0)
		dd 5, 2, 10h, 5, 1, 2 dup(8), 2	dup(0)
		dd 6, 3, 2 dup(8), 1, 2	dup(8),	2 dup(0)
		dd 7, 4, 2 dup(18h), 1,	2 dup(8), 2 dup(0)
		dd 8, 3, 8, 5, 1, 2 dup(8), 2 dup(0)
		dd 9, 5, 2 dup(10h), 1,	2 dup(8), 2 dup(0)
		dd 0Ah,	7, 2 dup(10h), 1, 2 dup(10h), 2	dup(0)
		dd 0Bh,	7, 2 dup(20h), 1, 2 dup(10h), 2	dup(0)
		dd 0Ch,	8, 2 dup(10h), 1, 2 dup(10h), 2	dup(0)
		dd 0Dh,	8, 2 dup(20h), 1, 2 dup(10h), 2	dup(0)
		dd 0Eh,	9, 2 dup(10h), 1, 2 dup(10h), 2	dup(0)
		dd 0Fh,	0Ah, 2 dup(10h), 2, 4, 0
		dd 10h,	8, 10h,	8 dup(0)
		dd 10h
dword_1002A838	dd 0			; DATA XREF: sub_10003E40+CBo
dword_1002A83C	dd 0			; DATA XREF: sub_10003200+BAr
		dd 4 dup(0)
		dd 3 dup(1), 3 dup(0)
		dd 2, 3	dup(1),	200h, 0
		dd 3, 3	dup(1),	400h, 0
		dd 4, 2	dup(2),	3 dup(0)
		dd 5, 2	dup(2),	1, 200h, 0
		dd 6, 2, 1, 3 dup(0)
		dd 7, 2, 2 dup(1), 200h, 0
		dd 8, 2	dup(2),	3 dup(0)
		dd 9, 2	dup(2),	1, 200h, 0
		dd 0Ah,	2, 1, 3	dup(0)
		dd 0Bh,	2, 2 dup(1), 200h, 0
		dd 0Ch,	2, 4 dup(0)
		dd 0Dh,	2, 0
		dd 1, 200h, 0
		dd 0Eh,	2 dup(1), 2 dup(0)
		dd 1, 0Fh, 4, 3, 3 dup(0)
		dd 10h,	4, 3, 3	dup(0)
		dd 11h,	4, 1, 3	dup(0)
		dd 12h,	4, 1, 3	dup(0)
		dd 13h,	4, 4 dup(0)
dword_1002AA18	dd 4 dup(0)		; DATA XREF: sub_100031C0+2o
					; sub_100031C0+2Bo ...
		dd 1, 0
		dd 2 dup(1), 2,	0
		dd 2, 1, 3Bh, 0
		dd 5, 1, 3, 2, 1, 2, 4,	3 dup(1), 5, 1,	2, 1, 6, 5, 1
		dd 2, 9, 6, 2, 1, 0Ah, 7, 2, 1,	12h, 6,	2, 8, 13h, 7, 2
		dd 8, 66h, 1, 2, 8, 15h, 6, 2, 0Ah, 16h, 7, 2, 0Ah, 2Fh
		dd 0Ah,	2, 1, 3Ch, 0Ah,	5, 1, 32h, 0Ah,	2, 8, 33h, 0Ah
		dd 2, 0Ah, 67h,	0Ah, 5,	0Ah, 35h, 0Bh, 2, 1, 3Dh, 0Bh
		dd 5, 1, 38h, 0Bh, 2, 8, 39h, 0Bh, 2, 0Ah, 6Bh,	0Bh, 5
		dd 0Ah,	96h, 0Eh, 2, 1,	41h, 0Ch, 2, 1,	44h, 0Ch, 2, 8
		dd 45h,	0Ch, 2,	0Ah, 84h, 0Dh, 2, 1, 87h, 0Dh, 2, 8, 88h
		dd 0Dh,	2, 0Ah,	62h, 6,	2, 3, 64h, 3, 2, 3, 0FEFFh, 7
		dd 2, 0Eh, 0FEFEh, 6, 2, 0Eh, 9Eh, 0Fh,	6, 0Ah,	9Ch, 0Fh
		dd 6, 1, 0C02Fh, 0Fh, 6, 12h, 0C02Bh, 0Fh, 6, 10h, 0C001h
		dd 0
		dd 2, 0Fh, 0C002h, 1, 2, 0Fh, 0C003h, 7, 2, 0Fh, 0C004h
		dd 0Ah,	2, 0Fh,	0C005h,	0Bh, 2,	0Fh, 0C006h, 0
		dd 2, 10h, 0C007h, 1, 2, 10h, 0C008h, 7, 2, 10h, 0C009h
		dd 0Ah,	2, 10h,	0C023h,	0Ah, 5,	10h, 0C00Ah, 0Bh, 2, 10h
		dd 0C00Bh, 0
		dd 2, 11h, 0C00Ch, 1, 2, 11h, 0C00Dh, 7, 2, 11h, 0C00Eh
		dd 0Ah,	2, 11h,	0C00Fh,	0Bh, 2,	11h, 0C010h, 0
		dd 2, 12h, 0C011h, 1, 2, 12h, 0C012h, 7, 2, 12h, 0C013h
		dd 0Ah,	2, 12h,	0C027h,	0Ah, 5,	12h, 0C014h, 0Bh, 2, 12h
dword_1002ADF8	dd 0			; DATA XREF: sub_100031C0+10o
					; sub_10003200+6Do ...
dword_1002ADFC	dd 80000000h		; DATA XREF: sub_10003200+B0r
					; sub_100044F0+F7r ...
		dd 1, 111h, 2, 102h, 3,	122h, 4, 133h, 5, 342h,	6, 1002h
		dd 7, 1082h, 8,	552h, 9, 652h, 0Ah, 1087h
dword_1002AE50	dd 0			; DATA XREF: sub_10003E40+C1o
					; sub_10007290+1Ao
		dd 80000000h, 2	dup(0)
		dd 1, 380h, 30h, 10h, 2, 381h, 28h, 14h, 3, 211h, 0
		dd 10h,	4, 221h, 0
		dd 14h,	5, 251h, 0
		dd 20h,	6, 80000000h, 2	dup(0)
off_1002AEC0	dd offset aNull		; DATA XREF: SSL_SecurityStatus+A9r
					; "NULL"
		dd offset aRc4		; "RC4"
		dd offset aRc440	; "RC4-40"
		dd offset aRc456	; "RC4-56"
		dd offset aRc2Cbc	; "RC2-CBC"
		dd offset aRc2Cbc40	; "RC2-CBC-40"
		dd offset aDesCbc	; "DES-CBC"
		dd offset a3desEdeCbc	; "3DES-EDE-CBC"
		dd offset aDesCbc40	; "DES-CBC-40"
		dd offset aIdeaCbc	; "IDEA-CBC"
		dd offset aAes128	; "AES-128"
		dd offset aAes256	; "AES-256"
		dd offset aCamellia128	; "Camellia-128"
		dd offset aCamellia256	; "Camellia-256"
		dd offset dword_1002A4E0+28h
		dd offset dword_1002A4E0+1Ch
		dd offset dword_1002A4E0+14h
		dd 8, 10h, 8
a66666666666666	db '666666666666666666666666666666666666666666666666666666666666\\\\\'
					; DATA XREF: sub_100047D0+126o
					; sub_100056B0+152o ...
		db '\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\',0
		db 2 dup(0), 44h
dword_1002AF8C	dd 1			; DATA XREF: sub_100055A0:loc_100055A6r
					; sub_100090F0:loc_1000912Ar ...
dword_1002AF90	dd 3			; DATA XREF: sub_100055A0:loc_100055B8r
					; sub_100090F0:loc_10009100r ...
		dd 2, 4, 3, 135h, 4, 0BFh, 5, 0C0h, 6, 0C1h
byte_1002AFBC	db 30h			; DATA XREF: sub_10006BF0+C9r
					; sub_10006BF0+D5r ...
a123456789abcde	db '123456789abcdef',0
		align 10h
dword_1002AFD0	dd 132h, 321h, 121h, 400h, 341h, 311h, 301h, 331h, 101h
					; DATA XREF: sub_10005DB0o
					; sub_10005DB0:loc_10005DE0o
		dd 141h, 1008h,	1002h, 1081h, 551h, 651h, 7FFFFFFFh
dword_1002B010	dd 10001FFh, 0		; DATA XREF: sub_1000D820+361o
					; sub_1000E730+347o
byte_1002B018	db 4			; DATA XREF: sub_10006810+79r
		db 5, 6, 2
dword_1002B01C	dd 8 dup(0)		; DATA XREF: sub_1000C900+9Bo
a1_2_5		db '1.2.5',0            ; DATA XREF: sub_10004090+4Eo
					; sub_10004090+77o
		align 4
dword_1002B044	dd 45494C43h		; DATA XREF: sub_10006BF0+81r
dword_1002B048	dd 525F544Eh		; DATA XREF: sub_10006BF0+8Dr
dword_1002B04C	dd 4F444E41h		; DATA XREF: sub_10006BF0+87r
word_1002B050	dw 204Dh		; DATA XREF: sub_10006BF0+96r
		align 4
aClientFinished	db 'client finished',0  ; DATA XREF: sub_1000C9C0+78o
					; sub_1000CB90+B9o
aServerFinished	db 'server finished',0  ; DATA XREF: sub_1000C9C0+71o
					; sub_1000CB90+B2o
dword_1002B074	dd 20415352h		; DATA XREF: sub_10009D90+14Ar
byte_1002B078	db 0			; DATA XREF: sub_10009D90+153r
		align 4
aNoCertificate	db 'no certificate',0   ; DATA XREF: SSL_SecurityStatus+1A7o
					; SSL_SecurityStatus+1C1o
		align 4
; char SubStr[]
SubStr		db 'DES',0              ; DATA XREF: SSL_SecurityStatus+B4o
					; .rdata:1002FB08o ...
aDesEde3Cbc	db 'DES-EDE3-CBC',0     ; DATA XREF: .rdata:1002B194o
		align 10h
aRc2CbcExport	db 'RC2-CBC-Export',0   ; DATA XREF: .rdata:1002B188o
		align 10h
aRc4Export	db 'RC4-Export',0       ; DATA XREF: .rdata:1002B180o
		align 4
aUnknown	db 'unknown',0          ; DATA XREF: .rdata:Stro
					; .rdata:1002B198o ...
aSecurity_versi	db 'SECURITY_VERSION: +us +export',0 ; DATA XREF: .data:100370F4o
		align 4
		dd 0
		dd 1000000h, 28000h, 80000380h,	5800004h, 68000h, 0C0000740h
		dd 0
byte_1002B104	db 1			; DATA XREF: sub_10010B90:loc_10010C61r
					; sub_10012610+61o ...
byte_1002B105	db 0			; DATA XREF: sub_10010B90+E4r
byte_1002B106	db 80h			; DATA XREF: sub_10010B90+EEr
		db 3
dword_1002B108	dd 78000h		; DATA XREF: sub_10013DA0+1CFr
dword_1002B10C	dd 400006C0h		; DATA XREF: sub_10013DA0+1DCr
dword_1002B110	dd 4800002h		; DATA XREF: sub_10013DA0+1EEr
word_1002B114	dw 8000h		; DATA XREF: sub_10013DA0+1F8r
		align 4
byte_1002B118	db 0			; DATA XREF: sub_10011E00+75r
byte_1002B119	db 0			; DATA XREF: sub_10011E00+6Dr
byte_1002B11A	db 0			; DATA XREF: sub_10011FA0+240r
byte_1002B11B	db 0			; DATA XREF: sub_10011FA0+24Dr
dword_1002B11C	dd 0			; DATA XREF: sub_10011FA0+101r
byte_1002B120	db 0			; DATA XREF: sub_10012280+90r
byte_1002B121	db 0			; DATA XREF: sub_10012280+B2r
					; sub_10012960+D3r
byte_1002B122	db 0			; DATA XREF: sub_10012280+C1r
					; sub_10012960+CBr
		align 4
		dd 11002h, 111h, 10h, 11002h, 111h, 0B10h, 3081002h, 102h
		dd 80010h, 3081002h, 102h, 80B10h, 3 dup(0)
		dd 3080801h, 122h, 80008h, 3081803h, 133h, 80018h
; char *Str
Str		dd offset aUnknown	; DATA XREF: SSL_SecurityStatus+9Dr
					; "unknown"
		dd offset aRc4		; "RC4"
		dd offset aRc4Export	; "RC4-Export"
		dd offset aRc2Cbc	; "RC2-CBC"
		dd offset aRc2CbcExport	; "RC2-CBC-Export"
		dd offset aIdeaCbc	; "IDEA-CBC"
		dd offset aDesCbc	; "DES-CBC"
		dd offset aDesEde3Cbc	; "DES-EDE3-CBC"
		dd offset aUnknown	; "unknown"
		dd offset aUnknown	; "unknown"
dword_1002B1A0	dd 2 dup(3030303h)	; DATA XREF: sub_10012280+18Do
dword_1002B1A8	dd 0			; DATA XREF: sub_10012610:loc_100126AFo
a3_17_1BasicEcc	db '3.17.1 Basic ECC',0 ; DATA XREF: NSSSSL_GetVersiono
		align 10h
; Exported entry  46. SSL_ImplementedCiphers
		public SSL_ImplementedCiphers
SSL_ImplementedCiphers dw 0C02Bh	; DATA XREF: SSL_GetImplementedCipherso
					; NSS_SetDomesticPolicy+3o ...
		dw 0C02Fh
		dd 0C009C00Ah, 0C023C013h, 0C014C027h, 0C012C008h, 0C011C007h
		dd 33009Eh, 670032h, 440045h, 380039h, 88006Bh,	160087h
		dd 660013h, 0C00EC004h,	0C00FC005h, 0C00DC003h,	0C00CC002h
		dd 2F009Ch, 41003Ch, 3D0035h, 960084h, 0AFEFFh,	40005h
		dd 120015h, 9FEFEh, 620064h, 60003h, 0C010C006h, 0C001C00Bh
		dd 3B0002h, 0FF010001h,	0FF07FF03h, 0FF02FF06h,	0FF04h
; Exported entry  51. SSL_NumImplementedCiphers
		public SSL_NumImplementedCiphers
SSL_NumImplementedCiphers dd 43h, 656C7373h, 7272h, 0 ;	DATA XREF: .rdata:off_10035848o
					; .rdata:1002E7D4o
aTheServerRejec	db 'The server rejected the handshake because the client downgraded t'
					; DATA XREF: .rdata:1002E7C4o
		db 'o a lower TLS version than the server supports.',0
		align 4
aSsl_error_inap	db 'SSL_ERROR_INAPPROPRIATE_FALLBACK_ALERT',0 ; DATA XREF: .rdata:1002E7C0o
		align 8
aTheServerSuppo	db 'The server supports no protocols that the client advertises in th'
					; DATA XREF: .rdata:1002E7BCo
		db 'e ALPN extension.',0
		align 4
aSsl_error_next	db 'SSL_ERROR_NEXT_PROTOCOL_NO_PROTOCOL',0 ; DATA XREF: .rdata:1002E7B8o
aTheNextProtoco	db 'The next protocol negotiation extension was enabled, but the call'
					; DATA XREF: .rdata:1002E7B4o
		db 'back was cleared prior to being needed.',0
		align 4
aSsl_error_ne_0	db 'SSL_ERROR_NEXT_PROTOCOL_NO_CALLBACK',0 ; DATA XREF: .rdata:1002E7B0o
aIncorrectSigna	db 'Incorrect signature algorithm specified in a digitally-signed ele'
					; DATA XREF: .rdata:1002E7ACo
		db 'ment.',0
		align 4
aSsl_error_inco	db 'SSL_ERROR_INCORRECT_SIGNATURE_ALGORITHM',0 ; DATA XREF: .rdata:1002E7A8o
aDigestFunction	db 'Digest function failed.',0 ; DATA XREF: .rdata:1002E7A4o
aSsl_error_dige	db 'SSL_ERROR_DIGEST_FAILURE',0 ; DATA XREF: .rdata:1002E7A0o
		align 4
aUnsupportedHas	db 'Unsupported hash algorithm used by TLS peer.',0
					; DATA XREF: .rdata:1002E79Co
		align 4
aSsl_error_unsu	db 'SSL_ERROR_UNSUPPORTED_HASH_ALGORITHM',0 ; DATA XREF: .rdata:1002E798o
		align 10h
aSslReceivedAnU	db 'SSL received an unexpected Certificate Status handshake message.',0
					; DATA XREF: .rdata:1002E794o
		align 4
aSsl_error_rx_u	db 'SSL_ERROR_RX_UNEXPECTED_CERT_STATUS',0 ; DATA XREF: .rdata:1002E790o
aSslFeatureNotS	db 'SSL feature not supported for the protocol version.',0
					; DATA XREF: .rdata:1002E78Co
aSsl_error_feat	db 'SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_VERSION',0
					; DATA XREF: .rdata:1002E788o
aSslReceivedA_0	db 'SSL received an unexpected Hello Verify Request handshake message'
					; DATA XREF: .rdata:1002E784o
		db '.',0
		align 4
aSsl_error_rx_0	db 'SSL_ERROR_RX_UNEXPECTED_HELLO_VERIFY_REQUEST',0
					; DATA XREF: .rdata:1002E780o
		align 10h
aSslReceivedAMa	db 'SSL received a malformed Hello Verify Request handshake message.',0
					; DATA XREF: .rdata:1002E77Co
		align 4
aSsl_error_rx_m	db 'SSL_ERROR_RX_MALFORMED_HELLO_VERIFY_REQUEST',0
					; DATA XREF: .rdata:1002E778o
aSslPeerSelecte	db 'SSL peer selected a cipher suite disallowed for the selected prot'
					; DATA XREF: .rdata:1002E774o
		db 'ocol version.',0
		align 10h
aSsl_error_ciph	db 'SSL_ERROR_CIPHER_DISALLOWED_FOR_VERSION',0 ; DATA XREF: .rdata:1002E770o
aSslVersionRang	db 'SSL version range is not valid.',0 ; DATA XREF: .rdata:1002E76Co
aSsl_error_inva	db 'SSL_ERROR_INVALID_VERSION_RANGE',0 ; DATA XREF: .rdata:1002E768o
aSslFeatureNo_0	db 'SSL feature not supported for clients.',0 ; DATA XREF: .rdata:1002E764o
		align 10h
aSsl_error_fe_0	db 'SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_CLIENTS',0
					; DATA XREF: .rdata:1002E760o
aSslFeatureNo_1	db 'SSL feature not supported for servers.',0 ; DATA XREF: .rdata:1002E75Co
		align 4
aSsl_error_fe_1	db 'SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_SERVERS',0
					; DATA XREF: .rdata:1002E758o
aSslFeatureNo_2	db 'SSL feature not supported for SSL 2.0 connections.',0
					; DATA XREF: .rdata:1002E754o
		align 4
aSsl_error_fe_2	db 'SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_SSL2',0
					; DATA XREF: .rdata:1002E750o
		align 10h
aSslReceivedInv	db 'SSL received invalid NPN extension data.',0
					; DATA XREF: .rdata:1002E74Co
		align 4
aSsl_error_ne_1	db 'SSL_ERROR_NEXT_PROTOCOL_DATA_INVALID',0 ; DATA XREF: .rdata:1002E748o
		align 8
aSslReceivedAWe	db 'SSL received a weak ephemeral Diffie-Hellman key in Server Key Ex'
					; DATA XREF: .rdata:1002E744o
		db 'change handshake message.',0
		align 4
aSsl_error_weak	db 'SSL_ERROR_WEAK_SERVER_EPHEMERAL_DH_KEY',0 ; DATA XREF: .rdata:1002E740o
		align 4
aSslReceivedA_1	db 'SSL received an unexpected uncompressed record.',0
					; DATA XREF: .rdata:1002E73Co
aSsl_error_rx_1	db 'SSL_ERROR_RX_UNEXPECTED_UNCOMPRESSED_RECORD',0
					; DATA XREF: .rdata:1002E738o
aPeerAttemptedO	db 'Peer attempted old style (potentially vulnerable) handshake.',0
					; DATA XREF: .rdata:1002E734o
		align 4
aSsl_error_unsa	db 'SSL_ERROR_UNSAFE_NEGOTIATION',0 ; DATA XREF: .rdata:1002E730o
		align 4
aRenegotiationI	db 'Renegotiation is not allowed on this SSL socket.',0
					; DATA XREF: .rdata:1002E72Co
		align 4
aSsl_error_rene	db 'SSL_ERROR_RENEGOTIATION_NOT_ALLOWED',0 ; DATA XREF: .rdata:1002E728o
aSslReceivedACo	db 'SSL received a compressed record that could not be decompressed.',0
					; DATA XREF: .rdata:1002E724o
		align 4
aSsl_error_deco	db 'SSL_ERROR_DECOMPRESSION_FAILURE',0 ; DATA XREF: .rdata:1002E720o
aSslReceivedA_2	db 'SSL received a malformed New Session Ticket handshake message.',0
					; DATA XREF: .rdata:1002E71Co
		align 4
aSsl_error_rx_2	db 'SSL_ERROR_RX_MALFORMED_NEW_SESSION_TICKET',0
					; DATA XREF: .rdata:1002E718o
		align 10h
aSslReceivedA_3	db 'SSL received an unexpected New Session Ticket handshake message.',0
					; DATA XREF: .rdata:1002E714o
		align 4
aSsl_error_rx_3	db 'SSL_ERROR_RX_UNEXPECTED_NEW_SESSION_TICKET',0
					; DATA XREF: .rdata:1002E710o
		align 10h
aSslPeerReporte	db 'SSL peer reported bad certificate hash value.',0
					; DATA XREF: .rdata:1002E70Co
		align 10h
aSsl_error_bad_	db 'SSL_ERROR_BAD_CERT_HASH_VALUE_ALERT',0 ; DATA XREF: .rdata:1002E708o
		align 8
aSslPeerWasUnab	db 'SSL peer was unable to get an OCSP response for its certificate.',0
					; DATA XREF: .rdata:1002E704o
		align 4
aSsl_error_ba_0	db 'SSL_ERROR_BAD_CERT_STATUS_RESPONSE_ALERT',0
					; DATA XREF: .rdata:1002E700o
		align 4
aSslPeerHasNoCe	db 'SSL peer has no certificate for the requested DNS name.',0
					; DATA XREF: .rdata:1002E6FCo
aSsl_error_unre	db 'SSL_ERROR_UNRECOGNIZED_NAME_ALERT',0 ; DATA XREF: .rdata:1002E6F8o
		align 8
aSslPeerCouldNo	db 'SSL peer could not obtain your certificate from the supplied URL.'
					; DATA XREF: .rdata:1002E6F4o
		db 0
		align 4
aSsl_error_cert	db 'SSL_ERROR_CERTIFICATE_UNOBTAINABLE_ALERT',0
					; DATA XREF: .rdata:1002E6F0o
		align 4
aSslPeerDoesNot	db 'SSL peer does not support requested TLS hello extension.',0
					; DATA XREF: .rdata:1002E6ECo
		align 4
aSsl_error_un_0	db 'SSL_ERROR_UNSUPPORTED_EXTENSION_ALERT',0 ; DATA XREF: .rdata:1002E6E8o
		align 10h
aSslServerCache	db 'SSL server cache not configured and not disabled for this socket.'
					; DATA XREF: .rdata:1002E6E4o
		db 0
		align 4
aSsl_error_serv	db 'SSL_ERROR_SERVER_CACHE_NOT_CONFIGURED',0 ; DATA XREF: .rdata:1002E6E0o
		align 4
aPeerDoesNotPer	db 'Peer does not permit renegotiation of SSL security parameters.',0
					; DATA XREF: .rdata:1002E6DCo
		align 4
aSsl_error_no_r	db 'SSL_ERROR_NO_RENEGOTIATION_ALERT',0 ; DATA XREF: .rdata:1002E6D8o
		align 10h
aPeerUserCancel	db 'Peer user canceled handshake.',0 ; DATA XREF: .rdata:1002E6D4o
		align 10h
aSsl_error_user	db 'SSL_ERROR_USER_CANCELED_ALERT',0 ; DATA XREF: .rdata:1002E6D0o
		align 10h
aPeerReportsItE	db 'Peer reports it experienced an internal error.',0
					; DATA XREF: .rdata:1002E6CCo
		align 10h
aSsl_error_inte	db 'SSL_ERROR_INTERNAL_ERROR_ALERT',0 ; DATA XREF: .rdata:1002E6C8o
		align 10h
aServerRequires	db 'Server requires ciphers more secure than those supported by clien'
					; DATA XREF: .rdata:1002E6C4o
		db 't.',0
aSsl_error_insu	db 'SSL_ERROR_INSUFFICIENT_SECURITY_ALERT',0 ; DATA XREF: .rdata:1002E6C0o
		align 4
aPeerReportsInc	db 'Peer reports incompatible or unsupported protocol version.',0
					; DATA XREF: .rdata:1002E6BCo
		align 4
aSsl_error_prot	db 'SSL_ERROR_PROTOCOL_VERSION_ALERT',0 ; DATA XREF: .rdata:1002E6B8o
		align 10h
aPeerReportsNeg	db 'Peer reports negotiation not in compliance with export regulation'
					; DATA XREF: .rdata:1002E6B4o
		db 's.',0
aSsl_error_ex_0	db 'SSL_ERROR_EXPORT_RESTRICTION_ALERT',0 ; DATA XREF: .rdata:1002E6B0o
		align 4
aPeerReportsFai	db 'Peer reports failure of signature verification or key exchange.',0
					; DATA XREF: .rdata:1002E6ACo
aSsl_error_decr	db 'SSL_ERROR_DECRYPT_ERROR_ALERT',0 ; DATA XREF: .rdata:1002E6A8o
		align 4
aPeerCouldNotDe	db 'Peer could not decode an SSL handshake message.',0
					; DATA XREF: .rdata:1002E6A4o
aSsl_error_de_0	db 'SSL_ERROR_DECODE_ERROR_ALERT',0 ; DATA XREF: .rdata:1002E6A0o
		align 4
aPeerReceivedAV	db 'Peer received a valid certificate, but access was denied.',0
					; DATA XREF: .rdata:1002E69Co
		align 4
aSsl_error_acce	db 'SSL_ERROR_ACCESS_DENIED_ALERT',0 ; DATA XREF: .rdata:1002E698o
		align 8
aPeerDoesNotRec	db 'Peer does not recognize and trust the CA that issued your certifi'
					; DATA XREF: .rdata:1002E694o
		db 'cate.',0
		align 10h
aSsl_error_unkn	db 'SSL_ERROR_UNKNOWN_CA_ALERT',0 ; DATA XREF: .rdata:1002E690o
		align 4
aPeerReceivedAn	db 'Peer received an SSL record that was longer than is permitted.',0
					; DATA XREF: .rdata:1002E68Co
		align 4
aSsl_error_reco	db 'SSL_ERROR_RECORD_OVERFLOW_ALERT',0 ; DATA XREF: .rdata:1002E688o
aPeerWasUnableT	db 'Peer was unable to decrypt an SSL record it received.',0
					; DATA XREF: .rdata:1002E684o
		align 4
aSsl_error_de_1	db 'SSL_ERROR_DECRYPTION_FAILED_ALERT',0 ; DATA XREF: .rdata:1002E680o
		align 4
aClientSSslSess	db 'Client',27h,'s SSL session ID not found in server',27h,'s session cache'
					; DATA XREF: .rdata:1002E67Co
		db '.',0
		align 4
aSsl_error_sess	db 'SSL_ERROR_SESSION_NOT_FOUND',0 ; DATA XREF: .rdata:1002E678o
		align 8
aNoCertificateA	db 'No certificate authority is trusted for SSL client authentication'
					; DATA XREF: .rdata:1002E674o
		db '.',0
		align 4
aSsl_error_no_t	db 'SSL_ERROR_NO_TRUSTED_SSL_CLIENT_CA',0 ; DATA XREF: .rdata:1002E670o
		align 10h
aTheCertificate	db 'The certificate provided cannot be used with the selected key exc'
					; DATA XREF: .rdata:1002E66Co
		db 'hange algorithm.',0
		align 4
aSsl_error_ce_0	db 'SSL_ERROR_CERT_KEA_MISMATCH',0 ; DATA XREF: .rdata:1002E668o
aReceivedIncorr	db 'Received incorrect handshakes hash values from peer.',0
					; DATA XREF: .rdata:1002E664o
		align 4
aSsl_error_ba_1	db 'SSL_ERROR_BAD_HANDSHAKE_HASH_VALUE',0 ; DATA XREF: .rdata:1002E660o
		align 4
aCannotPerformT	db 'Cannot perform the operation until the handshake is complete.',0
					; DATA XREF: .rdata:1002E65Co
		align 4
aSsl_error_hand	db 'SSL_ERROR_HANDSHAKE_NOT_COMPLETED',0 ; DATA XREF: .rdata:1002E658o
		align 10h
aCannotCommunic	db 'Cannot communicate securely with peer: no common compression algo'
					; DATA XREF: .rdata:1002E654o
		db 'rithm(s).',0
		align 4
aSsl_error_no_c	db 'SSL_ERROR_NO_COMPRESSION_OVERLAP',0 ; DATA XREF: .rdata:1002E650o
		align 10h
aNoPkcs11TokenC	db 'No PKCS#11 token could be found to do a required operation.',0
					; DATA XREF: .rdata:1002E64Co
aSsl_error_toke	db 'SSL_ERROR_TOKEN_SLOT_NOT_FOUND',0 ; DATA XREF: .rdata:1002E648o
		align 10h
aPkcs11TokenWas	db 'PKCS#11 token was inserted or removed while operation was in prog'
					; DATA XREF: .rdata:1002E644o
		db 'ress.',0
		align 4
aSsl_error_to_0	db 'SSL_ERROR_TOKEN_INSERTION_REMOVAL',0 ; DATA XREF: .rdata:1002E640o
		align 4
aServerHasNoKey	db 'Server has no key for the attempted key exchange algorithm.',0
					; DATA XREF: .rdata:1002E63Co
aSsl_error_no_s	db 'SSL_ERROR_NO_SERVER_KEY_FOR_ALG',0 ; DATA XREF: .rdata:1002E638o
aClientFailedTo	db 'Client failed to generate session keys for SSL session.',0
					; DATA XREF: .rdata:1002E634o
aSsl_error_se_0	db 'SSL_ERROR_SESSION_KEY_GEN_FAILURE',0 ; DATA XREF: .rdata:1002E630o
		align 4
aFailedToInitia	db 'Failed to initialize the selected cipher suite.',0
					; DATA XREF: .rdata:1002E62Co
aSsl_error_init	db 'SSL_ERROR_INIT_CIPHER_SUITE_FAILURE',0 ; DATA XREF: .rdata:1002E628o
aPkcs11CodeFail	db 'PKCS11 code failed to translate an IV into a param.',0
					; DATA XREF: .rdata:1002E624o
aSsl_error_iv_p	db 'SSL_ERROR_IV_PARAM_FAILURE',0 ; DATA XREF: .rdata:1002E620o
		align 4
aSslServerAttem	db 'SSL Server attempted to use domestic-grade public key with export'
					; DATA XREF: .rdata:1002E61Co
		db ' cipher suite.',0
aSsl_error_pub_	db 'SSL_ERROR_PUB_KEY_SIZE_LIMIT_EXCEEDED',0 ; DATA XREF: .rdata:1002E618o
		align 10h
aFailureToUnwra	db 'Failure to unwrap the Symmetric key in Client Key Exchange messag'
					; DATA XREF: .rdata:1002E614o
		db 'e.',0
aSsl_error_sym_	db 'SSL_ERROR_SYM_KEY_UNWRAP_FAILURE',0 ; DATA XREF: .rdata:1002E610o
		align 4
aFailureToCreat	db 'Failure to create Symmetric Key context.',0
					; DATA XREF: .rdata:1002E60Co
		align 4
aSsl_error_sy_0	db 'SSL_ERROR_SYM_KEY_CONTEXT_FAILURE',0 ; DATA XREF: .rdata:1002E608o
		align 4
aMacComputation	db 'MAC computation failed.',0 ; DATA XREF: .rdata:1002E604o
aSsl_error_mac_	db 'SSL_ERROR_MAC_COMPUTATION_FAILURE',0 ; DATA XREF: .rdata:1002E600o
		align 4
aSha1DigestFunc	db 'SHA-1 digest function failed.',0 ; DATA XREF: .rdata:1002E5FCo
		align 4
aSsl_error_sha_	db 'SSL_ERROR_SHA_DIGEST_FAILURE',0 ; DATA XREF: .rdata:1002E5F8o
		align 4
aMd5DigestFunct	db 'MD5 digest function failed.',0 ; DATA XREF: .rdata:1002E5F4o
aSsl_error_md5_	db 'SSL_ERROR_MD5_DIGEST_FAILURE',0 ; DATA XREF: .rdata:1002E5F0o
		align 10h
aAttemptToWrite	db 'Attempt to write encrypted data to underlying socket failed.',0
					; DATA XREF: .rdata:1002E5ECo
		align 10h
aSsl_error_sock	db 'SSL_ERROR_SOCKET_WRITE_FAILURE',0 ; DATA XREF: .rdata:1002E5E8o
		align 10h
aBulkDataDecryp	db 'Bulk data decryption algorithm failed in selected cipher suite.',0
					; DATA XREF: .rdata:1002E5E4o
aSsl_error_de_2	db 'SSL_ERROR_DECRYPTION_FAILURE',0 ; DATA XREF: .rdata:1002E5E0o
		align 10h
aBulkDataEncryp	db 'Bulk data encryption algorithm failed in selected cipher suite.',0
					; DATA XREF: .rdata:1002E5DCo
aSsl_error_encr	db 'SSL_ERROR_ENCRYPTION_FAILURE',0 ; DATA XREF: .rdata:1002E5D8o
		align 10h
aUnspecifiedFai	db 'Unspecified failure while processing SSL Client Key Exchange hand'
					; DATA XREF: .rdata:1002E5D4o
		db 'shake.',0
aSsl_error_clie	db 'SSL_ERROR_CLIENT_KEY_EXCHANGE_FAILURE',0 ; DATA XREF: .rdata:1002E5D0o
		align 10h
aUnspecifiedF_0	db 'Unspecified failure while processing SSL Server Key Exchange hand'
					; DATA XREF: .rdata:1002E5CCo
		db 'shake.',0
aSsl_error_se_1	db 'SSL_ERROR_SERVER_KEY_EXCHANGE_FAILURE',0 ; DATA XREF: .rdata:1002E5C8o
		align 10h
aSslWasUnableTo	db 'SSL was unable to extract the public key from the peer',27h,'s certi'
					; DATA XREF: .rdata:1002E5C4o
		db 'ficate.',0
		align 4
aSsl_error_extr	db 'SSL_ERROR_EXTRACT_PUBLIC_KEY_FAILURE',0 ; DATA XREF: .rdata:1002E5C0o
		align 10h
aUnableToDigita	db 'Unable to digitally sign data required to verify your certificate'
					; DATA XREF: .rdata:1002E5BCo
		db '.',0
		align 4
aSsl_error_sign	db 'SSL_ERROR_SIGN_HASHES_FAILURE',0 ; DATA XREF: .rdata:1002E5B8o
		align 4
aSslExperienced	db 'SSL experienced a failure of its random number generator.',0
					; DATA XREF: .rdata:1002E5B4o
		align 10h
aSsl_error_gene	db 'SSL_ERROR_GENERATE_RANDOM_FAILURE',0 ; DATA XREF: .rdata:1002E5B0o
		align 8
aSslPeerHadSome	db 'SSL peer had some unspecified issue with the certificate it recei'
					; DATA XREF: .rdata:1002E5ACo
		db 'ved.',0
		align 10h
aSsl_error_ce_1	db 'SSL_ERROR_CERTIFICATE_UNKNOWN_ALERT',0 ; DATA XREF: .rdata:1002E5A8o
		align 8
aSslPeerDoesN_0	db 'SSL peer does not support certificates of the type it received.',0
					; DATA XREF: .rdata:1002E5A4o
aSsl_error_un_1	db 'SSL_ERROR_UNSUPPORTED_CERT_ALERT',0 ; DATA XREF: .rdata:1002E5A0o
		align 10h
aSslPeerRejecte	db 'SSL peer rejected a handshake message for unacceptable content.',0
					; DATA XREF: .rdata:1002E59Co
aSsl_error_ille	db 'SSL_ERROR_ILLEGAL_PARAMETER_ALERT',0 ; DATA XREF: .rdata:1002E598o
		align 8
aSslPeerWasUn_0	db 'SSL peer was unable to negotiate an acceptable set of security pa'
					; DATA XREF: .rdata:1002E594o
		db 'rameters.',0
		align 4
aSsl_error_ha_0	db 'SSL_ERROR_HANDSHAKE_FAILURE_ALERT',0 ; DATA XREF: .rdata:1002E590o
		align 4
aSslPeerWasUn_1	db 'SSL peer was unable to successfully decompress an SSL record it r'
					; DATA XREF: .rdata:1002E58Co
		db 'eceived.',0
		align 4
aSsl_error_de_3	db 'SSL_ERROR_DECOMPRESSION_FAILURE_ALERT',0 ; DATA XREF: .rdata:1002E588o
		align 4
aSslPeerWasNotE	db 'SSL peer was not expecting a handshake message it received.',0
					; DATA XREF: .rdata:1002E584o
aSsl_error_ha_1	db 'SSL_ERROR_HANDSHAKE_UNEXPECTED_ALERT',0 ; DATA XREF: .rdata:1002E580o
		align 10h
aSslPeerHasClos	db 'SSL peer has closed this connection.',0 ; DATA XREF: .rdata:1002E57Co
		align 4
aSsl_error_clos	db 'SSL_ERROR_CLOSE_NOTIFY_ALERT',0 ; DATA XREF: .rdata:1002E578o
		align 4
aSslReceivedAnA	db 'SSL received an alert record with an unknown alert description.',0
					; DATA XREF: .rdata:1002E574o
aSsl_error_rx_4	db 'SSL_ERROR_RX_UNKNOWN_ALERT',0 ; DATA XREF: .rdata:1002E570o
		align 4
aSslReceivedAHa	db 'SSL received a handshake message with an unknown message type.',0
					; DATA XREF: .rdata:1002E56Co
		align 4
aSsl_error_rx_5	db 'SSL_ERROR_RX_UNKNOWN_HANDSHAKE',0 ; DATA XREF: .rdata:1002E568o
		align 4
aSslReceivedARe	db 'SSL received a record with an unknown content type.',0
					; DATA XREF: .rdata:1002E564o
aSsl_error_rx_6	db 'SSL_ERROR_RX_UNKNOWN_RECORD_TYPE',0 ; DATA XREF: .rdata:1002E560o
		align 4
aSslReceivedA_4	db 'SSL received an unexpected Application Data record.',0
					; DATA XREF: .rdata:1002E55Co
aSsl_error_rx_7	db 'SSL_ERROR_RX_UNEXPECTED_APPLICATION_DATA',0
					; DATA XREF: .rdata:1002E558o
		align 4
aSslReceivedA_5	db 'SSL received an unexpected Handshake record.',0
					; DATA XREF: .rdata:1002E554o
		align 4
aSsl_error_rx_8	db 'SSL_ERROR_RX_UNEXPECTED_HANDSHAKE',0 ; DATA XREF: .rdata:1002E550o
		align 10h
aSslReceivedA_6	db 'SSL received an unexpected Alert record.',0
					; DATA XREF: .rdata:1002E54Co
		align 4
aSsl_error_rx_9	db 'SSL_ERROR_RX_UNEXPECTED_ALERT',0 ; DATA XREF: .rdata:1002E548o
		align 4
aSslReceivedA_7	db 'SSL received an unexpected Change Cipher Spec record.',0
					; DATA XREF: .rdata:1002E544o
		align 4
aSsl_error_r_10	db 'SSL_ERROR_RX_UNEXPECTED_CHANGE_CIPHER',0 ; DATA XREF: .rdata:1002E540o
		align 4
aSslReceivedA_8	db 'SSL received an unexpected Finished handshake message.',0
					; DATA XREF: .rdata:1002E53Co
		align 4
aSsl_error_r_11	db 'SSL_ERROR_RX_UNEXPECTED_FINISHED',0 ; DATA XREF: .rdata:1002E538o
		align 4
aSslReceivedA_9	db 'SSL received an unexpected Client Key Exchange handshake message.'
					; DATA XREF: .rdata:1002E534o
		db 0
		align 4
aSsl_error_r_12	db 'SSL_ERROR_RX_UNEXPECTED_CLIENT_KEY_EXCH',0 ; DATA XREF: .rdata:1002E530o
		align 8
aSslReceived_10	db 'SSL received an unexpected Certificate Verify handshake message.',0
					; DATA XREF: .rdata:1002E52Co
		align 4
aSsl_error_r_13	db 'SSL_ERROR_RX_UNEXPECTED_CERT_VERIFY',0 ; DATA XREF: .rdata:1002E528o
aSslReceived_11	db 'SSL received an unexpected Server Hello Done handshake message.',0
					; DATA XREF: .rdata:1002E524o
aSsl_error_r_14	db 'SSL_ERROR_RX_UNEXPECTED_HELLO_DONE',0 ; DATA XREF: .rdata:1002E520o
		align 8
aSslReceived_12	db 'SSL received an unexpected Certificate Request handshake message.'
					; DATA XREF: .rdata:1002E51Co
		db 0
		align 4
aSsl_error_r_15	db 'SSL_ERROR_RX_UNEXPECTED_CERT_REQUEST',0 ; DATA XREF: .rdata:1002E518o
		align 8
aSslReceived_13	db 'SSL received an unexpected Server Key Exchange handshake message.'
					; DATA XREF: .rdata:1002E514o
		db 0
		align 4
aSsl_error_r_16	db 'SSL_ERROR_RX_UNEXPECTED_SERVER_KEY_EXCH',0 ; DATA XREF: .rdata:1002E510o
aSslReceived_14	db 'SSL received an unexpected Certificate handshake message.',0
					; DATA XREF: .rdata:1002E50Co
		align 10h
aSsl_error_r_17	db 'SSL_ERROR_RX_UNEXPECTED_CERTIFICATE',0 ; DATA XREF: .rdata:1002E508o
aSslReceived_15	db 'SSL received an unexpected Server Hello handshake message.',0
					; DATA XREF: .rdata:1002E504o
		align 10h
aSsl_error_r_18	db 'SSL_ERROR_RX_UNEXPECTED_SERVER_HELLO',0 ; DATA XREF: .rdata:1002E500o
		align 4
aSslReceived_16	db 'SSL received an unexpected Client Hello handshake message.',0
					; DATA XREF: .rdata:1002E4FCo
		align 4
aSsl_error_r_19	db 'SSL_ERROR_RX_UNEXPECTED_CLIENT_HELLO',0 ; DATA XREF: .rdata:1002E4F8o
		align 4
aSslReceived_17	db 'SSL received an unexpected Hello Request handshake message.',0
					; DATA XREF: .rdata:1002E4F4o
aSsl_error_r_20	db 'SSL_ERROR_RX_UNEXPECTED_HELLO_REQUEST',0 ; DATA XREF: .rdata:1002E4F0o
		align 10h
aSslReceived_18	db 'SSL received a malformed Application Data record.',0
					; DATA XREF: .rdata:1002E4ECo
		align 4
aSsl_error_r_21	db 'SSL_ERROR_RX_MALFORMED_APPLICATION_DATA',0 ; DATA XREF: .rdata:1002E4E8o
aSslReceived_19	db 'SSL received a malformed Handshake record.',0
					; DATA XREF: .rdata:1002E4E4o
		align 4
aSsl_error_r_22	db 'SSL_ERROR_RX_MALFORMED_HANDSHAKE',0 ; DATA XREF: .rdata:1002E4E0o
		align 4
aSslReceived_20	db 'SSL received a malformed Alert record.',0 ; DATA XREF: .rdata:1002E4DCo
		align 4
aSsl_error_r_23	db 'SSL_ERROR_RX_MALFORMED_ALERT',0 ; DATA XREF: .rdata:1002E4D8o
		align 4
aSslReceived_21	db 'SSL received a malformed Change Cipher Spec record.',0
					; DATA XREF: .rdata:1002E4D4o
aSsl_error_r_24	db 'SSL_ERROR_RX_MALFORMED_CHANGE_CIPHER',0 ; DATA XREF: .rdata:1002E4D0o
		align 10h
aSslReceived_22	db 'SSL received a malformed Finished handshake message.',0
					; DATA XREF: .rdata:1002E4CCo
		align 4
aSsl_error_r_25	db 'SSL_ERROR_RX_MALFORMED_FINISHED',0 ; DATA XREF: .rdata:1002E4C8o
aSslReceived_23	db 'SSL received a malformed Client Key Exchange handshake message.',0
					; DATA XREF: .rdata:1002E4C4o
aSsl_error_r_26	db 'SSL_ERROR_RX_MALFORMED_CLIENT_KEY_EXCH',0 ; DATA XREF: .rdata:1002E4C0o
		align 10h
aSslReceived_24	db 'SSL received a malformed Certificate Verify handshake message.',0
					; DATA XREF: .rdata:1002E4BCo
		align 10h
aSsl_error_r_27	db 'SSL_ERROR_RX_MALFORMED_CERT_VERIFY',0 ; DATA XREF: .rdata:1002E4B8o
		align 4
aSslReceived_25	db 'SSL received a malformed Server Hello Done handshake message.',0
					; DATA XREF: .rdata:1002E4B4o
		align 4
aSsl_error_r_28	db 'SSL_ERROR_RX_MALFORMED_HELLO_DONE',0 ; DATA XREF: .rdata:1002E4B0o
		align 4
aSslReceived_26	db 'SSL received a malformed Certificate Request handshake message.',0
					; DATA XREF: .rdata:1002E4ACo
aSsl_error_r_29	db 'SSL_ERROR_RX_MALFORMED_CERT_REQUEST',0 ; DATA XREF: .rdata:1002E4A8o
		align 10h
aSslReceived_27	db 'SSL received a malformed Server Key Exchange handshake message.',0
					; DATA XREF: .rdata:1002E4A4o
aSsl_error_r_30	db 'SSL_ERROR_RX_MALFORMED_SERVER_KEY_EXCH',0 ; DATA XREF: .rdata:1002E4A0o
		align 4
aSslReceived_28	db 'SSL received a malformed Certificate handshake message.',0
					; DATA XREF: .rdata:1002E49Co
aSsl_error_r_31	db 'SSL_ERROR_RX_MALFORMED_CERTIFICATE',0 ; DATA XREF: .rdata:1002E498o
		align 4
aSslReceived_29	db 'SSL received a malformed Server Hello handshake message.',0
					; DATA XREF: .rdata:1002E494o
		align 10h
aSsl_error_r_32	db 'SSL_ERROR_RX_MALFORMED_SERVER_HELLO',0 ; DATA XREF: .rdata:1002E490o
aSslReceived_30	db 'SSL received a malformed Client Hello handshake message.',0
					; DATA XREF: .rdata:1002E48Co
		align 10h
aSsl_error_r_33	db 'SSL_ERROR_RX_MALFORMED_CLIENT_HELLO',0 ; DATA XREF: .rdata:1002E488o
aSslReceived_31	db 'SSL received a malformed Hello Request handshake message.',0
					; DATA XREF: .rdata:1002E484o
		align 10h
aSsl_error_r_34	db 'SSL_ERROR_RX_MALFORMED_HELLO_REQUEST',0 ; DATA XREF: .rdata:1002E480o
		align 4
aSslAttemptedTo	db 'SSL attempted to send a record that exceeded the maximum permissi'
					; DATA XREF: .rdata:1002E47Co
		db 'ble length.',0
		align 4
aSsl_error_tx_r	db 'SSL_ERROR_TX_RECORD_TOO_LONG',0 ; DATA XREF: .rdata:1002E478o
		align 4
aSslReceived_32	db 'SSL received a record that exceeded the maximum permissible lengt'
					; DATA XREF: .rdata:1002E474o
		db 'h.',0
aSsl_error_rx_r	db 'SSL_ERROR_RX_RECORD_TOO_LONG',0 ; DATA XREF: .rdata:1002E470o
		align 4
aSslReceived_33	db 'SSL received a record with bad block padding.',0
					; DATA XREF: .rdata:1002E46Co
		align 4
aSsl_error_ba_2	db 'SSL_ERROR_BAD_BLOCK_PADDING',0 ; DATA XREF: .rdata:1002E468o
aNoCipherSuites	db 'No cipher suites are present and enabled in this program.',0
					; DATA XREF: .rdata:1002E464o
		align 4
aSsl_error_no_0	db 'SSL_ERROR_NO_CIPHERS_SUPPORTED',0 ; DATA XREF: .rdata:1002E460o
		align 4
aAnUnknownSslCi	db 'An unknown SSL cipher suite has been requested.',0
					; DATA XREF: .rdata:1002E45Co
aSsl_error_un_2	db 'SSL_ERROR_UNKNOWN_CIPHER_SUITE',0 ; DATA XREF: .rdata:1002E458o
		align 4
aCannotConnectS	db 'Cannot connect: SSL peer is in another FORTEZZA domain.',0
					; DATA XREF: .rdata:1002E454o
aSsl_error_fort	db 'SSL_ERROR_FORTEZZA_PQG',0 ; DATA XREF: .rdata:1002E450o
		align 4
aCannotConnec_0	db 'Cannot connect: SSL is disabled.',0 ; DATA XREF: .rdata:1002E44Co
		align 4
aSsl_error_ssl_	db 'SSL_ERROR_SSL_DISABLED',0 ; DATA XREF: .rdata:1002E448o
		align 10h
aSslPeerRejec_0	db 'SSL peer rejected your certificate as expired.',0
					; DATA XREF: .rdata:1002E444o
		align 10h
aSsl_error_expi	db 'SSL_ERROR_EXPIRED_CERT_ALERT',0 ; DATA XREF: .rdata:1002E440o
		align 10h
aSslPeerRejec_1	db 'SSL peer rejected your certificate as revoked.',0
					; DATA XREF: .rdata:1002E43Co
		align 10h
aSsl_error_revo	db 'SSL_ERROR_REVOKED_CERT_ALERT',0 ; DATA XREF: .rdata:1002E438o
		align 10h
aSslPeerCannotV	db 'SSL peer cannot verify your certificate.',0
					; DATA XREF: .rdata:1002E434o
		align 4
aSsl_error_ba_3	db 'SSL_ERROR_BAD_CERT_ALERT',0 ; DATA XREF: .rdata:1002E430o
		align 4
aSslPeerReports	db 'SSL peer reports incorrect Message Authentication Code.',0
					; DATA XREF: .rdata:1002E42Co
aSsl_error_ba_4	db 'SSL_ERROR_BAD_MAC_ALERT',0 ; DATA XREF: .rdata:1002E428o
aSslReceived_34	db 'SSL received a record with an incorrect Message Authentication Co'
					; DATA XREF: .rdata:1002E424o
		db 'de.',0
		align 10h
aSsl_error_ba_5	db 'SSL_ERROR_BAD_MAC_READ',0 ; DATA XREF: .rdata:1002E420o
		align 4
aPeerOnlySuppor	db 'Peer only supports SSL version 2, which is locally disabled.',0
					; DATA XREF: .rdata:1002E41Co
		align 4
aSsl_error_ssl2	db 'SSL_ERROR_SSL2_DISABLED',0 ; DATA XREF: .rdata:1002E418o
aSsl_error_post	db 'SSL_ERROR_POST_WARNING',0 ; DATA XREF: .rdata:1002E410o
		align 4
aUnableToCommun	db 'Unable to communicate securely with peer: requested domain name d'
					; DATA XREF: .rdata:1002E40Co
		db 'oes not match the server',27h,'s certificate.',0
		align 4
aSsl_error_ba_6	db 'SSL_ERROR_BAD_CERT_DOMAIN',0 ; DATA XREF: .rdata:1002E408o
		align 10h
aClientAuthenti	db 'Client authentication failed: private key in key database does no'
					; DATA XREF: .rdata:1002E404o
		db 't match public key in certificate database.',0
		align 10h
aSsl_error_wron	db 'SSL_ERROR_WRONG_CERTIFICATE',0 ; DATA XREF: .rdata:1002E400o
aSsl_error_unus	db 'SSL_ERROR_UNUSED_10',0 ; DATA XREF: .rdata:1002E3F8o
aPeerUsingUnsup	db 'Peer using unsupported version of security protocol.',0
					; DATA XREF: .rdata:1002E3F4o
		align 4
aSsl_error_un_3	db 'SSL_ERROR_UNSUPPORTED_VERSION',0 ; DATA XREF: .rdata:1002E3F0o
		align 4
aUnsupportedCer	db 'Unsupported certificate type.',0 ; DATA XREF: .rdata:1002E3ECo
		align 4
aSsl_error_un_4	db 'SSL_ERROR_UNSUPPORTED_CERTIFICATE_TYPE',0 ; DATA XREF: .rdata:1002E3E8o
		align 10h
aTheClientHasEn	db 'The client has encountered bad data from the server.',0
					; DATA XREF: .rdata:1002E3E4o
		align 4
aSsl_error_ba_7	db 'SSL_ERROR_BAD_SERVER',0 ; DATA XREF: .rdata:1002E3E0o
		align 10h
aTheServerHasEn	db 'The server has encountered bad data from the client.',0
					; DATA XREF: .rdata:1002E3DCo
		align 4
aSsl_error_ba_8	db 'SSL_ERROR_BAD_CLIENT',0 ; DATA XREF: .rdata:1002E3D8o
		align 10h
aUnrecognizedSs	db 'Unrecognized SSL error code.',0 ; DATA XREF: .rdata:1002E3D4o
					; .rdata:1002E3FCo ...
		align 10h
aSsl_error_un_5	db 'SSL_ERROR_UNUSED_5',0 ; DATA XREF: .rdata:1002E3D0o
		align 8
aUnableToComm_0	db 'Unable to communicate securely with peer: peers',27h,'s certificate '
					; DATA XREF: .rdata:1002E3CCo
		db 'was rejected.',0
aSsl_error_ba_9	db 'SSL_ERROR_BAD_CERTIFICATE',0 ; DATA XREF: .rdata:1002E3C8o
		align 10h
aUnableToFindTh	db 'Unable to find the certificate or key necessary for authenticatio'
					; DATA XREF: .rdata:1002E3C4o
		db 'n.',0
aSsl_error_no_1	db 'SSL_ERROR_NO_CERTIFICATE',0 ; DATA XREF: .rdata:1002E3C0o
		align 10h
aCannotCommun_0	db 'Cannot communicate securely with peer: no common encryption algor'
					; DATA XREF: .rdata:1002E3BCo
		db 'ithm(s).',0
		align 4
aSsl_error_no_2	db 'SSL_ERROR_NO_CYPHER_OVERLAP',0 ; DATA XREF: .rdata:1002E3B8o
aUnableToComm_1	db 'Unable to communicate securely.  Peer requires high-grade encrypt'
					; DATA XREF: .rdata:1002E3B4o
		db 'ion which is not supported.',0
		align 4
aSsl_error_us_o	db 'SSL_ERROR_US_ONLY_SERVER',0 ; DATA XREF: .rdata:1002E3B0o
		align 8
aUnableToComm_2	db 'Unable to communicate securely.  Peer does not support high-grade'
					; DATA XREF: .rdata:1002E3ACo
		db ' encryption.',0
		align 4
aSsl_error_expo	db 'SSL_ERROR_EXPORT_ONLY_SERVER',0 ; DATA XREF: .rdata:off_1002E3A8o
		align 4
off_1002E3A8	dd offset aSsl_error_expo ; DATA XREF: .rdata:off_1002E7D0o
					; "SSL_ERROR_EXPORT_ONLY_SERVER"
		dd offset aUnableToComm_2 ; "Unable to communicate securely.  Peer d"...
		dd offset aSsl_error_us_o ; "SSL_ERROR_US_ONLY_SERVER"
		dd offset aUnableToComm_1 ; "Unable to communicate securely.  Peer r"...
		dd offset aSsl_error_no_2 ; "SSL_ERROR_NO_CYPHER_OVERLAP"
		dd offset aCannotCommun_0 ; "Cannot communicate	securely with peer: "...
		dd offset aSsl_error_no_1 ; "SSL_ERROR_NO_CERTIFICATE"
		dd offset aUnableToFindTh ; "Unable to find the	certificate or key n"...
		dd offset aSsl_error_ba_9 ; "SSL_ERROR_BAD_CERTIFICATE"
		dd offset aUnableToComm_0 ; "Unable to communicate securely with pee"...
		dd offset aSsl_error_un_5 ; "SSL_ERROR_UNUSED_5"
		dd offset aUnrecognizedSs ; "Unrecognized SSL error code."
		dd offset aSsl_error_ba_8 ; "SSL_ERROR_BAD_CLIENT"
		dd offset aTheServerHasEn ; "The server	has encountered	bad data fro"...
		dd offset aSsl_error_ba_7 ; "SSL_ERROR_BAD_SERVER"
		dd offset aTheClientHasEn ; "The client	has encountered	bad data fro"...
		dd offset aSsl_error_un_4 ; "SSL_ERROR_UNSUPPORTED_CERTIFICATE_TYPE"
		dd offset aUnsupportedCer ; "Unsupported certificate type."
		dd offset aSsl_error_un_3 ; "SSL_ERROR_UNSUPPORTED_VERSION"
		dd offset aPeerUsingUnsup ; "Peer using	unsupported version of secur"...
		dd offset aSsl_error_unus ; "SSL_ERROR_UNUSED_10"
		dd offset aUnrecognizedSs ; "Unrecognized SSL error code."
		dd offset aSsl_error_wron ; "SSL_ERROR_WRONG_CERTIFICATE"
		dd offset aClientAuthenti ; "Client authentication failed: private k"...
		dd offset aSsl_error_ba_6 ; "SSL_ERROR_BAD_CERT_DOMAIN"
		dd offset aUnableToCommun ; "Unable to communicate securely with pee"...
		dd offset aSsl_error_post ; "SSL_ERROR_POST_WARNING"
		dd offset aUnrecognizedSs ; "Unrecognized SSL error code."
		dd offset aSsl_error_ssl2 ; "SSL_ERROR_SSL2_DISABLED"
		dd offset aPeerOnlySuppor ; "Peer only supports	SSL version 2, which"...
		dd offset aSsl_error_ba_5 ; "SSL_ERROR_BAD_MAC_READ"
		dd offset aSslReceived_34 ; "SSL received a record with	an incorrect"...
		dd offset aSsl_error_ba_4 ; "SSL_ERROR_BAD_MAC_ALERT"
		dd offset aSslPeerReports ; "SSL peer reports incorrect	Message	Auth"...
		dd offset aSsl_error_ba_3 ; "SSL_ERROR_BAD_CERT_ALERT"
		dd offset aSslPeerCannotV ; "SSL peer cannot verify your certificate"...
		dd offset aSsl_error_revo ; "SSL_ERROR_REVOKED_CERT_ALERT"
		dd offset aSslPeerRejec_1 ; "SSL peer rejected your certificate	as r"...
		dd offset aSsl_error_expi ; "SSL_ERROR_EXPIRED_CERT_ALERT"
		dd offset aSslPeerRejec_0 ; "SSL peer rejected your certificate	as e"...
		dd offset aSsl_error_ssl_ ; "SSL_ERROR_SSL_DISABLED"
		dd offset aCannotConnec_0 ; "Cannot connect: SSL is disabled."
		dd offset aSsl_error_fort ; "SSL_ERROR_FORTEZZA_PQG"
		dd offset aCannotConnectS ; "Cannot connect: SSL peer is in another "...
		dd offset aSsl_error_un_2 ; "SSL_ERROR_UNKNOWN_CIPHER_SUITE"
		dd offset aAnUnknownSslCi ; "An	unknown	SSL cipher suite has been re"...
		dd offset aSsl_error_no_0 ; "SSL_ERROR_NO_CIPHERS_SUPPORTED"
		dd offset aNoCipherSuites ; "No	cipher suites are present and enable"...
		dd offset aSsl_error_ba_2 ; "SSL_ERROR_BAD_BLOCK_PADDING"
		dd offset aSslReceived_33 ; "SSL received a record with	bad block pa"...
		dd offset aSsl_error_rx_r ; "SSL_ERROR_RX_RECORD_TOO_LONG"
		dd offset aSslReceived_32 ; "SSL received a record that	exceeded the"...
		dd offset aSsl_error_tx_r ; "SSL_ERROR_TX_RECORD_TOO_LONG"
		dd offset aSslAttemptedTo ; "SSL attempted to send a record that exc"...
		dd offset aSsl_error_r_34 ; "SSL_ERROR_RX_MALFORMED_HELLO_REQUEST"
		dd offset aSslReceived_31 ; "SSL received a malformed Hello Request "...
		dd offset aSsl_error_r_33 ; "SSL_ERROR_RX_MALFORMED_CLIENT_HELLO"
		dd offset aSslReceived_30 ; "SSL received a malformed Client Hello h"...
		dd offset aSsl_error_r_32 ; "SSL_ERROR_RX_MALFORMED_SERVER_HELLO"
		dd offset aSslReceived_29 ; "SSL received a malformed Server Hello h"...
		dd offset aSsl_error_r_31 ; "SSL_ERROR_RX_MALFORMED_CERTIFICATE"
		dd offset aSslReceived_28 ; "SSL received a malformed Certificate ha"...
		dd offset aSsl_error_r_30 ; "SSL_ERROR_RX_MALFORMED_SERVER_KEY_EXCH"
		dd offset aSslReceived_27 ; "SSL received a malformed Server Key Exc"...
		dd offset aSsl_error_r_29 ; "SSL_ERROR_RX_MALFORMED_CERT_REQUEST"
		dd offset aSslReceived_26 ; "SSL received a malformed Certificate Re"...
		dd offset aSsl_error_r_28 ; "SSL_ERROR_RX_MALFORMED_HELLO_DONE"
		dd offset aSslReceived_25 ; "SSL received a malformed Server Hello D"...
		dd offset aSsl_error_r_27 ; "SSL_ERROR_RX_MALFORMED_CERT_VERIFY"
		dd offset aSslReceived_24 ; "SSL received a malformed Certificate Ve"...
		dd offset aSsl_error_r_26 ; "SSL_ERROR_RX_MALFORMED_CLIENT_KEY_EXCH"
		dd offset aSslReceived_23 ; "SSL received a malformed Client Key Exc"...
		dd offset aSsl_error_r_25 ; "SSL_ERROR_RX_MALFORMED_FINISHED"
		dd offset aSslReceived_22 ; "SSL received a malformed Finished hands"...
		dd offset aSsl_error_r_24 ; "SSL_ERROR_RX_MALFORMED_CHANGE_CIPHER"
		dd offset aSslReceived_21 ; "SSL received a malformed Change Cipher "...
		dd offset aSsl_error_r_23 ; "SSL_ERROR_RX_MALFORMED_ALERT"
		dd offset aSslReceived_20 ; "SSL received a malformed Alert record."
		dd offset aSsl_error_r_22 ; "SSL_ERROR_RX_MALFORMED_HANDSHAKE"
		dd offset aSslReceived_19 ; "SSL received a malformed Handshake	reco"...
		dd offset aSsl_error_r_21 ; "SSL_ERROR_RX_MALFORMED_APPLICATION_DATA"
		dd offset aSslReceived_18 ; "SSL received a malformed Application Da"...
		dd offset aSsl_error_r_20 ; "SSL_ERROR_RX_UNEXPECTED_HELLO_REQUEST"
		dd offset aSslReceived_17 ; "SSL received an unexpected	Hello Reques"...
		dd offset aSsl_error_r_19 ; "SSL_ERROR_RX_UNEXPECTED_CLIENT_HELLO"
		dd offset aSslReceived_16 ; "SSL received an unexpected	Client Hello"...
		dd offset aSsl_error_r_18 ; "SSL_ERROR_RX_UNEXPECTED_SERVER_HELLO"
		dd offset aSslReceived_15 ; "SSL received an unexpected	Server Hello"...
		dd offset aSsl_error_r_17 ; "SSL_ERROR_RX_UNEXPECTED_CERTIFICATE"
		dd offset aSslReceived_14 ; "SSL received an unexpected	Certificate "...
		dd offset aSsl_error_r_16 ; "SSL_ERROR_RX_UNEXPECTED_SERVER_KEY_EXCH"
		dd offset aSslReceived_13 ; "SSL received an unexpected	Server Key E"...
		dd offset aSsl_error_r_15 ; "SSL_ERROR_RX_UNEXPECTED_CERT_REQUEST"
		dd offset aSslReceived_12 ; "SSL received an unexpected	Certificate "...
		dd offset aSsl_error_r_14 ; "SSL_ERROR_RX_UNEXPECTED_HELLO_DONE"
		dd offset aSslReceived_11 ; "SSL received an unexpected	Server Hello"...
		dd offset aSsl_error_r_13 ; "SSL_ERROR_RX_UNEXPECTED_CERT_VERIFY"
		dd offset aSslReceived_10 ; "SSL received an unexpected	Certificate "...
		dd offset aSsl_error_r_12 ; "SSL_ERROR_RX_UNEXPECTED_CLIENT_KEY_EXCH"
		dd offset aSslReceivedA_9 ; "SSL received an unexpected	Client Key E"...
		dd offset aSsl_error_r_11 ; "SSL_ERROR_RX_UNEXPECTED_FINISHED"
		dd offset aSslReceivedA_8 ; "SSL received an unexpected	Finished han"...
		dd offset aSsl_error_r_10 ; "SSL_ERROR_RX_UNEXPECTED_CHANGE_CIPHER"
		dd offset aSslReceivedA_7 ; "SSL received an unexpected	Change Ciphe"...
		dd offset aSsl_error_rx_9 ; "SSL_ERROR_RX_UNEXPECTED_ALERT"
		dd offset aSslReceivedA_6 ; "SSL received an unexpected	Alert record"...
		dd offset aSsl_error_rx_8 ; "SSL_ERROR_RX_UNEXPECTED_HANDSHAKE"
		dd offset aSslReceivedA_5 ; "SSL received an unexpected	Handshake re"...
		dd offset aSsl_error_rx_7 ; "SSL_ERROR_RX_UNEXPECTED_APPLICATION_DAT"...
		dd offset aSslReceivedA_4 ; "SSL received an unexpected	Application "...
		dd offset aSsl_error_rx_6 ; "SSL_ERROR_RX_UNKNOWN_RECORD_TYPE"
		dd offset aSslReceivedARe ; "SSL received a record with	an unknown c"...
		dd offset aSsl_error_rx_5 ; "SSL_ERROR_RX_UNKNOWN_HANDSHAKE"
		dd offset aSslReceivedAHa ; "SSL received a handshake message with a"...
		dd offset aSsl_error_rx_4 ; "SSL_ERROR_RX_UNKNOWN_ALERT"
		dd offset aSslReceivedAnA ; "SSL received an alert record with an un"...
		dd offset aSsl_error_clos ; "SSL_ERROR_CLOSE_NOTIFY_ALERT"
		dd offset aSslPeerHasClos ; "SSL peer has closed this connection."
		dd offset aSsl_error_ha_1 ; "SSL_ERROR_HANDSHAKE_UNEXPECTED_ALERT"
		dd offset aSslPeerWasNotE ; "SSL peer was not expecting	a handshake "...
		dd offset aSsl_error_de_3 ; "SSL_ERROR_DECOMPRESSION_FAILURE_ALERT"
		dd offset aSslPeerWasUn_1 ; "SSL peer was unable to successfully dec"...
		dd offset aSsl_error_ha_0 ; "SSL_ERROR_HANDSHAKE_FAILURE_ALERT"
		dd offset aSslPeerWasUn_0 ; "SSL peer was unable to negotiate an acc"...
		dd offset aSsl_error_ille ; "SSL_ERROR_ILLEGAL_PARAMETER_ALERT"
		dd offset aSslPeerRejecte ; "SSL peer rejected a handshake message f"...
		dd offset aSsl_error_un_1 ; "SSL_ERROR_UNSUPPORTED_CERT_ALERT"
		dd offset aSslPeerDoesN_0 ; "SSL peer does not support certificates "...
		dd offset aSsl_error_ce_1 ; "SSL_ERROR_CERTIFICATE_UNKNOWN_ALERT"
		dd offset aSslPeerHadSome ; "SSL peer had some unspecified issue wit"...
		dd offset aSsl_error_gene ; "SSL_ERROR_GENERATE_RANDOM_FAILURE"
		dd offset aSslExperienced ; "SSL experienced a failure of its random"...
		dd offset aSsl_error_sign ; "SSL_ERROR_SIGN_HASHES_FAILURE"
		dd offset aUnableToDigita ; "Unable to digitally sign data required "...
		dd offset aSsl_error_extr ; "SSL_ERROR_EXTRACT_PUBLIC_KEY_FAILURE"
		dd offset aSslWasUnableTo ; "SSL was unable to extract the public ke"...
		dd offset aSsl_error_se_1 ; "SSL_ERROR_SERVER_KEY_EXCHANGE_FAILURE"
		dd offset aUnspecifiedF_0 ; "Unspecified failure while processing SS"...
		dd offset aSsl_error_clie ; "SSL_ERROR_CLIENT_KEY_EXCHANGE_FAILURE"
		dd offset aUnspecifiedFai ; "Unspecified failure while processing SS"...
		dd offset aSsl_error_encr ; "SSL_ERROR_ENCRYPTION_FAILURE"
		dd offset aBulkDataEncryp ; "Bulk data encryption algorithm failed i"...
		dd offset aSsl_error_de_2 ; "SSL_ERROR_DECRYPTION_FAILURE"
		dd offset aBulkDataDecryp ; "Bulk data decryption algorithm failed i"...
		dd offset aSsl_error_sock ; "SSL_ERROR_SOCKET_WRITE_FAILURE"
		dd offset aAttemptToWrite ; "Attempt to	write encrypted	data to	unde"...
		dd offset aSsl_error_md5_ ; "SSL_ERROR_MD5_DIGEST_FAILURE"
		dd offset aMd5DigestFunct ; "MD5 digest	function failed."
		dd offset aSsl_error_sha_ ; "SSL_ERROR_SHA_DIGEST_FAILURE"
		dd offset aSha1DigestFunc ; "SHA-1 digest function failed."
		dd offset aSsl_error_mac_ ; "SSL_ERROR_MAC_COMPUTATION_FAILURE"
		dd offset aMacComputation ; "MAC computation failed."
		dd offset aSsl_error_sy_0 ; "SSL_ERROR_SYM_KEY_CONTEXT_FAILURE"
		dd offset aFailureToCreat ; "Failure to	create Symmetric Key context"...
		dd offset aSsl_error_sym_ ; "SSL_ERROR_SYM_KEY_UNWRAP_FAILURE"
		dd offset aFailureToUnwra ; "Failure to	unwrap the Symmetric key in "...
		dd offset aSsl_error_pub_ ; "SSL_ERROR_PUB_KEY_SIZE_LIMIT_EXCEEDED"
		dd offset aSslServerAttem ; "SSL Server	attempted to use domestic-gr"...
		dd offset aSsl_error_iv_p ; "SSL_ERROR_IV_PARAM_FAILURE"
		dd offset aPkcs11CodeFail ; "PKCS11 code failed	to translate an	IV i"...
		dd offset aSsl_error_init ; "SSL_ERROR_INIT_CIPHER_SUITE_FAILURE"
		dd offset aFailedToInitia ; "Failed to initialize the selected ciphe"...
		dd offset aSsl_error_se_0 ; "SSL_ERROR_SESSION_KEY_GEN_FAILURE"
		dd offset aClientFailedTo ; "Client failed to generate session keys "...
		dd offset aSsl_error_no_s ; "SSL_ERROR_NO_SERVER_KEY_FOR_ALG"
		dd offset aServerHasNoKey ; "Server has	no key for the attempted key"...
		dd offset aSsl_error_to_0 ; "SSL_ERROR_TOKEN_INSERTION_REMOVAL"
		dd offset aPkcs11TokenWas ; "PKCS#11 token was inserted	or removed w"...
		dd offset aSsl_error_toke ; "SSL_ERROR_TOKEN_SLOT_NOT_FOUND"
		dd offset aNoPkcs11TokenC ; "No	PKCS#11	token could be found to	do a"...
		dd offset aSsl_error_no_c ; "SSL_ERROR_NO_COMPRESSION_OVERLAP"
		dd offset aCannotCommunic ; "Cannot communicate	securely with peer: "...
		dd offset aSsl_error_hand ; "SSL_ERROR_HANDSHAKE_NOT_COMPLETED"
		dd offset aCannotPerformT ; "Cannot perform the	operation until	the "...
		dd offset aSsl_error_ba_1 ; "SSL_ERROR_BAD_HANDSHAKE_HASH_VALUE"
		dd offset aReceivedIncorr ; "Received incorrect	handshakes hash	valu"...
		dd offset aSsl_error_ce_0 ; "SSL_ERROR_CERT_KEA_MISMATCH"
		dd offset aTheCertificate ; "The certificate provided cannot be	used"...
		dd offset aSsl_error_no_t ; "SSL_ERROR_NO_TRUSTED_SSL_CLIENT_CA"
		dd offset aNoCertificateA ; "No	certificate authority is trusted for"...
		dd offset aSsl_error_sess ; "SSL_ERROR_SESSION_NOT_FOUND"
		dd offset aClientSSslSess ; "Client's SSL session ID not found in se"...
		dd offset aSsl_error_de_1 ; "SSL_ERROR_DECRYPTION_FAILED_ALERT"
		dd offset aPeerWasUnableT ; "Peer was unable to	decrypt	an SSL recor"...
		dd offset aSsl_error_reco ; "SSL_ERROR_RECORD_OVERFLOW_ALERT"
		dd offset aPeerReceivedAn ; "Peer received an SSL record that was lo"...
		dd offset aSsl_error_unkn ; "SSL_ERROR_UNKNOWN_CA_ALERT"
		dd offset aPeerDoesNotRec ; "Peer does not recognize and trust the C"...
		dd offset aSsl_error_acce ; "SSL_ERROR_ACCESS_DENIED_ALERT"
		dd offset aPeerReceivedAV ; "Peer received a valid certificate,	but "...
		dd offset aSsl_error_de_0 ; "SSL_ERROR_DECODE_ERROR_ALERT"
		dd offset aPeerCouldNotDe ; "Peer could	not decode an SSL handshake "...
		dd offset aSsl_error_decr ; "SSL_ERROR_DECRYPT_ERROR_ALERT"
		dd offset aPeerReportsFai ; "Peer reports failure of signature verif"...
		dd offset aSsl_error_ex_0 ; "SSL_ERROR_EXPORT_RESTRICTION_ALERT"
		dd offset aPeerReportsNeg ; "Peer reports negotiation not in complia"...
		dd offset aSsl_error_prot ; "SSL_ERROR_PROTOCOL_VERSION_ALERT"
		dd offset aPeerReportsInc ; "Peer reports incompatible or unsupporte"...
		dd offset aSsl_error_insu ; "SSL_ERROR_INSUFFICIENT_SECURITY_ALERT"
		dd offset aServerRequires ; "Server requires ciphers more secure tha"...
		dd offset aSsl_error_inte ; "SSL_ERROR_INTERNAL_ERROR_ALERT"
		dd offset aPeerReportsItE ; "Peer reports it experienced an internal"...
		dd offset aSsl_error_user ; "SSL_ERROR_USER_CANCELED_ALERT"
		dd offset aPeerUserCancel ; "Peer user canceled	handshake."
		dd offset aSsl_error_no_r ; "SSL_ERROR_NO_RENEGOTIATION_ALERT"
		dd offset aPeerDoesNotPer ; "Peer does not permit renegotiation	of S"...
		dd offset aSsl_error_serv ; "SSL_ERROR_SERVER_CACHE_NOT_CONFIGURED"
		dd offset aSslServerCache ; "SSL server	cache not configured and not"...
		dd offset aSsl_error_un_0 ; "SSL_ERROR_UNSUPPORTED_EXTENSION_ALERT"
		dd offset aSslPeerDoesNot ; "SSL peer does not support requested TLS"...
		dd offset aSsl_error_cert ; "SSL_ERROR_CERTIFICATE_UNOBTAINABLE_ALER"...
		dd offset aSslPeerCouldNo ; "SSL peer could not	obtain your certific"...
		dd offset aSsl_error_unre ; "SSL_ERROR_UNRECOGNIZED_NAME_ALERT"
		dd offset aSslPeerHasNoCe ; "SSL peer has no certificate for the req"...
		dd offset aSsl_error_ba_0 ; "SSL_ERROR_BAD_CERT_STATUS_RESPONSE_ALER"...
		dd offset aSslPeerWasUnab ; "SSL peer was unable to get	an OCSP	resp"...
		dd offset aSsl_error_bad_ ; "SSL_ERROR_BAD_CERT_HASH_VALUE_ALERT"
		dd offset aSslPeerReporte ; "SSL peer reported bad certificate hash "...
		dd offset aSsl_error_rx_3 ; "SSL_ERROR_RX_UNEXPECTED_NEW_SESSION_TIC"...
		dd offset aSslReceivedA_3 ; "SSL received an unexpected	New Session "...
		dd offset aSsl_error_rx_2 ; "SSL_ERROR_RX_MALFORMED_NEW_SESSION_TICK"...
		dd offset aSslReceivedA_2 ; "SSL received a malformed New Session Ti"...
		dd offset aSsl_error_deco ; "SSL_ERROR_DECOMPRESSION_FAILURE"
		dd offset aSslReceivedACo ; "SSL received a compressed record that c"...
		dd offset aSsl_error_rene ; "SSL_ERROR_RENEGOTIATION_NOT_ALLOWED"
		dd offset aRenegotiationI ; "Renegotiation is not allowed on this SS"...
		dd offset aSsl_error_unsa ; "SSL_ERROR_UNSAFE_NEGOTIATION"
		dd offset aPeerAttemptedO ; "Peer attempted old	style (potentially v"...
		dd offset aSsl_error_rx_1 ; "SSL_ERROR_RX_UNEXPECTED_UNCOMPRESSED_RE"...
		dd offset aSslReceivedA_1 ; "SSL received an unexpected	uncompressed"...
		dd offset aSsl_error_weak ; "SSL_ERROR_WEAK_SERVER_EPHEMERAL_DH_KEY"
		dd offset aSslReceivedAWe ; "SSL received a weak ephemeral Diffie-He"...
		dd offset aSsl_error_ne_1 ; "SSL_ERROR_NEXT_PROTOCOL_DATA_INVALID"
		dd offset aSslReceivedInv ; "SSL received invalid NPN extension	data"...
		dd offset aSsl_error_fe_2 ; "SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_SSL"...
		dd offset aSslFeatureNo_2 ; "SSL feature not supported for SSL 2.0 c"...
		dd offset aSsl_error_fe_1 ; "SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_SER"...
		dd offset aSslFeatureNo_1 ; "SSL feature not supported for servers."
		dd offset aSsl_error_fe_0 ; "SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_CLI"...
		dd offset aSslFeatureNo_0 ; "SSL feature not supported for clients."
		dd offset aSsl_error_inva ; "SSL_ERROR_INVALID_VERSION_RANGE"
		dd offset aSslVersionRang ; "SSL version range is not valid."
		dd offset aSsl_error_ciph ; "SSL_ERROR_CIPHER_DISALLOWED_FOR_VERSION"
		dd offset aSslPeerSelecte ; "SSL peer selected a cipher	suite disall"...
		dd offset aSsl_error_rx_m ; "SSL_ERROR_RX_MALFORMED_HELLO_VERIFY_REQ"...
		dd offset aSslReceivedAMa ; "SSL received a malformed Hello Verify R"...
		dd offset aSsl_error_rx_0 ; "SSL_ERROR_RX_UNEXPECTED_HELLO_VERIFY_RE"...
		dd offset aSslReceivedA_0 ; "SSL received an unexpected	Hello Verify"...
		dd offset aSsl_error_feat ; "SSL_ERROR_FEATURE_NOT_SUPPORTED_FOR_VER"...
		dd offset aSslFeatureNotS ; "SSL feature not supported for the proto"...
		dd offset aSsl_error_rx_u ; "SSL_ERROR_RX_UNEXPECTED_CERT_STATUS"
		dd offset aSslReceivedAnU ; "SSL received an unexpected	Certificate "...
		dd offset aSsl_error_unsu ; "SSL_ERROR_UNSUPPORTED_HASH_ALGORITHM"
		dd offset aUnsupportedHas ; "Unsupported hash algorithm	used by	TLS "...
		dd offset aSsl_error_dige ; "SSL_ERROR_DIGEST_FAILURE"
		dd offset aDigestFunction ; "Digest function failed."
		dd offset aSsl_error_inco ; "SSL_ERROR_INCORRECT_SIGNATURE_ALGORITHM"
		dd offset aIncorrectSigna ; "Incorrect signature algorithm specified"...
		dd offset aSsl_error_ne_0 ; "SSL_ERROR_NEXT_PROTOCOL_NO_CALLBACK"
		dd offset aTheNextProtoco ; "The next protocol negotiation extension"...
		dd offset aSsl_error_next ; "SSL_ERROR_NEXT_PROTOCOL_NO_PROTOCOL"
		dd offset aTheServerSuppo ; "The server	supports no protocols that t"...
		dd offset aSsl_error_inap ; "SSL_ERROR_INAPPROPRIATE_FALLBACK_ALERT"
		dd offset aTheServerRejec ; "The server	rejected the handshake becau"...
		align 10h
off_1002E7D0	dd offset off_1002E3A8	; DATA XREF: .text:loc_10014820o
		dd offset SSL_NumImplementedCiphers+4
		dd 0FFFFD000h, 85h
dword_1002E7E0	dd 0			; DATA XREF: sub_10016190+11o
		dd offset sub_10014C80
		dd 0Ah
		dd offset sub_10021B10
		dd 0Bh
		dd offset sub_10021A90
		dd 23h
		dd offset sub_10016CD0
		dd 0FF01h
		dd offset sub_10016460
		dd 3374h
		dd offset sub_10014FC0
		dd 10h
		dd offset sub_10016C30
		dd 0Eh
		dd offset sub_10016680
		dd 5
		dd offset sub_10016420
		dd 0Dh
		dd offset sub_100168B0
		dd 0FF02h
		dd offset sub_10016BD0
		dd 0FFFFFFFFh, 0
dword_1002E840	dd 0			; DATA XREF: sub_10016190+20o
		dd offset sub_10014C80
		dd 23h
		dd offset sub_100155B0
		dd 0FF01h
		dd offset sub_10016460
		dd 3374h
		dd offset sub_100151E0
		dd 10h
		dd offset sub_10015260
		dd 0Eh
		dd offset sub_10016680
		dd 5
		dd offset sub_100155B0
		dd 0FFFFFFFFh, 0
dword_1002E880	dd 0FF01h		; DATA XREF: sub_10016190+2Eo
		dd offset sub_10016460
		dd 0FFFFFFFFh, 0
dword_1002E890	dd 0			; DATA XREF: sub_100162F0+20o
		dd offset sub_10014AF0
		dd 0FF01h
		dd offset sub_10016360
		dd 0Ah
		dd offset sub_10021930
		dd 0Bh
		dd offset sub_10021A20
		dd 23h
		dd offset sub_10014E90
		dd 3374h
		dd offset sub_10015370
		dd 10h
		dd offset sub_10015400
		dd 0Eh
		dd offset sub_10016510
		dd 5
		dd offset sub_10015650
		dd 0Dh
		dd offset sub_10016A00
		dd 0FF02h
		dd offset sub_10016B40
dword_1002E8E8	dd 0FF01h		; DATA XREF: sub_100162F0+27o
		dd offset sub_10016360
		dd 14h dup(0)
dword_1002E940	dd 1050104h, 3040102h, 3020305h, 2020204h ; DATA XREF: sub_10016A00+48o
dword_1002E950	dd 2153534Eh		; DATA XREF: sub_10014900+18r
					; .text:loc_10014A10r
byte_1002E954	db 0			; DATA XREF: sub_10014900+29r
					; .text:10014A15r
		align 4
dword_1002E958	dd 0			; DATA XREF: sub_10014AF0+BDo
dword_1002E95C	dd 0			; DATA XREF: .text:loc_10018CDCr
dword_1002E960	dd 0			; DATA XREF: .text:10018CE1r
dword_1002E964	dd 0			; DATA XREF: .text:10018CE7r
; char VarName[]
VarName		db 'SSL_INHERITANCE',0  ; DATA XREF: sub_1001B550+102o
					; sub_1001B760+90o
aSSvrcache_D_X_	db '%s/svrcache_%d_%x.ssl',0 ; DATA XREF: sub_1001B0B0+25Bo
		align 10h
aTemp		db '\temp',0            ; DATA XREF: sub_1001B480+1Bo
		align 4
aSS		db '%s,%s',0            ; DATA XREF: sub_1001B550+D6o
		align 10h
dword_1002E9A0	dd 0			; DATA XREF: sub_1001C550+5r
dword_1002E9A4	dd 0			; DATA XREF: sub_1001C550+Ar
dword_1002E9A8	dd 0			; DATA XREF: sub_1001C550+10r
off_1002E9AC	dd offset sub_10014460	; DATA XREF: sub_1001C530+Bo
					; sub_1001EB40+1A1o
		dd 0
		dd offset sub_10014490
		dd offset sub_100144B0
		dd offset sub_100144D0
		dd offset sub_10014750
		dd offset sub_100144F0
		dd offset sub_10014560
		dd offset sub_10014620
		dd offset sub_10014670
		dd offset sub_10014710
		dd offset sub_10014730
off_1002E9DC	dd offset sub_10019390	; DATA XREF: sub_1001C530+4o
					; sub_1001EB40+19Ao
		dd 0
		dd offset sub_10014490
		dd offset sub_100144B0
		dd offset sub_10019470
		dd offset sub_10019410
		dd offset sub_10019E10
		dd offset sub_10019F80
		dd offset sub_10019F60
		dd offset sub_1001A160
		dd offset sub_10014710
		dd offset sub_10014730
dword_1002EA0C	dd 20001h, 2 dup(0)	; DATA XREF: SSL_SetSRTPCiphers+74o
		dd 4
off_1002EA1C	dd offset sub_1001DA00	; DATA XREF: sub_1001E6F0+10r
off_1002EA20	dd offset sub_1001DBB0	; DATA XREF: sub_1001E6F0+21r
off_1002EA24	dd offset sub_1001DC40	; DATA XREF: sub_1001E6F0+8r
off_1002EA28	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+2Cr
off_1002EA2C	dd offset sub_1001E6D0	; DATA XREF: sub_1001E6F0+37r
off_1002EA30	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+43r
off_1002EA34	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+4Er
off_1002EA38	dd offset sub_1001E6D0	; DATA XREF: sub_1001E6F0+59r
off_1002EA3C	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+65r
off_1002EA40	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+70r
off_1002EA44	dd offset sub_1001E250	; DATA XREF: sub_1001E6F0+7Br
off_1002EA48	dd offset sub_1001D740	; DATA XREF: sub_1001E6F0+87r
off_1002EA4C	dd offset sub_1001FF60	; DATA XREF: sub_1001E6F0+92r
off_1002EA50	dd offset sub_1001D7F0	; DATA XREF: sub_1001E6F0+9Dr
off_1002EA54	dd offset sub_1001D890	; DATA XREF: sub_1001E6F0+A9r
off_1002EA58	dd offset sub_1001D930	; DATA XREF: sub_1001E6F0+B4r
off_1002EA5C	dd offset sub_1001DA70	; DATA XREF: sub_1001E6F0+BFr
off_1002EA60	dd offset sub_1001DB10	; DATA XREF: sub_1001E6F0+CBr
off_1002EA64	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+D6r
off_1002EA68	dd offset sub_1001E6B0	; DATA XREF: sub_1001E6F0+E1r
off_1002EA6C	dd offset sub_1001DF80	; DATA XREF: sub_1001E6F0+EDr
off_1002EA70	dd offset PR_EmulateAcceptRead ; DATA XREF: sub_1001E6F0+F8r
off_1002EA74	dd offset sub_1001E1A0	; DATA XREF: sub_1001E6F0+103r
off_1002EA78	dd offset sub_1001DE20	; DATA XREF: sub_1001E6F0+10Fr
off_1002EA7C	dd offset sub_1001DCD0	; DATA XREF: sub_1001E6F0+11Ar
		dd 4 dup(0)
off_1002EA90	dd offset PR_EmulateSendFile ; DATA XREF: sub_1001E6F0+125r
		dd 5 dup(0)
dword_1002EAA8	dd 4C5353h		; DATA XREF: .text:loc_1001E840o
; char aNss_ssl_cbc_ra[]
aNss_ssl_cbc_ra	db 'NSS_SSL_CBC_RANDOM_IV',0 ; DATA XREF: sub_1001E990:loc_1001EB14o
		align 4
; char aNss_ssl_requir[]
aNss_ssl_requir	db 'NSS_SSL_REQUIRE_SAFE_NEGOTIATION',0
					; DATA XREF: sub_1001E990:loc_1001EAF7o
		align 4
; char aNss_ssl_enable[]
aNss_ssl_enable	db 'NSS_SSL_ENABLE_RENEGOTIATION',0 ; DATA XREF: sub_1001E990:loc_1001EA78o
		align 4
dword_1002EB08	dd 43524F46h		; DATA XREF: sub_1001E990+B0r
dword_1002EB0C	dd 202E4445h		; DATA XREF: sub_1001E990+B6r
word_1002EB10	dw 20h			; DATA XREF: sub_1001E990+BBr
		align 4
; char aSslforcelocks[]
aSslforcelocks	db 'SSLFORCELOCKS',0    ; DATA XREF: sub_1001E990:loc_1001EA2Do
		align 4
; char aSslbypass[]
aSslbypass	db 'SSLBYPASS',0        ; DATA XREF: sub_1001E990:loc_1001E9FBo
		align 10h
; char aSslTlsSecretsL[]
aSslTlsSecretsL	db '# SSL/TLS secrets log file, generated by NSS',0Ah,0
					; DATA XREF: sub_1001E990+5Do
		align 10h
; char Mode[]
Mode		db 'a',0                ; DATA XREF: sub_1001E990+31o
		align 4
; char aSslkeylogfile[]
aSslkeylogfile	db 'SSLKEYLOGFILE',0    ; DATA XREF: sub_1001E990+14o
		align 4
dword_1002EB74	dd 41534944h		; DATA XREF: SSL_OptionSet+377r
					; SSL_OptionSetDefault+2A1r
dword_1002EB78	dd 44454C42h		; DATA XREF: SSL_OptionSet+37Dr
					; SSL_OptionSetDefault+2A6r
word_1002EB7C	dw 2Eh			; DATA XREF: SSL_OptionSet+383r
					; SSL_OptionSetDefault+2ACr
		align 10h
byte_1002EB80	db 24h			; DATA XREF: NSSSSL_VersionCheck+8r
aHeaderNss3_17_	db 'Header: NSS 3.17.1 Basic ECC  Sep 27 2014 21:03:50 $',0
		align 4
byte_1002EBB8	db 40h			; DATA XREF: NSSSSL_VersionCheck+1r
aNss3_17_1Basic	db '(#)NSS 3.17.1 Basic ECC  Sep 27 2014 21:03:50',0
		align 4
aSsl_ck_rc2_128	db 'SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5',0 ; DATA XREF: .rdata:100303B4o
		align 10h
aSsl_ck_rc4_128	db 'SSL_CK_RC4_128_EXPORT40_WITH_MD5',0 ; DATA XREF: .rdata:1003037Co
		align 4
aSsl_ck_des_64_	db 'SSL_CK_DES_64_CBC_WITH_MD5',0 ; DATA XREF: .rdata:10030344o
		align 10h
aSsl_ck_des_192	db 'SSL_CK_DES_192_EDE3_CBC_WITH_MD5',0 ; DATA XREF: .rdata:1003030Co
		align 4
aSsl_ck_rc2_1_0	db 'SSL_CK_RC2_128_CBC_WITH_MD5',0 ; DATA XREF: .rdata:100302D4o
aSsl_ck_rc4_1_0	db 'SSL_CK_RC4_128_WITH_MD5',0 ; DATA XREF: .rdata:1003029Co
aTls_ecdhe_rsa_	db 'TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:10030264o
		align 4
aTls_ecdhe_rs_0	db 'TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256',0 ; DATA XREF: .rdata:1003022Co
		align 4
aTls_ecdhe_rs_1	db 'TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:100301F4o
		align 4
aTls_ecdhe_rs_2	db 'TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:100301BCo
aTls_ecdhe_rs_3	db 'TLS_ECDHE_RSA_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:10030184o
		align 4
aTls_ecdhe_rs_4	db 'TLS_ECDHE_RSA_WITH_NULL_SHA',0 ; DATA XREF: .rdata:1003014Co
aTls_ecdh_rsa_w	db 'TLS_ECDH_RSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:10030114o
		align 4
aTls_ecdh_rsa_0	db 'TLS_ECDH_RSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:100300DCo
		align 10h
aTls_ecdh_rsa_1	db 'TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:100300A4o
		align 4
aTls_ecdh_rsa_2	db 'TLS_ECDH_RSA_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:1003006Co
		align 4
aTls_ecdh_rsa_3	db 'TLS_ECDH_RSA_WITH_NULL_SHA',0 ; DATA XREF: .rdata:10030034o
		align 10h
aTls_ecdhe_ecds	db 'TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:1002FFFCo
		align 4
aTls_ecdhe_ec_0	db 'TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256',0 ; DATA XREF: .rdata:1002FFC4o
aTls_ecdhe_ec_1	db 'TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:1002FF8Co
		align 4
aTls_ecdhe_ec_2	db 'TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FF54o
		align 10h
aTls_ecdhe_ec_3	db 'TLS_ECDHE_ECDSA_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:1002FF1Co
		align 4
aTls_ecdhe_ec_4	db 'TLS_ECDHE_ECDSA_WITH_NULL_SHA',0 ; DATA XREF: .rdata:1002FEE4o
		align 4
aTls_ecdh_ecdsa	db 'TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:1002FEACo
aTls_ecdh_ecd_0	db 'TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:1002FE74o
aTls_ecdh_ecd_1	db 'TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FE3Co
		align 4
aTls_ecdh_ecd_2	db 'TLS_ECDH_ECDSA_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:1002FE04o
aEcdh		db 'ECDH',0             ; DATA XREF: .rdata:1002FDD8o
					; .rdata:1002FE10o ...
		align 4
aTls_ecdh_ecd_3	db 'TLS_ECDH_ECDSA_WITH_NULL_SHA',0 ; DATA XREF: .rdata:1002FDCCo
		align 4
aEcdsa		db 'ECDSA',0            ; DATA XREF: .rdata:1002FD98o
					; .rdata:1002FDD0o ...
		align 4
aTls_ecdhe_ec_5	db 'TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256',0 ; DATA XREF: .rdata:1002FD94o
aTls_ecdhe_rs_5	db 'TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256',0 ; DATA XREF: .rdata:1002FD5Co
		align 4
aTls_rsa_with_n	db 'TLS_RSA_WITH_NULL_MD5',0 ; DATA XREF: .rdata:1002FD24o
		align 4
aTls_rsa_with_0	db 'TLS_RSA_WITH_NULL_SHA',0 ; DATA XREF: .rdata:1002FCECo
		align 4
aTls_rsa_with_1	db 'TLS_RSA_WITH_NULL_SHA256',0 ; DATA XREF: .rdata:1002FCB4o
		align 10h
aRc2		db 'RC2',0              ; DATA XREF: .rdata:1002FC90o
					; .rdata:100302E8o ...
aTls_rsa_export	db 'TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5',0 ; DATA XREF: .rdata:1002FC7Co
		align 4
aTls_rsa_expo_0	db 'TLS_RSA_EXPORT_WITH_RC4_40_MD5',0 ; DATA XREF: .rdata:1002FC44o
		align 4
aTls_rsa_expo_1	db 'TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA',0 ; DATA XREF: .rdata:1002FC0Co
aTls_rsa_expo_2	db 'TLS_RSA_EXPORT1024_WITH_RC4_56_SHA',0 ; DATA XREF: .rdata:1002FBD4o
		align 10h
aTls_rsa_with_d	db 'TLS_RSA_WITH_DES_CBC_SHA',0 ; DATA XREF: .rdata:1002FB9Co
		align 4
aSsl_rsa_fips_w	db 'SSL_RSA_FIPS_WITH_DES_CBC_SHA',0 ; DATA XREF: .rdata:1002FB64o
		align 4
aTls_dhe_dss_wi	db 'TLS_DHE_DSS_WITH_DES_CBC_SHA',0 ; DATA XREF: .rdata:1002FB2Co
		align 4
aTls_dhe_rsa_wi	db 'TLS_DHE_RSA_WITH_DES_CBC_SHA',0 ; DATA XREF: .rdata:1002FAF4o
		align 4
aTls_rsa_with_3	db 'TLS_RSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FABCo
		align 4
aSsl_rsa_fips_0	db 'SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FA84o
		align 10h
aTls_dhe_dss__0	db 'TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FA4Co
		align 4
a3des		db '3DES',0             ; DATA XREF: .rdata:1002FA28o
					; .rdata:1002FA60o ...
		align 4
aTls_dhe_rsa__0	db 'TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA',0 ; DATA XREF: .rdata:1002FA14o
		align 10h
aTls_rsa_with_a	db 'TLS_RSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F9DCo
		align 10h
aTls_rsa_with_2	db 'TLS_RSA_WITH_AES_128_CBC_SHA256',0 ; DATA XREF: .rdata:1002F9A4o
aMd5		db 'MD5',0              ; DATA XREF: .rdata:1002F990o
					; .rdata:1002FC68o ...
aTls_rsa_with_r	db 'TLS_RSA_WITH_RC4_128_MD5',0 ; DATA XREF: .rdata:1002F96Co
		align 10h
aTls_rsa_with_4	db 'TLS_RSA_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:1002F934o
		align 4
aTls_rsa_with_c	db 'TLS_RSA_WITH_CAMELLIA_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F8FCo
		align 10h
aSeed		db 'SEED',0             ; DATA XREF: .rdata:1002F8D8o
		align 4
aTls_rsa_with_s	db 'TLS_RSA_WITH_SEED_CBC_SHA',0 ; DATA XREF: .rdata:1002F8C4o
		align 4
aTls_dhe_dss__1	db 'TLS_DHE_DSS_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F88Co
		align 4
aTls_dhe_rsa__1	db 'TLS_DHE_RSA_WITH_AES_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F854o
		align 4
aTls_dhe_rsa__2	db 'TLS_DHE_RSA_WITH_AES_128_GCM_SHA256',0 ; DATA XREF: .rdata:1002F81Co
aTls_dhe_rsa__3	db 'TLS_DHE_RSA_WITH_AES_128_CBC_SHA256',0 ; DATA XREF: .rdata:1002F7E4o
aTls_dhe_dss__2	db 'TLS_DHE_DSS_WITH_RC4_128_SHA',0 ; DATA XREF: .rdata:1002F7ACo
		align 4
aTls_dhe_dss__3	db 'TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F774o
		align 4
aTls_dhe_rsa__4	db 'TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA',0 ; DATA XREF: .rdata:1002F73Co
		align 4
aTls_rsa_with_5	db 'TLS_RSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F704o
		align 4
aTls_rsa_with_6	db 'TLS_RSA_WITH_AES_256_CBC_SHA256',0 ; DATA XREF: .rdata:1002F6CCo
aTls_rsa_with_7	db 'TLS_RSA_WITH_CAMELLIA_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F694o
		align 4
aTls_dhe_dss__4	db 'TLS_DHE_DSS_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F65Co
		align 4
aTls_dhe_rsa__5	db 'TLS_DHE_RSA_WITH_AES_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F624o
		align 10h
aSha256		db 'SHA256',0           ; DATA XREF: .rdata:1002F610o
					; .rdata:1002F6F0o ...
		align 4
aAes		db 'AES',0              ; DATA XREF: .rdata:1002F600o
					; .rdata:1002F638o ...
aTls_dhe_rsa__6	db 'TLS_DHE_RSA_WITH_AES_256_CBC_SHA256',0 ; DATA XREF: .rdata:1002F5ECo
aDsa		db 'DSA',0              ; DATA XREF: .rdata:1002F5B8o
					; .rdata:1002F660o ...
aTls_dhe_dss__5	db 'TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F5B4o
		align 4
aSha1		db 'SHA1',0             ; DATA XREF: .rdata:1002F5A0o
					; .rdata:1002F5D8o ...
		align 4
aCamellia	db 'CAMELLIA',0         ; DATA XREF: .rdata:1002F590o
					; .rdata:1002F5C8o ...
		align 10h
aDhe		db 'DHE',0              ; DATA XREF: .rdata:1002F588o
					; .rdata:1002F5C0o ...
aTls_dhe_rsa__7	db 'TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA',0 ; DATA XREF: .rdata:1002F57Co
		align 4
aAead		db 'AEAD',0             ; DATA XREF: .rdata:1002F568o
					; .rdata:1002F840o ...
		align 4
aAesGcm		db 'AES-GCM',0          ; DATA XREF: .rdata:1002F558o
					; .rdata:1002F830o ...
aRsa		db 'RSA',0              ; DATA XREF: .rdata:1002F548o
					; .rdata:1002F550o ...
aTls_rsa_with_8	db 'TLS_RSA_WITH_AES_128_GCM_SHA256',0 ; DATA XREF: .rdata:1002F544o
byte_1002F540	db 2 dup(0)		; DATA XREF: SSL_GetCipherSuiteInfo+57o
word_1002F542	dw 9Ch			; DATA XREF: SSL_GetCipherSuiteInfo:loc_10020616r
					; sub_10020660+2o ...
		dd offset aTls_rsa_with_8 ; "TLS_RSA_WITH_AES_128_GCM_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aAesGcm	; "AES-GCM"
		dd 0Ah,	800080h, 80h
		dd offset aAead		; "AEAD"
		dd 6, 80h
dword_1002F574	dd 1			; DATA XREF: sub_100206D0+30r
		dd 880000h
		dd offset aTls_dhe_rsa__7 ; "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 870000h
		dd offset aTls_dhe_dss__5 ; "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 6B0000h
		dd offset aTls_dhe_rsa__6 ; "TLS_DHE_RSA_WITH_AES_256_CBC_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 390000h
		dd offset aTls_dhe_rsa__5 ; "TLS_DHE_RSA_WITH_AES_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 380000h
		dd offset aTls_dhe_dss__4 ; "TLS_DHE_DSS_WITH_AES_256_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 840000h
		dd offset aTls_rsa_with_7 ; "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 3D0000h
		dd offset aTls_rsa_with_6 ; "TLS_RSA_WITH_AES_256_CBC_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 350000h
		dd offset aTls_rsa_with_5 ; "TLS_RSA_WITH_AES_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 450000h
		dd offset aTls_dhe_rsa__4 ; "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 440000h
		dd offset aTls_dhe_dss__3 ; "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 660000h
		dd offset aTls_dhe_dss__2 ; "TLS_DHE_DSS_WITH_RC4_128_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 670000h
		dd offset aTls_dhe_rsa__3 ; "TLS_DHE_RSA_WITH_AES_128_CBC_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 9E0000h
		dd offset aTls_dhe_rsa__2 ; "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAesGcm	; "AES-GCM"
		dd 0Ah,	800080h, 80h
		dd offset aAead		; "AEAD"
		dd 6, 80h, 1, 330000h
		dd offset aTls_dhe_rsa__1 ; "TLS_DHE_RSA_WITH_AES_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 320000h
		dd offset aTls_dhe_dss__1 ; "TLS_DHE_DSS_WITH_AES_128_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 960000h
		dd offset aTls_rsa_with_s ; "TLS_RSA_WITH_SEED_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aSeed		; "SEED"
		dd 9, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 410000h
		dd offset aTls_rsa_with_c ; "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aCamellia	; "CAMELLIA"
		dd 8, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 50000h
		dd offset aTls_rsa_with_4 ; "TLS_RSA_WITH_RC4_128_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 40000h
		dd offset aTls_rsa_with_r ; "TLS_RSA_WITH_RC4_128_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 0
		dd 3C0000h
		dd offset aTls_rsa_with_2 ; "TLS_RSA_WITH_AES_128_CBC_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 2F0000h
		dd offset aTls_rsa_with_a ; "TLS_RSA_WITH_AES_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 160000h
		dd offset aTls_dhe_rsa__0 ; "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 130000h
		dd offset aTls_dhe_dss__0 ; "TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0FEFF0000h
		dd offset aSsl_rsa_fips_0 ; "SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 5, 0A0000h
		dd offset aTls_rsa_with_3 ; "TLS_RSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 150000h
		dd offset aTls_dhe_rsa_wi ; "TLS_DHE_RSA_WITH_DES_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aDhe		; "DHE"
		dd 2
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 120000h
		dd offset aTls_dhe_dss_wi ; "TLS_DHE_DSS_WITH_DES_CBC_SHA"
		dd offset aDsa		; "DSA"
		dd 2
		dd offset aDhe		; "DHE"
		dd 2
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0FEFE0000h
		dd offset aSsl_rsa_fips_w ; "SSL_RSA_FIPS_WITH_DES_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 4, 90000h
		dd offset aTls_rsa_with_d ; "TLS_RSA_WITH_DES_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 640000h
		dd offset aTls_rsa_expo_2 ; "TLS_RSA_EXPORT1024_WITH_RC4_56_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 380080h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 2, 620000h
		dd offset aTls_rsa_expo_1 ; "TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 2, 30000h
		dd offset aTls_rsa_expo_0 ; "TLS_RSA_EXPORT_WITH_RC4_40_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 280080h, 28h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 2, 60000h
		dd offset aTls_rsa_export ; "TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc2		; "RC2"
		dd 2, 280080h, 28h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 2, 3B0000h
		dd offset aTls_rsa_with_1 ; "TLS_RSA_WITH_NULL_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aNull		; "NULL"
		dd 3 dup(0)
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 2, 20000h
		dd offset aTls_rsa_with_0 ; "TLS_RSA_WITH_NULL_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aNull		; "NULL"
		align 10h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 2, 10000h
		dd offset aTls_rsa_with_n ; "TLS_RSA_WITH_NULL_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aNull		; "NULL"
		dd 3 dup(0)
		dd offset aMd5		; "MD5"
		dd 1, 80h, 2, 0C02F0000h
		dd offset aTls_ecdhe_rs_5 ; "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAesGcm	; "AES-GCM"
		dd 0Ah,	800080h, 80h
		dd offset aAead		; "AEAD"
		dd 6, 80h, 1, 0C02B0000h
		dd offset aTls_ecdhe_ec_5 ; "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAesGcm	; "AES-GCM"
		dd 0Ah,	800080h, 80h
		dd offset aAead		; "AEAD"
		dd 6, 80h, 1, 0C0010000h
		dd offset aTls_ecdh_ecd_3 ; "TLS_ECDH_ECDSA_WITH_NULL_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aNull		; "NULL"
		align 10h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0020000h
		dd offset aTls_ecdh_ecd_2 ; "TLS_ECDH_ECDSA_WITH_RC4_128_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0030000h
		dd offset aTls_ecdh_ecd_1 ; "TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0040000h
		dd offset aTls_ecdh_ecd_0 ; "TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0050000h
		dd offset aTls_ecdh_ecdsa ; "TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0060000h
		dd offset aTls_ecdhe_ec_4 ; "TLS_ECDHE_ECDSA_WITH_NULL_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aNull		; "NULL"
		dd 3 dup(0)
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0070000h
		dd offset aTls_ecdhe_ec_3 ; "TLS_ECDHE_ECDSA_WITH_RC4_128_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0080000h
		dd offset aTls_ecdhe_ec_2 ; "TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0090000h
		dd offset aTls_ecdhe_ec_1 ; "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0230000h
		dd offset aTls_ecdhe_ec_0 ; "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 0C00A0000h
		dd offset aTls_ecdhe_ecds ; "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA"
		dd offset aEcdsa	; "ECDSA"
		dd 4
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C00B0000h
		dd offset aTls_ecdh_rsa_3 ; "TLS_ECDH_RSA_WITH_NULL_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aNull		; "NULL"
		dd 3 dup(0)
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C00C0000h
		dd offset aTls_ecdh_rsa_2 ; "TLS_ECDH_RSA_WITH_RC4_128_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C00D0000h
		dd offset aTls_ecdh_rsa_1 ; "TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C00E0000h
		dd offset aTls_ecdh_rsa_0 ; "TLS_ECDH_RSA_WITH_AES_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C00F0000h
		dd offset aTls_ecdh_rsa_w ; "TLS_ECDH_RSA_WITH_AES_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdh		; "ECDH"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0100000h
		dd offset aTls_ecdhe_rs_4 ; "TLS_ECDHE_RSA_WITH_NULL_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aNull		; "NULL"
		align 10h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0110000h
		dd offset aTls_ecdhe_rs_3 ; "TLS_ECDHE_RSA_WITH_RC4_128_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 0
		dd 0C0120000h
		dd offset aTls_ecdhe_rs_2 ; "TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0130000h
		dd offset aTls_ecdhe_rs_1 ; "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0C0270000h
		dd offset aTls_ecdhe_rs_0 ; "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 800080h, 80h
		dd offset aSha256	; "SHA256"
		dd 5, 100h, 1, 0C0140000h
		dd offset aTls_ecdhe_rsa_ ; "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aEcdhe	; "ECDHE"
		dd 4
		dd offset aAes		; "AES"
		dd 7, 1000100h,	100h
		dd offset aSha1		; "SHA1"
		dd 2, 0A0h, 1, 0FF010000h
		dd offset aSsl_ck_rc4_1_0 ; "SSL_CK_RC4_128_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 800080h, 80h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 0
		dd 0FF030000h
		dd offset aSsl_ck_rc2_1_0 ; "SSL_CK_RC2_128_CBC_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc2		; "RC2"
		dd 2, 800080h, 80h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 0
		dd 0FF070000h
		dd offset aSsl_ck_des_192 ; "SSL_CK_DES_192_EDE3_CBC_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset a3des		; "3DES"
		dd 4, 9C00C0h, 70h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 0
		dd 0FF060000h
		dd offset aSsl_ck_des_64_ ; "SSL_CK_DES_64_CBC_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset SubStr	; "DES"
		dd 3, 380040h, 38h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 0
		dd 0FF020000h
		dd offset aSsl_ck_rc4_128 ; "SSL_CK_RC4_128_EXPORT40_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc4		; "RC4"
		dd 1, 280080h, 28h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 2, 0FF040000h
		dd offset aSsl_ck_rc2_128 ; "SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5"
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRsa		; "RSA"
		dd 1
		dd offset aRc2		; "RC2"
		dd 2, 280080h, 28h
		dd offset aMd5		; "MD5"
		dd 1, 80h, 2
aDeflate	db 'DEFLATE',0          ; DATA XREF: SSL_GetChannelInfo:loc_10020528o
a???		db '???',0              ; DATA XREF: SSL_GetChannelInfo+12Eo
aNA		db 'N/A',0              ; DATA XREF: SSL_GetChannelInfo+CAo
dword_100303F8	dd 0			; DATA XREF: sub_10020930+Dr
					; sub_100209B0:loc_10020A00r
		dd 0F6h, 0F7h, 0F8h, 0F9h, 0FAh, 0FBh, 0FCh, 0FDh, 0FEh
		dd 0FFh, 100h, 101h, 102h, 103h, 0D5h, 0D6h, 0D7h, 0D8h
		dd 0CAh, 0D9h, 0DAh, 0DBh, 0D0h, 0DCh, 0DDh
word_10030460	dw 0			; DATA XREF: sub_10020EA0+48r
		dw 0A3h
		unicode	0, <>
		dw 0C1h
		db '',0
aVvl:
		unicode	0, <>
		dw 11Bh
		dd 199011Bh, 23B0199h, 0A0023Bh, 0A000A0h, 0C000C0h, 0E000E0h
		dd 1000100h, 2090180h, 0FFFFh
word_10030498	dw 0C0h			; DATA XREF: sub_10020E30:loc_10020E40r
		align 4
dword_1003049C	dd 13h			; DATA XREF: sub_10020E30+1Br
					; sub_10020E30+3Fr ...
		dd 0A0h, 11h, 0A0h, 0Fh, 0A0h, 10h, 0A3h, 1, 0A3h, 2, 0A3h
		dd 3, 0C0h, 12h, 0C1h, 4, 0C1h,	5, 0E0h, 15h, 0E0h, 14h
		dd 0E9h, 6, 0E9h, 7, 0EFh, 8, 100h, 17h, 100h, 16h, 11Bh
		dd 9, 11Bh, 0Ah, 180h, 18h, 199h, 0Bh, 199h, 0Ch, 209h
		dd 19h,	23Bh, 0Dh, 23Bh, 0Eh, 0FFFFh, 0
dword_10030568	dd 0C004C003h, 0C001C005h, 0C00DC002h, 0C00FC00Eh, 0C00CC00Bh
					; DATA XREF: sub_10021740+26o
					; sub_10021740:loc_100217E5o
		dd 0
dword_10030580	dd 0C004C003h, 0C001C005h, 0C002h ; DATA XREF: sub_10021740:loc_100217C5o
					; sub_10021B10:loc_10021BC6o
dword_1003058C	dd 0C00EC00Dh, 0C00BC00Fh, 0C00Ch ; DATA XREF: sub_10021740:loc_100217D5o
dword_10030598	dd 0C009C008h, 0C02BC023h, 0C006C00Ah, 0C007h ;	DATA XREF: sub_10021740+31o
					; sub_10021B10+C1o
dword_100305A8	dd 0C013C012h, 0C02FC027h, 0C010C014h, 0C011h ;	DATA XREF: sub_10021740+Eo
dword_100305B8	dd 0C009C008h, 0C02BC023h, 0C006C00Ah, 0C012C007h, 0C027C013h
					; DATA XREF: sub_10021700+9o
					; sub_100218C0+29o ...
		dd 0C014C02Fh, 0C011C010h, 0C004C003h, 0C001C005h, 0C00DC002h
		dd 0C00FC00Eh, 0C00CC00Bh, 0
dword_100305EC	dd 8000A00h, 17000600h,	19001800h ; DATA XREF: sub_10021930+78o
dword_100305F8	dd 34000A00h, 1003200h,	3000200h, 5000400h, 7000600h, 9000800h
					; DATA XREF: sub_10021930+4Co
		dd 0B000A00h, 0D000C00h, 0F000E00h, 11001000h, 13001200h
		dd 15001400h, 17001600h, 19001800h
dword_10030630	dd 2000B00h, 1		; DATA XREF: sub_10021A20+26o
aSoftokn3_dll	db 'softokn3.dll',0     ; DATA XREF: .data:off_1003714Co
		align 4
aFreebl3_dll	db 'freebl3.dll',0      ; DATA XREF: .data:off_10037148o
aFreebl_getvect	db 'FREEBL_GetVector',0 ; DATA XREF: sub_10022270+30o
		align 4
dword_10030668	dd 0			; DATA XREF: sub_10022820:loc_1002285Er
dword_1003066C	dd 0			; DATA XREF: sub_10022820+44r
dword_10030670	dd 0			; DATA XREF: sub_10022820+4Ar
aNss_disable_un	db 'NSS_DISABLE_UNLOAD',0 ; DATA XREF: sub_10022820+13o
		align 4
aDeflate1_2_5Co	db ' deflate 1.2.5 Copyright 1995-2010 Jean-loup Gailly and Mark Adle'
		db 'r ',0
		align 10h
word_100306D0	dw 0			; DATA XREF: sub_10022F30+45r
word_100306D2	dw 0			; DATA XREF: sub_10022F30+35r
word_100306D4	dw 0			; DATA XREF: sub_10022F30+52r
word_100306D6	dw 0			; DATA XREF: sub_10022F30+5Fr
off_100306D8	dd offset sub_100232F0	; DATA XREF: sub_100240F0+68Fr
		dd 40004h, 40008h
		dd offset sub_100234D0
		dd 50004h, 80010h
		dd offset sub_100234D0
		dd 60004h, 200020h
		dd offset sub_100234D0
		dd 40004h, 100010h
		dd offset sub_100237F0
		dd 100008h, 200020h
		dd offset sub_100237F0
		dd 100008h, 800080h
		dd offset sub_100237F0
		dw 8
		unicode	0, < >
		dw 80h
		dw 100h
		dd offset sub_100237F0
		dd 800020h, 4000102h
		dd offset sub_100237F0
		dd 1020020h, 10000102h
		dd offset sub_100237F0
a1_2_5_0	db '1.2.5',0
		align 10h
asc_10030750	db '`',7,0              ; DATA XREF: sub_10024E50+7D1o
		align 4
		dd 500800h, 100800h, 730814h, 1F0712h, 700800h,	300800h
		dd 0C00900h, 0A0710h, 600800h, 200800h,	0A00900h, 800h
		dd 800800h, 400800h, 0E00900h, 60710h, 580800h,	180800h
		dd 900900h, 3B0713h, 780800h, 380800h, 0D00900h, 110711h
		dd 680800h, 280800h, 0B00900h, 80800h, 880800h,	480800h
		dd 0F00900h, 40710h, 540800h, 140800h, 0E30815h, 2B0713h
		dd 740800h, 340800h, 0C80900h, 0D0711h,	640800h, 240800h
		dd 0A80900h, 40800h, 840800h, 440800h, 0E80900h, 80710h
		dd 5C0800h, 1C0800h, 980900h, 530714h, 7C0800h,	3C0800h
		dd 0D80900h, 170712h, 6C0800h, 2C0800h,	0B80900h, 0C0800h
		dd 8C0800h, 4C0800h, 0F80900h, 30710h, 520800h,	120800h
		dd 0A30815h, 230713h, 720800h, 320800h,	0C40900h, 0B0711h
		dd 620800h, 220800h, 0A40900h, 20800h, 820800h,	420800h
		dd 0E40900h, 70710h, 5A0800h, 1A0800h, 940900h,	430714h
		dd 7A0800h, 3A0800h, 0D40900h, 130712h,	6A0800h, 2A0800h
		dd 0B40900h, 0A0800h, 8A0800h, 4A0800h,	0F40900h, 50710h
		dd 560800h, 160800h, 840h, 330713h, 760800h, 360800h, 0CC0900h
		dd 0F0711h, 660800h, 260800h, 0AC0900h,	60800h,	860800h
		dd 460800h, 0EC0900h, 90710h, 5E0800h, 1E0800h,	9C0900h
		dd 630714h, 7E0800h, 3E0800h, 0DC0900h,	1B0712h, 6E0800h
		dd 2E0800h, 0BC0900h, 0E0800h, 8E0800h,	4E0800h, 0FC0900h
		dd 760h, 510800h, 110800h, 830815h, 1F0712h, 710800h, 310800h
		dd 0C20900h, 0A0710h, 610800h, 210800h,	0A20900h, 10800h
		dd 810800h, 410800h, 0E20900h, 60710h, 590800h,	190800h
		dd 920900h, 3B0713h, 790800h, 390800h, 0D20900h, 110711h
		dd 690800h, 290800h, 0B20900h, 90800h, 890800h,	490800h
		dd 0F20900h, 40710h, 550800h, 150800h, 1020810h, 2B0713h
		dd 750800h, 350800h, 0CA0900h, 0D0711h,	650800h, 250800h
		dd 0AA0900h, 50800h, 850800h, 450800h, 0EA0900h, 80710h
		dd 5D0800h, 1D0800h, 9A0900h, 530714h, 7D0800h,	3D0800h
		dd 0DA0900h, 170712h, 6D0800h, 2D0800h,	0BA0900h, 0D0800h
		dd 8D0800h, 4D0800h, 0FA0900h, 30710h, 530800h,	130800h
		dd 0C30815h, 230713h, 730800h, 330800h,	0C60900h, 0B0711h
		dd 630800h, 230800h, 0A60900h, 30800h, 830800h,	430800h
		dd 0E60900h, 70710h, 5B0800h, 1B0800h, 960900h,	430714h
		dd 7B0800h, 3B0800h, 0D60900h, 130712h,	6B0800h, 2B0800h
		dd 0B60900h, 0B0800h, 8B0800h, 4B0800h,	0F60900h, 50710h
		dd 570800h, 170800h, 840h, 330713h, 770800h, 370800h, 0CE0900h
		dd 0F0711h, 670800h, 270800h, 0AE0900h,	70800h,	870800h
		dd 470800h, 0EE0900h, 90710h, 5F0800h, 1F0800h,	9E0900h
		dd 630714h, 7F0800h, 3F0800h, 0DE0900h,	1B0712h, 6F0800h
		dd 2F0800h, 0BE0900h, 0F0800h, 8F0800h,	4F0800h, 0FE0900h
		dd 760h, 500800h, 100800h, 730814h, 1F0712h, 700800h, 300800h
		dd 0C10900h, 0A0710h, 600800h, 200800h,	0A10900h, 800h
		dd 800800h, 400800h, 0E10900h, 60710h, 580800h,	180800h
		dd 910900h, 3B0713h, 780800h, 380800h, 0D10900h, 110711h
		dd 680800h, 280800h, 0B10900h, 80800h, 880800h,	480800h
		dd 0F10900h, 40710h, 540800h, 140800h, 0E30815h, 2B0713h
		dd 740800h, 340800h, 0C90900h, 0D0711h,	640800h, 240800h
		dd 0A90900h, 40800h, 840800h, 440800h, 0E90900h, 80710h
		dd 5C0800h, 1C0800h, 990900h, 530714h, 7C0800h,	3C0800h
		dd 0D90900h, 170712h, 6C0800h, 2C0800h,	0B90900h, 0C0800h
		dd 8C0800h, 4C0800h, 0F90900h, 30710h, 520800h,	120800h
		dd 0A30815h, 230713h, 720800h, 320800h,	0C50900h, 0B0711h
		dd 620800h, 220800h, 0A50900h, 20800h, 820800h,	420800h
		dd 0E50900h, 70710h, 5A0800h, 1A0800h, 950900h,	430714h
		dd 7A0800h, 3A0800h, 0D50900h, 130712h,	6A0800h, 2A0800h
		dd 0B50900h, 0A0800h, 8A0800h, 4A0800h,	0F50900h, 50710h
		dd 560800h, 160800h, 840h, 330713h, 760800h, 360800h, 0CD0900h
		dd 0F0711h, 660800h, 260800h, 0AD0900h,	60800h,	860800h
		dd 460800h, 0ED0900h, 90710h, 5E0800h, 1E0800h,	9D0900h
		dd 630714h, 7E0800h, 3E0800h, 0DD0900h,	1B0712h, 6E0800h
		dd 2E0800h, 0BD0900h, 0E0800h, 8E0800h,	4E0800h, 0FD0900h
		dd 760h, 510800h, 110800h, 830815h, 1F0712h, 710800h, 310800h
		dd 0C30900h, 0A0710h, 610800h, 210800h,	0A30900h, 10800h
		dd 810800h, 410800h, 0E30900h, 60710h, 590800h,	190800h
		dd 930900h, 3B0713h, 790800h, 390800h, 0D30900h, 110711h
		dd 690800h, 290800h, 0B30900h, 90800h, 890800h,	490800h
		dd 0F30900h, 40710h, 550800h, 150800h, 1020810h, 2B0713h
		dd 750800h, 350800h, 0CB0900h, 0D0711h,	650800h, 250800h
		dd 0AB0900h, 50800h, 850800h, 450800h, 0EB0900h, 80710h
		dd 5D0800h, 1D0800h, 9B0900h, 530714h, 7D0800h,	3D0800h
		dd 0DB0900h, 170712h, 6D0800h, 2D0800h,	0BB0900h, 0D0800h
		dd 8D0800h, 4D0800h, 0FB0900h, 30710h, 530800h,	130800h
		dd 0C30815h, 230713h, 730800h, 330800h,	0C70900h, 0B0711h
		dd 630800h, 230800h, 0A70900h, 30800h, 830800h,	430800h
		dd 0E70900h, 70710h, 5B0800h, 1B0800h, 970900h,	430714h
		dd 7B0800h, 3B0800h, 0D70900h, 130712h,	6B0800h, 2B0800h
		dd 0B70900h, 0B0800h, 8B0800h, 4B0800h,	0F70900h, 50710h
		dd 570800h, 170800h, 840h, 330713h, 770800h, 370800h, 0CF0900h
		dd 0F0711h, 670800h, 270800h, 0AF0900h,	70800h,	870800h
		dd 470800h, 0EF0900h, 90710h, 5F0800h, 1F0800h,	9F0900h
		dd 630714h, 7F0800h, 3F0800h, 0DF0900h,	1B0712h, 6F0800h
		dd 2F0800h, 0BF0900h, 0F0800h, 8F0800h,	4F0800h, 0FF0900h
dword_10030F50	dd 10510h, 1010517h, 110513h, 1001051Bh, 50511h, 4010519h
					; DATA XREF: sub_10024E50+7DFo
		dd 410515h, 4001051Dh, 30510h, 2010518h, 210514h, 2001051Ch
		dd 90512h, 801051Ah, 810516h, 540h, 20510h, 1810517h, 190513h
		dd 1801051Bh, 70511h, 6010519h,	610515h, 6001051Dh, 40510h
		dd 3010518h, 310514h, 3001051Ch, 0D0512h, 0C01051Ah, 0C10516h
		dd 540h
word_10030FD0	dw 10h			; DATA XREF: sub_10024E50+9A8r
					; sub_10024E50+9E3r
		dw 11h
		dd 12h,	70008h,	60009h,	5000Ah,	4000Bh,	3000Ch,	2000Dh
		dd 1000Eh, 0Fh
aIncorrectLengt	db 'incorrect length check',0 ; DATA XREF: sub_10024E50+13BDo
		align 10h
aIncorrectDataC	db 'incorrect data check',0 ; DATA XREF: sub_10024E50+1368o
		align 4
aInvalidDista_1	db 'invalid distance too far back',0 ; DATA XREF: sub_10024E50+11D2o
					; sub_100284A0+3B9o
		align 4
aInvalidDista_0	db 'invalid distance code',0 ; DATA XREF: sub_10024E50+1132o
					; sub_100284A0+3C6o
		align 10h
aInvalidLiter_0	db 'invalid literal/length code',0 ; DATA XREF: sub_10024E50+F7Do
					; sub_100284A0+3E4o
aInvalidDistanc	db 'invalid distances set',0 ; DATA XREF: sub_10024E50+D57o
		align 4
aInvalidLiteral	db 'invalid literal/lengths set',0 ; DATA XREF: sub_10024E50+D0Ao
aInvalidBitLeng	db 'invalid bit length repeat',0 ; DATA XREF: sub_10024E50+CACo
					; sub_10024E50+CBCo
		align 4
aInvalidCodeMis	db 'invalid code -- missing end-of-block',0 ; DATA XREF: sub_10024E50+C9Co
		align 4
aTooManyLengthO	db 'too many length or distance symbols',0 ; DATA XREF: sub_10024E50+A4Ao
aInvalidCodeLen	db 'invalid code lengths set',0 ; DATA XREF: sub_10024E50+A3Ao
		align 4
aInvalidStoredB	db 'invalid stored block lengths',0 ; DATA XREF: sub_10024E50+877o
		align 4
aInvalidBlockTy	db 'invalid block type',0 ; DATA XREF: sub_10024E50+815o
		align 4
aHeaderCrcMisma	db 'header crc mismatch',0 ; DATA XREF: sub_10024E50+661o
aUnknownHeaderF	db 'unknown header flags set',0 ; DATA XREF: sub_10024E50+234o
		align 4
aIncorrectHeade	db 'incorrect header check',0 ; DATA XREF: sub_10024E50+1DDo
		align 10h
aInvalidWindowS	db 'invalid window size',0 ; DATA XREF: sub_10024E50+1C9o
aUnknownCompres	db 'unknown compression method',0 ; DATA XREF: sub_10024E50+159o
					; sub_10024E50+21Co
		align 10h
dword_100311E0	dd 0			; DATA XREF: sub_100269A0-29Dr
					; sub_100269A0-255r ...
		dd 77073096h, 0EE0E612Ch, 990951BAh, 76DC419h, 706AF48Fh
		dd 0E963A535h, 9E6495A3h, 0EDB8832h, 79DCB8A4h,	0E0D5E91Eh
		dd 97D2D988h, 9B64C2Bh,	7EB17CBDh, 0E7B82D07h, 90BF1D91h
		dd 1DB71064h, 6AB020F2h, 0F3B97148h, 84BE41DEh,	1ADAD47Dh
		dd 6DDDE4EBh, 0F4D4B551h, 83D385C7h, 136C9856h,	646BA8C0h
		dd 0FD62F97Ah, 8A65C9ECh, 14015C4Fh, 63066CD9h,	0FA0F3D63h
		dd 8D080DF5h, 3B6E20C8h, 4C69105Eh, 0D56041E4h,	0A2677172h
		dd 3C03E4D1h, 4B04D447h, 0D20D85FDh, 0A50AB56Bh, 35B5A8FAh
		dd 42B2986Ch, 0DBBBC9D6h, 0ACBCF940h, 32D86CE3h, 45DF5C75h
		dd 0DCD60DCFh, 0ABD13D59h, 26D930ACh, 51DE003Ah, 0C8D75180h
		dd 0BFD06116h, 21B4F4B5h, 56B3C423h, 0CFBA9599h, 0B8BDA50Fh
		dd 2802B89Eh, 5F058808h, 0C60CD9B2h, 0B10BE924h, 2F6F7C87h
		dd 58684C11h, 0C1611DABh, 0B6662D3Dh, 76DC4190h, 1DB7106h
		dd 98D220BCh, 0EFD5102Ah, 71B18589h, 6B6B51Fh, 9FBFE4A5h
		dd 0E8B8D433h, 7807C9A2h, 0F00F934h, 9609A88Eh,	0E10E9818h
		dd 7F6A0DBBh, 86D3D2Dh,	91646C97h, 0E6635C01h, 6B6B51F4h
		dd 1C6C6162h, 856530D8h, 0F262004Eh, 6C0695EDh,	1B01A57Bh
		dd 8208F4C1h, 0F50FC457h, 65B0D9C6h, 12B7E950h,	8BBEB8EAh
		dd 0FCB9887Ch, 62DD1DDFh, 15DA2D49h, 8CD37CF3h,	0FBD44C65h
		dd 4DB26158h, 3AB551CEh, 0A3BC0074h, 0D4BB30E2h, 4ADFA541h
		dd 3DD895D7h, 0A4D1C46Dh, 0D3D6F4FBh, 4369E96Ah, 346ED9FCh
		dd 0AD678846h, 0DA60B8D0h, 44042D73h, 33031DE5h, 0AA0A4C5Fh
		dd 0DD0D7CC9h, 5005713Ch, 270241AAh, 0BE0B1010h, 0C90C2086h
		dd 5768B525h, 206F85B3h, 0B966D409h, 0CE61E49Fh, 5EDEF90Eh
		dd 29D9C998h, 0B0D09822h, 0C7D7A8B4h, 59B33D17h, 2EB40D81h
		dd 0B7BD5C3Bh, 0C0BA6CADh, 0EDB88320h, 9ABFB3B6h, 3B6E20Ch
		dd 74B1D29Ah, 0EAD54739h, 9DD277AFh, 4DB2615h, 73DC1683h
		dd 0E3630B12h, 94643B84h, 0D6D6A3Eh, 7A6A5AA8h,	0E40ECF0Bh
		dd 9309FF9Dh, 0A00AE27h, 7D079EB1h, 0F00F9344h,	8708A3D2h
		dd 1E01F268h, 6906C2FEh, 0F762575Dh, 806567CBh,	196C3671h
		dd 6E6B06E7h, 0FED41B76h, 89D32BE0h, 10DA7A5Ah,	67DD4ACCh
		dd 0F9B9DF6Fh, 8EBEEFF9h, 17B7BE43h, 60B08ED5h,	0D6D6A3E8h
		dd 0A1D1937Eh, 38D8C2C4h, 4FDFF252h, 0D1BB67F1h, 0A6BC5767h
		dd 3FB506DDh, 48B2364Bh, 0D80D2BDAh, 0AF0A1B4Ch, 36034AF6h
		dd 41047A60h, 0DF60EFC3h, 0A867DF55h, 316E8EEFh, 4669BE79h
		dd 0CB61B38Ch, 0BC66831Ah, 256FD2A0h, 5268E236h, 0CC0C7795h
		dd 0BB0B4703h, 220216B9h, 5505262Fh, 0C5BA3BBEh, 0B2BD0B28h
		dd 2BB45A92h, 5CB36A04h, 0C2D7FFA7h, 0B5D0CF31h, 2CD99E8Bh
		dd 5BDEAE1Dh, 9B64C2B0h, 0EC63F226h, 756AA39Ch,	26D930Ah
		dd 9C0906A9h, 0EB0E363Fh, 72076785h, 5005713h, 95BF4A82h
		dd 0E2B87A14h, 7BB12BAEh, 0CB61B38h, 92D28E9Bh,	0E5D5BE0Dh
		dd 7CDCEFB7h, 0BDBDF21h, 86D3D2D4h, 0F1D4E242h,	68DDB3F8h
		dd 1FDA836Eh, 81BE16CDh, 0F6B9265Bh, 6FB077E1h,	18B74777h
		dd 88085AE6h, 0FF0F6A70h, 66063BCAh, 11010B5Ch,	8F659EFFh
		dd 0F862AE69h, 616BFFD3h, 166CCF45h, 0A00AE278h, 0D70DD2EEh
		dd 4E048354h, 3903B3C2h, 0A7672661h, 0D06016F7h, 4969474Dh
		dd 3E6E77DBh, 0AED16A4Ah, 0D9D65ADCh, 40DF0B66h, 37D83BF0h
		dd 0A9BCAE53h, 0DEBB9EC5h, 47B2CF7Fh, 30B5FFE9h, 0BDBDF21Ch
		dd 0CABAC28Ah, 53B39330h, 24B4A3A6h, 0BAD03605h, 0CDD70693h
		dd 54DE5729h, 23D967BFh, 0B3667A2Eh, 0C4614AB8h, 5D681B02h
		dd 2A6F2B94h, 0B40BBE37h, 0C30C8EA1h, 5A05DF1Bh, 2D02EF8Dh
dword_100315E0	dd 0			; DATA XREF: sub_100269A0-268r
					; sub_100269A0-235r ...
		dd 191B3141h, 32366282h, 2B2D53C3h, 646CC504h, 7D77F445h
		dd 565AA786h, 4F4196C7h, 0C8D98A08h, 0D1C2BB49h, 0FAEFE88Ah
		dd 0E3F4D9CBh, 0ACB54F0Ch, 0B5AE7E4Dh, 9E832D8Eh, 87981CCFh
		dd 4AC21251h, 53D92310h, 78F470D3h, 61EF4192h, 2EAED755h
		dd 37B5E614h, 1C98B5D7h, 5838496h, 821B9859h, 9B00A918h
		dd 0B02DFADBh, 0A936CB9Ah, 0E6775D5Dh, 0FF6C6C1Ch, 0D4413FDFh
		dd 0CD5A0E9Eh, 958424A2h, 8C9F15E3h, 0A7B24620h, 0BEA97761h
		dd 0F1E8E1A6h, 0E8F3D0E7h, 0C3DE8324h, 0DAC5B265h, 5D5DAEAAh
		dd 44469FEBh, 6F6BCC28h, 7670FD69h, 39316BAEh, 202A5AEFh
		dd 0B07092Ch, 121C386Dh, 0DF4636F3h, 0C65D07B2h, 0ED705471h
		dd 0F46B6530h, 0BB2AF3F7h, 0A231C2B6h, 891C9175h, 9007A034h
		dd 179FBCFBh, 0E848DBAh, 25A9DE79h, 3CB2EF38h, 73F379FFh
		dd 6AE848BEh, 41C51B7Dh, 58DE2A3Ch, 0F0794F05h,	0E9627E44h
		dd 0C24F2D87h, 0DB541CC6h, 94158A01h, 8D0EBB40h, 0A623E883h
		dd 0BF38D9C2h, 38A0C50Dh, 21BBF44Ch, 0A96A78Fh,	138D96CEh
		dd 5CCC0009h, 45D73148h, 6EFA628Bh, 77E153CAh, 0BABB5D54h
		dd 0A3A06C15h, 888D3FD6h, 91960E97h, 0DED79850h, 0C7CCA911h
		dd 0ECE1FAD2h, 0F5FACB93h, 7262D75Ch, 6B79E61Dh, 4054B5DEh
		dd 594F849Fh, 160E1258h, 0F152319h, 243870DAh, 3D23419Bh
		dd 65FD6BA7h, 7CE65AE6h, 57CB0925h, 4ED03864h, 191AEA3h
		dd 188A9FE2h, 33A7CC21h, 2ABCFD60h, 0AD24E1AFh,	0B43FD0EEh
		dd 9F12832Dh, 8609B26Ch, 0C94824ABh, 0D05315EAh, 0FB7E4629h
		dd 0E2657768h, 2F3F79F6h, 362448B7h, 1D091B74h,	4122A35h
		dd 4B53BCF2h, 52488DB3h, 7965DE70h, 607EEF31h, 0E7E6F3FEh
		dd 0FEFDC2BFh, 0D5D0917Ch, 0CCCBA03Dh, 838A36FAh, 9A9107BBh
		dd 0B1BC5478h, 0A8A76539h, 3B83984Bh, 2298A90Ah, 9B5FAC9h
		dd 10AECB88h, 5FEF5D4Fh, 46F46C0Eh, 6DD93FCDh, 74C20E8Ch
		dd 0F35A1243h, 0EA412302h, 0C16C70C1h, 0D8774180h, 9736D747h
		dd 8E2DE606h, 0A500B5C5h, 0BC1B8484h, 71418A1Ah, 685ABB5Bh
		dd 4377E898h, 5A6CD9D9h, 152D4F1Eh, 0C367E5Fh, 271B2D9Ch
		dd 3E001CDDh, 0B9980012h, 0A0833153h, 8BAE6290h, 92B553D1h
		dd 0DDF4C516h, 0C4EFF457h, 0EFC2A794h, 0F6D996D5h, 0AE07BCE9h
		dd 0B71C8DA8h, 9C31DE6Bh, 852AEF2Ah, 0CA6B79EDh, 0D37048ACh
		dd 0F85D1B6Fh, 0E1462A2Eh, 66DE36E1h, 7FC507A0h, 54E85463h
		dd 4DF36522h, 2B2F3E5h,	1BA9C2A4h, 30849167h, 299FA026h
		dd 0E4C5AEB8h, 0FDDE9FF9h, 0D6F3CC3Ah, 0CFE8FD7Bh, 80A96BBCh
		dd 99B25AFDh, 0B29F093Eh, 0AB84387Fh, 2C1C24B0h, 350715F1h
		dd 1E2A4632h, 7317773h,	4870E1B4h, 516BD0F5h, 7A468336h
		dd 635DB277h, 0CBFAD74Eh, 0D2E1E60Fh, 0F9CCB5CCh, 0E0D7848Dh
		dd 0AF96124Ah, 0B68D230Bh, 9DA070C8h, 84BB4189h, 3235D46h
		dd 1A386C07h, 31153FC4h, 280E0E85h, 674F9842h, 7E54A903h
		dd 5579FAC0h, 4C62CB81h, 8138C51Fh, 9823F45Eh, 0B30EA79Dh
		dd 0AA1596DCh, 0E554001Bh, 0FC4F315Ah, 0D7626299h, 0CE7953D8h
		dd 49E14F17h, 50FA7E56h, 7BD72D95h, 62CC1CD4h, 2D8D8A13h
		dd 3496BB52h, 1FBBE891h, 6A0D9D0h, 5E7EF3ECh, 4765C2ADh
		dd 6C48916Eh, 7553A02Fh, 3A1236E8h, 230907A9h, 824546Ah
		dd 113F652Bh, 96A779E4h, 8FBC48A5h, 0A4911B66h,	0BD8A2A27h
		dd 0F2CBBCE0h, 0EBD08DA1h, 0C0FDDE62h, 0D9E6EF23h, 14BCE1BDh
		dd 0DA7D0FCh, 268A833Fh, 3F91B27Eh, 70D024B9h, 69CB15F8h
		dd 42E6463Bh, 5BFD777Ah, 0DC656BB5h, 0C57E5AF4h, 0EE530937h
		dd 0F7483876h, 0B809AEB1h, 0A1129FF0h, 8A3FCC33h, 9324FD72h
dword_100319E0	dd 0			; DATA XREF: sub_100269A0-261r
					; sub_100269A0-223r ...
		dd 1C26A37h, 384D46Eh, 246BE59h, 709A8DCh, 6CBC2EBh, 48D7CB2h
		dd 54F1685h, 0E1351B8h,	0FD13B8Fh, 0D9785D6h, 0C55EFE1h
		dd 91AF964h, 8D89353h, 0A9E2D0Ah, 0B5C473Dh, 1C26A370h
		dd 1DE4C947h, 1FA2771Eh, 1E601D29h, 1B2F0BACh, 1AED619Bh
		dd 18ABDFC2h, 1969B5F5h, 1235F2C8h, 13F798FFh, 11B126A6h
		dd 10734C91h, 153C5A14h, 14FE3023h, 16B88E7Ah, 177AE44Dh
		dd 384D46E0h, 398F2CD7h, 3BC9928Eh, 3A0BF8B9h, 3F44EE3Ch
		dd 3E86840Bh, 3CC03A52h, 3D025065h, 365E1758h, 379C7D6Fh
		dd 35DAC336h, 3418A901h, 3157BF84h, 3095D5B3h, 32D36BEAh
		dd 331101DDh, 246BE590h, 25A98FA7h, 27EF31FEh, 262D5BC9h
		dd 23624D4Ch, 22A0277Bh, 20E69922h, 2124F315h, 2A78B428h
		dd 2BBADE1Fh, 29FC6046h, 283E0A71h, 2D711CF4h, 2CB376C3h
		dd 2EF5C89Ah, 2F37A2ADh, 709A8DC0h, 7158E7F7h, 731E59AEh
		dd 72DC3399h, 7793251Ch, 76514F2Bh, 7417F172h, 75D59B45h
		dd 7E89DC78h, 7F4BB64Fh, 7D0D0816h, 7CCF6221h, 798074A4h
		dd 78421E93h, 7A04A0CAh, 7BC6CAFDh, 6CBC2EB0h, 6D7E4487h
		dd 6F38FADEh, 6EFA90E9h, 6BB5866Ch, 6A77EC5Bh, 68315202h
		dd 69F33835h, 62AF7F08h, 636D153Fh, 612BAB66h, 60E9C151h
		dd 65A6D7D4h, 6464BDE3h, 662203BAh, 67E0698Dh, 48D7CB20h
		dd 4915A117h, 4B531F4Eh, 4A917579h, 4FDE63FCh, 4E1C09CBh
		dd 4C5AB792h, 4D98DDA5h, 46C49A98h, 4706F0AFh, 45404EF6h
		dd 448224C1h, 41CD3244h, 400F5873h, 4249E62Ah, 438B8C1Dh
		dd 54F16850h, 55330267h, 5775BC3Eh, 56B7D609h, 53F8C08Ch
		dd 523AAABBh, 507C14E2h, 51BE7ED5h, 5AE239E8h, 5B2053DFh
		dd 5966ED86h, 58A487B1h, 5DEB9134h, 5C29FB03h, 5E6F455Ah
		dd 5FAD2F6Dh, 0E1351B80h, 0E0F771B7h, 0E2B1CFEEh, 0E373A5D9h
		dd 0E63CB35Ch, 0E7FED96Bh, 0E5B86732h, 0E47A0D05h, 0EF264A38h
		dd 0EEE4200Fh, 0ECA29E56h, 0ED60F461h, 0E82FE2E4h, 0E9ED88D3h
		dd 0EBAB368Ah, 0EA695CBDh, 0FD13B8F0h, 0FCD1D2C7h, 0FE976C9Eh
		dd 0FF5506A9h, 0FA1A102Ch, 0FBD87A1Bh, 0F99EC442h, 0F85CAE75h
		dd 0F300E948h, 0F2C2837Fh, 0F0843D26h, 0F1465711h, 0F4094194h
		dd 0F5CB2BA3h, 0F78D95FAh, 0F64FFFCDh, 0D9785D60h, 0D8BA3757h
		dd 0DAFC890Eh, 0DB3EE339h, 0DE71F5BCh, 0DFB39F8Bh, 0DDF521D2h
		dd 0DC374BE5h, 0D76B0CD8h, 0D6A966EFh, 0D4EFD8B6h, 0D52DB281h
		dd 0D062A404h, 0D1A0CE33h, 0D3E6706Ah, 0D2241A5Dh, 0C55EFE10h
		dd 0C49C9427h, 0C6DA2A7Eh, 0C7184049h, 0C25756CCh, 0C3953CFBh
		dd 0C1D382A2h, 0C011E895h, 0CB4DAFA8h, 0CA8FC59Fh, 0C8C97BC6h
		dd 0C90B11F1h, 0CC440774h, 0CD866D43h, 0CFC0D31Ah, 0CE02B92Dh
		dd 91AF9640h, 906DFC77h, 922B422Eh, 93E92819h, 96A63E9Ch
		dd 976454ABh, 9522EAF2h, 94E080C5h, 9FBCC7F8h, 9E7EADCFh
		dd 9C381396h, 9DFA79A1h, 98B56F24h, 99770513h, 9B31BB4Ah
		dd 9AF3D17Dh, 8D893530h, 8C4B5F07h, 8E0DE15Eh, 8FCF8B69h
		dd 8A809DECh, 8B42F7DBh, 89044982h, 88C623B5h, 839A6488h
		dd 82580EBFh, 801EB0E6h, 81DCDAD1h, 8493CC54h, 8551A663h
		dd 8717183Ah, 86D5720Dh, 0A9E2D0A0h, 0A820BA97h, 0AA6604CEh
		dd 0ABA46EF9h, 0AEEB787Ch, 0AF29124Bh, 0AD6FAC12h, 0ACADC625h
		dd 0A7F18118h, 0A633EB2Fh, 0A4755576h, 0A5B73F41h, 0A0F829C4h
		dd 0A13A43F3h, 0A37CFDAAh, 0A2BE979Dh, 0B5C473D0h, 0B40619E7h
		dd 0B640A7BEh, 0B782CD89h, 0B2CDDB0Ch, 0B30FB13Bh, 0B1490F62h
		dd 0B08B6555h, 0BBD72268h, 0BA15485Fh, 0B853F606h, 0B9919C31h
		dd 0BCDE8AB4h, 0BD1CE083h, 0BF5A5EDAh, 0BE9834EDh
dword_10031DE0	dd 0			; DATA XREF: sub_100269A0-249r
					; sub_100269A0-20Ar ...
		dd 0B8BC6765h, 0AA09C88Bh, 12B5AFEEh, 8F629757h, 37DEF032h
		dd 256B5FDCh, 9DD738B9h, 0C5B428EFh, 7D084F8Ah,	6FBDE064h
		dd 0D7018701h, 4AD6BFB8h, 0F26AD8DDh, 0E0DF7733h, 58631056h
		dd 5019579Fh, 0E8A530FAh, 0FA109F14h, 42ACF871h, 0DF7BC0C8h
		dd 67C7A7ADh, 75720843h, 0CDCE6F26h, 95AD7F70h,	2D111815h
		dd 3FA4B7FBh, 8718D09Eh, 1ACFE827h, 0A2738F42h,	0B0C620ACh
		dd 87A47C9h, 0A032AF3Eh, 188EC85Bh, 0A3B67B5h, 0B28700D0h
		dd 2F503869h, 97EC5F0Ch, 8559F0E2h, 3DE59787h, 658687D1h
		dd 0DD3AE0B4h, 0CF8F4F5Ah, 7733283Fh, 0EAE41086h, 525877E3h
		dd 40EDD80Dh, 0F851BF68h, 0F02BF8A1h, 48979FC4h, 5A22302Ah
		dd 0E29E574Fh, 7F496FF6h, 0C7F50893h, 0D540A77Dh, 6DFCC018h
		dd 359FD04Eh, 8D23B72Bh, 9F9618C5h, 272A7FA0h, 0BAFD4719h
		dd 241207Ch, 10F48F92h,	0A848E8F7h, 9B14583Dh, 23A83F58h
		dd 311D90B6h, 89A1F7D3h, 1476CF6Ah, 0ACCAA80Fh,	0BE7F07E1h
		dd 6C36084h, 5EA070D2h,	0E61C17B7h, 0F4A9B859h,	4C15DF3Ch
		dd 0D1C2E785h, 697E80E0h, 7BCB2F0Eh, 0C377486Bh, 0CB0D0FA2h
		dd 73B168C7h, 6104C729h, 0D9B8A04Ch, 446F98F5h,	0FCD3FF90h
		dd 0EE66507Eh, 56DA371Bh, 0EB9274Dh, 0B6054028h, 0A4B0EFC6h
		dd 1C0C88A3h, 81DBB01Ah, 3967D77Fh, 2BD27891h, 936E1FF4h
		dd 3B26F703h, 839A9066h, 912F3F88h, 299358EDh, 0B4446054h
		dd 0CF80731h, 1E4DA8DFh, 0A6F1CFBAh, 0FE92DFECh, 462EB889h
		dd 549B1767h, 0EC277002h, 71F048BBh, 0C94C2FDEh, 0DBF98030h
		dd 6345E755h, 6B3FA09Ch, 0D383C7F9h, 0C1366817h, 798A0F72h
		dd 0E45D37CBh, 5CE150AEh, 4E54FF40h, 0F6E89825h, 0AE8B8873h
		dd 1637EF16h, 48240F8h,	0BC3E279Dh, 21E91F24h, 99557841h
		dd 8BE0D7AFh, 335CB0CAh, 0ED59B63Bh, 55E5D15Eh,	47507EB0h
		dd 0FFEC19D5h, 623B216Ch, 0DA874609h, 0C832E9E7h, 708E8E82h
		dd 28ED9ED4h, 9051F9B1h, 82E4565Fh, 3A58313Ah, 0A78F0983h
		dd 1F336EE6h, 0D86C108h, 0B53AA66Dh, 0BD40E1A4h, 5FC86C1h
		dd 1749292Fh, 0AFF54E4Ah, 322276F3h, 8A9E1196h,	982BBE78h
		dd 2097D91Dh, 78F4C94Bh, 0C048AE2Eh, 0D2FD01C0h, 6A4166A5h
		dd 0F7965E1Ch, 4F2A3979h, 5D9F9697h, 0E523F1F2h, 4D6B1905h
		dd 0F5D77E60h, 0E762D18Eh, 5FDEB6EBh, 0C2098E52h, 7AB5E937h
		dd 680046D9h, 0D0BC21BCh, 88DF31EAh, 3063568Fh,	22D6F961h
		dd 9A6A9E04h, 7BDA6BDh,	0BF01C1D8h, 0ADB46E36h,	15080953h
		dd 1D724E9Ah, 0A5CE29FFh, 0B77B8611h, 0FC7E174h, 9210D9CDh
		dd 2AACBEA8h, 38191146h, 80A57623h, 0D8C66675h,	607A0110h
		dd 72CFAEFEh, 0CA73C99Bh, 57A4F122h, 0EF189647h, 0FDAD39A9h
		dd 45115ECCh, 764DEE06h, 0CEF18963h, 0DC44268Dh, 64F841E8h
		dd 0F92F7951h, 41931E34h, 5326B1DAh, 0EB9AD6BFh, 0B3F9C6E9h
		dd 0B45A18Ch, 19F00E62h, 0A14C6907h, 3C9B51BEh,	842736DBh
		dd 96929935h, 2E2EFE50h, 2654B999h, 9EE8DEFCh, 8C5D7112h
		dd 34E11677h, 0A9362ECEh, 118A49ABh, 33FE645h, 0BB838120h
		dd 0E3E09176h, 5B5CF613h, 49E959FDh, 0F1553E98h, 6C820621h
		dd 0D43E6144h, 0C68BCEAAh, 7E37A9CFh, 0D67F4138h, 6EC3265Dh
		dd 7C7689B3h, 0C4CAEED6h, 591DD66Fh, 0E1A1B10Ah, 0F3141EE4h
		dd 4BA87981h, 13CB69D7h, 0AB770EB2h, 0B9C2A15Ch, 17EC639h
		dd 9CA9FE80h, 241599E5h, 36A0360Bh, 8E1C516Eh, 866616A7h
		dd 3EDA71C2h, 2C6FDE2Ch, 94D3B949h, 90481F0h, 0B1B8E695h
		dd 0A30D497Bh, 1BB12E1Eh, 43D23E48h, 0FB6E592Dh, 0E9DBF6C3h
		dd 516791A6h, 0CCB0A91Fh, 740CCE7Ah, 66B96194h,	0DE0506F1h
		dd 0
		dd 96300777h, 2C610EEEh, 0BA510999h, 19C46D07h,	8FF46A70h
		dd 35A563E9h, 0A395649Eh, 3288DB0Eh, 0A4B8DC79h, 1EE9D5E0h
		dd 88D9D297h, 2B4CB609h, 0BD7CB17Eh, 72DB8E7h, 911DBF90h
		dd 6410B71Dh, 0F220B06Ah, 4871B9F3h, 0DE41BE84h, 7DD4DA1Ah
		dd 0EBE4DD6Dh, 51B5D4F4h, 0C785D383h, 56986C13h, 0C0A86B64h
		dd 7AF962FDh, 0ECC9658Ah, 4F5C0114h, 0D96C0663h, 633D0FFAh
		dd 0F50D088Dh, 0C8206E3Bh, 5E10694Ch, 0E44160D5h, 727167A2h
		dd 0D1E4033Ch, 47D4044Bh, 0FD850DD2h, 6BB50AA5h, 0FAA8B535h
		dd 6C98B242h, 0D6C9BBDBh, 40F9BCACh, 0E36CD832h, 755CDF45h
		dd 0CF0DD6DCh, 593DD1ABh, 0AC30D926h, 3A00DE51h, 8051D7C8h
		dd 1661D0BFh, 0B5F4B421h, 23C4B356h, 9995BACFh,	0FA5BDB8h
		dd 9EB80228h, 888055Fh,	0B2D90CC6h, 24E90BB1h, 877C6F2Fh
		dd 114C6858h, 0AB1D61C1h, 3D2D66B6h, 9041DC76h,	671DB01h
		dd 0BC20D298h, 2A10D5EFh, 8985B171h, 1FB5B606h,	0A5E4BF9Fh
		dd 33D4B8E8h, 0A2C90778h, 34F9000Fh, 8EA80996h,	18980EE1h
		dd 0BB0D6A7Fh, 2D3D6D08h, 976C6491h, 15C63E6h, 0F4516B6Bh
		dd 62616C1Ch, 0D8306585h, 4E0062F2h, 0ED95066Ch, 7BA5011Bh
		dd 0C1F40882h, 57C40FF5h, 0C6D9B065h, 50E9B712h, 0EAB8BE8Bh
		dd 7C88B9FCh, 0DF1DDD62h, 492DDA15h, 0F37CD38Ch, 654CD4FBh
		dd 5861B24Dh, 0CE51B53Ah, 7400BCA3h, 0E230BBD4h, 41A5DF4Ah
		dd 0D795D83Dh, 6DC4D1A4h, 0FBF4D6D3h, 6AE96943h, 0FCD96E34h
		dd 468867ADh, 0D0B860DAh, 732D0444h, 0E51D0333h, 5F4C0AAAh
		dd 0C97C0DDDh, 3C710550h, 0AA410227h, 10100BBEh, 86200CC9h
		dd 25B56857h, 0B3856F20h, 9D466B9h, 9FE461CEh, 0EF9DE5Eh
		dd 98C9D929h, 2298D0B0h, 0B4A8D7C7h, 173DB359h,	810DB42Eh
		dd 3B5CBDB7h, 0AD6CBAC0h, 2083B8EDh, 0B6B3BF9Ah, 0CE2B603h
		dd 9AD2B174h, 3947D5EAh, 0AF77D29Dh, 1526DB04h,	8316DC73h
		dd 120B63E3h, 843B6494h, 3E6A6D0Dh, 0A85A6A7Ah,	0BCF0EE4h
		dd 9DFF0993h, 27AE000Ah, 0B19E077Dh, 44930FF0h,	0D2A30887h
		dd 68F2011Eh, 0FEC20669h, 5D5762F7h, 0CB676580h, 71366C19h
		dd 0E7066B6Eh, 761BD4FEh, 0E02BD389h, 5A7ADA10h, 0CC4ADD67h
		dd 6FDFB9F9h, 0F9EFBE8Eh, 43BEB717h, 0D58EB060h, 0E8A3D6D6h
		dd 7E93D1A1h, 0C4C2D838h, 52F2DF4Fh, 0F167BBD1h, 6757BCA6h
		dd 0DD06B53Fh, 4B36B248h, 0DA2B0DD8h, 4C1B0AAFh, 0F64A0336h
		dd 607A0441h, 0C3EF60DFh, 55DF67A8h, 0EF8E6E31h, 79BE6946h
		dd 8CB361CBh, 1A8366BCh, 0A0D26F25h, 36E26852h,	95770CCCh
		dd 3470BBBh, 0B9160222h, 2F260555h, 0BE3BBAC5h,	280BBDB2h
		dd 925AB42Bh, 46AB35Ch,	0A7FFD7C2h, 31CFD0B5h, 8B9ED92Ch
		dd 1DAEDE5Bh, 0B0C2649Bh, 26F263ECh, 9CA36A75h,	0A936D02h
		dd 0A906099Ch, 3F360EEBh, 85670772h, 13570005h,	824ABF95h
		dd 147AB8E2h, 0AE2BB17Bh, 381BB60Ch, 9B8ED292h,	0DBED5E5h
		dd 0B7EFDC7Ch, 21DFDB0Bh, 0D4D2D386h, 42E2D4F1h, 0F8B3DD68h
		dd 6E83DA1Fh, 0CD16BE81h, 5B26B9F6h, 0E177B06Fh, 7747B718h
		dd 0E65A0888h, 706A0FFFh, 0CA3B0666h, 5C0B0111h, 0FF9E658Fh
		dd 69AE62F8h, 0D3FF6B61h, 45CF6C16h, 78E20AA0h,	0EED20DD7h
		dd 5483044Eh, 0C2B30339h, 612667A7h, 0F71660D0h, 4D476949h
		dd 0DB776E3Eh, 4A6AD1AEh, 0DC5AD6D9h, 660BDF40h, 0F03BD837h
		dd 53AEBCA9h, 0C59EBBDEh, 7FCFB247h, 0E9FFB530h, 1CF2BDBDh
		dd 8AC2BACAh, 3093B353h, 0A6A3B424h, 536D0BAh, 9306D7CDh
		dd 2957DE54h, 0BF67D923h, 2E7A66B3h, 0B84A61C4h, 21B685Dh
		dd 942B6F2Ah, 37BE0BB4h, 0A18E0CC3h, 1BDF055Ah,	8DEF022Dh
		dd 0
		dd 41311B19h, 82623632h, 0C3532D2Bh, 4C56C64h, 45F4777Dh
		dd 86A75A56h, 0C796414Fh, 88AD9C8h, 49BBC2D1h, 8AE8EFFAh
		dd 0CBD9F4E3h, 0C4FB5ACh, 4D7EAEB5h, 8E2D839Eh,	0CF1C9887h
		dd 5112C24Ah, 1023D953h, 0D370F478h, 9241EF61h,	55D7AE2Eh
		dd 14E6B537h, 0D7B5981Ch, 96848305h, 59981B82h,	18A9009Bh
		dd 0DBFA2DB0h, 9ACB36A9h, 5D5D77E6h, 1C6C6CFFh,	0DF3F41D4h
		dd 9E0E5ACDh, 0A2248495h, 0E3159F8Ch, 2046B2A7h, 6177A9BEh
		dd 0A6E1E8F1h, 0E7D0F3E8h, 2483DEC3h, 65B2C5DAh, 0AAAE5D5Dh
		dd 0EB9F4644h, 28CC6B6Fh, 69FD7076h, 0AE6B3139h, 0EF5A2A20h
		dd 2C09070Bh, 6D381C12h, 0F33646DFh, 0B2075DC6h, 715470EDh
		dd 30656BF4h, 0F7F32ABBh, 0B6C231A2h, 75911C89h, 34A00790h
		dd 0FBBC9F17h, 0BA8D840Eh, 79DEA925h, 38EFB23Ch, 0FF79F373h
		dd 0BE48E86Ah, 7D1BC541h, 3C2ADE58h, 54F79F0h, 447E62E9h
		dd 872D4FC2h, 0C61C54DBh, 18A1594h, 40BB0E8Dh, 83E823A6h
		dd 0C2D938BFh, 0DC5A038h, 4CF4BB21h, 8FA7960Ah,	0CE968D13h
		dd 900CC5Ch, 4831D745h,	8B62FA6Eh, 0CA53E177h, 545DBBBAh
		dd 156CA0A3h, 0D63F8D88h, 970E9691h, 5098D7DEh,	11A9CCC7h
		dd 0D2FAE1ECh, 93CBFAF5h, 5CD76272h, 1DE6796Bh,	0DEB55440h
		dd 9F844F59h, 58120E16h, 1923150Fh, 0DA703824h,	9B41233Dh
		dd 0A76BFD65h, 0E65AE67Ch, 2509CB57h, 6438D04Eh, 0A3AE9101h
		dd 0E29F8A18h, 21CCA733h, 60FDBC2Ah, 0AFE124ADh, 0EED03FB4h
		dd 2D83129Fh, 6CB20986h, 0AB2448C9h, 0EA1553D0h, 29467EFBh
		dd 687765E2h, 0F6793F2Fh, 0B7482436h, 741B091Dh, 352A1204h
		dd 0F2BC534Bh, 0B38D4852h, 70DE6579h, 31EF7E60h, 0FEF3E6E7h
		dd 0BFC2FDFEh, 7C91D0D5h, 3DA0CBCCh, 0FA368A83h, 0BB07919Ah
		dd 7854BCB1h, 3965A7A8h, 4B98833Bh, 0AA99822h, 0C9FAB509h
		dd 88CBAE10h, 4F5DEF5Fh, 0E6CF446h, 0CD3FD96Dh,	8C0EC274h
		dd 43125AF3h, 22341EAh,	0C1706CC1h, 804177D8h, 47D73697h
		dd 6E62D8Eh, 0C5B500A5h, 84841BBCh, 1A8A4171h, 5BBB5A68h
		dd 98E87743h, 0D9D96C5Ah, 1E4F2D15h, 5F7E360Ch,	9C2D1B27h
		dd 0DD1C003Eh, 120098B9h, 533183A0h, 9062AE8Bh,	0D153B592h
		dd 16C5F4DDh, 57F4EFC4h, 94A7C2EFh, 0D596D9F6h,	0E9BC07AEh
		dd 0A88D1CB7h, 6BDE319Ch, 2AEF2A85h, 0ED796BCAh, 0AC4870D3h
		dd 6F1B5DF8h, 2E2A46E1h, 0E136DE66h, 0A007C57Fh, 6354E854h
		dd 2265F34Dh, 0E5F3B202h, 0A4C2A91Bh, 67918430h, 26A09F29h
		dd 0B8AEC5E4h, 0F99FDEFDh, 3ACCF3D6h, 7BFDE8CFh, 0BC6BA980h
		dd 0FD5AB299h, 3E099FB2h, 7F3884ABh, 0B0241C2Ch, 0F1150735h
		dd 32462A1Eh, 73773107h, 0B4E17048h, 0F5D06B51h, 3683467Ah
		dd 77B25D63h, 4ED7FACBh, 0FE6E1D2h, 0CCB5CCF9h,	8D84D7E0h
		dd 4A1296AFh, 0B238DB6h, 0C870A09Dh, 8941BB84h,	465D2303h
		dd 76C381Ah, 0C43F1531h, 850E0E28h, 42984F67h, 3A9547Eh
		dd 0C0FA7955h, 81CB624Ch, 1FC53881h, 5EF42398h,	9DA70EB3h
		dd 0DC9615AAh, 1B0054E5h, 5A314FFCh, 996262D7h,	0D85379CEh
		dd 174FE149h, 567EFA50h, 952DD77Bh, 0D41CCC62h,	138A8D2Dh
		dd 52BB9634h, 91E8BB1Fh, 0D0D9A006h, 0ECF37E5Eh, 0ADC26547h
		dd 6E91486Ch, 2FA05375h, 0E836123Ah, 0A9070923h, 6A542408h
		dd 2B653F11h, 0E479A796h, 0A548BC8Fh, 661B91A4h, 272A8ABDh
		dd 0E0BCCBF2h, 0A18DD0EBh, 62DEFDC0h, 23EFE6D9h, 0BDE1BC14h
		dd 0FCD0A70Dh, 3F838A26h, 7EB2913Fh, 0B924D070h, 0F815CB69h
		dd 3B46E642h, 7A77FD5Bh, 0B56B65DCh, 0F45A7EC5h, 370953EEh
		dd 763848F7h, 0B1AE09B8h, 0F09F12A1h, 33CC3F8Ah, 72FD2493h
		dd 0
		dd 376AC201h, 6ED48403h, 59BE4602h, 0DCA80907h,	0EBC2CB06h
		dd 0B27C8D04h, 85164F05h, 0B851130Eh, 8F3BD10Fh, 0D685970Dh
		dd 0E1EF550Ch, 64F91A09h, 5393D808h, 0A2D9E0Ah,	3D475C0Bh
		dd 70A3261Ch, 47C9E41Dh, 1E77A21Fh, 291D601Eh, 0AC0B2F1Bh
		dd 9B61ED1Ah, 0C2DFAB18h, 0F5B56919h, 0C8F23512h, 0FF98F713h
		dd 0A626B111h, 914C7310h, 145A3C15h, 2330FE14h,	7A8EB816h
		dd 4DE47A17h, 0E0464D38h, 0D72C8F39h, 8E92C93Bh, 0B9F80B3Ah
		dd 3CEE443Fh, 0B84863Eh, 523AC03Ch, 6550023Dh, 58175E36h
		dd 6F7D9C37h, 36C3DA35h, 1A91834h, 84BF5731h, 0B3D59530h
		dd 0EA6BD332h, 0DD011133h, 90E56B24h, 0A78FA925h, 0FE31EF27h
		dd 0C95B2D26h, 4C4D6223h, 7B27A022h, 2299E620h,	15F32421h
		dd 28B4782Ah, 1FDEBA2Bh, 4660FC29h, 710A3E28h, 0F41C712Dh
		dd 0C376B32Ch, 9AC8F52Eh, 0ADA2372Fh, 0C08D9A70h, 0F7E75871h
		dd 0AE591E73h, 9933DC72h, 1C259377h, 2B4F5176h,	72F11774h
		dd 459BD575h, 78DC897Eh, 4FB64B7Fh, 16080D7Dh, 2162CF7Ch
		dd 0A4748079h, 931E4278h, 0CAA0047Ah, 0FDCAC67Bh, 0B02EBC6Ch
		dd 87447E6Dh, 0DEFA386Fh, 0E990FA6Eh, 6C86B56Bh, 5BEC776Ah
		dd 2523168h, 3538F369h,	87FAF62h, 3F156D63h, 66AB2B61h
		dd 51C1E960h, 0D4D7A665h, 0E3BD6464h, 0BA032266h, 8D69E067h
		dd 20CBD748h, 17A11549h, 4E1F534Bh, 7975914Ah, 0FC63DE4Fh
		dd 0CB091C4Eh, 92B75A4Ch, 0A5DD984Dh, 989AC446h, 0AFF00647h
		dd 0F64E4045h, 0C1248244h, 4432CD41h, 73580F40h, 2AE64942h
		dd 1D8C8B43h, 5068F154h, 67023355h, 3EBC7557h, 9D6B756h
		dd 8CC0F853h, 0BBAA3A52h, 0E2147C50h, 0D57EBE51h, 0E839E25Ah
		dd 0DF53205Bh, 86ED6659h, 0B187A458h, 3491EB5Dh, 3FB295Ch
		dd 5A456F5Eh, 6D2FAD5Fh, 801B35E1h, 0B771F7E0h,	0EECFB1E2h
		dd 0D9A573E3h, 5CB33CE6h, 6BD9FEE7h, 3267B8E5h,	50D7AE4h
		dd 384A26EFh, 0F20E4EEh, 569EA2ECh, 61F460EDh, 0E4E22FE8h
		dd 0D388EDE9h, 8A36ABEBh, 0BD5C69EAh, 0F0B813FDh, 0C7D2D1FCh
		dd 9E6C97FEh, 0A90655FFh, 2C101AFAh, 1B7AD8FBh,	42C49EF9h
		dd 75AE5CF8h, 48E900F3h, 7F83C2F2h, 263D84F0h, 115746F1h
		dd 944109F4h, 0A32BCBF5h, 0FA958DF7h, 0CDFF4FF6h, 605D78D9h
		dd 5737BAD8h, 0E89FCDAh, 39E33EDBh, 0BCF571DEh,	8B9FB3DFh
		dd 0D221F5DDh, 0E54B37DCh, 0D80C6BD7h, 0EF66A9D6h, 0B6D8EFD4h
		dd 81B22DD5h, 4A462D0h,	33CEA0D1h, 6A70E6D3h, 5D1A24D2h
		dd 10FE5EC5h, 27949CC4h, 7E2ADAC6h, 494018C7h, 0CC5657C2h
		dd 0FB3C95C3h, 0A282D3C1h, 95E811C0h, 0A8AF4DCBh, 9FC58FCAh
		dd 0C67BC9C8h, 0F1110BC9h, 740744CCh, 436D86CDh, 1AD3C0CFh
		dd 2DB902CEh, 4096AF91h, 77FC6D90h, 2E422B92h, 1928E993h
		dd 9C3EA696h, 0AB546497h, 0F2EA2295h, 0C580E094h, 0F8C7BC9Fh
		dd 0CFAD7E9Eh, 9613389Ch, 0A179FA9Dh, 246FB598h, 13057799h
		dd 4ABB319Bh, 7DD1F39Ah, 3035898Dh, 75F4B8Ch, 5EE10D8Eh
		dd 698BCF8Fh, 0EC9D808Ah, 0DBF7428Bh, 82490489h, 0B523C688h
		dd 88649A83h, 0BF0E5882h, 0E6B01E80h, 0D1DADC81h, 54CC9384h
		dd 63A65185h, 3A181787h, 0D72D586h, 0A0D0E2A9h,	97BA20A8h
		dd 0CE0466AAh, 0F96EA4ABh, 7C78EBAEh, 4B1229AFh, 12AC6FADh
		dd 25C6ADACh, 1881F1A7h, 2FEB33A6h, 765575A4h, 413FB7A5h
		dd 0C429F8A0h, 0F3433AA1h, 0AAFD7CA3h, 9D97BEA2h, 0D073C4B5h
		dd 0E71906B4h, 0BEA740B6h, 89CD82B7h, 0CDBCDB2h, 3BB10FB3h
		dd 620F49B1h, 55658BB0h, 6822D7BBh, 5F4815BAh, 6F653B8h
		dd 319C91B9h, 0B48ADEBCh, 83E01CBDh, 0DA5E5ABFh, 0ED3498BEh
		dd 0
		dd 6567BCB8h, 8BC809AAh, 0EEAFB512h, 5797628Fh,	32F0DE37h
		dd 0DC5F6B25h, 0B938D79Dh, 0EF28B4C5h, 8A4F087Dh, 64E0BD6Fh
		dd 18701D7h, 0B8BFD64Ah, 0DDD86AF2h, 3377DFE0h,	56106358h
		dd 9F571950h, 0FA30A5E8h, 149F10FAh, 71F8AC42h,	0C8C07BDFh
		dd 0ADA7C767h, 43087275h, 266FCECDh, 707FAD95h,	1518112Dh
		dd 0FBB7A43Fh, 9ED01887h, 27E8CF1Ah, 428F73A2h,	0AC20C6B0h
		dd 0C9477A08h, 3EAF32A0h, 5BC88E18h, 0B5673B0Ah, 0D00087B2h
		dd 6938502Fh, 0C5FEC97h, 0E2F05985h, 8797E53Dh,	0D1878665h
		dd 0B4E03ADDh, 5A4F8FCFh, 3F283377h, 8610E4EAh,	0E3775852h
		dd 0DD8ED40h, 68BF51F8h, 0A1F82BF0h, 0C49F9748h, 2A30225Ah
		dd 4F579EE2h, 0F66F497Fh, 9308F5C7h, 7DA740D5h,	18C0FC6Dh
		dd 4ED09F35h, 2BB7238Dh, 0C518969Fh, 0A07F2A27h, 1947FDBAh
		dd 7C204102h, 928FF410h, 0F7E848A8h, 3D58149Bh,	583FA823h
		dd 0B6901D31h, 0D3F7A189h, 6ACF7614h, 0FA8CAACh, 0E1077FBEh
		dd 8460C306h, 0D270A05Eh, 0B7171CE6h, 59B8A9F4h, 3CDF154Ch
		dd 85E7C2D1h, 0E0807E69h, 0E2FCB7Bh, 6B4877C3h,	0A20F0DCBh
		dd 0C768B173h, 29C70461h, 4CA0B8D9h, 0F5986F44h, 90FFD3FCh
		dd 7E5066EEh, 1B37DA56h, 4D27B90Eh, 284005B6h, 0C6EFB0A4h
		dd 0A3880C1Ch, 1AB0DB81h, 7FD76739h, 9178D22Bh,	0F41F6E93h
		dd 3F7263Bh, 66909A83h,	883F2F91h, 0ED589329h, 546044B4h
		dd 3107F80Ch, 0DFA84D1Eh, 0BACFF1A6h, 0ECDF92FEh, 89B82E46h
		dd 67179B54h, 27027ECh,	0BB48F071h, 0DE2F4CC9h,	3080F9DBh
		dd 55E74563h, 9CA03F6Bh, 0F9C783D3h, 176836C1h,	720F8A79h
		dd 0CB375DE4h, 0AE50E15Ch, 40FF544Eh, 2598E8F6h, 73888BAEh
		dd 16EF3716h, 0F8408204h, 9D273EBCh, 241FE921h,	41785599h
		dd 0AFD7E08Bh, 0CAB05C33h, 3BB659EDh, 5ED1E555h, 0B07E5047h
		dd 0D519ECFFh, 6C213B62h, 94687DAh, 0E7E932C8h,	828E8E70h
		dd 0D49EED28h, 0B1F95190h, 5F56E482h, 3A31583Ah, 83098FA7h
		dd 0E66E331Fh, 8C1860Dh, 6DA63AB5h, 0A4E140BDh,	0C186FC05h
		dd 2F294917h, 4A4EF5AFh, 0F3762232h, 96119E8Ah,	78BE2B98h
		dd 1DD99720h, 4BC9F478h, 2EAE48C0h, 0C001FDD2h,	0A566416Ah
		dd 1C5E96F7h, 79392A4Fh, 97969F5Dh, 0F2F123E5h,	5196B4Dh
		dd 607ED7F5h, 8ED162E7h, 0EBB6DE5Fh, 528E09C2h,	37E9B57Ah
		dd 0D9460068h, 0BC21BCD0h, 0EA31DF88h, 8F566330h, 61F9D622h
		dd 49E6A9Ah, 0BDA6BD07h, 0D8C101BFh, 366EB4ADh,	53090815h
		dd 9A4E721Dh, 0FF29CEA5h, 11867BB7h, 74E1C70Fh,	0CDD91092h
		dd 0A8BEAC2Ah, 46111938h, 2376A580h, 7566C6D8h,	10017A60h
		dd 0FEAECF72h, 9BC973CAh, 22F1A457h, 479618EFh,	0A939ADFDh
		dd 0CC5E1145h, 6EE4D76h, 6389F1CEh, 8D2644DCh, 0E841F864h
		dd 51792FF9h, 341E9341h, 0DAB12653h, 0BFD69AEBh, 0E9C6F9B3h
		dd 8CA1450Bh, 620EF019h, 7694CA1h, 0BE519B3Ch, 0DB362784h
		dd 35999296h, 50FE2E2Eh, 99B95426h, 0FCDEE89Eh,	12715D8Ch
		dd 7716E134h, 0CE2E36A9h, 0AB498A11h, 45E63F03h, 208183BBh
		dd 7691E0E3h, 13F65C5Bh, 0FD59E949h, 983E55F1h,	2106826Ch
		dd 44613ED4h, 0AACE8BC6h, 0CFA9377Eh, 38417FD6h, 5D26C36Eh
		dd 0B389767Ch, 0D6EECAC4h, 6FD61D59h, 0AB1A1E1h, 0E41E14F3h
		dd 8179A84Bh, 0D769CB13h, 0B20E77ABh, 5CA1C2B9h, 39C67E01h
		dd 80FEA99Ch, 0E5991524h, 0B36A036h, 6E511C8Eh,	0A7166686h
		dd 0C271DA3Eh, 2CDE6F2Ch, 49B9D394h, 0F0810409h, 95E6B8B1h
		dd 7B490DA3h, 1E2EB11Bh, 483ED243h, 2D596EFBh, 0C3F6DBE9h
		dd 0A6916751h, 1FA9B0CCh, 7ACE0C74h, 9461B966h,	0F10605DEh
dword_100331E0	dd 0			; DATA XREF: sub_100275A0:loc_10027729r
					; .data:10037154o
		align 20h
		dd 4 dup(1), 4 dup(2), 4 dup(3), 4 dup(4), 4 dup(5)
		db 0
byte_10033251	db 0			; DATA XREF: sub_10027EE0+76r
byte_10033252	db 0			; DATA XREF: sub_10027EE0+64r
byte_10033253	db 0			; DATA XREF: sub_10027EE0+52r
byte_10033254	db 10h			; DATA XREF: sub_10027340+1A6r
					; sub_10027EE0:loc_10027F20r
		db 11h,	12h, 0
		dd 6090708h, 40B050Ah, 20D030Ch, 0F010Eh
dword_10033268	dd 0			; DATA XREF: sub_100275A0:loc_10027862r
					; .data:10037168o
		dd 3 dup(0)
dword_10033278	dd 2 dup(1), 2 dup(2), 2 dup(3), 2 dup(4), 2 dup(5), 2 dup(6)
		dd 2 dup(7), 2 dup(8), 2 dup(9), 2 dup(0Ah), 2 dup(0Bh)
		dd 2 dup(0Ch), 2 dup(0Dh), 10h dup(0)
		dd 2, 3, 7, 0
dword_10033330	dd 8000Ch, 8008Ch, 8004Ch, 800CCh, 8002Ch, 800ACh, 8006Ch
					; DATA XREF: sub_10028260+1DCo
					; .data:off_10037150o
		dd 800ECh, 8001Ch, 8009Ch, 8005Ch, 800DCh, 8003Ch, 800BCh
		dd 8007Ch, 800FCh, 80002h, 80082h, 80042h, 800C2h, 80022h
		dd 800A2h, 80062h, 800E2h, 80012h, 80092h, 80052h, 800D2h
		dd 80032h, 800B2h, 80072h, 800F2h, 8000Ah, 8008Ah, 8004Ah
		dd 800CAh, 8002Ah, 800AAh, 8006Ah, 800EAh, 8001Ah, 8009Ah
		dd 8005Ah, 800DAh, 8003Ah, 800BAh, 8007Ah, 800FAh, 80006h
		dd 80086h, 80046h, 800C6h, 80026h, 800A6h, 80066h, 800E6h
		dd 80016h, 80096h, 80056h, 800D6h, 80036h, 800B6h, 80076h
		dd 800F6h, 8000Eh, 8008Eh, 8004Eh, 800CEh, 8002Eh, 800AEh
		dd 8006Eh, 800EEh, 8001Eh, 8009Eh, 8005Eh, 800DEh, 8003Eh
		dd 800BEh, 8007Eh, 800FEh, 80001h, 80081h, 80041h, 800C1h
		dd 80021h, 800A1h, 80061h, 800E1h, 80011h, 80091h, 80051h
		dd 800D1h, 80031h, 800B1h, 80071h, 800F1h, 80009h, 80089h
		dd 80049h, 800C9h, 80029h, 800A9h, 80069h, 800E9h, 80019h
		dd 80099h, 80059h, 800D9h, 80039h, 800B9h, 80079h, 800F9h
		dd 80005h, 80085h, 80045h, 800C5h, 80025h, 800A5h, 80065h
		dd 800E5h, 80015h, 80095h, 80055h, 800D5h, 80035h, 800B5h
		dd 80075h, 800F5h, 8000Dh, 8008Dh, 8004Dh, 800CDh, 8002Dh
		dd 800ADh, 8006Dh, 800EDh, 8001Dh, 8009Dh, 8005Dh, 800DDh
		dd 8003Dh, 800BDh, 8007Dh, 800FDh, 90013h, 90113h, 90093h
		dd 90193h, 90053h, 90153h, 900D3h, 901D3h, 90033h, 90133h
		dd 900B3h, 901B3h, 90073h, 90173h, 900F3h, 901F3h, 9000Bh
		dd 9010Bh, 9008Bh, 9018Bh, 9004Bh, 9014Bh, 900CBh, 901CBh
		dd 9002Bh, 9012Bh, 900ABh, 901ABh, 9006Bh, 9016Bh, 900EBh
		dd 901EBh, 9001Bh, 9011Bh, 9009Bh, 9019Bh, 9005Bh, 9015Bh
		dd 900DBh, 901DBh, 9003Bh, 9013Bh, 900BBh, 901BBh, 9007Bh
		dd 9017Bh, 900FBh, 901FBh, 90007h, 90107h, 90087h, 90187h
		dd 90047h, 90147h, 900C7h, 901C7h, 90027h, 90127h, 900A7h
		dd 901A7h, 90067h, 90167h, 900E7h, 901E7h, 90017h, 90117h
		dd 90097h, 90197h, 90057h, 90157h, 900D7h, 901D7h, 90037h
		dd 90137h, 900B7h, 901B7h, 90077h, 90177h, 900F7h, 901F7h
		dd 9000Fh, 9010Fh, 9008Fh, 9018Fh, 9004Fh, 9014Fh, 900CFh
		dd 901CFh, 9002Fh, 9012Fh, 900AFh, 901AFh, 9006Fh, 9016Fh
		dd 900EFh, 901EFh, 9001Fh, 9011Fh, 9009Fh, 9019Fh, 9005Fh
		dd 9015Fh, 900DFh, 901DFh, 9003Fh, 9013Fh, 900BFh, 901BFh
		dd 9007Fh, 9017Fh, 900FFh, 901FFh, 70000h, 70040h, 70020h
		dd 70060h, 70010h, 70050h, 70030h, 70070h, 70008h, 70048h
		dd 70028h, 70068h, 70018h, 70058h, 70038h, 70078h, 70004h
		dd 70044h, 70024h, 70064h, 70014h, 70054h, 70034h, 70074h
		dd 80003h, 80083h, 80043h, 800C3h, 80023h, 800A3h, 80063h
		dd 800E3h
dword_100337B0	dd 50000h, 50010h, 50008h, 50018h, 50004h, 50014h, 5000Ch
					; DATA XREF: sub_10028260:loc_10028437o
					; .data:off_10037164o
		dd 5001Ch, 50002h, 50012h, 5000Ah, 5001Ah, 50006h, 50016h
		dd 5000Eh, 5001Eh, 50001h, 50011h, 50009h, 50019h, 50005h
		dd 50015h, 5000Dh, 5001Dh, 50003h, 50013h, 5000Bh, 5001Bh
		dd 50007h, 50017h
byte_10033828	db 0			; DATA XREF: sub_100234D0+116r
					; sub_100237F0+171r ...
		db 1, 2, 3
		dd 5050404h, 6060606h, 7070707h, 2 dup(8080808h), 2 dup(9090909h)
		dd 4 dup(0A0A0A0Ah), 4 dup(0B0B0B0Bh), 8 dup(0C0C0C0Ch)
		dd 8 dup(0D0D0D0Dh), 10h dup(0E0E0E0Eh), 10h dup(0F0F0F0Fh)
byte_10033928	db 0			; DATA XREF: sub_100234D0+125r
					; sub_100237F0+180r ...
		align 2
		dw 1110h
		dd 13131212h, 14141414h, 15151515h, 2 dup(16161616h), 2	dup(17171717h)
		dd 4 dup(18181818h), 4 dup(19191919h), 8 dup(1A1A1A1Ah)
		dd 8 dup(1B1B1B1Bh), 10h dup(1C1C1C1Ch), 10h dup(1D1D1D1Dh)
byte_10033A28	db 0			; DATA XREF: sub_100234D0+EDr
					; sub_100237F0+148r ...
		db 1, 2, 3
		dd 7060504h, 9090808h, 0B0B0A0Ah, 0C0C0C0Ch, 0D0D0D0Dh
		dd 0E0E0E0Eh, 0F0F0F0Fh, 2 dup(10101010h), 2 dup(11111111h)
		dd 2 dup(12121212h), 2 dup(13131313h), 4 dup(14141414h)
		dd 4 dup(15151515h), 4 dup(16161616h), 4 dup(17171717h)
		dd 8 dup(18181818h), 8 dup(19191919h), 8 dup(1A1A1A1Ah)
		dd 7 dup(1B1B1B1Bh), 1C1B1B1Bh
dword_10033B28	dd 0			; DATA XREF: sub_100275A0+19Er
		dd 1, 2, 3, 4, 5, 6, 7,	8, 0Ah,	0Ch, 0Eh, 10h, 14h, 18h
		dd 1Ch,	20h, 28h, 30h, 38h, 40h, 50h, 60h, 70h,	80h, 0A0h
		dd 0C0h, 0E0h, 2 dup(0)
dword_10033BA0	dd 0			; DATA XREF: sub_100275A0+2D7r
		dd 1, 2, 3, 4, 6, 8, 0Ch, 10h, 18h, 20h, 30h, 40h, 60h
		dd 80h,	0C0h, 100h, 180h, 200h,	300h, 400h, 600h, 800h
		dd 0C00h, 1000h, 1800h,	2000h, 3000h, 4000h, 6000h
aIncompatibleVe	db 'incompatible version',0 ; DATA XREF: .rdata:10033CB8o
		align 10h
aBufferError	db 'buffer error',0     ; DATA XREF: .rdata:off_10033CB4o
		align 10h
aInsufficientMe	db 'insufficient memory',0 ; DATA XREF: .rdata:off_10033CB0o
aDataError	db 'data error',0       ; DATA XREF: .rdata:10033CACo
		align 10h
aStreamError	db 'stream error',0     ; DATA XREF: .rdata:off_10033CA8o
		align 10h
aFileError	db 'file error',0       ; DATA XREF: .rdata:10033CA4o
unk_10033C7B	db    0			; DATA XREF: .rdata:10033CA0o
					; .rdata:10033CBCo
aStreamEnd	db 'stream end',0       ; DATA XREF: .rdata:10033C9Co
		align 4
aNeedDictionary	db 'need dictionary',0  ; DATA XREF: .rdata:10033C98o
		dd offset aNeedDictionary ; "need dictionary"
		dd offset aStreamEnd	; "stream end"
		dd offset unk_10033C7B
		dd offset aFileError	; "file	error"
off_10033CA8	dd offset aStreamError	; DATA XREF: sub_100240F0:loc_10024908r
					; "stream error"
		dd offset aDataError	; "data	error"
off_10033CB0	dd offset aInsufficientMe ; DATA XREF: sub_10024920+1F8r
					; "insufficient	memory"
off_10033CB4	dd offset aBufferError	; DATA XREF: sub_100240F0+58r
					; sub_100240F0+605r ...
					; "buffer error"
		dd offset aIncompatibleVe ; "incompatible version"
		dd offset unk_10033C7B
aInflate1_2_5Co	db ' inflate 1.2.5 Copyright 1995-2010 Mark Adler ',0
		align 10h
dword_10033CF0	dd 40003h, 60005h, 80007h, 0A0009h, 0D000Bh, 11000Fh, 170013h
					; DATA XREF: sub_100288F0:loc_10028AC7o
		dd 1F001Bh, 2B0023h, 3B0033h, 530043h, 730063h,	0A30083h
		dd 0E300C3h, 102h, 0
dword_10033D30	dd 4 dup(100010h), 2 dup(110011h), 2 dup(120012h), 2 dup(130013h)
					; DATA XREF: sub_100288F0+1E5o
		dd 2 dup(140014h), 2 dup(150015h), 490010h, 0C3h
dword_10033D70	dd 20001h, 40003h, 70005h, 0D0009h, 190011h, 310021h, 610041h
					; DATA XREF: sub_100288F0+1C1o
		dd 0C10081h, 1810101h, 3010201h, 6010401h, 0C010801h, 18011001h
		dd 30012001h, 60014001h, 0
dword_10033DB0	dd 2 dup(100010h), 110011h, 120012h, 130013h, 140014h
					; DATA XREF: sub_100288F0+1C9o
		dd 150015h, 160016h, 170017h, 180018h, 190019h,	1A001Ah
		dd 1B001Bh, 1C001Ch, 1D001Dh, 400040h, 0
; struct _EXCEPTION_POINTERS ExceptionInfo
ExceptionInfo	_EXCEPTION_POINTERS <offset dword_10037B78, offset dword_10037BC8>
					; DATA XREF: sub_10029911+C3o
		align 10h
		dd 86808006h, 808180h, 86031000h, 80828680h, 45050514h
		dd 85854545h, 585h, 50803030h, 8008080h, 38272800h, 805750h
		dd 30370007h, 88505030h, 20000000h, 80888028h, 80h
aHhhXppwpp	db '```hhh',8,8,7,'xppwpp',8,8,0
		dw 800h
		dd 7000800h, 8,	0
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 2			; SEHandlerCount
		align 10h
___safe_se_handler_table dd rva	sub_10029260 ; DATA XREF: .rdata:10033EA0o
		dd rva sub_10029C31
dword_10033EB8	dd 0FFFFFFFEh, 0	; DATA XREF: DllEntryPoint-25Ao
		dd 0FFFFFFB4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_100298F0
		dd 0
		dd offset sub_10029700
		dd offset sub_10029714
		dd 0
		dd offset sub_10029742
		dd offset sub_10029756
		align 10h
		dd offset sub_10029785
		dd offset sub_10029799
		dd 0
		dd offset sub_100297CA
		dd offset sub_100297DE
		align 8
		dd offset sub_100297F9
		dd offset sub_1002980D
		dd 0
		dd offset sub_1002982E
		dd offset sub_10029842
		align 10h
		dd offset sub_10029873
		dd offset sub_10029887
		dd 0
		dd offset sub_100298BA
		dd offset sub_100298CE
		align 8
stru_10033F38	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10029B54+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10029B54
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10029B9A	; ScopeRecord.FilterFunc
		dd offset loc_10029BAE	; ScopeRecord.HandlerFunc
__IMPORT_DESCRIPTOR_nss3 dd rva	off_10034154 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aNss3_dll	; DLL Name
		dd rva __imp_SECKEY_CreateECPrivateKey ; Import	Address	Table
__IMPORT_DESCRIPTOR_nssutil3 dd	rva off_10034340 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aNssutil3_dll	; DLL Name
		dd rva __imp_SECOID_FindOID_Util ; Import Address Table
__IMPORT_DESCRIPTOR_libplc4 dd rva off_10034100	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aLibplc4_dll	; DLL Name
		dd rva __imp_PL_strdup	; Import Address Table
__IMPORT_DESCRIPTOR_libnspr4 dd	rva off_1003402C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aLibnspr4_dll	; DLL Name
		dd rva PR_Free		; Import Address Table
__IMPORT_DESCRIPTOR_msvcrt dd rva off_10034108 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcrt_dll	; DLL Name
		dd rva __imp_memcpy	; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_10033FE0 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva GetCurrentProcessId ; Import Address Table
		align 20h
;
; Import names for KERNEL32.dll
;
off_10033FE0	dd rva word_1003569A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_100356B0
		dd rva word_100356C0
		dd rva word_100356D0
		dd rva word_100356DE
		dd rva word_100356EE
		dd rva word_10035704
		dd rva word_1003571A
		dd rva word_10035726
		dd rva word_1003573C
		dd rva word_10035744
		dd rva word_10035762
		dd rva word_10035776
		dd rva word_1003578A
		dd rva word_100357A6
		dd rva word_100357C4
		dd rva word_100357DE
		dd rva word_100357EE
		dd 0
;
; Import names for libnspr4.dll
;
off_1003402C	dd rva word_1003556E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_libnspr4o
		dd rva word_1003551C
		dd rva word_100351DC
		dd rva word_100351EE
		dd rva word_1003520A
		dd rva word_1003521C
		dd rva word_1003522E
		dd rva word_10035244
		dd rva word_10035256
		dd rva word_10035262
		dd rva word_1003526C
		dd rva word_1003527A
		dd rva word_10035290
		dd rva word_1003529E
		dd rva word_100352AC
		dd rva word_100352B8
		dd rva word_100352CC
		dd rva word_100352DE
		dd rva word_100352F4
		dd rva word_100352FE
		dd rva word_1003530E
		dd rva word_10035326
		dd rva word_10035334
		dd rva word_1003534A
		dd rva word_10035360
		dd rva word_10035374
		dd rva word_10035386
		dd rva word_10035396
		dd rva word_100353A8
		dd rva word_100353B6
		dd rva word_100353C2
		dd rva word_100353D6
		dd rva word_100353EC
		dd rva word_100353FA
		dd rva word_10035416
		dd rva word_10035434
		dd rva word_1003544A
		dd rva word_10035462
		dd rva word_1003547A
		dd rva word_1003548E
		dd rva word_100354AA
		dd rva word_100354C0
		dd rva word_100354DA
		dd rva word_100354F2
		dd rva word_100355C0
		dd rva word_100355A8
		dd rva word_10035594
		dd rva word_10035578
		dd rva word_1003552C
		dd rva word_10035552
		dd rva word_10035538
		dd rva word_10035504
		dd 0
;
; Import names for libplc4.dll
;
off_10034100	dd rva word_100351C4	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_libplc4o
		dd 0
;
; Import names for msvcrt.dll
;
off_10034108	dd rva word_100355DA	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_msvcrto
		dd rva word_100355E4
		dd rva word_100355EE
		dd rva word_100355F8
		dd rva word_10035602
		dd rva word_1003560C
		dd rva word_10035616
		dd rva word_1003561E
		dd rva word_10035628
		dd rva word_10035632
		dd rva word_1003563A
		dd rva word_10035642
		dd rva word_1003564A
		dd rva word_10035654
		dd rva word_1003565E
		dd rva word_10035672
		dd rva word_10035680
		dd rva word_1003568C
		dd 0
;
; Import names for nss3.dll
;
off_10034154	dd rva word_10034464	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_nss3o
		dd rva word_10034448
		dd rva word_1003442E
		dd rva word_10034480
		dd rva word_100343FE
		dd rva word_100343E6
		dd rva word_10034498
		dd rva word_100344B0
		dd rva word_100344C6
		dd rva word_100344E2
		dd rva word_100344F2
		dd rva word_100343D4
		dd rva word_10034500
		dd rva word_1003451C
		dd rva word_10034538
		dd rva word_10034554
		dd rva word_1003456C
		dd rva word_10034580
		dd rva word_10034596
		dd rva word_100345B2
		dd rva word_10034E50
		dd rva word_10034E3A
		dd rva word_10034E1E
		dd rva word_10034E06
		dd rva word_10034DEE
		dd rva word_10034DD2
		dd rva word_10034DBC
		dd rva word_10034DA4
		dd rva word_10034D90
		dd rva word_10034D72
		dd rva word_10034D5C
		dd rva word_10034D34
		dd rva word_10034D1E
		dd rva word_10034D06
		dd rva word_10034CEC
		dd rva word_10034CD8
		dd rva word_10034CC2
		dd rva word_10034CAC
		dd rva word_10034C9C
		dd rva word_10034C84
		dd rva word_10034C70
		dd rva word_10034C5C
		dd rva word_10034C50
		dd rva word_10034C42
		dd rva word_10034C38
		dd rva word_10034C22
		dd rva word_10034C10
		dd rva word_10034C04
		dd rva word_10034BF6
		dd rva word_10034BEC
		dd rva word_10034BD6
		dd rva word_10034BC0
		dd rva word_10034BAA
		dd rva word_10034B96
		dd rva word_10034B76
		dd rva word_10034B60
		dd rva word_10034B38
		dd rva word_10034B26
		dd rva word_10034B10
		dd rva word_10034AFC
		dd rva word_10034AE8
		dd rva word_10034ACE
		dd rva word_10034AB6
		dd rva word_10034A9C
		dd rva word_10034A84
		dd rva word_10034A6A
		dd rva word_10034A4C
		dd rva word_10034A38
		dd rva word_10034A22
		dd rva word_10034A04
		dd rva word_100349E8
		dd rva word_100349D6
		dd rva word_100349BA
		dd rva word_100349A2
		dd rva word_10034984
		dd rva word_10034966
		dd rva word_1003494A
		dd rva word_10034938
		dd rva word_1003491C
		dd rva word_1003490A
		dd rva word_100348F6
		dd rva word_100348E4
		dd rva word_100348CA
		dd rva word_100348B6
		dd rva word_1003489E
		dd rva word_10034886
		dd rva word_10034864
		dd rva word_10034852
		dd rva word_1003483E
		dd rva word_10034826
		dd rva word_10034810
		dd rva word_100347FE
		dd rva word_100347F0
		dd rva word_100347DA
		dd rva word_100347C2
		dd rva word_100347AE
		dd rva word_1003479C
		dd rva word_10034786
		dd rva word_10034774
		dd rva word_10034760
		dd rva word_1003474E
		dd rva word_1003473C
		dd rva word_10034726
		dd rva word_10034712
		dd rva word_10034702
		dd rva word_100346EE
		dd rva word_100346D0
		dd rva word_100346BC
		dd rva word_100346AC
		dd rva word_1003469C
		dd rva word_1003468C
		dd rva word_10034678
		dd rva word_10034662
		dd rva word_10034652
		dd rva word_10034638
		dd rva word_10034622
		dd rva word_10034608
		dd rva word_100345EE
		dd rva word_100345E0
		dd rva word_100345CC
		dd rva word_10034416
		dd rva word_100345C0
		dd 0
;
; Import names for nssutil3.dll
;
off_10034340	dd rva word_100351A0	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_nssutil3o
		dd rva word_10035184
		dd rva word_1003516C
		dd rva word_10035158
		dd rva word_10035142
		dd rva word_1003512E
		dd rva word_10035114
		dd rva word_100350FC
		dd rva word_100350E4
		dd rva word_100350D2
		dd rva word_100350A4
		dd rva word_10035090
		dd rva word_10035076
		dd rva word_1003505C
		dd rva word_10035046
		dd rva word_10035032
		dd rva word_1003501E
		dd rva word_10035006
		dd rva word_10034FF0
		dd rva word_10034FD8
		dd rva word_10034FC2
		dd rva word_10034FAA
		dd rva word_10034F96
		dd rva word_10034F7A
		dd rva word_10034F64
		dd rva word_10034F48
		dd rva word_10034F2A
		dd rva word_10034F10
		dd rva word_10034EF4
		dd rva word_10034EE2
		dd rva word_10034ECE
		dd rva word_10034EBC
		dd rva word_10034EA4
		dd rva word_10034E92
		dd rva word_10034E7C
		dd rva word_100350C2
		dd 0
word_100343D4	dw 189h			; DATA XREF: .rdata:10034180o
		db 'PK11_FreeSymKey',0
word_100343E6	dw 170h			; DATA XREF: .rdata:10034168o
		db 'PK11_ExtractKeyValue',0
		align 2
word_100343FE	dw 15Bh			; DATA XREF: .rdata:10034164o
		db 'PK11_DeriveWithFlags',0
		align 2
word_10034416	dw 215h			; DATA XREF: .rdata:10034334o
		db 'PK11_PubDeriveWithKDF',0
word_1003442E	dw 27Ah			; DATA XREF: .rdata:1003415Co
		db 'SECKEY_DestroyPublicKey',0
word_10034448	dw 277h			; DATA XREF: .rdata:10034158o
		db 'SECKEY_DestroyPrivateKey',0
		align 4
word_10034464	dw 272h			; DATA XREF: .rdata:off_10034154o
		db 'SECKEY_CreateECPrivateKey',0
word_10034480	dw 219h			; DATA XREF: .rdata:10034160o
		db 'PK11_PubUnwrapSymKey',0
		align 4
word_10034498	dw 211h			; DATA XREF: .rdata:1003416Co
		db 'PK11_PrivDecryptPKCS1',0
word_100344B0	dw 21Ch			; DATA XREF: .rdata:10034170o
		db 'PK11_PubWrapSymKey',0
		align 2
word_100344C6	dw 286h			; DATA XREF: .rdata:10034174o
		db 'SECKEY_PublicKeyStrength',0
		align 2
word_100344E2	dw 186h			; DATA XREF: .rdata:10034178o
		db 'PK11_FreeSlot',0
word_100344F2	dw 1E8h			; DATA XREF: .rdata:1003417Co
		db 'PK11_KeyGen',0
word_10034500	dw 195h			; DATA XREF: .rdata:10034184o
		db 'PK11_GetBestSlotMultiple',0
		align 4
word_1003451C	dw 1B8h			; DATA XREF: .rdata:10034188o
		db 'PK11_GetPrivateModulusLen',0
word_10034538	dw 281h			; DATA XREF: .rdata:1003418Co
		db 'SECKEY_GetPrivateKeyType',0
		align 4
word_10034554	dw 66h			; DATA XREF: .rdata:10034190o
		db 'CERT_ExtractPublicKey',0
word_1003456C	dw 233h			; DATA XREF: .rdata:10034194o
		db 'PK11_TokenExists',0
		align 10h
word_10034580	dw 18Fh			; DATA XREF: .rdata:10034198o
		db 'PK11_GenerateRandom',0
word_10034596	dw 0EBh			; DATA XREF: .rdata:1003419Co
		db 'DSAU_EncodeDerSigWithLen',0
		align 2
word_100345B2	dw 2F2h			; DATA XREF: .rdata:100341A0o
		db 'SGN_Digest',0
		align 10h
word_100345C0	dw 22Fh			; DATA XREF: .rdata:10034338o
		db 'PK11_Sign',0
word_100345CC	dw 231h			; DATA XREF: .rdata:10034330o
		db 'PK11_SignatureLen',0
word_100345E0	dw 243h			; DATA XREF: .rdata:1003432Co
		db 'PK11_Verify',0
word_100345EE	dw 302h			; DATA XREF: .rdata:10034328o
		db 'VFY_VerifyDigestDirect',0
		align 4
word_10034608	dw 0E9h			; DATA XREF: .rdata:10034324o
		db 'DSAU_DecodeDerSigToLen',0
		align 2
word_10034622	dw 289h			; DATA XREF: .rdata:10034320o
		db 'SECKEY_SignatureLen',0
word_10034638	dw 0F7h			; DATA XREF: .rdata:1003431Co
		db 'HASH_ResultLenByOidTag',0
		align 2
word_10034652	dw 1CAh			; DATA XREF: .rdata:10034318o
		db 'PK11_HashBuf',0
		align 2
word_10034662	dw 15Eh			; DATA XREF: .rdata:10034314o
		db 'PK11_DestroyContext',0
word_10034678	dw 20Eh			; DATA XREF: .rdata:10034310o
		db 'PK11_ParamFromIV',0
		align 4
word_1003468C	dw 16Ah			; DATA XREF: .rdata:1003430Co
		db 'PK11_Encrypt',0
		align 4
word_1003469C	dw 155h			; DATA XREF: .rdata:10034308o
		db 'PK11_Decrypt',0
		align 4
word_100346AC	dw 146h			; DATA XREF: .rdata:10034304o
		db 'PK11_CipherOp',0
word_100346BC	dw 1CBh			; DATA XREF: .rdata:10034300o
		db 'PK11_IVFromParam',0
		align 10h
word_100346D0	dw 14Dh			; DATA XREF: .rdata:100342FCo
		db 'PK11_CreateContextBySymKey',0
		align 2
word_100346EE	dw 166h			; DATA XREF: .rdata:100342F8o
		db 'PK11_DigestFinal',0
		align 2
word_10034702	dw 168h			; DATA XREF: .rdata:100342F4o
		db 'PK11_DigestOp',0
word_10034712	dw 165h			; DATA XREF: .rdata:100342F0o
		db 'PK11_DigestBegin',0
		align 2
word_10034726	dw 230h			; DATA XREF: .rdata:100342ECo
		db 'PK11_SignWithSymKey',0
word_1003473C	dw 1E2h			; DATA XREF: .rdata:100342E8o
		db 'PK11_IsLoggedIn',0
word_1003474E	dw 1FBh			; DATA XREF: .rdata:100342E4o
		db 'PK11_NeedLogin',0
		align 10h
word_10034760	dw 1AEh			; DATA XREF: .rdata:100342E0o
		db 'PK11_GetModuleID',0
		align 4
word_10034774	dw 1BCh			; DATA XREF: .rdata:100342DCo
		db 'PK11_GetSlotID',0
		align 2
word_10034786	dw 1C0h			; DATA XREF: .rdata:100342D8o
		db 'PK11_GetSlotSeries',0
		align 4
word_1003479C	dw 1E3h			; DATA XREF: .rdata:100342D4o
		db 'PK11_IsPresent',0
		align 2
word_100347AE	dw 2A7h			; DATA XREF: .rdata:100342D0o
		db 'SECMOD_LookupSlot',0
word_100347C2	dw 232h			; DATA XREF: .rdata:100342CCo
		db 'PK11_SymKeyFromHandle',0
word_100347DA	dw 1BAh			; DATA XREF: .rdata:100342C8o
		db 'PK11_GetSlotFromKey',0
word_100347F0	dw 15Ah			; DATA XREF: .rdata:100342C4o
		db 'PK11_Derive',0
word_100347FE	dw 167h			; DATA XREF: .rdata:100342C0o
		db 'PK11_DigestKey',0
		align 10h
word_10034810	dw 223h			; DATA XREF: .rdata:100342BCo
		db 'PK11_RestoreContext',0
word_10034826	dw 225h			; DATA XREF: .rdata:100342B8o
		db 'PK11_SaveContextAlloc',0
word_1003483E	dw 23Dh			; DATA XREF: .rdata:100342B4o
		db 'PK11_UnwrapSymKey',0
word_10034852	dw 248h			; DATA XREF: .rdata:100342B0o
		db 'PK11_WrapSymKey',0
word_10034864	dw 287h			; DATA XREF: .rdata:100342ACo
		db 'SECKEY_PublicKeyStrengthInBits',0
		align 2
word_10034886	dw 193h			; DATA XREF: .rdata:100342A8o
		db 'PK11_GetBestKeyLength',0
word_1003489E	dw 221h			; DATA XREF: .rdata:100342A4o
		db 'PK11_ReferenceSymKey',0
		align 2
word_100348B6	dw 244h			; DATA XREF: .rdata:100342A0o
		db 'PK11_VerifyKeyOK',0
		align 2
word_100348CA	dw 43h			; DATA XREF: .rdata:1003429Co
		db 'CERT_DestroyCertificate',0
word_100348E4	dw 1A3h			; DATA XREF: .rdata:10034298o
		db 'PK11_GetKeyData',0
word_100348F6	dw 1AAh			; DATA XREF: .rdata:10034294o
		db 'PK11_GetMechanism',0
word_1003490A	dw 22Eh			; DATA XREF: .rdata:10034290o
		db 'PK11_SetWrapKey',0
word_1003491C	dw 198h			; DATA XREF: .rdata:1003428Co
		db 'PK11_GetBestWrapMechanism',0
word_10034938	dw 1C8h			; DATA XREF: .rdata:10034288o
		db 'PK11_GetWrapKey',0
word_1003494A	dw 19Bh			; DATA XREF: .rdata:10034284o
		db 'PK11_GetCurrentWrapIndex',0
		align 2
word_10034966	dw 273h			; DATA XREF: .rdata:10034280o
		db 'SECKEY_CreateRSAPrivateKey',0
		align 4
word_10034984	dw 44h			; DATA XREF: .rdata:1003427Co
		db 'CERT_DestroyCertificateList',0
word_100349A2	dw 1A2h			; DATA XREF: .rdata:10034278o
		db 'PK11_GetInternalSlot',0
		align 2
word_100349BA	dw 14Eh			; DATA XREF: .rdata:10034274o
		db 'PK11_CreateDigestContext',0
		align 2
word_100349D6	dw 214h			; DATA XREF: .rdata:10034270o
		db 'PK11_PubDerive',0
		align 4
word_100349E8	dw 271h			; DATA XREF: .rdata:1003426Co
		db 'SECKEY_CreateDHPrivateKey',0
word_10034A04	dw 1BBh			; DATA XREF: .rdata:10034268o
		db 'PK11_GetSlotFromPrivateKey',0
		align 2
word_10034A22	dw 52h			; DATA XREF: .rdata:10034264o
		db 'CERT_DupCertificate',0
word_10034A38	dw 1D9h			; DATA XREF: .rdata:10034260o
		db 'PK11_ImportSymKey',0
word_10034A4C	dw 23Eh			; DATA XREF: .rdata:1003425Co
		db 'PK11_UnwrapSymKeyWithFlags',0
		align 2
word_10034A6A	dw 11h			; DATA XREF: .rdata:10034258o
		db 'CERT_CertChainFromCert',0
		align 4
word_10034A84	dw 28Ah			; DATA XREF: .rdata:10034254o
		db 'SECKEY_UpdateCertPQG',0
		align 4
word_10034A9C	dw 0BBh			; DATA XREF: .rdata:10034250o
		db 'CERT_NewTempCertificate',0
word_10034AB6	dw 42h			; DATA XREF: .rdata:1003424Co
		db 'CERT_DestroyCertList',0
		align 2
word_10034ACE	dw 6			; DATA XREF: .rdata:10034248o
		db 'CERT_AddCertToListTail',0
		align 4
word_10034AE8	dw 0BAh			; DATA XREF: .rdata:10034244o
		db 'CERT_NewCertList',0
		align 4
word_10034AFC	dw 0B8h			; DATA XREF: .rdata:10034240o
		db 'CERT_NameToAscii',0
		align 10h
word_10034B10	dw 0D1h			; DATA XREF: .rdata:1003423Co
		db 'CERT_VerifyCertName',0
word_10034B26	dw 0D0h			; DATA XREF: .rdata:10034238o
		db 'CERT_VerifyCert',0
word_10034B38	dw 10h			; DATA XREF: .rdata:10034234o
		db 'CERT_CacheOCSPResponseFromSideChannel',0
word_10034B60	dw 0F1h			; DATA XREF: .rdata:10034230o
		db 'HASH_GetHashObject',0
		align 2
word_10034B76	dw 30Dh			; DATA XREF: .rdata:1003422Co
		db '__PK11_CreateContextByRawKey',0
		align 2
word_10034B96	dw 194h			; DATA XREF: .rdata:10034228o
		db 'PK11_GetBestSlot',0
		align 2
word_10034BAA	dw 213h			; DATA XREF: .rdata:10034224o
		db 'PK11_PubDecryptRaw',0
		align 10h
word_10034BC0	dw 218h			; DATA XREF: .rdata:10034220o
		db 'PK11_PubEncryptRaw',0
		align 2
word_10034BD6	dw 2F0h			; DATA XREF: .rdata:1003421Co
		db 'SGN_DestroyContext',0
		align 4
word_10034BEC	dw 2F3h			; DATA XREF: .rdata:10034218o
		db 'SGN_End',0
word_10034BF6	dw 2F5h			; DATA XREF: .rdata:10034214o
		db 'SGN_Update',0
		align 4
word_10034C04	dw 2ECh			; DATA XREF: .rdata:10034210o
		db 'SGN_Begin',0
word_10034C10	dw 2F4h			; DATA XREF: .rdata:1003420Co
		db 'SGN_NewContext',0
		align 2
word_10034C22	dw 2FAh			; DATA XREF: .rdata:10034208o
		db 'VFY_DestroyContext',0
		align 4
word_10034C38	dw 2FBh			; DATA XREF: .rdata:10034204o
		db 'VFY_End',0
word_10034C42	dw 2FDh			; DATA XREF: .rdata:10034200o
		db 'VFY_Update',0
		align 10h
word_10034C50	dw 2F6h			; DATA XREF: .rdata:100341FCo
		db 'VFY_Begin',0
word_10034C5C	dw 2F7h			; DATA XREF: .rdata:100341F8o
		db 'VFY_CreateContext',0
word_10034C70	dw 13Ah			; DATA XREF: .rdata:100341F4o
		db 'NSS_VersionCheck',0
		align 4
word_10034C84	dw 136h			; DATA XREF: .rdata:100341F0o
		db 'NSS_RegisterShutdown',0
		align 4
word_10034C9C	dw 171h			; DATA XREF: .rdata:100341ECo
		db 'PK11_Finalize',0
word_10034CAC	dw 7Fh			; DATA XREF: .rdata:100341E8o
		db 'CERT_FreeDistNames',0
		align 2
word_10034CC2	dw 0A5h			; DATA XREF: .rdata:100341E4o
		db 'CERT_GetSSLCACerts',0
		align 4
word_10034CD8	dw 51h			; DATA XREF: .rdata:100341E0o
		db 'CERT_DupCertList',0
		align 4
word_10034CEC	dw 26Ah			; DATA XREF: .rdata:100341DCo
		db 'SECKEY_CacheStaticFlags',0
word_10034D06	dw 26Dh			; DATA XREF: .rdata:100341D8o
		db 'SECKEY_CopyPrivateKey',0
word_10034D1E	dw 1F7h			; DATA XREF: .rdata:100341D4o
		db 'PK11_MapSignKeyType',0
word_10034D34	dw 14Ch			; DATA XREF: .rdata:100341D0o
		db 'PK11_CopyTokenPrivKeyToSessionPrivKey',0
word_10034D5C	dw 220h			; DATA XREF: .rdata:100341CCo
		db 'PK11_ReferenceSlot',0
		align 2
word_10034D72	dw 50h			; DATA XREF: .rdata:100341C8o
		db 'CERT_DistNamesFromCertList',0
		align 10h
word_10034D90	dw 53h			; DATA XREF: .rdata:100341C4o
		db 'CERT_DupDistNames',0
word_10034DA4	dw 93h			; DATA XREF: .rdata:100341C0o
		db 'CERT_GetDefaultCertDB',0
word_10034DBC	dw 80h			; DATA XREF: .rdata:100341BCo
		db 'CERT_FreeNicknames',0
		align 2
word_10034DD2	dw 16h			; DATA XREF: .rdata:100341B8o
		db 'CERT_CheckCertValidTimes',0
		align 2
word_10034DEE	dw 86h			; DATA XREF: .rdata:100341B4o
		db 'CERT_GetCertNicknames',0
word_10034E06	dw 17Eh			; DATA XREF: .rdata:100341B0o
		db 'PK11_FindKeyByAnyCert',0
word_10034E1E	dw 79h			; DATA XREF: .rdata:100341ACo
		db 'CERT_FindUserCertByUsage',0
		align 2
word_10034E3A	dw 6Eh			; DATA XREF: .rdata:100341A8o
		db 'CERT_FindCertByName',0
word_10034E50	dw 197h			; DATA XREF: .rdata:100341A4o
		db 'PK11_GetBestSlotWithAttributes',0
		align 2
aNss3_dll	db 'nss3.dll',0         ; DATA XREF: .rdata:10033F60o
		align 4
word_10034E7C	dw 6Fh			; DATA XREF: .rdata:100343C8o
		db 'PORT_SetError_Util',0
		align 2
word_10034E92	dw 66h			; DATA XREF: .rdata:100343C4o
		db 'PORT_Free_Util',0
		align 4
word_10034EA4	dw 81h			; DATA XREF: .rdata:100343C0o
		db 'SECITEM_FreeItem_Util',0
word_10034EBC	dw 5Dh			; DATA XREF: .rdata:100343BCo
		db 'PORT_Alloc_Util',0
word_10034ECE	dw 77h			; DATA XREF: .rdata:100343B8o
		db 'PORT_ZAlloc_Util',0
		align 2
word_10034EE2	dw 78h			; DATA XREF: .rdata:100343B4o
		db 'PORT_ZFree_Util',0
word_10034EF4	dw 25h			; DATA XREF: .rdata:100343B0o
		db 'NSSRWLock_UnlockRead_Util',0
word_10034F10	dw 22h			; DATA XREF: .rdata:100343ACo
		db 'NSSRWLock_LockRead_Util',0
word_10034F2A	dw 26h			; DATA XREF: .rdata:100343A8o
		db 'NSSRWLock_UnlockWrite_Util',0
		align 4
word_10034F48	dw 23h			; DATA XREF: .rdata:100343A4o
		db 'NSSRWLock_LockWrite_Util',0
		align 4
word_10034F64	dw 67h			; DATA XREF: .rdata:100343A0o
		db 'PORT_GetError_Util',0
		align 2
word_10034F7A	dw 7Ch			; DATA XREF: .rdata:1003439Co
		db 'SECITEM_CompareItem_Util',0
		align 2
word_10034F96	dw 73h			; DATA XREF: .rdata:10034398o
		db 'PORT_Strdup_Util',0
		align 2
word_10034FAA	dw 7Dh			; DATA XREF: .rdata:10034394o
		db 'SECITEM_CopyItem_Util',0
word_10034FC2	dw 65h			; DATA XREF: .rdata:10034390o
		db 'PORT_FreeArena_Util',0
word_10034FD8	dw 64h			; DATA XREF: .rdata:1003438Co
		db 'PORT_ArenaZAlloc_Util',0
word_10034FF0	dw 6Ah			; DATA XREF: .rdata:10034388o
		db 'PORT_NewArena_Util',0
		align 2
word_10035006	dw 5Eh			; DATA XREF: .rdata:10034384o
		db 'PORT_ArenaAlloc_Util',0
		align 2
word_1003501E	dw 5Bh			; DATA XREF: .rdata:10034380o
		db 'NSS_SecureMemcmp',0
		align 2
word_10035032	dw 80h			; DATA XREF: .rdata:1003437Co
		db 'SECITEM_FreeArray',0
word_10035046	dw 79h			; DATA XREF: .rdata:10034378o
		db 'SECITEM_AllocArray',0
		align 4
word_1003505C	dw 88h			; DATA XREF: .rdata:10034374o
		db 'SECITEM_ZfreeItem_Util',0
		align 2
word_10035076	dw 7Ah			; DATA XREF: .rdata:10034370o
		db 'SECITEM_AllocItem_Util',0
		align 10h
word_10035090	dw 6Bh			; DATA XREF: .rdata:1003436Co
		db 'PORT_Realloc_Util',0
word_100350A4	dw 92h			; DATA XREF: .rdata:10034368o
		db 'SECOID_GetAlgorithmTag_Util',0
word_100350C2	dw 82h			; DATA XREF: .rdata:100343CCo
		db 'SECITEM_Hash',0
		align 2
word_100350D2	dw 5Ah			; DATA XREF: .rdata:10034364o
		db 'NSS_PutEnv_Util',0
word_100350E4	dw 3			; DATA XREF: .rdata:10034360o
		db 'BTOA_DataToAscii_Util',0
word_100350FC	dw 0			; DATA XREF: .rdata:1003435Co
		db 'ATOB_AsciiToData_Util',0
word_10035114	dw 20h			; DATA XREF: .rdata:10034358o
		db 'NSSRWLock_Destroy_Util',0
		align 2
word_1003512E	dw 7Eh			; DATA XREF: .rdata:10034354o
		db 'SECITEM_DupArray',0
		align 2
word_10035142	dw 24h			; DATA XREF: .rdata:10034350o
		db 'NSSRWLock_New_Util',0
		align 4
word_10035158	dw 0Eh			; DATA XREF: .rdata:1003434Co
		db 'DER_Lengths_Util',0
		align 4
word_1003516C	dw 7Fh			; DATA XREF: .rdata:10034348o
		db 'SECITEM_DupItem_Util',0
		align 4
word_10035184	dw 8Eh			; DATA XREF: .rdata:10034344o
		db 'SECOID_FindOIDByTag_Util',0
		align 10h
word_100351A0	dw 91h			; DATA XREF: .rdata:off_10034340o
		db 'SECOID_FindOID_Util',0
aNssutil3_dll	db 'nssutil3.dll',0     ; DATA XREF: .rdata:10033F74o
		align 4
word_100351C4	dw 10h			; DATA XREF: .rdata:off_10034100o
		db 'PL_strdup',0
aLibplc4_dll	db 'libplc4.dll',0      ; DATA XREF: .rdata:10033F88o
word_100351DC	dw 0DAh			; DATA XREF: .rdata:10034034o
		db 'PR_IntervalNow',0
		align 2
word_100351EE	dw 0F2h			; DATA XREF: .rdata:10034038o
		db 'PR_MillisecondsToInterval',0
word_1003520A	dw 6Fh			; DATA XREF: .rdata:1003403Co
		db 'PR_ExitMonitor',0
		align 4
word_1003521C	dw 65h			; DATA XREF: .rdata:10034040o
		db 'PR_EnterMonitor',0
word_1003522E	dw 17h			; DATA XREF: .rdata:10034044o
		db 'PR_AtomicIncrement',0
		align 4
word_10035244	dw 52h			; DATA XREF: .rdata:10034048o
		db 'PR_DestroyLock',0
		align 2
word_10035256	dw 16Eh			; DATA XREF: .rdata:1003404Co
		db 'PR_Unlock',0
word_10035262	dw 0E8h			; DATA XREF: .rdata:10034050o
		db 'PR_Lock',0
word_1003526C	dw 0FBh			; DATA XREF: .rdata:10034054o
		db 'PR_NewLock',0
		align 2
word_1003527A	dw 16h			; DATA XREF: .rdata:10034058o
		db 'PR_AtomicDecrement',0
		align 10h
word_10035290	dw 143h			; DATA XREF: .rdata:1003405Co
		db 'PR_SetError',0
word_1003529E	dw 96h			; DATA XREF: .rdata:10034060o
		db 'PR_GetError',0
word_100352AC	dw 159h			; DATA XREF: .rdata:10034064o
		db 'PR_Sleep',0
		align 4
word_100352B8	dw 128h			; DATA XREF: .rdata:10034068o
		db 'PR_RWLock_Unlock',0
		align 4
word_100352CC	dw 127h			; DATA XREF: .rdata:1003406Co
		db 'PR_RWLock_Rlock',0
word_100352DE	dw 90h			; DATA XREF: .rdata:10034070o
		db 'PR_GetCurrentThread',0
word_100352F4	dw 10Ch			; DATA XREF: .rdata:10034074o
		db 'PR_Now',0
		align 2
word_100352FE	dw 118h			; DATA XREF: .rdata:10034078o
		db 'PR_PopIOLayer',0
word_1003530E	dw 6Bh			; DATA XREF: .rdata:1003407Co
		db 'PR_ErrorInstallTable',0
		align 2
word_10035326	dw 27h			; DATA XREF: .rdata:10034080o
		db 'PR_CallOnce',0
word_10035334	dw 28h			; DATA XREF: .rdata:10034084o
		db 'PR_CallOnceWithArg',0
		align 2
word_1003534A	dw 15Eh			; DATA XREF: .rdata:10034088o
		db 'PR_StringToNetAddr',0
		align 10h
word_10035360	dw 58h			; DATA XREF: .rdata:1003408Co
		db 'PR_DestroyRWLock',0
		align 4
word_10035374	dw 129h			; DATA XREF: .rdata:10034090o
		db 'PR_RWLock_Wlock',0
word_10035386	dw 101h			; DATA XREF: .rdata:10034094o
		db 'PR_NewRWLock',0
		align 2
word_10035396	dw 34h			; DATA XREF: .rdata:10034098o
		db 'PR_CloseFileMap',0
word_100353A8	dw 0F0h			; DATA XREF: .rdata:1003409Co
		db 'PR_MemUnmap',0
word_100353B6	dw 0EFh			; DATA XREF: .rdata:100340A0o
		db 'PR_MemMap',0
word_100353C2	dw 186h			; DATA XREF: .rdata:100340A4o
		db 'PR_smprintf_free',0
		align 2
word_100353D6	dw 10Eh			; DATA XREF: .rdata:100340A8o
		db 'PR_OpenAnonFileMap',0
		align 4
word_100353EC	dw 185h			; DATA XREF: .rdata:100340ACo
		db 'PR_smprintf',0
word_100353FA	dw 71h			; DATA XREF: .rdata:100340B0o
		db 'PR_ExportFileMapAsString',0
		align 2
word_10035416	dw 0D0h			; DATA XREF: .rdata:100340B4o
		db 'PR_ImportFileMapFromString',0
		align 4
word_10035434	dw 63h			; DATA XREF: .rdata:100340B8o
		db 'PR_EmulateSendFile',0
		align 2
word_1003544A	dw 62h			; DATA XREF: .rdata:100340BCo
		db 'PR_EmulateAcceptRead',0
		align 2
word_10035462	dw 0A0h			; DATA XREF: .rdata:100340C0o
		db 'PR_GetIdentitiesLayer',0
word_1003547A	dw 54h			; DATA XREF: .rdata:100340C4o
		db 'PR_DestroyMonitor',0
word_1003548E	dw 39h			; DATA XREF: .rdata:100340C8o
		db 'PR_ConvertIPv4AddrToIPv6',0
		align 2
word_100354AA	dw 0B9h			; DATA XREF: .rdata:100340CCo
		db 'PR_GetSocketOption',0
		align 10h
word_100354C0	dw 91h			; DATA XREF: .rdata:100340D0o
		db 'PR_GetDefaultIOMethods',0
		align 2
word_100354DA	dw 0CCh			; DATA XREF: .rdata:100340D4o
		db 'PR_GetUniqueIdentity',0
		align 2
word_100354F2	dw 120h			; DATA XREF: .rdata:100340D8o
		db 'PR_PushIOLayer',0
		align 4
word_10035504	dw 3Eh			; DATA XREF: .rdata:100340F8o
		db 'PR_CreateIOLayerStub',0
		align 4
word_1003551C	dw 0FDh			; DATA XREF: .rdata:10034030o
		db 'PR_NewMonitor',0
word_1003552C	dw 32h			; DATA XREF: .rdata:100340ECo
		db 'PR_Close',0
		align 4
word_10035538	dw 0E5h			; DATA XREF: .rdata:100340F4o
		db 'PR_LoadLibraryWithFlags',0
word_10035552	dw 93h			; DATA XREF: .rdata:100340F0o
		db 'PR_GetDirectorySeparator',0
		align 2
word_1003556E	dw 85h			; DATA XREF: .rdata:off_1003402Co
		db 'PR_Free',0
word_10035578	dw 0A4h			; DATA XREF: .rdata:100340E8o
		db 'PR_GetLibraryFilePathname',0
word_10035594	dw 16Dh			; DATA XREF: .rdata:100340E4o
		db 'PR_UnloadLibrary',0
		align 4
word_100355A8	dw 7Ah			; DATA XREF: .rdata:100340E0o
		db 'PR_FindFunctionSymbol',0
word_100355C0	dw 95h			; DATA XREF: .rdata:100340DCo
		db 'PR_GetEnv',0
aLibnspr4_dll	db 'libnspr4.dll',0     ; DATA XREF: .rdata:10033F9Co
		align 2
word_100355DA	dw 4EAh			; DATA XREF: .rdata:off_10034108o
		db 'memcpy',0
		align 4
word_100355E4	dw 4EEh			; DATA XREF: .rdata:1003410Co
		db 'memset',0
		align 2
word_100355EE	dw 4ECh			; DATA XREF: .rdata:10034110o
		db 'memmove',0
word_100355F8	dw 495h			; DATA XREF: .rdata:10034114o
		db 'fflush',0
		align 2
word_10035602	dw 4B1h			; DATA XREF: .rdata:10034118o
		db 'fwrite',0
		align 4
word_1003560C	dw 526h			; DATA XREF: .rdata:1003411Co
		db 'strstr',0
		align 2
word_10035616	dw 534h			; DATA XREF: .rdata:10034120o
		db 'time',0
		align 2
word_1003561E	dw 513h			; DATA XREF: .rdata:10034124o
		db 'strchr',0
		align 4
word_10035628	dw 4B6h			; DATA XREF: .rdata:10034128o
		db 'getenv',0
		align 2
word_10035632	dw 4A2h			; DATA XREF: .rdata:1003412Co
		db 'fputs',0
word_1003563A	dw 4AEh			; DATA XREF: .rdata:10034130o
		db 'ftell',0
word_10035642	dw 49Dh			; DATA XREF: .rdata:10034134o
		db 'fopen',0
word_1003564A	dw 524h			; DATA XREF: .rdata:10034138o
		db 'strrchr',0
word_10035654	dw 4DEh			; DATA XREF: .rdata:1003413Co
		db 'malloc',0
		align 2
word_1003565E	dw 4A6h			; DATA XREF: .rdata:10034140o
		db 'free',0
		align 2
aMsvcrt_dll	db 'msvcrt.dll',0       ; DATA XREF: .rdata:10033FB0o
		align 2
word_10035672	dw 6Ah			; DATA XREF: .rdata:10034144o
		db '_XcptFilter',0
word_10035680	dw 1D5h			; DATA XREF: .rdata:10034148o
		db '_initterm',0
word_1003568C	dw 101h			; DATA XREF: .rdata:1003414Co
		db '_amsg_exit',0
		align 2
word_1003569A	dw 13Ch			; DATA XREF: .rdata:off_10033FE0o
		db 'GetCurrentProcessId',0
word_100356B0	dw 168h			; DATA XREF: .rdata:10033FE4o
		db 'GetLastError',0
		align 10h
word_100356C0	dw 5Ch			; DATA XREF: .rdata:10033FE8o
		db 'CreateMutexA',0
		align 10h
word_100356D0	dw 31h			; DATA XREF: .rdata:10033FECo
		db 'CloseHandle',0
word_100356DE	dw 2B3h			; DATA XREF: .rdata:10033FF0o
		db 'ReleaseMutex',0
		align 2
word_100356EE	dw 37Eh			; DATA XREF: .rdata:10033FF4o
		db 'WaitForSingleObject',0
word_10035704	dw 13Eh			; DATA XREF: .rdata:10033FF8o
		db 'GetCurrentThreadId',0
		align 2
word_1003571A	dw 2C7h			; DATA XREF: .rdata:10033FFCo
		db 'RtlUnwind',0
word_10035726	dw 21Dh			; DATA XREF: .rdata:10034000o
		db 'InterlockedExchange',0
word_1003573C	dw 342h			; DATA XREF: .rdata:10034004o
		db 'Sleep',0
word_10035744	dw 21Bh			; DATA XREF: .rdata:10034008o
		db 'InterlockedCompareExchange',0
		align 2
word_10035762	dw 34Ah			; DATA XREF: .rdata:1003400Co
		db 'TerminateProcess',0
		align 2
word_10035776	dw 13Bh			; DATA XREF: .rdata:10034010o
		db 'GetCurrentProcess',0
word_1003578A	dw 35Bh			; DATA XREF: .rdata:10034014o
		db 'UnhandledExceptionFilter',0
		align 2
word_100357A6	dw 336h			; DATA XREF: .rdata:10034018o
		db 'SetUnhandledExceptionFilter',0
word_100357C4	dw 294h			; DATA XREF: .rdata:1003401Co
		db 'QueryPerformanceCounter',0
word_100357DE	dw 1D4h			; DATA XREF: .rdata:10034020o
		db 'GetTickCount',0
		align 2
word_100357EE	dw 1C0h			; DATA XREF: .rdata:10034024o
		db 'GetSystemTimeAsFileTime',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:10033FC4o
		align 10h
;
; Export directory for ssl3.dll
;
		dd 0			; Characteristics
		dd 54275E77h		; TimeDateStamp: Sun Sep 28 01:03:51 2014
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSsl3_dll	; Name
		dd 1			; Base
		dd 58h			; NumberOfFunctions
		dd 58h			; NumberOfNames
		dd rva off_10035848	; AddressOfFunctions
		dd rva off_100359A8	; AddressOfNames
		dd rva word_10035B08	; AddressOfNameOrdinals
;
; Export Address Table for ssl3.dll
;
off_10035848	dd rva DTLS_GetHandshakeTimeout, rva DTLS_ImportFD, rva	NSSSSL_GetVersion
					; DATA XREF: .rdata:1003583Co
		dd rva NSSSSL_VersionCheck, rva	NSS_CmpCertChainWCANames
		dd rva NSS_FindCertKEAType, rva	NSS_GetClientAuthData
		dd rva NSS_SetDomesticPolicy, 2	dup(rva	NSS_SetFrancePolicy)
		dd rva SSL_AuthCertificate, rva	SSL_AuthCertificateComplete
		dd rva SSL_AuthCertificateHook,	rva SSL_BadCertHook, rva SSL_CanBypass
		dd rva SSL_CertDBHandleSet, rva	SSL_CipherPolicyGet, rva SSL_CipherPolicySet
		dd rva SSL_CipherPrefGet, rva SSL_CipherPrefGetDefault
		dd rva SSL_CipherPrefSet, rva SSL_CipherPrefSetDefault
		dd rva SSL_ClearSessionCache, rva SSL_ConfigMPServerSIDCache
		dd rva SSL_ConfigSecureServer, rva SSL_ConfigSecureServerWithCertChain
		dd rva SSL_ConfigServerSessionIDCache, rva SSL_ConfigServerSessionIDCacheWithOpt
		dd rva SSL_DataPending,	rva SSL_ExportKeyingMaterial, rva SSL_ForceHandshake
		dd rva SSL_ForceHandshakeWithTimeout, rva SSL_GetChannelInfo
		dd rva SSL_GetCipherSuiteInfo, rva SSL_GetClientAuthDataHook
		dd rva SSL_GetImplementedCiphers, rva SSL_GetMaxServerCacheLocks
		dd rva SSL_GetNegotiatedHostInfo, rva SSL_GetNextProto
		dd rva SSL_GetNumImplementedCiphers, rva SSL_GetSRTPCipher
		dd rva SSL_GetSessionID, rva SSL_GetStatistics,	rva SSL_HandshakeCallback
		dd rva SSL_HandshakeNegotiatedExtension, rva SSL_ImplementedCiphers
		dd rva SSL_ImportFD, rva SSL_InheritMPServerSIDCache, rva SSL_InvalidateSession
		dd rva SSL_LocalCertificate, rva SSL_NumImplementedCiphers
		dd rva SSL_OptionGet, rva SSL_OptionGetDefault,	rva SSL_OptionSet
		dd rva SSL_OptionSetDefault, rva SSL_PeerCertificate, rva SSL_PeerCertificateChain
		dd rva SSL_PeerStapledOCSPResponses, 2 dup(rva SSL_PreencryptedStreamToFile)
		dd rva SSL_ReHandshake,	rva SSL_ReHandshakeWithTimeout
		dd rva SSL_RecommendedCanFalseStart, rva SSL_ReconfigFD
		dd rva SSL_ResetHandshake, 2 dup(rva SSL_RestartHandshakeAfterServerCert)
		dd rva SSL_RevealCert, rva SSL_RevealPinArg, rva SSL_RevealURL
		dd rva SSL_SNISocketConfigHook,	rva SSL_SecurityStatus
		dd rva SSL_SetCanFalseStartCallback, rva SSL_SetMaxServerCacheLocks
		dd rva SSL_SetNextProtoCallback, rva SSL_SetNextProtoNego
		dd rva SSL_SetPKCS11PinArg, rva	SSL_SetSRTPCiphers, rva	SSL_SetSockPeerID
		dd rva SSL_SetStapledOCSPResponses, rva	SSL_SetTrustAnchors
		dd rva SSL_SetURL, rva SSL_ShutdownServerSessionIDCache
		dd rva SSL_VersionRangeGet, rva	SSL_VersionRangeGetDefault
		dd rva SSL_VersionRangeGetSupported, rva SSL_VersionRangeSet
		dd rva SSL_VersionRangeSetDefault
;
; Export Names Table for ssl3.dll
;
off_100359A8	dd rva aDtls_gethandsh,	rva aDtls_importfd, rva	aNssssl_getvers
					; DATA XREF: .rdata:10035840o
		dd rva aNssssl_version,	rva aNss_cmpcertcha, rva aNss_findcertke ; "DTLS_GetHandshakeTimeout"
		dd rva aNss_getclienta,	rva aNss_setdomesti, rva aNss_setexportp
		dd rva aNss_setfrancep,	rva aSsl_authcertif, rva aSsl_authcert_0
		dd rva aSsl_authcert_1,	rva aSsl_badcerthoo, rva aSsl_canbypass
		dd rva aSsl_certdbhand,	rva aSsl_cipherpoli, rva aSsl_cipherpo_0
		dd rva aSsl_cipherpref,	rva aSsl_cipherpr_0, rva aSsl_cipherpr_1
		dd rva aSsl_cipherpr_2,	rva aSsl_clearsessi, rva aSsl_configmpse
		dd rva aSsl_configsecu,	rva aSsl_configse_0, rva aSsl_configserv
		dd rva aSsl_configse_1,	rva aSsl_datapendin, rva aSsl_exportkeyi
		dd rva aSsl_forcehands,	rva aSsl_forcehan_0, rva aSsl_getchannel
		dd rva aSsl_getciphers,	rva aSsl_getclienta, rva aSsl_getimpleme
		dd rva aSsl_getmaxserv,	rva aSsl_getnegotia, rva aSsl_getnextpro
		dd rva aSsl_getnumimpl,	rva aSsl_getsrtpcip, rva aSsl_getsession
		dd rva aSsl_getstatist,	rva aSsl_handshakec, rva aSsl_handshaken
		dd rva aSsl_implemente,	rva aSsl_importfd, rva aSsl_inheritmps
		dd rva aSsl_invalidate,	rva aSsl_localcerti, rva aSsl_numimpleme
		dd rva aSsl_optionget, rva aSsl_optiongetd, rva	aSsl_optionset
		dd rva aSsl_optionsetd,	rva aSsl_peercertif, rva aSsl_peercert_0
		dd rva aSsl_peerstaple,	rva aSsl_preencrypt, rva aSsl_preencry_0
		dd rva aSsl_rehandshak,	rva aSsl_rehandsh_0, rva aSsl_recommende
		dd rva aSsl_reconfigfd,	rva aSsl_resethands, rva aSsl_restarthan
		dd rva aSsl_restarth_0,	rva aSsl_revealcert, rva aSsl_revealpina
		dd rva aSsl_revealurl, rva aSsl_snisocketc, rva	aSsl_securityst
		dd rva aSsl_setcanfals,	rva aSsl_setmaxserv, rva aSsl_setnextpro
		dd rva aSsl_setnextp_0,	rva aSsl_setpkcs11p, rva aSsl_setsrtpcip
		dd rva aSsl_setsockpee,	rva aSsl_setstapled, rva aSsl_settrustan
		dd rva aSsl_seturl, rva	aSsl_shutdownse, rva aSsl_versionran
		dd rva aSsl_versionr_0,	rva aSsl_versionr_1, rva aSsl_versionr_2
		dd rva aSsl_versionr_3
;
; Export Ordinals Table	for ssl3.dll
;
word_10035B08	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:10035844o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
		dw 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
		dw 46h,	47h, 48h, 49h, 4Ah, 4Bh, 4Ch, 4Dh, 4Eh,	4Fh, 50h
		dw 51h,	52h, 53h, 54h, 55h, 56h, 57h
aSsl3_dll	db 'ssl3.dll',0         ; DATA XREF: .rdata:1003582Co
aDtls_gethandsh	db 'DTLS_GetHandshakeTimeout',0 ; DATA XREF: .rdata:off_100359A8o
aDtls_importfd	db 'DTLS_ImportFD',0    ; DATA XREF: .rdata:off_100359A8o
aNssssl_getvers	db 'NSSSSL_GetVersion',0 ; DATA XREF: .rdata:off_100359A8o
aNssssl_version	db 'NSSSSL_VersionCheck',0 ; DATA XREF: .rdata:off_100359A8o
aNss_cmpcertcha	db 'NSS_CmpCertChainWCANames',0 ; DATA XREF: .rdata:off_100359A8o
aNss_findcertke	db 'NSS_FindCertKEAType',0 ; DATA XREF: .rdata:off_100359A8o
aNss_getclienta	db 'NSS_GetClientAuthData',0 ; DATA XREF: .rdata:off_100359A8o
aNss_setdomesti	db 'NSS_SetDomesticPolicy',0 ; DATA XREF: .rdata:off_100359A8o
aNss_setexportp	db 'NSS_SetExportPolicy',0 ; DATA XREF: .rdata:off_100359A8o
aNss_setfrancep	db 'NSS_SetFrancePolicy',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_authcertif	db 'SSL_AuthCertificate',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_authcert_0	db 'SSL_AuthCertificateComplete',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_authcert_1	db 'SSL_AuthCertificateHook',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_badcerthoo	db 'SSL_BadCertHook',0  ; DATA XREF: .rdata:off_100359A8o
aSsl_canbypass	db 'SSL_CanBypass',0    ; DATA XREF: .rdata:off_100359A8o
aSsl_certdbhand	db 'SSL_CertDBHandleSet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpoli	db 'SSL_CipherPolicyGet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpo_0	db 'SSL_CipherPolicySet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpref	db 'SSL_CipherPrefGet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpr_0	db 'SSL_CipherPrefGetDefault',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpr_1	db 'SSL_CipherPrefSet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_cipherpr_2	db 'SSL_CipherPrefSetDefault',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_clearsessi	db 'SSL_ClearSessionCache',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_configmpse	db 'SSL_ConfigMPServerSIDCache',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_configsecu	db 'SSL_ConfigSecureServer',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_configse_0	db 'SSL_ConfigSecureServerWithCertChain',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_configserv	db 'SSL_ConfigServerSessionIDCache',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_configse_1	db 'SSL_ConfigServerSessionIDCacheWithOpt',0
					; DATA XREF: .rdata:off_100359A8o
aSsl_datapendin	db 'SSL_DataPending',0  ; DATA XREF: .rdata:off_100359A8o
aSsl_exportkeyi	db 'SSL_ExportKeyingMaterial',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_forcehands	db 'SSL_ForceHandshake',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_forcehan_0	db 'SSL_ForceHandshakeWithTimeout',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getchannel	db 'SSL_GetChannelInfo',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getciphers	db 'SSL_GetCipherSuiteInfo',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getclienta	db 'SSL_GetClientAuthDataHook',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getimpleme	db 'SSL_GetImplementedCiphers',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getmaxserv	db 'SSL_GetMaxServerCacheLocks',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getnegotia	db 'SSL_GetNegotiatedHostInfo',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getnextpro	db 'SSL_GetNextProto',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getnumimpl	db 'SSL_GetNumImplementedCiphers',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getsrtpcip	db 'SSL_GetSRTPCipher',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getsession	db 'SSL_GetSessionID',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_getstatist	db 'SSL_GetStatistics',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_handshakec	db 'SSL_HandshakeCallback',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_handshaken	db 'SSL_HandshakeNegotiatedExtension',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_implemente	db 'SSL_ImplementedCiphers',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_importfd	db 'SSL_ImportFD',0     ; DATA XREF: .rdata:off_100359A8o
aSsl_inheritmps	db 'SSL_InheritMPServerSIDCache',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_invalidate	db 'SSL_InvalidateSession',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_localcerti	db 'SSL_LocalCertificate',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_numimpleme	db 'SSL_NumImplementedCiphers',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_optionget	db 'SSL_OptionGet',0    ; DATA XREF: .rdata:off_100359A8o
aSsl_optiongetd	db 'SSL_OptionGetDefault',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_optionset	db 'SSL_OptionSet',0    ; DATA XREF: .rdata:off_100359A8o
aSsl_optionsetd	db 'SSL_OptionSetDefault',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_peercertif	db 'SSL_PeerCertificate',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_peercert_0	db 'SSL_PeerCertificateChain',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_peerstaple	db 'SSL_PeerStapledOCSPResponses',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_preencrypt	db 'SSL_PreencryptedFileToStream',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_preencry_0	db 'SSL_PreencryptedStreamToFile',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_rehandshak	db 'SSL_ReHandshake',0  ; DATA XREF: .rdata:off_100359A8o
aSsl_rehandsh_0	db 'SSL_ReHandshakeWithTimeout',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_recommende	db 'SSL_RecommendedCanFalseStart',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_reconfigfd	db 'SSL_ReconfigFD',0   ; DATA XREF: .rdata:off_100359A8o
aSsl_resethands	db 'SSL_ResetHandshake',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_restarthan	db 'SSL_RestartHandshakeAfterCertReq',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_restarth_0	db 'SSL_RestartHandshakeAfterServerCert',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_revealcert	db 'SSL_RevealCert',0   ; DATA XREF: .rdata:off_100359A8o
aSsl_revealpina	db 'SSL_RevealPinArg',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_revealurl	db 'SSL_RevealURL',0    ; DATA XREF: .rdata:off_100359A8o
aSsl_snisocketc	db 'SSL_SNISocketConfigHook',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_securityst	db 'SSL_SecurityStatus',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setcanfals	db 'SSL_SetCanFalseStartCallback',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setmaxserv	db 'SSL_SetMaxServerCacheLocks',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setnextpro	db 'SSL_SetNextProtoCallback',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setnextp_0	db 'SSL_SetNextProtoNego',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setpkcs11p	db 'SSL_SetPKCS11PinArg',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setsrtpcip	db 'SSL_SetSRTPCiphers',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setsockpee	db 'SSL_SetSockPeerID',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_setstapled	db 'SSL_SetStapledOCSPResponses',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_settrustan	db 'SSL_SetTrustAnchors',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_seturl	db 'SSL_SetURL',0       ; DATA XREF: .rdata:off_100359A8o
aSsl_shutdownse	db 'SSL_ShutdownServerSessionIDCache',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_versionran	db 'SSL_VersionRangeGet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_versionr_0	db 'SSL_VersionRangeGetDefault',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_versionr_1	db 'SSL_VersionRangeGetSupported',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_versionr_2	db 'SSL_VersionRangeSet',0 ; DATA XREF: .rdata:off_100359A8o
aSsl_versionr_3	db 'SSL_VersionRangeSetDefault',0 ; DATA XREF: .rdata:off_100359A8o
		align 1000h
_rdata		ends

; Section 3. (virtual address 00037000)
; Virtual size			: 00000EC8 (   3784.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00035600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 10037000h
word_10037000	dw 0C02Bh		; DATA XREF: sub_100075E0:loc_100075F0r
					; sub_100075E0:loc_10007611o ...
		dw 1
		dd 1C02Fh, 1C00Ah, 1C009h, 1C013h, 1C023h, 1C027h, 1C014h
		dd 1C008h, 1C012h, 1C007h, 1C011h, 101009Eh, 1010033h
		dd 1010032h, 1010067h, 10045h, 10044h, 1010039h, 1010038h
		dd 101006Bh, 10088h, 10087h, 1010016h, 1010013h, 10066h
		dd 1C004h, 1C00Eh, 1C005h, 1C00Fh, 1C003h, 1C00Dh, 1C002h
		dd 1C00Ch, 101009Ch, 101002Fh, 101003Ch, 10041h, 1010035h
		dd 101003Dh, 10084h, 10096h, 1FEFFh, 101000Ah, 1010005h
		dd 1010004h, 10015h, 10012h, 1FEFEh, 10009h, 10064h, 10062h
		dd 10003h, 10006h, 1C006h, 1C010h, 1C00Bh, 1C001h, 10002h
		dd 1003Bh, 10001h
		dd offset aSecurity_versi ; "SECURITY_VERSION: +us +export"
word_100370F8	dw 0FFh			; DATA XREF: sub_10010E20+2Aw
					; sub_10010E20+36w ...
		align 4
dword_100370FC	dd 64h			; DATA XREF: sub_10011D60+6Dr
					; .text:1001838Br
dword_10037100	dd 15180h		; DATA XREF: sub_1000CB90+3A3r
					; .text:loc_100183C5r
dword_10037104	dd 100h			; DATA XREF: sub_1001B0B0:loc_1001B122r
					; SSL_GetMaxServerCacheLocksr ...
dword_10037108	dd 0			; DATA XREF: sub_1001EB40+30r
dword_1003710C	dd 0			; DATA XREF: sub_1001EB40+38r
dword_10037110	dd 0			; DATA XREF: sub_1001EB40+41r
dword_10037114	dd 0A902011h		; DATA XREF: SSL_CipherPrefSetDefault+23r
					; sub_1001E990+83r ...
word_10037118	dw 300h			; DATA XREF: SSL_VersionRangeGetDefault+28o
					; SSL_VersionRangeSetDefault:loc_1001D561o ...
word_1003711A	dw 301h			; DATA XREF: SSL_OptionGetDefault+ADr
dword_1003711C	dd 3020302h		; DATA XREF: SSL_VersionRangeGetDefault+2Fo
					; SSL_VersionRangeSetDefault+6Ao ...
dword_10037120	dd 1			; DATA XREF: sub_1001E8F0+5Dr
		dd 6B636F4Ch, 72612073h
		db 65h,	20h
dword_1003712E	dd 42414E45h		; DATA XREF: sub_1001E990+D6w
					; SSL_OptionSet+38Fw ...
dword_10037132	dd 2E44454Ch		; DATA XREF: sub_1001E990+DCw
					; SSL_OptionSet+395w ...
word_10037136	dw 2020h		; DATA XREF: sub_1001E990+E1w
					; SSL_OptionSet+39Bw ...
		dd 0
dword_1003713C	dd 2000h		; DATA XREF: sub_1001E250+18r
dword_10037140	dd 400h			; DATA XREF: sub_1001E250+1Dr
dword_10037144	dd 1			; DATA XREF: sub_1001E990r
					; sub_1001E990+19w
off_10037148	dd offset aFreebl3_dll	; DATA XREF: sub_10022270r
					; "freebl3.dll"
off_1003714C	dd offset aSoftokn3_dll	; DATA XREF: sub_10022200r
					; "softokn3.dll"
off_10037150	dd offset dword_10033330 ; DATA	XREF: sub_10027BE0+24o
		dd offset dword_100331E0
		dd 101h, 11Eh, 0Fh
off_10037164	dd offset dword_100337B0 ; DATA	XREF: sub_10027BE0+2Eo
		dd offset dword_10033268
		align 10h
		dd 1Eh,	0Fh
dword_10037178	dd 0			; DATA XREF: sub_10027BE0+3Eo
		dd offset dword_10033278+68h
		dd 0
		dd 13h,	7
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10001000+Cr
					; sub_10001710+Cr ...
dword_10037190	dd 44BF19B1h		; DATA XREF: sub_10029911+B0r
					; sub_10029C56+2Bw ...
		align 10h
dword_100371A0	dd 19930520h, 3	dup(0)	; DATA XREF: .text:10029A9Ao
					; sub_10029AA1+2o
dword_100371B0	dd 0FFFFFFFFh		; DATA XREF: DllEntryPoint-242w
					; sub_100298F0w
		dd 0FFFFFFFFh, 400h, 0FFFFFC01h, 35h, 0Bh, 40h,	3FFh, 80h
		dd 0FFFFFF81h, 18h, 8, 20h, 7Fh, 2 dup(0)
		dd 4002A000h, 2	dup(0)
		dd 4005C800h, 2	dup(0)
		dd 4008FA00h, 2	dup(0)
		dd 400C9C40h, 2	dup(0)
		dd 400FC350h, 2	dup(0)
		dd 4012F424h, 0
		dd 80000000h, 40169896h, 0
		dd 20000000h, 4019BEBCh, 0
		dd 0C9BF0400h, 40348E1Bh, 0A1000000h, 1BCECCEDh, 404ED3C2h
		dd 0B59EF020h, 0ADA82B70h, 40699DC5h, 25FD5DD0h, 4F8E1AE5h
		dd 4083EB19h, 95D79671h, 8D050E43h, 409EAF29h, 44A0BFF9h
		dd 8F1281EDh, 40B98281h, 0A6D53CBFh, 1F49FFCFh,	40D3C278h
		dd 8CE0C66Fh, 47C980E9h, 41A893BAh, 556B85BCh, 0F78D3927h
		dd 427CE070h, 0DE8EDDBCh, 0EBFB9DF9h, 4351AA7Eh, 0E376E6A1h
		dd 2F29F2CCh, 44268184h, 0AA171028h, 0E310AEF8h, 44FAC4C5h
		dd 0F3D4A7EBh, 4AE1EBF7h, 45CF957Ah, 91C7CC65h,	0A0AEA60Eh
		dd 46A3E319h, 0C17650Dh, 75868175h, 4D48C976h, 0A7E44258h
		dd 353B3993h, 53EDB2B8h, 5DE5A74Dh, 3B5DC53Dh, 5A929E8Bh
		dd 0F0A65DFFh, 54C020A1h, 61378CA5h, 5A8BFDD1h,	5D25D88Bh
		dd 67DBF989h, 0F3F895AAh, 0C8A2BF27h, 6E80DD5Dh, 979BC94Ch
		dd 52028A20h, 7525C460h, 0
		dd 0CCCDCCCDh, 0CCCCCCCCh, 3FFBCCCCh, 0D70A3D71h, 0A3D70A3h
		dd 3FF8A3D7h, 0DF3B645Ah, 6E978D4Fh, 3FF58312h,	652CD3C3h
		dd 1758E219h, 3FF1D1B7h, 84230FD0h, 0AC471B47h,	3FEEA7C5h
		dd 69B6A640h, 0BD05AF6Ch, 3FEB8637h, 42BC3D33h,	94D5E57Ah
		dd 3FE7D6BFh, 0CEFDFDC2h, 77118461h, 3FE4ABCCh,	0E15B4C2Fh
		dd 94BEC44Dh, 3FC9E695h, 3B53C492h, 14CD4475h, 3FAF9ABEh
		dd 94BA67DEh, 1EAD4539h, 3F94CFB1h, 0E2C62324h,	313BBABCh
		dd 3F7A8B61h, 0C1595561h, 7C53B17Eh, 3F5FBB12h,	8D2FEED7h
		dd 8592BE06h, 3F44FB15h, 0E9A53F24h, 0EA27A539h, 3F2AA87Fh
		dd 0E4A1AC7Dh, 467C64BCh, 3E55DDD0h, 0CC067B63h, 83775423h
		dd 3D8191FFh, 193AFA91h, 4325637Ah, 3CACC031h, 38D18921h
		dd 0B8974782h, 3BD7FD00h, 85888DCh, 0E3E8B11Bh,	3B03A686h
		dd 424584C6h, 7599B607h, 3A2EDB37h, 0D21C7133h,	0EE32DB23h
		dd 395A9049h, 0C0BE87A6h, 82A5DA57h, 32B5A2A6h,	11B268E2h
		dd 449F52A7h, 2C10B759h, 2DE44925h, 534F3436h, 256BCEAEh
		dd 0A404598Fh, 7DC2DEC0h, 1EC6E8FBh, 5A88E79Eh,	0BF3C9157h
		dd 18228350h, 62654B4Eh, 0AF8F83FDh, 117D9406h,	9FDE2DE4h
		dd 4C8D2CEh, 0AD8A6DDh,	3 dup(0)
dword_100374B0	dd 8 dup(0)		; DATA XREF: sub_10001000+3C3o
dword_100374D0	dd 0			; DATA XREF: SSL_GetStatisticso
					; sub_10009320:loc_100094E4o
dword_100374D4	dd 0			; DATA XREF: sub_10009320:loc_10009567o
dword_100374D8	dd 0			; DATA XREF: sub_10009320:loc_1000953Ao
dword_100374DC	dd 0			; DATA XREF: sub_1000A6D0+61Eo
dword_100374E0	dd 0			; DATA XREF: sub_1000A6D0:loc_1000AD5Ao
dword_100374E4	dd 0			; DATA XREF: sub_1000A6D0:loc_1000ABB0o
dword_100374E8	dd 0			; DATA XREF: sub_1000D820+980o
dword_100374EC	dd 0			; DATA XREF: sub_1000D820:loc_1000E3D3o
					; sub_1000E730:loc_1000EAC3o
dword_100374F0	dd 0			; DATA XREF: sub_1000D820:loc_1000DD29o
					; sub_1000D820:loc_1000E3A4o
dword_100374F4	dd 0			; DATA XREF: sub_10009320+8E4o
dword_100374F8	dd 0			; DATA XREF: sub_1000A6D0+631o
dword_100374FC	dd 3 dup(0)		; DATA XREF: sub_1000D820+993o
dword_10037508	dd 3Eh dup(0)		; DATA XREF: sub_10005FC0+15o
					; sub_10006050+7Fo
		dd 12h dup(?)
dword_10037648	dd ?			; DATA XREF: sub_10005FC0+40o
					; sub_1000BCA0+2Er ...
dword_1003764C	dd ?			; DATA XREF: sub_10005F80r
					; sub_10005F80+13w ...
word_10037650	dw ?			; DATA XREF: sub_10010D30+33w
					; sub_10010D30+4Cw ...
		align 4
word_10037654	dw ?			; DATA XREF: sub_10010D30+2Cw
					; sub_10010D30+45w ...
		align 4
dword_10037658	dd ?			; DATA XREF: sub_10010D30+7Aw
dword_1003765C	dd 3 dup(?)		; DATA XREF: sub_10014830+5o
dword_10037668	dd ?			; DATA XREF: sub_10014850r
					; sub_10014850:loc_10014873w
		align 10h
dword_10037670	dd ?			; DATA XREF: sub_100148B0+3Aw
					; sub_10014900+A3w ...
dword_10037674	dd ?			; DATA XREF: sub_100148B0+3Fw
					; sub_10014900+A8w
dword_10037678	dd ?			; DATA XREF: sub_100148B0+44w
					; sub_10014900+ADw
		align 10h
dword_10037680	dd 40h dup(?)		; DATA XREF: sub_10016AC0+4Co
dword_10037780	dd 8 dup(?)		; DATA XREF: .text:10014A20o
					; sub_10014A60+30o
dword_100377A0	dd ?			; DATA XREF: sub_10014900+23w
					; .text:10014A2Aw ...
byte_100377A4	db ?			; DATA XREF: sub_10014900+34w
					; sub_10014900+40o ...
		align 10h
dword_100377B0	dd 8 dup(?)		; DATA XREF: .text:10014A1Bo
					; sub_10014A60+40o
dword_100377D0	dd ?			; DATA XREF: sub_100148B0r
					; sub_100148B0+12w ...
dword_100377D4	dd ?			; DATA XREF: sub_100148B0:loc_100148CCr
					; sub_100148B0+2Ew ...
dword_100377D8	dd ?			; DATA XREF: .text:loc_10014A45w
					; sub_10014A60:loc_10014A7Br
dword_100377DC	dd ?			; DATA XREF: sub_10017E10+4Aw
					; sub_10017EA0+15o ...
dword_100377E0	dd ?			; DATA XREF: sub_10017E10+4Fw
dword_100377E4	dd ?			; DATA XREF: sub_10017E10+54w
dword_100377E8	dd ?			; DATA XREF: .text:10018054o
					; .text:1001805Br ...
dword_100377EC	dd ?			; DATA XREF: sub_10017D20+Ew
					; sub_10017D20+2Br ...
dword_100377F0	dd ?			; DATA XREF: sub_10017DA0r
					; sub_10017DA0+3Cw ...
dword_100377F4	dd ?			; DATA XREF: .text:10018CEDw
					; SSL_ConfigSecureServerWithCertChain+17Bo
dword_100377F8	dd ?			; DATA XREF: .text:10018CF2w
dword_100377FC	dd ?			; DATA XREF: .text:10018CF8w
dword_10037800	dd ?			; DATA XREF: sub_1001A180:loc_1001A1A2r
					; sub_1001A1E0+AFr ...
		align 8
dword_10037808	dd ?			; DATA XREF: sub_1001AA70+33o
					; sub_1001AA70+B5o ...
dword_1003780C	dd ?			; DATA XREF: sub_1001AA70+53r
					; sub_1001AA70+240r ...
		dd 0Ah dup(?)
dword_10037838	dd ?			; DATA XREF: sub_1001AD50+69r
dword_1003783C	dd ?			; DATA XREF: sub_1001AD50+77r
		dd 4 dup(?)
dword_10037850	dd ?			; DATA XREF: sub_1001AA70+5Cr
					; sub_1001AA70+249r ...
dword_10037854	dd ?			; DATA XREF: sub_1001BE20+2Fr
					; sub_1001BE20:loc_1001BEC6r ...
dword_10037858	dd ?			; DATA XREF: sub_1001AA70+EEr
					; sub_1001AA70:loc_1001ABF2r
dword_1003785C	dd ?			; DATA XREF: sub_1001AA70+1B1r
					; sub_1001AA70:loc_1001AC88r
dword_10037860	dd ?			; DATA XREF: sub_1001AD50+137r
					; sub_1001AD50+162r
dword_10037864	dd ?			; DATA XREF: sub_1001AD50+14Dr
dword_10037868	dd ?			; DATA XREF: sub_1001AA70+108r
dword_1003786C	dd ?			; DATA XREF: sub_1001C070+B8r
dword_10037870	dd ?			; DATA XREF: sub_1001BBA0:loc_1001BBD2r
					; sub_1001BD50+75r ...
dword_10037874	dd ?			; DATA XREF: sub_1001BCB0+3Cr
					; sub_1001BD50+3r ...
dword_10037878	dd ?			; DATA XREF: sub_1001BCB0+4Fr
					; sub_1001BD50+40r ...
dword_1003787C	dd ?			; DATA XREF: sub_1001BE20:loc_1001BE80r
					; sub_1001BE20+8Dr ...
dword_10037880	dd ?			; DATA XREF: sub_1001AA70+1CAr
dword_10037884	dd ?			; DATA XREF: sub_1001BBA0+Er
					; sub_1001BCB0+34r ...
		dd ?
dword_1003788C	dd ?			; DATA XREF: sub_1001B550+52r
		dd 3 dup(?)
dword_1003789C	dd ?			; DATA XREF: sub_1001B550+36w
					; sub_1001B760+31r ...
dword_100378A0	dd 3 dup(?)		; DATA XREF: sub_1001E870+14o
					; sub_1001FF60+10Co
dword_100378AC	dd ?			; DATA XREF: sub_1001C550+16w
					; sub_1001C5A0+5o
dword_100378B0	dd ?			; DATA XREF: sub_1001C550+1Bw
dword_100378B4	dd ?			; DATA XREF: sub_1001C550+21w
dword_100378B8	dd ?			; DATA XREF: sub_1001E6F0+1Ao
					; sub_1001E6F0+12Cw ...
dword_100378BC	dd ?			; DATA XREF: sub_1001E6F0+27w
dword_100378C0	dd ?			; DATA XREF: sub_1001E6F0+31w
dword_100378C4	dd ?			; DATA XREF: sub_1001E6F0+3Dw
dword_100378C8	dd ?			; DATA XREF: sub_1001E6F0+49w
dword_100378CC	dd ?			; DATA XREF: sub_1001E6F0+53w
dword_100378D0	dd ?			; DATA XREF: sub_1001E6F0+5Fw
dword_100378D4	dd ?			; DATA XREF: sub_1001E6F0+6Bw
dword_100378D8	dd ?			; DATA XREF: sub_1001E6F0+75w
dword_100378DC	dd ?			; DATA XREF: sub_1001E6F0+81w
dword_100378E0	dd ?			; DATA XREF: sub_1001E6F0+8Dw
dword_100378E4	dd ?			; DATA XREF: sub_1001E6F0+97w
dword_100378E8	dd ?			; DATA XREF: sub_1001E6F0+A3w
dword_100378EC	dd ?			; DATA XREF: sub_1001E6F0+AFw
dword_100378F0	dd ?			; DATA XREF: sub_1001E6F0+B9w
dword_100378F4	dd ?			; DATA XREF: sub_1001E6F0+C5w
dword_100378F8	dd ?			; DATA XREF: sub_1001E6F0+D1w
dword_100378FC	dd ?			; DATA XREF: sub_1001E6F0+DBw
dword_10037900	dd ?			; DATA XREF: sub_1001E6F0+E7w
dword_10037904	dd ?			; DATA XREF: sub_1001E6F0+F3w
dword_10037908	dd ?			; DATA XREF: sub_1001E6F0+FDw
dword_1003790C	dd ?			; DATA XREF: sub_1001E6F0+109w
dword_10037910	dd ?			; DATA XREF: sub_1001E6F0+115w
dword_10037914	dd ?			; DATA XREF: sub_1001E6F0+11Fw
dword_10037918	dd ?			; DATA XREF: sub_1001E6F0+136w
dword_1003791C	dd ?			; DATA XREF: sub_1001E6F0+13Cw
		dd 4 dup(?)
dword_10037930	dd ?			; DATA XREF: sub_1001E6F0+141w
		dd 5 dup(?)
dword_10037948	dd ?			; DATA XREF: sub_1001C160r
					; SSL_OptionGet+1r ...
dword_1003794C	dd ?			; DATA XREF: .text:1001E858w
					; sub_1001E870r ...
dword_10037950	dd ?			; DATA XREF: sub_10020F90+2o
					; sub_10020F90+2Bo ...
dword_10037954	dd ?			; DATA XREF: .text:10020FEEw
					; .text:100210D9w ...
dword_10037958	dd 80h dup(?)		; DATA XREF: sub_10021100+16o
					; sub_10021100+3Co
dword_10037B58	dd ?			; DATA XREF: .text:1002231Eo
					; .text:1002234Eo ...
dword_10037B5C	dd ?			; DATA XREF: sub_10022820+55w
dword_10037B60	dd ?			; DATA XREF: sub_10022820+5Bw
dword_10037B64	dd ?			; DATA XREF: sub_10022270+6Cw
					; sub_10022820r ...
dword_10037B68	dd ?			; DATA XREF: sub_10022270+73w
					; .text:loc_10022310r ...
dword_10037B6C	dd ?			; DATA XREF: sub_10022270+78w
dword_10037B70	dd ?			; DATA XREF: sub_10029518+Fr
					; sub_10029518+17w ...
dword_10037B74	dd ?			; DATA XREF: DllEntryPoint-20Fw
					; DllEntryPoint-60r
dword_10037B78	dd ?			; DATA XREF: sub_10029911+91w
					; .rdata:ExceptionInfoo
dword_10037B7C	dd ?			; DATA XREF: sub_10029911+9Bw
		dd ?
dword_10037B84	dd ?			; DATA XREF: sub_10029911+8Cw
		dd 10h dup(?)
dword_10037BC8	dd ?			; DATA XREF: sub_10029911+7Dw
					; .rdata:ExceptionInfoo
		dd 22h dup(?)
word_10037C54	dw ?			; DATA XREF: sub_10029911+51w
		align 4
word_10037C58	dw ?			; DATA XREF: sub_10029911+4Aw
		align 4
word_10037C5C	dw ?			; DATA XREF: sub_10029911+43w
		align 10h
word_10037C60	dw ?			; DATA XREF: sub_10029911+3Cw
		align 4
dword_10037C64	dd ?			; DATA XREF: sub_10029911+28w
dword_10037C68	dd ?			; DATA XREF: sub_10029911+22w
dword_10037C6C	dd ?			; DATA XREF: sub_10029911+1Cw
dword_10037C70	dd ?			; DATA XREF: sub_10029911+16w
dword_10037C74	dd ?			; DATA XREF: sub_10029911+10w
dword_10037C78	dd ?			; DATA XREF: sub_10029911+Bw
dword_10037C7C	dd ?			; DATA XREF: sub_10029911+62w
dword_10037C80	dd ?			; DATA XREF: sub_10029911+6Aw
					; sub_10029911+87r
word_10037C84	dw ?			; DATA XREF: sub_10029911+35w
		align 4
dword_10037C88	dd ?			; DATA XREF: sub_10029911+59w
dword_10037C8C	dd ?			; DATA XREF: sub_10029911+72w
word_10037C90	dw ?			; DATA XREF: sub_10029911+2Ew
		align 4
		dd 80h dup(?)
dword_10037E94	dd ?			; DATA XREF: SSL_OptionSet+389w
					; SSL_OptionSetDefault+2B8w
; FILE *File
File		dd ?			; DATA XREF: sub_10006BF0+14r
					; sub_10006BF0:loc_10006E45r ...
dword_10037E9C	dd ?			; DATA XREF: sub_10018460+Ar
					; sub_1001B480+59w ...
dword_10037EA0	dd ?			; DATA XREF: sub_1001E990+CCw
					; sub_1001EB40+Er ...
dword_10037EA4	dd ?			; DATA XREF: sub_10018460+13r
					; sub_1001B480+63w ...
dword_10037EA8	dd ?			; DATA XREF: sub_1000D820+49Br
					; sub_10013DA0+28Br ...
dword_10037EAC	dd ?			; DATA XREF: sub_10029518:loc_10029594r
					; sub_10029518+9Bw ...
; volatile LONG	Target
Target		dd ?			; DATA XREF: sub_10029518+24o
					; sub_10029518+53o
dword_10037EB4	dd ?			; DATA XREF: sub_100294F6+11w
					; sub_10029518+13Ar ...
; void *Memory
Memory		dd ?			; DATA XREF: sub_100294F6+Cw
					; sub_10029518:loc_10029648r ...
dword_10037EBC	dd ?			; DATA XREF: DllEntryPoint:loc_100296E0r
					; DllEntryPoint-E6r ...
dword_10037EC0	dd ?			; DATA XREF: sub_10029518:loc_100295F2r
					; sub_10029518+E2o ...
dword_10037EC4	dd ?			; DATA XREF: sub_10029330+E6r
					; sub_10029330+EFo ...
		align 200h
_data		ends


		end DllEntryPoint
