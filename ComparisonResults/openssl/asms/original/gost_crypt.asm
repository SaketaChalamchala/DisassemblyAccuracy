; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_imit_gost_cpa
PUBLIC	_gost_cipher_list
PUBLIC	_cipher_gost
PUBLIC	_cipher_gost_cpacnt
EXTRN	_GostR3411_94_CryptoProParamSet:BYTE
EXTRN	_Gost28147_TestParamSet:BYTE
EXTRN	_Gost28147_CryptoProParamSetA:BYTE
EXTRN	_Gost28147_CryptoProParamSetB:BYTE
EXTRN	_Gost28147_CryptoProParamSetC:BYTE
EXTRN	_Gost28147_CryptoProParamSetD:BYTE
_DATA	SEGMENT
_imit_gost_cpa DD 032fH
	DD	00H
	DD	04H
	DD	00H
	DD	FLAT:_gost_imit_init_cpa
	DD	FLAT:_gost_imit_update
	DD	FLAT:_gost_imit_final
	DD	FLAT:_gost_imit_copy
	DD	FLAT:_gost_imit_cleanup
	DD	00H
	DD	00H
	DD	00H
	DD	00H
	DD	00H
	DD	00H
	DD	00H
	DD	08H
	DD	01040H
	DD	FLAT:_gost_imit_ctrl
_cipher_gost DD	032dH
	DD	01H
	DD	020H
	DD	08H
	DD	0333H
	DD	FLAT:_gost_cipher_init
	DD	FLAT:_gost_cipher_do_cfb
	DD	FLAT:_gost_cipher_cleanup
	DD	0102cH
	DD	FLAT:_gost89_set_asn1_parameters
	DD	FLAT:_gost89_get_asn1_parameters
	DD	FLAT:_gost_cipher_ctl
	DD	00H
_gost_cipher_list DD 0351H
	DD	FLAT:_GostR3411_94_CryptoProParamSet
	DD	00H
	DD	0338H
	DD	FLAT:_Gost28147_CryptoProParamSetA
	DD	01H
	DD	0339H
	DD	FLAT:_Gost28147_CryptoProParamSetB
	DD	01H
	DD	033aH
	DD	FLAT:_Gost28147_CryptoProParamSetC
	DD	01H
	DD	033bH
	DD	FLAT:_Gost28147_CryptoProParamSetD
	DD	01H
	DD	0337H
	DD	FLAT:_Gost28147_TestParamSet
	DD	01H
	DD	00H
	DD	00H
	DD	00H
_cipher_gost_cpacnt DD 032eH
	DD	01H
	DD	020H
	DD	08H
	DD	0334H
	DD	FLAT:_gost_cipher_init_cpa
	DD	FLAT:_gost_cipher_do_cnt
	DD	FLAT:_gost_cipher_cleanup
	DD	0102cH
	DD	FLAT:_gost89_set_asn1_parameters
	DD	FLAT:_gost89_get_asn1_parameters
	DD	FLAT:_gost_cipher_ctl
	DD	00H
_DATA	ENDS
PUBLIC	_get_encryption_params
PUBLIC	??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@ ; `string'
EXTRN	_gostcrypt:PROC
EXTRN	_gost_key:PROC
EXTRN	_gost_init:PROC
EXTRN	_gost_destroy:PROC
EXTRN	_mac_block:PROC
EXTRN	_get_mac:PROC
EXTRN	_cryptopro_key_meshing:PROC
EXTRN	_RAND_bytes:PROC
EXTRN	_ERR_GOST_error:PROC
EXTRN	_CRYPTO_malloc:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_ASN1_TYPE_get:PROC
EXTRN	_ASN1_TYPE_set:PROC
EXTRN	_ASN1_OBJECT_free:PROC
EXTRN	_ASN1_OCTET_STRING_new:PROC
EXTRN	_ASN1_OCTET_STRING_set:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_OBJ_txt2nid:PROC
EXTRN	_EVP_CIPHER_CTX_iv_length:PROC
EXTRN	_get_gost_engine_param:PROC
EXTRN	_GOST_CIPHER_PARAMS_new:PROC
EXTRN	_GOST_CIPHER_PARAMS_free:PROC
EXTRN	_d2i_GOST_CIPHER_PARAMS:PROC
EXTRN	_i2d_GOST_CIPHER_PARAMS:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	_memcpy:PROC
EXTRN	_memset:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
CONST	SEGMENT
??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@ DB '.\engines\c'
	DB	'cgost\gost_crypt.c', 00H			; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _mac_block_mesh
_TEXT	SEGMENT
_buffer$ = -12						; size = 8
__$ArrayPad$ = -4					; size = 4
_c$ = 8							; size = 4
_data$ = 12						; size = 4
_mac_block_mesh PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 518
	mov	eax, 12					; 0000000cH
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+12], eax
	push	esi
	mov	esi, DWORD PTR _c$[esp+12]
	push	edi
	mov	edi, DWORD PTR _data$[esp+16]
; Line 526
	cmp	DWORD PTR [esi+4148], 0
	je	SHORT $LN2@mac_block_
	cmp	DWORD PTR [esi+4144], 1024		; 00000400H
	jne	SHORT $LN2@mac_block_
; Line 527
	lea	eax, DWORD PTR _buffer$[esp+20]
	push	eax
	push	esi
	call	_cryptopro_key_meshing
	add	esp, 8
$LN2@mac_block_:
; Line 529
	push	edi
	lea	eax, DWORD PTR [esi+4128]
	push	eax
	push	esi
	call	_mac_block
; Line 530
	mov	eax, DWORD PTR [esi+4144]
	add	esp, 12					; 0000000cH
; Line 531
	mov	ecx, DWORD PTR __$ArrayPad$[esp+20]
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [esi+4144], eax
	pop	edi
	pop	esi
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
_mac_block_mesh ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cnt_next
_TEXT	SEGMENT
_buf1$ = -12						; size = 8
__$ArrayPad$ = -4					; size = 4
_ctx$ = 8						; size = 4
_iv$ = 12						; size = 4
_buf$ = 16						; size = 4
_gost_cnt_next PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 241
	mov	eax, 12					; 0000000cH
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+12], eax
	push	ebp
	mov	ebp, DWORD PTR _buf$[esp+12]
	push	esi
	mov	esi, DWORD PTR _ctx$[esp+16]
	push	edi
	mov	edi, DWORD PTR _iv$[esp+20]
; Line 246
	cmp	DWORD PTR [esi+8], 0
	je	SHORT $LN2@gost_cnt_n
	cmp	DWORD PTR [esi+4], 1024			; 00000400H
	jne	SHORT $LN2@gost_cnt_n
; Line 247
	lea	eax, DWORD PTR [esi+12]
	push	edi
	push	eax
	call	_cryptopro_key_meshing
	add	esp, 8
$LN2@gost_cnt_n:
; Line 249
	cmp	DWORD PTR [esi+4], 0
	push	ebx
	jne	SHORT $LN3@gost_cnt_n
; Line 250
	lea	eax, DWORD PTR _buf1$[esp+28]
	push	eax
	lea	eax, DWORD PTR [esi+12]
	push	edi
	push	eax
	call	_gostcrypt
; Line 251
	mov	edx, DWORD PTR _buf1$[esp+44]
	add	esp, 12					; 0000000cH
	mov	ebx, DWORD PTR _buf1$[esp+28]
	jmp	SHORT $LN4@gost_cnt_n
$LN3@gost_cnt_n:
; Line 252
	mov	ebx, DWORD PTR [edi]
	mov	edx, DWORD PTR [edi+4]
	mov	DWORD PTR _buf1$[esp+28], ebx
	mov	DWORD PTR _buf1$[esp+32], edx
$LN4@gost_cnt_n:
; Line 254
	mov	ecx, ebx
	mov	eax, ebx
	shr	ecx, 24					; 00000018H
; Line 255
	shl	ecx, 8
	shr	eax, 16					; 00000010H
	movzx	eax, al
	or	ecx, eax
	shr	ebx, 8
	shl	ecx, 8
	movzx	eax, bl
	or	ecx, eax
	movzx	eax, BYTE PTR _buf1$[esp+28]
	shl	ecx, 8
	or	ecx, eax
	add	ecx, 16843009				; 01010101H
; Line 257
	mov	eax, ecx
	mov	BYTE PTR _buf1$[esp+28], cl
	shr	eax, 8
	mov	BYTE PTR _buf1$[esp+29], al
; Line 258
	mov	eax, ecx
; Line 259
	shr	ecx, 24					; 00000018H
	shr	eax, 16					; 00000010H
	mov	BYTE PTR _buf1$[esp+31], cl
; Line 260
	mov	ecx, edx
	mov	BYTE PTR _buf1$[esp+30], al
	mov	eax, edx
	shr	ecx, 24					; 00000018H
	shl	ecx, 8
	shr	eax, 16					; 00000010H
	movzx	eax, al
	or	ecx, eax
	shr	edx, 8
	shl	ecx, 8
	movzx	eax, dl
	or	ecx, eax
	movzx	eax, BYTE PTR _buf1$[esp+32]
	shl	ecx, 8
	or	ecx, eax
; Line 261
	mov	eax, ecx
; Line 262
	add	ecx, 16843012				; 01010104H
	pop	ebx
; Line 263
	cmp	eax, ecx
	jbe	SHORT $LN5@gost_cnt_n
; Line 264
	inc	ecx
$LN5@gost_cnt_n:
; Line 266
	mov	eax, ecx
	mov	BYTE PTR _buf1$[esp+28], cl
	shr	eax, 8
	mov	BYTE PTR _buf1$[esp+29], al
; Line 267
	mov	eax, ecx
	shr	eax, 16					; 00000010H
	mov	BYTE PTR _buf1$[esp+30], al
; Line 269
	mov	eax, DWORD PTR _buf1$[esp+24]
	shr	ecx, 24					; 00000018H
	mov	DWORD PTR [edi], eax
	mov	BYTE PTR _buf1$[esp+31], cl
	mov	eax, DWORD PTR _buf1$[esp+28]
	mov	DWORD PTR [edi+4], eax
; Line 270
	lea	eax, DWORD PTR _buf1$[esp+24]
	push	ebp
	push	eax
	lea	eax, DWORD PTR [esi+12]
	push	eax
	call	_gostcrypt
; Line 271
	mov	eax, DWORD PTR [esi+4]
	add	esp, 12					; 0000000cH
; Line 272
	mov	ecx, DWORD PTR __$ArrayPad$[esp+24]
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [esi+4], eax
	pop	edi
	pop	esi
	pop	ebp
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
_gost_cnt_next ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_crypt_mesh
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_iv$ = 12						; size = 4
_buf$ = 16						; size = 4
_gost_crypt_mesh PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 230
	push	esi
; Line 233
	mov	esi, DWORD PTR _ctx$[esp]
	cmp	DWORD PTR [esi+8], 0
	je	SHORT $LN2@gost_crypt
	cmp	DWORD PTR [esi+4], 1024			; 00000400H
	jne	SHORT $LN2@gost_crypt
; Line 234
	push	DWORD PTR _iv$[esp]
	lea	eax, DWORD PTR [esi+12]
	push	eax
	call	_cryptopro_key_meshing
	add	esp, 8
$LN2@gost_crypt:
; Line 236
	push	DWORD PTR _buf$[esp]
	lea	eax, DWORD PTR [esi+12]
	push	DWORD PTR _iv$[esp+4]
	push	eax
	call	_gostcrypt
; Line 237
	mov	eax, DWORD PTR [esi+4]
	add	esp, 12					; 0000000cH
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [esi+4], eax
	pop	esi
; Line 238
	ret	0
_gost_crypt_mesh ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_init_param
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_key$ = 12						; size = 4
_iv$ = 16						; size = 4
_enc$ = 20						; size = 4
_paramNID$ = 24						; size = 4
_mode$ = 28						; size = 4
_gost_cipher_init_param PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 187
	push	esi
; Line 188
	mov	esi, DWORD PTR _ctx$[esp]
	push	edi
; Line 189
	cmp	DWORD PTR [esi+84], 0
	mov	edi, DWORD PTR [esi+96]
	jne	SHORT $LN2@gost_ciphe
; Line 170
	mov	eax, DWORD PTR _paramNID$[esp+4]
	test	eax, eax
	je	SHORT $LN11@gost_ciphe
$LN10@gost_ciphe:
	push	eax
	call	_OBJ_nid2obj
	add	esp, 4
$LN11@gost_ciphe:
	push	eax
	call	_get_encryption_params
	add	esp, 4
; Line 172
	test	eax, eax
	je	SHORT $LN12@gost_ciphe
; Line 175
	mov	ecx, DWORD PTR [eax]
	mov	DWORD PTR [edi], ecx
; Line 176
	mov	ecx, DWORD PTR [eax+8]
	mov	DWORD PTR [edi+8], ecx
; Line 177
	mov	DWORD PTR [edi+4], 0
; Line 178
	push	DWORD PTR [eax+4]
	lea	eax, DWORD PTR [edi+12]
	push	eax
	call	_gost_init
; Line 192
	mov	eax, DWORD PTR [esi+96]
; Line 178
	add	esp, 8
; Line 192
	mov	DWORD PTR [esi+84], eax
$LN2@gost_ciphe:
; Line 194
	mov	eax, DWORD PTR _key$[esp+4]
	test	eax, eax
	je	SHORT $LN4@gost_ciphe
; Line 195
	push	eax
	lea	eax, DWORD PTR [edi+12]
	push	eax
	call	_gost_key
	add	esp, 8
$LN4@gost_ciphe:
; Line 196
	mov	edi, DWORD PTR _iv$[esp+4]
	test	edi, edi
	je	SHORT $LN5@gost_ciphe
; Line 197
	push	esi
	call	_EVP_CIPHER_CTX_iv_length
	push	eax
	lea	eax, DWORD PTR [esi+16]
	push	edi
	push	eax
	call	_memcpy
	add	esp, 16					; 00000010H
$LN5@gost_ciphe:
; Line 198
	push	esi
	call	_EVP_CIPHER_CTX_iv_length
	push	eax
	lea	eax, DWORD PTR [esi+16]
	push	eax
	lea	eax, DWORD PTR [esi+32]
	push	eax
	call	_memcpy
	add	esp, 16					; 00000010H
; Line 199
	mov	eax, 1
	pop	edi
	pop	esi
; Line 200
	ret	0
$LN12@gost_ciphe:
	pop	edi
; Line 191
	xor	eax, eax
	pop	esi
; Line 200
	ret	0
_gost_cipher_init_param ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_set_param
_TEXT	SEGMENT
_c$ = 8							; size = 4
_nid$ = 12						; size = 4
_gost_cipher_set_param PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 170
	mov	eax, DWORD PTR _nid$[esp-4]
	test	eax, eax
	je	SHORT $LN5@gost_ciphe
$LN4@gost_ciphe:
	push	eax
	call	_OBJ_nid2obj
	add	esp, 4
$LN5@gost_ciphe:
	push	eax
	call	_get_encryption_params
	mov	edx, eax
	add	esp, 4
; Line 172
	test	edx, edx
	jne	SHORT $LN2@gost_ciphe
; Line 180
	ret	0
$LN2@gost_ciphe:
; Line 175
	mov	ecx, DWORD PTR _c$[esp-4]
	mov	eax, DWORD PTR [edx]
	mov	DWORD PTR [ecx], eax
; Line 176
	mov	eax, DWORD PTR [edx+8]
	mov	DWORD PTR [ecx+8], eax
; Line 178
	lea	eax, DWORD PTR [ecx+12]
	mov	DWORD PTR [ecx+4], 0
	push	DWORD PTR [edx+4]
	push	eax
	call	_gost_init
	add	esp, 8
; Line 179
	mov	eax, 1
; Line 180
	ret	0
_gost_cipher_set_param ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_ctrl
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_type$ = 12						; size = 4
_arg$ = 16						; size = 4
_ptr$ = 20						; size = 4
_gost_imit_ctrl PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 590
	mov	eax, DWORD PTR _type$[esp-4]
	sub	eax, 4099				; 00001003H
	je	SHORT $LN4@gost_imit_
	sub	eax, 1
	jne	SHORT $LN10@gost_imit_
; Line 596
	cmp	DWORD PTR _arg$[esp-4], 32		; 00000020H
	je	SHORT $LN6@gost_imit_
; Line 597
	push	597					; 00000255H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	111					; 0000006fH
	push	114					; 00000072H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
$LN10@gost_imit_:
; Line 598
	xor	eax, eax
; Line 610
	ret	0
$LN6@gost_imit_:
	push	esi
; Line 601
	mov	esi, DWORD PTR _ctx$[esp]
	push	DWORD PTR _ptr$[esp]
	push	DWORD PTR [esi+12]
	call	_gost_key
; Line 603
	mov	eax, DWORD PTR [esi+12]
	add	esp, 8
	mov	DWORD PTR [eax+4156], 1
	mov	eax, 1
	pop	esi
; Line 610
	ret	0
$LN4@gost_imit_:
; Line 592
	mov	eax, DWORD PTR _ptr$[esp-4]
	mov	DWORD PTR [eax], 32			; 00000020H
; Line 593
	mov	eax, 1
; Line 610
	ret	0
_gost_imit_ctrl ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_cleanup
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_gost_imit_cleanup PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 621
	mov	eax, DWORD PTR _ctx$[esp-4]
	push	4160					; 00001040H
	push	0
	push	DWORD PTR [eax+12]
	call	_memset
	add	esp, 12					; 0000000cH
; Line 622
	mov	eax, 1
; Line 623
	ret	0
_gost_imit_cleanup ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_copy
_TEXT	SEGMENT
_to$ = 8						; size = 4
_from$ = 12						; size = 4
_gost_imit_copy PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 614
	mov	eax, DWORD PTR _from$[esp-4]
	push	4160					; 00001040H
	push	DWORD PTR [eax+12]
	mov	eax, DWORD PTR _to$[esp+4]
	push	DWORD PTR [eax+12]
	call	_memcpy
	add	esp, 12					; 0000000cH
; Line 615
	mov	eax, 1
; Line 616
	ret	0
_gost_imit_copy ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_final
_TEXT	SEGMENT
_buffer$1 = -12						; size = 8
_buffer$2 = -12						; size = 8
__$ArrayPad$ = -4					; size = 4
_ctx$ = 8						; size = 4
_md$ = 12						; size = 4
_gost_imit_final PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 566
	mov	eax, 12					; 0000000cH
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+12], eax
	mov	eax, DWORD PTR _ctx$[esp+8]
	push	ebx
	mov	ebx, DWORD PTR _md$[esp+12]
	push	esi
; Line 567
	mov	esi, DWORD PTR [eax+12]
; Line 568
	cmp	DWORD PTR [esi+4156], 0
	jne	SHORT $LN5@gost_imit_
; Line 569
	push	569					; 00000239H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	116					; 00000074H
	push	140					; 0000008cH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 570
	xor	eax, eax
	pop	esi
	pop	ebx
; Line 586
	mov	ecx, DWORD PTR __$ArrayPad$[esp+12]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
$LN5@gost_imit_:
; Line 572
	cmp	DWORD PTR [esi+4144], 0
	jne	SHORT $LN6@gost_imit_
	cmp	DWORD PTR [esi+4152], 0
	je	SHORT $LN6@gost_imit_
; Line 575
	push	8
	lea	ecx, DWORD PTR _buffer$2[esp+24]
	xorps	xmm0, xmm0
	push	ecx
	push	eax
	movq	QWORD PTR _buffer$2[esp+32], xmm0
	call	_gost_imit_update
	add	esp, 12					; 0000000cH
$LN6@gost_imit_:
; Line 577
	mov	eax, DWORD PTR [esi+4152]
	test	eax, eax
	je	SHORT $LN9@gost_imit_
; Line 579
	cmp	eax, 8
	jge	SHORT $LN4@gost_imit_
	push	edi
	mov	ecx, 8
	lea	edi, DWORD PTR [esi+4136]
	sub	ecx, eax
	add	edi, eax
	mov	edx, ecx
	xor	eax, eax
	shr	ecx, 2
	rep stosd
	mov	ecx, edx
	and	ecx, 3
	rep stosb
	pop	edi
$LN4@gost_imit_:
; Line 526
	cmp	DWORD PTR [esi+4148], 0
	je	SHORT $LN10@gost_imit_
	cmp	DWORD PTR [esi+4144], 1024		; 00000400H
	jne	SHORT $LN10@gost_imit_
; Line 527
	lea	eax, DWORD PTR _buffer$1[esp+20]
	push	eax
	push	esi
	call	_cryptopro_key_meshing
	add	esp, 8
$LN10@gost_imit_:
; Line 582
	lea	eax, DWORD PTR [esi+4136]
; Line 529
	push	eax
	lea	eax, DWORD PTR [esi+4128]
	push	eax
	push	esi
	call	_mac_block
; Line 530
	mov	eax, DWORD PTR [esi+4144]
	add	esp, 12					; 0000000cH
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [esi+4144], eax
$LN9@gost_imit_:
; Line 584
	push	ebx
	lea	eax, DWORD PTR [esi+4128]
	push	32					; 00000020H
	push	eax
	call	_get_mac
; Line 586
	mov	ecx, DWORD PTR __$ArrayPad$[esp+32]
	add	esp, 12					; 0000000cH
	mov	eax, 1
	pop	esi
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
_gost_imit_final ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_update
_TEXT	SEGMENT
_buffer$1 = -12						; size = 8
_buffer$2 = -12						; size = 8
__$ArrayPad$ = -4					; size = 4
_ctx$ = 8						; size = 4
_data$ = 12						; size = 4
_count$ = 16						; size = 4
_gost_imit_update PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 534
	mov	eax, 12					; 0000000cH
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+12], eax
	mov	eax, DWORD PTR _ctx$[esp+8]
	push	ebx
	mov	ebx, DWORD PTR _data$[esp+12]
	push	esi
; Line 535
	mov	esi, DWORD PTR [eax+12]
	push	edi
; Line 537
	mov	edi, DWORD PTR _count$[esp+20]
; Line 538
	cmp	DWORD PTR [esi+4156], 0
	jne	SHORT $LN7@gost_imit_
; Line 539
	push	539					; 0000021bH
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	116					; 00000074H
	push	115					; 00000073H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 540
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebx
; Line 563
	mov	ecx, DWORD PTR __$ArrayPad$[esp+12]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
$LN7@gost_imit_:
; Line 542
	mov	ecx, DWORD PTR [esi+4152]
	test	ecx, ecx
	je	SHORT $LN20@gost_imit_
; Line 543
	cmp	ecx, 8
	jae	SHORT $LN28@gost_imit_
	npad	7
$LL4@gost_imit_:
	test	edi, edi
	je	SHORT $LN27@gost_imit_
; Line 544
	mov	al, BYTE PTR [ebx]
	dec	edi
	mov	BYTE PTR [ecx+esi+4136], al
	inc	ebx
	inc	ecx
	cmp	ecx, 8
	jb	SHORT $LL4@gost_imit_
$LN27@gost_imit_:
; Line 546
	cmp	ecx, 8
$LN28@gost_imit_:
	jne	$LN9@gost_imit_
; Line 526
	cmp	DWORD PTR [esi+4148], 0
	je	SHORT $LN14@gost_imit_
	cmp	DWORD PTR [esi+4144], 1024		; 00000400H
	jne	SHORT $LN14@gost_imit_
; Line 527
	lea	eax, DWORD PTR _buffer$2[esp+24]
	push	eax
	push	esi
	call	_cryptopro_key_meshing
	add	esp, 8
$LN14@gost_imit_:
; Line 547
	lea	eax, DWORD PTR [esi+4136]
; Line 529
	push	eax
	lea	eax, DWORD PTR [esi+4128]
	push	eax
	push	esi
	call	_mac_block
; Line 530
	mov	eax, DWORD PTR [esi+4144]
	add	esp, 12					; 0000000cH
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [esi+4144], eax
$LN20@gost_imit_:
; Line 553
	cmp	edi, 8
	jbe	SHORT $LN6@gost_imit_
	push	ebp
	lea	ebp, DWORD PTR [edi-9]
	shr	ebp, 3
	lea	eax, DWORD PTR [esi+4128]
	inc	ebp
	npad	1
$LL5@gost_imit_:
; Line 526
	cmp	DWORD PTR [esi+4148], 0
	je	SHORT $LN17@gost_imit_
	cmp	DWORD PTR [esi+4144], 1024		; 00000400H
	jne	SHORT $LN17@gost_imit_
; Line 527
	lea	eax, DWORD PTR _buffer$1[esp+28]
	push	eax
	push	esi
	call	_cryptopro_key_meshing
	add	esp, 8
	lea	eax, DWORD PTR [esi+4128]
$LN17@gost_imit_:
; Line 529
	push	ebx
	push	eax
	push	esi
	call	_mac_block
; Line 530
	mov	eax, DWORD PTR [esi+4144]
	add	esp, 12					; 0000000cH
	and	eax, 1023				; 000003ffH
; Line 555
	add	ebx, 8
; Line 530
	add	eax, 8
; Line 556
	sub	edi, 8
; Line 530
	mov	DWORD PTR [esi+4144], eax
; Line 553
	lea	eax, DWORD PTR [esi+4128]
	sub	ebp, 1
	jne	SHORT $LL5@gost_imit_
	pop	ebp
$LN6@gost_imit_:
; Line 558
	test	edi, edi
	je	SHORT $LN11@gost_imit_
; Line 559
	push	edi
	lea	eax, DWORD PTR [esi+4136]
	push	ebx
	push	eax
	call	_memcpy
	add	esp, 12					; 0000000cH
$LN11@gost_imit_:
; Line 561
	mov	DWORD PTR [esi+4152], edi
$LN29@gost_imit_:
; Line 563
	mov	ecx, DWORD PTR __$ArrayPad$[esp+24]
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 12					; 0000000cH
	ret	0
$LN9@gost_imit_:
; Line 549
	mov	DWORD PTR [esi+4152], ecx
; Line 550
	jmp	SHORT $LN29@gost_imit_
_gost_imit_update ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_imit_init_cpa
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_gost_imit_init_cpa PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 506
	mov	eax, DWORD PTR _ctx$[esp-4]
	xorps	xmm0, xmm0
; Line 512
	push	OFFSET _Gost28147_CryptoProParamSetA
	mov	eax, DWORD PTR [eax+12]
	push	eax
	movups	XMMWORD PTR [eax+4128], xmm0
	mov	DWORD PTR [eax+4144], 0
	mov	DWORD PTR [eax+4152], 0
	mov	DWORD PTR [eax+4148], 1
	call	_gost_init
	add	esp, 8
; Line 513
	mov	eax, 1
; Line 514
	ret	0
_gost_imit_init_cpa ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_ctl
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_type$ = 12						; size = 4
_arg$ = 16						; size = 4
_ptr$ = 20						; size = 4
_gost_cipher_ctl PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 400
	mov	eax, DWORD PTR _type$[esp-4]
	sub	eax, 6
	je	SHORT $LN4@gost_ciphe
	sub	eax, 1
	je	SHORT $LN6@gost_ciphe
; Line 419
	push	420					; 000001a4H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	129					; 00000081H
	push	111					; 0000006fH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 421
	or	eax, -1
; Line 424
	ret	0
$LN6@gost_ciphe:
; Line 411
	mov	eax, DWORD PTR _ptr$[esp-4]
	test	eax, eax
	je	SHORT $LN7@gost_ciphe
; Line 412
	mov	DWORD PTR [eax], 810			; 0000032aH
$LN5@gost_ciphe:
; Line 423
	mov	eax, 1
; Line 424
	ret	0
$LN7@gost_ciphe:
; Line 415
	xor	eax, eax
; Line 424
	ret	0
$LN4@gost_ciphe:
; Line 403
	mov	eax, DWORD PTR _ctx$[esp-4]
	push	DWORD PTR [eax+88]
	push	DWORD PTR _ptr$[esp]
	call	_RAND_bytes
	add	esp, 8
	test	eax, eax
	jg	SHORT $LN5@gost_ciphe
; Line 404
	push	405					; 00000195H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	123					; 0000007bH
	push	111					; 0000006fH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 406
	or	eax, -1
; Line 424
	ret	0
_gost_cipher_ctl ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost89_get_asn1_parameters
_TEXT	SEGMENT
_p$ = 8							; size = 4
_ctx$ = 8						; size = 4
_params$ = 12						; size = 4
_gost89_get_asn1_parameters PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 472
	push	ebx
	push	esi
; Line 478
	mov	esi, DWORD PTR _params$[esp+4]
	push	edi
	mov	edi, DWORD PTR _ctx$[esp+8]
	push	esi
	mov	ebx, DWORD PTR [edi+96]
	call	_ASN1_TYPE_get
	add	esp, 4
	cmp	eax, 16					; 00000010H
	je	SHORT $LN2@gost89_get
; Line 479
	pop	edi
	pop	esi
	or	eax, -1
	pop	ebx
; Line 502
	ret	0
$LN2@gost89_get:
; Line 482
	mov	ecx, DWORD PTR [esi+4]
	push	ebp
	mov	eax, DWORD PTR [ecx+8]
	mov	DWORD PTR _p$[esp+12], eax
; Line 484
	lea	eax, DWORD PTR _p$[esp+12]
	push	DWORD PTR [ecx]
	push	eax
	push	0
	call	_d2i_GOST_CIPHER_PARAMS
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 487
	mov	ecx, DWORD PTR [esi]
	mov	ebp, DWORD PTR [ecx]
; Line 488
	mov	ecx, DWORD PTR [edi]
	cmp	ebp, DWORD PTR [ecx+12]
	je	SHORT $LN3@gost89_get
; Line 489
	push	esi
	call	_GOST_CIPHER_PARAMS_free
; Line 490
	push	490					; 000001eaH
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	110					; 0000006eH
	push	108					; 0000006cH
	call	_ERR_GOST_error
	add	esp, 20					; 00000014H
; Line 491
	or	eax, -1
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
; Line 502
	ret	0
$LN3@gost89_get:
; Line 493
	push	DWORD PTR [esi+4]
	call	_OBJ_obj2nid
	push	eax
	push	ebx
	call	_gost_cipher_set_param
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN4@gost89_get
; Line 494
	push	esi
	call	_GOST_CIPHER_PARAMS_free
	add	esp, 4
; Line 495
	or	eax, -1
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
; Line 502
	ret	0
$LN4@gost89_get:
; Line 497
	mov	eax, DWORD PTR [esi]
	push	ebp
	push	DWORD PTR [eax+8]
	lea	eax, DWORD PTR [edi+16]
	push	eax
	call	_memcpy
; Line 499
	push	esi
	call	_GOST_CIPHER_PARAMS_free
	add	esp, 16					; 00000010H
; Line 501
	mov	eax, 1
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
; Line 502
	ret	0
_gost89_get_asn1_parameters ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost89_set_asn1_parameters
_TEXT	SEGMENT
_p$ = -4						; size = 4
_ctx$ = 8						; size = 4
_params$ = 12						; size = 4
_gost89_set_asn1_parameters PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 428
	mov	eax, 4
	call	__chkstk
	push	ebx
	push	esi
	push	edi
; Line 432
	mov	edi, DWORD PTR _ctx$[esp+12]
	mov	DWORD PTR _p$[esp+16], 0
	mov	ebx, DWORD PTR [edi+96]
; Line 433
	call	_GOST_CIPHER_PARAMS_new
	mov	esi, eax
; Line 435
	test	esi, esi
	jne	SHORT $LN2@gost89_set
; Line 436
	push	436					; 000001b4H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	118					; 00000076H
	push	109					; 0000006dH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 462
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebx
; Line 468
	pop	ecx
	ret	0
$LN2@gost89_set:
; Line 439
	mov	eax, DWORD PTR [edi]
	push	DWORD PTR [eax+12]
	lea	eax, DWORD PTR [edi+32]
	push	eax
	push	DWORD PTR [esi]
	call	_ASN1_OCTET_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN3@gost89_set
; Line 440
	push	esi
	call	_GOST_CIPHER_PARAMS_free
; Line 441
	push	441					; 000001b9H
; Line 442
	jmp	$LN9@gost89_set
$LN3@gost89_set:
; Line 444
	push	DWORD PTR [esi+4]
	call	_ASN1_OBJECT_free
; Line 445
	push	DWORD PTR [ebx]
	call	_OBJ_nid2obj
; Line 447
	push	0
	push	esi
	mov	DWORD PTR [esi+4], eax
	call	_i2d_GOST_CIPHER_PARAMS
; Line 448
	push	448					; 000001c0H
	mov	ebx, eax
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	ebx
	call	_CRYPTO_malloc
	mov	edi, eax
	add	esp, 28					; 0000001cH
	mov	DWORD PTR _p$[esp+16], edi
; Line 449
	test	edi, edi
	jne	SHORT $LN4@gost89_set
; Line 450
	push	esi
	call	_GOST_CIPHER_PARAMS_free
; Line 451
	push	451					; 000001c3H
; Line 452
	jmp	SHORT $LN9@gost89_set
$LN4@gost89_set:
; Line 454
	lea	eax, DWORD PTR _p$[esp+16]
	push	eax
	push	esi
	call	_i2d_GOST_CIPHER_PARAMS
; Line 455
	push	esi
	call	_GOST_CIPHER_PARAMS_free
	add	esp, 12					; 0000000cH
; Line 457
	call	_ASN1_OCTET_STRING_new
	mov	esi, eax
; Line 459
	test	esi, esi
	je	SHORT $LN6@gost89_set
	push	ebx
	push	edi
	push	esi
	call	_ASN1_OCTET_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN6@gost89_set
; Line 464
	push	edi
	call	_CRYPTO_free
; Line 466
	push	esi
	push	16					; 00000010H
	push	DWORD PTR _params$[esp+24]
	call	_ASN1_TYPE_set
	add	esp, 16					; 00000010H
; Line 467
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebx
; Line 468
	pop	ecx
	ret	0
$LN6@gost89_set:
; Line 460
	push	edi
	call	_CRYPTO_free
; Line 461
	push	461					; 000001cdH
$LN9@gost89_set:
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	118					; 00000076H
	push	109					; 0000006dH
	call	_ERR_GOST_error
	add	esp, 20					; 00000014H
; Line 462
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebx
; Line 468
	pop	ecx
	ret	0
_gost89_set_asn1_parameters ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_cleanup
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_gost_cipher_cleanup PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 391
	push	esi
; Line 392
	mov	esi, DWORD PTR _ctx$[esp]
	mov	eax, DWORD PTR [esi+96]
	add	eax, 12					; 0000000cH
	push	eax
	call	_gost_destroy
	add	esp, 4
; Line 393
	mov	DWORD PTR [esi+84], 0
; Line 394
	mov	eax, 1
	pop	esi
; Line 395
	ret	0
_gost_cipher_cleanup ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_do_cnt
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_out$ = 12						; size = 4
tv1378 = 16						; size = 4
_in$ = 16						; size = 4
_inl$ = 20						; size = 4
_gost_cipher_do_cnt PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 341
	push	ebx
; Line 347
	mov	ebx, DWORD PTR _ctx$[esp]
	push	ebp
	push	esi
	mov	esi, DWORD PTR _out$[esp+8]
	xor	ebp, ebp
	mov	ecx, DWORD PTR [ebx+80]
	push	edi
	mov	edi, DWORD PTR _in$[esp+12]
	test	ecx, ecx
	je	SHORT $LN16@gost_ciphe
; Line 348
	cmp	ecx, 8
	jae	SHORT $LN45@gost_ciphe
	mov	edx, DWORD PTR _inl$[esp+12]
$LL4@gost_ciphe:
	cmp	ebp, edx
	jae	SHORT $LN44@gost_ciphe
; Line 350
	mov	al, BYTE PTR [ecx+ebx+48]
	inc	ebp
	xor	al, BYTE PTR [edi]
	inc	ecx
	mov	BYTE PTR [esi], al
	inc	edi
	inc	esi
	cmp	ecx, 8
	jb	SHORT $LL4@gost_ciphe
$LN44@gost_ciphe:
; Line 352
	cmp	ecx, 8
$LN45@gost_ciphe:
	jne	$LN15@gost_ciphe
; Line 353
	mov	DWORD PTR [ebx+80], 0
$LN16@gost_ciphe:
; Line 360
	mov	eax, DWORD PTR _inl$[esp+12]
	lea	ecx, DWORD PTR [ebp+8]
	mov	DWORD PTR tv1378[esp+12], ecx
	cmp	ecx, eax
	jae	$LN6@gost_ciphe
	lea	edx, DWORD PTR [ebx+32]
	lea	ecx, DWORD PTR [ebx+48]
$LL7@gost_ciphe:
; Line 365
	push	ecx
	push	edx
	push	DWORD PTR [ebx+96]
	call	_gost_cnt_next
; Line 373
	movzx	eax, BYTE PTR [edi]
	lea	edx, DWORD PTR [ebx+32]
	xor	al, BYTE PTR [ebx+48]
	add	esp, 12					; 0000000cH
	mov	BYTE PTR [esi], al
	add	ebp, 8
	movzx	eax, BYTE PTR [edi+1]
	xor	al, BYTE PTR [ebx+49]
	mov	BYTE PTR [esi+1], al
	movzx	eax, BYTE PTR [edi+2]
	xor	al, BYTE PTR [ebx+50]
	mov	BYTE PTR [esi+2], al
	movzx	eax, BYTE PTR [edi+3]
	xor	al, BYTE PTR [ebx+51]
	mov	ecx, DWORD PTR tv1378[esp+12]
	mov	BYTE PTR [esi+3], al
	add	ecx, 8
	movzx	eax, BYTE PTR [edi+4]
	xor	al, BYTE PTR [ebx+52]
	mov	BYTE PTR [esi+4], al
	movzx	eax, BYTE PTR [edi+5]
	xor	al, BYTE PTR [ebx+53]
	mov	BYTE PTR [esi+5], al
	movzx	eax, BYTE PTR [edi+6]
	xor	al, BYTE PTR [ebx+54]
	mov	BYTE PTR [esi+6], al
	movzx	eax, BYTE PTR [edi+7]
	add	edi, 8
	xor	al, BYTE PTR [ebx+55]
	mov	BYTE PTR [esi+7], al
	add	esi, 8
	mov	eax, DWORD PTR _inl$[esp+12]
	cmp	ecx, eax
	mov	DWORD PTR tv1378[esp+12], ecx
	lea	ecx, DWORD PTR [ebx+48]
	jb	SHORT $LL7@gost_ciphe
$LN6@gost_ciphe:
; Line 377
	cmp	ebp, eax
	jae	SHORT $LN17@gost_ciphe
; Line 378
	lea	eax, DWORD PTR [ebx+48]
	push	eax
	lea	eax, DWORD PTR [ebx+32]
	push	eax
	push	DWORD PTR [ebx+96]
	call	_gost_cnt_next
	mov	ecx, DWORD PTR _inl$[esp+24]
	add	esp, 12					; 0000000cH
; Line 379
	xor	edx, edx
	sub	edi, esi
	sub	ecx, ebp
	npad	2
$LL13@gost_ciphe:
; Line 380
	mov	al, BYTE PTR [edi+esi]
	lea	esi, DWORD PTR [esi+1]
	xor	al, BYTE PTR [ebx+edx+48]
	inc	edx
	mov	BYTE PTR [esi-1], al
	sub	ecx, 1
	jne	SHORT $LL13@gost_ciphe
; Line 382
	pop	edi
	pop	esi
	pop	ebp
	mov	DWORD PTR [ebx+80], edx
; Line 386
	lea	eax, DWORD PTR [ecx+1]
	pop	ebx
; Line 387
	ret	0
$LN15@gost_ciphe:
	pop	edi
	pop	esi
	pop	ebp
; Line 355
	mov	DWORD PTR [ebx+80], ecx
; Line 386
	mov	eax, 1
	pop	ebx
; Line 387
	ret	0
$LN17@gost_ciphe:
	pop	edi
	pop	esi
	pop	ebp
; Line 384
	mov	DWORD PTR [ebx+80], 0
; Line 386
	mov	eax, 1
	pop	ebx
; Line 387
	ret	0
_gost_cipher_do_cnt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_do_cfb
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
tv1456 = 12						; size = 4
tv1441 = 12						; size = 4
_out$ = 12						; size = 4
_c$1$ = 16						; size = 4
_c$1$ = 16						; size = 4
_j$2$ = 16						; size = 4
_in$ = 16						; size = 4
_inl$ = 20						; size = 4
_gost_cipher_do_cfb PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 277
	push	ebx
; Line 279
	mov	ebx, DWORD PTR _out$[esp]
	push	ebp
	push	esi
; Line 283
	mov	esi, DWORD PTR _ctx$[esp+8]
	xor	ebp, ebp
	push	edi
	mov	edi, DWORD PTR _in$[esp+12]
	mov	ecx, DWORD PTR [esi+80]
	test	ecx, ecx
	je	SHORT $LN18@gost_ciphe
; Line 284
	cmp	ecx, 8
	jae	SHORT $LN58@gost_ciphe
	mov	edx, DWORD PTR _inl$[esp+12]
$LL4@gost_ciphe:
	cmp	ebp, edx
	jae	SHORT $LN56@gost_ciphe
; Line 286
	cmp	DWORD PTR [esi+8], 0
	jne	SHORT $LN15@gost_ciphe
; Line 287
	mov	al, BYTE PTR [edi]
	mov	BYTE PTR [ecx+esi+56], al
$LN15@gost_ciphe:
; Line 288
	mov	al, BYTE PTR [ecx+esi+48]
	xor	al, BYTE PTR [edi]
	mov	BYTE PTR [ebx], al
; Line 289
	cmp	DWORD PTR [esi+8], 0
	je	SHORT $LN2@gost_ciphe
; Line 290
	mov	BYTE PTR [ecx+esi+56], al
$LN2@gost_ciphe:
; Line 285
	inc	ecx
	inc	ebp
	inc	edi
	inc	ebx
	cmp	ecx, 8
	jb	SHORT $LL4@gost_ciphe
$LN56@gost_ciphe:
; Line 292
	cmp	ecx, 8
$LN58@gost_ciphe:
	jne	$LN17@gost_ciphe
; Line 293
	mov	eax, DWORD PTR [esi+56]
	mov	DWORD PTR [esi+32], eax
	mov	eax, DWORD PTR [esi+60]
	mov	DWORD PTR [esi+36], eax
; Line 294
	mov	DWORD PTR [esi+80], 0
$LN18@gost_ciphe:
; Line 301
	mov	eax, DWORD PTR _inl$[esp+12]
	lea	ecx, DWORD PTR [ebp+8]
	mov	DWORD PTR tv1441[esp+12], ecx
	cmp	ecx, eax
	jae	$LN6@gost_ciphe
	lea	ecx, DWORD PTR [esi+32]
	npad	1
$LL7@gost_ciphe:
; Line 231
	mov	eax, DWORD PTR [esi+96]
	mov	DWORD PTR _c$1$[esp+12], eax
; Line 233
	cmp	DWORD PTR [eax+8], 0
	je	SHORT $LN27@gost_ciphe
	cmp	DWORD PTR [eax+4], 1024			; 00000400H
	jne	SHORT $LN27@gost_ciphe
; Line 234
	push	ecx
	add	eax, 12					; 0000000cH
	push	eax
	call	_cryptopro_key_meshing
	mov	eax, DWORD PTR _c$1$[esp+20]
	lea	ecx, DWORD PTR [esi+32]
	add	esp, 8
$LN27@gost_ciphe:
; Line 236
	lea	edx, DWORD PTR [esi+48]
	add	eax, 12					; 0000000cH
	push	edx
	push	ecx
	push	eax
	call	_gostcrypt
; Line 237
	mov	ecx, DWORD PTR _c$1$[esp+24]
	add	esp, 12					; 0000000cH
	mov	eax, DWORD PTR [ecx+4]
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [ecx+4], eax
; Line 313
	lea	ecx, DWORD PTR [esi+32]
	cmp	DWORD PTR [esi+8], 0
	jne	SHORT $LN19@gost_ciphe
	mov	eax, DWORD PTR [edi]
	mov	DWORD PTR [ecx], eax
	mov	eax, DWORD PTR [edi+4]
	mov	DWORD PTR [ecx+4], eax
$LN19@gost_ciphe:
; Line 315
	movzx	eax, BYTE PTR [esi+48]
	xor	al, BYTE PTR [edi]
	mov	BYTE PTR [ebx], al
	movzx	eax, BYTE PTR [edi+1]
	xor	al, BYTE PTR [esi+49]
	mov	BYTE PTR [ebx+1], al
	movzx	eax, BYTE PTR [edi+2]
	xor	al, BYTE PTR [esi+50]
	mov	BYTE PTR [ebx+2], al
	movzx	eax, BYTE PTR [edi+3]
	xor	al, BYTE PTR [esi+51]
	mov	BYTE PTR [ebx+3], al
	movzx	eax, BYTE PTR [edi+4]
	xor	al, BYTE PTR [esi+52]
	mov	BYTE PTR [ebx+4], al
	movzx	eax, BYTE PTR [edi+5]
	xor	al, BYTE PTR [esi+53]
	mov	BYTE PTR [ebx+5], al
	movzx	eax, BYTE PTR [edi+6]
	xor	al, BYTE PTR [esi+54]
	mov	BYTE PTR [ebx+6], al
	movzx	eax, BYTE PTR [edi+7]
	xor	al, BYTE PTR [esi+55]
	mov	BYTE PTR [ebx+7], al
; Line 319
	cmp	DWORD PTR [esi+8], 0
	je	SHORT $LN5@gost_ciphe
; Line 320
	mov	eax, DWORD PTR [ebx]
	mov	DWORD PTR [ecx], eax
	mov	eax, DWORD PTR [ebx+4]
	mov	DWORD PTR [ecx+4], eax
$LN5@gost_ciphe:
; Line 301
	mov	edx, DWORD PTR tv1441[esp+12]
	add	ebp, 8
	mov	eax, DWORD PTR _inl$[esp+12]
	add	edx, 8
	add	edi, 8
	mov	DWORD PTR tv1441[esp+12], edx
	add	ebx, 8
	cmp	edx, eax
	jb	$LL7@gost_ciphe
$LN6@gost_ciphe:
; Line 323
	cmp	ebp, eax
	jae	$LN21@gost_ciphe
; Line 231
	mov	eax, DWORD PTR [esi+96]
; Line 324
	lea	ecx, DWORD PTR [esi+32]
; Line 231
	mov	DWORD PTR _c$1$[esp+12], eax
; Line 233
	cmp	DWORD PTR [eax+8], 0
	je	SHORT $LN30@gost_ciphe
	cmp	DWORD PTR [eax+4], 1024			; 00000400H
	jne	SHORT $LN30@gost_ciphe
; Line 234
	push	ecx
	add	eax, 12					; 0000000cH
	push	eax
	call	_cryptopro_key_meshing
	mov	eax, DWORD PTR _c$1$[esp+20]
	add	esp, 8
$LN30@gost_ciphe:
; Line 324
	lea	ecx, DWORD PTR [esi+48]
; Line 236
	add	eax, 12					; 0000000cH
	push	ecx
; Line 324
	mov	DWORD PTR tv1456[esp+16], ecx
; Line 236
	lea	ecx, DWORD PTR [esi+32]
	push	ecx
	push	eax
	call	_gostcrypt
; Line 237
	mov	ecx, DWORD PTR _c$1$[esp+24]
	add	esp, 12					; 0000000cH
	mov	eax, DWORD PTR [ecx+4]
	and	eax, 1023				; 000003ffH
	add	eax, 8
	mov	DWORD PTR [ecx+4], eax
; Line 325
	cmp	DWORD PTR [esi+8], 0
	jne	SHORT $LN23@gost_ciphe
; Line 326
	mov	eax, DWORD PTR _inl$[esp+12]
	sub	eax, ebp
	push	eax
	lea	eax, DWORD PTR [esi+56]
	push	edi
	push	eax
	call	_memcpy
	add	esp, 12					; 0000000cH
$LN23@gost_ciphe:
; Line 327
	mov	edx, DWORD PTR _inl$[esp+12]
	xor	esi, esi
	sub	edi, ebx
	mov	ecx, ebx
	sub	edx, ebp
	mov	ebp, DWORD PTR tv1456[esp+12]
$LL13@gost_ciphe:
; Line 328
	mov	al, BYTE PTR [esi+ebp]
	lea	ecx, DWORD PTR [ecx+1]
	xor	al, BYTE PTR [edi+ecx-1]
	inc	esi
	mov	BYTE PTR [ecx-1], al
	sub	edx, 1
	jne	SHORT $LL13@gost_ciphe
; Line 330
	mov	DWORD PTR _j$2$[esp+12], esi
	mov	esi, DWORD PTR _ctx$[esp+12]
	mov	eax, DWORD PTR _j$2$[esp+12]
	mov	DWORD PTR [esi+80], eax
; Line 331
	cmp	DWORD PTR [esi+8], edx
	je	SHORT $LN22@gost_ciphe
; Line 332
	push	eax
	push	ebx
	add	esi, 56					; 00000038H
	push	esi
	call	_memcpy
	add	esp, 12					; 0000000cH
; Line 336
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 337
	ret	0
$LN17@gost_ciphe:
	pop	edi
; Line 296
	mov	DWORD PTR [esi+80], ecx
; Line 336
	mov	eax, 1
	pop	esi
	pop	ebp
	pop	ebx
; Line 337
	ret	0
$LN21@gost_ciphe:
; Line 334
	mov	DWORD PTR [esi+80], 0
$LN22@gost_ciphe:
	pop	edi
	pop	esi
	pop	ebp
; Line 336
	mov	eax, 1
	pop	ebx
; Line 337
	ret	0
_gost_cipher_do_cfb ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_init_cpa
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_key$ = 12						; size = 4
_iv$ = 16						; size = 4
_enc$ = 20						; size = 4
_gost_cipher_init_cpa PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 204
	push	ebx
	push	esi
	push	edi
; Line 205
	mov	edi, DWORD PTR _ctx$[esp+8]
; Line 206
	push	OFFSET _Gost28147_CryptoProParamSetA
	mov	esi, DWORD PTR [edi+96]
	lea	ebx, DWORD PTR [esi+12]
	push	ebx
	call	_gost_init
; Line 209
	mov	eax, DWORD PTR _key$[esp+16]
	add	esp, 8
	mov	DWORD PTR [esi+8], 1
	mov	DWORD PTR [esi+4], 0
	test	eax, eax
	je	SHORT $LN2@gost_ciphe
; Line 210
	push	eax
	push	ebx
	call	_gost_key
	add	esp, 8
$LN2@gost_ciphe:
; Line 211
	mov	esi, DWORD PTR _iv$[esp+8]
	test	esi, esi
	je	SHORT $LN3@gost_ciphe
; Line 212
	push	edi
	call	_EVP_CIPHER_CTX_iv_length
	push	eax
	lea	eax, DWORD PTR [edi+16]
	push	esi
	push	eax
	call	_memcpy
	add	esp, 16					; 00000010H
$LN3@gost_ciphe:
; Line 213
	push	edi
	call	_EVP_CIPHER_CTX_iv_length
	push	eax
	lea	eax, DWORD PTR [edi+16]
	push	eax
	lea	eax, DWORD PTR [edi+32]
	push	eax
	call	_memcpy
	add	esp, 16					; 00000010H
; Line 214
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebx
; Line 215
	ret	0
_gost_cipher_init_cpa ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_cipher_init
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_key$ = 12						; size = 4
_iv$ = 16						; size = 4
_enc$ = 20						; size = 4
_gost_cipher_init PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 221
	push	3
	push	0
	push	DWORD PTR _enc$[esp+4]
	push	DWORD PTR _iv$[esp+8]
	push	DWORD PTR _key$[esp+12]
	push	DWORD PTR _ctx$[esp+16]
	call	_gost_cipher_init_param
	add	esp, 24					; 00000018H
; Line 223
	ret	0
_gost_cipher_init ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _get_encryption_params
_TEXT	SEGMENT
tv70 = 8						; size = 4
_obj$ = 8						; size = 4
_get_encryption_params PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_crypt.c
; Line 143
	mov	eax, DWORD PTR _obj$[esp-4]
	test	eax, eax
	jne	SHORT $LN5@get_encryp
; Line 144
	push	eax
	call	_get_gost_engine_param
	mov	edx, eax
	add	esp, 4
; Line 145
	test	edx, edx
	je	SHORT $LN8@get_encryp
	mov	ecx, edx
	push	esi
	lea	esi, DWORD PTR [ecx+1]
	npad	3
$LL16@get_encryp:
	mov	al, BYTE PTR [ecx]
	inc	ecx
	test	al, al
	jne	SHORT $LL16@get_encryp
	sub	ecx, esi
	pop	esi
	je	SHORT $LN8@get_encryp
; Line 148
	push	edx
	call	_OBJ_txt2nid
	mov	ecx, eax
	add	esp, 4
; Line 149
	test	ecx, ecx
	jne	SHORT $LN6@get_encryp
; Line 150
	push	151					; 00000097H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	107					; 0000006bH
; Line 160
	push	103					; 00000067H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 161
	xor	eax, eax
; Line 164
	ret	0
$LN8@get_encryp:
; Line 146
	mov	eax, OFFSET _gost_cipher_list+12
; Line 164
	ret	0
$LN5@get_encryp:
; Line 155
	push	eax
	call	_OBJ_obj2nid
	add	esp, 4
	mov	ecx, eax
$LN6@get_encryp:
; Line 157
	cmp	DWORD PTR _gost_cipher_list+4, 0
	mov	eax, OFFSET _gost_cipher_list
	je	SHORT $LN17@get_encryp
$LL4@get_encryp:
	cmp	DWORD PTR [eax], ecx
	je	SHORT $LN17@get_encryp
; Line 158
	add	eax, 12					; 0000000cH
	cmp	DWORD PTR [eax+4], 0
	jne	SHORT $LL4@get_encryp
$LN17@get_encryp:
; Line 159
	cmp	DWORD PTR [eax+4], 0
	jne	SHORT $LN1@get_encryp
; Line 160
	push	160					; 000000a0H
	push	OFFSET ??_C@_0BO@PLCMDLO@?4?2engines?2ccgost?2gost_crypt?4c?$AA@
	push	106					; 0000006aH
	push	103					; 00000067H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 161
	xor	eax, eax
$LN1@get_encryp:
; Line 164
	ret	0
_get_encryption_params ENDP
_TEXT	ENDS
END
