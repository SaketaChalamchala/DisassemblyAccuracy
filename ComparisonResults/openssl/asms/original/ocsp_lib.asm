; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_OCSP_CERTID_dup
PUBLIC	_OCSP_cert_to_id
PUBLIC	_OCSP_cert_id_new
PUBLIC	_OCSP_parse_url
PUBLIC	_OCSP_id_issuer_cmp
PUBLIC	_OCSP_id_cmp
PUBLIC	??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@ ; `string'
PUBLIC	??_C@_04IAFLKNP@http?$AA@			; `string'
PUBLIC	??_C@_02PFIAKEDG@80?$AA@			; `string'
PUBLIC	??_C@_05BCHGOAMK@https?$AA@			; `string'
PUBLIC	??_C@_03HGPLGHGJ@443?$AA@			; `string'
PUBLIC	??_C@_01KMDKNFGN@?1?$AA@			; `string'
EXTRN	__imp__strchr:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_BUF_strdup:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_TYPE_new:PROC
EXTRN	_ASN1_OBJECT_free:PROC
EXTRN	_ASN1_INTEGER_free:PROC
EXTRN	_ASN1_INTEGER_dup:PROC
EXTRN	_ASN1_INTEGER_cmp:PROC
EXTRN	_ASN1_OCTET_STRING_cmp:PROC
EXTRN	_ASN1_OCTET_STRING_set:PROC
EXTRN	_ASN1_item_dup:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_OBJ_cmp:PROC
EXTRN	_EVP_MD_type:PROC
EXTRN	_EVP_Digest:PROC
EXTRN	_EVP_sha1:PROC
EXTRN	_X509_NAME_digest:PROC
EXTRN	_X509_get_serialNumber:PROC
EXTRN	_X509_get_issuer_name:PROC
EXTRN	_X509_get_subject_name:PROC
EXTRN	_X509_get0_pubkey_bitstr:PROC
EXTRN	_OCSP_CERTID_new:PROC
EXTRN	_OCSP_CERTID_free:PROC
EXTRN	_OCSP_CERTID_it:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_01KMDKNFGN@?1?$AA@
CONST	SEGMENT
??_C@_01KMDKNFGN@?1?$AA@ DB '/', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_03HGPLGHGJ@443?$AA@
CONST	SEGMENT
??_C@_03HGPLGHGJ@443?$AA@ DB '443', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_05BCHGOAMK@https?$AA@
CONST	SEGMENT
??_C@_05BCHGOAMK@https?$AA@ DB 'https', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_02PFIAKEDG@80?$AA@
CONST	SEGMENT
??_C@_02PFIAKEDG@80?$AA@ DB '80', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_04IAFLKNP@http?$AA@
CONST	SEGMENT
??_C@_04IAFLKNP@http?$AA@ DB 'http', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@
CONST	SEGMENT
??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@ DB '.\crypto\ocsp\oc'
	DB	'sp_lib.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_id_cmp
_TEXT	SEGMENT
_a$ = 8							; size = 4
_b$ = 12						; size = 4
_OCSP_id_cmp PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 165
	push	esi
; Line 155
	mov	esi, DWORD PTR _b$[esp]
	push	edi
	mov	edi, DWORD PTR _a$[esp+4]
	mov	eax, DWORD PTR [esi]
	push	DWORD PTR [eax]
	mov	eax, DWORD PTR [edi]
	push	DWORD PTR [eax]
	call	_OBJ_cmp
	add	esp, 8
; Line 156
	test	eax, eax
	jne	SHORT $LN1@OCSP_id_cm
; Line 158
	push	DWORD PTR [esi+4]
	push	DWORD PTR [edi+4]
	call	_ASN1_OCTET_STRING_cmp
	add	esp, 8
; Line 159
	test	eax, eax
	jne	SHORT $LN1@OCSP_id_cm
; Line 161
	push	DWORD PTR [esi+8]
	push	DWORD PTR [edi+8]
	call	_ASN1_OCTET_STRING_cmp
	add	esp, 8
; Line 168
	test	eax, eax
	jne	SHORT $LN1@OCSP_id_cm
; Line 170
	push	DWORD PTR [esi+12]
	push	DWORD PTR [edi+12]
	call	_ASN1_INTEGER_cmp
	add	esp, 8
$LN1@OCSP_id_cm:
; Line 171
	pop	edi
	pop	esi
	ret	0
_OCSP_id_cmp ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_id_issuer_cmp
_TEXT	SEGMENT
_a$ = 8							; size = 4
_b$ = 12						; size = 4
_OCSP_id_issuer_cmp PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 153
	push	esi
; Line 155
	mov	esi, DWORD PTR _b$[esp]
	push	edi
	mov	edi, DWORD PTR _a$[esp+4]
	mov	eax, DWORD PTR [esi]
	push	DWORD PTR [eax]
	mov	eax, DWORD PTR [edi]
	push	DWORD PTR [eax]
	call	_OBJ_cmp
	add	esp, 8
; Line 156
	test	eax, eax
	jne	SHORT $LN1@OCSP_id_is
; Line 158
	push	DWORD PTR [esi+4]
	push	DWORD PTR [edi+4]
	call	_ASN1_OCTET_STRING_cmp
	add	esp, 8
; Line 159
	test	eax, eax
	jne	SHORT $LN1@OCSP_id_is
; Line 161
	push	DWORD PTR [esi+8]
	push	DWORD PTR [edi+8]
	call	_ASN1_OCTET_STRING_cmp
	add	esp, 8
$LN1@OCSP_id_is:
; Line 162
	pop	edi
	pop	esi
	ret	0
_OCSP_id_issuer_cmp ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_parse_url
_TEXT	SEGMENT
_url$ = 8						; size = 4
_phost$ = 12						; size = 4
_pport$ = 16						; size = 4
_ppath$ = 20						; size = 4
_pssl$ = 24						; size = 4
_OCSP_parse_url PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 185
	mov	eax, DWORD PTR _phost$[esp-4]
	push	ebx
; Line 187
	mov	ebx, DWORD PTR _ppath$[esp]
	push	ebp
	mov	DWORD PTR [eax], 0
	mov	eax, DWORD PTR _pport$[esp+4]
	push	esi
	push	edi
; Line 190
	push	DWORD PTR _url$[esp+12]
	mov	DWORD PTR [eax], 0
	mov	DWORD PTR [ebx], 0
	call	_BUF_strdup
	mov	ebp, eax
	add	esp, 4
; Line 191
	test	ebp, ebp
	je	$mem_err$41
; Line 195
	mov	edi, DWORD PTR __imp__strchr
	push	58					; 0000003aH
	push	ebp
	call	edi
	mov	esi, eax
	add	esp, 8
; Line 197
	test	esi, esi
	je	$parse_err$42
; Line 200
	mov	BYTE PTR [esi], 0
; Line 202
	mov	edx, OFFSET ??_C@_04IAFLKNP@http?$AA@
	mov	ecx, ebp
	npad	6
$LL23@OCSP_parse:
	mov	al, BYTE PTR [ecx]
	cmp	al, BYTE PTR [edx]
	jne	SHORT $LN24@OCSP_parse
	test	al, al
	je	SHORT $LN25@OCSP_parse
	mov	al, BYTE PTR [ecx+1]
	cmp	al, BYTE PTR [edx+1]
	jne	SHORT $LN24@OCSP_parse
	add	ecx, 2
	add	edx, 2
	test	al, al
	jne	SHORT $LL23@OCSP_parse
$LN25@OCSP_parse:
	xor	eax, eax
	jmp	SHORT $LN26@OCSP_parse
$LN24@OCSP_parse:
	sbb	eax, eax
	or	eax, 1
$LN26@OCSP_parse:
	test	eax, eax
	jne	SHORT $LN4@OCSP_parse
; Line 203
	mov	eax, DWORD PTR _pssl$[esp+12]
; Line 204
	mov	ebx, OFFSET ??_C@_02PFIAKEDG@80?$AA@
	mov	DWORD PTR [eax], 0
	jmp	SHORT $LN7@OCSP_parse
$LN4@OCSP_parse:
; Line 205
	mov	ecx, OFFSET ??_C@_05BCHGOAMK@https?$AA@
	mov	eax, ebp
$LL27@OCSP_parse:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN28@OCSP_parse
	test	dl, dl
	je	SHORT $LN29@OCSP_parse
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN28@OCSP_parse
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL27@OCSP_parse
$LN29@OCSP_parse:
	xor	eax, eax
	jmp	SHORT $LN30@OCSP_parse
$LN28@OCSP_parse:
	sbb	eax, eax
	or	eax, 1
$LN30@OCSP_parse:
	test	eax, eax
	jne	$parse_err$42
; Line 206
	mov	eax, DWORD PTR _pssl$[esp+12]
; Line 207
	mov	ebx, OFFSET ??_C@_03HGPLGHGJ@443?$AA@
	mov	DWORD PTR [eax], 1
$LN7@OCSP_parse:
; Line 212
	cmp	BYTE PTR [esi+1], 47			; 0000002fH
	jne	$LN36@OCSP_parse
	cmp	BYTE PTR [esi+2], 47			; 0000002fH
	jne	$LN36@OCSP_parse
; Line 215
	add	esi, 3
; Line 221
	push	47					; 0000002fH
	push	esi
	call	edi
	mov	edi, eax
	add	esp, 8
; Line 223
	test	edi, edi
	jne	SHORT $LN10@OCSP_parse
; Line 224
	push	OFFSET ??_C@_01KMDKNFGN@?1?$AA@
	call	_BUF_strdup
	mov	ecx, DWORD PTR _ppath$[esp+16]
	mov	DWORD PTR [ecx], eax
	jmp	SHORT $LN38@OCSP_parse
$LN10@OCSP_parse:
; Line 226
	push	edi
	call	_BUF_strdup
	mov	ecx, DWORD PTR _ppath$[esp+16]
	mov	DWORD PTR [ecx], eax
; Line 228
	mov	BYTE PTR [edi], 0
$LN38@OCSP_parse:
; Line 231
	add	esp, 4
	cmp	DWORD PTR [ecx], 0
	je	SHORT $LN33@OCSP_parse
; Line 235
	cmp	BYTE PTR [esi], 91			; 0000005bH
	mov	eax, esi
; Line 238
	mov	edi, DWORD PTR __imp__strchr
	jne	SHORT $LN13@OCSP_parse
	inc	esi
	push	93					; 0000005dH
	push	esi
	call	edi
	add	esp, 8
; Line 239
	test	eax, eax
	je	SHORT $LN36@OCSP_parse
; Line 241
	mov	BYTE PTR [eax], 0
; Line 242
	inc	eax
$LN13@OCSP_parse:
; Line 246
	push	58					; 0000003aH
	push	eax
	call	edi
	add	esp, 8
	test	eax, eax
	je	SHORT $LN15@OCSP_parse
; Line 247
	mov	BYTE PTR [eax], 0
; Line 248
	lea	ebx, DWORD PTR [eax+1]
$LN15@OCSP_parse:
; Line 251
	push	ebx
	call	_BUF_strdup
	mov	ecx, DWORD PTR _pport$[esp+16]
	add	esp, 4
	mov	DWORD PTR [ecx], eax
; Line 252
	test	eax, eax
	je	SHORT $LN33@OCSP_parse
; Line 255
	push	esi
	call	_BUF_strdup
	mov	ecx, DWORD PTR _phost$[esp+16]
	add	esp, 4
	mov	DWORD PTR [ecx], eax
; Line 257
	test	eax, eax
	je	SHORT $LN33@OCSP_parse
; Line 260
	push	ebp
	call	_CRYPTO_free
	add	esp, 4
; Line 262
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 282
	ret	0
$LN36@OCSP_parse:
	mov	ebx, DWORD PTR _ppath$[esp+12]
$parse_err$42:
; Line 269
	push	269					; 0000010dH
	push	OFFSET ??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@
	push	121					; 00000079H
	jmp	SHORT $LN39@OCSP_parse
$LN33@OCSP_parse:
	mov	ebx, DWORD PTR _ppath$[esp+12]
$mem_err$41:
; Line 265
	push	265					; 00000109H
	push	OFFSET ??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@
	push	65					; 00000041H
$LN39@OCSP_parse:
	push	114					; 00000072H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$43:
; Line 272
	test	ebp, ebp
	je	SHORT $LN18@OCSP_parse
; Line 273
	push	ebp
	call	_CRYPTO_free
	add	esp, 4
$LN18@OCSP_parse:
; Line 274
	mov	eax, DWORD PTR [ebx]
	test	eax, eax
	je	SHORT $LN19@OCSP_parse
; Line 275
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN19@OCSP_parse:
; Line 276
	mov	eax, DWORD PTR _pport$[esp+12]
	mov	eax, DWORD PTR [eax]
	test	eax, eax
	je	SHORT $LN20@OCSP_parse
; Line 277
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN20@OCSP_parse:
; Line 278
	mov	eax, DWORD PTR _phost$[esp+12]
	mov	eax, DWORD PTR [eax]
	test	eax, eax
	je	SHORT $LN21@OCSP_parse
; Line 279
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN21@OCSP_parse:
; Line 280
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 282
	ret	0
_OCSP_parse_url ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_cert_id_new
_TEXT	SEGMENT
_i$ = -80						; size = 4
_issuerName$GSCopy$1$ = -76				; size = 4
_issuerKey$GSCopy$1$ = -72				; size = 4
_md$ = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_dgst$ = 8						; size = 4
_issuerName$ = 12					; size = 4
_issuerKey$ = 16					; size = 4
_serialNumber$ = 20					; size = 4
_OCSP_cert_id_new PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 103
	mov	eax, 80					; 00000050H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+80], eax
	mov	eax, DWORD PTR _issuerName$[esp+76]
	push	ebx
	mov	ebx, DWORD PTR _serialNumber$[esp+80]
	push	ebp
	mov	ebp, DWORD PTR _dgst$[esp+84]
	push	esi
	mov	DWORD PTR _issuerName$GSCopy$1$[esp+92], eax
	mov	eax, DWORD PTR _issuerKey$[esp+88]
	push	edi
	mov	DWORD PTR _issuerKey$GSCopy$1$[esp+96], eax
; Line 110
	call	_OCSP_CERTID_new
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN13@OCSP_cert_
; Line 113
	mov	edi, DWORD PTR [esi]
; Line 114
	mov	eax, DWORD PTR [edi]
	test	eax, eax
	je	SHORT $LN3@OCSP_cert_
; Line 115
	push	eax
	call	_ASN1_OBJECT_free
	add	esp, 4
$LN3@OCSP_cert_:
; Line 116
	push	ebp
	call	_EVP_MD_type
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN4@OCSP_cert_
; Line 117
	push	117					; 00000075H
	push	OFFSET ??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@
	push	120					; 00000078H
$LN15@OCSP_cert_:
; Line 145
	push	101					; 00000065H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$17:
; Line 148
	push	esi
	call	_OCSP_CERTID_free
	add	esp, 4
$LN13@OCSP_cert_:
; Line 149
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 150
	mov	ecx, DWORD PTR __$ArrayPad$[esp+80]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 80					; 00000050H
	ret	0
$LN4@OCSP_cert_:
; Line 120
	push	eax
	call	_OBJ_nid2obj
	add	esp, 4
	mov	DWORD PTR [edi], eax
	test	eax, eax
	je	SHORT $err$17
; Line 122
	call	_ASN1_TYPE_new
	mov	DWORD PTR [edi+4], eax
	test	eax, eax
	je	SHORT $err$17
; Line 124
	mov	DWORD PTR [eax], 5
; Line 126
	lea	eax, DWORD PTR _i$[esp+96]
	push	eax
	lea	eax, DWORD PTR _md$[esp+100]
	push	eax
	push	ebp
	push	DWORD PTR _issuerName$GSCopy$1$[esp+108]
	call	_X509_NAME_digest
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN7@OCSP_cert_
$digerr$18:
; Line 145
	push	145					; 00000091H
	push	OFFSET ??_C@_0BJ@LLACCFN@?4?2crypto?2ocsp?2ocsp_lib?4c?$AA@
	push	102					; 00000066H
	jmp	SHORT $LN15@OCSP_cert_
$LN7@OCSP_cert_:
; Line 128
	push	DWORD PTR _i$[esp+96]
	lea	eax, DWORD PTR _md$[esp+100]
	push	eax
	push	DWORD PTR [esi+4]
	call	_ASN1_OCTET_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$17
; Line 132
	push	0
	push	ebp
	lea	eax, DWORD PTR _i$[esp+104]
	push	eax
	lea	eax, DWORD PTR _md$[esp+108]
	push	eax
	mov	eax, DWORD PTR _issuerKey$GSCopy$1$[esp+112]
	push	DWORD PTR [eax]
	push	DWORD PTR [eax+8]
	call	_EVP_Digest
	add	esp, 24					; 00000018H
	test	eax, eax
	je	$err$17
; Line 135
	push	DWORD PTR _i$[esp+96]
	lea	eax, DWORD PTR _md$[esp+100]
	push	eax
	push	DWORD PTR [esi+8]
	call	_ASN1_OCTET_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$17
; Line 138
	test	ebx, ebx
	je	SHORT $LN12@OCSP_cert_
; Line 139
	push	DWORD PTR [esi+12]
	call	_ASN1_INTEGER_free
; Line 140
	push	ebx
	call	_ASN1_INTEGER_dup
	add	esp, 8
	mov	DWORD PTR [esi+12], eax
	test	eax, eax
	je	$err$17
$LN12@OCSP_cert_:
; Line 150
	mov	ecx, DWORD PTR __$ArrayPad$[esp+96]
	mov	eax, esi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 80					; 00000050H
	ret	0
_OCSP_cert_id_new ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_cert_to_id
_TEXT	SEGMENT
_dgst$ = 8						; size = 4
_subject$ = 12						; size = 4
_issuer$ = 16						; size = 4
_OCSP_cert_to_id PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 80
	push	ebp
	push	esi
; Line 85
	mov	esi, DWORD PTR _dgst$[esp+4]
	push	edi
	test	esi, esi
	jne	SHORT $LN2@OCSP_cert_
; Line 86
	call	_EVP_sha1
	mov	esi, eax
$LN2@OCSP_cert_:
; Line 88
	mov	edi, DWORD PTR _subject$[esp+8]
	test	edi, edi
	je	SHORT $LN3@OCSP_cert_
; Line 89
	push	edi
	call	_X509_get_issuer_name
; Line 90
	push	edi
	mov	ebp, eax
	call	_X509_get_serialNumber
	add	esp, 8
	mov	edi, eax
; Line 91
	jmp	SHORT $LN4@OCSP_cert_
$LN3@OCSP_cert_:
; Line 92
	push	DWORD PTR _issuer$[esp+8]
	call	_X509_get_subject_name
	add	esp, 4
	mov	ebp, eax
; Line 93
	xor	edi, edi
$LN4@OCSP_cert_:
; Line 95
	push	DWORD PTR _issuer$[esp+8]
	call	_X509_get0_pubkey_bitstr
; Line 96
	push	edi
	push	eax
	push	ebp
	push	esi
	call	_OCSP_cert_id_new
	add	esp, 20					; 00000014H
	pop	edi
	pop	esi
	pop	ebp
; Line 97
	ret	0
_OCSP_cert_to_id ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_CERTID_dup
_TEXT	SEGMENT
_x$ = 8							; size = 4
_OCSP_CERTID_dup PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_lib.c
; Line 284
	push	DWORD PTR _x$[esp-4]
	call	_OCSP_CERTID_it
	push	eax
	call	_ASN1_item_dup
	add	esp, 8
	ret	0
_OCSP_CERTID_dup ENDP
_TEXT	ENDS
END
