; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	??_C@_04OKLIMCN@salt?$AA@			; `string'
PUBLIC	??_C@_04BKLHDIKK@iter?$AA@			; `string'
PUBLIC	??_C@_08CKLJFNPB@PBEPARAM?$AA@			; `string'
EXTRN	_ASN1_INTEGER_it:PROC
EXTRN	_ASN1_OCTET_STRING_it:PROC
;	COMDAT ??_C@_08CKLJFNPB@PBEPARAM?$AA@
CONST	SEGMENT
??_C@_08CKLJFNPB@PBEPARAM?$AA@ DB 'PBEPARAM', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_04BKLHDIKK@iter?$AA@
CONST	SEGMENT
??_C@_04BKLHDIKK@iter?$AA@ DB 'iter', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04OKLIMCN@salt?$AA@
CONST	SEGMENT
??_C@_04OKLIMCN@salt?$AA@ DB 'salt', 00H		; `string'
CONST	ENDS
CONST	SEGMENT
_PBEPARAM_seq_tt DD 00H
	DD	00H
	DD	00H
	DD	FLAT:??_C@_04OKLIMCN@salt?$AA@
	DD	FLAT:_ASN1_OCTET_STRING_it
	DD	00H
	DD	00H
	DD	04H
	DD	FLAT:??_C@_04BKLHDIKK@iter?$AA@
	DD	FLAT:_ASN1_INTEGER_it
?local_it@?1??PBEPARAM_it@@9@9 DB 01H			; `PBEPARAM_it'::`2'::local_it
	ORG $+3
	DD	010H
	DD	FLAT:_PBEPARAM_seq_tt
	DD	02H
	DD	00H
	DD	08H
	DD	FLAT:??_C@_08CKLJFNPB@PBEPARAM?$AA@
CONST	ENDS
PUBLIC	_PBEPARAM_new
PUBLIC	_PBEPARAM_free
PUBLIC	_d2i_PBEPARAM
PUBLIC	_i2d_PBEPARAM
PUBLIC	_PBEPARAM_it
PUBLIC	_PKCS5_pbe_set0_algor
PUBLIC	_PKCS5_pbe_set
PUBLIC	??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@ ; `string'
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_STRING_free:PROC
EXTRN	_ASN1_STRING_set:PROC
EXTRN	_ASN1_STRING_data:PROC
EXTRN	_ASN1_INTEGER_set:PROC
EXTRN	_ASN1_item_pack:PROC
EXTRN	_ASN1_item_new:PROC
EXTRN	_ASN1_item_free:PROC
EXTRN	_ASN1_item_d2i:PROC
EXTRN	_ASN1_item_i2d:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_X509_ALGOR_set0:PROC
EXTRN	_X509_ALGOR_new:PROC
EXTRN	_X509_ALGOR_free:PROC
EXTRN	_RAND_pseudo_bytes:PROC
EXTRN	__chkstk:PROC
EXTRN	_memcpy:PROC
;	COMDAT ??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@
CONST	SEGMENT
??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@ DB '.\crypto\asn1\p5_'
	DB	'pbe.c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS5_pbe_set
_TEXT	SEGMENT
_alg$ = 8						; size = 4
_iter$ = 12						; size = 4
_salt$ = 16						; size = 4
_saltlen$ = 20						; size = 4
_PKCS5_pbe_set PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 130
	push	esi
; Line 132
	call	_X509_ALGOR_new
	mov	esi, eax
; Line 133
	test	esi, esi
	jne	SHORT $LN2@PKCS5_pbe_
; Line 134
	push	134					; 00000086H
	push	OFFSET ??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@
	push	65					; 00000041H
	push	202					; 000000caH
	push	13					; 0000000dH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 142
	xor	eax, eax
	pop	esi
; Line 143
	ret	0
$LN2@PKCS5_pbe_:
; Line 138
	push	DWORD PTR _saltlen$[esp]
	push	DWORD PTR _salt$[esp+4]
	push	DWORD PTR _iter$[esp+8]
	push	DWORD PTR _alg$[esp+12]
	push	esi
	call	_PKCS5_pbe_set0_algor
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN3@PKCS5_pbe_
; Line 139
	mov	eax, esi
	pop	esi
; Line 143
	ret	0
$LN3@PKCS5_pbe_:
; Line 141
	push	esi
	call	_X509_ALGOR_free
	add	esp, 4
; Line 142
	xor	eax, eax
	pop	esi
; Line 143
	ret	0
_PKCS5_pbe_set ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS5_pbe_set0_algor
_TEXT	SEGMENT
_pbe_str$ = -4						; size = 4
_algor$ = 8						; size = 4
_alg$ = 12						; size = 4
_iter$ = 16						; size = 4
_salt$ = 20						; size = 4
_saltlen$ = 24						; size = 4
_PKCS5_pbe_set0_algor PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 79
	mov	eax, 4
	call	__chkstk
	push	esi
	push	edi
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
; Line 81
	mov	DWORD PTR _pbe_str$[esp+16], 0
; Line 73
	call	_ASN1_item_new
; Line 84
	mov	esi, eax
; Line 73
	add	esp, 4
; Line 85
	test	esi, esi
	jne	SHORT $LN2@PKCS5_pbe_
; Line 86
	push	86					; 00000056H
	push	OFFSET ??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@
	push	65					; 00000041H
	push	215					; 000000d7H
	push	13					; 0000000dH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 87
	jmp	SHORT $LN25@PKCS5_pbe_
$LN2@PKCS5_pbe_:
; Line 89
	mov	eax, DWORD PTR _iter$[esp+8]
	mov	ecx, 2048				; 00000800H
	test	eax, eax
	cmovle	eax, ecx
; Line 91
	push	eax
	push	DWORD PTR [esi+4]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN4@PKCS5_pbe_
; Line 92
	push	92					; 0000005cH
$LN29@PKCS5_pbe_:
	push	OFFSET ??_C@_0BH@BAEMFCCL@?4?2crypto?2asn1?2p5_pbe?4c?$AA@
	push	65					; 00000041H
	push	215					; 000000d7H
	push	13					; 0000000dH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$31:
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	esi
	call	_ASN1_item_free
	add	esp, 8
$LN25@PKCS5_pbe_:
; Line 121
	mov	eax, DWORD PTR _pbe_str$[esp+12]
	test	eax, eax
	je	SHORT $LN13@PKCS5_pbe_
; Line 122
	push	eax
	call	_ASN1_STRING_free
	add	esp, 4
$LN13@PKCS5_pbe_:
; Line 123
	pop	edi
	xor	eax, eax
	pop	esi
; Line 124
	pop	ecx
	ret	0
$LN4@PKCS5_pbe_:
; Line 95
	mov	edi, DWORD PTR _saltlen$[esp+8]
	mov	eax, 8
	test	edi, edi
	cmove	edi, eax
; Line 97
	push	edi
	push	0
	push	DWORD PTR [esi]
	call	_ASN1_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN6@PKCS5_pbe_
; Line 98
	push	98					; 00000062H
; Line 99
	jmp	SHORT $LN29@PKCS5_pbe_
$LN6@PKCS5_pbe_:
; Line 101
	push	DWORD PTR [esi]
	call	_ASN1_STRING_data
; Line 102
	mov	ecx, DWORD PTR _salt$[esp+12]
	add	esp, 4
; Line 103
	push	edi
	test	ecx, ecx
	je	SHORT $LN7@PKCS5_pbe_
	push	ecx
	push	eax
	call	_memcpy
	add	esp, 12					; 0000000cH
	jmp	SHORT $LN9@PKCS5_pbe_
$LN7@PKCS5_pbe_:
; Line 104
	push	eax
	call	_RAND_pseudo_bytes
	add	esp, 8
	test	eax, eax
	js	SHORT $err$31
$LN9@PKCS5_pbe_:
; Line 107
	lea	eax, DWORD PTR _pbe_str$[esp+12]
	push	eax
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	esi
	call	_ASN1_item_pack
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN10@PKCS5_pbe_
; Line 108
	push	108					; 0000006cH
; Line 109
	jmp	$LN29@PKCS5_pbe_
$LN10@PKCS5_pbe_:
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	esi
	call	_ASN1_item_free
	add	esp, 8
; Line 115
	push	DWORD PTR _pbe_str$[esp+12]
	push	16					; 00000010H
	push	DWORD PTR _alg$[esp+16]
	call	_OBJ_nid2obj
	add	esp, 4
	push	eax
	push	DWORD PTR _algor$[esp+20]
	call	_X509_ALGOR_set0
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN25@PKCS5_pbe_
; Line 116
	pop	edi
	mov	eax, 1
	pop	esi
; Line 124
	pop	ecx
	ret	0
_PKCS5_pbe_set0_algor ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PBEPARAM_it
_TEXT	SEGMENT
_PBEPARAM_it PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 71
	mov	eax, OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	ret	0
_PBEPARAM_it ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_PBEPARAM
_TEXT	SEGMENT
_a$ = 8							; size = 4
_out$ = 12						; size = 4
_i2d_PBEPARAM PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	DWORD PTR _out$[esp]
	push	DWORD PTR _a$[esp+4]
	call	_ASN1_item_i2d
	add	esp, 12					; 0000000cH
	ret	0
_i2d_PBEPARAM ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _d2i_PBEPARAM
_TEXT	SEGMENT
_a$ = 8							; size = 4
_in$ = 12						; size = 4
_len$ = 16						; size = 4
_d2i_PBEPARAM PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	DWORD PTR _len$[esp]
	push	DWORD PTR _in$[esp+4]
	push	DWORD PTR _a$[esp+8]
	call	_ASN1_item_d2i
	add	esp, 16					; 00000010H
	ret	0
_d2i_PBEPARAM ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PBEPARAM_free
_TEXT	SEGMENT
_a$ = 8							; size = 4
_PBEPARAM_free PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	push	DWORD PTR _a$[esp]
	call	_ASN1_item_free
	add	esp, 8
	ret	0
_PBEPARAM_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PBEPARAM_new
_TEXT	SEGMENT
_PBEPARAM_new PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\asn1\p5_pbe.c
; Line 73
	push	OFFSET ?local_it@?1??PBEPARAM_it@@9@9
	call	_ASN1_item_new
	add	esp, 4
	ret	0
_PBEPARAM_new ENDP
_TEXT	ENDS
END
