; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

CONST	SEGMENT
?req_hdr@?1??OCSP_REQ_CTX_i2d@@9@9 DB 'Content-Type: application/ocsp-req'
	DB	'uest', 0dH, 0aH, 'Content-Length: %d', 0dH, 0aH, 0dH, 0aH, 00H ; `OCSP_REQ_CTX_i2d'::`2'::req_hdr
	ORG $+1
?http_hdr@?1??OCSP_REQ_CTX_http@@9@9 DB '%s %s HTTP/1.0', 0dH, 0aH, 00H ; `OCSP_REQ_CTX_http'::`2'::http_hdr
CONST	ENDS
PUBLIC	_OCSP_sendreq_bio
PUBLIC	_OCSP_sendreq_new
PUBLIC	_OCSP_REQ_CTX_nbio
PUBLIC	_OCSP_sendreq_nbio
PUBLIC	_OCSP_REQ_CTX_new
PUBLIC	_OCSP_REQ_CTX_free
PUBLIC	_OCSP_set_max_response_length
PUBLIC	_OCSP_REQ_CTX_i2d
PUBLIC	_OCSP_REQ_CTX_nbio_d2i
PUBLIC	_OCSP_REQ_CTX_get0_mem_bio
PUBLIC	_OCSP_REQ_CTX_http
PUBLIC	_OCSP_REQ_CTX_set1_req
PUBLIC	_OCSP_REQ_CTX_add1_header
PUBLIC	??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@ ; `string'
PUBLIC	??_C@_01KMDKNFGN@?1?$AA@			; `string'
PUBLIC	??_C@_02LMMGGCAJ@?3?5?$AA@			; `string'
PUBLIC	??_C@_02PCIJFNDE@?$AN?6?$AA@			; `string'
PUBLIC	??_C@_04HCJEIHPL@POST?$AA@			; `string'
PUBLIC	??_C@_05EMCDOHCD@Code?$DN?$AA@			; `string'
PUBLIC	??_C@_08IFIAACDO@?0Reason?$DN?$AA@		; `string'
EXTRN	__imp__strtoul:PROC
EXTRN	__imp__isspace:PROC
EXTRN	__imp__memchr:PROC
EXTRN	_CRYPTO_malloc:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_BIO_test_flags:PROC
EXTRN	_BIO_new:PROC
EXTRN	_BIO_free:PROC
EXTRN	_BIO_read:PROC
EXTRN	_BIO_gets:PROC
EXTRN	_BIO_write:PROC
EXTRN	_BIO_puts:PROC
EXTRN	_BIO_ctrl:PROC
EXTRN	_BIO_s_mem:PROC
EXTRN	_BIO_printf:PROC
EXTRN	_ASN1_item_i2d_bio:PROC
EXTRN	_ASN1_item_d2i:PROC
EXTRN	_ASN1_item_i2d:PROC
EXTRN	_OCSP_RESPONSE_it:PROC
EXTRN	_OCSP_REQUEST_it:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_add_error_data:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_08IFIAACDO@?0Reason?$DN?$AA@
CONST	SEGMENT
??_C@_08IFIAACDO@?0Reason?$DN?$AA@ DB ',Reason=', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_05EMCDOHCD@Code?$DN?$AA@
CONST	SEGMENT
??_C@_05EMCDOHCD@Code?$DN?$AA@ DB 'Code=', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04HCJEIHPL@POST?$AA@
CONST	SEGMENT
??_C@_04HCJEIHPL@POST?$AA@ DB 'POST', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_02PCIJFNDE@?$AN?6?$AA@
CONST	SEGMENT
??_C@_02PCIJFNDE@?$AN?6?$AA@ DB 0dH, 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_02LMMGGCAJ@?3?5?$AA@
CONST	SEGMENT
??_C@_02LMMGGCAJ@?3?5?$AA@ DB ': ', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_01KMDKNFGN@?1?$AA@
CONST	SEGMENT
??_C@_01KMDKNFGN@?1?$AA@ DB '/', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
CONST	SEGMENT
??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@ DB '.\crypto\ocsp\oc'
	DB	'sp_ht.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _parse_http_line1
_TEXT	SEGMENT
_r$ = 8							; size = 4
_line$ = 8						; size = 4
_parse_http_line1 PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 261
	push	ebx
; Line 266
	mov	ebx, DWORD PTR __imp__isspace
	push	esi
	mov	esi, DWORD PTR _line$[esp+4]
	cmp	BYTE PTR [esi], 0
	je	SHORT $LN3@parse_http
$LL4@parse_http:
	movzx	eax, BYTE PTR [esi]
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN3@parse_http
	inc	esi
	cmp	BYTE PTR [esi], al
	jne	SHORT $LL4@parse_http
; Line 268
	jmp	SHORT $LN44@parse_http
$LN3@parse_http:
	mov	al, BYTE PTR [esi]
	test	al, al
	jne	SHORT $LL5@parse_http
$LN44@parse_http:
; Line 269
	push	269					; 0000010dH
$LN78@parse_http:
	push	OFFSET ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
	push	115					; 00000073H
	push	118					; 00000076H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 270
	xor	eax, eax
	pop	esi
	pop	ebx
; Line 324
	ret	0
$LL5@parse_http:
; Line 274
	movzx	eax, al
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	je	SHORT $LN6@parse_http
	mov	al, BYTE PTR [esi+1]
; Line 275
	inc	esi
	test	al, al
	jne	SHORT $LL5@parse_http
; Line 278
	push	278					; 00000116H
; Line 279
	jmp	SHORT $LN78@parse_http
$LN6@parse_http:
; Line 277
	cmp	BYTE PTR [esi], 0
	jne	SHORT $LN16@parse_http
; Line 278
	push	278					; 00000116H
; Line 279
	jmp	SHORT $LN78@parse_http
$LN16@parse_http:
	push	edi
; Line 283
	mov	edi, esi
$LL9@parse_http:
	movzx	eax, BYTE PTR [edi]
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN8@parse_http
	inc	edi
	cmp	BYTE PTR [edi], al
	jne	SHORT $LL9@parse_http
$LN8@parse_http:
; Line 286
	cmp	BYTE PTR [edi], 0
	jne	SHORT $LN17@parse_http
; Line 287
	push	287					; 0000011fH
	push	OFFSET ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
	push	115					; 00000073H
	push	118					; 00000076H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 288
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebx
; Line 324
	ret	0
$LN17@parse_http:
	push	ebp
; Line 295
	push	10					; 0000000aH
	lea	eax, DWORD PTR _r$[esp+16]
	mov	BYTE PTR [edi], 0
	push	eax
	push	esi
	inc	edi
	call	DWORD PTR __imp__strtoul
; Line 297
	mov	ecx, DWORD PTR _r$[esp+24]
	add	esp, 12					; 0000000cH
	mov	ebp, eax
	cmp	BYTE PTR [ecx], 0
	jne	$LN22@parse_http
; Line 301
	mov	al, BYTE PTR [edi]
	test	al, al
	je	SHORT $LN13@parse_http
$LL10@parse_http:
	movzx	eax, al
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	je	SHORT $LN11@parse_http
	mov	al, BYTE PTR [edi+1]
; Line 302
	inc	edi
	test	al, al
	jne	SHORT $LL10@parse_http
; Line 304
	jmp	SHORT $LN13@parse_http
$LN11@parse_http:
	cmp	BYTE PTR [edi], 0
	je	SHORT $LN13@parse_http
; Line 310
	mov	ecx, edi
	lea	edx, DWORD PTR [ecx+1]
$LL55@parse_http:
	mov	al, BYTE PTR [ecx]
	inc	ecx
	test	al, al
	jne	SHORT $LL55@parse_http
	sub	ecx, edx
	lea	eax, DWORD PTR [ecx-1]
	add	eax, edi
	mov	DWORD PTR _r$[esp+12], eax
	movzx	eax, BYTE PTR [eax]
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	je	SHORT $LN13@parse_http
$LL14@parse_http:
; Line 311
	mov	eax, DWORD PTR _r$[esp+12]
	mov	BYTE PTR [eax], 0
	mov	eax, DWORD PTR _r$[esp+12]
	dec	eax
	mov	DWORD PTR _r$[esp+12], eax
	movzx	eax, BYTE PTR [eax]
	push	eax
	call	ebx
	add	esp, 4
	test	eax, eax
	jne	SHORT $LL14@parse_http
$LN13@parse_http:
; Line 313
	cmp	ebp, 200				; 000000c8H
	je	SHORT $LN20@parse_http
; Line 314
	push	314					; 0000013aH
	push	OFFSET ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
	push	114					; 00000072H
	push	118					; 00000076H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 315
	cmp	BYTE PTR [edi], 0
	jne	SHORT $LN21@parse_http
; Line 316
	push	esi
	push	OFFSET ??_C@_05EMCDOHCD@Code?$DN?$AA@
	push	2
	call	_ERR_add_error_data
	add	esp, 12					; 0000000cH
; Line 319
	xor	eax, eax
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
; Line 324
	ret	0
$LN21@parse_http:
; Line 318
	push	edi
	push	OFFSET ??_C@_08IFIAACDO@?0Reason?$DN?$AA@
	push	esi
	push	OFFSET ??_C@_05EMCDOHCD@Code?$DN?$AA@
	push	4
	call	_ERR_add_error_data
	add	esp, 20					; 00000014H
$LN22@parse_http:
; Line 319
	pop	ebp
	pop	edi
	pop	esi
	xor	eax, eax
	pop	ebx
; Line 324
	ret	0
$LN20@parse_http:
	pop	ebp
	pop	edi
	pop	esi
; Line 322
	mov	eax, 1
	pop	ebx
; Line 324
	ret	0
_parse_http_line1 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_add1_header
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_OCSP_REQ_CTX_add1_header PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 217
	mov	eax, DWORD PTR _name$[esp-4]
	test	eax, eax
	jne	SHORT $LN2@OCSP_REQ_C
; Line 231
	ret	0
$LN2@OCSP_REQ_C:
	push	esi
; Line 219
	mov	esi, DWORD PTR _rctx$[esp]
	push	eax
	push	DWORD PTR [esi+16]
	call	_BIO_puts
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN10@OCSP_REQ_C
; Line 221
	cmp	DWORD PTR _value$[esp], 0
	je	SHORT $LN6@OCSP_REQ_C
; Line 222
	push	2
	push	OFFSET ??_C@_02LMMGGCAJ@?3?5?$AA@
	push	DWORD PTR [esi+16]
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, 2
	jne	SHORT $LN10@OCSP_REQ_C
; Line 224
	push	DWORD PTR _value$[esp]
	push	DWORD PTR [esi+16]
	call	_BIO_puts
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN10@OCSP_REQ_C
$LN6@OCSP_REQ_C:
; Line 227
	push	2
	push	OFFSET ??_C@_02PCIJFNDE@?$AN?6?$AA@
	push	DWORD PTR [esi+16]
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, 2
	je	SHORT $LN7@OCSP_REQ_C
$LN10@OCSP_REQ_C:
; Line 228
	xor	eax, eax
	pop	esi
; Line 231
	ret	0
$LN7@OCSP_REQ_C:
; Line 229
	mov	DWORD PTR [esi], 4105			; 00001009H
; Line 230
	mov	eax, 1
	pop	esi
; Line 231
	ret	0
_OCSP_REQ_CTX_add1_header ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_set1_req
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_req$ = 12						; size = 4
_OCSP_REQ_CTX_set1_req PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 209
	push	esi
	push	edi
; Line 210
	call	_OCSP_REQUEST_it
	mov	edi, eax
; Line 167
	push	edi
	push	0
	push	DWORD PTR _req$[esp+12]
	call	_ASN1_item_i2d
; Line 168
	mov	esi, DWORD PTR _rctx$[esp+16]
	push	eax
	push	OFFSET ?req_hdr@?1??OCSP_REQ_CTX_i2d@@9@9
	push	DWORD PTR [esi+16]
	call	_BIO_printf
	add	esp, 24					; 00000018H
	test	eax, eax
	jg	SHORT $LN4@OCSP_REQ_C
$LN7@OCSP_REQ_C:
	pop	edi
; Line 210
	xor	eax, eax
	pop	esi
; Line 212
	ret	0
$LN4@OCSP_REQ_C:
; Line 170
	push	DWORD PTR _req$[esp+4]
	push	DWORD PTR [esi+16]
	push	edi
	call	_ASN1_item_i2d_bio
	add	esp, 12					; 0000000cH
	test	eax, eax
	jle	SHORT $LN7@OCSP_REQ_C
	pop	edi
; Line 172
	mov	DWORD PTR [esi], 4101			; 00001005H
; Line 210
	mov	eax, 1
	pop	esi
; Line 212
	ret	0
_OCSP_REQ_CTX_set1_req ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_http
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_op$ = 12						; size = 4
_path$ = 16						; size = 4
_OCSP_REQ_CTX_http PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 199
	mov	eax, DWORD PTR _path$[esp-4]
	mov	ecx, OFFSET ??_C@_01KMDKNFGN@?1?$AA@
	push	esi
; Line 202
	mov	esi, DWORD PTR _rctx$[esp]
	test	eax, eax
	cmovne	ecx, eax
	push	ecx
	push	DWORD PTR _op$[esp+4]
	push	OFFSET ?http_hdr@?1??OCSP_REQ_CTX_http@@9@9
	push	DWORD PTR [esi+16]
	call	_BIO_printf
	add	esp, 16					; 00000010H
	test	eax, eax
	jg	SHORT $LN3@OCSP_REQ_C
; Line 203
	xor	eax, eax
	pop	esi
; Line 206
	ret	0
$LN3@OCSP_REQ_C:
; Line 204
	mov	DWORD PTR [esi], 4105			; 00001009H
; Line 205
	mov	eax, 1
	pop	esi
; Line 206
	ret	0
_OCSP_REQ_CTX_http ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_get0_mem_bio
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_OCSP_REQ_CTX_get0_mem_bio PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 151
	mov	eax, DWORD PTR _rctx$[esp-4]
	mov	eax, DWORD PTR [eax+16]
; Line 152
	ret	0
_OCSP_REQ_CTX_get0_mem_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_nbio_d2i
_TEXT	SEGMENT
_p$ = -4						; size = 4
_rctx$ = 8						; size = 4
_pval$ = 12						; size = 4
_it$ = 16						; size = 4
_OCSP_REQ_CTX_nbio_d2i PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 178
	mov	eax, 4
	call	__chkstk
	push	esi
; Line 182
	mov	esi, DWORD PTR _rctx$[esp+4]
	push	esi
	call	_OCSP_REQ_CTX_nbio
	add	esp, 4
; Line 183
	cmp	eax, 1
	jne	SHORT $LN1@OCSP_REQ_C
; Line 186
	lea	eax, DWORD PTR _p$[esp+8]
	push	eax
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
; Line 187
	push	DWORD PTR _it$[esp+20]
	push	eax
	lea	eax, DWORD PTR _p$[esp+32]
	push	eax
	push	0
	call	_ASN1_item_d2i
	mov	ecx, DWORD PTR _pval$[esp+36]
	add	esp, 32					; 00000020H
	mov	DWORD PTR [ecx], eax
; Line 188
	test	eax, eax
	jne	SHORT $LN3@OCSP_REQ_C
; Line 189
	mov	DWORD PTR [esi], 4096			; 00001000H
	pop	esi
; Line 193
	pop	ecx
	ret	0
$LN3@OCSP_REQ_C:
; Line 192
	mov	eax, 1
$LN1@OCSP_REQ_C:
	pop	esi
; Line 193
	pop	ecx
	ret	0
_OCSP_REQ_CTX_nbio_d2i ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_i2d
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_it$ = 12						; size = 4
_val$ = 16						; size = 4
_OCSP_REQ_CTX_i2d PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 163
	push	esi
; Line 167
	push	DWORD PTR _it$[esp]
	push	0
	push	DWORD PTR _val$[esp+8]
	call	_ASN1_item_i2d
; Line 168
	mov	esi, DWORD PTR _rctx$[esp+12]
	push	eax
	push	OFFSET ?req_hdr@?1??OCSP_REQ_CTX_i2d@@9@9
	push	DWORD PTR [esi+16]
	call	_BIO_printf
	add	esp, 24					; 00000018H
	test	eax, eax
	jg	SHORT $LN2@OCSP_REQ_C
$LN5@OCSP_REQ_C:
; Line 169
	xor	eax, eax
	pop	esi
; Line 174
	ret	0
$LN2@OCSP_REQ_C:
; Line 170
	push	DWORD PTR _val$[esp]
	push	DWORD PTR [esi+16]
	push	DWORD PTR _it$[esp+8]
	call	_ASN1_item_i2d_bio
	add	esp, 12					; 0000000cH
	test	eax, eax
	jle	SHORT $LN5@OCSP_REQ_C
; Line 172
	mov	DWORD PTR [esi], 4101			; 00001005H
; Line 173
	mov	eax, 1
	pop	esi
; Line 174
	ret	0
_OCSP_REQ_CTX_i2d ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_set_max_response_length
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_len$ = 12						; size = 4
_OCSP_set_max_response_length PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 156
	mov	ecx, DWORD PTR _len$[esp-4]
	mov	eax, 102400				; 00019000H
	test	ecx, ecx
	cmove	ecx, eax
	mov	eax, DWORD PTR _rctx$[esp-4]
	mov	DWORD PTR [eax+24], ecx
; Line 160
	ret	0
_OCSP_set_max_response_length ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_free
_TEXT	SEGMENT
_rctx$ = 8						; size = 4
_OCSP_REQ_CTX_free PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 141
	push	esi
; Line 142
	mov	esi, DWORD PTR _rctx$[esp]
	mov	eax, DWORD PTR [esi+16]
	test	eax, eax
	je	SHORT $LN2@OCSP_REQ_C
; Line 143
	push	eax
	call	_BIO_free
	add	esp, 4
$LN2@OCSP_REQ_C:
; Line 144
	mov	eax, DWORD PTR [esi+4]
	test	eax, eax
	je	SHORT $LN3@OCSP_REQ_C
; Line 145
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN3@OCSP_REQ_C:
; Line 146
	push	esi
	call	_CRYPTO_free
	add	esp, 4
	pop	esi
; Line 147
	ret	0
_OCSP_REQ_CTX_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_new
_TEXT	SEGMENT
_io$ = 8						; size = 4
_maxline$ = 12						; size = 4
_OCSP_REQ_CTX_new PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 118
	push	esi
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
	push	28					; 0000001cH
	call	_CRYPTO_malloc
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 121
	test	esi, esi
	je	$LN12@OCSP_REQ_C
; Line 123
	mov	DWORD PTR [esi], 4096			; 00001000H
; Line 124
	mov	DWORD PTR [esi+24], 102400		; 00019000H
; Line 125
	call	_BIO_s_mem
	push	eax
	call	_BIO_new
	mov	DWORD PTR [esi+16], eax
	add	esp, 4
; Line 126
	mov	eax, DWORD PTR _io$[esp]
	mov	DWORD PTR [esi+12], eax
; Line 128
	mov	eax, DWORD PTR _maxline$[esp]
	mov	DWORD PTR [esi+20], 0
	test	eax, eax
	jle	SHORT $LN3@OCSP_REQ_C
; Line 129
	mov	DWORD PTR [esi+8], eax
	jmp	SHORT $LN4@OCSP_REQ_C
$LN3@OCSP_REQ_C:
; Line 131
	mov	DWORD PTR [esi+8], 4096			; 00001000H
$LN4@OCSP_REQ_C:
; Line 132
	push	132					; 00000084H
	push	OFFSET ??_C@_0BI@NEOCCAED@?4?2crypto?2ocsp?2ocsp_ht?4c?$AA@
	push	DWORD PTR [esi+8]
	call	_CRYPTO_malloc
	add	esp, 12					; 0000000cH
	mov	DWORD PTR [esi+4], eax
; Line 133
	test	eax, eax
	je	SHORT $LN6@OCSP_REQ_C
	cmp	DWORD PTR [esi+16], 0
	je	SHORT $LN6@OCSP_REQ_C
; Line 137
	mov	eax, esi
	pop	esi
; Line 138
	ret	0
$LN6@OCSP_REQ_C:
; Line 142
	mov	eax, DWORD PTR [esi+16]
	test	eax, eax
	je	SHORT $LN9@OCSP_REQ_C
; Line 143
	push	eax
	call	_BIO_free
	add	esp, 4
$LN9@OCSP_REQ_C:
; Line 144
	mov	eax, DWORD PTR [esi+4]
	test	eax, eax
	je	SHORT $LN10@OCSP_REQ_C
; Line 145
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN10@OCSP_REQ_C:
; Line 146
	push	esi
	call	_CRYPTO_free
	add	esp, 4
$LN12@OCSP_REQ_C:
; Line 135
	xor	eax, eax
	pop	esi
; Line 138
	ret	0
_OCSP_REQ_CTX_new ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_sendreq_nbio
_TEXT	SEGMENT
_p$1 = -4						; size = 4
_presp$ = 8						; size = 4
_rctx$ = 12						; size = 4
_OCSP_sendreq_nbio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 526
	mov	eax, 4
	call	__chkstk
	push	esi
	push	edi
; Line 527
	call	_OCSP_RESPONSE_it
; Line 182
	mov	esi, DWORD PTR _rctx$[esp+8]
; Line 527
	mov	edi, eax
; Line 182
	push	esi
	call	_OCSP_REQ_CTX_nbio
	add	esp, 4
; Line 183
	cmp	eax, 1
	jne	SHORT $LN3@OCSP_sendr
; Line 186
	lea	eax, DWORD PTR _p$1[esp+12]
	push	eax
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
; Line 187
	push	edi
	push	eax
	lea	eax, DWORD PTR _p$1[esp+36]
	push	eax
	push	0
	call	_ASN1_item_d2i
	mov	ecx, DWORD PTR _presp$[esp+40]
	add	esp, 32					; 00000020H
	mov	DWORD PTR [ecx], eax
; Line 188
	test	eax, eax
	jne	SHORT $LN5@OCSP_sendr
	pop	edi
; Line 189
	mov	DWORD PTR [esi], 4096			; 00001000H
	pop	esi
; Line 530
	pop	ecx
	ret	0
$LN5@OCSP_sendr:
; Line 527
	mov	eax, 1
$LN3@OCSP_sendr:
	pop	edi
	pop	esi
; Line 530
	pop	ecx
	ret	0
_OCSP_sendreq_nbio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_REQ_CTX_nbio
_TEXT	SEGMENT
_p$ = 8							; size = 4
_rctx$ = 8						; size = 4
_OCSP_REQ_CTX_nbio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 327
	push	ebx
	push	ebp
	mov	ebp, DWORD PTR __imp__memchr
	push	esi
	mov	esi, DWORD PTR _rctx$[esp+8]
	push	edi
	npad	2
$next_io$111:
; Line 331
	test	DWORD PTR [esi], 4096			; 00001000H
	jne	SHORT $LN13@OCSP_REQ_C
; Line 332
	push	DWORD PTR [esi+8]
	push	DWORD PTR [esi+4]
	push	DWORD PTR [esi+12]
	call	_BIO_read
	mov	edi, eax
	add	esp, 12					; 0000000cH
; Line 334
	test	edi, edi
	jle	$LN68@OCSP_REQ_C
; Line 342
	push	edi
	push	DWORD PTR [esi+4]
	push	DWORD PTR [esi+16]
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, edi
	jne	SHORT $LN2@OCSP_REQ_C
$LN13@OCSP_REQ_C:
; Line 346
	mov	eax, DWORD PTR [esi]
	cmp	eax, 4101				; 00001005H
	jg	$LN51@OCSP_REQ_C
	je	$LN16@OCSP_REQ_C
	cmp	eax, 4
	jg	SHORT $LN2@OCSP_REQ_C
	je	$LN47@OCSP_REQ_C
	test	eax, eax
	jle	SHORT $LN2@OCSP_REQ_C
	cmp	eax, 2
	jle	SHORT $next_line$112
	cmp	eax, 3
	je	$LN33@OCSP_REQ_C
$LN2@OCSP_REQ_C:
	pop	edi
	pop	esi
	pop	ebp
; Line 521
	xor	eax, eax
	pop	ebx
; Line 523
	ret	0
	npad	3
$next_line$112:
; Line 409
	lea	eax, DWORD PTR _p$[esp+12]
	push	eax
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
	mov	edi, eax
	add	esp, 16					; 00000010H
; Line 410
	test	edi, edi
	jle	$LN27@OCSP_REQ_C
	push	edi
	push	10					; 0000000aH
	push	DWORD PTR _p$[esp+20]
	call	ebp
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN27@OCSP_REQ_C
; Line 417
	push	DWORD PTR [esi+8]
	push	DWORD PTR [esi+4]
	push	DWORD PTR [esi+16]
	call	_BIO_gets
	add	esp, 12					; 0000000cH
; Line 419
	test	eax, eax
	jle	$LN66@OCSP_REQ_C
; Line 427
	cmp	eax, DWORD PTR [esi+8]
	je	$LN34@OCSP_REQ_C
; Line 433
	cmp	DWORD PTR [esi], 1
	jne	SHORT $LN32@OCSP_REQ_C
; Line 434
	push	DWORD PTR [esi+4]
	call	_parse_http_line1
	add	esp, 4
	test	eax, eax
	je	$LN34@OCSP_REQ_C
; Line 435
	mov	DWORD PTR [esi], 2
; Line 436
	jmp	SHORT $next_line$112
$LN32@OCSP_REQ_C:
; Line 443
	mov	ecx, DWORD PTR [esi+4]
	mov	DWORD PTR _p$[esp+12], ecx
	mov	al, BYTE PTR [ecx]
	test	al, al
	je	SHORT $LN104@OCSP_REQ_C
$LL6@OCSP_REQ_C:
; Line 444
	cmp	al, 13					; 0000000dH
	je	SHORT $LN4@OCSP_REQ_C
	cmp	al, 10					; 0000000aH
	jne	SHORT $LN64@OCSP_REQ_C
$LN4@OCSP_REQ_C:
; Line 443
	inc	ecx
	mov	DWORD PTR _p$[esp+12], ecx
	mov	al, BYTE PTR [ecx]
	test	al, al
	jne	SHORT $LL6@OCSP_REQ_C
	jmp	SHORT $LN104@OCSP_REQ_C
$LN64@OCSP_REQ_C:
; Line 447
	cmp	BYTE PTR [ecx], 0
	jne	$next_line$112
$LN104@OCSP_REQ_C:
; Line 450
	mov	DWORD PTR [esi], 3
$LN33@OCSP_REQ_C:
; Line 462
	lea	eax, DWORD PTR _p$[esp+12]
	push	eax
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
	mov	edi, eax
	add	esp, 16					; 00000010H
; Line 463
	cmp	edi, 2
	jl	$next_io$111
; Line 467
	mov	edx, DWORD PTR _p$[esp+12]
	mov	cl, BYTE PTR [edx]
	inc	edx
	mov	DWORD PTR _p$[esp+12], edx
	cmp	cl, 48					; 00000030H
	jne	$LN34@OCSP_REQ_C
; Line 473
	mov	al, BYTE PTR [edx]
	test	al, al
	jns	SHORT $LN41@OCSP_REQ_C
; Line 478
	cmp	edi, 6
	jl	$next_io$111
; Line 480
	movzx	ebx, al
	and	ebx, 127				; 0000007fH
; Line 482
	je	$LN34@OCSP_REQ_C
	cmp	ebx, 4
	jg	$LN34@OCSP_REQ_C
; Line 486
	inc	edx
; Line 487
	mov	DWORD PTR [esi+20], 0
	mov	DWORD PTR _p$[esp+12], edx
; Line 488
	test	ebx, ebx
	jle	SHORT $LN8@OCSP_REQ_C
	xor	ecx, ecx
	mov	edi, ebx
$LL9@OCSP_REQ_C:
; Line 489
	shl	ecx, 8
	mov	DWORD PTR [esi+20], ecx
; Line 490
	movzx	eax, BYTE PTR [edx]
	inc	edx
	or	ecx, eax
	mov	DWORD PTR _p$[esp+12], edx
	mov	DWORD PTR [esi+20], ecx
	sub	edi, 1
	jne	SHORT $LL9@OCSP_REQ_C
$LN8@OCSP_REQ_C:
; Line 493
	mov	eax, DWORD PTR [esi+20]
	cmp	eax, DWORD PTR [esi+24]
	ja	SHORT $LN34@OCSP_REQ_C
; Line 498
	add	eax, 2
	add	eax, ebx
; Line 499
	jmp	SHORT $LN108@OCSP_REQ_C
$LN41@OCSP_REQ_C:
; Line 500
	movzx	eax, al
	add	eax, 2
$LN108@OCSP_REQ_C:
	mov	DWORD PTR [esi+20], eax
; Line 502
	mov	DWORD PTR [esi], 4
$LN47@OCSP_REQ_C:
; Line 507
	push	0
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
; Line 508
	cmp	eax, DWORD PTR [esi+20]
	jl	$next_io$111
; Line 511
	mov	DWORD PTR [esi], 4104			; 00001008H
$LN49@OCSP_REQ_C:
	pop	edi
	pop	esi
	pop	ebp
; Line 512
	mov	eax, 1
	pop	ebx
; Line 523
	ret	0
$LN66@OCSP_REQ_C:
; Line 420
	push	8
	push	DWORD PTR [esi+16]
	call	_BIO_test_flags
	add	esp, 8
	test	eax, eax
	jne	$next_io$111
$LN34@OCSP_REQ_C:
	pop	edi
; Line 438
	mov	DWORD PTR [esi], 4096			; 00001000H
; Line 521
	xor	eax, eax
	pop	esi
	pop	ebp
	pop	ebx
; Line 523
	ret	0
$LN27@OCSP_REQ_C:
; Line 411
	cmp	edi, DWORD PTR [esi+8]
	jl	$next_io$111
; Line 438
	pop	edi
	mov	DWORD PTR [esi], 4096			; 00001000H
; Line 521
	xor	eax, eax
	pop	esi
	pop	ebp
	pop	ebx
; Line 523
	ret	0
$LN51@OCSP_REQ_C:
; Line 346
	sub	eax, 4102				; 00001006H
	cmp	eax, 3
	ja	$LN2@OCSP_REQ_C
	jmp	DWORD PTR $LN110@OCSP_REQ_C[eax*4]
$LN14@OCSP_REQ_C:
; Line 349
	push	2
	push	OFFSET ??_C@_02PCIJFNDE@?$AN?6?$AA@
	push	DWORD PTR [esi+16]
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, 2
	jne	SHORT $LN34@OCSP_REQ_C
; Line 353
	mov	DWORD PTR [esi], 4101			; 00001005H
$LN16@OCSP_REQ_C:
; Line 356
	push	0
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	mov	DWORD PTR [esi+20], eax
; Line 357
	mov	DWORD PTR [esi], 4102			; 00001006H
$LN17@OCSP_REQ_C:
; Line 360
	lea	eax, DWORD PTR _p$[esp+12]
	push	eax
	push	0
	push	3
	push	DWORD PTR [esi+16]
	call	_BIO_ctrl
; Line 362
	mov	ecx, DWORD PTR [esi+20]
	mov	edx, DWORD PTR _p$[esp+28]
	sub	edx, ecx
	push	ecx
	add	edx, eax
	push	edx
	push	DWORD PTR [esi+12]
	call	_BIO_write
	add	esp, 28					; 0000001cH
; Line 364
	test	eax, eax
	jle	SHORT $LN76@OCSP_REQ_C
; Line 371
	sub	DWORD PTR [esi+20], eax
; Line 373
	jne	$next_io$111
; Line 378
	push	0
	push	0
	push	1
	push	DWORD PTR [esi+16]
	mov	DWORD PTR [esi], 4103			; 00001007H
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
$LN21@OCSP_REQ_C:
; Line 382
	push	0
	push	0
	push	11					; 0000000bH
	push	DWORD PTR [esi+12]
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
; Line 384
	test	eax, eax
	jle	SHORT $LN76@OCSP_REQ_C
; Line 385
	mov	DWORD PTR [esi], 1
; Line 386
	jmp	$next_io$111
$LN68@OCSP_REQ_C:
; Line 335
	push	8
	push	DWORD PTR [esi+12]
	call	_BIO_test_flags
	add	esp, 8
	neg	eax
	sbb	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 523
	ret	0
$LN76@OCSP_REQ_C:
; Line 365
	push	8
	push	DWORD PTR [esi+12]
	call	_BIO_test_flags
	add	esp, 8
	test	eax, eax
	je	$LN34@OCSP_REQ_C
; Line 366
	pop	edi
	pop	esi
	pop	ebp
	or	eax, -1
	pop	ebx
; Line 523
	ret	0
$LN110@OCSP_REQ_C:
	DD	$LN17@OCSP_REQ_C
	DD	$LN21@OCSP_REQ_C
	DD	$LN49@OCSP_REQ_C
	DD	$LN14@OCSP_REQ_C
_OCSP_REQ_CTX_nbio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_sendreq_new
_TEXT	SEGMENT
_io$ = 8						; size = 4
_path$ = 12						; size = 4
_req$ = 16						; size = 4
_maxline$ = 20						; size = 4
_OCSP_sendreq_new PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 235
	push	esi
; Line 238
	push	DWORD PTR _maxline$[esp]
	push	DWORD PTR _io$[esp+4]
	call	_OCSP_REQ_CTX_new
	mov	esi, eax
	add	esp, 8
; Line 239
	test	esi, esi
	je	SHORT $LN15@OCSP_sendr
; Line 242
	mov	eax, DWORD PTR _path$[esp]
; Line 199
	mov	ecx, OFFSET ??_C@_01KMDKNFGN@?1?$AA@
	test	eax, eax
	cmovne	ecx, eax
; Line 202
	push	ecx
	push	OFFSET ??_C@_04HCJEIHPL@POST?$AA@
	push	OFFSET ?http_hdr@?1??OCSP_REQ_CTX_http@@9@9
	push	DWORD PTR [esi+16]
	call	_BIO_printf
	add	esp, 16					; 00000010H
	test	eax, eax
	jle	SHORT $err$17
; Line 245
	mov	eax, DWORD PTR _req$[esp]
; Line 204
	mov	DWORD PTR [esi], 4105			; 00001009H
; Line 245
	test	eax, eax
	je	SHORT $LN4@OCSP_sendr
	push	eax
	push	esi
	call	_OCSP_REQ_CTX_set1_req
	add	esp, 8
	test	eax, eax
	je	SHORT $err$17
$LN4@OCSP_sendr:
; Line 248
	mov	eax, esi
	pop	esi
; Line 253
	ret	0
$err$17:
; Line 142
	mov	eax, DWORD PTR [esi+16]
	test	eax, eax
	je	SHORT $LN11@OCSP_sendr
; Line 143
	push	eax
	call	_BIO_free
	add	esp, 4
$LN11@OCSP_sendr:
; Line 144
	mov	eax, DWORD PTR [esi+4]
	test	eax, eax
	je	SHORT $LN12@OCSP_sendr
; Line 145
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN12@OCSP_sendr:
; Line 146
	push	esi
	call	_CRYPTO_free
	add	esp, 4
$LN15@OCSP_sendr:
; Line 252
	xor	eax, eax
	pop	esi
; Line 253
	ret	0
_OCSP_sendreq_new ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_sendreq_bio
_TEXT	SEGMENT
_p$1 = -4						; size = 4
_b$ = 8							; size = 4
_path$ = 12						; size = 4
_req$ = 16						; size = 4
_OCSP_sendreq_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_ht.c
; Line 535
	mov	eax, 4
	call	__chkstk
	push	ebx
; Line 540
	mov	ebx, DWORD PTR _b$[esp+4]
	push	edi
	push	-1
	push	DWORD PTR _req$[esp+12]
	push	DWORD PTR _path$[esp+16]
	push	ebx
	call	_OCSP_sendreq_new
	mov	edi, eax
	add	esp, 16					; 00000010H
; Line 542
	test	edi, edi
	jne	SHORT $LN30@OCSP_sendr
	pop	edi
	pop	ebx
; Line 555
	pop	ecx
	ret	0
$LN30@OCSP_sendr:
	push	ebp
	push	esi
	npad	1
$LL4@OCSP_sendr:
; Line 527
	call	_OCSP_RESPONSE_it
; Line 182
	push	edi
; Line 527
	mov	ebp, eax
; Line 182
	call	_OCSP_REQ_CTX_nbio
	mov	esi, eax
	add	esp, 4
; Line 183
	cmp	esi, 1
	je	SHORT $LN12@OCSP_sendr
; Line 547
	cmp	esi, -1
	jne	SHORT $LN29@OCSP_sendr
	push	8
	push	ebx
	call	_BIO_test_flags
	add	esp, 8
	test	eax, eax
	jne	SHORT $LL4@OCSP_sendr
$LN29@OCSP_sendr:
	xor	ebx, ebx
$LN6@OCSP_sendr:
; Line 142
	mov	eax, DWORD PTR [edi+16]
	test	eax, eax
	je	SHORT $LN16@OCSP_sendr
; Line 143
	push	eax
	call	_BIO_free
	add	esp, 4
$LN16@OCSP_sendr:
; Line 144
	mov	eax, DWORD PTR [edi+4]
	test	eax, eax
	je	SHORT $LN17@OCSP_sendr
; Line 145
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN17@OCSP_sendr:
; Line 146
	push	edi
	call	_CRYPTO_free
	add	esp, 4
; Line 551
	xor	eax, eax
	test	esi, esi
	cmovne	eax, ebx
	pop	esi
	pop	ebp
	pop	edi
	pop	ebx
; Line 555
	pop	ecx
	ret	0
$LN12@OCSP_sendr:
; Line 186
	lea	eax, DWORD PTR _p$1[esp+20]
	push	eax
	push	0
	push	3
	push	DWORD PTR [edi+16]
	call	_BIO_ctrl
; Line 187
	push	ebp
	push	eax
	lea	eax, DWORD PTR _p$1[esp+44]
	push	eax
	push	0
	call	_ASN1_item_d2i
	mov	ebx, eax
	add	esp, 32					; 00000020H
; Line 188
	test	ebx, ebx
	jne	SHORT $LN13@OCSP_sendr
; Line 189
	mov	DWORD PTR [edi], 4096			; 00001000H
; Line 190
	xor	esi, esi
	jmp	SHORT $LN6@OCSP_sendr
$LN13@OCSP_sendr:
; Line 192
	mov	esi, 1
	jmp	SHORT $LN6@OCSP_sendr
_OCSP_sendreq_bio ENDP
_TEXT	ENDS
END
