; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	??_C@_0L@JNOGJJCA@compatible?$AA@		; `string'
PUBLIC	??_C@_0L@HNMCLCCI@SSL?5Client?$AA@		; `string'
PUBLIC	??_C@_0L@DCIAGJKL@SSL?5Server?$AA@		; `string'
PUBLIC	??_C@_0N@OEEPKGPL@S?1MIME?5email?$AA@		; `string'
PUBLIC	??_C@_0O@EEPBMPKP@Object?5Signer?$AA@		; `string'
PUBLIC	??_C@_0P@JHCOMJOI@OCSP?5responder?$AA@		; `string'
PUBLIC	??_C@_0N@CAJJAOJD@OCSP?5request?$AA@		; `string'
PUBLIC	??_C@_0L@CFEJKCOD@TSA?5server?$AA@		; `string'
_BSS	SEGMENT
_trtable DD	01H DUP (?)
_BSS	ENDS
;	COMDAT ??_C@_0L@CFEJKCOD@TSA?5server?$AA@
CONST	SEGMENT
??_C@_0L@CFEJKCOD@TSA?5server?$AA@ DB 'TSA server', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@CAJJAOJD@OCSP?5request?$AA@
CONST	SEGMENT
??_C@_0N@CAJJAOJD@OCSP?5request?$AA@ DB 'OCSP request', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@JHCOMJOI@OCSP?5responder?$AA@
CONST	SEGMENT
??_C@_0P@JHCOMJOI@OCSP?5responder?$AA@ DB 'OCSP responder', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@EEPBMPKP@Object?5Signer?$AA@
CONST	SEGMENT
??_C@_0O@EEPBMPKP@Object?5Signer?$AA@ DB 'Object Signer', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@OEEPKGPL@S?1MIME?5email?$AA@
CONST	SEGMENT
??_C@_0N@OEEPKGPL@S?1MIME?5email?$AA@ DB 'S/MIME email', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@DCIAGJKL@SSL?5Server?$AA@
CONST	SEGMENT
??_C@_0L@DCIAGJKL@SSL?5Server?$AA@ DB 'SSL Server', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@HNMCLCCI@SSL?5Client?$AA@
CONST	SEGMENT
??_C@_0L@HNMCLCCI@SSL?5Client?$AA@ DB 'SSL Client', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@JNOGJJCA@compatible?$AA@
CONST	SEGMENT
??_C@_0L@JNOGJJCA@compatible?$AA@ DB 'compatible', 00H	; `string'
CONST	ENDS
_DATA	SEGMENT
_default_trust DD FLAT:_obj_trust
	ORG $+4
_trstandard DD	01H
	DD	00H
	DD	FLAT:_trust_compat
	DD	FLAT:??_C@_0L@JNOGJJCA@compatible?$AA@
	DD	00H
	DD	00H
	DD	02H
	DD	00H
	DD	FLAT:_trust_1oidany
	DD	FLAT:??_C@_0L@HNMCLCCI@SSL?5Client?$AA@
	DD	082H
	DD	00H
	DD	03H
	DD	00H
	DD	FLAT:_trust_1oidany
	DD	FLAT:??_C@_0L@DCIAGJKL@SSL?5Server?$AA@
	DD	081H
	DD	00H
	DD	04H
	DD	00H
	DD	FLAT:_trust_1oidany
	DD	FLAT:??_C@_0N@OEEPKGPL@S?1MIME?5email?$AA@
	DD	084H
	DD	00H
	DD	05H
	DD	00H
	DD	FLAT:_trust_1oidany
	DD	FLAT:??_C@_0O@EEPBMPKP@Object?5Signer?$AA@
	DD	083H
	DD	00H
	DD	06H
	DD	00H
	DD	FLAT:_trust_1oid
	DD	FLAT:??_C@_0P@JHCOMJOI@OCSP?5responder?$AA@
	DD	0b4H
	DD	00H
	DD	07H
	DD	00H
	DD	FLAT:_trust_1oid
	DD	FLAT:??_C@_0N@CAJJAOJD@OCSP?5request?$AA@
	DD	0b2H
	DD	00H
	DD	08H
	DD	00H
	DD	FLAT:_trust_1oidany
	DD	FLAT:??_C@_0L@CFEJKCOD@TSA?5server?$AA@
	DD	085H
	DD	00H
_DATA	ENDS
PUBLIC	_X509_TRUST_set_default
PUBLIC	_X509_TRUST_set
PUBLIC	_X509_check_trust
PUBLIC	_X509_TRUST_get_count
PUBLIC	_X509_TRUST_get0
PUBLIC	_X509_TRUST_get_by_id
PUBLIC	_X509_TRUST_add
PUBLIC	_X509_TRUST_cleanup
PUBLIC	_X509_TRUST_get_flags
PUBLIC	_X509_TRUST_get0_name
PUBLIC	_X509_TRUST_get_trust
PUBLIC	??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@ ; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_new:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_sk_find:PROC
EXTRN	_sk_push:PROC
EXTRN	_CRYPTO_malloc:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_BUF_strdup:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_X509_check_purpose:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@
CONST	SEGMENT
??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@ DB '.\crypto\x509\x'
	DB	'509_trs.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _obj_trust
_TEXT	SEGMENT
_id$ = 8						; size = 4
_x$ = 12						; size = 4
_flags$ = 16						; size = 4
_obj_trust PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 300
	mov	eax, DWORD PTR _x$[esp-4]
	push	esi
	mov	esi, DWORD PTR [eax+100]
; Line 301
	test	esi, esi
	jne	SHORT $LN8@obj_trust
; Line 302
	lea	eax, DWORD PTR [esi+3]
	pop	esi
; Line 318
	ret	0
$LN8@obj_trust:
; Line 303
	mov	eax, DWORD PTR [esi+4]
	push	ebx
	mov	ebx, DWORD PTR _id$[esp+4]
	push	edi
	test	eax, eax
	je	SHORT $LN3@obj_trust
; Line 304
	push	eax
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@obj_trust
	npad	3
$LL4@obj_trust:
; Line 305
	push	edi
	push	DWORD PTR [esi+4]
	call	_sk_value
; Line 306
	push	eax
	call	_OBJ_obj2nid
	add	esp, 12					; 0000000cH
	cmp	eax, ebx
	je	SHORT $LN16@obj_trust
; Line 304
	push	DWORD PTR [esi+4]
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL4@obj_trust
$LN3@obj_trust:
; Line 310
	mov	eax, DWORD PTR [esi]
	test	eax, eax
	je	SHORT $LN6@obj_trust
; Line 311
	push	eax
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN6@obj_trust
	npad	5
$LL7@obj_trust:
; Line 312
	push	edi
	push	DWORD PTR [esi]
	call	_sk_value
; Line 313
	push	eax
	call	_OBJ_obj2nid
	add	esp, 12					; 0000000cH
	cmp	eax, ebx
	je	SHORT $LN17@obj_trust
; Line 311
	push	DWORD PTR [esi]
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL7@obj_trust
$LN6@obj_trust:
	pop	edi
	pop	ebx
; Line 317
	mov	eax, 3
	pop	esi
; Line 318
	ret	0
$LN16@obj_trust:
	pop	edi
	pop	ebx
; Line 307
	mov	eax, 2
	pop	esi
; Line 318
	ret	0
$LN17@obj_trust:
	pop	edi
	pop	ebx
; Line 314
	mov	eax, 1
	pop	esi
; Line 318
	ret	0
_obj_trust ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _trust_compat
_TEXT	SEGMENT
_trust$ = 8						; size = 4
_x$ = 12						; size = 4
_flags$ = 16						; size = 4
_trust_compat PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 287
	push	esi
; Line 288
	mov	esi, DWORD PTR _x$[esp]
	push	0
	push	-1
	push	esi
	call	_X509_check_purpose
; Line 289
	mov	eax, DWORD PTR [esi+40]
	add	esp, 12					; 0000000cH
	shr	eax, 12					; 0000000cH
	not	eax
	and	eax, 2
	or	eax, 1
	pop	esi
; Line 293
	ret	0
_trust_compat ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _trust_1oid
_TEXT	SEGMENT
_trust$ = 8						; size = 4
_x$ = 12						; size = 4
_flags$ = 16						; size = 4
_trust_1oid PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 281
	mov	eax, DWORD PTR _x$[esp-4]
	cmp	DWORD PTR [eax+100], 0
	je	SHORT $LN2@trust_1oid
; Line 282
	push	DWORD PTR _flags$[esp-4]
	push	eax
	mov	eax, DWORD PTR _trust$[esp+4]
	push	DWORD PTR [eax+16]
	call	_obj_trust
	add	esp, 12					; 0000000cH
; Line 284
	ret	0
$LN2@trust_1oid:
; Line 283
	mov	eax, 3
; Line 284
	ret	0
_trust_1oid ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _trust_1oidany
_TEXT	SEGMENT
_trust$ = 8						; size = 4
_x$ = 12						; size = 4
_flags$ = 16						; size = 4
_trust_1oidany PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 269
	push	esi
; Line 270
	mov	esi, DWORD PTR _x$[esp]
	mov	eax, DWORD PTR [esi+100]
	test	eax, eax
	je	SHORT $LN2@trust_1oid
	cmp	DWORD PTR [eax], 0
	jne	SHORT $LN3@trust_1oid
	cmp	DWORD PTR [eax+4], 0
	je	SHORT $LN2@trust_1oid
$LN3@trust_1oid:
; Line 271
	push	DWORD PTR _flags$[esp]
	mov	eax, DWORD PTR _trust$[esp+4]
	push	esi
	push	DWORD PTR [eax+16]
	call	_obj_trust
	add	esp, 12					; 0000000cH
	pop	esi
; Line 277
	ret	0
$LN2@trust_1oid:
; Line 288
	push	0
	push	-1
	push	esi
	call	_X509_check_purpose
; Line 289
	mov	eax, DWORD PTR [esi+40]
	add	esp, 12					; 0000000cH
	shr	eax, 12					; 0000000cH
	not	eax
	and	eax, 2
	or	eax, 1
	pop	esi
; Line 277
	ret	0
_trust_1oidany ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _trtable_free
_TEXT	SEGMENT
_p$ = 8							; size = 4
_trtable_free PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 234
	push	esi
; Line 235
	mov	esi, DWORD PTR _p$[esp]
	test	esi, esi
	je	SHORT $LN3@trtable_fr
; Line 237
	mov	eax, DWORD PTR [esi+4]
	test	al, 1
	je	SHORT $LN3@trtable_fr
; Line 238
	test	al, 2
	je	SHORT $LN4@trtable_fr
; Line 239
	push	DWORD PTR [esi+12]
	call	_CRYPTO_free
	add	esp, 4
$LN4@trtable_fr:
; Line 240
	push	esi
	call	_CRYPTO_free
	add	esp, 4
$LN3@trtable_fr:
	pop	esi
; Line 242
	ret	0
_trtable_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _tr_cmp
_TEXT	SEGMENT
_a$ = 8							; size = 4
_b$ = 12						; size = 4
_tr_cmp	PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 105
	mov	eax, DWORD PTR _a$[esp-4]
	mov	edx, DWORD PTR [eax]
	mov	eax, DWORD PTR _b$[esp-4]
	mov	ecx, DWORD PTR [eax]
	mov	eax, DWORD PTR [edx]
	sub	eax, DWORD PTR [ecx]
; Line 106
	ret	0
_tr_cmp	ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get_trust
_TEXT	SEGMENT
_xp$ = 8						; size = 4
_X509_TRUST_get_trust PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 265
	mov	eax, DWORD PTR _xp$[esp-4]
	mov	eax, DWORD PTR [eax]
; Line 266
	ret	0
_X509_TRUST_get_trust ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get0_name
_TEXT	SEGMENT
_xp$ = 8						; size = 4
_X509_TRUST_get0_name PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 260
	mov	eax, DWORD PTR _xp$[esp-4]
	mov	eax, DWORD PTR [eax+12]
; Line 261
	ret	0
_X509_TRUST_get0_name ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get_flags
_TEXT	SEGMENT
_xp$ = 8						; size = 4
_X509_TRUST_get_flags PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 255
	mov	eax, DWORD PTR _xp$[esp-4]
	mov	eax, DWORD PTR [eax+4]
; Line 256
	ret	0
_X509_TRUST_get_flags ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_cleanup
_TEXT	SEGMENT
_X509_TRUST_cleanup PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 245
	push	esi
	push	edi
; Line 247
	mov	esi, OFFSET _trstandard+4
	mov	edi, 8
	npad	4
$LL4@X509_TRUST:
; Line 235
	lea	eax, DWORD PTR [esi-4]
	test	eax, eax
	je	SHORT $LN2@X509_TRUST
; Line 237
	mov	eax, DWORD PTR [esi]
	test	al, 1
	je	SHORT $LN2@X509_TRUST
; Line 238
	test	al, 2
	je	SHORT $LN9@X509_TRUST
; Line 239
	push	DWORD PTR [esi+8]
	call	_CRYPTO_free
	add	esp, 4
$LN9@X509_TRUST:
; Line 240
	lea	eax, DWORD PTR [esi-4]
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN2@X509_TRUST:
; Line 247
	add	esi, 24					; 00000018H
	sub	edi, 1
	jne	SHORT $LL4@X509_TRUST
; Line 249
	push	OFFSET _trtable_free
	push	DWORD PTR _trtable
	call	_sk_pop_free
	add	esp, 8
; Line 250
	mov	DWORD PTR _trtable, edi
	pop	edi
	pop	esi
; Line 251
	ret	0
_X509_TRUST_cleanup ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_add
_TEXT	SEGMENT
_tmp$1 = -24						; size = 24
_id$ = 8						; size = 4
_flags$ = 12						; size = 4
_ck$ = 16						; size = 4
_name$ = 20						; size = 4
_arg1$ = 24						; size = 4
_arg2$ = 28						; size = 4
_X509_TRUST_add PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 180
	mov	eax, 24					; 00000018H
	call	__chkstk
	push	ebx
; Line 186
	mov	ebx, DWORD PTR _flags$[esp+24]
	push	ebp
; Line 157
	mov	ebp, DWORD PTR _id$[esp+28]
; Line 186
	and	ebx, -2					; fffffffeH
	push	esi
; Line 188
	or	ebx, 2
	push	edi
; Line 157
	lea	eax, DWORD PTR [ebp-1]
	cmp	eax, 7
	ja	SHORT $LN12@X509_TRUST
; Line 158
	lea	edi, DWORD PTR [ebp-1]
	jmp	SHORT $LN11@X509_TRUST
$LN12@X509_TRUST:
; Line 160
	mov	eax, DWORD PTR _trtable
	mov	DWORD PTR _tmp$1[esp+40], ebp
	test	eax, eax
	jne	SHORT $LN13@X509_TRUST
; Line 161
	or	edi, -1
	jmp	SHORT $LN20@X509_TRUST
$LN13@X509_TRUST:
; Line 162
	lea	ecx, DWORD PTR _tmp$1[esp+40]
	push	ecx
	push	eax
	call	_sk_find
	add	esp, 8
; Line 163
	cmp	eax, -1
	jne	SHORT $LN14@X509_TRUST
; Line 164
	or	edi, eax
	jmp	SHORT $LN20@X509_TRUST
$LN14@X509_TRUST:
; Line 165
	lea	edi, DWORD PTR [eax+8]
$LN11@X509_TRUST:
; Line 192
	cmp	edi, -1
	jne	SHORT $LN2@X509_TRUST
$LN20@X509_TRUST:
; Line 193
	push	193					; 000000c1H
	push	OFFSET ??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@
	push	24					; 00000018H
	call	_CRYPTO_malloc
	mov	esi, eax
	add	esp, 12					; 0000000cH
	test	esi, esi
	jne	SHORT $LN4@X509_TRUST
; Line 194
	push	194					; 000000c2H
$LN21@X509_TRUST:
	push	OFFSET ??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@
	push	65					; 00000041H
	push	133					; 00000085H
	push	11					; 0000000bH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 195
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 231
	add	esp, 24					; 00000018H
	ret	0
$LN4@X509_TRUST:
; Line 197
	mov	DWORD PTR [esi+4], 1
; Line 198
	jmp	SHORT $LN16@X509_TRUST
$LN2@X509_TRUST:
; Line 146
	test	edi, edi
	jns	SHORT $LN17@X509_TRUST
; Line 147
	xor	esi, esi
	jmp	SHORT $LN16@X509_TRUST
$LN17@X509_TRUST:
; Line 148
	cmp	edi, 8
	jge	SHORT $LN18@X509_TRUST
; Line 149
	lea	eax, DWORD PTR [edi+edi*2]
	lea	esi, DWORD PTR _trstandard[eax*8]
	jmp	SHORT $LN16@X509_TRUST
$LN18@X509_TRUST:
; Line 150
	lea	eax, DWORD PTR [edi-8]
	push	eax
	push	DWORD PTR _trtable
	call	_sk_value
	add	esp, 8
	mov	esi, eax
$LN16@X509_TRUST:
; Line 202
	test	BYTE PTR [esi+4], 2
	je	SHORT $LN5@X509_TRUST
; Line 203
	push	DWORD PTR [esi+12]
	call	_CRYPTO_free
	add	esp, 4
$LN5@X509_TRUST:
; Line 205
	push	DWORD PTR _name$[esp+36]
	call	_BUF_strdup
	add	esp, 4
	mov	DWORD PTR [esi+12], eax
	test	eax, eax
	jne	SHORT $LN6@X509_TRUST
; Line 206
	push	206					; 000000ceH
; Line 207
	jmp	$LN21@X509_TRUST
$LN6@X509_TRUST:
; Line 210
	mov	eax, DWORD PTR [esi+4]
	and	eax, 1
; Line 214
	mov	DWORD PTR [esi], ebp
	or	eax, ebx
	mov	DWORD PTR [esi+4], eax
; Line 215
	mov	eax, DWORD PTR _ck$[esp+36]
	mov	DWORD PTR [esi+8], eax
; Line 216
	mov	eax, DWORD PTR _arg1$[esp+36]
	mov	DWORD PTR [esi+16], eax
; Line 217
	mov	eax, DWORD PTR _arg2$[esp+36]
	mov	DWORD PTR [esi+20], eax
; Line 220
	cmp	edi, -1
	jne	SHORT $LN9@X509_TRUST
; Line 221
	mov	eax, DWORD PTR _trtable
	test	eax, eax
	jne	SHORT $LN8@X509_TRUST
	push	OFFSET _tr_cmp
	call	_sk_new
	add	esp, 4
	mov	DWORD PTR _trtable, eax
	test	eax, eax
	jne	SHORT $LN8@X509_TRUST
; Line 222
	push	222					; 000000deH
; Line 223
	jmp	$LN21@X509_TRUST
$LN8@X509_TRUST:
; Line 225
	push	esi
	push	eax
	call	_sk_push
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN9@X509_TRUST
; Line 226
	push	226					; 000000e2H
; Line 227
	jmp	$LN21@X509_TRUST
$LN9@X509_TRUST:
	pop	edi
	pop	esi
	pop	ebp
; Line 230
	mov	eax, 1
	pop	ebx
; Line 231
	add	esp, 24					; 00000018H
	ret	0
_X509_TRUST_add ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get_by_id
_TEXT	SEGMENT
_tmp$ = -24						; size = 24
_id$ = 8						; size = 4
_X509_TRUST_get_by_id PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 154
	mov	eax, 24					; 00000018H
	call	__chkstk
; Line 157
	mov	ecx, DWORD PTR _id$[esp+20]
	lea	eax, DWORD PTR [ecx-1]
	cmp	eax, 7
	ja	SHORT $LN2@X509_TRUST
; Line 158
	lea	eax, DWORD PTR [ecx-1]
; Line 166
	add	esp, 24					; 00000018H
	ret	0
$LN2@X509_TRUST:
; Line 160
	mov	eax, DWORD PTR _trtable
	mov	DWORD PTR _tmp$[esp+24], ecx
	test	eax, eax
	jne	SHORT $LN3@X509_TRUST
$LN6@X509_TRUST:
; Line 161
	or	eax, -1
; Line 166
	add	esp, 24					; 00000018H
	ret	0
$LN3@X509_TRUST:
; Line 162
	lea	ecx, DWORD PTR _tmp$[esp+24]
	push	ecx
	push	eax
	call	_sk_find
	add	esp, 8
; Line 163
	cmp	eax, -1
	je	SHORT $LN6@X509_TRUST
; Line 165
	add	eax, 8
; Line 166
	add	esp, 24					; 00000018H
	ret	0
_X509_TRUST_get_by_id ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get0
_TEXT	SEGMENT
_idx$ = 8						; size = 4
_X509_TRUST_get0 PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 146
	mov	eax, DWORD PTR _idx$[esp-4]
	test	eax, eax
	jns	SHORT $LN2@X509_TRUST
; Line 147
	xor	eax, eax
; Line 151
	ret	0
$LN2@X509_TRUST:
; Line 148
	cmp	eax, 8
	jge	SHORT $LN3@X509_TRUST
; Line 149
	lea	eax, DWORD PTR [eax+eax*2]
	lea	eax, DWORD PTR _trstandard[eax*8]
; Line 151
	ret	0
$LN3@X509_TRUST:
; Line 150
	add	eax, -8					; fffffff8H
	push	eax
	push	DWORD PTR _trtable
	call	_sk_value
	add	esp, 8
; Line 151
	ret	0
_X509_TRUST_get0 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_get_count
_TEXT	SEGMENT
_X509_TRUST_get_count PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 139
	mov	eax, DWORD PTR _trtable
	test	eax, eax
	jne	SHORT $LN2@X509_TRUST
; Line 140
	mov	eax, 8
; Line 142
	ret	0
$LN2@X509_TRUST:
; Line 141
	push	eax
	call	_sk_num
	add	esp, 4
	add	eax, 8
; Line 142
	ret	0
_X509_TRUST_get_count ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_check_trust
_TEXT	SEGMENT
_tmp$1 = -24						; size = 24
_x$ = 8							; size = 4
_id$ = 12						; size = 4
_flags$ = 16						; size = 4
_X509_check_trust PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 117
	mov	eax, 24					; 00000018H
	call	__chkstk
	push	esi
; Line 120
	mov	esi, DWORD PTR _id$[esp+24]
	cmp	esi, -1
	jne	SHORT $LN2@X509_check
; Line 121
	lea	eax, DWORD PTR [esi+2]
	pop	esi
; Line 135
	add	esp, 24					; 00000018H
	ret	0
$LN2@X509_check:
; Line 123
	test	esi, esi
	jne	SHORT $LN3@X509_check
; Line 125
	push	esi
	mov	esi, DWORD PTR _x$[esp+28]
	push	esi
	push	910					; 0000038eH
	call	_obj_trust
	add	esp, 12					; 0000000cH
; Line 126
	cmp	eax, 3
	jne	$LN1@X509_check
; Line 288
	push	0
	push	-1
	push	esi
	call	_X509_check_purpose
; Line 289
	mov	eax, DWORD PTR [esi+40]
	add	esp, 12					; 0000000cH
	shr	eax, 12					; 0000000cH
	not	eax
	and	eax, 2
	or	eax, 1
	pop	esi
; Line 135
	add	esp, 24					; 00000018H
	ret	0
$LN3@X509_check:
; Line 157
	lea	eax, DWORD PTR [esi-1]
	cmp	eax, 7
	ja	SHORT $LN12@X509_check
; Line 158
	lea	eax, DWORD PTR [esi-1]
	jmp	SHORT $LN11@X509_check
$LN12@X509_check:
; Line 160
	mov	eax, DWORD PTR _trtable
	mov	DWORD PTR _tmp$1[esp+28], esi
	test	eax, eax
	je	SHORT $LN16@X509_check
; Line 162
	lea	ecx, DWORD PTR _tmp$1[esp+28]
	push	ecx
	push	eax
	call	_sk_find
	add	esp, 8
; Line 163
	cmp	eax, -1
	je	SHORT $LN16@X509_check
; Line 165
	add	eax, 8
$LN11@X509_check:
; Line 131
	cmp	eax, -1
	je	SHORT $LN16@X509_check
; Line 133
	push	eax
	call	_X509_TRUST_get0
; Line 134
	push	DWORD PTR _flags$[esp+28]
	push	DWORD PTR _x$[esp+32]
	push	eax
	mov	eax, DWORD PTR [eax+8]
	call	eax
	add	esp, 16					; 00000010H
	pop	esi
; Line 135
	add	esp, 24					; 00000018H
	ret	0
$LN16@X509_check:
; Line 132
	push	DWORD PTR _flags$[esp+24]
	push	DWORD PTR _x$[esp+28]
	push	esi
	call	DWORD PTR _default_trust
	add	esp, 12					; 0000000cH
$LN1@X509_check:
	pop	esi
; Line 135
	add	esp, 24					; 00000018H
	ret	0
_X509_check_trust ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_set
_TEXT	SEGMENT
_tmp$1 = -24						; size = 24
_t$ = 8							; size = 4
_trust$ = 12						; size = 4
_X509_TRUST_set PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 169
	mov	eax, 24					; 00000018H
	call	__chkstk
	push	esi
; Line 157
	mov	esi, DWORD PTR _trust$[esp+24]
	lea	eax, DWORD PTR [esi-1]
	cmp	eax, 7
	ja	SHORT $LN5@X509_TRUST
; Line 158
	lea	eax, DWORD PTR [esi-1]
	jmp	SHORT $LN4@X509_TRUST
$LN5@X509_TRUST:
; Line 160
	mov	eax, DWORD PTR _trtable
	mov	DWORD PTR _tmp$1[esp+28], esi
	test	eax, eax
	je	SHORT $LN9@X509_TRUST
; Line 162
	lea	ecx, DWORD PTR _tmp$1[esp+28]
	push	ecx
	push	eax
	call	_sk_find
	add	esp, 8
; Line 163
	cmp	eax, -1
	je	SHORT $LN9@X509_TRUST
; Line 165
	add	eax, 8
$LN4@X509_TRUST:
; Line 170
	cmp	eax, -1
	je	SHORT $LN9@X509_TRUST
; Line 174
	mov	eax, DWORD PTR _t$[esp+24]
	mov	DWORD PTR [eax], esi
; Line 175
	mov	eax, 1
	pop	esi
; Line 176
	add	esp, 24					; 00000018H
	ret	0
$LN9@X509_TRUST:
; Line 171
	push	171					; 000000abH
	push	OFFSET ??_C@_0BJ@EJNHEKMD@?4?2crypto?2x509?2x509_trs?4c?$AA@
	push	123					; 0000007bH
	push	141					; 0000008dH
	push	11					; 0000000bH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 172
	xor	eax, eax
	pop	esi
; Line 176
	add	esp, 24					; 00000018H
	ret	0
_X509_TRUST_set ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _X509_TRUST_set_default
_TEXT	SEGMENT
_trust$ = 8						; size = 4
_X509_TRUST_set_default PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\x509\x509_trs.c
; Line 111
	mov	eax, DWORD PTR _default_trust
; Line 112
	mov	ecx, DWORD PTR _trust$[esp-4]
	mov	DWORD PTR _default_trust, ecx
; Line 114
	ret	0
_X509_TRUST_set_default ENDP
_TEXT	ENDS
END
