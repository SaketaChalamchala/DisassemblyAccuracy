; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS12_x5092certbag
PUBLIC	_PKCS12_x509crl2certbag
PUBLIC	_PKCS12_certbag2x509
PUBLIC	_PKCS12_certbag2x509crl
PUBLIC	_OPENSSL_asc2uni
PUBLIC	_OPENSSL_uni2asc
PUBLIC	_i2d_PKCS12_bio
PUBLIC	_i2d_PKCS12_fp
PUBLIC	_d2i_PKCS12_bio
PUBLIC	_d2i_PKCS12_fp
PUBLIC	??_C@_0BK@LDALPMGB@?4?2crypto?2pkcs12?2p12_utl?4c?$AA@ ; `string'
EXTRN	_CRYPTO_malloc:PROC
EXTRN	_ASN1_item_d2i_fp:PROC
EXTRN	_ASN1_item_i2d_fp:PROC
EXTRN	_ASN1_item_d2i_bio:PROC
EXTRN	_ASN1_item_i2d_bio:PROC
EXTRN	_ASN1_item_unpack:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_X509_it:PROC
EXTRN	_X509_CRL_it:PROC
EXTRN	_PKCS12_item_pack_safebag:PROC
EXTRN	_PKCS12_it:PROC
;	COMDAT ??_C@_0BK@LDALPMGB@?4?2crypto?2pkcs12?2p12_utl?4c?$AA@
CONST	SEGMENT
??_C@_0BK@LDALPMGB@?4?2crypto?2pkcs12?2p12_utl?4c?$AA@ DB '.\crypto\pkcs1'
	DB	'2\p12_utl.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _d2i_PKCS12_fp
_TEXT	SEGMENT
_fp$ = 8						; size = 4
_p12$ = 12						; size = 4
_d2i_PKCS12_fp PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 127
	push	DWORD PTR _p12$[esp-4]
	push	DWORD PTR _fp$[esp]
	call	_PKCS12_it
	push	eax
	call	_ASN1_item_d2i_fp
	add	esp, 12					; 0000000cH
; Line 128
	ret	0
_d2i_PKCS12_fp ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _d2i_PKCS12_bio
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_p12$ = 12						; size = 4
_d2i_PKCS12_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 121
	push	DWORD PTR _p12$[esp-4]
	push	DWORD PTR _bp$[esp]
	call	_PKCS12_it
	push	eax
	call	_ASN1_item_d2i_bio
	add	esp, 12					; 0000000cH
; Line 122
	ret	0
_d2i_PKCS12_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_PKCS12_fp
_TEXT	SEGMENT
_fp$ = 8						; size = 4
_p12$ = 12						; size = 4
_i2d_PKCS12_fp PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 115
	push	DWORD PTR _p12$[esp-4]
	push	DWORD PTR _fp$[esp]
	call	_PKCS12_it
	push	eax
	call	_ASN1_item_i2d_fp
	add	esp, 12					; 0000000cH
; Line 116
	ret	0
_i2d_PKCS12_fp ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_PKCS12_bio
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_p12$ = 12						; size = 4
_i2d_PKCS12_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 109
	push	DWORD PTR _p12$[esp-4]
	push	DWORD PTR _bp$[esp]
	call	_PKCS12_it
	push	eax
	call	_ASN1_item_i2d_bio
	add	esp, 12					; 0000000cH
; Line 110
	ret	0
_i2d_PKCS12_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OPENSSL_uni2asc
_TEXT	SEGMENT
_uni$ = 8						; size = 4
_unilen$ = 12						; size = 4
_OPENSSL_uni2asc PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 91
	push	ebx
; Line 96
	mov	ebx, DWORD PTR _uni$[esp]
	push	ebp
	push	esi
	push	edi
	mov	edi, DWORD PTR _unilen$[esp+12]
	mov	eax, edi
	cdq
	sub	eax, edx
	mov	ebp, eax
	sar	ebp, 1
	test	edi, edi
	je	SHORT $LN6@OPENSSL_un
	cmp	BYTE PTR [ebx+edi-1], 0
	je	SHORT $LN5@OPENSSL_un
$LN6@OPENSSL_un:
; Line 97
	inc	ebp
$LN5@OPENSSL_un:
; Line 99
	push	99					; 00000063H
	push	OFFSET ??_C@_0BK@LDALPMGB@?4?2crypto?2pkcs12?2p12_utl?4c?$AA@
	push	ebp
	call	_CRYPTO_malloc
	mov	esi, eax
	add	esp, 12					; 0000000cH
	test	esi, esi
	jne	SHORT $LN7@OPENSSL_un
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 105
	ret	0
$LN7@OPENSSL_un:
; Line 101
	xor	edx, edx
	test	edi, edi
	jle	SHORT $LN3@OPENSSL_un
$LL4@OPENSSL_un:
; Line 102
	mov	al, BYTE PTR [edx+ebx+1]
	mov	ecx, edx
	sar	ecx, 1
	add	edx, 2
	mov	BYTE PTR [ecx+esi], al
	cmp	edx, edi
	jl	SHORT $LL4@OPENSSL_un
$LN3@OPENSSL_un:
	pop	edi
; Line 103
	mov	BYTE PTR [esi+ebp-1], 0
; Line 104
	mov	eax, esi
	pop	esi
	pop	ebp
	pop	ebx
; Line 105
	ret	0
_OPENSSL_uni2asc ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OPENSSL_asc2uni
_TEXT	SEGMENT
_asc$ = 8						; size = 4
_asclen$ = 12						; size = 4
_uni$ = 16						; size = 4
_unilen$ = 20						; size = 4
_OPENSSL_asc2uni PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 71
	mov	ecx, DWORD PTR _asclen$[esp-4]
	push	ebx
	mov	ebx, DWORD PTR _asc$[esp]
	push	esi
	cmp	ecx, -1
	jne	SHORT $LN5@OPENSSL_as
; Line 72
	mov	ecx, ebx
	lea	edx, DWORD PTR [ecx+1]
$LL14@OPENSSL_as:
	mov	al, BYTE PTR [ecx]
	inc	ecx
	test	al, al
	jne	SHORT $LL14@OPENSSL_as
	sub	ecx, edx
$LN5@OPENSSL_as:
; Line 74
	push	74					; 0000004aH
	lea	esi, DWORD PTR [ecx*2+2]
	push	OFFSET ??_C@_0BK@LDALPMGB@?4?2crypto?2pkcs12?2p12_utl?4c?$AA@
	push	esi
	call	_CRYPTO_malloc
	mov	edx, eax
	add	esp, 12					; 0000000cH
	test	edx, edx
	jne	SHORT $LN6@OPENSSL_as
	pop	esi
	pop	ebx
; Line 88
	ret	0
$LN6@OPENSSL_as:
	push	edi
; Line 76
	lea	edi, DWORD PTR [esi-2]
	xor	ecx, ecx
	test	edi, edi
	jle	SHORT $LN3@OPENSSL_as
$LL4@OPENSSL_as:
; Line 78
	mov	eax, ecx
	mov	BYTE PTR [edx+ecx], 0
	sar	eax, 1
	mov	al, BYTE PTR [eax+ebx]
	mov	BYTE PTR [edx+ecx+1], al
	add	ecx, 2
	cmp	ecx, edi
	jl	SHORT $LL4@OPENSSL_as
$LN3@OPENSSL_as:
; Line 83
	mov	eax, DWORD PTR _unilen$[esp+8]
	mov	WORD PTR [edx+esi-2], 0
	pop	edi
	test	eax, eax
	je	SHORT $LN7@OPENSSL_as
; Line 84
	mov	DWORD PTR [eax], esi
$LN7@OPENSSL_as:
; Line 85
	mov	eax, DWORD PTR _uni$[esp+4]
	test	eax, eax
	je	SHORT $LN8@OPENSSL_as
; Line 86
	mov	DWORD PTR [eax], edx
$LN8@OPENSSL_as:
	pop	esi
; Line 87
	mov	eax, edx
	pop	ebx
; Line 88
	ret	0
_OPENSSL_asc2uni ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS12_certbag2x509crl
_TEXT	SEGMENT
_bag$ = 8						; size = 4
_PKCS12_certbag2x509crl PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 154
	push	esi
; Line 155
	mov	esi, DWORD PTR _bag$[esp]
	push	DWORD PTR [esi]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 153				; 00000099H
	je	SHORT $LN2@PKCS12_cer
$LN5@PKCS12_cer:
; Line 156
	xor	eax, eax
	pop	esi
; Line 161
	ret	0
$LN2@PKCS12_cer:
; Line 157
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 160				; 000000a0H
	jne	SHORT $LN5@PKCS12_cer
; Line 159
	call	_X509_CRL_it
	push	eax
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax+4]
	call	_ASN1_item_unpack
	add	esp, 8
	pop	esi
; Line 161
	ret	0
_PKCS12_certbag2x509crl ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS12_certbag2x509
_TEXT	SEGMENT
_bag$ = 8						; size = 4
_PKCS12_certbag2x509 PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 144
	push	esi
; Line 145
	mov	esi, DWORD PTR _bag$[esp]
	push	DWORD PTR [esi]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 152				; 00000098H
	je	SHORT $LN2@PKCS12_cer
$LN5@PKCS12_cer:
; Line 146
	xor	eax, eax
	pop	esi
; Line 151
	ret	0
$LN2@PKCS12_cer:
; Line 147
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 158				; 0000009eH
	jne	SHORT $LN5@PKCS12_cer
; Line 149
	call	_X509_it
	push	eax
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax+4]
	call	_ASN1_item_unpack
	add	esp, 8
	pop	esi
; Line 151
	ret	0
_PKCS12_certbag2x509 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS12_x509crl2certbag
_TEXT	SEGMENT
_crl$ = 8						; size = 4
_PKCS12_x509crl2certbag PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 139
	push	153					; 00000099H
	push	160					; 000000a0H
	call	_X509_CRL_it
	push	eax
	push	DWORD PTR _crl$[esp+8]
	call	_PKCS12_item_pack_safebag
	add	esp, 16					; 00000010H
; Line 141
	ret	0
_PKCS12_x509crl2certbag ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS12_x5092certbag
_TEXT	SEGMENT
_x509$ = 8						; size = 4
_PKCS12_x5092certbag PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_utl.c
; Line 133
	push	152					; 00000098H
	push	158					; 0000009eH
	call	_X509_it
	push	eax
	push	DWORD PTR _x509$[esp+8]
	call	_PKCS12_item_pack_safebag
	add	esp, 16					; 00000010H
; Line 135
	ret	0
_PKCS12_x5092certbag ENDP
_TEXT	ENDS
END
