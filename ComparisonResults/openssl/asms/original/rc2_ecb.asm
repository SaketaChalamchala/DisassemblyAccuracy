; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\rc2\rc2_ecb.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_RC2_version
CONST	SEGMENT
_RC2_version DB	'RC2 part of OpenSSL 1.0.2h  3 May 2016', 00H
CONST	ENDS
PUBLIC	_RC2_ecb_encrypt
EXTRN	_RC2_encrypt:PROC
EXTRN	_RC2_decrypt:PROC
EXTRN	__chkstk:PROC
; Function compile flags: /Ogtpy
;	COMDAT _RC2_ecb_encrypt
_TEXT	SEGMENT
_d$ = -8						; size = 8
_in$ = 8						; size = 4
_out$ = 12						; size = 4
_ks$ = 16						; size = 4
_encrypt$ = 20						; size = 4
_RC2_ecb_encrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\rc2\rc2_ecb.c
; Line 76
	mov	eax, 8
	call	__chkstk
	push	esi
; Line 79
	mov	esi, DWORD PTR _in$[esp+8]
	movzx	eax, BYTE PTR [esi+1]
	movzx	ecx, BYTE PTR [esi]
; Line 81
	movzx	edx, BYTE PTR [esi+4]
	shl	eax, 8
	or	ecx, eax
	movzx	eax, BYTE PTR [esi+2]
	shl	eax, 16					; 00000010H
	or	ecx, eax
	movzx	eax, BYTE PTR [esi+3]
	shl	eax, 24					; 00000018H
	or	ecx, eax
	movzx	eax, BYTE PTR [esi+5]
	mov	DWORD PTR _d$[esp+12], ecx
	movzx	ecx, BYTE PTR [esi+7]
	shl	eax, 8
	or	edx, eax
; Line 82
	shl	ecx, 8
	movzx	eax, BYTE PTR [esi+6]
	or	ecx, eax
; Line 84
	lea	eax, DWORD PTR _d$[esp+12]
	pop	esi
	push	DWORD PTR _ks$[esp+4]
	shl	ecx, 16					; 00000010H
	or	ecx, edx
	cmp	DWORD PTR _encrypt$[esp+8], 0
	mov	DWORD PTR _d$[esp+16], ecx
	push	eax
	je	SHORT $LN2@RC2_ecb_en
	call	_RC2_encrypt
	jmp	SHORT $LN5@RC2_ecb_en
$LN2@RC2_ecb_en:
; Line 86
	call	_RC2_decrypt
$LN5@RC2_ecb_en:
; Line 88
	mov	edx, DWORD PTR _out$[esp+12]
	add	esp, 8
	mov	ecx, DWORD PTR _d$[esp+8]
	mov	eax, ecx
	shr	eax, 8
	mov	BYTE PTR [edx], cl
	mov	BYTE PTR [edx+1], al
	mov	eax, ecx
	shr	eax, 16					; 00000010H
	mov	BYTE PTR [edx+2], al
	shr	ecx, 24					; 00000018H
	mov	BYTE PTR [edx+3], cl
; Line 90
	mov	ecx, DWORD PTR _d$[esp+12]
	mov	eax, ecx
	shr	eax, 8
	mov	BYTE PTR [edx+4], cl
	mov	BYTE PTR [edx+5], al
	mov	eax, ecx
	shr	eax, 16					; 00000010H
	shr	ecx, 24					; 00000018H
	mov	BYTE PTR [edx+6], al
	mov	BYTE PTR [edx+7], cl
; Line 92
	add	esp, 8
	ret	0
_RC2_ecb_encrypt ENDP
_TEXT	ENDS
END
