; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\evp\p5_crpt.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS5_PBE_keyivgen
PUBLIC	_PKCS5_PBE_add
PUBLIC	??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@ ; `string'
PUBLIC	??_C@_0DF@FHOHFFEB@EVP_CIPHER_key_length?$CIcipher?$CJ?5?$DM?$DN@ ; `string'
PUBLIC	??_C@_0CD@HMFJNEFL@EVP_CIPHER_iv_length?$CIcipher?$CJ?5?$DM?$DN?5@ ; `string'
EXTRN	_OPENSSL_cleanse:PROC
EXTRN	_OpenSSLDie:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_INTEGER_get:PROC
EXTRN	_EVP_MD_size:PROC
EXTRN	_EVP_CIPHER_key_length:PROC
EXTRN	_EVP_CIPHER_iv_length:PROC
EXTRN	_EVP_MD_CTX_init:PROC
EXTRN	_EVP_MD_CTX_cleanup:PROC
EXTRN	_EVP_DigestInit_ex:PROC
EXTRN	_EVP_DigestUpdate:PROC
EXTRN	_EVP_DigestFinal_ex:PROC
EXTRN	_EVP_CipherInit_ex:PROC
EXTRN	_PBEPARAM_free:PROC
EXTRN	_d2i_PBEPARAM:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	_memcpy:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0CD@HMFJNEFL@EVP_CIPHER_iv_length?$CIcipher?$CJ?5?$DM?$DN?5@
CONST	SEGMENT
??_C@_0CD@HMFJNEFL@EVP_CIPHER_iv_length?$CIcipher?$CJ?5?$DM?$DN?5@ DB 'EV'
	DB	'P_CIPHER_iv_length(cipher) <= 16', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0DF@FHOHFFEB@EVP_CIPHER_key_length?$CIcipher?$CJ?5?$DM?$DN@
CONST	SEGMENT
??_C@_0DF@FHOHFFEB@EVP_CIPHER_key_length?$CIcipher?$CJ?5?$DM?$DN@ DB 'EVP'
	DB	'_CIPHER_key_length(cipher) <= (int)sizeof(md_tmp)', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@
CONST	SEGMENT
??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@ DB '.\crypto\evp\p5_c'
	DB	'rpt.c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS5_PBE_add
_TEXT	SEGMENT
_PKCS5_PBE_add PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\p5_crpt.c
; Line 72
	ret	0
_PKCS5_PBE_add ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS5_PBE_keyivgen
_TEXT	SEGMENT
_pass$GSCopy$1$ = -200					; size = 4
_rv$1$ = -196						; size = 4
_pbuf$ = -192						; size = 4
_saltlen$1$ = -188					; size = 4
_salt$1$ = -184						; size = 4
_cipher$GSCopy$1$ = -180				; size = 4
_cctx$GSCopy$1$ = -176					; size = 4
_ctx$ = -172						; size = 24
_iv$ = -148						; size = 16
_md_tmp$ = -132						; size = 64
_key$ = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_cctx$ = 8						; size = 4
_pass$ = 12						; size = 4
_passlen$ = 16						; size = 4
_param$ = 20						; size = 4
_cipher$ = 24						; size = 4
_md$ = 28						; size = 4
_en_de$ = 32						; size = 4
_PKCS5_PBE_keyivgen PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\p5_crpt.c
; Line 77
	mov	eax, 200				; 000000c8H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+200], eax
	mov	eax, DWORD PTR _cctx$[esp+196]
	mov	DWORD PTR _cctx$GSCopy$1$[esp+200], eax
	mov	eax, DWORD PTR _pass$[esp+196]
	mov	DWORD PTR _pass$GSCopy$1$[esp+200], eax
	mov	eax, DWORD PTR _cipher$[esp+196]
	push	ebp
	mov	ebp, DWORD PTR _md$[esp+200]
	mov	DWORD PTR _cipher$GSCopy$1$[esp+204], eax
; Line 88
	lea	eax, DWORD PTR _ctx$[esp+204]
	push	esi
	mov	esi, DWORD PTR _param$[esp+204]
	push	eax
	mov	DWORD PTR _rv$1$[esp+212], 0
	call	_EVP_MD_CTX_init
	add	esp, 4
; Line 91
	test	esi, esi
	je	$LN6@PKCS5_PBE_
	cmp	DWORD PTR [esi], 16			; 00000010H
	jne	$LN6@PKCS5_PBE_
	mov	ecx, DWORD PTR [esi+4]
	test	ecx, ecx
	je	$LN6@PKCS5_PBE_
; Line 97
	mov	eax, DWORD PTR [ecx+8]
	push	edi
	mov	DWORD PTR _pbuf$[esp+212], eax
; Line 98
	lea	eax, DWORD PTR _pbuf$[esp+212]
	push	DWORD PTR [ecx]
	push	eax
	push	0
	call	_d2i_PBEPARAM
	mov	edi, eax
	add	esp, 12					; 0000000cH
	test	edi, edi
	jne	SHORT $LN7@PKCS5_PBE_
; Line 99
	push	99					; 00000063H
	push	OFFSET ??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@
	push	114					; 00000072H
	push	117					; 00000075H
	push	6
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 100
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
; Line 149
	mov	ecx, DWORD PTR __$ArrayPad$[esp+200]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 200				; 000000c8H
	ret	0
$LN7@PKCS5_PBE_:
; Line 103
	mov	eax, DWORD PTR [edi+4]
	push	ebx
	test	eax, eax
	jne	SHORT $LN8@PKCS5_PBE_
; Line 104
	lea	ebx, DWORD PTR [eax+1]
	jmp	SHORT $LN9@PKCS5_PBE_
$LN8@PKCS5_PBE_:
; Line 106
	push	eax
	call	_ASN1_INTEGER_get
	add	esp, 4
	mov	ebx, eax
$LN9@PKCS5_PBE_:
; Line 107
	mov	eax, DWORD PTR [edi]
	mov	ecx, DWORD PTR [eax+8]
; Line 108
	mov	eax, DWORD PTR [eax]
	mov	DWORD PTR _saltlen$1$[esp+216], eax
; Line 110
	mov	eax, DWORD PTR _pass$GSCopy$1$[esp+216]
	mov	DWORD PTR _salt$1$[esp+216], ecx
	test	eax, eax
	jne	SHORT $LN10@PKCS5_PBE_
; Line 111
	xor	esi, esi
	jmp	SHORT $LN12@PKCS5_PBE_
$LN10@PKCS5_PBE_:
; Line 112
	mov	esi, DWORD PTR _passlen$[esp+212]
	cmp	esi, -1
	jne	SHORT $LN12@PKCS5_PBE_
; Line 113
	mov	esi, eax
	lea	ecx, DWORD PTR [esi+1]
	npad	5
$LL34@PKCS5_PBE_:
	mov	al, BYTE PTR [esi]
	inc	esi
	test	al, al
	jne	SHORT $LL34@PKCS5_PBE_
	sub	esi, ecx
$LN12@PKCS5_PBE_:
; Line 115
	push	0
	lea	eax, DWORD PTR _ctx$[esp+220]
	push	ebp
	push	eax
	call	_EVP_DigestInit_ex
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 117
	mov	eax, DWORD PTR _pass$GSCopy$1$[esp+216]
	push	esi
	push	eax
	lea	eax, DWORD PTR _ctx$[esp+224]
	push	eax
	call	_EVP_DigestUpdate
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 119
	push	DWORD PTR _saltlen$1$[esp+216]
	lea	eax, DWORD PTR _ctx$[esp+220]
	push	DWORD PTR _salt$1$[esp+220]
	push	eax
	call	_EVP_DigestUpdate
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 121
	push	edi
	call	_PBEPARAM_free
; Line 122
	push	0
	lea	eax, DWORD PTR _md_tmp$[esp+224]
	push	eax
	lea	eax, DWORD PTR _ctx$[esp+228]
	push	eax
	call	_EVP_DigestFinal_ex
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$err$38
; Line 124
	push	ebp
	call	_EVP_MD_size
	mov	edi, eax
	add	esp, 4
; Line 125
	test	edi, edi
	jns	SHORT $LN17@PKCS5_PBE_
; Line 126
	xor	eax, eax
$LN36@PKCS5_PBE_:
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp
; Line 149
	mov	ecx, DWORD PTR __$ArrayPad$[esp+200]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 200				; 000000c8H
	ret	0
$LN17@PKCS5_PBE_:
; Line 127
	mov	esi, 1
	cmp	ebx, esi
	jle	SHORT $LN3@PKCS5_PBE_
	npad	2
$LL4@PKCS5_PBE_:
; Line 128
	push	0
	lea	eax, DWORD PTR _ctx$[esp+220]
	push	ebp
	push	eax
	call	_EVP_DigestInit_ex
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 130
	push	edi
	lea	eax, DWORD PTR _md_tmp$[esp+220]
	push	eax
	lea	eax, DWORD PTR _ctx$[esp+224]
	push	eax
	call	_EVP_DigestUpdate
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 132
	push	0
	lea	eax, DWORD PTR _md_tmp$[esp+220]
	push	eax
	lea	eax, DWORD PTR _ctx$[esp+224]
	push	eax
	call	_EVP_DigestFinal_ex
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$38
; Line 127
	inc	esi
	cmp	esi, ebx
	jl	SHORT $LL4@PKCS5_PBE_
$LN3@PKCS5_PBE_:
; Line 135
	mov	ebx, DWORD PTR _cipher$GSCopy$1$[esp+216]
	push	ebx
	call	_EVP_CIPHER_key_length
	add	esp, 4
	cmp	eax, 64					; 00000040H
	jle	SHORT $LN24@PKCS5_PBE_
	push	OFFSET ??_C@_0DF@FHOHFFEB@EVP_CIPHER_key_length?$CIcipher?$CJ?5?$DM?$DN@
	push	135					; 00000087H
	push	OFFSET ??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@
	call	_OpenSSLDie
	add	esp, 12					; 0000000cH
$LN24@PKCS5_PBE_:
; Line 136
	push	ebx
	call	_EVP_CIPHER_key_length
	push	eax
	lea	eax, DWORD PTR _md_tmp$[esp+224]
	push	eax
	lea	eax, DWORD PTR _key$[esp+228]
	push	eax
	call	_memcpy
; Line 137
	push	ebx
	call	_EVP_CIPHER_iv_length
	add	esp, 20					; 00000014H
	cmp	eax, 16					; 00000010H
	jle	SHORT $LN26@PKCS5_PBE_
	push	OFFSET ??_C@_0CD@HMFJNEFL@EVP_CIPHER_iv_length?$CIcipher?$CJ?5?$DM?$DN?5@
	push	137					; 00000089H
	push	OFFSET ??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@
	call	_OpenSSLDie
	add	esp, 12					; 0000000cH
$LN26@PKCS5_PBE_:
; Line 138
	push	ebx
	call	_EVP_CIPHER_iv_length
	add	esp, 4
	push	eax
	push	ebx
	call	_EVP_CIPHER_iv_length
	add	esp, 4
	lea	ecx, DWORD PTR _md_tmp$[esp+236]
	sub	ecx, eax
	lea	eax, DWORD PTR _iv$[esp+220]
	push	ecx
	push	eax
	call	_memcpy
; Line 140
	push	DWORD PTR _en_de$[esp+224]
	lea	eax, DWORD PTR _iv$[esp+232]
	push	eax
	lea	eax, DWORD PTR _key$[esp+236]
	push	eax
	push	0
	push	ebx
	push	DWORD PTR _cctx$GSCopy$1$[esp+248]
	call	_EVP_CipherInit_ex
	add	esp, 36					; 00000024H
	test	eax, eax
	je	SHORT $err$38
; Line 142
	lea	eax, DWORD PTR _md_tmp$[esp+216]
	push	64					; 00000040H
	push	eax
	call	_OPENSSL_cleanse
; Line 143
	lea	eax, DWORD PTR _key$[esp+224]
	push	64					; 00000040H
	push	eax
	call	_OPENSSL_cleanse
; Line 144
	lea	eax, DWORD PTR _iv$[esp+232]
	push	16					; 00000010H
	push	eax
	call	_OPENSSL_cleanse
	add	esp, 24					; 00000018H
; Line 145
	mov	DWORD PTR _rv$1$[esp+216], 1
$err$38:
; Line 147
	lea	eax, DWORD PTR _ctx$[esp+216]
	push	eax
	call	_EVP_MD_CTX_cleanup
; Line 148
	mov	eax, DWORD PTR _rv$1$[esp+220]
	add	esp, 4
	jmp	$LN36@PKCS5_PBE_
$LN6@PKCS5_PBE_:
; Line 93
	push	93					; 0000005dH
	push	OFFSET ??_C@_0BH@DKGHAIKO@?4?2crypto?2evp?2p5_crpt?4c?$AA@
	push	114					; 00000072H
	push	117					; 00000075H
	push	6
	call	_ERR_put_error
; Line 149
	mov	ecx, DWORD PTR __$ArrayPad$[esp+228]
	add	esp, 20					; 00000014H
	xor	eax, eax
	pop	esi
	pop	ebp
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 200				; 000000c8H
	ret	0
_PKCS5_PBE_keyivgen ENDP
_TEXT	ENDS
END
