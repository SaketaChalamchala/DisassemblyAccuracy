; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\evp\e_xcbc_d.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

EXTRN	_EVP_CIPHER_set_asn1_iv:PROC
EXTRN	_EVP_CIPHER_get_asn1_iv:PROC
CONST	SEGMENT
_d_xcbc_cipher DD 050H
	DD	08H
	DD	018H
	DD	08H
	DD	02H
	DD	FLAT:_desx_cbc_init_key
	DD	FLAT:_desx_cbc_cipher
	DD	00H
	DD	090H
	DD	FLAT:_EVP_CIPHER_set_asn1_iv
	DD	FLAT:_EVP_CIPHER_get_asn1_iv
	DD	00H
	DD	00H
CONST	ENDS
PUBLIC	_EVP_desx_cbc
EXTRN	_DES_xcbc_encrypt:PROC
EXTRN	_DES_set_key_unchecked:PROC
; Function compile flags: /Ogtpy
;	COMDAT _desx_cbc_cipher
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_out$ = 12						; size = 4
_in$ = 16						; size = 4
tv181 = 20						; size = 4
_inl$ = 20						; size = 4
_desx_cbc_cipher PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\e_xcbc_d.c
; Line 115
	push	ebx
; Line 116
	mov	ebx, DWORD PTR _out$[esp]
	push	ebp
	mov	ebp, DWORD PTR _ctx$[esp+4]
	push	esi
	mov	esi, DWORD PTR _inl$[esp+8]
	push	edi
	mov	edi, DWORD PTR _in$[esp+12]
	cmp	esi, 1073741824				; 40000000H
	jb	SHORT $LN3@desx_cbc_c
	mov	eax, esi
	lea	edx, DWORD PTR [ebp+32]
	shr	eax, 30					; 0000001eH
	mov	DWORD PTR tv181[esp+12], eax
	npad	8
$LL2@desx_cbc_c:
; Line 117
	mov	ecx, DWORD PTR [ebp+96]
	push	DWORD PTR [ebp+8]
	lea	eax, DWORD PTR [ecx+136]
	push	eax
	lea	eax, DWORD PTR [ecx+128]
	push	eax
	push	edx
	push	ecx
	push	1073741824				; 40000000H
	push	ebx
	push	edi
	call	_DES_xcbc_encrypt
	add	esp, 32					; 00000020H
	lea	edx, DWORD PTR [ebp+32]
; Line 120
	sub	esi, 1073741824				; 40000000H
; Line 121
	add	edi, 1073741824				; 40000000H
; Line 122
	add	ebx, 1073741824				; 40000000H
	sub	DWORD PTR tv181[esp+12], 1
	jne	SHORT $LL2@desx_cbc_c
$LN3@desx_cbc_c:
; Line 124
	test	esi, esi
	je	SHORT $LN10@desx_cbc_c
; Line 125
	mov	ecx, DWORD PTR [ebp+96]
	push	DWORD PTR [ebp+8]
	lea	eax, DWORD PTR [ecx+136]
	push	eax
	lea	eax, DWORD PTR [ecx+128]
	push	eax
	lea	eax, DWORD PTR [ebp+32]
	push	eax
	push	ecx
	push	esi
	push	ebx
	push	edi
	call	_DES_xcbc_encrypt
	add	esp, 32					; 00000020H
$LN10@desx_cbc_c:
; Line 128
	pop	edi
	pop	esi
	pop	ebp
	mov	eax, 1
	pop	ebx
; Line 129
	ret	0
_desx_cbc_cipher ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _desx_cbc_init_key
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_key$ = 12						; size = 4
_iv$ = 16						; size = 4
_enc$ = 20						; size = 4
_desx_cbc_init_key PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\e_xcbc_d.c
; Line 103
	push	esi
; Line 106
	mov	esi, DWORD PTR _key$[esp]
	push	edi
	mov	edi, DWORD PTR _ctx$[esp+4]
	push	DWORD PTR [edi+96]
	push	esi
	call	_DES_set_key_unchecked
; Line 107
	mov	ecx, DWORD PTR [edi+96]
	add	esp, 8
	mov	eax, DWORD PTR [esi+8]
	mov	DWORD PTR [ecx+128], eax
	mov	eax, DWORD PTR [esi+12]
	mov	DWORD PTR [ecx+132], eax
; Line 108
	mov	ecx, DWORD PTR [edi+96]
	mov	eax, DWORD PTR [esi+16]
	pop	edi
	mov	DWORD PTR [ecx+136], eax
	mov	eax, DWORD PTR [esi+20]
	mov	DWORD PTR [ecx+140], eax
; Line 110
	mov	eax, 1
	pop	esi
; Line 111
	ret	0
_desx_cbc_init_key ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _EVP_desx_cbc
_TEXT	SEGMENT
_EVP_desx_cbc PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\e_xcbc_d.c
; Line 98
	mov	eax, OFFSET _d_xcbc_cipher
; Line 99
	ret	0
_EVP_desx_cbc ENDP
_TEXT	ENDS
END
