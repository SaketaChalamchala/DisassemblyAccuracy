; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_ec_GFp_nist_group_copy
PUBLIC	_ec_GFp_nist_group_set_curve
PUBLIC	_ec_GFp_nist_field_mul
PUBLIC	_ec_GFp_nist_field_sqr
EXTRN	_ec_GFp_simple_group_init:PROC
EXTRN	_ec_GFp_simple_group_finish:PROC
EXTRN	_ec_GFp_simple_group_clear_finish:PROC
EXTRN	_ec_GFp_simple_group_get_curve:PROC
EXTRN	_ec_GFp_simple_group_get_degree:PROC
EXTRN	_ec_GFp_simple_group_check_discriminant:PROC
EXTRN	_ec_GFp_simple_point_init:PROC
EXTRN	_ec_GFp_simple_point_finish:PROC
EXTRN	_ec_GFp_simple_point_clear_finish:PROC
EXTRN	_ec_GFp_simple_point_copy:PROC
EXTRN	_ec_GFp_simple_point_set_to_infinity:PROC
EXTRN	_ec_GFp_simple_set_Jprojective_coordinates_GFp:PROC
EXTRN	_ec_GFp_simple_get_Jprojective_coordinates_GFp:PROC
EXTRN	_ec_GFp_simple_point_set_affine_coordinates:PROC
EXTRN	_ec_GFp_simple_point_get_affine_coordinates:PROC
EXTRN	_ec_GFp_simple_add:PROC
EXTRN	_ec_GFp_simple_dbl:PROC
EXTRN	_ec_GFp_simple_invert:PROC
EXTRN	_ec_GFp_simple_is_at_infinity:PROC
EXTRN	_ec_GFp_simple_is_on_curve:PROC
EXTRN	_ec_GFp_simple_cmp:PROC
EXTRN	_ec_GFp_simple_make_affine:PROC
EXTRN	_ec_GFp_simple_points_make_affine:PROC
CONST	SEGMENT
?ret@?1??EC_GFp_nist_method@@9@9 DD 01H			; `EC_GFp_nist_method'::`2'::ret
	DD	0196H
	DD	FLAT:_ec_GFp_simple_group_init
	DD	FLAT:_ec_GFp_simple_group_finish
	DD	FLAT:_ec_GFp_simple_group_clear_finish
	DD	FLAT:_ec_GFp_nist_group_copy
	DD	FLAT:_ec_GFp_nist_group_set_curve
	DD	FLAT:_ec_GFp_simple_group_get_curve
	DD	FLAT:_ec_GFp_simple_group_get_degree
	DD	FLAT:_ec_GFp_simple_group_check_discriminant
	DD	FLAT:_ec_GFp_simple_point_init
	DD	FLAT:_ec_GFp_simple_point_finish
	DD	FLAT:_ec_GFp_simple_point_clear_finish
	DD	FLAT:_ec_GFp_simple_point_copy
	DD	FLAT:_ec_GFp_simple_point_set_to_infinity
	DD	FLAT:_ec_GFp_simple_set_Jprojective_coordinates_GFp
	DD	FLAT:_ec_GFp_simple_get_Jprojective_coordinates_GFp
	DD	FLAT:_ec_GFp_simple_point_set_affine_coordinates
	DD	FLAT:_ec_GFp_simple_point_get_affine_coordinates
	DD	00H
	DD	00H
	DD	00H
	DD	FLAT:_ec_GFp_simple_add
	DD	FLAT:_ec_GFp_simple_dbl
	DD	FLAT:_ec_GFp_simple_invert
	DD	FLAT:_ec_GFp_simple_is_at_infinity
	DD	FLAT:_ec_GFp_simple_is_on_curve
	DD	FLAT:_ec_GFp_simple_cmp
	DD	FLAT:_ec_GFp_simple_make_affine
	DD	FLAT:_ec_GFp_simple_points_make_affine
	DD	00H
	DD	00H
	DD	00H
	DD	FLAT:_ec_GFp_nist_field_mul
	DD	FLAT:_ec_GFp_nist_field_sqr
	DD	00H
	DD	00H
	DD	00H
	DD	00H
CONST	ENDS
PUBLIC	_EC_GFp_nist_method
PUBLIC	??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@ ; `string'
EXTRN	_ERR_put_error:PROC
EXTRN	_BN_CTX_new:PROC
EXTRN	_BN_CTX_free:PROC
EXTRN	_BN_CTX_start:PROC
EXTRN	_BN_CTX_get:PROC
EXTRN	_BN_CTX_end:PROC
EXTRN	_BN_mul:PROC
EXTRN	_BN_sqr:PROC
EXTRN	_BN_ucmp:PROC
EXTRN	_BN_nist_mod_192:PROC
EXTRN	_BN_nist_mod_224:PROC
EXTRN	_BN_nist_mod_256:PROC
EXTRN	_BN_nist_mod_384:PROC
EXTRN	_BN_nist_mod_521:PROC
EXTRN	_BN_get0_nist_prime_192:PROC
EXTRN	_BN_get0_nist_prime_224:PROC
EXTRN	_BN_get0_nist_prime_256:PROC
EXTRN	_BN_get0_nist_prime_384:PROC
EXTRN	_BN_get0_nist_prime_521:PROC
EXTRN	_ec_GFp_simple_group_copy:PROC
EXTRN	_ec_GFp_simple_group_set_curve:PROC
;	COMDAT ??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@
CONST	SEGMENT
??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@ DB '.\crypto\ec\ecp_n'
	DB	'ist.c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ec_GFp_nist_field_sqr
_TEXT	SEGMENT
_group$ = 8						; size = 4
_r$ = 12						; size = 4
_a$ = 16						; size = 4
_ctx$ = 20						; size = 4
_ec_GFp_nist_field_sqr PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
; Line 198
	push	ebx
	push	ebp
	push	esi
; Line 200
	xor	ebx, ebx
	xor	esi, esi
; Line 202
	cmp	DWORD PTR _group$[esp+8], ebx
	je	SHORT $LN3@ec_GFp_nis
	mov	ebp, DWORD PTR _r$[esp+8]
	test	ebp, ebp
	je	SHORT $LN3@ec_GFp_nis
	mov	eax, DWORD PTR _a$[esp+8]
	test	eax, eax
	je	SHORT $LN3@ec_GFp_nis
; Line 206
	push	edi
	mov	edi, DWORD PTR _ctx$[esp+12]
	test	edi, edi
	jne	SHORT $LN5@ec_GFp_nis
; Line 207
	call	_BN_CTX_new
	mov	edi, eax
	mov	ebx, edi
	test	edi, edi
	je	SHORT $LN10@ec_GFp_nis
	mov	eax, DWORD PTR _a$[esp+12]
$LN5@ec_GFp_nis:
; Line 210
	push	edi
	push	eax
	push	ebp
	call	_BN_sqr
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$15
; Line 212
	mov	ecx, DWORD PTR _group$[esp+12]
	push	edi
	lea	eax, DWORD PTR [ecx+72]
	push	eax
	mov	eax, DWORD PTR [ecx+168]
	push	ebp
	push	ebp
	call	eax
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$15
; Line 215
	mov	esi, 1
$err$15:
; Line 217
	test	ebx, ebx
	je	SHORT $LN10@ec_GFp_nis
; Line 218
	push	ebx
	call	_BN_CTX_free
	add	esp, 4
$LN10@ec_GFp_nis:
; Line 219
	pop	edi
	mov	eax, esi
	pop	esi
	pop	ebp
	pop	ebx
; Line 220
	ret	0
$LN3@ec_GFp_nis:
; Line 203
	push	203					; 000000cbH
	push	OFFSET ??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@
	push	134					; 00000086H
	push	201					; 000000c9H
	push	16					; 00000010H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 219
	mov	eax, esi
	pop	esi
	pop	ebp
	pop	ebx
; Line 220
	ret	0
_ec_GFp_nist_field_sqr ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ec_GFp_nist_field_mul
_TEXT	SEGMENT
_group$ = 8						; size = 4
_r$ = 12						; size = 4
_a$ = 16						; size = 4
_b$ = 20						; size = 4
_ctx$ = 24						; size = 4
_ec_GFp_nist_field_mul PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
; Line 172
	push	ebx
	push	ebp
	push	esi
; Line 174
	xor	ebx, ebx
	xor	esi, esi
; Line 176
	cmp	DWORD PTR _group$[esp+8], ebx
	je	SHORT $LN3@ec_GFp_nis
	mov	ebp, DWORD PTR _r$[esp+8]
	test	ebp, ebp
	je	SHORT $LN3@ec_GFp_nis
	mov	eax, DWORD PTR _a$[esp+8]
	test	eax, eax
	je	SHORT $LN3@ec_GFp_nis
	mov	ecx, DWORD PTR _b$[esp+8]
	test	ecx, ecx
	je	SHORT $LN3@ec_GFp_nis
; Line 180
	push	edi
	mov	edi, DWORD PTR _ctx$[esp+12]
	test	edi, edi
	jne	SHORT $LN5@ec_GFp_nis
; Line 181
	call	_BN_CTX_new
	mov	edi, eax
	mov	ebx, edi
	test	edi, edi
	je	SHORT $LN10@ec_GFp_nis
	mov	eax, DWORD PTR _a$[esp+12]
	mov	ecx, DWORD PTR _b$[esp+12]
$LN5@ec_GFp_nis:
; Line 184
	push	edi
	push	ecx
	push	eax
	push	ebp
	call	_BN_mul
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$15
; Line 186
	mov	ecx, DWORD PTR _group$[esp+12]
	push	edi
	lea	eax, DWORD PTR [ecx+72]
	push	eax
	mov	eax, DWORD PTR [ecx+168]
	push	ebp
	push	ebp
	call	eax
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$15
; Line 189
	mov	esi, 1
$err$15:
; Line 191
	test	ebx, ebx
	je	SHORT $LN10@ec_GFp_nis
; Line 192
	push	ebx
	call	_BN_CTX_free
	add	esp, 4
$LN10@ec_GFp_nis:
; Line 193
	pop	edi
	mov	eax, esi
	pop	esi
	pop	ebp
	pop	ebx
; Line 194
	ret	0
$LN3@ec_GFp_nis:
; Line 177
	push	177					; 000000b1H
	push	OFFSET ??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@
	push	67					; 00000043H
	push	200					; 000000c8H
	push	16					; 00000010H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 193
	mov	eax, esi
	pop	esi
	pop	ebp
	pop	ebx
; Line 194
	ret	0
_ec_GFp_nist_field_mul ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ec_GFp_nist_group_set_curve
_TEXT	SEGMENT
_group$ = 8						; size = 4
_p$ = 12						; size = 4
_a$ = 16						; size = 4
_b$ = 20						; size = 4
_ctx$ = 24						; size = 4
_ec_GFp_nist_group_set_curve PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
; Line 133
	push	ebp
	push	esi
; Line 138
	mov	esi, DWORD PTR _ctx$[esp+4]
	xor	ebp, ebp
	push	edi
	xor	edi, edi
	test	esi, esi
	jne	SHORT $LN3@ec_GFp_nis
; Line 139
	call	_BN_CTX_new
	mov	edi, eax
	mov	esi, edi
	test	edi, edi
	jne	SHORT $LN3@ec_GFp_nis
	pop	edi
	pop	esi
	pop	ebp
; Line 168
	ret	0
$LN3@ec_GFp_nis:
; Line 142
	push	esi
	call	_BN_CTX_start
; Line 143
	push	esi
	call	_BN_CTX_get
	add	esp, 8
	test	eax, eax
	je	$err$20
; Line 146
	push	ebx
	mov	ebx, DWORD PTR _p$[esp+12]
	push	ebx
	call	_BN_get0_nist_prime_192
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN5@ec_GFp_nis
; Line 147
	mov	eax, DWORD PTR _group$[esp+12]
	mov	DWORD PTR [eax+168], OFFSET _BN_nist_mod_192
	jmp	$LN14@ec_GFp_nis
$LN5@ec_GFp_nis:
; Line 148
	push	ebx
	call	_BN_get0_nist_prime_224
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN7@ec_GFp_nis
; Line 149
	mov	eax, DWORD PTR _group$[esp+12]
	mov	DWORD PTR [eax+168], OFFSET _BN_nist_mod_224
	jmp	SHORT $LN14@ec_GFp_nis
$LN7@ec_GFp_nis:
; Line 150
	push	ebx
	call	_BN_get0_nist_prime_256
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN9@ec_GFp_nis
; Line 151
	mov	eax, DWORD PTR _group$[esp+12]
	mov	DWORD PTR [eax+168], OFFSET _BN_nist_mod_256
	jmp	SHORT $LN14@ec_GFp_nis
$LN9@ec_GFp_nis:
; Line 152
	push	ebx
	call	_BN_get0_nist_prime_384
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN11@ec_GFp_nis
; Line 153
	mov	eax, DWORD PTR _group$[esp+12]
	mov	DWORD PTR [eax+168], OFFSET _BN_nist_mod_384
	jmp	SHORT $LN14@ec_GFp_nis
$LN11@ec_GFp_nis:
; Line 154
	push	ebx
	call	_BN_get0_nist_prime_521
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN13@ec_GFp_nis
; Line 155
	mov	eax, DWORD PTR _group$[esp+12]
	mov	DWORD PTR [eax+168], OFFSET _BN_nist_mod_521
$LN14@ec_GFp_nis:
; Line 161
	push	esi
	push	DWORD PTR _b$[esp+16]
	push	DWORD PTR _a$[esp+20]
	push	ebx
	push	eax
	call	_ec_GFp_simple_group_set_curve
	mov	ebp, eax
	jmp	SHORT $LN18@ec_GFp_nis
$LN13@ec_GFp_nis:
; Line 157
	push	157					; 0000009dH
	push	OFFSET ??_C@_0BH@MKKJGLGM@?4?2crypto?2ec?2ecp_nist?4c?$AA@
	push	135					; 00000087H
	push	202					; 000000caH
	push	16					; 00000010H
	call	_ERR_put_error
$LN18@ec_GFp_nis:
	add	esp, 20					; 00000014H
	pop	ebx
$err$20:
; Line 164
	push	esi
	call	_BN_CTX_end
	add	esp, 4
; Line 165
	test	edi, edi
	je	SHORT $LN15@ec_GFp_nis
; Line 166
	push	edi
	call	_BN_CTX_free
	add	esp, 4
$LN15@ec_GFp_nis:
; Line 167
	pop	edi
	pop	esi
	mov	eax, ebp
	pop	ebp
; Line 168
	ret	0
_ec_GFp_nist_group_set_curve ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ec_GFp_nist_group_copy
_TEXT	SEGMENT
_dest$ = 8						; size = 4
_src$ = 12						; size = 4
_ec_GFp_nist_group_copy PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
; Line 126
	mov	edx, DWORD PTR _src$[esp-4]
	mov	ecx, DWORD PTR _dest$[esp-4]
	mov	eax, DWORD PTR [edx+168]
	mov	DWORD PTR [ecx+168], eax
; Line 128
	mov	DWORD PTR _src$[esp-4], edx
	mov	DWORD PTR _dest$[esp-4], ecx
	jmp	_ec_GFp_simple_group_copy
_ec_GFp_nist_group_copy ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _EC_GFp_nist_method
_TEXT	SEGMENT
_EC_GFp_nist_method PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ec\ecp_nist.c
; Line 121
	mov	eax, OFFSET ?ret@?1??EC_GFp_nist_method@@9@9
; Line 122
	ret	0
_EC_GFp_nist_method ENDP
_TEXT	ENDS
END
