; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

_BSS	SEGMENT
_pkey_asn1_meth_table DD 01H DUP (?)
_BSS	ENDS
PUBLIC	_ENGINE_register_pkey_asn1_meths
PUBLIC	_ENGINE_unregister_pkey_asn1_meths
PUBLIC	_ENGINE_register_all_pkey_asn1_meths
PUBLIC	_ENGINE_set_pkey_asn1_meths
PUBLIC	_ENGINE_get_pkey_asn1_meths
PUBLIC	_ENGINE_get_pkey_asn1_meth
PUBLIC	_ENGINE_get_pkey_asn1_meth_str
PUBLIC	_ENGINE_pkey_asn1_find_str
PUBLIC	_ENGINE_get_pkey_asn1_meth_engine
PUBLIC	_ENGINE_set_default_pkey_asn1_meths
PUBLIC	_engine_pkey_asn1_meths_free
PUBLIC	??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@ ; `string'
EXTRN	__imp___strnicmp:PROC
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_CRYPTO_lock:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_EVP_PKEY_asn1_free:PROC
EXTRN	_ENGINE_get_first:PROC
EXTRN	_ENGINE_get_next:PROC
EXTRN	_engine_table_register:PROC
EXTRN	_engine_table_unregister:PROC
EXTRN	_engine_table_cleanup:PROC
EXTRN	_engine_table_select:PROC
EXTRN	_engine_table_doall:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@
CONST	SEGMENT
??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@ DB '.\crypto\eng'
	DB	'ine\tb_asnmth.c', 00H			; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _look_str_cb
_TEXT	SEGMENT
tv191 = -4						; size = 4
_nid$ = 8						; size = 4
_sk$ = 12						; size = 4
_def$ = 16						; size = 4
_ameth$1 = 20						; size = 4
_arg$ = 20						; size = 4
_look_str_cb PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 209
	mov	eax, 4
	call	__chkstk
	push	edi
; Line 212
	mov	edi, DWORD PTR _arg$[esp+4]
	cmp	DWORD PTR [edi+4], 0
	jne	$LN13@look_str_c
; Line 214
	push	ebx
	mov	ebx, DWORD PTR _sk$[esp+8]
	push	esi
	push	ebx
	xor	esi, esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN15@look_str_c
	push	ebp
	npad	1
$LL4@look_str_c:
; Line 215
	push	esi
	push	ebx
	call	_sk_value
; Line 217
	push	DWORD PTR _nid$[esp+24]
	mov	ebp, eax
	lea	eax, DWORD PTR _ameth$1[esp+28]
	push	0
	push	eax
	push	ebp
	mov	ecx, DWORD PTR [ebp+48]
	call	ecx
; Line 218
	mov	ecx, DWORD PTR _ameth$1[esp+40]
	add	esp, 24					; 00000018H
	mov	edx, DWORD PTR [ecx+12]
	mov	eax, edx
	lea	ecx, DWORD PTR [eax+1]
	mov	DWORD PTR tv191[esp+20], ecx
	npad	3
$LL14@look_str_c:
	mov	cl, BYTE PTR [eax]
	inc	eax
	test	cl, cl
	jne	SHORT $LL14@look_str_c
	sub	eax, DWORD PTR tv191[esp+20]
	mov	ecx, DWORD PTR [edi+12]
	cmp	eax, ecx
	jne	SHORT $LN2@look_str_c
	push	ecx
	push	DWORD PTR [edi+8]
	push	edx
	call	DWORD PTR __imp___strnicmp
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN9@look_str_c
$LN2@look_str_c:
; Line 214
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@look_str_c
	pop	ebp
	pop	esi
	pop	ebx
	pop	edi
; Line 225
	pop	ecx
	ret	0
$LN9@look_str_c:
; Line 221
	mov	eax, DWORD PTR _ameth$1[esp+16]
	mov	DWORD PTR [edi], ebp
	mov	DWORD PTR [edi+4], eax
	pop	ebp
$LN15@look_str_c:
	pop	esi
	pop	ebx
$LN13@look_str_c:
	pop	edi
; Line 225
	pop	ecx
	ret	0
_look_str_cb ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _engine_unregister_all_pkey_asn1_meths
_TEXT	SEGMENT
_engine_unregister_all_pkey_asn1_meths PROC		; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 76
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_cleanup
	pop	ecx
; Line 77
	ret	0
_engine_unregister_all_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _engine_pkey_asn1_meths_free
_TEXT	SEGMENT
_pkm$ = -4						; size = 4
_pknids$1 = 8						; size = 4
_e$ = 8							; size = 4
_engine_pkey_asn1_meths_free PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 158
	mov	eax, 4
	call	__chkstk
	push	edi
; Line 161
	mov	edi, DWORD PTR _e$[esp+4]
	mov	eax, DWORD PTR [edi+48]
	test	eax, eax
	je	SHORT $LN3@engine_pke
; Line 164
	push	ebx
	push	esi
	push	0
	lea	ecx, DWORD PTR _pknids$1[esp+16]
	push	ecx
	push	0
	push	edi
	call	eax
	mov	ebx, eax
	add	esp, 16					; 00000010H
; Line 165
	xor	esi, esi
	test	ebx, ebx
	jle	SHORT $LN12@engine_pke
	npad	1
$LL4@engine_pke:
; Line 166
	mov	ecx, DWORD PTR _pknids$1[esp+12]
	lea	eax, DWORD PTR _pkm$[esp+16]
	push	DWORD PTR [ecx+esi*4]
	push	0
	push	eax
	mov	eax, DWORD PTR [edi+48]
	push	edi
	call	eax
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN2@engine_pke
; Line 167
	push	DWORD PTR _pkm$[esp+16]
	call	_EVP_PKEY_asn1_free
	add	esp, 4
$LN2@engine_pke:
; Line 165
	inc	esi
	cmp	esi, ebx
	jl	SHORT $LL4@engine_pke
$LN12@engine_pke:
	pop	esi
	pop	ebx
$LN3@engine_pke:
	pop	edi
; Line 171
	pop	ecx
	ret	0
_engine_pkey_asn1_meths_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_set_default_pkey_asn1_meths
_TEXT	SEGMENT
_nids$1 = 8						; size = 4
_e$ = 8							; size = 4
_ENGINE_set_default_pkey_asn1_meths PROC		; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 101
	push	esi
; Line 102
	mov	esi, DWORD PTR _e$[esp]
	mov	eax, DWORD PTR [esi+48]
	test	eax, eax
	je	SHORT $LN3@ENGINE_set
; Line 104
	push	0
	lea	ecx, DWORD PTR _nids$1[esp+4]
	push	ecx
	push	0
	push	esi
	call	eax
	add	esp, 16					; 00000010H
; Line 105
	test	eax, eax
	jle	SHORT $LN3@ENGINE_set
; Line 106
	push	1
	push	eax
	push	DWORD PTR _nids$1[esp+8]
	push	esi
	push	OFFSET _engine_unregister_all_pkey_asn1_meths
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_register
	add	esp, 24					; 00000018H
	pop	esi
; Line 111
	ret	0
$LN3@ENGINE_set:
; Line 110
	mov	eax, 1
	pop	esi
; Line 111
	ret	0
_ENGINE_set_default_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_get_pkey_asn1_meth_engine
_TEXT	SEGMENT
_nid$ = 8						; size = 4
_ENGINE_get_pkey_asn1_meth_engine PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 120
	push	DWORD PTR _nid$[esp-4]
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_select
	add	esp, 8
; Line 121
	ret	0
_ENGINE_get_pkey_asn1_meth_engine ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_pkey_asn1_find_str
_TEXT	SEGMENT
_fstr$ = -16						; size = 16
_pe$ = 8						; size = 4
_str$ = 12						; size = 4
_len$ = 16						; size = 4
_ENGINE_pkey_asn1_find_str PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 230
	mov	eax, 16					; 00000010H
	call	__chkstk
; Line 234
	mov	eax, DWORD PTR _str$[esp+12]
; Line 236
	push	236					; 000000ecH
	push	OFFSET ??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@
	mov	DWORD PTR _fstr$[esp+32], eax
	mov	eax, DWORD PTR _len$[esp+20]
	push	30					; 0000001eH
	push	9
	mov	DWORD PTR _fstr$[esp+32], 0
	mov	DWORD PTR _fstr$[esp+36], 0
	mov	DWORD PTR _fstr$[esp+44], eax
	call	_CRYPTO_lock
; Line 237
	lea	eax, DWORD PTR _fstr$[esp+32]
	push	eax
	push	OFFSET _look_str_cb
	push	DWORD PTR _pkey_asn1_meth_table
	call	_engine_table_doall
; Line 239
	mov	ecx, DWORD PTR _fstr$[esp+44]
	add	esp, 28					; 0000001cH
	test	ecx, ecx
	je	SHORT $LN2@ENGINE_pke
; Line 240
	inc	DWORD PTR [ecx+88]
	mov	ecx, DWORD PTR _fstr$[esp+16]
$LN2@ENGINE_pke:
; Line 243
	mov	eax, DWORD PTR _pe$[esp+12]
; Line 244
	push	244					; 000000f4H
	push	OFFSET ??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@
	push	30					; 0000001eH
	push	10					; 0000000aH
	mov	DWORD PTR [eax], ecx
	call	_CRYPTO_lock
; Line 245
	mov	eax, DWORD PTR _fstr$[esp+36]
; Line 246
	add	esp, 32					; 00000020H
	ret	0
_ENGINE_pkey_asn1_find_str ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_get_pkey_asn1_meth_str
_TEXT	SEGMENT
_nids$ = -8						; size = 4
tv69 = -4						; size = 4
_ameth$ = 8						; size = 4
_e$ = 8							; size = 4
_str$ = 12						; size = 4
_len$ = 16						; size = 4
_ENGINE_get_pkey_asn1_meth_str PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 183
	mov	eax, 8
	call	__chkstk
	push	ebp
; Line 187
	mov	ebp, DWORD PTR _e$[esp+8]
	mov	ecx, DWORD PTR [ebp+48]
	test	ecx, ecx
	jne	SHORT $LN5@ENGINE_get
; Line 188
	xor	eax, eax
	pop	ebp
; Line 199
	add	esp, 8
	ret	0
$LN5@ENGINE_get:
	push	esi
; Line 189
	mov	esi, DWORD PTR _len$[esp+12]
	cmp	esi, -1
	jne	SHORT $LN6@ENGINE_get
; Line 190
	mov	esi, DWORD PTR _str$[esp+12]
	lea	edx, DWORD PTR [esi+1]
	npad	2
$LL15@ENGINE_get:
	mov	al, BYTE PTR [esi]
	inc	esi
	test	al, al
	jne	SHORT $LL15@ENGINE_get
	sub	esi, edx
$LN6@ENGINE_get:
	push	ebx
	push	edi
; Line 191
	push	0
	lea	eax, DWORD PTR _nids$[esp+28]
	push	eax
	push	0
	push	ebp
	call	ecx
	mov	ebx, eax
	add	esp, 16					; 00000010H
; Line 192
	xor	edi, edi
	test	ebx, ebx
	jle	SHORT $LN14@ENGINE_get
$LL4@ENGINE_get:
; Line 193
	mov	ecx, DWORD PTR _nids$[esp+24]
	lea	eax, DWORD PTR _ameth$[esp+20]
	push	DWORD PTR [ecx+edi*4]
	push	0
	push	eax
	mov	eax, DWORD PTR [ebp+48]
	push	ebp
	call	eax
; Line 194
	mov	eax, DWORD PTR _ameth$[esp+36]
	add	esp, 16					; 00000010H
	mov	edx, DWORD PTR [eax+12]
	mov	eax, edx
	lea	ecx, DWORD PTR [eax+1]
	mov	DWORD PTR tv69[esp+24], ecx
	npad	7
$LL16@ENGINE_get:
	mov	cl, BYTE PTR [eax]
	inc	eax
	test	cl, cl
	jne	SHORT $LL16@ENGINE_get
	sub	eax, DWORD PTR tv69[esp+24]
	cmp	eax, esi
	jne	SHORT $LN2@ENGINE_get
	push	esi
	push	DWORD PTR _str$[esp+24]
	push	edx
	call	DWORD PTR __imp___strnicmp
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN10@ENGINE_get
$LN2@ENGINE_get:
; Line 192
	inc	edi
	cmp	edi, ebx
	jl	SHORT $LL4@ENGINE_get
$LN14@ENGINE_get:
	pop	edi
	pop	ebx
	pop	esi
; Line 198
	xor	eax, eax
	pop	ebp
; Line 199
	add	esp, 8
	ret	0
$LN10@ENGINE_get:
; Line 196
	mov	eax, DWORD PTR _ameth$[esp+20]
	pop	edi
	pop	ebx
	pop	esi
	pop	ebp
; Line 199
	add	esp, 8
	ret	0
_ENGINE_get_pkey_asn1_meth_str ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_get_pkey_asn1_meth
_TEXT	SEGMENT
_ret$ = 8						; size = 4
_e$ = 8							; size = 4
_nid$ = 12						; size = 4
_ENGINE_get_pkey_asn1_meth PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 142
	mov	eax, DWORD PTR _e$[esp-4]
	mov	ecx, DWORD PTR [eax+48]
; Line 131
	test	ecx, ecx
	je	SHORT $LN3@ENGINE_get
	push	DWORD PTR _nid$[esp-4]
	lea	edx, DWORD PTR _ret$[esp]
	push	0
	push	edx
	push	eax
	call	ecx
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN3@ENGINE_get
; Line 136
	mov	eax, DWORD PTR _ret$[esp-4]
; Line 137
	ret	0
$LN3@ENGINE_get:
; Line 132
	push	133					; 00000085H
	push	OFFSET ??_C@_0BM@MPBIGLJP@?4?2crypto?2engine?2tb_asnmth?4c?$AA@
	push	101					; 00000065H
	push	193					; 000000c1H
	push	38					; 00000026H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 134
	xor	eax, eax
; Line 137
	ret	0
_ENGINE_get_pkey_asn1_meth ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_get_pkey_asn1_meths
_TEXT	SEGMENT
_e$ = 8							; size = 4
_ENGINE_get_pkey_asn1_meths PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 142
	mov	eax, DWORD PTR _e$[esp-4]
	mov	eax, DWORD PTR [eax+48]
; Line 143
	ret	0
_ENGINE_get_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_set_pkey_asn1_meths
_TEXT	SEGMENT
_e$ = 8							; size = 4
_f$ = 12						; size = 4
_ENGINE_set_pkey_asn1_meths PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 148
	mov	eax, DWORD PTR _e$[esp-4]
	mov	ecx, DWORD PTR _f$[esp-4]
	mov	DWORD PTR [eax+48], ecx
; Line 149
	mov	eax, 1
; Line 150
	ret	0
_ENGINE_set_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_register_all_pkey_asn1_meths
_TEXT	SEGMENT
_nids$1 = -4						; size = 4
_ENGINE_register_all_pkey_asn1_meths PROC		; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 93
	mov	eax, 4
	call	__chkstk
	push	esi
; Line 96
	call	_ENGINE_get_first
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN3@ENGINE_reg
$LL4@ENGINE_reg:
; Line 81
	mov	eax, DWORD PTR [esi+48]
	test	eax, eax
	je	SHORT $LN2@ENGINE_reg
; Line 83
	push	0
	lea	ecx, DWORD PTR _nids$1[esp+12]
	push	ecx
	push	0
	push	esi
	call	eax
	add	esp, 16					; 00000010H
; Line 84
	test	eax, eax
	jle	SHORT $LN2@ENGINE_reg
; Line 85
	push	0
	push	eax
	push	DWORD PTR _nids$1[esp+16]
	push	esi
	push	OFFSET _engine_unregister_all_pkey_asn1_meths
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_register
	add	esp, 24					; 00000018H
$LN2@ENGINE_reg:
; Line 96
	push	esi
	call	_ENGINE_get_next
	mov	esi, eax
	add	esp, 4
	test	esi, esi
	jne	SHORT $LL4@ENGINE_reg
$LN3@ENGINE_reg:
	pop	esi
; Line 98
	pop	ecx
	ret	0
_ENGINE_register_all_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_unregister_pkey_asn1_meths
_TEXT	SEGMENT
_e$ = 8							; size = 4
_ENGINE_unregister_pkey_asn1_meths PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 71
	push	DWORD PTR _e$[esp-4]
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_unregister
	add	esp, 8
; Line 72
	ret	0
_ENGINE_unregister_pkey_asn1_meths ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ENGINE_register_pkey_asn1_meths
_TEXT	SEGMENT
_nids$1 = 8						; size = 4
_e$ = 8							; size = 4
_ENGINE_register_pkey_asn1_meths PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\engine\tb_asnmth.c
; Line 80
	push	esi
; Line 81
	mov	esi, DWORD PTR _e$[esp]
	mov	eax, DWORD PTR [esi+48]
	test	eax, eax
	je	SHORT $LN3@ENGINE_reg
; Line 83
	push	0
	lea	ecx, DWORD PTR _nids$1[esp+4]
	push	ecx
	push	0
	push	esi
	call	eax
	add	esp, 16					; 00000010H
; Line 84
	test	eax, eax
	jle	SHORT $LN3@ENGINE_reg
; Line 85
	push	0
	push	eax
	push	DWORD PTR _nids$1[esp+8]
	push	esi
	push	OFFSET _engine_unregister_all_pkey_asn1_meths
	push	OFFSET _pkey_asn1_meth_table
	call	_engine_table_register
	add	esp, 24					; 00000018H
	pop	esi
; Line 90
	ret	0
$LN3@ENGINE_reg:
; Line 89
	mov	eax, 1
	pop	esi
; Line 90
	ret	0
_ENGINE_register_pkey_asn1_meths ENDP
_TEXT	ENDS
END
