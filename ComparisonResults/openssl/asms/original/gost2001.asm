; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_fill_GOST2001_params
PUBLIC	_gost2001_keygen
PUBLIC	_gost2001_do_sign
PUBLIC	_gost2001_do_verify
PUBLIC	_gost2001_compute_public
PUBLIC	??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@ ; `string'
PUBLIC	??_C@_0L@CJLMMIGL@dlen?5?$DN?$DN?532?$AA@	; `string'
EXTRN	_OpenSSLDie:PROC
EXTRN	_BN_CTX_new:PROC
EXTRN	_BN_CTX_free:PROC
EXTRN	_BN_CTX_start:PROC
EXTRN	_BN_CTX_get:PROC
EXTRN	_BN_CTX_end:PROC
EXTRN	_BN_rand_range:PROC
EXTRN	_BN_new:PROC
EXTRN	_BN_sub:PROC
EXTRN	_BN_div:PROC
EXTRN	_BN_nnmod:PROC
EXTRN	_BN_mod_add:PROC
EXTRN	_BN_mod_mul:PROC
EXTRN	_BN_set_word:PROC
EXTRN	_BN_cmp:PROC
EXTRN	_BN_free:PROC
EXTRN	_BN_dup:PROC
EXTRN	_BN_hex2bn:PROC
EXTRN	_BN_mod_inverse:PROC
EXTRN	_DSA_SIG_new:PROC
EXTRN	_DSA_SIG_free:PROC
EXTRN	_EC_GROUP_free:PROC
EXTRN	_EC_GROUP_set_generator:PROC
EXTRN	_EC_GROUP_get_order:PROC
EXTRN	_EC_GROUP_set_curve_name:PROC
EXTRN	_EC_GROUP_new_curve_GFp:PROC
EXTRN	_EC_POINT_new:PROC
EXTRN	_EC_POINT_free:PROC
EXTRN	_EC_POINT_set_affine_coordinates_GFp:PROC
EXTRN	_EC_POINT_get_affine_coordinates_GFp:PROC
EXTRN	_EC_POINT_mul:PROC
EXTRN	_EC_KEY_get0_group:PROC
EXTRN	_EC_KEY_set_group:PROC
EXTRN	_EC_KEY_get0_private_key:PROC
EXTRN	_EC_KEY_set_private_key:PROC
EXTRN	_EC_KEY_get0_public_key:PROC
EXTRN	_EC_KEY_set_public_key:PROC
EXTRN	_hashsum2bn:PROC
EXTRN	_ERR_GOST_error:PROC
EXTRN	__chkstk:PROC
EXTRN	_R3410_2001_paramset:BYTE
;	COMDAT ??_C@_0L@CJLMMIGL@dlen?5?$DN?$DN?532?$AA@
CONST	SEGMENT
??_C@_0L@CJLMMIGL@dlen?5?$DN?$DN?532?$AA@ DB 'dlen == 32', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
CONST	SEGMENT
??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@ DB '.\engines\cc'
	DB	'gost\gost2001.c', 00H			; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost2001_compute_public
_TEXT	SEGMENT
_ok$1$ = -8						; size = 4
_priv_key$1$ = -4					; size = 4
_ec$ = 8						; size = 4
_gost2001_compute_public PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
; Line 382
	mov	eax, 8
	call	__chkstk
	push	ebx
; Line 383
	mov	ebx, DWORD PTR _ec$[esp+8]
	push	ebp
	push	edi
	push	ebx
	call	_EC_KEY_get0_group
	mov	ebp, eax
; Line 387
	xor	edi, edi
	add	esp, 4
	mov	DWORD PTR _ok$1$[esp+20], edi
; Line 389
	test	ebp, ebp
	jne	SHORT $LN2@gost2001_c
; Line 390
	push	391					; 00000187H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	114					; 00000072H
	push	104					; 00000068H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 392
	xor	eax, eax
	pop	edi
	pop	ebp
	pop	ebx
; Line 426
	add	esp, 8
	ret	0
$LN2@gost2001_c:
	push	esi
; Line 394
	call	_BN_CTX_new
	mov	esi, eax
; Line 395
	test	esi, esi
	jne	SHORT $LN3@gost2001_c
; Line 396
	push	396					; 0000018cH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	104					; 00000068H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 425
	mov	eax, edi
	pop	esi
	pop	edi
	pop	ebp
	pop	ebx
; Line 426
	add	esp, 8
	ret	0
$LN3@gost2001_c:
; Line 399
	push	esi
	call	_BN_CTX_start
; Line 400
	push	ebx
	call	_EC_KEY_get0_private_key
	add	esp, 8
	mov	DWORD PTR _priv_key$1$[esp+24], eax
	test	eax, eax
	jne	SHORT $LN4@gost2001_c
; Line 401
	push	401					; 00000191H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	16					; 00000010H
	push	104					; 00000068H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 402
	jmp	$LN8@gost2001_c
$LN4@gost2001_c:
; Line 405
	push	ebp
	call	_EC_POINT_new
	mov	edi, eax
	add	esp, 4
; Line 406
	test	edi, edi
	jne	SHORT $LN5@gost2001_c
; Line 407
	push	407					; 00000197H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	104					; 00000068H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 408
	jmp	SHORT $LN8@gost2001_c
$LN5@gost2001_c:
; Line 410
	push	esi
	push	0
	push	0
	push	DWORD PTR _priv_key$1$[esp+36]
	push	edi
	push	ebp
	call	_EC_POINT_mul
	add	esp, 24					; 00000018H
	test	eax, eax
	jne	SHORT $LN6@gost2001_c
; Line 411
	push	411					; 0000019bH
$LN11@gost2001_c:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	16					; 00000010H
	push	104					; 00000068H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 412
	jmp	SHORT $err$13
$LN6@gost2001_c:
; Line 414
	push	edi
	push	ebx
	call	_EC_KEY_set_public_key
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN7@gost2001_c
; Line 415
	push	415					; 0000019fH
; Line 416
	jmp	SHORT $LN11@gost2001_c
$LN7@gost2001_c:
; Line 418
	mov	DWORD PTR _ok$1$[esp+24], 256		; 00000100H
$err$13:
; Line 420
	push	edi
	call	_EC_POINT_free
	mov	edi, DWORD PTR _ok$1$[esp+28]
	add	esp, 4
$LN8@gost2001_c:
; Line 422
	push	esi
	call	_BN_CTX_end
; Line 423
	push	esi
	call	_BN_CTX_free
	add	esp, 8
; Line 425
	mov	eax, edi
	pop	esi
	pop	edi
	pop	ebp
	pop	ebx
; Line 426
	add	esp, 8
	ret	0
_gost2001_compute_public ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost2001_do_verify
_TEXT	SEGMENT
_md$1$ = -40						; size = 4
_e$1$ = -36						; size = 4
_tmp$1$ = -32						; size = 4
_z2$1$ = -28						; size = 4
_z1$1$ = -24						; size = 4
_X$1$ = -20						; size = 4
_group$1$ = -16						; size = 4
_R$1$ = -12						; size = 4
_v$2$ = -8						; size = 4
_v$1$ = -8						; size = 4
_pub_key$1$ = -4					; size = 4
_dgst$ = 8						; size = 4
_dgst_len$ = 12						; size = 4
_sig$ = 16						; size = 4
_ec$ = 20						; size = 4
_gost2001_do_verify PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
; Line 262
	mov	eax, 40					; 00000028H
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
	push	edi
; Line 263
	call	_BN_CTX_new
; Line 264
	push	DWORD PTR _ec$[esp+52]
	mov	esi, eax
	call	_EC_KEY_get0_group
	add	esp, 4
	mov	ebx, eax
; Line 266
	xor	ebp, ebp
	mov	DWORD PTR _group$1$[esp+56], ebx
; Line 271
	xor	edi, edi
; Line 273
	test	esi, esi
	je	$LN3@gost2001_d
	test	ebx, ebx
	je	$LN3@gost2001_d
; Line 278
	push	esi
	call	_BN_CTX_start
; Line 279
	push	esi
	call	_BN_CTX_get
; Line 280
	push	esi
	mov	edi, eax
	call	_BN_CTX_get
; Line 281
	push	esi
	mov	DWORD PTR _e$1$[esp+72], eax
	call	_BN_CTX_get
; Line 282
	push	esi
	mov	DWORD PTR _z1$1$[esp+76], eax
	call	_BN_CTX_get
; Line 283
	push	esi
	mov	DWORD PTR _z2$1$[esp+80], eax
	call	_BN_CTX_get
; Line 284
	push	esi
	mov	DWORD PTR _tmp$1$[esp+84], eax
	call	_BN_CTX_get
; Line 285
	push	esi
	mov	DWORD PTR _X$1$[esp+88], eax
	call	_BN_CTX_get
; Line 286
	push	esi
	mov	DWORD PTR _R$1$[esp+92], eax
	call	_BN_CTX_get
	add	esp, 36					; 00000024H
	mov	DWORD PTR _v$1$[esp+56], eax
; Line 287
	test	edi, edi
	je	$LN5@gost2001_d
	cmp	DWORD PTR _e$1$[esp+56], ebp
	je	$LN5@gost2001_d
	cmp	DWORD PTR _z1$1$[esp+56], ebp
	je	$LN5@gost2001_d
	cmp	DWORD PTR _z2$1$[esp+56], ebp
	je	$LN5@gost2001_d
	cmp	DWORD PTR _tmp$1$[esp+56], ebp
	je	$LN5@gost2001_d
	cmp	DWORD PTR _X$1$[esp+56], ebp
	je	$LN5@gost2001_d
	cmp	DWORD PTR _R$1$[esp+56], ebp
	je	$LN5@gost2001_d
	test	eax, eax
	je	$LN5@gost2001_d
; Line 292
	push	DWORD PTR _ec$[esp+52]
	call	_EC_KEY_get0_public_key
	add	esp, 4
	mov	DWORD PTR _pub_key$1$[esp+56], eax
; Line 293
	test	eax, eax
	je	$LN7@gost2001_d
	push	esi
	push	edi
	push	ebx
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN7@gost2001_d
; Line 299
	mov	ebp, DWORD PTR _sig$[esp+52]
	mov	ecx, DWORD PTR [ebp+4]
	cmp	DWORD PTR [ecx+4], 0
	je	$LN9@gost2001_d
	mov	eax, DWORD PTR [ebp]
	cmp	DWORD PTR [eax+4], 0
	je	$LN9@gost2001_d
	push	edi
	push	ecx
	call	_BN_cmp
	add	esp, 8
	cmp	eax, 1
	jge	$LN9@gost2001_d
	push	edi
	push	DWORD PTR [ebp]
	call	_BN_cmp
	add	esp, 8
	cmp	eax, 1
	jge	$LN9@gost2001_d
; Line 305
	push	DWORD PTR _dgst$[esp+52]
	call	_hashsum2bn
	add	esp, 4
	mov	DWORD PTR _md$1$[esp+56], eax
; Line 307
	test	eax, eax
	je	$LN11@gost2001_d
	push	esi
	push	edi
	push	eax
	push	DWORD PTR _e$1$[esp+68]
	push	0
	call	_BN_div
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN11@gost2001_d
; Line 317
	mov	eax, DWORD PTR _e$1$[esp+56]
	cmp	DWORD PTR [eax+4], 0
	jne	SHORT $LN12@gost2001_d
	push	1
	push	eax
	call	_BN_set_word
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN26@gost2001_d
; Line 318
	push	318					; 0000013eH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	106					; 0000006aH
	call	_ERR_GOST_error
; Line 319
	mov	ebp, DWORD PTR _md$1$[esp+72]
	add	esp, 16					; 00000010H
	xor	edi, edi
	jmp	$LN21@gost2001_d
$LN26@gost2001_d:
	mov	eax, DWORD PTR _e$1$[esp+56]
$LN12@gost2001_d:
; Line 321
	push	esi
	push	edi
	push	eax
	push	DWORD PTR _v$1$[esp+68]
	call	_BN_mod_inverse
	add	esp, 16					; 00000010H
	mov	DWORD PTR _v$2$[esp+56], eax
; Line 325
	test	eax, eax
	je	$LN14@gost2001_d
	push	esi
	push	edi
	push	eax
	push	DWORD PTR [ebp+4]
	push	DWORD PTR _z1$1$[esp+72]
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN14@gost2001_d
	push	DWORD PTR [ebp]
	push	edi
	push	DWORD PTR _tmp$1$[esp+64]
	call	_BN_sub
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN14@gost2001_d
	push	esi
	push	edi
	push	DWORD PTR _v$2$[esp+64]
	push	DWORD PTR _tmp$1$[esp+68]
	push	DWORD PTR _z2$1$[esp+72]
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN14@gost2001_d
; Line 337
	push	ebx
	call	_EC_POINT_new
	mov	ebx, eax
	add	esp, 4
; Line 338
	test	ebx, ebx
	jne	SHORT $LN15@gost2001_d
; Line 339
	push	339					; 00000153H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	106					; 0000006aH
	call	_ERR_GOST_error
; Line 340
	mov	ebp, DWORD PTR _md$1$[esp+72]
	add	esp, 16					; 00000010H
	xor	edi, edi
	jmp	$LN21@gost2001_d
$LN15@gost2001_d:
; Line 342
	push	esi
	push	DWORD PTR _z2$1$[esp+60]
	push	DWORD PTR _pub_key$1$[esp+64]
	push	DWORD PTR _z1$1$[esp+68]
	push	ebx
	push	DWORD PTR _group$1$[esp+76]
	call	_EC_POINT_mul
	add	esp, 24					; 00000018H
	test	eax, eax
	jne	SHORT $LN16@gost2001_d
; Line 343
	push	343					; 00000157H
$LN27@gost2001_d:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	16					; 00000010H
$LN28@gost2001_d:
	push	106					; 0000006aH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 344
	xor	edi, edi
; Line 367
	push	ebx
	call	_EC_POINT_free
	mov	ebp, DWORD PTR _md$1$[esp+60]
	add	esp, 4
	jmp	$LN21@gost2001_d
$LN16@gost2001_d:
; Line 346
	push	esi
	push	0
	push	DWORD PTR _X$1$[esp+64]
	push	ebx
	push	DWORD PTR _group$1$[esp+72]
	call	_EC_POINT_get_affine_coordinates_GFp
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN17@gost2001_d
; Line 347
	push	347					; 0000015bH
; Line 348
	jmp	SHORT $LN27@gost2001_d
$LN17@gost2001_d:
; Line 350
	push	esi
	push	edi
	push	DWORD PTR _X$1$[esp+64]
	mov	edi, DWORD PTR _R$1$[esp+68]
	push	edi
	push	0
	call	_BN_div
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN18@gost2001_d
; Line 351
	push	351					; 0000015fH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
; Line 352
	jmp	SHORT $LN28@gost2001_d
$LN18@gost2001_d:
; Line 361
	push	DWORD PTR [ebp]
	push	edi
	call	_BN_cmp
	add	esp, 8
	test	eax, eax
	je	SHORT $LN19@gost2001_d
; Line 362
	push	362					; 0000016aH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	126					; 0000007eH
; Line 363
	jmp	$LN28@gost2001_d
$LN19@gost2001_d:
; Line 364
	mov	edi, 1
$err$30:
; Line 367
	push	ebx
	call	_EC_POINT_free
	mov	ebp, DWORD PTR _md$1$[esp+60]
	add	esp, 4
	jmp	$LN21@gost2001_d
$LN14@gost2001_d:
; Line 326
	push	326					; 00000146H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	106					; 0000006aH
	call	_ERR_GOST_error
; Line 327
	mov	ebp, DWORD PTR _md$1$[esp+72]
	add	esp, 16					; 00000010H
	xor	edi, edi
	jmp	$LN21@gost2001_d
$LN11@gost2001_d:
; Line 308
	push	308					; 00000134H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	106					; 0000006aH
	call	_ERR_GOST_error
; Line 309
	mov	ebp, DWORD PTR _md$1$[esp+72]
	add	esp, 16					; 00000010H
	xor	edi, edi
	jmp	SHORT $LN21@gost2001_d
$LN9@gost2001_d:
; Line 300
	push	301					; 0000012dH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	127					; 0000007fH
	push	106					; 0000006aH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 302
	xor	ebp, ebp
	xor	edi, edi
	jmp	SHORT $LN21@gost2001_d
$LN7@gost2001_d:
; Line 294
	push	294					; 00000126H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	106					; 0000006aH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 295
	xor	edi, edi
	jmp	SHORT $LN21@gost2001_d
$LN5@gost2001_d:
; Line 288
	push	288					; 00000120H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	106					; 0000006aH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 289
	xor	edi, edi
	jmp	SHORT $LN21@gost2001_d
$LN3@gost2001_d:
; Line 274
	push	274					; 00000112H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	106					; 0000006aH
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
$LN21@gost2001_d:
; Line 368
	test	esi, esi
	je	SHORT $LN22@gost2001_d
; Line 369
	push	esi
	call	_BN_CTX_end
; Line 370
	push	esi
	call	_BN_CTX_free
	add	esp, 8
$LN22@gost2001_d:
; Line 372
	test	ebp, ebp
	je	SHORT $LN25@gost2001_d
	push	ebp
	call	_BN_free
	add	esp, 4
$LN25@gost2001_d:
; Line 373
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 374
	add	esp, 40					; 00000028H
	ret	0
_gost2001_do_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost2001_do_sign
_TEXT	SEGMENT
_newsig$1$ = -40					; size = 4
_C$1$ = -36						; size = 4
_tmp2$1$ = -32						; size = 4
_k$1$ = -28						; size = 4
_order$1$ = -28						; size = 4
_group$1$ = -24						; size = 4
_tmp$1$ = -20						; size = 4
_s$1$ = -16						; size = 4
_md$1$ = -12						; size = 4
_e$1$ = -8						; size = 4
_priv_key$1$ = -4					; size = 4
_dgst$ = 8						; size = 4
_dlen$ = 12						; size = 4
_eckey$ = 16						; size = 4
_gost2001_do_sign PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
; Line 127
	mov	eax, 40					; 00000028H
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
	push	edi
; Line 129
	push	DWORD PTR _dgst$[esp+52]
	xor	eax, eax
	call	_hashsum2bn
	add	esp, 4
	mov	DWORD PTR _md$1$[esp+56], eax
; Line 133
	xor	eax, eax
	xor	edi, edi
	mov	DWORD PTR _s$1$[esp+56], edi
	xor	ebx, ebx
	mov	DWORD PTR _tmp$1$[esp+56], eax
; Line 135
	xor	ebp, ebp
	mov	DWORD PTR _tmp2$1$[esp+56], eax
; Line 136
	call	_BN_CTX_new
	mov	esi, eax
; Line 137
	test	esi, esi
	je	$LN9@gost2001_d
	cmp	DWORD PTR _md$1$[esp+56], ebx
	je	$LN9@gost2001_d
; Line 141
	push	esi
	call	_BN_CTX_start
	add	esp, 4
; Line 142
	cmp	DWORD PTR _dlen$[esp+52], 32		; 00000020H
	je	SHORT $LN43@gost2001_d
	push	OFFSET ??_C@_0L@CJLMMIGL@dlen?5?$DN?$DN?532?$AA@
	push	142					; 0000008eH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	call	_OpenSSLDie
	add	esp, 12					; 0000000cH
$LN43@gost2001_d:
; Line 143
	call	_DSA_SIG_new
	mov	DWORD PTR _newsig$1$[esp+56], eax
; Line 144
	test	eax, eax
	jne	SHORT $LN10@gost2001_d
; Line 145
	push	145					; 00000091H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	118					; 00000076H
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 146
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	$LN62@gost2001_d
$LN10@gost2001_d:
; Line 148
	mov	ebp, DWORD PTR _eckey$[esp+52]
	push	ebp
	call	_EC_KEY_get0_group
	add	esp, 4
	mov	DWORD PTR _group$1$[esp+56], eax
; Line 149
	test	eax, eax
	jne	SHORT $LN11@gost2001_d
; Line 150
	push	150					; 00000096H
$LN63@gost2001_d:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 151
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	xor	ebp, ebp
	jmp	$LN62@gost2001_d
$LN11@gost2001_d:
; Line 153
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	DWORD PTR _order$1$[esp+56], eax
; Line 154
	test	eax, eax
	je	$LN13@gost2001_d
	push	esi
	push	eax
	push	DWORD PTR _group$1$[esp+64]
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN13@gost2001_d
; Line 158
	push	ebp
	call	_EC_KEY_get0_private_key
	add	esp, 4
	mov	DWORD PTR _priv_key$1$[esp+56], eax
; Line 159
	test	eax, eax
	jne	SHORT $LN14@gost2001_d
; Line 160
	push	160					; 000000a0H
; Line 161
	jmp	SHORT $LN63@gost2001_d
$LN14@gost2001_d:
; Line 163
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	DWORD PTR _e$1$[esp+56], eax
; Line 164
	test	eax, eax
	je	$LN16@gost2001_d
	mov	ebp, DWORD PTR _order$1$[esp+56]
	push	esi
	push	ebp
	push	DWORD PTR _md$1$[esp+64]
	push	eax
	push	0
	call	_BN_div
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN16@gost2001_d
; Line 175
	mov	eax, DWORD PTR _e$1$[esp+56]
	cmp	DWORD PTR [eax+4], ebx
	jne	SHORT $LN17@gost2001_d
; Line 176
	push	1
	push	eax
	call	_BN_set_word
	add	esp, 8
$LN17@gost2001_d:
; Line 178
	push	esi
	call	_BN_CTX_get
; Line 179
	push	DWORD PTR _group$1$[esp+60]
	mov	DWORD PTR _k$1$[esp+64], eax
	call	_EC_POINT_new
	mov	ecx, eax
	add	esp, 8
; Line 180
	mov	eax, DWORD PTR _k$1$[esp+56]
	mov	DWORD PTR _C$1$[esp+56], ecx
	test	eax, eax
	je	SHORT $LN19@gost2001_d
	test	ecx, ecx
	jne	SHORT $LN7@gost2001_d
$LN19@gost2001_d:
; Line 181
	push	181					; 000000b5H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
; Line 229
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	$LN62@gost2001_d
$LL61@gost2001_d:
	mov	eax, DWORD PTR _k$1$[esp+56]
$LN7@gost2001_d:
; Line 186
	push	ebp
	push	eax
	call	_BN_rand_range
	add	esp, 8
	test	eax, eax
	je	$LN46@gost2001_d
; Line 191
	push	esi
	push	0
	push	0
	push	DWORD PTR _k$1$[esp+68]
	push	DWORD PTR _C$1$[esp+72]
	push	DWORD PTR _group$1$[esp+76]
	call	_EC_POINT_mul
	add	esp, 24					; 00000018H
	test	eax, eax
	je	$LN48@gost2001_d
; Line 195
	test	ebx, ebx
	jne	SHORT $LN22@gost2001_d
; Line 196
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	ebx, eax
$LN22@gost2001_d:
; Line 197
	test	edi, edi
	jne	SHORT $LN23@gost2001_d
; Line 198
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	edi, eax
$LN23@gost2001_d:
; Line 199
	test	ebx, ebx
	je	$LN25@gost2001_d
	test	edi, edi
	je	$LN25@gost2001_d
; Line 203
	push	esi
	push	0
	push	ebx
	push	DWORD PTR _C$1$[esp+68]
	push	DWORD PTR _group$1$[esp+72]
	call	_EC_POINT_get_affine_coordinates_GFp
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN50@gost2001_d
; Line 208
	push	esi
	push	ebp
	push	ebx
	push	edi
	call	_BN_nnmod
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN51@gost2001_d
; Line 213
	cmp	DWORD PTR [edi+4], 0
	je	$LL61@gost2001_d
; Line 215
	cmp	DWORD PTR _tmp$1$[esp+56], 0
	jne	SHORT $LN28@gost2001_d
; Line 216
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	DWORD PTR _tmp$1$[esp+56], eax
$LN28@gost2001_d:
; Line 217
	cmp	DWORD PTR _tmp2$1$[esp+56], 0
	jne	SHORT $LN29@gost2001_d
; Line 218
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	DWORD PTR _tmp2$1$[esp+56], eax
$LN29@gost2001_d:
; Line 219
	mov	eax, DWORD PTR _s$1$[esp+56]
	test	eax, eax
	jne	SHORT $LN30@gost2001_d
; Line 220
	push	esi
	call	_BN_CTX_get
	add	esp, 4
	mov	DWORD PTR _s$1$[esp+56], eax
$LN30@gost2001_d:
; Line 221
	mov	ecx, DWORD PTR _tmp$1$[esp+56]
	test	ecx, ecx
	je	$LN32@gost2001_d
	cmp	DWORD PTR _tmp2$1$[esp+56], 0
	je	$LN32@gost2001_d
	test	eax, eax
	je	$LN32@gost2001_d
; Line 228
	push	esi
	push	ebp
	push	edi
	push	DWORD PTR _priv_key$1$[esp+68]
	push	ecx
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN34@gost2001_d
	push	esi
	push	ebp
	push	DWORD PTR _e$1$[esp+64]
	push	DWORD PTR _k$1$[esp+68]
	push	DWORD PTR _tmp2$1$[esp+72]
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN34@gost2001_d
	mov	eax, DWORD PTR _tmp$1$[esp+56]
	push	esi
	push	ebp
	push	DWORD PTR _tmp2$1$[esp+64]
	push	eax
	push	DWORD PTR _s$1$[esp+72]
	call	_BN_mod_add
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN34@gost2001_d
; Line 233
	mov	ecx, DWORD PTR _s$1$[esp+56]
	mov	eax, DWORD PTR _k$1$[esp+56]
	cmp	DWORD PTR [ecx+4], 0
	je	$LN7@gost2001_d
; Line 235
	push	ecx
	call	_BN_dup
	mov	ebx, DWORD PTR _newsig$1$[esp+60]
; Line 236
	push	edi
	mov	DWORD PTR [ebx+4], eax
	call	_BN_dup
	add	esp, 8
	mov	DWORD PTR [ebx], eax
; Line 237
	cmp	DWORD PTR [ebx+4], 0
	je	SHORT $LN36@gost2001_d
	test	eax, eax
	je	SHORT $LN36@gost2001_d
; Line 242
	mov	ebp, DWORD PTR _C$1$[esp+56]
	mov	edi, ebx
	jmp	$err$68
$LN36@gost2001_d:
; Line 238
	push	238					; 000000eeH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 239
	mov	ebp, DWORD PTR _C$1$[esp+72]
	jmp	$LN62@gost2001_d
$LN34@gost2001_d:
; Line 229
	push	229					; 000000e5H
$LN65@gost2001_d:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	$LN62@gost2001_d
$LN32@gost2001_d:
; Line 222
	push	222					; 000000deH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 223
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	$LN62@gost2001_d
$LN51@gost2001_d:
; Line 209
	push	209					; 000000d1H
; Line 210
	jmp	SHORT $LN65@gost2001_d
$LN50@gost2001_d:
; Line 204
	push	204					; 000000ccH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	16					; 00000010H
; Line 229
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	$LN62@gost2001_d
$LN25@gost2001_d:
; Line 200
	push	200					; 000000c8H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
; Line 229
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	SHORT $LN62@gost2001_d
$LN48@gost2001_d:
; Line 192
	push	192					; 000000c0H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	16					; 00000010H
; Line 229
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	SHORT $LN62@gost2001_d
$LN46@gost2001_d:
; Line 187
	push	188					; 000000bcH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	125					; 0000007dH
; Line 229
	push	105					; 00000069H
	call	_ERR_GOST_error
; Line 230
	mov	ebp, DWORD PTR _C$1$[esp+72]
	mov	ebx, DWORD PTR _newsig$1$[esp+72]
	jmp	SHORT $LN62@gost2001_d
$LN16@gost2001_d:
; Line 165
	push	165					; 000000a5H
; Line 166
	jmp	$LN63@gost2001_d
$LN13@gost2001_d:
; Line 155
	push	155					; 0000009bH
; Line 156
	jmp	$LN63@gost2001_d
$LN9@gost2001_d:
; Line 138
	push	138					; 0000008aH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	105					; 00000069H
	call	_ERR_GOST_error
	xor	ebx, ebx
$LN62@gost2001_d:
	add	esp, 16					; 00000010H
	xor	edi, edi
$err$68:
; Line 244
	test	esi, esi
	je	SHORT $LN37@gost2001_d
; Line 245
	push	esi
	call	_BN_CTX_end
; Line 246
	push	esi
	call	_BN_CTX_free
	add	esp, 8
$LN37@gost2001_d:
; Line 248
	test	ebp, ebp
	je	SHORT $LN38@gost2001_d
	push	ebp
	call	_EC_POINT_free
	add	esp, 4
$LN38@gost2001_d:
; Line 249
	mov	eax, DWORD PTR _md$1$[esp+56]
	test	eax, eax
	je	SHORT $LN39@gost2001_d
	push	eax
	call	_BN_free
	add	esp, 4
$LN39@gost2001_d:
; Line 250
	test	edi, edi
	jne	SHORT $LN59@gost2001_d
	test	ebx, ebx
	je	SHORT $LN59@gost2001_d
; Line 251
	push	ebx
	call	_DSA_SIG_free
	add	esp, 4
$LN59@gost2001_d:
; Line 253
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 254
	add	esp, 40					; 00000028H
	ret	0
_gost2001_do_sign ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost2001_keygen
_TEXT	SEGMENT
_ec$ = 8						; size = 4
_gost2001_keygen PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
; Line 435
	push	ebx
	push	esi
	push	edi
; Line 436
	call	_BN_new
	mov	edi, eax
	call	_BN_new
; Line 437
	mov	ebx, DWORD PTR _ec$[esp+8]
	mov	esi, eax
	push	ebx
	call	_EC_KEY_get0_group
	add	esp, 4
; Line 439
	test	eax, eax
	je	SHORT $LN6@gost2001_k
	push	0
	push	edi
	push	eax
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN6@gost2001_k
$LL4@gost2001_k:
; Line 447
	push	edi
	push	esi
	call	_BN_rand_range
	add	esp, 8
	test	eax, eax
	je	SHORT $LN11@gost2001_k
; Line 455
	cmp	DWORD PTR [esi+4], 0
	je	SHORT $LL4@gost2001_k
; Line 457
	push	esi
	push	ebx
	call	_EC_KEY_set_private_key
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN8@gost2001_k
; Line 458
	push	458					; 000001caH
; Line 461
	jmp	SHORT $LN15@gost2001_k
$LN8@gost2001_k:
; Line 463
	push	esi
	call	_BN_free
; Line 464
	push	edi
	call	_BN_free
; Line 465
	push	ebx
	call	_gost2001_compute_public
	add	esp, 12					; 0000000cH
	pop	edi
	pop	esi
	pop	ebx
; Line 466
	ret	0
$LN11@gost2001_k:
; Line 448
	push	449					; 000001c1H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	125					; 0000007dH
; Line 452
	jmp	SHORT $LN16@gost2001_k
$LN6@gost2001_k:
; Line 440
	push	440					; 000001b8H
$LN15@gost2001_k:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
$LN16@gost2001_k:
	push	107					; 0000006bH
	call	_ERR_GOST_error
; Line 441
	push	esi
	call	_BN_free
; Line 442
	push	edi
	call	_BN_free
	add	esp, 24					; 00000018H
; Line 443
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebx
; Line 466
	ret	0
_gost2001_keygen ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _fill_GOST2001_params
_TEXT	SEGMENT
_b$ = -28						; size = 4
_a$ = -24						; size = 4
_p$ = -20						; size = 4
_y$ = -16						; size = 4
_x$ = -12						; size = 4
_q$ = -8						; size = 4
_ok$1$ = -4						; size = 4
_eckey$ = 8						; size = 4
_nid$ = 12						; size = 4
_fill_GOST2001_params PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost2001.c
; Line 36
	mov	eax, 28					; 0000001cH
	call	__chkstk
	push	ebp
	push	esi
	push	edi
; Line 37
	mov	esi, OFFSET _R3410_2001_paramset
; Line 39
	mov	DWORD PTR _p$[esp+40], 0
	mov	DWORD PTR _q$[esp+40], 0
	mov	DWORD PTR _a$[esp+40], 0
	mov	DWORD PTR _b$[esp+40], 0
	mov	DWORD PTR _x$[esp+40], 0
	mov	DWORD PTR _y$[esp+40], 0
; Line 41
	call	_BN_CTX_new
	mov	edi, eax
; Line 42
	xor	ebp, ebp
	mov	DWORD PTR _ok$1$[esp+40], ebp
; Line 44
	test	edi, edi
	jne	SHORT $LN4@fill_GOST2
; Line 45
	push	45					; 0000002dH
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	101					; 00000065H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 118
	mov	eax, ebp
	pop	edi
	pop	esi
	pop	ebp
; Line 119
	add	esp, 28					; 0000001cH
	ret	0
$LN4@fill_GOST2:
	push	ebx
; Line 49
	push	edi
	call	_BN_CTX_start
; Line 50
	push	edi
	call	_BN_CTX_get
; Line 51
	push	edi
	mov	DWORD PTR _p$[esp+56], eax
	call	_BN_CTX_get
; Line 52
	push	edi
	mov	DWORD PTR _a$[esp+60], eax
	call	_BN_CTX_get
; Line 53
	push	edi
	mov	DWORD PTR _b$[esp+64], eax
	call	_BN_CTX_get
; Line 54
	push	edi
	mov	DWORD PTR _x$[esp+68], eax
	call	_BN_CTX_get
; Line 55
	push	edi
	mov	DWORD PTR _y$[esp+72], eax
	call	_BN_CTX_get
	add	esp, 28					; 0000001cH
	mov	DWORD PTR _q$[esp+44], eax
; Line 56
	cmp	DWORD PTR _p$[esp+44], ebp
	je	$LN6@fill_GOST2
	cmp	DWORD PTR _a$[esp+44], ebp
	je	$LN6@fill_GOST2
	cmp	DWORD PTR _b$[esp+44], ebp
	je	$LN6@fill_GOST2
	cmp	DWORD PTR _x$[esp+44], ebp
	je	$LN6@fill_GOST2
	cmp	DWORD PTR _y$[esp+44], ebp
	je	$LN6@fill_GOST2
	test	eax, eax
	je	$LN6@fill_GOST2
; Line 60
	mov	eax, DWORD PTR _R3410_2001_paramset
	test	eax, eax
	je	SHORT $LN3@fill_GOST2
	mov	ecx, DWORD PTR _nid$[esp+40]
	npad	4
$LL2@fill_GOST2:
	cmp	eax, ecx
	je	SHORT $LN3@fill_GOST2
	mov	eax, DWORD PTR [esi+28]
; Line 61
	add	esi, 28					; 0000001cH
	test	eax, eax
	jne	SHORT $LL2@fill_GOST2
; Line 63
	push	64					; 00000040H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	130					; 00000082H
; Line 65
	jmp	$LN26@fill_GOST2
$LN3@fill_GOST2:
; Line 62
	cmp	DWORD PTR [esi], ebp
	jne	SHORT $LN7@fill_GOST2
; Line 63
	push	64					; 00000040H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	130					; 00000082H
; Line 65
	jmp	$LN26@fill_GOST2
$LN7@fill_GOST2:
; Line 69
	push	DWORD PTR [esi+12]
	lea	eax, DWORD PTR _p$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	$LN9@fill_GOST2
	push	DWORD PTR [esi+4]
	lea	eax, DWORD PTR _a$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	$LN9@fill_GOST2
	push	DWORD PTR [esi+8]
	lea	eax, DWORD PTR _b$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	$LN9@fill_GOST2
; Line 75
	push	edi
	push	DWORD PTR _b$[esp+48]
	push	DWORD PTR _a$[esp+52]
	push	DWORD PTR _p$[esp+56]
	call	_EC_GROUP_new_curve_GFp
	mov	ebx, eax
	add	esp, 16					; 00000010H
; Line 76
	test	ebx, ebx
	jne	SHORT $LN10@fill_GOST2
; Line 77
	push	77					; 0000004dH
; Line 78
	jmp	$LN27@fill_GOST2
$LN10@fill_GOST2:
; Line 81
	push	ebx
	call	_EC_POINT_new
	mov	ebp, eax
	add	esp, 4
; Line 82
	test	ebp, ebp
	jne	SHORT $LN11@fill_GOST2
; Line 83
	push	83					; 00000053H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
	push	101					; 00000065H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
; Line 113
	push	ebx
	call	_EC_GROUP_free
	mov	ebp, DWORD PTR _ok$1$[esp+48]
	add	esp, 4
	jmp	$LN17@fill_GOST2
$LN11@fill_GOST2:
; Line 90
	push	DWORD PTR [esi+20]
	lea	eax, DWORD PTR _x$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	SHORT $LN13@fill_GOST2
	push	DWORD PTR [esi+24]
	lea	eax, DWORD PTR _y$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	SHORT $LN13@fill_GOST2
	push	edi
	push	DWORD PTR _y$[esp+48]
	push	DWORD PTR _x$[esp+52]
	push	ebp
	push	ebx
	call	_EC_POINT_set_affine_coordinates_GFp
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN13@fill_GOST2
	push	DWORD PTR [esi+16]
	lea	eax, DWORD PTR _q$[esp+48]
	push	eax
	call	_BN_hex2bn
	add	esp, 8
	test	eax, eax
	je	SHORT $LN13@fill_GOST2
; Line 101
	push	0
	push	DWORD PTR _q$[esp+48]
	push	ebp
	push	ebx
	call	_EC_GROUP_set_generator
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN14@fill_GOST2
; Line 102
	push	102					; 00000066H
; Line 103
	jmp	SHORT $LN28@fill_GOST2
$LN14@fill_GOST2:
; Line 105
	push	DWORD PTR [esi]
	push	ebx
	call	_EC_GROUP_set_curve_name
; Line 106
	push	ebx
	push	DWORD PTR _eckey$[esp+52]
	call	_EC_KEY_set_group
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN15@fill_GOST2
; Line 107
	push	107					; 0000006bH
; Line 108
	jmp	SHORT $LN28@fill_GOST2
$LN15@fill_GOST2:
; Line 110
	mov	DWORD PTR _ok$1$[esp+44], 1
	jmp	SHORT $err$30
$LN13@fill_GOST2:
; Line 91
	push	91					; 0000005bH
$LN28@fill_GOST2:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
	push	101					; 00000065H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
$err$30:
; Line 112
	push	ebp
	call	_EC_POINT_free
	add	esp, 4
; Line 113
	push	ebx
	call	_EC_GROUP_free
	mov	ebp, DWORD PTR _ok$1$[esp+48]
	add	esp, 4
	jmp	SHORT $LN17@fill_GOST2
$LN9@fill_GOST2:
; Line 70
	push	71					; 00000047H
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	68					; 00000044H
; Line 72
	jmp	SHORT $LN26@fill_GOST2
$LN6@fill_GOST2:
; Line 57
	push	57					; 00000039H
$LN27@fill_GOST2:
	push	OFFSET ??_C@_0BM@CEBOMHLO@?4?2engines?2ccgost?2gost2001?4c?$AA@
	push	65					; 00000041H
$LN26@fill_GOST2:
	push	101					; 00000065H
	call	_ERR_GOST_error
	add	esp, 16					; 00000010H
$LN17@fill_GOST2:
; Line 115
	push	edi
	call	_BN_CTX_end
; Line 116
	push	edi
	call	_BN_CTX_free
	add	esp, 8
; Line 118
	mov	eax, ebp
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp
; Line 119
	add	esp, 28					; 0000001cH
	ret	0
_fill_GOST2001_params ENDP
_TEXT	ENDS
END
