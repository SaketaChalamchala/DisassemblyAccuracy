; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS7_add_attrib_smimecap
PUBLIC	_PKCS7_get_smimecap
PUBLIC	_PKCS7_simple_smimecap
PUBLIC	_PKCS7_add_attrib_content_type
PUBLIC	_PKCS7_add0_attrib_signing_time
PUBLIC	_PKCS7_add1_attrib_digest
PUBLIC	??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@ ; `string'
EXTRN	_sk_push:PROC
EXTRN	_ASN1_TYPE_new:PROC
EXTRN	_ASN1_OBJECT_free:PROC
EXTRN	_ASN1_STRING_new:PROC
EXTRN	_ASN1_STRING_set:PROC
EXTRN	_ASN1_INTEGER_new:PROC
EXTRN	_ASN1_OCTET_STRING_new:PROC
EXTRN	_ASN1_OCTET_STRING_free:PROC
EXTRN	_ASN1_INTEGER_set:PROC
EXTRN	_ASN1_item_d2i:PROC
EXTRN	_ASN1_item_i2d:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_PKCS7_add_signed_attribute:PROC
EXTRN	_PKCS7_get_signed_attribute:PROC
EXTRN	_X509_gmtime_adj:PROC
EXTRN	_X509_ALGOR_new:PROC
EXTRN	_X509_ALGORS_it:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@
CONST	SEGMENT
??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@ DB '.\crypto\pkcs7'
	DB	'\pk7_attr.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add1_attrib_digest
_TEXT	SEGMENT
_si$ = 8						; size = 4
_md$ = 12						; size = 4
_mdlen$ = 16						; size = 4
_PKCS7_add1_attrib_digest PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 153
	push	esi
; Line 155
	call	_ASN1_OCTET_STRING_new
	mov	esi, eax
; Line 156
	test	esi, esi
	je	SHORT $LN6@PKCS7_add1
; Line 159
	push	DWORD PTR _mdlen$[esp]
	push	DWORD PTR _md$[esp+4]
	push	esi
	call	_ASN1_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN4@PKCS7_add1
	push	esi
	push	4
	push	51					; 00000033H
	push	DWORD PTR _si$[esp+12]
	call	_PKCS7_add_signed_attribute
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN4@PKCS7_add1
; Line 164
	mov	eax, 1
	pop	esi
; Line 165
	ret	0
$LN4@PKCS7_add1:
; Line 161
	push	esi
	call	_ASN1_OCTET_STRING_free
	add	esp, 4
$LN6@PKCS7_add1:
; Line 162
	xor	eax, eax
	pop	esi
; Line 165
	ret	0
_PKCS7_add1_attrib_digest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add0_attrib_signing_time
_TEXT	SEGMENT
_si$ = 8						; size = 4
_t$ = 12						; size = 4
_PKCS7_add0_attrib_signing_time PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 142
	mov	eax, DWORD PTR _t$[esp-4]
	test	eax, eax
	jne	SHORT $LN2@PKCS7_add0
	push	eax
	push	eax
	call	_X509_gmtime_adj
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN2@PKCS7_add0
; Line 143
	push	144					; 00000090H
	push	OFFSET ??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@
	push	65					; 00000041H
	push	135					; 00000087H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 145
	xor	eax, eax
; Line 149
	ret	0
$LN2@PKCS7_add0:
; Line 147
	push	eax
	push	23					; 00000017H
	push	52					; 00000034H
	push	DWORD PTR _si$[esp+8]
	call	_PKCS7_add_signed_attribute
	add	esp, 16					; 00000010H
; Line 149
	ret	0
_PKCS7_add0_attrib_signing_time ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_attrib_content_type
_TEXT	SEGMENT
_si$ = 8						; size = 4
_coid$ = 12						; size = 4
_PKCS7_add_attrib_content_type PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 132
	push	50					; 00000032H
	push	DWORD PTR _si$[esp]
	call	_PKCS7_get_signed_attribute
	add	esp, 8
	test	eax, eax
	je	SHORT $LN2@PKCS7_add_
; Line 133
	xor	eax, eax
; Line 138
	ret	0
$LN2@PKCS7_add_:
; Line 134
	mov	eax, DWORD PTR _coid$[esp-4]
	test	eax, eax
	jne	SHORT $LN3@PKCS7_add_
; Line 135
	push	21					; 00000015H
	call	_OBJ_nid2obj
	add	esp, 4
$LN3@PKCS7_add_:
; Line 136
	push	eax
	push	6
	push	50					; 00000032H
	push	DWORD PTR _si$[esp+8]
	call	_PKCS7_add_signed_attribute
	add	esp, 16					; 00000010H
; Line 138
	ret	0
_PKCS7_add_attrib_content_type ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_simple_smimecap
_TEXT	SEGMENT
_sk$ = 8						; size = 4
_nid$ = 12						; size = 4
_arg$ = 16						; size = 4
_PKCS7_simple_smimecap PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 100
	push	esi
; Line 103
	call	_X509_ALGOR_new
	mov	esi, eax
	test	esi, esi
	jne	SHORT $LN2@PKCS7_simp
; Line 104
	push	104					; 00000068H
	push	OFFSET ??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@
	push	65					; 00000041H
	push	119					; 00000077H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 105
	xor	eax, eax
	pop	esi
; Line 128
	ret	0
$LN2@PKCS7_simp:
	push	edi
; Line 107
	push	DWORD PTR [esi]
	call	_ASN1_OBJECT_free
; Line 108
	push	DWORD PTR _nid$[esp+8]
	call	_OBJ_nid2obj
	add	esp, 8
	mov	DWORD PTR [esi], eax
; Line 109
	cmp	DWORD PTR _arg$[esp+4], 0
	jle	SHORT $LN3@PKCS7_simp
; Line 111
	call	_ASN1_TYPE_new
	mov	DWORD PTR [esi+4], eax
	test	eax, eax
	jne	SHORT $LN4@PKCS7_simp
; Line 112
	push	112					; 00000070H
; Line 113
	jmp	SHORT $LN9@PKCS7_simp
$LN4@PKCS7_simp:
; Line 115
	call	_ASN1_INTEGER_new
	mov	edi, eax
	test	edi, edi
	jne	SHORT $LN5@PKCS7_simp
; Line 116
	push	116					; 00000074H
; Line 117
	jmp	SHORT $LN9@PKCS7_simp
$LN5@PKCS7_simp:
; Line 119
	push	DWORD PTR _arg$[esp+4]
	push	edi
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN6@PKCS7_simp
; Line 120
	push	120					; 00000078H
$LN9@PKCS7_simp:
	push	OFFSET ??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@
	push	65					; 00000041H
	push	119					; 00000077H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 121
	xor	eax, eax
	pop	edi
	pop	esi
; Line 128
	ret	0
$LN6@PKCS7_simp:
; Line 123
	mov	eax, DWORD PTR [esi+4]
	mov	DWORD PTR [eax+4], edi
; Line 124
	mov	eax, DWORD PTR [esi+4]
	mov	DWORD PTR [eax], 2
$LN3@PKCS7_simp:
; Line 126
	push	esi
	push	DWORD PTR _sk$[esp+8]
	call	_sk_push
	add	esp, 8
; Line 127
	mov	eax, 1
	pop	edi
	pop	esi
; Line 128
	ret	0
_PKCS7_simple_smimecap ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_get_smimecap
_TEXT	SEGMENT
_p$ = -4						; size = 4
_si$ = 8						; size = 4
_PKCS7_get_smimecap PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 85
	mov	eax, 4
	call	__chkstk
	push	esi
; Line 89
	push	167					; 000000a7H
	push	DWORD PTR _si$[esp+8]
	call	_PKCS7_get_signed_attribute
	mov	esi, eax
	add	esp, 8
; Line 90
	test	esi, esi
	je	SHORT $LN3@PKCS7_get_
	cmp	DWORD PTR [esi], 16			; 00000010H
	jne	SHORT $LN3@PKCS7_get_
; Line 92
	mov	ecx, DWORD PTR [esi+4]
	mov	ecx, DWORD PTR [ecx+8]
	mov	DWORD PTR _p$[esp+8], ecx
; Line 93
	call	_X509_ALGORS_it
	push	eax
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax]
	lea	eax, DWORD PTR _p$[esp+16]
	push	eax
	push	0
	call	_ASN1_item_d2i
	add	esp, 16					; 00000010H
	pop	esi
; Line 96
	pop	ecx
	ret	0
$LN3@PKCS7_get_:
; Line 91
	xor	eax, eax
	pop	esi
; Line 96
	pop	ecx
	ret	0
_PKCS7_get_smimecap ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_attrib_smimecap
_TEXT	SEGMENT
_si$ = 8						; size = 4
_cap$ = 12						; size = 4
_PKCS7_add_attrib_smimecap PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_attr.c
; Line 72
	push	esi
; Line 74
	call	_ASN1_STRING_new
	mov	esi, eax
	test	esi, esi
	jne	SHORT $LN2@PKCS7_add_
; Line 75
	push	75					; 0000004bH
	push	OFFSET ??_C@_0BK@DKHHBKED@?4?2crypto?2pkcs7?2pk7_attr?4c?$AA@
	push	65					; 00000041H
	push	118					; 00000076H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 76
	xor	eax, eax
	pop	esi
; Line 82
	ret	0
$LN2@PKCS7_add_:
; Line 78
	call	_X509_ALGORS_it
	push	eax
	lea	eax, DWORD PTR [esi+8]
	push	eax
	push	DWORD PTR _cap$[esp+8]
	call	_ASN1_item_i2d
; Line 80
	push	esi
	push	16					; 00000010H
	push	167					; 000000a7H
	push	DWORD PTR _si$[esp+24]
	mov	DWORD PTR [esi], eax
	call	_PKCS7_add_signed_attribute
	add	esp, 28					; 0000001cH
	pop	esi
; Line 82
	ret	0
_PKCS7_add_attrib_smimecap ENDP
_TEXT	ENDS
END
