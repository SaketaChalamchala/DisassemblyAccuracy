; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\bf\bf_ecb.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_BF_version
CONST	SEGMENT
_BF_version DB	'Blowfish part of OpenSSL 1.0.2h  3 May 2016', 00H
CONST	ENDS
PUBLIC	_BF_ecb_encrypt
PUBLIC	_BF_options
PUBLIC	??_C@_0O@DJODJJBJ@blowfish?$CIidx?$CJ?$AA@	; `string'
EXTRN	_BF_encrypt:PROC
EXTRN	_BF_decrypt:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0O@DJODJJBJ@blowfish?$CIidx?$CJ?$AA@
CONST	SEGMENT
??_C@_0O@DJODJJBJ@blowfish?$CIidx?$CJ?$AA@ DB 'blowfish(idx)', 00H ; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _BF_options
_TEXT	SEGMENT
_BF_options PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\bf\bf_ecb.c
; Line 78
	mov	eax, OFFSET ??_C@_0O@DJODJJBJ@blowfish?$CIidx?$CJ?$AA@
; Line 80
	ret	0
_BF_options ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _BF_ecb_encrypt
_TEXT	SEGMENT
_d$ = -8						; size = 8
_in$ = 8						; size = 4
_out$ = 12						; size = 4
_key$ = 16						; size = 4
_encrypt$ = 20						; size = 4
_BF_ecb_encrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\bf\bf_ecb.c
; Line 84
	mov	eax, 8
	call	__chkstk
	push	esi
; Line 87
	mov	esi, DWORD PTR _in$[esp+8]
	movzx	ecx, BYTE PTR [esi]
	movzx	eax, BYTE PTR [esi+1]
; Line 89
	movzx	edx, BYTE PTR [esi+4]
	shl	eax, 16					; 00000010H
	shl	ecx, 24					; 00000018H
	or	ecx, eax
	shl	edx, 24					; 00000018H
	movzx	eax, BYTE PTR [esi+2]
	shl	eax, 8
	or	ecx, eax
	movzx	eax, BYTE PTR [esi+3]
	or	ecx, eax
	movzx	eax, BYTE PTR [esi+5]
	mov	DWORD PTR _d$[esp+12], ecx
	movzx	ecx, BYTE PTR [esi+6]
	shl	eax, 16					; 00000010H
	or	edx, eax
	shl	ecx, 8
	movzx	eax, BYTE PTR [esi+7]
	or	ecx, eax
; Line 92
	lea	eax, DWORD PTR _d$[esp+12]
	pop	esi
	push	DWORD PTR _key$[esp+4]
	or	ecx, edx
	cmp	DWORD PTR _encrypt$[esp+8], 0
	mov	DWORD PTR _d$[esp+16], ecx
	push	eax
	je	SHORT $LN2@BF_ecb_enc
	call	_BF_encrypt
	jmp	SHORT $LN5@BF_ecb_enc
$LN2@BF_ecb_enc:
; Line 94
	call	_BF_decrypt
$LN5@BF_ecb_enc:
; Line 96
	mov	edx, DWORD PTR _out$[esp+12]
	add	esp, 8
	mov	ecx, DWORD PTR _d$[esp+8]
	mov	eax, ecx
	shr	eax, 24					; 00000018H
	mov	BYTE PTR [edx], al
	mov	eax, ecx
	shr	eax, 16					; 00000010H
	mov	BYTE PTR [edx+1], al
	mov	eax, ecx
	shr	eax, 8
	mov	BYTE PTR [edx+2], al
	mov	BYTE PTR [edx+3], cl
; Line 98
	mov	ecx, DWORD PTR _d$[esp+12]
	mov	eax, ecx
	shr	eax, 24					; 00000018H
	mov	BYTE PTR [edx+4], al
	mov	eax, ecx
	shr	eax, 16					; 00000010H
	mov	BYTE PTR [edx+5], al
	mov	eax, ecx
	shr	eax, 8
	mov	BYTE PTR [edx+6], al
	mov	BYTE PTR [edx+7], cl
; Line 100
	add	esp, 8
	ret	0
_BF_ecb_encrypt ENDP
_TEXT	ENDS
END
