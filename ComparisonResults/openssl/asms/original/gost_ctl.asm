; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_ctl.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_gost_cmds
PUBLIC	??_C@_0N@FGKNJHPL@CRYPT_PARAMS?$AA@		; `string'
PUBLIC	??_C@_0CI@DFMKNJHI@OID?5of?5default?5GOST?528147?989?5par@ ; `string'
_BSS	SEGMENT
_gost_params DD	01H DUP (?)
_BSS	ENDS
;	COMDAT ??_C@_0CI@DFMKNJHI@OID?5of?5default?5GOST?528147?989?5par@
CONST	SEGMENT
??_C@_0CI@DFMKNJHI@OID?5of?5default?5GOST?528147?989?5par@ DB 'OID of def'
	DB	'ault GOST 28147-89 parameters', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@FGKNJHPL@CRYPT_PARAMS?$AA@
CONST	SEGMENT
??_C@_0N@FGKNJHPL@CRYPT_PARAMS?$AA@ DB 'CRYPT_PARAMS', 00H ; `string'
CONST	ENDS
_DATA	SEGMENT
_gost_envnames DD FLAT:??_C@_0N@FGKNJHPL@CRYPT_PARAMS?$AA@
_DATA	ENDS
CONST	SEGMENT
_gost_cmds DD	0c8H
	DD	FLAT:??_C@_0N@FGKNJHPL@CRYPT_PARAMS?$AA@
	DD	FLAT:??_C@_0CI@DFMKNJHI@OID?5of?5default?5GOST?528147?989?5par@
	DD	02H
	DD	00H
	DD	00H
	DD	00H
	DD	00H
CONST	ENDS
PUBLIC	_gost_control_func
PUBLIC	_get_gost_engine_param
PUBLIC	_gost_set_default_param
PUBLIC	_gost_param_free
EXTRN	__imp__getenv:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_BUF_strdup:PROC
; Function compile flags: /Ogtpy
;	COMDAT _gost_param_free
_TEXT	SEGMENT
_gost_param_free PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_ctl.c
; Line 42
	mov	eax, DWORD PTR _gost_params
	test	eax, eax
	je	SHORT $LN2@gost_param
; Line 43
	push	eax
	call	_CRYPTO_free
	add	esp, 4
; Line 44
	mov	DWORD PTR _gost_params, 0
$LN2@gost_param:
; Line 47
	ret	0
_gost_param_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_set_default_param
_TEXT	SEGMENT
_param$ = 8						; size = 4
_value$ = 12						; size = 4
_gost_set_default_param PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_ctl.c
; Line 78
	push	esi
; Line 80
	mov	esi, DWORD PTR _param$[esp]
	test	esi, esi
	jne	SHORT $LN3@gost_set_d
; Line 82
	push	edi
	push	DWORD PTR _gost_envnames[esi*4]
	call	DWORD PTR __imp__getenv
	mov	edi, eax
	add	esp, 4
; Line 88
	mov	eax, DWORD PTR _gost_params[esi*4]
	test	edi, edi
	cmove	edi, DWORD PTR _value$[esp+4]
	test	eax, eax
	je	SHORT $LN5@gost_set_d
; Line 89
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN5@gost_set_d:
; Line 90
	push	edi
	call	_BUF_strdup
	add	esp, 4
	mov	DWORD PTR _gost_params[esi*4], eax
; Line 92
	mov	eax, 1
	pop	edi
	pop	esi
; Line 93
	ret	0
$LN3@gost_set_d:
; Line 81
	xor	eax, eax
	pop	esi
; Line 93
	ret	0
_gost_set_default_param ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _get_gost_engine_param
_TEXT	SEGMENT
_param$ = 8						; size = 4
_get_gost_engine_param PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_ctl.c
; Line 60
	push	esi
; Line 62
	mov	esi, DWORD PTR _param$[esp]
	test	esi, esi
	jne	SHORT $LN3@get_gost_e
; Line 64
	mov	eax, DWORD PTR _gost_params[esi*4]
	test	eax, eax
	jne	SHORT $LN1@get_gost_e
; Line 67
	push	edi
	push	DWORD PTR _gost_envnames[esi*4]
	call	DWORD PTR __imp__getenv
	mov	edi, eax
	add	esp, 4
; Line 68
	test	edi, edi
	je	SHORT $LN5@get_gost_e
; Line 69
	mov	ecx, DWORD PTR _gost_params[esi*4]
	test	ecx, ecx
	je	SHORT $LN6@get_gost_e
; Line 70
	push	ecx
	call	_CRYPTO_free
	add	esp, 4
$LN6@get_gost_e:
; Line 71
	push	edi
	call	_BUF_strdup
	add	esp, 4
	mov	DWORD PTR _gost_params[esi*4], eax
	pop	edi
$LN1@get_gost_e:
	pop	esi
; Line 75
	ret	0
$LN5@get_gost_e:
	pop	edi
; Line 74
	xor	eax, eax
	pop	esi
; Line 75
	ret	0
$LN3@get_gost_e:
; Line 63
	xor	eax, eax
	pop	esi
; Line 75
	ret	0
_get_gost_engine_param ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _gost_control_func
_TEXT	SEGMENT
_e$ = 8							; size = 4
_cmd$ = 12						; size = 4
_i$ = 16						; size = 4
_p$ = 20						; size = 4
_f$ = 24						; size = 4
_gost_control_func PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\engines\ccgost\gost_ctl.c
; Line 51
	mov	eax, DWORD PTR _cmd$[esp-4]
	add	eax, -200				; ffffff38H
; Line 53
	jne	SHORT $LN3@gost_contr
; Line 55
	push	DWORD PTR _p$[esp-4]
	push	eax
	call	_gost_set_default_param
	add	esp, 8
; Line 57
	ret	0
$LN3@gost_contr:
; Line 54
	or	eax, -1
; Line 57
	ret	0
_gost_control_func ENDP
_TEXT	ENDS
END
