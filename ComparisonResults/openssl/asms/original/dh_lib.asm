; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_DH_version
_BSS	SEGMENT
_default_DH_method DD 01H DUP (?)
_BSS	ENDS
CONST	SEGMENT
_DH_version DB	'Diffie-Hellman part of OpenSSL 1.0.2h  3 May 2016', 00H
CONST	ENDS
PUBLIC	_DH_set_default_method
PUBLIC	_DH_get_default_method
PUBLIC	_DH_set_method
PUBLIC	_DH_new_method
PUBLIC	_DH_new
PUBLIC	_DH_free
PUBLIC	_DH_up_ref
PUBLIC	_DH_size
PUBLIC	_DH_get_ex_new_index
PUBLIC	_DH_set_ex_data
PUBLIC	_DH_get_ex_data
PUBLIC	??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@ ; `string'
EXTRN	_CRYPTO_get_ex_new_index:PROC
EXTRN	_CRYPTO_new_ex_data:PROC
EXTRN	_CRYPTO_free_ex_data:PROC
EXTRN	_CRYPTO_set_ex_data:PROC
EXTRN	_CRYPTO_get_ex_data:PROC
EXTRN	_CRYPTO_add_lock:PROC
EXTRN	_CRYPTO_malloc:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_BN_num_bits:PROC
EXTRN	_BN_clear_free:PROC
EXTRN	_DH_OpenSSL:PROC
EXTRN	_ENGINE_get_DH:PROC
EXTRN	_ENGINE_init:PROC
EXTRN	_ENGINE_finish:PROC
EXTRN	_ENGINE_get_default_DH:PROC
;	COMDAT ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
CONST	SEGMENT
??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@ DB '.\crypto\dh\dh_lib.'
	DB	'c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_get_ex_data
_TEXT	SEGMENT
_d$ = 8							; size = 4
_idx$ = 12						; size = 4
_DH_get_ex_data PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 257
	add	DWORD PTR _d$[esp-4], 60		; 0000003cH
	jmp	_CRYPTO_get_ex_data
_DH_get_ex_data ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_set_ex_data
_TEXT	SEGMENT
_d$ = 8							; size = 4
_idx$ = 12						; size = 4
_arg$ = 16						; size = 4
_DH_set_ex_data PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 252
	add	DWORD PTR _d$[esp-4], 60		; 0000003cH
	jmp	_CRYPTO_set_ex_data
_DH_set_ex_data ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_get_ex_new_index
_TEXT	SEGMENT
_argl$ = 8						; size = 4
_argp$ = 12						; size = 4
_new_func$ = 16						; size = 4
_dup_func$ = 20						; size = 4
_free_func$ = 24					; size = 4
_DH_get_ex_new_index PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 246
	push	DWORD PTR _free_func$[esp-4]
	push	DWORD PTR _dup_func$[esp]
	push	DWORD PTR _new_func$[esp+4]
	push	DWORD PTR _argp$[esp+8]
	push	DWORD PTR _argl$[esp+12]
	push	8
	call	_CRYPTO_get_ex_new_index
	add	esp, 24					; 00000018H
; Line 248
	ret	0
_DH_get_ex_new_index ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_size
_TEXT	SEGMENT
_dh$ = 8						; size = 4
_DH_size PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 262
	mov	eax, DWORD PTR _dh$[esp-4]
	push	DWORD PTR [eax+8]
	call	_BN_num_bits
	add	eax, 7
	add	esp, 4
	cdq
	and	edx, 7
	add	eax, edx
	sar	eax, 3
; Line 263
	ret	0
_DH_size ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_up_ref
_TEXT	SEGMENT
_r$ = 8							; size = 4
_DH_up_ref PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 230
	mov	eax, DWORD PTR _r$[esp-4]
	push	230					; 000000e6H
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	26					; 0000001aH
	add	eax, 56					; 00000038H
	push	1
	push	eax
	call	_CRYPTO_add_lock
; Line 240
	xor	ecx, ecx
	add	esp, 20					; 00000014H
	cmp	eax, 1
	setg	cl
	mov	eax, ecx
; Line 241
	ret	0
_DH_up_ref ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_free
_TEXT	SEGMENT
_r$ = 8							; size = 4
_DH_free PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 183
	push	esi
; Line 185
	mov	esi, DWORD PTR _r$[esp]
	test	esi, esi
	je	$LN1@DH_free
; Line 187
	push	187					; 000000bbH
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	26					; 0000001aH
	lea	eax, DWORD PTR [esi+56]
	push	-1
	push	eax
	call	_CRYPTO_add_lock
	add	esp, 20					; 00000014H
; Line 191
	test	eax, eax
	jg	$LN1@DH_free
; Line 200
	mov	eax, DWORD PTR [esi+68]
	mov	eax, DWORD PTR [eax+20]
	test	eax, eax
	je	SHORT $LN4@DH_free
; Line 201
	push	esi
	call	eax
	add	esp, 4
$LN4@DH_free:
; Line 203
	mov	eax, DWORD PTR [esi+72]
	test	eax, eax
	je	SHORT $LN5@DH_free
; Line 204
	push	eax
	call	_ENGINE_finish
	add	esp, 4
$LN5@DH_free:
; Line 207
	lea	eax, DWORD PTR [esi+60]
	push	eax
	push	esi
	push	8
	call	_CRYPTO_free_ex_data
; Line 209
	mov	eax, DWORD PTR [esi+8]
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN6@DH_free
; Line 210
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN6@DH_free:
; Line 211
	mov	eax, DWORD PTR [esi+12]
	test	eax, eax
	je	SHORT $LN7@DH_free
; Line 212
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN7@DH_free:
; Line 213
	mov	eax, DWORD PTR [esi+36]
	test	eax, eax
	je	SHORT $LN8@DH_free
; Line 214
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN8@DH_free:
; Line 215
	mov	eax, DWORD PTR [esi+40]
	test	eax, eax
	je	SHORT $LN9@DH_free
; Line 216
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN9@DH_free:
; Line 217
	mov	eax, DWORD PTR [esi+44]
	test	eax, eax
	je	SHORT $LN10@DH_free
; Line 218
	push	eax
	call	_CRYPTO_free
	add	esp, 4
$LN10@DH_free:
; Line 219
	mov	eax, DWORD PTR [esi+52]
	test	eax, eax
	je	SHORT $LN11@DH_free
; Line 220
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN11@DH_free:
; Line 221
	mov	eax, DWORD PTR [esi+20]
	test	eax, eax
	je	SHORT $LN12@DH_free
; Line 222
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN12@DH_free:
; Line 223
	mov	eax, DWORD PTR [esi+24]
	test	eax, eax
	je	SHORT $LN13@DH_free
; Line 224
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN13@DH_free:
; Line 225
	push	esi
	call	_CRYPTO_free
	add	esp, 4
$LN1@DH_free:
	pop	esi
; Line 226
	ret	0
_DH_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_new
_TEXT	SEGMENT
_DH_new	PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 119
	push	0
	call	_DH_new_method
	add	esp, 4
; Line 120
	ret	0
_DH_new	ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_new_method
_TEXT	SEGMENT
_engine$ = 8						; size = 4
_DH_new_method PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 123
	push	esi
; Line 126
	push	126					; 0000007eH
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	76					; 0000004cH
	call	_CRYPTO_malloc
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 127
	test	esi, esi
	jne	SHORT $LN2@DH_new_met
; Line 128
	push	128					; 00000080H
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	65					; 00000041H
	push	105					; 00000069H
	push	5
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 129
	xor	eax, eax
	pop	esi
; Line 180
	ret	0
$LN2@DH_new_met:
; Line 82
	mov	eax, DWORD PTR _default_DH_method
	test	eax, eax
	jne	SHORT $LN12@DH_new_met
; Line 89
	call	_DH_OpenSSL
	mov	DWORD PTR _default_DH_method, eax
$LN12@DH_new_met:
	push	edi
; Line 134
	mov	edi, DWORD PTR _engine$[esp+4]
	mov	DWORD PTR [esi+68], eax
	test	edi, edi
	je	SHORT $LN3@DH_new_met
; Line 135
	push	edi
	call	_ENGINE_init
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN5@DH_new_met
; Line 136
	push	136					; 00000088H
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	38					; 00000026H
	push	105					; 00000069H
	push	5
	call	_ERR_put_error
; Line 137
	push	esi
	call	_CRYPTO_free
	add	esp, 24					; 00000018H
; Line 138
	xor	eax, eax
	pop	edi
	pop	esi
; Line 180
	ret	0
$LN5@DH_new_met:
; Line 140
	mov	DWORD PTR [esi+72], edi
; Line 141
	jmp	SHORT $LN4@DH_new_met
$LN3@DH_new_met:
; Line 142
	call	_ENGINE_get_default_DH
	mov	DWORD PTR [esi+72], eax
$LN4@DH_new_met:
; Line 143
	mov	eax, DWORD PTR [esi+72]
	test	eax, eax
	je	SHORT $LN7@DH_new_met
; Line 144
	push	eax
	call	_ENGINE_get_DH
	add	esp, 4
	mov	DWORD PTR [esi+68], eax
; Line 145
	test	eax, eax
	jne	SHORT $LN7@DH_new_met
; Line 146
	push	146					; 00000092H
	push	OFFSET ??_C@_0BF@FEOADHJI@?4?2crypto?2dh?2dh_lib?4c?$AA@
	push	38					; 00000026H
	push	105					; 00000069H
	push	5
	call	_ERR_put_error
; Line 147
	push	DWORD PTR [esi+72]
	call	_ENGINE_finish
; Line 148
	push	esi
	call	_CRYPTO_free
	add	esp, 28					; 0000001cH
; Line 149
	xor	eax, eax
	pop	edi
	pop	esi
; Line 180
	ret	0
$LN7@DH_new_met:
; Line 168
	mov	eax, DWORD PTR [esi+68]
; Line 169
	lea	edi, DWORD PTR [esi+60]
	mov	DWORD PTR [esi], 0
	mov	DWORD PTR [esi+4], 0
	mov	DWORD PTR [esi+8], 0
	mov	DWORD PTR [esi+12], 0
	mov	DWORD PTR [esi+16], 0
	mov	DWORD PTR [esi+20], 0
	mov	DWORD PTR [esi+24], 0
	mov	DWORD PTR [esi+36], 0
	mov	DWORD PTR [esi+40], 0
	mov	DWORD PTR [esi+44], 0
	mov	DWORD PTR [esi+48], 0
	mov	DWORD PTR [esi+52], 0
	mov	DWORD PTR [esi+32], 0
	mov	DWORD PTR [esi+56], 1
	mov	eax, DWORD PTR [eax+24]
	push	edi
	and	eax, -1025				; fffffbffH
	push	esi
	push	8
	mov	DWORD PTR [esi+28], eax
	call	_CRYPTO_new_ex_data
; Line 170
	mov	eax, DWORD PTR [esi+68]
	add	esp, 12					; 0000000cH
	mov	eax, DWORD PTR [eax+16]
	test	eax, eax
	je	SHORT $LN8@DH_new_met
	push	esi
	call	eax
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN8@DH_new_met
; Line 172
	mov	eax, DWORD PTR [esi+72]
	test	eax, eax
	je	SHORT $LN9@DH_new_met
; Line 173
	push	eax
	call	_ENGINE_finish
	add	esp, 4
$LN9@DH_new_met:
; Line 175
	push	edi
	push	esi
	push	8
	call	_CRYPTO_free_ex_data
; Line 176
	push	esi
	call	_CRYPTO_free
	add	esp, 16					; 00000010H
; Line 177
	xor	esi, esi
$LN8@DH_new_met:
; Line 179
	pop	edi
	mov	eax, esi
	pop	esi
; Line 180
	ret	0
_DH_new_method ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_set_method
_TEXT	SEGMENT
_dh$ = 8						; size = 4
_meth$ = 12						; size = 4
_DH_set_method PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 96
	push	esi
; Line 102
	mov	esi, DWORD PTR _dh$[esp]
	mov	eax, DWORD PTR [esi+68]
; Line 103
	mov	eax, DWORD PTR [eax+20]
	test	eax, eax
	je	SHORT $LN2@DH_set_met
; Line 104
	push	esi
	call	eax
	add	esp, 4
$LN2@DH_set_met:
; Line 106
	mov	eax, DWORD PTR [esi+72]
	test	eax, eax
	je	SHORT $LN3@DH_set_met
; Line 107
	push	eax
	call	_ENGINE_finish
	add	esp, 4
; Line 108
	mov	DWORD PTR [esi+72], 0
$LN3@DH_set_met:
; Line 111
	mov	eax, DWORD PTR _meth$[esp]
	mov	DWORD PTR [esi+68], eax
; Line 112
	mov	eax, DWORD PTR [eax+16]
	test	eax, eax
	je	SHORT $LN6@DH_set_met
; Line 113
	push	esi
	call	eax
	add	esp, 4
$LN6@DH_set_met:
; Line 114
	mov	eax, 1
	pop	esi
; Line 115
	ret	0
_DH_set_method ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_get_default_method
_TEXT	SEGMENT
_DH_get_default_method PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 82
	mov	eax, DWORD PTR _default_DH_method
	test	eax, eax
	jne	SHORT $LN2@DH_get_def
; Line 89
	call	_DH_OpenSSL
	mov	DWORD PTR _default_DH_method, eax
$LN2@DH_get_def:
; Line 93
	ret	0
_DH_get_default_method ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _DH_set_default_method
_TEXT	SEGMENT
_meth$ = 8						; size = 4
_DH_set_default_method PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\dh\dh_lib.c
; Line 77
	mov	eax, DWORD PTR _meth$[esp-4]
	mov	DWORD PTR _default_DH_method, eax
; Line 78
	ret	0
_DH_set_default_method ENDP
_TEXT	ENDS
END
