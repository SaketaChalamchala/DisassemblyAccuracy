; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_TS_REQ_set_version
PUBLIC	_TS_REQ_get_version
PUBLIC	_TS_REQ_set_msg_imprint
PUBLIC	_TS_REQ_get_msg_imprint
PUBLIC	_TS_MSG_IMPRINT_set_algo
PUBLIC	_TS_MSG_IMPRINT_get_algo
PUBLIC	_TS_MSG_IMPRINT_set_msg
PUBLIC	_TS_MSG_IMPRINT_get_msg
PUBLIC	_TS_REQ_set_policy_id
PUBLIC	_TS_REQ_get_policy_id
PUBLIC	_TS_REQ_set_nonce
PUBLIC	_TS_REQ_get_nonce
PUBLIC	_TS_REQ_set_cert_req
PUBLIC	_TS_REQ_get_cert_req
PUBLIC	_TS_REQ_get_exts
PUBLIC	_TS_REQ_ext_free
PUBLIC	_TS_REQ_get_ext_count
PUBLIC	_TS_REQ_get_ext_by_NID
PUBLIC	_TS_REQ_get_ext_by_OBJ
PUBLIC	_TS_REQ_get_ext_by_critical
PUBLIC	_TS_REQ_get_ext
PUBLIC	_TS_REQ_delete_ext
PUBLIC	_TS_REQ_add_ext
PUBLIC	_TS_REQ_get_ext_d2i
PUBLIC	??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@ ; `string'
EXTRN	_sk_pop_free:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_OBJECT_free:PROC
EXTRN	_ASN1_INTEGER_free:PROC
EXTRN	_ASN1_INTEGER_dup:PROC
EXTRN	_ASN1_OCTET_STRING_set:PROC
EXTRN	_ASN1_INTEGER_set:PROC
EXTRN	_ASN1_INTEGER_get:PROC
EXTRN	_OBJ_dup:PROC
EXTRN	_X509_ALGOR_dup:PROC
EXTRN	_X509_ALGOR_free:PROC
EXTRN	_X509_EXTENSION_free:PROC
EXTRN	_X509v3_get_ext_count:PROC
EXTRN	_X509v3_get_ext_by_NID:PROC
EXTRN	_X509v3_get_ext_by_OBJ:PROC
EXTRN	_X509v3_get_ext_by_critical:PROC
EXTRN	_X509v3_get_ext:PROC
EXTRN	_X509v3_delete_ext:PROC
EXTRN	_X509v3_add_ext:PROC
EXTRN	_X509V3_get_d2i:PROC
EXTRN	_TS_MSG_IMPRINT_free:PROC
EXTRN	_TS_MSG_IMPRINT_dup:PROC
;	COMDAT ??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@
CONST	SEGMENT
??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@ DB '.\crypto\ts\t'
	DB	's_req_utils.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext_d2i
_TEXT	SEGMENT
_a$ = 8							; size = 4
_nid$ = 12						; size = 4
_crit$ = 16						; size = 4
_idx$ = 20						; size = 4
_TS_REQ_get_ext_d2i PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 231
	push	DWORD PTR _idx$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _crit$[esp]
	push	DWORD PTR _nid$[esp+4]
	push	DWORD PTR [eax+20]
	call	_X509V3_get_d2i
	add	esp, 16					; 00000010H
; Line 232
	ret	0
_TS_REQ_get_ext_d2i ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_add_ext
_TEXT	SEGMENT
_a$ = 8							; size = 4
_ex$ = 12						; size = 4
_loc$ = 16						; size = 4
_TS_REQ_add_ext PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 226
	push	DWORD PTR _loc$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _ex$[esp]
	add	eax, 20					; 00000014H
	push	eax
	call	_X509v3_add_ext
	add	esp, 12					; 0000000cH
	neg	eax
	sbb	eax, eax
	neg	eax
; Line 227
	ret	0
_TS_REQ_add_ext ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_delete_ext
_TEXT	SEGMENT
_a$ = 8							; size = 4
_loc$ = 12						; size = 4
_TS_REQ_delete_ext PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 221
	mov	eax, DWORD PTR _a$[esp-4]
	push	DWORD PTR _loc$[esp-4]
	push	DWORD PTR [eax+20]
	call	_X509v3_delete_ext
	add	esp, 8
; Line 222
	ret	0
_TS_REQ_delete_ext ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext
_TEXT	SEGMENT
_a$ = 8							; size = 4
_loc$ = 12						; size = 4
_TS_REQ_get_ext PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 216
	mov	eax, DWORD PTR _a$[esp-4]
	push	DWORD PTR _loc$[esp-4]
	push	DWORD PTR [eax+20]
	call	_X509v3_get_ext
	add	esp, 8
; Line 217
	ret	0
_TS_REQ_get_ext ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext_by_critical
_TEXT	SEGMENT
_a$ = 8							; size = 4
_crit$ = 12						; size = 4
_lastpos$ = 16						; size = 4
_TS_REQ_get_ext_by_critical PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 211
	push	DWORD PTR _lastpos$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _crit$[esp]
	push	DWORD PTR [eax+20]
	call	_X509v3_get_ext_by_critical
	add	esp, 12					; 0000000cH
; Line 212
	ret	0
_TS_REQ_get_ext_by_critical ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext_by_OBJ
_TEXT	SEGMENT
_a$ = 8							; size = 4
_obj$ = 12						; size = 4
_lastpos$ = 16						; size = 4
_TS_REQ_get_ext_by_OBJ PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 206
	push	DWORD PTR _lastpos$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _obj$[esp]
	push	DWORD PTR [eax+20]
	call	_X509v3_get_ext_by_OBJ
	add	esp, 12					; 0000000cH
; Line 207
	ret	0
_TS_REQ_get_ext_by_OBJ ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext_by_NID
_TEXT	SEGMENT
_a$ = 8							; size = 4
_nid$ = 12						; size = 4
_lastpos$ = 16						; size = 4
_TS_REQ_get_ext_by_NID PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 201
	push	DWORD PTR _lastpos$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _nid$[esp]
	push	DWORD PTR [eax+20]
	call	_X509v3_get_ext_by_NID
	add	esp, 12					; 0000000cH
; Line 202
	ret	0
_TS_REQ_get_ext_by_NID ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_ext_count
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_ext_count PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 196
	mov	eax, DWORD PTR _a$[esp-4]
	push	DWORD PTR [eax+20]
	call	_X509v3_get_ext_count
	add	esp, 4
; Line 197
	ret	0
_TS_REQ_get_ext_count ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_ext_free
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_ext_free PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 187
	push	esi
; Line 188
	mov	esi, DWORD PTR _a$[esp]
	test	esi, esi
	je	SHORT $LN1@TS_REQ_ext
; Line 190
	push	OFFSET _X509_EXTENSION_free
	push	DWORD PTR [esi+20]
	call	_sk_pop_free
	add	esp, 8
; Line 191
	mov	DWORD PTR [esi+20], 0
$LN1@TS_REQ_ext:
	pop	esi
; Line 192
	ret	0
_TS_REQ_ext_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_exts
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_exts PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 183
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax+20]
; Line 184
	ret	0
_TS_REQ_get_exts ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_cert_req
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_cert_req PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 178
	mov	ecx, DWORD PTR _a$[esp-4]
	xor	eax, eax
	cmp	DWORD PTR [ecx+16], eax
	setne	al
; Line 179
	ret	0
_TS_REQ_get_cert_req ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_set_cert_req
_TEXT	SEGMENT
_a$ = 8							; size = 4
_cert_req$ = 12						; size = 4
_TS_REQ_set_cert_req PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 172
	mov	ecx, DWORD PTR _cert_req$[esp-4]
	mov	eax, DWORD PTR _a$[esp-4]
	neg	ecx
	sbb	ecx, ecx
	and	ecx, 255				; 000000ffH
	mov	DWORD PTR [eax+16], ecx
; Line 173
	mov	eax, 1
; Line 174
	ret	0
_TS_REQ_set_cert_req ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_nonce
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_nonce PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 167
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax+12]
; Line 168
	ret	0
_TS_REQ_get_nonce ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_set_nonce
_TEXT	SEGMENT
_a$ = 8							; size = 4
_nonce$ = 12						; size = 4
_TS_REQ_set_nonce PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 153
	mov	eax, DWORD PTR _nonce$[esp-4]
	push	esi
	mov	esi, DWORD PTR _a$[esp]
	cmp	DWORD PTR [esi+12], eax
	jne	SHORT $LN2@TS_REQ_set
; Line 154
	mov	eax, 1
	pop	esi
; Line 163
	ret	0
$LN2@TS_REQ_set:
	push	edi
; Line 155
	push	eax
	call	_ASN1_INTEGER_dup
	mov	edi, eax
	add	esp, 4
; Line 156
	test	edi, edi
	jne	SHORT $LN3@TS_REQ_set
; Line 157
	push	157					; 0000009dH
	push	OFFSET ??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@
	push	65					; 00000041H
	push	120					; 00000078H
	push	47					; 0000002fH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 158
	xor	eax, eax
	pop	edi
	pop	esi
; Line 163
	ret	0
$LN3@TS_REQ_set:
; Line 160
	push	DWORD PTR [esi+12]
	call	_ASN1_INTEGER_free
	add	esp, 4
; Line 161
	mov	DWORD PTR [esi+12], edi
; Line 162
	mov	eax, 1
	pop	edi
	pop	esi
; Line 163
	ret	0
_TS_REQ_set_nonce ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_policy_id
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_policy_id PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 146
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax+8]
; Line 147
	ret	0
_TS_REQ_get_policy_id ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_set_policy_id
_TEXT	SEGMENT
_a$ = 8							; size = 4
_policy$ = 12						; size = 4
_TS_REQ_set_policy_id PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 132
	mov	eax, DWORD PTR _policy$[esp-4]
	push	esi
	mov	esi, DWORD PTR _a$[esp]
	cmp	DWORD PTR [esi+8], eax
	jne	SHORT $LN2@TS_REQ_set
; Line 133
	mov	eax, 1
	pop	esi
; Line 142
	ret	0
$LN2@TS_REQ_set:
	push	edi
; Line 134
	push	eax
	call	_OBJ_dup
	mov	edi, eax
	add	esp, 4
; Line 135
	test	edi, edi
	jne	SHORT $LN3@TS_REQ_set
; Line 136
	push	136					; 00000088H
	push	OFFSET ??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@
	push	65					; 00000041H
	push	121					; 00000079H
	push	47					; 0000002fH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 137
	xor	eax, eax
	pop	edi
	pop	esi
; Line 142
	ret	0
$LN3@TS_REQ_set:
; Line 139
	push	DWORD PTR [esi+8]
	call	_ASN1_OBJECT_free
	add	esp, 4
; Line 140
	mov	DWORD PTR [esi+8], edi
; Line 141
	mov	eax, 1
	pop	edi
	pop	esi
; Line 142
	ret	0
_TS_REQ_set_policy_id ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_MSG_IMPRINT_get_msg
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_MSG_IMPRINT_get_msg PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 125
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax+4]
; Line 126
	ret	0
_TS_MSG_IMPRINT_get_msg ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_MSG_IMPRINT_set_msg
_TEXT	SEGMENT
_a$ = 8							; size = 4
_d$ = 12						; size = 4
_len$ = 16						; size = 4
_TS_MSG_IMPRINT_set_msg PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 120
	push	DWORD PTR _len$[esp-4]
	mov	eax, DWORD PTR _a$[esp]
	push	DWORD PTR _d$[esp]
	push	DWORD PTR [eax+4]
	call	_ASN1_OCTET_STRING_set
	add	esp, 12					; 0000000cH
; Line 121
	ret	0
_TS_MSG_IMPRINT_set_msg ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_MSG_IMPRINT_get_algo
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_MSG_IMPRINT_get_algo PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 115
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax]
; Line 116
	ret	0
_TS_MSG_IMPRINT_get_algo ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_MSG_IMPRINT_set_algo
_TEXT	SEGMENT
_a$ = 8							; size = 4
_alg$ = 12						; size = 4
_TS_MSG_IMPRINT_set_algo PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 101
	mov	eax, DWORD PTR _alg$[esp-4]
	push	esi
	mov	esi, DWORD PTR _a$[esp]
	cmp	DWORD PTR [esi], eax
	jne	SHORT $LN2@TS_MSG_IMP
; Line 102
	mov	eax, 1
	pop	esi
; Line 111
	ret	0
$LN2@TS_MSG_IMP:
	push	edi
; Line 103
	push	eax
	call	_X509_ALGOR_dup
	mov	edi, eax
	add	esp, 4
; Line 104
	test	edi, edi
	jne	SHORT $LN3@TS_MSG_IMP
; Line 105
	push	105					; 00000069H
	push	OFFSET ??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@
	push	65					; 00000041H
	push	118					; 00000076H
	push	47					; 0000002fH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 106
	xor	eax, eax
	pop	edi
	pop	esi
; Line 111
	ret	0
$LN3@TS_MSG_IMP:
; Line 108
	push	DWORD PTR [esi]
	call	_X509_ALGOR_free
	add	esp, 4
; Line 109
	mov	DWORD PTR [esi], edi
; Line 110
	mov	eax, 1
	pop	edi
	pop	esi
; Line 111
	ret	0
_TS_MSG_IMPRINT_set_algo ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_msg_imprint
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_msg_imprint PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 94
	mov	eax, DWORD PTR _a$[esp-4]
	mov	eax, DWORD PTR [eax+4]
; Line 95
	ret	0
_TS_REQ_get_msg_imprint ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_set_msg_imprint
_TEXT	SEGMENT
_a$ = 8							; size = 4
_msg_imprint$ = 12					; size = 4
_TS_REQ_set_msg_imprint PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 80
	mov	eax, DWORD PTR _msg_imprint$[esp-4]
	push	esi
	mov	esi, DWORD PTR _a$[esp]
	cmp	DWORD PTR [esi+4], eax
	jne	SHORT $LN2@TS_REQ_set
; Line 81
	mov	eax, 1
	pop	esi
; Line 90
	ret	0
$LN2@TS_REQ_set:
	push	edi
; Line 82
	push	eax
	call	_TS_MSG_IMPRINT_dup
	mov	edi, eax
	add	esp, 4
; Line 83
	test	edi, edi
	jne	SHORT $LN3@TS_REQ_set
; Line 84
	push	84					; 00000054H
	push	OFFSET ??_C@_0BL@KOFPGLLD@?4?2crypto?2ts?2ts_req_utils?4c?$AA@
	push	65					; 00000041H
	push	119					; 00000077H
	push	47					; 0000002fH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 85
	xor	eax, eax
	pop	edi
	pop	esi
; Line 90
	ret	0
$LN3@TS_REQ_set:
; Line 87
	push	DWORD PTR [esi+4]
	call	_TS_MSG_IMPRINT_free
	add	esp, 4
; Line 88
	mov	DWORD PTR [esi+4], edi
; Line 89
	mov	eax, 1
	pop	edi
	pop	esi
; Line 90
	ret	0
_TS_REQ_set_msg_imprint ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_get_version
_TEXT	SEGMENT
_a$ = 8							; size = 4
_TS_REQ_get_version PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 73
	mov	eax, DWORD PTR _a$[esp-4]
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_get
	add	esp, 4
; Line 74
	ret	0
_TS_REQ_get_version ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_REQ_set_version
_TEXT	SEGMENT
_a$ = 8							; size = 4
_version$ = 12						; size = 4
_TS_REQ_set_version PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_req_utils.c
; Line 68
	mov	eax, DWORD PTR _a$[esp-4]
	push	DWORD PTR _version$[esp-4]
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 8
; Line 69
	ret	0
_TS_REQ_set_version ENDP
_TEXT	ENDS
END
