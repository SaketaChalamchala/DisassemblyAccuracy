; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\evp\p_verify.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_EVP_VerifyFinal
PUBLIC	??_C@_0BI@EBBNMGHM@?4?2crypto?2evp?2p_verify?4c?$AA@ ; `string'
EXTRN	_ERR_put_error:PROC
EXTRN	_EVP_MD_CTX_init:PROC
EXTRN	_EVP_MD_CTX_cleanup:PROC
EXTRN	_EVP_MD_CTX_copy_ex:PROC
EXTRN	_EVP_DigestFinal_ex:PROC
EXTRN	_EVP_PKEY_CTX_new:PROC
EXTRN	_EVP_PKEY_CTX_free:PROC
EXTRN	_EVP_PKEY_CTX_ctrl:PROC
EXTRN	_EVP_PKEY_verify_init:PROC
EXTRN	_EVP_PKEY_verify:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0BI@EBBNMGHM@?4?2crypto?2evp?2p_verify?4c?$AA@
CONST	SEGMENT
??_C@_0BI@EBBNMGHM@?4?2crypto?2evp?2p_verify?4c?$AA@ DB '.\crypto\evp\p_v'
	DB	'erify.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _EVP_VerifyFinal
_TEXT	SEGMENT
_sigbuf$GSCopy$1$ = -100				; size = 4
_m_len$ = -96						; size = 4
_tmp_ctx$ = -92						; size = 24
_m$ = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_ctx$ = 8						; size = 4
_sigbuf$ = 12						; size = 4
_siglen$ = 16						; size = 4
_pkey$ = 20						; size = 4
_EVP_VerifyFinal PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\evp\p_verify.c
; Line 67
	mov	eax, 100				; 00000064H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+100], eax
	mov	eax, DWORD PTR _sigbuf$[esp+96]
	push	ebx
	push	ebp
	mov	ebp, DWORD PTR _ctx$[esp+104]
; Line 70
	xor	ebx, ebx
	push	esi
	mov	DWORD PTR _sigbuf$GSCopy$1$[esp+112], eax
; Line 72
	xor	esi, esi
	push	edi
	mov	edi, DWORD PTR _pkey$[esp+112]
; Line 74
	lea	eax, DWORD PTR _tmp_ctx$[esp+116]
	push	eax
	call	_EVP_MD_CTX_init
; Line 75
	lea	eax, DWORD PTR _tmp_ctx$[esp+120]
	push	ebp
	push	eax
	call	_EVP_MD_CTX_copy_ex
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
; Line 77
	lea	eax, DWORD PTR _m_len$[esp+116]
	push	eax
	lea	eax, DWORD PTR _m$[esp+120]
	push	eax
	lea	eax, DWORD PTR _tmp_ctx$[esp+124]
	push	eax
	call	_EVP_DigestFinal_ex
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$24
; Line 79
	lea	eax, DWORD PTR _tmp_ctx$[esp+116]
	push	eax
	call	_EVP_MD_CTX_cleanup
; Line 81
	mov	esi, DWORD PTR [ebp]
	add	esp, 4
	test	BYTE PTR [esi+12], 4
	je	SHORT $LN7@EVP_Verify
; Line 83
	push	0
	push	edi
	or	ebx, -1
	call	_EVP_PKEY_CTX_new
	mov	esi, eax
	add	esp, 8
; Line 84
	test	esi, esi
	je	SHORT $err$24
; Line 86
	push	esi
	call	_EVP_PKEY_verify_init
	add	esp, 4
	test	eax, eax
	jle	SHORT $err$24
; Line 88
	push	DWORD PTR [ebp]
	push	0
	push	1
	push	248					; 000000f8H
	push	ebx
	push	esi
	call	_EVP_PKEY_CTX_ctrl
	add	esp, 24					; 00000018H
	test	eax, eax
	jle	SHORT $err$24
; Line 90
	push	DWORD PTR _m_len$[esp+116]
	lea	eax, DWORD PTR _m$[esp+120]
	push	eax
	push	DWORD PTR _siglen$[esp+120]
	push	DWORD PTR _sigbuf$GSCopy$1$[esp+128]
	push	esi
	call	_EVP_PKEY_verify
	add	esp, 20					; 00000014H
	mov	ebx, eax
$err$24:
; Line 92
	push	esi
	call	_EVP_PKEY_CTX_free
	add	esp, 4
; Line 93
	mov	eax, ebx
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 116
	mov	ecx, DWORD PTR __$ArrayPad$[esp+100]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 100				; 00000064H
	ret	0
$LN7@EVP_Verify:
; Line 96
	xor	eax, eax
	lea	ecx, DWORD PTR [esi+44]
	npad	2
$LL4@EVP_Verify:
; Line 97
	mov	edx, DWORD PTR [ecx]
; Line 98
	test	edx, edx
	je	SHORT $LN22@EVP_Verify
; Line 100
	cmp	DWORD PTR [edi], edx
	je	SHORT $LN13@EVP_Verify
; Line 96
	inc	eax
	add	ecx, 4
	cmp	eax, 4
	jl	SHORT $LL4@EVP_Verify
$LN22@EVP_Verify:
; Line 106
	push	106					; 0000006aH
	push	OFFSET ??_C@_0BI@EBBNMGHM@?4?2crypto?2evp?2p_verify?4c?$AA@
	push	110					; 0000006eH
	push	108					; 0000006cH
	push	6
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 107
	or	eax, -1
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 116
	mov	ecx, DWORD PTR __$ArrayPad$[esp+100]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 100				; 00000064H
	ret	0
$LN13@EVP_Verify:
; Line 109
	mov	eax, DWORD PTR [esi+40]
	test	eax, eax
	jne	SHORT $LN14@EVP_Verify
; Line 110
	push	110					; 0000006eH
	push	OFFSET ??_C@_0BI@EBBNMGHM@?4?2crypto?2evp?2p_verify?4c?$AA@
	push	105					; 00000069H
	push	108					; 0000006cH
	push	6
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 111
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 116
	mov	ecx, DWORD PTR __$ArrayPad$[esp+100]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 100				; 00000064H
	ret	0
$LN14@EVP_Verify:
; Line 114
	push	DWORD PTR [edi+20]
	lea	ecx, DWORD PTR _m$[esp+120]
	push	DWORD PTR _siglen$[esp+116]
	push	DWORD PTR _sigbuf$GSCopy$1$[esp+124]
	push	DWORD PTR _m_len$[esp+128]
	push	ecx
	push	DWORD PTR [esi]
	call	eax
; Line 116
	mov	ecx, DWORD PTR __$ArrayPad$[esp+140]
	add	esp, 24					; 00000018H
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 100				; 00000064H
	ret	0
_EVP_VerifyFinal ENDP
_TEXT	ENDS
END
