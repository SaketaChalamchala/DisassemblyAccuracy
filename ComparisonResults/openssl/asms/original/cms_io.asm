; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PEM_read_bio_CMS
PUBLIC	_PEM_read_CMS
PUBLIC	_PEM_write_bio_CMS
PUBLIC	_PEM_write_CMS
PUBLIC	_CMS_stream
PUBLIC	_d2i_CMS_bio
PUBLIC	_i2d_CMS_bio
PUBLIC	_BIO_new_CMS
PUBLIC	_i2d_CMS_bio_stream
PUBLIC	_PEM_write_bio_CMS_stream
PUBLIC	_SMIME_read_CMS
PUBLIC	_SMIME_write_CMS
PUBLIC	??_C@_0BG@BBPCNJCA@?4?2crypto?2cms?2cms_io?4c?$AA@ ; `string'
PUBLIC	??_C@_03LOMOMHDE@CMS?$AA@			; `string'
EXTRN	_ASN1_OCTET_STRING_new:PROC
EXTRN	_ASN1_item_d2i_bio:PROC
EXTRN	_ASN1_item_i2d_bio:PROC
EXTRN	_BIO_new_NDEF:PROC
EXTRN	_i2d_ASN1_bio_stream:PROC
EXTRN	_PEM_write_bio_ASN1_stream:PROC
EXTRN	_SMIME_write_ASN1:PROC
EXTRN	_SMIME_read_ASN1:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_PEM_ASN1_read_bio:PROC
EXTRN	_PEM_ASN1_write_bio:PROC
EXTRN	_PEM_ASN1_read:PROC
EXTRN	_PEM_ASN1_write:PROC
EXTRN	_d2i_CMS_ContentInfo:PROC
EXTRN	_i2d_CMS_ContentInfo:PROC
EXTRN	_CMS_ContentInfo_it:PROC
EXTRN	_CMS_get0_content:PROC
EXTRN	_CMS_get0_eContentType:PROC
;	COMDAT ??_C@_03LOMOMHDE@CMS?$AA@
CONST	SEGMENT
??_C@_03LOMOMHDE@CMS?$AA@ DB 'CMS', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@BBPCNJCA@?4?2crypto?2cms?2cms_io?4c?$AA@
CONST	SEGMENT
??_C@_0BG@BBPCNJCA@?4?2crypto?2cms?2cms_io?4c?$AA@ DB '.\crypto\cms\cms_i'
	DB	'o.c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _SMIME_write_CMS
_TEXT	SEGMENT
_bio$ = 8						; size = 4
_cms$ = 12						; size = 4
_data$ = 16						; size = 4
_flags$ = 20						; size = 4
_SMIME_write_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 114
	push	ebx
	push	ebp
	push	esi
; Line 116
	mov	esi, DWORD PTR _cms$[esp+8]
	push	edi
	push	DWORD PTR [esi]
	call	_OBJ_obj2nid
; Line 117
	push	esi
	mov	ebx, eax
	call	_CMS_get0_eContentType
	push	eax
	call	_OBJ_obj2nid
	add	esp, 12					; 0000000cH
	mov	ebp, eax
; Line 118
	cmp	ebx, 22					; 00000016H
	jne	SHORT $LN2@SMIME_writ
; Line 119
	mov	ecx, DWORD PTR [esi+4]
	mov	edi, DWORD PTR [ecx+4]
	jmp	SHORT $LN3@SMIME_writ
$LN2@SMIME_writ:
; Line 121
	xor	edi, edi
$LN3@SMIME_writ:
; Line 123
	call	_CMS_ContentInfo_it
	push	eax
	push	edi
	push	ebp
	push	ebx
	push	DWORD PTR _flags$[esp+28]
	push	DWORD PTR _data$[esp+32]
	push	esi
	push	DWORD PTR _bio$[esp+40]
	call	_SMIME_write_ASN1
	add	esp, 32					; 00000020H
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 126
	ret	0
_SMIME_write_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _SMIME_read_CMS
_TEXT	SEGMENT
_bio$ = 8						; size = 4
_bcont$ = 12						; size = 4
_SMIME_read_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 130
	call	_CMS_ContentInfo_it
	push	eax
	push	DWORD PTR _bcont$[esp]
	push	DWORD PTR _bio$[esp+4]
	call	_SMIME_read_ASN1
	add	esp, 12					; 0000000cH
; Line 133
	ret	0
_SMIME_read_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PEM_write_bio_CMS_stream
_TEXT	SEGMENT
_out$ = 8						; size = 4
_cms$ = 12						; size = 4
_in$ = 16						; size = 4
_flags$ = 20						; size = 4
_PEM_write_bio_CMS_stream PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 109
	call	_CMS_ContentInfo_it
	push	eax
	push	OFFSET ??_C@_03LOMOMHDE@CMS?$AA@
	push	DWORD PTR _flags$[esp+4]
	push	DWORD PTR _in$[esp+8]
	push	DWORD PTR _cms$[esp+12]
	push	DWORD PTR _out$[esp+16]
	call	_PEM_write_bio_ASN1_stream
	add	esp, 24					; 00000018H
; Line 111
	ret	0
_PEM_write_bio_CMS_stream ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_CMS_bio_stream
_TEXT	SEGMENT
_out$ = 8						; size = 4
_cms$ = 12						; size = 4
_in$ = 16						; size = 4
_flags$ = 20						; size = 4
_i2d_CMS_bio_stream PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 102
	call	_CMS_ContentInfo_it
	push	eax
	push	DWORD PTR _flags$[esp]
	push	DWORD PTR _in$[esp+4]
	push	DWORD PTR _cms$[esp+8]
	push	DWORD PTR _out$[esp+12]
	call	_i2d_ASN1_bio_stream
	add	esp, 20					; 00000014H
; Line 104
	ret	0
_i2d_CMS_bio_stream ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _BIO_new_CMS
_TEXT	SEGMENT
_out$ = 8						; size = 4
_cms$ = 12						; size = 4
_BIO_new_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 94
	call	_CMS_ContentInfo_it
	push	eax
	push	DWORD PTR _cms$[esp]
	push	DWORD PTR _out$[esp+4]
	call	_BIO_new_NDEF
	add	esp, 12					; 0000000cH
; Line 96
	ret	0
_BIO_new_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_CMS_bio
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_cms$ = 12						; size = 4
_i2d_CMS_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 87
	push	DWORD PTR _cms$[esp-4]
	push	DWORD PTR _bp$[esp]
	call	_CMS_ContentInfo_it
	push	eax
	call	_ASN1_item_i2d_bio
	add	esp, 12					; 0000000cH
; Line 88
	ret	0
_i2d_CMS_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _d2i_CMS_bio
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_cms$ = 12						; size = 4
_d2i_CMS_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 82
	push	DWORD PTR _cms$[esp-4]
	push	DWORD PTR _bp$[esp]
	call	_CMS_ContentInfo_it
	push	eax
	call	_ASN1_item_d2i_bio
	add	esp, 12					; 0000000cH
; Line 83
	ret	0
_d2i_CMS_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_stream
_TEXT	SEGMENT
_boundary$ = 8						; size = 4
_cms$ = 12						; size = 4
_CMS_stream PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 63
	push	esi
; Line 65
	push	DWORD PTR _cms$[esp]
	call	_CMS_get0_content
	mov	esi, eax
	add	esp, 4
; Line 66
	test	esi, esi
	je	SHORT $LN7@CMS_stream
; Line 68
	cmp	DWORD PTR [esi], 0
	jne	SHORT $LN6@CMS_stream
; Line 69
	call	_ASN1_OCTET_STRING_new
	mov	DWORD PTR [esi], eax
; Line 70
	test	eax, eax
	jne	SHORT $LN6@CMS_stream
; Line 76
	push	76					; 0000004cH
	push	OFFSET ??_C@_0BG@BBPCNJCA@?4?2crypto?2cms?2cms_io?4c?$AA@
	push	65					; 00000041H
	push	155					; 0000009bH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN7@CMS_stream:
; Line 77
	xor	eax, eax
	pop	esi
; Line 78
	ret	0
$LN6@CMS_stream:
; Line 71
	mov	eax, DWORD PTR [esi]
	or	DWORD PTR [eax+12], 16			; 00000010H
; Line 72
	mov	eax, DWORD PTR [esi]
	and	DWORD PTR [eax+12], -33			; ffffffdfH
; Line 73
	mov	ecx, DWORD PTR [esi]
	mov	eax, DWORD PTR _boundary$[esp]
	add	ecx, 8
	pop	esi
	mov	DWORD PTR [eax], ecx
; Line 74
	mov	eax, 1
; Line 78
	ret	0
_CMS_stream ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PEM_write_CMS
_TEXT	SEGMENT
_fp$ = 8						; size = 4
_x$ = 12						; size = 4
_PEM_write_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 90
	push	0
	push	0
	push	0
	push	0
	push	0
	push	DWORD PTR _x$[esp+16]
	push	DWORD PTR _fp$[esp+20]
	push	OFFSET ??_C@_03LOMOMHDE@CMS?$AA@
	push	OFFSET _i2d_CMS_ContentInfo
	call	_PEM_ASN1_write
	add	esp, 36					; 00000024H
	ret	0
_PEM_write_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PEM_write_bio_CMS
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_x$ = 12						; size = 4
_PEM_write_bio_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 90
	push	0
	push	0
	push	0
	push	0
	push	0
	push	DWORD PTR _x$[esp+16]
	push	DWORD PTR _bp$[esp+20]
	push	OFFSET ??_C@_03LOMOMHDE@CMS?$AA@
	push	OFFSET _i2d_CMS_ContentInfo
	call	_PEM_ASN1_write_bio
	add	esp, 36					; 00000024H
	ret	0
_PEM_write_bio_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PEM_read_CMS
_TEXT	SEGMENT
_fp$ = 8						; size = 4
_x$ = 12						; size = 4
_cb$ = 16						; size = 4
_u$ = 20						; size = 4
_PEM_read_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 90
	push	DWORD PTR _u$[esp-4]
	push	DWORD PTR _cb$[esp]
	push	DWORD PTR _x$[esp+4]
	push	DWORD PTR _fp$[esp+8]
	push	OFFSET ??_C@_03LOMOMHDE@CMS?$AA@
	push	OFFSET _d2i_CMS_ContentInfo
	call	_PEM_ASN1_read
	add	esp, 24					; 00000018H
	ret	0
_PEM_read_CMS ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PEM_read_bio_CMS
_TEXT	SEGMENT
_bp$ = 8						; size = 4
_x$ = 12						; size = 4
_cb$ = 16						; size = 4
_u$ = 20						; size = 4
_PEM_read_bio_CMS PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_io.c
; Line 90
	push	DWORD PTR _u$[esp-4]
	push	DWORD PTR _cb$[esp]
	push	DWORD PTR _x$[esp+4]
	push	DWORD PTR _bp$[esp+8]
	push	OFFSET ??_C@_03LOMOMHDE@CMS?$AA@
	push	OFFSET _d2i_CMS_ContentInfo
	call	_PEM_ASN1_read_bio
	add	esp, 24					; 00000018H
	ret	0
_PEM_read_bio_CMS ENDP
_TEXT	ENDS
END
