; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_OCSP_request_verify
PUBLIC	_OCSP_basic_verify
PUBLIC	??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@ ; `string'
PUBLIC	??_C@_0O@HFNJECFC@Verify?5error?3?$AA@		; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_free:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_sk_push:PROC
EXTRN	_sk_dup:PROC
EXTRN	_OBJ_nid2sn:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_OBJ_cmp:PROC
EXTRN	_EVP_MD_size:PROC
EXTRN	_EVP_sha1:PROC
EXTRN	_EVP_get_digestbyname:PROC
EXTRN	_EVP_PKEY_free:PROC
EXTRN	_X509_STORE_CTX_init:PROC
EXTRN	_X509_STORE_CTX_cleanup:PROC
EXTRN	_X509_STORE_CTX_get_error:PROC
EXTRN	_X509_STORE_CTX_get1_chain:PROC
EXTRN	_X509_STORE_CTX_set_purpose:PROC
EXTRN	_X509_STORE_CTX_set_trust:PROC
EXTRN	_X509_verify_cert_error_string:PROC
EXTRN	_X509_pubkey_digest:PROC
EXTRN	_X509_NAME_digest:PROC
EXTRN	_X509_free:PROC
EXTRN	_ASN1_item_verify:PROC
EXTRN	_X509_get_subject_name:PROC
EXTRN	_X509_get_pubkey:PROC
EXTRN	_X509_verify_cert:PROC
EXTRN	_X509_find_by_subject:PROC
EXTRN	_X509_check_trust:PROC
EXTRN	_X509_check_purpose:PROC
EXTRN	_OCSP_id_issuer_cmp:PROC
EXTRN	_OCSP_RESPDATA_it:PROC
EXTRN	_OCSP_REQINFO_it:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_add_error_data:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
CONST	SEGMENT
??_C@_0O@HFNJECFC@Verify?5error?3?$AA@ DB 'Verify error:', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
CONST	SEGMENT
??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@ DB '.\crypto\ocsp\o'
	DB	'csp_vfy.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_req_find_signer
_TEXT	SEGMENT
_psigner$ = 8						; size = 4
_req$ = 12						; size = 4
_nm$ = 16						; size = 4
_certs$ = 20						; size = 4
_st$ = 24						; size = 4
_flags$ = 28						; size = 4
_ocsp_req_find_signer PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 440
	test	BYTE PTR _flags$[esp-4], 2
	jne	SHORT $LN3@ocsp_req_f
; Line 441
	mov	eax, DWORD PTR _req$[esp-4]
	push	DWORD PTR _nm$[esp-4]
	mov	eax, DWORD PTR [eax+4]
	push	DWORD PTR [eax+8]
	call	_X509_find_by_subject
	add	esp, 8
; Line 442
	test	eax, eax
	je	SHORT $LN3@ocsp_req_f
; Line 443
	mov	ecx, DWORD PTR _psigner$[esp-4]
	mov	DWORD PTR [ecx], eax
; Line 444
	mov	eax, 1
; Line 454
	ret	0
$LN3@ocsp_req_f:
; Line 448
	push	DWORD PTR _nm$[esp-4]
	push	DWORD PTR _certs$[esp]
	call	_X509_find_by_subject
	add	esp, 8
; Line 449
	test	eax, eax
	je	SHORT $LN4@ocsp_req_f
; Line 450
	mov	ecx, DWORD PTR _psigner$[esp-4]
	mov	DWORD PTR [ecx], eax
; Line 451
	mov	eax, 2
; Line 454
	ret	0
$LN4@ocsp_req_f:
; Line 453
	xor	eax, eax
; Line 454
	ret	0
_ocsp_req_find_signer ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_check_delegated
_TEXT	SEGMENT
_x$ = 8							; size = 4
_flags$ = 12						; size = 4
_ocsp_check_delegated PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 356
	push	esi
; Line 357
	mov	esi, DWORD PTR _x$[esp]
	push	0
	push	-1
	push	esi
	call	_X509_check_purpose
	add	esp, 12					; 0000000cH
; Line 358
	test	BYTE PTR [esi+40], 4
	je	SHORT $LN2@ocsp_check
	test	BYTE PTR [esi+48], 32			; 00000020H
	je	SHORT $LN2@ocsp_check
; Line 359
	mov	eax, 1
	pop	esi
; Line 362
	ret	0
$LN2@ocsp_check:
; Line 360
	push	360					; 00000168H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	103					; 00000067H
	push	106					; 0000006aH
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 361
	xor	eax, eax
	pop	esi
; Line 362
	ret	0
_ocsp_check_delegated ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_match_issuerid
_TEXT	SEGMENT
_dgst$1$ = -72						; size = 4
_md$1 = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_cert$ = 8						; size = 4
_cid$ = 12						; size = 4
_sresp$ = 16						; size = 4
_ocsp_match_issuerid PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 310
	mov	eax, 72					; 00000048H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+72], eax
	push	ebx
	mov	ebx, DWORD PTR _cid$[esp+72]
	push	ebp
	mov	ebp, DWORD PTR _cert$[esp+76]
	push	esi
	push	edi
	mov	edi, DWORD PTR _sresp$[esp+84]
; Line 312
	test	ebx, ebx
	je	$LN5@ocsp_match
; Line 317
	mov	eax, DWORD PTR [ebx]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	push	eax
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	mov	edi, eax
	add	esp, 12					; 0000000cH
	mov	DWORD PTR _dgst$1$[esp+88], edi
	test	edi, edi
	jne	SHORT $LN7@ocsp_match
; Line 318
	push	319					; 0000013fH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	119					; 00000077H
	push	109					; 0000006dH
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN32@ocsp_match:
; Line 320
	pop	edi
	pop	esi
	pop	ebp
	or	eax, -1
	pop	ebx
; Line 353
	mov	ecx, DWORD PTR __$ArrayPad$[esp+72]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 72					; 00000048H
	ret	0
$LN7@ocsp_match:
; Line 323
	push	edi
	call	_EVP_MD_size
	mov	esi, eax
	add	esp, 4
; Line 324
	test	esi, esi
	js	SHORT $LN32@ocsp_match
; Line 326
	mov	eax, DWORD PTR [ebx+4]
	cmp	DWORD PTR [eax], esi
	jne	$LN30@ocsp_match
	mov	eax, DWORD PTR [ebx+8]
	cmp	DWORD PTR [eax], esi
	jne	$LN30@ocsp_match
; Line 329
	push	ebp
	call	_X509_get_subject_name
; Line 330
	push	0
	lea	ecx, DWORD PTR _md$1[esp+96]
	push	ecx
	push	edi
	push	eax
	call	_X509_NAME_digest
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN32@ocsp_match
; Line 332
	mov	eax, DWORD PTR [ebx+4]
	lea	ecx, DWORD PTR _md$1[esp+88]
	mov	edi, esi
	mov	edx, DWORD PTR [eax+8]
	sub	edi, 4
	jb	SHORT $LN23@ocsp_match
	npad	2
$LL24@ocsp_match:
	mov	eax, DWORD PTR [ecx]
	cmp	eax, DWORD PTR [edx]
	jne	SHORT $LN22@ocsp_match
	add	ecx, 4
	add	edx, 4
	sub	edi, 4
	jae	SHORT $LL24@ocsp_match
$LN23@ocsp_match:
	cmp	edi, -4					; fffffffcH
	je	SHORT $LN21@ocsp_match
$LN22@ocsp_match:
	mov	al, BYTE PTR [ecx]
	cmp	al, BYTE PTR [edx]
	jne	$LN30@ocsp_match
	cmp	edi, -3					; fffffffdH
	je	SHORT $LN21@ocsp_match
	mov	al, BYTE PTR [ecx+1]
	cmp	al, BYTE PTR [edx+1]
	jne	$LN30@ocsp_match
	cmp	edi, -2					; fffffffeH
	je	SHORT $LN21@ocsp_match
	mov	al, BYTE PTR [ecx+2]
	cmp	al, BYTE PTR [edx+2]
	jne	SHORT $LN30@ocsp_match
	cmp	edi, -1
	je	SHORT $LN21@ocsp_match
	mov	al, BYTE PTR [ecx+3]
	cmp	al, BYTE PTR [edx+3]
	jne	SHORT $LN30@ocsp_match
$LN21@ocsp_match:
; Line 334
	push	0
	lea	eax, DWORD PTR _md$1[esp+92]
	push	eax
	push	DWORD PTR _dgst$1$[esp+96]
	push	ebp
	call	_X509_pubkey_digest
; Line 335
	mov	eax, DWORD PTR [ebx+8]
	lea	ecx, DWORD PTR _md$1[esp+104]
	add	esp, 16					; 00000010H
	mov	edx, DWORD PTR [eax+8]
	sub	esi, 4
	jb	SHORT $LN28@ocsp_match
	npad	2
$LL29@ocsp_match:
	mov	eax, DWORD PTR [ecx]
	cmp	eax, DWORD PTR [edx]
	jne	SHORT $LN27@ocsp_match
	add	ecx, 4
	add	edx, 4
	sub	esi, 4
	jae	SHORT $LL29@ocsp_match
$LN28@ocsp_match:
	cmp	esi, -4					; fffffffcH
	je	SHORT $LN3@ocsp_match
$LN27@ocsp_match:
	mov	al, BYTE PTR [ecx]
	cmp	al, BYTE PTR [edx]
	jne	SHORT $LN30@ocsp_match
	cmp	esi, -3					; fffffffdH
	je	SHORT $LN3@ocsp_match
	mov	al, BYTE PTR [ecx+1]
	cmp	al, BYTE PTR [edx+1]
	jne	SHORT $LN30@ocsp_match
	cmp	esi, -2					; fffffffeH
	je	SHORT $LN3@ocsp_match
	mov	al, BYTE PTR [ecx+2]
	cmp	al, BYTE PTR [edx+2]
	jne	SHORT $LN30@ocsp_match
	cmp	esi, -1
	je	SHORT $LN3@ocsp_match
	mov	al, BYTE PTR [ecx+3]
	cmp	al, BYTE PTR [edx+3]
	je	SHORT $LN3@ocsp_match
$LN30@ocsp_match:
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 353
	mov	ecx, DWORD PTR __$ArrayPad$[esp+72]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 72					; 00000048H
	ret	0
$LN5@ocsp_match:
; Line 344
	push	edi
	xor	esi, esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@ocsp_match
$LL4@ocsp_match:
; Line 345
	push	esi
	push	edi
	call	_sk_value
; Line 346
	push	0
	push	DWORD PTR [eax]
	push	ebp
	call	_ocsp_match_issuerid
	add	esp, 20					; 00000014H
; Line 347
	test	eax, eax
	jle	SHORT $LN6@ocsp_match
; Line 344
	push	edi
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@ocsp_match
$LN3@ocsp_match:
; Line 350
	mov	eax, 1
$LN6@ocsp_match:
; Line 353
	mov	ecx, DWORD PTR __$ArrayPad$[esp+88]
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 72					; 00000048H
	ret	0
_ocsp_match_issuerid ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_check_ids
_TEXT	SEGMENT
_cid$1$ = -4						; size = 4
_sresp$ = 8						; size = 4
_ret$ = 12						; size = 4
_ocsp_check_ids PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 275
	mov	eax, 4
	call	__chkstk
	push	ebx
; Line 279
	mov	ebx, DWORD PTR _sresp$[esp+4]
	push	edi
	push	ebx
	call	_sk_num
	mov	edi, eax
	add	esp, 4
; Line 280
	test	edi, edi
	jg	SHORT $LN5@ocsp_check
; Line 281
	push	282					; 0000011aH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	111					; 0000006fH
	push	107					; 0000006bH
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 283
	or	eax, -1
	pop	edi
	pop	ebx
; Line 306
	pop	ecx
	ret	0
$LN5@ocsp_check:
	push	ebp
	push	esi
; Line 286
	push	0
	push	ebx
	call	_sk_value
; Line 288
	mov	ecx, DWORD PTR _ret$[esp+24]
; Line 290
	mov	esi, 1
	add	esp, 8
	mov	eax, DWORD PTR [eax]
	mov	DWORD PTR _cid$1$[esp+20], eax
	mov	DWORD PTR [ecx], 0
	cmp	edi, esi
	jle	SHORT $LN3@ocsp_check
$LL4@ocsp_check:
; Line 291
	push	esi
	push	ebx
	call	_sk_value
	mov	ebp, DWORD PTR [eax]
; Line 293
	push	ebp
	push	DWORD PTR _cid$1$[esp+32]
	call	_OCSP_id_issuer_cmp
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN10@ocsp_check
; Line 290
	inc	esi
	cmp	esi, edi
	jl	SHORT $LL4@ocsp_check
; Line 293
	mov	eax, DWORD PTR _cid$1$[esp+20]
	mov	ecx, DWORD PTR _ret$[esp+16]
$LN3@ocsp_check:
; Line 304
	pop	esi
	pop	ebp
	pop	edi
	mov	DWORD PTR [ecx], eax
; Line 305
	mov	eax, 1
	pop	ebx
; Line 306
	pop	ecx
	ret	0
$LN10@ocsp_check:
; Line 295
	mov	eax, DWORD PTR _cid$1$[esp+20]
	mov	eax, DWORD PTR [eax]
	push	DWORD PTR [eax]
	mov	eax, DWORD PTR [ebp]
	push	DWORD PTR [eax]
	call	_OBJ_cmp
	add	esp, 8
	neg	eax
	sbb	eax, eax
	and	eax, 2
	pop	esi
	pop	ebp
	pop	edi
	pop	ebx
; Line 306
	pop	ecx
	ret	0
_ocsp_check_ids ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_check_issuer
_TEXT	SEGMENT
_caid$ = -4						; size = 4
_bs$ = 8						; size = 4
_chain$ = 12						; size = 4
_flags$ = 16						; size = 4
_ocsp_check_issuer PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 229
	mov	eax, 4
	call	__chkstk
; Line 234
	mov	eax, DWORD PTR _bs$[esp]
	push	esi
; Line 236
	mov	esi, DWORD PTR _chain$[esp+4]
	push	edi
	mov	eax, DWORD PTR [eax]
	push	esi
	mov	DWORD PTR _caid$[esp+16], 0
	mov	edi, DWORD PTR [eax+12]
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jg	SHORT $LN2@ocsp_check
; Line 237
	push	237					; 000000edH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	105					; 00000069H
	push	108					; 0000006cH
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 238
	or	eax, -1
	pop	edi
	pop	esi
; Line 265
	pop	ecx
	ret	0
$LN2@ocsp_check:
; Line 242
	lea	eax, DWORD PTR _caid$[esp+12]
	push	eax
	push	edi
	call	_ocsp_check_ids
	add	esp, 8
; Line 245
	test	eax, eax
	jle	SHORT $LN1@ocsp_check
; Line 248
	push	ebx
	push	0
	push	esi
	call	_sk_value
; Line 250
	push	esi
	mov	ebx, eax
	call	_sk_num
	add	esp, 12					; 0000000cH
	cmp	eax, 1
	jle	SHORT $LN6@ocsp_check
; Line 251
	push	1
	push	esi
	call	_sk_value
; Line 252
	push	edi
	push	DWORD PTR _caid$[esp+28]
	push	eax
	call	_ocsp_match_issuerid
	add	esp, 20					; 00000014H
; Line 253
	test	eax, eax
	js	SHORT $LN9@ocsp_check
; Line 255
	je	SHORT $LN6@ocsp_check
; Line 257
	push	DWORD PTR _flags$[esp+12]
	push	ebx
	call	_ocsp_check_delegated
	add	esp, 8
	neg	eax
	sbb	eax, eax
	neg	eax
	pop	ebx
	pop	edi
	pop	esi
; Line 265
	pop	ecx
	ret	0
$LN6@ocsp_check:
; Line 264
	push	edi
	push	DWORD PTR _caid$[esp+20]
	push	ebx
	call	_ocsp_match_issuerid
	add	esp, 12					; 0000000cH
$LN9@ocsp_check:
	pop	ebx
$LN1@ocsp_check:
	pop	edi
	pop	esi
; Line 265
	pop	ecx
	ret	0
_ocsp_check_issuer ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_find_signer_sk
_TEXT	SEGMENT
_keyhash$1$ = -28					; size = 4
_tmphash$ = -24						; size = 20
__$ArrayPad$ = -4					; size = 4
_certs$ = 8						; size = 4
_id$ = 12						; size = 4
_ocsp_find_signer_sk PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 202
	mov	eax, 28					; 0000001cH
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+28], eax
	mov	eax, DWORD PTR _id$[esp+24]
	push	ebx
	mov	ebx, DWORD PTR _certs$[esp+28]
; Line 208
	cmp	DWORD PTR [eax], 0
	jne	SHORT $LN5@ocsp_find_
; Line 209
	push	DWORD PTR [eax+4]
	push	ebx
	call	_X509_find_by_subject
	add	esp, 8
	pop	ebx
; Line 225
	mov	ecx, DWORD PTR __$ArrayPad$[esp+28]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 28					; 0000001cH
	ret	0
$LN5@ocsp_find_:
; Line 214
	mov	eax, DWORD PTR [eax+4]
	cmp	DWORD PTR [eax], 20			; 00000014H
	je	SHORT $LN6@ocsp_find_
; Line 215
	xor	eax, eax
	pop	ebx
; Line 225
	mov	ecx, DWORD PTR __$ArrayPad$[esp+28]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 28					; 0000001cH
	ret	0
$LN6@ocsp_find_:
	push	ebp
	push	esi
; Line 216
	mov	esi, DWORD PTR [eax+8]
	push	edi
; Line 218
	push	ebx
	mov	DWORD PTR _keyhash$1$[esp+48], esi
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN18@ocsp_find_
$LL4@ocsp_find_:
; Line 219
	push	edi
	push	ebx
	call	_sk_value
	add	esp, 8
	mov	ebp, eax
; Line 220
	lea	eax, DWORD PTR _tmphash$[esp+44]
	push	0
	push	eax
	call	_EVP_sha1
	push	eax
	push	ebp
	call	_X509_pubkey_digest
; Line 221
	mov	edx, esi
	lea	eax, DWORD PTR _tmphash$[esp+60]
	add	esp, 16					; 00000010H
	mov	esi, 16					; 00000010H
	npad	1
$LL16@ocsp_find_:
	mov	ecx, DWORD PTR [edx]
	cmp	ecx, DWORD PTR [eax]
	jne	SHORT $LN15@ocsp_find_
	add	edx, 4
	add	eax, 4
	sub	esi, 4
	jae	SHORT $LL16@ocsp_find_
; Line 222
	pop	edi
	pop	esi
	mov	eax, ebp
	pop	ebp
	pop	ebx
; Line 225
	mov	ecx, DWORD PTR __$ArrayPad$[esp+28]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 28					; 0000001cH
	ret	0
$LN15@ocsp_find_:
; Line 218
	push	ebx
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jge	SHORT $LN18@ocsp_find_
	mov	esi, DWORD PTR _keyhash$1$[esp+44]
	jmp	SHORT $LL4@ocsp_find_
$LN18@ocsp_find_:
; Line 225
	mov	ecx, DWORD PTR __$ArrayPad$[esp+44]
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 28					; 0000001cH
	ret	0
_ocsp_find_signer_sk ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ocsp_find_signer
_TEXT	SEGMENT
_psigner$ = 8						; size = 4
_bs$ = 12						; size = 4
_certs$ = 16						; size = 4
_st$ = 20						; size = 4
_flags$ = 24						; size = 4
_ocsp_find_signer PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 183
	push	esi
; Line 185
	mov	esi, DWORD PTR _bs$[esp]
	push	edi
	mov	eax, DWORD PTR [esi]
	mov	edi, DWORD PTR [eax+4]
; Line 186
	push	edi
	push	DWORD PTR _certs$[esp+8]
	call	_ocsp_find_signer_sk
	add	esp, 8
	test	eax, eax
	je	SHORT $LN2@ocsp_find_
; Line 187
	mov	ecx, DWORD PTR _psigner$[esp+4]
	pop	edi
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 188
	mov	eax, 2
; Line 199
	ret	0
$LN2@ocsp_find_:
; Line 190
	test	BYTE PTR _flags$[esp+4], 2
	jne	SHORT $LN3@ocsp_find_
	push	edi
	push	DWORD PTR [esi+12]
	call	_ocsp_find_signer_sk
	add	esp, 8
	test	eax, eax
	je	SHORT $LN3@ocsp_find_
; Line 192
	mov	ecx, DWORD PTR _psigner$[esp+4]
	pop	edi
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 193
	mov	eax, 1
; Line 199
	ret	0
$LN3@ocsp_find_:
; Line 197
	mov	eax, DWORD PTR _psigner$[esp+4]
	pop	edi
	pop	esi
	mov	DWORD PTR [eax], 0
; Line 198
	xor	eax, eax
; Line 199
	ret	0
_ocsp_find_signer ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_basic_verify
_TEXT	SEGMENT
_rid$1$ = -144						; size = 4
_skey$1$ = -144						; size = 4
_untrusted$1$ = -144					; size = 4
_signer$1$ = -140					; size = 4
_chain$1$ = -140					; size = 4
_ctx$ = -136						; size = 136
_bs$ = 8						; size = 4
_certs$ = 12						; size = 4
_st$ = 16						; size = 4
_flags$ = 20						; size = 4
_OCSP_basic_verify PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 83
	mov	eax, 144				; 00000090H
	call	__chkstk
	push	ebx
	push	ebp
; Line 186
	mov	ebp, DWORD PTR _certs$[esp+148]
	push	esi
	push	edi
; Line 185
	mov	edi, DWORD PTR _bs$[esp+156]
; Line 86
	xor	esi, esi
; Line 185
	mov	eax, DWORD PTR [edi]
	mov	eax, DWORD PTR [eax+4]
; Line 186
	push	eax
	push	ebp
	mov	DWORD PTR _rid$1$[esp+168], eax
	call	_ocsp_find_signer_sk
; Line 95
	mov	ebx, DWORD PTR _flags$[esp+164]
; Line 186
	add	esp, 8
	mov	DWORD PTR _signer$1$[esp+160], eax
	test	eax, eax
	je	SHORT $LN27@OCSP_basic
; Line 188
	lea	edi, DWORD PTR [esi+2]
; Line 95
	test	ebx, 512				; 00000200H
	je	SHORT $LN6@OCSP_basic
; Line 96
	or	ebx, 16					; 00000010H
	jmp	SHORT $LN6@OCSP_basic
$LN27@OCSP_basic:
; Line 190
	test	bl, 2
	jne	$LN28@OCSP_basic
	push	DWORD PTR _rid$1$[esp+160]
	push	DWORD PTR [edi+12]
	call	_ocsp_find_signer_sk
	add	esp, 8
	mov	DWORD PTR _signer$1$[esp+160], eax
	test	eax, eax
	je	$LN28@OCSP_basic
; Line 193
	mov	edi, 1
$LN6@OCSP_basic:
; Line 97
	test	bl, 4
	jne	SHORT $LN9@OCSP_basic
; Line 99
	push	eax
	call	_X509_get_pubkey
	add	esp, 4
	mov	DWORD PTR _skey$1$[esp+160], eax
; Line 100
	test	eax, eax
	je	SHORT $LN10@OCSP_basic
; Line 101
	push	eax
	mov	eax, DWORD PTR _bs$[esp+160]
	push	DWORD PTR [eax]
	push	DWORD PTR [eax+8]
	push	DWORD PTR [eax+4]
	call	_OCSP_RESPDATA_it
	push	eax
	call	_ASN1_item_verify
; Line 102
	push	DWORD PTR _skey$1$[esp+180]
	mov	edi, eax
	call	_EVP_PKEY_free
	add	esp, 24					; 00000018H
; Line 104
	test	edi, edi
	jg	SHORT $LN9@OCSP_basic
$LN10@OCSP_basic:
; Line 105
	push	105					; 00000069H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	117					; 00000075H
; Line 106
	jmp	$LN40@OCSP_basic
$LN9@OCSP_basic:
; Line 109
	test	bl, 16					; 00000010H
	jne	$LN23@OCSP_basic
; Line 111
	test	bl, 8
	je	SHORT $LN12@OCSP_basic
; Line 112
	xor	esi, esi
	mov	DWORD PTR _untrusted$1$[esp+160], esi
	jmp	SHORT $LN15@OCSP_basic
$LN12@OCSP_basic:
; Line 113
	mov	esi, DWORD PTR _bs$[esp+156]
	mov	esi, DWORD PTR [esi+12]
	mov	DWORD PTR _untrusted$1$[esp+160], esi
	test	esi, esi
	je	SHORT $LN15@OCSP_basic
	test	ebp, ebp
	je	SHORT $LN15@OCSP_basic
; Line 114
	push	esi
	call	_sk_dup
; Line 115
	push	ebp
	mov	DWORD PTR _untrusted$1$[esp+168], eax
	xor	esi, esi
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN39@OCSP_basic
	npad	1
$LL4@OCSP_basic:
; Line 116
	push	esi
	push	ebp
	call	_sk_value
	push	eax
	push	DWORD PTR _untrusted$1$[esp+172]
	call	_sk_push
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN31@OCSP_basic
; Line 115
	push	ebp
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@OCSP_basic
$LN39@OCSP_basic:
	mov	esi, DWORD PTR _untrusted$1$[esp+160]
$LN15@OCSP_basic:
; Line 124
	push	esi
	push	DWORD PTR _signer$1$[esp+164]
	lea	eax, DWORD PTR _ctx$[esp+168]
	push	DWORD PTR _st$[esp+164]
	push	eax
	call	_X509_STORE_CTX_init
	add	esp, 16					; 00000010H
; Line 125
	test	eax, eax
	jne	SHORT $LN17@OCSP_basic
; Line 127
	push	127					; 0000007fH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	or	edi, -1
	push	11					; 0000000bH
; Line 128
	jmp	$LN40@OCSP_basic
$LN31@OCSP_basic:
; Line 117
	push	117					; 00000075H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	65					; 00000041H
	push	105					; 00000069H
	push	39					; 00000027H
	call	_ERR_put_error
; Line 118
	mov	esi, DWORD PTR _untrusted$1$[esp+180]
	jmp	$LN41@OCSP_basic
$LN17@OCSP_basic:
; Line 131
	lea	eax, DWORD PTR _ctx$[esp+160]
	push	8
	push	eax
	call	_X509_STORE_CTX_set_purpose
; Line 132
	lea	eax, DWORD PTR _ctx$[esp+168]
	push	eax
	call	_X509_verify_cert
	mov	edi, eax
; Line 133
	lea	eax, DWORD PTR _ctx$[esp+172]
	push	eax
	call	_X509_STORE_CTX_get1_chain
	mov	DWORD PTR _chain$1$[esp+176], eax
; Line 134
	lea	eax, DWORD PTR _ctx$[esp+176]
	push	eax
	call	_X509_STORE_CTX_cleanup
	add	esp, 20					; 00000014H
; Line 135
	test	edi, edi
	jg	SHORT $LN18@OCSP_basic
; Line 136
	lea	eax, DWORD PTR _ctx$[esp+160]
	push	eax
	call	_X509_STORE_CTX_get_error
; Line 137
	push	138					; 0000008aH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	101					; 00000065H
	push	105					; 00000069H
	push	39					; 00000027H
	mov	esi, eax
	call	_ERR_put_error
; Line 139
	push	esi
	call	_X509_verify_cert_error_string
	push	eax
	push	OFFSET ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
	push	2
	call	_ERR_add_error_data
; Line 141
	mov	esi, DWORD PTR _untrusted$1$[esp+200]
	add	esp, 40					; 00000028H
	jmp	SHORT $end$43
$LN18@OCSP_basic:
; Line 143
	test	ebx, 256				; 00000100H
	jne	SHORT $LN22@OCSP_basic
; Line 151
	push	ebx
	push	DWORD PTR _chain$1$[esp+164]
	push	DWORD PTR _bs$[esp+164]
	call	_ocsp_check_issuer
	mov	edi, eax
	add	esp, 12					; 0000000cH
; Line 154
	test	edi, edi
	jne	SHORT $end$43
; Line 161
	test	bl, 32					; 00000020H
	jne	SHORT $end$43
; Line 164
	mov	ebx, DWORD PTR _chain$1$[esp+160]
	push	ebx
	call	_sk_num
	dec	eax
	push	eax
	push	ebx
	call	_sk_value
; Line 165
	push	edi
	push	180					; 000000b4H
	push	eax
	call	_X509_check_trust
	add	esp, 24					; 00000018H
	cmp	eax, 1
	je	SHORT $LN22@OCSP_basic
; Line 166
	push	166					; 000000a6H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	112					; 00000070H
	push	105					; 00000069H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 167
	jmp	SHORT $end$43
$LN22@OCSP_basic:
; Line 169
	mov	edi, 1
$end$43:
; Line 173
	mov	eax, DWORD PTR _chain$1$[esp+160]
	test	eax, eax
	je	SHORT $LN23@OCSP_basic
; Line 174
	push	OFFSET _X509_free
	push	eax
	call	_sk_pop_free
	add	esp, 8
	jmp	SHORT $LN23@OCSP_basic
$LN28@OCSP_basic:
; Line 91
	push	92					; 0000005cH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
; Line 198
	xor	edi, edi
; Line 91
	push	118					; 00000076H
$LN40@OCSP_basic:
	push	105					; 00000069H
	push	39					; 00000027H
	call	_ERR_put_error
$LN41@OCSP_basic:
	add	esp, 20					; 00000014H
$LN23@OCSP_basic:
; Line 175
	mov	eax, DWORD PTR _bs$[esp+156]
	cmp	DWORD PTR [eax+12], 0
	je	SHORT $LN37@OCSP_basic
	test	ebp, ebp
	je	SHORT $LN37@OCSP_basic
; Line 176
	push	esi
	call	_sk_free
	add	esp, 4
$LN37@OCSP_basic:
; Line 177
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 178
	add	esp, 144				; 00000090H
	ret	0
_OCSP_basic_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OCSP_request_verify
_TEXT	SEGMENT
_signer$ = -140						; size = 4
_ctx$ = -136						; size = 136
_req$ = 8						; size = 4
_certs$ = 12						; size = 4
_store$ = 16						; size = 4
_flags$ = 20						; size = 4
_OCSP_request_verify PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ocsp\ocsp_vfy.c
; Line 372
	mov	eax, 140				; 0000008cH
	call	__chkstk
	push	ebp
; Line 378
	mov	ebp, DWORD PTR _req$[esp+140]
	cmp	DWORD PTR [ebp+4], 0
	jne	SHORT $LN2@OCSP_reque
; Line 379
	push	379					; 0000017bH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	128					; 00000080H
	push	116					; 00000074H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 380
	xor	eax, eax
	pop	ebp
; Line 433
	add	esp, 140				; 0000008cH
	ret	0
$LN2@OCSP_reque:
; Line 382
	mov	eax, DWORD PTR [ebp]
	mov	eax, DWORD PTR [eax+4]
; Line 383
	test	eax, eax
	je	$LN4@OCSP_reque
	cmp	DWORD PTR [eax], 4
	jne	$LN4@OCSP_reque
; Line 389
	push	ebx
	mov	ebx, DWORD PTR _flags$[esp+144]
	push	esi
	mov	esi, DWORD PTR _store$[esp+148]
	push	ebx
	push	esi
	push	DWORD PTR _certs$[esp+156]
	push	DWORD PTR [eax+4]
	lea	eax, DWORD PTR _signer$[esp+168]
	push	ebp
	push	eax
	call	_ocsp_req_find_signer
	add	esp, 24					; 00000018H
; Line 390
	test	eax, eax
	jg	SHORT $LN5@OCSP_reque
; Line 391
	push	392					; 00000188H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	118					; 00000076H
$LN20@OCSP_reque:
	push	116					; 00000074H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 416
	xor	eax, eax
	pop	esi
	pop	ebx
	pop	ebp
; Line 433
	add	esp, 140				; 0000008cH
	ret	0
$LN5@OCSP_reque:
; Line 395
	cmp	eax, 2
	jne	SHORT $LN6@OCSP_reque
	test	ebx, 512				; 00000200H
	je	SHORT $LN6@OCSP_reque
; Line 396
	or	ebx, 16					; 00000010H
$LN6@OCSP_reque:
; Line 397
	mov	ecx, DWORD PTR _signer$[esp+152]
	test	bl, 4
	jne	SHORT $LN8@OCSP_reque
; Line 399
	push	edi
	push	ecx
	call	_X509_get_pubkey
; Line 400
	mov	ecx, DWORD PTR [ebp+4]
	add	esp, 4
	mov	edi, eax
	push	edi
	push	DWORD PTR [ebp]
	push	DWORD PTR [ecx+4]
	push	DWORD PTR [ecx]
	call	_OCSP_REQINFO_it
	push	eax
	call	_ASN1_item_verify
; Line 401
	push	edi
	mov	esi, eax
	call	_EVP_PKEY_free
	add	esp, 24					; 00000018H
	pop	edi
; Line 402
	test	esi, esi
	jg	SHORT $LN15@OCSP_reque
; Line 403
	push	403					; 00000193H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	117					; 00000075H
; Line 404
	jmp	SHORT $LN20@OCSP_reque
$LN15@OCSP_reque:
	mov	ecx, DWORD PTR _signer$[esp+152]
	mov	esi, DWORD PTR _store$[esp+148]
$LN8@OCSP_reque:
; Line 407
	test	bl, 16					; 00000010H
	jne	$LN13@OCSP_reque
; Line 409
	test	bl, 8
	je	SHORT $LN10@OCSP_reque
; Line 410
	push	0
	jmp	SHORT $LN18@OCSP_reque
$LN10@OCSP_reque:
; Line 412
	mov	eax, DWORD PTR [ebp+4]
	push	DWORD PTR [eax+8]
$LN18@OCSP_reque:
	push	ecx
	lea	eax, DWORD PTR _ctx$[esp+160]
	push	esi
	push	eax
	call	_X509_STORE_CTX_init
	add	esp, 16					; 00000010H
; Line 414
	test	eax, eax
	jne	SHORT $LN12@OCSP_reque
; Line 415
	push	415					; 0000019fH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	11					; 0000000bH
; Line 416
	jmp	$LN20@OCSP_reque
$LN12@OCSP_reque:
; Line 419
	lea	eax, DWORD PTR _ctx$[esp+152]
	push	8
	push	eax
	call	_X509_STORE_CTX_set_purpose
; Line 420
	lea	eax, DWORD PTR _ctx$[esp+160]
	push	7
	push	eax
	call	_X509_STORE_CTX_set_trust
; Line 421
	lea	eax, DWORD PTR _ctx$[esp+168]
	push	eax
	call	_X509_verify_cert
	mov	esi, eax
; Line 422
	lea	eax, DWORD PTR _ctx$[esp+172]
	push	eax
	call	_X509_STORE_CTX_cleanup
	add	esp, 24					; 00000018H
; Line 423
	test	esi, esi
	jg	SHORT $LN13@OCSP_reque
; Line 424
	lea	eax, DWORD PTR _ctx$[esp+152]
	push	eax
	call	_X509_STORE_CTX_get_error
; Line 425
	push	426					; 000001aaH
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	101					; 00000065H
	push	116					; 00000074H
	push	39					; 00000027H
	mov	esi, eax
	call	_ERR_put_error
; Line 427
	push	esi
	call	_X509_verify_cert_error_string
	push	eax
	push	OFFSET ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
	push	2
	call	_ERR_add_error_data
	add	esp, 40					; 00000028H
	xor	eax, eax
	pop	esi
	pop	ebx
	pop	ebp
; Line 433
	add	esp, 140				; 0000008cH
	ret	0
$LN13@OCSP_reque:
	pop	esi
	pop	ebx
; Line 432
	mov	eax, 1
	pop	ebp
; Line 433
	add	esp, 140				; 0000008cH
	ret	0
$LN4@OCSP_reque:
; Line 384
	push	385					; 00000181H
	push	OFFSET ??_C@_0BJ@KMLFEEOP@?4?2crypto?2ocsp?2ocsp_vfy?4c?$AA@
	push	129					; 00000081H
	push	116					; 00000074H
	push	39					; 00000027H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 386
	xor	eax, eax
	pop	ebp
; Line 433
	add	esp, 140				; 0000008cH
	ret	0
_OCSP_request_verify ENDP
_TEXT	ENDS
END
