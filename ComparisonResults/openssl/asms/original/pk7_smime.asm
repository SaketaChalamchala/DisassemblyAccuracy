; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS7_sign
PUBLIC	_PKCS7_sign_add_signer
PUBLIC	_PKCS7_final
PUBLIC	_PKCS7_verify
PUBLIC	_PKCS7_get0_signers
PUBLIC	_PKCS7_encrypt
PUBLIC	_PKCS7_decrypt
PUBLIC	??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@ ; `string'
PUBLIC	??_C@_0L@GGDBHMO@smime_sign?$AA@		; `string'
PUBLIC	??_C@_0O@HFNJECFC@Verify?5error?3?$AA@		; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_new_null:PROC
EXTRN	_sk_free:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_sk_push:PROC
EXTRN	_BIO_method_type:PROC
EXTRN	_BIO_new:PROC
EXTRN	_BIO_free:PROC
EXTRN	_BIO_read:PROC
EXTRN	_BIO_write:PROC
EXTRN	_BIO_ctrl:PROC
EXTRN	_BIO_push:PROC
EXTRN	_BIO_pop:PROC
EXTRN	_BIO_free_all:PROC
EXTRN	_BIO_s_mem:PROC
EXTRN	_BIO_new_mem_buf:PROC
EXTRN	_BIO_f_buffer:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_add_error_data:PROC
EXTRN	_SMIME_crlf_copy:PROC
EXTRN	_SMIME_text:PROC
EXTRN	_OBJ_nid2sn:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_OBJ_cmp:PROC
EXTRN	_EVP_get_cipherbyname:PROC
EXTRN	_EVP_get_digestbyname:PROC
EXTRN	_X509_STORE_CTX_init:PROC
EXTRN	_X509_STORE_CTX_cleanup:PROC
EXTRN	_X509_STORE_CTX_get_error:PROC
EXTRN	_X509_STORE_CTX_set0_crls:PROC
EXTRN	_X509_STORE_CTX_set_default:PROC
EXTRN	_PKCS7_new:PROC
EXTRN	_PKCS7_free:PROC
EXTRN	_PKCS7_ctrl:PROC
EXTRN	_PKCS7_set_type:PROC
EXTRN	_PKCS7_SIGNER_INFO_sign:PROC
EXTRN	_PKCS7_add_certificate:PROC
EXTRN	_PKCS7_content_new:PROC
EXTRN	_PKCS7_signatureVerify:PROC
EXTRN	_PKCS7_dataInit:PROC
EXTRN	_PKCS7_dataFinal:PROC
EXTRN	_PKCS7_dataDecode:PROC
EXTRN	_PKCS7_add_signature:PROC
EXTRN	_PKCS7_get_signer_info:PROC
EXTRN	_PKCS7_add_recipient:PROC
EXTRN	_PKCS7_set_cipher:PROC
EXTRN	_PKCS7_digest_from_attributes:PROC
EXTRN	_PKCS7_add_attrib_smimecap:PROC
EXTRN	_PKCS7_simple_smimecap:PROC
EXTRN	_PKCS7_add_attrib_content_type:PROC
EXTRN	_PKCS7_add1_attrib_digest:PROC
EXTRN	_X509_verify_cert_error_string:PROC
EXTRN	_X509_ALGOR_free:PROC
EXTRN	_X509_check_private_key:PROC
EXTRN	_X509_verify_cert:PROC
EXTRN	_X509_find_by_issuer_and_serial:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
CONST	SEGMENT
??_C@_0O@HFNJECFC@Verify?5error?3?$AA@ DB 'Verify error:', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@GGDBHMO@smime_sign?$AA@
CONST	SEGMENT
??_C@_0L@GGDBHMO@smime_sign?$AA@ DB 'smime_sign', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
CONST	SEGMENT
??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@ DB '.\crypto\pkcs7'
	DB	'\pk7_smime.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _add_digest_smcap
_TEXT	SEGMENT
_sk$ = 8						; size = 4
_nid$ = 12						; size = 4
_arg$ = 16						; size = 4
_add_digest_smcap PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 150
	push	DWORD PTR _nid$[esp-4]
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	add	esp, 8
	test	eax, eax
	jne	_PKCS7_simple_smimecap
; Line 152
	mov	eax, 1
; Line 153
	ret	0
_add_digest_smcap ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _add_cipher_smcap
_TEXT	SEGMENT
_sk$ = 8						; size = 4
_nid$ = 12						; size = 4
_arg$ = 16						; size = 4
_add_cipher_smcap PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 143
	push	DWORD PTR _nid$[esp-4]
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_cipherbyname
	add	esp, 8
	test	eax, eax
	jne	_PKCS7_simple_smimecap
; Line 145
	mov	eax, 1
; Line 146
	ret	0
_add_cipher_smcap ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _pkcs7_copy_existing_digest
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_si$ = 12						; size = 4
_pkcs7_copy_existing_digest PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 222
	push	ebx
	push	ebp
	push	esi
	push	edi
; Line 227
	push	DWORD PTR _p7$[esp+12]
	call	_PKCS7_get_signer_info
	mov	ebx, eax
; Line 228
	xor	esi, esi
	push	ebx
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN16@pkcs7_copy
	mov	ebp, DWORD PTR _si$[esp+12]
$LL4@pkcs7_copy:
; Line 229
	push	esi
	push	ebx
	call	_sk_value
	mov	edi, eax
	add	esp, 8
; Line 230
	cmp	ebp, edi
	je	SHORT $LN16@pkcs7_copy
; Line 232
	push	DWORD PTR [edi+12]
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN2@pkcs7_copy
; Line 234
	mov	eax, DWORD PTR [edi+8]
	push	DWORD PTR [eax]
	mov	eax, DWORD PTR [ebp+8]
	push	DWORD PTR [eax]
	call	_OBJ_cmp
	add	esp, 8
	test	eax, eax
	je	SHORT $LN12@pkcs7_copy
$LN2@pkcs7_copy:
; Line 228
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@pkcs7_copy
$LN16@pkcs7_copy:
; Line 244
	push	245					; 000000f5H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	154					; 0000009aH
	push	138					; 0000008aH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 246
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 247
	ret	0
$LN12@pkcs7_copy:
; Line 235
	push	DWORD PTR [edi+12]
	call	_PKCS7_digest_from_attributes
	add	esp, 4
; Line 241
	test	eax, eax
	je	SHORT $LN16@pkcs7_copy
; Line 242
	push	DWORD PTR [eax]
	push	DWORD PTR [eax+8]
	push	ebp
	call	_PKCS7_add1_attrib_digest
	add	esp, 12					; 0000000cH
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 247
	ret	0
_pkcs7_copy_existing_digest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_decrypt
_TEXT	SEGMENT
_buf$ = -4100						; size = 4096
__$ArrayPad$ = -4					; size = 4
_p7$ = 8						; size = 4
_pkey$ = 12						; size = 4
_cert$ = 16						; size = 4
_data$ = 20						; size = 4
_flags$ = 24						; size = 4
_PKCS7_decrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 523
	mov	eax, 4100				; 00001004H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+4100], eax
	push	ebx
	mov	ebx, DWORD PTR _data$[esp+4100]
	push	ebp
	mov	ebp, DWORD PTR _pkey$[esp+4104]
	push	esi
	mov	esi, DWORD PTR _cert$[esp+4108]
	push	edi
	mov	edi, DWORD PTR _p7$[esp+4112]
; Line 528
	test	edi, edi
	jne	SHORT $LN5@PKCS7_decr
; Line 529
	push	529					; 00000211H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	143					; 0000008fH
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 530
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN5@PKCS7_decr:
; Line 533
	push	DWORD PTR [edi+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 23					; 00000017H
	je	SHORT $LN6@PKCS7_decr
; Line 534
	push	534					; 00000216H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	113					; 00000071H
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 535
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN6@PKCS7_decr:
; Line 538
	test	esi, esi
	je	SHORT $LN7@PKCS7_decr
	push	ebp
	push	esi
	call	_X509_check_private_key
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN7@PKCS7_decr
; Line 539
	push	540					; 0000021cH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	127					; 0000007fH
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 541
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN7@PKCS7_decr:
; Line 544
	push	esi
	push	0
	push	ebp
	push	edi
	call	_PKCS7_dataDecode
	mov	edi, eax
	add	esp, 16					; 00000010H
	test	edi, edi
	jne	SHORT $LN8@PKCS7_decr
; Line 545
	push	545					; 00000221H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	119					; 00000077H
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 546
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN8@PKCS7_decr:
; Line 549
	test	BYTE PTR _flags$[esp+4112], 1
	je	$LN9@PKCS7_decr
; Line 552
	call	_BIO_f_buffer
	push	eax
	call	_BIO_new
	mov	esi, eax
	add	esp, 4
	test	esi, esi
	jne	SHORT $LN11@PKCS7_decr
; Line 553
	push	553					; 00000229H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
; Line 554
	push	edi
	call	_BIO_free_all
	add	esp, 24					; 00000018H
; Line 555
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN11@PKCS7_decr:
; Line 557
	push	edi
	push	esi
	call	_BIO_push
	mov	ebp, eax
	add	esp, 8
	test	ebp, ebp
	jne	SHORT $LN12@PKCS7_decr
; Line 558
	push	558					; 0000022eH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	114					; 00000072H
	push	33					; 00000021H
	call	_ERR_put_error
; Line 559
	push	esi
	call	_BIO_free_all
; Line 560
	push	edi
	call	_BIO_free_all
	add	esp, 28					; 0000001cH
; Line 561
	xor	eax, eax
	jmp	$LN10@PKCS7_decr
$LN12@PKCS7_decr:
; Line 563
	push	ebx
	push	ebp
	call	_SMIME_text
	mov	esi, eax
	add	esp, 8
; Line 564
	test	esi, esi
	jle	SHORT $LN14@PKCS7_decr
	push	edi
	call	_BIO_method_type
	add	esp, 4
	cmp	eax, 522				; 0000020aH
	jne	SHORT $LN14@PKCS7_decr
; Line 565
	push	0
	push	0
	push	113					; 00000071H
	push	edi
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	neg	eax
	sbb	eax, eax
	and	esi, eax
$LN14@PKCS7_decr:
; Line 568
	push	ebp
; Line 569
	jmp	SHORT $LN26@PKCS7_decr
$LN9@PKCS7_decr:
; Line 572
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4120]
	push	eax
	push	edi
	call	_BIO_read
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 573
	test	esi, esi
	jle	SHORT $LN22@PKCS7_decr
$LL2@PKCS7_decr:
; Line 582
	push	esi
	lea	eax, DWORD PTR _buf$[esp+4120]
	push	eax
	push	ebx
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, esi
	jne	SHORT $LN23@PKCS7_decr
; Line 572
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4120]
	push	eax
	push	edi
	call	_BIO_read
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 573
	test	esi, esi
	jg	SHORT $LL2@PKCS7_decr
$LN22@PKCS7_decr:
; Line 575
	push	edi
	mov	esi, 1
	call	_BIO_method_type
	add	esp, 4
	cmp	eax, 522				; 0000020aH
	jne	SHORT $LN3@PKCS7_decr
; Line 576
	push	0
	push	0
	push	113					; 00000071H
	push	edi
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN3@PKCS7_decr
$LN23@PKCS7_decr:
; Line 577
	xor	esi, esi
$LN3@PKCS7_decr:
; Line 587
	push	edi
$LN26@PKCS7_decr:
	call	_BIO_free_all
; Line 588
	mov	eax, esi
	add	esp, 4
$LN10@PKCS7_decr:
; Line 590
	mov	ecx, DWORD PTR __$ArrayPad$[esp+4116]
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 4100				; 00001004H
	ret	0
_PKCS7_decrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_encrypt
_TEXT	SEGMENT
_certs$ = 8						; size = 4
_in$ = 12						; size = 4
_cipher$ = 16						; size = 4
_flags$ = 20						; size = 4
_PKCS7_encrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 483
	push	edi
; Line 488
	call	_PKCS7_new
	mov	edi, eax
	test	edi, edi
	jne	SHORT $LN5@PKCS7_encr
; Line 489
	push	489					; 000001e9H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	115					; 00000073H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 490
	xor	eax, eax
	pop	edi
; Line 520
	ret	0
$LN5@PKCS7_encr:
	push	ebx
	push	esi
; Line 493
	push	23					; 00000017H
	push	edi
	call	_PKCS7_set_type
	add	esp, 8
	test	eax, eax
	je	SHORT $err$22
; Line 495
	push	DWORD PTR _cipher$[esp+8]
	push	edi
	call	_PKCS7_set_cipher
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN7@PKCS7_encr
; Line 496
	push	496					; 000001f0H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	121					; 00000079H
$LN19@PKCS7_encr:
; Line 503
	push	115					; 00000073H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$22:
; Line 516
	push	0
	call	_BIO_free_all
; Line 517
	push	edi
	call	_PKCS7_free
	add	esp, 8
; Line 518
	xor	eax, eax
	pop	esi
	pop	ebx
	pop	edi
; Line 520
	ret	0
$LN7@PKCS7_encr:
; Line 500
	mov	ebx, DWORD PTR _certs$[esp+8]
	xor	esi, esi
	push	ebx
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@PKCS7_encr
	npad	5
$LL4@PKCS7_encr:
; Line 501
	push	esi
	push	ebx
	call	_sk_value
; Line 502
	push	eax
	push	edi
	call	_PKCS7_add_recipient
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN13@PKCS7_encr
; Line 500
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@PKCS7_encr
$LN3@PKCS7_encr:
; Line 508
	mov	eax, DWORD PTR _flags$[esp+8]
	test	eax, 4096				; 00001000H
	jne	SHORT $LN20@PKCS7_encr
; Line 511
	push	eax
	push	DWORD PTR _in$[esp+12]
	push	edi
	call	_PKCS7_final
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$22
$LN20@PKCS7_encr:
	pop	esi
	pop	ebx
; Line 512
	mov	eax, edi
	pop	edi
; Line 520
	ret	0
$LN13@PKCS7_encr:
; Line 503
	push	503					; 000001f7H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	120					; 00000078H
; Line 504
	jmp	$LN19@PKCS7_encr
_PKCS7_encrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_get0_signers
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_certs$ = 12						; size = 4
_flags$ = 16						; size = 4
_PKCS7_get0_signers PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 419
	push	ebx
; Line 427
	mov	ebx, DWORD PTR _p7$[esp]
	test	ebx, ebx
	jne	SHORT $LN5@PKCS7_get0
; Line 428
	push	428					; 000001acH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	143					; 0000008fH
	push	124					; 0000007cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 429
	xor	eax, eax
	pop	ebx
; Line 477
	ret	0
$LN5@PKCS7_get0:
; Line 432
	push	DWORD PTR [ebx+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 22					; 00000016H
	je	SHORT $LN6@PKCS7_get0
; Line 433
	push	433					; 000001b1H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	113					; 00000071H
	push	124					; 0000007cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 434
	xor	eax, eax
	pop	ebx
; Line 477
	ret	0
$LN6@PKCS7_get0:
; Line 439
	push	ebx
	call	_PKCS7_get_signer_info
	mov	ebx, eax
; Line 441
	push	ebx
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jg	SHORT $LN7@PKCS7_get0
; Line 442
	push	442					; 000001baH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	142					; 0000008eH
	push	124					; 0000007cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 443
	xor	eax, eax
	pop	ebx
; Line 477
	ret	0
$LN7@PKCS7_get0:
	push	ebp
; Line 446
	call	_sk_new_null
	mov	ebp, eax
	test	ebp, ebp
	jne	SHORT $LN8@PKCS7_get0
; Line 447
	push	447					; 000001bfH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	124					; 0000007cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 448
	xor	eax, eax
	pop	ebp
	pop	ebx
; Line 477
	ret	0
$LN8@PKCS7_get0:
	push	esi
	push	edi
; Line 451
	push	ebx
	xor	esi, esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@PKCS7_get0
$LL4@PKCS7_get0:
; Line 452
	push	esi
	push	ebx
	call	_sk_value
	add	esp, 8
; Line 453
	mov	edi, DWORD PTR [eax+4]
; Line 456
	mov	eax, DWORD PTR _certs$[esp+12]
	test	eax, eax
	je	SHORT $LN21@PKCS7_get0
; Line 457
	push	DWORD PTR [edi+4]
	push	DWORD PTR [edi]
	push	eax
	call	_X509_find_by_issuer_and_serial
	add	esp, 12					; 0000000cH
; Line 460
	test	eax, eax
	jne	SHORT $LN20@PKCS7_get0
$LN21@PKCS7_get0:
	test	BYTE PTR _flags$[esp+12], 16		; 00000010H
	jne	SHORT $LN15@PKCS7_get0
	mov	eax, DWORD PTR _p7$[esp+12]
	mov	eax, DWORD PTR [eax+20]
	mov	eax, DWORD PTR [eax+8]
	test	eax, eax
	je	SHORT $LN15@PKCS7_get0
; Line 461
	push	DWORD PTR [edi+4]
	push	DWORD PTR [edi]
	push	eax
	call	_X509_find_by_issuer_and_serial
	add	esp, 12					; 0000000cH
; Line 464
	test	eax, eax
	je	SHORT $LN15@PKCS7_get0
$LN20@PKCS7_get0:
; Line 471
	push	eax
	push	ebp
	call	_sk_push
	add	esp, 8
	test	eax, eax
	je	SHORT $LN16@PKCS7_get0
; Line 451
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@PKCS7_get0
$LN3@PKCS7_get0:
	pop	edi
	pop	esi
; Line 476
	mov	eax, ebp
	pop	ebp
	pop	ebx
; Line 477
	ret	0
$LN16@PKCS7_get0:
; Line 472
	push	ebp
	call	_sk_free
	add	esp, 4
; Line 473
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 477
	ret	0
$LN15@PKCS7_get0:
; Line 465
	push	466					; 000001d2H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	128					; 00000080H
	push	124					; 0000007cH
	push	33					; 00000021H
	call	_ERR_put_error
; Line 467
	push	ebp
	call	_sk_free
	add	esp, 24					; 00000018H
; Line 468
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 477
	ret	0
_PKCS7_get0_signers ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_verify
_TEXT	SEGMENT
_store$GSCopy$1$ = -4272				; size = 4
_p7bio$1$ = -4272					; size = 4
_flags$GSCopy$1$ = -4268				; size = 4
_sinfos$1$ = -4264					; size = 4
_tmpin$1$ = -4260					; size = 4
tv360 = -4256						; size = 4
_ptr$1 = -4256						; size = 4
_j$1$ = -4252						; size = 4
_out$GSCopy$1$ = -4248					; size = 4
_indata$GSCopy$1$ = -4244				; size = 4
_signers$1$ = -4240					; size = 4
_cert_ctx$ = -4236					; size = 136
_buf$ = -4100						; size = 4096
__$ArrayPad$ = -4					; size = 4
_p7$ = 8						; size = 4
_certs$ = 12						; size = 4
_store$ = 16						; size = 4
_indata$ = 20						; size = 4
_out$ = 24						; size = 4
_flags$ = 28						; size = 4
_PKCS7_verify PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 251
	mov	eax, 4272				; 000010b0H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+4272], eax
	mov	eax, DWORD PTR _store$[esp+4268]
	mov	DWORD PTR _store$GSCopy$1$[esp+4272], eax
	mov	eax, DWORD PTR _out$[esp+4268]
	push	ebx
	mov	ebx, DWORD PTR _p7$[esp+4272]
	mov	DWORD PTR _out$GSCopy$1$[esp+4276], eax
	mov	eax, DWORD PTR _flags$[esp+4272]
	push	ebp
	mov	ebp, DWORD PTR _indata$[esp+4276]
	mov	DWORD PTR _flags$GSCopy$1$[esp+4280], eax
; Line 258
	xor	eax, eax
	mov	DWORD PTR _indata$GSCopy$1$[esp+4280], ebp
	mov	DWORD PTR _j$1$[esp+4280], eax
; Line 260
	mov	DWORD PTR _tmpin$1$[esp+4280], eax
	push	esi
	mov	esi, DWORD PTR _certs$[esp+4280]
; Line 262
	test	ebx, ebx
	jne	SHORT $LN11@PKCS7_veri
; Line 263
	push	263					; 00000107H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	143					; 0000008fH
; Line 264
	jmp	$LN62@PKCS7_veri
$LN11@PKCS7_veri:
; Line 267
	push	DWORD PTR [ebx+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 22					; 00000016H
	je	SHORT $LN12@PKCS7_veri
; Line 268
	push	268					; 0000010cH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	113					; 00000071H
; Line 269
	jmp	$LN62@PKCS7_veri
$LN12@PKCS7_veri:
; Line 273
	push	0
	push	0
	push	2
	push	ebx
	call	_PKCS7_ctrl
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN13@PKCS7_veri
	test	ebp, ebp
	jne	SHORT $LN13@PKCS7_veri
; Line 274
	push	274					; 00000112H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	122					; 0000007aH
; Line 275
	jmp	$LN62@PKCS7_veri
$LN13@PKCS7_veri:
; Line 301
	push	ebx
	call	_PKCS7_get_signer_info
	add	esp, 4
	mov	DWORD PTR _sinfos$1$[esp+4284], eax
; Line 303
	test	eax, eax
	je	$LN15@PKCS7_veri
	push	eax
	call	_sk_num
	add	esp, 4
	test	eax, eax
	je	$LN15@PKCS7_veri
; Line 308
	push	DWORD PTR _flags$GSCopy$1$[esp+4284]
	push	esi
	push	ebx
	call	_PKCS7_get0_signers
	mov	ebp, eax
	add	esp, 12					; 0000000cH
	mov	DWORD PTR _signers$1$[esp+4284], ebp
; Line 309
	test	ebp, ebp
	je	$LN63@PKCS7_veri
; Line 314
	test	BYTE PTR _flags$GSCopy$1$[esp+4284], 32	; 00000020H
	push	edi
	jne	$LN3@PKCS7_veri
; Line 315
	push	ebp
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	$LN3@PKCS7_veri
	mov	esi, DWORD PTR _flags$GSCopy$1$[esp+4288]
	and	esi, 8
	mov	DWORD PTR tv360[esp+4288], esi
	npad	5
$LL4@PKCS7_veri:
; Line 316
	push	edi
	push	ebp
	call	_sk_value
	add	esp, 8
	mov	ecx, eax
; Line 317
	test	esi, esi
	jne	SHORT $LN18@PKCS7_veri
; Line 318
	mov	eax, DWORD PTR [ebx+20]
	push	DWORD PTR [eax+8]
	lea	eax, DWORD PTR _cert_ctx$[esp+4292]
	push	ecx
	push	DWORD PTR _store$GSCopy$1$[esp+4296]
	push	eax
	call	_X509_STORE_CTX_init
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN44@PKCS7_veri
; Line 323
	lea	eax, DWORD PTR _cert_ctx$[esp+4288]
	push	OFFSET ??_C@_0L@GGDBHMO@smime_sign?$AA@
	push	eax
	call	_X509_STORE_CTX_set_default
	add	esp, 8
	jmp	SHORT $LN21@PKCS7_veri
$LN18@PKCS7_veri:
; Line 324
	push	0
	push	ecx
	push	DWORD PTR _store$GSCopy$1$[esp+4296]
	lea	eax, DWORD PTR _cert_ctx$[esp+4300]
	push	eax
	call	_X509_STORE_CTX_init
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN45@PKCS7_veri
$LN21@PKCS7_veri:
; Line 328
	test	DWORD PTR _flags$GSCopy$1$[esp+4288], 8192 ; 00002000H
	jne	SHORT $LN22@PKCS7_veri
; Line 329
	mov	eax, DWORD PTR [ebx+20]
	push	DWORD PTR [eax+12]
	lea	eax, DWORD PTR _cert_ctx$[esp+4292]
	push	eax
	call	_X509_STORE_CTX_set0_crls
	add	esp, 8
$LN22@PKCS7_veri:
; Line 330
	lea	eax, DWORD PTR _cert_ctx$[esp+4288]
	push	eax
	call	_X509_verify_cert
	mov	esi, eax
	add	esp, 4
; Line 331
	test	esi, esi
	jg	SHORT $LN23@PKCS7_veri
; Line 332
	lea	eax, DWORD PTR _cert_ctx$[esp+4288]
	push	eax
	call	_X509_STORE_CTX_get_error
	add	esp, 4
	mov	DWORD PTR _j$1$[esp+4288], eax
$LN23@PKCS7_veri:
; Line 333
	lea	eax, DWORD PTR _cert_ctx$[esp+4288]
	push	eax
	call	_X509_STORE_CTX_cleanup
	add	esp, 4
; Line 334
	test	esi, esi
	jle	SHORT $LN46@PKCS7_veri
; Line 315
	push	ebp
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jge	$LN3@PKCS7_veri
	mov	esi, DWORD PTR tv360[esp+4288]
	jmp	$LL4@PKCS7_veri
$LN44@PKCS7_veri:
; Line 320
	push	320					; 00000140H
$LN64@PKCS7_veri:
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	11					; 0000000bH
$LN65@PKCS7_veri:
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN66@PKCS7_veri:
; Line 339
	xor	esi, esi
$LN61@PKCS7_veri:
	xor	ebx, ebx
$err$68:
; Line 408
	mov	eax, DWORD PTR _indata$GSCopy$1$[esp+4288]
	pop	edi
	cmp	DWORD PTR _tmpin$1$[esp+4284], eax
	jne	SHORT $LN39@PKCS7_veri
; Line 409
	test	eax, eax
	je	SHORT $LN39@PKCS7_veri
; Line 410
	push	esi
	call	_BIO_pop
	add	esp, 4
$LN39@PKCS7_veri:
; Line 412
	push	esi
	call	_BIO_free_all
; Line 413
	push	ebp
	call	_sk_free
	add	esp, 8
; Line 414
	mov	eax, ebx
	pop	esi
	pop	ebp
	pop	ebx
; Line 415
	mov	ecx, DWORD PTR __$ArrayPad$[esp+4272]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 4272				; 000010b0H
	ret	0
$LN46@PKCS7_veri:
; Line 335
	push	336					; 00000150H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	117					; 00000075H
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
; Line 337
	mov	eax, DWORD PTR _j$1$[esp+4308]
	push	eax
	call	_X509_verify_cert_error_string
	push	eax
	push	OFFSET ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
	push	2
	call	_ERR_add_error_data
	add	esp, 36					; 00000024H
; Line 339
	jmp	SHORT $LN66@PKCS7_veri
$LN45@PKCS7_veri:
; Line 325
	push	325					; 00000145H
; Line 326
	jmp	$LN64@PKCS7_veri
$LN3@PKCS7_veri:
; Line 351
	mov	esi, DWORD PTR _indata$GSCopy$1$[esp+4288]
	test	esi, esi
	je	SHORT $LN25@PKCS7_veri
	push	esi
	call	_BIO_method_type
	add	esp, 4
	cmp	eax, 1025				; 00000401H
	jne	SHORT $LN25@PKCS7_veri
; Line 354
	lea	eax, DWORD PTR _ptr$1[esp+4288]
	push	eax
	push	0
	push	3
	push	esi
	call	_BIO_ctrl
; Line 355
	push	eax
	push	DWORD PTR _ptr$1[esp+4308]
	call	_BIO_new_mem_buf
	add	esp, 24					; 00000018H
	mov	DWORD PTR _tmpin$1$[esp+4288], eax
; Line 356
	test	eax, eax
	jne	SHORT $LN26@PKCS7_veri
; Line 357
	push	357					; 00000165H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
; Line 358
	jmp	$LN65@PKCS7_veri
$LN25@PKCS7_veri:
; Line 361
	mov	eax, esi
	mov	DWORD PTR _tmpin$1$[esp+4288], esi
$LN26@PKCS7_veri:
; Line 363
	push	eax
	push	ebx
	call	_PKCS7_dataInit
	mov	esi, eax
	add	esp, 8
	mov	DWORD PTR _p7bio$1$[esp+4288], esi
	test	esi, esi
	je	$LN61@PKCS7_veri
; Line 366
	mov	edi, DWORD PTR _flags$GSCopy$1$[esp+4288]
	and	edi, 1
	je	SHORT $LN29@PKCS7_veri
; Line 367
	call	_BIO_s_mem
	push	eax
	call	_BIO_new
	mov	esi, eax
	add	esp, 4
	test	esi, esi
	jne	SHORT $LN31@PKCS7_veri
; Line 368
	push	368					; 00000170H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
; Line 369
	mov	esi, DWORD PTR _p7bio$1$[esp+4308]
	add	esp, 20					; 00000014H
	jmp	$LN61@PKCS7_veri
$LN31@PKCS7_veri:
; Line 371
	push	0
	push	0
	push	130					; 00000082H
	push	esi
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
; Line 372
	jmp	SHORT $LN30@PKCS7_veri
$LN29@PKCS7_veri:
; Line 373
	mov	esi, DWORD PTR _out$GSCopy$1$[esp+4288]
$LN30@PKCS7_veri:
; Line 377
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4292]
	push	eax
	push	DWORD PTR _p7bio$1$[esp+4296]
	call	_BIO_read
	add	esp, 12					; 0000000cH
; Line 378
	test	eax, eax
	jle	SHORT $LN47@PKCS7_veri
	mov	ebp, DWORD PTR _p7bio$1$[esp+4288]
$LL5@PKCS7_veri:
; Line 380
	test	esi, esi
	je	SHORT $LN33@PKCS7_veri
; Line 381
	push	eax
	lea	eax, DWORD PTR _buf$[esp+4292]
	push	eax
	push	esi
	call	_BIO_write
	add	esp, 12					; 0000000cH
$LN33@PKCS7_veri:
; Line 377
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4292]
	push	eax
	push	ebp
	call	_BIO_read
	add	esp, 12					; 0000000cH
; Line 378
	test	eax, eax
	jg	SHORT $LL5@PKCS7_veri
	mov	ebp, DWORD PTR _signers$1$[esp+4288]
$LN47@PKCS7_veri:
; Line 384
	test	edi, edi
	je	SHORT $LN34@PKCS7_veri
; Line 385
	push	DWORD PTR _out$GSCopy$1$[esp+4288]
	push	esi
	call	_SMIME_text
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN35@PKCS7_veri
; Line 386
	push	386					; 00000182H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	129					; 00000081H
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
; Line 387
	push	esi
	call	_BIO_free
; Line 388
	mov	esi, DWORD PTR _p7bio$1$[esp+4312]
	add	esp, 24					; 00000018H
	jmp	$LN61@PKCS7_veri
$LN35@PKCS7_veri:
; Line 390
	push	esi
	call	_BIO_free
	add	esp, 4
$LN34@PKCS7_veri:
; Line 394
	test	BYTE PTR _flags$GSCopy$1$[esp+4288], 4
	jne	SHORT $LN59@PKCS7_veri
; Line 395
	mov	esi, DWORD PTR _sinfos$1$[esp+4288]
	xor	edi, edi
	push	esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jg	SHORT $LN10@PKCS7_veri
$LN59@PKCS7_veri:
	mov	esi, DWORD PTR _p7bio$1$[esp+4288]
; Line 405
	mov	ebx, 1
	jmp	$err$68
	npad	5
$LL60@PKCS7_veri:
	mov	esi, DWORD PTR _sinfos$1$[esp+4288]
$LN10@PKCS7_veri:
; Line 396
	push	edi
	push	esi
	call	_sk_value
; Line 397
	push	edi
	push	ebp
	mov	esi, eax
	call	_sk_value
; Line 398
	push	eax
	push	esi
	mov	esi, DWORD PTR _p7bio$1$[esp+4312]
	push	ebx
	push	esi
	call	_PKCS7_signatureVerify
	add	esp, 32					; 00000020H
; Line 399
	test	eax, eax
	jle	SHORT $LN48@PKCS7_veri
; Line 395
	push	DWORD PTR _sinfos$1$[esp+4288]
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL60@PKCS7_veri
; Line 405
	mov	ebx, 1
	jmp	$err$68
$LN48@PKCS7_veri:
; Line 400
	push	400					; 00000190H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	105					; 00000069H
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 401
	jmp	$LN61@PKCS7_veri
$LN15@PKCS7_veri:
; Line 304
	push	304					; 00000130H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	123					; 0000007bH
$LN62@PKCS7_veri:
	push	117					; 00000075H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN63@PKCS7_veri:
; Line 415
	mov	ecx, DWORD PTR __$ArrayPad$[esp+4284]
	xor	eax, eax
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 4272				; 000010b0H
	ret	0
_PKCS7_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_final
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_data$ = 12						; size = 4
_flags$ = 16						; size = 4
_PKCS7_final PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 113
	push	esi
	push	edi
; Line 115
	xor	edi, edi
; Line 116
	push	edi
	push	DWORD PTR _p7$[esp+8]
	call	_PKCS7_dataInit
	mov	esi, eax
	add	esp, 8
	test	esi, esi
	jne	SHORT $LN2@PKCS7_fina
; Line 117
	push	117					; 00000075H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	134					; 00000086H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 118
	xor	eax, eax
	pop	edi
	pop	esi
; Line 137
	ret	0
$LN2@PKCS7_fina:
; Line 121
	push	DWORD PTR _flags$[esp+4]
	push	esi
	push	DWORD PTR _data$[esp+12]
	call	_SMIME_crlf_copy
; Line 123
	push	0
	push	0
	push	11					; 0000000bH
	push	esi
	call	_BIO_ctrl
; Line 125
	push	esi
	push	DWORD PTR _p7$[esp+36]
	call	_PKCS7_dataFinal
	add	esp, 36					; 00000024H
	test	eax, eax
	jne	SHORT $LN3@PKCS7_fina
; Line 126
	push	126					; 0000007eH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	145					; 00000091H
	push	134					; 00000086H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 133
	push	esi
	call	_BIO_free_all
	add	esp, 4
; Line 135
	mov	eax, edi
	pop	edi
	pop	esi
; Line 137
	ret	0
$LN3@PKCS7_fina:
; Line 130
	mov	edi, 1
$err$6:
; Line 133
	push	esi
	call	_BIO_free_all
	add	esp, 4
; Line 135
	mov	eax, edi
	pop	edi
	pop	esi
; Line 137
	ret	0
_PKCS7_final ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_sign_add_signer
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_signcert$ = 12						; size = 4
_pkey$ = 16						; size = 4
_md$ = 20						; size = 4
_flags$ = 24						; size = 4
_PKCS7_sign_add_signer PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 158
	push	esi
; Line 161
	mov	esi, DWORD PTR _signcert$[esp]
	push	edi
	mov	edi, DWORD PTR _pkey$[esp+4]
	push	edi
	push	esi
	call	_X509_check_private_key
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN2@PKCS7_sign
; Line 162
	push	163					; 000000a3H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	127					; 0000007fH
	push	137					; 00000089H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 164
	xor	eax, eax
	pop	edi
	pop	esi
; Line 214
	ret	0
$LN2@PKCS7_sign:
	push	ebp
; Line 167
	push	DWORD PTR _md$[esp+8]
	mov	ebp, DWORD PTR _p7$[esp+12]
	push	edi
	push	esi
	push	ebp
	call	_PKCS7_add_signature
	mov	edi, eax
	add	esp, 16					; 00000010H
	test	edi, edi
	jne	SHORT $LN3@PKCS7_sign
; Line 168
	push	169					; 000000a9H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	124					; 0000007cH
	push	137					; 00000089H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 170
	xor	eax, eax
	pop	ebp
	pop	edi
	pop	esi
; Line 214
	ret	0
$LN3@PKCS7_sign:
	push	ebx
; Line 173
	mov	ebx, DWORD PTR _flags$[esp+12]
	test	bl, 2
	jne	SHORT $LN5@PKCS7_sign
; Line 174
	push	esi
	push	ebp
	call	_PKCS7_add_certificate
	add	esp, 8
	test	eax, eax
	je	$LN15@PKCS7_sign
$LN5@PKCS7_sign:
; Line 178
	test	ebx, 256				; 00000100H
	jne	$LN14@PKCS7_sign
; Line 179
	push	0
	push	edi
	call	_PKCS7_add_attrib_content_type
	add	esp, 8
	test	eax, eax
	je	$LN15@PKCS7_sign
; Line 182
	test	ebx, 512				; 00000200H
	jne	$LN8@PKCS7_sign
; Line 183
	call	_sk_new_null
	mov	esi, eax
	test	esi, esi
	jne	SHORT $LN9@PKCS7_sign
; Line 184
	push	184					; 000000b8H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	137					; 00000089H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 213
	xor	eax, eax
	pop	ebx
	pop	ebp
	pop	edi
	pop	esi
; Line 214
	ret	0
$LN9@PKCS7_sign:
; Line 197
	push	-1
	push	427					; 000001abH
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
; Line 150
	push	809					; 00000329H
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	add	esp, 8
	test	eax, eax
	je	SHORT $LN20@PKCS7_sign
; Line 151
	push	-1
	push	809					; 00000329H
	push	esi
	call	_PKCS7_simple_smimecap
	add	esp, 12					; 0000000cH
; Line 197
	test	eax, eax
	je	$err$24
$LN20@PKCS7_sign:
	push	-1
	push	813					; 0000032dH
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
	push	-1
	push	423					; 000001a7H
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
	push	-1
	push	419					; 000001a3H
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
	push	-1
	push	44					; 0000002cH
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
	push	128					; 00000080H
	push	37					; 00000025H
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$24
	push	64					; 00000040H
	push	37					; 00000025H
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$24
	push	-1
	push	31					; 0000001fH
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$24
	push	40					; 00000028H
	push	37					; 00000025H
	push	esi
	call	_add_cipher_smcap
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$24
	push	esi
	push	edi
	call	_PKCS7_add_attrib_smimecap
	add	esp, 8
	test	eax, eax
	je	SHORT $err$24
; Line 199
	push	OFFSET _X509_ALGOR_free
	push	esi
	call	_sk_pop_free
	add	esp, 8
$LN8@PKCS7_sign:
; Line 202
	test	ebx, 32768				; 00008000H
	je	SHORT $LN14@PKCS7_sign
; Line 203
	push	edi
	push	ebp
	call	_pkcs7_copy_existing_digest
	add	esp, 8
	test	eax, eax
	je	SHORT $LN15@PKCS7_sign
; Line 205
	test	ebx, 16384				; 00004000H
	jne	SHORT $LN14@PKCS7_sign
	push	edi
	call	_PKCS7_SIGNER_INFO_sign
	add	esp, 4
	test	eax, eax
	jne	SHORT $LN14@PKCS7_sign
$LN15@PKCS7_sign:
	pop	ebx
	pop	ebp
	pop	edi
; Line 213
	xor	eax, eax
	pop	esi
; Line 214
	ret	0
$err$24:
; Line 212
	push	OFFSET _X509_ALGOR_free
	push	esi
	call	_sk_pop_free
	add	esp, 8
; Line 213
	xor	eax, eax
	pop	ebx
	pop	ebp
	pop	edi
	pop	esi
; Line 214
	ret	0
$LN14@PKCS7_sign:
	pop	ebx
	pop	ebp
; Line 209
	mov	eax, edi
	pop	edi
	pop	esi
; Line 214
	ret	0
_PKCS7_sign_add_signer ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_sign
_TEXT	SEGMENT
_signcert$ = 8						; size = 4
_pkey$ = 12						; size = 4
_certs$ = 16						; size = 4
_data$ = 20						; size = 4
_flags$ = 24						; size = 4
_PKCS7_sign PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_smime.c
; Line 71
	push	esi
; Line 75
	call	_PKCS7_new
	mov	esi, eax
	test	esi, esi
	jne	SHORT $LN5@PKCS7_sign
; Line 76
	push	76					; 0000004cH
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	65					; 00000041H
	push	116					; 00000074H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 77
	xor	eax, eax
	pop	esi
; Line 110
	ret	0
$LN5@PKCS7_sign:
	push	ebx
	push	edi
; Line 80
	push	22					; 00000016H
	push	esi
	call	_PKCS7_set_type
	add	esp, 8
	test	eax, eax
	je	SHORT $err$25
; Line 83
	push	21					; 00000015H
	push	esi
	call	_PKCS7_content_new
	add	esp, 8
	test	eax, eax
	je	SHORT $err$25
; Line 86
	mov	eax, DWORD PTR _pkey$[esp+8]
	mov	ebx, DWORD PTR _flags$[esp+8]
	test	eax, eax
	je	SHORT $LN8@PKCS7_sign
	push	ebx
	push	0
	push	eax
	push	DWORD PTR _signcert$[esp+20]
	push	esi
	call	_PKCS7_sign_add_signer
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN8@PKCS7_sign
; Line 87
	push	87					; 00000057H
	push	OFFSET ??_C@_0BL@EEIGAKG@?4?2crypto?2pkcs7?2pk7_smime?4c?$AA@
	push	153					; 00000099H
	push	116					; 00000074H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$25:
; Line 108
	push	esi
	call	_PKCS7_free
	add	esp, 4
; Line 109
	xor	eax, eax
	pop	edi
	pop	ebx
	pop	esi
; Line 110
	ret	0
$LN8@PKCS7_sign:
; Line 91
	test	bl, 2
	jne	SHORT $LN3@PKCS7_sign
; Line 92
	mov	ebx, DWORD PTR _certs$[esp+8]
	xor	edi, edi
	push	ebx
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN20@PKCS7_sign
$LL4@PKCS7_sign:
; Line 93
	push	edi
	push	ebx
	call	_sk_value
	push	eax
	push	esi
	call	_PKCS7_add_certificate
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$25
; Line 92
	push	ebx
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL4@PKCS7_sign
$LN20@PKCS7_sign:
	mov	ebx, DWORD PTR _flags$[esp+8]
$LN3@PKCS7_sign:
; Line 98
	test	bl, 64					; 00000040H
	je	SHORT $LN11@PKCS7_sign
; Line 99
	push	0
	push	1
	push	1
	push	esi
	call	_PKCS7_ctrl
	add	esp, 16					; 00000010H
$LN11@PKCS7_sign:
; Line 101
	test	ebx, 20480				; 00005000H
	jne	SHORT $LN23@PKCS7_sign
; Line 104
	push	ebx
	push	DWORD PTR _data$[esp+12]
	push	esi
	call	_PKCS7_final
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $err$25
$LN23@PKCS7_sign:
	pop	edi
	pop	ebx
; Line 105
	mov	eax, esi
	pop	esi
; Line 110
	ret	0
_PKCS7_sign ENDP
_TEXT	ENDS
END
