; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\des\rpc_enc.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	__des_crypt
EXTRN	_DES_ncbc_encrypt:PROC
EXTRN	_DES_ecb_encrypt:PROC
EXTRN	_DES_set_key_unchecked:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
; Function compile flags: /Ogtpy
;	COMDAT __des_crypt
_TEXT	SEGMENT
_ks$ = -132						; size = 128
__$ArrayPad$ = -4					; size = 4
_buf$ = 8						; size = 4
_len$ = 12						; size = 4
_desp$ = 16						; size = 4
__des_crypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\des\rpc_enc.c
; Line 65
	mov	eax, 132				; 00000084H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+132], eax
	push	esi
	mov	esi, DWORD PTR _desp$[esp+132]
; Line 69
	lea	eax, DWORD PTR _ks$[esp+136]
	push	eax
	push	esi
	call	_DES_set_key_unchecked
; Line 70
	xor	edx, edx
	add	esp, 8
	cmp	DWORD PTR [esi+8], edx
	sete	dl
; Line 72
	cmp	DWORD PTR [esi+12], 0
; Line 73
	push	edx
	jne	SHORT $LN2@des_crypt
	mov	eax, DWORD PTR [esi+28]
	lea	ecx, DWORD PTR _ks$[esp+140]
	push	ecx
	push	eax
	push	eax
	call	_DES_ecb_encrypt
	add	esp, 16					; 00000010H
	jmp	SHORT $LN5@des_crypt
$LN2@des_crypt:
; Line 76
	mov	ecx, DWORD PTR [esi+28]
	lea	eax, DWORD PTR [esi+16]
	push	eax
	lea	eax, DWORD PTR _ks$[esp+144]
	push	eax
	push	DWORD PTR _len$[esp+144]
	push	ecx
	push	ecx
	call	_DES_ncbc_encrypt
	add	esp, 24					; 00000018H
$LN5@des_crypt:
; Line 100
	mov	ecx, DWORD PTR __$ArrayPad$[esp+136]
	mov	eax, 1
	pop	esi
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 132				; 00000084H
	ret	0
__des_crypt ENDP
_TEXT	ENDS
END
