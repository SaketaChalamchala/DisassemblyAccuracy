; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_kiss.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS12_parse
PUBLIC	??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@ ; `string'
PUBLIC	??_C@_00CNPNBAHC@?$AA@				; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_new_null:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_sk_push:PROC
EXTRN	_sk_pop:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_set_mark:PROC
EXTRN	_ERR_pop_to_mark:PROC
EXTRN	_ASN1_STRING_to_UTF8:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_EVP_PKEY_free:PROC
EXTRN	_PKCS7_free:PROC
EXTRN	_X509_free:PROC
EXTRN	_X509_alias_set1:PROC
EXTRN	_X509_keyid_set1:PROC
EXTRN	_X509_check_private_key:PROC
EXTRN	_PKCS8_PRIV_KEY_INFO_free:PROC
EXTRN	_EVP_PKCS82PKEY:PROC
EXTRN	_PKCS12_certbag2x509:PROC
EXTRN	_PKCS12_decrypt_skey:PROC
EXTRN	_PKCS12_unpack_p7data:PROC
EXTRN	_PKCS12_unpack_p7encdata:PROC
EXTRN	_PKCS12_unpack_authsafes:PROC
EXTRN	_PKCS12_get_attr_gen:PROC
EXTRN	_PKCS12_verify_mac:PROC
EXTRN	_PKCS12_SAFEBAG_free:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_00CNPNBAHC@?$AA@
CONST	SEGMENT
??_C@_00CNPNBAHC@?$AA@ DB 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@
CONST	SEGMENT
??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@ DB '.\crypto\pkcs'
	DB	'12\p12_kiss.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _parse_bag
_TEXT	SEGMENT
_data$1 = 8						; size = 4
_bag$ = 8						; size = 4
_pass$ = 12						; size = 4
_passlen$ = 16						; size = 4
_pkey$ = 20						; size = 4
_ocerts$ = 24						; size = 4
_parse_bag PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_kiss.c
; Line 228
	push	ebx
	push	ebp
	push	esi
; Line 235
	mov	esi, DWORD PTR _bag$[esp+8]
	xor	ebp, ebp
	push	edi
	push	156					; 0000009cH
	xor	ebx, ebx
	push	DWORD PTR [esi+8]
	call	_PKCS12_get_attr_gen
	add	esp, 8
	test	eax, eax
	je	SHORT $LN4@parse_bag
; Line 236
	mov	ebp, DWORD PTR [eax+4]
$LN4@parse_bag:
; Line 238
	push	157					; 0000009dH
	push	DWORD PTR [esi+8]
	call	_PKCS12_get_attr_gen
	add	esp, 8
	test	eax, eax
	je	SHORT $LN5@parse_bag
; Line 239
	mov	ebx, DWORD PTR [eax+4]
$LN5@parse_bag:
; Line 241
	push	DWORD PTR [esi]
	call	_OBJ_obj2nid
	add	eax, -150				; ffffff6aH
	add	esp, 4
	cmp	eax, 5
	ja	$LN24@parse_bag
	jmp	DWORD PTR $LN40@parse_bag[eax*4]
$LN6@parse_bag:
; Line 243
	mov	edi, DWORD PTR _pkey$[esp+12]
	test	edi, edi
	je	$LN24@parse_bag
	cmp	DWORD PTR [edi], 0
	jne	$LN24@parse_bag
; Line 245
	push	DWORD PTR [esi+4]
	call	_EVP_PKCS82PKEY
	add	esp, 4
	mov	DWORD PTR [edi], eax
	test	eax, eax
	jne	$LN24@parse_bag
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 299
	ret	0
$LN10@parse_bag:
; Line 250
	mov	edi, DWORD PTR _pkey$[esp+12]
	test	edi, edi
	je	$LN24@parse_bag
	cmp	DWORD PTR [edi], 0
	jne	$LN24@parse_bag
; Line 252
	push	DWORD PTR _passlen$[esp+12]
	push	DWORD PTR _pass$[esp+16]
	push	esi
	call	_PKCS12_decrypt_skey
	mov	esi, eax
	add	esp, 12					; 0000000cH
	test	esi, esi
	je	$LN37@parse_bag
; Line 254
	push	esi
	call	_EVP_PKCS82PKEY
; Line 255
	push	esi
	mov	DWORD PTR [edi], eax
	call	_PKCS8_PRIV_KEY_INFO_free
	add	esp, 8
; Line 256
	cmp	DWORD PTR [edi], 0
	jne	$LN24@parse_bag
; Line 257
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 299
	ret	0
$LN15@parse_bag:
; Line 261
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 158				; 0000009eH
	jne	$LN24@parse_bag
; Line 263
	push	esi
	call	_PKCS12_certbag2x509
	mov	edi, eax
	add	esp, 4
	test	edi, edi
	je	SHORT $LN37@parse_bag
; Line 265
	test	ebx, ebx
	je	SHORT $LN18@parse_bag
	push	DWORD PTR [ebx]
	push	DWORD PTR [ebx+8]
	push	edi
	call	_X509_keyid_set1
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN38@parse_bag
$LN18@parse_bag:
; Line 269
	test	ebp, ebp
	je	SHORT $LN21@parse_bag
; Line 272
	lea	eax, DWORD PTR _data$1[esp+12]
	push	ebp
	push	eax
	call	_ASN1_STRING_to_UTF8
	add	esp, 8
; Line 273
	test	eax, eax
	js	SHORT $LN21@parse_bag
; Line 274
	push	eax
	push	DWORD PTR _data$1[esp+16]
	push	edi
	call	_X509_alias_set1
; Line 275
	push	DWORD PTR _data$1[esp+24]
	mov	esi, eax
	call	_CRYPTO_free
	add	esp, 16					; 00000010H
; Line 276
	test	esi, esi
	je	SHORT $LN38@parse_bag
$LN21@parse_bag:
; Line 283
	push	edi
	push	DWORD PTR _ocerts$[esp+16]
	call	_sk_push
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN24@parse_bag
$LN38@parse_bag:
; Line 284
	push	edi
	call	_X509_free
	add	esp, 4
$LN37@parse_bag:
; Line 285
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 299
	ret	0
$LN23@parse_bag:
; Line 291
	mov	edi, DWORD PTR [esi+4]
; Line 218
	xor	esi, esi
	push	edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN24@parse_bag
	mov	ebx, DWORD PTR _ocerts$[esp+12]
	mov	ebp, DWORD PTR _pkey$[esp+12]
$LL29@parse_bag:
; Line 219
	push	ebx
	push	ebp
	push	DWORD PTR _passlen$[esp+20]
	push	DWORD PTR _pass$[esp+24]
	push	esi
	push	edi
	call	_sk_value
	add	esp, 8
	push	eax
	call	_parse_bag
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN37@parse_bag
; Line 218
	push	edi
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL29@parse_bag
$LN24@parse_bag:
	pop	edi
	pop	esi
	pop	ebp
; Line 295
	mov	eax, 1
	pop	ebx
; Line 299
	ret	0
	npad	3
$LN40@parse_bag:
	DD	$LN6@parse_bag
	DD	$LN10@parse_bag
	DD	$LN15@parse_bag
	DD	$LN24@parse_bag
	DD	$LN24@parse_bag
	DD	$LN23@parse_bag
_parse_bag ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _parse_bags
_TEXT	SEGMENT
_fname$1$ = -8						; size = 4
_data$1 = -4						; size = 4
_bags$ = 8						; size = 4
_pass$ = 12						; size = 4
_passlen$ = 16						; size = 4
_pkey$ = 20						; size = 4
_ocerts$ = 24						; size = 4
_parse_bags PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_kiss.c
; Line 216
	mov	eax, 8
	call	__chkstk
	push	ebx
; Line 218
	mov	ebx, DWORD PTR _bags$[esp+8]
	push	ebp
	push	esi
	push	edi
	push	ebx
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	$LN3@parse_bags
$LL4@parse_bags:
; Line 219
	push	edi
	push	ebx
	call	_sk_value
	mov	esi, eax
; Line 232
	mov	DWORD PTR _fname$1$[esp+32], 0
; Line 235
	push	156					; 0000009cH
	xor	ebp, ebp
	push	DWORD PTR [esi+8]
	call	_PKCS12_get_attr_gen
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN10@parse_bags
; Line 236
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR _fname$1$[esp+24], eax
$LN10@parse_bags:
; Line 238
	push	157					; 0000009dH
	push	DWORD PTR [esi+8]
	call	_PKCS12_get_attr_gen
	add	esp, 8
	test	eax, eax
	je	SHORT $LN11@parse_bags
; Line 239
	mov	ebp, DWORD PTR [eax+4]
$LN11@parse_bags:
; Line 241
	push	DWORD PTR [esi]
	call	_OBJ_obj2nid
	add	eax, -150				; ffffff6aH
	add	esp, 4
	cmp	eax, 5
	ja	$LN37@parse_bags
	jmp	DWORD PTR $LN49@parse_bags[eax*4]
$LN12@parse_bags:
; Line 243
	mov	ebp, DWORD PTR _pkey$[esp+20]
	test	ebp, ebp
	je	$LN37@parse_bags
	cmp	DWORD PTR [ebp], 0
	jne	$LN37@parse_bags
; Line 245
	push	DWORD PTR [esi+4]
	call	_EVP_PKCS82PKEY
	add	esp, 4
	mov	DWORD PTR [ebp], eax
; Line 247
	jmp	$LN47@parse_bags
$LN16@parse_bags:
; Line 250
	mov	ebp, DWORD PTR _pkey$[esp+20]
	test	ebp, ebp
	je	$LN37@parse_bags
	cmp	DWORD PTR [ebp], 0
	jne	$LN37@parse_bags
; Line 252
	push	DWORD PTR _passlen$[esp+20]
	push	DWORD PTR _pass$[esp+24]
	push	esi
	call	_PKCS12_decrypt_skey
	mov	esi, eax
	add	esp, 12					; 0000000cH
	test	esi, esi
	je	$LN33@parse_bags
; Line 254
	push	esi
	call	_EVP_PKCS82PKEY
; Line 255
	push	esi
	mov	DWORD PTR [ebp], eax
	call	_PKCS8_PRIV_KEY_INFO_free
	add	esp, 8
; Line 256
	cmp	DWORD PTR [ebp], 0
; Line 258
	jmp	$LN46@parse_bags
$LN21@parse_bags:
; Line 261
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 158				; 0000009eH
	jne	$LN37@parse_bags
; Line 263
	push	esi
	call	_PKCS12_certbag2x509
	mov	ebx, eax
	add	esp, 4
	test	ebx, ebx
	je	$LN33@parse_bags
; Line 265
	test	ebp, ebp
	je	SHORT $LN24@parse_bags
	push	DWORD PTR [ebp]
	push	DWORD PTR [ebp+8]
	push	ebx
	call	_X509_keyid_set1
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN45@parse_bags
$LN24@parse_bags:
; Line 269
	mov	eax, DWORD PTR _fname$1$[esp+24]
	test	eax, eax
	je	SHORT $LN27@parse_bags
; Line 272
	push	eax
	lea	eax, DWORD PTR _data$1[esp+28]
	push	eax
	call	_ASN1_STRING_to_UTF8
	add	esp, 8
; Line 273
	test	eax, eax
	js	SHORT $LN27@parse_bags
; Line 274
	push	eax
	push	DWORD PTR _data$1[esp+28]
	push	ebx
	call	_X509_alias_set1
; Line 275
	push	DWORD PTR _data$1[esp+36]
	mov	esi, eax
	call	_CRYPTO_free
	add	esp, 16					; 00000010H
; Line 276
	test	esi, esi
	je	SHORT $LN45@parse_bags
$LN27@parse_bags:
; Line 283
	push	ebx
	push	DWORD PTR _ocerts$[esp+24]
	call	_sk_push
	add	esp, 8
	test	eax, eax
	je	SHORT $LN45@parse_bags
; Line 298
	mov	ebx, DWORD PTR _bags$[esp+20]
	jmp	SHORT $LN37@parse_bags
$LN29@parse_bags:
; Line 291
	push	DWORD PTR _ocerts$[esp+20]
	push	DWORD PTR _pkey$[esp+24]
	push	DWORD PTR _passlen$[esp+28]
	push	DWORD PTR _pass$[esp+32]
	push	DWORD PTR [esi+4]
	call	_parse_bags
	add	esp, 20					; 00000014H
$LN47@parse_bags:
; Line 219
	test	eax, eax
$LN46@parse_bags:
	je	SHORT $LN33@parse_bags
$LN37@parse_bags:
; Line 218
	push	ebx
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	$LL4@parse_bags
$LN3@parse_bags:
	pop	edi
	pop	esi
	pop	ebp
; Line 223
	mov	eax, 1
	pop	ebx
; Line 224
	add	esp, 8
	ret	0
$LN45@parse_bags:
; Line 284
	push	ebx
	call	_X509_free
	add	esp, 4
$LN33@parse_bags:
	pop	edi
	pop	esi
	pop	ebp
; Line 221
	xor	eax, eax
	pop	ebx
; Line 224
	add	esp, 8
	ret	0
	npad	1
$LN49@parse_bags:
	DD	$LN12@parse_bags
	DD	$LN16@parse_bags
	DD	$LN21@parse_bags
	DD	$LN37@parse_bags
	DD	$LN37@parse_bags
	DD	$LN29@parse_bags
_parse_bags ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _parse_pk12
_TEXT	SEGMENT
_p12$ = 8						; size = 4
_pass$ = 12						; size = 4
_passlen$ = 16						; size = 4
_pkey$ = 20						; size = 4
_ocerts$ = 24						; size = 4
_parse_pk12 PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_kiss.c
; Line 182
	push	ebx
; Line 188
	push	DWORD PTR _p12$[esp]
	call	_PKCS12_unpack_authsafes
	mov	ebx, eax
	add	esp, 4
	test	ebx, ebx
	jne	SHORT $LN5@parse_pk12
	pop	ebx
; Line 212
	ret	0
$LN5@parse_pk12:
	push	ebp
	push	esi
	push	edi
; Line 190
	push	ebx
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN19@parse_pk12
	mov	ebp, DWORD PTR _passlen$[esp+12]
	npad	5
$LL4@parse_pk12:
; Line 191
	push	edi
	push	ebx
	call	_sk_value
	mov	esi, eax
; Line 192
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 12					; 0000000cH
; Line 193
	cmp	eax, 21					; 00000015H
	jne	SHORT $LN6@parse_pk12
; Line 194
	push	esi
	call	_PKCS12_unpack_p7data
	add	esp, 4
	jmp	SHORT $LN23@parse_pk12
$LN6@parse_pk12:
; Line 195
	cmp	eax, 26					; 0000001aH
	jne	SHORT $LN2@parse_pk12
; Line 196
	push	ebp
	push	DWORD PTR _pass$[esp+16]
	push	esi
	call	_PKCS12_unpack_p7encdata
	add	esp, 12					; 0000000cH
$LN23@parse_pk12:
	mov	esi, eax
; Line 199
	test	esi, esi
	je	SHORT $LN14@parse_pk12
; Line 203
	push	DWORD PTR _ocerts$[esp+12]
	push	DWORD PTR _pkey$[esp+16]
	push	ebp
	push	DWORD PTR _pass$[esp+24]
	push	esi
	call	_parse_bags
	add	esp, 20					; 00000014H
; Line 208
	push	OFFSET _PKCS12_SAFEBAG_free
	push	esi
	test	eax, eax
	je	SHORT $LN15@parse_pk12
	call	_sk_pop_free
	add	esp, 8
$LN2@parse_pk12:
; Line 190
	push	ebx
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL4@parse_pk12
$LN19@parse_pk12:
; Line 210
	push	OFFSET _PKCS7_free
	push	ebx
	call	_sk_pop_free
	add	esp, 8
; Line 211
	mov	eax, 1
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 212
	ret	0
$LN15@parse_pk12:
; Line 204
	call	_sk_pop_free
; Line 205
	push	OFFSET _PKCS7_free
	push	ebx
	call	_sk_pop_free
	add	esp, 16					; 00000010H
; Line 206
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 212
	ret	0
$LN14@parse_pk12:
; Line 200
	push	OFFSET _PKCS7_free
	push	ebx
	call	_sk_pop_free
	add	esp, 8
; Line 201
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 212
	ret	0
_parse_pk12 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS12_parse
_TEXT	SEGMENT
_ocerts$1$ = -4						; size = 4
_p12$ = 8						; size = 4
_pass$ = 12						; size = 4
_pkey$ = 16						; size = 4
_cert$ = 20						; size = 4
_ca$ = 24						; size = 4
_PKCS12_parse PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs12\p12_kiss.c
; Line 84
	mov	eax, 4
	call	__chkstk
; Line 89
	mov	eax, DWORD PTR _p12$[esp]
	push	esi
	xor	esi, esi
	mov	DWORD PTR _ocerts$1$[esp+8], 0
	test	eax, eax
	jne	SHORT $LN4@PKCS12_par
; Line 90
	push	91					; 0000005bH
	push	OFFSET ??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@
	push	105					; 00000069H
	push	118					; 00000076H
	push	35					; 00000023H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 92
	xor	eax, eax
	pop	esi
; Line 176
	pop	ecx
	ret	0
$LN4@PKCS12_par:
	push	edi
; Line 95
	mov	edi, DWORD PTR _pkey$[esp+8]
	test	edi, edi
	je	SHORT $LN5@PKCS12_par
; Line 96
	mov	DWORD PTR [edi], esi
$LN5@PKCS12_par:
	push	ebp
; Line 97
	mov	ebp, DWORD PTR _cert$[esp+12]
	test	ebp, ebp
	je	SHORT $LN6@PKCS12_par
; Line 98
	mov	DWORD PTR [ebp], esi
$LN6@PKCS12_par:
	push	ebx
; Line 109
	mov	ebx, DWORD PTR _pass$[esp+16]
	test	ebx, ebx
	je	SHORT $LN9@PKCS12_par
	cmp	BYTE PTR [ebx], 0
	je	SHORT $LN9@PKCS12_par
; Line 118
	push	-1
	push	ebx
	push	eax
	call	_PKCS12_verify_mac
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN13@PKCS12_par
; Line 119
	push	119					; 00000077H
; Line 120
	jmp	$LN39@PKCS12_par
$LN9@PKCS12_par:
; Line 110
	push	0
	push	0
	push	eax
	call	_PKCS12_verify_mac
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN10@PKCS12_par
; Line 111
	xor	ebx, ebx
	jmp	SHORT $LN13@PKCS12_par
$LN10@PKCS12_par:
; Line 112
	push	0
	push	OFFSET ??_C@_00CNPNBAHC@?$AA@
	push	DWORD PTR _p12$[esp+24]
	call	_PKCS12_verify_mac
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN12@PKCS12_par
; Line 113
	mov	ebx, OFFSET ??_C@_00CNPNBAHC@?$AA@
$LN13@PKCS12_par:
; Line 124
	call	_sk_new_null
	mov	DWORD PTR _ocerts$1$[esp+20], eax
; Line 126
	test	eax, eax
	jne	SHORT $LN15@PKCS12_par
; Line 127
	push	127					; 0000007fH
	push	OFFSET ??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@
	push	65					; 00000041H
	push	118					; 00000076H
	push	35					; 00000023H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 174
	xor	eax, eax
	pop	ebx
	pop	ebp
	pop	edi
	pop	esi
; Line 176
	pop	ecx
	ret	0
$LN15@PKCS12_par:
; Line 131
	push	eax
	push	edi
	push	-1
	push	ebx
	push	DWORD PTR _p12$[esp+32]
	call	_parse_pk12
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN30@PKCS12_par
; Line 132
	push	132					; 00000084H
	push	OFFSET ??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@
	push	114					; 00000072H
; Line 133
	jmp	$LN40@PKCS12_par
$LN30@PKCS12_par:
; Line 136
	push	DWORD PTR _ocerts$1$[esp+20]
	call	_sk_pop
	mov	esi, eax
	add	esp, 4
	test	esi, esi
	je	SHORT $LN3@PKCS12_par
	mov	ebx, DWORD PTR _ca$[esp+16]
	npad	2
$LL2@PKCS12_par:
; Line 137
	test	edi, edi
	je	SHORT $LN17@PKCS12_par
	cmp	DWORD PTR [edi], 0
	je	SHORT $LN17@PKCS12_par
	test	ebp, ebp
	je	SHORT $LN17@PKCS12_par
	cmp	DWORD PTR [ebp], 0
	jne	SHORT $LN17@PKCS12_par
; Line 138
	call	_ERR_set_mark
; Line 139
	push	DWORD PTR [edi]
	push	esi
	call	_X509_check_private_key
	add	esp, 8
	test	eax, eax
	je	SHORT $LN18@PKCS12_par
; Line 140
	mov	DWORD PTR [ebp], esi
; Line 141
	xor	esi, esi
$LN18@PKCS12_par:
; Line 143
	call	_ERR_pop_to_mark
$LN17@PKCS12_par:
; Line 146
	test	ebx, ebx
	je	SHORT $LN19@PKCS12_par
	test	esi, esi
	je	SHORT $LN23@PKCS12_par
; Line 147
	cmp	DWORD PTR [ebx], 0
	jne	SHORT $LN35@PKCS12_par
; Line 148
	call	_sk_new_null
	mov	DWORD PTR [ebx], eax
; Line 149
	test	eax, eax
	je	SHORT $err$42
$LN35@PKCS12_par:
; Line 151
	push	esi
	push	DWORD PTR [ebx]
	call	_sk_push
	add	esp, 8
	test	eax, eax
	je	SHORT $err$42
; Line 155
	jmp	SHORT $LN23@PKCS12_par
$LN19@PKCS12_par:
	test	esi, esi
	je	SHORT $LN23@PKCS12_par
; Line 156
	push	esi
	call	_X509_free
	add	esp, 4
$LN23@PKCS12_par:
; Line 136
	push	DWORD PTR _ocerts$1$[esp+20]
	call	_sk_pop
	mov	esi, eax
	add	esp, 4
	test	esi, esi
	jne	SHORT $LL2@PKCS12_par
$LN3@PKCS12_par:
; Line 160
	push	OFFSET _X509_free
	push	DWORD PTR _ocerts$1$[esp+24]
	call	_sk_pop_free
	add	esp, 8
; Line 162
	mov	eax, 1
	pop	ebx
	pop	ebp
	pop	edi
	pop	esi
; Line 176
	pop	ecx
	ret	0
$LN12@PKCS12_par:
; Line 115
	push	115					; 00000073H
$LN39@PKCS12_par:
	push	OFFSET ??_C@_0BL@FPOKFNDP@?4?2crypto?2pkcs12?2p12_kiss?4c?$AA@
	push	113					; 00000071H
$LN40@PKCS12_par:
	push	118					; 00000076H
	push	35					; 00000023H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$42:
; Line 166
	test	edi, edi
	je	SHORT $LN25@PKCS12_par
	mov	eax, DWORD PTR [edi]
	test	eax, eax
	je	SHORT $LN25@PKCS12_par
; Line 167
	push	eax
	call	_EVP_PKEY_free
	add	esp, 4
$LN25@PKCS12_par:
; Line 168
	test	ebp, ebp
	je	SHORT $LN26@PKCS12_par
	mov	eax, DWORD PTR [ebp]
	test	eax, eax
	je	SHORT $LN26@PKCS12_par
; Line 169
	push	eax
	call	_X509_free
	add	esp, 4
$LN26@PKCS12_par:
; Line 170
	test	esi, esi
	je	SHORT $LN27@PKCS12_par
; Line 171
	push	esi
	call	_X509_free
	add	esp, 4
$LN27@PKCS12_par:
; Line 172
	mov	eax, DWORD PTR _ocerts$1$[esp+20]
	test	eax, eax
	je	SHORT $LN28@PKCS12_par
; Line 173
	push	OFFSET _X509_free
	push	eax
	call	_sk_pop_free
	add	esp, 8
$LN28@PKCS12_par:
; Line 174
	pop	ebx
	pop	ebp
	pop	edi
	xor	eax, eax
	pop	esi
; Line 176
	pop	ecx
	ret	0
_PKCS12_parse ENDP
_TEXT	ENDS
END
