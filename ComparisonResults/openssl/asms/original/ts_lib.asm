; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_TS_ASN1_INTEGER_print_bio
PUBLIC	_TS_OBJ_print_bio
PUBLIC	_TS_ext_print_bio
PUBLIC	_TS_X509_ALGOR_print_bio
PUBLIC	_TS_MSG_IMPRINT_print_bio
PUBLIC	??_C@_02MDDDDAID@0x?$AA@			; `string'
PUBLIC	??_C@_01EEMJAFIK@?6?$AA@			; `string'
PUBLIC	??_C@_0N@NGDDLEOE@Extensions?3?6?$AA@		; `string'
PUBLIC	??_C@_08CBBMEOFB@critical?$AA@			; `string'
PUBLIC	??_C@_00CNPNBAHC@?$AA@				; `string'
PUBLIC	??_C@_05BBKJDEBM@?3?5?$CFs?6?$AA@		; `string'
PUBLIC	??_C@_03GOCHBIJG@?$CF4s?$AA@			; `string'
PUBLIC	??_C@_07NFANNNEC@UNKNOWN?$AA@			; `string'
PUBLIC	??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@ ; `string'
PUBLIC	??_C@_0P@OPCEENID@Message?5data?3?6?$AA@	; `string'
EXTRN	_CRYPTO_free:PROC
EXTRN	_BIO_write:PROC
EXTRN	_BIO_dump_indent:PROC
EXTRN	_BIO_printf:PROC
EXTRN	_BN_init:PROC
EXTRN	_BN_free:PROC
EXTRN	_BN_bn2hex:PROC
EXTRN	_i2a_ASN1_OBJECT:PROC
EXTRN	_ASN1_INTEGER_to_BN:PROC
EXTRN	_ASN1_STRING_print:PROC
EXTRN	_OBJ_nid2ln:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_OBJ_obj2txt:PROC
EXTRN	_X509v3_get_ext_count:PROC
EXTRN	_X509v3_get_ext:PROC
EXTRN	_X509_EXTENSION_get_object:PROC
EXTRN	_X509_EXTENSION_get_critical:PROC
EXTRN	_X509V3_EXT_print:PROC
EXTRN	_TS_MSG_IMPRINT_get_algo:PROC
EXTRN	_TS_MSG_IMPRINT_get_msg:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0P@OPCEENID@Message?5data?3?6?$AA@
CONST	SEGMENT
??_C@_0P@OPCEENID@Message?5data?3?6?$AA@ DB 'Message data:', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@
CONST	SEGMENT
??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@ DB 'Hash Algorithm: %s'
	DB	0aH, 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_07NFANNNEC@UNKNOWN?$AA@
CONST	SEGMENT
??_C@_07NFANNNEC@UNKNOWN?$AA@ DB 'UNKNOWN', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_03GOCHBIJG@?$CF4s?$AA@
CONST	SEGMENT
??_C@_03GOCHBIJG@?$CF4s?$AA@ DB '%4s', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05BBKJDEBM@?3?5?$CFs?6?$AA@
CONST	SEGMENT
??_C@_05BBKJDEBM@?3?5?$CFs?6?$AA@ DB ': %s', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_00CNPNBAHC@?$AA@
CONST	SEGMENT
??_C@_00CNPNBAHC@?$AA@ DB 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_08CBBMEOFB@critical?$AA@
CONST	SEGMENT
??_C@_08CBBMEOFB@critical?$AA@ DB 'critical', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@NGDDLEOE@Extensions?3?6?$AA@
CONST	SEGMENT
??_C@_0N@NGDDLEOE@Extensions?3?6?$AA@ DB 'Extensions:', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_01EEMJAFIK@?6?$AA@
CONST	SEGMENT
??_C@_01EEMJAFIK@?6?$AA@ DB 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_02MDDDDAID@0x?$AA@
CONST	SEGMENT
??_C@_02MDDDDAID@0x?$AA@ DB '0x', 00H			; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_MSG_IMPRINT_print_bio
_TEXT	SEGMENT
_bio$ = 8						; size = 4
_a$ = 12						; size = 4
_TS_MSG_IMPRINT_print_bio PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
; Line 135
	push	DWORD PTR _a$[esp-4]
	call	_TS_MSG_IMPRINT_get_algo
; Line 126
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 8
; Line 127
	test	eax, eax
	jne	SHORT $LN5@TS_MSG_IMP
	mov	eax, OFFSET ??_C@_07NFANNNEC@UNKNOWN?$AA@
	jmp	SHORT $LN6@TS_MSG_IMP
$LN5@TS_MSG_IMP:
	push	eax
	call	_OBJ_nid2ln
	add	esp, 4
$LN6@TS_MSG_IMP:
	push	esi
	mov	esi, DWORD PTR _bio$[esp]
	push	eax
	push	OFFSET ??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@
	push	esi
	call	_BIO_printf
; Line 137
	push	OFFSET ??_C@_0P@OPCEENID@Message?5data?3?6?$AA@
	push	esi
	call	_BIO_printf
; Line 138
	push	DWORD PTR _a$[esp+20]
	call	_TS_MSG_IMPRINT_get_msg
; Line 139
	push	4
	push	DWORD PTR [eax]
	push	DWORD PTR [eax+8]
	push	esi
	call	_BIO_dump_indent
	add	esp, 40					; 00000028H
; Line 142
	mov	eax, 1
	pop	esi
; Line 143
	ret	0
_TS_MSG_IMPRINT_print_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_X509_ALGOR_print_bio
_TEXT	SEGMENT
_bio$ = 8						; size = 4
_alg$ = 12						; size = 4
_TS_X509_ALGOR_print_bio PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
; Line 126
	mov	eax, DWORD PTR _alg$[esp-4]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 127
	test	eax, eax
	jne	SHORT $LN3@TS_X509_AL
	mov	eax, OFFSET ??_C@_07NFANNNEC@UNKNOWN?$AA@
	push	eax
	push	OFFSET ??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@
	push	DWORD PTR _bio$[esp+4]
	call	_BIO_printf
	add	esp, 12					; 0000000cH
; Line 129
	ret	0
$LN3@TS_X509_AL:
; Line 127
	push	eax
	call	_OBJ_nid2ln
	add	esp, 4
	push	eax
	push	OFFSET ??_C@_0BE@CJCFBJKB@Hash?5Algorithm?3?5?$CFs?6?$AA@
	push	DWORD PTR _bio$[esp+4]
	call	_BIO_printf
	add	esp, 12					; 0000000cH
; Line 129
	ret	0
_TS_X509_ALGOR_print_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_ext_print_bio
_TEXT	SEGMENT
_bio$ = 8						; size = 4
_extensions$ = 12					; size = 4
_TS_ext_print_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
; Line 101
	push	ebx
	push	ebp
	push	esi
; Line 106
	mov	esi, DWORD PTR _bio$[esp+8]
	push	edi
	push	OFFSET ??_C@_0N@NGDDLEOE@Extensions?3?6?$AA@
	push	esi
	call	_BIO_printf
; Line 107
	mov	ebx, DWORD PTR _extensions$[esp+20]
	push	ebx
	call	_X509v3_get_ext_count
	mov	ebp, eax
	add	esp, 12					; 0000000cH
; Line 108
	xor	edi, edi
	test	ebp, ebp
	jle	SHORT $LN11@TS_ext_pri
$LL4@TS_ext_pri:
; Line 109
	push	edi
	push	ebx
	call	_X509v3_get_ext
	mov	ebx, eax
; Line 110
	push	ebx
	call	_X509_EXTENSION_get_object
; Line 111
	push	eax
	push	esi
	call	_i2a_ASN1_OBJECT
; Line 112
	push	ebx
	call	_X509_EXTENSION_get_critical
; Line 113
	test	eax, eax
	mov	ecx, OFFSET ??_C@_08CBBMEOFB@critical?$AA@
	mov	eax, OFFSET ??_C@_00CNPNBAHC@?$AA@
	cmove	ecx, eax
	push	ecx
	push	OFFSET ??_C@_05BBKJDEBM@?3?5?$CFs?6?$AA@
	push	esi
	call	_BIO_printf
; Line 114
	push	4
	push	0
	push	ebx
	push	esi
	call	_X509V3_EXT_print
	add	esp, 52					; 00000034H
	test	eax, eax
	jne	SHORT $LN5@TS_ext_pri
; Line 115
	push	OFFSET ??_C@_00CNPNBAHC@?$AA@
	push	OFFSET ??_C@_03GOCHBIJG@?$CF4s?$AA@
	push	esi
	call	_BIO_printf
; Line 116
	push	DWORD PTR [ebx+8]
	push	esi
	call	_ASN1_STRING_print
	add	esp, 20					; 00000014H
$LN5@TS_ext_pri:
; Line 118
	push	1
	push	OFFSET ??_C@_01EEMJAFIK@?6?$AA@
	push	esi
	call	_BIO_write
	mov	ebx, DWORD PTR _extensions$[esp+24]
	inc	edi
	add	esp, 12					; 0000000cH
	cmp	edi, ebp
	jl	SHORT $LL4@TS_ext_pri
$LN11@TS_ext_pri:
	pop	edi
	pop	esi
	pop	ebp
; Line 121
	mov	eax, 1
	pop	ebx
; Line 122
	ret	0
_TS_ext_print_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_OBJ_print_bio
_TEXT	SEGMENT
_obj_txt$ = -132					; size = 128
__$ArrayPad$ = -4					; size = 4
_bio$ = 8						; size = 4
_obj$ = 12						; size = 4
_TS_OBJ_print_bio PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
; Line 90
	mov	eax, 132				; 00000084H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+132], eax
	mov	eax, DWORD PTR _obj$[esp+128]
	push	esi
	mov	esi, DWORD PTR _bio$[esp+132]
; Line 93
	push	0
	push	eax
	lea	eax, DWORD PTR _obj_txt$[esp+144]
	push	128					; 00000080H
	push	eax
	call	_OBJ_obj2txt
; Line 94
	push	eax
	lea	eax, DWORD PTR _obj_txt$[esp+156]
	push	eax
	push	esi
	call	_BIO_write
; Line 95
	push	1
	push	OFFSET ??_C@_01EEMJAFIK@?6?$AA@
	push	esi
	call	_BIO_write
; Line 98
	mov	ecx, DWORD PTR __$ArrayPad$[esp+176]
	add	esp, 40					; 00000028H
	mov	eax, 1
	pop	esi
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 132				; 00000084H
	ret	0
_TS_OBJ_print_bio ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _TS_ASN1_INTEGER_print_bio
_TEXT	SEGMENT
_num_bn$ = -20						; size = 20
_bio$ = 8						; size = 4
_num$ = 12						; size = 4
_TS_ASN1_INTEGER_print_bio PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ts\ts_lib.c
; Line 72
	mov	eax, 20					; 00000014H
	call	__chkstk
	push	esi
; Line 77
	lea	eax, DWORD PTR _num_bn$[esp+24]
	xor	esi, esi
	push	edi
	push	eax
	call	_BN_init
; Line 78
	lea	eax, DWORD PTR _num_bn$[esp+32]
	push	eax
	push	DWORD PTR _num$[esp+32]
	call	_ASN1_INTEGER_to_BN
; Line 79
	lea	eax, DWORD PTR _num_bn$[esp+40]
	push	eax
	call	_BN_bn2hex
	mov	edi, eax
	add	esp, 16					; 00000010H
	test	edi, edi
	je	SHORT $LN2@TS_ASN1_IN
; Line 80
	mov	esi, DWORD PTR _bio$[esp+24]
	push	2
	push	OFFSET ??_C@_02MDDDDAID@0x?$AA@
	push	esi
	call	_BIO_write
	add	esp, 12					; 0000000cH
	test	eax, eax
; Line 81
	jle	SHORT $LN4@TS_ASN1_IN
	mov	ecx, edi
	lea	edx, DWORD PTR [ecx+1]
$LL6@TS_ASN1_IN:
	mov	al, BYTE PTR [ecx]
	inc	ecx
	test	al, al
	jne	SHORT $LL6@TS_ASN1_IN
	sub	ecx, edx
	push	ecx
	push	edi
	push	esi
	call	_BIO_write
	add	esp, 12					; 0000000cH
	test	eax, eax
	jle	SHORT $LN4@TS_ASN1_IN
	mov	esi, 1
	jmp	SHORT $LN5@TS_ASN1_IN
$LN4@TS_ASN1_IN:
	xor	esi, esi
$LN5@TS_ASN1_IN:
; Line 82
	push	edi
	call	_CRYPTO_free
	add	esp, 4
$LN2@TS_ASN1_IN:
; Line 84
	lea	eax, DWORD PTR _num_bn$[esp+28]
	push	eax
	call	_BN_free
	add	esp, 4
; Line 86
	mov	eax, esi
	pop	edi
	pop	esi
; Line 87
	add	esp, 20					; 00000014H
	ret	0
_TS_ASN1_INTEGER_print_bio ENDP
_TEXT	ENDS
END
