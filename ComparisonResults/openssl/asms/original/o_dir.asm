; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\o_dir.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_OPENSSL_DIR_read
PUBLIC	_OPENSSL_DIR_end
PUBLIC	??_C@_02FMMEOLBI@?1?$CK?$AA@			; `string'
PUBLIC	??_C@_01NBENCBCI@?$CK?$AA@			; `string'
EXTRN	__imp___errno:PROC
EXTRN	__imp__strncpy:PROC
EXTRN	__imp__FindClose@4:PROC
EXTRN	__imp__FindFirstFileA@8:PROC
EXTRN	__imp__FindNextFileA@8:PROC
EXTRN	__imp__free:PROC
EXTRN	__imp__malloc:PROC
EXTRN	_memset:PROC
;	COMDAT ??_C@_01NBENCBCI@?$CK?$AA@
CONST	SEGMENT
??_C@_01NBENCBCI@?$CK?$AA@ DB '*', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_02FMMEOLBI@?1?$CK?$AA@
CONST	SEGMENT
??_C@_02FMMEOLBI@?1?$CK?$AA@ DB '/*', 00H		; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OPENSSL_DIR_end
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_OPENSSL_DIR_end PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\lpdir_win.c
; Line 161
	push	esi
; Line 162
	mov	esi, DWORD PTR _ctx$[esp]
	test	esi, esi
	je	SHORT $LN2@OPENSSL_DI
	mov	eax, DWORD PTR [esi]
	test	eax, eax
	je	SHORT $LN2@OPENSSL_DI
; Line 163
	push	DWORD PTR [eax+320]
	call	DWORD PTR __imp__FindClose@4
; Line 164
	push	DWORD PTR [esi]
	call	DWORD PTR __imp__free
	add	esp, 4
; Line 165
	mov	DWORD PTR [esi], 0
; Line 166
	mov	eax, 1
	pop	esi
; Line 170
	ret	0
$LN2@OPENSSL_DI:
; Line 168
	call	DWORD PTR __imp___errno
	pop	esi
	mov	DWORD PTR [eax], 22			; 00000016H
; Line 169
	xor	eax, eax
; Line 170
	ret	0
_OPENSSL_DIR_end ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _OPENSSL_DIR_read
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_directory$ = 12					; size = 4
_OPENSSL_DIR_read PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\lpdir_win.c
; Line 55
	push	ebx
; Line 56
	mov	ebx, DWORD PTR _ctx$[esp]
	push	esi
	test	ebx, ebx
	je	$LN11@OPENSSL_DI
	mov	esi, DWORD PTR _directory$[esp+4]
	test	esi, esi
	je	$LN11@OPENSSL_DI
; Line 61
	push	ebp
	push	edi
	call	DWORD PTR __imp___errno
	mov	DWORD PTR [eax], 0
; Line 62
	mov	eax, DWORD PTR [ebx]
	test	eax, eax
	jne	$LN12@OPENSSL_DI
; Line 65
	mov	edi, esi
	xor	ebp, ebp
	lea	ecx, DWORD PTR [edi+1]
	npad	7
$LL40@OPENSSL_DI:
	mov	al, BYTE PTR [edi]
	inc	edi
	test	al, al
	jne	SHORT $LL40@OPENSSL_DI
	sub	edi, ecx
; Line 67
	jne	SHORT $LN14@OPENSSL_DI
; Line 68
	mov	eax, DWORD PTR __imp___errno
	call	eax
	mov	DWORD PTR [eax], 2
$LN45@OPENSSL_DI:
; Line 85
	pop	edi
	pop	ebp
	pop	esi
	xor	eax, eax
	pop	ebx
; Line 158
	ret	0
$LN14@OPENSSL_DI:
; Line 72
	push	580					; 00000244H
	call	DWORD PTR __imp__malloc
	add	esp, 4
	mov	DWORD PTR [ebx], eax
; Line 73
	test	eax, eax
	je	SHORT $LN46@OPENSSL_DI
; Line 77
	push	580					; 00000244H
	push	0
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH
; Line 79
	cmp	BYTE PTR [edi+esi-1], 42		; 0000002aH
	je	$LN19@OPENSSL_DI
; Line 80
	lea	eax, DWORD PTR [edi+3]
	push	eax
	call	DWORD PTR __imp__malloc
	mov	ebp, eax
	add	esp, 4
; Line 81
	test	ebp, ebp
	jne	SHORT $LN17@OPENSSL_DI
; Line 82
	push	DWORD PTR [ebx]
	call	DWORD PTR __imp__free
	add	esp, 4
; Line 83
	mov	DWORD PTR [ebx], ebp
$LN46@OPENSSL_DI:
; Line 84
	mov	eax, DWORD PTR __imp___errno
	call	eax
	pop	edi
	pop	ebp
	pop	esi
	mov	DWORD PTR [eax], 12			; 0000000cH
; Line 85
	xor	eax, eax
	pop	ebx
; Line 158
	ret	0
$LN17@OPENSSL_DI:
; Line 87
	mov	al, BYTE PTR [edi+esi-1]
	cmp	al, 47					; 0000002fH
	je	SHORT $LN18@OPENSSL_DI
	cmp	al, 92					; 0000005cH
	je	SHORT $LN18@OPENSSL_DI
; Line 88
	mov	ecx, ebp
	sub	ecx, esi
$LL32@OPENSSL_DI:
	mov	al, BYTE PTR [esi]
	lea	esi, DWORD PTR [esi+1]
	mov	BYTE PTR [ecx+esi-1], al
	test	al, al
	jne	SHORT $LL32@OPENSSL_DI
	lea	ecx, DWORD PTR [ebp-1]
	lea	esi, DWORD PTR [ecx+1]
$LL41@OPENSSL_DI:
	mov	al, BYTE PTR [ecx+1]
	lea	ecx, DWORD PTR [ecx+1]
	test	al, al
	jne	SHORT $LL41@OPENSSL_DI
	mov	ax, WORD PTR ??_C@_02FMMEOLBI@?1?$CK?$AA@
	mov	WORD PTR [ecx], ax
	mov	al, BYTE PTR ??_C@_02FMMEOLBI@?1?$CK?$AA@+2
	mov	BYTE PTR [ecx+2], al
	jmp	SHORT $LN19@OPENSSL_DI
$LN18@OPENSSL_DI:
; Line 90
	mov	ecx, ebp
	sub	ecx, esi
$LL33@OPENSSL_DI:
	mov	al, BYTE PTR [esi]
	lea	esi, DWORD PTR [esi+1]
	mov	BYTE PTR [ecx+esi-1], al
	test	al, al
	jne	SHORT $LL33@OPENSSL_DI
	lea	edi, DWORD PTR [ebp-1]
	lea	esi, DWORD PTR [edi+1]
	npad	7
$LL42@OPENSSL_DI:
	mov	al, BYTE PTR [edi+1]
	lea	edi, DWORD PTR [edi+1]
	test	al, al
	jne	SHORT $LL42@OPENSSL_DI
	mov	ax, WORD PTR ??_C@_01NBENCBCI@?$CK?$AA@
	mov	WORD PTR [edi], ax
$LN19@OPENSSL_DI:
; Line 119
	push	DWORD PTR [ebx]
	push	esi
	call	DWORD PTR __imp__FindFirstFileA@8
	mov	ecx, DWORD PTR [ebx]
; Line 121
	mov	esi, DWORD PTR __imp__free
	mov	DWORD PTR [ecx+320], eax
	test	ebp, ebp
	je	SHORT $LN25@OPENSSL_DI
; Line 122
	push	ebp
	call	esi
	add	esp, 4
$LN25@OPENSSL_DI:
; Line 125
	mov	eax, DWORD PTR [ebx]
	cmp	DWORD PTR [eax+320], -1
	jne	SHORT $LN27@OPENSSL_DI
; Line 126
	push	eax
	call	esi
; Line 128
	mov	eax, DWORD PTR __imp___errno
	add	esp, 4
	mov	DWORD PTR [ebx], 0
	call	eax
	pop	edi
	pop	ebp
	pop	esi
	mov	DWORD PTR [eax], 22			; 00000016H
	xor	eax, eax
	pop	ebx
; Line 158
	ret	0
$LN12@OPENSSL_DI:
; Line 132
	push	eax
	push	DWORD PTR [eax+320]
	call	DWORD PTR __imp__FindNextFileA@8
	test	eax, eax
	je	$LN45@OPENSSL_DI
$LN27@OPENSSL_DI:
; Line 152
	mov	ecx, DWORD PTR [ebx]
	push	255					; 000000ffH
	lea	eax, DWORD PTR [ecx+44]
	push	eax
	lea	eax, DWORD PTR [ecx+324]
	push	eax
	call	DWORD PTR __imp__strncpy
; Line 155
	mov	eax, DWORD PTR [ebx]
	add	esp, 12					; 0000000cH
	pop	edi
	pop	ebp
	mov	BYTE PTR [eax+579], 0
; Line 157
	mov	eax, DWORD PTR [ebx]
	pop	esi
	add	eax, 324				; 00000144H
	pop	ebx
; Line 158
	ret	0
$LN11@OPENSSL_DI:
; Line 57
	call	DWORD PTR __imp___errno
	pop	esi
	pop	ebx
	mov	DWORD PTR [eax], 22			; 00000016H
; Line 58
	xor	eax, eax
; Line 158
	ret	0
_OPENSSL_DIR_read ENDP
_TEXT	ENDS
END
