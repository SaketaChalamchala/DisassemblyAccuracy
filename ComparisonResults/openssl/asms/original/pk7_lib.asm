; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_PKCS7_ctrl
PUBLIC	_PKCS7_set_type
PUBLIC	_PKCS7_set0_type_other
PUBLIC	_PKCS7_set_content
PUBLIC	_PKCS7_SIGNER_INFO_set
PUBLIC	_PKCS7_add_signer
PUBLIC	_PKCS7_add_certificate
PUBLIC	_PKCS7_add_crl
PUBLIC	_PKCS7_content_new
PUBLIC	_PKCS7_add_signature
PUBLIC	_PKCS7_cert_from_signer_info
PUBLIC	_PKCS7_set_digest
PUBLIC	_PKCS7_get_signer_info
PUBLIC	_PKCS7_add_recipient
PUBLIC	_PKCS7_SIGNER_INFO_get0_algs
PUBLIC	_PKCS7_RECIP_INFO_get0_alg
PUBLIC	_PKCS7_add_recipient_info
PUBLIC	_PKCS7_RECIP_INFO_set
PUBLIC	_PKCS7_set_cipher
PUBLIC	_PKCS7_stream
PUBLIC	??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@ ; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_new_null:PROC
EXTRN	_sk_push:PROC
EXTRN	_CRYPTO_add_lock:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_TYPE_new:PROC
EXTRN	_ASN1_STRING_free:PROC
EXTRN	_ASN1_STRING_dup:PROC
EXTRN	_ASN1_STRING_type_new:PROC
EXTRN	_ASN1_OCTET_STRING_free:PROC
EXTRN	_ASN1_INTEGER_set:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_OBJ_nid2sn:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_EVP_MD_type:PROC
EXTRN	_EVP_get_digestbyname:PROC
EXTRN	_EVP_PKEY_free:PROC
EXTRN	_EVP_PKEY_get_default_digest_nid:PROC
EXTRN	_EVP_CIPHER_type:PROC
EXTRN	_PKCS7_SIGNER_INFO_new:PROC
EXTRN	_PKCS7_SIGNER_INFO_free:PROC
EXTRN	_PKCS7_RECIP_INFO_new:PROC
EXTRN	_PKCS7_RECIP_INFO_free:PROC
EXTRN	_PKCS7_SIGNED_new:PROC
EXTRN	_PKCS7_SIGNED_free:PROC
EXTRN	_PKCS7_ENVELOPE_new:PROC
EXTRN	_PKCS7_SIGN_ENVELOPE_new:PROC
EXTRN	_PKCS7_DIGEST_new:PROC
EXTRN	_PKCS7_ENCRYPT_new:PROC
EXTRN	_PKCS7_new:PROC
EXTRN	_PKCS7_free:PROC
EXTRN	_X509_ALGOR_set0:PROC
EXTRN	_X509_ALGOR_new:PROC
EXTRN	_X509_ALGOR_free:PROC
EXTRN	_X509_NAME_set:PROC
EXTRN	_X509_free:PROC
EXTRN	_X509_CRL_free:PROC
EXTRN	_X509_get_serialNumber:PROC
EXTRN	_X509_get_issuer_name:PROC
EXTRN	_X509_get_pubkey:PROC
EXTRN	_X509_find_by_issuer_and_serial:PROC
;	COMDAT ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
CONST	SEGMENT
??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@ DB '.\crypto\pkcs7\'
	DB	'pk7_lib.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_stream
_TEXT	SEGMENT
_boundary$ = 8						; size = 4
_p7$ = 12						; size = 4
_PKCS7_stream PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 606
	push	esi
; Line 609
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	eax, -21				; ffffffebH
	add	esp, 4
	cmp	eax, 3
	ja	SHORT $LN13@PKCS7_stre
	jmp	DWORD PTR $LN15@PKCS7_stre[eax*4]
$LN4@PKCS7_stre:
; Line 611
	mov	edx, DWORD PTR [esi+20]
; Line 612
	jmp	SHORT $LN2@PKCS7_stre
$LN5@PKCS7_stre:
; Line 615
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+20]
	mov	edx, DWORD PTR [eax+8]
; Line 616
	test	edx, edx
	jne	SHORT $LN11@PKCS7_stre
; Line 617
	push	4
	call	_ASN1_STRING_type_new
; Line 618
	mov	ecx, DWORD PTR [esi+20]
	mov	edx, eax
	add	esp, 4
	mov	ecx, DWORD PTR [ecx+20]
	mov	DWORD PTR [ecx+8], edx
; Line 620
	jmp	SHORT $LN2@PKCS7_stre
$LN7@PKCS7_stre:
; Line 623
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+8]
	mov	edx, DWORD PTR [eax+8]
; Line 624
	test	edx, edx
	jne	SHORT $LN11@PKCS7_stre
; Line 625
	push	4
	call	_ASN1_STRING_type_new
	mov	edx, eax
	add	esp, 4
; Line 626
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+8]
	mov	DWORD PTR [eax+8], edx
; Line 628
	jmp	SHORT $LN2@PKCS7_stre
$LN9@PKCS7_stre:
; Line 631
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+20]
	mov	edx, DWORD PTR [eax+20]
$LN2@PKCS7_stre:
; Line 639
	test	edx, edx
	je	SHORT $LN13@PKCS7_stre
$LN11@PKCS7_stre:
; Line 643
	mov	eax, DWORD PTR _boundary$[esp]
	lea	ecx, DWORD PTR [edx+8]
	or	DWORD PTR [edx+12], 16			; 00000010H
	pop	esi
	mov	DWORD PTR [eax], ecx
; Line 645
	mov	eax, 1
; Line 646
	ret	0
$LN13@PKCS7_stre:
; Line 640
	xor	eax, eax
	pop	esi
; Line 646
	ret	0
	npad	3
$LN15@PKCS7_stre:
	DD	$LN4@PKCS7_stre
	DD	$LN9@PKCS7_stre
	DD	$LN7@PKCS7_stre
	DD	$LN5@PKCS7_stre
_PKCS7_stream ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_set_cipher
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_cipher$ = 12						; size = 4
_PKCS7_set_cipher PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 576
	push	esi
; Line 580
	mov	esi, DWORD PTR _p7$[esp]
	push	edi
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 581
	sub	eax, 23					; 00000017H
	je	SHORT $LN5@PKCS7_set_
	sub	eax, 1
	je	SHORT $LN4@PKCS7_set_
; Line 589
	push	589					; 0000024dH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	108					; 0000006cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 590
	xor	eax, eax
	pop	edi
	pop	esi
; Line 603
	ret	0
$LN4@PKCS7_set_:
; Line 583
	mov	eax, DWORD PTR [esi+20]
	mov	edi, DWORD PTR [eax+20]
; Line 584
	jmp	SHORT $LN2@PKCS7_set_
$LN5@PKCS7_set_:
; Line 586
	mov	eax, DWORD PTR [esi+20]
	mov	edi, DWORD PTR [eax+8]
$LN2@PKCS7_set_:
; Line 594
	mov	esi, DWORD PTR _cipher$[esp+4]
	push	esi
	call	_EVP_CIPHER_type
	add	esp, 4
; Line 595
	test	eax, eax
	jne	SHORT $LN7@PKCS7_set_
; Line 596
	push	597					; 00000255H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	144					; 00000090H
	push	108					; 0000006cH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 598
	xor	eax, eax
	pop	edi
	pop	esi
; Line 603
	ret	0
$LN7@PKCS7_set_:
; Line 601
	mov	DWORD PTR [edi+12], esi
; Line 602
	mov	eax, 1
	pop	edi
	pop	esi
; Line 603
	ret	0
_PKCS7_set_cipher ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_RECIP_INFO_set
_TEXT	SEGMENT
_p7i$ = 8						; size = 4
_x509$ = 12						; size = 4
_PKCS7_RECIP_INFO_set PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 517
	push	edi
; Line 520
	mov	edi, DWORD PTR _p7i$[esp]
	push	0
	push	DWORD PTR [edi]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN2@PKCS7_RECI
	pop	edi
; Line 562
	ret	0
$LN2@PKCS7_RECI:
	push	ebx
; Line 522
	mov	ebx, DWORD PTR _x509$[esp+4]
	push	ebx
	call	_X509_get_issuer_name
	push	eax
	push	DWORD PTR [edi+4]
	call	_X509_NAME_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN15@PKCS7_RECI
; Line 526
	mov	eax, DWORD PTR [edi+4]
	push	DWORD PTR [eax+4]
	call	_ASN1_STRING_free
; Line 527
	push	ebx
	call	_X509_get_serialNumber
	push	eax
	call	_ASN1_STRING_dup
	mov	ecx, DWORD PTR [edi+4]
	add	esp, 12					; 0000000cH
	mov	DWORD PTR [ecx+4], eax
	test	eax, eax
	jne	SHORT $LN4@PKCS7_RECI
$LN15@PKCS7_RECI:
	pop	ebx
; Line 529
	xor	eax, eax
	pop	edi
; Line 562
	ret	0
$LN4@PKCS7_RECI:
	push	esi
; Line 531
	push	ebx
	call	_X509_get_pubkey
	mov	esi, eax
	add	esp, 4
; Line 533
	test	esi, esi
	je	SHORT $LN6@PKCS7_RECI
	mov	eax, DWORD PTR [esi+12]
	test	eax, eax
	je	SHORT $LN6@PKCS7_RECI
	mov	eax, DWORD PTR [eax+88]
	test	eax, eax
	je	SHORT $LN6@PKCS7_RECI
; Line 539
	push	edi
	push	0
	push	2
	push	esi
	call	eax
	add	esp, 16					; 00000010H
; Line 540
	cmp	eax, -2					; fffffffeH
	jne	SHORT $LN7@PKCS7_RECI
; Line 541
	push	542					; 0000021eH
; Line 543
	jmp	SHORT $LN13@PKCS7_RECI
$LN7@PKCS7_RECI:
; Line 545
	test	eax, eax
	jg	SHORT $LN8@PKCS7_RECI
; Line 546
	push	547					; 00000223H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	149					; 00000095H
; Line 548
	jmp	SHORT $LN14@PKCS7_RECI
$LN8@PKCS7_RECI:
; Line 551
	push	esi
	call	_EVP_PKEY_free
; Line 553
	push	553					; 00000229H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	3
	lea	eax, DWORD PTR [ebx+16]
	push	1
	push	eax
	call	_CRYPTO_add_lock
	add	esp, 24					; 00000018H
; Line 554
	mov	DWORD PTR [edi+16], ebx
; Line 556
	mov	eax, 1
	pop	esi
	pop	ebx
	pop	edi
; Line 562
	ret	0
$LN6@PKCS7_RECI:
; Line 534
	push	535					; 00000217H
$LN13@PKCS7_RECI:
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	150					; 00000096H
$LN14@PKCS7_RECI:
	push	130					; 00000082H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$17:
; Line 559
	test	esi, esi
	je	SHORT $LN9@PKCS7_RECI
; Line 560
	push	esi
	call	_EVP_PKEY_free
	add	esp, 4
$LN9@PKCS7_RECI:
; Line 561
	pop	esi
	pop	ebx
	xor	eax, eax
	pop	edi
; Line 562
	ret	0
_PKCS7_RECIP_INFO_set ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_recipient_info
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_ri$ = 12						; size = 4
_PKCS7_add_recipient_info PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 493
	push	esi
; Line 497
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 498
	sub	eax, 23					; 00000017H
	je	SHORT $LN5@PKCS7_add_
	sub	eax, 1
	je	SHORT $LN4@PKCS7_add_
; Line 506
	push	507					; 000001fbH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	102					; 00000066H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 508
	xor	eax, eax
	pop	esi
; Line 514
	ret	0
$LN4@PKCS7_add_:
; Line 500
	mov	eax, DWORD PTR [esi+20]
; Line 511
	push	DWORD PTR _ri$[esp]
	mov	eax, DWORD PTR [eax+24]
	push	eax
	call	_sk_push
	add	esp, 8
	neg	eax
	sbb	eax, eax
	neg	eax
	pop	esi
; Line 514
	ret	0
$LN5@PKCS7_add_:
; Line 503
	mov	eax, DWORD PTR [esi+20]
; Line 511
	push	DWORD PTR _ri$[esp]
	mov	eax, DWORD PTR [eax+4]
	push	eax
	call	_sk_push
	add	esp, 8
	neg	eax
	sbb	eax, eax
	neg	eax
	pop	esi
; Line 514
	ret	0
_PKCS7_add_recipient_info ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_RECIP_INFO_get0_alg
_TEXT	SEGMENT
_ri$ = 8						; size = 4
_penc$ = 12						; size = 4
_PKCS7_RECIP_INFO_get0_alg PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 471
	mov	ecx, DWORD PTR _penc$[esp-4]
	test	ecx, ecx
	je	SHORT $LN2@PKCS7_RECI
; Line 472
	mov	eax, DWORD PTR _ri$[esp-4]
	mov	eax, DWORD PTR [eax+8]
	mov	DWORD PTR [ecx], eax
$LN2@PKCS7_RECI:
; Line 473
	ret	0
_PKCS7_RECIP_INFO_get0_alg ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_SIGNER_INFO_get0_algs
_TEXT	SEGMENT
_si$ = 8						; size = 4
_pk$ = 12						; size = 4
_pdig$ = 16						; size = 4
_psig$ = 20						; size = 4
_PKCS7_SIGNER_INFO_get0_algs PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 461
	mov	edx, DWORD PTR _pk$[esp-4]
	mov	ecx, DWORD PTR _si$[esp-4]
	test	edx, edx
	je	SHORT $LN2@PKCS7_SIGN
; Line 462
	mov	eax, DWORD PTR [ecx+28]
	mov	DWORD PTR [edx], eax
$LN2@PKCS7_SIGN:
; Line 463
	mov	edx, DWORD PTR _pdig$[esp-4]
	test	edx, edx
	je	SHORT $LN3@PKCS7_SIGN
; Line 464
	mov	eax, DWORD PTR [ecx+8]
	mov	DWORD PTR [edx], eax
$LN3@PKCS7_SIGN:
; Line 465
	mov	edx, DWORD PTR _psig$[esp-4]
	test	edx, edx
	je	SHORT $LN4@PKCS7_SIGN
; Line 466
	mov	eax, DWORD PTR [ecx+16]
	mov	DWORD PTR [edx], eax
$LN4@PKCS7_SIGN:
; Line 467
	ret	0
_PKCS7_SIGNER_INFO_get0_algs ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_recipient
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_x509$ = 12						; size = 4
_PKCS7_add_recipient PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 476
	push	esi
; Line 479
	call	_PKCS7_RECIP_INFO_new
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN5@PKCS7_add_
; Line 481
	push	DWORD PTR _x509$[esp]
	push	esi
	call	_PKCS7_RECIP_INFO_set
	add	esp, 8
	test	eax, eax
	je	SHORT $err$8
; Line 483
	push	esi
	push	DWORD PTR _p7$[esp+4]
	call	_PKCS7_add_recipient_info
	add	esp, 8
	test	eax, eax
	je	SHORT $err$8
; Line 485
	mov	eax, esi
	pop	esi
; Line 490
	ret	0
$err$8:
; Line 488
	push	esi
	call	_PKCS7_RECIP_INFO_free
	add	esp, 4
$LN5@PKCS7_add_:
; Line 489
	xor	eax, eax
	pop	esi
; Line 490
	ret	0
_PKCS7_add_recipient ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_get_signer_info
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_PKCS7_get_signer_info PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 447
	push	esi
; Line 448
	mov	esi, DWORD PTR _p7$[esp]
	test	esi, esi
	je	SHORT $LN3@PKCS7_get_
	cmp	DWORD PTR [esi+20], 0
	je	SHORT $LN3@PKCS7_get_
; Line 450
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 22					; 00000016H
	jne	SHORT $LN4@PKCS7_get_
$LN9@PKCS7_get_:
; Line 451
	mov	eax, DWORD PTR [esi+20]
	pop	esi
	mov	eax, DWORD PTR [eax+16]
; Line 456
	ret	0
$LN4@PKCS7_get_:
; Line 452
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 24					; 00000018H
	je	SHORT $LN9@PKCS7_get_
$LN3@PKCS7_get_:
; Line 449
	xor	eax, eax
	pop	esi
; Line 456
	ret	0
_PKCS7_get_signer_info ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_set_digest
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_md$ = 12						; size = 4
_PKCS7_set_digest PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 431
	push	esi
; Line 432
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 25					; 00000019H
	jne	SHORT $LN2@PKCS7_set_
; Line 433
	call	_ASN1_TYPE_new
	mov	ecx, DWORD PTR [esi+20]
	mov	ecx, DWORD PTR [ecx+4]
	mov	DWORD PTR [ecx+4], eax
	test	eax, eax
	jne	SHORT $LN3@PKCS7_set_
; Line 434
	push	434					; 000001b2H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	65					; 00000041H
	push	126					; 0000007eH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 435
	xor	eax, eax
	pop	esi
; Line 444
	ret	0
$LN3@PKCS7_set_:
; Line 437
	mov	eax, DWORD PTR [esi+20]
; Line 438
	push	DWORD PTR _md$[esp]
	mov	eax, DWORD PTR [eax+4]
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR [eax], 5
	call	_EVP_MD_type
	push	eax
	call	_OBJ_nid2obj
	mov	ecx, DWORD PTR [esi+20]
	add	esp, 8
	mov	ecx, DWORD PTR [ecx+4]
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 443
	mov	eax, 1
; Line 444
	ret	0
$LN2@PKCS7_set_:
; Line 442
	push	442					; 000001baH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	126					; 0000007eH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 443
	mov	eax, 1
	pop	esi
; Line 444
	ret	0
_PKCS7_set_digest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_cert_from_signer_info
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_si$ = 12						; size = 4
_PKCS7_cert_from_signer_info PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 565
	push	esi
; Line 566
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 22					; 00000016H
	jne	SHORT $LN2@PKCS7_cert
; Line 567
	mov	eax, DWORD PTR _si$[esp]
	mov	eax, DWORD PTR [eax+4]
	push	DWORD PTR [eax+4]
	push	DWORD PTR [eax]
	mov	eax, DWORD PTR [esi+20]
	push	DWORD PTR [eax+8]
	call	_X509_find_by_issuer_and_serial
	add	esp, 12					; 0000000cH
	pop	esi
; Line 573
	ret	0
$LN2@PKCS7_cert:
; Line 572
	xor	eax, eax
	pop	esi
; Line 573
	ret	0
_PKCS7_cert_from_signer_info ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_signature
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_x509$ = 12						; size = 4
_pkey$ = 16						; size = 4
_def_nid$1 = 20						; size = 4
_dgst$ = 20						; size = 4
_PKCS7_add_signature PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 403
	push	esi
	push	edi
; Line 406
	mov	edi, DWORD PTR _dgst$[esp+4]
	test	edi, edi
	jne	SHORT $LN4@PKCS7_add_
; Line 408
	lea	eax, DWORD PTR _def_nid$1[esp+4]
	push	eax
	push	DWORD PTR _pkey$[esp+8]
	call	_EVP_PKEY_get_default_digest_nid
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN8@PKCS7_add_
; Line 410
	push	DWORD PTR _def_nid$1[esp+4]
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	mov	edi, eax
	add	esp, 8
; Line 411
	test	edi, edi
	jne	SHORT $LN4@PKCS7_add_
; Line 412
	push	412					; 0000019cH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	151					; 00000097H
	push	131					; 00000083H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 427
	xor	eax, eax
	pop	edi
	pop	esi
; Line 428
	ret	0
$LN4@PKCS7_add_:
; Line 417
	call	_PKCS7_SIGNER_INFO_new
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN8@PKCS7_add_
; Line 419
	push	edi
	push	DWORD PTR _pkey$[esp+8]
	push	DWORD PTR _x509$[esp+12]
	push	esi
	call	_PKCS7_SIGNER_INFO_set
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$11
; Line 421
	push	esi
	push	DWORD PTR _p7$[esp+8]
	call	_PKCS7_add_signer
	add	esp, 8
	test	eax, eax
	je	SHORT $err$11
; Line 423
	pop	edi
	mov	eax, esi
	pop	esi
; Line 428
	ret	0
$err$11:
; Line 426
	push	esi
	call	_PKCS7_SIGNER_INFO_free
	add	esp, 4
$LN8@PKCS7_add_:
; Line 427
	pop	edi
	xor	eax, eax
	pop	esi
; Line 428
	ret	0
_PKCS7_add_signature ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_content_new
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_type$ = 12						; size = 4
_PKCS7_content_new PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 112
	push	esi
; Line 115
	call	_PKCS7_new
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN5@PKCS7_cont
; Line 117
	push	DWORD PTR _type$[esp]
	push	esi
	call	_PKCS7_set_type
	add	esp, 8
	test	eax, eax
	je	SHORT $err$8
; Line 119
	push	esi
	push	DWORD PTR _p7$[esp+4]
	call	_PKCS7_set_content
	add	esp, 8
	test	eax, eax
	je	SHORT $err$8
; Line 122
	mov	eax, 1
	pop	esi
; Line 127
	ret	0
$err$8:
; Line 125
	push	esi
	call	_PKCS7_free
	add	esp, 4
$LN5@PKCS7_cont:
; Line 126
	xor	eax, eax
	pop	esi
; Line 127
	ret	0
_PKCS7_content_new ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_crl
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_crl$ = 12						; size = 4
_PKCS7_add_crl PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 323
	push	esi
; Line 327
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 328
	sub	eax, 22					; 00000016H
	je	SHORT $LN4@PKCS7_add_
	sub	eax, 2
	je	SHORT $LN4@PKCS7_add_
; Line 336
	push	336					; 00000150H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	101					; 00000065H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 337
	xor	eax, eax
	pop	esi
; Line 353
	ret	0
$LN4@PKCS7_add_:
; Line 330
	mov	esi, DWORD PTR [esi+20]
	add	esi, 12					; 0000000cH
; Line 340
	cmp	DWORD PTR [esi], 0
	jne	SHORT $LN8@PKCS7_add_
; Line 341
	call	_sk_new_null
	mov	DWORD PTR [esi], eax
; Line 342
	test	eax, eax
	jne	SHORT $LN8@PKCS7_add_
; Line 343
	push	343					; 00000157H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	65					; 00000041H
	push	101					; 00000065H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 344
	xor	eax, eax
	pop	esi
; Line 353
	ret	0
$LN8@PKCS7_add_:
	push	edi
; Line 347
	mov	edi, DWORD PTR _crl$[esp+4]
	push	347					; 0000015bH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	6
	lea	eax, DWORD PTR [edi+12]
	push	1
	push	eax
	call	_CRYPTO_add_lock
; Line 348
	push	edi
	push	DWORD PTR [esi]
	call	_sk_push
	add	esp, 28					; 0000001cH
	test	eax, eax
	jne	SHORT $LN9@PKCS7_add_
; Line 349
	push	edi
	call	_X509_CRL_free
	add	esp, 4
; Line 350
	xor	eax, eax
	pop	edi
	pop	esi
; Line 353
	ret	0
$LN9@PKCS7_add_:
	pop	edi
; Line 352
	mov	eax, 1
	pop	esi
; Line 353
	ret	0
_PKCS7_add_crl ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_certificate
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_x509$ = 12						; size = 4
_PKCS7_add_certificate PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 291
	push	esi
; Line 295
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 296
	sub	eax, 22					; 00000016H
	je	SHORT $LN4@PKCS7_add_
	sub	eax, 2
	je	SHORT $LN4@PKCS7_add_
; Line 304
	push	304					; 00000130H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	100					; 00000064H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 305
	xor	eax, eax
	pop	esi
; Line 320
	ret	0
$LN4@PKCS7_add_:
; Line 298
	mov	esi, DWORD PTR [esi+20]
	add	esi, 8
; Line 308
	cmp	DWORD PTR [esi], 0
	jne	SHORT $LN8@PKCS7_add_
; Line 309
	call	_sk_new_null
	mov	DWORD PTR [esi], eax
; Line 310
	test	eax, eax
	jne	SHORT $LN8@PKCS7_add_
; Line 311
	push	311					; 00000137H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	65					; 00000041H
	push	100					; 00000064H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 312
	xor	eax, eax
	pop	esi
; Line 320
	ret	0
$LN8@PKCS7_add_:
	push	edi
; Line 314
	mov	edi, DWORD PTR _x509$[esp+4]
	push	314					; 0000013aH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	3
	lea	eax, DWORD PTR [edi+16]
	push	1
	push	eax
	call	_CRYPTO_add_lock
; Line 315
	push	edi
	push	DWORD PTR [esi]
	call	_sk_push
	add	esp, 28					; 0000001cH
	test	eax, eax
	jne	SHORT $LN9@PKCS7_add_
; Line 316
	push	edi
	call	_X509_free
	add	esp, 4
; Line 317
	xor	eax, eax
	pop	edi
	pop	esi
; Line 320
	ret	0
$LN9@PKCS7_add_:
	pop	edi
; Line 319
	mov	eax, 1
	pop	esi
; Line 320
	ret	0
_PKCS7_add_certificate ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_add_signer
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_psi$ = 12						; size = 4
_PKCS7_add_signer PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 238
	push	ebp
	push	esi
; Line 244
	mov	esi, DWORD PTR _p7$[esp+4]
	push	edi
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 245
	sub	eax, 22					; 00000016H
	je	SHORT $LN7@PKCS7_add_
	sub	eax, 2
	je	SHORT $LN7@PKCS7_add_
; Line 255
	push	255					; 000000ffH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	113					; 00000071H
	push	103					; 00000067H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 256
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
; Line 288
	ret	0
$LN7@PKCS7_add_:
; Line 247
	mov	eax, DWORD PTR [esi+20]
	push	ebx
; Line 248
	mov	edi, DWORD PTR [eax+4]
	mov	ebp, DWORD PTR [eax+16]
; Line 259
	mov	eax, DWORD PTR _psi$[esp+12]
	mov	eax, DWORD PTR [eax+8]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
; Line 263
	push	edi
	mov	ebx, eax
	xor	esi, esi
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN22@PKCS7_add_
$LL6@PKCS7_add_:
; Line 264
	push	esi
	push	edi
	call	_sk_value
; Line 265
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	add	esp, 12					; 0000000cH
	cmp	eax, ebx
	je	SHORT $LN14@PKCS7_add_
; Line 263
	push	edi
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL6@PKCS7_add_
$LN22@PKCS7_add_:
; Line 272
	call	_X509_ALGOR_new
	mov	esi, eax
	test	esi, esi
	je	SHORT $LN13@PKCS7_add_
	call	_ASN1_TYPE_new
	mov	DWORD PTR [esi+4], eax
	test	eax, eax
	je	SHORT $LN13@PKCS7_add_
; Line 277
	push	ebx
	call	_OBJ_nid2obj
	mov	DWORD PTR [esi], eax
; Line 278
	mov	eax, DWORD PTR [esi+4]
; Line 279
	push	esi
	push	edi
	mov	DWORD PTR [eax], 5
	call	_sk_push
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN14@PKCS7_add_
; Line 280
	push	esi
	call	_X509_ALGOR_free
	add	esp, 4
	xor	eax, eax
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp
; Line 288
	ret	0
$LN14@PKCS7_add_:
; Line 285
	push	DWORD PTR _psi$[esp+12]
	push	ebp
	call	_sk_push
	add	esp, 8
	neg	eax
	sbb	eax, eax
	neg	eax
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp
; Line 288
	ret	0
$LN13@PKCS7_add_:
; Line 273
	push	esi
	call	_X509_ALGOR_free
; Line 274
	push	274					; 00000112H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	65					; 00000041H
	push	103					; 00000067H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 24					; 00000018H
; Line 275
	xor	eax, eax
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp
; Line 288
	ret	0
_PKCS7_add_signer ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_SIGNER_INFO_set
_TEXT	SEGMENT
_p7i$ = 8						; size = 4
_x509$ = 12						; size = 4
_pkey$ = 16						; size = 4
_dgst$ = 20						; size = 4
_PKCS7_SIGNER_INFO_set PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 357
	push	esi
; Line 361
	mov	esi, DWORD PTR _p7i$[esp]
	push	edi
	push	1
	push	DWORD PTR [esi]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	je	$err$11
; Line 363
	mov	edi, DWORD PTR _x509$[esp+4]
	push	edi
	call	_X509_get_issuer_name
	push	eax
	push	DWORD PTR [esi+4]
	call	_X509_NAME_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$11
; Line 371
	mov	eax, DWORD PTR [esi+4]
	push	DWORD PTR [eax+4]
	call	_ASN1_STRING_free
; Line 372
	push	edi
	call	_X509_get_serialNumber
	push	eax
	call	_ASN1_STRING_dup
	mov	ecx, DWORD PTR [esi+4]
	add	esp, 12					; 0000000cH
	mov	DWORD PTR [ecx+4], eax
	test	eax, eax
	je	$err$11
; Line 377
	mov	edi, DWORD PTR _pkey$[esp+4]
	push	377					; 00000179H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	10					; 0000000aH
	lea	eax, DWORD PTR [edi+8]
	push	1
	push	eax
	call	_CRYPTO_add_lock
	add	esp, 20					; 00000014H
; Line 378
	mov	DWORD PTR [esi+28], edi
; Line 382
	push	0
	push	5
	push	DWORD PTR _dgst$[esp+12]
	call	_EVP_MD_type
	push	eax
	call	_OBJ_nid2obj
	add	esp, 8
	push	eax
	push	DWORD PTR [esi+8]
	call	_X509_ALGOR_set0
; Line 385
	mov	eax, DWORD PTR [edi+12]
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN7@PKCS7_SIGN
	mov	eax, DWORD PTR [eax+88]
	test	eax, eax
	je	SHORT $LN7@PKCS7_SIGN
; Line 386
	push	esi
	push	0
	push	1
	push	edi
	call	eax
	add	esp, 16					; 00000010H
; Line 387
	test	eax, eax
	jle	SHORT $LN6@PKCS7_SIGN
; Line 388
	pop	edi
	mov	eax, 1
	pop	esi
; Line 399
	ret	0
$LN6@PKCS7_SIGN:
; Line 389
	cmp	eax, -2					; fffffffeH
	je	SHORT $LN7@PKCS7_SIGN
; Line 390
	push	391					; 00000187H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	147					; 00000093H
; Line 395
	push	129					; 00000081H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 398
	xor	eax, eax
	pop	edi
	pop	esi
; Line 399
	ret	0
$LN7@PKCS7_SIGN:
; Line 395
	push	396					; 0000018cH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	148					; 00000094H
	push	129					; 00000081H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$11:
; Line 398
	pop	edi
	xor	eax, eax
	pop	esi
; Line 399
	ret	0
_PKCS7_SIGNER_INFO_set ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_set_content
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_p7_data$ = 12						; size = 4
_PKCS7_set_content PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 130
	push	esi
; Line 133
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
	add	esp, 4
; Line 134
	cmp	eax, 22					; 00000016H
	je	SHORT $LN4@PKCS7_set_
	cmp	eax, 25					; 00000019H
	je	SHORT $LN6@PKCS7_set_
; Line 150
	push	150					; 00000096H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	112					; 00000070H
	push	109					; 0000006dH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$11:
; Line 155
	xor	eax, eax
	pop	esi
; Line 156
	ret	0
$LN6@PKCS7_set_:
; Line 141
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+8]
	test	eax, eax
	je	SHORT $LN7@PKCS7_set_
; Line 142
	push	eax
	call	_PKCS7_free
	add	esp, 4
$LN7@PKCS7_set_:
; Line 143
	mov	ecx, DWORD PTR [esi+20]
	mov	eax, DWORD PTR _p7_data$[esp]
	pop	esi
	mov	DWORD PTR [ecx+8], eax
; Line 153
	mov	eax, 1
; Line 156
	ret	0
$LN4@PKCS7_set_:
; Line 136
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+20]
	test	eax, eax
	je	SHORT $LN5@PKCS7_set_
; Line 137
	push	eax
	call	_PKCS7_free
	add	esp, 4
$LN5@PKCS7_set_:
; Line 138
	mov	ecx, DWORD PTR [esi+20]
	mov	eax, DWORD PTR _p7_data$[esp]
	pop	esi
	mov	DWORD PTR [ecx+20], eax
; Line 153
	mov	eax, 1
; Line 156
	ret	0
_PKCS7_set_content ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_set0_type_other
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_type$ = 12						; size = 4
_other$ = 16						; size = 4
_PKCS7_set0_type_other PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 232
	push	DWORD PTR _type$[esp-4]
	call	_OBJ_nid2obj
	mov	ecx, DWORD PTR _p7$[esp]
	add	esp, 4
	mov	DWORD PTR [ecx+16], eax
; Line 233
	mov	eax, DWORD PTR _other$[esp-4]
	mov	DWORD PTR [ecx+20], eax
; Line 234
	mov	eax, 1
; Line 235
	ret	0
_PKCS7_set0_type_other ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_set_type
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_type$ = 12						; size = 4
_PKCS7_set_type PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 159
	push	esi
; Line 165
	mov	esi, DWORD PTR _type$[esp]
	push	esi
	call	_OBJ_nid2obj
; Line 167
	add	esi, -21				; ffffffebH
	add	esp, 4
	cmp	esi, 5
	ja	$LN21@PKCS7_set_
	jmp	DWORD PTR $LN26@PKCS7_set_[esi*4]
$LN4@PKCS7_set_:
; Line 169
	mov	esi, DWORD PTR _p7$[esp]
	mov	DWORD PTR [esi+16], eax
; Line 170
	call	_PKCS7_SIGNED_new
	mov	DWORD PTR [esi+20], eax
	test	eax, eax
	je	$err$27
; Line 172
	push	1
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	jne	$LN20@PKCS7_set_
; Line 173
	push	DWORD PTR [esi+20]
	call	_PKCS7_SIGNED_free
	add	esp, 4
; Line 174
	mov	DWORD PTR [esi+20], 0
; Line 227
	xor	eax, eax
	pop	esi
; Line 228
	ret	0
$LN7@PKCS7_set_:
; Line 179
	mov	esi, DWORD PTR _p7$[esp]
; Line 180
	push	4
	mov	DWORD PTR [esi+16], eax
	call	_ASN1_STRING_type_new
	add	esp, 4
	mov	DWORD PTR [esi+20], eax
; Line 182
	jmp	$LN24@PKCS7_set_
$LN9@PKCS7_set_:
; Line 184
	mov	esi, DWORD PTR _p7$[esp]
	mov	DWORD PTR [esi+16], eax
; Line 186
	call	_PKCS7_SIGN_ENVELOPE_new
	mov	DWORD PTR [esi+20], eax
	test	eax, eax
	je	$err$27
; Line 188
	push	1
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
; Line 189
	mov	eax, DWORD PTR [esi+20]
	push	1
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$err$27
; Line 192
	push	21					; 00000015H
	call	_OBJ_nid2obj
	mov	ecx, DWORD PTR [esi+20]
	add	esp, 4
	mov	ecx, DWORD PTR [ecx+20]
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 225
	mov	eax, 1
; Line 228
	ret	0
$LN12@PKCS7_set_:
; Line 195
	mov	esi, DWORD PTR _p7$[esp]
	mov	DWORD PTR [esi+16], eax
; Line 197
	call	_PKCS7_ENVELOPE_new
	mov	DWORD PTR [esi+20], eax
	test	eax, eax
	je	$err$27
; Line 199
	push	0
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	je	$err$27
; Line 201
	push	21					; 00000015H
	call	_OBJ_nid2obj
	mov	ecx, DWORD PTR [esi+20]
	add	esp, 4
	mov	ecx, DWORD PTR [ecx+8]
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 225
	mov	eax, 1
; Line 228
	ret	0
$LN15@PKCS7_set_:
; Line 204
	mov	esi, DWORD PTR _p7$[esp]
	mov	DWORD PTR [esi+16], eax
; Line 206
	call	_PKCS7_ENCRYPT_new
	mov	DWORD PTR [esi+20], eax
	test	eax, eax
	je	SHORT $err$27
; Line 208
	push	0
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 8
	test	eax, eax
	je	SHORT $err$27
; Line 210
	push	21					; 00000015H
	call	_OBJ_nid2obj
	mov	ecx, DWORD PTR [esi+20]
	add	esp, 4
	mov	ecx, DWORD PTR [ecx+4]
	pop	esi
	mov	DWORD PTR [ecx], eax
; Line 225
	mov	eax, 1
; Line 228
	ret	0
$LN18@PKCS7_set_:
; Line 214
	mov	esi, DWORD PTR _p7$[esp]
	mov	DWORD PTR [esi+16], eax
; Line 216
	call	_PKCS7_DIGEST_new
	mov	DWORD PTR [esi+20], eax
	test	eax, eax
	je	SHORT $err$27
; Line 218
	push	0
	push	DWORD PTR [eax]
	call	_ASN1_INTEGER_set
	add	esp, 8
$LN24@PKCS7_set_:
	test	eax, eax
	je	SHORT $err$27
$LN20@PKCS7_set_:
; Line 225
	mov	eax, 1
	pop	esi
; Line 228
	ret	0
$LN21@PKCS7_set_:
; Line 222
	push	222					; 000000deH
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	112					; 00000070H
	push	110					; 0000006eH
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$27:
; Line 227
	xor	eax, eax
	pop	esi
; Line 228
	ret	0
	npad	3
$LN26@PKCS7_set_:
	DD	$LN7@PKCS7_set_
	DD	$LN4@PKCS7_set_
	DD	$LN12@PKCS7_set_
	DD	$LN9@PKCS7_set_
	DD	$LN18@PKCS7_set_
	DD	$LN15@PKCS7_set_
_PKCS7_set_type ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _PKCS7_ctrl
_TEXT	SEGMENT
_p7$ = 8						; size = 4
_cmd$ = 12						; size = 4
_larg$ = 16						; size = 4
_parg$ = 20						; size = 4
_PKCS7_ctrl PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\pkcs7\pk7_lib.c
; Line 66
	push	esi
; Line 70
	mov	esi, DWORD PTR _p7$[esp]
	push	DWORD PTR [esi+16]
	call	_OBJ_obj2nid
; Line 72
	mov	ecx, DWORD PTR _cmd$[esp+4]
	add	esp, 4
	sub	ecx, 1
	je	SHORT $LN4@PKCS7_ctrl
	sub	ecx, 1
	je	SHORT $LN8@PKCS7_ctrl
; Line 105
	push	105					; 00000069H
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	110					; 0000006eH
	push	104					; 00000068H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 108
	xor	eax, eax
	pop	esi
; Line 109
	ret	0
$LN8@PKCS7_ctrl:
; Line 90
	cmp	eax, 22					; 00000016H
	jne	SHORT $LN9@PKCS7_ctrl
; Line 91
	mov	eax, DWORD PTR [esi+20]
	test	eax, eax
	je	SHORT $LN13@PKCS7_ctrl
	mov	eax, DWORD PTR [eax+20]
	cmp	DWORD PTR [eax+20], 0
	je	SHORT $LN13@PKCS7_ctrl
; Line 94
	xor	eax, eax
; Line 96
	mov	DWORD PTR [esi+12], eax
	pop	esi
; Line 109
	ret	0
$LN13@PKCS7_ctrl:
; Line 92
	mov	eax, 1
; Line 96
	mov	DWORD PTR [esi+12], eax
	pop	esi
; Line 109
	ret	0
$LN9@PKCS7_ctrl:
; Line 98
	push	99					; 00000063H
$LN19@PKCS7_ctrl:
	push	OFFSET ??_C@_0BJ@GHBNBDLB@?4?2crypto?2pkcs7?2pk7_lib?4c?$AA@
	push	104					; 00000068H
	push	104					; 00000068H
	push	33					; 00000021H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 108
	xor	eax, eax
	pop	esi
; Line 109
	ret	0
$LN4@PKCS7_ctrl:
; Line 75
	cmp	eax, 22					; 00000016H
	jne	SHORT $LN5@PKCS7_ctrl
; Line 76
	push	edi
	mov	edi, DWORD PTR _larg$[esp+4]
	mov	DWORD PTR [esi+12], edi
; Line 77
	test	edi, edi
	je	SHORT $LN16@PKCS7_ctrl
	mov	eax, DWORD PTR [esi+20]
	mov	eax, DWORD PTR [eax+20]
	push	DWORD PTR [eax+16]
	call	_OBJ_obj2nid
	add	esp, 4
	cmp	eax, 21					; 00000015H
	jne	SHORT $LN16@PKCS7_ctrl
; Line 80
	mov	ecx, DWORD PTR [esi+20]
	mov	ecx, DWORD PTR [ecx+20]
	push	DWORD PTR [ecx+20]
	call	_ASN1_OCTET_STRING_free
; Line 81
	mov	ecx, DWORD PTR [esi+20]
	add	esp, 4
	mov	ecx, DWORD PTR [ecx+20]
	mov	DWORD PTR [ecx+20], 0
$LN16@PKCS7_ctrl:
; Line 108
	mov	eax, edi
	pop	edi
	pop	esi
; Line 109
	ret	0
$LN5@PKCS7_ctrl:
; Line 84
	push	85					; 00000055H
	jmp	SHORT $LN19@PKCS7_ctrl
_PKCS7_ctrl ENDP
_TEXT	ENDS
END
