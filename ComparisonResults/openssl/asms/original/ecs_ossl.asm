; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\ecdsa\ecs_ossl.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	??_C@_0BF@DJKLHCAL@OpenSSL?5ECDSA?5method?$AA@	; `string'
;	COMDAT ??_C@_0BF@DJKLHCAL@OpenSSL?5ECDSA?5method?$AA@
CONST	SEGMENT
??_C@_0BF@DJKLHCAL@OpenSSL?5ECDSA?5method?$AA@ DB 'OpenSSL ECDSA method', 00H ; `string'
CONST	ENDS
_DATA	SEGMENT
_openssl_ecdsa_meth DD FLAT:??_C@_0BF@DJKLHCAL@OpenSSL?5ECDSA?5method?$AA@
	DD	FLAT:_ecdsa_do_sign
	DD	FLAT:_ecdsa_sign_setup
	DD	FLAT:_ecdsa_do_verify
	DD	00H
	DD	00H
_DATA	ENDS
PUBLIC	_ECDSA_OpenSSL
PUBLIC	??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@ ; `string'
EXTRN	_BN_CTX_new:PROC
EXTRN	_BN_CTX_free:PROC
EXTRN	_BN_CTX_start:PROC
EXTRN	_BN_CTX_get:PROC
EXTRN	_BN_CTX_end:PROC
EXTRN	_BN_rand_range:PROC
EXTRN	_BN_num_bits:PROC
EXTRN	_BN_new:PROC
EXTRN	_BN_clear_free:PROC
EXTRN	_BN_copy:PROC
EXTRN	_BN_bin2bn:PROC
EXTRN	_BN_add:PROC
EXTRN	_BN_nnmod:PROC
EXTRN	_BN_mod_add_quick:PROC
EXTRN	_BN_mod_sub:PROC
EXTRN	_BN_mod_mul:PROC
EXTRN	_BN_set_word:PROC
EXTRN	_BN_free:PROC
EXTRN	_BN_mod_exp_mont_consttime:PROC
EXTRN	_BN_rshift:PROC
EXTRN	_BN_ucmp:PROC
EXTRN	_BN_mod_inverse:PROC
EXTRN	_EC_GROUP_method_of:PROC
EXTRN	_EC_METHOD_get_field_type:PROC
EXTRN	_EC_GROUP_get_mont_data:PROC
EXTRN	_EC_GROUP_get_order:PROC
EXTRN	_EC_POINT_new:PROC
EXTRN	_EC_POINT_free:PROC
EXTRN	_EC_POINT_get_affine_coordinates_GFp:PROC
EXTRN	_EC_POINT_get_affine_coordinates_GF2m:PROC
EXTRN	_EC_POINT_mul:PROC
EXTRN	_EC_KEY_get0_group:PROC
EXTRN	_EC_KEY_get0_private_key:PROC
EXTRN	_EC_KEY_get0_public_key:PROC
EXTRN	_ECDSA_SIG_new:PROC
EXTRN	_ECDSA_SIG_free:PROC
EXTRN	_ECDSA_sign_setup:PROC
EXTRN	_ecdsa_check:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
CONST	SEGMENT
??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@ DB '.\crypto\ecdsa'
	DB	'\ecs_ossl.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ecdsa_do_verify
_TEXT	SEGMENT
_u2$1$ = -24						; size = 4
_m$1$ = -20						; size = 4
_X$1$ = -16						; size = 4
_u1$1$ = -12						; size = 4
_i$1$ = -8						; size = 4
_pub_key$1$ = -4					; size = 4
_dgst$ = 8						; size = 4
_dgst_len$ = 12						; size = 4
_sig$ = 16						; size = 4
_order$1$ = 20						; size = 4
_eckey$ = 20						; size = 4
_ecdsa_do_verify PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ecdsa\ecs_ossl.c
; Line 353
	mov	eax, 24					; 00000018H
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
; Line 363
	mov	esi, DWORD PTR _eckey$[esp+32]
	xor	ebx, ebx
	push	edi
	or	edi, -1
	test	esi, esi
	je	$LN3@ecdsa_do_v
	push	esi
	call	_EC_KEY_get0_group
	mov	ebp, eax
	add	esp, 4
	test	ebp, ebp
	je	$LN3@ecdsa_do_v
	push	esi
	call	_EC_KEY_get0_public_key
	add	esp, 4
	mov	DWORD PTR _pub_key$1$[esp+40], eax
	test	eax, eax
	je	$LN3@ecdsa_do_v
	cmp	DWORD PTR _sig$[esp+36], ebx
	je	$LN3@ecdsa_do_v
; Line 368
	call	_BN_CTX_new
	mov	esi, eax
; Line 369
	test	esi, esi
	jne	SHORT $LN4@ecdsa_do_v
; Line 370
	push	370					; 00000172H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
; Line 371
	jmp	$LN25@ecdsa_do_v
$LN4@ecdsa_do_v:
; Line 373
	push	esi
	call	_BN_CTX_start
; Line 374
	push	esi
	call	_BN_CTX_get
; Line 375
	push	esi
	mov	DWORD PTR _order$1$[esp+48], eax
	call	_BN_CTX_get
; Line 376
	push	esi
	mov	DWORD PTR _u1$1$[esp+56], eax
	call	_BN_CTX_get
; Line 377
	push	esi
	mov	DWORD PTR _u2$1$[esp+60], eax
	call	_BN_CTX_get
; Line 378
	push	esi
	mov	DWORD PTR _m$1$[esp+64], eax
	call	_BN_CTX_get
	add	esp, 24					; 00000018H
	mov	DWORD PTR _X$1$[esp+40], eax
; Line 379
	test	eax, eax
	jne	SHORT $LN5@ecdsa_do_v
; Line 380
	push	380					; 0000017cH
$LN26@ecdsa_do_v:
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 381
	jmp	$err$29
$LN5@ecdsa_do_v:
; Line 384
	push	esi
	push	DWORD PTR _order$1$[esp+40]
	push	ebp
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN6@ecdsa_do_v
; Line 385
	push	385					; 00000181H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 386
	jmp	$err$29
$LN6@ecdsa_do_v:
; Line 391
	mov	eax, DWORD PTR _sig$[esp+36]
	mov	eax, DWORD PTR [eax]
	cmp	DWORD PTR [eax+4], ebx
	je	$LN8@ecdsa_do_v
	cmp	DWORD PTR [eax+12], ebx
	jne	$LN8@ecdsa_do_v
	push	DWORD PTR _order$1$[esp+36]
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jns	$LN8@ecdsa_do_v
	mov	eax, DWORD PTR _sig$[esp+36]
	mov	eax, DWORD PTR [eax+4]
	cmp	DWORD PTR [eax+4], ebx
	je	$LN8@ecdsa_do_v
	cmp	DWORD PTR [eax+12], ebx
	jne	$LN8@ecdsa_do_v
	push	DWORD PTR _order$1$[esp+36]
	push	eax
	call	_BN_ucmp
	add	esp, 8
	test	eax, eax
	jns	$LN8@ecdsa_do_v
; Line 397
	mov	eax, DWORD PTR _sig$[esp+36]
	push	esi
	push	DWORD PTR _order$1$[esp+40]
	push	DWORD PTR [eax+4]
	push	DWORD PTR _u2$1$[esp+52]
	call	_BN_mod_inverse
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN9@ecdsa_do_v
; Line 398
	push	398					; 0000018eH
; Line 399
	jmp	$LN26@ecdsa_do_v
$LN9@ecdsa_do_v:
; Line 402
	push	DWORD PTR _order$1$[esp+36]
	call	_BN_num_bits
	mov	ecx, eax
	add	esp, 4
; Line 406
	mov	eax, DWORD PTR _dgst_len$[esp+36]
	shl	eax, 3
	mov	DWORD PTR _i$1$[esp+40], ecx
	cmp	eax, ecx
	jle	SHORT $LN24@ecdsa_do_v
; Line 407
	lea	eax, DWORD PTR [ecx+7]
	cdq
	and	edx, 7
	add	eax, edx
	sar	eax, 3
	mov	DWORD PTR _dgst_len$[esp+36], eax
	jmp	SHORT $LN10@ecdsa_do_v
$LN24@ecdsa_do_v:
	mov	eax, DWORD PTR _dgst_len$[esp+36]
$LN10@ecdsa_do_v:
; Line 408
	push	DWORD PTR _m$1$[esp+40]
	push	eax
	push	DWORD PTR _dgst$[esp+44]
	call	_BN_bin2bn
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN11@ecdsa_do_v
; Line 409
	push	409					; 00000199H
; Line 410
	jmp	$LN26@ecdsa_do_v
$LN11@ecdsa_do_v:
; Line 413
	mov	eax, DWORD PTR _dgst_len$[esp+36]
	mov	ecx, DWORD PTR _i$1$[esp+40]
	shl	eax, 3
	cmp	eax, ecx
	jle	SHORT $LN12@ecdsa_do_v
	and	ecx, 7
	mov	eax, 8
	sub	eax, ecx
	push	eax
	mov	eax, DWORD PTR _m$1$[esp+44]
	push	eax
	push	eax
	call	_BN_rshift
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN12@ecdsa_do_v
; Line 414
	push	414					; 0000019eH
; Line 415
	jmp	$LN26@ecdsa_do_v
$LN12@ecdsa_do_v:
; Line 418
	push	esi
	push	DWORD PTR _order$1$[esp+40]
	push	DWORD PTR _u2$1$[esp+48]
	push	DWORD PTR _m$1$[esp+52]
	push	DWORD PTR _u1$1$[esp+56]
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN13@ecdsa_do_v
; Line 419
	push	419					; 000001a3H
; Line 420
	jmp	$LN26@ecdsa_do_v
$LN13@ecdsa_do_v:
; Line 423
	mov	eax, DWORD PTR _sig$[esp+36]
	mov	ecx, DWORD PTR _u2$1$[esp+40]
	push	esi
	push	DWORD PTR _order$1$[esp+40]
	push	ecx
	push	DWORD PTR [eax]
	push	ecx
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN14@ecdsa_do_v
; Line 424
	push	424					; 000001a8H
; Line 425
	jmp	$LN26@ecdsa_do_v
$LN14@ecdsa_do_v:
; Line 428
	push	ebp
	call	_EC_POINT_new
	mov	ebx, eax
	add	esp, 4
	test	ebx, ebx
	jne	SHORT $LN15@ecdsa_do_v
; Line 429
	push	429					; 000001adH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
	jmp	$err$29
$LN15@ecdsa_do_v:
; Line 432
	push	esi
	push	DWORD PTR _u2$1$[esp+44]
	push	DWORD PTR _pub_key$1$[esp+48]
	push	DWORD PTR _u1$1$[esp+52]
	push	ebx
	push	ebp
	call	_EC_POINT_mul
	add	esp, 24					; 00000018H
	test	eax, eax
	jne	SHORT $LN16@ecdsa_do_v
; Line 433
	push	433					; 000001b1H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
	jmp	$err$29
$LN16@ecdsa_do_v:
; Line 436
	push	ebp
	call	_EC_GROUP_method_of
	push	eax
	call	_EC_METHOD_get_field_type
	add	esp, 8
; Line 438
	push	esi
	push	0
	push	DWORD PTR _X$1$[esp+48]
	push	ebx
	push	ebp
	cmp	eax, 406				; 00000196H
	jne	SHORT $LN17@ecdsa_do_v
	call	_EC_POINT_get_affine_coordinates_GFp
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN20@ecdsa_do_v
; Line 439
	push	439					; 000001b7H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
	jmp	SHORT $err$29
$LN17@ecdsa_do_v:
; Line 446
	call	_EC_POINT_get_affine_coordinates_GF2m
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN20@ecdsa_do_v
; Line 447
	push	447					; 000001bfH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
	jmp	SHORT $err$29
$LN20@ecdsa_do_v:
; Line 452
	mov	ebp, DWORD PTR _u1$1$[esp+40]
	push	esi
	push	DWORD PTR _order$1$[esp+40]
	push	DWORD PTR _X$1$[esp+48]
	push	ebp
	call	_BN_nnmod
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN21@ecdsa_do_v
; Line 453
	push	453					; 000001c5H
; Line 454
	jmp	$LN26@ecdsa_do_v
$LN21@ecdsa_do_v:
; Line 457
	mov	eax, DWORD PTR _sig$[esp+36]
	push	DWORD PTR [eax]
	push	ebp
	call	_BN_ucmp
	add	esp, 8
	mov	edi, eax
	neg	edi
	sbb	edi, edi
	inc	edi
	jmp	SHORT $err$29
$LN8@ecdsa_do_v:
; Line 392
	push	392					; 00000188H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	100					; 00000064H
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 393
	xor	edi, edi
$err$29:
; Line 459
	push	esi
	call	_BN_CTX_end
; Line 460
	push	esi
	call	_BN_CTX_free
	add	esp, 8
; Line 461
	test	ebx, ebx
	je	SHORT $LN22@ecdsa_do_v
; Line 462
	push	ebx
	call	_EC_POINT_free
	add	esp, 4
$LN22@ecdsa_do_v:
; Line 463
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 464
	add	esp, 24					; 00000018H
	ret	0
$LN3@ecdsa_do_v:
; Line 364
	push	364					; 0000016cH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	103					; 00000067H
$LN25@ecdsa_do_v:
	push	102					; 00000066H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 365
	or	eax, -1
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 464
	add	esp, 24					; 00000018H
	ret	0
_ecdsa_do_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ecdsa_sign_setup
_TEXT	SEGMENT
_r$1$ = -12						; size = 4
_tmp_point$1$ = -8					; size = 4
_group$1$ = -4						; size = 4
_X$1$ = 8						; size = 4
_eckey$ = 8						; size = 4
_ctx_in$ = 12						; size = 4
_kinvp$ = 16						; size = 4
_rp$ = 20						; size = 4
_ecdsa_sign_setup PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ecdsa\ecs_ossl.c
; Line 92
	mov	eax, 12					; 0000000cH
	call	__chkstk
; Line 99
	mov	eax, DWORD PTR _eckey$[esp+8]
	mov	DWORD PTR _tmp_point$1$[esp+12], 0
	push	esi
	test	eax, eax
	je	$LN9@ecdsa_sign
	push	eax
	call	_EC_KEY_get0_group
	mov	esi, eax
	add	esp, 4
	mov	DWORD PTR _group$1$[esp+16], esi
	test	esi, esi
	je	$LN9@ecdsa_sign
; Line 104
	mov	eax, DWORD PTR _ctx_in$[esp+12]
	push	ebp
	test	eax, eax
	jne	SHORT $LN10@ecdsa_sign
; Line 105
	call	_BN_CTX_new
	mov	ebp, eax
	test	ebp, ebp
	jne	SHORT $LN11@ecdsa_sign
; Line 106
	push	106					; 0000006aH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
	push	103					; 00000067H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 107
	xor	eax, eax
	pop	ebp
	pop	esi
; Line 233
	add	esp, 12					; 0000000cH
	ret	0
$LN10@ecdsa_sign:
; Line 110
	mov	ebp, eax
$LN11@ecdsa_sign:
	push	ebx
	push	edi
; Line 112
	call	_BN_new
	mov	edi, eax
; Line 113
	call	_BN_new
	mov	DWORD PTR _r$1$[esp+28], eax
; Line 114
	call	_BN_new
	mov	ebx, eax
; Line 115
	call	_BN_new
	mov	DWORD PTR _X$1$[esp+24], eax
; Line 116
	test	edi, edi
	je	$LN14@ecdsa_sign
	mov	ecx, DWORD PTR _r$1$[esp+28]
	test	ecx, ecx
	je	$LN14@ecdsa_sign
	test	ebx, ebx
	je	$LN14@ecdsa_sign
	test	eax, eax
	je	$LN14@ecdsa_sign
; Line 120
	push	esi
	call	_EC_POINT_new
	add	esp, 4
	mov	DWORD PTR _tmp_point$1$[esp+28], eax
	test	eax, eax
	jne	SHORT $LN15@ecdsa_sign
; Line 121
	push	121					; 00000079H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
; Line 122
	jmp	$LN81@ecdsa_sign
$LN15@ecdsa_sign:
; Line 124
	push	ebp
	push	ebx
	push	esi
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LL7@ecdsa_sign
; Line 125
	push	125					; 0000007dH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	jmp	$LN81@ecdsa_sign
	npad	5
$LL7@ecdsa_sign:
; Line 132
	push	ebx
	push	edi
	call	_BN_rand_range
	add	esp, 8
	test	eax, eax
	je	$LN45@ecdsa_sign
; Line 137
	cmp	DWORD PTR [edi+4], 0
	je	SHORT $LL7@ecdsa_sign
; Line 144
	push	ebx
	push	edi
	push	edi
	call	_BN_add
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN74@ecdsa_sign
; Line 146
	push	ebx
	call	_BN_num_bits
	push	edi
	mov	esi, eax
	call	_BN_num_bits
	add	esp, 8
	cmp	eax, esi
	jg	SHORT $LN20@ecdsa_sign
; Line 147
	push	ebx
	push	edi
	push	edi
	call	_BN_add
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$LN74@ecdsa_sign
$LN20@ecdsa_sign:
; Line 151
	mov	esi, DWORD PTR _group$1$[esp+28]
	push	ebp
	push	0
	push	0
	push	edi
	push	DWORD PTR _tmp_point$1$[esp+44]
	push	esi
	call	_EC_POINT_mul
	add	esp, 24					; 00000018H
	test	eax, eax
	je	$LN50@ecdsa_sign
; Line 155
	push	esi
	call	_EC_GROUP_method_of
	push	eax
	call	_EC_METHOD_get_field_type
	add	esp, 8
; Line 157
	push	ebp
	push	0
	push	DWORD PTR _X$1$[esp+32]
	push	DWORD PTR _tmp_point$1$[esp+40]
	push	esi
	cmp	eax, 406				; 00000196H
	jne	SHORT $LN22@ecdsa_sign
	call	_EC_POINT_get_affine_coordinates_GFp
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN25@ecdsa_sign
; Line 159
	push	159					; 0000009fH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	jmp	$LN81@ecdsa_sign
$LN22@ecdsa_sign:
; Line 166
	call	_EC_POINT_get_affine_coordinates_GF2m
	add	esp, 20					; 00000014H
	test	eax, eax
	je	$LN52@ecdsa_sign
$LN25@ecdsa_sign:
; Line 174
	push	ebp
	push	ebx
	push	DWORD PTR _X$1$[esp+32]
	push	DWORD PTR _r$1$[esp+40]
	call	_BN_nnmod
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN53@ecdsa_sign
; Line 179
	mov	eax, DWORD PTR _r$1$[esp+28]
	cmp	DWORD PTR [eax+4], 0
	je	$LL7@ecdsa_sign
; Line 182
	push	esi
	call	_EC_GROUP_get_mont_data
	add	esp, 4
	test	eax, eax
	je	$LN27@ecdsa_sign
; Line 187
	push	2
	push	DWORD PTR _X$1$[esp+28]
	call	_BN_set_word
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN29@ecdsa_sign
; Line 188
	push	188					; 000000bcH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 189
	jmp	$LN81@ecdsa_sign
$LN29@ecdsa_sign:
; Line 191
	mov	eax, DWORD PTR _X$1$[esp+24]
	push	ebp
	push	ebx
	push	eax
	push	ebx
	push	eax
	call	_BN_mod_sub
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN30@ecdsa_sign
; Line 192
	push	192					; 000000c0H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 193
	jmp	$LN81@ecdsa_sign
$LN30@ecdsa_sign:
; Line 195
	mov	eax, DWORD PTR _X$1$[esp+24]
; Line 196
	push	esi
	or	DWORD PTR [eax+16], 4
	call	_EC_GROUP_get_mont_data
	mov	esi, DWORD PTR _X$1$[esp+28]
	push	eax
	push	ebp
	push	ebx
	push	esi
	push	edi
	push	edi
	call	_BN_mod_exp_mont_consttime
	add	esp, 28					; 0000001cH
	test	eax, eax
	jne	SHORT $LN32@ecdsa_sign
; Line 198
	push	198					; 000000c6H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
	push	103					; 00000067H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 199
	jmp	$LN62@ecdsa_sign
$LN27@ecdsa_sign:
; Line 202
	push	ebp
	push	ebx
	push	edi
	push	edi
	call	_BN_mod_inverse
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN75@ecdsa_sign
; Line 203
	push	203					; 000000cbH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 204
	jmp	$LN81@ecdsa_sign
$LN75@ecdsa_sign:
	mov	esi, DWORD PTR _X$1$[esp+24]
$LN32@ecdsa_sign:
; Line 209
	mov	eax, DWORD PTR _rp$[esp+24]
	mov	eax, DWORD PTR [eax]
	test	eax, eax
	je	SHORT $LN33@ecdsa_sign
; Line 210
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN33@ecdsa_sign:
; Line 211
	mov	eax, DWORD PTR _kinvp$[esp+24]
	mov	eax, DWORD PTR [eax]
	test	eax, eax
	je	SHORT $LN34@ecdsa_sign
; Line 212
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN34@ecdsa_sign:
; Line 214
	mov	eax, DWORD PTR _rp$[esp+24]
	mov	ecx, DWORD PTR _r$1$[esp+28]
	mov	DWORD PTR [eax], ecx
; Line 215
	mov	eax, DWORD PTR _kinvp$[esp+24]
	mov	DWORD PTR [eax], edi
; Line 216
	mov	edi, 1
	jmp	SHORT $LN37@ecdsa_sign
$LN53@ecdsa_sign:
; Line 175
	push	175					; 000000afH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 176
	jmp	SHORT $LN81@ecdsa_sign
$LN52@ecdsa_sign:
; Line 169
	push	169					; 000000a9H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	jmp	SHORT $LN81@ecdsa_sign
$LN50@ecdsa_sign:
; Line 152
	push	152					; 00000098H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
	jmp	SHORT $LN81@ecdsa_sign
$LN45@ecdsa_sign:
; Line 133
	push	134					; 00000086H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	104					; 00000068H
; Line 135
	jmp	SHORT $LN81@ecdsa_sign
$LN14@ecdsa_sign:
; Line 117
	push	117					; 00000075H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
$LN81@ecdsa_sign:
	push	103					; 00000067H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN74@ecdsa_sign:
	mov	esi, DWORD PTR _X$1$[esp+24]
$LN62@ecdsa_sign:
; Line 219
	test	edi, edi
	je	SHORT $LN36@ecdsa_sign
; Line 220
	push	edi
	call	_BN_clear_free
	add	esp, 4
$LN36@ecdsa_sign:
; Line 221
	mov	eax, DWORD PTR _r$1$[esp+28]
	test	eax, eax
	je	SHORT $LN76@ecdsa_sign
; Line 222
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN76@ecdsa_sign:
	xor	edi, edi
$LN37@ecdsa_sign:
; Line 224
	cmp	DWORD PTR _ctx_in$[esp+24], 0
	jne	SHORT $LN38@ecdsa_sign
; Line 225
	push	ebp
	call	_BN_CTX_free
	add	esp, 4
$LN38@ecdsa_sign:
; Line 226
	test	ebx, ebx
	je	SHORT $LN39@ecdsa_sign
; Line 227
	push	ebx
	call	_BN_free
	add	esp, 4
$LN39@ecdsa_sign:
; Line 228
	mov	eax, DWORD PTR _tmp_point$1$[esp+28]
	test	eax, eax
	je	SHORT $LN40@ecdsa_sign
; Line 229
	push	eax
	call	_EC_POINT_free
	add	esp, 4
$LN40@ecdsa_sign:
; Line 230
	test	esi, esi
	je	SHORT $LN41@ecdsa_sign
; Line 231
	push	esi
	call	_BN_clear_free
	add	esp, 4
$LN41@ecdsa_sign:
; Line 232
	mov	eax, edi
	pop	edi
	pop	ebx
	pop	ebp
	pop	esi
; Line 233
	add	esp, 12					; 0000000cH
	ret	0
$LN9@ecdsa_sign:
; Line 100
	push	100					; 00000064H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	67					; 00000043H
	push	103					; 00000067H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 101
	xor	eax, eax
	pop	esi
; Line 233
	add	esp, 12					; 0000000cH
	ret	0
_ecdsa_sign_setup ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ecdsa_do_sign
_TEXT	SEGMENT
_m$1$ = -20						; size = 4
_tmp$1$ = -16						; size = 4
_kinv$ = -12						; size = 4
_ckinv$1$ = -8						; size = 4
_i$1$ = -8						; size = 4
_group$1$ = -8						; size = 4
_priv_key$1$ = -4					; size = 4
_dgst$ = 8						; size = 4
_dgst_len$ = 12						; size = 4
_in_kinv$ = 16						; size = 4
_in_r$ = 20						; size = 4
_eckey$ = 24						; size = 4
_ecdsa_do_sign PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ecdsa\ecs_ossl.c
; Line 238
	mov	eax, 20					; 00000014H
	call	__chkstk
	push	ebx
	push	ebp
; Line 248
	mov	ebp, DWORD PTR _eckey$[esp+24]
	push	esi
	push	edi
	push	ebp
	mov	DWORD PTR _kinv$[esp+40], 0
	xor	esi, esi
	mov	DWORD PTR _m$1$[esp+40], 0
	mov	DWORD PTR _tmp$1$[esp+40], 0
	call	_ecdsa_check
; Line 249
	push	ebp
	mov	edi, eax
	call	_EC_KEY_get0_group
	mov	ebx, eax
; Line 250
	push	ebp
	mov	DWORD PTR _group$1$[esp+48], ebx
	call	_EC_KEY_get0_private_key
	add	esp, 12					; 0000000cH
	mov	DWORD PTR _priv_key$1$[esp+36], eax
; Line 252
	test	ebx, ebx
	je	$LN6@ecdsa_do_s
	test	eax, eax
	je	$LN6@ecdsa_do_s
	test	edi, edi
	je	$LN6@ecdsa_do_s
; Line 257
	call	_ECDSA_SIG_new
	mov	edi, eax
; Line 258
	test	edi, edi
	jne	SHORT $LN7@ecdsa_do_s
; Line 259
	push	259					; 00000103H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
; Line 260
	jmp	$LN49@ecdsa_do_s
$LN7@ecdsa_do_s:
; Line 262
	mov	ebp, DWORD PTR [edi+4]
; Line 265
	call	_BN_CTX_new
	mov	ebx, eax
	test	ebx, ebx
	je	$LN9@ecdsa_do_s
	call	_BN_new
	mov	esi, eax
	test	esi, esi
	je	$LN9@ecdsa_do_s
	call	_BN_new
	mov	DWORD PTR _tmp$1$[esp+36], eax
	test	eax, eax
	je	$LN9@ecdsa_do_s
	call	_BN_new
	mov	DWORD PTR _m$1$[esp+36], eax
	test	eax, eax
	je	$LN9@ecdsa_do_s
; Line 270
	push	ebx
	push	esi
	push	DWORD PTR _group$1$[esp+44]
	call	_EC_GROUP_get_order
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN10@ecdsa_do_s
; Line 271
	push	271					; 0000010fH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	16					; 00000010H
; Line 272
	jmp	$LN50@ecdsa_do_s
$LN10@ecdsa_do_s:
; Line 274
	push	esi
	call	_BN_num_bits
; Line 278
	mov	ecx, DWORD PTR _dgst_len$[esp+36]
	add	esp, 4
	shl	ecx, 3
	mov	DWORD PTR _i$1$[esp+36], eax
	cmp	ecx, eax
	jle	SHORT $LN48@ecdsa_do_s
; Line 279
	add	eax, 7
	cdq
	and	edx, 7
	add	eax, edx
	sar	eax, 3
	mov	DWORD PTR _dgst_len$[esp+32], eax
	jmp	SHORT $LN11@ecdsa_do_s
$LN48@ecdsa_do_s:
	mov	eax, DWORD PTR _dgst_len$[esp+32]
$LN11@ecdsa_do_s:
; Line 280
	push	DWORD PTR _m$1$[esp+36]
	push	eax
	push	DWORD PTR _dgst$[esp+40]
	call	_BN_bin2bn
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN12@ecdsa_do_s
; Line 281
	push	281					; 00000119H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 282
	jmp	$LN50@ecdsa_do_s
$LN12@ecdsa_do_s:
; Line 285
	mov	ecx, DWORD PTR _dgst_len$[esp+32]
	lea	eax, DWORD PTR [ecx*8]
	mov	ecx, DWORD PTR _i$1$[esp+36]
	cmp	eax, ecx
	jle	SHORT $LN47@ecdsa_do_s
	and	ecx, 7
	mov	eax, 8
	sub	eax, ecx
	push	eax
	mov	eax, DWORD PTR _m$1$[esp+40]
	push	eax
	push	eax
	call	_BN_rshift
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN47@ecdsa_do_s
; Line 286
	push	286					; 0000011eH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 287
	jmp	$LN50@ecdsa_do_s
$LN47@ecdsa_do_s:
	mov	eax, DWORD PTR _in_r$[esp+32]
	mov	ecx, DWORD PTR _in_kinv$[esp+32]
$LL4@ecdsa_do_s:
; Line 290
	test	ecx, ecx
	je	SHORT $LN16@ecdsa_do_s
	test	eax, eax
	je	SHORT $LN16@ecdsa_do_s
; Line 298
	push	eax
	push	DWORD PTR [edi]
	mov	DWORD PTR _ckinv$1$[esp+44], ecx
	call	_BN_copy
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN18@ecdsa_do_s
; Line 299
	push	299					; 0000012bH
; Line 300
	jmp	$LN52@ecdsa_do_s
$LN16@ecdsa_do_s:
; Line 291
	push	edi
	lea	eax, DWORD PTR _kinv$[esp+40]
	push	eax
	push	ebx
	push	DWORD PTR _eckey$[esp+44]
	call	_ECDSA_sign_setup
	add	esp, 16					; 00000010H
	test	eax, eax
	je	$LN34@ecdsa_do_s
; Line 295
	mov	eax, DWORD PTR _kinv$[esp+36]
	mov	DWORD PTR _ckinv$1$[esp+36], eax
$LN18@ecdsa_do_s:
; Line 304
	push	ebx
	push	esi
	push	DWORD PTR [edi]
	push	DWORD PTR _priv_key$1$[esp+48]
	push	DWORD PTR _tmp$1$[esp+52]
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN35@ecdsa_do_s
; Line 308
	push	esi
	push	DWORD PTR _m$1$[esp+40]
	push	DWORD PTR _tmp$1$[esp+44]
	push	ebp
	call	_BN_mod_add_quick
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN36@ecdsa_do_s
; Line 312
	push	ebx
	push	esi
	push	DWORD PTR _ckinv$1$[esp+44]
	push	ebp
	push	ebp
	call	_BN_mod_mul
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN37@ecdsa_do_s
; Line 316
	cmp	DWORD PTR [ebp+4], 0
	jne	SHORT $LN25@ecdsa_do_s
; Line 321
	mov	ecx, DWORD PTR _in_kinv$[esp+32]
	mov	eax, DWORD PTR _in_r$[esp+32]
	test	ecx, ecx
	je	SHORT $LN16@ecdsa_do_s
	test	eax, eax
	je	$LL4@ecdsa_do_s
; Line 322
	push	323					; 00000143H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	106					; 0000006aH
; Line 324
	jmp	SHORT $LN50@ecdsa_do_s
$LN37@ecdsa_do_s:
; Line 313
	push	313					; 00000139H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 314
	jmp	SHORT $LN50@ecdsa_do_s
$LN36@ecdsa_do_s:
; Line 309
	push	309					; 00000135H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 310
	jmp	SHORT $LN50@ecdsa_do_s
$LN35@ecdsa_do_s:
; Line 305
	push	305					; 00000131H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	3
; Line 306
	jmp	SHORT $LN50@ecdsa_do_s
$LN34@ecdsa_do_s:
; Line 292
	push	292					; 00000124H
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	42					; 0000002aH
; Line 293
	jmp	SHORT $LN50@ecdsa_do_s
$LN9@ecdsa_do_s:
; Line 266
	push	266					; 0000010aH
$LN52@ecdsa_do_s:
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	65					; 00000041H
$LN50@ecdsa_do_s:
	push	101					; 00000065H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 335
	push	edi
	call	_ECDSA_SIG_free
	add	esp, 4
; Line 336
	xor	edi, edi
$LN25@ecdsa_do_s:
; Line 338
	test	ebx, ebx
	je	SHORT $LN26@ecdsa_do_s
; Line 339
	push	ebx
	call	_BN_CTX_free
	add	esp, 4
$LN26@ecdsa_do_s:
; Line 340
	mov	eax, DWORD PTR _m$1$[esp+36]
	test	eax, eax
	je	SHORT $LN27@ecdsa_do_s
; Line 341
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN27@ecdsa_do_s:
; Line 342
	mov	eax, DWORD PTR _tmp$1$[esp+36]
	test	eax, eax
	je	SHORT $LN28@ecdsa_do_s
; Line 343
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN28@ecdsa_do_s:
; Line 344
	test	esi, esi
	je	SHORT $LN29@ecdsa_do_s
; Line 345
	push	esi
	call	_BN_free
	add	esp, 4
$LN29@ecdsa_do_s:
; Line 346
	mov	eax, DWORD PTR _kinv$[esp+36]
	test	eax, eax
	je	SHORT $LN30@ecdsa_do_s
; Line 347
	push	eax
	call	_BN_clear_free
	add	esp, 4
$LN30@ecdsa_do_s:
; Line 348
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 349
	add	esp, 20					; 00000014H
	ret	0
$LN6@ecdsa_do_s:
; Line 253
	push	253					; 000000fdH
	push	OFFSET ??_C@_0BK@JICBNKGE@?4?2crypto?2ecdsa?2ecs_ossl?4c?$AA@
	push	67					; 00000043H
$LN49@ecdsa_do_s:
	push	101					; 00000065H
	push	42					; 0000002aH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 254
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 349
	add	esp, 20					; 00000014H
	ret	0
_ecdsa_do_sign ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ECDSA_OpenSSL
_TEXT	SEGMENT
_ECDSA_OpenSSL PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\ecdsa\ecs_ossl.c
; Line 87
	mov	eax, OFFSET _openssl_ecdsa_meth
; Line 88
	ret	0
_ECDSA_OpenSSL ENDP
_TEXT	ENDS
END
