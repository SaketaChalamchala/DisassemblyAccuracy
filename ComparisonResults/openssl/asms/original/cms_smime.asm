; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_CMS_final
PUBLIC	_CMS_sign
PUBLIC	_CMS_sign_receipt
PUBLIC	_CMS_data
PUBLIC	_CMS_data_create
PUBLIC	_CMS_digest_verify
PUBLIC	_CMS_digest_create
PUBLIC	_CMS_EncryptedData_decrypt
PUBLIC	_CMS_EncryptedData_encrypt
PUBLIC	_CMS_verify
PUBLIC	_CMS_verify_receipt
PUBLIC	_CMS_encrypt
PUBLIC	_CMS_decrypt
PUBLIC	_CMS_decrypt_set1_pkey
PUBLIC	_CMS_decrypt_set1_key
PUBLIC	_CMS_decrypt_set1_password
PUBLIC	_CMS_uncompress
PUBLIC	_CMS_compress
PUBLIC	??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@ ; `string'
PUBLIC	??_C@_0L@GGDBHMO@smime_sign?$AA@		; `string'
PUBLIC	??_C@_0O@HFNJECFC@Verify?5error?3?$AA@		; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_BIO_method_type:PROC
EXTRN	_BIO_new:PROC
EXTRN	_BIO_free:PROC
EXTRN	_BIO_read:PROC
EXTRN	_BIO_write:PROC
EXTRN	_BIO_ctrl:PROC
EXTRN	_BIO_pop:PROC
EXTRN	_BIO_free_all:PROC
EXTRN	_BIO_s_mem:PROC
EXTRN	_BIO_new_mem_buf:PROC
EXTRN	_BIO_s_null:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_clear_error:PROC
EXTRN	_ERR_add_error_data:PROC
EXTRN	_SMIME_crlf_copy:PROC
EXTRN	_SMIME_text:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_EVP_sha1:PROC
EXTRN	_X509_STORE_CTX_init:PROC
EXTRN	_X509_STORE_CTX_cleanup:PROC
EXTRN	_X509_STORE_CTX_get_error:PROC
EXTRN	_X509_STORE_CTX_set0_crls:PROC
EXTRN	_X509_STORE_CTX_set_default:PROC
EXTRN	_X509_verify_cert_error_string:PROC
EXTRN	_X509_free:PROC
EXTRN	_X509_CRL_free:PROC
EXTRN	_X509_verify_cert:PROC
EXTRN	_CMS_ContentInfo_new:PROC
EXTRN	_CMS_ContentInfo_free:PROC
EXTRN	_CMS_get0_type:PROC
EXTRN	_CMS_dataInit:PROC
EXTRN	_CMS_dataFinal:PROC
EXTRN	_CMS_get0_content:PROC
EXTRN	_CMS_set_detached:PROC
EXTRN	_CMS_EncryptedData_set1_key:PROC
EXTRN	_CMS_get0_RecipientInfos:PROC
EXTRN	_CMS_RecipientInfo_type:PROC
EXTRN	_CMS_EnvelopedData_create:PROC
EXTRN	_CMS_add1_recipient_cert:PROC
EXTRN	_CMS_RecipientInfo_set0_pkey:PROC
EXTRN	_CMS_RecipientInfo_ktri_cert_cmp:PROC
EXTRN	_CMS_RecipientInfo_set0_key:PROC
EXTRN	_CMS_RecipientInfo_kekri_id_cmp:PROC
EXTRN	_CMS_RecipientInfo_set0_password:PROC
EXTRN	_CMS_RecipientInfo_decrypt:PROC
EXTRN	_CMS_set1_eContentType:PROC
EXTRN	_CMS_add1_cert:PROC
EXTRN	_CMS_get1_certs:PROC
EXTRN	_CMS_get1_crls:PROC
EXTRN	_CMS_SignedData_init:PROC
EXTRN	_CMS_add1_signer:PROC
EXTRN	_CMS_get0_SignerInfos:PROC
EXTRN	_CMS_set1_signers_certs:PROC
EXTRN	_CMS_SignerInfo_get0_algs:PROC
EXTRN	_CMS_SignerInfo_verify:PROC
EXTRN	_CMS_SignerInfo_verify_content:PROC
EXTRN	_CMS_signed_get_attr_count:PROC
EXTRN	_CMS_RecipientInfo_kari_get0_reks:PROC
EXTRN	_CMS_RecipientEncryptedKey_cert_cmp:PROC
EXTRN	_CMS_RecipientInfo_kari_set0_pkey:PROC
EXTRN	_CMS_RecipientInfo_kari_decrypt:PROC
EXTRN	_cms_Data_create:PROC
EXTRN	_cms_DigestedData_create:PROC
EXTRN	_cms_DigestedData_do_final:PROC
EXTRN	_cms_Receipt_verify:PROC
EXTRN	_cms_msgSigDigest_add1:PROC
EXTRN	_cms_encode_Receipt:PROC
EXTRN	_cms_pkey_get_ri_type:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
CONST	SEGMENT
??_C@_0O@HFNJECFC@Verify?5error?3?$AA@ DB 'Verify error:', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@GGDBHMO@smime_sign?$AA@
CONST	SEGMENT
??_C@_0L@GGDBHMO@smime_sign?$AA@ DB 'smime_sign', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
CONST	SEGMENT
??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@ DB '.\crypto\cms\cm'
	DB	's_smime.c', 00H				; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_kari_set1_pkey
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_ri$ = 12						; size = 4
_pk$ = 16						; size = 4
_cert$ = 20						; size = 4
_cms_kari_set1_pkey PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 574
	push	ebp
	push	edi
; Line 578
	push	DWORD PTR _ri$[esp+4]
	call	_CMS_RecipientInfo_kari_get0_reks
; Line 579
	mov	ebp, DWORD PTR _cert$[esp+8]
	add	esp, 4
	mov	edi, eax
	test	ebp, ebp
	jne	SHORT $LN5@cms_kari_s
; Line 580
	pop	edi
	xor	eax, eax
	pop	ebp
; Line 594
	ret	0
$LN5@cms_kari_s:
	push	ebx
	push	esi
; Line 581
	push	edi
	xor	esi, esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@cms_kari_s
	npad	2
$LL4@cms_kari_s:
; Line 583
	push	esi
	push	edi
	call	_sk_value
	mov	ebx, eax
; Line 584
	push	ebp
	push	ebx
	call	_CMS_RecipientEncryptedKey_cert_cmp
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN6@cms_kari_s
; Line 581
	push	edi
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@cms_kari_s
$LN3@cms_kari_s:
	pop	esi
	pop	ebx
	pop	edi
; Line 593
	xor	eax, eax
	pop	ebp
; Line 594
	ret	0
$LN6@cms_kari_s:
; Line 586
	push	DWORD PTR _pk$[esp+12]
	mov	edi, DWORD PTR _ri$[esp+16]
	push	edi
	call	_CMS_RecipientInfo_kari_set0_pkey
; Line 587
	push	ebx
	push	edi
	push	DWORD PTR _cms$[esp+28]
	call	_CMS_RecipientInfo_kari_decrypt
; Line 588
	push	0
	push	edi
	mov	esi, eax
	call	_CMS_RecipientInfo_kari_set0_pkey
	add	esp, 28					; 0000001cH
; Line 589
	xor	eax, eax
	test	esi, esi
	setg	al
	pop	esi
	pop	ebx
	pop	edi
	lea	eax, DWORD PTR [eax*2-1]
	pop	ebp
; Line 594
	ret	0
_cms_kari_set1_pkey ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_signerinfo_verify_cert
_TEXT	SEGMENT
_signer$ = -140						; size = 4
_ctx$ = -136						; size = 136
_si$ = 8						; size = 4
_store$ = 12						; size = 4
_certs$ = 16						; size = 4
_crls$ = 20						; size = 4
_flags$ = 24						; size = 4
_cms_signerinfo_verify_cert PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 270
	mov	eax, 140				; 0000008cH
	call	__chkstk
	push	edi
; Line 273
	xor	edi, edi
; Line 274
	lea	eax, DWORD PTR _signer$[esp+144]
	push	edi
	push	edi
	push	eax
	push	edi
	push	DWORD PTR _si$[esp+156]
	call	_CMS_SignerInfo_get0_algs
; Line 275
	push	DWORD PTR _certs$[esp+160]
	lea	eax, DWORD PTR _ctx$[esp+168]
	push	DWORD PTR _signer$[esp+168]
	push	DWORD PTR _store$[esp+168]
	push	eax
	call	_X509_STORE_CTX_init
	add	esp, 36					; 00000024H
	test	eax, eax
	jne	SHORT $LN2@cms_signer
; Line 276
	push	276					; 00000114H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	141					; 0000008dH
	push	153					; 00000099H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 277
	jmp	SHORT $err$7
$LN2@cms_signer:
; Line 279
	lea	eax, DWORD PTR _ctx$[esp+144]
	push	OFFSET ??_C@_0L@GGDBHMO@smime_sign?$AA@
	push	eax
	call	_X509_STORE_CTX_set_default
; Line 280
	mov	eax, DWORD PTR _crls$[esp+148]
	add	esp, 8
	test	eax, eax
	je	SHORT $LN3@cms_signer
; Line 281
	push	eax
	lea	eax, DWORD PTR _ctx$[esp+148]
	push	eax
	call	_X509_STORE_CTX_set0_crls
	add	esp, 8
$LN3@cms_signer:
; Line 283
	lea	eax, DWORD PTR _ctx$[esp+144]
	push	eax
	call	_X509_verify_cert
	add	esp, 4
; Line 284
	test	eax, eax
	jg	SHORT $LN4@cms_signer
; Line 285
	lea	eax, DWORD PTR _ctx$[esp+144]
	push	esi
	push	eax
	call	_X509_STORE_CTX_get_error
; Line 286
	push	287					; 0000011fH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	100					; 00000064H
	push	153					; 00000099H
	push	46					; 0000002eH
	mov	esi, eax
	call	_ERR_put_error
; Line 288
	push	esi
	call	_X509_verify_cert_error_string
	push	eax
	push	OFFSET ??_C@_0O@HFNJECFC@Verify?5error?3?$AA@
	push	2
	call	_ERR_add_error_data
	add	esp, 40					; 00000028H
	pop	esi
; Line 290
	jmp	SHORT $err$7
$LN4@cms_signer:
; Line 292
	mov	edi, 1
$err$7:
; Line 294
	lea	eax, DWORD PTR _ctx$[esp+144]
	push	eax
	call	_X509_STORE_CTX_cleanup
	add	esp, 4
; Line 295
	mov	eax, edi
	pop	edi
; Line 297
	add	esp, 140				; 0000008cH
	ret	0
_cms_signerinfo_verify_cert ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _do_free_upto
_TEXT	SEGMENT
_f$ = 8							; size = 4
_upto$ = 12						; size = 4
_do_free_upto PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 127
	push	ebx
; Line 128
	mov	ebx, DWORD PTR _upto$[esp]
	test	ebx, ebx
	je	SHORT $LN5@do_free_up
	push	edi
	mov	edi, DWORD PTR _f$[esp+4]
	push	esi
	npad	1
$LL4@do_free_up:
; Line 131
	push	edi
	call	_BIO_pop
; Line 132
	push	edi
	mov	esi, eax
	call	_BIO_free
	add	esp, 8
; Line 133
	mov	edi, esi
; Line 135
	test	esi, esi
	je	SHORT $LN13@do_free_up
	cmp	esi, ebx
	jne	SHORT $LL4@do_free_up
$LN13@do_free_up:
	pop	esi
	pop	edi
	pop	ebx
; Line 138
	ret	0
$LN5@do_free_up:
; Line 137
	push	DWORD PTR _f$[esp]
	call	_BIO_free_all
	add	esp, 4
	pop	ebx
; Line 138
	ret	0
_do_free_upto ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _check_content
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_check_content PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 118
	push	DWORD PTR _cms$[esp-4]
	call	_CMS_get0_content
	add	esp, 4
; Line 119
	test	eax, eax
	je	SHORT $LN3@check_cont
	cmp	DWORD PTR [eax], 0
	je	SHORT $LN3@check_cont
; Line 123
	mov	eax, 1
; Line 124
	ret	0
$LN3@check_cont:
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	127					; 0000007fH
	push	99					; 00000063H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 121
	xor	eax, eax
; Line 124
	ret	0
_check_content ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_copy_content
_TEXT	SEGMENT
_out$GSCopy$1$ = -4104					; size = 4
_buf$ = -4100						; size = 4096
__$ArrayPad$ = -4					; size = 4
_out$ = 8						; size = 4
_in$ = 12						; size = 4
_flags$ = 16						; size = 4
_cms_copy_content PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 65
	mov	eax, 4104				; 00001008H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+4104], eax
	mov	eax, DWORD PTR _out$[esp+4100]
	push	ebx
	mov	ebx, DWORD PTR _in$[esp+4104]
	push	ebp
; Line 67
	xor	ebp, ebp
	mov	DWORD PTR _out$GSCopy$1$[esp+4112], eax
	push	edi
; Line 70
	test	eax, eax
	jne	SHORT $LN5@cms_copy_c
; Line 71
	call	_BIO_s_null
	push	eax
	call	_BIO_new
	add	esp, 4
$LN7@cms_copy_c:
; Line 76
	mov	edi, eax
$LN8@cms_copy_c:
; Line 78
	test	edi, edi
	jne	SHORT $LN9@cms_copy_c
; Line 79
	push	79					; 0000004fH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	65					; 00000041H
	push	107					; 0000006bH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 80
	jmp	$LN25@cms_copy_c
$LN5@cms_copy_c:
; Line 72
	test	BYTE PTR _flags$[esp+4112], 1
	je	SHORT $LN7@cms_copy_c
; Line 73
	call	_BIO_s_mem
	push	eax
	call	_BIO_new
; Line 74
	push	0
	push	0
	mov	edi, eax
	push	130					; 00000082H
	push	edi
	call	_BIO_ctrl
	add	esp, 20					; 00000014H
; Line 75
	jmp	SHORT $LN8@cms_copy_c
$LN9@cms_copy_c:
	push	esi
; Line 85
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4124]
	push	eax
	push	ebx
	call	_BIO_read
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 86
	test	esi, esi
	jle	SHORT $LN21@cms_copy_c
$LL2@cms_copy_c:
; Line 96
	push	esi
	lea	eax, DWORD PTR _buf$[esp+4124]
	push	eax
	push	edi
	call	_BIO_write
	add	esp, 12					; 0000000cH
	cmp	eax, esi
	jne	SHORT $LN28@cms_copy_c
; Line 85
	push	4096					; 00001000H
	lea	eax, DWORD PTR _buf$[esp+4124]
	push	eax
	push	ebx
	call	_BIO_read
	mov	esi, eax
	add	esp, 12					; 0000000cH
; Line 86
	test	esi, esi
	jg	SHORT $LL2@cms_copy_c
$LN21@cms_copy_c:
; Line 87
	push	ebx
	call	_BIO_method_type
	add	esp, 4
	cmp	eax, 522				; 0000020aH
	jne	SHORT $LN12@cms_copy_c
; Line 88
	push	0
	push	0
	push	113					; 00000071H
	push	ebx
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN28@cms_copy_c
$LN12@cms_copy_c:
; Line 91
	test	esi, esi
; Line 101
	mov	esi, DWORD PTR _out$GSCopy$1$[esp+4120]
	js	SHORT $err$31
; Line 100
	test	BYTE PTR _flags$[esp+4116], 1
	je	SHORT $LN16@cms_copy_c
; Line 101
	push	esi
	push	edi
	call	_SMIME_text
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN16@cms_copy_c
; Line 102
	push	102					; 00000066H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	140					; 0000008cH
	push	107					; 0000006bH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 103
	jmp	SHORT $err$31
$LN16@cms_copy_c:
; Line 107
	mov	ebp, 1
	jmp	SHORT $err$31
$LN28@cms_copy_c:
	mov	esi, DWORD PTR _out$GSCopy$1$[esp+4120]
$err$31:
; Line 110
	cmp	edi, esi
	pop	esi
	je	SHORT $LN25@cms_copy_c
; Line 111
	push	edi
	call	_BIO_free
	add	esp, 4
$LN25@cms_copy_c:
; Line 114
	mov	ecx, DWORD PTR __$ArrayPad$[esp+4116]
	mov	eax, ebp
	pop	edi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 4104				; 00001008H
	ret	0
_cms_copy_content ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_compress
_TEXT	SEGMENT
_in$ = 8						; size = 4
_comp_nid$ = 12						; size = 4
_flags$ = 16						; size = 4
_CMS_compress PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 832
	push	832					; 00000340H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	151					; 00000097H
	push	104					; 00000068H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 833
	xor	eax, eax
; Line 834
	ret	0
_CMS_compress ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_uncompress
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_dcont$ = 12						; size = 4
_out$ = 16						; size = 4
_flags$ = 20						; size = 4
_CMS_uncompress PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 826
	push	826					; 0000033aH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	151					; 00000097H
	push	156					; 0000009cH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 827
	xor	eax, eax
; Line 828
	ret	0
_CMS_uncompress ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_decrypt_set1_password
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_pass$ = 12						; size = 4
_passlen$ = 16						; size = 4
_CMS_decrypt_set1_password PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 704
	push	ebx
	push	ebp
	push	esi
; Line 708
	mov	esi, DWORD PTR _cms$[esp+8]
	push	edi
	push	esi
	call	_CMS_get0_RecipientInfos
	mov	ebp, eax
; Line 709
	xor	edi, edi
	push	ebp
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN13@CMS_decryp
	npad	1
$LL4@CMS_decryp:
; Line 710
	push	edi
	push	ebp
	call	_sk_value
	mov	ebx, eax
; Line 711
	push	ebx
	call	_CMS_RecipientInfo_type
	add	esp, 12					; 0000000cH
	cmp	eax, 3
	jne	SHORT $LN2@CMS_decryp
; Line 713
	push	DWORD PTR _passlen$[esp+12]
	push	DWORD PTR _pass$[esp+16]
	push	ebx
	call	_CMS_RecipientInfo_set0_password
; Line 714
	push	ebx
	push	esi
	call	_CMS_RecipientInfo_decrypt
; Line 715
	push	0
	push	0
	push	ebx
	mov	esi, eax
	call	_CMS_RecipientInfo_set0_password
	add	esp, 32					; 00000020H
; Line 716
	test	esi, esi
	jg	SHORT $LN9@CMS_decryp
	mov	esi, DWORD PTR _cms$[esp+12]
$LN2@CMS_decryp:
; Line 709
	push	ebp
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL4@CMS_decryp
$LN13@CMS_decryp:
; Line 720
	push	720					; 000002d0H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	132					; 00000084H
	push	166					; 000000a6H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 721
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 723
	ret	0
$LN9@CMS_decryp:
	pop	edi
	pop	esi
	pop	ebp
; Line 717
	mov	eax, 1
	pop	ebx
; Line 723
	ret	0
_CMS_decrypt_set1_password ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_decrypt_set1_key
_TEXT	SEGMENT
_ris$1$ = -4						; size = 4
_cms$ = 8						; size = 4
_key$ = 12						; size = 4
_keylen$ = 16						; size = 4
_id$ = 20						; size = 4
_idlen$ = 24						; size = 4
_CMS_decrypt_set1_key PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 669
	mov	eax, 4
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
	push	edi
; Line 673
	push	DWORD PTR _cms$[esp+16]
	call	_CMS_get0_RecipientInfos
	mov	esi, eax
; Line 674
	xor	ebx, ebx
	push	esi
	mov	DWORD PTR _ris$1$[esp+28], esi
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jle	SHORT $LN17@CMS_decryp
	mov	ebp, DWORD PTR _id$[esp+16]
$LL4@CMS_decryp:
; Line 675
	push	ebx
	push	esi
	call	_sk_value
	mov	edi, eax
; Line 676
	push	edi
	call	_CMS_RecipientInfo_type
	add	esp, 12					; 0000000cH
	cmp	eax, 2
	jne	SHORT $LN2@CMS_decryp
; Line 683
	test	ebp, ebp
	je	SHORT $LN7@CMS_decryp
	push	DWORD PTR _idlen$[esp+16]
	push	ebp
	push	edi
	call	_CMS_RecipientInfo_kekri_id_cmp
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN2@CMS_decryp
$LN7@CMS_decryp:
; Line 684
	push	DWORD PTR _keylen$[esp+16]
	push	DWORD PTR _key$[esp+20]
	push	edi
	call	_CMS_RecipientInfo_set0_key
; Line 685
	push	edi
	push	DWORD PTR _cms$[esp+32]
	call	_CMS_RecipientInfo_decrypt
; Line 686
	push	0
	push	0
	push	edi
	mov	esi, eax
	call	_CMS_RecipientInfo_set0_key
	add	esp, 32					; 00000020H
; Line 687
	test	esi, esi
	jg	SHORT $LN12@CMS_decryp
; Line 689
	test	ebp, ebp
	jne	SHORT $LN13@CMS_decryp
; Line 693
	call	_ERR_clear_error
	mov	esi, DWORD PTR _ris$1$[esp+20]
$LN2@CMS_decryp:
; Line 674
	push	esi
	inc	ebx
	call	_sk_num
	add	esp, 4
	cmp	ebx, eax
	jl	SHORT $LL4@CMS_decryp
$LN17@CMS_decryp:
; Line 697
	push	697					; 000002b9H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	132					; 00000084H
	push	113					; 00000071H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 698
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 700
	pop	ecx
	ret	0
$LN13@CMS_decryp:
; Line 690
	push	690					; 000002b2H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	112					; 00000070H
; Line 697
	push	113					; 00000071H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 698
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 700
	pop	ecx
	ret	0
$LN12@CMS_decryp:
	pop	edi
	pop	esi
	pop	ebp
; Line 688
	mov	eax, 1
	pop	ebx
; Line 700
	pop	ecx
	ret	0
_CMS_decrypt_set1_key ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_decrypt_set1_pkey
_TEXT	SEGMENT
_debug$1$ = -16						; size = 4
_match_ri$1$ = -12					; size = 4
_ri_type$1$ = -8					; size = 4
_ris$1$ = -4						; size = 4
_cms$ = 8						; size = 4
_pk$ = 12						; size = 4
_cert$ = 16						; size = 4
_CMS_decrypt_set1_pkey PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 597
	mov	eax, 16					; 00000010H
	call	__chkstk
	push	ebx
	push	ebp
; Line 602
	mov	ebp, DWORD PTR _cms$[esp+20]
	xor	eax, eax
	push	esi
	xor	ebx, ebx
	mov	DWORD PTR _match_ri$1$[esp+28], eax
	push	ebp
	mov	DWORD PTR _debug$1$[esp+32], ebx
	call	_CMS_get0_RecipientInfos
	mov	esi, eax
	add	esp, 4
	mov	DWORD PTR _ris$1$[esp+28], esi
; Line 603
	test	esi, esi
	je	SHORT $LN5@CMS_decryp
; Line 604
	mov	ecx, DWORD PTR [ebp+4]
	mov	ecx, DWORD PTR [ecx+12]
	mov	ebx, DWORD PTR [ecx+24]
	mov	DWORD PTR _debug$1$[esp+28], ebx
$LN5@CMS_decryp:
; Line 605
	push	DWORD PTR _pk$[esp+24]
	call	_cms_pkey_get_ri_type
	add	esp, 4
	mov	DWORD PTR _ri_type$1$[esp+28], eax
; Line 606
	cmp	eax, -1
	jne	SHORT $LN6@CMS_decryp
; Line 607
	push	608					; 00000260H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	125					; 0000007dH
	push	114					; 00000072H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 609
	xor	eax, eax
	pop	esi
	pop	ebp
	pop	ebx
; Line 664
	add	esp, 16					; 00000010H
	ret	0
$LN6@CMS_decryp:
	push	edi
; Line 612
	push	esi
	xor	ebp, ebp
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	$LN19@CMS_decryp
	mov	edi, DWORD PTR _cert$[esp+28]
	npad	5
$LL4@CMS_decryp:
; Line 613
	push	ebp
	push	esi
	call	_sk_value
	mov	esi, eax
; Line 614
	push	esi
	call	_CMS_RecipientInfo_type
	mov	ecx, DWORD PTR _ri_type$1$[esp+44]
	add	esp, 12					; 0000000cH
	cmp	eax, ecx
	jne	SHORT $LN2@CMS_decryp
; Line 616
	mov	DWORD PTR _match_ri$1$[esp+32], 1
; Line 617
	cmp	ecx, 1
	jne	SHORT $LN8@CMS_decryp
; Line 618
	push	edi
	push	DWORD PTR _pk$[esp+32]
	push	esi
	push	DWORD PTR _cms$[esp+40]
	call	_cms_kari_set1_pkey
	add	esp, 16					; 00000010H
; Line 619
	test	eax, eax
	jg	SHORT $LN33@CMS_decryp
; Line 621
	js	$LN23@CMS_decryp
; Line 623
	jmp	SHORT $LN2@CMS_decryp
$LN8@CMS_decryp:
; Line 628
	test	edi, edi
	je	SHORT $LN13@CMS_decryp
	push	edi
	push	esi
	call	_CMS_RecipientInfo_ktri_cert_cmp
	add	esp, 8
	test	eax, eax
	jne	SHORT $LN2@CMS_decryp
$LN13@CMS_decryp:
; Line 629
	push	DWORD PTR _pk$[esp+28]
	push	esi
	call	_CMS_RecipientInfo_set0_pkey
; Line 630
	push	esi
	push	DWORD PTR _cms$[esp+40]
	call	_CMS_RecipientInfo_decrypt
; Line 631
	push	0
	push	esi
	mov	ebx, eax
	call	_CMS_RecipientInfo_set0_pkey
	add	esp, 24					; 00000018H
; Line 632
	test	edi, edi
	jne	SHORT $LN24@CMS_decryp
; Line 651
	test	ebx, ebx
	mov	ebx, DWORD PTR _debug$1$[esp+32]
	jle	SHORT $LN2@CMS_decryp
	test	ebx, ebx
	jne	SHORT $LN33@CMS_decryp
$LN2@CMS_decryp:
; Line 612
	mov	esi, DWORD PTR _ris$1$[esp+32]
	inc	ebp
	push	esi
	call	_sk_num
	add	esp, 4
	cmp	ebp, eax
	jl	$LL4@CMS_decryp
; Line 656
	mov	eax, DWORD PTR _match_ri$1$[esp+32]
	test	eax, eax
	je	SHORT $LN19@CMS_decryp
	test	edi, edi
	jne	SHORT $LN19@CMS_decryp
	test	ebx, ebx
	jne	SHORT $LN19@CMS_decryp
$LN34@CMS_decryp:
; Line 657
	call	_ERR_clear_error
$LN33@CMS_decryp:
	pop	edi
	pop	esi
	pop	ebp
; Line 658
	mov	eax, 1
	pop	ebx
; Line 664
	add	esp, 16					; 00000010H
	ret	0
$LN24@CMS_decryp:
; Line 637
	cmp	DWORD PTR _debug$1$[esp+32], 0
	je	SHORT $LN34@CMS_decryp
; Line 641
	test	ebx, ebx
	jg	SHORT $LN33@CMS_decryp
; Line 643
	push	643					; 00000283H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	112					; 00000070H
; Line 644
	jmp	SHORT $LN32@CMS_decryp
$LN19@CMS_decryp:
; Line 661
	push	661					; 00000295H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	132					; 00000084H
$LN32@CMS_decryp:
	push	114					; 00000072H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN23@CMS_decryp:
; Line 662
	pop	edi
	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
; Line 664
	add	esp, 16					; 00000010H
	ret	0
_CMS_decrypt_set1_pkey ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_decrypt
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_pk$ = 12						; size = 4
_cert$ = 16						; size = 4
_dcont$ = 20						; size = 4
_out$ = 24						; size = 4
_flags$ = 28						; size = 4
_CMS_decrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 727
	push	esi
; Line 730
	mov	esi, DWORD PTR _cms$[esp]
	push	esi
	call	_CMS_get0_type
	push	eax
	call	_OBJ_obj2nid
	add	esp, 8
	cmp	eax, 23					; 00000017H
	je	SHORT $LN2@CMS_decryp
; Line 731
	push	731					; 000002dbH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	146					; 00000092H
	push	112					; 00000070H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 732
	xor	eax, eax
	pop	esi
; Line 750
	ret	0
$LN2@CMS_decryp:
	push	edi
; Line 734
	mov	edi, DWORD PTR _dcont$[esp+4]
	test	edi, edi
	jne	SHORT $LN3@CMS_decryp
; Line 118
	push	esi
	call	_CMS_get0_content
	add	esp, 4
; Line 119
	test	eax, eax
	je	SHORT $LN12@CMS_decryp
	cmp	DWORD PTR [eax], edi
	jne	SHORT $LN3@CMS_decryp
$LN12@CMS_decryp:
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	127					; 0000007fH
	push	99					; 00000063H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN18@CMS_decryp:
	pop	edi
; Line 735
	xor	eax, eax
	pop	esi
; Line 750
	ret	0
$LN3@CMS_decryp:
; Line 736
	test	DWORD PTR _flags$[esp+4], 131072	; 00020000H
; Line 737
	mov	eax, DWORD PTR [esi+4]
	mov	eax, DWORD PTR [eax+12]
	je	SHORT $LN4@CMS_decryp
	mov	DWORD PTR [eax+24], 1
	jmp	SHORT $LN5@CMS_decryp
$LN4@CMS_decryp:
; Line 739
	mov	DWORD PTR [eax+24], 0
$LN5@CMS_decryp:
; Line 740
	mov	eax, DWORD PTR _pk$[esp+4]
	test	eax, eax
	jne	SHORT $LN14@CMS_decryp
	cmp	DWORD PTR _cert$[esp+4], eax
	jne	SHORT $LN7@CMS_decryp
	test	edi, edi
	jne	SHORT $LN7@CMS_decryp
	cmp	DWORD PTR _out$[esp+4], edi
	jne	SHORT $LN7@CMS_decryp
; Line 741
	lea	eax, DWORD PTR [edi+1]
	pop	edi
	pop	esi
; Line 750
	ret	0
$LN14@CMS_decryp:
; Line 742
	push	DWORD PTR _cert$[esp+4]
	push	eax
	push	esi
	call	_CMS_decrypt_set1_pkey
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN18@CMS_decryp
$LN7@CMS_decryp:
	push	ebx
; Line 744
	push	edi
	push	esi
	call	_CMS_dataInit
	mov	ebx, eax
	add	esp, 8
; Line 745
	test	ebx, ebx
	jne	SHORT $LN8@CMS_decryp
	pop	ebx
	pop	edi
	pop	esi
; Line 750
	ret	0
$LN8@CMS_decryp:
; Line 747
	push	DWORD PTR _flags$[esp+8]
	push	ebx
	push	DWORD PTR _out$[esp+16]
	call	_cms_copy_content
; Line 748
	push	edi
	push	ebx
	mov	esi, eax
	call	_do_free_upto
	add	esp, 20					; 00000014H
; Line 749
	mov	eax, esi
	pop	ebx
	pop	edi
	pop	esi
; Line 750
	ret	0
_CMS_decrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_encrypt
_TEXT	SEGMENT
_certs$ = 8						; size = 4
_data$ = 12						; size = 4
_cipher$ = 16						; size = 4
_flags$ = 20						; size = 4
_CMS_encrypt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 540
	push	ebx
	push	ebp
	push	esi
	push	edi
; Line 544
	push	DWORD PTR _cipher$[esp+12]
	call	_CMS_EnvelopedData_create
	mov	edi, eax
	add	esp, 4
; Line 545
	test	edi, edi
	jne	SHORT $LN5@CMS_encryp
$merr$31:
; Line 565
	push	565					; 00000235H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	65					; 00000041H
	push	119					; 00000077H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 569
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 570
	ret	0
$LN5@CMS_encryp:
; Line 547
	mov	ebx, DWORD PTR _certs$[esp+12]
	xor	esi, esi
	push	ebx
	call	_sk_num
	mov	ebp, DWORD PTR _flags$[esp+16]
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@CMS_encryp
	npad	4
$LL4@CMS_encryp:
; Line 548
	push	esi
	push	ebx
	call	_sk_value
; Line 549
	push	ebp
	push	eax
	push	edi
	call	_CMS_add1_recipient_cert
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN26@CMS_encryp
; Line 547
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@CMS_encryp
$LN3@CMS_encryp:
; Line 555
	mov	ebx, DWORD PTR _flags$[esp+12]
	test	bl, 64					; 00000040H
	jne	SHORT $LN7@CMS_encryp
; Line 556
	push	0
	push	edi
	call	_CMS_set_detached
	add	esp, 8
$LN7@CMS_encryp:
; Line 559
	test	ebx, 20480				; 00005000H
	jne	$LN10@CMS_encryp
; Line 755
	xor	ebp, ebp
; Line 756
	push	ebp
	push	edi
	call	_CMS_dataInit
	mov	esi, eax
	add	esp, 8
	test	esi, esi
	jne	SHORT $LN14@CMS_encryp
; Line 757
	push	757					; 000002f5H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	104					; 00000068H
	push	127					; 0000007fH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 568
	push	edi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 569
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 570
	ret	0
$LN26@CMS_encryp:
; Line 550
	push	550					; 00000226H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	137					; 00000089H
	push	119					; 00000077H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 568
	push	edi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 569
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 570
	ret	0
$LN14@CMS_encryp:
; Line 761
	push	ebx
	push	esi
	push	DWORD PTR _data$[esp+20]
	call	_SMIME_crlf_copy
; Line 763
	push	0
	push	0
	push	11					; 0000000bH
	push	esi
	call	_BIO_ctrl
; Line 765
	push	esi
	push	edi
	call	_CMS_dataFinal
	add	esp, 36					; 00000024H
	test	eax, eax
	jne	SHORT $LN15@CMS_encryp
; Line 766
	push	766					; 000002feH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	103					; 00000067H
	push	127					; 0000007fH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 767
	jmp	SHORT $err$32
$LN15@CMS_encryp:
; Line 770
	mov	ebp, 1
$err$32:
; Line 137
	push	esi
	call	_BIO_free_all
	add	esp, 4
; Line 559
	test	ebp, ebp
	jne	SHORT $LN10@CMS_encryp
$err$33:
; Line 568
	push	edi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 569
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 570
	ret	0
$LN10@CMS_encryp:
; Line 560
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 570
	ret	0
_CMS_encrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_verify_receipt
_TEXT	SEGMENT
_rcms$ = 8						; size = 4
_ocms$ = 12						; size = 4
_certs$ = 16						; size = 4
_store$ = 20						; size = 4
_flags$ = 24						; size = 4
_CMS_verify_receipt PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 422
	mov	eax, DWORD PTR _flags$[esp-4]
	and	eax, -66				; ffffffbeH
; Line 423
	push	eax
	push	0
	push	0
	push	DWORD PTR _store$[esp+8]
	push	DWORD PTR _certs$[esp+12]
	push	DWORD PTR _rcms$[esp+16]
	call	_CMS_verify
	add	esp, 24					; 00000018H
; Line 424
	test	eax, eax
	jle	SHORT $LN1@CMS_verify
; Line 426
	push	DWORD PTR _ocms$[esp-4]
	push	DWORD PTR _rcms$[esp]
	call	_cms_Receipt_verify
	add	esp, 8
$LN1@CMS_verify:
; Line 427
	ret	0
_CMS_verify_receipt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_verify
_TEXT	SEGMENT
_cms_certs$1$ = -20					; size = 4
_crls$1$ = -16						; size = 4
_ret$1$ = -12						; size = 4
_signer$ = -8						; size = 4
_ptr$1 = -4						; size = 4
_cms$ = 8						; size = 4
_certs$ = 12						; size = 4
_store$ = 16						; size = 4
_tmpin$1$ = 20						; size = 4
_dcont$ = 20						; size = 4
_out$ = 24						; size = 4
_flags$ = 28						; size = 4
_CMS_verify PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 301
	mov	eax, 20					; 00000014H
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
; Line 310
	mov	esi, DWORD PTR _cms$[esp+28]
	xor	ebp, ebp
	push	edi
	xor	ebx, ebx
	mov	DWORD PTR _cms_certs$1$[esp+36], 0
	xor	edi, edi
	mov	DWORD PTR _crls$1$[esp+36], 0
	mov	DWORD PTR _ret$1$[esp+36], ebp
	cmp	DWORD PTR _dcont$[esp+32], ebx
	jne	SHORT $LN14@CMS_verify
; Line 118
	push	esi
	call	_CMS_get0_content
	add	esp, 4
; Line 119
	test	eax, eax
	je	SHORT $LN39@CMS_verify
	cmp	DWORD PTR [eax], ebx
	jne	SHORT $LN14@CMS_verify
$LN39@CMS_verify:
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	127					; 0000007fH
	push	99					; 00000063H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 311
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 415
	add	esp, 20					; 00000014H
	ret	0
$LN14@CMS_verify:
; Line 315
	push	esi
	call	_CMS_get0_SignerInfos
	mov	esi, eax
; Line 317
	push	esi
	call	_sk_num
	add	esp, 8
	test	eax, eax
	jg	SHORT $LN15@CMS_verify
; Line 318
	push	318					; 0000013eH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	135					; 00000087H
	push	157					; 0000009dH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 319
	jmp	$LN77@CMS_verify
$LN15@CMS_verify:
; Line 322
	push	esi
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@CMS_verify
	npad	7
$LL4@CMS_verify:
; Line 323
	push	edi
	push	esi
	call	_sk_value
; Line 324
	push	0
	push	0
	lea	ecx, DWORD PTR _signer$[esp+52]
	push	ecx
	push	0
	push	eax
	call	_CMS_SignerInfo_get0_algs
	add	esp, 28					; 0000001cH
; Line 325
	cmp	DWORD PTR _signer$[esp+36], ebx
	je	SHORT $LN2@CMS_verify
; Line 326
	inc	ebp
$LN2@CMS_verify:
; Line 322
	push	esi
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL4@CMS_verify
$LN3@CMS_verify:
; Line 329
	push	esi
	call	_sk_num
; Line 330
	mov	edi, DWORD PTR _cms$[esp+36]
	add	esp, 4
	cmp	ebp, eax
	je	SHORT $LN17@CMS_verify
	push	DWORD PTR _flags$[esp+32]
	push	DWORD PTR _certs$[esp+36]
	push	edi
	call	_CMS_set1_signers_certs
	add	esp, 12					; 0000000cH
	add	ebp, eax
$LN17@CMS_verify:
; Line 332
	push	esi
	call	_sk_num
	add	esp, 4
	cmp	ebp, eax
	je	SHORT $LN18@CMS_verify
; Line 333
	push	333					; 0000014dH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	138					; 0000008aH
	push	157					; 0000009dH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN74@CMS_verify:
	xor	edi, edi
$LN77@CMS_verify:
	mov	ebp, DWORD PTR _dcont$[esp+32]
$err$79:
; Line 403
	test	ebp, ebp
	je	$LN32@CMS_verify
	cmp	edi, ebp
	jne	$LN32@CMS_verify
$LL44@CMS_verify:
; Line 131
	push	ebx
	call	_BIO_pop
; Line 132
	push	ebx
	mov	esi, eax
	call	_BIO_free
	add	esp, 8
; Line 133
	mov	ebx, esi
; Line 135
	test	esi, esi
	je	$err2$80
	cmp	esi, ebp
	jne	SHORT $LL44@CMS_verify
; Line 404
	jmp	$err2$80
$LN18@CMS_verify:
; Line 339
	mov	eax, DWORD PTR _flags$[esp+32]
	test	al, 32					; 00000020H
	jne	SHORT $LN6@CMS_verify
; Line 340
	push	edi
	call	_CMS_get1_certs
	add	esp, 4
	mov	DWORD PTR _cms_certs$1$[esp+36], eax
; Line 341
	test	DWORD PTR _flags$[esp+32], 8192		; 00002000H
	jne	SHORT $LN20@CMS_verify
; Line 342
	push	edi
	call	_CMS_get1_crls
	add	esp, 4
	mov	DWORD PTR _crls$1$[esp+36], eax
$LN20@CMS_verify:
; Line 343
	push	esi
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN72@CMS_verify
	mov	ebp, DWORD PTR _store$[esp+32]
$LL7@CMS_verify:
; Line 344
	push	edi
	push	esi
	call	_sk_value
; Line 345
	push	DWORD PTR _flags$[esp+40]
	push	DWORD PTR _crls$1$[esp+48]
	push	DWORD PTR _cms_certs$1$[esp+52]
	push	ebp
	push	eax
	call	_cms_signerinfo_verify_cert
	add	esp, 28					; 0000001cH
	test	eax, eax
	je	$LN74@CMS_verify
; Line 343
	push	esi
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL7@CMS_verify
$LN72@CMS_verify:
	mov	eax, DWORD PTR _flags$[esp+32]
$LN6@CMS_verify:
; Line 353
	test	al, 8
	jne	SHORT $LN9@CMS_verify
; Line 354
	push	esi
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN9@CMS_verify
$LL10@CMS_verify:
; Line 355
	push	edi
	push	esi
	call	_sk_value
	mov	ebp, eax
; Line 356
	push	ebp
	call	_CMS_signed_get_attr_count
	add	esp, 12					; 0000000cH
	test	eax, eax
	js	SHORT $LN8@CMS_verify
; Line 358
	push	ebp
	call	_CMS_SignerInfo_verify
	add	esp, 4
	test	eax, eax
	jle	$LN74@CMS_verify
$LN8@CMS_verify:
; Line 354
	push	esi
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL10@CMS_verify
$LN9@CMS_verify:
; Line 370
	mov	ebp, DWORD PTR _dcont$[esp+32]
	test	ebp, ebp
	je	SHORT $LN25@CMS_verify
	push	ebp
	call	_BIO_method_type
	add	esp, 4
	cmp	eax, 1025				; 00000401H
	jne	SHORT $LN25@CMS_verify
; Line 373
	lea	eax, DWORD PTR _ptr$1[esp+36]
	push	eax
	push	0
	push	3
	push	ebp
	call	_BIO_ctrl
; Line 374
	push	eax
	push	DWORD PTR _ptr$1[esp+56]
	call	_BIO_new_mem_buf
	mov	edi, eax
	add	esp, 24					; 00000018H
	mov	DWORD PTR _tmpin$1$[esp+32], edi
; Line 375
	test	edi, edi
	jne	SHORT $LN26@CMS_verify
; Line 376
	push	376					; 00000178H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	65					; 00000041H
	push	157					; 0000009dH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 377
	jmp	$err2$80
$LN25@CMS_verify:
; Line 380
	mov	edi, ebp
	mov	DWORD PTR _tmpin$1$[esp+32], ebp
$LN26@CMS_verify:
; Line 382
	push	edi
	push	DWORD PTR _cms$[esp+36]
	call	_CMS_dataInit
	mov	ebx, eax
	add	esp, 8
; Line 383
	test	ebx, ebx
	je	$err$79
; Line 386
	push	DWORD PTR _flags$[esp+32]
	push	ebx
	push	DWORD PTR _out$[esp+40]
	call	_cms_copy_content
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	$err$79
; Line 389
	test	BYTE PTR _flags$[esp+32], 4
	jne	SHORT $LN12@CMS_verify
; Line 390
	push	esi
	xor	edi, edi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN76@CMS_verify
$LL13@CMS_verify:
; Line 391
	push	edi
	push	esi
	call	_sk_value
; Line 392
	push	ebx
	push	eax
	call	_CMS_SignerInfo_verify_content
	add	esp, 16					; 00000010H
	test	eax, eax
	jle	SHORT $LN56@CMS_verify
; Line 390
	push	esi
	inc	edi
	call	_sk_num
	add	esp, 4
	cmp	edi, eax
	jl	SHORT $LL13@CMS_verify
$LN76@CMS_verify:
	mov	edi, DWORD PTR _tmpin$1$[esp+32]
$LN12@CMS_verify:
; Line 399
	mov	DWORD PTR _ret$1$[esp+36], 1
	jmp	$err$79
$LN56@CMS_verify:
; Line 393
	push	393					; 00000189H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	109					; 0000006dH
	push	157					; 0000009dH
	push	46					; 0000002eH
	call	_ERR_put_error
; Line 394
	mov	edi, DWORD PTR _tmpin$1$[esp+52]
	add	esp, 20					; 00000014H
	jmp	$err$79
$LN32@CMS_verify:
; Line 406
	push	ebx
	call	_BIO_free_all
	add	esp, 4
$err2$80:
; Line 409
	mov	eax, DWORD PTR _cms_certs$1$[esp+36]
	test	eax, eax
	je	SHORT $LN34@CMS_verify
; Line 410
	push	OFFSET _X509_free
	push	eax
	call	_sk_pop_free
	add	esp, 8
$LN34@CMS_verify:
; Line 411
	mov	eax, DWORD PTR _crls$1$[esp+36]
	test	eax, eax
	je	SHORT $LN35@CMS_verify
; Line 412
	push	OFFSET _X509_CRL_free
	push	eax
	call	_sk_pop_free
	add	esp, 8
$LN35@CMS_verify:
; Line 414
	mov	eax, DWORD PTR _ret$1$[esp+36]
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 415
	add	esp, 20					; 00000014H
	ret	0
_CMS_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_EncryptedData_encrypt
_TEXT	SEGMENT
_in$ = 8						; size = 4
_cipher$ = 12						; size = 4
_key$ = 16						; size = 4
_keylen$ = 20						; size = 4
_flags$ = 24						; size = 4
_CMS_EncryptedData_encrypt PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 244
	cmp	DWORD PTR _cipher$[esp-4], 0
	jne	SHORT $LN2@CMS_Encryp
; Line 245
	push	245					; 000000f5H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	126					; 0000007eH
	push	122					; 0000007aH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 246
	xor	eax, eax
; Line 263
	ret	0
$LN2@CMS_Encryp:
	push	esi
; Line 248
	call	_CMS_ContentInfo_new
	mov	esi, eax
; Line 249
	test	esi, esi
	je	SHORT $LN11@CMS_Encryp
; Line 251
	push	DWORD PTR _keylen$[esp]
	push	DWORD PTR _key$[esp+4]
	push	DWORD PTR _cipher$[esp+8]
	push	esi
	call	_CMS_EncryptedData_set1_key
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN4@CMS_Encryp
$LN11@CMS_Encryp:
; Line 252
	xor	eax, eax
	pop	esi
; Line 263
	ret	0
$LN4@CMS_Encryp:
	push	ebx
; Line 254
	mov	ebx, DWORD PTR _flags$[esp+4]
	test	bl, 64					; 00000040H
	jne	SHORT $LN5@CMS_Encryp
; Line 255
	push	0
	push	esi
	call	_CMS_set_detached
	add	esp, 8
$LN5@CMS_Encryp:
; Line 258
	test	ebx, 20480				; 00005000H
	jne	SHORT $LN7@CMS_Encryp
	push	ebx
	push	0
	push	DWORD PTR _in$[esp+12]
	push	esi
	call	_CMS_final
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN7@CMS_Encryp
; Line 261
	push	esi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 262
	xor	eax, eax
	pop	ebx
	pop	esi
; Line 263
	ret	0
$LN7@CMS_Encryp:
	pop	ebx
; Line 259
	mov	eax, esi
	pop	esi
; Line 263
	ret	0
_CMS_EncryptedData_encrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_EncryptedData_decrypt
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_key$ = 12						; size = 4
_keylen$ = 16						; size = 4
_dcont$ = 20						; size = 4
_out$ = 24						; size = 4
_flags$ = 28						; size = 4
_CMS_EncryptedData_decrypt PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 217
	push	esi
; Line 220
	mov	esi, DWORD PTR _cms$[esp]
	push	esi
	call	_CMS_get0_type
	push	eax
	call	_OBJ_obj2nid
	add	esp, 8
	cmp	eax, 26					; 0000001aH
	je	SHORT $LN2@CMS_Encryp
; Line 221
	push	222					; 000000deH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	145					; 00000091H
	push	121					; 00000079H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 223
	xor	eax, eax
	pop	esi
; Line 237
	ret	0
$LN2@CMS_Encryp:
	push	edi
; Line 226
	mov	edi, DWORD PTR _dcont$[esp+4]
	test	edi, edi
	jne	SHORT $LN3@CMS_Encryp
; Line 118
	push	esi
	call	_CMS_get0_content
	add	esp, 4
; Line 119
	test	eax, eax
	je	SHORT $LN9@CMS_Encryp
	cmp	DWORD PTR [eax], edi
	jne	SHORT $LN3@CMS_Encryp
$LN9@CMS_Encryp:
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	127					; 0000007fH
	push	99					; 00000063H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN14@CMS_Encryp:
	pop	edi
; Line 227
	xor	eax, eax
	pop	esi
; Line 237
	ret	0
$LN3@CMS_Encryp:
; Line 229
	push	DWORD PTR _keylen$[esp+4]
	push	DWORD PTR _key$[esp+8]
	push	0
	push	esi
	call	_CMS_EncryptedData_set1_key
	add	esp, 16					; 00000010H
	test	eax, eax
	jle	SHORT $LN14@CMS_Encryp
; Line 231
	push	ebx
	push	edi
	push	esi
	call	_CMS_dataInit
	mov	ebx, eax
	add	esp, 8
; Line 232
	test	ebx, ebx
	jne	SHORT $LN5@CMS_Encryp
	pop	ebx
	pop	edi
	pop	esi
; Line 237
	ret	0
$LN5@CMS_Encryp:
; Line 234
	push	DWORD PTR _flags$[esp+8]
	push	ebx
	push	DWORD PTR _out$[esp+16]
	call	_cms_copy_content
; Line 235
	push	edi
	push	ebx
	mov	esi, eax
	call	_do_free_upto
	add	esp, 20					; 00000014H
; Line 236
	mov	eax, esi
	pop	ebx
	pop	edi
	pop	esi
; Line 237
	ret	0
_CMS_EncryptedData_decrypt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_digest_create
_TEXT	SEGMENT
_in$ = 8						; size = 4
_md$ = 12						; size = 4
_flags$ = 16						; size = 4
_CMS_digest_create PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 198
	mov	eax, DWORD PTR _md$[esp-4]
	test	eax, eax
	jne	SHORT $LN2@CMS_digest
; Line 199
	call	_EVP_sha1
$LN2@CMS_digest:
	push	esi
; Line 200
	push	eax
	call	_cms_DigestedData_create
	mov	esi, eax
	add	esp, 4
; Line 201
	test	esi, esi
	jne	SHORT $LN3@CMS_digest
	pop	esi
; Line 212
	ret	0
$LN3@CMS_digest:
	push	ebx
; Line 204
	mov	ebx, DWORD PTR _flags$[esp+4]
	test	bl, 64					; 00000040H
	jne	SHORT $LN4@CMS_digest
; Line 205
	push	0
	push	esi
	call	_CMS_set_detached
	add	esp, 8
$LN4@CMS_digest:
; Line 207
	test	ebx, 4096				; 00001000H
	jne	SHORT $LN6@CMS_digest
	push	ebx
	push	0
	push	DWORD PTR _in$[esp+12]
	push	esi
	call	_CMS_final
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN6@CMS_digest
; Line 210
	push	esi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 211
	xor	eax, eax
	pop	ebx
	pop	esi
; Line 212
	ret	0
$LN6@CMS_digest:
	pop	ebx
; Line 208
	mov	eax, esi
	pop	esi
; Line 212
	ret	0
_CMS_digest_create ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_digest_verify
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_dcont$ = 12						; size = 4
_out$ = 16						; size = 4
_flags$ = 20						; size = 4
_CMS_digest_verify PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 173
	push	esi
; Line 176
	mov	esi, DWORD PTR _cms$[esp]
	push	esi
	call	_CMS_get0_type
	push	eax
	call	_OBJ_obj2nid
	add	esp, 8
	cmp	eax, 25					; 00000019H
	je	SHORT $LN2@CMS_digest
; Line 177
	push	177					; 000000b1H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	144					; 00000090H
	push	118					; 00000076H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 178
	xor	eax, eax
	pop	esi
; Line 192
	ret	0
$LN2@CMS_digest:
	push	ebx
; Line 181
	mov	ebx, DWORD PTR _dcont$[esp+4]
	test	ebx, ebx
	jne	SHORT $LN3@CMS_digest
; Line 118
	push	esi
	call	_CMS_get0_content
	add	esp, 4
; Line 119
	test	eax, eax
	je	SHORT $LN9@CMS_digest
	cmp	DWORD PTR [eax], ebx
	jne	SHORT $LN3@CMS_digest
$LN9@CMS_digest:
; Line 120
	push	120					; 00000078H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	127					; 0000007fH
	push	99					; 00000063H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 182
	xor	eax, eax
	pop	ebx
	pop	esi
; Line 192
	ret	0
$LN3@CMS_digest:
	push	edi
; Line 184
	push	ebx
	push	esi
	call	_CMS_dataInit
	mov	edi, eax
	add	esp, 8
; Line 185
	test	edi, edi
	jne	SHORT $LN4@CMS_digest
	pop	edi
	pop	ebx
	pop	esi
; Line 192
	ret	0
$LN4@CMS_digest:
	push	ebp
; Line 187
	push	DWORD PTR _flags$[esp+12]
	push	edi
	push	DWORD PTR _out$[esp+20]
	call	_cms_copy_content
	mov	ebp, eax
	add	esp, 12					; 0000000cH
; Line 188
	test	ebp, ebp
	je	SHORT $LN5@CMS_digest
; Line 189
	push	1
	push	edi
	push	esi
	call	_cms_DigestedData_do_final
	add	esp, 12					; 0000000cH
	mov	ebp, eax
$LN5@CMS_digest:
; Line 190
	push	ebx
	push	edi
	call	_do_free_upto
	add	esp, 8
; Line 191
	mov	eax, ebp
	pop	ebp
	pop	edi
	pop	ebx
	pop	esi
; Line 192
	ret	0
_CMS_digest_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_data_create
_TEXT	SEGMENT
_in$ = 8						; size = 4
_flags$ = 12						; size = 4
_CMS_data_create PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 157
	push	esi
; Line 159
	call	_cms_Data_create
	mov	esi, eax
; Line 160
	test	esi, esi
	je	SHORT $LN6@CMS_data_c
; Line 163
	mov	eax, DWORD PTR _flags$[esp]
	test	eax, 4096				; 00001000H
	jne	SHORT $LN4@CMS_data_c
	push	eax
	push	0
	push	DWORD PTR _in$[esp+8]
	push	esi
	call	_CMS_final
	add	esp, 16					; 00000010H
	test	eax, eax
	jne	SHORT $LN4@CMS_data_c
; Line 166
	push	esi
	call	_CMS_ContentInfo_free
	add	esp, 4
$LN6@CMS_data_c:
; Line 168
	xor	eax, eax
	pop	esi
; Line 169
	ret	0
$LN4@CMS_data_c:
; Line 164
	mov	eax, esi
	pop	esi
; Line 169
	ret	0
_CMS_data_create ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_data
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_out$ = 12						; size = 4
_flags$ = 16						; size = 4
_CMS_data PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 141
	push	esi
; Line 144
	mov	esi, DWORD PTR _cms$[esp]
	push	esi
	call	_CMS_get0_type
	push	eax
	call	_OBJ_obj2nid
	add	esp, 8
	cmp	eax, 21					; 00000015H
	je	SHORT $LN2@CMS_data
; Line 145
	push	145					; 00000091H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	143					; 0000008fH
	push	109					; 0000006dH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 146
	xor	eax, eax
	pop	esi
; Line 154
	ret	0
$LN2@CMS_data:
	push	edi
; Line 148
	push	0
	push	esi
	call	_CMS_dataInit
	mov	edi, eax
	add	esp, 8
; Line 149
	test	edi, edi
	jne	SHORT $LN3@CMS_data
	pop	edi
	pop	esi
; Line 154
	ret	0
$LN3@CMS_data:
; Line 151
	push	DWORD PTR _flags$[esp+4]
	push	edi
	push	DWORD PTR _out$[esp+12]
	call	_cms_copy_content
; Line 152
	push	edi
	mov	esi, eax
	call	_BIO_free_all
	add	esp, 16					; 00000010H
; Line 153
	mov	eax, esi
	pop	edi
	pop	esi
; Line 154
	ret	0
_CMS_data ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_sign_receipt
_TEXT	SEGMENT
_r$1$ = -4						; size = 4
_si$ = 8						; size = 4
_signcert$ = 12						; size = 4
_pkey$ = 16						; size = 4
_certs$ = 20						; size = 4
_rct_si$1$ = 24						; size = 4
_flags$ = 24						; size = 4
_CMS_sign_receipt PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 472
	mov	eax, 4
	call	__chkstk
	push	ebx
	push	ebp
; Line 482
	mov	ebp, DWORD PTR _pkey$[esp+8]
	push	esi
	mov	esi, DWORD PTR _flags$[esp+12]
	and	esi, -4098				; ffffeffeH
	mov	DWORD PTR _r$1$[esp+16], 0
	or	esi, 16576				; 000040c0H
	test	ebp, ebp
	je	$LN3@CMS_sign_r
	mov	ebx, DWORD PTR _signcert$[esp+12]
	test	ebx, ebx
	je	$LN3@CMS_sign_r
; Line 489
	push	edi
	push	esi
	push	0
	push	DWORD PTR _certs$[esp+24]
	push	0
	push	0
	call	_CMS_sign
	mov	edi, eax
	add	esp, 20					; 00000014H
; Line 490
	test	edi, edi
	je	SHORT $LN12@CMS_sign_r
; Line 494
	push	204					; 000000ccH
	call	_OBJ_nid2obj
	push	eax
	push	edi
	call	_CMS_set1_eContentType
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN12@CMS_sign_r
; Line 497
	push	esi
	push	0
	push	ebp
	push	ebx
	push	edi
	call	_CMS_add1_signer
	add	esp, 20					; 00000014H
	mov	DWORD PTR _rct_si$1$[esp+16], eax
; Line 498
	test	eax, eax
	jne	SHORT $LN6@CMS_sign_r
; Line 499
	push	499					; 000001f3H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	99					; 00000063H
	push	163					; 000000a3H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN12@CMS_sign_r:
; Line 533
	push	edi
	call	_CMS_ContentInfo_free
	add	esp, 4
; Line 534
	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 536
	pop	ecx
	ret	0
$LN6@CMS_sign_r:
; Line 503
	push	DWORD PTR _si$[esp+16]
	call	_cms_encode_Receipt
	mov	ebx, eax
	add	esp, 4
; Line 505
	test	ebx, ebx
	je	SHORT $LN12@CMS_sign_r
; Line 509
	push	DWORD PTR [ebx]
	push	DWORD PTR [ebx+8]
	call	_BIO_new_mem_buf
	mov	ebp, eax
	add	esp, 8
; Line 510
	test	ebp, ebp
	je	SHORT $LN12@CMS_sign_r
; Line 515
	push	DWORD PTR _si$[esp+16]
	push	DWORD PTR _rct_si$1$[esp+20]
	call	_cms_msgSigDigest_add1
	add	esp, 8
	test	eax, eax
	je	SHORT $err$16
; Line 519
	push	esi
	push	0
	push	ebp
	push	edi
	call	_CMS_final
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$16
; Line 523
	push	edi
	call	_CMS_get0_content
	add	esp, 4
; Line 526
	mov	DWORD PTR _r$1$[esp+20], 1
	mov	DWORD PTR [eax], ebx
$err$16:
; Line 530
	push	ebp
	call	_BIO_free
	add	esp, 4
; Line 531
	cmp	DWORD PTR _r$1$[esp+20], 0
	je	SHORT $LN12@CMS_sign_r
; Line 532
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 536
	pop	ecx
	ret	0
$LN3@CMS_sign_r:
; Line 483
	push	483					; 000001e3H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	174					; 000000aeH
	push	163					; 000000a3H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 484
	xor	eax, eax
	pop	esi
	pop	ebp
	pop	ebx
; Line 536
	pop	ecx
	ret	0
_CMS_sign_receipt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_sign
_TEXT	SEGMENT
_signcert$ = 8						; size = 4
_pkey$ = 12						; size = 4
_certs$ = 16						; size = 4
_data$ = 20						; size = 4
_flags$ = 24						; size = 4
_CMS_sign PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 432
	push	ebx
	push	esi
	push	edi
; Line 436
	call	_CMS_ContentInfo_new
	mov	edi, eax
; Line 437
	test	edi, edi
	je	$merr$22
	push	edi
	call	_CMS_SignedData_init
	add	esp, 4
	test	eax, eax
	je	$merr$22
; Line 440
	mov	eax, DWORD PTR _pkey$[esp+8]
	test	eax, eax
	je	SHORT $LN7@CMS_sign
	push	DWORD PTR _flags$[esp+8]
	push	0
	push	eax
	push	DWORD PTR _signcert$[esp+20]
	push	edi
	call	_CMS_add1_signer
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN7@CMS_sign
; Line 441
	push	441					; 000001b9H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	99					; 00000063H
; Line 442
	jmp	SHORT $LN20@CMS_sign
$LN7@CMS_sign:
; Line 445
	mov	ebx, DWORD PTR _certs$[esp+8]
	xor	esi, esi
	push	ebx
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN3@CMS_sign
$LL4@CMS_sign:
; Line 446
	push	esi
	push	ebx
	call	_sk_value
; Line 447
	push	eax
	push	edi
	call	_CMS_add1_cert
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $merr$22
; Line 445
	push	ebx
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@CMS_sign
$LN3@CMS_sign:
; Line 451
	mov	ebx, DWORD PTR _flags$[esp+8]
	test	bl, 64					; 00000040H
	jne	SHORT $LN9@CMS_sign
; Line 452
	push	0
	push	edi
	call	_CMS_set_detached
	add	esp, 8
$LN9@CMS_sign:
; Line 455
	test	ebx, 20480				; 00005000H
	jne	SHORT $LN12@CMS_sign
	push	ebx
	push	0
	push	DWORD PTR _data$[esp+16]
	push	edi
	call	_CMS_final
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $err$23
$LN12@CMS_sign:
; Line 456
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebx
; Line 467
	ret	0
$merr$22:
; Line 461
	push	461					; 000001cdH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	65					; 00000041H
$LN20@CMS_sign:
	push	148					; 00000094H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$23:
; Line 464
	test	edi, edi
	je	SHORT $LN13@CMS_sign
; Line 465
	push	edi
	call	_CMS_ContentInfo_free
	add	esp, 4
$LN13@CMS_sign:
; Line 466
	pop	edi
	pop	esi
	xor	eax, eax
	pop	ebx
; Line 467
	ret	0
_CMS_sign ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_final
_TEXT	SEGMENT
_cms$ = 8						; size = 4
_data$ = 12						; size = 4
_dcont$ = 16						; size = 4
_flags$ = 20						; size = 4
_CMS_final PROC						; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_smime.c
; Line 753
	push	esi
	push	edi
; Line 756
	push	DWORD PTR _dcont$[esp+4]
	xor	edi, edi
	push	DWORD PTR _cms$[esp+8]
	call	_CMS_dataInit
	mov	esi, eax
	add	esp, 8
	test	esi, esi
	jne	SHORT $LN2@CMS_final
; Line 757
	push	757					; 000002f5H
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	104					; 00000068H
	push	127					; 0000007fH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 758
	xor	eax, eax
	pop	edi
	pop	esi
; Line 777
	ret	0
$LN2@CMS_final:
; Line 761
	push	DWORD PTR _flags$[esp+4]
	push	esi
	push	DWORD PTR _data$[esp+12]
	call	_SMIME_crlf_copy
; Line 763
	push	0
	push	0
	push	11					; 0000000bH
	push	esi
	call	_BIO_ctrl
; Line 765
	push	esi
	push	DWORD PTR _cms$[esp+36]
	call	_CMS_dataFinal
	add	esp, 36					; 00000024H
	test	eax, eax
	jne	SHORT $LN3@CMS_final
; Line 766
	push	766					; 000002feH
	push	OFFSET ??_C@_0BJ@JMHGEHFH@?4?2crypto?2cms?2cms_smime?4c?$AA@
	push	103					; 00000067H
	push	127					; 0000007fH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 773
	push	DWORD PTR _dcont$[esp+4]
	push	esi
	call	_do_free_upto
	add	esp, 8
; Line 775
	mov	eax, edi
	pop	edi
	pop	esi
; Line 777
	ret	0
$LN3@CMS_final:
; Line 770
	mov	edi, 1
$err$6:
; Line 773
	push	DWORD PTR _dcont$[esp+4]
	push	esi
	call	_do_free_upto
	add	esp, 8
; Line 775
	mov	eax, edi
	pop	edi
	pop	esi
; Line 777
	ret	0
_CMS_final ENDP
_TEXT	ENDS
END
