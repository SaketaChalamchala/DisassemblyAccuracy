; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_ssl23_accept
EXTRN	_tls1_new:PROC
EXTRN	_tls1_free:PROC
EXTRN	_tls1_clear:PROC
EXTRN	_TLSv1_2_enc_data:BYTE
EXTRN	_ssl_ok:PROC
EXTRN	_ssl_undefined_function:PROC
EXTRN	_ssl_undefined_void_function:PROC
EXTRN	_ssl_undefined_const_function:PROC
EXTRN	_ssl3_get_message:PROC
EXTRN	_ssl3_dispatch_alert:PROC
EXTRN	_ssl3_read_bytes:PROC
EXTRN	_ssl3_write_bytes:PROC
EXTRN	_ssl3_ctrl:PROC
EXTRN	_ssl3_ctx_ctrl:PROC
EXTRN	_ssl3_callback_ctrl:PROC
EXTRN	_ssl3_ctx_callback_ctrl:PROC
EXTRN	_ssl23_num_ciphers:PROC
EXTRN	_ssl23_get_cipher:PROC
EXTRN	_ssl23_read:PROC
EXTRN	_ssl23_peek:PROC
EXTRN	_ssl23_write:PROC
EXTRN	_ssl23_put_cipher_by_char:PROC
EXTRN	_ssl23_get_cipher_by_char:PROC
EXTRN	_ssl23_default_timeout:PROC
CONST	SEGMENT
?SSLv23_server_method_data@?1??SSLv23_server_method@@9@9 DD 0303H ; `SSLv23_server_method'::`2'::SSLv23_server_method_data
	DD	FLAT:_tls1_new
	DD	FLAT:_tls1_clear
	DD	FLAT:_tls1_free
	DD	FLAT:_ssl23_accept
	DD	FLAT:_ssl_undefined_function
	DD	FLAT:_ssl23_read
	DD	FLAT:_ssl23_peek
	DD	FLAT:_ssl23_write
	DD	FLAT:_ssl_undefined_function
	DD	FLAT:_ssl_undefined_function
	DD	FLAT:_ssl_ok
	DD	FLAT:_ssl3_get_message
	DD	FLAT:_ssl3_read_bytes
	DD	FLAT:_ssl3_write_bytes
	DD	FLAT:_ssl3_dispatch_alert
	DD	FLAT:_ssl3_ctrl
	DD	FLAT:_ssl3_ctx_ctrl
	DD	FLAT:_ssl23_get_cipher_by_char
	DD	FLAT:_ssl23_put_cipher_by_char
	DD	FLAT:_ssl_undefined_const_function
	DD	FLAT:_ssl23_num_ciphers
	DD	FLAT:_ssl23_get_cipher
	DD	FLAT:_ssl23_get_server_method
	DD	FLAT:_ssl23_default_timeout
	DD	FLAT:_TLSv1_2_enc_data
	DD	FLAT:_ssl_undefined_void_function
	DD	FLAT:_ssl3_callback_ctrl
	DD	FLAT:_ssl3_ctx_callback_ctrl
CONST	ENDS
PUBLIC	_SSLv23_server_method
PUBLIC	_ssl23_get_client_hello
PUBLIC	??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@	; `string'
PUBLIC	??_C@_04IBPFIGHK@GET?5?$AA@			; `string'
PUBLIC	??_C@_05LPJJJLLB@POST?5?$AA@			; `string'
PUBLIC	??_C@_05PMJKDPIC@HEAD?5?$AA@			; `string'
PUBLIC	??_C@_04DCMJKHH@PUT?5?$AA@			; `string'
PUBLIC	??_C@_07FNNMGOPK@CONNECT?$AA@			; `string'
PUBLIC	??_C@_0BO@NOMIEOMK@s?9?$DOversion?5?$DM?$DN?5TLS_MAX_VERSION?$AA@ ; `string'
EXTRN	__imp___time64:PROC
EXTRN	__imp__strncmp:PROC
EXTRN	__imp__SetLastError@4:PROC
EXTRN	_BUF_MEM_new:PROC
EXTRN	_BUF_MEM_free:PROC
EXTRN	_BUF_MEM_grow:PROC
EXTRN	_OpenSSLDie:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ERR_clear_error:PROC
EXTRN	_SSL_clear:PROC
EXTRN	_SSL_accept:PROC
EXTRN	_SSLv3_server_method:PROC
EXTRN	_TLSv1_server_method:PROC
EXTRN	_TLSv1_1_server_method:PROC
EXTRN	_TLSv1_2_server_method:PROC
EXTRN	_SSL_state:PROC
EXTRN	_ssl3_init_finished_mac:PROC
EXTRN	_ssl3_finish_mac:PROC
EXTRN	_ssl3_setup_buffers:PROC
EXTRN	_ssl3_setup_read_buffer:PROC
EXTRN	_ssl23_read_bytes:PROC
EXTRN	_ssl_init_wbio_buffer:PROC
EXTRN	_RAND_add:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	_memcpy:PROC
EXTRN	___security_cookie:DWORD
EXTRN	__fltused:DWORD
;	COMDAT ??_C@_0BO@NOMIEOMK@s?9?$DOversion?5?$DM?$DN?5TLS_MAX_VERSION?$AA@
CONST	SEGMENT
??_C@_0BO@NOMIEOMK@s?9?$DOversion?5?$DM?$DN?5TLS_MAX_VERSION?$AA@ DB 's->'
	DB	'version <= TLS_MAX_VERSION', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_07FNNMGOPK@CONNECT?$AA@
CONST	SEGMENT
??_C@_07FNNMGOPK@CONNECT?$AA@ DB 'CONNECT', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04DCMJKHH@PUT?5?$AA@
CONST	SEGMENT
??_C@_04DCMJKHH@PUT?5?$AA@ DB 'PUT ', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05PMJKDPIC@HEAD?5?$AA@
CONST	SEGMENT
??_C@_05PMJKDPIC@HEAD?5?$AA@ DB 'HEAD ', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05LPJJJLLB@POST?5?$AA@
CONST	SEGMENT
??_C@_05LPJJJLLB@POST?5?$AA@ DB 'POST ', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04IBPFIGHK@GET?5?$AA@
CONST	SEGMENT
??_C@_04IBPFIGHK@GET?5?$AA@ DB 'GET ', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
CONST	SEGMENT
??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@ DB '.\ssl\s23_srvr.c', 00H ; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ssl23_get_client_hello
_TEXT	SEGMENT
_i$1$ = -40						; size = 4
_j$2$ = -40						; size = 4
_csl$1$ = -36						; size = 4
_n$1$ = -36						; size = 4
_v$2$ = -32						; size = 4
_dd$1$ = -32						; size = 4
tv875 = -32						; size = 4
_sil$1$ = -28						; size = 4
_p$3$ = -24						; size = 4
_d_len$1$ = -20						; size = 4
_buf_space$ = -16					; size = 11
__$ArrayPad$ = -4					; size = 4
_s$ = 8							; size = 4
_ssl23_get_client_hello PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
; Line 237
	mov	eax, 40					; 00000028H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+40], eax
	push	ebx
	push	ebp
	push	esi
	mov	esi, DWORD PTR _s$[esp+48]
; Line 257
	xor	eax, eax
; Line 258
	xor	ebp, ebp
	mov	DWORD PTR _n$1$[esp+52], eax
	push	edi
; Line 261
	cmp	DWORD PTR [esi+52], 8720		; 00002210H
	jne	SHORT $LN50@ssl23_get_
; Line 265
	push	esi
	call	_ssl3_setup_buffers
	add	esp, 4
	test	eax, eax
	je	$LN71@ssl23_get_
; Line 268
	push	11					; 0000000bH
	push	esi
	call	_ssl23_read_bytes
	add	esp, 8
	mov	DWORD PTR _n$1$[esp+56], eax
; Line 269
	cmp	eax, 11					; 0000000bH
	jne	$LN1@ssl23_get_
; Line 272
	mov	edi, DWORD PTR [esi+76]
; Line 274
	movq	xmm0, QWORD PTR [edi]
	movq	QWORD PTR _buf_space$[esp+56], xmm0
	mov	ax, WORD PTR [edi+8]
	mov	WORD PTR _buf_space$[esp+64], ax
	movzx	eax, BYTE PTR [edi+10]
	mov	BYTE PTR _buf_space$[esp+66], al
; Line 276
	mov	al, BYTE PTR [edi]
	test	al, al
	jns	$LN8@ssl23_get_
	cmp	BYTE PTR [edi+2], 1
	jne	$LN8@ssl23_get_
; Line 280
	mov	al, BYTE PTR [edi+3]
	test	al, al
	jne	SHORT $LN10@ssl23_get_
	cmp	BYTE PTR [edi+4], 2
	jne	SHORT $LN10@ssl23_get_
; Line 284
	test	DWORD PTR [esi+256], 16777216		; 01000000H
$LN84@ssl23_get_:
	jne	SHORT $LN50@ssl23_get_
; Line 285
	mov	ebp, 1
$LN50@ssl23_get_:
; Line 403
	cmp	DWORD PTR [esi], 771			; 00000303H
	jle	SHORT $LN85@ssl23_get_
	push	OFFSET ??_C@_0BO@NOMIEOMK@s?9?$DOversion?5?$DM?$DN?5TLS_MAX_VERSION?$AA@
	push	403					; 00000193H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	call	_OpenSSLDie
	add	esp, 12					; 0000000cH
; Line 405
	cmp	DWORD PTR [esi], 771			; 00000303H
$LN85@ssl23_get_:
	jge	SHORT $LN51@ssl23_get_
$LN79@ssl23_get_:
	mov	eax, DWORD PTR [esi+152]
	test	DWORD PTR [eax+56], 196608		; 00030000H
	je	SHORT $LN51@ssl23_get_
; Line 406
	push	407					; 00000197H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	379					; 0000017bH
; Line 408
	jmp	$LN83@ssl23_get_
$LN10@ssl23_get_:
; Line 286
	cmp	al, 3
	jne	SHORT $LN50@ssl23_get_
; Line 290
	mov	al, BYTE PTR [edi+4]
	cmp	al, 1
	jb	$LN14@ssl23_get_
; Line 291
	cmp	al, 3
	jb	SHORT $LN16@ssl23_get_
	test	DWORD PTR [esi+256], 134217728		; 08000000H
	jne	SHORT $LN16@ssl23_get_
; Line 293
	mov	DWORD PTR [esi], 771			; 00000303H
; Line 294
	mov	DWORD PTR [esi+52], 8721		; 00002211H
$LN51@ssl23_get_:
; Line 418
	cmp	DWORD PTR [esi+52], 8721		; 00002211H
	jne	$LN52@ssl23_get_
; Line 425
	mov	eax, DWORD PTR [esi+76]
	mov	ebp, 2
; Line 442
	movzx	edi, BYTE PTR [eax]
	movzx	ecx, BYTE PTR [eax+4]
	and	edi, 127				; 0000007fH
	movzx	eax, BYTE PTR [eax+1]
	shl	edi, 8
	or	edi, eax
	mov	DWORD PTR _v$2$[esp+56], ecx
; Line 443
	cmp	edi, 4096				; 00001000H
	jle	$LN53@ssl23_get_
; Line 444
	push	444					; 000001bcH
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	214					; 000000d6H
; Line 445
	jmp	$LN83@ssl23_get_
$LN16@ssl23_get_:
; Line 295
	cmp	al, 2
	jb	SHORT $LN18@ssl23_get_
	test	DWORD PTR [esi+256], 268435456		; 10000000H
	jne	SHORT $LN18@ssl23_get_
; Line 297
	mov	DWORD PTR [esi], 770			; 00000302H
; Line 303
	mov	DWORD PTR [esi+52], 8721		; 00002211H
	jmp	$LN79@ssl23_get_
$LN18@ssl23_get_:
; Line 304
	mov	eax, DWORD PTR [esi+256]
	test	eax, 67108864				; 04000000H
	jne	SHORT $LN20@ssl23_get_
; Line 305
	mov	DWORD PTR [esi], 769			; 00000301H
; Line 311
	mov	DWORD PTR [esi+52], 8721		; 00002211H
	jmp	$LN79@ssl23_get_
$LN14@ssl23_get_:
; Line 319
	mov	eax, DWORD PTR [esi+256]
$LN20@ssl23_get_:
	test	eax, 33554432				; 02000000H
	jne	SHORT $LN25@ssl23_get_
; Line 320
	mov	DWORD PTR [esi], 768			; 00000300H
; Line 322
	mov	DWORD PTR [esi+52], 8721		; 00002211H
	jmp	$LN79@ssl23_get_
$LN25@ssl23_get_:
; Line 323
	test	eax, 16777216				; 01000000H
; Line 327
	jmp	$LN84@ssl23_get_
$LN8@ssl23_get_:
; Line 331
	cmp	al, 22					; 00000016H
	jne	$LN28@ssl23_get_
	cmp	BYTE PTR [edi+1], 3
	jne	$LN28@ssl23_get_
	cmp	BYTE PTR [edi+5], 1
	jne	$LN28@ssl23_get_
	mov	al, BYTE PTR [edi+3]
	test	al, al
	jne	SHORT $LN31@ssl23_get_
	cmp	BYTE PTR [edi+4], 5
	jb	SHORT $LN30@ssl23_get_
$LN31@ssl23_get_:
	cmp	BYTE PTR [edi+9], 3
	jb	$LN28@ssl23_get_
$LN30@ssl23_get_:
; Line 347
	test	al, al
	jne	SHORT $LN32@ssl23_get_
	cmp	BYTE PTR [edi+4], 6
	jae	SHORT $LN32@ssl23_get_
; Line 348
	push	348					; 0000015cH
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	298					; 0000012aH
; Line 349
	jmp	$LN83@ssl23_get_
$LN32@ssl23_get_:
; Line 356
	cmp	BYTE PTR [edi+9], 3
	jbe	SHORT $LN33@ssl23_get_
; Line 357
	mov	eax, 255				; 000000ffH
	jmp	SHORT $LN81@ssl23_get_
$LN33@ssl23_get_:
; Line 359
	movzx	eax, BYTE PTR [edi+10]
; Line 360
	cmp	eax, 1
	jl	SHORT $LN35@ssl23_get_
; Line 361
	cmp	eax, 3
	jl	SHORT $LN37@ssl23_get_
$LN81@ssl23_get_:
	test	DWORD PTR [esi+256], 134217728		; 08000000H
	jne	SHORT $LN37@ssl23_get_
; Line 363
	mov	DWORD PTR [esi], 771			; 00000303H
; Line 364
	mov	ebp, 3
	jmp	$LN51@ssl23_get_
$LN37@ssl23_get_:
; Line 365
	cmp	eax, 2
	jl	SHORT $LN39@ssl23_get_
	test	DWORD PTR [esi+256], 268435456		; 10000000H
	jne	SHORT $LN39@ssl23_get_
; Line 367
	mov	DWORD PTR [esi], 770			; 00000302H
; Line 368
	mov	ebp, 3
	jmp	$LN79@ssl23_get_
$LN39@ssl23_get_:
; Line 369
	mov	eax, DWORD PTR [esi+256]
	test	eax, 67108864				; 04000000H
	jne	SHORT $LN41@ssl23_get_
; Line 370
	mov	DWORD PTR [esi], 769			; 00000301H
; Line 371
	mov	ebp, 3
	jmp	$LN79@ssl23_get_
$LN41@ssl23_get_:
; Line 372
	test	eax, 33554432				; 02000000H
	jne	$LN50@ssl23_get_
; Line 373
	mov	DWORD PTR [esi], 768			; 00000300H
; Line 374
	mov	ebp, 3
; Line 376
	jmp	$LN79@ssl23_get_
$LN35@ssl23_get_:
; Line 378
	mov	eax, DWORD PTR [esi+256]
	test	eax, 33554432				; 02000000H
	jne	SHORT $LN44@ssl23_get_
; Line 379
	mov	DWORD PTR [esi], 768			; 00000300H
; Line 380
	mov	ebp, 3
	jmp	$LN79@ssl23_get_
$LN44@ssl23_get_:
; Line 381
	test	eax, 67108864				; 04000000H
	jne	$LN50@ssl23_get_
; Line 386
	mov	DWORD PTR [esi], 769			; 00000301H
; Line 387
	mov	ebp, 3
; Line 390
	jmp	$LN79@ssl23_get_
$LN28@ssl23_get_:
; Line 392
	mov	ebx, DWORD PTR __imp__strncmp
	push	4
	push	edi
	push	OFFSET ??_C@_04IBPFIGHK@GET?5?$AA@
	call	ebx
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN49@ssl23_get_
	push	5
	push	edi
	push	OFFSET ??_C@_05LPJJJLLB@POST?5?$AA@
	call	ebx
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN49@ssl23_get_
	push	5
	push	edi
	push	OFFSET ??_C@_05PMJKDPIC@HEAD?5?$AA@
	call	ebx
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN49@ssl23_get_
	push	4
	push	edi
	push	OFFSET ??_C@_04DCMJKHH@PUT?5?$AA@
	call	ebx
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $LN49@ssl23_get_
; Line 396
	push	7
	push	edi
	push	OFFSET ??_C@_07FNNMGOPK@CONNECT?$AA@
	call	ebx
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	$LN50@ssl23_get_
; Line 397
	push	397					; 0000018dH
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	155					; 0000009bH
; Line 398
	jmp	$LN83@ssl23_get_
$LN49@ssl23_get_:
; Line 394
	push	394					; 0000018aH
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	156					; 0000009cH
; Line 395
	jmp	$LN83@ssl23_get_
$LN53@ssl23_get_:
; Line 447
	cmp	edi, 9
	jge	SHORT $LN54@ssl23_get_
; Line 448
	push	449					; 000001c1H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	213					; 000000d5H
; Line 450
	jmp	$LN83@ssl23_get_
$LN54@ssl23_get_:
; Line 453
	lea	eax, DWORD PTR [edi+2]
	push	eax
	push	esi
	call	_ssl23_read_bytes
	add	esp, 8
; Line 458
	test	eax, eax
	jle	$LN1@ssl23_get_
; Line 461
	mov	eax, DWORD PTR [esi+80]
	sub	eax, 2
	push	eax
	mov	eax, DWORD PTR [esi+76]
	add	eax, 2
	push	eax
	push	esi
	call	_ssl3_finish_mac
; Line 464
	mov	ecx, DWORD PTR [esi+100]
	add	esp, 12					; 0000000cH
	test	ecx, ecx
	je	SHORT $LN56@ssl23_get_
; Line 465
	push	DWORD PTR [esi+104]
	mov	eax, DWORD PTR [esi+80]
	push	esi
	sub	eax, 2
	push	eax
	mov	eax, DWORD PTR [esi+76]
	add	eax, 2
	push	eax
	push	0
	push	2
	push	0
	call	ecx
	add	esp, 28					; 0000001cH
$LN56@ssl23_get_:
; Line 469
	mov	ecx, DWORD PTR [esi+76]
; Line 470
	movzx	eax, BYTE PTR [ecx+5]
	movzx	edx, BYTE PTR [ecx+6]
; Line 471
	movzx	ebx, BYTE PTR [ecx+8]
	shl	eax, 8
	or	edx, eax
	movzx	eax, BYTE PTR [ecx+7]
	shl	eax, 8
	or	ebx, eax
	mov	DWORD PTR _csl$1$[esp+56], edx
; Line 472
	movzx	eax, BYTE PTR [ecx+9]
	shl	eax, 8
	mov	DWORD PTR _sil$1$[esp+56], ebx
	movzx	ebx, BYTE PTR [ecx+10]
	add	ecx, 11					; 0000000bH
	or	ebx, eax
	mov	DWORD PTR _p$3$[esp+56], ecx
; Line 473
	mov	eax, DWORD PTR [esi+60]
	mov	DWORD PTR _i$1$[esp+56], ebx
	mov	ebx, DWORD PTR [eax+4]
; Line 474
	mov	eax, DWORD PTR _i$1$[esp+56]
	add	eax, 11					; 0000000bH
	add	eax, DWORD PTR _sil$1$[esp+56]
	add	eax, edx
	cmp	eax, DWORD PTR [esi+80]
	je	SHORT $LN57@ssl23_get_
; Line 482
	push	483					; 000001e3H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	213					; 000000d5H
; Line 484
	jmp	$LN83@ssl23_get_
$LN57@ssl23_get_:
; Line 495
	mov	eax, DWORD PTR _v$2$[esp+56]
	xorps	xmm0, xmm0
	mov	BYTE PTR [ebx], 1
	inc	ebx
; Line 499
	mov	DWORD PTR tv875[esp+56], 32		; 00000020H
	mov	DWORD PTR _d_len$1$[esp+56], ebx
	mov	BYTE PTR [ebx+3], 3
	mov	BYTE PTR [ebx+4], al
	mov	eax, DWORD PTR _i$1$[esp+56]
	cmp	eax, 32					; 00000020H
; Line 500
	movups	XMMWORD PTR [ebx+5], xmm0
	cmova	eax, DWORD PTR tv875[esp+56]
; Line 501
	push	eax
	mov	DWORD PTR _i$1$[esp+60], eax
	mov	eax, DWORD PTR _sil$1$[esp+60]
	add	eax, edx
	add	eax, ecx
	push	eax
	lea	eax, DWORD PTR [ebx+5]
	sub	eax, DWORD PTR _i$1$[esp+64]
	add	eax, 32					; 00000020H
	push	eax
	movups	XMMWORD PTR [ebx+21], xmm0
	call	_memcpy
; Line 508
	xor	eax, eax
	mov	BYTE PTR [ebx+37], 0
; Line 509
	lea	edx, DWORD PTR [ebx+38]
	mov	DWORD PTR _j$2$[esp+68], eax
	add	esp, 12					; 0000000cH
	mov	DWORD PTR _dd$1$[esp+56], edx
; Line 510
	add	ebx, 40					; 00000028H
; Line 511
	xor	ecx, ecx
	cmp	DWORD PTR _csl$1$[esp+56], eax
	jbe	SHORT $LN3@ssl23_get_
	mov	edx, DWORD PTR _p$3$[esp+56]
$LL4@ssl23_get_:
; Line 512
	cmp	BYTE PTR [ecx+edx], 0
	jne	SHORT $LN2@ssl23_get_
; Line 514
	movzx	eax, BYTE PTR [ecx+edx+1]
	mov	BYTE PTR [ebx], al
; Line 515
	movzx	eax, BYTE PTR [ecx+edx+2]
	mov	BYTE PTR [ebx+1], al
	add	ebx, ebp
; Line 516
	mov	eax, DWORD PTR _j$2$[esp+56]
	add	eax, 2
	mov	DWORD PTR _j$2$[esp+56], eax
$LN2@ssl23_get_:
; Line 511
	add	ecx, 3
	cmp	ecx, DWORD PTR _csl$1$[esp+56]
	jb	SHORT $LL4@ssl23_get_
	mov	edx, DWORD PTR _dd$1$[esp+56]
$LN3@ssl23_get_:
; Line 533
	mov	ecx, DWORD PTR _d_len$1$[esp+56]
	sar	eax, 8
	mov	BYTE PTR [edx], al
	mov	eax, DWORD PTR _j$2$[esp+56]
	mov	BYTE PTR [edx+1], al
	mov	BYTE PTR [ebx], 1
	inc	ebx
	mov	BYTE PTR [ebx], 0
	mov	eax, DWORD PTR [esi+60]
	sub	ebx, DWORD PTR [eax+4]
	sub	ebx, 3
	mov	eax, ebx
	mov	BYTE PTR [ecx+2], bl
	sar	eax, 16					; 00000010H
	mov	BYTE PTR [ecx], al
	mov	eax, ebx
	sar	eax, 8
	mov	BYTE PTR [ecx+1], al
; Line 536
	mov	eax, DWORD PTR [esi+88]
	mov	DWORD PTR [eax+852], 1
; Line 537
	mov	eax, DWORD PTR [esi+88]
	mov	DWORD PTR [eax+832], 1
; Line 538
	mov	eax, DWORD PTR [esi+88]
	mov	DWORD PTR [eax+828], ebx
; Line 544
	jmp	SHORT $LN61@ssl23_get_
$LN52@ssl23_get_:
	cmp	ebp, 1
	jne	SHORT $LN59@ssl23_get_
; Line 546
	push	546					; 00000222H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	258					; 00000102H
; Line 547
	jmp	$LN83@ssl23_get_
$LN59@ssl23_get_:
; Line 595
	cmp	ebp, 2
	je	SHORT $LN82@ssl23_get_
	cmp	ebp, 3
	jne	$LN60@ssl23_get_
$LN82@ssl23_get_:
	mov	edi, DWORD PTR _n$1$[esp+56]
$LN61@ssl23_get_:
; Line 600
	push	DWORD PTR [esi]
	call	_ssl23_get_server_method
	add	esp, 4
; Line 601
	test	eax, eax
	jne	SHORT $LN62@ssl23_get_
; Line 602
	push	602					; 0000025aH
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	258					; 00000102H
; Line 603
	jmp	$LN83@ssl23_get_
$LN62@ssl23_get_:
; Line 607
	push	1
	push	esi
	mov	DWORD PTR [esi+8], eax
	call	_ssl_init_wbio_buffer
	add	esp, 8
	test	eax, eax
	je	$LN71@ssl23_get_
; Line 619
	mov	eax, DWORD PTR [esi+88]
	mov	DWORD PTR [esi+52], 8464		; 00002110H
	cmp	ebp, 3
	jne	SHORT $LN64@ssl23_get_
; Line 618
	mov	DWORD PTR [esi+56], 240			; 000000f0H
	mov	DWORD PTR [esi+80], edi
; Line 619
	cmp	DWORD PTR [eax+236], 0
	jne	SHORT $LN67@ssl23_get_
; Line 620
	push	esi
	call	_ssl3_setup_read_buffer
	add	esp, 4
	test	eax, eax
	je	$LN71@ssl23_get_
$LN67@ssl23_get_:
; Line 623
	mov	eax, DWORD PTR [esi+88]
; Line 624
	lea	ecx, DWORD PTR _buf_space$[esp+56]
	push	edi
	push	ecx
	mov	eax, DWORD PTR [eax+236]
	push	eax
	mov	DWORD PTR [esi+76], eax
	call	_memcpy
; Line 625
	mov	eax, DWORD PTR [esi+88]
	add	esp, 12					; 0000000cH
	mov	DWORD PTR [eax+248], edi
; Line 627
	jmp	SHORT $LN86@ssl23_get_
$LN64@ssl23_get_:
; Line 628
	mov	DWORD PTR [esi+80], 0
; Line 629
	mov	DWORD PTR [eax+248], 0
$LN86@ssl23_get_:
; Line 630
	mov	eax, DWORD PTR [esi+88]
	mov	DWORD PTR [eax+244], 0
; Line 635
	mov	eax, DWORD PTR [esi+8]
	mov	eax, DWORD PTR [eax+16]
	mov	DWORD PTR [esi+32], eax
$LN60@ssl23_get_:
; Line 638
	lea	eax, DWORD PTR [ebp-1]
	cmp	eax, 2
	ja	SHORT $LN69@ssl23_get_
; Line 647
	push	esi
	mov	DWORD PTR [esi+68], 0
	call	_SSL_accept
	add	esp, 4
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 652
	mov	ecx, DWORD PTR __$ArrayPad$[esp+40]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 40					; 00000028H
	ret	0
$LN69@ssl23_get_:
; Line 640
	push	640					; 00000280H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	252					; 000000fcH
$LN83@ssl23_get_:
	push	118					; 00000076H
	push	20					; 00000014H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN71@ssl23_get_:
; Line 651
	or	eax, -1
$LN1@ssl23_get_:
; Line 652
	mov	ecx, DWORD PTR __$ArrayPad$[esp+56]
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 40					; 00000028H
	ret	0
_ssl23_get_client_hello ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ssl23_get_server_method
_TEXT	SEGMENT
_ver$ = 8						; size = 4
_ssl23_get_server_method PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
; Line 131
	mov	eax, DWORD PTR _ver$[esp-4]
	cmp	eax, 768				; 00000300H
	je	_SSLv3_server_method
; Line 134
	cmp	eax, 769				; 00000301H
	je	_TLSv1_server_method
; Line 136
	cmp	eax, 770				; 00000302H
	je	_TLSv1_1_server_method
; Line 138
	cmp	eax, 771				; 00000303H
	je	_TLSv1_2_server_method
; Line 141
	xor	eax, eax
; Line 142
	ret	0
_ssl23_get_server_method ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _ssl23_accept
_TEXT	SEGMENT
_Time$ = -4						; size = 4
_s$ = 8							; size = 4
_ssl23_accept PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
; Line 149
	mov	eax, 4
	call	__chkstk
	push	ebx
	push	esi
	push	edi
; File c:\program files\windows kits\10\include\10.0.10586.0\ucrt\time.h
; Line 535
	push	0
	call	DWORD PTR __imp___time64
	add	esp, 4
; File c:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
; Line 151
	mov	DWORD PTR _Time$[esp+16], eax
; Line 156
	mov	eax, 8
	call	__chkstk
	xorps	xmm0, xmm0
	lea	eax, DWORD PTR _Time$[esp+24]
	movsd	QWORD PTR [esp], xmm0
	push	4
	push	eax
	call	_RAND_add
	add	esp, 16					; 00000010H
; Line 157
	call	_ERR_clear_error
; Line 158
	push	0
	call	DWORD PTR __imp__SetLastError@4
; Line 160
	mov	esi, DWORD PTR _s$[esp+12]
	mov	ebx, DWORD PTR [esi+208]
	test	ebx, ebx
	jne	SHORT $LN9@ssl23_acce
; Line 162
	mov	eax, DWORD PTR [esi+228]
	mov	eax, DWORD PTR [eax+156]
	test	eax, eax
	cmovne	ebx, eax
$LN9@ssl23_acce:
; Line 165
	inc	DWORD PTR [esi+28]
; Line 166
	push	esi
	call	_SSL_state
	add	esp, 4
	test	eax, 12288				; 00003000H
	je	SHORT $LN11@ssl23_acce
	push	esi
	call	_SSL_state
	add	esp, 4
	test	eax, 16384				; 00004000H
	je	SHORT $LN39@ssl23_acce
$LN11@ssl23_acce:
; Line 167
	push	esi
	call	_SSL_clear
	add	esp, 4
$LN39@ssl23_acce:
	push	ebp
	npad	10
$LL2@ssl23_acce:
; Line 170
	mov	edi, DWORD PTR [esi+52]
; Line 172
	cmp	edi, 8721				; 00002211H
	jg	SHORT $LN23@ssl23_acce
	cmp	edi, 8720				; 00002210H
	jge	$LN17@ssl23_acce
	mov	eax, edi
	sub	eax, 8192				; 00002000H
	je	SHORT $LN12@ssl23_acce
	sub	eax, 3
	jmp	SHORT $LN40@ssl23_acce
$LN23@ssl23_acce:
	cmp	edi, 16384				; 00004000H
	je	SHORT $LN12@ssl23_acce
	cmp	edi, 24576				; 00006000H
$LN40@ssl23_acce:
	jne	$LN28@ssl23_acce
$LN12@ssl23_acce:
; Line 178
	mov	DWORD PTR [esi+36], 1
; Line 179
	test	ebx, ebx
	je	SHORT $LN13@ssl23_acce
; Line 180
	push	1
	push	16					; 00000010H
	push	esi
	call	ebx
	add	esp, 12					; 0000000cH
$LN13@ssl23_acce:
; Line 185
	cmp	DWORD PTR [esi+60], 0
	mov	DWORD PTR [esi+4], 8192			; 00002000H
	jne	SHORT $LN14@ssl23_acce
; Line 186
	call	_BUF_MEM_new
	mov	ebp, eax
	test	ebp, ebp
	je	$LN29@ssl23_acce
; Line 190
	push	16384					; 00004000H
	push	ebp
	call	_BUF_MEM_grow
	add	esp, 8
	test	eax, eax
	je	$LN30@ssl23_acce
; Line 195
	mov	DWORD PTR [esi+60], ebp
$LN14@ssl23_acce:
; Line 198
	push	esi
	call	_ssl3_init_finished_mac
; Line 201
	mov	eax, DWORD PTR [esi+228]
	add	esp, 4
	mov	DWORD PTR [esi+52], 8720		; 00002210H
	inc	DWORD PTR [eax+64]
; Line 202
	mov	DWORD PTR [esi+68], 0
; Line 222
	test	ebx, ebx
	je	$LL2@ssl23_acce
	mov	ebp, DWORD PTR [esi+52]
	cmp	ebp, edi
	je	$LL2@ssl23_acce
; Line 225
	push	1
	push	8193					; 00002001H
	push	esi
	mov	DWORD PTR [esi+52], edi
	call	ebx
	add	esp, 12					; 0000000cH
; Line 226
	mov	DWORD PTR [esi+52], ebp
; Line 228
	jmp	$LL2@ssl23_acce
$LN17@ssl23_acce:
; Line 209
	push	esi
	mov	DWORD PTR [esi+48], 0
	call	_ssl23_get_client_hello
	mov	edi, eax
	add	esp, 4
; Line 210
	test	edi, edi
	js	SHORT $end$42
; Line 211
	xor	ebx, ebx
; Line 212
	jmp	SHORT $end$42
$LN28@ssl23_acce:
; Line 216
	push	216					; 000000d8H
	push	OFFSET ??_C@_0BB@NKEKLOOB@?4?2ssl?2s23_srvr?4c?$AA@
	push	255					; 000000ffH
	push	115					; 00000073H
	push	20					; 00000014H
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 218
	jmp	SHORT $LN29@ssl23_acce
$LN30@ssl23_acce:
; Line 191
	push	ebp
	call	_BUF_MEM_free
	add	esp, 4
$LN29@ssl23_acce:
; Line 187
	or	edi, -1
$end$42:
; Line 230
	dec	DWORD PTR [esi+28]
	pop	ebp
; Line 231
	test	ebx, ebx
	je	SHORT $LN38@ssl23_acce
; Line 232
	push	edi
	push	8194					; 00002002H
	push	esi
	call	ebx
	add	esp, 12					; 0000000cH
$LN38@ssl23_acce:
; Line 233
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebx
; Line 234
	pop	ecx
	ret	0
_ssl23_accept ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _SSLv23_server_method
_TEXT	SEGMENT
_SSLv23_server_method PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\ssl\s23_srvr.c
; Line 144
	mov	eax, OFFSET ?SSLv23_server_method_data@?1??SSLv23_server_method@@9@9
; Line 146
	ret	0
_SSLv23_server_method ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _time
_TEXT	SEGMENT
__Time$ = 8						; size = 4
_time	PROC						; COMDAT
; File c:\program files\windows kits\10\include\10.0.10586.0\ucrt\time.h
; Line 535
	jmp	DWORD PTR __imp___time64
_time	ENDP
_TEXT	ENDS
END
