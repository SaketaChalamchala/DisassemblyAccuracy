; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_CMS_ReceiptRequest_new
PUBLIC	_CMS_ReceiptRequest_free
PUBLIC	_d2i_CMS_ReceiptRequest
PUBLIC	_i2d_CMS_ReceiptRequest
PUBLIC	_CMS_get1_ReceiptRequest
PUBLIC	_CMS_ReceiptRequest_create0
PUBLIC	_CMS_add1_ReceiptRequest
PUBLIC	_CMS_ReceiptRequest_get0_values
PUBLIC	_cms_Receipt_verify
PUBLIC	_cms_msgSigDigest_add1
PUBLIC	_cms_encode_Receipt
PUBLIC	??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@ ; `string'
EXTRN	_sk_num:PROC
EXTRN	_sk_value:PROC
EXTRN	_sk_pop_free:PROC
EXTRN	_CRYPTO_free:PROC
EXTRN	_ERR_put_error:PROC
EXTRN	_ASN1_STRING_cmp:PROC
EXTRN	_ASN1_STRING_set:PROC
EXTRN	_ASN1_STRING_set0:PROC
EXTRN	_ASN1_item_unpack:PROC
EXTRN	_ASN1_item_pack:PROC
EXTRN	_ASN1_item_new:PROC
EXTRN	_ASN1_item_free:PROC
EXTRN	_ASN1_item_d2i:PROC
EXTRN	_ASN1_item_i2d:PROC
EXTRN	_OBJ_nid2obj:PROC
EXTRN	_OBJ_nid2sn:PROC
EXTRN	_OBJ_obj2nid:PROC
EXTRN	_OBJ_cmp:PROC
EXTRN	_EVP_get_digestbyname:PROC
EXTRN	_ASN1_item_digest:PROC
EXTRN	_RAND_pseudo_bytes:PROC
EXTRN	_GENERAL_NAMES_free:PROC
EXTRN	_CMS_ReceiptRequest_it:PROC
EXTRN	_CMS_get0_content:PROC
EXTRN	_CMS_get0_eContentType:PROC
EXTRN	_CMS_get0_SignerInfos:PROC
EXTRN	_CMS_signed_add1_attr_by_NID:PROC
EXTRN	_CMS_signed_get0_data_by_OBJ:PROC
EXTRN	_CMS_Attributes_Verify_it:PROC
EXTRN	_CMS_Receipt_it:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__chkstk:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
CONST	SEGMENT
??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@ DB '.\crypto\cms\cms_'
	DB	'ess.c', 00H					; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_msgSigDigest
_TEXT	SEGMENT
_si$ = 8						; size = 4
_dig$ = 12						; size = 4
_diglen$ = 16						; size = 4
_cms_msgSigDigest PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 192
	push	esi
; Line 194
	mov	esi, DWORD PTR _si$[esp]
	mov	eax, DWORD PTR [esi+8]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	push	eax
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	add	esp, 12					; 0000000cH
; Line 195
	test	eax, eax
	jne	SHORT $LN2@cms_msgSig
	pop	esi
; Line 201
	ret	0
$LN2@cms_msgSig:
; Line 197
	push	DWORD PTR _diglen$[esp]
	push	DWORD PTR _dig$[esp+4]
	push	DWORD PTR [esi+12]
	push	eax
	call	_CMS_Attributes_Verify_it
	push	eax
	call	_ASN1_item_digest
	add	esp, 20					; 00000014H
	neg	eax
	sbb	eax, eax
	neg	eax
	pop	esi
; Line 201
	ret	0
_cms_msgSigDigest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_encode_Receipt
_TEXT	SEGMENT
_rr$ = -20						; size = 4
_rct$ = -16						; size = 16
_si$ = 8						; size = 4
_cms_encode_Receipt PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 357
	mov	eax, 20					; 00000014H
	call	__chkstk
	push	ebx
; Line 367
	mov	ebx, DWORD PTR _si$[esp+20]
	lea	eax, DWORD PTR _rr$[esp+24]
	push	esi
	push	edi
	push	eax
	push	ebx
	mov	DWORD PTR _rr$[esp+40], 0
	xor	edi, edi
	call	_CMS_get1_ReceiptRequest
	mov	esi, DWORD PTR _rr$[esp+40]
	add	esp, 8
	test	eax, eax
	jg	SHORT $LN2@cms_encode
; Line 368
	push	368					; 00000170H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	168					; 000000a8H
	push	161					; 000000a1H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 369
	jmp	SHORT $err$10
$LN2@cms_encode:
; Line 374
	push	6
	push	-3					; fffffffdH
	push	50					; 00000032H
	call	_OBJ_nid2obj
	add	esp, 4
	push	eax
	push	ebx
	call	_CMS_signed_get0_data_by_OBJ
	add	esp, 16					; 00000010H
; Line 377
	test	eax, eax
	jne	SHORT $LN3@cms_encode
; Line 378
	push	378					; 0000017aH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	173					; 000000adH
	push	161					; 000000a1H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 379
	jmp	SHORT $err$10
$LN3@cms_encode:
; Line 383
	mov	DWORD PTR _rct$[esp+36], eax
	mov	DWORD PTR _rct$[esp+32], 1
; Line 384
	mov	eax, DWORD PTR [esi]
	mov	DWORD PTR _rct$[esp+40], eax
; Line 385
	mov	eax, DWORD PTR [ebx+20]
; Line 387
	push	0
	mov	DWORD PTR _rct$[esp+48], eax
	call	_CMS_Receipt_it
	push	eax
	lea	eax, DWORD PTR _rct$[esp+40]
	push	eax
	call	_ASN1_item_pack
	add	esp, 12					; 0000000cH
	mov	edi, eax
$err$10:
; Line 390
	test	esi, esi
	je	SHORT $LN8@cms_encode
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	esi
	call	_ASN1_item_free
	add	esp, 8
$LN8@cms_encode:
; Line 393
	mov	eax, edi
	pop	edi
	pop	esi
	pop	ebx
; Line 395
	add	esp, 20					; 00000014H
	ret	0
_cms_encode_Receipt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_msgSigDigest_add1
_TEXT	SEGMENT
_diglen$ = -72						; size = 4
_dig$ = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_dest$ = 8						; size = 4
_src$ = 12						; size = 4
_cms_msgSigDigest_add1 PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 206
	mov	eax, 72					; 00000048H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+72], eax
	push	esi
	mov	esi, DWORD PTR _src$[esp+72]
	push	edi
	mov	edi, DWORD PTR _dest$[esp+76]
; Line 194
	mov	eax, DWORD PTR [esi+8]
	push	DWORD PTR [eax]
	call	_OBJ_obj2nid
	push	eax
	call	_OBJ_nid2sn
	push	eax
	call	_EVP_get_digestbyname
	add	esp, 12					; 0000000cH
; Line 195
	test	eax, eax
	je	SHORT $LN9@cms_msgSig
; Line 197
	lea	ecx, DWORD PTR _diglen$[esp+80]
	push	ecx
	lea	ecx, DWORD PTR _dig$[esp+84]
	push	ecx
	push	DWORD PTR [esi+12]
	push	eax
	call	_CMS_Attributes_Verify_it
	push	eax
	call	_ASN1_item_digest
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN9@cms_msgSig
; Line 213
	push	DWORD PTR _diglen$[esp+80]
	lea	eax, DWORD PTR _dig$[esp+84]
	push	eax
	push	4
	push	216					; 000000d8H
	push	edi
	call	_CMS_signed_add1_attr_by_NID
	add	esp, 20					; 00000014H
	test	eax, eax
	jne	SHORT $LN3@cms_msgSig
; Line 215
	push	215					; 000000d7H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	65					; 00000041H
; Line 216
	jmp	SHORT $LN10@cms_msgSig
$LN3@cms_msgSig:
	pop	edi
; Line 218
	mov	eax, 1
	pop	esi
; Line 219
	mov	ecx, DWORD PTR __$ArrayPad$[esp+72]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 72					; 00000048H
	ret	0
$LN9@cms_msgSig:
; Line 210
	push	210					; 000000d2H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	172					; 000000acH
$LN10@cms_msgSig:
	push	162					; 000000a2H
	push	46					; 0000002eH
	call	_ERR_put_error
; Line 219
	mov	ecx, DWORD PTR __$ArrayPad$[esp+100]
	add	esp, 20					; 00000014H
	xor	eax, eax
	pop	edi
	pop	esi
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 72					; 00000048H
	ret	0
_cms_msgSigDigest_add1 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _cms_Receipt_verify
_TEXT	SEGMENT
_rct$1$ = -84						; size = 4
_rr$ = -80						; size = 4
_sis$1$ = -76						; size = 4
_diglen$ = -72						; size = 4
_dig$ = -68						; size = 64
__$ArrayPad$ = -4					; size = 4
_cms$ = 8						; size = 4
_req_cms$ = 12						; size = 4
_cms_Receipt_verify PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 224
	mov	eax, 84					; 00000054H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+84], eax
	mov	eax, DWORD PTR _req_cms$[esp+80]
	push	ebx
	push	ebp
	push	esi
	mov	esi, DWORD PTR _cms$[esp+92]
; Line 225
	xor	ebx, ebx
	push	edi
; Line 236
	push	eax
	mov	DWORD PTR _rr$[esp+104], ebx
	xor	ebp, ebp
	call	_CMS_get0_SignerInfos
; Line 237
	push	esi
	mov	edi, eax
	call	_CMS_get0_SignerInfos
	add	esp, 8
	mov	DWORD PTR _sis$1$[esp+100], eax
; Line 238
	test	edi, edi
	je	$LN37@cms_Receip
	test	eax, eax
	je	$LN37@cms_Receip
; Line 241
	push	eax
	call	_sk_num
	add	esp, 4
	cmp	eax, 1
	je	SHORT $LN7@cms_Receip
; Line 242
	push	242					; 000000f2H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	164					; 000000a4H
; Line 243
	jmp	$LN40@cms_Receip
$LN7@cms_Receip:
; Line 247
	push	esi
	call	_CMS_get0_eContentType
	push	eax
	call	_OBJ_obj2nid
	add	esp, 8
	cmp	eax, 204				; 000000ccH
	je	SHORT $LN8@cms_Receip
; Line 248
	push	248					; 000000f8H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	165					; 000000a5H
; Line 249
	jmp	$LN40@cms_Receip
$LN8@cms_Receip:
; Line 253
	push	esi
	call	_CMS_get0_content
	mov	esi, eax
	add	esp, 4
; Line 254
	test	esi, esi
	je	$LN10@cms_Receip
	cmp	DWORD PTR [esi], ebx
	je	$LN10@cms_Receip
; Line 259
	call	_CMS_Receipt_it
	push	eax
	push	DWORD PTR [esi]
	call	_ASN1_item_unpack
	add	esp, 8
	mov	DWORD PTR _rct$1$[esp+100], eax
; Line 261
	test	eax, eax
	jne	SHORT $LN11@cms_Receip
; Line 262
	push	262					; 00000106H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	169					; 000000a9H
; Line 263
	jmp	$LN40@cms_Receip
$LN11@cms_Receip:
; Line 268
	push	edi
	xor	esi, esi
	call	_sk_num
	add	esp, 4
	test	eax, eax
	jle	SHORT $LN28@cms_Receip
	mov	ebx, DWORD PTR _rct$1$[esp+100]
$LL4@cms_Receip:
; Line 269
	push	esi
	push	edi
	call	_sk_value
; Line 270
	push	DWORD PTR [ebx+12]
	mov	ebp, eax
	push	DWORD PTR [ebp+20]
	call	_ASN1_STRING_cmp
	add	esp, 16					; 00000010H
	test	eax, eax
	je	SHORT $LN39@cms_Receip
; Line 268
	push	edi
	inc	esi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jl	SHORT $LL4@cms_Receip
$LN39@cms_Receip:
	xor	ebx, ebx
$LN28@cms_Receip:
; Line 274
	push	edi
	call	_sk_num
	add	esp, 4
	cmp	esi, eax
	jne	SHORT $LN13@cms_Receip
; Line 275
	push	275					; 00000113H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	166					; 000000a6H
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 276
	jmp	$LN25@cms_Receip
$LN13@cms_Receip:
; Line 279
	push	0
	push	DWORD PTR _sis$1$[esp+104]
	call	_sk_value
	add	esp, 8
	mov	esi, eax
; Line 283
	push	4
	push	-3					; fffffffdH
	push	216					; 000000d8H
	call	_OBJ_nid2obj
	add	esp, 4
	push	eax
	push	esi
	call	_CMS_signed_get0_data_by_OBJ
	mov	esi, eax
	add	esp, 16					; 00000010H
; Line 288
	test	esi, esi
	jne	SHORT $LN14@cms_Receip
; Line 289
	push	289					; 00000121H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	167					; 000000a7H
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 290
	jmp	$LN25@cms_Receip
$LN14@cms_Receip:
; Line 293
	lea	eax, DWORD PTR _diglen$[esp+100]
	push	eax
	lea	eax, DWORD PTR _dig$[esp+104]
	push	eax
	push	ebp
	call	_cms_msgSigDigest
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN15@cms_Receip
; Line 294
	push	294					; 00000126H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	172					; 000000acH
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 295
	jmp	$LN25@cms_Receip
$LN15@cms_Receip:
; Line 298
	mov	ecx, DWORD PTR _diglen$[esp+100]
	cmp	ecx, DWORD PTR [esi]
	je	SHORT $LN16@cms_Receip
; Line 299
	push	299					; 0000012bH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	163					; 000000a3H
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 300
	jmp	$LN25@cms_Receip
$LN16@cms_Receip:
; Line 303
	mov	esi, DWORD PTR [esi+8]
	lea	edx, DWORD PTR _dig$[esp+100]
	sub	ecx, 4
	jb	SHORT $LN34@cms_Receip
$LL35@cms_Receip:
	mov	eax, DWORD PTR [edx]
	cmp	eax, DWORD PTR [esi]
	jne	SHORT $LN33@cms_Receip
	add	edx, 4
	add	esi, 4
	sub	ecx, 4
	jae	SHORT $LL35@cms_Receip
$LN34@cms_Receip:
	cmp	ecx, -4					; fffffffcH
	je	SHORT $LN32@cms_Receip
$LN33@cms_Receip:
	mov	al, BYTE PTR [edx]
	cmp	al, BYTE PTR [esi]
	jne	SHORT $LN36@cms_Receip
	cmp	ecx, -3					; fffffffdH
	je	SHORT $LN32@cms_Receip
	mov	al, BYTE PTR [edx+1]
	cmp	al, BYTE PTR [esi+1]
	jne	SHORT $LN36@cms_Receip
	cmp	ecx, -2					; fffffffeH
	je	SHORT $LN32@cms_Receip
	mov	al, BYTE PTR [edx+2]
	cmp	al, BYTE PTR [esi+2]
	jne	SHORT $LN36@cms_Receip
	cmp	ecx, -1
	je	SHORT $LN32@cms_Receip
	mov	al, BYTE PTR [edx+3]
	cmp	al, BYTE PTR [esi+3]
	je	SHORT $LN32@cms_Receip
$LN36@cms_Receip:
; Line 304
	push	305					; 00000131H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	162					; 000000a2H
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 306
	jmp	$LN25@cms_Receip
$LN32@cms_Receip:
; Line 311
	push	6
	push	-3					; fffffffdH
	push	50					; 00000032H
	call	_OBJ_nid2obj
	add	esp, 4
	push	eax
	push	ebp
	call	_CMS_signed_get0_data_by_OBJ
	add	esp, 16					; 00000010H
; Line 314
	test	eax, eax
	jne	SHORT $LN18@cms_Receip
; Line 315
	push	315					; 0000013bH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	173					; 000000adH
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 316
	jmp	$LN25@cms_Receip
$LN18@cms_Receip:
; Line 321
	mov	edi, DWORD PTR _rct$1$[esp+100]
	push	DWORD PTR [edi+4]
	push	eax
	call	_OBJ_cmp
	add	esp, 8
	test	eax, eax
	je	SHORT $LN19@cms_Receip
; Line 322
	push	322					; 00000142H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	171					; 000000abH
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 323
	jmp	$LN25@cms_Receip
$LN19@cms_Receip:
; Line 328
	lea	eax, DWORD PTR _rr$[esp+100]
	push	eax
	push	ebp
	call	_CMS_get1_ReceiptRequest
	mov	esi, DWORD PTR _rr$[esp+108]
	add	esp, 8
	test	eax, eax
	jg	SHORT $LN20@cms_Receip
; Line 329
	push	329					; 00000149H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	168					; 000000a8H
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 330
	jmp	SHORT $err$42
$LN20@cms_Receip:
; Line 333
	push	DWORD PTR [edi+8]
	push	DWORD PTR [esi]
	call	_ASN1_STRING_cmp
	add	esp, 8
	test	eax, eax
	je	SHORT $LN21@cms_Receip
; Line 335
	push	335					; 0000014fH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	170					; 000000aaH
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
; Line 336
	jmp	SHORT $err$42
$LN21@cms_Receip:
; Line 339
	mov	ebx, 1
$err$42:
; Line 342
	test	esi, esi
	je	SHORT $LN25@cms_Receip
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	esi
	call	_ASN1_item_free
	add	esp, 8
$LN25@cms_Receip:
; Line 345
	call	_CMS_Receipt_it
	push	eax
	push	DWORD PTR _rct$1$[esp+104]
	call	_ASN1_item_free
	add	esp, 8
; Line 347
	mov	eax, ebx
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 349
	mov	ecx, DWORD PTR __$ArrayPad$[esp+84]
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 84					; 00000054H
	ret	0
$LN10@cms_Receip:
; Line 255
	push	255					; 000000ffH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	127					; 0000007fH
$LN40@cms_Receip:
	push	160					; 000000a0H
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN37@cms_Receip:
; Line 349
	mov	ecx, DWORD PTR __$ArrayPad$[esp+100]
	mov	eax, ebx
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	xor	ecx, esp
	call	@__security_check_cookie@4
	add	esp, 84					; 00000054H
	ret	0
_cms_Receipt_verify ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_ReceiptRequest_get0_values
_TEXT	SEGMENT
_rr$ = 8						; size = 4
_pcid$ = 12						; size = 4
_pallorfirst$ = 16					; size = 4
_plist$ = 20						; size = 4
_prto$ = 24						; size = 4
_CMS_ReceiptRequest_get0_values PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 171
	mov	edx, DWORD PTR _pcid$[esp-4]
	mov	ecx, DWORD PTR _rr$[esp-4]
	test	edx, edx
	je	SHORT $LN2@CMS_Receip
; Line 172
	mov	eax, DWORD PTR [ecx]
	mov	DWORD PTR [edx], eax
$LN2@CMS_Receip:
; Line 173
	mov	eax, DWORD PTR [ecx+4]
	cmp	DWORD PTR [eax], 0
	jne	SHORT $LN3@CMS_Receip
; Line 174
	mov	edx, DWORD PTR _pallorfirst$[esp-4]
	test	edx, edx
	je	SHORT $LN5@CMS_Receip
; Line 175
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR [edx], eax
$LN5@CMS_Receip:
; Line 176
	mov	eax, DWORD PTR _plist$[esp-4]
	test	eax, eax
	je	SHORT $LN8@CMS_Receip
; Line 177
	mov	DWORD PTR [eax], 0
; Line 178
	jmp	SHORT $LN8@CMS_Receip
$LN3@CMS_Receip:
; Line 179
	mov	eax, DWORD PTR _pallorfirst$[esp-4]
	test	eax, eax
	je	SHORT $LN7@CMS_Receip
; Line 180
	mov	DWORD PTR [eax], -1
$LN7@CMS_Receip:
; Line 181
	mov	edx, DWORD PTR _plist$[esp-4]
	test	edx, edx
	je	SHORT $LN8@CMS_Receip
; Line 182
	mov	eax, DWORD PTR [ecx+4]
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR [edx], eax
$LN8@CMS_Receip:
; Line 184
	mov	edx, DWORD PTR _prto$[esp-4]
	test	edx, edx
	je	SHORT $LN9@CMS_Receip
; Line 185
	mov	eax, DWORD PTR [ecx+8]
	mov	DWORD PTR [edx], eax
$LN9@CMS_Receip:
; Line 186
	ret	0
_CMS_ReceiptRequest_get0_values ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_add1_ReceiptRequest
_TEXT	SEGMENT
_rrder$ = -4						; size = 4
_si$ = 8						; size = 4
_rr$ = 12						; size = 4
_CMS_add1_ReceiptRequest PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 140
	mov	eax, 4
	call	__chkstk
	push	esi
; Line 141
	mov	DWORD PTR _rrder$[esp+8], 0
; Line 142
	xor	esi, esi
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	lea	eax, DWORD PTR _rrder$[esp+12]
	push	eax
	push	DWORD PTR _rr$[esp+12]
	call	_ASN1_item_i2d
	add	esp, 12					; 0000000cH
; Line 145
	test	eax, eax
	js	SHORT $LN9@CMS_add1_R
; Line 148
	push	eax
	push	DWORD PTR _rrder$[esp+12]
	push	16					; 00000010H
	push	212					; 000000d4H
	push	DWORD PTR _si$[esp+20]
	call	_CMS_signed_add1_attr_by_NID
	add	esp, 20					; 00000014H
	test	eax, eax
	je	SHORT $LN9@CMS_add1_R
; Line 152
	mov	esi, 1
; Line 155
	jmp	SHORT $LN4@CMS_add1_R
$LN9@CMS_add1_R:
; Line 156
	push	156					; 0000009cH
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	65					; 00000041H
	push	158					; 0000009eH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$LN4@CMS_add1_R:
; Line 158
	mov	ecx, DWORD PTR _rrder$[esp+8]
	test	ecx, ecx
	je	SHORT $LN10@CMS_add1_R
; Line 159
	push	ecx
	call	_CRYPTO_free
	add	esp, 4
$LN10@CMS_add1_R:
; Line 161
	mov	eax, esi
	pop	esi
; Line 163
	pop	ecx
	ret	0
_CMS_add1_ReceiptRequest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_ReceiptRequest_create0
_TEXT	SEGMENT
_id$ = 8						; size = 4
_idlen$ = 12						; size = 4
_allorfirst$ = 16					; size = 4
_receiptList$ = 20					; size = 4
_receiptsTo$ = 24					; size = 4
_CMS_ReceiptRequest_create0 PROC			; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 99
	push	esi
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	call	_ASN1_item_new
; Line 102
	mov	esi, eax
; Line 67
	add	esp, 4
; Line 103
	test	esi, esi
	je	$merr$16
; Line 105
	mov	eax, DWORD PTR _id$[esp]
	test	eax, eax
	je	SHORT $LN3@CMS_Receip
; Line 106
	push	DWORD PTR _idlen$[esp]
	push	eax
	push	DWORD PTR [esi]
	call	_ASN1_STRING_set0
	add	esp, 12					; 0000000cH
	jmp	SHORT $LN6@CMS_Receip
$LN3@CMS_Receip:
; Line 108
	push	32					; 00000020H
	push	0
	push	DWORD PTR [esi]
	call	_ASN1_STRING_set
	add	esp, 12					; 0000000cH
	test	eax, eax
	je	SHORT $merr$16
; Line 111
	mov	eax, DWORD PTR [esi]
	push	32					; 00000020H
	push	DWORD PTR [eax+8]
	call	_RAND_pseudo_bytes
	add	esp, 8
	test	eax, eax
	jle	SHORT $err$17
$LN6@CMS_Receip:
; Line 115
	push	OFFSET _GENERAL_NAMES_free
	push	DWORD PTR [esi+8]
	call	_sk_pop_free
; Line 116
	mov	eax, DWORD PTR _receiptsTo$[esp+8]
	add	esp, 8
; Line 118
	mov	ecx, DWORD PTR _receiptList$[esp]
	mov	DWORD PTR [esi+8], eax
; Line 119
	mov	eax, DWORD PTR [esi+4]
	test	ecx, ecx
	je	SHORT $LN7@CMS_Receip
	mov	DWORD PTR [eax], 1
; Line 120
	mov	eax, DWORD PTR [esi+4]
	mov	DWORD PTR [eax+4], ecx
; Line 126
	mov	eax, esi
	pop	esi
; Line 137
	ret	0
$LN7@CMS_Receip:
; Line 122
	mov	DWORD PTR [eax], 0
; Line 123
	mov	ecx, DWORD PTR [esi+4]
	mov	eax, DWORD PTR _allorfirst$[esp]
	mov	DWORD PTR [ecx+4], eax
; Line 126
	mov	eax, esi
	pop	esi
; Line 137
	ret	0
$merr$16:
; Line 129
	push	129					; 00000081H
	push	OFFSET ??_C@_0BH@OGFIJJGB@?4?2crypto?2cms?2cms_ess?4c?$AA@
	push	65					; 00000041H
	push	159					; 0000009fH
	push	46					; 0000002eH
	call	_ERR_put_error
	add	esp, 20					; 00000014H
$err$17:
; Line 132
	test	esi, esi
	je	SHORT $LN13@CMS_Receip
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	esi
	call	_ASN1_item_free
	add	esp, 8
$LN13@CMS_Receip:
; Line 135
	xor	eax, eax
	pop	esi
; Line 137
	ret	0
_CMS_ReceiptRequest_create0 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_get1_ReceiptRequest
_TEXT	SEGMENT
_si$ = 8						; size = 4
_prr$ = 12						; size = 4
_CMS_get1_ReceiptRequest PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 72
	push	esi
; Line 75
	mov	esi, DWORD PTR _prr$[esp]
	push	edi
	test	esi, esi
	je	SHORT $LN2@CMS_get1_R
; Line 76
	mov	DWORD PTR [esi], 0
$LN2@CMS_get1_R:
; Line 77
	push	16					; 00000010H
	push	-3					; fffffffdH
	push	212					; 000000d4H
	call	_OBJ_nid2obj
	add	esp, 4
	push	eax
	push	DWORD PTR _si$[esp+16]
	call	_CMS_signed_get0_data_by_OBJ
	mov	edi, eax
	add	esp, 16					; 00000010H
; Line 81
	test	edi, edi
	jne	SHORT $LN3@CMS_get1_R
	pop	edi
	pop	esi
; Line 92
	ret	0
$LN3@CMS_get1_R:
; Line 84
	call	_CMS_ReceiptRequest_it
	push	eax
	push	edi
	call	_ASN1_item_unpack
	mov	edi, eax
	add	esp, 8
; Line 85
	test	edi, edi
	jne	SHORT $LN4@CMS_get1_R
; Line 86
	pop	edi
	or	eax, -1
	pop	esi
; Line 92
	ret	0
$LN4@CMS_get1_R:
; Line 87
	test	esi, esi
	je	SHORT $LN5@CMS_get1_R
; Line 88
	mov	DWORD PTR [esi], edi
; Line 91
	mov	eax, 1
	pop	edi
	pop	esi
; Line 92
	ret	0
$LN5@CMS_get1_R:
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	edi
	call	_ASN1_item_free
	add	esp, 8
; Line 91
	mov	eax, 1
	pop	edi
	pop	esi
; Line 92
	ret	0
_CMS_get1_ReceiptRequest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _i2d_CMS_ReceiptRequest
_TEXT	SEGMENT
_a$ = 8							; size = 4
_out$ = 12						; size = 4
_i2d_CMS_ReceiptRequest PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	DWORD PTR _out$[esp]
	push	DWORD PTR _a$[esp+4]
	call	_ASN1_item_i2d
	add	esp, 12					; 0000000cH
	ret	0
_i2d_CMS_ReceiptRequest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _d2i_CMS_ReceiptRequest
_TEXT	SEGMENT
_a$ = 8							; size = 4
_in$ = 12						; size = 4
_len$ = 16						; size = 4
_d2i_CMS_ReceiptRequest PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	DWORD PTR _len$[esp]
	push	DWORD PTR _in$[esp+4]
	push	DWORD PTR _a$[esp+8]
	call	_ASN1_item_d2i
	add	esp, 16					; 00000010H
	ret	0
_d2i_CMS_ReceiptRequest ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_ReceiptRequest_free
_TEXT	SEGMENT
_a$ = 8							; size = 4
_CMS_ReceiptRequest_free PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	push	DWORD PTR _a$[esp]
	call	_ASN1_item_free
	add	esp, 8
	ret	0
_CMS_ReceiptRequest_free ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _CMS_ReceiptRequest_new
_TEXT	SEGMENT
_CMS_ReceiptRequest_new PROC				; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\crypto\cms\cms_ess.c
; Line 67
	call	_CMS_ReceiptRequest_it
	push	eax
	call	_ASN1_item_new
	add	esp, 4
	ret	0
_CMS_ReceiptRequest_new ENDP
_TEXT	ENDS
END
