; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.23918.0 

	TITLE	C:\workpace\openssl\openssl-1.0.2h\apps\sess_id.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	??_C@_0BF@BDMGAIEO@usage?3?5sess_id?5args?6?$AA@ ; `string'
PUBLIC	??_C@_01EEMJAFIK@?6?$AA@			; `string'
PUBLIC	??_C@_0DM@PHNHJNIF@?5?9inform?5arg?5?5?5?5?5?9?5input?5format?5@ ; `string'
PUBLIC	??_C@_0DA@KKNGHCLN@?5?9outform?5arg?5?5?5?5?9?5output?5format@ ; `string'
PUBLIC	??_C@_0CP@OHCNNAMM@?5?9in?5arg?5?5?5?5?5?5?5?5?5?9?5input?5file?5?9?5@ ; `string'
PUBLIC	??_C@_0DB@EFLGJJDD@?5?9out?5arg?5?5?5?5?5?5?5?5?9?5output?5file?5?9@ ; `string'
PUBLIC	??_C@_0DB@BENOOIM@?5?9text?5?5?5?5?5?5?5?5?5?5?5?9?5print?5ssl?5ses@ ; `string'
PUBLIC	??_C@_0CI@KMODPHFL@?5?9cert?5?5?5?5?5?5?5?5?5?5?5?9?5output?5certif@ ; `string'
PUBLIC	??_C@_0CC@CIPJOIHG@?5?9noout?5?5?5?5?5?5?5?5?5?5?9?5no?5CRL?5output@ ; `string'
PUBLIC	??_C@_0CP@IBKOLAJP@?5?9context?5arg?5?5?5?5?9?5set?5the?5sessi@ ; `string'
;	COMDAT ??_C@_0CP@IBKOLAJP@?5?9context?5arg?5?5?5?5?9?5set?5the?5sessi@
CONST	SEGMENT
??_C@_0CP@IBKOLAJP@?5?9context?5arg?5?5?5?5?9?5set?5the?5sessi@ DB ' -con'
	DB	'text arg    - set the session ID context', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CC@CIPJOIHG@?5?9noout?5?5?5?5?5?5?5?5?5?5?9?5no?5CRL?5output@
CONST	SEGMENT
??_C@_0CC@CIPJOIHG@?5?9noout?5?5?5?5?5?5?5?5?5?5?9?5no?5CRL?5output@ DB ' '
	DB	'-noout          - no CRL output', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0CI@KMODPHFL@?5?9cert?5?5?5?5?5?5?5?5?5?5?5?9?5output?5certif@
CONST	SEGMENT
??_C@_0CI@KMODPHFL@?5?9cert?5?5?5?5?5?5?5?5?5?5?5?9?5output?5certif@ DB ' '
	DB	'-cert           - output certificate ', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DB@BENOOIM@?5?9text?5?5?5?5?5?5?5?5?5?5?5?9?5print?5ssl?5ses@
CONST	SEGMENT
??_C@_0DB@BENOOIM@?5?9text?5?5?5?5?5?5?5?5?5?5?5?9?5print?5ssl?5ses@ DB ' '
	DB	'-text           - print ssl session id details', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DB@EFLGJJDD@?5?9out?5arg?5?5?5?5?5?5?5?5?9?5output?5file?5?9@
CONST	SEGMENT
??_C@_0DB@EFLGJJDD@?5?9out?5arg?5?5?5?5?5?5?5?5?9?5output?5file?5?9@ DB ' '
	DB	'-out arg        - output file - default stdout', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CP@OHCNNAMM@?5?9in?5arg?5?5?5?5?5?5?5?5?5?9?5input?5file?5?9?5@
CONST	SEGMENT
??_C@_0CP@OHCNNAMM@?5?9in?5arg?5?5?5?5?5?5?5?5?5?9?5input?5file?5?9?5@ DB ' '
	DB	'-in arg         - input file - default stdin', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DA@KKNGHCLN@?5?9outform?5arg?5?5?5?5?9?5output?5format@
CONST	SEGMENT
??_C@_0DA@KKNGHCLN@?5?9outform?5arg?5?5?5?5?9?5output?5format@ DB ' -outf'
	DB	'orm arg    - output format - default PEM', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DM@PHNHJNIF@?5?9inform?5arg?5?5?5?5?5?9?5input?5format?5@
CONST	SEGMENT
??_C@_0DM@PHNHJNIF@?5?9inform?5arg?5?5?5?5?5?9?5input?5format?5@ DB ' -in'
	DB	'form arg     - input format - default PEM (DER or PEM)', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_01EEMJAFIK@?6?$AA@
CONST	SEGMENT
??_C@_01EEMJAFIK@?6?$AA@ DB 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BF@BDMGAIEO@usage?3?5sess_id?5args?6?$AA@
CONST	SEGMENT
??_C@_0BF@BDMGAIEO@usage?3?5sess_id?5args?6?$AA@ DB 'usage: sess_id args', 0aH
	DB	00H						; `string'
CONST	ENDS
_DATA	SEGMENT
_sess_id_usage DD FLAT:??_C@_0BF@BDMGAIEO@usage?3?5sess_id?5args?6?$AA@
	DD	FLAT:??_C@_01EEMJAFIK@?6?$AA@
	DD	FLAT:??_C@_0DM@PHNHJNIF@?5?9inform?5arg?5?5?5?5?5?9?5input?5format?5@
	DD	FLAT:??_C@_0DA@KKNGHCLN@?5?9outform?5arg?5?5?5?5?9?5output?5format@
	DD	FLAT:??_C@_0CP@OHCNNAMM@?5?9in?5arg?5?5?5?5?5?5?5?5?5?9?5input?5file?5?9?5@
	DD	FLAT:??_C@_0DB@EFLGJJDD@?5?9out?5arg?5?5?5?5?5?5?5?5?9?5output?5file?5?9@
	DD	FLAT:??_C@_0DB@BENOOIM@?5?9text?5?5?5?5?5?5?5?5?5?5?5?9?5print?5ssl?5ses@
	DD	FLAT:??_C@_0CI@KMODPHFL@?5?9cert?5?5?5?5?5?5?5?5?5?5?5?9?5output?5certif@
	DD	FLAT:??_C@_0CC@CIPJOIHG@?5?9noout?5?5?5?5?5?5?5?5?5?5?9?5no?5CRL?5output@
	DD	FLAT:??_C@_0CP@IBKOLAJP@?5?9context?5arg?5?5?5?5?9?5set?5the?5sessi@
	DD	00H
_DATA	ENDS
PUBLIC	_sess_id_main
PUBLIC	??_C@_07CGGPPMGB@?9inform?$AA@			; `string'
PUBLIC	??_C@_08LPHBEAIF@?9outform?$AA@			; `string'
PUBLIC	??_C@_03DAJLOBIG@?9in?$AA@			; `string'
PUBLIC	??_C@_04HKKABCEL@?9out?$AA@			; `string'
PUBLIC	??_C@_05OEBEIMJA@?9text?$AA@			; `string'
PUBLIC	??_C@_05DLEDECNE@?9cert?$AA@			; `string'
PUBLIC	??_C@_06JPEJAHHH@?9noout?$AA@			; `string'
PUBLIC	??_C@_08GKDHLPPP@?9context?$AA@			; `string'
PUBLIC	??_C@_0BD@NFDCLIJC@unknown?5option?5?$CFs?6?$AA@ ; `string'
PUBLIC	??_C@_02DKCKIIND@?$CFs?$AA@			; `string'
PUBLIC	??_C@_0BC@BDOGDMMH@Context?5too?5long?6?$AA@	; `string'
PUBLIC	??_C@_0BI@HMDHIFAM@No?5certificate?5present?6?$AA@ ; `string'
PUBLIC	??_C@_0CJ@JNEPIEPI@bad?5output?5format?5specified?5for?5@ ; `string'
PUBLIC	??_C@_0BN@GDLCILEA@unable?5to?5write?5SSL_SESSION?6?$AA@ ; `string'
PUBLIC	??_C@_0BG@BFGABFOE@unable?5to?5write?5X509?6?$AA@ ; `string'
PUBLIC	??_C@_0CK@DJFFGPOF@bad?5input?5format?5specified?5for?5i@ ; `string'
PUBLIC	??_C@_0BM@EEGJLEKP@unable?5to?5load?5SSL_SESSION?6?$AA@ ; `string'
EXTRN	__imp____acrt_iob_func:PROC
EXTRN	__imp__perror:PROC
EXTRN	_BIO_s_file:PROC
EXTRN	_BIO_new:PROC
EXTRN	_BIO_free:PROC
EXTRN	_BIO_puts:PROC
EXTRN	_BIO_ctrl:PROC
EXTRN	_BIO_free_all:PROC
EXTRN	_BIO_printf:PROC
EXTRN	_ASN1_d2i_bio:PROC
EXTRN	_ASN1_i2d_bio:PROC
EXTRN	_i2d_X509_bio:PROC
EXTRN	_X509_print:PROC
EXTRN	_ERR_print_errors:PROC
EXTRN	_ERR_load_crypto_strings:PROC
EXTRN	_str2fmt:PROC
EXTRN	_PEM_write_bio_X509:PROC
EXTRN	_PEM_read_bio_SSL_SESSION:PROC
EXTRN	_PEM_write_bio_SSL_SESSION:PROC
EXTRN	_SSL_SESSION_get0_peer:PROC
EXTRN	_SSL_SESSION_set1_id_context:PROC
EXTRN	_SSL_SESSION_new:PROC
EXTRN	_SSL_SESSION_print:PROC
EXTRN	_SSL_SESSION_free:PROC
EXTRN	_i2d_SSL_SESSION:PROC
EXTRN	_d2i_SSL_SESSION:PROC
EXTRN	__chkstk:PROC
EXTRN	_bio_err:DWORD
;	COMDAT ??_C@_0BM@EEGJLEKP@unable?5to?5load?5SSL_SESSION?6?$AA@
CONST	SEGMENT
??_C@_0BM@EEGJLEKP@unable?5to?5load?5SSL_SESSION?6?$AA@ DB 'unable to loa'
	DB	'd SSL_SESSION', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CK@DJFFGPOF@bad?5input?5format?5specified?5for?5i@
CONST	SEGMENT
??_C@_0CK@DJFFGPOF@bad?5input?5format?5specified?5for?5i@ DB 'bad input f'
	DB	'ormat specified for input crl', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@BFGABFOE@unable?5to?5write?5X509?6?$AA@
CONST	SEGMENT
??_C@_0BG@BFGABFOE@unable?5to?5write?5X509?6?$AA@ DB 'unable to write X50'
	DB	'9', 0aH, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BN@GDLCILEA@unable?5to?5write?5SSL_SESSION?6?$AA@
CONST	SEGMENT
??_C@_0BN@GDLCILEA@unable?5to?5write?5SSL_SESSION?6?$AA@ DB 'unable to wr'
	DB	'ite SSL_SESSION', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CJ@JNEPIEPI@bad?5output?5format?5specified?5for?5@
CONST	SEGMENT
??_C@_0CJ@JNEPIEPI@bad?5output?5format?5specified?5for?5@ DB 'bad output '
	DB	'format specified for outfile', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BI@HMDHIFAM@No?5certificate?5present?6?$AA@
CONST	SEGMENT
??_C@_0BI@HMDHIFAM@No?5certificate?5present?6?$AA@ DB 'No certificate pre'
	DB	'sent', 0aH, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BC@BDOGDMMH@Context?5too?5long?6?$AA@
CONST	SEGMENT
??_C@_0BC@BDOGDMMH@Context?5too?5long?6?$AA@ DB 'Context too long', 0aH, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_02DKCKIIND@?$CFs?$AA@
CONST	SEGMENT
??_C@_02DKCKIIND@?$CFs?$AA@ DB '%s', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@NFDCLIJC@unknown?5option?5?$CFs?6?$AA@
CONST	SEGMENT
??_C@_0BD@NFDCLIJC@unknown?5option?5?$CFs?6?$AA@ DB 'unknown option %s', 0aH
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_08GKDHLPPP@?9context?$AA@
CONST	SEGMENT
??_C@_08GKDHLPPP@?9context?$AA@ DB '-context', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_06JPEJAHHH@?9noout?$AA@
CONST	SEGMENT
??_C@_06JPEJAHHH@?9noout?$AA@ DB '-noout', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05DLEDECNE@?9cert?$AA@
CONST	SEGMENT
??_C@_05DLEDECNE@?9cert?$AA@ DB '-cert', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05OEBEIMJA@?9text?$AA@
CONST	SEGMENT
??_C@_05OEBEIMJA@?9text?$AA@ DB '-text', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04HKKABCEL@?9out?$AA@
CONST	SEGMENT
??_C@_04HKKABCEL@?9out?$AA@ DB '-out', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_03DAJLOBIG@?9in?$AA@
CONST	SEGMENT
??_C@_03DAJLOBIG@?9in?$AA@ DB '-in', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_08LPHBEAIF@?9outform?$AA@
CONST	SEGMENT
??_C@_08LPHBEAIF@?9outform?$AA@ DB '-outform', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_07CGGPPMGB@?9inform?$AA@
CONST	SEGMENT
??_C@_07CGGPPMGB@?9inform?$AA@ DB '-inform', 00H	; `string'
CONST	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _sess_id_main
_TEXT	SEGMENT
_cert$1$ = -36						; size = 4
_text$1$ = -32						; size = 4
_noout$1$ = -28						; size = 4
_outformat$1$ = -24					; size = 4
_infile$1$ = -20					; size = 4
_informat$1$ = -16					; size = 4
_context$1$ = -12					; size = 4
_outfile$1$ = -8					; size = 4
_ret$1$ = -4						; size = 4
_argc$ = 8						; size = 4
_argv$ = 12						; size = 4
_sess_id_main PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\apps\sess_id.c
; Line 91
	mov	eax, 36					; 00000024H
	call	__chkstk
	push	ebx
	push	ebp
	push	esi
; Line 97
	xor	esi, esi
	mov	DWORD PTR _ret$1$[esp+48], 1
	push	edi
	mov	DWORD PTR _infile$1$[esp+52], esi
	mov	DWORD PTR _outfile$1$[esp+52], esi
	mov	DWORD PTR _context$1$[esp+52], esi
; Line 98
	mov	DWORD PTR _cert$1$[esp+52], esi
	mov	DWORD PTR _noout$1$[esp+52], esi
	mov	DWORD PTR _text$1$[esp+52], esi
; Line 103
	cmp	DWORD PTR _bio_err, esi
	jne	SHORT $LN8@sess_id_ma
; Line 104
	call	_BIO_s_file
	push	eax
	call	_BIO_new
	add	esp, 4
	mov	DWORD PTR _bio_err, eax
	test	eax, eax
	je	SHORT $LN8@sess_id_ma
; Line 105
	push	2
	call	DWORD PTR __imp____acrt_iob_func
	push	eax
	push	16					; 00000010H
	push	106					; 0000006aH
	push	DWORD PTR _bio_err
	call	_BIO_ctrl
	add	esp, 20					; 00000014H
$LN8@sess_id_ma:
; Line 110
	mov	edi, DWORD PTR _argc$[esp+48]
; Line 112
	xor	ebp, ebp
	mov	ebx, DWORD PTR _argv$[esp+48]
	dec	edi
	add	ebx, 4
	mov	DWORD PTR _informat$1$[esp+52], 3
	mov	DWORD PTR _outformat$1$[esp+52], 3
; Line 113
	cmp	edi, 1
	jl	$LN30@sess_id_ma
$LL2@sess_id_ma:
; Line 114
	mov	esi, DWORD PTR [ebx]
	mov	ecx, OFFSET ??_C@_07CGGPPMGB@?9inform?$AA@
	mov	eax, esi
	npad	6
$LL74@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN75@sess_id_ma
	test	dl, dl
	je	SHORT $LN76@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN75@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL74@sess_id_ma
$LN76@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN77@sess_id_ma
$LN75@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN77@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN9@sess_id_ma
; Line 115
	dec	edi
	cmp	edi, 1
	jl	$bad$114
; Line 117
	push	DWORD PTR [ebx+4]
	add	ebx, 4
	call	_str2fmt
	add	esp, 4
	mov	DWORD PTR _informat$1$[esp+52], eax
	jmp	$LN28@sess_id_ma
$LN9@sess_id_ma:
; Line 118
	mov	ecx, OFFSET ??_C@_08LPHBEAIF@?9outform?$AA@
	mov	eax, esi
$LL78@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN79@sess_id_ma
	test	dl, dl
	je	SHORT $LN80@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN79@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL78@sess_id_ma
$LN80@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN81@sess_id_ma
$LN79@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN81@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN12@sess_id_ma
; Line 119
	dec	edi
	cmp	edi, 1
	jl	$bad$114
; Line 121
	push	DWORD PTR [ebx+4]
	add	ebx, 4
	call	_str2fmt
	add	esp, 4
	mov	DWORD PTR _outformat$1$[esp+52], eax
	jmp	$LN28@sess_id_ma
$LN12@sess_id_ma:
; Line 122
	mov	ecx, OFFSET ??_C@_03DAJLOBIG@?9in?$AA@
	mov	eax, esi
$LL82@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN83@sess_id_ma
	test	dl, dl
	je	SHORT $LN84@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN83@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL82@sess_id_ma
$LN84@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN85@sess_id_ma
$LN83@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN85@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN15@sess_id_ma
; Line 123
	dec	edi
	cmp	edi, 1
	jl	$bad$114
; Line 125
	mov	edx, DWORD PTR [ebx+4]
	add	ebx, 4
	mov	DWORD PTR _infile$1$[esp+52], edx
	jmp	$LN28@sess_id_ma
$LN15@sess_id_ma:
; Line 126
	mov	ecx, OFFSET ??_C@_04HKKABCEL@?9out?$AA@
	mov	eax, esi
	npad	5
$LL86@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN87@sess_id_ma
	test	dl, dl
	je	SHORT $LN88@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN87@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL86@sess_id_ma
$LN88@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN89@sess_id_ma
$LN87@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN89@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN18@sess_id_ma
; Line 127
	dec	edi
	cmp	edi, 1
	jl	$bad$114
; Line 129
	mov	edx, DWORD PTR [ebx+4]
	add	ebx, 4
	mov	DWORD PTR _outfile$1$[esp+52], edx
	jmp	$LN28@sess_id_ma
$LN18@sess_id_ma:
; Line 130
	mov	ecx, OFFSET ??_C@_05OEBEIMJA@?9text?$AA@
	mov	eax, esi
	npad	7
$LL90@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN91@sess_id_ma
	test	dl, dl
	je	SHORT $LN92@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN91@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL90@sess_id_ma
$LN92@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN93@sess_id_ma
$LN91@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN93@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN21@sess_id_ma
; Line 131
	inc	ebp
	mov	DWORD PTR _text$1$[esp+52], ebp
	jmp	$LN28@sess_id_ma
$LN21@sess_id_ma:
; Line 132
	mov	ecx, OFFSET ??_C@_05DLEDECNE@?9cert?$AA@
	mov	eax, esi
	npad	6
$LL94@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN95@sess_id_ma
	test	dl, dl
	je	SHORT $LN96@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN95@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL94@sess_id_ma
$LN96@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN97@sess_id_ma
$LN95@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN97@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN23@sess_id_ma
; Line 133
	inc	ebp
	mov	DWORD PTR _cert$1$[esp+52], ebp
	jmp	$LN28@sess_id_ma
$LN23@sess_id_ma:
; Line 134
	mov	ecx, OFFSET ??_C@_06JPEJAHHH@?9noout?$AA@
	mov	eax, esi
	npad	6
$LL98@sess_id_ma:
	mov	dl, BYTE PTR [eax]
	cmp	dl, BYTE PTR [ecx]
	jne	SHORT $LN99@sess_id_ma
	test	dl, dl
	je	SHORT $LN100@sess_id_ma
	mov	dl, BYTE PTR [eax+1]
	cmp	dl, BYTE PTR [ecx+1]
	jne	SHORT $LN99@sess_id_ma
	add	eax, 2
	add	ecx, 2
	test	dl, dl
	jne	SHORT $LL98@sess_id_ma
$LN100@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN101@sess_id_ma
$LN99@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN101@sess_id_ma:
	test	eax, eax
	jne	SHORT $LN25@sess_id_ma
; Line 135
	inc	ebp
	mov	DWORD PTR _noout$1$[esp+52], ebp
	jmp	SHORT $LN28@sess_id_ma
$LN25@sess_id_ma:
; Line 136
	mov	eax, OFFSET ??_C@_08GKDHLPPP@?9context?$AA@
$LL102@sess_id_ma:
	mov	cl, BYTE PTR [esi]
	cmp	cl, BYTE PTR [eax]
	jne	SHORT $LN103@sess_id_ma
	test	cl, cl
	je	SHORT $LN104@sess_id_ma
	mov	cl, BYTE PTR [esi+1]
	cmp	cl, BYTE PTR [eax+1]
	jne	SHORT $LN103@sess_id_ma
	add	esi, 2
	add	eax, 2
	test	cl, cl
	jne	SHORT $LL102@sess_id_ma
$LN104@sess_id_ma:
	xor	eax, eax
	jmp	SHORT $LN105@sess_id_ma
$LN103@sess_id_ma:
	sbb	eax, eax
	or	eax, 1
$LN105@sess_id_ma:
	test	eax, eax
	jne	$LN27@sess_id_ma
; Line 137
	dec	edi
	cmp	edi, 1
	jl	$bad$114
; Line 139
	mov	edx, DWORD PTR [ebx+4]
	add	ebx, 4
	mov	DWORD PTR _context$1$[esp+52], edx
$LN28@sess_id_ma:
; Line 145
	dec	edi
; Line 146
	add	ebx, 4
	cmp	edi, 1
	jge	$LL2@sess_id_ma
; Line 137
	mov	esi, DWORD PTR _infile$1$[esp+52]
$LN30@sess_id_ma:
; Line 156
	call	_ERR_load_crypto_strings
; Line 157
	push	DWORD PTR _informat$1$[esp+52]
	push	esi
	call	_load_sess_id
	mov	esi, eax
	add	esp, 8
; Line 158
	test	esi, esi
	je	$LN108@sess_id_ma
; Line 161
	push	esi
	call	_SSL_SESSION_get0_peer
; Line 163
	mov	ebx, DWORD PTR _context$1$[esp+56]
	add	esp, 4
	mov	edi, eax
	test	ebx, ebx
	je	$LN32@sess_id_ma
; Line 164
	mov	ecx, ebx
	lea	edx, DWORD PTR [ecx+1]
	npad	1
$LL106@sess_id_ma:
	mov	al, BYTE PTR [ecx]
	inc	ecx
	test	al, al
	jne	SHORT $LL106@sess_id_ma
	sub	ecx, edx
; Line 165
	cmp	ecx, 32					; 00000020H
	jbe	$LN33@sess_id_ma
; Line 166
	push	OFFSET ??_C@_0BC@BDOGDMMH@Context?5too?5long?6?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 8
; Line 258
	push	esi
	call	_SSL_SESSION_free
; Line 260
	mov	eax, DWORD PTR _ret$1$[esp+56]
	add	esp, 4
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 261
	add	esp, 36					; 00000024H
	ret	0
$LN27@sess_id_ma:
; Line 141
	push	DWORD PTR [ebx]
	push	OFFSET ??_C@_0BD@NFDCLIJC@unknown?5option?5?$CFs?6?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 12					; 0000000cH
$bad$114:
; Line 151
	mov	eax, DWORD PTR _sess_id_usage
	mov	esi, OFFSET _sess_id_usage
	test	eax, eax
	je	SHORT $LN108@sess_id_ma
	npad	3
$LL6@sess_id_ma:
; Line 152
	push	eax
	push	OFFSET ??_C@_02DKCKIIND@?$CFs?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	mov	eax, DWORD PTR [esi+4]
	lea	esi, DWORD PTR [esi+4]
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LL6@sess_id_ma
$LN108@sess_id_ma:
	pop	edi
	pop	esi
	pop	ebp
; Line 260
	mov	eax, 1
	pop	ebx
; Line 261
	add	esp, 36					; 00000024H
	ret	0
$LN33@sess_id_ma:
; Line 169
	push	ecx
	push	ebx
	push	esi
	call	_SSL_SESSION_set1_id_context
	add	esp, 12					; 0000000cH
$LN32@sess_id_ma:
; Line 192
	cmp	DWORD PTR _noout$1$[esp+52], 0
	je	SHORT $LN35@sess_id_ma
	cmp	DWORD PTR _text$1$[esp+52], 0
	je	$LN109@sess_id_ma
$LN35@sess_id_ma:
; Line 193
	call	_BIO_s_file
	push	eax
	call	_BIO_new
	mov	ebx, eax
	add	esp, 4
; Line 194
	test	ebx, ebx
	jne	SHORT $LN36@sess_id_ma
; Line 195
	push	DWORD PTR _bio_err
	call	_ERR_print_errors
; Line 256
	add	esp, 4
; Line 258
	push	esi
	call	_SSL_SESSION_free
; Line 260
	mov	eax, DWORD PTR _ret$1$[esp+56]
	add	esp, 4
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 261
	add	esp, 36					; 00000024H
	ret	0
$LN36@sess_id_ma:
; Line 199
	mov	ebp, DWORD PTR _outfile$1$[esp+52]
	test	ebp, ebp
	jne	SHORT $LN37@sess_id_ma
; Line 200
	push	1
	call	DWORD PTR __imp____acrt_iob_func
	push	eax
	push	ebp
	push	106					; 0000006aH
	push	ebx
	call	_BIO_ctrl
	add	esp, 20					; 00000014H
$LN39@sess_id_ma:
; Line 215
	cmp	DWORD PTR _text$1$[esp+52], 0
	je	SHORT $LN110@sess_id_ma
; Line 216
	push	esi
	push	ebx
	call	_SSL_SESSION_print
; Line 218
	mov	eax, DWORD PTR _cert$1$[esp+60]
	add	esp, 8
	test	eax, eax
	je	SHORT $LN43@sess_id_ma
; Line 219
	test	edi, edi
	jne	SHORT $LN42@sess_id_ma
; Line 220
	push	OFFSET ??_C@_0BI@HMDHIFAM@No?5certificate?5present?6?$AA@
	push	ebx
	call	_BIO_puts
	add	esp, 8
	jmp	SHORT $LN110@sess_id_ma
$LN37@sess_id_ma:
; Line 208
	push	ebp
	push	5
	push	108					; 0000006cH
	push	ebx
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	test	eax, eax
	jg	SHORT $LN39@sess_id_ma
; Line 209
	push	ebp
	call	DWORD PTR __imp__perror
	add	esp, 4
; Line 210
	jmp	$end$115
$LN42@sess_id_ma:
; Line 222
	push	edi
	push	ebx
	call	_X509_print
	add	esp, 8
	jmp	SHORT $LN110@sess_id_ma
$LN109@sess_id_ma:
	xor	ebx, ebx
$LN110@sess_id_ma:
	mov	eax, DWORD PTR _cert$1$[esp+52]
$LN43@sess_id_ma:
; Line 226
	cmp	DWORD PTR _noout$1$[esp+52], 0
	jne	$LN56@sess_id_ma
	test	eax, eax
	jne	SHORT $LN73@sess_id_ma
; Line 227
	mov	eax, DWORD PTR _outformat$1$[esp+52]
	cmp	eax, 1
	jne	SHORT $LN46@sess_id_ma
; Line 228
	push	esi
	push	ebx
	push	OFFSET _i2d_SSL_SESSION
	call	_ASN1_i2d_bio
	add	esp, 12					; 0000000cH
	jmp	SHORT $LN49@sess_id_ma
$LN46@sess_id_ma:
; Line 229
	cmp	eax, 3
	jne	SHORT $LN48@sess_id_ma
; Line 230
	push	esi
	push	ebx
	call	_PEM_write_bio_SSL_SESSION
	add	esp, 8
$LN49@sess_id_ma:
; Line 235
	test	eax, eax
	jne	SHORT $LN56@sess_id_ma
; Line 236
	push	OFFSET ??_C@_0BN@GDLCILEA@unable?5to?5write?5SSL_SESSION?6?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 8
; Line 237
	jmp	SHORT $end$115
$LN48@sess_id_ma:
; Line 232
	push	OFFSET ??_C@_0CJ@JNEPIEPI@bad?5output?5format?5specified?5for?5@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 8
; Line 233
	jmp	SHORT $end$115
$LN73@sess_id_ma:
; Line 239
	test	edi, edi
	je	SHORT $LN56@sess_id_ma
; Line 240
	mov	eax, DWORD PTR _outformat$1$[esp+52]
	cmp	eax, 1
	jne	SHORT $LN52@sess_id_ma
; Line 241
	push	edi
	push	ebx
	call	_i2d_X509_bio
	jmp	SHORT $LN112@sess_id_ma
$LN52@sess_id_ma:
; Line 242
	cmp	eax, 3
	jne	SHORT $LN48@sess_id_ma
; Line 243
	push	edi
	push	ebx
	call	_PEM_write_bio_X509
$LN112@sess_id_ma:
	add	esp, 8
; Line 248
	test	eax, eax
	jne	SHORT $LN56@sess_id_ma
; Line 249
	push	OFFSET ??_C@_0BG@BFGABFOE@unable?5to?5write?5X509?6?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 8
; Line 250
	jmp	SHORT $end$115
$LN56@sess_id_ma:
; Line 253
	mov	DWORD PTR _ret$1$[esp+52], 0
$end$115:
; Line 255
	test	ebx, ebx
	je	SHORT $LN57@sess_id_ma
; Line 256
	push	ebx
	call	_BIO_free_all
	add	esp, 4
$LN57@sess_id_ma:
; Line 258
	push	esi
	call	_SSL_SESSION_free
; Line 260
	mov	eax, DWORD PTR _ret$1$[esp+56]
	add	esp, 4
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
; Line 261
	add	esp, 36					; 00000024H
	ret	0
_sess_id_main ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
;	COMDAT _load_sess_id
_TEXT	SEGMENT
_infile$ = 8						; size = 4
_format$ = 12						; size = 4
_load_sess_id PROC					; COMDAT
; File c:\workpace\openssl\openssl-1.0.2h\apps\sess_id.c
; Line 264
	push	esi
	push	edi
; Line 265
	xor	edi, edi
; Line 268
	call	_BIO_s_file
	push	eax
	call	_BIO_new
	mov	esi, eax
	add	esp, 4
; Line 269
	test	esi, esi
	jne	SHORT $LN2@load_sess_
; Line 270
	push	DWORD PTR _bio_err
	call	_ERR_print_errors
	add	esp, 4
; Line 299
	mov	eax, edi
	pop	edi
	pop	esi
; Line 300
	ret	0
$LN2@load_sess_:
	push	ebx
; Line 274
	mov	ebx, DWORD PTR _infile$[esp+8]
	test	ebx, ebx
	jne	SHORT $LN3@load_sess_
; Line 275
	push	ebx
	call	DWORD PTR __imp____acrt_iob_func
	push	eax
	push	ebx
	push	106					; 0000006aH
	push	esi
	call	_BIO_ctrl
	add	esp, 20					; 00000014H
$LN5@load_sess_:
; Line 282
	mov	eax, DWORD PTR _format$[esp+8]
	cmp	eax, 1
	jne	SHORT $LN6@load_sess_
; Line 283
	push	0
	push	esi
	push	OFFSET _d2i_SSL_SESSION
	push	OFFSET _SSL_SESSION_new
	call	_ASN1_d2i_bio
	jmp	SHORT $LN14@load_sess_
$LN3@load_sess_:
; Line 277
	push	ebx
	push	3
	push	108					; 0000006cH
	push	esi
	call	_BIO_ctrl
	add	esp, 16					; 00000010H
	test	eax, eax
	jg	SHORT $LN5@load_sess_
; Line 278
	push	ebx
	call	DWORD PTR __imp__perror
	add	esp, 4
; Line 298
	push	esi
	call	_BIO_free
	add	esp, 4
; Line 299
	mov	eax, edi
	pop	ebx
	pop	edi
	pop	esi
; Line 300
	ret	0
$LN6@load_sess_:
; Line 284
	cmp	eax, 3
	jne	SHORT $LN8@load_sess_
; Line 285
	push	0
	push	0
	push	0
	push	esi
	call	_PEM_read_bio_SSL_SESSION
$LN14@load_sess_:
	mov	edi, eax
	add	esp, 16					; 00000010H
; Line 290
	test	edi, edi
	jne	SHORT $end$16
; Line 291
	push	OFFSET ??_C@_0BM@EEGJLEKP@unable?5to?5load?5SSL_SESSION?6?$AA@
	push	DWORD PTR _bio_err
	call	_BIO_printf
; Line 292
	push	DWORD PTR _bio_err
	call	_ERR_print_errors
	add	esp, 12					; 0000000cH
; Line 298
	push	esi
	call	_BIO_free
	add	esp, 4
; Line 299
	mov	eax, edi
	pop	ebx
	pop	edi
	pop	esi
; Line 300
	ret	0
$LN8@load_sess_:
; Line 287
	push	OFFSET ??_C@_0CK@DJFFGPOF@bad?5input?5format?5specified?5for?5i@
	push	DWORD PTR _bio_err
	call	_BIO_printf
	add	esp, 8
$end$16:
; Line 298
	push	esi
	call	_BIO_free
	add	esp, 4
; Line 299
	mov	eax, edi
	pop	ebx
	pop	edi
	pop	esi
; Line 300
	ret	0
_load_sess_id ENDP
_TEXT	ENDS
END
