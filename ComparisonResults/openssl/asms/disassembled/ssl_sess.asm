;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	9B9798E392D0CFFA040C7B84E5352C21
; Input	CRC32 :	1DB43C90

; File Name   :	C:\compspace\Diff\openssl\obj\ssl_sess.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PEM_read_SSL_SESSION
_PEM_read_SSL_SESSION proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	offset ??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@	; "SSL SESSION PARAMETERS"
		push	offset _d2i_SSL_SESSION
		call	_PEM_ASN1_read
		add	esp, 18h
		retn
_PEM_read_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 24h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PEM_read_bio_SSL_SESSION
_PEM_read_bio_SSL_SESSION proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	offset ??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@	; "SSL SESSION PARAMETERS"
		push	offset _d2i_SSL_SESSION
		call	_PEM_ASN1_read_bio
		add	esp, 18h
		retn
_PEM_read_bio_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 48h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PEM_write_SSL_SESSION
_PEM_write_SSL_SESSION proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	0
		push	0
		push	0
		push	0
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_0]
		push	offset ??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@	; "SSL SESSION PARAMETERS"
		push	offset _i2d_SSL_SESSION
		call	_PEM_ASN1_write
		add	esp, 24h
		retn
_PEM_write_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 70h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PEM_write_bio_SSL_SESSION
_PEM_write_bio_SSL_SESSION proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	0
		push	0
		push	0
		push	0
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_0]
		push	offset ??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@	; "SSL SESSION PARAMETERS"
		push	offset _i2d_SSL_SESSION
		call	_PEM_ASN1_write_bio
		add	esp, 24h
		retn
_PEM_write_bio_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_add_session
_SSL_CTX_add_session proc near		; CODE XREF: _ssl_get_prev_session+1D6p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		push	edi
		push	2ECh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		lea	eax, [ebx+0A4h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		push	2F1h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	9
		call	_CRYPTO_lock
		mov	edi, [esp+34h+arg_0]
		push	ebx
		push	dword ptr [edi+10h]
		call	_lh_insert
		mov	esi, eax
		add	esp, 2Ch
		test	esi, esi
		jz	short loc_F9
		cmp	esi, ebx
		jz	short loc_107
		push	esi
		push	edi
		call	_SSL_SESSION_list_remove
		push	esi
		call	_SSL_SESSION_free
		add	esp, 0Ch
		xor	esi, esi

loc_F9:					; CODE XREF: _SSL_CTX_add_session+49j
		push	ebx
		push	edi
		call	_SSL_SESSION_list_add
		add	esp, 8
		test	esi, esi
		jz	short loc_117

loc_107:				; CODE XREF: _SSL_CTX_add_session+4Dj
		push	esi
		call	_SSL_SESSION_free
		add	esp, 4
		xor	ebp, ebp
		jmp	loc_1C8
; ---------------------------------------------------------------------------

loc_117:				; CODE XREF: _SSL_CTX_add_session+6Dj
		push	0
		push	0
		push	2Bh ; '+'
		push	edi
		mov	ebp, 1
		call	_SSL_CTX_ctrl
		add	esp, 10h
		test	eax, eax
		jle	loc_1C8
		push	0
		push	0
		push	2Bh ; '+'
		push	edi
		call	_SSL_CTX_ctrl
		push	0
		push	0
		push	14h
		push	edi
		mov	esi, eax
		call	_SSL_CTX_ctrl
		add	esp, 20h
		cmp	eax, esi
		jle	short loc_1C8
		nop	dword ptr [eax+00h]

loc_158:				; CODE XREF: _SSL_CTX_add_session+12Ej
		mov	esi, [edi+1Ch]
		test	esi, esi
		jz	short loc_1C8
		cmp	dword ptr [esi+44h], 0
		jz	short loc_1C8
		push	esi
		push	dword ptr [edi+10h]
		call	_lh_retrieve
		add	esp, 8
		cmp	eax, esi
		jnz	short loc_1C8
		push	esi
		push	dword ptr [edi+10h]
		call	_lh_delete
		push	esi
		push	edi
		mov	ebx, eax
		call	_SSL_SESSION_list_remove
		mov	[ebx+94h], ebp
		add	esp, 10h
		mov	eax, [edi+2Ch]
		test	eax, eax
		jz	short loc_19E
		push	ebx
		push	edi
		call	eax
		add	esp, 8

loc_19E:				; CODE XREF: _SSL_CTX_add_session+FDj
		push	ebx
		call	_SSL_SESSION_free
		inc	dword ptr [edi+54h]
		push	0
		push	0
		push	2Bh ; '+'
		push	edi
		call	_SSL_CTX_ctrl
		push	0
		push	0
		push	14h
		push	edi
		mov	esi, eax
		call	_SSL_CTX_ctrl
		add	esp, 24h
		cmp	eax, esi
		jg	short loc_158

loc_1C8:				; CODE XREF: _SSL_CTX_add_session+7Aj
					; _SSL_CTX_add_session+95j ...
		push	323h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
_SSL_CTX_add_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_flush_sessions
_SSL_CTX_flush_sessions	proc near

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 0Ch
		call	__chkstk
		mov	eax, [esp+0Ch+arg_0]
		mov	[esp+0Ch+var_C], eax
		mov	eax, [eax+10h]
		mov	[esp+0Ch+var_4], eax
		test	eax, eax
		jz	short loc_25F
		mov	eax, [esp+0Ch+arg_4]
		push	esi
		push	458h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	9
		mov	[esp+20h+var_8], eax
		call	_CRYPTO_lock
		mov	eax, [esp+20h+var_4]
		mov	esi, [eax+20h]
		mov	dword ptr [eax+20h], 0
		lea	eax, [esp+20h+var_C]
		push	eax
		push	offset _timeout_LHASH_DOALL_ARG
		push	[esp+28h+var_4]
		call	_lh_doall_arg
		mov	eax, [esp+2Ch+var_4]
		push	45Eh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	0Ah
		mov	[eax+20h], esi
		call	_CRYPTO_lock
		add	esp, 2Ch
		pop	esi

loc_25F:				; CODE XREF: _SSL_CTX_flush_sessions+1Aj
		add	esp, 0Ch
		retn
_SSL_CTX_flush_sessions	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 264h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_get_client_cert_cb
_SSL_CTX_get_client_cert_cb proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+74h]
		retn
_SSL_CTX_get_client_cert_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 26Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_get_info_callback
_SSL_CTX_get_info_callback proc	near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+9Ch]
		retn
_SSL_CTX_get_info_callback endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 278h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_get_timeout
_SSL_CTX_get_timeout proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_281
		retn
; ---------------------------------------------------------------------------

loc_281:				; CODE XREF: _SSL_CTX_get_timeout+6j
		mov	eax, [eax+24h]
		retn
_SSL_CTX_get_timeout endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 288h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_remove_session
_SSL_CTX_remove_session	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	1
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_remove_session_lock
		add	esp, 0Ch
		retn
_SSL_CTX_remove_session	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 29Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_get_get_cb
_SSL_CTX_sess_get_get_cb proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+30h]
		retn
_SSL_CTX_sess_get_get_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_get_new_cb
_SSL_CTX_sess_get_new_cb proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+28h]
		retn
_SSL_CTX_sess_get_new_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_get_remove_cb
_SSL_CTX_sess_get_remove_cb proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+2Ch]
		retn
_SSL_CTX_sess_get_remove_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_set_get_cb
_SSL_CTX_sess_set_get_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+30h], ecx
		retn
_SSL_CTX_sess_set_get_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_set_new_cb
_SSL_CTX_sess_set_new_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+28h], ecx
		retn
_SSL_CTX_sess_set_new_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_sess_set_remove_cb
_SSL_CTX_sess_set_remove_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+2Ch], ecx
		retn
_SSL_CTX_sess_set_remove_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_client_cert_cb
_SSL_CTX_set_client_cert_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+74h], ecx
		retn
_SSL_CTX_set_client_cert_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_client_cert_engine
_SSL_CTX_set_client_cert_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		call	_ENGINE_init
		add	esp, 4
		test	eax, eax
		jnz	short loc_315
		push	4DBh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	26h ; '&'
		push	122h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_315:				; CODE XREF: _SSL_CTX_set_client_cert_engine+10j
		push	esi
		call	_ENGINE_get_ssl_client_cert_function
		add	esp, 4
		test	eax, eax
		jnz	short loc_34A
		push	4E0h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	14Bh
		push	122h
		push	14h
		call	_ERR_put_error
		push	esi
		call	_ENGINE_finish
		add	esp, 18h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_34A:				; CODE XREF: _SSL_CTX_set_client_cert_engine+3Cj
		mov	eax, [esp+4+arg_0]
		mov	[eax+0FCh], esi
		mov	eax, 1
		pop	esi
		retn
_SSL_CTX_set_client_cert_engine	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 35Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_cookie_generate_cb
_SSL_CTX_set_cookie_generate_cb	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+78h], ecx
		retn
_SSL_CTX_set_cookie_generate_cb	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 368h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_cookie_verify_cb
_SSL_CTX_set_cookie_verify_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+7Ch], ecx
		retn
_SSL_CTX_set_cookie_verify_cb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 374h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_info_callback
_SSL_CTX_set_info_callback proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+9Ch], ecx
		retn
_SSL_CTX_set_info_callback endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 384h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_CTX_set_timeout
_SSL_CTX_set_timeout proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		test	edx, edx
		jnz	short loc_38F
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_38F:				; CODE XREF: _SSL_CTX_set_timeout+6j
		mov	eax, [edx+24h]
		mov	ecx, [esp+arg_4]
		mov	[edx+24h], ecx
		retn
_SSL_CTX_set_timeout endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 39Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_free
_SSL_SESSION_free proc near		; CODE XREF: _SSL_CTX_add_session+57p
					; _SSL_CTX_add_session+70p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	loc_4E7
		push	34Fh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		lea	eax, [esi+0A4h]
		push	0FFFFFFFFh
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h
		test	eax, eax
		jg	loc_4E7
		lea	eax, [esi+0C0h]
		push	eax
		push	esi
		push	3
		call	_CRYPTO_free_ex_data
		lea	eax, [esi+8]
		push	8
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esi+14h]
		push	30h ; '0'
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esi+48h]
		push	20h ; ' '
		push	eax
		call	_OPENSSL_cleanse
		mov	eax, [esi+98h]
		add	esp, 24h
		test	eax, eax
		jz	short loc_414
		push	eax
		call	_ssl_sess_cert_free
		add	esp, 4

loc_414:				; CODE XREF: _SSL_SESSION_free+6Dj
		mov	eax, [esi+9Ch]
		test	eax, eax
		jz	short loc_427
		push	eax
		call	_X509_free
		add	esp, 4

loc_427:				; CODE XREF: _SSL_SESSION_free+80j
		mov	eax, [esi+0BCh]
		test	eax, eax
		jz	short loc_43A
		push	eax
		call	_sk_free
		add	esp, 4

loc_43A:				; CODE XREF: _SSL_SESSION_free+93j
		mov	eax, [esi+0D0h]
		test	eax, eax
		jz	short loc_44D
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_44D:				; CODE XREF: _SSL_SESSION_free+A6j
		mov	eax, [esi+0E4h]
		test	eax, eax
		jz	short loc_460
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_460:				; CODE XREF: _SSL_SESSION_free+B9j
		mov	eax, [esi+0D8h]
		mov	dword ptr [esi+0D4h], 0
		test	eax, eax
		jz	short loc_47D
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_47D:				; CODE XREF: _SSL_SESSION_free+D6j
		mov	eax, [esi+0E0h]
		mov	dword ptr [esi+0DCh], 0
		test	eax, eax
		jz	short loc_49A
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_49A:				; CODE XREF: _SSL_SESSION_free+F3j
		mov	eax, [esi+8Ch]
		test	eax, eax
		jz	short loc_4AD
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4AD:				; CODE XREF: _SSL_SESSION_free+106j
		mov	eax, [esi+90h]
		test	eax, eax
		jz	short loc_4C0
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4C0:				; CODE XREF: _SSL_SESSION_free+119j
		mov	eax, [esi+0F0h]
		test	eax, eax
		jz	short loc_4D3
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4D3:				; CODE XREF: _SSL_SESSION_free+12Cj
		push	0F4h ; 'ô'
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		add	esp, 0Ch

loc_4E7:				; CODE XREF: _SSL_SESSION_free+7j
					; _SSL_SESSION_free+2Cj
		pop	esi
		retn
_SSL_SESSION_free endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get0_peer
_SSL_SESSION_get0_peer proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+9Ch]
		retn
_SSL_SESSION_get0_peer endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_compress_id
_SSL_SESSION_get_compress_id proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+0B0h]
		retn
_SSL_SESSION_get_compress_id endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 504h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_ex_data
_SSL_SESSION_get_ex_data proc near

arg_0		= dword	ptr  4

		add	[esp+arg_0], 0C0h ; 'À'
		jmp	_CRYPTO_get_ex_data
_SSL_SESSION_get_ex_data endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 514h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_ex_new_index
_SSL_SESSION_get_ex_new_index proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		push	3
		call	_CRYPTO_get_ex_new_index
		add	esp, 18h
		retn
_SSL_SESSION_get_ex_new_index endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 534h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_id
_SSL_SESSION_get_id proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		test	edx, edx
		jz	short loc_549
		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+44h]
		mov	[edx], eax
		lea	eax, [ecx+48h]
		retn
; ---------------------------------------------------------------------------

loc_549:				; CODE XREF: _SSL_SESSION_get_id+6j
		mov	eax, [esp+arg_0]
		add	eax, 48h ; 'H'
		retn
_SSL_SESSION_get_id endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 554h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_time
_SSL_SESSION_get_time proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_55D
		retn
; ---------------------------------------------------------------------------

loc_55D:				; CODE XREF: _SSL_SESSION_get_time+6j
		mov	eax, [eax+0ACh]
		retn
_SSL_SESSION_get_time endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 564h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_get_timeout
_SSL_SESSION_get_timeout proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_56D
		retn
; ---------------------------------------------------------------------------

loc_56D:				; CODE XREF: _SSL_SESSION_get_timeout+6j
		mov	eax, [eax+0A8h]
		retn
_SSL_SESSION_get_timeout endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 574h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_SSL_SESSION_list_add proc near		; CODE XREF: _SSL_CTX_add_session+63p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	dword ptr [esi+0CCh], 0
		jz	short loc_59A
		cmp	dword ptr [esi+0C8h], 0
		jz	short loc_59A
		push	esi
		push	edi
		call	_SSL_SESSION_list_remove
		add	esp, 8

loc_59A:				; CODE XREF: _SSL_SESSION_list_add+11j
					; _SSL_SESSION_list_add+1Aj
		mov	eax, [edi+18h]
		lea	ecx, [edi+18h]
		test	eax, eax
		jnz	short loc_5BA
		lea	eax, [edi+1Ch]
		mov	[ecx], esi
		mov	[eax], esi
		pop	edi
		mov	[esi+0C8h], ecx
		mov	[esi+0CCh], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_5BA:				; CODE XREF: _SSL_SESSION_list_add+2Ej
		mov	[esi+0CCh], eax
		mov	[eax+0C8h], esi
		mov	[esi+0C8h], ecx
		pop	edi
		mov	[ecx], esi
		pop	esi
		retn
_SSL_SESSION_list_add endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_SSL_SESSION_list_remove proc near	; CODE XREF: _SSL_CTX_add_session+51p
					; _SSL_CTX_add_session+EAp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		mov	ecx, [edx+0CCh]
		test	ecx, ecx
		jz	locret_667
		mov	eax, [edx+0C8h]
		test	eax, eax
		jz	short locret_667
		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		lea	esi, [edi+1Ch]
		cmp	ecx, esi
		jnz	short loc_622
		add	edi, 18h
		cmp	eax, edi
		jnz	short loc_612
		mov	dword ptr [edi], 0
		mov	dword ptr [esi], 0
		jmp	short loc_651
; ---------------------------------------------------------------------------

loc_612:				; CODE XREF: _SSL_SESSION_list_remove+2Ej
		mov	[esi], eax
		mov	eax, [edx+0C8h]
		mov	[eax+0CCh], esi
		jmp	short loc_651
; ---------------------------------------------------------------------------

loc_622:				; CODE XREF: _SSL_SESSION_list_remove+27j
		lea	esi, [edi+18h]
		cmp	eax, esi
		jnz	short loc_639
		mov	[esi], ecx
		mov	eax, [edx+0CCh]
		mov	[eax+0C8h], esi
		jmp	short loc_651
; ---------------------------------------------------------------------------

loc_639:				; CODE XREF: _SSL_SESSION_list_remove+53j
		mov	[ecx+0C8h], eax
		mov	ecx, [edx+0C8h]
		mov	eax, [edx+0CCh]
		mov	[ecx+0CCh], eax

loc_651:				; CODE XREF: _SSL_SESSION_list_remove+3Cj
					; _SSL_SESSION_list_remove+4Cj	...
		pop	edi
		mov	dword ptr [edx+0CCh], 0
		mov	dword ptr [edx+0C8h], 0
		pop	esi

locret_667:				; CODE XREF: _SSL_SESSION_list_remove+Cj
					; _SSL_SESSION_list_remove+1Aj
		retn
_SSL_SESSION_list_remove endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 668h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_new
_SSL_SESSION_new proc near		; CODE XREF: _ssl_get_new_session+Bp
		push	esi
		push	0C4h ; 'Ä'
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0F4h ; 'ô'
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_6A5
		push	0C6h ; 'Æ'
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	41h ; 'A'
		push	0BDh ; '½'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_6A5:				; CODE XREF: _SSL_SESSION_new+1Cj
		push	0F4h ; 'ô'      ; Size
		push	0		; Val
		push	esi		; Dst
		call	_memset
		push	0		; Time
		mov	dword ptr [esi+0A0h], 1
		mov	dword ptr [esi+0A4h], 1
		mov	dword ptr [esi+0A8h], 130h
		call	dword ptr ds:__imp___time64
		mov	[esi+0ACh], eax
		lea	eax, [esi+0C0h]
		push	eax
		push	esi
		push	3
		mov	dword ptr [esi+0C8h], 0
		mov	dword ptr [esi+0CCh], 0
		mov	dword ptr [esi+0B0h], 0
		mov	dword ptr [esi+0D0h], 0
		mov	dword ptr [esi+0D4h], 0
		mov	dword ptr [esi+0D8h], 0
		mov	dword ptr [esi+0DCh], 0
		mov	dword ptr [esi+0E0h], 0
		call	_CRYPTO_new_ex_data
		add	esp, 1Ch
		mov	dword ptr [esi+8Ch], 0
		mov	dword ptr [esi+90h], 0
		mov	eax, esi
		mov	dword ptr [esi+0F0h], 0
		pop	esi
		retn
_SSL_SESSION_new endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 764h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_SESSION_set1_id_context(int, void *Src, size_t Size)
		public _SSL_SESSION_set1_id_context
_SSL_SESSION_set1_id_context proc near

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		mov	ecx, [esp+Size]
		cmp	ecx, 20h ; ' '
		jbe	short loc_78E
		push	3E0h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	111h
		push	138h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_78E:				; CODE XREF: _SSL_SESSION_set1_id_context+7j
		mov	eax, [esp+arg_0]
		push	ecx		; Size
		push	[esp+4+Src]	; Src
		mov	[eax+68h], ecx
		add	eax, 6Ch ; 'l'
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	eax, 1
		retn
_SSL_SESSION_set1_id_context endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_set_ex_data
_SSL_SESSION_set_ex_data proc near

arg_0		= dword	ptr  4

		add	[esp+arg_0], 0C0h ; 'À'
		jmp	_CRYPTO_set_ex_data
_SSL_SESSION_set_ex_data endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_set_time
_SSL_SESSION_set_time proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_7C7
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_7C7:				; CODE XREF: _SSL_SESSION_set_time+6j
		mov	eax, [esp+arg_4]
		mov	[ecx+0ACh], eax
		retn
_SSL_SESSION_set_time endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_SESSION_set_timeout
_SSL_SESSION_set_timeout proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_7DF
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_7DF:				; CODE XREF: _SSL_SESSION_set_timeout+6j
		mov	eax, [esp+arg_4]
		mov	[ecx+0A8h], eax
		mov	eax, 1
		retn
_SSL_SESSION_set_timeout endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_get1_session
_SSL_get1_session proc near

arg_0		= dword	ptr  4

		push	esi
		push	0A5h ; '¥'
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, [esp+14h+arg_0]
		add	esp, 10h
		mov	esi, [eax+0C0h]
		test	esi, esi
		jz	short loc_81B
		inc	dword ptr [esi+0A4h]

loc_81B:				; CODE XREF: _SSL_get1_session+23j
		push	0A9h ; '©'
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, esi
		pop	esi
		retn
_SSL_get1_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 838h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_get_session
_SSL_get_session proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+0C0h]
		retn
_SSL_get_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 844h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_set_session
_SSL_set_session proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		test	esi, esi
		jz	loc_8FD
		mov	edi, [esp+8+arg_0]
		push	dword ptr [esi]
		mov	eax, [edi+0E4h]
		mov	eax, [eax]
		mov	eax, [eax+5Ch]
		call	eax
		add	esp, 4
		test	eax, eax
		jnz	short loc_8A0
		mov	eax, [edi+8]
		push	dword ptr [esi]
		mov	eax, [eax+5Ch]
		call	eax
		add	esp, 4
		test	eax, eax
		jnz	short loc_8A0
		push	38Dh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0F0h ; 'ð'
		push	0C3h ; 'Ã'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_89B:				; CODE XREF: _SSL_set_session+6Dj
					; _SSL_set_session+F3j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_8A0:				; CODE XREF: _SSL_set_session+26j
					; _SSL_set_session+37j
		cmp	eax, [edi+8]
		jz	short loc_8B3
		push	eax
		push	edi
		call	_SSL_set_ssl_method
		add	esp, 8
		test	eax, eax
		jz	short loc_89B

loc_8B3:				; CODE XREF: _SSL_set_session+5Fj
		push	3A1h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		lea	eax, [esi+0A4h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [edi+0C0h]
		add	esp, 14h
		test	eax, eax
		jz	short loc_8E3
		push	eax
		call	_SSL_SESSION_free
		add	esp, 4

loc_8E3:				; CODE XREF: _SSL_set_session+94j
		mov	[edi+0C0h], esi
		mov	eax, [esi+0A0h]
		mov	[edi+0ECh], eax
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_8FD:				; CODE XREF: _SSL_set_session+8j
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+0C0h]
		test	eax, eax
		jz	short loc_91E
		push	eax
		call	_SSL_SESSION_free
		add	esp, 4
		mov	dword ptr [esi+0C0h], 0

loc_91E:				; CODE XREF: _SSL_set_session+C5j
		mov	eax, [esi+0E4h]
		mov	eax, [eax]
		cmp	eax, [esi+8]
		jz	short loc_93D
		push	eax
		push	esi
		call	_SSL_set_ssl_method
		add	esp, 8
		test	eax, eax
		jz	loc_89B

loc_93D:				; CODE XREF: _SSL_set_session+E5j
		pop	edi
		mov	eax, 1
		pop	esi
		retn
_SSL_set_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 948h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_set_session_secret_cb
_SSL_set_session_secret_cb proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_953
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_953:				; CODE XREF: _SSL_set_session_secret_cb+6j
		mov	eax, [esp+arg_4]
		mov	[ecx+168h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+16Ch], eax
		mov	eax, 1
		retn
_SSL_set_session_secret_cb endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 970h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl SSL_set_session_ticket_ext(int, void *Src, size_t	Size)
		public _SSL_set_session_ticket_ext
_SSL_set_session_ticket_ext proc near

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 301h
		jl	loc_A2B
		mov	eax, [esi+15Ch]
		test	eax, eax
		jz	short loc_99E
		push	eax
		call	_CRYPTO_free
		add	esp, 4
		mov	dword ptr [esi+15Ch], 0

loc_99E:				; CODE XREF: _SSL_set_session_ticket_ext+19j
		push	edi
		mov	edi, [esp+8+Size]
		push	420h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		lea	eax, [edi+8]
		push	eax
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+15Ch], eax
		test	eax, eax
		jnz	short loc_9E3
		push	422h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	41h ; 'A'
		push	126h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_9E3:				; CODE XREF: _SSL_set_session_ticket_ext+51j
		mov	edx, [esp+8+Src]
		test	edx, edx
		jz	short loc_A15
		mov	[eax], di
		mov	ecx, [esi+15Ch]
		push	edi		; Size
		push	edx		; Src
		lea	eax, [ecx+8]
		mov	[ecx+4], eax
		mov	eax, [esi+15Ch]
		push	dword ptr [eax+4] ; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_A15:				; CODE XREF: _SSL_set_session_ticket_ext+79j
		xor	ecx, ecx
		mov	[eax], cx
		mov	eax, [esi+15Ch]
		pop	edi
		pop	esi
		mov	[eax+4], ecx
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_A2B:				; CODE XREF: _SSL_set_session_ticket_ext+Bj
		xor	eax, eax
		pop	esi
		retn
_SSL_set_session_ticket_ext endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A30h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_set_session_ticket_ext_cb
_SSL_set_session_ticket_ext_cb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_A3B
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A3B:				; CODE XREF: _SSL_set_session_ticket_ext_cb+6j
		mov	eax, [esp+arg_4]
		mov	[ecx+160h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+164h], eax
		mov	eax, 1
		retn
_SSL_set_session_ticket_ext_cb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A58h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_def_generate_session_id proc near	; DATA XREF: _ssl_get_new_session+135o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		xor	esi, esi

loc_A6A:				; CODE XREF: _def_generate_session_id+35j
		push	dword ptr [edi]
		push	ebx
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jle	short loc_A8F
		push	dword ptr [edi]
		push	ebx
		push	ebp
		call	_SSL_has_matching_session_id
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_A96
		inc	esi
		cmp	esi, 0Ah
		jb	short loc_A6A

loc_A8F:				; CODE XREF: _def_generate_session_id+1Fj
					; _def_generate_session_id+41j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_A96:				; CODE XREF: _def_generate_session_id+2Fj
		cmp	esi, 0Ah
		jnb	short loc_A8F
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_def_generate_session_id endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_remove_session_lock proc near		; CODE XREF: _SSL_CTX_remove_session+Ap
					; _ssl_clear_bad_session+42p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		xor	edi, edi
		test	esi, esi
		jz	loc_B58
		cmp	[esi+44h], edi
		jz	loc_B58
		cmp	[esp+8+arg_8], edi
		jz	short loc_ADD
		push	333h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	9
		call	_CRYPTO_lock
		add	esp, 10h

loc_ADD:				; CODE XREF: _remove_session_lock+1Dj
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		push	dword ptr [ebp+10h]
		call	_lh_retrieve
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, esi
		jnz	short loc_B0F
		push	esi
		push	dword ptr [ebp+10h]
		mov	edi, 1
		call	_lh_delete
		push	esi
		push	ebp
		mov	ebx, eax
		call	_SSL_SESSION_list_remove
		add	esp, 10h

loc_B0F:				; CODE XREF: _remove_session_lock+4Bj
		cmp	[esp+10h+arg_8], 0
		jz	short loc_B2C
		push	33Bh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h

loc_B2C:				; CODE XREF: _remove_session_lock+6Cj
		test	edi, edi
		jz	short loc_B51
		mov	dword ptr [ebx+94h], 1
		mov	eax, [ebp+2Ch]
		test	eax, eax
		jz	short loc_B48
		push	ebx
		push	ebp
		call	eax
		add	esp, 8

loc_B48:				; CODE XREF: _remove_session_lock+97j
		push	ebx
		call	_SSL_SESSION_free
		add	esp, 4

loc_B51:				; CODE XREF: _remove_session_lock+86j
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_B58:				; CODE XREF: _remove_session_lock+Aj
					; _remove_session_lock+13j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
_remove_session_lock endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B60h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_clear_bad_session
_ssl_clear_bad_session proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+0C0h], 0
		jz	short loc_BB1
		test	byte ptr [esi+30h], 1
		jnz	short loc_BB1
		push	esi
		call	_SSL_state
		add	esp, 4
		test	eax, 3000h
		jnz	short loc_BB1
		push	esi
		call	_SSL_state
		add	esp, 4
		test	eax, 4000h
		jnz	short loc_BB1
		push	1
		push	dword ptr [esi+0C0h]
		push	dword ptr [esi+0E4h]
		call	_remove_session_lock
		add	esp, 0Ch
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_BB1:				; CODE XREF: _ssl_clear_bad_session+Cj
					; _ssl_clear_bad_session+12j ...
		xor	eax, eax
		pop	esi
		retn
_ssl_clear_bad_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BB8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_get_new_session
_ssl_get_new_session proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		push	esi
		call	_SSL_SESSION_new
		mov	esi, eax
		test	esi, esi
		jnz	short loc_BD1
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_BD1:				; CODE XREF: _ssl_get_new_session+14j
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	eax, [edi+170h]
		cmp	dword ptr [eax+24h], 0
		jnz	short loc_BED
		push	edi
		call	_SSL_get_default_timeout
		add	esp, 4
		jmp	short loc_BF0
; ---------------------------------------------------------------------------

loc_BED:				; CODE XREF: _ssl_get_new_session+28j
		mov	eax, [eax+24h]

loc_BF0:				; CODE XREF: _ssl_get_new_session+33j
		mov	[esi+0A8h], eax
		mov	eax, [edi+0C0h]
		test	eax, eax
		jz	short loc_C13
		push	eax
		call	_SSL_SESSION_free
		add	esp, 4
		mov	dword ptr [edi+0C0h], 0

loc_C13:				; CODE XREF: _ssl_get_new_session+46j
		cmp	[esp+0Ch+arg_4], 0
		push	ebp
		jz	loc_DB5
		mov	eax, [edi]
		cmp	eax, 2
		jnz	short loc_C31
		mov	[esi], eax
		mov	dword ptr [esi+44h], 10h
		jmp	short loc_C87
; ---------------------------------------------------------------------------

loc_C31:				; CODE XREF: _ssl_get_new_session+6Cj
		cmp	eax, 300h
		jnz	short loc_C3C
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C3C:				; CODE XREF: _ssl_get_new_session+7Ej
		cmp	eax, 301h
		jnz	short loc_C47
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C47:				; CODE XREF: _ssl_get_new_session+89j
		cmp	eax, 302h
		jnz	short loc_C52
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C52:				; CODE XREF: _ssl_get_new_session+94j
		cmp	eax, 303h
		jnz	short loc_C5D
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C5D:				; CODE XREF: _ssl_get_new_session+9Fj
		cmp	eax, 100h
		jnz	short loc_C68
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C68:				; CODE XREF: _ssl_get_new_session+AAj
		cmp	eax, 0FEFFh
		jnz	short loc_C73
		mov	[esi], eax
		jmp	short loc_C80
; ---------------------------------------------------------------------------

loc_C73:				; CODE XREF: _ssl_get_new_session+B5j
		cmp	eax, 0FEFDh
		jnz	loc_DA4
		mov	[esi], eax

loc_C80:				; CODE XREF: _ssl_get_new_session+82j
					; _ssl_get_new_session+8Dj ...
		mov	dword ptr [esi+44h], 20h ; ' '

loc_C87:				; CODE XREF: _ssl_get_new_session+77j
		cmp	dword ptr [edi+140h], 0
		jz	short loc_CC6
		mov	dword ptr [esi+44h], 0

$sess_id_done$45:			; CODE XREF: _ssl_get_new_session+1C4j
		mov	eax, [edi+120h]
		test	eax, eax
		jz	loc_DBC
		push	eax
		call	_BUF_strdup
		add	esp, 4
		mov	[esi+0D0h], eax
		test	eax, eax
		jnz	loc_DBC
		push	208h
		jmp	loc_DCC
; ---------------------------------------------------------------------------

loc_CC6:				; CODE XREF: _ssl_get_new_session+D6j
		push	ebx
		push	1DDh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	5
		call	_CRYPTO_lock
		mov	ebx, [edi+0C4h]
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_CFD
		mov	eax, [edi+170h]
		mov	ebx, offset _def_generate_session_id
		mov	eax, [eax+0ECh]
		test	eax, eax
		cmovnz	ebx, eax

loc_CFD:				; CODE XREF: _ssl_get_new_session+12Dj
		push	1E2h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	6
		call	_CRYPTO_lock
		mov	eax, [esi+44h]
		lea	ebp, [esi+48h]
		mov	[esp+24h+var_4], eax
		lea	eax, [esp+24h+var_4]
		push	eax
		push	ebp
		push	edi
		call	ebx
		add	esp, 1Ch
		pop	ebx
		test	eax, eax
		jnz	short loc_D3F
		push	1E8h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	12Dh
		jmp	loc_DD3
; ---------------------------------------------------------------------------

loc_D3F:				; CODE XREF: _ssl_get_new_session+171j
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jz	short loc_D93
		mov	ecx, [esi+44h]
		cmp	eax, ecx
		ja	short loc_D93
		jnb	short loc_D6A
		cmp	dword ptr [edi], 2
		jnz	short loc_D6A
		sub	ecx, eax
		add	eax, 48h ; 'H'
		push	ecx		; Size
		add	eax, esi
		push	0		; Val
		push	eax		; Dst
		call	_memset
		add	esp, 0Ch
		jmp	short loc_D6D
; ---------------------------------------------------------------------------

loc_D6A:				; CODE XREF: _ssl_get_new_session+196j
					; _ssl_get_new_session+19Bj
		mov	[esi+44h], eax

loc_D6D:				; CODE XREF: _ssl_get_new_session+1B0j
		push	dword ptr [esi+44h]
		push	ebp
		push	edi
		call	_SSL_has_matching_session_id
		add	esp, 0Ch
		test	eax, eax
		jz	$sess_id_done$45
		push	1FFh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	12Eh
		jmp	short loc_DD3
; ---------------------------------------------------------------------------

loc_D93:				; CODE XREF: _ssl_get_new_session+18Dj
					; _ssl_get_new_session+194j
		push	1F3h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	12Fh
		jmp	short loc_DD3
; ---------------------------------------------------------------------------

loc_DA4:				; CODE XREF: _ssl_get_new_session+C0j
		push	1C3h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	103h
		jmp	short loc_DD3
; ---------------------------------------------------------------------------

loc_DB5:				; CODE XREF: _ssl_get_new_session+61j
		mov	dword ptr [esi+44h], 0

loc_DBC:				; CODE XREF: _ssl_get_new_session+E7j
					; _ssl_get_new_session+FEj
		mov	eax, [edi+9Ch]
		cmp	eax, 20h ; ' '
		jbe	short loc_DEF
		push	213h

loc_DCC:				; CODE XREF: _ssl_get_new_session+109j
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	44h ; 'D'

loc_DD3:				; CODE XREF: _ssl_get_new_session+182j
					; _ssl_get_new_session+1D9j ...
		push	0B5h ; 'µ'
		push	14h
		call	_ERR_put_error
		push	esi
		call	_SSL_SESSION_free
		add	esp, 18h
		xor	eax, eax
		pop	ebp
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_DEF:				; CODE XREF: _ssl_get_new_session+20Dj
		push	eax		; Size
		lea	eax, [edi+0A0h]
		push	eax		; Src
		lea	eax, [esi+6Ch]
		push	eax		; Dst
		call	_memcpy
		mov	eax, [edi+9Ch]
		add	esp, 0Ch
		mov	[esi+68h], eax
		mov	eax, [edi]
		mov	[edi+0C0h], esi
		pop	ebp
		mov	[esi], eax
		mov	eax, 1
		pop	edi
		mov	dword ptr [esi+0A0h], 0
		pop	esi
		pop	ecx
		retn
_ssl_get_new_session endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E2Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl_get_prev_session(int,	void *Src, size_t Size,	int)
		public _ssl_get_prev_session
_ssl_get_prev_session proc near

var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_BC		= dword	ptr -0BCh
Dst		= byte ptr -0B8h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 104h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+104h+var_4], eax
		mov	ecx, [esp+104h+arg_C]
		push	ebx
		mov	ebx, [esp+108h+Src]
		push	ebp
		push	esi
		mov	esi, [esp+110h+arg_0]
		mov	ebp, 1
		push	edi
		mov	edi, [esp+114h+Size]
		mov	[esp+114h+var_104], 0
		lea	eax, [edi+ebx]
		cmp	eax, ecx
		ja	$LN56
		xor	eax, eax
		test	edi, edi
		cmovz	ebp, eax
		lea	eax, [esp+114h+var_104]
		push	eax
		push	ecx
		push	edi
		push	ebx
		push	esi
		call	_tls1_process_ticket
		inc	eax
		add	esp, 14h
		cmp	eax, 4		; switch 5 cases
		ja	loc_11D5	; jumptable 00000E9E default case
		jmp	ds:$LN55[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _ssl_get_prev_session+72j
					; DATA XREF: .text$mn:$LN55o
		mov	edx, [esp+114h+var_104]	; jumptable 00000E9E case 0
		mov	ebx, 1
		jmp	$err$57
; ---------------------------------------------------------------------------

$LN8:					; CODE XREF: _ssl_get_prev_session+72j
					; DATA XREF: .text$mn:$LN55o
		xor	ebp, ebp	; jumptable 00000E9E cases 3,4
		jmp	loc_100A
; ---------------------------------------------------------------------------

$LN2:					; CODE XREF: _ssl_get_prev_session+72j
					; DATA XREF: .text$mn:$LN55o
		test	ebp, ebp	; jumptable 00000E9E cases 1,2
		jz	loc_100A
		mov	edx, [esp+114h+var_104]
		test	edx, edx
		jnz	loc_1016
		mov	eax, [esi+170h]
		test	dword ptr [eax+20h], 100h
		jnz	loc_F83
		mov	eax, [esi]
		mov	[esp+114h+var_100], eax
		mov	[esp+114h+var_BC], edi
		test	edi, edi
		jz	loc_119E
		push	edi		; Size
		lea	eax, [esp+118h+Dst]
		push	ebx		; Src
		push	eax		; Dst
		call	_memcpy
		push	265h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	5
		call	_CRYPTO_lock
		lea	eax, [esp+130h+var_100]
		push	eax
		mov	eax, [esi+170h]
		push	dword ptr [eax+10h]
		call	_lh_retrieve
		add	esp, 24h
		mov	[esp+114h+var_104], eax
		test	eax, eax
		jz	short loc_F4C
		push	269h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		add	eax, 0A4h ; '¤'
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h

loc_F4C:				; CODE XREF: _ssl_get_prev_session+102j
		push	26Bh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Ch
		push	6
		call	_CRYPTO_lock
		mov	edx, [esp+124h+var_104]
		add	esp, 10h
		test	edx, edx
		jnz	loc_1016
		mov	eax, [esi+170h]
		inc	dword ptr [eax+4Ch]
		mov	edx, [esp+114h+var_104]
		test	edx, edx
		jnz	loc_1016

loc_F83:				; CODE XREF: _ssl_get_prev_session+AFj
		mov	eax, [esi+170h]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	loc_119E
		lea	ecx, [esp+114h+var_C]
		mov	[esp+114h+var_C], 1
		push	ecx
		push	edi
		push	ebx
		push	esi
		call	eax
		add	esp, 10h
		mov	[esp+114h+var_104], eax
		test	eax, eax
		jz	loc_119E
		mov	eax, [esi+170h]
		inc	dword ptr [eax+5Ch]
		cmp	[esp+114h+var_C], 0
		jz	short loc_FEE
		mov	eax, [esp+114h+var_104]
		push	27Fh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Eh
		add	eax, 0A4h ; '¤'
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h

loc_FEE:				; CODE XREF: _ssl_get_prev_session+1A0j
		mov	eax, [esi+170h]
		test	dword ptr [eax+20h], 200h
		jnz	short loc_100A
		push	[esp+114h+var_104]
		push	eax
		call	_SSL_CTX_add_session
		add	esp, 8

loc_100A:				; CODE XREF: _ssl_get_prev_session+89j
					; _ssl_get_prev_session+90j ...
		mov	edx, [esp+114h+var_104]
		test	edx, edx
		jz	loc_119E

loc_1016:				; CODE XREF: _ssl_get_prev_session+9Cj
					; _ssl_get_prev_session+13Cj ...
		mov	ecx, [edx+68h]
		cmp	ecx, [esi+9Ch]
		jnz	loc_117D
		lea	ebx, [esi+0A0h]
		lea	edi, [edx+6Ch]
		sub	ecx, 4
		jb	short loc_1044

loc_1033:				; CODE XREF: _ssl_get_prev_session+216j
		mov	eax, [edi]
		cmp	eax, [ebx]
		jnz	short loc_1049
		add	edi, 4
		add	ebx, 4
		sub	ecx, 4
		jnb	short loc_1033

loc_1044:				; CODE XREF: _ssl_get_prev_session+205j
		cmp	ecx, 0FFFFFFFCh
		jz	short loc_1086

loc_1049:				; CODE XREF: _ssl_get_prev_session+20Bj
		mov	al, [edi]
		cmp	al, [ebx]
		jnz	loc_117D
		cmp	ecx, 0FFFFFFFDh
		jz	short loc_1086
		mov	al, [edi+1]
		cmp	al, [ebx+1]
		jnz	loc_117D
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_1086
		mov	al, [edi+2]
		cmp	al, [ebx+2]
		jnz	loc_117D
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1086
		mov	al, [edi+3]
		cmp	al, [ebx+3]
		jnz	loc_117D

loc_1086:				; CODE XREF: _ssl_get_prev_session+21Bj
					; _ssl_get_prev_session+22Aj ...
		test	byte ptr [esi+0C8h], 1
		jz	short loc_10C4
		cmp	dword ptr [esi+9Ch], 0
		jnz	short loc_10C4
		push	2AAh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	115h
		push	0D9h ; 'Ù'
		push	14h
		call	_ERR_put_error
		mov	edx, [esp+128h+var_104]
		add	esp, 14h
		mov	ebx, 1
		jmp	$err$57
; ---------------------------------------------------------------------------

loc_10C4:				; CODE XREF: _ssl_get_prev_session+261j
					; _ssl_get_prev_session+26Aj
		cmp	dword ptr [edx+0B4h], 0
		jnz	short loc_113B
		mov	ecx, [edx+0B8h]
		mov	eax, ecx
		shr	eax, 18h
		mov	byte ptr [esp+114h+var_C], al
		mov	eax, ecx
		shr	eax, 10h
		mov	byte ptr [esp+114h+var_C+1], al
		mov	eax, ecx
		shr	eax, 8
		mov	byte ptr [esp+114h+var_C+2], al
		mov	byte ptr [esp+114h+var_C+3], cl
		mov	eax, [edx]
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		lea	eax, [esp+114h+var_C+2]
		jge	short loc_111A
		lea	eax, [esp+114h+var_C+1]

loc_111A:				; CODE XREF: _ssl_get_prev_session+2E5j
		push	eax
		push	esi
		call	_ssl_get_cipher_by_char
		mov	ecx, [esp+11Ch+var_104]
		add	esp, 8
		mov	[ecx+0B4h], eax
		mov	edx, [esp+114h+var_104]
		cmp	dword ptr [edx+0B4h], 0
		jz	short loc_117D

loc_113B:				; CODE XREF: _ssl_get_prev_session+29Fj
		push	0		; Time
		call	dword ptr ds:__imp___time64
		mov	ecx, [esp+118h+var_104]
		add	esp, 4
		sub	eax, [ecx+0ACh]
		cmp	[ecx+0A8h], eax
		mov	eax, [esi+170h]
		jge	short loc_11A2
		inc	dword ptr [eax+50h]
		test	ebp, ebp
		jz	short loc_1179
		push	1
		push	[esp+118h+var_104]
		push	dword ptr [esi+170h]
		call	_remove_session_lock
		add	esp, 0Ch

loc_1179:				; CODE XREF: _ssl_get_prev_session+337j
		mov	edx, [esp+114h+var_104]

loc_117D:				; CODE XREF: _ssl_get_prev_session+1F3j
					; _ssl_get_prev_session+221j ...
		xor	ebx, ebx

$err$57:				; CODE XREF: _ssl_get_prev_session+82j
					; _ssl_get_prev_session+293j
		test	edx, edx
		jz	short loc_119A
		push	edx
		call	_SSL_SESSION_free
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_119A
		mov	dword ptr [esi+140h], 1

loc_119A:				; CODE XREF: _ssl_get_prev_session+355j
					; _ssl_get_prev_session+362j
		test	ebx, ebx
		jnz	short $LN56

loc_119E:				; CODE XREF: _ssl_get_prev_session+C1j
					; _ssl_get_prev_session+162j ...
		xor	eax, eax
		jmp	short loc_11DE
; ---------------------------------------------------------------------------

loc_11A2:				; CODE XREF: _ssl_get_prev_session+330j
		inc	dword ptr [eax+58h]
		mov	eax, [esi+0C0h]
		test	eax, eax
		jz	short loc_11B8
		push	eax
		call	_SSL_SESSION_free
		add	esp, 4

loc_11B8:				; CODE XREF: _ssl_get_prev_session+381j
		mov	eax, [esp+114h+var_104]
		mov	[esi+0C0h], eax
		mov	eax, [eax+0A0h]
		mov	[esi+0ECh], eax
		mov	eax, 1
		jmp	short loc_11DE
; ---------------------------------------------------------------------------

loc_11D5:				; CODE XREF: _ssl_get_prev_session+6Cj
		call	dword ptr ds:__imp__abort ; jumptable 00000E9E default case

$LN56:					; CODE XREF: _ssl_get_prev_session+4Aj
					; _ssl_get_prev_session+370j
		or	eax, 0FFFFFFFFh

loc_11DE:				; CODE XREF: _ssl_get_prev_session+374j
					; _ssl_get_prev_session+3A7j
		mov	ecx, [esp+114h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 104h
		retn
_ssl_get_prev_session endp

; ---------------------------------------------------------------------------
$LN54		db 90h
$LN55		dd offset $LN6		; DATA XREF: _ssl_get_prev_session+72r
		dd offset $LN2		; jump table for switch	statement
		dd offset $LN2
		dd offset $LN8
		dd offset $LN8
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 120Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_session_dup
_ssl_session_dup proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	0EEh ; 'î'
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0F4h ; 'ô'
		call	_CRYPTO_malloc
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	$err$25
		mov	ebp, [esp+0Ch+arg_0]
		mov	ecx, 3Dh ; '='
		push	edi
		mov	esi, ebp
		mov	edi, ebx
		rep movsd
		mov	dword ptr [ebx+8Ch], 0
		lea	esi, [ebx+0C0h]
		mov	dword ptr [ebx+90h], 0
		xorps	xmm0, xmm0
		mov	dword ptr [ebx+0BCh], 0
		mov	dword ptr [ebx+0D0h], 0
		mov	dword ptr [ebx+0D8h], 0
		mov	dword ptr [ebx+0E0h], 0
		mov	dword ptr [ebx+0E4h], 0
		mov	dword ptr [ebx+0F0h], 0
		movq	qword ptr [esi], xmm0
		mov	dword ptr [ebx+0C8h], 0
		mov	dword ptr [ebx+0CCh], 0
		mov	dword ptr [ebx+0A4h], 1
		mov	eax, [ebp+98h]
		pop	edi
		test	eax, eax
		jz	short loc_12E2
		push	111h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	0Fh
		add	eax, 0F8h ; 'ø'
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h

loc_12E2:				; CODE XREF: _ssl_session_dup+B8j
		mov	eax, [ebp+9Ch]
		test	eax, eax
		jz	short loc_1306
		push	114h
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	3
		add	eax, 10h
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h

loc_1306:				; CODE XREF: _ssl_session_dup+DEj
		mov	eax, [ebp+8Ch]
		test	eax, eax
		jz	short loc_1327
		push	eax
		call	_BUF_strdup
		add	esp, 4
		mov	[ebx+8Ch], eax
		test	eax, eax
		jz	$err$25

loc_1327:				; CODE XREF: _ssl_session_dup+102j
		mov	eax, [ebp+90h]
		test	eax, eax
		jz	short loc_1348
		push	eax
		call	_BUF_strdup
		add	esp, 4
		mov	[ebx+90h], eax
		test	eax, eax
		jz	$err$25

loc_1348:				; CODE XREF: _ssl_session_dup+123j
		mov	eax, [ebp+0BCh]
		test	eax, eax
		jz	short loc_1369
		push	eax
		call	_sk_dup
		add	esp, 4
		mov	[ebx+0BCh], eax
		test	eax, eax
		jz	$err$25

loc_1369:				; CODE XREF: _ssl_session_dup+144j
		lea	eax, [ebp+0C0h]
		push	eax
		push	esi
		push	3
		call	_CRYPTO_dup_ex_data
		add	esp, 0Ch
		test	eax, eax
		jz	$err$25
		mov	eax, [ebp+0D0h]
		test	eax, eax
		jz	short loc_13A0
		push	eax
		call	_BUF_strdup
		add	esp, 4
		mov	[ebx+0D0h], eax
		test	eax, eax
		jz	short $err$25

loc_13A0:				; CODE XREF: _ssl_session_dup+17Fj
		mov	eax, [ebp+0D8h]
		test	eax, eax
		jz	short loc_13C3
		push	dword ptr [ebp+0D4h]
		push	eax
		call	_BUF_memdup
		add	esp, 8
		mov	[ebx+0D8h], eax
		test	eax, eax
		jz	short $err$25

loc_13C3:				; CODE XREF: _ssl_session_dup+19Cj
		mov	eax, [ebp+0E0h]
		test	eax, eax
		jz	short loc_13E6
		push	dword ptr [ebp+0DCh]
		push	eax
		call	_BUF_memdup
		add	esp, 8
		mov	[ebx+0E0h], eax
		test	eax, eax
		jz	short $err$25

loc_13E6:				; CODE XREF: _ssl_session_dup+1BFj
		cmp	[esp+0Ch+arg_4], 0
		jz	short loc_1432
		push	dword ptr [ebp+0E8h]
		push	dword ptr [ebp+0E4h]
		call	_BUF_memdup
		add	esp, 8
		mov	[ebx+0E4h], eax
		test	eax, eax
		jnz	short loc_1446

$err$25:				; CODE XREF: _ssl_session_dup+1Ej
					; _ssl_session_dup+115j ...
		push	15Dh
		push	offset ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ ; ".\\ssl\\ssl_sess.c"
		push	41h ; 'A'
		push	15Ch
		push	14h
		call	_ERR_put_error
		push	ebx
		call	_SSL_SESSION_free
		add	esp, 18h
		xor	eax, eax
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1432:				; CODE XREF: _ssl_session_dup+1DFj
		mov	dword ptr [ebx+0ECh], 0
		mov	dword ptr [ebx+0E8h], 0

loc_1446:				; CODE XREF: _ssl_session_dup+1FDj
		mov	eax, [ebp+0F0h]
		test	eax, eax
		jz	short loc_1463
		push	eax
		call	_BUF_strdup
		add	esp, 4
		mov	[ebx+0F0h], eax
		test	eax, eax
		jz	short $err$25

loc_1463:				; CODE XREF: _ssl_session_dup+242j
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
_ssl_session_dup endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 146Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; time_t __cdecl static	time(time_t *Time)
_time		proc near
		jmp	dword ptr ds:__imp___time64
_time		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1474h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_timeout_LHASH_DOALL_ARG proc near	; DATA XREF: _SSL_CTX_flush_sessions+4Bo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jz	short loc_1495
		mov	eax, [esi+0ACh]
		add	eax, [esi+0A8h]
		cmp	ecx, eax
		jle	short loc_14CC

loc_1495:				; CODE XREF: _timeout_LHASH_DOALL_ARG+Fj
		push	esi
		push	dword ptr [edi+8]
		call	_lh_delete
		push	esi
		push	dword ptr [edi]
		call	_SSL_SESSION_list_remove
		mov	dword ptr [esi+94h], 1
		add	esp, 10h
		mov	eax, [edi]
		mov	ecx, [eax+2Ch]
		test	ecx, ecx
		jz	short loc_14C3
		push	esi
		push	eax
		call	ecx
		add	esp, 8

loc_14C3:				; CODE XREF: _timeout_LHASH_DOALL_ARG+46j
		push	esi
		call	_SSL_SESSION_free
		add	esp, 4

loc_14CC:				; CODE XREF: _timeout_LHASH_DOALL_ARG+1Fj
		pop	edi
		pop	esi
		retn
_timeout_LHASH_DOALL_ARG endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14D0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_timeout_doall_arg proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jz	short loc_14F1
		mov	eax, [esi+0ACh]
		add	eax, [esi+0A8h]
		cmp	ecx, eax
		jle	short loc_1528

loc_14F1:				; CODE XREF: _timeout_doall_arg+Fj
		push	esi
		push	dword ptr [edi+8]
		call	_lh_delete
		push	esi
		push	dword ptr [edi]
		call	_SSL_SESSION_list_remove
		mov	dword ptr [esi+94h], 1
		add	esp, 10h
		mov	eax, [edi]
		mov	ecx, [eax+2Ch]
		test	ecx, ecx
		jz	short loc_151F
		push	esi
		push	eax
		call	ecx
		add	esp, 8

loc_151F:				; CODE XREF: _timeout_doall_arg+46j
		push	esi
		call	_SSL_SESSION_free
		add	esp, 4

loc_1528:				; CODE XREF: _timeout_doall_arg+1Fj
		pop	edi
		pop	esi
		retn
_timeout_doall_arg endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 152Ch
; COMDAT (pick any)
		public ??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@
; `string'
??_C@_0BB@GIFGIGOO@?4?2ssl?2ssl_sess?4c?$AA@ db	'.\ssl\ssl_sess.c',0
					; DATA XREF: _SSL_CTX_add_session+Do
					; _SSL_CTX_add_session+27o ...
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1540h
; COMDAT (pick any)
		public ??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@
; `string'
??_C@_0BH@IGLHPLHI@SSL?5SESSION?5PARAMETERS?$AA@ db 'SSL SESSION PARAMETERS',0
					; DATA XREF: _PEM_read_SSL_SESSION+10o
					; _PEM_read_bio_SSL_SESSION+10o ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; void __cdecl _abort()
		extrn __imp__abort:near	; CODE XREF: _ssl_get_prev_session:loc_11D5p
					; DATA XREF: _ssl_get_prev_session:loc_11D5r
		extrn _sk_free:near	; CODE XREF: _SSL_SESSION_free+96p
		extrn _sk_dup:near	; CODE XREF: _ssl_session_dup+147p
		extrn _CRYPTO_get_ex_new_index:near
					; CODE XREF: _SSL_SESSION_get_ex_new_index+16p
		extrn _CRYPTO_new_ex_data:near ; CODE XREF: _SSL_SESSION_new+D0p
		extrn _CRYPTO_dup_ex_data:near ; CODE XREF: _ssl_session_dup+167p
		extrn _CRYPTO_free_ex_data:near	; CODE XREF: _SSL_SESSION_free+3Cp
		extrn _CRYPTO_set_ex_data:near ; CODE XREF: _SSL_SESSION_set_ex_data+8j
		extrn _CRYPTO_get_ex_data:near ; CODE XREF: _SSL_SESSION_get_ex_data+8j
		extrn _CRYPTO_lock:near	; CODE XREF: _SSL_CTX_add_session+30p
					; _SSL_CTX_add_session+13Ep ...
		extrn _CRYPTO_add_lock:near ; CODE XREF: _SSL_CTX_add_session+1Dp
					; _SSL_SESSION_free+22p ...
		extrn _CRYPTO_malloc:near ; CODE XREF: _SSL_SESSION_new+10p
					; _SSL_set_session_ticket_ext+41p ...
		extrn _CRYPTO_free:near	; CODE XREF: _SSL_SESSION_free+A9p
					; _SSL_SESSION_free+BCp ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _SSL_SESSION_free+47p
					; _SSL_SESSION_free+52p ...
		extrn _lh_insert:near	; CODE XREF: _SSL_CTX_add_session+3Dp
		extrn _lh_delete:near	; CODE XREF: _SSL_CTX_add_session+E1p
					; _remove_session_lock+56p ...
		extrn _lh_retrieve:near	; CODE XREF: _SSL_CTX_add_session+D1p
					; _remove_session_lock+3Fp ...
		extrn _lh_doall_arg:near ; CODE	XREF: _SSL_CTX_flush_sessions+54p
		extrn _RAND_pseudo_bytes:near ;	CODE XREF: _def_generate_session_id+15p
; __time64_t __cdecl __time64(__time64_t *Time)
		extrn __imp___time64:near ; CODE XREF: _SSL_SESSION_new+6Ap
					; _ssl_get_prev_session+311p
					; DATA XREF: ...
		extrn _ERR_put_error:near ; CODE XREF: _SSL_CTX_set_client_cert_engine+25p
					; _SSL_CTX_set_client_cert_engine+54p ...
		extrn _BUF_strdup:near	; CODE XREF: _ssl_get_new_session+EEp
					; _ssl_session_dup+105p ...
		extrn _BUF_memdup:near	; CODE XREF: _ssl_session_dup+1A5p
					; _ssl_session_dup+1C8p ...
		extrn _X509_free:near	; CODE XREF: _SSL_SESSION_free+83p
		extrn _ENGINE_get_ssl_client_cert_function:near
					; CODE XREF: _SSL_CTX_set_client_cert_engine+32p
		extrn _ENGINE_init:near	; CODE XREF: _SSL_CTX_set_client_cert_engine+6p
		extrn _ENGINE_finish:near ; CODE XREF: _SSL_CTX_set_client_cert_engine+5Ap
		extrn _PEM_ASN1_read_bio:near ;	CODE XREF: _PEM_read_bio_SSL_SESSION+1Ap
		extrn _PEM_ASN1_write_bio:near ; CODE XREF: _PEM_write_bio_SSL_SESSION+1Cp
		extrn _PEM_ASN1_read:near ; CODE XREF: _PEM_read_SSL_SESSION+1Ap
		extrn _PEM_ASN1_write:near ; CODE XREF:	_PEM_write_SSL_SESSION+1Cp
		extrn _i2d_SSL_SESSION:near ; DATA XREF: _PEM_write_SSL_SESSION+17o
					; _PEM_write_bio_SSL_SESSION+17o
		extrn _SSL_has_matching_session_id:near
					; CODE XREF: _def_generate_session_id+25p
					; _ssl_get_new_session+1BAp
		extrn _d2i_SSL_SESSION:near ; DATA XREF: _PEM_read_SSL_SESSION+15o
					; _PEM_read_bio_SSL_SESSION+15o
		extrn _SSL_CTX_ctrl:near ; CODE	XREF: _SSL_CTX_add_session+8Bp
					; _SSL_CTX_add_session+A2p ...
		extrn _SSL_set_ssl_method:near ; CODE XREF: _SSL_set_session+63p
					; _SSL_set_session+E9p
		extrn _SSL_get_default_timeout:near ; CODE XREF: _ssl_get_new_session+2Bp
		extrn _SSL_state:near	; CODE XREF: _ssl_clear_bad_session+15p
					; _ssl_clear_bad_session+25p
		extrn _ssl_sess_cert_free:near ; CODE XREF: _SSL_SESSION_free+70p
		extrn _ssl_get_cipher_by_char:near ; CODE XREF:	_ssl_get_prev_session+2F0p
		extrn _tls1_process_ticket:near	; CODE XREF: _ssl_get_prev_session+60p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _ssl_get_prev_session+3BFp
		extrn __chkstk:near	; CODE XREF: _SSL_CTX_flush_sessions+5p
					; _ssl_get_new_session+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _SSL_SESSION_set1_id_context+3Ap
					; _SSL_set_session_ticket_ext+95p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _SSL_SESSION_new+45p
					; _ssl_get_new_session+1A8p
		extrn ___security_cookie:near ;	DATA XREF: _ssl_get_prev_session+Ar


		end
