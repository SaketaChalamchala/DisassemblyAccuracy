;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	816A8B21E55D9FBACDFA0A9370733746
; Input	CRC32 :	38F74A26

; File Name   :	C:\compspace\Diff\openssl\obj\v3_conf.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_conf_lhash_get_string proc near	; DATA XREF: .data:_conf_lhash_methodo
		jmp	_CONF_get_string
_conf_lhash_get_string endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_conf_lhash_get_section	proc near	; DATA XREF: .data:00000034o
		jmp	_CONF_get_section
_conf_lhash_get_section	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nconf_get_string proc near		; DATA XREF: .data:_nconf_methodo
		jmp	_NCONF_get_string
_nconf_get_string endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nconf_get_section proc	near		; DATA XREF: .data:00000024o
		jmp	_NCONF_get_section
_nconf_get_section endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 20h
_nconf_method	dd offset _nconf_get_string ; DATA XREF: _X509V3_set_nconf+8o
		dd offset _nconf_get_section
		align 10h
_conf_lhash_method dd offset _conf_lhash_get_string ; DATA XREF: _X509V3_set_conf_lhash+8o
		dd offset _conf_lhash_get_section
		align 10h
_data		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 40h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_CRL_add_conf
_X509V3_EXT_CRL_add_conf proc near

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 0Ch
		call	__chkstk
		push	[esp+0Ch+arg_0]
		lea	eax, [esp+10h+var_C]
		push	eax
		call	_CONF_set_nconf
		mov	ecx, [esp+14h+arg_C]
		add	esp, 8
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_6A
		mov	eax, [ecx]
		add	eax, 18h

loc_6A:					; CODE XREF: _X509V3_EXT_CRL_add_conf+23j
		push	eax
		push	[esp+10h+arg_8]
		lea	eax, [esp+14h+var_C]
		push	[esp+14h+arg_4]
		push	eax
		call	_X509V3_EXT_add_nconf_sk
		add	esp, 1Ch
		retn
_X509V3_EXT_CRL_add_conf endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 84h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_CRL_add_nconf
_X509V3_EXT_CRL_add_nconf proc near

arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_C]
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_93
		mov	eax, [ecx]
		add	eax, 18h

loc_93:					; CODE XREF: _X509V3_EXT_CRL_add_nconf+8j
		mov	[esp+arg_C], eax
		jmp	_X509V3_EXT_add_nconf_sk
_X509V3_EXT_CRL_add_nconf endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_REQ_add_conf
_X509V3_EXT_REQ_add_conf proc near

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 10h
		call	__chkstk
		push	esi
		push	[esp+14h+arg_0]
		lea	eax, [esp+18h+var_C]
		push	eax
		call	_CONF_set_nconf
		xor	eax, eax
		mov	[esp+1Ch+var_10], 0
		cmp	[esp+1Ch+arg_C], eax
		lea	esi, [esp+1Ch+var_10]
		cmovz	esi, eax
		lea	eax, [esp+1Ch+var_C]
		push	esi
		push	[esp+20h+arg_8]
		push	[esp+24h+arg_4]
		push	eax
		call	_X509V3_EXT_add_nconf_sk
		add	esp, 18h
		test	eax, eax
		jz	short loc_10A
		test	esi, esi
		jz	short loc_10A
		push	[esp+14h+var_10]
		push	[esp+18h+arg_C]
		call	_X509_REQ_add_extensions
		push	offset _X509_EXTENSION_free
		push	[esp+20h+var_10]
		mov	esi, eax
		call	_sk_pop_free
		add	esp, 10h
		mov	eax, esi

loc_10A:				; CODE XREF: _X509V3_EXT_REQ_add_conf+46j
					; _X509V3_EXT_REQ_add_conf+4Aj
		pop	esi
		add	esp, 10h
		retn
_X509V3_EXT_REQ_add_conf endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 110h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_REQ_add_nconf
_X509V3_EXT_REQ_add_nconf proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4
		call	__chkstk
		push	esi
		xor	eax, eax
		mov	[esp+8+var_4], 0
		cmp	[esp+8+arg_C], eax
		lea	esi, [esp+8+var_4]
		cmovz	esi, eax
		push	esi
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		push	[esp+14h+arg_0]
		call	_X509V3_EXT_add_nconf_sk
		add	esp, 10h
		test	eax, eax
		jz	short loc_16F
		test	esi, esi
		jz	short loc_16F
		push	[esp+8+var_4]
		push	[esp+0Ch+arg_C]
		call	_X509_REQ_add_extensions
		push	offset _X509_EXTENSION_free
		push	[esp+14h+var_4]
		mov	esi, eax
		call	_sk_pop_free
		add	esp, 10h
		mov	eax, esi

loc_16F:				; CODE XREF: _X509V3_EXT_REQ_add_nconf+37j
					; _X509V3_EXT_REQ_add_nconf+3Bj
		pop	esi
		pop	ecx
		retn
_X509V3_EXT_REQ_add_nconf endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 174h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_add_conf
_X509V3_EXT_add_conf proc near

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 0Ch
		call	__chkstk
		push	[esp+0Ch+arg_0]
		lea	eax, [esp+10h+var_C]
		push	eax
		call	_CONF_set_nconf
		mov	ecx, [esp+14h+arg_C]
		add	esp, 8
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_19E
		mov	eax, [ecx]
		add	eax, 24h ; '$'

loc_19E:				; CODE XREF: _X509V3_EXT_add_conf+23j
		push	eax
		push	[esp+10h+arg_8]
		lea	eax, [esp+14h+var_C]
		push	[esp+14h+arg_4]
		push	eax
		call	_X509V3_EXT_add_nconf_sk
		add	esp, 1Ch
		retn
_X509V3_EXT_add_conf endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_add_nconf
_X509V3_EXT_add_nconf proc near

arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_C]
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_1C7
		mov	eax, [ecx]
		add	eax, 24h ; '$'

loc_1C7:				; CODE XREF: _X509V3_EXT_add_nconf+8j
		mov	[esp+arg_C], eax
		jmp	$+5
_X509V3_EXT_add_nconf endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_add_nconf_sk
_X509V3_EXT_add_nconf_sk proc near	; CODE XREF: _X509V3_EXT_CRL_add_conf+38p
					; _X509V3_EXT_CRL_add_nconf+13j ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_0]
		call	_NCONF_get_section
		mov	ebx, eax
		add	esp, 8
		mov	[esp+0Ch+var_4], ebx
		test	ebx, ebx
		jnz	short loc_1FA
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1FA:				; CODE XREF: _X509V3_EXT_add_nconf_sk+23j
		push	ebp
		push	esi
		push	edi
		push	ebx
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_2E1
		mov	ebp, [esp+18h+arg_C]

loc_214:				; CODE XREF: _X509V3_EXT_add_nconf_sk+10Bj
		push	edi
		push	ebx
		call	_sk_value
		mov	ecx, [eax+8]
		mov	ebx, [eax+4]
		lea	eax, [esp+20h+var_8]
		push	eax
		mov	[esp+24h+var_8], ecx
		call	_v3_check_critical
		mov	esi, eax
		lea	eax, [esp+24h+var_8]
		push	eax
		call	_v3_check_generic
		add	esp, 10h
		test	eax, eax
		jz	short loc_259
		push	[esp+18h+arg_4]
		push	eax
		push	esi
		push	[esp+24h+var_8]
		push	ebx
		call	_v3_generic_extension
		add	esp, 14h
		mov	esi, eax
		jmp	short loc_2B1
; ---------------------------------------------------------------------------

loc_259:				; CODE XREF: _X509V3_EXT_add_nconf_sk+70j
		mov	ebp, [esp+18h+var_8]
		push	ebp
		push	esi
		push	ebx
		call	_OBJ_sn2nid
		add	esp, 4
		push	eax
		push	[esp+24h+arg_4]
		push	[esp+28h+arg_0]
		call	_do_ext_nconf
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_2AD
		push	5Fh ; '_'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	80h ; 'Ä'
		push	98h ; 'ò'
		push	22h ; '"'
		call	_ERR_put_error
		push	ebp
		push	offset ??_C@_08OMICEKMJ@?0?5value?$DN?$AA@ ; ",	value="
		push	ebx
		push	offset ??_C@_05DFCJAACA@name?$DN?$AA@ ;	"name="
		push	4
		call	_ERR_add_error_data
		add	esp, 28h

loc_2AD:				; CODE XREF: _X509V3_EXT_add_nconf_sk+ADj
		mov	ebp, [esp+18h+arg_C]

loc_2B1:				; CODE XREF: _X509V3_EXT_add_nconf_sk+87j
		test	esi, esi
		jz	short loc_2EE
		test	ebp, ebp
		jz	short loc_2C5
		push	0FFFFFFFFh
		push	esi
		push	ebp
		call	_X509v3_add_ext
		add	esp, 0Ch

loc_2C5:				; CODE XREF: _X509V3_EXT_add_nconf_sk+E7j
		push	esi
		call	_X509_EXTENSION_free
		mov	ebx, [esp+1Ch+var_4]
		inc	edi
		push	ebx
		call	_sk_num
		add	esp, 8
		cmp	edi, eax
		jl	loc_214

loc_2E1:				; CODE XREF: _X509V3_EXT_add_nconf_sk+3Aj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2EE:				; CODE XREF: _X509V3_EXT_add_nconf_sk+E3j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
_X509V3_EXT_add_nconf_sk endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_conf
_X509V3_EXT_conf proc near

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 0Ch
		call	__chkstk
		push	[esp+0Ch+arg_0]
		lea	eax, [esp+10h+var_C]
		push	eax
		call	_CONF_set_nconf
		push	[esp+14h+arg_C]
		lea	eax, [esp+18h+var_C]
		push	[esp+18h+arg_8]
		push	[esp+1Ch+arg_4]
		push	eax
		call	_X509V3_EXT_nconf
		add	esp, 24h
		retn
_X509V3_EXT_conf endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 32Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_conf_nid
_X509V3_EXT_conf_nid proc near

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 0Ch
		call	__chkstk
		push	esi
		push	[esp+10h+arg_0]
		lea	eax, [esp+14h+var_C]
		push	eax
		call	_CONF_set_nconf
		mov	eax, [esp+18h+arg_C]
		mov	[esp+18h+arg_C], eax
		lea	eax, [esp+18h+arg_C]
		push	eax
		call	_v3_check_critical
		mov	esi, eax
		lea	eax, [esp+1Ch+arg_C]
		push	eax
		call	_v3_check_generic
		add	esp, 10h
		test	eax, eax
		jz	short loc_38E
		push	[esp+10h+arg_4]
		push	eax
		push	esi
		push	[esp+1Ch+arg_C]
		push	[esp+20h+arg_8]
		call	_OBJ_nid2sn
		add	esp, 4
		push	eax
		call	_v3_generic_extension
		add	esp, 14h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_38E:				; CODE XREF: _X509V3_EXT_conf_nid+3Cj
		push	[esp+10h+arg_C]
		lea	eax, [esp+14h+var_C]
		push	esi
		push	[esp+18h+arg_8]
		push	[esp+1Ch+arg_4]
		push	eax
		call	_do_ext_nconf
		add	esp, 14h
		pop	esi
		add	esp, 0Ch
		retn
_X509V3_EXT_conf_nid endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_i2d
_X509V3_EXT_i2d	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_0]
		call	_X509V3_EXT_get_nid
		add	esp, 4
		test	eax, eax
		jnz	short loc_3E1
		push	0DEh ; 'ﬁ'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	81h ; 'Å'
		push	88h ; 'à'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_3E1:				; CODE XREF: _X509V3_EXT_i2d+Ej
		push	[esp+arg_8]
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		push	eax
		call	_do_ext_i2d
		add	esp, 10h
		retn
_X509V3_EXT_i2d	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_nconf
_X509V3_EXT_nconf proc near		; CODE XREF: _X509V3_EXT_conf+29p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		lea	eax, [esp+arg_C]
		push	esi
		push	eax
		call	_v3_check_critical
		mov	esi, eax
		lea	eax, [esp+8+arg_C]
		push	eax
		call	_v3_check_generic
		add	esp, 8
		test	eax, eax
		jz	short loc_42E
		push	[esp+4+arg_4]
		push	eax
		push	esi
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_8]
		call	_v3_generic_extension
		add	esp, 14h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_42E:				; CODE XREF: _X509V3_EXT_nconf+1Cj
		push	[esp+4+arg_C]
		push	esi
		push	[esp+0Ch+arg_8]
		call	_OBJ_sn2nid
		add	esp, 4
		push	eax
		push	[esp+10h+arg_4]
		push	[esp+14h+arg_0]
		call	_do_ext_nconf
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_48A
		push	5Fh ; '_'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	80h ; 'Ä'
		push	98h ; 'ò'
		push	22h ; '"'
		call	_ERR_put_error
		push	[esp+18h+arg_C]
		push	offset ??_C@_08OMICEKMJ@?0?5value?$DN?$AA@ ; ",	value="
		push	[esp+20h+arg_8]
		push	offset ??_C@_05DFCJAACA@name?$DN?$AA@ ;	"name="
		push	4
		call	_ERR_add_error_data
		add	esp, 28h

loc_48A:				; CODE XREF: _X509V3_EXT_nconf+5Cj
		mov	eax, esi
		pop	esi
		retn
_X509V3_EXT_nconf endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 490h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_EXT_nconf_nid
_X509V3_EXT_nconf_nid proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		lea	eax, [esp+arg_C]
		push	esi
		push	eax
		call	_v3_check_critical
		mov	esi, eax
		lea	eax, [esp+8+arg_C]
		push	eax
		call	_v3_check_generic
		add	esp, 8
		test	eax, eax
		jz	short loc_4CF
		push	[esp+4+arg_4]
		push	eax
		push	esi
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_8]
		call	_OBJ_nid2sn
		add	esp, 4
		push	eax
		call	_v3_generic_extension
		add	esp, 14h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4CF:				; CODE XREF: _X509V3_EXT_nconf_nid+1Cj
		push	[esp+4+arg_C]
		push	esi
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		push	[esp+14h+arg_0]
		call	_do_ext_nconf
		add	esp, 14h
		pop	esi
		retn
_X509V3_EXT_nconf_nid endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_get_section
_X509V3_get_section proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+18h]
		test	ecx, ecx
		jz	short loc_50B
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_50B
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_50B
		mov	[esp+arg_0], ecx
		jmp	eax
; ---------------------------------------------------------------------------

loc_50B:				; CODE XREF: _X509V3_get_section+9j
					; _X509V3_get_section+10j ...
		push	196h
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	94h ; 'î'
		push	8Eh ; 'é'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
_X509V3_get_section endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 52Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_get_string
_X509V3_get_string proc	near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+18h]
		test	ecx, ecx
		jz	short loc_54A
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_54A
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_54A
		mov	[esp+arg_0], ecx
		jmp	eax
; ---------------------------------------------------------------------------

loc_54A:				; CODE XREF: _X509V3_get_string+9j
					; _X509V3_get_string+10j ...
		push	18Ah
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	94h ; 'î'
		push	8Fh ; 'è'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
_X509V3_get_string endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 56Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_section_free
_X509V3_section_free proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jz	short locret_58B
		mov	edx, [esp+arg_0]
		mov	eax, [edx+14h]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short locret_58B
		push	ecx
		push	dword ptr [edx+18h]
		call	eax
		add	esp, 8

locret_58B:				; CODE XREF: _X509V3_section_free+6j
					; _X509V3_section_free+14j
		retn
_X509V3_section_free endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 58Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_set_conf_lhash
_X509V3_set_conf_lhash proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	dword ptr [ecx+14h], offset _conf_lhash_method
		mov	[ecx+18h], eax
		retn
_X509V3_set_conf_lhash endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_set_ctx
_X509V3_set_ctx	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	[ecx+4], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+8], eax
		mov	eax, [esp+arg_10]
		mov	[ecx+10h], eax
		mov	eax, [esp+arg_C]
		mov	[ecx+0Ch], eax
		mov	eax, [esp+arg_14]
		mov	[ecx], eax
		retn
_X509V3_set_ctx	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_set_nconf
_X509V3_set_nconf proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	dword ptr [ecx+14h], offset _nconf_method
		mov	[ecx+18h], eax
		retn
_X509V3_set_nconf endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509V3_string_free
_X509V3_string_free proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jz	short locret_5FB
		mov	edx, [esp+arg_0]
		mov	eax, [edx+14h]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short locret_5FB
		push	ecx
		push	dword ptr [edx+18h]
		call	eax
		add	esp, 8

locret_5FB:				; CODE XREF: _X509V3_string_free+6j
					; _X509V3_string_free+14j
		retn
_X509V3_string_free endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5FCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_do_ext_i2d	proc near		; CODE XREF: _X509V3_EXT_i2d+3Ep
					; _do_ext_nconf+16Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_656
		mov	[esp+0Ch+arg_0], 0
		call	eax
		push	eax
		lea	eax, [esp+10h+arg_0]
		push	eax
		push	[esp+14h+arg_C]
		call	_ASN1_item_i2d
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jns	short loc_693

$merr$10:				; CODE XREF: _do_ext_i2d+80j
					; _do_ext_i2d+A5j ...
		push	0D3h ; '”'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	41h ; 'A'
		push	87h ; 'á'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_656:				; CODE XREF: _do_ext_i2d+15j
		mov	eax, [esi+18h]
		push	0
		push	[esp+10h+arg_C]
		call	eax
		push	0C1h ; '¡'
		mov	edi, eax
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	edi
		call	_CRYPTO_malloc
		add	esp, 14h
		mov	[esp+0Ch+arg_0], eax
		test	eax, eax
		jz	short $merr$10
		mov	[esp+0Ch+var_4], eax
		lea	eax, [esp+0Ch+var_4]
		push	eax
		push	[esp+10h+arg_C]
		mov	eax, [esi+18h]
		call	eax
		add	esp, 8

loc_693:				; CODE XREF: _do_ext_i2d+37j
		push	4
		call	_ASN1_STRING_type_new
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short $merr$10
		mov	ecx, [esp+0Ch+arg_0]
		push	esi
		push	[esp+10h+arg_8]
		mov	[esi+8], ecx
		push	[esp+14h+arg_4]
		mov	[esi], edi
		push	0
		call	_X509_EXTENSION_create_by_NID
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	$merr$10
		push	esi
		call	_ASN1_STRING_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
_do_ext_i2d	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_do_ext_nconf	proc near		; CODE XREF: _X509V3_EXT_add_nconf_sk+A1p
					; _X509V3_EXT_conf_nid+74p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		test	ebx, ebx
		jnz	short loc_700
		push	7Dh ; '}'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	82h ; 'Ç'
		push	97h ; 'ó'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_700:				; CODE XREF: _do_ext_nconf+7j
		push	esi
		push	ebx
		call	_X509V3_EXT_get_nid
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_733
		push	81h ; 'Å'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	81h ; 'Å'
		push	97h ; 'ó'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_733:				; CODE XREF: _do_ext_nconf+36j
		cmp	dword ptr [esi+28h], 0
		push	ebp
		push	edi
		jz	loc_7F0
		mov	ebp, [esp+10h+arg_10]
		cmp	byte ptr [ebp+0], 40h ;	'@'
		jnz	short loc_761
		lea	eax, [ebp+1]
		push	eax
		push	[esp+14h+arg_0]
		call	_NCONF_get_section
		mov	edi, eax
		add	esp, 8
		mov	[esp+10h+arg_8], edi
		jmp	short loc_770
; ---------------------------------------------------------------------------

loc_761:				; CODE XREF: _do_ext_nconf+6Fj
		push	ebp
		call	_X509V3_parse_list
		add	esp, 4
		mov	[esp+10h+arg_8], eax
		mov	edi, eax

loc_770:				; CODE XREF: _do_ext_nconf+87j
		push	edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jg	short loc_7BE
		push	8Ch ; 'å'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	69h ; 'i'
		push	97h ; 'ó'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		push	ebp
		push	offset ??_C@_09ONBKGAEK@?0section?$DN?$AA@ ; ",section="
		push	ebx
		call	_OBJ_nid2sn
		add	esp, 4
		push	eax
		push	offset ??_C@_05DFCJAACA@name?$DN?$AA@ ;	"name="
		push	4
		call	_ERR_add_error_data
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_7BE:				; CODE XREF: _do_ext_nconf+A3j
		mov	eax, [esi+28h]
		push	edi
		push	[esp+14h+arg_4]
		push	esi
		call	eax
		add	esp, 0Ch
		mov	edi, eax
		cmp	byte ptr [ebp+0], 40h ;	'@'
		jz	short loc_7E5
		push	offset _X509V3_conf_free
		push	[esp+14h+arg_8]
		call	_sk_pop_free
		add	esp, 8

loc_7E5:				; CODE XREF: _do_ext_nconf+FAj
		test	edi, edi
		jnz	short loc_840
		pop	edi
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_7F0:				; CODE XREF: _do_ext_nconf+61j
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_810
		push	[esp+10h+arg_10]
		push	[esp+14h+arg_4]
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_840
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_810:				; CODE XREF: _do_ext_nconf+11Dj
		mov	ecx, [esi+30h]
		test	ecx, ecx
		jz	loc_8A0
		mov	eax, [esp+10h+arg_4]
		cmp	dword ptr [eax+18h], 0
		jz	short loc_87B
		cmp	dword ptr [eax+14h], 0
		jz	short loc_87B
		push	[esp+10h+arg_10]
		push	eax
		push	esi
		call	ecx
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	loc_8CE

loc_840:				; CODE XREF: _do_ext_nconf+10Fj
					; _do_ext_nconf+131j
		push	edi
		push	[esp+14h+arg_C]
		push	ebx
		push	esi
		call	_do_ext_i2d
		mov	ecx, [esi+8]
		add	esp, 10h
		mov	ebx, eax
		test	ecx, ecx
		jz	short loc_86B
		call	ecx
		push	eax
		push	edi
		call	_ASN1_item_free
		add	esp, 8
		mov	eax, ebx
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_86B:				; CODE XREF: _do_ext_nconf+17Ej
		mov	eax, [esi+10h]
		push	edi
		call	eax
		add	esp, 4
		mov	eax, ebx
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_87B:				; CODE XREF: _do_ext_nconf+14Bj
					; _do_ext_nconf+151j
		push	9Bh ; 'õ'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	88h ; 'à'
		push	97h ; 'ó'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_8A0:				; CODE XREF: _do_ext_nconf+13Dj
		push	0A2h ; '¢'
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	67h ; 'g'
		push	97h ; 'ó'
		push	22h ; '"'
		call	_ERR_put_error
		push	ebx
		call	_OBJ_nid2sn
		push	eax
		push	offset ??_C@_05DFCJAACA@name?$DN?$AA@ ;	"name="
		push	2
		call	_ERR_add_error_data
		add	esp, 24h

loc_8CE:				; CODE XREF: _do_ext_nconf+162j
		pop	edi
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
_do_ext_nconf	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_generic_asn1	proc near		; CODE XREF: _v3_generic_extension+76p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		push	esi
		push	[esp+8+arg_4]
		mov	[esp+0Ch+var_4], 0
		push	[esp+0Ch+arg_0]
		call	_ASN1_generate_v3
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_904
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_904:				; CODE XREF: _generic_asn1+27j
		lea	eax, [esp+8+var_4]
		push	eax
		push	esi
		call	_i2d_ASN1_TYPE
		mov	ecx, [esp+10h+arg_8]
		push	esi
		mov	[ecx], eax
		call	_ASN1_TYPE_free
		mov	eax, [esp+14h+var_4]
		add	esp, 0Ch
		pop	esi
		pop	ecx
		retn
_generic_asn1	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 928h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_v3_check_critical proc	near		; CODE XREF: _X509V3_EXT_add_nconf_sk+5Ap
					; _X509V3_EXT_conf_nid+26p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [ebx]
		mov	ecx, esi
		lea	edx, [ecx+1]
		nop	dword ptr [eax]

loc_938:				; CODE XREF: _v3_check_critical+15j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_938
		sub	ecx, edx
		cmp	ecx, 9
		jb	short loc_992
		push	9		; MaxCount
		push	offset ??_C@_09CFHMBGIC@critical?0?$AA@	; "critical,"
		push	esi		; Str1
		call	dword ptr ds:__imp__strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_992
		movzx	eax, byte ptr [esi+9]
		add	esi, 9
		push	edi
		mov	edi, dword ptr ds:__imp__isspace
		push	eax		; C
		call	edi ; __imp__isspace
		add	esp, 4
		test	eax, eax
		jz	short loc_987
		nop	dword ptr [eax+eax+00h]

loc_978:				; CODE XREF: _v3_check_critical+5Dj
		movzx	eax, byte ptr [esi+1]
		inc	esi
		push	eax		; C
		call	edi ; __imp__isspace
		add	esp, 4
		test	eax, eax
		jnz	short loc_978

loc_987:				; CODE XREF: _v3_check_critical+49j
		pop	edi
		mov	[ebx], esi
		mov	eax, 1
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_992:				; CODE XREF: _v3_check_critical+1Cj
					; _v3_check_critical+31j
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
_v3_check_critical endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 998h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_v3_check_generic proc near		; CODE XREF: _X509V3_EXT_add_nconf_sk+66p
					; _X509V3_EXT_conf_nid+32p ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	esi, [ebp+0]
		mov	ecx, esi
		lea	edx, [ecx+1]

loc_9A8:				; CODE XREF: _v3_check_generic+15j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_9A8
		mov	edi, dword ptr ds:__imp__strncmp
		sub	ecx, edx
		cmp	ecx, 4
		jb	short loc_9D5
		push	4		; MaxCount
		push	offset ??_C@_04HCPFHKMD@DER?3?$AA@ ; "DER:"
		push	esi		; Str1
		call	edi ; __imp__strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_9D5
		add	esi, 4
		lea	ebx, [eax+1]
		jmp	short loc_9FF
; ---------------------------------------------------------------------------

loc_9D5:				; CODE XREF: _v3_check_generic+22j
					; _v3_check_generic+33j
		mov	ecx, esi
		lea	edx, [ecx+1]

loc_9DA:				; CODE XREF: _v3_check_generic+47j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_9DA
		sub	ecx, edx
		cmp	ecx, 5
		jb	short loc_A31
		push	5		; MaxCount
		push	offset ??_C@_05IOEBEMFO@ASN1?3?$AA@ ; "ASN1:"
		push	esi		; Str1
		call	edi ; __imp__strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_A31
		add	esi, 5
		lea	ebx, [eax+2]

loc_9FF:				; CODE XREF: _v3_check_generic+3Bj
		movzx	eax, byte ptr [esi]
		mov	edi, dword ptr ds:__imp__isspace
		push	eax		; C
		call	edi ; __imp__isspace
		add	esp, 4
		test	eax, eax
		jz	short loc_A27
		nop	word ptr [eax+eax+00h]

loc_A18:				; CODE XREF: _v3_check_generic+8Dj
		movzx	ecx, byte ptr [esi+1]
		inc	esi
		push	ecx		; C
		call	edi ; __imp__isspace
		add	esp, 4
		test	eax, eax
		jnz	short loc_A18

loc_A27:				; CODE XREF: _v3_check_generic+78j
		pop	edi
		mov	[ebp+0], esi
		mov	eax, ebx
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_A31:				; CODE XREF: _v3_check_generic+4Ej
					; _v3_check_generic+5Fj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_v3_check_generic endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A38h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_v3_generic_extension proc near		; CODE XREF: _X509V3_EXT_add_nconf_sk+7Dp
					; _X509V3_EXT_conf_nid+55p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		xor	ebx, ebx
		push	esi
		push	edi
		push	ebx
		push	ebp
		xor	esi, esi
		xor	edi, edi
		call	_OBJ_txt2obj
		add	esp, 8
		mov	[esp+18h+var_8], eax
		test	eax, eax
		jnz	short loc_A82
		push	111h
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	73h ; 's'
		push	74h ; 't'
		push	22h ; '"'
		call	_ERR_put_error
		push	ebp
		push	offset ??_C@_05DFCJAACA@name?$DN?$AA@ ;	"name="
		jmp	loc_B23
; ---------------------------------------------------------------------------

loc_A82:				; CODE XREF: _v3_generic_extension+28j
		mov	eax, [esp+18h+arg_C]
		mov	ebp, [esp+18h+arg_4]
		cmp	eax, 1
		jnz	short loc_A9F
		lea	eax, [esp+18h+var_4]
		push	eax
		push	ebp
		call	_string_to_hex
		add	esp, 8
		jmp	short loc_AB6
; ---------------------------------------------------------------------------

loc_A9F:				; CODE XREF: _v3_generic_extension+55j
		cmp	eax, 2
		jnz	short loc_B08
		lea	eax, [esp+18h+var_4]
		push	eax
		push	[esp+1Ch+arg_10]
		push	ebp
		call	_generic_asn1
		add	esp, 0Ch

loc_AB6:				; CODE XREF: _v3_generic_extension+65j
		mov	esi, eax
		test	esi, esi
		jz	short loc_B08
		push	4
		call	_ASN1_STRING_type_new
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_AE6
		push	123h
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	41h ; 'A'
		push	74h ; 't'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_B2D
; ---------------------------------------------------------------------------

loc_AE6:				; CODE XREF: _v3_generic_extension+92j
		mov	ebp, [esp+18h+var_8]
		push	edi
		push	[esp+1Ch+arg_8]
		mov	[edi+8], esi
		xor	esi, esi
		mov	eax, [esp+20h+var_4]
		push	ebp
		push	esi
		mov	[edi], eax
		call	_X509_EXTENSION_create_by_OBJ
		add	esp, 10h
		mov	ebx, eax
		jmp	short $err$16
; ---------------------------------------------------------------------------

loc_B08:				; CODE XREF: _v3_generic_extension+6Aj
					; _v3_generic_extension+82j
		push	11Dh
		push	offset ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ ; ".\\crypto\\x509v3\\v3_conf.c"
		push	74h ; 't'
		push	74h ; 't'
		push	22h ; '"'
		call	_ERR_put_error
		push	ebp
		push	offset ??_C@_06KFEJCPI@value?$DN?$AA@ ;	"value="

loc_B23:				; CODE XREF: _v3_generic_extension+45j
		push	2
		call	_ERR_add_error_data
		add	esp, 20h

loc_B2D:				; CODE XREF: _v3_generic_extension+ACj
		mov	ebp, [esp+18h+var_8]

$err$16:				; CODE XREF: _v3_generic_extension+CEj
		push	ebp
		call	_ASN1_OBJECT_free
		push	edi
		call	_ASN1_STRING_free
		add	esp, 8
		test	esi, esi
		jz	short loc_B4D
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_B4D:				; CODE XREF: _v3_generic_extension+10Aj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
_v3_generic_extension endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B58h
; COMDAT (pick any)
		public ??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@
; `string'
??_C@_0BK@KJEJJLK@?4?2crypto?2x509v3?2v3_conf?4c?$AA@ db '.\crypto\x509v3\v3_conf.c',0
					; DATA XREF: _X509V3_EXT_add_nconf_sk+B1o
					; _X509V3_EXT_i2d+15o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B74h
; COMDAT (pick any)
		public ??_C@_08OMICEKMJ@?0?5value?$DN?$AA@
; `string'
??_C@_08OMICEKMJ@?0?5value?$DN?$AA@ db ', value=',0
					; DATA XREF: _X509V3_EXT_add_nconf_sk+C8o
					; _X509V3_EXT_nconf+7Ao
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B80h
; COMDAT (pick any)
		public ??_C@_05DFCJAACA@name?$DN?$AA@
; `string'
??_C@_05DFCJAACA@name?$DN?$AA@ db 'name=',0 ; DATA XREF: _X509V3_EXT_add_nconf_sk+CEo
					; _X509V3_EXT_nconf+83o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B88h
; COMDAT (pick any)
		public ??_C@_09ONBKGAEK@?0section?$DN?$AA@
; `string'
??_C@_09ONBKGAEK@?0section?$DN?$AA@ db ',section=',0 ; DATA XREF: _do_ext_nconf+C1o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B94h
; COMDAT (pick any)
		public ??_C@_09CFHMBGIC@critical?0?$AA@
; char `string'[]
??_C@_09CFHMBGIC@critical?0?$AA@ db 'critical,',0 ; DATA XREF: _v3_check_critical+20o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BA0h
; COMDAT (pick any)
		public ??_C@_04HCPFHKMD@DER?3?$AA@
; char `string'[]
??_C@_04HCPFHKMD@DER?3?$AA@ db 'DER:',0 ; DATA XREF: _v3_check_generic+26o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BA8h
; COMDAT (pick any)
		public ??_C@_05IOEBEMFO@ASN1?3?$AA@
; char `string'[]
??_C@_05IOEBEMFO@ASN1?3?$AA@ db	'ASN1:',0 ; DATA XREF: _v3_check_generic+52o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BB0h
; COMDAT (pick any)
		public ??_C@_06KFEJCPI@value?$DN?$AA@
; `string'
??_C@_06KFEJCPI@value?$DN?$AA@ db 'value=',0 ; DATA XREF: _v3_generic_extension+E6o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; int __cdecl _isspace(int C)
		extrn __imp__isspace:near ; CODE XREF: _v3_check_critical+42p
					; _v3_check_critical+56p ...
; int __cdecl _strncmp(const char *Str1, const char *Str2, size_t MaxCount)
		extrn __imp__strncmp:near ; CODE XREF: _v3_check_critical+26p
					; _v3_check_generic+2Cp ...
		extrn _sk_num:near	; CODE XREF: _X509V3_EXT_add_nconf_sk+30p
					; _X509V3_EXT_add_nconf_sk+101p ...
		extrn _sk_value:near	; CODE XREF: _X509V3_EXT_add_nconf_sk+46p
		extrn _sk_pop_free:near	; CODE XREF: _X509V3_EXT_REQ_add_conf+64p
					; _X509V3_EXT_REQ_add_nconf+55p ...
		extrn _CRYPTO_malloc:near ; CODE XREF: _do_ext_i2d+72p
		extrn _CRYPTO_free:near	; CODE XREF: _v3_generic_extension+10Dp
		extrn _ERR_put_error:near ; CODE XREF: _X509V3_EXT_add_nconf_sk+C2p
					; _X509V3_EXT_i2d+26p ...
		extrn _ERR_add_error_data:near ; CODE XREF: _X509V3_EXT_add_nconf_sk+D5p
					; _X509V3_EXT_nconf+8Ap ...
		extrn _CONF_set_nconf:near ; CODE XREF:	_X509V3_EXT_CRL_add_conf+13p
					; _X509V3_EXT_REQ_add_conf+14p	...
		extrn _CONF_get_section:near ; CODE XREF: _conf_lhash_get_sectionj
		extrn _CONF_get_string:near ; CODE XREF: _conf_lhash_get_stringj
		extrn _NCONF_get_section:near ;	CODE XREF: _nconf_get_sectionj
					; _X509V3_EXT_add_nconf_sk+13p	...
		extrn _NCONF_get_string:near ; CODE XREF: _nconf_get_stringj
		extrn _ASN1_TYPE_free:near ; CODE XREF:	_generic_asn1+3Ep
		extrn _i2d_ASN1_TYPE:near ; CODE XREF: _generic_asn1+32p
		extrn _ASN1_OBJECT_free:near ; CODE XREF: _v3_generic_extension+FAp
		extrn _ASN1_STRING_free:near ; CODE XREF: _do_ext_i2d+CEp
					; _v3_generic_extension+100p
		extrn _ASN1_STRING_type_new:near ; CODE	XREF: _do_ext_i2d+99p
					; _v3_generic_extension+86p
		extrn _ASN1_item_free:near ; CODE XREF:	_do_ext_nconf+184p
		extrn _ASN1_item_i2d:near ; CODE XREF: _do_ext_i2d+2Bp
		extrn _ASN1_generate_v3:near ; CODE XREF: _generic_asn1+1Bp
		extrn _OBJ_nid2sn:near	; CODE XREF: _X509V3_EXT_conf_nid+4Cp
					; _X509V3_EXT_nconf_nid+2Cp ...
		extrn _OBJ_txt2obj:near	; CODE XREF: _v3_generic_extension+1Ap
		extrn _OBJ_sn2nid:near	; CODE XREF: _X509V3_EXT_add_nconf_sk+90p
					; _X509V3_EXT_nconf+3Fp
		extrn _X509_EXTENSION_free:near	; CODE XREF: _X509V3_EXT_add_nconf_sk+F6p
					; DATA XREF: _X509V3_EXT_REQ_add_conf+59o ...
		extrn _X509_REQ_add_extensions:near
					; CODE XREF: _X509V3_EXT_REQ_add_conf+54p
					; _X509V3_EXT_REQ_add_nconf+45p
		extrn _X509v3_add_ext:near ; CODE XREF:	_X509V3_EXT_add_nconf_sk+EDp
		extrn _X509_EXTENSION_create_by_NID:near ; CODE	XREF: _do_ext_i2d+BBp
		extrn _X509_EXTENSION_create_by_OBJ:near
					; CODE XREF: _v3_generic_extension+C4p
		extrn _X509V3_conf_free:near ; DATA XREF: _do_ext_nconf+FCo
		extrn _X509V3_EXT_get_nid:near ; CODE XREF: _X509V3_EXT_i2d+4p
					; _do_ext_nconf+2Ap
		extrn _X509V3_parse_list:near ;	CODE XREF: _do_ext_nconf+8Ap
		extrn _string_to_hex:near ; CODE XREF: _v3_generic_extension+5Dp
		extrn __chkstk:near	; CODE XREF: _X509V3_EXT_CRL_add_conf+5p
					; _X509V3_EXT_REQ_add_conf+5p ...


		end
