;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	F6374B31BAF6DAB1631F4EA22A6AA5F7
; Input	CRC32 :	E4E59FFD

; File Name   :	C:\compspace\Diff\openssl\obj\aes-586.obj
; Format      :	COFF (X386MAGIC)

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
; Segment alignment '64byte' can not be represented in assembly
_text		segment	para public 'CODE' use32
		assume cs:_text
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


__x86_AES_encrypt_compact proc near	; CODE XREF: L$_AES_encrypt_begin+8Fp
					; L$_AES_cbc_encrypt_begin+45Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	[esp+arg_10], edi
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi
		mov	edi, [ebp-80h]
		mov	esi, [ebp-60h]
		mov	edi, [ebp-40h]
		mov	esi, [ebp-20h]
		mov	edi, [ebp+0]
		mov	esi, [ebp+20h]
		mov	edi, [ebp+40h]
		mov	esi, [ebp+60h]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$000loop:				; CODE XREF: __x86_AES_encrypt_compact+236j
		mov	esi, eax
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		shr	ebx, 10h
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, ch
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, eax
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		shr	ecx, 18h
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, dh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edx, 0FFh
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		and	edx, 0FFh
		movzx	edx, byte ptr [ebp+edx-80h]
		movzx	eax, ah
		movzx	eax, byte ptr [ebp+eax-80h]
		shl	eax, 8
		xor	edx, eax
		mov	eax, [esp+arg_0]
		and	ebx, 0FFh
		movzx	ebx, byte ptr [ebp+ebx-80h]
		shl	ebx, 10h
		xor	edx, ebx
		mov	ebx, [esp+arg_4]
		movzx	ecx, byte ptr [ebp+ecx-80h]
		shl	ecx, 18h
		xor	edx, ecx
		mov	ecx, esi
		mov	ebp, 80808080h
		and	ebp, ecx
		lea	edi, [ecx+ecx]
		mov	esi, ebp
		shr	ebp, 7
		and	edi, 0FEFEFEFEh
		sub	esi, ebp
		mov	ebp, ecx
		and	esi, 1B1B1B1Bh
		ror	ebp, 10h
		xor	esi, edi
		mov	edi, ecx
		xor	ecx, esi
		ror	edi, 18h
		xor	esi, ebp
		rol	ecx, 18h
		xor	esi, edi
		mov	ebp, 80808080h
		xor	ecx, esi
		and	ebp, edx
		lea	edi, [edx+edx]
		mov	esi, ebp
		shr	ebp, 7
		and	edi, 0FEFEFEFEh
		sub	esi, ebp
		mov	ebp, edx
		and	esi, 1B1B1B1Bh
		ror	ebp, 10h
		xor	esi, edi
		mov	edi, edx
		xor	edx, esi
		ror	edi, 18h
		xor	esi, ebp
		rol	edx, 18h
		xor	esi, edi
		mov	ebp, 80808080h
		xor	edx, esi
		and	ebp, eax
		lea	edi, [eax+eax]
		mov	esi, ebp
		shr	ebp, 7
		and	edi, 0FEFEFEFEh
		sub	esi, ebp
		mov	ebp, eax
		and	esi, 1B1B1B1Bh
		ror	ebp, 10h
		xor	esi, edi
		mov	edi, eax
		xor	eax, esi
		ror	edi, 18h
		xor	esi, ebp
		rol	eax, 18h
		xor	esi, edi
		mov	ebp, 80808080h
		xor	eax, esi
		and	ebp, ebx
		lea	edi, [ebx+ebx]
		mov	esi, ebp
		shr	ebp, 7
		and	edi, 0FEFEFEFEh
		sub	esi, ebp
		mov	ebp, ebx
		and	esi, 1B1B1B1Bh
		ror	ebp, 10h
		xor	esi, edi
		mov	edi, ebx
		xor	ebx, esi
		ror	edi, 18h
		xor	esi, ebp
		rol	ebx, 18h
		xor	esi, edi
		xor	ebx, esi
		mov	edi, [esp+arg_10]
		mov	ebp, [esp+arg_18]
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		cmp	edi, [esp+arg_14]
		mov	[esp+arg_10], edi
		jb	L$000loop
		mov	esi, eax
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		shr	ebx, 10h
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, ch
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, eax
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		shr	ecx, 18h
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, dh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edx, 0FFh
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	edi, [esp+arg_10]
		and	edx, 0FFh
		movzx	edx, byte ptr [ebp+edx-80h]
		movzx	eax, ah
		movzx	eax, byte ptr [ebp+eax-80h]
		shl	eax, 8
		xor	edx, eax
		mov	eax, [esp+arg_0]
		and	ebx, 0FFh
		movzx	ebx, byte ptr [ebp+ebx-80h]
		shl	ebx, 10h
		xor	edx, ebx
		mov	ebx, [esp+arg_4]
		movzx	ecx, byte ptr [ebp+ecx-80h]
		shl	ecx, 18h
		xor	edx, ecx
		mov	ecx, esi
		xor	eax, [edi+10h]
		xor	ebx, [edi+14h]
		xor	ecx, [edi+18h]
		xor	edx, [edi+1Ch]
		retn
__x86_AES_encrypt_compact endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__sse_AES_encrypt_compact proc near	; CODE XREF: L$_AES_encrypt_begin+63p
					; L$_AES_cbc_encrypt_begin+3DBp

arg_4		= qword	ptr  8
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		pxor	mm0, qword ptr [edi]
		pxor	mm4, qword ptr [edi+8]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi
		mov	eax, 1B1B1B1Bh
		mov	dword ptr [esp+arg_4], eax
		mov	dword ptr [esp+arg_4+4], eax
		mov	eax, [ebp-80h]
		mov	ebx, [ebp-60h]
		mov	ecx, [ebp-40h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp+0]
		mov	ebx, [ebp+20h]
		mov	ecx, [ebp+40h]
		mov	edx, [ebp+60h]
		nop
		nop
		nop

L$001loop:				; CODE XREF: __sse_AES_encrypt_compact+1F2j
		pshufw	mm1, mm0, 8
		pshufw	mm5, mm4, 0Dh
		movd	eax, mm1
		movd	ebx, mm5
		mov	[esp+arg_10], edi
		movzx	esi, al
		movzx	edx, ah
		pshufw	mm2, mm0, 0Dh
		movzx	ecx, byte ptr [ebp+esi-80h]
		movzx	edi, bl
		movzx	edx, byte ptr [ebp+edx-80h]
		shr	eax, 10h
		shl	edx, 8
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 10h
		pshufw	mm6, mm4, 8
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, ah
		shl	esi, 18h
		shr	ebx, 10h
		or	edx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 8
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, al
		shl	esi, 18h
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bl
		movd	eax, mm2
		movd	mm0, ecx
		movzx	ecx, byte ptr [ebp+edi-80h]
		movzx	edi, ah
		shl	ecx, 10h
		movd	ebx, mm6
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 18h
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bl
		shl	esi, 8
		shr	ebx, 10h
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, al
		shr	eax, 10h
		movd	mm1, ecx
		movzx	ecx, byte ptr [ebp+edi-80h]
		movzx	edi, ah
		shl	ecx, 10h
		and	eax, 0FFh
		or	ecx, esi
		punpckldq mm0, mm1
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 18h
		and	ebx, 0FFh
		movzx	eax, byte ptr [ebp+eax-80h]
		or	ecx, esi
		shl	eax, 10h
		movzx	esi, byte ptr [ebp+edi-80h]
		or	edx, eax
		shl	esi, 8
		movzx	ebx, byte ptr [ebp+ebx-80h]
		or	ecx, esi
		or	edx, ebx
		mov	edi, [esp+arg_10]
		movd	mm4, ecx
		movd	mm5, edx
		punpckldq mm4, mm5
		add	edi, 10h
		cmp	edi, [esp+arg_14]
		ja	L$002out
		movq	mm2, [esp+arg_4]
		pxor	mm3, mm3
		pxor	mm7, mm7
		movq	mm1, mm0
		movq	mm5, mm4
		pcmpgtb	mm3, mm0
		pcmpgtb	mm7, mm4
		pand	mm3, mm2
		pand	mm7, mm2
		pshufw	mm2, mm0, 0B1h
		pshufw	mm6, mm4, 0B1h
		paddb	mm0, mm0
		paddb	mm4, mm4
		pxor	mm0, mm3
		pxor	mm4, mm7
		pshufw	mm3, mm2, 0B1h
		pshufw	mm7, mm6, 0B1h
		pxor	mm1, mm0
		pxor	mm5, mm4
		pxor	mm0, mm2
		pxor	mm4, mm6
		movq	mm2, mm3
		movq	mm6, mm7
		pslld	mm3, 8
		pslld	mm7, 8
		psrld	mm2, 18h
		psrld	mm6, 18h
		pxor	mm0, mm3
		pxor	mm4, mm7
		pxor	mm0, mm2
		pxor	mm4, mm6
		movq	mm3, mm1
		movq	mm7, mm5
		movq	mm2, qword ptr [edi]
		movq	mm6, qword ptr [edi+8]
		psrld	mm1, 8
		psrld	mm5, 8
		mov	eax, [ebp-80h]
		pslld	mm3, 18h
		pslld	mm7, 18h
		mov	ebx, [ebp-40h]
		pxor	mm0, mm1
		pxor	mm4, mm5
		mov	ecx, [ebp+0]
		pxor	mm0, mm3
		pxor	mm4, mm7
		mov	edx, [ebp+40h]
		pxor	mm0, mm2
		pxor	mm4, mm6
		jmp	L$001loop
; ---------------------------------------------------------------------------
		align 10h

L$002out:				; CODE XREF: __sse_AES_encrypt_compact+14Aj
		pxor	mm0, qword ptr [edi]
		pxor	mm4, qword ptr [edi+8]
		retn
__sse_AES_encrypt_compact endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__x86_AES_encrypt proc near		; CODE XREF: L$_AES_cbc_encrypt_begin+175p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	[esp+arg_10], edi
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi

L$003loop:				; CODE XREF: __x86_AES_encrypt+F0j
		mov	esi, eax
		and	esi, 0FFh
		mov	esi, [ebp+esi*8+0]
		movzx	edi, bh
		xor	esi, [ebp+edi*8+3]
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		mov	edi, edx
		shr	edi, 18h
		xor	esi, [ebp+edi*8+1]
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		shr	ebx, 10h
		mov	esi, [ebp+esi*8+0]
		movzx	edi, ch
		xor	esi, [ebp+edi*8+3]
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		mov	edi, eax
		shr	edi, 18h
		xor	esi, [ebp+edi*8+1]
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		shr	ecx, 18h
		mov	esi, [ebp+esi*8+0]
		movzx	edi, dh
		xor	esi, [ebp+edi*8+3]
		mov	edi, eax
		shr	edi, 10h
		and	edx, 0FFh
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		movzx	edi, bh
		xor	esi, [ebp+edi*8+1]
		mov	edi, [esp+arg_10]
		mov	edx, [ebp+edx*8+0]
		movzx	eax, ah
		xor	edx, [ebp+eax*8+3]
		mov	eax, [esp+arg_0]
		and	ebx, 0FFh
		xor	edx, [ebp+ebx*8+2]
		mov	ebx, [esp+arg_4]
		xor	edx, [ebp+ecx*8+1]
		mov	ecx, esi
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		cmp	edi, [esp+arg_14]
		mov	[esp+arg_10], edi
		jb	L$003loop
		mov	esi, eax
		and	esi, 0FFh
		mov	esi, [ebp+esi*8+2]
		and	esi, 0FFh
		movzx	edi, bh
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF00h
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF0000h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		mov	edi, [ebp+edi*8+2]
		and	edi, 0FF000000h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		shr	ebx, 10h
		mov	esi, [ebp+esi*8+2]
		and	esi, 0FFh
		movzx	edi, ch
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF00h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF0000h
		xor	esi, edi
		mov	edi, eax
		shr	edi, 18h
		mov	edi, [ebp+edi*8+2]
		and	edi, 0FF000000h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		shr	ecx, 18h
		mov	esi, [ebp+esi*8+2]
		and	esi, 0FFh
		movzx	edi, dh
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF00h
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edx, 0FFh
		and	edi, 0FFh
		mov	edi, [ebp+edi*8+0]
		and	edi, 0FF0000h
		xor	esi, edi
		movzx	edi, bh
		mov	edi, [ebp+edi*8+2]
		and	edi, 0FF000000h
		xor	esi, edi
		mov	edi, [esp+arg_10]
		and	edx, 0FFh
		mov	edx, [ebp+edx*8+2]
		and	edx, 0FFh
		movzx	eax, ah
		mov	eax, [ebp+eax*8+0]
		and	eax, 0FF00h
		xor	edx, eax
		mov	eax, [esp+arg_0]
		and	ebx, 0FFh
		mov	ebx, [ebp+ebx*8+0]
		and	ebx, 0FF0000h
		xor	edx, ebx
		mov	ebx, [esp+arg_4]
		mov	ecx, [ebp+ecx*8+2]
		and	ecx, 0FF000000h
		xor	edx, ecx
		mov	ecx, esi
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		retn
__x86_AES_encrypt endp

; ---------------------------------------------------------------------------
		align 20h
L$AES_Te	dd 2 dup(0A56363C6h), 2	dup(847C7CF8h),	2 dup(997777EEh)
		dd 2 dup(8D7B7BF6h), 2 dup(0DF2F2FFh), 2 dup(0BD6B6BD6h)
		dd 2 dup(0B16F6FDEh), 2	dup(54C5C591h),	2 dup(50303060h)
		dd 2 dup(3010102h), 2 dup(0A96767CEh), 2 dup(7D2B2B56h)
		dd 2 dup(19FEFEE7h), 2 dup(62D7D7B5h), 2 dup(0E6ABAB4Dh)
		dd 2 dup(9A7676ECh), 2 dup(45CACA8Fh), 2 dup(9D82821Fh)
		dd 2 dup(40C9C989h), 2 dup(877D7DFAh), 2 dup(15FAFAEFh)
		dd 2 dup(0EB5959B2h), 2	dup(0C947478Eh), 2 dup(0BF0F0FBh)
		dd 2 dup(0ECADAD41h), 2	dup(67D4D4B3h),	2 dup(0FDA2A25Fh)
		dd 2 dup(0EAAFAF45h), 2	dup(0BF9C9C23h), 2 dup(0F7A4A453h)
		dd 2 dup(967272E4h), 2 dup(5BC0C09Bh), 2 dup(0C2B7B775h)
		dd 2 dup(1CFDFDE1h), 2 dup(0AE93933Dh),	2 dup(6A26264Ch)
		dd 2 dup(5A36366Ch), 2 dup(413F3F7Eh), 2 dup(2F7F7F5h)
		dd 2 dup(4FCCCC83h), 2 dup(5C343468h), 2 dup(0F4A5A551h)
		dd 2 dup(34E5E5D1h), 2 dup(8F1F1F9h), 2	dup(937171E2h)
		dd 2 dup(73D8D8ABh), 2 dup(53313162h), 2 dup(3F15152Ah)
		dd 2 dup(0C040408h), 2 dup(52C7C795h), 2 dup(65232346h)
		dd 2 dup(5EC3C39Dh), 2 dup(28181830h), 2 dup(0A1969637h)
		dd 2 dup(0F05050Ah), 2 dup(0B59A9A2Fh),	2 dup(907070Eh)
		dd 2 dup(36121224h), 2 dup(9B80801Bh), 2 dup(3DE2E2DFh)
		dd 2 dup(26EBEBCDh), 2 dup(6927274Eh), 2 dup(0CDB2B27Fh)
		dd 2 dup(9F7575EAh), 2 dup(1B090912h), 2 dup(9E83831Dh)
		dd 2 dup(742C2C58h), 2 dup(2E1A1A34h), 2 dup(2D1B1B36h)
		dd 2 dup(0B26E6EDCh), 2	dup(0EE5A5AB4h), 2 dup(0FBA0A05Bh)
		dd 2 dup(0F65252A4h), 2	dup(4D3B3B76h),	2 dup(61D6D6B7h)
		dd 2 dup(0CEB3B37Dh), 2	dup(7B292952h),	2 dup(3EE3E3DDh)
		dd 2 dup(712F2F5Eh), 2 dup(97848413h), 2 dup(0F55353A6h)
		dd 2 dup(68D1D1B9h), 2 dup(0)
		dd 2 dup(2CEDEDC1h), 2 dup(60202040h), 2 dup(1FFCFCE3h)
		dd 2 dup(0C8B1B179h), 2	dup(0ED5B5BB6h), 2 dup(0BE6A6AD4h)
		dd 2 dup(46CBCB8Dh), 2 dup(0D9BEBE67h),	2 dup(4B393972h)
		dd 2 dup(0DE4A4A94h), 2	dup(0D44C4C98h), 2 dup(0E85858B0h)
		dd 2 dup(4ACFCF85h), 2 dup(6BD0D0BBh), 2 dup(2AEFEFC5h)
		dd 2 dup(0E5AAAA4Fh), 2	dup(16FBFBEDh),	2 dup(0C5434386h)
		dd 2 dup(0D74D4D9Ah), 2	dup(55333366h),	2 dup(94858511h)
		dd 2 dup(0CF45458Ah), 2	dup(10F9F9E9h),	2 dup(6020204h)
		dd 2 dup(817F7FFEh), 2 dup(0F05050A0h),	2 dup(443C3C78h)
		dd 2 dup(0BA9F9F25h), 2	dup(0E3A8A84Bh), 2 dup(0F35151A2h)
		dd 2 dup(0FEA3A35Dh), 2	dup(0C0404080h), 2 dup(8A8F8F05h)
		dd 2 dup(0AD92923Fh), 2	dup(0BC9D9D21h), 2 dup(48383870h)
		dd 2 dup(4F5F5F1h), 2 dup(0DFBCBC63h), 2 dup(0C1B6B677h)
		dd 2 dup(75DADAAFh), 2 dup(63212142h), 2 dup(30101020h)
		dd 2 dup(1AFFFFE5h), 2 dup(0EF3F3FDh), 2 dup(6DD2D2BFh)
		dd 2 dup(4CCDCD81h), 2 dup(140C0C18h), 2 dup(35131326h)
		dd 2 dup(2FECECC3h), 2 dup(0E15F5FBEh),	2 dup(0A2979735h)
		dd 2 dup(0CC444488h), 2	dup(3917172Eh),	2 dup(57C4C493h)
		dd 2 dup(0F2A7A755h), 2	dup(827E7EFCh),	2 dup(473D3D7Ah)
		dd 2 dup(0AC6464C8h), 2	dup(0E75D5DBAh), 2 dup(2B191932h)
		dd 2 dup(957373E6h), 2 dup(0A06060C0h),	2 dup(98818119h)
		dd 2 dup(0D14F4F9Eh), 2	dup(7FDCDCA3h),	2 dup(66222244h)
		dd 2 dup(7E2A2A54h), 2 dup(0AB90903Bh),	2 dup(8388880Bh)
		dd 2 dup(0CA46468Ch), 2	dup(29EEEEC7h),	2 dup(0D3B8B86Bh)
		dd 2 dup(3C141428h), 2 dup(79DEDEA7h), 2 dup(0E25E5EBCh)
		dd 2 dup(1D0B0B16h), 2 dup(76DBDBADh), 2 dup(3BE0E0DBh)
		dd 2 dup(56323264h), 2 dup(4E3A3A74h), 2 dup(1E0A0A14h)
		dd 2 dup(0DB494992h), 2	dup(0A06060Ch),	2 dup(6C242448h)
		dd 2 dup(0E45C5CB8h), 2	dup(5DC2C29Fh),	2 dup(6ED3D3BDh)
		dd 2 dup(0EFACAC43h), 2	dup(0A66262C4h), 2 dup(0A8919139h)
		dd 2 dup(0A4959531h), 2	dup(37E4E4D3h),	2 dup(8B7979F2h)
		dd 2 dup(32E7E7D5h), 2 dup(43C8C88Bh), 2 dup(5937376Eh)
		dd 2 dup(0B76D6DDAh), 2	dup(8C8D8D01h),	2 dup(64D5D5B1h)
		dd 2 dup(0D24E4E9Ch), 2	dup(0E0A9A949h), 2 dup(0B46C6CD8h)
		dd 2 dup(0FA5656ACh), 2	dup(7F4F4F3h), 2 dup(25EAEACFh)
		dd 2 dup(0AF6565CAh), 2	dup(8E7A7AF4h),	2 dup(0E9AEAE47h)
		dd 2 dup(18080810h), 2 dup(0D5BABA6Fh),	2 dup(887878F0h)
		dd 2 dup(6F25254Ah), 2 dup(722E2E5Ch), 2 dup(241C1C38h)
		dd 2 dup(0F1A6A657h), 2	dup(0C7B4B473h), 2 dup(51C6C697h)
		dd 2 dup(23E8E8CBh), 2 dup(7CDDDDA1h), 2 dup(9C7474E8h)
		dd 2 dup(211F1F3Eh), 2 dup(0DD4B4B96h),	2 dup(0DCBDBD61h)
		dd 2 dup(868B8B0Dh), 2 dup(858A8A0Fh), 2 dup(907070E0h)
		dd 2 dup(423E3E7Ch), 2 dup(0C4B5B571h),	2 dup(0AA6666CCh)
		dd 2 dup(0D8484890h), 2	dup(5030306h), 2 dup(1F6F6F7h)
		dd 2 dup(120E0E1Ch), 2 dup(0A36161C2h),	2 dup(5F35356Ah)
		dd 2 dup(0F95757AEh), 2	dup(0D0B9B969h), 2 dup(91868617h)
		dd 2 dup(58C1C199h), 2 dup(271D1D3Ah), 2 dup(0B99E9E27h)
		dd 2 dup(38E1E1D9h), 2 dup(13F8F8EBh), 2 dup(0B398982Bh)
		dd 2 dup(33111122h), 2 dup(0BB6969D2h),	2 dup(70D9D9A9h)
		dd 2 dup(898E8E07h), 2 dup(0A7949433h),	2 dup(0B69B9B2Dh)
		dd 2 dup(221E1E3Ch), 2 dup(92878715h), 2 dup(20E9E9C9h)
		dd 2 dup(49CECE87h), 2 dup(0FF5555AAh),	2 dup(78282850h)
		dd 2 dup(7ADFDFA5h), 2 dup(8F8C8C03h), 2 dup(0F8A1A159h)
		dd 2 dup(80898909h), 2 dup(170D0D1Ah), 2 dup(0DABFBF65h)
		dd 2 dup(31E6E6D7h), 2 dup(0C6424284h),	2 dup(0B86868D0h)
		dd 2 dup(0C3414182h), 2	dup(0B0999929h), 2 dup(772D2D5Ah)
		dd 2 dup(110F0F1Eh), 2 dup(0CBB0B07Bh),	2 dup(0FC5454A8h)
		dd 2 dup(0D6BBBB6Dh), 2	dup(3A16162Ch),	7B777C63h, 0C56F6BF2h
		dd 2B670130h, 76ABD7FEh, 7DC982CAh, 0F04759FAh,	0AFA2D4ADh
		dd 0C072A49Ch, 2693FDB7h, 0CCF73F36h, 0F1E5A534h, 1531D871h
		dd 0C323C704h, 9A059618h, 0E2801207h, 75B227EBh, 1A2C8309h
		dd 0A05A6E1Bh, 0B3D63B52h, 842FE329h, 0ED00D153h, 5BB1FC20h
		dd 39BECB6Ah, 0CF584C4Ah, 0FBAAEFD0h, 85334D43h, 7F02F945h
		dd 0A89F3C50h, 8F40A351h, 0F5389D92h, 21DAB6BCh, 0D2F3FF10h
		dd 0EC130CCDh, 1744975Fh, 3D7EA7C4h, 73195D64h,	0DC4F8160h
		dd 88902A22h, 14B8EE46h, 0DB0B5EDEh, 0A3A32E0h,	5C240649h
		dd 62ACD3C2h, 79E49591h, 6D37C8E7h, 0A94ED58Dh,	0EAF4566Ch
		dd 8AE7A65h, 2E2578BAh,	0C6B4A61Ch, 1F74DDE8h, 8A8BBD4Bh
		dd 66B53E70h, 0EF60348h, 0B9573561h, 9E1DC186h,	1198F8E1h
		dd 948ED969h, 0E9871E9Bh, 0DF2855CEh, 0D89A18Ch, 6842E6BFh
		dd 0F2D9941h, 16BB54B0h, 7B777C63h, 0C56F6BF2h,	2B670130h
		dd 76ABD7FEh, 7DC982CAh, 0F04759FAh, 0AFA2D4ADh, 0C072A49Ch
		dd 2693FDB7h, 0CCF73F36h, 0F1E5A534h, 1531D871h, 0C323C704h
		dd 9A059618h, 0E2801207h, 75B227EBh, 1A2C8309h,	0A05A6E1Bh
		dd 0B3D63B52h, 842FE329h, 0ED00D153h, 5BB1FC20h, 39BECB6Ah
		dd 0CF584C4Ah, 0FBAAEFD0h, 85334D43h, 7F02F945h, 0A89F3C50h
		dd 8F40A351h, 0F5389D92h, 21DAB6BCh, 0D2F3FF10h, 0EC130CCDh
		dd 1744975Fh, 3D7EA7C4h, 73195D64h, 0DC4F8160h,	88902A22h
		dd 14B8EE46h, 0DB0B5EDEh, 0A3A32E0h, 5C240649h,	62ACD3C2h
		dd 79E49591h, 6D37C8E7h, 0A94ED58Dh, 0EAF4566Ch, 8AE7A65h
		dd 2E2578BAh, 0C6B4A61Ch, 1F74DDE8h, 8A8BBD4Bh,	66B53E70h
		dd 0EF60348h, 0B9573561h, 9E1DC186h, 1198F8E1h,	948ED969h
		dd 0E9871E9Bh, 0DF2855CEh, 0D89A18Ch, 6842E6BFh, 0F2D9941h
		dd 16BB54B0h, 7B777C63h, 0C56F6BF2h, 2B670130h,	76ABD7FEh
		dd 7DC982CAh, 0F04759FAh, 0AFA2D4ADh, 0C072A49Ch, 2693FDB7h
		dd 0CCF73F36h, 0F1E5A534h, 1531D871h, 0C323C704h, 9A059618h
		dd 0E2801207h, 75B227EBh, 1A2C8309h, 0A05A6E1Bh, 0B3D63B52h
		dd 842FE329h, 0ED00D153h, 5BB1FC20h, 39BECB6Ah,	0CF584C4Ah
		dd 0FBAAEFD0h, 85334D43h, 7F02F945h, 0A89F3C50h, 8F40A351h
		dd 0F5389D92h, 21DAB6BCh, 0D2F3FF10h, 0EC130CCDh, 1744975Fh
		dd 3D7EA7C4h, 73195D64h, 0DC4F8160h, 88902A22h,	14B8EE46h
		dd 0DB0B5EDEh, 0A3A32E0h, 5C240649h, 62ACD3C2h,	79E49591h
		dd 6D37C8E7h, 0A94ED58Dh, 0EAF4566Ch, 8AE7A65h,	2E2578BAh
		dd 0C6B4A61Ch, 1F74DDE8h, 8A8BBD4Bh, 66B53E70h,	0EF60348h
		dd 0B9573561h, 9E1DC186h, 1198F8E1h, 948ED969h,	0E9871E9Bh
		dd 0DF2855CEh, 0D89A18Ch, 6842E6BFh, 0F2D9941h,	16BB54B0h
		dd 7B777C63h, 0C56F6BF2h, 2B670130h, 76ABD7FEh,	7DC982CAh
		dd 0F04759FAh, 0AFA2D4ADh, 0C072A49Ch, 2693FDB7h, 0CCF73F36h
		dd 0F1E5A534h, 1531D871h, 0C323C704h, 9A059618h, 0E2801207h
		dd 75B227EBh, 1A2C8309h, 0A05A6E1Bh, 0B3D63B52h, 842FE329h
		dd 0ED00D153h, 5BB1FC20h, 39BECB6Ah, 0CF584C4Ah, 0FBAAEFD0h
		dd 85334D43h, 7F02F945h, 0A89F3C50h, 8F40A351h,	0F5389D92h
		dd 21DAB6BCh, 0D2F3FF10h, 0EC130CCDh, 1744975Fh, 3D7EA7C4h
		dd 73195D64h, 0DC4F8160h, 88902A22h, 14B8EE46h,	0DB0B5EDEh
		dd 0A3A32E0h, 5C240649h, 62ACD3C2h, 79E49591h, 6D37C8E7h
		dd 0A94ED58Dh, 0EAF4566Ch, 8AE7A65h, 2E2578BAh,	0C6B4A61Ch
		dd 1F74DDE8h, 8A8BBD4Bh, 66B53E70h, 0EF60348h, 0B9573561h
		dd 9E1DC186h, 1198F8E1h, 948ED969h, 0E9871E9Bh,	0DF2855CEh
		dd 0D89A18Ch, 6842E6BFh, 0F2D9941h, 16BB54B0h, 1, 2, 4
		dd 8, 10h, 20h,	40h, 80h, 1Bh, 36h, 6 dup(0)

; =============== S U B	R O U T	I N E =======================================


		public L$_AES_encrypt_begin
L$_AES_encrypt_begin proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_2C8		= byte ptr  2CCh

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_0]
		mov	edi, [esp+10h+arg_8]
		mov	eax, esp
		sub	esp, 24h
		and	esp, 0FFFFFFC0h
		lea	ebx, [edi-7Fh]
		sub	ebx, esp
		neg	ebx
		and	ebx, 3C0h
		sub	esp, ebx
		add	esp, 4
		mov	[esp+30h+var_14], eax
		call	$+5

L$004pic_point:
		pop	ebp
		lea	eax, large ds:3740h
		lea	ebp, [ebp-0C6Fh]
		lea	ebx, [esp+30h+arg_2C8]
		sub	ebx, ebp
		and	ebx, 300h
		lea	ebp, [ebp+ebx+880h]
		bt	dword ptr [eax], 19h
		jnb	L$005x86
		movq	mm0, qword ptr [esi]
		movq	mm4, qword ptr [esi+8]
		call	__sse_AES_encrypt_compact
		mov	esp, [esp+30h+var_14]
		mov	esi, [esp+10h+arg_4]
		movq	qword ptr [esi], mm0
		movq	qword ptr [esi+8], mm4
		emms
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

L$005x86:				; CODE XREF: L$_AES_encrypt_begin+56j
		mov	[esp+30h+var_18], ebp
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		call	__x86_AES_encrypt_compact
		mov	esp, [esp+30h+var_14]
		mov	esi, [esp+10h+arg_4]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_AES_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__x86_AES_decrypt_compact proc near	; CODE XREF: L$_AES_decrypt_begin+8Fp
					; L$_AES_cbc_encrypt_begin+5CEp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	[esp+arg_10], edi
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi
		mov	edi, [ebp-80h]
		mov	esi, [ebp-60h]
		mov	edi, [ebp-40h]
		mov	esi, [ebp-20h]
		mov	edi, [ebp+0]
		mov	esi, [ebp+20h]
		mov	edi, [ebp+40h]
		mov	esi, [ebp+60h]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$006loop:				; CODE XREF: __x86_AES_decrypt_compact+365j
		mov	esi, eax
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, dh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ebx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, ah
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		and	edx, 0FFh
		movzx	edx, byte ptr [ebp+edx-80h]
		movzx	ecx, ch
		movzx	ecx, byte ptr [ebp+ecx-80h]
		shl	ecx, 8
		xor	edx, ecx
		mov	ecx, esi
		shr	ebx, 10h
		and	ebx, 0FFh
		movzx	ebx, byte ptr [ebp+ebx-80h]
		shl	ebx, 10h
		xor	edx, ebx
		shr	eax, 18h
		movzx	eax, byte ptr [ebp+eax-80h]
		shl	eax, 18h
		xor	edx, eax
		mov	edi, 80808080h
		and	edi, ecx
		mov	esi, edi
		shr	edi, 7
		lea	eax, [ecx+ecx]
		sub	esi, edi
		and	eax, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	eax, esi
		mov	edi, 80808080h
		and	edi, eax
		mov	esi, edi
		shr	edi, 7
		lea	ebx, [eax+eax]
		sub	esi, edi
		and	ebx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	eax, ecx
		xor	ebx, esi
		mov	edi, 80808080h
		and	edi, ebx
		mov	esi, edi
		shr	edi, 7
		lea	ebp, [ebx+ebx]
		sub	esi, edi
		and	ebp, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ebx, ecx
		rol	ecx, 8
		xor	ebp, esi
		xor	ecx, eax
		xor	eax, ebp
		xor	ecx, ebx
		xor	ebx, ebp
		rol	eax, 18h
		xor	ecx, ebp
		rol	ebx, 10h
		xor	ecx, eax
		rol	ebp, 8
		xor	ecx, ebx
		mov	eax, [esp+arg_0]
		xor	ecx, ebp
		mov	[esp+arg_8], ecx
		mov	edi, 80808080h
		and	edi, edx
		mov	esi, edi
		shr	edi, 7
		lea	ebx, [edx+edx]
		sub	esi, edi
		and	ebx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ebx, esi
		mov	edi, 80808080h
		and	edi, ebx
		mov	esi, edi
		shr	edi, 7
		lea	ecx, [ebx+ebx]
		sub	esi, edi
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ebx, edx
		xor	ecx, esi
		mov	edi, 80808080h
		and	edi, ecx
		mov	esi, edi
		shr	edi, 7
		lea	ebp, [ecx+ecx]
		sub	esi, edi
		and	ebp, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, edx
		rol	edx, 8
		xor	ebp, esi
		xor	edx, ebx
		xor	ebx, ebp
		xor	edx, ecx
		xor	ecx, ebp
		rol	ebx, 18h
		xor	edx, ebp
		rol	ecx, 10h
		xor	edx, ebx
		rol	ebp, 8
		xor	edx, ecx
		mov	ebx, [esp+arg_4]
		xor	edx, ebp
		mov	[esp+arg_C], edx
		mov	edi, 80808080h
		and	edi, eax
		mov	esi, edi
		shr	edi, 7
		lea	ecx, [eax+eax]
		sub	esi, edi
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, esi
		mov	edi, 80808080h
		and	edi, ecx
		mov	esi, edi
		shr	edi, 7
		lea	edx, [ecx+ecx]
		sub	esi, edi
		and	edx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, eax
		xor	edx, esi
		mov	edi, 80808080h
		and	edi, edx
		mov	esi, edi
		shr	edi, 7
		lea	ebp, [edx+edx]
		sub	esi, edi
		and	ebp, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	edx, eax
		rol	eax, 8
		xor	ebp, esi
		xor	eax, ecx
		xor	ecx, ebp
		xor	eax, edx
		xor	edx, ebp
		rol	ecx, 18h
		xor	eax, ebp
		rol	edx, 10h
		xor	eax, ecx
		rol	ebp, 8
		xor	eax, edx
		xor	eax, ebp
		mov	edi, 80808080h
		and	edi, ebx
		mov	esi, edi
		shr	edi, 7
		lea	ecx, [ebx+ebx]
		sub	esi, edi
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, esi
		mov	edi, 80808080h
		and	edi, ecx
		mov	esi, edi
		shr	edi, 7
		lea	edx, [ecx+ecx]
		sub	esi, edi
		and	edx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, ebx
		xor	edx, esi
		mov	edi, 80808080h
		and	edi, edx
		mov	esi, edi
		shr	edi, 7
		lea	ebp, [edx+edx]
		sub	esi, edi
		and	ebp, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	edx, ebx
		rol	ebx, 8
		xor	ebp, esi
		xor	ebx, ecx
		xor	ecx, ebp
		xor	ebx, edx
		xor	edx, ebp
		rol	ecx, 18h
		xor	ebx, ebp
		rol	edx, 10h
		xor	ebx, ecx
		rol	ebp, 8
		xor	ebx, edx
		mov	ecx, [esp+arg_8]
		xor	ebx, ebp
		mov	edx, [esp+arg_C]
		mov	edi, [esp+arg_10]
		mov	ebp, [esp+arg_18]
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		cmp	edi, [esp+arg_14]
		mov	[esp+arg_10], edi
		jb	L$006loop
		mov	esi, eax
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, dh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ebx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, ah
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi-80h]
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 8
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi-80h]
		shl	edi, 18h
		xor	esi, edi
		mov	edi, [esp+arg_10]
		and	edx, 0FFh
		movzx	edx, byte ptr [ebp+edx-80h]
		movzx	ecx, ch
		movzx	ecx, byte ptr [ebp+ecx-80h]
		shl	ecx, 8
		xor	edx, ecx
		mov	ecx, esi
		shr	ebx, 10h
		and	ebx, 0FFh
		movzx	ebx, byte ptr [ebp+ebx-80h]
		shl	ebx, 10h
		xor	edx, ebx
		mov	ebx, [esp+arg_4]
		shr	eax, 18h
		movzx	eax, byte ptr [ebp+eax-80h]
		shl	eax, 18h
		xor	edx, eax
		mov	eax, [esp+arg_0]
		xor	eax, [edi+10h]
		xor	ebx, [edi+14h]
		xor	ecx, [edi+18h]
		xor	edx, [edi+1Ch]
		retn
__x86_AES_decrypt_compact endp


; =============== S U B	R O U T	I N E =======================================


__sse_AES_decrypt_compact proc near	; CODE XREF: L$_AES_decrypt_begin+63p
					; L$_AES_cbc_encrypt_begin+527p

arg_4		= qword	ptr  8
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		pxor	mm0, qword ptr [edi]
		pxor	mm4, qword ptr [edi+8]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi
		mov	eax, 1B1B1B1Bh
		mov	dword ptr [esp+arg_4], eax
		mov	dword ptr [esp+arg_4+4], eax
		mov	eax, [ebp-80h]
		mov	ebx, [ebp-60h]
		mov	ecx, [ebp-40h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp+0]
		mov	ebx, [ebp+20h]
		mov	ecx, [ebp+40h]
		mov	edx, [ebp+60h]
		nop
		nop
		nop

L$007loop:				; CODE XREF: __sse_AES_decrypt_compact+2B3j
		pshufw	mm1, mm0, 0Ch
		pshufw	mm5, mm4, 9
		movd	eax, mm1
		movd	ebx, mm5
		mov	[esp+arg_10], edi
		movzx	esi, al
		movzx	edx, ah
		pshufw	mm2, mm0, 6
		movzx	ecx, byte ptr [ebp+esi-80h]
		movzx	edi, bl
		movzx	edx, byte ptr [ebp+edx-80h]
		shr	eax, 10h
		shl	edx, 8
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 10h
		pshufw	mm6, mm4, 3
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, ah
		shl	esi, 18h
		shr	ebx, 10h
		or	edx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	esi, 18h
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, al
		shl	esi, 8
		movd	eax, mm2
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bl
		shl	esi, 10h
		movd	ebx, mm6
		movd	mm0, ecx
		movzx	ecx, byte ptr [ebp+edi-80h]
		movzx	edi, al
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bl
		or	edx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, ah
		shl	esi, 10h
		shr	eax, 10h
		or	edx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shr	ebx, 10h
		shl	esi, 8
		movd	mm1, edx
		movzx	edx, byte ptr [ebp+edi-80h]
		movzx	edi, bh
		shl	edx, 18h
		and	ebx, 0FFh
		or	edx, esi
		punpckldq mm0, mm1
		movzx	esi, byte ptr [ebp+edi-80h]
		movzx	edi, al
		shl	esi, 8
		movzx	eax, ah
		movzx	ebx, byte ptr [ebp+ebx-80h]
		or	ecx, esi
		movzx	esi, byte ptr [ebp+edi-80h]
		or	edx, ebx
		shl	esi, 10h
		movzx	eax, byte ptr [ebp+eax-80h]
		or	edx, esi
		shl	eax, 18h
		or	ecx, eax
		mov	edi, [esp+arg_10]
		movd	mm4, edx
		movd	mm5, ecx
		punpckldq mm4, mm5
		add	edi, 10h
		cmp	edi, [esp+arg_14]
		ja	L$008out
		movq	mm3, mm0
		movq	mm7, mm4
		pshufw	mm2, mm0, 0E4h
		pshufw	mm6, mm4, 0E4h
		movq	mm1, mm0
		movq	mm5, mm4
		pshufw	mm0, mm0, 0B1h
		pshufw	mm4, mm4, 0B1h
		pslld	mm2, 8
		pslld	mm6, 8
		psrld	mm3, 8
		psrld	mm7, 8
		pxor	mm0, mm2
		pxor	mm4, mm6
		pxor	mm0, mm3
		pxor	mm4, mm7
		pslld	mm2, 10h
		pslld	mm6, 10h
		psrld	mm3, 10h
		psrld	mm7, 10h
		pxor	mm0, mm2
		pxor	mm4, mm6
		pxor	mm0, mm3
		pxor	mm4, mm7
		movq	mm3, [esp+arg_4]
		pxor	mm2, mm2
		pxor	mm6, mm6
		pcmpgtb	mm2, mm1
		pcmpgtb	mm6, mm5
		pand	mm2, mm3
		pand	mm6, mm3
		paddb	mm1, mm1
		paddb	mm5, mm5
		pxor	mm1, mm2
		pxor	mm5, mm6
		movq	mm3, mm1
		movq	mm7, mm5
		movq	mm2, mm1
		movq	mm6, mm5
		pxor	mm0, mm1
		pxor	mm4, mm5
		pslld	mm3, 18h
		pslld	mm7, 18h
		psrld	mm2, 8
		psrld	mm6, 8
		pxor	mm0, mm3
		pxor	mm4, mm7
		pxor	mm0, mm2
		pxor	mm4, mm6
		movq	mm2, [esp+arg_4]
		pxor	mm3, mm3
		pxor	mm7, mm7
		pcmpgtb	mm3, mm1
		pcmpgtb	mm7, mm5
		pand	mm3, mm2
		pand	mm7, mm2
		paddb	mm1, mm1
		paddb	mm5, mm5
		pxor	mm1, mm3
		pxor	mm5, mm7
		pshufw	mm3, mm1, 0B1h
		pshufw	mm7, mm5, 0B1h
		pxor	mm0, mm1
		pxor	mm4, mm5
		pxor	mm0, mm3
		pxor	mm4, mm7
		pxor	mm3, mm3
		pxor	mm7, mm7
		pcmpgtb	mm3, mm1
		pcmpgtb	mm7, mm5
		pand	mm3, mm2
		pand	mm7, mm2
		paddb	mm1, mm1
		paddb	mm5, mm5
		pxor	mm1, mm3
		pxor	mm5, mm7
		pxor	mm0, mm1
		pxor	mm4, mm5
		movq	mm3, mm1
		movq	mm7, mm5
		pshufw	mm2, mm1, 0B1h
		pshufw	mm6, mm5, 0B1h
		pxor	mm0, mm2
		pxor	mm4, mm6
		pslld	mm1, 8
		pslld	mm5, 8
		psrld	mm3, 8
		psrld	mm7, 8
		movq	mm2, qword ptr [edi]
		movq	mm6, qword ptr [edi+8]
		pxor	mm0, mm1
		pxor	mm4, mm5
		pxor	mm0, mm3
		pxor	mm4, mm7
		mov	eax, [ebp-80h]
		pslld	mm1, 10h
		pslld	mm5, 10h
		mov	ebx, [ebp-40h]
		psrld	mm3, 10h
		psrld	mm7, 10h
		mov	ecx, [ebp+0]
		pxor	mm0, mm1
		pxor	mm4, mm5
		mov	edx, [ebp+40h]
		pxor	mm0, mm3
		pxor	mm4, mm7
		pxor	mm0, mm2
		pxor	mm4, mm6
		jmp	L$007loop
; ---------------------------------------------------------------------------
		align 10h

L$008out:				; CODE XREF: __sse_AES_decrypt_compact+148j
		pxor	mm0, qword ptr [edi]
		pxor	mm4, qword ptr [edi+8]
		retn
__sse_AES_decrypt_compact endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__x86_AES_decrypt proc near		; CODE XREF: L$_AES_cbc_encrypt_begin+20Fp
					; L$_AES_cbc_encrypt_begin+29Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	[esp+arg_10], edi
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+arg_14], esi

L$009loop:				; CODE XREF: __x86_AES_decrypt+F2j
		mov	esi, eax
		and	esi, 0FFh
		mov	esi, [ebp+esi*8+0]
		movzx	edi, dh
		xor	esi, [ebp+edi*8+3]
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		mov	edi, ebx
		shr	edi, 18h
		xor	esi, [ebp+edi*8+1]
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		mov	esi, [ebp+esi*8+0]
		movzx	edi, ah
		xor	esi, [ebp+edi*8+3]
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		mov	edi, ecx
		shr	edi, 18h
		xor	esi, [ebp+edi*8+1]
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		mov	esi, [ebp+esi*8+0]
		movzx	edi, bh
		xor	esi, [ebp+edi*8+3]
		mov	edi, eax
		shr	edi, 10h
		and	edi, 0FFh
		xor	esi, [ebp+edi*8+2]
		mov	edi, edx
		shr	edi, 18h
		xor	esi, [ebp+edi*8+1]
		mov	edi, [esp+arg_10]
		and	edx, 0FFh
		mov	edx, [ebp+edx*8+0]
		movzx	ecx, ch
		xor	edx, [ebp+ecx*8+3]
		mov	ecx, esi
		shr	ebx, 10h
		and	ebx, 0FFh
		xor	edx, [ebp+ebx*8+2]
		mov	ebx, [esp+arg_4]
		shr	eax, 18h
		xor	edx, [ebp+eax*8+1]
		mov	eax, [esp+arg_0]
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		cmp	edi, [esp+arg_14]
		mov	[esp+arg_10], edi
		jb	L$009loop
		lea	ebp, [ebp+880h]
		mov	edi, [ebp-80h]
		mov	esi, [ebp-60h]
		mov	edi, [ebp-40h]
		mov	esi, [ebp-20h]
		mov	edi, [ebp+0]
		mov	esi, [ebp+20h]
		mov	edi, [ebp+40h]
		mov	esi, [ebp+60h]
		lea	ebp, [ebp-80h]
		mov	esi, eax
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi+0]
		movzx	edi, dh
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 8
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ebx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_0], esi
		mov	esi, ebx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi+0]
		movzx	edi, ah
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 8
		xor	esi, edi
		mov	edi, edx
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, ecx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 18h
		xor	esi, edi
		mov	[esp+arg_4], esi
		mov	esi, ecx
		and	esi, 0FFh
		movzx	esi, byte ptr [ebp+esi+0]
		movzx	edi, bh
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 8
		xor	esi, edi
		mov	edi, eax
		shr	edi, 10h
		and	edi, 0FFh
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 10h
		xor	esi, edi
		mov	edi, edx
		shr	edi, 18h
		movzx	edi, byte ptr [ebp+edi+0]
		shl	edi, 18h
		xor	esi, edi
		mov	edi, [esp+arg_10]
		and	edx, 0FFh
		movzx	edx, byte ptr [ebp+edx+0]
		movzx	ecx, ch
		movzx	ecx, byte ptr [ebp+ecx+0]
		shl	ecx, 8
		xor	edx, ecx
		mov	ecx, esi
		shr	ebx, 10h
		and	ebx, 0FFh
		movzx	ebx, byte ptr [ebp+ebx+0]
		shl	ebx, 10h
		xor	edx, ebx
		mov	ebx, [esp+arg_4]
		shr	eax, 18h
		movzx	eax, byte ptr [ebp+eax+0]
		shl	eax, 18h
		xor	edx, eax
		mov	eax, [esp+arg_0]
		lea	ebp, [ebp-800h]
		add	edi, 10h
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		retn
__x86_AES_decrypt endp

; ---------------------------------------------------------------------------
		align 10h
L$AES_Td	dd 2 dup(50A7F451h), 2 dup(5365417Eh), 2 dup(0C3A4171Ah)
		dd 2 dup(965E273Ah), 2 dup(0CB6BAB3Bh),	2 dup(0F1459D1Fh)
		dd 2 dup(0AB58FAACh), 2	dup(9303E34Bh),	2 dup(55FA3020h)
		dd 2 dup(0F66D76ADh), 2	dup(9176CC88h),	2 dup(254C02F5h)
		dd 2 dup(0FCD7E54Fh), 2	dup(0D7CB2AC5h), 2 dup(80443526h)
		dd 2 dup(8FA362B5h), 2 dup(495AB1DEh), 2 dup(671BBA25h)
		dd 2 dup(980EEA45h), 2 dup(0E1C0FE5Dh),	2 dup(2752FC3h)
		dd 2 dup(12F04C81h), 2 dup(0A397468Dh),	2 dup(0C6F9D36Bh)
		dd 2 dup(0E75F8F03h), 2	dup(959C9215h),	2 dup(0EB7A6DBFh)
		dd 2 dup(0DA595295h), 2	dup(2D83BED4h),	2 dup(0D3217458h)
		dd 2 dup(2969E049h), 2 dup(44C8C98Eh), 2 dup(6A89C275h)
		dd 2 dup(78798EF4h), 2 dup(6B3E5899h), 2 dup(0DD71B927h)
		dd 2 dup(0B64FE1BEh), 2	dup(17AD88F0h),	2 dup(66AC20C9h)
		dd 2 dup(0B43ACE7Dh), 2	dup(184ADF63h),	2 dup(82311AE5h)
		dd 2 dup(60335197h), 2 dup(457F5362h), 2 dup(0E07764B1h)
		dd 2 dup(84AE6BBBh), 2 dup(1CA081FEh), 2 dup(942B08F9h)
		dd 2 dup(58684870h), 2 dup(19FD458Fh), 2 dup(876CDE94h)
		dd 2 dup(0B7F87B52h), 2	dup(23D373ABh),	2 dup(0E2024B72h)
		dd 2 dup(578F1FE3h), 2 dup(2AAB5566h), 2 dup(728EBB2h)
		dd 2 dup(3C2B52Fh), 2 dup(9A7BC586h), 2	dup(0A50837D3h)
		dd 2 dup(0F2872830h), 2	dup(0B2A5BF23h), 2 dup(0BA6A0302h)
		dd 2 dup(5C8216EDh), 2 dup(2B1CCF8Ah), 2 dup(92B479A7h)
		dd 2 dup(0F0F207F3h), 2	dup(0A1E2694Eh), 2 dup(0CDF4DA65h)
		dd 2 dup(0D5BE0506h), 2	dup(1F6234D1h),	2 dup(8AFEA6C4h)
		dd 2 dup(9D532E34h), 2 dup(0A055F3A2h),	2 dup(32E18A05h)
		dd 2 dup(75EBF6A4h), 2 dup(39EC830Bh), 2 dup(0AAEF6040h)
		dd 2 dup(69F715Eh), 2 dup(51106EBDh), 2	dup(0F98A213Eh)
		dd 2 dup(3D06DD96h), 2 dup(0AE053EDDh),	2 dup(46BDE64Dh)
		dd 2 dup(0B58D5491h), 2	dup(55DC471h), 2 dup(6FD40604h)
		dd 2 dup(0FF155060h), 2	dup(24FB9819h),	2 dup(97E9BDD6h)
		dd 2 dup(0CC434089h), 2	dup(779ED967h),	2 dup(0BD42E8B0h)
		dd 2 dup(888B8907h), 2 dup(385B19E7h), 2 dup(0DBEEC879h)
		dd 2 dup(470A7CA1h), 2 dup(0E90F427Ch),	2 dup(0C91E84F8h)
		dd 2 dup(0)
		dd 2 dup(83868009h), 2 dup(48ED2B32h), 2 dup(0AC70111Eh)
		dd 2 dup(4E725A6Ch), 2 dup(0FBFF0EFDh),	2 dup(5638850Fh)
		dd 2 dup(1ED5AE3Dh), 2 dup(27392D36h), 2 dup(64D90F0Ah)
		dd 2 dup(21A65C68h), 2 dup(0D1545B9Bh),	2 dup(3A2E3624h)
		dd 2 dup(0B1670A0Ch), 2	dup(0FE75793h),	2 dup(0D296EEB4h)
		dd 2 dup(9E919B1Bh), 2 dup(4FC5C080h), 2 dup(0A220DC61h)
		dd 2 dup(694B775Ah), 2 dup(161A121Ch), 2 dup(0ABA93E2h)
		dd 2 dup(0E52AA0C0h), 2	dup(43E0223Ch),	2 dup(1D171B12h)
		dd 2 dup(0B0D090Eh), 2 dup(0ADC78BF2h),	2 dup(0B9A8B62Dh)
		dd 2 dup(0C8A91E14h), 2	dup(8519F157h),	2 dup(4C0775AFh)
		dd 2 dup(0BBDD99EEh), 2	dup(0FD607FA3h), 2 dup(9F2601F7h)
		dd 2 dup(0BCF5725Ch), 2	dup(0C53B6644h), 2 dup(347EFB5Bh)
		dd 2 dup(7629438Bh), 2 dup(0DCC623CBh),	2 dup(68FCEDB6h)
		dd 2 dup(63F1E4B8h), 2 dup(0CADC31D7h),	2 dup(10856342h)
		dd 2 dup(40229713h), 2 dup(2011C684h), 2 dup(7D244A85h)
		dd 2 dup(0F83DBBD2h), 2	dup(1132F9AEh),	2 dup(6DA129C7h)
		dd 2 dup(4B2F9E1Dh), 2 dup(0F330B2DCh),	2 dup(0EC52860Dh)
		dd 2 dup(0D0E3C177h), 2	dup(6C16B32Bh),	2 dup(99B970A9h)
		dd 2 dup(0FA489411h), 2	dup(2264E947h),	2 dup(0C48CFCA8h)
		dd 2 dup(1A3FF0A0h), 2 dup(0D82C7D56h),	2 dup(0EF903322h)
		dd 2 dup(0C74E4987h), 2	dup(0C1D138D9h), 2 dup(0FEA2CA8Ch)
		dd 2 dup(360BD498h), 2 dup(0CF81F5A6h),	2 dup(28DE7AA5h)
		dd 2 dup(268EB7DAh), 2 dup(0A4BFAD3Fh),	2 dup(0E49D3A2Ch)
		dd 2 dup(0D927850h), 2 dup(9BCC5F6Ah), 2 dup(62467E54h)
		dd 2 dup(0C2138DF6h), 2	dup(0E8B8D890h), 2 dup(5EF7392Eh)
		dd 2 dup(0F5AFC382h), 2	dup(0BE805D9Fh), 2 dup(7C93D069h)
		dd 2 dup(0A92DD56Fh), 2	dup(0B31225CFh), 2 dup(3B99ACC8h)
		dd 2 dup(0A77D1810h), 2	dup(6E639CE8h),	2 dup(7BBB3BDBh)
		dd 2 dup(97826CDh), 2 dup(0F418596Eh), 2 dup(1B79AECh)
		dd 2 dup(0A89A4F83h), 2	dup(656E95E6h),	2 dup(7EE6FFAAh)
		dd 2 dup(8CFBC21h), 2 dup(0E6E815EFh), 2 dup(0D99BE7BAh)
		dd 2 dup(0CE366F4Ah), 2	dup(0D4099FEAh), 2 dup(0D67CB029h)
		dd 2 dup(0AFB2A431h), 2	dup(31233F2Ah),	2 dup(3094A5C6h)
		dd 2 dup(0C066A235h), 2	dup(37BC4E74h),	2 dup(0A6CA82FCh)
		dd 2 dup(0B0D090E0h), 2	dup(15D8A733h),	2 dup(4A9804F1h)
		dd 2 dup(0F7DAEC41h), 2	dup(0E50CD7Fh),	2 dup(2FF69117h)
		dd 2 dup(8DD64D76h), 2 dup(4DB0EF43h), 2 dup(544DAACCh)
		dd 2 dup(0DF0496E4h), 2	dup(0E3B5D19Eh), 2 dup(1B886A4Ch)
		dd 2 dup(0B81F2CC1h), 2	dup(7F516546h),	2 dup(4EA5E9Dh)
		dd 2 dup(5D358C01h), 2 dup(737487FAh), 2 dup(2E410BFBh)
		dd 2 dup(5A1D67B3h), 2 dup(52D2DB92h), 2 dup(335610E9h)
		dd 2 dup(1347D66Dh), 2 dup(8C61D79Ah), 2 dup(7A0CA137h)
		dd 2 dup(8E14F859h), 2 dup(893C13EBh), 2 dup(0EE27A9CEh)
		dd 2 dup(35C961B7h), 2 dup(0EDE51CE1h),	2 dup(3CB1477Ah)
		dd 2 dup(59DFD29Ch), 2 dup(3F73F255h), 2 dup(79CE1418h)
		dd 2 dup(0BF37C773h), 2	dup(0EACDF753h), 2 dup(5BAAFD5Fh)
		dd 2 dup(146F3DDFh), 2 dup(86DB4478h), 2 dup(81F3AFCAh)
		dd 2 dup(3EC468B9h), 2 dup(2C342438h), 2 dup(5F40A3C2h)
		dd 2 dup(72C31D16h), 2 dup(0C25E2BCh), 2 dup(8B493C28h)
		dd 2 dup(41950DFFh), 2 dup(7101A839h), 2 dup(0DEB30C08h)
		dd 2 dup(9CE4B4D8h), 2 dup(90C15664h), 2 dup(6184CB7Bh)
		dd 2 dup(70B632D5h), 2 dup(745C6C48h), 2 dup(4257B8D0h)
		dd 0D56A0952h, 38A53630h, 9EA340BFh, 0FBD7F381h, 8239E37Ch
		dd 87FF2F9Bh, 44438E34h, 0CBE9DEC4h, 32947B54h,	3D23C2A6h
		dd 0B954CEEh, 4EC3FA42h, 66A12E08h, 0B224D928h,	49A25B76h
		dd 25D18B6Dh, 64F6F872h, 16986886h, 0CC5CA4D4h,	92B6655Dh
		dd 5048706Ch, 0DAB9EDFDh, 5746155Eh, 849D8DA7h,	0ABD890h
		dd 0AD3BC8Ch, 558E4F7h,	645B3B8h, 8F1E2CD0h, 20F3FCAh
		dd 3BDAFC1h, 6B8A1301h,	4111913Ah, 0EADC674Fh, 0CECFF297h
		dd 73E6B4F0h, 2274AC96h, 8535ADE7h, 0E837F9E2h,	6EDF751Ch
		dd 711AF147h, 89C5291Dh, 0E62B76Fh, 1BBE18AAh, 4B3E56FCh
		dd 2079D2C6h, 0FEC0DB9Ah, 0F45ACD78h, 33A8DD1Fh, 31C70788h
		dd 591012B1h, 5FEC8027h, 0A97F5160h, 0D4AB519h,	9F7AE52Dh
		dd 0EF9CC993h, 4D3BE0A0h, 0B0F52AAEh, 3CBBEBC8h, 61995383h
		dd 7E042B17h, 26D677BAh, 631469E1h, 7D0C2155h, 0D56A0952h
		dd 38A53630h, 9EA340BFh, 0FBD7F381h, 8239E37Ch,	87FF2F9Bh
		dd 44438E34h, 0CBE9DEC4h, 32947B54h, 3D23C2A6h,	0B954CEEh
		dd 4EC3FA42h, 66A12E08h, 0B224D928h, 49A25B76h,	25D18B6Dh
		dd 64F6F872h, 16986886h, 0CC5CA4D4h, 92B6655Dh,	5048706Ch
		dd 0DAB9EDFDh, 5746155Eh, 849D8DA7h, 0ABD890h, 0AD3BC8Ch
		dd 558E4F7h, 645B3B8h, 8F1E2CD0h, 20F3FCAh, 3BDAFC1h, 6B8A1301h
		dd 4111913Ah, 0EADC674Fh, 0CECFF297h, 73E6B4F0h, 2274AC96h
		dd 8535ADE7h, 0E837F9E2h, 6EDF751Ch, 711AF147h,	89C5291Dh
		dd 0E62B76Fh, 1BBE18AAh, 4B3E56FCh, 2079D2C6h, 0FEC0DB9Ah
		dd 0F45ACD78h, 33A8DD1Fh, 31C70788h, 591012B1h,	5FEC8027h
		dd 0A97F5160h, 0D4AB519h, 9F7AE52Dh, 0EF9CC993h, 4D3BE0A0h
		dd 0B0F52AAEh, 3CBBEBC8h, 61995383h, 7E042B17h,	26D677BAh
		dd 631469E1h, 7D0C2155h, 0D56A0952h, 38A53630h,	9EA340BFh
		dd 0FBD7F381h, 8239E37Ch, 87FF2F9Bh, 44438E34h,	0CBE9DEC4h
		dd 32947B54h, 3D23C2A6h, 0B954CEEh, 4EC3FA42h, 66A12E08h
		dd 0B224D928h, 49A25B76h, 25D18B6Dh, 64F6F872h,	16986886h
		dd 0CC5CA4D4h, 92B6655Dh, 5048706Ch, 0DAB9EDFDh, 5746155Eh
		dd 849D8DA7h, 0ABD890h,	0AD3BC8Ch, 558E4F7h, 645B3B8h
		dd 8F1E2CD0h, 20F3FCAh,	3BDAFC1h, 6B8A1301h, 4111913Ah
		dd 0EADC674Fh, 0CECFF297h, 73E6B4F0h, 2274AC96h, 8535ADE7h
		dd 0E837F9E2h, 6EDF751Ch, 711AF147h, 89C5291Dh,	0E62B76Fh
		dd 1BBE18AAh, 4B3E56FCh, 2079D2C6h, 0FEC0DB9Ah,	0F45ACD78h
		dd 33A8DD1Fh, 31C70788h, 591012B1h, 5FEC8027h, 0A97F5160h
		dd 0D4AB519h, 9F7AE52Dh, 0EF9CC993h, 4D3BE0A0h,	0B0F52AAEh
		dd 3CBBEBC8h, 61995383h, 7E042B17h, 26D677BAh, 631469E1h
		dd 7D0C2155h, 0D56A0952h, 38A53630h, 9EA340BFh,	0FBD7F381h
		dd 8239E37Ch, 87FF2F9Bh, 44438E34h, 0CBE9DEC4h,	32947B54h
		dd 3D23C2A6h, 0B954CEEh, 4EC3FA42h, 66A12E08h, 0B224D928h
		dd 49A25B76h, 25D18B6Dh, 64F6F872h, 16986886h, 0CC5CA4D4h
		dd 92B6655Dh, 5048706Ch, 0DAB9EDFDh, 5746155Eh,	849D8DA7h
		dd 0ABD890h, 0AD3BC8Ch,	558E4F7h, 645B3B8h, 8F1E2CD0h
		dd 20F3FCAh, 3BDAFC1h, 6B8A1301h, 4111913Ah, 0EADC674Fh
		dd 0CECFF297h, 73E6B4F0h, 2274AC96h, 8535ADE7h,	0E837F9E2h
		dd 6EDF751Ch, 711AF147h, 89C5291Dh, 0E62B76Fh, 1BBE18AAh
		dd 4B3E56FCh, 2079D2C6h, 0FEC0DB9Ah, 0F45ACD78h, 33A8DD1Fh
		dd 31C70788h, 591012B1h, 5FEC8027h, 0A97F5160h,	0D4AB519h
		dd 9F7AE52Dh, 0EF9CC993h, 4D3BE0A0h, 0B0F52AAEh, 3CBBEBC8h
		dd 61995383h, 7E042B17h, 26D677BAh, 631469E1h, 7D0C2155h

; =============== S U B	R O U T	I N E =======================================


		public L$_AES_decrypt_begin
L$_AES_decrypt_begin proc near

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_2C8		= byte ptr  2CCh

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_0]
		mov	edi, [esp+10h+arg_8]
		mov	eax, esp
		sub	esp, 24h
		and	esp, 0FFFFFFC0h
		lea	ebx, [edi-7Fh]
		sub	ebx, esp
		neg	ebx
		and	ebx, 3C0h
		sub	esp, ebx
		add	esp, 4
		mov	[esp+30h+var_14], eax
		call	$+5

L$010pic_point:
		pop	ebp
		lea	eax, large ds:3740h
		lea	ebp, [ebp-0C2Fh]
		lea	ebx, [esp+30h+arg_2C8]
		sub	ebx, ebp
		and	ebx, 300h
		lea	ebp, [ebp+ebx+880h]
		bt	dword ptr [eax], 19h
		jnb	L$011x86
		movq	mm0, qword ptr [esi]
		movq	mm4, qword ptr [esi+8]
		call	__sse_AES_decrypt_compact
		mov	esp, [esp+30h+var_14]
		mov	esi, [esp+10h+arg_4]
		movq	qword ptr [esi], mm0
		movq	qword ptr [esi+8], mm4
		emms
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

L$011x86:				; CODE XREF: L$_AES_decrypt_begin+56j
		mov	[esp+30h+var_18], ebp
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		call	__x86_AES_decrypt_compact
		mov	esp, [esp+30h+var_14]
		mov	esi, [esp+10h+arg_4]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_AES_decrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_AES_cbc_encrypt_begin
L$_AES_cbc_encrypt_begin proc near

var_158		= byte ptr -158h
var_64		= byte ptr -64h
arg_0		= byte ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_28		= byte ptr  2Ch
arg_38		= byte ptr  3Ch
arg_128		= dword	ptr  12Ch

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	ecx, [esp+10h+arg_8]
		cmp	ecx, 0
		jz	L$012drop_out
		call	$+5

L$013pic_point:
		pop	ebp
		lea	eax, large ds:3740h
		cmp	[esp+10h+arg_14], 0
		lea	ebp, [ebp-2346h]
		jnz	L$014picked_te
		lea	ebp, [ebp+1680h]

L$014picked_te:				; CODE XREF: L$_AES_cbc_encrypt_begin+28j
		pushf
		cld
		cmp	ecx, 200h
		jb	L$015slow_way
		test	ecx, 0Fh
		jnz	L$015slow_way
		bt	dword ptr [eax], 1Ch
		jb	L$015slow_way
		lea	esi, [esp+14h+var_158]
		and	esi, 0FFFFFFC0h
		mov	eax, ebp
		lea	ebx, [ebp+900h]
		mov	edx, esi
		and	eax, 0FFFh
		and	ebx, 0FFFh
		and	edx, 0FFFh
		cmp	edx, ebx
		jb	L$016tbl_break_out
		sub	edx, ebx
		sub	esi, edx
		jmp	L$017tbl_ok
; ---------------------------------------------------------------------------
		align 10h

L$016tbl_break_out:			; CODE XREF: L$_AES_cbc_encrypt_begin+7Fj
		sub	edx, eax
		and	edx, 0FFFh
		add	edx, 180h
		sub	esi, edx

L$017tbl_ok:				; CODE XREF: L$_AES_cbc_encrypt_begin+89j
		lea	edx, [esp+14h+arg_0]
		xchg	esp, esi
		add	esp, 4
		mov	[esp+10h+arg_4], ebp
		mov	[esp+10h+arg_8], esi
		mov	eax, [edx]
		mov	ebx, [edx+4]
		mov	edi, [edx+0Ch]
		mov	esi, [edx+10h]
		mov	edx, [edx+14h]
		mov	[esp+10h+arg_C], eax
		mov	[esp+10h+arg_10], ebx
		mov	[esp+10h+arg_14], ecx
		mov	[esp+10h+arg_18], edi
		mov	[esp+10h+arg_1C], esi
		mov	[esp+10h+arg_128], 0
		mov	ebx, edi
		mov	ecx, 3Dh ; '='
		sub	ebx, ebp
		mov	esi, edi
		and	ebx, 0FFFh
		lea	edi, [esp+10h+arg_38]
		cmp	ebx, 900h
		jb	L$018do_copy
		cmp	ebx, 0F0Ch
		jb	L$019skip_copy
		nop

L$018do_copy:				; CODE XREF: L$_AES_cbc_encrypt_begin+F9j
		mov	[esp+10h+arg_18], edi
		mov	esi, esi
		rep movsd

L$019skip_copy:				; CODE XREF: L$_AES_cbc_encrypt_begin+105j
		mov	edi, 10h
		nop
		nop
		nop

L$020prefetch_tbl:			; CODE XREF: L$_AES_cbc_encrypt_begin+131j
		mov	eax, [ebp+0]
		mov	ebx, [ebp+20h]
		mov	ecx, [ebp+40h]
		mov	esi, [ebp+60h]
		lea	ebp, [ebp+80h]
		sub	edi, 1
		jnz	L$020prefetch_tbl
		sub	ebp, 800h
		mov	esi, [esp+10h+arg_C]
		mov	edi, [esp+10h+arg_1C]
		cmp	edx, 0
		jz	L$021fast_decrypt
		mov	eax, [edi]
		mov	ebx, [edi+4]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$022fast_enc_loop:			; CODE XREF: L$_AES_cbc_encrypt_begin+1A6j
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		xor	eax, [esi]
		xor	ebx, [esi+4]
		xor	ecx, [esi+8]
		xor	edx, [esi+0Ch]
		mov	edi, [esp+10h+arg_18]
		call	__x86_AES_encrypt
		mov	esi, [esp+10h+arg_C]
		mov	edi, [esp+10h+arg_10]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		lea	esi, [esi+10h]
		mov	ecx, [esp+10h+arg_14]
		mov	[esp+10h+arg_C], esi
		lea	edx, [edi+10h]
		mov	[esp+10h+arg_10], edx
		sub	ecx, 10h
		mov	[esp+10h+arg_14], ecx
		jnz	L$022fast_enc_loop
		mov	esi, [esp+10h+arg_1C]
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		cmp	[esp+10h+arg_128], 0
		mov	edi, [esp+10h+arg_18]
		jz	L$023skip_ezero
		mov	ecx, 3Ch ; '<'
		xor	eax, eax
		nop
		nop
		mov	esi, esi
		rep stosd

L$023skip_ezero:			; CODE XREF: L$_AES_cbc_encrypt_begin+1CDj
		mov	esp, [esp+10h+arg_8]
		popf

L$012drop_out:				; CODE XREF: L$_AES_cbc_encrypt_begin+Bj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop
		nop
		nop
		nop
		nop

L$021fast_decrypt:			; CODE XREF: L$_AES_cbc_encrypt_begin+148j
		cmp	esi, [esp+10h+arg_10]
		jz	L$027fast_dec_in_place_loop
		mov	[esp+10h+arg_20], edi
		nop
		nop

L$025fast_dec_loop:			; CODE XREF: L$_AES_cbc_encrypt_begin+257j
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	edi, [esp+10h+arg_18]
		call	__x86_AES_decrypt
		mov	edi, [esp+10h+arg_20]
		mov	esi, [esp+10h+arg_14]
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	edi, [esp+10h+arg_10]
		mov	esi, [esp+10h+arg_C]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	ecx, [esp+10h+arg_14]
		mov	[esp+10h+arg_20], esi
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		lea	edi, [edi+10h]
		mov	[esp+10h+arg_10], edi
		sub	ecx, 10h
		mov	[esp+10h+arg_14], ecx
		jnz	L$025fast_dec_loop
		mov	edi, [esp+10h+arg_20]
		mov	esi, [esp+10h+arg_1C]
		mov	eax, [edi]
		mov	ebx, [edi+4]
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		jmp	L$026fast_dec_out
; ---------------------------------------------------------------------------

L$027fast_dec_in_place_loop:		; CODE XREF: L$_AES_cbc_encrypt_begin+1F4j
					; L$_AES_cbc_encrypt_begin+2F8j
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		lea	edi, [esp+10h+arg_28]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	edi, [esp+10h+arg_18]
		call	__x86_AES_decrypt
		mov	edi, [esp+10h+arg_1C]
		mov	esi, [esp+10h+arg_10]
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_10], esi
		lea	esi, [esp+10h+arg_28]
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	esi, [esp+10h+arg_C]
		mov	ecx, [esp+10h+arg_14]
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		sub	ecx, 10h
		mov	[esp+10h+arg_14], ecx
		jnz	L$027fast_dec_in_place_loop
		nop
		nop

L$026fast_dec_out:			; CODE XREF: L$_AES_cbc_encrypt_begin+27Bj
		cmp	[esp+10h+arg_128], 0
		mov	edi, [esp+10h+arg_18]
		jz	L$028skip_dzero
		mov	ecx, 3Ch ; '<'
		xor	eax, eax
		nop
		nop
		nop
		mov	esi, esi
		rep stosd

L$028skip_dzero:			; CODE XREF: L$_AES_cbc_encrypt_begin+30Cj
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop
		nop
		nop
		nop
		nop

L$015slow_way:				; CODE XREF: L$_AES_cbc_encrypt_begin+3Cj
					; L$_AES_cbc_encrypt_begin+48j	...
		mov	eax, [eax]
		mov	edi, [esp+14h+arg_C]
		lea	esi, [esp+14h+var_64]
		and	esi, 0FFFFFFC0h
		lea	ebx, [edi-8Fh]
		sub	ebx, esi
		neg	ebx
		and	ebx, 3C0h
		sub	esi, ebx
		lea	ebx, [esi+300h]
		sub	ebx, ebp
		and	ebx, 300h
		lea	ebp, [ebp+ebx+880h]
		lea	edx, [esp+14h+arg_0]
		xchg	esp, esi
		add	esp, 4
		mov	[esp+10h+arg_4], ebp
		mov	[esp+10h+arg_8], esi
		mov	[esp+10h+arg_20], eax
		mov	eax, [edx]
		mov	ebx, [edx+4]
		mov	esi, [edx+10h]
		mov	edx, [edx+14h]
		mov	[esp+10h+arg_C], eax
		mov	[esp+10h+arg_10], ebx
		mov	[esp+10h+arg_14], ecx
		mov	[esp+10h+arg_18], edi
		mov	[esp+10h+arg_1C], esi
		mov	edi, esi
		mov	esi, eax
		cmp	edx, 0
		jz	L$029slow_decrypt
		cmp	ecx, 10h
		mov	edx, ebx
		jb	L$030slow_enc_tail
		bt	[esp+10h+arg_20], 19h
		jnb	L$031slow_enc_x86
		movq	mm0, qword ptr [edi]
		movq	mm4, qword ptr [edi+8]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$032slow_enc_loop_sse:			; CODE XREF: L$_AES_cbc_encrypt_begin+40Bj
		pxor	mm0, qword ptr [esi]
		pxor	mm4, qword ptr [esi+8]
		mov	edi, [esp+10h+arg_18]
		call	__sse_AES_encrypt_compact
		mov	esi, [esp+10h+arg_C]
		mov	edi, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_14]
		movq	qword ptr [edi], mm0
		movq	qword ptr [edi+8], mm4
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		lea	edx, [edi+10h]
		mov	[esp+10h+arg_10], edx
		sub	ecx, 10h
		cmp	ecx, 10h
		mov	[esp+10h+arg_14], ecx
		jnb	L$032slow_enc_loop_sse
		test	ecx, 0Fh
		jnz	L$030slow_enc_tail
		mov	esi, [esp+10h+arg_1C]
		movq	qword ptr [esi], mm0
		movq	qword ptr [esi+8], mm4
		emms
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$031slow_enc_x86:			; CODE XREF: L$_AES_cbc_encrypt_begin+3B6j
		mov	eax, [edi]
		mov	ebx, [edi+4]
		nop
		nop
		nop

L$033slow_enc_loop_x86:			; CODE XREF: L$_AES_cbc_encrypt_begin+491j
					; L$_AES_cbc_encrypt_begin+50Bj
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		xor	eax, [esi]
		xor	ebx, [esi+4]
		xor	ecx, [esi+8]
		xor	edx, [esi+0Ch]
		mov	edi, [esp+10h+arg_18]
		call	__x86_AES_encrypt_compact
		mov	esi, [esp+10h+arg_C]
		mov	edi, [esp+10h+arg_10]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	ecx, [esp+10h+arg_14]
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		lea	edx, [edi+10h]
		mov	[esp+10h+arg_10], edx
		sub	ecx, 10h
		cmp	ecx, 10h
		mov	[esp+10h+arg_14], ecx
		jnb	L$033slow_enc_loop_x86
		test	ecx, 0Fh
		jnz	L$030slow_enc_tail
		mov	esi, [esp+10h+arg_1C]
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop

L$030slow_enc_tail:			; CODE XREF: L$_AES_cbc_encrypt_begin+3AAj
					; L$_AES_cbc_encrypt_begin+417j ...
		emms
		mov	edi, edx
		mov	ebx, 10h
		sub	ebx, ecx
		cmp	edi, esi
		jz	L$034enc_in_place
		nop
		mov	esi, esi
		rep movsb
		jmp	L$035enc_skip_in_place
; ---------------------------------------------------------------------------

L$034enc_in_place:			; CODE XREF: L$_AES_cbc_encrypt_begin+4DDj
		lea	edi, [edi+ecx]

L$035enc_skip_in_place:			; CODE XREF: L$_AES_cbc_encrypt_begin+4E8j
		mov	ecx, ebx
		xor	eax, eax
		mov	esi, esi
		rep stosb
		mov	edi, [esp+10h+arg_1C]
		mov	esi, edx
		mov	eax, [edi]
		mov	ebx, [edi+4]
		mov	[esp+10h+arg_14], 10h
		jmp	L$033slow_enc_loop_x86
; ---------------------------------------------------------------------------

L$029slow_decrypt:			; CODE XREF: L$_AES_cbc_encrypt_begin+39Fj
		bt	[esp+10h+arg_20], 19h
		jnb	L$036slow_dec_loop_x86

L$037slow_dec_loop_sse:			; CODE XREF: L$_AES_cbc_encrypt_begin+577j
		movq	mm0, qword ptr [esi]
		movq	mm4, qword ptr [esi+8]
		mov	edi, [esp+10h+arg_18]
		call	__sse_AES_decrypt_compact
		mov	esi, [esp+10h+arg_C]
		lea	eax, [esp+10h+arg_28]
		mov	ebx, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_14]
		mov	edi, [esp+10h+arg_1C]
		movq	mm1, qword ptr [esi]
		movq	mm5, qword ptr [esi+8]
		pxor	mm0, qword ptr [edi]
		pxor	mm4, qword ptr [edi+8]
		movq	qword ptr [edi], mm1
		movq	qword ptr [edi+8], mm5
		sub	ecx, 10h
		jb	L$038slow_dec_partial_sse
		movq	qword ptr [ebx], mm0
		movq	qword ptr [ebx+8], mm4
		lea	ebx, [ebx+10h]
		mov	[esp+10h+arg_10], ebx
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		mov	[esp+10h+arg_14], ecx
		jnz	L$037slow_dec_loop_sse
		emms
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop
		nop
		nop
		nop
		nop
		nop

L$038slow_dec_partial_sse:		; CODE XREF: L$_AES_cbc_encrypt_begin+558j
		movq	qword ptr [eax], mm0
		movq	qword ptr [eax+8], mm4
		emms
		add	ecx, 10h
		mov	edi, ebx
		mov	esi, eax
		mov	esi, esi
		rep movsb
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop

L$036slow_dec_loop_x86:			; CODE XREF: L$_AES_cbc_encrypt_begin+516j
					; L$_AES_cbc_encrypt_begin+62Ej
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		lea	edi, [esp+10h+arg_28]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	edi, [esp+10h+arg_18]
		call	__x86_AES_decrypt_compact
		mov	edi, [esp+10h+arg_1C]
		mov	esi, [esp+10h+arg_14]
		xor	eax, [edi]
		xor	ebx, [edi+4]
		xor	ecx, [edi+8]
		xor	edx, [edi+0Ch]
		sub	esi, 10h
		jb	L$039slow_dec_partial_x86
		mov	[esp+10h+arg_14], esi
		mov	esi, [esp+10h+arg_10]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_10], esi
		lea	esi, [esp+10h+arg_28]
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	esi, [esp+10h+arg_C]
		lea	esi, [esi+10h]
		mov	[esp+10h+arg_C], esi
		jnz	L$036slow_dec_loop_x86
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		pushf
		nop

L$039slow_dec_partial_x86:		; CODE XREF: L$_AES_cbc_encrypt_begin+5E9j
		lea	esi, [esp+10h+arg_28]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	esi, [esp+10h+arg_C]
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	ecx, [esp+10h+arg_14]
		mov	edi, [esp+10h+arg_10]
		lea	esi, [esp+10h+arg_28]
		nop
		nop
		nop
		mov	esi, esi
		rep movsb
		mov	esp, [esp+10h+arg_8]
		popf
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_AES_cbc_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__x86_AES_set_encrypt_key proc near	; CODE XREF: L$_private_AES_set_encrypt_key_beginp
					; L$_private_AES_set_decrypt_key_beginp

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_4]
		mov	edi, [esp+10h+arg_C]
		test	esi, 0FFFFFFFFh
		jz	L$040badpointer
		test	edi, 0FFFFFFFFh
		jz	L$040badpointer
		call	$+5

L$041pic_point:
		pop	ebp
		lea	ebp, [ebp-29E9h]
		lea	ebp, [ebp+880h]
		mov	eax, [ebp-80h]
		mov	ebx, [ebp-60h]
		mov	ecx, [ebp-40h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp+0]
		mov	ebx, [ebp+20h]
		mov	ecx, [ebp+40h]
		mov	edx, [ebp+60h]
		mov	ecx, [esp+10h+arg_8]
		cmp	ecx, 80h ; ''
		jz	L$04210rounds
		cmp	ecx, 0C0h ; ''
		jz	L$04312rounds
		cmp	ecx, 100h
		jz	L$04414rounds
		mov	eax, 0FFFFFFFEh
		jmp	L$045exit
; ---------------------------------------------------------------------------

L$04210rounds:				; CODE XREF: __x86_AES_set_encrypt_key+58j
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		xor	ecx, ecx
		jmp	L$04610shortcut
; ---------------------------------------------------------------------------
		align 10h

L$04710loop:				; CODE XREF: __x86_AES_set_encrypt_key+FCj
		mov	eax, [edi]
		mov	edx, [edi+0Ch]

L$04610shortcut:			; CODE XREF: __x86_AES_set_encrypt_key+98j
		movzx	esi, dl
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 18h
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shr	edx, 10h
		movzx	esi, dl
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 8
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shl	ebx, 10h
		xor	eax, ebx
		xor	eax, [ebp+ecx*4+380h]
		mov	[edi+10h], eax
		xor	eax, [edi+4]
		mov	[edi+14h], eax
		xor	eax, [edi+8]
		mov	[edi+18h], eax
		xor	eax, [edi+0Ch]
		mov	[edi+1Ch], eax
		inc	ecx
		add	edi, 10h
		cmp	ecx, 0Ah
		jl	L$04710loop
		mov	dword ptr [edi+50h], 0Ah
		xor	eax, eax
		jmp	L$045exit
; ---------------------------------------------------------------------------

L$04312rounds:				; CODE XREF: __x86_AES_set_encrypt_key+64j
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	ecx, [esi+10h]
		mov	edx, [esi+14h]
		mov	[edi+10h], ecx
		mov	[edi+14h], edx
		xor	ecx, ecx
		jmp	L$04812shortcut
; ---------------------------------------------------------------------------
		align 4

L$04912loop:				; CODE XREF: __x86_AES_set_encrypt_key+1AAj
		mov	eax, [edi]
		mov	edx, [edi+14h]

L$04812shortcut:			; CODE XREF: __x86_AES_set_encrypt_key+134j
		movzx	esi, dl
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 18h
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shr	edx, 10h
		movzx	esi, dl
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 8
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shl	ebx, 10h
		xor	eax, ebx
		xor	eax, [ebp+ecx*4+380h]
		mov	[edi+18h], eax
		xor	eax, [edi+4]
		mov	[edi+1Ch], eax
		xor	eax, [edi+8]
		mov	[edi+20h], eax
		xor	eax, [edi+0Ch]
		mov	[edi+24h], eax
		cmp	ecx, 7
		jz	L$05012break
		inc	ecx
		xor	eax, [edi+10h]
		mov	[edi+28h], eax
		xor	eax, [edi+14h]
		mov	[edi+2Ch], eax
		add	edi, 18h
		jmp	L$04912loop
; ---------------------------------------------------------------------------

L$05012break:				; CODE XREF: __x86_AES_set_encrypt_key+194j
		mov	dword ptr [edi+48h], 0Ch
		xor	eax, eax
		jmp	L$045exit
; ---------------------------------------------------------------------------

L$04414rounds:				; CODE XREF: __x86_AES_set_encrypt_key+70j
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [esi+8]
		mov	edx, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	eax, [esi+10h]
		mov	ebx, [esi+14h]
		mov	ecx, [esi+18h]
		mov	edx, [esi+1Ch]
		mov	[edi+10h], eax
		mov	[edi+14h], ebx
		mov	[edi+18h], ecx
		mov	[edi+1Ch], edx
		xor	ecx, ecx
		jmp	L$05114shortcut
; ---------------------------------------------------------------------------
		align 4

L$05214loop:				; CODE XREF: __x86_AES_set_encrypt_key+2A4j
		mov	edx, [edi+1Ch]

L$05114shortcut:			; CODE XREF: __x86_AES_set_encrypt_key+1EDj
		mov	eax, [edi]
		movzx	esi, dl
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 18h
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shr	edx, 10h
		movzx	esi, dl
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 8
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shl	ebx, 10h
		xor	eax, ebx
		xor	eax, [ebp+ecx*4+380h]
		mov	[edi+20h], eax
		xor	eax, [edi+4]
		mov	[edi+24h], eax
		xor	eax, [edi+8]
		mov	[edi+28h], eax
		xor	eax, [edi+0Ch]
		mov	[edi+2Ch], eax
		cmp	ecx, 6
		jz	L$05314break
		inc	ecx
		mov	edx, eax
		mov	eax, [edi+10h]
		movzx	esi, dl
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shr	edx, 10h
		shl	ebx, 8
		movzx	esi, dl
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		movzx	esi, dh
		shl	ebx, 10h
		xor	eax, ebx
		movzx	ebx, byte ptr [ebp+esi-80h]
		shl	ebx, 18h
		xor	eax, ebx
		mov	[edi+30h], eax
		xor	eax, [edi+14h]
		mov	[edi+34h], eax
		xor	eax, [edi+18h]
		mov	[edi+38h], eax
		xor	eax, [edi+1Ch]
		mov	[edi+3Ch], eax
		add	edi, 20h ; ' '
		jmp	L$05214loop
; ---------------------------------------------------------------------------

L$05314break:				; CODE XREF: __x86_AES_set_encrypt_key+24Cj
		mov	dword ptr [edi+30h], 0Eh
		xor	eax, eax
		jmp	L$045exit
; ---------------------------------------------------------------------------

L$040badpointer:			; CODE XREF: __x86_AES_set_encrypt_key+12j
					; __x86_AES_set_encrypt_key+1Ej
		mov	eax, 0FFFFFFFFh

L$045exit:				; CODE XREF: __x86_AES_set_encrypt_key+7Bj
					; __x86_AES_set_encrypt_key+10Bj ...
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
__x86_AES_set_encrypt_key endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_private_AES_set_encrypt_key_begin
L$_private_AES_set_encrypt_key_begin proc near
		call	__x86_AES_set_encrypt_key
		retn
L$_private_AES_set_encrypt_key_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_private_AES_set_decrypt_key_begin
L$_private_AES_set_decrypt_key_begin proc near

arg_8		= dword	ptr  0Ch

		call	__x86_AES_set_encrypt_key
		cmp	eax, 0
		jz	L$054proceed
		retn
; ---------------------------------------------------------------------------

L$054proceed:				; CODE XREF: L$_private_AES_set_decrypt_key_begin+8j
		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_8]
		mov	ecx, [esi+0F0h]
		lea	ecx, ds:0[ecx*4]
		lea	edi, [esi+ecx*4]
		nop

L$055invert:				; CODE XREF: L$_private_AES_set_decrypt_key_begin+5Cj
		mov	eax, [esi]
		mov	ebx, [esi+4]
		mov	ecx, [edi]
		mov	edx, [edi+4]
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[esi], ecx
		mov	[esi+4], edx
		mov	eax, [esi+8]
		mov	ebx, [esi+0Ch]
		mov	ecx, [edi+8]
		mov	edx, [edi+0Ch]
		mov	[edi+8], eax
		mov	[edi+0Ch], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		add	esi, 10h
		sub	edi, 10h
		cmp	esi, edi
		jnz	L$055invert
		mov	edi, [esp+10h+arg_8]
		mov	esi, [edi+0F0h]
		lea	esi, [esi+esi-2]
		lea	esi, [edi+esi*8]
		mov	[esp+10h+arg_8], esi
		mov	eax, [edi+10h]
		nop
		nop

L$056permute:				; CODE XREF: L$_private_AES_set_decrypt_key_begin+293j
		add	edi, 10h
		mov	ebp, 80808080h
		and	ebp, eax
		lea	ebx, [eax+eax]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	ebx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ebx, esi
		mov	ebp, 80808080h
		and	ebp, ebx
		lea	ecx, [ebx+ebx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ebx, eax
		xor	ecx, esi
		mov	ebp, 80808080h
		and	ebp, ecx
		lea	edx, [ecx+ecx]
		mov	esi, ebp
		shr	ebp, 7
		xor	ecx, eax
		sub	esi, ebp
		and	edx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		rol	eax, 8
		xor	edx, esi
		mov	ebp, [edi+4]
		xor	eax, ebx
		xor	ebx, edx
		xor	eax, ecx
		rol	ebx, 18h
		xor	ecx, edx
		xor	eax, edx
		rol	ecx, 10h
		xor	eax, ebx
		rol	edx, 8
		xor	eax, ecx
		mov	ebx, ebp
		xor	eax, edx
		mov	[edi], eax
		mov	ebp, 80808080h
		and	ebp, ebx
		lea	ecx, [ebx+ebx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, esi
		mov	ebp, 80808080h
		and	ebp, ecx
		lea	edx, [ecx+ecx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	edx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	ecx, ebx
		xor	edx, esi
		mov	ebp, 80808080h
		and	ebp, edx
		lea	eax, [edx+edx]
		mov	esi, ebp
		shr	ebp, 7
		xor	edx, ebx
		sub	esi, ebp
		and	eax, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		rol	ebx, 8
		xor	eax, esi
		mov	ebp, [edi+8]
		xor	ebx, ecx
		xor	ecx, eax
		xor	ebx, edx
		rol	ecx, 18h
		xor	edx, eax
		xor	ebx, eax
		rol	edx, 10h
		xor	ebx, ecx
		rol	eax, 8
		xor	ebx, edx
		mov	ecx, ebp
		xor	ebx, eax
		mov	[edi+4], ebx
		mov	ebp, 80808080h
		and	ebp, ecx
		lea	edx, [ecx+ecx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	edx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	edx, esi
		mov	ebp, 80808080h
		and	ebp, edx
		lea	eax, [edx+edx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	eax, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	edx, ecx
		xor	eax, esi
		mov	ebp, 80808080h
		and	ebp, eax
		lea	ebx, [eax+eax]
		mov	esi, ebp
		shr	ebp, 7
		xor	eax, ecx
		sub	esi, ebp
		and	ebx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		rol	ecx, 8
		xor	ebx, esi
		mov	ebp, [edi+0Ch]
		xor	ecx, edx
		xor	edx, ebx
		xor	ecx, eax
		rol	edx, 18h
		xor	eax, ebx
		xor	ecx, ebx
		rol	eax, 10h
		xor	ecx, edx
		rol	ebx, 8
		xor	ecx, eax
		mov	edx, ebp
		xor	ecx, ebx
		mov	[edi+8], ecx
		mov	ebp, 80808080h
		and	ebp, edx
		lea	eax, [edx+edx]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	eax, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	eax, esi
		mov	ebp, 80808080h
		and	ebp, eax
		lea	ebx, [eax+eax]
		mov	esi, ebp
		shr	ebp, 7
		sub	esi, ebp
		and	ebx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		xor	eax, edx
		xor	ebx, esi
		mov	ebp, 80808080h
		and	ebp, ebx
		lea	ecx, [ebx+ebx]
		mov	esi, ebp
		shr	ebp, 7
		xor	ebx, edx
		sub	esi, ebp
		and	ecx, 0FEFEFEFEh
		and	esi, 1B1B1B1Bh
		rol	edx, 8
		xor	ecx, esi
		mov	ebp, [edi+10h]
		xor	edx, eax
		xor	eax, ecx
		xor	edx, ebx
		rol	eax, 18h
		xor	ebx, ecx
		xor	edx, ecx
		rol	ebx, 10h
		xor	edx, eax
		rol	ecx, 8
		xor	edx, ebx
		mov	eax, ebp
		xor	edx, ecx
		mov	[edi+0Ch], edx
		cmp	edi, [esp+10h+arg_8]
		jb	L$056permute
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_private_AES_set_decrypt_key_begin endp

; ---------------------------------------------------------------------------
aAesForX86Crypt	db 'AES for x86, CRYPTOGAMS by <appro@openssl.org>',0
		align 10h
_text		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
_bss		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _OPENSSL_ia32cap_P:near


		end
