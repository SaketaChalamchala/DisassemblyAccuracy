;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	DF4B59C2521D1956759F6B27C407DA4A
; Input	CRC32 :	74F909B0

; File Name   :	C:\compspace\Diff\openssl\obj\x509_cmp.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_check_suiteb
_X509_CRL_check_suiteb proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		test	[esp+arg_8], 30000h
		jnz	short loc_D
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_D:					; CODE XREF: _X509_CRL_check_suiteb+8j
		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+4]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		lea	ecx, [esp+4+arg_8]
		push	ecx
		push	eax
		push	[esp+0Ch+arg_4]
		call	_check_suite_b
		add	esp, 10h
		retn
_X509_CRL_check_suiteb endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_cmp
_X509_CRL_cmp	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+8]
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+8]
		call	_X509_NAME_cmp
		add	esp, 8
		retn
_X509_CRL_cmp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_match
_X509_CRL_match	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		add	edx, 2Ch ; ','
		push	esi
		add	ecx, 2Ch ; ','
		mov	esi, 10h

loc_60:					; CODE XREF: _X509_CRL_match+23j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_75
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_60
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_75:					; CODE XREF: _X509_CRL_match+18j
		cmp	al, [edx]
		jnz	short loc_95
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	short loc_95
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	short loc_95
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jnz	short loc_95
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_95:					; CODE XREF: _X509_CRL_match+2Bj
					; _X509_CRL_match+33j ...
		sbb	eax, eax
		or	eax, 1
		pop	esi
		retn
_X509_CRL_match	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_NAME_cmp
_X509_NAME_cmp	proc near		; CODE XREF: _X509_CRL_cmp+12p
					; _X509_find_by_issuer_and_serial+46p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_AD
		cmp	dword ptr [edi+4], 0
		jz	short loc_C3

loc_AD:					; CODE XREF: _X509_NAME_cmp+9j
		push	0
		push	edi
		call	_i2d_X509_NAME
		add	esp, 8
		test	eax, eax
		jns	short loc_C3
		mov	eax, 0FFFFFFFEh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_C3:					; CODE XREF: _X509_NAME_cmp+Fj
					; _X509_NAME_cmp+1Ej
		push	ebx
		mov	ebx, [esp+8+arg_4]
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_D4
		cmp	dword ptr [ebx+4], 0
		jz	short loc_EB

loc_D4:					; CODE XREF: _X509_NAME_cmp+30j
		push	0
		push	ebx
		call	_i2d_X509_NAME
		add	esp, 8
		test	eax, eax
		jns	short loc_EB
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_EB:					; CODE XREF: _X509_NAME_cmp+36j
					; _X509_NAME_cmp+45j
		push	esi
		mov	esi, [edi+10h]
		mov	eax, esi
		sub	eax, [ebx+10h]
		jnz	short loc_14F
		mov	ecx, [edi+0Ch]
		mov	edx, [ebx+0Ch]
		sub	esi, 4
		jb	short loc_112

loc_101:				; CODE XREF: _X509_NAME_cmp+74j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_117
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_101

loc_112:				; CODE XREF: _X509_NAME_cmp+63j
		cmp	esi, 0FFFFFFFCh
		jz	short loc_14D

loc_117:				; CODE XREF: _X509_NAME_cmp+69j
		mov	al, [ecx]
		cmp	al, [edx]
		jnz	short loc_144
		cmp	esi, 0FFFFFFFDh
		jz	short loc_14D
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	short loc_144
		cmp	esi, 0FFFFFFFEh
		jz	short loc_14D
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	short loc_144
		cmp	esi, 0FFFFFFFFh
		jz	short loc_14D
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jz	short loc_14D

loc_144:				; CODE XREF: _X509_NAME_cmp+7Fj
					; _X509_NAME_cmp+8Cj ...
		pop	esi
		sbb	eax, eax
		pop	ebx
		or	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_14D:				; CODE XREF: _X509_NAME_cmp+79j
					; _X509_NAME_cmp+84j ...
		xor	eax, eax

loc_14F:				; CODE XREF: _X509_NAME_cmp+58j
		pop	esi
		pop	ebx
		pop	edi
		retn
_X509_NAME_cmp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 154h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_NAME_hash
_X509_NAME_hash	proc near		; CODE XREF: _X509_issuer_name_hash+9p
					; _X509_subject_name_hash+9p

var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 18h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		push	0
		push	esi
		call	_i2d_X509_NAME
		add	esp, 8
		push	0
		call	_EVP_sha1
		push	eax
		push	0
		lea	eax, [esp+28h+var_18]
		push	eax
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_EVP_Digest
		add	esp, 18h
		pop	esi
		test	eax, eax
		jnz	short loc_1AA
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1AA:				; CODE XREF: _X509_NAME_hash+45j
		movzx	eax, [esp+18h+var_15]
		movzx	ecx, [esp+18h+var_16]
		shl	eax, 8
		or	eax, ecx
		movzx	ecx, [esp+18h+var_17]
		shl	eax, 8
		or	eax, ecx
		movzx	ecx, [esp+18h+var_18]
		shl	eax, 8
		or	eax, ecx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
_X509_NAME_hash	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_NAME_hash_old
_X509_NAME_hash_old proc near		; CODE XREF: _X509_issuer_name_hash_old+9p
					; _X509_subject_name_hash_old+9p

var_2C		= byte ptr -2Ch
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 2Ch ; ','
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	esi
		push	edi
		mov	edi, [esp+34h+arg_0]
		xor	esi, esi
		push	esi
		push	edi
		call	_i2d_X509_NAME
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+40h+var_2C]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		add	esp, 14h
		push	esi
		call	_EVP_md5
		push	eax
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_284
		mov	eax, [edi+8]
		push	dword ptr [eax]
		push	dword ptr [eax+4]
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_284
		push	esi
		lea	eax, [esp+38h+var_14]
		push	eax
		lea	eax, [esp+3Ch+var_2C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_284
		movzx	esi, [esp+34h+var_11]
		movzx	eax, [esp+34h+var_12]
		movzx	ecx, [esp+34h+var_14]
		shl	esi, 8
		or	esi, eax
		movzx	eax, [esp+34h+var_13]
		shl	esi, 8
		or	esi, eax
		shl	esi, 8
		or	esi, ecx

loc_284:				; CODE XREF: _X509_NAME_hash_old+53j
					; _X509_NAME_hash_old+6Cj ...
		lea	eax, [esp+34h+var_2C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+38h+var_4]
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
_X509_NAME_hash_old endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_chain_check_suiteb
_X509_chain_check_suiteb proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 8
		call	__chkstk
		mov	eax, [esp+8+arg_C]
		test	eax, 30000h
		jnz	short loc_2BF
		xor	eax, eax
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2BF:				; CODE XREF: _X509_chain_check_suiteb+13j
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		mov	[esp+0Ch+var_8], eax
		push	esi
		mov	esi, [esp+10h+arg_8]
		push	edi
		test	ebp, ebp
		jnz	short loc_2E6
		push	0
		push	esi
		call	_sk_value
		add	esp, 8
		mov	ebp, eax
		mov	edi, 1
		jmp	short loc_2E8
; ---------------------------------------------------------------------------

loc_2E6:				; CODE XREF: _X509_chain_check_suiteb+2Cj
		xor	edi, edi

loc_2E8:				; CODE XREF: _X509_chain_check_suiteb+40j
		mov	eax, [ebp+0]
		push	dword ptr [eax]
		call	_ASN1_INTEGER_get
		add	esp, 4
		cmp	eax, 2
		jz	short loc_306
		mov	esi, 38h ; '8'
		xor	edi, edi
		jmp	loc_47E
; ---------------------------------------------------------------------------

loc_306:				; CODE XREF: _X509_chain_check_suiteb+54j
		mov	eax, [ebp+0]
		push	ebx
		test	eax, eax
		jz	loc_43F
		push	dword ptr [eax+18h]
		call	_X509_PUBKEY_get
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_441
		cmp	dword ptr [ebx], 198h
		jnz	loc_441
		push	dword ptr [ebx+14h]
		call	_EC_KEY_get0_group
		add	esp, 4
		test	eax, eax
		jz	loc_441
		push	eax
		call	_EC_GROUP_get_curve_name
		add	esp, 4
		cmp	eax, 2CBh
		jnz	short loc_3CD
		mov	eax, [esp+18h+arg_C]
		test	eax, 20000h
		jnz	short loc_36B
		mov	esi, 3Ch ; '<'
		jmp	loc_446
; ---------------------------------------------------------------------------

loc_36B:				; CODE XREF: _X509_chain_check_suiteb+BBj
		and	eax, 0FFFEFFFFh
		mov	[esp+18h+var_8], eax

loc_374:				; CODE XREF: _X509_chain_check_suiteb+138j
		push	esi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jge	loc_415

loc_385:				; CODE XREF: _X509_chain_check_suiteb+16Bj
		push	ebp
		call	_X509_get_signature_nid
		push	edi
		push	esi
		mov	[esp+24h+var_4], eax
		call	_sk_value
		mov	ebp, eax
		mov	ecx, [ebp+0]
		push	dword ptr [ecx]
		call	_ASN1_INTEGER_get
		add	esp, 10h
		cmp	eax, 2
		jnz	loc_431
		push	ebx
		call	_EVP_PKEY_free
		mov	eax, [ebp+0]
		add	esp, 4
		test	eax, eax
		jz	short loc_3E5
		push	dword ptr [eax+18h]
		call	_X509_PUBKEY_get
		add	esp, 4
		mov	ebx, eax
		jmp	short loc_3E7
; ---------------------------------------------------------------------------

loc_3CD:				; CODE XREF: _X509_chain_check_suiteb+B0j
		cmp	eax, 19Fh
		jnz	short loc_438
		test	[esp+18h+arg_C], 10000h
		jnz	short loc_374
		mov	esi, 3Ch ; '<'
		jmp	short loc_446
; ---------------------------------------------------------------------------

loc_3E5:				; CODE XREF: _X509_chain_check_suiteb+118j
		xor	ebx, ebx

loc_3E7:				; CODE XREF: _X509_chain_check_suiteb+127j
		lea	eax, [esp+18h+var_8]
		push	eax
		push	[esp+1Ch+var_4]
		push	ebx
		call	_check_suite_b
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short $end$51
		mov	esi, [esp+18h+arg_8]
		inc	edi
		push	esi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	loc_385

loc_415:				; CODE XREF: _X509_chain_check_suiteb+DBj
		lea	eax, [esp+18h+var_8]
		push	eax
		push	ebp
		call	_X509_get_signature_nid
		add	esp, 4
		push	eax
		push	ebx
		call	_check_suite_b
		add	esp, 0Ch
		mov	esi, eax
		jmp	short $end$51
; ---------------------------------------------------------------------------

loc_431:				; CODE XREF: _X509_chain_check_suiteb+104j
		mov	esi, 38h ; '8'
		jmp	short $end$51
; ---------------------------------------------------------------------------

loc_438:				; CODE XREF: _X509_chain_check_suiteb+12Ej
		mov	esi, 3Ah ; ':'
		jmp	short loc_446
; ---------------------------------------------------------------------------

loc_43F:				; CODE XREF: _X509_chain_check_suiteb+68j
		xor	ebx, ebx

loc_441:				; CODE XREF: _X509_chain_check_suiteb+7Dj
					; _X509_chain_check_suiteb+89j	...
		mov	esi, 39h ; '9'

loc_446:				; CODE XREF: _X509_chain_check_suiteb+C2j
					; _X509_chain_check_suiteb+13Fj ...
		xor	edi, edi

$end$51:				; CODE XREF: _X509_chain_check_suiteb+159j
					; _X509_chain_check_suiteb+18Bj ...
		test	ebx, ebx
		jz	short loc_455
		push	ebx
		call	_EVP_PKEY_free
		add	esp, 4

loc_455:				; CODE XREF: _X509_chain_check_suiteb+1A6j
		pop	ebx
		test	esi, esi
		jz	short loc_488
		cmp	esi, 3Bh ; ';'
		jz	short loc_464
		cmp	esi, 3Ch ; '<'
		jnz	short loc_47E

loc_464:				; CODE XREF: _X509_chain_check_suiteb+1B9j
		test	edi, edi
		jz	short loc_469
		dec	edi

loc_469:				; CODE XREF: _X509_chain_check_suiteb+1C2j
		cmp	esi, 3Ch ; '<'
		jnz	short loc_47E
		mov	eax, [esp+14h+arg_C]
		mov	ecx, 3Dh ; '='
		cmp	eax, [esp+14h+var_8]
		cmovnz	esi, ecx

loc_47E:				; CODE XREF: _X509_chain_check_suiteb+5Dj
					; _X509_chain_check_suiteb+1BEj ...
		mov	eax, [esp+14h+arg_0]
		test	eax, eax
		jz	short loc_488
		mov	[eax], edi

loc_488:				; CODE XREF: _X509_chain_check_suiteb+1B4j
					; _X509_chain_check_suiteb+1E0j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		add	esp, 8
		retn
_X509_chain_check_suiteb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 494h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_chain_up_ref
_X509_chain_up_ref proc	near

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	[esp+8+arg_0]
		call	_sk_dup
		mov	edi, eax
		xor	esi, esi
		push	edi
		call	_sk_num
		add	esp, 8
		test	eax, eax
		jle	short loc_4E0
		nop	dword ptr [eax+00h]

loc_4B4:				; CODE XREF: _X509_chain_up_ref+4Aj
		push	esi
		push	edi
		call	_sk_value
		push	1EFh
		push	offset ??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@ ; ".\\crypto\\x509\\x509_cmp.c"
		push	3
		add	eax, 10h
		push	1
		push	eax
		call	_CRYPTO_add_lock
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 20h
		cmp	esi, eax
		jl	short loc_4B4

loc_4E0:				; CODE XREF: _X509_chain_up_ref+1Aj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_X509_chain_up_ref endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_check_private_key
_X509_check_private_key	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		test	eax, eax
		jz	short loc_542
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_542
		push	dword ptr [eax+18h]
		call	_X509_PUBKEY_get
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_544
		push	[esp+8+arg_4]
		push	edi
		call	_EVP_PKEY_cmp
		mov	esi, eax
		add	esp, 8
		cmp	esi, 0FFFFFFFEh
		jz	short loc_549
		cmp	esi, 0FFFFFFFFh
		jz	short loc_534
		test	esi, esi
		jnz	short loc_564
		push	154h
		push	offset ??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@ ; ".\\crypto\\x509\\x509_cmp.c"
		push	74h ; 't'
		jmp	short loc_555
; ---------------------------------------------------------------------------

loc_534:				; CODE XREF: _X509_check_private_key+38j
		push	157h
		push	offset ??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@ ; ".\\crypto\\x509\\x509_cmp.c"
		push	73h ; 's'
		jmp	short loc_555
; ---------------------------------------------------------------------------

loc_542:				; CODE XREF: _X509_check_private_key+8j
					; _X509_check_private_key+Ej
		xor	edi, edi

loc_544:				; CODE XREF: _X509_check_private_key+1Fj
		mov	esi, 0FFFFFFFEh

loc_549:				; CODE XREF: _X509_check_private_key+33j
		push	15Ah
		push	offset ??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@ ; ".\\crypto\\x509\\x509_cmp.c"
		push	75h ; 'u'

loc_555:				; CODE XREF: _X509_check_private_key+4Aj
					; _X509_check_private_key+58j
		push	80h ; '€'
		push	0Bh
		call	_ERR_put_error
		add	esp, 14h

loc_564:				; CODE XREF: _X509_check_private_key+3Cj
		test	edi, edi
		jz	short loc_571
		push	edi
		call	_EVP_PKEY_free
		add	esp, 4

loc_571:				; CODE XREF: _X509_check_private_key+7Ej
		xor	eax, eax
		test	esi, esi
		pop	edi
		setnle	al
		pop	esi
		retn
_X509_check_private_key	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 57Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_cmp
_X509_cmp	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	0
		push	0FFFFFFFFh
		push	edi
		call	_X509_check_purpose
		mov	ebx, [esp+18h+arg_4]
		push	0
		push	0FFFFFFFFh
		push	ebx
		call	_X509_check_purpose
		add	esp, 18h
		lea	edx, [ebx+50h]
		lea	ecx, [edi+50h]
		mov	esi, 10h
		nop	dword ptr [eax]

loc_5AC:				; CODE XREF: _X509_cmp+3Fj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_5C1
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_5AC
		xor	eax, eax
		jmp	short loc_5E6
; ---------------------------------------------------------------------------

loc_5C1:				; CODE XREF: _X509_cmp+34j
		cmp	al, [edx]
		jnz	short loc_5E1
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	short loc_5E1
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	short loc_5E1
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jnz	short loc_5E1
		xor	eax, eax
		jmp	short loc_5E6
; ---------------------------------------------------------------------------

loc_5E1:				; CODE XREF: _X509_cmp+47j
					; _X509_cmp+4Fj ...
		sbb	eax, eax
		or	eax, 1

loc_5E6:				; CODE XREF: _X509_cmp+43j
					; _X509_cmp+63j
		test	eax, eax
		jnz	short loc_65B
		mov	edx, [edi]
		cmp	[edx+30h], eax
		jnz	short loc_659
		mov	esi, [ebx]
		cmp	[esi+30h], eax
		jnz	short loc_659
		mov	ecx, [edx+2Ch]
		mov	eax, ecx
		sub	eax, [esi+2Ch]
		jnz	short loc_65B
		mov	edx, [edx+28h]
		mov	esi, [esi+28h]
		sub	ecx, 4
		jb	short loc_61E

loc_60D:				; CODE XREF: _X509_cmp+A0j
		mov	eax, [edx]
		cmp	eax, [esi]
		jnz	short loc_623
		add	edx, 4
		add	esi, 4
		sub	ecx, 4
		jnb	short loc_60D

loc_61E:				; CODE XREF: _X509_cmp+8Fj
		cmp	ecx, 0FFFFFFFCh
		jz	short loc_659

loc_623:				; CODE XREF: _X509_cmp+95j
		mov	al, [edx]
		cmp	al, [esi]
		jnz	short loc_650
		cmp	ecx, 0FFFFFFFDh
		jz	short loc_659
		mov	al, [edx+1]
		cmp	al, [esi+1]
		jnz	short loc_650
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_659
		mov	al, [edx+2]
		cmp	al, [esi+2]
		jnz	short loc_650
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_659
		mov	al, [edx+3]
		cmp	al, [esi+3]
		jz	short loc_659

loc_650:				; CODE XREF: _X509_cmp+ABj
					; _X509_cmp+B8j ...
		pop	edi
		sbb	eax, eax
		pop	esi
		or	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_659:				; CODE XREF: _X509_cmp+73j
					; _X509_cmp+7Aj ...
		xor	eax, eax

loc_65B:				; CODE XREF: _X509_cmp+6Cj
					; _X509_cmp+84j
		pop	edi
		pop	esi
		pop	ebx
		retn
_X509_cmp	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 660h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_find_by_issuer_and_serial
_X509_find_by_issuer_and_serial	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_0]
		test	edi, edi
		jnz	short loc_66D
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_66D:				; CODE XREF: _X509_find_by_issuer_and_serial+7j
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_6C0
		nop

loc_680:				; CODE XREF: _X509_find_by_issuer_and_serial+5Ej
		push	esi
		push	edi
		call	_sk_value
		push	[esp+18h+arg_8]
		mov	ebp, eax
		mov	ebx, [ebp+0]
		push	dword ptr [ebx+4]
		call	_ASN1_STRING_cmp
		add	esp, 10h
		test	eax, eax
		jnz	short loc_6B2
		push	[esp+10h+arg_4]
		push	dword ptr [ebx+0Ch]
		call	_X509_NAME_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_6C7

loc_6B2:				; CODE XREF: _X509_find_by_issuer_and_serial+3Dj
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_680

loc_6C0:				; CODE XREF: _X509_find_by_issuer_and_serial+1Dj
		pop	esi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_6C7:				; CODE XREF: _X509_find_by_issuer_and_serial+50j
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	edi
		retn
_X509_find_by_issuer_and_serial	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6D0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_find_by_subject
_X509_find_by_subject proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		push	edi
		push	esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_7C8
		mov	ebp, [esp+14h+arg_4]
		nop	dword ptr [eax+00000000h]

loc_700:				; CODE XREF: _X509_find_by_subject+F2j
		push	ebx
		push	esi
		call	_sk_value
		add	esp, 8
		mov	[esp+14h+var_4], eax
		mov	ecx, [eax]
		mov	edi, [ecx+14h]
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_71F
		cmp	dword ptr [edi+4], 0
		jz	short loc_732

loc_71F:				; CODE XREF: _X509_find_by_subject+47j
		push	0
		push	edi
		call	_i2d_X509_NAME
		add	esp, 8
		test	eax, eax
		js	loc_7B6

loc_732:				; CODE XREF: _X509_find_by_subject+4Dj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_73E
		cmp	dword ptr [ebp+4], 0
		jz	short loc_74D

loc_73E:				; CODE XREF: _X509_find_by_subject+66j
		push	0
		push	ebp
		call	_i2d_X509_NAME
		add	esp, 8
		test	eax, eax
		js	short loc_7B6

loc_74D:				; CODE XREF: _X509_find_by_subject+6Cj
		mov	esi, [edi+10h]
		mov	eax, esi
		sub	eax, [ebp+10h]
		jnz	short loc_7AE
		mov	edx, [edi+0Ch]
		mov	eax, [ebp+0Ch]
		sub	esi, 4
		jb	short loc_773

loc_762:				; CODE XREF: _X509_find_by_subject+A1j
		mov	ecx, [edx]
		cmp	ecx, [eax]
		jnz	short loc_778
		add	edx, 4
		add	eax, 4
		sub	esi, 4
		jnb	short loc_762

loc_773:				; CODE XREF: _X509_find_by_subject+90j
		cmp	esi, 0FFFFFFFCh
		jz	short loc_7AC

loc_778:				; CODE XREF: _X509_find_by_subject+96j
		mov	cl, [edx]
		cmp	cl, [eax]
		jnz	short loc_7A5
		cmp	esi, 0FFFFFFFDh
		jz	short loc_7AC
		mov	cl, [edx+1]
		cmp	cl, [eax+1]
		jnz	short loc_7A5
		cmp	esi, 0FFFFFFFEh
		jz	short loc_7AC
		mov	cl, [edx+2]
		cmp	cl, [eax+2]
		jnz	short loc_7A5
		cmp	esi, 0FFFFFFFFh
		jz	short loc_7AC
		mov	cl, [edx+3]
		cmp	cl, [eax+3]
		jz	short loc_7AC

loc_7A5:				; CODE XREF: _X509_find_by_subject+ACj
					; _X509_find_by_subject+B9j ...
		sbb	eax, eax
		or	eax, 1
		jmp	short loc_7AE
; ---------------------------------------------------------------------------

loc_7AC:				; CODE XREF: _X509_find_by_subject+A6j
					; _X509_find_by_subject+B1j ...
		xor	eax, eax

loc_7AE:				; CODE XREF: _X509_find_by_subject+85j
					; _X509_find_by_subject+DAj
		test	eax, eax
		jz	short loc_7D0
		mov	esi, [esp+14h+arg_0]

loc_7B6:				; CODE XREF: _X509_find_by_subject+5Cj
					; _X509_find_by_subject+7Bj
		push	esi
		inc	ebx
		call	_sk_num
		add	esp, 4
		cmp	ebx, eax
		jl	loc_700

loc_7C8:				; CODE XREF: _X509_find_by_subject+1Fj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_7D0:				; CODE XREF: _X509_find_by_subject+E0j
		mov	eax, [esp+14h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_X509_find_by_subject endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_get0_pubkey_bitstr
_X509_get0_pubkey_bitstr proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_7E5
		retn
; ---------------------------------------------------------------------------

loc_7E5:				; CODE XREF: _X509_get0_pubkey_bitstr+6j
		mov	eax, [eax]
		mov	eax, [eax+18h]
		mov	eax, [eax+4]
		retn
_X509_get0_pubkey_bitstr endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_get_issuer_name
_X509_get_issuer_name proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+0Ch]
		retn
_X509_get_issuer_name endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7FCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_get_pubkey
_X509_get_pubkey proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_816
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_816
		push	dword ptr [eax+18h]
		call	_X509_PUBKEY_get
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_816:				; CODE XREF: _X509_get_pubkey+6j
					; _X509_get_pubkey+Cj
		xor	eax, eax
		retn
_X509_get_pubkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 81Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_get_serialNumber
_X509_get_serialNumber proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+4]
		retn
_X509_get_serialNumber endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 828h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_get_subject_name
_X509_get_subject_name proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+14h]
		retn
_X509_get_subject_name endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 834h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_issuer_and_serial_cmp
_X509_issuer_and_serial_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	esi, [eax]
		mov	eax, [esp+8+arg_4]
		mov	edi, [eax]
		push	dword ptr [edi+4]
		push	dword ptr [esi+4]
		call	_ASN1_STRING_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_862
		push	dword ptr [edi+0Ch]
		push	dword ptr [esi+0Ch]
		call	_X509_NAME_cmp
		add	esp, 8

loc_862:				; CODE XREF: _X509_issuer_and_serial_cmp+1Ej
		pop	edi
		pop	esi
		retn
_X509_issuer_and_serial_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 868h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_issuer_and_serial_hash
_X509_issuer_and_serial_hash proc near

var_2C		= byte ptr -2Ch
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 2Ch ; ','
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+30h+arg_0]
		lea	eax, [esp+30h+var_2C]
		push	esi
		push	edi
		push	eax
		xor	esi, esi
		call	_EVP_MD_CTX_init
		mov	eax, [ebx]
		push	esi
		push	esi
		push	dword ptr [eax+0Ch]
		call	_X509_NAME_oneline
		add	esp, 10h
		mov	edi, eax
		push	esi
		call	_EVP_md5
		push	eax
		lea	eax, [esp+40h+var_2C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$9
		mov	ecx, edi
		lea	edx, [ecx+1]

loc_8BE:				; CODE XREF: _X509_issuer_and_serial_hash+5Bj
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_8BE
		sub	ecx, edx
		lea	eax, [esp+38h+var_2C]
		push	ecx
		push	edi
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$9
		push	edi
		call	_CRYPTO_free
		mov	eax, [ebx]
		mov	eax, [eax+4]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+44h+var_2C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 10h
		test	eax, eax
		jz	short $err$9
		push	0
		lea	eax, [esp+3Ch+var_14]
		push	eax
		lea	eax, [esp+40h+var_2C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$9
		movzx	esi, [esp+38h+var_11]
		movzx	eax, [esp+38h+var_12]
		movzx	ecx, [esp+38h+var_14]
		shl	esi, 8
		or	esi, eax
		movzx	eax, [esp+38h+var_13]
		shl	esi, 8
		or	esi, eax
		shl	esi, 8
		or	esi, ecx

$err$9:					; CODE XREF: _X509_issuer_and_serial_hash+4Fj
					; _X509_issuer_and_serial_hash+70j ...
		lea	eax, [esp+38h+var_2C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+3Ch+var_4]
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
_X509_issuer_and_serial_hash endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 958h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_issuer_name_cmp
_X509_issuer_name_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+0Ch]
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+0Ch]
		call	_X509_NAME_cmp
		add	esp, 8
		retn
_X509_issuer_name_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 974h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_issuer_name_hash
_X509_issuer_name_hash proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+0Ch]
		call	_X509_NAME_hash
		add	esp, 4
		retn
_X509_issuer_name_hash endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 988h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_issuer_name_hash_old
_X509_issuer_name_hash_old proc	near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+0Ch]
		call	_X509_NAME_hash_old
		add	esp, 4
		retn
_X509_issuer_name_hash_old endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 99Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_subject_name_cmp
_X509_subject_name_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+14h]
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+14h]
		call	_X509_NAME_cmp
		add	esp, 8
		retn
_X509_subject_name_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_subject_name_hash
_X509_subject_name_hash	proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+14h]
		call	_X509_NAME_hash
		add	esp, 4
		retn
_X509_subject_name_hash	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_subject_name_hash_old
_X509_subject_name_hash_old proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+14h]
		call	_X509_NAME_hash_old
		add	esp, 4
		retn
_X509_subject_name_hash_old endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_check_suite_b	proc near		; CODE XREF: _X509_CRL_check_suiteb+27p
					; _X509_chain_check_suiteb+14Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	loc_A72
		cmp	dword ptr [eax], 198h
		jnz	short loc_A72
		push	dword ptr [eax+14h]
		call	_EC_KEY_get0_group
		add	esp, 4
		test	eax, eax
		jz	short loc_A72
		push	eax
		call	_EC_GROUP_get_curve_name
		add	esp, 4
		cmp	eax, 2CBh
		jnz	short loc_A46
		mov	eax, [esp+arg_4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_A29
		cmp	eax, 31Bh
		jz	short loc_A29

loc_A23:				; CODE XREF: _check_suite_b+7Bj
		mov	eax, 3Bh ; ';'
		retn
; ---------------------------------------------------------------------------

loc_A29:				; CODE XREF: _check_suite_b+3Aj
					; _check_suite_b+41j
		mov	ecx, [esp+arg_8]
		mov	eax, [ecx]
		test	eax, 20000h
		jnz	short loc_A3C

loc_A36:				; CODE XREF: _check_suite_b+87j
		mov	eax, 3Ch ; '<'
		retn
; ---------------------------------------------------------------------------

loc_A3C:				; CODE XREF: _check_suite_b+54j
		and	eax, 0FFFEFFFFh
		mov	[ecx], eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A46:				; CODE XREF: _check_suite_b+31j
		cmp	eax, 19Fh
		jnz	short loc_A6C
		mov	eax, [esp+arg_4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_A5D
		cmp	eax, 31Ah
		jnz	short loc_A23

loc_A5D:				; CODE XREF: _check_suite_b+74j
		mov	eax, [esp+arg_8]
		test	dword ptr [eax], 10000h
		jz	short loc_A36
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A6C:				; CODE XREF: _check_suite_b+6Bj
		mov	eax, 3Ah ; ':'
		retn
; ---------------------------------------------------------------------------

loc_A72:				; CODE XREF: _check_suite_b+6j
					; _check_suite_b+12j ...
		mov	eax, 39h ; '9'
		retn
_check_suite_b	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A78h
; COMDAT (pick any)
		public ??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@
; `string'
??_C@_0BJ@KHABNHFN@?4?2crypto?2x509?2x509_cmp?4c?$AA@ db '.\crypto\x509\x509_cmp.c',0
					; DATA XREF: _X509_chain_up_ref+2Co
					; _X509_check_private_key+43o ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _sk_num:near	; CODE XREF: _X509_chain_check_suiteb+D1p
					; _X509_chain_check_suiteb+161p ...
		extrn _sk_value:near	; CODE XREF: _X509_chain_check_suiteb+31p
					; _X509_chain_check_suiteb+EDp	...
		extrn _sk_dup:near	; CODE XREF: _X509_chain_up_ref+6p
		extrn _CRYPTO_add_lock:near ; CODE XREF: _X509_chain_up_ref+39p
		extrn _CRYPTO_free:near	; CODE XREF: _X509_issuer_and_serial_hash+73p
		extrn _ERR_put_error:near ; CODE XREF: _X509_check_private_key+74p
		extrn _ASN1_STRING_cmp:near ; CODE XREF: _X509_find_by_issuer_and_serial+33p
					; _X509_issuer_and_serial_cmp+14p
		extrn _ASN1_INTEGER_get:near ; CODE XREF: _X509_chain_check_suiteb+49p
					; _X509_chain_check_suiteb+F9p
		extrn _OBJ_obj2nid:near	; CODE XREF: _X509_CRL_check_suiteb+18p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _X509_NAME_hash_old+29p
					; _X509_issuer_and_serial_hash+23p
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _X509_NAME_hash_old+ADp
					; _X509_issuer_and_serial_hash+D3p
		extrn _EVP_MD_CTX_set_flags:near ; CODE	XREF: _X509_NAME_hash_old+35p
		extrn _EVP_DigestInit_ex:near ;	CODE XREF: _X509_NAME_hash_old+49p
					; _X509_issuer_and_serial_hash+45p
		extrn _EVP_DigestUpdate:near ; CODE XREF: _X509_NAME_hash_old+62p
					; _X509_issuer_and_serial_hash+66p ...
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _X509_NAME_hash_old+79p
					; _X509_issuer_and_serial_hash+9Fp
		extrn _EVP_Digest:near	; CODE XREF: _X509_NAME_hash+3Ap
		extrn _EVP_md5:near	; CODE XREF: _X509_NAME_hash_old+3Ep
					; _X509_issuer_and_serial_hash+3Ap
		extrn _EVP_sha1:near	; CODE XREF: _X509_NAME_hash+27p
		extrn _EVP_PKEY_free:near ; CODE XREF: _X509_chain_check_suiteb+10Bp
					; _X509_chain_check_suiteb+1A9p ...
		extrn _EVP_PKEY_cmp:near ; CODE	XREF: _X509_check_private_key+26p
		extrn _EC_GROUP_get_curve_name:near
					; CODE XREF: _X509_chain_check_suiteb+A3p
					; _check_suite_b+24p
		extrn _EC_KEY_get0_group:near ;	CODE XREF: _X509_chain_check_suiteb+92p
					; _check_suite_b+17p
		extrn _X509_PUBKEY_get:near ; CODE XREF: _X509_chain_check_suiteb+71p
					; _X509_chain_check_suiteb+11Dp ...
		extrn _i2d_X509_NAME:near ; CODE XREF: _X509_NAME_cmp+14p
					; _X509_NAME_cmp+3Bp ...
		extrn _X509_get_signature_nid:near ; CODE XREF:	_X509_chain_check_suiteb+E2p
					; _X509_chain_check_suiteb+177p
		extrn _X509_NAME_oneline:near ;	CODE XREF: _X509_issuer_and_serial_hash+2Fp
		extrn _X509_check_purpose:near ; CODE XREF: _X509_cmp+Cp
					; _X509_cmp+1Ap
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _X509_NAME_hash+4Dp
					; _X509_NAME_hash+7Ep ...
		extrn __chkstk:near	; CODE XREF: _X509_NAME_hash+5p
					; _X509_NAME_hash_old+5p ...
		extrn ___security_cookie:near ;	DATA XREF: _X509_NAME_hash+Ar
					; _X509_NAME_hash_old+Ar ...


		end
