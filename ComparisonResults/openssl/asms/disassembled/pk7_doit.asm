;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	42D97309EDF7FB7C64923555EE6234F7
; Input	CRC32 :	1AB003B8

; File Name   :	C:\compspace\Diff\openssl\obj\pk7_doit.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_SIGNER_INFO_sign
_PKCS7_SIGNER_INFO_sign	proc near	; CODE XREF: _do_pkcs7_signed_attrib+AFp

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
arg_0		= dword	ptr  4

		mov	eax, 20h ; ' '
		call	__chkstk
		push	esi
		mov	esi, [esp+24h+arg_0]
		push	edi
		mov	[esp+28h+var_20], 0
		mov	eax, [esi+8]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_B2
		lea	eax, [esp+28h+var_18]
		push	eax
		call	_EVP_MD_CTX_init
		push	dword ptr [esi+1Ch]
		lea	eax, [esp+30h+var_1C]
		push	0
		push	edi
		push	eax
		lea	eax, [esp+3Ch+var_18]
		push	eax
		call	_EVP_DigestSignInit
		add	esp, 18h
		test	eax, eax
		jle	short $err$16
		push	esi
		push	0
		push	5
		push	8
		push	0FFFFFFFFh
		push	[esp+3Ch+var_1C]
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_BA
		push	3A2h

loc_7B:					; CODE XREF: _PKCS7_SIGNER_INFO_sign+16Fj
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	98h ; 'ò'
		push	8Bh ; 'ã'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

$err$16:				; CODE XREF: _PKCS7_SIGNER_INFO_sign+5Bj
					; _PKCS7_SIGNER_INFO_sign+E9j ...
		mov	eax, [esp+28h+var_20]
		test	eax, eax
		jz	short loc_A5
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_A5:					; CODE XREF: _PKCS7_SIGNER_INFO_sign+9Aj
					; _PKCS7_SIGNER_INFO_sign+D6j ...
		lea	eax, [esp+28h+var_18]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4

loc_B2:					; CODE XREF: _PKCS7_SIGNER_INFO_sign+35j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_BA:					; CODE XREF: _PKCS7_SIGNER_INFO_sign+74j
		call	_PKCS7_ATTR_SIGN_it
		push	eax
		lea	eax, [esp+2Ch+var_20]
		push	eax
		push	dword ptr [esi+0Ch]
		call	_ASN1_item_i2d
		mov	ecx, [esp+34h+var_20]
		add	esp, 0Ch
		test	ecx, ecx
		jz	short loc_A5
		push	eax
		push	ecx
		lea	eax, [esp+30h+var_18]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short $err$16
		push	[esp+28h+var_20]
		call	_CRYPTO_free
		lea	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_20], 0
		push	eax
		lea	eax, [esp+30h+var_18]
		push	0
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 10h
		test	eax, eax
		jle	short $err$16
		push	3B0h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	[esp+30h+arg_0]
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esp+28h+var_20], eax
		test	eax, eax
		jz	loc_A5
		lea	ecx, [esp+28h+arg_0]
		push	ecx
		push	eax
		lea	eax, [esp+30h+var_18]
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jle	$err$16
		push	esi
		push	1
		push	5
		push	8
		push	0FFFFFFFFh
		push	[esp+3Ch+var_1C]
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_174
		push	3B8h
		jmp	loc_7B
; ---------------------------------------------------------------------------

loc_174:				; CODE XREF: _PKCS7_SIGNER_INFO_sign+168j
		lea	eax, [esp+28h+var_18]
		push	eax
		call	_EVP_MD_CTX_cleanup
		push	[esp+2Ch+arg_0]
		push	[esp+30h+var_20]
		push	dword ptr [esi+14h]
		call	_ASN1_STRING_set0
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		add	esp, 20h
		retn
_PKCS7_SIGNER_INFO_sign	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 19Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_add_attribute
_PKCS7_add_attribute proc near

arg_0		= dword	ptr  4

		add	[esp+arg_0], 18h
		jmp	_add_attribute
_PKCS7_add_attribute endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_add_signed_attribute
_PKCS7_add_signed_attribute proc near

arg_0		= dword	ptr  4

		add	[esp+arg_0], 0Ch
		jmp	_add_attribute
_PKCS7_add_signed_attribute endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_PKCS7_bio_add_digest proc near		; CODE XREF: _PKCS7_dataInit+175p
					; _PKCS7_dataInit+1A1p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		call	_BIO_f_md
		push	eax
		call	_BIO_new
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1E2
		push	6Dh ; 'm'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	20h ; ' '
		push	7Dh ; '}'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1E2:				; CODE XREF: _PKCS7_bio_add_digest+13j
		mov	eax, [esp+4+arg_4]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_20B
		push	73h ; 's'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Dh ; 'm'
		jmp	short loc_243
; ---------------------------------------------------------------------------

loc_20B:				; CODE XREF: _PKCS7_bio_add_digest+4Aj
		push	eax
		push	0
		push	6Fh ; 'o'
		push	esi
		call	_BIO_ctrl
		mov	eax, [esp+14h+arg_0]
		add	esp, 10h
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_22C
		mov	[eax], esi

loc_225:				; CODE XREF: _PKCS7_bio_add_digest+84j
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_22C:				; CODE XREF: _PKCS7_bio_add_digest+6Dj
		push	esi
		push	ecx
		call	_BIO_push
		add	esp, 8
		test	eax, eax
		jnz	short loc_225
		push	7Bh ; '{'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	20h ; ' '

loc_243:				; CODE XREF: _PKCS7_bio_add_digest+55j
		push	7Dh ; '}'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

$err$11:
		push	esi
		call	_BIO_free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
_PKCS7_bio_add_digest endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 25Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_dataDecode
_PKCS7_dataDecode proc near

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 34h ; '4'
		call	__chkstk
		push	ebx
		push	ebp
		xor	ebx, ebx
		xor	eax, eax
		push	esi
		mov	esi, [esp+40h+arg_0]
		xor	ebp, ebp
		push	edi
		xor	edi, edi
		mov	[esp+44h+var_2C], ebx
		mov	[esp+44h+var_C], ebx
		mov	[esp+44h+var_10], ebx
		mov	[esp+44h+var_34], ebx
		mov	[esp+44h+var_8], ebx
		mov	[esp+44h+var_24], ebx
		mov	[esp+44h+var_20], ebx
		mov	[esp+44h+var_1C], edi
		mov	[esp+44h+var_30], eax
		mov	[esp+44h+var_28], eax
		mov	[esp+44h+var_18], eax
		mov	[esp+44h+var_14], eax
		test	esi, esi
		jnz	short loc_2CF
		push	1B2h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	8Fh ; 'è'
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_2CF:				; CODE XREF: _PKCS7_dataDecode+4Cj
		cmp	[esi+14h], eax
		jnz	short loc_2F6
		push	1B7h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	7Ah ; 'z'
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_2F6:				; CODE XREF: _PKCS7_dataDecode+76j
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		mov	[esi+8], ebx
		sub	eax, 16h
		jz	loc_3E9
		sub	eax, 1
		jz	loc_3A9
		sub	eax, 1
		jz	short loc_33F
		push	1E8h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	70h ; 'p'
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_33F:				; CODE XREF: _PKCS7_dataDecode+BDj
		mov	eax, [esi+14h]
		mov	esi, [eax+18h]
		mov	ecx, [eax+4]
		mov	eax, [eax+14h]
		mov	[esp+44h+var_20], esi
		mov	[esp+44h+var_24], ecx
		mov	esi, [eax+4]
		mov	ecx, [eax+8]
		mov	[esp+44h+arg_0], ecx
		mov	[esp+44h+var_8], esi
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		mov	ecx, eax
		add	esp, 0Ch
		mov	[esp+44h+var_10], ecx
		test	ecx, ecx
		jnz	loc_44B
		push	1D7h

loc_38A:				; CODE XREF: _PKCS7_dataDecode+18Bj
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Fh ; 'o'

loc_391:				; CODE XREF: _PKCS7_dataDecode+1D6j
					; _PKCS7_dataDecode+20Dj
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_3A9:				; CODE XREF: _PKCS7_dataDecode+B4j
		mov	eax, [esi+14h]
		mov	ecx, [eax+4]
		mov	eax, [eax+8]
		mov	[esp+44h+var_20], ecx
		mov	ecx, [eax+4]
		mov	eax, [eax+8]
		mov	[esp+44h+var_8], ecx
		mov	[esp+44h+arg_0], eax
		push	dword ptr [ecx]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		add	esp, 0Ch
		mov	[esp+44h+var_10], eax
		test	eax, eax
		jnz	short loc_447
		push	1E3h
		jmp	short loc_38A
; ---------------------------------------------------------------------------

loc_3E9:				; CODE XREF: _PKCS7_dataDecode+ABj
		mov	eax, [esi+14h]
		push	dword ptr [eax+14h]
		call	_PKCS7_get_octet_string
		push	dword ptr [esi+10h]
		mov	[esp+4Ch+arg_0], eax
		call	_OBJ_obj2nid
		add	esp, 8
		cmp	eax, 16h
		jnz	short loc_41B
		push	0
		push	0
		push	2
		push	esi
		call	_PKCS7_ctrl
		add	esp, 10h
		test	eax, eax
		jnz	short loc_437

loc_41B:				; CODE XREF: _PKCS7_dataDecode+1AAj
		mov	ecx, [esp+44h+arg_0]
		test	ecx, ecx
		jnz	short loc_43B
		push	1C9h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	9Bh ; 'õ'
		jmp	loc_391
; ---------------------------------------------------------------------------

loc_437:				; CODE XREF: _PKCS7_dataDecode+1BDj
		mov	ecx, [esp+44h+arg_0]

loc_43B:				; CODE XREF: _PKCS7_dataDecode+1C5j
		mov	eax, [esi+14h]
		mov	eax, [eax+4]
		mov	[esp+44h+var_24], eax
		jmp	short loc_453
; ---------------------------------------------------------------------------

loc_447:				; CODE XREF: _PKCS7_dataDecode+184j
		xor	eax, eax
		jmp	short loc_44F
; ---------------------------------------------------------------------------

loc_44B:				; CODE XREF: _PKCS7_dataDecode+123j
		mov	eax, [esp+44h+var_24]

loc_44F:				; CODE XREF: _PKCS7_dataDecode+1EDj
		mov	ecx, [esp+44h+arg_0]

loc_453:				; CODE XREF: _PKCS7_dataDecode+1E9j
		test	ecx, ecx
		jnz	short loc_46E
		cmp	[esp+44h+arg_8], ebx
		jnz	short loc_46E
		push	1EEh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	7Ah ; 'z'
		jmp	loc_391
; ---------------------------------------------------------------------------

loc_46E:				; CODE XREF: _PKCS7_dataDecode+1F9j
					; _PKCS7_dataDecode+1FFj
		test	eax, eax
		jz	loc_503
		push	eax
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_503
		nop	dword ptr [eax+00000000h]

loc_48C:				; CODE XREF: _PKCS7_dataDecode+2A5j
		push	esi
		push	[esp+48h+var_24]
		call	_sk_value
		mov	[esp+4Ch+var_4], eax
		call	_BIO_f_md
		push	eax
		call	_BIO_new
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	loc_561
		mov	eax, [esp+44h+var_4]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_542
		push	eax
		push	0
		push	6Fh ; 'o'
		push	ebp
		call	_BIO_ctrl
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_4E6
		mov	ebx, ebp
		jmp	short loc_4F0
; ---------------------------------------------------------------------------

loc_4E6:				; CODE XREF: _PKCS7_dataDecode+284j
		push	ebp
		push	ebx
		call	_BIO_push
		add	esp, 8

loc_4F0:				; CODE XREF: _PKCS7_dataDecode+288j
		push	[esp+44h+var_24]
		xor	ebp, ebp
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_48C

loc_503:				; CODE XREF: _PKCS7_dataDecode+214j
					; _PKCS7_dataDecode+227j
		cmp	[esp+44h+var_10], edi
		jz	loc_815
		call	_BIO_f_cipher
		push	eax
		call	_BIO_new
		mov	esi, eax
		add	esp, 4
		mov	[esp+44h+var_2C], esi
		test	esi, esi
		jnz	short loc_580
		push	217h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	20h ; ' '
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_8B4
; ---------------------------------------------------------------------------

loc_542:				; CODE XREF: _PKCS7_dataDecode+272j
		push	1FFh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Dh ; 'm'
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi
		jmp	loc_8B4
; ---------------------------------------------------------------------------

loc_561:				; CODE XREF: _PKCS7_dataDecode+250j
		push	1F7h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	20h ; ' '
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi
		jmp	loc_8B4
; ---------------------------------------------------------------------------

loc_580:				; CODE XREF: _PKCS7_dataDecode+2C7j
		xor	esi, esi
		cmp	[esp+44h+arg_C], edi
		jz	loc_63F
		mov	edi, [esp+44h+var_20]
		push	edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_5F1

loc_59D:				; CODE XREF: _PKCS7_dataDecode+393j
		push	esi
		push	edi
		call	_sk_value
		mov	ecx, eax
		mov	eax, [esp+4Ch+arg_C]
		mov	[esp+4Ch+var_20], ecx
		mov	eax, [eax]
		push	dword ptr [eax+0Ch]
		mov	eax, [ecx+4]
		push	dword ptr [eax]
		call	_X509_NAME_cmp
		add	esp, 10h
		test	eax, eax
		jnz	short loc_5E3
		mov	eax, [esp+44h+var_20]
		mov	eax, [eax+4]
		push	dword ptr [eax+4]
		mov	eax, [esp+48h+arg_C]
		mov	eax, [eax]
		push	dword ptr [eax+4]
		call	_ASN1_STRING_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_60E

loc_5E3:				; CODE XREF: _PKCS7_dataDecode+366j
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_59D

loc_5F1:				; CODE XREF: _PKCS7_dataDecode+33Fj
		push	22Eh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	73h ; 's'
		push	70h ; 'p'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_8B0
; ---------------------------------------------------------------------------

loc_60E:				; CODE XREF: _PKCS7_dataDecode+385j
		push	[esp+44h+arg_4]
		lea	eax, [esp+48h+var_18]
		push	[esp+48h+var_20]
		push	eax
		lea	eax, [esp+50h+var_1C]
		push	eax
		call	_pkcs7_decrypt_rinfo
		add	esp, 10h
		test	eax, eax
		js	short loc_696
		call	_ERR_clear_error
		mov	esi, [esp+44h+var_18]
		mov	edi, [esp+44h+var_1C]
		mov	[esp+44h+var_28], esi
		jmp	short loc_6A5
; ---------------------------------------------------------------------------

loc_63F:				; CODE XREF: _PKCS7_dataDecode+32Aj
		push	[esp+44h+var_20]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_6A3
		mov	edi, [esp+44h+var_20]

loc_653:				; CODE XREF: _PKCS7_dataDecode+42Aj
		push	esi
		push	edi
		call	_sk_value
		push	[esp+4Ch+arg_4]
		push	eax
		lea	eax, [esp+54h+var_18]
		push	eax
		lea	eax, [esp+58h+var_1C]
		push	eax
		call	_pkcs7_decrypt_rinfo
		add	esp, 18h
		test	eax, eax
		js	short loc_696
		call	_ERR_clear_error
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_653
		mov	esi, [esp+44h+var_18]
		mov	edi, [esp+44h+var_1C]
		mov	[esp+44h+var_28], esi
		jmp	short loc_6A5
; ---------------------------------------------------------------------------

loc_696:				; CODE XREF: _PKCS7_dataDecode+3CEj
					; _PKCS7_dataDecode+417j
		mov	edi, [esp+44h+var_1C]
		mov	esi, [esp+44h+var_18]
		jmp	$err$99
; ---------------------------------------------------------------------------

loc_6A3:				; CODE XREF: _PKCS7_dataDecode+3F1j
		xor	esi, esi

loc_6A5:				; CODE XREF: _PKCS7_dataDecode+3E1j
					; _PKCS7_dataDecode+438j
		lea	eax, [esp+44h+var_34]
		mov	[esp+44h+var_34], 0
		push	eax
		push	0
		push	81h ; 'Å'
		push	[esp+50h+var_2C]
		call	_BIO_ctrl
		push	0
		push	0
		push	0
		push	0
		push	[esp+64h+var_10]
		push	[esp+68h+var_34]
		call	_EVP_CipherInit_ex
		add	esp, 28h
		test	eax, eax
		jle	$err$99
		mov	eax, [esp+44h+var_8]
		push	dword ptr [eax+4]
		push	[esp+48h+var_34]
		call	_EVP_CIPHER_asn1_to_param
		add	esp, 8
		test	eax, eax
		js	$err$99
		push	[esp+44h+var_34]
		call	_EVP_CIPHER_CTX_key_length
		push	24Fh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	eax
		mov	[esp+54h+var_14], eax
		call	_CRYPTO_malloc
		add	esp, 10h
		mov	[esp+44h+var_30], eax
		test	eax, eax
		jz	$err$99
		push	eax
		push	[esp+48h+var_34]
		call	_EVP_CIPHER_CTX_rand_key
		add	esp, 8
		test	eax, eax
		jle	$err$99
		test	edi, edi
		jnz	short loc_756
		mov	edi, [esp+44h+var_30]
		mov	esi, [esp+44h+var_14]
		mov	[esp+44h+var_28], esi
		mov	[esp+44h+var_30], 0

loc_756:				; CODE XREF: _PKCS7_dataDecode+4E4j
		push	[esp+44h+var_34]
		call	_EVP_CIPHER_CTX_key_length
		add	esp, 4
		cmp	esi, eax
		jz	short loc_79B
		push	esi
		push	[esp+48h+var_34]
		call	_EVP_CIPHER_CTX_set_key_length
		add	esp, 8
		test	eax, eax
		jnz	short loc_79B
		push	esi
		push	edi
		call	_OPENSSL_cleanse
		push	edi
		call	_CRYPTO_free
		mov	edi, [esp+50h+var_30]
		add	esp, 0Ch
		mov	esi, [esp+44h+var_14]
		mov	[esp+44h+var_28], esi
		mov	[esp+44h+var_30], 0

loc_79B:				; CODE XREF: _PKCS7_dataDecode+508j
					; _PKCS7_dataDecode+519j
		call	_ERR_clear_error
		push	0
		push	0
		push	edi
		push	0
		push	0
		push	[esp+58h+var_34]
		call	_EVP_CipherInit_ex
		add	esp, 18h
		test	eax, eax
		jle	$err$99
		test	edi, edi
		jz	short loc_7D3
		push	esi
		push	edi
		call	_OPENSSL_cleanse
		push	edi
		call	_CRYPTO_free
		add	esp, 0Ch
		xor	edi, edi

loc_7D3:				; CODE XREF: _PKCS7_dataDecode+563j
		mov	esi, [esp+44h+var_30]
		test	esi, esi
		jz	short loc_7F6
		push	[esp+44h+var_14]
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		add	esp, 0Ch
		mov	[esp+44h+var_30], 0

loc_7F6:				; CODE XREF: _PKCS7_dataDecode+57Dj
		test	ebx, ebx
		jnz	short loc_800
		mov	ebx, [esp+44h+var_2C]
		jmp	short loc_80D
; ---------------------------------------------------------------------------

loc_800:				; CODE XREF: _PKCS7_dataDecode+59Cj
		push	[esp+44h+var_2C]
		push	ebx
		call	_BIO_push
		add	esp, 8

loc_80D:				; CODE XREF: _PKCS7_dataDecode+5A2j
		mov	[esp+44h+var_2C], 0

loc_815:				; CODE XREF: _PKCS7_dataDecode+2ABj
		mov	eax, [esp+44h+arg_8]
		test	eax, eax
		jnz	short loc_869
		mov	ecx, [esp+44h+arg_0]
		mov	eax, [ecx]
		test	eax, eax
		jle	short loc_839
		push	eax
		push	dword ptr [ecx+8]
		call	_BIO_new_mem_buf
		add	esp, 8
		mov	[esp+44h+var_C], eax
		jmp	short loc_865
; ---------------------------------------------------------------------------

loc_839:				; CODE XREF: _PKCS7_dataDecode+5C9j
		call	_BIO_s_mem
		push	eax
		call	_BIO_new
		add	esp, 4
		mov	[esp+44h+var_C], eax
		test	eax, eax
		jz	short loc_87D
		push	0
		push	0
		push	82h ; 'Ç'
		push	eax
		call	_BIO_ctrl
		mov	eax, [esp+54h+var_C]
		add	esp, 10h

loc_865:				; CODE XREF: _PKCS7_dataDecode+5DBj
		test	eax, eax
		jz	short loc_87D

loc_869:				; CODE XREF: _PKCS7_dataDecode+5BFj
		push	eax
		push	ebx
		call	_BIO_push
		add	esp, 8
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_87D:				; CODE XREF: _PKCS7_dataDecode+5F1j
					; _PKCS7_dataDecode+60Bj
		mov	esi, [esp+44h+var_28]

$err$99:				; CODE XREF: _PKCS7_dataDecode+442j
					; _PKCS7_dataDecode+480j ...
		test	edi, edi
		jz	short loc_895
		push	esi
		push	edi
		call	_OPENSSL_cleanse
		push	edi
		call	_CRYPTO_free
		add	esp, 0Ch

loc_895:				; CODE XREF: _PKCS7_dataDecode+627j
		mov	esi, [esp+44h+var_30]
		test	esi, esi
		jz	short loc_8B0
		push	[esp+44h+var_14]
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		add	esp, 0Ch

loc_8B0:				; CODE XREF: _PKCS7_dataDecode+3ADj
					; _PKCS7_dataDecode+63Fj
		mov	esi, [esp+44h+var_2C]

loc_8B4:				; CODE XREF: _PKCS7_dataDecode+2E1j
					; _PKCS7_dataDecode+300j ...
		test	ebx, ebx
		jz	short loc_8C1
		push	ebx
		call	_BIO_free_all
		add	esp, 4

loc_8C1:				; CODE XREF: _PKCS7_dataDecode+65Aj
		test	ebp, ebp
		jz	short loc_8CE
		push	ebp
		call	_BIO_free_all
		add	esp, 4

loc_8CE:				; CODE XREF: _PKCS7_dataDecode+667j
		test	esi, esi
		jz	short loc_8DB
		push	esi
		call	_BIO_free_all
		add	esp, 4

loc_8DB:				; CODE XREF: _PKCS7_dataDecode+674j
		mov	eax, [esp+44h+var_C]
		test	eax, eax
		jz	short loc_8EC
		push	eax
		call	_BIO_free_all
		add	esp, 4

loc_8EC:				; CODE XREF: _PKCS7_dataDecode+685j
		pop	edi
		pop	esi
		xor	ebx, ebx
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 34h
		retn
_PKCS7_dataDecode endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_dataFinal
_PKCS7_dataFinal proc near

var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 74h ; 't'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		push	esi
		mov	esi, [esp+78h+arg_4]
		push	edi
		mov	edi, [esp+7Ch+arg_0]
		mov	[esp+7Ch+var_6C], esi
		mov	[esp+7Ch+var_60], 0
		test	edi, edi
		jnz	short loc_95E
		push	2F4h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	8Fh ; 'è'

loc_93C:				; CODE XREF: _PKCS7_dataFinal+78j
		push	80h ; 'Ä'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+74h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_95E:				; CODE XREF: _PKCS7_dataFinal+33j
		cmp	dword ptr [edi+14h], 0
		jnz	short loc_972
		push	2F9h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	7Ah ; 'z'
		jmp	short loc_93C
; ---------------------------------------------------------------------------

loc_972:				; CODE XREF: _PKCS7_dataFinal+6Aj
		push	ebx
		lea	eax, [esp+80h+var_5C]
		push	ebp
		push	eax
		call	_EVP_MD_CTX_init
		push	dword ptr [edi+10h]
		call	_OBJ_obj2nid
		mov	ebx, eax
		mov	dword ptr [edi+8], 0
		add	esp, 8
		lea	eax, [ebx-15h]	; switch 5 cases
		cmp	eax, 4
		ja	loc_CD0		; jumptable 0000099E default case
		jmp	ds:$LN54[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _PKCS7_dataFinal+A6j
					; DATA XREF: .text$mn:$LN54o
		mov	ebp, [edi+14h]	; jumptable 0000099E case 21
		jmp	loc_BD9
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: _PKCS7_dataFinal+A6j
					; DATA XREF: .text$mn:$LN54o
		mov	eax, [edi+14h]	; jumptable 0000099E case 24
		mov	esi, [eax+10h]
		mov	eax, [eax+14h]
		mov	[esp+84h+var_64], esi
		mov	ebp, [eax+8]
		test	ebp, ebp
		jnz	loc_A78
		push	4
		call	_ASN1_STRING_type_new
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_9E6
		push	30Ch
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	41h ; 'A'
		jmp	loc_CDC
; ---------------------------------------------------------------------------

loc_9E6:				; CODE XREF: _PKCS7_dataFinal+DBj
		mov	eax, [edi+14h]
		mov	eax, [eax+14h]
		mov	[eax+8], ebp
		jmp	loc_A78
; ---------------------------------------------------------------------------

$LN13_0:				; CODE XREF: _PKCS7_dataFinal+A6j
					; DATA XREF: .text$mn:$LN54o
		mov	eax, [edi+14h]	; jumptable 0000099E case 23
		mov	eax, [eax+8]
		mov	ebp, [eax+8]
		test	ebp, ebp
		jnz	loc_BD9
		push	4
		call	_ASN1_STRING_type_new
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_A26
		push	318h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	41h ; 'A'
		jmp	loc_CDC
; ---------------------------------------------------------------------------

loc_A26:				; CODE XREF: _PKCS7_dataFinal+11Bj
		mov	eax, [edi+14h]
		mov	eax, [eax+8]
		mov	[eax+8], ebp
		jmp	loc_BD9
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: _PKCS7_dataFinal+A6j
					; DATA XREF: .text$mn:$LN54o
		mov	eax, [edi+14h]	; jumptable 0000099E case 22
		mov	esi, [eax+10h]
		push	dword ptr [eax+14h]
		mov	[esp+88h+var_64], esi
		call	_PKCS7_get_octet_string
		mov	ebp, eax
		mov	eax, [edi+14h]
		mov	eax, [eax+14h]
		push	dword ptr [eax+10h]
		call	_OBJ_obj2nid
		add	esp, 8
		cmp	eax, 15h
		jnz	short loc_A78
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_A78
		push	ebp
		call	_ASN1_STRING_free
		mov	eax, [edi+14h]
		add	esp, 4
		xor	ebp, ebp
		mov	eax, [eax+14h]
		mov	[eax+14h], ebp

loc_A78:				; CODE XREF: _PKCS7_dataFinal+C7j
					; _PKCS7_dataFinal+F7j	...
		test	esi, esi
		jz	loc_BD5
		push	esi
		xor	ebx, ebx
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_C37
		nop	dword ptr [eax+eax+00h]

loc_A98:				; CODE XREF: _PKCS7_dataFinal+282j
		push	ebx
		push	esi
		call	_sk_value
		mov	esi, eax
		add	esp, 8
		cmp	dword ptr [esi+1Ch], 0
		jz	loc_B6A
		mov	eax, [esi+8]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		push	[esp+8Ch+var_6C]
		lea	eax, [esp+90h+var_70]
		push	eax
		call	_PKCS7_find_digest
		add	esp, 10h
		test	eax, eax
		jz	$err$55
		push	[esp+84h+var_70]
		lea	eax, [esp+88h+var_5C]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	$err$55
		push	dword ptr [esi+0Ch]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_B12
		lea	eax, [esp+84h+var_5C]
		push	eax
		push	esi
		call	_do_pkcs7_signed_attrib
		add	esp, 8
		test	eax, eax
		jz	$err$55
		jmp	short loc_B6A
; ---------------------------------------------------------------------------

loc_B12:				; CODE XREF: _PKCS7_dataFinal+200j
		push	dword ptr [esi+1Ch]
		call	_EVP_PKEY_size
		push	35Ah
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	eax
		mov	[esp+94h+var_68], eax
		call	_CRYPTO_malloc
		add	esp, 10h
		mov	[esp+84h+var_74], eax
		test	eax, eax
		jz	$err$55
		push	dword ptr [esi+1Ch]
		lea	ecx, [esp+88h+var_68]
		push	ecx
		push	eax
		lea	eax, [esp+90h+var_5C]
		push	eax
		call	_EVP_SignFinal
		add	esp, 10h
		test	eax, eax
		jz	short loc_B85
		push	[esp+84h+var_68]
		push	[esp+88h+var_74]
		push	dword ptr [esi+14h]
		call	_ASN1_STRING_set0
		add	esp, 0Ch

loc_B6A:				; CODE XREF: _PKCS7_dataFinal+1B0j
					; _PKCS7_dataFinal+218j
		mov	esi, [esp+84h+var_64]
		inc	ebx
		push	esi
		call	_sk_num
		add	esp, 4
		cmp	ebx, eax
		jl	loc_A98
		jmp	loc_C37
; ---------------------------------------------------------------------------

loc_B85:				; CODE XREF: _PKCS7_dataFinal+25Dj
		push	35Fh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6
		jmp	loc_CDC
; ---------------------------------------------------------------------------

$LN18_0:				; CODE XREF: _PKCS7_dataFinal+A6j
					; DATA XREF: .text$mn:$LN54o
		mov	eax, [edi+14h]	; jumptable 0000099E case 25
		push	dword ptr [eax+8]
		call	_PKCS7_get_octet_string
		mov	ebp, eax
		mov	eax, [edi+14h]
		mov	eax, [eax+8]
		push	dword ptr [eax+10h]
		call	_OBJ_obj2nid
		add	esp, 8
		cmp	eax, 15h
		jnz	short loc_BD9
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_BD9
		push	ebp
		call	_ASN1_STRING_free
		mov	eax, [edi+14h]
		add	esp, 4
		xor	ebp, ebp
		mov	eax, [eax+8]
		mov	[eax+14h], ebp
		jmp	short loc_BD9
; ---------------------------------------------------------------------------

loc_BD5:				; CODE XREF: _PKCS7_dataFinal+182j
		mov	esi, [esp+84h+var_6C]

loc_BD9:				; CODE XREF: _PKCS7_dataFinal+B0j
					; _PKCS7_dataFinal+107j ...
		cmp	ebx, 19h
		jnz	short loc_C37
		mov	eax, [edi+14h]
		mov	eax, [eax+4]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		lea	eax, [esp+8Ch+var_70]
		push	esi
		push	eax
		call	_PKCS7_find_digest
		add	esp, 10h
		test	eax, eax
		jz	$err$55
		lea	eax, [esp+84h+var_74]
		push	eax
		lea	eax, [esp+88h+var_44]
		push	eax
		push	[esp+8Ch+var_70]
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	$err$55
		push	[esp+84h+var_74]
		lea	eax, [esp+88h+var_44]
		push	eax
		mov	eax, [edi+14h]
		push	dword ptr [eax+0Ch]
		call	_ASN1_STRING_set
		add	esp, 0Ch

loc_C37:				; CODE XREF: _PKCS7_dataFinal+195j
					; _PKCS7_dataFinal+288j ...
		push	dword ptr [edi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jnz	short loc_C5A
		push	0
		push	0
		push	2
		push	edi
		call	_PKCS7_ctrl
		add	esp, 10h
		test	eax, eax
		jnz	short loc_CC6

loc_C5A:				; CODE XREF: _PKCS7_dataFinal+34Dj
		test	ebp, ebp
		jz	$err$55
		test	byte ptr [ebp+0Ch], 10h
		jnz	short loc_CC6
		push	401h
		push	[esp+88h+var_6C]
		call	_BIO_find_type
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_C8D
		push	37Ch
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Bh ; 'k'
		jmp	short loc_CDC
; ---------------------------------------------------------------------------

loc_C8D:				; CODE XREF: _PKCS7_dataFinal+385j
		lea	eax, [esp+84h+var_74]
		push	eax
		push	0
		push	3
		push	edi
		call	_BIO_ctrl
		push	200h
		push	edi
		mov	esi, eax
		call	_BIO_set_flags
		push	0
		push	0
		push	82h ; 'Ç'
		push	edi
		call	_BIO_ctrl
		push	esi
		push	[esp+0B0h+var_74]
		push	ebp
		call	_ASN1_STRING_set0
		add	esp, 34h

loc_CC6:				; CODE XREF: _PKCS7_dataFinal+360j
					; _PKCS7_dataFinal+36Ej
		mov	[esp+84h+var_60], 1
		jmp	short $err$55
; ---------------------------------------------------------------------------

loc_CD0:				; CODE XREF: _PKCS7_dataFinal+A0j
		push	334h		; jumptable 0000099E default case
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	70h ; 'p'

loc_CDC:				; CODE XREF: _PKCS7_dataFinal+E9j
					; _PKCS7_dataFinal+129j ...
		push	80h ; 'Ä'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

$err$55:				; CODE XREF: _PKCS7_dataFinal+1D4j
					; _PKCS7_dataFinal+1EDj ...
		lea	eax, [esp+84h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+88h+var_4]
		add	esp, 4
		mov	eax, [esp+84h+var_60]
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
_PKCS7_dataFinal endp

; ---------------------------------------------------------------------------
		align 4
$LN54		dd offset $LN9		; DATA XREF: _PKCS7_dataFinal+A6r
		dd offset $LN16		; jump table for switch	statement
		dd offset $LN13_0
		dd offset $LN10
		dd offset $LN18_0
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D28h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_dataInit
_PKCS7_dataInit	proc near

var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 74h ; 't'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		push	ebx
		mov	ebx, [esp+78h+arg_4]
		xor	eax, eax
		push	ebp
		push	esi
		xor	ecx, ecx
		mov	[esp+80h+var_70], eax
		push	edi
		mov	edi, [esp+84h+arg_0]
		xor	esi, esi
		xor	ebp, ebp
		mov	[esp+84h+var_58], edi
		mov	[esp+84h+var_74], esi
		mov	[esp+84h+var_6C], ecx
		mov	[esp+84h+var_64], ecx
		mov	[esp+84h+var_68], eax
		mov	[esp+84h+var_60], eax
		test	edi, edi
		jnz	short loc_DA7
		push	109h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	8Fh ; 'è'
		push	69h ; 'i'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+74h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_DA7:				; CODE XREF: _PKCS7_dataInit+4Dj
		cmp	[edi+14h], eax
		jnz	short loc_DD9
		push	117h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	7Ah ; 'z'
		push	69h ; 'i'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+74h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_DD9:				; CODE XREF: _PKCS7_dataInit+82j
		push	dword ptr [edi+10h]
		call	_OBJ_obj2nid
		add	eax, 0FFFFFFEBh
		mov	[edi+8], esi
		add	esp, 4
		cmp	eax, 4		; switch 5 cases
		ja	loc_115B	; jumptable 00000DF3 default case
		jmp	ds:$LN66[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: _PKCS7_dataInit+CBj
					; DATA XREF: .text$mn:$LN66o
		mov	eax, [edi+14h]	; jumptable 00000DF3 case 1
		mov	ebp, [eax+4]
		push	dword ptr [eax+14h]
		jmp	short loc_E75
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _PKCS7_dataInit+CBj
					; DATA XREF: .text$mn:$LN66o
		mov	eax, [edi+14h]	; jumptable 00000DF3 case 3
		mov	ecx, [eax+18h]
		mov	ebp, [eax+4]
		mov	eax, [eax+14h]
		mov	[esp+84h+var_64], ecx
		mov	ecx, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+84h+var_68], ecx
		mov	[esp+84h+var_70], eax
		test	eax, eax
		jnz	short $LN18	; jumptable 00000DF3 case 0
		push	129h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	74h ; 't'
		jmp	loc_1167
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _PKCS7_dataInit+CBj
					; DATA XREF: .text$mn:$LN66o
		mov	eax, [edi+14h]	; jumptable 00000DF3 case 2
		mov	ecx, [eax+4]
		mov	eax, [eax+8]
		mov	[esp+84h+var_64], ecx
		mov	ecx, [eax+4]
		mov	eax, [eax+0Ch]
		mov	[esp+84h+var_68], ecx
		mov	[esp+84h+var_70], eax
		test	eax, eax
		jnz	short $LN18	; jumptable 00000DF3 case 0
		push	132h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	74h ; 't'
		jmp	loc_1167
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _PKCS7_dataInit+CBj
					; DATA XREF: .text$mn:$LN66o
		mov	eax, [edi+14h]	; jumptable 00000DF3 case 4
		mov	ecx, [eax+4]
		push	dword ptr [eax+8]
		mov	[esp+88h+var_6C], ecx

loc_E75:				; CODE XREF: _PKCS7_dataInit+DBj
		call	_PKCS7_get_octet_string
		mov	[esp+88h+var_60], eax
		add	esp, 4

$LN18:					; CODE XREF: _PKCS7_dataInit+CBj
					; _PKCS7_dataInit+FDj ...
		push	ebp		; jumptable 00000DF3 case 0
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_EBB

loc_E90:				; CODE XREF: _PKCS7_dataInit+18Dj
		push	edi
		push	ebp
		call	_sk_value
		push	eax
		lea	eax, [esp+90h+var_74]
		push	eax
		call	_PKCS7_bio_add_digest
		add	esp, 10h
		test	eax, eax
		jz	short loc_F1A
		push	ebp
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_E90
		mov	esi, [esp+84h+var_74]

loc_EBB:				; CODE XREF: _PKCS7_dataInit+166j
		mov	eax, [esp+84h+var_6C]
		test	eax, eax
		jz	short loc_ED9
		push	eax
		lea	eax, [esp+88h+var_74]
		push	eax
		call	_PKCS7_bio_add_digest
		add	esp, 8
		test	eax, eax
		jz	short loc_F1A
		mov	esi, [esp+84h+var_74]

loc_ED9:				; CODE XREF: _PKCS7_dataInit+199j
		mov	edi, [esp+84h+var_70]
		test	edi, edi
		jz	loc_1080
		call	_BIO_f_cipher
		push	eax
		call	_BIO_new
		mov	ebp, eax
		add	esp, 4
		mov	[esp+84h+var_70], ebp
		test	ebp, ebp
		jnz	short loc_F25
		push	14Fh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	20h ; ' '
		push	69h ; 'i'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$67
; ---------------------------------------------------------------------------

loc_F1A:				; CODE XREF: _PKCS7_dataInit+17Fj
					; _PKCS7_dataInit+1ABj
		mov	esi, [esp+84h+var_74]
		xor	ebp, ebp
		jmp	$err$67
; ---------------------------------------------------------------------------

loc_F25:				; CODE XREF: _PKCS7_dataInit+1D3j
		lea	eax, [esp+84h+var_74]
		push	eax
		push	0
		push	81h ; 'Å'
		push	ebp
		call	_BIO_ctrl
		push	edi
		call	_EVP_CIPHER_key_length
		push	edi
		mov	[esp+9Ch+var_5C], eax
		call	_EVP_CIPHER_iv_length
		push	edi
		mov	[esp+0A0h+var_6C], eax
		call	_EVP_CIPHER_type
		push	eax
		call	_OBJ_nid2obj
		mov	ecx, [esp+0A4h+var_68]
		add	esp, 20h
		mov	[ecx], eax
		mov	eax, [esp+84h+var_6C]
		test	eax, eax
		jle	short loc_F7E
		push	eax
		lea	eax, [esp+88h+var_54]
		push	eax
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jle	$err$67

loc_F7E:				; CODE XREF: _PKCS7_dataInit+23Ej
		push	1
		push	0
		push	0
		push	0
		push	edi
		push	[esp+98h+var_74]
		call	_EVP_CipherInit_ex
		add	esp, 18h
		test	eax, eax
		jle	$err$67
		lea	eax, [esp+84h+var_44]
		push	eax
		push	[esp+88h+var_74]
		call	_EVP_CIPHER_CTX_rand_key
		add	esp, 8
		test	eax, eax
		jle	$err$67
		push	1
		lea	eax, [esp+88h+var_54]
		push	eax
		lea	eax, [esp+8Ch+var_44]
		push	eax
		push	0
		push	0
		push	[esp+98h+var_74]
		call	_EVP_CipherInit_ex
		add	esp, 18h
		test	eax, eax
		jle	$err$67
		mov	eax, [esp+84h+var_6C]
		test	eax, eax
		jle	short loc_1011
		mov	edi, [esp+84h+var_68]
		cmp	dword ptr [edi+4], 0
		jnz	short loc_FFA
		call	_ASN1_TYPE_new
		mov	[edi+4], eax
		test	eax, eax
		jz	$err$67

loc_FFA:				; CODE XREF: _PKCS7_dataInit+2C0j
		push	dword ptr [edi+4]
		push	[esp+88h+var_74]
		call	_EVP_CIPHER_param_to_asn1
		add	esp, 8
		test	eax, eax
		js	$err$67

loc_1011:				; CODE XREF: _PKCS7_dataInit+2B6j
		mov	ebp, [esp+84h+var_64]
		xor	edi, edi
		push	ebp
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1057
		nop	dword ptr [eax+00h]

loc_1028:				; CODE XREF: _PKCS7_dataInit+32Dj
		push	edi
		push	ebp
		call	_sk_value
		push	[esp+8Ch+var_5C]
		lea	ecx, [esp+90h+var_44]
		push	ecx
		push	eax
		call	_pkcs7_encode_rinfo
		add	esp, 14h
		test	eax, eax
		jle	loc_1124
		push	ebp
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_1028

loc_1057:				; CODE XREF: _PKCS7_dataInit+2FAj
		push	[esp+84h+var_5C]
		lea	eax, [esp+88h+var_44]
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 8
		test	esi, esi
		jnz	short loc_1072
		mov	esi, [esp+84h+var_70]
		jmp	short loc_1080
; ---------------------------------------------------------------------------

loc_1072:				; CODE XREF: _PKCS7_dataInit+342j
		mov	eax, [esp+84h+var_70]
		push	eax
		push	esi
		call	_BIO_push
		add	esp, 8

loc_1080:				; CODE XREF: _PKCS7_dataInit+1B7j
					; _PKCS7_dataInit+348j
		xor	ebp, ebp
		test	ebx, ebx
		jnz	short loc_1101
		mov	edi, [esp+84h+var_58]
		push	dword ptr [edi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jnz	short loc_10BB
		push	ebx
		push	ebx
		push	2
		push	edi
		call	_PKCS7_ctrl
		add	esp, 10h
		test	eax, eax
		jz	short loc_10BB
		call	_BIO_s_null
		push	eax
		call	_BIO_new
		add	esp, 4
		jmp	short loc_10D5
; ---------------------------------------------------------------------------

loc_10BB:				; CODE XREF: _PKCS7_dataInit+370j
					; _PKCS7_dataInit+381j
		mov	ecx, [esp+84h+var_60]
		test	ecx, ecx
		jz	short loc_10DB
		mov	eax, [ecx]
		test	eax, eax
		jle	short loc_10DB
		push	eax
		push	dword ptr [ecx+8]
		call	_BIO_new_mem_buf
		add	esp, 8

loc_10D5:				; CODE XREF: _PKCS7_dataInit+391j
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_1101

loc_10DB:				; CODE XREF: _PKCS7_dataInit+399j
					; _PKCS7_dataInit+39Fj
		call	_BIO_s_mem
		push	eax
		call	_BIO_new
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short $err$67
		push	0
		push	0
		push	82h ; 'Ç'
		push	ebx
		call	_BIO_ctrl
		add	esp, 10h

loc_1101:				; CODE XREF: _PKCS7_dataInit+35Cj
					; _PKCS7_dataInit+3B1j
		test	esi, esi
		jz	short loc_1144
		push	ebx
		push	esi
		call	_BIO_push
		add	esp, 8
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+74h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_1124:				; CODE XREF: _PKCS7_dataInit+31Bj
		mov	ebp, [esp+84h+var_70]

$err$67:				; CODE XREF: _PKCS7_dataInit+1EDj
					; _PKCS7_dataInit+1F8j	...
		test	esi, esi
		jz	short loc_1135
		push	esi
		call	_BIO_free_all
		add	esp, 4

loc_1135:				; CODE XREF: _PKCS7_dataInit+402j
		test	ebp, ebp
		jz	short loc_1173
		push	ebp
		call	_BIO_free_all
		add	esp, 4
		jmp	short loc_1173
; ---------------------------------------------------------------------------

loc_1144:				; CODE XREF: _PKCS7_dataInit+3DBj
		mov	esi, ebx
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+74h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_115B:				; CODE XREF: _PKCS7_dataInit+C5j
		push	13Dh		; jumptable 00000DF3 default case
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	70h ; 'p'

loc_1167:				; CODE XREF: _PKCS7_dataInit+10Bj
					; _PKCS7_dataInit+13Bj
		push	69h ; 'i'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

loc_1173:				; CODE XREF: _PKCS7_dataInit+40Fj
					; _PKCS7_dataInit+41Aj
		mov	ecx, [esp+84h+var_4]
		xor	esi, esi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
_PKCS7_dataInit	endp

; ---------------------------------------------------------------------------
		align 10h
$LN66		dd offset $LN18		; DATA XREF: _PKCS7_dataInit+CBr
		dd offset $LN12		; jump table for switch	statement
		dd offset $LN15
		dd offset $LN13
		dd offset $LN17
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_dataVerify
_PKCS7_dataVerify proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		mov	esi, [esp+4+arg_C]
		test	esi, esi
		jnz	short loc_11CC
		push	3D3h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	8Fh ; 'è'
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_11CC:				; CODE XREF: _PKCS7_dataVerify+7j
		cmp	dword ptr [esi+14h], 0
		jnz	short loc_11EE
		push	3D8h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	7Ah ; 'z'
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_11EE:				; CODE XREF: _PKCS7_dataVerify+2Cj
		push	ebx
		push	ebp
		push	edi
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_1215
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 18h
		jnz	loc_12DF

loc_1215:				; CODE XREF: _PKCS7_dataVerify+5Bj
		mov	eax, [esi+14h]
		mov	ebp, [esp+10h+arg_10]
		mov	edi, [eax+8]
		mov	eax, [ebp+4]
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		push	edi
		call	_X509_find_by_issuer_and_serial
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_1255
		push	3ECh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Ah ; 'j'
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1255:				; CODE XREF: _PKCS7_dataVerify+90j
		push	edi
		mov	edi, [esp+14h+arg_4]
		push	ebx
		push	[esp+18h+arg_0]
		push	edi
		call	_X509_STORE_CTX_init
		add	esp, 10h
		test	eax, eax
		jnz	short loc_128B
		push	3F2h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	0Bh
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_128B:				; CODE XREF: _PKCS7_dataVerify+C6j
		push	4
		push	edi
		call	_X509_STORE_CTX_set_purpose
		push	edi
		call	_X509_verify_cert
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_12C5
		push	3F8h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	0Bh
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		push	edi
		call	_X509_STORE_CTX_cleanup
		add	esp, 18h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_12C5:				; CODE XREF: _PKCS7_dataVerify+FAj
		push	edi
		call	_X509_STORE_CTX_cleanup
		push	ebx
		push	ebp
		push	esi
		push	[esp+20h+arg_8]
		call	_PKCS7_signatureVerify
		add	esp, 14h
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_12DF:				; CODE XREF: _PKCS7_dataVerify+6Bj
		push	3E1h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	72h ; 'r'
		push	6Bh ; 'k'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

$err$18:
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
_PKCS7_dataVerify endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1300h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_digest_from_attributes
_PKCS7_digest_from_attributes proc near

arg_0		= dword	ptr  4

		push	33h ; '3'
		push	[esp+4+arg_0]
		call	_get_attribute
		add	esp, 8
		test	eax, eax
		jnz	short loc_1313
		retn
; ---------------------------------------------------------------------------

loc_1313:				; CODE XREF: _PKCS7_digest_from_attributes+10j
		mov	eax, [eax+4]
		retn
_PKCS7_digest_from_attributes endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1318h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_PKCS7_find_digest proc	near		; CODE XREF: _PKCS7_dataFinal+1CAp
					; _PKCS7_dataFinal+2FAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		push	208h
		push	[esp+10h+arg_4]
		call	_BIO_find_type
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_137B
		mov	ebx, [esp+0Ch+arg_8]
		mov	edi, [esp+0Ch+arg_0]

loc_133A:				; CODE XREF: _PKCS7_find_digest+61j
		push	edi
		push	0
		push	78h ; 'x'
		push	esi
		call	_BIO_ctrl
		mov	eax, [edi]
		add	esp, 10h
		test	eax, eax
		jz	short loc_139F
		push	eax
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_type
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_1399
		push	esi
		call	_BIO_next
		push	208h
		push	eax
		call	_BIO_find_type
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_133A

loc_137B:				; CODE XREF: _PKCS7_find_digest+18j
		push	2BBh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Ch ; 'l'
		push	7Fh ; ''
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1399:				; CODE XREF: _PKCS7_find_digest+47j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_139F:				; CODE XREF: _PKCS7_find_digest+34j
		push	2C0h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	44h ; 'D'
		push	7Fh ; ''
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		retn
_PKCS7_find_digest endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_get_attribute
_PKCS7_get_attribute proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		push	dword ptr [eax+18h]
		call	_get_attribute
		add	esp, 8
		retn
_PKCS7_get_attribute endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_get_issuer_and_serial
_PKCS7_get_issuer_and_serial proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 18h
		jz	short loc_13ED

loc_13E9:				; CODE XREF: _PKCS7_get_issuer_and_serial+1Ej
					; _PKCS7_get_issuer_and_serial+25j ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_13ED:				; CODE XREF: _PKCS7_get_issuer_and_serial+13j
		mov	esi, [esi+14h]
		test	esi, esi
		jz	short loc_13E9
		mov	esi, [esi+18h]
		test	esi, esi
		jz	short loc_13E9
		push	esi
		call	_sk_num
		mov	ecx, [esp+8+arg_4]
		add	esp, 4
		cmp	eax, ecx
		jle	short loc_13E9
		push	ecx
		push	esi
		call	_sk_value
		add	esp, 8
		mov	eax, [eax+4]
		pop	esi
		retn
_PKCS7_get_issuer_and_serial endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 141Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_PKCS7_get_octet_string	proc near	; CODE XREF: _PKCS7_dataDecode+193p
					; _PKCS7_dataFinal+149p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 15h
		jnz	short loc_1436
		mov	eax, [esi+14h]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1436:				; CODE XREF: _PKCS7_get_octet_string+13j
		push	dword ptr [esi+10h]
		call	_OBJ_obj2nid
		add	eax, 0FFFFFFEBh
		add	esp, 4
		cmp	eax, 5
		jbe	short loc_145A
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_145A
		cmp	dword ptr [eax], 4
		jnz	short loc_145A
		mov	eax, [eax+4]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_145A:				; CODE XREF: _PKCS7_get_octet_string+2Bj
					; _PKCS7_get_octet_string+32j ...
		xor	eax, eax
		pop	esi
		retn
_PKCS7_get_octet_string	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1460h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_get_signed_attribute
_PKCS7_get_signed_attribute proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		push	dword ptr [eax+0Ch]
		call	_get_attribute
		add	esp, 8
		retn
_PKCS7_get_signed_attribute endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1474h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_set_attributes
_PKCS7_set_attributes proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	edi
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_148F
		push	offset _X509_ATTRIBUTE_free
		push	eax
		call	_sk_pop_free
		add	esp, 8

loc_148F:				; CODE XREF: _PKCS7_set_attributes+Bj
		mov	edi, [esp+8+arg_4]
		push	edi
		call	_sk_dup
		add	esp, 4
		mov	[ebx+18h], eax
		test	eax, eax
		jnz	short loc_14A6
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_14A6:				; CODE XREF: _PKCS7_set_attributes+2Dj
		push	esi
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_14E2

loc_14B6:				; CODE XREF: _PKCS7_set_attributes+6Cj
		push	esi
		push	edi
		call	_sk_value
		push	eax
		call	_X509_ATTRIBUTE_dup
		push	eax
		push	esi
		push	dword ptr [ebx+18h]
		call	_sk_set
		add	esp, 18h
		test	eax, eax
		jz	short loc_14EB
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_14B6

loc_14E2:				; CODE XREF: _PKCS7_set_attributes+40j
		pop	esi
		pop	edi
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_14EB:				; CODE XREF: _PKCS7_set_attributes+5Ej
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
_PKCS7_set_attributes endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_set_signed_attributes
_PKCS7_set_signed_attributes proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	edi
		mov	eax, [ebx+0Ch]
		test	eax, eax
		jz	short loc_150F
		push	offset _X509_ATTRIBUTE_free
		push	eax
		call	_sk_pop_free
		add	esp, 8

loc_150F:				; CODE XREF: _PKCS7_set_signed_attributes+Bj
		mov	edi, [esp+8+arg_4]
		push	edi
		call	_sk_dup
		add	esp, 4
		mov	[ebx+0Ch], eax
		test	eax, eax
		jnz	short loc_1526
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1526:				; CODE XREF: _PKCS7_set_signed_attributes+2Dj
		push	esi
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1562

loc_1536:				; CODE XREF: _PKCS7_set_signed_attributes+6Cj
		push	esi
		push	edi
		call	_sk_value
		push	eax
		call	_X509_ATTRIBUTE_dup
		push	eax
		push	esi
		push	dword ptr [ebx+0Ch]
		call	_sk_set
		add	esp, 18h
		test	eax, eax
		jz	short loc_156B
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_1536

loc_1562:				; CODE XREF: _PKCS7_set_signed_attributes+40j
		pop	esi
		pop	edi
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_156B:				; CODE XREF: _PKCS7_set_signed_attributes+5Ej
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
_PKCS7_set_signed_attributes endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1574h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _PKCS7_signatureVerify
_PKCS7_signatureVerify proc near	; CODE XREF: _PKCS7_dataVerify+12Ep

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 70h ; 'p'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_C]
		push	ebx
		mov	ebx, [esp+74h+arg_4]
		push	ebp
		mov	ebp, [esp+78h+arg_8]
		push	esi
		mov	esi, [esp+7Ch+arg_0]
		mov	[esp+7Ch+var_60], eax
		lea	eax, [esp+7Ch+var_5C]
		push	edi
		push	eax
		mov	[esp+84h+var_64], ebp
		xor	edi, edi
		call	_EVP_MD_CTX_init
		push	dword ptr [ebx+10h]
		call	_OBJ_obj2nid
		add	esp, 8
		cmp	eax, 16h
		jz	short loc_15EB
		push	dword ptr [ebx+10h]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 18h
		jz	short loc_15EB
		push	411h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	72h ; 'r'
		jmp	loc_167A
; ---------------------------------------------------------------------------

loc_15EB:				; CODE XREF: _PKCS7_signatureVerify+54j
					; _PKCS7_signatureVerify+64j
		mov	eax, [ebp+8]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		add	esp, 4
		mov	ebx, eax
		test	esi, esi
		jz	short loc_166E
		nop	word ptr [eax+eax+00h]

loc_1604:				; CODE XREF: _PKCS7_signatureVerify+F8j
		push	208h
		push	esi
		call	_BIO_find_type
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_166E
		lea	eax, [esp+80h+var_70]
		push	eax
		push	0
		push	78h ; 'x'
		push	esi
		call	_BIO_ctrl
		mov	eax, [esp+90h+var_70]
		add	esp, 10h
		test	eax, eax
		jz	loc_1898
		push	eax
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_type
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_16AB
		push	[esp+80h+var_70]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_pkey_type
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_16AB
		push	esi
		call	_BIO_next
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1604

loc_166E:				; CODE XREF: _PKCS7_signatureVerify+88j
					; _PKCS7_signatureVerify+A2j
		push	41Ch

loc_1673:				; CODE XREF: _PKCS7_signatureVerify+315j
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6Ch ; 'l'

loc_167A:				; CODE XREF: _PKCS7_signatureVerify+72j
					; _PKCS7_signatureVerify+330j
		push	71h ; 'q'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

$err$44:				; CODE XREF: _PKCS7_signatureVerify+14Aj
					; _PKCS7_signatureVerify+185j ...
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+84h+var_4]
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_16AB:				; CODE XREF: _PKCS7_signatureVerify+D3j
					; _PKCS7_signatureVerify+E9j
		push	[esp+80h+var_70]
		lea	eax, [esp+84h+var_5C]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	short $err$44
		mov	ebp, [ebp+0Ch]
		test	ebp, ebp
		jz	loc_180C
		push	ebp
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jz	loc_180C
		lea	eax, [esp+80h+var_68]
		mov	[esp+80h+var_6C], edi
		push	eax
		lea	eax, [esp+84h+var_44]
		push	eax
		lea	eax, [esp+88h+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$44
		push	33h ; '3'
		push	ebp
		call	_get_attribute
		add	esp, 8
		test	eax, eax
		jz	loc_1884
		mov	edx, [eax+4]
		test	edx, edx
		jz	loc_1884
		mov	ecx, [esp+80h+var_68]
		cmp	[edx], ecx
		jnz	loc_1864
		mov	edx, [edx+8]
		lea	esi, [esp+80h+var_44]
		sub	ecx, 4
		jb	short loc_1745
		nop	dword ptr [eax]

loc_1734:				; CODE XREF: _PKCS7_signatureVerify+1CFj
		mov	eax, [edx]
		cmp	eax, [esi]
		jnz	short loc_174A
		add	edx, 4
		add	esi, 4
		sub	ecx, 4
		jnb	short loc_1734

loc_1745:				; CODE XREF: _PKCS7_signatureVerify+1BBj
		cmp	ecx, 0FFFFFFFCh
		jz	short loc_1787

loc_174A:				; CODE XREF: _PKCS7_signatureVerify+1C4j
		mov	al, [edx]
		cmp	al, [esi]
		jnz	loc_1864
		cmp	ecx, 0FFFFFFFDh
		jz	short loc_1787
		mov	al, [edx+1]
		cmp	al, [esi+1]
		jnz	loc_1864
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_1787
		mov	al, [edx+2]
		cmp	al, [esi+2]
		jnz	loc_1864
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1787
		mov	al, [edx+3]
		cmp	al, [esi+3]
		jnz	loc_1864

loc_1787:				; CODE XREF: _PKCS7_signatureVerify+1D4j
					; _PKCS7_signatureVerify+1E3j ...
		push	0
		push	ebx
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		add	esp, 8
		push	eax
		lea	eax, [esp+88h+var_5C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44
		call	_PKCS7_ATTR_VERIFY_it
		push	eax
		lea	eax, [esp+84h+var_6C]
		push	eax
		push	ebp
		call	_ASN1_item_i2d
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_17E6
		push	45Dh
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	0Dh
		push	71h ; 'q'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		or	edi, 0FFFFFFFFh
		jmp	$err$44
; ---------------------------------------------------------------------------

loc_17E6:				; CODE XREF: _PKCS7_signatureVerify+250j
		push	eax
		push	[esp+84h+var_6C]
		lea	eax, [esp+88h+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44
		push	[esp+80h+var_6C]
		call	_CRYPTO_free
		add	esp, 4

loc_180C:				; CODE XREF: _PKCS7_signatureVerify+151j
					; _PKCS7_signatureVerify+162j
		mov	esi, [esp+80h+var_64]
		push	[esp+80h+var_60]
		mov	esi, [esi+14h]
		call	_X509_get_pubkey
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_187C
		push	edi
		push	dword ptr [esi]
		lea	eax, [esp+88h+var_5C]
		push	dword ptr [esi+8]
		push	eax
		call	_EVP_VerifyFinal
		push	edi
		mov	esi, eax
		call	_EVP_PKEY_free
		add	esp, 14h
		test	esi, esi
		jg	short loc_188E
		push	471h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	69h ; 'i'
		push	71h ; 'q'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		or	edi, 0FFFFFFFFh
		jmp	$err$44
; ---------------------------------------------------------------------------

loc_1864:				; CODE XREF: _PKCS7_signatureVerify+1ABj
					; _PKCS7_signatureVerify+1DAj ...
		push	452h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	65h ; 'e'
		push	71h ; 'q'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

loc_187C:				; CODE XREF: _PKCS7_signatureVerify+2AFj
		or	edi, 0FFFFFFFFh
		jmp	$err$44
; ---------------------------------------------------------------------------

loc_1884:				; CODE XREF: _PKCS7_signatureVerify+194j
					; _PKCS7_signatureVerify+19Fj
		push	442h
		jmp	loc_1673
; ---------------------------------------------------------------------------

loc_188E:				; CODE XREF: _PKCS7_signatureVerify+2CEj
		mov	edi, 1
		jmp	$err$44
; ---------------------------------------------------------------------------

loc_1898:				; CODE XREF: _PKCS7_signatureVerify+BCj
		push	421h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	44h ; 'D'
		jmp	loc_167A
_PKCS7_signatureVerify endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_PKCS7_type_is_other proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax+10h]
		call	_OBJ_obj2nid
		add	eax, 0FFFFFFEBh
		mov	ecx, 5
		add	esp, 4
		cmp	ecx, eax
		sbb	eax, eax
		neg	eax
		retn
_PKCS7_type_is_other endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_add_attribute	proc near		; CODE XREF: _PKCS7_add_attribute+5j
					; _PKCS7_add_signed_attribute+5j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_18F0
		call	_sk_new_null
		mov	[edi], eax
		test	eax, eax
		jnz	short $new_attrib$21

loc_18E9:				; CODE XREF: _add_attribute+6Fj
					; _add_attribute+ABj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_18F0:				; CODE XREF: _add_attribute+10j
		push	eax
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short $new_attrib$21

loc_18FF:				; CODE XREF: _add_attribute+58j
		push	esi
		push	dword ptr [edi]
		call	_sk_value
		mov	ebx, eax
		push	dword ptr [ebx]
		call	_OBJ_obj2nid
		add	esp, 0Ch
		cmp	eax, ebp
		jz	short loc_195C
		push	dword ptr [edi]
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_18FF

$new_attrib$21:				; CODE XREF: _add_attribute+1Bj
					; _add_attribute+31j
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_8]
		push	ebp
		call	_X509_ATTRIBUTE_create
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_18E9
		push	esi
		push	dword ptr [edi]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jnz	short $end$22
		push	esi
		call	_X509_ATTRIBUTE_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_195C:				; CODE XREF: _add_attribute+49j
		push	ebx
		call	_X509_ATTRIBUTE_free
		push	[esp+14h+arg_C]
		push	[esp+18h+arg_8]
		push	ebp
		call	_X509_ATTRIBUTE_create
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jz	loc_18E9
		push	ebx
		push	esi
		push	dword ptr [edi]
		call	_sk_set
		add	esp, 0Ch
		test	eax, eax
		jnz	short $end$22
		push	ebx
		call	_X509_ATTRIBUTE_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$end$22:				; CODE XREF: _add_attribute+7Ej
					; _add_attribute+BFj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_add_attribute	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 19A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_do_pkcs7_signed_attrib	proc near	; CODE XREF: _PKCS7_dataFinal+208p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	esi
		mov	esi, [esp+4Ch+arg_0]
		push	edi
		mov	edi, [esp+50h+arg_4]
		push	34h ; '4'
		push	dword ptr [esi+0Ch]
		call	_get_attribute
		add	esp, 8
		test	eax, eax
		jnz	short loc_1A14
		push	eax
		push	esi
		call	_PKCS7_add0_attrib_signing_time
		add	esp, 8
		test	eax, eax
		jnz	short loc_1A14
		push	2D2h

loc_19EB:				; CODE XREF: _do_pkcs7_signed_attrib+ACj
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	41h ; 'A'

loc_19F2:				; CODE XREF: _do_pkcs7_signed_attrib+8Fj
		push	88h ; 'à'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1A14:				; CODE XREF: _do_pkcs7_signed_attrib+2Ej
					; _do_pkcs7_signed_attrib+3Cj
		lea	eax, [esp+50h+var_48]
		push	eax
		lea	eax, [esp+54h+var_44]
		push	eax
		push	edi
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1A39
		push	2D9h
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6
		jmp	short loc_19F2
; ---------------------------------------------------------------------------

loc_1A39:				; CODE XREF: _do_pkcs7_signed_attrib+81j
		push	[esp+50h+var_48]
		lea	eax, [esp+54h+var_44]
		push	eax
		push	esi
		call	_PKCS7_add1_attrib_digest
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1A56
		push	2DDh
		jmp	short loc_19EB
; ---------------------------------------------------------------------------

loc_1A56:				; CODE XREF: _do_pkcs7_signed_attrib+A5j
		push	esi
		call	_PKCS7_SIGNER_INFO_sign
		mov	ecx, [esp+54h+var_4]
		add	esp, 4
		neg	eax
		sbb	eax, eax
		pop	edi
		pop	esi
		xor	ecx, esp
		neg	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_do_pkcs7_signed_attrib	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_attribute	proc near		; CODE XREF: _PKCS7_digest_from_attributes+6p
					; _PKCS7_get_attribute+Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	[esp+8+arg_4]
		call	_OBJ_nid2obj
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_1AFC
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	short loc_1AFC
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1ACE
		nop	dword ptr [eax]

loc_1AA8:				; CODE XREF: _get_attribute+54j
		push	esi
		push	edi
		call	_sk_value
		mov	ebx, eax
		push	ebp
		push	dword ptr [ebx]
		call	_OBJ_cmp
		add	esp, 10h
		test	eax, eax
		jz	short loc_1AD5
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_1AA8

loc_1ACE:				; CODE XREF: _get_attribute+2Bj
					; _get_attribute+61j ...
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1AD5:				; CODE XREF: _get_attribute+46j
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_1ACE
		push	dword ptr [ebx+8]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jz	short loc_1ACE
		push	0
		push	dword ptr [ebx+8]
		call	_sk_value
		add	esp, 8
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1AFC:				; CODE XREF: _get_attribute+12j
					; _get_attribute+1Aj
		pop	edi
		xor	eax, eax
		pop	ebp
		retn
_get_attribute	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B04h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkcs7_cmp_ri	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	eax, [edi]
		push	dword ptr [eax+0Ch]
		mov	eax, [esi+4]
		push	dword ptr [eax]
		call	_X509_NAME_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_1B37
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		mov	eax, [edi]
		push	dword ptr [eax+4]
		call	_ASN1_STRING_cmp
		add	esp, 8

loc_1B37:				; CODE XREF: _pkcs7_cmp_ri+1Ej
		pop	edi
		pop	esi
		retn
_pkcs7_cmp_ri	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B3Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkcs7_decrypt_rinfo proc near		; CODE XREF: _PKCS7_dataDecode+3C4p
					; _PKCS7_dataDecode+40Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		or	ebx, 0FFFFFFFFh
		push	esi
		push	[esp+14h+arg_C]
		call	_EVP_PKEY_CTX_new
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1B68
		pop	edi
		pop	esi
		or	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1B68:				; CODE XREF: _pkcs7_decrypt_rinfo+23j
		push	edi
		call	_EVP_PKEY_decrypt_init
		add	esp, 4
		test	eax, eax
		jle	$err$14
		push	ebp
		mov	ebp, [esp+14h+arg_8]
		push	ebp
		push	0
		push	4
		push	200h
		push	0FFFFFFFFh
		push	edi
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_1BBA
		push	0D3h ; '”'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	98h ; 'ò'
		push	85h ; 'Ö'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_1C81
; ---------------------------------------------------------------------------

loc_1BBA:				; CODE XREF: _pkcs7_decrypt_rinfo+59j
		mov	eax, [ebp+0Ch]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+1Ch+var_4]
		push	eax
		push	0
		push	edi
		call	_EVP_PKEY_decrypt
		add	esp, 14h
		test	eax, eax
		jle	loc_1C81
		push	0DBh ; '€'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	[esp+1Ch+var_4]
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1C13
		push	0DEh ; 'ﬁ'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	41h ; 'A'
		push	85h ; 'Ö'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_1C81
; ---------------------------------------------------------------------------

loc_1C13:				; CODE XREF: _pkcs7_decrypt_rinfo+B8j
		mov	eax, [ebp+0Ch]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+1Ch+var_4]
		push	eax
		push	esi
		push	edi
		call	_EVP_PKEY_decrypt
		add	esp, 14h
		test	eax, eax
		jg	short loc_1C4D
		push	0E5h ; 'Â'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	6
		push	85h ; 'Ö'
		push	21h ; '!'
		xor	ebx, ebx
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_1C81
; ---------------------------------------------------------------------------

loc_1C4D:				; CODE XREF: _pkcs7_decrypt_rinfo+F0j
		mov	ebp, [esp+14h+arg_0]
		mov	ebx, 1
		mov	eax, [ebp+0]
		test	eax, eax
		jz	short loc_1C74
		mov	ecx, [esp+14h+arg_4]
		push	dword ptr [ecx]
		push	eax
		call	_OPENSSL_cleanse
		push	dword ptr [ebp+0]
		call	_CRYPTO_free
		add	esp, 0Ch

loc_1C74:				; CODE XREF: _pkcs7_decrypt_rinfo+11Fj
		mov	ecx, [esp+14h+arg_4]
		mov	eax, [esp+14h+var_4]
		mov	[ebp+0], esi
		mov	[ecx], eax

loc_1C81:				; CODE XREF: _pkcs7_decrypt_rinfo+79j
					; _pkcs7_decrypt_rinfo+98j ...
		pop	ebp

$err$14:				; CODE XREF: _pkcs7_decrypt_rinfo+37j
		push	edi
		call	_EVP_PKEY_CTX_free
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1C9C
		test	esi, esi
		jz	short loc_1C9C
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_1C9C:				; CODE XREF: _pkcs7_decrypt_rinfo+151j
					; _pkcs7_decrypt_rinfo+155j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
_pkcs7_decrypt_rinfo endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1CA4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkcs7_encode_rinfo proc near		; CODE XREF: _PKCS7_dataInit+311p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		xor	esi, esi
		push	dword ptr [ebp+10h]
		call	_X509_get_pubkey
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1CC2
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1CC2:				; CODE XREF: _pkcs7_encode_rinfo+18j
		push	edi
		push	0
		push	ebx
		call	_EVP_PKEY_CTX_new
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1CD9
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1CD9:				; CODE XREF: _pkcs7_encode_rinfo+2Ej
		push	edi
		call	_EVP_PKEY_encrypt_init
		add	esp, 4
		test	eax, eax
		jle	short loc_1D1D
		push	ebp
		push	0
		push	3
		push	100h
		push	0FFFFFFFFh
		push	edi
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_1D42
		push	0A0h ; '†'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	98h ; 'ò'

loc_1D0E:				; CODE XREF: _pkcs7_encode_rinfo+E2j
		push	84h ; 'Ñ'
		push	21h ; '!'
		call	_ERR_put_error
		add	esp, 14h

loc_1D1D:				; CODE XREF: _pkcs7_encode_rinfo+40j
					; _pkcs7_encode_rinfo+B8j ...
		xor	ebp, ebp

$err$20:				; CODE XREF: _pkcs7_encode_rinfo+118j
		push	ebx
		call	_EVP_PKEY_free
		push	edi
		call	_EVP_PKEY_CTX_free
		add	esp, 8
		test	esi, esi
		jz	short loc_1D3B
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_1D3B:				; CODE XREF: _pkcs7_encode_rinfo+8Cj
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1D42:				; CODE XREF: _pkcs7_encode_rinfo+59j
		push	[esp+10h+arg_8]
		lea	eax, [esp+14h+arg_0]
		push	[esp+14h+arg_4]
		push	eax
		push	0
		push	edi
		call	_EVP_PKEY_encrypt
		add	esp, 14h
		test	eax, eax
		jle	short loc_1D1D
		push	0A7h ; 'ß'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	[esp+18h+arg_0]
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1D88
		push	0AAh ; '™'
		push	offset ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ ;	".\\crypto\\pkcs7\\pk7_doit.c"
		push	41h ; 'A'
		jmp	short loc_1D0E
; ---------------------------------------------------------------------------

loc_1D88:				; CODE XREF: _pkcs7_encode_rinfo+D4j
		push	[esp+10h+arg_8]
		lea	eax, [esp+14h+arg_0]
		push	[esp+14h+arg_4]
		push	eax
		push	esi
		push	edi
		call	_EVP_PKEY_encrypt
		add	esp, 14h
		test	eax, eax
		jle	loc_1D1D
		push	[esp+10h+arg_0]
		push	esi
		push	dword ptr [ebp+0Ch]
		call	_ASN1_STRING_set0
		add	esp, 0Ch
		xor	esi, esi
		lea	ebp, [esi+1]
		jmp	$err$20
_pkcs7_encode_rinfo endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1DC4h
; COMDAT (pick any)
		public ??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@
; `string'
??_C@_0BK@LMEFMLFD@?4?2crypto?2pkcs7?2pk7_doit?4c?$AA@ db '.\crypto\pkcs7\pk7_doit.c',0
					; DATA XREF: _PKCS7_SIGNER_INFO_sign:loc_7Bo
					; _PKCS7_SIGNER_INFO_sign+119o	...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _sk_num:near	; CODE XREF: _PKCS7_dataDecode+21Dp
					; _PKCS7_dataDecode+29Bp ...
		extrn _sk_value:near	; CODE XREF: _PKCS7_dataDecode+235p
					; _PKCS7_dataDecode+343p ...
		extrn _sk_set:near	; CODE XREF: _PKCS7_set_attributes+54p
					; _PKCS7_set_signed_attributes+54p ...
		extrn _sk_new_null:near	; CODE XREF: _add_attribute+12p
		extrn _sk_pop_free:near	; CODE XREF: _PKCS7_set_attributes+13p
					; _PKCS7_set_signed_attributes+13p
		extrn _sk_push:near	; CODE XREF: _add_attribute+74p
		extrn _sk_dup:near	; CODE XREF: _PKCS7_set_attributes+20p
					; _PKCS7_set_signed_attributes+20p
		extrn _CRYPTO_malloc:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+122p
					; _PKCS7_dataDecode+4B9p ...
		extrn _CRYPTO_free:near	; CODE XREF: _PKCS7_SIGNER_INFO_sign+9Dp
					; _PKCS7_SIGNER_INFO_sign+EFp ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _PKCS7_dataDecode+51Dp
					; _PKCS7_dataDecode+567p ...
		extrn _BIO_set_flags:near ; CODE XREF: _PKCS7_dataFinal+3ACp
		extrn _BIO_new:near	; CODE XREF: _PKCS7_bio_add_digest+7p
					; _PKCS7_dataDecode+244p ...
		extrn _BIO_free:near	; CODE XREF: _PKCS7_bio_add_digest+9Cp
		extrn _BIO_ctrl:near	; CODE XREF: _PKCS7_bio_add_digest+5Dp
					; _PKCS7_dataDecode+27Ap ...
		extrn _BIO_push:near	; CODE XREF: _PKCS7_bio_add_digest+7Ap
					; _PKCS7_dataDecode+28Cp ...
		extrn _BIO_free_all:near ; CODE	XREF: _PKCS7_dataDecode+65Dp
					; _PKCS7_dataDecode+66Ap ...
		extrn _BIO_find_type:near ; CODE XREF: _PKCS7_dataFinal+379p
					; _PKCS7_find_digest+Cp ...
		extrn _BIO_next:near	; CODE XREF: _PKCS7_find_digest+4Ap
					; _PKCS7_signatureVerify+ECp
		extrn _BIO_s_mem:near	; CODE XREF: _PKCS7_dataDecode:loc_839p
					; _PKCS7_dataInit:loc_10DBp
		extrn _BIO_new_mem_buf:near ; CODE XREF: _PKCS7_dataDecode+5CFp
					; _PKCS7_dataInit+3A5p
		extrn _BIO_s_null:near	; CODE XREF: _PKCS7_dataInit+383p
		extrn _ERR_put_error:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+8Cp
					; _PKCS7_bio_add_digest+22p ...
		extrn _ERR_clear_error:near ; CODE XREF: _PKCS7_dataDecode+3D0p
					; _PKCS7_dataDecode+419p ...
		extrn _RAND_pseudo_bytes:near ;	CODE XREF: _PKCS7_dataInit+246p
		extrn _ASN1_TYPE_new:near ; CODE XREF: _PKCS7_dataInit+2C2p
		extrn _ASN1_STRING_free:near ; CODE XREF: _PKCS7_dataFinal+16Dp
					; _PKCS7_dataFinal+2C8p
		extrn _ASN1_STRING_type_new:near ; CODE	XREF: _PKCS7_dataFinal+CFp
					; _PKCS7_dataFinal+10Fp
		extrn _ASN1_STRING_cmp:near ; CODE XREF: _PKCS7_dataDecode+37Bp
					; _pkcs7_cmp_ri+2Bp
		extrn _ASN1_STRING_set:near ; CODE XREF: _PKCS7_dataFinal+337p
		extrn _ASN1_STRING_set0:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+189p
					; _PKCS7_dataFinal+26Ap ...
		extrn _ASN1_item_i2d:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+C8p
					; _PKCS7_signatureVerify+246p
		extrn _OBJ_nid2obj:near	; CODE XREF: _PKCS7_dataInit+22Ap
					; _get_attribute+6p
		extrn _OBJ_nid2sn:near	; CODE XREF: _PKCS7_SIGNER_INFO_sign+23p
					; _PKCS7_bio_add_digest+3Ap ...
		extrn _OBJ_obj2nid:near	; CODE XREF: _PKCS7_SIGNER_INFO_sign+1Dp
					; _PKCS7_bio_add_digest+34p ...
		extrn _OBJ_cmp:near	; CODE XREF: _get_attribute+3Cp
		extrn _EVP_MD_type:near	; CODE XREF: _PKCS7_find_digest+3Dp
					; _PKCS7_signatureVerify+C9p
		extrn _EVP_MD_pkey_type:near ; CODE XREF: _PKCS7_signatureVerify+DFp
		extrn _EVP_MD_CTX_md:near ; CODE XREF: _PKCS7_find_digest+37p
					; _PKCS7_signatureVerify+C3p ...
		extrn _EVP_CIPHER_key_length:near ; CODE XREF: _PKCS7_dataInit+210p
		extrn _EVP_CIPHER_iv_length:near ; CODE	XREF: _PKCS7_dataInit+21Ap
		extrn _EVP_CIPHER_CTX_key_length:near ;	CODE XREF: _PKCS7_dataDecode+4A5p
					; _PKCS7_dataDecode+4FEp
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+3Cp
					; _PKCS7_dataFinal+81p	...
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+AAp
					; _PKCS7_SIGNER_INFO_sign+179p	...
		extrn _EVP_MD_CTX_copy_ex:near ; CODE XREF: _PKCS7_dataFinal+1E3p
					; _PKCS7_signatureVerify+140p
		extrn _EVP_DigestInit_ex:near ;	CODE XREF: _PKCS7_signatureVerify+22Ap
		extrn _EVP_DigestUpdate:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+DFp
					; _PKCS7_signatureVerify+27Cp
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _PKCS7_dataFinal+318p
					; _PKCS7_signatureVerify+17Bp ...
		extrn _EVP_CipherInit_ex:near ;	CODE XREF: _PKCS7_dataDecode+476p
					; _PKCS7_dataDecode+551p ...
		extrn _EVP_SignFinal:near ; CODE XREF: _PKCS7_dataFinal+253p
		extrn _EVP_VerifyFinal:near ; CODE XREF: _PKCS7_signatureVerify+2BCp
		extrn _EVP_DigestSignInit:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign+51p
		extrn _EVP_DigestSignFinal:near	; CODE XREF: _PKCS7_SIGNER_INFO_sign+108p
					; _PKCS7_SIGNER_INFO_sign+141p
		extrn _EVP_CIPHER_CTX_set_key_length:near
					; CODE XREF: _PKCS7_dataDecode+50Fp
		extrn _EVP_CIPHER_CTX_rand_key:near ; CODE XREF: _PKCS7_dataDecode+4D2p
					; _PKCS7_dataInit+27Cp
		extrn _BIO_f_md:near	; CODE XREF: _PKCS7_bio_add_digest+1p
					; _PKCS7_dataDecode+23Ep
		extrn _BIO_f_cipher:near ; CODE	XREF: _PKCS7_dataDecode+2B1p
					; _PKCS7_dataInit+1BDp
		extrn _EVP_get_cipherbyname:near ; CODE	XREF: _PKCS7_dataDecode+113p
					; _PKCS7_dataDecode+176p
		extrn _EVP_get_digestbyname:near ; CODE	XREF: _PKCS7_SIGNER_INFO_sign+29p
					; _PKCS7_bio_add_digest+40p ...
		extrn _EVP_PKEY_size:near ; CODE XREF: _PKCS7_dataFinal+21Dp
		extrn _EVP_PKEY_free:near ; CODE XREF: _PKCS7_signatureVerify+2C4p
					; _pkcs7_encode_rinfo+7Cp
		extrn _EVP_CIPHER_type:near ; CODE XREF: _PKCS7_dataInit+224p
		extrn _EVP_CIPHER_param_to_asn1:near ; CODE XREF: _PKCS7_dataInit+2D9p
		extrn _EVP_CIPHER_asn1_to_param:near ; CODE XREF: _PKCS7_dataDecode+491p
		extrn _EVP_PKEY_CTX_new:near ; CODE XREF: _pkcs7_decrypt_rinfo+17p
					; _pkcs7_encode_rinfo+22p
		extrn _EVP_PKEY_CTX_free:near ;	CODE XREF: _pkcs7_decrypt_rinfo+147p
					; _pkcs7_encode_rinfo+82p
		extrn _EVP_PKEY_CTX_ctrl:near ;	CODE XREF: _PKCS7_SIGNER_INFO_sign+6Ap
					; _PKCS7_SIGNER_INFO_sign+15Ep	...
		extrn _EVP_PKEY_encrypt_init:near ; CODE XREF: _pkcs7_encode_rinfo+36p
		extrn _EVP_PKEY_encrypt:near ; CODE XREF: _pkcs7_encode_rinfo+AEp
					; _pkcs7_encode_rinfo+F3p
		extrn _EVP_PKEY_decrypt_init:near ; CODE XREF: _pkcs7_decrypt_rinfo+2Dp
		extrn _EVP_PKEY_decrypt:near ; CODE XREF: _pkcs7_decrypt_rinfo+8Ep
					; _pkcs7_decrypt_rinfo+E6p
		extrn _X509_STORE_CTX_init:near	; CODE XREF: _PKCS7_dataVerify+BCp
		extrn _X509_STORE_CTX_cleanup:near ; CODE XREF:	_PKCS7_dataVerify+112p
					; _PKCS7_dataVerify+122p
		extrn _X509_STORE_CTX_set_purpose:near ; CODE XREF: _PKCS7_dataVerify+EAp
		extrn _PKCS7_ATTR_SIGN_it:near ; CODE XREF: _PKCS7_SIGNER_INFO_sign:loc_BAp
		extrn _PKCS7_ATTR_VERIFY_it:near ; CODE	XREF: _PKCS7_signatureVerify+23Ap
		extrn _PKCS7_ctrl:near	; CODE XREF: _PKCS7_dataDecode+1B3p
					; _PKCS7_dataFinal+356p ...
		extrn _PKCS7_add0_attrib_signing_time:near
					; CODE XREF: _do_pkcs7_signed_attrib+32p
		extrn _PKCS7_add1_attrib_digest:near
					; CODE XREF: _do_pkcs7_signed_attrib+9Bp
		extrn _X509_ATTRIBUTE_dup:near ; CODE XREF: _PKCS7_set_attributes+4Ap
					; _PKCS7_set_signed_attributes+4Ap
		extrn _X509_ATTRIBUTE_free:near	; CODE XREF: _add_attribute+81p
					; _add_attribute+91p ...
		extrn _X509_ATTRIBUTE_create:near ; CODE XREF: _add_attribute+63p
					; _add_attribute+9Fp
		extrn _X509_get_pubkey:near ; CODE XREF: _PKCS7_signatureVerify+2A3p
					; _pkcs7_encode_rinfo+Cp
		extrn _X509_NAME_cmp:near ; CODE XREF: _PKCS7_dataDecode+35Cp
					; _pkcs7_cmp_ri+14p
		extrn _X509_verify_cert:near ; CODE XREF: _PKCS7_dataVerify+F0p
		extrn _X509_find_by_issuer_and_serial:near
					; CODE XREF: _PKCS7_dataVerify+84p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _PKCS7_dataFinal+5Dp
					; _PKCS7_dataFinal+411p ...
		extrn __chkstk:near	; CODE XREF: _PKCS7_SIGNER_INFO_sign+5p
					; _PKCS7_dataDecode+5p	...
		extrn ___security_cookie:near ;	DATA XREF: _PKCS7_dataFinal+Ar
					; _PKCS7_dataInit+Ar ...


		end
