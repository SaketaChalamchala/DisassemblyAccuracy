;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	63F59EEE6F712805DA484FDA36CFCE04
; Input	CRC32 :	44025BCC

; File Name   :	C:\compspace\Diff\openssl\obj\e_cswift.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
; COMDAT (pick any)
		public ??_C@_0BH@LPOCDBDP@CryptoSwift?5RSA?5method?$AA@
; `string'
??_C@_0BH@LPOCDBDP@CryptoSwift?5RSA?5method?$AA@ db 'CryptoSwift RSA method',0
					; DATA XREF: .data:_cswift_rsao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 18h
_cswift_dsa	dd offset ??_C@_0BH@PJKBDPLH@CryptoSwift?5DSA?5method?$AA@
					; DATA XREF: _bind_helper+49o
					; "CryptoSwift DSA method"
		dd offset _cswift_dsa_sign
		dd 0
		dd offset _cswift_dsa_verify
		dd 8 dup(0)
_cswift_dh	dd offset ??_C@_0BG@IJAAONL@CryptoSwift?5DH?5method?$AA@
					; DATA XREF: _bind_helper+5Fo
					; "CryptoSwift DH method"
dword_4C	dd 0			; DATA XREF: _bind_helper+11Dw
dword_50	dd 0			; DATA XREF: _bind_helper+126w
		dd offset _cswift_mod_exp_dh
		dd 3 dup(0)
dword_64	dd 2 dup(0)		; DATA XREF: .data:_CSWIFT_str_reasonso
					; .data:000000F8o ...
_cswift_random	dd 0			; DATA XREF: .data:00000130o
					; _bind_helper+75o
		dd offset _cswift_rand_bytes
		dd 2 dup(0)
		dd offset _cswift_rand_bytes
		dd offset _cswift_rand_status
_engine_cswift_id dd offset ??_C@_06FPKOIGKA@cswift?$AA@ ; DATA	XREF: _bind_engine+75r
					; _bind_fn+8r ...
					; "cswift"
_engine_cswift_name dd offset ??_C@_0CE@EJAJAMFB@CryptoSwift?5hardware?5engine?5supp@
					; DATA XREF: _bind_helper+1Cr
					; "CryptoSwift hardware	engine support"
_CSWIFT_F1	dd offset ??_C@_0BE@GKOHOBNG@swAcquireAccContext?$AA@
					; DATA XREF: _cswift_init:loc_1532r
					; "swAcquireAccContext"
_CSWIFT_F2	dd offset ??_C@_0BB@CMEOOCMH@swAttachKeyParam?$AA@
					; DATA XREF: _cswift_init+97r
					; "swAttachKeyParam"
_CSWIFT_F3	dd offset ??_C@_0BA@BBJGAMOP@swSimpleRequest?$AA@
					; DATA XREF: _cswift_init+B5r
					; "swSimpleRequest"
_CSWIFT_F4	dd offset ??_C@_0BE@EMDGPDJP@swReleaseAccContext?$AA@
					; DATA XREF: _cswift_init+CFr
					; "swReleaseAccContext"
_CSWIFT_error_init dd 1			; DATA XREF: _ERR_load_CSWIFT_strings:loc_F0Br
					; _ERR_load_CSWIFT_strings+22w	...
_CSWIFT_str_functs dd 64000h		; DATA XREF: _ERR_load_CSWIFT_strings+1Co
					; _ERR_unload_CSWIFT_strings+9o ...
		dd offset ??_C@_0M@KGAKDDIP@CSWIFT_CTRL?$AA@ ; "CSWIFT_CTRL"
		dd 65000h
		dd offset ??_C@_0BA@GJBNNKCH@CSWIFT_DSA_SIGN?$AA@ ; "CSWIFT_DSA_SIGN"
		dd 66000h
		dd offset ??_C@_0BC@LDIADIEK@CSWIFT_DSA_VERIFY?$AA@ ; "CSWIFT_DSA_VERIFY"
		dd 67000h
		dd offset ??_C@_0O@CKCPKCCP@CSWIFT_FINISH?$AA@ ; "CSWIFT_FINISH"
		dd 68000h
		dd offset ??_C@_0M@EBHGEIBN@CSWIFT_INIT?$AA@ ; "CSWIFT_INIT"
dword_C8	dd 69000h		; DATA XREF: .rdata:_cswift_cmd_defnso
		dd offset ??_C@_0P@IJFIMLE@CSWIFT_MOD_EXP?$AA@ ; "CSWIFT_MOD_EXP"
		dd 6A000h
		dd offset ??_C@_0BD@PKNPAAAD@CSWIFT_MOD_EXP_CRT?$AA@ ; "CSWIFT_MOD_EXP_CRT"
		dd 6C000h
		dd offset ??_C@_0BC@INGHBIFA@CSWIFT_RAND_BYTES?$AA@ ; "CSWIFT_RAND_BYTES"
		dd 6B000h
		dd offset ??_C@_0BD@GDNNAJLA@CSWIFT_RSA_MOD_EXP?$AA@ ; "CSWIFT_RSA_MOD_EXP"
		align 10h
_CSWIFT_str_reasons dd offset dword_64	; DATA XREF: _ERR_load_CSWIFT_strings+31o
					; _ERR_unload_CSWIFT_strings+19o ...
		dd offset ??_C@_0P@BJJHFGDF@already?5loaded?$AA@ ; "already loaded"
		dd offset dword_64+1
		dd offset ??_C@_0N@DFCGBPP@bad?5key?5size?$AA@ ; "bad key size"
		dd offset dword_64+2
		dd offset ??_C@_0M@FKHFAIDE@bn?5ctx?5full?$AA@ ; "bn ctx full"
		dd offset dword_64+3
		dd offset ??_C@_0P@NJHPDICB@bn?5expand?5fail?$AA@ ; "bn	expand fail"
		dd offset dword_64+4
		dd offset ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@ ; "ctrl command not implemented"
		dd offset dword_64+5
		dd offset ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@ ; "missing key components"
		dd offset dword_64+6
		dd offset ??_C@_0L@ICAFOIA@not?5loaded?$AA@ ; "not loaded"
		dd offset dword_64+7
		dd offset ??_C@_0P@LMFGIOCF@request?5failed?$AA@ ; "request failed"
		dd offset _cswift_random
		dd offset ??_C@_0N@JLJLJPMB@unit?5failure?$AA@ ; "unit failure"
		align 10h
_CSWIFT_lib_name dd 0			; DATA XREF: _ERR_load_CSWIFT_strings+4Bo
					; _ERR_load_CSWIFT_strings+52w	...
		dd offset ??_C@_0O@PGMCBPIK@cswift?5engine?$AA@	; "cswift engine"
		align 10h
_cswift_rsa	dd offset ??_C@_0BH@LPOCDBDP@CryptoSwift?5RSA?5method?$AA@
					; DATA XREF: _bind_helper+33o
					; "CryptoSwift RSA method"
dword_154	dd 0			; DATA XREF: _bind_helper+F5w
dword_158	dd 0			; DATA XREF: _bind_helper+FEw
dword_15C	dd 0			; DATA XREF: _bind_helper+107w
dword_160	dd 0			; DATA XREF: _bind_helper+110w
		dd offset _cswift_rsa_mod_exp
		dd offset _cswift_mod_exp_mont
		dd 7 dup(0)
_data		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 188h
; COMDAT (pick any)
		public ??_C@_0BH@PJKBDPLH@CryptoSwift?5DSA?5method?$AA@
; `string'
??_C@_0BH@PJKBDPLH@CryptoSwift?5DSA?5method?$AA@ db 'CryptoSwift DSA method',0
					; DATA XREF: .data:_cswift_dsao
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1A0h
; COMDAT (pick any)
		public ??_C@_0BG@IJAAONL@CryptoSwift?5DH?5method?$AA@
; `string'
??_C@_0BG@IJAAONL@CryptoSwift?5DH?5method?$AA@ db 'CryptoSwift DH method',0
					; DATA XREF: .data:_cswift_dho
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B8h
; COMDAT (pick any)
		public ??_C@_06FPKOIGKA@cswift?$AA@
; `string'
??_C@_06FPKOIGKA@cswift?$AA@ db	'cswift',0 ; DATA XREF: .data:_engine_cswift_ido
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1C0h
; COMDAT (pick any)
		public ??_C@_0CE@EJAJAMFB@CryptoSwift?5hardware?5engine?5supp@
; `string'
??_C@_0CE@EJAJAMFB@CryptoSwift?5hardware?5engine?5supp@	db 'CryptoSwift hardware engine support',0
					; DATA XREF: .data:_engine_cswift_nameo
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 1E4h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing
_cswift_dso	dd ?			; DATA XREF: _cswift_ctrl+2r
					; _cswift_finish:loc_1402r ...
		public _p_CSwift_AcquireAccContext
_p_CSwift_AcquireAccContext dd ?	; DATA XREF: _cswift_dsa_sign+3Ar
					; _cswift_dsa_verify+41r ...
		public _p_CSwift_AttachKeyParam
_p_CSwift_AttachKeyParam dd ?		; DATA XREF: _cswift_dsa_sign+1FEr
					; _cswift_dsa_verify+204r ...
		public _p_CSwift_SimpleRequest
_p_CSwift_SimpleRequest	dd ?		; DATA XREF: _cswift_dsa_sign+2ABr
					; _cswift_dsa_verify+311r ...
		public _p_CSwift_ReleaseAccContext
_p_CSwift_ReleaseAccContext dd ?	; DATA XREF: _cswift_dsa_sign+345r
					; _cswift_dsa_verify+3ADr ...
_CSWIFT_LIBNAME	dd ?			; DATA XREF: _cswift_destroyr
					; _cswift_destroy+19w ...
_CSWIFT_lib_error_code dd ?		; DATA XREF: _cswift_rsa_mod_exp:loc_4A8r
					; _cswift_rsa_mod_exp+122w ...
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 200h
; COMDAT (pick any)
		public ??_C@_0BE@GKOHOBNG@swAcquireAccContext?$AA@
; `string'
??_C@_0BE@GKOHOBNG@swAcquireAccContext?$AA@ db 'swAcquireAccContext',0
					; DATA XREF: .data:_CSWIFT_F1o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 214h
; COMDAT (pick any)
		public ??_C@_0BB@CMEOOCMH@swAttachKeyParam?$AA@
; `string'
??_C@_0BB@CMEOOCMH@swAttachKeyParam?$AA@ db 'swAttachKeyParam',0
					; DATA XREF: .data:_CSWIFT_F2o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 228h
; COMDAT (pick any)
		public ??_C@_0BA@BBJGAMOP@swSimpleRequest?$AA@
; `string'
??_C@_0BA@BBJGAMOP@swSimpleRequest?$AA@	db 'swSimpleRequest',0
					; DATA XREF: .data:_CSWIFT_F3o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 238h
; COMDAT (pick any)
		public ??_C@_0BE@EMDGPDJP@swReleaseAccContext?$AA@
; `string'
??_C@_0BE@EMDGPDJP@swReleaseAccContext?$AA@ db 'swReleaseAccContext',0
					; DATA XREF: .data:_CSWIFT_F4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 24Ch
; COMDAT (pick any)
		public ??_C@_0M@KGAKDDIP@CSWIFT_CTRL?$AA@
; `string'
??_C@_0M@KGAKDDIP@CSWIFT_CTRL?$AA@ db 'CSWIFT_CTRL',0 ; DATA XREF: .data:000000A4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 258h
; COMDAT (pick any)
		public ??_C@_0BA@GJBNNKCH@CSWIFT_DSA_SIGN?$AA@
; `string'
??_C@_0BA@GJBNNKCH@CSWIFT_DSA_SIGN?$AA@	db 'CSWIFT_DSA_SIGN',0 ; DATA XREF: .data:000000ACo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 268h
; COMDAT (pick any)
		public ??_C@_0BC@LDIADIEK@CSWIFT_DSA_VERIFY?$AA@
; `string'
??_C@_0BC@LDIADIEK@CSWIFT_DSA_VERIFY?$AA@ db 'CSWIFT_DSA_VERIFY',0
					; DATA XREF: .data:000000B4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 27Ch
; COMDAT (pick any)
		public ??_C@_0O@CKCPKCCP@CSWIFT_FINISH?$AA@
; `string'
??_C@_0O@CKCPKCCP@CSWIFT_FINISH?$AA@ db	'CSWIFT_FINISH',0 ; DATA XREF: .data:000000BCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 28Ch
; COMDAT (pick any)
		public ??_C@_0M@EBHGEIBN@CSWIFT_INIT?$AA@
; `string'
??_C@_0M@EBHGEIBN@CSWIFT_INIT?$AA@ db 'CSWIFT_INIT',0 ; DATA XREF: .data:000000C4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 298h
; COMDAT (pick any)
		public ??_C@_0P@IJFIMLE@CSWIFT_MOD_EXP?$AA@
; `string'
??_C@_0P@IJFIMLE@CSWIFT_MOD_EXP?$AA@ db	'CSWIFT_MOD_EXP',0 ; DATA XREF: .data:000000CCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2A8h
; COMDAT (pick any)
		public ??_C@_0BD@PKNPAAAD@CSWIFT_MOD_EXP_CRT?$AA@
; `string'
??_C@_0BD@PKNPAAAD@CSWIFT_MOD_EXP_CRT?$AA@ db 'CSWIFT_MOD_EXP_CRT',0
					; DATA XREF: .data:000000D4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2BCh
; COMDAT (pick any)
		public ??_C@_0BC@INGHBIFA@CSWIFT_RAND_BYTES?$AA@
; `string'
??_C@_0BC@INGHBIFA@CSWIFT_RAND_BYTES?$AA@ db 'CSWIFT_RAND_BYTES',0
					; DATA XREF: .data:000000DCo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2D0h
; COMDAT (pick any)
		public ??_C@_0BD@GDNNAJLA@CSWIFT_RSA_MOD_EXP?$AA@
; `string'
??_C@_0BD@GDNNAJLA@CSWIFT_RSA_MOD_EXP?$AA@ db 'CSWIFT_RSA_MOD_EXP',0
					; DATA XREF: .data:000000E4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2E4h
; COMDAT (pick any)
		public ??_C@_0P@BJJHFGDF@already?5loaded?$AA@
; `string'
??_C@_0P@BJJHFGDF@already?5loaded?$AA@ db 'already loaded',0 ; DATA XREF: .data:000000F4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2F4h
; COMDAT (pick any)
		public ??_C@_0N@DFCGBPP@bad?5key?5size?$AA@
; `string'
??_C@_0N@DFCGBPP@bad?5key?5size?$AA@ db	'bad key size',0 ; DATA XREF: .data:000000FCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 304h
; COMDAT (pick any)
		public ??_C@_0M@FKHFAIDE@bn?5ctx?5full?$AA@
; `string'
??_C@_0M@FKHFAIDE@bn?5ctx?5full?$AA@ db	'bn ctx full',0 ; DATA XREF: .data:00000104o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 310h
; COMDAT (pick any)
		public ??_C@_0P@NJHPDICB@bn?5expand?5fail?$AA@
; `string'
??_C@_0P@NJHPDICB@bn?5expand?5fail?$AA@	db 'bn expand fail',0 ; DATA XREF: .data:0000010Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 320h
; COMDAT (pick any)
		public ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@
; `string'
??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@	db 'ctrl command not implemented',0
					; DATA XREF: .data:00000114o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 340h
; COMDAT (pick any)
		public ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@
; `string'
??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@	db 'missing key components',0
					; DATA XREF: .data:0000011Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 358h
; COMDAT (pick any)
		public ??_C@_0L@ICAFOIA@not?5loaded?$AA@
; `string'
??_C@_0L@ICAFOIA@not?5loaded?$AA@ db 'not loaded',0 ; DATA XREF: .data:00000124o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 364h
; COMDAT (pick any)
		public ??_C@_0P@LMFGIOCF@request?5failed?$AA@
; `string'
??_C@_0P@LMFGIOCF@request?5failed?$AA@ db 'request failed',0 ; DATA XREF: .data:0000012Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 374h
; COMDAT (pick any)
		public ??_C@_0N@JLJLJPMB@unit?5failure?$AA@
; `string'
??_C@_0N@JLJLJPMB@unit?5failure?$AA@ db	'unit failure',0 ; DATA XREF: .data:00000134o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 384h
; COMDAT (pick any)
		public ??_C@_0O@PGMCBPIK@cswift?5engine?$AA@
; `string'
??_C@_0O@PGMCBPIK@cswift?5engine?$AA@ db 'cswift engine',0 ; DATA XREF: .data:00000144o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 394h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_rsa_mod_exp proc near		; DATA XREF: .data:00000164o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		xor	edi, edi
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	loc_4A8
		cmp	[esi+20h], edi
		jz	loc_4A8
		cmp	[esi+24h], edi
		jz	loc_4A8
		cmp	[esi+28h], edi
		jz	loc_4A8
		cmp	[esi+2Ch], edi
		jz	loc_4A8
		push	eax
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 80h ; '€'
		jg	short loc_45F
		push	dword ptr [esi+20h]
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 80h ; '€'
		jg	short loc_45F
		push	dword ptr [esi+24h]
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 80h ; '€'
		jg	short loc_45F
		push	dword ptr [esi+28h]
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 80h ; '€'
		jg	short loc_45F
		push	dword ptr [esi+2Ch]
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 80h ; '€'
		jle	short loc_480

loc_45F:				; CODE XREF: _cswift_rsa_mod_exp+51j
					; _cswift_rsa_mod_exp+6Fj ...
		call	_RSA_PKCS1_SSLeay
		test	eax, eax
		jz	short loc_480
		push	[esp+8+arg_C]
		mov	eax, [eax+14h]
		push	esi
		push	[esp+10h+arg_4]
		push	[esp+14h+arg_0]
		call	eax
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_480:				; CODE XREF: _cswift_rsa_mod_exp+C9j
					; _cswift_rsa_mod_exp+D2j
		push	[esp+8+arg_C]
		push	dword ptr [esi+2Ch]
		push	dword ptr [esi+28h]
		push	dword ptr [esi+24h]
		push	dword ptr [esi+20h]
		push	dword ptr [esi+1Ch]
		push	[esp+20h+arg_4]
		push	[esp+24h+arg_0]
		call	_cswift_mod_exp_crt
		add	esp, 20h
		mov	edi, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4A8:				; CODE XREF: _cswift_rsa_mod_exp+Dj
					; _cswift_rsa_mod_exp+16j ...
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_4BB
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_4BB:				; CODE XREF: _cswift_rsa_mod_exp+11Bj
		push	2E3h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	69h ; 'i'
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$12:
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_cswift_rsa_mod_exp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_mod_exp_mont proc near		; DATA XREF: .data:00000168o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	edi
		push	ebx
		call	_BN_num_bits
		mov	esi, [esp+10h+arg_C]
		add	eax, 7
		mov	edi, [esp+10h+arg_4]
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 100h
		jg	short loc_53B
		push	edi
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 100h
		jg	short loc_53B
		push	esi
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	eax, 100h
		jle	short loc_55F

loc_53B:				; CODE XREF: _cswift_mod_exp_mont+29j
					; _cswift_mod_exp_mont+45j
		call	_RSA_PKCS1_SSLeay
		test	eax, eax
		jz	short loc_55F
		push	[esp+0Ch+arg_14]
		mov	eax, [eax+18h]
		push	[esp+10h+arg_10]
		push	esi
		push	[esp+18h+arg_8]
		push	edi
		push	ebx
		call	eax
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_55F:				; CODE XREF: _cswift_mod_exp_mont+61j
					; _cswift_mod_exp_mont+6Aj
		push	[esp+0Ch+arg_10]
		push	esi
		push	[esp+14h+arg_8]
		push	edi
		push	ebx
		call	_cswift_mod_exp
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebx
		retn
_cswift_mod_exp_mont endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 578h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_dsa_sign proc near		; DATA XREF: .data:0000001Co

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
Dest		= byte ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_0]
		push	ebp
		mov	ebp, [esp+6Ch+arg_8]
		push	esi
		push	edi
		mov	[esp+74h+var_54], eax
		xor	edi, edi
		call	_BN_CTX_new
		mov	esi, eax
		test	esi, esi
		jz	loc_8D3
		lea	eax, [esp+74h+var_58]
		push	eax
		call	ds:_p_CSwift_AcquireAccContext
		test	eax, eax
		jz	short loc_5EB
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_5CF
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_5CF:				; CODE XREF: _cswift_dsa_sign+4Bj
		push	32Dh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_8C4
; ---------------------------------------------------------------------------

loc_5EB:				; CODE XREF: _cswift_dsa_sign+42j
		push	ebx
		push	esi
		call	_BN_CTX_start
		push	esi
		call	_BN_CTX_get
		push	esi
		mov	[esp+80h+var_60], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+84h+var_5C], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+88h+var_58], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+8Ch+var_64], eax
		call	_BN_CTX_get
		mov	ebx, eax
		add	esp, 18h
		test	ebx, ebx
		jnz	short loc_64D
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_63C
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_63C:				; CODE XREF: _cswift_dsa_sign+B8j
		push	339h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	66h ; 'f'
		jmp	loc_8AE
; ---------------------------------------------------------------------------

loc_64D:				; CODE XREF: _cswift_dsa_sign+AFj
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax+4]
		mov	eax, [esp+74h+var_60]
		cmp	ecx, [eax+8]
		jle	short loc_666
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_666:				; CODE XREF: _cswift_dsa_sign+E2j
		test	eax, eax
		jz	loc_88F
		mov	eax, [ebp+10h]
		mov	ecx, [eax+4]
		mov	eax, [esp+74h+var_5C]
		cmp	ecx, [eax+8]
		jle	short loc_687
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_687:				; CODE XREF: _cswift_dsa_sign+103j
		test	eax, eax
		jz	loc_88F
		mov	eax, [ebp+14h]
		mov	ecx, [eax+4]
		mov	eax, [esp+74h+var_58]
		cmp	ecx, [eax+8]
		jle	short loc_6A8
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_6A8:				; CODE XREF: _cswift_dsa_sign+124j
		test	eax, eax
		jz	loc_88F
		mov	eax, [ebp+1Ch]
		mov	ecx, [eax+4]
		mov	eax, [esp+74h+var_64]
		cmp	ecx, [eax+8]
		jle	short loc_6C9
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_6C9:				; CODE XREF: _cswift_dsa_sign+145j
		test	eax, eax
		jz	loc_88F
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	eax, [ebx+8]
		jg	short loc_6E0
		mov	eax, ebx
		jmp	short loc_6EA
; ---------------------------------------------------------------------------

loc_6E0:				; CODE XREF: _cswift_dsa_sign+162j
		push	eax
		push	ebx
		call	_bn_expand2
		add	esp, 8

loc_6EA:				; CODE XREF: _cswift_dsa_sign+166j
		test	eax, eax
		jz	loc_88F
		mov	eax, [esp+74h+var_60]
		mov	[esp+74h+var_3C], 3
		push	dword ptr [eax]
		push	dword ptr [ebp+0Ch]
		call	_BN_bn2bin
		mov	[esp+7Ch+var_38], eax
		mov	eax, [esp+7Ch+var_60]
		mov	eax, [eax]
		mov	[esp+7Ch+var_34], eax
		mov	eax, [esp+7Ch+var_5C]
		push	dword ptr [eax]
		push	dword ptr [ebp+10h]
		call	_BN_bn2bin
		mov	[esp+84h+var_30], eax
		mov	eax, [esp+84h+var_5C]
		mov	eax, [eax]
		mov	[esp+84h+var_2C], eax
		mov	eax, [esp+84h+var_58]
		push	dword ptr [eax]
		push	dword ptr [ebp+14h]
		call	_BN_bn2bin
		mov	[esp+8Ch+var_28], eax
		mov	eax, [esp+8Ch+var_58]
		mov	eax, [eax]
		mov	[esp+8Ch+var_24], eax
		mov	eax, [esp+8Ch+var_64]
		push	dword ptr [eax]
		push	dword ptr [ebp+1Ch]
		call	_BN_bn2bin
		mov	dword ptr [esp+94h+var_20], eax
		add	esp, 20h
		mov	eax, [esp+74h+var_64]
		mov	eax, [eax]
		mov	[esp+74h+var_1C], eax
		lea	eax, [esp+74h+var_3C]
		push	eax
		push	[esp+78h+var_54]
		call	ds:_p_CSwift_AttachKeyParam
		mov	[esp+74h+var_64], eax
		cmp	eax, 0FFFFD8EAh
		jz	loc_877
		test	eax, eax
		jz	short loc_7D1
		push	359h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	65h ; 'e'
		call	_ERR_CSWIFT_error
		push	[esp+84h+var_64]

loc_7A6:				; CODE XREF: _cswift_dsa_sign+2CBj
		lea	eax, [esp+88h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+90h+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	loc_8B9
; ---------------------------------------------------------------------------

loc_7D1:				; CODE XREF: _cswift_dsa_sign+215j
		mov	eax, [esp+74h+arg_8]
		push	dword ptr [ebp+0Ch]
		mov	[esp+78h+var_44], eax
		mov	eax, [esp+78h+var_50]
		mov	[esp+78h+var_40], eax
		call	_BN_num_bits
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		push	eax		; Size
		mov	[esp+7Ch+var_4C], eax
		push	0		; Val
		push	dword ptr [ebx]	; Dst
		call	_memset
		mov	eax, [ebx]
		add	esp, 10h
		mov	[esp+74h+var_48], eax
		lea	eax, [esp+74h+var_4C]
		push	1
		push	eax
		push	1
		lea	eax, [esp+80h+var_44]
		push	eax
		push	3
		push	[esp+88h+var_54]
		call	ds:_p_CSwift_SimpleRequest
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_848
		push	36Ah
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	65h ; 'e'
		call	_ERR_CSWIFT_error
		push	ebp
		jmp	loc_7A6
; ---------------------------------------------------------------------------

loc_848:				; CODE XREF: _cswift_dsa_sign+2B5j
		call	_DSA_SIG_new
		mov	edi, eax
		test	edi, edi
		jz	short loc_8B9
		push	0
		push	14h
		push	dword ptr [ebx]
		call	_BN_bin2bn
		mov	[edi], eax
		mov	eax, [ebx]
		push	0
		add	eax, 14h
		push	14h
		push	eax
		call	_BN_bin2bn
		add	esp, 18h
		mov	[edi+4], eax
		jmp	short loc_8B9
; ---------------------------------------------------------------------------

loc_877:				; CODE XREF: _cswift_dsa_sign+20Dj
		push	354h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	65h ; 'e'
		push	65h ; 'e'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	short loc_8B9
; ---------------------------------------------------------------------------

loc_88F:				; CODE XREF: _cswift_dsa_sign+F0j
					; _cswift_dsa_sign+111j ...
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_8A2
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_8A2:				; CODE XREF: _cswift_dsa_sign+31Ej
		push	341h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	67h ; 'g'

loc_8AE:				; CODE XREF: _cswift_dsa_sign+D0j
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_8B9:				; CODE XREF: _cswift_dsa_sign+254j
					; _cswift_dsa_sign+2D9j ...
		push	[esp+74h+var_54]
		call	ds:_p_CSwift_ReleaseAccContext
		pop	ebx

loc_8C4:				; CODE XREF: _cswift_dsa_sign+6Ej
		push	esi
		call	_BN_CTX_end
		push	esi
		call	_BN_CTX_free
		add	esp, 8

loc_8D3:				; CODE XREF: _cswift_dsa_sign+2Fj
		mov	ecx, [esp+74h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_cswift_dsa_sign endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_dsa_verify proc	near		; DATA XREF: .data:00000024o

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
Dest		= byte ptr -10h
var_4		= dword	ptr -4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 74h ; 't'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		mov	eax, [esp+74h+arg_8]
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+80h+arg_C]
		or	ebx, 0FFFFFFFFh
		mov	[esp+80h+var_50], eax
		call	_BN_CTX_new
		mov	esi, eax
		test	esi, esi
		jz	loc_CAB
		lea	eax, [esp+80h+var_64]
		push	eax
		call	ds:_p_CSwift_AcquireAccContext
		test	eax, eax
		jz	short loc_962
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_946
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_946:				; CODE XREF: _cswift_dsa_verify+52j
		push	393h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_C9C
; ---------------------------------------------------------------------------

loc_962:				; CODE XREF: _cswift_dsa_verify+49j
		push	ebp
		push	esi
		call	_BN_CTX_start
		push	esi
		call	_BN_CTX_get
		push	esi
		mov	[esp+8Ch+var_70], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+90h+var_6C], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+94h+var_68], eax
		call	_BN_CTX_get
		push	esi
		mov	[esp+98h+var_64], eax
		call	_BN_CTX_get
		mov	ebp, eax
		add	esp, 18h
		test	ebp, ebp
		jnz	short loc_9C4
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_9B3
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_9B3:				; CODE XREF: _cswift_dsa_verify+BFj
		push	39Fh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	66h ; 'f'
		jmp	loc_C86
; ---------------------------------------------------------------------------

loc_9C4:				; CODE XREF: _cswift_dsa_verify+B6j
		mov	eax, [edi+0Ch]
		mov	ecx, [eax+4]
		mov	eax, [esp+80h+var_70]
		cmp	ecx, [eax+8]
		jle	short loc_9DD
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_9DD:				; CODE XREF: _cswift_dsa_verify+E9j
		test	eax, eax
		jz	loc_C67
		mov	eax, [edi+10h]
		mov	ecx, [eax+4]
		mov	eax, [esp+80h+var_6C]
		cmp	ecx, [eax+8]
		jle	short loc_9FE
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_9FE:				; CODE XREF: _cswift_dsa_verify+10Aj
		test	eax, eax
		jz	loc_C67
		mov	eax, [edi+14h]
		mov	ecx, [eax+4]
		mov	eax, [esp+80h+var_68]
		cmp	ecx, [eax+8]
		jle	short loc_A1F
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_A1F:				; CODE XREF: _cswift_dsa_verify+12Bj
		test	eax, eax
		jz	loc_C67
		mov	eax, [edi+18h]
		mov	ecx, [eax+4]
		mov	eax, [esp+80h+var_64]
		cmp	ecx, [eax+8]
		jle	short loc_A40
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_A40:				; CODE XREF: _cswift_dsa_verify+14Cj
		test	eax, eax
		jz	loc_C67
		cmp	dword ptr [ebp+8], 28h ; '('
		jl	short loc_A52
		mov	eax, ebp
		jmp	short loc_A5D
; ---------------------------------------------------------------------------

loc_A52:				; CODE XREF: _cswift_dsa_verify+164j
		push	28h ; '('
		push	ebp
		call	_bn_expand2
		add	esp, 8

loc_A5D:				; CODE XREF: _cswift_dsa_verify+168j
		test	eax, eax
		jz	loc_C67
		mov	eax, [esp+80h+var_70]
		mov	[esp+80h+var_3C], 3
		push	dword ptr [eax]
		push	dword ptr [edi+0Ch]
		call	_BN_bn2bin
		mov	[esp+88h+var_38], eax
		mov	eax, [esp+88h+var_70]
		mov	eax, [eax]
		mov	[esp+88h+var_34], eax
		mov	eax, [esp+88h+var_6C]
		push	dword ptr [eax]
		push	dword ptr [edi+10h]
		call	_BN_bn2bin
		mov	[esp+90h+var_30], eax
		mov	eax, [esp+90h+var_6C]
		mov	eax, [eax]
		mov	[esp+90h+var_2C], eax
		mov	eax, [esp+90h+var_68]
		push	dword ptr [eax]
		push	dword ptr [edi+14h]
		call	_BN_bn2bin
		mov	[esp+98h+var_28], eax
		mov	eax, [esp+98h+var_68]
		mov	eax, [eax]
		mov	[esp+98h+var_24], eax
		mov	eax, [esp+98h+var_64]
		push	dword ptr [eax]
		push	dword ptr [edi+18h]
		call	_BN_bn2bin
		mov	dword ptr [esp+0A0h+var_20], eax
		add	esp, 20h
		mov	eax, [esp+80h+var_64]
		mov	eax, [eax]
		mov	[esp+80h+var_1C], eax
		lea	eax, [esp+80h+var_3C]
		push	eax
		push	[esp+84h+var_60]
		call	ds:_p_CSwift_AttachKeyParam
		mov	edi, eax
		cmp	edi, 0FFFFD8EAh
		jz	loc_C4F
		test	edi, edi
		jz	short loc_B46
		push	3BFh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	66h ; 'f'
		call	_ERR_CSWIFT_error
		push	edi
		lea	eax, [esp+94h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+9Ch+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	loc_C91
; ---------------------------------------------------------------------------

loc_B46:				; CODE XREF: _cswift_dsa_verify+21Aj
		mov	eax, [esp+80h+arg_8]
		xorps	xmm0, xmm0
		mov	[esp+80h+var_5C], eax
		mov	eax, [esp+80h+arg_4]
		mov	dword ptr [esp+80h+var_58], eax
		mov	[esp+80h+var_54], 28h ;	'('
		mov	eax, [ebp+0]
		mov	ebp, [esp+80h+var_4C]
		mov	[esp+80h+var_50], eax
		movups	xmmword	ptr [eax], xmm0
		mov	eax, [esp+80h+var_50]
		movups	xmmword	ptr [eax+10h], xmm0
		mov	eax, [esp+80h+var_50]
		movq	qword ptr [eax+20h], xmm0
		push	dword ptr [ebp+0]
		call	_BN_num_bits
		mov	ecx, [esp+84h+var_50]
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		sub	ecx, eax
		add	ecx, 14h
		push	ecx
		push	dword ptr [ebp+0]
		call	_BN_bn2bin
		push	dword ptr [ebp+4]
		call	_BN_num_bits
		mov	ecx, [esp+90h+var_50]
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		sub	ecx, eax
		add	ecx, 28h ; '('
		push	ecx
		push	dword ptr [ebp+4]
		call	_BN_bn2bin
		add	esp, 18h
		mov	[esp+80h+var_44], 4
		lea	eax, [esp+80h+var_48]
		mov	[esp+80h+var_40], eax
		lea	eax, [esp+80h+var_44]
		push	1
		push	eax
		push	2
		lea	eax, [esp+8Ch+var_5C]
		push	eax
		push	4
		push	[esp+94h+var_60]
		call	ds:_p_CSwift_SimpleRequest
		mov	edi, eax
		test	edi, edi
		jz	short loc_C44
		push	3D4h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	66h ; 'f'
		call	_ERR_CSWIFT_error
		push	edi
		lea	eax, [esp+94h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+9Ch+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	short loc_C91
; ---------------------------------------------------------------------------

loc_C44:				; CODE XREF: _cswift_dsa_verify+31Bj
		xor	ebx, ebx
		cmp	[esp+80h+var_48], ebx
		setnz	bl
		jmp	short loc_C91
; ---------------------------------------------------------------------------

loc_C4F:				; CODE XREF: _cswift_dsa_verify+212j
		push	3BAh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	65h ; 'e'
		push	66h ; 'f'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	short loc_C91
; ---------------------------------------------------------------------------

loc_C67:				; CODE XREF: _cswift_dsa_verify+F7j
					; _cswift_dsa_verify+118j ...
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_C7A
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_C7A:				; CODE XREF: _cswift_dsa_verify+386j
		push	3A7h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	67h ; 'g'

loc_C86:				; CODE XREF: _cswift_dsa_verify+D7j
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_C91:				; CODE XREF: _cswift_dsa_verify+259j
					; _cswift_dsa_verify+35Aj ...
		push	[esp+80h+var_60]
		call	ds:_p_CSwift_ReleaseAccContext
		pop	ebp

loc_C9C:				; CODE XREF: _cswift_dsa_verify+75j
		push	esi
		call	_BN_CTX_end
		push	esi
		call	_BN_CTX_free
		add	esp, 8

loc_CAB:				; CODE XREF: _cswift_dsa_verify+36j
		mov	ecx, [esp+80h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
_cswift_dsa_verify endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CC0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_mod_exp_dh proc	near		; DATA XREF: .data:00000054o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	[esp+arg_14]
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		call	_cswift_mod_exp
		add	esp, 14h
		retn
_cswift_mod_exp_dh endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CE0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl cswift_rand_bytes(void *Dst, size_t Size)
_cswift_rand_bytes proc	near		; DATA XREF: .data:00000070o
					; .data:0000007Co

var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
Src		= dword	ptr -41Ch
Dest		= byte ptr -418h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
Dst		= dword	ptr  4
Size		= dword	ptr  8

		mov	eax, 424h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+424h+var_4], eax
		push	ebp
		push	edi
		mov	edi, [esp+42Ch+Dst]
		lea	eax, [esp+42Ch+var_424]
		push	eax
		xor	ebp, ebp
		call	ds:_p_CSwift_AcquireAccContext
		test	eax, eax
		jz	short loc_D41
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_D25
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_D25:				; CODE XREF: _cswift_rand_bytes+39j
		push	3FCh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	6Ch ; 'l'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_E4A
; ---------------------------------------------------------------------------

loc_D41:				; CODE XREF: _cswift_rand_bytes+30j
		push	ebx
		push	esi
		mov	esi, [esp+434h+Size]
		cmp	esi, 400h
		jl	short loc_D8F

loc_D52:				; CODE XREF: _cswift_rand_bytes+ADj
		push	1
		lea	eax, [esp+438h+var_420]
		mov	[esp+438h+Src],	edi
		push	eax
		push	0
		push	0
		push	5
		push	[esp+448h+var_424]
		mov	[esp+44Ch+var_420], 400h
		call	ds:_p_CSwift_SimpleRequest
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_DDE
		sub	esi, 400h
		add	edi, 400h
		cmp	esi, 400h
		jge	short loc_D52

loc_D8F:				; CODE XREF: _cswift_rand_bytes+70j
		test	esi, esi
		jz	loc_E39
		push	1
		lea	eax, [esp+438h+var_404]
		mov	[esp+438h+var_420], 400h
		mov	[esp+438h+Src],	eax
		lea	eax, [esp+438h+var_420]
		push	eax
		push	0
		push	0
		push	5
		push	[esp+448h+var_424]
		call	ds:_p_CSwift_SimpleRequest
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_E2B
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_DD7
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_DD7:				; CODE XREF: _cswift_rand_bytes+EBj
		push	428h
		jmp	short loc_DF6
; ---------------------------------------------------------------------------

loc_DDE:				; CODE XREF: _cswift_rand_bytes+99j
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_DF1
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_DF1:				; CODE XREF: _cswift_rand_bytes+105j
		push	419h

loc_DF6:				; CODE XREF: _cswift_rand_bytes+FCj
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	6Ch ; 'l'
		push	eax
		call	_ERR_put_error
		push	ebx
		lea	eax, [esp+44Ch+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+454h+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 2Ch
		jmp	short loc_E3E
; ---------------------------------------------------------------------------

loc_E2B:				; CODE XREF: _cswift_rand_bytes+E2j
		push	esi		; Size
		push	[esp+438h+Src]	; Src
		push	edi		; Dst
		call	_memcpy
		add	esp, 0Ch

loc_E39:				; CODE XREF: _cswift_rand_bytes+B1j
		mov	ebp, 1

loc_E3E:				; CODE XREF: _cswift_rand_bytes+149j
		push	[esp+434h+var_424]
		call	ds:_p_CSwift_ReleaseAccContext
		pop	esi
		pop	ebx

loc_E4A:				; CODE XREF: _cswift_rand_bytes+5Cj
		mov	ecx, [esp+42Ch+var_4]
		mov	eax, ebp
		pop	edi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 424h
		retn
_cswift_rand_bytes endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E64h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_rand_status proc near		; DATA XREF: .data:00000080o
		mov	eax, 1
		retn
_cswift_rand_status endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E6Ch
_cswift_cmd_defns dd offset dword_C8	; DATA XREF: _bind_helper+DBo
		dd offset ??_C@_07EGEBNIPD@SO_PATH?$AA@	; "SO_PATH"
		dd offset ??_C@_0DC@JIDHGOGK@Specifies?5the?5path?5to?5the?5?8cswif@ ; "Specifies the path to the 'cswift' shar"...
		dd 2, 4	dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E8Ch
; COMDAT (pick any)
		public ??_C@_07EGEBNIPD@SO_PATH?$AA@
; `string'
??_C@_07EGEBNIPD@SO_PATH?$AA@ db 'SO_PATH',0 ; DATA XREF: .rdata:00000E70o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E94h
; COMDAT (pick any)
		public ??_C@_0DC@JIDHGOGK@Specifies?5the?5path?5to?5the?5?8cswif@
; `string'
??_C@_0DC@JIDHGOGK@Specifies?5the?5path?5to?5the?5?8cswif@ db 'Specifies the path to the ',27h,'cswift',27h,' shared library',0
					; DATA XREF: .rdata:00000E74o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0EC8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_CSWIFT_error proc near		; CODE XREF: _cswift_dsa_sign+225p
					; _cswift_dsa_sign+2C5p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_EDB
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_EDB:				; CODE XREF: _ERR_CSWIFT_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_CSWIFT_error endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0EF8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_CSWIFT_strings proc near	; CODE XREF: _bind_helper+12Bp
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_F0B
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_F0B:				; CODE XREF: _ERR_load_CSWIFT_strings+7j
		cmp	ds:_CSWIFT_error_init, 0
		jz	short locret_F57
		push	offset _CSWIFT_str_functs
		push	eax
		mov	ds:_CSWIFT_error_init, 0
		call	_ERR_load_strings
		push	offset _CSWIFT_str_reasons
		push	ds:_CSWIFT_lib_error_code
		call	_ERR_load_strings
		movzx	eax, byte ptr ds:_CSWIFT_lib_error_code
		shl	eax, 18h
		push	offset _CSWIFT_lib_name
		push	0
		mov	ds:_CSWIFT_lib_name, eax
		call	_ERR_load_strings
		add	esp, 18h

locret_F57:				; CODE XREF: _ERR_load_CSWIFT_strings+1Aj
		retn
_ERR_load_CSWIFT_strings endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F58h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_CSWIFT_strings proc	near
		cmp	ds:_CSWIFT_error_init, 0
		jnz	short locret_F9A
		push	offset _CSWIFT_str_functs
		push	ds:_CSWIFT_lib_error_code
		call	_ERR_unload_strings
		push	offset _CSWIFT_str_reasons
		push	ds:_CSWIFT_lib_error_code
		call	_ERR_unload_strings
		push	offset _CSWIFT_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	ds:_CSWIFT_error_init, 1

locret_F9A:				; CODE XREF: _ERR_unload_CSWIFT_strings+7j
		retn
_ERR_unload_CSWIFT_strings endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F9Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vsnprintf_l+14p
					; __vsprintf_l+12p ...
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FA4h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vsnprintf_l(char	*DstBuf, size_t	MaxCount, const	char *Format, _locale_t	Locale,	va_list	ArgList)
		public __vsnprintf_l
__vsnprintf_l	proc near

DstBuf		= dword	ptr  4
MaxCount	= dword	ptr  8
Format		= dword	ptr  0Ch
Locale		= dword	ptr  10h
ArgList		= dword	ptr  14h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+MaxCount]
		push	[esp+10h+DstBuf]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
__vsnprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FD8h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vsprintf_l(char *DstBuf,	const char *Format, _locale_t, va_list ArgList)
		public __vsprintf_l
__vsprintf_l	proc near

DstBuf		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+arg_8]
		push	[esp+8+Format]
		push	0FFFFFFFFh
		push	[esp+10h+DstBuf]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
__vsprintf_l	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 100Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$19
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1033

loc_102F:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1033:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_102F
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_102F

$skip_cbs$19:				; CODE XREF: _bind_engine+Cj
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	short loc_10B9
		mov	ecx, ds:_engine_cswift_id
		nop	dword ptr [eax+eax+00h]

loc_108C:				; CODE XREF: _bind_engine+9Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10AC
		test	dl, dl
		jz	short loc_10A8
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10AC
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_108C

loc_10A8:				; CODE XREF: _bind_engine+88j
		xor	eax, eax
		jmp	short loc_10B1
; ---------------------------------------------------------------------------

loc_10AC:				; CODE XREF: _bind_engine+84j
					; _bind_engine+90j
		sbb	eax, eax
		or	eax, 1

loc_10B1:				; CODE XREF: _bind_engine+9Ej
		test	eax, eax
		jnz	loc_102F

loc_10B9:				; CODE XREF: _bind_engine+73j
		push	[esp+4+arg_0]
		call	_bind_helper
		add	esp, 4
		test	eax, eax
		jz	loc_102F
		mov	eax, 1
		pop	esi
		retn
_bind_engine	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_fn	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_1110
		mov	ecx, ds:_engine_cswift_id
		xchg	ax, ax

loc_10E4:				; CODE XREF: _bind_fn+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1104
		test	dl, dl
		jz	short loc_1100
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1104
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10E4

loc_1100:				; CODE XREF: _bind_fn+18j
		xor	eax, eax
		jmp	short loc_1109
; ---------------------------------------------------------------------------

loc_1104:				; CODE XREF: _bind_fn+14j _bind_fn+20j
		sbb	eax, eax
		or	eax, 1

loc_1109:				; CODE XREF: _bind_fn+2Ej
		test	eax, eax
		jz	short loc_1110
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1110:				; CODE XREF: _bind_fn+6j _bind_fn+37j
		push	[esp+arg_0]
		call	_bind_helper
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_fn	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1124h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near		; CODE XREF: _bind_engine+B1p
					; _bind_fn+40p

arg_0		= dword	ptr  4

		push	esi
		push	ds:_engine_cswift_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	ds:_engine_cswift_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_dsa
		push	esi
		call	_ENGINE_set_DSA
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_dh
		push	esi
		call	_ENGINE_set_DH
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_random
		push	esi
		call	_ENGINE_set_RAND
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	loc_125B
		push	offset _cswift_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	short loc_125B
		push	offset _cswift_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	short loc_125B
		push	offset _cswift_cmd_defns
		push	esi
		call	_ENGINE_set_cmd_defns
		add	esp, 8
		test	eax, eax
		jz	short loc_125B
		call	_RSA_PKCS1_SSLeay
		mov	ecx, [eax+4]
		mov	ds:dword_154, ecx
		mov	ecx, [eax+8]
		mov	ds:dword_158, ecx
		mov	ecx, [eax+0Ch]
		mov	ds:dword_15C, ecx
		mov	eax, [eax+10h]
		mov	ds:dword_160, eax
		call	_DH_OpenSSL
		mov	ecx, [eax+4]
		mov	ds:dword_4C, ecx
		mov	eax, [eax+8]
		mov	ds:dword_50, eax
		call	_ERR_load_CSWIFT_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_125B:				; CODE XREF: _bind_helper+16j
					; _bind_helper+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_helper	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1260h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_bn_32copy proc near		; CODE XREF: _cswift_mod_exp_crt+E1p
					; _cswift_mod_exp_crt+117p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		push	[esp+8+arg_4]
		call	_BN_num_bits
		mov	edi, [esp+0Ch+arg_0]
		add	eax, 7
		cdq
		add	esp, 4
		and	edx, 7
		xor	esi, esi
		add	eax, edx
		sar	eax, 3
		mov	[edi], eax
		test	al, 1Fh
		jz	short loc_128E

loc_1286:				; CODE XREF: _cswift_bn_32copy+2Cj
		inc	eax
		inc	esi
		mov	[edi], eax
		test	al, 1Fh
		jnz	short loc_1286

loc_128E:				; CODE XREF: _cswift_bn_32copy+24j
		push	24Dh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	dword ptr [edi]
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[edi+4], eax
		test	eax, eax
		jnz	short loc_12AC
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_12AC:				; CODE XREF: _cswift_bn_32copy+47j
		add	eax, esi
		push	eax
		push	[esp+0Ch+arg_4]
		call	_BN_bn2bin
		add	esp, 8
		test	esi, esi
		jz	short loc_12CD
		push	esi		; Size
		push	0		; Val
		push	dword ptr [edi+4] ; Dst
		call	_memset
		add	esp, 0Ch

loc_12CD:				; CODE XREF: _cswift_bn_32copy+5Dj
		pop	edi
		mov	eax, 1
		pop	esi
		retn
_cswift_bn_32copy endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 12D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_ctrl	proc near		; DATA XREF: _bind_helper+C9o

arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		xor	eax, eax
		cmp	ds:_cswift_dso,	eax
		setnz	al
		cmp	[esp+arg_4], 0C8h ; 'È'
		jz	short loc_131A
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1300
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1300:				; CODE XREF: _cswift_ctrl+1Cj
		push	1E2h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	68h ; 'h'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_131A:				; CODE XREF: _cswift_ctrl+13j
		mov	ecx, [esp+arg_C]
		test	ecx, ecx
		jnz	short loc_134F
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1335
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1335:				; CODE XREF: _cswift_ctrl+51j
		push	1D7h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	43h ; 'C'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_134F:				; CODE XREF: _cswift_ctrl+48j
		test	eax, eax
		jz	short loc_1380
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1366
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1366:				; CODE XREF: _cswift_ctrl+82j
		push	1DBh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	64h ; 'd'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1380:				; CODE XREF: _cswift_ctrl+79j
		push	ecx
		call	_set_CSWIFT_LIBNAME
		add	esp, 4
		retn
_cswift_ctrl	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 138Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_destroy	proc near		; DATA XREF: _bind_helper+8Bo
		mov	eax, ds:_CSWIFT_LIBNAME
		test	eax, eax
		jz	short loc_139E
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_139E:				; CODE XREF: _cswift_destroy+7j
		cmp	ds:_CSWIFT_error_init, 0
		mov	ds:_CSWIFT_LIBNAME, 0
		jnz	short loc_13EA
		push	offset _CSWIFT_str_functs
		push	ds:_CSWIFT_lib_error_code
		call	_ERR_unload_strings
		push	offset _CSWIFT_str_reasons
		push	ds:_CSWIFT_lib_error_code
		call	_ERR_unload_strings
		push	offset _CSWIFT_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	ds:_CSWIFT_error_init, 1

loc_13EA:				; CODE XREF: _cswift_destroy+23j
		mov	eax, 1
		retn
_cswift_destroy	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_finish	proc near		; DATA XREF: _bind_helper+B7o
		mov	eax, ds:_CSWIFT_LIBNAME
		test	eax, eax
		jz	short loc_1402
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1402:				; CODE XREF: _cswift_finish+7j
		mov	eax, ds:_cswift_dso
		mov	ds:_CSWIFT_LIBNAME, 0
		test	eax, eax
		jnz	short loc_1442
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1428
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1428:				; CODE XREF: _cswift_finish+2Cj
		push	1C2h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ah ; 'j'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1442:				; CODE XREF: _cswift_finish+23j
		push	eax
		call	_DSO_free
		add	esp, 4
		test	eax, eax
		jnz	short loc_147C
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1462
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1462:				; CODE XREF: _cswift_finish+66j
		push	1C6h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_147C:				; CODE XREF: _cswift_finish+5Dj
		mov	ds:_cswift_dso,	0
		mov	eax, 1
		mov	ds:_p_CSwift_AcquireAccContext,	0
		mov	ds:_p_CSwift_AttachKeyParam, 0
		mov	ds:_p_CSwift_SimpleRequest, 0
		mov	ds:_p_CSwift_ReleaseAccContext,	0
		retn
_cswift_finish	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_init	proc near		; DATA XREF: _bind_helper+A1o

var_4		= byte ptr -4

		mov	eax, 4
		call	__chkstk
		cmp	ds:_cswift_dso,	0
		push	ebx
		push	esi
		push	edi
		jz	short loc_14EE
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_14DD
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_14DD:				; CODE XREF: _cswift_init+1Dj
		push	18Fh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	64h ; 'd'
		jmp	loc_1608
; ---------------------------------------------------------------------------

loc_14EE:				; CODE XREF: _cswift_init+14j
		mov	eax, ds:_CSWIFT_LIBNAME
		mov	ecx, offset ??_C@_05MJFOKOAF@swift?$AA@	; "swift"
		test	eax, eax
		push	0
		cmovnz	ecx, eax
		push	0
		push	ecx
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_cswift_dso,	eax
		test	eax, eax
		jnz	short loc_1532
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1528
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1528:				; CODE XREF: _cswift_init+68j
		push	195h
		jmp	loc_1601
; ---------------------------------------------------------------------------

loc_1532:				; CODE XREF: _cswift_init+5Fj
		push	ds:_CSWIFT_F1
		push	eax
		call	_DSO_bind_func
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_15E9
		push	ds:_CSWIFT_F2
		push	ds:_cswift_dso
		call	_DSO_bind_func
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_15E9
		push	ds:_CSWIFT_F3
		push	ds:_cswift_dso
		call	_DSO_bind_func
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	short loc_15E9
		push	ds:_CSWIFT_F4
		push	ds:_cswift_dso
		call	_DSO_bind_func
		add	esp, 8
		test	eax, eax
		jz	short loc_15E9
		mov	ds:_p_CSwift_ReleaseAccContext,	eax
		lea	eax, [esp+10h+var_4]
		push	eax
		mov	ds:_p_CSwift_AcquireAccContext,	esi
		mov	ds:_p_CSwift_AttachKeyParam, edi
		mov	ds:_p_CSwift_SimpleRequest, ebx
		call	esi
		test	eax, eax
		jz	short loc_15D5
		push	1ACh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	68h ; 'h'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	short $err$30
; ---------------------------------------------------------------------------

loc_15D5:				; CODE XREF: _cswift_init+107j
		push	dword ptr [esp+10h+var_4]
		call	ds:_p_CSwift_ReleaseAccContext
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_15E9:				; CODE XREF: _cswift_init+91j
					; _cswift_init+AFj ...
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_15FC
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_15FC:				; CODE XREF: _cswift_init+13Cj
		push	1A0h

loc_1601:				; CODE XREF: _cswift_init+79j
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ah ; 'j'

loc_1608:				; CODE XREF: _cswift_init+35j
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$30:				; CODE XREF: _cswift_init+11Fj
		mov	eax, ds:_cswift_dso
		test	eax, eax
		jz	short loc_162F
		push	eax
		call	_DSO_free
		add	esp, 4
		mov	ds:_cswift_dso,	0

loc_162F:				; CODE XREF: _cswift_init+166j
		pop	edi
		pop	esi
		mov	ds:_p_CSwift_AcquireAccContext,	0
		xor	eax, eax
		mov	ds:_p_CSwift_AttachKeyParam, 0
		mov	ds:_p_CSwift_SimpleRequest, 0
		mov	ds:_p_CSwift_ReleaseAccContext,	0
		pop	ebx
		pop	ecx
		retn
_cswift_init	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1660h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_mod_exp	proc near		; CODE XREF: _cswift_mod_exp_mont+92p
					; _cswift_mod_exp_dh+14p

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Dest		= byte ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_0]
		mov	[esp+68h+var_54], eax
		mov	eax, [esp+68h+arg_4]
		mov	[esp+68h+var_58], eax
		mov	eax, [esp+68h+arg_8]
		push	ebx
		mov	[esp+6Ch+var_60], eax
		xor	ebx, ebx
		mov	eax, [esp+6Ch+arg_C]
		push	edi
		mov	edi, [esp+70h+arg_10]
		mov	[esp+70h+var_68], eax
		lea	eax, [esp+70h+var_64]
		push	eax
		call	ds:_p_CSwift_AcquireAccContext
		test	eax, eax
		jz	short loc_16DE
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_16C2
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_16C2:				; CODE XREF: _cswift_mod_exp+56j
		push	1FFh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_195E
; ---------------------------------------------------------------------------

loc_16DE:				; CODE XREF: _cswift_mod_exp+4Dj
		push	ebp
		push	esi
		push	edi
		call	_BN_CTX_start
		push	edi
		call	_BN_CTX_get
		push	edi
		mov	ebx, eax
		call	_BN_CTX_get
		push	edi
		mov	ebp, eax
		call	_BN_CTX_get
		push	edi
		mov	[esp+88h+var_58], eax
		call	_BN_CTX_get
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_1733
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1722
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1722:				; CODE XREF: _cswift_mod_exp+B6j
		push	20Ah
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	66h ; 'f'
		jmp	loc_1945
; ---------------------------------------------------------------------------

loc_1733:				; CODE XREF: _cswift_mod_exp+ADj
		mov	eax, [esp+74h+var_64]
		mov	eax, [eax+4]
		cmp	eax, [ebx+8]
		jg	short loc_1743
		mov	eax, ebx
		jmp	short loc_174D
; ---------------------------------------------------------------------------

loc_1743:				; CODE XREF: _cswift_mod_exp+DDj
		push	eax
		push	ebx
		call	_bn_expand2
		add	esp, 8

loc_174D:				; CODE XREF: _cswift_mod_exp+E1j
		test	eax, eax
		jz	loc_1926
		mov	eax, [esp+74h+var_5C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+8]
		jg	short loc_1765
		mov	eax, ebp
		jmp	short loc_176F
; ---------------------------------------------------------------------------

loc_1765:				; CODE XREF: _cswift_mod_exp+FFj
		push	eax
		push	ebp
		call	_bn_expand2
		add	esp, 8

loc_176F:				; CODE XREF: _cswift_mod_exp+103j
		test	eax, eax
		jz	loc_1926
		mov	ecx, [esp+74h+var_54]
		mov	eax, [esp+74h+var_58]
		mov	ecx, [ecx+4]
		cmp	ecx, [eax+8]
		jle	short loc_1791
		push	ecx
		push	eax
		call	_bn_expand2
		add	esp, 8

loc_1791:				; CODE XREF: _cswift_mod_exp+125j
		test	eax, eax
		jz	loc_1926
		mov	ecx, [esp+74h+var_64]
		mov	eax, [ecx+4]
		cmp	eax, [esi+8]
		jg	short loc_17A9
		mov	eax, esi
		jmp	short loc_17B7
; ---------------------------------------------------------------------------

loc_17A9:				; CODE XREF: _cswift_mod_exp+143j
		push	eax
		push	esi
		call	_bn_expand2
		mov	ecx, [esp+7Ch+var_64]
		add	esp, 8

loc_17B7:				; CODE XREF: _cswift_mod_exp+147j
		test	eax, eax
		jz	loc_1926
		mov	[esp+74h+var_3C], 2
		push	dword ptr [ebx]
		push	ecx
		call	_BN_bn2bin
		mov	[esp+7Ch+var_38], eax
		mov	eax, [ebx]
		mov	[esp+7Ch+var_34], eax
		push	dword ptr [ebp+0]
		push	[esp+80h+var_5C]
		call	_BN_bn2bin
		add	esp, 10h
		mov	[esp+74h+var_30], eax
		mov	eax, [ebp+0]
		mov	[esp+74h+var_2C], eax
		lea	eax, [esp+74h+var_3C]
		push	eax
		push	[esp+78h+var_60]
		call	ds:_p_CSwift_AttachKeyParam
		mov	ebx, eax
		cmp	ebx, 0FFFFD8EAh
		jz	loc_190E
		test	ebx, ebx
		jz	short loc_1853
		push	224h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	69h ; 'i'
		call	_ERR_CSWIFT_error
		push	ebx
		lea	eax, [esp+88h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+90h+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	loc_1950
; ---------------------------------------------------------------------------

loc_1853:				; CODE XREF: _cswift_mod_exp+1B2j
		mov	ebx, [esp+74h+var_58]
		push	dword ptr [ebx]
		push	[esp+78h+var_54]
		call	_BN_bn2bin
		mov	[esp+7Ch+var_44], eax
		mov	eax, [ebx]
		mov	[esp+7Ch+var_40], eax
		mov	eax, [esp+7Ch+var_64]
		push	eax
		call	_BN_num_bits
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		push	eax		; Size
		mov	[esp+84h+var_4C], eax
		push	0		; Val
		push	dword ptr [esi]	; Dst
		call	_memset
		mov	eax, [esi]
		add	esp, 18h
		mov	[esp+74h+var_48], eax
		lea	eax, [esp+74h+var_4C]
		push	1
		push	eax
		push	1
		lea	eax, [esp+80h+var_44]
		push	eax
		push	2
		push	[esp+88h+var_60]
		call	ds:_p_CSwift_SimpleRequest
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_18F5
		push	234h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	69h ; 'i'
		call	_ERR_CSWIFT_error
		push	ebx
		lea	eax, [esp+88h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+90h+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	short loc_1950
; ---------------------------------------------------------------------------

loc_18F5:				; CODE XREF: _cswift_mod_exp+257j
		push	[esp+74h+var_50]
		push	[esp+78h+var_4C]
		push	dword ptr [esi]
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	ebx, 1
		jmp	short loc_1952
; ---------------------------------------------------------------------------

loc_190E:				; CODE XREF: _cswift_mod_exp+1AAj
		push	21Fh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	65h ; 'e'
		push	69h ; 'i'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	short loc_1950
; ---------------------------------------------------------------------------

loc_1926:				; CODE XREF: _cswift_mod_exp+EFj
					; _cswift_mod_exp+111j	...
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1939
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1939:				; CODE XREF: _cswift_mod_exp+2CDj
		push	20Fh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	67h ; 'g'

loc_1945:				; CODE XREF: _cswift_mod_exp+CEj
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_1950:				; CODE XREF: _cswift_mod_exp+1EEj
					; _cswift_mod_exp+293j	...
		xor	ebx, ebx

loc_1952:				; CODE XREF: _cswift_mod_exp+2ACj
		push	[esp+74h+var_60]
		call	ds:_p_CSwift_ReleaseAccContext
		pop	esi
		pop	ebp

loc_195E:				; CODE XREF: _cswift_mod_exp+79j
		push	edi
		call	_BN_CTX_end
		mov	ecx, [esp+74h+var_4]
		add	esp, 4
		mov	eax, ebx
		pop	edi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_cswift_mod_exp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 197Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cswift_mod_exp_crt proc near		; CODE XREF: _cswift_rsa_mod_exp+107p

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Dest		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	eax, 70h ; 'p'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_0]
		mov	[esp+70h+var_54], eax
		mov	eax, [esp+70h+arg_4]
		mov	[esp+70h+var_68], eax
		mov	eax, [esp+70h+arg_8]
		push	ebx
		mov	ebx, [esp+74h+arg_C]
		mov	[esp+74h+var_70], eax
		mov	eax, [esp+74h+arg_10]
		push	ebp
		mov	[esp+78h+var_60], eax
		xor	ebp, ebp
		mov	eax, [esp+78h+arg_14]
		push	esi
		mov	[esp+7Ch+var_5C], eax
		xor	esi, esi
		mov	eax, [esp+7Ch+arg_18]
		push	edi
		mov	[esp+80h+var_58], eax
		xor	edi, edi
		lea	eax, [esp+80h+var_6C]
		mov	[esp+80h+var_64], esi
		push	eax
		mov	[esp+84h+var_40], esi
		mov	[esp+84h+var_38], esi
		mov	[esp+84h+var_30], esi
		mov	[esp+84h+var_28], esi
		mov	[esp+84h+var_20], esi
		call	ds:_p_CSwift_AcquireAccContext
		test	eax, eax
		jz	short loc_1A26
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1A15
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1A15:				; CODE XREF: _cswift_mod_exp_crt+8Dj
		push	270h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Ch ; 'l'
		jmp	loc_1CB4
; ---------------------------------------------------------------------------

loc_1A26:				; CODE XREF: _cswift_mod_exp_crt+84j
		mov	[esp+80h+var_64], 1
		call	_BN_new
		mov	edi, eax
		call	_BN_new
		mov	esi, eax
		test	esi, esi
		jz	loc_1C95
		test	edi, edi
		jz	loc_1C95
		push	[esp+80h+var_70]
		lea	eax, [esp+84h+var_44]
		mov	dword ptr [esp+84h+var_48], 1
		push	eax
		call	_cswift_bn_32copy
		add	esp, 8
		test	eax, eax
		jnz	short loc_1A8D
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1A7C
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1A7C:				; CODE XREF: _cswift_mod_exp_crt+F4j
		push	28Ah
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	67h ; 'g'
		jmp	loc_1CB4
; ---------------------------------------------------------------------------

loc_1A8D:				; CODE XREF: _cswift_mod_exp_crt+EBj
		lea	eax, [esp+80h+var_3C]
		push	ebx
		push	eax
		call	_cswift_bn_32copy
		add	esp, 8
		test	eax, eax
		jnz	short loc_1ABA
		push	28Eh

loc_1AA4:				; CODE XREF: _cswift_mod_exp_crt+158j
					; _cswift_mod_exp_crt+174j ...
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	67h ; 'g'
		push	6Ah ; 'j'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	$err$51
; ---------------------------------------------------------------------------

loc_1ABA:				; CODE XREF: _cswift_mod_exp_crt+121j
		push	[esp+80h+var_60]
		lea	eax, [esp+84h+var_34]
		push	eax
		call	_cswift_bn_32copy
		add	esp, 8
		test	eax, eax
		jnz	short loc_1AD6
		push	292h
		jmp	short loc_1AA4
; ---------------------------------------------------------------------------

loc_1AD6:				; CODE XREF: _cswift_mod_exp_crt+151j
		push	[esp+80h+var_5C]
		lea	eax, [esp+84h+var_2C]
		push	eax
		call	_cswift_bn_32copy
		add	esp, 8
		test	eax, eax
		jnz	short loc_1AF2
		push	296h
		jmp	short loc_1AA4
; ---------------------------------------------------------------------------

loc_1AF2:				; CODE XREF: _cswift_mod_exp_crt+16Dj
		push	[esp+80h+var_58]
		lea	eax, [esp+84h+var_24]
		push	eax
		call	_cswift_bn_32copy
		add	esp, 8
		test	eax, eax
		jnz	short loc_1B0E
		push	29Ah
		jmp	short loc_1AA4
; ---------------------------------------------------------------------------

loc_1B0E:				; CODE XREF: _cswift_mod_exp_crt+189j
		mov	eax, [esp+80h+var_68]
		mov	eax, [eax+4]
		cmp	eax, [edi+8]
		jg	short loc_1B1E
		mov	eax, edi
		jmp	short loc_1B28
; ---------------------------------------------------------------------------

loc_1B1E:				; CODE XREF: _cswift_mod_exp_crt+19Cj
		push	eax
		push	edi
		call	_bn_expand2
		add	esp, 8

loc_1B28:				; CODE XREF: _cswift_mod_exp_crt+1A0j
		test	eax, eax
		jz	loc_1C8B
		mov	eax, [esp+80h+var_70]
		mov	eax, [eax+4]
		add	eax, [ebx+4]
		cmp	eax, [esi+8]
		jg	short loc_1B43
		mov	eax, esi
		jmp	short loc_1B4D
; ---------------------------------------------------------------------------

loc_1B43:				; CODE XREF: _cswift_mod_exp_crt+1C1j
		push	eax
		push	esi
		call	_bn_expand2
		add	esp, 8

loc_1B4D:				; CODE XREF: _cswift_mod_exp_crt+1C5j
		test	eax, eax
		jz	loc_1C8B
		lea	eax, [esp+80h+var_48]
		push	eax
		push	[esp+84h+var_6C]
		call	ds:_p_CSwift_AttachKeyParam
		mov	ebx, eax
		cmp	ebx, 0FFFFD8EAh
		jz	loc_1C73
		test	ebx, ebx
		jz	short loc_1BB8
		push	2ADh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	6Ah ; 'j'
		call	_ERR_CSWIFT_error
		push	ebx
		lea	eax, [esp+94h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+9Ch+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	$err$51
; ---------------------------------------------------------------------------

loc_1BB8:				; CODE XREF: _cswift_mod_exp_crt+1F8j
		push	dword ptr [edi]
		push	[esp+84h+var_68]
		call	_BN_bn2bin
		push	[esp+88h+var_70]
		mov	[esp+8Ch+var_1C], eax
		mov	eax, [edi]
		mov	[esp+8Ch+var_18], eax
		call	_BN_num_bits
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		add	eax, eax
		push	eax		; Size
		mov	[esp+90h+var_50], eax
		push	0		; Val
		push	dword ptr [esi]	; Dst
		call	_memset
		mov	eax, [esi]
		add	esp, 18h
		mov	[esp+80h+var_4C], eax
		lea	eax, [esp+80h+var_50]
		push	1
		push	eax
		push	1
		lea	eax, [esp+8Ch+var_1C]
		push	eax
		push	1
		push	[esp+94h+var_6C]
		call	ds:_p_CSwift_SimpleRequest
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1C5A
		push	2BDh
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	6Bh ; 'k'
		push	6Ah ; 'j'
		call	_ERR_CSWIFT_error
		push	ebx
		lea	eax, [esp+94h+Dest]
		push	offset ??_C@_03JALODAI@?$CFld?$AA@ ; "%ld"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+9Ch+Dest]
		push	eax
		push	offset ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@	; "CryptoSwift error number is "
		push	2
		call	_ERR_add_error_data
		add	esp, 28h
		jmp	short $err$51
; ---------------------------------------------------------------------------

loc_1C5A:				; CODE XREF: _cswift_mod_exp_crt+29Dj
		push	[esp+80h+var_54]
		push	[esp+84h+var_50]
		push	dword ptr [esi]
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	ebp, 1
		jmp	short $err$51
; ---------------------------------------------------------------------------

loc_1C73:				; CODE XREF: _cswift_mod_exp_crt+1F0j
		push	2A8h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	65h ; 'e'
		push	6Ah ; 'j'
		call	_ERR_CSWIFT_error
		add	esp, 10h
		jmp	short $err$51
; ---------------------------------------------------------------------------

loc_1C8B:				; CODE XREF: _cswift_mod_exp_crt+1AEj
					; _cswift_mod_exp_crt+1D3j
		push	29Eh
		jmp	loc_1AA4
; ---------------------------------------------------------------------------

loc_1C95:				; CODE XREF: _cswift_mod_exp_crt+C2j
					; _cswift_mod_exp_crt+CAj
		mov	eax, ds:_CSWIFT_lib_error_code
		test	eax, eax
		jnz	short loc_1CA8
		call	_ERR_get_next_error_library
		mov	ds:_CSWIFT_lib_error_code, eax

loc_1CA8:				; CODE XREF: _cswift_mod_exp_crt+320j
		push	279h
		push	offset ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@	; ".\\engines\\e_cswift.c"
		push	66h ; 'f'

loc_1CB4:				; CODE XREF: _cswift_mod_exp_crt+A5j
					; _cswift_mod_exp_crt+10Cj
		push	6Ah ; 'j'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$51:				; CODE XREF: _cswift_mod_exp_crt+139j
					; _cswift_mod_exp_crt+237j ...
		mov	eax, [esp+80h+var_40]
		test	eax, eax
		jz	short loc_1CD0
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1CD0:				; CODE XREF: _cswift_mod_exp_crt+349j
		mov	eax, [esp+80h+var_38]
		test	eax, eax
		jz	short loc_1CE1
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1CE1:				; CODE XREF: _cswift_mod_exp_crt+35Aj
		mov	eax, [esp+80h+var_30]
		test	eax, eax
		jz	short loc_1CF2
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1CF2:				; CODE XREF: _cswift_mod_exp_crt+36Bj
		mov	eax, [esp+80h+var_28]
		test	eax, eax
		jz	short loc_1D03
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1D03:				; CODE XREF: _cswift_mod_exp_crt+37Cj
		mov	eax, [esp+80h+var_20]
		test	eax, eax
		jz	short loc_1D14
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1D14:				; CODE XREF: _cswift_mod_exp_crt+38Dj
		test	esi, esi
		jz	short loc_1D21
		push	esi
		call	_BN_free
		add	esp, 4

loc_1D21:				; CODE XREF: _cswift_mod_exp_crt+39Aj
		test	edi, edi
		jz	short loc_1D2E
		push	edi
		call	_BN_free
		add	esp, 4

loc_1D2E:				; CODE XREF: _cswift_mod_exp_crt+3A7j
		cmp	[esp+80h+var_64], 0
		jz	short loc_1D3F
		push	[esp+80h+var_6C]
		call	ds:_p_CSwift_ReleaseAccContext

loc_1D3F:				; CODE XREF: _cswift_mod_exp_crt+3B7j
		mov	ecx, [esp+80h+var_4]
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
_cswift_mod_exp_crt endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_free_CSWIFT_LIBNAME proc near
		mov	eax, ds:_CSWIFT_LIBNAME
		test	eax, eax
		jz	short loc_1D66
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1D66:				; CODE XREF: _free_CSWIFT_LIBNAME+7j
		mov	ds:_CSWIFT_LIBNAME, 0
		retn
_free_CSWIFT_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D74h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_CSWIFT_LIBNAME proc near
		mov	ecx, ds:_CSWIFT_LIBNAME
		mov	eax, offset ??_C@_05MJFOKOAF@swift?$AA@	; "swift"
		test	ecx, ecx
		cmovnz	eax, ecx
		retn
_get_CSWIFT_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D88h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_context	proc near

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	ds:_p_CSwift_AcquireAccContext
		neg	eax
		sbb	eax, eax
		inc	eax
		retn
_get_context	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_release_context proc near

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	ds:_p_CSwift_ReleaseAccContext
		retn
_release_context endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1DA4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_set_CSWIFT_LIBNAME proc near		; CODE XREF: _cswift_ctrl+A9p

arg_0		= dword	ptr  4

		mov	eax, ds:_CSWIFT_LIBNAME
		test	eax, eax
		jz	short loc_1DB6
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1DB6:				; CODE XREF: _set_CSWIFT_LIBNAME+7j
		push	[esp+arg_0]
		mov	ds:_CSWIFT_LIBNAME, 0
		call	_BUF_strdup
		xor	ecx, ecx
		mov	ds:_CSWIFT_LIBNAME, eax
		add	esp, 4
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		retn
_set_CSWIFT_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1DDCh
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int sprintf(char *Dest, const	char *Format, ...)
		public _sprintf
_sprintf	proc near		; CODE XREF: _cswift_dsa_sign+238p
					; _cswift_dsa_verify+23Dp ...

Dest		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	0FFFFFFFFh
		push	[esp+10h+Dest]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
_sprintf	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1E10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E28h
; COMDAT (pick any)
		public ??_C@_05MJFOKOAF@swift?$AA@
; `string'
??_C@_05MJFOKOAF@swift?$AA@ db 'swift',0 ; DATA XREF: _cswift_init+3Fo
					; _get_CSWIFT_LIBNAME+6o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E30h
; COMDAT (pick any)
		public ??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@
; `string'
??_C@_0BF@NPJAGBKA@?4?2engines?2e_cswift?4c?$AA@ db '.\engines\e_cswift.c',0
					; DATA XREF: _cswift_rsa_mod_exp+12Co
					; _cswift_dsa_sign+5Co	...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E48h
; COMDAT (pick any)
		public ??_C@_03JALODAI@?$CFld?$AA@
; char `string'[4]
??_C@_03JALODAI@?$CFld?$AA@ db '%ld',0  ; DATA XREF: _cswift_dsa_sign+232o
					; _cswift_dsa_verify+237o ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E4Ch
; COMDAT (pick any)
		public ??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@
; `string'
??_C@_0BN@CHEGAPOI@CryptoSwift?5error?5number?5is?5?$AA@ db 'CryptoSwift error number is ',0
					; DATA XREF: _cswift_dsa_sign+245o
					; _cswift_dsa_verify+24Ao ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __imp____stdio_common_vsprintf:near ; CODE XREF: __vsnprintf_l+22p
					; __vsprintf_l+20p ...
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_malloc:near ; CODE XREF: _cswift_bn_32copy+3Ap
		extrn _CRYPTO_free:near	; CODE XREF: _cswift_destroy+Ap
					; _cswift_finish+Ap ...
		extrn _BUF_strdup:near	; CODE XREF: _set_CSWIFT_LIBNAME+20p
		extrn _DSO_free:near	; CODE XREF: _cswift_finish+53p
					; _cswift_init+169p
		extrn _DSO_load:near	; CODE XREF: _cswift_init+50p
		extrn _DSO_bind_func:near ; CODE XREF: _cswift_init+85p
					; _cswift_init+A3p ...
		extrn _BN_CTX_new:near	; CODE XREF: _cswift_dsa_sign+26p
					; _cswift_dsa_verify+2Dp
		extrn _BN_CTX_free:near	; CODE XREF: _cswift_dsa_sign+353p
					; _cswift_dsa_verify+3BBp
		extrn _BN_CTX_start:near ; CODE	XREF: _cswift_dsa_sign+75p
					; _cswift_dsa_verify+7Cp ...
		extrn _BN_CTX_get:near	; CODE XREF: _cswift_dsa_sign+7Bp
					; _cswift_dsa_sign+85p	...
		extrn _BN_CTX_end:near	; CODE XREF: _cswift_dsa_sign+34Dp
					; _cswift_dsa_verify+3B5p ...
		extrn _BN_num_bits:near	; CODE XREF: _cswift_rsa_mod_exp+38p
					; _cswift_rsa_mod_exp+56p ...
		extrn _BN_new:near	; CODE XREF: _cswift_mod_exp_crt+B2p
					; _cswift_mod_exp_crt+B9p
		extrn _BN_bin2bn:near	; CODE XREF: _cswift_dsa_sign+2E1p
					; _cswift_dsa_sign+2F2p ...
		extrn _BN_bn2bin:near	; CODE XREF: _cswift_dsa_sign+18Bp
					; _cswift_dsa_sign+1A7p ...
		extrn _BN_free:near	; CODE XREF: _cswift_mod_exp_crt+39Dp
					; _cswift_mod_exp_crt+3AAp
		extrn _bn_expand2:near	; CODE XREF: _cswift_dsa_sign+E6p
					; _cswift_dsa_sign+107p ...
		extrn _RSA_PKCS1_SSLeay:near ; CODE XREF: _cswift_rsa_mod_exp:loc_45Fp
					; _cswift_mod_exp_mont:loc_53Bp ...
		extrn _DH_OpenSSL:near	; CODE XREF: _bind_helper+115p
		extrn _DSA_SIG_new:near	; CODE XREF: _cswift_dsa_sign:loc_848p
		extrn _ERR_put_error:near ; CODE XREF: _cswift_rsa_mod_exp+136p
					; _cswift_dsa_sign+66p	...
		extrn _ERR_add_error_data:near ; CODE XREF: _cswift_dsa_sign+24Cp
					; _cswift_dsa_verify+251p ...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_CSWIFT_strings+2Cp
					; _ERR_load_CSWIFT_strings+3Cp	...
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_CSWIFT_strings+14p
					; _ERR_unload_CSWIFT_strings+24p ...
		extrn _ERR_get_next_error_library:near ; CODE XREF: _cswift_rsa_mod_exp+11Dp
					; _cswift_dsa_sign+4Dp	...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_helper+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_helper+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_helper+39p
		extrn _ENGINE_set_DSA:near ; CODE XREF:	_bind_helper+4Fp
		extrn _ENGINE_set_DH:near ; CODE XREF: _bind_helper+65p
		extrn _ENGINE_set_RAND:near ; CODE XREF: _bind_helper+7Bp
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_helper+91p
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_helper+A7p
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_helper+BDp
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_helper+CFp
		extrn _ENGINE_set_cmd_defns:near ; CODE	XREF: _bind_helper+E1p
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _cswift_dsa_sign+366p
					; _cswift_dsa_verify+3CEp ...
		extrn __chkstk:near	; CODE XREF: _cswift_dsa_sign+5p
					; _cswift_dsa_verify+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _cswift_rand_bytes+151p
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _cswift_dsa_sign+289p
					; _cswift_bn_32copy+65p ...
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso
		extrn ___security_cookie:near ;	DATA XREF: _cswift_dsa_sign+Ar
					; _cswift_dsa_verify+Ar ...


		end
