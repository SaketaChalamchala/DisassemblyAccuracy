;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	864033FA42E46087241C96555E3A0DC3
; Input	CRC32 :	EC8FD73F

; File Name   :	C:\compspace\Diff\openssl\obj\ts_conf.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_TS_CONF_add_flag proc near		; CODE XREF: _TS_CONF_set_ess_cert_id_chain+13p
					; _TS_CONF_set_ordering+13p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_8]
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_NCONF_get_string
		mov	ecx, eax
		add	esp, 0Ch
		test	ecx, ecx
		jz	short loc_5A
		mov	edx, offset ??_C@_03ICICOMAL@yes?$AA@ ;	`string'
		push	ebx

loc_20:					; CODE XREF: _TS_CONF_add_flag+3Aj
		mov	bl, [eax]
		cmp	bl, [edx]
		jnz	short loc_40
		test	bl, bl
		jz	short loc_3C
		mov	bl, [eax+1]
		cmp	bl, [edx+1]
		jnz	short loc_40
		add	eax, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_20

loc_3C:					; CODE XREF: _TS_CONF_add_flag+28j
		xor	eax, eax
		jmp	short loc_45
; ---------------------------------------------------------------------------

loc_40:					; CODE XREF: _TS_CONF_add_flag+24j
					; _TS_CONF_add_flag+30j
		sbb	eax, eax
		or	eax, 1

loc_45:					; CODE XREF: _TS_CONF_add_flag+3Ej
		pop	ebx
		test	eax, eax
		jnz	short loc_60
		push	[esp+arg_C]
		push	[esp+4+arg_10]
		call	_TS_RESP_CTX_add_flags
		add	esp, 8

loc_5A:					; CODE XREF: _TS_CONF_add_flag+18j
					; _TS_CONF_add_flag+8Cj
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_60:					; CODE XREF: _TS_CONF_add_flag+48j
		mov	eax, offset ??_C@_02KAJCLHKP@no?$AA@ ; `string'

loc_65:					; CODE XREF: _TS_CONF_add_flag+7Fj
		mov	dl, [ecx]
		cmp	dl, [eax]
		jnz	short loc_85
		test	dl, dl
		jz	short loc_81
		mov	dl, [ecx+1]
		cmp	dl, [eax+1]
		jnz	short loc_85
		add	ecx, 2
		add	eax, 2
		test	dl, dl
		jnz	short loc_65

loc_81:					; CODE XREF: _TS_CONF_add_flag+6Dj
		xor	eax, eax
		jmp	short loc_8A
; ---------------------------------------------------------------------------

loc_85:					; CODE XREF: _TS_CONF_add_flag+69j
					; _TS_CONF_add_flag+75j
		sbb	eax, eax
		or	eax, 1

loc_8A:					; CODE XREF: _TS_CONF_add_flag+83j
		test	eax, eax
		jz	short loc_5A
		push	[esp+arg_8]
		push	[esp+4+arg_4]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		xor	eax, eax
		retn
_TS_CONF_add_flag endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_get_tsa_section
_TS_CONF_get_tsa_section proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jnz	short locret_FF
		push	esi
		push	offset ??_C@_0M@FFEGKAMB@default_tsa?$AA@ ; "default_tsa"
		push	offset ??_C@_03BALHJLMH@tsa?$AA@ ; "tsa"
		push	[esp+0Ch+arg_0]
		call	_NCONF_get_string
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_FE
		push	offset ??_C@_0M@FFEGKAMB@default_tsa?$AA@ ; "default_tsa"
		push	offset ??_C@_03BALHJLMH@tsa?$AA@ ; "tsa"
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		mov	eax, esi

loc_FE:					; CODE XREF: _TS_CONF_get_tsa_section+23j
		pop	esi

locret_FF:				; CODE XREF: _TS_CONF_get_tsa_section+6j
		retn
_TS_CONF_get_tsa_section endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 100h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_TS_CONF_invalid proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		retn
_TS_CONF_invalid endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 124h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_load_cert
_TS_CONF_load_cert proc	near		; CODE XREF: _TS_CONF_set_signer_cert+58p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	offset ??_C@_01KDCPPGHE@r?$AA@ ; `string'
		push	[esp+0Ch+arg_0]
		xor	esi, esi
		call	_BIO_new_file
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_151
		push	esi
		push	esi
		push	esi
		push	edi
		call	_PEM_read_bio_X509_AUX
		add	esp, 10h
		mov	esi, eax

$end$7:
		test	esi, esi
		jnz	short loc_16E

loc_151:				; CODE XREF: _TS_CONF_load_cert+19j
		push	[esp+8+arg_0]
		push	offset ??_C@_0CA@IKGCPJI@unable?5to?5load?5certificate?3?5?$CFs?6?$AA@ ; "unable to load certificate: %s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch

loc_16E:				; CODE XREF: _TS_CONF_load_cert+2Bj
		push	edi
		call	_BIO_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		retn
_TS_CONF_load_cert endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 17Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_load_certs
_TS_CONF_load_certs proc near		; CODE XREF: _TS_CONF_set_certs+28p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebp, ebp
		push	edi
		push	offset ??_C@_01KDCPPGHE@r?$AA@ ; `string'
		push	esi
		xor	edi, edi
		call	_BIO_new_file
		mov	ebx, eax
		add	esp, 8
		mov	[esp+14h+var_4], ebx
		test	ebx, ebx
		jz	short loc_205
		call	_sk_new_null
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_205
		push	edi
		push	edi
		push	edi
		push	ebx
		call	_PEM_X509_INFO_read_bio
		mov	edi, eax
		xor	esi, esi
		push	edi
		call	_sk_num
		add	esp, 14h
		test	eax, eax
		jle	short loc_21F

loc_1CF:				; CODE XREF: _TS_CONF_load_certs+81j
		push	esi
		push	edi
		call	_sk_value
		mov	ebx, eax
		add	esp, 8
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_1F1
		push	eax
		push	ebp
		call	_sk_push
		add	esp, 8
		mov	dword ptr [ebx], 0

loc_1F1:				; CODE XREF: _TS_CONF_load_certs+63j
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_1CF

$end$16:
		mov	ebx, [esp+14h+var_4]
		jmp	short loc_21F
; ---------------------------------------------------------------------------

loc_205:				; CODE XREF: _TS_CONF_load_certs+2Cj
					; _TS_CONF_load_certs+37j
		push	esi
		push	offset ??_C@_0CB@KELMIFF@unable?5to?5load?5certificates?3?5?$CFs?6@ ; "unable to load certificates: %s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch

loc_21F:				; CODE XREF: _TS_CONF_load_certs+51j
					; _TS_CONF_load_certs+87j
		push	offset _X509_INFO_free
		push	edi
		call	_sk_pop_free
		push	ebx
		call	_BIO_free
		add	esp, 0Ch
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_TS_CONF_load_certs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 23Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_load_key
_TS_CONF_load_key proc near		; CODE XREF: _TS_CONF_set_signer_key+5Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		push	offset ??_C@_01KDCPPGHE@r?$AA@ ; `string'
		push	[esp+0Ch+arg_0]
		xor	edi, edi
		call	_BIO_new_file
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_26C
		push	[esp+8+arg_4]
		push	edi
		push	edi
		push	esi
		call	_PEM_read_bio_PrivateKey
		add	esp, 10h
		mov	edi, eax

$end$7_0:
		test	edi, edi
		jnz	short loc_289

loc_26C:				; CODE XREF: _TS_CONF_load_key+19j
		push	[esp+8+arg_0]
		push	offset ??_C@_0CA@GMLNBFGN@unable?5to?5load?5private?5key?3?5?$CFs?6?$AA@ ; "unable to load private key:	%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch

loc_289:				; CODE XREF: _TS_CONF_load_key+2Ej
		push	esi
		call	_BIO_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_TS_CONF_load_key endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 298h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_TS_CONF_lookup_fail proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		retn
_TS_CONF_lookup_fail endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_accuracy
_TS_CONF_set_accuracy proc near

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 10h
		call	__chkstk
		push	ebx
		mov	ebx, [esp+14h+arg_4]
		push	ebp
		push	esi
		push	edi
		push	offset ??_C@_08FJNPIHOL@accuracy?$AA@ ;	"accuracy"
		xor	edi, edi
		xor	esi, esi
		push	ebx
		push	[esp+28h+arg_0]
		xor	ebp, ebp
		mov	[esp+2Ch+var_10], edi
		mov	[esp+2Ch+var_4], edi
		mov	[esp+2Ch+var_8], edi
		mov	[esp+2Ch+var_C], esi
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_331
		push	eax
		call	_X509V3_parse_list
		mov	esi, eax
		add	esp, 4
		mov	[esp+20h+var_C], esi
		test	esi, esi
		jnz	short loc_331
		push	offset ??_C@_08FJNPIHOL@accuracy?$AA@ ;	"accuracy"
		push	ebx
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	$err$42
; ---------------------------------------------------------------------------

loc_331:				; CODE XREF: _TS_CONF_set_accuracy+3Cj
					; _TS_CONF_set_accuracy+4Fj
		push	esi
		xor	ebx, ebx
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_442
		mov	ebp, dword ptr ds:__imp__atoi
		xchg	ax, ax

loc_34C:				; CODE XREF: _TS_CONF_set_accuracy+17Ej
		push	ebx
		push	esi
		call	_sk_value
		mov	edi, eax
		add	esp, 8
		mov	ecx, offset ??_C@_04MFNEMKIA@secs?$AA@ ; "secs"
		mov	esi, [edi+4]
		mov	eax, esi

loc_362:				; CODE XREF: _TS_CONF_set_accuracy+C0j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_382
		test	dl, dl
		jz	short loc_37E
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_382
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_362

loc_37E:				; CODE XREF: _TS_CONF_set_accuracy+AEj
		xor	eax, eax
		jmp	short loc_387
; ---------------------------------------------------------------------------

loc_382:				; CODE XREF: _TS_CONF_set_accuracy+AAj
					; _TS_CONF_set_accuracy+B6j
		sbb	eax, eax
		or	eax, 1

loc_387:				; CODE XREF: _TS_CONF_set_accuracy+C4j
		test	eax, eax
		jnz	short loc_3A7
		mov	eax, [edi+8]
		test	eax, eax
		jz	loc_426
		push	eax		; Str
		call	ebp ; __imp__atoi
		mov	edi, eax
		add	esp, 4
		mov	[esp+20h+var_10], edi
		jmp	loc_42A
; ---------------------------------------------------------------------------

loc_3A7:				; CODE XREF: _TS_CONF_set_accuracy+CDj
		mov	ecx, offset ??_C@_09NAAMCACD@millisecs?$AA@ ; "millisecs"
		mov	eax, esi

loc_3AE:				; CODE XREF: _TS_CONF_set_accuracy+10Cj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_3CE
		test	dl, dl
		jz	short loc_3CA
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_3CE
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_3AE

loc_3CA:				; CODE XREF: _TS_CONF_set_accuracy+FAj
		xor	eax, eax
		jmp	short loc_3D3
; ---------------------------------------------------------------------------

loc_3CE:				; CODE XREF: _TS_CONF_set_accuracy+F6j
					; _TS_CONF_set_accuracy+102j
		sbb	eax, eax
		or	eax, 1

loc_3D3:				; CODE XREF: _TS_CONF_set_accuracy+110j
		test	eax, eax
		jnz	short loc_3E7
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_426
		push	eax		; Str
		call	ebp ; __imp__atoi
		mov	[esp+24h+var_4], eax
		jmp	short loc_423
; ---------------------------------------------------------------------------

loc_3E7:				; CODE XREF: _TS_CONF_set_accuracy+119j
		mov	eax, offset ??_C@_09OIJEDGAB@microsecs?$AA@ ; "microsecs"

loc_3EC:				; CODE XREF: _TS_CONF_set_accuracy+14Aj
		mov	cl, [esi]
		cmp	cl, [eax]
		jnz	short loc_40C
		test	cl, cl
		jz	short loc_408
		mov	cl, [esi+1]
		cmp	cl, [eax+1]
		jnz	short loc_40C
		add	esi, 2
		add	eax, 2
		test	cl, cl
		jnz	short loc_3EC

loc_408:				; CODE XREF: _TS_CONF_set_accuracy+138j
		xor	eax, eax
		jmp	short loc_411
; ---------------------------------------------------------------------------

loc_40C:				; CODE XREF: _TS_CONF_set_accuracy+134j
					; _TS_CONF_set_accuracy+140j
		sbb	eax, eax
		or	eax, 1

loc_411:				; CODE XREF: _TS_CONF_set_accuracy+14Ej
		test	eax, eax
		jnz	short loc_47C
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_426
		push	eax		; Str
		call	ebp ; __imp__atoi
		mov	[esp+24h+var_8], eax

loc_423:				; CODE XREF: _TS_CONF_set_accuracy+129j
		add	esp, 4

loc_426:				; CODE XREF: _TS_CONF_set_accuracy+D4j
					; _TS_CONF_set_accuracy+120j ...
		mov	edi, [esp+20h+var_10]

loc_42A:				; CODE XREF: _TS_CONF_set_accuracy+E6j
		mov	esi, [esp+20h+var_C]
		inc	ebx
		push	esi
		call	_sk_num
		add	esp, 4
		cmp	ebx, eax
		jl	loc_34C
		xor	ebp, ebp

loc_442:				; CODE XREF: _TS_CONF_set_accuracy+82j
		push	[esp+20h+var_8]
		push	[esp+24h+var_4]
		push	edi
		push	[esp+2Ch+arg_8]
		call	_TS_RESP_CTX_set_accuracy
		add	esp, 10h
		mov	ecx, 1
		test	eax, eax
		cmovnz	ebp, ecx

$err$42:				; CODE XREF: _TS_CONF_set_accuracy+70j
					; _TS_CONF_set_accuracy+1E4j
		push	offset _X509V3_conf_free
		push	[esp+24h+var_C]
		call	_sk_pop_free
		add	esp, 8
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_47C:				; CODE XREF: _TS_CONF_set_accuracy+157j
		push	offset ??_C@_08FJNPIHOL@accuracy?$AA@ ;	"accuracy"
		push	[esp+24h+arg_4]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		xor	ebp, ebp
		jmp	short $err$42
_TS_CONF_set_accuracy endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_certs
_TS_CONF_set_certs proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		test	eax, eax
		jnz	short loc_4CB
		push	offset ??_C@_05HFDFJDL@certs?$AA@ ; "certs"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jz	short $end$9

loc_4CB:				; CODE XREF: _TS_CONF_set_certs+Cj
		push	eax
		call	_TS_CONF_load_certs
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short $err$10_0
		push	esi
		push	[esp+0Ch+arg_C]
		call	_TS_RESP_CTX_set_certs
		add	esp, 8
		test	eax, eax
		jz	short $err$10_0

$end$9:					; CODE XREF: _TS_CONF_set_certs+25j
		mov	edi, 1

$err$10_0:				; CODE XREF: _TS_CONF_set_certs+34j
					; _TS_CONF_set_certs+45j
		push	offset _X509_free
		push	esi
		call	_sk_pop_free
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_TS_CONF_set_certs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 504h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_clock_precision_digits
_TS_CONF_set_clock_precision_digits proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		lea	eax, [esp+4+var_4]
		mov	[esp+4+var_4], 0
		push	eax
		push	offset ??_C@_0BH@EJNOCJMO@clock_precision_digits?$AA@ ;	"clock_precision_digits"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_NCONF_get_number_e
		add	esp, 10h
		test	eax, eax
		jnz	short loc_537
		mov	[esp+4+var_4], eax
		jmp	short loc_543
; ---------------------------------------------------------------------------

loc_537:				; CODE XREF: _TS_CONF_set_clock_precision_digits+2Cj
		mov	eax, [esp+4+var_4]
		test	eax, eax
		js	short loc_55B
		cmp	eax, 6
		jg	short loc_55B

loc_543:				; CODE XREF: _TS_CONF_set_clock_precision_digits+31j
		push	eax
		push	[esp+8+arg_8]
		call	_TS_RESP_CTX_set_clock_precision_digits
		add	esp, 8
		test	eax, eax
		jz	short $err$12_0
		mov	eax, 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_55B:				; CODE XREF: _TS_CONF_set_clock_precision_digits+38j
					; _TS_CONF_set_clock_precision_digits+3Dj
		push	offset ??_C@_0BH@EJNOCJMO@clock_precision_digits?$AA@ ;	"clock_precision_digits"
		push	[esp+8+arg_4]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h

$err$12_0:				; CODE XREF: _TS_CONF_set_clock_precision_digits+4Ej
		xor	eax, eax
		pop	ecx
		retn
_TS_CONF_set_clock_precision_digits endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 584h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_crypto_device
_TS_CONF_set_crypto_device proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jnz	short loc_5A5
		push	offset ??_C@_0O@PGIIDHAM@crypto_device?$AA@ ; "crypto_device"
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_5D7

loc_5A5:				; CODE XREF: _TS_CONF_set_crypto_device+6j
		push	eax
		call	_TS_CONF_set_default_engine
		add	esp, 4
		test	eax, eax
		jnz	short loc_5D7
		push	offset ??_C@_0O@PGIIDHAM@crypto_device?$AA@ ; "crypto_device"
		push	[esp+4+arg_4]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_5D7:				; CODE XREF: _TS_CONF_set_crypto_device+1Fj
					; _TS_CONF_set_crypto_device+2Cj
		mov	eax, 1

$err$9:
		retn
_TS_CONF_set_crypto_device endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_def_policy
_TS_CONF_set_def_policy	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		test	eax, eax
		jnz	short loc_637
		push	offset ??_C@_0P@CLFMIJGD@default_policy?$AA@ ; "default_policy"
		push	ebx
		push	[esp+14h+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_637
		push	offset ??_C@_0P@CLFMIJGD@default_policy?$AA@ ; "default_policy"
		push	ebx
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		push	esi
		call	_ASN1_OBJECT_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_637:				; CODE XREF: _TS_CONF_set_def_policy+11j
					; _TS_CONF_set_def_policy+27j
		push	0
		push	eax
		call	_OBJ_txt2obj
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_676
		push	offset ??_C@_0P@CLFMIJGD@default_policy?$AA@ ; "default_policy"
		push	ebx
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		push	esi
		call	_ASN1_OBJECT_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_676:				; CODE XREF: _TS_CONF_set_def_policy+66j
		push	esi
		push	[esp+10h+arg_C]
		call	_TS_RESP_CTX_set_def_policy
		add	esp, 8
		mov	ecx, 1
		test	eax, eax

$err$12:
		cmovnz	edi, ecx
		push	esi
		call	_ASN1_OBJECT_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
_TS_CONF_set_def_policy	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 69Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_default_engine
_TS_CONF_set_default_engine proc near	; CODE XREF: _TS_CONF_set_crypto_device+22p

arg_0		= dword	ptr  4

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_0]
		xor	ebx, ebx
		mov	eax, offset ??_C@_07JNFPDNEP@builtin?$AA@ ; "builtin"
		mov	ecx, edi
		nop

loc_6AC:				; CODE XREF: _TS_CONF_set_default_engine+2Aj
		mov	dl, [ecx]
		cmp	dl, [eax]
		jnz	short loc_6CC
		test	dl, dl
		jz	short loc_6C8
		mov	dl, [ecx+1]
		cmp	dl, [eax+1]
		jnz	short loc_6CC
		add	ecx, 2
		add	eax, 2
		test	dl, dl
		jnz	short loc_6AC

loc_6C8:				; CODE XREF: _TS_CONF_set_default_engine+18j
		xor	eax, eax
		jmp	short loc_6D1
; ---------------------------------------------------------------------------

loc_6CC:				; CODE XREF: _TS_CONF_set_default_engine+14j
					; _TS_CONF_set_default_engine+20j
		sbb	eax, eax
		or	eax, 1

loc_6D1:				; CODE XREF: _TS_CONF_set_default_engine+2Ej
		test	eax, eax
		jnz	short loc_6DD
		pop	edi
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_6DD:				; CODE XREF: _TS_CONF_set_default_engine+37j
		push	esi
		push	edi
		call	_ENGINE_by_id
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_745
		mov	ecx, offset ??_C@_04JHJDAOJH@chil?$AA@ ; "chil"
		mov	eax, edi

loc_6F4:				; CODE XREF: _TS_CONF_set_default_engine+72j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_714
		test	dl, dl
		jz	short loc_710
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_714
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_6F4

loc_710:				; CODE XREF: _TS_CONF_set_default_engine+60j
		xor	eax, eax
		jmp	short loc_719
; ---------------------------------------------------------------------------

loc_714:				; CODE XREF: _TS_CONF_set_default_engine+5Cj
					; _TS_CONF_set_default_engine+68j
		sbb	eax, eax
		or	eax, 1

loc_719:				; CODE XREF: _TS_CONF_set_default_engine+76j
		test	eax, eax
		jnz	short loc_72C
		push	eax
		push	eax
		push	1
		push	64h ; 'd'
		push	esi
		call	_ENGINE_ctrl
		add	esp, 14h

loc_72C:				; CODE XREF: _TS_CONF_set_default_engine+7Fj
		push	0FFFFh
		push	esi
		call	_ENGINE_set_default
		add	esp, 8
		test	eax, eax
		jz	short loc_745
		mov	ebx, 1
		jmp	short loc_76D
; ---------------------------------------------------------------------------

loc_745:				; CODE XREF: _TS_CONF_set_default_engine+4Fj
					; _TS_CONF_set_default_engine+A0j
		push	0E6h ; 'æ'
		push	offset ??_C@_0BG@LDOFGBPN@?4?2crypto?2ts?2ts_conf?4c?$AA@ ; ".\\crypto\\ts\\ts_conf.c"
		push	7Fh ; ''
		push	92h ; '’'
		push	2Fh ; '/'
		call	_ERR_put_error
		push	edi
		push	offset ??_C@_07OIMAMEKN@engine?3?$AA@ ;	"engine:"
		push	2
		call	_ERR_add_error_data
		add	esp, 20h

loc_76D:				; CODE XREF: _TS_CONF_set_default_engine+A7j
		test	esi, esi
		jz	short loc_77A
		push	esi
		call	_ENGINE_free
		add	esp, 4

loc_77A:				; CODE XREF: _TS_CONF_set_default_engine+D3j
		pop	esi
		pop	edi
		mov	eax, ebx
		pop	ebx
		retn
_TS_CONF_set_default_engine endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 780h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_digests
_TS_CONF_set_digests proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		push	ebx
		mov	ebx, [esp+8+arg_4]
		push	edi
		push	offset ??_C@_07LKBBKFPF@digests?$AA@ ; "digests"
		push	ebx
		push	[esp+14h+arg_0]
		mov	[esp+18h+var_4], 0
		xor	edi, edi
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_7D4
		push	offset ??_C@_07LKBBKFPF@digests?$AA@ ; "digests"
		push	ebx
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	$err$31
; ---------------------------------------------------------------------------

loc_7D4:				; CODE XREF: _TS_CONF_set_digests+2Ej
		push	eax
		call	_X509V3_parse_list
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_804

loc_7E3:				; CODE XREF: _TS_CONF_set_digests+8Fj
		push	offset ??_C@_07LKBBKFPF@digests?$AA@ ; "digests"
		push	ebx
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	short $err$31
; ---------------------------------------------------------------------------

loc_804:				; CODE XREF: _TS_CONF_set_digests+61j
		push	edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jz	short loc_7E3
		push	ebp
		push	esi
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_863
		mov	ebp, [esp+14h+arg_8]

loc_826:				; CODE XREF: _TS_CONF_set_digests+E1j
		push	esi
		push	edi
		call	_sk_value
		add	esp, 8
		mov	ecx, [eax+8]
		test	ecx, ecx
		jnz	short loc_83A
		mov	ecx, [eax+4]

loc_83A:				; CODE XREF: _TS_CONF_set_digests+B5j
		push	ecx
		call	_EVP_get_digestbyname
		add	esp, 4
		test	eax, eax
		jz	short loc_883
		push	eax
		push	ebp
		call	_TS_RESP_CTX_add_md
		add	esp, 8
		test	eax, eax
		jz	short loc_86B
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_826

loc_863:				; CODE XREF: _TS_CONF_set_digests+A0j
		mov	[esp+14h+var_4], 1

loc_86B:				; CODE XREF: _TS_CONF_set_digests+D3j
					; _TS_CONF_set_digests+122j
		pop	esi
		pop	ebp

$err$31:				; CODE XREF: _TS_CONF_set_digests+4Fj
					; _TS_CONF_set_digests+82j
		push	offset _X509V3_conf_free
		push	edi
		call	_sk_pop_free
		mov	eax, [esp+14h+var_4]
		add	esp, 8
		pop	edi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_883:				; CODE XREF: _TS_CONF_set_digests+C5j
		push	offset ??_C@_07LKBBKFPF@digests?$AA@ ; "digests"
		push	ebx
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	short loc_86B
_TS_CONF_set_digests endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_ess_cert_id_chain
_TS_CONF_set_ess_cert_id_chain proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_8]
		push	4
		push	offset ??_C@_0BC@MEINGLKO@ess_cert_id_chain?$AA@ ; "ess_cert_id_chain"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_TS_CONF_add_flag
		add	esp, 14h
		retn
_TS_CONF_set_ess_cert_id_chain endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_ordering
_TS_CONF_set_ordering proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_8]
		push	2
		push	offset ??_C@_08POFANFLK@ordering?$AA@ ;	"ordering"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_TS_CONF_add_flag
		add	esp, 14h
		retn
_TS_CONF_set_ordering endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_policies
_TS_CONF_set_policies proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		xor	ebx, ebx
		push	offset ??_C@_0P@IPDOPNMP@other_policies?$AA@ ; "other_policies"
		push	ebp
		push	[esp+14h+arg_0]
		mov	[esp+18h+var_4], 0
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_93C
		push	eax
		call	_X509V3_parse_list
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_93C
		push	offset ??_C@_0P@IPDOPNMP@other_policies?$AA@ ; "other_policies"
		push	ebp
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	short $err$24
; ---------------------------------------------------------------------------

loc_93C:				; CODE XREF: _TS_CONF_set_policies+2Ej
					; _TS_CONF_set_policies+3Dj
		push	esi
		push	edi
		push	ebx
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_99A
		mov	ebp, [esp+14h+arg_8]

loc_951:				; CODE XREF: _TS_CONF_set_policies+BCj
		push	edi
		push	ebx
		call	_sk_value
		mov	ecx, eax
		add	esp, 8
		mov	eax, [ecx+8]
		test	eax, eax
		jnz	short loc_967
		mov	eax, [ecx+4]

loc_967:				; CODE XREF: _TS_CONF_set_policies+86j
		push	0
		push	eax
		call	_OBJ_txt2obj
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_9BA
		push	esi
		push	ebp
		call	_TS_RESP_CTX_add_policy
		add	esp, 8
		test	eax, eax
		jz	short loc_9A2
		push	esi
		call	_ASN1_OBJECT_free
		push	ebx
		inc	edi
		call	_sk_num
		add	esp, 8
		cmp	edi, eax
		jl	short loc_951

loc_99A:				; CODE XREF: _TS_CONF_set_policies+6Fj
		mov	[esp+14h+var_4], 1

loc_9A2:				; CODE XREF: _TS_CONF_set_policies+A8j
					; _TS_CONF_set_policies+100j
		pop	edi
		pop	esi

$err$24:				; CODE XREF: _TS_CONF_set_policies+5Ej
		push	offset _X509V3_conf_free
		push	ebx
		call	_sk_pop_free
		mov	eax, [esp+14h+var_4]
		add	esp, 8
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_9BA:				; CODE XREF: _TS_CONF_set_policies+9Aj
		push	offset ??_C@_0P@IPDOPNMP@other_policies?$AA@ ; "other_policies"
		push	[esp+18h+arg_4]
		push	offset ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@	; "invalid variable value for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	short loc_9A2
_TS_CONF_set_policies endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_serial
_TS_CONF_set_serial proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	offset ??_C@_06KCELPKEE@serial?$AA@ ; "serial"
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_A1E
		push	offset ??_C@_06KCELPKEE@serial?$AA@ ; "serial"
		push	[esp+4+arg_4]
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A1E:				; CODE XREF: _TS_CONF_set_serial+17j
		push	eax
		push	[esp+4+arg_8]
		push	[esp+8+arg_C]
		call	_TS_RESP_CTX_set_serial_cb
		add	esp, 0Ch
		mov	eax, 1

$err$7:
		retn
_TS_CONF_set_serial endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A38h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_signer_cert
_TS_CONF_set_signer_cert proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		test	eax, eax
		jnz	short loc_A8F
		push	offset ??_C@_0M@ILJFFIIJ@signer_cert?$AA@ ; "signer_cert"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_A8F
		push	offset ??_C@_0M@ILJFFIIJ@signer_cert?$AA@ ; "signer_cert"
		push	[esp+0Ch+arg_4]
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		push	esi
		call	_X509_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_A8F:				; CODE XREF: _TS_CONF_set_signer_cert+Cj
					; _TS_CONF_set_signer_cert+25j
		push	eax
		call	_TS_CONF_load_cert
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short $err$10
		push	esi
		push	[esp+0Ch+arg_C]
		call	_TS_RESP_CTX_set_signer_cert
		add	esp, 8
		mov	ecx, 1
		test	eax, eax
		cmovnz	edi, ecx

$err$10:				; CODE XREF: _TS_CONF_set_signer_cert+64j
		push	esi
		call	_X509_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_TS_CONF_set_signer_cert endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AC4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_signer_key
_TS_CONF_set_signer_key	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_8]
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		test	eax, eax
		jnz	short loc_B1B
		push	offset ??_C@_0L@FKMICHFL@signer_key?$AA@ ; "signer_key"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_B1B
		push	offset ??_C@_0L@FKMICHFL@signer_key?$AA@ ; "signer_key"
		push	[esp+0Ch+arg_4]
		push	offset ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@	; "variable lookup failed for %s::%s\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_B1B:				; CODE XREF: _TS_CONF_set_signer_key+Cj
					; _TS_CONF_set_signer_key+25j
		push	[esp+8+arg_C]
		push	eax
		call	_TS_CONF_load_key
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short $err$10_1
		push	esi
		push	[esp+0Ch+arg_10]
		call	_TS_RESP_CTX_set_signer_key
		add	esp, 8
		mov	ecx, 1
		test	eax, eax
		cmovnz	edi, ecx

$err$10_1:				; CODE XREF: _TS_CONF_set_signer_key+68j
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_TS_CONF_set_signer_key	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _TS_CONF_set_tsa_name
_TS_CONF_set_tsa_name proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_8]
		push	1
		push	offset ??_C@_08LLGCIMFD@tsa_name?$AA@ ;	"tsa_name"
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_TS_CONF_add_flag
		add	esp, 14h
		retn
_TS_CONF_set_tsa_name endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B70h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; _fprintf+Fp
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B78h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B9Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _TS_CONF_add_flag+A7p
					; _TS_CONF_get_tsa_section+40p	...

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BC0h
; COMDAT (pick any)
		public ??_C@_01KDCPPGHE@r?$AA@
; `string'
??_C@_01KDCPPGHE@r?$AA@	db 72h,	0	; DATA XREF: _TS_CONF_load_cert+2o
					; _TS_CONF_load_certs+14o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BC4h
; COMDAT (pick any)
		public ??_C@_0CA@IKGCPJI@unable?5to?5load?5certificate?3?5?$CFs?6?$AA@
; char `string'[]
??_C@_0CA@IKGCPJI@unable?5to?5load?5certificate?3?5?$CFs?6?$AA@	db 'unable to load certificate: %s',0Ah,0
					; DATA XREF: _TS_CONF_load_cert+31o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BE4h
; COMDAT (pick any)
		public ??_C@_0CB@KELMIFF@unable?5to?5load?5certificates?3?5?$CFs?6@
; char `string'[]
??_C@_0CB@KELMIFF@unable?5to?5load?5certificates?3?5?$CFs?6@ db	'unable to load certificates: %s',0Ah,0
					; DATA XREF: _TS_CONF_load_certs+8Ao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C08h
; COMDAT (pick any)
		public ??_C@_0CA@GMLNBFGN@unable?5to?5load?5private?5key?3?5?$CFs?6?$AA@
; char `string'[]
??_C@_0CA@GMLNBFGN@unable?5to?5load?5private?5key?3?5?$CFs?6?$AA@ db 'unable to load private key: %s',0Ah,0
					; DATA XREF: _TS_CONF_load_key+34o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C28h
; COMDAT (pick any)
		public ??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@
; char `string'[]
??_C@_0CD@NEOGLMMJ@variable?5lookup?5failed?5for?5?$CFs?3?3?$CF@ db 'variable lookup failed for %s::%s',0Ah,0
					; DATA XREF: _TS_CONF_get_tsa_section+2Fo
					; _TS_CONF_lookup_fail+8o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C4Ch
; COMDAT (pick any)
		public ??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@
; char `string'[]
??_C@_0CD@LBPCLBFA@invalid?5variable?5value?5for?5?$CFs?3?3?$CF@ db 'invalid variable value for %s::%s',0Ah,0
					; DATA XREF: _TS_CONF_add_flag+96o
					; _TS_CONF_invalid+8o ...
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C70h
; COMDAT (pick any)
		public ??_C@_0M@FFEGKAMB@default_tsa?$AA@
; `string'
??_C@_0M@FFEGKAMB@default_tsa?$AA@ db 'default_tsa',0
					; DATA XREF: _TS_CONF_get_tsa_section+9o
					; _TS_CONF_get_tsa_section+25o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C7Ch
; COMDAT (pick any)
		public ??_C@_03BALHJLMH@tsa?$AA@
; `string'
??_C@_03BALHJLMH@tsa?$AA@ db 'tsa',0    ; DATA XREF: _TS_CONF_get_tsa_section+Eo
					; _TS_CONF_get_tsa_section+2Ao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C80h
; COMDAT (pick any)
		public ??_C@_06KCELPKEE@serial?$AA@
; `string'
??_C@_06KCELPKEE@serial?$AA@ db	'serial',0 ; DATA XREF: _TS_CONF_set_serialo
					; _TS_CONF_set_serial+19o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C88h
; COMDAT (pick any)
		public ??_C@_0O@PGIIDHAM@crypto_device?$AA@
; `string'
??_C@_0O@PGIIDHAM@crypto_device?$AA@ db	'crypto_device',0
					; DATA XREF: _TS_CONF_set_crypto_device+8o
					; _TS_CONF_set_crypto_device+2Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C98h
; COMDAT (pick any)
		public ??_C@_07JNFPDNEP@builtin?$AA@
; `string'
??_C@_07JNFPDNEP@builtin?$AA@ db 'builtin',0 ; DATA XREF: _TS_CONF_set_default_engine+8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CA0h
; COMDAT (pick any)
		public ??_C@_04JHJDAOJH@chil?$AA@
; `string'
??_C@_04JHJDAOJH@chil?$AA@ db 'chil',0  ; DATA XREF: _TS_CONF_set_default_engine+51o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CA8h
; COMDAT (pick any)
		public ??_C@_0BG@LDOFGBPN@?4?2crypto?2ts?2ts_conf?4c?$AA@
; `string'
??_C@_0BG@LDOFGBPN@?4?2crypto?2ts?2ts_conf?4c?$AA@ db '.\crypto\ts\ts_conf.c',0
					; DATA XREF: _TS_CONF_set_default_engine+AEo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CC0h
; COMDAT (pick any)
		public ??_C@_07OIMAMEKN@engine?3?$AA@
; `string'
??_C@_07OIMAMEKN@engine?3?$AA@ db 'engine:',0 ; DATA XREF: _TS_CONF_set_default_engine+C2o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CC8h
; COMDAT (pick any)
		public ??_C@_0M@ILJFFIIJ@signer_cert?$AA@
; `string'
??_C@_0M@ILJFFIIJ@signer_cert?$AA@ db 'signer_cert',0
					; DATA XREF: _TS_CONF_set_signer_cert+Eo
					; _TS_CONF_set_signer_cert+27o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CD4h
; COMDAT (pick any)
		public ??_C@_05HFDFJDL@certs?$AA@
; `string'
??_C@_05HFDFJDL@certs?$AA@ db 'certs',0 ; DATA XREF: _TS_CONF_set_certs+Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CDCh
; COMDAT (pick any)
		public ??_C@_0L@FKMICHFL@signer_key?$AA@
; `string'
??_C@_0L@FKMICHFL@signer_key?$AA@ db 'signer_key',0 ; DATA XREF: _TS_CONF_set_signer_key+Eo
					; _TS_CONF_set_signer_key+27o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CE8h
; COMDAT (pick any)
		public ??_C@_0P@CLFMIJGD@default_policy?$AA@
; `string'
??_C@_0P@CLFMIJGD@default_policy?$AA@ db 'default_policy',0
					; DATA XREF: _TS_CONF_set_def_policy+13o
					; _TS_CONF_set_def_policy+29o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CF8h
; COMDAT (pick any)
		public ??_C@_0P@IPDOPNMP@other_policies?$AA@
; `string'
??_C@_0P@IPDOPNMP@other_policies?$AA@ db 'other_policies',0
					; DATA XREF: _TS_CONF_set_policies+12o
					; _TS_CONF_set_policies+3Fo ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D08h
; COMDAT (pick any)
		public ??_C@_07LKBBKFPF@digests?$AA@
; `string'
??_C@_07LKBBKFPF@digests?$AA@ db 'digests',0 ; DATA XREF: _TS_CONF_set_digests+10o
					; _TS_CONF_set_digests+30o ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D10h
; COMDAT (pick any)
		public ??_C@_08FJNPIHOL@accuracy?$AA@
; `string'
??_C@_08FJNPIHOL@accuracy?$AA@ db 'accuracy',0 ; DATA XREF: _TS_CONF_set_accuracy+12o
					; _TS_CONF_set_accuracy+51o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D1Ch
; COMDAT (pick any)
		public ??_C@_04MFNEMKIA@secs?$AA@
; `string'
??_C@_04MFNEMKIA@secs?$AA@ db 'secs',0  ; DATA XREF: _TS_CONF_set_accuracy+9Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D24h
; COMDAT (pick any)
		public ??_C@_09NAAMCACD@millisecs?$AA@
; `string'
??_C@_09NAAMCACD@millisecs?$AA@	db 'millisecs',0 ; DATA XREF: _TS_CONF_set_accuracy:loc_3A7o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D30h
; COMDAT (pick any)
		public ??_C@_09OIJEDGAB@microsecs?$AA@
; `string'
??_C@_09OIJEDGAB@microsecs?$AA@	db 'microsecs',0 ; DATA XREF: _TS_CONF_set_accuracy:loc_3E7o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D3Ch
; COMDAT (pick any)
		public ??_C@_0BH@EJNOCJMO@clock_precision_digits?$AA@
; `string'
??_C@_0BH@EJNOCJMO@clock_precision_digits?$AA@ db 'clock_precision_digits',0
					; DATA XREF: _TS_CONF_set_clock_precision_digits+15o
					; _TS_CONF_set_clock_precision_digits:loc_55Bo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D54h
; COMDAT (pick any)
		public ??_C@_03ICICOMAL@yes?$AA@
; `string'
??_C@_03ICICOMAL@yes?$AA@ dd 736579h	; DATA XREF: _TS_CONF_add_flag+1Ao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D58h
; COMDAT (pick any)
		public ??_C@_02KAJCLHKP@no?$AA@
; `string'
??_C@_02KAJCLHKP@no?$AA@ db 6Eh, 6Fh, 0	; DATA XREF: _TS_CONF_add_flag:loc_60o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D5Ch
; COMDAT (pick any)
		public ??_C@_08POFANFLK@ordering?$AA@
; `string'
??_C@_08POFANFLK@ordering?$AA@ db 'ordering',0 ; DATA XREF: _TS_CONF_set_ordering+6o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D68h
; COMDAT (pick any)
		public ??_C@_08LLGCIMFD@tsa_name?$AA@
; `string'
??_C@_08LLGCIMFD@tsa_name?$AA@ db 'tsa_name',0 ; DATA XREF: _TS_CONF_set_tsa_name+6o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D74h
; COMDAT (pick any)
		public ??_C@_0BC@MEINGLKO@ess_cert_id_chain?$AA@
; `string'
??_C@_0BC@MEINGLKO@ess_cert_id_chain?$AA@ db 'ess_cert_id_chain',0
					; DATA XREF: _TS_CONF_set_ess_cert_id_chain+6o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; int __cdecl _atoi(const char *Str)
		extrn __imp__atoi:near	; CODE XREF: _TS_CONF_set_accuracy+DBp
					; _TS_CONF_set_accuracy+123p ...
		extrn __imp____acrt_iob_func:near ; CODE XREF: _TS_CONF_add_flag+9Dp
					; _TS_CONF_get_tsa_section+36p	...
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p
					; DATA XREF: ...
		extrn _sk_num:near	; CODE XREF: _TS_CONF_load_certs+47p
					; _TS_CONF_load_certs+77p ...
		extrn _sk_value:near	; CODE XREF: _TS_CONF_load_certs+55p
					; _TS_CONF_set_accuracy+92p ...
		extrn _sk_new_null:near	; CODE XREF: _TS_CONF_load_certs+2Ep
		extrn _sk_pop_free:near	; CODE XREF: _TS_CONF_load_certs+A9p
					; _TS_CONF_set_accuracy+1AEp ...
		extrn _sk_push:near	; CODE XREF: _TS_CONF_load_certs+67p
		extrn _BIO_new_file:near ; CODE	XREF: _TS_CONF_load_cert+Dp
					; _TS_CONF_load_certs+1Cp ...
		extrn _BIO_free:near	; CODE XREF: _TS_CONF_load_cert+4Bp
					; _TS_CONF_load_certs+AFp ...
		extrn _ERR_put_error:near ; CODE XREF: _TS_CONF_set_default_engine+BCp
		extrn _ERR_add_error_data:near ; CODE XREF: _TS_CONF_set_default_engine+C9p
		extrn _ASN1_OBJECT_free:near ; CODE XREF: _TS_CONF_set_def_policy+49p
					; _TS_CONF_set_def_policy+88p ...
		extrn _OBJ_txt2obj:near	; CODE XREF: _TS_CONF_set_def_policy+5Ap
					; _TS_CONF_set_policies+8Ep
		extrn _EVP_get_digestbyname:near ; CODE	XREF: _TS_CONF_set_digests+BBp
		extrn _EVP_PKEY_free:near ; CODE XREF: _TS_CONF_set_signer_key+4Ap
					; _TS_CONF_set_signer_key+82p
		extrn _X509_free:near	; CODE XREF: _TS_CONF_set_signer_cert+4Ap
					; _TS_CONF_set_signer_cert+7Ep
					; DATA XREF: ...
		extrn _X509_INFO_free:near ; DATA XREF:	_TS_CONF_load_certs:loc_21Fo
		extrn _PEM_X509_INFO_read_bio:near ; CODE XREF:	_TS_CONF_load_certs+3Dp
		extrn _PEM_read_bio_X509_AUX:near ; CODE XREF: _TS_CONF_load_cert+1Fp
		extrn _PEM_read_bio_PrivateKey:near ; CODE XREF: _TS_CONF_load_key+22p
		extrn _ENGINE_by_id:near ; CODE	XREF: _TS_CONF_set_default_engine+43p
		extrn _ENGINE_ctrl:near	; CODE XREF: _TS_CONF_set_default_engine+88p
		extrn _ENGINE_free:near	; CODE XREF: _TS_CONF_set_default_engine+D6p
		extrn _ENGINE_set_default:near ; CODE XREF: _TS_CONF_set_default_engine+96p
		extrn _NCONF_get_string:near ; CODE XREF: _TS_CONF_add_flag+Cp
					; _TS_CONF_get_tsa_section+17p	...
		extrn _NCONF_get_number_e:near
					; CODE XREF: _TS_CONF_set_clock_precision_digits+22p
		extrn _X509V3_conf_free:near ; DATA XREF: _TS_CONF_set_accuracy:$err$42o
					; _TS_CONF_set_digests:$err$31o ...
		extrn _X509V3_parse_list:near ;	CODE XREF: _TS_CONF_set_accuracy+3Fp
					; _TS_CONF_set_digests+55p ...
		extrn _TS_RESP_CTX_set_signer_cert:near
					; CODE XREF: _TS_CONF_set_signer_cert+6Bp
		extrn _TS_RESP_CTX_set_signer_key:near
					; CODE XREF: _TS_CONF_set_signer_key+6Fp
		extrn _TS_RESP_CTX_set_def_policy:near
					; CODE XREF: _TS_CONF_set_def_policy+9Bp
		extrn _TS_RESP_CTX_set_certs:near ; CODE XREF: _TS_CONF_set_certs+3Bp
		extrn _TS_RESP_CTX_add_policy:near ; CODE XREF:	_TS_CONF_set_policies+9Ep
		extrn _TS_RESP_CTX_add_md:near ; CODE XREF: _TS_CONF_set_digests+C9p
		extrn _TS_RESP_CTX_set_accuracy:near ; CODE XREF: _TS_CONF_set_accuracy+193p
		extrn _TS_RESP_CTX_set_clock_precision_digits:near
					; CODE XREF: _TS_CONF_set_clock_precision_digits+44p
		extrn _TS_RESP_CTX_add_flags:near ; CODE XREF: _TS_CONF_add_flag+52p
		extrn _TS_RESP_CTX_set_serial_cb:near ;	CODE XREF: _TS_CONF_set_serial+47p
		extrn __chkstk:near	; CODE XREF: _TS_CONF_load_certs+5p
					; _TS_CONF_set_accuracy+5p ...
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso


		end
