;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	5912A9C5B3A098ECBD6CA7BA5CF27DCD
; Input	CRC32 :	E0CAA7EF

; File Name   :	C:\compspace\Diff\openssl\obj\e_4758cca.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_rsa_sign	proc near		; DATA XREF: .data:000007A0o

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, 70h ; 'p'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_C]
		push	ebx
		mov	ebx, [esp+74h+arg_14]
		push	ebp
		push	esi
		mov	esi, [esp+7Ch+arg_4]
		mov	[esp+7Ch+var_58], eax
		mov	eax, [esp+7Ch+arg_10]
		push	edi
		push	_hndidx

loc_3F:					; DATA XREF: .data:00000798o
		mov	edi, [esp+84h+arg_0]
		mov	[esp+84h+var_44], eax
		mov	eax, ds:??_C@_07FCKAMOFI@PKCS?91?41@ ; `string'
		mov	[esp+84h+var_14], eax
		mov	eax, ds:dword_19FC
		push	ebx
		mov	[esp+88h+var_48], 0

loc_61:					; DATA XREF: .data:_CCA4758_str_reasonso
					; .data:0000081Co ...
		mov	[esp+88h+var_4C], 1

loc_69:					; DATA XREF: .data:0000083Co
					; .data:00000844o ...
		mov	[esp+88h+var_10], eax

loc_6D:					; DATA XREF: .data:0000085Co
		mov	[esp+88h+var_6C], 100h
		call	_RSA_get_ex_data
		mov	ebp, [esp+88h+arg_8]
		add	esp, 8
		mov	[esp+80h+var_70], 24h ;	'$'
		mov	ecx, [eax]
		add	eax, 4
		mov	[esp+80h+var_50], ecx
		mov	[esp+80h+var_54], eax
		cmp	edi, 4
		jz	short loc_A7
		cmp	edi, 40h ; '@'
		jnz	loc_161

loc_A7:					; CODE XREF: _cca_rsa_sign+9Cj
		lea	eax, [esp+80h+var_30]
		push	edi
		mov	[esp+84h+var_68], eax
		call	_OBJ_nid2obj
		add	esp, 4
		mov	[esp+80h+var_30], eax
		test	eax, eax
		jnz	short loc_FF
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax

loc_C7:					; DATA XREF: .rdata:_cca4758_cmd_defnso
		jnz	short loc_D3
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_D3:					; CODE XREF: _cca_rsa_sign:loc_C7j
		push	2F1h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Dh ; 'm'

loc_DF:					; CODE XREF: _cca_rsa_sign+124j
					; _cca_rsa_sign+194j ...
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_EA:					; CODE XREF: _cca_rsa_sign+1AAj
					; _cca_rsa_sign+307j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+70h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_FF:					; CODE XREF: _cca_rsa_sign+BEj
		cmp	dword ptr [eax+0Ch], 0
		jnz	short loc_126
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_118
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_118:				; CODE XREF: _cca_rsa_sign+10Cj
		push	2F7h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	65h ; 'e'
		jmp	short loc_DF
; ---------------------------------------------------------------------------

loc_126:				; CODE XREF: _cca_rsa_sign+103j
		lea	eax, [esp+80h+var_38]
		mov	[esp+80h+var_38], 5
		mov	[esp+80h+var_2C], eax
		lea	eax, [esp+80h+var_24]
		mov	[esp+80h+var_64], eax
		lea	eax, [esp+80h+var_68]
		push	0
		push	eax
		mov	[esp+88h+var_34], 0
		mov	[esp+88h+var_1C], esi
		mov	[esp+88h+var_24], ebp
		call	_i2d_X509_SIG
		add	esp, 8
		mov	[esp+80h+var_70], eax

loc_161:				; CODE XREF: _cca_rsa_sign+A1j
		push	ebx
		call	_RSA_size
		mov	ecx, [esp+84h+var_70]
		mov	ebx, eax
		dec	ecx
		add	esp, 4
		cmp	ecx, ebx
		jle	short loc_199
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_188
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_188:				; CODE XREF: _cca_rsa_sign+17Cj
		push	30Ah
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		jmp	loc_DF
; ---------------------------------------------------------------------------

loc_199:				; CODE XREF: _cca_rsa_sign+173j
		cmp	edi, 4
		jz	loc_23E
		cmp	edi, 40h ; '@'
		jz	short loc_1ED
		cmp	edi, 72h ; 'r'
		jnz	loc_EA
		cmp	ebp, 24h ; '$'
		jz	short loc_1E0
		push	312h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		push	69h ; 'i'
		call	_ERR_CCA4758_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+70h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_1E0:				; CODE XREF: _cca_rsa_sign+1B3j
		mov	[esp+80h+var_70], 24h ;	'$'
		jmp	loc_294
; ---------------------------------------------------------------------------

loc_1ED:				; CODE XREF: _cca_rsa_sign+1A5j
		push	326h
		lea	eax, [ebx+1]
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+80h+var_60], esi
		test	esi, esi
		jnz	short loc_238
		push	328h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		push	69h ; 'i'
		call	_ERR_CCA4758_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+70h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_238:				; CODE XREF: _cca_rsa_sign+20Bj
		lea	eax, [esp+80h+var_60]
		jmp	short loc_286
; ---------------------------------------------------------------------------

loc_23E:				; CODE XREF: _cca_rsa_sign+19Cj
		push	31Bh
		lea	eax, [ebx+1]
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+80h+var_5C], esi
		test	esi, esi
		jnz	short loc_282
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_271
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_271:				; CODE XREF: _cca_rsa_sign+265j
		push	31Dh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		jmp	loc_DF
; ---------------------------------------------------------------------------

loc_282:				; CODE XREF: _cca_rsa_sign+25Cj
		lea	eax, [esp+80h+var_5C]

loc_286:				; CODE XREF: _cca_rsa_sign+23Cj
		push	eax
		lea	eax, [esp+84h+var_68]
		push	eax
		call	_i2d_X509_SIG
		add	esp, 8

loc_294:				; CODE XREF: _cca_rsa_sign+1E8j
		push	[esp+80h+var_58]
		lea	eax, [esp+84h+var_28]
		push	eax
		lea	eax, [esp+88h+var_6C]
		push	eax
		push	esi
		lea	eax, [esp+90h+var_70]
		push	eax
		push	[esp+94h+var_54]
		lea	eax, [esp+98h+var_50]
		push	eax
		lea	eax, [esp+9Ch+var_14]
		push	eax
		lea	eax, [esp+0A0h+var_4C]
		push	eax
		lea	eax, [esp+0A4h+var_C]
		push	eax
		lea	eax, [esp+0A8h+var_48]
		push	eax
		lea	eax, [esp+0ACh+var_3C]
		push	eax
		lea	eax, [esp+0B0h+var_40]
		push	eax
		call	ds:_digitalSignatureGenerate
		cmp	edi, 40h ; '@'
		jz	short loc_2E5
		cmp	edi, 4
		jnz	short loc_2F8

loc_2E5:				; CODE XREF: _cca_rsa_sign+2DEj
		lea	eax, [ebx+1]
		push	eax
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		add	esp, 0Ch

loc_2F8:				; CODE XREF: _cca_rsa_sign+2E3j
		cmp	dword ptr [esp+80h+var_40], 0
		mov	ecx, [esp+80h+var_44]
		mov	eax, [esp+80h+var_6C]
		mov	[ecx], eax
		jnz	loc_EA
		cmp	dword ptr [esp+80h+var_3C], 0
		jnz	loc_EA
		mov	ecx, [esp+80h+var_4]
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
_cca_rsa_sign	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 330h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_rsa_verify	proc near		; DATA XREF: .data:000007A4o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_C]
		push	ebx
		mov	ebx, [esp+6Ch+arg_14]
		push	ebp
		push	esi
		mov	esi, [esp+74h+arg_4]
		mov	[esp+74h+var_54], eax
		mov	eax, [esp+74h+arg_10]
		push	edi
		push	_hndidx
		mov	edi, [esp+7Ch+arg_0]
		mov	[esp+7Ch+var_50], eax
		mov	eax, ds:??_C@_07FCKAMOFI@PKCS?91?41@ ; `string'
		mov	[esp+7Ch+var_14], eax
		mov	eax, ds:dword_19FC
		push	ebx
		mov	[esp+80h+var_40], 0
		mov	[esp+80h+var_44], 1
		mov	[esp+80h+var_10], eax
		call	_RSA_get_ex_data
		mov	ebp, [esp+80h+arg_8]
		add	esp, 8
		mov	[esp+78h+var_68], 24h ;	'$'
		mov	ecx, [eax]
		add	eax, 4
		mov	[esp+78h+var_48], ecx
		mov	[esp+78h+var_4C], eax
		cmp	edi, 4
		jz	short loc_3C9
		cmp	edi, 40h ; '@'
		jnz	loc_483

loc_3C9:				; CODE XREF: _cca_rsa_verify+8Ej
		lea	eax, [esp+78h+var_2C]
		push	edi
		mov	[esp+7Ch+var_64], eax
		call	_OBJ_nid2obj
		add	esp, 4
		mov	[esp+78h+var_2C], eax
		test	eax, eax
		jnz	short loc_421
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_3F5
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_3F5:				; CODE XREF: _cca_rsa_verify+B9j
		push	280h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Dh ; 'm'

loc_401:				; CODE XREF: _cca_rsa_verify+116j
					; _cca_rsa_verify+186j	...
		push	6Ah ; 'j'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_40C:				; CODE XREF: _cca_rsa_verify+19Cj
					; _cca_rsa_verify+2E7j	...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+68h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
; ---------------------------------------------------------------------------

loc_421:				; CODE XREF: _cca_rsa_verify+B0j
		cmp	dword ptr [eax+0Ch], 0
		jnz	short loc_448
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_43A
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_43A:				; CODE XREF: _cca_rsa_verify+FEj
		push	286h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	65h ; 'e'
		jmp	short loc_401
; ---------------------------------------------------------------------------

loc_448:				; CODE XREF: _cca_rsa_verify+F5j
		lea	eax, [esp+78h+var_34]
		mov	[esp+78h+var_34], 5
		mov	[esp+78h+var_28], eax
		lea	eax, [esp+78h+var_24]
		mov	[esp+78h+var_60], eax
		lea	eax, [esp+78h+var_64]
		push	0
		push	eax
		mov	[esp+80h+var_30], 0
		mov	[esp+80h+var_1C], esi
		mov	[esp+80h+var_24], ebp
		call	_i2d_X509_SIG
		add	esp, 8
		mov	[esp+78h+var_68], eax

loc_483:				; CODE XREF: _cca_rsa_verify+93j
		push	ebx
		call	_RSA_size
		mov	ecx, [esp+7Ch+var_68]
		mov	ebx, eax
		dec	ecx
		add	esp, 4
		cmp	ecx, ebx
		jle	short loc_4BB
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_4AA
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_4AA:				; CODE XREF: _cca_rsa_verify+16Ej
		push	299h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		jmp	loc_401
; ---------------------------------------------------------------------------

loc_4BB:				; CODE XREF: _cca_rsa_verify+165j
		cmp	edi, 4
		jz	loc_560
		cmp	edi, 40h ; '@'
		jz	short loc_50F
		cmp	edi, 72h ; 'r'
		jnz	loc_40C
		cmp	ebp, 24h ; '$'
		jz	short loc_502
		push	2A1h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		push	6Ah ; 'j'
		call	_ERR_CCA4758_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+68h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
; ---------------------------------------------------------------------------

loc_502:				; CODE XREF: _cca_rsa_verify+1A5j
		mov	[esp+78h+var_68], 24h ;	'$'
		jmp	loc_5B6
; ---------------------------------------------------------------------------

loc_50F:				; CODE XREF: _cca_rsa_verify+197j
		push	2B7h
		lea	eax, [ebx+1]
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+78h+var_5C], esi
		test	esi, esi
		jnz	short loc_55A
		push	2B9h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		push	6Ah ; 'j'
		call	_ERR_CCA4758_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+68h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
; ---------------------------------------------------------------------------

loc_55A:				; CODE XREF: _cca_rsa_verify+1FDj
		lea	eax, [esp+78h+var_5C]
		jmp	short loc_5A8
; ---------------------------------------------------------------------------

loc_560:				; CODE XREF: _cca_rsa_verify+18Ej
		push	2ABh
		lea	eax, [ebx+1]
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+78h+var_58], esi
		test	esi, esi
		jnz	short loc_5A4
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_593
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_593:				; CODE XREF: _cca_rsa_verify+257j
		push	2ADh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		jmp	loc_401
; ---------------------------------------------------------------------------

loc_5A4:				; CODE XREF: _cca_rsa_verify+24Ej
		lea	eax, [esp+78h+var_58]

loc_5A8:				; CODE XREF: _cca_rsa_verify+22Ej
		push	eax
		lea	eax, [esp+7Ch+var_64]
		push	eax
		call	_i2d_X509_SIG
		add	esp, 8

loc_5B6:				; CODE XREF: _cca_rsa_verify+1DAj
		push	[esp+78h+var_54]
		lea	eax, [esp+7Ch+var_50]
		push	eax
		push	esi
		lea	eax, [esp+84h+var_68]
		push	eax
		push	[esp+88h+var_4C]
		lea	eax, [esp+8Ch+var_48]
		push	eax
		lea	eax, [esp+90h+var_14]
		push	eax
		lea	eax, [esp+94h+var_44]
		push	eax
		lea	eax, [esp+98h+var_C]
		push	eax
		lea	eax, [esp+9Ch+var_40]
		push	eax
		lea	eax, [esp+0A0h+var_38]
		push	eax
		lea	eax, [esp+0A4h+var_3C]
		push	eax
		call	ds:_digitalSignatureVerify
		cmp	edi, 40h ; '@'
		jz	short loc_5FF
		cmp	edi, 4
		jnz	short loc_612

loc_5FF:				; CODE XREF: _cca_rsa_verify+2C8j
		lea	eax, [ebx+1]
		push	eax
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		add	esp, 0Ch

loc_612:				; CODE XREF: _cca_rsa_verify+2CDj
		cmp	dword ptr [esp+78h+var_3C], 0
		jnz	loc_40C
		cmp	dword ptr [esp+78h+var_38], 0
		jnz	loc_40C
		mov	ecx, [esp+78h+var_4]
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_cca_rsa_verify	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 640h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl cca_get_random_bytes(void	*Dst, size_t Size)
_cca_get_random_bytes proc near		; DATA XREF: .data:000007B0o
					; .data:000007BCo

var_28		= byte ptr -28h
var_24		= byte ptr -24h
var_20		= byte ptr -20h
var_1C		= byte ptr -1Ch
Src		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= qword	ptr -10h
var_8		= byte ptr -8
var_4		= dword	ptr -4
Dst		= dword	ptr  4
Size		= dword	ptr  8

		mov	eax, 28h ; '('
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		movq	xmm0, ds:??_C@_08DOIMCLLG@RANDOM?5?5?$AA@ ; `string'
		mov	al, ds:byte_1A0C
		push	esi
		mov	esi, [esp+2Ch+Dst]
		push	edi
		mov	edi, [esp+30h+Size]
		movq	[esp+30h+var_10], xmm0
		mov	[esp+30h+var_8], al
		cmp	edi, 8
		jl	short loc_6C3
		nop	dword ptr [eax+eax+00h]

loc_680:				; CODE XREF: _cca_get_random_bytes+81j
		lea	eax, [esp+30h+Src]
		push	eax
		lea	eax, [esp+34h+var_10]
		push	eax
		lea	eax, [esp+38h+var_20]
		push	eax
		lea	eax, [esp+3Ch+var_1C]
		push	eax
		lea	eax, [esp+40h+var_24]
		push	eax
		lea	eax, [esp+44h+var_28]
		push	eax
		call	ds:_randomNumberGenerate
		cmp	dword ptr [esp+30h+var_28], 0
		jnz	short loc_711
		mov	eax, [esp+30h+Src]
		sub	edi, 8
		mov	[esi], eax
		mov	eax, [esp+30h+var_14]
		mov	[esi+4], eax
		add	esi, 8
		cmp	edi, 8
		jge	short loc_680

loc_6C3:				; CODE XREF: _cca_get_random_bytes+39j
		test	edi, edi
		jz	short loc_6FB
		lea	eax, [esp+30h+Src]
		push	eax
		lea	eax, [esp+34h+var_10]
		push	eax
		push	0
		push	0
		lea	eax, [esp+40h+var_24]
		push	eax
		lea	eax, [esp+44h+var_28]
		push	eax
		call	ds:_randomNumberGenerate
		cmp	dword ptr [esp+30h+var_28], 0
		jnz	short loc_711
		push	edi		; Size
		lea	eax, [esp+34h+Src]
		push	eax		; Src
		push	esi		; Dst
		call	_memcpy
		add	esp, 0Ch

loc_6FB:				; CODE XREF: _cca_get_random_bytes+85j
		pop	edi
		mov	eax, 1
		pop	esi
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_711:				; CODE XREF: _cca_get_random_bytes+69j
					; _cca_get_random_bytes+AAj
		mov	ecx, [esp+30h+var_4]
		xor	eax, eax
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
_cca_get_random_bytes endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 724h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_random_status proc	near		; DATA XREF: .data:000007C0o
		mov	eax, 1
		retn
_cca_random_status endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 72Ch
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
_CCA4758_LIB_NAME dd ?			; DATA XREF: _free_CCA4758_LIB_NAMEr
					; _free_CCA4758_LIB_NAME:loc_F66w ...
_dso		dd ?			; DATA XREF: _ibm_4758_cca_ctrl+2r
					; _ibm_4758_cca_finish:loc_112Er ...
_CCA4758_lib_error_code	dd ?		; DATA XREF: _cca_rsa_sign+C0r
					; _cca_rsa_sign+CEw ...
_keyRecordRead	dd ?			; DATA XREF: _ibm_4758_cca_finish+9Bw
					; _ibm_4758_cca_init+80w ...
_digitalSignatureGenerate dd ?		; DATA XREF: _cca_rsa_sign+2D5r
					; _ibm_4758_cca_finish+A5w ...
_digitalSignatureVerify	dd ?		; DATA XREF: _cca_rsa_verify+2BFr
					; _ibm_4758_cca_finish+AFw ...
_publicKeyExtract dd ?			; DATA XREF: _ibm_4758_cca_finish+B9w
					; _ibm_4758_cca_init+100w ...
_pkaEncrypt	dd ?			; DATA XREF: _cca_rsa_pub_enc+B2r
					; _ibm_4758_cca_finish+C3w ...
_pkaDecrypt	dd ?			; DATA XREF: _cca_rsa_priv_dec+B2r
					; _ibm_4758_cca_finish+CDw ...
_randomNumberGenerate dd ?		; DATA XREF: _cca_get_random_bytes+5Er
					; _cca_get_random_bytes+9Fr ...
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 754h
_n_keyRecordRead dd offset ??_C@_0L@CPNMBMKM@CSNDKRR_32?$AA@
					; DATA XREF: _ibm_4758_cca_init:loc_1271r
					; "CSNDKRR_32"
_n_digitalSignatureGenerate dd offset ??_C@_0L@LKMIKHBC@CSNDDSG_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+AEr
					; "CSNDDSG_32"
_n_digitalSignatureVerify dd offset ??_C@_0L@OHEIBJCA@CSNDDSV_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+CFr
					; "CSNDDSV_32"
_n_publicKeyExtract dd offset ??_C@_0L@CEGMJPGK@CSNDPKX_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+ECr
					; "CSNDPKX_32"
_n_pkaEncrypt	dd offset ??_C@_0L@LMBMMMFJ@CSNDPKE_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+109r
					; "CSNDPKE_32"
_n_pkaDecrypt	dd offset ??_C@_0L@IBHMOFOJ@CSNDPKD_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+126r
					; "CSNDPKD_32"
_n_randomNumberGenerate	dd offset ??_C@_0L@MHOBBGCE@CSNBRNG_32?$AA@
					; DATA XREF: _ibm_4758_cca_init+8Dr
					; "CSNBRNG_32"
_hndidx		dd 0FFFFFFFFh		; DATA XREF: _cca_rsa_sign+39r
					; _cca_rsa_verify+33r ...
_ibm_4758_cca_rsa dd offset ??_C@_0BI@CEKPDDKJ@IBM?54758?5CCA?5RSA?5method?$AA@
					; DATA XREF: _bind_helper+33o
					; "IBM 4758 CCA	RSA method"
		dd offset _cca_rsa_pub_enc
		dd 2 dup(0)
		dd offset _cca_rsa_priv_dec
		dd 4 dup(0)
		dd offset loc_3F+1
		dd 0
		dd offset _cca_rsa_sign
		dd offset _cca_rsa_verify
		dd 0
_ibm_4758_cca_rand dd 0			; DATA XREF: _bind_helper+49o
		dd offset _cca_get_random_bytes
		dd 2 dup(0)
		dd offset _cca_get_random_bytes
		dd offset _cca_random_status
_engine_4758_cca_id dd offset ??_C@_07CMJMPEOG@4758cca?$AA@ ; DATA XREF: _bind_fn+8r
					; _bind_helper+1r
					; "4758cca"
_engine_4758_cca_name dd offset	??_C@_0CF@DFCNOJCI@IBM?54758?5CCA?5hardware?5engine?5sup@
					; DATA XREF: _bind_helper+1Cr
					; "IBM 4758 CCA	hardware engine	support"
_engine_4758_cca_id_alt	dd offset ??_C@_08FCPGAALG@4758_cca?$AA@ ; DATA	XREF: _bind_fn+3Br
					; "4758_cca"
_CCA4758_error_init dd 1		; DATA XREF: _ERR_load_CCA4758_strings:loc_CDFr
					; _ERR_load_CCA4758_strings+22w ...
_CCA4758_str_functs dd 69000h		; DATA XREF: _ERR_load_CCA4758_strings+1Co
					; _ERR_unload_CCA4758_strings+9o ...
		dd offset ??_C@_0N@PCMBDIKK@CCA_RSA_SIGN?$AA@ ;	"CCA_RSA_SIGN"
		dd 6A000h
		dd offset ??_C@_0P@HDKJMGME@CCA_RSA_VERIFY?$AA@	; "CCA_RSA_VERIFY"
		dd 64000h
		dd offset ??_C@_0BC@HBIFGMI@IBM_4758_CCA_CTRL?$AA@ ; "IBM_4758_CCA_CTRL"
		dd 65000h
		dd offset ??_C@_0BE@KIMPEPCI@IBM_4758_CCA_FINISH?$AA@ ;	"IBM_4758_CCA_FINISH"
		dd 66000h
		dd offset ??_C@_0BC@OAGECNFK@IBM_4758_CCA_INIT?$AA@ ; "IBM_4758_CCA_INIT"
		dd 67000h
		dd offset ??_C@_0BG@ECJOBJPH@IBM_4758_LOAD_PRIVKEY?$AA@	; "IBM_4758_LOAD_PRIVKEY"
		dd 68000h
		dd offset ??_C@_0BF@BKHJIMMF@IBM_4758_LOAD_PUBKEY?$AA@ ; "IBM_4758_LOAD_PUBKEY"
		dd 2 dup(0)
_CCA4758_str_reasons dd	offset loc_61+3	; DATA XREF: _ERR_load_CCA4758_strings+31o
					; _ERR_unload_CCA4758_strings+19o ...
		dd offset ??_C@_0P@BJJHFGDF@already?5loaded?$AA@ ; "already loaded"
		dd offset loc_61+4
		dd offset ??_C@_0BI@BGBJIODD@asn1?5oid?5unknown?5for?5md?$AA@ ;	"asn1 oid unknown for md"
		dd offset loc_61+5
		dd offset ??_C@_0BI@CLFIAOBA@command?5not?5implemented?$AA@ ; "command not implemented"
		dd offset loc_61+6
		dd offset ??_C@_0M@DBMBNOIK@dso?5failure?$AA@ ;	"dso failure"
		dd offset loc_61+7
		dd offset ??_C@_0BL@DPOFILLC@failed?5loading?5private?5key?$AA@	; "failed loading private key"
		dd offset loc_69
		dd offset ??_C@_0BK@OJHFAKGP@failed?5loading?5public?5key?$AA@ ; "failed loading public	key"
		dd offset loc_69+1
		dd offset ??_C@_0L@ICAFOIA@not?5loaded?$AA@ ; "not loaded"
		dd offset loc_69+2
		dd offset ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ ; "size too large or	too small"
		dd offset loc_69+3
		dd offset ??_C@_0N@JLJLJPMB@unit?5failure?$AA@ ; "unit failure"
		dd offset loc_6D
		dd offset ??_C@_0BH@FNFJOEPG@unknown?5algorithm?5type?$AA@ ; "unknown algorithm	type"
		dd 2 dup(0)
_data		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 86Ch
; COMDAT (pick any)
		public ??_C@_0L@CPNMBMKM@CSNDKRR_32?$AA@
; `string'
??_C@_0L@CPNMBMKM@CSNDKRR_32?$AA@ db 'CSNDKRR_32',0 ; DATA XREF: .data:_n_keyRecordReado
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 878h
; COMDAT (pick any)
		public ??_C@_0L@LKMIKHBC@CSNDDSG_32?$AA@
; `string'
??_C@_0L@LKMIKHBC@CSNDDSG_32?$AA@ db 'CSNDDSG_32',0
					; DATA XREF: .data:_n_digitalSignatureGenerateo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 884h
; COMDAT (pick any)
		public ??_C@_0L@OHEIBJCA@CSNDDSV_32?$AA@
; `string'
??_C@_0L@OHEIBJCA@CSNDDSV_32?$AA@ db 'CSNDDSV_32',0
					; DATA XREF: .data:_n_digitalSignatureVerifyo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 890h
; COMDAT (pick any)
		public ??_C@_0L@CEGMJPGK@CSNDPKX_32?$AA@
; `string'
??_C@_0L@CEGMJPGK@CSNDPKX_32?$AA@ db 'CSNDPKX_32',0 ; DATA XREF: .data:_n_publicKeyExtracto
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 89Ch
; COMDAT (pick any)
		public ??_C@_0L@LMBMMMFJ@CSNDPKE_32?$AA@
; `string'
??_C@_0L@LMBMMMFJ@CSNDPKE_32?$AA@ db 'CSNDPKE_32',0 ; DATA XREF: .data:_n_pkaEncrypto
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8A8h
; COMDAT (pick any)
		public ??_C@_0L@IBHMOFOJ@CSNDPKD_32?$AA@
; `string'
??_C@_0L@IBHMOFOJ@CSNDPKD_32?$AA@ db 'CSNDPKD_32',0 ; DATA XREF: .data:_n_pkaDecrypto
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8B4h
; COMDAT (pick any)
		public ??_C@_0L@MHOBBGCE@CSNBRNG_32?$AA@
; `string'
??_C@_0L@MHOBBGCE@CSNBRNG_32?$AA@ db 'CSNBRNG_32',0
					; DATA XREF: .data:_n_randomNumberGenerateo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8C0h
_cca4758_cmd_defns dd offset loc_C7+1	; DATA XREF: _bind_helper+CBo
		dd offset ??_C@_07EGEBNIPD@SO_PATH?$AA@	; "SO_PATH"
		dd offset ??_C@_0DD@PGICMPDB@Specifies?5the?5path?5to?5the?5?84758c@ ; "Specifies the path to the '4758cca' sha"...
		dd 2, 4	dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8E0h
; COMDAT (pick any)
		public ??_C@_07EGEBNIPD@SO_PATH?$AA@
; `string'
??_C@_07EGEBNIPD@SO_PATH?$AA@ db 'SO_PATH',0 ; DATA XREF: .rdata:000008C4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8E8h
; COMDAT (pick any)
		public ??_C@_0DD@PGICMPDB@Specifies?5the?5path?5to?5the?5?84758c@
; `string'
??_C@_0DD@PGICMPDB@Specifies?5the?5path?5to?5the?5?84758c@ db 'Specifies the path to the ',27h,'4758cca',27h,' shared library',0
					; DATA XREF: .rdata:000008C8o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 91Ch
; COMDAT (pick any)
		public ??_C@_0BI@CEKPDDKJ@IBM?54758?5CCA?5RSA?5method?$AA@
; `string'
??_C@_0BI@CEKPDDKJ@IBM?54758?5CCA?5RSA?5method?$AA@ db 'IBM 4758 CCA RSA method',0
					; DATA XREF: .data:_ibm_4758_cca_rsao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 934h
; COMDAT (pick any)
		public ??_C@_07CMJMPEOG@4758cca?$AA@
; `string'
??_C@_07CMJMPEOG@4758cca?$AA@ db '4758cca',0 ; DATA XREF: .data:_engine_4758_cca_ido
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 93Ch
; COMDAT (pick any)
		public ??_C@_0CF@DFCNOJCI@IBM?54758?5CCA?5hardware?5engine?5sup@
; `string'
??_C@_0CF@DFCNOJCI@IBM?54758?5CCA?5hardware?5engine?5sup@ db 'IBM 4758 CCA hardware engine support',0
					; DATA XREF: .data:_engine_4758_cca_nameo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 964h
; COMDAT (pick any)
		public ??_C@_08FCPGAALG@4758_cca?$AA@
; `string'
??_C@_08FCPGAALG@4758_cca?$AA@ db '4758_cca',0 ; DATA XREF: .data:_engine_4758_cca_id_alto
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 970h
; COMDAT (pick any)
		public ??_C@_0N@PCMBDIKK@CCA_RSA_SIGN?$AA@
; `string'
??_C@_0N@PCMBDIKK@CCA_RSA_SIGN?$AA@ db 'CCA_RSA_SIGN',0 ; DATA XREF: .data:000007D8o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 980h
; COMDAT (pick any)
		public ??_C@_0P@HDKJMGME@CCA_RSA_VERIFY?$AA@
; `string'
??_C@_0P@HDKJMGME@CCA_RSA_VERIFY?$AA@ db 'CCA_RSA_VERIFY',0 ; DATA XREF: .data:000007E0o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 990h
; COMDAT (pick any)
		public ??_C@_0BC@HBIFGMI@IBM_4758_CCA_CTRL?$AA@
; `string'
??_C@_0BC@HBIFGMI@IBM_4758_CCA_CTRL?$AA@ db 'IBM_4758_CCA_CTRL',0
					; DATA XREF: .data:000007E8o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9A4h
; COMDAT (pick any)
		public ??_C@_0BE@KIMPEPCI@IBM_4758_CCA_FINISH?$AA@
; `string'
??_C@_0BE@KIMPEPCI@IBM_4758_CCA_FINISH?$AA@ db 'IBM_4758_CCA_FINISH',0
					; DATA XREF: .data:000007F0o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9B8h
; COMDAT (pick any)
		public ??_C@_0BC@OAGECNFK@IBM_4758_CCA_INIT?$AA@
; `string'
??_C@_0BC@OAGECNFK@IBM_4758_CCA_INIT?$AA@ db 'IBM_4758_CCA_INIT',0
					; DATA XREF: .data:000007F8o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9CCh
; COMDAT (pick any)
		public ??_C@_0BG@ECJOBJPH@IBM_4758_LOAD_PRIVKEY?$AA@
; `string'
??_C@_0BG@ECJOBJPH@IBM_4758_LOAD_PRIVKEY?$AA@ db 'IBM_4758_LOAD_PRIVKEY',0
					; DATA XREF: .data:00000800o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9E4h
; COMDAT (pick any)
		public ??_C@_0BF@BKHJIMMF@IBM_4758_LOAD_PUBKEY?$AA@
; `string'
??_C@_0BF@BKHJIMMF@IBM_4758_LOAD_PUBKEY?$AA@ db	'IBM_4758_LOAD_PUBKEY',0
					; DATA XREF: .data:00000808o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9FCh
; COMDAT (pick any)
		public ??_C@_0P@BJJHFGDF@already?5loaded?$AA@
; `string'
??_C@_0P@BJJHFGDF@already?5loaded?$AA@ db 'already loaded',0 ; DATA XREF: .data:00000818o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A0Ch
; COMDAT (pick any)
		public ??_C@_0BI@BGBJIODD@asn1?5oid?5unknown?5for?5md?$AA@
; `string'
??_C@_0BI@BGBJIODD@asn1?5oid?5unknown?5for?5md?$AA@ db 'asn1 oid unknown for md',0
					; DATA XREF: .data:00000820o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A24h
; COMDAT (pick any)
		public ??_C@_0BI@CLFIAOBA@command?5not?5implemented?$AA@
; `string'
??_C@_0BI@CLFIAOBA@command?5not?5implemented?$AA@ db 'command not implemented',0
					; DATA XREF: .data:00000828o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A3Ch
; COMDAT (pick any)
		public ??_C@_0M@DBMBNOIK@dso?5failure?$AA@
; `string'
??_C@_0M@DBMBNOIK@dso?5failure?$AA@ db 'dso failure',0 ; DATA XREF: .data:00000830o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A48h
; COMDAT (pick any)
		public ??_C@_0BL@DPOFILLC@failed?5loading?5private?5key?$AA@
; `string'
??_C@_0BL@DPOFILLC@failed?5loading?5private?5key?$AA@ db 'failed loading private key',0
					; DATA XREF: .data:00000838o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A64h
; COMDAT (pick any)
		public ??_C@_0BK@OJHFAKGP@failed?5loading?5public?5key?$AA@
; `string'
??_C@_0BK@OJHFAKGP@failed?5loading?5public?5key?$AA@ db	'failed loading public key',0
					; DATA XREF: .data:00000840o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A80h
; COMDAT (pick any)
		public ??_C@_0L@ICAFOIA@not?5loaded?$AA@
; `string'
??_C@_0L@ICAFOIA@not?5loaded?$AA@ db 'not loaded',0 ; DATA XREF: .data:00000848o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A8Ch
; COMDAT (pick any)
		public ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@
; `string'
??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ db 'size too large or too small',0
					; DATA XREF: .data:00000850o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AA8h
; COMDAT (pick any)
		public ??_C@_0N@JLJLJPMB@unit?5failure?$AA@
; `string'
??_C@_0N@JLJLJPMB@unit?5failure?$AA@ db	'unit failure',0 ; DATA XREF: .data:00000858o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AB8h
; COMDAT (pick any)
		public ??_C@_0BH@FNFJOEPG@unknown?5algorithm?5type?$AA@
; `string'
??_C@_0BH@FNFJOEPG@unknown?5algorithm?5type?$AA@ db 'unknown algorithm type',0
					; DATA XREF: .data:00000860o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AD0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_rsa_pub_enc proc near		; DATA XREF: .data:00000778o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 3Ch ; '<'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		mov	eax, [esp+3Ch+arg_0]
		push	ebx
		mov	ebx, [esp+40h+arg_4]
		push	esi
		mov	esi, [esp+44h+arg_C]
		mov	[esp+44h+var_30], eax
		mov	eax, ds:??_C@_07MLKJJPOC@PKCS?91?42@ ; `string'
		push	edi
		mov	edi, [esp+48h+arg_8]
		mov	[esp+48h+var_1C], eax
		mov	eax, ds:dword_19F0
		push	esi
		mov	[esp+4Ch+var_28], 0
		mov	[esp+4Ch+var_2C], 1
		mov	[esp+4Ch+var_18], eax
		mov	[esp+4Ch+var_34], 0
		call	_RSA_size
		push	_hndidx
		mov	[esp+50h+var_3C], eax
		push	esi
		call	_RSA_get_ex_data
		add	esp, 0Ch
		mov	ecx, [eax]
		add	eax, 4
		push	edi
		mov	[esp+4Ch+var_38], ecx
		lea	ecx, [esp+4Ch+var_3C]
		push	ecx
		push	eax
		lea	eax, [esp+54h+var_38]
		push	eax
		lea	eax, [esp+58h+var_14]
		push	eax
		lea	eax, [esp+5Ch+var_34]
		push	eax
		push	ebx
		lea	eax, [esp+64h+var_30]
		push	eax
		lea	eax, [esp+68h+var_1C]
		push	eax
		lea	eax, [esp+6Ch+var_2C]
		push	eax
		lea	eax, [esp+70h+var_C]
		push	eax
		lea	eax, [esp+74h+var_28]
		push	eax
		lea	eax, [esp+78h+var_20]
		push	eax
		lea	eax, [esp+7Ch+var_24]
		push	eax
		call	ds:_pkaEncrypt
		mov	eax, [esp+48h+var_24]
		mov	ecx, [esp+48h+var_20]
		pop	edi
		pop	esi
		pop	ebx
		test	eax, eax
		jnz	short loc_BAD
		test	ecx, ecx
		jnz	short loc_BAD
		mov	eax, [esp+3Ch+var_3C]
		mov	ecx, [esp+3Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------

loc_BAD:				; CODE XREF: _cca_rsa_pub_enc+C5j
					; _cca_rsa_pub_enc+C9j
		shl	eax, 10h
		or	eax, ecx
		mov	ecx, [esp+3Ch+var_4]
		xor	ecx, esp
		neg	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
_cca_rsa_pub_enc endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BC4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_rsa_priv_dec proc near		; DATA XREF: .data:00000784o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 3Ch ; '<'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		mov	eax, [esp+3Ch+arg_0]
		push	ebx
		mov	ebx, [esp+40h+arg_4]
		push	esi
		mov	esi, [esp+44h+arg_C]
		mov	[esp+44h+var_30], eax
		mov	eax, ds:??_C@_07MLKJJPOC@PKCS?91?42@ ; `string'
		push	edi
		mov	edi, [esp+48h+arg_8]
		mov	[esp+48h+var_1C], eax
		mov	eax, ds:dword_19F0
		push	esi
		mov	[esp+4Ch+var_28], 0
		mov	[esp+4Ch+var_2C], 1
		mov	[esp+4Ch+var_18], eax
		mov	[esp+4Ch+var_34], 0
		call	_RSA_size
		push	_hndidx
		mov	[esp+50h+var_3C], eax
		push	esi
		call	_RSA_get_ex_data
		add	esp, 0Ch
		mov	ecx, [eax]
		add	eax, 4
		push	edi
		mov	[esp+4Ch+var_38], ecx
		lea	ecx, [esp+4Ch+var_3C]
		push	ecx
		push	eax
		lea	eax, [esp+54h+var_38]
		push	eax
		lea	eax, [esp+58h+var_14]
		push	eax
		lea	eax, [esp+5Ch+var_34]
		push	eax
		push	ebx
		lea	eax, [esp+64h+var_30]
		push	eax
		lea	eax, [esp+68h+var_1C]
		push	eax
		lea	eax, [esp+6Ch+var_2C]
		push	eax
		lea	eax, [esp+70h+var_C]
		push	eax
		lea	eax, [esp+74h+var_28]
		push	eax
		lea	eax, [esp+78h+var_20]
		push	eax
		lea	eax, [esp+7Ch+var_24]
		push	eax
		call	ds:_pkaDecrypt
		mov	eax, [esp+48h+var_24]
		or	eax, [esp+48h+var_20]
		mov	ecx, [esp+48h+var_4]
		neg	eax
		pop	edi
		pop	esi
		sbb	eax, eax
		pop	ebx
		xor	ecx, esp
		inc	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
_cca_rsa_priv_dec endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0C9Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_CCA4758_error proc	near		; CODE XREF: _cca_rsa_sign+1C3p
					; _cca_rsa_sign+21Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_CAF
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_CAF:				; CODE XREF: _ERR_CCA4758_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_CCA4758_error endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CCCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_CCA4758_strings proc near	; CODE XREF: _bind_helper+DDp
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_CDF
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_CDF:				; CODE XREF: _ERR_load_CCA4758_strings+7j
		cmp	_CCA4758_error_init, 0
		jz	short locret_D10
		push	offset _CCA4758_str_functs
		push	eax
		mov	_CCA4758_error_init, 0
		call	_ERR_load_strings
		push	offset _CCA4758_str_reasons
		push	ds:_CCA4758_lib_error_code
		call	_ERR_load_strings
		add	esp, 10h

locret_D10:				; CODE XREF: _ERR_load_CCA4758_strings+1Aj
		retn
_ERR_load_CCA4758_strings endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D14h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_CCA4758_strings proc near
		cmp	_CCA4758_error_init, 0
		jnz	short locret_D4A
		push	offset _CCA4758_str_functs
		push	ds:_CCA4758_lib_error_code
		call	_ERR_unload_strings
		push	offset _CCA4758_str_reasons
		push	ds:_CCA4758_lib_error_code
		call	_ERR_unload_strings
		add	esp, 10h
		mov	_CCA4758_error_init, 1

locret_D4A:				; CODE XREF: _ERR_unload_CCA4758_strings+7j
		retn
_ERR_unload_CCA4758_strings endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$10
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_D73

loc_D6F:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_D73:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_D6F
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_D6F

$skip_cbs$10:				; CODE XREF: _bind_engine+Cj
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_bind_fn
		add	esp, 8
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	esi
		retn
_bind_engine	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DD4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_fn	proc near		; CODE XREF: _bind_engine+75p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_E41
		mov	edx, _engine_4758_cca_id
		mov	ecx, eax
		push	ebx

loc_DE5:				; CODE XREF: _bind_fn+2Bj
		mov	bl, [ecx]
		cmp	bl, [edx]
		jnz	short loc_E05
		test	bl, bl
		jz	short loc_E01
		mov	bl, [ecx+1]
		cmp	bl, [edx+1]
		jnz	short loc_E05
		add	ecx, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_DE5

loc_E01:				; CODE XREF: _bind_fn+19j
		xor	ecx, ecx
		jmp	short loc_E0A
; ---------------------------------------------------------------------------

loc_E05:				; CODE XREF: _bind_fn+15j _bind_fn+21j
		sbb	ecx, ecx
		or	ecx, 1

loc_E0A:				; CODE XREF: _bind_fn+2Fj
		pop	ebx
		test	ecx, ecx
		jz	short loc_E41
		mov	ecx, _engine_4758_cca_id_alt

loc_E15:				; CODE XREF: _bind_fn+5Bj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_E35
		test	dl, dl
		jz	short loc_E31
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_E35
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_E15

loc_E31:				; CODE XREF: _bind_fn+49j
		xor	eax, eax
		jmp	short loc_E3A
; ---------------------------------------------------------------------------

loc_E35:				; CODE XREF: _bind_fn+45j _bind_fn+51j
		sbb	eax, eax
		or	eax, 1

loc_E3A:				; CODE XREF: _bind_fn+5Fj
		test	eax, eax
		jz	short loc_E41
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_E41:				; CODE XREF: _bind_fn+6j _bind_fn+39j	...
		push	[esp+arg_0]
		call	_bind_helper
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_fn	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near		; CODE XREF: _bind_fn+71p

arg_0		= dword	ptr  4

		push	esi
		push	_engine_4758_cca_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_F3D
		push	_engine_4758_cca_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_F3D
		push	offset _ibm_4758_cca_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_F3D
		push	offset _ibm_4758_cca_rand
		push	esi
		call	_ENGINE_set_RAND
		add	esp, 8
		test	eax, eax
		jz	loc_F3D
		push	offset _ibm_4758_cca_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _ibm_4758_cca_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _ibm_4758_cca_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _ibm_4758_cca_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _ibm_4758_load_privkey
		push	esi
		call	_ENGINE_set_load_privkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _ibm_4758_load_pubkey
		push	esi
		call	_ENGINE_set_load_pubkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		push	offset _cca4758_cmd_defns
		push	esi
		call	_ENGINE_set_cmd_defns
		add	esp, 8
		test	eax, eax
		jz	short loc_F3D
		call	_ERR_load_CCA4758_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_F3D:				; CODE XREF: _bind_helper+16j
					; _bind_helper+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_helper	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F44h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cca_ex_free	proc near		; DATA XREF: _ibm_4758_cca_init+143o

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short locret_F53
		push	eax
		call	_CRYPTO_free
		pop	ecx

locret_F53:				; CODE XREF: _cca_ex_free+6j
		retn
_cca_ex_free	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_free_CCA4758_LIB_NAME proc near
		mov	eax, ds:_CCA4758_LIB_NAME
		test	eax, eax
		jz	short loc_F66
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_F66:				; CODE XREF: _free_CCA4758_LIB_NAME+7j
		mov	ds:_CCA4758_LIB_NAME, 0
		retn
_free_CCA4758_LIB_NAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F74h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl getModulusAndExponent(int, int, void *Dst, int, int, void	*)
_getModulusAndExponent proc near	; CODE XREF: _ibm_4758_load_privkey+235p
					; _ibm_4758_load_pubkey+19Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Dst		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebx
		mov	ebx, [esp+4+arg_0]
		cmp	byte ptr [ebx],	1Eh
		jnz	short loc_FF6
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_FF6
		cmp	byte ptr [ebx+8], 4
		jnz	short loc_FF6
		cmp	byte ptr [ebx+9], 0
		jnz	short loc_FF6
		movzx	ecx, byte ptr [ebx+0Eh]
		movzx	eax, byte ptr [ebx+0Fh]
		push	esi
		mov	esi, [esp+8+arg_10]
		shl	ecx, 8
		or	ecx, eax
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	[edi], ecx
		movzx	ecx, byte ptr [ebx+10h]
		movzx	eax, byte ptr [ebx+11h]
		shl	ecx, 8
		or	ecx, eax
		mov	eax, [esp+0Ch+arg_C]
		mov	[eax], ecx
		movzx	ecx, byte ptr [ebx+12h]
		movzx	eax, byte ptr [ebx+13h]
		add	ebx, 14h
		shl	ecx, 8
		or	ecx, eax
		mov	[esi], ecx
		push	dword ptr [edi]	; Size
		push	ebx		; Src
		push	[esp+14h+Dst]	; Dst
		call	_memcpy
		push	dword ptr [esi]	; Size
		mov	eax, [edi]
		add	eax, ebx
		push	eax		; Src
		push	[esp+20h+arg_14] ; Dst
		call	_memcpy
		add	esp, 18h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_FF6:				; CODE XREF: _getModulusAndExponent+8j
					; _getModulusAndExponent+Ej ...
		xor	eax, eax
		pop	ebx
		retn
_getModulusAndExponent endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FFCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_CCA4758_LIB_NAME proc near
		mov	ecx, ds:_CCA4758_LIB_NAME
		mov	eax, offset ??_C@_08HAODNNAF@CSUNSAPI?$AA@ ; "CSUNSAPI"
		test	ecx, ecx
		cmovnz	eax, ecx
		retn
_get_CCA4758_LIB_NAME endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1010h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ibm_4758_cca_ctrl proc	near		; DATA XREF: _bind_helper+95o

arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		xor	eax, eax
		cmp	ds:_dso, eax
		setnz	al
		cmp	[esp+arg_4], 0C8h ; ''
		jz	short loc_1052
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1038
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1038:				; CODE XREF: _ibm_4758_cca_ctrl+1Cj
		push	184h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	66h ; 'f'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1052:				; CODE XREF: _ibm_4758_cca_ctrl+13j
		mov	ecx, [esp+arg_C]
		test	ecx, ecx
		jnz	short loc_1087
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_106D
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_106D:				; CODE XREF: _ibm_4758_cca_ctrl+51j
		push	178h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	43h ; 'C'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1087:				; CODE XREF: _ibm_4758_cca_ctrl+48j
		test	eax, eax
		jz	short loc_10B8
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_109E
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_109E:				; CODE XREF: _ibm_4758_cca_ctrl+82j
		push	17Ch
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	64h ; 'd'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10B8:				; CODE XREF: _ibm_4758_cca_ctrl+79j
		push	ecx
		call	_set_CCA4758_LIB_NAME
		add	esp, 4
		retn
_ibm_4758_cca_ctrl endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ibm_4758_cca_destroy proc near		; DATA XREF: _bind_helper+5Fo
		cmp	_CCA4758_error_init, 0
		jnz	short loc_10FA
		push	offset _CCA4758_str_functs
		push	ds:_CCA4758_lib_error_code
		call	_ERR_unload_strings
		push	offset _CCA4758_str_reasons
		push	ds:_CCA4758_lib_error_code
		call	_ERR_unload_strings
		add	esp, 10h
		mov	_CCA4758_error_init, 1

loc_10FA:				; CODE XREF: _ibm_4758_cca_destroy+7j
		mov	eax, ds:_CCA4758_LIB_NAME
		test	eax, eax
		jz	short loc_110C
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_110C:				; CODE XREF: _ibm_4758_cca_destroy+3Dj
		mov	eax, 1
		mov	ds:_CCA4758_LIB_NAME, 0
		retn
_ibm_4758_cca_destroy endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 111Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ibm_4758_cca_finish proc near		; DATA XREF: _bind_helper+83o
		mov	eax, ds:_CCA4758_LIB_NAME
		test	eax, eax
		jz	short loc_112E
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_112E:				; CODE XREF: _ibm_4758_cca_finish+7j
		mov	eax, ds:_dso
		mov	ds:_CCA4758_LIB_NAME, 0
		test	eax, eax
		jnz	short loc_116E
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1154
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1154:				; CODE XREF: _ibm_4758_cca_finish+2Cj
		push	15Bh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Ah ; 'j'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_116E:				; CODE XREF: _ibm_4758_cca_finish+23j
		push	eax
		call	_DSO_free
		add	esp, 4
		test	eax, eax
		jnz	short loc_11A8
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_118E
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_118E:				; CODE XREF: _ibm_4758_cca_finish+66j
		push	15Fh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Ch ; 'l'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_11A8:				; CODE XREF: _ibm_4758_cca_finish+5Dj
		mov	ds:_dso, 0
		mov	eax, 1
		mov	ds:_keyRecordRead, 0
		mov	ds:_digitalSignatureGenerate, 0
		mov	ds:_digitalSignatureVerify, 0
		mov	ds:_publicKeyExtract, 0
		mov	ds:_pkaEncrypt,	0
		mov	ds:_pkaDecrypt,	0
		mov	ds:_randomNumberGenerate, 0
		retn
_ibm_4758_cca_finish endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1200h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ibm_4758_cca_init proc	near		; DATA XREF: _bind_helper+71o
		cmp	ds:_dso, 0
		jz	short loc_122D
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_121C
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_121C:				; CODE XREF: _ibm_4758_cca_init+10j
		push	11Ch
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	64h ; 'd'
		jmp	loc_1385
; ---------------------------------------------------------------------------

loc_122D:				; CODE XREF: _ibm_4758_cca_init+7j
		mov	eax, ds:_CCA4758_LIB_NAME
		mov	ecx, offset ??_C@_08HAODNNAF@CSUNSAPI?$AA@ ; "CSUNSAPI"
		test	eax, eax
		push	0
		cmovnz	ecx, eax
		push	0
		push	ecx
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_dso, eax
		test	eax, eax
		jnz	short loc_1271
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1267
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1267:				; CODE XREF: _ibm_4758_cca_init+5Bj
		push	122h
		jmp	loc_137E
; ---------------------------------------------------------------------------

loc_1271:				; CODE XREF: _ibm_4758_cca_init+52j
		push	_n_keyRecordRead
		push	eax
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_keyRecordRead, eax
		test	eax, eax
		jz	loc_1366
		push	_n_randomNumberGenerate
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_randomNumberGenerate, eax
		test	eax, eax
		jz	loc_1366
		push	_n_digitalSignatureGenerate
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_digitalSignatureGenerate, eax
		test	eax, eax
		jz	loc_1366
		push	_n_digitalSignatureVerify
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_digitalSignatureVerify, eax
		test	eax, eax
		jz	short loc_1366
		push	_n_publicKeyExtract
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_publicKeyExtract, eax
		test	eax, eax
		jz	short loc_1366
		push	_n_pkaEncrypt
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_pkaEncrypt,	eax
		test	eax, eax
		jz	short loc_1366
		push	_n_pkaDecrypt
		push	ds:_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_pkaDecrypt,	eax
		test	eax, eax
		jz	short loc_1366
		push	offset _cca_ex_free
		push	0
		push	0
		push	offset ??_C@_0BM@LODLBGBO@IBM?54758?5CCA?5RSA?5key?5handle?$AA@	; "IBM 4758 CCA	RSA key	handle"
		push	0
		call	_RSA_get_ex_new_index
		mov	_hndidx, eax
		add	esp, 14h
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1366:				; CODE XREF: _ibm_4758_cca_init+87j
					; _ibm_4758_cca_init+A8j ...
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1379
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1379:				; CODE XREF: _ibm_4758_cca_init+16Dj
		push	135h

loc_137E:				; CODE XREF: _ibm_4758_cca_init+6Cj
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	67h ; 'g'

loc_1385:				; CODE XREF: _ibm_4758_cca_init+28j
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$23:
		mov	eax, ds:_dso
		test	eax, eax
		jz	short loc_13A2
		push	eax
		call	_DSO_free
		add	esp, 4

loc_13A2:				; CODE XREF: _ibm_4758_cca_init+197j
		mov	ds:_dso, 0
		xor	eax, eax
		mov	ds:_keyRecordRead, 0
		mov	ds:_digitalSignatureGenerate, 0
		mov	ds:_digitalSignatureVerify, 0
		mov	ds:_publicKeyExtract, 0
		mov	ds:_pkaEncrypt,	0
		mov	ds:_pkaDecrypt,	0
		mov	ds:_randomNumberGenerate, 0
		retn
_ibm_4758_cca_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ibm_4758_load_privkey(int, void *Src)
_ibm_4758_load_privkey proc near	; DATA XREF: _bind_helper+A7o

var_C3C		= byte ptr -0C3Ch
var_C38		= dword	ptr -0C38h
var_C34		= dword	ptr -0C34h
var_C30		= dword	ptr -0C30h
var_C2C		= dword	ptr -0C2Ch
var_C28		= dword	ptr -0C28h
var_C24		= dword	ptr -0C24h
var_C20		= byte ptr -0C20h
var_C1C		= dword	ptr -0C1Ch
var_C18		= byte ptr -0C18h
var_C10		= byte ptr -0C10h
Dst		= byte ptr -0C08h
var_BC8		= byte ptr -0BC8h
var_AC8		= byte ptr -0AC8h
var_9C8		= dword	ptr -9C8h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8

		mov	eax, 0C3Ch
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0C3Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+0C40h+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+0C48h+Src]
		mov	esi, edi
		mov	[esp+0C48h+var_C24], 9C4h
		mov	[esp+0C48h+var_C38], 9C4h
		mov	[esp+0C48h+var_C30], 0
		mov	[esp+0C48h+var_C34], 0
		lea	ecx, [esi+1]
		xchg	ax, ax

loc_1448:				; CODE XREF: _ibm_4758_load_privkey+55j
		mov	al, [esi]
		inc	esi
		test	al, al
		jnz	short loc_1448
		sub	esi, ecx
		mov	[esp+0C48h+var_C28], 100h
		mov	[esp+0C48h+var_C2C], 100h
		cmp	esi, 40h ; '@'
		jbe	short loc_14AA
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1479
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1479:				; CODE XREF: _ibm_4758_load_privkey+75j
		push	1A6h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+0C3Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C3Ch
		retn
; ---------------------------------------------------------------------------

loc_14AA:				; CODE XREF: _ibm_4758_load_privkey+6Cj
		push	40h ; '@'       ; Size
		lea	eax, [esp+0C4Ch+Dst]
		push	20h ; ' '       ; Val
		push	eax		; Dst
		call	_memset
		push	esi		; Size
		lea	eax, [esp+0C58h+Dst]
		push	edi		; Src
		push	eax		; Dst
		call	_memcpy
		push	1ADh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	9C8h
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 24h
		test	esi, esi
		jnz	short loc_1525
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_14F4
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_14F4:				; CODE XREF: _ibm_4758_load_privkey+F0j
		push	1AFh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+0C3Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C3Ch
		retn
; ---------------------------------------------------------------------------

loc_1525:				; CODE XREF: _ibm_4758_load_privkey+E7j
		lea	edi, [esi+4]
		push	edi
		lea	eax, [esp+0C4Ch+var_C38]
		push	eax
		lea	eax, [esp+0C50h+Dst]
		push	eax
		lea	eax, [esp+0C54h+var_C18]
		push	eax
		lea	eax, [esp+0C58h+var_C34]
		push	eax
		lea	eax, [esp+0C5Ch+var_C10]
		push	eax
		lea	eax, [esp+0C60h+var_C30]
		push	eax
		lea	eax, [esp+0C64h+var_C20]
		push	eax
		lea	eax, [esp+0C68h+var_C3C]
		push	eax
		call	ds:_keyRecordRead
		cmp	dword ptr [esp+0C48h+var_C3C], 0
		jz	short loc_15AB
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1571
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1571:				; CODE XREF: _ibm_4758_load_privkey+16Dj
		push	1B9h

loc_1576:				; CODE XREF: _ibm_4758_load_privkey+209j
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	68h ; 'h'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		push	esi
		call	_CRYPTO_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+0C3Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C3Ch
		retn
; ---------------------------------------------------------------------------

loc_15AB:				; CODE XREF: _ibm_4758_load_privkey+164j
		lea	eax, [esp+0C48h+var_9C8]
		push	eax
		lea	eax, [esp+0C4Ch+var_C24]
		push	eax
		push	edi
		lea	eax, [esp+0C54h+var_C38]
		push	eax
		lea	eax, [esp+0C58h+var_C18]
		push	eax
		lea	eax, [esp+0C5Ch+var_C34]
		push	eax
		lea	eax, [esp+0C60h+var_C10]
		push	eax
		lea	eax, [esp+0C64h+var_C30]
		push	eax
		lea	eax, [esp+0C68h+var_C20]
		push	eax
		lea	eax, [esp+0C6Ch+var_C3C]
		push	eax
		call	ds:_publicKeyExtract
		cmp	dword ptr [esp+0C48h+var_C3C], 0
		jz	short loc_1606
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_15FC
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_15FC:				; CODE XREF: _ibm_4758_load_privkey+1F8j
		push	1C4h
		jmp	loc_1576
; ---------------------------------------------------------------------------

loc_1606:				; CODE XREF: _ibm_4758_load_privkey+1EFj
		lea	eax, [esp+0C48h+var_AC8]
		push	eax		; void *
		lea	eax, [esp+0C4Ch+var_C28]
		push	eax		; int
		lea	eax, [esp+0C50h+var_C1C]
		push	eax		; int
		lea	eax, [esp+0C54h+var_BC8]
		push	eax		; Dst
		lea	eax, [esp+0C58h+var_C2C]
		push	eax		; int
		lea	eax, [esp+0C5Ch+var_9C8]
		push	eax		; int
		call	_getModulusAndExponent
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1672
		push	1CCh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	68h ; 'h'
		push	67h ; 'g'
		call	_ERR_CCA4758_error
		add	esp, 10h

$err$24:
		push	esi
		call	_CRYPTO_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+0C3Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C3Ch
		retn
; ---------------------------------------------------------------------------

loc_1672:				; CODE XREF: _ibm_4758_load_privkey+23Fj
		mov	eax, [esp+0C48h+var_C38]
		push	ebx
		mov	[esi], eax
		call	_RSA_new_method
		push	esi
		push	_hndidx
		mov	edi, eax
		push	edi
		call	_RSA_set_ex_data
		push	0
		push	[esp+0C5Ch+var_C2C]
		lea	eax, [esp+0C60h+var_BC8]
		push	eax
		call	_BN_bin2bn
		push	0
		push	[esp+0C68h+var_C28]
		mov	[edi+14h], eax
		lea	eax, [esp+0C6Ch+var_AC8]
		push	eax
		call	_BN_bin2bn
		or	dword ptr [edi+3Ch], 20h
		mov	[edi+10h], eax
		call	_EVP_PKEY_new
		push	edi
		mov	esi, eax
		push	6
		push	esi
		call	_EVP_PKEY_assign
		mov	ecx, [esp+0C7Ch+var_4]
		add	esp, 34h
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C3Ch
		retn
_ibm_4758_load_privkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 16ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ibm_4758_load_pubkey(int,	void *Src)
_ibm_4758_load_pubkey proc near		; DATA XREF: _bind_helper+B9o

var_474		= dword	ptr -474h
var_470		= dword	ptr -470h
var_46C		= dword	ptr -46Ch
var_468		= dword	ptr -468h
var_464		= dword	ptr -464h
var_460		= byte ptr -460h
var_45C		= byte ptr -45Ch
var_458		= dword	ptr -458h
var_454		= byte ptr -454h
var_44C		= byte ptr -44Ch
Dst		= byte ptr -444h
var_404		= byte ptr -404h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8

		mov	eax, 474h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+474h+var_4], eax
		push	ebx
		mov	ebx, [esp+478h+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+480h+Src]
		mov	esi, edi
		mov	[esp+480h+var_474], 9C4h
		mov	[esp+480h+var_464], 0
		mov	[esp+480h+var_468], 0
		lea	ecx, [esi+1]

loc_1732:				; CODE XREF: _ibm_4758_load_pubkey+4Bj
		mov	al, [esi]
		inc	esi
		test	al, al
		jnz	short loc_1732
		sub	esi, ecx
		mov	[esp+480h+var_46C], 200h
		mov	[esp+480h+var_470], 200h
		cmp	esi, 40h ; '@'
		jbe	short loc_1794
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_1763
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_1763:				; CODE XREF: _ibm_4758_load_pubkey+6Bj
		push	1FAh
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	6Bh ; 'k'
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+474h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 474h
		retn
; ---------------------------------------------------------------------------

loc_1794:				; CODE XREF: _ibm_4758_load_pubkey+62j
		push	40h ; '@'       ; Size
		lea	eax, [esp+484h+Dst]
		push	20h ; ' '       ; Val
		push	eax		; Dst
		call	_memset
		push	esi		; Size
		lea	eax, [esp+490h+Dst]
		push	edi		; Src
		push	eax		; Dst
		call	_memcpy
		push	201h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	9C8h
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 24h
		test	esi, esi
		jnz	short loc_180F
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_17DE
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_17DE:				; CODE XREF: _ibm_4758_load_pubkey+E6j
		push	203h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+474h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 474h
		retn
; ---------------------------------------------------------------------------

loc_180F:				; CODE XREF: _ibm_4758_load_pubkey+DDj
		lea	edi, [esi+4]
		push	edi
		lea	eax, [esp+484h+var_474]
		push	eax
		lea	eax, [esp+488h+Dst]
		push	eax
		lea	eax, [esp+48Ch+var_454]
		push	eax
		lea	eax, [esp+490h+var_468]
		push	eax
		lea	eax, [esp+494h+var_44C]
		push	eax
		lea	eax, [esp+498h+var_464]
		push	eax
		lea	eax, [esp+49Ch+var_45C]
		push	eax
		lea	eax, [esp+4A0h+var_460]
		push	eax
		call	ds:_keyRecordRead
		cmp	dword ptr [esp+480h+var_460], 0
		jz	short loc_1869
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_185B
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_185B:				; CODE XREF: _ibm_4758_load_pubkey+163j
		push	20Ch
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	41h ; 'A'
		jmp	short loc_18B4
; ---------------------------------------------------------------------------

loc_1869:				; CODE XREF: _ibm_4758_load_pubkey+15Aj
		lea	eax, [esp+480h+var_204]
		push	eax		; void *
		lea	eax, [esp+484h+var_46C]
		push	eax		; int
		lea	eax, [esp+488h+var_458]
		push	eax		; int
		lea	eax, [esp+48Ch+var_404]
		push	eax		; Dst
		lea	eax, [esp+490h+var_470]
		push	eax		; int
		push	edi		; int
		call	_getModulusAndExponent
		add	esp, 18h
		test	eax, eax
		jnz	short loc_18E2
		mov	eax, ds:_CCA4758_lib_error_code
		test	eax, eax
		jnz	short loc_18A8
		call	_ERR_get_next_error_library
		mov	ds:_CCA4758_lib_error_code, eax

loc_18A8:				; CODE XREF: _ibm_4758_load_pubkey+1B0j
		push	214h
		push	offset ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ ; ".\\engines\\e_4758cca.c"
		push	69h ; 'i'

loc_18B4:				; CODE XREF: _ibm_4758_load_pubkey+17Bj
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$23_0:
		push	esi
		call	_CRYPTO_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+474h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 474h
		retn
; ---------------------------------------------------------------------------

loc_18E2:				; CODE XREF: _ibm_4758_load_pubkey+1A7j
		mov	eax, [esp+480h+var_474]
		push	ebx
		mov	[esi], eax
		call	_RSA_new_method
		push	esi
		push	_hndidx
		mov	edi, eax
		push	edi
		call	_RSA_set_ex_data
		push	0
		push	[esp+494h+var_470]
		lea	eax, [esp+498h+var_404]
		push	eax
		call	_BN_bin2bn
		push	0
		push	[esp+4A0h+var_46C]
		mov	[edi+14h], eax
		lea	eax, [esp+4A4h+var_204]
		push	eax
		call	_BN_bin2bn
		or	dword ptr [edi+3Ch], 20h
		mov	[edi+10h], eax
		call	_EVP_PKEY_new
		push	edi
		mov	esi, eax
		push	6
		push	esi
		call	_EVP_PKEY_assign
		mov	ecx, [esp+4B4h+var_4]
		add	esp, 34h
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 474h
		retn
_ibm_4758_load_pubkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 195Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_set_CCA4758_LIB_NAME proc near		; CODE XREF: _ibm_4758_cca_ctrl+A9p

arg_0		= dword	ptr  4

		mov	eax, ds:_CCA4758_LIB_NAME
		test	eax, eax
		jz	short loc_196E
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_196E:				; CODE XREF: _set_CCA4758_LIB_NAME+7j
		push	[esp+arg_0]
		mov	ds:_CCA4758_LIB_NAME, 0
		call	_BUF_strdup
		xor	ecx, ecx
		mov	ds:_CCA4758_LIB_NAME, eax
		add	esp, 4
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		retn
_set_CCA4758_LIB_NAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1994h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19ACh
; COMDAT (pick any)
		public ??_C@_08HAODNNAF@CSUNSAPI?$AA@
; `string'
??_C@_08HAODNNAF@CSUNSAPI?$AA@ db 'CSUNSAPI',0 ; DATA XREF: _get_CCA4758_LIB_NAME+6o
					; _ibm_4758_cca_init+32o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19B8h
; COMDAT (pick any)
		public ??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@
; `string'
??_C@_0BG@JHENGPJN@?4?2engines?2e_4758cca?4c?$AA@ db '.\engines\e_4758cca.c',0
					; DATA XREF: _cca_rsa_sign+D8o
					; _cca_rsa_sign+11Do ...
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19D0h
; COMDAT (pick any)
		public ??_C@_0BM@LODLBGBO@IBM?54758?5CCA?5RSA?5key?5handle?$AA@
; `string'
??_C@_0BM@LODLBGBO@IBM?54758?5CCA?5RSA?5key?5handle?$AA@ db 'IBM 4758 CCA RSA key handle',0
					; DATA XREF: _ibm_4758_cca_init+14Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19ECh
; COMDAT (pick any)
		public ??_C@_07MLKJJPOC@PKCS?91?42@
; `string'
??_C@_07MLKJJPOC@PKCS?91?42@ dd	53434B50h ; DATA XREF: _cca_rsa_pub_enc+27r
					; _cca_rsa_priv_dec+27r
dword_19F0	dd 322E312Dh		; DATA XREF: _cca_rsa_pub_enc+35r
					; _cca_rsa_priv_dec+35r
		db 0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19F8h
; COMDAT (pick any)
		public ??_C@_07FCKAMOFI@PKCS?91?41@
; `string'
??_C@_07FCKAMOFI@PKCS?91?41@ dd	53434B50h ; DATA XREF: _cca_rsa_sign+4Ar
					; _cca_rsa_verify+44r
dword_19FC	dd 312E312Dh		; DATA XREF: _cca_rsa_sign+53r
					; _cca_rsa_verify+4Dr
		db 0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1A04h
; COMDAT (pick any)
		public ??_C@_08DOIMCLLG@RANDOM?5?5?$AA@
; `string'
??_C@_08DOIMCLLG@RANDOM?5?5?$AA@ dq 20204D4F444E4152h ;	DATA XREF: _cca_get_random_bytes+15r
byte_1A0C	db 0			; DATA XREF: _cca_get_random_bytes+1Dr
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_malloc:near ; CODE XREF: _cca_rsa_sign+1FBp
					; _cca_rsa_sign+24Cp ...
		extrn _CRYPTO_free:near	; CODE XREF: _cca_rsa_sign+2F0p
					; _cca_rsa_verify+2DAp	...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _cca_rsa_sign+2EAp
					; _cca_rsa_verify+2D4p
		extrn _DSO_free:near	; CODE XREF: _ibm_4758_cca_finish+53p
					; _ibm_4758_cca_init+19Ap
		extrn _DSO_load:near	; CODE XREF: _ibm_4758_cca_init+43p
		extrn _DSO_bind_func:near ; CODE XREF: _ibm_4758_cca_init+78p
					; _ibm_4758_cca_init+99p ...
		extrn _BUF_strdup:near	; CODE XREF: _set_CCA4758_LIB_NAME+20p
		extrn _BN_bin2bn:near	; CODE XREF: _ibm_4758_load_privkey+2A3p
					; _ibm_4758_load_privkey+2B9p ...
		extrn _OBJ_nid2obj:near	; CODE XREF: _cca_rsa_sign+B0p
					; _cca_rsa_verify+A2p
		extrn _EVP_PKEY_assign:near ; CODE XREF: _ibm_4758_load_privkey+2D0p
					; _ibm_4758_load_pubkey+24Cp
		extrn _EVP_PKEY_new:near ; CODE	XREF: _ibm_4758_load_privkey+2C5p
					; _ibm_4758_load_pubkey+241p
		extrn _RSA_new_method:near ; CODE XREF:	_ibm_4758_load_privkey+281p
					; _ibm_4758_load_pubkey+1FDp
		extrn _RSA_size:near	; CODE XREF: _cca_rsa_sign+162p
					; _cca_rsa_verify+154p	...
		extrn _RSA_get_ex_new_index:near ; CODE	XREF: _ibm_4758_cca_init+153p
		extrn _RSA_set_ex_data:near ; CODE XREF: _ibm_4758_load_privkey+290p
					; _ibm_4758_load_pubkey+20Cp
		extrn _RSA_get_ex_data:near ; CODE XREF: _cca_rsa_sign+75p
					; _cca_rsa_verify+67p ...
		extrn _i2d_X509_SIG:near ; CODE	XREF: _cca_rsa_sign+155p
					; _cca_rsa_sign+28Cp ...
		extrn _ERR_put_error:near ; CODE XREF: _cca_rsa_sign+E2p
					; _cca_rsa_verify+D4p ...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_CCA4758_strings+2Cp
					; _ERR_load_CCA4758_strings+3Cp
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_CCA4758_strings+14p
					; _ERR_unload_CCA4758_strings+24p ...
		extrn _ERR_get_next_error_library:near ; CODE XREF: _cca_rsa_sign+C9p
					; _cca_rsa_sign+10Ep ...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_helper+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_helper+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_helper+39p
		extrn _ENGINE_set_RAND:near ; CODE XREF: _bind_helper+4Fp
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_helper+65p
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_helper+77p
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_helper+89p
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_helper+9Bp
		extrn _ENGINE_set_load_privkey_function:near ; CODE XREF: _bind_helper+ADp
		extrn _ENGINE_set_load_pubkey_function:near ; CODE XREF: _bind_helper+BFp
		extrn _ENGINE_set_cmd_defns:near ; CODE	XREF: _bind_helper+D1p
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _cca_rsa_sign+F6p
					; _cca_rsa_sign+1D7p ...
		extrn __chkstk:near	; CODE XREF: _cca_rsa_sign+5p
					; _cca_rsa_verify+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _cca_get_random_bytes+B3p
					; _getModulusAndExponent+61p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ibm_4758_load_privkey+BBp
					; _ibm_4758_load_pubkey+B1p
		extrn ___security_cookie:near ;	DATA XREF: _cca_rsa_sign+Ar
					; _cca_rsa_verify+Ar ...


		end
