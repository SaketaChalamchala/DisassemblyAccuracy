;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	9F41A55246513A61299F469C58BECC83
; Input	CRC32 :	77C4CE4F

; File Name   :	C:\compspace\Diff\openssl\obj\eng_ctrl.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
_int_no_description dd offset ??_C@_00CNPNBAHC@?$AA@ ; DATA XREF: _int_ctrl_helper:loc_5BBr
					; _int_ctrl_helper:loc_5F1r
_data		ends			; `string'

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	byte public 'DATA' use32
		assume cs:_rdata
		;org 4
; COMDAT (pick any)
		public ??_C@_00CNPNBAHC@?$AA@
; `string'
??_C@_00CNPNBAHC@?$AA@ db 0		; DATA XREF: .data:_int_no_descriptiono
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ENGINE_cmd_is_executable
_ENGINE_cmd_is_executable proc near	; CODE XREF: _ENGINE_ctrl_cmd_string+40p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	0
		push	[esp+8+arg_4]
		push	12h
		push	[esp+10h+arg_0]
		call	_ENGINE_ctrl
		add	esp, 14h
		test	eax, eax
		jns	short loc_43
		push	0EDh ; 'Ì'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	8Ah ; 'ä'
		push	0AAh ; '™'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_43:					; CODE XREF: _ENGINE_cmd_is_executable+18j
		test	al, 7
		mov	eax, 0
		setnz	al
		retn
_ENGINE_cmd_is_executable endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 50h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ENGINE_ctrl
_ENGINE_ctrl	proc near		; CODE XREF: _ENGINE_cmd_is_executable+Ep
					; _ENGINE_ctrl_cmd+1Fp	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_78
		push	0B7h ; '∑'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	43h ; 'C'
		push	8Eh ; 'é'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_78:					; CODE XREF: _ENGINE_ctrl+7j
		push	ebx
		push	edi
		push	0BAh ; '∫'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		push	0BCh ; 'º'
		xor	ebx, ebx
		cmp	[esi+58h], ebx
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	1Eh
		push	0Ah
		setnle	bl
		call	_CRYPTO_lock
		mov	edi, [esi+40h]
		xor	ecx, ecx
		add	esp, 20h
		test	edi, edi
		setnz	cl
		test	ebx, ebx
		jnz	short loc_CA
		push	0BFh ; 'ø'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	82h ; 'Ç'
		jmp	short loc_135
; ---------------------------------------------------------------------------

loc_CA:					; CODE XREF: _ENGINE_ctrl+67j
		mov	edx, [esp+0Ch+arg_4]
		cmp	edx, 0Ah
		jz	loc_161
		lea	eax, [edx-0Bh]
		cmp	eax, 7
		ja	short loc_125
		test	ecx, ecx
		jz	short loc_103
		test	byte ptr [esi+54h], 2
		jnz	short loc_14A
		push	[esp+0Ch+arg_10]
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_8]
		push	edx
		push	esi
		call	_int_ctrl_helper
		add	esp, 14h
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_103:				; CODE XREF: _ENGINE_ctrl+91j
		push	0D4h ; '‘'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	78h ; 'x'
		push	8Eh ; 'é'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_125:				; CODE XREF: _ENGINE_ctrl+8Dj
		test	ecx, ecx
		jnz	short loc_14A
		push	0E1h ; '·'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	78h ; 'x'

loc_135:				; CODE XREF: _ENGINE_ctrl+78j
		push	8Eh ; 'é'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_14A:				; CODE XREF: _ENGINE_ctrl+97j
					; _ENGINE_ctrl+D7j
		push	[esp+0Ch+arg_10]
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_8]
		push	edx
		push	esi
		call	edi
		add	esp, 14h
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_161:				; CODE XREF: _ENGINE_ctrl+81j
		pop	edi
		pop	ebx
		mov	eax, ecx
		pop	esi
		retn
_ENGINE_ctrl	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 168h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ENGINE_ctrl_cmd
_ENGINE_ctrl_cmd proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_1E9
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	short loc_1E9
		cmp	dword ptr [esi+40h], 0
		jz	short loc_1B4
		push	0
		push	eax
		push	0
		push	0Dh
		push	esi
		call	_ENGINE_ctrl
		add	esp, 14h
		test	eax, eax
		jle	short loc_1B4
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	eax
		push	esi
		call	_ENGINE_ctrl
		xor	ecx, ecx
		add	esp, 14h
		test	eax, eax
		setnle	cl
		mov	eax, ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1B4:				; CODE XREF: _ENGINE_ctrl_cmd+15j
					; _ENGINE_ctrl_cmd+29j
		cmp	[esp+4+arg_14],	0
		jz	short loc_1C7
		call	_ERR_clear_error
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1C7:				; CODE XREF: _ENGINE_ctrl_cmd+51j
		push	110h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	89h ; 'â'
		push	0B2h ; '≤'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1E9:				; CODE XREF: _ENGINE_ctrl_cmd+7j
					; _ENGINE_ctrl_cmd+Fj
		push	0FDh ; '˝'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	43h ; 'C'
		push	0B2h ; '≤'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_ENGINE_ctrl_cmd endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 208h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ENGINE_ctrl_cmd_string(char *EndPtr, int,	char *Str, int)
		public _ENGINE_ctrl_cmd_string
_ENGINE_ctrl_cmd_string	proc near

EndPtr		= dword	ptr  4
arg_4		= dword	ptr  8
Str		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+EndPtr]
		test	esi, esi
		jz	loc_394
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	loc_394
		cmp	dword ptr [esi+40h], 0
		push	edi
		jz	loc_35D
		push	0
		push	eax
		push	0
		push	0Dh
		push	esi
		call	_ENGINE_ctrl
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jle	loc_35D
		push	edi
		push	esi
		call	_ENGINE_cmd_is_executable
		add	esp, 8
		test	eax, eax
		jnz	short loc_268
		push	13Ch
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	86h ; 'Ü'
		jmp	loc_380
; ---------------------------------------------------------------------------

loc_268:				; CODE XREF: _ENGINE_ctrl_cmd_string+4Aj
		push	0
		push	0
		push	edi
		push	12h
		push	esi
		call	_ENGINE_ctrl
		add	esp, 14h
		test	eax, eax
		jns	short loc_28D
		push	146h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	6Eh ; 'n'
		jmp	loc_380
; ---------------------------------------------------------------------------

loc_28D:				; CODE XREF: _ENGINE_ctrl_cmd_string+72j
		test	al, 4
		jz	short loc_2C8
		cmp	[esp+8+Str], 0
		jz	short loc_2AC
		push	14Fh
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	88h ; 'à'
		jmp	loc_380
; ---------------------------------------------------------------------------

loc_2AC:				; CODE XREF: _ENGINE_ctrl_cmd_string+8Ej
		push	0
		push	0
		push	0
		push	edi
		push	esi
		call	_ENGINE_ctrl
		add	esp, 14h
		xor	ecx, ecx
		test	eax, eax
		setnle	cl
		pop	edi
		mov	eax, ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_2C8:				; CODE XREF: _ENGINE_ctrl_cmd_string+87j
		push	ebx
		mov	ebx, [esp+0Ch+Str]
		test	ebx, ebx
		jnz	short loc_2E2
		push	15Fh
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	87h ; 'á'
		jmp	short loc_348
; ---------------------------------------------------------------------------

loc_2E2:				; CODE XREF: _ENGINE_ctrl_cmd_string+C7j
		test	al, 2
		jz	short loc_2ED
		push	0
		push	ebx
		push	0
		jmp	short loc_322
; ---------------------------------------------------------------------------

loc_2ED:				; CODE XREF: _ENGINE_ctrl_cmd_string+DCj
		test	al, 1
		jnz	short loc_2FF
		push	171h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	6Eh ; 'n'
		jmp	short loc_348
; ---------------------------------------------------------------------------

loc_2FF:				; CODE XREF: _ENGINE_ctrl_cmd_string+E7j
		push	0Ah		; Radix
		lea	eax, [esp+10h+EndPtr]
		push	eax		; EndPtr
		push	ebx		; Str
		call	dword ptr ds:__imp__strtol
		mov	ecx, [esp+18h+EndPtr]
		add	esp, 0Ch
		cmp	ebx, ecx
		jz	short loc_339
		cmp	byte ptr [ecx],	0
		jnz	short loc_339
		push	0
		push	0
		push	eax

loc_322:				; CODE XREF: _ENGINE_ctrl_cmd_string+E3j
		push	edi
		push	esi
		call	_ENGINE_ctrl
		add	esp, 14h
		xor	ecx, ecx
		test	eax, eax
		setnle	cl
		pop	ebx
		pop	edi
		mov	eax, ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_339:				; CODE XREF: _ENGINE_ctrl_cmd_string+10Ej
					; _ENGINE_ctrl_cmd_string+113j
		push	177h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	85h ; 'Ö'

loc_348:				; CODE XREF: _ENGINE_ctrl_cmd_string+D8j
					; _ENGINE_ctrl_cmd_string+F5j
		push	0ABh ; '´'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_35D:				; CODE XREF: _ENGINE_ctrl_cmd_string+1Ej
					; _ENGINE_ctrl_cmd_string+38j
		cmp	[esp+8+arg_C], 0
		jz	short loc_371
		call	_ERR_clear_error
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_371:				; CODE XREF: _ENGINE_ctrl_cmd_string+15Aj
		push	137h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	89h ; 'â'

loc_380:				; CODE XREF: _ENGINE_ctrl_cmd_string+5Bj
					; _ENGINE_ctrl_cmd_string+80j ...
		push	0ABh ; '´'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_394:				; CODE XREF: _ENGINE_ctrl_cmd_string+7j
					; _ENGINE_ctrl_cmd_string+13j
		push	124h
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	43h ; 'C'
		push	0ABh ; '´'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_ENGINE_ctrl_cmd_string	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_int_ctrl_cmd_by_name proc near		; CODE XREF: _int_ctrl_helper+5Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		xor	edi, edi
		nop	dword ptr [eax]

loc_3C4:				; CODE XREF: _int_ctrl_cmd_by_name+4Dj
		cmp	dword ptr [esi], 0
		jz	short loc_414
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_403
		mov	ecx, ebx
		xchg	ax, ax

loc_3D4:				; CODE XREF: _int_ctrl_cmd_by_name+3Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_3F4
		test	dl, dl
		jz	short loc_3F0
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_3F4
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_3D4

loc_3F0:				; CODE XREF: _int_ctrl_cmd_by_name+28j
		xor	eax, eax
		jmp	short loc_3F9
; ---------------------------------------------------------------------------

loc_3F4:				; CODE XREF: _int_ctrl_cmd_by_name+24j
					; _int_ctrl_cmd_by_name+30j
		sbb	eax, eax
		or	eax, 1

loc_3F9:				; CODE XREF: _int_ctrl_cmd_by_name+3Ej
		test	eax, eax
		jz	short loc_403
		inc	edi
		add	esi, 10h
		jmp	short loc_3C4
; ---------------------------------------------------------------------------

loc_403:				; CODE XREF: _int_ctrl_cmd_by_name+1Aj
					; _int_ctrl_cmd_by_name+47j
		cmp	dword ptr [esi], 0
		jz	short loc_414
		cmp	dword ptr [esi+4], 0
		jz	short loc_414
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_414:				; CODE XREF: _int_ctrl_cmd_by_name+13j
					; _int_ctrl_cmd_by_name+52j ...
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
_int_ctrl_cmd_by_name endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 41Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_int_ctrl_cmd_by_num proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		xor	edx, edx
		push	esi
		mov	esi, [esp+4+arg_4]
		nop	dword ptr [eax+eax+00h]

loc_42C:				; CODE XREF: _int_ctrl_cmd_by_num+24j
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_442
		cmp	dword ptr [eax+4], 0
		jz	short loc_442
		cmp	ecx, esi
		jnb	short loc_442
		inc	edx
		add	eax, 10h
		jmp	short loc_42C
; ---------------------------------------------------------------------------

loc_442:				; CODE XREF: _int_ctrl_cmd_by_num+14j
					; _int_ctrl_cmd_by_num+1Aj ...
		or	ecx, 0FFFFFFFFh
		cmp	[eax], esi
		pop	esi
		cmovz	ecx, edx
		mov	eax, ecx
		retn
_int_ctrl_cmd_by_num endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 450h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_int_ctrl_cmd_is_null proc near		; CODE XREF: _int_ctrl_helper+F3p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_462
		cmp	dword ptr [eax+4], 0
		jz	short loc_462
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_462:				; CODE XREF: _int_ctrl_cmd_is_null+7j
					; _int_ctrl_cmd_is_null+Dj
		mov	eax, 1
		retn
_int_ctrl_cmd_is_null endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 468h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_int_ctrl_helper proc near		; CODE XREF: _ENGINE_ctrl+A7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_4]
		cmp	esi, 0Bh
		jnz	short loc_490
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_48C
		cmp	dword ptr [eax], 0
		jz	short loc_48C
		cmp	dword ptr [eax+4], 0
		jz	short loc_48C
		mov	eax, [eax]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_48C:				; CODE XREF: _int_ctrl_helper+13j
					; _int_ctrl_helper+18j	...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_490:				; CODE XREF: _int_ctrl_helper+8j
		push	ebp
		mov	ebp, [esp+8+arg_C]
		cmp	esi, 0Dh
		jz	short loc_4A4
		cmp	esi, 0Fh
		jz	short loc_4A4
		cmp	esi, 11h
		jnz	short loc_4B3

loc_4A4:				; CODE XREF: _int_ctrl_helper+30j
					; _int_ctrl_helper+35j
		test	ebp, ebp
		jnz	short loc_4B3
		push	7Bh ; '{'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	43h ; 'C'
		jmp	short loc_4E8
; ---------------------------------------------------------------------------

loc_4B3:				; CODE XREF: _int_ctrl_helper+3Aj
					; _int_ctrl_helper+3Ej
		mov	eax, [esp+8+arg_0]
		cmp	esi, 0Dh
		jnz	short loc_4FD
		mov	esi, [eax+50h]
		test	esi, esi
		jz	short loc_4D9
		push	ebp
		push	esi
		call	_int_ctrl_cmd_by_name
		add	esp, 8
		test	eax, eax
		js	short loc_4D9
		add	eax, eax
		pop	ebp
		mov	eax, [esi+eax*8]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4D9:				; CODE XREF: _int_ctrl_helper+59j
					; _int_ctrl_helper+67j
		push	83h ; 'É'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	89h ; 'â'

loc_4E8:				; CODE XREF: _int_ctrl_helper+49j
		push	0ACh ; '¨'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4FD:				; CODE XREF: _int_ctrl_helper+52j
		push	edi
		mov	edi, [eax+50h]
		test	edi, edi
		jz	loc_634
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		mov	ecx, edi
		xor	eax, eax
		nop	word ptr [eax+eax+00h]

loc_518:				; CODE XREF: _int_ctrl_helper+C4j
		mov	edx, [ecx]
		test	edx, edx
		jz	short loc_52E
		cmp	dword ptr [ecx+4], 0
		jz	short loc_52E
		cmp	edx, ebx
		jnb	short loc_530
		inc	eax
		add	ecx, 10h
		jmp	short loc_518
; ---------------------------------------------------------------------------

loc_52E:				; CODE XREF: _int_ctrl_helper+B4j
					; _int_ctrl_helper+BAj
		cmp	edx, ebx

loc_530:				; CODE XREF: _int_ctrl_helper+BEj
		pop	ebx
		jnz	loc_634
		test	eax, eax
		js	loc_634
		add	esi, 0FFFFFFF4h	; switch 7 cases
		cmp	esi, 6
		ja	$LN2		; jumptable 0000054B default case
		jmp	ds:$LN57[esi*4]	; switch jump
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		lea	ecx, [eax+1]	; jumptable 0000054B case 12
		shl	ecx, 4
		add	ecx, edi
		push	ecx
		call	_int_ctrl_cmd_is_null
		add	esp, 4
		test	eax, eax
		jz	short loc_56D
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_56D:				; CODE XREF: _int_ctrl_helper+FDj
		mov	eax, [ecx]
		pop	edi
		pop	ebp
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		add	eax, eax	; jumptable 0000054B case 14
		mov	eax, [edi+eax*8+4]
		lea	edx, [eax+1]

loc_57C:				; CODE XREF: _int_ctrl_helper+119j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_57C
		pop	edi
		pop	ebp
		sub	eax, edx
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN19:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		add	eax, eax	; jumptable 0000054B case 15
		mov	edx, [edi+eax*8+4]
		mov	ecx, edx
		lea	esi, [ecx+1]
		nop	dword ptr [eax+00h]

loc_598:				; CODE XREF: _int_ctrl_helper+135j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_598
		jmp	short loc_603
; ---------------------------------------------------------------------------

$LN20:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		add	eax, eax	; jumptable 0000054B case 16
		mov	eax, [edi+eax*8+8]
		test	eax, eax
		jz	short loc_5BB
		lea	edx, [eax+1]

loc_5AE:				; CODE XREF: _int_ctrl_helper+14Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_5AE
		pop	edi
		pop	ebp
		sub	eax, edx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_5BB:				; CODE XREF: _int_ctrl_helper+141j
		mov	eax, _int_no_description
		lea	edx, [eax+1]
		nop	dword ptr [eax+eax+00h]

loc_5C8:				; CODE XREF: _int_ctrl_helper+165j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_5C8
		pop	edi
		pop	ebp
		sub	eax, edx
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN22:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		add	eax, eax	; jumptable 0000054B case 17
		mov	edx, [edi+eax*8+8]
		test	edx, edx
		jz	short loc_5F1
		mov	ecx, edx
		lea	esi, [ecx+1]
		nop	dword ptr [eax+00h]

loc_5E8:				; CODE XREF: _int_ctrl_helper+185j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_5E8
		jmp	short loc_603
; ---------------------------------------------------------------------------

loc_5F1:				; CODE XREF: _int_ctrl_helper+175j
		mov	edx, _int_no_description
		mov	ecx, edx
		lea	esi, [ecx+1]

loc_5FC:				; CODE XREF: _int_ctrl_helper+199j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_5FC

loc_603:				; CODE XREF: _int_ctrl_helper+137j
					; _int_ctrl_helper+187j
		sub	ecx, esi
		push	edx
		push	offset ??_C@_02DKCKIIND@?$CFs?$AA@ ; `string'
		lea	eax, [ecx+1]
		push	eax
		push	ebp
		call	_BIO_snprintf
		add	esp, 10h
		pop	edi
		pop	ebp
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN24:					; CODE XREF: _int_ctrl_helper+E3j
					; DATA XREF: .text$mn:$LN57o
		add	eax, eax	; jumptable 0000054B case 18
		mov	eax, [edi+eax*8+0Ch]
		pop	edi
		pop	ebp
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN2:					; CODE XREF: _int_ctrl_helper+DDj
					; _int_ctrl_helper+E3j
					; DATA XREF: ...
		push	0AFh ; 'Ø'      ; jumptable 0000054B default case
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	6Eh ; 'n'
		jmp	short loc_643
; ---------------------------------------------------------------------------

loc_634:				; CODE XREF: _int_ctrl_helper+9Bj
					; _int_ctrl_helper+C9j	...
		push	8Fh ; 'è'
		push	offset ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@ ; ".\\crypto\\engine\\eng_ctrl.c"
		push	8Ah ; 'ä'

loc_643:				; CODE XREF: _int_ctrl_helper+1CAj
		push	0ACh ; '¨'
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebp
		pop	esi
		retn
_int_ctrl_helper endp

; ---------------------------------------------------------------------------
		align 4
$LN57		dd offset $LN15		; DATA XREF: _int_ctrl_helper+E3r
		dd offset $LN2		; jump table for switch	statement
		dd offset $LN17
		dd offset $LN19
		dd offset $LN20
		dd offset $LN22
		dd offset $LN24
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 678h
; COMDAT (pick any)
		public ??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@
; `string'
??_C@_0BL@IFOBOMPO@?4?2crypto?2engine?2eng_ctrl?4c?$AA@	db '.\crypto\engine\eng_ctrl.c',0
					; DATA XREF: _ENGINE_cmd_is_executable+1Fo
					; _ENGINE_ctrl+Eo ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 694h
; COMDAT (pick any)
		public ??_C@_02DKCKIIND@?$CFs?$AA@
; `string'
??_C@_02DKCKIIND@?$CFs?$AA@ db 25h, 73h, 0 ; DATA XREF:	_int_ctrl_helper+19Eo
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; __int32 __cdecl _strtol(const	char *Str, char	**EndPtr, int Radix)
		extrn __imp__strtol:near ; CODE	XREF: _ENGINE_ctrl_cmd_string+FFp
					; DATA XREF: _ENGINE_ctrl_cmd_string+FFr
		extrn _CRYPTO_lock:near	; CODE XREF: _ENGINE_ctrl+38p
					; _ENGINE_ctrl+53p
		extrn _BIO_snprintf:near ; CODE	XREF: _int_ctrl_helper+1A8p
		extrn _ERR_put_error:near ; CODE XREF: _ENGINE_cmd_is_executable+30p
					; _ENGINE_ctrl+1Cp ...
		extrn _ERR_clear_error:near ; CODE XREF: _ENGINE_ctrl_cmd+53p
					; _ENGINE_ctrl_cmd_string+15Cp


		end
