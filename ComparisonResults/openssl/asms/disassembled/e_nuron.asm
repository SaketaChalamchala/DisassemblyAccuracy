;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	7572B48F5AEC02D026FF88A63B36A708
; Input	CRC32 :	F784499D

; File Name   :	C:\compspace\Diff\openssl\obj\e_nuron.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
_NURON_str_functs dd 64000h		; DATA XREF: _ERR_load_NURON_strings+1Co
					; _ERR_unload_NURON_strings+9o	...
		dd offset ??_C@_0L@GCEGHMPK@NURON_CTRL?$AA@ ; "NURON_CTRL"
		dd 65000h
		dd offset ??_C@_0N@JOAELHNB@NURON_FINISH?$AA@ ;	"NURON_FINISH"
		dd 66000h
		dd offset ??_C@_0L@IFDKAHGI@NURON_INIT?$AA@ ; "NURON_INIT"
		dd 67000h
		dd offset ??_C@_0O@FCCEHILK@NURON_MOD_EXP?$AA@ ; "NURON_MOD_EXP"
		dd 2 dup(0)
_NURON_str_reasons dd offset off_64	; DATA XREF: _ERR_load_NURON_strings+31o
					; _ERR_unload_NURON_strings+19o ...
		dd offset ??_C@_0P@BJJHFGDF@already?5loaded?$AA@ ; "already loaded"
		dd offset off_64+1
		dd offset ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@ ; "ctrl command not implemented"
		dd offset off_64+2
		dd offset ??_C@_0M@DBMBNOIK@dso?5failure?$AA@ ;	"dso failure"
		dd offset off_64+3
		dd offset ??_C@_0BH@CFEKEEFE@dso?5function?5not?5found?$AA@ ; "dso function not	found"
		dd offset byte_68
		dd offset ??_C@_0O@BBPECCFC@dso?5not?5found?$AA@ ; "dso	not found"
		dd offset byte_69
		dd offset ??_C@_0L@ICAFOIA@not?5loaded?$AA@ ; "not loaded"
		align 10h
_NURON_lib_name	dd 0			; DATA XREF: _ERR_load_NURON_strings+4Bo
					; _ERR_load_NURON_strings+52w ...
off_64		dd offset ??_C@_0N@IPINHCKM@nuron?5engine?$AA@
					; DATA XREF: .data:_NURON_str_reasonso
					; .data:00000030o ...
					; "nuron engine"
byte_68		db 0			; DATA XREF: .data:00000048o
byte_69		db 3 dup(0)		; DATA XREF: .data:00000050o
		align 10h
_NURON_error_init dd 1			; DATA XREF: _ERR_load_NURON_strings:loc_527r
					; _ERR_load_NURON_strings+22w ...
_NURON_F1	dd offset ??_C@_0O@MBFCIPOI@nuron_mod_exp?$AA@
					; DATA XREF: _nuron_init:loc_A96r
					; "nuron_mod_exp"
_nuron_rsa	dd offset ??_C@_0BB@FHBGIEPG@Nuron?5RSA?5method?$AA@
					; DATA XREF: _bind_helper+33o
					; "Nuron RSA method"
dword_7C	dd 0			; DATA XREF: _bind_helper+E3w
dword_80	dd 0			; DATA XREF: _bind_helper+ECw
dword_84	dd 0			; DATA XREF: _bind_helper+F5w
dword_88	dd 0			; DATA XREF: _bind_helper+FEw
		dd offset _nuron_rsa_mod_exp
		dd offset _nuron_mod_exp_mont
		dd 7 dup(0)
_nuron_dsa	dd offset ??_C@_0BB@BBFFIKHO@Nuron?5DSA?5method?$AA@
					; DATA XREF: _bind_helper+49o
					; "Nuron DSA method"
dword_B4	dd 0			; DATA XREF: _bind_helper+10Bw
dword_B8	dd 0			; DATA XREF: _bind_helper+114w
dword_BC	dd 0			; DATA XREF: _bind_helper+11Dw
		dd offset _nuron_dsa_mod_exp
		dd offset _nuron_mod_exp_dsa
dword_C8	dd 6 dup(0)		; DATA XREF: .rdata:_nuron_cmd_defnso
_nuron_dh	dd offset ??_C@_0BA@EEPBPEJM@Nuron?5DH?5method?$AA@
					; DATA XREF: _bind_helper+5Fo
					; "Nuron DH method"
dword_E4	dd 0			; DATA XREF: _bind_helper+12Aw
dword_E8	dd 0			; DATA XREF: _bind_helper+133w
		dd offset _nuron_mod_exp_dh
		dd 5 dup(0)
_engine_nuron_id dd offset ??_C@_05DEDCPNOK@nuron?$AA@ ; DATA XREF: _bind_engine+75r
					; _bind_fn+8r ...
					; "nuron"
_engine_nuron_name dd offset ??_C@_0BO@CCBJMFJK@Nuron?5hardware?5engine?5support?$AA@
					; DATA XREF: _bind_helper+1Cr
_data		ends			; "Nuron hardware engine support"

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10Ch
; COMDAT (pick any)
		public ??_C@_0L@GCEGHMPK@NURON_CTRL?$AA@
; `string'
??_C@_0L@GCEGHMPK@NURON_CTRL?$AA@ db 'NURON_CTRL',0 ; DATA XREF: .data:00000004o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 118h
; COMDAT (pick any)
		public ??_C@_0N@JOAELHNB@NURON_FINISH?$AA@
; `string'
??_C@_0N@JOAELHNB@NURON_FINISH?$AA@ db 'NURON_FINISH',0 ; DATA XREF: .data:0000000Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 128h
; COMDAT (pick any)
		public ??_C@_0L@IFDKAHGI@NURON_INIT?$AA@
; `string'
??_C@_0L@IFDKAHGI@NURON_INIT?$AA@ db 'NURON_INIT',0 ; DATA XREF: .data:00000014o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 134h
; COMDAT (pick any)
		public ??_C@_0O@FCCEHILK@NURON_MOD_EXP?$AA@
; `string'
??_C@_0O@FCCEHILK@NURON_MOD_EXP?$AA@ db	'NURON_MOD_EXP',0 ; DATA XREF: .data:0000001Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 144h
; COMDAT (pick any)
		public ??_C@_0P@BJJHFGDF@already?5loaded?$AA@
; `string'
??_C@_0P@BJJHFGDF@already?5loaded?$AA@ db 'already loaded',0 ; DATA XREF: .data:0000002Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 154h
; COMDAT (pick any)
		public ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@
; `string'
??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@	db 'ctrl command not implemented',0
					; DATA XREF: .data:00000034o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 174h
; COMDAT (pick any)
		public ??_C@_0M@DBMBNOIK@dso?5failure?$AA@
; `string'
??_C@_0M@DBMBNOIK@dso?5failure?$AA@ db 'dso failure',0 ; DATA XREF: .data:0000003Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 180h
; COMDAT (pick any)
		public ??_C@_0BH@CFEKEEFE@dso?5function?5not?5found?$AA@
; `string'
??_C@_0BH@CFEKEEFE@dso?5function?5not?5found?$AA@ db 'dso function not found',0
					; DATA XREF: .data:00000044o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 198h
; COMDAT (pick any)
		public ??_C@_0O@BBPECCFC@dso?5not?5found?$AA@
; `string'
??_C@_0O@BBPECCFC@dso?5not?5found?$AA@ db 'dso not found',0 ; DATA XREF: .data:0000004Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1A8h
; COMDAT (pick any)
		public ??_C@_0L@ICAFOIA@not?5loaded?$AA@
; `string'
??_C@_0L@ICAFOIA@not?5loaded?$AA@ db 'not loaded',0 ; DATA XREF: .data:00000054o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B4h
; COMDAT (pick any)
		public ??_C@_0N@IPINHCKM@nuron?5engine?$AA@
; `string'
??_C@_0N@IPINHCKM@nuron?5engine?$AA@ db	'nuron engine',0 ; DATA XREF: .data:off_64o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 1C4h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
_NURON_lib_error_code dd ?		; DATA XREF: _nuron_rsa_mod_exp+13r
					; _nuron_rsa_mod_exp+21w ...
_NURON_LIBNAME	dd ?			; DATA XREF: _free_NURON_LIBNAMEr
					; _free_NURON_LIBNAME:loc_82Aw	...
_pfnModExp	dd ?			; DATA XREF: _nuron_rsa_mod_exp+48r
					; _nuron_dsa_mod_exp+74r ...
_pvDSOHandle	dd ?			; DATA XREF: _nuron_rsa_mod_expr
					; _nuron_dsa_mod_exp+1Ar ...
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1D4h
; COMDAT (pick any)
		public ??_C@_0O@MBFCIPOI@nuron_mod_exp?$AA@
; `string'
??_C@_0O@MBFCIPOI@nuron_mod_exp?$AA@ db	'nuron_mod_exp',0 ; DATA XREF: .data:_NURON_F1o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E4h
_nuron_cmd_defns dd offset dword_C8	; DATA XREF: _bind_helper+C9o
		dd offset ??_C@_07EGEBNIPD@SO_PATH?$AA@	; "SO_PATH"
		dd offset ??_C@_0DE@NILCJAND@Specifies?5the?5path?5to?5the?5?8nuron@ ; "Specifies the path to the 'nuronssl' sh"...
		dd 2, 4	dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 204h
; COMDAT (pick any)
		public ??_C@_07EGEBNIPD@SO_PATH?$AA@
; `string'
??_C@_07EGEBNIPD@SO_PATH?$AA@ db 'SO_PATH',0 ; DATA XREF: .rdata:000001E8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 20Ch
; COMDAT (pick any)
		public ??_C@_0DE@NILCJAND@Specifies?5the?5path?5to?5the?5?8nuron@
; `string'
??_C@_0DE@NILCJAND@Specifies?5the?5path?5to?5the?5?8nuron@ db 'Specifies the path to the ',27h,'nuronssl',27h,' shared library',0
					; DATA XREF: .rdata:000001ECo
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 240h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_rsa_mod_exp proc	near		; DATA XREF: .data:0000008Co

arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	ds:_pvDSOHandle, 0
		mov	eax, [esp+arg_8]
		mov	ecx, [eax+10h]
		mov	eax, [eax+18h]
		jnz	short loc_280
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_266
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_266:				; CODE XREF: _nuron_rsa_mod_exp+1Aj
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_280:				; CODE XREF: _nuron_rsa_mod_exp+11j
		mov	[esp+arg_C], ecx
		mov	[esp+arg_8], eax
		jmp	ds:_pfnModExp
_nuron_rsa_mod_exp endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 290h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_dsa_mod_exp proc	near		; DATA XREF: .data:000000C0o

var_14		= byte ptr -14h
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, 14h
		call	__chkstk
		push	esi
		lea	eax, [esp+18h+var_14]
		xor	esi, esi
		push	eax
		call	_BN_init
		add	esp, 4
		cmp	ds:_pvDSOHandle, esi
		jnz	short loc_2F0
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_2C5
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_2C5:				; CODE XREF: _nuron_dsa_mod_exp+29j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		lea	eax, [esp+18h+var_14]
		push	eax
		call	_BN_free
		add	esp, 4
		mov	eax, esi
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2F0:				; CODE XREF: _nuron_dsa_mod_exp+20j
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		push	edi
		mov	edi, [esp+20h+arg_18]
		push	edi
		push	[esp+24h+arg_C]
		push	[esp+28h+arg_8]
		push	ebx
		call	ds:_pfnModExp
		add	esp, 10h
		test	eax, eax
		jz	short loc_37E
		cmp	ds:_pvDSOHandle, esi
		jnz	short loc_345
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_32C
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_32C:				; CODE XREF: _nuron_dsa_mod_exp+90j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_37E
; ---------------------------------------------------------------------------

loc_345:				; CODE XREF: _nuron_dsa_mod_exp+87j
		push	edi
		push	[esp+24h+arg_14]
		lea	eax, [esp+28h+var_14]
		push	[esp+28h+arg_10]
		push	eax
		call	ds:_pfnModExp
		add	esp, 10h
		test	eax, eax
		jz	short loc_37E
		push	[esp+20h+arg_1C]
		lea	eax, [esp+24h+var_14]
		push	edi
		push	eax
		push	ebx
		push	ebx
		call	_BN_mod_mul
		add	esp, 14h
		mov	ecx, 1
		test	eax, eax
		cmovnz	esi, ecx

loc_37E:				; CODE XREF: _nuron_dsa_mod_exp+7Fj
					; _nuron_dsa_mod_exp+B3j ...
		pop	edi
		pop	ebx

$end$21:
		lea	eax, [esp+18h+var_14]
		push	eax
		call	_BN_free
		add	esp, 4
		mov	eax, esi
		pop	esi
		add	esp, 14h
		retn
_nuron_dsa_mod_exp endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 394h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_mod_exp_dsa proc	near		; DATA XREF: .data:000000C4o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	ds:_pvDSOHandle, 0
		jnz	short loc_3CA
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_3B0
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_3B0:				; CODE XREF: _nuron_mod_exp_dsa+10j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_3CA:				; CODE XREF: _nuron_mod_exp_dsa+7j
		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		call	ds:_pfnModExp
		add	esp, 10h
		retn
_nuron_mod_exp_dsa endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_mod_exp_mont proc near		; DATA XREF: .data:00000090o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	ds:_pvDSOHandle, 0
		jnz	short loc_41A
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_400
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_400:				; CODE XREF: _nuron_mod_exp_mont+10j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_41A:				; CODE XREF: _nuron_mod_exp_mont+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		call	ds:_pfnModExp
		add	esp, 10h
		retn
_nuron_mod_exp_mont endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 434h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_mod_exp_dh proc near		; DATA XREF: .data:000000ECo

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	ds:_pvDSOHandle, 0
		jnz	short loc_46A
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_450
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_450:				; CODE XREF: _nuron_mod_exp_dh+10j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_46A:				; CODE XREF: _nuron_mod_exp_dh+7j
		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		call	ds:_pfnModExp
		add	esp, 10h
		retn
_nuron_mod_exp_dh endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 484h
; COMDAT (pick any)
		public ??_C@_0BB@FHBGIEPG@Nuron?5RSA?5method?$AA@
; `string'
??_C@_0BB@FHBGIEPG@Nuron?5RSA?5method?$AA@ db 'Nuron RSA method',0
					; DATA XREF: .data:_nuron_rsao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 498h
; COMDAT (pick any)
		public ??_C@_0BB@BBFFIKHO@Nuron?5DSA?5method?$AA@
; `string'
??_C@_0BB@BBFFIKHO@Nuron?5DSA?5method?$AA@ db 'Nuron DSA method',0
					; DATA XREF: .data:_nuron_dsao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4ACh
; COMDAT (pick any)
		public ??_C@_0BA@EEPBPEJM@Nuron?5DH?5method?$AA@
; `string'
??_C@_0BA@EEPBPEJM@Nuron?5DH?5method?$AA@ db 'Nuron DH method',0
					; DATA XREF: .data:_nuron_dho
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4BCh
; COMDAT (pick any)
		public ??_C@_05DEDCPNOK@nuron?$AA@
; `string'
??_C@_05DEDCPNOK@nuron?$AA@ db 'nuron',0 ; DATA XREF: .data:_engine_nuron_ido
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4C4h
; COMDAT (pick any)
		public ??_C@_0BO@CCBJMFJK@Nuron?5hardware?5engine?5support?$AA@
; `string'
??_C@_0BO@CCBJMFJK@Nuron?5hardware?5engine?5support?$AA@ db 'Nuron hardware engine support',0
					; DATA XREF: .data:_engine_nuron_nameo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_NURON_error proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_4F7
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_4F7:				; CODE XREF: _ERR_NURON_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_NURON_error endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 514h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_NURON_strings	proc near	; CODE XREF: _bind_helper+138p
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_527
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_527:				; CODE XREF: _ERR_load_NURON_strings+7j
		cmp	_NURON_error_init, 0
		jz	short locret_573
		push	offset _NURON_str_functs
		push	eax
		mov	_NURON_error_init, 0
		call	_ERR_load_strings
		push	offset _NURON_str_reasons
		push	ds:_NURON_lib_error_code
		call	_ERR_load_strings
		movzx	eax, byte ptr ds:_NURON_lib_error_code
		shl	eax, 18h
		push	offset _NURON_lib_name
		push	0
		mov	_NURON_lib_name, eax
		call	_ERR_load_strings
		add	esp, 18h

locret_573:				; CODE XREF: _ERR_load_NURON_strings+1Aj
		retn
_ERR_load_NURON_strings	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 574h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_NURON_strings proc near
		cmp	_NURON_error_init, 0
		jnz	short locret_5B6
		push	offset _NURON_str_functs
		push	ds:_NURON_lib_error_code
		call	_ERR_unload_strings
		push	offset _NURON_str_reasons
		push	ds:_NURON_lib_error_code
		call	_ERR_unload_strings
		push	offset _NURON_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	_NURON_error_init, 1

locret_5B6:				; CODE XREF: _ERR_unload_NURON_strings+7j
		retn
_ERR_unload_NURON_strings endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$19
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_5DF

loc_5DB:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_5DF:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_5DB
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_5DB

$skip_cbs$19:				; CODE XREF: _bind_engine+Cj
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	short loc_665
		mov	ecx, _engine_nuron_id
		nop	dword ptr [eax+eax+00h]

loc_638:				; CODE XREF: _bind_engine+9Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_658
		test	dl, dl
		jz	short loc_654
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_658
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_638

loc_654:				; CODE XREF: _bind_engine+88j
		xor	eax, eax
		jmp	short loc_65D
; ---------------------------------------------------------------------------

loc_658:				; CODE XREF: _bind_engine+84j
					; _bind_engine+90j
		sbb	eax, eax
		or	eax, 1

loc_65D:				; CODE XREF: _bind_engine+9Ej
		test	eax, eax
		jnz	loc_5DB

loc_665:				; CODE XREF: _bind_engine+73j
		push	[esp+4+arg_0]
		call	_bind_helper
		add	esp, 4
		test	eax, eax
		jz	loc_5DB
		mov	eax, 1
		pop	esi
		retn
_bind_engine	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 680h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_fn	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_6BC
		mov	ecx, _engine_nuron_id
		xchg	ax, ax

loc_690:				; CODE XREF: _bind_fn+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_6B0
		test	dl, dl
		jz	short loc_6AC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_6B0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_690

loc_6AC:				; CODE XREF: _bind_fn+18j
		xor	eax, eax
		jmp	short loc_6B5
; ---------------------------------------------------------------------------

loc_6B0:				; CODE XREF: _bind_fn+14j _bind_fn+20j
		sbb	eax, eax
		or	eax, 1

loc_6B5:				; CODE XREF: _bind_fn+2Ej
		test	eax, eax
		jz	short loc_6BC
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_6BC:				; CODE XREF: _bind_fn+6j _bind_fn+37j
		push	[esp+arg_0]
		call	_bind_helper
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_fn	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6D0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near		; CODE XREF: _bind_engine+B1p
					; _bind_fn+40p

arg_0		= dword	ptr  4

		push	esi
		push	_engine_nuron_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	_engine_nuron_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_dsa
		push	esi
		call	_ENGINE_set_DSA
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_dh
		push	esi
		call	_ENGINE_set_DH
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	loc_814
		push	offset _nuron_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	short loc_814
		push	offset _nuron_cmd_defns
		push	esi
		call	_ENGINE_set_cmd_defns
		add	esp, 8
		test	eax, eax
		jz	short loc_814
		call	_RSA_PKCS1_SSLeay
		mov	ecx, [eax+4]
		mov	dword_7C, ecx
		mov	ecx, [eax+8]
		mov	dword_80, ecx
		mov	ecx, [eax+0Ch]
		mov	dword_84, ecx
		mov	eax, [eax+10h]
		mov	dword_88, eax
		call	_DSA_OpenSSL
		mov	ecx, [eax+4]
		mov	dword_B4, ecx
		mov	ecx, [eax+8]
		mov	dword_B8, ecx
		mov	eax, [eax+0Ch]
		mov	dword_BC, eax
		call	_DH_OpenSSL
		mov	ecx, [eax+4]
		mov	dword_E4, ecx
		mov	eax, [eax+8]
		mov	dword_E8, eax
		call	_ERR_load_NURON_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_814:				; CODE XREF: _bind_helper+16j
					; _bind_helper+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_helper	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 818h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_free_NURON_LIBNAME proc near
		mov	eax, ds:_NURON_LIBNAME
		test	eax, eax
		jz	short loc_82A
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_82A:				; CODE XREF: _free_NURON_LIBNAME+7j
		mov	ds:_NURON_LIBNAME, 0
		retn
_free_NURON_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 838h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_NURON_LIBNAME proc	near
		mov	ecx, ds:_NURON_LIBNAME
		mov	eax, offset ??_C@_08CLMFGGOC@nuronssl?$AA@ ; "nuronssl"
		test	ecx, ecx
		cmovnz	eax, ecx
		retn
_get_NURON_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 84Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_ctrl	proc near		; DATA XREF: _bind_helper+B7o

arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		xor	eax, eax
		cmp	ds:_pvDSOHandle, eax
		setnz	al
		cmp	[esp+arg_4], 0C8h ; 'È'
		jz	short loc_88E
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_874
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_874:				; CODE XREF: _nuron_ctrl+1Cj
		push	0B9h ; '¹'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	65h ; 'e'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_88E:				; CODE XREF: _nuron_ctrl+13j
		mov	ecx, [esp+arg_C]
		test	ecx, ecx
		jnz	short loc_8C3
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_8A9
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_8A9:				; CODE XREF: _nuron_ctrl+51j
		push	0AEh ; '®'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	43h ; 'C'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_8C3:				; CODE XREF: _nuron_ctrl+48j
		test	eax, eax
		jz	short loc_8F4
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_8DA
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_8DA:				; CODE XREF: _nuron_ctrl+82j
		push	0B2h ; '²'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	64h ; 'd'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_8F4:				; CODE XREF: _nuron_ctrl+79j
		push	ecx
		call	_set_NURON_LIBNAME
		add	esp, 4
		retn
_nuron_ctrl	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 900h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_destroy	proc near		; DATA XREF: _bind_helper+75o
		mov	eax, ds:_NURON_LIBNAME
		test	eax, eax
		jz	short loc_912
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_912:				; CODE XREF: _nuron_destroy+7j
		cmp	_NURON_error_init, 0
		mov	ds:_NURON_LIBNAME, 0
		jnz	short loc_95E
		push	offset _NURON_str_functs
		push	ds:_NURON_lib_error_code
		call	_ERR_unload_strings
		push	offset _NURON_str_reasons
		push	ds:_NURON_lib_error_code
		call	_ERR_unload_strings
		push	offset _NURON_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	_NURON_error_init, 1

loc_95E:				; CODE XREF: _nuron_destroy+23j
		mov	eax, 1
		retn
_nuron_destroy	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 964h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_finish	proc near		; DATA XREF: _bind_helper+A1o
		mov	eax, ds:_NURON_LIBNAME
		test	eax, eax
		jz	short loc_976
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_976:				; CODE XREF: _nuron_finish+7j
		mov	eax, ds:_pvDSOHandle
		mov	ds:_NURON_LIBNAME, 0
		test	eax, eax
		jnz	short loc_9B6
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_99C
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_99C:				; CODE XREF: _nuron_finish+2Cj
		push	9Ch ; 'œ'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_9B6:				; CODE XREF: _nuron_finish+23j
		push	eax
		call	_DSO_free
		add	esp, 4
		test	eax, eax
		jnz	short loc_9F0
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_9D6
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_9D6:				; CODE XREF: _nuron_finish+66j
		push	0A0h ; ' '
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	66h ; 'f'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_9F0:				; CODE XREF: _nuron_finish+5Dj
		mov	ds:_pvDSOHandle, 0
		mov	eax, 1
		mov	ds:_pfnModExp, 0
		retn
_nuron_finish	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A0Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_init	proc near		; DATA XREF: _bind_helper+8Bo
		cmp	ds:_pvDSOHandle, 0
		jz	short loc_A42
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_A28
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_A28:				; CODE XREF: _nuron_init+10j
		push	84h ; '„'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	64h ; 'd'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A42:				; CODE XREF: _nuron_init+7j
		mov	eax, ds:_NURON_LIBNAME
		mov	ecx, offset ??_C@_08CLMFGGOC@nuronssl?$AA@ ; "nuronssl"
		test	eax, eax
		push	2
		cmovnz	ecx, eax
		push	0
		push	ecx
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_pvDSOHandle, eax
		test	eax, eax
		jnz	short loc_A96
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_A7C
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_A7C:				; CODE XREF: _nuron_init+64j
		push	8Bh ; '‹'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	68h ; 'h'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_A96:				; CODE XREF: _nuron_init+5Bj
		push	_NURON_F1
		push	eax
		call	_DSO_bind_func
		add	esp, 8
		mov	ds:_pfnModExp, eax
		test	eax, eax
		jnz	short loc_ADB
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_AC1
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_AC1:				; CODE XREF: _nuron_init+A9j
		push	91h ; '‘'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	67h ; 'g'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_ADB:				; CODE XREF: _nuron_init+A0j
		mov	eax, 1
		retn
_nuron_init	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AE4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_nuron_mod_exp	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	ds:_pvDSOHandle, 0
		jnz	short loc_B1A
		mov	eax, ds:_NURON_lib_error_code
		test	eax, eax
		jnz	short loc_B00
		call	_ERR_get_next_error_library
		mov	ds:_NURON_lib_error_code, eax

loc_B00:				; CODE XREF: _nuron_mod_exp+10j
		push	0C1h ; 'Á'
		push	offset ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@ ; ".\\engines\\e_nuron.c"
		push	69h ; 'i'
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_B1A:				; CODE XREF: _nuron_mod_exp+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		call	ds:_pfnModExp
		add	esp, 10h
		retn
_nuron_mod_exp	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B34h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_set_NURON_LIBNAME proc	near		; CODE XREF: _nuron_ctrl+A9p

arg_0		= dword	ptr  4

		mov	eax, ds:_NURON_LIBNAME
		test	eax, eax
		jz	short loc_B46
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_B46:				; CODE XREF: _set_NURON_LIBNAME+7j
		push	[esp+arg_0]
		mov	ds:_NURON_LIBNAME, 0
		call	_BUF_strdup
		xor	ecx, ecx
		mov	ds:_NURON_LIBNAME, eax
		add	esp, 4
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		retn
_set_NURON_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B84h
; COMDAT (pick any)
		public ??_C@_08CLMFGGOC@nuronssl?$AA@
; `string'
??_C@_08CLMFGGOC@nuronssl?$AA@ db 'nuronssl',0 ; DATA XREF: _get_NURON_LIBNAME+6o
					; _nuron_init+3Bo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B90h
; COMDAT (pick any)
		public ??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@
; `string'
??_C@_0BE@OCCFKFHH@?4?2engines?2e_nuron?4c?$AA@	db '.\engines\e_nuron.c',0
					; DATA XREF: _nuron_rsa_mod_exp+2Bo
					; _nuron_dsa_mod_exp+3Ao ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_free:near	; CODE XREF: _free_NURON_LIBNAME+Ap
					; _nuron_destroy+Ap ...
		extrn _BUF_strdup:near	; CODE XREF: _set_NURON_LIBNAME+20p
		extrn _DSO_free:near	; CODE XREF: _nuron_finish+53p
		extrn _DSO_load:near	; CODE XREF: _nuron_init+4Cp
		extrn _DSO_bind_func:near ; CODE XREF: _nuron_init+91p
		extrn _BN_init:near	; CODE XREF: _nuron_dsa_mod_exp+12p
		extrn _BN_mod_mul:near	; CODE XREF: _nuron_dsa_mod_exp+DCp
		extrn _BN_free:near	; CODE XREF: _nuron_dsa_mod_exp+51p
					; _nuron_dsa_mod_exp+F5p
		extrn _RSA_PKCS1_SSLeay:near ; CODE XREF: _bind_helper+DBp
		extrn _DH_OpenSSL:near	; CODE XREF: _bind_helper+122p
		extrn _DSA_OpenSSL:near	; CODE XREF: _bind_helper+103p
		extrn _ERR_put_error:near ; CODE XREF: _nuron_rsa_mod_exp+35p
					; _nuron_dsa_mod_exp+44p ...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_NURON_strings+2Cp
					; _ERR_load_NURON_strings+3Cp ...
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_NURON_strings+14p
					; _ERR_unload_NURON_strings+24p ...
		extrn _ERR_get_next_error_library:near ; CODE XREF: _nuron_rsa_mod_exp+1Cp
					; _nuron_dsa_mod_exp+2Bp ...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_helper+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_helper+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_helper+39p
		extrn _ENGINE_set_DSA:near ; CODE XREF:	_bind_helper+4Fp
		extrn _ENGINE_set_DH:near ; CODE XREF: _bind_helper+65p
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_helper+7Bp
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_helper+91p
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_helper+A7p
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_helper+BDp
		extrn _ENGINE_set_cmd_defns:near ; CODE	XREF: _bind_helper+CFp
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
		extrn __chkstk:near	; CODE XREF: _nuron_dsa_mod_exp+5p


		end
