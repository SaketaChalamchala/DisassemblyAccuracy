;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	B0271998C3FA7A658DBB60FD6259BAC2
; Input	CRC32 :	9E830D9D

; File Name   :	C:\compspace\Diff\openssl\obj\t1_enc.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	byte public 'DATA' use32
		assume cs:_rdata
; size_t `tls1_change_cipher_state'::`2'::empty
?empty@?1??tls1_change_cipher_state@@9@9 db 0 ;	DATA XREF: _tls1_change_cipher_state+4C4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; _fprintf+Fp
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _tls1_enc+106p

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_PRF(int, int, int, int, int,	int, int, int, int, int, int, int, int,	void *Dst, int,	size_t Size)
_tls1_PRF	proc near		; CODE XREF: _tls1_change_cipher_state+48Ep
					; _tls1_change_cipher_state+4F4p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch
arg_2C		= dword	ptr  30h
arg_30		= dword	ptr  34h
Dst		= dword	ptr  38h
arg_38		= dword	ptr  3Ch
Size		= dword	ptr  40h

		mov	eax, 10h
		call	__chkstk
		push	ebx
		push	esi
		push	edi
		lea	eax, [esp+1Ch+var_8]
		xor	esi, esi
		push	eax
		lea	eax, [esp+20h+var_10]
		xor	edi, edi
		push	eax
		push	esi
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jz	loc_25F
		mov	ebx, [esp+1Ch+arg_0]

loc_84:					; CODE XREF: _tls1_PRF+52j
		mov	eax, [esp+1Ch+var_10]
		shl	eax, 0Ah
		test	ebx, eax
		jz	short loc_90
		inc	edi

loc_90:					; CODE XREF: _tls1_PRF+39j
		lea	eax, [esp+1Ch+var_8]
		inc	esi
		push	eax
		lea	eax, [esp+20h+var_10]
		push	eax
		push	esi
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_84
		test	edi, edi
		jz	loc_25F
		mov	ecx, [esp+1Ch+arg_30]
		mov	eax, ecx
		cdq
		idiv	edi
		push	ebp
		mov	ebp, [esp+20h+Dst]
		mov	esi, eax
		xor	eax, eax
		mov	[esp+20h+var_C], esi
		cmp	edi, 1
		mov	edi, [esp+20h+Size]
		push	edi		; Size
		push	eax		; Val
		cmovz	ecx, eax
		push	ebp		; Dst
		mov	[esp+2Ch+arg_30], ecx
		call	_memset
		lea	eax, [esp+2Ch+var_8]
		mov	[esp+2Ch+var_4], 0
		push	eax
		lea	eax, [esp+30h+var_10]
		push	eax
		push	0
		call	_ssl_get_handshake_digest
		add	esp, 18h
		test	eax, eax
		jz	loc_22A
		mov	ebx, [esp+20h+arg_38]

loc_104:				; CODE XREF: _tls1_PRF+1D0j
		mov	eax, [esp+20h+var_10]
		shl	eax, 0Ah
		test	[esp+20h+arg_0], eax
		jz	loc_206
		mov	ecx, [esp+20h+var_8]
		test	ecx, ecx
		jz	loc_237
		push	edi		; Size
		push	ebx		; int
		push	[esp+28h+arg_28] ; int
		mov	eax, [esp+2Ch+arg_30]
		push	[esp+2Ch+arg_24] ; int
		and	eax, 1
		push	[esp+30h+arg_20] ; int
		add	eax, esi
		mov	esi, [esp+34h+arg_2C]
		push	[esp+34h+arg_1C] ; int
		push	[esp+38h+arg_18] ; int
		push	[esp+3Ch+arg_14] ; int
		push	[esp+40h+arg_10] ; int
		push	[esp+44h+arg_C]	; int
		push	[esp+48h+arg_8]	; int
		push	[esp+4Ch+arg_4]	; int
		push	eax		; int
		push	esi		; int
		push	ecx		; int
		call	_tls1_P_hash
		add	esp, 3Ch
		test	eax, eax
		jz	loc_255
		add	esi, [esp+20h+var_C]
		xor	ecx, ecx
		mov	[esp+20h+arg_2C], esi
		test	edi, edi
		jle	loc_202
		cmp	edi, 20h ; ' '
		jb	short loc_1DF
		lea	eax, [ebx-1]
		lea	edx, [ebp-1]
		add	eax, edi
		add	edx, edi
		cmp	ebp, eax
		ja	short loc_194
		cmp	edx, ebx
		jnb	short loc_1DF

loc_194:				; CODE XREF: _tls1_PRF+13Aj
		mov	eax, edi
		and	eax, 8000001Fh
		jns	short loc_1A2
		dec	eax
		or	eax, 0FFFFFFE0h
		inc	eax

loc_1A2:				; CODE XREF: _tls1_PRF+147j
		mov	edx, edi
		mov	esi, ebx
		sub	edx, eax
		mov	eax, ebp
		sub	esi, ebp
		nop	dword ptr [eax+eax+00000000h]

loc_1B4:				; CODE XREF: _tls1_PRF+189j
		movups	xmm0, xmmword ptr [eax]
		lea	eax, [eax+20h]
		movups	xmm1, xmmword ptr [esi+eax-20h]
		pxor	xmm1, xmm0
		movups	xmmword	ptr [eax-20h], xmm1
		movups	xmm1, xmmword ptr [ebx+ecx+10h]
		add	ecx, 20h ; ' '
		movups	xmm0, xmmword ptr [eax-10h]
		pxor	xmm1, xmm0
		movups	xmmword	ptr [eax-10h], xmm1
		cmp	ecx, edx
		jl	short loc_1B4

loc_1DF:				; CODE XREF: _tls1_PRF+12Cj
					; _tls1_PRF+13Ej
		cmp	ecx, edi
		jge	short loc_202
		mov	esi, ebx
		lea	eax, [ecx+ebp]
		mov	edx, edi
		sub	esi, ebp
		sub	edx, ecx
		nop	word ptr [eax+eax+00h]

loc_1F4:				; CODE XREF: _tls1_PRF+1ACj
		mov	cl, [eax+esi]
		lea	eax, [eax+1]
		xor	[eax-1], cl
		sub	edx, 1
		jnz	short loc_1F4

loc_202:				; CODE XREF: _tls1_PRF+123j
					; _tls1_PRF+18Dj
		mov	esi, [esp+20h+var_C]

loc_206:				; CODE XREF: _tls1_PRF+BBj
		mov	eax, [esp+20h+var_4]
		lea	ecx, [esp+20h+var_8]
		push	ecx
		lea	ecx, [esp+24h+var_10]
		inc	eax
		push	ecx
		push	eax
		mov	[esp+2Ch+var_4], eax
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_104

loc_22A:				; CODE XREF: _tls1_PRF+A6j
		mov	eax, 1
		pop	ebp

$err$46:
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_237:				; CODE XREF: _tls1_PRF+C7j
		push	114h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	146h
		push	11Ch
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_255:				; CODE XREF: _tls1_PRF+111j
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_25F:				; CODE XREF: _tls1_PRF+26j
					; _tls1_PRF+56j
		push	109h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		push	11Ch
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
_tls1_PRF	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 284h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_P_hash(int, int, int, int, int, int,	int, int, int, int, int, int, int, int,	size_t Size)
_tls1_P_hash	proc near		; CODE XREF: _tls1_PRF+107p

Dst		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= byte ptr -0ACh
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= byte ptr -74h
var_5C		= byte ptr -5Ch
Src		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch
arg_2C		= dword	ptr  30h
arg_30		= dword	ptr  34h
arg_34		= dword	ptr  38h
Size		= dword	ptr  3Ch

		mov	eax, 0B4h ; '´'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0B4h+var_4], eax
		mov	eax, [esp+0B4h+arg_14]
		push	ebx
		mov	ebx, [esp+0B8h+arg_8]
		mov	[esp+0B8h+var_84], eax
		mov	eax, [esp+0B8h+arg_1C]
		push	ebp
		mov	ebp, [esp+0BCh+arg_C]
		mov	[esp+0BCh+var_80], eax
		mov	eax, [esp+0BCh+arg_24]
		push	esi
		mov	esi, [esp+0C0h+arg_0]
		mov	[esp+0C0h+var_94], eax
		mov	eax, [esp+0C0h+arg_2C]
		push	edi
		mov	edi, [esp+0C4h+arg_4]
		mov	[esp+0C4h+var_90], eax
		mov	eax, [esp+0C4h+arg_34]
		push	esi
		mov	[esp+0C8h+Dst],	eax
		mov	[esp+0C8h+var_88], 0
		call	_EVP_MD_size
		add	esp, 4
		mov	[esp+0C4h+var_8C], eax
		test	eax, eax
		jns	short loc_323
		push	offset ??_C@_0L@JFGNIFBM@chunk?5?$DO?$DN?50?$AA@ ; "chunk >= 0"
		push	0AAh ; 'ª'
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		call	_OpenSSLDie
		add	esp, 0Ch

loc_323:				; CODE XREF: _tls1_P_hash+86j
		lea	eax, [esp+0C4h+var_AC]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+0C8h+var_5C]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+0CCh+var_74]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+0D0h+var_74]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		push	ebx
		push	edi
		push	0
		push	357h
		call	_EVP_PKEY_new_mac_key
		add	esp, 24h
		mov	[esp+0C4h+var_78], eax
		test	eax, eax
		jz	$err$44
		push	eax
		push	0
		push	esi
		lea	eax, [esp+0D0h+var_74]
		push	0
		push	eax
		call	_EVP_DigestSignInit
		add	esp, 14h
		test	eax, eax
		jz	$err$44
		lea	eax, [esp+0C4h+var_74]
		push	eax
		lea	eax, [esp+0C8h+var_AC]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	$err$44
		test	ebp, ebp
		jz	short loc_3C0
		push	[esp+0C4h+arg_10]
		lea	eax, [esp+0C8h+var_AC]
		push	ebp
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_3C0:				; CODE XREF: _tls1_P_hash+11Dj
		mov	ebx, [esp+0C4h+var_84]
		test	ebx, ebx
		jz	short loc_3E5
		push	[esp+0C4h+arg_18]
		lea	eax, [esp+0C8h+var_AC]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_3E5:				; CODE XREF: _tls1_P_hash+142j
		mov	edi, [esp+0C4h+var_80]
		test	edi, edi
		jz	short loc_40A
		push	[esp+0C4h+arg_20]
		lea	eax, [esp+0C8h+var_AC]
		push	edi
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_40A:				; CODE XREF: _tls1_P_hash+167j
		mov	eax, [esp+0C4h+var_94]
		test	eax, eax
		jz	short loc_42F
		push	[esp+0C4h+arg_28]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_42F:				; CODE XREF: _tls1_P_hash+18Cj
		mov	eax, [esp+0C4h+var_90]
		test	eax, eax
		jz	short loc_454
		push	[esp+0C4h+arg_30]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_454:				; CODE XREF: _tls1_P_hash+1B1j
		lea	eax, [esp+0C4h+var_B0]
		push	eax
		lea	eax, [esp+0C8h+Src]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44
		lea	eax, [esp+0C4h+var_74]
		push	eax
		lea	eax, [esp+0C8h+var_AC]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	$err$44
		mov	esi, [esp+0C4h+Size]

loc_497:				; CODE XREF: _tls1_P_hash+361j
		push	[esp+0C4h+var_B0]
		lea	eax, [esp+0C8h+Src]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44
		cmp	esi, [esp+0C4h+var_8C]
		jle	short loc_4D8
		lea	eax, [esp+0C4h+var_AC]
		push	eax
		lea	eax, [esp+0C8h+var_5C]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	$err$44

loc_4D8:				; CODE XREF: _tls1_P_hash+238j
		test	ebp, ebp
		jz	short loc_4F9
		push	[esp+0C4h+arg_10]
		lea	eax, [esp+0C8h+var_AC]
		push	ebp
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_4F9:				; CODE XREF: _tls1_P_hash+256j
		test	ebx, ebx
		jz	short loc_51A
		push	[esp+0C4h+arg_18]
		lea	eax, [esp+0C8h+var_AC]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_51A:				; CODE XREF: _tls1_P_hash+277j
		test	edi, edi
		jz	short loc_53B
		push	[esp+0C4h+arg_20]
		lea	eax, [esp+0C8h+var_AC]
		push	edi
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_53B:				; CODE XREF: _tls1_P_hash+298j
		mov	eax, [esp+0C4h+var_94]
		test	eax, eax
		jz	short loc_560
		push	[esp+0C4h+arg_28]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_560:				; CODE XREF: _tls1_P_hash+2BDj
		mov	eax, [esp+0C4h+var_90]
		test	eax, eax
		jz	short loc_585
		push	[esp+0C4h+arg_30]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44

loc_585:				; CODE XREF: _tls1_P_hash+2E2j
		cmp	esi, [esp+0C4h+var_8C]
		jle	short loc_5ED
		lea	eax, [esp+0C4h+var_7C]
		push	eax
		push	[esp+0C8h+Dst]
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	$err$44
		mov	eax, [esp+0C4h+var_7C]
		sub	esi, eax
		add	[esp+0C4h+Dst],	eax
		lea	eax, [esp+0C4h+var_B0]
		push	eax
		lea	eax, [esp+0C8h+Src]
		push	eax
		lea	eax, [esp+0CCh+var_5C]
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$44
		lea	eax, [esp+0C4h+var_74]
		push	eax
		lea	eax, [esp+0C8h+var_AC]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jnz	loc_497
		jmp	short $err$44
; ---------------------------------------------------------------------------

loc_5ED:				; CODE XREF: _tls1_P_hash+305j
		lea	eax, [esp+0C4h+var_B0]
		push	eax
		lea	eax, [esp+0C8h+Src]
		push	eax
		lea	eax, [esp+0CCh+var_AC]
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$44
		push	esi		; Size
		lea	eax, [esp+0C8h+Src]
		push	eax		; Src
		push	[esp+0CCh+Dst]	; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	[esp+0C4h+var_88], 1

$err$44:				; CODE XREF: _tls1_P_hash+E0j
					; _tls1_P_hash+FBj ...
		push	[esp+0C4h+var_78]
		call	_EVP_PKEY_free
		lea	eax, [esp+0C8h+var_AC]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+0CCh+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+0D0h+var_74]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+0D4h+Src]
		push	40h ; '@'
		push	eax
		call	_OPENSSL_cleanse
		mov	ecx, [esp+0DCh+var_4]
		add	esp, 18h
		mov	eax, [esp+0C4h+var_88]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B4h
		retn
_tls1_P_hash	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 680h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_alert_code
_tls1_alert_code proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 73h ; 's'  ; switch 116 cases
		ja	$LN35		; jumptable 00000694 default case
		movzx	eax, ds:$LN37[eax]
		jmp	ds:$LN40[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		xor	eax, eax	; jumptable 00000694 case 0
		retn
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 0Ah	; jumptable 00000694 case 10
		retn
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 14h	; jumptable 00000694 case 20
		retn
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 15h	; jumptable 00000694 case 21
		retn
; ---------------------------------------------------------------------------

$LN8:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 16h	; jumptable 00000694 case 22
		retn
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 1Eh	; jumptable 00000694 case 30
		retn
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 28h ; '('  ; jumptable 00000694 case 40
		retn
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Ah ; '*'  ; jumptable 00000694 case 42
		retn
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Bh ; '+'  ; jumptable 00000694 case 43
		retn
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Ch ; ','  ; jumptable 00000694 case 44
		retn
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Dh ; '-'  ; jumptable 00000694 case 45
		retn
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Eh ; '.'  ; jumptable 00000694 case 46
		retn
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Fh ; '/'  ; jumptable 00000694 case 47
		retn
; ---------------------------------------------------------------------------

$LN18:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 30h ; '0'  ; jumptable 00000694 case 48
		retn
; ---------------------------------------------------------------------------

$LN19:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 31h ; '1'  ; jumptable 00000694 case 49
		retn
; ---------------------------------------------------------------------------

$LN20:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 32h ; '2'  ; jumptable 00000694 case 50
		retn
; ---------------------------------------------------------------------------

$LN21:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 33h ; '3'  ; jumptable 00000694 case 51
		retn
; ---------------------------------------------------------------------------

$LN22:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 3Ch ; '<'  ; jumptable 00000694 case 60
		retn
; ---------------------------------------------------------------------------

$LN23:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 46h ; 'F'  ; jumptable 00000694 case 70
		retn
; ---------------------------------------------------------------------------

$LN24:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 47h ; 'G'  ; jumptable 00000694 case 71
		retn
; ---------------------------------------------------------------------------

$LN25:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 50h ; 'P'  ; jumptable 00000694 case 80
		retn
; ---------------------------------------------------------------------------

$LN26:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 5Ah ; 'Z'  ; jumptable 00000694 case 90
		retn
; ---------------------------------------------------------------------------

$LN27:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 64h ; 'd'  ; jumptable 00000694 case 100
		retn
; ---------------------------------------------------------------------------

$LN28:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 6Eh ; 'n'  ; jumptable 00000694 case 110
		retn
; ---------------------------------------------------------------------------

$LN29:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 6Fh ; 'o'  ; jumptable 00000694 case 111
		retn
; ---------------------------------------------------------------------------

$LN30:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 70h ; 'p'  ; jumptable 00000694 case 112
		retn
; ---------------------------------------------------------------------------

$LN31:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 71h ; 'q'  ; jumptable 00000694 case 113
		retn
; ---------------------------------------------------------------------------

$LN32:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 72h ; 'r'  ; jumptable 00000694 case 114
		retn
; ---------------------------------------------------------------------------

$LN33:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 73h ; 's'  ; jumptable 00000694 case 115
		retn
; ---------------------------------------------------------------------------

$LN34:					; CODE XREF: _tls1_alert_code+14j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 56h ; 'V'  ; jumptable 00000694 case 86
		retn
; ---------------------------------------------------------------------------

$LN35:					; CODE XREF: _tls1_alert_code+7j
					; _tls1_alert_code+14j
					; DATA XREF: ...
		or	eax, 0FFFFFFFFh	; jumptable 00000694 default case
		retn
_tls1_alert_code endp

; ---------------------------------------------------------------------------
$LN40		dd offset $LN4,	offset $LN5, offset $LN6, offset $LN7
					; DATA XREF: _tls1_alert_code+14r
		dd offset $LN8,	offset $LN9, offset $LN10, offset $LN35	; jump table for switch	statement
		dd offset $LN12, offset	$LN13, offset $LN14, offset $LN15
		dd offset $LN16, offset	$LN17, offset $LN18, offset $LN19
		dd offset $LN20, offset	$LN21, offset $LN22, offset $LN23
		dd offset $LN24, offset	$LN25, offset $LN34, offset $LN26
		dd offset $LN27, offset	$LN28, offset $LN29, offset $LN30
		dd offset $LN31, offset	$LN32, offset $LN33, offset $LN35
$LN37		db	0,   1Fh,   1Fh,   1Fh ; DATA XREF: _tls1_alert_code+Dr
		db    1Fh,   1Fh,   1Fh,   1Fh ; indirect table	for switch statement
		db    1Fh,   1Fh,     1,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db	2,     3,     4,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,     5,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db	6,     7,     8,     9
		db    0Ah,   0Bh,   0Ch,   0Dh
		db    0Eh,   0Fh,   10h,   11h
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    12h,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   13h,   14h
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    15h,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   16h,   1Fh
		db    1Fh,   1Fh,   17h,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    18h,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   1Fh,   1Fh
		db    1Fh,   1Fh,   19h,   1Ah
		db    1Bh,   1Ch,   1Dh,   1Eh
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 844h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_cert_verify_mac
_tls1_cert_verify_mac proc near

var_18		= byte ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 18h
		call	__chkstk
		push	edi
		mov	edi, [esp+1Ch+arg_0]
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+178h], 0
		jz	short loc_871
		push	edi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jnz	short loc_871
		pop	edi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_871:				; CODE XREF: _tls1_cert_verify_mac+19j
					; _tls1_cert_verify_mac+26j
		push	ebx
		mov	ebx, [esp+20h+arg_4]
		push	esi
		xor	esi, esi
		db	66h, 66h
		nop	word ptr [eax+eax+00000000h]

loc_884:				; CODE XREF: _tls1_cert_verify_mac+67j
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		mov	eax, [eax+esi*4]
		test	eax, eax
		jz	short loc_8A7
		push	eax
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_type
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_8D4

loc_8A7:				; CODE XREF: _tls1_cert_verify_mac+4Ej
		inc	esi
		cmp	esi, 6
		jl	short loc_884

loc_8AD:				; CODE XREF: _tls1_cert_verify_mac+9Ej
		push	3ABh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	144h
		push	11Eh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	edi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_8D4:				; CODE XREF: _tls1_cert_verify_mac+61j
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		mov	esi, [eax+esi*4]
		test	esi, esi
		jz	short loc_8AD
		lea	eax, [esp+24h+var_18]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+28h+var_18]
		push	esi
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_91A
		lea	eax, [esp+24h+arg_0]
		push	eax
		push	[esp+28h+arg_8]
		lea	eax, [esp+2Ch+var_18]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_922

loc_91A:				; CODE XREF: _tls1_cert_verify_mac+BAj
		mov	[esp+24h+arg_0], 0

loc_922:				; CODE XREF: _tls1_cert_verify_mac+D4j
		lea	eax, [esp+24h+var_18]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	eax, [esp+28h+arg_0]
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		add	esp, 18h
		retn
_tls1_cert_verify_mac endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 93Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_change_cipher_state
_tls1_change_cipher_state proc near

var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
Dst		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
Size		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
Src		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= byte ptr -0C4h
var_A4		= dword	ptr -0A4h
var_84		= byte ptr -84h
var_44		= dword	ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 0FCh ; 'ü'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0FCh+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10Ch+arg_0]
		mov	[esp+10Ch+var_FC], 0
		mov	eax, [edi+58h]
		mov	ecx, [eax+344h]
		mov	esi, [eax+37Ch]
		mov	ebp, [eax+38Ch]
		mov	[esp+10Ch+var_D0], esi
		mov	edx, [ecx+20h]
		and	edx, 2
		test	byte ptr [esp+10Ch+arg_4], 1
		mov	[esp+10Ch+var_D8], edx
		mov	edx, [eax+380h]
		mov	[esp+10Ch+var_C8], edx
		mov	edx, [eax+384h]
		mov	[esp+10Ch+var_CC], edx
		jz	loc_AD1
		test	byte ptr [ecx+24h], 4
		jz	short loc_9B8
		or	dword ptr [edi+7Ch], 1
		jmp	short loc_9BC
; ---------------------------------------------------------------------------

loc_9B8:				; CODE XREF: _tls1_change_cipher_state+74j
		and	dword ptr [edi+7Ch], 0FFFFFFFEh

loc_9BC:				; CODE XREF: _tls1_change_cipher_state+7Aj
		cmp	dword ptr [edi+80h], 0
		jz	short loc_9CF
		mov	[esp+10Ch+var_FC], 1
		jmp	short loc_9FD
; ---------------------------------------------------------------------------

loc_9CF:				; CODE XREF: _tls1_change_cipher_state+87j
		push	17Ah
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	8Ch ; 'Œ'
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[edi+80h], eax
		test	eax, eax
		jz	$err$66
		push	eax
		call	_EVP_CIPHER_CTX_init
		add	esp, 4

loc_9FD:				; CODE XREF: _tls1_change_cipher_state+91j
		mov	eax, [edi+80h]
		mov	[esp+10Ch+var_F8], eax
		lea	eax, [edi+84h]
		push	0
		push	eax
		call	_ssl_replace_hash
		mov	ebx, eax
		add	esp, 8
		mov	[esp+10Ch+var_E8], ebx
		test	ebx, ebx
		jz	$err$66
		mov	eax, [edi+88h]
		test	eax, eax
		jz	short loc_A43
		push	eax
		call	_COMP_CTX_free
		add	esp, 4
		mov	dword ptr [edi+88h], 0

loc_A43:				; CODE XREF: _tls1_change_cipher_state+F2j
		test	ebp, ebp
		jz	short loc_AAC
		push	dword ptr [ebp+8]
		call	_COMP_CTX_new
		add	esp, 4
		mov	[edi+88h], eax
		test	eax, eax
		jnz	short loc_A70
		push	18Eh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	8Eh ; 'Ž'
		jmp	loc_F9B
; ---------------------------------------------------------------------------

loc_A70:				; CODE XREF: _tls1_change_cipher_state+11Ej
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+120h], 0
		jnz	short loc_A9C
		push	193h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	4540h
		call	_CRYPTO_malloc
		mov	ecx, [edi+58h]
		add	esp, 0Ch
		mov	[ecx+120h], eax

loc_A9C:				; CODE XREF: _tls1_change_cipher_state+13Ej
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+120h], 0
		jz	$err$66

loc_AAC:				; CODE XREF: _tls1_change_cipher_state+109j
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jnz	short loc_AC3
		mov	eax, [edi+58h]
		xorps	xmm0, xmm0
		movq	qword ptr [eax+8], xmm0

loc_AC3:				; CODE XREF: _tls1_change_cipher_state+17Aj
		mov	eax, [edi+58h]
		lea	ecx, [eax+14h]
		lea	ebx, [eax+10h]
		jmp	loc_BCB
; ---------------------------------------------------------------------------

loc_AD1:				; CODE XREF: _tls1_change_cipher_state+6Aj
		test	byte ptr [ecx+24h], 4
		jz	short loc_ADD
		or	dword ptr [edi+7Ch], 2
		jmp	short loc_AE1
; ---------------------------------------------------------------------------

loc_ADD:				; CODE XREF: _tls1_change_cipher_state+199j
		and	dword ptr [edi+7Ch], 0FFFFFFFDh

loc_AE1:				; CODE XREF: _tls1_change_cipher_state+19Fj
		cmp	dword ptr [edi+8Ch], 0
		jz	short loc_B00
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jnz	short loc_B00
		mov	[esp+10Ch+var_FC], 1
		jmp	short loc_B13
; ---------------------------------------------------------------------------

loc_B00:				; CODE XREF: _tls1_change_cipher_state+1ACj
					; _tls1_change_cipher_state+1B8j
		call	_EVP_CIPHER_CTX_new
		mov	[edi+8Ch], eax
		test	eax, eax
		jz	$err$66

loc_B13:				; CODE XREF: _tls1_change_cipher_state+1C2j
		mov	eax, [edi+8Ch]
		mov	[esp+10Ch+var_F8], eax
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_B44
		call	_EVP_MD_CTX_create
		mov	ebx, eax
		mov	[esp+10Ch+var_E8], ebx
		test	ebx, ebx
		jz	$err$66
		mov	[edi+90h], ebx
		jmp	short loc_B61
; ---------------------------------------------------------------------------

loc_B44:				; CODE XREF: _tls1_change_cipher_state+1EBj
		lea	eax, [edi+90h]
		push	0
		push	eax
		call	_ssl_replace_hash
		add	esp, 8
		mov	[esp+10Ch+var_E8], eax
		test	eax, eax
		jz	$err$66

loc_B61:				; CODE XREF: _tls1_change_cipher_state+206j
		mov	eax, [edi+94h]
		test	eax, eax
		jz	short loc_B7E
		push	eax
		call	_COMP_CTX_free
		add	esp, 4
		mov	dword ptr [edi+94h], 0

loc_B7E:				; CODE XREF: _tls1_change_cipher_state+22Dj
		test	ebp, ebp
		jz	short loc_BAB
		push	dword ptr [ebp+8]
		call	_COMP_CTX_new
		add	esp, 4
		mov	[edi+94h], eax
		test	eax, eax
		jnz	short loc_BAB
		push	1BCh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	8Eh ; 'Ž'
		jmp	loc_F9B
; ---------------------------------------------------------------------------

loc_BAB:				; CODE XREF: _tls1_change_cipher_state+244j
					; _tls1_change_cipher_state+259j
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jnz	short loc_BC2
		mov	eax, [edi+58h]
		xorps	xmm0, xmm0
		movq	qword ptr [eax+54h], xmm0

loc_BC2:				; CODE XREF: _tls1_change_cipher_state+279j
		mov	eax, [edi+58h]
		lea	ecx, [eax+60h]
		lea	ebx, [eax+5Ch]

loc_BCB:				; CODE XREF: _tls1_change_cipher_state+190j
		cmp	[esp+10Ch+var_FC], 0
		mov	[esp+10Ch+var_E0], ebx
		mov	[esp+10Ch+Dst],	ecx
		jz	short loc_BE6
		push	[esp+10Ch+var_F8]
		call	_EVP_CIPHER_CTX_cleanup
		add	esp, 4

loc_BE6:				; CODE XREF: _tls1_change_cipher_state+29Cj
		mov	eax, [edi+58h]
		push	esi
		mov	ecx, [eax+378h]
		mov	eax, [eax+388h]
		mov	[esp+110h+var_FC], ecx
		mov	[esp+110h+Size], eax
		mov	[ebx], eax
		call	_EVP_CIPHER_key_length
		add	esp, 4
		mov	ebx, eax
		cmp	[esp+10Ch+var_D8], 0
		jz	short loc_C4E
		mov	ecx, [edi+58h]
		mov	edx, [ecx+344h]
		mov	ecx, [edx+20h]
		and	ecx, 8
		jz	short loc_C29
		mov	eax, 5
		jmp	short loc_C34
; ---------------------------------------------------------------------------

loc_C29:				; CODE XREF: _tls1_change_cipher_state+2E4j
		mov	eax, [edx+14h]
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 8

loc_C34:				; CODE XREF: _tls1_change_cipher_state+2EBj
		cmp	ebx, eax
		jl	short loc_C4E
		test	ecx, ecx
		jz	short loc_C43
		mov	ebx, 5
		jmp	short loc_C4E
; ---------------------------------------------------------------------------

loc_C43:				; CODE XREF: _tls1_change_cipher_state+2FEj
		mov	ebx, [edx+14h]
		dec	ebx
		neg	ebx
		sbb	ebx, ebx
		add	ebx, 8

loc_C4E:				; CODE XREF: _tls1_change_cipher_state+2D3j
					; _tls1_change_cipher_state+2FAj ...
		push	esi
		call	_EVP_CIPHER_flags
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 6
		jnz	short loc_C66
		lea	ebp, [eax-2]
		jmp	short loc_C71
; ---------------------------------------------------------------------------

loc_C66:				; CODE XREF: _tls1_change_cipher_state+323j
		push	esi
		call	_EVP_CIPHER_iv_length
		add	esp, 4
		mov	ebp, eax

loc_C71:				; CODE XREF: _tls1_change_cipher_state+328j
		mov	eax, [esp+10Ch+arg_4]
		cmp	eax, 12h
		jz	short loc_CBF
		cmp	eax, 21h ; '!'
		jz	short loc_CBF
		mov	eax, [esp+10Ch+Size]
		mov	edx, [esp+10Ch+var_FC]
		mov	[esp+10Ch+var_D4], offset ??_C@_0BB@HLBNJBJK@server?5write?5key?$AA@ ; "server write key"
		lea	ecx, [eax+edx]
		mov	[esp+10Ch+Src],	ecx
		lea	ecx, [ebx+eax*2]
		add	edx, ecx
		lea	eax, [ebx+ebp]
		add	ecx, eax
		mov	[esp+10Ch+var_E4], edx
		add	[esp+10Ch+var_FC], ecx
		mov	edx, [esp+10Ch+Size]
		mov	[esp+10Ch+var_F0], ecx
		add	ecx, ebp
		mov	[esp+10Ch+var_F0], 0
		jmp	short loc_CEE
; ---------------------------------------------------------------------------

loc_CBF:				; CODE XREF: _tls1_change_cipher_state+33Fj
					; _tls1_change_cipher_state+344j
		mov	edx, [esp+10Ch+Size]
		mov	ecx, [esp+10Ch+var_FC]
		mov	[esp+10Ch+Src],	ecx
		mov	[esp+10Ch+var_D4], offset ??_C@_0BB@DJIGDMHM@client?5write?5key?$AA@ ; "client write key"
		lea	eax, [edx+edx]
		mov	[esp+10Ch+var_F0], 1
		add	ecx, eax
		lea	eax, [eax+ebx*2]
		add	[esp+10Ch+var_FC], eax
		mov	[esp+10Ch+var_E4], ecx
		lea	ecx, [eax+ebp*2]

loc_CEE:				; CODE XREF: _tls1_change_cipher_state+381j
		mov	eax, [edi+58h]
		cmp	ecx, [eax+374h]
		jle	short loc_D0A
		push	1F2h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		jmp	loc_F9B
; ---------------------------------------------------------------------------

loc_D0A:				; CODE XREF: _tls1_change_cipher_state+3BBj
		push	edx		; Size
		push	[esp+110h+Src]	; Src
		push	[esp+114h+Dst]	; Dst
		call	_memcpy
		push	esi
		call	_EVP_CIPHER_flags
		add	esp, 10h
		test	eax, 200000h
		jnz	short loc_D70
		mov	eax, [esp+10Ch+var_E0]
		push	dword ptr [eax]
		push	[esp+110h+Dst]
		push	0
		push	[esp+118h+var_CC]
		call	_EVP_PKEY_new_mac_key
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_E4F
		push	esi
		push	0
		push	[esp+114h+var_C8]
		push	0
		push	[esp+11Ch+var_E8]
		call	_EVP_DigestSignInit
		add	esp, 14h
		test	eax, eax
		jle	loc_E4F
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4

loc_D70:				; CODE XREF: _tls1_change_cipher_state+3EAj
		cmp	[esp+10Ch+var_D8], 0
		jz	loc_E75
		push	[esp+10Ch+var_D0]
		mov	esi, [edi+58h]
		call	_EVP_CIPHER_key_length
		add	esp, 4
		push	eax		; Size
		lea	eax, [esp+110h+var_44]
		push	eax		; int
		lea	eax, [esp+114h+var_84]
		push	eax		; Dst
		push	ebx		; int
		push	[esp+11Ch+var_E4] ; int
		lea	eax, [esi+0A0h]
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	20h ; ' '       ; int
		push	eax		; int
		push	20h ; ' '       ; int
		lea	eax, [esi+0C0h]
		push	eax		; int
		push	10h		; int
		push	[esp+144h+var_D4] ; int
		push	edi
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		add	esp, 40h
		test	eax, eax
		jz	$err2$67
		lea	esi, [esp+10Ch+var_84]
		test	ebp, ebp
		jle	loc_E79
		mov	ecx, [edi+58h]
		lea	eax, ds:0[ebp*2]
		push	eax		; Size
		lea	eax, [esp+110h+var_A4]
		push	eax		; int
		lea	eax, [esp+114h+var_C4]
		push	eax		; Dst
		push	0		; int
		push	offset ?empty@?1??tls1_change_cipher_state@@9@9	; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	20h ; ' '       ; int
		lea	eax, [ecx+0A0h]
		push	eax		; int
		push	20h ; ' '       ; int
		lea	eax, [ecx+0C0h]
		push	eax		; int
		push	8		; int
		push	offset ??_C@_08IBBAIJIN@IV?5block?$AA@ ; "IV block"
		push	edi
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		add	esp, 40h
		test	eax, eax
		jz	$err2$67
		cmp	[esp+10Ch+var_F0], 0
		lea	ebx, [esp+10Ch+var_C4]
		jnz	short loc_E7D
		add	ebx, ebp
		jmp	short loc_E7D
; ---------------------------------------------------------------------------

loc_E4F:				; CODE XREF: _tls1_change_cipher_state+408j
					; _tls1_change_cipher_state+425j
		push	esi
		call	_EVP_PKEY_free
		push	1FEh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		push	0D1h ; 'Ñ'
		push	14h
		call	_ERR_put_error
		add	esp, 18h
		jmp	$err2$67
; ---------------------------------------------------------------------------

loc_E75:				; CODE XREF: _tls1_change_cipher_state+439j
		mov	esi, [esp+10Ch+var_E4]

loc_E79:				; CODE XREF: _tls1_change_cipher_state+4A7j
		mov	ebx, [esp+10Ch+var_FC]

loc_E7D:				; CODE XREF: _tls1_change_cipher_state+50Dj
					; _tls1_change_cipher_state+511j
		mov	eax, [edi+0C0h]
		mov	edi, [esp+10Ch+var_D0]
		push	edi
		mov	dword ptr [eax+4], 0
		call	_EVP_CIPHER_flags
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 6
		mov	eax, [esp+10Ch+arg_4]
		jnz	short loc_EE5
		and	eax, 2
		push	eax
		push	0
		push	esi
		mov	esi, [esp+118h+var_F8]
		push	0
		push	edi
		push	esi
		call	_EVP_CipherInit_ex
		add	esp, 18h
		test	eax, eax
		jz	short loc_ED4
		push	ebx
		push	ebp
		push	12h
		push	esi
		call	_EVP_CIPHER_CTX_ctrl
		add	esp, 10h
		test	eax, eax
		jnz	short loc_F10

loc_ED4:				; CODE XREF: _tls1_change_cipher_state+585j
		push	23Ah
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		jmp	loc_F9B
; ---------------------------------------------------------------------------

loc_EE5:				; CODE XREF: _tls1_change_cipher_state+56Aj
		and	eax, 2
		push	eax
		push	ebx
		push	esi
		mov	esi, [esp+118h+var_F8]
		push	0
		push	edi
		push	esi
		call	_EVP_CipherInit_ex
		add	esp, 18h
		test	eax, eax
		jnz	short loc_F10
		push	23Fh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		jmp	loc_F9B
; ---------------------------------------------------------------------------

loc_F10:				; CODE XREF: _tls1_change_cipher_state+596j
					; _tls1_change_cipher_state+5C1j
		push	edi
		call	_EVP_CIPHER_flags
		add	esp, 4
		test	eax, 200000h
		jz	short loc_F4C
		mov	eax, [esp+10Ch+var_E0]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_F4C
		push	[esp+10Ch+Dst]
		push	eax
		push	17h
		push	esi
		call	_EVP_CIPHER_CTX_ctrl
		add	esp, 10h
		test	eax, eax
		jnz	short loc_F4C
		push	247h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	44h ; 'D'
		jmp	short loc_F9B
; ---------------------------------------------------------------------------

loc_F4C:				; CODE XREF: _tls1_change_cipher_state+5E2j
					; _tls1_change_cipher_state+5ECj ...
		lea	eax, [esp+10Ch+var_84]
		push	40h ; '@'
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+114h+var_44]
		push	40h ; '@'
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+11Ch+var_C4]
		push	20h ; ' '
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+124h+var_A4]
		push	20h ; ' '
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 20h
		mov	eax, 1
		jmp	short loc_FAC
; ---------------------------------------------------------------------------

$err$66:				; CODE XREF: _tls1_change_cipher_state+B2j
					; _tls1_change_cipher_state+E4j ...
		push	274h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	41h ; 'A'

loc_F9B:				; CODE XREF: _tls1_change_cipher_state+12Fj
					; _tls1_change_cipher_state+26Aj ...
		push	0D1h ; 'Ñ'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err2$67:				; CODE XREF: _tls1_change_cipher_state+498j
					; _tls1_change_cipher_state+4FEj ...
		xor	eax, eax

loc_FAC:				; CODE XREF: _tls1_change_cipher_state+651j
		mov	ecx, [esp+10Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0FCh
		retn
_tls1_change_cipher_state endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FC8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_enc
_tls1_enc	proc near

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_A		= word ptr -0Ah
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		cmp	[esp+48h+arg_4], 0
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+54h+arg_0]
		push	edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_30], 0
		jz	loc_1103
		push	dword ptr [esi+90h]
		call	_EVP_MD_CTX_md
		add	esp, 4
		test	eax, eax
		jz	short loc_103D
		push	dword ptr [esi+90h]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		add	esp, 8
		test	eax, eax
		jns	short loc_103D
		push	offset ??_C@_06EFONEEIH@n?5?$DO?$DN?50?$AA@ ; "n >= 0"
		push	2FAh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		call	_OpenSSLDie
		add	esp, 0Ch

loc_103D:				; CODE XREF: _tls1_enc+44j
					; _tls1_enc+5Cj
		mov	ebx, [esi+58h]
		mov	ebp, [esi+8Ch]
		add	ebx, 130h
		mov	[esp+58h+var_34], ebp
		mov	[esp+58h+var_48], ebx
		test	ebp, ebp
		jnz	short loc_1063
		xor	edi, edi
		mov	[esp+58h+var_40], edi
		jmp	loc_1176
; ---------------------------------------------------------------------------

loc_1063:				; CODE XREF: _tls1_enc+8Ej
		push	ebp
		call	_EVP_CIPHER_CTX_cipher
		mov	edi, eax
		add	esp, 4
		mov	eax, [esi+8]
		mov	[esp+58h+var_40], edi
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 1
		jz	loc_1176
		push	edi
		call	_EVP_CIPHER_flags
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 2
		jnz	loc_1176
		push	edi
		call	_EVP_CIPHER_iv_length
		add	esp, 4
		cmp	eax, 1
		jle	loc_1176
		mov	ecx, [ebx+10h]
		cmp	[ebx+0Ch], ecx
		jz	short loc_10DB
		push	311h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	offset ??_C@_0CA@DAEFHPJI@?$CFs?3?$CFd?3?5rec?9?$DOdata?5?$CB?$DN?5rec?9?$DOinput?6?$AA@ ; "%s:%d: rec->data !=	rec->input\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 10h
		jmp	loc_1176
; ---------------------------------------------------------------------------

loc_10DB:				; CODE XREF: _tls1_enc+E9j
		push	eax
		push	ecx
		call	_RAND_bytes
		add	esp, 8
		test	eax, eax
		jg	loc_1176

loc_10ED:				; CODE XREF: _tls1_enc+2CFj
					; _tls1_enc+439j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1103:				; CODE XREF: _tls1_enc+2Ej
		push	dword ptr [esi+84h]
		call	_EVP_MD_CTX_md
		add	esp, 4
		test	eax, eax
		jz	short loc_1144
		push	dword ptr [esi+84h]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		add	esp, 8
		test	eax, eax
		jns	short loc_1144
		push	offset ??_C@_06EFONEEIH@n?5?$DO?$DN?50?$AA@ ; "n >= 0"
		push	319h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		call	_OpenSSLDie
		add	esp, 0Ch

loc_1144:				; CODE XREF: _tls1_enc+14Bj
					; _tls1_enc+163j
		mov	ebx, [esi+58h]
		mov	ebp, [esi+80h]
		add	ebx, 10Ch
		mov	[esp+58h+var_34], ebp
		mov	[esp+58h+var_48], ebx
		test	ebp, ebp
		jnz	short loc_1167
		xor	edi, edi
		mov	[esp+58h+var_40], edi
		jmp	short loc_1176
; ---------------------------------------------------------------------------

loc_1167:				; CODE XREF: _tls1_enc+195j
		push	ebp
		call	_EVP_CIPHER_CTX_cipher
		add	esp, 4
		mov	[esp+58h+var_40], eax
		mov	edi, eax

loc_1176:				; CODE XREF: _tls1_enc+96j
					; _tls1_enc+B4j ...
		cmp	dword ptr [esi+0C0h], 0
		jz	loc_14A1
		test	ebp, ebp
		jz	loc_14A1
		test	edi, edi
		jz	loc_14A1
		push	dword ptr [ebp+0]
		mov	edi, [ebx+4]
		call	_EVP_CIPHER_block_size
		push	dword ptr [ebp+0]
		mov	[esp+60h+var_3C], eax
		call	_EVP_CIPHER_flags
		add	esp, 8
		test	eax, 200000h
		jz	loc_12B3
		mov	edx, [esp+58h+arg_4]
		mov	ecx, [esi+58h]
		test	edx, edx
		jz	short loc_11C8
		add	ecx, 54h ; 'T'
		jmp	short loc_11CB
; ---------------------------------------------------------------------------

loc_11C8:				; CODE XREF: _tls1_enc+1F9j
		add	ecx, 8

loc_11CB:				; CODE XREF: _tls1_enc+1FEj
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_1237
		mov	eax, [esi+5Ch]
		test	edx, edx
		jz	short loc_11E7
		movzx	ebx, word ptr [eax+20Ah]
		jmp	short loc_11EE
; ---------------------------------------------------------------------------

loc_11E7:				; CODE XREF: _tls1_enc+214j
		movzx	ebx, word ptr [eax+208h]

loc_11EE:				; CODE XREF: _tls1_enc+21Dj
		mov	[esp+58h+var_44], ebx
		sar	ebx, 8
		mov	byte ptr [esp+58h+var_10], bl
		test	edx, edx
		jz	short loc_1206
		movzx	eax, word ptr [eax+20Ah]
		jmp	short loc_120D
; ---------------------------------------------------------------------------

loc_1206:				; CODE XREF: _tls1_enc+233j
		movzx	eax, word ptr [eax+208h]

loc_120D:				; CODE XREF: _tls1_enc+23Cj
		mov	ebx, [esp+58h+var_48]
		mov	byte ptr [esp+58h+var_10+1], al
		mov	eax, [ecx+2]
		mov	[esp+58h+var_10+2], eax
		mov	ax, [ecx+6]
		mov	[esp+58h+var_A], ax
		mov	eax, [esp+58h+var_10]
		mov	[esp+58h+var_20], eax
		mov	eax, [esp+4Ch]
		mov	[esp+58h+var_1C], eax
		jmp	short loc_1254
; ---------------------------------------------------------------------------

loc_1237:				; CODE XREF: _tls1_enc+20Dj
		mov	eax, [ecx]
		mov	[esp+58h+var_20], eax
		mov	eax, [ecx+4]
		mov	[esp+58h+var_1C], eax
		mov	eax, 7

loc_1249:				; CODE XREF: _tls1_enc+28Aj
		add	byte ptr [eax+ecx], 1
		jnz	short loc_1254
		sub	eax, 1
		jns	short loc_1249

loc_1254:				; CODE XREF: _tls1_enc+26Dj
					; _tls1_enc+285j
		movzx	eax, byte ptr [ebx]
		mov	[esp+58h+var_18], al
		mov	eax, [esi]
		sar	eax, 8
		mov	[esp+58h+var_17], al
		movzx	eax, byte ptr [esi]
		mov	[esp+58h+var_16], al
		mov	eax, [ebx+4]
		shr	eax, 8
		mov	[esp+58h+var_15], al
		movzx	eax, byte ptr [ebx+4]
		mov	[esp+58h+var_14], al
		lea	eax, [esp+58h+var_20]
		push	eax
		push	0Dh
		push	16h
		push	ebp
		call	_EVP_CIPHER_CTX_ctrl
		mov	ecx, eax
		add	esp, 10h
		mov	[esp+58h+var_30], ecx
		test	ecx, ecx
		jle	loc_10ED
		mov	eax, [esp+58h+arg_4]
		test	eax, eax
		jz	loc_13AB
		add	edi, ecx
		add	[ebx+4], ecx
		jmp	loc_13A7
; ---------------------------------------------------------------------------

loc_12B3:				; CODE XREF: _tls1_enc+1EAj
		mov	ecx, [esp+58h+var_3C]
		cmp	ecx, 1
		jz	loc_13A3
		cmp	[esp+58h+arg_4], 0
		jz	loc_13AB
		mov	eax, edi
		cdq
		idiv	ecx
		sub	ecx, edx
		mov	[esp+58h+var_38], ecx
		dec	ecx
		test	dword ptr [esi+100h], 200h
		mov	[esp+58h+var_48], ecx
		jz	short loc_12F4
		mov	eax, [esi+58h]
		test	byte ptr [eax],	8
		jz	short loc_12F4
		inc	ecx
		mov	[esp+58h+var_48], ecx

loc_12F4:				; CODE XREF: _tls1_enc+31Dj
					; _tls1_enc+325j
		mov	ecx, [esp+58h+var_38]
		mov	ebp, edi
		add	ecx, edi
		mov	edx, ecx
		mov	[esp+58h+var_24], ecx
		sub	edx, edi
		cmp	edi, ecx
		jge	loc_1396
		cmp	edx, 10h
		jb	short loc_1383
		mov	eax, [ebx+10h]
		lea	esi, [eax+edi]
		dec	eax
		add	eax, ecx
		mov	[esp+58h+var_28], esi
		mov	[esp+58h+var_2C], eax
		lea	eax, [ebx+10h]
		cmp	esi, eax
		mov	esi, [esp+58h+var_44]
		ja	short loc_1333
		cmp	[esp+58h+var_2C], eax
		jnb	short loc_1383

loc_1333:				; CODE XREF: _tls1_enc+363j
		and	edx, 8000000Fh
		jns	short loc_1340
		dec	edx
		or	edx, 0FFFFFFF0h
		inc	edx

loc_1340:				; CODE XREF: _tls1_enc+371j
		sub	ecx, edx
		nop	word ptr [eax+eax+00h]

loc_1348:				; CODE XREF: _tls1_enc+385j
		add	ebp, 10h
		cmp	ebp, ecx
		jl	short loc_1348
		sub	ecx, edi
		mov	edi, [esp+58h+var_28]
		lea	eax, [ecx+0Fh]
		cdq
		and	edx, 0Fh
		lea	ecx, [edx+eax]
		movzx	eax, byte ptr [esp+58h+var_48]
		and	ecx, 0FFFFFFF0h
		imul	eax, 1010101h
		mov	esi, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, esi
		mov	esi, [esp+58h+var_44]
		and	ecx, 3
		rep stosb
		mov	ecx, [esp+58h+var_24]

loc_1383:				; CODE XREF: _tls1_enc+347j
					; _tls1_enc+369j
		cmp	ebp, ecx
		jge	short loc_1396
		mov	edx, [esp+58h+var_48]

loc_138B:				; CODE XREF: _tls1_enc+3CCj
		mov	eax, [ebx+10h]
		mov	[eax+ebp], dl
		inc	ebp
		cmp	ebp, ecx
		jl	short loc_138B

loc_1396:				; CODE XREF: _tls1_enc+33Ej
					; _tls1_enc+3BDj
		mov	eax, [esp+58h+var_38]
		mov	edi, ecx
		add	[ebx+4], eax
		mov	ebp, [esp+58h+var_34]

loc_13A3:				; CODE XREF: _tls1_enc+2F2j
		mov	eax, [esp+58h+arg_4]

loc_13A7:				; CODE XREF: _tls1_enc+2E6j
		test	eax, eax
		jnz	short loc_13D0

loc_13AB:				; CODE XREF: _tls1_enc+2DBj
					; _tls1_enc+2FDj
		test	edi, edi
		jz	short loc_13BB
		xor	edx, edx
		mov	eax, edi
		div	[esp+58h+var_3C]
		test	edx, edx
		jz	short loc_13D0

loc_13BB:				; CODE XREF: _tls1_enc+3E5j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_13D0:				; CODE XREF: _tls1_enc+3E1j
					; _tls1_enc+3F1j
		push	edi
		push	dword ptr [ebx+10h]
		push	dword ptr [ebx+0Ch]
		push	ebp
		call	_EVP_Cipher
		push	dword ptr [ebp+0]
		mov	edi, eax
		call	_EVP_CIPHER_flags
		add	esp, 14h
		xor	ecx, ecx
		test	eax, 100000h
		jz	short loc_13FA
		test	edi, edi
		sets	cl
		jmp	short loc_13FF
; ---------------------------------------------------------------------------

loc_13FA:				; CODE XREF: _tls1_enc+429j
		test	edi, edi
		setz	cl

loc_13FF:				; CODE XREF: _tls1_enc+430j
		test	ecx, ecx
		jnz	loc_10ED
		push	[esp+58h+var_40]
		call	_EVP_CIPHER_flags
		mov	ebp, [esp+5Ch+arg_4]
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 6
		jnz	short loc_1431
		test	ebp, ebp
		jnz	short loc_1431
		add	dword ptr [ebx+0Ch], 8
		add	dword ptr [ebx+10h], 8
		add	dword ptr [ebx+4], 0FFFFFFF8h

loc_1431:				; CODE XREF: _tls1_enc+457j
					; _tls1_enc+45Bj
		push	dword ptr [esi+84h]
		mov	edi, 1
		call	_EVP_MD_CTX_md
		add	esp, 4
		test	eax, eax
		jz	short loc_1460
		push	dword ptr [esi+84h]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		add	esp, 8
		mov	ecx, eax
		jmp	short loc_1462
; ---------------------------------------------------------------------------

loc_1460:				; CODE XREF: _tls1_enc+47Ej
		xor	ecx, ecx

loc_1462:				; CODE XREF: _tls1_enc+496j
		mov	eax, [esp+58h+var_3C]
		cmp	eax, 1
		jz	short loc_147D
		test	ebp, ebp
		jnz	short loc_147D
		push	ecx
		push	eax
		push	ebx
		push	esi
		call	_tls1_cbc_remove_padding
		add	esp, 10h
		mov	edi, eax

loc_147D:				; CODE XREF: _tls1_enc+4A1j
					; _tls1_enc+4A5j
		mov	eax, [esp+58h+var_30]
		test	eax, eax
		jz	short loc_14BE
		test	ebp, ebp
		jnz	short loc_14BE
		sub	[ebx+4], eax
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_14A1:				; CODE XREF: _tls1_enc+1B5j
					; _tls1_enc+1BDj ...
		push	dword ptr [ebx+4] ; Size
		push	dword ptr [ebx+10h] ; Src
		push	dword ptr [ebx+0Ch] ; Dst
		call	dword ptr ds:__imp__memmove
		mov	eax, [ebx+0Ch]
		add	esp, 0Ch
		mov	[ebx+10h], eax
		mov	edi, 1

loc_14BE:				; CODE XREF: _tls1_enc+4BBj
					; _tls1_enc+4BFj
		mov	ecx, [esp+58h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_tls1_enc	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_export_keying_material(int, void *Dst, size_t, void *Src, size_t Size, void *, size_t, int)
		public _tls1_export_keying_material
_tls1_export_keying_material proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Src		= dword	ptr  10h
Size		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	4C4h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	[esp+1Ch+arg_8]
		xor	esi, esi
		call	_CRYPTO_malloc
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	$err2$30
		mov	edi, [esp+14h+Size]
		mov	ebx, [esp+14h+arg_18]
		lea	eax, [edi+40h]
		mov	[esp+14h+var_4], eax
		cmp	[esp+14h+arg_1C], esi
		jz	short loc_1522
		add	eax, 2
		add	eax, ebx
		mov	[esp+14h+var_4], eax

loc_1522:				; CODE XREF: _tls1_export_keying_material+43j
		push	4D2h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	$err2$30
		push	edi		; Size
		push	[esp+18h+Src]	; Src
		push	esi		; Dst
		call	_memcpy
		mov	edx, [esp+20h+arg_0]
		lea	ecx, [edi+20h]
		add	esp, 0Ch
		cmp	[esp+14h+arg_1C], 0
		mov	eax, [edx+58h]
		movups	xmm0, xmmword ptr [eax+0C0h]
		movups	xmmword	ptr [esi+edi], xmm0
		movups	xmm0, xmmword ptr [eax+0D0h]
		movups	xmmword	ptr [esi+edi+10h], xmm0
		mov	eax, [edx+58h]
		movups	xmm0, xmmword ptr [eax+0A0h]
		movups	xmmword	ptr [ecx+esi], xmm0
		movups	xmm0, xmmword ptr [eax+0B0h]
		movups	xmmword	ptr [ecx+esi+10h], xmm0
		jz	short loc_15B9
		mov	eax, ebx
		shr	eax, 8
		mov	[ecx+esi+20h], al
		mov	eax, [esp+14h+arg_14]
		mov	[ecx+esi+21h], bl
		add	ecx, 22h ; '"'
		test	ebx, ebx
		jnz	short loc_15AB
		test	eax, eax
		jz	short loc_15B9

loc_15AB:				; CODE XREF: _tls1_export_keying_material+D1j
		push	ebx		; Size
		push	eax		; Src
		lea	eax, [ecx+esi]
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch

loc_15B9:				; CODE XREF: _tls1_export_keying_material+B9j
					; _tls1_export_keying_material+D5j
		mov	ecx, esi
		mov	edx, offset ??_C@_0BA@OOFGCNEE@client?5finished?$AA@ ; "client finished"
		mov	edi, 0Bh

loc_15C5:				; CODE XREF: _tls1_export_keying_material+100j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_15EA
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_15C5
		mov	ax, [ecx]
		cmp	ax, [edx]
		jnz	short loc_15EA
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jz	$err1$31

loc_15EA:				; CODE XREF: _tls1_export_keying_material+F5j
					; _tls1_export_keying_material+108j
		mov	ecx, esi
		mov	edx, offset ??_C@_0BA@MHGDKHGN@server?5finished?$AA@ ; "server finished"
		mov	edi, 0Bh

loc_15F6:				; CODE XREF: _tls1_export_keying_material+131j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_1617
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_15F6
		mov	ax, [ecx]
		cmp	ax, [edx]
		jnz	short loc_1617
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jz	short $err1$31

loc_1617:				; CODE XREF: _tls1_export_keying_material+126j
					; _tls1_export_keying_material+139j
		mov	ecx, esi
		mov	edx, offset ??_C@_0O@FEJGMKDJ@master?5secret?$AA@ ; "master secret"
		mov	edi, 9
		nop

loc_1624:				; CODE XREF: _tls1_export_keying_material+15Fj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_163B
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_1624
		mov	al, [ecx]
		cmp	al, [edx]
		jz	short $err1$31

loc_163B:				; CODE XREF: _tls1_export_keying_material+154j
		mov	ecx, esi
		mov	edx, offset ??_C@_0O@EOHBJBLD@key?5expansion?$AA@ ; "key expansion"
		mov	edi, 9

loc_1647:				; CODE XREF: _tls1_export_keying_material+182j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_166F
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_1647
		mov	al, [ecx]
		cmp	al, [edx]
		jnz	short loc_166F

$err1$31:				; CODE XREF: _tls1_export_keying_material+110j
					; _tls1_export_keying_material+141j ...
		push	50Ah
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	16Fh
		jmp	short loc_16D5
; ---------------------------------------------------------------------------

loc_166F:				; CODE XREF: _tls1_export_keying_material+177j
					; _tls1_export_keying_material+188j
		push	[esp+14h+arg_8]	; Size
		mov	ecx, [esp+18h+arg_0]
		push	ebp		; int
		push	[esp+1Ch+Dst]	; Dst
		mov	ebx, [esp+20h+var_4]
		mov	eax, [ecx+0C0h]
		push	dword ptr [eax+10h] ; int
		add	eax, 14h
		push	eax		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	ebx		; int
		push	esi		; int
		push	ecx
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		push	ebx
		push	esi
		mov	edi, eax
		call	_OPENSSL_cleanse
		add	esp, 48h
		push	[esp+14h+arg_8]
		push	ebp
		call	_OPENSSL_cleanse
		add	esp, 8
		jmp	short $ret$32
; ---------------------------------------------------------------------------

$err2$30:				; CODE XREF: _tls1_export_keying_material+2Aj
					; _tls1_export_keying_material+65j
		push	50Eh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	41h ; 'A'

loc_16D5:				; CODE XREF: _tls1_export_keying_material+199j
		push	13Ah
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	edi, edi

$ret$32:				; CODE XREF: _tls1_export_keying_material+1F3j
		test	ebp, ebp
		jz	short loc_16F3
		push	ebp
		call	_CRYPTO_free
		add	esp, 4

loc_16F3:				; CODE XREF: _tls1_export_keying_material+214j
		test	esi, esi
		jz	short loc_1700
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_1700:				; CODE XREF: _tls1_export_keying_material+221j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_tls1_export_keying_material endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1708h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_final_finish_mac
_tls1_final_finish_mac proc near

var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
Dst		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= byte ptr -0A8h
var_90		= dword	ptr -90h
var_84		= dword	ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 0C0h ; 'À'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0C0h+var_4], eax
		mov	eax, [esp+0C0h+arg_4]
		push	ebp
		mov	ebp, [esp+0C4h+arg_0]
		mov	[esp+0C4h+var_AC], eax
		mov	eax, [esp+0C4h+arg_C]
		mov	[esp+0C4h+Dst],	eax
		mov	eax, [ebp+58h]
		push	esi
		xor	esi, esi
		push	edi
		lea	edi, [esp+0CCh+var_84]
		mov	[esp+0CCh+var_C0], esi
		cmp	[eax+178h], esi
		jz	short loc_177A
		push	ebp
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jnz	short loc_177A
		pop	edi
		pop	esi
		pop	ebp
		mov	ecx, [esp+0C0h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C0h
		retn
; ---------------------------------------------------------------------------

loc_177A:				; CODE XREF: _tls1_final_finish_mac+4Bj
					; _tls1_final_finish_mac+58j
		lea	eax, [esp+0CCh+var_A8]
		push	ebx
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+0D4h+var_BC]
		xor	ebx, ebx
		push	eax
		lea	eax, [esp+0D8h+var_B8]
		push	eax
		push	ebx
		call	_ssl_get_handshake_digest
		add	esp, 10h
		test	eax, eax
		jz	loc_184A
		nop	word ptr [eax+eax+00h]

loc_17A8:				; CODE XREF: _tls1_final_finish_mac+13Cj
		push	ebp
		call	_ssl_get_algorithm2
		add	esp, 4
		test	[esp+0D0h+var_B8], eax
		jz	short loc_182E
		push	[esp+0D0h+var_BC]
		call	_EVP_MD_size
		mov	esi, eax
		add	esp, 4
		mov	eax, [ebp+58h]
		mov	eax, [eax+17Ch]
		mov	ecx, [eax+ebx*4]
		test	ecx, ecx
		jz	short loc_1825
		test	esi, esi
		js	short loc_1825
		lea	eax, [esp+0D0h+var_4]
		sub	eax, edi
		cmp	esi, eax
		jg	short loc_1825
		push	ecx
		lea	eax, [esp+0D4h+var_A8]
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jz	short loc_1815
		lea	eax, [esp+0D0h+var_B4]
		push	eax
		lea	eax, [esp+0D4h+var_A8]
		push	edi
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1815
		cmp	[esp+0D0h+var_B4], esi
		jz	short loc_181D

loc_1815:				; CODE XREF: _tls1_final_finish_mac+EEj
					; _tls1_final_finish_mac+105j
		mov	[esp+0D0h+var_C0], 1

loc_181D:				; CODE XREF: _tls1_final_finish_mac+10Bj
		add	edi, esi
		mov	esi, [esp+0D0h+var_C0]
		jmp	short loc_182E
; ---------------------------------------------------------------------------

loc_1825:				; CODE XREF: _tls1_final_finish_mac+CBj
					; _tls1_final_finish_mac+CFj ...
		mov	esi, 1
		mov	[esp+0D0h+var_C0], esi

loc_182E:				; CODE XREF: _tls1_final_finish_mac+ADj
					; _tls1_final_finish_mac+11Bj
		lea	eax, [esp+0D0h+var_BC]
		inc	ebx
		push	eax
		lea	eax, [esp+0D4h+var_B8]
		push	eax
		push	ebx
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_17A8

loc_184A:				; CODE XREF: _tls1_final_finish_mac+94j
		mov	eax, [ebp+0C0h]
		lea	ecx, [esp+0D0h+var_84]
		push	0Ch		; Size
		sub	edi, ecx
		lea	ecx, [esp+0D4h+var_90]
		push	ecx		; int
		push	[esp+0D8h+Dst]	; Dst
		push	dword ptr [eax+10h] ; int
		add	eax, 14h
		push	eax		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	edi		; int
		lea	eax, [esp+100h+var_84]
		push	eax		; int
		push	[esp+104h+arg_8] ; int
		push	[esp+108h+var_AC] ; int
		push	ebp
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		test	eax, eax
		mov	ecx, 1
		lea	eax, [esp+110h+var_A8]
		push	eax
		cmovz	esi, ecx
		call	_EVP_MD_CTX_cleanup
		add	esp, 44h
		lea	eax, [esp+0D0h+var_84]
		push	edi
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+0D8h+var_90]
		push	0Ch
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 10h
		xor	ecx, ecx
		test	esi, esi
		mov	eax, 0Ch
		cmovnz	eax, ecx
		mov	ecx, [esp+0D0h+var_4]
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C0h
		retn
_tls1_final_finish_mac endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_generate_key_block(int, void	*Dst, int, size_t Size)
_tls1_generate_key_block proc near	; CODE XREF: _tls1_setup_key_block+183p

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Size		= dword	ptr  10h

		push	[esp+Size]	; Size
		mov	edx, [esp+4+arg_0]
		push	[esp+4+arg_8]	; int
		push	[esp+8+Dst]	; Dst
		mov	eax, [edx+0C0h]
		mov	ecx, [edx+58h]
		push	dword ptr [eax+10h] ; int
		add	eax, 14h
		push	eax		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	0		; int
		push	20h ; ' '       ; int
		lea	eax, [ecx+0C0h]
		push	eax		; int
		push	20h ; ' '       ; int
		lea	eax, [ecx+0A0h]
		push	eax		; int
		push	0Dh		; int
		push	offset ??_C@_0O@EOHBJBLD@key?5expansion?$AA@ ; "key expansion"
		push	edx
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		add	esp, 40h
		retn
_tls1_generate_key_block endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1940h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_generate_master_secret
_tls1_generate_master_secret proc near

var_34		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 34h ; '4'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		mov	ecx, [esp+34h+arg_8]
		lea	eax, [esp+34h+var_34]
		push	esi
		mov	esi, [esp+38h+arg_0]
		push	30h ; '0'       ; Size
		push	eax		; int
		mov	eax, [esi+0C0h]
		mov	edx, [esi+58h]
		add	eax, 14h
		push	eax		; Dst
		push	[esp+44h+arg_C]	; int
		push	ecx		; int
		push	0		; int
		push	0		; int
		push	20h ; ' '       ; int
		lea	eax, [edx+0A0h]
		push	eax		; int
		push	0		; int
		push	0		; int
		push	20h ; ' '       ; int
		lea	eax, [edx+0C0h]
		push	eax		; int
		push	0Dh		; int
		push	offset ??_C@_0O@FEJGMKDJ@master?5secret?$AA@ ; "master secret"
		push	esi
		call	_ssl_get_algorithm2
		add	esp, 4
		push	eax		; int
		call	_tls1_PRF
		lea	eax, [esp+78h+var_34]
		push	30h ; '0'
		push	eax
		call	_OPENSSL_cleanse
		mov	ecx, [esp+80h+var_4]
		add	esp, 48h
		mov	eax, 30h ; '0'
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 34h
		retn
_tls1_generate_master_secret endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 19CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_mac
_tls1_mac	proc near

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		cmp	[esp+48h+arg_8], 0
		mov	eax, [esp+48h+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+54h+arg_0]
		push	edi
		mov	[esp+58h+var_3C], eax
		mov	[esp+58h+var_38], esi
		mov	edi, [esi+7Ch]
		mov	eax, [esi+58h]
		jz	short loc_1A16
		mov	ebp, [esi+90h]
		lea	ecx, [eax+130h]
		and	edi, 2
		lea	ebx, [eax+54h]
		jmp	short loc_1A28
; ---------------------------------------------------------------------------

loc_1A16:				; CODE XREF: _tls1_mac+34j
		mov	ebp, [esi+84h]
		lea	ecx, [eax+10Ch]
		and	edi, 1
		lea	ebx, [eax+8]

loc_1A28:				; CODE XREF: _tls1_mac+48j
		push	ebp
		mov	[esp+5Ch+var_40], ecx
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		mov	ecx, eax
		add	esp, 8
		mov	[esp+58h+var_44], ecx
		test	ecx, ecx
		jns	short loc_1A60
		push	offset ??_C@_06IGEDIHAH@t?5?$DO?$DN?50?$AA@ ; "t >= 0"
		push	406h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		call	_OpenSSLDie
		mov	ecx, [esp+64h+var_44]
		add	esp, 0Ch

loc_1A60:				; CODE XREF: _tls1_mac+77j
		mov	[esp+58h+var_48], ecx
		test	edi, edi
		jnz	short loc_1A8A
		lea	eax, [esp+58h+var_34]
		push	ebp
		push	eax
		call	_EVP_MD_CTX_copy
		add	esp, 8
		test	eax, eax
		jz	loc_1BB2
		mov	eax, [esp+58h+var_48]
		lea	ebp, [esp+58h+var_34]
		mov	[esp+58h+var_44], eax

loc_1A8A:				; CODE XREF: _tls1_mac+9Aj
		mov	eax, [esi+8]
		mov	edx, [esp+58h+arg_8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_1AEE
		mov	eax, [esi+5Ch]
		test	edx, edx
		jz	short loc_1AAA
		movzx	ecx, word ptr [eax+20Ah]
		jmp	short loc_1AB1
; ---------------------------------------------------------------------------

loc_1AAA:				; CODE XREF: _tls1_mac+D3j
		movzx	ecx, word ptr [eax+208h]

loc_1AB1:				; CODE XREF: _tls1_mac+DCj
		sar	ecx, 8
		mov	byte ptr [esp+58h+var_C], cl
		test	edx, edx
		jz	short loc_1AC5
		movzx	eax, word ptr [eax+20Ah]
		jmp	short loc_1ACC
; ---------------------------------------------------------------------------

loc_1AC5:				; CODE XREF: _tls1_mac+EEj
		movzx	eax, word ptr [eax+208h]

loc_1ACC:				; CODE XREF: _tls1_mac+F7j
		mov	byte ptr [esp+58h+var_C+1], al
		mov	eax, [ebx+2]
		mov	[esp+58h+var_C+2], eax
		mov	ax, [ebx+6]
		mov	[esp+58h+var_6], ax
		mov	eax, [esp+58h+var_C]
		mov	[esp+58h+var_1C], eax
		mov	eax, [esp+50h]
		jmp	short loc_1AF7
; ---------------------------------------------------------------------------

loc_1AEE:				; CODE XREF: _tls1_mac+CCj
		mov	eax, [ebx]
		mov	[esp+58h+var_1C], eax
		mov	eax, [ebx+4]

loc_1AF7:				; CODE XREF: _tls1_mac+120j
		mov	ecx, [esp+58h+var_40]
		mov	[esp+58h+var_18], eax
		mov	eax, [ecx]
		mov	esi, eax
		shr	esi, 8
		add	esi, [ecx+4]
		add	[esp+58h+var_44], esi
		mov	esi, [esp+58h+var_38]
		movzx	eax, al
		mov	[ecx], eax
		mov	[esp+58h+var_14], al
		mov	eax, [esi]
		sar	eax, 8
		mov	[esp+58h+var_13], al
		mov	al, [esi]
		mov	[esp+58h+var_12], al
		mov	eax, [ecx+4]
		shr	eax, 8
		mov	[esp+58h+var_11], al
		mov	al, [ecx+4]
		mov	[esp+58h+var_10], al
		test	edx, edx
		jnz	loc_1BC8
		push	dword ptr [esi+80h]
		call	_EVP_CIPHER_CTX_flags
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 2
		jnz	short loc_1BC8
		push	ebp
		call	_ssl3_cbc_record_digest_supported
		add	esp, 4
		test	al, al
		jz	short loc_1BC8
		mov	eax, [esi+58h]
		mov	ecx, [esp+58h+var_40]
		push	0
		push	dword ptr [eax+10h]
		add	eax, 14h
		push	eax
		push	[esp+64h+var_44]
		mov	eax, [ecx+4]
		add	eax, [esp+68h+var_48]
		push	eax
		push	dword ptr [ecx+10h]
		lea	eax, [esp+70h+var_1C]
		push	eax
		lea	eax, [esp+74h+var_48]
		push	eax
		push	[esp+78h+var_3C]
		push	ebp
		call	_ssl3_cbc_digest_record
		add	esp, 28h
		test	eax, eax
		jg	short loc_1C09

loc_1BA1:				; CODE XREF: _tls1_mac+20Ej
					; _tls1_mac+225j ...
		test	edi, edi
		jnz	short loc_1BB2
		lea	eax, [esp+58h+var_34]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4

loc_1BB2:				; CODE XREF: _tls1_mac+ACj
					; _tls1_mac+1D7j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1BC8:				; CODE XREF: _tls1_mac+170j
					; _tls1_mac+18Cj ...
		push	0Dh
		lea	eax, [esp+5Ch+var_1C]
		push	eax
		push	ebp
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1BA1
		mov	ecx, [esp+58h+var_40]
		push	dword ptr [ecx+4]
		push	dword ptr [ecx+10h]
		push	ebp
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1BA1
		lea	eax, [esp+58h+var_48]
		push	eax
		push	[esp+5Ch+var_3C]
		push	ebp
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1BA1

loc_1C09:				; CODE XREF: _tls1_mac+1D3j
		test	edi, edi
		jnz	short loc_1C1A
		lea	eax, [esp+58h+var_34]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4

loc_1C1A:				; CODE XREF: _tls1_mac+23Fj
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jnz	short loc_1C37
		mov	eax, 7
		nop

loc_1C2C:				; CODE XREF: _tls1_mac+269j
		add	byte ptr [eax+ebx], 1
		jnz	short loc_1C37
		sub	eax, 1
		jns	short loc_1C2C

loc_1C37:				; CODE XREF: _tls1_mac+258j
					; _tls1_mac+264j
		mov	ecx, [esp+58h+var_4]
		mov	eax, [esp+58h+var_48]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_tls1_mac	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1C50h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_setup_key_block
_tls1_setup_key_block proc near

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4

		mov	eax, 14h
		call	__chkstk
		push	edi
		mov	edi, [esp+18h+arg_0]
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_C], 0
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+374h], 0
		jz	short loc_1C8D
		mov	eax, 1
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1C8D:				; CODE XREF: _tls1_setup_key_block+31j
		lea	eax, [esp+18h+var_4]
		push	eax
		lea	eax, [esp+1Ch+var_14]
		push	eax
		lea	eax, [esp+20h+var_10]
		push	eax
		lea	eax, [esp+24h+var_8]
		push	eax
		lea	eax, [esp+28h+arg_0]
		push	eax
		push	dword ptr [edi+0C0h]
		call	_ssl_cipher_get_evp
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1CDD
		push	28Ch
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	8Ah ; 'Š'
		push	0D3h ; 'Ó'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1CDD:				; CODE XREF: _tls1_setup_key_block+66j
		mov	ecx, [edi+58h]
		mov	eax, [esp+18h+arg_0]
		push	ebx
		push	ebp
		mov	[ecx+37Ch], eax
		mov	ecx, [edi+58h]
		mov	eax, [esp+20h+var_8]
		push	esi
		mov	[ecx+380h], eax
		mov	ecx, [edi+58h]
		mov	eax, [esp+24h+var_10]
		mov	[ecx+384h], eax
		mov	ecx, [edi+58h]
		mov	eax, [esp+24h+var_14]
		mov	[ecx+388h], eax
		push	[esp+24h+arg_0]
		call	_EVP_CIPHER_iv_length
		push	[esp+28h+arg_0]
		mov	ebx, eax
		call	_EVP_CIPHER_key_length
		add	ebx, [esp+2Ch+var_14]
		push	edi
		lea	ebx, [ebx+eax]
		add	ebx, ebx
		call	_ssl3_cleanup_key_block
		push	29Ah
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ebp, eax
		add	esp, 18h
		test	ebp, ebp
		jnz	short loc_1D77
		push	29Bh
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	41h ; 'A'
		push	0D3h ; 'Ó'
		push	14h
		call	_ERR_put_error
		mov	eax, [esp+38h+var_C]
		add	esp, 14h
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1D77:				; CODE XREF: _tls1_setup_key_block+FEj
		mov	eax, [edi+58h]
		push	2A2h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	ebx
		mov	[eax+374h], ebx
		mov	eax, [edi+58h]
		mov	[eax+378h], ebp
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1DCF
		push	2A3h
		push	offset ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ ; ".\\ssl\\t1_enc.c"
		push	41h ; 'A'
		push	0D3h ; 'Ó'
		push	14h
		call	_ERR_put_error
		push	ebp
		call	_CRYPTO_free
		mov	eax, [esp+3Ch+var_C]
		add	esp, 18h
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1DCF:				; CODE XREF: _tls1_setup_key_block+150j
		push	ebx		; Size
		push	esi		; int
		push	ebp		; Dst
		push	edi		; int
		call	_tls1_generate_key_block
		add	esp, 10h
		test	eax, eax
		jz	short $err$14
		test	dword ptr [edi+100h], 800h
		jnz	short loc_1E45
		mov	eax, [edi+8]
		cmp	dword ptr [eax], 301h
		jg	short loc_1E45
		mov	eax, [edi+58h]
		mov	dword ptr [eax+0E0h], 1
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0B4h]
		test	eax, eax
		jz	short loc_1E45
		cmp	dword ptr [eax+14h], 20h ; ' '
		jnz	short loc_1E26
		mov	eax, [edi+58h]
		mov	dword ptr [eax+0E0h], 0

loc_1E26:				; CODE XREF: _tls1_setup_key_block+1C7j
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0B4h]
		cmp	dword ptr [eax+14h], 4
		jnz	short loc_1E45
		mov	eax, [edi+58h]
		mov	dword ptr [eax+0E0h], 0

loc_1E45:				; CODE XREF: _tls1_setup_key_block+199j
					; _tls1_setup_key_block+1A4j ...
		mov	[esp+24h+var_C], 1

$err$14:				; CODE XREF: _tls1_setup_key_block+18Dj
		push	ebx
		push	esi
		call	_OPENSSL_cleanse
		push	esi
		call	_CRYPTO_free
		mov	eax, [esp+30h+var_C]
		add	esp, 0Ch
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		add	esp, 14h
		retn
_tls1_setup_key_block endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E6Ch
; COMDAT (pick any)
		public ??_C@_0L@JFGNIFBM@chunk?5?$DO?$DN?50?$AA@
; `string'
??_C@_0L@JFGNIFBM@chunk?5?$DO?$DN?50?$AA@ db 'chunk >= 0',0 ; DATA XREF: _tls1_P_hash+88o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E78h
; COMDAT (pick any)
		public ??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@
; `string'
??_C@_0P@PHHGKFPG@?4?2ssl?2t1_enc?4c?$AA@ db '.\ssl\t1_enc.c',0 ; DATA XREF: _tls1_PRF+1E8o
					; _tls1_PRF+210o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E88h
; COMDAT (pick any)
		public ??_C@_0O@EOHBJBLD@key?5expansion?$AA@
; `string'
??_C@_0O@EOHBJBLD@key?5expansion?$AA@ db 'key expansion',0
					; DATA XREF: _tls1_export_keying_material+169o
					; _tls1_generate_key_block+3Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E98h
; COMDAT (pick any)
		public ??_C@_0BB@DJIGDMHM@client?5write?5key?$AA@
; `string'
??_C@_0BB@DJIGDMHM@client?5write?5key?$AA@ db 'client write key',0
					; DATA XREF: _tls1_change_cipher_state+38Fo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1EACh
; COMDAT (pick any)
		public ??_C@_0BB@HLBNJBJK@server?5write?5key?$AA@
; `string'
??_C@_0BB@HLBNJBJK@server?5write?5key?$AA@ db 'server write key',0
					; DATA XREF: _tls1_change_cipher_state+34Eo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1EC0h
; COMDAT (pick any)
		public ??_C@_08IBBAIJIN@IV?5block?$AA@
; `string'
??_C@_08IBBAIJIN@IV?5block?$AA@	db 'IV block',0 ; DATA XREF: _tls1_change_cipher_state+4E5o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1ECCh
; COMDAT (pick any)
		public ??_C@_06EFONEEIH@n?5?$DO?$DN?50?$AA@
; `string'
??_C@_06EFONEEIH@n?5?$DO?$DN?50?$AA@ db	'n >= 0',0 ; DATA XREF: _tls1_enc+5Eo
					; _tls1_enc+165o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1ED4h
; COMDAT (pick any)
		public ??_C@_0CA@DAEFHPJI@?$CFs?3?$CFd?3?5rec?9?$DOdata?5?$CB?$DN?5rec?9?$DOinput?6?$AA@
; char `string'[]
??_C@_0CA@DAEFHPJI@?$CFs?3?$CFd?3?5rec?9?$DOdata?5?$CB?$DN?5rec?9?$DOinput?6?$AA@ db '%s:%d: rec->data != rec->input',0Ah,0
					; DATA XREF: _tls1_enc+F5o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1EF4h
; COMDAT (pick any)
		public ??_C@_06IGEDIHAH@t?5?$DO?$DN?50?$AA@
; `string'
??_C@_06IGEDIHAH@t?5?$DO?$DN?50?$AA@ db	't >= 0',0 ; DATA XREF: _tls1_mac+79o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1EFCh
; COMDAT (pick any)
		public ??_C@_0O@FEJGMKDJ@master?5secret?$AA@
; `string'
??_C@_0O@FEJGMKDJ@master?5secret?$AA@ db 'master secret',0
					; DATA XREF: _tls1_export_keying_material+145o
					; _tls1_generate_master_secret+52o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1F0Ch
; COMDAT (pick any)
		public ??_C@_0BA@OOFGCNEE@client?5finished?$AA@
; `string'
??_C@_0BA@OOFGCNEE@client?5finished?$AA@ db 'client finished',0
					; DATA XREF: _tls1_export_keying_material+E7o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1F1Ch
; COMDAT (pick any)
		public ??_C@_0BA@MHGDKHGN@server?5finished?$AA@
; `string'
??_C@_0BA@MHGDKHGN@server?5finished?$AA@ db 'server finished',0
					; DATA XREF: _tls1_export_keying_material+118o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __imp____acrt_iob_func:near ; CODE XREF: _tls1_enc+FCp
					; DATA XREF: _tls1_enc+FCr
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p
					; DATA XREF: ...
; void *__cdecl	_memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp__memmove:near ; CODE XREF: _tls1_enc+4E2p
					; DATA XREF: _tls1_enc+4E2r
		extrn _CRYPTO_malloc:near ; CODE XREF: _tls1_change_cipher_state+A2p
					; _tls1_change_cipher_state+14Fp ...
		extrn _CRYPTO_free:near	; CODE XREF: _tls1_export_keying_material+217p
					; _tls1_export_keying_material+224p ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _tls1_P_hash+3D5p
					; _tls1_change_cipher_state+61Ap ...
		extrn _OpenSSLDie:near	; CODE XREF: _tls1_P_hash+97p
					; _tls1_enc+6Dp ...
		extrn _COMP_CTX_new:near ; CODE	XREF: _tls1_change_cipher_state+10Ep
					; _tls1_change_cipher_state+249p
		extrn _COMP_CTX_free:near ; CODE XREF: _tls1_change_cipher_state+F5p
					; _tls1_change_cipher_state+230p
		extrn _ERR_put_error:near ; CODE XREF: _tls1_PRF+1F9p
					; _tls1_PRF+21Ep ...
		extrn _EVP_MD_type:near	; CODE XREF: _tls1_cert_verify_mac+57p
		extrn _EVP_MD_size:near	; CODE XREF: _tls1_P_hash+78p
					; _tls1_enc+52p ...
		extrn _EVP_MD_CTX_md:near ; CODE XREF: _tls1_cert_verify_mac+51p
					; _tls1_enc+3Ap ...
		extrn _EVP_CIPHER_block_size:near ; CODE XREF: _tls1_enc+1D1p
		extrn _EVP_CIPHER_key_length:near
					; CODE XREF: _tls1_change_cipher_state+2C4p
					; _tls1_change_cipher_state+446p ...
		extrn _EVP_CIPHER_iv_length:near ; CODE	XREF: _tls1_change_cipher_state+32Bp
					; _tls1_enc+D2p ...
		extrn _EVP_CIPHER_flags:near ; CODE XREF: _tls1_change_cipher_state+313p
					; _tls1_change_cipher_state+3DDp ...
		extrn _EVP_CIPHER_CTX_cipher:near ; CODE XREF: _tls1_enc+9Cp
					; _tls1_enc+1A0p
		extrn _EVP_CIPHER_CTX_flags:near ; CODE	XREF: _tls1_mac+17Cp
		extrn _EVP_Cipher:near	; CODE XREF: _tls1_enc+410p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _tls1_P_hash+A4p
					; _tls1_P_hash+AEp ...
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _tls1_P_hash+3B2p
					; _tls1_P_hash+3BCp ...
		extrn _EVP_MD_CTX_create:near ;	CODE XREF: _tls1_change_cipher_state+1EDp
		extrn _EVP_MD_CTX_copy_ex:near ; CODE XREF: _tls1_P_hash+10Bp
					; _tls1_P_hash+1FCp ...
		extrn _EVP_MD_CTX_set_flags:near ; CODE	XREF: _tls1_P_hash+C4p
		extrn _EVP_DigestUpdate:near ; CODE XREF: _tls1_P_hash+12Cp
					; _tls1_P_hash+151p ...
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _tls1_cert_verify_mac+CAp
					; _tls1_final_finish_mac+FBp
		extrn _EVP_MD_CTX_copy:near ; CODE XREF: _tls1_mac+A2p
		extrn _EVP_CipherInit_ex:near ;	CODE XREF: _tls1_change_cipher_state+57Bp
					; _tls1_change_cipher_state+5B7p
		extrn _EVP_DigestSignInit:near ; CODE XREF: _tls1_P_hash+F1p
					; _tls1_change_cipher_state+41Bp
		extrn _EVP_DigestSignFinal:near	; CODE XREF: _tls1_P_hash+1E2p
					; _tls1_P_hash+315p ...
		extrn _EVP_CIPHER_CTX_init:near	; CODE XREF: _tls1_change_cipher_state+B9p
		extrn _EVP_CIPHER_CTX_cleanup:near
					; CODE XREF: _tls1_change_cipher_state+2A2p
		extrn _EVP_CIPHER_CTX_new:near
					; CODE XREF: _tls1_change_cipher_state:loc_B00p
		extrn _EVP_CIPHER_CTX_ctrl:near	; CODE XREF: _tls1_change_cipher_state+58Cp
					; _tls1_change_cipher_state+5F6p ...
		extrn _EVP_PKEY_free:near ; CODE XREF: _tls1_P_hash+3A8p
					; _tls1_change_cipher_state+42Cp ...
		extrn _EVP_PKEY_new_mac_key:near ; CODE	XREF: _tls1_P_hash+D2p
					; _tls1_change_cipher_state+3FCp
		extrn _ssl_cipher_get_evp:near ; CODE XREF: _tls1_setup_key_block+5Cp
		extrn _ssl_get_handshake_digest:near ; CODE XREF: _tls1_PRF+1Cp
					; _tls1_PRF+48p ...
		extrn _ssl3_cleanup_key_block:near ; CODE XREF:	_tls1_setup_key_block+E2p
		extrn _ssl3_digest_cached_records:near
					; CODE XREF: _tls1_cert_verify_mac+1Cp
					; _tls1_final_finish_mac+4Ep
		extrn _ssl_replace_hash:near ; CODE XREF: _tls1_change_cipher_state+D4p
					; _tls1_change_cipher_state+211p
		extrn _ssl_get_algorithm2:near ; CODE XREF: _tls1_change_cipher_state+485p
					; _tls1_change_cipher_state+4EBp ...
		extrn _tls1_cbc_remove_padding:near ; CODE XREF: _tls1_enc+4ABp
		extrn _ssl3_cbc_record_digest_supported:near ; CODE XREF: _tls1_mac+18Fp
		extrn _ssl3_cbc_digest_record:near ; CODE XREF:	_tls1_mac+1C9p
		extrn _RAND_bytes:near	; CODE XREF: _tls1_enc+115p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _tls1_P_hash+3EEp
					; _tls1_change_cipher_state+67Dp ...
		extrn __chkstk:near	; CODE XREF: _tls1_PRF+5p
					; _tls1_P_hash+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _tls1_P_hash+394p
					; _tls1_change_cipher_state+3D7p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _tls1_PRF+83p
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso
		extrn ___security_cookie:near ;	DATA XREF: _tls1_P_hash+Ar
					; _tls1_change_cipher_state+Ar	...


		end
