;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	712F9AB7347A20F2D7E084A6DCB48AA5
; Input	CRC32 :	A2E941C1

; File Name   :	C:\compspace\Diff\openssl\obj\aesni-x86.obj
; Format      :	COFF (X386MAGIC)

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
; Segment alignment '64byte' can not be represented in assembly
_text		segment	para public 'CODE' use32
		assume cs:_text
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_encrypt_begin
L$_aesni_encrypt_begin proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_8]
		movups	xmm2, xmmword ptr [eax]
		mov	ecx, [edx+0F0h]
		mov	eax, [esp+arg_4]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$000enc1_loop_1:			; CODE XREF: L$_aesni_encrypt_begin+2Ej
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$000enc1_loop_1
		aesenclast xmm2, xmm1
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		movups	xmmword	ptr [eax], xmm2
		pxor	xmm2, xmm2
		retn
L$_aesni_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_decrypt_begin
L$_aesni_decrypt_begin proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_8]
		movups	xmm2, xmmword ptr [eax]
		mov	ecx, [edx+0F0h]
		mov	eax, [esp+arg_4]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$001dec1_loop_2:			; CODE XREF: L$_aesni_decrypt_begin+2Ej
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$001dec1_loop_2
		aesdeclast xmm2, xmm1
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		movups	xmmword	ptr [eax], xmm2
		pxor	xmm2, xmm2
		retn
L$_aesni_decrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_encrypt2 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$018ecb_enc_twop
					; L$_aesni_ctr32_encrypt_blocks_begin:L$042ctr32_twop ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		add	ecx, 10h

L$002enc2_loop:				; CODE XREF: __aesni_encrypt2+3Ej
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$002enc2_loop
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		retn
__aesni_encrypt2 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_decrypt2 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$026ecb_dec_twop
					; L$_aesni_xts_decrypt_begin+3E3p ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		add	ecx, 10h

L$003dec2_loop:				; CODE XREF: __aesni_decrypt2+3Ej
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesdec	xmm2, xmm0
		aesdec	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$003dec2_loop
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdeclast xmm2, xmm0
		aesdeclast xmm3, xmm0
		retn
__aesni_decrypt2 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_encrypt3 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$019ecb_enc_threep
					; L$_aesni_ctr32_encrypt_blocks_begin:L$043ctr32_threep ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		add	ecx, 10h

L$004enc3_loop:				; CODE XREF: __aesni_encrypt3+4Cj
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		aesenc	xmm4, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$004enc3_loop
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		aesenclast xmm4, xmm0
		retn
__aesni_encrypt3 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_decrypt3 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$027ecb_dec_threep
					; L$_aesni_xts_decrypt_begin+42Ap ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		add	ecx, 10h

L$005dec3_loop:				; CODE XREF: __aesni_decrypt3+4Cj
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesdec	xmm2, xmm0
		aesdec	xmm3, xmm0
		aesdec	xmm4, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$005dec3_loop
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1
		aesdeclast xmm2, xmm0
		aesdeclast xmm3, xmm0
		aesdeclast xmm4, xmm0
		retn
__aesni_decrypt3 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_encrypt4 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$020ecb_enc_fourp
					; L$_aesni_ctr32_encrypt_blocks_begin:L$044ctr32_fourp	...
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		shl	ecx, 4
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		pxor	xmm5, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		nop	dword ptr [eax+00h]
		add	ecx, 10h

L$006enc4_loop:				; CODE XREF: __aesni_encrypt4+5Ej
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1
		aesenc	xmm5, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		aesenc	xmm4, xmm0
		aesenc	xmm5, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$006enc4_loop
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1
		aesenc	xmm5, xmm1
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		aesenclast xmm4, xmm0
		aesenclast xmm5, xmm0
		retn
__aesni_encrypt4 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_decrypt4 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$028ecb_dec_fourp
					; L$_aesni_xts_decrypt_begin+474p ...
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		shl	ecx, 4
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		pxor	xmm5, xmm0
		movups	xmm0, xmmword ptr [edx+20h]
		lea	edx, [edx+ecx+20h]
		neg	ecx
		nop	dword ptr [eax+00h]
		add	ecx, 10h

L$007dec4_loop:				; CODE XREF: __aesni_decrypt4+5Ej
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1
		aesdec	xmm5, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesdec	xmm2, xmm0
		aesdec	xmm3, xmm0
		aesdec	xmm4, xmm0
		aesdec	xmm5, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$007dec4_loop
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1
		aesdec	xmm5, xmm1
		aesdeclast xmm2, xmm0
		aesdeclast xmm3, xmm0
		aesdeclast xmm4, xmm0
		aesdeclast xmm5, xmm0
		retn
__aesni_decrypt4 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_encrypt6 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$015ecb_enc_loop6_enterp
					; L$_aesni_ecb_encrypt_begin+113p ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		aesenc	xmm2, xmm1
		pxor	xmm5, xmm0
		pxor	xmm6, xmm0
		aesenc	xmm3, xmm1
		lea	edx, [edx+ecx+20h]
		neg	ecx
		aesenc	xmm4, xmm1
		pxor	xmm7, xmm0
		movups	xmm0, xmmword ptr [edx+ecx]
		add	ecx, 10h
		jmp	L$008_aesni_encrypt6_inner
; ---------------------------------------------------------------------------
		align 10h

L$009enc6_loop:				; CODE XREF: L$_aesni_encrypt6_enter+2Aj
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1

L$008_aesni_encrypt6_inner:		; CODE XREF: __aesni_encrypt6+3Dj
		aesenc	xmm5, xmm1
		aesenc	xmm6, xmm1
		aesenc	xmm7, xmm1
__aesni_encrypt6 endp ;	sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


L$_aesni_encrypt6_enter	proc near	; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+16Ap
					; L$_aesni_xts_encrypt_begin+1DBp
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		aesenc	xmm4, xmm0
		aesenc	xmm5, xmm0
		aesenc	xmm6, xmm0
		aesenc	xmm7, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$009enc6_loop
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenc	xmm4, xmm1
		aesenc	xmm5, xmm1
		aesenc	xmm6, xmm1
		aesenc	xmm7, xmm1
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		aesenclast xmm4, xmm0
		aesenclast xmm5, xmm0
		aesenclast xmm6, xmm0
		aesenclast xmm7, xmm0
		retn
L$_aesni_encrypt6_enter	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_decrypt6 proc near		; CODE XREF: L$_aesni_ecb_encrypt_begin:L$023ecb_dec_loop6_enterp
					; L$_aesni_ecb_encrypt_begin+2A3p ...
		movups	xmm0, xmmword ptr [edx]
		shl	ecx, 4
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm2, xmm0
		pxor	xmm3, xmm0
		pxor	xmm4, xmm0
		aesdec	xmm2, xmm1
		pxor	xmm5, xmm0
		pxor	xmm6, xmm0
		aesdec	xmm3, xmm1
		lea	edx, [edx+ecx+20h]
		neg	ecx
		aesdec	xmm4, xmm1
		pxor	xmm7, xmm0
		movups	xmm0, xmmword ptr [edx+ecx]
		add	ecx, 10h
		jmp	L$010_aesni_decrypt6_inner
; ---------------------------------------------------------------------------
		align 10h

L$011dec6_loop:				; CODE XREF: L$_aesni_decrypt6_enter+2Aj
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1

L$010_aesni_decrypt6_inner:		; CODE XREF: __aesni_decrypt6+3Dj
		aesdec	xmm5, xmm1
		aesdec	xmm6, xmm1
		aesdec	xmm7, xmm1
__aesni_decrypt6 endp ;	sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


L$_aesni_decrypt6_enter	proc near	; CODE XREF: L$_aesni_xts_decrypt_begin+1EBp
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesdec	xmm2, xmm0
		aesdec	xmm3, xmm0
		aesdec	xmm4, xmm0
		aesdec	xmm5, xmm0
		aesdec	xmm6, xmm0
		aesdec	xmm7, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$011dec6_loop
		aesdec	xmm2, xmm1
		aesdec	xmm3, xmm1
		aesdec	xmm4, xmm1
		aesdec	xmm5, xmm1
		aesdec	xmm6, xmm1
		aesdec	xmm7, xmm1
		aesdeclast xmm2, xmm0
		aesdeclast xmm3, xmm0
		aesdeclast xmm4, xmm0
		aesdeclast xmm5, xmm0
		aesdeclast xmm6, xmm0
		aesdeclast xmm7, xmm0
		retn
L$_aesni_decrypt6_enter	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_ecb_encrypt_begin
L$_aesni_ecb_encrypt_begin proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_0]
		mov	edi, [esp+10h+arg_4]
		mov	eax, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_C]
		mov	ebx, [esp+10h+arg_10]
		and	eax, 0FFFFFFF0h
		jz	L$012ecb_ret
		mov	ecx, [edx+0F0h]
		test	ebx, ebx
		jz	L$013ecb_decrypt
		mov	ebp, edx
		mov	ebx, ecx
		cmp	eax, 60h ; '`'
		jb	L$014ecb_enc_tail
		movdqu	xmm2, xmmword ptr [esi]
		movdqu	xmm3, xmmword ptr [esi+10h]
		movdqu	xmm4, xmmword ptr [esi+20h]
		movdqu	xmm5, xmmword ptr [esi+30h]
		movdqu	xmm6, xmmword ptr [esi+40h]
		movdqu	xmm7, xmmword ptr [esi+50h]
		lea	esi, [esi+60h]
		sub	eax, 60h ; '`'
		jmp	L$015ecb_enc_loop6_enter
; ---------------------------------------------------------------------------
		align 10h

L$016ecb_enc_loop6:			; CODE XREF: L$_aesni_ecb_encrypt_begin+B6j
		movups	xmmword	ptr [edi], xmm2
		movdqu	xmm2, xmmword ptr [esi]
		movups	xmmword	ptr [edi+10h], xmm3
		movdqu	xmm3, xmmword ptr [esi+10h]
		movups	xmmword	ptr [edi+20h], xmm4
		movdqu	xmm4, xmmword ptr [esi+20h]
		movups	xmmword	ptr [edi+30h], xmm5
		movdqu	xmm5, xmmword ptr [esi+30h]
		movups	xmmword	ptr [edi+40h], xmm6
		movdqu	xmm6, xmmword ptr [esi+40h]
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		movdqu	xmm7, xmmword ptr [esi+50h]
		lea	esi, [esi+60h]

L$015ecb_enc_loop6_enter:		; CODE XREF: L$_aesni_ecb_encrypt_begin+5Fj
		call	__aesni_encrypt6
		mov	edx, ebp
		mov	ecx, ebx
		sub	eax, 60h ; '`'
		jnb	L$016ecb_enc_loop6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		add	eax, 60h ; '`'
		jz	L$012ecb_ret

L$014ecb_enc_tail:			; CODE XREF: L$_aesni_ecb_encrypt_begin+36j
		movups	xmm2, xmmword ptr [esi]
		cmp	eax, 20h ; ' '
		jb	L$017ecb_enc_one
		movups	xmm3, xmmword ptr [esi+10h]
		jz	L$018ecb_enc_two
		movups	xmm4, xmmword ptr [esi+20h]
		cmp	eax, 40h ; '@'
		jb	L$019ecb_enc_three
		movups	xmm5, xmmword ptr [esi+30h]
		jz	L$020ecb_enc_four
		movups	xmm6, xmmword ptr [esi+40h]
		xorps	xmm7, xmm7
		call	__aesni_encrypt6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------

L$017ecb_enc_one:			; CODE XREF: L$_aesni_ecb_encrypt_begin+E5j
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$021enc1_loop_3:			; CODE XREF: L$_aesni_ecb_encrypt_begin+149j
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$021enc1_loop_3
		aesenclast xmm2, xmm1
		movups	xmmword	ptr [edi], xmm2
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$018ecb_enc_two:			; CODE XREF: L$_aesni_ecb_encrypt_begin+EFj
		call	__aesni_encrypt2
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$019ecb_enc_three:			; CODE XREF: L$_aesni_ecb_encrypt_begin+FCj
		call	__aesni_encrypt3
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$020ecb_enc_four:			; CODE XREF: L$_aesni_ecb_encrypt_begin+106j
		call	__aesni_encrypt4
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$013ecb_decrypt:			; CODE XREF: L$_aesni_ecb_encrypt_begin+29j
		mov	ebp, edx
		mov	ebx, ecx
		cmp	eax, 60h ; '`'
		jb	L$022ecb_dec_tail
		movdqu	xmm2, xmmword ptr [esi]
		movdqu	xmm3, xmmword ptr [esi+10h]
		movdqu	xmm4, xmmword ptr [esi+20h]
		movdqu	xmm5, xmmword ptr [esi+30h]
		movdqu	xmm6, xmmword ptr [esi+40h]
		movdqu	xmm7, xmmword ptr [esi+50h]
		lea	esi, [esi+60h]
		sub	eax, 60h ; '`'
		jmp	L$023ecb_dec_loop6_enter
; ---------------------------------------------------------------------------
		align 10h

L$024ecb_dec_loop6:			; CODE XREF: L$_aesni_ecb_encrypt_begin+246j
		movups	xmmword	ptr [edi], xmm2
		movdqu	xmm2, xmmword ptr [esi]
		movups	xmmword	ptr [edi+10h], xmm3
		movdqu	xmm3, xmmword ptr [esi+10h]
		movups	xmmword	ptr [edi+20h], xmm4
		movdqu	xmm4, xmmword ptr [esi+20h]
		movups	xmmword	ptr [edi+30h], xmm5
		movdqu	xmm5, xmmword ptr [esi+30h]
		movups	xmmword	ptr [edi+40h], xmm6
		movdqu	xmm6, xmmword ptr [esi+40h]
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		movdqu	xmm7, xmmword ptr [esi+50h]
		lea	esi, [esi+60h]

L$023ecb_dec_loop6_enter:		; CODE XREF: L$_aesni_ecb_encrypt_begin+1F0j
		call	__aesni_decrypt6
		mov	edx, ebp
		mov	ecx, ebx
		sub	eax, 60h ; '`'
		jnb	L$024ecb_dec_loop6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		add	eax, 60h ; '`'
		jz	L$012ecb_ret

L$022ecb_dec_tail:			; CODE XREF: L$_aesni_ecb_encrypt_begin+1C7j
		movups	xmm2, xmmword ptr [esi]
		cmp	eax, 20h ; ' '
		jb	L$025ecb_dec_one
		movups	xmm3, xmmword ptr [esi+10h]
		jz	L$026ecb_dec_two
		movups	xmm4, xmmword ptr [esi+20h]
		cmp	eax, 40h ; '@'
		jb	L$027ecb_dec_three
		movups	xmm5, xmmword ptr [esi+30h]
		jz	L$028ecb_dec_four
		movups	xmm6, xmmword ptr [esi+40h]
		xorps	xmm7, xmm7
		call	__aesni_decrypt6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------

L$025ecb_dec_one:			; CODE XREF: L$_aesni_ecb_encrypt_begin+275j
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$029dec1_loop_4:			; CODE XREF: L$_aesni_ecb_encrypt_begin+2D9j
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$029dec1_loop_4
		aesdeclast xmm2, xmm1
		movups	xmmword	ptr [edi], xmm2
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$026ecb_dec_two:			; CODE XREF: L$_aesni_ecb_encrypt_begin+27Fj
		call	__aesni_decrypt2
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$027ecb_dec_three:			; CODE XREF: L$_aesni_ecb_encrypt_begin+28Cj
		call	__aesni_decrypt3
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		jmp	L$012ecb_ret
; ---------------------------------------------------------------------------
		align 10h

L$028ecb_dec_four:			; CODE XREF: L$_aesni_ecb_encrypt_begin+296j
		call	__aesni_decrypt4
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5

L$012ecb_ret:				; CODE XREF: L$_aesni_ecb_encrypt_begin+1Bj
					; L$_aesni_ecb_encrypt_begin+D9j ...
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		pxor	xmm5, xmm5
		pxor	xmm6, xmm6
		pxor	xmm7, xmm7
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_ecb_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public L$_aesni_ccm64_encrypt_blocks_begin
L$_aesni_ccm64_encrypt_blocks_begin proc near

var_s0		= xmmword ptr  0
arg_C		= xmmword ptr  20h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+14h]
		mov	edi, [esp+18h]
		mov	eax, [esp+1Ch]
		mov	edx, [esp+20h]
		mov	ebx, [esp+24h]
		mov	ecx, [esp+28h]
		mov	ebp, esp
		sub	esp, 3Ch
		and	esp, 0FFFFFFF0h
		mov	[esp+30h], ebp
		movdqu	xmm7, xmmword ptr [ebx]
		movdqu	xmm3, xmmword ptr [ecx]
		mov	ecx, [edx+0F0h]
		mov	dword ptr [esp], 0C0D0E0Fh
		mov	dword ptr [esp+4], 8090A0Bh
		mov	dword ptr [esp+8], 4050607h
		mov	dword ptr [esp+0Ch], 10203h
		mov	ebx, 1
		xor	ebp, ebp
		mov	[esp+10h], ebx
		mov	[esp+14h], ebp
		mov	[esp+18h], ebp
		mov	[esp+1Ch], ebp
		shl	ecx, 4
		mov	ebx, 10h
		lea	ebp, [edx]
		movdqa	xmm5, xmmword ptr [esp]
		movdqa	xmm2, xmm7
		lea	edx, [edx+ecx+20h]
		sub	ebx, ecx
		pshufb	xmm7, xmm5

L$030ccm64_enc_outer:			; CODE XREF: L$_aesni_ccm64_encrypt_blocks_begin+FAj
		movups	xmm0, [ebp+var_s0]
		mov	ecx, ebx
		movups	xmm6, xmmword ptr [esi]
		xorps	xmm2, xmm0
		movups	xmm1, xmmword ptr [ebp+10h]
		xorps	xmm0, xmm6
		xorps	xmm3, xmm0
		movups	xmm0, [ebp+arg_C]

L$031ccm64_enc2_loop:			; CODE XREF: L$_aesni_ccm64_encrypt_blocks_begin+C4j
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$031ccm64_enc2_loop
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		paddq	xmm7, xmmword ptr [esp+10h]
		dec	eax
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		lea	esi, [esi+10h]
		xorps	xmm6, xmm2
		movdqa	xmm2, xmm7
		movups	xmmword	ptr [edi], xmm6
		pshufb	xmm2, xmm5
		lea	edi, [edi+10h]
		jnz	L$030ccm64_enc_outer
		mov	esp, [esp+30h]
		mov	edi, [esp+28h]
		movups	xmmword	ptr [edi], xmm3
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		pxor	xmm5, xmm5
		pxor	xmm6, xmm6
		pxor	xmm7, xmm7
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_ccm64_encrypt_blocks_begin endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public L$_aesni_ccm64_decrypt_blocks_begin
L$_aesni_ccm64_decrypt_blocks_begin proc near

var_s0		= xmmword ptr  0
arg_C		= xmmword ptr  20h
arg_DC		= dword	ptr  0F0h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+14h]
		mov	edi, [esp+18h]
		mov	eax, [esp+1Ch]
		mov	edx, [esp+20h]
		mov	ebx, [esp+24h]
		mov	ecx, [esp+28h]
		mov	ebp, esp
		sub	esp, 3Ch
		and	esp, 0FFFFFFF0h
		mov	[esp+30h], ebp
		movdqu	xmm7, xmmword ptr [ebx]
		movdqu	xmm3, xmmword ptr [ecx]
		mov	ecx, [edx+0F0h]
		mov	dword ptr [esp], 0C0D0E0Fh
		mov	dword ptr [esp+4], 8090A0Bh
		mov	dword ptr [esp+8], 4050607h
		mov	dword ptr [esp+0Ch], 10203h
		mov	ebx, 1
		xor	ebp, ebp
		mov	[esp+10h], ebx
		mov	[esp+14h], ebp
		mov	[esp+18h], ebp
		mov	[esp+1Ch], ebp
		movdqa	xmm5, xmmword ptr [esp]
		movdqa	xmm2, xmm7
		mov	ebp, edx
		mov	ebx, ecx
		pshufb	xmm7, xmm5
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$032enc1_loop_5:			; CODE XREF: L$_aesni_ccm64_decrypt_blocks_begin+97j
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$032enc1_loop_5
		aesenclast xmm2, xmm1
		shl	ebx, 4
		mov	ecx, 10h
		movups	xmm6, xmmword ptr [esi]
		paddq	xmm7, xmmword ptr [esp+10h]
		lea	esi, [esi+10h]
		sub	ecx, ebx
		lea	edx, [ebp+ebx+arg_C]
		mov	ebx, ecx
		jmp	L$033ccm64_dec_outer
; ---------------------------------------------------------------------------
		align 10h

L$033ccm64_dec_outer:			; CODE XREF: L$_aesni_ccm64_decrypt_blocks_begin+BEj
					; L$_aesni_ccm64_decrypt_blocks_begin+148j
		xorps	xmm6, xmm2
		movdqa	xmm2, xmm7
		movups	xmmword	ptr [edi], xmm6
		lea	edi, [edi+10h]
		pshufb	xmm2, xmm5
		sub	eax, 1
		jz	L$034ccm64_dec_break
		movups	xmm0, [ebp+var_s0]
		mov	ecx, ebx
		movups	xmm1, xmmword ptr [ebp+10h]
		xorps	xmm6, xmm0
		xorps	xmm2, xmm0
		xorps	xmm3, xmm6
		movups	xmm0, [ebp+arg_C]

L$035ccm64_dec2_loop:			; CODE XREF: L$_aesni_ccm64_decrypt_blocks_begin+122j
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		movups	xmm1, xmmword ptr [edx+ecx]
		add	ecx, 20h ; ' '
		aesenc	xmm2, xmm0
		aesenc	xmm3, xmm0
		movups	xmm0, xmmword ptr [edx+ecx-10h]
		jnz	L$035ccm64_dec2_loop
		movups	xmm6, xmmword ptr [esi]
		paddq	xmm7, xmmword ptr [esp+10h]
		aesenc	xmm2, xmm1
		aesenc	xmm3, xmm1
		aesenclast xmm2, xmm0
		aesenclast xmm3, xmm0
		lea	esi, [esi+10h]
		jmp	L$033ccm64_dec_outer
; ---------------------------------------------------------------------------
		align 10h

L$034ccm64_dec_break:			; CODE XREF: L$_aesni_ccm64_decrypt_blocks_begin+E5j
		mov	ecx, [ebp+arg_DC]
		mov	edx, ebp
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm6, xmm0
		lea	edx, [edx+20h]
		xorps	xmm3, xmm6

L$036enc1_loop_6:			; CODE XREF: L$_aesni_ccm64_decrypt_blocks_begin+174j
		aesenc	xmm3, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$036enc1_loop_6
		aesenclast xmm3, xmm1
		mov	esp, [esp+30h]
		mov	edi, [esp+28h]
		movups	xmmword	ptr [edi], xmm3
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		pxor	xmm5, xmm5
		pxor	xmm6, xmm6
		pxor	xmm7, xmm7
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_ccm64_decrypt_blocks_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public L$_aesni_ctr32_encrypt_blocks_begin
L$_aesni_ctr32_encrypt_blocks_begin proc near

var_s0		= xmmword ptr  0
arg_C		= xmmword ptr  20h
arg_DC		= dword	ptr  0F0h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+14h]
		mov	edi, [esp+18h]
		mov	eax, [esp+1Ch]
		mov	edx, [esp+20h]
		mov	ebx, [esp+24h]
		mov	ebp, esp
		sub	esp, 58h
		and	esp, 0FFFFFFF0h
		mov	[esp+50h], ebp
		cmp	eax, 1
		jz	L$037ctr32_one_shortcut
		movdqu	xmm7, xmmword ptr [ebx]
		mov	dword ptr [esp], 0C0D0E0Fh
		mov	dword ptr [esp+4], 8090A0Bh
		mov	dword ptr [esp+8], 4050607h
		mov	dword ptr [esp+0Ch], 10203h
		mov	ecx, 6
		xor	ebp, ebp
		mov	[esp+10h], ecx
		mov	[esp+14h], ecx
		mov	[esp+18h], ecx
		mov	[esp+1Ch], ebp
		pextrd	ebx, xmm7, 3
		pinsrd	xmm7, ebp, 3
		mov	ecx, [edx+0F0h]
		bswap	ebx
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		movdqa	xmm2, xmmword ptr [esp]
		pinsrd	xmm0, ebx, 0
		lea	ebp, [ebx+3]
		pinsrd	xmm1, ebp, 0
		inc	ebx
		pinsrd	xmm0, ebx, 1
		inc	ebp
		pinsrd	xmm1, ebp, 1
		inc	ebx
		pinsrd	xmm0, ebx, 2
		inc	ebp
		pinsrd	xmm1, ebp, 2
		movdqa	xmmword	ptr [esp+30h], xmm0
		pshufb	xmm0, xmm2
		movdqu	xmm6, xmmword ptr [edx]
		movdqa	xmmword	ptr [esp+40h], xmm1
		pshufb	xmm1, xmm2
		pshufd	xmm2, xmm0, 0C0h
		pshufd	xmm3, xmm0, 80h
		cmp	eax, 6
		jb	L$038ctr32_tail
		pxor	xmm7, xmm6
		shl	ecx, 4
		mov	ebx, 10h
		movdqa	xmmword	ptr [esp+20h], xmm7
		mov	ebp, edx
		sub	ebx, ecx
		lea	edx, [edx+ecx+20h]
		sub	eax, 6
		jmp	L$039ctr32_loop6
; ---------------------------------------------------------------------------
		align 10h

L$039ctr32_loop6:			; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+FDj
					; L$_aesni_ctr32_encrypt_blocks_begin+1F3j
		pshufd	xmm4, xmm0, 40h
		movdqa	xmm0, xmmword ptr [esp+20h]
		pshufd	xmm5, xmm1, 0C0h
		pxor	xmm2, xmm0
		pshufd	xmm6, xmm1, 80h
		pxor	xmm3, xmm0
		pshufd	xmm7, xmm1, 40h
		movups	xmm1, xmmword ptr [ebp+10h]
		pxor	xmm4, xmm0
		pxor	xmm5, xmm0
		aesenc	xmm2, xmm1
		pxor	xmm6, xmm0
		pxor	xmm7, xmm0
		aesenc	xmm3, xmm1
		movups	xmm0, [ebp+arg_C]
		mov	ecx, ebx
		aesenc	xmm4, xmm1
		aesenc	xmm5, xmm1
		aesenc	xmm6, xmm1
		aesenc	xmm7, xmm1
		call	L$_aesni_encrypt6_enter
		movups	xmm1, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [esi+10h]
		xorps	xmm2, xmm1
		movups	xmm1, xmmword ptr [esi+20h]
		xorps	xmm3, xmm0
		movups	xmmword	ptr [edi], xmm2
		movdqa	xmm0, xmmword ptr [esp+10h]
		xorps	xmm4, xmm1
		movdqa	xmm1, xmmword ptr [esp+40h]
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		paddd	xmm1, xmm0
		paddd	xmm0, xmmword ptr [esp+30h]
		movdqa	xmm2, xmmword ptr [esp]
		movups	xmm3, xmmword ptr [esi+30h]
		movups	xmm4, xmmword ptr [esi+40h]
		xorps	xmm5, xmm3
		movups	xmm3, xmmword ptr [esi+50h]
		lea	esi, [esi+60h]
		movdqa	xmmword	ptr [esp+30h], xmm0
		pshufb	xmm0, xmm2
		xorps	xmm6, xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		xorps	xmm7, xmm3
		movdqa	xmmword	ptr [esp+40h], xmm1
		pshufb	xmm1, xmm2
		movups	xmmword	ptr [edi+40h], xmm6
		pshufd	xmm2, xmm0, 0C0h
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		pshufd	xmm3, xmm0, 80h
		sub	eax, 6
		jnb	L$039ctr32_loop6
		add	eax, 6
		jz	L$040ctr32_ret
		movdqu	xmm7, [ebp+var_s0]
		mov	edx, ebp
		pxor	xmm7, xmmword ptr [esp+20h]
		mov	ecx, [ebp+arg_DC]

L$038ctr32_tail:			; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+DAj
		por	xmm2, xmm7
		cmp	eax, 2
		jb	L$041ctr32_one
		pshufd	xmm4, xmm0, 40h
		por	xmm3, xmm7
		jz	L$042ctr32_two
		pshufd	xmm5, xmm1, 0C0h
		por	xmm4, xmm7
		cmp	eax, 4
		jb	L$043ctr32_three
		pshufd	xmm6, xmm1, 80h
		por	xmm5, xmm7
		jz	L$044ctr32_four
		por	xmm6, xmm7
		call	__aesni_encrypt6
		movups	xmm1, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [esi+10h]
		xorps	xmm2, xmm1
		movups	xmm1, xmmword ptr [esi+20h]
		xorps	xmm3, xmm0
		movups	xmm0, xmmword ptr [esi+30h]
		xorps	xmm4, xmm1
		movups	xmm1, xmmword ptr [esi+40h]
		xorps	xmm5, xmm0
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm6, xmm1
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		jmp	L$040ctr32_ret
; ---------------------------------------------------------------------------
		align 10h

L$037ctr32_one_shortcut:		; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+27j
		movups	xmm2, xmmword ptr [ebx]
		mov	ecx, [edx+0F0h]

L$041ctr32_one:				; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+21Cj
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$045enc1_loop_7:			; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+2C2j
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$045enc1_loop_7
		aesenclast xmm2, xmm1
		movups	xmm6, xmmword ptr [esi]
		xorps	xmm6, xmm2
		movups	xmmword	ptr [edi], xmm6
		jmp	L$040ctr32_ret
; ---------------------------------------------------------------------------
		align 10h

L$042ctr32_two:				; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+22Bj
		call	__aesni_encrypt2
		movups	xmm5, xmmword ptr [esi]
		movups	xmm6, xmmword ptr [esi+10h]
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		jmp	L$040ctr32_ret
; ---------------------------------------------------------------------------
		align 10h

L$043ctr32_three:			; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+23Dj
		call	__aesni_encrypt3
		movups	xmm5, xmmword ptr [esi]
		movups	xmm6, xmmword ptr [esi+10h]
		xorps	xmm2, xmm5
		movups	xmm7, xmmword ptr [esi+20h]
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm4, xmm7
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		jmp	L$040ctr32_ret
; ---------------------------------------------------------------------------
		align 10h

L$044ctr32_four:			; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+24Cj
		call	__aesni_encrypt4
		movups	xmm6, xmmword ptr [esi]
		movups	xmm7, xmmword ptr [esi+10h]
		movups	xmm1, xmmword ptr [esi+20h]
		xorps	xmm2, xmm6
		movups	xmm0, xmmword ptr [esi+30h]
		xorps	xmm3, xmm7
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm4, xmm1
		movups	xmmword	ptr [edi+10h], xmm3
		xorps	xmm5, xmm0
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5

L$040ctr32_ret:				; CODE XREF: L$_aesni_ctr32_encrypt_blocks_begin+1FCj
					; L$_aesni_ctr32_encrypt_blocks_begin+290j ...
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		movdqa	xmmword	ptr [esp+20h], xmm0
		pxor	xmm5, xmm5
		movdqa	xmmword	ptr [esp+30h], xmm0
		pxor	xmm6, xmm6
		movdqa	xmmword	ptr [esp+40h], xmm0
		pxor	xmm7, xmm7
		mov	esp, [esp+50h]
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_ctr32_encrypt_blocks_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_xts_encrypt_begin
L$_aesni_xts_encrypt_begin proc	near

var_88		= xmmword ptr -88h
var_78		= xmmword ptr -78h
var_68		= xmmword ptr -68h
var_58		= xmmword ptr -58h
var_48		= xmmword ptr -48h
var_38		= xmmword ptr -38h
var_28		= xmmword ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+10h+arg_10]
		mov	esi, [esp+10h+arg_14]
		mov	ecx, [edx+0F0h]
		movups	xmm2, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$046enc1_loop_8:			; CODE XREF: L$_aesni_xts_encrypt_begin+2Ej
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$046enc1_loop_8
		aesenclast xmm2, xmm1
		mov	esi, [esp+10h+arg_0]
		mov	edi, [esp+10h+arg_4]
		mov	eax, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_C]
		mov	ebp, esp
		sub	esp, 78h
		mov	ecx, [edx+0F0h]
		and	esp, 0FFFFFFF0h
		mov	dword ptr [esp+88h+var_28], 87h	; '‡'
		mov	dword ptr [esp+88h+var_28+4], 0
		mov	dword ptr [esp+88h+var_28+8], 1
		mov	dword ptr [esp+88h+var_28+0Ch],	0
		mov	[esp+88h+var_18], eax
		mov	[esp+88h+var_14], ebp
		movdqa	xmm1, xmm2
		pxor	xmm0, xmm0
		movdqa	xmm3, [esp+88h+var_28]
		pcmpgtd	xmm0, xmm1
		and	eax, 0FFFFFFF0h
		mov	ebp, edx
		mov	ebx, ecx
		sub	eax, 60h ; '`'
		jb	L$047xts_enc_short
		shl	ecx, 4
		mov	ebx, 10h
		sub	ebx, ecx
		lea	edx, [edx+ecx+20h]
		jmp	L$048xts_enc_loop6
; ---------------------------------------------------------------------------
		align 10h

L$048xts_enc_loop6:			; CODE XREF: L$_aesni_xts_encrypt_begin+AFj
					; L$_aesni_xts_encrypt_begin+245j
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_88], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_78], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_68], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_58], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm7, xmm0, 13h
		movdqa	[esp+88h+var_48], xmm1
		paddq	xmm1, xmm1
		movups	xmm0, xmmword ptr [ebp+0]
		pand	xmm7, xmm3
		movups	xmm2, xmmword ptr [esi]
		pxor	xmm7, xmm1
		mov	ecx, ebx
		movdqu	xmm3, xmmword ptr [esi+10h]
		xorps	xmm2, xmm0
		movdqu	xmm4, xmmword ptr [esi+20h]
		pxor	xmm3, xmm0
		movdqu	xmm5, xmmword ptr [esi+30h]
		pxor	xmm4, xmm0
		movdqu	xmm6, xmmword ptr [esi+40h]
		pxor	xmm5, xmm0
		movdqu	xmm1, xmmword ptr [esi+50h]
		pxor	xmm6, xmm0
		lea	esi, [esi+60h]
		pxor	xmm2, [esp+88h+var_88]
		movdqa	[esp+88h+var_38], xmm7
		pxor	xmm7, xmm1
		movups	xmm1, xmmword ptr [ebp+10h]
		pxor	xmm3, [esp+88h+var_78]
		pxor	xmm4, [esp+88h+var_68]
		aesenc	xmm2, xmm1
		pxor	xmm5, [esp+88h+var_58]
		pxor	xmm6, [esp+88h+var_48]
		aesenc	xmm3, xmm1
		pxor	xmm7, xmm0
		movups	xmm0, xmmword ptr [ebp+20h]
		aesenc	xmm4, xmm1
		aesenc	xmm5, xmm1
		aesenc	xmm6, xmm1
		aesenc	xmm7, xmm1
		call	L$_aesni_encrypt6_enter
		movdqa	xmm1, [esp+88h+var_38]
		pxor	xmm0, xmm0
		xorps	xmm2, [esp+88h+var_88]
		pcmpgtd	xmm0, xmm1
		xorps	xmm3, [esp+88h+var_78]
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm4, [esp+88h+var_68]
		movups	xmmword	ptr [edi+10h], xmm3
		xorps	xmm5, [esp+88h+var_58]
		movups	xmmword	ptr [edi+20h], xmm4
		xorps	xmm6, [esp+88h+var_48]
		movups	xmmword	ptr [edi+30h], xmm5
		xorps	xmm7, xmm1
		movups	xmmword	ptr [edi+40h], xmm6
		pshufd	xmm2, xmm0, 13h
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		movdqa	xmm3, [esp+88h+var_28]
		pxor	xmm0, xmm0
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		sub	eax, 60h ; '`'
		jnb	L$048xts_enc_loop6
		mov	ecx, [ebp+0F0h]
		mov	edx, ebp
		mov	ebx, ecx

L$047xts_enc_short:			; CODE XREF: L$_aesni_xts_encrypt_begin+9Bj
		add	eax, 60h ; '`'
		jz	L$049xts_enc_done6x
		movdqa	xmm5, xmm1
		cmp	eax, 20h ; ' '
		jb	L$050xts_enc_one
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		jz	L$051xts_enc_two
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	xmm6, xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		cmp	eax, 40h ; '@'
		jb	L$052xts_enc_three
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	xmm7, xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		movdqa	[esp+88h+var_88], xmm5
		movdqa	[esp+88h+var_78], xmm6
		jz	L$053xts_enc_four
		movdqa	[esp+88h+var_68], xmm7
		pshufd	xmm7, xmm0, 13h
		movdqa	[esp+88h+var_58], xmm1
		paddq	xmm1, xmm1
		pand	xmm7, xmm3
		pxor	xmm7, xmm1
		movdqu	xmm2, xmmword ptr [esi]
		movdqu	xmm3, xmmword ptr [esi+10h]
		movdqu	xmm4, xmmword ptr [esi+20h]
		pxor	xmm2, [esp+88h+var_88]
		movdqu	xmm5, xmmword ptr [esi+30h]
		pxor	xmm3, [esp+88h+var_78]
		movdqu	xmm6, xmmword ptr [esi+40h]
		pxor	xmm4, [esp+88h+var_68]
		lea	esi, [esi+50h]
		pxor	xmm5, [esp+88h+var_58]
		movdqa	[esp+88h+var_48], xmm7
		pxor	xmm6, xmm7
		call	__aesni_encrypt6
		movaps	xmm1, [esp+88h+var_48]
		xorps	xmm2, [esp+88h+var_88]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, [esp+88h+var_68]
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm5, [esp+88h+var_58]
		movups	xmmword	ptr [edi+10h], xmm3
		xorps	xmm6, xmm1
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		lea	edi, [edi+50h]
		jmp	L$054xts_enc_done
; ---------------------------------------------------------------------------
		align 10h

L$050xts_enc_one:			; CODE XREF: L$_aesni_xts_encrypt_begin+265j
		movups	xmm2, xmmword ptr [esi]
		lea	esi, [esi+10h]
		xorps	xmm2, xmm5
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$055enc1_loop_9:			; CODE XREF: L$_aesni_xts_encrypt_begin+3A2j
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$055enc1_loop_9
		aesenclast xmm2, xmm1
		xorps	xmm2, xmm5
		movups	xmmword	ptr [edi], xmm2
		lea	edi, [edi+10h]
		movdqa	xmm1, xmm5
		jmp	L$054xts_enc_done
; ---------------------------------------------------------------------------
		align 10h

L$051xts_enc_two:			; CODE XREF: L$_aesni_xts_encrypt_begin+284j
		movaps	xmm6, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		lea	esi, [esi+20h]
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		call	__aesni_encrypt2
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		lea	edi, [edi+20h]
		movdqa	xmm1, xmm6
		jmp	L$054xts_enc_done
; ---------------------------------------------------------------------------
		align 10h

L$052xts_enc_three:			; CODE XREF: L$_aesni_xts_encrypt_begin+2AAj
		movaps	xmm7, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		movups	xmm4, xmmword ptr [esi+20h]
		lea	esi, [esi+30h]
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		xorps	xmm4, xmm7
		call	__aesni_encrypt3
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		xorps	xmm4, xmm7
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		lea	edi, [edi+30h]
		movdqa	xmm1, xmm7
		jmp	L$054xts_enc_done
; ---------------------------------------------------------------------------
		align 10h

L$053xts_enc_four:			; CODE XREF: L$_aesni_xts_encrypt_begin+2D8j
		movaps	xmm6, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		movups	xmm4, xmmword ptr [esi+20h]
		xorps	xmm2, [esp+88h+var_88]
		movups	xmm5, xmmword ptr [esi+30h]
		lea	esi, [esi+40h]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, xmm7
		xorps	xmm5, xmm6
		call	__aesni_encrypt4
		xorps	xmm2, [esp+88h+var_88]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, xmm7
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm5, xmm6
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		lea	edi, [edi+40h]
		movdqa	xmm1, xmm6
		jmp	L$054xts_enc_done
; ---------------------------------------------------------------------------
		align 10h

L$049xts_enc_done6x:			; CODE XREF: L$_aesni_xts_encrypt_begin+258j
		mov	eax, [esp+88h+var_18]
		and	eax, 0Fh
		jz	L$056xts_enc_ret
		movdqa	xmm5, xmm1
		mov	[esp+88h+var_18], eax
		jmp	L$057xts_enc_steal
; ---------------------------------------------------------------------------
		align 10h

L$054xts_enc_done:			; CODE XREF: L$_aesni_xts_encrypt_begin+36Dj
					; L$_aesni_xts_encrypt_begin+3BAj ...
		mov	eax, [esp+88h+var_18]
		pxor	xmm0, xmm0
		and	eax, 0Fh
		jz	L$056xts_enc_ret
		pcmpgtd	xmm0, xmm1
		mov	[esp+88h+var_18], eax
		pshufd	xmm5, xmm0, 13h
		paddq	xmm1, xmm1
		pand	xmm5, [esp+88h+var_28]
		pxor	xmm5, xmm1

L$057xts_enc_steal:			; CODE XREF: L$_aesni_xts_encrypt_begin+4B5j
					; L$_aesni_xts_encrypt_begin+501j
		movzx	ecx, byte ptr [esi]
		movzx	edx, byte ptr [edi-10h]
		lea	esi, [esi+1]
		mov	[edi-10h], cl
		mov	[edi], dl
		lea	edi, [edi+1]
		sub	eax, 1
		jnz	L$057xts_enc_steal
		sub	edi, [esp+88h+var_18]
		mov	edx, ebp
		mov	ecx, ebx
		movups	xmm2, xmmword ptr [edi-10h]
		xorps	xmm2, xmm5
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$058enc1_loop_10:			; CODE XREF: L$_aesni_xts_encrypt_begin+52Fj
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$058enc1_loop_10
		aesenclast xmm2, xmm1
		xorps	xmm2, xmm5
		movups	xmmword	ptr [edi-10h], xmm2

L$056xts_enc_ret:			; CODE XREF: L$_aesni_xts_encrypt_begin+4A7j
					; L$_aesni_xts_encrypt_begin+4CBj
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		movdqa	[esp+88h+var_88], xmm0
		pxor	xmm3, xmm3
		movdqa	[esp+88h+var_78], xmm0
		pxor	xmm4, xmm4
		movdqa	[esp+88h+var_68], xmm0
		pxor	xmm5, xmm5
		movdqa	[esp+88h+var_58], xmm0
		pxor	xmm6, xmm6
		movdqa	[esp+88h+var_48], xmm0
		pxor	xmm7, xmm7
		movdqa	[esp+88h+var_38], xmm0
		mov	esp, [esp+88h+var_14]
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_xts_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_xts_decrypt_begin
L$_aesni_xts_decrypt_begin proc	near

var_88		= xmmword ptr -88h
var_78		= xmmword ptr -78h
var_68		= xmmword ptr -68h
var_58		= xmmword ptr -58h
var_48		= xmmword ptr -48h
var_38		= xmmword ptr -38h
var_28		= xmmword ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+10h+arg_10]
		mov	esi, [esp+10h+arg_14]
		mov	ecx, [edx+0F0h]
		movups	xmm2, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$059enc1_loop_11:			; CODE XREF: L$_aesni_xts_decrypt_begin+2Ej
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$059enc1_loop_11
		aesenclast xmm2, xmm1
		mov	esi, [esp+10h+arg_0]
		mov	edi, [esp+10h+arg_4]
		mov	eax, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_C]
		mov	ebp, esp
		sub	esp, 78h
		and	esp, 0FFFFFFF0h
		xor	ebx, ebx
		test	eax, 0Fh
		setnz	bl
		shl	ebx, 4
		sub	eax, ebx
		mov	dword ptr [esp+88h+var_28], 87h	; '‡'
		mov	dword ptr [esp+88h+var_28+4], 0
		mov	dword ptr [esp+88h+var_28+8], 1
		mov	dword ptr [esp+88h+var_28+0Ch],	0
		mov	[esp+88h+var_18], eax
		mov	[esp+88h+var_14], ebp
		mov	ecx, [edx+0F0h]
		mov	ebp, edx
		mov	ebx, ecx
		movdqa	xmm1, xmm2
		pxor	xmm0, xmm0
		movdqa	xmm3, [esp+88h+var_28]
		pcmpgtd	xmm0, xmm1
		and	eax, 0FFFFFFF0h
		sub	eax, 60h ; '`'
		jb	L$060xts_dec_short
		shl	ecx, 4
		mov	ebx, 10h
		sub	ebx, ecx
		lea	edx, [edx+ecx+20h]
		jmp	L$061xts_dec_loop6
; ---------------------------------------------------------------------------
		align 10h

L$061xts_dec_loop6:			; CODE XREF: L$_aesni_xts_decrypt_begin+BEj
					; L$_aesni_xts_decrypt_begin+255j
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_88], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_78], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_68], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	[esp+88h+var_58], xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		pshufd	xmm7, xmm0, 13h
		movdqa	[esp+88h+var_48], xmm1
		paddq	xmm1, xmm1
		movups	xmm0, xmmword ptr [ebp+0]
		pand	xmm7, xmm3
		movups	xmm2, xmmword ptr [esi]
		pxor	xmm7, xmm1
		mov	ecx, ebx
		movdqu	xmm3, xmmword ptr [esi+10h]
		xorps	xmm2, xmm0
		movdqu	xmm4, xmmword ptr [esi+20h]
		pxor	xmm3, xmm0
		movdqu	xmm5, xmmword ptr [esi+30h]
		pxor	xmm4, xmm0
		movdqu	xmm6, xmmword ptr [esi+40h]
		pxor	xmm5, xmm0
		movdqu	xmm1, xmmword ptr [esi+50h]
		pxor	xmm6, xmm0
		lea	esi, [esi+60h]
		pxor	xmm2, [esp+88h+var_88]
		movdqa	[esp+88h+var_38], xmm7
		pxor	xmm7, xmm1
		movups	xmm1, xmmword ptr [ebp+10h]
		pxor	xmm3, [esp+88h+var_78]
		pxor	xmm4, [esp+88h+var_68]
		aesdec	xmm2, xmm1
		pxor	xmm5, [esp+88h+var_58]
		pxor	xmm6, [esp+88h+var_48]
		aesdec	xmm3, xmm1
		pxor	xmm7, xmm0
		movups	xmm0, xmmword ptr [ebp+20h]
		aesdec	xmm4, xmm1
		aesdec	xmm5, xmm1
		aesdec	xmm6, xmm1
		aesdec	xmm7, xmm1
		call	L$_aesni_decrypt6_enter
		movdqa	xmm1, [esp+88h+var_38]
		pxor	xmm0, xmm0
		xorps	xmm2, [esp+88h+var_88]
		pcmpgtd	xmm0, xmm1
		xorps	xmm3, [esp+88h+var_78]
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm4, [esp+88h+var_68]
		movups	xmmword	ptr [edi+10h], xmm3
		xorps	xmm5, [esp+88h+var_58]
		movups	xmmword	ptr [edi+20h], xmm4
		xorps	xmm6, [esp+88h+var_48]
		movups	xmmword	ptr [edi+30h], xmm5
		xorps	xmm7, xmm1
		movups	xmmword	ptr [edi+40h], xmm6
		pshufd	xmm2, xmm0, 13h
		movups	xmmword	ptr [edi+50h], xmm7
		lea	edi, [edi+60h]
		movdqa	xmm3, [esp+88h+var_28]
		pxor	xmm0, xmm0
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		sub	eax, 60h ; '`'
		jnb	L$061xts_dec_loop6
		mov	ecx, [ebp+0F0h]
		mov	edx, ebp
		mov	ebx, ecx

L$060xts_dec_short:			; CODE XREF: L$_aesni_xts_decrypt_begin+AAj
		add	eax, 60h ; '`'
		jz	L$062xts_dec_done6x
		movdqa	xmm5, xmm1
		cmp	eax, 20h ; ' '
		jb	L$063xts_dec_one
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		jz	L$064xts_dec_two
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	xmm6, xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		cmp	eax, 40h ; '@'
		jb	L$065xts_dec_three
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	xmm7, xmm1
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2
		movdqa	[esp+88h+var_88], xmm5
		movdqa	[esp+88h+var_78], xmm6
		jz	L$066xts_dec_four
		movdqa	[esp+88h+var_68], xmm7
		pshufd	xmm7, xmm0, 13h
		movdqa	[esp+88h+var_58], xmm1
		paddq	xmm1, xmm1
		pand	xmm7, xmm3
		pxor	xmm7, xmm1
		movdqu	xmm2, xmmword ptr [esi]
		movdqu	xmm3, xmmword ptr [esi+10h]
		movdqu	xmm4, xmmword ptr [esi+20h]
		pxor	xmm2, [esp+88h+var_88]
		movdqu	xmm5, xmmword ptr [esi+30h]
		pxor	xmm3, [esp+88h+var_78]
		movdqu	xmm6, xmmword ptr [esi+40h]
		pxor	xmm4, [esp+88h+var_68]
		lea	esi, [esi+50h]
		pxor	xmm5, [esp+88h+var_58]
		movdqa	[esp+88h+var_48], xmm7
		pxor	xmm6, xmm7
		call	__aesni_decrypt6
		movaps	xmm1, [esp+88h+var_48]
		xorps	xmm2, [esp+88h+var_88]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, [esp+88h+var_68]
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm5, [esp+88h+var_58]
		movups	xmmword	ptr [edi+10h], xmm3
		xorps	xmm6, xmm1
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		movups	xmmword	ptr [edi+40h], xmm6
		lea	edi, [edi+50h]
		jmp	L$067xts_dec_done
; ---------------------------------------------------------------------------
		align 10h

L$063xts_dec_one:			; CODE XREF: L$_aesni_xts_decrypt_begin+275j
		movups	xmm2, xmmword ptr [esi]
		lea	esi, [esi+10h]
		xorps	xmm2, xmm5
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$068dec1_loop_12:			; CODE XREF: L$_aesni_xts_decrypt_begin+3B2j
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$068dec1_loop_12
		aesdeclast xmm2, xmm1
		xorps	xmm2, xmm5
		movups	xmmword	ptr [edi], xmm2
		lea	edi, [edi+10h]
		movdqa	xmm1, xmm5
		jmp	L$067xts_dec_done
; ---------------------------------------------------------------------------
		align 10h

L$064xts_dec_two:			; CODE XREF: L$_aesni_xts_decrypt_begin+294j
		movaps	xmm6, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		lea	esi, [esi+20h]
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		call	__aesni_decrypt2
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		lea	edi, [edi+20h]
		movdqa	xmm1, xmm6
		jmp	L$067xts_dec_done
; ---------------------------------------------------------------------------
		align 10h

L$065xts_dec_three:			; CODE XREF: L$_aesni_xts_decrypt_begin+2BAj
		movaps	xmm7, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		movups	xmm4, xmmword ptr [esi+20h]
		lea	esi, [esi+30h]
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		xorps	xmm4, xmm7
		call	__aesni_decrypt3
		xorps	xmm2, xmm5
		xorps	xmm3, xmm6
		xorps	xmm4, xmm7
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		lea	edi, [edi+30h]
		movdqa	xmm1, xmm7
		jmp	L$067xts_dec_done
; ---------------------------------------------------------------------------
		align 10h

L$066xts_dec_four:			; CODE XREF: L$_aesni_xts_decrypt_begin+2E8j
		movaps	xmm6, xmm1
		movups	xmm2, xmmword ptr [esi]
		movups	xmm3, xmmword ptr [esi+10h]
		movups	xmm4, xmmword ptr [esi+20h]
		xorps	xmm2, [esp+88h+var_88]
		movups	xmm5, xmmword ptr [esi+30h]
		lea	esi, [esi+40h]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, xmm7
		xorps	xmm5, xmm6
		call	__aesni_decrypt4
		xorps	xmm2, [esp+88h+var_88]
		xorps	xmm3, [esp+88h+var_78]
		xorps	xmm4, xmm7
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm5, xmm6
		movups	xmmword	ptr [edi+10h], xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		lea	edi, [edi+40h]
		movdqa	xmm1, xmm6
		jmp	L$067xts_dec_done
; ---------------------------------------------------------------------------
		align 10h

L$062xts_dec_done6x:			; CODE XREF: L$_aesni_xts_decrypt_begin+268j
		mov	eax, [esp+88h+var_18]
		and	eax, 0Fh
		jz	L$069xts_dec_ret
		mov	[esp+88h+var_18], eax
		jmp	L$070xts_dec_only_one_more
; ---------------------------------------------------------------------------
		align 10h

L$067xts_dec_done:			; CODE XREF: L$_aesni_xts_decrypt_begin+37Dj
					; L$_aesni_xts_decrypt_begin+3CAj ...
		mov	eax, [esp+88h+var_18]
		pxor	xmm0, xmm0
		and	eax, 0Fh
		jz	L$069xts_dec_ret
		pcmpgtd	xmm0, xmm1
		mov	[esp+88h+var_18], eax
		pshufd	xmm2, xmm0, 13h
		pxor	xmm0, xmm0
		movdqa	xmm3, [esp+88h+var_28]
		paddq	xmm1, xmm1
		pand	xmm2, xmm3
		pcmpgtd	xmm0, xmm1
		pxor	xmm1, xmm2

L$070xts_dec_only_one_more:		; CODE XREF: L$_aesni_xts_decrypt_begin+4C1j
		pshufd	xmm5, xmm0, 13h
		movdqa	xmm6, xmm1
		paddq	xmm1, xmm1
		pand	xmm5, xmm3
		pxor	xmm5, xmm1
		mov	edx, ebp
		mov	ecx, ebx
		movups	xmm2, xmmword ptr [esi]
		xorps	xmm2, xmm5
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$071dec1_loop_13:			; CODE XREF: L$_aesni_xts_decrypt_begin+540j
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$071dec1_loop_13
		aesdeclast xmm2, xmm1
		xorps	xmm2, xmm5
		movups	xmmword	ptr [edi], xmm2

L$072xts_dec_steal:			; CODE XREF: L$_aesni_xts_decrypt_begin+566j
		movzx	ecx, byte ptr [esi+10h]
		movzx	edx, byte ptr [edi]
		lea	esi, [esi+1]
		mov	[edi], cl
		mov	[edi+10h], dl
		lea	edi, [edi+1]
		sub	eax, 1
		jnz	L$072xts_dec_steal
		sub	edi, [esp+88h+var_18]
		mov	edx, ebp
		mov	ecx, ebx
		movups	xmm2, xmmword ptr [edi]
		xorps	xmm2, xmm6
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$073dec1_loop_14:			; CODE XREF: L$_aesni_xts_decrypt_begin+593j
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$073dec1_loop_14
		aesdeclast xmm2, xmm1
		xorps	xmm2, xmm6
		movups	xmmword	ptr [edi], xmm2

L$069xts_dec_ret:			; CODE XREF: L$_aesni_xts_decrypt_begin+4B7j
					; L$_aesni_xts_decrypt_begin+4DBj
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		movdqa	[esp+88h+var_88], xmm0
		pxor	xmm3, xmm3
		movdqa	[esp+88h+var_78], xmm0
		pxor	xmm4, xmm4
		movdqa	[esp+88h+var_68], xmm0
		pxor	xmm5, xmm5
		movdqa	[esp+88h+var_58], xmm0
		pxor	xmm6, xmm6
		movdqa	[esp+88h+var_48], xmm0
		pxor	xmm7, xmm7
		movdqa	[esp+88h+var_38], xmm0
		mov	esp, [esp+88h+var_14]
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_xts_decrypt_begin endp


; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_cbc_encrypt_begin
L$_aesni_cbc_encrypt_begin proc	near

var_10		= xmmword ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebp
		push	ebx
		push	esi
		push	edi
		mov	esi, [esp+10h+arg_0]
		mov	ebx, esp
		mov	edi, [esp+10h+arg_4]
		sub	ebx, 18h
		mov	eax, [esp+10h+arg_8]
		and	ebx, 0FFFFFFF0h
		mov	edx, [esp+10h+arg_C]
		mov	ebp, [esp+10h+arg_10]
		test	eax, eax
		jz	L$074cbc_abort
		cmp	[esp+10h+arg_14], 0
		xchg	ebx, esp
		movups	xmm7, xmmword ptr [ebp+0]
		mov	ecx, [edx+0F0h]
		mov	ebp, edx
		mov	[esp+10h], ebx
		mov	ebx, ecx
		jz	L$075cbc_decrypt
		movaps	xmm2, xmm7
		cmp	eax, 10h
		jb	L$076cbc_enc_tail
		sub	eax, 10h
		jmp	L$077cbc_enc_loop
; ---------------------------------------------------------------------------
		align 10h

L$077cbc_enc_loop:			; CODE XREF: L$_aesni_cbc_encrypt_begin+56j
					; L$_aesni_cbc_encrypt_begin+9Aj ...
		movups	xmm7, xmmword ptr [esi]
		lea	esi, [esi+10h]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		xorps	xmm7, xmm0
		lea	edx, [edx+20h]
		xorps	xmm2, xmm7

L$078enc1_loop_15:			; CODE XREF: L$_aesni_cbc_encrypt_begin+82j
		aesenc	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$078enc1_loop_15
		aesenclast xmm2, xmm1
		mov	ecx, ebx
		mov	edx, ebp
		movups	xmmword	ptr [edi], xmm2
		lea	edi, [edi+10h]
		sub	eax, 10h
		jnb	L$077cbc_enc_loop
		add	eax, 10h
		jnz	L$076cbc_enc_tail
		movaps	xmm7, xmm2
		pxor	xmm2, xmm2
		jmp	L$079cbc_ret
; ---------------------------------------------------------------------------

L$076cbc_enc_tail:			; CODE XREF: L$_aesni_cbc_encrypt_begin+4Dj
					; L$_aesni_cbc_encrypt_begin+A3j
		mov	ecx, eax
		mov	esi, esi
		rep movsb
		mov	ecx, 10h
		sub	ecx, eax
		xor	eax, eax
		mov	esi, esi
		rep stosb
		lea	edi, [edi-10h]
		mov	ecx, ebx
		mov	esi, edi
		mov	edx, ebp
		jmp	L$077cbc_enc_loop
; ---------------------------------------------------------------------------
		align 10h

L$075cbc_decrypt:			; CODE XREF: L$_aesni_cbc_encrypt_begin+41j
		cmp	eax, 50h ; 'P'
		jbe	L$080cbc_dec_tail
		movaps	[esp+10h+var_10], xmm7
		sub	eax, 50h ; 'P'
		jmp	L$081cbc_dec_loop6_enter
; ---------------------------------------------------------------------------
		align 10h

L$082cbc_dec_loop6:			; CODE XREF: L$_aesni_cbc_encrypt_begin+176j
		movaps	[esp+10h+var_10], xmm0
		movups	xmmword	ptr [edi], xmm7
		lea	edi, [edi+10h]

L$081cbc_dec_loop6_enter:		; CODE XREF: L$_aesni_cbc_encrypt_begin+F0j
		movdqu	xmm2, xmmword ptr [esi]
		movdqu	xmm3, xmmword ptr [esi+10h]
		movdqu	xmm4, xmmword ptr [esi+20h]
		movdqu	xmm5, xmmword ptr [esi+30h]
		movdqu	xmm6, xmmword ptr [esi+40h]
		movdqu	xmm7, xmmword ptr [esi+50h]
		call	__aesni_decrypt6
		movups	xmm1, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [esi+10h]
		xorps	xmm2, [esp+10h+var_10]
		xorps	xmm3, xmm1
		movups	xmm1, xmmword ptr [esi+20h]
		xorps	xmm4, xmm0
		movups	xmm0, xmmword ptr [esi+30h]
		xorps	xmm5, xmm1
		movups	xmm1, xmmword ptr [esi+40h]
		xorps	xmm6, xmm0
		movups	xmm0, xmmword ptr [esi+50h]
		xorps	xmm7, xmm1
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		lea	esi, [esi+60h]
		movups	xmmword	ptr [edi+20h], xmm4
		mov	ecx, ebx
		movups	xmmword	ptr [edi+30h], xmm5
		mov	edx, ebp
		movups	xmmword	ptr [edi+40h], xmm6
		lea	edi, [edi+50h]
		sub	eax, 60h ; '`'
		ja	L$082cbc_dec_loop6
		movaps	xmm2, xmm7
		movaps	xmm7, xmm0
		add	eax, 50h ; 'P'
		jle	L$083cbc_dec_clear_tail_collected
		movups	xmmword	ptr [edi], xmm2
		lea	edi, [edi+10h]

L$080cbc_dec_tail:			; CODE XREF: L$_aesni_cbc_encrypt_begin+E3j
		movups	xmm2, xmmword ptr [esi]
		movaps	xmm6, xmm2
		cmp	eax, 10h
		jbe	L$084cbc_dec_one
		movups	xmm3, xmmword ptr [esi+10h]
		movaps	xmm5, xmm3
		cmp	eax, 20h ; ' '
		jbe	L$085cbc_dec_two
		movups	xmm4, xmmword ptr [esi+20h]
		cmp	eax, 30h ; '0'
		jbe	L$086cbc_dec_three
		movups	xmm5, xmmword ptr [esi+30h]
		cmp	eax, 40h ; '@'
		jbe	L$087cbc_dec_four
		movups	xmm6, xmmword ptr [esi+40h]
		movaps	[esp+10h+var_10], xmm7
		movups	xmm2, xmmword ptr [esi]
		xorps	xmm7, xmm7
		call	__aesni_decrypt6
		movups	xmm1, xmmword ptr [esi]
		movups	xmm0, xmmword ptr [esi+10h]
		xorps	xmm2, [esp+10h+var_10]
		xorps	xmm3, xmm1
		movups	xmm1, xmmword ptr [esi+20h]
		xorps	xmm4, xmm0
		movups	xmm0, xmmword ptr [esi+30h]
		xorps	xmm5, xmm1
		movups	xmm7, xmmword ptr [esi+40h]
		xorps	xmm6, xmm0
		movups	xmmword	ptr [edi], xmm2
		movups	xmmword	ptr [edi+10h], xmm3
		pxor	xmm3, xmm3
		movups	xmmword	ptr [edi+20h], xmm4
		pxor	xmm4, xmm4
		movups	xmmword	ptr [edi+30h], xmm5
		pxor	xmm5, xmm5
		lea	edi, [edi+40h]
		movaps	xmm2, xmm6
		pxor	xmm6, xmm6
		sub	eax, 50h ; 'P'
		jmp	L$088cbc_dec_tail_collected
; ---------------------------------------------------------------------------
		align 10h

L$084cbc_dec_one:			; CODE XREF: L$_aesni_cbc_encrypt_begin+19Aj
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [edx+10h]
		lea	edx, [edx+20h]
		xorps	xmm2, xmm0

L$089dec1_loop_16:			; CODE XREF: L$_aesni_cbc_encrypt_begin+249j
		aesdec	xmm2, xmm1
		dec	ecx
		movups	xmm1, xmmword ptr [edx]
		lea	edx, [edx+10h]
		jnz	L$089dec1_loop_16
		aesdeclast xmm2, xmm1
		xorps	xmm2, xmm7
		movaps	xmm7, xmm6
		sub	eax, 10h
		jmp	L$088cbc_dec_tail_collected
; ---------------------------------------------------------------------------
		align 10h

L$085cbc_dec_two:			; CODE XREF: L$_aesni_cbc_encrypt_begin+1AAj
		call	__aesni_decrypt2
		xorps	xmm2, xmm7
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		movaps	xmm2, xmm3
		pxor	xmm3, xmm3
		lea	edi, [edi+10h]
		movaps	xmm7, xmm5
		sub	eax, 20h ; ' '
		jmp	L$088cbc_dec_tail_collected
; ---------------------------------------------------------------------------
		align 10h

L$086cbc_dec_three:			; CODE XREF: L$_aesni_cbc_encrypt_begin+1B7j
		call	__aesni_decrypt3
		xorps	xmm2, xmm7
		xorps	xmm3, xmm6
		xorps	xmm4, xmm5
		movups	xmmword	ptr [edi], xmm2
		movaps	xmm2, xmm4
		pxor	xmm4, xmm4
		movups	xmmword	ptr [edi+10h], xmm3
		pxor	xmm3, xmm3
		lea	edi, [edi+20h]
		movups	xmm7, xmmword ptr [esi+20h]
		sub	eax, 30h ; '0'
		jmp	L$088cbc_dec_tail_collected
; ---------------------------------------------------------------------------
		align 10h

L$087cbc_dec_four:			; CODE XREF: L$_aesni_cbc_encrypt_begin+1C4j
		call	__aesni_decrypt4
		movups	xmm1, xmmword ptr [esi+10h]
		movups	xmm0, xmmword ptr [esi+20h]
		xorps	xmm2, xmm7
		movups	xmm7, xmmword ptr [esi+30h]
		xorps	xmm3, xmm6
		movups	xmmword	ptr [edi], xmm2
		xorps	xmm4, xmm1
		movups	xmmword	ptr [edi+10h], xmm3
		pxor	xmm3, xmm3
		xorps	xmm5, xmm0
		movups	xmmword	ptr [edi+20h], xmm4
		pxor	xmm4, xmm4
		lea	edi, [edi+30h]
		movaps	xmm2, xmm5
		pxor	xmm5, xmm5
		sub	eax, 40h ; '@'
		jmp	L$088cbc_dec_tail_collected
; ---------------------------------------------------------------------------
		align 10h

L$083cbc_dec_clear_tail_collected:	; CODE XREF: L$_aesni_cbc_encrypt_begin+185j
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		pxor	xmm5, xmm5
		pxor	xmm6, xmm6

L$088cbc_dec_tail_collected:		; CODE XREF: L$_aesni_cbc_encrypt_begin+228j
					; L$_aesni_cbc_encrypt_begin+25Dj ...
		and	eax, 0Fh
		jnz	L$090cbc_dec_tail_partial
		movups	xmmword	ptr [edi], xmm2
		pxor	xmm0, xmm0
		jmp	L$079cbc_ret
; ---------------------------------------------------------------------------
		align 10h

L$090cbc_dec_tail_partial:		; CODE XREF: L$_aesni_cbc_encrypt_begin+333j
		movaps	[esp+10h+var_10], xmm2
		pxor	xmm0, xmm0
		mov	ecx, 10h
		mov	esi, esp
		sub	ecx, eax
		mov	esi, esi
		rep movsb
		movdqa	[esp+10h+var_10], xmm2

L$079cbc_ret:				; CODE XREF: L$_aesni_cbc_encrypt_begin+B0j
					; L$_aesni_cbc_encrypt_begin+340j
		mov	esp, [esp+10h]
		mov	ebp, [esp+10h+arg_10]
		pxor	xmm2, xmm2
		pxor	xmm1, xmm1
		movups	xmmword	ptr [ebp+0], xmm7
		pxor	xmm7, xmm7

L$074cbc_abort:				; CODE XREF: L$_aesni_cbc_encrypt_begin+22j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
L$_aesni_cbc_encrypt_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


__aesni_set_encrypt_key	proc near	; CODE XREF: L$_aesni_set_encrypt_key_begin+Cp
					; L$_aesni_set_decrypt_key_begin+Cp

; FUNCTION CHUNK AT 00001F50 SIZE 000000DA BYTES
; FUNCTION CHUNK AT 00002030 SIZE 0000007D BYTES
; FUNCTION CHUNK AT 00002120 SIZE 0000013C BYTES
; FUNCTION CHUNK AT 000022A0 SIZE 000000D4 BYTES

		push	ebp
		push	ebx
		test	eax, eax
		jz	L$091bad_pointer
		test	edx, edx
		jz	L$091bad_pointer
		call	$+5

L$092pic:				; DATA XREF: __aesni_set_encrypt_key:L$09710rounds_altr
					; __aesni_set_encrypt_key:L$10814rounds_altr
		pop	ebx
		lea	ebx, (L$key_const - 1E57h)[ebx]
		lea	ebp, _OPENSSL_ia32cap_P
		movups	xmm0, xmmword ptr [eax]

loc_1E67:				; DATA XREF: __aesni_set_encrypt_key:L$10212rounds_altr
		xorps	xmm4, xmm4
		mov	ebp, [ebp+4]
		lea	edx, [edx+10h]
		and	ebp, 10000800h
		cmp	ecx, 100h	; DATA XREF: __aesni_set_encrypt_key+119r
					; __aesni_set_encrypt_key+2E5r	...
		jz	L$09314rounds
		cmp	ecx, 0C0h ; 'À' ; DATA XREF: __aesni_set_encrypt_key+16Cr
		jz	L$09412rounds
		cmp	ecx, 80h ; '€'
		jnz	L$095bad_keybits
		nop
		nop
		nop
		nop
		nop
		nop

L$09610rounds:
		cmp	ebp, 10000000h
		jz	L$09710rounds_alt
		mov	ecx, 9
		movups	xmmword	ptr [edx-10h], xmm0
		aeskeygenassist	xmm1, xmm0, 1
		call	L$098key_128_cold
		aeskeygenassist	xmm1, xmm0, 2
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 4
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 8
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 10h
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 20h
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 40h
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 80h
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 1Bh
		call	L$099key_128
		aeskeygenassist	xmm1, xmm0, 36h
		call	L$099key_128
		movups	xmmword	ptr [edx], xmm0
		mov	[edx+50h], ecx
		jmp	L$100good_key
__aesni_set_encrypt_key	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


L$099key_128	proc near		; CODE XREF: __aesni_set_encrypt_key+86p
					; __aesni_set_encrypt_key+91p ...
		movups	xmmword	ptr [edx], xmm0
		lea	edx, [edx+10h]
L$099key_128	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


L$098key_128_cold proc near		; CODE XREF: __aesni_set_encrypt_key+7Bp
		shufps	xmm4, xmm0, 10h
		xorps	xmm0, xmm4
		shufps	xmm4, xmm0, 8Ch
		xorps	xmm0, xmm4
		shufps	xmm1, xmm1, 0FFh
		xorps	xmm0, xmm1
		retn
L$098key_128_cold endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR __aesni_set_encrypt_key

L$09710rounds_alt:			; CODE XREF: __aesni_set_encrypt_key+66j
		movdqa	xmm5, xmmword ptr ds:(L$092pic - 1E57h)[ebx]
		mov	ecx, 8
		movdqa	xmm4, xmmword ptr ds:(loc_1E76+1 - 1E57h)[ebx]
		movdqa	xmm2, xmm0
		movdqu	xmmword	ptr [edx-10h], xmm0

L$101loop_key128:			; CODE XREF: __aesni_set_encrypt_key+166j
		pshufb	xmm0, xmm5
		aesenclast xmm0, xmm4
		pslld	xmm4, 1
		lea	edx, [edx+10h]
		movdqa	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm2, xmm3
		pxor	xmm0, xmm2
		movdqu	xmmword	ptr [edx-10h], xmm0
		movdqa	xmm2, xmm0
		dec	ecx
		jnz	L$101loop_key128
		movdqa	xmm4, xmmword ptr ds:(loc_1E82+5 - 1E57h)[ebx]
		pshufb	xmm0, xmm5
		aesenclast xmm0, xmm4
		pslld	xmm4, 1
		movdqa	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm2, xmm3
		pxor	xmm0, xmm2
		movdqu	xmmword	ptr [edx], xmm0
		movdqa	xmm2, xmm0
		pshufb	xmm0, xmm5
		aesenclast xmm0, xmm4
		movdqa	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm3, xmm2
		pslldq	xmm2, 4
		pxor	xmm2, xmm3
		pxor	xmm0, xmm2
		movdqu	xmmword	ptr [edx+10h], xmm0
		mov	ecx, 9
		mov	[edx+60h], ecx
		jmp	L$100good_key
; END OF FUNCTION CHUNK	FOR __aesni_set_encrypt_key
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR __aesni_set_encrypt_key

L$09412rounds:				; CODE XREF: __aesni_set_encrypt_key+48j
		movq	xmm2, qword ptr	[eax+10h]
		cmp	ebp, 10000000h
		jz	L$10212rounds_alt
		mov	ecx, 0Bh
		movups	xmmword	ptr [edx-10h], xmm0
		aeskeygenassist	xmm1, xmm2, 1
		call	L$103key_192a_cold
		aeskeygenassist	xmm1, xmm2, 2
		call	L$104key_192b
		aeskeygenassist	xmm1, xmm2, 4
		call	L$105key_192a
		aeskeygenassist	xmm1, xmm2, 8
		call	L$104key_192b
		aeskeygenassist	xmm1, xmm2, 10h
		call	L$105key_192a
		aeskeygenassist	xmm1, xmm2, 20h
		call	L$104key_192b
		aeskeygenassist	xmm1, xmm2, 40h
		call	L$105key_192a
		aeskeygenassist	xmm1, xmm2, 80h
		call	L$104key_192b
		movups	xmmword	ptr [edx], xmm0
		mov	[edx+30h], ecx
		jmp	L$100good_key
; END OF FUNCTION CHUNK	FOR __aesni_set_encrypt_key
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


L$105key_192a	proc near		; CODE XREF: __aesni_set_encrypt_key+226p
					; __aesni_set_encrypt_key+23Cp	...
		movups	xmmword	ptr [edx], xmm0
		lea	edx, [edx+10h]
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
L$105key_192a	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


L$103key_192a_cold proc	near		; CODE XREF: __aesni_set_encrypt_key+210p
		movaps	xmm5, xmm2

L$106key_192b_warm:			; CODE XREF: L$104key_192b+15j
		shufps	xmm4, xmm0, 10h
		movdqa	xmm3, xmm2
		xorps	xmm0, xmm4
		shufps	xmm4, xmm0, 8Ch
		pslldq	xmm3, 4
		xorps	xmm0, xmm4
		pshufd	xmm1, xmm1, 55h
		pxor	xmm2, xmm3
		pxor	xmm0, xmm1
		pshufd	xmm3, xmm0, 0FFh
		pxor	xmm2, xmm3
		retn
L$103key_192a_cold endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


L$104key_192b	proc near		; CODE XREF: __aesni_set_encrypt_key+21Bp
					; __aesni_set_encrypt_key+231p	...
		movaps	xmm3, xmm0
		shufps	xmm5, xmm0, 44h
		movups	xmmword	ptr [edx], xmm5
		shufps	xmm3, xmm2, 4Eh
		movups	xmmword	ptr [edx+10h], xmm3
		lea	edx, [edx+20h]
		jmp	L$106key_192b_warm
L$104key_192b	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR __aesni_set_encrypt_key

L$10212rounds_alt:			; CODE XREF: __aesni_set_encrypt_key+1FBj
		movdqa	xmm5, xmmword ptr ds:(loc_1E67 - 1E57h)[ebx]
		movdqa	xmm4, xmmword ptr ds:(loc_1E76+1 - 1E57h)[ebx]
		mov	ecx, 8
		movdqu	xmmword	ptr [edx-10h], xmm0

L$107loop_key192:			; CODE XREF: __aesni_set_encrypt_key+34Dj
		movq	qword ptr [edx], xmm2
		movdqa	xmm1, xmm2
		pshufb	xmm2, xmm5
		aesenclast xmm2, xmm4
		pslld	xmm4, 1
		lea	edx, [edx+18h]
		movdqa	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm0, xmm3
		pshufd	xmm3, xmm0, 0FFh
		pxor	xmm3, xmm1
		pslldq	xmm1, 4
		pxor	xmm3, xmm1
		pxor	xmm0, xmm2
		pxor	xmm2, xmm3
		movdqu	xmmword	ptr [edx-10h], xmm0
		dec	ecx
		jnz	L$107loop_key192
		mov	ecx, 0Bh
		mov	[edx+20h], ecx
		jmp	L$100good_key
; ---------------------------------------------------------------------------

L$09314rounds:				; CODE XREF: __aesni_set_encrypt_key+3Cj
		movups	xmm2, xmmword ptr [eax+10h]
		lea	edx, [edx+10h]
		cmp	ebp, 10000000h
		jz	L$10814rounds_alt
		mov	ecx, 0Dh
		movups	xmmword	ptr [edx-20h], xmm0
		movups	xmmword	ptr [edx-10h], xmm2
		aeskeygenassist	xmm1, xmm2, 1
		call	L$109key_256a_cold
		aeskeygenassist	xmm1, xmm0, 1
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 2
		call	L$111key_256a
		aeskeygenassist	xmm1, xmm0, 2
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 4
		call	L$111key_256a
		aeskeygenassist	xmm1, xmm0, 4
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 8
		call	L$111key_256a
		aeskeygenassist	xmm1, xmm0, 8
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 10h
		call	L$111key_256a
		aeskeygenassist	xmm1, xmm0, 10h
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 20h
		call	L$111key_256a
		aeskeygenassist	xmm1, xmm0, 20h
		call	L$110key_256b
		aeskeygenassist	xmm1, xmm2, 40h
		call	L$111key_256a
		movups	xmmword	ptr [edx], xmm0
		mov	[edx+10h], ecx
		xor	eax, eax
		jmp	L$100good_key
; END OF FUNCTION CHUNK	FOR __aesni_set_encrypt_key
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


L$111key_256a	proc near		; CODE XREF: __aesni_set_encrypt_key+39Cp
					; __aesni_set_encrypt_key+3B2p	...
		movups	xmmword	ptr [edx], xmm2
		lea	edx, [edx+10h]
L$111key_256a	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


L$109key_256a_cold proc	near		; CODE XREF: __aesni_set_encrypt_key+386p
		shufps	xmm4, xmm0, 10h
		xorps	xmm0, xmm4
		shufps	xmm4, xmm0, 8Ch
		xorps	xmm0, xmm4
		shufps	xmm1, xmm1, 0FFh
		xorps	xmm0, xmm1
		retn
L$109key_256a_cold endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


L$110key_256b	proc near		; CODE XREF: __aesni_set_encrypt_key+391p
					; __aesni_set_encrypt_key+3A7p	...
		movups	xmmword	ptr [edx], xmm0
		lea	edx, [edx+10h]
		shufps	xmm4, xmm2, 10h
		xorps	xmm2, xmm4
		shufps	xmm4, xmm2, 8Ch
		xorps	xmm2, xmm4
		shufps	xmm1, xmm1, 0AAh
		xorps	xmm2, xmm1
		retn
L$110key_256b	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR __aesni_set_encrypt_key

L$10814rounds_alt:			; CODE XREF: __aesni_set_encrypt_key+36Dj
		movdqa	xmm5, xmmword ptr ds:(L$092pic - 1E57h)[ebx]
		movdqa	xmm4, xmmword ptr ds:(loc_1E76+1 - 1E57h)[ebx]
		mov	ecx, 7
		movdqu	xmmword	ptr [edx-20h], xmm0
		movdqa	xmm1, xmm2
		movdqu	xmmword	ptr [edx-10h], xmm2

L$112loop_key256:			; CODE XREF: __aesni_set_encrypt_key+4F6j
		pshufb	xmm2, xmm5
		aesenclast xmm2, xmm4
		movdqa	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm3, xmm0
		pslldq	xmm0, 4
		pxor	xmm0, xmm3
		pslld	xmm4, 1
		pxor	xmm0, xmm2
		movdqu	xmmword	ptr [edx], xmm0
		dec	ecx
		jz	L$113done_key256
		pshufd	xmm2, xmm0, 0FFh
		pxor	xmm3, xmm3
		aesenclast xmm2, xmm3
		movdqa	xmm3, xmm1
		pslldq	xmm1, 4
		pxor	xmm3, xmm1
		pslldq	xmm1, 4
		pxor	xmm3, xmm1
		pslldq	xmm1, 4
		pxor	xmm1, xmm3
		pxor	xmm2, xmm1
		movdqu	xmmword	ptr [edx+10h], xmm2
		lea	edx, [edx+20h]
		movdqa	xmm1, xmm2
		jmp	L$112loop_key256
; ---------------------------------------------------------------------------

L$113done_key256:			; CODE XREF: __aesni_set_encrypt_key+4B3j
		mov	ecx, 0Dh
		mov	[edx+10h], ecx

L$100good_key:				; CODE XREF: __aesni_set_encrypt_key+E9j
					; __aesni_set_encrypt_key+1E5j	...
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		pxor	xmm2, xmm2
		pxor	xmm3, xmm3
		pxor	xmm4, xmm4
		pxor	xmm5, xmm5
		xor	eax, eax
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

L$091bad_pointer:			; CODE XREF: __aesni_set_encrypt_key+4j
					; __aesni_set_encrypt_key+Cj
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

L$095bad_keybits:			; CODE XREF: __aesni_set_encrypt_key+54j
		pxor	xmm0, xmm0
		mov	eax, 0FFFFFFFEh
		pop	ebx
		pop	ebp
		retn
; END OF FUNCTION CHUNK	FOR __aesni_set_encrypt_key
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_set_encrypt_key_begin
L$_aesni_set_encrypt_key_begin proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		call	__aesni_set_encrypt_key
		retn
L$_aesni_set_encrypt_key_begin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public L$_aesni_set_decrypt_key_begin
L$_aesni_set_decrypt_key_begin proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		call	__aesni_set_encrypt_key
		mov	edx, [esp+arg_8]
		shl	ecx, 4
		test	eax, eax
		jnz	L$114dec_key_ret
		lea	eax, [edx+ecx+10h]
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [eax]
		movups	xmmword	ptr [eax], xmm0
		movups	xmmword	ptr [edx], xmm1
		lea	edx, [edx+10h]
		lea	eax, [eax-10h]

L$115dec_key_inverse:			; CODE XREF: L$_aesni_set_decrypt_key_begin+56j
		movups	xmm0, xmmword ptr [edx]
		movups	xmm1, xmmword ptr [eax]
		aesimc	xmm0, xmm0
		aesimc	xmm1, xmm1
		lea	edx, [edx+10h]
		lea	eax, [eax-10h]
		movups	xmmword	ptr [eax+10h], xmm0
		movups	xmmword	ptr [edx-10h], xmm1
		cmp	eax, edx
		ja	L$115dec_key_inverse
		movups	xmm0, xmmword ptr [edx]
		aesimc	xmm0, xmm0
		movups	xmmword	ptr [edx], xmm0
		pxor	xmm0, xmm0
		pxor	xmm1, xmm1
		xor	eax, eax

L$114dec_key_ret:			; CODE XREF: L$_aesni_set_decrypt_key_begin+1Aj
		retn
L$_aesni_set_decrypt_key_begin endp

; ---------------------------------------------------------------------------
		align 40h
L$key_const	dd 4 dup(0C0F0E0Dh), 4 dup(4070605h), 4	dup(1),	4 dup(1Bh)
					; DATA XREF: __aesni_set_encrypt_key+18o
aAesForIntelAes	db 'AES for Intel AES-NI, CRYPTOGAMS by <appro@openssl.org>',0
_text		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
_bss		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _OPENSSL_ia32cap_P:near ;	DATA XREF: __aesni_set_encrypt_key+1Eo


		end
