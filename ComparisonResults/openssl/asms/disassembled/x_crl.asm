;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	CFABF5049C7CE946DC8CBD6397D71AB7
; Input	CRC32 :	543BE208

; File Name   :	C:\compspace\Diff\openssl\obj\x_crl.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REVOKED_it
_X509_REVOKED_it proc near		; DATA XREF: .rdata:000000F4o
		mov	eax, offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		retn
_X509_REVOKED_it endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_INFO_it
_X509_CRL_INFO_it proc near		; DATA XREF: .rdata:00000150o
		mov	eax, offset ?local_it@?1??X509_CRL_INFO_it@@9@9	; `X509_CRL_INFO_it'::`2'::local_it
		retn
_X509_CRL_INFO_it endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 10h
_X509_REVOKED_seq_tt dd	3 dup(0)	; DATA XREF: .rdata:00000054o
		dd offset ??_C@_0N@OMOHFKCJ@serialNumber?$AA@ ;	"serialNumber"
		dd offset _ASN1_INTEGER_it
dword_24	dd 2 dup(0)		; DATA XREF: .rdata:00000120o
		dd 4
		dd offset ??_C@_0P@HBDMPDNI@revocationDate?$AA@	; "revocationDate"
		dd offset _ASN1_TIME_it
		dd 5, 0
		dd 8
		dd offset ??_C@_0L@ICCCPLKC@extensions?$AA@ ; "extensions"
		dd offset _X509_EXTENSION_it
; `X509_REVOKED_it'::`2'::local_it
?local_it@?1??X509_REVOKED_it@@9@9 dd 1, 10h ; DATA XREF: _X509_REVOKED_ito
					; .rdata:00000190o ...
		dd offset _X509_REVOKED_seq_tt
		dd 3, 0
		dd 18h
		dd offset ??_C@_0N@JBPKOADN@X509_REVOKED?$AA@ ;	"X509_REVOKED"
_X509_CRL_INFO_aux dd 0			; DATA XREF: .rdata:0000011Co
		dd 2, 2	dup(0)
		dd offset _crl_inf_cb
		dd 1Ch
_X509_CRL_INFO_seq_tt dd 1, 2 dup(0)	; DATA XREF: .rdata:00000114o
		dd offset ??_C@_07CPCPJPKL@version?$AA@	; "version"
		dd offset _ASN1_INTEGER_it
dword_94	dd 2 dup(0)		; DATA XREF: .rdata:000000F8o
		dd 4
		dd offset ??_C@_07OBHFIHGJ@sig_alg?$AA@	; "sig_alg"
		dd offset _X509_ALGOR_it
		align 10h
		dd 8
		dd offset ??_C@_06EAINIONG@issuer?$AA@ ; "issuer"
		dd offset _X509_NAME_it
		dd 2 dup(0)
		dd 0Ch
		dd offset ??_C@_0L@MPDCJAIM@lastUpdate?$AA@ ; "lastUpdate"
		dd offset _ASN1_TIME_it
		dd 1, 0
		dd 10h
		dd offset ??_C@_0L@BMOABHOK@nextUpdate?$AA@ ; "nextUpdate"
		dd offset _ASN1_TIME_it
		dd 5, 0
		dd 14h
		dd offset ??_C@_07MIJFAMBD@revoked?$AA@	; "revoked"
		dd offset _X509_REVOKED_it
		dd offset dword_94+1
		align 10h
		dd 18h
		dd offset ??_C@_0L@ICCCPLKC@extensions?$AA@ ; "extensions"
		dd offset _X509_EXTENSION_it
; `X509_CRL_INFO_it'::`2'::local_it
?local_it@?1??X509_CRL_INFO_it@@9@9 dd 1, 10h ;	DATA XREF: _X509_CRL_INFO_ito
					; _def_crl_verify+10o ...
		dd offset _X509_CRL_INFO_seq_tt
		dd 7
		dd offset _X509_CRL_INFO_aux
		dd offset dword_24+4
		dd offset ??_C@_0O@IMOAEKCP@X509_CRL_INFO?$AA@ ; "X509_CRL_INFO"
_X509_CRL_aux	dd 0			; DATA XREF: .rdata:0000018Co
		dd 1, 0Ch, 6
		dd offset _crl_cb
		align 10h
_X509_CRL_seq_tt dd 3 dup(0)		; DATA XREF: .rdata:00000184o
		dd offset ??_C@_03GJBFOAJL@crl?$AA@ ; `string'
		dd offset _X509_CRL_INFO_it
		dd 2 dup(0)
		dd 4
		dd offset ??_C@_07OBHFIHGJ@sig_alg?$AA@	; "sig_alg"
		dd offset _X509_ALGOR_it
		align 10h
		dd 8
		dd offset ??_C@_09CMIIOJHF@signature?$AA@ ; "signature"
		dd offset _ASN1_BIT_STRING_it
; `X509_CRL_it'::`2'::local_it
?local_it@?1??X509_CRL_it@@9@9 dd 1, 10h ; DATA	XREF: _X509_CRL_dup+4o
					; _X509_CRL_freeo ...
		dd offset _X509_CRL_seq_tt
		dd 3
		dd offset _X509_CRL_aux
		dd offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		dd offset ??_C@_08JGFBPDAP@X509_CRL?$AA@ ; "X509_CRL"
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 198h
; COMDAT (pick any)
		public ??_C@_0N@OMOHFKCJ@serialNumber?$AA@
; `string'
??_C@_0N@OMOHFKCJ@serialNumber?$AA@ db 'serialNumber',0 ; DATA XREF: .rdata:0000001Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1A8h
; COMDAT (pick any)
		public ??_C@_0P@HBDMPDNI@revocationDate?$AA@
; `string'
??_C@_0P@HBDMPDNI@revocationDate?$AA@ db 'revocationDate',0 ; DATA XREF: .rdata:00000030o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B8h
; COMDAT (pick any)
		public ??_C@_0L@ICCCPLKC@extensions?$AA@
; `string'
??_C@_0L@ICCCPLKC@extensions?$AA@ db 'extensions',0 ; DATA XREF: .rdata:00000044o
					; .rdata:00000104o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1C4h
; COMDAT (pick any)
		public ??_C@_0N@JBPKOADN@X509_REVOKED?$AA@
; `string'
??_C@_0N@JBPKOADN@X509_REVOKED?$AA@ db 'X509_REVOKED',0 ; DATA XREF: .rdata:00000064o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_def_crl_verify	proc near		; DATA XREF: .data:00000378o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		push	dword ptr [eax+4]
		push	offset ?local_it@?1??X509_CRL_INFO_it@@9@9 ; `X509_CRL_INFO_it'::`2'::local_it
		call	_ASN1_item_verify
		add	esp, 14h
		retn
_def_crl_verify	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_def_crl_lookup	proc near		; DATA XREF: .data:00000374o

var_18		= dword	ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 18h
		call	__chkstk
		mov	eax, [esp+18h+arg_8]
		push	ebx
		mov	ebx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_18], eax
		push	ebp
		mov	eax, [ebx]
		push	dword ptr [eax+14h]
		call	_sk_is_sorted
		add	esp, 4
		test	eax, eax
		jnz	short loc_250
		push	1BAh
		push	offset ??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@ ; ".\\crypto\\asn1\\x_crl.c"
		push	6
		push	9
		call	_CRYPTO_lock
		mov	eax, [ebx]
		push	dword ptr [eax+14h]
		call	_sk_sort
		push	1BCh
		push	offset ??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@ ; ".\\crypto\\asn1\\x_crl.c"
		push	6
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 24h

loc_250:				; CODE XREF: _def_crl_lookup+27j
		lea	eax, [esp+20h+var_18]
		push	eax
		mov	eax, [ebx]
		push	dword ptr [eax+14h]
		call	_sk_find
		mov	ebp, eax
		add	esp, 8
		mov	[esp+20h+arg_0], ebp
		test	ebp, ebp
		jns	short loc_274
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_274:				; CODE XREF: _def_crl_lookup+76j
		mov	eax, [ebx]
		push	esi
		push	edi
		push	dword ptr [eax+14h]
		call	_sk_num
		add	esp, 4
		cmp	ebp, eax
		jge	loc_35D
		mov	esi, [esp+28h+arg_C]
		nop	dword ptr [eax+eax+00h]

loc_294:				; CODE XREF: _def_crl_lookup+163j
		mov	eax, [ebx]
		push	ebp
		push	dword ptr [eax+14h]
		call	_sk_value
		push	[esp+30h+arg_8]
		mov	edi, eax
		push	dword ptr [edi]
		call	_ASN1_INTEGER_cmp
		add	esp, 10h
		test	eax, eax
		jnz	loc_35D
		mov	ecx, [edi+0Ch]
		mov	ebp, esi
		test	ecx, ecx
		jnz	short loc_2F2
		test	esi, esi
		jz	short loc_2D6
		mov	eax, [ebx]
		push	dword ptr [eax+8]
		push	esi
		call	_X509_NAME_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_33F

loc_2D6:				; CODE XREF: _def_crl_lookup+CEj
					; _def_crl_lookup+135j
		mov	eax, [esp+28h+arg_4]
		test	eax, eax
		jz	short loc_2E0
		mov	[eax], edi

loc_2E0:				; CODE XREF: _def_crl_lookup+E8j
		xor	eax, eax
		cmp	dword ptr [edi+10h], 8
		pop	edi
		pop	esi
		setz	al
		pop	ebp
		inc	eax
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_2F2:				; CODE XREF: _def_crl_lookup+CAj
		test	esi, esi
		jnz	short loc_2FB
		mov	eax, [ebx]
		mov	ebp, [eax+8]

loc_2FB:				; CODE XREF: _def_crl_lookup+100j
		push	ecx
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_33B

loc_30A:				; CODE XREF: _def_crl_lookup+145j
		push	esi
		push	dword ptr [edi+0Ch]
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax], 4
		jnz	short loc_32B
		push	dword ptr [eax+4]
		push	ebp
		call	_X509_NAME_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_2D6

loc_32B:				; CODE XREF: _def_crl_lookup+125j
		push	dword ptr [edi+0Ch]
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_30A

loc_33B:				; CODE XREF: _def_crl_lookup+114j
		mov	esi, [esp+28h+arg_C]

loc_33F:				; CODE XREF: _def_crl_lookup+E0j
		mov	eax, [ebx]
		mov	ebp, [esp+28h+arg_0]
		inc	ebp
		mov	[esp+28h+arg_0], ebp
		push	dword ptr [eax+14h]
		call	_sk_num
		add	esp, 4
		cmp	ebp, eax
		jl	loc_294

loc_35D:				; CODE XREF: _def_crl_lookup+91j
					; _def_crl_lookup+BDj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
_def_crl_lookup	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 368h
_int_crl_meth	dd 3 dup(0)		; DATA XREF: .data:_default_crl_methodo
					; _X509_CRL_set_default_method+4o
		dd offset _def_crl_lookup
		dd offset _def_crl_verify
_default_crl_method dd offset _int_crl_meth ; DATA XREF: _crl_cb:loc_585r
					; _X509_CRL_set_default_method+Ew
_data		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 380h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_crl_inf_cb	proc near		; DATA XREF: .rdata:00000078o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_3A6
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_3A6
		cmp	[esp+arg_0], 5
		jnz	short loc_3A6
		push	offset _X509_REVOKED_cmp
		push	eax
		call	_sk_set_cmp_func
		add	esp, 8

loc_3A6:				; CODE XREF: _crl_inf_cb+8j
					; _crl_inf_cb+Fj ...
		mov	eax, 1
		retn
_crl_inf_cb	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3ACh
; COMDAT (pick any)
		public ??_C@_07CPCPJPKL@version?$AA@
; `string'
??_C@_07CPCPJPKL@version?$AA@ db 'version',0 ; DATA XREF: .rdata:0000008Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3B4h
; COMDAT (pick any)
		public ??_C@_07OBHFIHGJ@sig_alg?$AA@
; `string'
??_C@_07OBHFIHGJ@sig_alg?$AA@ db 'sig_alg',0 ; DATA XREF: .rdata:000000A0o
					; .rdata:00000160o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3BCh
; COMDAT (pick any)
		public ??_C@_06EAINIONG@issuer?$AA@
; `string'
??_C@_06EAINIONG@issuer?$AA@ db	'issuer',0 ; DATA XREF: .rdata:000000B4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3C4h
; COMDAT (pick any)
		public ??_C@_0L@MPDCJAIM@lastUpdate?$AA@
; `string'
??_C@_0L@MPDCJAIM@lastUpdate?$AA@ db 'lastUpdate',0 ; DATA XREF: .rdata:000000C8o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3D0h
; COMDAT (pick any)
		public ??_C@_0L@BMOABHOK@nextUpdate?$AA@
; `string'
??_C@_0L@BMOABHOK@nextUpdate?$AA@ db 'nextUpdate',0 ; DATA XREF: .rdata:000000DCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3DCh
; COMDAT (pick any)
		public ??_C@_07MIJFAMBD@revoked?$AA@
; `string'
??_C@_07MIJFAMBD@revoked?$AA@ db 'revoked',0 ; DATA XREF: .rdata:000000F0o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3E4h
; COMDAT (pick any)
		public ??_C@_0O@IMOAEKCP@X509_CRL_INFO?$AA@
; `string'
??_C@_0O@IMOAEKCP@X509_CRL_INFO?$AA@ db	'X509_CRL_INFO',0 ; DATA XREF: .rdata:00000124o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_crl_cb		proc near		; DATA XREF: .rdata:00000138o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [eax]
		mov	eax, [esp+4+arg_0]
		sub	eax, 1
		jz	loc_585
		sub	eax, 2
		jz	loc_52A
		sub	eax, 2
		jnz	loc_5CC
		push	eax
		lea	eax, [esi+2Ch]
		push	eax
		call	_EVP_sha1
		push	eax
		push	esi
		call	_X509_CRL_digest
		push	0
		push	0
		push	302h
		push	esi
		call	_X509_CRL_get_ext_d2i
		add	esp, 20h
		mov	[esi+18h], eax
		test	eax, eax
		jz	short loc_44E
		push	eax
		push	esi
		call	_setup_idp
		add	esp, 8

loc_44E:				; CODE XREF: _crl_cb+4Ej
		push	0
		push	0
		push	5Ah ; 'Z'
		push	esi
		call	_X509_CRL_get_ext_d2i
		push	0
		push	0
		push	58h ; 'X'
		push	esi
		mov	[esi+14h], eax
		call	_X509_CRL_get_ext_d2i
		push	0
		push	0
		push	8Ch ; 'å'
		push	esi
		mov	[esi+24h], eax
		call	_X509_CRL_get_ext_d2i
		add	esp, 30h
		mov	[esi+28h], eax
		test	eax, eax
		jz	short loc_492
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_492
		or	dword ptr [esi+10h], 80h

loc_492:				; CODE XREF: _crl_cb+8Fj _crl_cb+95j
		mov	eax, [esi]
		push	ebp
		push	edi
		xor	edi, edi
		mov	ebp, [eax+18h]
		push	ebp
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_4FB
		push	ebx

loc_4A9:				; CODE XREF: _crl_cb+E8j
		push	edi
		push	ebp
		call	_sk_value
		mov	ebx, eax
		push	dword ptr [ebx]
		call	_OBJ_obj2nid
		add	esp, 0Ch
		cmp	eax, 359h
		jnz	short loc_4CA
		or	dword ptr [esi+10h], 1000h

loc_4CA:				; CODE XREF: _crl_cb+CDj
		cmp	dword ptr [ebx+4], 0
		jg	short loc_4E0
		push	ebp
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_4A9
		jmp	short loc_4FA
; ---------------------------------------------------------------------------

loc_4E0:				; CODE XREF: _crl_cb+DAj
		cmp	eax, 302h
		jz	short loc_4FA
		cmp	eax, 5Ah ; 'Z'
		jz	short loc_4FA
		cmp	eax, 8Ch ; 'å'
		jz	short loc_4FA
		or	dword ptr [esi+10h], 200h

loc_4FA:				; CODE XREF: _crl_cb+EAj _crl_cb+F1j ...
		pop	ebx

loc_4FB:				; CODE XREF: _crl_cb+B2j
		push	esi
		call	_crl_set_issuers
		add	esp, 4
		pop	edi
		pop	ebp
		test	eax, eax
		jz	short loc_526
		mov	eax, [esi+44h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_5CC
		push	esi
		call	eax
		add	esp, 4
		test	eax, eax
		jnz	loc_5CC

loc_526:				; CODE XREF: _crl_cb+114j _crl_cb+148j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_52A:				; CODE XREF: _crl_cb+17j
		mov	eax, [esi+44h]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_53E
		push	esi
		call	eax
		add	esp, 4
		test	eax, eax
		jz	short loc_526

loc_53E:				; CODE XREF: _crl_cb+13Ej
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_54E
		push	eax
		call	_AUTHORITY_KEYID_free
		add	esp, 4

loc_54E:				; CODE XREF: _crl_cb+14Fj
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_55E
		push	eax
		call	_ISSUING_DIST_POINT_free
		add	esp, 4

loc_55E:				; CODE XREF: _crl_cb+15Fj
		push	dword ptr [esi+24h]
		call	_ASN1_INTEGER_free
		push	dword ptr [esi+28h]
		call	_ASN1_INTEGER_free
		push	offset _GENERAL_NAMES_free
		push	dword ptr [esi+40h]
		call	_sk_pop_free
		add	esp, 10h
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_585:				; CODE XREF: _crl_cb+Ej
		mov	eax, ds:_default_crl_method
		mov	dword ptr [esi+18h], 0
		mov	dword ptr [esi+14h], 0
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi+1Ch], 0
		mov	dword ptr [esi+20h], 807Fh
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 0
		mov	dword ptr [esi+40h], 0
		mov	dword ptr [esi+24h], 0
		mov	dword ptr [esi+28h], 0

loc_5CC:				; CODE XREF: _crl_cb+20j _crl_cb+11Ej	...
		mov	eax, 1
		pop	esi
		retn
_crl_cb		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 5D4h
; COMDAT (pick any)
		public ??_C@_03GJBFOAJL@crl?$AA@
; `string'
??_C@_03GJBFOAJL@crl?$AA@ dd 6C7263h	; DATA XREF: .rdata:0000014Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 5D8h
; COMDAT (pick any)
		public ??_C@_09CMIIOJHF@signature?$AA@
; `string'
??_C@_09CMIIOJHF@signature?$AA@	db 'signature',0 ; DATA XREF: .rdata:00000174o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 5E4h
; COMDAT (pick any)
		public ??_C@_08JGFBPDAP@X509_CRL?$AA@
; `string'
??_C@_08JGFBPDAP@X509_CRL?$AA@ db 'X509_CRL',0 ; DATA XREF: .rdata:00000194o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_INFO_free
_X509_CRL_INFO_free proc near

arg_0		= dword	ptr  4

		push	offset ?local_it@?1??X509_CRL_INFO_it@@9@9 ; `X509_CRL_INFO_it'::`2'::local_it
		push	[esp+4+arg_0]
		call	_ASN1_item_free
		add	esp, 8
		retn
_X509_CRL_INFO_free endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 604h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_INFO_new
_X509_CRL_INFO_new proc	near
		push	offset ?local_it@?1??X509_CRL_INFO_it@@9@9 ; `X509_CRL_INFO_it'::`2'::local_it
		call	_ASN1_item_new
		add	esp, 4
		retn
_X509_CRL_INFO_new endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 614h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_METHOD_free
_X509_CRL_METHOD_free proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	byte ptr [eax],	1
		jz	short locret_626
		mov	[esp+arg_0], eax
		jmp	_CRYPTO_free
; ---------------------------------------------------------------------------

locret_626:				; CODE XREF: _X509_CRL_METHOD_free+7j
		retn
_X509_CRL_METHOD_free endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 628h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_METHOD_new
_X509_CRL_METHOD_new proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	1E3h
		push	offset ??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@ ; ".\\crypto\\asn1\\x_crl.c"
		push	14h
		call	_CRYPTO_malloc
		mov	ecx, eax
		add	esp, 0Ch
		test	ecx, ecx
		jnz	short loc_643
		retn
; ---------------------------------------------------------------------------

loc_643:				; CODE XREF: _X509_CRL_METHOD_new+18j
		mov	eax, [esp+arg_0]
		mov	[ecx+4], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+8], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+0Ch], eax
		mov	eax, [esp+arg_C]
		mov	[ecx+10h], eax
		mov	eax, ecx
		mov	dword ptr [ecx], 1
		retn
_X509_CRL_METHOD_new endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 668h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_add0_revoked
_X509_CRL_add0_revoked proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [eax]
		cmp	dword ptr [esi+14h], 0
		jnz	short loc_685
		push	offset _X509_REVOKED_cmp
		call	_sk_new
		add	esp, 4
		mov	[esi+14h], eax

loc_685:				; CODE XREF: _X509_CRL_add0_revoked+Bj
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_6AB
		push	[esp+4+arg_4]
		push	eax
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_6AB
		mov	dword ptr [esi+24h], 1
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_6AB:				; CODE XREF: _X509_CRL_add0_revoked+22j
					; _X509_CRL_add0_revoked+33j
		push	16Eh
		push	offset ??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@ ; ".\\crypto\\asn1\\x_crl.c"
		push	41h ; 'A'
		push	0A9h ; '©'
		push	0Dh
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_X509_CRL_add0_revoked endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_dup
_X509_CRL_dup	proc near

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		push	offset ?local_it@?1??X509_CRL_it@@9@9 ;	`X509_CRL_it'::`2'::local_it
		call	_ASN1_item_dup
		add	esp, 8
		retn
_X509_CRL_dup	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_free
_X509_CRL_free	proc near

arg_0		= dword	ptr  4

		push	offset ?local_it@?1??X509_CRL_it@@9@9 ;	`X509_CRL_it'::`2'::local_it
		push	[esp+4+arg_0]
		call	_ASN1_item_free
		add	esp, 8
		retn
_X509_CRL_free	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_get0_by_cert
_X509_CRL_get0_by_cert proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ebx, [edi+44h]
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_72D
		push	[esp+8+arg_8]
		call	_X509_get_issuer_name
		add	esp, 4
		push	eax
		push	[esp+0Ch+arg_8]
		call	_X509_get_serialNumber
		add	esp, 4
		push	eax
		push	[esp+10h+arg_4]
		mov	eax, [ebx+0Ch]
		push	edi
		call	eax
		add	esp, 10h
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_72D:				; CODE XREF: _X509_CRL_get0_by_cert+Dj
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
_X509_CRL_get0_by_cert endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 734h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_get0_by_serial
_X509_CRL_get0_by_serial proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+44h]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_753
		push	0
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	ecx
		call	eax
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_753:				; CODE XREF: _X509_CRL_get0_by_serial+Cj
		xor	eax, eax
		retn
_X509_CRL_get0_by_serial endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 758h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_get_meth_data
_X509_CRL_get_meth_data	proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+48h]
		retn
_X509_CRL_get_meth_data	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 760h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_it
_X509_CRL_it	proc near
		mov	eax, offset ?local_it@?1??X509_CRL_it@@9@9 ; `X509_CRL_it'::`2'::local_it
		retn
_X509_CRL_it	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 768h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_new
_X509_CRL_new	proc near
		push	offset ?local_it@?1??X509_CRL_it@@9@9 ;	`X509_CRL_it'::`2'::local_it
		call	_ASN1_item_new
		add	esp, 4
		retn
_X509_CRL_new	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 778h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_set_default_method
_X509_CRL_set_default_method proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, offset _int_crl_meth
		test	eax, eax
		cmovnz	ecx, eax
		mov	ds:_default_crl_method,	ecx
		retn
_X509_CRL_set_default_method endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 790h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_set_meth_data
_X509_CRL_set_meth_data	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	[eax+48h], ecx
		retn
_X509_CRL_set_meth_data	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 79Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_CRL_verify
_X509_CRL_verify proc near

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+44h]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_7B0
		mov	[esp+arg_0], ecx
		jmp	eax
; ---------------------------------------------------------------------------

loc_7B0:				; CODE XREF: _X509_CRL_verify+Cj
		xor	eax, eax
		retn
_X509_CRL_verify endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_X509_REVOKED_cmp proc near		; DATA XREF: _crl_inf_cb+18o
					; _X509_CRL_add0_revoked+Do

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax]
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax]
		call	_ASN1_STRING_cmp
		add	esp, 8
		retn
_X509_REVOKED_cmp endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7D0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REVOKED_dup
_X509_REVOKED_dup proc near

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		push	offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		call	_ASN1_item_dup
		add	esp, 8
		retn
_X509_REVOKED_dup endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REVOKED_free
_X509_REVOKED_free proc	near

arg_0		= dword	ptr  4

		push	offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		push	[esp+4+arg_0]
		call	_ASN1_item_free
		add	esp, 8
		retn
_X509_REVOKED_free endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7F8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REVOKED_new
_X509_REVOKED_new proc near
		push	offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		call	_ASN1_item_new
		add	esp, 4
		retn
_X509_REVOKED_new endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 808h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_crl_revoked_issuer_match proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_8]
		mov	ecx, [edi+0Ch]
		test	ecx, ecx
		jnz	short loc_83C
		mov	ecx, [esp+4+arg_4]
		test	ecx, ecx
		jnz	short loc_823
		mov	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_823:				; CODE XREF: _crl_revoked_issuer_match+12j
		mov	eax, [esp+4+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+8]
		push	ecx
		call	_X509_NAME_cmp
		add	esp, 8
		neg	eax
		sbb	eax, eax
		inc	eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_83C:				; CODE XREF: _crl_revoked_issuer_match+Aj
		push	ebx
		mov	ebx, [esp+8+arg_4]
		test	ebx, ebx
		jnz	short loc_84E
		mov	eax, [esp+8+arg_0]
		mov	eax, [eax]
		mov	ebx, [eax+8]

loc_84E:				; CODE XREF: _crl_revoked_issuer_match+3Bj
		push	esi
		push	ecx
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_88F

loc_85E:				; CODE XREF: _crl_revoked_issuer_match+85j
		push	esi
		push	dword ptr [edi+0Ch]
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax], 4
		jnz	short loc_87F
		push	dword ptr [eax+4]
		push	ebx
		call	_X509_NAME_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_895

loc_87F:				; CODE XREF: _crl_revoked_issuer_match+65j
		push	dword ptr [edi+0Ch]
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_85E

loc_88F:				; CODE XREF: _crl_revoked_issuer_match+54j
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_895:				; CODE XREF: _crl_revoked_issuer_match+75j
		pop	esi
		pop	ebx
		mov	eax, 1
		pop	edi
		retn
_crl_revoked_issuer_match endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_crl_set_issuers proc near		; CODE XREF: _crl_cb+108p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 8
		call	__chkstk
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	eax, [ebx]
		xor	ebp, ebp
		mov	[esp+18h+var_8], 0
		mov	esi, [eax+14h]
		push	esi
		mov	[esp+1Ch+var_4], esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_904

loc_8D2:				; CODE XREF: _crl_set_issuers+14Fj
		push	ebp
		push	esi
		call	_sk_value
		mov	esi, eax
		lea	eax, [esp+20h+arg_0]
		push	0
		push	eax
		push	303h
		push	esi
		call	_X509_REVOKED_get_ext_d2i
		mov	edi, eax
		add	esp, 18h
		test	edi, edi
		jnz	short loc_911
		cmp	[esp+18h+arg_0], 0FFFFFFFFh
		jz	short loc_93F

loc_8FD:				; CODE XREF: _crl_set_issuers+C6j
		or	dword ptr [ebx+10h], 80h

loc_904:				; CODE XREF: _crl_set_issuers+30j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_911:				; CODE XREF: _crl_set_issuers+54j
		cmp	dword ptr [ebx+40h], 0
		mov	[esp+18h+var_8], edi
		jnz	short loc_92B
		call	_sk_new_null
		mov	[ebx+40h], eax
		test	eax, eax
		jz	loc_A02

loc_92B:				; CODE XREF: _crl_set_issuers+79j
		push	edi
		push	dword ptr [ebx+40h]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	loc_A02

loc_93F:				; CODE XREF: _crl_set_issuers+5Bj
		mov	eax, [esp+18h+var_8]
		mov	[esi+0Ch], eax
		lea	eax, [esp+18h+arg_0]
		push	0
		push	eax
		push	8Dh ; 'ç'
		push	esi
		call	_X509_REVOKED_get_ext_d2i
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_971
		cmp	[esp+18h+arg_0], 0FFFFFFFFh
		jnz	short loc_8FD
		mov	dword ptr [esi+10h], 0FFFFFFFFh
		jmp	short loc_983
; ---------------------------------------------------------------------------

loc_971:				; CODE XREF: _crl_set_issuers+BFj
		push	edi
		call	_ASN1_ENUMERATED_get
		push	edi
		mov	[esi+10h], eax
		call	_ASN1_ENUMERATED_free
		add	esp, 8

loc_983:				; CODE XREF: _crl_set_issuers+CFj
		mov	esi, [esi+8]
		push	esi
		mov	[esp+1Ch+arg_0], 0
		call	_sk_num
		mov	ecx, [esp+1Ch+arg_0]
		add	esp, 4
		cmp	ecx, eax
		jge	short loc_9DF
		nop

loc_9A0:				; CODE XREF: _crl_set_issuers+134j
		push	ecx
		push	esi
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax+4], 0
		jle	short loc_9C1
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 303h
		jnz	short loc_9D8

loc_9C1:				; CODE XREF: _crl_set_issuers+10Ej
		inc	[esp+18h+arg_0]
		push	esi
		call	_sk_num
		mov	ecx, [esp+1Ch+arg_0]
		add	esp, 4
		cmp	ecx, eax
		jl	short loc_9A0
		jmp	short loc_9DF
; ---------------------------------------------------------------------------

loc_9D8:				; CODE XREF: _crl_set_issuers+11Fj
		or	dword ptr [ebx+10h], 200h

loc_9DF:				; CODE XREF: _crl_set_issuers+FDj
					; _crl_set_issuers+136j
		mov	esi, [esp+18h+var_4]
		inc	ebp
		push	esi
		call	_sk_num
		add	esp, 4
		cmp	ebp, eax
		jl	loc_8D2
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_A02:				; CODE XREF: _crl_set_issuers+85j
					; _crl_set_issuers+99j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
_crl_set_issuers endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A0Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _d2i_X509_CRL
_d2i_X509_CRL	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	offset ?local_it@?1??X509_CRL_it@@9@9 ;	`X509_CRL_it'::`2'::local_it
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		call	_ASN1_item_d2i
		add	esp, 10h
		retn
_d2i_X509_CRL	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A28h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _d2i_X509_CRL_INFO
_d2i_X509_CRL_INFO proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	offset ?local_it@?1??X509_CRL_INFO_it@@9@9 ; `X509_CRL_INFO_it'::`2'::local_it
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		call	_ASN1_item_d2i
		add	esp, 10h
		retn
_d2i_X509_CRL_INFO endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A44h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _d2i_X509_REVOKED
_d2i_X509_REVOKED proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		call	_ASN1_item_d2i
		add	esp, 10h
		retn
_d2i_X509_REVOKED endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A60h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _i2d_X509_CRL
_i2d_X509_CRL	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset ?local_it@?1??X509_CRL_it@@9@9 ;	`X509_CRL_it'::`2'::local_it
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_ASN1_item_i2d
		add	esp, 0Ch
		retn
_i2d_X509_CRL	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _i2d_X509_CRL_INFO
_i2d_X509_CRL_INFO proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset ?local_it@?1??X509_CRL_INFO_it@@9@9 ; `X509_CRL_INFO_it'::`2'::local_it
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_ASN1_item_i2d
		add	esp, 0Ch
		retn
_i2d_X509_CRL_INFO endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A90h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _i2d_X509_REVOKED
_i2d_X509_REVOKED proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset ?local_it@?1??X509_REVOKED_it@@9@9 ; `X509_REVOKED_it'::`2'::local_it
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_ASN1_item_i2d
		add	esp, 0Ch
		retn
_i2d_X509_REVOKED endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_setup_idp	proc near		; CODE XREF: _crl_cb+52p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		mov	edx, [esp+arg_4]
		push	esi
		or	dword ptr [ecx+1Ch], 1
		cmp	[edx+4], eax
		jle	short loc_AC5
		or	dword ptr [ecx+1Ch], 4
		mov	eax, 1

loc_AC5:				; CODE XREF: _setup_idp+12j
		cmp	dword ptr [edx+8], 0
		pop	esi
		jle	short loc_AD1
		inc	eax
		or	dword ptr [ecx+1Ch], 8

loc_AD1:				; CODE XREF: _setup_idp+22j
		cmp	dword ptr [edx+14h], 0
		jle	short loc_ADC
		inc	eax
		or	dword ptr [ecx+1Ch], 10h

loc_ADC:				; CODE XREF: _setup_idp+2Dj
		cmp	eax, 1
		jle	short loc_AE5
		or	dword ptr [ecx+1Ch], 2

loc_AE5:				; CODE XREF: _setup_idp+37j
		cmp	dword ptr [edx+10h], 0
		jle	short loc_AEF
		or	dword ptr [ecx+1Ch], 20h

loc_AEF:				; CODE XREF: _setup_idp+41j
		cmp	dword ptr [edx+0Ch], 0
		jz	short loc_B26
		or	dword ptr [ecx+1Ch], 40h
		mov	eax, [edx+0Ch]
		cmp	dword ptr [eax], 0
		jle	short loc_B0A
		mov	eax, [eax+8]
		movzx	eax, byte ptr [eax]
		mov	[ecx+20h], eax

loc_B0A:				; CODE XREF: _setup_idp+57j
		mov	eax, [edx+0Ch]
		cmp	dword ptr [eax], 1
		jle	short loc_B1F
		mov	eax, [eax+8]
		movzx	eax, byte ptr [eax+1]
		shl	eax, 8
		or	[ecx+20h], eax

loc_B1F:				; CODE XREF: _setup_idp+68j
		and	dword ptr [ecx+20h], 807Fh

loc_B26:				; CODE XREF: _setup_idp+4Bj
		mov	eax, [ecx]
		push	dword ptr [eax+8]
		push	dword ptr [edx]
		call	_DIST_POINT_set_dpname
		add	esp, 8
		retn
_setup_idp	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B38h
; COMDAT (pick any)
		public ??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@
; `string'
??_C@_0BG@GOAPPJIK@?4?2crypto?2asn1?2x_crl?4c?$AA@ db '.\crypto\asn1\x_crl.c',0
					; DATA XREF: _def_crl_lookup+2Eo
					; _def_crl_lookup+4Bo ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _ASN1_BIT_STRING_it:near ; DATA XREF: .rdata:00000178o
		extrn _ASN1_INTEGER_it:near ; DATA XREF: .rdata:00000020o
					; .rdata:00000090o
		extrn _ASN1_TIME_it:near ; DATA	XREF: .rdata:00000034o
					; .rdata:000000CCo ...
		extrn _X509_ALGOR_it:near ; DATA XREF: .rdata:000000A4o
					; .rdata:00000164o
		extrn _X509_EXTENSION_it:near ;	DATA XREF: .rdata:00000048o
					; .rdata:00000108o
		extrn _X509_NAME_it:near ; DATA	XREF: .rdata:000000B8o
		extrn _sk_num:near	; CODE XREF: _def_crl_lookup+87p
					; _def_crl_lookup+10Ap	...
		extrn _sk_value:near	; CODE XREF: _def_crl_lookup+A6p
					; _def_crl_lookup+11Ap	...
		extrn _sk_new:near	; CODE XREF: _X509_CRL_add0_revoked+12p
		extrn _sk_new_null:near	; CODE XREF: _crl_set_issuers+7Bp
		extrn _sk_pop_free:near	; CODE XREF: _crl_cb+182p
		extrn _sk_find:near	; CODE XREF: _def_crl_lookup+66p
		extrn _sk_push:near	; CODE XREF: _X509_CRL_add0_revoked+29p
					; _crl_set_issuers+8Fp
		extrn _sk_set_cmp_func:near ; CODE XREF: _crl_inf_cb+1Ep
		extrn _sk_sort:near	; CODE XREF: _def_crl_lookup+41p
		extrn _sk_is_sorted:near ; CODE	XREF: _def_crl_lookup+1Dp
		extrn _CRYPTO_lock:near	; CODE XREF: _def_crl_lookup+37p
					; _def_crl_lookup+54p
		extrn _CRYPTO_malloc:near ; CODE XREF: _X509_CRL_METHOD_new+Cp
		extrn _CRYPTO_free:near	; CODE XREF: _X509_CRL_METHOD_free+Dj
		extrn _ERR_put_error:near ; CODE XREF: _X509_CRL_add0_revoked+56p
		extrn _ASN1_STRING_cmp:near ; CODE XREF: _X509_REVOKED_cmp+10p
		extrn _ASN1_INTEGER_free:near ;	CODE XREF: _crl_cb+16Dp
					; _crl_cb+175p
		extrn _ASN1_INTEGER_cmp:near ; CODE XREF: _def_crl_lookup+B3p
		extrn _ASN1_ENUMERATED_free:near ; CODE	XREF: _crl_set_issuers+DBp
		extrn _ASN1_ENUMERATED_get:near	; CODE XREF: _crl_set_issuers+D2p
		extrn _ASN1_item_dup:near ; CODE XREF: _X509_CRL_dup+9p
					; _X509_REVOKED_dup+9p
		extrn _ASN1_item_new:near ; CODE XREF: _X509_CRL_INFO_new+5p
					; _X509_CRL_new+5p ...
		extrn _ASN1_item_free:near ; CODE XREF:	_X509_CRL_INFO_free+9p
					; _X509_CRL_free+9p ...
		extrn _ASN1_item_d2i:near ; CODE XREF: _d2i_X509_CRL+11p
					; _d2i_X509_CRL_INFO+11p ...
		extrn _ASN1_item_i2d:near ; CODE XREF: _i2d_X509_CRL+Dp
					; _i2d_X509_CRL_INFO+Dp ...
		extrn _OBJ_obj2nid:near	; CODE XREF: _crl_cb+C0p
					; _crl_set_issuers+112p
		extrn _EVP_sha1:near	; CODE XREF: _crl_cb+2Bp
		extrn _X509_CRL_digest:near ; CODE XREF: _crl_cb+32p
		extrn _ASN1_item_verify:near ; CODE XREF: _def_crl_verify+15p
		extrn _X509_get_serialNumber:near ; CODE XREF: _X509_CRL_get0_by_cert+20p
		extrn _X509_get_issuer_name:near ; CODE	XREF: _X509_CRL_get0_by_cert+13p
		extrn _X509_NAME_cmp:near ; CODE XREF: _def_crl_lookup+D6p
					; _def_crl_lookup+12Bp	...
		extrn _X509_CRL_get_ext_d2i:near ; CODE	XREF: _crl_cb+41p
					; _crl_cb+61p ...
		extrn _X509_REVOKED_get_ext_d2i:near ; CODE XREF: _crl_set_issuers+48p
					; _crl_set_issuers+B3p
		extrn _AUTHORITY_KEYID_free:near ; CODE	XREF: _crl_cb+152p
		extrn _GENERAL_NAMES_free:near ; DATA XREF: _crl_cb+17Ao
		extrn _ISSUING_DIST_POINT_free:near ; CODE XREF: _crl_cb+162p
		extrn _DIST_POINT_set_dpname:near ; CODE XREF: _setup_idp+85p
		extrn __chkstk:near	; CODE XREF: _def_crl_lookup+5p
					; _crl_set_issuers+5p


		end
