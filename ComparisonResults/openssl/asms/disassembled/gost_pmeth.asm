;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	FFC4115885357EA1AB7973ED09990701
; Input	CRC32 :	5F1F306C

; File Name   :	C:\compspace\Diff\openssl\obj\gost_pmeth.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost01_cp_sign proc near		; DATA XREF: _register_pmeth_gost+117o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get0_pkey
		mov	esi, [esp+8+arg_8]
		add	esp, 4
		test	esi, esi
		jnz	short loc_19

loc_15:					; CODE XREF: _pkey_gost01_cp_sign+46j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_19:					; CODE XREF: _pkey_gost01_cp_sign+13j
		cmp	[esp+4+arg_4], 0
		jnz	short loc_2D
		mov	dword ptr [esi], 40h ; '@'
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_2D:					; CODE XREF: _pkey_gost01_cp_sign+1Ej
		push	eax
		call	_EVP_PKEY_get0
		push	eax
		push	[esp+0Ch+arg_10]
		push	[esp+10h+arg_C]
		call	_gost2001_do_sign
		add	esp, 10h
		test	eax, eax
		jz	short loc_15
		push	esi
		push	[esp+8+arg_4]
		push	20h ; ' '
		push	eax
		call	_pack_sign_cp
		add	esp, 10h
		pop	esi
		retn
_pkey_gost01_cp_sign endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost01_cp_verify proc near	; DATA XREF: _register_pmeth_gost+125o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	esi
		push	edi
		push	[esp+0Ch+arg_0]
		xor	ebx, ebx
		call	_EVP_PKEY_CTX_get0_pkey
		push	[esp+10h+arg_8]
		mov	edi, eax
		push	[esp+14h+arg_4]
		call	_unpack_cp_signature
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_86
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_86:					; CODE XREF: _pkey_gost01_cp_verify+24j
		test	edi, edi
		jz	short loc_A4
		push	edi
		call	_EVP_PKEY_get0
		push	eax
		push	esi
		push	[esp+18h+arg_10]
		push	[esp+1Ch+arg_C]
		call	_gost2001_do_verify
		add	esp, 14h
		mov	ebx, eax

loc_A4:					; CODE XREF: _pkey_gost01_cp_verify+2Cj
		push	esi
		call	_DSA_SIG_free
		add	esp, 4
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
_pkey_gost01_cp_verify endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost01_paramgen proc near		; CODE XREF: _pkey_gost01cp_keygen+8p
					; DATA XREF: _register_pmeth_gost+174o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get_data
		mov	edi, eax
		add	esp, 4
		cmp	dword ptr [edi], 0
		jnz	short loc_E5
		push	117h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	77h ; 'w'
		push	8Ah ; 'ä'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_E5:					; CODE XREF: _pkey_gost01_paramgen+12j
		push	esi
		call	_EC_KEY_new
		push	dword ptr [edi]
		mov	esi, eax
		push	esi
		call	_fill_GOST2001_params
		add	esp, 8
		push	esi
		test	eax, eax
		jnz	short loc_10A
		call	_EC_KEY_free
		add	esp, 4
		xor	eax, eax
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10A:				; CODE XREF: _pkey_gost01_paramgen+47j
		push	32Bh
		push	[esp+10h+arg_4]
		call	_EVP_PKEY_assign
		add	esp, 0Ch
		mov	eax, 1
		pop	esi
		pop	edi
		retn
_pkey_gost01_paramgen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 124h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost01cp_keygen proc near		; DATA XREF: _register_pmeth_gost+133o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		call	_pkey_gost01_paramgen
		add	esp, 8
		test	eax, eax
		jnz	short loc_139
		retn
; ---------------------------------------------------------------------------

loc_139:				; CODE XREF: _pkey_gost01cp_keygen+12j
		push	[esp+arg_4]
		call	_EVP_PKEY_get0
		push	eax
		call	_gost2001_keygen
		add	esp, 8
		mov	eax, 1
		retn
_pkey_gost01cp_keygen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 154h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost94_cp_sign proc near		; DATA XREF: _register_pmeth_gost+B1o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get0_pkey
		mov	esi, [esp+8+arg_8]
		add	esp, 4
		test	esi, esi
		jnz	short loc_16D

loc_169:				; CODE XREF: _pkey_gost94_cp_sign+46j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_16D:				; CODE XREF: _pkey_gost94_cp_sign+13j
		cmp	[esp+4+arg_4], 0
		jnz	short loc_181
		mov	dword ptr [esi], 40h ; '@'
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_181:				; CODE XREF: _pkey_gost94_cp_sign+1Ej
		push	eax
		call	_EVP_PKEY_get0
		push	eax
		push	[esp+0Ch+arg_10]
		push	[esp+10h+arg_C]
		call	_gost_do_sign
		add	esp, 10h
		test	eax, eax
		jz	short loc_169
		push	esi
		push	[esp+8+arg_4]
		push	20h ; ' '
		push	eax
		call	_pack_sign_cp
		add	esp, 10h
		pop	esi
		retn
_pkey_gost94_cp_sign endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost94_cp_verify proc near	; DATA XREF: _register_pmeth_gost+BFo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	esi
		push	edi
		push	[esp+0Ch+arg_0]
		xor	ebx, ebx
		call	_EVP_PKEY_CTX_get0_pkey
		push	[esp+10h+arg_8]
		mov	edi, eax
		push	[esp+14h+arg_4]
		call	_unpack_cp_signature
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1DA
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1DA:				; CODE XREF: _pkey_gost94_cp_verify+24j
		test	edi, edi
		jz	short loc_1F8
		push	edi
		call	_EVP_PKEY_get0
		push	eax
		push	esi
		push	[esp+18h+arg_10]
		push	[esp+1Ch+arg_C]
		call	_gost_do_verify
		add	esp, 14h
		mov	ebx, eax

loc_1F8:				; CODE XREF: _pkey_gost94_cp_verify+2Cj
		push	esi
		call	_DSA_SIG_free
		add	esp, 4
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
_pkey_gost94_cp_verify endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 208h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost94_paramgen proc near		; CODE XREF: _pkey_gost94cp_keygen+8p
					; DATA XREF: _register_pmeth_gost+100o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get_data
		mov	edi, eax
		add	esp, 4
		cmp	dword ptr [edi], 0
		jnz	short loc_239
		push	105h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	77h ; 'w'
		push	8Bh ; 'ã'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_239:				; CODE XREF: _pkey_gost94_paramgen+12j
		push	esi
		call	_DSA_new
		push	dword ptr [edi]
		mov	esi, eax
		push	esi
		call	_fill_GOST94_params
		add	esp, 8
		push	esi
		test	eax, eax
		jnz	short loc_25E
		call	_DSA_free
		add	esp, 4
		xor	eax, eax
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_25E:				; CODE XREF: _pkey_gost94_paramgen+47j
		push	32Ch
		push	[esp+10h+arg_4]
		call	_EVP_PKEY_assign
		add	esp, 0Ch
		mov	eax, 1
		pop	esi
		pop	edi
		retn
_pkey_gost94_paramgen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 278h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost94cp_keygen proc near		; DATA XREF: _register_pmeth_gost+A3o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		call	_pkey_gost94_paramgen
		add	esp, 8
		test	eax, eax
		jnz	short loc_28D
		retn
; ---------------------------------------------------------------------------

loc_28D:				; CODE XREF: _pkey_gost94cp_keygen+12j
		push	[esp+arg_4]
		call	_EVP_PKEY_get0
		push	eax
		call	_gost_sign_keygen
		add	esp, 8
		mov	eax, 1
		retn
_pkey_gost94cp_keygen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_cleanup proc	near		; DATA XREF: _register_pmeth_gost+194o

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get_data
		mov	esi, eax
		add	esp, 4
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_2C7
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2C7:				; CODE XREF: _pkey_gost_cleanup+14j
		push	esi
		call	_CRYPTO_free
		add	esp, 4
		pop	esi
		retn
_pkey_gost_cleanup endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_copy	proc near		; DATA XREF: _register_pmeth_gost+1A0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_0]
		call	_pkey_gost_init
		add	esp, 4
		test	eax, eax
		jnz	short loc_2E5
		retn
; ---------------------------------------------------------------------------

loc_2E5:				; CODE XREF: _pkey_gost_copy+Ej
		push	esi
		push	[esp+4+arg_4]
		call	_EVP_PKEY_CTX_get_data
		push	[esp+8+arg_0]
		mov	esi, eax
		call	_EVP_PKEY_CTX_get_data
		movups	xmm0, xmmword ptr [esi]
		add	esp, 8
		movups	xmmword	ptr [eax], xmm0
		cmp	dword ptr [esi+8], 0
		pop	esi
		jz	short loc_311
		mov	dword ptr [eax+8], 0

loc_311:				; CODE XREF: _pkey_gost_copy+34j
		mov	eax, 1
		retn
_pkey_gost_copy	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 318h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl pkey_gost_ctrl(int, int, size_t Size, void *Src)
_pkey_gost_ctrl	proc near		; DATA XREF: _register_pmeth_gost+98o
					; _register_pmeth_gost+10Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Size		= dword	ptr  0Ch
Src		= dword	ptr  10h

		push	esi
		push	edi
		push	[esp+8+arg_0]
		call	_EVP_PKEY_CTX_get_data
		mov	edi, eax
		add	esp, 4
		mov	eax, [esp+8+arg_4]
		cmp	eax, 0Dh
		jg	loc_3F9
		jz	loc_3E8
		dec	eax
		cmp	eax, 0Ah	; switch 11 cases
		ja	$LN14		; jumptable 0000034C default case
		movzx	eax, ds:$LN17[eax]
		jmp	ds:$LN20[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _pkey_gost_ctrl+34j
					; DATA XREF: .text$mn:$LN20o
		mov	esi, [esp+8+Src] ; jumptable 0000034C case 0
		push	esi
		call	_EVP_MD_type
		add	esp, 4
		cmp	eax, 329h
		jz	short loc_37F
		push	52h ; 'R'
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	6Ch ; 'l'
		push	7Dh ; '}'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_37F:				; CODE XREF: _pkey_gost_ctrl+4Dj
		mov	[edi+4], esi
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _pkey_gost_ctrl+34j
					; DATA XREF: .text$mn:$LN20o
		mov	esi, [esp+8+Size] ; jumptable 0000034C case 7
		push	6Dh ; 'm'
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	esi
		call	_CRYPTO_malloc
		push	esi		; Size
		push	[esp+18h+Src]	; Src
		mov	[edi+8], eax
		push	eax		; Dst
		call	_memcpy
		add	esp, 18h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: _pkey_gost_ctrl+34j
					; DATA XREF: .text$mn:$LN20o
		mov	eax, [esp+8+Size] ; jumptable 0000034C case 1
		test	eax, eax
		jz	short $LN18	; jumptable 0000034C cases 2-4,6,8-10
		cmp	eax, 1
		jz	short $LN18	; jumptable 0000034C cases 2-4,6,8-10
		cmp	eax, 2
		jnz	short loc_3CC
		mov	eax, [edi+0Ch]
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3CC:				; CODE XREF: _pkey_gost_ctrl+ACj
		cmp	eax, 3
		jnz	short $LN14	; jumptable 0000034C default case
		mov	dword ptr [edi+0Ch], 1
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: _pkey_gost_ctrl+27j
					; _pkey_gost_ctrl+34j ...
		pop	edi		; jumptable 0000034C default case
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3E8:				; CODE XREF: _pkey_gost_ctrl+1Dj
		mov	eax, [esp+8+Src]
		mov	ecx, [edi+4]
		pop	edi
		pop	esi
		mov	[eax], ecx
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_3F9:				; CODE XREF: _pkey_gost_ctrl+17j
		cmp	eax, 1001h
		jnz	short $LN14	; jumptable 0000034C default case
		mov	eax, [esp+8+Size]
		mov	[edi], eax

$LN18:					; CODE XREF: _pkey_gost_ctrl+34j
					; _pkey_gost_ctrl+A2j ...
		pop	edi		; jumptable 0000034C cases 2-4,6,8-10
		mov	eax, 1
		pop	esi
		retn
_pkey_gost_ctrl	endp

; ---------------------------------------------------------------------------
		align 10h
$LN20		dd offset $LN4		; DATA XREF: _pkey_gost_ctrl+34r
		dd offset $LN10		; jump table for switch	statement
		dd offset $LN18
		dd offset $LN9
		dd offset $LN14
$LN17		db	0,     1,     2,     2 ; DATA XREF: _pkey_gost_ctrl+2Dr
		db	2,     4,     2,     3 ; indirect table	for switch statement
		db	2,     2,     2
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 430h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_ctrl01_str proc near		; DATA XREF: _register_pmeth_gost:loc_D07o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	ecx, offset ??_C@_08FACMJMOL@paramset?$AA@ ; "paramset"
		nop	dword ptr [eax+00000000h]

loc_440:				; CODE XREF: _pkey_gost_ctrl01_str+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_460
		test	dl, dl
		jz	short loc_45C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_460
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_440

loc_45C:				; CODE XREF: _pkey_gost_ctrl01_str+18j
		xor	eax, eax
		jmp	short loc_465
; ---------------------------------------------------------------------------

loc_460:				; CODE XREF: _pkey_gost_ctrl01_str+14j
					; _pkey_gost_ctrl01_str+20j
		sbb	eax, eax
		or	eax, 1

loc_465:				; CODE XREF: _pkey_gost_ctrl01_str+2Ej
		test	eax, eax
		jnz	loc_585
		push	esi
		mov	esi, [esp+4+arg_8]
		test	esi, esi
		jnz	short loc_478
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_478:				; CODE XREF: _pkey_gost_ctrl01_str+44j
		mov	ecx, esi
		lea	edx, [ecx+1]
		nop	dword ptr [eax]

loc_480:				; CODE XREF: _pkey_gost_ctrl01_str+55j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_480
		sub	ecx, edx
		push	edi
		cmp	ecx, 1
		jnz	short loc_4E6
		movzx	eax, byte ptr [esi]
		push	eax		; C
		call	dword ptr ds:__imp__toupper
		add	eax, 0FFFFFFD0h
		add	esp, 4
		cmp	eax, 13h	; switch 20 cases
		ja	$LN58		; jumptable 000004AF default case
		movzx	eax, ds:$LN54[eax]
		jmp	ds:$LN60_0[eax*4] ; switch jump
; ---------------------------------------------------------------------------

$LN13_0:				; CODE XREF: _pkey_gost_ctrl01_str+7Fj
					; DATA XREF: .text$mn:$LN60_0o
		mov	esi, 348h	; jumptable 000004AF case 17

loc_4BB:				; CODE XREF: _pkey_gost_ctrl01_str+A6j
					; _pkey_gost_ctrl01_str+ADj ...
		push	[esp+8+arg_0]
		call	_EVP_PKEY_CTX_get_data
		add	esp, 4
		mov	[eax], esi
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN14_1:				; CODE XREF: _pkey_gost_ctrl01_str+7Fj
					; DATA XREF: .text$mn:$LN60_0o
		mov	esi, 349h	; jumptable 000004AF case 18
		jmp	short loc_4BB
; ---------------------------------------------------------------------------

$LN15_0:				; CODE XREF: _pkey_gost_ctrl01_str+7Fj
					; DATA XREF: .text$mn:$LN60_0o
		mov	esi, 34Ah	; jumptable 000004AF case 19
		jmp	short loc_4BB
; ---------------------------------------------------------------------------

$LN16_0:				; CODE XREF: _pkey_gost_ctrl01_str+7Fj
					; DATA XREF: .text$mn:$LN60_0o
		mov	esi, 347h	; jumptable 000004AF case 0
		jmp	short loc_4BB
; ---------------------------------------------------------------------------

loc_4E6:				; CODE XREF: _pkey_gost_ctrl01_str+5Dj
		mov	ecx, esi
		lea	edx, [ecx+1]
		nop	dword ptr [eax+eax+00h]

loc_4F0:				; CODE XREF: _pkey_gost_ctrl01_str+C5j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_4F0
		sub	ecx, edx
		cmp	ecx, 2
		jnz	short loc_534
		movzx	eax, byte ptr [esi]
		mov	edi, dword ptr ds:__imp__toupper
		push	eax		; C
		call	edi ; __imp__toupper
		add	esp, 4
		cmp	eax, 58h ; 'X'
		jnz	short loc_534
		movzx	eax, byte ptr [esi+1]
		push	eax		; C
		call	edi ; __imp__toupper
		add	esp, 4
		sub	eax, 41h ; 'A'
		jz	short loc_52D
		sub	eax, 1
		jnz	short $LN58	; jumptable 000004AF default case
		mov	esi, 34Ch
		jmp	short loc_4BB
; ---------------------------------------------------------------------------

loc_52D:				; CODE XREF: _pkey_gost_ctrl01_str+EFj
		mov	esi, 34Bh
		jmp	short loc_4BB
; ---------------------------------------------------------------------------

loc_534:				; CODE XREF: _pkey_gost_ctrl01_str+CCj
					; _pkey_gost_ctrl01_str+E0j
		push	esi
		mov	edi, offset _R3410_2001_paramset
		call	_OBJ_txt2nid
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short $LN58	; jumptable 000004AF default case
		mov	eax, dword ptr ds:_R3410_2001_paramset
		test	eax, eax
		jz	short loc_561

loc_551:				; CODE XREF: _pkey_gost_ctrl01_str+12Dj
		cmp	eax, esi
		jz	short loc_561
		mov	eax, [edi+1Ch]
		add	edi, 1Ch
		test	eax, eax
		jnz	short loc_551
		jmp	short loc_56A
; ---------------------------------------------------------------------------

loc_561:				; CODE XREF: _pkey_gost_ctrl01_str+11Fj
					; _pkey_gost_ctrl01_str+123j
		cmp	dword ptr [edi], 0
		jnz	loc_4BB

loc_56A:				; CODE XREF: _pkey_gost_ctrl01_str+12Fj
		push	0EEh ; 'Ó'
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	70h ; 'p'
		push	7Eh ; '~'
		call	_ERR_GOST_error
		add	esp, 10h

$LN58:					; CODE XREF: _pkey_gost_ctrl01_str+72j
					; _pkey_gost_ctrl01_str+7Fj ...
		pop	edi		; jumptable 000004AF default case
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_585:				; CODE XREF: _pkey_gost_ctrl01_str+37j
		mov	eax, 0FFFFFFFEh
		retn
_pkey_gost_ctrl01_str endp

; ---------------------------------------------------------------------------
		align 4
$LN60_0		dd offset $LN16_0	; DATA XREF: _pkey_gost_ctrl01_str+7Fr
		dd offset $LN13_0	; jump table for switch	statement
		dd offset $LN14_1
		dd offset $LN15_0
		dd offset $LN58
$LN54		db	0,     4,     4,     4 ; DATA XREF: _pkey_gost_ctrl01_str+78r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     1,     2,     3
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_ctrl94_str proc near		; DATA XREF: _register_pmeth_gost:loc_C93o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	ecx, offset ??_C@_08FACMJMOL@paramset?$AA@ ; "paramset"
		nop	dword ptr [eax+00000000h]

loc_5C4:				; CODE XREF: _pkey_gost_ctrl94_str+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_5E4
		test	dl, dl
		jz	short loc_5E0
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_5E4
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_5C4

loc_5E0:				; CODE XREF: _pkey_gost_ctrl94_str+18j
		xor	eax, eax
		jmp	short loc_5E9
; ---------------------------------------------------------------------------

loc_5E4:				; CODE XREF: _pkey_gost_ctrl94_str+14j
					; _pkey_gost_ctrl94_str+20j
		sbb	eax, eax
		or	eax, 1

loc_5E9:				; CODE XREF: _pkey_gost_ctrl94_str+2Ej
		test	eax, eax
		jnz	loc_709
		push	esi
		mov	esi, [esp+4+arg_8]
		test	esi, esi
		jnz	short loc_5FC
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_5FC:				; CODE XREF: _pkey_gost_ctrl94_str+44j
		mov	ecx, esi
		lea	edx, [ecx+1]
		nop	dword ptr [eax]

loc_604:				; CODE XREF: _pkey_gost_ctrl94_str+55j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_604
		sub	ecx, edx
		push	edi
		cmp	ecx, 1
		jnz	short loc_663
		movzx	eax, byte ptr [esi]
		push	eax		; C
		call	dword ptr ds:__imp__toupper
		add	eax, 0FFFFFFBFh
		add	esp, 4
		cmp	eax, 3		; switch 4 cases
		ja	loc_704		; jumptable 0000062C default case
		jmp	ds:$LN60[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _pkey_gost_ctrl94_str+78j
					; DATA XREF: .text$mn:$LN60o
		mov	esi, 340h	; jumptable 0000062C case 0

loc_638:				; CODE XREF: _pkey_gost_ctrl94_str+9Fj
					; _pkey_gost_ctrl94_str+A6j ...
		push	[esp+8+arg_0]
		call	_EVP_PKEY_CTX_get_data
		add	esp, 4
		mov	[eax], esi
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN14_0:				; CODE XREF: _pkey_gost_ctrl94_str+78j
					; DATA XREF: .text$mn:$LN60o
		mov	esi, 341h	; jumptable 0000062C case 1
		jmp	short loc_638
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _pkey_gost_ctrl94_str+78j
					; DATA XREF: .text$mn:$LN60o
		mov	esi, 342h	; jumptable 0000062C case 2
		jmp	short loc_638
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: _pkey_gost_ctrl94_str+78j
					; DATA XREF: .text$mn:$LN60o
		mov	esi, 343h	; jumptable 0000062C case 3
		jmp	short loc_638
; ---------------------------------------------------------------------------

loc_663:				; CODE XREF: _pkey_gost_ctrl94_str+5Dj
		mov	ecx, esi
		lea	edx, [ecx+1]

loc_668:				; CODE XREF: _pkey_gost_ctrl94_str+B9j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_668
		sub	ecx, edx
		cmp	ecx, 2
		jnz	short loc_6B8
		movzx	eax, byte ptr [esi]
		mov	edi, dword ptr ds:__imp__toupper
		push	eax		; C
		call	edi ; __imp__toupper
		add	esp, 4
		cmp	eax, 58h ; 'X'
		jnz	short loc_6B8
		movzx	eax, byte ptr [esi+1]
		push	eax		; C
		call	edi ; __imp__toupper
		add	esp, 4
		sub	eax, 41h ; 'A'
		jz	short loc_6B1
		sub	eax, 1
		jz	short loc_6AA
		sub	eax, 1
		jnz	short loc_704	; jumptable 0000062C default case
		mov	esi, 346h
		jmp	short loc_638
; ---------------------------------------------------------------------------

loc_6AA:				; CODE XREF: _pkey_gost_ctrl94_str+E8j
		mov	esi, 345h
		jmp	short loc_638
; ---------------------------------------------------------------------------

loc_6B1:				; CODE XREF: _pkey_gost_ctrl94_str+E3j
		mov	esi, 344h
		jmp	short loc_638
; ---------------------------------------------------------------------------

loc_6B8:				; CODE XREF: _pkey_gost_ctrl94_str+C0j
					; _pkey_gost_ctrl94_str+D4j
		push	esi
		mov	edi, offset _R3410_paramset
		call	_OBJ_txt2nid
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_704	; jumptable 0000062C default case
		mov	eax, dword ptr ds:_R3410_paramset
		test	eax, eax
		jz	short loc_6E5

loc_6D5:				; CODE XREF: _pkey_gost_ctrl94_str+12Dj
		cmp	eax, esi
		jz	short loc_6E5
		mov	eax, [edi+10h]
		add	edi, 10h
		test	eax, eax
		jnz	short loc_6D5
		jmp	short loc_6EE
; ---------------------------------------------------------------------------

loc_6E5:				; CODE XREF: _pkey_gost_ctrl94_str+11Fj
					; _pkey_gost_ctrl94_str+123j
		cmp	dword ptr [edi], 0
		jnz	loc_638

loc_6EE:				; CODE XREF: _pkey_gost_ctrl94_str+12Fj
		push	0B1h ; '±'
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	70h ; 'p'
		push	7Fh ; ''
		call	_ERR_GOST_error
		add	esp, 10h

loc_704:				; CODE XREF: _pkey_gost_ctrl94_str+72j
					; _pkey_gost_ctrl94_str+EDj ...
		pop	edi		; jumptable 0000062C default case
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_709:				; CODE XREF: _pkey_gost_ctrl94_str+37j
		mov	eax, 0FFFFFFFEh
		retn
_pkey_gost_ctrl94_str endp

; ---------------------------------------------------------------------------
		align 10h
$LN60		dd offset $LN13		; DATA XREF: _pkey_gost_ctrl94_str+78r
		dd offset $LN14_0	; jump table for switch	statement
		dd offset $LN15
		dd offset $LN16
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 720h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_derive_init proc near	; DATA XREF: _register_pmeth_gost+F4o
					; _register_pmeth_gost+168o
		mov	eax, 1
		retn
_pkey_gost_derive_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 728h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_encrypt_init	proc near	; DATA XREF: _register_pmeth_gost+D2o
					; _register_pmeth_gost+146o
		mov	eax, 1
		retn
_pkey_gost_encrypt_init	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 730h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_init	proc near		; CODE XREF: _pkey_gost_copy+4p
					; DATA XREF: _register_pmeth_gost+188o

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	[esp+8+arg_0]
		call	_EVP_PKEY_CTX_get0_pkey
		push	1Ah
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	10h
		mov	esi, eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_759

loc_754:				; CODE XREF: _pkey_gost_init+53j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_759:				; CODE XREF: _pkey_gost_init+22j
		xorps	xmm0, xmm0
		movups	xmmword	ptr [edi], xmm0
		test	esi, esi
		jz	short loc_7AD
		push	esi
		call	_EVP_PKEY_get0
		add	esp, 4
		test	eax, eax
		jz	short loc_7AD
		push	esi
		call	_EVP_PKEY_base_id
		add	esp, 4
		sub	eax, 32Bh
		jz	short loc_796
		sub	eax, 1
		jnz	short loc_754
		push	esi
		call	_EVP_PKEY_get0
		push	eax
		call	_gost94_nid_by_params
		add	esp, 8
		jmp	short loc_7AB
; ---------------------------------------------------------------------------

loc_796:				; CODE XREF: _pkey_gost_init+4Ej
		push	esi
		call	_EVP_PKEY_get0
		push	eax
		call	_EC_KEY_get0_group
		push	eax
		call	_EC_GROUP_get_curve_name
		add	esp, 0Ch

loc_7AB:				; CODE XREF: _pkey_gost_init+64j
		mov	[edi], eax

loc_7AD:				; CODE XREF: _pkey_gost_init+31j
					; _pkey_gost_init+3Ej
		push	edi
		push	[esp+0Ch+arg_0]
		call	_EVP_PKEY_CTX_set_data
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		retn
_pkey_gost_init	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_cleanup proc near	; DATA XREF: _register_pmeth_gost+72o

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	_EVP_PKEY_CTX_get_data
		add	esp, 4
		mov	[esp+arg_0], eax
		jmp	_CRYPTO_free
_pkey_gost_mac_cleanup endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_copy proc near		; DATA XREF: _register_pmeth_gost+7Eo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	19Ah
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	28h ; '('
		call	_CRYPTO_malloc
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_844
		push	edi
		xorps	xmm0, xmm0
		push	eax
		push	[esp+8+arg_0]
		movups	xmmword	ptr [eax], xmm0
		movups	xmmword	ptr [eax+10h], xmm0
		movq	qword ptr [eax+20h], xmm0
		call	_EVP_PKEY_CTX_set_data
		push	[esp+0Ch+arg_4]
		call	_EVP_PKEY_CTX_get_data
		push	[esp+10h+arg_0]
		mov	edi, eax
		call	_EVP_PKEY_CTX_get_data
		movups	xmm0, xmmword ptr [edi]
		add	esp, 10h
		movups	xmmword	ptr [eax], xmm0
		movups	xmm0, xmmword ptr [edi+10h]
		movups	xmmword	ptr [eax+10h], xmm0
		movq	xmm0, qword ptr	[edi+20h]
		movq	qword ptr [eax+20h], xmm0
		mov	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_844:				; CODE XREF: _pkey_gost_mac_copy+16j
		xor	eax, eax
		retn
_pkey_gost_mac_copy endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 848h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_ctrl proc near		; DATA XREF: _register_pmeth_gost+3Do

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		push	edi
		call	_EVP_PKEY_CTX_get_data
		mov	ecx, [esp+0Ch+arg_4]
		add	esp, 4
		dec	ecx
		mov	esi, eax
		cmp	ecx, 0Ch	; switch 13 cases
		ja	$LN2		; jumptable 0000086E default case
		movzx	ecx, ds:$LN16_1[ecx]
		jmp	ds:$LN18_0[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

$LN4_0:					; CODE XREF: _pkey_gost_mac_ctrl+26j
					; DATA XREF: .text$mn:$LN18_0o
		mov	edi, [esp+8+arg_C] ; jumptable 0000086E	case 0
		push	edi
		call	_EVP_MD_type
		add	esp, 4
		cmp	eax, 32Fh
		jz	short loc_8A7
		push	1BEh
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	6Ch ; 'l'
		push	80h ; 'Ä'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_8A7:				; CODE XREF: _pkey_gost_mac_ctrl+3Fj
		mov	[esi+4], edi

$LN7:					; CODE XREF: _pkey_gost_mac_ctrl+26j
					; DATA XREF: .text$mn:$LN18_0o
		pop	edi		; jumptable 0000086E cases 2-4
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _pkey_gost_mac_ctrl+26j
					; DATA XREF: .text$mn:$LN18_0o
		mov	eax, [esp+8+arg_C] ; jumptable 0000086E	case 12
		mov	ecx, [esi+4]
		pop	edi
		pop	esi
		mov	[eax], ecx
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

$LN8:					; CODE XREF: _pkey_gost_mac_ctrl+26j
					; DATA XREF: .text$mn:$LN18_0o
		cmp	[esp+8+arg_8], 20h ; ' ' ; jumptable 0000086E case 5
		jz	short loc_8E8
		push	1D0h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	6Fh ; 'o'
		push	80h ; 'Ä'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_8E8:				; CODE XREF: _pkey_gost_mac_ctrl+80j
		mov	eax, [esp+8+arg_C]
		pop	edi
		movups	xmm0, xmmword ptr [eax]
		movups	xmmword	ptr [esi+8], xmm0
		movups	xmm0, xmmword ptr [eax+10h]
		mov	dword ptr [esi], 1
		mov	eax, 1
		movups	xmmword	ptr [esi+18h], xmm0
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN10_0:				; CODE XREF: _pkey_gost_mac_ctrl+26j
					; DATA XREF: .text$mn:$LN18_0o
		cmp	dword ptr [esi], 0 ; jumptable 0000086E	case 6
		jnz	short loc_966
		push	edi
		call	_EVP_PKEY_CTX_get0_pkey
		add	esp, 4
		test	eax, eax
		jnz	short loc_939
		push	1DFh
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	74h ; 't'
		push	80h ; 'Ä'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_939:				; CODE XREF: _pkey_gost_mac_ctrl+D1j
		push	eax
		call	_EVP_PKEY_get0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_969
		push	1E5h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	74h ; 't'
		push	80h ; 'Ä'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_966:				; CODE XREF: _pkey_gost_mac_ctrl+C4j
		add	esi, 8

loc_969:				; CODE XREF: _pkey_gost_mac_ctrl+FEj
		mov	eax, [esp+8+arg_C]
		push	esi
		push	20h ; ' '
		push	1004h
		mov	ecx, [eax]
		push	eax
		mov	eax, [ecx+48h]
		call	eax
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$LN2:					; CODE XREF: _pkey_gost_mac_ctrl+19j
					; _pkey_gost_mac_ctrl+26j
					; DATA XREF: ...
		pop	edi		; jumptable 0000086E default case
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
_pkey_gost_mac_ctrl endp

; ---------------------------------------------------------------------------
		align 4
$LN18_0		dd offset $LN4_0	; DATA XREF: _pkey_gost_mac_ctrl+26r
		dd offset $LN7		; jump table for switch	statement
		dd offset $LN8
		dd offset $LN10_0
		dd offset $LN6
		dd offset $LN2
$LN16_1		db	0,     5,     1,     1 ; DATA XREF: _pkey_gost_mac_ctrl+1Fr
		db	1,     2,     3,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	4
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_ctrl_str	proc near	; DATA XREF: _register_pmeth_gost+38o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		mov	ecx, [esp+4+arg_4]
		mov	edx, offset ??_C@_03ICHNJLJF@key?$AA@ ;	`string'
		push	ebx
		mov	eax, ecx
		push	esi

loc_9CB:				; CODE XREF: _pkey_gost_mac_ctrl_str+31j
		mov	bl, [eax]
		cmp	bl, [edx]
		jnz	short loc_9EB
		test	bl, bl
		jz	short loc_9E7
		mov	bl, [eax+1]
		cmp	bl, [edx+1]
		jnz	short loc_9EB
		add	eax, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_9CB

loc_9E7:				; CODE XREF: _pkey_gost_mac_ctrl_str+1Fj
		xor	eax, eax
		jmp	short loc_9F0
; ---------------------------------------------------------------------------

loc_9EB:				; CODE XREF: _pkey_gost_mac_ctrl_str+1Bj
					; _pkey_gost_mac_ctrl_str+27j
		sbb	eax, eax
		or	eax, 1

loc_9F0:				; CODE XREF: _pkey_gost_mac_ctrl_str+35j
		test	eax, eax
		jnz	short loc_A5B
		mov	esi, [esp+0Ch+arg_8]
		mov	ecx, esi
		lea	edx, [ecx+1]
		nop	dword ptr [eax+00000000h]

loc_A04:				; CODE XREF: _pkey_gost_mac_ctrl_str+55j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_A04
		sub	ecx, edx
		cmp	ecx, 20h ; ' '
		jz	short loc_A31
		push	1F7h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	6Fh ; 'o'
		push	81h ; 'Å'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_A31:				; CODE XREF: _pkey_gost_mac_ctrl_str+5Cj
		push	[esp+0Ch+arg_0]
		call	_EVP_PKEY_CTX_get_data
		movups	xmm0, xmmword ptr [esi]
		add	esp, 4
		movups	xmmword	ptr [eax+8], xmm0
		movups	xmm0, xmmword ptr [esi+10h]
		pop	esi
		mov	dword ptr [eax], 1
		movups	xmmword	ptr [eax+18h], xmm0
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_A5B:				; CODE XREF: _pkey_gost_mac_ctrl_str+3Ej
		mov	eax, offset ??_C@_06BHJHKMJC@hexkey?$AA@ ; "hexkey"
		nop	dword ptr [eax+00h]

loc_A64:				; CODE XREF: _pkey_gost_mac_ctrl_str+CAj
		mov	dl, [ecx]
		cmp	dl, [eax]
		jnz	short loc_A84
		test	dl, dl
		jz	short loc_A80
		mov	dl, [ecx+1]
		cmp	dl, [eax+1]
		jnz	short loc_A84
		add	ecx, 2
		add	eax, 2
		test	dl, dl
		jnz	short loc_A64

loc_A80:				; CODE XREF: _pkey_gost_mac_ctrl_str+B8j
		xor	eax, eax
		jmp	short loc_A89
; ---------------------------------------------------------------------------

loc_A84:				; CODE XREF: _pkey_gost_mac_ctrl_str+B4j
					; _pkey_gost_mac_ctrl_str+C0j
		sbb	eax, eax
		or	eax, 1

loc_A89:				; CODE XREF: _pkey_gost_mac_ctrl_str+CEj
		test	eax, eax
		jnz	short loc_B00
		lea	eax, [esp+0Ch+var_4]
		push	eax
		push	[esp+10h+arg_8]
		call	_string_to_hex
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_ADB
		cmp	[esp+0Ch+var_4], 20h ; ' '
		jnz	short loc_ADB
		push	[esp+0Ch+arg_0]
		call	_EVP_PKEY_CTX_get_data
		movups	xmm0, xmmword ptr [esi]
		push	esi
		movups	xmmword	ptr [eax+8], xmm0
		movups	xmm0, xmmword ptr [esi+10h]
		mov	dword ptr [eax], 1
		movups	xmmword	ptr [eax+18h], xmm0
		call	_CRYPTO_free
		add	esp, 8
		mov	eax, 1
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_ADB:				; CODE XREF: _pkey_gost_mac_ctrl_str+EEj
					; _pkey_gost_mac_ctrl_str+F5j
		push	203h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	6Fh ; 'o'
		push	81h ; 'Å'
		call	_ERR_GOST_error
		push	esi
		call	_CRYPTO_free
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_B00:				; CODE XREF: _pkey_gost_mac_ctrl_str+D7j
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebx
		pop	ecx
		retn
_pkey_gost_mac_ctrl_str	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B0Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_init proc near		; DATA XREF: _register_pmeth_gost+66o

arg_0		= dword	ptr  4

		push	19Ah
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	28h ; '('
		call	_CRYPTO_malloc
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_B25
		retn
; ---------------------------------------------------------------------------

loc_B25:				; CODE XREF: _pkey_gost_mac_init+16j
		xorps	xmm0, xmm0
		push	eax
		push	[esp+4+arg_0]
		movups	xmmword	ptr [eax], xmm0
		movups	xmmword	ptr [eax+10h], xmm0
		movq	qword ptr [eax+20h], xmm0
		call	_EVP_PKEY_CTX_set_data
		add	esp, 8
		mov	eax, 1
		retn
_pkey_gost_mac_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B48h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_keygen proc near		; DATA XREF: _register_pmeth_gost+59o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_0]
		call	_EVP_PKEY_CTX_get_data
		mov	esi, eax
		add	esp, 4
		cmp	dword ptr [esi], 0
		jnz	short loc_B79
		push	214h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	74h ; 't'
		push	82h ; 'Ç'
		call	_ERR_GOST_error
		add	esp, 10h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_B79:				; CODE XREF: _pkey_gost_mac_keygen+12j
		push	217h
		push	offset ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ ; ".\\engines\\ccgost\\gost_pmeth.c"
		push	20h ; ' '
		call	_CRYPTO_malloc
		movups	xmm0, xmmword ptr [esi+8]
		push	eax
		push	32Fh
		push	[esp+18h+arg_4]
		movups	xmmword	ptr [eax], xmm0
		movups	xmm0, xmmword ptr [esi+18h]
		movups	xmmword	ptr [eax+10h], xmm0
		call	_EVP_PKEY_assign
		add	esp, 18h
		mov	eax, 1
		pop	esi
		retn
_pkey_gost_mac_keygen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BB4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_signctx proc near	; DATA XREF: _register_pmeth_gost+48o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_8]
		mov	eax, [esi]
		mov	[esp+4+arg_8], eax
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jnz	short loc_BD4
		mov	dword ptr [esi], 4
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_BD4:				; CODE XREF: _pkey_gost_mac_signctx+11j
		lea	ecx, [esp+4+arg_8]
		push	ecx
		push	eax
		push	[esp+0Ch+arg_C]
		call	_EVP_DigestFinal_ex
		mov	ecx, [esp+10h+arg_8]
		add	esp, 0Ch
		mov	[esi], ecx
		pop	esi
		retn
_pkey_gost_mac_signctx endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BF0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_mac_signctx_init proc near	; DATA XREF: _register_pmeth_gost+4Do
		mov	eax, 1
		retn
_pkey_gost_mac_signctx_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BF8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_pkey_gost_paramgen_init proc near	; DATA XREF: _register_pmeth_gost:loc_D79o
		mov	eax, 1
		retn
_pkey_gost_paramgen_init endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0C00h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _register_pmeth_gost
_register_pmeth_gost proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		push	[esp+8+arg_8]
		mov	edi, [esp+0Ch+arg_0]
		push	edi
		call	_EVP_PKEY_meth_new
		mov	esi, [esp+10h+arg_4]
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_C22

loc_C1D:				; CODE XREF: _register_pmeth_gost+36j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_C22:				; CODE XREF: _register_pmeth_gost+1Bj
		sub	edi, 32Bh
		jz	loc_D07
		sub	edi, 1
		jz	short loc_C93
		sub	edi, 3
		jnz	short loc_C1D
		push	offset _pkey_gost_mac_ctrl_str
		push	offset _pkey_gost_mac_ctrl
		push	eax
		call	_EVP_PKEY_meth_set_ctrl
		push	offset _pkey_gost_mac_signctx
		push	offset _pkey_gost_mac_signctx_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_signctx
		push	offset _pkey_gost_mac_keygen
		push	edi
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_keygen
		push	offset _pkey_gost_mac_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_init
		push	offset _pkey_gost_mac_cleanup
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_cleanup
		push	offset _pkey_gost_mac_copy
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_copy
		add	esp, 3Ch
		lea	eax, [edi+1]
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_C93:				; CODE XREF: _register_pmeth_gost+31j
		push	offset _pkey_gost_ctrl94_str
		push	offset _pkey_gost_ctrl
		push	eax
		call	_EVP_PKEY_meth_set_ctrl
		push	offset _pkey_gost94cp_keygen
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_keygen
		push	offset _pkey_gost94_cp_sign
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_sign
		push	offset _pkey_gost94_cp_verify
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_verify
		push	offset _pkey_GOST94cp_encrypt
		push	offset _pkey_gost_encrypt_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_encrypt
		push	offset _pkey_GOST94cp_decrypt
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_decrypt
		add	esp, 48h
		push	offset _pkey_gost94_derive
		push	offset _pkey_gost_derive_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_derive
		push	offset _pkey_gost94_paramgen
		jmp	short loc_D79
; ---------------------------------------------------------------------------

loc_D07:				; CODE XREF: _register_pmeth_gost+28j
		push	offset _pkey_gost_ctrl01_str
		push	offset _pkey_gost_ctrl
		push	eax
		call	_EVP_PKEY_meth_set_ctrl
		push	offset _pkey_gost01_cp_sign
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_sign
		push	offset _pkey_gost01_cp_verify
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_verify
		push	offset _pkey_gost01cp_keygen
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_keygen
		push	offset _pkey_GOST01cp_encrypt
		push	offset _pkey_gost_encrypt_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_encrypt
		push	offset _pkey_GOST01cp_decrypt
		push	0
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_decrypt
		add	esp, 48h
		push	offset _pkey_gost2001_derive
		push	offset _pkey_gost_derive_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_derive
		push	offset _pkey_gost01_paramgen

loc_D79:				; CODE XREF: _register_pmeth_gost+105j
		push	offset _pkey_gost_paramgen_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_paramgen
		add	esp, 18h
		push	offset _pkey_gost_init
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_init
		push	offset _pkey_gost_cleanup
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_cleanup
		push	offset _pkey_gost_copy
		push	dword ptr [esi]
		call	_EVP_PKEY_meth_set_copy
		add	esp, 18h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
_register_pmeth_gost endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DB8h
; COMDAT (pick any)
		public ??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@
; `string'
??_C@_0BO@PHELJFFG@?4?2engines?2ccgost?2gost_pmeth?4c?$AA@ db '.\engines\ccgost\gost_pmeth.c',0
					; DATA XREF: _pkey_gost01_paramgen+19o
					; _pkey_gost94_paramgen+19o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DD8h
; COMDAT (pick any)
		public ??_C@_08FACMJMOL@paramset?$AA@
; `string'
??_C@_08FACMJMOL@paramset?$AA@ db 'paramset',0 ; DATA XREF: _pkey_gost_ctrl01_str+4o
					; _pkey_gost_ctrl94_str+4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DE4h
; COMDAT (pick any)
		public ??_C@_03ICHNJLJF@key?$AA@
; `string'
??_C@_03ICHNJLJF@key?$AA@ dd 79656Bh	; DATA XREF: _pkey_gost_mac_ctrl_str+Eo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DE8h
; COMDAT (pick any)
		public ??_C@_06BHJHKMJC@hexkey?$AA@
; `string'
??_C@_06BHJHKMJC@hexkey?$AA@ db	'hexkey',0 ; DATA XREF: _pkey_gost_mac_ctrl_str:loc_A5Bo
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_malloc:near ; CODE XREF: _pkey_gost_ctrl+7Ep
					; _pkey_gost_init+16p ...
		extrn _CRYPTO_free:near	; CODE XREF: _pkey_gost_cleanup+17p
					; _pkey_gost_cleanup+20p ...
		extrn _OBJ_txt2nid:near	; CODE XREF: _pkey_gost_ctrl01_str+10Ap
					; _pkey_gost_ctrl94_str+10Ap
		extrn _EVP_MD_type:near	; CODE XREF: _pkey_gost_ctrl+40p
					; _pkey_gost_mac_ctrl+32p
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _pkey_gost_mac_signctx+2Ap
		extrn _EVP_PKEY_base_id:near ; CODE XREF: _pkey_gost_init+41p
		extrn _EVP_PKEY_assign:near ; CODE XREF: _pkey_gost01_paramgen+5Fp
					; _pkey_gost94_paramgen+5Fp ...
		extrn _EVP_PKEY_get0:near ; CODE XREF: _pkey_gost01_cp_sign+2Ep
					; _pkey_gost01_cp_verify+2Fp ...
		extrn _EVP_PKEY_meth_new:near ;	CODE XREF: _register_pmeth_gost+Bp
		extrn _EVP_PKEY_CTX_set_data:near ; CODE XREF: _pkey_gost_init+82p
					; _pkey_gost_mac_copy+2Dp ...
		extrn _EVP_PKEY_CTX_get_data:near ; CODE XREF: _pkey_gost01_paramgen+5p
					; _pkey_gost94_paramgen+5p ...
		extrn _EVP_PKEY_CTX_get0_pkey:near ; CODE XREF:	_pkey_gost01_cp_sign+5p
					; _pkey_gost01_cp_verify+9p ...
		extrn _EVP_PKEY_meth_set_init:near ; CODE XREF:	_register_pmeth_gost+6Dp
					; _register_pmeth_gost+18Fp
		extrn _EVP_PKEY_meth_set_copy:near ; CODE XREF:	_register_pmeth_gost+85p
					; _register_pmeth_gost+1A7p
		extrn _EVP_PKEY_meth_set_cleanup:near ;	CODE XREF: _register_pmeth_gost+79p
					; _register_pmeth_gost+19Bp
		extrn _EVP_PKEY_meth_set_paramgen:near
					; CODE XREF: _register_pmeth_gost+180p
		extrn _EVP_PKEY_meth_set_keygen:near ; CODE XREF: _register_pmeth_gost+61p
					; _register_pmeth_gost+ACp ...
		extrn _EVP_PKEY_meth_set_sign:near ; CODE XREF:	_register_pmeth_gost+BAp
					; _register_pmeth_gost+120p
		extrn _EVP_PKEY_meth_set_verify:near ; CODE XREF: _register_pmeth_gost+C8p
					; _register_pmeth_gost+12Ep
		extrn _EVP_PKEY_meth_set_signctx:near ;	CODE XREF: _register_pmeth_gost+54p
		extrn _EVP_PKEY_meth_set_encrypt:near ;	CODE XREF: _register_pmeth_gost+D9p
					; _register_pmeth_gost+14Dp
		extrn _EVP_PKEY_meth_set_decrypt:near ;	CODE XREF: _register_pmeth_gost+E7p
					; _register_pmeth_gost+15Bp
		extrn _EVP_PKEY_meth_set_derive:near ; CODE XREF: _register_pmeth_gost+FBp
					; _register_pmeth_gost+16Fp
		extrn _EVP_PKEY_meth_set_ctrl:near ; CODE XREF:	_register_pmeth_gost+43p
					; _register_pmeth_gost+9Ep ...
		extrn _EC_GROUP_get_curve_name:near ; CODE XREF: _pkey_gost_init+73p
		extrn _EC_KEY_new:near	; CODE XREF: _pkey_gost01_paramgen+32p
		extrn _EC_KEY_free:near	; CODE XREF: _pkey_gost01_paramgen+49p
		extrn _EC_KEY_get0_group:near ;	CODE XREF: _pkey_gost_init+6Dp
		extrn _DSA_SIG_free:near ; CODE	XREF: _pkey_gost01_cp_verify+49p
					; _pkey_gost94_cp_verify+49p
		extrn _DSA_new:near	; CODE XREF: _pkey_gost94_paramgen+32p
		extrn _DSA_free:near	; CODE XREF: _pkey_gost94_paramgen+49p
		extrn _string_to_hex:near ; CODE XREF: _pkey_gost_mac_ctrl_str+E2p
; int __cdecl _toupper(int C)
		extrn __imp__toupper:near ; CODE XREF: _pkey_gost_ctrl01_str+63p
					; _pkey_gost_ctrl01_str+D8p ...
		extrn _pkey_GOST94cp_encrypt:near ; DATA XREF: _register_pmeth_gost+CDo
		extrn _pkey_GOST94cp_decrypt:near ; DATA XREF: _register_pmeth_gost+DEo
		extrn _pkey_GOST01cp_encrypt:near ; DATA XREF: _register_pmeth_gost+141o
		extrn _pkey_GOST01cp_decrypt:near ; DATA XREF: _register_pmeth_gost+152o
		extrn _pkey_gost2001_derive:near ; DATA	XREF: _register_pmeth_gost+163o
		extrn _pkey_gost94_derive:near ; DATA XREF: _register_pmeth_gost+EFo
		extrn _fill_GOST94_params:near ; CODE XREF: _pkey_gost94_paramgen+3Cp
		extrn _fill_GOST2001_params:near ; CODE	XREF: _pkey_gost01_paramgen+3Cp
		extrn _gost_sign_keygen:near ; CODE XREF: _pkey_gost94cp_keygen+1Fp
		extrn _gost2001_keygen:near ; CODE XREF: _pkey_gost01cp_keygen+1Fp
		extrn _gost_do_sign:near ; CODE	XREF: _pkey_gost94_cp_sign+3Cp
		extrn _gost2001_do_sign:near ; CODE XREF: _pkey_gost01_cp_sign+3Cp
		extrn _gost_do_verify:near ; CODE XREF:	_pkey_gost94_cp_verify+3Ep
		extrn _gost2001_do_verify:near ; CODE XREF: _pkey_gost01_cp_verify+3Ep
		extrn _pack_sign_cp:near ; CODE	XREF: _pkey_gost01_cp_sign+50p
					; _pkey_gost94_cp_sign+50p
		extrn _unpack_cp_signature:near	; CODE XREF: _pkey_gost01_cp_verify+18p
					; _pkey_gost94_cp_verify+18p
		extrn _gost94_nid_by_params:near ; CODE	XREF: _pkey_gost_init+5Cp
		extrn _ERR_GOST_error:near ; CODE XREF:	_pkey_gost01_paramgen+25p
					; _pkey_gost94_paramgen+25p ...
		extrn __chkstk:near	; CODE XREF: _pkey_gost_mac_ctrl_str+5p
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _pkey_gost_ctrl+8Cp
		extrn _R3410_paramset:near ; DATA XREF:	_pkey_gost_ctrl94_str+105o
					; _pkey_gost_ctrl94_str+118r
		extrn _R3410_2001_paramset:near	; DATA XREF: _pkey_gost_ctrl01_str+105o
					; _pkey_gost_ctrl01_str+118r


		end
