;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	FE2FC6B5A648F0D594ABF6EF7E93DFD1
; Input	CRC32 :	E9DD41A5

; File Name   :	C:\compspace\Diff\openssl\obj\v3_pcons.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _POLICY_CONSTRAINTS_it
_POLICY_CONSTRAINTS_it proc near	; DATA XREF: .rdata:000001BCo
		mov	eax, offset ?local_it@?1??POLICY_CONSTRAINTS_it@@9@9 ; `POLICY_CONSTRAINTS_it'::`2'::local_it
		retn
_POLICY_CONSTRAINTS_it endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_i2v_POLICY_CONSTRAINTS	proc near	; DATA XREF: .rdata:000001D8o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		lea	eax, [esp+4+arg_8]
		push	eax
		push	dword ptr [esi]
		push	offset ??_C@_0BI@HNCHDEDI@Require?5Explicit?5Policy?$AA@ ; "Require Explicit Policy"
		call	_X509V3_add_value_int
		lea	eax, [esp+10h+arg_8]
		push	eax
		push	dword ptr [esi+4]
		push	offset ??_C@_0BH@HMKHOMED@Inhibit?5Policy?5Mapping?$AA@	; "Inhibit Policy Mapping"
		call	_X509V3_add_value_int
		mov	eax, [esp+1Ch+arg_8]
		add	esp, 18h
		pop	esi
		retn
_i2v_POLICY_CONSTRAINTS	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_v2i_POLICY_CONSTRAINTS	proc near	; DATA XREF: .rdata:000001DCo

var_4		= dword	ptr -4
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		push	offset ?local_it@?1??POLICY_CONSTRAINTS_it@@9@9	; `POLICY_CONSTRAINTS_it'::`2'::local_it
		call	_ASN1_item_new
		add	esp, 4
		mov	[esp+4+var_4], eax
		test	eax, eax
		jnz	short loc_76
		push	70h ; 'p'
		push	offset ??_C@_0BL@OKPDPLFL@?4?2crypto?2x509v3?2v3_pcons?4c?$AA@ ; ".\\crypto\\x509v3\\v3_pcons.c"
		push	41h ; 'A'
		push	92h ; '’'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_76:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+1Cj
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	ebp
		push	esi
		push	edi
		push	ebx
		xor	edi, edi
		call	_sk_num
		add	esp, 4

loc_89:					; DATA XREF: .rdata:_POLICY_CONSTRAINTS_seq_tto
					; .rdata:00000200o
		test	eax, eax
		jle	loc_134

loc_91:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+F2j
		push	edi
		push	ebx
		call	_sk_value
		mov	ebp, eax
		add	esp, 8
		mov	esi, offset ??_C@_0BG@HGJBEKFE@requireExplicitPolicy?$AA@ ; "requireExplicitPolicy"
		mov	ecx, [ebp+4]
		mov	edx, ecx
		nop	dword ptr [eax+eax+00h]

loc_AC:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+8Aj
		mov	bl, [edx]
		cmp	bl, [esi]
		jnz	short loc_CC
		test	bl, bl
		jz	short loc_C8
		mov	al, [edx+1]
		cmp	al, [esi+1]
		jnz	short loc_CC
		add	edx, 2
		add	esi, 2
		test	al, al
		jnz	short loc_AC

loc_C8:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+78j
		xor	eax, eax
		jmp	short loc_D1
; ---------------------------------------------------------------------------

loc_CC:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+74j
					; _v2i_POLICY_CONSTRAINTS+80j
		sbb	eax, eax
		or	eax, 1

loc_D1:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+8Ej
		test	eax, eax
		jnz	short loc_DB
		push	[esp+14h+var_4]
		jmp	short loc_111
; ---------------------------------------------------------------------------

loc_DB:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+97j
		mov	eax, offset ??_C@_0BF@MOMLJGAL@inhibitPolicyMapping?$AA@ ; "inhibitPolicyMapping"

loc_E0:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+BEj
		mov	dl, [ecx]
		cmp	dl, [eax]
		jnz	short loc_100
		test	dl, dl
		jz	short loc_FC
		mov	dl, [ecx+1]
		cmp	dl, [eax+1]
		jnz	short loc_100
		add	ecx, 2
		add	eax, 2
		test	dl, dl
		jnz	short loc_E0

loc_FC:					; CODE XREF: _v2i_POLICY_CONSTRAINTS+ACj
		xor	eax, eax
		jmp	short loc_105
; ---------------------------------------------------------------------------

loc_100:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+A8j
					; _v2i_POLICY_CONSTRAINTS+B4j
		sbb	eax, eax
		or	eax, 1

loc_105:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+C2j
		test	eax, eax
		jnz	short loc_17A
		mov	eax, [esp+14h+var_4]
		add	eax, 4
		push	eax

loc_111:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+9Dj
		push	ebp
		call	_X509V3_get_value_int
		add	esp, 8
		test	eax, eax
		jz	short $err$43
		mov	ebx, [esp+14h+arg_8]
		inc	edi
		push	ebx
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	loc_91

loc_134:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+4Fj
		mov	eax, [esp+14h+var_4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_174
		cmp	dword ptr [eax], 0
		jnz	short loc_174
		push	83h ; 'ƒ'
		push	offset ??_C@_0BL@OKPDPLFL@?4?2crypto?2x509v3?2v3_pcons?4c?$AA@ ; ".\\crypto\\x509v3\\v3_pcons.c"
		push	97h ; '—'
		push	92h ; '’'
		push	22h ; '"'
		call	_ERR_put_error
		add	esp, 14h

$err$43:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+E0j
					; _v2i_POLICY_CONSTRAINTS+175j
		push	offset ?local_it@?1??POLICY_CONSTRAINTS_it@@9@9	; `POLICY_CONSTRAINTS_it'::`2'::local_it
		push	[esp+18h+var_4]
		call	_ASN1_item_free
		add	esp, 8
		xor	eax, eax

loc_174:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+100j
					; _v2i_POLICY_CONSTRAINTS+105j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_17A:				; CODE XREF: _v2i_POLICY_CONSTRAINTS+CBj
		push	7Ch ; '|'
		push	offset ??_C@_0BL@OKPDPLFL@?4?2crypto?2x509v3?2v3_pcons?4c?$AA@ ; ".\\crypto\\x509v3\\v3_pcons.c"
		push	6Ah ; 'j'
		push	92h ; '’'
		push	22h ; '"'
		call	_ERR_put_error

loc_18F:				; DATA XREF: .rdata:_v3_policy_constraintso
		push	dword ptr [ebp+8]
		push	offset ??_C@_07BDICHDDB@?0value?3?$AA@ ; ",value:"
		push	dword ptr [ebp+4]
		push	offset ??_C@_06FONLLLNC@?0name?3?$AA@ ;	",name:"
		push	dword ptr [ebp+0]
		push	offset ??_C@_08PCLJGJAL@section?3?$AA@ ; "section:"
		push	6
		call	_ERR_add_error_data
		add	esp, 30h
		jmp	short $err$43
_v2i_POLICY_CONSTRAINTS	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B4h
		public _v3_policy_constraints
_v3_policy_constraints dd offset loc_18F+2
		dd 0
		dd offset _POLICY_CONSTRAINTS_it
		dd 6 dup(0)
		dd offset _i2v_POLICY_CONSTRAINTS
		dd offset _v2i_POLICY_CONSTRAINTS
		dd 3 dup(0)
_POLICY_CONSTRAINTS_seq_tt dd offset loc_89 ; DATA XREF: .rdata:0000021Co
		dd 2 dup(0)
		dd offset ??_C@_0BG@HGJBEKFE@requireExplicitPolicy?$AA@	; "requireExplicitPolicy"
		dd offset _ASN1_INTEGER_it
		dd offset loc_89
		dd 1, 4
		dd offset ??_C@_0BF@MOMLJGAL@inhibitPolicyMapping?$AA@ ; "inhibitPolicyMapping"
		dd offset _ASN1_INTEGER_it
; `POLICY_CONSTRAINTS_it'::`2'::local_it
?local_it@?1??POLICY_CONSTRAINTS_it@@9@9 dd 1, 10h ; DATA XREF:	_POLICY_CONSTRAINTS_ito
					; _v2i_POLICY_CONSTRAINTS+Ao ...
		dd offset _POLICY_CONSTRAINTS_seq_tt
		dd 2, 0
		dd 8
		dd offset ??_C@_0BD@MMPNIEIJ@POLICY_CONSTRAINTS?$AA@ ; "POLICY_CONSTRAINTS"
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 230h
; COMDAT (pick any)
		public ??_C@_0BG@HGJBEKFE@requireExplicitPolicy?$AA@
; `string'
??_C@_0BG@HGJBEKFE@requireExplicitPolicy?$AA@ db 'requireExplicitPolicy',0
					; DATA XREF: _v2i_POLICY_CONSTRAINTS+61o
					; .rdata:000001F8o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 248h
; COMDAT (pick any)
		public ??_C@_0BF@MOMLJGAL@inhibitPolicyMapping?$AA@
; `string'
??_C@_0BF@MOMLJGAL@inhibitPolicyMapping?$AA@ db	'inhibitPolicyMapping',0
					; DATA XREF: _v2i_POLICY_CONSTRAINTS:loc_DBo
					; .rdata:0000020Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 260h
; COMDAT (pick any)
		public ??_C@_0BD@MMPNIEIJ@POLICY_CONSTRAINTS?$AA@
; `string'
??_C@_0BD@MMPNIEIJ@POLICY_CONSTRAINTS?$AA@ db 'POLICY_CONSTRAINTS',0
					; DATA XREF: .rdata:0000022Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 274h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _POLICY_CONSTRAINTS_free
_POLICY_CONSTRAINTS_free proc near

arg_0		= dword	ptr  4

		push	offset ?local_it@?1??POLICY_CONSTRAINTS_it@@9@9	; `POLICY_CONSTRAINTS_it'::`2'::local_it
		push	[esp+4+arg_0]
		call	_ASN1_item_free
		add	esp, 8
		retn
_POLICY_CONSTRAINTS_free endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 288h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _POLICY_CONSTRAINTS_new
_POLICY_CONSTRAINTS_new	proc near
		push	offset ?local_it@?1??POLICY_CONSTRAINTS_it@@9@9	; `POLICY_CONSTRAINTS_it'::`2'::local_it
		call	_ASN1_item_new
		add	esp, 4
		retn
_POLICY_CONSTRAINTS_new	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 298h
; COMDAT (pick any)
		public ??_C@_0BI@HNCHDEDI@Require?5Explicit?5Policy?$AA@
; `string'
??_C@_0BI@HNCHDEDI@Require?5Explicit?5Policy?$AA@ db 'Require Explicit Policy',0
					; DATA XREF: _i2v_POLICY_CONSTRAINTS+Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2B0h
; COMDAT (pick any)
		public ??_C@_0BH@HMKHOMED@Inhibit?5Policy?5Mapping?$AA@
; `string'
??_C@_0BH@HMKHOMED@Inhibit?5Policy?5Mapping?$AA@ db 'Inhibit Policy Mapping',0
					; DATA XREF: _i2v_POLICY_CONSTRAINTS+1Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2C8h
; COMDAT (pick any)
		public ??_C@_0BL@OKPDPLFL@?4?2crypto?2x509v3?2v3_pcons?4c?$AA@
; `string'
??_C@_0BL@OKPDPLFL@?4?2crypto?2x509v3?2v3_pcons?4c?$AA@	db '.\crypto\x509v3\v3_pcons.c',0
					; DATA XREF: _v2i_POLICY_CONSTRAINTS+20o
					; _v2i_POLICY_CONSTRAINTS+10Co	...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2E4h
; COMDAT (pick any)
		public ??_C@_07BDICHDDB@?0value?3?$AA@
; `string'
??_C@_07BDICHDDB@?0value?3?$AA@	db ',value:',0 ; DATA XREF: _v2i_POLICY_CONSTRAINTS+156o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2ECh
; COMDAT (pick any)
		public ??_C@_06FONLLLNC@?0name?3?$AA@
; `string'
??_C@_06FONLLLNC@?0name?3?$AA@ db ',name:',0 ; DATA XREF: _v2i_POLICY_CONSTRAINTS+15Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2F4h
; COMDAT (pick any)
		public ??_C@_08PCLJGJAL@section?3?$AA@
; `string'
??_C@_08PCLJGJAL@section?3?$AA@	db 'section:',0 ; DATA XREF: _v2i_POLICY_CONSTRAINTS+166o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _ASN1_INTEGER_it:near ; DATA XREF: .rdata:000001FCo
					; .rdata:00000210o
		extrn _sk_num:near	; CODE XREF: _v2i_POLICY_CONSTRAINTS+45p
					; _v2i_POLICY_CONSTRAINTS+E8p
		extrn _sk_value:near	; CODE XREF: _v2i_POLICY_CONSTRAINTS+57p
		extrn _ERR_put_error:near ; CODE XREF: _v2i_POLICY_CONSTRAINTS+2Ep
					; _v2i_POLICY_CONSTRAINTS+11Dp	...
		extrn _ERR_add_error_data:near ; CODE XREF: _v2i_POLICY_CONSTRAINTS+16Dp
		extrn _ASN1_item_new:near ; CODE XREF: _v2i_POLICY_CONSTRAINTS+Fp
					; _POLICY_CONSTRAINTS_new+5p
		extrn _ASN1_item_free:near ; CODE XREF:	_v2i_POLICY_CONSTRAINTS+12Ep
					; _POLICY_CONSTRAINTS_free+9p
		extrn _X509V3_get_value_int:near ; CODE	XREF: _v2i_POLICY_CONSTRAINTS+D6p
		extrn _X509V3_add_value_int:near ; CODE	XREF: _i2v_POLICY_CONSTRAINTS+11p
					; _i2v_POLICY_CONSTRAINTS+23p
		extrn __chkstk:near	; CODE XREF: _v2i_POLICY_CONSTRAINTS+5p


		end
