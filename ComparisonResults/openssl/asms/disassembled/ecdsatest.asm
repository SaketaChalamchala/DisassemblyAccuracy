;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	F39159822F172D766B897D1E9DCAD680
; Input	CRC32 :	7EC0CE31

; File Name   :	C:\compspace\Diff\openssl\obj\ecdsatest.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_rnd_seed	db 'string to make the random number generator think it has entropy',0
					; DATA XREF: _main+B0o
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 40h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing
_fbytes_counter	dd ?			; DATA XREF: _fbytes+Ar _fbytes+26r ...
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 44h
_numbers	dd offset ??_C@_0DK@NCNEKBOG@65105677090601507605681076345635@
					; DATA XREF: _fbytes+2Br
					; "651056770906015076056810763456358567190"...
		dd offset ??_C@_0DL@KGOPFDCM@61405070670650010630650655656674@ ; "614050706706500106306506556566740556000"...
		dd offset ??_C@_0EJ@FLNFDIBO@87630010150710756750106613076167@ ; "876300101507107567501066130761671078357"...
		dd offset ??_C@_0EJ@HAMKFGAN@70000001756905664665550578175715@ ; "700000017569056646655505781757157107570"...
		dd offset ??_C@_0DL@INMOCKOC@12755521911132123000120304391871@ ; "127555219111321230001203043918714616464"...
		dd offset ??_C@_0DL@ONEOPBPB@15427255652165239857892369562652@ ; "154272556521652398578923695626526526523"...
		dd offset ??_C@_0EJ@JEBBLBHO@14564275552191153465132123000753@ ; "145642755521911534651321230007534120304"...
		dd offset ??_C@_0EJ@IDOJFJKI@17127872556521652396728578923695@ ; "171278725565216523967285789236956265265"...
_data		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 64h
; COMDAT (pick any)
		public ??_C@_0DK@NCNEKBOG@65105677090601507605681076345635@
; `string'
??_C@_0DK@NCNEKBOG@65105677090601507605681076345635@ db	'651056770906015076056810763456358567190100156695615665659',0
					; DATA XREF: .data:_numberso
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A0h
; COMDAT (pick any)
		public ??_C@_0DL@KGOPFDCM@61405070670650010630650655656674@
; `string'
??_C@_0DL@KGOPFDCM@61405070670650010630650655656674@ db	'6140507067065001063065065565667405560006161556565665656654',0
					; DATA XREF: .data:00000048o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0DCh
; COMDAT (pick any)
		public ??_C@_0EJ@FLNFDIBO@87630010150710756750106613076167@
; `string'
??_C@_0EJ@FLNFDIBO@87630010150710756750106613076167@ db	'87630010150710756750106613076167107835701067106778177671667167617'
					; DATA XREF: .data:0000004Co
		db '8726717',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 128h
; COMDAT (pick any)
		public ??_C@_0EJ@HAMKFGAN@70000001756905664665550578175715@
; `string'
??_C@_0EJ@HAMKFGAN@70000001756905664665550578175715@ db	'70000001756905664665550578175715710757050157577570577957555565715'
					; DATA XREF: .data:00000050o
		db '6756655',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 174h
; COMDAT (pick any)
		public ??_C@_0DL@INMOCKOC@12755521911132123000120304391871@
; `string'
??_C@_0DL@INMOCKOC@12755521911132123000120304391871@ db	'1275552191113212300012030439187146164646146646466749494799',0
					; DATA XREF: .data:00000054o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B0h
; COMDAT (pick any)
		public ??_C@_0DL@ONEOPBPB@15427255652165239857892369562652@
; `string'
??_C@_0DL@ONEOPBPB@15427255652165239857892369562652@ db	'1542725565216523985789236956265265265235675811949404040041',0
					; DATA XREF: .data:00000058o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1ECh
; COMDAT (pick any)
		public ??_C@_0EJ@JEBBLBHO@14564275552191153465132123000753@
; `string'
??_C@_0EJ@JEBBLBHO@14564275552191153465132123000753@ db	'14564275552191153465132123000753412030439187146164646146646466749'
					; DATA XREF: .data:0000005Co
		db '4947990',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 238h
; COMDAT (pick any)
		public ??_C@_0EJ@IDOJFJKI@17127872556521652396728578923695@
; `string'
??_C@_0EJ@IDOJFJKI@17127872556521652396728578923695@ db	'17127872556521652396728578923695626526526523567581194940404004167'
					; DATA XREF: .data:00000060o
		db '0216363',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 284h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _change_rand
_change_rand	proc near		; CODE XREF: _x9_62_tests+16p
		call	_RAND_get_rand_method
		mov	ecx, eax
		mov	dword ptr ds:_old_rand,	ecx
		test	ecx, ecx
		jnz	short loc_296
		retn
; ---------------------------------------------------------------------------

loc_296:				; CODE XREF: _change_rand+Fj
		mov	eax, [ecx]
		mov	dword ptr ds:_fake_rand, eax
		mov	eax, [ecx+8]
		mov	dword ptr ds:_fake_rand+8, eax
		mov	eax, [ecx+0Ch]
		mov	dword ptr ds:_fake_rand+0Ch, eax
		mov	eax, [ecx+14h]
		mov	dword ptr ds:_fake_rand+14h, eax
		mov	dword ptr ds:_fake_rand+4, offset _fbytes
		mov	eax, [ecx+4]
		push	offset _fake_rand
		mov	dword ptr ds:_fake_rand+10h, eax
		call	_RAND_set_rand_method
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_change_rand	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _fbytes
_fbytes		proc near		; DATA XREF: _change_rand+31o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		cmp	ds:_fbytes_counter, 8
		mov	[esp+4+var_4], 0
		jge	short loc_32A
		call	_BN_new
		mov	[esp+4+var_4], eax
		test	eax, eax
		jz	short loc_32A
		mov	eax, ds:_fbytes_counter
		push	ds:_numbers[eax*4]
		lea	eax, [esp+8+var_4]
		push	eax
		call	_BN_dec2bn
		add	esp, 8
		test	eax, eax
		jnz	short loc_32E
		push	[esp+4+var_4]
		call	_BN_free
		add	esp, 4

loc_32A:				; CODE XREF: _fbytes+18j _fbytes+24j
		xor	eax, eax
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_32E:				; CODE XREF: _fbytes+41j
		inc	ds:_fbytes_counter
		push	esi
		push	[esp+8+var_4]
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		cmp	[esp+8+arg_4], eax
		jnz	short loc_36E
		push	[esp+8+arg_0]
		push	[esp+0Ch+var_4]
		call	_BN_bn2bin
		add	esp, 8
		test	eax, eax
		jz	short loc_36E
		mov	esi, 1
		jmp	short loc_370
; ---------------------------------------------------------------------------

loc_36E:				; CODE XREF: _fbytes+75j _fbytes+89j
		xor	esi, esi

loc_370:				; CODE XREF: _fbytes+90j
		mov	eax, [esp+8+var_4]
		test	eax, eax
		jz	short loc_381
		push	eax
		call	_BN_free
		add	esp, 4

loc_381:				; CODE XREF: _fbytes+9Aj
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
_fbytes		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 388h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl main(int argc, const char	**argv,	const char **envp)
		public _main
_main		proc near

argc		= dword	ptr  4
argv		= dword	ptr  8
envp		= dword	ptr  0Ch

		push	ebp
		push	edi
		mov	ebp, 1
		push	0
		push	ebp
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BIO_new_fp
		push	offset ??_C@_0BF@CKJKJIOH@OPENSSL_DEBUG_MEMORY?$AA@ ; "OPENSSL_DEBUG_MEMORY"
		mov	edi, eax
		call	dword ptr ds:__imp__getenv
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_402
		push	esi
		push	offset ??_C@_0BF@CKJKJIOH@OPENSSL_DEBUG_MEMORY?$AA@ ; "OPENSSL_DEBUG_MEMORY"
		mov	esi, offset ??_C@_03MCADLMAF@off?$AA@ ;	`string'
		call	dword ptr ds:__imp__getenv
		add	esp, 4

loc_3C9:				; CODE XREF: _main+5Bj
		mov	cl, [eax]
		cmp	cl, [esi]
		jnz	short loc_3E9
		test	cl, cl
		jz	short loc_3E5
		mov	cl, [eax+1]
		cmp	cl, [esi+1]
		jnz	short loc_3E9
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_3C9

loc_3E5:				; CODE XREF: _main+49j
		xor	eax, eax
		jmp	short loc_3EE
; ---------------------------------------------------------------------------

loc_3E9:				; CODE XREF: _main+45j	_main+51j
		sbb	eax, eax
		or	eax, 1

loc_3EE:				; CODE XREF: _main+5Fj
		pop	esi
		test	eax, eax
		jnz	short loc_402
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	_CRYPTO_set_mem_debug_functions
		add	esp, 14h
		jmp	short loc_42A
; ---------------------------------------------------------------------------

loc_402:				; CODE XREF: _main+2Bj	_main+69j
		push	offset _CRYPTO_dbg_get_options
		push	offset _CRYPTO_dbg_set_options
		push	offset _CRYPTO_dbg_free
		push	offset _CRYPTO_dbg_realloc
		push	offset _CRYPTO_dbg_malloc
		call	_CRYPTO_set_mem_debug_functions
		push	3
		call	_CRYPTO_set_mem_debug_options
		add	esp, 18h

loc_42A:				; CODE XREF: _main+78j
		push	1
		call	_CRYPTO_mem_ctrl
		call	_ERR_load_crypto_strings
		push	40h ; '@'
		push	offset _rnd_seed ; "string to make the random number genera"...
		call	_RAND_seed
		push	edi
		call	_x9_62_tests
		add	esp, 10h
		test	eax, eax
		jz	short loc_46E
		push	edi
		call	_test_builtin
		add	esp, 4
		test	eax, eax
		jz	short loc_46E
		push	offset ??_C@_0BE@COLOMPHD@?6ECDSA?5test?5passed?6?$AA@ ; "\nECDSA test passed\n"
		push	edi
		xor	ebp, ebp
		call	_BIO_printf
		add	esp, 8
		jmp	short loc_482
; ---------------------------------------------------------------------------

loc_46E:				; CODE XREF: _main+C5j	_main+D2j
		push	offset ??_C@_0BE@NEJHNGHB@?6ECDSA?5test?5failed?6?$AA@ ; "\nECDSA test failed\n"
		push	edi
		call	_BIO_printf
		push	edi
		call	_ERR_print_errors
		add	esp, 0Ch

loc_482:				; CODE XREF: _main+E4j
		call	_CRYPTO_cleanup_all_ex_data
		push	0
		call	_ERR_remove_thread_state
		call	_ERR_free_strings
		push	edi
		call	_CRYPTO_mem_leaks
		add	esp, 8
		test	edi, edi
		jz	short loc_4A9
		push	edi
		call	_BIO_free
		add	esp, 4

loc_4A9:				; CODE XREF: _main+116j
		pop	edi
		mov	eax, ebp
		pop	ebp
		retn
_main		endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _restore_rand
_restore_rand	proc near
		push	dword ptr ds:_old_rand
		call	_RAND_set_rand_method
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_restore_rand	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _test_builtin
_test_builtin	proc near		; CODE XREF: _main+C8p

Size		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_18		= byte ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 5Ch ; '\'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+68h+arg_0]
		lea	eax, [esp+68h+var_2C]
		push	14h
		xor	ebx, ebx
		mov	[esp+6Ch+var_4C], 0
		push	eax
		xor	ebp, ebp
		mov	[esp+70h+var_58], ebx
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jle	loc_B0B
		lea	eax, [esp+68h+var_18]
		push	14h
		push	eax
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jle	loc_B0B
		push	edi
		push	offset ??_C@_0EF@MPOGHCG@?6testing?5ECDSA_sign?$CI?$CJ?5and?5ECDSA_@ ; "\ntesting ECDSA_sign() and ECDSA_verify"...
		push	esi
		call	_BIO_printf
		push	ebx
		push	ebx
		call	_EC_get_builtin_curves
		push	13Ah
		mov	[esp+80h+var_44], eax
		shl	eax, 3
		push	offset ??_C@_0BL@JOMAGLOF@?4?2crypto?2ecdsa?2ecdsatest?4c?$AA@ ; ".\\crypto\\ecdsa\\ecdsatest.c"
		push	eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 1Ch
		mov	[esp+6Ch+var_3C], edi
		test	edi, edi
		jnz	short loc_57E
		push	offset ??_C@_0O@NPENBAOL@malloc?5error?6?$AA@ ;	"malloc	error\n"
		push	esi
		call	_BIO_printf
		add	esp, 8
		xor	esi, esi
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_57E:				; CODE XREF: _test_builtin+8Fj
		push	[esp+6Ch+var_44]
		push	edi
		call	_EC_get_builtin_curves
		add	esp, 8
		test	eax, eax
		jnz	short loc_5C0
		push	offset ??_C@_0BP@NEHLHDBC@unable?5to?5get?5internal?5curves?6?$AA@ ; "unable to	get internal curves\n"
		push	esi
		call	_BIO_printf
		add	esp, 8

loc_59D:				; CODE XREF: _test_builtin+12Bj
					; _test_builtin+62Fj ...
		xor	esi, esi

loc_59F:				; CODE XREF: _test_builtin+5E2j
		push	[esp+6Ch+var_3C]
		call	_CRYPTO_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_5C0:				; CODE XREF: _test_builtin+C5j
		mov	ecx, [esp+6Ch+var_44]
		xor	eax, eax
		mov	[esp+6Ch+var_34], eax
		test	ecx, ecx
		jz	loc_AA5
		nop	word ptr [eax+eax+00h]

loc_5D8:				; CODE XREF: _test_builtin+5D7j
		mov	eax, [edi+eax*8]
		mov	[esp+6Ch+Size],	eax
		cmp	eax, 2EEh
		jz	loc_A94
		call	_EC_KEY_new
		mov	edi, eax
		test	edi, edi
		jz	short loc_59D
		push	[esp+6Ch+Size]
		call	_EC_GROUP_new_by_curve_name
		add	esp, 4
		mov	[esp+6Ch+var_50], eax
		test	eax, eax
		jz	$builtin_err$78
		push	eax
		push	edi
		call	_EC_KEY_set_group
		add	esp, 8
		test	eax, eax
		jz	$builtin_err$78
		push	[esp+6Ch+var_50]
		call	_EC_GROUP_free
		push	edi
		call	_EC_KEY_get0_group
		push	eax
		call	_EC_GROUP_get_degree
		add	esp, 0Ch
		mov	[esp+6Ch+var_48], eax
		cmp	eax, 0A0h ; ' '
		jnb	short loc_650
		push	edi
		call	_EC_KEY_free
		add	esp, 4
		jmp	loc_A8C
; ---------------------------------------------------------------------------

loc_650:				; CODE XREF: _test_builtin+178j
		push	[esp+6Ch+Size]
		call	_OBJ_nid2sn
		push	eax
		push	offset ??_C@_04PFAOODAA@?$CFs?3?5?$AA@ ; "%s: "
		push	esi
		call	_BIO_printf
		push	edi
		call	_EC_KEY_generate_key
		add	esp, 14h
		test	eax, eax
		jz	loc_AAF
		call	_EC_KEY_new
		mov	[esp+6Ch+var_4C], eax
		test	eax, eax
		jz	$builtin_err$78
		push	[esp+6Ch+Size]
		call	_EC_GROUP_new_by_curve_name
		add	esp, 4
		mov	[esp+6Ch+var_50], eax
		test	eax, eax
		jz	$builtin_err$78
		push	eax
		push	[esp+70h+var_4C]
		call	_EC_KEY_set_group
		add	esp, 8
		test	eax, eax
		jz	$builtin_err$78
		push	[esp+6Ch+var_50]
		call	_EC_GROUP_free
		push	[esp+70h+var_4C]
		call	_EC_KEY_generate_key
		add	esp, 8
		test	eax, eax
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	edi
		call	_EC_KEY_check_key
		add	esp, 1Ch
		test	eax, eax
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	edi
		call	_ECDSA_size
		push	17Dh
		push	offset ??_C@_0BL@JOMAGLOF@?4?2crypto?2ecdsa?2ecdsatest?4c?$AA@ ; ".\\crypto\\ecdsa\\ecdsatest.c"
		push	eax
		mov	[esp+94h+var_54], eax
		call	_CRYPTO_malloc
		mov	ebx, eax
		add	esp, 28h
		test	ebx, ebx
		jz	$builtin_err$78
		push	edi
		lea	eax, [esp+70h+var_54]
		push	eax
		push	ebx
		push	14h
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		push	0
		call	_ECDSA_sign
		add	esp, 18h
		test	eax, eax
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	edi
		push	[esp+88h+var_54]
		lea	eax, [esp+8Ch+var_2C]
		push	ebx
		push	14h
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 30h
		cmp	eax, 1
		jnz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	[esp+84h+var_4C]
		lea	eax, [esp+88h+var_2C]
		push	[esp+88h+var_54]
		push	ebx
		push	14h
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 30h
		cmp	eax, 1
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	edi
		push	[esp+88h+var_54]
		lea	eax, [esp+8Ch+var_18]
		push	ebx
		push	14h
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 30h
		cmp	eax, 1
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		mov	eax, [esp+84h+var_54]
		push	edi
		dec	eax
		push	eax
		push	ebx
		push	14h
		lea	eax, [esp+94h+var_2C]
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 30h
		cmp	eax, 1
		jz	loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	[esp+84h+var_54]
		lea	eax, [esp+88h+var_30]
		mov	[esp+88h+var_30], ebx
		push	eax
		push	0
		call	_d2i_ECDSA_SIG
		mov	ebp, eax
		add	esp, 24h
		test	ebp, ebp
		jz	loc_AAF
		push	dword ptr [ebp+0]
		call	_BN_num_bits
		push	dword ptr [ebp+4]
		add	eax, 7
		cdq
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		mov	[esp+74h+var_50], eax
		call	_BN_num_bits
		add	eax, 7
		add	esp, 8
		cdq
		and	edx, 7
		lea	ecx, [edx+eax]
		mov	eax, [esp+6Ch+var_48]
		add	eax, 7
		sar	ecx, 3
		shr	eax, 3
		mov	[esp+6Ch+var_38], ecx
		mov	[esp+6Ch+var_48], eax
		cmp	[esp+6Ch+var_50], eax
		ja	loc_AAF
		cmp	ecx, eax
		ja	loc_AAF
		push	1B6h
		add	eax, eax
		push	offset ??_C@_0BL@JOMAGLOF@?4?2crypto?2ecdsa?2ecdsatest?4c?$AA@ ; ".\\crypto\\ecdsa\\ecdsatest.c"
		push	eax
		mov	[esp+78h+Size],	eax
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esp+6Ch+var_58], eax
		test	eax, eax
		jz	$builtin_err$78
		push	[esp+6Ch+Size]	; Size
		push	0		; Val
		push	eax		; Dst
		call	_memset
		mov	ecx, [esp+78h+var_48]
		sub	ecx, [esp+78h+var_50]
		add	ecx, [esp+78h+var_58]
		push	ecx
		push	dword ptr [ebp+0]
		call	_BN_bn2bin
		mov	eax, [esp+80h+Size]
		sub	eax, [esp+80h+var_38]
		add	eax, [esp+80h+var_58]
		push	eax
		push	dword ptr [ebp+4]
		call	_BN_bn2bin
		mov	ecx, [esp+88h+var_58]
		xor	edx, edx
		movzx	eax, byte ptr [ecx+0Ah]
		div	[esp+88h+Size]
		mov	cl, [ecx+0Bh]
		movzx	eax, cl
		test	cl, cl
		mov	[esp+88h+Size],	1
		mov	ecx, [esp+88h+Size]
		cmovnz	ecx, eax
		movzx	eax, dl
		mov	[esp+88h+Size],	ecx
		mov	ecx, [esp+88h+var_58]
		mov	edx, [esp+88h+Size]
		add	eax, ecx
		mov	[esp+88h+var_38], eax
		xor	[eax], dl
		push	dword ptr [ebp+0]
		push	[esp+8Ch+var_48]
		push	ecx
		call	_BN_bin2bn
		add	esp, 28h
		test	eax, eax
		jz	$builtin_err$78
		push	dword ptr [ebp+4]
		mov	eax, [esp+70h+var_48]
		mov	ecx, [esp+70h+var_58]
		add	ecx, eax
		push	eax
		push	ecx
		mov	[esp+78h+var_50], ecx
		call	_BN_bin2bn
		add	esp, 0Ch
		test	eax, eax
		jz	$builtin_err$78
		lea	eax, [esp+6Ch+var_40]
		mov	[esp+6Ch+var_40], ebx
		push	eax
		push	ebp
		call	_i2d_ECDSA_SIG
		push	edi
		push	eax
		push	ebx
		mov	[esp+80h+var_54], eax
		lea	eax, [esp+80h+var_2C]
		push	14h
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 20h
		cmp	eax, 1
		jz	loc_AAF
		mov	eax, [esp+6Ch+var_38]
		mov	ecx, [esp+6Ch+Size]
		xor	[eax], cl
		push	dword ptr [ebp+0]
		push	[esp+70h+var_48]
		push	[esp+74h+var_58]
		call	_BN_bin2bn
		add	esp, 0Ch
		test	eax, eax
		jz	$builtin_err$78
		push	dword ptr [ebp+4]
		push	[esp+70h+var_48]
		push	[esp+74h+var_50]
		call	_BN_bin2bn
		add	esp, 0Ch
		test	eax, eax
		jz	$builtin_err$78
		lea	eax, [esp+6Ch+var_40]
		mov	[esp+6Ch+var_40], ebx
		push	eax
		push	ebp
		call	_i2d_ECDSA_SIG
		push	edi
		push	eax
		push	ebx
		mov	[esp+80h+var_54], eax
		lea	eax, [esp+80h+var_2C]
		push	14h
		push	eax
		push	0
		call	_ECDSA_verify
		add	esp, 20h
		cmp	eax, 1
		jnz	short loc_AAF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	esi
		call	_BIO_printf
		push	0
		push	0
		push	0Bh
		push	esi
		call	_BIO_ctrl
		push	offset ??_C@_04CFDEAMPI@?5ok?6?$AA@ ; "	ok\n"
		push	esi
		call	_BIO_printf
		call	_ERR_clear_error
		push	ebx
		call	_CRYPTO_free
		push	edi
		xor	ebx, ebx
		call	_EC_KEY_free
		push	[esp+94h+var_4C]
		call	_EC_KEY_free
		push	ebp
		mov	[esp+9Ch+var_4C], ebx
		call	_ECDSA_SIG_free
		push	[esp+9Ch+var_58]
		xor	ebp, ebp
		call	_CRYPTO_free
		add	esp, 34h
		mov	[esp+6Ch+var_58], ebx

loc_A8C:				; CODE XREF: _test_builtin+183j
		mov	edi, [esp+6Ch+var_3C]
		mov	ecx, [esp+6Ch+var_44]

loc_A94:				; CODE XREF: _test_builtin+11Cj
		mov	eax, [esp+6Ch+var_34]
		inc	eax
		mov	[esp+6Ch+var_34], eax
		cmp	eax, ecx
		jb	loc_5D8

loc_AA5:				; CODE XREF: _test_builtin+104j
		mov	esi, 1
		jmp	loc_59F
; ---------------------------------------------------------------------------

loc_AAF:				; CODE XREF: _test_builtin+1A8j
					; _test_builtin+203j ...
		push	offset ??_C@_08GKLCMPAG@?5failed?6?$AA@	; " failed\n"
		push	esi
		call	_BIO_printf
		add	esp, 8

$builtin_err$78:			; CODE XREF: _test_builtin+13Fj
					; _test_builtin+151j ...
		push	edi
		call	_EC_KEY_free
		mov	eax, [esp+70h+var_4C]
		add	esp, 4
		test	eax, eax
		jz	short loc_AD7
		push	eax
		call	_EC_KEY_free
		add	esp, 4

loc_AD7:				; CODE XREF: _test_builtin+604j
		test	ebp, ebp
		jz	short loc_AE4
		push	ebp
		call	_ECDSA_SIG_free
		add	esp, 4

loc_AE4:				; CODE XREF: _test_builtin+611j
		test	ebx, ebx
		jz	short loc_AF1
		push	ebx
		call	_CRYPTO_free
		add	esp, 4

loc_AF1:				; CODE XREF: _test_builtin+61Ej
		mov	eax, [esp+6Ch+var_58]
		test	eax, eax
		jz	loc_59D
		push	eax
		call	_CRYPTO_free
		add	esp, 4
		jmp	loc_59D
; ---------------------------------------------------------------------------

loc_B0B:				; CODE XREF: _test_builtin+3Dj
					; _test_builtin+54j
		push	offset ??_C@_0CC@MMKNEKNA@ERROR?3?5unable?5to?5get?5random?5data@ ; "ERROR: unable to get random data\n"
		push	esi
		call	_BIO_printf
		mov	ecx, [esp+70h+var_4]
		add	esp, 8
		xor	eax, eax
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
_test_builtin	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B30h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _x9_62_test_internal
_x9_62_test_internal proc near		; CODE XREF: _x9_62_tests+2Fp
					; _x9_62_tests+4Bp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_18		= byte ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		mov	eax, [esp+48h+arg_8]
		push	ebx
		push	ebp
		mov	[esp+50h+var_38], eax
		xor	ebx, ebx
		mov	eax, [esp+50h+arg_C]
		xor	ebp, ebp
		push	esi
		mov	esi, [esp+54h+arg_4]
		mov	[esp+54h+var_34], eax
		lea	eax, [esp+54h+var_30]
		push	edi
		mov	edi, [esp+58h+arg_0]
		push	eax
		mov	[esp+5Ch+var_40], 636261h
		mov	[esp+5Ch+var_3C], ebp
		mov	[esp+5Ch+var_48], ebx
		mov	[esp+5Ch+var_44], ebx
		call	_EVP_MD_CTX_init
		call	_EVP_ecdsa
		push	eax
		lea	eax, [esp+60h+var_30]
		push	eax
		call	_EVP_DigestInit
		push	3
		lea	eax, [esp+68h+var_40]
		push	eax
		lea	eax, [esp+6Ch+var_30]
		push	eax
		call	_EVP_DigestUpdate
		lea	eax, [esp+70h+var_3C]
		push	eax
		lea	eax, [esp+74h+var_18]
		push	eax
		lea	eax, [esp+78h+var_30]
		push	eax
		call	_EVP_DigestFinal
		push	esi
		call	_OBJ_nid2sn
		push	eax
		push	offset ??_C@_0N@BCJKLMKO@testing?5?$CFs?3?5?$AA@ ; "testing %s:	"
		push	edi
		call	_BIO_printf
		push	esi
		call	_EC_KEY_new_by_curve_name
		mov	esi, eax
		add	esp, 38h
		test	esi, esi
		jz	loc_CFF
		push	esi
		call	_EC_KEY_generate_key
		add	esp, 4
		test	eax, eax
		jz	loc_CFF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	edi
		call	_BIO_printf
		push	ebx
		push	ebx
		push	0Bh
		push	edi
		call	_BIO_ctrl
		push	esi
		lea	eax, [esp+74h+var_18]
		push	14h
		push	eax
		call	_ECDSA_do_sign
		mov	ebx, eax
		add	esp, 24h
		test	ebx, ebx
		jz	loc_CFF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	edi
		call	_BIO_printf
		push	ebp
		push	ebp
		push	0Bh
		push	edi
		call	_BIO_ctrl
		add	esp, 18h
		call	_BN_new
		mov	[esp+58h+var_48], eax
		test	eax, eax
		jz	loc_CFF
		call	_BN_new
		mov	[esp+58h+var_44], eax
		test	eax, eax
		jz	loc_CFF
		push	[esp+58h+var_38]
		lea	eax, [esp+5Ch+var_48]
		push	eax
		call	_BN_dec2bn
		add	esp, 8
		test	eax, eax
		jz	loc_CFF
		push	[esp+58h+var_34]
		lea	eax, [esp+5Ch+var_44]
		push	eax
		call	_BN_dec2bn
		add	esp, 8
		test	eax, eax
		jz	short loc_CFF
		push	[esp+58h+var_48]
		push	dword ptr [ebx]
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_CFF
		push	[esp+58h+var_44]
		push	dword ptr [ebx+4]
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_CFF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	edi
		call	_BIO_printf
		push	ebp
		push	ebp
		push	0Bh
		push	edi
		call	_BIO_ctrl
		push	esi
		push	ebx
		lea	eax, [esp+78h+var_18]
		push	14h
		push	eax
		call	_ECDSA_do_verify
		add	esp, 28h
		cmp	eax, 1
		jnz	short loc_CFF
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; `string'
		push	edi
		call	_BIO_printf
		push	ebp
		push	ebp
		push	0Bh
		push	edi
		call	_BIO_ctrl
		push	offset ??_C@_04CFDEAMPI@?5ok?6?$AA@ ; "	ok\n"
		push	edi
		call	_BIO_printf
		add	esp, 20h
		mov	ebp, 1
		jmp	short loc_D0D
; ---------------------------------------------------------------------------

loc_CFF:				; CODE XREF: _x9_62_test_internal+A7j
					; _x9_62_test_internal+B8j ...
		push	offset ??_C@_08GKLCMPAG@?5failed?6?$AA@	; " failed\n"
		push	edi
		call	_BIO_printf
		add	esp, 8

loc_D0D:				; CODE XREF: _x9_62_test_internal+1CDj
		test	esi, esi
		jz	short loc_D1A
		push	esi
		call	_EC_KEY_free
		add	esp, 4

loc_D1A:				; CODE XREF: _x9_62_test_internal+1DFj
		test	ebx, ebx
		jz	short loc_D27
		push	ebx
		call	_ECDSA_SIG_free
		add	esp, 4

loc_D27:				; CODE XREF: _x9_62_test_internal+1ECj
		mov	eax, [esp+58h+var_48]
		test	eax, eax
		jz	short loc_D38
		push	eax
		call	_BN_free
		add	esp, 4

loc_D38:				; CODE XREF: _x9_62_test_internal+1FDj
		mov	ecx, [esp+58h+var_44]
		test	ecx, ecx
		jz	short loc_D49
		push	ecx
		call	_BN_free
		add	esp, 4

loc_D49:				; CODE XREF: _x9_62_test_internal+20Ej
		lea	eax, [esp+58h+var_30]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+5Ch+var_4]
		add	esp, 4
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_x9_62_test_internal endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _x9_62_tests
_x9_62_tests	proc near		; CODE XREF: _main+BBp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	offset ??_C@_0BI@MAEFLNOA@some?5tests?5from?5X9?462?3?6?$AA@ ; "some tests from	X9.62:\n"
		push	esi
		xor	edi, edi
		call	_BIO_printf
		add	esp, 8
		call	_change_rand
		test	eax, eax
		jz	short $x962_err$15
		push	offset ??_C@_0DL@JGMMGIGG@57358223288881552546838949978975@ ; "573582232888815525468389499789757195156"...
		push	offset ??_C@_0DL@ILBLGFFJ@33424035364059817293934883346946@ ; "334240353640598172939348833469460041559"...
		push	199h
		push	esi
		call	_x9_62_test_internal
		add	esp, 10h
		test	eax, eax
		jz	short $x962_err$15
		push	offset ??_C@_0EJ@ODAOKGCF@32381355320979735770807877683125@ ; "323813553209797357708078776831250505931"...
		push	offset ??_C@_0EJ@MIKECHMA@30863614317516781149262254730066@ ; "308636143175167811492622547300668018854"...
		push	19Ch
		push	esi
		call	_x9_62_test_internal
		add	esp, 10h
		test	eax, eax
		jz	short $x962_err$15
		push	offset ??_C@_0DK@CCMCLDGF@30899269196580494736154166454908@ ; "308992691965804947361541664549085895292"...
		push	offset ??_C@_0DJ@HCOMLKJC@87194383164871543355722284926904@ ; "871943831648715433557222849269044199972"...
		push	2B0h
		push	esi
		call	_x9_62_test_internal
		add	esp, 10h
		test	eax, eax
		jz	short $x962_err$15
		push	offset ??_C@_0EJ@BIIJJDKI@19703037400073168673833499765499@ ; "197030374000731686738334997654997227052"...
		push	offset ??_C@_0EI@GJAGKOOP@21596333210419611985018340039034@ ; "215963332104196119850183400390346126288"...
		push	2B6h
		push	esi
		call	_x9_62_test_internal
		add	esp, 10h
		mov	ecx, 1
		test	eax, eax
		cmovnz	edi, ecx

$x962_err$15:				; CODE XREF: _x9_62_tests+1Dj
					; _x9_62_tests+39j ...
		push	dword ptr ds:_old_rand
		call	_RAND_set_rand_method
		add	esp, 4
		neg	eax
		sbb	eax, eax
		and	eax, edi
		pop	edi
		pop	esi
		retn
_x9_62_tests	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E18h
; COMDAT (pick any)
		public ??_C@_0N@BCJKLMKO@testing?5?$CFs?3?5?$AA@
; `string'
??_C@_0N@BCJKLMKO@testing?5?$CFs?3?5?$AA@ db 'testing %s: ',0
					; DATA XREF: _x9_62_test_internal+8Fo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E28h
; COMDAT (pick any)
		public ??_C@_01LFCBOECM@?4?$AA@
; `string'
??_C@_01LFCBOECM@?4?$AA@ db 2Eh, 0	; DATA XREF: _test_builtin+209o
					; _test_builtin+231o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E2Ch
; COMDAT (pick any)
		public ??_C@_04CFDEAMPI@?5ok?6?$AA@
; `string'
??_C@_04CFDEAMPI@?5ok?6?$AA@ db	' ok',0Ah,0 ; DATA XREF: _test_builtin+581o
					; _x9_62_test_internal+1BAo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E34h
; COMDAT (pick any)
		public ??_C@_08GKLCMPAG@?5failed?6?$AA@
; `string'
??_C@_08GKLCMPAG@?5failed?6?$AA@ db ' failed',0Ah,0 ; DATA XREF: _test_builtin:loc_AAFo
					; _x9_62_test_internal:loc_CFFo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E40h
; COMDAT (pick any)
		public ??_C@_0BI@MAEFLNOA@some?5tests?5from?5X9?462?3?6?$AA@
; `string'
??_C@_0BI@MAEFLNOA@some?5tests?5from?5X9?462?3?6?$AA@ db 'some tests from X9.62:',0Ah,0
					; DATA XREF: _x9_62_tests+6o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E58h
; COMDAT (pick any)
		public ??_C@_0DL@JGMMGIGG@57358223288881552546838949978975@
; `string'
??_C@_0DL@JGMMGIGG@57358223288881552546838949978975@ db	'5735822328888155254683894997897571951568553642892029982342',0
					; DATA XREF: _x9_62_tests+1Fo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E94h
; COMDAT (pick any)
		public ??_C@_0DL@ILBLGFFJ@33424035364059817293934883346946@
; `string'
??_C@_0DL@ILBLGFFJ@33424035364059817293934883346946@ db	'3342403536405981729393488334694600415596881826869351677613',0
					; DATA XREF: _x9_62_tests+24o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0ED0h
; COMDAT (pick any)
		public ??_C@_0EJ@ODAOKGCF@32381355320979735770807877683125@
; `string'
??_C@_0EJ@ODAOKGCF@32381355320979735770807877683125@ db	'32381355320979735770807877683125050593189105175500784278197850517'
					; DATA XREF: _x9_62_tests+3Bo
		db '9448783',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0F1Ch
; COMDAT (pick any)
		public ??_C@_0EJ@MIKECHMA@30863614317516781149262254730066@
; `string'
??_C@_0EJ@MIKECHMA@30863614317516781149262254730066@ db	'30863614317516781149262254730066801885495937875853177814746205830'
					; DATA XREF: _x9_62_tests+40o
		db '6432176',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F68h
; COMDAT (pick any)
		public ??_C@_0DK@CCMCLDGF@30899269196580494736154166454908@
; `string'
??_C@_0DK@CCMCLDGF@30899269196580494736154166454908@ db	'308992691965804947361541664549085895292153777025772063598',0
					; DATA XREF: _x9_62_tests+57o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0FA4h
; COMDAT (pick any)
		public ??_C@_0DJ@HCOMLKJC@87194383164871543355722284926904@
; `string'
??_C@_0DJ@HCOMLKJC@87194383164871543355722284926904@ db	'87194383164871543355722284926904419997237591535066528048',0
					; DATA XREF: _x9_62_tests+5Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0FE0h
; COMDAT (pick any)
		public ??_C@_0EJ@BIIJJDKI@19703037400073168673833499765499@
; `string'
??_C@_0EJ@BIIJJDKI@19703037400073168673833499765499@ db	'19703037400073168673833499765499722705284980407219881910264941346'
					; DATA XREF: _x9_62_tests+73o
		db '5737174',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 102Ch
; COMDAT (pick any)
		public ??_C@_0EI@GJAGKOOP@21596333210419611985018340039034@
; `string'
??_C@_0EI@GJAGKOOP@21596333210419611985018340039034@ db	'21596333210419611985018340039034612628818151486841789642455876922'
					; DATA XREF: _x9_62_tests+78o
		db '391552',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1074h
; COMDAT (pick any)
		public ??_C@_0CC@MMKNEKNA@ERROR?3?5unable?5to?5get?5random?5data@
; `string'
??_C@_0CC@MMKNEKNA@ERROR?3?5unable?5to?5get?5random?5data@ db 'ERROR: unable to get random data',0Ah,0
					; DATA XREF: _test_builtin:loc_B0Bo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1098h
; COMDAT (pick any)
		public ??_C@_0EF@MPOGHCG@?6testing?5ECDSA_sign?$CI?$CJ?5and?5ECDSA_@
; `string'
??_C@_0EF@MPOGHCG@?6testing?5ECDSA_sign?$CI?$CJ?5and?5ECDSA_@ db 0Ah
					; DATA XREF: _test_builtin+5Bo
		db 'testing ECDSA_sign() and ECDSA_verify() with some internal curves'
		db ':',0Ah,0
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10E0h
; COMDAT (pick any)
		public ??_C@_0BL@JOMAGLOF@?4?2crypto?2ecdsa?2ecdsatest?4c?$AA@
; `string'
??_C@_0BL@JOMAGLOF@?4?2crypto?2ecdsa?2ecdsatest?4c?$AA@	db '.\crypto\ecdsa\ecdsatest.c',0
					; DATA XREF: _test_builtin+79o
					; _test_builtin+253o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10FCh
; COMDAT (pick any)
		public ??_C@_0O@NPENBAOL@malloc?5error?6?$AA@
; `string'
??_C@_0O@NPENBAOL@malloc?5error?6?$AA@ db 'malloc error',0Ah,0
					; DATA XREF: _test_builtin+91o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 110Ch
; COMDAT (pick any)
		public ??_C@_0BP@NEHLHDBC@unable?5to?5get?5internal?5curves?6?$AA@
; `string'
??_C@_0BP@NEHLHDBC@unable?5to?5get?5internal?5curves?6?$AA@ db 'unable to get internal curves',0Ah,0
					; DATA XREF: _test_builtin+C7o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 112Ch
; COMDAT (pick any)
		public ??_C@_04PFAOODAA@?$CFs?3?5?$AA@
; `string'
??_C@_04PFAOODAA@?$CFs?3?5?$AA@	db '%s: ',0 ; DATA XREF: _test_builtin+192o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1134h
; COMDAT (pick any)
		public ??_C@_0BF@CKJKJIOH@OPENSSL_DEBUG_MEMORY?$AA@
; char `string'[]
??_C@_0BF@CKJKJIOH@OPENSSL_DEBUG_MEMORY?$AA@ db	'OPENSSL_DEBUG_MEMORY',0
					; DATA XREF: _main+19o	_main+2Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 114Ch
; COMDAT (pick any)
		public ??_C@_03MCADLMAF@off?$AA@
; `string'
??_C@_03MCADLMAF@off?$AA@ dd 66666Fh	; DATA XREF: _main+33o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1150h
; COMDAT (pick any)
		public ??_C@_0BE@NEJHNGHB@?6ECDSA?5test?5failed?6?$AA@
; `string'
??_C@_0BE@NEJHNGHB@?6ECDSA?5test?5failed?6?$AA@	db 0Ah ; DATA XREF: _main:loc_46Eo
		db 'ECDSA test failed',0Ah,0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1164h
; COMDAT (pick any)
		public ??_C@_0BE@COLOMPHD@?6ECDSA?5test?5passed?6?$AA@
; `string'
??_C@_0BE@COLOMPHD@?6ECDSA?5test?5passed?6?$AA@	db 0Ah ; DATA XREF: _main+D4o
		db 'ECDSA test passed',0Ah,0
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _fake_rand:near	; DATA XREF: _change_rand+14w
					; _change_rand+1Cw ...
		extrn _old_rand:near	; DATA XREF: _change_rand+7w
					; _restore_randr ...
		extrn __imp____acrt_iob_func:near ; CODE XREF: _main+Ap
					; DATA XREF: _main+Ar
; char *__cdecl	_getenv(const char *VarName)
		extrn __imp__getenv:near ; CODE	XREF: _main+20p _main+38p
					; DATA XREF: ...
		extrn _CRYPTO_mem_ctrl:near ; CODE XREF: _main+A4p
		extrn _CRYPTO_cleanup_all_ex_data:near ; CODE XREF: _main:loc_482p
		extrn _CRYPTO_set_mem_debug_functions:near ; CODE XREF:	_main+70p
					; _main+93p
		extrn _CRYPTO_malloc:near ; CODE XREF: _test_builtin+7Fp
					; _test_builtin+25Dp ...
		extrn _CRYPTO_free:near	; CODE XREF: _test_builtin+DBp
					; _test_builtin+592p ...
		extrn _CRYPTO_set_mem_debug_options:near ; CODE	XREF: _main+9Ap
		extrn _CRYPTO_dbg_malloc:near ;	DATA XREF: _main+8Eo
		extrn _CRYPTO_dbg_realloc:near ; DATA XREF: _main+89o
		extrn _CRYPTO_dbg_free:near ; DATA XREF: _main+84o
		extrn _CRYPTO_dbg_set_options:near ; DATA XREF:	_main+7Fo
		extrn _CRYPTO_dbg_get_options:near ; DATA XREF:	_main:loc_402o
		extrn _CRYPTO_mem_leaks:near ; CODE XREF: _main+10Cp
		extrn _BIO_new_fp:near	; CODE XREF: _main+14p
		extrn _BIO_free:near	; CODE XREF: _main+119p
		extrn _BIO_ctrl:near	; CODE XREF: _test_builtin+21Bp
					; _test_builtin+243p ...
		extrn _BIO_printf:near	; CODE XREF: _main+DCp	_main+ECp ...
		extrn _BN_num_bits:near	; CODE XREF: _fbytes+5Dp
					; _test_builtin+3ABp ...
		extrn _BN_new:near	; CODE XREF: _fbytes+1Ap
					; _x9_62_test_internal+105p ...
		extrn _BN_bin2bn:near	; CODE XREF: _test_builtin+49Bp
					; _test_builtin+4BEp ...
		extrn _BN_bn2bin:near	; CODE XREF: _fbytes+7Fp
					; _test_builtin+43Dp ...
		extrn _BN_cmp:near	; CODE XREF: _x9_62_test_internal+15Bp
					; _x9_62_test_internal+16Ep
		extrn _BN_free:near	; CODE XREF: _fbytes+46p _fbytes+9Dp ...
		extrn _BN_dec2bn:near	; CODE XREF: _fbytes+37p
					; _x9_62_test_internal+130p ...
		extrn _OBJ_nid2sn:near	; CODE XREF: _test_builtin+18Cp
					; _x9_62_test_internal+89p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _x9_62_test_internal+4Ep
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _x9_62_test_internal+21Ep
		extrn _EVP_DigestUpdate:near ; CODE XREF: _x9_62_test_internal+6Fp
		extrn _EVP_DigestInit:near ; CODE XREF:	_x9_62_test_internal+5Ep
		extrn _EVP_DigestFinal:near ; CODE XREF: _x9_62_test_internal+83p
		extrn _EVP_ecdsa:near	; CODE XREF: _x9_62_test_internal+53p
		extrn _EC_GROUP_free:near ; CODE XREF: _test_builtin+15Bp
					; _test_builtin+1F0p
		extrn _EC_GROUP_get_degree:near	; CODE XREF: _test_builtin+167p
		extrn _EC_GROUP_new_by_curve_name:near ; CODE XREF: _test_builtin+131p
					; _test_builtin+1C3p
		extrn _EC_get_builtin_curves:near ; CODE XREF: _test_builtin+68p
					; _test_builtin+BBp
		extrn _EC_KEY_new:near	; CODE XREF: _test_builtin+122p
					; _test_builtin+1AEp
		extrn _EC_KEY_new_by_curve_name:near ; CODE XREF: _x9_62_test_internal+9Bp
		extrn _EC_KEY_free:near	; CODE XREF: _test_builtin+17Bp
					; _test_builtin+59Ap ...
		extrn _EC_KEY_get0_group:near ;	CODE XREF: _test_builtin+161p
		extrn _EC_KEY_set_group:near ; CODE XREF: _test_builtin+147p
					; _test_builtin+1DCp
		extrn _EC_KEY_generate_key:near	; CODE XREF: _test_builtin+19Ep
					; _test_builtin+1F9p ...
		extrn _EC_KEY_check_key:near ; CODE XREF: _test_builtin+221p
		extrn _ECDSA_SIG_free:near ; CODE XREF:	_test_builtin+5ADp
					; _test_builtin+614p ...
		extrn _i2d_ECDSA_SIG:near ; CODE XREF: _test_builtin+4D8p
					; _test_builtin+548p
		extrn _d2i_ECDSA_SIG:near ; CODE XREF: _test_builtin+396p
		extrn _ECDSA_do_sign:near ; CODE XREF: _x9_62_test_internal+DBp
		extrn _ECDSA_do_verify:near ; CODE XREF: _x9_62_test_internal+198p
		extrn _ECDSA_size:near	; CODE XREF: _test_builtin+249p
		extrn _ECDSA_sign:near	; CODE XREF: _test_builtin+27Fp
		extrn _ECDSA_verify:near ; CODE	XREF: _test_builtin+2B5p
					; _test_builtin+2EFp ...
		extrn _RAND_set_rand_method:near ; CODE	XREF: _change_rand+48p
					; _restore_rand+6p ...
		extrn _RAND_get_rand_method:near ; CODE	XREF: _change_randp
		extrn _RAND_pseudo_bytes:near ;	CODE XREF: _test_builtin+33p
					; _test_builtin+4Ap
		extrn _RAND_seed:near	; CODE XREF: _main+B5p
		extrn _ERR_clear_error:near ; CODE XREF: _test_builtin+58Cp
		extrn _ERR_print_errors:near ; CODE XREF: _main+F2p
		extrn _ERR_load_crypto_strings:near ; CODE XREF: _main+A9p
		extrn _ERR_free_strings:near ; CODE XREF: _main+106p
		extrn _ERR_remove_thread_state:near ; CODE XREF: _main+101p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _test_builtin+ADp
					; _test_builtin+EFp ...
		extrn __chkstk:near	; CODE XREF: _fbytes+5p
					; _test_builtin+5p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _test_builtin+428p
		extrn ___security_cookie:near ;	DATA XREF: _test_builtin+Ar
					; _x9_62_test_internal+Ar


		end
