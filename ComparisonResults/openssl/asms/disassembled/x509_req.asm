;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	78C51E20078A400730DF03AA63A0BEB2
; Input	CRC32 :	B009BE29

; File Name   :	C:\compspace\Diff\openssl\obj\x509_req.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
_ext_nid_list	dd offset loc_AC	; DATA XREF: .data:_ext_nidso
		dd offset loc_AA+1
		dd 0
_ext_nids	dd offset _ext_nid_list	; DATA XREF: _X509_REQ_extension_nidr
					; _X509_REQ_get_extension_nidsr ...
_data		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add1_attr
_X509_REQ_add1_attr proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		mov	eax, [eax]
		add	eax, 18h
		push	eax
		call	_X509at_add1_attr
		add	esp, 8
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_X509_REQ_add1_attr endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add1_attr_by_NID
_X509_REQ_add1_attr_by_NID proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		mov	eax, [esp+4+arg_0]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		mov	eax, [eax]
		push	[esp+0Ch+arg_4]
		add	eax, 18h
		push	eax
		call	_X509at_add1_attr_by_NID
		add	esp, 14h
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_X509_REQ_add1_attr_by_NID endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add1_attr_by_OBJ
_X509_REQ_add1_attr_by_OBJ proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		mov	eax, [esp+4+arg_0]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		mov	eax, [eax]
		push	[esp+0Ch+arg_4]
		add	eax, 18h
		push	eax
		call	_X509at_add1_attr_by_OBJ
		add	esp, 14h
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_X509_REQ_add1_attr_by_OBJ endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 88h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add1_attr_by_txt
_X509_REQ_add1_attr_by_txt proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		mov	eax, [esp+4+arg_0]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		mov	eax, [eax]
		push	[esp+0Ch+arg_4]
		add	eax, 18h
		push	eax
		call	_X509at_add1_attr_by_txt
		add	esp, 14h

loc_AA:					; DATA XREF: .data:00000004o
		neg	eax

loc_AC:					; DATA XREF: .data:_ext_nid_listo
		sbb	eax, eax
		neg	eax
		retn
_X509_REQ_add1_attr_by_txt endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add_extensions
_X509_REQ_add_extensions proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0ACh ; '¨'
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_X509_REQ_add_extensions_nid
		add	esp, 0Ch
		retn
_X509_REQ_add_extensions endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_add_extensions_nid
_X509_REQ_add_extensions_nid proc near	; CODE XREF: _X509_REQ_add_extensions+Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		call	_ASN1_TYPE_new
		mov	esi, eax
		test	esi, esi
		jz	$err$12
		call	_ASN1_STRING_new
		mov	[esi+4], eax
		test	eax, eax
		jz	$err$12
		mov	dword ptr [esi], 10h
		call	_X509_EXTENSIONS_it
		push	eax
		mov	eax, [esi+4]
		add	eax, 8
		push	eax
		push	[esp+14h+arg_4]
		call	_ASN1_item_i2d
		mov	ecx, [esi+4]
		add	esp, 0Ch
		mov	[ecx], eax
		call	_X509_ATTRIBUTE_new
		mov	edi, eax
		test	edi, edi
		jz	short $err$12
		call	_sk_new_null
		mov	[edi+8], eax
		test	eax, eax
		jz	short $err$12
		push	esi
		push	eax
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short $err$12
		push	[esp+0Ch+arg_8]
		xor	esi, esi
		mov	[edi+4], esi
		call	_OBJ_nid2obj
		mov	ebx, [esp+10h+arg_0]
		add	esp, 4
		mov	[edi], eax
		mov	eax, [ebx]
		cmp	[eax+18h], esi
		jnz	short loc_165
		call	_sk_new_null
		mov	ecx, [ebx]
		mov	[ecx+18h], eax
		test	eax, eax
		jz	short $err$12

loc_165:				; CODE XREF: _X509_REQ_add_extensions_nid+89j
		mov	eax, [ebx]
		push	edi
		push	dword ptr [eax+18h]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short $err$12
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$err$12:				; CODE XREF: _X509_REQ_add_extensions_nid+Ej
					; _X509_REQ_add_extensions_nid+1Ej ...
		push	edi
		call	_X509_ATTRIBUTE_free
		push	esi
		call	_ASN1_TYPE_free
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		retn
_X509_REQ_add_extensions_nid endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 198h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_check_private_key
_X509_REQ_check_private_key proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		test	eax, eax
		jz	short loc_1BA
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1BA
		push	dword ptr [eax+14h]
		call	_X509_PUBKEY_get
		add	esp, 4
		mov	esi, eax
		jmp	short loc_1BC
; ---------------------------------------------------------------------------

loc_1BA:				; CODE XREF: _X509_REQ_check_private_key+Bj
					; _X509_REQ_check_private_key+11j
		xor	esi, esi

loc_1BC:				; CODE XREF: _X509_REQ_check_private_key+20j
		mov	ebx, [esp+0Ch+arg_4]
		push	ebx
		push	esi
		call	_EVP_PKEY_cmp
		add	eax, 2
		add	esp, 8
		cmp	eax, 3		; switch 4 cases
		ja	short loc_24E	; jumptable 000001D2 default case
		jmp	ds:$LN17[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _X509_REQ_check_private_key+3Aj
					; DATA XREF: .text$mn:$LN17o
		push	esi		; jumptable 000001D2 case 3
		mov	edi, 1
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _X509_REQ_check_private_key+3Aj
					; DATA XREF: .text$mn:$LN17o
		push	83h ; 'É'       ; jumptable 000001D2 case 2
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	74h ; 't'
		jmp	short loc_23F
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _X509_REQ_check_private_key+3Aj
					; DATA XREF: .text$mn:$LN17o
		push	86h ; 'Ü'       ; jumptable 000001D2 case 1
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	73h ; 's'
		jmp	short loc_23F
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _X509_REQ_check_private_key+3Aj
					; DATA XREF: .text$mn:$LN17o
		mov	eax, [ebx]	; jumptable 000001D2 case 0
		cmp	eax, 198h
		jnz	short loc_220
		push	8Bh ; 'ã'
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	10h
		jmp	short loc_23F
; ---------------------------------------------------------------------------

loc_220:				; CODE XREF: _X509_REQ_check_private_key+78j
		cmp	eax, 1Ch
		jnz	short loc_233
		push	93h ; 'ì'
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	72h ; 'r'
		jmp	short loc_23F
; ---------------------------------------------------------------------------

loc_233:				; CODE XREF: _X509_REQ_check_private_key+8Bj
		push	97h ; 'ó'
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	75h ; 'u'

loc_23F:				; CODE XREF: _X509_REQ_check_private_key+61j
					; _X509_REQ_check_private_key+6Fj ...
		push	90h ; 'ê'
		push	0Bh
		call	_ERR_put_error
		add	esp, 14h

loc_24E:				; CODE XREF: _X509_REQ_check_private_key+38j
		push	esi		; jumptable 000001D2 default case
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
_X509_REQ_check_private_key endp

; ---------------------------------------------------------------------------
		align 10h
$LN17		dd offset $LN7		; DATA XREF: _X509_REQ_check_private_key+3Ar
		dd offset $LN6		; jump table for switch	statement
		dd offset $LN5
		dd offset $LN4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 270h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_delete_attr
_X509_REQ_delete_attr proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+18h]
		call	_X509at_delete_attr
		add	esp, 8
		retn
_X509_REQ_delete_attr endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 288h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_extension_nid
_X509_REQ_extension_nid	proc near

arg_0		= dword	ptr  4

		mov	ecx, _ext_nids
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_2A6
		mov	edx, [esp+arg_0]

loc_298:				; CODE XREF: _X509_REQ_extension_nid+1Cj
		cmp	edx, eax
		jz	short loc_2A9
		mov	eax, [ecx+4]
		add	ecx, 4
		test	eax, eax
		jnz	short loc_298

loc_2A6:				; CODE XREF: _X509_REQ_extension_nid+Aj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_2A9:				; CODE XREF: _X509_REQ_extension_nid+12j
		mov	eax, 1
		retn
_X509_REQ_extension_nid	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_attr
_X509_REQ_get_attr proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	[esp+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr
		add	esp, 8
		retn
_X509_REQ_get_attr endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_attr_by_NID
_X509_REQ_get_attr_by_NID proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	[esp+arg_8]
		push	[esp+4+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr_by_NID
		add	esp, 0Ch
		retn
_X509_REQ_get_attr_by_NID endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_attr_by_OBJ
_X509_REQ_get_attr_by_OBJ proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	[esp+arg_8]
		push	[esp+4+arg_4]
		mov	eax, [eax]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr_by_OBJ
		add	esp, 0Ch
		retn
_X509_REQ_get_attr_by_OBJ endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 300h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_attr_count
_X509_REQ_get_attr_count proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr_count
		add	esp, 4
		retn
_X509_REQ_get_attr_count endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 314h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_extension_nids
_X509_REQ_get_extension_nids proc near
		mov	eax, _ext_nids
		retn
_X509_REQ_get_extension_nids endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 31Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_extensions
_X509_REQ_get_extensions proc near

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	short loc_35A
		cmp	dword ptr [edi], 0
		jz	short loc_35A
		mov	esi, _ext_nids
		test	esi, esi
		jz	short loc_35A
		cmp	dword ptr [esi], 0
		jz	short loc_35A
		xchg	ax, ax

loc_33C:				; CODE XREF: _X509_REQ_get_extensions+3Cj
		mov	eax, [edi]
		push	0FFFFFFFFh
		push	dword ptr [esi]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr_by_NID
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_35F
		add	esi, 4
		cmp	dword ptr [esi], 0
		jnz	short loc_33C

loc_35A:				; CODE XREF: _X509_REQ_get_extensions+8j
					; _X509_REQ_get_extensions+Dj ...
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_35F:				; CODE XREF: _X509_REQ_get_extensions+34j
		push	eax
		mov	eax, [edi]
		push	dword ptr [eax+18h]
		call	_X509at_get_attr
		mov	esi, eax
		add	esp, 8
		cmp	dword ptr [esi+4], 0
		jz	short loc_37A
		mov	esi, [esi+8]
		jmp	short loc_398
; ---------------------------------------------------------------------------

loc_37A:				; CODE XREF: _X509_REQ_get_extensions+57j
		push	dword ptr [esi+8]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jz	short loc_35A
		push	0
		push	dword ptr [esi+8]
		call	_sk_value
		add	esp, 8
		mov	esi, eax

loc_398:				; CODE XREF: _X509_REQ_get_extensions+5Cj
		test	esi, esi
		jz	short loc_35A
		cmp	dword ptr [esi], 10h
		jnz	short loc_35A
		mov	eax, [esi+4]
		mov	eax, [eax+8]
		mov	[esp+8+arg_0], eax
		call	_X509_EXTENSIONS_it
		push	eax
		mov	eax, [esi+4]
		push	dword ptr [eax]
		lea	eax, [esp+10h+arg_0]
		push	eax
		push	0
		call	_ASN1_item_d2i
		add	esp, 10h
		pop	edi
		pop	esi
		retn
_X509_REQ_get_extensions endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_get_pubkey
_X509_REQ_get_pubkey proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_3E2
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_3E2
		push	dword ptr [eax+14h]
		call	_X509_PUBKEY_get
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_3E2:				; CODE XREF: _X509_REQ_get_pubkey+6j
					; _X509_REQ_get_pubkey+Cj
		xor	eax, eax
		retn
_X509_REQ_get_pubkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_REQ_set_extension_nids
_X509_REQ_set_extension_nids proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	_ext_nids, eax
		retn
_X509_REQ_set_extension_nids endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _X509_to_X509_REQ
_X509_to_X509_REQ proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		call	_X509_REQ_new
		mov	edi, eax
		test	edi, edi
		jnz	short loc_426
		push	4Fh ; 'O'
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	41h ; 'A'
		push	7Eh ; '~'
		push	0Bh
		call	_ERR_put_error
		add	esp, 14h

$err$11:				; CODE XREF: _X509_to_X509_REQ+5Cj
					; _X509_to_X509_REQ+77j ...
		push	edi
		call	_X509_REQ_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_426:				; CODE XREF: _X509_to_X509_REQ+Cj
		mov	esi, [edi]
		push	56h ; 'V'
		push	offset ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ ; ".\\crypto\\x509\\x509_req.c"
		push	1
		mov	eax, [esi+0Ch]
		mov	dword ptr [eax], 1
		call	_CRYPTO_malloc
		mov	ecx, [esi+0Ch]
		add	esp, 0Ch
		mov	[ecx+8], eax
		mov	eax, [esi+0Ch]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short $err$11
		mov	esi, [esp+0Ch+arg_0]
		push	esi
		mov	byte ptr [eax],	0
		call	_X509_get_subject_name
		push	eax
		push	edi
		call	_X509_REQ_set_subject_name
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$11
		push	esi
		call	_X509_get_pubkey
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short $err$11
		push	ebx
		push	edi
		call	_X509_REQ_set_pubkey
		push	ebx
		mov	esi, eax
		call	_EVP_PKEY_free
		add	esp, 0Ch
		test	esi, esi
		jz	short $err$11
		mov	eax, [esp+0Ch+arg_4]
		test	eax, eax
		jz	short loc_4B0
		push	[esp+0Ch+arg_8]
		push	eax
		push	edi
		call	_X509_REQ_sign
		add	esp, 0Ch
		test	eax, eax
		jz	$err$11

loc_4B0:				; CODE XREF: _X509_to_X509_REQ+A4j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
_X509_to_X509_REQ endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4B8h
; COMDAT (pick any)
		public ??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@
; `string'
??_C@_0BJ@OHEHCKMH@?4?2crypto?2x509?2x509_req?4c?$AA@ db '.\crypto\x509\x509_req.c',0
					; DATA XREF: _X509_REQ_check_private_key+5Ao
					; _X509_REQ_check_private_key+68o ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _sk_num:near	; CODE XREF: _X509_REQ_get_extensions+61p
		extrn _sk_value:near	; CODE XREF: _X509_REQ_get_extensions+72p
		extrn _sk_new_null:near	; CODE XREF: _X509_REQ_add_extensions_nid+53p
					; _X509_REQ_add_extensions_nid+8Bp
		extrn _sk_push:near	; CODE XREF: _X509_REQ_add_extensions_nid+61p
					; _X509_REQ_add_extensions_nid+9Fp
		extrn _CRYPTO_malloc:near ; CODE XREF: _X509_to_X509_REQ+46p
		extrn _ERR_put_error:near ; CODE XREF: _X509_REQ_check_private_key+AEp
					; _X509_to_X509_REQ+1Bp
		extrn _ASN1_TYPE_new:near ; CODE XREF: _X509_REQ_add_extensions_nid+5p
		extrn _ASN1_TYPE_free:near ; CODE XREF:	_X509_REQ_add_extensions_nid+BBp
		extrn _ASN1_STRING_new:near ; CODE XREF: _X509_REQ_add_extensions_nid+14p
		extrn _ASN1_item_d2i:near ; CODE XREF: _X509_REQ_get_extensions+A1p
		extrn _ASN1_item_i2d:near ; CODE XREF: _X509_REQ_add_extensions_nid+3Bp
		extrn _OBJ_nid2obj:near	; CODE XREF: _X509_REQ_add_extensions_nid+76p
		extrn _EVP_PKEY_free:near ; CODE XREF: _X509_REQ_check_private_key+47p
					; _X509_REQ_check_private_key+B7p ...
		extrn _EVP_PKEY_cmp:near ; CODE	XREF: _X509_REQ_check_private_key+2Ap
		extrn _X509_REQ_sign:near ; CODE XREF: _X509_to_X509_REQ+ACp
		extrn _X509_PUBKEY_get:near ; CODE XREF: _X509_REQ_check_private_key+16p
					; _X509_REQ_get_pubkey+11p
		extrn _X509_REQ_new:near ; CODE	XREF: _X509_to_X509_REQ+3p
		extrn _X509_REQ_free:near ; CODE XREF: _X509_to_X509_REQ+24p
		extrn _X509_ATTRIBUTE_new:near ; CODE XREF: _X509_REQ_add_extensions_nid+48p
		extrn _X509_ATTRIBUTE_free:near
					; CODE XREF: _X509_REQ_add_extensions_nid+B5p
		extrn _X509_EXTENSIONS_it:near ; CODE XREF: _X509_REQ_add_extensions_nid+2Ap
					; _X509_REQ_get_extensions+8Fp
		extrn _X509_get_subject_name:near ; CODE XREF: _X509_to_X509_REQ+66p
		extrn _X509_get_pubkey:near ; CODE XREF: _X509_to_X509_REQ+7Ap
		extrn _X509_REQ_set_subject_name:near ;	CODE XREF: _X509_to_X509_REQ+6Dp
		extrn _X509_REQ_set_pubkey:near	; CODE XREF: _X509_to_X509_REQ+8Ap
		extrn _X509at_get_attr_count:near ; CODE XREF: _X509_REQ_get_attr_count+9p
		extrn _X509at_get_attr_by_NID:near
					; CODE XREF: _X509_REQ_get_attr_by_NID+11p
					; _X509_REQ_get_extensions+29p
		extrn _X509at_get_attr_by_OBJ:near
					; CODE XREF: _X509_REQ_get_attr_by_OBJ+11p
		extrn _X509at_get_attr:near ; CODE XREF: _X509_REQ_get_attr+Dp
					; _X509_REQ_get_extensions+49p
		extrn _X509at_delete_attr:near ; CODE XREF: _X509_REQ_delete_attr+Dp
		extrn _X509at_add1_attr:near ; CODE XREF: _X509_REQ_add1_attr+Ep
		extrn _X509at_add1_attr_by_OBJ:near
					; CODE XREF: _X509_REQ_add1_attr_by_OBJ+1Ap
		extrn _X509at_add1_attr_by_NID:near
					; CODE XREF: _X509_REQ_add1_attr_by_NID+1Ap
		extrn _X509at_add1_attr_by_txt:near
					; CODE XREF: _X509_REQ_add1_attr_by_txt+1Ap


		end
