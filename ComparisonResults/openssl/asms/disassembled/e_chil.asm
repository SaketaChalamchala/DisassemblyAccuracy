;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	0641710C25ADB8905D4EC5C9853CF974
; Input	CRC32 :	C0D0679D

; File Name   :	C:\compspace\Diff\openssl\obj\e_chil.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
_HWCRHK_str_functs dd 64000h		; DATA XREF: _ERR_load_HWCRHK_strings+1Co
					; _ERR_unload_HWCRHK_strings+9o ...
		dd offset ??_C@_0M@ODINOHCI@HWCRHK_CTRL?$AA@ ; "HWCRHK_CTRL"
		dd 65000h
		dd offset ??_C@_0O@EKNHNLEL@HWCRHK_FINISH?$AA@ ; "HWCRHK_FINISH"
		dd 66000h
		dd offset ??_C@_0BA@JBLNFPGL@HWCRHK_GET_PASS?$AA@ ; "HWCRHK_GET_PASS"
		dd 67000h
		dd offset ??_C@_0M@EPBJMLK@HWCRHK_INIT?$AA@ ; "HWCRHK_INIT"
		dd 68000h
		dd offset ??_C@_0BD@GFDHIBFM@HWCRHK_INSERT_CARD?$AA@ ; "HWCRHK_INSERT_CARD"
		dd 69000h
		dd offset ??_C@_0BE@NNEJLHLA@HWCRHK_LOAD_PRIVKEY?$AA@ ;	"HWCRHK_LOAD_PRIVKEY"
		dd 6A000h
		dd offset ??_C@_0BD@HCDDGOID@HWCRHK_LOAD_PUBKEY?$AA@ ; "HWCRHK_LOAD_PUBKEY"
		dd 6B000h
		dd offset ??_C@_0P@ECCKNBIM@HWCRHK_MOD_EXP?$AA@	; "HWCRHK_MOD_EXP"
		dd 6C000h
		dd offset ??_C@_0BC@PDNECBDG@HWCRHK_RAND_BYTES?$AA@ ; "HWCRHK_RAND_BYTES"
		dd 6D000h
		dd offset ??_C@_0BD@MHHCHOOE@HWCRHK_RSA_MOD_EXP?$AA@ ; "HWCRHK_RSA_MOD_EXP"
		dd 2 dup(0)
_HWCRHK_str_reasons dd offset off_64	; DATA XREF: _ERR_load_HWCRHK_strings+31o
					; _ERR_unload_HWCRHK_strings+19o ...
		dd offset ??_C@_0P@BJJHFGDF@already?5loaded?$AA@ ; "already loaded"
		dd offset off_64+1
off_64		dd offset ??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@
					; DATA XREF: .data:_HWCRHK_str_reasonso
					; .data:00000060o ...
					; "bio was freed"
off_68		dd offset off_64+2	; DATA XREF: .data:00000078o
					; .data:00000080o ...
off_6C		dd offset ??_C@_0L@GDNIJDAB@chil?5error?$AA@ ; DATA XREF: .data:00000098o
					; .data:000000A0o ...
					; "chil	error"
off_70		dd offset off_64+3	; DATA XREF: .data:000000B8o
					; .data:000000C0o
		dd offset ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@ ; "ctrl command not implemented"
		dd offset off_68
		dd offset ??_C@_0M@DBMBNOIK@dso?5failure?$AA@ ;	"dso failure"
		dd offset off_68+1
		dd offset ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@ ; "missing key components"
		dd offset off_68+2
		dd offset ??_C@_0BA@FEBOOGFB@not?5initialised?$AA@ ; "not initialised"
		dd offset off_68+3
		dd offset ??_C@_0L@ICAFOIA@not?5loaded?$AA@ ; "not loaded"
		dd offset off_6C
		dd offset ??_C@_0M@CPEHGAAC@no?5callback?$AA@ ;	"no callback"
		dd offset off_6C+1
		dd offset ??_C@_06NNLPDOME@no?5key?$AA@	; "no key"
		dd offset off_6C+2
		dd offset ??_C@_0CA@HOGGPCBJ@private?5key?5algorithms?5disabled?$AA@ ; "private	key algorithms disabled"
		dd offset off_6C+3
		dd offset ??_C@_0P@LMFGIOCF@request?5failed?$AA@ ; "request failed"
		dd offset off_70
		dd offset ??_C@_0BB@PJKNAGAG@request?5fallback?$AA@ ; "request fallback"
		dd offset off_70+1
		dd offset ??_C@_0N@JLJLJPMB@unit?5failure?$AA@ ; "unit failure"
dword_C8	dd 2 dup(0)		; DATA XREF: .rdata:_hwcrhk_cmd_defnso
_HWCRHK_lib_name dd 0			; DATA XREF: _ERR_load_HWCRHK_strings+4Bo
					; _ERR_load_HWCRHK_strings+52w	...
		dd offset ??_C@_0M@NAKMHNGB@CHIL?5engine?$AA@ ;	"CHIL engine"
		align 10h
_HWCRHK_error_init dd 1			; DATA XREF: _ERR_load_HWCRHK_strings:loc_F1Fr
					; _ERR_load_HWCRHK_strings+22w	...
_hwcrhk_rsa	dd offset ??_C@_0BA@IBIFJOGM@CHIL?5RSA?5method?$AA@
					; DATA XREF: _bind_helper+33o
					; "CHIL	RSA method"
dword_E8	dd 0			; DATA XREF: _bind_helper+10Bw
dword_EC	dd 0			; DATA XREF: _bind_helper+114w
dword_F0	dd 0			; DATA XREF: _bind_helper+11Dw
dword_F4	dd 0			; DATA XREF: _bind_helper+126w
		dd offset _hwcrhk_rsa_mod_exp
		dd offset _hwcrhk_mod_exp_mont
		dd 0
		dd offset _hwcrhk_rsa_finish
		dd 5 dup(0)
_hwcrhk_dh	dd offset ??_C@_0P@BEIIGDM@CHIL?5DH?5method?$AA@
					; DATA XREF: _bind_helper+49o
					; "CHIL	DH method"
dword_120	dd 0			; DATA XREF: _bind_helper+133w
dword_124	dd 0			; DATA XREF: _bind_helper+13Cw
		dd offset _hwcrhk_mod_exp_dh
		align 20h
_hwcrhk_rand	dd 0			; DATA XREF: _bind_helper+5Fo
		dd offset _hwcrhk_rand_bytes
		align 10h
		dd offset _hwcrhk_rand_bytes
		dd offset _hwcrhk_rand_status
_engine_hwcrhk_id dd offset ??_C@_04JHJDAOJH@chil?$AA@ ; DATA XREF: _bind_fn+8r
					; _bind_helper+1r
					; "chil"
_engine_hwcrhk_name dd offset ??_C@_0BN@PIPOENLH@CHIL?5hardware?5engine?5support?$AA@
					; DATA XREF: _bind_helper+1Cr
					; "CHIL	hardware engine	support"
_engine_hwcrhk_id_alt dd offset	??_C@_07JOEMLHGJ@ncipher?$AA@ ;	DATA XREF: _bind_fn+3Br
					; "ncipher"
_hndidx_rsa	dd 0FFFFFFFFh		; DATA XREF: _hwcrhk_rsa_mod_exp+9Ar
					; _hwcrhk_rsa_finish+1r ...
_hwcrhk_globals	dd 10h			; DATA XREF: _get_context+37o
					; _hwcrhk_ctrl+192r ...
		dd offset _logstream
		dd 4, 0
		dd 0FFFFFFFFh, 2 dup(0)
		dd 4
dword_188	dd 0			; DATA XREF: _hwcrhk_init+204w
dword_18C	dd 0			; DATA XREF: _hwcrhk_init+20Ew
dword_190	dd 0			; DATA XREF: _hwcrhk_init+218w
dword_194	dd 0			; DATA XREF: _hwcrhk_init+222w
		dd 6 dup(0)
		dd offset _hwcrhk_get_pass
		dd offset _hwcrhk_insert_card
		dd offset _hwcrhk_log_message
_n_hwcrhk_Init	dd offset ??_C@_0BC@BNCGEAID@HWCryptoHook_Init?$AA@
					; DATA XREF: _hwcrhk_init:loc_17D9r
					; "HWCryptoHook_Init"
_n_hwcrhk_Finish dd offset ??_C@_0BE@GGPPLDJL@HWCryptoHook_Finish?$AA@
					; DATA XREF: _hwcrhk_init+A6r
					; "HWCryptoHook_Finish"
_n_hwcrhk_ModExp dd offset ??_C@_0BE@JMLLHLOD@HWCryptoHook_ModExp?$AA@
					; DATA XREF: _hwcrhk_init+C4r
					; "HWCryptoHook_ModExp"
_n_hwcrhk_RSA	dd offset ??_C@_0BB@DAMOFKMC@HWCryptoHook_RSA?$AA@
					; DATA XREF: _hwcrhk_init+E2r
					; "HWCryptoHook_RSA"
_n_hwcrhk_RandomBytes dd offset	??_C@_0BJ@BJBOJAH@HWCryptoHook_RandomBytes?$AA@
					; DATA XREF: _hwcrhk_init+160r
					; "HWCryptoHook_RandomBytes"
_n_hwcrhk_RSALoadKey dd	offset ??_C@_0BI@LLPJLM@HWCryptoHook_RSALoadKey?$AA@
					; DATA XREF: _hwcrhk_init+100r
					; "HWCryptoHook_RSALoadKey"
_n_hwcrhk_RSAGetPublicKey dd offset ??_C@_0BN@IAFIFGLH@HWCryptoHook_RSAGetPublicKey?$AA@
					; DATA XREF: _hwcrhk_init+120r
					; "HWCryptoHook_RSAGetPublicKey"
_n_hwcrhk_RSAUnloadKey dd offset ??_C@_0BK@KIEHKAED@HWCryptoHook_RSAUnloadKey?$AA@
					; DATA XREF: _hwcrhk_init+140r
					; "HWCryptoHook_RSAUnloadKey"
_n_hwcrhk_ModExpCRT dd offset ??_C@_0BH@DJCDBAB@HWCryptoHook_ModExpCRT?$AA@
					; DATA XREF: _hwcrhk_init+180r
_data		ends			; "HWCryptoHook_ModExpCRT"

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E0h
; COMDAT (pick any)
		public ??_C@_0M@ODINOHCI@HWCRHK_CTRL?$AA@
; `string'
??_C@_0M@ODINOHCI@HWCRHK_CTRL?$AA@ db 'HWCRHK_CTRL',0 ; DATA XREF: .data:00000004o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1ECh
; COMDAT (pick any)
		public ??_C@_0O@EKNHNLEL@HWCRHK_FINISH?$AA@
; `string'
??_C@_0O@EKNHNLEL@HWCRHK_FINISH?$AA@ db	'HWCRHK_FINISH',0 ; DATA XREF: .data:0000000Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1FCh
; COMDAT (pick any)
		public ??_C@_0BA@JBLNFPGL@HWCRHK_GET_PASS?$AA@
; `string'
??_C@_0BA@JBLNFPGL@HWCRHK_GET_PASS?$AA@	db 'HWCRHK_GET_PASS',0 ; DATA XREF: .data:00000014o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 20Ch
; COMDAT (pick any)
		public ??_C@_0M@EPBJMLK@HWCRHK_INIT?$AA@
; `string'
??_C@_0M@EPBJMLK@HWCRHK_INIT?$AA@ db 'HWCRHK_INIT',0 ; DATA XREF: .data:0000001Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 218h
; COMDAT (pick any)
		public ??_C@_0BD@GFDHIBFM@HWCRHK_INSERT_CARD?$AA@
; `string'
??_C@_0BD@GFDHIBFM@HWCRHK_INSERT_CARD?$AA@ db 'HWCRHK_INSERT_CARD',0
					; DATA XREF: .data:00000024o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 22Ch
; COMDAT (pick any)
		public ??_C@_0BE@NNEJLHLA@HWCRHK_LOAD_PRIVKEY?$AA@
; `string'
??_C@_0BE@NNEJLHLA@HWCRHK_LOAD_PRIVKEY?$AA@ db 'HWCRHK_LOAD_PRIVKEY',0
					; DATA XREF: .data:0000002Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 240h
; COMDAT (pick any)
		public ??_C@_0BD@HCDDGOID@HWCRHK_LOAD_PUBKEY?$AA@
; `string'
??_C@_0BD@HCDDGOID@HWCRHK_LOAD_PUBKEY?$AA@ db 'HWCRHK_LOAD_PUBKEY',0
					; DATA XREF: .data:00000034o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 254h
; COMDAT (pick any)
		public ??_C@_0P@ECCKNBIM@HWCRHK_MOD_EXP?$AA@
; `string'
??_C@_0P@ECCKNBIM@HWCRHK_MOD_EXP?$AA@ db 'HWCRHK_MOD_EXP',0 ; DATA XREF: .data:0000003Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 264h
; COMDAT (pick any)
		public ??_C@_0BC@PDNECBDG@HWCRHK_RAND_BYTES?$AA@
; `string'
??_C@_0BC@PDNECBDG@HWCRHK_RAND_BYTES?$AA@ db 'HWCRHK_RAND_BYTES',0
					; DATA XREF: .data:00000044o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 278h
; COMDAT (pick any)
		public ??_C@_0BD@MHHCHOOE@HWCRHK_RSA_MOD_EXP?$AA@
; `string'
??_C@_0BD@MHHCHOOE@HWCRHK_RSA_MOD_EXP?$AA@ db 'HWCRHK_RSA_MOD_EXP',0
					; DATA XREF: .data:0000004Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 28Ch
; COMDAT (pick any)
		public ??_C@_0P@BJJHFGDF@already?5loaded?$AA@
; `string'
??_C@_0P@BJJHFGDF@already?5loaded?$AA@ db 'already loaded',0 ; DATA XREF: .data:0000005Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 29Ch
; COMDAT (pick any)
		public ??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@
; `string'
??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@ db 'bio was freed',0 ; DATA XREF: .data:off_64o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2ACh
; COMDAT (pick any)
		public ??_C@_0L@GDNIJDAB@chil?5error?$AA@
; `string'
??_C@_0L@GDNIJDAB@chil?5error?$AA@ db 'chil error',0 ; DATA XREF: .data:off_6Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2B8h
; COMDAT (pick any)
		public ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@
; `string'
??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@	db 'ctrl command not implemented',0
					; DATA XREF: .data:00000074o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2D8h
; COMDAT (pick any)
		public ??_C@_0M@DBMBNOIK@dso?5failure?$AA@
; `string'
??_C@_0M@DBMBNOIK@dso?5failure?$AA@ db 'dso failure',0 ; DATA XREF: .data:0000007Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2E4h
; COMDAT (pick any)
		public ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@
; `string'
??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@	db 'missing key components',0
					; DATA XREF: .data:00000084o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2FCh
; COMDAT (pick any)
		public ??_C@_0BA@FEBOOGFB@not?5initialised?$AA@
; `string'
??_C@_0BA@FEBOOGFB@not?5initialised?$AA@ db 'not initialised',0 ; DATA XREF: .data:0000008Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 30Ch
; COMDAT (pick any)
		public ??_C@_0L@ICAFOIA@not?5loaded?$AA@
; `string'
??_C@_0L@ICAFOIA@not?5loaded?$AA@ db 'not loaded',0 ; DATA XREF: .data:00000094o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 318h
; COMDAT (pick any)
		public ??_C@_0M@CPEHGAAC@no?5callback?$AA@
; `string'
??_C@_0M@CPEHGAAC@no?5callback?$AA@ db 'no callback',0 ; DATA XREF: .data:0000009Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 324h
; COMDAT (pick any)
		public ??_C@_06NNLPDOME@no?5key?$AA@
; `string'
??_C@_06NNLPDOME@no?5key?$AA@ db 'no key',0 ; DATA XREF: .data:000000A4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 32Ch
; COMDAT (pick any)
		public ??_C@_0CA@HOGGPCBJ@private?5key?5algorithms?5disabled?$AA@
; `string'
??_C@_0CA@HOGGPCBJ@private?5key?5algorithms?5disabled?$AA@ db 'private key algorithms disabled',0
					; DATA XREF: .data:000000ACo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 34Ch
; COMDAT (pick any)
		public ??_C@_0P@LMFGIOCF@request?5failed?$AA@
; `string'
??_C@_0P@LMFGIOCF@request?5failed?$AA@ db 'request failed',0 ; DATA XREF: .data:000000B4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 35Ch
; COMDAT (pick any)
		public ??_C@_0BB@PJKNAGAG@request?5fallback?$AA@
; `string'
??_C@_0BB@PJKNAGAG@request?5fallback?$AA@ db 'request fallback',0
					; DATA XREF: .data:000000BCo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 370h
; COMDAT (pick any)
		public ??_C@_0N@JLJLJPMB@unit?5failure?$AA@
; `string'
??_C@_0N@JLJLJPMB@unit?5failure?$AA@ db	'unit failure',0 ; DATA XREF: .data:000000C4o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 380h
; COMDAT (pick any)
		public ??_C@_0M@NAKMHNGB@CHIL?5engine?$AA@
; `string'
??_C@_0M@NAKMHNGB@CHIL?5engine?$AA@ db 'CHIL engine',0 ; DATA XREF: .data:000000D4o
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 38Ch
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
_HWCRHK_lib_error_code dd ?		; DATA XREF: _hwcrhk_rsa_mod_exp+55r
					; _hwcrhk_rsa_mod_exp+63w ...
_logstream	dd ?			; DATA XREF: .data:0000016Co
					; _hwcrhk_ctrl+87r ...
_disable_mutex_callbacks dd ?		; DATA XREF: _hwcrhk_ctrl+1CBw
					; _hwcrhk_ctrl+1FCw ...
_password_context dd ?			; DATA XREF: _hwcrhk_ctrl+11Aw
					; _hwcrhk_init+240o
dword_39C	dd ?			; DATA XREF: _hwcrhk_ctrl+150w
dword_3A0	dd ?			; DATA XREF: _hwcrhk_ctrl+173w
_hwcrhk_dso	dd ?			; DATA XREF: _hwcrhk_ctrl:$LN4r
					; _hwcrhk_finish:loc_1654r ...
_hwcrhk_context	dd ?			; DATA XREF: _hwcrhk_rsa_mod_exp+18r
					; _hwcrhk_rsa_mod_exp+273r ...
_p_hwcrhk_Init	dd ?			; DATA XREF: _get_context+44r
					; _hwcrhk_finish+B4w ...
_p_hwcrhk_Finish dd ?			; DATA XREF: _hwcrhk_finish+52r
					; _hwcrhk_finish+BEw ...
_p_hwcrhk_ModExp dd ?			; DATA XREF: _hwcrhk_finish+C8w
					; _hwcrhk_init+1D0w ...
_p_hwcrhk_RSA	dd ?			; DATA XREF: _hwcrhk_rsa_mod_exp+106r
					; _hwcrhk_finish+D2w ...
_p_hwcrhk_RandomBytes dd ?		; DATA XREF: _hwcrhk_rand_bytes+85r
					; _hwcrhk_finish+104w ...
_p_hwcrhk_RSALoadKey dd	?		; DATA XREF: _hwcrhk_finish+DCw
					; _hwcrhk_init+1A9w ...
_p_hwcrhk_RSAGetPublicKey dd ?		; DATA XREF: _hwcrhk_finish+E6w
					; _hwcrhk_init+1B2w ...
_p_hwcrhk_RSAUnloadKey dd ?		; DATA XREF: _hwcrhk_rsa_finish+1Dr
					; _hwcrhk_finish+F0w ...
_p_hwcrhk_ModExpCRT dd ?		; DATA XREF: _hwcrhk_rsa_mod_exp+279r
					; _hwcrhk_finish+FAw ...
_HWCRHK_LIBNAME	dd ?			; DATA XREF: _free_HWCRHK_LIBNAMEr
					; _free_HWCRHK_LIBNAME:loc_121Ew ...
_bss		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_rsa_mod_exp proc near		; DATA XREF: .data:000000F8o

var_438		= dword	ptr -438h
var_434		= dword	ptr -434h
var_430		= dword	ptr -430h
var_42C		= dword	ptr -42Ch
var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 438h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+438h+var_4], eax
		cmp	ds:_hwcrhk_context, 0
		lea	eax, [esp+438h+var_404]
		push	ebx
		mov	ebx, [esp+43Ch+arg_0]
		push	ebp
		mov	ebp, [esp+440h+arg_4]
		push	esi
		mov	esi, [esp+444h+arg_8]
		mov	[esp+444h+var_438], ebx
		mov	[esp+444h+var_434], ebp
		mov	[esp+444h+var_424], esi
		mov	[esp+444h+var_42C], eax
		mov	[esp+444h+var_428], 400h
		jnz	short loc_46D
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_43C
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_43C:				; CODE XREF: _hwcrhk_rsa_mod_exp+5Cj
		push	3CBh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ah ; 'j'
		push	6Dh ; 'm'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+438h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 438h
		retn
; ---------------------------------------------------------------------------

loc_46D:				; CODE XREF: _hwcrhk_rsa_mod_exp+53j
		push	edi
		push	_hndidx_rsa
		push	esi
		call	_RSA_get_ex_data
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_572
		mov	ecx, [esi+10h]
		test	ecx, ecx
		jnz	short loc_4AB
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_4A1
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_4A1:				; CODE XREF: _hwcrhk_rsa_mod_exp+C1j
		push	3DBh
		jmp	loc_6E2
; ---------------------------------------------------------------------------

loc_4AB:				; CODE XREF: _hwcrhk_rsa_mod_exp+B8j
		push	dword ptr [ecx+4]
		push	ebx
		call	_bn_expand2
		mov	eax, [ebx+8]
		mov	ecx, [ebp+4]
		shl	eax, 2
		mov	[esp+450h+var_430], eax
		mov	eax, [ebx]
		mov	[esp+450h+var_434], eax
		lea	eax, [esp+450h+var_42C]
		push	eax
		lea	eax, [esp+454h+var_434]
		shl	ecx, 2
		push	eax
		push	dword ptr [edi]
		push	ecx
		push	dword ptr [ebp+0]
		call	ds:_p_hwcrhk_RSA
		mov	ecx, [esp+464h+var_430]
		add	esp, 1Ch
		shr	ecx, 2
		mov	esi, eax
		mov	[ebx+4], ecx
		test	ecx, ecx
		jle	short loc_50C
		mov	eax, [ebx]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_4FB:				; CODE XREF: _hwcrhk_rsa_mod_exp+133j
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_509
		dec	ecx
		test	ecx, ecx
		jg	short loc_4FB

loc_509:				; CODE XREF: _hwcrhk_rsa_mod_exp+12Ej
		mov	[ebx+4], ecx

loc_50C:				; CODE XREF: _hwcrhk_rsa_mod_exp+11Dj
		test	esi, esi
		jns	loc_6C3
		mov	eax, ds:_HWCRHK_lib_error_code
		cmp	esi, 0FFFFFFFEh
		jnz	short loc_53A
		test	eax, eax
		jnz	short loc_52C
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_52C:				; CODE XREF: _hwcrhk_rsa_mod_exp+14Cj
		push	3F3h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	70h ; 'p'
		jmp	short loc_554
; ---------------------------------------------------------------------------

loc_53A:				; CODE XREF: _hwcrhk_rsa_mod_exp+148j
		test	eax, eax
		jnz	short loc_548
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_548:				; CODE XREF: _hwcrhk_rsa_mod_exp+168j
		push	3F6h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Fh ; 'o'

loc_554:				; CODE XREF: _hwcrhk_rsa_mod_exp+164j
		push	6Dh ; 'm'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		push	[esp+448h+var_42C]
		push	1
		call	_ERR_add_error_data
		add	esp, 8
		jmp	loc_6F4
; ---------------------------------------------------------------------------

loc_572:				; CODE XREF: _hwcrhk_rsa_mod_exp+ADj
		cmp	dword ptr [esi+1Ch], 0
		jz	loc_6CA
		cmp	dword ptr [esi+20h], 0
		jz	loc_6CA
		cmp	dword ptr [esi+24h], 0
		jz	loc_6CA
		cmp	dword ptr [esi+28h], 0
		jz	loc_6CA
		cmp	dword ptr [esi+2Ch], 0
		jz	loc_6CA
		mov	eax, [esi+10h]
		push	dword ptr [eax+4]
		push	ebx
		call	_bn_expand2
		mov	eax, [ebp+4]
		shl	eax, 2
		mov	[esp+450h+var_410], eax
		mov	eax, [esi+1Ch]
		mov	ecx, [eax+4]
		mov	eax, [eax]
		mov	[esp+450h+var_414], eax
		mov	eax, [esi+20h]
		shl	ecx, 2
		mov	[esp+450h+var_418], ecx
		mov	ecx, [eax+4]
		mov	eax, [eax]
		mov	[esp+450h+var_41C], eax
		mov	eax, [esi+24h]
		shl	ecx, 2
		mov	[esp+450h+var_420], ecx
		mov	ebp, [eax+4]
		mov	ebx, [eax]
		mov	eax, [esi+28h]
		shl	ebp, 2
		mov	edi, [eax+4]
		mov	esi, [eax]
		mov	eax, [esp+450h+var_424]
		shl	edi, 2
		mov	eax, [eax+2Ch]
		mov	edx, [eax+4]
		mov	ecx, [eax]
		mov	eax, [esp+450h+var_438]
		shl	edx, 2
		mov	eax, [eax+8]
		shl	eax, 2
		mov	[esp+450h+var_408], eax
		mov	eax, [esp+450h+var_438]
		mov	eax, [eax]
		mov	[esp+450h+var_40C], eax
		lea	eax, [esp+450h+var_42C]
		push	eax
		lea	eax, [esp+454h+var_40C]
		push	eax
		push	edx
		mov	eax, [esp+45Ch+var_434]
		push	ecx
		push	edi
		push	esi
		push	ebp
		push	ebx
		push	[esp+470h+var_420]
		push	[esp+474h+var_41C]
		push	[esp+478h+var_418]
		push	[esp+47Ch+var_414]
		push	[esp+480h+var_410]
		push	dword ptr [eax]
		push	ds:_hwcrhk_context
		call	ds:_p_hwcrhk_ModExpCRT
		mov	ecx, [esp+48Ch+var_408]
		add	esp, 44h
		mov	ebx, [esp+448h+var_438]
		mov	esi, eax
		shr	ecx, 2
		mov	[ebx+4], ecx
		test	ecx, ecx
		jle	short loc_686
		mov	eax, [ebx]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_675:				; CODE XREF: _hwcrhk_rsa_mod_exp+2ADj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_683
		dec	ecx
		test	ecx, ecx
		jg	short loc_675

loc_683:				; CODE XREF: _hwcrhk_rsa_mod_exp+2A8j
		mov	[ebx+4], ecx

loc_686:				; CODE XREF: _hwcrhk_rsa_mod_exp+297j
		test	esi, esi
		jns	short loc_6C3
		cmp	esi, 0FFFFFFFEh
		jnz	short loc_69D
		push	41Eh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	70h ; 'p'
		jmp	short loc_6A9
; ---------------------------------------------------------------------------

loc_69D:				; CODE XREF: _hwcrhk_rsa_mod_exp+2B9j
		push	421h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Fh ; 'o'

loc_6A9:				; CODE XREF: _hwcrhk_rsa_mod_exp+2C7j
		push	6Dh ; 'm'
		call	_ERR_HWCRHK_error
		add	esp, 10h
		push	[esp+448h+var_42C]
		push	1
		call	_ERR_add_error_data
		add	esp, 8
		jmp	short loc_6F4
; ---------------------------------------------------------------------------

loc_6C3:				; CODE XREF: _hwcrhk_rsa_mod_exp+13Aj
					; _hwcrhk_rsa_mod_exp+2B4j
		mov	eax, 1
		jmp	short loc_6F6
; ---------------------------------------------------------------------------

loc_6CA:				; CODE XREF: _hwcrhk_rsa_mod_exp+1A2j
					; _hwcrhk_rsa_mod_exp+1ACj ...
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_6DD
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_6DD:				; CODE XREF: _hwcrhk_rsa_mod_exp+2FDj
		push	400h

loc_6E2:				; CODE XREF: _hwcrhk_rsa_mod_exp+D2j
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	69h ; 'i'
		push	6Dh ; 'm'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_6F4:				; CODE XREF: _hwcrhk_rsa_mod_exp+199j
					; _hwcrhk_rsa_mod_exp+2EDj
		xor	eax, eax

loc_6F6:				; CODE XREF: _hwcrhk_rsa_mod_exp+2F4j
		pop	edi

$err$56:
		mov	ecx, [esp+444h+var_4]
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 438h
		retn
_hwcrhk_rsa_mod_exp endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 710h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mod_exp_mont proc near		; DATA XREF: .data:000000FCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_hwcrhk_mod_exp
		add	esp, 14h
		retn
_hwcrhk_mod_exp_mont endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 730h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_rsa_finish proc	near		; DATA XREF: .data:00000104o

arg_0		= dword	ptr  4

		push	esi
		push	_hndidx_rsa
		push	[esp+8+arg_0]
		call	_RSA_get_ex_data
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_76D
		push	0
		push	dword ptr [esi]
		call	ds:_p_hwcrhk_RSAUnloadKey
		push	esi
		call	_CRYPTO_free
		push	0
		push	_hndidx_rsa
		push	[esp+18h+arg_0]
		call	_RSA_set_ex_data
		add	esp, 18h

loc_76D:				; CODE XREF: _hwcrhk_rsa_finish+17j
		mov	eax, 1
		pop	esi
		retn
_hwcrhk_rsa_finish endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 774h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mod_exp_dh proc	near		; DATA XREF: .data:00000128o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	[esp+arg_14]
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		call	_hwcrhk_mod_exp
		add	esp, 14h
		retn
_hwcrhk_mod_exp_dh endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 794h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_rand_bytes proc	near		; DATA XREF: .data:00000144o
					; .data:00000150o

var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 40Ch
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+40Ch+var_4], eax
		mov	ecx, [esp+40Ch+arg_0]
		lea	eax, [esp+40Ch+var_404]
		mov	[esp+40Ch+var_40C], eax
		mov	eax, ds:_hwcrhk_context
		mov	[esp+40Ch+var_408], 400h
		test	eax, eax
		jnz	short loc_80C
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_7DE
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_7DE:				; CODE XREF: _hwcrhk_rand_bytes+3Ej
		push	45Eh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ah ; 'j'
		push	6Ch ; 'l'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		mov	ecx, [esp+40Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 40Ch
		retn
; ---------------------------------------------------------------------------

loc_80C:				; CODE XREF: _hwcrhk_rand_bytes+35j
		lea	edx, [esp+40Ch+var_40C]
		push	edx
		push	[esp+410h+arg_4]
		push	ecx
		push	eax
		call	ds:_p_hwcrhk_RandomBytes
		add	esp, 10h
		test	eax, eax
		jns	short loc_895
		cmp	eax, 0FFFFFFFEh
		mov	eax, ds:_HWCRHK_lib_error_code
		jnz	short loc_84C
		test	eax, eax
		jnz	short loc_83E
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_83E:				; CODE XREF: _hwcrhk_rand_bytes+9Ej
		push	469h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	70h ; 'p'
		jmp	short loc_866
; ---------------------------------------------------------------------------

loc_84C:				; CODE XREF: _hwcrhk_rand_bytes+9Aj
		test	eax, eax
		jnz	short loc_85A
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_85A:				; CODE XREF: _hwcrhk_rand_bytes+BAj
		push	46Bh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Fh ; 'o'

loc_866:				; CODE XREF: _hwcrhk_rand_bytes+B6j
		push	6Ch ; 'l'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		push	[esp+40Ch+var_40C]
		push	1
		call	_ERR_add_error_data
		add	esp, 8
		xor	eax, eax
		mov	ecx, [esp+40Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 40Ch
		retn
; ---------------------------------------------------------------------------

loc_895:				; CODE XREF: _hwcrhk_rand_bytes+90j
		mov	eax, 1

$err$18:
		mov	ecx, [esp+40Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 40Ch
		retn
_hwcrhk_rand_bytes endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_rand_status proc near		; DATA XREF: .data:00000154o
		mov	eax, 1
		retn
_hwcrhk_rand_status endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_insert_card proc near		; DATA XREF: .data:000001B4o

var_209		= byte ptr -209h
var_208		= dword	ptr -208h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 20Ch
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+20Ch+var_4], eax
		mov	eax, [esp+20Ch+arg_0]
		xor	ecx, ecx
		mov	edx, [esp+20Ch+arg_8]
		push	ebx
		push	ebp
		mov	ebp, [esp+214h+arg_4]
		xor	ebx, ebx
		push	esi
		push	edi
		mov	edi, [esp+21Ch+arg_C]
		or	esi, 0FFFFFFFFh
		mov	[esp+21Ch+var_208], eax
		test	edi, edi
		jz	short loc_90F
		mov	eax, [edi+4]
		test	eax, eax
		cmovnz	ecx, eax
		mov	eax, [edi+8]
		test	eax, eax
		cmovnz	ebx, eax

loc_90F:				; CODE XREF: _hwcrhk_insert_card+45j
		test	edx, edx
		jz	short loc_922
		mov	eax, [edx]
		test	eax, eax
		cmovnz	ecx, eax
		mov	eax, [edx+4]
		test	eax, eax
		cmovnz	ebx, eax

loc_922:				; CODE XREF: _hwcrhk_insert_card+59j
		test	ecx, ecx
		jnz	short loc_958
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_939
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_939:				; CODE XREF: _hwcrhk_insert_card+75j
		push	4F4h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ch ; 'l'
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_A2D
; ---------------------------------------------------------------------------

loc_958:				; CODE XREF: _hwcrhk_insert_card+6Cj
		push	ecx
		call	_UI_new_method
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_A2B
		test	ebp, ebp
		jz	short loc_98F
		cmp	byte ptr [ebp+0], 0
		jz	short loc_98F
		push	ebp
		push	offset ??_C@_0BE@OBBPALOK@Current?5card?3?5?$CC?$CFs?$CC?6?$AA@	; "Current card: \"%s\"\n"
		lea	eax, [esp+224h+var_204]
		push	1FFh
		push	eax
		call	_BIO_snprintf
		add	esp, 10h
		jmp	short loc_994
; ---------------------------------------------------------------------------

loc_98F:				; CODE XREF: _hwcrhk_insert_card+B5j
					; _hwcrhk_insert_card+BBj
		mov	[esp+21Ch+var_204], 0

loc_994:				; CODE XREF: _hwcrhk_insert_card+D5j
		lea	eax, [esp+21Ch+var_204]
		push	eax
		push	edi
		call	_UI_dup_info_string
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		js	short loc_9EB
		mov	eax, [esp+21Ch+var_208]
		test	eax, eax
		jz	short loc_9EB
		push	eax
		push	offset ??_C@_0BB@ENAEFLLN@Insert?5card?5?$CC?$CFs?$CC?$AA@ ; "Insert card \"%s\""
		lea	eax, [esp+224h+var_204]
		push	1FFh
		push	eax
		call	_BIO_snprintf
		lea	eax, [esp+22Ch+var_209]
		push	eax
		push	1
		push	offset ??_C@_02DMLCCNBA@Cc?$AA@	; `string'
		push	offset ??_C@_02PCIJFNDE@?$AN?6?$AA@ ; `string'
		push	offset ??_C@_0CK@BPFHOIG@?6?5then?5hit?5?$DMenter?$DO?5or?5C?$DMenter?$DO?5t@ ;	"\n then hit <enter> or	C<enter> to canc"...
		lea	eax, [esp+240h+var_204]
		push	eax
		push	edi
		call	_UI_dup_input_boolean
		add	esp, 2Ch
		mov	esi, eax

loc_9EB:				; CODE XREF: _hwcrhk_insert_card+EEj
					; _hwcrhk_insert_card+F6j
		push	ebx
		push	edi
		call	_UI_add_user_data
		add	esp, 8
		test	esi, esi
		js	short loc_A04
		push	edi
		call	_UI_process
		add	esp, 4
		mov	esi, eax

loc_A04:				; CODE XREF: _hwcrhk_insert_card+13Fj
		push	edi
		call	_UI_free
		add	esp, 4
		cmp	esi, 0FFFFFFFEh
		jz	short loc_A26
		test	esi, esi
		js	short loc_A21
		cmp	[esp+21Ch+var_209], 43h	; 'C'
		jz	short loc_A26
		xor	esi, esi
		jmp	short loc_A2B
; ---------------------------------------------------------------------------

loc_A21:				; CODE XREF: _hwcrhk_insert_card+15Cj
		or	esi, 0FFFFFFFFh
		jmp	short loc_A2B
; ---------------------------------------------------------------------------

loc_A26:				; CODE XREF: _hwcrhk_insert_card+158j
					; _hwcrhk_insert_card+163j
		mov	esi, 1

loc_A2B:				; CODE XREF: _hwcrhk_insert_card+ADj
					; _hwcrhk_insert_card+167j ...
		mov	eax, esi

loc_A2D:				; CODE XREF: _hwcrhk_insert_card+9Bj
		mov	ecx, [esp+21Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 20Ch
		retn
_hwcrhk_insert_card endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A48h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_get_pass proc near		; DATA XREF: .data:000001B0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	edx, edx
		xor	ebp, ebp
		xor	ecx, ecx
		push	edi
		test	esi, esi
		jz	short loc_A61
		xor	eax, eax
		cmp	[esi], al
		cmovz	esi, eax

loc_A61:				; CODE XREF: _hwcrhk_get_pass+10j
		mov	edi, [esp+10h+arg_10]
		test	edi, edi
		jz	short loc_A80
		mov	eax, [edi+4]
		test	eax, eax
		cmovnz	ecx, eax
		mov	eax, [edi]
		test	eax, eax
		cmovnz	edx, eax
		mov	eax, [edi+8]
		test	eax, eax
		cmovnz	ebp, eax

loc_A80:				; CODE XREF: _hwcrhk_get_pass+1Fj
		mov	eax, [esp+10h+arg_C]
		test	eax, eax
		jz	short loc_A9A
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_A92
		mov	ecx, edi
		xor	edx, edx

loc_A92:				; CODE XREF: _hwcrhk_get_pass+44j
		mov	eax, [eax+4]
		test	eax, eax
		cmovnz	ebp, eax

loc_A9A:				; CODE XREF: _hwcrhk_get_pass+3Ej
		test	edx, edx
		jnz	short loc_AD4
		test	ecx, ecx
		jnz	short loc_ADC
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_AB5
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_AB5:				; CODE XREF: _hwcrhk_get_pass+61j
		push	4B8h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ch ; 'l'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_AD4:				; CODE XREF: _hwcrhk_get_pass+54j
		test	ecx, ecx
		jz	loc_B92

loc_ADC:				; CODE XREF: _hwcrhk_get_pass+58j
		push	ecx
		call	_UI_new_method
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_BA6
		push	esi
		push	offset ??_C@_0M@FKGGGFHP@pass?5phrase?$AA@ ; "pass phrase"
		push	ebx
		call	_UI_construct_prompt
		mov	ecx, [esp+1Ch+arg_4]
		mov	edi, [esp+1Ch+arg_8]
		mov	[esp+1Ch+arg_0], eax
		mov	ecx, [ecx]
		dec	ecx
		push	ecx
		push	0
		push	edi
		push	2
		push	eax
		push	ebx
		call	_UI_add_input_string
		push	ebp
		push	ebx
		mov	esi, eax
		call	_UI_add_user_data
		push	0
		push	0
		push	1
		push	1
		push	ebx
		call	_UI_ctrl
		add	esp, 40h
		test	esi, esi
		js	short loc_B6E
		nop	dword ptr [eax]

loc_B38:				; CODE XREF: _hwcrhk_get_pass+110j
		push	ebx
		call	_UI_process
		add	esp, 4
		test	eax, eax
		jns	short loc_B5C
		push	0
		push	0
		push	0
		push	2
		push	ebx
		call	_UI_ctrl
		add	esp, 14h
		test	eax, eax
		jnz	short loc_B38
		jmp	short loc_B6E
; ---------------------------------------------------------------------------

loc_B5C:				; CODE XREF: _hwcrhk_get_pass+FBj
		lea	ecx, [edi+1]

loc_B5F:				; CODE XREF: _hwcrhk_get_pass+11Cj
		mov	al, [edi]
		inc	edi
		test	al, al
		jnz	short loc_B5F
		mov	eax, [esp+10h+arg_4]
		sub	edi, ecx
		mov	[eax], edi

loc_B6E:				; CODE XREF: _hwcrhk_get_pass+EBj
					; _hwcrhk_get_pass+112j
		push	ebx
		call	_UI_free
		push	[esp+14h+arg_0]
		call	_CRYPTO_free
		mov	eax, [esp+18h+arg_4]
		add	esp, 8
		mov	eax, [eax]
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		neg	eax
		pop	ebp
		dec	eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_B92:				; CODE XREF: _hwcrhk_get_pass+8Ej
		mov	ebx, [esp+10h+arg_4]
		push	ebp
		push	0
		push	dword ptr [ebx]
		push	[esp+1Ch+arg_8]
		call	edx
		add	esp, 10h
		mov	[ebx], eax

loc_BA6:				; CODE XREF: _hwcrhk_get_pass+A1j
		mov	eax, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, [eax]
		neg	eax
		pop	ebx
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
_hwcrhk_get_pass endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BB8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_log_message proc near		; DATA XREF: .data:000001B8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	523h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	15h
		push	9
		call	_CRYPTO_lock
		mov	eax, [esp+10h+arg_0]
		add	esp, 10h
		test	eax, eax
		jz	short loc_BEE
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_BEE
		push	[esp+arg_4]
		push	offset ??_C@_03OFAPEBGM@?$CFs?6?$AA@ ; `string'
		push	eax
		call	_BIO_printf
		add	esp, 0Ch

loc_BEE:				; CODE XREF: _hwcrhk_log_message+1Cj
					; _hwcrhk_log_message+22j
		push	529h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	15h
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		retn
_hwcrhk_log_message endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0C08h
_hwcrhk_cmd_defns dd offset dword_C8	; DATA XREF: _bind_helper+F1o
		dd offset ??_C@_07EGEBNIPD@SO_PATH?$AA@	; "SO_PATH"
		dd offset ??_C@_0DC@HFMCEPJN@Specifies?5the?5path?5to?5the?5?8hwcrh@ ; "Specifies the path to the 'hwcrhk' shar"...
		dd 2, 0C9h
		dd offset ??_C@_0L@BECOIJJF@FORK_CHECK?$AA@ ; "FORK_CHECK"
		dd offset ??_C@_0DC@FMAPNBJE@Turns?5fork?$CI?$CJ?5checking?5on?5?$CInon?9ze@ ; "Turns fork() checking on (non-zero) or "...
		dd 1, 0CAh
		dd offset ??_C@_0P@PLPNJEBB@THREAD_LOCKING?$AA@	; "THREAD_LOCKING"
		dd offset ??_C@_0DG@BPKOLNNM@Turns?5thread?9safe?5locking?5on?5?$CIze@ ; "Turns	thread-safe locking on (zero) or "...
		dd 1, 0CBh
		dd offset ??_C@_0BD@HNMPJJDL@SET_USER_INTERFACE?$AA@ ; "SET_USER_INTERFACE"
		dd offset ??_C@_0CJ@PMPFMPLL@Set?5the?5global?5user?5interface?5?$CIi@ ; "Set the global user interface	(internal"...
		dd 8, 0CCh
		dd offset ??_C@_0BC@HOEJKHEO@SET_CALLBACK_DATA?$AA@ ; "SET_CALLBACK_DATA"
		dd offset ??_C@_0DE@BOALENFP@Set?5the?5global?5user?5interface?5ex@ ; "Set the global user interface extra dat"...
		dd 8, 4	dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C68h
; COMDAT (pick any)
		public ??_C@_07EGEBNIPD@SO_PATH?$AA@
; `string'
??_C@_07EGEBNIPD@SO_PATH?$AA@ db 'SO_PATH',0 ; DATA XREF: .rdata:00000C0Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C70h
; COMDAT (pick any)
		public ??_C@_0DC@HFMCEPJN@Specifies?5the?5path?5to?5the?5?8hwcrh@
; `string'
??_C@_0DC@HFMCEPJN@Specifies?5the?5path?5to?5the?5?8hwcrh@ db 'Specifies the path to the ',27h,'hwcrhk',27h,' shared library',0
					; DATA XREF: .rdata:00000C10o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CA4h
; COMDAT (pick any)
		public ??_C@_0L@BECOIJJF@FORK_CHECK?$AA@
; `string'
??_C@_0L@BECOIJJF@FORK_CHECK?$AA@ db 'FORK_CHECK',0 ; DATA XREF: .rdata:00000C1Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CB0h
; COMDAT (pick any)
		public ??_C@_0DC@FMAPNBJE@Turns?5fork?$CI?$CJ?5checking?5on?5?$CInon?9ze@
; `string'
??_C@_0DC@FMAPNBJE@Turns?5fork?$CI?$CJ?5checking?5on?5?$CInon?9ze@ db 'Turns fork() checking on (non-zero) or off (zero)',0
					; DATA XREF: .rdata:00000C20o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CE4h
; COMDAT (pick any)
		public ??_C@_0P@PLPNJEBB@THREAD_LOCKING?$AA@
; `string'
??_C@_0P@PLPNJEBB@THREAD_LOCKING?$AA@ db 'THREAD_LOCKING',0 ; DATA XREF: .rdata:00000C2Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CF4h
; COMDAT (pick any)
		public ??_C@_0DG@BPKOLNNM@Turns?5thread?9safe?5locking?5on?5?$CIze@
; `string'
??_C@_0DG@BPKOLNNM@Turns?5thread?9safe?5locking?5on?5?$CIze@ db	'Turns thread-safe locking on (zero) or off (non-zero)',0
					; DATA XREF: .rdata:00000C30o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D2Ch
; COMDAT (pick any)
		public ??_C@_0BD@HNMPJJDL@SET_USER_INTERFACE?$AA@
; `string'
??_C@_0BD@HNMPJJDL@SET_USER_INTERFACE?$AA@ db 'SET_USER_INTERFACE',0
					; DATA XREF: .rdata:00000C3Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D40h
; COMDAT (pick any)
		public ??_C@_0CJ@PMPFMPLL@Set?5the?5global?5user?5interface?5?$CIi@
; `string'
??_C@_0CJ@PMPFMPLL@Set?5the?5global?5user?5interface?5?$CIi@ db	'Set the global user interface (internal)',0
					; DATA XREF: .rdata:00000C40o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D6Ch
; COMDAT (pick any)
		public ??_C@_0BC@HOEJKHEO@SET_CALLBACK_DATA?$AA@
; `string'
??_C@_0BC@HOEJKHEO@SET_CALLBACK_DATA?$AA@ db 'SET_CALLBACK_DATA',0
					; DATA XREF: .rdata:00000C4Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D80h
; COMDAT (pick any)
		public ??_C@_0DE@BOALENFP@Set?5the?5global?5user?5interface?5ex@
; `string'
??_C@_0DE@BOALENFP@Set?5the?5global?5user?5interface?5ex@ db 'Set the global user interface extra data (internal)',0
					; DATA XREF: .rdata:00000C50o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DB4h
; COMDAT (pick any)
		public ??_C@_0BA@IBIFJOGM@CHIL?5RSA?5method?$AA@
; `string'
??_C@_0BA@IBIFJOGM@CHIL?5RSA?5method?$AA@ db 'CHIL RSA method',0
					; DATA XREF: .data:_hwcrhk_rsao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DC4h
; COMDAT (pick any)
		public ??_C@_0P@BEIIGDM@CHIL?5DH?5method?$AA@
; `string'
??_C@_0P@BEIIGDM@CHIL?5DH?5method?$AA@ db 'CHIL DH method',0 ; DATA XREF: .data:_hwcrhk_dho
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DD4h
; COMDAT (pick any)
		public ??_C@_04JHJDAOJH@chil?$AA@
; `string'
??_C@_04JHJDAOJH@chil?$AA@ db 'chil',0  ; DATA XREF: .data:_engine_hwcrhk_ido
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DDCh
; COMDAT (pick any)
		public ??_C@_0BN@PIPOENLH@CHIL?5hardware?5engine?5support?$AA@
; `string'
??_C@_0BN@PIPOENLH@CHIL?5hardware?5engine?5support?$AA@	db 'CHIL hardware engine support',0
					; DATA XREF: .data:_engine_hwcrhk_nameo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DFCh
; COMDAT (pick any)
		public ??_C@_07JOEMLHGJ@ncipher?$AA@
; `string'
??_C@_07JOEMLHGJ@ncipher?$AA@ db 'ncipher',0 ; DATA XREF: .data:_engine_hwcrhk_id_alto
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E04h
; COMDAT (pick any)
		public ??_C@_0BC@BNCGEAID@HWCryptoHook_Init?$AA@
; `string'
??_C@_0BC@BNCGEAID@HWCryptoHook_Init?$AA@ db 'HWCryptoHook_Init',0
					; DATA XREF: .data:_n_hwcrhk_Inito
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E18h
; COMDAT (pick any)
		public ??_C@_0BE@GGPPLDJL@HWCryptoHook_Finish?$AA@
; `string'
??_C@_0BE@GGPPLDJL@HWCryptoHook_Finish?$AA@ db 'HWCryptoHook_Finish',0
					; DATA XREF: .data:_n_hwcrhk_Finisho
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E2Ch
; COMDAT (pick any)
		public ??_C@_0BE@JMLLHLOD@HWCryptoHook_ModExp?$AA@
; `string'
??_C@_0BE@JMLLHLOD@HWCryptoHook_ModExp?$AA@ db 'HWCryptoHook_ModExp',0
					; DATA XREF: .data:_n_hwcrhk_ModExpo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E40h
; COMDAT (pick any)
		public ??_C@_0BB@DAMOFKMC@HWCryptoHook_RSA?$AA@
; `string'
??_C@_0BB@DAMOFKMC@HWCryptoHook_RSA?$AA@ db 'HWCryptoHook_RSA',0
					; DATA XREF: .data:_n_hwcrhk_RSAo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E54h
; COMDAT (pick any)
		public ??_C@_0BJ@BJBOJAH@HWCryptoHook_RandomBytes?$AA@
; `string'
??_C@_0BJ@BJBOJAH@HWCryptoHook_RandomBytes?$AA@	db 'HWCryptoHook_RandomBytes',0
					; DATA XREF: .data:_n_hwcrhk_RandomByteso
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E70h
; COMDAT (pick any)
		public ??_C@_0BI@LLPJLM@HWCryptoHook_RSALoadKey?$AA@
; `string'
??_C@_0BI@LLPJLM@HWCryptoHook_RSALoadKey?$AA@ db 'HWCryptoHook_RSALoadKey',0
					; DATA XREF: .data:_n_hwcrhk_RSALoadKeyo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E88h
; COMDAT (pick any)
		public ??_C@_0BN@IAFIFGLH@HWCryptoHook_RSAGetPublicKey?$AA@
; `string'
??_C@_0BN@IAFIFGLH@HWCryptoHook_RSAGetPublicKey?$AA@ db	'HWCryptoHook_RSAGetPublicKey',0
					; DATA XREF: .data:_n_hwcrhk_RSAGetPublicKeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0EA8h
; COMDAT (pick any)
		public ??_C@_0BK@KIEHKAED@HWCryptoHook_RSAUnloadKey?$AA@
; `string'
??_C@_0BK@KIEHKAED@HWCryptoHook_RSAUnloadKey?$AA@ db 'HWCryptoHook_RSAUnloadKey',0
					; DATA XREF: .data:_n_hwcrhk_RSAUnloadKeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0EC4h
; COMDAT (pick any)
		public ??_C@_0BH@DJCDBAB@HWCryptoHook_ModExpCRT?$AA@
; `string'
??_C@_0BH@DJCDBAB@HWCryptoHook_ModExpCRT?$AA@ db 'HWCryptoHook_ModExpCRT',0
					; DATA XREF: .data:_n_hwcrhk_ModExpCRTo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0EDCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_HWCRHK_error proc near		; CODE XREF: _hwcrhk_rsa_mod_exp+2D7p
					; _hwcrhk_ctrl+3Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_EEF
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_EEF:				; CODE XREF: _ERR_HWCRHK_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_HWCRHK_error endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F0Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_HWCRHK_strings proc near	; CODE XREF: _bind_helper+141p
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_F1F
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_F1F:				; CODE XREF: _ERR_load_HWCRHK_strings+7j
		cmp	_HWCRHK_error_init, 0
		jz	short locret_F6B
		push	offset _HWCRHK_str_functs
		push	eax
		mov	_HWCRHK_error_init, 0
		call	_ERR_load_strings
		push	offset _HWCRHK_str_reasons
		push	ds:_HWCRHK_lib_error_code
		call	_ERR_load_strings
		movzx	eax, byte ptr ds:_HWCRHK_lib_error_code
		shl	eax, 18h
		push	offset _HWCRHK_lib_name
		push	0
		mov	_HWCRHK_lib_name, eax
		call	_ERR_load_strings
		add	esp, 18h

locret_F6B:				; CODE XREF: _ERR_load_HWCRHK_strings+1Aj
		retn
_ERR_load_HWCRHK_strings endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_HWCRHK_strings proc	near
		cmp	_HWCRHK_error_init, 0
		jnz	short locret_FAE
		push	offset _HWCRHK_str_functs
		push	ds:_HWCRHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _HWCRHK_str_reasons
		push	ds:_HWCRHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _HWCRHK_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	_HWCRHK_error_init, 1

locret_FAE:				; CODE XREF: _ERR_unload_HWCRHK_strings+7j
		retn
_ERR_unload_HWCRHK_strings endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FB0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$10
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_FD7

loc_FD3:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_FD7:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_FD3
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_FD3

$skip_cbs$10:				; CODE XREF: _bind_engine+Cj
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	_bind_fn
		add	esp, 8
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	esi
		retn
_bind_engine	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1038h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_fn	proc near		; CODE XREF: _bind_engine+75p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_10A5
		mov	edx, _engine_hwcrhk_id
		mov	ecx, eax
		push	ebx

loc_1049:				; CODE XREF: _bind_fn+2Bj
		mov	bl, [ecx]
		cmp	bl, [edx]
		jnz	short loc_1069
		test	bl, bl
		jz	short loc_1065
		mov	bl, [ecx+1]
		cmp	bl, [edx+1]
		jnz	short loc_1069
		add	ecx, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_1049

loc_1065:				; CODE XREF: _bind_fn+19j
		xor	ecx, ecx
		jmp	short loc_106E
; ---------------------------------------------------------------------------

loc_1069:				; CODE XREF: _bind_fn+15j _bind_fn+21j
		sbb	ecx, ecx
		or	ecx, 1

loc_106E:				; CODE XREF: _bind_fn+2Fj
		pop	ebx
		test	ecx, ecx
		jz	short loc_10A5
		mov	ecx, _engine_hwcrhk_id_alt

loc_1079:				; CODE XREF: _bind_fn+5Bj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1099
		test	dl, dl
		jz	short loc_1095
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1099
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1079

loc_1095:				; CODE XREF: _bind_fn+49j
		xor	eax, eax
		jmp	short loc_109E
; ---------------------------------------------------------------------------

loc_1099:				; CODE XREF: _bind_fn+45j _bind_fn+51j
		sbb	eax, eax
		or	eax, 1

loc_109E:				; CODE XREF: _bind_fn+5Fj
		test	eax, eax
		jz	short loc_10A5
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10A5:				; CODE XREF: _bind_fn+6j _bind_fn+39j	...
		push	[esp+arg_0]
		call	_bind_helper
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_fn	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near		; CODE XREF: _bind_fn+71p

arg_0		= dword	ptr  4

		push	esi
		push	_engine_hwcrhk_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	_engine_hwcrhk_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_dh
		push	esi
		call	_ENGINE_set_DH
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_rand
		push	esi
		call	_ENGINE_set_RAND
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	loc_1205
		push	offset _hwcrhk_load_privkey
		push	esi
		call	_ENGINE_set_load_privkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_1205
		push	offset _hwcrhk_load_pubkey
		push	esi
		call	_ENGINE_set_load_pubkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_1205
		push	offset _hwcrhk_cmd_defns
		push	esi
		call	_ENGINE_set_cmd_defns
		add	esp, 8
		test	eax, eax
		jz	short loc_1205
		call	_RSA_PKCS1_SSLeay
		mov	ecx, [eax+4]
		mov	dword_E8, ecx
		mov	ecx, [eax+8]
		mov	dword_EC, ecx
		mov	ecx, [eax+0Ch]
		mov	dword_F0, ecx
		mov	eax, [eax+10h]
		mov	dword_F4, eax
		call	_DH_OpenSSL
		mov	ecx, [eax+4]
		mov	dword_120, ecx
		mov	eax, [eax+8]
		mov	dword_124, eax
		call	_ERR_load_HWCRHK_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1205:				; CODE XREF: _bind_helper+16j
					; _bind_helper+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_helper	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 120Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_free_HWCRHK_LIBNAME proc near
		mov	eax, ds:_HWCRHK_LIBNAME
		test	eax, eax
		jz	short loc_121E
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_121E:				; CODE XREF: _free_HWCRHK_LIBNAME+7j
		mov	ds:_HWCRHK_LIBNAME, 0
		retn
_free_HWCRHK_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 122Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_HWCRHK_LIBNAME proc near
		mov	ecx, ds:_HWCRHK_LIBNAME
		mov	eax, offset ??_C@_08OKMEGKNO@nfhwcrhk?$AA@ ; "nfhwcrhk"
		test	ecx, ecx
		cmovnz	eax, ecx
		retn
_get_HWCRHK_LIBNAME endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1240h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_context	proc near

var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 40Ch
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+40Ch+var_4], eax
		mov	eax, [esp+40Ch+arg_4]
		lea	ecx, [esp+40Ch+var_404]
		push	esi
		mov	esi, [esp+410h+arg_0]
		push	eax
		lea	eax, [esp+414h+var_40C]
		mov	[esp+414h+var_40C], ecx
		push	eax
		push	54h ; 'T'
		push	offset _hwcrhk_globals
		mov	[esp+420h+var_408], 400h
		call	ds:_p_hwcrhk_Init
		xor	ecx, ecx
		mov	[esi], eax
		add	esp, 10h
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		mov	ecx, [esp+410h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 40Ch
		retn
_get_context	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 12B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_ctrl	proc near		; DATA XREF: _bind_helper+B7o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_4]
		dec	eax
		push	edi
		mov	edi, 1
		cmp	eax, 0CBh ; '' ; switch 204 cases
		ja	$LN19		; jumptable 000012CD default case
		movzx	eax, ds:$LN24[eax]
		jmp	ds:$LN27[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		cmp	ds:_hwcrhk_dso,	0 ; jumptable 000012CD case 199
		jz	short loc_12F7
		push	2ABh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	64h ; 'd'
		push	64h ; 'd'
		call	_ERR_HWCRHK_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_12F7:				; CODE XREF: _hwcrhk_ctrl+2Bj
		mov	eax, [esp+4+arg_C]
		test	eax, eax
		jnz	short loc_1319
		push	2AFh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	43h ; 'C'
		push	64h ; 'd'
		call	_ERR_HWCRHK_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1319:				; CODE XREF: _hwcrhk_ctrl+4Dj
		push	eax
		call	_set_HWCRHK_LIBNAME
		add	esp, 4
		pop	edi
		retn
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2B7h		; jumptable 000012CD case 0
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, ds:_logstream
		add	esp, 10h
		test	eax, eax
		jz	short loc_1356
		push	eax
		call	_BIO_free
		add	esp, 4
		mov	ds:_logstream, 0

loc_1356:				; CODE XREF: _hwcrhk_ctrl+91j
		push	esi
		mov	esi, [esp+8+arg_C]
		push	2BCh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	15h
		lea	eax, [esi+2Ch]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h
		cmp	eax, 1
		jle	short loc_1382
		mov	ds:_logstream, esi
		jmp	short loc_1398
; ---------------------------------------------------------------------------

loc_1382:				; CODE XREF: _hwcrhk_ctrl+C8j
		push	2BFh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	65h ; 'e'
		push	64h ; 'd'
		call	_ERR_HWCRHK_error
		add	esp, 10h

loc_1398:				; CODE XREF: _hwcrhk_ctrl+D0j
		push	2C1h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, edi
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

$LN11:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2C4h		; jumptable 000012CD case 1
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, [esp+14h+arg_10]
		mov	ds:_password_context, eax
		push	2C6h

loc_13D4:				; CODE XREF: _hwcrhk_ctrl+15Aj
					; _hwcrhk_ctrl+17Dj ...
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 20h
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2CAh		; jumptable 000012CD cases 3,202
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, [esp+14h+arg_C]
		mov	ds:dword_39C, eax
		push	2CCh
		jmp	short loc_13D4
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2D0h		; jumptable 000012CD cases 4,203
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, [esp+14h+arg_C]
		mov	ds:dword_3A0, eax
		push	2D2h
		jmp	short loc_13D4
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2DAh		; jumptable 000012CD cases 99,200
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	ecx, _hwcrhk_globals
		mov	eax, ecx
		or	eax, 10h
		and	ecx, 0FFFFFFEFh
		cmp	[esp+14h+arg_8], 0
		push	2DFh
		cmovnz	ecx, eax
		mov	_hwcrhk_globals, ecx
		jmp	loc_13D4
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2E9h		; jumptable 000012CD case 100
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	ds:_disable_mutex_callbacks, edi
		push	2EBh
		jmp	loc_13D4
; ---------------------------------------------------------------------------

$LN18:					; CODE XREF: _hwcrhk_ctrl+1Dj
					; DATA XREF: .text$mn:$LN27o
		push	2EEh		; jumptable 000012CD case 201
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		xor	eax, eax
		cmp	[esp+14h+arg_8], eax
		push	2F0h
		setnz	al
		mov	ds:_disable_mutex_callbacks, eax
		jmp	loc_13D4
; ---------------------------------------------------------------------------

$LN19:					; CODE XREF: _hwcrhk_ctrl+10j
					; _hwcrhk_ctrl+1Dj
					; DATA XREF: ...
		mov	eax, ds:_HWCRHK_lib_error_code ; jumptable 000012CD default case
		test	eax, eax
		jnz	short loc_14C9
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_14C9:				; CODE XREF: _hwcrhk_ctrl+20Dj
		push	2F6h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	67h ; 'g'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	edi, edi
		mov	eax, edi
		pop	edi
		retn
_hwcrhk_ctrl	endp

; ---------------------------------------------------------------------------
		align 4
$LN27		dd offset $LN7,	offset $LN11, offset $LN12, offset $LN13
					; DATA XREF: _hwcrhk_ctrl+1Dr
		dd offset $LN14, offset	$LN17, offset $LN4, offset $LN18 ; jump	table for switch statement
		dd offset $LN19
$LN24		db 0, 1, 8, 2, 3, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
					; DATA XREF: _hwcrhk_ctrl+16r
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8	; indirect table for switch statement
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 4, 5, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 8, 8, 8, 8, 8, 8,	8, 8, 8, 8, 8, 8, 8, 8,	8, 8, 8
		db 8, 6, 4, 7, 2, 3
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 15D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_destroy	proc near		; DATA XREF: _bind_helper+75o
		mov	eax, ds:_HWCRHK_LIBNAME
		test	eax, eax
		jz	short loc_15EA
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_15EA:				; CODE XREF: _hwcrhk_destroy+7j
		cmp	_HWCRHK_error_init, 0
		mov	ds:_HWCRHK_LIBNAME, 0
		jnz	short loc_1636
		push	offset _HWCRHK_str_functs
		push	ds:_HWCRHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _HWCRHK_str_reasons
		push	ds:_HWCRHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _HWCRHK_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	_HWCRHK_error_init, 1

loc_1636:				; CODE XREF: _hwcrhk_destroy+23j
		mov	eax, 1
		retn
_hwcrhk_destroy	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 163Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_finish	proc near		; DATA XREF: _bind_helper+A1o
		mov	eax, ds:_HWCRHK_LIBNAME
		push	esi
		mov	esi, 1
		test	eax, eax
		jz	short loc_1654
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1654:				; CODE XREF: _hwcrhk_finish+Dj
		cmp	ds:_hwcrhk_dso,	0
		mov	ds:_HWCRHK_LIBNAME, 0
		jnz	short loc_1688
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_167A
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_167A:				; CODE XREF: _hwcrhk_finish+32j
		push	288h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Bh ; 'k'
		jmp	short loc_16C5
; ---------------------------------------------------------------------------

loc_1688:				; CODE XREF: _hwcrhk_finish+29j
		push	ds:_hwcrhk_context
		call	ds:_p_hwcrhk_Finish
		push	ds:_hwcrhk_dso
		call	_DSO_free
		add	esp, 8
		test	eax, eax
		jnz	short $err$19
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_16B9
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_16B9:				; CODE XREF: _hwcrhk_finish+71j
		push	28Eh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	68h ; 'h'

loc_16C5:				; CODE XREF: _hwcrhk_finish+4Aj
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi

$err$19:				; CODE XREF: _hwcrhk_finish+68j
		mov	eax, ds:_logstream
		test	eax, eax
		jz	short loc_16E4
		push	eax
		call	_BIO_free
		add	esp, 4

loc_16E4:				; CODE XREF: _hwcrhk_finish+9Dj
		mov	eax, esi
		mov	ds:_hwcrhk_dso,	0
		mov	ds:_p_hwcrhk_Init, 0
		mov	ds:_p_hwcrhk_Finish, 0
		mov	ds:_p_hwcrhk_ModExp, 0
		mov	ds:_p_hwcrhk_RSA, 0
		mov	ds:_p_hwcrhk_RSALoadKey, 0
		mov	ds:_p_hwcrhk_RSAGetPublicKey, 0
		mov	ds:_p_hwcrhk_RSAUnloadKey, 0
		mov	ds:_p_hwcrhk_ModExpCRT,	0
		mov	ds:_p_hwcrhk_RandomBytes, 0
		pop	esi
		retn
_hwcrhk_finish	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 174Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_init	proc near		; DATA XREF: _bind_helper+8Bo

var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4

		mov	eax, 418h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+418h+var_4], eax
		cmp	ds:_hwcrhk_dso,	0
		push	ebx
		push	ebp
		push	esi
		push	edi
		jz	short loc_1795
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1784
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1784:				; CODE XREF: _hwcrhk_init+2Cj
		push	226h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	64h ; 'd'
		jmp	loc_1A0F
; ---------------------------------------------------------------------------

loc_1795:				; CODE XREF: _hwcrhk_init+23j
		mov	eax, ds:_HWCRHK_LIBNAME
		mov	ecx, offset ??_C@_08OKMEGKNO@nfhwcrhk?$AA@ ; "nfhwcrhk"
		test	eax, eax
		push	0
		cmovnz	ecx, eax
		push	0
		push	ecx
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_hwcrhk_dso,	eax
		test	eax, eax
		jnz	short loc_17D9
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_17CF
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_17CF:				; CODE XREF: _hwcrhk_init+77j
		push	22Ch
		jmp	loc_1A08
; ---------------------------------------------------------------------------

loc_17D9:				; CODE XREF: _hwcrhk_init+6Ej
		push	_n_hwcrhk_Init
		push	eax
		call	_DSO_bind_func
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_19F0
		push	_n_hwcrhk_Finish
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_19F0
		push	_n_hwcrhk_ModExp
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_19F0
		push	_n_hwcrhk_RSA
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	loc_19F0
		push	_n_hwcrhk_RSALoadKey
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+428h+var_410], eax
		test	eax, eax
		jz	loc_19F0
		push	_n_hwcrhk_RSAGetPublicKey
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+428h+var_40C], eax
		test	eax, eax
		jz	loc_19F0
		push	_n_hwcrhk_RSAUnloadKey
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+428h+var_408], eax
		test	eax, eax
		jz	loc_19F0
		push	_n_hwcrhk_RandomBytes
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+428h+var_418], eax
		test	eax, eax
		jz	loc_19F0
		push	_n_hwcrhk_ModExpCRT
		push	ds:_hwcrhk_dso
		call	_DSO_bind_func
		mov	ecx, eax
		add	esp, 8
		test	ecx, ecx
		jz	loc_19F0
		cmp	ds:_disable_mutex_callbacks, 0
		mov	eax, [esp+428h+var_410]
		mov	ds:_p_hwcrhk_RSALoadKey, eax
		mov	eax, [esp+428h+var_40C]
		mov	ds:_p_hwcrhk_RSAGetPublicKey, eax
		mov	eax, [esp+428h+var_408]
		mov	ds:_p_hwcrhk_RSAUnloadKey, eax
		mov	eax, [esp+428h+var_418]
		mov	ds:_p_hwcrhk_Init, esi
		mov	ds:_p_hwcrhk_Finish, edi
		mov	ds:_p_hwcrhk_ModExp, ebx
		mov	ds:_p_hwcrhk_RSA, ebp
		mov	ds:_p_hwcrhk_RandomBytes, eax
		mov	ds:_p_hwcrhk_ModExpCRT,	ecx
		jnz	short loc_1978
		call	_CRYPTO_get_dynlock_create_callback
		test	eax, eax
		jz	short loc_1978
		call	_CRYPTO_get_dynlock_lock_callback
		test	eax, eax
		jz	short loc_1978
		call	_CRYPTO_get_dynlock_destroy_callback
		test	eax, eax
		jz	short loc_1978
		mov	dword_188, offset _hwcrhk_mutex_init
		mov	dword_18C, offset _hwcrhk_mutex_lock
		mov	dword_190, offset _hwcrhk_mutex_unlock
		mov	dword_194, offset _hwcrhk_mutex_destroy

loc_1978:				; CODE XREF: _hwcrhk_init+1E7j
					; _hwcrhk_init+1F0j ...
		lea	eax, [esp+428h+var_404]
		mov	[esp+428h+var_414], 400h
		mov	[esp+428h+var_418], eax
		lea	eax, [esp+428h+var_418]
		push	offset _password_context
		push	eax
		push	54h ; 'T'
		push	offset _hwcrhk_globals
		call	ds:_p_hwcrhk_Init
		add	esp, 10h
		mov	ds:_hwcrhk_context, eax
		test	eax, eax
		jnz	short loc_19C3
		push	266h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	71h ; 'q'
		push	67h ; 'g'
		call	_ERR_HWCRHK_error
		add	esp, 10h
		jmp	short $err$32
; ---------------------------------------------------------------------------

loc_19C3:				; CODE XREF: _hwcrhk_init+25Dj
		cmp	_hndidx_rsa, 0FFFFFFFFh
		jnz	short loc_19E6
		push	0
		push	0
		push	0
		push	offset ??_C@_0CC@FIICGL@nFast?5HWCryptoHook?5RSA?5key?5handl@ ;	"nFast HWCryptoHook RSA	key handle"
		push	0
		call	_RSA_get_ex_new_index
		add	esp, 14h
		mov	_hndidx_rsa, eax

loc_19E6:				; CODE XREF: _hwcrhk_init+27Ej
		mov	eax, 1
		jmp	loc_1A92
; ---------------------------------------------------------------------------

loc_19F0:				; CODE XREF: _hwcrhk_init+A0j
					; _hwcrhk_init+BEj ...
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1A03
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1A03:				; CODE XREF: _hwcrhk_init+2ABj
		push	243h

loc_1A08:				; CODE XREF: _hwcrhk_init+88j
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	68h ; 'h'

loc_1A0F:				; CODE XREF: _hwcrhk_init+44j
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$32:				; CODE XREF: _hwcrhk_init+275j
		mov	eax, ds:_hwcrhk_dso
		test	eax, eax
		jz	short loc_1A2C
		push	eax
		call	_DSO_free
		add	esp, 4

loc_1A2C:				; CODE XREF: _hwcrhk_init+2D5j
		mov	ds:_hwcrhk_dso,	0
		xor	eax, eax
		mov	ds:_p_hwcrhk_Init, 0
		mov	ds:_p_hwcrhk_Finish, 0
		mov	ds:_p_hwcrhk_ModExp, 0
		mov	ds:_p_hwcrhk_RSA, 0
		mov	ds:_p_hwcrhk_RSALoadKey, 0
		mov	ds:_p_hwcrhk_RSAGetPublicKey, 0
		mov	ds:_p_hwcrhk_RSAUnloadKey, 0
		mov	ds:_p_hwcrhk_ModExpCRT,	0
		mov	ds:_p_hwcrhk_RandomBytes, 0

loc_1A92:				; CODE XREF: _hwcrhk_init+29Fj
		mov	ecx, [esp+428h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
_hwcrhk_init	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1AACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_load_privkey proc near		; CODE XREF: _hwcrhk_load_pubkey+11p
					; DATA XREF: _bind_helper+CDo

var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 428h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+428h+var_4], eax
		cmp	ds:_hwcrhk_context, 0
		mov	eax, [esp+428h+arg_0]
		push	ebx
		mov	ebx, [esp+42Ch+arg_8]
		push	ebp
		mov	ebp, [esp+430h+arg_C]
		push	esi
		mov	esi, [esp+434h+arg_4]
		mov	[esp+434h+var_410], eax
		lea	eax, [esp+434h+var_404]
		push	edi
		mov	[esp+438h+var_428], eax
		mov	[esp+438h+var_424], 400h
		jnz	short loc_1B32
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1B14
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1B14:				; CODE XREF: _hwcrhk_load_privkey+5Cj
		push	316h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ah ; 'j'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		jmp	loc_1DE2
; ---------------------------------------------------------------------------

loc_1B32:				; CODE XREF: _hwcrhk_load_privkey+53j
		push	31Ah
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	4
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1B7D
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1B5F
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1B5F:				; CODE XREF: _hwcrhk_load_privkey+A7j
		push	31Ch
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	41h ; 'A'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		jmp	loc_1DE2
; ---------------------------------------------------------------------------

loc_1B7D:				; CODE XREF: _hwcrhk_load_privkey+9Ej
		lea	eax, [esp+438h+var_40C]
		mov	[esp+438h+var_40C], ebx
		push	eax
		lea	eax, [esp+43Ch+var_428]
		mov	[esp+43Ch+var_408], ebp
		push	eax
		push	edi
		push	esi
		push	ds:_hwcrhk_context
		call	ds:_p_hwcrhk_RSALoadKey
		add	esp, 14h
		test	eax, eax
		jz	short loc_1BE0
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1BB7
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1BB7:				; CODE XREF: _hwcrhk_load_privkey+FFj
		push	322h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	66h ; 'f'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		push	[esp+44Ch+var_428]
		push	1
		call	_ERR_add_error_data
		add	esp, 1Ch
		xor	eax, eax
		jmp	loc_1DE2
; ---------------------------------------------------------------------------

loc_1BE0:				; CODE XREF: _hwcrhk_load_privkey+F6j
		cmp	dword ptr [edi], 0
		jnz	short loc_1C16
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1BF8
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1BF8:				; CODE XREF: _hwcrhk_load_privkey+140j
		push	327h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Dh ; 'm'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		jmp	loc_1DE2
; ---------------------------------------------------------------------------

loc_1C16:				; CODE XREF: _hwcrhk_load_privkey+137j
		push	[esp+438h+var_410]
		call	_RSA_new_method
		push	edi
		push	_hndidx_rsa
		mov	esi, eax
		push	esi
		call	_RSA_set_ex_data
		call	_BN_new
		mov	[esi+14h], eax
		call	_BN_new
		or	dword ptr [esi+3Ch], 20h
		mov	[esi+10h], eax
		mov	eax, [esi+14h]
		mov	eax, [eax+8]
		shl	eax, 2
		mov	[esp+448h+var_41C], eax
		mov	eax, [esi+14h]
		mov	eax, [eax]
		mov	[esp+448h+var_420], eax
		mov	eax, [esi+10h]
		mov	eax, [eax+8]
		shl	eax, 2
		mov	[esp+448h+var_414], eax
		mov	eax, [esi+10h]
		mov	eax, [eax]
		mov	[esp+448h+var_418], eax
		lea	eax, [esp+448h+var_428]
		push	eax
		lea	eax, [esp+44Ch+var_420]
		push	eax
		lea	eax, [esp+450h+var_418]
		push	eax
		push	dword ptr [edi]
		call	ds:_p_hwcrhk_RSAGetPublicKey
		add	esp, 20h
		cmp	eax, 0FFFFFFFDh
		jz	short loc_1CBE
		push	335h

loc_1C92:				; CODE XREF: _hwcrhk_load_privkey+281j
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	66h ; 'f'
		push	69h ; 'i'
		call	_ERR_HWCRHK_error
		push	[esp+448h+var_428]
		push	1
		call	_ERR_add_error_data
		add	esp, 18h
		push	esi
		call	_RSA_free
		add	esp, 4
		xor	eax, eax
		jmp	loc_1DE2
; ---------------------------------------------------------------------------

loc_1CBE:				; CODE XREF: _hwcrhk_load_privkey+1DFj
		mov	eax, [esp+438h+var_41C]
		shr	eax, 2
		push	eax
		push	dword ptr [esi+14h]
		call	_bn_expand2
		mov	eax, [esp+440h+var_414]
		shr	eax, 2
		push	eax
		push	dword ptr [esi+10h]
		call	_bn_expand2
		mov	eax, [esi+14h]
		mov	eax, [eax+8]
		shl	eax, 2
		mov	[esp+448h+var_41C], eax
		mov	eax, [esi+14h]
		mov	eax, [eax]
		mov	[esp+448h+var_420], eax
		mov	eax, [esi+10h]
		mov	eax, [eax+8]
		shl	eax, 2
		mov	[esp+448h+var_414], eax
		mov	eax, [esi+10h]
		mov	eax, [eax]
		mov	[esp+448h+var_418], eax
		lea	eax, [esp+448h+var_428]
		push	eax
		lea	eax, [esp+44Ch+var_420]
		push	eax
		lea	eax, [esp+450h+var_418]
		push	eax
		push	dword ptr [edi]
		call	ds:_p_hwcrhk_RSAGetPublicKey
		add	esp, 20h
		test	eax, eax
		jz	short loc_1D32
		push	340h
		jmp	loc_1C92
; ---------------------------------------------------------------------------

loc_1D32:				; CODE XREF: _hwcrhk_load_privkey+27Aj
		mov	ecx, [esp+438h+var_41C]
		mov	eax, [esi+14h]
		shr	ecx, 2
		mov	[eax+4], ecx
		mov	edi, [esi+14h]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jle	short loc_1D62
		mov	eax, [edi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_1D51:				; CODE XREF: _hwcrhk_load_privkey+2B1j
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1D5F
		dec	ecx
		test	ecx, ecx
		jg	short loc_1D51

loc_1D5F:				; CODE XREF: _hwcrhk_load_privkey+2ACj
		mov	[edi+4], ecx

loc_1D62:				; CODE XREF: _hwcrhk_load_privkey+29Bj
		mov	ecx, [esp+438h+var_414]
		mov	eax, [esi+10h]
		shr	ecx, 2
		mov	[eax+4], ecx
		mov	edi, [esi+10h]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jle	short loc_1D92
		mov	eax, [edi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_1D81:				; CODE XREF: _hwcrhk_load_privkey+2E1j
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1D8F
		dec	ecx
		test	ecx, ecx
		jg	short loc_1D81

loc_1D8F:				; CODE XREF: _hwcrhk_load_privkey+2DCj
		mov	[edi+4], ecx

loc_1D92:				; CODE XREF: _hwcrhk_load_privkey+2CBj
		call	_EVP_PKEY_new
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1DD4
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1DB0
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1DB0:				; CODE XREF: _hwcrhk_load_privkey+2F8j
		push	34Bh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	66h ; 'f'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$52:
		push	esi
		call	_RSA_free
		add	esp, 4
		xor	eax, eax
		jmp	short loc_1DE2
; ---------------------------------------------------------------------------

loc_1DD4:				; CODE XREF: _hwcrhk_load_privkey+2EFj
		push	esi
		push	6
		push	edi
		call	_EVP_PKEY_assign
		add	esp, 0Ch
		mov	eax, edi

loc_1DE2:				; CODE XREF: _hwcrhk_load_privkey+81j
					; _hwcrhk_load_privkey+CCj ...
		mov	ecx, [esp+438h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 428h
		retn
_hwcrhk_load_privkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1DFCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_load_pubkey proc near		; DATA XREF: _bind_helper+DFo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_hwcrhk_load_privkey
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	loc_1EB1
		cmp	dword ptr [edi], 6
		jz	short loc_1E58
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1E37
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1E37:				; CODE XREF: _hwcrhk_load_pubkey+2Fj
		push	37Ch
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	67h ; 'g'
		push	6Ah ; 'j'
		push	eax
		call	_ERR_put_error

$err$13:
		push	edi
		call	_EVP_PKEY_free
		add	esp, 18h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1E58:				; CODE XREF: _hwcrhk_load_pubkey+26j
		push	esi
		push	36Eh
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	0Ah
		push	9
		call	_CRYPTO_lock
		mov	esi, [edi+14h]
		call	_RSA_new
		mov	[edi+14h], eax
		mov	ecx, [esi+10h]
		push	375h
		mov	[eax+10h], ecx
		mov	ecx, [edi+14h]
		mov	eax, [esi+14h]
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	0Ah
		mov	[ecx+14h], eax
		push	0Ah
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0
		call	_CRYPTO_lock
		push	esi
		call	_RSA_free
		add	esp, 24h
		pop	esi

loc_1EB1:				; CODE XREF: _hwcrhk_load_pubkey+1Dj
		mov	eax, edi
		pop	edi
		retn
_hwcrhk_load_pubkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1EB8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mod_exp	proc near		; CODE XREF: _hwcrhk_mod_exp_mont+14p
					; _hwcrhk_mod_exp_dh+14p

var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 418h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+418h+var_4], eax
		cmp	ds:_hwcrhk_context, 0
		mov	eax, [esp+418h+arg_8]
		push	ebx
		mov	ebx, [esp+41Ch+arg_C]
		push	ebp
		mov	ebp, [esp+420h+arg_4]
		mov	[esp+420h+var_418], eax
		lea	eax, [esp+420h+var_404]
		push	edi
		mov	edi, [esp+424h+arg_0]
		mov	[esp+424h+var_40C], eax
		mov	[esp+424h+var_408], 400h
		jnz	short loc_1F50
		mov	eax, ds:_HWCRHK_lib_error_code
		test	eax, eax
		jnz	short loc_1F1F
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1F1F:				; CODE XREF: _hwcrhk_mod_exp+5Bj
		push	39Ah
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Ah ; 'j'
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+418h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
; ---------------------------------------------------------------------------

loc_1F50:				; CODE XREF: _hwcrhk_mod_exp+52j
		push	esi
		push	dword ptr [ebx+4]
		push	edi
		call	_bn_expand2
		mov	eax, [edi+8]
		mov	ecx, [ebx+4]
		mov	edx, [esp+430h+var_418]
		mov	esi, [ebp+4]
		shl	eax, 2
		mov	[esp+430h+var_410], eax
		mov	eax, [edi]
		mov	edx, [edx+4]
		mov	[esp+430h+var_414], eax
		lea	eax, [esp+430h+var_40C]
		push	eax
		lea	eax, [esp+434h+var_414]
		shl	ecx, 2
		push	eax
		mov	eax, [esp+438h+var_418]
		push	ecx
		push	dword ptr [ebx]
		shl	edx, 2
		push	edx
		push	dword ptr [eax]
		shl	esi, 2
		push	esi
		push	dword ptr [ebp+0]
		push	ds:_hwcrhk_context
		call	ds:_p_hwcrhk_ModExp
		mov	ecx, [esp+454h+var_410]
		add	esp, 2Ch
		shr	ecx, 2
		mov	esi, eax
		mov	[edi+4], ecx
		test	ecx, ecx
		jle	short loc_1FD0
		mov	edx, [edi]
		lea	edx, [edx+ecx*4]
		add	edx, 0FFFFFFFCh

loc_1FBF:				; CODE XREF: _hwcrhk_mod_exp+113j
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1FCD
		dec	ecx
		test	ecx, ecx
		jg	short loc_1FBF

loc_1FCD:				; CODE XREF: _hwcrhk_mod_exp+10Ej
		mov	[edi+4], ecx

loc_1FD0:				; CODE XREF: _hwcrhk_mod_exp+FDj
		test	esi, esi
		jns	short loc_2031
		mov	eax, ds:_HWCRHK_lib_error_code
		cmp	esi, 0FFFFFFFEh
		jnz	short loc_1FFA
		test	eax, eax
		jnz	short loc_1FEC
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_1FEC:				; CODE XREF: _hwcrhk_mod_exp+128j
		push	3B1h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	70h ; 'p'
		jmp	short loc_2014
; ---------------------------------------------------------------------------

loc_1FFA:				; CODE XREF: _hwcrhk_mod_exp+124j
		test	eax, eax
		jnz	short loc_2008
		call	_ERR_get_next_error_library
		mov	ds:_HWCRHK_lib_error_code, eax

loc_2008:				; CODE XREF: _hwcrhk_mod_exp+144j
		push	3B3h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	6Fh ; 'o'

loc_2014:				; CODE XREF: _hwcrhk_mod_exp+140j
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		push	[esp+428h+var_40C]
		push	1
		call	_ERR_add_error_data
		add	esp, 8
		xor	eax, eax
		jmp	short loc_2036
; ---------------------------------------------------------------------------

loc_2031:				; CODE XREF: _hwcrhk_mod_exp+11Aj
		mov	eax, 1

loc_2036:				; CODE XREF: _hwcrhk_mod_exp+177j
		pop	esi

$err$29:
		mov	ecx, [esp+424h+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
_hwcrhk_mod_exp	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2050h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mutex_destroy proc near		; DATA XREF: _hwcrhk_init+222o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax]
		call	_CRYPTO_destroy_dynlockid
		pop	ecx
		retn
_hwcrhk_mutex_destroy endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2060h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mutex_init proc	near		; DATA XREF: _hwcrhk_init+204o

arg_0		= dword	ptr  4

		call	_CRYPTO_get_new_dynlockid
		mov	ecx, [esp+arg_0]
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		setz	al
		mov	[ecx], edx
		retn
_hwcrhk_mutex_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2078h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mutex_lock proc	near		; DATA XREF: _hwcrhk_init+20Eo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	48Ah
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	dword ptr [eax]
		push	9
		call	_CRYPTO_lock
		add	esp, 10h
		xor	eax, eax
		retn
_hwcrhk_mutex_lock endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2098h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_hwcrhk_mutex_unlock proc near		; DATA XREF: _hwcrhk_init+218o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	490h
		push	offset ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ ;	".\\engines\\e_chil.c"
		push	dword ptr [eax]
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		retn
_hwcrhk_mutex_unlock endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 20B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_release_context proc near
		jmp	ds:_p_hwcrhk_Finish
_release_context endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 20BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_set_HWCRHK_LIBNAME proc near		; CODE XREF: _hwcrhk_ctrl+6Ap

arg_0		= dword	ptr  4

		mov	eax, ds:_HWCRHK_LIBNAME
		test	eax, eax
		jz	short loc_20CE
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_20CE:				; CODE XREF: _set_HWCRHK_LIBNAME+7j
		push	[esp+arg_0]
		mov	ds:_HWCRHK_LIBNAME, 0
		call	_BUF_strdup
		xor	ecx, ecx
		mov	ds:_HWCRHK_LIBNAME, eax
		add	esp, 4
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		retn
_set_HWCRHK_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 20F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 210Ch
; COMDAT (pick any)
		public ??_C@_08OKMEGKNO@nfhwcrhk?$AA@
; `string'
??_C@_08OKMEGKNO@nfhwcrhk?$AA@ db 'nfhwcrhk',0 ; DATA XREF: _get_HWCRHK_LIBNAME+6o
					; _hwcrhk_init+4Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2118h
; COMDAT (pick any)
		public ??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@
; `string'
??_C@_0BD@KHDDJGFL@?4?2engines?2e_chil?4c?$AA@ db '.\engines\e_chil.c',0
					; DATA XREF: _hwcrhk_rsa_mod_exp+6Do
					; _hwcrhk_rsa_mod_exp+15Do ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 212Ch
; COMDAT (pick any)
		public ??_C@_0CC@FIICGL@nFast?5HWCryptoHook?5RSA?5key?5handl@
; `string'
??_C@_0CC@FIICGL@nFast?5HWCryptoHook?5RSA?5key?5handl@ db 'nFast HWCryptoHook RSA key handle',0
					; DATA XREF: _hwcrhk_init+286o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2150h
; COMDAT (pick any)
		public ??_C@_0M@FKGGGFHP@pass?5phrase?$AA@
; `string'
??_C@_0M@FKGGGFHP@pass?5phrase?$AA@ db 'pass phrase',0 ; DATA XREF: _hwcrhk_get_pass+A8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 215Ch
; COMDAT (pick any)
		public ??_C@_0BE@OBBPALOK@Current?5card?3?5?$CC?$CFs?$CC?6?$AA@
; `string'
??_C@_0BE@OBBPALOK@Current?5card?3?5?$CC?$CFs?$CC?6?$AA@ db 'Current card: "%s"',0Ah,0
					; DATA XREF: _hwcrhk_insert_card+BEo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2170h
; COMDAT (pick any)
		public ??_C@_0BB@ENAEFLLN@Insert?5card?5?$CC?$CFs?$CC?$AA@
; `string'
??_C@_0BB@ENAEFLLN@Insert?5card?5?$CC?$CFs?$CC?$AA@ db 'Insert card "%s"',0
					; DATA XREF: _hwcrhk_insert_card+F9o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2184h
; COMDAT (pick any)
		public ??_C@_02DMLCCNBA@Cc?$AA@
; `string'
??_C@_02DMLCCNBA@Cc?$AA@ db 43h, 63h, 0	; DATA XREF: _hwcrhk_insert_card+114o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2188h
; COMDAT (pick any)
		public ??_C@_02PCIJFNDE@?$AN?6?$AA@
; `string'
??_C@_02PCIJFNDE@?$AN?6?$AA@ db	0Dh, 0Ah, 0 ; DATA XREF: _hwcrhk_insert_card+119o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 218Ch
; COMDAT (pick any)
		public ??_C@_0CK@BPFHOIG@?6?5then?5hit?5?$DMenter?$DO?5or?5C?$DMenter?$DO?5t@
; `string'
??_C@_0CK@BPFHOIG@?6?5then?5hit?5?$DMenter?$DO?5or?5C?$DMenter?$DO?5t@ db 0Ah
					; DATA XREF: _hwcrhk_insert_card+11Eo
		db ' then hit <enter> or C<enter> to cancel',0Ah,0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 21B8h
; COMDAT (pick any)
		public ??_C@_03OFAPEBGM@?$CFs?6?$AA@
; `string'
??_C@_03OFAPEBGM@?$CFs?6?$AA@ dd 0A7325h ; DATA	XREF: _hwcrhk_log_message+28o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_lock:near	; CODE XREF: _hwcrhk_log_message+Ep
					; _hwcrhk_log_message+44p ...
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_add_lock:near ; CODE XREF: _hwcrhk_ctrl+BDp
		extrn _CRYPTO_get_new_dynlockid:near ; CODE XREF: _hwcrhk_mutex_initp
		extrn _CRYPTO_destroy_dynlockid:near ; CODE XREF: _hwcrhk_mutex_destroy+6p
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_get_dynlock_create_callback:near
					; CODE XREF: _hwcrhk_init+1E9p
		extrn _CRYPTO_get_dynlock_lock_callback:near ; CODE XREF: _hwcrhk_init+1F2p
		extrn _CRYPTO_get_dynlock_destroy_callback:near
					; CODE XREF: _hwcrhk_init+1FBp
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_malloc:near ; CODE XREF: _hwcrhk_load_privkey+92p
		extrn _CRYPTO_free:near	; CODE XREF: _hwcrhk_rsa_finish+24p
					; _hwcrhk_get_pass+130p ...
		extrn _BIO_free:near	; CODE XREF: _hwcrhk_ctrl+94p
					; _hwcrhk_finish+A0p
		extrn _BIO_printf:near	; CODE XREF: _hwcrhk_log_message+2Ep
		extrn _BIO_snprintf:near ; CODE	XREF: _hwcrhk_insert_card+CDp
					; _hwcrhk_insert_card+108p
		extrn _BN_new:near	; CODE XREF: _hwcrhk_load_privkey+182p
					; _hwcrhk_load_privkey+18Ap
		extrn _bn_expand2:near	; CODE XREF: _hwcrhk_rsa_mod_exp+DBp
					; _hwcrhk_rsa_mod_exp+1D7p ...
		extrn _EVP_PKEY_assign:near ; CODE XREF: _hwcrhk_load_privkey+32Cp
		extrn _EVP_PKEY_new:near ; CODE	XREF: _hwcrhk_load_privkey:loc_1D92p
		extrn _EVP_PKEY_free:near ; CODE XREF: _hwcrhk_load_pubkey+50p
		extrn _BUF_strdup:near	; CODE XREF: _set_HWCRHK_LIBNAME+20p
		extrn _RSA_new:near	; CODE XREF: _hwcrhk_load_pubkey+73p
		extrn _RSA_new_method:near ; CODE XREF:	_hwcrhk_load_privkey+16Ep
		extrn _RSA_free:near	; CODE XREF: _hwcrhk_load_privkey+203p
					; _hwcrhk_load_privkey+31Cp ...
		extrn _RSA_PKCS1_SSLeay:near ; CODE XREF: _bind_helper+103p
		extrn _RSA_get_ex_new_index:near ; CODE	XREF: _hwcrhk_init+28Dp
		extrn _RSA_set_ex_data:near ; CODE XREF: _hwcrhk_rsa_finish+35p
					; _hwcrhk_load_privkey+17Dp
		extrn _RSA_get_ex_data:near ; CODE XREF: _hwcrhk_rsa_mod_exp+A1p
					; _hwcrhk_rsa_finish+Bp
		extrn _DH_OpenSSL:near	; CODE XREF: _bind_helper+12Bp
		extrn _DSO_free:near	; CODE XREF: _hwcrhk_finish+5Ep
					; _hwcrhk_init+2D8p
		extrn _DSO_load:near	; CODE XREF: _hwcrhk_init+5Fp
		extrn _DSO_bind_func:near ; CODE XREF: _hwcrhk_init+94p
					; _hwcrhk_init+B2p ...
		extrn _UI_new_method:near ; CODE XREF: _hwcrhk_insert_card+A1p
					; _hwcrhk_get_pass+95p
		extrn _UI_free:near	; CODE XREF: _hwcrhk_insert_card+14Dp
					; _hwcrhk_get_pass+127p
		extrn _UI_add_input_string:near	; CODE XREF: _hwcrhk_get_pass+CAp
		extrn _UI_dup_input_boolean:near ; CODE	XREF: _hwcrhk_insert_card+129p
		extrn _UI_dup_info_string:near ; CODE XREF: _hwcrhk_insert_card+E2p
		extrn _UI_construct_prompt:near	; CODE XREF: _hwcrhk_get_pass+AEp
		extrn _UI_add_user_data:near ; CODE XREF: _hwcrhk_insert_card+135p
					; _hwcrhk_get_pass+D3p
		extrn _UI_process:near	; CODE XREF: _hwcrhk_insert_card+142p
					; _hwcrhk_get_pass+F1p
		extrn _UI_ctrl:near	; CODE XREF: _hwcrhk_get_pass+E1p
					; _hwcrhk_get_pass+106p
		extrn _ERR_put_error:near ; CODE XREF: _hwcrhk_rsa_mod_exp+77p
					; _hwcrhk_rsa_mod_exp+183p ...
		extrn _ERR_add_error_data:near ; CODE XREF: _hwcrhk_rsa_mod_exp+191p
					; _hwcrhk_rsa_mod_exp+2E5p ...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_HWCRHK_strings+2Cp
					; _ERR_load_HWCRHK_strings+3Cp	...
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_HWCRHK_strings+14p
					; _ERR_unload_HWCRHK_strings+24p ...
		extrn _ERR_get_next_error_library:near ; CODE XREF: _hwcrhk_rsa_mod_exp+5Ep
					; _hwcrhk_rsa_mod_exp+C3p ...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_helper+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_helper+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_helper+39p
		extrn _ENGINE_set_DH:near ; CODE XREF: _bind_helper+4Fp
		extrn _ENGINE_set_RAND:near ; CODE XREF: _bind_helper+65p
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_helper+7Bp
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_helper+91p
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_helper+A7p
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_helper+BDp
		extrn _ENGINE_set_load_privkey_function:near ; CODE XREF: _bind_helper+D3p
		extrn _ENGINE_set_load_pubkey_function:near ; CODE XREF: _bind_helper+E5p
		extrn _ENGINE_set_cmd_defns:near ; CODE	XREF: _bind_helper+F7p
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _hwcrhk_rsa_mod_exp+8Dp
					; _hwcrhk_rsa_mod_exp+32Fp ...
		extrn __chkstk:near	; CODE XREF: _hwcrhk_rsa_mod_exp+5p
					; _hwcrhk_rand_bytes+5p ...
		extrn ___security_cookie:near ;	DATA XREF: _hwcrhk_rsa_mod_exp+Ar
					; _hwcrhk_rand_bytes+Ar ...


		end
