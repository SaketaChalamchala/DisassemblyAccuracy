;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	D8EB74723B8CEAC4C7DFA2396B238C0F
; Input	CRC32 :	EF4EB3FF

; File Name   :	C:\compspace\Diff\openssl\obj\spkac.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _spkac_main
_spkac_main	proc near

var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 40h ; '@'
		call	__chkstk
		mov	eax, dword ptr ds:_bio_err
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	[esp+48h+var_40], 0
		push	edi
		xor	edi, edi
		mov	[esp+4Ch+var_30], 0
		mov	[esp+4Ch+var_C], ebp
		mov	ebx, 1
		mov	[esp+4Ch+var_10], ebp
		mov	[esp+4Ch+var_8], ebp
		mov	[esp+4Ch+var_3C], edi
		mov	[esp+4Ch+var_38], edi
		mov	[esp+4Ch+var_28], edi
		mov	[esp+4Ch+var_2C], edi
		mov	[esp+4Ch+var_18], offset ??_C@_05BKCNMPMD@SPKAC?$AA@ ; "SPKAC"
		mov	[esp+4Ch+var_14], offset ??_C@_07DLHCIBDH@default?$AA@ ; "default"
		mov	[esp+4Ch+var_1C], edi
		mov	[esp+4Ch+var_20], edi
		mov	[esp+4Ch+var_34], edi
		mov	[esp+4Ch+var_24], edi
		test	eax, eax
		jnz	short loc_85
		push	eax
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BIO_new_fp
		add	esp, 8
		mov	dword ptr ds:_bio_err, eax

loc_85:					; CODE XREF: _spkac_main+69j
		push	esi
		push	0
		push	eax
		call	_load_config
		add	esp, 8
		test	eax, eax
		jz	loc_4E8
		mov	ebx, [esp+50h+arg_4]
		mov	esi, [esp+50h+arg_0]
		dec	esi
		mov	eax, [ebx]
		add	ebx, 4
		mov	[esp+50h+var_4], eax
		cmp	esi, 1
		jl	loc_52E

loc_B4:					; CODE XREF: _spkac_main+40Bj
		mov	edi, [ebx]
		mov	ecx, offset ??_C@_03DAJLOBIG@?9in?$AA@ ; "-in"
		mov	eax, edi
		nop	dword ptr [eax]

loc_C0:					; CODE XREF: _spkac_main+DAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_E0
		test	dl, dl
		jz	short loc_DC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_E0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_C0

loc_DC:					; CODE XREF: _spkac_main+C8j
		xor	eax, eax
		jmp	short loc_E5
; ---------------------------------------------------------------------------

loc_E0:					; CODE XREF: _spkac_main+C4j
					; _spkac_main+D0j
		sbb	eax, eax
		or	eax, 1

loc_E5:					; CODE XREF: _spkac_main+DEj
		test	eax, eax
		jnz	short loc_106
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	edi, [ebx+4]
		add	ebx, 4
		mov	eax, [esp+50h+var_40]
		mov	[esp+50h+var_3C], edi
		jmp	loc_404
; ---------------------------------------------------------------------------

loc_106:				; CODE XREF: _spkac_main+E7j
		mov	ecx, offset ??_C@_04HKKABCEL@?9out?$AA@	; "-out"
		mov	eax, edi
		nop	dword ptr [eax]

loc_110:				; CODE XREF: _spkac_main+12Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_130
		test	dl, dl
		jz	short loc_12C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_130
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_110

loc_12C:				; CODE XREF: _spkac_main+118j
		xor	eax, eax
		jmp	short loc_135
; ---------------------------------------------------------------------------

loc_130:				; CODE XREF: _spkac_main+114j
					; _spkac_main+120j
		sbb	eax, eax
		or	eax, 1

loc_135:				; CODE XREF: _spkac_main+12Ej
		test	eax, eax
		jnz	short loc_156
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_38], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_156:				; CODE XREF: _spkac_main+137j
		mov	ecx, offset ??_C@_07KMOOHICO@?9passin?$AA@ ; "-passin"
		mov	eax, edi
		nop	dword ptr [eax]

loc_160:				; CODE XREF: _spkac_main+17Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_180
		test	dl, dl
		jz	short loc_17C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_180
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_160

loc_17C:				; CODE XREF: _spkac_main+168j
		xor	eax, eax
		jmp	short loc_185
; ---------------------------------------------------------------------------

loc_180:				; CODE XREF: _spkac_main+164j
					; _spkac_main+170j
		sbb	eax, eax
		or	eax, 1

loc_185:				; CODE XREF: _spkac_main+17Ej
		test	eax, eax
		jnz	short loc_1A6
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_28], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_1A6:				; CODE XREF: _spkac_main+187j
		mov	ecx, offset ??_C@_04FMEKFICB@?9key?$AA@	; "-key"
		mov	eax, edi
		nop	dword ptr [eax]

loc_1B0:				; CODE XREF: _spkac_main+1CAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1D0
		test	dl, dl
		jz	short loc_1CC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1D0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1B0

loc_1CC:				; CODE XREF: _spkac_main+1B8j
		xor	eax, eax
		jmp	short loc_1D5
; ---------------------------------------------------------------------------

loc_1D0:				; CODE XREF: _spkac_main+1B4j
					; _spkac_main+1C0j
		sbb	eax, eax
		or	eax, 1

loc_1D5:				; CODE XREF: _spkac_main+1CEj
		test	eax, eax
		jnz	short loc_1F6
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_20], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_1F6:				; CODE XREF: _spkac_main+1D7j
		mov	ecx, offset ??_C@_0L@PEEDGDND@?9challenge?$AA@ ; "-challenge"
		mov	eax, edi
		nop	dword ptr [eax]

loc_200:				; CODE XREF: _spkac_main+21Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_220
		test	dl, dl
		jz	short loc_21C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_220
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_200

loc_21C:				; CODE XREF: _spkac_main+208j
		xor	eax, eax
		jmp	short loc_225
; ---------------------------------------------------------------------------

loc_220:				; CODE XREF: _spkac_main+204j
					; _spkac_main+210j
		sbb	eax, eax
		or	eax, 1

loc_225:				; CODE XREF: _spkac_main+21Ej
		test	eax, eax
		jnz	short loc_246
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_1C], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_246:				; CODE XREF: _spkac_main+227j
		mov	ecx, offset ??_C@_06FDHPAOAM@?9spkac?$AA@ ; "-spkac"
		mov	eax, edi
		nop	dword ptr [eax]

loc_250:				; CODE XREF: _spkac_main+26Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_270
		test	dl, dl
		jz	short loc_26C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_270
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_250

loc_26C:				; CODE XREF: _spkac_main+258j
		xor	eax, eax
		jmp	short loc_275
; ---------------------------------------------------------------------------

loc_270:				; CODE XREF: _spkac_main+254j
					; _spkac_main+260j
		sbb	eax, eax
		or	eax, 1

loc_275:				; CODE XREF: _spkac_main+26Ej
		test	eax, eax
		jnz	short loc_296
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_18], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_296:				; CODE XREF: _spkac_main+277j
		mov	ecx, offset ??_C@_08HFIEGDMB@?9spksect?$AA@ ; "-spksect"
		mov	eax, edi
		nop	dword ptr [eax]

loc_2A0:				; CODE XREF: _spkac_main+2BAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_2C0
		test	dl, dl
		jz	short loc_2BC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_2C0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_2A0

loc_2BC:				; CODE XREF: _spkac_main+2A8j
		xor	eax, eax
		jmp	short loc_2C5
; ---------------------------------------------------------------------------

loc_2C0:				; CODE XREF: _spkac_main+2A4j
					; _spkac_main+2B0j
		sbb	eax, eax
		or	eax, 1

loc_2C5:				; CODE XREF: _spkac_main+2BEj
		test	eax, eax
		jnz	short loc_2E6
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_14], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_2E6:				; CODE XREF: _spkac_main+2C7j
		mov	ecx, offset ??_C@_07CECBDAGF@?9engine?$AA@ ; "-engine"
		mov	eax, edi
		nop	dword ptr [eax]

loc_2F0:				; CODE XREF: _spkac_main+30Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_310
		test	dl, dl
		jz	short loc_30C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_310
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_2F0

loc_30C:				; CODE XREF: _spkac_main+2F8j
		xor	eax, eax
		jmp	short loc_315
; ---------------------------------------------------------------------------

loc_310:				; CODE XREF: _spkac_main+2F4j
					; _spkac_main+300j
		sbb	eax, eax
		or	eax, 1

loc_315:				; CODE XREF: _spkac_main+30Ej
		test	eax, eax
		jnz	short loc_336
		dec	esi
		cmp	esi, 1
		jl	$bad$135
		mov	eax, [ebx+4]
		add	ebx, 4
		mov	[esp+50h+var_24], eax
		mov	eax, [esp+50h+var_40]
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_336:				; CODE XREF: _spkac_main+317j
		mov	ecx, offset ??_C@_06JPEJAHHH@?9noout?$AA@ ; "-noout"
		mov	eax, edi
		nop	dword ptr [eax]

loc_340:				; CODE XREF: _spkac_main+35Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_360
		test	dl, dl
		jz	short loc_35C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_360
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_340

loc_35C:				; CODE XREF: _spkac_main+348j
		xor	eax, eax
		jmp	short loc_365
; ---------------------------------------------------------------------------

loc_360:				; CODE XREF: _spkac_main+344j
					; _spkac_main+350j
		sbb	eax, eax
		or	eax, 1

loc_365:				; CODE XREF: _spkac_main+35Ej
		test	eax, eax
		jnz	short loc_37A
		mov	eax, [esp+50h+var_40]
		mov	[esp+50h+var_10], 1
		jmp	loc_400
; ---------------------------------------------------------------------------

loc_37A:				; CODE XREF: _spkac_main+367j
		mov	ecx, offset ??_C@_07PABNIEBD@?9pubkey?$AA@ ; "-pubkey"
		mov	eax, edi

loc_381:				; CODE XREF: _spkac_main+39Bj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_3A1
		test	dl, dl
		jz	short loc_39D
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_3A1
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_381

loc_39D:				; CODE XREF: _spkac_main+389j
		xor	eax, eax
		jmp	short loc_3A6
; ---------------------------------------------------------------------------

loc_3A1:				; CODE XREF: _spkac_main+385j
					; _spkac_main+391j
		sbb	eax, eax
		or	eax, 1

loc_3A6:				; CODE XREF: _spkac_main+39Fj
		test	eax, eax
		jnz	short loc_3B8
		mov	eax, [esp+50h+var_40]
		mov	[esp+50h+var_8], 1
		jmp	short loc_400
; ---------------------------------------------------------------------------

loc_3B8:				; CODE XREF: _spkac_main+3A8j
		mov	eax, offset ??_C@_07FILEFCOC@?9verify?$AA@ ; "-verify"
		nop	dword ptr [eax]

loc_3C0:				; CODE XREF: _spkac_main+3DAj
		mov	cl, [edi]
		cmp	cl, [eax]
		jnz	short loc_3E0
		test	cl, cl
		jz	short loc_3DC
		mov	cl, [edi+1]
		cmp	cl, [eax+1]
		jnz	short loc_3E0
		add	edi, 2
		add	eax, 2
		test	cl, cl
		jnz	short loc_3C0

loc_3DC:				; CODE XREF: _spkac_main+3C8j
		xor	eax, eax
		jmp	short loc_3E5
; ---------------------------------------------------------------------------

loc_3E0:				; CODE XREF: _spkac_main+3C4j
					; _spkac_main+3D0j
		sbb	eax, eax
		or	eax, 1

loc_3E5:				; CODE XREF: _spkac_main+3DEj
		test	eax, eax
		jnz	short loc_3F7
		mov	eax, [esp+50h+var_40]
		mov	[esp+50h+var_C], 1
		jmp	short loc_400
; ---------------------------------------------------------------------------

loc_3F7:				; CODE XREF: _spkac_main+3E7j
		mov	eax, 1
		mov	[esp+50h+var_40], eax

loc_400:				; CODE XREF: _spkac_main+151j
					; _spkac_main+1A1j ...
		mov	edi, [esp+50h+var_3C]

loc_404:				; CODE XREF: _spkac_main+101j
		dec	esi
		add	ebx, 4
		cmp	esi, 1
		jge	loc_B4
		test	eax, eax
		jz	loc_52E

$bad$135:				; CODE XREF: _spkac_main+EDj
					; _spkac_main+13Dj ...
		push	[esp+50h+var_4]
		push	offset ??_C@_0O@PNMJCFJD@?$CFs?5?$FLoptions?$FN?6?$AA@ ; "%s [options]\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0BD@KHANLAHK@where?5options?5are?6?$AA@ ; "where options are\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0BM@BNDOLEGE@?5?9in?5arg?5?5?5?5?5?5?5?5input?5file?6?$AA@	; " -in	arg	   input file\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0BN@NLKPGMME@?5?9out?5arg?5?5?5?5?5?5?5output?5file?6?$AA@	; " -out arg	   output file\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0DA@NIIHNHPD@?5?9key?5arg?5?5?5?5?5?5?5create?5SPKAC?5usi@	; " -key arg	   create SPKAC	using priv"...
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0CP@PIPGIOIG@?5?9passin?5arg?5?5?5?5input?5file?5pass?5@ ;	" -passin arg	 input file pass phrase	"...
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0CC@KLOOIEGG@?5?9challenge?5arg?5challenge?5string@ ; " -challenge	arg challenge string\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0CI@ENEBJJEN@?5?9spkac?5arg?5?5?5?5?5alternative?5SPKA@ ; " -spkac	arg	alternative SPKAC name\"...
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		add	esp, 44h
		push	offset ??_C@_0CD@GABJLGDL@?5?9noout?5?5?5?5?5?5?5?5?5don?8t?5print?5SPKA@ ; " -noout	     don't print SPKAC\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0CD@KGCNKBCD@?5?9pubkey?5?5?5?5?5?5?5?5output?5public?5ke@	; " -pubkey	   output public key\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0CI@OGCOHJEJ@?5?9verify?5?5?5?5?5?5?5?5verify?5SPKAC?5sig@	; " -verify	   verify SPKAC	signature\"...
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	offset ??_C@_0DL@CGNHMMJL@?5?9engine?5e?5?5?5?5?5?5use?5engine?5e?0?5po@ ; " -engine e	    use	engine e, possibly "...
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		add	esp, 20h

loc_4E3:				; CODE XREF: _spkac_main+565j
					; _spkac_main+713j ...
		mov	ebx, 1

loc_4E8:				; CODE XREF: _spkac_main+93j
		xor	esi, esi

loc_4EA:				; CODE XREF: _spkac_main+7B1j
		xor	edi, edi

$end$136:				; CODE XREF: _spkac_main+691j
					; _spkac_main+6B1j ...
		push	[esp+50h+var_34]
		call	_NCONF_free
		push	esi
		call	_NETSCAPE_SPKI_free
		push	[esp+58h+var_30]
		call	_BIO_free
		push	ebp
		call	_BIO_free_all
		push	edi
		call	_EVP_PKEY_free
		mov	ecx, [esp+64h+var_2C]
		add	esp, 14h
		pop	esi
		test	ecx, ecx
		jz	short loc_525
		push	ecx
		call	_CRYPTO_free
		add	esp, 4

loc_525:				; CODE XREF: _spkac_main+51Aj
		pop	edi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 40h
		retn
; ---------------------------------------------------------------------------

loc_52E:				; CODE XREF: _spkac_main+AEj
					; _spkac_main+413j
		call	_ERR_load_crypto_strings
		push	0
		lea	eax, [esp+54h+var_2C]
		push	eax
		push	0
		push	[esp+5Ch+var_28]
		push	dword ptr ds:_bio_err
		call	_app_passwd
		add	esp, 14h
		test	eax, eax
		jnz	short loc_56A
		push	offset ??_C@_0BI@IBJFBNHD@Error?5getting?5password?6?$AA@ ; "Error getting password\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		add	esp, 8
		jmp	loc_4E3
; ---------------------------------------------------------------------------

loc_56A:				; CODE XREF: _spkac_main+550j
		push	0
		push	[esp+54h+var_24]
		push	dword ptr ds:_bio_err
		call	_setup_engine
		mov	ebx, [esp+5Ch+var_20]
		add	esp, 0Ch
		mov	esi, eax
		test	ebx, ebx
		jz	loc_6B6
		mov	ecx, offset ??_C@_01JOAMLHOP@?9?$AA@ ; "-"
		mov	eax, ebx

loc_593:				; CODE XREF: _spkac_main+5ADj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_5B3
		test	dl, dl
		jz	short loc_5AF
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_5B3
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_593

loc_5AF:				; CODE XREF: _spkac_main+59Bj
		xor	ecx, ecx
		jmp	short loc_5B8
; ---------------------------------------------------------------------------

loc_5B3:				; CODE XREF: _spkac_main+597j
					; _spkac_main+5A3j
		sbb	ecx, ecx
		or	ecx, 1

loc_5B8:				; CODE XREF: _spkac_main+5B1j
		push	offset ??_C@_0M@GJDNJIDF@private?5key?$AA@ ; "private key"
		push	esi
		push	[esp+58h+var_2C]
		xor	eax, eax
		test	ecx, ecx
		push	1
		push	3
		cmovnz	eax, ebx
		push	eax
		push	dword ptr ds:_bio_err
		call	_load_key
		add	esp, 1Ch
		mov	[esp+50h+var_40], eax
		test	eax, eax
		jz	loc_880
		call	_NETSCAPE_SPKI_new
		mov	ebx, [esp+50h+var_1C]
		mov	esi, eax
		mov	[esp+50h+var_3C], esi
		test	ebx, ebx
		jz	short loc_618
		mov	ecx, ebx
		lea	edx, [ecx+1]

loc_600:				; CODE XREF: _spkac_main+605j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_600
		mov	eax, [esi]
		sub	ecx, edx
		push	ecx
		push	ebx
		push	dword ptr [eax+4]
		call	_ASN1_STRING_set
		add	esp, 0Ch

loc_618:				; CODE XREF: _spkac_main+5F9j
		mov	edi, [esp+50h+var_40]
		push	edi
		push	esi
		call	_NETSCAPE_SPKI_set_pubkey
		call	_EVP_md5
		push	eax
		push	edi
		push	esi
		call	_NETSCAPE_SPKI_sign
		push	esi
		call	_NETSCAPE_SPKI_b64_encode
		mov	esi, eax
		add	esp, 18h
		mov	eax, [esp+50h+var_38]
		test	eax, eax
		jz	short loc_650
		push	offset ??_C@_01NOFIACDB@w?$AA@ ; `string'
		push	eax
		call	_BIO_new_file
		jmp	short loc_663
; ---------------------------------------------------------------------------

loc_650:				; CODE XREF: _spkac_main+641j
		push	0
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BIO_new_fp

loc_663:				; CODE XREF: _spkac_main+64Ej
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jnz	short loc_696
		push	offset ??_C@_0BL@IMNHHODD@Error?5opening?5output?5file?6?$AA@ ;	"Error opening output file\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	dword ptr ds:_bio_err
		call	_ERR_print_errors
		mov	esi, [esp+5Ch+var_3C]
		lea	ebx, [ebp+1]
		add	esp, 0Ch
		jmp	$end$136
; ---------------------------------------------------------------------------

loc_696:				; CODE XREF: _spkac_main+66Aj
		push	esi
		push	offset ??_C@_09EBEGCOLI@SPKAC?$DN?$CFs?6?$AA@ ;	"SPKAC=%s\n"
		push	ebp
		call	_BIO_printf
		push	esi
		call	_CRYPTO_free
		mov	esi, [esp+60h+var_3C]
		add	esp, 10h
		xor	ebx, ebx
		jmp	$end$136
; ---------------------------------------------------------------------------

loc_6B6:				; CODE XREF: _spkac_main+586j
		test	edi, edi
		jz	short loc_6D3
		push	offset ??_C@_01KDCPPGHE@r?$AA@ ; `string'
		push	edi
		call	_BIO_new_file
		mov	edi, dword ptr ds:__imp____acrt_iob_func
		mov	ebx, eax
		mov	[esp+58h+var_30], ebx
		jmp	short loc_6EE
; ---------------------------------------------------------------------------

loc_6D3:				; CODE XREF: _spkac_main+6B8j
		mov	edi, dword ptr ds:__imp____acrt_iob_func
		push	0
		push	0
		call	edi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BIO_new_fp
		mov	ebx, eax
		mov	[esp+58h+var_30], eax

loc_6EE:				; CODE XREF: _spkac_main+6D1j
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_718
		push	offset ??_C@_0BK@FPEKCFFF@Error?5opening?5input?5file?6?$AA@ ; "Error opening input file\n"

loc_6FA:				; CODE XREF: _spkac_main+738j
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	dword ptr ds:_bio_err
		call	_ERR_print_errors
		add	esp, 0Ch
		jmp	loc_4E3
; ---------------------------------------------------------------------------

loc_718:				; CODE XREF: _spkac_main+6F3j
		push	0
		call	_NCONF_new
		push	0
		push	ebx
		push	eax
		mov	[esp+60h+var_34], eax
		call	_NCONF_load_bio
		add	esp, 10h
		test	eax, eax
		jnz	short loc_73A
		push	offset ??_C@_0BL@CIEPAGAL@Error?5parsing?5config?5file?6?$AA@ ;	"Error parsing config file\n"
		jmp	short loc_6FA
; ---------------------------------------------------------------------------

loc_73A:				; CODE XREF: _spkac_main+731j
		mov	esi, [esp+50h+var_18]
		push	esi
		push	[esp+54h+var_14]
		push	[esp+58h+var_34]
		call	_NCONF_get_string
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_777
		push	esi
		push	offset ??_C@_0BO@MAIIOCKM@Can?8t?5find?5SPKAC?5called?5?$CC?$CFs?$CC?6?$AA@ ; "Can't find SPKAC called \"%s\"\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	dword ptr ds:_bio_err
		call	_ERR_print_errors
		add	esp, 10h
		jmp	loc_4E3
; ---------------------------------------------------------------------------

loc_777:				; CODE XREF: _spkac_main+751j
		push	0FFFFFFFFh
		push	eax
		call	_NETSCAPE_SPKI_b64_decode
		add	esp, 8
		mov	[esp+50h+var_3C], eax
		test	eax, eax
		jnz	short loc_7B6
		push	offset ??_C@_0BF@OCDHNENN@Error?5loading?5SPKAC?6?$AA@ ; "Error	loading	SPKAC\n"

loc_78F:				; CODE XREF: _spkac_main+7E8j
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	dword ptr ds:_bio_err
		call	_ERR_print_errors
		mov	esi, [esp+5Ch+var_3C]
		add	esp, 0Ch
		mov	ebx, 1
		jmp	loc_4EA
; ---------------------------------------------------------------------------

loc_7B6:				; CODE XREF: _spkac_main+788j
		mov	eax, [esp+50h+var_38]
		test	eax, eax
		jz	short loc_7CB
		push	offset ??_C@_01NOFIACDB@w?$AA@ ; `string'
		push	eax
		call	_BIO_new_file
		jmp	short loc_7DA
; ---------------------------------------------------------------------------

loc_7CB:				; CODE XREF: _spkac_main+7BCj
		push	0
		push	1
		call	edi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BIO_new_fp

loc_7DA:				; CODE XREF: _spkac_main+7C9j
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jnz	short loc_7EA
		push	offset ??_C@_0BL@IMNHHODD@Error?5opening?5output?5file?6?$AA@ ;	"Error opening output file\n"
		jmp	short loc_78F
; ---------------------------------------------------------------------------

loc_7EA:				; CODE XREF: _spkac_main+7E1j
		cmp	[esp+50h+var_10], 0
		mov	esi, [esp+50h+var_3C]
		jnz	short loc_7FF
		push	esi
		push	ebp
		call	_NETSCAPE_SPKI_print
		add	esp, 8

loc_7FF:				; CODE XREF: _spkac_main+7F3j
		push	esi
		call	_NETSCAPE_SPKI_get_pubkey
		add	esp, 4
		mov	[esp+50h+var_40], eax
		cmp	[esp+50h+var_C], 0
		jz	short loc_838
		push	eax
		push	esi
		call	_NETSCAPE_SPKI_verify
		add	esp, 8
		test	eax, eax
		jle	short loc_854
		push	offset ??_C@_0O@HCKCFADN@Signature?5OK?6?$AA@ ;	"Signature OK\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		mov	eax, [esp+58h+var_40]
		add	esp, 8

loc_838:				; CODE XREF: _spkac_main+811j
		cmp	[esp+50h+var_8], 0
		jz	short loc_849
		push	eax
		push	ebp
		call	_PEM_write_bio_PUBKEY
		add	esp, 8

loc_849:				; CODE XREF: _spkac_main+83Dj
		mov	edi, [esp+50h+var_40]
		xor	ebx, ebx
		jmp	$end$136
; ---------------------------------------------------------------------------

loc_854:				; CODE XREF: _spkac_main+81Fj
		push	offset ??_C@_0BD@BAMDFGJK@Signature?5Failure?6?$AA@ ; "Signature Failure\n"
		push	dword ptr ds:_bio_err
		call	_BIO_printf
		push	dword ptr ds:_bio_err
		call	_ERR_print_errors
		mov	edi, [esp+5Ch+var_40]
		add	esp, 0Ch
		mov	ebx, 1
		jmp	$end$136
; ---------------------------------------------------------------------------

loc_880:				; CODE XREF: _spkac_main+5E2j
		mov	edi, [esp+50h+var_40]
		xor	esi, esi
		lea	ebx, [esi+1]
		jmp	$end$136
_spkac_main	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 890h
; COMDAT (pick any)
		public ??_C@_05BKCNMPMD@SPKAC?$AA@
; `string'
??_C@_05BKCNMPMD@SPKAC?$AA@ db 'SPKAC',0 ; DATA XREF: _spkac_main+47o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 898h
; COMDAT (pick any)
		public ??_C@_07DLHCIBDH@default?$AA@
; `string'
??_C@_07DLHCIBDH@default?$AA@ db 'default',0 ; DATA XREF: _spkac_main+4Fo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8A0h
; COMDAT (pick any)
		public ??_C@_03DAJLOBIG@?9in?$AA@
; `string'
??_C@_03DAJLOBIG@?9in?$AA@ db '-in',0   ; DATA XREF: _spkac_main+B6o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8A4h
; COMDAT (pick any)
		public ??_C@_04HKKABCEL@?9out?$AA@
; `string'
??_C@_04HKKABCEL@?9out?$AA@ db '-out',0 ; DATA XREF: _spkac_main:loc_106o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8ACh
; COMDAT (pick any)
		public ??_C@_07KMOOHICO@?9passin?$AA@
; `string'
??_C@_07KMOOHICO@?9passin?$AA@ db '-passin',0 ; DATA XREF: _spkac_main:loc_156o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8B4h
; COMDAT (pick any)
		public ??_C@_04FMEKFICB@?9key?$AA@
; `string'
??_C@_04FMEKFICB@?9key?$AA@ db '-key',0 ; DATA XREF: _spkac_main:loc_1A6o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8BCh
; COMDAT (pick any)
		public ??_C@_0L@PEEDGDND@?9challenge?$AA@
; `string'
??_C@_0L@PEEDGDND@?9challenge?$AA@ db '-challenge',0 ; DATA XREF: _spkac_main:loc_1F6o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8C8h
; COMDAT (pick any)
		public ??_C@_06FDHPAOAM@?9spkac?$AA@
; `string'
??_C@_06FDHPAOAM@?9spkac?$AA@ db '-spkac',0 ; DATA XREF: _spkac_main:loc_246o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8D0h
; COMDAT (pick any)
		public ??_C@_08HFIEGDMB@?9spksect?$AA@
; `string'
??_C@_08HFIEGDMB@?9spksect?$AA@	db '-spksect',0 ; DATA XREF: _spkac_main:loc_296o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8DCh
; COMDAT (pick any)
		public ??_C@_07CECBDAGF@?9engine?$AA@
; `string'
??_C@_07CECBDAGF@?9engine?$AA@ db '-engine',0 ; DATA XREF: _spkac_main:loc_2E6o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8E4h
; COMDAT (pick any)
		public ??_C@_06JPEJAHHH@?9noout?$AA@
; `string'
??_C@_06JPEJAHHH@?9noout?$AA@ db '-noout',0 ; DATA XREF: _spkac_main:loc_336o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8ECh
; COMDAT (pick any)
		public ??_C@_07PABNIEBD@?9pubkey?$AA@
; `string'
??_C@_07PABNIEBD@?9pubkey?$AA@ db '-pubkey',0 ; DATA XREF: _spkac_main:loc_37Ao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8F4h
; COMDAT (pick any)
		public ??_C@_07FILEFCOC@?9verify?$AA@
; `string'
??_C@_07FILEFCOC@?9verify?$AA@ db '-verify',0 ; DATA XREF: _spkac_main:loc_3B8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8FCh
; COMDAT (pick any)
		public ??_C@_0O@PNMJCFJD@?$CFs?5?$FLoptions?$FN?6?$AA@
; `string'
??_C@_0O@PNMJCFJD@?$CFs?5?$FLoptions?$FN?6?$AA@	db '%s [options]',0Ah,0
					; DATA XREF: _spkac_main+41Do
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 90Ch
; COMDAT (pick any)
		public ??_C@_0BD@KHANLAHK@where?5options?5are?6?$AA@
; `string'
??_C@_0BD@KHANLAHK@where?5options?5are?6?$AA@ db 'where options are',0Ah,0
					; DATA XREF: _spkac_main+42Do
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 920h
; COMDAT (pick any)
		public ??_C@_0BM@BNDOLEGE@?5?9in?5arg?5?5?5?5?5?5?5?5input?5file?6?$AA@
; `string'
??_C@_0BM@BNDOLEGE@?5?9in?5arg?5?5?5?5?5?5?5?5input?5file?6?$AA@ db ' -in arg        input file',0Ah,0
					; DATA XREF: _spkac_main+43Do
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 93Ch
; COMDAT (pick any)
		public ??_C@_0BN@NLKPGMME@?5?9out?5arg?5?5?5?5?5?5?5output?5file?6?$AA@
; `string'
??_C@_0BN@NLKPGMME@?5?9out?5arg?5?5?5?5?5?5?5output?5file?6?$AA@ db ' -out arg       output file',0Ah,0
					; DATA XREF: _spkac_main+44Do
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 95Ch
; COMDAT (pick any)
		public ??_C@_0DA@NIIHNHPD@?5?9key?5arg?5?5?5?5?5?5?5create?5SPKAC?5usi@
; `string'
??_C@_0DA@NIIHNHPD@?5?9key?5arg?5?5?5?5?5?5?5create?5SPKAC?5usi@ db ' -key arg       create SPKAC using private key',0Ah,0
					; DATA XREF: _spkac_main+45Do
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 98Ch
; COMDAT (pick any)
		public ??_C@_0CP@PIPGIOIG@?5?9passin?5arg?5?5?5?5input?5file?5pass?5@
; `string'
??_C@_0CP@PIPGIOIG@?5?9passin?5arg?5?5?5?5input?5file?5pass?5@ db ' -passin arg    input file pass phrase source',0Ah,0
					; DATA XREF: _spkac_main+46Do
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9BCh
; COMDAT (pick any)
		public ??_C@_0CC@KLOOIEGG@?5?9challenge?5arg?5challenge?5string@
; `string'
??_C@_0CC@KLOOIEGG@?5?9challenge?5arg?5challenge?5string@ db ' -challenge arg challenge string',0Ah,0
					; DATA XREF: _spkac_main+47Do
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9E0h
; COMDAT (pick any)
		public ??_C@_0CI@ENEBJJEN@?5?9spkac?5arg?5?5?5?5?5alternative?5SPKA@
; `string'
??_C@_0CI@ENEBJJEN@?5?9spkac?5arg?5?5?5?5?5alternative?5SPKA@ db ' -spkac arg     alternative SPKAC name',0Ah,0
					; DATA XREF: _spkac_main+48Do
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A08h
; COMDAT (pick any)
		public ??_C@_0CD@GABJLGDL@?5?9noout?5?5?5?5?5?5?5?5?5don?8t?5print?5SPKA@
; `string'
??_C@_0CD@GABJLGDL@?5?9noout?5?5?5?5?5?5?5?5?5don?8t?5print?5SPKA@ db ' -noout         don',27h,'t print SPKAC',0Ah,0
					; DATA XREF: _spkac_main+4A0o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A2Ch
; COMDAT (pick any)
		public ??_C@_0CD@KGCNKBCD@?5?9pubkey?5?5?5?5?5?5?5?5output?5public?5ke@
; `string'
??_C@_0CD@KGCNKBCD@?5?9pubkey?5?5?5?5?5?5?5?5output?5public?5ke@ db ' -pubkey        output public key',0Ah,0
					; DATA XREF: _spkac_main+4B0o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A50h
; COMDAT (pick any)
		public ??_C@_0CI@OGCOHJEJ@?5?9verify?5?5?5?5?5?5?5?5verify?5SPKAC?5sig@
; `string'
??_C@_0CI@OGCOHJEJ@?5?9verify?5?5?5?5?5?5?5?5verify?5SPKAC?5sig@ db ' -verify        verify SPKAC signature',0Ah,0
					; DATA XREF: _spkac_main+4C0o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A78h
; COMDAT (pick any)
		public ??_C@_0DL@CGNHMMJL@?5?9engine?5e?5?5?5?5?5?5use?5engine?5e?0?5po@
; `string'
??_C@_0DL@CGNHMMJL@?5?9engine?5e?5?5?5?5?5?5use?5engine?5e?0?5po@ db ' -engine e      use engine e, possibly a hardware device.',0Ah,0
					; DATA XREF: _spkac_main+4D0o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AB4h
; COMDAT (pick any)
		public ??_C@_0BI@IBJFBNHD@Error?5getting?5password?6?$AA@
; `string'
??_C@_0BI@IBJFBNHD@Error?5getting?5password?6?$AA@ db 'Error getting password',0Ah,0
					; DATA XREF: _spkac_main+552o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0ACCh
; COMDAT (pick any)
		public ??_C@_0M@GJDNJIDF@private?5key?$AA@
; `string'
??_C@_0M@GJDNJIDF@private?5key?$AA@ db 'private key',0 ; DATA XREF: _spkac_main:loc_5B8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AD8h
; COMDAT (pick any)
		public ??_C@_01JOAMLHOP@?9?$AA@
; `string'
??_C@_01JOAMLHOP@?9?$AA@ db '-',0       ; DATA XREF: _spkac_main+58Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0ADCh
; COMDAT (pick any)
		public ??_C@_01NOFIACDB@w?$AA@
; `string'
??_C@_01NOFIACDB@w?$AA@	db 77h,	0	; DATA XREF: _spkac_main+643o
					; _spkac_main+7BEo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AE0h
; COMDAT (pick any)
		public ??_C@_0BL@IMNHHODD@Error?5opening?5output?5file?6?$AA@
; `string'
??_C@_0BL@IMNHHODD@Error?5opening?5output?5file?6?$AA@ db 'Error opening output file',0Ah,0
					; DATA XREF: _spkac_main+66Co
					; _spkac_main+7E3o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0AFCh
; COMDAT (pick any)
		public ??_C@_09EBEGCOLI@SPKAC?$DN?$CFs?6?$AA@
; `string'
??_C@_09EBEGCOLI@SPKAC?$DN?$CFs?6?$AA@ db 'SPKAC=%s',0Ah,0 ; DATA XREF: _spkac_main+697o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B08h
; COMDAT (pick any)
		public ??_C@_01KDCPPGHE@r?$AA@
; `string'
??_C@_01KDCPPGHE@r?$AA@	db 72h,	0	; DATA XREF: _spkac_main+6BAo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B0Ch
; COMDAT (pick any)
		public ??_C@_0BK@FPEKCFFF@Error?5opening?5input?5file?6?$AA@
; `string'
??_C@_0BK@FPEKCFFF@Error?5opening?5input?5file?6?$AA@ db 'Error opening input file',0Ah,0
					; DATA XREF: _spkac_main+6F5o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B28h
; COMDAT (pick any)
		public ??_C@_0BL@CIEPAGAL@Error?5parsing?5config?5file?6?$AA@
; `string'
??_C@_0BL@CIEPAGAL@Error?5parsing?5config?5file?6?$AA@ db 'Error parsing config file',0Ah,0
					; DATA XREF: _spkac_main+733o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B44h
; COMDAT (pick any)
		public ??_C@_0BO@MAIIOCKM@Can?8t?5find?5SPKAC?5called?5?$CC?$CFs?$CC?6?$AA@
; `string'
??_C@_0BO@MAIIOCKM@Can?8t?5find?5SPKAC?5called?5?$CC?$CFs?$CC?6?$AA@ db	'Can',27h,'t find SPKAC called "%s"',0Ah,0
					; DATA XREF: _spkac_main+754o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B64h
; COMDAT (pick any)
		public ??_C@_0BF@OCDHNENN@Error?5loading?5SPKAC?6?$AA@
; `string'
??_C@_0BF@OCDHNENN@Error?5loading?5SPKAC?6?$AA@	db 'Error loading SPKAC',0Ah,0
					; DATA XREF: _spkac_main+78Ao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B7Ch
; COMDAT (pick any)
		public ??_C@_0O@HCKCFADN@Signature?5OK?6?$AA@
; `string'
??_C@_0O@HCKCFADN@Signature?5OK?6?$AA@ db 'Signature OK',0Ah,0 ; DATA XREF: _spkac_main+821o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0B8Ch
; COMDAT (pick any)
		public ??_C@_0BD@BAMDFGJK@Signature?5Failure?6?$AA@
; `string'
??_C@_0BD@BAMDFGJK@Signature?5Failure?6?$AA@ db	'Signature Failure',0Ah,0
					; DATA XREF: _spkac_main:loc_854o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __imp____acrt_iob_func:near ; CODE XREF: _spkac_main+6Ep
					; _spkac_main+654p ...
		extrn _CRYPTO_free:near	; CODE XREF: _spkac_main+51Dp
					; _spkac_main+6A3p
		extrn _BIO_new_file:near ; CODE	XREF: _spkac_main+649p
					; _spkac_main+6C0p ...
		extrn _BIO_new_fp:near	; CODE XREF: _spkac_main+78p
					; _spkac_main+65Ep ...
		extrn _BIO_free:near	; CODE XREF: _spkac_main+4FFp
		extrn _BIO_free_all:near ; CODE	XREF: _spkac_main+505p
		extrn _BIO_printf:near	; CODE XREF: _spkac_main+428p
					; _spkac_main+438p ...
		extrn _ASN1_STRING_set:near ; CODE XREF: _spkac_main+610p
		extrn _EVP_md5:near	; CODE XREF: _spkac_main+623p
		extrn _EVP_PKEY_free:near ; CODE XREF: _spkac_main+50Bp
		extrn _NETSCAPE_SPKI_verify:near ; CODE	XREF: _spkac_main+815p
		extrn _NETSCAPE_SPKI_b64_decode:near ; CODE XREF: _spkac_main+77Ap
		extrn _NETSCAPE_SPKI_b64_encode:near ; CODE XREF: _spkac_main+631p
		extrn _NETSCAPE_SPKI_get_pubkey:near ; CODE XREF: _spkac_main+800p
		extrn _NETSCAPE_SPKI_set_pubkey:near ; CODE XREF: _spkac_main+61Ep
		extrn _NETSCAPE_SPKI_print:near	; CODE XREF: _spkac_main+7F7p
		extrn _NETSCAPE_SPKI_sign:near ; CODE XREF: _spkac_main+62Bp
		extrn _NETSCAPE_SPKI_new:near ;	CODE XREF: _spkac_main+5E8p
		extrn _NETSCAPE_SPKI_free:near ; CODE XREF: _spkac_main+4F6p
		extrn _NCONF_new:near	; CODE XREF: _spkac_main+71Ap
		extrn _NCONF_free:near	; CODE XREF: _spkac_main+4F0p
		extrn _NCONF_load_bio:near ; CODE XREF:	_spkac_main+727p
		extrn _NCONF_get_string:near ; CODE XREF: _spkac_main+747p
		extrn _ERR_print_errors:near ; CODE XREF: _spkac_main+682p
					; _spkac_main+70Bp ...
		extrn _ERR_load_crypto_strings:near ; CODE XREF: _spkac_main:loc_52Ep
		extrn _app_passwd:near	; CODE XREF: _spkac_main+546p
		extrn _load_key:near	; CODE XREF: _spkac_main+5D4p
		extrn _setup_engine:near ; CODE	XREF: _spkac_main+576p
		extrn _load_config:near	; CODE XREF: _spkac_main+89p
		extrn _PEM_write_bio_PUBKEY:near ; CODE	XREF: _spkac_main+841p
		extrn __chkstk:near	; CODE XREF: _spkac_main+5p
		extrn _bio_err:near	; DATA XREF: _spkac_main+Ar
					; _spkac_main+80w ...


		end
