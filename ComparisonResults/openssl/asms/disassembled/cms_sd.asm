;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	D81A41AC2C8172854E826751894B4BA5
; Input	CRC32 :	3989B220

; File Name   :	C:\compspace\Diff\openssl\obj\cms_sd.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignedData_init
_CMS_SignedData_init proc near

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	_cms_signed_data_init
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_CMS_SignedData_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_cert_cmp
_CMS_SignerInfo_cert_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ecx]
		test	eax, eax
		jnz	short loc_31
		push	[esp+arg_4]
		push	dword ptr [ecx+4]
		call	_cms_ias_cert_cmp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_31:					; CODE XREF: _CMS_SignerInfo_cert_cmp+Bj
		cmp	eax, 1
		jnz	short loc_46
		push	[esp+arg_4]
		push	dword ptr [ecx+4]
		call	_cms_keyid_cert_cmp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_46:					; CODE XREF: _CMS_SignerInfo_cert_cmp+20j
		or	eax, 0FFFFFFFFh
		retn
_CMS_SignerInfo_cert_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_get0_algs
_CMS_SignerInfo_get0_algs proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		test	edx, edx
		jz	short loc_5D
		mov	eax, [ecx+20h]
		mov	[edx], eax

loc_5D:					; CODE XREF: _CMS_SignerInfo_get0_algs+Aj
		mov	edx, [esp+arg_8]
		test	edx, edx
		jz	short loc_6A
		mov	eax, [ecx+1Ch]
		mov	[edx], eax

loc_6A:					; CODE XREF: _CMS_SignerInfo_get0_algs+17j
		mov	edx, [esp+arg_C]
		test	edx, edx
		jz	short loc_77
		mov	eax, [ecx+8]
		mov	[edx], eax

loc_77:					; CODE XREF: _CMS_SignerInfo_get0_algs+24j
		mov	edx, [esp+arg_10]
		test	edx, edx
		jz	short locret_84
		mov	eax, [ecx+10h]
		mov	[edx], eax

locret_84:				; CODE XREF: _CMS_SignerInfo_get0_algs+31j
		retn
_CMS_SignerInfo_get0_algs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 88h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_get0_md_ctx
_CMS_SignerInfo_get0_md_ctx proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		add	eax, 24h ; '$'
		retn
_CMS_SignerInfo_get0_md_ctx endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 90h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_get0_pkey_ctx
_CMS_SignerInfo_get0_pkey_ctx proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+3Ch]
		retn
_CMS_SignerInfo_get0_pkey_ctx endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_get0_signature
_CMS_SignerInfo_get0_signature proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+14h]
		retn
_CMS_SignerInfo_get0_signature endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_get0_signer_id
_CMS_SignerInfo_get0_signer_id proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ecx]
		test	eax, eax
		jnz	short loc_D2
		mov	edx, [esp+arg_8]
		test	edx, edx
		jz	short loc_BC
		mov	eax, [ecx+4]
		mov	eax, [eax]
		mov	[edx], eax

loc_BC:					; CODE XREF: _CMS_SignerInfo_get0_signer_id+13j
		mov	edx, [esp+arg_C]
		test	edx, edx
		jz	short loc_E4
		mov	eax, [ecx+4]
		mov	eax, [eax+4]
		mov	[edx], eax
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_D2:					; CODE XREF: _CMS_SignerInfo_get0_signer_id+Bj
		cmp	eax, 1
		jnz	short loc_EA
		mov	edx, [esp+arg_4]
		test	edx, edx
		jz	short loc_E4
		mov	eax, [ecx+4]
		mov	[edx], eax

loc_E4:					; CODE XREF: _CMS_SignerInfo_get0_signer_id+22j
					; _CMS_SignerInfo_get0_signer_id+3Dj
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_EA:					; CODE XREF: _CMS_SignerInfo_get0_signer_id+35j
		xor	eax, eax
		retn
_CMS_SignerInfo_get0_signer_id endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_set1_signer_cert
_CMS_SignerInfo_set1_signer_cert proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		test	esi, esi
		jz	short loc_134
		push	1E9h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	3
		lea	eax, [esi+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [edi+20h]
		add	esp, 14h
		test	eax, eax
		jz	short loc_128
		push	eax
		call	_EVP_PKEY_free
		add	esp, 4

loc_128:				; CODE XREF: _CMS_SignerInfo_set1_signer_cert+2Dj
		push	esi
		call	_X509_get_pubkey
		add	esp, 4
		mov	[edi+20h], eax

loc_134:				; CODE XREF: _CMS_SignerInfo_set1_signer_cert+Cj
		mov	eax, [edi+1Ch]
		test	eax, eax
		jz	short loc_144
		push	eax
		call	_X509_free
		add	esp, 4

loc_144:				; CODE XREF: _CMS_SignerInfo_set1_signer_cert+49j
		mov	[edi+1Ch], esi
		pop	edi
		pop	esi
		retn
_CMS_SignerInfo_set1_signer_cert endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_sign
_CMS_SignerInfo_sign proc near		; CODE XREF: _CMS_add1_signer+300p
					; _cms_SignerInfo_content_sign+115p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 0Ch
		call	__chkstk
		push	ebx
		push	esi
		mov	esi, [esp+14h+arg_0]
		push	edi
		mov	[esp+18h+arg_0], 0
		mov	eax, [esi+8]
		lea	edi, [esi+24h]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		mov	ebx, eax
		add	esp, 0Ch
		mov	[esp+18h+var_4], ebx
		test	ebx, ebx
		jnz	short loc_192
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_192:				; CODE XREF: _CMS_SignerInfo_sign+3Dj
		push	ebp
		push	0FFFFFFFFh
		push	34h ; '4'
		push	esi
		call	_CMS_signed_get_attr_by_NID
		add	esp, 0Ch
		mov	ebp, 1
		test	eax, eax
		jns	short loc_228
		xor	ebx, ebx
		push	ebx
		push	ebx
		call	_X509_gmtime_adj
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short $merr$30
		push	0FFFFFFFFh
		push	ebp
		push	dword ptr [ebp+4]
		push	34h ; '4'
		push	esi
		call	_CMS_signed_add1_attr_by_NID
		add	esp, 14h
		test	eax, eax
		mov	eax, 1
		cmovg	ebx, eax

$merr$30:				; CODE XREF: _CMS_SignerInfo_sign+6Dj
		push	ebp
		call	_ASN1_TIME_free
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_21F
		push	1B5h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	41h ; 'A'
		push	67h ; 'g'

loc_1F1:				; CODE XREF: _CMS_SignerInfo_sign+132j
					; _CMS_SignerInfo_sign+1F0j
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

$err$31:				; CODE XREF: _CMS_SignerInfo_sign+105j
					; _CMS_SignerInfo_sign+166j ...
		mov	eax, [esp+1Ch+arg_0]
		test	eax, eax
		jz	short loc_20C
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_20C:				; CODE XREF: _CMS_SignerInfo_sign+B5j
					; _CMS_SignerInfo_sign+153j ...
		push	edi
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		xor	eax, eax
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_21F:				; CODE XREF: _CMS_SignerInfo_sign+95j
		mov	ebx, [esp+1Ch+var_4]
		mov	ebp, 1

loc_228:				; CODE XREF: _CMS_SignerInfo_sign+5Bj
		mov	eax, [esi+3Ch]
		test	eax, eax
		jz	short loc_235
		mov	[esp+1Ch+var_C], eax
		jmp	short loc_257
; ---------------------------------------------------------------------------

loc_235:				; CODE XREF: _CMS_SignerInfo_sign+E1j
		push	edi
		call	_EVP_MD_CTX_init
		push	dword ptr [esi+20h]
		lea	eax, [esp+24h+var_C]
		push	0
		push	ebx
		push	eax
		push	edi
		call	_EVP_DigestSignInit
		add	esp, 18h
		test	eax, eax
		jle	short $err$31
		mov	eax, [esp+1Ch+var_C]

loc_257:				; CODE XREF: _CMS_SignerInfo_sign+E7j
		push	esi
		push	0
		push	0Bh
		push	8
		push	0FFFFFFFFh
		push	eax
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_283
		push	2BDh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Eh ; 'n'
		push	97h ; '—'
		jmp	loc_1F1
; ---------------------------------------------------------------------------

loc_283:				; CODE XREF: _CMS_SignerInfo_sign+11Fj
		call	_CMS_Attributes_Sign_it
		push	eax
		lea	eax, [esp+20h+arg_0]
		push	eax
		push	dword ptr [esi+0Ch]
		call	_ASN1_item_i2d
		mov	ecx, [esp+28h+arg_0]
		add	esp, 0Ch
		test	ecx, ecx
		jz	loc_20C
		push	eax
		push	ecx
		push	edi
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	$err$31
		lea	eax, [esp+1Ch+var_8]
		push	eax
		push	0
		push	edi
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jle	$err$31
		push	[esp+1Ch+arg_0]
		call	_CRYPTO_free
		push	2CAh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	[esp+28h+var_8]
		call	_CRYPTO_malloc
		add	esp, 10h
		mov	[esp+1Ch+arg_0], eax
		test	eax, eax
		jz	loc_20C
		lea	ecx, [esp+1Ch+var_8]
		push	ecx
		push	eax
		push	edi
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jle	$err$31
		push	esi
		push	1
		push	0Bh
		push	8
		push	0FFFFFFFFh
		push	[esp+30h+var_C]
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_341
		push	2D2h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Eh ; 'n'
		push	97h ; '—'
		jmp	loc_1F1
; ---------------------------------------------------------------------------

loc_341:				; CODE XREF: _CMS_SignerInfo_sign+1DDj
		push	edi
		call	_EVP_MD_CTX_cleanup
		push	[esp+20h+var_8]
		push	[esp+24h+arg_0]
		push	dword ptr [esi+14h]
		call	_ASN1_STRING_set0
		add	esp, 10h
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
_CMS_SignerInfo_sign endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 364h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_verify
_CMS_SignerInfo_verify proc near

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		or	esi, 0FFFFFFFFh
		mov	[esp+0Ch+arg_0], 0
		cmp	dword ptr [edi+20h], 0
		lea	ebx, [edi+24h]
		jnz	short loc_3A3
		push	2ECh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	86h ; '†'
		push	98h ; '˜'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		or	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_3A3:				; CODE XREF: _CMS_SignerInfo_verify+19j
		mov	eax, [edi+8]
		push	ebp
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		push	eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_3CB
		pop	ebp
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_3CB:				; CODE XREF: _CMS_SignerInfo_verify+5Dj
		push	ebx
		call	_EVP_MD_CTX_init
		push	dword ptr [edi+20h]
		lea	eax, [edi+3Ch]
		push	0
		push	ebp
		push	eax
		push	ebx
		call	_EVP_DigestVerifyInit
		add	esp, 18h
		test	eax, eax
		jle	$err$12
		push	1
		push	edi
		call	_cms_sd_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	$err$12
		call	_CMS_Attributes_Verify_it
		push	eax
		lea	eax, [esp+14h+arg_0]
		push	eax
		push	dword ptr [edi+0Ch]
		call	_ASN1_item_i2d
		mov	ecx, eax
		add	esp, 0Ch
		mov	eax, [esp+10h+arg_0]
		test	eax, eax
		jz	short $err$12
		push	ecx
		push	eax
		push	ebx
		call	_EVP_DigestUpdate
		push	[esp+1Ch+arg_0]
		mov	esi, eax
		call	_CRYPTO_free
		add	esp, 10h
		test	esi, esi
		jg	short loc_44C
		push	ebx
		or	esi, 0FFFFFFFFh
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		mov	eax, esi
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_44C:				; CODE XREF: _CMS_SignerInfo_verify+D3j
		mov	eax, [edi+14h]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		push	ebx
		call	_EVP_DigestVerifyFinal
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jg	short $err$12
		push	307h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	9Eh ; 'ž'
		push	98h ; '˜'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

$err$12:				; CODE XREF: _CMS_SignerInfo_verify+82j
					; _CMS_SignerInfo_verify+95j ...
		push	ebx
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		mov	eax, esi
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		retn
_CMS_SignerInfo_verify endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 494h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_SignerInfo_verify_content
_CMS_SignerInfo_verify_content proc near

var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 60h ; '`'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+60h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+68h+arg_4]
		lea	eax, [esp+68h+var_5C]
		push	esi
		push	edi
		mov	edi, [esp+70h+arg_0]
		xor	ebx, ebx
		push	eax
		or	esi, 0FFFFFFFFh
		call	_EVP_MD_CTX_init
		push	edi
		call	_CMS_signed_get_attr_count
		add	esp, 8
		test	eax, eax
		js	short loc_50F
		push	4
		push	0FFFFFFFDh
		push	33h ; '3'
		call	_OBJ_nid2obj
		add	esp, 4
		push	eax
		push	edi
		call	_CMS_signed_get0_data_by_OBJ
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_50F
		push	33Ch
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	72h ; 'r'
		push	9Ah ; 'š'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_6BA
; ---------------------------------------------------------------------------

loc_50F:				; CODE XREF: _CMS_SignerInfo_verify_content+3Bj
					; _CMS_SignerInfo_verify_content+59j
		push	dword ptr [edi+8]
		lea	eax, [esp+74h+var_5C]
		push	ebp
		push	eax
		call	_cms_DigestAlgorithm_find_ctx
		add	esp, 0Ch
		test	eax, eax
		jz	loc_6BA
		lea	eax, [esp+70h+var_60]
		push	eax
		lea	eax, [esp+74h+var_44]
		push	eax
		lea	eax, [esp+78h+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_566
		push	346h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	93h ; '“'
		push	9Ah ; 'š'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_6BA
; ---------------------------------------------------------------------------

loc_566:				; CODE XREF: _CMS_SignerInfo_verify_content+ADj
		test	ebx, ebx
		jz	loc_616
		mov	ecx, [esp+70h+var_60]
		cmp	ecx, [ebx]
		jz	short loc_596
		push	34Fh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	78h ; 'x'
		push	9Ah ; 'š'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_6BA
; ---------------------------------------------------------------------------

loc_596:				; CODE XREF: _CMS_SignerInfo_verify_content+E0j
		mov	esi, [ebx+8]
		lea	edx, [esp+70h+var_44]
		sub	ecx, 4
		jb	short loc_5B5
		xchg	ax, ax

loc_5A4:				; CODE XREF: _CMS_SignerInfo_verify_content+11Fj
		mov	eax, [edx]
		cmp	eax, [esi]
		jnz	short loc_5BA
		add	edx, 4
		add	esi, 4
		sub	ecx, 4
		jnb	short loc_5A4

loc_5B5:				; CODE XREF: _CMS_SignerInfo_verify_content+10Cj
		cmp	ecx, 0FFFFFFFCh
		jz	short loc_60C

loc_5BA:				; CODE XREF: _CMS_SignerInfo_verify_content+114j
		mov	al, [edx]
		cmp	al, [esi]
		jnz	short loc_5E7
		cmp	ecx, 0FFFFFFFDh
		jz	short loc_60C
		mov	al, [edx+1]
		cmp	al, [esi+1]
		jnz	short loc_5E7
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_60C
		mov	al, [edx+2]
		cmp	al, [esi+2]
		jnz	short loc_5E7
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_60C
		mov	al, [edx+3]
		cmp	al, [esi+3]
		jz	short loc_60C

loc_5E7:				; CODE XREF: _CMS_SignerInfo_verify_content+12Aj
					; _CMS_SignerInfo_verify_content+137j ...
		push	355h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	9Eh ; 'ž'
		push	9Ah ; 'š'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi
		jmp	loc_6BA
; ---------------------------------------------------------------------------

loc_60C:				; CODE XREF: _CMS_SignerInfo_verify_content+124j
					; _CMS_SignerInfo_verify_content+12Fj ...
		mov	esi, 1
		jmp	loc_6BA
; ---------------------------------------------------------------------------

loc_616:				; CODE XREF: _CMS_SignerInfo_verify_content+D4j
		lea	eax, [esp+70h+var_5C]
		push	eax
		call	_EVP_MD_CTX_md
		push	0
		push	dword ptr [edi+20h]
		mov	ebp, eax
		call	_EVP_PKEY_CTX_new
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_6BA
		push	ebx
		call	_EVP_PKEY_verify_init
		add	esp, 4
		test	eax, eax
		jle	short $err$24
		push	ebp
		push	0
		push	1
		push	0F8h ; 'ø'
		push	0FFFFFFFFh
		push	ebx
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jle	short $err$24
		push	1
		push	edi
		mov	[edi+3Ch], ebx
		call	_cms_sd_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	short $err$24
		push	[esp+70h+var_60]
		mov	eax, [edi+14h]
		lea	ecx, [esp+74h+var_44]
		push	ecx
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		push	ebx
		call	_EVP_PKEY_verify
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jg	short $err$24
		push	369h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	9Eh ; 'ž'
		push	9Ah ; 'š'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi

$err$24:				; CODE XREF: _CMS_SignerInfo_verify_content+1B0j
					; _CMS_SignerInfo_verify_content+1C9j ...
		push	ebx
		call	_EVP_PKEY_CTX_free
		add	esp, 4

loc_6BA:				; CODE XREF: _CMS_SignerInfo_verify_content+76j
					; _CMS_SignerInfo_verify_content+8Ej ...
		lea	eax, [esp+70h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+74h+var_4]
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
_CMS_SignerInfo_verify_content endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add1_signer
_CMS_add1_signer proc near

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 10h
		call	__chkstk
		push	ebp
		mov	ebp, [esp+14h+arg_4]
		push	esi
		mov	esi, [esp+18h+arg_8]
		push	esi
		push	ebp
		call	_X509_check_private_key
		add	esp, 8
		test	eax, eax
		jnz	short loc_721
		push	114h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	88h ; 'ˆ'
		push	66h ; 'f'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_721:				; CODE XREF: _CMS_add1_signer+20j
		push	ebx
		push	edi
		push	[esp+20h+arg_0]
		call	_cms_signed_data_init
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_909
		call	_CMS_SignerInfo_it
		push	eax
		call	_ASN1_item_new
		mov	edi, eax
		add	esp, 4
		mov	[esp+20h+var_8], edi
		test	edi, edi
		jz	$merr$56
		push	0FFFFFFFFh
		push	0FFFFFFFFh
		push	ebp
		call	_X509_check_purpose
		push	11Fh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	0Ah
		lea	eax, [esi+8]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		push	120h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	3
		lea	eax, [ebp+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		lea	eax, [edi+24h]
		mov	[edi+20h], esi
		push	eax
		mov	[edi+1Ch], ebp
		call	_EVP_MD_CTX_init
		add	esp, 38h
		mov	dword ptr [edi+3Ch], 0
		test	[esp+20h+arg_10], 10000h
		jz	short loc_7C8
		mov	dword ptr [edi], 3
		cmp	dword ptr [ebx], 3
		jge	short loc_7C1
		mov	dword ptr [ebx], 3

loc_7C1:				; CODE XREF: _CMS_add1_signer+DDj
		mov	eax, 1
		jmp	short loc_7D0
; ---------------------------------------------------------------------------

loc_7C8:				; CODE XREF: _CMS_add1_signer+D2j
		xor	eax, eax
		mov	dword ptr [edi], 1

loc_7D0:				; CODE XREF: _CMS_add1_signer+EAj
		push	eax
		push	ebp
		push	dword ptr [edi+4]
		call	_cms_set1_SignerIdentifier
		add	esp, 0Ch
		test	eax, eax
		jz	$err$57
		mov	esi, [esp+20h+arg_C]
		test	esi, esi
		jnz	short loc_836
		lea	eax, [esp+20h+var_C]
		push	eax
		push	[esp+24h+arg_8]
		call	_EVP_PKEY_get_default_digest_nid
		add	esp, 8
		test	eax, eax
		jle	$err$57
		push	[esp+20h+var_C]
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		mov	esi, eax
		add	esp, 8
		mov	[esp+20h+arg_C], esi
		test	esi, esi
		jnz	short loc_836
		push	13Ah
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	80h ; '€'
		jmp	loc_8EA
; ---------------------------------------------------------------------------

loc_836:				; CODE XREF: _CMS_add1_signer+10Fj
					; _CMS_add1_signer+144j
		push	esi
		push	dword ptr [edi+8]
		call	_cms_DigestAlgorithm_set
		push	dword ptr [ebx+4]
		xor	ebp, ebp
		call	_sk_num
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_8A4
		mov	edi, [esp+20h+arg_C]
		nop	dword ptr [eax+eax+00000000h]

loc_85C:				; CODE XREF: _CMS_add1_signer+1BEj
		push	ebp
		push	dword ptr [ebx+4]
		call	_sk_value
		push	eax
		push	0
		lea	eax, [esp+30h+var_10]
		push	0
		push	eax
		call	_X509_ALGOR_get0
		push	[esp+38h+var_10]
		call	_OBJ_obj2nid
		push	edi
		mov	esi, eax
		call	_EVP_MD_type
		add	esp, 20h
		cmp	esi, eax
		jz	short loc_89C
		push	dword ptr [ebx+4]
		inc	ebp
		call	_sk_num
		add	esp, 4
		cmp	ebp, eax
		jl	short loc_85C

loc_89C:				; CODE XREF: _CMS_add1_signer+1AEj
		mov	edi, [esp+20h+var_8]
		mov	esi, [esp+20h+arg_C]

loc_8A4:				; CODE XREF: _CMS_add1_signer+172j
		push	dword ptr [ebx+4]
		call	_sk_num
		add	esp, 4
		cmp	ebp, eax
		jnz	short loc_913
		call	_X509_ALGOR_new
		mov	ebp, eax
		test	ebp, ebp
		jz	short $merr$56
		push	esi
		push	ebp
		call	_cms_DigestAlgorithm_set
		push	ebp
		push	dword ptr [ebx+4]
		call	_sk_push
		add	esp, 10h
		test	eax, eax
		jnz	short loc_913
		push	ebp
		call	_X509_ALGOR_free
		add	esp, 4

$merr$56:				; CODE XREF: _CMS_add1_signer+73j
					; _CMS_add1_signer+1E0j ...
		push	195h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	41h ; 'A'

loc_8EA:				; CODE XREF: _CMS_add1_signer+155j
		push	66h ; 'f'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

$err$57:				; CODE XREF: _CMS_add1_signer+103j
					; _CMS_add1_signer+124j ...
		test	edi, edi
		jz	short loc_909
		call	_CMS_SignerInfo_it
		push	eax
		push	edi
		call	_ASN1_item_free
		add	esp, 8

loc_909:				; CODE XREF: _CMS_add1_signer+57j
					; _CMS_add1_signer+21Cj
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_913:				; CODE XREF: _CMS_add1_signer+1D5j
					; _CMS_add1_signer+1F7j
		mov	eax, [esp+20h+arg_10]
		mov	ebp, eax
		and	ebp, 40000h
		mov	[esp+20h+var_8], ebp
		jnz	short loc_938
		push	0
		push	edi
		call	_cms_sd_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	short $err$57
		mov	eax, [esp+20h+arg_10]

loc_938:				; CODE XREF: _CMS_add1_signer+247j
		mov	ecx, eax
		and	ecx, 100h
		mov	[esp+20h+var_4], ecx
		jnz	loc_9F0
		cmp	dword ptr [edi+0Ch], 0
		jnz	short loc_960
		call	_sk_new_null
		mov	[edi+0Ch], eax
		test	eax, eax
		jz	short $merr$56
		mov	eax, [esp+20h+arg_10]

loc_960:				; CODE XREF: _CMS_add1_signer+272j
		test	eax, 200h
		jnz	short loc_9B4
		lea	eax, [esp+20h+var_10]
		mov	[esp+20h+var_10], 0
		push	eax
		call	_CMS_add_standard_smimecap
		mov	ebp, eax
		add	esp, 4
		mov	eax, [esp+20h+var_10]
		test	ebp, ebp
		jz	short loc_996
		push	eax
		push	edi
		call	_CMS_add_smimecap
		mov	ebp, eax
		add	esp, 8
		mov	eax, [esp+20h+var_10]

loc_996:				; CODE XREF: _CMS_add1_signer+2A8j
		push	offset _X509_ALGOR_free
		push	eax
		call	_sk_pop_free
		add	esp, 8
		test	ebp, ebp
		jz	$merr$56
		mov	eax, [esp+20h+arg_10]
		mov	ebp, [esp+20h+var_8]

loc_9B4:				; CODE XREF: _CMS_add1_signer+289j
		test	eax, 8000h
		jz	short loc_9F0
		push	edi
		push	[esp+24h+arg_0]
		call	_cms_copy_messageDigest
		add	esp, 8
		test	eax, eax
		jz	$err$57
		mov	eax, [esp+20h+arg_10]
		test	eax, 44000h
		jnz	short loc_9F0
		push	edi
		call	_CMS_SignerInfo_sign
		add	esp, 4
		test	eax, eax
		jz	$err$57
		mov	eax, [esp+20h+arg_10]

loc_9F0:				; CODE XREF: _CMS_add1_signer+268j
					; _CMS_add1_signer+2DDj ...
		test	al, 2
		jnz	short loc_A0C
		push	[esp+20h+arg_4]
		push	[esp+24h+arg_0]
		call	_CMS_add1_cert
		add	esp, 8
		test	eax, eax
		jz	$merr$56

loc_A0C:				; CODE XREF: _CMS_add1_signer+316j
		test	ebp, ebp
		jz	short loc_A78
		cmp	[esp+20h+var_4], 0
		jz	short loc_A59
		push	0
		push	dword ptr [edi+20h]
		call	_EVP_PKEY_CTX_new
		add	esp, 8
		mov	[edi+3Ch], eax
		test	eax, eax
		jz	$err$57
		push	eax
		call	_EVP_PKEY_sign_init
		add	esp, 4
		test	eax, eax
		jle	$err$57
		push	esi
		push	0
		push	1
		push	0F8h ; 'ø'
		push	0FFFFFFFFh
		push	dword ptr [edi+3Ch]
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		jmp	short loc_A70
; ---------------------------------------------------------------------------

loc_A59:				; CODE XREF: _CMS_add1_signer+339j
		push	[esp+20h+arg_8]
		lea	ebp, [edi+3Ch]
		push	0
		push	esi
		lea	eax, [edi+24h]
		push	ebp
		push	eax
		call	_EVP_DigestSignInit
		add	esp, 14h

loc_A70:				; CODE XREF: _CMS_add1_signer+37Bj
		test	eax, eax
		jle	$err$57

loc_A78:				; CODE XREF: _CMS_add1_signer+332j
		cmp	dword ptr [ebx+14h], 0
		jnz	short loc_A86
		call	_sk_new_null
		mov	[ebx+14h], eax

loc_A86:				; CODE XREF: _CMS_add1_signer+3A0j
		mov	eax, [ebx+14h]
		test	eax, eax
		jz	$merr$56
		push	edi
		push	eax
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	$merr$56
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
_CMS_add1_signer endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AB0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add_simple_smimecap
_CMS_add_simple_smimecap proc near	; CODE XREF: _CMS_add_standard_smimecap+24p
					; _CMS_add_standard_smimecap+53p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		xor	esi, esi
		test	edi, edi
		jle	short loc_AD9
		call	_ASN1_INTEGER_new
		mov	esi, eax
		test	esi, esi
		jz	loc_B4F
		push	edi
		push	esi
		call	_ASN1_INTEGER_set
		add	esp, 8
		test	eax, eax
		jz	short loc_B4F

loc_AD9:				; CODE XREF: _CMS_add_simple_smimecap+Aj
		call	_X509_ALGOR_new
		mov	edi, eax
		test	edi, edi
		jnz	short loc_AF6
		test	esi, esi
		jz	short loc_B4F
		push	esi
		call	_ASN1_INTEGER_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_AF6:				; CODE XREF: _CMS_add_simple_smimecap+32j
		or	eax, 0FFFFFFFFh
		mov	ecx, 2
		test	esi, esi
		push	esi
		cmovnz	eax, ecx
		push	eax
		push	[esp+10h+arg_4]
		call	_OBJ_nid2obj
		add	esp, 4
		push	eax
		push	edi
		call	_X509_ALGOR_set0
		mov	esi, [esp+18h+arg_0]
		add	esp, 10h
		cmp	dword ptr [esi], 0
		jnz	short loc_B2F
		call	_sk_new_null
		mov	[esi], eax
		test	eax, eax
		jz	short loc_B46

loc_B2F:				; CODE XREF: _CMS_add_simple_smimecap+72j
		push	edi
		push	dword ptr [esi]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_B46
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_B46:				; CODE XREF: _CMS_add_simple_smimecap+7Dj
					; _CMS_add_simple_smimecap+8Cj
		push	edi
		call	_X509_ALGOR_free
		add	esp, 4

loc_B4F:				; CODE XREF: _CMS_add_simple_smimecap+15j
					; _CMS_add_simple_smimecap+27j	...
		pop	edi
		xor	eax, eax
		pop	esi
		retn
_CMS_add_simple_smimecap endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B54h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add_smimecap
_CMS_add_smimecap proc near		; CODE XREF: _CMS_add1_signer+2ACp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		lea	eax, [esp+4+var_4]
		mov	[esp+4+var_4], 0
		push	eax
		push	[esp+8+arg_4]
		call	_i2d_X509_ALGORS
		add	esp, 8
		test	eax, eax
		jg	short loc_B7D
		xor	eax, eax
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_B7D:				; CODE XREF: _CMS_add_smimecap+23j
		push	esi
		push	eax
		push	[esp+0Ch+var_4]
		push	10h
		push	0A7h ; '§'
		push	[esp+18h+arg_0]
		call	_CMS_signed_add1_attr_by_NID
		push	[esp+1Ch+var_4]
		mov	esi, eax
		call	_CRYPTO_free
		add	esp, 18h
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
_CMS_add_smimecap endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add_standard_smimecap
_CMS_add_standard_smimecap proc	near	; CODE XREF: _CMS_add1_signer+298p

arg_0		= dword	ptr  4

		push	esi
		push	1ABh
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		mov	esi, [esp+0Ch+arg_0]
		add	esp, 8
		test	eax, eax
		jz	short loc_BDC
		push	0FFFFFFFFh
		push	1ABh
		push	esi
		call	_CMS_add_simple_smimecap
		add	esp, 0Ch
		test	eax, eax
		jz	loc_CF3

loc_BDC:				; CODE XREF: _CMS_add_standard_smimecap+1Aj
		push	329h
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		add	esp, 8
		test	eax, eax
		jz	short loc_C0B
		push	0FFFFFFFFh
		push	329h
		push	esi
		call	_CMS_add_simple_smimecap
		add	esp, 0Ch
		test	eax, eax
		jz	loc_CF3

loc_C0B:				; CODE XREF: _CMS_add_standard_smimecap+49j
		push	32Dh
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		add	esp, 8
		test	eax, eax
		jz	short loc_C3A
		push	0FFFFFFFFh
		push	32Dh
		push	esi
		call	_CMS_add_simple_smimecap
		add	esp, 0Ch
		test	eax, eax
		jz	loc_CF3

loc_C3A:				; CODE XREF: _CMS_add_standard_smimecap+78j
		push	1A7h
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		add	esp, 8
		test	eax, eax
		jz	short loc_C69
		push	0FFFFFFFFh
		push	1A7h
		push	esi
		call	_CMS_add_simple_smimecap
		add	esp, 0Ch
		test	eax, eax
		jz	loc_CF3

loc_C69:				; CODE XREF: _CMS_add_standard_smimecap+A7j
		push	1A3h
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		add	esp, 8
		test	eax, eax
		jz	short loc_C94
		push	0FFFFFFFFh
		push	1A3h
		push	esi
		call	_CMS_add_simple_smimecap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3

loc_C94:				; CODE XREF: _CMS_add_standard_smimecap+D6j
		push	0FFFFFFFFh
		push	2Ch ; ','
		push	esi
		call	_cms_add_cipher_smcap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3
		push	80h ; '€'
		push	25h ; '%'
		push	esi
		call	_cms_add_cipher_smcap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3
		push	40h ; '@'
		push	25h ; '%'
		push	esi
		call	_cms_add_cipher_smcap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3
		push	0FFFFFFFFh
		push	1Fh
		push	esi
		call	_cms_add_cipher_smcap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3
		push	28h ; '('
		push	25h ; '%'
		push	esi
		call	_cms_add_cipher_smcap
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_CF3
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_CF3:				; CODE XREF: _CMS_add_standard_smimecap+2Ej
					; _CMS_add_standard_smimecap+5Dj ...
		xor	eax, eax
		pop	esi
		retn
_CMS_add_standard_smimecap endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CF8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_get0_SignerInfos
_CMS_get0_SignerInfos proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_D28
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_D28:				; CODE XREF: _CMS_get0_SignerInfos+12j
		mov	eax, [esi+4]
		test	eax, eax
		jnz	short loc_D31
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_D31:				; CODE XREF: _CMS_get0_SignerInfos+35j
		mov	eax, [eax+14h]
		pop	esi
		retn
_CMS_get0_SignerInfos endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D38h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_get0_signers
_CMS_get0_signers proc near

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	dword ptr [ebx]
		xor	esi, esi
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_D6D
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		jmp	short loc_D77
; ---------------------------------------------------------------------------

loc_D6D:				; CODE XREF: _CMS_get0_signers+17j
		mov	ebx, [ebx+4]
		test	ebx, ebx
		jz	short loc_D77
		mov	ebx, [ebx+14h]

loc_D77:				; CODE XREF: _CMS_get0_signers+33j
					; _CMS_get0_signers+3Aj
		push	ebx
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_DC7
		xchg	ax, ax

loc_D88:				; CODE XREF: _CMS_get0_signers+8Dj
		push	edi
		push	ebx
		call	_sk_value
		mov	ebp, eax
		add	esp, 8
		cmp	dword ptr [ebp+1Ch], 0
		jz	short loc_DB9
		test	esi, esi
		jnz	short loc_DA9
		call	_sk_new_null
		mov	esi, eax
		test	esi, esi
		jz	short loc_DD7

loc_DA9:				; CODE XREF: _CMS_get0_signers+64j
		push	dword ptr [ebp+1Ch]
		push	esi
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_DCE

loc_DB9:				; CODE XREF: _CMS_get0_signers+60j
		push	ebx
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_D88

loc_DC7:				; CODE XREF: _CMS_get0_signers+4Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_DCE:				; CODE XREF: _CMS_get0_signers+7Fj
		push	esi
		call	_sk_free
		add	esp, 4

loc_DD7:				; CODE XREF: _CMS_get0_signers+6Fj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_CMS_get0_signers endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DE0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_set1_signers_certs
_CMS_set1_signers_certs	proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		mov	[esp+10h+var_8], ebx
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_E26
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_E26:				; CODE XREF: _CMS_set1_signers_certs+23j
		mov	eax, [esi+4]
		mov	[esp+10h+var_4], eax
		test	eax, eax
		jnz	short loc_E3A
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_E3A:				; CODE XREF: _CMS_set1_signers_certs+4Fj
		push	ebp
		push	dword ptr [eax+14h]
		mov	ebp, [eax+0Ch]
		xor	esi, esi
		mov	[esp+18h+arg_0], esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_FBC
		push	edi
		mov	edi, [esp+18h+arg_4]
		nop	dword ptr [eax+00h]

loc_E60:				; CODE XREF: _CMS_set1_signers_certs+1D5j
		mov	eax, [esp+18h+var_4]
		push	esi
		push	dword ptr [eax+14h]
		call	_sk_value
		mov	ebx, eax
		add	esp, 8
		cmp	dword ptr [ebx+1Ch], 0
		jnz	loc_F8F
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	loc_F2A
		nop

loc_E90:				; CODE XREF: _CMS_set1_signers_certs+F5j
		push	esi
		push	edi
		call	_sk_value
		mov	edi, eax
		add	esp, 8
		mov	eax, [ebx+4]
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_EB0
		push	edi
		push	dword ptr [eax+4]
		call	_cms_ias_cert_cmp
		jmp	short loc_EBE
; ---------------------------------------------------------------------------

loc_EB0:				; CODE XREF: _CMS_set1_signers_certs+C3j
		cmp	ecx, 1
		jnz	short loc_EC5
		push	edi
		push	dword ptr [eax+4]
		call	_cms_keyid_cert_cmp

loc_EBE:				; CODE XREF: _CMS_set1_signers_certs+CEj
		add	esp, 8
		test	eax, eax
		jz	short loc_ED9

loc_EC5:				; CODE XREF: _CMS_set1_signers_certs+D3j
		mov	edi, [esp+18h+arg_4]
		inc	esi
		push	edi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_E90
		jmp	short loc_F2A
; ---------------------------------------------------------------------------

loc_ED9:				; CODE XREF: _CMS_set1_signers_certs+E3j
		test	edi, edi
		jz	short loc_F13
		push	1E9h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	3
		lea	eax, [edi+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [ebx+20h]
		add	esp, 14h
		test	eax, eax
		jz	short loc_F07
		push	eax
		call	_EVP_PKEY_free
		add	esp, 4

loc_F07:				; CODE XREF: _CMS_set1_signers_certs+11Cj
		push	edi
		call	_X509_get_pubkey
		add	esp, 4
		mov	[ebx+20h], eax

loc_F13:				; CODE XREF: _CMS_set1_signers_certs+FBj
		mov	eax, [ebx+1Ch]
		test	eax, eax
		jz	short loc_F23
		push	eax
		call	_X509_free
		add	esp, 4

loc_F23:				; CODE XREF: _CMS_set1_signers_certs+138j
		inc	[esp+18h+var_8]
		mov	[ebx+1Ch], edi

loc_F2A:				; CODE XREF: _CMS_set1_signers_certs+A9j
					; _CMS_set1_signers_certs+F7j
		cmp	dword ptr [ebx+1Ch], 0
		jnz	short loc_F8F
		test	[esp+18h+arg_8], 10h
		jnz	short loc_F8F
		push	ebp
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_F8F

loc_F46:				; CODE XREF: _CMS_set1_signers_certs+1ADj
		push	esi
		push	ebp
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax], 0
		jnz	short loc_F81
		mov	edi, [eax+4]
		mov	eax, [ebx+4]
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_F6C
		push	edi
		push	dword ptr [eax+4]
		call	_cms_ias_cert_cmp
		jmp	short loc_F7A
; ---------------------------------------------------------------------------

loc_F6C:				; CODE XREF: _CMS_set1_signers_certs+17Fj
		cmp	ecx, 1
		jnz	short loc_F81
		push	edi
		push	dword ptr [eax+4]
		call	_cms_keyid_cert_cmp

loc_F7A:				; CODE XREF: _CMS_set1_signers_certs+18Aj
		add	esp, 8
		test	eax, eax
		jz	short loc_FC5

loc_F81:				; CODE XREF: _CMS_set1_signers_certs+173j
					; _CMS_set1_signers_certs+18Fj
		push	ebp
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_F46

loc_F8F:				; CODE XREF: _CMS_set1_signers_certs+96j
					; _CMS_set1_signers_certs+14Ej	...
		mov	ebx, [esp+18h+var_8]

loc_F93:				; CODE XREF: _CMS_set1_signers_certs+23Bj
		mov	eax, [esp+18h+var_4]
		mov	edi, [esp+18h+arg_0]
		inc	edi
		mov	[esp+18h+arg_0], edi
		push	dword ptr [eax+14h]
		call	_sk_num
		mov	esi, [esp+1Ch+arg_0]
		add	esp, 4
		cmp	edi, eax
		mov	edi, [esp+18h+arg_4]
		jl	loc_E60
		pop	edi

loc_FBC:				; CODE XREF: _CMS_set1_signers_certs+71j
		pop	ebp
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_FC5:				; CODE XREF: _CMS_set1_signers_certs+19Fj
		test	edi, edi
		jz	short loc_FFF
		push	1E9h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	3
		lea	eax, [edi+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [ebx+20h]
		add	esp, 14h
		test	eax, eax
		jz	short loc_FF3
		push	eax
		call	_EVP_PKEY_free
		add	esp, 4

loc_FF3:				; CODE XREF: _CMS_set1_signers_certs+208j
		push	edi
		call	_X509_get_pubkey
		add	esp, 4
		mov	[ebx+20h], eax

loc_FFF:				; CODE XREF: _CMS_set1_signers_certs+1E7j
		mov	eax, [ebx+1Ch]
		test	eax, eax
		jz	short loc_100F
		push	eax
		call	_X509_free
		add	esp, 4

loc_100F:				; CODE XREF: _CMS_set1_signers_certs+224j
		mov	[ebx+1Ch], edi
		mov	ebx, [esp+18h+var_8]
		inc	ebx
		mov	[esp+18h+var_8], ebx
		jmp	loc_F93
_CMS_set1_signers_certs	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1020h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_SignedData_final
_cms_SignedData_final proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	dword ptr [ebx]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_1053
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	edi, edi
		jmp	short loc_105D
; ---------------------------------------------------------------------------

loc_1053:				; CODE XREF: _cms_SignedData_final+15j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_105D
		mov	edi, [edi+14h]

loc_105D:				; CODE XREF: _cms_SignedData_final+31j
					; _cms_SignedData_final+38j
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1094
		mov	ebp, [esp+10h+arg_4]

loc_1070:				; CODE XREF: _cms_SignedData_final+72j
		push	esi
		push	edi
		call	_sk_value
		push	ebp
		push	eax
		push	ebx
		call	_cms_SignerInfo_content_sign
		add	esp, 14h
		test	eax, eax
		jz	short loc_10AB
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_1070

loc_1094:				; CODE XREF: _cms_SignedData_final+4Aj
		mov	eax, [ebx+4]
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, [eax+8]
		pop	ebx
		mov	dword ptr [eax+8], 0
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10AB:				; CODE XREF: _cms_SignedData_final+64j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_cms_SignedData_final endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_SignedData_init_bio
_cms_SignedData_init_bio proc near

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		xor	esi, esi
		push	dword ptr [ebx]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_10E8
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10E8:				; CODE XREF: _cms_SignedData_init_bio+15j
		mov	ebx, [ebx+4]
		test	ebx, ebx
		jnz	short loc_10F4
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10F4:				; CODE XREF: _cms_SignedData_init_bio+39j
		mov	eax, [ebx+8]
		cmp	[eax+8], esi
		jz	short loc_1105
		push	ebx
		call	_cms_sd_set_version
		add	esp, 4

loc_1105:				; CODE XREF: _cms_SignedData_init_bio+46j
		push	edi
		push	dword ptr [ebx+4]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_114F

loc_1117:				; CODE XREF: _cms_SignedData_init_bio+99j
		push	edi
		push	dword ptr [ebx+4]
		call	_sk_value
		push	eax
		call	_cms_DigestAlgorithm_init_bio
		add	esp, 0Ch
		test	eax, eax
		jz	short $err$23
		test	esi, esi
		jz	short loc_113D
		push	eax
		push	esi
		call	_BIO_push
		add	esp, 8
		jmp	short loc_113F
; ---------------------------------------------------------------------------

loc_113D:				; CODE XREF: _cms_SignedData_init_bio+7Bj
		mov	esi, eax

loc_113F:				; CODE XREF: _cms_SignedData_init_bio+87j
		push	dword ptr [ebx+4]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_1117

loc_114F:				; CODE XREF: _cms_SignedData_init_bio+61j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$err$23:				; CODE XREF: _cms_SignedData_init_bio+77j
		test	esi, esi
		jz	short loc_1162
		push	esi
		call	_BIO_free_all
		add	esp, 4

loc_1162:				; CODE XREF: _cms_SignedData_init_bio+A3j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
_cms_SignedData_init_bio endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1168h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_SignerIdentifier_cert_cmp
_cms_SignerIdentifier_cert_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_1182
		push	[esp+arg_4]
		push	dword ptr [eax+4]
		call	_cms_ias_cert_cmp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1182:				; CODE XREF: _cms_SignerIdentifier_cert_cmp+8j
		cmp	ecx, 1
		jnz	short loc_1197
		push	[esp+arg_4]
		push	dword ptr [eax+4]
		call	_cms_keyid_cert_cmp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1197:				; CODE XREF: _cms_SignerIdentifier_cert_cmp+1Dj
		or	eax, 0FFFFFFFFh
		retn
_cms_SignerIdentifier_cert_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 119Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_SignerIdentifier_get0_signer_id
_cms_SignerIdentifier_get0_signer_id proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx]
		test	eax, eax
		jnz	short loc_11CB
		mov	edx, [esp+arg_8]
		test	edx, edx
		jz	short loc_11B5
		mov	eax, [ecx+4]
		mov	eax, [eax]
		mov	[edx], eax

loc_11B5:				; CODE XREF: _cms_SignerIdentifier_get0_signer_id+10j
		mov	edx, [esp+arg_C]
		test	edx, edx
		jz	short loc_11DD
		mov	eax, [ecx+4]
		mov	eax, [eax+4]
		mov	[edx], eax
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_11CB:				; CODE XREF: _cms_SignerIdentifier_get0_signer_id+8j
		cmp	eax, 1
		jnz	short loc_11E3
		mov	edx, [esp+arg_4]
		test	edx, edx
		jz	short loc_11DD
		mov	eax, [ecx+4]
		mov	[edx], eax

loc_11DD:				; CODE XREF: _cms_SignerIdentifier_get0_signer_id+1Fj
					; _cms_SignerIdentifier_get0_signer_id+3Aj
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_11E3:				; CODE XREF: _cms_SignerIdentifier_get0_signer_id+32j
		xor	eax, eax
		retn
_cms_SignerIdentifier_get0_signer_id endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_SignerInfo_content_sign proc near	; CODE XREF: _cms_SignedData_final+5Ap

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 64h ; 'd'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		mov	eax, [esp+64h+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+70h+arg_4]
		xor	ebp, ebp
		mov	[esp+70h+var_64], eax
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+74h+arg_8]
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_EVP_MD_CTX_init
		add	esp, 4
		cmp	[esi+20h], ebx
		jnz	short loc_125D
		push	249h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	85h ; '…'
		push	96h ; '–'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_125D:				; CODE XREF: _cms_SignerInfo_content_sign+40j
		push	dword ptr [esi+8]
		lea	eax, [esp+78h+var_5C]
		push	edi
		push	eax
		call	_cms_DigestAlgorithm_find_ctx
		add	esp, 0Ch
		test	eax, eax
		jz	$err$23_0
		cmp	[esi+3Ch], ebx
		jz	short loc_128E
		push	0
		push	esi
		call	_cms_sd_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	$err$23_0

loc_128E:				; CODE XREF: _cms_SignerInfo_content_sign+91j
		push	esi
		call	_CMS_signed_get_attr_count
		add	esp, 4
		test	eax, eax
		js	short loc_1312
		mov	eax, [esp+74h+var_64]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		mov	edi, [eax]
		lea	eax, [esp+74h+var_64]
		push	eax
		lea	eax, [esp+78h+var_44]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	$err$23_0
		push	[esp+74h+var_64]
		lea	eax, [esp+78h+var_44]
		push	eax
		push	4
		push	33h ; '3'
		push	esi
		call	_CMS_signed_add1_attr_by_NID
		add	esp, 14h
		test	eax, eax
		jz	$err$23_0
		push	0FFFFFFFFh
		push	edi
		push	6
		push	32h ; '2'
		push	esi
		call	_CMS_signed_add1_attr_by_NID
		add	esp, 14h
		test	eax, eax
		jle	$err$23_0
		push	esi
		call	_CMS_SignerInfo_sign
		add	esp, 4
		test	eax, eax
		jz	$err$23_0
		jmp	loc_1424
; ---------------------------------------------------------------------------

loc_1312:				; CODE XREF: _cms_SignerInfo_content_sign+B1j
		mov	eax, [esi+3Ch]
		test	eax, eax
		jz	loc_13A9
		mov	ebx, eax
		lea	eax, [esp+74h+var_60]
		push	eax
		lea	eax, [esp+78h+var_44]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jz	$err$23_0
		push	dword ptr [esi+20h]
		call	_EVP_PKEY_size
		push	270h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	eax
		mov	[esp+84h+var_64], eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_1383
		push	272h

loc_1368:				; CODE XREF: _cms_SignerInfo_content_sign+1EAj
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	41h ; 'A'
		push	96h ; '–'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$23_0
; ---------------------------------------------------------------------------

loc_1383:				; CODE XREF: _cms_SignerInfo_content_sign+179j
		push	[esp+74h+var_60]
		lea	eax, [esp+78h+var_44]
		push	eax
		lea	eax, [esp+7Ch+var_64]
		push	eax
		push	edi
		push	ebx
		call	_EVP_PKEY_sign
		add	esp, 14h
		test	eax, eax
		jle	$err$23_0
		push	[esp+74h+var_64]
		jmp	short loc_1418
; ---------------------------------------------------------------------------

loc_13A9:				; CODE XREF: _cms_SignerInfo_content_sign+12Fj
		push	27Bh
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	dword ptr [esi+20h]
		call	_EVP_PKEY_size
		add	esp, 4
		push	eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_13D4
		push	27Dh
		jmp	short loc_1368
; ---------------------------------------------------------------------------

loc_13D4:				; CODE XREF: _cms_SignerInfo_content_sign+1E3j
		push	dword ptr [esi+20h]
		lea	eax, [esp+78h+var_60]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	edi
		push	eax
		call	_EVP_SignFinal
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1414
		push	281h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	8Bh ; '‹'
		push	96h ; '–'
		push	2Eh ; '.'
		call	_ERR_put_error
		push	edi
		call	_CRYPTO_free
		add	esp, 18h
		jmp	short $err$23_0
; ---------------------------------------------------------------------------

loc_1414:				; CODE XREF: _cms_SignerInfo_content_sign+204j
		push	[esp+74h+var_60]

loc_1418:				; CODE XREF: _cms_SignerInfo_content_sign+1BFj
		push	edi
		push	dword ptr [esi+14h]
		call	_ASN1_STRING_set0
		add	esp, 0Ch

loc_1424:				; CODE XREF: _cms_SignerInfo_content_sign+125j
		mov	ebp, 1

$err$23_0:				; CODE XREF: _cms_SignerInfo_content_sign+88j
					; _cms_SignerInfo_content_sign+A0j ...
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1443
		push	ebx
		call	_EVP_PKEY_CTX_free
		add	esp, 4

loc_1443:				; CODE XREF: _cms_SignerInfo_content_sign+250j
		mov	ecx, [esp+74h+var_4]
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
_cms_SignerInfo_content_sign endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1458h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_add1_signingTime proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		xor	esi, esi
		push	edi
		test	ebx, ebx
		jz	short loc_1469
		mov	edi, ebx
		jmp	short loc_1477
; ---------------------------------------------------------------------------

loc_1469:				; CODE XREF: _cms_add1_signingTime+Bj
		push	0
		push	0
		call	_X509_gmtime_adj
		add	esp, 8
		mov	edi, eax

loc_1477:				; CODE XREF: _cms_add1_signingTime+Fj
		test	edi, edi
		jz	short $merr$11
		push	0FFFFFFFFh
		push	edi
		push	dword ptr [edi+4]
		push	34h ; '4'
		push	[esp+1Ch+arg_0]
		call	_CMS_signed_add1_attr_by_NID
		add	esp, 14h
		mov	ecx, 1
		test	eax, eax
		cmovg	esi, ecx

$merr$11:				; CODE XREF: _cms_add1_signingTime+21j
		test	ebx, ebx
		jnz	short loc_14A6
		push	edi
		call	_ASN1_TIME_free
		add	esp, 4

loc_14A6:				; CODE XREF: _cms_add1_signingTime+43j
		test	esi, esi
		jnz	short loc_14C2
		push	1B5h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	41h ; 'A'
		push	67h ; 'g'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

loc_14C2:				; CODE XREF: _cms_add1_signingTime+50j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
_cms_add1_signingTime endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_add_cipher_smcap proc near		; CODE XREF: _CMS_add_standard_smimecap+F1p
					; _CMS_add_standard_smimecap+105p ...

arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_cipherbyname
		add	esp, 8
		test	eax, eax
		jnz	_CMS_add_simple_smimecap
		mov	eax, 1
		retn
_cms_add_cipher_smcap endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_add_digest_smcap proc near

arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		add	esp, 8
		test	eax, eax
		jnz	_CMS_add_simple_smimecap
		mov	eax, 1
		retn
_cms_add_digest_smcap endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1508h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_copy_messageDigest	proc near	; CODE XREF: _CMS_add1_signer+2E4p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	dword ptr [ebx]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_153B
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		jmp	short loc_1545
; ---------------------------------------------------------------------------

loc_153B:				; CODE XREF: _cms_copy_messageDigest+15j
		mov	ebx, [ebx+4]
		test	ebx, ebx
		jz	short loc_1545
		mov	ebx, [ebx+14h]

loc_1545:				; CODE XREF: _cms_copy_messageDigest+31j
					; _cms_copy_messageDigest+38j
		push	ebx
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1599
		mov	ebp, [esp+10h+arg_4]

loc_1558:				; CODE XREF: _cms_copy_messageDigest+8Fj
		push	esi
		push	ebx
		call	_sk_value
		mov	edi, eax
		add	esp, 8
		cmp	edi, ebp
		jz	short loc_158B
		push	edi
		call	_CMS_signed_get_attr_count
		add	esp, 4
		test	eax, eax
		js	short loc_158B
		mov	eax, [edi+8]
		push	dword ptr [eax]
		mov	eax, [ebp+8]
		push	dword ptr [eax]
		call	_OBJ_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_15BB

loc_158B:				; CODE XREF: _cms_copy_messageDigest+5Ej
					; _cms_copy_messageDigest+6Bj
		push	ebx
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_1558

loc_1599:				; CODE XREF: _cms_copy_messageDigest+4Aj
		push	0C1h ; 'Á'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	83h ; 'ƒ'
		push	6Ch ; 'l'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_15BB:				; CODE XREF: _cms_copy_messageDigest+81j
		push	4
		push	0FFFFFFFDh
		push	33h ; '3'
		call	_OBJ_nid2obj
		add	esp, 4
		push	eax
		push	edi
		call	_CMS_signed_get0_data_by_OBJ
		add	esp, 10h
		test	eax, eax
		jnz	short loc_15F6
		push	0B6h ; '¶'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	72h ; 'r'
		push	6Ch ; 'l'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_15F6:				; CODE XREF: _cms_copy_messageDigest+CDj
		push	0FFFFFFFFh
		push	eax
		push	4
		push	33h ; '3'
		push	ebp
		call	_CMS_signed_add1_attr_by_NID
		add	esp, 14h
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
_cms_copy_messageDigest	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1614h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_get0_signed proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_1644
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1644:				; CODE XREF: _cms_get0_signed+12j
		mov	eax, [esi+4]
		pop	esi
		retn
_cms_get0_signed endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 164Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_sd_asn1_ctrl proc near		; CODE XREF: _CMS_SignerInfo_verify+8Bp
					; _CMS_SignerInfo_verify_content+1D1p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	edx, [ecx+20h]
		mov	eax, [edx+0Ch]
		test	eax, eax
		jz	short loc_16B3
		mov	eax, [eax+58h]
		test	eax, eax
		jz	short loc_16B3
		push	ecx
		push	[esp+4+arg_4]
		push	5
		push	edx
		call	eax
		add	esp, 10h
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_1691
		push	100h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	7Dh ; '}'
		push	0AAh ; 'ª'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1691:				; CODE XREF: _cms_sd_asn1_ctrl+25j
		test	eax, eax
		jg	short loc_16B3
		push	104h
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Fh ; 'o'
		push	0AAh ; 'ª'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_16B3:				; CODE XREF: _cms_sd_asn1_ctrl+Cj
					; _cms_sd_asn1_ctrl+13j ...
		mov	eax, 1
		retn
_cms_sd_asn1_ctrl endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 16BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_sd_set_version proc near		; CODE XREF: _cms_SignedData_init_bio+49p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		push	dword ptr [esi+0Ch]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1725

loc_16D3:				; CODE XREF: _cms_sd_set_version+67j
		push	edi
		push	dword ptr [esi+0Ch]
		call	_sk_value
		add	esp, 8
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_16F3
		cmp	dword ptr [esi], 5
		jge	short loc_1715
		mov	dword ptr [esi], 5
		jmp	short loc_1715
; ---------------------------------------------------------------------------

loc_16F3:				; CODE XREF: _cms_sd_set_version+28j
		cmp	eax, 3
		jnz	short loc_1705
		cmp	dword ptr [esi], 4
		jge	short loc_1715
		mov	dword ptr [esi], 4
		jmp	short loc_1715
; ---------------------------------------------------------------------------

loc_1705:				; CODE XREF: _cms_sd_set_version+3Aj
		cmp	eax, 2
		jnz	short loc_1715
		cmp	dword ptr [esi], 3
		jge	short loc_1715
		mov	dword ptr [esi], 3

loc_1715:				; CODE XREF: _cms_sd_set_version+2Dj
					; _cms_sd_set_version+35j ...
		push	dword ptr [esi+0Ch]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_16D3

loc_1725:				; CODE XREF: _cms_sd_set_version+15j
		push	dword ptr [esi+10h]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1768
		nop	word ptr [eax+eax+00h]

loc_173C:				; CODE XREF: _cms_sd_set_version+AAj
		push	edi
		push	dword ptr [esi+10h]
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax], 1
		jnz	short loc_1758
		cmp	dword ptr [esi], 5
		jge	short loc_1758
		mov	dword ptr [esi], 5

loc_1758:				; CODE XREF: _cms_sd_set_version+8Fj
					; _cms_sd_set_version+94j
		push	dword ptr [esi+10h]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_173C

loc_1768:				; CODE XREF: _cms_sd_set_version+78j
		mov	eax, [esi+8]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 15h
		jz	short loc_1785
		cmp	dword ptr [esi], 3
		jge	short loc_1785
		mov	dword ptr [esi], 3

loc_1785:				; CODE XREF: _cms_sd_set_version+BCj
					; _cms_sd_set_version+C1j
		push	dword ptr [esi+14h]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_17E3
		nop	word ptr [eax+eax+00h]

loc_179C:				; CODE XREF: _cms_sd_set_version+125j
		push	edi
		push	dword ptr [esi+14h]
		call	_sk_value
		add	esp, 8
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx], 1
		jnz	short loc_17C8
		cmp	dword ptr [eax], 3
		jge	short loc_17BB
		mov	dword ptr [eax], 3

loc_17BB:				; CODE XREF: _cms_sd_set_version+F7j
		cmp	dword ptr [esi], 3
		jge	short loc_17D3
		mov	dword ptr [esi], 3
		jmp	short loc_17D3
; ---------------------------------------------------------------------------

loc_17C8:				; CODE XREF: _cms_sd_set_version+F2j
		cmp	dword ptr [eax], 1
		jge	short loc_17D3
		mov	dword ptr [eax], 1

loc_17D3:				; CODE XREF: _cms_sd_set_version+102j
					; _cms_sd_set_version+10Aj ...
		push	dword ptr [esi+14h]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_179C

loc_17E3:				; CODE XREF: _cms_sd_set_version+D8j
		cmp	dword ptr [esi], 1
		jge	short loc_17EE
		mov	dword ptr [esi], 1

loc_17EE:				; CODE XREF: _cms_sd_set_version+12Aj
		pop	edi
		pop	esi
		retn
_cms_sd_set_version endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 17F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_set1_SignerIdentifier
_cms_set1_SignerIdentifier proc	near	; CODE XREF: _CMS_add1_signer+F9p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		mov	eax, edi
		sub	eax, 0
		jz	short loc_1844
		sub	eax, 1
		jz	short loc_1829
		push	0D3h ; 'Ó'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	96h ; '–'
		push	92h ; '’'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

loc_1824:				; CODE XREF: _cms_set1_SignerIdentifier+66j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1829:				; CODE XREF: _cms_set1_SignerIdentifier+10j
		mov	esi, [esp+8+arg_0]
		push	[esp+8+arg_4]
		lea	eax, [esi+4]
		push	eax
		call	_cms_set1_keyid
		add	esp, 8
		test	eax, eax
		jnz	short loc_185C
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1844:				; CODE XREF: _cms_set1_SignerIdentifier+Bj
		mov	esi, [esp+8+arg_0]
		push	[esp+8+arg_4]
		lea	eax, [esi+4]
		push	eax
		call	_cms_set1_ias
		add	esp, 8
		test	eax, eax
		jz	short loc_1824

loc_185C:				; CODE XREF: _cms_set1_SignerIdentifier+4Bj
		mov	[esi], edi
		mov	eax, 1
		pop	edi
		pop	esi
		retn
_cms_set1_SignerIdentifier endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1868h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_signed_data_init proc near		; CODE XREF: _CMS_SignedData_init+4p
					; _CMS_add1_signer+4Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_18DE
		call	_CMS_SignedData_it
		push	eax
		call	_ASN1_item_new
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jnz	short loc_18A4
		push	53h ; 'S'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	41h ; 'A'
		push	95h ; '•'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_18A4:				; CODE XREF: _cms_signed_data_init+1Ej
		push	15h
		mov	dword ptr [eax], 1
		call	_OBJ_nid2obj
		mov	ecx, [esi+4]
		mov	ecx, [ecx+8]
		mov	[ecx], eax
		mov	eax, [esi+4]
		mov	eax, [eax+8]
		mov	dword ptr [eax+8], 1
		push	dword ptr [esi]
		call	_ASN1_OBJECT_free
		push	16h
		call	_OBJ_nid2obj
		add	esp, 0Ch
		mov	[esi], eax

loc_18D9:				; CODE XREF: _cms_signed_data_init+83j
		mov	eax, [esi+4]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_18DE:				; CODE XREF: _cms_signed_data_init+9j
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 16h
		jz	short loc_18D9
		push	48h ; 'H'
		push	offset ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ ; ".\\crypto\\cms\\cms_sd.c"
		push	6Ch ; 'l'
		push	85h ; '…'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_cms_signed_data_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 190Ch
; COMDAT (pick any)
		public ??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@
; `string'
??_C@_0BG@OMKDNBAC@?4?2crypto?2cms?2cms_sd?4c?$AA@ db '.\crypto\cms\cms_sd.c',0
					; DATA XREF: _CMS_SignerInfo_set1_signer_cert+13o
					; _CMS_SignerInfo_sign+9Co ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _sk_num:near	; CODE XREF: _CMS_add1_signer+168p
					; _CMS_add1_signer+1B4p ...
		extrn _sk_value:near	; CODE XREF: _CMS_add1_signer+184p
					; _CMS_get0_signers+52p ...
		extrn _sk_new_null:near	; CODE XREF: _CMS_add1_signer+274p
					; _CMS_add1_signer+3A2p ...
		extrn _sk_free:near	; CODE XREF: _CMS_get0_signers+97p
		extrn _sk_pop_free:near	; CODE XREF: _CMS_add1_signer+2C0p
		extrn _sk_push:near	; CODE XREF: _CMS_add1_signer+1EDp
					; _CMS_add1_signer+3B7p ...
		extrn _CRYPTO_add_lock:near
					; CODE XREF: _CMS_SignerInfo_set1_signer_cert+20p
					; _CMS_add1_signer+95p	...
		extrn _CRYPTO_malloc:near ; CODE XREF: _CMS_SignerInfo_sign+19Bp
					; _cms_SignerInfo_content_sign+16Dp ...
		extrn _CRYPTO_free:near	; CODE XREF: _CMS_SignerInfo_sign+B8p
					; _CMS_SignerInfo_sign+188p ...
		extrn _BIO_push:near	; CODE XREF: _cms_SignedData_init_bio+7Fp
		extrn _BIO_free_all:near ; CODE	XREF: _cms_SignedData_init_bio+A6p
		extrn _ERR_put_error:near ; CODE XREF: _CMS_SignerInfo_sign+A7p
					; _CMS_SignerInfo_verify+31p ...
		extrn _ASN1_OBJECT_free:near ; CODE XREF: _cms_signed_data_init+60p
		extrn _ASN1_STRING_set0:near ; CODE XREF: _CMS_SignerInfo_sign+206p
					; _cms_SignerInfo_content_sign+234p
		extrn _ASN1_INTEGER_new:near ; CODE XREF: _CMS_add_simple_smimecap+Cp
		extrn _ASN1_INTEGER_free:near ;	CODE XREF: _CMS_add_simple_smimecap+39p
		extrn _ASN1_TIME_free:near ; CODE XREF:	_CMS_SignerInfo_sign+8Bp
					; _cms_add1_signingTime+46p
		extrn _ASN1_INTEGER_set:near ; CODE XREF: _CMS_add_simple_smimecap+1Dp
		extrn _ASN1_item_new:near ; CODE XREF: _CMS_add1_signer+63p
					; _cms_signed_data_init+11p
		extrn _ASN1_item_free:near ; CODE XREF:	_CMS_add1_signer+225p
		extrn _ASN1_item_i2d:near ; CODE XREF: _CMS_SignerInfo_sign+145p
					; _CMS_SignerInfo_verify+A9p
		extrn _OBJ_nid2obj:near	; CODE XREF: _CMS_SignerInfo_verify_content+43p
					; _CMS_add_simple_smimecap+59p	...
		extrn _OBJ_nid2sn:near	; CODE XREF: _CMS_SignerInfo_sign+27p
					; _CMS_SignerInfo_verify+4Bp ...
		extrn _OBJ_obj2nid:near	; CODE XREF: _CMS_SignerInfo_sign+21p
					; _CMS_SignerInfo_verify+45p ...
		extrn _OBJ_cmp:near	; CODE XREF: _cms_copy_messageDigest+77p
		extrn _EVP_MD_type:near	; CODE XREF: _CMS_add1_signer+1A4p
		extrn _EVP_MD_CTX_md:near ; CODE XREF: _CMS_SignerInfo_verify_content+187p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _CMS_SignerInfo_sign+EAp
					; _CMS_SignerInfo_verify+68p ...
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _CMS_SignerInfo_sign+C1p
					; _CMS_SignerInfo_sign+1F6p ...
		extrn _EVP_DigestUpdate:near ; CODE XREF: _CMS_SignerInfo_sign+15Cp
					; _CMS_SignerInfo_verify+BEp
		extrn _EVP_DigestFinal_ex:near
					; CODE XREF: _CMS_SignerInfo_verify_content+A3p
					; _cms_SignerInfo_content_sign+CEp ...
		extrn _EVP_SignFinal:near ; CODE XREF: _cms_SignerInfo_content_sign+1FAp
		extrn _EVP_DigestSignInit:near ; CODE XREF: _CMS_SignerInfo_sign+FBp
					; _CMS_add1_signer+38Cp
		extrn _EVP_DigestSignFinal:near	; CODE XREF: _CMS_SignerInfo_sign+174p
					; _CMS_SignerInfo_sign+1B6p
		extrn _EVP_DigestVerifyInit:near ; CODE	XREF: _CMS_SignerInfo_verify+78p
		extrn _EVP_DigestVerifyFinal:near ; CODE XREF: _CMS_SignerInfo_verify+F1p
		extrn _EVP_get_cipherbyname:near ; CODE	XREF: _CMS_add_standard_smimecap+Cp
					; _CMS_add_standard_smimecap+6Ep ...
		extrn _EVP_get_digestbyname:near ; CODE	XREF: _CMS_SignerInfo_sign+2Dp
					; _CMS_SignerInfo_verify+51p ...
		extrn _EVP_PKEY_size:near ; CODE XREF: _cms_SignerInfo_content_sign+159p
					; _cms_SignerInfo_content_sign+1CEp
		extrn _EVP_PKEY_free:near ; CODE XREF: _CMS_SignerInfo_set1_signer_cert+30p
					; _CMS_set1_signers_certs+11Fp	...
		extrn _EVP_PKEY_get_default_digest_nid:near
					; CODE XREF: _CMS_add1_signer+11Ap
		extrn _EVP_PKEY_CTX_new:near
					; CODE XREF: _CMS_SignerInfo_verify_content+193p
					; _CMS_add1_signer+340p
		extrn _EVP_PKEY_CTX_free:near
					; CODE XREF: _CMS_SignerInfo_verify_content+21Ep
					; _cms_SignerInfo_content_sign+253p
		extrn _EVP_PKEY_CTX_ctrl:near ;	CODE XREF: _CMS_SignerInfo_sign+115p
					; _CMS_SignerInfo_sign+1D3p ...
		extrn _EVP_PKEY_sign_init:near ; CODE XREF: _CMS_add1_signer+354p
		extrn _EVP_PKEY_sign:near ; CODE XREF: _cms_SignerInfo_content_sign+1ABp
		extrn _EVP_PKEY_verify_init:near
					; CODE XREF: _CMS_SignerInfo_verify_content+1A6p
		extrn _EVP_PKEY_verify:near ; CODE XREF: _CMS_SignerInfo_verify_content+1EFp
		extrn _X509_ALGOR_set0:near ; CODE XREF: _CMS_add_simple_smimecap+63p
		extrn _X509_ALGOR_get0:near ; CODE XREF: _CMS_add1_signer+193p
		extrn _X509_gmtime_adj:near ; CODE XREF: _CMS_SignerInfo_sign+61p
					; _cms_add1_signingTime+15p
		extrn _X509_ALGOR_new:near ; CODE XREF:	_CMS_add1_signer+1D7p
					; _CMS_add_simple_smimecap:loc_AD9p
		extrn _X509_ALGOR_free:near ; CODE XREF: _CMS_add1_signer+1FAp
					; _CMS_add_simple_smimecap+97p
					; DATA XREF: ...
		extrn _i2d_X509_ALGORS:near ; CODE XREF: _CMS_add_smimecap+19p
		extrn _X509_free:near	; CODE XREF: _CMS_SignerInfo_set1_signer_cert+4Cp
					; _CMS_set1_signers_certs+13Bp	...
		extrn _X509_get_pubkey:near
					; CODE XREF: _CMS_SignerInfo_set1_signer_cert+39p
					; _CMS_set1_signers_certs+128p	...
		extrn _X509_check_private_key:near ; CODE XREF:	_CMS_add1_signer+16p
		extrn _X509_check_purpose:near ; CODE XREF: _CMS_add1_signer+7Ep
		extrn _CMS_add1_cert:near ; CODE XREF: _CMS_add1_signer+320p
		extrn _CMS_signed_get_attr_count:near
					; CODE XREF: _CMS_SignerInfo_verify_content+31p
					; _cms_SignerInfo_content_sign+A7p ...
		extrn _CMS_signed_get_attr_by_NID:near ; CODE XREF: _CMS_SignerInfo_sign+4Cp
		extrn _CMS_signed_add1_attr_by_NID:near
					; CODE XREF: _CMS_SignerInfo_sign+78p
					; _CMS_add_smimecap+3Ap ...
		extrn _CMS_signed_get0_data_by_OBJ:near
					; CODE XREF: _CMS_SignerInfo_verify_content+4Dp
					; _cms_copy_messageDigest+C3p
		extrn _CMS_SignerInfo_it:near ;	CODE XREF: _CMS_add1_signer+5Dp
					; _CMS_add1_signer+21Ep
		extrn _CMS_Attributes_Sign_it:near
					; CODE XREF: _CMS_SignerInfo_sign:loc_283p
		extrn _CMS_Attributes_Verify_it:near ; CODE XREF: _CMS_SignerInfo_verify+9Bp
		extrn _cms_DigestAlgorithm_set:near ; CODE XREF: _CMS_add1_signer+15Ep
					; _CMS_add1_signer+1E4p
		extrn _cms_DigestAlgorithm_init_bio:near
					; CODE XREF: _cms_SignedData_init_bio+6Dp
		extrn _cms_DigestAlgorithm_find_ctx:near
					; CODE XREF: _CMS_SignerInfo_verify_content+84p
					; _cms_SignerInfo_content_sign+7Ep
		extrn _cms_ias_cert_cmp:near ; CODE XREF: _CMS_SignerInfo_cert_cmp+14p
					; _CMS_set1_signers_certs+C9p ...
		extrn _cms_keyid_cert_cmp:near ; CODE XREF: _CMS_SignerInfo_cert_cmp+29p
					; _CMS_set1_signers_certs+D9p ...
		extrn _cms_set1_ias:near ; CODE	XREF: _cms_set1_SignerIdentifier+5Cp
		extrn _cms_set1_keyid:near ; CODE XREF:	_cms_set1_SignerIdentifier+41p
		extrn _CMS_SignedData_it:near ;	CODE XREF: _cms_signed_data_init+Bp
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _CMS_SignerInfo_verify_content+23Fp
					; _cms_SignerInfo_content_sign+6Cp ...
		extrn __chkstk:near	; CODE XREF: _CMS_SignerInfo_sign+5p
					; _CMS_SignerInfo_verify_content+5p ...
		extrn ___security_cookie:near ;	DATA XREF: _CMS_SignerInfo_verify_content+Ar
					; _cms_SignerInfo_content_sign+Ar


		end
