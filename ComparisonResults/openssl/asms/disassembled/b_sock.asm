;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1D6940E2A45648C28F836A221E3A2231
; Input	CRC32 :	7C9F807D

; File Name   :	C:\compspace\Diff\openssl\obj\b_sock.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing
_wsa_init_done	dd ?			; DATA XREF: _BIO_sock_cleanupr
					; _BIO_sock_cleanup+9w	...
; `BIO_get_accept_socket'::`7'::p_getaddrinfo
?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9 dd ?
					; DATA XREF: _BIO_get_accept_socket:loc_493r
					; _BIO_get_accept_socket+AFw ...
; `BIO_get_accept_socket'::`7'::p_freeaddrinfo
?p_freeaddrinfo@?6??BIO_get_accept_socket@@9@9 dd ? ; DATA XREF: _BIO_get_accept_socket+C5w
					; _BIO_get_accept_socket+208r
; `BIO_accept'::`5'::p_getnameinfo
?p_getnameinfo@?4??BIO_accept@@9@9 dd ?	; DATA XREF: _BIO_accept+C5r
					; _BIO_accept+E0w ...
; struct WSAData `BIO_sock_init'::`2'::wsa_state
?wsa_state@?1??BIO_sock_init@@9@9 WSAData <?> ;	DATA XREF: _BIO_sock_init+10o
					; _BIO_sock_init+27o
_bss		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_accept(SOCKET	s, int)
		public _BIO_accept
_BIO_accept	proc near

addrlen		= dword	ptr -448h
addr		= sockaddr ptr -444h
var_434		= qword	ptr -434h
var_42C		= dword	ptr -42Ch
var_428		= byte ptr -428h
var_408		= byte ptr -408h
var_4		= dword	ptr -4
s		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 448h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+448h+var_4], eax
		push	ebp
		push	esi
		mov	esi, [esp+450h+arg_4]
		lea	eax, [esp+450h+addrlen]
		push	eax		; addrlen
		lea	eax, [esp+454h+addr]
		mov	[esp+454h+addrlen], 1Ch
		push	eax		; addr
		push	[esp+458h+s]	; s
		xorps	xmm0, xmm0
		mov	[esp+45Ch+var_42C], 0
		movups	xmmword	ptr [esp+45Ch+addr.sa_family], xmm0
		movq	[esp+45Ch+var_434], xmm0
		call	dword ptr ds:__imp__accept@12 ;	accept(x,x,x)
		mov	ebp, eax
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_25D
		push	eax
		call	_BIO_sock_should_retry
		add	esp, 4
		test	eax, eax
		jz	short loc_226
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		mov	ecx, [esp+448h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 448h
		retn
; ---------------------------------------------------------------------------

loc_226:				; CODE XREF: _BIO_accept+68j
		push	35Bh
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	8
		push	2
		call	_ERR_put_error
		push	35Ch
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	64h ; 'd'
		push	65h ; 'e'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 28h
		jmp	$end$27
; ---------------------------------------------------------------------------

loc_25D:				; CODE XREF: _BIO_accept+5Bj
		test	esi, esi
		jz	$end$27
		mov	eax, ds:?p_getnameinfo@?4??BIO_accept@@9@9 ; `BIO_accept'::`5'::p_getnameinfo
		push	edi
		test	eax, eax
		jnz	loc_2FB
		push	offset ??_C@_0M@NNJNLPKG@getnameinfo?$AA@ ; "getnameinfo"
		call	_DSO_global_lookup
		add	esp, 4
		mov	ds:?p_getnameinfo@?4??BIO_accept@@9@9, eax ; `BIO_accept'::`5'::p_getnameinfo
		test	eax, eax
		jnz	short loc_2FB
		mov	ds:?p_getnameinfo@?4??BIO_accept@@9@9, 0FFFFFFFFh ; `BIO_accept'::`5'::p_getnameinfo

loc_293:				; CODE XREF: _BIO_accept+15Ej
					; _BIO_accept+180j
		cmp	[esp+454h+addr.sa_family], 2
		jnz	loc_3EA
		push	ebx
		push	dword ptr [esp+458h+addr.sa_data+2] ; netlong
		call	dword ptr ds:__imp__ntohl@4 ; ntohl(x)
		push	dword ptr [esp+458h+addr.sa_data] ; netshort
		mov	ebx, eax
		call	dword ptr ds:__imp__ntohs@4 ; ntohs(x)
		cmp	dword ptr [esi], 0
		movzx	edi, ax
		jnz	loc_3BD
		push	395h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	18h
		call	_CRYPTO_malloc
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_3BB
		push	396h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	41h ; 'A'
		push	65h ; 'e'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_3E9
; ---------------------------------------------------------------------------

loc_2FB:				; CODE XREF: _BIO_accept+CDj
					; _BIO_accept+E7j
		cmp	eax, 0FFFFFFFFh
		jz	short loc_293
		push	0Ah
		push	20h ; ' '
		lea	ecx, [esp+45Ch+var_428]
		push	ecx
		push	401h
		lea	ecx, [esp+464h+var_408]
		push	ecx
		push	[esp+468h+addrlen]
		lea	ecx, [esp+46Ch+addr]
		push	ecx
		call	eax ; `BIO_accept'::`5'::p_getnameinfo
		test	eax, eax
		jnz	loc_293
		lea	ecx, [esp+454h+var_408]
		lea	edx, [ecx+1]
		nop	dword ptr [eax]

loc_330:				; CODE XREF: _BIO_accept+195j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_330
		sub	ecx, edx
		lea	edx, [esp+454h+var_428]
		lea	edi, [edx+1]

loc_340:				; CODE XREF: _BIO_accept+1A5j
		mov	al, [edx]
		inc	edx
		test	al, al
		jnz	short loc_340
		mov	eax, [esi]
		sub	edx, edi
		lea	edi, [ecx+2]
		add	edi, edx
		test	eax, eax
		jz	short loc_36D
		push	383h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	edi
		push	eax
		mov	byte ptr [eax],	0
		call	_CRYPTO_realloc
		add	esp, 10h
		jmp	short loc_380
; ---------------------------------------------------------------------------

loc_36D:				; CODE XREF: _BIO_accept+1B2j
		push	385h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	edi
		call	_CRYPTO_malloc
		add	esp, 0Ch

loc_380:				; CODE XREF: _BIO_accept+1CBj
		test	eax, eax
		jnz	short loc_39E
		push	388h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	41h ; 'A'
		push	65h ; 'e'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_3EA
; ---------------------------------------------------------------------------

loc_39E:				; CODE XREF: _BIO_accept+1E2j
		lea	ecx, [esp+454h+var_428]
		mov	[esi], eax
		push	ecx
		lea	ecx, [esp+458h+var_408]
		push	ecx
		push	offset ??_C@_05CCMOGDN@?$CFs?3?$CFs?$AA@ ; "%s:%s"
		push	edi
		push	eax
		call	_BIO_snprintf
		add	esp, 14h
		jmp	short loc_3EA
; ---------------------------------------------------------------------------

loc_3BB:				; CODE XREF: _BIO_accept+138j
		mov	[esi], eax

loc_3BD:				; CODE XREF: _BIO_accept+11Cj
		push	edi
		movzx	eax, bl
		push	eax
		mov	eax, ebx
		shr	eax, 8
		movzx	eax, al
		push	eax
		mov	eax, ebx
		shr	ebx, 18h
		shr	eax, 10h
		movzx	eax, al
		push	eax
		push	ebx
		push	offset ??_C@_0P@OGJLBNEC@?$CFd?4?$CFd?4?$CFd?4?$CFd?3?$CFd?$AA@	; "%d.%d.%d.%d:%d"
		push	18h
		push	dword ptr [esi]
		call	_BIO_snprintf
		add	esp, 20h

loc_3E9:				; CODE XREF: _BIO_accept+156j
		pop	ebx

loc_3EA:				; CODE XREF: _BIO_accept+F9j
					; _BIO_accept+1FCj ...
		pop	edi

$end$27:				; CODE XREF: _BIO_accept+B8j
					; _BIO_accept+BFj
		mov	ecx, [esp+450h+var_4]
		mov	eax, ebp
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 448h
		retn
_BIO_accept	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 404h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BIO_get_accept_socket
_BIO_get_accept_socket proc near

var_70		= dword	ptr -70h
hostshort	= word ptr -6Ch
optval		= byte ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= xmmword ptr -5Ch
var_4C		= xmmword ptr -4Ch
Dst		= xmmword ptr -3Ch
var_2C		= qword	ptr -2Ch
var_24		= dword	ptr -24h
name		= sockaddr ptr -20h
var_10		= qword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 70h ; 'p'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		push	ebx
		mov	ebx, [esp+74h+arg_0]
		push	ebp
		mov	[esp+78h+var_64], ebx
		or	ebp, 0FFFFFFFFh
		mov	dword ptr [esp+78h+optval], 0
		call	_BIO_sock_init
		cmp	eax, 1
		jz	short loc_44C

loc_438:				; CODE XREF: _BIO_get_accept_socket+59j
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+70h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_44C:				; CODE XREF: _BIO_get_accept_socket+32j
		push	ebx
		call	_BUF_strdup
		mov	edx, eax
		add	esp, 4
		mov	[esp+78h+var_60], edx
		test	edx, edx
		jz	short loc_438
		push	esi
		xor	esi, esi
		mov	ebx, edx
		cmp	byte ptr [edx],	0
		push	edi
		jz	short loc_48F

loc_46A:				; CODE XREF: _BIO_get_accept_socket+7Aj
		mov	cl, [eax]
		cmp	cl, 3Ah	; ':'
		jnz	short loc_475
		mov	esi, eax
		jmp	short loc_47A
; ---------------------------------------------------------------------------

loc_475:				; CODE XREF: _BIO_get_accept_socket+6Bj
		cmp	cl, 2Fh	; '/'
		jz	short loc_482

loc_47A:				; CODE XREF: _BIO_get_accept_socket+6Fj
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_46A
		jmp	short loc_485
; ---------------------------------------------------------------------------

loc_482:				; CODE XREF: _BIO_get_accept_socket+74j
		mov	byte ptr [eax],	0

loc_485:				; CODE XREF: _BIO_get_accept_socket+7Cj
		test	esi, esi
		jz	short loc_48F
		mov	byte ptr [esi],	0
		inc	esi
		jmp	short loc_493
; ---------------------------------------------------------------------------

loc_48F:				; CODE XREF: _BIO_get_accept_socket+64j
					; _BIO_get_accept_socket+83j
		mov	esi, edx
		xor	ebx, ebx

loc_493:				; CODE XREF: _BIO_get_accept_socket+89j
		cmp	ds:?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9, 0 ; `BIO_get_accept_socket'::`7'::p_getaddrinfo
		mov	edi, dword ptr ds:__imp__closesocket@4 ; closesocket(x)
		jnz	loc_56F
		push	offset ??_C@_0M@MBIPAJOD@getaddrinfo?$AA@ ; "getaddrinfo"
		call	_DSO_global_lookup
		add	esp, 4
		mov	ds:?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9, eax ;	`BIO_get_accept_socket'::`7'::p_getaddrinfo
		test	eax, eax
		jz	short loc_4D6
		push	offset ??_C@_0N@EHOPPMLH@freeaddrinfo?$AA@ ; "freeaddrinfo"
		call	_DSO_global_lookup
		add	esp, 4
		mov	ds:?p_freeaddrinfo@?6??BIO_get_accept_socket@@9@9, eax ; `BIO_get_accept_socket'::`7'::p_freeaddrinfo
		test	eax, eax
		jnz	loc_56F

loc_4D6:				; CODE XREF: _BIO_get_accept_socket+B6j
		mov	ds:?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9, 0FFFFFFFFh ; `BIO_get_accept_socket'::`7'::p_getaddrinfo

loc_4E0:				; CODE XREF: _BIO_get_accept_socket+172j
					; _BIO_get_accept_socket+1DCj
		lea	eax, [esp+80h+hostshort]
		push	eax		; int
		push	esi		; Str
		call	_BIO_get_port
		add	esp, 8
		test	eax, eax
		jz	$err$77
		push	dword ptr [esp+80h+hostshort] ;	hostshort
		xorps	xmm0, xmm0
		mov	[esp+84h+var_24], 0
		mov	eax, 2
		movq	[esp+84h+var_2C], xmm0
		movups	[esp+84h+Dst], xmm0
		mov	word ptr [esp+84h+Dst],	ax
		call	dword ptr ds:__imp__htons@4 ; htons(x)
		mov	word ptr [esp+80h+Dst+2], ax
		mov	dword ptr [esp+80h+hostshort], 10h
		test	ebx, ebx
		jz	loc_663
		mov	ecx, offset ??_C@_01NBENCBCI@?$CK?$AA@ ; `string'
		mov	eax, ebx
		nop	dword ptr [eax+eax+00000000h]

loc_544:				; CODE XREF: _BIO_get_accept_socket+162j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	loc_614
		test	dl, dl
		jz	short loc_568
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	loc_614
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_544

loc_568:				; CODE XREF: _BIO_get_accept_socket+14Cj
		xor	eax, eax
		jmp	loc_619
; ---------------------------------------------------------------------------

loc_56F:				; CODE XREF: _BIO_get_accept_socket+9Cj
					; _BIO_get_accept_socket+CCj
		cmp	ds:?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9, 0FFFFFFFFh ; `BIO_get_accept_socket'::`7'::p_getaddrinfo
		jz	loc_4E0
		xorps	xmm0, xmm0
		movups	[esp+80h+var_5C], xmm0
		mov	dword ptr [esp+80h+var_5C], 1
		movups	[esp+80h+var_4C], xmm0
		test	ebx, ebx
		jz	short loc_5CC
		push	3Ah ; ':'       ; Val
		push	ebx		; Str
		call	dword ptr ds:__imp__strchr
		add	esp, 8
		test	eax, eax
		jz	short loc_5B7
		xor	eax, eax
		mov	dword ptr [esp+80h+var_5C+4], 17h
		cmp	[ebx+1], al
		cmovz	ebx, eax
		jmp	short loc_5CC
; ---------------------------------------------------------------------------

loc_5B7:				; CODE XREF: _BIO_get_accept_socket+19Fj
		cmp	byte ptr [ebx],	2Ah ; '*'
		jnz	short loc_5CC
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_5CC
		mov	dword ptr [esp+80h+var_5C+4], 2
		xor	ebx, ebx

loc_5CC:				; CODE XREF: _BIO_get_accept_socket+18Fj
					; _BIO_get_accept_socket+1B1j ...
		lea	eax, [esp+80h+var_70]
		push	eax
		lea	eax, [esp+84h+var_5C]
		push	eax
		push	esi
		push	ebx
		call	ds:?p_getaddrinfo@?6??BIO_get_accept_socket@@9@9 ; `BIO_get_accept_socket'::`7'::p_getaddrinfo
		test	eax, eax
		jnz	loc_4E0
		mov	esi, [esp+80h+var_70]
		lea	eax, [esp+80h+Dst]
		mov	ecx, 1Ch
		cmp	[esi+10h], ecx
		cmovbe	ecx, [esi+10h]
		push	ecx		; Size
		push	dword ptr [esi+18h] ; Src
		mov	dword ptr [esp+88h+hostshort], ecx
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		push	esi
		call	ds:?p_freeaddrinfo@?6??BIO_get_accept_socket@@9@9 ; `BIO_get_accept_socket'::`7'::p_freeaddrinfo
		jmp	short loc_66B
; ---------------------------------------------------------------------------

loc_614:				; CODE XREF: _BIO_get_accept_socket+144j
					; _BIO_get_accept_socket+154j
		sbb	eax, eax
		or	eax, 1

loc_619:				; CODE XREF: _BIO_get_accept_socket+166j
		test	eax, eax
		jz	short loc_663
		lea	eax, [esp+80h+var_70]
		push	eax		; int
		push	ebx		; name
		call	_BIO_get_host_ip
		add	esp, 8
		test	eax, eax
		jz	$err$77
		mov	eax, [esp+80h+var_70]
		movzx	ecx, al
		shl	ecx, 8
		movzx	eax, ah
		or	ecx, eax
		movzx	eax, byte ptr [esp+80h+var_70+2]
		shl	ecx, 8
		or	ecx, eax
		movzx	eax, byte ptr [esp+80h+var_70+3]
		shl	ecx, 8
		or	ecx, eax
		push	ecx		; hostlong
		call	dword ptr ds:__imp__htonl@4 ; htonl(x)
		mov	dword ptr [esp+80h+Dst+4], eax
		jmp	short loc_66B
; ---------------------------------------------------------------------------

loc_663:				; CODE XREF: _BIO_get_accept_socket+12Bj
					; _BIO_get_accept_socket+217j
		mov	dword ptr [esp+80h+Dst+4], 0

loc_66B:				; CODE XREF: _BIO_get_accept_socket+20Ej
					; _BIO_get_accept_socket+25Dj
		movzx	eax, word ptr [esp+80h+Dst]
		mov	edi, dword ptr ds:__imp__socket@12 ; socket(x,x,x)
		push	6		; protocol
		push	1		; type
		push	eax		; af
		call	edi ; socket(x,x,x) ; socket(x,x,x)
		mov	ebp, eax
		cmp	ebp, 0FFFFFFFFh
		jz	loc_7D8
		mov	esi, [esp+80h+arg_4]
		nop	dword ptr [eax+eax+00h]

$again$78:				; CODE XREF: _BIO_get_accept_socket+3CEj
		cmp	esi, 2
		jnz	short loc_6BC
		push	4		; optlen
		lea	eax, [esp+84h+optval]
		mov	dword ptr [esp+84h+optval], 1
		push	eax		; optval
		push	4		; optname
		push	0FFFFh		; level
		push	ebp		; s
		call	dword ptr ds:__imp__setsockopt@20 ; setsockopt(x,x,x,x,x)
		mov	dword ptr [esp+80h+optval], eax
		xor	esi, esi

loc_6BC:				; CODE XREF: _BIO_get_accept_socket+293j
		push	dword ptr [esp+80h+hostshort] ;	namelen
		lea	eax, [esp+84h+Dst]
		push	eax		; name
		push	ebp		; s
		call	dword ptr ds:__imp__bind@12 ; bind(x,x,x)
		cmp	eax, 0FFFFFFFFh
		jnz	loc_8AB
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		mov	[esp+80h+var_70], eax
		cmp	esi, 1
		jnz	loc_85C
		cmp	eax, 2740h
		jnz	loc_85C
		mov	eax, [esp+80h+var_24]
		mov	[esp+80h+var_8], eax
		movups	xmm0, [esp+80h+Dst]
		movups	xmmword	ptr [esp+80h+name.sa_family], xmm0
		movq	xmm0, [esp+80h+var_2C]
		movq	[esp+80h+var_10], xmm0
		test	ebx, ebx
		jz	short loc_745
		mov	ecx, offset ??_C@_01NBENCBCI@?$CK?$AA@ ; `string'
		mov	eax, ebx

loc_71C:				; CODE XREF: _BIO_get_accept_socket+332j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_73C
		test	dl, dl
		jz	short loc_738
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_73C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_71C

loc_738:				; CODE XREF: _BIO_get_accept_socket+320j
		xor	eax, eax
		jmp	short loc_741
; ---------------------------------------------------------------------------

loc_73C:				; CODE XREF: _BIO_get_accept_socket+31Cj
					; _BIO_get_accept_socket+328j
		sbb	eax, eax
		or	eax, 1

loc_741:				; CODE XREF: _BIO_get_accept_socket+336j
		test	eax, eax
		jnz	short loc_778

loc_745:				; CODE XREF: _BIO_get_accept_socket+30Fj
		mov	ax, word ptr [esp+80h+Dst]
		cmp	ax, 17h
		jnz	short loc_75F
		xorps	xmm0, xmm0
		movups	xmmword	ptr [esp+80h+name.sa_data+6], xmm0
		mov	byte ptr [esp+80h+var_10+7], 1
		jmp	short loc_778
; ---------------------------------------------------------------------------

loc_75F:				; CODE XREF: _BIO_get_accept_socket+34Aj
		cmp	ax, 2
		jnz	loc_81F
		push	7F000001h	; hostlong
		call	dword ptr ds:__imp__htonl@4 ; htonl(x)
		mov	dword ptr [esp+80h+name.sa_data+2], eax

loc_778:				; CODE XREF: _BIO_get_accept_socket+33Fj
					; _BIO_get_accept_socket+359j
		movzx	eax, [esp+80h+name.sa_family]
		push	6		; protocol
		push	1		; type
		push	eax		; af
		call	edi ; socket(x,x,x) ; socket(x,x,x)
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	loc_858
		push	dword ptr [esp+80h+hostshort] ;	namelen
		lea	eax, [esp+84h+name]
		push	eax		; name
		push	edi		; s
		call	dword ptr ds:__imp__connect@12 ; connect(x,x,x)
		push	edi		; s
		mov	edi, dword ptr ds:__imp__closesocket@4 ; closesocket(x)
		mov	esi, eax
		call	edi ; closesocket(x) ; closesocket(x)
		cmp	esi, 0FFFFFFFFh
		jnz	loc_8A5
		push	ebp		; s
		mov	esi, 2
		call	edi ; closesocket(x) ; closesocket(x)
		movzx	eax, word ptr [esp+80h+Dst]
		mov	edi, dword ptr ds:__imp__socket@12 ; socket(x,x,x)
		push	6		; protocol
		push	1		; type
		push	eax		; af
		call	edi ; socket(x,x,x) ; socket(x,x,x)
		mov	ebp, eax
		cmp	ebp, 0FFFFFFFFh
		jnz	$again$78

loc_7D8:				; CODE XREF: _BIO_get_accept_socket+27Ej
		push	2D8h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	4
		push	2
		call	_ERR_put_error
		push	offset ??_C@_01GEODFPGF@?8?$AA@	; `string'
		push	[esp+98h+var_64]
		push	offset ??_C@_06OGGAANOH@port?$DN?8?$AA@	; "port='"
		push	3
		call	_ERR_add_error_data
		push	2DAh
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	76h ; 'v'

loc_813:				; CODE XREF: _BIO_get_accept_socket+4F3j
		push	69h ; 'i'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 38h

loc_81F:				; CODE XREF: _BIO_get_accept_socket+35Fj
					; _BIO_get_accept_socket+500j
		mov	edi, dword ptr ds:__imp__closesocket@4 ; closesocket(x)

$err$77:				; CODE XREF: _BIO_get_accept_socket+ECj
					; _BIO_get_accept_socket+229j ...
		push	[esp+80h+var_60]
		call	_CRYPTO_free
		add	esp, 4
		cmp	dword ptr [esp+80h+optval], 0
		jnz	short loc_843
		cmp	ebp, 0FFFFFFFFh
		jz	short loc_843
		push	ebp		; s
		call	edi ; closesocket(x) ; closesocket(x)
		or	ebp, 0FFFFFFFFh

loc_843:				; CODE XREF: _BIO_get_accept_socket+432j
					; _BIO_get_accept_socket+437j
		mov	ecx, [esp+80h+var_4]
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
; ---------------------------------------------------------------------------

loc_858:				; CODE XREF: _BIO_get_accept_socket+385j
		mov	eax, [esp+80h+var_70]

loc_85C:				; CODE XREF: _BIO_get_accept_socket+2DEj
					; _BIO_get_accept_socket+2E9j
		mov	edi, dword ptr ds:__imp__closesocket@4 ; closesocket(x)

loc_862:				; CODE XREF: _BIO_get_accept_socket+4A5j
		push	30Fh
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	eax
		push	6
		push	2
		call	_ERR_put_error
		push	offset ??_C@_01GEODFPGF@?8?$AA@	; `string'
		push	[esp+98h+var_64]
		push	offset ??_C@_06OGGAANOH@port?$DN?8?$AA@	; "port='"
		push	3
		call	_ERR_add_error_data
		push	311h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	75h ; 'u'
		push	69h ; 'i'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 38h
		jmp	short $err$77
; ---------------------------------------------------------------------------

loc_8A5:				; CODE XREF: _BIO_get_accept_socket+3A9j
		mov	eax, [esp+80h+var_70]
		jmp	short loc_862
; ---------------------------------------------------------------------------

loc_8AB:				; CODE XREF: _BIO_get_accept_socket+2CBj
		push	7FFFFFFFh	; backlog
		push	ebp		; s
		call	dword ptr ds:__imp__listen@8 ; listen(x,x)
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_8FC
		push	315h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	6
		push	2
		call	_ERR_put_error
		push	offset ??_C@_01GEODFPGF@?8?$AA@	; `string'
		push	[esp+98h+var_64]
		push	offset ??_C@_06OGGAANOH@port?$DN?8?$AA@	; "port='"
		push	3
		call	_ERR_add_error_data
		push	317h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	77h ; 'w'
		jmp	loc_813
; ---------------------------------------------------------------------------

loc_8FC:				; CODE XREF: _BIO_get_accept_socket+4B6j
		mov	dword ptr [esp+80h+optval], 1
		jmp	loc_81F
_BIO_get_accept_socket endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 90Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_get_host_ip(char *name, int)
		public _BIO_get_host_ip
_BIO_get_host_ip proc near		; CODE XREF: _BIO_get_accept_socket+21Fp

name		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+name]
		mov	ebp, 1
		push	edi
		push	ebx
		push	esi
		call	_get_ip
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jns	short loc_947
		push	7Bh ; '{'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	6Ch ; 'l'
		push	6Ah ; 'j'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_A08
; ---------------------------------------------------------------------------

loc_947:				; CODE XREF: _BIO_get_host_ip+1Fj
		call	_BIO_sock_init
		cmp	eax, 1
		jnz	loc_A18
		test	edi, edi
		jle	short loc_960
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_960:				; CODE XREF: _BIO_get_host_ip+4Bj
		push	8Eh ; 'Ž'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	16h
		push	9
		call	_CRYPTO_lock
		add	esp, 10h
		push	esi		; name
		call	dword ptr ds:__imp__gethostbyname@4 ; gethostbyname(x)
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_99D
		push	92h ; '’'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	66h ; 'f'
		push	6Ah ; 'j'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_9EE
; ---------------------------------------------------------------------------

loc_99D:				; CODE XREF: _BIO_get_host_ip+75j
		cmp	word ptr [ecx+8], 2
		jz	short loc_9BE
		push	99h ; '™'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	6Bh ; 'k'
		push	6Ah ; 'j'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_9EE
; ---------------------------------------------------------------------------

loc_9BE:				; CODE XREF: _BIO_get_host_ip+96j
		mov	eax, [ecx+0Ch]
		xor	ebp, ebp
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ecx+0Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax+1]
		mov	[ebx+1], al
		mov	eax, [ecx+0Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax+2]
		mov	[ebx+2], al
		mov	eax, [ecx+0Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax+3]
		mov	[ebx+3], al

loc_9EE:				; CODE XREF: _BIO_get_host_ip+8Fj
					; _BIO_get_host_ip+B0j
		push	0A2h ; '¢'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	16h
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		test	ebp, ebp
		jz	short loc_A1F

loc_A08:				; CODE XREF: _BIO_get_host_ip+36j
		push	esi
		push	offset ??_C@_05PBGCLELH@host?$DN?$AA@ ;	"host="
		push	2
		call	_ERR_add_error_data
		add	esp, 0Ch

loc_A18:				; CODE XREF: _BIO_get_host_ip+43j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_A1F:				; CODE XREF: _BIO_get_host_ip+FAj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_BIO_get_host_ip endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A2Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_get_port(char	*Str, int)
		public _BIO_get_port
_BIO_get_port	proc near		; CODE XREF: _BIO_get_accept_socket+E2p

Str		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		mov	edi, [esp+4+Str]
		test	edi, edi
		jnz	short loc_A51
		push	0B0h ; '°'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	71h ; 'q'
		push	6Bh ; 'k'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_A51:				; CODE XREF: _BIO_get_port+7j
		push	ebx
		push	edi		; Str
		call	dword ptr ds:__imp__atoi
		add	esp, 4
		test	eax, eax
		jz	short loc_A6F
		mov	ecx, [esp+8+arg_4]
		pop	ebx
		pop	edi
		mov	[ecx], ax
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_A6F:				; CODE XREF: _BIO_get_port+32j
		push	esi
		push	0B7h ; '·'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	17h
		push	9
		call	_CRYPTO_lock
		add	esp, 10h
		push	offset ??_C@_03FPEIBLKH@tcp?$AA@ ; "tcp"
		push	edi		; name
		call	dword ptr ds:__imp__getservbyname@8 ; getservbyname(x,x)
		mov	ebx, [esp+0Ch+arg_4]
		mov	esi, eax
		test	esi, esi
		jz	short loc_AAA
		movzx	ecx, word ptr [esi+8]
		push	ecx		; netshort
		call	dword ptr ds:__imp__ntohs@4 ; ntohs(x)
		mov	[ebx], ax

loc_AAA:				; CODE XREF: _BIO_get_port+6Ej
		push	0C3h ; 'Ã'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	17h
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		test	esi, esi
		pop	esi
		jnz	short loc_AFD
		mov	ecx, offset ??_C@_04IAFLKNP@http?$AA@ ;	"http"
		mov	eax, edi

loc_ACC:				; CODE XREF: _BIO_get_port+BAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_AEC
		test	dl, dl
		jz	short loc_AE8
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_AEC
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_ACC

loc_AE8:				; CODE XREF: _BIO_get_port+A8j
		xor	eax, eax
		jmp	short loc_AF1
; ---------------------------------------------------------------------------

loc_AEC:				; CODE XREF: _BIO_get_port+A4j
					; _BIO_get_port+B0j
		sbb	eax, eax
		or	eax, 1

loc_AF1:				; CODE XREF: _BIO_get_port+BEj
		test	eax, eax
		jnz	short loc_B05
		mov	eax, 50h ; 'P'
		mov	[ebx], ax

loc_AFD:				; CODE XREF: _BIO_get_port+97j
		pop	ebx
		mov	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_B05:				; CODE XREF: _BIO_get_port+C7j
		mov	ecx, offset ??_C@_06KAPJOFBF@telnet?$AA@ ; "telnet"
		mov	eax, edi

loc_B0C:				; CODE XREF: _BIO_get_port+FAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_B2C
		test	dl, dl
		jz	short loc_B28
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_B2C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_B0C

loc_B28:				; CODE XREF: _BIO_get_port+E8j
		xor	eax, eax
		jmp	short loc_B31
; ---------------------------------------------------------------------------

loc_B2C:				; CODE XREF: _BIO_get_port+E4j
					; _BIO_get_port+F0j
		sbb	eax, eax
		or	eax, 1

loc_B31:				; CODE XREF: _BIO_get_port+FEj
		test	eax, eax
		jnz	short loc_B45
		mov	eax, 17h
		mov	[ebx], ax
		mov	eax, 1
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_B45:				; CODE XREF: _BIO_get_port+107j
		mov	ecx, offset ??_C@_05LBOKJHLG@socks?$AA@	; "socks"
		mov	eax, edi

loc_B4C:				; CODE XREF: _BIO_get_port+13Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_B6C
		test	dl, dl
		jz	short loc_B68
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_B6C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_B4C

loc_B68:				; CODE XREF: _BIO_get_port+128j
		xor	eax, eax
		jmp	short loc_B71
; ---------------------------------------------------------------------------

loc_B6C:				; CODE XREF: _BIO_get_port+124j
					; _BIO_get_port+130j
		sbb	eax, eax
		or	eax, 1

loc_B71:				; CODE XREF: _BIO_get_port+13Ej
		test	eax, eax
		jnz	short loc_B85
		mov	eax, 438h
		mov	[ebx], ax
		mov	eax, 1
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_B85:				; CODE XREF: _BIO_get_port+147j
		mov	ecx, offset ??_C@_05BCHGOAMK@https?$AA@	; "https"
		mov	eax, edi

loc_B8C:				; CODE XREF: _BIO_get_port+17Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_BAC
		test	dl, dl
		jz	short loc_BA8
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_BAC
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_B8C

loc_BA8:				; CODE XREF: _BIO_get_port+168j
		xor	eax, eax
		jmp	short loc_BB1
; ---------------------------------------------------------------------------

loc_BAC:				; CODE XREF: _BIO_get_port+164j
					; _BIO_get_port+170j
		sbb	eax, eax
		or	eax, 1

loc_BB1:				; CODE XREF: _BIO_get_port+17Ej
		test	eax, eax
		jz	short loc_BE5
		mov	ecx, offset ??_C@_03DIMONNDD@ssl?$AA@ ;	`string'
		mov	eax, edi

loc_BBC:				; CODE XREF: _BIO_get_port+1AAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_BDC
		test	dl, dl
		jz	short loc_BD8
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_BDC
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_BBC

loc_BD8:				; CODE XREF: _BIO_get_port+198j
		xor	eax, eax
		jmp	short loc_BE1
; ---------------------------------------------------------------------------

loc_BDC:				; CODE XREF: _BIO_get_port+194j
					; _BIO_get_port+1A0j
		sbb	eax, eax
		or	eax, 1

loc_BE1:				; CODE XREF: _BIO_get_port+1AEj
		test	eax, eax
		jnz	short loc_BF5

loc_BE5:				; CODE XREF: _BIO_get_port+187j
		mov	eax, 1BBh
		mov	[ebx], ax
		mov	eax, 1
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_BF5:				; CODE XREF: _BIO_get_port+1B7j
		mov	ecx, offset ??_C@_03LMDBDBEG@ftp?$AA@ ;	`string'
		mov	eax, edi

loc_BFC:				; CODE XREF: _BIO_get_port+1EAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_C1C
		test	dl, dl
		jz	short loc_C18
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_C1C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_BFC

loc_C18:				; CODE XREF: _BIO_get_port+1D8j
		xor	eax, eax
		jmp	short loc_C21
; ---------------------------------------------------------------------------

loc_C1C:				; CODE XREF: _BIO_get_port+1D4j
					; _BIO_get_port+1E0j
		sbb	eax, eax
		or	eax, 1

loc_C21:				; CODE XREF: _BIO_get_port+1EEj
		test	eax, eax
		jnz	short loc_C35
		mov	eax, 15h
		mov	[ebx], ax
		mov	eax, 1
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_C35:				; CODE XREF: _BIO_get_port+1F7j
		mov	ecx, offset ??_C@_06IBHFMCPJ@gopher?$AA@ ; "gopher"
		mov	eax, edi

loc_C3C:				; CODE XREF: _BIO_get_port+22Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_C5C
		test	dl, dl
		jz	short loc_C58
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_C5C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_C3C

loc_C58:				; CODE XREF: _BIO_get_port+218j
		xor	eax, eax
		jmp	short loc_C61
; ---------------------------------------------------------------------------

loc_C5C:				; CODE XREF: _BIO_get_port+214j
					; _BIO_get_port+220j
		sbb	eax, eax
		or	eax, 1

loc_C61:				; CODE XREF: _BIO_get_port+22Ej
		test	eax, eax
		jnz	short loc_C75
		mov	eax, 46h ; 'F'
		mov	[ebx], ax
		mov	eax, 1
		pop	ebx
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_C75:				; CODE XREF: _BIO_get_port+237j
		push	0D8h ; 'Ø'
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	3
		push	2
		call	_ERR_put_error
		push	offset ??_C@_01GEODFPGF@?8?$AA@	; `string'
		push	edi
		push	offset ??_C@_09HNNFIOJN@service?$DN?8?$AA@ ; "service='"
		push	3
		call	_ERR_add_error_data
		add	esp, 24h
		xor	eax, eax
		pop	ebx
		pop	edi
		retn
_BIO_get_port	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_gethostbyname(char *name)
		public _BIO_gethostbyname
_BIO_gethostbyname proc	near

name		= dword	ptr  4

		push	[esp+name]	; name
		call	dword ptr ds:__imp__gethostbyname@4 ; gethostbyname(x)
		retn
_BIO_gethostbyname endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CB8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BIO_set_tcp_ndelay
_BIO_set_tcp_ndelay proc near
		mov	eax, 1
		retn
_BIO_set_tcp_ndelay endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CC0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BIO_sock_cleanup
_BIO_sock_cleanup proc near
		cmp	ds:_wsa_init_done, 0
		jz	short locret_CD9
		mov	ds:_wsa_init_done, 0
		jmp	dword ptr ds:__imp__WSACleanup@0 ; WSACleanup()
; ---------------------------------------------------------------------------

locret_CD9:				; CODE XREF: _BIO_sock_cleanup+7j
		retn
_BIO_sock_cleanup endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CDCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_sock_error(SOCKET s)
		public _BIO_sock_error
_BIO_sock_error	proc near

var_8		= dword	ptr -8
optval		= byte ptr -4
s		= dword	ptr  4

		mov	eax, 8
		call	__chkstk
		lea	eax, [esp+8+var_8]
		mov	[esp+8+var_8], 4
		push	eax		; optlen
		lea	eax, [esp+0Ch+optval]
		push	eax		; optval
		push	1007h		; optname
		push	0FFFFh		; level
		push	[esp+18h+s]	; s
		call	dword ptr ds:__imp__getsockopt@20 ; getsockopt(x,x,x,x,x)
		mov	ecx, dword ptr [esp+8+optval]
		test	eax, eax
		mov	edx, 1
		cmovs	ecx, edx
		mov	eax, ecx
		add	esp, 8
		retn
_BIO_sock_error	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D20h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BIO_sock_init
_BIO_sock_init	proc near		; CODE XREF: _BIO_get_accept_socket+2Ap
					; _BIO_get_host_ip:loc_947p
		cmp	ds:_wsa_init_done, 0
		jnz	short loc_D91
		push	190h		; Size
		push	0		; Val
		push	offset ?wsa_state@?1??BIO_sock_init@@9@9 ; Dst
		mov	ds:_wsa_init_done, 1
		call	_memset
		add	esp, 0Ch
		push	offset ?wsa_state@?1??BIO_sock_init@@9@9 ; lpWSAData
		push	202h		; wVersionRequested
		call	dword ptr ds:__imp__WSAStartup@8 ; WSAStartup(x,x)
		test	eax, eax
		jz	short loc_D91
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	1DBh
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	eax
		push	9
		push	2
		call	_ERR_put_error
		push	1DCh
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		push	7Ah ; 'z'
		push	70h ; 'p'
		push	20h ; ' '
		call	_ERR_put_error
		add	esp, 28h
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_D91:				; CODE XREF: _BIO_sock_init+7j
					; _BIO_sock_init+39j
		mov	eax, 1
		retn
_BIO_sock_init	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_socket_ioctl(SOCKET s, __int32 cmd, u_long *argp)
		public _BIO_socket_ioctl
_BIO_socket_ioctl proc near

s		= dword	ptr  4
cmd		= dword	ptr  8
argp		= dword	ptr  0Ch

		push	esi
		push	[esp+4+argp]	; argp
		push	[esp+8+cmd]	; cmd
		push	[esp+0Ch+s]	; s
		call	dword ptr ds:__imp__ioctlsocket@12 ; ioctlsocket(x,x,x)
		mov	esi, eax
		test	esi, esi
		jns	short loc_DD0
		push	233h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	5
		push	2
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, esi

loc_DD0:				; CODE XREF: _BIO_socket_ioctl+17j
		pop	esi
		retn
_BIO_socket_ioctl endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DD4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl BIO_socket_nbio(SOCKET s,	u_long argp)
		public _BIO_socket_nbio
_BIO_socket_nbio proc near

s		= dword	ptr  4
argp		= dword	ptr  8

		mov	eax, [esp+argp]
		push	esi
		mov	[esp+4+argp], eax
		lea	eax, [esp+4+argp]
		push	eax		; argp
		push	8004667Eh	; cmd
		push	[esp+0Ch+s]	; s
		call	dword ptr ds:__imp__ioctlsocket@12 ; ioctlsocket(x,x,x)
		mov	esi, eax
		test	esi, esi
		jns	short loc_E14
		push	233h
		push	offset ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ ; ".\\crypto\\bio\\b_sock.c"
		call	dword ptr ds:__imp__WSAGetLastError@0 ;	WSAGetLastError()
		push	eax
		push	5
		push	2
		call	_ERR_put_error
		add	esp, 14h

loc_E14:				; CODE XREF: _BIO_socket_nbio+21j
		xor	eax, eax
		test	esi, esi
		pop	esi
		setz	al
		retn
_BIO_socket_nbio endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E20h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_ip		proc near		; CODE XREF: _BIO_get_host_ip+13p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 14h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+14h+var_4], eax
		push	ebx
		mov	ebx, [esp+18h+arg_4]
		xor	ecx, ecx
		push	esi
		push	edi
		mov	edi, [esp+20h+arg_0]
		mov	[esp+20h+var_8], ecx
		mov	[esp+20h+var_C], ecx
		mov	[esp+20h+var_10], ecx
		mov	[esp+20h+var_14], ecx

loc_E52:				; CODE XREF: _get_ip+82j
		xor	esi, esi

loc_E54:				; CODE XREF: _get_ip+5Dj
		movsx	edx, byte ptr [edi]
		lea	edi, [edi+1]
		lea	eax, [edx-30h]
		cmp	eax, 9
		ja	short loc_E93
		mov	eax, [esp+ecx*4+20h+var_14]
		mov	esi, 1
		lea	eax, [eax+eax*4]
		lea	eax, [eax-18h]
		lea	eax, [edx+eax*2]
		mov	[esp+ecx*4+20h+var_14],	eax
		cmp	eax, 0FFh
		jbe	short loc_E54

loc_E7F:				; CODE XREF: _get_ip+7Fj _get_ip+9Bj ...
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+14h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_E93:				; CODE XREF: _get_ip+40j
		cmp	edx, 2Eh ; '.'
		jnz	short loc_EB9
		test	esi, esi
		jz	short loc_EA4
		cmp	ecx, 3
		jz	short loc_E7F
		inc	ecx
		jmp	short loc_E52
; ---------------------------------------------------------------------------

loc_EA4:				; CODE XREF: _get_ip+7Aj
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+14h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_EB9:				; CODE XREF: _get_ip+76j
		test	edx, edx
		jnz	short loc_E7F
		cmp	ecx, 3
		jnz	short loc_E7F
		test	esi, esi
		jz	short loc_E7F
		movzx	eax, byte ptr [esp+20h+var_14]
		mov	ecx, [esp+20h+var_4]
		mov	[ebx], al
		movzx	eax, byte ptr [esp+20h+var_10]
		mov	[ebx+1], al
		movzx	eax, byte ptr [esp+20h+var_C]
		mov	[ebx+2], al
		movzx	eax, byte ptr [esp+20h+var_8]
		pop	edi
		mov	[ebx+3], al
		lea	eax, [edx+1]
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 14h
		retn
_get_ip		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0EFCh
; COMDAT (pick any)
		public ??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@
; `string'
??_C@_0BG@HKLFKFMO@?4?2crypto?2bio?2b_sock?4c?$AA@ db '.\crypto\bio\b_sock.c',0
					; DATA XREF: _BIO_accept+8Bo
					; _BIO_accept+A5o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F14h
; COMDAT (pick any)
		public ??_C@_05PBGCLELH@host?$DN?$AA@
; `string'
??_C@_05PBGCLELH@host?$DN?$AA@ db 'host=',0 ; DATA XREF: _BIO_get_host_ip+FDo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F1Ch
; COMDAT (pick any)
		public ??_C@_03FPEIBLKH@tcp?$AA@
; char `string'[4]
??_C@_03FPEIBLKH@tcp?$AA@ db 'tcp',0    ; DATA XREF: _BIO_get_port+5Ao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F20h
; COMDAT (pick any)
		public ??_C@_04IAFLKNP@http?$AA@
; `string'
??_C@_04IAFLKNP@http?$AA@ db 'http',0   ; DATA XREF: _BIO_get_port+99o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F28h
; COMDAT (pick any)
		public ??_C@_06KAPJOFBF@telnet?$AA@
; `string'
??_C@_06KAPJOFBF@telnet?$AA@ db	'telnet',0 ; DATA XREF: _BIO_get_port:loc_B05o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F30h
; COMDAT (pick any)
		public ??_C@_05LBOKJHLG@socks?$AA@
; `string'
??_C@_05LBOKJHLG@socks?$AA@ db 'socks',0 ; DATA XREF: _BIO_get_port:loc_B45o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F38h
; COMDAT (pick any)
		public ??_C@_05BCHGOAMK@https?$AA@
; `string'
??_C@_05BCHGOAMK@https?$AA@ db 'https',0 ; DATA XREF: _BIO_get_port:loc_B85o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F40h
; COMDAT (pick any)
		public ??_C@_03DIMONNDD@ssl?$AA@
; `string'
??_C@_03DIMONNDD@ssl?$AA@ dd 6C7373h	; DATA XREF: _BIO_get_port+189o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F44h
; COMDAT (pick any)
		public ??_C@_03LMDBDBEG@ftp?$AA@
; `string'
??_C@_03LMDBDBEG@ftp?$AA@ dd 707466h	; DATA XREF: _BIO_get_port:loc_BF5o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F48h
; COMDAT (pick any)
		public ??_C@_06IBHFMCPJ@gopher?$AA@
; `string'
??_C@_06IBHFMCPJ@gopher?$AA@ db	'gopher',0 ; DATA XREF: _BIO_get_port:loc_C35o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F50h
; COMDAT (pick any)
		public ??_C@_01GEODFPGF@?8?$AA@
; `string'
??_C@_01GEODFPGF@?8?$AA@ db 27h, 0	; DATA XREF: _BIO_get_accept_socket+3EEo
					; _BIO_get_accept_socket+472o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F54h
; COMDAT (pick any)
		public ??_C@_09HNNFIOJN@service?$DN?8?$AA@
; `string'
??_C@_09HNNFIOJN@service?$DN?8?$AA@ db 'service=',27h,0 ; DATA XREF: _BIO_get_port+269o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F60h
; COMDAT (pick any)
		public ??_C@_0M@MBIPAJOD@getaddrinfo?$AA@
; `string'
??_C@_0M@MBIPAJOD@getaddrinfo?$AA@ db 'getaddrinfo',0
					; DATA XREF: _BIO_get_accept_socket+A2o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F6Ch
; COMDAT (pick any)
		public ??_C@_0N@EHOPPMLH@freeaddrinfo?$AA@
; `string'
??_C@_0N@EHOPPMLH@freeaddrinfo?$AA@ db 'freeaddrinfo',0
					; DATA XREF: _BIO_get_accept_socket+B8o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F7Ch
; COMDAT (pick any)
		public ??_C@_01NBENCBCI@?$CK?$AA@
; `string'
??_C@_01NBENCBCI@?$CK?$AA@ db 2Ah, 0	; DATA XREF: _BIO_get_accept_socket+131o
					; _BIO_get_accept_socket+311o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F80h
; COMDAT (pick any)
		public ??_C@_06OGGAANOH@port?$DN?8?$AA@
; `string'
??_C@_06OGGAANOH@port?$DN?8?$AA@ db 'port=',27h,0 ; DATA XREF: _BIO_get_accept_socket+3F7o
					; _BIO_get_accept_socket+47Bo ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F88h
; COMDAT (pick any)
		public ??_C@_0M@NNJNLPKG@getnameinfo?$AA@
; `string'
??_C@_0M@NNJNLPKG@getnameinfo?$AA@ db 'getnameinfo',0 ; DATA XREF: _BIO_accept+D3o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F94h
; COMDAT (pick any)
		public ??_C@_05CCMOGDN@?$CFs?3?$CFs?$AA@
; `string'
??_C@_05CCMOGDN@?$CFs?3?$CFs?$AA@ db '%s:%s',0 ; DATA XREF: _BIO_accept+20Ao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0F9Ch
; COMDAT (pick any)
		public ??_C@_0P@OGJLBNEC@?$CFd?4?$CFd?4?$CFd?4?$CFd?3?$CFd?$AA@
; `string'
??_C@_0P@OGJLBNEC@?$CFd?4?$CFd?4?$CFd?4?$CFd?3?$CFd?$AA@ db '%d.%d.%d.%d:%d',0
					; DATA XREF: _BIO_accept+238o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; int __cdecl _atoi(const char *Str)
		extrn __imp__atoi:near	; CODE XREF: _BIO_get_port+27p
					; DATA XREF: _BIO_get_port+27r
; char *__cdecl	_strchr(const char *Str, int Val)
		extrn __imp__strchr:near ; CODE	XREF: _BIO_get_accept_socket+194p
					; DATA XREF: _BIO_get_accept_socket+194r
; SOCKET __stdcall accept(SOCKET s, struct sockaddr *addr, int *addrlen)
		extrn __imp__accept@12:near ; CODE XREF: _BIO_accept+50p
					; DATA XREF: _BIO_accept+50r
; int __stdcall	bind(SOCKET s, const struct sockaddr *name, int	namelen)
		extrn __imp__bind@12:near ; CODE XREF: _BIO_get_accept_socket+2C2p
					; DATA XREF: _BIO_get_accept_socket+2C2r
; int __stdcall	closesocket(SOCKET s)
		extrn __imp__closesocket@4:near	; CODE XREF: _BIO_get_accept_socket+3A4p
					; _BIO_get_accept_socket+3B5p ...
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn __imp__connect@12:near ; CODE XREF: _BIO_get_accept_socket+395p
					; DATA XREF: _BIO_get_accept_socket+395r
; int __stdcall	ioctlsocket(SOCKET s, __int32 cmd, u_long *argp)
		extrn __imp__ioctlsocket@12:near ; CODE	XREF: _BIO_socket_ioctl+Dp
					; _BIO_socket_nbio+17p
					; DATA XREF: ...
; int __stdcall	getsockopt(SOCKET s, int level,	int optname, char *optval, int *optlen)
		extrn __imp__getsockopt@20:near	; CODE XREF: _BIO_sock_error+28p
					; DATA XREF: _BIO_sock_error+28r
; u_long __stdcall htonl(u_long	hostlong)
		extrn __imp__htonl@4:near ; CODE XREF: _BIO_get_accept_socket+253p
					; _BIO_get_accept_socket+36Ap
					; DATA XREF: ...
; u_short __stdcall htons(u_short hostshort)
		extrn __imp__htons@4:near ; CODE XREF: _BIO_get_accept_socket+116p
					; DATA XREF: _BIO_get_accept_socket+116r
; int __stdcall	listen(SOCKET s, int backlog)
		extrn __imp__listen@8:near ; CODE XREF:	_BIO_get_accept_socket+4ADp
					; DATA XREF: _BIO_get_accept_socket+4ADr
; u_long __stdcall ntohl(u_long	netlong)
		extrn __imp__ntohl@4:near ; CODE XREF: _BIO_accept+104p
					; DATA XREF: _BIO_accept+104r
; u_short __stdcall ntohs(u_short netshort)
		extrn __imp__ntohs@4:near ; CODE XREF: _BIO_accept+110p
					; _BIO_get_port+75p
					; DATA XREF: ...
; int __stdcall	setsockopt(SOCKET s, int level,	int optname, const char	*optval, int optlen)
		extrn __imp__setsockopt@20:near	; CODE XREF: _BIO_get_accept_socket+2ACp
					; DATA XREF: _BIO_get_accept_socket+2ACr
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn __imp__socket@12:near ; CODE XREF: _BIO_get_accept_socket+277p
					; _BIO_get_accept_socket+37Ep ...
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn __imp__gethostbyname@4:near ; CODE XREF: _BIO_get_host_ip+6Bp
					; _BIO_gethostbyname+4p
					; DATA XREF: ...
; struct servent *__stdcall getservbyname(const	char *name, const char *proto)
		extrn __imp__getservbyname@8:near ; CODE XREF: _BIO_get_port+60p
					; DATA XREF: _BIO_get_port+60r
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn __imp__WSAStartup@8:near ; CODE XREF: _BIO_sock_init+31p
					; DATA XREF: _BIO_sock_init+31r
; int __stdcall	WSACleanup()
		extrn __imp__WSACleanup@0:near ; DATA XREF: _BIO_sock_cleanup+13r
; int __stdcall	WSAGetLastError()
		extrn __imp__WSAGetLastError@0:near ; CODE XREF: _BIO_accept+90p
					; _BIO_get_accept_socket+2D1p ...
		extrn _CRYPTO_lock:near	; CODE XREF: _BIO_get_host_ip+62p
					; _BIO_get_host_ip+F0p	...
		extrn _CRYPTO_malloc:near ; CODE XREF: _BIO_accept+12Ep
					; _BIO_accept+1D8p
		extrn _CRYPTO_free:near	; CODE XREF: _BIO_get_accept_socket+425p
		extrn _CRYPTO_realloc:near ; CODE XREF:	_BIO_accept+1C3p
		extrn _BUF_strdup:near	; CODE XREF: _BIO_get_accept_socket+49p
		extrn _BIO_sock_should_retry:near ; CODE XREF: _BIO_accept+5Ep
		extrn _BIO_snprintf:near ; CODE	XREF: _BIO_accept+211p
					; _BIO_accept+241p
		extrn _ERR_put_error:near ; CODE XREF: _BIO_accept+9Bp
					; _BIO_accept+B0p ...
		extrn _ERR_add_error_data:near ; CODE XREF: _BIO_get_accept_socket+3FEp
					; _BIO_get_accept_socket+482p ...
		extrn _DSO_global_lookup:near ;	CODE XREF: _BIO_accept+D8p
					; _BIO_get_accept_socket+A7p ...
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _BIO_accept+7Ap
					; _BIO_accept+258p ...
		extrn __chkstk:near	; CODE XREF: _BIO_accept+5p
					; _BIO_get_accept_socket+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _BIO_get_accept_socket+1FFp
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _BIO_sock_init+1Fp
		extrn ___security_cookie:near ;	DATA XREF: _BIO_accept+Ar
					; _BIO_get_accept_socket+Ar ...


		end
