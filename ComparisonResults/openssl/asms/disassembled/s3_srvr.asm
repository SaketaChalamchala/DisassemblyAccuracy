;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	441826739A931BE9D50728F6EDED2B69
; Input	CRC32 :	3F1492B5

; File Name   :	C:\compspace\Diff\openssl\obj\s3_srvr.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_accept
_ssl3_accept	proc near		; DATA XREF: _ssl3_accept+9FBo
					; .rdata:00000C4Co

var_20		= qword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 10h
		call	__chkstk
		push	ebx
		push	edi
		push	0		; Time
		call	dword ptr ds:__imp___time64
		mov	[esp+1Ch+var_8], eax
		add	esp, 4
		xor	eax, eax
		mov	[esp+18h+var_10], eax
		mov	eax, 8
		call	__chkstk
		xorps	xmm0, xmm0
		lea	eax, [esp+20h+var_8]
		movsd	[esp+20h+var_20], xmm0
		push	4
		push	eax
		call	_RAND_add
		add	esp, 10h
		call	_ERR_clear_error
		push	0		; dwErrCode
		call	dword ptr ds:__imp__SetLastError@4 ; SetLastError(x)
		mov	edi, [esp+18h+arg_0]
		mov	ebx, [edi+0D0h]
		mov	[esp+18h+arg_0], ebx
		test	ebx, ebx
		jnz	short loc_76
		mov	eax, [edi+0E4h]
		mov	eax, [eax+9Ch]
		test	eax, eax
		cmovnz	ebx, eax
		mov	[esp+18h+arg_0], ebx

loc_76:					; CODE XREF: _ssl3_accept+5Fj
		inc	dword ptr [edi+1Ch]
		push	edi
		call	_SSL_state
		add	esp, 4
		test	eax, 3000h
		jz	short loc_99
		push	edi
		call	_SSL_state
		add	esp, 4
		test	eax, 4000h
		jz	short loc_A2

loc_99:					; CODE XREF: _ssl3_accept+87j
		push	edi
		call	_SSL_clear
		add	esp, 4

loc_A2:					; CODE XREF: _ssl3_accept+97j
		cmp	dword ptr [edi+98h], 0
		jnz	short loc_D2
		push	0EBh ; 'ë'
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0B3h ; '³'
		push	80h ; '€'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_D2:					; CODE XREF: _ssl3_accept+A9j
		cmp	dword ptr [edi+188h], 0
		jz	short loc_EB
		inc	dword ptr [edi+18Ch]
		mov	dword ptr [edi+188h], 0

loc_EB:					; CODE XREF: _ssl3_accept+D9j
		push	esi
		xor	ecx, ecx
		push	ebp

loc_EF:					; CODE XREF: _ssl3_accept+994j
					; _ssl3_accept+9A3j
		mov	ebp, [edi+34h]
		mov	esi, 200h
		mov	eax, ebp
		mov	[esp+20h+var_4], ebp
		cmp	eax, 2100h
		jg	short loc_17E
		jz	short loc_146
		sub	eax, 3
		jz	loc_9A8
		sub	eax, 1FFDh
		jz	loc_844
		sub	eax, 3
		jz	loc_844

$LN160:					; CODE XREF: _ssl3_accept+19Ej
					; _ssl3_accept+1A7j ...
		push	35Ch		; jumptable 000001A7 default case
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0FFh
		push	80h ; '€'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_A9A
; ---------------------------------------------------------------------------

loc_146:				; CODE XREF: _ssl3_accept+104j
		push	0
		push	0
		push	0Bh
		push	dword ptr [edi+10h]
		mov	dword ptr [edi+18h], 2
		call	_BIO_ctrl
		add	esp, 10h
		test	eax, eax
		jle	loc_A9A
		mov	eax, [edi+58h]
		mov	dword ptr [edi+18h], 1
		mov	eax, [eax+350h]
		mov	[edi+34h], eax
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_17E:				; CODE XREF: _ssl3_accept+102j
		cmp	eax, 2211h
		jg	loc_81F
		cmp	eax, 2210h
		jge	loc_7E7
		sub	eax, 2110h	; switch 242 cases
		cmp	eax, 0F1h ; 'ñ'
		ja	short $LN160	; jumptable 000001A7 default case
		movzx	eax, ds:$LN180[eax]
		jmp	ds:$LN193[eax*4] ; switch jump
; ---------------------------------------------------------------------------

$LN30:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8480,8481
		mov	dword ptr [edi+30h], 0
		call	_ssl3_send_hello_request
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	eax, [edi+58h]
		push	edi
		mov	dword ptr [eax+350h], 2122h
		mov	dword ptr [edi+34h], 2100h
		mov	dword ptr [edi+44h], 0
		call	_ssl3_init_finished_mac
		add	esp, 4
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN32:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	dword ptr [edi+34h], 3 ; jumptable 000001A7 case 8482
		jmp	loc_93B
; ---------------------------------------------------------------------------

$LN33:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8464-8466
		mov	dword ptr [edi+30h], 0
		call	_ssl3_get_client_hello
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	dword ptr [edi+34h], 2115h

$LN35:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		lea	eax, [esp+20h+var_C] ; jumptable 000001A7 case 8469
		push	eax
		push	edi
		call	_ssl_check_srp_ext_ClientHello
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		js	loc_A50
		jnz	loc_A1A
		mov	dword ptr [edi+190h], 2
		mov	dword ptr [edi+34h], 2130h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN39:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8496,8497
		call	_ssl3_send_server_hello
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		cmp	dword ptr [edi+6Ch], 0
		jz	short loc_295
		cmp	dword ptr [edi+140h], 0
		mov	eax, 21D0h
		mov	ecx, 21F0h
		mov	dword ptr [edi+44h], 0
		cmovnz	eax, ecx
		mov	[edi+34h], eax
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_295:				; CODE XREF: _ssl3_accept+270j
		mov	dword ptr [edi+34h], 2140h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN45:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	eax, [edi+58h]	; jumptable 000001A7 cases 8512,8513
		mov	eax, [eax+344h]
		test	dword ptr [eax+10h], 424h
		jnz	short loc_2F9
		test	dword ptr [eax+0Ch], 100h
		jnz	short loc_2F9
		push	edi
		call	_ssl3_send_server_certificate
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		cmp	dword ptr [edi+12Ch], 0
		mov	eax, 2150h
		mov	ecx, 2200h
		mov	dword ptr [edi+44h], 0
		cmovnz	eax, ecx
		mov	[edi+34h], eax
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_2F9:				; CODE XREF: _ssl3_accept+2B8j
					; _ssl3_accept+2C1j
					; DATA XREF: ...
		mov	[esp+20h+var_10], 1
		mov	dword ptr [edi+34h], 2150h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN51:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	ecx, [edi+58h]	; jumptable 000001A7 cases 8528,8529
		mov	eax, [ecx+344h]
		mov	edx, [eax+0Ch]
		mov	dword ptr [ecx+370h], 0
		test	edx, 100h
		jz	short loc_341
		mov	eax, [edi+0E4h]
		cmp	dword ptr [eax+14Ch], 0
		jnz	short loc_3AA

loc_341:				; CODE XREF: _ssl3_accept+330j
		test	edx, 488h
		jnz	short loc_3AA
		test	dl, 1
		jz	short loc_38F
		mov	eax, [edi+98h]
		mov	ecx, [eax+40h]
		test	ecx, ecx
		jz	short loc_3AA
		mov	eax, [edi+58h]
		mov	eax, [eax+344h]
		test	byte ptr [eax+20h], 2
		jz	short loc_38F
		push	ecx
		call	_EVP_PKEY_size
		mov	ecx, [edi+58h]
		add	esp, 4
		shl	eax, 3
		mov	ecx, [ecx+344h]
		test	byte ptr [ecx+20h], 8
		mov	ecx, 400h
		cmovnz	ecx, esi
		cmp	eax, ecx
		jg	short loc_3AA

loc_38F:				; CODE XREF: _ssl3_accept+34Cj
					; _ssl3_accept+368j
		mov	[esp+20h+var_10], 1
		mov	dword ptr [edi+34h], 2160h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_3AA:				; CODE XREF: _ssl3_accept+33Fj
					; _ssl3_accept+347j ...
		push	edi
		call	_ssl3_send_server_key_exchange
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	dword ptr [edi+34h], 2160h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN58:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	ecx, [edi+0C8h]	; jumptable 000001A7 cases 8544,8545
		test	cl, 1
		jz	short loc_451
		mov	eax, [edi+0C0h]
		cmp	dword ptr [eax+9Ch], 0
		jz	short loc_3EF
		test	cl, 4
		jnz	short loc_451

loc_3EF:				; CODE XREF: _ssl3_accept+3E8j
		mov	esi, [edi+58h]
		mov	edx, [esi+344h]
		mov	eax, [edx+10h]
		test	al, 4
		jz	short loc_404
		test	cl, 2
		jz	short loc_451

loc_404:				; CODE XREF: _ssl3_accept+3FDj
		test	eax, 420h
		jnz	short loc_451
		test	dword ptr [edx+0Ch], 100h
		jnz	short loc_451
		push	edi
		mov	dword ptr [esi+390h], 1
		call	_ssl3_send_certificate_request
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	eax, [edi+58h]
		mov	dword ptr [edi+34h], 2100h
		mov	dword ptr [eax+350h], 2180h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_451:				; CODE XREF: _ssl3_accept+3D9j
					; _ssl3_accept+3EDj ...
		mov	eax, [edi+58h]
		mov	ecx, 1
		mov	[esp+20h+var_10], ecx
		mov	dword ptr [eax+390h], 0
		mov	eax, [edi+58h]
		mov	dword ptr [edi+34h], 2170h
		cmp	dword ptr [eax+178h], 0
		jz	loc_93B

loc_47E:				; CODE XREF: _ssl3_accept+577j
		push	edi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	loc_AD9
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN67:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8560,8561
		call	_ssl3_send_server_done
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	eax, [edi+58h]
		mov	dword ptr [eax+350h], 2180h
		mov	dword ptr [edi+34h], 2100h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN71:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	eax, [edi+58h]	; jumptable 000001A7 cases 8576,8577
		cmp	dword ptr [eax+390h], 0
		jz	short loc_4E6
		push	edi
		call	_ssl3_get_client_certificate
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194

loc_4E6:				; CODE XREF: _ssl3_accept+4D1j
		mov	dword ptr [edi+44h], 0
		mov	dword ptr [edi+34h], 2190h
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN74:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8592,8593
		call	_ssl3_get_client_key_exchange
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		cmp	esi, 2
		jnz	short loc_537
		mov	eax, [edi+58h]
		mov	ecx, 21C0h
		cmp	dword ptr [eax+41Ch], 0
		mov	eax, 2210h
		mov	dword ptr [edi+44h], 0
		cmovnz	ecx, eax
		mov	[edi+34h], ecx
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_537:				; CODE XREF: _ssl3_accept+50Fj
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		mov	dword ptr [edi+34h], 21A0h
		jz	short loc_57C
		mov	eax, [edi+0C0h]
		mov	dword ptr [edi+44h], 0
		cmp	dword ptr [eax+9Ch], 0
		jz	loc_937
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+178h], 0
		jz	loc_A59
		or	dword ptr [eax], 20h
		jmp	loc_47E
; ---------------------------------------------------------------------------

loc_57C:				; CODE XREF: _ssl3_accept+548j
		mov	eax, [edi+58h]
		xor	ebp, ebp
		mov	[edi+44h], ebp
		cmp	[eax+178h], ebp
		jz	short loc_59D
		push	edi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	loc_AD9

loc_59D:				; CODE XREF: _ssl3_accept+58Aj
		xor	ebx, ebx
		nop

loc_5A0:				; CODE XREF: _ssl3_accept+5FFj
		mov	ecx, [edi+58h]
		mov	eax, [ecx+17Ch]
		mov	edx, [ebx+eax]
		test	edx, edx
		jz	short loc_5F9
		mov	eax, [edi+8]
		mov	esi, [eax+64h]
		lea	eax, [ecx+1B4h]
		add	eax, ebp
		push	eax
		push	edx
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_type
		add	esp, 8
		push	eax
		mov	eax, [esi+1Ch]
		push	edi
		call	eax
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		push	dword ptr [eax+ebx]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		add	esp, 14h
		test	eax, eax
		js	loc_A93
		add	ebp, eax

loc_5F9:				; CODE XREF: _ssl3_accept+5AEj
		add	ebx, 4
		cmp	ebx, 18h
		jl	short loc_5A0
		mov	ebp, [esp+20h+var_4]
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN89:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8608,8609
		call	_ssl3_get_cert_verify
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	eax, [edi+58h]
		mov	ecx, 21C0h
		cmp	dword ptr [eax+41Ch], 0
		mov	eax, 2210h
		mov	dword ptr [edi+44h], 0
		cmovnz	ecx, eax
		mov	[edi+34h], ecx
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN96:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	eax, [edi+58h]	; jumptable 000001A7 cases 8640,8641
		cmp	dword ptr [eax+180h], 0
		jnz	short loc_655
		or	dword ptr [eax], 80h

loc_655:				; CODE XREF: _ssl3_accept+64Dj
		push	21C1h
		push	21C0h
		push	edi
		call	_ssl3_get_finished
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jle	$end$194
		cmp	dword ptr [edi+6Ch], 0
		jz	short loc_68B
		mov	dword ptr [edi+34h], 3
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_68B:				; CODE XREF: _ssl3_accept+676j
		cmp	dword ptr [edi+140h], 0
		mov	eax, 21D0h
		mov	ecx, 21F0h
		mov	dword ptr [edi+44h], 0
		cmovnz	eax, ecx
		mov	[edi+34h], eax
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN103:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8688,8689
		call	_ssl3_send_newsession_ticket
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	dword ptr [edi+34h], 21D0h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN105:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		push	edi		; jumptable 000001A7 cases 8704,8705
		call	_ssl3_send_cert_status
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	dword ptr [edi+34h], 2150h
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN107:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	eax, [edi+58h]	; jumptable 000001A7 cases 8656,8657
		mov	ecx, [edi+0C0h]
		push	edi
		mov	eax, [eax+344h]
		mov	[ecx+0B4h], eax
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		mov	eax, [eax+8]
		call	eax
		add	esp, 4
		test	eax, eax
		jz	loc_A93
		push	21D1h
		push	21D0h
		push	edi
		call	_ssl3_send_change_cipher_spec
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jle	$end$194
		mov	eax, [edi+8]
		mov	dword ptr [edi+34h], 21E0h
		mov	dword ptr [edi+44h], 0
		push	22h ; '"'
		mov	eax, [eax+64h]
		push	edi
		mov	eax, [eax+10h]
		call	eax
		add	esp, 8
		test	eax, eax
		jz	loc_A93
		jmp	loc_937
; ---------------------------------------------------------------------------

$LN111:					; CODE XREF: _ssl3_accept+1A7j
					; DATA XREF: .text$mn:$LN193o
		mov	eax, [edi+8]	; jumptable 000001A7 cases 8672,8673
		mov	eax, [eax+64h]
		push	dword ptr [eax+2Ch]
		push	dword ptr [eax+28h]
		push	21E1h
		push	21E0h
		push	edi
		call	_ssl3_send_finished
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jle	$end$194
		cmp	dword ptr [edi+6Ch], 0
		mov	dword ptr [edi+34h], 2100h
		jz	short loc_7CE
		mov	ecx, [edi+58h]
		mov	eax, 21C0h
		mov	edx, 2210h
		cmp	dword ptr [ecx+41Ch], 0
		cmovnz	eax, edx
		mov	[ecx+350h], eax
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_7CE:				; CODE XREF: _ssl3_accept+7A3j
		mov	eax, [edi+58h]
		mov	dword ptr [eax+350h], 3
		mov	dword ptr [edi+44h], 0
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_7E7:				; CODE XREF: _ssl3_accept+18Ej
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+180h], 0
		jnz	short loc_7F9
		or	dword ptr [eax], 80h

loc_7F9:				; CODE XREF: _ssl3_accept+7F1j
		push	edi
		call	_ssl3_get_next_proto
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jle	$end$194
		mov	dword ptr [edi+44h], 0
		mov	dword ptr [edi+34h], 21C0h
		jmp	loc_937
; ---------------------------------------------------------------------------

loc_81F:				; CODE XREF: _ssl3_accept+183j
		cmp	eax, 3004h
		jz	short loc_83A
		cmp	eax, 4000h
		jz	short loc_844
		cmp	eax, 6000h
		jnz	$LN160		; jumptable 000001A7 default case
		jmp	short loc_844
; ---------------------------------------------------------------------------

loc_83A:				; CODE XREF: _ssl3_accept+824j
		mov	dword ptr [edi+190h], 1

loc_844:				; CODE XREF: _ssl3_accept+114j
					; _ssl3_accept+11Dj ...
		mov	dword ptr [edi+24h], 1
		test	ebx, ebx
		jz	short loc_859
		push	1
		push	10h
		push	edi
		call	ebx
		add	esp, 0Ch

loc_859:				; CODE XREF: _ssl3_accept+84Dj
		mov	eax, [edi]
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		jnz	loc_ABE
		cmp	dword ptr [edi+3Ch], 0
		mov	dword ptr [edi+4], 2000h
		jnz	short loc_8A0
		call	_BUF_MEM_new
		mov	esi, eax
		test	esi, esi
		jz	loc_A93
		push	4000h
		push	esi
		call	_BUF_MEM_grow
		add	esp, 8
		test	eax, eax
		jz	loc_A60
		mov	[edi+3Ch], esi

loc_8A0:				; CODE XREF: _ssl3_accept+876j
		push	edi
		call	_ssl3_setup_buffers
		add	esp, 4
		test	eax, eax
		jz	loc_A93
		mov	eax, [edi+58h]
		mov	dword ptr [edi+44h], 0
		and	dword ptr [eax], 0FFFFFFEFh
		mov	eax, [edi+58h]
		and	dword ptr [eax], 0FFFFFF7Fh
		mov	eax, [edi+58h]
		mov	dword ptr [eax+180h], 0
		cmp	dword ptr [edi+34h], 3004h
		jz	short loc_90B
		push	1
		push	edi
		call	_ssl_init_wbio_buffer
		add	esp, 8
		test	eax, eax
		jz	loc_A93
		push	edi
		call	_ssl3_init_finished_mac
		mov	eax, [edi+0E4h]
		add	esp, 4
		mov	dword ptr [edi+34h], 2110h
		inc	dword ptr [eax+40h]
		jmp	short loc_937
; ---------------------------------------------------------------------------

loc_90B:				; CODE XREF: _ssl3_accept+8DBj
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+418h], 0
		jnz	short loc_927
		test	dword ptr [edi+100h], 40000h
		jz	loc_A6B

loc_927:				; CODE XREF: _ssl3_accept+915j
		mov	eax, [edi+0E4h]
		inc	dword ptr [eax+44h]
		mov	dword ptr [edi+34h], 2120h

loc_937:				; CODE XREF: _ssl3_accept+179j
					; _ssl3_accept+1ECj ...
		mov	ecx, [esp+20h+var_10]

loc_93B:				; CODE XREF: _ssl3_accept+1F8j
					; _ssl3_accept+478j
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+354h], 0
		jnz	short loc_999
		test	ecx, ecx
		jnz	short loc_999
		cmp	[edi+0E8h], ecx
		jz	short loc_96C
		push	ecx
		push	ecx
		push	0Bh
		push	dword ptr [edi+10h]
		call	_BIO_ctrl
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jle	$end$194

loc_96C:				; CODE XREF: _ssl3_accept+951j
		mov	ebx, [esp+20h+arg_0]
		test	ebx, ebx
		jz	short loc_99D
		mov	esi, [edi+34h]
		cmp	esi, ebp
		jz	short loc_99D
		push	1
		push	2001h
		push	edi
		mov	[edi+34h], ebp
		call	ebx
		add	esp, 0Ch
		mov	[edi+34h], esi
		xor	ecx, ecx
		mov	[esp+20h+var_10], ecx
		jmp	loc_EF
; ---------------------------------------------------------------------------

loc_999:				; CODE XREF: _ssl3_accept+945j
					; _ssl3_accept+949j
		mov	ebx, [esp+20h+arg_0]

loc_99D:				; CODE XREF: _ssl3_accept+972j
					; _ssl3_accept+979j
		xor	ecx, ecx
		mov	[esp+20h+var_10], ecx
		jmp	loc_EF
; ---------------------------------------------------------------------------

loc_9A8:				; CODE XREF: _ssl3_accept+109j
		push	edi
		call	_ssl3_cleanup_key_block
		push	dword ptr [edi+3Ch]
		call	_BUF_MEM_free
		push	edi
		mov	dword ptr [edi+3Ch], 0
		call	_ssl_free_wbio_buffer
		add	esp, 0Ch
		mov	dword ptr [edi+44h], 0
		cmp	dword ptr [edi+190h], 2
		jnz	short loc_A10
		push	2
		push	edi
		mov	dword ptr [edi+190h], 0
		mov	dword ptr [edi+28h], 0
		call	_ssl_update_cache
		mov	eax, [edi+0E4h]
		add	esp, 8
		inc	dword ptr [eax+48h]
		mov	dword ptr [edi+20h], offset _ssl3_accept
		test	ebx, ebx
		jz	short loc_A10
		push	1
		push	20h ; ' '
		push	edi
		call	ebx
		add	esp, 0Ch

loc_A10:				; CODE XREF: _ssl3_accept+9D4j
					; _ssl3_accept+A04j
		mov	esi, 1
		jmp	$end$194
; ---------------------------------------------------------------------------

loc_A1A:				; CODE XREF: _ssl3_accept+236j
		push	[esp+20h+var_C]
		push	2
		push	edi
		call	_ssl3_send_alert
		add	esp, 0Ch
		cmp	[esp+20h+var_C], 73h ; 's'
		jz	short loc_A93
		push	181h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0E2h ; 'â'
		push	80h ; '€'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_A93
; ---------------------------------------------------------------------------

loc_A50:				; CODE XREF: _ssl3_accept+230j
		mov	dword ptr [edi+18h], 4
		jmp	short $end$194
; ---------------------------------------------------------------------------

loc_A59:				; CODE XREF: _ssl3_accept+56Ej
		push	278h
		jmp	short loc_AC3
; ---------------------------------------------------------------------------

loc_A60:				; CODE XREF: _ssl3_accept+897j
		push	esi
		call	_BUF_MEM_free
		add	esp, 4
		jmp	short loc_A93
; ---------------------------------------------------------------------------

loc_A6B:				; CODE XREF: _ssl3_accept+921j
		push	145h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	152h
		push	80h ; '€'
		push	14h
		call	_ERR_put_error
		push	28h ; '('
		push	2
		push	edi
		call	_ssl3_send_alert
		add	esp, 20h

loc_A93:				; CODE XREF: _ssl3_accept+5F1j
					; _ssl3_accept+720j ...
		mov	dword ptr [edi+34h], 5

loc_A9A:				; CODE XREF: _ssl3_accept+141j
					; _ssl3_accept+160j
		or	esi, 0FFFFFFFFh

$end$194:				; CODE XREF: _ssl3_accept+1C2j
					; _ssl3_accept+211j ...
		dec	dword ptr [edi+1Ch]
		mov	eax, [esp+20h+arg_0]
		test	eax, eax
		jz	short loc_AB4
		push	esi
		push	2002h
		push	edi
		call	eax
		add	esp, 0Ch

loc_AB4:				; CODE XREF: _ssl3_accept+AA6j
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_ABE:				; CODE XREF: _ssl3_accept+865j
		push	10Ch

loc_AC3:				; CODE XREF: _ssl3_accept+A5Ej
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	80h ; '€'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_AD9:				; CODE XREF: _ssl3_accept+489j
					; _ssl3_accept+597j
		pop	ebp
		pop	esi
		mov	dword ptr [edi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebx
		add	esp, 10h
		retn
_ssl3_accept	endp

; ---------------------------------------------------------------------------
		align 4
$LN193		dd offset $LN33, offset	$LN35, offset $LN30, offset $LN32
					; DATA XREF: _ssl3_accept+1A7r
		dd offset $LN39, offset	$LN45, offset $LN51, offset $LN58 ; jump table for switch statement
		dd offset $LN67, offset	$LN71, offset $LN74, offset $LN89
		dd offset $LN96, offset	$LN107,	offset $LN111, offset $LN103
		dd offset $LN105, offset $LN160
$LN180		db 0, 0, 0, 11h, 11h, 1, 11h, 11h, 11h,	11h, 11h, 11h
					; DATA XREF: _ssl3_accept+1A0r
		db 11h,	11h, 11h, 11h, 2, 2, 3,	11h, 11h, 11h, 11h, 11h	; indirect table for switch statement
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 4, 4, 11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	5, 5, 11h, 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 6, 6, 11h, 11h, 11h, 11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	7, 7, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 8,	8, 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 9, 9, 11h, 11h, 11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 0Ah
		db 0Ah,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 11h, 0Bh, 0Bh, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 0Ch, 0Ch, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 0Dh,	0Dh, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 0Eh, 0Eh, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 0Fh, 0Fh,	11h, 11h
		db 11h,	11h, 11h, 11h, 11h, 11h, 11h, 11h, 11h,	11h, 11h
		db 11h,	10h, 10h
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0C28h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl3_get_server_method	proc near	; DATA XREF: .rdata:00000C98o

arg_0		= dword	ptr  4

		xor	ecx, ecx
		mov	eax, offset ?SSLv3_server_method_data@?1??SSLv3_server_method@@9@9 ; `SSLv3_server_method'::`2'::SSLv3_server_method_data
		cmp	[esp+arg_0], 300h
		cmovnz	eax, ecx
		retn
_ssl3_get_server_method	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 0C3Ch
; `SSLv3_server_method'::`2'::SSLv3_server_method_data
?SSLv3_server_method_data@?1??SSLv3_server_method@@9@9 dd offset loc_2F9+7
					; DATA XREF: _ssl3_get_server_method+2o
					; _SSLv3_server_methodo
		dd offset _ssl3_new
		dd offset _ssl3_clear
		dd offset _ssl3_free
		dd offset _ssl3_accept
		dd offset _ssl_undefined_function
		dd offset _ssl3_read
		dd offset _ssl3_peek
		dd offset _ssl3_write
		dd offset _ssl3_shutdown
		dd offset _ssl3_renegotiate
		dd offset _ssl3_renegotiate_check
		dd offset _ssl3_get_message
		dd offset _ssl3_read_bytes
		dd offset _ssl3_write_bytes
		dd offset _ssl3_dispatch_alert
		dd offset _ssl3_ctrl
		dd offset _ssl3_ctx_ctrl
		dd offset _ssl3_get_cipher_by_char
		dd offset _ssl3_put_cipher_by_char
		dd offset _ssl3_pending
		dd offset _ssl3_num_ciphers
		dd offset _ssl3_get_cipher
		dd offset _ssl3_get_server_method
		dd offset _ssl3_default_timeout
		dd offset _SSLv3_enc_data
		dd offset _ssl_undefined_void_function
		dd offset _ssl3_callback_ctrl
		dd offset _ssl3_ctx_callback_ctrl
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CB0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSLv3_server_method
_SSLv3_server_method proc near
		mov	eax, offset ?SSLv3_server_method_data@?1??SSLv3_server_method@@9@9 ; `SSLv3_server_method'::`2'::SSLv3_server_method_data
		retn
_SSLv3_server_method endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CB8h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; _fprintf+Fp
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CC0h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CE4h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_eq proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	ecx, [esp+arg_4]
		lea	eax, [ecx-1]
		not	ecx
		shr	eax, 1Fh
		shr	ecx, 1Fh
		and	eax, ecx
		neg	eax
		retn
_constant_time_eq endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CFCh
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_eq_8 proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	ecx, [esp+arg_4]
		lea	eax, [ecx-1]
		not	ecx
		shr	eax, 1Fh
		shr	ecx, 1Fh
		and	eax, ecx
		neg	eax
		retn
_constant_time_eq_8 endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D14h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_eq_int_8	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	ecx, [esp+arg_4]
		lea	eax, [ecx-1]
		not	ecx
		shr	eax, 1Fh
		shr	ecx, 1Fh
		and	eax, ecx
		neg	eax
		retn
_constant_time_eq_int_8	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D2Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_is_zero proc near

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		lea	eax, [ecx-1]
		not	ecx
		shr	eax, 1Fh
		shr	ecx, 1Fh
		and	eax, ecx
		neg	eax
		retn
_constant_time_is_zero endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D40h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_msb proc	near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		shr	eax, 1Fh
		neg	eax
		retn
_constant_time_msb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D4Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_select proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		and	ecx, [esp+arg_4]
		not	eax
		and	eax, [esp+arg_8]
		or	eax, ecx
		retn
_constant_time_select endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D60h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_constant_time_select_8	proc near

arg_0		= byte ptr  4
arg_4		= byte ptr  8
arg_8		= byte ptr  0Ch

		movzx	edx, [esp+arg_0]
		movzx	ecx, [esp+arg_8]
		mov	eax, edx
		not	eax
		and	eax, ecx
		movzx	ecx, [esp+arg_4]
		and	ecx, edx
		or	eax, ecx
		retn
_constant_time_select_8	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D7Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _ssl3_get_cert_verify+409p

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DA0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_cert_verify
_ssl3_get_cert_verify proc near		; CODE XREF: _ssl3_accept+60Bp

var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 6Ch ; 'l'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+78h+arg_0]
		lea	eax, [esp+78h+var_5C]
		xor	ebp, ebp
		push	eax
		mov	[esp+7Ch+var_68], ebp
		call	_EVP_MD_CTX_init
		mov	eax, [edi+0C0h]
		add	esp, 4
		cmp	[eax+9Ch], ebp
		jnz	short loc_DE5
		lea	ebx, [ebp+1]
		jmp	$end$57
; ---------------------------------------------------------------------------

loc_DE5:				; CODE XREF: _ssl3_get_cert_verify+3Bj
		mov	eax, [edi+8]
		lea	ecx, [esp+78h+var_64]
		push	ecx
		push	4000h
		push	0Fh
		mov	eax, [eax+30h]
		push	21A1h
		push	21A0h
		push	edi
		call	eax
		add	esp, 18h
		mov	ebp, eax
		cmp	[esp+78h+var_64], 0
		jz	loc_127D
		mov	eax, [edi+0C0h]
		push	esi
		mov	esi, [eax+9Ch]
		push	esi
		call	_X509_get_pubkey
		mov	ebx, eax
		push	ebx
		push	esi
		mov	[esp+88h+var_6C], ebx
		call	_X509_certificate_type
		add	esp, 0Ch
		test	al, 10h
		jnz	short loc_E62
		push	0BAFh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0DCh ; 'Ü'
		push	88h ; 'ˆ'
		push	14h
		call	_ERR_put_error
		mov	esi, 2Fh ; '/'
		mov	ebp, ebx
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_E62:				; CODE XREF: _ssl3_get_cert_verify+99j
		mov	esi, [edi+40h]
		cmp	ebp, 40h ; '@'
		jnz	loc_EFD
		mov	eax, [ebx]
		cmp	eax, 32Ch
		jz	short loc_E7E
		cmp	eax, 32Bh
		jnz	short loc_EFD

loc_E7E:				; CODE XREF: _ssl3_get_cert_verify+D5j
		mov	ebx, 40h ; '@'

loc_E83:				; CODE XREF: _ssl3_get_cert_verify+1B0j
		push	[esp+7Ch+var_6C]
		call	_EVP_PKEY_size
		add	esp, 4
		cmp	ebx, eax
		jg	loc_1202
		cmp	ebp, eax
		jg	loc_1202
		test	ebp, ebp
		jle	loc_1202
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	loc_FE6
		lea	eax, [esp+7Ch+var_60]
		push	eax
		mov	eax, [edi+58h]
		push	0
		push	3
		push	dword ptr [eax+178h]
		call	_BIO_ctrl
		mov	ebp, eax
		add	esp, 10h
		test	ebp, ebp
		jg	loc_F6A
		push	0BE2h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'

loc_EE7:				; CODE XREF: _ssl3_get_cert_verify+241j
		push	88h ; 'ˆ'
		push	14h
		call	_ERR_put_error
		mov	esi, 50h ; 'P'
		jmp	loc_1222
; ---------------------------------------------------------------------------

loc_EFD:				; CODE XREF: _ssl3_get_cert_verify+C8j
					; _ssl3_get_cert_verify+DCj
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	short loc_F3C
		push	ebx
		push	esi
		lea	eax, [esp+84h+var_68]
		push	edi
		push	eax
		call	_tls12_check_peer_sigalg
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_F28
		lea	esi, [eax+51h]
		mov	ebp, ebx
		jmp	$f_err$58
; ---------------------------------------------------------------------------

loc_F28:				; CODE XREF: _ssl3_get_cert_verify+17Cj
		test	eax, eax
		jnz	short loc_F36
		lea	esi, [eax+32h]
		mov	ebp, ebx
		jmp	$f_err$58
; ---------------------------------------------------------------------------

loc_F36:				; CODE XREF: _ssl3_get_cert_verify+18Aj
		add	esi, 2
		sub	ebp, 2

loc_F3C:				; CODE XREF: _ssl3_get_cert_verify+167j
		movzx	ebx, byte ptr [esi]
		sub	ebp, 2
		movzx	eax, byte ptr [esi+1]
		add	esi, 2
		shl	ebx, 8
		or	ebx, eax
		cmp	ebx, ebp
		jle	loc_E83
		push	0BD1h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	9Fh ; 'Ÿ'
		jmp	loc_1211
; ---------------------------------------------------------------------------

loc_F6A:				; CODE XREF: _ssl3_get_cert_verify+135j
		push	0
		push	[esp+80h+var_68]
		lea	eax, [esp+84h+var_5C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_FD5
		push	ebp
		push	[esp+80h+var_60]
		lea	eax, [esp+84h+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_FD5
		mov	ebp, [esp+7Ch+var_6C]
		lea	eax, [esp+7Ch+var_5C]
		push	ebp
		push	ebx
		push	esi
		push	eax
		call	_EVP_VerifyFinal
		add	esp, 10h
		test	eax, eax
		jg	loc_11FB
		push	0BF3h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	7Bh ; '{'
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 33h ; '3'
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_FD5:				; CODE XREF: _ssl3_get_cert_verify+1DFj
					; _ssl3_get_cert_verify+1F5j
		push	0BECh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	6
		jmp	loc_EE7
; ---------------------------------------------------------------------------

loc_FE6:				; CODE XREF: _ssl3_get_cert_verify+111j
		mov	ebp, [esp+7Ch+var_6C]
		mov	eax, [ebp+0]
		cmp	eax, 6
		jnz	short loc_105A
		push	dword ptr [ebp+14h]
		mov	eax, [edi+58h]
		push	ebx
		push	esi
		push	24h ; '$'
		add	eax, 1B4h
		push	eax
		push	72h ; 'r'
		call	_RSA_verify
		add	esp, 18h
		test	eax, eax
		jns	short loc_1032
		push	0BFEh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	76h ; 'v'
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 33h ; '3'
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_1032:				; CODE XREF: _ssl3_get_cert_verify+26Ej
		jnz	loc_11FB
		push	0C03h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	7Ah ; 'z'
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 33h ; '3'
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_105A:				; CODE XREF: _ssl3_get_cert_verify+250j
		cmp	eax, 74h ; 't'
		jnz	short loc_10A4
		push	dword ptr [ebp+14h]
		mov	eax, [edi+58h]
		push	ebx
		push	esi
		push	14h
		add	eax, 1C4h
		push	eax
		push	dword ptr [ebp+4]
		call	_DSA_verify
		add	esp, 18h
		test	eax, eax
		jg	loc_11FB
		push	0C10h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	70h ; 'p'
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 33h ; '3'
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_10A4:				; CODE XREF: _ssl3_get_cert_verify+2BDj
		cmp	eax, 198h
		jnz	short loc_10F3
		push	dword ptr [ebp+14h]
		mov	eax, [edi+58h]
		push	ebx
		push	esi
		push	14h
		add	eax, 1C4h
		push	eax
		push	dword ptr [ebp+4]
		call	_ECDSA_verify
		add	esp, 18h
		test	eax, eax
		jg	loc_11FB
		push	0C1Dh

loc_10D3:				; CODE XREF: _ssl3_get_cert_verify+456j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	131h
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 33h ; '3'
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_10F3:				; CODE XREF: _ssl3_get_cert_verify+309j
		cmp	eax, 32Ch
		jz	short loc_1123
		cmp	eax, 32Bh
		jz	short loc_1123
		push	0C41h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	88h ; 'ˆ'
		push	14h
		call	_ERR_put_error
		mov	esi, 2Bh ; '+'
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_1123:				; CODE XREF: _ssl3_get_cert_verify+358j
					; _ssl3_get_cert_verify+35Fj
		push	0
		push	ebp
		call	_EVP_PKEY_CTX_new
		add	esp, 8
		mov	[esp+7Ch+var_6C], eax
		test	eax, eax
		jnz	short loc_1156
		push	0C29h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	88h ; 'ˆ'
		push	14h
		lea	esi, [eax+50h]
		call	_ERR_put_error
		jmp	loc_1226
; ---------------------------------------------------------------------------

loc_1156:				; CODE XREF: _ssl3_get_cert_verify+394j
		push	eax
		call	_EVP_PKEY_verify_init
		add	esp, 4
		test	eax, eax
		jg	short loc_1192
		mov	ebx, [esp+7Ch+var_6C]
		push	ebx
		call	_EVP_PKEY_CTX_free
		push	0C2Fh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	88h ; 'ˆ'
		push	14h
		mov	esi, 50h ; 'P'
		call	_ERR_put_error
		add	esp, 18h
		jmp	$f_err$58
; ---------------------------------------------------------------------------

loc_1192:				; CODE XREF: _ssl3_get_cert_verify+3C1j
		cmp	ebx, 40h ; '@'
		jz	short loc_11B1
		push	ebx
		push	offset ??_C@_0BM@OGNDHHK@GOST?5signature?5length?5is?5?$CFd?$AA@ ; "GOST signature length is %d"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch

loc_11B1:				; CODE XREF: _ssl3_get_cert_verify+3F5j
		xor	ecx, ecx
		lea	edx, [esp+7Ch+var_5]

loc_11B7:				; CODE XREF: _ssl3_get_cert_verify+424j
		mov	al, [ecx+esi]
		lea	edx, [edx-1]
		inc	ecx
		mov	[edx+1], al
		cmp	ecx, 40h ; '@'
		jl	short loc_11B7
		mov	eax, [edi+58h]
		mov	ebx, [esp+7Ch+var_6C]
		add	eax, 1B4h
		push	20h ; ' '
		push	eax
		push	40h ; '@'
		lea	eax, [esp+88h+var_44]
		push	eax
		push	ebx
		call	_EVP_PKEY_verify
		push	ebx
		mov	esi, eax
		call	_EVP_PKEY_CTX_free
		add	esp, 18h
		test	esi, esi
		jg	short loc_11FB
		push	0C3Dh
		jmp	loc_10D3
; ---------------------------------------------------------------------------

loc_11FB:				; CODE XREF: _ssl3_get_cert_verify+20Dj
					; _ssl3_get_cert_verify:loc_1032j ...
		mov	ebx, 1
		jmp	short loc_123E
; ---------------------------------------------------------------------------

loc_1202:				; CODE XREF: _ssl3_get_cert_verify+F1j
					; _ssl3_get_cert_verify+F9j ...
		push	0BD8h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	109h

loc_1211:				; CODE XREF: _ssl3_get_cert_verify+1C5j
		push	88h ; 'ˆ'
		push	14h
		call	_ERR_put_error
		mov	esi, 32h ; '2'

loc_1222:				; CODE XREF: _ssl3_get_cert_verify+158j
		mov	ebp, [esp+90h+var_6C]

loc_1226:				; CODE XREF: _ssl3_get_cert_verify+BDj
					; _ssl3_get_cert_verify+230j ...
		add	esp, 14h

$f_err$58:				; CODE XREF: _ssl3_get_cert_verify+183j
					; _ssl3_get_cert_verify+191j ...
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		add	esp, 0Ch
		mov	dword ptr [edi+34h], 5
		xor	ebx, ebx

loc_123E:				; CODE XREF: _ssl3_get_cert_verify+460j
		pop	esi

$end$57:				; CODE XREF: _ssl3_get_cert_verify+40j
		mov	eax, [edi+58h]
		mov	eax, [eax+178h]
		test	eax, eax
		jz	short loc_1268
		push	eax
		call	_BIO_free
		mov	eax, [edi+58h]
		add	esp, 4
		mov	dword ptr [eax+178h], 0
		mov	eax, [edi+58h]
		and	dword ptr [eax], 0FFFFFFDFh

loc_1268:				; CODE XREF: _ssl3_get_cert_verify+4AAj
		lea	eax, [esp+78h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		push	ebp
		call	_EVP_PKEY_free
		add	esp, 8
		mov	eax, ebx

loc_127D:				; CODE XREF: _ssl3_get_cert_verify+6Ej
		mov	ecx, [esp+78h+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn
_ssl3_get_cert_verify endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1290h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_client_certificate
_ssl3_get_client_certificate proc near	; CODE XREF: _ssl3_accept+4D4p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 10h
		call	__chkstk
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+1Ch+arg_0]
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		xor	ebp, ebp
		mov	[esp+20h+var_10], ebp
		push	dword ptr [edi+108h]
		mov	eax, [edi+8]
		push	0FFFFFFFFh
		push	2181h
		push	2180h
		mov	eax, [eax+30h]
		push	edi
		call	eax
		add	esp, 18h
		mov	ebx, eax
		cmp	[esp+1Ch+var_C], ebp
		jz	loc_16B5
		mov	ecx, [edi+58h]
		push	esi
		mov	eax, [ecx+340h]
		cmp	eax, 10h
		jnz	loc_138D
		mov	eax, [edi+0C8h]
		and	eax, 3
		cmp	al, 3
		jnz	short loc_132E
		push	0C6Ch

loc_12FB:				; CODE XREF: _ssl3_get_client_certificate+2E9j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0C7h ; 'Ç'
		push	89h ; '‰'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	esi, 28h ; '('
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_132E:				; CODE XREF: _ssl3_get_client_certificate+64j
		cmp	dword ptr [edi], 300h
		jle	short loc_1376
		cmp	[ecx+390h], ebp
		jz	short loc_1376
		push	0C75h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0E9h ; 'é'
		push	89h ; '‰'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	esi, 0Ah
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_1376:				; CODE XREF: _ssl3_get_client_certificate+A4j
					; _ssl3_get_client_certificate+ACj
		pop	esi
		pop	edi
		pop	ebp
		mov	dword ptr [ecx+354h], 1
		mov	eax, 1
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_138D:				; CODE XREF: _ssl3_get_client_certificate+53j
		cmp	eax, 0Bh
		jz	short loc_13CA
		push	0C7Fh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	106h
		push	89h ; '‰'
		push	14h
		mov	esi, 0Ah
		call	_ERR_put_error
		add	esp, 14h
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_13CA:				; CODE XREF: _ssl3_get_client_certificate+100j
		mov	eax, [edi+40h]
		mov	[esp+20h+arg_0], eax
		call	_sk_new_null
		mov	esi, eax
		mov	[esp+20h+var_10], esi
		test	esi, esi
		jnz	short loc_13EA
		push	0C85h
		jmp	loc_1675
; ---------------------------------------------------------------------------

loc_13EA:				; CODE XREF: _ssl3_get_client_certificate+14Ej
		mov	esi, [esp+20h+arg_0]
		movzx	eax, byte ptr [esi]
		movzx	ecx, byte ptr [esi+1]
		shl	eax, 8
		or	ecx, eax
		movzx	eax, byte ptr [esi+2]
		shl	ecx, 8
		add	esi, 3
		or	ecx, eax
		mov	[esp+20h+arg_0], esi
		mov	[esp+20h+var_8], ecx
		lea	eax, [ecx+3]
		cmp	eax, ebx
		jz	short loc_144D
		push	0C8Ch
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	9Fh ; 'Ÿ'
		push	89h ; '‰'
		push	14h
		mov	esi, 32h ; '2'
		call	_ERR_put_error
		add	esp, 14h
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_144D:				; CODE XREF: _ssl3_get_client_certificate+183j
		xor	edx, edx
		test	ecx, ecx
		jz	loc_1538
		nop	word ptr [eax+eax+00000000h]

loc_1460:				; CODE XREF: _ssl3_get_client_certificate+23Cj
		movzx	eax, byte ptr [esi]
		add	edx, 3
		movzx	ebx, byte ptr [esi+1]
		shl	eax, 8
		or	ebx, eax
		movzx	eax, byte ptr [esi+2]
		shl	ebx, 8
		add	esi, 3
		or	ebx, eax
		mov	[esp+20h+arg_0], esi
		add	edx, ebx
		mov	[esp+20h+var_4], edx
		cmp	edx, ecx
		ja	short loc_1500
		push	ebx
		lea	eax, [esp+24h+arg_0]
		push	eax
		push	0
		call	_d2i_X509
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_14DF
		lea	eax, [esi+ebx]
		cmp	[esp+20h+arg_0], eax
		jnz	short loc_14D8
		mov	esi, [esp+20h+var_10]
		push	ebp
		push	esi
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_14CE
		mov	ecx, [esp+20h+var_8]
		xor	ebp, ebp
		mov	edx, [esp+20h+var_4]
		cmp	edx, ecx
		jnb	short loc_153C
		mov	esi, [esp+20h+arg_0]
		jmp	short loc_1460
; ---------------------------------------------------------------------------

loc_14CE:				; CODE XREF: _ssl3_get_client_certificate+228j
		push	0CA5h
		jmp	loc_1675
; ---------------------------------------------------------------------------

loc_14D8:				; CODE XREF: _ssl3_get_client_certificate+216j
		push	0CA1h
		jmp	short loc_1505
; ---------------------------------------------------------------------------

loc_14DF:				; CODE XREF: _ssl3_get_client_certificate+20Dj
		push	0C9Bh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0Dh
		push	89h ; '‰'
		push	14h
		call	_ERR_put_error
		mov	esi, [esp+34h+var_10]
		jmp	loc_1688
; ---------------------------------------------------------------------------

loc_1500:				; CODE XREF: _ssl3_get_client_certificate+1F7j
		push	0C94h

loc_1505:				; CODE XREF: _ssl3_get_client_certificate+24Dj
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	esi, 32h ; '2'
		push	87h ; '‡'

loc_1514:				; CODE XREF: _ssl3_get_client_certificate+2D5j
		push	89h ; '‰'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_1538:				; CODE XREF: _ssl3_get_client_certificate+1C1j
		mov	esi, [esp+20h+var_10]

loc_153C:				; CODE XREF: _ssl3_get_client_certificate+236j
		push	esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jg	short loc_15B1
		cmp	dword ptr [edi], 300h
		jnz	short loc_1567
		push	0CB1h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	esi, 28h ; '('
		push	0B0h ; '°'
		jmp	short loc_1514
; ---------------------------------------------------------------------------

loc_1567:				; CODE XREF: _ssl3_get_client_certificate+2BFj
		mov	eax, [edi+0C8h]
		and	eax, 3
		cmp	al, 3
		jnz	short loc_157E
		push	0CB8h
		jmp	loc_12FB
; ---------------------------------------------------------------------------

loc_157E:				; CODE XREF: _ssl3_get_client_certificate+2E2j
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+178h], 0
		jz	short loc_15FF
		push	edi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jnz	short loc_15FF
		mov	esi, 50h ; 'P'
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_15B1:				; CODE XREF: _ssl3_get_client_certificate+2B7j
		push	esi
		push	edi
		call	_ssl_verify_cert_chain
		add	esp, 8
		test	eax, eax
		jg	short loc_15FF
		push	dword ptr [edi+0ECh]
		call	_ssl_verify_alarm_type
		push	0CC6h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	86h ; '†'
		push	89h ; '‰'
		push	14h
		mov	esi, eax
		call	_ERR_put_error
		add	esp, 18h

$f_err$54:
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		mov	esi, [esp+2Ch+var_10]
		add	esp, 0Ch
		jmp	$err$53
; ---------------------------------------------------------------------------

loc_15FF:				; CODE XREF: _ssl3_get_client_certificate+2F8j
					; _ssl3_get_client_certificate+305j ...
		mov	eax, [edi+0C0h]
		mov	eax, [eax+9Ch]
		test	eax, eax
		jz	short loc_1618
		push	eax
		call	_X509_free
		add	esp, 4

loc_1618:				; CODE XREF: _ssl3_get_client_certificate+37Dj
		push	esi
		call	_sk_shift
		mov	ecx, [edi+0C0h]
		add	esp, 4
		mov	[ecx+9Ch], eax
		mov	ecx, [edi+0C0h]
		mov	eax, [edi+0ECh]
		mov	[ecx+0A0h], eax
		mov	eax, [edi+0C0h]
		mov	eax, [eax+98h]
		test	eax, eax
		jnz	short loc_16BC
		call	_ssl_sess_cert_new
		mov	ecx, [edi+0C0h]
		mov	[ecx+98h], eax
		mov	eax, [edi+0C0h]
		mov	eax, [eax+98h]
		test	eax, eax
		jnz	short loc_16BC
		push	0CD7h

loc_1675:				; CODE XREF: _ssl3_get_client_certificate+155j
					; _ssl3_get_client_certificate+243j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	89h ; '‰'
		push	14h
		call	_ERR_put_error

loc_1688:				; CODE XREF: _ssl3_get_client_certificate+26Bj
		add	esp, 14h

$err$53:				; CODE XREF: _ssl3_get_client_certificate+99j
					; _ssl3_get_client_certificate+E1j ...
		mov	dword ptr [edi+34h], 5
		test	ebp, ebp
		jz	short loc_169F
		push	ebp
		call	_X509_free
		add	esp, 4

loc_169F:				; CODE XREF: _ssl3_get_client_certificate+404j
		test	esi, esi
		jz	short loc_16B1
		push	offset _X509_free
		push	esi
		call	_sk_pop_free
		add	esp, 8

loc_16B1:				; CODE XREF: _ssl3_get_client_certificate+411j
		or	eax, 0FFFFFFFFh
		pop	esi

loc_16B5:				; CODE XREF: _ssl3_get_client_certificate+40j
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_16BC:				; CODE XREF: _ssl3_get_client_certificate+3BDj
					; _ssl3_get_client_certificate+3DEj
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_16D0
		push	offset _X509_free
		push	eax
		call	_sk_pop_free
		add	esp, 8

loc_16D0:				; CODE XREF: _ssl3_get_client_certificate+430j
		mov	eax, [edi+0C0h]
		mov	eax, [eax+98h]
		mov	[eax], esi
		mov	eax, 1
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
_ssl3_get_client_certificate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 16ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_client_hello
_ssl3_get_client_hello proc near	; CODE XREF: _ssl3_accept+205p

Src		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 1Ch
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+28h+arg_0]
		xor	ecx, ecx
		push	edi
		mov	ebp, 50h ; 'P'
		mov	[esp+2Ch+var_8], 0
		mov	[esp+2Ch+var_10], ecx
		mov	eax, [esi+34h]
		mov	[esp+2Ch+var_18], ecx
		cmp	eax, 2112h
		jnz	short loc_172B
		cmp	[esi+10Ch], ecx
		jz	$retry_cert$191

loc_172B:				; CODE XREF: _ssl3_get_client_hello+31j
		cmp	eax, 2110h
		jnz	short loc_1739
		mov	dword ptr [esi+34h], 2111h

loc_1739:				; CODE XREF: _ssl3_get_client_hello+44j
		mov	eax, [esi+8]
		lea	ecx, [esp+2Ch+var_4]
		push	ecx
		push	4000h
		push	1
		push	2112h
		mov	dword ptr [esi+10Ch], 1
		mov	eax, [eax+30h]
		push	2111h
		push	esi
		call	eax
		add	esp, 18h
		mov	edi, eax
		cmp	[esp+2Ch+var_4], 0
		jz	loc_222B
		mov	ecx, [esi+40h]
		mov	ebx, ecx
		mov	dword ptr [esi+10Ch], 0
		mov	[esp+2Ch+Src], ecx
		mov	[esp+2Ch+var_C], ebx
		cmp	edi, 23h ; '#'
		jge	short loc_17A2
		push	3B2h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_17A2:				; CODE XREF: _ssl3_get_client_hello+A0j
		movzx	eax, byte ptr [ecx+1]
		movzx	edx, byte ptr [ecx]
		add	ecx, 2
		mov	[esp+2Ch+Src], ecx
		mov	ecx, [esi+8]
		shl	edx, 8
		or	edx, eax
		mov	[esi+110h], edx
		mov	eax, [ecx+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_1815
		cmp	edx, [esi]
		jle	short loc_17D3
		cmp	dword ptr [ecx], 1FFFFh
		jnz	short loc_1820

loc_17D3:				; CODE XREF: _ssl3_get_client_hello+DDj
					; _ssl3_get_client_hello+132j
		push	0
		push	0
		push	20h ; ' '
		push	esi
		call	_SSL_ctrl
		mov	ecx, [esp+3Ch+Src]
		add	esp, 10h
		test	eax, 2000h
		jz	loc_1882
		movzx	eax, byte ptr [ecx+20h]
		lea	edx, [ecx+21h]
		add	edx, eax
		lea	eax, [ebx+edi]
		cmp	edx, eax
		jb	short loc_1870
		push	3D9h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_1815:				; CODE XREF: _ssl3_get_client_hello+D9j
		xor	eax, eax
		cmp	edx, [esi]
		setl	al
		test	eax, eax
		jz	short loc_17D3

loc_1820:				; CODE XREF: _ssl3_get_client_hello+E5j
		push	3C0h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10Bh
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error
		mov	ecx, [esi+110h]
		add	esp, 14h
		mov	eax, ecx
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		jnz	short loc_1866
		cmp	dword ptr [esi+8Ch], 0
		jnz	short loc_1866
		cmp	dword ptr [esi+90h], 0
		jnz	short loc_1866
		mov	[esi], ecx

loc_1866:				; CODE XREF: _ssl3_get_client_hello+164j
					; _ssl3_get_client_hello+16Dj ...
		mov	ebp, 46h ; 'F'
		jmp	$f_err$192
; ---------------------------------------------------------------------------

loc_1870:				; CODE XREF: _ssl3_get_client_hello+113j
		cmp	byte ptr [edx],	0
		jnz	short loc_1882
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1882:				; CODE XREF: _ssl3_get_client_hello+FFj
					; _ssl3_get_client_hello+187j
		movups	xmm0, xmmword ptr [ecx]
		mov	eax, [esi+58h]
		add	edi, [esp+2Ch+var_C]
		mov	[esp+2Ch+var_14], edi
		movups	xmmword	ptr [eax+0C0h],	xmm0
		movups	xmm0, xmmword ptr [ecx+10h]
		movups	xmmword	ptr [eax+0D0h],	xmm0
		mov	ecx, [esp+2Ch+Src]
		add	ecx, 20h ; ' '
		mov	[esp+2Ch+Src], ecx
		movzx	ebx, byte ptr [ecx]
		inc	ecx
		mov	[esp+2Ch+Src], ecx
		lea	eax, [ebx+ecx]
		cmp	eax, edi
		jbe	short loc_18D0
		push	3EBh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_18D0:				; CODE XREF: _ssl3_get_client_hello+1CEj
		cmp	ebx, 20h ; ' '
		ja	loc_21DF
		cmp	dword ptr [esi+28h], 0
		mov	dword ptr [esi+6Ch], 0
		jz	short loc_18F2
		test	dword ptr [esi+100h], 10000h
		jnz	short loc_1921

loc_18F2:				; CODE XREF: _ssl3_get_client_hello+1F8j
		push	edi
		push	ebx
		push	ecx
		push	esi
		call	_ssl_get_prev_session
		add	esp, 10h
		cmp	eax, 1
		jnz	short loc_1918
		mov	ecx, [esi+0C0h]
		mov	eax, [esi]
		cmp	eax, [ecx]
		jnz	short loc_1921
		mov	dword ptr [esi+6Ch], 1
		jmp	short loc_1934
; ---------------------------------------------------------------------------

loc_1918:				; CODE XREF: _ssl3_get_client_hello+215j
		cmp	eax, 0FFFFFFFFh
		jz	$err$193

loc_1921:				; CODE XREF: _ssl3_get_client_hello+204j
					; _ssl3_get_client_hello+221j
		push	1
		push	esi
		call	_ssl_get_new_session
		add	esp, 8
		test	eax, eax
		jz	$err$193

loc_1934:				; CODE XREF: _ssl3_get_client_hello+22Aj
		mov	ecx, [esp+2Ch+Src]
		mov	eax, [esi+8]
		add	ecx, ebx
		mov	[esp+2Ch+Src], ecx
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	loc_1B42
		lea	eax, [ecx+1]
		cmp	eax, edi
		jbe	short loc_1969
		push	423h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_1969:				; CODE XREF: _ssl3_get_client_hello+267j
		movzx	ebx, byte ptr [ecx]
		mov	[esp+2Ch+Src], eax
		add	eax, ebx
		cmp	eax, edi
		jbe	short loc_198A
		push	42Ah
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_198A:				; CODE XREF: _ssl3_get_client_hello+288j
		cmp	ebx, 100h
		jbe	short loc_19A6
		push	436h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	134h
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_19A6:				; CODE XREF: _ssl3_get_client_hello+2A4j
		push	0
		push	0
		push	20h ; ' '
		push	esi
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, 2000h
		jz	loc_1A96
		test	ebx, ebx
		jz	loc_1A96
		mov	eax, [esi+5Ch]
		push	ebx		; Size
		push	[esp+30h+Src]	; Src
		add	eax, 104h
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esi+0E4h]
		add	esp, 0Ch
		mov	ecx, [eax+7Ch]
		mov	eax, [esi+5Ch]
		test	ecx, ecx
		jz	short loc_1A1A
		push	ebx
		add	eax, 104h
		push	eax
		push	esi
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1A8E
		push	443h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		lea	ebp, [eax+28h]
		push	134h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1A1A:				; CODE XREF: _ssl3_get_client_hello+300j
		mov	edi, [eax+204h]
		lea	edx, [eax+4]
		lea	ecx, [eax+104h]
		sub	edi, 4
		jb	short loc_1A3F

loc_1A2E:				; CODE XREF: _ssl3_get_client_hello+351j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_1A44
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_1A2E

loc_1A3F:				; CODE XREF: _ssl3_get_client_hello+340j
		cmp	edi, 0FFFFFFFCh
		jz	short loc_1A8A

loc_1A44:				; CODE XREF: _ssl3_get_client_hello+346j
		mov	al, [ecx]
		cmp	al, [edx]
		jnz	short loc_1A71
		cmp	edi, 0FFFFFFFDh
		jz	short loc_1A8A
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	short loc_1A71
		cmp	edi, 0FFFFFFFEh
		jz	short loc_1A8A
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	short loc_1A71
		cmp	edi, 0FFFFFFFFh
		jz	short loc_1A8A
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jz	short loc_1A8A

loc_1A71:				; CODE XREF: _ssl3_get_client_hello+35Cj
					; _ssl3_get_client_hello+369j ...
		push	44Ch
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	ebp, 28h ; '('
		push	134h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1A8A:				; CODE XREF: _ssl3_get_client_hello+356j
					; _ssl3_get_client_hello+361j ...
		mov	edi, [esp+2Ch+var_14]

loc_1A8E:				; CODE XREF: _ssl3_get_client_hello+311j
		mov	[esp+2Ch+var_8], 1

loc_1A96:				; CODE XREF: _ssl3_get_client_hello+2CEj
					; _ssl3_get_client_hello+2D6j
		mov	ecx, [esp+2Ch+Src]
		mov	eax, [esi+8]
		add	ecx, ebx
		mov	[esp+2Ch+Src], ecx
		cmp	dword ptr [eax], 1FFFFh
		jnz	loc_1B42
		mov	ecx, [esi+110h]
		cmp	ecx, 0FEFDh
		jg	short loc_1AD6
		test	dword ptr [esi+100h], 8000000h
		jnz	short loc_1AD6
		mov	dword ptr [esi], 0FEFDh
		call	_DTLSv1_2_server_method
		jmp	short loc_1B31
; ---------------------------------------------------------------------------

loc_1AD6:				; CODE XREF: _ssl3_get_client_hello+3CFj
					; _ssl3_get_client_hello+3DBj
		mov	eax, [esi+98h]
		test	dword ptr [eax+38h], 30000h
		jz	short loc_1B12
		push	45Bh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	183h
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error
		mov	eax, [esi+110h]
		mov	ebp, 46h ; 'F'
		mov	[esi], eax
		jmp	loc_21FF
; ---------------------------------------------------------------------------

loc_1B12:				; CODE XREF: _ssl3_get_client_hello+3F7j
		cmp	ecx, 0FEFFh
		jg	short loc_1B5D
		test	dword ptr [esi+100h], 4000000h
		jnz	short loc_1B5D
		mov	dword ptr [esi], 0FEFFh
		call	_DTLSv1_server_method

loc_1B31:				; CODE XREF: _ssl3_get_client_hello+3E8j
		mov	ecx, [esi+0C0h]
		mov	[esi+8], eax
		mov	eax, [esi]
		mov	[ecx], eax
		mov	ecx, [esp+2Ch+Src]

loc_1B42:				; CODE XREF: _ssl3_get_client_hello+25Cj
					; _ssl3_get_client_hello+3BDj
		lea	edx, [ecx+2]
		cmp	edx, edi
		jbe	short loc_1B8A
		push	470h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A0h ; ' '
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_1B5D:				; CODE XREF: _ssl3_get_client_hello+42Cj
					; _ssl3_get_client_hello+438j
		push	465h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10Bh
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error
		mov	eax, [esi+110h]
		mov	ebp, 46h ; 'F'
		mov	[esi], eax
		jmp	loc_21FF
; ---------------------------------------------------------------------------

loc_1B8A:				; CODE XREF: _ssl3_get_client_hello+45Bj
		movzx	ebx, byte ptr [ecx]
		movzx	eax, byte ptr [ecx+1]
		shl	ebx, 8
		or	ebx, eax
		mov	[esp+2Ch+Src], edx
		jnz	short loc_1BB5
		push	477h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	ebp, 2Fh ; '/'
		push	0B7h ; '·'
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1BB5:				; CODE XREF: _ssl3_get_client_hello+4AEj
		lea	eax, [edx+1]
		add	eax, ebx
		cmp	eax, edi
		jbe	short loc_1BC8
		push	47Fh
		jmp	loc_21E4
; ---------------------------------------------------------------------------

loc_1BC8:				; CODE XREF: _ssl3_get_client_hello+4D0j
		lea	eax, [esp+2Ch+var_18]
		push	eax
		push	ebx
		push	edx
		push	esi
		call	_ssl_bytes_to_cipher_list
		add	esp, 10h
		test	eax, eax
		jz	$err$193
		mov	edi, [esp+2Ch+Src]
		add	edi, ebx
		cmp	dword ptr [esi+6Ch], 0
		mov	[esp+2Ch+Src], edi
		jz	short loc_1C51
		mov	eax, [esi+0C0h]
		xor	edi, edi
		push	[esp+2Ch+var_18]
		mov	eax, [eax+0B4h]
		mov	ebx, [eax+8]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1C34

loc_1C11:				; CODE XREF: _ssl3_get_client_hello+546j
		push	edi
		push	[esp+30h+var_18]
		call	_sk_value
		add	esp, 8
		cmp	[eax+8], ebx
		jz	short loc_1C4D
		push	[esp+2Ch+var_18]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_1C11

loc_1C34:				; CODE XREF: _ssl3_get_client_hello+523j
		push	4B7h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	ebp, 2Fh ; '/'
		push	0D7h ; '×'
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1C4D:				; CODE XREF: _ssl3_get_client_hello+535j
		mov	edi, [esp+2Ch+Src]

loc_1C51:				; CODE XREF: _ssl3_get_client_hello+502j
		movzx	ebx, byte ptr [edi]
		inc	edi
		mov	edx, [esp+2Ch+var_14]
		mov	[esp+2Ch+Src], edi
		lea	ecx, [ebx+edi]
		cmp	ecx, edx
		jbe	short loc_1C6E
		push	4C1h
		jmp	loc_21E4
; ---------------------------------------------------------------------------

loc_1C6E:				; CODE XREF: _ssl3_get_client_hello+576j
		xor	eax, eax
		test	ebx, ebx
		jle	short loc_1C7F

loc_1C74:				; CODE XREF: _ssl3_get_client_hello+591j
		cmp	byte ptr [eax+edi], 0
		jz	short loc_1C7F
		inc	eax
		cmp	eax, ebx
		jl	short loc_1C74

loc_1C7F:				; CODE XREF: _ssl3_get_client_hello+586j
					; _ssl3_get_client_hello+58Cj
		mov	[esp+2Ch+Src], ecx
		cmp	eax, ebx
		jl	short loc_1C9B
		push	4D0h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0BBh ; '»'
		jmp	loc_21EE
; ---------------------------------------------------------------------------

loc_1C9B:				; CODE XREF: _ssl3_get_client_hello+599j
		cmp	dword ptr [esi], 300h
		jl	short loc_1CD9
		push	edx
		lea	eax, [esp+30h+Src]
		push	eax
		push	esi
		call	_ssl_parse_clienthello_tlsext
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1CD9
		push	4D7h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0E3h ; 'ã'
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$193
; ---------------------------------------------------------------------------

loc_1CD9:				; CODE XREF: _ssl3_get_client_hello+5B5j
					; _ssl3_get_client_hello+5C8j
		mov	eax, [esi+58h]
		push	20h ; ' '
		add	eax, 0A0h ; ' '
		push	eax
		push	1
		push	esi
		call	_ssl_fill_hello_random
		add	esp, 10h
		test	eax, eax
		jle	$f_err$192
		cmp	dword ptr [esi+6Ch], 0
		jnz	loc_1E2B
		cmp	dword ptr [esi], 301h
		jl	loc_1E2B
		cmp	dword ptr [esi+168h], 0
		jz	loc_1E2B
		mov	eax, [esi+0C0h]
		mov	[esp+2Ch+var_14], 0
		mov	dword ptr [eax+10h], 30h ; '0'
		lea	eax, [esp+2Ch+var_14]
		push	dword ptr [esi+16Ch]
		mov	ecx, [esi+0C0h]
		push	eax
		push	[esp+34h+var_18]
		lea	eax, [ecx+10h]
		push	eax
		lea	eax, [ecx+14h]
		push	eax
		mov	eax, [esi+168h]
		push	esi
		call	eax
		add	esp, 18h
		test	eax, eax
		jz	loc_1E2B
		mov	ecx, [esi+0C0h]
		mov	eax, [esp+2Ch+var_18]
		mov	dword ptr [esi+6Ch], 1
		mov	[ecx+0BCh], eax
		mov	eax, [esi+0C0h]
		mov	dword ptr [eax+0A0h], 0
		mov	ecx, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_18], 0
		test	ecx, ecx
		jnz	short loc_1DD4
		push	esi
		call	_SSL_get_ciphers
		push	eax
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0BCh]
		push	esi
		call	_ssl3_choose_cipher
		mov	ecx, eax
		add	esp, 10h
		mov	[esp+2Ch+var_14], ecx
		test	ecx, ecx
		jnz	short loc_1DD4
		push	501h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		lea	ebp, [eax+28h]
		push	0C1h ; 'Á'
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1DD4:				; CODE XREF: _ssl3_get_client_hello+6A9j
					; _ssl3_get_client_hello+6CFj
		mov	eax, [esi+0C0h]
		mov	[eax+0B4h], ecx
		mov	eax, [esi+74h]
		test	eax, eax
		jz	short loc_1DF0
		push	eax
		call	_sk_free
		add	esp, 4

loc_1DF0:				; CODE XREF: _ssl3_get_client_hello+6F9j
		mov	eax, [esi+78h]
		test	eax, eax
		jz	short loc_1E00
		push	eax
		call	_sk_free
		add	esp, 4

loc_1E00:				; CODE XREF: _ssl3_get_client_hello+709j
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0BCh]
		call	_sk_dup
		mov	[esi+74h], eax
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0BCh]
		call	_sk_dup
		add	esp, 8
		mov	[esi+78h], eax

loc_1E2B:				; CODE XREF: _ssl3_get_client_hello+60Fj
					; _ssl3_get_client_hello+61Bj ...
		mov	eax, [esi+58h]
		mov	dword ptr [eax+38Ch], 0
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0B0h]
		mov	[esp+2Ch+var_C], eax
		test	eax, eax
		jz	loc_1F44
		test	dword ptr [esi+100h], 20000h
		jz	short loc_1E70
		push	521h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	154h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1E70:				; CODE XREF: _ssl3_get_client_hello+76Ej
		mov	eax, [esi+0E4h]
		mov	[esp+2Ch+var_14], 0
		push	dword ptr [eax+98h]
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1EDF
		xor	ecx, ecx
		db	66h, 66h
		nop	word ptr [eax+eax+00000000h]

loc_1E9C:				; CODE XREF: _ssl3_get_client_hello+7F1j
		mov	eax, [esi+0E4h]
		push	ecx
		push	dword ptr [eax+98h]
		call	_sk_value
		mov	edx, [esp+34h+var_C]
		mov	ecx, eax
		add	esp, 8
		mov	[esp+2Ch+var_10], ecx
		cmp	edx, [ecx]
		jz	short loc_1F03
		mov	eax, [esi+0E4h]
		inc	[esp+2Ch+var_14]
		push	dword ptr [eax+98h]
		call	_sk_num
		mov	ecx, [esp+30h+var_14]
		add	esp, 4
		cmp	ecx, eax
		jl	short loc_1E9C

loc_1EDF:				; CODE XREF: _ssl3_get_client_hello+7A2j
		mov	edx, [esp+2Ch+var_C]

loc_1EE3:				; CODE XREF: _ssl3_get_client_hello+820j
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+38Ch], 0
		jnz	short loc_1F0E
		push	52Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	155h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1F03:				; CODE XREF: _ssl3_get_client_hello+7D1j
		mov	eax, [esi+58h]
		mov	[eax+38Ch], ecx
		jmp	short loc_1EE3
; ---------------------------------------------------------------------------

loc_1F0E:				; CODE XREF: _ssl3_get_client_hello+801j
		xor	ecx, ecx
		test	ebx, ebx
		jle	short loc_1F2B

loc_1F14:				; CODE XREF: _ssl3_get_client_hello+833j
		movzx	eax, byte ptr [ecx+edi]
		cmp	eax, edx
		jz	short loc_1F23
		inc	ecx
		cmp	ecx, ebx
		jl	short loc_1F14
		jmp	short loc_1F2B
; ---------------------------------------------------------------------------

loc_1F23:				; CODE XREF: _ssl3_get_client_hello+82Ej
		cmp	ecx, ebx
		jl	loc_1FDD

loc_1F2B:				; CODE XREF: _ssl3_get_client_hello+826j
					; _ssl3_get_client_hello+835j
		push	539h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	ebp, 2Fh ; '/'
		push	156h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_1F44:				; CODE XREF: _ssl3_get_client_hello+75Ej
		cmp	dword ptr [esi+6Ch], 0
		jnz	short loc_1FBC
		test	dword ptr [esi+100h], 20000h
		jnz	short loc_1FBC
		mov	eax, [esi+0E4h]
		mov	eax, [eax+98h]
		test	eax, eax
		jz	short loc_1FBC
		push	eax
		call	_sk_num
		mov	ecx, eax
		add	esp, 4
		xor	eax, eax
		mov	[esp+2Ch+var_14], ecx
		mov	[esp+2Ch+var_C], eax
		test	ecx, ecx
		jle	short loc_1FBC

loc_1F7F:				; CODE XREF: _ssl3_get_client_hello+8CEj
		push	eax
		mov	eax, [esi+0E4h]
		push	dword ptr [eax+98h]
		call	_sk_value
		add	esp, 8
		mov	[esp+2Ch+var_10], eax
		xor	ecx, ecx
		mov	edx, [eax]
		test	ebx, ebx
		jle	short loc_1FAD

loc_1FA0:				; CODE XREF: _ssl3_get_client_hello+8BFj
		movzx	eax, byte ptr [ecx+edi]
		cmp	edx, eax
		jz	short loc_1FD0
		inc	ecx
		cmp	ecx, ebx
		jl	short loc_1FA0

loc_1FAD:				; CODE XREF: _ssl3_get_client_hello+8B2j
		mov	eax, [esp+2Ch+var_C]
		inc	eax
		mov	[esp+2Ch+var_C], eax
		cmp	eax, [esp+2Ch+var_14]
		jl	short loc_1F7F

loc_1FBC:				; CODE XREF: _ssl3_get_client_hello+85Cj
					; _ssl3_get_client_hello+868j ...
		xor	eax, eax

loc_1FBE:				; CODE XREF: _ssl3_get_client_hello+8F5j
		cmp	dword ptr [esi+6Ch], 0
		jnz	loc_2100
		test	eax, eax
		jnz	short loc_1FE3
		xor	ecx, ecx
		jmp	short loc_1FE5
; ---------------------------------------------------------------------------

loc_1FD0:				; CODE XREF: _ssl3_get_client_hello+8BAj
		mov	eax, [esi+58h]
		mov	ecx, [esp+2Ch+var_10]
		mov	[eax+38Ch], ecx

loc_1FDD:				; CODE XREF: _ssl3_get_client_hello+839j
		mov	eax, [esp+2Ch+var_10]
		jmp	short loc_1FBE
; ---------------------------------------------------------------------------

loc_1FE3:				; CODE XREF: _ssl3_get_client_hello+8DEj
		mov	ecx, [eax]

loc_1FE5:				; CODE XREF: _ssl3_get_client_hello+8E2j
		mov	eax, [esi+0C0h]
		mov	[eax+0B0h], ecx
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0BCh]
		test	eax, eax
		jz	short loc_200A
		push	eax
		call	_sk_free
		add	esp, 4

loc_200A:				; CODE XREF: _ssl3_get_client_hello+913j
		mov	ecx, [esi+0C0h]
		mov	eax, [esp+2Ch+var_18]
		mov	[ecx+0BCh], eax
		cmp	[esp+2Ch+var_18], 0
		jnz	short loc_2032
		push	56Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_2032:				; CODE XREF: _ssl3_get_client_hello+933j
		push	esi
		mov	[esp+30h+var_18], 0
		call	_tls1_set_server_sigalgs
		add	esp, 4
		test	eax, eax
		jnz	short $retry_cert$191
		push	573h

loc_204C:				; CODE XREF: _ssl3_get_client_hello+AE2j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0E2h ; 'â'
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$193
; ---------------------------------------------------------------------------

$retry_cert$191:			; CODE XREF: _ssl3_get_client_hello+39j
					; _ssl3_get_client_hello+959j
		mov	eax, [esi+98h]
		mov	ecx, [eax+144h]
		test	ecx, ecx
		jz	short loc_20B9
		push	dword ptr [eax+148h]
		push	esi
		call	ecx
		add	esp, 8
		test	eax, eax
		jnz	short loc_209E
		push	57Ch
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	179h
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_209E:				; CODE XREF: _ssl3_get_client_hello+99Cj
		jns	short loc_20B2
		pop	edi
		mov	dword ptr [esi+18h], 4
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_20B2:				; CODE XREF: _ssl3_get_client_hello:loc_209Ej
		mov	dword ptr [esi+18h], 1

loc_20B9:				; CODE XREF: _ssl3_get_client_hello+98Cj
		push	esi
		call	_SSL_get_ciphers
		push	eax
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0BCh]
		push	esi
		call	_ssl3_choose_cipher
		mov	ecx, eax
		add	esp, 10h
		test	ecx, ecx
		jnz	short loc_20F2
		push	589h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		lea	ebp, [eax+28h]
		push	0C1h ; 'Á'
		jmp	loc_21F3
; ---------------------------------------------------------------------------

loc_20F2:				; CODE XREF: _ssl3_get_client_hello+9EDj
		mov	eax, [esi+58h]
		mov	[eax+344h], ecx
		jmp	loc_2192
; ---------------------------------------------------------------------------

loc_2100:				; CODE XREF: _ssl3_get_client_hello+8D6j
		mov	eax, [esi+0C0h]
		xor	edi, edi
		xor	ebx, ebx
		test	dword ptr [esi+100h], 40000000h
		jz	short loc_2183
		mov	eax, [eax+0BCh]
		push	eax
		mov	[esp+30h+var_C], eax
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_217D
		mov	ebp, [esp+2Ch+var_C]
		xor	esi, esi

loc_2133:				; CODE XREF: _ssl3_get_client_hello+A68j
		push	esi
		push	ebp
		call	_sk_value
		push	ebp
		test	byte ptr [eax+14h], 20h
		cmovnz	edi, eax
		test	byte ptr [eax+20h], 2
		cmovnz	ebx, eax
		inc	esi
		call	_sk_num
		add	esp, 0Ch
		cmp	esi, eax
		jl	short loc_2133
		mov	esi, [esp+2Ch+arg_0]
		mov	ebp, 50h ; 'P'
		test	edi, edi
		jz	short loc_216E
		mov	eax, [esi+58h]
		mov	[eax+344h], edi
		jmp	short loc_2192
; ---------------------------------------------------------------------------

loc_216E:				; CODE XREF: _ssl3_get_client_hello+A75j
		test	ebx, ebx
		jz	short loc_217D
		mov	eax, [esi+58h]
		mov	[eax+344h], ebx
		jmp	short loc_2192
; ---------------------------------------------------------------------------

loc_217D:				; CODE XREF: _ssl3_get_client_hello+A3Fj
					; _ssl3_get_client_hello+A84j
		mov	eax, [esi+0C0h]

loc_2183:				; CODE XREF: _ssl3_get_client_hello+A28j
		mov	ecx, [esi+58h]
		mov	eax, [eax+0B4h]
		mov	[ecx+344h], eax

loc_2192:				; CODE XREF: _ssl3_get_client_hello+A0Fj
					; _ssl3_get_client_hello+A80j ...
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	short loc_21A7
		test	byte ptr [esi+0C8h], 1
		jnz	short loc_21B4

loc_21A7:				; CODE XREF: _ssl3_get_client_hello+AB0j
		push	esi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	short $f_err$192

loc_21B4:				; CODE XREF: _ssl3_get_client_hello+AB9j
		cmp	dword ptr [esi], 300h
		jl	short loc_21D3
		push	esi
		call	_ssl_check_clienthello_tlsext_late
		add	esp, 4
		test	eax, eax
		jg	short loc_21D3
		push	5BCh
		jmp	loc_204C
; ---------------------------------------------------------------------------

loc_21D3:				; CODE XREF: _ssl3_get_client_hello+ACEj
					; _ssl3_get_client_hello+ADBj
		xor	ebx, ebx
		cmp	[esp+2Ch+var_8], ebx
		setnz	bl
		inc	ebx
		jmp	short loc_2218
; ---------------------------------------------------------------------------

loc_21DF:				; CODE XREF: _ssl3_get_client_hello+1E7j
		push	3F1h

loc_21E4:				; CODE XREF: _ssl3_get_client_hello+4D7j
					; _ssl3_get_client_hello+57Dj
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	9Fh ; 'Ÿ'

loc_21EE:				; CODE XREF: _ssl3_get_client_hello+B1j
					; _ssl3_get_client_hello+124j ...
		mov	ebp, 32h ; '2'

loc_21F3:				; CODE XREF: _ssl3_get_client_hello+329j
					; _ssl3_get_client_hello+399j ...
		push	8Ah ; 'Š'
		push	14h
		call	_ERR_put_error

loc_21FF:				; CODE XREF: _ssl3_get_client_hello+421j
					; _ssl3_get_client_hello+499j
		add	esp, 14h

$f_err$192:				; CODE XREF: _ssl3_get_client_hello+17Fj
					; _ssl3_get_client_hello+605j ...
		push	ebp
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

$err$193:				; CODE XREF: _ssl3_get_client_hello+22Fj
					; _ssl3_get_client_hello+242j ...
		mov	dword ptr [esi+34h], 5
		or	ebx, 0FFFFFFFFh

loc_2218:				; CODE XREF: _ssl3_get_client_hello+AF1j
		mov	ecx, [esp+2Ch+var_18]
		test	ecx, ecx
		jz	short loc_2229
		push	ecx
		call	_sk_free
		add	esp, 4

loc_2229:				; CODE XREF: _ssl3_get_client_hello+B32j
		mov	eax, ebx

loc_222B:				; CODE XREF: _ssl3_get_client_hello+80j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
_ssl3_get_client_hello endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2234h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_client_key_exchange
_ssl3_get_client_key_exchange proc near	; CODE XREF: _ssl3_accept+4FAp

var_2E8		= dword	ptr -2E8h
var_2E4		= dword	ptr -2E4h
Size		= dword	ptr -2E0h
var_2DC		= dword	ptr -2DCh
var_2D8		= dword	ptr -2D8h
var_2D4		= dword	ptr -2D4h
var_2D0		= dword	ptr -2D0h
var_2CC		= dword	ptr -2CCh
var_2C8		= dword	ptr -2C8h
var_2C4		= dword	ptr -2C4h
var_2C0		= dword	ptr -2C0h
var_2BC		= byte ptr -2BCh
var_2BB		= byte ptr -2BBh
var_2BA		= byte ptr -2BAh
var_2B9		= byte ptr -2B9h
var_2B8		= byte ptr -2B8h
var_2B7		= byte ptr -2B7h
Dst		= byte ptr -28Ch
Src		= byte ptr -208h
var_207		= byte ptr -207h
var_206		= byte ptr -206h
var_205		= byte ptr -205h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 2E8h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+2E8h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+2F4h+arg_0]
		lea	ecx, [esp+2F4h+var_2CC]
		push	ecx
		xor	eax, eax
		xor	ebp, ebp
		push	800h
		mov	[esp+2FCh+var_2D4], eax
		mov	[esp+2FCh+var_2D8], eax
		mov	[esp+2FCh+var_2DC], eax
		mov	[esp+2FCh+var_2E4], eax
		mov	eax, [esi+8]
		push	10h
		push	2191h
		push	2190h
		mov	eax, [eax+30h]
		push	esi
		call	eax
		add	esp, 18h
		mov	ebx, eax
		cmp	[esp+2F4h+var_2CC], ebp
		jz	loc_3086
		mov	eax, [esi+58h]
		mov	edx, [esi+40h]
		mov	[esp+2F4h+var_2E8], edx
		push	edi
		mov	edi, [eax+344h]
		mov	ecx, [edi+0Ch]
		mov	[esp+2F8h+Size], ecx
		test	cl, 1
		jz	loc_255A
		cmp	[eax+370h], ebp
		jz	short loc_22E6
		mov	edi, [esi+98h]
		test	edi, edi
		jz	short loc_22D2
		mov	edi, [edi+1Ch]
		test	edi, edi
		jnz	short loc_230B

loc_22D2:				; CODE XREF: _ssl3_get_client_key_exchange+95j
		push	883h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0ADh ; '­'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_22E6:				; CODE XREF: _ssl3_get_client_key_exchange+8Bj
		mov	eax, [esi+98h]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_2546
		cmp	dword ptr [eax], 6
		jnz	loc_2546
		mov	edi, [eax+14h]
		test	edi, edi
		jz	loc_2546

loc_230B:				; CODE XREF: _ssl3_get_client_key_exchange+9Cj
		mov	eax, [esi]
		cmp	eax, 300h
		jle	short loc_2365
		cmp	eax, 100h
		jz	short loc_2365
		movzx	ecx, byte ptr [edx]
		movzx	eax, byte ptr [edx+1]
		add	edx, 2
		shl	ecx, 8
		or	ecx, eax
		mov	[esp+2F8h+var_2E8], edx
		lea	eax, [ecx+2]
		cmp	ebx, eax
		jz	short loc_2363
		test	dword ptr [esi+100h], 100h
		jnz	short loc_235A
		push	89Ah
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	edi, 32h ; '2'
		push	0EAh ; 'ê'
		jmp	loc_302F
; ---------------------------------------------------------------------------

loc_235A:				; CODE XREF: _ssl3_get_client_key_exchange+10Bj
		sub	edx, 2
		mov	[esp+2F8h+var_2E8], edx
		jmp	short loc_2365
; ---------------------------------------------------------------------------

loc_2363:				; CODE XREF: _ssl3_get_client_key_exchange+FFj
		mov	ebx, ecx

loc_2365:				; CODE XREF: _ssl3_get_client_key_exchange+DEj
					; _ssl3_get_client_key_exchange+E5j ...
		cmp	ebx, 30h ; '0'
		jge	short loc_2383
		push	8ACh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	edi, 33h ; '3'
		push	0EAh ; 'ê'
		jmp	loc_302F
; ---------------------------------------------------------------------------

loc_2383:				; CODE XREF: _ssl3_get_client_key_exchange+134j
		lea	eax, [esp+2F8h+var_2BC]
		push	30h ; '0'
		push	eax
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jle	loc_304A
		mov	eax, [esp+2F8h+var_2E8]
		push	1
		push	edi
		push	eax
		push	eax
		push	ebx
		call	_RSA_private_decrypt
		add	esp, 14h
		mov	ebx, eax
		call	_ERR_clear_error
		mov	ebp, [esp+2F8h+var_2E8]
		xor	ebx, 30h
		mov	eax, [esi+110h]
		mov	ecx, eax
		movzx	eax, al
		sar	ecx, 8
		movzx	edi, byte ptr [ebp+0]
		lea	edx, [ebx-1]
		not	ebx
		shr	edx, 1Fh
		shr	ebx, 1Fh
		xor	ecx, edi
		and	dl, bl
		movzx	ebx, byte ptr [ebp+1]
		xor	eax, ebx
		mov	[esp+2F8h+Size], ebx
		neg	dl
		mov	[esp+2F8h+var_2D8], edx
		lea	ebx, [eax-1]
		not	eax
		shr	eax, 1Fh
		shr	ebx, 1Fh
		and	bl, al
		lea	eax, [ecx-1]
		shr	eax, 1Fh
		not	ecx
		shr	ecx, 1Fh
		neg	bl
		and	al, cl
		neg	al
		and	bl, al
		test	dword ptr [esi+100h], 800000h
		jz	short loc_244D
		mov	eax, [esi]
		mov	edx, eax
		movzx	eax, al
		xor	eax, [esp+2F8h+Size]
		sar	edx, 8
		xor	edx, edi
		lea	ecx, [eax-1]
		not	eax
		shr	eax, 1Fh
		shr	ecx, 1Fh
		and	cl, al
		lea	eax, [edx-1]
		not	edx
		shr	eax, 1Fh
		shr	edx, 1Fh
		neg	cl
		and	al, dl
		mov	edx, [esp+2F8h+var_2D8]
		neg	al
		and	cl, al
		or	bl, cl

loc_244D:				; CODE XREF: _ssl3_get_client_key_exchange+1E1j
		and	dl, bl
		xor	edi, edi
		movzx	eax, dl
		mov	bl, al
		mov	[esp+2F8h+var_2E4], eax
		not	bl
		nop	dword ptr [eax+eax+00000000h]

loc_2464:				; CODE XREF: _ssl3_get_client_key_exchange+2D0j
		and	al, [edi+ebp]
		movzx	ecx, [esp+edi+2F8h+var_2BC]
		and	cl, bl
		or	cl, al
		movzx	eax, byte ptr [esp+2F8h+var_2E4]
		mov	[edi+ebp], cl
		mov	cl, bl
		and	cl, [esp+edi+2F8h+var_2BB]
		mov	edx, [esp+2F8h+var_2E8]
		and	al, [edx+edi+1]
		or	cl, al
		mov	[edx+edi+1], cl
		mov	edx, [esp+2F8h+var_2E8]
		movzx	ecx, [esp+edi+2F8h+var_2BA]
		and	cl, bl
		movzx	eax, byte ptr [edx+edi+2]
		and	al, byte ptr [esp+2F8h+var_2E4]
		or	cl, al
		mov	[edx+edi+2], cl
		mov	edx, [esp+2F8h+var_2E8]
		movzx	ecx, [esp+edi+2F8h+var_2B9]
		and	cl, bl
		movzx	eax, byte ptr [edx+edi+3]
		and	al, byte ptr [esp+2F8h+var_2E4]
		or	cl, al
		movzx	eax, byte ptr [esp+2F8h+var_2E4]
		mov	[edx+edi+3], cl
		mov	edx, [esp+2F8h+var_2E8]
		movzx	ecx, [esp+edi+2F8h+var_2B8]
		and	cl, bl
		and	al, [edx+edi+4]
		or	cl, al
		movzx	eax, byte ptr [esp+2F8h+var_2E4]
		mov	[edx+edi+4], cl
		mov	edx, [esp+2F8h+var_2E8]
		movzx	ecx, [esp+edi+2F8h+var_2B7]
		and	cl, bl
		and	al, [edx+edi+5]
		or	cl, al
		mov	[edx+edi+5], cl
		add	edi, 6
		cmp	edi, 30h ; '0'
		jnb	short loc_2509
		mov	ebp, [esp+2F8h+var_2E8]
		mov	eax, [esp+2F8h+var_2E4]
		jmp	loc_2464
; ---------------------------------------------------------------------------

loc_2509:				; CODE XREF: _ssl3_get_client_key_exchange+2C6j
		mov	eax, [esi+8]
		push	30h ; '0'
		push	[esp+2FCh+var_2E8]
		mov	ecx, [eax+64h]
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	30h ; '0'
		mov	[ecx+10h], eax
		push	[esp+30Ch+var_2E8]
		call	_OPENSSL_cleanse
		add	esp, 18h

loc_253C:				; CODE XREF: _ssl3_get_client_key_exchange+55Bj
					; _ssl3_get_client_key_exchange+C03j
		mov	eax, 1
		jmp	loc_3085
; ---------------------------------------------------------------------------

loc_2546:				; CODE XREF: _ssl3_get_client_key_exchange+BDj
					; _ssl3_get_client_key_exchange+C6j ...
		push	88Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A8h ; '¨'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_255A:				; CODE XREF: _ssl3_get_client_key_exchange+7Fj
		test	cl, 0Eh
		jz	loc_279F
		mov	[esp+2F8h+var_2E4], ebp
		cmp	ebx, 1
		jle	short loc_2581
		movzx	edi, byte ptr [edx]
		movzx	eax, byte ptr [edx+1]
		shl	edi, 8
		or	edi, eax
		add	edx, 2
		mov	[esp+2F8h+var_2E8], edx
		jmp	short loc_259C
; ---------------------------------------------------------------------------

loc_2581:				; CODE XREF: _ssl3_get_client_key_exchange+336j
		test	cl, 8
		jz	short loc_259A
		push	90Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	94h ; '”'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_259A:				; CODE XREF: _ssl3_get_client_key_exchange+350j
		xor	edi, edi

loc_259C:				; CODE XREF: _ssl3_get_client_key_exchange+34Bj
		test	ebx, ebx
		jz	short loc_25DC
		lea	eax, [edi+2]
		cmp	ebx, eax
		jz	short loc_25DC
		test	byte ptr [esi+100h], 80h
		jnz	short loc_25D3
		push	915h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	94h ; '”'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_25D3:				; CODE XREF: _ssl3_get_client_key_exchange+37Aj
		sub	edx, 2
		mov	edi, ebx
		mov	[esp+2F8h+var_2E8], edx

loc_25DC:				; CODE XREF: _ssl3_get_client_key_exchange+36Aj
					; _ssl3_get_client_key_exchange+371j
		test	cl, 2
		jz	short loc_25E8
		mov	eax, 3
		jmp	short loc_25F2
; ---------------------------------------------------------------------------

loc_25E8:				; CODE XREF: _ssl3_get_client_key_exchange+3ABj
		test	cl, 4
		jz	short loc_2631
		mov	eax, 4

loc_25F2:				; CODE XREF: _ssl3_get_client_key_exchange+3B2j
		lea	ecx, ds:0[eax*8]
		sub	ecx, eax
		mov	eax, [esi+98h]
		mov	eax, [eax+ecx*4+40h]
		mov	[esp+2F8h+var_2E4], eax
		test	eax, eax
		jz	short loc_261D
		cmp	dword ptr [eax], 1Ch
		jnz	short loc_261D
		mov	eax, [eax+14h]
		mov	[esp+2F8h+Size], eax
		test	eax, eax
		jnz	short loc_2656

loc_261D:				; CODE XREF: _ssl3_get_client_key_exchange+3D7j
					; _ssl3_get_client_key_exchange+3DCj
		push	926h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0A8h ; '¨'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_2631:				; CODE XREF: _ssl3_get_client_key_exchange+3B7j
		mov	eax, [esi+58h]
		mov	eax, [eax+348h]
		mov	[esp+2F8h+Size], eax
		test	eax, eax
		jnz	short loc_2656
		push	92Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0ABh ; '«'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_2656:				; CODE XREF: _ssl3_get_client_key_exchange+3E7j
					; _ssl3_get_client_key_exchange+40Cj
		test	ebx, ebx
		jnz	short loc_26B7
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+9Ch]
		call	_X509_get_pubkey
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_26A3
		push	[esp+2F8h+var_2E4]
		push	edi
		call	_EVP_PKEY_cmp_parameters
		add	esp, 8
		cmp	eax, 1
		jnz	short loc_26A3
		push	edi
		call	_EVP_PKEY_get1_DH
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_26A3
		push	edi
		call	_EVP_PKEY_free
		mov	edi, [ebp+14h]
		add	esp, 4
		jmp	short loc_26C5
; ---------------------------------------------------------------------------

loc_26A3:				; CODE XREF: _ssl3_get_client_key_exchange+43Ej
					; _ssl3_get_client_key_exchange+450j ...
		push	93Ch
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0ABh ; '«'
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_26B7:				; CODE XREF: _ssl3_get_client_key_exchange+424j
		push	0
		push	edi
		push	edx
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	edi, eax

loc_26C5:				; CODE XREF: _ssl3_get_client_key_exchange+46Dj
		test	edi, edi
		jnz	short loc_26EC
		push	944h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	82h ; '‚'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_26EC:				; CODE XREF: _ssl3_get_client_key_exchange+493j
		push	[esp+2F8h+Size]
		push	edi
		push	[esp+300h+var_2E8]
		call	_DH_compute_key
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jg	short loc_2729
		push	94Bh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	5
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		push	edi
		call	_BN_clear_free
		add	esp, 18h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_2729:				; CODE XREF: _ssl3_get_client_key_exchange+4CDj
		mov	eax, [esi+58h]
		push	dword ptr [eax+348h]
		call	_DH_free
		mov	eax, [esi+58h]
		add	esp, 4
		mov	dword ptr [eax+348h], 0
		test	ebp, ebp
		jz	short loc_2753
		push	ebp
		call	_DH_free
		jmp	short loc_2759
; ---------------------------------------------------------------------------

loc_2753:				; CODE XREF: _ssl3_get_client_key_exchange+515j
		push	edi
		call	_BN_clear_free

loc_2759:				; CODE XREF: _ssl3_get_client_key_exchange+51Dj
		mov	eax, [esi+8]
		add	esp, 4
		mov	ecx, [eax+64h]
		mov	eax, [esi+0C0h]
		push	ebx
		push	[esp+2FCh+var_2E8]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	ebx
		mov	[ecx+10h], eax
		push	[esp+30Ch+var_2E8]
		call	_OPENSSL_cleanse
		add	esp, 18h
		test	ebp, ebp
		jz	loc_253C
		mov	eax, 2
		jmp	loc_3085
; ---------------------------------------------------------------------------

loc_279F:				; CODE XREF: _ssl3_get_client_key_exchange+329j
		test	cl, 0E0h
		jz	loc_2A6D
		call	_EC_KEY_new
		mov	[esp+2F8h+var_2D4], eax
		test	eax, eax
		jnz	short loc_27D5
		push	0A29h

loc_27BA:				; CODE XREF: _ssl3_get_client_key_exchange+614j
					; _ssl3_get_client_key_exchange+BE6j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_27D5:				; CODE XREF: _ssl3_get_client_key_exchange+57Fj
		test	byte ptr [esp+2F8h+Size], 60h
		jz	short loc_27ED
		mov	eax, [esi+98h]
		mov	eax, [eax+0CCh]
		mov	ebp, [eax+14h]
		jmp	short loc_27F6
; ---------------------------------------------------------------------------

loc_27ED:				; CODE XREF: _ssl3_get_client_key_exchange+5A6j
		mov	eax, [esi+58h]
		mov	ebp, [eax+34Ch]

loc_27F6:				; CODE XREF: _ssl3_get_client_key_exchange+5B7j
		push	ebp
		call	_EC_KEY_get0_group
		push	ebp
		mov	edi, eax
		call	_EC_KEY_get0_private_key
		mov	ebp, eax
		mov	eax, [esp+300h+var_2D4]
		push	edi
		push	eax
		call	_EC_KEY_set_group
		add	esp, 10h
		test	eax, eax
		jz	loc_2A4D
		push	ebp
		mov	ebp, [esp+2FCh+var_2D4]
		push	ebp
		call	_EC_KEY_set_private_key
		add	esp, 8
		test	eax, eax
		jz	loc_2A4D
		push	edi
		call	_EC_POINT_new
		add	esp, 4
		mov	[esp+2F8h+var_2DC], eax
		test	eax, eax
		jnz	short loc_284D
		push	0A44h
		jmp	loc_27BA
; ---------------------------------------------------------------------------

loc_284D:				; CODE XREF: _ssl3_get_client_key_exchange+60Dj
		test	ebx, ebx
		jnz	loc_28EB
		test	byte ptr [esp+2F8h+Size], 80h
		jz	short loc_2870
		push	0A4Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	137h
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_2870:				; CODE XREF: _ssl3_get_client_key_exchange+626j
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+9Ch]
		call	_X509_get_pubkey
		add	esp, 4
		mov	[esp+2F8h+var_2D8], eax
		test	eax, eax
		jz	short loc_28D7
		cmp	dword ptr [eax], 198h
		jnz	short loc_28D7
		push	dword ptr [eax+14h]
		call	_EC_KEY_get0_public_key
		push	eax
		push	[esp+300h+var_2DC]
		call	_EC_POINT_copy
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_28CD
		push	0A64h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10h
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_28CD:				; CODE XREF: _ssl3_get_client_key_exchange+677j
		mov	ebx, 2
		jmp	loc_2984
; ---------------------------------------------------------------------------

loc_28D7:				; CODE XREF: _ssl3_get_client_key_exchange+656j
					; _ssl3_get_client_key_exchange+65Ej
		push	0A5Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	139h
		jmp	loc_302A
; ---------------------------------------------------------------------------

loc_28EB:				; CODE XREF: _ssl3_get_client_key_exchange+61Bj
		call	_BN_CTX_new
		mov	[esp+2F8h+var_2E4], eax
		test	eax, eax
		jnz	short loc_291C
		push	0A6Fh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'

loc_2904:				; CODE XREF: _ssl3_get_client_key_exchange+707j
					; _ssl3_get_client_key_exchange+769j ...
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		mov	ebx, [esp+30Ch+var_2E4]
		add	esp, 14h
		jmp	$err$179
; ---------------------------------------------------------------------------

loc_291C:				; CODE XREF: _ssl3_get_client_key_exchange+6C2j
		mov	ecx, [esp+2F8h+var_2E8]
		movzx	edx, byte ptr [ecx]
		inc	ecx
		mov	[esp+2F8h+var_2E8], ecx
		lea	eax, [edx+1]
		cmp	ebx, eax
		jz	short loc_293D
		push	0A77h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10h
		jmp	short loc_2904
; ---------------------------------------------------------------------------

loc_293D:				; CODE XREF: _ssl3_get_client_key_exchange+6F9j
		mov	ebx, [esp+2F8h+var_2E4]
		push	ebx
		push	edx
		push	ecx
		push	[esp+304h+var_2DC]
		push	edi
		call	_EC_POINT_oct2point
		add	esp, 14h
		test	eax, eax
		jnz	short loc_2975
		push	0A7Bh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10h
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$179
; ---------------------------------------------------------------------------

loc_2975:				; CODE XREF: _ssl3_get_client_key_exchange+71Fj
		mov	eax, [esi+3Ch]
		mov	ebx, 1
		mov	eax, [eax+4]
		mov	[esp+2F8h+var_2E8], eax

loc_2984:				; CODE XREF: _ssl3_get_client_key_exchange+69Ej
		push	edi
		call	_EC_GROUP_get_degree
		add	esp, 4
		test	eax, eax
		jg	short loc_29A2
		push	0A88h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		jmp	loc_2904
; ---------------------------------------------------------------------------

loc_29A2:				; CODE XREF: _ssl3_get_client_key_exchange+75Bj
		add	eax, 7
		cdq
		push	0
		push	ebp
		push	[esp+300h+var_2DC]
		and	edx, 7
		add	eax, edx
		sar	eax, 3
		push	eax
		push	[esp+308h+var_2E8]
		call	_ECDH_compute_key
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jg	short loc_29D9
		push	0A8Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		jmp	loc_2904
; ---------------------------------------------------------------------------

loc_29D9:				; CODE XREF: _ssl3_get_client_key_exchange+792j
		push	[esp+2F8h+var_2D8]
		call	_EVP_PKEY_free
		push	[esp+2FCh+var_2DC]
		call	_EC_POINT_free
		push	ebp
		call	_EC_KEY_free
		push	[esp+304h+var_2E4]
		call	_BN_CTX_free
		mov	eax, [esi+58h]
		push	dword ptr [eax+34Ch]
		call	_EC_KEY_free
		mov	eax, [esi+58h]
		push	edi
		mov	dword ptr [eax+34Ch], 0
		mov	eax, [esi+8]
		push	[esp+310h+var_2E8]
		mov	ecx, [eax+64h]
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	ecx, [ecx+0Ch]
		push	esi
		call	ecx
		mov	ecx, [esi+0C0h]
		push	edi
		mov	[ecx+10h], eax
		push	[esp+320h+var_2E8]
		call	_OPENSSL_cleanse
		add	esp, 2Ch
		mov	eax, ebx
		jmp	loc_3085
; ---------------------------------------------------------------------------

loc_2A4D:				; CODE XREF: _ssl3_get_client_key_exchange+5E2j
					; _ssl3_get_client_key_exchange+5F8j
		push	0A3Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	10h
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_2A6D:				; CODE XREF: _ssl3_get_client_key_exchange+56Ej
		test	ecx, 100h
		jz	loc_2D39
		movzx	ebp, byte ptr [edx]
		mov	edi, 28h ; '('
		movzx	eax, byte ptr [edx+1]
		add	edx, 2
		shl	ebp, 8
		or	ebp, eax
		mov	[esp+2F8h+var_2E4], 1
		mov	[esp+2F8h+var_2E8], edx
		lea	eax, [ebp+2]
		cmp	ebx, eax
		jz	short loc_2AC3
		push	0AB0h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	9Fh ; 'Ÿ'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2AC3:				; CODE XREF: _ssl3_get_client_key_exchange+86Aj
		cmp	ebp, 80h ; '€'
		jle	short loc_2AEE
		push	0AB5h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	92h ; '’'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2AEE:				; CODE XREF: _ssl3_get_client_key_exchange+895j
		mov	ebx, [esi+0E0h]
		test	ebx, ebx
		jnz	short loc_2B1B
		push	0ABAh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0E1h ; 'á'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2B1B:				; CODE XREF: _ssl3_get_client_key_exchange+8C2j
		push	ebp		; Size
		push	edx		; Src
		lea	eax, [esp+300h+Dst]
		push	eax		; Dst
		call	_memcpy
		mov	eax, 81h ; ''
		sub	eax, ebp
		push	eax		; Size
		lea	eax, [esp+308h+Dst]
		add	eax, ebp
		push	0		; Val
		push	eax		; Dst
		call	_memset
		push	204h
		lea	eax, [esp+314h+Src]
		push	eax
		lea	eax, [esp+318h+Dst]
		push	eax
		push	esi
		call	ebx
		mov	ebx, eax
		lea	eax, [esp+320h+Dst]
		push	81h ; ''
		push	eax
		mov	[esp+328h+Size], ebx
		call	_OPENSSL_cleanse
		add	esp, 30h
		cmp	ebx, 100h
		jbe	short loc_2B98
		push	0AC9h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2B98:				; CODE XREF: _ssl3_get_client_key_exchange+942j
		test	ebx, ebx
		jnz	short loc_2BC2
		push	0AD0h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0DFh ; 'ß'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		lea	edi, [ebx+73h]
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2BC2:				; CODE XREF: _ssl3_get_client_key_exchange+966j
		lea	eax, ds:4[ebx*2]
		mov	[esp+2F8h+var_2D0], eax
		lea	eax, [esp+2F8h+Src]
		push	ebx		; Size
		push	eax		; Src
		lea	eax, [esp+300h+var_204]
		add	eax, ebx
		push	eax		; Dst
		call	dword ptr ds:__imp__memmove
		mov	eax, [esp+304h+Size]
		push	eax		; Size
		mov	[esp+308h+var_207], al
		lea	eax, [esp+308h+var_206]
		push	0		; Val
		shr	ebx, 8
		push	eax		; Dst
		mov	[esp+310h+Src],	bl
		call	_memset
		mov	eax, [esp+310h+Size]
		add	esp, 18h
		mov	[esp+eax+2F8h+var_206],	bl
		mov	[esp+eax+2F8h+var_205],	al
		mov	eax, [esi+0C0h]
		mov	eax, [eax+90h]
		test	eax, eax
		jz	short loc_2C39
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2C39:				; CODE XREF: _ssl3_get_client_key_exchange+9FAj
		push	ebp
		push	[esp+2FCh+var_2E8]
		call	_BUF_strndup
		mov	ecx, [esi+0C0h]
		add	esp, 8
		mov	[ecx+90h], eax
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+90h], 0
		jnz	short loc_2C81
		push	0AE2h

loc_2C66:				; CODE XREF: _ssl3_get_client_key_exchange+AA3j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$180
; ---------------------------------------------------------------------------

loc_2C81:				; CODE XREF: _ssl3_get_client_key_exchange+A2Bj
		mov	eax, [eax+8Ch]
		test	eax, eax
		jz	short loc_2C94
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2C94:				; CODE XREF: _ssl3_get_client_key_exchange+A55j
		mov	eax, [esi+0E4h]
		push	dword ptr [eax+14Ch]
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+8Ch], eax
		mov	eax, [esi+0E4h]
		cmp	dword ptr [eax+14Ch], 0
		jz	short loc_2CD9
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+8Ch], 0
		jnz	short loc_2CD9
		push	0AEBh
		jmp	short loc_2C66
; ---------------------------------------------------------------------------

loc_2CD9:				; CODE XREF: _ssl3_get_client_key_exchange+A8Dj
					; _ssl3_get_client_key_exchange+A9Cj
		mov	eax, [esi+8]
		push	[esp+2F8h+var_2D0]
		mov	ecx, [eax+64h]
		lea	eax, [esp+2FCh+Src]
		push	eax
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		add	esp, 10h
		mov	[esp+2F8h+var_2E4], 0
		mov	[ecx+10h], eax

$psk_err$180:				; CODE XREF: _ssl3_get_client_key_exchange+88Aj
					; _ssl3_get_client_key_exchange+8B5j ...
		lea	eax, [esp+2F8h+Src]
		push	204h
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 8
		cmp	[esp+2F8h+var_2E4], 0
		jnz	$f_err$181
		mov	eax, 1
		jmp	loc_3085
; ---------------------------------------------------------------------------

loc_2D39:				; CODE XREF: _ssl3_get_client_key_exchange+83Fj
		test	ecx, 400h
		jz	loc_2E76
		movzx	ecx, byte ptr [edx]
		movzx	eax, byte ptr [edx+1]
		add	edx, 2
		shl	ecx, 8
		or	ecx, eax
		mov	[esp+2F8h+var_2E8], edx
		lea	eax, [ecx+2]
		cmp	eax, ebx
		jle	short loc_2D78
		push	0B05h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	edi, 32h ; '2'
		push	15Bh
		jmp	loc_302F
; ---------------------------------------------------------------------------

loc_2D78:				; CODE XREF: _ssl3_get_client_key_exchange+B29j
		push	0
		push	ecx
		push	edx
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	[esi+1B8h], eax
		test	eax, eax
		jnz	short loc_2DAE
		push	0B09h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	3
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_2DAE:				; CODE XREF: _ssl3_get_client_key_exchange+B58j
		push	dword ptr [esi+1A8h]
		push	eax
		call	_BN_ucmp
		add	esp, 8
		test	eax, eax
		jns	loc_2E5D
		mov	eax, [esi+1B8h]
		cmp	[eax+4], ebp
		jz	loc_2E5D
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0F0h]
		test	eax, eax
		jz	short loc_2DED
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2DED:				; CODE XREF: _ssl3_get_client_key_exchange+BAEj
		push	dword ptr [esi+1A4h]
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+0F0h], eax
		mov	eax, [esi+0C0h]
		cmp	[eax+0F0h], ebp
		jnz	short loc_2E1F
		push	0B17h
		jmp	loc_27BA
; ---------------------------------------------------------------------------

loc_2E1F:				; CODE XREF: _ssl3_get_client_key_exchange+BDFj
		add	eax, 14h
		push	eax
		push	esi
		call	_SRP_generate_server_master_secret
		mov	ecx, [esi+0C0h]
		add	esp, 8
		mov	[ecx+10h], eax
		test	eax, eax
		jns	loc_253C
		push	0B1Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_304A
; ---------------------------------------------------------------------------

loc_2E5D:				; CODE XREF: _ssl3_get_client_key_exchange+B8Bj
					; _ssl3_get_client_key_exchange+B9Aj
		push	0B10h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		mov	edi, 2Fh ; '/'
		push	173h
		jmp	loc_302F
; ---------------------------------------------------------------------------

loc_2E76:				; CODE XREF: _ssl3_get_client_key_exchange+B0Bj
		test	ecx, 200h
		jz	loc_301B
		xor	ebp, ebp
		mov	[esp+2F8h+var_2C4], 20h	; ' '
		mov	ecx, [edi+10h]
		xor	eax, eax
		mov	[esp+2F8h+Size], ebp
		test	ecx, 100h
		jz	short loc_2EAB
		mov	eax, [esi+98h]
		mov	eax, [eax+0E8h]
		jmp	short loc_2EBF
; ---------------------------------------------------------------------------

loc_2EAB:				; CODE XREF: _ssl3_get_client_key_exchange+C67j
		test	ecx, 200h
		jz	short loc_2EBF
		mov	eax, [esi+98h]
		mov	eax, [eax+104h]

loc_2EBF:				; CODE XREF: _ssl3_get_client_key_exchange+C75j
					; _ssl3_get_client_key_exchange+C7Dj
		push	0
		push	eax
		call	_EVP_PKEY_CTX_new
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_2EE4
		push	0B39h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		lea	edi, [eax+50h]
		push	41h ; 'A'
		jmp	loc_302F
; ---------------------------------------------------------------------------

loc_2EE4:				; CODE XREF: _ssl3_get_client_key_exchange+C9Aj
		push	edi
		call	_EVP_PKEY_decrypt_init
		add	esp, 4
		test	eax, eax
		jg	short loc_2F02
		push	0B3Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		jmp	loc_2FF2
; ---------------------------------------------------------------------------

loc_2F02:				; CODE XREF: _ssl3_get_client_key_exchange+CBBj
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+9Ch]
		call	_X509_get_pubkey
		add	esp, 4
		mov	[esp+2F8h+Size], eax
		test	eax, eax
		jz	short loc_2F31
		push	eax
		push	edi
		call	_EVP_PKEY_derive_set_peer
		add	esp, 8
		test	eax, eax
		jg	short loc_2F31
		call	_ERR_clear_error

loc_2F31:				; CODE XREF: _ssl3_get_client_key_exchange+CE8j
					; _ssl3_get_client_key_exchange+CF6j
		push	ebx
		lea	eax, [esp+2FCh+var_2E4]
		push	eax
		lea	eax, [esp+300h+var_2D0]
		push	eax
		lea	eax, [esp+304h+var_2C8]
		push	eax
		lea	eax, [esp+308h+var_2E8]
		push	eax
		call	_ASN1_get_object
		add	esp, 14h
		cmp	eax, 20h ; ' '
		jnz	loc_2FE3
		cmp	[esp+2F8h+var_2D0], 10h
		jnz	loc_2FE3
		cmp	[esp+2F8h+var_2E4], ebp
		jnz	short loc_2FE3
		push	[esp+2F8h+var_2C8]
		lea	eax, [esp+2FCh+var_2C4]
		push	[esp+2FCh+var_2E8]
		push	eax
		lea	eax, [esp+304h+var_2BC]
		push	eax
		push	edi
		call	_EVP_PKEY_decrypt
		add	esp, 14h
		test	eax, eax
		jg	short loc_2F8E
		push	0B59h
		jmp	short loc_2FE8
; ---------------------------------------------------------------------------

loc_2F8E:				; CODE XREF: _ssl3_get_client_key_exchange+D51j
		mov	eax, [esi+8]
		push	20h ; ' '
		mov	ecx, [eax+64h]
		lea	eax, [esp+2FCh+var_2BC]
		push	eax
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	20h ; ' '
		mov	[ecx+10h], eax
		lea	eax, [esp+30Ch+var_2BC]
		push	eax
		call	_OPENSSL_cleanse
		push	0
		push	2
		push	2
		push	0FFFFFFFFh
		push	0FFFFFFFFh
		push	edi
		call	_EVP_PKEY_CTX_ctrl
		xor	ecx, ecx
		add	esp, 30h
		test	eax, eax
		setnle	cl
		inc	ecx
		mov	[esp+2F8h+var_2C0], ecx
		mov	ebp, ecx
		jmp	short $gerr$182
; ---------------------------------------------------------------------------

loc_2FE3:				; CODE XREF: _ssl3_get_client_key_exchange+D1Dj
					; _ssl3_get_client_key_exchange+D28j ...
		push	0B51h

loc_2FE8:				; CODE XREF: _ssl3_get_client_key_exchange+D58j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	93h ; '“'

loc_2FF2:				; CODE XREF: _ssl3_get_client_key_exchange+CC9j
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$gerr$182:				; CODE XREF: _ssl3_get_client_key_exchange+DADj
		push	[esp+2F8h+Size]
		call	_EVP_PKEY_free
		push	edi
		call	_EVP_PKEY_CTX_free
		add	esp, 8
		test	ebp, ebp
		jz	short loc_304A
		mov	eax, ebp
		jmp	short loc_3085
; ---------------------------------------------------------------------------

loc_301B:				; CODE XREF: _ssl3_get_client_key_exchange+C48j
		push	0B72h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0F9h ; 'ù'

loc_302A:				; CODE XREF: _ssl3_get_client_key_exchange+ADj
					; _ssl3_get_client_key_exchange+321j ...
		mov	edi, 28h ; '('

loc_302F:				; CODE XREF: _ssl3_get_client_key_exchange+121j
					; _ssl3_get_client_key_exchange+14Aj ...
		push	8Bh ; '‹'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$f_err$181:				; CODE XREF: _ssl3_get_client_key_exchange+AF5j
		push	edi
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

loc_304A:				; CODE XREF: _ssl3_get_client_key_exchange+160j
					; _ssl3_get_client_key_exchange+39Aj ...
		xor	ebx, ebx

$err$179:				; CODE XREF: _ssl3_get_client_key_exchange+6E3j
					; _ssl3_get_client_key_exchange+73Cj
		push	[esp+2F8h+var_2D8]
		call	_EVP_PKEY_free
		push	[esp+2FCh+var_2DC]
		call	_EC_POINT_free
		mov	eax, [esp+300h+var_2D4]
		add	esp, 8
		test	eax, eax
		jz	short loc_3072
		push	eax
		call	_EC_KEY_free
		add	esp, 4

loc_3072:				; CODE XREF: _ssl3_get_client_key_exchange+E33j
		push	ebx
		call	_BN_CTX_free
		add	esp, 4
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh

loc_3085:				; CODE XREF: _ssl3_get_client_key_exchange+30Dj
					; _ssl3_get_client_key_exchange+566j ...
		pop	edi

loc_3086:				; CODE XREF: _ssl3_get_client_key_exchange+5Ej
		mov	ecx, [esp+2F4h+var_4]
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2E8h
		retn
_ssl3_get_client_key_exchange endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_next_proto
_ssl3_get_next_proto proc near		; CODE XREF: _ssl3_accept+7FAp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+41Ch], 0
		jnz	short loc_30DB
		push	0DDFh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	164h

loc_30C0:				; CODE XREF: _ssl3_get_next_proto+85j
		push	132h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_30DB:				; CODE XREF: _ssl3_get_next_proto+Fj
		mov	eax, [esi+8]
		lea	ecx, [esp+4+arg_0]
		push	ecx
		push	202h
		push	43h ; 'C'
		mov	eax, [eax+30h]
		push	2211h
		push	2210h
		push	esi
		call	eax
		add	esp, 18h
		mov	ecx, eax
		cmp	[esp+4+arg_0], 0
		jz	loc_31B9
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+180h], 0
		jnz	short loc_3127
		push	0DF3h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	163h
		jmp	short loc_30C0
; ---------------------------------------------------------------------------

loc_3127:				; CODE XREF: _ssl3_get_next_proto+74j
		cmp	ecx, 2
		jge	short loc_3137
		mov	dword ptr [esi+34h], 5
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3137:				; CODE XREF: _ssl3_get_next_proto+8Aj
		mov	ecx, [esi+44h]
		push	ebx
		push	edi
		mov	edi, [esi+40h]
		movzx	ebx, byte ptr [edi]
		lea	eax, [ebx+2]
		cmp	eax, ecx
		jg	short loc_3191
		movzx	eax, byte ptr [ebx+edi+1]
		add	eax, 2
		add	eax, ebx
		cmp	eax, ecx
		jnz	short loc_3191
		push	0E11h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, eax
		add	esp, 0Ch
		mov	[esi+174h], ecx
		test	ecx, ecx
		jnz	short loc_319E
		push	0E13h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	132h
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_3191:				; CODE XREF: _ssl3_get_next_proto+A7j
					; _ssl3_get_next_proto+B5j
		pop	edi
		pop	ebx
		mov	dword ptr [esi+34h], 5
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_319E:				; CODE XREF: _ssl3_get_next_proto+D4j
		push	ebx		; Size
		lea	eax, [edi+1]
		push	eax		; Src
		push	ecx		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	[esi+178h], bl
		mov	eax, 1
		pop	edi
		pop	ebx

loc_31B9:				; CODE XREF: _ssl3_get_next_proto+64j
		pop	esi
		retn
_ssl3_get_next_proto endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 31BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_cert_status
_ssl3_send_cert_status proc near	; CODE XREF: _ssl3_accept+6D5p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+34h], 2200h
		jnz	loc_3282
		mov	eax, [esi+13Ch]
		add	eax, 8
		push	eax
		push	dword ptr [esi+3Ch]
		call	_BUF_MEM_grow
		add	esp, 8
		test	eax, eax
		jnz	short loc_31F3
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_31F3:				; CODE XREF: _ssl3_send_cert_status+29j
		mov	eax, [esi+3Ch]
		mov	ecx, [eax+4]
		mov	byte ptr [ecx],	16h
		mov	eax, [esi+13Ch]
		add	eax, 4
		sar	eax, 10h
		mov	[ecx+1], al
		mov	eax, [esi+13Ch]
		add	eax, 4
		sar	eax, 8
		mov	[ecx+2], al
		movzx	eax, byte ptr [esi+13Ch]
		add	al, 4
		mov	[ecx+3], al
		movzx	eax, byte ptr [esi+128h]
		mov	[ecx+4], al
		movzx	eax, byte ptr [esi+13Eh]
		mov	[ecx+5], al
		mov	eax, [esi+13Ch]
		sar	eax, 8
		mov	[ecx+6], al
		movzx	eax, byte ptr [esi+13Ch]
		mov	[ecx+7], al
		lea	eax, [ecx+8]
		push	dword ptr [esi+13Ch] ; Size
		push	dword ptr [esi+138h] ; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esi+13Ch]
		add	esp, 0Ch
		add	eax, 8
		mov	dword ptr [esi+34h], 2201h
		mov	[esi+44h], eax
		mov	dword ptr [esi+48h], 0

loc_3282:				; CODE XREF: _ssl3_send_cert_status+Cj
		push	16h
		push	esi
		call	_ssl3_do_write
		add	esp, 8
		pop	esi
		retn
_ssl3_send_cert_status endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3290h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_certificate_request
_ssl3_send_certificate_request proc near ; CODE	XREF: _ssl3_accept+41Fp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Src		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 18h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+28h+arg_0]
		cmp	dword ptr [edi+34h], 2160h
		jnz	loc_3541
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		mov	[esp+28h+var_C], ecx
		mov	eax, [eax+64h]
		mov	eax, [eax+3Ch]
		add	eax, [ecx+4]
		mov	esi, eax
		inc	eax
		push	eax
		push	edi
		mov	[esp+30h+arg_0], eax
		call	_ssl3_get_req_cert_type
		mov	[esi], al
		add	esp, 8
		mov	edx, [esp+28h+arg_0]
		mov	ecx, [edi+8]
		add	edx, eax
		mov	[esp+28h+arg_0], edx
		inc	eax
		mov	[esp+28h+var_18], eax
		mov	ecx, [ecx+64h]
		test	byte ptr [ecx+38h], 2
		jz	short loc_3337
		lea	eax, [esp+28h+Src]
		push	eax
		push	edi
		call	_tls12_get_psigalgs
		mov	ecx, [esp+30h+arg_0]
		mov	ebx, eax
		mov	edx, ebx
		sar	edx, 8
		push	ebx		; Size
		mov	[ecx], dl
		mov	ecx, [esp+34h+arg_0]
		mov	[ecx+1], bl
		mov	ecx, [esp+34h+arg_0]
		push	[esp+34h+Src]	; Src
		add	ecx, 2
		push	ecx		; Dst
		mov	[esp+3Ch+arg_0], ecx
		call	_memcpy
		mov	eax, [esp+3Ch+var_18]
		add	esp, 14h
		mov	edx, [esp+28h+arg_0]
		add	eax, 2
		add	edx, ebx
		add	eax, ebx

loc_3337:				; CODE XREF: _ssl3_send_certificate_request+5Ej
		mov	[esp+28h+var_4], eax
		add	edx, 2
		add	eax, 2
		mov	[esp+28h+arg_0], edx
		push	edi
		mov	[esp+2Ch+var_18], eax
		call	_SSL_get_client_CA_list
		mov	ebp, eax
		mov	[esp+2Ch+var_14], 0
		add	esp, 4
		mov	[esp+28h+var_8], ebp
		test	ebp, ebp
		jz	loc_3466
		xor	ebx, ebx
		push	ebp
		mov	[esp+2Ch+Src], ebx
		call	_sk_num
		mov	esi, [esp+2Ch+var_18]
		add	esp, 4
		test	eax, eax
		jle	loc_346A

loc_3383:				; CODE XREF: _ssl3_send_certificate_request+1C7j
		push	ebx
		push	ebp
		call	_sk_value
		push	0
		push	eax
		mov	[esp+38h+var_18], eax
		call	_i2d_X509_NAME
		mov	ecx, [edi+8]
		mov	ebx, eax
		mov	ecx, [ecx+64h]
		mov	ecx, [ecx+3Ch]
		add	ecx, 2
		add	ecx, ebx
		add	ecx, esi
		push	ecx
		push	[esp+3Ch+var_C]
		call	_BUF_MEM_grow_clean
		add	esp, 18h
		test	eax, eax
		jz	loc_345F
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		mov	eax, [eax+64h]
		mov	ebp, [eax+3Ch]
		add	ebp, [ecx+4]
		add	ebp, esi
		test	dword ptr [edi+100h], 20000000h
		mov	[esp+28h+arg_0], ebp
		jnz	short loc_3417
		mov	eax, ebx
		sar	eax, 8
		mov	[ebp+0], al
		mov	eax, [esp+28h+arg_0]
		mov	[eax+1], bl
		lea	eax, [esp+28h+arg_0]
		add	[esp+28h+arg_0], 2
		push	eax
		push	[esp+2Ch+var_18]
		call	_i2d_X509_NAME
		mov	eax, [esp+30h+var_14]
		add	esi, 2
		add	eax, 2
		add	esp, 8
		add	esi, ebx
		add	eax, ebx
		mov	[esp+28h+var_14], eax
		jmp	short loc_343F
; ---------------------------------------------------------------------------

loc_3417:				; CODE XREF: _ssl3_send_certificate_request+14Cj
		lea	eax, [esp+28h+arg_0]
		push	eax
		push	[esp+2Ch+var_18]
		call	_i2d_X509_NAME
		sub	ebx, 2
		add	esp, 8
		mov	eax, ebx
		mov	[ebp+1], bl
		add	ebx, 2
		sar	eax, 8
		add	esi, ebx
		mov	[ebp+0], al
		add	[esp+28h+var_14], ebx

loc_343F:				; CODE XREF: _ssl3_send_certificate_request+185j
		mov	ebx, [esp+28h+Src]
		mov	ebp, [esp+28h+var_8]
		inc	ebx
		push	ebp
		mov	[esp+2Ch+Src], ebx
		call	_sk_num
		add	esp, 4
		cmp	ebx, eax
		jl	loc_3383
		jmp	short loc_346A
; ---------------------------------------------------------------------------

loc_345F:				; CODE XREF: _ssl3_send_certificate_request+127j
		push	81Ah
		jmp	short loc_34D6
; ---------------------------------------------------------------------------

loc_3466:				; CODE XREF: _ssl3_send_certificate_request+D2j
		mov	esi, [esp+28h+var_18]

loc_346A:				; CODE XREF: _ssl3_send_certificate_request+EDj
					; _ssl3_send_certificate_request+1CDj
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		push	esi
		push	0Dh
		mov	eax, [eax+64h]
		push	edi
		mov	edx, [eax+3Ch]
		add	edx, [ecx+4]
		add	edx, [esp+34h+var_4]
		mov	ecx, [esp+34h+var_14]
		mov	eax, ecx
		mov	[esp+34h+arg_0], edx
		sar	eax, 8
		mov	[edx], al
		mov	eax, [esp+34h+arg_0]
		mov	[eax+1], cl
		mov	eax, [edi+8]
		add	[esp+34h+arg_0], 2
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		mov	eax, [edi+8]
		add	esp, 0Ch
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jnz	loc_353A
		mov	eax, [edi+44h]
		add	eax, 4
		push	eax
		push	[esp+2Ch+var_C]
		call	_BUF_MEM_grow_clean
		add	esp, 8
		test	eax, eax
		jnz	short loc_34FE
		push	837h

loc_34D6:				; CODE XREF: _ssl3_send_certificate_request+1D4j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	7
		push	96h ; '–'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err$23:
		mov	dword ptr [edi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_34FE:				; CODE XREF: _ssl3_send_certificate_request+23Fj
		mov	eax, [edi+3Ch]
		mov	eax, [eax+4]
		add	eax, [edi+44h]
		mov	[esp+28h+arg_0], eax
		mov	byte ptr [eax],	0Eh
		mov	eax, [esp+28h+arg_0]
		inc	eax
		mov	[esp+28h+arg_0], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+28h+arg_0]
		inc	eax
		mov	[esp+28h+arg_0], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+28h+arg_0]
		inc	eax
		mov	[esp+28h+arg_0], eax
		mov	byte ptr [eax],	0
		inc	[esp+28h+arg_0]
		add	dword ptr [edi+44h], 4

loc_353A:				; CODE XREF: _ssl3_send_certificate_request+224j
		mov	dword ptr [edi+34h], 2161h

loc_3541:				; CODE XREF: _ssl3_send_certificate_request+19j
		mov	eax, [edi+8]
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
_ssl3_send_certificate_request endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3558h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_hello_request
_ssl3_send_hello_request proc near	; CODE XREF: _ssl3_accept+1B6p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+34h], 2120h
		jnz	short loc_3580
		mov	eax, [esi+8]
		push	0
		push	0
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 2121h

loc_3580:				; CODE XREF: _ssl3_send_hello_request+Cj
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	esi
		retn
_ssl3_send_hello_request endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3594h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_newsession_ticket
_ssl3_send_newsession_ticket proc near	; CODE XREF: _ssl3_accept+6AFp

Dst		= dword	ptr -198h
var_194		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= dword	ptr -18Ch
var_188		= dword	ptr -188h
var_184		= dword	ptr -184h
var_180		= byte ptr -180h
var_F4		= byte ptr -0F4h
Src		= byte ptr -24h
var_14		= xmmword ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 198h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+198h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+1A8h+arg_0]
		cmp	dword ptr [edi+34h], 21F0h
		jnz	loc_398A
		mov	eax, [edi+170h]
		push	0
		push	dword ptr [edi+0C0h]
		mov	[esp+1B0h+var_188], eax
		call	_i2d_SSL_SESSION
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_39DB
		cmp	ebx, 0FF00h
		jg	loc_39DB
		push	0D2Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	loc_39DB
		lea	eax, [esp+1A8h+var_180]
		push	eax
		call	_EVP_CIPHER_CTX_init
		lea	eax, [esp+1ACh+var_F4]
		push	eax
		call	_HMAC_CTX_init
		lea	eax, [esp+1B0h+Dst]
		mov	[esp+1B0h+Dst],	ebp
		push	eax
		push	dword ptr [edi+0C0h]
		call	_i2d_SSL_SESSION
		add	esp, 10h
		test	eax, eax
		jz	$err$34
		push	ebx
		lea	eax, [esp+1ACh+var_18C]
		mov	[esp+1ACh+var_18C], ebp
		push	eax
		push	0
		call	_d2i_SSL_SESSION
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	$err$34
		push	0
		push	esi
		mov	dword ptr [esi+44h], 0
		call	_i2d_SSL_SESSION
		add	esp, 8
		mov	[esp+1A8h+var_190], eax
		test	eax, eax
		jz	loc_39B2
		cmp	eax, ebx
		jg	loc_39B2
		lea	eax, [esp+1A8h+Dst]
		mov	[esp+1A8h+Dst],	ebp
		push	eax
		push	esi
		call	_i2d_SSL_SESSION
		add	esp, 8
		push	esi
		test	eax, eax
		jz	loc_39B3
		call	_SSL_SESSION_free
		mov	eax, [edi+8]
		mov	ecx, [esp+1ACh+var_190]
		add	ecx, 86h ; '†'
		mov	eax, [eax+64h]
		mov	eax, [eax+3Ch]
		add	eax, ecx
		push	eax
		push	dword ptr [edi+3Ch]
		call	_BUF_MEM_grow
		add	esp, 0Ch
		test	eax, eax
		jz	$err$34
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		mov	ebx, [esp+1A8h+var_188]
		mov	eax, [eax+64h]
		mov	eax, [eax+3Ch]
		add	eax, [ecx+4]
		mov	[esp+1A8h+Dst],	eax
		mov	eax, [ebx+138h]
		test	eax, eax
		jz	short loc_3724
		push	1
		lea	ecx, [esp+1ACh+var_F4]
		push	ecx
		lea	ecx, [esp+1B0h+var_180]
		push	ecx
		lea	ecx, [esp+1B4h+Src]
		push	ecx
		lea	ecx, [esp+1B8h+var_14]
		push	ecx
		push	edi
		call	eax
		add	esp, 18h
		test	eax, eax
		js	$err$34
		jmp	short loc_37A2
; ---------------------------------------------------------------------------

loc_3724:				; CODE XREF: _ssl3_send_newsession_ticket+15Fj
		lea	eax, [esp+1A8h+Src]
		push	10h
		push	eax
		call	_RAND_bytes
		add	esp, 8
		test	eax, eax
		jle	$err$34
		lea	eax, [esp+1A8h+Src]
		push	eax
		lea	eax, [ebx+128h]
		push	eax
		push	0
		call	_EVP_aes_128_cbc
		push	eax
		lea	eax, [esp+1B8h+var_180]
		push	eax
		call	_EVP_EncryptInit_ex
		add	esp, 14h
		test	eax, eax
		jz	$err$34
		push	0
		call	_EVP_sha256
		push	eax
		push	10h
		lea	eax, [ebx+118h]
		push	eax
		lea	eax, [esp+1B8h+var_F4]
		push	eax
		call	_HMAC_Init_ex
		add	esp, 14h
		test	eax, eax
		jz	$err$34
		movups	xmm0, xmmword ptr [ebx+108h]
		movups	[esp+1A8h+var_14], xmm0

loc_37A2:				; CODE XREF: _ssl3_send_newsession_ticket+18Ej
		cmp	dword ptr [edi+6Ch], 0
		jz	short loc_37AC
		xor	ecx, ecx
		jmp	short loc_37B8
; ---------------------------------------------------------------------------

loc_37AC:				; CODE XREF: _ssl3_send_newsession_ticket+212j
		mov	eax, [edi+0C0h]
		mov	ecx, [eax+0A8h]

loc_37B8:				; CODE XREF: _ssl3_send_newsession_ticket+216j
		mov	eax, [esp+1A8h+Dst]
		sar	ecx, 18h
		mov	[eax], cl
		mov	ecx, [esp+1A8h+Dst]
		inc	ecx
		cmp	dword ptr [edi+6Ch], 0
		mov	[esp+1A8h+Dst],	ecx
		jz	short loc_37D4
		xor	eax, eax
		jmp	short loc_37E0
; ---------------------------------------------------------------------------

loc_37D4:				; CODE XREF: _ssl3_send_newsession_ticket+23Aj
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0A8h]

loc_37E0:				; CODE XREF: _ssl3_send_newsession_ticket+23Ej
		sar	eax, 10h
		mov	[ecx], al
		mov	ecx, [esp+1A8h+Dst]
		inc	ecx
		cmp	dword ptr [edi+6Ch], 0
		mov	[esp+1A8h+Dst],	ecx
		jz	short loc_37F8
		xor	eax, eax
		jmp	short loc_3804
; ---------------------------------------------------------------------------

loc_37F8:				; CODE XREF: _ssl3_send_newsession_ticket+25Ej
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0A8h]

loc_3804:				; CODE XREF: _ssl3_send_newsession_ticket+262j
		sar	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+1A8h+Dst]
		inc	ecx
		cmp	dword ptr [edi+6Ch], 0
		mov	[esp+1A8h+Dst],	ecx
		jz	short loc_381C
		xor	eax, eax
		jmp	short loc_3828
; ---------------------------------------------------------------------------

loc_381C:				; CODE XREF: _ssl3_send_newsession_ticket+282j
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0A8h]

loc_3828:				; CODE XREF: _ssl3_send_newsession_ticket+286j
		mov	[ecx], al
		lea	eax, [esp+1A8h+var_180]
		mov	esi, [esp+1A8h+Dst]
		movups	xmm0, [esp+1A8h+var_14]
		add	esi, 3
		mov	[esp+1A8h+Dst],	esi
		push	eax
		movups	xmmword	ptr [esi], xmm0
		add	[esp+1ACh+Dst],	10h
		call	_EVP_CIPHER_CTX_iv_length
		push	eax		; Size
		lea	eax, [esp+1B0h+Src]
		push	eax		; Src
		push	[esp+1B4h+Dst]	; Dst
		call	_memcpy
		lea	eax, [esp+1B8h+var_180]
		push	eax
		call	_EVP_CIPHER_CTX_iv_length
		push	[esp+1BCh+var_190]
		mov	ecx, [esp+1C0h+Dst]
		add	ecx, eax
		lea	eax, [esp+1C0h+var_194]
		push	ebp
		push	eax
		push	ecx
		lea	eax, [esp+1CCh+var_180]
		mov	[esp+1CCh+Dst],	ecx
		push	eax
		call	_EVP_EncryptUpdate
		add	esp, 28h
		test	eax, eax
		jz	$err$34
		mov	eax, [esp+1A8h+Dst]
		lea	ecx, [esp+1A8h+var_194]
		add	eax, [esp+1A8h+var_194]
		push	ecx
		push	eax
		mov	[esp+1B0h+Dst],	eax
		lea	eax, [esp+1B0h+var_180]
		push	eax
		call	_EVP_EncryptFinal
		add	esp, 0Ch
		test	eax, eax
		jz	$err$34
		mov	eax, [esp+1A8h+Dst]
		add	eax, [esp+1A8h+var_194]
		mov	[esp+1A8h+Dst],	eax
		sub	eax, esi
		push	eax
		lea	eax, [esp+1ACh+var_F4]
		push	esi
		push	eax
		call	_HMAC_Update
		add	esp, 0Ch
		test	eax, eax
		jz	$err$34
		lea	eax, [esp+1A8h+var_184]
		push	eax
		push	[esp+1ACh+Dst]
		lea	eax, [esp+1B0h+var_F4]
		push	eax
		call	_HMAC_Final
		add	esp, 0Ch
		test	eax, eax
		jz	$err$34
		lea	eax, [esp+1A8h+var_180]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		lea	eax, [esp+1ACh+var_F4]
		push	eax
		call	_HMAC_CTX_cleanup
		mov	esi, [esp+1B0h+Dst]
		mov	ecx, [edi+8]
		add	esi, [esp+1B0h+var_184]
		mov	edx, [edi+3Ch]
		mov	[esp+1B0h+Dst],	esi
		mov	eax, [ecx+64h]
		sub	esi, [eax+3Ch]
		sub	esi, [edx+4]
		mov	[esp+1B0h+var_194], esi
		mov	eax, [ecx+64h]
		mov	ecx, [eax+3Ch]
		mov	eax, [edx+4]
		add	eax, 4
		add	ecx, eax
		lea	eax, [esi-6]
		mov	[esp+1B0h+Dst],	ecx
		sar	eax, 8
		mov	[ecx], al
		mov	eax, [esp+1B0h+Dst]
		mov	cl, byte ptr [esp+1B0h+var_194]
		sub	cl, 6
		mov	[eax+1], cl
		mov	eax, [edi+8]
		add	[esp+1B0h+Dst],	2
		push	[esp+1B0h+var_194]
		mov	eax, [eax+64h]
		push	4
		push	edi
		mov	eax, [eax+40h]
		call	eax
		push	ebp
		mov	dword ptr [edi+34h], 21F1h
		call	_CRYPTO_free
		add	esp, 18h

loc_398A:				; CODE XREF: _ssl3_send_newsession_ticket+2Aj
		mov	eax, [edi+8]
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4

loc_3999:				; CODE XREF: _ssl3_send_newsession_ticket+451j
		mov	ecx, [esp+1A8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 198h
		retn
; ---------------------------------------------------------------------------

loc_39B2:				; CODE XREF: _ssl3_send_newsession_ticket+E9j
					; _ssl3_send_newsession_ticket+F1j
		push	esi

loc_39B3:				; CODE XREF: _ssl3_send_newsession_ticket+10Cj
		call	_SSL_SESSION_free
		add	esp, 4

$err$34:				; CODE XREF: _ssl3_send_newsession_ticket+ADj
					; _ssl3_send_newsession_ticket+CBj ...
		push	ebp
		call	_CRYPTO_free
		lea	eax, [esp+1ACh+var_180]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		lea	eax, [esp+1B0h+var_F4]
		push	eax
		call	_HMAC_CTX_cleanup
		add	esp, 0Ch

loc_39DB:				; CODE XREF: _ssl3_send_newsession_ticket+4Ej
					; _ssl3_send_newsession_ticket+5Aj ...
		mov	dword ptr [edi+34h], 5
		or	eax, 0FFFFFFFFh
		jmp	short loc_3999
_ssl3_send_newsession_ticket endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 39E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_server_certificate
_ssl3_send_server_certificate proc near	; CODE XREF: _ssl3_accept+2C4p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+34h], 2140h
		jnz	short loc_3A5A
		push	esi
		call	_ssl_get_server_send_pkey
		add	esp, 4
		test	eax, eax
		jnz	short loc_3A3E
		mov	ecx, [esi+58h]
		mov	ecx, [ecx+344h]
		cmp	dword ptr [ecx+10h], 20h ; ' '
		jnz	short loc_3A18
		test	byte ptr [ecx+0Ch], 10h
		jz	short loc_3A3E

loc_3A18:				; CODE XREF: _ssl3_send_server_certificate+28j
		push	0CFFh

loc_3A1D:				; CODE XREF: _ssl3_send_server_certificate+69j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	9Ah ; 'š'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	dword ptr [esi+34h], 5
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3A3E:				; CODE XREF: _ssl3_send_server_certificate+19j
					; _ssl3_send_server_certificate+2Ej
		push	eax
		push	esi
		call	_ssl3_output_cert_chain
		add	esp, 8
		test	eax, eax
		jnz	short loc_3A53
		push	0D06h
		jmp	short loc_3A1D
; ---------------------------------------------------------------------------

loc_3A53:				; CODE XREF: _ssl3_send_server_certificate+62j
		mov	dword ptr [esi+34h], 2141h

loc_3A5A:				; CODE XREF: _ssl3_send_server_certificate+Cj
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	esi
		retn
_ssl3_send_server_certificate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3A6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_server_done
_ssl3_send_server_done proc near	; CODE XREF: _ssl3_accept+495p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+34h], 2170h
		jnz	short loc_3A94
		mov	eax, [esi+8]
		push	0
		push	0Eh
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 2171h

loc_3A94:				; CODE XREF: _ssl3_send_server_done+Cj
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	esi
		retn
_ssl3_send_server_done endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3AA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_server_hello
_ssl3_send_server_hello	proc near	; CODE XREF: _ssl3_accept+25Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		mov	[esp+14h+var_4], 0
		cmp	dword ptr [esi+34h], 2130h
		jnz	loc_3C32
		mov	eax, [esi+3Ch]
		mov	ebp, [eax+4]
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		mov	edi, [eax+3Ch]
		mov	eax, [esi]
		add	edi, ebp
		sar	eax, 8
		mov	[esp+14h+arg_0], edi
		mov	[edi], al
		mov	al, [esi]
		mov	[edi+1], al
		mov	eax, [esi+58h]
		movups	xmm0, xmmword ptr [eax+0A0h]
		movups	xmmword	ptr [edi+2], xmm0
		movups	xmm0, xmmword ptr [eax+0B0h]
		movups	xmmword	ptr [edi+12h], xmm0
		mov	eax, [esi+0E4h]
		test	byte ptr [eax+20h], 2
		jnz	short loc_3B28
		cmp	dword ptr [esi+6Ch], 0
		jnz	short loc_3B28
		mov	eax, [esi+0C0h]
		mov	dword ptr [eax+44h], 0

loc_3B28:				; CODE XREF: _ssl3_send_server_hello+6Bj
					; _ssl3_send_server_hello+71j
		mov	eax, [esi+0C0h]
		mov	ebx, [eax+44h]
		cmp	ebx, 20h ; ' '
		jle	short loc_3B61
		push	5FFh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'

loc_3B42:				; CODE XREF: _ssl3_send_server_hello+118j
		push	0F2h ; 'ò'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3B61:				; CODE XREF: _ssl3_send_server_hello+8Cj
		mov	[edi+22h], bl
		add	edi, 23h ; '#'
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		add	eax, 48h ; 'H'
		push	eax		; Src
		push	edi		; Dst
		call	_memcpy
		mov	eax, [esi+58h]
		add	edi, ebx
		push	edi
		push	dword ptr [eax+344h]
		call	_ssl3_put_cipher_by_char
		add	edi, eax
		add	esp, 14h
		mov	eax, [esi+58h]
		mov	eax, [eax+38Ch]
		test	eax, eax
		jnz	short loc_3B9F
		mov	[edi], al
		jmp	short loc_3BA3
; ---------------------------------------------------------------------------

loc_3B9F:				; CODE XREF: _ssl3_send_server_hello+F1j
		mov	al, [eax]
		mov	[edi], al

loc_3BA3:				; CODE XREF: _ssl3_send_server_hello+F5j
		push	esi
		inc	edi
		call	_ssl_prepare_serverhello_tlsext
		add	esp, 4
		test	eax, eax
		jg	short loc_3BC2
		push	616h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	113h
		jmp	short loc_3B42
; ---------------------------------------------------------------------------

loc_3BC2:				; CODE XREF: _ssl3_send_server_hello+107j
		lea	eax, [esp+14h+var_4]
		push	eax
		lea	eax, [ebp+4000h]
		push	eax
		push	edi
		push	esi
		call	_ssl_add_serverhello_tlsext
		mov	ecx, eax
		add	esp, 10h
		test	ecx, ecx
		jnz	short loc_3C15
		push	[esp+14h+var_4]
		push	2
		push	esi
		call	_ssl3_send_alert
		push	61Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	0F2h ; 'ò'
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3C15:				; CODE XREF: _ssl3_send_server_hello+134j
		mov	eax, [esi+8]
		sub	ecx, [esp+14h+arg_0]
		push	ecx
		push	2
		mov	eax, [eax+64h]
		push	esi
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 2131h

loc_3C32:				; CODE XREF: _ssl3_send_server_hello+21j
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_ssl3_send_server_hello	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3C48h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_server_key_exchange
_ssl3_send_server_key_exchange proc near ; CODE	XREF: _ssl3_accept+3ABp

var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
Src		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_48		= xmmword ptr -48h
var_38		= dword	ptr -38h
var_30		= byte ptr -30h
var_28		= byte ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 8Ch ; 'Œ'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		push	ebx
		xor	eax, eax
		mov	[esp+90h+Src], 0
		push	ebp
		push	esi
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+var_7C], eax
		mov	[esp+98h+var_78], eax
		mov	[esp+98h+var_64], eax
		lea	eax, [esp+98h+var_60]
		push	edi
		mov	edi, [esp+9Ch+arg_0]
		push	eax
		call	_EVP_MD_CTX_init
		add	esp, 4
		cmp	dword ptr [edi+34h], 2150h
		jnz	loc_451B
		mov	eax, [edi+58h]
		xor	ebx, ebx
		mov	edx, [edi+3Ch]
		mov	ebp, [edi+98h]
		mov	[esp+9Ch+var_74], edx
		mov	eax, [eax+344h]
		mov	dword ptr [esp+9Ch+var_48+0Ch],	0
		mov	dword ptr [esp+9Ch+var_48+8], 0
		mov	dword ptr [esp+9Ch+var_48+4], 0
		mov	ecx, [eax+0Ch]
		mov	[esp+9Ch+var_88], ecx
		mov	dword ptr [esp+9Ch+var_48], 0
		test	cl, 1
		jz	loc_3D6D
		mov	esi, [ebp+1Ch]
		test	esi, esi
		jnz	short loc_3D39
		mov	edx, [ebp+20h]
		test	edx, edx
		jz	short loc_3D59
		mov	ecx, [eax+20h]
		mov	esi, 200h
		test	cl, 8
		mov	eax, 400h
		cmovnz	eax, esi
		and	ecx, 2
		push	eax
		push	ecx
		push	edi
		call	edx
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_3D2D
		push	66Dh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	11Ah
		jmp	loc_46B8
; ---------------------------------------------------------------------------

loc_3D2D:				; CODE XREF: _ssl3_send_server_key_exchange+CFj
		push	esi
		call	_RSA_up_ref
		add	esp, 4
		mov	[ebp+1Ch], esi

loc_3D39:				; CODE XREF: _ssl3_send_server_key_exchange+A4j
		mov	eax, [esi+10h]
		mov	dword ptr [esp+9Ch+var_48], eax
		mov	eax, [esi+14h]
		mov	dword ptr [esp+9Ch+var_48+4], eax
		mov	eax, [edi+58h]
		mov	dword ptr [eax+370h], 1
		jmp	loc_417D
; ---------------------------------------------------------------------------

loc_3D59:				; CODE XREF: _ssl3_send_server_key_exchange+ABj
		push	676h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0ACh ; '¬'
		jmp	loc_46B8
; ---------------------------------------------------------------------------

loc_3D6D:				; CODE XREF: _ssl3_send_server_key_exchange+99j
		test	cl, 8
		jz	loc_3E4D
		mov	ecx, [ebp+24h]
		test	ecx, ecx
		jnz	short loc_3DBC
		mov	edx, [ebp+28h]
		test	edx, edx
		jz	short loc_3DA8
		mov	ecx, [eax+20h]
		mov	esi, 200h
		test	cl, 8
		mov	eax, 400h
		cmovnz	eax, esi
		and	ecx, 2
		push	eax
		push	ecx
		push	edi
		call	edx
		mov	ecx, eax
		add	esp, 0Ch
		test	ecx, ecx
		jnz	short loc_3DBC

loc_3DA8:				; CODE XREF: _ssl3_send_server_key_exchange+13Aj
		push	68Ah
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0ABh ; '«'
		jmp	loc_46B8
; ---------------------------------------------------------------------------

loc_3DBC:				; CODE XREF: _ssl3_send_server_key_exchange+133j
					; _ssl3_send_server_key_exchange+15Ej
		mov	eax, [edi+58h]
		cmp	[eax+348h], ebx
		jz	short loc_3DE7
		push	690h

loc_3DCC:				; CODE XREF: _ssl3_send_server_key_exchange+282j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	44h ; 'D'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_3DE7:				; CODE XREF: _ssl3_send_server_key_exchange+17Dj
		push	ecx
		call	_DHparams_dup
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_3E16
		push	695h

loc_3DFB:				; CODE XREF: _ssl3_send_server_key_exchange+1E9j
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	5
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_3E16:				; CODE XREF: _ssl3_send_server_key_exchange+1ACj
		mov	eax, [edi+58h]
		push	esi
		mov	[eax+348h], esi
		call	_DH_generate_key
		add	esp, 4
		test	eax, eax
		jnz	short loc_3E33
		push	69Bh
		jmp	short loc_3DFB
; ---------------------------------------------------------------------------

loc_3E33:				; CODE XREF: _ssl3_send_server_key_exchange+1E2j
		mov	eax, [esi+8]
		mov	dword ptr [esp+9Ch+var_48], eax
		mov	eax, [esi+0Ch]
		mov	dword ptr [esp+9Ch+var_48+4], eax
		mov	eax, [esi+14h]
		mov	dword ptr [esp+9Ch+var_48+8], eax
		jmp	loc_417D
; ---------------------------------------------------------------------------

loc_3E4D:				; CODE XREF: _ssl3_send_server_key_exchange+128j
		test	cl, cl
		jns	loc_4104
		mov	esi, [ebp+2Ch]
		cmp	[ebp+34h], ebx
		jz	short loc_3E77
		push	0FFFFFFFEh
		push	edi
		call	_tls1_shared_curve
		add	esp, 8
		test	eax, eax
		jz	short loc_3EA2
		push	eax
		call	_EC_KEY_new_by_curve_name
		add	esp, 4
		jmp	short loc_3EA0
; ---------------------------------------------------------------------------

loc_3E77:				; CODE XREF: _ssl3_send_server_key_exchange+213j
		test	esi, esi
		jnz	short loc_3EBA
		mov	edx, [ebp+30h]
		test	edx, edx
		jz	short loc_3EA6
		mov	ecx, [eax+20h]
		mov	esi, 200h
		test	cl, 8
		mov	eax, 400h
		cmovnz	eax, esi
		and	ecx, 2
		push	eax
		push	ecx
		push	edi
		call	edx
		add	esp, 0Ch

loc_3EA0:				; CODE XREF: _ssl3_send_server_key_exchange+22Dj
		mov	esi, eax

loc_3EA2:				; CODE XREF: _ssl3_send_server_key_exchange+222j
		test	esi, esi
		jnz	short loc_3EBA

loc_3EA6:				; CODE XREF: _ssl3_send_server_key_exchange+238j
		push	6B7h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	137h
		jmp	loc_46B8
; ---------------------------------------------------------------------------

loc_3EBA:				; CODE XREF: _ssl3_send_server_key_exchange+231j
					; _ssl3_send_server_key_exchange+25Cj
		mov	eax, [edi+58h]
		cmp	[eax+34Ch], ebx
		jz	short loc_3ECF
		push	6BDh
		jmp	loc_3DCC
; ---------------------------------------------------------------------------

loc_3ECF:				; CODE XREF: _ssl3_send_server_key_exchange+27Bj
		mov	eax, [edi+98h]
		cmp	[eax+34h], ebx
		jnz	short loc_3F09
		push	esi
		call	_EC_KEY_dup
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_3F09
		push	6C9h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_3F09:				; CODE XREF: _ssl3_send_server_key_exchange+290j
					; _ssl3_send_server_key_exchange+29Fj
		mov	eax, [edi+58h]
		push	esi
		mov	[eax+34Ch], esi
		call	_EC_KEY_get0_public_key
		add	esp, 4
		test	eax, eax
		jz	short loc_3F38
		push	esi
		call	_EC_KEY_get0_private_key
		add	esp, 4
		test	eax, eax
		jz	short loc_3F38
		test	dword ptr [edi+100h], 80000h
		jz	short loc_3F65

loc_3F38:				; CODE XREF: _ssl3_send_server_key_exchange+2D5j
					; _ssl3_send_server_key_exchange+2E2j
		push	esi
		call	_EC_KEY_generate_key
		add	esp, 4
		test	eax, eax
		jnz	short loc_3F65
		push	6D3h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_3F65:				; CODE XREF: _ssl3_send_server_key_exchange+2EEj
					; _ssl3_send_server_key_exchange+2FBj
		push	esi
		call	_EC_KEY_get0_group
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_40E4
		push	esi
		call	_EC_KEY_get0_public_key
		add	esp, 4
		test	eax, eax
		jz	loc_40E4
		push	esi
		call	_EC_KEY_get0_private_key
		add	esp, 4
		test	eax, eax
		jz	loc_40E4
		mov	eax, [edi+58h]
		mov	eax, [eax+344h]
		test	byte ptr [eax+20h], 2
		jz	short loc_3FDC
		push	ebx
		call	_EC_GROUP_get_degree
		add	esp, 4
		cmp	eax, 0A3h ; '£'
		jle	short loc_3FDC
		push	6E2h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	136h
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_3FDC:				; CODE XREF: _ssl3_send_server_key_exchange+35Fj
					; _ssl3_send_server_key_exchange+36Fj
		push	ebx
		call	_EC_GROUP_get_curve_name
		push	eax
		call	_tls1_ec_nid2curve_id
		add	esp, 8
		mov	[esp+9Ch+var_7C], eax
		test	eax, eax
		jnz	short loc_4016
		push	6EFh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	13Bh
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_4016:				; CODE XREF: _ssl3_send_server_key_exchange+3A9j
		push	0
		push	0
		push	0
		push	4
		push	esi
		call	_EC_KEY_get0_public_key
		add	esp, 4
		push	eax
		push	ebx
		call	_EC_POINT_point2oct
		push	6FDh
		mov	ebp, eax
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	ebp
		call	_CRYPTO_malloc
		add	esp, 24h
		mov	[esp+9Ch+Src], eax
		call	_BN_CTX_new
		mov	ecx, eax
		mov	eax, [esp+9Ch+Src]
		mov	[esp+9Ch+var_78], ecx
		test	eax, eax
		jz	short loc_40C4
		test	ecx, ecx
		jz	short loc_40C4
		push	ecx
		push	ebp
		push	eax
		push	4
		push	esi
		call	_EC_KEY_get0_public_key
		add	esp, 4
		push	eax
		push	ebx
		call	_EC_POINT_point2oct
		mov	ebx, eax
		add	esp, 18h
		mov	[esp+9Ch+Size],	ebx
		test	ebx, ebx
		jnz	short loc_40A0
		push	70Bh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$124
; ---------------------------------------------------------------------------

loc_40A0:				; CODE XREF: _ssl3_send_server_key_exchange+436j
		push	[esp+9Ch+var_78]
		call	_BN_CTX_free
		xorps	xmm0, xmm0
		mov	[esp+0A0h+var_78], 0
		add	esp, 4
		add	ebx, 4
		movups	[esp+9Ch+var_48], xmm0
		jmp	loc_417D
; ---------------------------------------------------------------------------

loc_40C4:				; CODE XREF: _ssl3_send_server_key_exchange+410j
					; _ssl3_send_server_key_exchange+414j
		push	701h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	41h ; 'A'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$124
; ---------------------------------------------------------------------------

loc_40E4:				; CODE XREF: _ssl3_send_server_key_exchange+32Aj
					; _ssl3_send_server_key_exchange+33Bj ...
		push	6DBh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	2Bh ; '+'
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_46E9
; ---------------------------------------------------------------------------

loc_4104:				; CODE XREF: _ssl3_send_server_key_exchange+207j
		test	ecx, 100h
		jz	short loc_4129
		mov	eax, [edi+0E4h]
		mov	ecx, [eax+14Ch]
		lea	edx, [ecx+1]

loc_411B:				; CODE XREF: _ssl3_send_server_key_exchange+4D8j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_411B
		sub	ecx, edx
		lea	ebx, [ecx+2]
		jmp	short loc_417D
; ---------------------------------------------------------------------------

loc_4129:				; CODE XREF: _ssl3_send_server_key_exchange+4C2j
		test	ecx, 400h
		jz	loc_46A9
		mov	eax, [edi+1A8h]
		test	eax, eax
		jz	loc_4689
		mov	ecx, [edi+1ACh]
		test	ecx, ecx
		jz	loc_4689
		mov	edx, [edi+1B0h]
		test	edx, edx
		jz	loc_4689
		mov	esi, [edi+1B4h]
		test	esi, esi
		jz	loc_4689
		mov	dword ptr [esp+9Ch+var_48], eax
		mov	dword ptr [esp+9Ch+var_48+4], ecx
		mov	dword ptr [esp+9Ch+var_48+8], edx
		mov	dword ptr [esp+9Ch+var_48+0Ch],	esi

loc_417D:				; CODE XREF: _ssl3_send_server_key_exchange+10Cj
					; _ssl3_send_server_key_exchange+200j ...
		mov	ebp, [esp+9Ch+var_88]
		xor	eax, eax
		mov	[esp+9Ch+var_8C], eax
		nop

loc_4188:				; CODE XREF: _ssl3_send_server_key_exchange+583j
		mov	eax, dword ptr [esp+eax*4+9Ch+var_48]
		test	eax, eax
		jz	short loc_41CD
		push	eax
		call	_BN_num_bits
		add	eax, 7
		add	esp, 4
		cdq
		and	edx, 7
		lea	ecx, [edx+eax]
		mov	eax, [esp+9Ch+var_8C]
		sar	ecx, 3
		mov	[esp+eax*4+9Ch+var_38],	ecx
		cmp	eax, 2
		jnz	short loc_41BE
		test	ebp, 400h
		jz	short loc_41BE
		inc	ebx
		jmp	short loc_41C1
; ---------------------------------------------------------------------------

loc_41BE:				; CODE XREF: _ssl3_send_server_key_exchange+569j
					; _ssl3_send_server_key_exchange+571j
		add	ebx, 2

loc_41C1:				; CODE XREF: _ssl3_send_server_key_exchange+574j
		inc	eax
		add	ebx, ecx
		mov	[esp+9Ch+var_8C], eax
		cmp	eax, 4
		jl	short loc_4188

loc_41CD:				; CODE XREF: _ssl3_send_server_key_exchange+546j
		mov	eax, [edi+58h]
		mov	[esp+9Ch+var_84], ebx
		mov	eax, [eax+344h]
		test	dword ptr [eax+10h], 404h
		jnz	short loc_421A
		test	dword ptr [eax+0Ch], 100h
		jnz	short loc_421A
		lea	ecx, [esp+9Ch+var_64]
		push	ecx
		push	eax
		push	edi
		call	_ssl_get_sign_pkey
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+9Ch+var_6C], esi
		test	esi, esi
		jnz	short loc_420D
		lea	esi, [eax+32h]
		jmp	$f_err$125
; ---------------------------------------------------------------------------

loc_420D:				; CODE XREF: _ssl3_send_server_key_exchange+5BBj
		push	esi
		call	_EVP_PKEY_size
		add	esp, 4
		mov	ecx, eax
		jmp	short loc_4222
; ---------------------------------------------------------------------------

loc_421A:				; CODE XREF: _ssl3_send_server_key_exchange+599j
					; _ssl3_send_server_key_exchange+5A2j
		xor	eax, eax
		xor	ecx, ecx
		mov	[esp+9Ch+var_6C], eax

loc_4222:				; CODE XREF: _ssl3_send_server_key_exchange+5D0j
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		mov	eax, [eax+3Ch]
		add	eax, ecx
		add	eax, ebx
		push	eax
		push	[esp+0A0h+var_74]
		call	_BUF_MEM_grow_clean
		add	esp, 8
		test	eax, eax
		jnz	short loc_4260
		push	759h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	7
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$124
; ---------------------------------------------------------------------------

loc_4260:				; CODE XREF: _ssl3_send_server_key_exchange+5F6j
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		mov	bl, [esp+9Ch+var_30]
		mov	eax, [eax+64h]
		mov	esi, [eax+3Ch]
		add	esi, [ecx+4]
		xor	eax, eax
		mov	[esp+9Ch+var_74], esi
		mov	[esp+9Ch+var_8C], eax

loc_427D:				; CODE XREF: _ssl3_send_server_key_exchange+686j
		cmp	dword ptr [esp+eax*4+9Ch+var_48], 0
		jz	short loc_42D0
		cmp	eax, 2
		jnz	short loc_4296
		test	ebp, 400h
		jz	short loc_4296
		mov	[esi], bl
		inc	esi
		jmp	short loc_42AD
; ---------------------------------------------------------------------------

loc_4296:				; CODE XREF: _ssl3_send_server_key_exchange+63Fj
					; _ssl3_send_server_key_exchange+647j
		mov	eax, [esp+eax*4+9Ch+var_38]
		sar	eax, 8
		mov	[esi], al
		mov	eax, [esp+9Ch+var_8C]
		mov	al, byte ptr [esp+eax*4+9Ch+var_38]
		mov	[esi+1], al
		add	esi, 2

loc_42AD:				; CODE XREF: _ssl3_send_server_key_exchange+64Cj
		mov	eax, [esp+9Ch+var_8C]
		push	esi
		push	dword ptr [esp+eax*4+0A0h+var_48]
		call	_BN_bn2bin
		mov	eax, [esp+0A4h+var_8C]
		add	esp, 8
		add	esi, [esp+eax*4+9Ch+var_38]
		inc	eax
		mov	[esp+9Ch+var_8C], eax
		cmp	eax, 4
		jl	short loc_427D

loc_42D0:				; CODE XREF: _ssl3_send_server_key_exchange+63Aj
		mov	eax, [esp+9Ch+var_88]
		mov	ebx, [esp+9Ch+var_84]
		test	al, al
		jns	short loc_4317
		mov	eax, [esp+9Ch+var_7C]
		mov	ebp, [esp+9Ch+Src]
		mov	word ptr [esi],	3
		mov	[esi+2], al
		mov	eax, [esp+9Ch+Size]
		push	eax		; Size
		mov	[esi+3], al
		add	esi, 4
		push	ebp		; Src
		push	esi		; Dst
		call	_memcpy
		push	ebp
		call	_CRYPTO_free
		mov	eax, [esp+0ACh+var_88]
		add	esp, 10h
		add	esi, [esp+9Ch+Size]
		mov	[esp+9Ch+Src], 0

loc_4317:				; CODE XREF: _ssl3_send_server_key_exchange+692j
		test	eax, 100h
		jz	short loc_4399
		mov	eax, [edi+0E4h]
		mov	ecx, [eax+14Ch]
		lea	edx, [ecx+1]

loc_432D:				; CODE XREF: _ssl3_send_server_key_exchange+6EAj
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_432D
		sub	ecx, edx
		shr	ecx, 8
		mov	[esi], cl
		mov	eax, [edi+0E4h]
		mov	ecx, [eax+14Ch]
		lea	edx, [ecx+1]

loc_434A:				; CODE XREF: _ssl3_send_server_key_exchange+707j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_434A
		sub	ecx, edx
		mov	[esi+1], cl
		add	esi, 2
		mov	eax, [edi+0E4h]
		mov	edx, [eax+14Ch]
		mov	ecx, edx
		lea	ebp, [ecx+1]

loc_436A:				; CODE XREF: _ssl3_send_server_key_exchange+727j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_436A
		sub	ecx, ebp
		push	ecx		; Count
		push	edx		; Source
		push	esi		; Dest
		call	dword ptr ds:__imp__strncpy
		mov	eax, [edi+0E4h]
		add	esp, 0Ch
		mov	ecx, [eax+14Ch]
		lea	edx, [ecx+1]

loc_438E:				; CODE XREF: _ssl3_send_server_key_exchange+74Bj
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_438E
		sub	ecx, edx
		add	esi, ecx

loc_4399:				; CODE XREF: _ssl3_send_server_key_exchange+6D4j
		mov	ebp, [esp+9Ch+var_6C]
		test	ebp, ebp
		jz	loc_4509
		cmp	dword ptr [ebp+0], 6
		jnz	loc_4576
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	loc_4576
		lea	eax, [esp+9Ch+var_28]
		mov	[esp+9Ch+var_7C], 0
		mov	[esp+9Ch+var_88], eax
		mov	ebp, 2
		nop	dword ptr [eax+00h]

loc_43D8:				; CODE XREF: _ssl3_send_server_key_exchange+85Dj
		lea	eax, [esp+9Ch+var_60]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		mov	eax, [edi+0E4h]
		add	esp, 8
		cmp	ebp, 2
		jnz	short loc_43FA
		mov	eax, [eax+8Ch]
		jmp	short loc_4400
; ---------------------------------------------------------------------------

loc_43FA:				; CODE XREF: _ssl3_send_server_key_exchange+7A8j
		mov	eax, [eax+90h]

loc_4400:				; CODE XREF: _ssl3_send_server_key_exchange+7B0j
		push	0
		push	eax
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_4554
		mov	eax, [edi+58h]
		add	eax, 0C0h ; 'À'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_4554
		mov	eax, [edi+58h]
		add	eax, 0A0h ; ' '
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_4554
		push	ebx
		push	[esp+0A0h+var_74]
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_4554
		lea	eax, [esp+9Ch+var_8C]
		push	eax
		push	[esp+0A0h+var_88]
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_4554
		mov	ecx, [esp+9Ch+var_7C]
		dec	ebp
		mov	eax, [esp+9Ch+var_8C]
		add	ecx, eax
		add	[esp+9Ch+var_88], eax
		mov	[esp+9Ch+var_7C], ecx
		test	ebp, ebp
		jg	loc_43D8
		mov	eax, [esp+9Ch+var_6C]
		push	dword ptr [eax+14h]
		lea	eax, [esp+0A0h+var_68]
		push	eax
		lea	eax, [esi+2]
		push	eax
		push	ecx
		lea	eax, [esp+0ACh+var_28]
		push	eax
		push	72h ; 'r'
		call	_RSA_sign
		add	esp, 18h
		test	eax, eax
		jg	short loc_44F2
		push	7AEh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	4
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$124
; ---------------------------------------------------------------------------

loc_44F2:				; CODE XREF: _ssl3_send_server_key_exchange+888j
		mov	eax, [esp+9Ch+var_68]
		add	ebx, 2
		shr	eax, 8
		mov	[esi], al
		mov	al, byte ptr [esp+9Ch+var_68]
		mov	[esi+1], al
		add	ebx, [esp+9Ch+var_68]

loc_4509:				; CODE XREF: _ssl3_send_server_key_exchange+757j
					; _ssl3_send_server_key_exchange+A18j ...
		mov	eax, [edi+8]
		push	ebx
		push	0Ch
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch

loc_451B:				; CODE XREF: _ssl3_send_server_key_exchange+51j
		lea	eax, [esp+9Ch+var_60]
		mov	dword ptr [edi+34h], 2151h
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	eax, [edi+8]
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 8

loc_453B:				; CODE XREF: _ssl3_send_server_key_exchange+AC1j
		mov	ecx, [esp+9Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
; ---------------------------------------------------------------------------

loc_4554:				; CODE XREF: _ssl3_send_server_key_exchange+7CAj
					; _ssl3_send_server_key_exchange+7EAj ...
		push	7A5h

loc_4559:				; CODE XREF: _ssl3_send_server_key_exchange+A2Bj
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	6
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		mov	esi, 50h ; 'P'
		jmp	loc_46C9
; ---------------------------------------------------------------------------

loc_4576:				; CODE XREF: _ssl3_send_server_key_exchange+761j
					; _ssl3_send_server_key_exchange+771j
		mov	ecx, [esp+9Ch+var_64]
		test	ecx, ecx
		jz	loc_4678
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	short loc_45B8
		push	ecx
		push	ebp
		push	esi
		call	_tls12_get_sigandhash
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_45B1
		push	7BCh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		lea	esi, [eax+50h]
		push	44h ; 'D'
		jmp	loc_46BD
; ---------------------------------------------------------------------------

loc_45B1:				; CODE XREF: _ssl3_send_server_key_exchange+953j
		mov	ecx, [esp+9Ch+var_64]
		add	esi, 2

loc_45B8:				; CODE XREF: _ssl3_send_server_key_exchange+944j
		push	0
		push	ecx
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_466E
		mov	eax, [edi+58h]
		add	eax, 0C0h ; 'À'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_466E
		mov	eax, [edi+58h]
		add	eax, 0A0h ; ' '
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_466E
		push	ebx
		push	[esp+0A0h+var_74]
		lea	eax, [esp+0A4h+var_60]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_466E
		push	ebp
		lea	eax, [esp+0A0h+var_8C]
		push	eax
		lea	eax, [esi+2]
		push	eax
		lea	eax, [esp+0A8h+var_60]
		push	eax
		call	_EVP_SignFinal
		add	esp, 10h
		test	eax, eax
		jle	short loc_466E
		mov	eax, [esp+9Ch+var_8C]
		sar	eax, 8
		mov	[esi], al
		mov	al, byte ptr [esp+9Ch+var_8C]
		mov	[esi+1], al
		mov	eax, [esp+9Ch+var_8C]
		add	eax, 2
		add	ebx, eax
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	loc_4509
		add	ebx, 2
		jmp	loc_4509
; ---------------------------------------------------------------------------

loc_466E:				; CODE XREF: _ssl3_send_server_key_exchange+982j
					; _ssl3_send_server_key_exchange+9A2j ...
		push	7CCh
		jmp	loc_4559
; ---------------------------------------------------------------------------

loc_4678:				; CODE XREF: _ssl3_send_server_key_exchange+934j
		push	7D8h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0FBh ; 'û'
		jmp	short loc_46B8
; ---------------------------------------------------------------------------

loc_4689:				; CODE XREF: _ssl3_send_server_key_exchange+4F5j
					; _ssl3_send_server_key_exchange+503j ...
		push	732h
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	166h
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_46E9
; ---------------------------------------------------------------------------

loc_46A9:				; CODE XREF: _ssl3_send_server_key_exchange+4E7j
		push	73Eh
		push	offset ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ ; ".\\ssl\\s3_srvr.c"
		push	0FAh ; 'ú'

loc_46B8:				; CODE XREF: _ssl3_send_server_key_exchange+E0j
					; _ssl3_send_server_key_exchange+120j ...
		mov	esi, 28h ; '('

loc_46BD:				; CODE XREF: _ssl3_send_server_key_exchange+964j
		push	9Bh ; '›'
		push	14h
		call	_ERR_put_error

loc_46C9:				; CODE XREF: _ssl3_send_server_key_exchange+929j
		add	esp, 14h

$f_err$125:				; CODE XREF: _ssl3_send_server_key_exchange+5C0j
		push	esi
		push	2
		push	edi
		call	_ssl3_send_alert
		add	esp, 0Ch

$err$124:				; CODE XREF: _ssl3_send_server_key_exchange+453j
					; _ssl3_send_server_key_exchange+497j ...
		mov	eax, [esp+9Ch+Src]
		test	eax, eax
		jz	short loc_46E9
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_46E9:				; CODE XREF: _ssl3_send_server_key_exchange+19Aj
					; _ssl3_send_server_key_exchange+1C9j ...
		push	[esp+9Ch+var_78]
		call	_BN_CTX_free
		lea	eax, [esp+0A0h+var_60]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 8
		mov	dword ptr [edi+34h], 5
		or	eax, 0FFFFFFFFh
		jmp	loc_453B
_ssl3_send_server_key_exchange endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4710h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_check_srp_ext_ClientHello proc near ; CODE	XREF: _ssl3_accept+224p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		mov	dword ptr [edx], 70h ; 'p'
		mov	eax, [ecx+58h]
		mov	eax, [eax+344h]
		test	dword ptr [eax+0Ch], 400h
		jz	short loc_475B
		cmp	dword ptr [ecx+198h], 0
		jz	short loc_475B
		cmp	dword ptr [ecx+1A4h], 0
		jnz	short loc_474E
		mov	dword ptr [edx], 73h ; 's'
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_474E:				; CODE XREF: _ssl_check_srp_ext_ClientHello+30j
		mov	[esp+arg_4], edx
		mov	[esp+arg_0], ecx
		jmp	_SSL_srp_server_param_with_username
; ---------------------------------------------------------------------------

loc_475B:				; CODE XREF: _ssl_check_srp_ext_ClientHello+1Ej
					; _ssl_check_srp_ext_ClientHello+27j
		xor	eax, eax
		retn
_ssl_check_srp_ext_ClientHello endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4760h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; time_t __cdecl static	time(time_t *Time)
_time		proc near
		jmp	dword ptr ds:__imp___time64
_time		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4768h
; COMDAT (pick any)
		public ??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@
; `string'
??_C@_0BA@PHFAPHHI@?4?2ssl?2s3_srvr?4c?$AA@ db '.\ssl\s3_srvr.c',0
					; DATA XREF: _ssl3_accept+B0o
					; _ssl3_accept+128o ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4778h
; COMDAT (pick any)
		public ??_C@_0BM@OGNDHHK@GOST?5signature?5length?5is?5?$CFd?$AA@
; char `string'[]
??_C@_0BM@OGNDHHK@GOST?5signature?5length?5is?5?$CFd?$AA@ db 'GOST signature length is %d',0
					; DATA XREF: _ssl3_get_cert_verify+3F8o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _SSLv3_enc_data:near ; DATA XREF:	.rdata:00000CA0o
		extrn _ssl_undefined_function:near ; DATA XREF:	.rdata:00000C50o
		extrn _ssl_undefined_void_function:near	; DATA XREF: .rdata:00000CA4o
		extrn _ssl3_get_cipher_by_char:near ; DATA XREF: .rdata:00000C84o
		extrn _ssl3_put_cipher_by_char:near ; CODE XREF: _ssl3_send_server_hello+DCp
					; DATA XREF: .rdata:00000C88o
		extrn _ssl3_get_message:near ; DATA XREF: .rdata:00000C6Co
		extrn _ssl3_num_ciphers:near ; DATA XREF: .rdata:00000C90o
		extrn _ssl3_get_cipher:near ; DATA XREF: .rdata:00000C94o
		extrn _ssl3_renegotiate:near ; DATA XREF: .rdata:00000C64o
		extrn _ssl3_renegotiate_check:near ; DATA XREF:	.rdata:00000C68o
		extrn _ssl3_dispatch_alert:near	; DATA XREF: .rdata:00000C78o
		extrn _ssl3_read_bytes:near ; DATA XREF: .rdata:00000C70o
		extrn _ssl3_write_bytes:near ; DATA XREF: .rdata:00000C74o
		extrn _ssl3_new:near	; DATA XREF: .rdata:00000C40o
		extrn _ssl3_free:near	; DATA XREF: .rdata:00000C48o
		extrn _ssl3_read:near	; DATA XREF: .rdata:00000C54o
		extrn _ssl3_peek:near	; DATA XREF: .rdata:00000C58o
		extrn _ssl3_write:near	; DATA XREF: .rdata:00000C5Co
		extrn _ssl3_shutdown:near ; DATA XREF: .rdata:00000C60o
		extrn _ssl3_clear:near	; DATA XREF: .rdata:00000C44o
		extrn _ssl3_ctrl:near	; DATA XREF: .rdata:00000C7Co
		extrn _ssl3_ctx_ctrl:near ; DATA XREF: .rdata:00000C80o
		extrn _ssl3_callback_ctrl:near ; DATA XREF: .rdata:00000CA8o
		extrn _ssl3_ctx_callback_ctrl:near ; DATA XREF:	.rdata:00000CACo
		extrn _ssl3_pending:near ; DATA	XREF: .rdata:00000C8Co
		extrn _ssl3_default_timeout:near ; DATA	XREF: .rdata:00000C9Co
		extrn __imp____acrt_iob_func:near ; CODE XREF: _ssl3_get_cert_verify+3FFp
					; DATA XREF: _ssl3_get_cert_verify+3FFr
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p
					; DATA XREF: ...
; __time64_t __cdecl __time64(__time64_t *Time)
		extrn __imp___time64:near ; CODE XREF: _ssl3_accept+Ep
					; DATA XREF: _ssl3_accept+Er ...
; void *__cdecl	_memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp__memmove:near ; CODE XREF: _ssl3_get_client_key_exchange+9ACp
					; DATA XREF: _ssl3_get_client_key_exchange+9ACr
; char *__cdecl	_strncpy(char *Dest, const char	*Source, size_t	Count)
		extrn __imp__strncpy:near ; CODE XREF: _ssl3_send_server_key_exchange+72Ep
					; DATA XREF: _ssl3_send_server_key_exchange+72Er
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn __imp__SetLastError@4:near ; CODE	XREF: _ssl3_accept+49p
					; DATA XREF: _ssl3_accept+49r
		extrn _BUF_MEM_new:near	; CODE XREF: _ssl3_accept+878p
		extrn _BUF_MEM_free:near ; CODE	XREF: _ssl3_accept+9B1p
					; _ssl3_accept+A61p
		extrn _BUF_MEM_grow:near ; CODE	XREF: _ssl3_accept+88Dp
					; _ssl3_send_cert_status+1Fp ...
		extrn _BUF_MEM_grow_clean:near
					; CODE XREF: _ssl3_send_certificate_request+11Dp
					; _ssl3_send_certificate_request+235p ...
		extrn _BUF_strdup:near	; CODE XREF: _ssl3_get_client_key_exchange+A6Cp
					; _ssl3_get_client_key_exchange+BBFp
		extrn _BUF_strndup:near	; CODE XREF: _ssl3_get_client_key_exchange+A0Ap
		extrn _sk_num:near	; CODE XREF: _ssl3_get_client_certificate+2ADp
					; _ssl3_get_client_hello+519p ...
		extrn _sk_value:near	; CODE XREF: _ssl3_get_client_hello+52Ap
					; _ssl3_get_client_hello+7BDp ...
		extrn _sk_new_null:near	; CODE XREF: _ssl3_get_client_certificate+141p
		extrn _sk_free:near	; CODE XREF: _ssl3_get_client_hello+6FCp
					; _ssl3_get_client_hello+70Cp ...
		extrn _sk_pop_free:near	; CODE XREF: _ssl3_get_client_certificate+419p
					; _ssl3_get_client_certificate+438p
		extrn _sk_push:near	; CODE XREF: _ssl3_get_client_certificate+21Ep
		extrn _sk_shift:near	; CODE XREF: _ssl3_get_client_certificate+389p
		extrn _sk_dup:near	; CODE XREF: _ssl3_get_client_hello+720p
					; _ssl3_get_client_hello+734p
		extrn _CRYPTO_malloc:near ; CODE XREF: _ssl3_get_next_proto+C2p
					; _ssl3_send_newsession_ticket+6Bp ...
		extrn _CRYPTO_free:near	; CODE XREF: _ssl3_get_client_key_exchange+9FDp
					; _ssl3_get_client_key_exchange+A58p ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _ssl3_get_client_key_exchange+300p
					; _ssl3_get_client_key_exchange+551p ...
		extrn _BIO_free:near	; CODE XREF: _ssl3_get_cert_verify+4ADp
		extrn _BIO_ctrl:near	; CODE XREF: _ssl3_accept+156p
					; _ssl3_accept+95Ap ...
		extrn _BN_CTX_new:near	; CODE XREF: _ssl3_get_client_key_exchange:loc_28EBp
					; _ssl3_send_server_key_exchange+3FFp
		extrn _BN_CTX_free:near	; CODE XREF: _ssl3_get_client_key_exchange+7C1p
					; _ssl3_get_client_key_exchange+E3Fp ...
		extrn _BN_num_bits:near	; CODE XREF: _ssl3_send_server_key_exchange+549p
		extrn _BN_clear_free:near ; CODE XREF: _ssl3_get_client_key_exchange+4E8p
					; _ssl3_get_client_key_exchange+520p
		extrn _BN_bin2bn:near	; CODE XREF: _ssl3_get_client_key_exchange+487p
					; _ssl3_get_client_key_exchange+B48p
		extrn _BN_bn2bin:near	; CODE XREF: _ssl3_send_server_key_exchange+66Ep
		extrn _BN_ucmp:near	; CODE XREF: _ssl3_get_client_key_exchange+B81p
		extrn _ASN1_get_object:near ; CODE XREF: _ssl3_get_client_key_exchange+D12p
		extrn _RSA_private_decrypt:near
					; CODE XREF: _ssl3_get_client_key_exchange+170p
		extrn _RSA_up_ref:near	; CODE XREF: _ssl3_send_server_key_exchange+E6p
		extrn _RSA_sign:near	; CODE XREF: _ssl3_send_server_key_exchange+87Ep
		extrn _RSA_verify:near	; CODE XREF: _ssl3_get_cert_verify+264p
		extrn _DHparams_dup:near ; CODE	XREF: _ssl3_send_server_key_exchange+1A0p
		extrn _DH_free:near	; CODE XREF: _ssl3_get_client_key_exchange+4FEp
					; _ssl3_get_client_key_exchange+518p
		extrn _DH_generate_key:near ; CODE XREF: _ssl3_send_server_key_exchange+1D8p
		extrn _DH_compute_key:near ; CODE XREF:	_ssl3_get_client_key_exchange+4C1p
		extrn _DSA_verify:near	; CODE XREF: _ssl3_get_cert_verify+2D2p
		extrn _ERR_put_error:near ; CODE XREF: _ssl3_accept+C1p
					; _ssl3_accept+139p ...
		extrn _ERR_clear_error:near ; CODE XREF: _ssl3_accept+42p
					; _ssl3_get_client_key_exchange+17Ap ...
		extrn _EVP_MD_type:near	; CODE XREF: _ssl3_accept+5C6p
		extrn _EVP_MD_size:near	; CODE XREF: _ssl3_accept+5E7p
		extrn _EVP_MD_CTX_md:near ; CODE XREF: _ssl3_accept+5C0p
					; _ssl3_accept+5E1p
		extrn _EVP_CIPHER_CTX_iv_length:near
					; CODE XREF: _ssl3_send_newsession_ticket+2B6p
					; _ssl3_send_newsession_ticket+2D2p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _ssl3_get_cert_verify+27p
					; _ssl3_send_server_key_exchange+42p
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _ssl3_get_cert_verify+4CDp
					; _ssl3_send_server_key_exchange+8DFp ...
		extrn _EVP_MD_CTX_set_flags:near
					; CODE XREF: _ssl3_send_server_key_exchange+797p
		extrn _EVP_DigestInit_ex:near ;	CODE XREF: _ssl3_get_cert_verify+1D5p
					; _ssl3_send_server_key_exchange+7C0p ...
		extrn _EVP_DigestUpdate:near ; CODE XREF: _ssl3_get_cert_verify+1EBp
					; _ssl3_send_server_key_exchange+7E0p ...
		extrn _EVP_DigestFinal_ex:near
					; CODE XREF: _ssl3_send_server_key_exchange+838p
		extrn _EVP_EncryptInit_ex:near
					; CODE XREF: _ssl3_send_newsession_ticket+1C6p
		extrn _EVP_EncryptUpdate:near ;	CODE XREF: _ssl3_send_newsession_ticket+2F1p
		extrn _EVP_EncryptFinal:near ; CODE XREF: _ssl3_send_newsession_ticket+318p
		extrn _EVP_SignFinal:near ; CODE XREF: _ssl3_send_server_key_exchange+9E9p
		extrn _EVP_VerifyFinal:near ; CODE XREF: _ssl3_get_cert_verify+203p
		extrn _EVP_CIPHER_CTX_init:near
					; CODE XREF: _ssl3_send_newsession_ticket+82p
		extrn _EVP_CIPHER_CTX_cleanup:near
					; CODE XREF: _ssl3_send_newsession_ticket+376p
					; _ssl3_send_newsession_ticket+432p
		extrn _EVP_sha256:near	; CODE XREF: _ssl3_send_newsession_ticket+1D8p
		extrn _EVP_aes_128_cbc:near ; CODE XREF: _ssl3_send_newsession_ticket+1BBp
		extrn _EVP_PKEY_size:near ; CODE XREF: _ssl3_accept+36Bp
					; _ssl3_get_cert_verify+E7p ...
		extrn _EVP_PKEY_get1_DH:near ; CODE XREF: _ssl3_get_client_key_exchange+453p
		extrn _EVP_PKEY_free:near ; CODE XREF: _ssl3_get_cert_verify+4D3p
					; _ssl3_get_client_key_exchange+462p ...
		extrn _EVP_PKEY_cmp_parameters:near
					; CODE XREF: _ssl3_get_client_key_exchange+445p
		extrn _EVP_PKEY_CTX_new:near ; CODE XREF: _ssl3_get_cert_verify+386p
					; _ssl3_get_client_key_exchange+C8Ep
		extrn _EVP_PKEY_CTX_free:near ;	CODE XREF: _ssl3_get_cert_verify+3C8p
					; _ssl3_get_cert_verify+445p ...
		extrn _EVP_PKEY_CTX_ctrl:near
					; CODE XREF: _ssl3_get_client_key_exchange+D97p
		extrn _EVP_PKEY_verify_init:near ; CODE	XREF: _ssl3_get_cert_verify+3B7p
		extrn _EVP_PKEY_verify:near ; CODE XREF: _ssl3_get_cert_verify+43Dp
		extrn _EVP_PKEY_decrypt_init:near
					; CODE XREF: _ssl3_get_client_key_exchange+CB1p
		extrn _EVP_PKEY_decrypt:near ; CODE XREF: _ssl3_get_client_key_exchange+D47p
		extrn _EVP_PKEY_derive_set_peer:near
					; CODE XREF: _ssl3_get_client_key_exchange+CECp
		extrn _EC_GROUP_get_curve_name:near
					; CODE XREF: _ssl3_send_server_key_exchange+395p
		extrn _EC_GROUP_get_degree:near
					; CODE XREF: _ssl3_get_client_key_exchange+751p
					; _ssl3_send_server_key_exchange+362p
		extrn _EC_POINT_new:near ; CODE	XREF: _ssl3_get_client_key_exchange+5FFp
		extrn _EC_POINT_free:near ; CODE XREF: _ssl3_get_client_key_exchange+7B2p
					; _ssl3_get_client_key_exchange+E25p
		extrn _EC_POINT_copy:near ; CODE XREF: _ssl3_get_client_key_exchange+66Dp
		extrn _EC_POINT_point2oct:near
					; CODE XREF: _ssl3_send_server_key_exchange+3E1p
					; _ssl3_send_server_key_exchange+426p
		extrn _EC_POINT_oct2point:near
					; CODE XREF: _ssl3_get_client_key_exchange+715p
		extrn _EC_KEY_new:near	; CODE XREF: _ssl3_get_client_key_exchange+574p
		extrn _EC_KEY_new_by_curve_name:near
					; CODE XREF: _ssl3_send_server_key_exchange+225p
		extrn _EC_KEY_free:near	; CODE XREF: _ssl3_get_client_key_exchange+7B8p
					; _ssl3_get_client_key_exchange+7CFp ...
		extrn _EC_KEY_dup:near	; CODE XREF: _ssl3_send_server_key_exchange+293p
		extrn _EC_KEY_get0_group:near
					; CODE XREF: _ssl3_get_client_key_exchange+5C3p
					; _ssl3_send_server_key_exchange+31Ep
		extrn _EC_KEY_set_group:near ; CODE XREF: _ssl3_get_client_key_exchange+5D8p
		extrn _EC_KEY_get0_private_key:near
					; CODE XREF: _ssl3_get_client_key_exchange+5CBp
					; _ssl3_send_server_key_exchange+2D8p ...
		extrn _EC_KEY_set_private_key:near
					; CODE XREF: _ssl3_get_client_key_exchange+5EEp
		extrn _EC_KEY_get0_public_key:near
					; CODE XREF: _ssl3_get_client_key_exchange+663p
					; _ssl3_send_server_key_exchange+2CBp ...
		extrn _EC_KEY_generate_key:near
					; CODE XREF: _ssl3_send_server_key_exchange+2F1p
		extrn _ECDSA_verify:near ; CODE	XREF: _ssl3_get_cert_verify+31Ep
		extrn _ECDH_compute_key:near ; CODE XREF: _ssl3_get_client_key_exchange+786p
		extrn _i2d_X509_NAME:near ; CODE XREF: _ssl3_send_certificate_request+101p
					; _ssl3_send_certificate_request+16Bp ...
		extrn _X509_free:near	; CODE XREF: _ssl3_get_client_certificate+380p
					; _ssl3_get_client_certificate+407p
					; DATA XREF: ...
		extrn _d2i_X509:near	; CODE XREF: _ssl3_get_client_certificate+201p
		extrn _X509_get_pubkey:near ; CODE XREF: _ssl3_get_cert_verify+82p
					; _ssl3_get_client_key_exchange+432p ...
		extrn _X509_certificate_type:near ; CODE XREF: _ssl3_get_cert_verify+8Fp
		extrn _HMAC_CTX_init:near ; CODE XREF: _ssl3_send_newsession_ticket+8Fp
		extrn _HMAC_CTX_cleanup:near ; CODE XREF: _ssl3_send_newsession_ticket+383p
					; _ssl3_send_newsession_ticket+43Fp
		extrn _HMAC_Init_ex:near ; CODE	XREF: _ssl3_send_newsession_ticket+1EFp
		extrn _HMAC_Update:near	; CODE XREF: _ssl3_send_newsession_ticket+340p
		extrn _HMAC_Final:near	; CODE XREF: _ssl3_send_newsession_ticket+361p
		extrn _SSL_srp_server_param_with_username:near
					; CODE XREF: _ssl_check_srp_ext_ClientHello+46j
		extrn _SRP_generate_server_master_secret:near
					; CODE XREF: _ssl3_get_client_key_exchange+BF0p
		extrn _SSL_clear:near	; CODE XREF: _ssl3_accept+9Ap
		extrn _SSL_SESSION_free:near ; CODE XREF: _ssl3_send_newsession_ticket+112p
					; _ssl3_send_newsession_ticket:loc_39B3p
		extrn _i2d_SSL_SESSION:near ; CODE XREF: _ssl3_send_newsession_ticket+42p
					; _ssl3_send_newsession_ticket+A3p ...
		extrn _d2i_SSL_SESSION:near ; CODE XREF: _ssl3_send_newsession_ticket+BFp
		extrn _SSL_ctrl:near	; CODE XREF: _ssl3_get_client_hello+EEp
					; _ssl3_get_client_hello+2C1p
		extrn _DTLSv1_server_method:near ; CODE	XREF: _ssl3_get_client_hello+440p
		extrn _DTLSv1_2_server_method:near ; CODE XREF:	_ssl3_get_client_hello+3E3p
		extrn _SSL_get_ciphers:near ; CODE XREF: _ssl3_get_client_hello+6ACp
					; _ssl3_get_client_hello+9CEp
		extrn _SSL_get_client_CA_list:near
					; CODE XREF: _ssl3_send_certificate_request+BAp
		extrn _SSL_state:near	; CODE XREF: _ssl3_accept+7Ap
					; _ssl3_accept+8Ap
		extrn _ssl_sess_cert_new:near ;	CODE XREF: _ssl3_get_client_certificate+3BFp
		extrn _ssl_get_new_session:near	; CODE XREF: _ssl3_get_client_hello+238p
		extrn _ssl_get_prev_session:near ; CODE	XREF: _ssl3_get_client_hello+20Ap
		extrn _ssl_bytes_to_cipher_list:near
					; CODE XREF: _ssl3_get_client_hello+4E4p
		extrn _ssl_update_cache:near ; CODE XREF: _ssl3_accept+9EAp
		extrn _ssl_verify_cert_chain:near
					; CODE XREF: _ssl3_get_client_certificate+323p
		extrn _ssl_get_server_send_pkey:near
					; CODE XREF: _ssl3_send_server_certificate+Fp
		extrn _ssl_get_sign_pkey:near
					; CODE XREF: _ssl3_send_server_key_exchange+5ABp
		extrn _ssl_verify_alarm_type:near
					; CODE XREF: _ssl3_get_client_certificate+335p
		extrn _ssl_fill_hello_random:near ; CODE XREF: _ssl3_get_client_hello+5FBp
		extrn _ssl3_init_finished_mac:near ; CODE XREF:	_ssl3_accept+1E4p
					; _ssl3_accept+8F1p
		extrn _ssl3_get_finished:near ;	CODE XREF: _ssl3_accept+660p
		extrn _ssl3_send_change_cipher_spec:near ; CODE	XREF: _ssl3_accept+731p
		extrn _ssl3_cleanup_key_block:near ; CODE XREF:	_ssl3_accept+9A9p
		extrn _ssl3_do_write:near ; CODE XREF: _ssl3_send_cert_status+C9p
		extrn _ssl3_send_alert:near ; CODE XREF: _ssl3_accept+A21p
					; _ssl3_accept+A8Bp ...
		extrn _ssl3_get_req_cert_type:near
					; CODE XREF: _ssl3_send_certificate_request+3Bp
		extrn _ssl3_send_finished:near ; CODE XREF: _ssl3_accept+786p
		extrn _ssl3_output_cert_chain:near
					; CODE XREF: _ssl3_send_server_certificate+58p
		extrn _ssl3_choose_cipher:near ; CODE XREF: _ssl3_get_client_hello+6BFp
					; _ssl3_get_client_hello+9E1p
		extrn _ssl3_setup_buffers:near ; CODE XREF: _ssl3_accept+8A1p
		extrn _ssl3_digest_cached_records:near ; CODE XREF: _ssl3_accept+47Fp
					; _ssl3_accept+58Dp ...
		extrn _ssl_init_wbio_buffer:near ; CODE	XREF: _ssl3_accept+8E0p
		extrn _ssl_free_wbio_buffer:near ; CODE	XREF: _ssl3_accept+9BEp
		extrn _tls1_ec_nid2curve_id:near
					; CODE XREF: _ssl3_send_server_key_exchange+39Bp
		extrn _tls1_shared_curve:near
					; CODE XREF: _ssl3_send_server_key_exchange+218p
		extrn _ssl_add_serverhello_tlsext:near
					; CODE XREF: _ssl3_send_server_hello+128p
		extrn _ssl_parse_clienthello_tlsext:near
					; CODE XREF: _ssl3_get_client_hello+5BEp
		extrn _tls1_set_server_sigalgs:near ; CODE XREF: _ssl3_get_client_hello+94Fp
		extrn _ssl_check_clienthello_tlsext_late:near
					; CODE XREF: _ssl3_get_client_hello+AD1p
		extrn _ssl_prepare_serverhello_tlsext:near
					; CODE XREF: _ssl3_send_server_hello+FDp
		extrn _tls12_get_sigandhash:near
					; CODE XREF: _ssl3_send_server_key_exchange+949p
		extrn _tls12_get_psigalgs:near
					; CODE XREF: _ssl3_send_certificate_request+66p
		extrn _tls12_check_peer_sigalg:near ; CODE XREF: _ssl3_get_cert_verify+171p
		extrn _RAND_bytes:near	; CODE XREF: _ssl3_send_newsession_ticket+19Ap
		extrn _RAND_pseudo_bytes:near
					; CODE XREF: _ssl3_get_client_key_exchange+156p
		extrn _RAND_add:near	; CODE XREF: _ssl3_accept+3Ap
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _ssl3_get_cert_verify+4E6p
					; _ssl3_get_client_key_exchange+E5Ep ...
		extrn __chkstk:near	; CODE XREF: _ssl3_accept+5p
					; _ssl3_accept+26p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _ssl3_get_client_hello+2EAp
					; _ssl3_get_client_key_exchange+8EEp ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ssl3_get_client_key_exchange+904p
					; _ssl3_get_client_key_exchange+9D2p
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso
		extrn ___security_cookie:near ;	DATA XREF: _ssl3_get_cert_verify+Ar
					; _ssl3_get_client_key_exchange+Ar ...
		extrn __fltused:near


		end
