;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	828189D5DBD0A0909ABBCB0515399E60
; Input	CRC32 :	54B7447E

; File Name   :	C:\compspace\Diff\openssl\obj\ssl_asn1.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _d2i_SSL_SESSION
_d2i_SSL_SESSION proc near

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= byte ptr -50h
Size		= dword	ptr -4Ch
Src		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 5Ch ; '\'
		call	__chkstk
		mov	eax, [esp+5Ch+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+64h+arg_0]
		mov	[esp+64h+var_8], eax
		mov	eax, [eax]
		mov	[esp+64h+var_C], eax
		mov	[esp+64h+var_24], 3Ah ;	':'
		push	esi
		push	edi
		test	ebp, ebp
		jz	short loc_33
		mov	esi, [ebp+0]
		test	esi, esi
		jnz	short loc_48

loc_33:					; CODE XREF: _d2i_SSL_SESSION+2Aj
		call	_SSL_SESSION_new
		mov	esi, eax
		test	esi, esi
		jnz	short loc_48
		mov	ecx, 184h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_48:					; CODE XREF: _d2i_SSL_SESSION+31j
					; _d2i_SSL_SESSION+3Cj
		mov	ecx, [esp+6Ch+arg_8]
		lea	eax, [esp+6Ch+var_3C]
		mov	[esp+6Ch+arg_0], eax
		lea	eax, [esp+6Ch+Size]
		mov	[esp+6Ch+var_5C], eax
		mov	eax, [esp+6Ch+arg_4]
		mov	eax, [eax]
		mov	[esp+6Ch+var_2C], eax
		test	ecx, ecx
		jnz	short loc_70
		mov	[esp+6Ch+var_10], ecx
		jmp	short loc_76
; ---------------------------------------------------------------------------

loc_70:					; CODE XREF: _d2i_SSL_SESSION+68j
		add	eax, ecx
		mov	[esp+6Ch+var_10], eax

loc_76:					; CODE XREF: _d2i_SSL_SESSION+6Ej
		lea	eax, [esp+6Ch+arg_8]
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_asn1_GetSequence
		add	esp, 8
		test	eax, eax
		jnz	short loc_96
		mov	ecx, 18Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_96:					; CODE XREF: _d2i_SSL_SESSION+8Aj
		mov	eax, [esp+6Ch+var_2C]
		push	[esp+6Ch+var_14]
		mov	[esp+70h+var_C], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+arg_0]
		mov	[esp+74h+var_34], 0
		push	eax
		mov	[esp+78h+var_3C], 0
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_D2
		mov	ecx, 18Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_D2:					; CODE XREF: _d2i_SSL_SESSION+C6j
		mov	eax, [esp+6Ch+var_C]
		mov	edx, [esp+6Ch+var_2C]
		sub	eax, edx
		mov	ecx, [esp+6Ch+var_14]
		add	ecx, eax
		mov	eax, [esp+6Ch+var_34]
		mov	[esp+6Ch+var_14], ecx
		test	eax, eax
		jz	short loc_10F
		push	eax
		call	_CRYPTO_free
		mov	ecx, [esp+70h+var_14]
		add	esp, 4
		mov	edx, [esp+6Ch+var_2C]
		mov	[esp+6Ch+var_34], 0
		mov	[esp+6Ch+var_3C], 0

loc_10F:				; CODE XREF: _d2i_SSL_SESSION+ECj
		push	ecx
		lea	eax, [esp+70h+var_2C]
		mov	[esp+70h+var_C], edx
		push	eax
		lea	eax, [esp+74h+arg_0]
		push	eax
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_134
		mov	ecx, 196h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_134:				; CODE XREF: _d2i_SSL_SESSION+128j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		push	[esp+6Ch+arg_0]
		add	[esp+70h+var_14], eax
		call	_ASN1_INTEGER_get
		mov	edi, eax
		add	esp, 4
		mov	[esi], edi
		mov	eax, [esp+6Ch+var_34]
		test	eax, eax
		jz	short loc_171
		push	eax
		call	_CRYPTO_free
		add	esp, 4
		mov	[esp+6Ch+var_34], 0
		mov	[esp+6Ch+var_3C], 0

loc_171:				; CODE XREF: _d2i_SSL_SESSION+156j
		mov	eax, [esp+6Ch+var_2C]
		push	[esp+6Ch+var_14]
		mov	[esp+70h+var_C], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		mov	[esp+74h+Src], 0
		push	eax
		mov	[esp+78h+Size],	0
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1AD
		mov	ecx, 1A1h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_1AD:				; CODE XREF: _d2i_SSL_SESSION+1A1j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		cmp	edi, 2
		jnz	short loc_1F3
		cmp	[esp+6Ch+Size],	3
		jz	short loc_1D7
		mov	[esp+6Ch+var_24], 89h ;	'‰'
		mov	ecx, 1A5h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_1D7:				; CODE XREF: _d2i_SSL_SESSION+1C3j
		mov	ecx, [esp+6Ch+Src]
		movzx	edx, byte ptr [ecx]
		movzx	eax, byte ptr [ecx+1]
		or	edx, 200h
		shl	edx, 8
		or	edx, eax
		movzx	eax, byte ptr [ecx+2]
		jmp	short loc_248
; ---------------------------------------------------------------------------

loc_1F3:				; CODE XREF: _d2i_SSL_SESSION+1BCj
		mov	eax, edi
		sar	eax, 8
		cmp	eax, 3
		jz	short loc_21E
		cmp	eax, 0FEh ; 'þ'
		jz	short loc_21E
		cmp	edi, 100h
		jz	short loc_21E
		mov	[esp+6Ch+var_24], 0FEh ; 'þ'
		mov	ecx, 1B7h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_21E:				; CODE XREF: _d2i_SSL_SESSION+1FBj
					; _d2i_SSL_SESSION+202j ...
		cmp	[esp+6Ch+Size],	2
		jz	short loc_237
		mov	[esp+6Ch+var_24], 89h ;	'‰'
		mov	ecx, 1B0h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_237:				; CODE XREF: _d2i_SSL_SESSION+223j
		mov	eax, [esp+6Ch+Src]
		movzx	edx, byte ptr [eax]
		movzx	eax, byte ptr [eax+1]
		or	edx, 30000h

loc_248:				; CODE XREF: _d2i_SSL_SESSION+1F1j
		shl	edx, 8
		or	edx, eax
		mov	dword ptr [esi+0B4h], 0
		mov	[esi+0B8h], edx
		mov	eax, [esp+6Ch+var_2C]
		push	[esp+6Ch+var_14]
		mov	[esp+70h+var_C], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_289
		mov	ecx, 1BEh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_289:				; CODE XREF: _d2i_SSL_SESSION+27Dj
		mov	eax, [esp+6Ch+var_C]
		mov	ecx, 20h ; ' '
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Size]
		cmp	eax, ecx
		cmovg	eax, ecx
		mov	[esp+6Ch+Size],	eax
		mov	[esi+44h], eax
		mov	eax, [esp+6Ch+Size]
		cmp	eax, ecx
		jle	short loc_2CD
		push	offset ??_C@_0CK@IOHFIKED@os?4length?5?$DM?$DN?5?$CIint?$CJsizeof?$CIret?9?$DOse@ ; "os.length <= (int)sizeof(ret->session_i"...
		push	1CAh
		push	offset ??_C@_0BB@OEPFCJAK@?4?2ssl?2ssl_asn1?4c?$AA@ ; ".\\ssl\\ssl_asn1.c"
		call	_OpenSSLDie
		mov	eax, [esp+78h+Size]
		add	esp, 0Ch

loc_2CD:				; CODE XREF: _d2i_SSL_SESSION+2B0j
		push	eax		; Size
		push	[esp+70h+Src]	; Src
		lea	eax, [esi+48h]
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esp+78h+var_2C]
		push	[esp+78h+var_14]
		mov	[esp+7Ch+var_C], eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 18h
		test	eax, eax
		jnz	short loc_307
		mov	ecx, 1CDh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_307:				; CODE XREF: _d2i_SSL_SESSION+2FBj
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Size]
		cmp	eax, 30h ; '0'
		jle	short loc_325
		mov	dword ptr [esi+10h], 30h ; '0'
		jmp	short loc_328
; ---------------------------------------------------------------------------

loc_325:				; CODE XREF: _d2i_SSL_SESSION+31Aj
		mov	[esi+10h], eax

loc_328:				; CODE XREF: _d2i_SSL_SESSION+323j
		push	dword ptr [esi+10h] ; Size
		lea	eax, [esi+14h]
		push	[esp+70h+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		xor	ecx, ecx
		add	esp, 0Ch
		mov	[esp+6Ch+Size],	ecx
		cmp	[esp+6Ch+var_14], ecx
		jz	short loc_3B9
		mov	edx, [esp+6Ch+var_2C]
		mov	bl, [edx]
		movzx	eax, bl
		and	al, 0DFh
		cmp	al, 80h	; '€'
		jnz	short loc_3B9
		mov	al, bl
		and	al, 20h
		or	al, 4
		mov	[edx], al
		mov	eax, [esp+6Ch+var_2C]
		push	[esp+6Ch+var_14]
		mov	[esp+70h+var_C], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_397
		mov	eax, [esp+6Ch+var_C]
		mov	[esp+6Ch+var_4], 1E7h
		mov	[eax], bl
		mov	ecx, [esp+6Ch+var_4]
		jmp	$err$158
; ---------------------------------------------------------------------------

loc_397:				; CODE XREF: _d2i_SSL_SESSION+37Ej
		mov	ecx, [esp+6Ch+var_C]
		mov	eax, ecx
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	[ecx], bl
		mov	ecx, [esp+6Ch+Size]
		cmp	ecx, 8
		jle	short loc_3B9
		mov	dword ptr [esi+4], 8
		jmp	short loc_3BC
; ---------------------------------------------------------------------------

loc_3B9:				; CODE XREF: _d2i_SSL_SESSION+345j
					; _d2i_SSL_SESSION+354j ...
		mov	[esi+4], ecx

loc_3BC:				; CODE XREF: _d2i_SSL_SESSION+3B7j
		push	dword ptr [esi+4] ; Size
		lea	eax, [esi+8]
		push	[esp+70h+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esp+78h+Src]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_3E0
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_3E0:				; CODE XREF: _d2i_SSL_SESSION+3D5j
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+var_3C], 0
		test	eax, eax
		jz	loc_4C0
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A1h ; '¡'
		jnz	loc_4C0
		push	eax
		lea	eax, [esp+70h+var_54]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_50]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_43A
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 1F1h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_43A:				; CODE XREF: _d2i_SSL_SESSION+426j
		cmp	ebx, 21h ; '!'
		jnz	short loc_456
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_45A
; ---------------------------------------------------------------------------

loc_456:				; CODE XREF: _d2i_SSL_SESSION+43Dj
		mov	eax, [esp+6Ch+var_58]

loc_45A:				; CODE XREF: _d2i_SSL_SESSION+454j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+arg_0]
		push	eax
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_47B
		mov	ecx, 1F1h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_47B:				; CODE XREF: _d2i_SSL_SESSION+46Fj
		cmp	ebx, 21h ; '!'
		jnz	short loc_4B4
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_4B4
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 1F1h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_4B4:				; CODE XREF: _d2i_SSL_SESSION+47Ej
					; _d2i_SSL_SESSION+4A0j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax

loc_4C0:				; CODE XREF: _d2i_SSL_SESSION+3EEj
					; _d2i_SSL_SESSION+3FBj
		cmp	[esp+6Ch+var_34], 0
		jz	short loc_4EC
		push	[esp+6Ch+arg_0]
		call	_ASN1_INTEGER_get
		mov	[esi+0ACh], eax
		push	[esp+70h+var_34]
		call	_CRYPTO_free
		add	esp, 8
		mov	[esp+6Ch+var_34], 0
		jmp	short loc_4FD
; ---------------------------------------------------------------------------

loc_4EC:				; CODE XREF: _d2i_SSL_SESSION+4C5j
		push	0		; Time
		call	dword ptr ds:__imp___time64
		add	esp, 4
		mov	[esi+0ACh], eax

loc_4FD:				; CODE XREF: _d2i_SSL_SESSION+4EAj
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+var_3C], 0
		test	eax, eax
		jz	loc_5DD
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A2h ; '¢'
		jnz	loc_5DD
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_557
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 1FBh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_557:				; CODE XREF: _d2i_SSL_SESSION+543j
		cmp	ebx, 21h ; '!'
		jnz	short loc_573
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_577
; ---------------------------------------------------------------------------

loc_573:				; CODE XREF: _d2i_SSL_SESSION+55Aj
		mov	eax, [esp+6Ch+var_58]

loc_577:				; CODE XREF: _d2i_SSL_SESSION+571j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+arg_0]
		push	eax
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_598
		mov	ecx, 1FBh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_598:				; CODE XREF: _d2i_SSL_SESSION+58Cj
		cmp	ebx, 21h ; '!'
		jnz	short loc_5D1
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_5D1
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 1FBh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_5D1:				; CODE XREF: _d2i_SSL_SESSION+59Bj
					; _d2i_SSL_SESSION+5BDj
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax

loc_5DD:				; CODE XREF: _d2i_SSL_SESSION+50Bj
					; _d2i_SSL_SESSION+518j
		cmp	[esp+6Ch+var_34], 0
		jz	short loc_611
		push	[esp+6Ch+arg_0]
		call	_ASN1_INTEGER_get
		mov	[esi+0A8h], eax
		push	[esp+70h+var_34]
		call	_CRYPTO_free
		add	esp, 8
		mov	[esp+6Ch+var_34], 0
		mov	[esp+6Ch+var_3C], 0
		jmp	short loc_61B
; ---------------------------------------------------------------------------

loc_611:				; CODE XREF: _d2i_SSL_SESSION+5E2j
		mov	dword ptr [esi+0A8h], 3

loc_61B:				; CODE XREF: _d2i_SSL_SESSION+60Fj
		mov	eax, [esi+9Ch]
		lea	edi, [esi+9Ch]
		test	eax, eax
		jz	short loc_63A
		push	eax
		call	_X509_free
		add	esp, 4
		mov	dword ptr [edi], 0

loc_63A:				; CODE XREF: _d2i_SSL_SESSION+629j
		mov	ecx, [esp+6Ch+var_14]
		mov	edx, [esp+6Ch+var_2C]
		test	ecx, ecx
		jz	loc_716
		cmp	byte ptr [edx],	0A3h ; '£'
		jnz	loc_716
		push	ecx
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], edx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_68C
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 208h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_68C:				; CODE XREF: _d2i_SSL_SESSION+678j
		cmp	ebx, 21h ; '!'
		jnz	short loc_6A8
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_6AC
; ---------------------------------------------------------------------------

loc_6A8:				; CODE XREF: _d2i_SSL_SESSION+68Fj
		mov	eax, [esp+6Ch+var_58]

loc_6AC:				; CODE XREF: _d2i_SSL_SESSION+6A6j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		push	edi
		call	_d2i_X509
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_6C9
		mov	ecx, 208h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_6C9:				; CODE XREF: _d2i_SSL_SESSION+6BDj
		cmp	ebx, 21h ; '!'
		jnz	short loc_702
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_702
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 208h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_702:				; CODE XREF: _d2i_SSL_SESSION+6CCj
					; _d2i_SSL_SESSION+6EEj
		mov	eax, [esp+6Ch+var_C]
		mov	edx, [esp+6Ch+var_2C]
		sub	eax, edx
		mov	ecx, [esp+6Ch+var_14]
		add	ecx, eax
		mov	[esp+6Ch+var_14], ecx

loc_716:				; CODE XREF: _d2i_SSL_SESSION+644j
					; _d2i_SSL_SESSION+64Dj
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	ecx, ecx
		jz	loc_84A
		cmp	byte ptr [edx],	0A4h ; '¤'
		jnz	loc_84A
		push	ecx
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], edx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_770
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 20Ch
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_770:				; CODE XREF: _d2i_SSL_SESSION+75Cj
		cmp	ebx, 21h ; '!'
		jnz	short loc_78C
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_790
; ---------------------------------------------------------------------------

loc_78C:				; CODE XREF: _d2i_SSL_SESSION+773j
		mov	eax, [esp+6Ch+var_58]

loc_790:				; CODE XREF: _d2i_SSL_SESSION+78Aj
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_7B1
		mov	ecx, 20Ch
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_7B1:				; CODE XREF: _d2i_SSL_SESSION+7A5j
		cmp	ebx, 21h ; '!'
		jnz	short loc_7EA
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_7EA
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 20Ch
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_7EA:				; CODE XREF: _d2i_SSL_SESSION+7B4j
					; _d2i_SSL_SESSION+7D6j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		cmp	[esp+6Ch+Src], 0
		jz	short loc_84A
		mov	eax, [esp+6Ch+Size]
		cmp	eax, 20h ; ' '
		jle	short loc_818
		mov	[esp+6Ch+var_24], 10Fh
		mov	ecx, 211h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_818:				; CODE XREF: _d2i_SSL_SESSION+804j
		mov	[esi+68h], eax
		lea	eax, [esi+6Ch]
		push	[esp+6Ch+Size]	; Size
		push	[esp+70h+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		push	[esp+78h+Src]
		call	_CRYPTO_free
		add	esp, 10h
		mov	[esp+6Ch+Src], 0
		mov	[esp+6Ch+Size],	0
		jmp	short loc_851
; ---------------------------------------------------------------------------

loc_84A:				; CODE XREF: _d2i_SSL_SESSION+728j
					; _d2i_SSL_SESSION+731j ...
		mov	dword ptr [esi+68h], 0

loc_851:				; CODE XREF: _d2i_SSL_SESSION+848j
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+var_3C], 0
		test	eax, eax
		jz	loc_931
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A5h ; '¥'
		jnz	loc_931
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_8AB
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 21Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_8AB:				; CODE XREF: _d2i_SSL_SESSION+897j
		cmp	ebx, 21h ; '!'
		jnz	short loc_8C7
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_8CB
; ---------------------------------------------------------------------------

loc_8C7:				; CODE XREF: _d2i_SSL_SESSION+8AEj
		mov	eax, [esp+6Ch+var_58]

loc_8CB:				; CODE XREF: _d2i_SSL_SESSION+8C5j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+arg_0]
		push	eax
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_8EC
		mov	ecx, 21Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_8EC:				; CODE XREF: _d2i_SSL_SESSION+8E0j
		cmp	ebx, 21h ; '!'
		jnz	short loc_925
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_925
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 21Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_925:				; CODE XREF: _d2i_SSL_SESSION+8EFj
					; _d2i_SSL_SESSION+911j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax

loc_931:				; CODE XREF: _d2i_SSL_SESSION+85Fj
					; _d2i_SSL_SESSION+86Cj
		cmp	[esp+6Ch+var_34], 0
		jz	short loc_965
		push	[esp+6Ch+arg_0]
		call	_ASN1_INTEGER_get
		mov	[esi+0A0h], eax
		push	[esp+70h+var_34]
		call	_CRYPTO_free
		add	esp, 8
		mov	[esp+6Ch+var_34], 0
		mov	[esp+6Ch+var_3C], 0
		jmp	short loc_96F
; ---------------------------------------------------------------------------

loc_965:				; CODE XREF: _d2i_SSL_SESSION+936j
		mov	dword ptr [esi+0A0h], 0

loc_96F:				; CODE XREF: _d2i_SSL_SESSION+963j
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	eax, eax
		jz	loc_A7D
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A6h ; '¦'
		jnz	loc_A7D
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_9D1
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 22Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_9D1:				; CODE XREF: _d2i_SSL_SESSION+9BDj
		cmp	ebx, 21h ; '!'
		jnz	short loc_9ED
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_9F1
; ---------------------------------------------------------------------------

loc_9ED:				; CODE XREF: _d2i_SSL_SESSION+9D4j
		mov	eax, [esp+6Ch+var_58]

loc_9F1:				; CODE XREF: _d2i_SSL_SESSION+9EBj
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_A12
		mov	ecx, 22Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_A12:				; CODE XREF: _d2i_SSL_SESSION+A06j
		cmp	ebx, 21h ; '!'
		jnz	short loc_A4B
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_A4B
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 22Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_A4B:				; CODE XREF: _d2i_SSL_SESSION+A15j
					; _d2i_SSL_SESSION+A37j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Src]
		test	eax, eax
		jz	short loc_A7D
		push	[esp+6Ch+Size]
		push	eax
		call	_BUF_strndup
		mov	[esi+0D0h], eax
		push	[esp+74h+Src]
		call	_CRYPTO_free
		add	esp, 0Ch
		jmp	short loc_A87
; ---------------------------------------------------------------------------

loc_A7D:				; CODE XREF: _d2i_SSL_SESSION+985j
					; _d2i_SSL_SESSION+992j ...
		mov	dword ptr [esi+0D0h], 0

loc_A87:				; CODE XREF: _d2i_SSL_SESSION+A7Bj
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	eax, eax
		jz	loc_B95
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A7h ; '§'
		jnz	loc_B95
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_AE9
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 237h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_AE9:				; CODE XREF: _d2i_SSL_SESSION+AD5j
		cmp	ebx, 21h ; '!'
		jnz	short loc_B05
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_B09
; ---------------------------------------------------------------------------

loc_B05:				; CODE XREF: _d2i_SSL_SESSION+AECj
		mov	eax, [esp+6Ch+var_58]

loc_B09:				; CODE XREF: _d2i_SSL_SESSION+B03j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_B2A
		mov	ecx, 237h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_B2A:				; CODE XREF: _d2i_SSL_SESSION+B1Ej
		cmp	ebx, 21h ; '!'
		jnz	short loc_B63
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_B63
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 237h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_B63:				; CODE XREF: _d2i_SSL_SESSION+B2Dj
					; _d2i_SSL_SESSION+B4Fj
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Src]
		test	eax, eax
		jz	short loc_B95
		push	[esp+6Ch+Size]
		push	eax
		call	_BUF_strndup
		mov	[esi+8Ch], eax
		push	[esp+74h+Src]
		call	_CRYPTO_free
		add	esp, 0Ch
		jmp	short loc_B9F
; ---------------------------------------------------------------------------

loc_B95:				; CODE XREF: _d2i_SSL_SESSION+A9Dj
					; _d2i_SSL_SESSION+AAAj ...
		mov	dword ptr [esi+8Ch], 0

loc_B9F:				; CODE XREF: _d2i_SSL_SESSION+B93j
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	eax, eax
		jz	loc_CBD
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A8h ; '¨'
		jnz	loc_CBD
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_C01
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 242h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_C01:				; CODE XREF: _d2i_SSL_SESSION+BEDj
		cmp	ebx, 21h ; '!'
		jnz	short loc_C1D
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_C21
; ---------------------------------------------------------------------------

loc_C1D:				; CODE XREF: _d2i_SSL_SESSION+C04j
		mov	eax, [esp+6Ch+var_58]

loc_C21:				; CODE XREF: _d2i_SSL_SESSION+C1Bj
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_C42
		mov	ecx, 242h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_C42:				; CODE XREF: _d2i_SSL_SESSION+C36j
		cmp	ebx, 21h ; '!'
		jnz	short loc_C7B
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_C7B
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 242h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_C7B:				; CODE XREF: _d2i_SSL_SESSION+C45j
					; _d2i_SSL_SESSION+C67j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Src]
		test	eax, eax
		jz	short loc_CBD
		push	[esp+6Ch+Size]
		push	eax
		call	_BUF_strndup
		mov	[esi+90h], eax
		push	[esp+74h+Src]
		call	_CRYPTO_free
		add	esp, 0Ch
		mov	[esp+6Ch+Src], 0
		mov	[esp+6Ch+Size],	0
		jmp	short loc_CC7
; ---------------------------------------------------------------------------

loc_CBD:				; CODE XREF: _d2i_SSL_SESSION+BB5j
					; _d2i_SSL_SESSION+BC2j ...
		mov	dword ptr [esi+90h], 0

loc_CC7:				; CODE XREF: _d2i_SSL_SESSION+CBBj
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+var_3C], 0
		test	eax, eax
		jz	loc_DA7
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0A9h ; '©'
		jnz	loc_DA7
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_D21
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 24Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_D21:				; CODE XREF: _d2i_SSL_SESSION+D0Dj
		cmp	ebx, 21h ; '!'
		jnz	short loc_D3D
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_D41
; ---------------------------------------------------------------------------

loc_D3D:				; CODE XREF: _d2i_SSL_SESSION+D24j
		mov	eax, [esp+6Ch+var_58]

loc_D41:				; CODE XREF: _d2i_SSL_SESSION+D3Bj
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+arg_0]
		push	eax
		call	_d2i_ASN1_INTEGER
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_D62
		mov	ecx, 24Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_D62:				; CODE XREF: _d2i_SSL_SESSION+D56j
		cmp	ebx, 21h ; '!'
		jnz	short loc_D9B
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_D9B
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 24Eh
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_D9B:				; CODE XREF: _d2i_SSL_SESSION+D65j
					; _d2i_SSL_SESSION+D87j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax

loc_DA7:				; CODE XREF: _d2i_SSL_SESSION+CD5j
					; _d2i_SSL_SESSION+CE2j
		cmp	[esp+6Ch+var_34], 0
		jz	short loc_DDB
		push	[esp+6Ch+arg_0]
		call	_ASN1_INTEGER_get
		mov	[esi+0ECh], eax
		push	[esp+70h+var_34]
		call	_CRYPTO_free
		add	esp, 8
		mov	[esp+6Ch+var_34], 0
		mov	[esp+6Ch+var_3C], 0
		jmp	short loc_E00
; ---------------------------------------------------------------------------

loc_DDB:				; CODE XREF: _d2i_SSL_SESSION+DACj
		cmp	dword ptr [esi+0E8h], 0
		jz	short loc_DF6
		cmp	dword ptr [esi+44h], 0
		jz	short loc_DF6
		mov	dword ptr [esi+0ECh], 0FFFFFFFFh
		jmp	short loc_E00
; ---------------------------------------------------------------------------

loc_DF6:				; CODE XREF: _d2i_SSL_SESSION+DE2j
					; _d2i_SSL_SESSION+DE8j
		mov	dword ptr [esi+0ECh], 0

loc_E00:				; CODE XREF: _d2i_SSL_SESSION+DD9j
					; _d2i_SSL_SESSION+DF4j
		mov	eax, [esp+6Ch+var_14]
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	eax, eax
		jz	loc_F02
		mov	ecx, [esp+6Ch+var_2C]
		cmp	byte ptr [ecx],	0AAh ; 'ª'
		jnz	loc_F02
		push	eax
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], ecx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_E62
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 25Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_E62:				; CODE XREF: _d2i_SSL_SESSION+E4Ej
		cmp	ebx, 21h ; '!'
		jnz	short loc_E7E
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_E82
; ---------------------------------------------------------------------------

loc_E7E:				; CODE XREF: _d2i_SSL_SESSION+E65j
		mov	eax, [esp+6Ch+var_58]

loc_E82:				; CODE XREF: _d2i_SSL_SESSION+E7Cj
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_EA3
		mov	ecx, 25Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_EA3:				; CODE XREF: _d2i_SSL_SESSION+E97j
		cmp	ebx, 21h ; '!'
		jnz	short loc_EDC
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_EDC
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 25Ah
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_EDC:				; CODE XREF: _d2i_SSL_SESSION+EA6j
					; _d2i_SSL_SESSION+EC8j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Src]
		test	eax, eax
		jz	short loc_F02
		mov	[esi+0E4h], eax
		mov	eax, [esp+6Ch+Size]
		mov	[esi+0E8h], eax
		jmp	short loc_F0C
; ---------------------------------------------------------------------------

loc_F02:				; CODE XREF: _d2i_SSL_SESSION+E16j
					; _d2i_SSL_SESSION+E23j ...
		mov	dword ptr [esi+0E4h], 0

loc_F0C:				; CODE XREF: _d2i_SSL_SESSION+F00j
		mov	ecx, [esp+6Ch+var_14]
		mov	edx, [esp+6Ch+var_2C]
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	ecx, ecx
		jz	loc_1021
		cmp	byte ptr [edx],	0ABh ; '«'
		jnz	loc_1021
		push	ecx
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], edx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_F6E
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 266h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_F6E:				; CODE XREF: _d2i_SSL_SESSION+F5Aj
		cmp	ebx, 21h ; '!'
		jnz	short loc_F8A
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_F8E
; ---------------------------------------------------------------------------

loc_F8A:				; CODE XREF: _d2i_SSL_SESSION+F71j
		mov	eax, [esp+6Ch+var_58]

loc_F8E:				; CODE XREF: _d2i_SSL_SESSION+F88j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_FAF
		mov	ecx, 266h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_FAF:				; CODE XREF: _d2i_SSL_SESSION+FA3j
		cmp	ebx, 21h ; '!'
		jnz	short loc_FE8
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_FE8
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 266h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_FE8:				; CODE XREF: _d2i_SSL_SESSION+FB2j
					; _d2i_SSL_SESSION+FD4j
		mov	eax, [esp+6Ch+var_C]
		mov	edx, [esp+6Ch+var_2C]
		sub	eax, edx
		mov	ecx, [esp+6Ch+var_14]
		add	ecx, eax
		mov	eax, [esp+6Ch+Src]
		mov	[esp+6Ch+var_14], ecx
		test	eax, eax
		jz	short loc_1021
		movzx	eax, byte ptr [eax]
		mov	[esi+0B0h], eax
		push	[esp+6Ch+Src]
		call	_CRYPTO_free
		mov	ecx, [esp+70h+var_14]
		add	esp, 4
		mov	edx, [esp+6Ch+var_2C]

loc_1021:				; CODE XREF: _d2i_SSL_SESSION+F26j
					; _d2i_SSL_SESSION+F2Fj ...
		mov	[esp+6Ch+Size],	0
		mov	[esp+6Ch+Src], 0
		test	ecx, ecx
		jz	loc_1134
		cmp	byte ptr [edx],	0ACh ; '¬'
		jnz	loc_1134
		push	ecx
		lea	eax, [esp+70h+var_50]
		mov	[esp+70h+var_C], edx
		push	eax
		lea	eax, [esp+74h+var_54]
		push	eax
		lea	eax, [esp+78h+var_58]
		push	eax
		lea	eax, [esp+7Ch+var_2C]
		push	eax
		call	_ASN1_get_object
		mov	ebx, eax
		add	esp, 14h
		test	bl, bl
		jns	short loc_107B
		mov	[esp+6Ch+var_24], 3Bh ;	';'
		mov	ecx, 271h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_107B:				; CODE XREF: _d2i_SSL_SESSION+1067j
		cmp	ebx, 21h ; '!'
		jnz	short loc_1097
		mov	ecx, [esp+6Ch+var_14]
		mov	eax, [esp+6Ch+var_C]
		sub	ecx, [esp+6Ch+var_2C]
		add	eax, 0FFFFFFFEh
		add	eax, ecx
		mov	[esp+6Ch+var_58], eax
		jmp	short loc_109B
; ---------------------------------------------------------------------------

loc_1097:				; CODE XREF: _d2i_SSL_SESSION+107Ej
		mov	eax, [esp+6Ch+var_58]

loc_109B:				; CODE XREF: _d2i_SSL_SESSION+1095j
		push	eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_d2i_ASN1_OCTET_STRING
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10BC
		mov	ecx, 271h
		jmp	loc_1154
; ---------------------------------------------------------------------------

loc_10BC:				; CODE XREF: _d2i_SSL_SESSION+10B0j
		cmp	ebx, 21h ; '!'
		jnz	short loc_10F2
		mov	eax, [esp+6Ch+var_14]
		sub	eax, [esp+6Ch+var_2C]
		add	eax, [esp+6Ch+var_C]
		push	eax
		mov	[esp+70h+var_58], eax
		lea	eax, [esp+70h+var_2C]
		push	eax
		call	_ASN1_const_check_infinite_end
		add	esp, 8
		test	eax, eax
		jnz	short loc_10F2
		mov	[esp+6Ch+var_24], 3Fh ;	'?'
		mov	ecx, 271h
		jmp	short loc_1154
; ---------------------------------------------------------------------------

loc_10F2:				; CODE XREF: _d2i_SSL_SESSION+10BFj
					; _d2i_SSL_SESSION+10E1j
		mov	eax, [esp+6Ch+var_C]
		sub	eax, [esp+6Ch+var_2C]
		add	[esp+6Ch+var_14], eax
		mov	eax, [esp+6Ch+Src]
		test	eax, eax
		jz	short loc_1134
		push	[esp+6Ch+Size]
		push	eax
		call	_BUF_strndup
		mov	[esi+0F0h], eax
		push	[esp+74h+Src]
		call	_CRYPTO_free
		add	esp, 0Ch
		mov	[esp+6Ch+Src], 0
		mov	[esp+6Ch+Size],	0
		jmp	short loc_113E
; ---------------------------------------------------------------------------

loc_1134:				; CODE XREF: _d2i_SSL_SESSION+1033j
					; _d2i_SSL_SESSION+103Cj ...
		mov	dword ptr [esi+0F0h], 0

loc_113E:				; CODE XREF: _d2i_SSL_SESSION+1132j
		lea	eax, [esp+6Ch+var_2C]
		push	eax
		call	_asn1_const_Finish
		add	esp, 4
		test	eax, eax
		jnz	short loc_11A4
		mov	ecx, 27Bh

loc_1154:				; CODE XREF: _d2i_SSL_SESSION+43j
					; _d2i_SSL_SESSION+91j	...
		mov	[esp+6Ch+var_4], ecx

$err$158:				; CODE XREF: _d2i_SSL_SESSION+392j
		push	ecx
		push	offset ??_C@_0BB@OEPFCJAK@?4?2ssl?2ssl_asn1?4c?$AA@ ; ".\\ssl\\ssl_asn1.c"
		push	[esp+74h+var_24]
		push	67h ; 'g'
		push	0Dh
		call	_ERR_put_error
		mov	eax, [esp+80h+arg_4]
		mov	ecx, [eax]
		mov	eax, [esp+80h+var_C]
		sub	eax, ecx
		push	eax
		push	ecx
		call	_asn1_add_error
		add	esp, 1Ch
		test	esi, esi
		jz	short loc_119A
		test	ebp, ebp
		jz	short loc_1191
		cmp	[ebp+0], esi
		jz	short loc_119A

loc_1191:				; CODE XREF: _d2i_SSL_SESSION+118Aj
		push	esi
		call	_SSL_SESSION_free
		add	esp, 4

loc_119A:				; CODE XREF: _d2i_SSL_SESSION+1186j
					; _d2i_SSL_SESSION+118Fj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_11A4:				; CODE XREF: _d2i_SSL_SESSION+114Dj
		mov	ecx, [esp+6Ch+arg_4]
		mov	eax, [esp+6Ch+var_2C]
		mov	[ecx], eax
		test	ebp, ebp
		jz	short loc_11B5
		mov	[ebp+0], esi

loc_11B5:				; CODE XREF: _d2i_SSL_SESSION+11B0j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 5Ch
		retn
_d2i_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _i2d_SSL_SESSION
_i2d_SSL_SESSION proc near

var_180		= dword	ptr -180h
var_179		= byte ptr -179h
var_178		= byte ptr -178h
var_177		= byte ptr -177h
var_176		= byte ptr -176h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= byte ptr -34h
var_2C		= byte ptr -2Ch
var_24		= byte ptr -24h
var_1C		= byte ptr -1Ch
var_14		= byte ptr -14h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 180h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+180h+var_4], eax
		mov	ecx, [esp+180h+arg_4]
		push	edi
		mov	edi, [esp+184h+arg_0]
		mov	[esp+184h+var_148], ecx
		mov	[esp+184h+var_174], 0
		mov	[esp+184h+var_170], 0
		mov	[esp+184h+var_16C], 0
		mov	[esp+184h+var_168], 0
		mov	[esp+184h+var_164], 0
		mov	[esp+184h+var_158], 0
		mov	[esp+184h+var_154], 0
		mov	[esp+184h+var_160], 0
		mov	[esp+184h+var_15C], 0
		mov	[esp+184h+var_150], 0
		mov	[esp+184h+var_14C], 0
		test	edi, edi
		jnz	short loc_125F

loc_1247:				; CODE XREF: _i2d_SSL_SESSION+AFj
		xor	eax, eax
		pop	edi
		mov	ecx, [esp+180h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 180h
		retn
; ---------------------------------------------------------------------------

loc_125F:				; CODE XREF: _i2d_SSL_SESSION+85j
		cmp	dword ptr [edi+0B4h], 0
		jnz	short loc_1271
		cmp	dword ptr [edi+0B8h], 0
		jz	short loc_1247

loc_1271:				; CODE XREF: _i2d_SSL_SESSION+A6j
		lea	eax, [esp+184h+var_34]
		mov	[esp+184h+var_144], 8
		mov	[esp+184h+var_13C], eax
		lea	eax, [esp+184h+var_144]
		push	1
		push	eax
		mov	[esp+18Ch+var_140], 2
		call	_ASN1_INTEGER_set
		push	dword ptr [edi]
		lea	eax, [esp+190h+var_2C]
		mov	[esp+190h+var_134], 8
		mov	[esp+190h+var_12C], eax
		lea	eax, [esp+190h+var_134]
		push	eax
		mov	[esp+194h+var_130], 2
		call	_ASN1_INTEGER_set
		mov	ecx, [edi+0B4h]
		lea	eax, [esp+194h+var_178]
		add	esp, 10h
		mov	[esp+184h+var_120], 4
		mov	[esp+184h+var_11C], eax
		test	ecx, ecx
		jnz	short loc_12E4
		mov	ecx, [edi+0B8h]
		jmp	short loc_12E7
; ---------------------------------------------------------------------------

loc_12E4:				; CODE XREF: _i2d_SSL_SESSION+11Aj
		mov	ecx, [ecx+8]

loc_12E7:				; CODE XREF: _i2d_SSL_SESSION+122j
		cmp	dword ptr [edi], 2
		mov	eax, ecx
		jnz	short loc_130C
		sar	eax, 10h
		mov	[esp+184h+var_178], al
		mov	eax, ecx
		sar	eax, 8
		mov	[esp+184h+var_124], 3
		mov	[esp+184h+var_177], al
		mov	[esp+184h+var_176], cl
		jmp	short loc_131F
; ---------------------------------------------------------------------------

loc_130C:				; CODE XREF: _i2d_SSL_SESSION+12Cj
		sar	eax, 8
		mov	[esp+184h+var_124], 2
		mov	[esp+184h+var_178], al
		mov	[esp+184h+var_177], cl

loc_131F:				; CODE XREF: _i2d_SSL_SESSION+14Aj
		cmp	dword ptr [edi+0B0h], 0
		jz	short loc_134A
		mov	al, [edi+0B0h]
		mov	[esp+184h+var_179], al
		lea	eax, [esp+184h+var_179]
		mov	[esp+184h+var_114], 1
		mov	[esp+184h+var_110], 4
		mov	[esp+184h+var_10C], eax

loc_134A:				; CODE XREF: _i2d_SSL_SESSION+166j
		mov	eax, [edi+10h]
		mov	[esp+184h+var_104], eax
		lea	eax, [edi+14h]
		mov	[esp+184h+var_FC], eax
		mov	eax, [edi+44h]
		mov	[esp+184h+var_F4], eax
		lea	eax, [edi+48h]
		mov	[esp+184h+var_EC], eax
		mov	eax, [edi+68h]
		mov	[esp+184h+var_E4], eax
		lea	eax, [edi+6Ch]
		mov	[esp+184h+var_DC], eax
		mov	eax, [edi+4]
		mov	[esp+184h+var_D4], eax
		lea	eax, [edi+8]
		mov	[esp+184h+var_CC], eax
		mov	eax, [edi+0ACh]
		mov	[esp+184h+var_100], 4
		mov	[esp+184h+var_F0], 4
		mov	[esp+184h+var_E0], 4
		mov	[esp+184h+var_D0], 4
		test	eax, eax
		jz	short loc_1405
		push	eax
		lea	eax, [esp+188h+var_C4]
		mov	[esp+188h+var_C4], 8
		lea	ecx, [esp+188h+var_24]
		mov	[esp+188h+var_C0], 2
		push	eax
		mov	[esp+18Ch+var_BC], ecx
		call	_ASN1_INTEGER_set
		add	esp, 8

loc_1405:				; CODE XREF: _i2d_SSL_SESSION+20Ej
		mov	eax, [edi+0A8h]
		test	eax, eax
		jz	short loc_1444
		push	eax
		lea	eax, [esp+188h+var_B4]
		mov	[esp+188h+var_B4], 8
		lea	ecx, [esp+188h+var_1C]
		mov	[esp+188h+var_B0], 2
		push	eax
		mov	[esp+18Ch+var_AC], ecx
		call	_ASN1_INTEGER_set
		add	esp, 8

loc_1444:				; CODE XREF: _i2d_SSL_SESSION+24Dj
		mov	eax, [edi+0A0h]
		test	eax, eax
		jz	short loc_1483
		push	eax
		lea	eax, [esp+188h+var_A4]
		mov	[esp+188h+var_A4], 8
		lea	ecx, [esp+188h+var_14]
		mov	[esp+188h+var_A0], 2
		push	eax
		mov	[esp+18Ch+var_9C], ecx
		call	_ASN1_INTEGER_set
		add	esp, 8

loc_1483:				; CODE XREF: _i2d_SSL_SESSION+28Cj
		mov	edx, [edi+0D0h]
		push	esi
		test	edx, edx
		jz	short loc_14B5
		mov	ecx, edx
		lea	esi, [ecx+1]

loc_1493:				; CODE XREF: _i2d_SSL_SESSION+2D8j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1493
		sub	ecx, esi
		mov	[esp+188h+var_90], 4
		mov	[esp+188h+var_94], ecx
		mov	[esp+188h+var_8C], edx

loc_14B5:				; CODE XREF: _i2d_SSL_SESSION+2CCj
		mov	ecx, [edi+0E4h]
		test	ecx, ecx
		jz	short loc_14DE
		mov	eax, [edi+0E8h]
		mov	[esp+188h+var_74], eax
		mov	[esp+188h+var_70], 4
		mov	[esp+188h+var_6C], ecx

loc_14DE:				; CODE XREF: _i2d_SSL_SESSION+2FDj
		mov	eax, [edi+0ECh]
		test	eax, eax
		jle	short loc_151D
		push	eax
		lea	eax, [esp+18Ch+var_84]
		mov	[esp+18Ch+var_84], 8
		lea	ecx, [esp+18Ch+var_C]
		mov	[esp+18Ch+var_80], 2
		push	eax
		mov	[esp+190h+var_7C], ecx
		call	_ASN1_INTEGER_set
		add	esp, 8

loc_151D:				; CODE XREF: _i2d_SSL_SESSION+326j
		mov	edx, [edi+8Ch]
		test	edx, edx
		jz	short loc_1552
		mov	ecx, edx
		lea	esi, [ecx+1]
		nop	dword ptr [eax+00h]

loc_1530:				; CODE XREF: _i2d_SSL_SESSION+375j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1530
		sub	ecx, esi
		mov	[esp+188h+var_60], 4
		mov	[esp+188h+var_64], ecx
		mov	[esp+188h+var_5C], edx

loc_1552:				; CODE XREF: _i2d_SSL_SESSION+365j
		mov	edx, [edi+90h]
		test	edx, edx
		jz	short loc_1583
		mov	ecx, edx
		lea	esi, [ecx+1]

loc_1561:				; CODE XREF: _i2d_SSL_SESSION+3A6j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1561
		sub	ecx, esi
		mov	[esp+188h+var_50], 4
		mov	[esp+188h+var_54], ecx
		mov	[esp+188h+var_4C], edx

loc_1583:				; CODE XREF: _i2d_SSL_SESSION+39Aj
		mov	edx, [edi+0F0h]
		test	edx, edx
		jz	short loc_15B4
		mov	ecx, edx
		lea	esi, [ecx+1]

loc_1592:				; CODE XREF: _i2d_SSL_SESSION+3D7j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1592
		sub	ecx, esi
		mov	[esp+188h+var_40], 4
		mov	[esp+188h+var_44], ecx
		mov	[esp+188h+var_3C], edx

loc_15B4:				; CODE XREF: _i2d_SSL_SESSION+3CBj
		lea	eax, [esp+188h+var_144]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		mov	esi, eax
		lea	eax, [esp+190h+var_134]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		add	esi, eax
		lea	eax, [esp+198h+var_124]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esi, eax
		lea	eax, [esp+1A0h+var_F4]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esi, eax
		lea	eax, [esp+1A8h+var_104]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 28h
		add	esi, eax
		cmp	dword ptr [edi+4], 0
		jbe	short loc_161D
		lea	eax, [esp+188h+var_D4]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 8
		add	esi, eax

loc_161D:				; CODE XREF: _i2d_SSL_SESSION+447j
		cmp	dword ptr [edi+0ACh], 0
		push	ebx
		jz	short loc_164B
		lea	eax, [esp+18Ch+var_C4]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		mov	ebx, eax
		push	1
		push	ebx
		push	1
		mov	[esp+1A0h+var_174], ebx
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_164B:				; CODE XREF: _i2d_SSL_SESSION+465j
		cmp	dword ptr [edi+0A8h], 0
		jz	short loc_1678
		lea	eax, [esp+18Ch+var_B4]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		mov	ebx, eax
		push	2
		push	ebx
		push	1
		mov	[esp+1A0h+var_170], ebx
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_1678:				; CODE XREF: _i2d_SSL_SESSION+492j
		mov	eax, [edi+9Ch]
		test	eax, eax
		jz	short loc_169D
		push	0
		push	eax
		call	_i2d_X509
		push	3
		push	eax
		push	1
		mov	[esp+1A0h+var_16C], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_169D:				; CODE XREF: _i2d_SSL_SESSION+4C0j
		push	ebp
		lea	eax, [esp+190h+var_E4]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		mov	ebp, eax
		push	4
		push	ebp
		push	1
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax
		cmp	dword ptr [edi+0A0h], 0
		jz	short loc_16E9
		lea	eax, [esp+190h+var_A4]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		push	5
		push	eax
		push	1
		mov	[esp+1A4h+var_168], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_16E9:				; CODE XREF: _i2d_SSL_SESSION+505j
		cmp	dword ptr [edi+0ECh], 0
		jle	short loc_1714
		lea	eax, [esp+190h+var_84]
		push	0
		push	eax
		call	_i2d_ASN1_INTEGER
		push	9
		push	eax
		push	1
		mov	[esp+1A4h+var_158], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_1714:				; CODE XREF: _i2d_SSL_SESSION+530j
		cmp	dword ptr [edi+0E4h], 0
		jz	short loc_173F
		lea	eax, [esp+190h+var_74]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	0Ah
		push	eax
		push	1
		mov	[esp+1A4h+var_154], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_173F:				; CODE XREF: _i2d_SSL_SESSION+55Bj
		cmp	dword ptr [edi+0D0h], 0
		jz	short loc_176A
		lea	eax, [esp+190h+var_94]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	6
		push	eax
		push	1
		mov	[esp+1A4h+var_164], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_176A:				; CODE XREF: _i2d_SSL_SESSION+586j
		cmp	dword ptr [edi+0B0h], 0
		jz	short loc_1792
		lea	eax, [esp+190h+var_114]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	0Bh
		push	eax
		push	1
		mov	[esp+1A4h+var_150], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_1792:				; CODE XREF: _i2d_SSL_SESSION+5B1j
		cmp	dword ptr [edi+8Ch], 0
		jz	short loc_17BD
		lea	eax, [esp+190h+var_64]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	7
		push	eax
		push	1
		mov	[esp+1A4h+var_160], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_17BD:				; CODE XREF: _i2d_SSL_SESSION+5D9j
		cmp	dword ptr [edi+90h], 0
		jz	short loc_17E8
		lea	eax, [esp+190h+var_54]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	8
		push	eax
		push	1
		mov	[esp+1A4h+var_15C], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_17E8:				; CODE XREF: _i2d_SSL_SESSION+604j
		cmp	dword ptr [edi+0F0h], 0
		jz	short loc_1813
		lea	eax, [esp+190h+var_44]
		push	0
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		push	0Ch
		push	eax
		push	1
		mov	[esp+1A4h+var_14C], eax
		call	_ASN1_object_size
		add	esp, 14h
		add	esi, eax

loc_1813:				; CODE XREF: _i2d_SSL_SESSION+62Fj
		push	10h
		push	esi
		push	1
		call	_ASN1_object_size
		mov	ebx, eax
		add	esp, 0Ch
		mov	eax, [esp+190h+var_148]
		test	eax, eax
		jz	loc_1B3B
		mov	eax, [eax]
		push	0
		push	10h
		push	esi
		mov	[esp+19Ch+var_180], eax
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_144]
		push	eax
		call	_i2d_ASN1_INTEGER
		lea	eax, [esp+1ACh+var_180]
		push	eax
		lea	eax, [esp+1B0h+var_134]
		push	eax
		call	_i2d_ASN1_INTEGER
		lea	eax, [esp+1B4h+var_180]
		push	eax
		lea	eax, [esp+1B8h+var_124]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		lea	eax, [esp+1BCh+var_180]
		push	eax
		lea	eax, [esp+1C0h+var_F4]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		lea	eax, [esp+1C4h+var_180]
		push	eax
		lea	eax, [esp+1C8h+var_104]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 3Ch
		cmp	dword ptr [edi+4], 0
		jbe	short loc_18C3
		mov	esi, [esp+190h+var_180]
		lea	eax, [esp+190h+var_180]
		push	eax
		lea	eax, [esp+194h+var_D4]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		mov	al, [esi]
		add	esp, 8
		and	al, 20h
		or	al, 80h
		mov	[esi], al

loc_18C3:				; CODE XREF: _i2d_SSL_SESSION+6E0j
		cmp	dword ptr [edi+0ACh], 0
		jz	short loc_18F8
		push	80h ; '€'
		push	1
		push	[esp+198h+var_174]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_C4]
		push	eax
		call	_i2d_ASN1_INTEGER
		add	esp, 1Ch

loc_18F8:				; CODE XREF: _i2d_SSL_SESSION+70Aj
		cmp	dword ptr [edi+0A8h], 0
		jz	short loc_192D
		push	80h ; '€'
		push	2
		push	[esp+198h+var_170]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_B4]
		push	eax
		call	_i2d_ASN1_INTEGER
		add	esp, 1Ch

loc_192D:				; CODE XREF: _i2d_SSL_SESSION+73Fj
		cmp	dword ptr [edi+9Ch], 0
		jz	short loc_1960
		push	80h ; '€'
		push	3
		push	[esp+198h+var_16C]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		push	dword ptr [edi+9Ch]
		call	_i2d_X509
		add	esp, 1Ch

loc_1960:				; CODE XREF: _i2d_SSL_SESSION+774j
		push	80h ; '€'
		push	4
		push	ebp
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_E4]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch
		cmp	dword ptr [edi+0A0h], 0
		jz	short loc_19BE
		push	80h ; '€'
		push	5
		push	[esp+198h+var_168]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_A4]
		push	eax
		call	_i2d_ASN1_INTEGER
		add	esp, 1Ch

loc_19BE:				; CODE XREF: _i2d_SSL_SESSION+7D0j
		cmp	dword ptr [edi+0D0h], 0
		jz	short loc_19F3
		push	80h ; '€'
		push	6
		push	[esp+198h+var_164]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_94]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_19F3:				; CODE XREF: _i2d_SSL_SESSION+805j
		cmp	dword ptr [edi+8Ch], 0
		jz	short loc_1A28
		push	80h ; '€'
		push	7
		push	[esp+198h+var_160]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_64]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_1A28:				; CODE XREF: _i2d_SSL_SESSION+83Aj
		cmp	dword ptr [edi+90h], 0
		jz	short loc_1A5D
		push	80h ; '€'
		push	8
		push	[esp+198h+var_15C]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_54]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_1A5D:				; CODE XREF: _i2d_SSL_SESSION+86Fj
		cmp	dword ptr [edi+0ECh], 0
		jle	short loc_1A92
		push	80h ; '€'
		push	9
		push	[esp+198h+var_158]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_84]
		push	eax
		call	_i2d_ASN1_INTEGER
		add	esp, 1Ch

loc_1A92:				; CODE XREF: _i2d_SSL_SESSION+8A4j
		cmp	dword ptr [edi+0E4h], 0
		jz	short loc_1AC7
		push	80h ; '€'
		push	0Ah
		push	[esp+198h+var_154]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_74]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_1AC7:				; CODE XREF: _i2d_SSL_SESSION+8D9j
		cmp	dword ptr [edi+0B0h], 0
		jz	short loc_1AFC
		push	80h ; '€'
		push	0Bh
		push	[esp+198h+var_150]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_114]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_1AFC:				; CODE XREF: _i2d_SSL_SESSION+90Ej
		cmp	dword ptr [edi+0F0h], 0
		jz	short loc_1B31
		push	80h ; '€'
		push	0Ch
		push	[esp+198h+var_14C]
		lea	eax, [esp+19Ch+var_180]
		push	1
		push	eax
		call	_ASN1_put_object
		lea	eax, [esp+1A4h+var_180]
		push	eax
		lea	eax, [esp+1A8h+var_44]
		push	eax
		call	_i2d_ASN1_OCTET_STRING
		add	esp, 1Ch

loc_1B31:				; CODE XREF: _i2d_SSL_SESSION+943j
		mov	ecx, [esp+190h+var_148]
		mov	eax, [esp+190h+var_180]
		mov	[ecx], eax

loc_1B3B:				; CODE XREF: _i2d_SSL_SESSION+668j
		mov	ecx, [esp+190h+var_4]
		mov	eax, ebx
		pop	ebp
		pop	ebx
		pop	esi
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 180h
		retn
_i2d_SSL_SESSION endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B58h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; time_t __cdecl static	time(time_t *Time)
_time		proc near
		jmp	dword ptr ds:__imp___time64
_time		endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B60h
; COMDAT (pick any)
		public ??_C@_0CK@IOHFIKED@os?4length?5?$DM?$DN?5?$CIint?$CJsizeof?$CIret?9?$DOse@
; `string'
??_C@_0CK@IOHFIKED@os?4length?5?$DM?$DN?5?$CIint?$CJsizeof?$CIret?9?$DOse@ db 'os.length <= (int)sizeof(ret->session_id)',0
					; DATA XREF: _d2i_SSL_SESSION+2B2o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1B8Ch
; COMDAT (pick any)
		public ??_C@_0BB@OEPFCJAK@?4?2ssl?2ssl_asn1?4c?$AA@
; `string'
??_C@_0BB@OEPFCJAK@?4?2ssl?2ssl_asn1?4c?$AA@ db	'.\ssl\ssl_asn1.c',0
					; DATA XREF: _d2i_SSL_SESSION+2BCo
					; _d2i_SSL_SESSION+1159o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; __time64_t __cdecl __time64(__time64_t *Time)
		extrn __imp___time64:near ; CODE XREF: _d2i_SSL_SESSION+4EEp
					; DATA XREF: _d2i_SSL_SESSION+4EEr ...
		extrn _BUF_strndup:near	; CODE XREF: _d2i_SSL_SESSION+A64p
					; _d2i_SSL_SESSION+B7Cp ...
		extrn _CRYPTO_free:near	; CODE XREF: _d2i_SSL_SESSION+EFp
					; _d2i_SSL_SESSION+159p ...
		extrn _OpenSSLDie:near	; CODE XREF: _d2i_SSL_SESSION+2C1p
		extrn _d2i_ASN1_INTEGER:near ; CODE XREF: _d2i_SSL_SESSION+BCp
					; _d2i_SSL_SESSION+11Ep ...
		extrn _i2d_ASN1_INTEGER:near ; CODE XREF: _i2d_SSL_SESSION+3FBp
					; _i2d_SSL_SESSION+409p ...
		extrn _d2i_ASN1_OCTET_STRING:near ; CODE XREF: _d2i_SSL_SESSION+197p
					; _d2i_SSL_SESSION+273p ...
		extrn _i2d_ASN1_OCTET_STRING:near ; CODE XREF: _i2d_SSL_SESSION+417p
					; _i2d_SSL_SESSION+428p ...
		extrn _ASN1_INTEGER_set:near ; CODE XREF: _i2d_SSL_SESSION+D3p
					; _i2d_SSL_SESSION+FAp	...
		extrn _ASN1_INTEGER_get:near ; CODE XREF: _d2i_SSL_SESSION+144p
					; _d2i_SSL_SESSION+4CBp ...
		extrn _asn1_const_Finish:near ;	CODE XREF: _d2i_SSL_SESSION+1143p
		extrn _ASN1_get_object:near ; CODE XREF: _d2i_SSL_SESSION+41Ap
					; _d2i_SSL_SESSION+537p ...
		extrn _ASN1_const_check_infinite_end:near ; CODE XREF: _d2i_SSL_SESSION+496p
					; _d2i_SSL_SESSION+5B3p ...
		extrn _ASN1_put_object:near ; CODE XREF: _i2d_SSL_SESSION+680p
					; _i2d_SSL_SESSION+71Ep ...
		extrn _ASN1_object_size:near ; CODE XREF: _i2d_SSL_SESSION+481p
					; _i2d_SSL_SESSION+4AEp ...
		extrn _ERR_put_error:near ; CODE XREF: _d2i_SSL_SESSION+1166p
		extrn _X509_free:near	; CODE XREF: _d2i_SSL_SESSION+62Cp
		extrn _d2i_X509:near	; CODE XREF: _d2i_SSL_SESSION+6B3p
		extrn _i2d_X509:near	; CODE XREF: _i2d_SSL_SESSION+4C5p
					; _i2d_SSL_SESSION+798p
		extrn _SSL_SESSION_new:near ; CODE XREF: _d2i_SSL_SESSION:loc_33p
		extrn _SSL_SESSION_free:near ; CODE XREF: _d2i_SSL_SESSION+1192p
		extrn _asn1_GetSequence:near ; CODE XREF: _d2i_SSL_SESSION+80p
		extrn _asn1_add_error:near ; CODE XREF:	_d2i_SSL_SESSION+117Cp
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _i2d_SSL_SESSION+93p
					; _i2d_SSL_SESSION+98Ap
		extrn __chkstk:near	; CODE XREF: _d2i_SSL_SESSION+5p
					; _i2d_SSL_SESSION+5p
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _d2i_SSL_SESSION+2D6p
					; _d2i_SSL_SESSION+333p ...
		extrn ___security_cookie:near ;	DATA XREF: _i2d_SSL_SESSION+Ar


		end
