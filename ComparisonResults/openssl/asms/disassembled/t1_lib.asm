;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	55C33915FA663DCE6CF3E8FE11F6D03A
; Input	CRC32 :	08C04838

; File Name   :	C:\compspace\Diff\openssl\obj\t1_lib.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
; `ssl_check_for_safari'::`2'::kSafariExtensionsBlock
?kSafariExtensionsBlock@?1??ssl_check_for_safari@@9@9 dd 8000A00h, 17000600h, 19001800h, 2000B00h, 1
					; DATA XREF: _ssl_check_for_safari+8Bo
					; _ssl_check_for_safari+E6o
; `ssl_check_for_safari'::`2'::kSafariTLS12ExtensionsBlock
?kSafariTLS12ExtensionsBlock@?1??ssl_check_for_safari@@9@9 dd 0C000D00h, 1050A00h, 1020104h, 3020304h
					; DATA XREF: _ssl_check_for_safari+B1o
		public _tls1_version_str
_tls1_version_str db 'TLSv1 part of OpenSSL 1.0.2h  3 May 2016',0
		align 10h
_ecformats_default dd 20100h		; DATA XREF: _ssl_add_clienthello_tlsext+2F1o
					; _tls1_get_formatlist:loc_4165o
_eccurves_auto	dd 19001700h, 1B001C00h, 1A001800h, 0E001600h, 0B000D00h
					; DATA XREF: _tls1_get_curvelist:loc_40D2o
		dd 9000C00h, 0A00h
_eccurves_all	dd 19001700h, 1B001C00h, 1A001800h, 0E001600h, 0B000D00h
					; DATA XREF: _tls1_get_curvelist+79o
					; _tls1_shared_curve+D9o ...
		dd 9000C00h, 14000A00h,	12001500h, 0F001300h, 11001000h
		dd 6000800h, 4000700h, 1000500h, 3000200h
_suiteb_curves	db 0, 17h		; DATA XREF: _tls1_get_curvelist+B4o
word_AA		dw 1800h		; DATA XREF: _tls1_get_curvelist+A3o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0ACh
; COMDAT (pick any)
		public ??_C@_0BA@OOFGCNEE@client?5finished?$AA@
; `string'
??_C@_0BA@OOFGCNEE@client?5finished?$AA@ db 'client finished',0 ; DATA XREF: .data:000001CCo
					; .data:00000214o ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BCh
; COMDAT (pick any)
		public ??_C@_0BA@MHGDKHGN@server?5finished?$AA@
; `string'
??_C@_0BA@MHGDKHGN@server?5finished?$AA@ db 'server finished',0 ; DATA XREF: .data:000001D4o
					; .data:0000021Co ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 0CCh
_nid_list	dd offset loc_2D0+1	; DATA XREF: _tls1_ec_curve_id2nid+Er
					; _tls1_shared_curve+187r
		dd offset loc_2D2
		dd offset loc_2D2+1
		dd offset loc_2D2+2
		dd offset loc_2D2+3
		dd offset loc_2D6
		dd offset loc_2D6+1
		dd offset loc_2D8
		dd offset loc_2D8+1
		dd offset loc_2DA
		dd offset loc_2DA+1
		dd offset loc_2DA+2
		dd offset loc_2DD
		dd offset loc_2DD+1
		dd offset loc_2C1+3
		dd offset loc_2C5
		dd offset loc_2C5+1
		dd offset loc_2C5+2
		dd offset byte_199
		dd offset loc_2C8
		dd offset loc_2C8+1
		dd offset loc_2CA
		dd offset byte_19F
		dd offset loc_2CA+1
		dd offset loc_2CC
		dd offset loc_39E+1
		dd offset loc_3A2+1
		dd offset loc_3A4+1
_tls12_sigalgs	dd 2060106h, 1050306h, 3050205h, 2040104h, 1030304h, 3030203h
					; DATA XREF: _tls12_get_psigalgs:loc_31CEo
		dd 2020102h, 302h
_suiteb_sigalgs	db 4, 3			; DATA XREF: _tls12_get_psigalgs+7Bo
					; _tls12_get_psigalgs+9Bo
word_15E	dw 305h			; DATA XREF: _tls12_get_psigalgs+8Bo
_tls12_md	dd 4			; DATA XREF: _tls12_get_sigandhash:loc_3222r
					; _tls1_lookup_sigalg:loc_4327r ...
dword_164	dd 1			; DATA XREF: _tls12_get_sigandhash:loc_3234r
					; _tls1_lookup_sigalg:loc_4314r ...
		dd offset _tls1_version_str+1Ch	; "  3 May 2016"
		dd 2, 2A3h, 3, 2A0h, 4,	2A1h, 5, 2A2h, 6
_tls12_sig	dd 6			; DATA XREF: _tls12_check_peer_sigalg:loc_2D8Br
					; _tls12_get_sigandhash:loc_324Cr ...
dword_194	dd 1			; DATA XREF: _tls12_check_peer_sigalg:loc_2DA2r
					; _tls12_get_sigandhash:loc_325Er ...
byte_198	db 74h			; DATA XREF: .data:000001A0o
byte_199	db 3 dup(0)		; DATA XREF: .data:00000114o
		db 2, 2	dup(0)
byte_19F	db 0			; DATA XREF: .data:00000124o
		dd offset byte_198
		dd 3, 0
		public _TLSv1_enc_data
_TLSv1_enc_data	dd offset _tls1_enc
		dd offset _tls1_mac
		dd offset _tls1_setup_key_block
		dd offset _tls1_generate_master_secret
		dd offset _tls1_change_cipher_state
		dd offset _tls1_final_finish_mac
		dd 0Ch
		dd offset _tls1_cert_verify_mac
		dd offset ??_C@_0BA@OOFGCNEE@client?5finished?$AA@ ; "client finished"
		dd 0Fh
		dd offset ??_C@_0BA@MHGDKHGN@server?5finished?$AA@ ; "server finished"
		dd 0Fh
		dd offset _tls1_alert_code
		dd offset _tls1_export_keying_material
		align 8
		dd 4
		dd offset _ssl3_set_handshake_header
		dd offset _ssl3_handshake_write
		public _TLSv1_1_enc_data
_TLSv1_1_enc_data dd offset _tls1_enc
		dd offset _tls1_mac
		dd offset _tls1_setup_key_block
		dd offset _tls1_generate_master_secret
		dd offset _tls1_change_cipher_state
		dd offset _tls1_final_finish_mac
		dd 0Ch
		dd offset _tls1_cert_verify_mac
		dd offset ??_C@_0BA@OOFGCNEE@client?5finished?$AA@ ; "client finished"
		dd 0Fh
		dd offset ??_C@_0BA@MHGDKHGN@server?5finished?$AA@ ; "server finished"
		dd 0Fh
		dd offset _tls1_alert_code
		dd offset _tls1_export_keying_material
		dd 1, 4
		dd offset _ssl3_set_handshake_header
		dd offset _ssl3_handshake_write
		public _TLSv1_2_enc_data
_TLSv1_2_enc_data dd offset _tls1_enc
		dd offset _tls1_mac
		dd offset _tls1_setup_key_block
		dd offset _tls1_generate_master_secret
		dd offset _tls1_change_cipher_state
		dd offset _tls1_final_finish_mac
		dd 0Ch
		dd offset _tls1_cert_verify_mac
		dd offset ??_C@_0BA@OOFGCNEE@client?5finished?$AA@ ; "client finished"
		dd 0Fh
		dd offset ??_C@_0BA@MHGDKHGN@server?5finished?$AA@ ; "server finished"
		dd 0Fh
		dd offset _tls1_alert_code
		dd offset _tls1_export_keying_material
		dd 17h,	4
		dd offset _ssl3_set_handshake_header
		dd offset _ssl3_handshake_write
_data		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 284h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_check_chain
_SSL_check_chain proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	0FFFFFFFFh
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_tls1_check_chain
		add	esp, 14h
		retn
_SSL_check_chain endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_get_shared_sigalgs
_SSL_get_shared_sigalgs	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, [esi+98h]
		mov	ecx, [edx+13Ch]
		test	ecx, ecx
		jz	short loc_314
		mov	eax, [esp+4+arg_4]
		cmp	eax, [edx+140h]
		jge	short loc_314

loc_2C1:				; DATA XREF: .data:00000104o
		mov	edx, [esp+4+arg_C]

loc_2C5:				; DATA XREF: .data:00000108o
					; .data:0000010Co ...
		shl	eax, 4

loc_2C8:				; DATA XREF: .data:00000118o
					; .data:0000011Co
		add	ecx, eax

loc_2CA:				; DATA XREF: .data:00000120o
					; .data:00000128o
		test	edx, edx

loc_2CC:				; DATA XREF: .data:0000012Co
		jz	short loc_2D2
		mov	eax, [ecx]

loc_2D0:				; DATA XREF: .data:_nid_listo
		mov	[edx], eax

loc_2D2:				; CODE XREF: _SSL_get_shared_sigalgs:loc_2CCj
					; DATA XREF: .data:000000D0o ...
		mov	edx, [esp+4+arg_8]

loc_2D6:				; DATA XREF: .data:000000E0o
					; .data:000000E4o
		test	edx, edx

loc_2D8:				; DATA XREF: .data:000000E8o
					; .data:000000ECo
		jz	short loc_2DF

loc_2DA:				; DATA XREF: .data:000000F0o
					; .data:000000F4o ...
		mov	eax, [ecx+4]

loc_2DD:				; DATA XREF: .data:000000FCo
					; .data:00000100o
		mov	[edx], eax

loc_2DF:				; CODE XREF: _SSL_get_shared_sigalgs:loc_2D8j
		mov	edx, [esp+4+arg_10]
		test	edx, edx
		jz	short loc_2EC
		mov	eax, [ecx+8]
		mov	[edx], eax

loc_2EC:				; CODE XREF: _SSL_get_shared_sigalgs+45j
		mov	edx, [esp+4+arg_14]
		test	edx, edx
		jz	short loc_2F9
		mov	al, [ecx+0Ch]
		mov	[edx], al

loc_2F9:				; CODE XREF: _SSL_get_shared_sigalgs+52j
		mov	edx, [esp+4+arg_18]
		test	edx, edx
		jz	short loc_306
		mov	al, [ecx+0Dh]
		mov	[edx], al

loc_306:				; CODE XREF: _SSL_get_shared_sigalgs+5Fj
		mov	eax, [esi+98h]
		pop	esi
		mov	eax, [eax+140h]
		retn
; ---------------------------------------------------------------------------

loc_314:				; CODE XREF: _SSL_get_shared_sigalgs+13j
					; _SSL_get_shared_sigalgs+1Fj
		xor	eax, eax
		pop	esi
		retn
_SSL_get_shared_sigalgs	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 318h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSL_get_sigalgs
_SSL_get_sigalgs proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, [esi+98h]
		mov	ecx, [edx+124h]
		test	ecx, ecx
		jnz	short loc_331

loc_32D:				; CODE XREF: _SSL_get_sigalgs+29j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_331:				; CODE XREF: _SSL_get_sigalgs+13j
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		js	short loc_373
		add	eax, eax
		cmp	eax, [edx+128h]
		jge	short loc_32D
		mov	edx, [esp+4+arg_18]
		add	ecx, eax
		test	edx, edx
		jz	short loc_351
		mov	al, [ecx]
		mov	[edx], al

loc_351:				; CODE XREF: _SSL_get_sigalgs+33j
		mov	edx, [esp+4+arg_14]
		test	edx, edx
		jz	short loc_35E
		mov	al, [ecx+1]
		mov	[edx], al

loc_35E:				; CODE XREF: _SSL_get_sigalgs+3Fj
		push	ecx
		push	[esp+8+arg_10]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_C]
		call	_tls1_lookup_sigalg
		add	esp, 10h

loc_373:				; CODE XREF: _SSL_get_sigalgs+1Fj
		mov	eax, [esi+98h]
		pop	esi
		mov	eax, [eax+128h]
		shr	eax, 1
		retn
_SSL_get_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 384h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl nid_cb(void *Src,	size_t Size, int)
_nid_cb		proc near		; DATA XREF: _tls1_set_curves_list+30o

Dst		= byte ptr -18h
var_4		= dword	ptr -4
Src		= dword	ptr  4
Size		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 18h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		mov	eax, [esp+18h+Src]
		push	esi

loc_39E:				; DATA XREF: .data:00000130o
		mov	esi, [esp+1Ch+arg_8]

loc_3A2:				; DATA XREF: .data:00000134o
		test	eax, eax

loc_3A4:				; DATA XREF: .data:00000138o
		jnz	short loc_3B8

loc_3A6:				; CODE XREF: _nid_cb+37j
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_3B8:				; CODE XREF: _nid_cb:loc_3A4j
		cmp	dword ptr [esi], 1Ch
		jz	short loc_3A6
		push	edi
		mov	edi, [esp+20h+Size]
		cmp	edi, 13h
		jg	loc_454
		push	edi		; Size
		push	eax		; Src
		lea	eax, [esp+28h+Dst]
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		cmp	edi, 14h
		jnb	loc_467
		lea	eax, [esp+20h+Dst]
		mov	[esp+edi+20h+Dst], 0
		push	eax
		call	_EC_curve_nist2nid
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jnz	short loc_421
		lea	eax, [esp+20h+Dst]
		push	eax
		call	_OBJ_sn2nid
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jnz	short loc_421
		lea	eax, [esp+20h+Dst]
		push	eax
		call	_OBJ_ln2nid
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jz	short loc_454

loc_421:				; CODE XREF: _nid_cb+75j _nid_cb+88j
		mov	edi, [esi]
		xor	ecx, ecx
		test	edi, edi
		jz	short loc_438
		lea	eax, [esi+4]

loc_42C:				; CODE XREF: _nid_cb+B2j
		cmp	[eax], edx
		jz	short loc_454
		inc	ecx
		add	eax, 4
		cmp	ecx, edi
		jb	short loc_42C

loc_438:				; CODE XREF: _nid_cb+A3j
		mov	[esi+edi*4+4], edx
		mov	eax, 1
		inc	dword ptr [esi]
		pop	edi
		pop	esi
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_454:				; CODE XREF: _nid_cb+41j _nid_cb+9Bj ...
		mov	ecx, [esp+20h+var_4]
		xor	eax, eax
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_467:				; CODE XREF: _nid_cb+59j
		call	___report_rangecheckfailure

$LN24_2:				; $LN21
		int	3
_nid_cb		endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 470h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sig_cb(void *Src,	size_t Size, int)
_sig_cb		proc near		; DATA XREF: _tls1_set_sigalgs_list+2Bo

Dst		= byte ptr -18h
var_4		= dword	ptr -4
Src		= dword	ptr  4
Size		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 18h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		mov	eax, [esp+18h+Src]
		push	ebx
		mov	ebx, [esp+1Ch+arg_8]
		test	eax, eax
		jnz	short loc_4A4

loc_492:				; CODE XREF: _sig_cb+37j
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_4A4:				; CODE XREF: _sig_cb+20j
		cmp	dword ptr [ebx], 38h ; '8'
		jz	short loc_492
		push	esi
		mov	esi, [esp+20h+Size]
		cmp	esi, 13h
		jle	short loc_4C6
		pop	esi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_4C6:				; CODE XREF: _sig_cb+41j
		push	esi		; Size
		push	eax		; Src
		lea	eax, [esp+28h+Dst]
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		cmp	esi, 14h
		jnb	loc_62C
		push	edi
		lea	eax, [esp+24h+Dst]
		mov	[esp+esi+24h+Dst], 0
		push	2Bh ; '+'       ; Val
		push	eax		; Str
		call	dword ptr ds:__imp__strchr
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_618
		mov	byte ptr [edi],	0
		inc	edi
		cmp	byte ptr [edi],	0
		jz	loc_618
		mov	ecx, offset ??_C@_03DICHAJGH@RSA?$AA@ ;	`string'
		lea	eax, [esp+24h+Dst]

loc_514:				; CODE XREF: _sig_cb+BEj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_534
		test	dl, dl
		jz	short loc_530
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_534
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_514

loc_530:				; CODE XREF: _sig_cb+ACj
		xor	eax, eax
		jmp	short loc_539
; ---------------------------------------------------------------------------

loc_534:				; CODE XREF: _sig_cb+A8j _sig_cb+B4j
		sbb	eax, eax
		or	eax, 1

loc_539:				; CODE XREF: _sig_cb+C2j
		test	eax, eax
		jnz	short loc_542
		lea	esi, [eax+6]
		jmp	short loc_5B5
; ---------------------------------------------------------------------------

loc_542:				; CODE XREF: _sig_cb+CBj
		mov	ecx, offset ??_C@_03ENFFABCE@DSA?$AA@ ;	`string'
		lea	eax, [esp+24h+Dst]
		nop	dword ptr [eax+eax+00h]

loc_550:				; CODE XREF: _sig_cb+FAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_570
		test	dl, dl
		jz	short loc_56C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_570
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_550

loc_56C:				; CODE XREF: _sig_cb+E8j
		xor	eax, eax
		jmp	short loc_575
; ---------------------------------------------------------------------------

loc_570:				; CODE XREF: _sig_cb+E4j _sig_cb+F0j
		sbb	eax, eax
		or	eax, 1

loc_575:				; CODE XREF: _sig_cb+FEj
		test	eax, eax
		jnz	short loc_57E
		lea	esi, [eax+74h]
		jmp	short loc_5B5
; ---------------------------------------------------------------------------

loc_57E:				; CODE XREF: _sig_cb+107j
		mov	ecx, offset ??_C@_05JNBFMGNN@ECDSA?$AA@	; "ECDSA"
		lea	eax, [esp+24h+Dst]

loc_587:				; CODE XREF: _sig_cb+131j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_5A7
		test	dl, dl
		jz	short loc_5A3
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_5A7
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_587

loc_5A3:				; CODE XREF: _sig_cb+11Fj
		xor	eax, eax
		jmp	short loc_5AC
; ---------------------------------------------------------------------------

loc_5A7:				; CODE XREF: _sig_cb+11Bj _sig_cb+127j
		sbb	eax, eax
		or	eax, 1

loc_5AC:				; CODE XREF: _sig_cb+135j
		test	eax, eax
		jnz	short loc_618
		mov	esi, 198h

loc_5B5:				; CODE XREF: _sig_cb+D0j _sig_cb+10Cj
		push	edi
		call	_OBJ_sn2nid
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jnz	short loc_5D3
		push	edi
		call	_OBJ_ln2nid
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jz	short loc_618

loc_5D3:				; CODE XREF: _sig_cb+152j
		mov	edi, [ebx]
		xor	ecx, ecx
		test	edi, edi
		jz	short loc_5F3
		lea	eax, [ebx+8]
		xchg	ax, ax

loc_5E0:				; CODE XREF: _sig_cb+181j
		cmp	[eax-4], esi
		jnz	short loc_5E9
		cmp	[eax], edx
		jz	short loc_618

loc_5E9:				; CODE XREF: _sig_cb+173j
		add	ecx, 2
		add	eax, 8
		cmp	ecx, edi
		jb	short loc_5E0

loc_5F3:				; CODE XREF: _sig_cb+169j
		mov	[ebx+edi*4+4], edx
		inc	dword ptr [ebx]
		mov	eax, [ebx]
		pop	edi
		mov	[ebx+eax*4+4], esi
		mov	eax, 1
		inc	dword ptr [ebx]
		pop	esi
		pop	ebx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_618:				; CODE XREF: _sig_cb+88j _sig_cb+95j ...
		mov	ecx, [esp+24h+var_4]
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_62C:				; CODE XREF: _sig_cb+68j
		call	___report_rangecheckfailure

$LN45:					; $LN42
		int	3
_sig_cb		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 634h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl_add_clienthello_tlsext(void *Src, int, int, int)
		public _ssl_add_clienthello_tlsext
_ssl_add_clienthello_tlsext proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		mov	edx, ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+Src]
		mov	[esp+18h+var_8], edx
		mov	[esp+18h+var_4], 0
		cmp	dword ptr [edi], 301h
		jge	short loc_66C
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_6B6

loc_66C:				; CODE XREF: _ssl_add_clienthello_tlsext+2Aj
		push	edi
		call	_SSL_get_ciphers
		mov	ebx, eax
		xor	esi, esi
		push	ebx
		call	_sk_num
		add	esp, 8
		test	eax, eax
		jle	short loc_6B2
		nop

loc_684:				; CODE XREF: _ssl_add_clienthello_tlsext+72j
		push	esi
		push	ebx
		call	_sk_value
		add	esp, 8
		test	byte ptr [eax+0Ch], 0E0h
		jnz	short loc_6AA
		test	byte ptr [eax+10h], 40h
		jnz	short loc_6AA
		push	ebx
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_684
		jmp	short loc_6B2
; ---------------------------------------------------------------------------

loc_6AA:				; CODE XREF: _ssl_add_clienthello_tlsext+5Ej
					; _ssl_add_clienthello_tlsext+64j
		mov	[esp+18h+var_4], 1

loc_6B2:				; CODE XREF: _ssl_add_clienthello_tlsext+4Dj
					; _ssl_add_clienthello_tlsext+74j
		mov	edx, [esp+18h+var_8]

loc_6B6:				; CODE XREF: _ssl_add_clienthello_tlsext+36j
		cmp	dword ptr [edi+110h], 300h
		jnz	short loc_6D8
		mov	ecx, [edi+58h]
		cmp	dword ptr [ecx+418h], 0
		jnz	short loc_6D8
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_6D8:				; CODE XREF: _ssl_add_clienthello_tlsext+8Cj
					; _ssl_add_clienthello_tlsext+98j
		mov	ebp, [esp+18h+arg_8]
		add	edx, 2
		mov	[esp+18h+var_8], edx
		cmp	edx, ebp
		jnb	loc_7E6
		mov	ebx, [edi+120h]
		test	ebx, ebx
		jz	loc_7A8
		mov	ecx, ebp
		sub	ecx, edx
		sub	ecx, 9
		js	loc_7E6
		lea	esi, [ebx+1]

loc_709:				; CODE XREF: _ssl_add_clienthello_tlsext+DAj
		mov	al, [ebx]
		inc	ebx
		test	al, al
		jnz	short loc_709
		sub	ebx, esi
		cmp	ebx, ecx
		ja	loc_7E6
		mov	[edx], al
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		mov	byte ptr [eax+1], 0
		lea	eax, [ebx+5]
		mov	ecx, [esp+1Ch+var_8]
		shr	eax, 8
		add	ecx, 2
		mov	[esp+1Ch+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+5]
		mov	eax, [esp+1Ch+var_8]
		mov	[eax+1], cl
		lea	eax, [ebx+3]
		mov	ecx, [esp+1Ch+var_8]
		shr	eax, 8
		add	ecx, 2
		mov	[esp+1Ch+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+3]
		mov	eax, [esp+1Ch+var_8]
		mov	[eax+1], cl
		mov	eax, [esp+1Ch+var_8]
		add	eax, 2
		mov	[esp+1Ch+var_8], eax
		mov	byte ptr [eax],	0
		mov	eax, ebx
		mov	ecx, [esp+1Ch+var_8]
		inc	ecx
		shr	eax, 8
		mov	[esp+1Ch+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+1Ch+var_8]
		mov	[eax+1], bl
		mov	eax, [esp+1Ch+var_8]
		push	dword ptr [edi+120h] ; Src
		add	eax, 2
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		mov	edx, [esp+24h+var_8]
		add	esp, 0Ch
		add	edx, ebx
		mov	[esp+18h+var_8], edx

loc_7A8:				; CODE XREF: _ssl_add_clienthello_tlsext+BFj
		cmp	dword ptr [edi+190h], 0
		jz	loc_863
		push	0
		lea	eax, [esp+1Ch+Src]
		push	eax
		push	0
		push	edi
		call	_ssl_add_clienthello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jnz	short loc_7F0
		push	516h

loc_7D0:				; CODE XREF: _ssl_add_clienthello_tlsext+21Ej
					; _ssl_add_clienthello_tlsext+2E6j ...
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	44h ; 'D'
		push	115h
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_7E6:				; CODE XREF: _ssl_add_clienthello_tlsext+B1j
					; _ssl_add_clienthello_tlsext+CCj ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_7F0:				; CODE XREF: _ssl_add_clienthello_tlsext+195j
		mov	ecx, [esp+18h+var_8]
		mov	eax, ebp
		sub	eax, [esp+18h+Src]
		sub	eax, ecx
		sub	eax, 4
		js	short loc_7E6
		mov	byte ptr [ecx],	0FFh
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 1
		mov	ecx, [esp+18h+var_8]
		mov	eax, [esp+18h+Src]
		add	ecx, 2
		mov	[esp+18h+var_8], ecx
		sar	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+18h+var_8]
		mov	al, byte ptr [esp+18h+Src]
		mov	[ecx+1], al
		lea	ecx, [esp+18h+Src]
		push	[esp+18h+Src]
		mov	eax, [esp+1Ch+var_8]
		add	eax, 2
		push	ecx
		push	eax
		push	edi
		mov	[esp+28h+var_8], eax
		call	_ssl_add_clienthello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jnz	short loc_857
		push	521h
		jmp	loc_7D0
; ---------------------------------------------------------------------------

loc_857:				; CODE XREF: _ssl_add_clienthello_tlsext+217j
		mov	edx, [esp+18h+var_8]
		add	edx, [esp+18h+Src]
		mov	[esp+18h+var_8], edx

loc_863:				; CODE XREF: _ssl_add_clienthello_tlsext+17Bj
		mov	ebx, [edi+1A4h]
		test	ebx, ebx
		jz	loc_8F8
		lea	ecx, [ebx+1]

loc_874:				; CODE XREF: _ssl_add_clienthello_tlsext+245j
		mov	al, [ebx]
		inc	ebx
		test	al, al
		jnz	short loc_874
		sub	ebx, ecx
		cmp	ebx, 0FFh
		jg	loc_915
		test	ebx, ebx
		jz	loc_915
		mov	eax, ebp
		sub	eax, ebx
		sub	eax, edx
		sub	eax, 5
		js	loc_7E6
		mov	byte ptr [edx],	0
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		mov	byte ptr [eax+1], 0Ch
		lea	eax, [ebx+1]
		mov	ecx, [esp+1Ch+var_8]
		add	ecx, 2
		sar	eax, 8
		mov	[esp+1Ch+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+1]
		mov	eax, [esp+1Ch+var_8]
		mov	[eax+1], cl
		mov	eax, [esp+1Ch+var_8]
		add	eax, 2
		mov	[esp+1Ch+var_8], eax
		mov	[eax], bl
		mov	eax, [esp+1Ch+var_8]
		push	dword ptr [edi+1A4h] ; Src
		inc	eax
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		mov	edx, [esp+24h+var_8]
		add	esp, 0Ch
		add	edx, ebx
		mov	[esp+18h+var_8], edx

loc_8F8:				; CODE XREF: _ssl_add_clienthello_tlsext+237j
		cmp	[esp+18h+var_4], 0
		jz	loc_A63
		mov	esi, [edi+148h]
		test	esi, esi
		jz	short loc_91F
		mov	ebx, [edi+144h]
		jmp	short loc_93A
; ---------------------------------------------------------------------------

loc_915:				; CODE XREF: _ssl_add_clienthello_tlsext+24Fj
					; _ssl_add_clienthello_tlsext+257j
		push	52Eh
		jmp	loc_7D0
; ---------------------------------------------------------------------------

loc_91F:				; CODE XREF: _ssl_add_clienthello_tlsext+2D7j
		mov	eax, [edi+98h]
		mov	esi, offset _ecformats_default
		mov	ebx, [eax+38h]
		and	ebx, 30000h
		neg	ebx
		sbb	ebx, ebx
		add	ebx, 3

loc_93A:				; CODE XREF: _ssl_add_clienthello_tlsext+2DFj
		mov	eax, ebp
		sub	eax, edx
		sub	eax, 5
		js	loc_7E6
		cmp	ebx, eax
		ja	loc_7E6
		cmp	ebx, 0FFh
		jbe	short loc_961
		push	554h
		jmp	loc_7D0
; ---------------------------------------------------------------------------

loc_961:				; CODE XREF: _ssl_add_clienthello_tlsext+321j
		mov	byte ptr [edx],	0
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		push	esi		; Src
		mov	byte ptr [eax+1], 0Bh
		lea	eax, [ebx+1]
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+1]
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], cl
		mov	eax, [esp+20h+var_8]
		add	eax, 2
		mov	[esp+20h+var_8], eax
		mov	[eax], bl
		mov	eax, [esp+20h+var_8]
		inc	eax
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		mov	eax, [edi+150h]
		add	[esp+24h+var_8], ebx
		mov	[esp+24h+Src], eax
		lea	eax, [esp+24h+var_4]
		push	eax
		lea	eax, [esp+28h+Src]
		push	eax
		push	0
		push	edi
		call	_tls1_get_curvelist
		add	esp, 1Ch
		test	eax, eax
		jz	loc_7E6
		mov	ecx, [esp+18h+var_8]
		mov	eax, ebp
		sub	eax, ecx
		sub	eax, 6
		js	loc_7E6
		mov	ebx, [esp+18h+var_4]
		shr	eax, 1
		cmp	ebx, eax
		ja	loc_7E6
		cmp	ebx, 7FFEh
		jbe	short loc_A03
		push	56Bh
		jmp	loc_7D0
; ---------------------------------------------------------------------------

loc_A03:				; CODE XREF: _ssl_add_clienthello_tlsext+3C3j
		mov	byte ptr [ecx],	0
		add	ebx, ebx
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		push	[esp+1Ch+Src]	; Src
		mov	byte ptr [eax+1], 0Ah
		lea	eax, [ebx+2]
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+2]
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], cl
		mov	eax, ebx
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], bl
		mov	eax, [esp+20h+var_8]
		add	eax, 2
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		add	esp, 0Ch
		add	[esp+18h+var_8], ebx

loc_A63:				; CODE XREF: _ssl_add_clienthello_tlsext+2C9j
		push	0
		push	0
		push	20h ; ' '
		push	edi
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, 4000h
		jnz	loc_B8C
		cmp	dword ptr [edi+28h], 0
		jnz	short loc_A9E
		mov	ebx, [edi+0C0h]
		test	ebx, ebx
		jz	short loc_A9E
		cmp	dword ptr [ebx+0E4h], 0
		jz	short loc_A9E
		mov	ebx, [ebx+0E8h]
		jmp	short loc_B0C
; ---------------------------------------------------------------------------

loc_A9E:				; CODE XREF: _ssl_add_clienthello_tlsext+44Dj
					; _ssl_add_clienthello_tlsext+457j ...
		cmp	dword ptr [edi+0C0h], 0
		jz	short loc_B12
		mov	eax, [edi+15Ch]
		test	eax, eax
		jz	short loc_B12
		cmp	dword ptr [eax+4], 0
		jz	short loc_B12
		movzx	ebx, word ptr [eax]
		push	57Eh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, [edi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0E4h], eax
		mov	eax, [edi+0C0h]
		mov	ecx, [eax+0E4h]
		test	ecx, ecx
		jz	loc_7E6
		mov	eax, [edi+15Ch]
		push	ebx		; Size
		push	dword ptr [eax+4] ; Src
		push	ecx		; Dst
		call	_memcpy
		mov	eax, [edi+0C0h]
		add	esp, 0Ch
		mov	[eax+0E8h], ebx

loc_B0C:				; CODE XREF: _ssl_add_clienthello_tlsext+468j
		test	ebx, ebx
		jnz	short loc_B24
		jmp	short loc_B14
; ---------------------------------------------------------------------------

loc_B12:				; CODE XREF: _ssl_add_clienthello_tlsext+471j
					; _ssl_add_clienthello_tlsext+47Bj ...
		xor	ebx, ebx

loc_B14:				; CODE XREF: _ssl_add_clienthello_tlsext+4DCj
		mov	eax, [edi+15Ch]
		test	eax, eax
		jz	short loc_B24
		cmp	dword ptr [eax+4], 0
		jz	short loc_B8C

loc_B24:				; CODE XREF: _ssl_add_clienthello_tlsext+4DAj
					; _ssl_add_clienthello_tlsext+4E8j
		mov	ecx, [esp+18h+var_8]
		mov	eax, ebp
		sub	eax, ebx
		sub	eax, ecx
		sub	eax, 4
		js	loc_7E6
		mov	byte ptr [ecx],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 23h ;	'#'
		mov	eax, ebx
		mov	ecx, [esp+18h+var_8]
		add	ecx, 2
		sar	eax, 8
		mov	[esp+18h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+18h+var_8]
		mov	[eax+1], bl
		mov	esi, [esp+18h+var_8]
		add	esi, 2
		mov	[esp+18h+var_8], esi
		test	ebx, ebx
		jz	short $skip_ext$102
		mov	eax, [edi+0C0h]
		push	ebx		; Size
		push	dword ptr [eax+0E4h] ; Src
		push	esi		; Dst
		call	_memcpy
		mov	esi, [esp+24h+var_8]
		add	esp, 0Ch
		add	esi, ebx
		mov	[esp+18h+var_8], esi
		jmp	short $skip_ext$102
; ---------------------------------------------------------------------------

loc_B8C:				; CODE XREF: _ssl_add_clienthello_tlsext+443j
					; _ssl_add_clienthello_tlsext+4EEj
		mov	esi, [esp+18h+var_8]

$skip_ext$102:				; CODE XREF: _ssl_add_clienthello_tlsext+534j
					; _ssl_add_clienthello_tlsext+556j
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	loc_C23
		lea	eax, [esp+18h+Src]
		push	eax
		push	edi
		call	_tls12_get_psigalgs
		mov	ebx, eax
		mov	edx, ebp
		sub	edx, esi
		add	esp, 8
		lea	ecx, [ebx+6]
		cmp	edx, ecx
		jb	loc_7E6
		mov	byte ptr [esi],	0
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		push	[esp+1Ch+Src]	; Src
		mov	byte ptr [eax+1], 0Dh
		lea	eax, [ebx+2]
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		lea	ecx, [ebx+2]
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], cl
		mov	eax, ebx
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], bl
		mov	eax, [esp+20h+var_8]
		add	eax, 2
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		mov	esi, [esp+24h+var_8]
		add	esp, 0Ch
		add	esi, ebx
		mov	[esp+18h+var_8], esi

loc_C23:				; CODE XREF: _ssl_add_clienthello_tlsext+566j
		cmp	dword ptr [edi+128h], 1
		jnz	loc_DB0
		push	dword ptr [edi+130h]
		xor	ebx, ebx
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_C7D

loc_C46:				; CODE XREF: _ssl_add_clienthello_tlsext+647j
		push	esi
		push	dword ptr [edi+130h]
		call	_sk_value
		push	0
		push	eax
		call	_i2d_OCSP_RESPID
		add	esp, 10h
		test	eax, eax
		jle	loc_7E6
		push	dword ptr [edi+130h]
		add	eax, 2
		inc	esi
		add	ebx, eax
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_C46

loc_C7D:				; CODE XREF: _ssl_add_clienthello_tlsext+610j
		mov	eax, [edi+134h]
		test	eax, eax
		jz	short loc_CA6
		push	0
		push	eax
		call	_i2d_X509_EXTENSIONS
		mov	edx, eax
		add	esp, 8
		mov	[esp+18h+Src], edx
		test	edx, edx
		jns	short loc_CAC
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_CA6:				; CODE XREF: _ssl_add_clienthello_tlsext+651j
		xor	edx, edx
		mov	[esp+18h+Src], edx

loc_CAC:				; CODE XREF: _ssl_add_clienthello_tlsext+666j
		mov	ecx, [esp+18h+var_8]
		mov	eax, ebp
		sub	eax, edx
		sub	eax, ebx
		sub	eax, ecx
		sub	eax, 7
		js	loc_7E6
		mov	byte ptr [ecx],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 5
		lea	eax, [edx+ebx]
		mov	ecx, [esp+18h+var_8]
		add	ecx, 2
		mov	[esp+18h+var_8], ecx
		cmp	eax, 0FFF0h
		jg	loc_7E6
		add	eax, 5
		sar	eax, 8
		mov	[ecx], al
		lea	ecx, [ebx+5]
		mov	eax, [esp+18h+var_8]
		add	cl, dl
		mov	[eax+1], cl
		mov	eax, [esp+18h+var_8]
		add	eax, 2
		mov	[esp+18h+var_8], eax
		mov	byte ptr [eax],	1
		mov	eax, ebx
		mov	ecx, [esp+18h+var_8]
		inc	ecx
		sar	eax, 8
		mov	[esp+18h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+18h+var_8]
		mov	[eax+1], bl
		xor	ebx, ebx
		push	dword ptr [edi+130h]
		add	[esp+1Ch+var_8], 2
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_D74

loc_D37:				; CODE XREF: _ssl_add_clienthello_tlsext+73Ej
		mov	esi, [esp+18h+var_8]
		push	ebx
		push	dword ptr [edi+130h]
		call	_sk_value
		add	[esp+20h+var_8], 2
		lea	ecx, [esp+20h+var_8]
		push	ecx
		push	eax
		call	_i2d_OCSP_RESPID
		mov	ecx, eax
		mov	[esi+1], al
		sar	ecx, 8
		inc	ebx
		mov	[esi], cl
		push	dword ptr [edi+130h]
		call	_sk_num
		add	esp, 14h
		cmp	ebx, eax
		jl	short loc_D37

loc_D74:				; CODE XREF: _ssl_add_clienthello_tlsext+701j
		mov	eax, [esp+18h+var_8]
		mov	edx, [esp+18h+Src]
		mov	ecx, edx
		sar	ecx, 8
		mov	[eax], cl
		mov	eax, [esp+18h+var_8]
		mov	[eax+1], dl
		mov	esi, [esp+18h+var_8]
		add	esi, 2
		mov	[esp+18h+var_8], esi
		test	edx, edx
		jle	short loc_DB0
		lea	eax, [esp+18h+var_8]
		push	eax
		push	dword ptr [edi+134h]
		call	_i2d_X509_EXTENSIONS
		mov	esi, [esp+20h+var_8]
		add	esp, 8

loc_DB0:				; CODE XREF: _ssl_add_clienthello_tlsext+5F6j
					; _ssl_add_clienthello_tlsext+763j
		mov	eax, ebp
		sub	eax, esi
		sub	eax, 5
		js	loc_7E6
		mov	byte ptr [esi],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 0Fh
		mov	eax, [esp+18h+var_8]
		add	eax, 2
		mov	[esp+18h+var_8], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 1
		mov	eax, [esp+18h+var_8]
		add	eax, 2
		test	byte ptr [edi+184h], 4
		mov	[esp+18h+var_8], eax
		jz	short loc_DF7
		mov	byte ptr [eax],	2
		jmp	short loc_DFA
; ---------------------------------------------------------------------------

loc_DF7:				; CODE XREF: _ssl_add_clienthello_tlsext+7BCj
		mov	byte ptr [eax],	1

loc_DFA:				; CODE XREF: _ssl_add_clienthello_tlsext+7C1j
		mov	edx, [esp+18h+var_8]
		mov	eax, [edi+0E4h]
		inc	edx
		mov	[esp+18h+var_8], edx
		cmp	dword ptr [eax+1ACh], 0
		jz	short loc_E57
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+2B4h], 0
		jnz	short loc_E57
		mov	eax, ebp
		sub	eax, edx
		sub	eax, 4
		js	loc_7E6
		mov	byte ptr [edx],	33h ; '3'
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 74h ;	't'
		mov	eax, [esp+18h+var_8]
		add	eax, 2
		mov	[esp+18h+var_8], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 0
		mov	edx, [esp+18h+var_8]
		add	edx, 2
		mov	[esp+18h+var_8], edx

loc_E57:				; CODE XREF: _ssl_add_clienthello_tlsext+7DCj
					; _ssl_add_clienthello_tlsext+7E8j
		cmp	dword ptr [edi+1D4h], 0
		jz	loc_F19
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+2B4h], 0
		jnz	loc_F19
		mov	eax, [edi+1D8h]
		mov	ecx, ebp
		sub	ecx, edx
		add	eax, 6
		cmp	ecx, eax
		jb	loc_7E6
		mov	byte ptr [edx],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 10h
		mov	ecx, [esp+18h+var_8]
		mov	eax, [edi+1D8h]
		add	ecx, 2
		mov	[esp+18h+var_8], ecx
		add	eax, 2
		shr	eax, 8
		mov	[ecx], al
		mov	eax, [esp+18h+var_8]
		movzx	ecx, byte ptr [edi+1D8h]
		add	cl, 2
		mov	[eax+1], cl
		mov	ecx, [esp+18h+var_8]
		mov	al, [edi+1D9h]
		add	ecx, 2
		mov	[esp+18h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+18h+var_8]
		movzx	ecx, byte ptr [edi+1D8h]
		mov	[eax+1], cl
		push	dword ptr [edi+1D8h] ; Size
		mov	eax, [esp+1Ch+var_8]
		push	dword ptr [edi+1D4h] ; Src
		add	eax, 2
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memcpy
		mov	eax, [edi+1D8h]
		add	esp, 0Ch
		add	[esp+18h+var_8], eax
		mov	eax, [edi+98h]
		mov	dword ptr [eax+178h], 1

loc_F19:				; CODE XREF: _ssl_add_clienthello_tlsext+82Aj
					; _ssl_add_clienthello_tlsext+83Aj
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	loc_FBF
		push	edi
		call	_SSL_get_srtp_profiles
		add	esp, 4
		test	eax, eax
		jz	loc_FBF
		push	0
		lea	eax, [esp+1Ch+Src]
		push	eax
		push	0
		push	edi
		call	_ssl_add_clienthello_use_srtp_ext
		mov	ecx, [esp+28h+var_8]
		mov	eax, ebp
		sub	eax, [esp+28h+Src]
		add	esp, 10h
		sub	eax, ecx
		sub	eax, 4
		js	loc_7E6
		mov	byte ptr [ecx],	0
		mov	eax, [esp+18h+var_8]
		mov	byte ptr [eax+1], 0Eh
		mov	ecx, [esp+18h+var_8]
		mov	eax, [esp+18h+Src]
		add	ecx, 2
		mov	[esp+18h+var_8], ecx
		sar	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+18h+var_8]
		mov	al, byte ptr [esp+18h+Src]
		mov	[ecx+1], al
		lea	ecx, [esp+18h+Src]
		push	[esp+18h+Src]
		mov	eax, [esp+1Ch+var_8]
		add	eax, 2
		push	ecx
		push	eax
		push	edi
		mov	[esp+28h+var_8], eax
		call	_ssl_add_clienthello_use_srtp_ext
		add	esp, 10h
		test	eax, eax
		jz	short loc_FB7
		push	615h
		jmp	loc_7D0
; ---------------------------------------------------------------------------

loc_FB7:				; CODE XREF: _ssl_add_clienthello_tlsext+977j
		mov	eax, [esp+18h+Src]
		add	[esp+18h+var_8], eax

loc_FBF:				; CODE XREF: _ssl_add_clienthello_tlsext+8EFj
					; _ssl_add_clienthello_tlsext+900j
		mov	eax, [edi+98h]
		add	eax, 15Ch
		push	eax
		call	_custom_ext_init
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebp
		push	eax
		push	0
		push	edi
		call	_custom_ext_add
		add	esp, 18h
		test	eax, eax
		jz	loc_7E6
		test	byte ptr [edi+100h], 10h
		mov	edx, [esp+18h+var_8]
		jz	loc_1073
		mov	eax, [edi+3Ch]
		mov	ecx, edx
		sub	ecx, [eax+4]
		cmp	dword ptr [edi+34h], 1210h
		jnz	short loc_1012
		sub	ecx, 5

loc_1012:				; CODE XREF: _ssl_add_clienthello_tlsext+9D9j
		lea	eax, [ecx-100h]
		cmp	eax, 0FFh
		ja	short loc_1073
		mov	ebx, 200h
		sub	ebx, ecx
		cmp	ebx, 4
		jl	short loc_1030
		sub	ebx, 4
		jmp	short loc_1032
; ---------------------------------------------------------------------------

loc_1030:				; CODE XREF: _ssl_add_clienthello_tlsext+9F5j
		xor	ebx, ebx

loc_1032:				; CODE XREF: _ssl_add_clienthello_tlsext+9FAj
		mov	byte ptr [edx],	0
		mov	eax, [esp+18h+var_8]
		push	ebx		; Size
		push	0		; Val
		mov	byte ptr [eax+1], 15h
		mov	eax, ebx
		mov	ecx, [esp+20h+var_8]
		add	ecx, 2
		sar	eax, 8
		mov	[esp+20h+var_8], ecx
		mov	[ecx], al
		mov	eax, [esp+20h+var_8]
		mov	[eax+1], bl
		mov	eax, [esp+20h+var_8]
		add	eax, 2
		push	eax		; Dst
		mov	[esp+24h+var_8], eax
		call	_memset
		mov	edx, [esp+24h+var_8]
		add	esp, 0Ch
		add	edx, ebx

loc_1073:				; CODE XREF: _ssl_add_clienthello_tlsext+9C4j
					; _ssl_add_clienthello_tlsext+9E9j
		mov	ebx, [esp+18h+arg_4]
		mov	eax, edx
		sub	eax, ebx
		sub	eax, 2
		jnz	short loc_108A
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_108A:				; CODE XREF: _ssl_add_clienthello_tlsext+A4Aj
		pop	edi
		mov	ecx, eax
		mov	[ebx+1], al
		pop	esi
		sar	ecx, 8
		mov	eax, edx
		pop	ebp
		mov	[ebx], cl
		pop	ebx
		add	esp, 8
		retn
_ssl_add_clienthello_tlsext endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl_add_serverhello_tlsext(size_t	Size, int, int,	int)
		public _ssl_add_serverhello_tlsext
_ssl_add_serverhello_tlsext proc near

Src		= dword	ptr -28h
var_24		= xmmword ptr -24h
var_14		= xmmword ptr -14h
var_4		= dword	ptr -4
Size		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 28h ; '('
		call	__chkstk
		push	ebp
		mov	ebp, [esp+2Ch+arg_4]
		push	edi
		mov	edi, [esp+30h+Size]
		mov	[esp+30h+arg_4], ebp
		mov	ecx, [edi+58h]
		mov	eax, [ecx+344h]
		test	byte ptr [eax+0Ch], 0E0h
		jnz	short loc_10CD
		test	byte ptr [eax+10h], 40h
		jz	short loc_10E4

loc_10CD:				; CODE XREF: _ssl_add_serverhello_tlsext+25j
		mov	eax, [edi+0C0h]
		mov	[esp+30h+Src], 1
		cmp	dword ptr [eax+0D8h], 0
		jnz	short loc_10EC

loc_10E4:				; CODE XREF: _ssl_add_serverhello_tlsext+2Bj
		mov	[esp+30h+Src], 0

loc_10EC:				; CODE XREF: _ssl_add_serverhello_tlsext+42j
		cmp	dword ptr [edi], 300h
		jnz	short loc_1105
		cmp	dword ptr [ecx+418h], 0
		jnz	short loc_1105
		pop	edi
		mov	eax, ebp
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1105:				; CODE XREF: _ssl_add_serverhello_tlsext+52j
					; _ssl_add_serverhello_tlsext+5Bj
		push	ebx
		mov	ebx, [esp+34h+arg_8]
		push	esi
		lea	esi, [ebp+2]
		mov	[esp+38h+arg_4], esi
		cmp	esi, ebx
		jnb	loc_1404
		cmp	dword ptr [edi+6Ch], 0
		jnz	short loc_1171
		cmp	dword ptr [edi+124h], 1
		jnz	short loc_1171
		mov	eax, [edi+0C0h]
		cmp	dword ptr [eax+0D0h], 0
		jz	short loc_1171
		mov	eax, ebx
		sub	eax, esi
		sub	eax, 4
		js	loc_1404
		mov	byte ptr [esi],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0
		mov	eax, [esp+38h+arg_4]
		add	eax, 2
		mov	[esp+38h+arg_4], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0
		mov	esi, [esp+38h+arg_4]
		add	esi, 2
		mov	[esp+38h+arg_4], esi

loc_1171:				; CODE XREF: _ssl_add_serverhello_tlsext+7Ej
					; _ssl_add_serverhello_tlsext+87j ...
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+418h], 0
		jz	loc_1218
		push	0
		lea	eax, [esp+3Ch+Size]
		push	eax
		push	0
		push	edi
		call	_ssl_add_serverhello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jnz	short loc_11A1
		push	66Bh
		jmp	loc_13EE
; ---------------------------------------------------------------------------

loc_11A1:				; CODE XREF: _ssl_add_serverhello_tlsext+F5j
		mov	ecx, [esp+38h+arg_4]
		mov	eax, ebx
		sub	eax, [esp+38h+Size]
		sub	eax, ecx
		sub	eax, 4
		js	loc_1404
		mov	byte ptr [ecx],	0FFh
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 1
		mov	ecx, [esp+38h+arg_4]
		mov	eax, [esp+38h+Size]
		add	ecx, 2
		mov	[esp+38h+arg_4], ecx
		sar	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+38h+arg_4]
		mov	al, byte ptr [esp+38h+Size]
		mov	[ecx+1], al
		lea	ecx, [esp+38h+Size]
		push	[esp+38h+Size]
		mov	eax, [esp+3Ch+arg_4]
		add	eax, 2
		push	ecx
		push	eax
		push	edi
		mov	[esp+48h+arg_4], eax
		call	_ssl_add_serverhello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jnz	short loc_120C
		push	676h
		jmp	loc_13EE
; ---------------------------------------------------------------------------

loc_120C:				; CODE XREF: _ssl_add_serverhello_tlsext+160j
		mov	esi, [esp+38h+arg_4]
		add	esi, [esp+38h+Size]
		mov	[esp+38h+arg_4], esi

loc_1218:				; CODE XREF: _ssl_add_serverhello_tlsext+DBj
		cmp	[esp+38h+Src], 0
		jz	loc_12B9
		lea	eax, [esp+38h+Size]
		push	eax
		lea	eax, [esp+3Ch+Src]
		push	eax
		push	edi
		call	_tls1_get_formatlist
		mov	eax, ebx
		add	esp, 0Ch
		sub	eax, esi
		sub	eax, 5
		js	loc_1404
		mov	edx, [esp+38h+Size]
		cmp	edx, eax
		ja	loc_1404
		cmp	edx, 0FFh
		jbe	short loc_1261
		push	68Ch
		jmp	loc_13EE
; ---------------------------------------------------------------------------

loc_1261:				; CODE XREF: _ssl_add_serverhello_tlsext+1B5j
		mov	byte ptr [esi],	0
		mov	eax, [esp+38h+arg_4]
		push	edx		; Size
		push	[esp+3Ch+Src]	; Src
		mov	byte ptr [eax+1], 0Bh
		lea	eax, [edx+1]
		mov	ecx, [esp+40h+arg_4]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+40h+arg_4], ecx
		mov	[ecx], al
		lea	ecx, [edx+1]
		mov	eax, [esp+40h+arg_4]
		mov	[eax+1], cl
		mov	eax, [esp+40h+arg_4]
		add	eax, 2
		mov	[esp+40h+arg_4], eax
		mov	[eax], dl
		mov	eax, [esp+40h+arg_4]
		inc	eax
		push	eax		; Dst
		mov	[esp+44h+arg_4], eax
		call	_memcpy
		mov	esi, [esp+44h+arg_4]
		add	esp, 0Ch
		add	esi, [esp+38h+Size]
		mov	[esp+38h+arg_4], esi

loc_12B9:				; CODE XREF: _ssl_add_serverhello_tlsext+17Dj
		cmp	dword ptr [edi+140h], 0
		jz	short loc_131B
		push	0
		push	0
		push	20h ; ' '
		push	edi
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, 4000h
		jnz	short loc_1317
		mov	ecx, [esp+38h+arg_4]
		mov	eax, ebx
		sub	eax, ecx
		sub	eax, 4
		js	loc_1404
		mov	byte ptr [ecx],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 23h ;	'#'
		mov	eax, [esp+38h+arg_4]
		add	eax, 2
		mov	[esp+38h+arg_4], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0
		mov	esi, [esp+38h+arg_4]
		add	esi, 2
		mov	[esp+38h+arg_4], esi
		jmp	short loc_131B
; ---------------------------------------------------------------------------

loc_1317:				; CODE XREF: _ssl_add_serverhello_tlsext+236j
		mov	esi, [esp+38h+arg_4]

loc_131B:				; CODE XREF: _ssl_add_serverhello_tlsext+220j
					; _ssl_add_serverhello_tlsext+275j
		cmp	dword ptr [edi+12Ch], 0
		jz	short loc_135D
		mov	eax, ebx
		sub	eax, esi
		sub	eax, 4
		js	loc_1404
		mov	byte ptr [esi],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 5
		mov	eax, [esp+38h+arg_4]
		add	eax, 2
		mov	[esp+38h+arg_4], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0
		mov	esi, [esp+38h+arg_4]
		add	esi, 2
		mov	[esp+38h+arg_4], esi

loc_135D:				; CODE XREF: _ssl_add_serverhello_tlsext+282j
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	loc_141A
		cmp	dword ptr [edi+180h], 0
		jz	loc_141A
		push	0
		lea	eax, [esp+3Ch+Size]
		push	eax
		push	0
		push	edi
		call	_ssl_add_serverhello_use_srtp_ext
		mov	ecx, [esp+48h+arg_4]
		mov	eax, ebx
		sub	eax, [esp+48h+Size]
		add	esp, 10h
		sub	eax, ecx
		sub	eax, 4
		js	short loc_1404
		mov	byte ptr [ecx],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0Eh
		mov	ecx, [esp+38h+arg_4]
		mov	eax, [esp+38h+Size]
		add	ecx, 2
		mov	[esp+38h+arg_4], ecx
		sar	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+38h+arg_4]
		mov	al, byte ptr [esp+38h+Size]
		mov	[ecx+1], al
		lea	ecx, [esp+38h+Size]
		push	[esp+38h+Size]
		mov	eax, [esp+3Ch+arg_4]
		add	eax, 2
		push	ecx
		push	eax
		push	edi
		mov	[esp+48h+arg_4], eax
		call	_ssl_add_serverhello_use_srtp_ext
		add	esp, 10h
		test	eax, eax
		jz	short loc_140E
		push	6C8h

loc_13EE:				; CODE XREF: _ssl_add_serverhello_tlsext+FCj
					; _ssl_add_serverhello_tlsext+167j ...
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	44h ; 'D'
		push	116h
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_1404:				; CODE XREF: _ssl_add_serverhello_tlsext+74j
					; _ssl_add_serverhello_tlsext+9Fj ...
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_140E:				; CODE XREF: _ssl_add_serverhello_tlsext+347j
		mov	esi, [esp+38h+arg_4]
		add	esi, [esp+38h+Size]
		mov	[esp+38h+arg_4], esi

loc_141A:				; CODE XREF: _ssl_add_serverhello_tlsext+2C7j
					; _ssl_add_serverhello_tlsext+2D4j
		mov	eax, [edi+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+8]
		and	eax, 0FFFFh
		cmp	eax, 80h ; ''
		jz	short loc_143D
		cmp	eax, 81h ; ''
		jnz	loc_14DE

loc_143D:				; CODE XREF: _ssl_add_serverhello_tlsext+390j
		push	0
		push	0
		push	20h ; ' '
		push	edi
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, eax
		jns	loc_14DA
		mov	ecx, [esp+38h+arg_4]
		mov	eax, ebx
		sub	eax, ecx
		mov	dword ptr [esp+38h+var_24], 2000E8FDh
		mov	dword ptr [esp+38h+var_24+4], 8301E30h
		mov	dword ptr [esp+38h+var_24+8], 852A0606h
		mov	dword ptr [esp+38h+var_24+0Ch],	9020203h
		mov	dword ptr [esp+38h+var_14], 6060830h
		mov	dword ptr [esp+38h+var_14+4], 203852Ah
		mov	dword ptr [esp+38h+var_14+8], 8301602h
		mov	dword ptr [esp+38h+var_14+0Ch],	852A0606h
		mov	[esp+38h+var_4], 17020203h
		cmp	eax, 24h ; '$'
		jl	loc_1404
		movups	xmm0, [esp+38h+var_24]
		movups	xmmword	ptr [ecx], xmm0
		mov	eax, [esp+38h+arg_4]
		movups	xmm0, [esp+38h+var_14]
		mov	ecx, [esp+38h+var_4]
		movups	xmmword	ptr [eax+10h], xmm0
		mov	eax, [esp+38h+arg_4]
		mov	[eax+20h], ecx
		mov	esi, [esp+38h+arg_4]
		add	esi, 24h ; '$'
		mov	[esp+38h+arg_4], esi
		jmp	short loc_14DE
; ---------------------------------------------------------------------------

loc_14DA:				; CODE XREF: _ssl_add_serverhello_tlsext+3AEj
		mov	esi, [esp+38h+arg_4]

loc_14DE:				; CODE XREF: _ssl_add_serverhello_tlsext+397j
					; _ssl_add_serverhello_tlsext+438j
		test	byte ptr [edi+184h], 1
		jz	short loc_1535
		mov	eax, ebx
		sub	eax, esi
		sub	eax, 5
		js	loc_1404
		mov	byte ptr [esi],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 0Fh
		mov	eax, [esp+38h+arg_4]
		add	eax, 2
		mov	[esp+38h+arg_4], eax
		mov	byte ptr [eax],	0
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 1
		mov	eax, [esp+38h+arg_4]
		add	eax, 2
		test	byte ptr [edi+184h], 4
		mov	[esp+38h+arg_4], eax
		jz	short loc_152E
		mov	byte ptr [eax],	2
		jmp	short loc_1531
; ---------------------------------------------------------------------------

loc_152E:				; CODE XREF: _ssl_add_serverhello_tlsext+487j
		mov	byte ptr [eax],	1

loc_1531:				; CODE XREF: _ssl_add_serverhello_tlsext+48Cj
		inc	[esp+38h+arg_4]

loc_1535:				; CODE XREF: _ssl_add_serverhello_tlsext+445j
		mov	ecx, [edi+58h]
		mov	eax, [ecx+41Ch]
		mov	dword ptr [ecx+41Ch], 0
		test	eax, eax
		jz	loc_15EE
		mov	eax, [edi+0E4h]
		mov	ecx, [eax+1A4h]
		test	ecx, ecx
		jz	loc_15EE
		push	dword ptr [eax+1A8h]
		lea	eax, [esp+3Ch+Size]
		push	eax
		lea	eax, [esp+40h+Src]
		push	eax
		push	edi
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_15EE
		mov	ecx, [esp+38h+arg_4]
		mov	eax, ebx
		sub	eax, [esp+38h+Size]
		sub	eax, ecx
		sub	eax, 4
		js	loc_1404
		mov	byte ptr [ecx],	33h ; '3'
		mov	eax, [esp+38h+arg_4]
		mov	byte ptr [eax+1], 74h ;	't'
		mov	ecx, [esp+38h+arg_4]
		mov	eax, [esp+38h+Size]
		add	ecx, 2
		mov	[esp+38h+arg_4], ecx
		shr	eax, 8
		mov	[ecx], al
		mov	ecx, [esp+38h+arg_4]
		mov	al, byte ptr [esp+38h+Size]
		mov	[ecx+1], al
		push	[esp+38h+Size]	; Size
		mov	eax, [esp+3Ch+arg_4]
		push	[esp+3Ch+Src]	; Src
		add	eax, 2
		push	eax		; Dst
		mov	[esp+44h+arg_4], eax
		call	_memcpy
		mov	eax, [esp+44h+Size]
		add	esp, 0Ch
		add	[esp+38h+arg_4], eax
		mov	eax, [edi+58h]
		mov	dword ptr [eax+41Ch], 1

loc_15EE:				; CODE XREF: _ssl_add_serverhello_tlsext+4AAj
					; _ssl_add_serverhello_tlsext+4BEj ...
		push	[esp+38h+arg_C]
		lea	eax, [esp+3Ch+arg_4]
		push	ebx
		push	eax
		push	1
		push	edi
		call	_custom_ext_add
		add	esp, 14h
		test	eax, eax
		jz	loc_1404
		mov	edx, [edi+58h]
		mov	esi, [edx+424h]
		test	esi, esi
		jz	loc_16A7
		mov	edx, [edx+428h]
		sub	ebx, edx
		mov	eax, [esp+38h+arg_4]
		sub	ebx, eax
		sub	ebx, 7
		mov	[esp+38h+Size],	edx
		js	loc_1404
		mov	byte ptr [eax],	0
		mov	eax, [esp+38h+arg_4]
		push	edx		; Size
		push	esi		; Src
		mov	byte ptr [eax+1], 10h
		lea	eax, [edx+3]
		mov	ecx, [esp+40h+arg_4]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+40h+arg_4], ecx
		mov	[ecx], al
		lea	ecx, [edx+3]
		mov	eax, [esp+40h+arg_4]
		mov	[eax+1], cl
		lea	eax, [edx+1]
		mov	ecx, [esp+40h+arg_4]
		add	ecx, 2
		shr	eax, 8
		mov	[esp+40h+arg_4], ecx
		mov	[ecx], al
		lea	ecx, [edx+1]
		mov	eax, [esp+40h+arg_4]
		mov	[eax+1], cl
		mov	eax, [esp+40h+arg_4]
		add	eax, 2
		mov	[esp+40h+arg_4], eax
		mov	[eax], dl
		mov	eax, [esp+40h+arg_4]
		inc	eax
		push	eax		; Dst
		mov	[esp+44h+arg_4], eax
		call	_memcpy
		mov	edx, [esp+44h+arg_4]
		add	esp, 0Ch
		add	edx, [esp+38h+Size]
		jmp	short loc_16AB
; ---------------------------------------------------------------------------

loc_16A7:				; CODE XREF: _ssl_add_serverhello_tlsext+576j
		mov	edx, [esp+38h+arg_4]

loc_16AB:				; CODE XREF: _ssl_add_serverhello_tlsext+605j
		mov	eax, edx
		sub	eax, ebp
		sub	eax, 2
		jnz	short loc_16BE
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, ebp
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_16BE:				; CODE XREF: _ssl_add_serverhello_tlsext+612j
		pop	esi
		mov	ecx, eax
		mov	[ebp+1], al
		pop	ebx
		sar	ecx, 8
		mov	eax, edx
		pop	edi
		mov	[ebp+0], cl
		pop	ebp
		add	esp, 28h
		retn
_ssl_add_serverhello_tlsext endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 16D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_check_ca_name proc	near		; CODE XREF: _tls1_check_chain+43Cp
					; _tls1_check_chain+471p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		push	[esp+0Ch+arg_4]
		call	_X509_get_issuer_name
		mov	edi, [esp+10h+arg_0]
		mov	ebx, eax
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 8
		test	eax, eax
		jle	short loc_1718

loc_16F5:				; CODE XREF: _ssl_check_ca_name+42j
		push	esi
		push	edi
		call	_sk_value
		push	eax
		push	ebx
		call	_X509_NAME_cmp
		add	esp, 10h
		test	eax, eax
		jz	short loc_171E
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_16F5

loc_1718:				; CODE XREF: _ssl_check_ca_name+1Fj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_171E:				; CODE XREF: _ssl_check_ca_name+34j
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		retn
_ssl_check_ca_name endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1728h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_check_clienthello_tlsext_early proc near ;	CODE XREF: _ssl_parse_clienthello_tlsext+4Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ecx, 70h ; 'p'
		push	edi
		mov	eax, 3
		mov	[esp+0Ch+var_4], ecx
		mov	edx, [esi+0E4h]
		test	edx, edx
		jz	short loc_175A
		mov	edi, [edx+100h]
		test	edi, edi
		jnz	short loc_176E

loc_175A:				; CODE XREF: _ssl_check_clienthello_tlsext_early+26j
		mov	edx, [esi+170h]
		test	edx, edx
		jz	short loc_1783
		mov	edi, [edx+100h]
		test	edi, edi
		jz	short loc_1783

loc_176E:				; CODE XREF: _ssl_check_clienthello_tlsext_early+30j
		push	dword ptr [edx+104h]
		lea	eax, [esp+10h+var_4]
		push	eax
		push	esi
		call	edi
		mov	ecx, [esp+18h+var_4]
		add	esp, 0Ch

loc_1783:				; CODE XREF: _ssl_check_clienthello_tlsext_early+3Aj
					; _ssl_check_clienthello_tlsext_early+44j
		sub	eax, 1
		jz	short loc_17B4
		sub	eax, 1
		jz	short loc_17A1
		sub	eax, 1
		jnz	short loc_17C0
		mov	[esi+124h], eax
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_17A1:				; CODE XREF: _ssl_check_clienthello_tlsext_early+63j
		push	ecx
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_17B4:				; CODE XREF: _ssl_check_clienthello_tlsext_early+5Ej
		push	ecx
		push	1
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

loc_17C0:				; CODE XREF: _ssl_check_clienthello_tlsext_early+68j
		pop	edi
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
_ssl_check_clienthello_tlsext_early endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 17CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_check_clienthello_tlsext_late
_ssl_check_clienthello_tlsext_late proc	near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	[esp+8+var_4], 0
		cmp	dword ptr [esi+128h], 0FFFFFFFFh
		jz	short loc_1849
		mov	eax, [esi+0E4h]
		test	eax, eax
		jz	short loc_1849
		cmp	dword ptr [eax+13Ch], 0
		jz	short loc_1849
		push	esi
		call	_ssl_get_server_send_pkey
		mov	ecx, eax
		add	esp, 4
		test	ecx, ecx
		jnz	short loc_181A
		mov	[esi+12Ch], eax
		lea	eax, [ecx+1]
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_181A:				; CODE XREF: _ssl_check_clienthello_tlsext_late+40j
		mov	eax, [esi+98h]
		mov	[eax], ecx
		mov	eax, [esi+0E4h]
		push	dword ptr [eax+140h]
		mov	eax, [eax+13Ch]
		push	esi
		call	eax
		add	esp, 8
		sub	eax, 0
		jz	short loc_1894
		sub	eax, 2
		jz	short loc_188A
		sub	eax, 1
		jnz	short loc_1853

loc_1849:				; CODE XREF: _ssl_check_clienthello_tlsext_late+1Ej
					; _ssl_check_clienthello_tlsext_late+28j ...
		mov	dword ptr [esi+12Ch], 0

loc_1853:				; CODE XREF: _ssl_check_clienthello_tlsext_late+7Bj
					; _ssl_check_clienthello_tlsext_late+D9j
		lea	eax, [esp+8+arg_0]
		push	eax
		lea	eax, [esp+0Ch+var_4]
		push	eax
		push	esi
		call	_tls1_alpn_handle_client_hello_late
		mov	eax, [esp+14h+var_4]
		add	esp, 0Ch
		mov	ecx, [esp+8+arg_0]

$err$21:				; CODE XREF: _ssl_check_clienthello_tlsext_late+C6j
		sub	eax, 1
		jz	short loc_18A7
		sub	eax, 1
		jnz	short loc_18B3
		push	ecx
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_188A:				; CODE XREF: _ssl_check_clienthello_tlsext_late+76j
		mov	eax, 2
		lea	ecx, [eax+4Eh]
		jmp	short $err$21
; ---------------------------------------------------------------------------

loc_1894:				; CODE XREF: _ssl_check_clienthello_tlsext_late+71j
		xor	eax, eax
		cmp	[esi+138h], eax
		setnz	al
		mov	[esi+12Ch], eax
		jmp	short loc_1853
; ---------------------------------------------------------------------------

loc_18A7:				; CODE XREF: _ssl_check_clienthello_tlsext_late+A5j
		push	ecx
		push	1
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

loc_18B3:				; CODE XREF: _ssl_check_clienthello_tlsext_late+AAj
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
_ssl_check_clienthello_tlsext_late endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_check_for_safari proc near		; CODE XREF: _ssl_scan_clienthello_tlsext+A7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_8]
		lea	eax, [edi-2]
		cmp	esi, eax
		jnb	loc_19D0
		add	esi, 2
		lea	eax, [edi-4]
		cmp	esi, eax
		ja	loc_19D0
		movzx	ecx, byte ptr [esi]
		movzx	eax, byte ptr [esi+1]
		shl	cx, 8
		or	cx, ax
		movzx	eax, byte ptr [esi+3]
		movzx	edx, cx
		movzx	ecx, byte ptr [esi+2]
		add	esi, 4
		shl	cx, 8
		or	cx, ax
		movzx	eax, cx
		test	dx, dx
		jnz	loc_19D0
		lea	ecx, [esi+eax]
		cmp	ecx, edi
		ja	loc_19D0
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		mov	edx, [ebx+110h]
		mov	eax, edx
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		jnz	short loc_199B
		cmp	edx, 303h
		jl	short loc_199B
		lea	eax, [ecx+22h]
		cmp	eax, edi
		jnz	loc_19CF
		mov	edx, ecx
		mov	esi, offset ?kSafariExtensionsBlock@?1??ssl_check_for_safari@@9@9 ; `ssl_check_for_safari'::`2'::kSafariExtensionsBlock
		mov	edi, 0Eh

loc_1951:				; CODE XREF: _ssl_check_for_safari+A4j
		mov	eax, [edx]
		cmp	eax, [esi]
		jnz	short loc_19CF
		add	edx, 4
		add	esi, 4
		sub	edi, 4
		jnb	short loc_1951
		mov	ax, [edx]
		cmp	ax, [esi]
		jnz	short loc_19CF
		add	ecx, 12h
		mov	edx, offset ?kSafariTLS12ExtensionsBlock@?1??ssl_check_for_safari@@9@9 ; `ssl_check_for_safari'::`2'::kSafariTLS12ExtensionsBlock
		mov	esi, 0Ch
		nop	dword ptr [eax+eax+00h]

loc_197C:				; CODE XREF: _ssl_check_for_safari+CFj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_19CF
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_197C
		mov	eax, [ebx+58h]
		pop	ebx
		pop	edi
		pop	esi
		mov	byte ptr [eax+420h], 1
		retn
; ---------------------------------------------------------------------------

loc_199B:				; CODE XREF: _ssl_check_for_safari+74j
					; _ssl_check_for_safari+7Cj
		lea	eax, [ecx+12h]
		cmp	eax, edi
		jnz	short loc_19CF
		mov	edx, offset ?kSafariExtensionsBlock@?1??ssl_check_for_safari@@9@9 ; `ssl_check_for_safari'::`2'::kSafariExtensionsBlock
		mov	esi, 0Eh

loc_19AC:				; CODE XREF: _ssl_check_for_safari+FFj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_19CF
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_19AC
		mov	ax, [ecx]
		cmp	ax, [edx]
		jnz	short loc_19CF
		mov	eax, [ebx+58h]
		mov	byte ptr [eax+420h], 1

loc_19CF:				; CODE XREF: _ssl_check_for_safari+83j
					; _ssl_check_for_safari+99j ...
		pop	ebx

loc_19D0:				; CODE XREF: _ssl_check_for_safari+Fj
					; _ssl_check_for_safari+1Dj ...
		pop	edi
		pop	esi
		retn
_ssl_check_for_safari endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 19D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_check_serverhello_tlsext
_ssl_check_serverhello_tlsext proc near	; CODE XREF: _ssl_parse_serverhello_tlsext+52p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	[esp+0Ch+var_4], 70h ; 'p'
		cmp	dword ptr [esi+148h], 0
		jz	short loc_1A67
		cmp	dword ptr [esi+144h], 0
		jbe	short loc_1A67
		mov	edi, [esi+0C0h]
		mov	edx, [edi+0D8h]
		test	edx, edx
		jz	short loc_1A67
		mov	edi, [edi+0D4h]
		test	edi, edi
		jz	short loc_1A67
		mov	eax, [esi+58h]
		mov	eax, [eax+344h]
		test	byte ptr [eax+0Ch], 0E0h
		jnz	short loc_1A2D
		test	byte ptr [eax+10h], 40h
		jz	short loc_1A67

loc_1A2D:				; CODE XREF: _ssl_check_serverhello_tlsext+51j
		xor	ecx, ecx
		test	edi, edi
		jz	short loc_1A42
		nop

loc_1A34:				; CODE XREF: _ssl_check_serverhello_tlsext+6Cj
		mov	al, [edx]
		lea	edx, [edx+1]
		test	al, al
		jz	short loc_1A67
		inc	ecx
		cmp	ecx, edi
		jb	short loc_1A34

loc_1A42:				; CODE XREF: _ssl_check_serverhello_tlsext+5Dj
		push	0C4Eh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	9Dh ; ''
		push	118h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1A67:				; CODE XREF: _ssl_check_serverhello_tlsext+1Fj
					; _ssl_check_serverhello_tlsext+28j ...
		mov	eax, [esi+0E4h]
		xor	edi, edi
		test	eax, eax
		jz	short loc_1A7D
		mov	ecx, [eax+100h]
		test	ecx, ecx
		jnz	short loc_1A91

loc_1A7D:				; CODE XREF: _ssl_check_serverhello_tlsext+9Dj
		mov	eax, [esi+170h]
		test	eax, eax
		jz	short loc_1AA4
		mov	ecx, [eax+100h]
		test	ecx, ecx
		jz	short loc_1AA4

loc_1A91:				; CODE XREF: _ssl_check_serverhello_tlsext+A7j
		push	dword ptr [eax+104h]
		lea	eax, [esp+10h+var_4]
		push	eax
		push	esi
		call	ecx
		mov	edi, eax
		add	esp, 0Ch

loc_1AA4:				; CODE XREF: _ssl_check_serverhello_tlsext+B1j
					; _ssl_check_serverhello_tlsext+BBj
		push	dword ptr [esi+138h]
		call	_CRYPTO_free
		add	esp, 4
		mov	dword ptr [esi+138h], 0
		cmp	dword ptr [esi+128h], 0FFFFFFFFh
		mov	dword ptr [esi+13Ch], 0FFFFFFFFh
		jz	short loc_1B20
		cmp	dword ptr [esi+12Ch], 0
		jnz	short loc_1B20
		cmp	dword ptr [esi+6Ch], 0
		jnz	short loc_1B20
		mov	eax, [esi+0E4h]
		test	eax, eax
		jz	short loc_1B20
		mov	ecx, [eax+13Ch]
		test	ecx, ecx
		jz	short loc_1B20
		push	dword ptr [eax+140h]
		push	esi
		call	ecx
		add	esp, 8
		test	eax, eax
		jnz	short loc_1B10
		mov	eax, 71h ; 'q'
		mov	[esp+0Ch+var_4], eax
		lea	edi, [eax-6Fh]
		jmp	short loc_1B24
; ---------------------------------------------------------------------------

loc_1B10:				; CODE XREF: _ssl_check_serverhello_tlsext+12Cj
		jns	short loc_1B20
		mov	eax, 50h ; 'P'
		mov	[esp+0Ch+var_4], eax
		lea	edi, [eax-4Eh]
		jmp	short loc_1B24
; ---------------------------------------------------------------------------

loc_1B20:				; CODE XREF: _ssl_check_serverhello_tlsext+F9j
					; _ssl_check_serverhello_tlsext+102j ...
		mov	eax, [esp+0Ch+var_4]

loc_1B24:				; CODE XREF: _ssl_check_serverhello_tlsext+13Aj
					; _ssl_check_serverhello_tlsext+14Aj
		sub	edi, 1
		jz	short loc_1B53
		sub	edi, 1
		jz	short loc_1B40
		sub	edi, 1
		jnz	short loc_1B5F
		mov	[esi+124h], edi
		lea	eax, [edi+1]
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1B40:				; CODE XREF: _ssl_check_serverhello_tlsext+158j
		push	eax
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1B53:				; CODE XREF: _ssl_check_serverhello_tlsext+153j
		push	eax
		push	1
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

loc_1B5F:				; CODE XREF: _ssl_check_serverhello_tlsext+15Dj
		pop	edi
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
_ssl_check_serverhello_tlsext endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B68h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_next_proto_validate proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		xor	ecx, ecx
		push	esi
		test	edx, edx
		jz	short loc_1B89
		mov	esi, [esp+4+arg_0]
		nop

loc_1B78:				; CODE XREF: _ssl_next_proto_validate+1Fj
		mov	al, [ecx+esi]
		test	al, al
		jz	short loc_1B92
		inc	ecx
		movzx	eax, al
		add	ecx, eax
		cmp	ecx, edx
		jb	short loc_1B78

loc_1B89:				; CODE XREF: _ssl_next_proto_validate+9j
		xor	eax, eax
		cmp	ecx, edx
		pop	esi
		setz	al
		retn
; ---------------------------------------------------------------------------

loc_1B92:				; CODE XREF: _ssl_next_proto_validate+15j
		xor	al, al
		pop	esi
		retn
_ssl_next_proto_validate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1B98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_parse_clienthello_tlsext
_ssl_parse_clienthello_tlsext proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		mov	eax, [esp+4+arg_4]
		lea	ecx, [esp+4+var_4]
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	ebx, [eax]
		push	ecx
		push	[esp+10h+arg_8]
		mov	[esp+14h+var_4], 0FFFFFFFFh
		push	eax
		push	esi
		call	_ssl_scan_clienthello_tlsext
		add	esp, 10h
		test	eax, eax
		jg	short loc_1BE1

loc_1BCC:				; CODE XREF: _ssl_parse_clienthello_tlsext+A0j
		push	[esp+0Ch+var_4]
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1BE1:				; CODE XREF: _ssl_parse_clienthello_tlsext+32j
		push	esi
		call	_ssl_check_clienthello_tlsext_early
		add	esp, 4
		test	eax, eax
		jg	short loc_1C12
		push	9D2h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	0E2h ; ''
		push	12Eh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1C12:				; CODE XREF: _ssl_parse_clienthello_tlsext+54j
		mov	eax, [esi+98h]
		add	eax, 164h
		push	eax
		call	_custom_ext_init
		lea	eax, [esp+10h+var_4]
		push	eax
		push	[esp+14h+arg_8]
		push	ebx
		push	esi
		call	_ssl_scan_clienthello_custom_tlsext
		add	esp, 14h
		test	eax, eax
		jle	short loc_1BCC
		pop	esi
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
_ssl_parse_clienthello_tlsext endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1C44h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_parse_serverhello_tlsext
_ssl_parse_serverhello_tlsext proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	[esp+8+var_4], 0FFFFFFFFh
		cmp	dword ptr [esi], 300h
		jl	short loc_1CC5
		lea	eax, [esp+8+var_4]
		push	eax
		push	[esp+0Ch+arg_C]
		push	[esp+10h+arg_8]
		push	[esp+14h+arg_4]
		push	esi
		call	_ssl_scan_serverhello_tlsext
		add	esp, 14h
		test	eax, eax
		jg	short loc_1C95
		push	[esp+8+var_4]
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1C95:				; CODE XREF: _ssl_parse_serverhello_tlsext+3Bj
		push	esi
		call	_ssl_check_serverhello_tlsext
		add	esp, 4
		test	eax, eax
		jg	short loc_1CC5
		push	0CAFh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	113h
		push	12Fh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1CC5:				; CODE XREF: _ssl_parse_serverhello_tlsext+1Dj
					; _ssl_parse_serverhello_tlsext+5Cj
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
_ssl_parse_serverhello_tlsext endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1CD0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_prepare_clienthello_tlsext
_ssl_prepare_clienthello_tlsext	proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+98h]
		mov	dword ptr [eax+178h], 0
		mov	eax, 1
		retn
_ssl_prepare_clienthello_tlsext	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1CECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_prepare_serverhello_tlsext
_ssl_prepare_serverhello_tlsext	proc near
		mov	eax, 1
		retn
_ssl_prepare_serverhello_tlsext	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1CF4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_scan_clienthello_custom_tlsext proc near ;	CODE XREF: _ssl_parse_clienthello_tlsext+96p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	dword ptr [edi+6Ch], 0
		jnz	loc_1DB9
		mov	eax, [edi+98h]
		cmp	dword ptr [eax+168h], 0
		jz	loc_1DB9
		mov	eax, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_8]
		lea	ecx, [ebp-2]
		cmp	eax, ecx
		jnb	short loc_1D42
		movzx	edx, byte ptr [eax]
		movzx	ecx, byte ptr [eax+1]
		add	eax, 2
		shl	dx, 8
		or	dx, cx
		movzx	ecx, dx
		mov	edx, ebp
		sub	edx, ecx
		cmp	eax, edx
		jbe	short loc_1D4A

loc_1D42:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+30j
		pop	ebp
		mov	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1D4A:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+4Cj
		push	ebx
		lea	ebx, [ebp-4]
		push	esi
		cmp	eax, ebx
		ja	short loc_1DA8
		nop

loc_1D54:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+B2j
		movzx	edx, byte ptr [eax]
		movzx	ecx, byte ptr [eax+1]
		shl	dx, 8
		or	dx, cx
		movzx	ecx, dx
		movzx	edx, byte ptr [eax+2]
		mov	[esp+10h+arg_0], ecx
		movzx	ecx, byte ptr [eax+3]
		add	eax, 4
		shl	dx, 8
		or	dx, cx
		movzx	ecx, dx
		lea	esi, [ecx+eax]
		cmp	esi, ebp
		ja	short loc_1DA8
		push	[esp+10h+arg_C]
		push	ecx
		push	eax
		mov	eax, [esp+1Ch+arg_0]
		movzx	eax, ax
		push	eax
		push	1
		push	edi
		call	_custom_ext_parse
		add	esp, 18h
		test	eax, eax
		jle	short loc_1DB2
		mov	eax, esi
		cmp	eax, ebx
		jbe	short loc_1D54

loc_1DA8:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+5Dj
					; _ssl_scan_clienthello_custom_tlsext+8Fj
		pop	esi
		pop	ebx
		pop	ebp
		mov	eax, 1
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1DB2:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+ACj
		pop	esi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1DB9:				; CODE XREF: _ssl_scan_clienthello_custom_tlsext+9j
					; _ssl_scan_clienthello_custom_tlsext+1Cj
		mov	eax, 1
		pop	edi
		retn
_ssl_scan_clienthello_custom_tlsext endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1DC0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_scan_clienthello_tlsext proc near	; CODE XREF: _ssl_parse_clienthello_tlsext+28p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 14h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+20h+arg_0]
		xor	ebp, ebp
		push	edi
		mov	edi, [esp+24h+arg_4]
		mov	[esp+24h+var_14], ebp
		mov	eax, [esi+58h]
		mov	edi, [edi]
		mov	[esi+124h], ebp
		mov	dword ptr [esi+128h], 0FFFFFFFFh
		mov	[eax+41Ch], ebp
		mov	eax, [esi+58h]
		mov	eax, [eax+424h]
		test	eax, eax
		jz	short loc_1E16
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+58h]
		add	esp, 4
		mov	[eax+424h], ebp

loc_1E16:				; CODE XREF: _ssl_scan_clienthello_tlsext+42j
		mov	eax, [esi+58h]
		mov	[eax+428h], ebp
		mov	eax, [esi+98h]
		mov	eax, [eax+170h]
		test	eax, eax
		jz	short loc_1E44
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+98h]
		add	esp, 4
		mov	[eax+170h], ebp

loc_1E44:				; CODE XREF: _ssl_scan_clienthello_tlsext+6Dj
		mov	eax, [esi+98h]
		mov	ebx, [esp+24h+arg_8]
		mov	[eax+174h], ebp
		and	dword ptr [esi+184h], 0FFFFFFFCh
		test	byte ptr [esi+100h], 40h
		jz	short loc_1E6F
		push	ebx
		push	edi
		push	esi
		call	_ssl_check_for_safari
		add	esp, 0Ch

loc_1E6F:				; CODE XREF: _ssl_scan_clienthello_tlsext+A2j
		mov	eax, [esi+98h]
		mov	eax, [eax+124h]
		test	eax, eax
		jz	short loc_1E94
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+98h]
		add	esp, 4
		mov	[eax+124h], ebp

loc_1E94:				; CODE XREF: _ssl_scan_clienthello_tlsext+BDj
		mov	eax, [esi+1A4h]
		test	eax, eax
		jz	short loc_1EAD
		push	eax
		call	_CRYPTO_free
		add	esp, 4
		mov	[esi+1A4h], ebp

loc_1EAD:				; CODE XREF: _ssl_scan_clienthello_tlsext+DCj
		mov	[esi+180h], ebp
		cmp	edi, ebx
		jz	loc_25E9
		lea	eax, [ebx-2]
		cmp	edi, eax
		ja	$err$174
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	cx, 8
		or	cx, ax
		movzx	eax, cx
		add	eax, edi
		cmp	eax, ebx
		jnz	$err$174
		lea	eax, [ebx-4]
		mov	[esp+24h+var_4], eax
		cmp	edi, eax
		ja	loc_25D3

loc_1EF3:				; CODE XREF: _ssl_scan_clienthello_tlsext+809j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	cx, 8
		or	cx, ax
		movzx	eax, byte ptr [edi+3]
		movzx	ebx, cx
		movzx	ecx, byte ptr [edi+2]
		add	edi, 4
		shl	cx, 8
		or	cx, ax
		movzx	edx, cx
		movzx	ebp, dx
		mov	[esp+24h+arg_0], edx
		lea	eax, [edi+ebp]
		cmp	eax, [esp+24h+arg_8]
		ja	$err$174
		mov	ecx, [esi+118h]
		test	ecx, ecx
		jz	short loc_1F4C
		push	dword ptr [esi+11Ch]
		push	ebp
		push	edi
		push	ebx
		push	0
		push	esi
		call	ecx
		mov	edx, [esp+3Ch+arg_0]
		add	esp, 18h

loc_1F4C:				; CODE XREF: _ssl_scan_clienthello_tlsext+175j
		test	bx, bx
		jnz	loc_20EC
		cmp	dx, 2
		jb	$err$174
		movzx	ebp, byte ptr [edi]
		add	edx, 0FFFEh
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ebp, 8
		or	ebp, eax
		mov	[esp+24h+arg_0], edx
		movzx	eax, dx
		cmp	ebp, eax
		jg	$err$174
		mov	ebx, edi
		cmp	ebp, 3
		jle	loc_20D0
		xchg	ax, ax

loc_1F90:				; CODE XREF: _ssl_scan_clienthello_tlsext+30Aj
		movzx	ecx, byte ptr [ebx+1]
		sub	ebp, 3
		movzx	eax, byte ptr [ebx+2]
		movzx	edx, byte ptr [ebx]
		add	ebx, 3
		shl	cx, 8
		or	cx, ax
		mov	[esp+24h+Src], ebx
		movzx	ecx, cx
		mov	ebx, ecx
		cmp	ebx, ebp
		jg	$err$174
		cmp	dword ptr [esi+124h], 0
		jnz	loc_20C1
		test	edx, edx
		jnz	loc_20C1
		mov	eax, [esi+0C0h]
		cmp	[esi+6Ch], edx
		jnz	loc_207D
		cmp	[eax+0D0h], edx
		jnz	$err$174
		mov	eax, 0FFh
		cmp	cx, ax
		ja	loc_265C
		push	855h
		lea	eax, [ebx+1]
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		call	_CRYPTO_malloc
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0D0h], eax
		test	eax, eax
		jz	loc_2684
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		push	[esp+28h+Src]	; Src
		push	dword ptr [eax+0D0h] ; Dst
		call	_memcpy
		mov	eax, [esi+0C0h]
		add	esp, 0Ch
		mov	eax, [eax+0D0h]
		mov	byte ptr [ebx+eax], 0
		mov	eax, [esi+0C0h]
		mov	ecx, [eax+0D0h]
		lea	edx, [ecx+1]
		nop	dword ptr [eax+00000000h]

loc_2060:				; CODE XREF: _ssl_scan_clienthello_tlsext+2A5j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_2060
		sub	ecx, edx
		cmp	ecx, ebx
		jnz	loc_2638
		mov	dword ptr [esi+124h], 1
		jmp	short loc_20C1
; ---------------------------------------------------------------------------

loc_207D:				; CODE XREF: _ssl_scan_clienthello_tlsext+217j
		mov	edx, [eax+0D0h]
		test	edx, edx
		jz	short loc_20B9
		mov	ecx, edx
		lea	eax, [ecx+1]
		mov	[esp+24h+var_8], eax

loc_2090:				; CODE XREF: _ssl_scan_clienthello_tlsext+2D5j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_2090
		sub	ecx, [esp+24h+var_8]
		cmp	ecx, ebx
		jnz	short loc_20B9
		push	ebx		; MaxCount
		push	[esp+28h+Src]	; Str2
		push	edx		; Str1
		call	dword ptr ds:__imp__strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_20B9
		mov	eax, 1
		jmp	short loc_20BB
; ---------------------------------------------------------------------------

loc_20B9:				; CODE XREF: _ssl_scan_clienthello_tlsext+2C5j
					; _ssl_scan_clienthello_tlsext+2DDj ...
		xor	eax, eax

loc_20BB:				; CODE XREF: _ssl_scan_clienthello_tlsext+2F7j
		mov	[esi+124h], eax

loc_20C1:				; CODE XREF: _ssl_scan_clienthello_tlsext+200j
					; _ssl_scan_clienthello_tlsext+208j ...
		sub	ebp, ebx
		mov	ebx, [esp+24h+Src]
		cmp	ebp, 3
		jg	loc_1F90

loc_20D0:				; CODE XREF: _ssl_scan_clienthello_tlsext+1C8j
		test	ebp, ebp
		jz	loc_25B8

$err$174:				; CODE XREF: _ssl_scan_clienthello_tlsext+100j
					; _ssl_scan_clienthello_tlsext+11Ej ...
		mov	eax, [esp+24h+arg_C]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 32h ; '2'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_20EC:				; CODE XREF: _ssl_scan_clienthello_tlsext+18Fj
		cmp	ebx, 0Ch
		jnz	short loc_2166
		test	dx, dx
		jz	short $err$174
		movzx	ebx, byte ptr [edi]
		lea	eax, [ebp-1]
		cmp	ebx, eax
		jnz	short $err$174
		cmp	dword ptr [esi+1A4h], 0
		jnz	short $err$174
		push	87Bh
		lea	eax, [ebx+1]
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+1A4h], eax
		test	eax, eax
		jz	loc_2670
		push	ebx		; Size
		lea	ecx, [edi+1]
		push	ecx		; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esi+1A4h]
		add	esp, 0Ch
		mov	byte ptr [ebx+eax], 0
		mov	ecx, [esi+1A4h]
		lea	edx, [ecx+1]
		xchg	ax, ax

loc_2150:				; CODE XREF: _ssl_scan_clienthello_tlsext+395j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_2150
		sub	ecx, edx
		cmp	ecx, ebx
		jnz	$err$174
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_2166:				; CODE XREF: _ssl_scan_clienthello_tlsext+32Fj
		cmp	ebx, 0Bh
		jnz	loc_221A
		movzx	ebx, byte ptr [edi]
		lea	eax, [ebp-1]
		cmp	ebx, eax
		jnz	$err$174
		cmp	ebx, 1
		jl	$err$174
		cmp	dword ptr [esi+6Ch], 0
		jnz	loc_25B8
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0D8h]
		test	eax, eax
		jz	short loc_21B9
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+0C0h]
		add	esp, 4
		mov	dword ptr [eax+0D8h], 0

loc_21B9:				; CODE XREF: _ssl_scan_clienthello_tlsext+3DEj
		mov	eax, [esi+0C0h]
		push	894h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		mov	dword ptr [eax+0D4h], 0
		call	_CRYPTO_malloc
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0D8h], eax
		test	eax, eax
		jz	loc_2684
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		mov	[eax+0D4h], ebx
		lea	eax, [edi+1]
		push	eax		; Src
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0D8h] ; Dst
		call	_memcpy
		add	esp, 0Ch
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_221A:				; CODE XREF: _ssl_scan_clienthello_tlsext+3A9j
		cmp	ebx, 0Ah
		jnz	loc_22C4
		movzx	ebx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	ebx, 8
		add	ebx, eax
		lea	eax, [ebp-2]
		cmp	ebx, eax
		jnz	$err$174
		cmp	ebx, 1
		jl	$err$174
		test	bl, 1
		jnz	$err$174
		cmp	dword ptr [esi+6Ch], 0
		jnz	loc_25B8
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+0E0h], 0
		jnz	$err$174
		push	8B7h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		mov	dword ptr [eax+0DCh], 0
		call	_CRYPTO_malloc
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0E0h], eax
		test	eax, eax
		jz	loc_2684
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		mov	[eax+0DCh], ebx
		lea	eax, [edi+2]
		push	eax		; Src
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0E0h] ; Dst
		call	_memcpy
		add	esp, 0Ch
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_22C4:				; CODE XREF: _ssl_scan_clienthello_tlsext+45Dj
		cmp	ebx, 23h ; '#'
		jnz	short loc_22F2
		mov	eax, [esi+160h]
		test	eax, eax
		jz	loc_25B8
		push	dword ptr [esi+164h]
		push	ebp
		push	edi
		push	esi
		call	eax
		add	esp, 10h
		test	eax, eax
		jz	loc_2684
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_22F2:				; CODE XREF: _ssl_scan_clienthello_tlsext+507j
		mov	eax, 0FF01h
		cmp	bx, ax
		jnz	short loc_2321
		push	[esp+24h+arg_C]
		push	ebp
		push	edi
		push	esi
		call	_ssl_parse_clienthello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jz	loc_268E
		mov	ebp, 1
		mov	[esp+24h+var_14], ebp
		jmp	loc_25BC
; ---------------------------------------------------------------------------

loc_2321:				; CODE XREF: _ssl_scan_clienthello_tlsext+53Aj
		cmp	ebx, 0Dh
		jnz	short loc_2390
		mov	eax, [esi+98h]
		cmp	dword ptr [eax+124h], 0
		jnz	$err$174
		cmp	dx, 2
		jb	$err$174
		movzx	ecx, byte ptr [edi]
		add	edx, 0FFFEh
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	[esp+24h+arg_0], edx
		movzx	eax, dx
		cmp	ecx, eax
		jnz	$err$174
		test	cl, 1
		jnz	$err$174
		test	ecx, ecx
		jz	$err$174
		push	ecx		; Size
		push	edi		; Src
		push	esi		; int
		call	_tls1_save_sigalgs
		add	esp, 0Ch
		test	eax, eax
		jz	$err$174
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_2390:				; CODE XREF: _ssl_scan_clienthello_tlsext+564j
		cmp	ebx, 5
		jnz	loc_2517
		cmp	dx, bx
		jb	$err$174
		movzx	eax, byte ptr [edi]
		add	edx, 0FFFFh
		inc	edi
		mov	[esi+128h], eax
		mov	[esp+24h+arg_0], edx
		cmp	eax, 1
		jnz	loc_2508
		movzx	ebx, byte ptr [edi]
		add	edx, 0FFFEh
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ebx, 8
		or	ebx, eax
		movzx	eax, dx
		cmp	ebx, eax
		jg	$err$174
		test	ebx, ebx
		jle	loc_2486

loc_23E7:				; CODE XREF: _ssl_scan_clienthello_tlsext+6C0j
		cmp	ebx, 4
		jl	$err$174
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, 0FFFFFFFEh
		sub	eax, ecx
		add	ebx, eax
		mov	eax, 0FFFEh
		sub	eax, ecx
		add	edx, eax
		mov	[esp+24h+arg_0], edx
		test	ebx, ebx
		js	$err$174
		push	ecx
		lea	eax, [esp+28h+var_10]
		mov	[esp+28h+var_10], edi
		push	eax
		push	0
		add	edi, ecx
		call	_d2i_OCSP_RESPID
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	$err$174
		cmp	edi, [esp+24h+var_10]
		jnz	loc_2698
		cmp	dword ptr [esi+130h], 0
		jnz	short loc_2463
		call	_sk_new_null
		mov	[esi+130h], eax
		test	eax, eax
		jz	loc_267B

loc_2463:				; CODE XREF: _ssl_scan_clienthello_tlsext+68Ej
		push	ebp
		push	dword ptr [esi+130h]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	loc_267B
		mov	edx, [esp+24h+arg_0]
		test	ebx, ebx
		jg	loc_23E7

loc_2486:				; CODE XREF: _ssl_scan_clienthello_tlsext+621j
		cmp	dx, 2
		jb	$err$174
		movzx	ebx, byte ptr [edi]
		add	edx, 0FFFEh
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ebx, 8
		or	ebx, eax
		mov	[esp+24h+arg_0], edx
		movzx	eax, dx
		cmp	ebx, eax
		jnz	$err$174
		mov	[esp+24h+var_10], edi
		test	ebx, ebx
		jle	loc_25B8
		mov	eax, [esi+134h]
		test	eax, eax
		jz	short loc_24D8
		push	offset _X509_EXTENSION_free
		push	eax
		call	_sk_pop_free
		add	esp, 8

loc_24D8:				; CODE XREF: _ssl_scan_clienthello_tlsext+708j
		push	ebx
		lea	eax, [esp+28h+var_10]
		push	eax
		push	0
		call	_d2i_X509_EXTENSIONS
		add	esp, 0Ch
		mov	[esi+134h], eax
		test	eax, eax
		jz	$err$174
		lea	eax, [ebx+edi]
		cmp	eax, [esp+24h+var_10]
		jnz	$err$174
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_2508:				; CODE XREF: _ssl_scan_clienthello_tlsext+5F9j
		mov	dword ptr [esi+128h], 0FFFFFFFFh
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_2517:				; CODE XREF: _ssl_scan_clienthello_tlsext+5D3j
		cmp	ebx, 0Fh
		jnz	short loc_2542
		movzx	eax, byte ptr [edi]
		sub	eax, 1
		jz	short loc_2539
		sub	eax, 1
		jnz	loc_26B5
		or	dword ptr [esi+184h], 3
		jmp	loc_25B8
; ---------------------------------------------------------------------------

loc_2539:				; CODE XREF: _ssl_scan_clienthello_tlsext+762j
		or	dword ptr [esi+184h], 1
		jmp	short loc_25B8
; ---------------------------------------------------------------------------

loc_2542:				; CODE XREF: _ssl_scan_clienthello_tlsext+75Aj
		mov	eax, 3374h
		cmp	bx, ax
		jnz	short loc_2564
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+2B4h], 0
		jnz	short loc_2583
		mov	dword ptr [eax+41Ch], 1
		jmp	short loc_25B8
; ---------------------------------------------------------------------------

loc_2564:				; CODE XREF: _ssl_scan_clienthello_tlsext+78Aj
		cmp	ebx, 10h
		jnz	short loc_2583
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+2B4h], 0
		jnz	short loc_2583
		push	[esp+24h+arg_C]
		push	ebp
		push	edi
		push	esi
		call	_tls1_alpn_handle_client_hello
		jmp	short loc_25AD
; ---------------------------------------------------------------------------

loc_2583:				; CODE XREF: _ssl_scan_clienthello_tlsext+796j
					; _ssl_scan_clienthello_tlsext+7A7j ...
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_25B8
		push	esi
		call	_SSL_get_srtp_profiles
		add	esp, 4
		test	eax, eax
		jz	short loc_25B8
		cmp	ebx, 0Eh
		jnz	short loc_25B8
		push	[esp+24h+arg_C]
		push	ebp
		push	edi
		push	esi
		call	_ssl_parse_clienthello_use_srtp_ext

loc_25AD:				; CODE XREF: _ssl_scan_clienthello_tlsext+7C1j
		add	esp, 10h
		test	eax, eax
		jnz	loc_2666

loc_25B8:				; CODE XREF: _ssl_scan_clienthello_tlsext+312j
					; _ssl_scan_clienthello_tlsext+3A1j ...
		mov	ebp, [esp+24h+var_14]

loc_25BC:				; CODE XREF: _ssl_scan_clienthello_tlsext+55Cj
		mov	eax, [esp+24h+arg_0]
		movzx	eax, ax
		add	edi, eax
		cmp	edi, [esp+24h+var_4]
		jbe	loc_1EF3
		mov	ebx, [esp+24h+arg_8]

loc_25D3:				; CODE XREF: _ssl_scan_clienthello_tlsext+12Dj
		cmp	edi, ebx
		jnz	$err$174
		mov	eax, [esp+24h+arg_4]

$ri_check$175:
		mov	[eax], edi
		test	ebp, ebp
		jnz	loc_26C9

loc_25E9:				; CODE XREF: _ssl_scan_clienthello_tlsext+F5j
		cmp	dword ptr [esi+190h], 0
		jz	loc_26C9
		test	dword ptr [esi+100h], 40000h
		jnz	loc_26C9
		mov	eax, [esp+24h+arg_C]
		push	992h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	152h
		push	140h
		push	14h
		mov	dword ptr [eax], 28h ; '('
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2638:				; CODE XREF: _ssl_scan_clienthello_tlsext+2ABj
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0D0h]
		call	_CRYPTO_free
		mov	eax, [esi+0C0h]
		add	esp, 4
		mov	dword ptr [eax+0D0h], 0

loc_265C:				; CODE XREF: _ssl_scan_clienthello_tlsext+231j
		mov	eax, [esp+24h+arg_C]
		mov	dword ptr [eax], 70h ; 'p'

loc_2666:				; CODE XREF: _ssl_scan_clienthello_tlsext+7F2j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2670:				; CODE XREF: _ssl_scan_clienthello_tlsext+367j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_267B:				; CODE XREF: _ssl_scan_clienthello_tlsext+69Dj
					; _ssl_scan_clienthello_tlsext+6B4j
		push	ebp
		call	_OCSP_RESPID_free
		add	esp, 4

loc_2684:				; CODE XREF: _ssl_scan_clienthello_tlsext+25Bj
					; _ssl_scan_clienthello_tlsext+42Aj ...
		mov	eax, [esp+24h+arg_C]
		mov	dword ptr [eax], 50h ; 'P'

loc_268E:				; CODE XREF: _ssl_scan_clienthello_tlsext+54Dj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2698:				; CODE XREF: _ssl_scan_clienthello_tlsext+681j
		push	ebp
		call	_OCSP_RESPID_free
		mov	eax, [esp+28h+arg_C]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 32h ; '2'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_26B5:				; CODE XREF: _ssl_scan_clienthello_tlsext+767j
		mov	eax, [esp+24h+arg_C]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 2Fh ; '/'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_26C9:				; CODE XREF: _ssl_scan_clienthello_tlsext+823j
					; _ssl_scan_clienthello_tlsext+830j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 14h
		retn
_ssl_scan_clienthello_tlsext endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 26D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl_scan_serverhello_tlsext proc near	; CODE XREF: _ssl_parse_serverhello_tlsext+31p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Src		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 14h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+20h+arg_0]
		xor	edx, edx
		push	edi
		mov	edi, [esp+24h+arg_4]
		xor	ebp, ebp
		mov	[esp+24h+var_14], edx
		mov	eax, [esi+58h]
		mov	[esp+24h+var_10], ebp
		mov	edi, [edi]
		mov	[eax+41Ch], edx
		mov	eax, [esi+58h]
		mov	[esi+140h], edx
		mov	eax, [eax+424h]
		test	eax, eax
		jz	short loc_272C
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+58h]
		add	esp, 4
		xor	edx, edx
		mov	[eax+424h], ebp

loc_272C:				; CODE XREF: _ssl_scan_serverhello_tlsext+3Ej
		mov	ebx, [esp+24h+arg_8]
		add	ebx, [esp+24h+arg_C]
		and	dword ptr [esi+184h], 0FFFFFFFCh
		mov	[esp+24h+arg_8], ebx
		lea	eax, [ebx-2]
		cmp	edi, eax
		jnb	loc_2C0F
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	cx, 8
		or	cx, ax
		movzx	eax, cx
		add	eax, edi
		cmp	eax, ebx
		jz	short loc_2778

loc_2764:				; CODE XREF: _ssl_scan_serverhello_tlsext+148j
					; _ssl_scan_serverhello_tlsext+295j ...
		mov	eax, [esp+24h+arg_10]
		mov	dword ptr [eax], 32h ; '2'

loc_276E:				; CODE XREF: _ssl_scan_serverhello_tlsext+3EDj
					; _ssl_scan_serverhello_tlsext+447j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2778:				; CODE XREF: _ssl_scan_serverhello_tlsext+8Aj
		lea	eax, [ebx-4]
		mov	[esp+24h+var_4], eax
		cmp	edi, eax
		ja	loc_2B5B
		nop

loc_2788:				; CODE XREF: _ssl_scan_serverhello_tlsext+475j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	cx, 8
		or	cx, ax
		movzx	eax, byte ptr [edi+3]
		movzx	ebx, cx
		movzx	ecx, byte ptr [edi+2]
		add	edi, 4
		shl	cx, 8
		or	cx, ax
		movzx	ecx, cx
		movzx	ebp, cx
		mov	[esp+24h+arg_C], ecx
		lea	eax, [edi+ebp]
		mov	[esp+24h+var_8], eax
		cmp	eax, [esp+24h+arg_8]
		ja	loc_2C07
		mov	edx, [esi+118h]
		test	edx, edx
		jz	short loc_27E5
		push	dword ptr [esi+11Ch]
		push	ebp
		push	edi
		push	ebx
		push	1
		push	esi
		call	edx
		mov	ecx, [esp+3Ch+arg_C]
		add	esp, 18h

loc_27E5:				; CODE XREF: _ssl_scan_serverhello_tlsext+F6j
		test	bx, bx
		jnz	short loc_280E
		cmp	dword ptr [esi+120h], 0
		jz	loc_2BB7
		test	cx, cx
		jnz	loc_2BB7
		mov	edx, 1
		mov	[esp+24h+var_14], edx
		jmp	loc_2B45
; ---------------------------------------------------------------------------

loc_280E:				; CODE XREF: _ssl_scan_serverhello_tlsext+110j
		cmp	ebx, 0Bh
		jnz	loc_28A7
		movzx	ebx, byte ptr [edi]
		lea	eax, [ebp-1]
		inc	edi
		cmp	ebx, eax
		jnz	loc_2764
		cmp	dword ptr [esi+6Ch], 0
		jnz	loc_2B41
		mov	eax, [esi+0C0h]
		mov	dword ptr [eax+0D4h], 0
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0D8h]
		test	eax, eax
		jz	short loc_2859
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2859:				; CODE XREF: _ssl_scan_serverhello_tlsext+176j
		push	0A34h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0D8h], eax
		test	eax, eax
		jz	loc_2BCB
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		push	edi		; Src
		mov	[eax+0D4h], ebx
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+0D8h] ; Dst
		call	_memcpy
		add	esp, 0Ch
		jmp	loc_2B41
; ---------------------------------------------------------------------------

loc_28A7:				; CODE XREF: _ssl_scan_serverhello_tlsext+139j
		cmp	ebx, 23h ; '#'
		jnz	short loc_2901
		mov	eax, [esi+160h]
		test	eax, eax
		jz	short loc_28CC
		push	dword ptr [esi+164h]
		push	ebp
		push	edi
		push	esi
		call	eax
		add	esp, 10h
		test	eax, eax
		jz	loc_2BCB

loc_28CC:				; CODE XREF: _ssl_scan_serverhello_tlsext+1DCj
		push	0
		push	0
		push	20h ; ' '
		push	esi
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, 4000h
		jnz	loc_2BDF
		cmp	word ptr [esp+24h+arg_C], 0
		ja	loc_2BDF
		mov	dword ptr [esi+140h], 1
		jmp	loc_2B41
; ---------------------------------------------------------------------------

loc_2901:				; CODE XREF: _ssl_scan_serverhello_tlsext+1D2j
		cmp	ebx, 5
		jnz	short loc_292B
		cmp	dword ptr [esi+128h], 0FFFFFFFFh
		jz	loc_2BDF
		test	cx, cx
		jnz	loc_2BDF
		mov	dword ptr [esi+12Ch], 1
		jmp	loc_2B41
; ---------------------------------------------------------------------------

loc_292B:				; CODE XREF: _ssl_scan_serverhello_tlsext+22Cj
		mov	eax, 3374h
		cmp	bx, ax
		jnz	loc_29FF
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+2B4h], 0
		jnz	loc_2AFD
		mov	edx, [esi+0E4h]
		mov	ebx, [edx+1ACh]
		test	ebx, ebx
		jz	loc_2BDF
		xor	ecx, ecx
		test	ebp, ebp
		jz	short loc_297D
		nop	dword ptr [eax+eax+00h]

loc_2968:				; CODE XREF: _ssl_scan_serverhello_tlsext+2A3j
		mov	al, [ecx+edi]
		test	al, al
		jz	loc_2764
		inc	ecx
		movzx	eax, al
		add	ecx, eax
		cmp	ecx, ebp
		jb	short loc_2968

loc_297D:				; CODE XREF: _ssl_scan_serverhello_tlsext+289j
		cmp	ecx, ebp
		setz	al
		test	al, al
		jz	loc_2764
		push	dword ptr [edx+1B0h]
		lea	eax, [esp+28h+arg_0]
		push	ebp
		push	edi
		push	eax
		lea	eax, [esp+34h+Src]
		push	eax
		push	esi
		call	ebx
		add	esp, 18h
		test	eax, eax
		jnz	loc_2BCB
		movzx	eax, byte ptr [esp+24h+arg_0]
		push	0A9Bh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+174h], eax
		test	eax, eax
		jz	loc_2BCB
		movzx	ecx, byte ptr [esp+24h+arg_0]
		push	ecx		; Size
		push	[esp+28h+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		mov	al, byte ptr [esp+30h+arg_0]
		add	esp, 0Ch
		mov	[esi+178h], al
		mov	eax, [esi+58h]
		mov	dword ptr [eax+41Ch], 1
		jmp	loc_2B41
; ---------------------------------------------------------------------------

loc_29FF:				; CODE XREF: _ssl_scan_serverhello_tlsext+25Bj
		cmp	ebx, 10h
		jnz	loc_2AAA
		mov	eax, [esi+98h]
		cmp	dword ptr [eax+178h], 0
		jz	loc_2BDF
		cmp	cx, 4
		jb	loc_2764
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	ecx, 8
		or	ecx, eax
		lea	eax, [ebp-2]
		cmp	ecx, eax
		jnz	loc_2764
		movzx	ebx, byte ptr [edi+2]
		lea	eax, [ebp-3]
		cmp	ebx, eax
		jnz	loc_2764
		mov	eax, [esi+58h]
		mov	eax, [eax+424h]
		test	eax, eax
		jz	short loc_2A61
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_2A61:				; CODE XREF: _ssl_scan_serverhello_tlsext+37Ej
		push	0AC6h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, [esi+58h]
		add	esp, 0Ch
		mov	[ecx+424h], eax
		mov	eax, [esi+58h]
		mov	ecx, [eax+424h]
		test	ecx, ecx
		jz	loc_2BCB
		push	ebx		; Size
		lea	eax, [edi+3]
		push	eax		; Src
		push	ecx		; Dst
		call	_memcpy
		mov	eax, [esi+58h]
		add	esp, 0Ch
		mov	[eax+428h], ebx
		jmp	loc_2B41
; ---------------------------------------------------------------------------

loc_2AAA:				; CODE XREF: _ssl_scan_serverhello_tlsext+32Aj
		mov	eax, 0FF01h
		cmp	bx, ax
		jnz	short loc_2AD5
		push	[esp+24h+arg_10]
		push	ebp
		push	edi
		push	esi
		call	_ssl_parse_serverhello_renegotiate_ext
		add	esp, 10h
		test	eax, eax
		jz	loc_276E
		mov	[esp+24h+var_10], 1
		jmp	short loc_2B41
; ---------------------------------------------------------------------------

loc_2AD5:				; CODE XREF: _ssl_scan_serverhello_tlsext+3DAj
		cmp	ebx, 0Fh
		jnz	short loc_2AFD
		movzx	eax, byte ptr [edi]
		sub	eax, 1
		jz	short loc_2AF4
		sub	eax, 1
		jnz	loc_2BF3
		or	dword ptr [esi+184h], 3
		jmp	short loc_2B41
; ---------------------------------------------------------------------------

loc_2AF4:				; CODE XREF: _ssl_scan_serverhello_tlsext+408j
		or	dword ptr [esi+184h], 1
		jmp	short loc_2B41
; ---------------------------------------------------------------------------

loc_2AFD:				; CODE XREF: _ssl_scan_serverhello_tlsext+26Bj
					; _ssl_scan_serverhello_tlsext+400j
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_2B27
		cmp	ebx, 0Eh
		jnz	short loc_2B27
		push	[esp+24h+arg_10]
		push	ebp
		push	edi
		push	esi
		call	_ssl_parse_serverhello_use_srtp_ext
		add	esp, 10h
		test	eax, eax
		jnz	loc_276E
		jmp	short loc_2B41
; ---------------------------------------------------------------------------

loc_2B27:				; CODE XREF: _ssl_scan_serverhello_tlsext+42Fj
					; _ssl_scan_serverhello_tlsext+434j
		push	[esp+24h+arg_10]
		push	ebp
		push	edi
		push	ebx
		push	0
		push	esi
		call	_custom_ext_parse
		add	esp, 18h
		test	eax, eax
		jle	loc_276E

loc_2B41:				; CODE XREF: _ssl_scan_serverhello_tlsext+152j
					; _ssl_scan_serverhello_tlsext+1CAj ...
		mov	edx, [esp+24h+var_14]

loc_2B45:				; CODE XREF: _ssl_scan_serverhello_tlsext+131j
		mov	edi, [esp+24h+var_8]
		cmp	edi, [esp+24h+var_4]
		jbe	loc_2788
		mov	ebx, [esp+24h+arg_8]
		mov	ebp, [esp+24h+var_10]

loc_2B5B:				; CODE XREF: _ssl_scan_serverhello_tlsext+A9j
		cmp	edi, ebx
		jnz	loc_2764
		cmp	dword ptr [esi+6Ch], 0
		jnz	short loc_2BAF
		cmp	edx, 1
		jnz	short loc_2BAF
		mov	ecx, [esi+120h]
		test	ecx, ecx
		jz	short loc_2BAF
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+0D0h], 0
		jnz	loc_2764
		push	ecx
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+0D0h], eax
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+0D0h], 0
		jz	short loc_2BB7

loc_2BAF:				; CODE XREF: _ssl_scan_serverhello_tlsext+48Fj
					; _ssl_scan_serverhello_tlsext+494j ...
		mov	eax, [esp+24h+arg_4]
		mov	[eax], edi
		jmp	short $ri_check$104
; ---------------------------------------------------------------------------

loc_2BB7:				; CODE XREF: _ssl_scan_serverhello_tlsext+119j
					; _ssl_scan_serverhello_tlsext+122j ...
		mov	eax, [esp+24h+arg_10]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 70h ; 'p'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2BCB:				; CODE XREF: _ssl_scan_serverhello_tlsext+1A2j
					; _ssl_scan_serverhello_tlsext+1EEj ...
		mov	eax, [esp+24h+arg_10]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 50h ; 'P'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2BDF:				; CODE XREF: _ssl_scan_serverhello_tlsext+208j
					; _ssl_scan_serverhello_tlsext+214j ...
		mov	eax, [esp+24h+arg_10]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 6Eh ; 'n'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2BF3:				; CODE XREF: _ssl_scan_serverhello_tlsext+40Dj
		mov	eax, [esp+24h+arg_10]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 2Fh ; '/'
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2C07:				; CODE XREF: _ssl_scan_serverhello_tlsext+E8j
		mov	ebp, [esp+24h+var_10]

$ri_check$104:				; CODE XREF: _ssl_scan_serverhello_tlsext+4DDj
		test	ebp, ebp
		jnz	short loc_2C4D

loc_2C0F:				; CODE XREF: _ssl_scan_serverhello_tlsext+6Cj
		test	dword ptr [esi+100h], 40004h
		jnz	short loc_2C4D
		mov	eax, [esp+24h+arg_10]
		push	0B18h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	152h
		push	141h
		push	14h
		mov	dword ptr [eax], 28h ; '('
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_2C4D:				; CODE XREF: _ssl_scan_serverhello_tlsext+535j
					; _ssl_scan_serverhello_tlsext+541j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 14h
		retn
_ssl_scan_serverhello_tlsext endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2C5Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_set_client_disabled
_ssl_set_client_disabled proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_0]
		xor	ebx, ebx
		xor	ebp, ebp
		mov	[esp+14h+arg_0], ebx
		mov	esi, [edi+98h]
		mov	[esi+0Ch], ebx
		mov	[esi+8], ebx
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		mov	eax, [eax+38h]
		and	eax, 8
		jz	short loc_2C9C
		cmp	dword ptr [edi+110h], 0FEFDh
		jle	short loc_2CAC

loc_2C9C:				; CODE XREF: _ssl_set_client_disabled+32j
		test	eax, eax
		jnz	short loc_2CB1
		cmp	dword ptr [edi+110h], 303h
		jl	short loc_2CB1

loc_2CAC:				; CODE XREF: _ssl_set_client_disabled+3Ej
		mov	[esi+18h], ebx
		jmp	short loc_2CB8
; ---------------------------------------------------------------------------

loc_2CB1:				; CODE XREF: _ssl_set_client_disabled+42j
					; _ssl_set_client_disabled+4Ej
		mov	dword ptr [esi+18h], 4

loc_2CB8:				; CODE XREF: _ssl_set_client_disabled+53j
		lea	eax, [esp+14h+var_4]
		push	eax
		push	edi
		call	_tls12_get_psigalgs
		add	esp, 8
		test	eax, eax
		jz	short loc_2D10
		mov	ecx, [esp+14h+var_4]
		lea	edx, [eax-1]
		shr	edx, 1
		inc	ecx
		inc	edx
		nop	dword ptr [eax+00000000h]

loc_2CDC:				; CODE XREF: _ssl_set_client_disabled+AEj
		movzx	eax, byte ptr [ecx]
		sub	eax, 1
		jz	short loc_2CFF
		sub	eax, 1
		jz	short loc_2CF8
		sub	eax, 1
		jnz	short loc_2D04
		mov	[esp+14h+arg_0], 1
		jmp	short loc_2D04
; ---------------------------------------------------------------------------

loc_2CF8:				; CODE XREF: _ssl_set_client_disabled+8Bj
		mov	ebp, 1
		jmp	short loc_2D04
; ---------------------------------------------------------------------------

loc_2CFF:				; CODE XREF: _ssl_set_client_disabled+86j
		mov	ebx, 1

loc_2D04:				; CODE XREF: _ssl_set_client_disabled+90j
					; _ssl_set_client_disabled+9Aj	...
		add	ecx, 2
		sub	edx, 1
		jnz	short loc_2CDC
		test	ebx, ebx
		jnz	short loc_2D1E

loc_2D10:				; CODE XREF: _ssl_set_client_disabled+6Cj
		mov	dword ptr [esi+0Ch], 1
		mov	dword ptr [esi+8], 22h ; '"'

loc_2D1E:				; CODE XREF: _ssl_set_client_disabled+B2j
		test	ebp, ebp
		jnz	short loc_2D2A
		or	dword ptr [esi+0Ch], 2
		or	dword ptr [esi+8], 4

loc_2D2A:				; CODE XREF: _ssl_set_client_disabled+C4j
		cmp	[esp+14h+arg_0], 0
		jnz	short loc_2D39
		or	dword ptr [esi+0Ch], 40h
		or	dword ptr [esi+8], 40h

loc_2D39:				; CODE XREF: _ssl_set_client_disabled+D3j
		cmp	dword ptr [edi+0DCh], 0
		jnz	short loc_2D50
		or	dword ptr [esi+0Ch], 80h
		or	dword ptr [esi+8], 100h

loc_2D50:				; CODE XREF: _ssl_set_client_disabled+E4j
		test	dword ptr [edi+1D0h], 400h
		mov	dword ptr [esi+4], 1
		jnz	short loc_2D71
		or	dword ptr [esi+0Ch], 400h
		or	dword ptr [esi+8], 400h

loc_2D71:				; CODE XREF: _ssl_set_client_disabled+105j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_ssl_set_client_disabled endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2D78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls12_check_peer_sigalg
_tls12_check_peer_sigalg proc near

var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 8
		call	__chkstk
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		xor	eax, eax
		mov	ecx, [edi]

loc_2D8B:				; CODE XREF: _tls12_check_peer_sigalg+20j
		cmp	ds:_tls12_sig[eax*8], ecx
		jz	short loc_2DA2
		inc	eax
		cmp	eax, 3
		jb	short loc_2D8B
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2DA2:				; CODE XREF: _tls12_check_peer_sigalg+1Aj
		mov	edx, ds:dword_194[eax*8]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_2DB5
		or	eax, edx
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2DB5:				; CODE XREF: _tls12_check_peer_sigalg+34j
		push	esi
		mov	esi, [esp+10h+arg_8]
		movzx	eax, byte ptr [esi+1]
		cmp	edx, eax
		jz	short loc_2DE8
		push	43Ch
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	172h
		push	14Dh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2DE8:				; CODE XREF: _tls12_check_peer_sigalg+48j
		push	ebp
		cmp	ecx, 198h
		jnz	loc_2EA5
		push	dword ptr [edi+14h]
		lea	eax, [esp+18h+var_5]
		push	eax
		lea	eax, [esp+1Ch+var_4]
		push	eax
		call	_tls1_set_ec_id
		add	esp, 0Ch
		test	eax, eax
		jz	loc_2F4A
		mov	edi, [esp+14h+arg_4]
		cmp	dword ptr [edi+24h], 0
		jnz	short loc_2E47
		lea	eax, [esp+14h+var_5]
		push	eax
		lea	eax, [esp+18h+var_4]
		push	eax
		push	edi
		call	_tls1_check_ec_key
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_2E47
		push	446h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	17Ah
		jmp	loc_2F3B
; ---------------------------------------------------------------------------

loc_2E47:				; CODE XREF: _tls12_check_peer_sigalg+A2j
					; _tls12_check_peer_sigalg+B9j
		mov	eax, [edi+98h]
		mov	ebp, [eax+38h]
		test	ebp, 30000h
		jz	short loc_2EBE
		mov	ax, word ptr [esp+14h+var_4]
		test	al, al
		jnz	loc_2F4A
		cmp	ah, 17h
		jnz	short loc_2E83
		cmp	byte ptr [esi],	4
		jz	short loc_2EBE
		push	450h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	17Ch
		jmp	loc_2F3B
; ---------------------------------------------------------------------------

loc_2E83:				; CODE XREF: _tls12_check_peer_sigalg+F0j
		cmp	ah, 18h
		jnz	loc_2F4A
		cmp	byte ptr [esi],	5
		jz	short loc_2EBE
		push	456h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	17Ch
		jmp	loc_2F3B
; ---------------------------------------------------------------------------

loc_2EA5:				; CODE XREF: _tls12_check_peer_sigalg+77j
		mov	edi, [esp+14h+arg_4]
		mov	eax, [edi+98h]
		mov	ebp, [eax+38h]
		test	ebp, 30000h
		jnz	loc_2F4A

loc_2EBE:				; CODE XREF: _tls12_check_peer_sigalg+DEj
					; _tls12_check_peer_sigalg+F5j	...
		push	ebx
		lea	eax, [esp+18h+var_4]
		push	eax
		push	edi
		call	_tls12_get_psigalgs
		mov	ebx, eax
		add	esp, 8
		xor	edx, edx
		test	ebx, ebx
		jz	short loc_2EF1
		mov	ah, [esi]
		mov	ecx, [esp+18h+var_4]

loc_2EDB:				; CODE XREF: _tls12_check_peer_sigalg+177j
		cmp	ah, [ecx]
		jnz	short loc_2EE7
		mov	al, [esi+1]
		cmp	al, [ecx+1]
		jz	short loc_2EF1

loc_2EE7:				; CODE XREF: _tls12_check_peer_sigalg+165j
		add	edx, 2
		add	ecx, 2
		cmp	edx, ebx
		jb	short loc_2EDB

loc_2EF1:				; CODE XREF: _tls12_check_peer_sigalg+15Bj
					; _tls12_check_peer_sigalg+16Dj
		cmp	edx, ebx
		pop	ebx
		jnz	short loc_2F14
		cmp	byte ptr [esi],	2
		jnz	short loc_2F03
		test	ebp, 30001h
		jz	short loc_2F14

loc_2F03:				; CODE XREF: _tls12_check_peer_sigalg+181j
		push	46Ah
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	172h
		jmp	short loc_2F3B
; ---------------------------------------------------------------------------

loc_2F14:				; CODE XREF: _tls12_check_peer_sigalg+17Cj
					; _tls12_check_peer_sigalg+189j
		movzx	eax, byte ptr [esi]
		push	eax
		call	_tls12_get_hash
		mov	ecx, [esp+18h+arg_0]
		mov	edx, eax
		add	esp, 4
		mov	[ecx], edx
		test	edx, edx
		jnz	short loc_2F53
		push	46Fh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	170h

loc_2F3B:				; CODE XREF: _tls12_check_peer_sigalg+CAj
					; _tls12_check_peer_sigalg+106j ...
		push	14Dh
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_2F4A:				; CODE XREF: _tls12_check_peer_sigalg+94j
					; _tls12_check_peer_sigalg+E7j	...
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_2F53:				; CODE XREF: _tls12_check_peer_sigalg+1B2j
		mov	eax, [edi+0C0h]
		test	eax, eax
		jz	short loc_2F6D
		mov	eax, [eax+98h]
		test	eax, eax
		jz	short loc_2F6D
		mov	eax, [eax+8]
		mov	[eax+8], edx

loc_2F6D:				; CODE XREF: _tls12_check_peer_sigalg+1E3j
					; _tls12_check_peer_sigalg+1EDj
		pop	ebp
		pop	esi
		mov	eax, 1
		pop	edi
		add	esp, 8
		retn
_tls12_check_peer_sigalg endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2F7Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls12_do_shared_sigalgs proc near	; CODE XREF: _tls1_set_shared_sigalgs+D2p
					; _tls1_set_shared_sigalgs+10Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 4
		call	__chkstk
		mov	ecx, [esp+4+arg_8]
		push	ebx
		xor	ebx, ebx
		mov	[esp+8+var_4], ebx
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		test	ecx, ecx
		jz	loc_303D
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		lea	ebp, [ecx-1]
		add	eax, 0Ch
		shr	ebp, 1
		push	edi
		mov	edi, [esp+14h+arg_10]
		inc	ebp
		mov	[esp+14h+arg_4], eax
		nop	dword ptr [eax+00000000h]

loc_2FBC:				; CODE XREF: _tls12_do_shared_sigalgs+BDj
		movzx	eax, byte ptr [esi]
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	short loc_3033	; jumptable 00002FC5 default case
		jmp	ds:$LN48[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN16_1:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_md5	; jumptable 00002FC5 case 0
		jmp	short loc_2FF4
; ---------------------------------------------------------------------------

$LN17_1:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_sha1	; jumptable 00002FC5 case 1
		jmp	short loc_2FF4
; ---------------------------------------------------------------------------

$LN18_0:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_sha224	; jumptable 00002FC5 case 2
		jmp	short loc_2FF4
; ---------------------------------------------------------------------------

$LN19_1:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_sha256	; jumptable 00002FC5 case 3
		jmp	short loc_2FF4
; ---------------------------------------------------------------------------

$LN20_1:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_sha384	; jumptable 00002FC5 case 4
		jmp	short loc_2FF4
; ---------------------------------------------------------------------------

$LN21_1:				; CODE XREF: _tls12_do_shared_sigalgs+49j
					; DATA XREF: .text$mn:$LN48o
		call	_EVP_sha512	; jumptable 00002FC5 case 5

loc_2FF4:				; CODE XREF: _tls12_do_shared_sigalgs+55j
					; _tls12_do_shared_sigalgs+5Cj	...
		test	eax, eax
		jz	short loc_3033	; jumptable 00002FC5 default case
		mov	bl, [esi+1]
		movzx	eax, bl
		sub	eax, 1
		jz	short loc_300D
		sub	eax, 1
		jz	short loc_300D
		sub	eax, 1
		jnz	short loc_302F

loc_300D:				; CODE XREF: _tls12_do_shared_sigalgs+85j
					; _tls12_do_shared_sigalgs+8Aj
		mov	eax, [esp+14h+arg_C]
		xor	ecx, ecx
		test	edi, edi
		jz	short loc_302F
		mov	dl, [esi]
		nop	dword ptr [eax]

loc_301C:				; CODE XREF: _tls12_do_shared_sigalgs+B1j
		cmp	dl, [eax]
		jnz	short loc_3025
		cmp	bl, [eax+1]
		jz	short loc_3043

loc_3025:				; CODE XREF: _tls12_do_shared_sigalgs+A2j
		add	ecx, 2
		add	eax, 2
		cmp	ecx, edi
		jb	short loc_301C

loc_302F:				; CODE XREF: _tls12_do_shared_sigalgs+8Fj
					; _tls12_do_shared_sigalgs+99j
		mov	ebx, [esp+14h+var_4]

loc_3033:				; CODE XREF: _tls12_do_shared_sigalgs+47j
					; _tls12_do_shared_sigalgs+7Aj	...
		add	esi, 2		; jumptable 00002FC5 default case
		sub	ebp, 1
		jnz	short loc_2FBC
		pop	edi
		pop	ebp

loc_303D:				; CODE XREF: _tls12_do_shared_sigalgs+1Cj
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3043:				; CODE XREF: _tls12_do_shared_sigalgs+A7j
		mov	ecx, [esp+14h+arg_4]
		mov	ebx, [esp+14h+var_4]
		inc	ebx
		mov	[esp+14h+var_4], ebx
		lea	eax, [ecx-0Ch]
		test	eax, eax
		jz	short loc_3033	; jumptable 00002FC5 default case
		mov	[ecx+1], dl
		mov	al, [esi+1]
		mov	[ecx], al
		lea	eax, [ecx-4]
		push	esi
		push	eax
		lea	eax, [ecx-8]
		push	eax
		lea	eax, [ecx-0Ch]
		push	eax
		call	_tls1_lookup_sigalg
		add	esp, 10h
		add	[esp+14h+arg_4], 10h
		jmp	short loc_3033	; jumptable 00002FC5 default case
_tls12_do_shared_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
$LN48		dd offset $LN16_1	; DATA XREF: _tls12_do_shared_sigalgs+49r
		dd offset $LN17_1	; jump table for switch	statement
		dd offset $LN18_0
		dd offset $LN19_1
		dd offset $LN20_1
		dd offset $LN21_1
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3094h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls12_find_id	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		xor	eax, eax
		push	esi
		test	ecx, ecx
		jz	short loc_30B1
		mov	edx, [esp+4+arg_4]
		mov	esi, [esp+4+arg_0]

loc_30A7:				; CODE XREF: _tls12_find_id+1Bj
		cmp	[edx+eax*8], esi
		jz	short loc_30B6
		inc	eax
		cmp	eax, ecx
		jb	short loc_30A7

loc_30B1:				; CODE XREF: _tls12_find_id+9j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_30B6:				; CODE XREF: _tls12_find_id+16j
		mov	eax, [edx+eax*8+4]
		pop	esi
		retn
_tls12_find_id	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls12_find_nid	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_8]
		xor	eax, eax
		push	esi
		push	edi
		test	edx, edx
		jz	short loc_30DF
		mov	edi, [esp+8+arg_4]
		mov	esi, [esp+8+arg_0]
		lea	ecx, [edi+4]

loc_30D3:				; CODE XREF: _tls12_find_nid+21j
		cmp	[ecx], esi
		jz	short loc_30E4
		inc	eax
		add	ecx, 8
		cmp	eax, edx
		jb	short loc_30D3

loc_30DF:				; CODE XREF: _tls12_find_nid+Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_30E4:				; CODE XREF: _tls12_find_nid+19j
		mov	eax, [edi+eax*8]
		pop	edi
		pop	esi
		retn
_tls12_find_nid	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 30ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls12_get_hash
_tls12_get_hash	proc near		; CODE XREF: _tls12_check_peer_sigalg+1A0p

arg_0		= byte ptr  4

		movzx	eax, [esp+arg_0]
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	short loc_311C	; jumptable 000030F7 default case
		jmp	ds:$LN14_1[eax*4] ; switch jump
; ---------------------------------------------------------------------------

$LN4_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_md5	; jumptable 000030F7 case 0
; ---------------------------------------------------------------------------

$LN5_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_sha1	; jumptable 000030F7 case 1
; ---------------------------------------------------------------------------

$LN6_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_sha224	; jumptable 000030F7 case 2
; ---------------------------------------------------------------------------

$LN7_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_sha256	; jumptable 000030F7 case 3
; ---------------------------------------------------------------------------

$LN8_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_sha384	; jumptable 000030F7 case 4
; ---------------------------------------------------------------------------

$LN9_0:					; CODE XREF: _tls12_get_hash+Bj
					; DATA XREF: .text$mn:$LN14_1o
		jmp	_EVP_sha512	; jumptable 000030F7 case 5
; ---------------------------------------------------------------------------

loc_311C:				; CODE XREF: _tls12_get_hash+9j
		xor	eax, eax	; jumptable 000030F7 default case
		retn
_tls12_get_hash	endp

; ---------------------------------------------------------------------------
		align 10h
$LN14_1		dd offset $LN4_0	; DATA XREF: _tls12_get_hash+Br
		dd offset $LN5_0	; jump table for switch	statement
		dd offset $LN6_0
		dd offset $LN7_0
		dd offset $LN8_0
		dd offset $LN9_0
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3138h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls12_get_pkey_idx proc near

arg_0		= byte ptr  4

		movzx	eax, [esp+arg_0]
		sub	eax, 1
		jz	short loc_315C
		sub	eax, 1
		jz	short loc_3156
		sub	eax, 1
		jz	short loc_3150
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_3150:				; CODE XREF: _tls12_get_pkey_idx+12j
		mov	eax, 5
		retn
; ---------------------------------------------------------------------------

loc_3156:				; CODE XREF: _tls12_get_pkey_idx+Dj
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_315C:				; CODE XREF: _tls12_get_pkey_idx+8j
		mov	eax, 1
		retn
_tls12_get_pkey_idx endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3164h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls12_get_psigalgs
_tls12_get_psigalgs proc near		; CODE XREF: _ssl_add_clienthello_tlsext+572p
					; _ssl_set_client_disabled+62p	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	edx, [ecx+98h]
		mov	eax, [edx+38h]
		and	eax, 30000h
		cmp	eax, 10000h
		jz	short loc_31FB
		cmp	eax, 20000h
		jz	short loc_31EB
		cmp	eax, 30000h
		jz	short loc_31DB
		cmp	dword ptr [ecx+24h], 0
		push	esi
		jz	short loc_31B0
		mov	esi, [edx+134h]
		test	esi, esi
		jz	short loc_31B0
		mov	eax, [esp+4+arg_4]
		mov	[eax], esi
		mov	eax, [ecx+98h]
		pop	esi
		mov	eax, [eax+138h]
		retn
; ---------------------------------------------------------------------------

loc_31B0:				; CODE XREF: _tls12_get_psigalgs+2Cj
					; _tls12_get_psigalgs+36j
		mov	edx, [edx+12Ch]
		mov	eax, [esp+4+arg_4]
		test	edx, edx
		jz	short loc_31CE
		mov	[eax], edx
		mov	eax, [ecx+98h]
		pop	esi
		mov	eax, [eax+130h]
		retn
; ---------------------------------------------------------------------------

loc_31CE:				; CODE XREF: _tls12_get_psigalgs+58j
		mov	dword ptr [eax], offset	_tls12_sigalgs
		mov	eax, 1Eh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_31DB:				; CODE XREF: _tls12_get_psigalgs+25j
		mov	eax, [esp+arg_4]
		mov	dword ptr [eax], offset	_suiteb_sigalgs
		mov	eax, 4
		retn
; ---------------------------------------------------------------------------

loc_31EB:				; CODE XREF: _tls12_get_psigalgs+1Ej
		mov	eax, [esp+arg_4]
		mov	dword ptr [eax], offset	word_15E
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_31FB:				; CODE XREF: _tls12_get_psigalgs+17j
		mov	eax, [esp+arg_4]
		mov	dword ptr [eax], offset	_suiteb_sigalgs
		mov	eax, 2
		retn
_tls12_get_psigalgs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 320Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls12_get_sigandhash
_tls12_get_sigandhash proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jnz	short loc_3217

loc_3214:				; CODE XREF: _tls12_get_sigandhash+32j
					; _tls12_get_sigandhash+5Cj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_3217:				; CODE XREF: _tls12_get_sigandhash+6j
		push	eax
		call	_EVP_MD_type
		add	esp, 4
		xor	ecx, ecx

loc_3222:				; CODE XREF: _tls12_get_sigandhash+23j
		cmp	ds:_tls12_md[ecx*8], eax
		jz	short loc_3234
		inc	ecx
		cmp	ecx, 6
		jb	short loc_3222
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_3234:				; CODE XREF: _tls12_get_sigandhash+1Dj
		mov	edx, ds:dword_164[ecx*8]
		cmp	edx, 0FFFFFFFFh
		jz	short loc_3214
		mov	eax, [esp+arg_4]
		xor	ecx, ecx
		mov	eax, [eax]
		nop	dword ptr [eax+00h]

loc_324C:				; CODE XREF: _tls12_get_sigandhash+4Dj
		cmp	ds:_tls12_sig[ecx*8], eax
		jz	short loc_325E
		inc	ecx
		cmp	ecx, 3
		jb	short loc_324C
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_325E:				; CODE XREF: _tls12_get_sigandhash+47j
		mov	ecx, ds:dword_194[ecx*8]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_3214
		mov	eax, [esp+arg_0]
		mov	[eax], dl
		mov	[eax+1], cl
		mov	eax, 1
		retn
_tls12_get_sigandhash endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 327Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls12_get_sigid
_tls12_get_sigid proc near

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		mov	ecx, [ecx]
		nop	dword ptr [eax+eax+00000000h]

loc_328C:				; CODE XREF: _tls12_get_sigid+1Dj
		cmp	ds:_tls12_sig[eax*8], ecx
		jz	short loc_329F
		inc	eax
		cmp	eax, 3
		jb	short loc_328C
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_329F:				; CODE XREF: _tls12_get_sigid+17j
		mov	eax, ds:dword_194[eax*8]
		retn
_tls12_get_sigid endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 32A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_alpn_handle_client_hello proc near ; CODE	XREF: _ssl_scan_clienthello_tlsext+7BCp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		cmp	esi, 2
		jb	$parse_error$22
		mov	edi, [esp+8+arg_4]
		sub	esi, 2
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		cmp	esi, ecx
		jnz	$parse_error$22
		cmp	esi, 2
		jb	$parse_error$22
		xor	eax, eax
		test	esi, esi
		jz	short loc_330D
		nop	dword ptr [eax+00h]

loc_32E8:				; CODE XREF: _tls1_alpn_handle_client_hello+63j
		movzx	ecx, byte ptr [eax+edi]
		inc	eax
		test	ecx, ecx
		jz	$parse_error$22
		add	ecx, eax
		cmp	ecx, eax
		jb	$parse_error$22
		cmp	ecx, esi
		ja	$parse_error$22
		mov	eax, ecx
		cmp	eax, esi
		jb	short loc_32E8

loc_330D:				; CODE XREF: _tls1_alpn_handle_client_hello+3Aj
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		mov	eax, [ebx+98h]
		mov	eax, [eax+170h]
		test	eax, eax
		jz	short loc_332B
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_332B:				; CODE XREF: _tls1_alpn_handle_client_hello+78j
		push	7A1h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	esi
		call	_CRYPTO_malloc
		mov	ecx, [ebx+98h]
		add	esp, 0Ch
		mov	[ecx+170h], eax
		mov	eax, [ebx+98h]
		mov	eax, [eax+170h]
		test	eax, eax
		jnz	short loc_336B
		mov	eax, [esp+0Ch+arg_C]
		pop	ebx
		pop	edi
		pop	esi
		mov	dword ptr [eax], 50h ; 'P'
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_336B:				; CODE XREF: _tls1_alpn_handle_client_hello+B0j
		push	esi		; Size
		push	edi		; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [ebx+98h]
		add	esp, 0Ch
		pop	ebx
		mov	[eax+174h], esi
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$parse_error$22:			; CODE XREF: _tls1_alpn_handle_client_hello+9j
					; _tls1_alpn_handle_client_hello+27j ...
		mov	eax, [esp+8+arg_C]
		pop	edi
		pop	esi
		mov	dword ptr [eax], 32h ; '2'
		or	eax, 0FFFFFFFFh
		retn
_tls1_alpn_handle_client_hello endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3398h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_alpn_handle_client_hello_late proc near
					; CODE XREF: _ssl_check_clienthello_tlsext_late+92p

var_5		= byte ptr -5
Src		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 8
		call	__chkstk
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	[esp+0Ch+Src], 0
		mov	[esp+0Ch+var_5], 0
		mov	eax, [esi+0E4h]
		mov	ecx, [eax+1B8h]
		test	ecx, ecx
		jz	loc_348A
		mov	edx, [esi+98h]
		cmp	dword ptr [edx+170h], 0
		jz	loc_348A
		push	dword ptr [eax+1BCh]
		lea	eax, [esp+10h+var_5]
		push	dword ptr [edx+174h]
		push	dword ptr [edx+170h]
		push	eax
		lea	eax, [esp+1Ch+Src]
		push	eax
		push	esi
		call	ecx
		add	esp, 18h
		test	eax, eax
		jnz	loc_348A
		mov	eax, [esi+58h]
		push	dword ptr [eax+424h]
		call	_CRYPTO_free
		movzx	eax, [esp+10h+var_5]
		push	7C2h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		call	_CRYPTO_malloc
		mov	ecx, [esi+58h]
		add	esp, 10h
		mov	[ecx+424h], eax
		mov	eax, [esi+58h]
		mov	ecx, [eax+424h]
		test	ecx, ecx
		jnz	short loc_345C
		mov	eax, [esp+0Ch+arg_8]
		pop	esi
		mov	dword ptr [eax], 50h ; 'P'
		mov	eax, [esp+8+arg_4]
		mov	dword ptr [eax], 2
		xor	eax, eax
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_345C:				; CODE XREF: _tls1_alpn_handle_client_hello_late+A7j
		movzx	eax, [esp+0Ch+var_5]
		push	eax		; Size
		push	[esp+10h+Src]	; Src
		push	ecx		; Dst
		call	_memcpy
		mov	eax, [esi+58h]
		add	esp, 0Ch
		movzx	ecx, [esp+0Ch+var_5]
		mov	[eax+428h], ecx
		mov	eax, [esi+58h]
		mov	dword ptr [eax+41Ch], 0

loc_348A:				; CODE XREF: _tls1_alpn_handle_client_hello_late+2Aj
					; _tls1_alpn_handle_client_hello_late+3Dj ...
		mov	eax, 1
		pop	esi
		add	esp, 8
		retn
_tls1_alpn_handle_client_hello_late endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3494h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_check_cert_param proc near	; CODE XREF: _tls1_check_chain+296p
					; _tls1_check_chain+2EEp

var_5		= byte ptr -5
var_4		= word ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 8
		call	__chkstk
		push	edi
		push	[esp+0Ch+arg_4]
		call	_X509_get_pubkey
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_34B6
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_34B6:				; CODE XREF: _tls1_check_cert_param+1Bj
		cmp	dword ptr [edi], 198h
		jz	short loc_34D1
		push	edi
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, 1
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_34D1:				; CODE XREF: _tls1_check_cert_param+28j
		push	esi
		push	dword ptr [edi+14h]
		lea	eax, [esp+14h+var_5]
		push	eax
		lea	eax, [esp+18h+var_4]
		push	eax
		call	_tls1_set_ec_id
		push	edi
		mov	esi, eax
		call	_EVP_PKEY_free
		add	esp, 10h
		test	esi, esi
		jnz	short loc_34FB
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_34FB:				; CODE XREF: _tls1_check_cert_param+5Dj
		mov	edi, [esp+10h+arg_0]
		lea	eax, [esp+10h+var_5]
		push	ebp
		push	eax
		xor	ecx, ecx
		lea	eax, [esp+18h+var_4]
		cmp	[edi+24h], ecx
		cmovz	eax, ecx
		push	eax
		push	edi
		call	_tls1_check_ec_key
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_3584
		cmp	[esp+14h+arg_8], 0
		jz	loc_35BB
		mov	edi, [edi+98h]
		test	dword ptr [edi+38h], 30000h
		jz	loc_35BB
		mov	ax, [esp+14h+var_4]
		test	al, al
		jnz	short loc_3584
		cmp	ah, 17h
		jnz	short loc_3554
		mov	edx, 31Ah
		jmp	short loc_355E
; ---------------------------------------------------------------------------

loc_3554:				; CODE XREF: _tls1_check_cert_param+B7j
		cmp	ah, 18h
		jnz	short loc_3584
		mov	edx, 31Bh

loc_355E:				; CODE XREF: _tls1_check_cert_param+BEj
		mov	esi, [edi+140h]
		xor	ecx, ecx
		test	esi, esi
		jz	short loc_3580
		mov	eax, [edi+13Ch]
		add	eax, 8
		nop

loc_3574:				; CODE XREF: _tls1_check_cert_param+EAj
		cmp	edx, [eax]
		jz	short loc_3580
		inc	ecx
		add	eax, 10h
		cmp	ecx, esi
		jb	short loc_3574

loc_3580:				; CODE XREF: _tls1_check_cert_param+D4j
					; _tls1_check_cert_param+E2j
		cmp	ecx, esi
		jnz	short loc_358D

loc_3584:				; CODE XREF: _tls1_check_cert_param+8Bj
					; _tls1_check_cert_param+B2j ...
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_358D:				; CODE XREF: _tls1_check_cert_param+EEj
		cmp	[esp+14h+arg_8], 2
		jnz	short loc_35BB
		cmp	edx, 31Ah
		jnz	short loc_35B0
		call	_EVP_sha256
		mov	[edi+0D0h], eax
		mov	eax, ebp
		pop	ebp
		pop	esi
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_35B0:				; CODE XREF: _tls1_check_cert_param+106j
		call	_EVP_sha384
		mov	[edi+0D0h], eax

loc_35BB:				; CODE XREF: _tls1_check_cert_param+92j
					; _tls1_check_cert_param+A5j ...
		mov	eax, ebp
		pop	ebp
		pop	esi
		pop	edi
		add	esp, 8
		retn
_tls1_check_cert_param endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 35C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_check_chain
_tls1_check_chain proc near		; CODE XREF: _SSL_check_chain+12p
					; _tls1_set_cert_validity+Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 18h
		call	__chkstk
		mov	eax, [esp+18h+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+24h+arg_10]
		xor	ebx, ebx
		push	edi
		mov	edi, [eax+98h]
		xor	ebp, ebp
		mov	[esp+28h+var_10], edi
		mov	eax, [edi+38h]
		and	eax, 30000h
		mov	[esp+28h+var_14], eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_3668
		cmp	esi, 0FFFFFFFEh
		jnz	short loc_3622
		mov	ecx, [edi]
		mov	eax, 92492493h
		mov	[esp+28h+arg_10], ecx
		sub	ecx, edi
		sub	ecx, 3Ch ; '<'
		imul	ecx
		add	edx, ecx
		sar	edx, 4
		mov	esi, edx
		shr	esi, 1Fh
		add	esi, edx
		mov	edx, [esp+28h+arg_10]
		jmp	short loc_3635
; ---------------------------------------------------------------------------

loc_3622:				; CODE XREF: _tls1_check_chain+38j
		lea	edx, ds:0[esi*8]
		sub	edx, esi
		add	edx, 0Fh
		lea	edx, [edi+edx*4]
		mov	[esp+28h+arg_10], edx

loc_3635:				; CODE XREF: _tls1_check_chain+5Cj
		mov	eax, [edx+4]
		mov	ecx, [edx]
		mov	edi, [edx+0Ch]
		mov	[esp+28h+var_8], eax
		mov	eax, [esp+28h+var_10]
		mov	[esp+28h+var_C], ecx
		mov	eax, [eax+38h]
		and	eax, 30001h
		mov	[esp+28h+var_18], eax
		test	ecx, ecx
		jz	$end$145
		cmp	[esp+28h+var_8], ebx
		jnz	short loc_36D6
		jmp	$end$145
; ---------------------------------------------------------------------------

loc_3668:				; CODE XREF: _tls1_check_chain+33j
		mov	eax, [esp+28h+arg_4]
		mov	[esp+28h+var_C], eax
		test	eax, eax
		jz	loc_3AD1
		mov	ecx, [esp+28h+arg_8]
		mov	[esp+28h+var_8], ecx
		test	ecx, ecx
		jz	loc_3AD1
		push	ecx
		push	eax
		call	_ssl_cert_type
		mov	esi, eax
		add	esp, 8
		cmp	esi, 0FFFFFFFFh
		jz	loc_3AD1
		mov	ebp, [edi+38h]
		lea	ecx, ds:0[esi*8]
		sub	ecx, esi
		mov	[esp+28h+var_18], 1
		and	ebp, 30001h
		add	ecx, 0Fh
		neg	ebp
		sbb	ebp, ebp
		lea	ecx, [edi+ecx*4]
		and	ebp, 6A0h
		mov	edi, [esp+28h+arg_C]
		add	ebp, 50h ; 'P'
		mov	[esp+28h+arg_10], ecx
		mov	ecx, [esp+28h+arg_4]

loc_36D6:				; CODE XREF: _tls1_check_chain+9Dj
		mov	eax, [esp+28h+var_14]
		test	eax, eax
		jz	short loc_3708
		test	ebp, ebp
		jz	short loc_36E8
		or	ebp, 800h

loc_36E8:				; CODE XREF: _tls1_check_chain+11Cj
		push	eax
		push	edi
		push	ecx
		push	0
		call	_X509_chain_check_suiteb
		add	esp, 10h
		test	eax, eax
		jnz	short loc_3700
		mov	ebx, 800h
		jmp	short loc_3708
; ---------------------------------------------------------------------------

loc_3700:				; CODE XREF: _tls1_check_chain+133j
		test	ebp, ebp
		jz	loc_3A7A

loc_3708:				; CODE XREF: _tls1_check_chain+118j
					; _tls1_check_chain+13Aj
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [eax]
		mov	eax, ecx
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		jnz	loc_3841
		cmp	ecx, 303h
		jl	loc_3841
		cmp	[esp+28h+var_18], 0
		jz	loc_3841
		mov	ecx, [esp+28h+var_10]
		cmp	dword ptr [ecx+124h], 0
		jz	short loc_374F
		xor	eax, eax
		mov	[esp+28h+var_14], eax
		jmp	loc_37D4
; ---------------------------------------------------------------------------

loc_374F:				; CODE XREF: _tls1_check_chain+17Ej
		cmp	esi, 5		; switch 6 cases
		ja	short loc_37C7	; jumptable 00003754 default case
		jmp	ds:$LN144[esi*4] ; switch jump
; ---------------------------------------------------------------------------

$LN41:					; CODE XREF: _tls1_check_chain+190j
					; DATA XREF: .text$mn:$LN144o
		mov	dl, 1		; jumptable 00003754 cases 0,1,3
		mov	eax, 41h ; 'A'
		jmp	short loc_3774
; ---------------------------------------------------------------------------

$LN42:					; CODE XREF: _tls1_check_chain+190j
					; DATA XREF: .text$mn:$LN144o
		mov	dl, 2		; jumptable 00003754 cases 2,4
		mov	eax, 71h ; 'q'
		jmp	short loc_3774
; ---------------------------------------------------------------------------

$LN43:					; CODE XREF: _tls1_check_chain+190j
					; DATA XREF: .text$mn:$LN144o
		mov	dl, 3		; jumptable 00003754 case 5
		mov	eax, 1A0h

loc_3774:				; CODE XREF: _tls1_check_chain+19Ej
					; _tls1_check_chain+1A7j
		mov	esi, [ecx+12Ch]
		mov	[esp+28h+var_14], eax
		test	esi, esi
		jz	short loc_37D4
		mov	eax, [ecx+130h]
		test	eax, eax
		mov	[esp+28h+var_4], eax
		mov	eax, 0
		jbe	short loc_37B2
		lea	ecx, [esi+1]

loc_3798:				; CODE XREF: _tls1_check_chain+1E8j
		cmp	byte ptr [esi+eax], 2
		jnz	short loc_37A2
		cmp	[ecx], dl
		jz	short loc_37AE

loc_37A2:				; CODE XREF: _tls1_check_chain+1D8j
		add	eax, 2
		add	ecx, 2
		cmp	eax, [esp+28h+var_4]
		jb	short loc_3798

loc_37AE:				; CODE XREF: _tls1_check_chain+1DCj
		mov	ecx, [esp+28h+var_10]

loc_37B2:				; CODE XREF: _tls1_check_chain+1CFj
		cmp	eax, [ecx+130h]
		jnz	short loc_37D0
		test	ebp, ebp
		jnz	$skip_sigs$146
		jmp	loc_3A7A
; ---------------------------------------------------------------------------

loc_37C7:				; CODE XREF: _tls1_check_chain+18Ej
		or	eax, 0FFFFFFFFh	; jumptable 00003754 default case
		mov	[esp+28h+var_14], eax
		jmp	short loc_37D4
; ---------------------------------------------------------------------------

loc_37D0:				; CODE XREF: _tls1_check_chain+1F4j
		mov	eax, [esp+28h+var_14]

loc_37D4:				; CODE XREF: _tls1_check_chain+186j
					; _tls1_check_chain+1BCj ...
		push	eax
		push	[esp+2Ch+var_C]
		push	ecx
		call	_tls1_check_sig_alg
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_37F0
		test	ebp, ebp
		jz	loc_3A7A
		jmp	short loc_37F3
; ---------------------------------------------------------------------------

loc_37F0:				; CODE XREF: _tls1_check_chain+220j
		or	ebx, 10h

loc_37F3:				; CODE XREF: _tls1_check_chain+22Aj
		push	edi
		or	ebx, 20h
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short $skip_sigs$146

loc_3805:				; CODE XREF: _tls1_check_chain+26Cj
		push	[esp+28h+var_14]
		push	esi
		push	edi
		call	_sk_value
		add	esp, 8
		push	eax
		push	[esp+30h+var_10]
		call	_tls1_check_sig_alg
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_3834
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_3805
		jmp	short $skip_sigs$146
; ---------------------------------------------------------------------------

loc_3834:				; CODE XREF: _tls1_check_chain+25Ej
		test	ebp, ebp
		jz	loc_3A7A
		and	ebx, 0FFFFFFDFh
		jmp	short $skip_sigs$146
; ---------------------------------------------------------------------------

loc_3841:				; CODE XREF: _tls1_check_chain+156j
					; _tls1_check_chain+162j ...
		test	ebp, ebp
		jz	short $skip_sigs$146
		or	ebx, 30h

$skip_sigs$146:				; CODE XREF: _tls1_check_chain+1F8j
					; _tls1_check_chain+23Fj ...
		mov	eax, ebp
		neg	eax
		sbb	eax, eax
		add	eax, 2
		push	eax
		push	[esp+2Ch+var_C]
		push	[esp+30h+arg_0]
		call	_tls1_check_cert_param
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_386B
		or	ebx, 40h
		jmp	short loc_3873
; ---------------------------------------------------------------------------

loc_386B:				; CODE XREF: _tls1_check_chain+2A0j
		test	ebp, ebp
		jz	loc_3A7A

loc_3873:				; CODE XREF: _tls1_check_chain+2A5j
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [esp+28h+var_18]
		cmp	dword ptr [eax+24h], 0
		jnz	short loc_3889
		or	ebx, 80h
		jmp	short loc_38E4
; ---------------------------------------------------------------------------

loc_3889:				; CODE XREF: _tls1_check_chain+2BBj
		test	ecx, ecx
		jz	short loc_38E4
		push	edi
		or	ebx, 80h
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_38DC
		xchg	ax, ax

loc_38A4:				; CODE XREF: _tls1_check_chain+306j
		push	esi
		push	edi
		call	_sk_value
		push	0
		push	eax
		push	[esp+38h+arg_0]
		call	_tls1_check_cert_param
		add	esp, 14h
		test	eax, eax
		jz	short loc_38CE
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_38A4
		jmp	short loc_38DC
; ---------------------------------------------------------------------------

loc_38CE:				; CODE XREF: _tls1_check_chain+2F8j
		test	ebp, ebp
		jz	loc_3A7A
		and	ebx, 0FFFFFF7Fh

loc_38DC:				; CODE XREF: _tls1_check_chain+2DCj
					; _tls1_check_chain+308j
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [esp+28h+var_18]

loc_38E4:				; CODE XREF: _tls1_check_chain+2C3j
					; _tls1_check_chain+2C7j
		cmp	dword ptr [eax+24h], 0
		jnz	loc_3A65
		test	ecx, ecx
		jz	loc_3A65
		mov	ecx, [esp+28h+var_8]
		xor	esi, esi
		mov	eax, [ecx]
		cmp	eax, 74h ; 't'
		jg	short loc_3928
		jz	short loc_3921
		cmp	eax, 6
		jz	short loc_391A
		cmp	eax, 1Ch
		jz	short loc_3936
		or	ebx, 400h
		jmp	loc_39CF
; ---------------------------------------------------------------------------

loc_391A:				; CODE XREF: _tls1_check_chain+344j
		mov	esi, 1
		jmp	short loc_396D
; ---------------------------------------------------------------------------

loc_3921:				; CODE XREF: _tls1_check_chain+33Fj
		mov	esi, 2
		jmp	short loc_396D
; ---------------------------------------------------------------------------

loc_3928:				; CODE XREF: _tls1_check_chain+33Dj
		cmp	eax, 198h
		jz	short loc_3968
		cmp	eax, 398h
		jnz	short loc_3960

loc_3936:				; CODE XREF: _tls1_check_chain+349j
		push	ecx
		push	[esp+2Ch+var_C]
		call	_X509_certificate_type
		add	esp, 8
		mov	ecx, 3
		test	eax, 100h
		cmovnz	esi, ecx
		test	eax, 200h
		jz	short loc_395C
		lea	esi, [ecx+1]
		jmp	short loc_396D
; ---------------------------------------------------------------------------

loc_395C:				; CODE XREF: _tls1_check_chain+391j
		test	esi, esi
		jnz	short loc_396D

loc_3960:				; CODE XREF: _tls1_check_chain+370j
		or	ebx, 400h
		jmp	short loc_39CF
; ---------------------------------------------------------------------------

loc_3968:				; CODE XREF: _tls1_check_chain+369j
		mov	esi, 40h ; '@'

loc_396D:				; CODE XREF: _tls1_check_chain+35Bj
					; _tls1_check_chain+362j ...
		mov	ecx, [esp+28h+var_10]
		mov	eax, [ecx+11Ch]
		mov	[esp+28h+var_8], eax
		test	eax, eax
		jz	short loc_3987
		mov	edx, [ecx+120h]
		jmp	short loc_39A0
; ---------------------------------------------------------------------------

loc_3987:				; CODE XREF: _tls1_check_chain+3B9j
		mov	eax, [esp+28h+arg_0]
		mov	eax, [eax+58h]
		mov	edx, [eax+35Ch]
		lea	ecx, [eax+360h]
		mov	[esp+28h+var_8], ecx
		mov	eax, ecx

loc_39A0:				; CODE XREF: _tls1_check_chain+3C1j
		xor	ecx, ecx
		test	edx, edx
		jle	short loc_39BF

loc_39A6:				; CODE XREF: _tls1_check_chain+3F1j
		movzx	eax, byte ptr [eax+ecx]
		cmp	eax, esi
		jz	short loc_39B9
		mov	eax, [esp+28h+var_8]
		inc	ecx
		cmp	ecx, edx
		jl	short loc_39A6
		jmp	short loc_39BF
; ---------------------------------------------------------------------------

loc_39B9:				; CODE XREF: _tls1_check_chain+3E8j
		or	ebx, 400h

loc_39BF:				; CODE XREF: _tls1_check_chain+3E0j
					; _tls1_check_chain+3F3j
		test	ebx, 400h
		jnz	short loc_39CF
		test	ebp, ebp
		jz	loc_3A7A

loc_39CF:				; CODE XREF: _tls1_check_chain+351j
					; _tls1_check_chain+3A2j ...
		mov	eax, [esp+28h+arg_0]
		mov	eax, [eax+58h]
		mov	esi, [eax+36Ch]
		push	esi
		mov	[esp+2Ch+var_4], esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jnz	short loc_39F3
		or	ebx, 200h

loc_39F3:				; CODE XREF: _tls1_check_chain+427j
		test	ebx, 200h
		jnz	short loc_3A57
		push	[esp+28h+var_C]
		push	esi
		call	_ssl_check_ca_name
		add	esp, 8
		test	eax, eax
		jz	short loc_3A12
		or	ebx, 200h

loc_3A12:				; CODE XREF: _tls1_check_chain+446j
		test	ebx, 200h
		jnz	short loc_3A57
		push	edi
		xor	esi, esi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_3A57

loc_3A29:				; CODE XREF: _tls1_check_chain+489j
		push	esi
		push	edi
		call	_sk_value
		push	eax
		push	[esp+34h+var_4]
		call	_ssl_check_ca_name
		add	esp, 10h
		test	eax, eax
		jnz	short loc_3A51
		push	edi
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_3A29
		jmp	short loc_3A57
; ---------------------------------------------------------------------------

loc_3A51:				; CODE XREF: _tls1_check_chain+47Bj
		or	ebx, 200h

loc_3A57:				; CODE XREF: _tls1_check_chain+435j
					; _tls1_check_chain+454j ...
		test	ebp, ebp
		jnz	short loc_3A6F
		test	ebx, 200h
		jz	short loc_3A7A
		jmp	short loc_3A77
; ---------------------------------------------------------------------------

loc_3A65:				; CODE XREF: _tls1_check_chain+324j
					; _tls1_check_chain+32Cj
		or	ebx, 600h
		test	ebp, ebp
		jz	short loc_3A77

loc_3A6F:				; CODE XREF: _tls1_check_chain+495j
		mov	eax, ebp
		and	eax, ebx
		cmp	eax, ebp
		jnz	short loc_3A7A

loc_3A77:				; CODE XREF: _tls1_check_chain+49Fj
					; _tls1_check_chain+4A9j
		or	ebx, 1

loc_3A7A:				; CODE XREF: _tls1_check_chain+13Ej
					; _tls1_check_chain+1FEj ...
		mov	edx, [esp+28h+arg_10]

$end$145:				; CODE XREF: _tls1_check_chain+93j
					; _tls1_check_chain+9Fj
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [eax]
		mov	eax, ecx
		and	eax, 0FFFFFF00h
		cmp	eax, 300h
		jnz	short loc_3AAE
		cmp	ecx, 303h
		jl	short loc_3AAE
		test	dword ptr [edx+18h], 100h
		jnz	short loc_3AAE
		cmp	dword ptr [edx+8], 0
		jz	short loc_3AB4
		or	ebx, 2
		jmp	short loc_3AB4
; ---------------------------------------------------------------------------

loc_3AAE:				; CODE XREF: _tls1_check_chain+4CCj
					; _tls1_check_chain+4D4j ...
		or	ebx, 102h

loc_3AB4:				; CODE XREF: _tls1_check_chain+4E3j
					; _tls1_check_chain+4E8j
		test	ebp, ebp
		jnz	short loc_3AC0
		test	bl, 1
		jz	short loc_3ACA
		mov	[edx+18h], ebx

loc_3AC0:				; CODE XREF: _tls1_check_chain+4F2j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_3ACA:				; CODE XREF: _tls1_check_chain+4F7j
		and	dword ptr [edx+18h], 100h

loc_3AD1:				; CODE XREF: _tls1_check_chain+AEj
					; _tls1_check_chain+BEj ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
_tls1_check_chain endp

; ---------------------------------------------------------------------------
		align 4
$LN144		dd offset $LN41		; DATA XREF: _tls1_check_chain+190r
		dd offset $LN41		; jump table for switch	statement
		dd offset $LN42
		dd offset $LN41
		dd offset $LN42
		dd offset $LN43
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3AF4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_check_curve
_tls1_check_curve proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	[esp+arg_8], 3
		push	esi
		jnz	short loc_3B37
		mov	esi, [esp+4+arg_4]
		cmp	byte ptr [esi],	3
		jnz	short loc_3B37
		mov	ecx, [esp+4+arg_0]
		mov	eax, [ecx+98h]
		test	dword ptr [eax+38h], 30000h
		jz	short loc_3B4C
		cmp	byte ptr [esi+1], 0
		mov	eax, [ecx+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+8]
		jnz	short loc_3B37
		cmp	eax, 300C02Bh
		jnz	short loc_3B3B
		cmp	byte ptr [esi+2], 17h
		jz	short loc_3B4C

loc_3B37:				; CODE XREF: _tls1_check_curve+6j
					; _tls1_check_curve+Fj	...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3B3B:				; CODE XREF: _tls1_check_curve+3Bj
		cmp	eax, 300C02Ch
		jnz	short loc_3B37
		cmp	byte ptr [esi+2], 18h
		jz	short loc_3B4C
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3B4C:				; CODE XREF: _tls1_check_curve+22j
					; _tls1_check_curve+41j ...
		lea	eax, [esp+4+arg_8]
		push	eax
		lea	eax, [esp+8+arg_0]
		push	eax
		push	0
		push	ecx
		call	_tls1_get_curvelist
		add	esp, 10h
		test	eax, eax
		jz	short loc_3B37
		push	ebx
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		xor	edx, edx
		test	edi, edi
		jz	short loc_3B8C
		mov	bl, [esi+1]
		mov	ecx, [esp+0Ch+arg_0]

loc_3B78:				; CODE XREF: _tls1_check_curve+96j
		cmp	bl, [ecx]
		jnz	short loc_3B84
		mov	al, [esi+2]
		cmp	al, [ecx+1]
		jz	short loc_3B92

loc_3B84:				; CODE XREF: _tls1_check_curve+86j
		inc	edx
		add	ecx, 2
		cmp	edx, edi
		jb	short loc_3B78

loc_3B8C:				; CODE XREF: _tls1_check_curve+7Bj
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3B92:				; CODE XREF: _tls1_check_curve+8Ej
		pop	edi
		pop	ebx
		mov	eax, 1
		pop	esi
		retn
_tls1_check_curve endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3B9Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_check_ec_key proc	near		; CODE XREF: _tls12_check_peer_sigalg+AFp
					; _tls1_check_cert_param+7Fp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 4
		call	__chkstk
		mov	eax, [esp+4+arg_0]
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_8]
		test	esi, esi
		jz	short loc_3BEA
		mov	ecx, [eax+0C0h]
		mov	edx, [ecx+0D8h]
		test	edx, edx
		jz	short loc_3BEA
		mov	ecx, [ecx+0D4h]
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_3BDC
		mov	bl, [esi]

loc_3BD2:				; CODE XREF: _tls1_check_ec_key+3Ej
		cmp	bl, [edx+eax]
		jz	short loc_3BDC
		inc	eax
		cmp	eax, ecx
		jb	short loc_3BD2

loc_3BDC:				; CODE XREF: _tls1_check_ec_key+32j
					; _tls1_check_ec_key+39j
		cmp	eax, ecx
		jnz	short loc_3BE6
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3BE6:				; CODE XREF: _tls1_check_ec_key+42j
		mov	eax, [esp+0Ch+arg_0]

loc_3BEA:				; CODE XREF: _tls1_check_ec_key+16j
					; _tls1_check_ec_key+26j
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		test	ebp, ebp
		jnz	short loc_3BFB
		lea	eax, [ebp+1]
		pop	ebp
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3BFB:				; CODE XREF: _tls1_check_ec_key+55j
		push	edi
		xor	edi, edi

loc_3BFE:				; CODE XREF: _tls1_check_ec_key+BEj
		lea	ecx, [esp+14h+var_4]
		push	ecx
		lea	ecx, [esp+18h+arg_8]
		push	ecx
		push	edi
		push	eax
		call	_tls1_get_curvelist
		add	esp, 10h
		test	eax, eax
		jz	short loc_3C67
		mov	esi, [esp+14h+var_4]
		cmp	edi, 1
		jnz	short loc_3C23
		test	esi, esi
		jz	short loc_3C5C

loc_3C23:				; CODE XREF: _tls1_check_ec_key+81j
		xor	edx, edx
		test	esi, esi
		jz	short loc_3C48
		mov	bl, [ebp+0]
		mov	ecx, [esp+14h+arg_8]

loc_3C30:				; CODE XREF: _tls1_check_ec_key+A6j
		cmp	[ecx], bl
		jnz	short loc_3C3C
		mov	al, [ecx+1]
		cmp	al, [ebp+1]
		jz	short loc_3C44

loc_3C3C:				; CODE XREF: _tls1_check_ec_key+96j
		inc	edx
		add	ecx, 2
		cmp	edx, esi
		jb	short loc_3C30

loc_3C44:				; CODE XREF: _tls1_check_ec_key+9Ej
		mov	[esp+14h+arg_8], ecx

loc_3C48:				; CODE XREF: _tls1_check_ec_key+8Bj
		cmp	edx, esi
		jz	short loc_3C67
		mov	eax, [esp+14h+arg_0]
		cmp	dword ptr [eax+24h], 0
		jz	short loc_3C5C
		inc	edi
		cmp	edi, 1
		jle	short loc_3BFE

loc_3C5C:				; CODE XREF: _tls1_check_ec_key+85j
					; _tls1_check_ec_key+B8j
		pop	edi
		pop	ebp
		pop	esi
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_3C67:				; CODE XREF: _tls1_check_ec_key+78j
					; _tls1_check_ec_key+AEj
		pop	edi
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
_tls1_check_ec_key endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3C70h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_check_ec_tmp_key
_tls1_check_ec_tmp_key proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	ecx, [esi+98h]
		test	dword ptr [ecx+38h], 30000h
		mov	edi, [ecx+2Ch]
		jz	short loc_3D04
		mov	eax, [esp+8+arg_4]
		push	ebx
		cmp	eax, 300C02Bh
		jnz	short loc_3C98
		mov	bl, 17h
		jmp	short loc_3CA1
; ---------------------------------------------------------------------------

loc_3C98:				; CODE XREF: _tls1_check_ec_tmp_key+22j
		cmp	eax, 300C02Ch
		jnz	short loc_3CF5
		mov	bl, 18h

loc_3CA1:				; CODE XREF: _tls1_check_ec_tmp_key+26j
		push	0
		lea	eax, [esp+10h+arg_0]
		mov	byte ptr [esp+10h+arg_0+1], bl
		push	eax
		push	esi
		mov	byte ptr [esp+18h+arg_0], 0
		call	_tls1_check_ec_key
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_3CF5
		mov	eax, [esi+98h]
		cmp	dword ptr [eax+34h], 0
		jnz	short loc_3CFB
		cmp	dword ptr [eax+30h], 0
		jnz	short loc_3CFB
		test	edi, edi
		jz	short loc_3CF5
		push	edi
		lea	eax, [esp+10h+arg_0]
		push	0
		push	eax
		call	_tls1_set_ec_id
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_3CF5
		mov	ax, word ptr [esp+0Ch+arg_0]
		test	al, al
		jz	short loc_3CFB
		cmp	ah, bl
		jz	short loc_3CFB

loc_3CF5:				; CODE XREF: _tls1_check_ec_tmp_key+2Dj
					; _tls1_check_ec_tmp_key+4Cj ...
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3CFB:				; CODE XREF: _tls1_check_ec_tmp_key+58j
					; _tls1_check_ec_tmp_key+5Ej ...
		pop	ebx
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3D04:				; CODE XREF: _tls1_check_ec_tmp_key+16j
		cmp	dword ptr [ecx+34h], 0
		jz	short loc_3D1E
		push	0
		push	esi
		call	_tls1_shared_curve
		add	esp, 8
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3D1E:				; CODE XREF: _tls1_check_ec_tmp_key+98j
		test	edi, edi
		jnz	short loc_3D2D
		xor	eax, eax
		cmp	[ecx+30h], eax
		pop	edi
		setnz	al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3D2D:				; CODE XREF: _tls1_check_ec_tmp_key+B0j
		push	edi
		lea	eax, [esp+0Ch+arg_0]
		push	0
		push	eax
		call	_tls1_set_ec_id
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_3D44
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_3D44:				; CODE XREF: _tls1_check_ec_tmp_key+CFj
		push	0
		lea	eax, [esp+0Ch+arg_0]
		push	eax
		push	esi
		call	_tls1_check_ec_key
		add	esp, 0Ch
		pop	edi
		pop	esi
		retn
_tls1_check_ec_tmp_key endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3D58h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_check_sig_alg proc near		; CODE XREF: _tls1_check_chain+216p
					; _tls1_check_chain+254p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_8]
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_3D67
		lea	eax, [edi+2]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_3D67:				; CODE XREF: _tls1_check_sig_alg+8j
		push	esi
		push	[esp+8+arg_4]
		call	_X509_get_signature_nid
		add	esp, 4
		mov	esi, eax
		test	edi, edi
		jz	short loc_3D84
		xor	eax, eax
		cmp	esi, edi
		pop	esi
		setz	al
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_3D84:				; CODE XREF: _tls1_check_sig_alg+20j
		mov	eax, [esp+8+arg_0]
		xor	ecx, ecx
		mov	edx, [eax+140h]
		test	edx, edx
		jz	short loc_3DA9
		mov	eax, [eax+13Ch]
		add	eax, 8

loc_3D9D:				; CODE XREF: _tls1_check_sig_alg+4Fj
		cmp	esi, [eax]
		jz	short loc_3DAE
		inc	ecx
		add	eax, 10h
		cmp	ecx, edx
		jb	short loc_3D9D

loc_3DA9:				; CODE XREF: _tls1_check_sig_alg+3Aj
		pop	esi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_3DAE:				; CODE XREF: _tls1_check_sig_alg+47j
		pop	esi
		mov	eax, 1
		pop	edi
		retn
_tls1_check_sig_alg endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3DB8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_clear
_tls1_clear	proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	_ssl3_clear
		mov	eax, [esi+8]
		add	esp, 4
		mov	eax, [eax]
		mov	[esi], eax
		pop	esi
		retn
_tls1_clear	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3DD0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_default_timeout
_tls1_default_timeout proc near
		mov	eax, 1C20h
		retn
_tls1_default_timeout endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3DD8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_ec_curve_id2nid
_tls1_ec_curve_id2nid proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 1
		jl	short loc_3DEE
		cmp	eax, 1Ch
		ja	short loc_3DEE
		mov	eax, ds:(_nid_list-4)[eax*4]
		retn
; ---------------------------------------------------------------------------

loc_3DEE:				; CODE XREF: _tls1_ec_curve_id2nid+7j
					; _tls1_ec_curve_id2nid+Cj
		xor	eax, eax
		retn
_tls1_ec_curve_id2nid endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3DF4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_ec_nid2curve_id
_tls1_ec_nid2curve_id proc near		; CODE XREF: _tls1_set_ec_id+47p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 2C4h
		jg	short loc_3E23
		jz	short loc_3E1D
		sub	eax, 199h
		jz	short loc_3E17
		sub	eax, 6
		jnz	$LN32		; jumptable 00003E3A default case
		mov	eax, 17h
		retn
; ---------------------------------------------------------------------------

loc_3E17:				; CODE XREF: _tls1_ec_nid2curve_id+12j
		mov	eax, 13h
		retn
; ---------------------------------------------------------------------------

loc_3E1D:				; CODE XREF: _tls1_ec_nid2curve_id+Bj
		mov	eax, 0Fh
		retn
; ---------------------------------------------------------------------------

loc_3E23:				; CODE XREF: _tls1_ec_nid2curve_id+9j
		add	eax, 0FFFFFD3Bh	; switch 225 cases
		cmp	eax, 0E0h ; ''
		ja	$LN32		; jumptable 00003E3A default case
		movzx	eax, ds:$LN35[eax]
		jmp	ds:$LN37[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 1		; jumptable 00003E3A case 721
		retn
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 2		; jumptable 00003E3A case 722
		retn
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 3		; jumptable 00003E3A case 723
		retn
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 4		; jumptable 00003E3A case 724
		retn
; ---------------------------------------------------------------------------

$LN8:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 5		; jumptable 00003E3A case 725
		retn
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 6		; jumptable 00003E3A case 726
		retn
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 7		; jumptable 00003E3A case 727
		retn
; ---------------------------------------------------------------------------

$LN11:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 8		; jumptable 00003E3A case 728
		retn
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 9		; jumptable 00003E3A case 729
		retn
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 0Ah	; jumptable 00003E3A case 730
		retn
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 0Bh	; jumptable 00003E3A case 731
		retn
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 0Ch	; jumptable 00003E3A case 732
		retn
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 0Dh	; jumptable 00003E3A case 733
		retn
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 0Eh	; jumptable 00003E3A case 734
		retn
; ---------------------------------------------------------------------------

$LN19:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 10h	; jumptable 00003E3A case 709
		retn
; ---------------------------------------------------------------------------

$LN20:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 11h	; jumptable 00003E3A case 710
		retn
; ---------------------------------------------------------------------------

$LN21:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 12h	; jumptable 00003E3A case 711
		retn
; ---------------------------------------------------------------------------

$LN23:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 14h	; jumptable 00003E3A case 712
		retn
; ---------------------------------------------------------------------------

$LN24:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 15h	; jumptable 00003E3A case 713
		retn
; ---------------------------------------------------------------------------

$LN25:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 16h	; jumptable 00003E3A case 714
		retn
; ---------------------------------------------------------------------------

$LN27:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 18h	; jumptable 00003E3A case 715
		retn
; ---------------------------------------------------------------------------

$LN28:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 19h	; jumptable 00003E3A case 716
		retn
; ---------------------------------------------------------------------------

$LN29:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 1Ah	; jumptable 00003E3A case 927
		retn
; ---------------------------------------------------------------------------

$LN30:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 1Bh	; jumptable 00003E3A case 931
		retn
; ---------------------------------------------------------------------------

$LN31:					; CODE XREF: _tls1_ec_nid2curve_id+46j
					; DATA XREF: .text$mn:$LN37o
		mov	eax, 1Ch	; jumptable 00003E3A case 933
		retn
; ---------------------------------------------------------------------------

$LN32:					; CODE XREF: _tls1_ec_nid2curve_id+17j
					; _tls1_ec_nid2curve_id+39j ...
		xor	eax, eax	; jumptable 00003E3A default case
		retn
_tls1_ec_nid2curve_id endp

; ---------------------------------------------------------------------------
		align 4
$LN37		dd offset $LN19, offset	$LN20, offset $LN21, offset $LN23
					; DATA XREF: _tls1_ec_nid2curve_id+46r
		dd offset $LN24, offset	$LN25, offset $LN27, offset $LN28 ; jump table for switch statement
		dd offset $LN4,	offset $LN5, offset $LN6, offset $LN7
		dd offset $LN8,	offset $LN9, offset $LN10, offset $LN11
		dd offset $LN12, offset	$LN13, offset $LN14, offset $LN15
		dd offset $LN16, offset	$LN17, offset $LN29, offset $LN30
		dd offset $LN31, offset	$LN32
$LN35		db 0, 1, 2, 3, 4, 5, 6,	7, 19h,	19h, 19h, 19h, 8, 9, 0Ah
					; DATA XREF: _tls1_ec_nid2curve_id+3Fr
		db 0Bh,	0Ch, 0Dh, 0Eh, 0Fh, 10h, 11h, 12h, 13h,	14h, 15h ; indirect table for switch statement
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 16h, 19h, 19h, 19h,	17h, 19h
		db 18h
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4028h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_free
_tls1_free	proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+15Ch]
		test	eax, eax
		jz	short loc_4040
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4040:				; CODE XREF: _tls1_free+Dj
		push	esi
		call	_ssl3_free
		add	esp, 4
		pop	esi
		retn
_tls1_free	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 404Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_get_curvelist proc near		; CODE XREF: _ssl_add_clienthello_tlsext+38Ep
					; _tls1_check_curve+65p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	[esp+arg_4], 0
		mov	edx, [esp+arg_0]
		push	esi
		jz	short loc_407B
		mov	eax, [edx+0C0h]
		mov	ecx, [eax+0E0h]
		mov	eax, [esp+4+arg_8]
		mov	[eax], ecx
		mov	eax, [edx+0C0h]
		mov	ecx, [eax+0DCh]
		jmp	loc_4106
; ---------------------------------------------------------------------------

loc_407B:				; CODE XREF: _tls1_get_curvelist+Aj
		mov	eax, [edx+98h]
		mov	eax, [eax+38h]
		and	eax, 30000h
		cmp	eax, 10000h
		jz	short loc_40F7
		cmp	eax, 20000h
		jz	short loc_40E6
		cmp	eax, 30000h
		jz	short loc_40DF
		mov	esi, [esp+4+arg_8]
		mov	eax, [edx+150h]
		mov	[esi], eax
		mov	ecx, [edx+14Ch]
		test	eax, eax
		jnz	short loc_4106
		cmp	[edx+24h], eax
		jz	short loc_40D2
		mov	eax, [edx+98h]
		cmp	dword ptr [eax+34h], 0
		jnz	short loc_40D2
		mov	dword ptr [esi], offset	_eccurves_all
		mov	ecx, 38h ; '8'
		jmp	short loc_4106
; ---------------------------------------------------------------------------

loc_40D2:				; CODE XREF: _tls1_get_curvelist+6Bj
					; _tls1_get_curvelist+77j
		mov	dword ptr [esi], offset	_eccurves_auto
		mov	ecx, 1Ah
		jmp	short loc_4106
; ---------------------------------------------------------------------------

loc_40DF:				; CODE XREF: _tls1_get_curvelist+50j
		mov	ecx, 4
		jmp	short loc_40FC
; ---------------------------------------------------------------------------

loc_40E6:				; CODE XREF: _tls1_get_curvelist+49j
		mov	eax, [esp+4+arg_8]
		mov	ecx, 2
		mov	dword ptr [eax], offset	word_AA
		jmp	short loc_4106
; ---------------------------------------------------------------------------

loc_40F7:				; CODE XREF: _tls1_get_curvelist+42j
		mov	ecx, 2

loc_40FC:				; CODE XREF: _tls1_get_curvelist+98j
		mov	eax, [esp+4+arg_8]
		mov	dword ptr [eax], offset	_suiteb_curves

loc_4106:				; CODE XREF: _tls1_get_curvelist+2Aj
					; _tls1_get_curvelist+66j ...
		pop	esi
		test	cl, 1
		jz	short loc_4134
		push	200h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	44h ; 'D'
		push	152h
		push	14h
		call	_ERR_put_error
		mov	eax, [esp+14h+arg_C]
		add	esp, 14h
		mov	dword ptr [eax], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_4134:				; CODE XREF: _tls1_get_curvelist+BEj
		mov	eax, [esp+arg_C]
		shr	ecx, 1
		mov	[eax], ecx
		mov	eax, 1
		retn
_tls1_get_curvelist endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4144h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_get_formatlist proc near		; CODE XREF: _ssl_add_serverhello_tlsext+18Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	edx, [ecx+148h]
		test	edx, edx
		jz	short loc_4165
		mov	[eax], edx
		mov	eax, [esp+arg_8]
		mov	ecx, [ecx+144h]
		mov	[eax], ecx
		retn
; ---------------------------------------------------------------------------

loc_4165:				; CODE XREF: _tls1_get_formatlist+10j
		mov	dword ptr [eax], offset	_ecformats_default
		mov	eax, [ecx+98h]
		mov	ecx, [eax+38h]
		mov	eax, [esp+arg_8]
		and	ecx, 30000h
		neg	ecx
		sbb	ecx, ecx
		add	ecx, 3
		mov	[eax], ecx
		retn
_tls1_get_formatlist endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4188h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_heartbeat
_tls1_heartbeat	proc near

arg_0		= dword	ptr  4

		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		or	ebp, 0FFFFFFFFh
		mov	eax, [esi+184h]
		and	al, 3
		cmp	al, 1
		jnz	loc_42BE
		cmp	dword ptr [esi+188h], 0
		jz	short loc_41BE
		push	0F74h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	16Eh
		jmp	loc_42CD
; ---------------------------------------------------------------------------

loc_41BE:				; CODE XREF: _tls1_heartbeat+20j
		push	esi
		call	_SSL_state
		add	esp, 4
		test	eax, 3000h
		jnz	loc_42AD
		cmp	dword ptr [esi+1Ch], 0
		jnz	loc_42AD
		push	ebx
		push	edi
		push	0F8Eh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	25h ; '%'
		call	_CRYPTO_malloc
		mov	ebx, eax
		lea	edi, [ebx+1]
		push	10h
		mov	byte ptr [ebx],	1
		mov	word ptr [edi],	1200h
		movzx	eax, byte ptr [esi+18Dh]
		mov	[edi+2], al
		movzx	eax, byte ptr [esi+18Ch]
		mov	[edi+3], al
		add	edi, 4
		push	edi
		call	_RAND_pseudo_bytes
		add	esp, 14h
		test	eax, eax
		jns	short loc_424D
		push	0F98h

loc_4227:				; CODE XREF: _tls1_heartbeat+DCj
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	44h ; 'D'
		push	13Bh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		push	ebx
		call	_CRYPTO_free
		add	esp, 4
		mov	eax, ebp
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_424D:				; CODE XREF: _tls1_heartbeat+98j
		lea	eax, [edi+10h]
		push	10h
		push	eax
		call	_RAND_pseudo_bytes
		add	esp, 8
		test	eax, eax
		jns	short loc_4266
		push	0F9Eh
		jmp	short loc_4227
; ---------------------------------------------------------------------------

loc_4266:				; CODE XREF: _tls1_heartbeat+D5j
		push	25h ; '%'
		push	ebx
		push	18h
		push	esi
		call	_ssl3_write_bytes
		mov	ebp, eax
		add	esp, 10h
		test	ebp, ebp
		js	short $err$17
		mov	eax, [esi+64h]
		test	eax, eax
		jz	short loc_4293
		push	dword ptr [esi+68h]
		push	esi
		push	25h ; '%'
		push	ebx
		push	18h
		push	dword ptr [esi]
		push	1
		call	eax
		add	esp, 1Ch

loc_4293:				; CODE XREF: _tls1_heartbeat+F7j
		mov	dword ptr [esi+188h], 1

$err$17:				; CODE XREF: _tls1_heartbeat+F0j
		push	ebx
		call	_CRYPTO_free
		add	esp, 4
		mov	eax, ebp
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_42AD:				; CODE XREF: _tls1_heartbeat+44j
					; _tls1_heartbeat+4Ej
		push	0F7Ah
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	0F4h ; ''
		jmp	short loc_42CD
; ---------------------------------------------------------------------------

loc_42BE:				; CODE XREF: _tls1_heartbeat+13j
		push	0F6Eh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	16Dh

loc_42CD:				; CODE XREF: _tls1_heartbeat+31j
					; _tls1_heartbeat+134j
		push	13Bh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ebp
		retn
_tls1_heartbeat	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 42E4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_lookup_sigalg proc near		; CODE XREF: _SSL_get_sigalgs+53p
					; _tls12_do_shared_sigalgs+F0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_0]
		xor	edx, edx
		push	ebp
		mov	ebp, [esp+8+arg_C]
		push	esi
		mov	esi, [esp+0Ch+arg_8]
		push	edi
		mov	edi, [esp+10h+arg_4]
		test	ebx, ebx
		jnz	short loc_430C
		test	edi, edi
		jnz	short loc_4308
		test	esi, esi
		jz	short loc_4385
		jmp	short loc_430C
; ---------------------------------------------------------------------------

loc_4308:				; CODE XREF: _tls1_lookup_sigalg+1Cj
		test	esi, esi
		jz	short loc_4334

loc_430C:				; CODE XREF: _tls1_lookup_sigalg+18j
					; _tls1_lookup_sigalg+22j
		movzx	eax, byte ptr [ebp+0]
		xor	ecx, ecx
		xchg	ax, ax

loc_4314:				; CODE XREF: _tls1_lookup_sigalg+3Dj
		cmp	ds:dword_164[ecx*8], eax
		jz	short loc_4327
		inc	ecx
		cmp	ecx, 6
		jb	short loc_4314
		xor	edx, edx
		jmp	short loc_432E
; ---------------------------------------------------------------------------

loc_4327:				; CODE XREF: _tls1_lookup_sigalg+37j
		mov	edx, ds:_tls12_md[ecx*8]

loc_432E:				; CODE XREF: _tls1_lookup_sigalg+41j
		test	ebx, ebx
		jz	short loc_4334
		mov	[ebx], edx

loc_4334:				; CODE XREF: _tls1_lookup_sigalg+26j
					; _tls1_lookup_sigalg+4Cj
		test	edi, edi
		jnz	short loc_433C
		test	esi, esi
		jz	short loc_4385

loc_433C:				; CODE XREF: _tls1_lookup_sigalg+52j
		movzx	eax, byte ptr [ebp+1]
		xor	ecx, ecx
		xchg	ax, ax

loc_4344:				; CODE XREF: _tls1_lookup_sigalg+6Dj
		cmp	ds:dword_194[ecx*8], eax
		jz	short loc_4357
		inc	ecx
		cmp	ecx, 3
		jb	short loc_4344
		xor	eax, eax
		jmp	short loc_435E
; ---------------------------------------------------------------------------

loc_4357:				; CODE XREF: _tls1_lookup_sigalg+67j
		mov	eax, ds:_tls12_sig[ecx*8]

loc_435E:				; CODE XREF: _tls1_lookup_sigalg+71j
		test	edi, edi
		jz	short loc_4364
		mov	[edi], eax

loc_4364:				; CODE XREF: _tls1_lookup_sigalg+7Cj
		test	esi, esi
		jz	short loc_4385
		test	eax, eax
		jz	short loc_437F
		test	edx, edx
		jz	short loc_437F
		push	eax
		push	edx
		push	esi
		call	_OBJ_find_sigid_by_algs
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_4385

loc_437F:				; CODE XREF: _tls1_lookup_sigalg+86j
					; _tls1_lookup_sigalg+8Aj
		mov	dword ptr [esi], 0

loc_4385:				; CODE XREF: _tls1_lookup_sigalg+20j
					; _tls1_lookup_sigalg+56j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
_tls1_lookup_sigalg endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 438Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_new
_tls1_new	proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	_ssl3_new
		add	esp, 4
		test	eax, eax
		jnz	short loc_43A0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_43A0:				; CODE XREF: _tls1_new+10j
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+8]
		call	eax
		add	esp, 4
		mov	eax, 1
		pop	esi
		retn
_tls1_new	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 43B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_process_heartbeat(size_t Size)
		public _tls1_process_heartbeat
_tls1_process_heartbeat	proc near

Src		= dword	ptr -4
Size		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+10h+Size]
		mov	eax, [edi+58h]
		mov	ecx, [edi+64h]
		mov	esi, [eax+118h]
		test	ecx, ecx
		jz	short loc_43EB
		push	dword ptr [edi+68h]
		push	edi
		push	dword ptr [eax+110h]
		push	esi
		push	18h
		push	dword ptr [edi]
		push	0
		call	ecx
		add	esp, 1Ch

loc_43EB:				; CODE XREF: _tls1_process_heartbeat+1Fj
		mov	eax, [edi+58h]
		mov	ebx, [eax+110h]
		cmp	ebx, 13h
		jnb	short loc_4400

loc_43F9:				; CODE XREF: _tls1_process_heartbeat+65j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_4400:				; CODE XREF: _tls1_process_heartbeat+43j
		movzx	ecx, byte ptr [esi+1]
		movzx	eax, byte ptr [esi+2]
		movzx	edx, byte ptr [esi]
		shl	ecx, 8
		or	ecx, eax
		mov	[esp+10h+Size],	ecx
		lea	eax, [ecx+13h]
		cmp	eax, ebx
		ja	short loc_43F9
		lea	eax, [esi+3]
		mov	[esp+10h+Src], eax
		push	ebp
		cmp	edx, 1
		jnz	loc_44D1
		push	0F36h
		lea	ebp, [ecx+13h]
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebp
		call	_CRYPTO_malloc
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_4488
		mov	ecx, [esp+14h+Size]
		lea	esi, [ebx+1]
		mov	eax, ecx
		mov	byte ptr [ebx],	2
		push	ecx		; Size
		push	[esp+18h+Src]	; Src
		shr	eax, 8
		mov	[esi], al
		mov	[esi+1], cl
		add	esi, 2
		push	esi		; Dst
		call	_memcpy
		mov	eax, [esp+20h+Size]
		add	eax, esi
		push	10h
		push	eax
		call	_RAND_pseudo_bytes
		add	esp, 14h
		test	eax, eax
		jns	short loc_4491
		push	ebx
		call	_CRYPTO_free
		add	esp, 4

loc_4488:				; CODE XREF: _tls1_process_heartbeat+92j
		pop	ebp
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_4491:				; CODE XREF: _tls1_process_heartbeat+C9j
		push	ebp
		push	ebx
		push	18h
		push	edi
		call	_ssl3_write_bytes
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		js	short loc_44BC
		mov	eax, [edi+64h]
		test	eax, eax
		jz	short loc_44BC
		push	dword ptr [edi+68h]
		push	edi
		push	ebp
		push	ebx
		push	18h
		push	dword ptr [edi]
		push	1
		call	eax
		add	esp, 1Ch

loc_44BC:				; CODE XREF: _tls1_process_heartbeat+EEj
					; _tls1_process_heartbeat+F5j
		push	ebx
		call	_CRYPTO_free
		add	esp, 4
		test	esi, esi
		jns	short loc_4504
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_44D1:				; CODE XREF: _tls1_process_heartbeat+72j
		cmp	edx, 2
		jnz	short loc_4504
		cmp	ecx, 12h
		jnz	short loc_4504
		movzx	ecx, byte ptr [eax]
		movzx	eax, byte ptr [eax+1]
		mov	edx, [edi+18Ch]
		shl	ecx, 8
		or	ecx, eax
		cmp	ecx, edx
		jnz	short loc_4504
		lea	eax, [edx+1]
		mov	dword ptr [edi+188h], 0
		mov	[edi+18Ch], eax

loc_4504:				; CODE XREF: _tls1_process_heartbeat+113j
					; _tls1_process_heartbeat+120j	...
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
_tls1_process_heartbeat	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 450Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_process_sigalgs
_tls1_process_sigalgs proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		mov	eax, [esp+4+arg_0]
		push	esi
		push	eax
		mov	esi, [eax+98h]
		call	_tls1_set_shared_sigalgs
		add	esp, 4
		test	eax, eax
		jnz	short loc_4531
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_4531:				; CODE XREF: _tls1_process_sigalgs+20j
		push	ebx
		mov	ebx, [esi+13Ch]
		push	ebp
		xor	ebp, ebp
		cmp	[esi+140h], ebp
		jbe	loc_460E
		add	ebx, 0Dh
		push	edi
		nop

loc_454C:				; CODE XREF: _tls1_process_sigalgs+FBj
		movzx	eax, byte ptr [ebx-1]
		sub	eax, 1
		jz	short loc_456F
		sub	eax, 1
		jz	short loc_4568
		sub	eax, 1
		jnz	loc_45FD
		lea	edi, [eax+5]
		jmp	short loc_4574
; ---------------------------------------------------------------------------

loc_4568:				; CODE XREF: _tls1_process_sigalgs+4Cj
		mov	edi, 2
		jmp	short loc_4574
; ---------------------------------------------------------------------------

loc_456F:				; CODE XREF: _tls1_process_sigalgs+47j
		mov	edi, 1

loc_4574:				; CODE XREF: _tls1_process_sigalgs+5Aj
					; _tls1_process_sigalgs+61j
		lea	eax, ds:0[edi*8]
		sub	eax, edi
		add	eax, 11h
		cmp	dword ptr [esi+eax*4], 0
		lea	eax, [esi+eax*4]
		mov	[esp+14h+var_4], eax
		jnz	short loc_45FD
		movzx	eax, byte ptr [ebx]
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	short loc_45D3	; jumptable 00004596 default case
		jmp	ds:$LN37_2[eax*4] ; switch jump
; ---------------------------------------------------------------------------

$LN23_1:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_md5	; jumptable 00004596 case 0
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

$LN24_1:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_sha1	; jumptable 00004596 case 1
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

$LN25_1:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_sha224	; jumptable 00004596 case 2
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

$LN26_0:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_sha256	; jumptable 00004596 case 3
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

$LN27_0:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_sha384	; jumptable 00004596 case 4
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

$LN28_1:				; CODE XREF: _tls1_process_sigalgs+8Aj
					; DATA XREF: .text$mn:$LN37_2o
		call	_EVP_sha512	; jumptable 00004596 case 5
		mov	edx, eax
		jmp	short loc_45D5
; ---------------------------------------------------------------------------

loc_45D3:				; CODE XREF: _tls1_process_sigalgs+88j
		xor	edx, edx	; jumptable 00004596 default case

loc_45D5:				; CODE XREF: _tls1_process_sigalgs+98j
					; _tls1_process_sigalgs+A1j ...
		mov	eax, [esp+14h+var_4]
		lea	ecx, [edi+3]
		mov	[eax], edx
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		mov	dword ptr [esi+eax*4], 100h
		cmp	edi, 1
		jnz	short loc_45FD
		mov	dword ptr [esi+54h], 100h
		mov	[esi+44h], edx

loc_45FD:				; CODE XREF: _tls1_process_sigalgs+51j
					; _tls1_process_sigalgs+7Fj ...
		inc	ebp
		add	ebx, 10h
		cmp	ebp, [esi+140h]
		jb	loc_454C
		pop	edi

loc_460E:				; CODE XREF: _tls1_process_sigalgs+35j
		mov	eax, [esp+10h+arg_0]
		pop	ebp
		pop	ebx
		mov	eax, [eax+98h]
		test	dword ptr [eax+38h], 30001h
		jnz	short loc_465B
		cmp	dword ptr [esi+7Ch], 0
		jnz	short loc_4631
		call	_EVP_sha1
		mov	[esi+7Ch], eax

loc_4631:				; CODE XREF: _tls1_process_sigalgs+11Bj
		cmp	dword ptr [esi+60h], 0
		jnz	short loc_4647
		call	_EVP_sha1
		mov	[esi+60h], eax
		call	_EVP_sha1
		mov	[esi+44h], eax

loc_4647:				; CODE XREF: _tls1_process_sigalgs+129j
		cmp	dword ptr [esi+0D0h], 0
		jnz	short loc_465B
		call	_EVP_sha1
		mov	[esi+0D0h], eax

loc_465B:				; CODE XREF: _tls1_process_sigalgs+115j
					; _tls1_process_sigalgs+142j
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
_tls1_process_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
$LN37_2		dd offset $LN23_1	; DATA XREF: _tls1_process_sigalgs+8Ar
		dd offset $LN24_1	; jump table for switch	statement
		dd offset $LN25_1
		dd offset $LN26_0
		dd offset $LN27_0
		dd offset $LN28_1
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 467Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_process_ticket(int, int, size_t Size, int, int)
		public _tls1_process_ticket
_tls1_process_ticket proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		push	ebx
		mov	ebx, [esp+4+Size]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		add	ebx, ebp
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	0
		push	0
		push	20h ; ' '
		mov	dword ptr [eax], 0
		push	edi
		mov	dword ptr [edi+140h], 0
		call	_SSL_ctrl
		add	esp, 10h
		test	eax, 4000h
		jz	short loc_46BD
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_46BD:				; CODE XREF: _tls1_process_ticket+39j
		cmp	dword ptr [edi], 300h
		push	esi
		jle	loc_476C
		mov	esi, [esp+10h+arg_C]
		test	esi, esi
		jz	loc_476C
		cmp	ebx, esi
		jnb	loc_47B8
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_46F8
		movzx	eax, byte ptr [ebx]
		inc	ebx
		add	ebx, eax
		cmp	ebx, esi
		jnb	loc_47B8

loc_46F8:				; CODE XREF: _tls1_process_ticket+6Cj
		movzx	eax, byte ptr [ebx]
		shl	ax, 8
		movzx	ecx, ax
		movzx	eax, byte ptr [ebx+1]
		or	ecx, eax
		add	ecx, 2
		add	ecx, ebx
		cmp	ecx, esi
		jnb	loc_47B8
		movzx	edx, byte ptr [ecx]
		inc	edx
		add	edx, ecx
		cmp	edx, esi
		ja	loc_47B8
		add	edx, 2
		cmp	edx, esi
		jnb	short loc_476C
		lea	eax, [edx+4]
		cmp	eax, esi
		ja	short loc_476C

loc_4731:				; CODE XREF: _tls1_process_ticket+EEj
		movzx	ecx, byte ptr [edx]
		movzx	eax, byte ptr [edx+1]
		shl	cx, 8
		or	cx, ax
		movzx	eax, byte ptr [edx+3]
		movzx	ebx, cx
		movzx	ecx, byte ptr [edx+2]
		add	edx, 4
		shl	cx, 8
		or	cx, ax
		movzx	ecx, cx
		lea	eax, [edx+ecx]
		cmp	eax, esi
		ja	short loc_476C
		cmp	ebx, 23h ; '#'
		jz	short loc_4773
		mov	edx, eax
		lea	eax, [edx+4]
		cmp	eax, esi
		jbe	short loc_4731

loc_476C:				; CODE XREF: _tls1_process_ticket+48j
					; _tls1_process_ticket+54j ...
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4773:				; CODE XREF: _tls1_process_ticket+E5j
		test	cx, cx
		jnz	short loc_478C
		pop	esi
		mov	dword ptr [edi+140h], 1
		mov	eax, 1
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_478C:				; CODE XREF: _tls1_process_ticket+FAj
		cmp	dword ptr [edi+168h], 0
		jnz	short loc_47DE
		push	[esp+10h+arg_10] ; int
		push	[esp+14h+Size]	; Size
		push	ebp		; int
		push	ecx		; int
		push	edx		; int
		push	edi		; int
		call	_tls_decrypt_ticket
		add	esp, 18h
		sub	eax, 2
		jz	short loc_47D4
		sub	eax, 1
		jz	short loc_47CA
		sub	eax, 1
		jz	short loc_47C0

loc_47B8:				; CODE XREF: _tls1_process_ticket+5Cj
					; _tls1_process_ticket+76j ...
		pop	esi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_47C0:				; CODE XREF: _tls1_process_ticket+13Aj
		mov	dword ptr [edi+140h], 1

loc_47CA:				; CODE XREF: _tls1_process_ticket+135j
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, 3
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_47D4:				; CODE XREF: _tls1_process_ticket+130j
		mov	dword ptr [edi+140h], 1

loc_47DE:				; CODE XREF: _tls1_process_ticket+117j
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
_tls1_process_ticket endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 47E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls1_save_sigalgs(int, void *Src,	size_t Size)
		public _tls1_save_sigalgs
_tls1_save_sigalgs proc	near		; CODE XREF: _ssl_scan_clienthello_tlsext+5BBp

arg_0		= dword	ptr  4
Src		= dword	ptr  8
Size		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [eax+98h]
		mov	eax, [eax+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	short loc_4806
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4806:				; CODE XREF: _tls1_save_sigalgs+15j
		test	esi, esi
		jnz	short loc_480E
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_480E:				; CODE XREF: _tls1_save_sigalgs+20j
		mov	eax, [esi+124h]
		test	eax, eax
		jz	short loc_4821
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4821:				; CODE XREF: _tls1_save_sigalgs+2Ej
		push	edi
		mov	edi, [esp+8+Size]
		push	0E99h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	edi
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+124h], eax
		test	eax, eax
		jnz	short loc_4846
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4846:				; CODE XREF: _tls1_save_sigalgs+59j
		push	edi		; Size
		push	[esp+0Ch+Src]	; Src
		mov	[esi+128h], edi
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch
		mov	eax, 1
		pop	edi
		pop	esi
		retn
_tls1_save_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4864h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_cert_validity
_tls1_set_cert_validity	proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	0
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		push	1
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		push	2
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		push	3
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		add	esp, 50h
		push	4
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		push	5
		push	0
		push	0
		push	0
		push	esi
		call	_tls1_check_chain
		add	esp, 28h
		pop	esi
		retn
_tls1_set_cert_validity	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 48C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_curves
_tls1_set_curves proc near		; CODE XREF: _tls1_set_curves_list+82p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_C]
		push	ebp
		push	edi
		push	283h
		lea	eax, [ebx+ebx]
		xor	edi, edi
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		mov	[esp+18h+arg_C], eax
		call	_CRYPTO_malloc
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_48F5
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_48F5:				; CODE XREF: _tls1_set_curves+27j
		xor	edx, edx
		push	esi
		mov	esi, ebp
		test	ebx, ebx
		jz	loc_4AD3
		nop	word ptr [eax+eax+00h]

loc_4908:				; CODE XREF: _tls1_set_curves+205j
		mov	eax, [esp+10h+arg_8]
		mov	eax, [eax+edx*4]
		cmp	eax, 2C4h
		jg	short loc_4953
		jz	short loc_4944
		sub	eax, 199h
		jz	short loc_4935
		sub	eax, 6
		jnz	$LN52		; jumptable 0000496A default case
		lea	ecx, [eax+17h]
		mov	eax, 800000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

loc_4935:				; CODE XREF: _tls1_set_curves+55j
		mov	ecx, 13h
		mov	eax, 80000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

loc_4944:				; CODE XREF: _tls1_set_curves+4Ej
		mov	ecx, 0Fh
		mov	eax, 8000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

loc_4953:				; CODE XREF: _tls1_set_curves+4Cj
		sub	eax, 2C5h	; switch 225 cases
		cmp	eax, 0E0h ; ''
		ja	$LN52		; jumptable 0000496A default case
		movzx	eax, ds:$LN51[eax]
		jmp	ds:$LN55[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN13_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 1		; jumptable 0000496A case 721
		lea	eax, [ecx+1]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN14_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 2		; jumptable 0000496A case 722
		lea	eax, [ecx+2]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN15_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 3		; jumptable 0000496A case 723
		lea	eax, [ecx+5]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN16_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 4		; jumptable 0000496A case 724
		lea	eax, [ecx+0Ch]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN17_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 5		; jumptable 0000496A case 725
		lea	eax, [ecx+1Bh]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN18:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 6		; jumptable 0000496A case 726
		lea	eax, [ecx+3Ah]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN19_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 7		; jumptable 0000496A case 727
		lea	eax, [ecx+79h]
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN20_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 8		; jumptable 0000496A case 728
		mov	eax, 100h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN21_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 9		; jumptable 0000496A case 729
		mov	eax, 200h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN22:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 0Ah	; jumptable 0000496A case 730
		mov	eax, 400h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN23_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 0Bh	; jumptable 0000496A case 731
		mov	eax, 800h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN24_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 0Ch	; jumptable 0000496A case 732
		mov	eax, 1000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN25_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 0Dh	; jumptable 0000496A case 733
		mov	eax, 2000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN26:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 0Eh	; jumptable 0000496A case 734
		mov	eax, 4000h
		jmp	loc_4AB7
; ---------------------------------------------------------------------------

$LN28_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 10h	; jumptable 0000496A case 709
		mov	eax, 10000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN29_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 11h	; jumptable 0000496A case 710
		mov	eax, 20000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN30_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 12h	; jumptable 0000496A case 711
		mov	eax, 40000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN32_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 14h	; jumptable 0000496A case 712
		mov	eax, 100000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN33:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 15h	; jumptable 0000496A case 713
		mov	eax, 200000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN34:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 16h	; jumptable 0000496A case 714
		mov	eax, 400000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN36:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 18h	; jumptable 0000496A case 715
		mov	eax, 1000000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN37_0:				; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 19h	; jumptable 0000496A case 716
		mov	eax, 2000000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN38:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 1Ah	; jumptable 0000496A case 927
		mov	eax, 4000000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN39:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 1Bh	; jumptable 0000496A case 931
		mov	eax, 8000000h
		jmp	short loc_4AB7
; ---------------------------------------------------------------------------

$LN40:					; CODE XREF: _tls1_set_curves+A2j
					; DATA XREF: .text$mn:$LN55o
		mov	ecx, 1Ch	; jumptable 0000496A case 933
		mov	eax, 10000000h

loc_4AB7:				; CODE XREF: _tls1_set_curves+68j
					; _tls1_set_curves+77j	...
		test	edi, eax
		jnz	short $LN52	; jumptable 0000496A default case
		or	edi, eax
		mov	[esi+1], cl
		mov	eax, ecx
		inc	edx
		sar	eax, 8
		mov	[esi], al
		add	esi, 2
		cmp	edx, ebx
		jb	loc_4908

loc_4AD3:				; CODE XREF: _tls1_set_curves+34j
		mov	esi, [esp+10h+arg_0]
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_4AE6
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_4AE6:				; CODE XREF: _tls1_set_curves+213j
		mov	eax, [esp+10h+arg_4]
		mov	ecx, [esp+10h+arg_C]
		mov	[esi], ebp
		pop	esi
		pop	edi
		pop	ebp
		mov	[eax], ecx
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$LN52:					; CODE XREF: _tls1_set_curves+5Aj
					; _tls1_set_curves+95j	...
		push	ebp		; jumptable 0000496A default case
		call	_CRYPTO_free
		add	esp, 4
		xor	eax, eax
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		retn
_tls1_set_curves endp

; ---------------------------------------------------------------------------
$LN55		dd offset $LN28_0, offset $LN29_0, offset $LN30_0, offset $LN32_0
					; DATA XREF: _tls1_set_curves+A2r
		dd offset $LN33, offset	$LN34, offset $LN36, offset $LN37_0 ; jump table for switch statement
		dd offset $LN13_0, offset $LN14_0, offset $LN15_0, offset $LN16_0
		dd offset $LN17_0, offset $LN18, offset	$LN19_0, offset	$LN20_0
		dd offset $LN21_0, offset $LN22, offset	$LN23_0, offset	$LN24_0
		dd offset $LN25_0, offset $LN26, offset	$LN38, offset $LN39
		dd offset $LN40, offset	$LN52
$LN51		db 0, 1, 2, 3, 4, 5, 6,	7, 19h,	19h, 19h, 19h, 8, 9, 0Ah
					; DATA XREF: _tls1_set_curves+9Br
		db 0Bh,	0Ch, 0Dh, 0Eh, 0Fh, 10h, 11h, 12h, 13h,	14h, 15h ; indirect table for switch statement
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 19h, 19h, 19h, 19h,	19h, 19h
		db 19h,	19h, 19h, 19h, 19h, 16h, 19h, 19h, 19h,	17h, 19h
		db 18h
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4C58h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_curves_list
_tls1_set_curves_list proc near

var_78		= dword	ptr -78h
var_74		= byte ptr -74h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 78h ; 'x'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		mov	eax, [esp+78h+arg_8]
		lea	ecx, [esp+78h+var_78]
		push	esi
		mov	esi, [esp+7Ch+arg_0]
		push	edi
		mov	edi, [esp+80h+arg_4]
		push	ecx
		push	offset _nid_cb
		push	1
		push	3Ah ; ':'
		push	eax
		mov	[esp+94h+var_78], 0
		call	_CONF_parse_list
		add	esp, 14h
		test	eax, eax
		jnz	short loc_4CB7
		pop	edi
		pop	esi
		mov	ecx, [esp+78h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
; ---------------------------------------------------------------------------

loc_4CB7:				; CODE XREF: _tls1_set_curves_list+4Cj
		test	esi, esi
		jnz	short loc_4CCF
		pop	edi
		lea	eax, [esi+1]
		pop	esi
		mov	ecx, [esp+78h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
; ---------------------------------------------------------------------------

loc_4CCF:				; CODE XREF: _tls1_set_curves_list+61j
		push	[esp+80h+var_78]
		lea	eax, [esp+84h+var_74]
		push	eax
		push	edi
		push	esi
		call	_tls1_set_curves
		mov	ecx, [esp+90h+var_4]
		add	esp, 10h
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
_tls1_set_curves_list endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4CF8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_set_ec_id	proc near		; CODE XREF: _tls12_check_peer_sigalg+8Ap
					; _tls1_check_cert_param+4Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_8]
		test	esi, esi
		jnz	short loc_4D05
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4D05:				; CODE XREF: _tls1_set_ec_id+7j
		push	edi
		push	esi
		call	_EC_KEY_get0_group
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_4D22
		push	edi
		call	_EC_GROUP_method_of
		add	esp, 4
		test	eax, eax
		jnz	short loc_4D27

loc_4D22:				; CODE XREF: _tls1_set_ec_id+1Bj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4D27:				; CODE XREF: _tls1_set_ec_id+28j
		push	ebx
		push	eax
		call	_EC_METHOD_get_field_type
		xor	ebx, ebx
		cmp	eax, 196h
		push	edi
		setz	bl
		call	_EC_GROUP_get_curve_name
		push	eax
		call	_tls1_ec_nid2curve_id
		mov	ecx, [esp+18h+arg_0]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_4D54
		mov	byte ptr [ecx],	0
		jmp	short loc_4D5E
; ---------------------------------------------------------------------------

loc_4D54:				; CODE XREF: _tls1_set_ec_id+55j
		test	ebx, ebx
		mov	byte ptr [ecx],	0FFh
		setz	al
		inc	al

loc_4D5E:				; CODE XREF: _tls1_set_ec_id+5Aj
		mov	edi, [esp+0Ch+arg_4]
		mov	[ecx+1], al
		test	edi, edi
		jz	short loc_4D9D
		push	esi
		call	_EC_KEY_get0_public_key
		add	esp, 4
		test	eax, eax
		jnz	short loc_4D7A
		pop	ebx
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4D7A:				; CODE XREF: _tls1_set_ec_id+7Cj
		push	esi
		call	_EC_KEY_get_conv_form
		add	esp, 4
		cmp	eax, 2
		jnz	short loc_4D9A
		test	ebx, ebx
		pop	ebx
		setz	al
		inc	al
		mov	[edi], al
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4D9A:				; CODE XREF: _tls1_set_ec_id+8Ej
		mov	byte ptr [edi],	0

loc_4D9D:				; CODE XREF: _tls1_set_ec_id+6Fj
		pop	ebx
		pop	edi
		mov	eax, 1
		pop	esi
		retn
_tls1_set_ec_id	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4DA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_server_sigalgs
_tls1_set_server_sigalgs proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		mov	eax, [ebx+98h]
		mov	eax, [eax+13Ch]
		test	eax, eax
		jz	short loc_4DF1
		push	eax
		call	_CRYPTO_free
		mov	eax, [ebx+98h]
		add	esp, 4
		mov	dword ptr [eax+13Ch], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+140h], 0

loc_4DF1:				; CODE XREF: _tls1_set_server_sigalgs+1Ej
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+54h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+70h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+7Ch], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+8Ch], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+98h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0A8h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0B4h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0C4h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0D0h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0E0h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0ECh], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+0FCh], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+108h], 0
		mov	eax, [ebx+98h]
		mov	dword ptr [eax+118h], 0
		mov	esi, [ebx+98h]
		cmp	dword ptr [esi+124h], 0
		jz	loc_5090
		push	ebx
		call	_tls1_set_shared_sigalgs
		add	esp, 4
		test	eax, eax
		jz	loc_505E
		mov	eax, [esi+13Ch]
		push	ebp
		xor	ebp, ebp
		cmp	[esi+140h], ebp
		jbe	loc_4FE5
		lea	ebx, [eax+0Dh]
		push	edi

loc_4F1F:				; CODE XREF: _tls1_set_server_sigalgs+232j
		movzx	eax, byte ptr [ebx-1]
		sub	eax, 1
		jz	short loc_4F42
		sub	eax, 1
		jz	short loc_4F3B
		sub	eax, 1
		jnz	loc_4FD0
		lea	edi, [eax+5]
		jmp	short loc_4F47
; ---------------------------------------------------------------------------

loc_4F3B:				; CODE XREF: _tls1_set_server_sigalgs+183j
		mov	edi, 2
		jmp	short loc_4F47
; ---------------------------------------------------------------------------

loc_4F42:				; CODE XREF: _tls1_set_server_sigalgs+17Ej
		mov	edi, 1

loc_4F47:				; CODE XREF: _tls1_set_server_sigalgs+191j
					; _tls1_set_server_sigalgs+198j
		lea	eax, ds:0[edi*8]
		sub	eax, edi
		add	eax, 11h
		cmp	dword ptr [esi+eax*4], 0
		lea	eax, [esi+eax*4]
		mov	[esp+14h+var_4], eax
		jnz	short loc_4FD0
		movzx	eax, byte ptr [ebx]
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	short loc_4FA6	; jumptable 00004F69 default case
		jmp	ds:$LN61[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN33_0:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_md5	; jumptable 00004F69 case 0
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

$LN34_0:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_sha1	; jumptable 00004F69 case 1
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

$LN35_0:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_sha224	; jumptable 00004F69 case 2
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

$LN36_0:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_sha256	; jumptable 00004F69 case 3
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

$LN37_1:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_sha384	; jumptable 00004F69 case 4
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

$LN38_0:				; CODE XREF: _tls1_set_server_sigalgs+1C1j
					; DATA XREF: .text$mn:$LN61o
		call	_EVP_sha512	; jumptable 00004F69 case 5
		mov	edx, eax
		jmp	short loc_4FA8
; ---------------------------------------------------------------------------

loc_4FA6:				; CODE XREF: _tls1_set_server_sigalgs+1BFj
		xor	edx, edx	; jumptable 00004F69 default case

loc_4FA8:				; CODE XREF: _tls1_set_server_sigalgs+1CFj
					; _tls1_set_server_sigalgs+1D8j ...
		mov	eax, [esp+14h+var_4]
		lea	ecx, [edi+3]
		mov	[eax], edx
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		mov	dword ptr [esi+eax*4], 100h
		cmp	edi, 1
		jnz	short loc_4FD0
		mov	dword ptr [esi+54h], 100h
		mov	[esi+44h], edx

loc_4FD0:				; CODE XREF: _tls1_set_server_sigalgs+188j
					; _tls1_set_server_sigalgs+1B6j ...
		inc	ebp
		add	ebx, 10h
		cmp	ebp, [esi+140h]
		jb	loc_4F1F
		mov	ebx, [esp+14h+arg_0]
		pop	edi

loc_4FE5:				; CODE XREF: _tls1_set_server_sigalgs+16Dj
		mov	eax, [ebx+98h]
		pop	ebp
		test	dword ptr [eax+38h], 30001h
		jnz	short loc_502D
		cmp	dword ptr [esi+7Ch], 0
		jnz	short loc_5003
		call	_EVP_sha1
		mov	[esi+7Ch], eax

loc_5003:				; CODE XREF: _tls1_set_server_sigalgs+251j
		cmp	dword ptr [esi+60h], 0
		jnz	short loc_5019
		call	_EVP_sha1
		mov	[esi+60h], eax
		call	_EVP_sha1
		mov	[esi+44h], eax

loc_5019:				; CODE XREF: _tls1_set_server_sigalgs+25Fj
		cmp	dword ptr [esi+0D0h], 0
		jnz	short loc_502D
		call	_EVP_sha1
		mov	[esi+0D0h], eax

loc_502D:				; CODE XREF: _tls1_set_server_sigalgs+24Bj
					; _tls1_set_server_sigalgs+278j
		mov	eax, [ebx+98h]
		cmp	dword ptr [eax+13Ch], 0
		jnz	short loc_5099
		push	0BE0h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	178h
		push	14Fh
		push	14h
		call	_ERR_put_error
		mov	eax, 2Fh ; '/'
		jmp	short loc_507B
; ---------------------------------------------------------------------------

loc_505E:				; CODE XREF: _tls1_set_server_sigalgs+158j
		push	0BD9h
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	41h ; 'A'
		push	14Fh
		push	14h
		call	_ERR_put_error
		mov	eax, 50h ; 'P'

loc_507B:				; CODE XREF: _tls1_set_server_sigalgs+2B4j
		add	esp, 14h

$err$62:
		push	eax
		push	2
		push	ebx
		call	_ssl3_send_alert
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_5090:				; CODE XREF: _tls1_set_server_sigalgs+147j
		push	esi
		call	_ssl_cert_set_default_md
		add	esp, 4

loc_5099:				; CODE XREF: _tls1_set_server_sigalgs+292j
		pop	esi
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
_tls1_set_server_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
$LN61		dd offset $LN33_0	; DATA XREF: _tls1_set_server_sigalgs+1C1r
		dd offset $LN34_0	; jump table for switch	statement
		dd offset $LN35_0
		dd offset $LN36_0
		dd offset $LN37_1
		dd offset $LN38_0
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 50BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_tls1_set_shared_sigalgs proc near	; CODE XREF: _tls1_process_sigalgs+16p
					; _tls1_set_server_sigalgs+14Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		push	edi
		mov	esi, [ebp+98h]
		mov	ebx, [esi+38h]
		mov	eax, [esi+13Ch]
		and	ebx, 30000h
		test	eax, eax
		jz	short loc_5104
		push	eax
		call	_CRYPTO_free
		add	esp, 4
		mov	dword ptr [esi+13Ch], 0
		mov	dword ptr [esi+140h], 0

loc_5104:				; CODE XREF: _tls1_set_shared_sigalgs+29j
		cmp	dword ptr [ebp+24h], 0
		jnz	short loc_5120
		mov	edi, [esi+134h]
		test	edi, edi
		jz	short loc_5120
		test	ebx, ebx
		jnz	short loc_5120
		mov	ebp, [esi+138h]
		jmp	short loc_514A
; ---------------------------------------------------------------------------

loc_5120:				; CODE XREF: _tls1_set_shared_sigalgs+4Cj
					; _tls1_set_shared_sigalgs+56j	...
		mov	edi, [esi+12Ch]
		test	edi, edi
		jz	short loc_5136
		test	ebx, ebx
		jnz	short loc_5136
		mov	ebp, [esi+130h]
		jmp	short loc_514A
; ---------------------------------------------------------------------------

loc_5136:				; CODE XREF: _tls1_set_shared_sigalgs+6Cj
					; _tls1_set_shared_sigalgs+70j
		lea	eax, [esp+14h+var_4]
		push	eax
		push	ebp
		call	_tls12_get_psigalgs
		mov	edi, [esp+1Ch+var_4]
		add	esp, 8
		mov	ebp, eax

loc_514A:				; CODE XREF: _tls1_set_shared_sigalgs+62j
					; _tls1_set_shared_sigalgs+78j
		mov	eax, [esp+14h+arg_0]
		test	dword ptr [eax+100h], 400000h
		jnz	short loc_5170
		test	ebx, ebx
		jnz	short loc_5170
		mov	eax, [esi+124h]
		mov	ecx, [esi+128h]
		mov	[esp+14h+var_4], eax
		jmp	short loc_5184
; ---------------------------------------------------------------------------

loc_5170:				; CODE XREF: _tls1_set_shared_sigalgs+9Cj
					; _tls1_set_shared_sigalgs+A0j
		mov	eax, edi
		mov	[esp+14h+var_4], edi
		mov	edi, [esi+124h]
		mov	ecx, ebp
		mov	ebp, [esi+128h]

loc_5184:				; CODE XREF: _tls1_set_shared_sigalgs+B2j
		push	ebp
		push	edi
		push	ecx
		push	eax
		push	0
		mov	[esp+28h+arg_0], ecx
		call	_tls12_do_shared_sigalgs
		add	esp, 14h
		test	eax, eax
		jz	short loc_51D1
		push	0E7Fh
		shl	eax, 4
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	eax
		call	_CRYPTO_malloc
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_51BC
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_51BC:				; CODE XREF: _tls1_set_shared_sigalgs+F8j
		push	ebp
		push	edi
		push	[esp+1Ch+arg_0]
		push	[esp+20h+var_4]
		push	ebx
		call	_tls12_do_shared_sigalgs
		add	esp, 14h
		jmp	short loc_51D3
; ---------------------------------------------------------------------------

loc_51D1:				; CODE XREF: _tls1_set_shared_sigalgs+DCj
		xor	ebx, ebx

loc_51D3:				; CODE XREF: _tls1_set_shared_sigalgs+113j
		pop	edi
		mov	[esi+13Ch], ebx
		mov	[esi+140h], eax
		mov	eax, 1
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
_tls1_set_shared_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 51ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_sigalgs
_tls1_set_sigalgs proc near		; CODE XREF: _tls1_set_sigalgs_list+8Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		test	bl, 1
		jz	short loc_51FA
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_51FA:				; CODE XREF: _tls1_set_sigalgs+8j
		push	edi
		push	0FFFh
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		mov	[esp+8+arg_8], edi
		test	edi, edi
		jnz	short loc_521B
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_521B:				; CODE XREF: _tls1_set_sigalgs+2Aj
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	esi, edi
		test	ebx, ebx
		jz	short loc_528B
		mov	edi, [esp+10h+arg_4]
		nop	dword ptr [eax]

loc_522C:				; CODE XREF: _tls1_set_sigalgs+99j
		mov	ecx, [edi]
		xor	eax, eax

loc_5230:				; CODE XREF: _tls1_set_sigalgs+51j
		cmp	ds:_tls12_md[eax*8], ecx
		jz	short loc_5244
		inc	eax
		cmp	eax, 6
		jb	short loc_5230
		or	edx, 0FFFFFFFFh
		jmp	short loc_524B
; ---------------------------------------------------------------------------

loc_5244:				; CODE XREF: _tls1_set_sigalgs+4Bj
		mov	edx, ds:dword_164[eax*8]

loc_524B:				; CODE XREF: _tls1_set_sigalgs+56j
		mov	ecx, [edi+4]
		xor	eax, eax

loc_5250:				; CODE XREF: _tls1_set_sigalgs+71j
		cmp	ds:_tls12_sig[eax*8], ecx
		jz	short loc_5264
		inc	eax
		cmp	eax, 3
		jb	short loc_5250
		or	eax, 0FFFFFFFFh
		jmp	short loc_526B
; ---------------------------------------------------------------------------

loc_5264:				; CODE XREF: _tls1_set_sigalgs+6Bj
		mov	eax, ds:dword_194[eax*8]

loc_526B:				; CODE XREF: _tls1_set_sigalgs+76j
		add	edi, 8
		cmp	edx, 0FFFFFFFFh
		jz	short $err$45
		cmp	eax, 0FFFFFFFFh
		jz	short $err$45
		mov	[esi], dl
		add	ebp, 2
		mov	[esi+1], al
		add	esi, 2
		cmp	ebp, ebx
		jb	short loc_522C
		mov	edi, [esp+10h+arg_8]

loc_528B:				; CODE XREF: _tls1_set_sigalgs+37j
		cmp	[esp+10h+arg_C], 0
		mov	esi, [esp+10h+arg_0]
		jz	short loc_52D2
		mov	eax, [esi+134h]
		test	eax, eax
		jz	short loc_52A9
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_52A9:				; CODE XREF: _tls1_set_sigalgs+B2j
		mov	[esi+134h], edi
		mov	eax, 1
		mov	[esi+138h], ebx
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$err$45:				; CODE XREF: _tls1_set_sigalgs+85j
					; _tls1_set_sigalgs+8Aj
		push	[esp+10h+arg_8]
		call	_CRYPTO_free
		add	esp, 4
		xor	eax, eax
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_52D2:				; CODE XREF: _tls1_set_sigalgs+A8j
		mov	eax, [esi+12Ch]
		test	eax, eax
		jz	short loc_52E5
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_52E5:				; CODE XREF: _tls1_set_sigalgs+EEj
		mov	[esi+12Ch], edi
		mov	eax, 1
		mov	[esi+130h], ebx
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		retn
_tls1_set_sigalgs endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 52FCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_set_sigalgs_list
_tls1_set_sigalgs_list proc near

var_E8		= dword	ptr -0E8h
var_E4		= byte ptr -0E4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 0E8h ; ''
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0E8h+var_4], eax
		mov	eax, [esp+0E8h+arg_4]
		lea	ecx, [esp+0E8h+var_E8]
		push	esi
		mov	esi, [esp+0ECh+arg_0]
		push	ecx
		push	offset _sig_cb
		push	1
		push	3Ah ; ':'
		push	eax
		mov	[esp+100h+var_E8], 0
		call	_CONF_parse_list
		add	esp, 14h
		test	eax, eax
		jnz	short loc_535B
		pop	esi
		mov	ecx, [esp+0E8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
; ---------------------------------------------------------------------------

loc_535B:				; CODE XREF: _tls1_set_sigalgs_list+47j
		test	esi, esi
		jnz	short loc_5378
		lea	eax, [esi+1]
		pop	esi
		mov	ecx, [esp+0E8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
; ---------------------------------------------------------------------------

loc_5378:				; CODE XREF: _tls1_set_sigalgs_list+61j
		push	[esp+0ECh+arg_8]
		lea	eax, [esp+0F0h+var_E4]
		push	[esp+0F0h+var_E8]
		push	eax
		push	esi
		call	_tls1_set_sigalgs
		mov	ecx, [esp+0FCh+var_4]
		add	esp, 10h
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0E8h
		retn
_tls1_set_sigalgs_list endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 53A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _tls1_shared_curve
_tls1_shared_curve proc	near		; CODE XREF: _tls1_check_ec_tmp_key+9Dp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 0Ch
		call	__chkstk
		push	esi
		mov	esi, [esp+10h+arg_0]
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_53C5
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_53C5:				; CODE XREF: _tls1_shared_curve+13j
		push	ebp
		mov	ebp, [esp+14h+arg_4]
		cmp	ebp, 0FFFFFFFEh
		jnz	short loc_5415
		mov	eax, [esi+98h]
		test	dword ptr [eax+38h], 30000h
		jz	short loc_5413
		mov	eax, [esi+58h]
		mov	eax, [eax+344h]
		mov	ecx, [eax+8]
		cmp	ecx, 300C02Bh
		jnz	short loc_53FD
		pop	ebp
		mov	eax, 19Fh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_53FD:				; CODE XREF: _tls1_shared_curve+48j
		xor	eax, eax
		mov	edx, 2CBh
		cmp	ecx, 300C02Ch
		pop	ebp
		cmovz	eax, edx
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_5413:				; CODE XREF: _tls1_shared_curve+34j
		xor	ebp, ebp

loc_5415:				; CODE XREF: _tls1_shared_curve+25j
		lea	eax, [esp+14h+var_4]
		push	eax
		lea	eax, [esp+18h+var_C]
		push	eax
		mov	eax, [esi+100h]
		shr	eax, 16h
		and	eax, 1
		push	eax
		push	esi
		call	_tls1_get_curvelist
		add	esp, 10h
		test	eax, eax
		jz	short loc_545F
		lea	eax, [esp+14h+arg_0]
		push	eax
		lea	eax, [esp+18h+var_8]
		push	eax
		mov	eax, [esi+100h]
		shr	eax, 16h
		not	eax
		and	eax, 1
		push	eax
		push	esi
		call	_tls1_get_curvelist
		add	esp, 10h
		test	eax, eax
		jnz	short loc_5467

loc_545F:				; CODE XREF: _tls1_shared_curve+8Fj
		pop	ebp
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_5467:				; CODE XREF: _tls1_shared_curve+B5j
		push	ebx
		mov	ebx, [esp+18h+var_4]
		push	edi
		test	ebx, ebx
		jnz	short loc_5491
		test	dword ptr [esi+100h], 400000h
		jz	short loc_5491
		mov	ecx, [esp+1Ch+arg_0]
		mov	esi, offset _eccurves_all
		mov	ebx, 1Ch
		mov	[esp+1Ch+arg_0], ecx
		jmp	short loc_54C1
; ---------------------------------------------------------------------------

loc_5491:				; CODE XREF: _tls1_shared_curve+C7j
					; _tls1_shared_curve+D3j
		mov	ecx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+arg_0], ecx
		test	ecx, ecx
		jnz	short loc_54BD
		test	dword ptr [esi+100h], 400000h
		jnz	short loc_54BD
		mov	esi, [esp+1Ch+var_C]
		mov	ecx, 1Ch
		mov	edi, offset _eccurves_all
		mov	[esp+1Ch+arg_0], ecx
		jmp	short loc_54C5
; ---------------------------------------------------------------------------

loc_54BD:				; CODE XREF: _tls1_shared_curve+F3j
					; _tls1_shared_curve+FFj
		mov	esi, [esp+1Ch+var_C]

loc_54C1:				; CODE XREF: _tls1_shared_curve+E7j
		mov	edi, [esp+1Ch+var_8]

loc_54C5:				; CODE XREF: _tls1_shared_curve+113j
		xor	eax, eax
		mov	[esp+1Ch+var_C], esi
		xor	edx, edx
		mov	[esp+1Ch+var_8], eax
		test	ecx, ecx
		jz	short loc_5548
		nop	dword ptr [eax]

loc_54D8:				; CODE XREF: _tls1_shared_curve+16Fj
		mov	ecx, esi
		xor	esi, esi
		test	ebx, ebx
		jz	short loc_5505
		mov	ah, [edi]
		nop	word ptr [eax+eax+00h]

loc_54E8:				; CODE XREF: _tls1_shared_curve+157j
		cmp	ah, [ecx]
		jnz	short loc_54F9
		mov	al, [edi+1]
		cmp	al, [ecx+1]
		jnz	short loc_54F9
		cmp	ebp, edx
		jz	short loc_5519
		inc	edx

loc_54F9:				; CODE XREF: _tls1_shared_curve+142j
					; _tls1_shared_curve+14Aj
		inc	esi
		add	ecx, 2
		cmp	esi, ebx
		jb	short loc_54E8
		mov	eax, [esp+1Ch+var_8]

loc_5505:				; CODE XREF: _tls1_shared_curve+136j
		inc	eax
		add	edi, 2
		mov	[esp+1Ch+var_8], eax
		cmp	eax, [esp+1Ch+arg_0]
		jnb	short loc_5548
		mov	esi, [esp+1Ch+var_C]
		jmp	short loc_54D8
; ---------------------------------------------------------------------------

loc_5519:				; CODE XREF: _tls1_shared_curve+14Ej
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	ecx, 8
		or	ecx, eax
		cmp	ecx, 1
		jl	short loc_553E
		cmp	ecx, 1Ch
		ja	short loc_553E
		mov	eax, ds:(_nid_list-4)[ecx*4]
		pop	edi
		pop	ebx
		pop	ebp
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_553E:				; CODE XREF: _tls1_shared_curve+180j
					; _tls1_shared_curve+185j
		pop	edi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_5548:				; CODE XREF: _tls1_shared_curve+12Bj
					; _tls1_shared_curve+169j
		pop	edi
		xor	eax, eax
		cmp	ebp, 0FFFFFFFFh
		pop	ebx
		pop	ebp
		cmovz	eax, edx
		pop	esi
		add	esp, 0Ch
		retn
_tls1_shared_curve endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5558h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl tls_decrypt_ticket(int, int, int,	int, size_t Size, int)
_tls_decrypt_ticket proc near		; CODE XREF: _tls1_process_ticket+125p

var_1B4		= dword	ptr -1B4h
var_1B0		= dword	ptr -1B0h
var_1AC		= dword	ptr -1ACh
Src		= dword	ptr -1A8h
var_1A4		= dword	ptr -1A4h
var_1A0		= dword	ptr -1A0h
var_D0		= byte ptr -0D0h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
Size		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, 1B4h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+1B4h+var_4], eax
		mov	eax, [esp+1B4h+arg_C]
		push	ebx
		mov	ebx, [esp+1B8h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+1C0h+arg_0]
		push	edi
		mov	edi, [esp+1C4h+arg_8]
		mov	[esp+1C4h+Src],	eax
		mov	eax, [esp+1C4h+arg_14]
		mov	ebp, [esi+170h]
		mov	[esp+1C4h+var_1A4], eax
		cmp	edi, 30h ; '0'
		jl	loc_5706
		lea	eax, [esp+1C4h+var_1A0]
		push	eax
		call	_HMAC_CTX_init
		lea	eax, [esp+1C8h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_init
		mov	ecx, [ebp+138h]
		add	esp, 8
		test	ecx, ecx
		jz	short loc_5604
		push	0
		lea	eax, [esp+1C8h+var_1A0]
		push	eax
		lea	eax, [esp+1CCh+var_D0]
		push	eax
		lea	eax, [ebx+10h]
		push	eax
		push	ebx
		push	esi
		call	ecx
		add	esp, 18h
		test	eax, eax
		js	loc_584F
		jz	loc_5706
		cmp	eax, 2
		jnz	short loc_567E
		lea	ebp, [eax-1]
		jmp	short loc_5680
; ---------------------------------------------------------------------------

loc_5604:				; CODE XREF: _tls_decrypt_ticket+78j
		lea	edx, [ebp+108h]
		mov	ecx, ebx
		mov	esi, 0Ch
		nop	dword ptr [eax+00000000h]

loc_5618:				; CODE XREF: _tls_decrypt_ticket+D3j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	loc_5706
		add	ecx, 4
		add	edx, 4
		sub	esi, 4
		jnb	short loc_5618
		push	0
		call	_EVP_sha256
		push	eax
		push	10h
		lea	eax, [ebp+118h]
		push	eax
		lea	eax, [esp+1D4h+var_1A0]
		push	eax
		call	_HMAC_Init_ex
		add	esp, 14h
		test	eax, eax
		jle	$err$30
		lea	eax, [ebx+10h]
		push	eax
		lea	eax, [ebp+128h]
		push	eax
		push	0
		call	_EVP_aes_128_cbc
		push	eax
		lea	eax, [esp+1D4h+var_D0]
		push	eax
		call	_EVP_DecryptInit_ex
		add	esp, 14h
		test	eax, eax
		jle	$err$30

loc_567E:				; CODE XREF: _tls_decrypt_ticket+A5j
		xor	ebp, ebp

loc_5680:				; CODE XREF: _tls_decrypt_ticket+AAj
		push	[esp+1C4h+var_1A0]
		call	_EVP_MD_size
		add	esp, 4
		mov	[esp+1C4h+var_1B0], eax
		test	eax, eax
		js	$err$30
		sub	edi, eax
		lea	eax, [esp+1C4h+var_1A0]
		push	edi
		push	ebx
		push	eax
		call	_HMAC_Update
		add	esp, 0Ch
		test	eax, eax
		jle	$err$30
		push	0
		lea	eax, [esp+1C8h+var_44]
		push	eax
		lea	eax, [esp+1CCh+var_1A0]
		push	eax
		call	_HMAC_Final
		add	esp, 0Ch
		test	eax, eax
		jle	$err$30
		lea	eax, [esp+1C4h+var_1A0]
		push	eax
		call	_HMAC_CTX_cleanup
		push	[esp+1C8h+var_1B0]
		lea	eax, [edi+ebx]
		push	eax
		lea	eax, [esp+1D0h+var_44]
		push	eax
		call	_CRYPTO_memcmp
		add	esp, 10h
		test	eax, eax
		lea	eax, [esp+1C4h+var_D0]
		push	eax
		jz	short loc_5724
		call	_EVP_CIPHER_CTX_cleanup
		add	esp, 4

loc_5706:				; CODE XREF: _tls_decrypt_ticket+50j
					; _tls_decrypt_ticket+9Cj ...
		mov	eax, 2

loc_570B:				; CODE XREF: _tls_decrypt_ticket+2D2j
					; _tls_decrypt_ticket+2FAj ...
		mov	ecx, [esp+1C4h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1B4h
		retn
; ---------------------------------------------------------------------------

loc_5724:				; CODE XREF: _tls_decrypt_ticket+1A4j
		call	_EVP_CIPHER_CTX_iv_length
		add	eax, 10h
		add	eax, ebx
		mov	[esp+1C8h+var_1AC], eax
		lea	eax, [esp+1C8h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_iv_length
		mov	ecx, 0FFFFFFF0h
		sub	ecx, eax
		push	0D7Bh
		add	edi, ecx
		push	offset ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ ; ".\\ssl\\t1_lib.c"
		push	edi
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	loc_5839
		push	edi
		push	[esp+1C8h+var_1AC]
		lea	eax, [esp+1CCh+var_1B4]
		push	eax
		lea	eax, [esp+1D0h+var_D0]
		push	esi
		push	eax
		call	_EVP_DecryptUpdate
		add	esp, 14h
		test	eax, eax
		jle	loc_5839
		lea	eax, [esp+1C4h+var_1B0]
		push	eax
		mov	eax, [esp+1C8h+var_1B4]
		add	eax, esi
		push	eax
		lea	eax, [esp+1CCh+var_D0]
		push	eax
		call	_EVP_DecryptFinal
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_57C3
		lea	eax, [esp+1C4h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		push	esi
		call	_CRYPTO_free
		add	esp, 8
		jmp	loc_5706
; ---------------------------------------------------------------------------

loc_57C3:				; CODE XREF: _tls_decrypt_ticket+24Ej
		mov	eax, [esp+1C4h+var_1B0]
		add	[esp+1C4h+var_1B4], eax
		lea	eax, [esp+1C4h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		push	[esp+1C8h+var_1B4]
		lea	eax, [esp+1CCh+var_1AC]
		mov	[esp+1CCh+var_1AC], esi
		push	eax
		push	0
		call	_d2i_SSL_SESSION
		push	esi
		mov	edi, eax
		call	_CRYPTO_free
		add	esp, 14h
		test	edi, edi
		jz	short loc_582F
		mov	esi, [esp+1C4h+Size]
		test	esi, esi
		jz	short loc_5817
		push	esi		; Size
		push	[esp+1C8h+Src]	; Src
		lea	eax, [edi+48h]
		push	eax		; Dst
		call	_memcpy
		add	esp, 0Ch

loc_5817:				; CODE XREF: _tls_decrypt_ticket+2ACj
		mov	eax, [esp+1C4h+var_1A4]
		mov	[edi+44h], esi
		mov	[eax], edi
		xor	eax, eax
		test	ebp, ebp
		setnz	al
		add	eax, 3
		jmp	loc_570B
; ---------------------------------------------------------------------------

loc_582F:				; CODE XREF: _tls_decrypt_ticket+2A1j
		call	_ERR_clear_error
		jmp	loc_5706
; ---------------------------------------------------------------------------

loc_5839:				; CODE XREF: _tls_decrypt_ticket+207j
					; _tls_decrypt_ticket+22Aj
		lea	eax, [esp+1C4h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		push	esi
		call	_CRYPTO_free
		add	esp, 8

loc_584F:				; CODE XREF: _tls_decrypt_ticket+96j
		or	eax, 0FFFFFFFFh
		jmp	loc_570B
; ---------------------------------------------------------------------------

$err$30:				; CODE XREF: _tls_decrypt_ticket+F5j
					; _tls_decrypt_ticket+120j ...
		lea	eax, [esp+1C4h+var_D0]
		push	eax
		call	_EVP_CIPHER_CTX_cleanup
		lea	eax, [esp+1C8h+var_1A0]
		push	eax
		call	_HMAC_CTX_cleanup
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_570B
_tls_decrypt_ticket endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 587Ch
; COMDAT (pick any)
		public ??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@
; `string'
??_C@_0P@NKOFEPEL@?4?2ssl?2t1_lib?4c?$AA@ db '.\ssl\t1_lib.c',0
					; DATA XREF: _ssl_add_clienthello_tlsext:loc_7D0o
					; _ssl_add_clienthello_tlsext+48Bo ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 588Ch
; COMDAT (pick any)
		public ??_C@_03DICHAJGH@RSA?$AA@
; `string'
??_C@_03DICHAJGH@RSA?$AA@ dd 415352h	; DATA XREF: _sig_cb+9Bo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 5890h
; COMDAT (pick any)
		public ??_C@_03ENFFABCE@DSA?$AA@
; `string'
??_C@_03ENFFABCE@DSA?$AA@ dd 415344h	; DATA XREF: _sig_cb:loc_542o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 5894h
; COMDAT (pick any)
		public ??_C@_05JNBFMGNN@ECDSA?$AA@
; `string'
??_C@_05JNBFMGNN@ECDSA?$AA@ db 'ECDSA',0 ; DATA XREF: _sig_cb:loc_57Eo
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _tls1_change_cipher_state:near ; DATA XREF: .data:000001BCo
					; .data:00000204o ...
		extrn _tls1_setup_key_block:near ; DATA	XREF: .data:000001B4o
					; .data:000001FCo ...
		extrn _tls1_enc:near	; DATA XREF: .data:_TLSv1_enc_datao
					; .data:_TLSv1_1_enc_datao ...
		extrn _tls1_final_finish_mac:near ; DATA XREF: .data:000001C0o
					; .data:00000208o ...
		extrn _tls1_cert_verify_mac:near ; DATA	XREF: .data:000001C8o
					; .data:00000210o ...
		extrn _tls1_mac:near	; DATA XREF: .data:000001B0o
					; .data:000001F8o ...
		extrn _tls1_generate_master_secret:near	; DATA XREF: .data:000001B8o
					; .data:00000200o ...
		extrn _tls1_export_keying_material:near	; DATA XREF: .data:000001E0o
					; .data:00000228o ...
		extrn _tls1_alert_code:near ; DATA XREF: .data:000001DCo
					; .data:00000224o ...
		extrn _ssl3_set_handshake_header:near ;	DATA XREF: .data:000001ECo
					; .data:00000234o ...
		extrn _ssl3_handshake_write:near ; DATA	XREF: .data:000001F0o
					; .data:00000238o ...
		extrn ___report_rangecheckfailure:near ; CODE XREF: _nid_cb:loc_467p
					; _sig_cb:loc_62Cp
		extrn _sk_num:near	; CODE XREF: _ssl_add_clienthello_tlsext+43p
					; _ssl_add_clienthello_tlsext+68p ...
		extrn _sk_value:near	; CODE XREF: _ssl_add_clienthello_tlsext+52p
					; _ssl_add_clienthello_tlsext+619p ...
		extrn _sk_new_null:near	; CODE XREF: _ssl_scan_clienthello_tlsext+690p
		extrn _sk_pop_free:near	; CODE XREF: _ssl_scan_clienthello_tlsext+710p
		extrn _sk_push:near	; CODE XREF: _ssl_scan_clienthello_tlsext+6AAp
		extrn _CRYPTO_malloc:near ; CODE XREF: _ssl_add_clienthello_tlsext+491p
					; _ssl_scan_clienthello_tlsext+245p ...
		extrn _CRYPTO_free:near	; CODE XREF: _ssl_check_serverhello_tlsext+D6p
					; _ssl_scan_clienthello_tlsext+45p ...
		extrn _CRYPTO_memcmp:near ; CODE XREF: _tls_decrypt_ticket+192p
		extrn _OBJ_ln2nid:near	; CODE XREF: _nid_cb+8Fp _sig_cb+155p
		extrn _OBJ_sn2nid:near	; CODE XREF: _nid_cb+7Cp _sig_cb+146p
		extrn _OBJ_find_sigid_by_algs:near ; CODE XREF:	_tls1_lookup_sigalg+8Fp
		extrn _EVP_MD_type:near	; CODE XREF: _tls12_get_sigandhash+Cp
		extrn _EVP_MD_size:near	; CODE XREF: _tls_decrypt_ticket+12Cp
		extrn _EVP_CIPHER_CTX_iv_length:near
					; CODE XREF: _tls_decrypt_ticket:loc_5724p
					; _tls_decrypt_ticket+1E2p
		extrn _EVP_DecryptInit_ex:near ; CODE XREF: _tls_decrypt_ticket+116p
		extrn _EVP_DecryptUpdate:near ;	CODE XREF: _tls_decrypt_ticket+220p
		extrn _EVP_DecryptFinal:near ; CODE XREF: _tls_decrypt_ticket+244p
		extrn _EVP_CIPHER_CTX_init:near	; CODE XREF: _tls_decrypt_ticket+68p
		extrn _EVP_CIPHER_CTX_cleanup:near ; CODE XREF:	_tls_decrypt_ticket+1A6p
					; _tls_decrypt_ticket+258p ...
		extrn _EVP_md5:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN16_1p
					; _tls12_get_hash:$LN4_0j ...
		extrn _EVP_sha1:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN17_1p
					; _tls12_get_hash:$LN5_0j ...
		extrn _EVP_sha224:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN18_0p
					; _tls12_get_hash:$LN6_0j ...
		extrn _EVP_sha256:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN19_1p
					; _tls12_get_hash:$LN7_0j ...
		extrn _EVP_sha384:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN20_1p
					; _tls12_get_hash:$LN8_0j ...
		extrn _EVP_sha512:near	; CODE XREF: _tls12_do_shared_sigalgs:$LN21_1p
					; _tls12_get_hash:$LN9_0j ...
		extrn _EVP_aes_128_cbc:near ; CODE XREF: _tls_decrypt_ticket+108p
		extrn _EVP_PKEY_free:near ; CODE XREF: _tls1_check_cert_param+2Bp
					; _tls1_check_cert_param+53p
		extrn _HMAC_CTX_init:near ; CODE XREF: _tls_decrypt_ticket+5Bp
		extrn _HMAC_CTX_cleanup:near ; CODE XREF: _tls_decrypt_ticket+17Dp
					; _tls_decrypt_ticket+311p
		extrn _HMAC_Init_ex:near ; CODE	XREF: _tls_decrypt_ticket+EBp
		extrn _HMAC_Update:near	; CODE XREF: _tls_decrypt_ticket+149p
		extrn _HMAC_Final:near	; CODE XREF: _tls_decrypt_ticket+168p
		extrn _BUF_strdup:near	; CODE XREF: _ssl_scan_serverhello_tlsext+4B4p
		extrn _EC_GROUP_method_of:near ; CODE XREF: _tls1_set_ec_id+1Ep
		extrn _EC_METHOD_get_field_type:near ; CODE XREF: _tls1_set_ec_id+31p
		extrn _EC_GROUP_get_curve_name:near ; CODE XREF: _tls1_set_ec_id+41p
		extrn _EC_curve_nist2nid:near ;	CODE XREF: _nid_cb+69p
		extrn _EC_KEY_get0_group:near ;	CODE XREF: _tls1_set_ec_id+Fp
		extrn _EC_KEY_get0_public_key:near ; CODE XREF:	_tls1_set_ec_id+72p
		extrn _EC_KEY_get_conv_form:near ; CODE	XREF: _tls1_set_ec_id+83p
		extrn _X509_EXTENSION_free:near
					; DATA XREF: _ssl_scan_clienthello_tlsext+70Ao
		extrn _d2i_X509_EXTENSIONS:near
					; CODE XREF: _ssl_scan_clienthello_tlsext+720p
		extrn _i2d_X509_EXTENSIONS:near
					; CODE XREF: _ssl_add_clienthello_tlsext+656p
					; _ssl_add_clienthello_tlsext+770p
		extrn _X509_get_signature_nid:near ; CODE XREF:	_tls1_check_sig_alg+14p
		extrn _X509_get_issuer_name:near ; CODE	XREF: _ssl_check_ca_name+7p
		extrn _X509_get_pubkey:near ; CODE XREF: _tls1_check_cert_param+Fp
		extrn _X509_certificate_type:near ; CODE XREF: _tls1_check_chain+377p
		extrn _X509_chain_check_suiteb:near ; CODE XREF: _tls1_check_chain+129p
		extrn _X509_NAME_cmp:near ; CODE XREF: _ssl_check_ca_name+2Ap
		extrn _CONF_parse_list:near ; CODE XREF: _tls1_set_curves_list+42p
					; _tls1_set_sigalgs_list+3Dp
		extrn _OCSP_RESPID_free:near ; CODE XREF: _ssl_scan_clienthello_tlsext+8BCp
					; _ssl_scan_clienthello_tlsext+8D9p
		extrn _d2i_OCSP_RESPID:near ; CODE XREF: _ssl_scan_clienthello_tlsext+66Bp
		extrn _i2d_OCSP_RESPID:near ; CODE XREF: _ssl_add_clienthello_tlsext+621p
					; _ssl_add_clienthello_tlsext+71Ep
; char *__cdecl	_strchr(const char *Str, int Val)
		extrn __imp__strchr:near ; CODE	XREF: _sig_cb+7Bp
					; DATA XREF: _sig_cb+7Br
; int __cdecl _strncmp(const char *Str1, const char *Str2, size_t MaxCount)
		extrn __imp__strncmp:near ; CODE XREF: _ssl_scan_clienthello_tlsext+2E5p
					; DATA XREF: _ssl_scan_clienthello_tlsext+2E5r
		extrn _RAND_pseudo_bytes:near ;	CODE XREF: _tls1_heartbeat+8Ep
					; _tls1_heartbeat+CBp ...
		extrn _ERR_put_error:near ; CODE XREF: _ssl_add_clienthello_tlsext+1AAp
					; _ssl_add_serverhello_tlsext+35Cp ...
		extrn _ERR_clear_error:near ; CODE XREF: _tls_decrypt_ticket:loc_582Fp
		extrn _SSL_get_srtp_profiles:near
					; CODE XREF: _ssl_add_clienthello_tlsext+8F6p
					; _ssl_scan_clienthello_tlsext+7D0p
		extrn _d2i_SSL_SESSION:near ; CODE XREF: _tls_decrypt_ticket+28Fp
		extrn _SSL_ctrl:near	; CODE XREF: _ssl_add_clienthello_tlsext+436p
					; _ssl_add_serverhello_tlsext+229p ...
		extrn _SSL_get_ciphers:near ; CODE XREF: _ssl_add_clienthello_tlsext+39p
		extrn _SSL_state:near	; CODE XREF: _tls1_heartbeat+37p
		extrn _ssl_cert_set_default_md:near
					; CODE XREF: _tls1_set_server_sigalgs+2E9p
		extrn _ssl_get_server_send_pkey:near
					; CODE XREF: _ssl_check_clienthello_tlsext_late+34p
		extrn _ssl_cert_type:near ; CODE XREF: _tls1_check_chain+C6p
		extrn _ssl3_send_alert:near
					; CODE XREF: _ssl_check_clienthello_tlsext_early+7Dp
					; _ssl_check_clienthello_tlsext_early+90p ...
		extrn _ssl3_write_bytes:near ; CODE XREF: _tls1_heartbeat+E4p
					; _tls1_process_heartbeat+E2p
		extrn _ssl3_new:near	; CODE XREF: _tls1_new+6p
		extrn _ssl3_free:near	; CODE XREF: _tls1_free+19p
		extrn _ssl3_clear:near	; CODE XREF: _tls1_clear+6p
		extrn _ssl_add_serverhello_renegotiate_ext:near
					; CODE XREF: _ssl_add_serverhello_tlsext+EBp
					; _ssl_add_serverhello_tlsext+156p
		extrn _ssl_parse_serverhello_renegotiate_ext:near
					; CODE XREF: _ssl_scan_serverhello_tlsext+3E3p
		extrn _ssl_add_clienthello_renegotiate_ext:near
					; CODE XREF: _ssl_add_clienthello_tlsext+18Bp
					; _ssl_add_clienthello_tlsext+20Dp
		extrn _ssl_parse_clienthello_renegotiate_ext:near
					; CODE XREF: _ssl_scan_clienthello_tlsext+543p
		extrn _ssl_add_clienthello_use_srtp_ext:near
					; CODE XREF: _ssl_add_clienthello_tlsext+910p
					; _ssl_add_clienthello_tlsext+96Dp
		extrn _ssl_parse_clienthello_use_srtp_ext:near
					; CODE XREF: _ssl_scan_clienthello_tlsext+7E8p
		extrn _ssl_add_serverhello_use_srtp_ext:near
					; CODE XREF: _ssl_add_serverhello_tlsext+2E4p
					; _ssl_add_serverhello_tlsext+33Dp
		extrn _ssl_parse_serverhello_use_srtp_ext:near
					; CODE XREF: _ssl_scan_serverhello_tlsext+43Dp
		extrn _custom_ext_init:near ; CODE XREF: _ssl_add_clienthello_tlsext+997p
					; _ssl_parse_clienthello_tlsext+86p
		extrn _custom_ext_parse:near
					; CODE XREF: _ssl_scan_clienthello_custom_tlsext+A2p
					; _ssl_scan_serverhello_tlsext+459p
		extrn _custom_ext_add:near ; CODE XREF:	_ssl_add_clienthello_tlsext+9A9p
					; _ssl_add_serverhello_tlsext+55Bp
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _nid_cb+2Bp
					; _nid_cb+C7p ...
		extrn __chkstk:near	; CODE XREF: _nid_cb+5p _sig_cb+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _nid_cb+4Ep _sig_cb+5Dp ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ssl_add_clienthello_tlsext+A31p
		extrn ___security_cookie:near ;	DATA XREF: _nid_cb+Ar
					; _sig_cb+Ar ...


		end
