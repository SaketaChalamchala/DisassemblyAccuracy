;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	143562A498B74858D5ED080CE060890A
; Input	CRC32 :	D87A0D16

; File Name   :	C:\compspace\Diff\openssl\obj\dhtest.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_rnd_seed	db 'string to make the random number generator think it has entropy',0
					; DATA XREF: _main+69o
_dhtest_1024_160_xA dd 0AEB3A3B9h, 0A2C1EF8Fh, 50960493h, 45F88670h, 3E94485Dh
					; DATA XREF: .rdata:off_964o
_dhtest_1024_160_xB dd 0F9C99293h, 6A7A6AEBh, 0D8F72290h, 0C623723Eh, 0DABD5B83h
					; DATA XREF: .rdata:00000974o
_dhtest_1024_160_yA dd 3D3B852Ah, 1751992h, 2D5B01B9h, 4FD83EEBh, 0CC1D025Eh
					; DATA XREF: .rdata:0000096Co
		dd 9F1523Eh, 2B3D27D3h,	1C282175h, 760EBEBAh, 0FA2757FFh
		dd 69E2CC8Ah, 1F9ABA56h, 2F226CAh, 3F69D828h, 1D8410EBh
		dd 36A784h, 0A7E5EC54h,	1AA6B7F5h, 0C6B3DFD3h, 10432E0Dh
		dd 0DA27876Dh, 0CE9CDF37h, 7578B495h, 0EABC065Dh, 96459D8Fh
		dd 0F3A5755Fh, 137DFD1h, 0E5C95F16h, 0CE79420Ch, 95987FB0h
		dd 0D596AE40h, 76D78ED8h
_dhtest_1024_160_yB dd 0B06C7A71h, 0F41F3753h, 9432B9A3h, 63561E1Ch, 0D6A161F8h
					; DATA XREF: .rdata:0000097Co
		dd 66AE34ADh, 98FB6D57h, 0F9CBC6F6h, 6CA5D5DDh,	0BCF63378h
		dd 5509FFFDh, 8E86AD82h, 98D0E44h, 3C9E76FDh, 0D3C3CDECh
		dd 0A0CFE4B1h, 0AA6C7757h, 6A9B73F9h, 748EEE9Fh, 0DAD6F811h
		dd 4E6A9DC0h, 2BCC46DBh, 903525Dh, 2661AE0Eh, 0FD531E31h
		dd 74B5142Ch, 9A10A3E6h, 41BEA13Dh, 18AACEBDh, 67E05C6Fh
		dd 0A0B6A216h, 0FE333C7Bh
_dhtest_1024_160_Z dd 454F805Ch, 0C4D9304Dh, 1F2785DFh,	918C5293h, 0AB486BDFh
					; DATA XREF: .rdata:00000984o
		dd 0B5B3805Fh, 0B2C1AA9Ch, 0A9CB8A8Fh, 0F3393ECDh, 254561CBh
		dd 2E1D52D9h, 0B8534C64h, 0F310B807h, 252F0640h, 0BF6F7D7Dh
		dd 0F0E8D5E8h, 0E9B6E972h, 1394DAAFh, 8B2EFBEAh, 0FBB19906h
		dd 0EDAC0C5Ah, 7EADAEDEh, 6AB3FB9Ch, 8320B4E2h,	193AD85Bh
		dd 965E0BFBh, 0D0A48FBFh, 2555349Eh, 91CD7E16h,	466F4155h
		dd 31ED08F4h, 6D6E3CB6h
_dhtest_2048_224_xA dd 126E622h, 67D0FFDBh, 0F780A608h,	0F761F347h, 724F8F6Dh
					; DATA XREF: .rdata:00000990o
		dd 0E448051Ah, 0C4B2983h
_dhtest_2048_224_xB dd 96BCF34Fh, 6D6AFCC7h, 63B3D371h,	0DF7C0A80h, 1BC46FEFh
					; DATA XREF: .rdata:000009A0o
		dd 15EA1744h, 90753B35h
_dhtest_2048_224_yA dd 45633A1Bh, 0E686D81Bh, 497BE699h, 0D78B284Eh, 70D3E0F8h
					; DATA XREF: .rdata:00000998o
		dd 0A0A7DDBAh, 0E7FDD2EFh, 4561F6D8h, 4289FCCh,	0B85E9719h
		dd 8A7C8708h, 0B8E0C4Ch, 544A8DD4h, 871EEB01h, 0E1EEBF76h
		dd 3138C034h, 0D93C27ACh, 0CAB35D6h, 2AA406E0h,	523F7E88h
		dd 0B66687FBh, 7880F350h, 58E88EBCh, 43E2EF0Ch,	4FFC8C96h
		dd 8DBC38Dh, 1D175445h,	862EBF41h, 0D6B47B1Bh, 1EE0D09Dh
		dd 0AACB87A3h, 0AF72A65Ch, 0B9BDE8CBh, 0E14C2DD6h, 36DD175Fh
		dd 0EED11EF9h, 4ACA65DDh, 0B95C4506h, 520AD44Ch, 840E36ECh
		dd 0E226C9B3h, 0A380432Ch, 569D30BFh, 0B7689784h, 0F6FD2CF5h
		dd 3A05FD55h, 9706F77Eh, 6587E9Eh, 0E5FA7DB1h, 0BCA5D23Ah
		dd 52BB8E56h, 0D6617A9Ah, 8F6F258Dh, 4A077CC9h,	7E821D86h
		dd 618CBC2Eh, 15315534h, 3710EB7h, 6DA10A92h, 0CB2BE585h
		dd 6A788DABh, 0A88F1768h, 5C2F7CFFh, 6F8D6471h
_dhtest_2048_224_yB dd 92E9CE4Dh, 132A76A9h, 4438F8F2h,	0EE773DADh, 71C9310Eh
					; DATA XREF: .rdata:000009A8o
		dd 0C2B63D8Bh, 61395D03h, 0B3E2C18h, 41EC47A2h,	0CD60D782h
		dd 9995D948h, 0A1220697h, 2DBA1B88h, 9C9322C8h,	2C91C378h
		dd 54FA6166h, 6607B238h, 0E2752B22h, 0D03A2E4Ch, 367228C7h
		dd 0EE259512h, 79DDB515h, 0C404AA98h, 0AC6C69A9h, 832017D7h
		dd 66817AA9h, 472CAD4Eh, 4C4E449Eh, 19CC5406h, 3778DE2h
		dd 0CDDAE8CEh, 0D6F52661h, 0C652EC65h, 92DB5572h, 7E034B01h
		dd 0ACA221B6h, 0E05D368Eh, 40C1FF71h, 7A07CF0Ah, 0D83D9112h
		dd 344789DEh, 0A37BAB37h, 1B3C7446h, 0C1D95D21h, 0E4A76421h
		dd 0D1183105h, 0EFC8BE99h, 1761C56Fh, 7DC8840Ch, 679AEE10h
		dd 0FFA81F4Ah, 0BADF3BE1h, 48DE441Dh, 0DC686D94h, 7677DD0Ch
		dd 5BABA735h, 0B74B1EFBh, 68F956B8h, 184C7327h,	15E93841h
		dd 2E00C3D9h, 2031E5BCh, 207E6A54h, 6C2B1402h
_dhtest_2048_224_Z dd 0DCBDD934h, 6C17421Bh, 3EA3F31h, 4D03214Ch, 13634A07h
					; DATA XREF: .rdata:000009B0o
		dd 0B3CD4EBBh, 42FF3F70h, 6BA46745h, 0E5375DFh,	0A59D0ADEh
		dd 0D7E79D22h, 6C283267h, 0DA910FBCh, 2F853C4Ch, 79C699C0h
		dd 0C7941D53h, 9D3DB08Ah, 0E4A4B0ECh, 0B42B8BCAh, 21401C59h
		dd 0A2E38CCFh, 331D540Ah, 0D0174099h, 0C9E20A20h, 0F52F6E51h
		dd 26795714h, 0F2B869Eh, 0D5A274B4h, 0D51EC36Dh, 0B70A769h
		dd 6BB14A4Ch, 1355A422h, 23F51E53h, 71212D7h, 9B165A7Bh
		dd 7AADFFDEh, 848260D9h, 6D5B79C7h, 0B883515Ah,	17DE6670h
		dd 0C971D6D8h, 89ECD8EBh, 0EC454D54h, 0D4931506h, 0B92AC642h
		dd 0B91C3BCEh, 231D3A94h, 0CF3BEAA5h, 7114A021h, 3E007EE6h
		dd 0C7698A7Fh, 0B49BE28h, 0FE8CC82Fh, 0A2B62DB9h, 3CD0E515h
		dd 0C964C417h, 0E2461AACh, 953FE103h, 3FB9529h,	0C43C9DC6h
		dd 0B51CB7Fh, 0D3FF9869h, 3CE76DAAh, 6938F6F9h
_dhtest_2048_256_xA dd 2C388108h, 0C6687DBh, 613EC16Dh,	0B9D53849h, 48F2B2C8h
					; DATA XREF: .rdata:000009BCo
		dd 0E3C51C58h, 4345351Bh, 0EE5FC97h
_dhtest_2048_256_yA dd 0C880932Eh, 75F93A32h, 4149BC45h, 37ECB0DEh, 0E02FC642h
					; DATA XREF: .rdata:000009C4o
		dd 0A624E8ECh, 6CE6DBABh, 24E0BE59h, 0B9BF1129h, 0EB5C2367h
		dd 3EE15AA3h, 0BE52C74Eh, 0DC920B63h, 4728DE4Bh, 0B82CC6A9h
		dd 42452715h, 60EBB71Fh, 0E90F3CA6h, 0E7CC9F15h, 0D87CCE26h
		dd 50743D52h, 40F87E66h, 219191E4h, 0C8015FEBh,	0D6D3B0C9h
		dd 0FB3BA948h, 829E6875h, 4A13AC44h, 1C7144F5h,	0DC029AE7h
		dd 682642C3h, 0DCDD8047h, 415998B4h, 5B7FC306h,	485698C7h
		dd 2ABF57Ah, 425E2E2Ah,	0C19798F0h, 0EA115AA8h,	4AF1202h
		dd 0BCCEB4D9h, 1A3C7C93h, 0A0A8153Eh, 76332E34h, 7F4EC815h
		dd 0B8B9B8E3h, 3AE7B17Fh, 0A312AF15h, 66E740Dh,	294FC3DFh
		dd 0E57C790Dh, 0A73AA11Ah, 5866BF85h, 0B0E4F5AFh, 0BE3C0093h
		dd 3C5B66AFh, 3A3A112Eh, 6952904Eh, 71C01D34h, 5F682614h
		dd 867EF34Eh, 0FF26818Ah, 0B579223Fh, 297EA67Ch
_dhtest_2048_256_xB dd 0E3A7627Dh, 61DE36EFh, 0AFD1137Bh, 0D782CB8h, 0D43BA283h
					; DATA XREF: .rdata:000009CCo
		dd 640567EEh, 71F32151h, 3DA546F5h
_dhtest_2048_256_yB dd 51035F57h, 811B2BBDh, 0F8BD4874h, 2C366C7Ah, 399D281Eh
					; DATA XREF: .rdata:000009D4o
		dd 980BA303h, 1F74C532h, 3E3650A2h, 0F7C7CB7Ah,	0BCAC3D7Fh
		dd 0DD1A131Fh, 7E36038Eh, 0B3BB8FFFh, 4478C5E1h, 259B8024h
		dd 26D2E4AFh, 0D26F1A2Ah, 541B6FAh, 74A630CAh, 9787FE0h
		dd 63882085h, 2349C02Fh, 4EAD9137h, 973A08DDh, 0E63E888Bh
		dd 0D5EBC18h, 5F4147D0h, 83E6952Dh, 6B8214CFh, 0D310BE5Fh
		dd 0C1C641CEh, 0B28AC720h, 98C60800h, 0CA0B7FBFh, 7F4D7B9h
		dd 3AF4D0BEh, 0F57029FBh, 4128D7Fh, 6DE66339h, 590D32DDh
		dd 6C93D99Ah, 7C13448Fh, 0EC80B108h, 0EB5C985Eh, 0D5F386E1h
		dd 807E6749h, 0EE317360h, 8033AF17h, 78B025A7h,	0DDD71723h
		dd 7A9DF543h, 9B8A56F9h, 0D3843AB6h, 4422F965h,	880912EDh
		dd 0F4029321h, 0CAC72429h, 249DB890h, 0B60A1BF7h, 7D3D8297h
		dd 5BFF1AEBh, 454A8E0Eh, 537F9FD4h, 13197E75h
_dhtest_2048_256_Z dd 0F80BC786h, 0BB81BBD0h, 178A0701h, 0D2B79C21h, 2ADB0372h
					; DATA XREF: .rdata:000009DCo
		dd 0F177C819h, 0D79FF1D1h, 25F27ED7h, 8FA646h, 0C82DD55Ah
		dd 8FB75345h, 0BE3003C6h, 67CEA51h, 51C1CA72h, 0C0354B5Eh
		dd 51A5B947h, 0DC398FB8h, 0A014DA26h, 7447F79Eh, 2D767CD4h
		dd 0EDF977D1h, 1EF1C25Bh, 0BD79C852h, 4850995h,	0D8EC9ECDh
		dd 0EFB3F9A8h, 8A001FBDh, 973085C5h, 7F83D1D9h,	7CF7182Bh
		dd 0AF01BED7h, 0B5C7A780h, 4CA53CEAh, 110C2DC0h, 953FEE6Fh
		dd 933987BBh, 7E5D8785h, 677E7486h, 3889726Eh, 9F7BFACh
		dd 4DBE058Eh, 5240B2CFh, 0FBEF3AB8h, 23F7814h, 7FDEDB9Ah
		dd 20E9FA53h, 90402284h, 0E9CE07E0h, 0BAF24B4Dh, 4BFD9FCEh
		dd 7CAFD257h, 0AA0C4D72h, 105BF19h, 4A7BF1F6h, 5E420FA1h
		dd 8060A73Eh, 0B3D6B9B4h, 15A1FECEh, 78B8CEB2h,	0B0A3B89Bh
		dd 0BEFE87EAh, 0F8C8B663h, 0B06DEC46h, 7C5D6CC2h
_dhtest_rfc5114_2048_224_bad_y dd 515F3245h, 1CDFE507h,	0B38202D6h, 0FA48F32h, 0FE41B887h
					; DATA XREF: _run_rfc5114_tests+28Fo
		dd 0ADDE35B9h, 0B48526C6h, 128C94FFh, 205BBF4Ch, 26A346C4h
		dd 0B725A4EBh, 67CC8E68h, 0D058EABAh, 24D2E9F2h, 88DA6072h
		dd 31E09C18h, 6D50AD6Ah, 838B3594h, 48FA6E4Ah, 87830F73h
		dd 1F666BFFh, 1C682A8h,	0B0B580E5h, 0D8E9D052h,	5B7DF972h
		dd 0A54CA58Bh, 0E2749525h, 0A74E617Ah, 0D2E2128Fh, 70028C9Dh
		dd 0C7324434h, 0FEB9F3B2h, 1FD62B17h, 0FA4A7E8Bh, 7A3EB5A3h
		dd 66339A81h, 1850A462h, 5FA23Eh, 229BD807h, 0D584ECE4h
		dd 2AF35AEBh, 44D82331h, 378B2A22h, 87C6CC44h, 9D50BE4Bh
		dd 458EC44Ah, 0C04D72CFh, 0ED72B389h, 7FBC2C33h, 0EB3B3916h
		dd 1A8DDD2h, 0B9628473h, 51C9D229h, 6A7A9E32h, 0DB0AC1CFh
		dd 7762E00Eh, 7262596Fh, 5BA6695Ah, 0C465CA70h,	0C29A6F95h
		dd 0B16D72DFh, 517B541Eh, 897FEFB4h, 59897493h
_rfctd		dd offset _DH_get_1024_160
off_964		dd offset _dhtest_1024_160_xA ;	DATA XREF: _run_rfc5114_tests+10o
		dd 14h
		dd offset _dhtest_1024_160_yA
		dd offset _dhtest_1024_160_yA+18h
		dd offset _dhtest_1024_160_xB
		dd 14h
		dd offset _dhtest_1024_160_yB
		dd offset _dhtest_1024_160_yA+18h
		dd offset _dhtest_1024_160_Z
		dd offset _dhtest_1024_160_yA+18h
		dd offset _DH_get_2048_224
		dd offset _dhtest_2048_224_xA
		dd 1Ch
		dd offset _dhtest_2048_224_yA
		dd offset _dhtest_1024_160_yB+18h
		dd offset _dhtest_2048_224_xB
		dd 1Ch
		dd offset _dhtest_2048_224_yB
		dd offset _dhtest_1024_160_yB+18h
		dd offset _dhtest_2048_224_Z
		dd offset _dhtest_1024_160_yB+18h
		dd offset _DH_get_2048_256
		dd offset _dhtest_2048_256_xA
		dd offset _rnd_seed+20h	; " generator think it has entropy"
		dd offset _dhtest_2048_256_yA
		dd offset _dhtest_1024_160_yB+18h
		dd offset _dhtest_2048_256_xB
		dd offset _rnd_seed+20h	; " generator think it has entropy"
		dd offset _dhtest_2048_256_yB
		dd offset _dhtest_1024_160_yB+18h
		dd offset _dhtest_2048_256_Z
		db 0, 1, 0
byte_9E3	db 0			; DATA XREF: _run_rfc5114_tests+248o
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9E4h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; __vsnprintf_l+14p ...
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9ECh
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A10h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vsnprintf_l(char	*DstBuf, size_t	MaxCount, const	char *Format, _locale_t	Locale,	va_list	ArgList)
		public __vsnprintf_l
__vsnprintf_l	proc near

DstBuf		= dword	ptr  4
MaxCount	= dword	ptr  8
Format		= dword	ptr  0Ch
Locale		= dword	ptr  10h
ArgList		= dword	ptr  14h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+MaxCount]
		push	[esp+10h+DstBuf]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
__vsnprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A44h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vsprintf_l(char *DstBuf,	const char *Format, _locale_t, va_list ArgList)
		public __vsprintf_l
__vsprintf_l	proc near

DstBuf		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+arg_8]
		push	[esp+8+Format]
		push	0FFFFFFFFh
		push	[esp+10h+DstBuf]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
__vsprintf_l	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cb		proc near		; DATA XREF: _main+B1o

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	al, 2Ah	; '*'
		test	ecx, ecx
		jnz	short loc_A89
		mov	byte ptr [esp+arg_0], 2Eh ; '.'
		jmp	short loc_AB3
; ---------------------------------------------------------------------------

loc_A89:				; CODE XREF: _cb+8j
		cmp	ecx, 1
		jnz	short loc_A95
		mov	byte ptr [esp+arg_0], 2Bh ; '+'
		jmp	short loc_AB3
; ---------------------------------------------------------------------------

loc_A95:				; CODE XREF: _cb+14j
		cmp	ecx, 2
		jnz	short loc_AA1
		mov	byte ptr [esp+arg_0], 2Ah ; '*'
		jmp	short loc_AB3
; ---------------------------------------------------------------------------

loc_AA1:				; CODE XREF: _cb+20j
		cmp	ecx, 3
		movzx	eax, al
		mov	edx, 0Ah
		cmovz	eax, edx
		mov	byte ptr [esp+arg_0], al

loc_AB3:				; CODE XREF: _cb+Fj _cb+1Bj ...
		push	esi
		mov	esi, [esp+4+arg_8]
		lea	eax, [esp+4+arg_0]
		push	1
		push	eax
		push	dword ptr [esi+4]
		call	_BIO_write
		push	0
		push	0
		push	0Bh
		push	dword ptr [esi+4]
		call	_BIO_ctrl
		add	esp, 1Ch
		mov	eax, 1
		pop	esi
		retn
_cb		endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0AE0h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _main+3E8p
					; _run_rfc5114_tests+345p ...

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B04h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl main(int argc, const char	**argv,	const char **envp)
		public _main
_main		proc near

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Dest		= byte ptr -14h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
argc		= dword	ptr  4
argv		= dword	ptr  8
envp		= dword	ptr  0Ch

		mov	eax, 34h ; '4'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		push	ebp
		push	esi
		push	edi
		push	offset _CRYPTO_dbg_get_options
		push	offset _CRYPTO_dbg_set_options
		xor	ebp, ebp
		push	offset _CRYPTO_dbg_free
		push	offset _CRYPTO_dbg_realloc
		push	offset _CRYPTO_dbg_malloc
		mov	[esp+54h+var_30], ebp
		lea	edi, [ebp+1]
		mov	[esp+54h+var_2C], ebp
		call	_CRYPTO_set_mem_debug_functions
		push	3
		call	_CRYPTO_dbg_set_options
		push	edi
		call	_CRYPTO_mem_ctrl
		push	dword ptr ds:__imp__free
		push	dword ptr ds:__imp__realloc
		push	dword ptr ds:__imp__malloc
		call	_CRYPTO_set_mem_functions
		push	40h ; '@'
		push	offset _rnd_seed ; "string to make the random number genera"...
		call	_RAND_seed
		call	_BIO_s_file
		push	eax
		call	_BIO_new
		mov	esi, eax
		add	esp, 34h
		test	esi, esi
		jnz	short $LN46
		push	edi		; Code
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN46:					; CODE XREF: _main+85j
		push	ebx
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		push	0
		push	6Ah ; 'j'
		push	esi
		call	_BIO_ctrl
		add	esp, 14h
		mov	[esp+44h+var_1C], 2
		mov	[esp+44h+var_18], esi
		mov	dword ptr [esp+44h+Dest], offset _cb
		call	_DH_new
		mov	ebx, eax
		mov	[esp+40h+var_20], ebx
		test	ebx, ebx
		jz	$err$48
		lea	eax, [esp+40h+var_18]
		push	eax
		push	5
		push	40h ; '@'
		push	ebx
		call	_DH_generate_parameters_ex
		add	esp, 10h
		test	eax, eax
		jz	$err$48
		lea	eax, [esp+40h+var_30]
		push	eax
		push	ebx
		call	_DH_check
		add	esp, 8
		test	eax, eax
		jz	$err$48
		mov	eax, [esp+40h+var_30]
		test	al, 1
		jz	short loc_C1A
		push	offset ??_C@_0BG@HEKOLPHE@p?5value?5is?5not?5prime?6?$AA@ ; "p value is	not prime\n"
		push	esi
		call	_BIO_puts
		mov	eax, [esp+48h+var_30]
		add	esp, 8

loc_C1A:				; CODE XREF: _main+102j
		test	al, 2
		jz	short loc_C30
		push	offset ??_C@_0BN@HECLLLLM@p?5value?5is?5not?5a?5safe?5prime?6?$AA@ ; "p	value is not a safe prime\n"
		push	esi
		call	_BIO_puts
		mov	eax, [esp+48h+var_30]
		add	esp, 8

loc_C30:				; CODE XREF: _main+118j
		test	al, 4
		jz	short loc_C46
		push	offset ??_C@_0CF@HHDJLALM@unable?5to?5check?5the?5generator?5va@ ; "unable to check the	generator value\n"
		push	esi
		call	_BIO_puts
		mov	eax, [esp+48h+var_30]
		add	esp, 8

loc_C46:				; CODE XREF: _main+12Ej
		test	al, 8
		jz	short loc_C58
		push	offset ??_C@_0CA@MNMNOHDI@the?5g?5value?5is?5not?5a?5generator?6?$AA@ ;	"the g value is	not a generator\n"
		push	esi
		call	_BIO_puts
		add	esp, 8

loc_C58:				; CODE XREF: _main+144j
		push	offset ??_C@_07NDIPGHCH@?6p?5?5?5?5?$DN?$AA@ ; "\np    ="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebx+8]
		push	esi
		call	_BN_print
		push	offset ??_C@_07HBPGMFGH@?6g?5?5?5?5?$DN?$AA@ ; "\ng    ="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebx+0Ch]
		push	esi
		call	_BN_print
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	esi
		call	_BIO_puts
		add	esp, 28h
		call	_DH_new
		mov	ebp, eax
		test	ebp, ebp
		jz	$err$48
		push	dword ptr [ebx+8]
		call	_BN_dup
		mov	[ebp+8], eax
		push	dword ptr [ebx+0Ch]
		call	_BN_dup
		add	esp, 8
		mov	[ebp+0Ch], eax
		cmp	dword ptr [ebp+8], 0
		jz	$err$48
		test	eax, eax
		jz	$err$48
		and	dword ptr [ebx+1Ch], 0FFFFFFFDh
		or	dword ptr [ebp+1Ch], 2
		push	ebx
		call	_DH_generate_key
		add	esp, 4
		test	eax, eax
		jz	$err$48
		push	offset ??_C@_06LDEACBHL@pri?51?$DN?$AA@	; "pri 1="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebx+18h]
		push	esi
		call	_BN_print
		push	offset ??_C@_07LABLDMAN@?6pub?51?$DN?$AA@ ; "\npub 1="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebx+14h]
		push	esi
		call	_BN_print
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	esi
		call	_BIO_puts
		push	ebp
		call	_DH_generate_key
		add	esp, 2Ch
		test	eax, eax
		jz	$err$48
		push	offset ??_C@_06LBAGJPCC@pri?52?$DN?$AA@	; "pri 2="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebp+18h]
		push	esi
		call	_BN_print
		push	offset ??_C@_07LCFNICFE@?6pub?52?$DN?$AA@ ; "\npub 2="
		push	esi
		call	_BIO_puts
		push	dword ptr [ebp+14h]
		push	esi
		call	_BN_print
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	esi
		call	_BIO_puts
		push	ebx
		call	_DH_size
		push	0B3h ; '³'
		push	offset ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ ; ".\\crypto\\dh\\dhtest.c"
		push	eax
		call	_CRYPTO_malloc
		push	ebx
		push	dword ptr [ebp+14h]
		mov	[esp+80h+var_2C], eax
		push	eax
		call	_DH_compute_key
		add	esp, 44h
		mov	edi, eax
		mov	[esp+40h+var_1C], edi
		push	offset ??_C@_06FNOLLFFD@key1?5?$DN?$AA@	; "key1	="
		push	esi
		call	_BIO_puts
		xor	ecx, ecx
		add	esp, 8
		mov	[esp+40h+var_30], ecx
		test	edi, edi
		jle	short loc_DD7
		mov	ebx, [esp+40h+var_2C]
		nop	dword ptr [eax]

loc_DA4:				; CODE XREF: _main+2CDj
		movzx	eax, byte ptr [ecx+ebx]
		push	eax
		lea	eax, [esp+44h+var_C]
		push	offset ??_C@_04JFFKLGJF@?$CF02X?$AA@ ; "%02X"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+4Ch+var_C]
		push	eax
		push	esi
		call	_BIO_puts
		mov	ecx, [esp+54h+var_30]
		add	esp, 14h
		inc	ecx
		mov	[esp+40h+var_30], ecx
		cmp	ecx, edi
		jl	short loc_DA4
		mov	ebx, [esp+40h+var_20]

loc_DD7:				; CODE XREF: _main+297j
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	esi
		call	_BIO_puts
		push	ebp
		call	_DH_size
		push	0BEh ; '¾'
		push	offset ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ ; ".\\crypto\\dh\\dhtest.c"
		push	eax
		call	_CRYPTO_malloc
		push	ebp
		push	dword ptr [ebx+14h]
		mov	[esp+60h+var_28], eax
		push	eax
		call	_DH_compute_key
		push	offset ??_C@_06EPFOBKLN@key2?5?$DN?$AA@	; "key2	="
		push	esi
		mov	[esp+6Ch+var_24], eax
		call	_BIO_puts
		xor	ecx, ecx
		add	esp, 2Ch
		mov	[esp+40h+var_30], ecx
		cmp	[esp+40h+var_24], ecx
		jle	short loc_E6B
		mov	ebx, [esp+40h+var_24]
		mov	edi, [esp+40h+var_28]
		nop	dword ptr [eax+eax+00000000h]

loc_E34:				; CODE XREF: _main+35Dj
		movzx	eax, byte ptr [ecx+edi]
		push	eax
		lea	eax, [esp+44h+var_C]
		push	offset ??_C@_04JFFKLGJF@?$CF02X?$AA@ ; "%02X"
		push	eax		; Dest
		call	_sprintf
		lea	eax, [esp+4Ch+var_C]
		push	eax
		push	esi
		call	_BIO_puts
		mov	ecx, [esp+54h+var_30]
		add	esp, 14h
		inc	ecx
		mov	[esp+40h+var_30], ecx
		cmp	ecx, ebx
		jl	short loc_E34
		mov	edi, [esp+40h+var_1C]
		mov	ebx, [esp+40h+var_20]

loc_E6B:				; CODE XREF: _main+31Ej
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	esi
		call	_BIO_puts
		add	esp, 8
		cmp	edi, 4
		jl	short loc_EDB
		cmp	[esp+40h+var_24], edi
		jnz	short loc_EDB
		mov	ecx, [esp+40h+var_2C]
		mov	edx, [esp+40h+var_28]
		sub	edi, 4
		jb	short loc_EA5
		nop	dword ptr [eax]

loc_E94:				; CODE XREF: _main+39Fj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_EAA
		add	ecx, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_E94

loc_EA5:				; CODE XREF: _main+38Bj
		cmp	edi, 0FFFFFFFCh
		jz	short loc_ED7

loc_EAA:				; CODE XREF: _main+394j
		mov	al, [ecx]
		cmp	al, [edx]
		jnz	short loc_EDB
		cmp	edi, 0FFFFFFFDh
		jz	short loc_ED7
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	short loc_EDB
		cmp	edi, 0FFFFFFFEh
		jz	short loc_ED7
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	short loc_EDB
		cmp	edi, 0FFFFFFFFh
		jz	short loc_ED7
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jnz	short loc_EDB

loc_ED7:				; CODE XREF: _main+3A4j _main+3AFj ...
		xor	edi, edi
		jmp	short loc_EF9
; ---------------------------------------------------------------------------

loc_EDB:				; CODE XREF: _main+378j _main+37Ej ...
		push	offset ??_C@_0BG@LKGEMADE@Error?5in?5DH?5routines?6?$AA@ ; "Error in DH	routines\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	edi, 1

loc_EF9:				; CODE XREF: _main+3D5j
		call	_run_rfc5114_tests
		test	eax, eax
		mov	ecx, 1
		cmovz	edi, ecx

$err$48:				; CODE XREF: _main+C6j	_main+E0j ...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		call	_ERR_print_errors_fp
		mov	eax, [esp+48h+var_2C]
		add	esp, 8
		test	eax, eax
		jz	short loc_F2A
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_F2A:				; CODE XREF: _main+41Bj
		mov	eax, [esp+40h+var_28]
		test	eax, eax
		jz	short loc_F3B
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_F3B:				; CODE XREF: _main+42Cj
		test	ebp, ebp
		jz	short loc_F48
		push	ebp
		call	_DH_free
		add	esp, 4

loc_F48:				; CODE XREF: _main+439j
		test	ebx, ebx
		jz	short loc_F55
		push	ebx
		call	_DH_free
		add	esp, 4

loc_F55:				; CODE XREF: _main+446j
		push	esi
		call	_BIO_free
		add	esp, 4
		push	edi		; Code
		call	dword ptr ds:__imp__exit
_main		endp

; ---------------------------------------------------------------------------
		db 5Bh
$LN47:					; $LN45
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F68h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int printf(const char	*Format, ...)
		public _printf
_printf		proc near		; CODE XREF: _run_rfc5114_tests+214p
					; _run_rfc5114_tests+2D7p

Format		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+Format]
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		lea	ecx, [esp+4+arg_4]
		push	ecx
		push	0
		push	esi
		push	eax
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		pop	esi
		retn
_printf		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F98h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_run_rfc5114_tests proc	near		; CODE XREF: _main:loc_EF9p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	eax, 14h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		mov	ebp, offset off_964
		xor	ecx, ecx
		mov	[esp+24h+var_8], edi
		mov	[esp+24h+var_4], ecx
		nop

loc_FB8:				; CODE XREF: _run_rfc5114_tests+24Ej
		mov	eax, [ebp-4]
		call	eax
		mov	ebx, eax
		mov	eax, [ebp-4]
		mov	[esp+24h+var_10], ebx
		call	eax
		mov	esi, eax
		mov	[esp+24h+var_C], esi
		test	ebx, ebx
		jz	loc_12EF
		test	esi, esi
		jz	loc_12EF
		push	0
		push	dword ptr [ebp+4]
		push	dword ptr [ebp+0]
		call	_BN_bin2bn
		mov	[ebx+18h], eax
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	_BN_bin2bn
		mov	[ebx+14h], eax
		push	0
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		call	_BN_bin2bn
		mov	[esi+18h], eax
		push	0
		push	dword ptr [ebp+1Ch]
		push	dword ptr [ebp+18h]
		call	_BN_bin2bn
		add	esp, 30h
		mov	[esi+14h], eax
		cmp	dword ptr [ebx+18h], 0
		jz	loc_12EF
		cmp	dword ptr [ebx+14h], 0
		jz	loc_12EF
		cmp	dword ptr [esi+18h], 0
		jz	loc_12EF
		test	eax, eax
		jz	loc_12EF
		push	ebx
		call	_DH_size
		add	esp, 4
		cmp	[ebp+24h], eax
		jnz	loc_12A0
		push	esi
		call	_DH_size
		add	esp, 4
		cmp	[ebp+24h], eax
		jnz	loc_12A0
		push	230h
		push	offset ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ ; ".\\crypto\\dh\\dhtest.c"
		push	ebx
		call	_DH_size
		add	esp, 4
		push	eax
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	edi, eax
		mov	[esp+24h+var_14], edi
		push	231h
		push	offset ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ ; ".\\crypto\\dh\\dhtest.c"
		push	esi
		call	_DH_size
		add	esp, 4
		push	eax
		call	_CRYPTO_malloc
		push	ebx
		push	dword ptr [esi+14h]
		mov	[esp+38h+var_8], eax
		push	edi
		call	_DH_compute_key
		add	esp, 18h
		cmp	eax, 0FFFFFFFFh
		jz	loc_12EF
		push	esi
		push	dword ptr [ebx+14h]
		push	[esp+2Ch+var_8]
		call	_DH_compute_key
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_12EF
		mov	edi, [ebp+24h]
		mov	ebx, edi
		mov	edx, [ebp+20h]
		mov	esi, edx
		mov	ecx, [esp+24h+var_14]
		sub	ebx, 4
		jb	short loc_10FD

loc_10EC:				; CODE XREF: _run_rfc5114_tests+163j
		mov	eax, [ecx]
		cmp	eax, [esi]
		jnz	short loc_1102
		add	ecx, 4
		add	esi, 4
		sub	ebx, 4
		jnb	short loc_10EC

loc_10FD:				; CODE XREF: _run_rfc5114_tests+152j
		cmp	ebx, 0FFFFFFFCh
		jz	short loc_113F

loc_1102:				; CODE XREF: _run_rfc5114_tests+158j
		mov	al, [ecx]
		cmp	al, [esi]
		jnz	loc_1294
		cmp	ebx, 0FFFFFFFDh
		jz	short loc_113F
		mov	al, [ecx+1]
		cmp	al, [esi+1]
		jnz	loc_1294
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_113F
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jnz	loc_1294
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_113F
		mov	al, [ecx+3]
		cmp	al, [esi+3]
		jnz	loc_1294

loc_113F:				; CODE XREF: _run_rfc5114_tests+168j
					; _run_rfc5114_tests+177j ...
		mov	ebx, [esp+24h+var_8]
		mov	eax, ebx
		sub	edi, 4
		jb	short loc_115B

loc_114A:				; CODE XREF: _run_rfc5114_tests+1C1j
		mov	ecx, [eax]
		cmp	ecx, [edx]
		jnz	short loc_1160
		add	eax, 4
		add	edx, 4
		sub	edi, 4
		jnb	short loc_114A

loc_115B:				; CODE XREF: _run_rfc5114_tests+1B0j
		cmp	edi, 0FFFFFFFCh
		jz	short loc_119D

loc_1160:				; CODE XREF: _run_rfc5114_tests+1B6j
		mov	cl, [eax]
		cmp	cl, [edx]
		jnz	loc_1294
		cmp	edi, 0FFFFFFFDh
		jz	short loc_119D
		mov	cl, [eax+1]
		cmp	cl, [edx+1]
		jnz	loc_1294
		cmp	edi, 0FFFFFFFEh
		jz	short loc_119D
		mov	cl, [eax+2]
		cmp	cl, [edx+2]
		jnz	loc_1294
		cmp	edi, 0FFFFFFFFh
		jz	short loc_119D
		mov	al, [eax+3]
		cmp	al, [edx+3]
		jnz	loc_1294

loc_119D:				; CODE XREF: _run_rfc5114_tests+1C6j
					; _run_rfc5114_tests+1D5j ...
		mov	eax, [esp+24h+var_4]
		inc	eax
		push	eax
		push	offset ??_C@_0BO@NFLDBCAH@RFC5114?5parameter?5test?5?$CFd?5OK?6?$AA@ ; "RFC5114	parameter test %d OK\n"
		mov	[esp+2Ch+var_4], eax
		call	_printf
		push	[esp+2Ch+var_10]
		call	_DH_free
		push	[esp+30h+var_C]
		call	_DH_free
		push	[esp+34h+var_14]
		call	_CRYPTO_free
		push	ebx
		call	_CRYPTO_free
		xor	esi, esi
		add	ebp, 2Ch ; ','
		add	esp, 18h
		mov	[esp+24h+var_8], esi
		xor	edi, edi
		cmp	ebp, (offset byte_9E3+5)
		jl	loc_FB8
		call	_DH_get_2048_224
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_12EF
		push	251h
		push	offset ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ ; ".\\crypto\\dh\\dhtest.c"
		push	ebx
		call	_DH_size
		add	esp, 4
		push	eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	loc_12EF
		push	esi
		push	100h
		push	offset _dhtest_rfc5114_2048_224_bad_y
		call	_BN_bin2bn
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	$bad_err$62
		push	ebx
		call	_DH_generate_key
		add	esp, 4
		test	eax, eax
		jz	$bad_err$62
		push	ebx
		push	ebp
		push	edi
		call	_DH_compute_key
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short $err$63
		call	_ERR_clear_error
		mov	eax, [esp+24h+var_4]
		inc	eax
		push	eax
		push	offset ??_C@_0BO@NFLDBCAH@RFC5114?5parameter?5test?5?$CFd?5OK?6?$AA@ ; "RFC5114	parameter test %d OK\n"
		call	_printf
		push	ebp
		call	_BN_free
		push	ebx
		call	_DH_free
		push	edi
		call	_CRYPTO_free
		add	esp, 14h
		lea	eax, [esi+1]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1294:				; CODE XREF: _run_rfc5114_tests+16Ej
					; _run_rfc5114_tests+17Fj ...
		mov	edi, [esp+24h+var_14]
		mov	esi, [esp+24h+var_C]
		mov	ebx, [esp+24h+var_10]

loc_12A0:				; CODE XREF: _run_rfc5114_tests+BBj
					; _run_rfc5114_tests+CDj
		xor	ebp, ebp

$err$63:				; CODE XREF: _run_rfc5114_tests+2C5j
		push	ebp
		call	_BN_free
		push	ebx
		call	_DH_free
		push	esi
		call	_DH_free
		push	edi
		call	_CRYPTO_free
		push	[esp+34h+var_8]
		call	_CRYPTO_free
		mov	eax, [esp+38h+var_4]
		add	esp, 14h
		inc	eax
		push	eax
		push	offset ??_C@_0BM@NLGKCGMK@Test?5failed?5RFC5114?5set?5?$CFd?6?$AA@ ; "Test failed RFC5114 set %d\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_12EF:				; CODE XREF: _run_rfc5114_tests+38j
					; _run_rfc5114_tests+40j ...
		xor	ebp, ebp

$bad_err$62:				; CODE XREF: _run_rfc5114_tests+2A0j
					; _run_rfc5114_tests+2B1j
		push	ebp
		call	_BN_free
		push	ebx
		call	_DH_free
		push	esi
		call	_DH_free
		push	edi
		call	_CRYPTO_free
		push	[esp+34h+var_8]
		call	_CRYPTO_free
		mov	eax, [esp+38h+var_4]
		add	esp, 14h
		mov	esi, dword ptr ds:__imp____acrt_iob_func
		inc	eax
		push	eax
		push	offset ??_C@_0CE@FDLEIAMD@Initalisation?5error?5RFC5114?5set?5@	; "Initalisation error RFC5114 set %d\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		push	2
		call	esi ; __imp____acrt_iob_func
		push	eax
		call	_ERR_print_errors_fp
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
_run_rfc5114_tests endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 134Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int sprintf(char *Dest, const	char *Format, ...)
		public _sprintf
_sprintf	proc near		; CODE XREF: _main+2AFp _main+33Fp

Dest		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	0FFFFFFFFh
		push	[esp+10h+Dest]
		call	___local_stdio_printf_options
		mov	ecx, [eax]
		push	dword ptr [eax+4]
		or	ecx, 1
		push	ecx
		call	dword ptr ds:__imp____stdio_common_vsprintf
		or	ecx, 0FFFFFFFFh
		add	esp, 1Ch
		test	eax, eax
		cmovs	eax, ecx
		retn
_sprintf	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1380h
; COMDAT (pick any)
		public ??_C@_0BG@HEKOLPHE@p?5value?5is?5not?5prime?6?$AA@
; `string'
??_C@_0BG@HEKOLPHE@p?5value?5is?5not?5prime?6?$AA@ db 'p value is not prime',0Ah,0
					; DATA XREF: _main+104o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1398h
; COMDAT (pick any)
		public ??_C@_0BN@HECLLLLM@p?5value?5is?5not?5a?5safe?5prime?6?$AA@
; `string'
??_C@_0BN@HECLLLLM@p?5value?5is?5not?5a?5safe?5prime?6?$AA@ db 'p value is not a safe prime',0Ah,0
					; DATA XREF: _main+11Ao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 13B8h
; COMDAT (pick any)
		public ??_C@_0CF@HHDJLALM@unable?5to?5check?5the?5generator?5va@
; `string'
??_C@_0CF@HHDJLALM@unable?5to?5check?5the?5generator?5va@ db 'unable to check the generator value',0Ah,0
					; DATA XREF: _main+130o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 13E0h
; COMDAT (pick any)
		public ??_C@_0CA@MNMNOHDI@the?5g?5value?5is?5not?5a?5generator?6?$AA@
; `string'
??_C@_0CA@MNMNOHDI@the?5g?5value?5is?5not?5a?5generator?6?$AA@ db 'the g value is not a generator',0Ah,0
					; DATA XREF: _main+146o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1400h
; COMDAT (pick any)
		public ??_C@_07NDIPGHCH@?6p?5?5?5?5?$DN?$AA@
; `string'
??_C@_07NDIPGHCH@?6p?5?5?5?5?$DN?$AA@ db 0Ah ; DATA XREF: _main:loc_C58o
		db 'p    =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1408h
; COMDAT (pick any)
		public ??_C@_07HBPGMFGH@?6g?5?5?5?5?$DN?$AA@
; `string'
??_C@_07HBPGMFGH@?6g?5?5?5?5?$DN?$AA@ db 0Ah ; DATA XREF: _main+168o
		db 'g    =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1410h
; COMDAT (pick any)
		public ??_C@_01EEMJAFIK@?6?$AA@
; `string'
??_C@_01EEMJAFIK@?6?$AA@ db 0Ah,0	; DATA XREF: _main+17Co _main+205o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1414h
; COMDAT (pick any)
		public ??_C@_06LDEACBHL@pri?51?$DN?$AA@
; `string'
??_C@_06LDEACBHL@pri?51?$DN?$AA@ db 'pri 1=',0 ; DATA XREF: _main+1DDo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 141Ch
; COMDAT (pick any)
		public ??_C@_07LABLDMAN@?6pub?51?$DN?$AA@
; `string'
??_C@_07LABLDMAN@?6pub?51?$DN?$AA@ db 0Ah ; DATA XREF: _main+1F1o
		db 'pub 1=',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1424h
; COMDAT (pick any)
		public ??_C@_06LBAGJPCC@pri?52?$DN?$AA@
; `string'
??_C@_06LBAGJPCC@pri?52?$DN?$AA@ db 'pri 2=',0 ; DATA XREF: _main+221o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 142Ch
; COMDAT (pick any)
		public ??_C@_07LCFNICFE@?6pub?52?$DN?$AA@
; `string'
??_C@_07LCFNICFE@?6pub?52?$DN?$AA@ db 0Ah ; DATA XREF: _main+235o
		db 'pub 2=',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1434h
; COMDAT (pick any)
		public ??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@
; `string'
??_C@_0BF@OBHHIMFG@?4?2crypto?2dh?2dhtest?4c?$AA@ db '.\crypto\dh\dhtest.c',0
					; DATA XREF: _main+25Fo _main+2E9o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 144Ch
; COMDAT (pick any)
		public ??_C@_06FNOLLFFD@key1?5?$DN?$AA@
; `string'
??_C@_06FNOLLFFD@key1?5?$DN?$AA@ db 'key1 =',0 ; DATA XREF: _main+281o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1454h
; COMDAT (pick any)
		public ??_C@_04JFFKLGJF@?$CF02X?$AA@
; char `string'[]
??_C@_04JFFKLGJF@?$CF02X?$AA@ db '%02X',0 ; DATA XREF: _main+2A9o _main+339o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 145Ch
; COMDAT (pick any)
		public ??_C@_06EPFOBKLN@key2?5?$DN?$AA@
; `string'
??_C@_06EPFOBKLN@key2?5?$DN?$AA@ db 'key2 =',0 ; DATA XREF: _main+302o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1464h
; COMDAT (pick any)
		public ??_C@_0BG@LKGEMADE@Error?5in?5DH?5routines?6?$AA@
; char `string'[]
??_C@_0BG@LKGEMADE@Error?5in?5DH?5routines?6?$AA@ db 'Error in DH routines',0Ah,0
					; DATA XREF: _main:loc_EDBo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 147Ch
; COMDAT (pick any)
		public ??_C@_0BO@NFLDBCAH@RFC5114?5parameter?5test?5?$CFd?5OK?6?$AA@
; char `string'[]
??_C@_0BO@NFLDBCAH@RFC5114?5parameter?5test?5?$CFd?5OK?6?$AA@ db 'RFC5114 parameter test %d OK',0Ah,0
					; DATA XREF: _run_rfc5114_tests+20Bo
					; _run_rfc5114_tests+2D2o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 149Ch
; COMDAT (pick any)
		public ??_C@_0CE@FDLEIAMD@Initalisation?5error?5RFC5114?5set?5@
; char `string'[]
??_C@_0CE@FDLEIAMD@Initalisation?5error?5RFC5114?5set?5@ db 'Initalisation error RFC5114 set %d',0Ah,0
					; DATA XREF: _run_rfc5114_tests+389o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 14C0h
; COMDAT (pick any)
		public ??_C@_0BM@NLGKCGMK@Test?5failed?5RFC5114?5set?5?$CFd?6?$AA@
; char `string'[]
??_C@_0BM@NLGKCGMK@Test?5failed?5RFC5114?5set?5?$CFd?6?$AA@ db 'Test failed RFC5114 set %d',0Ah,0
					; DATA XREF: _run_rfc5114_tests+334o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _DH_get_1024_160:near ; DATA XREF: .rdata:_rfctdo
		extrn _DH_get_2048_224:near ; CODE XREF: _run_rfc5114_tests+254p
					; DATA XREF: .rdata:0000098Co
		extrn _DH_get_2048_256:near ; DATA XREF: .rdata:000009B8o
		extrn __imp____acrt_iob_func:near ; CODE XREF: _main+91p
					; _main+3DEp ...
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p	...
		extrn __imp____stdio_common_vsprintf:near ; CODE XREF: __vsnprintf_l+22p
					; __vsprintf_l+20p ...
; void __cdecl _free(void *Memory)
		extrn __imp__free:near	; DATA XREF: _main+50r
; void *__cdecl	_malloc(size_t Size)
		extrn __imp__malloc:near ; DATA	XREF: _main+5Cr
; void *__cdecl	_realloc(void *Memory, size_t NewSize)
		extrn __imp__realloc:near ; DATA XREF: _main+56r
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:near	; CODE XREF: _main+88p	_main+45Bp
					; DATA XREF: ...
		extrn _CRYPTO_mem_ctrl:near ; CODE XREF: _main+4Bp
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _main+62p
		extrn _CRYPTO_set_mem_debug_functions:near ; CODE XREF:	_main+3Ep
		extrn _CRYPTO_malloc:near ; CODE XREF: _main+265p _main+2EFp ...
		extrn _CRYPTO_free:near	; CODE XREF: _main+41Ep _main+42Fp ...
		extrn _CRYPTO_dbg_malloc:near ;	DATA XREF: _main+2Eo
		extrn _CRYPTO_dbg_realloc:near ; DATA XREF: _main+29o
		extrn _CRYPTO_dbg_free:near ; DATA XREF: _main+24o
		extrn _CRYPTO_dbg_set_options:near ; CODE XREF:	_main+45p
					; DATA XREF: _main+1Do
		extrn _CRYPTO_dbg_get_options:near ; DATA XREF:	_main+18o
		extrn _BIO_s_file:near	; CODE XREF: _main+73p
		extrn _BIO_new:near	; CODE XREF: _main+79p
		extrn _BIO_free:near	; CODE XREF: _main+452p
		extrn _BIO_write:near	; CODE XREF: _cb+4Ap
		extrn _BIO_puts:near	; CODE XREF: _main+10Ap _main+120p ...
		extrn _BIO_ctrl:near	; CODE XREF: _cb+58p _main+9Dp
		extrn _BN_bin2bn:near	; CODE XREF: _run_rfc5114_tests+4Ep
					; _run_rfc5114_tests+5Ep ...
		extrn _BN_free:near	; CODE XREF: _run_rfc5114_tests+2DDp
					; _run_rfc5114_tests+30Bp ...
		extrn _BN_print:near	; CODE XREF: _main+163p _main+177p ...
		extrn _BN_dup:near	; CODE XREF: _main+19Cp _main+1A7p
		extrn _RAND_seed:near	; CODE XREF: _main+6Ep
		extrn _ERR_clear_error:near ; CODE XREF: _run_rfc5114_tests+2C7p
		extrn _ERR_print_errors_fp:near	; CODE XREF: _main+40Dp
					; _run_rfc5114_tests+3A0p
		extrn _DH_new:near	; CODE XREF: _main+B9p	_main+18Ap
		extrn _DH_free:near	; CODE XREF: _main+43Cp _main+449p ...
		extrn _DH_size:near	; CODE XREF: _main+255p _main+2DFp ...
		extrn _DH_generate_parameters_ex:near ;	CODE XREF: _main+D6p
		extrn _DH_check:near	; CODE XREF: _main+ECp
		extrn _DH_generate_key:near ; CODE XREF: _main+1CDp _main+211p ...
		extrn _DH_compute_key:near ; CODE XREF:	_main+273p _main+2FDp	...
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
		extrn __chkstk:near	; CODE XREF: _main+5p
					; _run_rfc5114_tests+5p
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso
		extrn ___security_cookie:near ;	DATA XREF: _main+Ar


		end
