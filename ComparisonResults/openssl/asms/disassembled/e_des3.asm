;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	111C219D8D219497F3406F496F623926
; Input	CRC32 :	CB6C98CF

; File Name   :	C:\compspace\Diff\openssl\obj\e_des3.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
_des_ede_cbc	dd offset byte_2B	; DATA XREF: _EVP_des_ede_cbco
		dd 8, 10h, 8, 1202h
		dd offset _des_ede_init_key
		dd offset _des_ede_cbc_cipher
		align 10h
off_20		dd offset dword_188	; DATA XREF: .rdata:_des_ede_ecbo
					; .rdata:_des_ede3_ecbo
		dd 0
		db 3 dup(0)
byte_2B		db 0			; DATA XREF: .rdata:_des_ede_cbco
off_2C		dd offset _des3_ctrl	; DATA XREF: .rdata:_des_ede3_cbco
		dd 0
_des_ede_cfb64	dd offset byte_3C	; DATA XREF: _EVP_des_ede_cfb64o
		dd 1
byte_3C		db 10h			; DATA XREF: .rdata:_des_ede_cfb64o
byte_3D		db 0			; DATA XREF: .rdata:_des_ede3_cfb64o
byte_3E		db 0			; DATA XREF: .rdata:_des_ede_ofbo
off_3F		dd offset loc_7FF+1	; DATA XREF: .rdata:_des_ede3_ofbo
		align 4
		dd 1203h
		dd offset _des_ede_init_key
		dd offset _des_ede_cfb64_cipher
		dd 0
		dd offset dword_188
		align 10h
		dd offset _des3_ctrl
		align 8
_des_ede_ofb	dd offset byte_3E	; DATA XREF: _EVP_des_ede_ofbo
		dd 1, 10h, 8, 1204h
		dd offset _des_ede_init_key
		dd offset _des_ede_ofb_cipher
		align 8
		dd offset dword_188
		dd 2 dup(0)
		dd offset _des3_ctrl
		dd 0
_des_ede_ecb	dd offset off_20	; DATA XREF: _EVP_des_edeo
					; _EVP_des_ede_ecbo
		dd 8, 10h, 0
		dd 1201h
		dd offset _des_ede_init_key
		dd offset _des_ede_ecb_cipher
		dd 0
		dd offset dword_188
		dd 2 dup(0)
		dd offset _des3_ctrl
		align 10h
_des_ede3_cbc	dd offset off_2C	; DATA XREF: _EVP_des_ede3_cbco
		dd 8, 18h, 8, 1202h
		dd offset _des_ede3_init_key
		dd offset _des_ede_cbc_cipher
		align 10h
		dd offset dword_188
		db 2 dup(0)
word_F6		dw 0			; DATA XREF: .rdata:_des3_wrapo
		dd 0
		dd offset _des3_ctrl
		dd 0
_des_ede3_cfb64	dd offset byte_3D	; DATA XREF: _EVP_des_ede3_cfb64o
		dd 1, 18h, 8, 1203h
		dd offset _des_ede3_init_key
		dd offset _des_ede_cfb64_cipher
		dd 0
		dd offset dword_188
		align 10h
		dd offset _des3_ctrl
		align 8
_des_ede3_ofb	dd offset off_3F	; DATA XREF: _EVP_des_ede3_ofbo
		dd 1, 18h, 8, 1204h
		dd offset _des_ede3_init_key
		dd offset _des_ede_ofb_cipher
		align 8
		dd offset dword_188
		dd 2 dup(0)
		dd offset _des3_ctrl
		dd 0
_des_ede3_ecb	dd offset off_20+1	; DATA XREF: _EVP_des_ede3o
					; _EVP_des_ede3_ecbo
		dd 8, 18h, 0
		dd 1201h
		dd offset _des_ede3_init_key
		dd offset _des_ede_ecb_cipher
dword_188	dd 0			; DATA XREF: .rdata:off_20o
					; .rdata:00000054o ...
		dd offset dword_188
		dd 2 dup(0)
		dd offset _des3_ctrl
		align 10h
_des_ede3_cfb1	dd offset loc_28B+7	; DATA XREF: _EVP_des_ede3_cfb1o
		dd 1, 18h, 8, 1203h
		dd offset _des_ede3_init_key
		dd offset _des_ede3_cfb1_cipher
		align 10h
		dd offset dword_188
		dd 2 dup(0)
		dd offset _des3_ctrl
		dd 0
_des_ede3_cfb8	dd offset loc_28B+8	; DATA XREF: _EVP_des_ede3_cfb8o
		dd 1, 18h, 8, 1203h
		dd offset _des_ede3_init_key
		dd offset _des_ede3_cfb8_cipher
		dd 0
		dd offset dword_188
		align 10h
		dd offset _des3_ctrl
		align 8
_wrap_iv	dd 2CA2DD4Ah		; DATA XREF: _des_ede3_unwrap:loc_830r
					; _des_ede3_wrap+C4r
dword_20C	dd 521E879h		; DATA XREF: _des_ede3_unwrap+6Cr
					; _des_ede3_wrap+CEr
_des3_wrap	dd offset word_F6	; DATA XREF: _EVP_des_ede3_wrapo
		dd 8, 18h, 0
		dd 111012h
		dd offset _des_ede3_init_key
		dd offset _des_ede3_wrap_cipher
		align 10h
		dd offset dword_188
		dd 4 dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 244h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede3_wrap_cipher proc near		; DATA XREF: .rdata:00000228o

arg_0		= dword	ptr  4
Size		= dword	ptr  10h

		mov	eax, [esp+Size]
		cmp	eax, 40000000h
		jnb	short loc_277
		test	al, 7
		jnz	short loc_277
		mov	ecx, [esp+arg_0]
		cmp	dword ptr [ecx+8], 0
		jz	short loc_26A
		mov	[esp+Size], eax	; Size
		mov	[esp+arg_0], ecx ; int
		jmp	_des_ede3_wrap
; ---------------------------------------------------------------------------

loc_26A:				; CODE XREF: _des_ede3_wrap_cipher+17j
		mov	[esp+Size], eax	; int
		mov	[esp+arg_0], ecx ; int
		jmp	_des_ede3_unwrap
; ---------------------------------------------------------------------------

loc_277:				; CODE XREF: _des_ede3_wrap_cipher+9j
					; _des_ede3_wrap_cipher+Dj
		or	eax, 0FFFFFFFFh
		retn
_des_ede3_wrap_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 27Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede_init_key proc near		; DATA XREF: .rdata:00000014o
					; .rdata:00000048o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, [eax+60h]
		push	esi
		push	edi

loc_28B:				; DATA XREF: .rdata:_des_ede3_cfb1o
					; .rdata:_des_ede3_cfb8o
		mov	dword ptr [esi+180h], 0
		call	_DES_set_key_unchecked
		lea	eax, [esi+80h]
		push	eax
		lea	eax, [edi+8]
		push	eax
		call	_DES_set_key_unchecked
		add	esp, 10h
		lea	edi, [esi+100h]
		mov	ecx, 20h ; ' '
		mov	eax, 1
		rep movsd
		pop	edi
		pop	esi
		retn
_des_ede_init_key endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede3_init_key proc	near		; DATA XREF: .rdata:000000E4o
					; .rdata:00000118o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [eax+60h]
		push	edi
		push	esi
		mov	dword ptr [edi+180h], 0
		call	_DES_set_key_unchecked
		lea	eax, [edi+80h]
		push	eax
		lea	eax, [esi+8]
		push	eax
		call	_DES_set_key_unchecked
		lea	eax, [edi+100h]
		push	eax
		lea	eax, [esi+10h]
		push	eax
		call	_DES_set_key_unchecked
		add	esp, 18h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
_des_ede3_init_key endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 310h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des3_ctrl	proc near		; DATA XREF: .rdata:off_2Co
					; .rdata:00000060o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		cmp	[esp+arg_4], 6
		jz	short loc_31B
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_31B:				; CODE XREF: _des3_ctrl+5j
		push	esi
		mov	esi, [esp+4+arg_C]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	dword ptr [edi+58h]
		push	esi
		call	_RAND_bytes
		add	esp, 8
		test	eax, eax
		jg	short loc_33A
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_33A:				; CODE XREF: _des3_ctrl+23j
		push	esi
		call	_DES_set_odd_parity
		add	esp, 4
		cmp	dword ptr [edi+58h], 10h
		jl	short loc_355
		lea	eax, [esi+8]
		push	eax
		call	_DES_set_odd_parity
		add	esp, 4

loc_355:				; CODE XREF: _des3_ctrl+37j
		cmp	dword ptr [edi+58h], 18h
		jl	short loc_367
		lea	eax, [esi+10h]
		push	eax
		call	_DES_set_odd_parity
		add	esp, 4

loc_367:				; CODE XREF: _des3_ctrl+49j
		pop	edi
		mov	eax, 1
		pop	esi
		retn
_des3_ctrl	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 370h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede_ecb_cipher proc near		; DATA XREF: .rdata:000000B4o
					; .rdata:00000184o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edi
		mov	eax, [ebp+0]
		mov	edi, [eax+4]
		mov	eax, [esp+8+arg_C]
		cmp	eax, edi
		jb	short loc_3D2
		mov	edx, [esp+8+arg_4]
		sub	eax, edi
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_8]
		xor	ebx, ebx
		sub	edx, esi
		mov	[esp+10h+arg_C], eax
		mov	[esp+10h+arg_4], edx
		nop	dword ptr [eax+00h]

loc_3A0:				; CODE XREF: _des_ede_ecb_cipher+5Ej
		mov	ecx, [ebp+60h]
		push	dword ptr [ebp+8]
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		lea	eax, [edx+esi]
		push	eax
		push	esi
		call	_DES_ecb3_encrypt
		mov	edx, [esp+28h+arg_4]
		add	ebx, edi
		add	esp, 18h
		add	esi, edi
		cmp	ebx, [esp+10h+arg_C]
		jbe	short loc_3A0
		pop	esi
		pop	ebx

loc_3D2:				; CODE XREF: _des_ede_ecb_cipher+12j
		pop	edi
		mov	eax, 1
		pop	ebp
		retn
_des_ede_ecb_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede_ofb_cipher proc near		; DATA XREF: .rdata:00000080o
					; .rdata:00000150o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, [esp+0Ch+arg_C]
		push	edi
		mov	edi, [esp+10h+arg_8]
		cmp	esi, 40000000h
		jb	short loc_446
		mov	eax, esi
		lea	edx, [ebp+50h]
		shr	eax, 1Eh
		mov	[esp+10h+arg_C], eax

loc_404:				; CODE XREF: _des_ede_ofb_cipher+68j
		mov	ecx, [ebp+60h]
		lea	eax, [ebp+20h]
		push	edx
		push	eax
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	40000000h
		push	ebx
		push	edi
		call	_DES_ede3_ofb64_encrypt
		add	esp, 20h
		lea	edx, [ebp+50h]
		sub	esi, 40000000h
		add	edi, 40000000h
		add	ebx, 40000000h
		sub	[esp+10h+arg_C], 1
		jnz	short loc_404

loc_446:				; CODE XREF: _des_ede_ofb_cipher+1Aj
		test	esi, esi
		jz	short loc_46F
		mov	ecx, [ebp+60h]
		lea	eax, [ebp+50h]
		push	eax
		lea	eax, [ebp+20h]
		push	eax
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	esi
		push	ebx
		push	edi
		call	_DES_ede3_ofb64_encrypt
		add	esp, 20h

loc_46F:				; CODE XREF: _des_ede_ofb_cipher+6Cj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_des_ede_ofb_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 47Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede_cbc_cipher proc near		; CODE XREF: _des_ede3_unwrap+7Dp
					; _des_ede3_unwrap+ABp	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 4
		call	__chkstk
		mov	eax, [esp+4+arg_0]
		push	edi
		mov	edi, [eax+60h]
		mov	ecx, [edi+180h]
		test	ecx, ecx
		jz	short loc_4B6
		add	eax, 20h ; ' '
		push	eax
		push	edi
		push	[esp+10h+arg_C]
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_8]
		call	ecx
		add	esp, 14h
		mov	eax, 1
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_4B6:				; CODE XREF: _des_ede_cbc_cipher+1Aj
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		push	esi
		mov	esi, [esp+14h+arg_C]
		cmp	esi, 40000000h
		jb	short loc_51E
		mov	ecx, esi
		lea	edx, [eax+20h]
		shr	ecx, 1Eh
		mov	[esp+14h+var_4], ecx
		nop	dword ptr [eax]

loc_4DC:				; CODE XREF: _des_ede_cbc_cipher+A0j
		push	dword ptr [eax+8]
		lea	eax, [edi+100h]
		push	edx
		push	eax
		lea	eax, [edi+80h]
		push	eax
		push	edi
		push	40000000h
		push	ebp
		push	ebx
		call	_DES_ede3_cbc_encrypt
		mov	eax, [esp+34h+arg_0]
		add	esp, 20h
		sub	esi, 40000000h
		add	ebx, 40000000h
		add	ebp, 40000000h
		sub	[esp+14h+var_4], 1
		lea	edx, [eax+20h]
		jnz	short loc_4DC

loc_51E:				; CODE XREF: _des_ede_cbc_cipher+4Fj
		test	esi, esi
		jz	short loc_543
		push	dword ptr [eax+8]
		add	eax, 20h ; ' '
		push	eax
		lea	eax, [edi+100h]
		push	eax
		lea	eax, [edi+80h]
		push	eax
		push	edi
		push	esi
		push	ebp
		push	ebx
		call	_DES_ede3_cbc_encrypt
		add	esp, 20h

loc_543:				; CODE XREF: _des_ede_cbc_cipher+A4j
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, 1
		pop	edi
		pop	ecx
		retn
_des_ede_cbc_cipher endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 550h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede_cfb64_cipher proc near		; DATA XREF: .rdata:0000004Co
					; .rdata:0000011Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, [esp+0Ch+arg_C]
		push	edi
		mov	edi, [esp+10h+arg_0]
		cmp	esi, 40000000h
		jb	short loc_5C5
		mov	eax, esi
		lea	edx, [edi+50h]
		shr	eax, 1Eh
		mov	[esp+10h+arg_C], eax
		nop	dword ptr [eax+eax+00000000h]

loc_580:				; CODE XREF: _des_ede_cfb64_cipher+73j
		push	dword ptr [edi+8]
		mov	ecx, [edi+60h]
		lea	eax, [edi+20h]
		push	edx
		push	eax
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	40000000h
		push	ebp
		push	ebx
		call	_DES_ede3_cfb64_encrypt
		add	esp, 24h
		lea	edx, [edi+50h]
		sub	esi, 40000000h
		add	ebx, 40000000h
		add	ebp, 40000000h
		sub	[esp+10h+arg_C], 1
		jnz	short loc_580

loc_5C5:				; CODE XREF: _des_ede_cfb64_cipher+1Aj
		test	esi, esi
		jz	short loc_5F1
		push	dword ptr [edi+8]
		mov	ecx, [edi+60h]
		lea	eax, [edi+50h]
		push	eax
		lea	eax, [edi+20h]
		push	eax
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	esi
		push	ebp
		push	ebx
		call	_DES_ede3_cfb64_encrypt
		add	esp, 24h

loc_5F1:				; CODE XREF: _des_ede_cfb64_cipher+77j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_des_ede_cfb64_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5FCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede3_cfb1_cipher proc near		; DATA XREF: .rdata:000001B8o

var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 8
		call	__chkstk
		push	ebp
		mov	ebp, [esp+0Ch+arg_C]
		xor	eax, eax
		mov	[esp+0Ch+var_4], eax
		test	ebp, ebp
		jz	loc_6B8
		mov	edx, [esp+0Ch+arg_0]
		push	ebx
		push	esi
		push	edi
		lea	ebx, [edx+20h]

loc_623:				; CODE XREF: _des_ede3_cfb1_cipher+B3j
		push	dword ptr [edx+8]
		mov	edi, eax
		mov	esi, eax
		and	edi, 7
		shr	esi, 3
		mov	ecx, 7
		mov	eax, 1
		sub	ecx, edi
		shl	eax, cl
		mov	ecx, [esp+1Ch+arg_8]
		push	ebx
		and	al, [esi+ecx]
		mov	ecx, [edx+60h]
		neg	al
		sbb	al, al
		and	al, 80h
		mov	byte ptr [esp+20h+arg_C], al
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	1
		push	1
		lea	eax, [esp+34h+var_5]
		push	eax
		lea	eax, [esp+38h+arg_C]
		push	eax
		call	_DES_ede3_cfb_encrypt
		mov	eax, [esp+3Ch+var_4]
		mov	edx, 80h ; '€'
		mov	bl, [esp+3Ch+var_5]
		mov	cl, al
		and	bl, 80h
		and	cl, 7
		shr	bl, cl
		inc	eax
		mov	ecx, edi
		mov	[esp+3Ch+var_4], eax
		sar	edx, cl
		add	esp, 24h
		mov	ecx, [esp+18h+arg_4]
		not	dl
		and	dl, [esi+ecx]
		or	bl, dl
		mov	edx, [esp+18h+arg_0]
		mov	[esi+ecx], bl
		lea	ebx, [edx+20h]
		cmp	eax, ebp
		jb	loc_623
		pop	edi
		pop	esi
		pop	ebx

loc_6B8:				; CODE XREF: _des_ede3_cfb1_cipher+17j
		mov	eax, 1
		pop	ebp
		add	esp, 8
		retn
_des_ede3_cfb1_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_des_ede3_cfb8_cipher proc near		; DATA XREF: .rdata:000001ECo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, [esp+0Ch+arg_C]
		push	edi
		mov	edi, [esp+10h+arg_8]
		cmp	esi, 40000000h
		jb	short loc_72F
		mov	eax, esi
		lea	edx, [ebp+20h]
		shr	eax, 1Eh
		mov	[esp+10h+arg_C], eax

loc_6EC:				; CODE XREF: _des_ede3_cfb8_cipher+69j
		push	dword ptr [ebp+8]
		mov	ecx, [ebp+60h]
		push	edx
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	40000000h
		push	8
		push	ebx
		push	edi
		call	_DES_ede3_cfb_encrypt
		add	esp, 24h
		lea	edx, [ebp+20h]
		sub	esi, 40000000h
		add	edi, 40000000h
		add	ebx, 40000000h
		sub	[esp+10h+arg_C], 1
		jnz	short loc_6EC

loc_72F:				; CODE XREF: _des_ede3_cfb8_cipher+1Aj
		test	esi, esi
		jz	short loc_759
		push	dword ptr [ebp+8]
		mov	ecx, [ebp+60h]
		lea	eax, [ebp+20h]
		push	eax
		lea	eax, [ecx+100h]
		push	eax
		lea	eax, [ecx+80h]
		push	eax
		push	ecx
		push	esi
		push	8
		push	ebx
		push	edi
		call	_DES_ede3_cfb_encrypt
		add	esp, 24h

loc_759:				; CODE XREF: _des_ede3_cfb8_cipher+6Dj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
_des_ede3_cfb8_cipher endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 764h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede
_EVP_des_ede	proc near
		mov	eax, offset _des_ede_ecb
		retn
_EVP_des_ede	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 76Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3
_EVP_des_ede3	proc near
		mov	eax, offset _des_ede3_ecb
		retn
_EVP_des_ede3	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 774h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_cbc
_EVP_des_ede3_cbc proc near
		mov	eax, offset _des_ede3_cbc
		retn
_EVP_des_ede3_cbc endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 77Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_cfb1
_EVP_des_ede3_cfb1 proc	near
		mov	eax, offset _des_ede3_cfb1
		retn
_EVP_des_ede3_cfb1 endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 784h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_cfb64
_EVP_des_ede3_cfb64 proc near
		mov	eax, offset _des_ede3_cfb64
		retn
_EVP_des_ede3_cfb64 endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 78Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_cfb8
_EVP_des_ede3_cfb8 proc	near
		mov	eax, offset _des_ede3_cfb8
		retn
_EVP_des_ede3_cfb8 endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 794h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_ecb
_EVP_des_ede3_ecb proc near
		mov	eax, offset _des_ede3_ecb
		retn
_EVP_des_ede3_ecb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 79Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_ofb
_EVP_des_ede3_ofb proc near
		mov	eax, offset _des_ede3_ofb
		retn
_EVP_des_ede3_ofb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede3_wrap
_EVP_des_ede3_wrap proc	near
		mov	eax, offset _des3_wrap
		retn
_EVP_des_ede3_wrap endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede_cbc
_EVP_des_ede_cbc proc near
		mov	eax, offset _des_ede_cbc
		retn
_EVP_des_ede_cbc endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede_cfb64
_EVP_des_ede_cfb64 proc	near
		mov	eax, offset _des_ede_cfb64
		retn
_EVP_des_ede_cfb64 endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede_ecb
_EVP_des_ede_ecb proc near
		mov	eax, offset _des_ede_ecb
		retn
_EVP_des_ede_ecb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7C4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _EVP_des_ede_ofb
_EVP_des_ede_ofb proc near
		mov	eax, offset _des_ede_ofb
		retn
_EVP_des_ede_ofb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 7CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl des_ede3_unwrap(int, void	*Dst, int, int)
_des_ede3_unwrap proc near		; CODE XREF: _des_ede3_wrap_cipher+2Ej

var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_20		= byte ptr -20h
var_18		= byte ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 2Ch ; ','
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	ecx, [esp+2Ch+arg_0]
		push	ebx
		mov	ebx, [esp+30h+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+38h+Dst]
		or	ebp, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_2C], ecx
		cmp	edi, 18h

loc_7FF:				; DATA XREF: .rdata:off_3Fo
		jnb	short loc_816
		pop	edi
		pop	esi
		or	eax, ebp
		pop	ebp
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_816:				; CODE XREF: _des_ede3_unwrap:loc_7FFj
		test	esi, esi
		jnz	short loc_830
		lea	eax, [edi-10h]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_830:				; CODE XREF: _des_ede3_unwrap+4Cj
		mov	eax, _wrap_iv
		mov	[ecx+20h], eax
		mov	eax, dword_20C
		push	8
		mov	[ecx+24h], eax
		lea	eax, [esp+40h+var_28]
		push	ebx
		push	eax
		push	ecx
		call	_des_ede_cbc_cipher
		add	esp, 10h
		cmp	esi, ebx
		jnz	short loc_86A
		lea	eax, [edi-8]
		push	eax		; Size
		lea	eax, [esi+8]
		push	eax		; Src
		push	esi		; Dst
		call	dword ptr ds:__imp__memmove
		add	esp, 0Ch
		sub	ebx, 8

loc_86A:				; CODE XREF: _des_ede3_unwrap+87j
		lea	eax, [edi-10h]
		push	eax
		lea	eax, [ebx+8]
		push	eax
		push	esi
		push	[esp+48h+var_2C]
		call	_des_ede_cbc_cipher
		push	8
		lea	eax, [edi-8]
		add	eax, ebx
		mov	ebx, [esp+50h+var_2C]
		push	eax
		lea	eax, [esp+54h+var_20]
		push	eax
		push	ebx
		call	_des_ede_cbc_cipher
		push	8
		lea	eax, [esp+60h+var_28]
		push	0
		push	eax
		call	_BUF_reverse
		lea	eax, [edi-10h]
		push	eax
		push	0
		push	esi
		call	_BUF_reverse
		push	8
		lea	eax, [esp+78h+var_20]
		push	eax
		lea	eax, [ebx+20h]
		push	eax
		call	_BUF_reverse
		add	esp, 44h
		lea	eax, [edi-10h]
		push	eax
		push	esi
		push	esi
		push	ebx
		call	_des_ede_cbc_cipher
		push	8
		lea	eax, [esp+50h+var_28]
		push	eax
		push	eax
		push	ebx
		call	_des_ede_cbc_cipher
		lea	eax, [esp+5Ch+var_18]
		push	eax
		lea	eax, [edi-10h]
		push	eax
		push	esi
		call	_SHA1
		push	8
		lea	eax, [esp+6Ch+var_28]
		push	eax
		lea	eax, [esp+70h+var_18]
		push	eax
		call	_CRYPTO_memcmp
		add	esp, 38h
		test	eax, eax
		jnz	short loc_904
		lea	ebp, [edi-10h]

loc_904:				; CODE XREF: _des_ede3_unwrap+133j
		lea	eax, [esp+3Ch+var_28]
		push	8
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+44h+var_18]
		push	14h
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+4Ch+var_20]
		push	8
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [ebx+20h]
		push	8
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 20h
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_948
		lea	eax, [edi-10h]
		push	eax
		push	esi
		call	_OPENSSL_cleanse
		add	esp, 8

loc_948:				; CODE XREF: _des_ede3_unwrap+16Dj
		mov	ecx, [esp+3Ch+var_4]
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
_des_ede3_unwrap endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 960h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl des_ede3_wrap(int, int, void *Src, size_t	Size)
_des_ede3_wrap	proc near		; CODE XREF: _des_ede3_wrap_cipher+21j

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h

		mov	eax, 18h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		push	ebx
		mov	ebx, [esp+1Ch+Src]
		push	ebp
		mov	ebp, [esp+20h+arg_0]
		push	esi
		mov	esi, [esp+24h+Size]
		push	edi
		mov	edi, [esp+28h+arg_4]
		test	edi, edi
		jnz	short loc_9A3
		pop	edi
		lea	eax, [esi+10h]
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_9A3:				; CODE XREF: _des_ede3_wrap+2Bj
		push	esi		; Size
		lea	eax, [edi+8]
		push	ebx		; Src
		push	eax		; Dst
		call	dword ptr ds:__imp__memmove
		lea	eax, [esp+34h+var_18]
		push	eax
		push	esi
		push	ebx
		call	_SHA1
		mov	eax, [esp+40h+var_18]
		mov	[esi+edi+8], eax
		mov	eax, [esp+40h+var_14]
		mov	[esi+edi+0Ch], eax
		lea	eax, [esp+40h+var_18]
		push	14h
		push	eax
		call	_OPENSSL_cleanse
		lea	ebx, [ebp+20h]
		push	8
		push	ebx
		call	_RAND_bytes
		add	esp, 28h
		test	eax, eax
		jg	short loc_9FF
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_9FF:				; CODE XREF: _des_ede3_wrap+87j
		mov	eax, [ebx]
		mov	[edi], eax
		mov	eax, [ebx+4]
		mov	[edi+4], eax
		lea	eax, [esi+8]
		push	eax
		lea	eax, [edi+8]
		push	eax
		push	eax
		push	ebp
		call	_des_ede_cbc_cipher
		add	esi, 10h
		push	esi
		push	0
		push	edi
		call	_BUF_reverse
		mov	ecx, _wrap_iv
		push	esi
		push	edi
		mov	[ebx], ecx
		mov	ecx, dword_20C
		push	edi
		push	ebp
		mov	[ebx+4], ecx
		call	_des_ede_cbc_cipher
		mov	ecx, [esp+54h+var_4]
		add	esp, 2Ch
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
_des_ede3_wrap	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; void *__cdecl	_memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp__memmove:near ; CODE XREF: _des_ede3_unwrap+92p
					; _des_ede3_wrap+49p
					; DATA XREF: ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _des_ede3_unwrap+13Fp
					; _des_ede3_unwrap+14Bp ...
		extrn _CRYPTO_memcmp:near ; CODE XREF: _des_ede3_unwrap+129p
		extrn _BUF_reverse:near	; CODE XREF: _des_ede3_unwrap+D0p
					; _des_ede3_unwrap+DCp	...
		extrn _DES_ecb3_encrypt:near ; CODE XREF: _des_ede_ecb_cipher+4Ap
		extrn _DES_ede3_cbc_encrypt:near ; CODE	XREF: _des_ede_cbc_cipher+7Ap
					; _des_ede_cbc_cipher+BFp
		extrn _DES_ede3_cfb64_encrypt:near ; CODE XREF:	_des_ede_cfb64_cipher+51p
					; _des_ede_cfb64_cipher+99p
		extrn _DES_ede3_cfb_encrypt:near ; CODE	XREF: _des_ede3_cfb1_cipher+74p
					; _des_ede3_cfb8_cipher+47p ...
		extrn _DES_ede3_ofb64_encrypt:near ; CODE XREF:	_des_ede_ofb_cipher+46p
					; _des_ede_ofb_cipher+8Bp
		extrn _DES_set_odd_parity:near ; CODE XREF: _des3_ctrl+2Bp
					; _des3_ctrl+3Dp ...
		extrn _DES_set_key_unchecked:near ; CODE XREF: _des_ede_init_key+19p
					; _des_ede_init_key+29p ...
		extrn _RAND_bytes:near	; CODE XREF: _des3_ctrl+19p
					; _des_ede3_wrap+7Dp
		extrn _SHA1:near	; CODE XREF: _des_ede3_unwrap+118p
					; _des_ede3_wrap+56p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _des_ede3_unwrap+41p
					; _des_ede3_unwrap+5Bp	...
		extrn __chkstk:near	; CODE XREF: _des_ede_cbc_cipher+5p
					; _des_ede3_cfb1_cipher+5p ...
		extrn ___security_cookie:near ;	DATA XREF: _des_ede3_unwrap+Ar
					; _des_ede3_wrap+Ar


		end
