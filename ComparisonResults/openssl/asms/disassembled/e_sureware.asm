;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	4F9E49294662F488B59CFBCAB8E18D4D
; Input	CRC32 :	DE4DB3F9

; File Name   :	C:\compspace\Diff\openssl\obj\e_sureware.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
; COMDAT (pick any)
		public ??_C@_0BA@HGKJNINO@SUREWAREHK_CTRL?$AA@
; `string'
??_C@_0BA@HGKJNINO@SUREWAREHK_CTRL?$AA@	db 'SUREWAREHK_CTRL',0 ; DATA XREF: .data:00000284o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10h
; COMDAT (pick any)
		public ??_C@_0BG@KLANAAGK@SUREWAREHK_DH_EX_FREE?$AA@
; `string'
??_C@_0BG@KLANAAGK@SUREWAREHK_DH_EX_FREE?$AA@ db 'SUREWAREHK_DH_EX_FREE',0
					; DATA XREF: .data:0000028Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 28h
; COMDAT (pick any)
		public ??_C@_0BH@FCEJHEGJ@SUREWAREHK_DSA_DO_SIGN?$AA@
; `string'
??_C@_0BH@FCEJHEGJ@SUREWAREHK_DSA_DO_SIGN?$AA@ db 'SUREWAREHK_DSA_DO_SIGN',0
					; DATA XREF: .data:00000294o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 40h
; COMDAT (pick any)
		public ??_C@_0BD@MEGBHNJ@SUREWAREHK_EX_FREE?$AA@
; `string'
??_C@_0BD@MEGBHNJ@SUREWAREHK_EX_FREE?$AA@ db 'SUREWAREHK_EX_FREE',0
					; DATA XREF: .data:0000029Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 54h
; COMDAT (pick any)
		public ??_C@_0BC@LOFHCFGJ@SUREWAREHK_FINISH?$AA@
; `string'
??_C@_0BC@LOFHCFGJ@SUREWAREHK_FINISH?$AA@ db 'SUREWAREHK_FINISH',0
					; DATA XREF: .data:000002A4o
unk_66		db    ?	;		; DATA XREF: .data:00000150o
unk_67		db    ?	;		; DATA XREF: .data:00000158o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 68h
; COMDAT (pick any)
		public ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@
; `string'
??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@	db 'SUREWAREHK_INIT',0 ; DATA XREF: .data:00000160o
					; .data:000002ACo ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 78h
; COMDAT (pick any)
		public ??_C@_0BI@DPLNJAIG@SUREWAREHK_LOAD_PRIVKEY?$AA@
; `string'
??_C@_0BI@DPLNJAIG@SUREWAREHK_LOAD_PRIVKEY?$AA@	db 'SUREWAREHK_LOAD_PRIVKEY',0
					; DATA XREF: .data:000002B4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 90h
; COMDAT (pick any)
		public ??_C@_0BH@DOGOEMEK@SUREWAREHK_LOAD_PUBKEY?$AA@
; `string'
??_C@_0BH@DOGOEMEK@SUREWAREHK_LOAD_PUBKEY?$AA@ db 'SUREWAREHK_LOAD_PUBKEY',0
					; DATA XREF: .data:000002BCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A8h
; COMDAT (pick any)
		public ??_C@_0BC@OECBECCP@SUREWAREHK_MODEXP?$AA@
; `string'
??_C@_0BC@OECBECCP@SUREWAREHK_MODEXP?$AA@ db 'SUREWAREHK_MODEXP',0
					; DATA XREF: .data:000002C4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0BCh
; COMDAT (pick any)
		public ??_C@_0BG@MHOGLGBH@SUREWAREHK_RAND_BYTES?$AA@
; `string'
??_C@_0BG@MHOGLGBH@SUREWAREHK_RAND_BYTES?$AA@ db 'SUREWAREHK_RAND_BYTES',0
					; DATA XREF: .data:000002CCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D4h
; COMDAT (pick any)
		public ??_C@_0BF@IAMMANCG@SUREWAREHK_RAND_SEED?$AA@
; `string'
??_C@_0BF@IAMMANCG@SUREWAREHK_RAND_SEED?$AA@ db	'SUREWAREHK_RAND_SEED',0
					; DATA XREF: .data:000002D4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0ECh
; COMDAT (pick any)
		public ??_C@_0BI@EIJLNIKE@SUREWAREHK_RSA_PRIV_DEC?$AA@
; `string'
??_C@_0BI@EIJLNIKE@SUREWAREHK_RSA_PRIV_DEC?$AA@	db 'SUREWAREHK_RSA_PRIV_DEC',0
					; DATA XREF: .data:000002DCo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 104h
; COMDAT (pick any)
		public ??_C@_0BE@GDDIILKE@SUREWAREHK_RSA_SIGN?$AA@
; `string'
??_C@_0BE@GDDIILKE@SUREWAREHK_RSA_SIGN?$AA@ db 'SUREWAREHK_RSA_SIGN',0
					; DATA XREF: .data:000002E4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 118h
; COMDAT (pick any)
		public ??_C@_0BF@PBBAMLFB@SUREWARE_LOAD_PUBLIC?$AA@
; `string'
??_C@_0BF@PBBAMLFB@SUREWARE_LOAD_PUBLIC?$AA@ db	'SUREWARE_LOAD_PUBLIC',0
					; DATA XREF: .data:000002ECo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 130h
_SUREWARE_str_reasons dd offset	??_C@_0BC@LOFHCFGJ@SUREWAREHK_FINISH?$AA@+10h
					; DATA XREF: _ERR_load_SUREWARE_strings+31o
					; _ERR_unload_SUREWARE_strings+19o ...
					; "H"
		dd offset ??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@ ; "bio	was freed"
		dd offset ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@+1 ; "UREWAREHK_INIT"
		dd offset ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@ ; "missing key components"
		dd offset ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@+2 ; "REWAREHK_INIT"
		dd offset ??_C@_0BF@INPMJCDD@padding?5check?5failed?$AA@ ; "padding check failed"
		dd offset ??_C@_0BC@LOFHCFGJ@SUREWAREHK_FINISH?$AA@+11h	; ""
		dd offset ??_C@_0P@LMFGIOCF@request?5failed?$AA@ ; "request failed"
		dd offset unk_66
		dd offset ??_C@_0BB@PJKNAGAG@request?5fallback?$AA@ ; "request fallback"
		dd offset unk_67
		dd offset ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ ; "size too large or	too small"
		dd offset ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@ ; "SUREWAREHK_INIT"
		dd offset ??_C@_0N@JLJLJPMB@unit?5failure?$AA@ ; "unit failure"
		dd offset ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@+3 ; "EWAREHK_INIT"
		dd offset ??_C@_0BF@PMKFBMAN@unknown?5padding?5type?$AA@ ; "unknown padding type"
		dd 2 dup(0)
_SUREWARE_lib_name dd 0			; DATA XREF: _ERR_load_SUREWARE_strings+4Bo
					; _ERR_load_SUREWARE_strings+52w ...
		dd offset ??_C@_0BA@MINFHMCM@sureware?5engine?$AA@ ; "sureware engine"
		dd 2 dup(0)
_SUREWARE_error_init dd	1		; DATA XREF: _ERR_load_SUREWARE_strings:loc_DF3r
					; _ERR_load_SUREWARE_strings+22w ...
_surewarehk_rsa	dd offset ??_C@_0BE@JGLAFCE@SureWare?5RSA?5method?$AA@
					; DATA XREF: _bind_sureware+33o
					; "SureWare RSA	method"
dword_190	dd 0			; DATA XREF: _bind_sureware+10Fw
dword_194	dd 0			; DATA XREF: _bind_sureware+118w
		dd offset _surewarehk_rsa_sign
		dd offset _surewarehk_rsa_priv_dec
		dd 0
		dd offset _surewarehk_mod_exp_mont
		dd 7 dup(0)
_surewarehk_dh	dd offset ??_C@_0BD@OHIJCIOE@SureWare?5DH?5method?$AA@
					; DATA XREF: _bind_sureware+5Fo
					; "SureWare DH method"
dword_1C8	dd 0			; DATA XREF: _bind_sureware+13Aw
dword_1CC	dd 0			; DATA XREF: _bind_sureware+143w
		dd offset _surewarehk_modexp_dh
		dd 5 dup(0)
_surewarehk_rand dd offset _surewarehk_rand_seed ; DATA	XREF: _bind_sureware+75o
		dd offset _surewarehk_rand_bytes
		dd 0
		dd offset _surewarehk_rand_add
		dd offset _surewarehk_rand_bytes
		align 10h
_surewarehk_dsa	dd offset ??_C@_0BE@EPCIALKM@SureWare?5DSA?5method?$AA@
					; DATA XREF: _bind_sureware+49o
					; "SureWare DSA	method"
		dd offset _surewarehk_dsa_do_sign
		dd 0
dword_20C	dd 0			; DATA XREF: _bind_sureware+129w
		dd offset _surewarehk_dsa_mod_exp
		dd 7 dup(0)
_engine_sureware_id dd offset ??_C@_08JADBFLDL@sureware?$AA@ ; DATA XREF: _bind_engine+75r
					; _bind_helper+8r ...
					; "sureware"
_engine_sureware_name dd offset	??_C@_0CB@ICKMOIDH@SureWare?5hardware?5engine?5support@
					; DATA XREF: _bind_sureware+1Cr
					; "SureWare hardware engine support"
_rsaHndidx	dd 0FFFFFFFFh		; DATA XREF: _surewarehk_rsa_priv_dec:loc_4C8r
					; _surewarehk_rsa_sign:loc_6D2r ...
_dsaHndidx	dd 0FFFFFFFFh		; DATA XREF: _surewarehk_dsa_do_sign+97r
					; _sureware_load_public+B3r ...
_surewarehk_LIBNAME dd offset ??_C@_0N@IOFKCJPN@SureWareHook?$AA@
					; DATA XREF: _surewarehk_init+76r
					; "SureWareHook"
_n_surewarehk_Init dd offset ??_C@_0BC@NGCCCGIM@SureWareHook_Init?$AA@
					; DATA XREF: _surewarehk_init:loc_1974r
					; "SureWareHook_Init"
_n_surewarehk_Finish dd	offset ??_C@_0BE@EFLGKADN@SureWareHook_Finish?$AA@
					; DATA XREF: _surewarehk_init+C5r
					; "SureWareHook_Finish"
_n_surewarehk_Rand_Bytes dd offset ??_C@_0BI@NFGMAGC@SureWareHook_Rand_Bytes?$AA@
					; DATA XREF: _surewarehk_init+E3r
					; "SureWareHook_Rand_Bytes"
_n_surewarehk_Rand_Seed	dd offset ??_C@_0BH@LBBGNCBP@SureWareHook_Rand_Seed?$AA@
					; DATA XREF: _surewarehk_init+101r
					; "SureWareHook_Rand_Seed"
_n_surewarehk_Load_Privkey dd offset ??_C@_0BK@HJFKGBMO@SureWareHook_Load_Privkey?$AA@
					; DATA XREF: _surewarehk_init+121r
					; "SureWareHook_Load_Privkey"
_n_surewarehk_Info_Pubkey dd offset ??_C@_0BJ@LCOLHAFJ@SureWareHook_Info_Pubkey?$AA@
					; DATA XREF: _surewarehk_init+1E1r
					; "SureWareHook_Info_Pubkey"
_n_surewarehk_Load_Rsa_Pubkey dd offset	??_C@_0BN@GEGCLOHD@SureWareHook_Load_Rsa_Pubkey?$AA@
					; DATA XREF: _surewarehk_init+141r
					; "SureWareHook_Load_Rsa_Pubkey"
_n_surewarehk_Load_Dsa_Pubkey dd offset	??_C@_0BN@CCCBLAPL@SureWareHook_Load_Dsa_Pubkey?$AA@
					; DATA XREF: _surewarehk_init+201r
					; "SureWareHook_Load_Dsa_Pubkey"
_n_surewarehk_Free dd offset ??_C@_0BC@BEHOIDAO@SureWareHook_Free?$AA@
					; DATA XREF: _surewarehk_init+161r
					; "SureWareHook_Free"
_n_surewarehk_Rsa_Priv_Dec dd offset ??_C@_0BK@NJKEMIFA@SureWareHook_Rsa_Priv_Dec?$AA@
					; DATA XREF: _surewarehk_init+181r
					; "SureWareHook_Rsa_Priv_Dec"
_n_surewarehk_Rsa_Sign dd offset ??_C@_0BG@ELJJNHMK@SureWareHook_Rsa_Sign?$AA@
					; DATA XREF: _surewarehk_init+1A1r
					; "SureWareHook_Rsa_Sign"
_n_surewarehk_Dsa_Sign dd offset ??_C@_0BG@JEEDOMDB@SureWareHook_Dsa_Sign?$AA@
					; DATA XREF: _surewarehk_init+1C1r
					; "SureWareHook_Dsa_Sign"
_n_surewarehk_Mod_Exp dd offset	??_C@_0BF@PDEMAGG@SureWareHook_Mod_Exp?$AA@
					; DATA XREF: _surewarehk_init+221r
					; "SureWareHook_Mod_Exp"
_threadsafe	dd 1			; DATA XREF: _surewarehk_ctrl+5Cw
					; _surewarehk_init+243r ...
		align 10h
_SUREWARE_str_functs dd	64000h		; DATA XREF: _ERR_load_SUREWARE_strings+1Co
					; _ERR_unload_SUREWARE_strings+9o ...
		dd offset ??_C@_0BA@HGKJNINO@SUREWAREHK_CTRL?$AA@ ; "SUREWAREHK_CTRL"
		dd 70000h
		dd offset ??_C@_0BG@KLANAAGK@SUREWAREHK_DH_EX_FREE?$AA@	; "SUREWAREHK_DH_EX_FREE"
		dd 65000h
		dd offset ??_C@_0BH@FCEJHEGJ@SUREWAREHK_DSA_DO_SIGN?$AA@ ; "SUREWAREHK_DSA_DO_SIGN"
		dd 66000h
		dd offset ??_C@_0BD@MEGBHNJ@SUREWAREHK_EX_FREE?$AA@ ; "SUREWAREHK_EX_FREE"
		dd 67000h
		dd offset ??_C@_0BC@LOFHCFGJ@SUREWAREHK_FINISH?$AA@ ; "SUREWAREHK_FINISH"
		dd 68000h
		dd offset ??_C@_0BA@JBNFKDEM@SUREWAREHK_INIT?$AA@ ; "SUREWAREHK_INIT"
		dd 69000h
		dd offset ??_C@_0BI@DPLNJAIG@SUREWAREHK_LOAD_PRIVKEY?$AA@ ; "SUREWAREHK_LOAD_PRIVKEY"
		dd 71000h
		dd offset ??_C@_0BH@DOGOEMEK@SUREWAREHK_LOAD_PUBKEY?$AA@ ; "SUREWAREHK_LOAD_PUBKEY"
		dd 6B000h
		dd offset ??_C@_0BC@OECBECCP@SUREWAREHK_MODEXP?$AA@ ; "SUREWAREHK_MODEXP"
		dd 6C000h
		dd offset ??_C@_0BG@MHOGLGBH@SUREWAREHK_RAND_BYTES?$AA@	; "SUREWAREHK_RAND_BYTES"
		dd 6D000h
		dd offset ??_C@_0BF@IAMMANCG@SUREWAREHK_RAND_SEED?$AA@ ; "SUREWAREHK_RAND_SEED"
		dd 6E000h
		dd offset ??_C@_0BI@EIJLNIKE@SUREWAREHK_RSA_PRIV_DEC?$AA@ ; "SUREWAREHK_RSA_PRIV_DEC"
		dd 6F000h
		dd offset ??_C@_0BE@GDDIILKE@SUREWAREHK_RSA_SIGN?$AA@ ;	"SUREWAREHK_RSA_SIGN"
		dd 6A000h
		dd offset ??_C@_0BF@PBBAMLFB@SUREWARE_LOAD_PUBLIC?$AA@ ; "SUREWARE_LOAD_PUBLIC"
		dd 2 dup(0)
_data		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2F8h
; COMDAT (pick any)
		public ??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@
; `string'
??_C@_0O@LKOODKPM@bio?5was?5freed?$AA@ db 'bio was freed',0 ; DATA XREF: .data:00000134o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 308h
; COMDAT (pick any)
		public ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@
; `string'
??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@	db 'missing key components',0
					; DATA XREF: .data:0000013Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 320h
; COMDAT (pick any)
		public ??_C@_0BF@INPMJCDD@padding?5check?5failed?$AA@
; `string'
??_C@_0BF@INPMJCDD@padding?5check?5failed?$AA@ db 'padding check failed',0
					; DATA XREF: .data:00000144o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 338h
; COMDAT (pick any)
		public ??_C@_0P@LMFGIOCF@request?5failed?$AA@
; `string'
??_C@_0P@LMFGIOCF@request?5failed?$AA@ db 'request failed',0 ; DATA XREF: .data:0000014Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 348h
; COMDAT (pick any)
		public ??_C@_0BB@PJKNAGAG@request?5fallback?$AA@
; `string'
??_C@_0BB@PJKNAGAG@request?5fallback?$AA@ db 'request fallback',0
					; DATA XREF: .data:00000154o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 35Ch
; COMDAT (pick any)
		public ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@
; `string'
??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ db 'size too large or too small',0
					; DATA XREF: .data:0000015Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 378h
; COMDAT (pick any)
		public ??_C@_0N@JLJLJPMB@unit?5failure?$AA@
; `string'
??_C@_0N@JLJLJPMB@unit?5failure?$AA@ db	'unit failure',0 ; DATA XREF: .data:00000164o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 388h
; COMDAT (pick any)
		public ??_C@_0BF@PMKFBMAN@unknown?5padding?5type?$AA@
; `string'
??_C@_0BF@PMKFBMAN@unknown?5padding?5type?$AA@ db 'unknown padding type',0
					; DATA XREF: .data:0000016Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 3A0h
; COMDAT (pick any)
		public ??_C@_0BA@MINFHMCM@sureware?5engine?$AA@
; `string'
??_C@_0BA@MINFHMCM@sureware?5engine?$AA@ db 'sureware engine',0 ; DATA XREF: .data:0000017Co
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
		assume cs:_bss
		;org 3B0h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing
_SUREWARE_lib_error_code dd ?		; DATA XREF: _surewarehk_rsa_priv_dec+58r
					; _surewarehk_rsa_priv_dec+66w	...
_surewarehk_dso	dd ?			; DATA XREF: _surewarehk_finishr
					; _surewarehk_finish+36r ...
_p_surewarehk_Init dd ?			; DATA XREF: _surewarehk_finish+92w
					; _surewarehk_init+29Bw ...
_p_surewarehk_Finish dd	?		; DATA XREF: _surewarehk_finish:loc_17E0r
					; _surewarehk_finish+9Cw ...
_p_surewarehk_Rand_Bytes dd ?		; DATA XREF: _surewarehk_rand_bytes+41r
					; _surewarehk_finish+A6w ...
_p_surewarehk_Rand_Seed	dd ?		; DATA XREF: _surewarehk_rand_seed+3Dr
					; _surewarehk_finish+B0w ...
_p_surewarehk_Load_Privkey dd ?		; DATA XREF: _surewarehk_finish+BAw
					; _surewarehk_init+252w ...
_p_surewarehk_Info_Pubkey dd ?		; DATA XREF: _surewarehk_finish+F6w
					; _surewarehk_init+288w ...
_p_surewarehk_Load_Rsa_Pubkey dd ?	; DATA XREF: _sureware_load_public+58r
					; _sureware_load_public+317r ...
_p_surewarehk_Load_Dsa_Pubkey dd ?	; DATA XREF: _sureware_load_public+65r
					; _sureware_load_public+16Er ...
_p_surewarehk_Free dd ?			; DATA XREF: _surewarehk_ex_freer
					; _surewarehk_finish+CEw ...
_p_surewarehk_Rsa_Priv_Dec dd ?		; DATA XREF: _surewarehk_rsa_priv_dec+4Cr
					; _surewarehk_rsa_priv_dec+A1r	...
_p_surewarehk_Rsa_Sign dd ?		; DATA XREF: _surewarehk_rsa_sign+43r
					; _surewarehk_rsa_sign+FFr ...
_p_surewarehk_Dsa_Sign dd ?		; DATA XREF: _surewarehk_dsa_do_sign+50r
					; _surewarehk_dsa_do_sign+191r	...
_p_surewarehk_Mod_Exp dd ?		; DATA XREF: _surewarehk_finish+10Aw
					; _surewarehk_init+2ADw ...
_logstream	dd ?			; DATA XREF: _surewarehk_ctrl+87r
					; _surewarehk_ctrl+9Cw	...
_bss		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl surewarehk_rsa_priv_dec(int, int,	void *Src, int,	int)
_surewarehk_rsa_priv_dec proc near	; DATA XREF: .data:0000019Co

Size		= dword	ptr -48h
var_44		= xmmword ptr -44h
var_34		= dword	ptr -34h
Dst		= byte ptr -30h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		mov	eax, ds:dword_2198
		movups	xmm0, ds:??_C@_0BE@FFBAHKOB@ENGINE_rsa_priv_dec?$AA@ ; `string'
		push	ebx
		mov	ebx, [esp+4Ch+arg_4]
		push	ebp
		mov	ebp, [esp+50h+Src]
		push	esi
		push	edi
		mov	edi, [esp+58h+arg_C]
		xor	esi, esi
		push	2Ch ; ','       ; Size
		mov	[esp+5Ch+var_34], eax
		lea	eax, [esp+5Ch+Dst]
		push	esi		; Val
		push	eax		; Dst
		movups	[esp+64h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_p_surewarehk_Rsa_Priv_Dec, esi
		jnz	loc_4C8
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_45B
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_45B:				; CODE XREF: _surewarehk_rsa_priv_dec+5Fj
		push	38Fh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	6Eh ; 'n'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_472:				; CODE XREF: _surewarehk_rsa_priv_dec+EBj
		mov	edi, [esp+58h+arg_10]
		lea	eax, [esp+58h+Size]
		cmp	edi, 1
		jnz	loc_51C
		push	edi
		push	esi
		push	ebp
		push	eax
		push	ebx
		push	[esp+6Ch+arg_0]
		lea	eax, [esp+70h+var_44]
		push	eax
		call	ds:_p_surewarehk_Rsa_Priv_Dec
		mov	esi, eax
		lea	eax, [esp+74h+var_44]
		push	esi
		push	6Eh ; 'n'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 28h
		cmp	esi, edi
		jnz	loc_641
		mov	eax, [esp+58h+Size]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_4C8:				; CODE XREF: _surewarehk_rsa_priv_dec+52j
		push	ds:_rsaHndidx
		push	edi
		call	_RSA_get_ex_data
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_472
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_4F0
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_4F0:				; CODE XREF: _surewarehk_rsa_priv_dec+F4j
		push	394h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	69h ; 'i'
		push	6Eh ; 'n'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_51C:				; CODE XREF: _surewarehk_rsa_priv_dec+8Dj
		push	0
		push	esi
		push	ebp
		push	eax
		push	ebx
		push	[esp+6Ch+arg_0]
		lea	eax, [esp+70h+var_44]
		push	eax
		call	ds:_p_surewarehk_Rsa_Priv_Dec
		mov	esi, eax
		lea	eax, [esp+74h+var_44]
		push	esi
		push	6Eh ; 'n'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 28h
		cmp	esi, 1
		jnz	loc_641
		push	3ACh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	[esp+60h+Size]
		call	_CRYPTO_malloc
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_5A7
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_57B
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_57B:				; CODE XREF: _surewarehk_rsa_priv_dec+17Fj
		push	3AEh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	41h ; 'A'
		push	6Eh ; 'n'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_5A7:				; CODE XREF: _surewarehk_rsa_priv_dec+176j
		push	[esp+58h+Size]	; Size
		push	ebp		; Src
		push	ebx		; Dst
		call	_memcpy
		add	esp, 0Ch
		sub	edi, 2
		jz	short loc_5FD
		sub	edi, 1
		jz	short loc_5E9
		sub	edi, 1
		jz	short loc_5D2
		push	3C6h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	6Bh ; 'k'
		jmp	short loc_624
; ---------------------------------------------------------------------------

loc_5D2:				; CODE XREF: _surewarehk_rsa_priv_dec+1D2j
		mov	eax, [esp+58h+Size]
		push	0
		push	0
		push	eax
		push	eax
		push	ebx
		push	eax
		push	ebp
		call	_RSA_padding_check_PKCS1_OAEP
		add	esp, 1Ch
		jmp	short loc_612
; ---------------------------------------------------------------------------

loc_5E9:				; CODE XREF: _surewarehk_rsa_priv_dec+1CDj
		mov	eax, [esp+58h+Size]
		mov	ecx, [esp+58h+arg_0]
		push	eax
		push	ecx
		push	ebx
		push	eax
		push	ebp
		call	_RSA_padding_check_none
		jmp	short loc_60F
; ---------------------------------------------------------------------------

loc_5FD:				; CODE XREF: _surewarehk_rsa_priv_dec+1C8j
		mov	eax, [esp+58h+Size]
		mov	ecx, [esp+58h+arg_0]
		push	eax
		push	ecx
		push	ebx
		push	eax
		push	ebp
		call	_RSA_padding_check_SSLv23

loc_60F:				; CODE XREF: _surewarehk_rsa_priv_dec+20Bj
		add	esp, 14h

loc_612:				; CODE XREF: _surewarehk_rsa_priv_dec+1F7j
		mov	esi, eax
		test	esi, esi
		jns	short $err$35
		push	3CBh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	6Ah ; 'j'

loc_624:				; CODE XREF: _surewarehk_rsa_priv_dec+1E0j
		push	6Eh ; 'n'
		call	_ERR_SUREWARE_error
		add	esp, 10h

$err$35:				; CODE XREF: _surewarehk_rsa_priv_dec+226j
		push	[esp+58h+Size]
		push	ebx
		call	_OPENSSL_cleanse
		push	ebx
		call	_CRYPTO_free
		add	esp, 0Ch

loc_641:				; CODE XREF: _surewarehk_rsa_priv_dec+BBj
					; _surewarehk_rsa_priv_dec+156j
		mov	ecx, [esp+58h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_surewarehk_rsa_priv_dec endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 658h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_rsa_sign proc near		; DATA XREF: .data:00000198o

var_48		= dword	ptr -48h
var_44		= xmmword ptr -44h
Dst		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		movups	xmm0, ds:??_C@_0BA@CKPMAPPD@ENGINE_rsa_sign?$AA@ ; `string'
		push	ebx
		mov	ebx, [esp+4Ch+arg_4]
		lea	eax, [esp+4Ch+Dst]
		push	ebp
		mov	ebp, [esp+50h+arg_8]
		push	esi
		push	edi
		mov	edi, [esp+58h+arg_C]
		xor	esi, esi
		push	30h ; '0'       ; Size
		push	esi		; Val
		push	eax		; Dst
		movups	[esp+64h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_p_surewarehk_Rsa_Sign, esi
		jnz	short loc_6D2
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_6B6
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_6B6:				; CODE XREF: _surewarehk_rsa_sign+52j
		push	3DFh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	6Fh ; 'o'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_76F
; ---------------------------------------------------------------------------

loc_6D2:				; CODE XREF: _surewarehk_rsa_sign+49j
		push	ds:_rsaHndidx
		push	edi
		call	_RSA_get_ex_data
		add	esp, 8
		test	eax, eax
		jnz	short loc_711
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_6F8
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_6F8:				; CODE XREF: _surewarehk_rsa_sign+94j
		push	3E4h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	69h ; 'i'
		push	6Fh ; 'o'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_76F
; ---------------------------------------------------------------------------

loc_711:				; CODE XREF: _surewarehk_rsa_sign+8Bj
		sub	[esp+58h+arg_10], 1
		jz	short loc_744
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_72B
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_72B:				; CODE XREF: _surewarehk_rsa_sign+C7j
		push	3F1h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	6Bh ; 'k'
		push	6Fh ; 'o'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_76F
; ---------------------------------------------------------------------------

loc_744:				; CODE XREF: _surewarehk_rsa_sign+BEj
		push	1
		push	eax
		push	ebp
		lea	eax, [esp+64h+var_48]
		push	eax
		push	ebx
		push	[esp+6Ch+arg_0]
		lea	eax, [esp+70h+var_44]
		push	eax
		call	ds:_p_surewarehk_Rsa_Sign
		mov	esi, eax
		lea	eax, [esp+74h+var_44]
		push	esi
		push	6Fh ; 'o'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 28h

loc_76F:				; CODE XREF: _surewarehk_rsa_sign+75j
					; _surewarehk_rsa_sign+B7j ...
		mov	ecx, [esp+58h+var_4]
		cmp	esi, 1
		pop	edi
		cmovz	esi, [esp+54h+var_48]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_surewarehk_rsa_sign endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 78Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_rand_bytes proc near	; DATA XREF: .data:000001ECo
					; .data:000001F8o

var_44		= xmmword ptr -44h
var_34		= word ptr -34h
Dst		= byte ptr -32h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 44h ; 'D'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	ax, ds:word_2130
		movups	xmm0, ds:??_C@_0BC@EDMLEKPB@ENGINE_rand_bytes?$AA@ ; `string'
		push	esi
		push	edi
		mov	edi, [esp+4Ch+arg_0]
		xor	esi, esi
		push	2Eh ; '.'       ; Size
		mov	[esp+50h+var_34], ax
		lea	eax, [esp+50h+Dst]
		push	esi		; Val
		push	eax		; Dst
		movups	[esp+58h+var_44], xmm0
		call	_memset
		mov	eax, ds:_p_surewarehk_Rand_Bytes
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_805
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_7EC
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_7EC:				; CODE XREF: _surewarehk_rand_bytes+54j
		push	293h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	6Ch ; 'l'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_823
; ---------------------------------------------------------------------------

loc_805:				; CODE XREF: _surewarehk_rand_bytes+4Bj
		push	[esp+4Ch+arg_4]
		lea	ecx, [esp+50h+var_44]
		push	edi
		push	ecx
		call	eax ; _p_surewarehk_Rand_Bytes
		mov	esi, eax
		lea	eax, [esp+58h+var_44]
		push	esi
		push	6Ch ; 'l'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 18h

loc_823:				; CODE XREF: _surewarehk_rand_bytes+77j
		mov	ecx, [esp+4Ch+var_4]
		xor	eax, eax
		cmp	esi, 1
		pop	edi
		setz	al
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
_surewarehk_rand_bytes endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 83Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_rand_seed proc near		; CODE XREF: _surewarehk_rand_add+8p
					; DATA XREF: .data:_surewarehk_rando

var_44		= xmmword ptr -44h
var_34		= byte ptr -34h
Dst		= byte ptr -33h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 44h ; 'D'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	al, ds:byte_2144
		movups	xmm0, ds:??_C@_0BB@CIBPBFPN@ENGINE_rand_seed?$AA@ ; `string'
		push	esi
		mov	esi, [esp+48h+arg_0]
		push	2Fh ; '/'       ; Size
		mov	[esp+4Ch+var_34], al
		lea	eax, [esp+4Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		movups	[esp+54h+var_44], xmm0
		call	_memset
		mov	eax, ds:_p_surewarehk_Rand_Seed
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_8BF
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_898
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_898:				; CODE XREF: _surewarehk_rand_seed+50j
		push	2A1h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	6Dh ; 'm'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		pop	esi
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_8BF:				; CODE XREF: _surewarehk_rand_seed+47j
		push	[esp+48h+arg_4]
		lea	ecx, [esp+4Ch+var_44]
		push	esi
		push	ecx
		call	eax ; _p_surewarehk_Rand_Seed
		push	eax
		lea	eax, [esp+58h+var_44]
		push	6Dh ; 'm'
		push	eax
		call	_surewarehk_error_handling
		mov	ecx, [esp+60h+var_4]
		add	esp, 18h
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
_surewarehk_rand_seed endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8ECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_rand_add proc near		; DATA XREF: .data:000001F4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		call	_surewarehk_rand_seed
		add	esp, 8
		retn
_surewarehk_rand_add endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 900h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_mod_exp_mont proc near	; DATA XREF: .data:000001A4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_surewarehk_modexp
		add	esp, 14h
		retn
_surewarehk_mod_exp_mont endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 920h
; COMDAT (pick any)
		public ??_C@_0BE@JGLAFCE@SureWare?5RSA?5method?$AA@
; `string'
??_C@_0BE@JGLAFCE@SureWare?5RSA?5method?$AA@ db	'SureWare RSA method',0
					; DATA XREF: .data:_surewarehk_rsao
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 934h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_modexp_dh proc near		; DATA XREF: .data:000001D0o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	[esp+arg_14]
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		call	_surewarehk_modexp
		add	esp, 14h
		retn
_surewarehk_modexp_dh endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 954h
; COMDAT (pick any)
		public ??_C@_0BD@OHIJCIOE@SureWare?5DH?5method?$AA@
; `string'
??_C@_0BD@OHIJCIOE@SureWare?5DH?5method?$AA@ db	'SureWare DH method',0
					; DATA XREF: .data:_surewarehk_dho
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 968h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_dsa_do_sign	proc near	; DATA XREF: .data:00000204o

var_44		= xmmword ptr -44h
var_34		= word ptr -34h
var_32		= byte ptr -32h
Dst		= byte ptr -31h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 44h ; 'D'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	ax, ds:word_21BC
		movups	xmm0, ds:??_C@_0BD@PCALNPLJ@ENGINE_dsa_do_sign?$AA@ ; `string'
		push	ebx
		mov	ebx, [esp+48h+arg_0]
		push	esi
		mov	esi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_34], ax
		mov	al, ds:byte_21BE
		push	2Dh ; '-'       ; Size
		mov	[esp+50h+var_32], al
		lea	eax, [esp+50h+Dst]
		push	0		; Val
		push	eax		; Dst
		movups	[esp+58h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_p_surewarehk_Dsa_Sign, 0
		jnz	short loc_9FE
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_9D4
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_9D4:				; CODE XREF: _surewarehk_dsa_do_sign+60j
		push	404h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_9FE:				; CODE XREF: _surewarehk_dsa_do_sign+57j
		push	edi
		push	ds:_dsaHndidx
		push	esi
		call	_DSA_get_ex_data
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_A52
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_A27
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_A27:				; CODE XREF: _surewarehk_dsa_do_sign+B3j
		push	40Ah
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	69h ; 'i'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_A52:				; CODE XREF: _surewarehk_dsa_do_sign+AAj
		call	_DSA_SIG_new
		mov	esi, eax
		test	esi, esi
		jnz	short loc_A9B
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_A70
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_A70:				; CODE XREF: _surewarehk_dsa_do_sign+FCj
		push	40Fh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	41h ; 'A'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_A9B:				; CODE XREF: _surewarehk_dsa_do_sign+F3j
		call	_BN_new
		mov	[esi], eax
		call	_BN_new
		mov	ecx, [esi]
		mov	[esi+4], eax
		test	ecx, ecx
		jz	$err$46
		test	eax, eax
		jz	$err$46
		push	5
		push	ecx
		call	_bn_expand2
		push	5
		push	dword ptr [esi+4]
		call	_bn_expand2
		mov	ecx, [esi]
		add	esp, 10h
		cmp	dword ptr [ecx+8], 5
		jnz	$err$46
		mov	eax, [esi+4]
		cmp	dword ptr [eax+8], 5
		jnz	$err$46
		push	edi
		push	dword ptr [eax]
		lea	eax, [esp+58h+var_44]
		push	dword ptr [ecx]
		push	ebx
		push	[esp+60h+arg_4]
		push	eax
		call	ds:_p_surewarehk_Dsa_Sign
		push	eax
		lea	eax, [esp+6Ch+var_44]
		push	65h ; 'e'
		push	eax
		call	_surewarehk_error_handling
		mov	eax, [esi]
		add	esp, 24h
		mov	dword ptr [eax+4], 5
		mov	edi, [esi]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jle	short loc_B3A
		mov	eax, [edi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_B29:				; CODE XREF: _surewarehk_dsa_do_sign+1CDj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_B37
		dec	ecx
		test	ecx, ecx
		jg	short loc_B29

loc_B37:				; CODE XREF: _surewarehk_dsa_do_sign+1C8j
		mov	[edi+4], ecx

loc_B3A:				; CODE XREF: _surewarehk_dsa_do_sign+1B7j
		mov	eax, [esi+4]
		mov	dword ptr [eax+4], 5
		mov	edi, [esi+4]
		mov	ecx, [edi+4]
		test	ecx, ecx
		jle	short $err$46
		mov	eax, [edi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		xchg	ax, ax

loc_B58:				; CODE XREF: _surewarehk_dsa_do_sign+1FCj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_B66
		dec	ecx
		test	ecx, ecx
		jg	short loc_B58

loc_B66:				; CODE XREF: _surewarehk_dsa_do_sign+1F7j
		mov	[edi+4], ecx

$err$46:				; CODE XREF: _surewarehk_dsa_do_sign+146j
					; _surewarehk_dsa_do_sign+14Ej	...
		push	esi
		call	_DSA_SIG_free
		mov	ecx, [esp+54h+var_4]
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
_surewarehk_dsa_do_sign	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B88h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_dsa_mod_exp	proc near	; DATA XREF: .data:00000210o

var_14		= byte ptr -14h
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, 14h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		lea	eax, [esp+20h+var_14]
		xor	esi, esi
		push	edi
		push	eax
		call	_BN_init
		mov	edi, [esp+28h+arg_1C]
		mov	ebx, [esp+28h+arg_18]
		mov	ebp, [esp+28h+arg_4]
		push	edi
		push	ebx
		push	[esp+30h+arg_C]
		push	[esp+34h+arg_8]
		push	ebp
		call	_surewarehk_modexp
		add	esp, 18h
		test	eax, eax
		jz	short $end$7
		push	edi
		push	ebx
		push	[esp+2Ch+arg_14]
		lea	eax, [esp+30h+var_14]
		push	[esp+30h+arg_10]
		push	eax
		call	_surewarehk_modexp
		add	esp, 14h
		test	eax, eax
		jz	short $end$7
		push	edi
		push	ebx
		lea	eax, [esp+2Ch+var_14]
		push	eax
		push	ebp
		push	ebp
		call	_BN_mod_mul
		add	esp, 14h
		mov	ecx, 1
		test	eax, eax
		cmovnz	esi, ecx

$end$7:					; CODE XREF: _surewarehk_dsa_mod_exp+3Bj
					; _surewarehk_dsa_mod_exp+56j
		lea	eax, [esp+24h+var_14]
		push	eax
		call	_BN_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
_surewarehk_dsa_mod_exp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C14h
; COMDAT (pick any)
		public ??_C@_0BE@EPCIALKM@SureWare?5DSA?5method?$AA@
; `string'
??_C@_0BE@EPCIALKM@SureWare?5DSA?5method?$AA@ db 'SureWare DSA method',0
					; DATA XREF: .data:_surewarehk_dsao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C28h
; COMDAT (pick any)
		public ??_C@_08JADBFLDL@sureware?$AA@
; `string'
??_C@_08JADBFLDL@sureware?$AA@ db 'sureware',0 ; DATA XREF: .data:_engine_sureware_ido
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C34h
; COMDAT (pick any)
		public ??_C@_0CB@ICKMOIDH@SureWare?5hardware?5engine?5support@
; `string'
??_C@_0CB@ICKMOIDH@SureWare?5hardware?5engine?5support@	db 'SureWare hardware engine support',0
					; DATA XREF: .data:_engine_sureware_nameo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C58h
; COMDAT (pick any)
		public ??_C@_0N@IOFKCJPN@SureWareHook?$AA@
; `string'
??_C@_0N@IOFKCJPN@SureWareHook?$AA@ db 'SureWareHook',0
					; DATA XREF: .data:_surewarehk_LIBNAMEo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C68h
; COMDAT (pick any)
		public ??_C@_0BC@NGCCCGIM@SureWareHook_Init?$AA@
; `string'
??_C@_0BC@NGCCCGIM@SureWareHook_Init?$AA@ db 'SureWareHook_Init',0
					; DATA XREF: .data:_n_surewarehk_Inito
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C7Ch
; COMDAT (pick any)
		public ??_C@_0BE@EFLGKADN@SureWareHook_Finish?$AA@
; `string'
??_C@_0BE@EFLGKADN@SureWareHook_Finish?$AA@ db 'SureWareHook_Finish',0
					; DATA XREF: .data:_n_surewarehk_Finisho
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C90h
; COMDAT (pick any)
		public ??_C@_0BI@NFGMAGC@SureWareHook_Rand_Bytes?$AA@
; `string'
??_C@_0BI@NFGMAGC@SureWareHook_Rand_Bytes?$AA@ db 'SureWareHook_Rand_Bytes',0
					; DATA XREF: .data:_n_surewarehk_Rand_Byteso
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CA8h
; COMDAT (pick any)
		public ??_C@_0BH@LBBGNCBP@SureWareHook_Rand_Seed?$AA@
; `string'
??_C@_0BH@LBBGNCBP@SureWareHook_Rand_Seed?$AA@ db 'SureWareHook_Rand_Seed',0
					; DATA XREF: .data:_n_surewarehk_Rand_Seedo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CC0h
; COMDAT (pick any)
		public ??_C@_0BK@HJFKGBMO@SureWareHook_Load_Privkey?$AA@
; `string'
??_C@_0BK@HJFKGBMO@SureWareHook_Load_Privkey?$AA@ db 'SureWareHook_Load_Privkey',0
					; DATA XREF: .data:_n_surewarehk_Load_Privkeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CDCh
; COMDAT (pick any)
		public ??_C@_0BJ@LCOLHAFJ@SureWareHook_Info_Pubkey?$AA@
; `string'
??_C@_0BJ@LCOLHAFJ@SureWareHook_Info_Pubkey?$AA@ db 'SureWareHook_Info_Pubkey',0
					; DATA XREF: .data:_n_surewarehk_Info_Pubkeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CF8h
; COMDAT (pick any)
		public ??_C@_0BN@GEGCLOHD@SureWareHook_Load_Rsa_Pubkey?$AA@
; `string'
??_C@_0BN@GEGCLOHD@SureWareHook_Load_Rsa_Pubkey?$AA@ db	'SureWareHook_Load_Rsa_Pubkey',0
					; DATA XREF: .data:_n_surewarehk_Load_Rsa_Pubkeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D18h
; COMDAT (pick any)
		public ??_C@_0BN@CCCBLAPL@SureWareHook_Load_Dsa_Pubkey?$AA@
; `string'
??_C@_0BN@CCCBLAPL@SureWareHook_Load_Dsa_Pubkey?$AA@ db	'SureWareHook_Load_Dsa_Pubkey',0
					; DATA XREF: .data:_n_surewarehk_Load_Dsa_Pubkeyo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D38h
; COMDAT (pick any)
		public ??_C@_0BC@BEHOIDAO@SureWareHook_Free?$AA@
; `string'
??_C@_0BC@BEHOIDAO@SureWareHook_Free?$AA@ db 'SureWareHook_Free',0
					; DATA XREF: .data:_n_surewarehk_Freeo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D4Ch
; COMDAT (pick any)
		public ??_C@_0BK@NJKEMIFA@SureWareHook_Rsa_Priv_Dec?$AA@
; `string'
??_C@_0BK@NJKEMIFA@SureWareHook_Rsa_Priv_Dec?$AA@ db 'SureWareHook_Rsa_Priv_Dec',0
					; DATA XREF: .data:_n_surewarehk_Rsa_Priv_Deco
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D68h
; COMDAT (pick any)
		public ??_C@_0BG@ELJJNHMK@SureWareHook_Rsa_Sign?$AA@
; `string'
??_C@_0BG@ELJJNHMK@SureWareHook_Rsa_Sign?$AA@ db 'SureWareHook_Rsa_Sign',0
					; DATA XREF: .data:_n_surewarehk_Rsa_Signo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D80h
; COMDAT (pick any)
		public ??_C@_0BG@JEEDOMDB@SureWareHook_Dsa_Sign?$AA@
; `string'
??_C@_0BG@JEEDOMDB@SureWareHook_Dsa_Sign?$AA@ db 'SureWareHook_Dsa_Sign',0
					; DATA XREF: .data:_n_surewarehk_Dsa_Signo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D98h
; COMDAT (pick any)
		public ??_C@_0BF@PDEMAGG@SureWareHook_Mod_Exp?$AA@
; `string'
??_C@_0BF@PDEMAGG@SureWareHook_Mod_Exp?$AA@ db 'SureWareHook_Mod_Exp',0
					; DATA XREF: .data:_n_surewarehk_Mod_Expo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DB0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_SUREWARE_error proc near		; CODE XREF: _surewarehk_rsa_priv_dec+236p
					; _sureware_load_public+19Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_DC3
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_DC3:				; CODE XREF: _ERR_SUREWARE_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_SUREWARE_error endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DE0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_SUREWARE_strings proc	near	; CODE XREF: _bind_sureware:loc_10E4p
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_DF3
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_DF3:				; CODE XREF: _ERR_load_SUREWARE_strings+7j
		cmp	ds:_SUREWARE_error_init, 0
		jz	short locret_E3F
		push	offset _SUREWARE_str_functs
		push	eax
		mov	ds:_SUREWARE_error_init, 0
		call	_ERR_load_strings
		push	offset _SUREWARE_str_reasons
		push	ds:_SUREWARE_lib_error_code
		call	_ERR_load_strings
		movzx	eax, byte ptr ds:_SUREWARE_lib_error_code
		shl	eax, 18h
		push	offset _SUREWARE_lib_name
		push	0
		mov	ds:_SUREWARE_lib_name, eax
		call	_ERR_load_strings
		add	esp, 18h

locret_E3F:				; CODE XREF: _ERR_load_SUREWARE_strings+1Aj
		retn
_ERR_load_SUREWARE_strings endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E40h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_SUREWARE_strings proc near
		cmp	ds:_SUREWARE_error_init, 0
		jnz	short locret_E82
		push	offset _SUREWARE_str_functs
		push	ds:_SUREWARE_lib_error_code
		call	_ERR_unload_strings
		push	offset _SUREWARE_str_reasons
		push	ds:_SUREWARE_lib_error_code
		call	_ERR_unload_strings
		push	offset _SUREWARE_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	ds:_SUREWARE_error_init, 1

locret_E82:				; CODE XREF: _ERR_unload_SUREWARE_strings+7j
		retn
_ERR_unload_SUREWARE_strings endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E84h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$19
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_EAB

loc_EA7:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_EAB:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_EA7
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_EA7

$skip_cbs$19:				; CODE XREF: _bind_engine+Cj
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	short loc_F31
		mov	ecx, ds:_engine_sureware_id
		nop	dword ptr [eax+eax+00h]

loc_F04:				; CODE XREF: _bind_engine+9Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_F24
		test	dl, dl
		jz	short loc_F20
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_F24
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_F04

loc_F20:				; CODE XREF: _bind_engine+88j
		xor	eax, eax
		jmp	short loc_F29
; ---------------------------------------------------------------------------

loc_F24:				; CODE XREF: _bind_engine+84j
					; _bind_engine+90j
		sbb	eax, eax
		or	eax, 1

loc_F29:				; CODE XREF: _bind_engine+9Ej
		test	eax, eax
		jnz	loc_EA7

loc_F31:				; CODE XREF: _bind_engine+73j
		push	[esp+4+arg_0]
		call	_bind_sureware
		add	esp, 4
		test	eax, eax
		jz	loc_EA7
		mov	eax, 1
		pop	esi
		retn
_bind_engine	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_F88
		mov	ecx, ds:_engine_sureware_id
		xchg	ax, ax

loc_F5C:				; CODE XREF: _bind_helper+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_F7C
		test	dl, dl
		jz	short loc_F78
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_F7C
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_F5C

loc_F78:				; CODE XREF: _bind_helper+18j
		xor	eax, eax
		jmp	short loc_F81
; ---------------------------------------------------------------------------

loc_F7C:				; CODE XREF: _bind_helper+14j
					; _bind_helper+20j
		sbb	eax, eax
		or	eax, 1

loc_F81:				; CODE XREF: _bind_helper+2Ej
		test	eax, eax
		jz	short loc_F88
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_F88:				; CODE XREF: _bind_helper+6j
					; _bind_helper+37j
		push	[esp+arg_0]
		call	_bind_sureware
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_helper	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F9Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_sureware	proc near		; CODE XREF: _bind_engine+B1p
					; _bind_helper+40p

arg_0		= dword	ptr  4

		push	esi
		push	ds:_engine_sureware_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	ds:_engine_sureware_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_dsa
		push	esi
		call	_ENGINE_set_DSA
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_dh
		push	esi
		call	_ENGINE_set_DH
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_rand
		push	esi
		call	_ENGINE_set_RAND
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	loc_10F0
		push	offset _surewarehk_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	short loc_10F0
		push	offset _surewarehk_load_privkey
		push	esi
		call	_ENGINE_set_load_privkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_10F0
		push	offset _surewarehk_load_pubkey
		push	esi
		call	_ENGINE_set_load_pubkey_function
		add	esp, 8
		test	eax, eax
		jz	short loc_10F0
		call	_RSA_PKCS1_SSLeay
		test	eax, eax
		jz	short loc_10B9
		mov	ecx, [eax+4]
		mov	ds:dword_190, ecx
		mov	eax, [eax+8]
		mov	ds:dword_194, eax

loc_10B9:				; CODE XREF: _bind_sureware+10Aj
		call	_DSA_OpenSSL
		test	eax, eax
		jz	short loc_10CA
		mov	eax, [eax+0Ch]
		mov	ds:dword_20C, eax

loc_10CA:				; CODE XREF: _bind_sureware+124j
		call	_DH_OpenSSL
		test	eax, eax
		jz	short loc_10E4
		mov	ecx, [eax+4]
		mov	ds:dword_1C8, ecx
		mov	eax, [eax+8]
		mov	ds:dword_1CC, eax

loc_10E4:				; CODE XREF: _bind_sureware+135j
		call	_ERR_load_SUREWARE_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10F0:				; CODE XREF: _bind_sureware+16j
					; _bind_sureware+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_sureware	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10F4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_sureware_load_public proc near		; CODE XREF: _surewarehk_load_privkey+119p
					; _surewarehk_load_pubkey+115p

var_48		= dword	ptr -48h
var_44		= xmmword ptr -44h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
Dst		= byte ptr -2Fh
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h

		mov	eax, 48h ; 'H'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		mov	eax, ds:dword_2158
		movups	xmm0, ds:??_C@_0BF@CMPBHEOJ@sureware_load_public?$AA@ ;	`string'
		push	ebx
		mov	ebx, [esp+4Ch+arg_8]
		push	ebp
		mov	ebp, [esp+50h+arg_4]
		push	esi
		mov	esi, [esp+54h+arg_0]
		push	edi
		mov	[esp+58h+var_34], eax
		mov	al, ds:byte_215C
		push	2Bh ; '+'       ; Size
		mov	[esp+5Ch+var_30], al
		lea	eax, [esp+5Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+64h+var_48], ebp
		movups	[esp+64h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_p_surewarehk_Load_Rsa_Pubkey, 0
		jz	loc_14DD
		cmp	ds:_p_surewarehk_Load_Dsa_Pubkey, 0
		jz	loc_14DD
		movsx	eax, [esp+58h+arg_10]
		sub	eax, 1
		jz	loc_139D
		sub	eax, 1
		jz	short loc_11A0
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_118C
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_118C:				; CODE XREF: _sureware_load_public+8Cj
		push	320h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	80h ; ''
		jmp	loc_14FC
; ---------------------------------------------------------------------------

loc_11A0:				; CODE XREF: _sureware_load_public+83j
		push	esi
		call	_DSA_new_method
		push	ebx
		push	ds:_dsaHndidx
		mov	edi, eax
		push	edi
		call	_DSA_set_ex_data
		add	esp, 10h
		call	_BN_new
		mov	[edi+18h], eax
		call	_BN_new
		mov	[edi+0Ch], eax
		call	_BN_new
		mov	[edi+10h], eax
		call	_BN_new
		mov	ecx, [edi+18h]
		mov	[edi+14h], eax
		test	ecx, ecx
		jz	loc_1298
		cmp	dword ptr [edi+0Ch], 0
		jz	loc_1298
		cmp	dword ptr [edi+10h], 0
		jz	loc_1298
		test	eax, eax
		jz	loc_1298
		mov	esi, [esp+58h+arg_C]
		mov	ebx, esi
		shr	ebx, 2
		push	ebx
		push	ecx
		call	_bn_expand2
		push	ebx
		push	dword ptr [edi+0Ch]
		call	_bn_expand2
		push	5
		push	dword ptr [edi+10h]
		call	_bn_expand2
		push	ebx
		push	dword ptr [edi+14h]
		call	_bn_expand2
		mov	ebp, [edi+18h]
		add	esp, 20h
		cmp	[ebp+8], ebx
		jnz	short loc_1298
		mov	eax, [edi+0Ch]
		cmp	[eax+8], ebx
		jnz	short loc_1298
		mov	ecx, [edi+10h]
		cmp	dword ptr [ecx+8], 5
		jnz	short loc_1298
		mov	edx, [edi+14h]
		cmp	[edx+8], ebx
		jnz	short loc_1298
		push	dword ptr [edx]
		push	dword ptr [ecx]
		push	dword ptr [eax]
		lea	eax, [esp+64h+var_44]
		push	dword ptr [ebp+0]
		push	esi
		push	[esp+6Ch+var_48]
		push	eax
		call	ds:_p_surewarehk_Load_Dsa_Pubkey
		mov	esi, eax
		lea	eax, [esp+74h+var_44]
		push	esi
		push	6Ah ; 'j'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 28h
		cmp	esi, 1
		jz	short loc_12B6
		push	30Ah
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	81h ; ''
		push	6Ah ; 'j'
		call	_ERR_SUREWARE_error
		add	esp, 10h

loc_1298:				; CODE XREF: _sureware_load_public+E9j
					; _sureware_load_public+F3j ...
		push	edi
		call	_DSA_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_12B6:				; CODE XREF: _sureware_load_public+189j
		mov	eax, [edi+18h]
		mov	[eax+4], ebx
		mov	esi, [edi+18h]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_12E5
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop	word ptr [eax+eax+00h]

loc_12D4:				; CODE XREF: _sureware_load_public+1ECj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_12E2
		dec	ecx
		test	ecx, ecx
		jg	short loc_12D4

loc_12E2:				; CODE XREF: _sureware_load_public+1E7j
		mov	[esi+4], ecx

loc_12E5:				; CODE XREF: _sureware_load_public+1D0j
		mov	eax, [edi+0Ch]
		mov	[eax+4], ebx
		mov	esi, [edi+0Ch]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_1315
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop	dword ptr [eax+00000000h]

loc_1304:				; CODE XREF: _sureware_load_public+21Cj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1312
		dec	ecx
		test	ecx, ecx
		jg	short loc_1304

loc_1312:				; CODE XREF: _sureware_load_public+217j
		mov	[esi+4], ecx

loc_1315:				; CODE XREF: _sureware_load_public+1FFj
		mov	eax, [edi+10h]
		mov	dword ptr [eax+4], 5
		mov	esi, [edi+10h]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_1345
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop	dword ptr [eax]

loc_1334:				; CODE XREF: _sureware_load_public+24Cj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1342
		dec	ecx
		test	ecx, ecx
		jg	short loc_1334

loc_1342:				; CODE XREF: _sureware_load_public+247j
		mov	[esi+4], ecx

loc_1345:				; CODE XREF: _sureware_load_public+233j
		mov	eax, [edi+14h]
		mov	[eax+4], ebx
		mov	esi, [edi+14h]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_1375
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop	dword ptr [eax+00000000h]

loc_1364:				; CODE XREF: _sureware_load_public+27Cj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1372
		dec	ecx
		test	ecx, ecx
		jg	short loc_1364

loc_1372:				; CODE XREF: _sureware_load_public+277j
		mov	[esi+4], ecx

loc_1375:				; CODE XREF: _sureware_load_public+25Fj
		call	_EVP_PKEY_new
		push	edi
		mov	esi, eax
		push	74h ; 't'
		push	esi
		call	_EVP_PKEY_assign
		add	esp, 0Ch
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_139D:				; CODE XREF: _sureware_load_public+7Aj
		push	esi
		call	_RSA_new_method
		push	ebx
		push	ds:_rsaHndidx
		mov	edi, eax
		push	edi
		call	_RSA_set_ex_data
		or	dword ptr [edi+3Ch], 20h
		add	esp, 10h
		call	_BN_new
		mov	[edi+14h], eax
		call	_BN_new
		mov	ecx, [edi+14h]
		mov	[edi+10h], eax
		test	ecx, ecx
		jz	short $err$91
		test	eax, eax
		jz	short $err$91
		mov	esi, [esp+58h+arg_C]
		mov	ebx, esi
		shr	ebx, 2
		push	ebx
		push	ecx
		call	_bn_expand2
		push	ebx
		push	dword ptr [edi+10h]
		call	_bn_expand2
		mov	ecx, [edi+14h]
		add	esp, 10h
		cmp	[ecx+8], ebx
		jnz	short $err$91
		mov	eax, [edi+10h]
		cmp	[eax+8], ebx
		jnz	short $err$91
		push	dword ptr [ecx]
		push	dword ptr [eax]
		lea	eax, [esp+60h+var_44]
		push	esi
		push	ebp
		push	eax
		call	ds:_p_surewarehk_Load_Rsa_Pubkey
		mov	esi, eax
		lea	eax, [esp+6Ch+var_44]
		push	esi
		push	6Ah ; 'j'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 20h
		cmp	esi, 1
		jz	short loc_145F
		push	2D8h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	81h ; ''
		push	6Ah ; 'j'
		call	_ERR_SUREWARE_error
		add	esp, 10h

$err$91:				; CODE XREF: _sureware_load_public+2DAj
					; _sureware_load_public+2DEj ...
		push	edi
		call	_RSA_free
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_145F:				; CODE XREF: _sureware_load_public+332j
		mov	eax, [edi+14h]
		mov	[eax+4], ebx
		mov	esi, [edi+14h]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_1488
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]

loc_1477:				; CODE XREF: _sureware_load_public+38Fj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_1485
		dec	ecx
		test	ecx, ecx
		jg	short loc_1477

loc_1485:				; CODE XREF: _sureware_load_public+38Aj
		mov	[esi+4], ecx

loc_1488:				; CODE XREF: _sureware_load_public+379j
		mov	eax, [edi+10h]
		mov	[eax+4], ebx
		mov	esi, [edi+10h]
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	short loc_14B5
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop	dword ptr [eax+00h]

loc_14A4:				; CODE XREF: _sureware_load_public+3BCj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_14B2
		dec	ecx
		test	ecx, ecx
		jg	short loc_14A4

loc_14B2:				; CODE XREF: _sureware_load_public+3B7j
		mov	[esi+4], ecx

loc_14B5:				; CODE XREF: _sureware_load_public+3A2j
		call	_EVP_PKEY_new
		push	edi
		mov	esi, eax
		push	6
		push	esi
		call	_EVP_PKEY_assign
		add	esp, 0Ch
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_14DD:				; CODE XREF: _sureware_load_public+5Fj
					; _sureware_load_public+6Cj
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_14F0
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_14F0:				; CODE XREF: _sureware_load_public+3F0j
		push	2BCh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'

loc_14FC:				; CODE XREF: _sureware_load_public+A7j
		push	6Ah ; 'j'
		push	eax
		call	_ERR_put_error
		mov	ecx, [esp+6Ch+var_4]
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
_sureware_load_public endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 151Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_ctrl proc near		; DATA XREF: _bind_sureware+CDo

arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		sub	eax, 1
		jz	short loc_1590
		sub	eax, 64h ; 'd'
		jz	short loc_1557
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_153D
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_153D:				; CODE XREF: _surewarehk_ctrl+15j
		push	1B7h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	77h ; 'w'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1557:				; CODE XREF: _surewarehk_ctrl+Cj
		push	1AFh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		push	1B1h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	1Eh
		push	0Ah
		mov	ds:_threadsafe,	0
		call	_CRYPTO_lock
		add	esp, 20h
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1590:				; CODE XREF: _surewarehk_ctrl+7j
		push	19Ah
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	eax, ds:_logstream
		add	esp, 10h
		test	eax, eax
		jz	short loc_15C2
		push	eax
		call	_BIO_free
		add	esp, 4
		mov	ds:_logstream, 0

loc_15C2:				; CODE XREF: _surewarehk_ctrl+91j
		push	esi
		mov	esi, [esp+4+arg_C]
		push	19Fh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	15h
		lea	eax, [esi+2Ch]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		add	esp, 14h
		cmp	eax, 1
		jle	short loc_15EE
		mov	ds:_logstream, esi
		jmp	short loc_1618
; ---------------------------------------------------------------------------

loc_15EE:				; CODE XREF: _surewarehk_ctrl+C8j
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1601
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1601:				; CODE XREF: _surewarehk_ctrl+D9j
		push	1A3h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	64h ; 'd'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_1618:				; CODE XREF: _surewarehk_ctrl+D0j
		push	1A5h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, 1
		pop	esi
		retn
_surewarehk_ctrl endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1638h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_destroy proc near		; DATA XREF: _bind_sureware+8Bo
		cmp	ds:_SUREWARE_error_init, 0
		jnz	short loc_167A
		push	offset _SUREWARE_str_functs
		push	ds:_SUREWARE_lib_error_code
		call	_ERR_unload_strings
		push	offset _SUREWARE_str_reasons
		push	ds:_SUREWARE_lib_error_code
		call	_ERR_unload_strings
		push	offset _SUREWARE_lib_name
		push	0
		call	_ERR_unload_strings
		add	esp, 18h
		mov	ds:_SUREWARE_error_init, 1

loc_167A:				; CODE XREF: _surewarehk_destroy+7j
		mov	eax, 1
		retn
_surewarehk_destroy endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1680h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_error_handling proc	near	; CODE XREF: _surewarehk_rsa_priv_dec+B1p
					; _surewarehk_rsa_priv_dec+14Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		add	eax, 5
		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	eax, 6		; switch 7 cases
		ja	short $LN8	; jumptable 00001691 default case
		jmp	ds:$LN16[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _surewarehk_error_handling+11j
					; DATA XREF: .text$mn:$LN16o
		push	272h		; jumptable 00001691 case 2
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	68h ; 'h'
		jmp	short loc_16E1
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _surewarehk_error_handling+11j
					; DATA XREF: .text$mn:$LN16o
		push	275h		; jumptable 00001691 case 3
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	66h ; 'f'
		jmp	short loc_16E1
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _surewarehk_error_handling+11j
					; DATA XREF: .text$mn:$LN16o
		push	278h		; jumptable 00001691 case 1
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	67h ; 'g'
		jmp	short loc_16E1
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _surewarehk_error_handling+11j
					; DATA XREF: .text$mn:$LN16o
		push	27Bh		; jumptable 00001691 case 0
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	6Ah ; 'j'
		jmp	short loc_16E1
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _surewarehk_error_handling+11j
					; DATA XREF: .text$mn:$LN16o
		mov	byte ptr [esi],	0 ; jumptable 00001691 case 6
		jmp	short loc_16EF
; ---------------------------------------------------------------------------

$LN8:					; CODE XREF: _surewarehk_error_handling+Fj
					; _surewarehk_error_handling+11j
					; DATA XREF: ...
		push	27Eh		; jumptable 00001691 default case
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	65h ; 'e'

loc_16E1:				; CODE XREF: _surewarehk_error_handling+24j
					; _surewarehk_error_handling+32j ...
		push	[esp+10h+arg_4]
		push	26h ; '&'
		call	_ERR_put_error
		add	esp, 14h

loc_16EF:				; CODE XREF: _surewarehk_error_handling+53j
		cmp	byte ptr [esi],	0
		jz	short loc_174F
		push	esi
		push	1
		call	_ERR_add_error_data
		add	esp, 8
		cmp	ds:_logstream, 0
		jz	short loc_174F
		push	286h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	15h
		push	9
		call	_CRYPTO_lock
		mov	ecx, esi
		add	esp, 10h
		lea	edx, [ecx+1]

loc_1723:				; CODE XREF: _surewarehk_error_handling+A8j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_1723
		sub	ecx, edx
		push	ecx
		push	esi
		push	ds:_logstream
		call	_BIO_write
		push	288h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	15h
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 1Ch

loc_174F:				; CODE XREF: _surewarehk_error_handling+72j
					; _surewarehk_error_handling+86j
		pop	esi
		retn
_surewarehk_error_handling endp

; ---------------------------------------------------------------------------
		align 4
$LN16		dd offset $LN7		; DATA XREF: _surewarehk_error_handling+11r
		dd offset $LN6		; jump table for switch	statement
		dd offset $LN4
		dd offset $LN5
		dd offset $LN8
		dd offset $LN8
		dd offset $LN9
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1770h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_ex_free proc near		; DATA XREF: _surewarehk_init+310o
					; _surewarehk_init+336o

arg_4		= dword	ptr  8

		mov	eax, ds:_p_surewarehk_Free
		test	eax, eax
		jnz	short loc_17A4
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_178C
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_178C:				; CODE XREF: _surewarehk_ex_free+10j
		push	36Dh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_17A4:				; CODE XREF: _surewarehk_ex_free+7j
		push	0
		push	[esp+4+arg_4]
		call	eax ; _p_surewarehk_Free
		add	esp, 8
		retn
_surewarehk_ex_free endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 17B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_finish proc	near		; DATA XREF: _bind_sureware+B7o
		cmp	ds:_surewarehk_dso, 0
		push	esi
		mov	esi, 1
		jnz	short loc_17E0
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_17D2
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_17D2:				; CODE XREF: _surewarehk_finish+16j
		push	250h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	70h ; 'p'
		jmp	short loc_1817
; ---------------------------------------------------------------------------

loc_17E0:				; CODE XREF: _surewarehk_finish+Dj
		call	ds:_p_surewarehk_Finish
		push	ds:_surewarehk_dso
		call	_DSO_free
		add	esp, 4
		test	eax, eax
		jnz	short $err$14
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_180B
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_180B:				; CODE XREF: _surewarehk_finish+4Fj
		push	256h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	68h ; 'h'

loc_1817:				; CODE XREF: _surewarehk_finish+2Ej
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi

$err$14:				; CODE XREF: _surewarehk_finish+46j
		mov	eax, ds:_logstream
		test	eax, eax
		jz	short loc_1836
		push	eax
		call	_BIO_free
		add	esp, 4

loc_1836:				; CODE XREF: _surewarehk_finish+7Bj
		mov	eax, esi
		mov	ds:_surewarehk_dso, 0
		mov	ds:_p_surewarehk_Init, 0
		mov	ds:_p_surewarehk_Finish, 0
		mov	ds:_p_surewarehk_Rand_Bytes, 0
		mov	ds:_p_surewarehk_Rand_Seed, 0
		mov	ds:_p_surewarehk_Load_Privkey, 0
		mov	ds:_p_surewarehk_Load_Rsa_Pubkey, 0
		mov	ds:_p_surewarehk_Free, 0
		mov	ds:_p_surewarehk_Rsa_Priv_Dec, 0
		mov	ds:_p_surewarehk_Rsa_Sign, 0
		mov	ds:_p_surewarehk_Dsa_Sign, 0
		mov	ds:_p_surewarehk_Info_Pubkey, 0
		mov	ds:_p_surewarehk_Load_Dsa_Pubkey, 0
		mov	ds:_p_surewarehk_Mod_Exp, 0
		pop	esi
		retn
_surewarehk_finish endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 18C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_init proc near		; DATA XREF: _bind_sureware+A1o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= qword	ptr -44h
var_3C		= dword	ptr -3Ch
Dst		= byte ptr -38h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, ds:dword_20E4
		movq	xmm0, ds:??_C@_0M@DCPBILGO@ENGINE_init?$AA@ ; `string'
		push	ebx
		push	ebp
		mov	ebp, [esp+70h+arg_0]
		push	esi
		push	edi
		push	34h ; '4'       ; Size
		mov	[esp+7Ch+var_3C], eax
		lea	eax, [esp+7Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		movq	[esp+84h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_surewarehk_dso, 0
		jz	short loc_193A
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1929
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1929:				; CODE XREF: _surewarehk_init+55j
		push	1D9h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	64h ; 'd'
		jmp	loc_1C52
; ---------------------------------------------------------------------------

loc_193A:				; CODE XREF: _surewarehk_init+4Cj
		push	0
		push	0
		push	ds:_surewarehk_LIBNAME
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_surewarehk_dso, eax
		test	eax, eax
		jnz	short loc_1974
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_196A
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_196A:				; CODE XREF: _surewarehk_init+96j
		push	1DFh
		jmp	loc_1C4B
; ---------------------------------------------------------------------------

loc_1974:				; CODE XREF: _surewarehk_init+8Dj
		push	ds:_n_surewarehk_Init
		push	eax
		call	_DSO_bind_func
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_1C33
		push	ds:_n_surewarehk_Finish
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_1C33
		push	ds:_n_surewarehk_Rand_Bytes
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1C33
		push	ds:_n_surewarehk_Rand_Seed
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_68], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Load_Privkey
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_64], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Load_Rsa_Pubkey
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_60], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Free
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_5C], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Rsa_Priv_Dec
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_58], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Rsa_Sign
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_54], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Dsa_Sign
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_50], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Info_Pubkey
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_4C], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Load_Dsa_Pubkey
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+78h+var_48], eax
		test	eax, eax
		jz	loc_1C33
		push	ds:_n_surewarehk_Mod_Exp
		push	ds:_surewarehk_dso
		call	_DSO_bind_func
		mov	ecx, eax
		add	esp, 8
		test	ecx, ecx
		jz	loc_1C33
		mov	eax, [esp+78h+var_68]
		push	ds:_threadsafe
		mov	ds:_p_surewarehk_Rand_Seed, eax
		mov	eax, [esp+7Ch+var_64]
		mov	ds:_p_surewarehk_Load_Privkey, eax
		mov	eax, [esp+7Ch+var_60]
		mov	ds:_p_surewarehk_Load_Rsa_Pubkey, eax
		mov	eax, [esp+7Ch+var_5C]
		mov	ds:_p_surewarehk_Free, eax
		mov	eax, [esp+7Ch+var_58]
		mov	ds:_p_surewarehk_Rsa_Priv_Dec, eax
		mov	eax, [esp+7Ch+var_54]
		mov	ds:_p_surewarehk_Rsa_Sign, eax
		mov	eax, [esp+7Ch+var_50]
		mov	ds:_p_surewarehk_Dsa_Sign, eax
		mov	eax, [esp+7Ch+var_4C]
		mov	ds:_p_surewarehk_Info_Pubkey, eax
		mov	eax, [esp+7Ch+var_48]
		mov	ds:_p_surewarehk_Load_Dsa_Pubkey, eax
		lea	eax, [esp+7Ch+var_44]
		push	eax
		mov	ds:_p_surewarehk_Init, esi
		mov	ds:_p_surewarehk_Finish, edi
		mov	ds:_p_surewarehk_Rand_Bytes, ebx
		mov	ds:_p_surewarehk_Mod_Exp, ecx
		call	esi
		add	esp, 8
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_1BA0
		push	21Ch

loc_1B8A:				; CODE XREF: _surewarehk_init+2F6j
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	68h ; 'h'
		push	68h ; 'h'
		call	_ERR_SUREWARE_error
		add	esp, 10h
		jmp	$err$25
; ---------------------------------------------------------------------------

loc_1BA0:				; CODE XREF: _surewarehk_init+2BBj
		push	ds:_threadsafe
		lea	eax, [esp+7Ch+var_44]
		push	eax
		call	ds:_p_surewarehk_Init
		add	esp, 8
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_1BC0
		push	220h
		jmp	short loc_1B8A
; ---------------------------------------------------------------------------

loc_1BC0:				; CODE XREF: _surewarehk_init+2EFj
		push	0
		push	0
		push	0
		push	ebp
		call	_surewarehk_load_privkey
		add	esp, 10h
		cmp	ds:_rsaHndidx, 0FFFFFFFFh
		jnz	short loc_1BF5
		push	offset _surewarehk_ex_free
		push	0
		push	0
		push	offset ??_C@_0BM@COBJHCFH@SureWareHook?5RSA?5key?5handle?$AA@ ;	"SureWareHook RSA key handle"
		push	0
		call	_RSA_get_ex_new_index
		add	esp, 14h
		mov	ds:_rsaHndidx, eax

loc_1BF5:				; CODE XREF: _surewarehk_init+30Ej
		cmp	ds:_dsaHndidx, 0FFFFFFFFh
		jnz	short loc_1C1B
		push	offset _surewarehk_ex_free
		push	0
		push	0
		push	offset ??_C@_0BM@EIIBDJOK@SureWareHook?5DSA?5key?5handle?$AA@ ;	"SureWareHook DSA key handle"
		push	0
		call	_DSA_get_ex_new_index
		add	esp, 14h
		mov	ds:_dsaHndidx, eax

loc_1C1B:				; CODE XREF: _surewarehk_init+334j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		mov	ecx, [esp+68h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
; ---------------------------------------------------------------------------

loc_1C33:				; CODE XREF: _surewarehk_init+BFj
					; _surewarehk_init+DDj	...
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1C46
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1C46:				; CODE XREF: _surewarehk_init+372j
		push	209h

loc_1C4B:				; CODE XREF: _surewarehk_init+A7j
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	68h ; 'h'

loc_1C52:				; CODE XREF: _surewarehk_init+6Dj
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$25:				; CODE XREF: _surewarehk_init+2D3j
		mov	eax, ds:_surewarehk_dso
		test	eax, eax
		jz	short loc_1C6F
		push	eax
		call	_DSO_free
		add	esp, 4

loc_1C6F:				; CODE XREF: _surewarehk_init+39Cj
		mov	ecx, [esp+78h+var_4]
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		mov	ds:_surewarehk_dso, 0
		mov	ds:_p_surewarehk_Init, 0
		mov	ds:_p_surewarehk_Finish, 0
		mov	ds:_p_surewarehk_Rand_Bytes, 0
		mov	ds:_p_surewarehk_Rand_Seed, 0
		mov	ds:_p_surewarehk_Load_Privkey, 0
		mov	ds:_p_surewarehk_Load_Rsa_Pubkey, 0
		mov	ds:_p_surewarehk_Free, 0
		mov	ds:_p_surewarehk_Rsa_Priv_Dec, 0
		mov	ds:_p_surewarehk_Rsa_Sign, 0
		mov	ds:_p_surewarehk_Dsa_Sign, 0
		mov	ds:_p_surewarehk_Info_Pubkey, 0
		mov	ds:_p_surewarehk_Load_Dsa_Pubkey, 0
		mov	ds:_p_surewarehk_Mod_Exp, 0
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_surewarehk_init endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_load_privkey proc near	; CODE XREF: _surewarehk_init+2FFp
					; DATA XREF: _bind_sureware+DFo

var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= xmmword ptr -44h
var_34		= dword	ptr -34h
Dst		= byte ptr -30h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 50h ; 'P'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		mov	eax, ds:dword_2170
		movups	xmm0, ds:??_C@_0BE@COFLJMLE@ENGINE_load_privkey?$AA@ ; `string'
		push	esi
		mov	esi, [esp+54h+arg_4]
		push	edi
		mov	edi, [esp+58h+arg_0]
		push	2Ch ; ','       ; Size
		mov	[esp+5Ch+var_34], eax
		lea	eax, [esp+5Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+64h+var_4C], 0
		mov	[esp+64h+var_48], 0
		mov	byte ptr [esp+64h+var_50], 0
		movups	[esp+64h+var_44], xmm0
		call	_memset
		mov	eax, ds:_p_surewarehk_Load_Privkey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1DB0
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1D86
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1D86:				; CODE XREF: _surewarehk_load_privkey+6Aj
		push	33Dh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+50h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
; ---------------------------------------------------------------------------

loc_1DB0:				; CODE XREF: _surewarehk_load_privkey+61j
		lea	ecx, [esp+58h+var_50]
		push	ecx
		lea	ecx, [esp+5Ch+var_4C]
		push	ecx
		lea	ecx, [esp+60h+var_48]
		push	ecx
		lea	ecx, [esp+64h+var_44]
		push	esi
		push	ecx
		call	eax ; _p_surewarehk_Load_Privkey
		add	esp, 14h
		cmp	eax, 1
		jz	short loc_1E1B
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1DE2
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1DE2:				; CODE XREF: _surewarehk_load_privkey+C6j
		push	342h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	80h ; ''
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		lea	eax, [esp+6Ch+var_44]
		push	eax
		push	1
		call	_ERR_add_error_data
		add	esp, 1Ch
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+50h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
; ---------------------------------------------------------------------------

loc_1E1B:				; CODE XREF: _surewarehk_load_privkey+BDj
		push	[esp+58h+var_50]
		push	[esp+5Ch+var_4C]
		push	[esp+60h+var_48]
		push	esi
		push	edi
		call	_sureware_load_public
		mov	ecx, [esp+6Ch+var_4]
		add	esp, 14h
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
_surewarehk_load_privkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1E44h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_load_pubkey	proc near	; DATA XREF: _bind_sureware+F1o

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= xmmword ptr -44h
var_34		= word ptr -34h
var_32		= byte ptr -32h
Dst		= byte ptr -31h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4Ch ; 'L'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	ax, ds:word_2184
		movups	xmm0, ds:??_C@_0BD@OCAHACFJ@ENGINE_load_pubkey?$AA@ ; `string'
		push	esi
		mov	esi, [esp+50h+arg_4]
		push	edi
		mov	edi, [esp+54h+arg_0]
		mov	[esp+54h+var_34], ax
		mov	al, ds:byte_2186
		push	2Dh ; '-'       ; Size
		mov	[esp+58h+var_32], al
		lea	eax, [esp+58h+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+60h+var_48], 0
		mov	byte ptr [esp+60h+var_4C], 0
		movups	[esp+60h+var_44], xmm0
		call	_memset
		mov	eax, ds:_p_surewarehk_Info_Pubkey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1EE7
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1EBD
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1EBD:				; CODE XREF: _surewarehk_load_pubkey+6Dj
		push	357h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	71h ; 'q'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_1EE7:				; CODE XREF: _surewarehk_load_pubkey+64j
		lea	ecx, [esp+54h+var_4C]
		push	ecx
		lea	ecx, [esp+58h+var_48]
		push	ecx
		lea	ecx, [esp+5Ch+var_44]
		push	esi
		push	ecx
		call	eax ; _p_surewarehk_Info_Pubkey
		add	esp, 10h
		cmp	eax, 1
		jz	short loc_1F4D
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1F14
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1F14:				; CODE XREF: _surewarehk_load_pubkey+C4j
		push	35Dh
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	81h ; ''
		push	71h ; 'q'
		push	eax
		call	_ERR_put_error
		lea	eax, [esp+68h+var_44]
		push	eax
		push	1
		call	_ERR_add_error_data
		add	esp, 1Ch
		xor	eax, eax
		pop	edi
		pop	esi
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_1F4D:				; CODE XREF: _surewarehk_load_pubkey+BBj
		push	[esp+54h+var_4C]
		push	[esp+58h+var_48]
		push	0
		push	esi
		push	edi
		call	_sureware_load_public
		mov	ecx, [esp+68h+var_4]
		add	esp, 14h
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
_surewarehk_load_pubkey	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1F74h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_surewarehk_modexp proc	near		; CODE XREF: _surewarehk_mod_exp_mont+14p
					; _surewarehk_modexp_dh+14p ...

var_44		= qword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= word ptr -38h
Dst		= byte ptr -36h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 44h ; 'D'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, ds:dword_21C8
		movq	xmm0, ds:??_C@_0O@NLOPGNJD@ENGINE_modexp?$AA@ ;	`string'
		push	ebx
		mov	ebx, [esp+48h+arg_C]
		push	ebp
		mov	ebp, [esp+4Ch+arg_8]
		push	esi
		mov	esi, [esp+50h+arg_0]
		push	edi
		mov	edi, [esp+54h+arg_4]
		mov	[esp+54h+var_3C], eax
		mov	ax, ds:word_21CC
		push	32h ; '2'       ; Size
		mov	[esp+58h+var_38], ax
		lea	eax, [esp+58h+Dst]
		push	0		; Val
		push	eax		; Dst
		movq	[esp+60h+var_44], xmm0
		call	_memset
		add	esp, 0Ch
		cmp	ds:_p_surewarehk_Mod_Exp, 0
		jnz	short loc_2018
		mov	eax, ds:_SUREWARE_lib_error_code
		test	eax, eax
		jnz	short loc_1FEC
		call	_ERR_get_next_error_library
		mov	ds:_SUREWARE_lib_error_code, eax

loc_1FEC:				; CODE XREF: _surewarehk_modexp+6Cj
		push	435h
		push	offset ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ ; ".\\engines\\e_sureware.c"
		push	75h ; 'u'
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_2003:				; CODE XREF: _surewarehk_modexp+A6j
					; _surewarehk_modexp+BAj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_2018:				; CODE XREF: _surewarehk_modexp+63j
		test	esi, esi
		jz	short loc_2003
		push	dword ptr [ebx+4]
		push	esi
		call	_bn_expand2
		mov	ecx, [ebx+4]
		add	esp, 8
		cmp	[esi+8], ecx
		jnz	short loc_2003
		push	dword ptr [esi]
		mov	eax, [edi+4]
		push	dword ptr [edi]
		shl	eax, 2
		push	eax
		push	dword ptr [ebp+0]
		mov	eax, [ebp+4]
		shl	eax, 2
		push	eax
		push	dword ptr [ebx]
		lea	eax, ds:0[ecx*4]
		push	eax
		lea	eax, [esp+70h+var_44]
		push	eax
		call	ds:_p_surewarehk_Mod_Exp
		mov	edi, eax
		lea	eax, [esp+74h+var_44]
		push	edi
		push	6Bh ; 'k'
		push	eax
		call	_surewarehk_error_handling
		add	esp, 2Ch
		cmp	edi, 1
		jnz	short loc_2095
		mov	ecx, [ebx+4]
		mov	[esi+4], ecx
		test	ecx, ecx
		jle	short loc_2095
		mov	eax, [esi]
		lea	edx, [ecx-1]
		lea	edx, [eax+edx*4]
		nop

loc_2084:				; CODE XREF: _surewarehk_modexp+11Cj
		mov	eax, [edx]
		lea	edx, [edx-4]
		test	eax, eax
		jnz	short loc_2092
		dec	ecx
		test	ecx, ecx
		jg	short loc_2084

loc_2092:				; CODE XREF: _surewarehk_modexp+117j
		mov	[esi+4], ecx

loc_2095:				; CODE XREF: _surewarehk_modexp+FBj
					; _surewarehk_modexp+105j
		mov	ecx, [esp+54h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
_surewarehk_modexp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 20ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 20C4h
; COMDAT (pick any)
		public ??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@
; `string'
??_C@_0BH@BMFLPMPB@?4?2engines?2e_sureware?4c?$AA@ db '.\engines\e_sureware.c',0
					; DATA XREF: _surewarehk_rsa_priv_dec+70o
					; _surewarehk_rsa_priv_dec+105o ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 20DCh
; COMDAT (pick any)
		public ??_C@_0M@DCPBILGO@ENGINE_init?$AA@
; `string'
??_C@_0M@DCPBILGO@ENGINE_init?$AA@ dq 695F454E49474E45h	; DATA XREF: _surewarehk_init+1Ar
dword_20E4	dd 74696Eh		; DATA XREF: _surewarehk_init+15r
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 20E8h
; COMDAT (pick any)
		public ??_C@_0BM@COBJHCFH@SureWareHook?5RSA?5key?5handle?$AA@
; `string'
??_C@_0BM@COBJHCFH@SureWareHook?5RSA?5key?5handle?$AA@ db 'SureWareHook RSA key handle',0
					; DATA XREF: _surewarehk_init+319o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2104h
; COMDAT (pick any)
		public ??_C@_0BM@EIIBDJOK@SureWareHook?5DSA?5key?5handle?$AA@
; `string'
??_C@_0BM@EIIBDJOK@SureWareHook?5DSA?5key?5handle?$AA@ db 'SureWareHook DSA key handle',0
					; DATA XREF: _surewarehk_init+33Fo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2120h
; COMDAT (pick any)
		public ??_C@_0BC@EDMLEKPB@ENGINE_rand_bytes?$AA@
; `string'
??_C@_0BC@EDMLEKPB@ENGINE_rand_bytes?$AA@ xmmword 657479625F646E61725F454E49474E45h
					; DATA XREF: _surewarehk_rand_bytes+1Br
word_2130	dw 73h			; DATA XREF: _surewarehk_rand_bytes+15r
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2134h
; COMDAT (pick any)
		public ??_C@_0BB@CIBPBFPN@ENGINE_rand_seed?$AA@
; `string'
??_C@_0BB@CIBPBFPN@ENGINE_rand_seed?$AA@ xmmword 646565735F646E61725F454E49474E45h
					; DATA XREF: _surewarehk_rand_seed+1Ar
byte_2144	db 0			; DATA XREF: _surewarehk_rand_seed+15r
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2148h
; COMDAT (pick any)
		public ??_C@_0BF@CMPBHEOJ@sureware_load_public?$AA@
; `string'
??_C@_0BF@CMPBHEOJ@sureware_load_public?$AA@ xmmword 75705F64616F6C5F6572617765727573h
					; DATA XREF: _sureware_load_public+1Ar
dword_2158	dd 63696C62h		; DATA XREF: _sureware_load_public+15r
byte_215C	db 0			; DATA XREF: _sureware_load_public+35r
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2160h
; COMDAT (pick any)
		public ??_C@_0BE@COFLJMLE@ENGINE_load_privkey?$AA@
; `string'
??_C@_0BE@COFLJMLE@ENGINE_load_privkey?$AA@ xmmword 766972705F64616F6C5F454E49474E45h
					; DATA XREF: _surewarehk_load_privkey+1Ar
dword_2170	dd 79656Bh		; DATA XREF: _surewarehk_load_privkey+15r
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2174h
; COMDAT (pick any)
		public ??_C@_0BD@OCAHACFJ@ENGINE_load_pubkey?$AA@
; `string'
??_C@_0BD@OCAHACFJ@ENGINE_load_pubkey?$AA@ xmmword 6B6275705F64616F6C5F454E49474E45h
					; DATA XREF: _surewarehk_load_pubkey+1Br
word_2184	dw 7965h		; DATA XREF: _surewarehk_load_pubkey+15r
byte_2186	db 0			; DATA XREF: _surewarehk_load_pubkey+31r
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2188h
; COMDAT (pick any)
		public ??_C@_0BE@FFBAHKOB@ENGINE_rsa_priv_dec?$AA@
; `string'
??_C@_0BE@FFBAHKOB@ENGINE_rsa_priv_dec?$AA@ xmmword 5F766972705F6173725F454E49474E45h
					; DATA XREF: _surewarehk_rsa_priv_dec+1Ar
dword_2198	dd 636564h		; DATA XREF: _surewarehk_rsa_priv_dec+15r
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 219Ch
; COMDAT (pick any)
		public ??_C@_0BA@CKPMAPPD@ENGINE_rsa_sign?$AA@
; `string'
??_C@_0BA@CKPMAPPD@ENGINE_rsa_sign?$AA@	xmmword	6E6769735F6173725F454E49474E45h
					; DATA XREF: _surewarehk_rsa_sign+15r
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 21ACh
; COMDAT (pick any)
		public ??_C@_0BD@PCALNPLJ@ENGINE_dsa_do_sign?$AA@
; `string'
??_C@_0BD@PCALNPLJ@ENGINE_dsa_do_sign?$AA@ xmmword 69735F6F645F6173645F454E49474E45h
					; DATA XREF: _surewarehk_dsa_do_sign+1Br
word_21BC	dw 6E67h		; DATA XREF: _surewarehk_dsa_do_sign+15r
byte_21BE	db 0			; DATA XREF: _surewarehk_dsa_do_sign+31r
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 21C0h
; COMDAT (pick any)
		public ??_C@_0O@NLOPGNJD@ENGINE_modexp?$AA@
; `string'
??_C@_0O@NLOPGNJD@ENGINE_modexp?$AA@ dq	6D5F454E49474E45h
					; DATA XREF: _surewarehk_modexp+1Ar
dword_21C8	dd 7865646Fh		; DATA XREF: _surewarehk_modexp+15r
word_21CC	dw 70h			; DATA XREF: _surewarehk_modexp+3Ar
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_lock:near	; CODE XREF: _surewarehk_ctrl+49p
					; _surewarehk_ctrl+66p	...
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_add_lock:near ; CODE XREF: _surewarehk_ctrl+BDp
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_malloc:near ; CODE XREF: _surewarehk_rsa_priv_dec+16Ap
		extrn _CRYPTO_free:near	; CODE XREF: _surewarehk_rsa_priv_dec+249p
		extrn _OPENSSL_cleanse:near ; CODE XREF: _surewarehk_rsa_priv_dec+243p
		extrn _BIO_free:near	; CODE XREF: _surewarehk_ctrl+94p
					; _surewarehk_finish+7Ep
		extrn _BIO_write:near	; CODE XREF: _surewarehk_error_handling+B4p
		extrn _BN_new:near	; CODE XREF: _surewarehk_dsa_do_sign:loc_A9Bp
					; _surewarehk_dsa_do_sign+13Ap	...
		extrn _BN_init:near	; CODE XREF: _surewarehk_dsa_mod_exp+15p
		extrn _BN_mod_mul:near	; CODE XREF: _surewarehk_dsa_mod_exp+61p
		extrn _BN_free:near	; CODE XREF: _surewarehk_dsa_mod_exp+78p
		extrn _bn_expand2:near	; CODE XREF: _surewarehk_dsa_do_sign+157p
					; _surewarehk_dsa_do_sign+161p	...
		extrn _EVP_PKEY_assign:near ; CODE XREF: _sureware_load_public+28Cp
					; _sureware_load_public+3CCp
		extrn _EVP_PKEY_new:near ; CODE	XREF: _sureware_load_public:loc_1375p
					; _sureware_load_public:loc_14B5p
		extrn _RSA_new_method:near ; CODE XREF:	_sureware_load_public+2AAp
		extrn _RSA_free:near	; CODE XREF: _sureware_load_public+34Ep
		extrn _RSA_PKCS1_SSLeay:near ; CODE XREF: _bind_sureware+103p
		extrn _RSA_padding_check_PKCS1_OAEP:near
					; CODE XREF: _surewarehk_rsa_priv_dec+1EFp
		extrn _RSA_padding_check_SSLv23:near
					; CODE XREF: _surewarehk_rsa_priv_dec+21Ap
		extrn _RSA_padding_check_none:near
					; CODE XREF: _surewarehk_rsa_priv_dec+206p
		extrn _RSA_get_ex_new_index:near ; CODE	XREF: _surewarehk_init+320p
		extrn _RSA_set_ex_data:near ; CODE XREF: _sureware_load_public+2B9p
		extrn _RSA_get_ex_data:near ; CODE XREF: _surewarehk_rsa_priv_dec+DFp
					; _surewarehk_rsa_sign+81p
		extrn _DH_OpenSSL:near	; CODE XREF: _bind_sureware:loc_10CAp
		extrn _DSA_SIG_new:near	; CODE XREF: _surewarehk_dsa_do_sign:loc_A52p
		extrn _DSA_SIG_free:near ; CODE	XREF: _surewarehk_dsa_do_sign+202p
		extrn _DSA_OpenSSL:near	; CODE XREF: _bind_sureware:loc_10B9p
		extrn _DSA_new_method:near ; CODE XREF:	_sureware_load_public+ADp
		extrn _DSA_free:near	; CODE XREF: _sureware_load_public+1A5p
		extrn _DSA_get_ex_new_index:near ; CODE	XREF: _surewarehk_init+346p
		extrn _DSA_set_ex_data:near ; CODE XREF: _sureware_load_public+BCp
		extrn _DSA_get_ex_data:near ; CODE XREF: _surewarehk_dsa_do_sign+9Ep
		extrn _DSO_free:near	; CODE XREF: _surewarehk_finish+3Cp
					; _surewarehk_init+39Fp
		extrn _DSO_load:near	; CODE XREF: _surewarehk_init+7Ep
		extrn _DSO_bind_func:near ; CODE XREF: _surewarehk_init+B3p
					; _surewarehk_init+D1p	...
		extrn _ERR_put_error:near ; CODE XREF: _surewarehk_rsa_priv_dec+7Ap
					; _surewarehk_rsa_priv_dec+10Fp ...
		extrn _ERR_add_error_data:near ; CODE XREF: _surewarehk_error_handling+77p
					; _surewarehk_load_privkey+F0p	...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_SUREWARE_strings+2Cp
					; _ERR_load_SUREWARE_strings+3Cp ...
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_SUREWARE_strings+14p
					; _ERR_unload_SUREWARE_strings+24p ...
		extrn _ERR_get_next_error_library:near
					; CODE XREF: _surewarehk_rsa_priv_dec+61p
					; _surewarehk_rsa_priv_dec+F6p	...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_sureware+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_sureware+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_sureware+39p
		extrn _ENGINE_set_DSA:near ; CODE XREF:	_bind_sureware+4Fp
		extrn _ENGINE_set_DH:near ; CODE XREF: _bind_sureware+65p
		extrn _ENGINE_set_RAND:near ; CODE XREF: _bind_sureware+7Bp
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_sureware+91p
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_sureware+A7p
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_sureware+BDp
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_sureware+D3p
		extrn _ENGINE_set_load_privkey_function:near ; CODE XREF: _bind_sureware+E5p
		extrn _ENGINE_set_load_pubkey_function:near ; CODE XREF: _bind_sureware+F7p
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _surewarehk_rsa_priv_dec+CFp
					; _surewarehk_rsa_priv_dec+123p ...
		extrn __chkstk:near	; CODE XREF: _surewarehk_rsa_priv_dec+5p
					; _surewarehk_rsa_sign+5p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _surewarehk_rsa_priv_dec+1BDp
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _surewarehk_rsa_priv_dec+44p
					; _surewarehk_rsa_sign+3Bp ...
		extrn ___security_cookie:near ;	DATA XREF: _surewarehk_rsa_priv_dec+Ar
					; _surewarehk_rsa_sign+Ar ...


		end
