;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	60764AADA891B52673F85861AE2E1945
; Input	CRC32 :	0485A14A

; File Name   :	C:\compspace\Diff\openssl\obj\s3_clnt.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl3_connect(char, int, size_t Size)
		public _ssl3_connect
_ssl3_connect	proc near		; DATA XREF: _ssl3_connect+722o
					; .rdata:0000093Co

var_18		= qword	ptr -18h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  4
Size		= dword	ptr  0Ch

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	ebp, ebp
		push	ebp		; Time
		call	dword ptr ds:__imp___time64
		add	esp, 4
		mov	[esp+18h+var_4], eax
		xor	edi, edi
		lea	eax, [ebp+8]
		mov	[esp+18h+var_8], edi
		call	__chkstk
		xorps	xmm0, xmm0
		lea	eax, [esp+18h+arg_0]
		movsd	[esp+18h+var_18], xmm0
		push	4
		push	eax
		call	_RAND_add
		add	esp, 10h
		call	_ERR_clear_error
		push	edi		; dwErrCode
		call	dword ptr ds:__imp__SetLastError@4 ; SetLastError(x)
		mov	esi, [esp+10h+Size]
		mov	ebx, [esi+0D0h]
		test	ebx, ebx
		jnz	short loc_6E
		mov	eax, [esi+0E4h]
		mov	eax, [eax+9Ch]
		test	eax, eax
		cmovnz	ebx, eax

loc_6E:					; CODE XREF: _ssl3_connect+5Bj
		inc	dword ptr [esi+1Ch]
		push	esi
		call	_SSL_state
		add	esp, 4
		test	eax, 3000h
		jz	short loc_91
		push	esi
		call	_SSL_state
		add	esp, 4
		test	eax, 4000h
		jz	short loc_9A

loc_91:					; CODE XREF: _ssl3_connect+7Fj
		push	esi
		call	_SSL_clear
		add	esp, 4

loc_9A:					; CODE XREF: _ssl3_connect+8Fj
		cmp	[esi+188h], edi
		jz	short loc_B0
		inc	dword ptr [esi+18Ch]
		mov	[esi+188h], edi
		xchg	ax, ax

loc_B0:					; CODE XREF: _ssl3_connect+A0j
					; _ssl3_connect+245j
		mov	eax, [esi+34h]
		mov	[esp+10h+Size],	eax
		cmp	eax, 1100h
		jg	short loc_114
		jz	short loc_DC
		sub	eax, 3
		jz	loc_6B4
		sub	eax, 0FFDh
		jz	loc_5F7
		sub	eax, 3
		jmp	loc_5F1
; ---------------------------------------------------------------------------

loc_DC:					; CODE XREF: _ssl3_connect+BEj
		push	0
		push	0
		push	0Bh
		push	dword ptr [esi+10h]
		mov	dword ptr [esi+18h], 2
		call	_BIO_ctrl
		add	esp, 10h
		test	eax, eax
		jle	loc_7B2
		mov	eax, [esi+58h]
		mov	dword ptr [esi+18h], 1
		mov	eax, [eax+350h]
		mov	[esi+34h], eax
		jmp	loc_1EC
; ---------------------------------------------------------------------------

loc_114:				; CODE XREF: _ssl3_connect+BCj
		cmp	eax, 3004h
		jg	loc_5E5
		jz	loc_5C9
		sub	eax, 1110h	; switch 242 cases
		cmp	eax, 0F1h ; 'ñ'
		ja	$LN126		; jumptable 0000013C default case
		movzx	eax, ds:$LN137[eax]
		jmp	ds:$LN145[eax*4] ; switch jump
; ---------------------------------------------------------------------------

$LN22:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4368,4369
		mov	dword ptr [esi+30h], 0
		call	_ssl3_client_hello
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	eax, [esi+14h]
		mov	ecx, [esi+10h]
		mov	dword ptr [esi+34h], 1120h
		mov	dword ptr [esi+44h], 0
		cmp	eax, ecx
		jz	short loc_1E8
		push	ecx
		push	eax
		call	_BIO_push
		add	esp, 8
		mov	[esi+10h], eax
		jmp	short loc_1E8
; ---------------------------------------------------------------------------

$LN25:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4384,4385
		call	_ssl3_get_server_hello
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_1B6
		cmp	dword ptr [esi+140h], 0
		mov	dword ptr [esi+34h], 11D0h
		jz	short loc_1E1
		mov	dword ptr [esi+34h], 11E0h
		jmp	short loc_1E1
; ---------------------------------------------------------------------------

loc_1B6:				; CODE XREF: _ssl3_connect+19Bj
		mov	dword ptr [esi+34h], 1130h
		jmp	short loc_1E1
; ---------------------------------------------------------------------------

$LN30:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4400,4401
		call	_ssl3_check_finished
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		js	$end$146
		cmp	edi, 1
		jnz	short loc_24A
		mov	[esi+6Ch], eax

loc_1DA:				; CODE XREF: _ssl3_connect+55Dj
		mov	dword ptr [esi+34h], 11D0h

loc_1E1:				; CODE XREF: _ssl3_connect+1ABj
					; _ssl3_connect+1B4j ...
		mov	dword ptr [esi+44h], 0

loc_1E8:				; CODE XREF: _ssl3_connect+173j
					; _ssl3_connect+182j ...
		mov	edi, [esp+10h]

loc_1EC:				; CODE XREF: _ssl3_connect+10Fj
					; _ssl3_connect+29Aj ...
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+354h], 0
		jnz	short loc_23F
		test	edi, edi
		jnz	short loc_23F
		cmp	[esi+0E8h], edi
		jz	short loc_21D
		push	edi
		push	edi
		push	0Bh
		push	dword ptr [esi+10h]
		call	_BIO_ctrl
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jle	$end$146

loc_21D:				; CODE XREF: _ssl3_connect+202j
		test	ebx, ebx
		jz	short loc_23F
		mov	edi, [esi+34h]
		mov	eax, [esp+10h+Size]
		cmp	edi, eax
		jz	short loc_23F
		push	1
		push	1001h
		push	esi
		mov	[esi+34h], eax
		call	ebx
		add	esp, 0Ch
		mov	[esi+34h], edi

loc_23F:				; CODE XREF: _ssl3_connect+1F6j
					; _ssl3_connect+1FAj ...
		xor	edi, edi
		mov	[esp+10h], edi
		jmp	loc_B0
; ---------------------------------------------------------------------------

loc_24A:				; CODE XREF: _ssl3_connect+1D5j
		mov	eax, [esi+58h]
		mov	eax, [eax+344h]
		test	dword ptr [eax+10h], 404h
		jnz	short loc_29F
		test	dword ptr [eax+0Ch], 100h
		jnz	short loc_29F
		push	esi
		call	_ssl3_get_server_certificate
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		cmp	dword ptr [esi+12Ch], 0
		mov	eax, 1140h
		mov	edi, [esp+10h]
		mov	ecx, 11F0h
		cmovnz	eax, ecx
		mov	dword ptr [esi+44h], 0
		mov	[esi+34h], eax
		jmp	loc_1EC
; ---------------------------------------------------------------------------

loc_29F:				; CODE XREF: _ssl3_connect+25Aj
					; _ssl3_connect+263j
		mov	edi, 1
		mov	dword ptr [esi+34h], 1140h
		mov	dword ptr [esi+44h], 0
		jmp	loc_1EC
; ---------------------------------------------------------------------------

$LN38:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4416,4417
		call	_ssl3_get_key_exchange
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		push	esi
		mov	dword ptr [esi+34h], 1150h
		mov	dword ptr [esi+44h], 0
		call	_ssl3_check_cert_and_algorithm
		add	esp, 4
		test	eax, eax
		jz	loc_7AB
		jmp	loc_1E8
; ---------------------------------------------------------------------------

$LN41:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4432,4433
		call	_ssl3_get_certificate_request
		mov	edi, eax
		add	esp, 4
		test	edi, edi

loc_2FB:				; DATA XREF: .rdata:`SSLv3_client_method'::`2'::SSLv3_client_method_datao
		jle	$end$146
		mov	dword ptr [esi+34h], 1160h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN43:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4448,4449
		call	_ssl3_get_server_done
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	eax, [esi+58h]
		mov	eax, [eax+344h]
		test	dword ptr [eax+0Ch], 400h
		jz	short loc_345
		push	esi
		call	_SRP_Calc_A_param
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	loc_73F

loc_345:				; CODE XREF: _ssl3_connect+330j
		mov	eax, [esi+58h]
		mov	ecx, 1180h
		cmp	dword ptr [eax+358h], 0
		mov	eax, 1170h
		cmovnz	ecx, eax
		mov	[esi+34h], ecx
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN49:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4464-4467
		call	_ssl3_send_client_certificate
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	dword ptr [esi+34h], 1180h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN51:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4480,4481
		call	_ssl3_send_client_key_exchange
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	ecx, [esi+58h]
		mov	eax, 11A0h
		mov	edx, 1190h
		cmp	dword ptr [ecx+358h], 1
		cmovz	eax, edx
		mov	[esi+34h], eax
		test	byte ptr [ecx],	10h
		jz	loc_1E1
		mov	dword ptr [esi+34h], 11A0h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN56:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4496,4497
		call	_ssl3_send_client_verify
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	dword ptr [esi+34h], 11A0h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN58:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	11A1h		; jumptable 0000013C cases 4512,4513
		push	11A0h
		push	esi
		call	_ssl3_send_change_cipher_spec
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jle	$end$146
		mov	edx, [esi+58h]
		mov	ecx, 1200h
		mov	eax, 11B0h
		cmp	dword ptr [edx+41Ch], 0
		mov	dword ptr [esi+44h], 0
		cmovnz	eax, ecx
		mov	ecx, [esi+0C0h]
		mov	[esi+34h], eax
		mov	eax, [edx+344h]
		mov	[ecx+0B4h], eax
		mov	eax, [esi+58h]
		mov	eax, [eax+38Ch]
		test	eax, eax
		jnz	short loc_453
		mov	eax, [esi+0C0h]
		mov	dword ptr [eax+0B0h], 0
		jmp	short loc_461
; ---------------------------------------------------------------------------

loc_453:				; CODE XREF: _ssl3_connect+43Fj
		mov	ecx, [esi+0C0h]
		mov	eax, [eax]
		mov	[ecx+0B0h], eax

loc_461:				; CODE XREF: _ssl3_connect+451j
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+8]
		call	eax
		add	esp, 4
		test	eax, eax
		jz	loc_7AB
		mov	eax, [esi+8]
		push	12h
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+10h]
		call	eax
		add	esp, 8
		test	eax, eax
		jz	loc_7AB
		jmp	loc_1E8
; ---------------------------------------------------------------------------

$LN66:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4608,4609
		call	_ssl3_send_next_proto
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	dword ptr [esi+34h], 11B0h
		jmp	loc_1E8
; ---------------------------------------------------------------------------

$LN68:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		mov	eax, [esi+8]	; jumptable 0000013C cases 4528,4529
		mov	eax, [eax+64h]
		push	dword ptr [eax+24h]
		push	dword ptr [eax+20h]
		push	11B1h
		push	11B0h
		push	esi
		call	_ssl3_send_finished
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jle	$end$146
		mov	eax, [esi+58h]
		mov	dword ptr [esi+34h], 1100h
		and	dword ptr [eax], 0FFFFFFFBh
		cmp	dword ptr [esi+6Ch], 0
		mov	eax, [esi+58h]
		jz	short loc_523
		mov	dword ptr [eax+350h], 3
		mov	eax, [esi+58h]
		test	byte ptr [eax],	2
		jz	loc_1E1
		mov	dword ptr [esi+34h], 3
		or	dword ptr [eax], 4
		mov	eax, [esi+58h]
		mov	dword ptr [eax+4], 0
		jmp	loc_1E1
; ---------------------------------------------------------------------------

loc_523:				; CODE XREF: _ssl3_connect+4F2j
		cmp	dword ptr [esi+140h], 0
		jz	short loc_53B
		mov	dword ptr [eax+350h], 11E0h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

loc_53B:				; CODE XREF: _ssl3_connect+52Aj
		mov	dword ptr [eax+350h], 11D0h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN75:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4576,4577
		call	_ssl3_get_new_session_ticket
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		jmp	loc_1DA
; ---------------------------------------------------------------------------

$LN77:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		push	esi		; jumptable 0000013C cases 4592,4593
		call	_ssl3_get_cert_status
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jle	$end$146
		mov	dword ptr [esi+34h], 1140h
		jmp	loc_1E1
; ---------------------------------------------------------------------------

$LN79:					; CODE XREF: _ssl3_connect+13Cj
					; DATA XREF: .text$mn:$LN145o
		mov	eax, [esi+58h]	; jumptable 0000013C cases 4560,4561
		cmp	dword ptr [eax+180h], 0
		jnz	short loc_593
		or	dword ptr [eax], 80h

loc_593:				; CODE XREF: _ssl3_connect+58Bj
		push	11D1h
		push	11D0h
		push	esi
		call	_ssl3_get_finished
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jle	$end$146
		cmp	dword ptr [esi+6Ch], 0
		mov	eax, 3
		mov	ecx, 11A0h
		cmovnz	eax, ecx
		mov	[esi+34h], eax
		jmp	loc_1E1
; ---------------------------------------------------------------------------

loc_5C9:				; CODE XREF: _ssl3_connect+11Fj
		mov	eax, [esi+0E4h]
		mov	dword ptr [esi+190h], 1
		mov	dword ptr [esi+34h], 1000h
		inc	dword ptr [eax+38h]
		jmp	short loc_5F7
; ---------------------------------------------------------------------------

loc_5E5:				; CODE XREF: _ssl3_connect+119j
		cmp	eax, 4000h
		jz	short loc_5F7
		cmp	eax, 5000h

loc_5F1:				; CODE XREF: _ssl3_connect+D7j
		jnz	$LN126		; jumptable 0000013C default case

loc_5F7:				; CODE XREF: _ssl3_connect+CEj
					; _ssl3_connect+5E3j ...
		mov	dword ptr [esi+24h], 0
		test	ebx, ebx
		jz	short loc_60C
		push	1
		push	10h
		push	esi
		call	ebx
		add	esp, 0Ch

loc_60C:				; CODE XREF: _ssl3_connect+600j
		mov	eax, [esi]
		and	eax, 0FF00h
		cmp	eax, 300h
		jnz	loc_790
		cmp	dword ptr [esi+3Ch], 0
		mov	dword ptr [esi+4], 1000h
		jnz	short loc_655
		call	_BUF_MEM_new
		mov	ebp, eax
		test	ebp, ebp
		jz	loc_7AB
		push	4000h
		push	ebp
		call	_BUF_MEM_grow
		add	esp, 8
		test	eax, eax
		jz	loc_7AB
		mov	[esi+3Ch], ebp
		xor	ebp, ebp

loc_655:				; CODE XREF: _ssl3_connect+629j
		push	esi
		call	_ssl3_setup_buffers
		add	esp, 4
		test	eax, eax
		jz	loc_7B2
		push	0
		push	esi
		call	_ssl_init_wbio_buffer
		add	esp, 8
		test	eax, eax
		jz	loc_7AB
		push	esi
		call	_ssl3_init_finished_mac
		mov	eax, [esi+0E4h]
		add	esp, 4
		mov	dword ptr [esi+34h], 1110h
		inc	dword ptr [eax+34h]
		mov	eax, [esi+58h]
		mov	dword ptr [esi+44h], 0
		and	dword ptr [eax], 0FFFFFF7Fh
		mov	eax, [esi+58h]
		mov	dword ptr [eax+180h], 0
		jmp	loc_1EC
; ---------------------------------------------------------------------------

loc_6B4:				; CODE XREF: _ssl3_connect+C3j
		push	esi
		call	_ssl3_cleanup_key_block
		mov	eax, [esi+3Ch]
		add	esp, 4
		test	eax, eax
		jz	short loc_6D4
		push	eax
		call	_BUF_MEM_free
		add	esp, 4
		mov	dword ptr [esi+3Ch], 0

loc_6D4:				; CODE XREF: _ssl3_connect+6C2j
		mov	eax, [esi+58h]
		test	byte ptr [eax],	4
		jnz	short loc_6E5
		push	esi
		call	_ssl_free_wbio_buffer
		add	esp, 4

loc_6E5:				; CODE XREF: _ssl3_connect+6DAj
		push	1
		push	esi
		mov	dword ptr [esi+44h], 0
		mov	dword ptr [esi+190h], 0
		mov	dword ptr [esi+28h], 0
		call	_ssl_update_cache
		add	esp, 8
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_717
		mov	eax, [esi+0E4h]
		inc	dword ptr [eax+58h]

loc_717:				; CODE XREF: _ssl3_connect+70Cj
		mov	eax, [esi+0E4h]
		mov	edi, 1
		mov	dword ptr [esi+20h], offset _ssl3_connect
		inc	dword ptr [eax+3Ch]
		test	ebx, ebx
		jz	$end$146
		push	edi
		push	20h ; ' '
		push	esi
		call	ebx
		add	esp, 0Ch
		jmp	short $end$146
; ---------------------------------------------------------------------------

loc_73F:				; CODE XREF: _ssl3_connect+33Fj
		push	192h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	169h
		push	84h ; ''
		push	14h
		call	_ERR_put_error
		push	50h ; 'P'
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 20h
		mov	dword ptr [esi+34h], 5
		jmp	short $end$146
; ---------------------------------------------------------------------------

$LN126:					; CODE XREF: _ssl3_connect+12Fj
					; _ssl3_connect+13Cj ...
		push	281h		; jumptable 0000013C default case
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0FFh
		push	84h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_7B2
; ---------------------------------------------------------------------------

loc_790:				; CODE XREF: _ssl3_connect+618j
		push	0F0h ; 'ð'
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	84h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_7AB:				; CODE XREF: _ssl3_connect+2E3j
					; _ssl3_connect+472j ...
		mov	dword ptr [esi+34h], 5

loc_7B2:				; CODE XREF: _ssl3_connect+F6j
					; _ssl3_connect+660j ...
		or	edi, 0FFFFFFFFh

$end$146:				; CODE XREF: _ssl3_connect+157j
					; _ssl3_connect+191j ...
		dec	dword ptr [esi+1Ch]
		test	ebp, ebp
		jz	short loc_7C5
		push	ebp
		call	_BUF_MEM_free
		add	esp, 4

loc_7C5:				; CODE XREF: _ssl3_connect+7BAj
		test	ebx, ebx
		jz	short loc_7D5
		push	edi
		push	1002h
		push	esi
		call	ebx
		add	esp, 0Ch

loc_7D5:				; CODE XREF: _ssl3_connect+7C7j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
_ssl3_connect	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h
$LN145		dd offset $LN22, offset	$LN25, offset $LN30, offset $LN38
					; DATA XREF: _ssl3_connect+13Cr
		dd offset $LN41, offset	$LN43, offset $LN49, offset $LN51 ; jump table for switch statement
		dd offset $LN56, offset	$LN58, offset $LN68, offset $LN79
		dd offset $LN75, offset	$LN77, offset $LN66, offset $LN126
$LN137		db 0, 0, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
					; DATA XREF: _ssl3_connect+135r
		db 0Fh,	0Fh, 0Fh, 0Fh, 1, 1, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh ; indirect table for switch statement
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 2, 2, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	3, 3, 0Fh, 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 4, 4, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	5, 5, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 6,	6, 6, 6, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 7, 7, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 8
		db 8, 0Fh, 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 9, 9, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Ah,	0Ah, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Bh, 0Bh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Ch, 0Ch, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Dh, 0Dh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Eh,	0Eh
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 914h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl3_get_client_method	proc near	; DATA XREF: .rdata:00000984o

arg_0		= dword	ptr  4

		xor	ecx, ecx
		mov	eax, offset ?SSLv3_client_method_data@?1??SSLv3_client_method@@9@9 ; `SSLv3_client_method'::`2'::SSLv3_client_method_data
		cmp	[esp+arg_0], 300h
		cmovnz	eax, ecx
		retn
_ssl3_get_client_method	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 928h
; `SSLv3_client_method'::`2'::SSLv3_client_method_data
?SSLv3_client_method_data@?1??SSLv3_client_method@@9@9 dd offset loc_2FB+5
					; DATA XREF: _ssl3_get_client_method+2o
					; _SSLv3_client_methodo
		dd offset _ssl3_new
		dd offset _ssl3_clear
		dd offset _ssl3_free
		dd offset _ssl_undefined_function
		dd offset _ssl3_connect
		dd offset _ssl3_read
		dd offset _ssl3_peek
		dd offset _ssl3_write
		dd offset _ssl3_shutdown
		dd offset _ssl3_renegotiate
		dd offset _ssl3_renegotiate_check
		dd offset _ssl3_get_message
		dd offset _ssl3_read_bytes
		dd offset _ssl3_write_bytes
		dd offset _ssl3_dispatch_alert
		dd offset _ssl3_ctrl
		dd offset _ssl3_ctx_ctrl
		dd offset _ssl3_get_cipher_by_char
		dd offset _ssl3_put_cipher_by_char
		dd offset _ssl3_pending
		dd offset _ssl3_num_ciphers
		dd offset _ssl3_get_cipher
		dd offset _ssl3_get_client_method
		dd offset _ssl3_default_timeout
		dd offset _SSLv3_enc_data
		dd offset _ssl_undefined_void_function
		dd offset _ssl3_callback_ctrl
		dd offset _ssl3_ctx_callback_ctrl
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 99Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _SSLv3_client_method
_SSLv3_client_method proc near
		mov	eax, offset ?SSLv3_client_method_data@?1??SSLv3_client_method@@9@9 ; `SSLv3_client_method'::`2'::SSLv3_client_method_data
		retn
_SSLv3_client_method endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ca_dn_cmp	proc near		; DATA XREF: _ssl3_get_certificate_request+117o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	dword ptr [eax]
		mov	eax, [esp+4+arg_0]
		push	dword ptr [eax]
		call	_X509_NAME_cmp
		add	esp, 8
		retn
_ca_dn_cmp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_server_static_dh_key proc near	; CODE XREF: _ssl3_check_cert_and_algorithm+2C4p
					; _ssl3_send_client_key_exchange+256p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		xor	esi, esi
		push	edi
		mov	ecx, [edx+4]
		test	ecx, ecx
		js	short loc_9FB
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		push	dword ptr [edx+eax*4+0Ch]
		call	_X509_get_pubkey
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_9FB
		push	edi
		call	_EVP_PKEY_get1_DH
		push	edi
		mov	esi, eax
		call	_EVP_PKEY_free
		add	esp, 8
		test	esi, esi
		jnz	short loc_A16

loc_9FB:				; CODE XREF: _get_server_static_dh_key+Dj
					; _get_server_static_dh_key+28j
		push	995h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	154h
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_A16:				; CODE XREF: _get_server_static_dh_key+3Dj
		pop	edi
		mov	eax, esi
		pop	esi
		retn
_get_server_static_dh_key endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A1Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_check_cert_and_algorithm
_ssl3_check_cert_and_algorithm proc near ; CODE	XREF: _ssl3_connect+2D9p
					; _ssl3_get_key_exchange+2EBp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 18h
		call	__chkstk
		push	ebx
		mov	ebx, [esp+1Ch+arg_0]
		push	ebp
		mov	ebp, 28h ; '('
		mov	eax, [ebx+58h]
		mov	eax, [eax+344h]
		mov	ecx, [eax+0Ch]
		mov	eax, [eax+10h]
		mov	[esp+20h+arg_0], ecx
		mov	[esp+20h+var_14], eax
		test	al, 24h
		jnz	loc_E66
		test	ecx, 100h
		jnz	loc_E66
		mov	eax, [ebx+0C0h]
		push	esi
		push	edi
		mov	edx, [eax+98h]
		mov	[esp+28h+var_8], edx
		test	edx, edx
		jnz	short loc_A97
		push	0DB5h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	82h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_A97:				; CODE XREF: _ssl3_check_cert_and_algorithm+54j
		mov	eax, [edx+0ECh]
		mov	esi, [edx+4]
		mov	[esp+28h+var_C], eax
		mov	eax, [edx+0F0h]
		mov	[esp+28h+var_18], eax
		cmp	esi, 5
		jnz	short loc_ADE
		push	ebx
		push	dword ptr [edx+98h]
		call	_ssl_check_srvr_ecc_cert_and_alg
		add	esp, 8
		test	eax, eax
		jnz	loc_E59
		push	0DC6h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	130h
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_ADE:				; CODE XREF: _ssl3_check_cert_and_algorithm+95j
		test	byte ptr [esp+28h+var_14], 40h
		jz	short loc_AF9
		push	0DCDh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	17Dh
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_AF9:				; CODE XREF: _ssl3_check_cert_and_algorithm+C7j
		test	cl, 60h
		jz	short loc_B12
		push	0DD0h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	17Eh
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_B12:				; CODE XREF: _ssl3_check_cert_and_algorithm+E0j
		lea	eax, ds:0[esi*8]
		sub	eax, esi
		push	dword ptr [edx+eax*4+0Ch]
		lea	esi, [edx+eax*4]
		call	_X509_get_pubkey
		mov	edi, eax
		push	edi
		call	_EVP_PKEY_bits
		push	edi
		push	dword ptr [esi+0Ch]
		mov	[esp+38h+var_10], eax
		call	_X509_certificate_type
		push	edi
		mov	esi, eax
		call	_EVP_PKEY_free
		mov	eax, [esp+3Ch+var_14]
		add	esp, 14h
		test	al, 1
		jz	short loc_B6D
		mov	ecx, esi
		and	ecx, 11h
		cmp	cl, 11h
		jz	short loc_B6D
		push	0DDCh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0AAh ; 'ª'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_B6D:				; CODE XREF: _ssl3_check_cert_and_algorithm+131j
					; _ssl3_check_cert_and_algorithm+13Bj
		test	al, 2
		jz	short loc_B8E
		mov	eax, esi
		and	eax, 12h
		cmp	al, 12h
		jz	short loc_B8E
		push	0DE2h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A5h ; '¥'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_B8E:				; CODE XREF: _ssl3_check_cert_and_algorithm+153j
					; _ssl3_check_cert_and_algorithm+15Cj
		mov	ecx, [esp+28h+arg_0]
		mov	edi, 400h
		mov	eax, ecx
		and	eax, 1
		mov	[esp+28h+var_4], eax
		jz	loc_C2E
		mov	eax, [ebx+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+20h]
		mov	edx, eax
		mov	[esp+28h+var_14], eax
		and	edx, 2
		jnz	short loc_BDE
		mov	eax, esi
		and	eax, 21h
		cmp	al, 21h	; '!'
		jz	short loc_BDA
		push	0DEBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A9h ; '©'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_BDA:				; CODE XREF: _ssl3_check_cert_and_algorithm+1A8j
		mov	eax, [esp+28h+var_14]

loc_BDE:				; CODE XREF: _ssl3_check_cert_and_algorithm+19Fj
		test	edx, edx
		jz	short loc_C2E
		test	al, 8
		mov	edx, 200h
		mov	eax, edi
		cmovnz	eax, edx
		cmp	[esp+28h+var_10], eax
		jg	short loc_C2E
		mov	eax, esi
		and	eax, 21h
		cmp	al, 21h	; '!'
		jz	short loc_C11
		push	0DF1h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A9h ; '©'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_C11:				; CODE XREF: _ssl3_check_cert_and_algorithm+1DFj
		cmp	[esp+28h+var_C], 0
		jz	short loc_C2E
		push	0DF7h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	ebp, 50h ; 'P'
		push	44h ; 'D'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_C2E:				; CODE XREF: _ssl3_check_cert_and_algorithm+184j
					; _ssl3_check_cert_and_algorithm+1C4j ...
		mov	edx, ecx
		and	edx, 8
		mov	[esp+28h+var_14], edx
		jz	short loc_C56
		cmp	[esp+28h+var_18], 0
		jnz	short loc_C56
		push	0E01h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	ebp, 50h ; 'P'
		push	44h ; 'D'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_C56:				; CODE XREF: _ssl3_check_cert_and_algorithm+21Bj
					; _ssl3_check_cert_and_algorithm+222j
		test	cl, 2
		jz	short loc_C89
		mov	eax, [ebx+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	short loc_C89
		mov	eax, esi
		and	eax, 104h
		cmp	eax, 104h
		jz	short loc_C89
		push	0E07h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A4h ; '¤'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_C89:				; CODE XREF: _ssl3_check_cert_and_algorithm+23Dj
					; _ssl3_check_cert_and_algorithm+249j ...
		test	cl, 4
		jz	short loc_CBC
		mov	eax, [ebx+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	short loc_CBC
		and	esi, 204h
		cmp	esi, 204h
		jz	short loc_CBC
		push	0E0Eh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A2h ; '¢'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_CBC:				; CODE XREF: _ssl3_check_cert_and_algorithm+270j
					; _ssl3_check_cert_and_algorithm+27Cj ...
		test	cl, 0Eh
		jz	loc_D47
		test	edx, edx
		jz	short loc_CDC
		mov	eax, [esp+28h+var_18]
		push	dword ptr [eax+8]
		call	_BN_num_bits
		add	esp, 4
		mov	esi, eax
		jmp	short loc_D0A
; ---------------------------------------------------------------------------

loc_CDC:				; CODE XREF: _ssl3_check_cert_and_algorithm+2ABj
		push	[esp+28h+var_8]
		call	_get_server_static_dh_key
		add	esp, 4
		mov	[esp+28h+var_8], eax
		test	eax, eax
		jz	$f_err$51
		push	dword ptr [eax+8]
		call	_BN_num_bits
		push	[esp+2Ch+var_8]
		mov	esi, eax
		call	_DH_free
		add	esp, 8

loc_D0A:				; CODE XREF: _ssl3_check_cert_and_algorithm+2BEj
		mov	eax, [ebx+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+20h]
		and	eax, 2
		jnz	short loc_D1F
		cmp	esi, edi
		jl	short loc_D2B

loc_D1F:				; CODE XREF: _ssl3_check_cert_and_algorithm+2FDj
		test	eax, eax
		jz	short loc_D3F
		cmp	esi, 200h
		jge	short loc_D3F

loc_D2B:				; CODE XREF: _ssl3_check_cert_and_algorithm+301j
		push	0E21h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	174h
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_D3F:				; CODE XREF: _ssl3_check_cert_and_algorithm+305j
					; _ssl3_check_cert_and_algorithm+30Dj
		mov	edx, [esp+28h+var_14]
		mov	ecx, [esp+28h+arg_0]

loc_D47:				; CODE XREF: _ssl3_check_cert_and_algorithm+2A3j
		mov	eax, [ebx+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+20h]
		test	al, 2
		jz	loc_E59
		test	al, 8
		mov	esi, 200h
		mov	eax, edi
		cmovnz	eax, esi
		cmp	[esp+28h+var_10], eax
		jle	loc_E59
		cmp	[esp+28h+var_4], 0
		jz	short loc_DCD
		mov	eax, [esp+28h+var_C]
		test	eax, eax
		jnz	short loc_D94
		push	0E2Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A7h ; '§'
		jmp	loc_E34
; ---------------------------------------------------------------------------

loc_D94:				; CODE XREF: _ssl3_check_cert_and_algorithm+362j
		push	dword ptr [eax+10h]
		call	_BN_num_bits
		mov	ecx, [ebx+58h]
		add	esp, 4
		mov	ecx, [ecx+344h]
		test	byte ptr [ecx+20h], 8
		cmovnz	edi, esi
		cmp	eax, edi
		jle	loc_E59
		push	0E34h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	ebp, 3Ch ; '<'
		push	0A7h ; '§'
		jmp	short loc_E34
; ---------------------------------------------------------------------------

loc_DCD:				; CODE XREF: _ssl3_check_cert_and_algorithm+35Aj
		test	edx, edx
		jz	short loc_E0A
		mov	eax, [esp+28h+var_18]
		push	dword ptr [eax+8]
		call	_BN_num_bits
		mov	ecx, [ebx+58h]
		add	esp, 4
		mov	ecx, [ecx+344h]
		test	byte ptr [ecx+20h], 8
		cmovnz	edi, esi
		cmp	eax, edi
		jle	short loc_E59
		push	0E40h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	ebp, 3Ch ; '<'
		push	0A6h ; '¦'
		jmp	short loc_E34
; ---------------------------------------------------------------------------

loc_E0A:				; CODE XREF: _ssl3_check_cert_and_algorithm+3B3j
		test	cl, 6
		jz	short loc_E25
		push	0E47h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	ebp, 3Ch ; '<'
		push	0A6h ; '¦'
		jmp	short loc_E34
; ---------------------------------------------------------------------------

loc_E25:				; CODE XREF: _ssl3_check_cert_and_algorithm+3F1j
		push	0E4Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0FAh ; 'ú'

loc_E34:				; CODE XREF: _ssl3_check_cert_and_algorithm+BDj
					; _ssl3_check_cert_and_algorithm+D8j ...
		push	82h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$f_err$51:				; CODE XREF: _ssl3_check_cert_and_algorithm+2D2j
		push	ebp
		push	2
		push	ebx
		call	_ssl3_send_alert
		add	esp, 0Ch

$err$52:
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_E59:				; CODE XREF: _ssl3_check_cert_and_algorithm+A8j
					; _ssl3_check_cert_and_algorithm+339j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_E66:				; CODE XREF: _ssl3_check_cert_and_algorithm+2Ej
					; _ssl3_check_cert_and_algorithm+3Aj
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 18h
		retn
_ssl3_check_cert_and_algorithm endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E74h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl3_check_client_certificate proc near ; CODE	XREF: _ssl3_send_client_certificate+7Cp
					; _ssl3_send_client_certificate+152p

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		mov	ecx, [edi+98h]
		test	ecx, ecx
		jz	short loc_EA2
		mov	edx, [ecx]
		cmp	dword ptr [edx], 0
		jz	short loc_EA2
		cmp	dword ptr [edx+4], 0
		jz	short loc_EA2
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	short loc_EA6
		cmp	dword ptr [edx+8], 0
		jnz	short loc_EA6

loc_EA2:				; CODE XREF: _ssl3_check_client_certificate+Dj
					; _ssl3_check_client_certificate+14j ...
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_EA6:				; CODE XREF: _ssl3_check_client_certificate+26j
					; _ssl3_check_client_certificate+2Cj
		test	dword ptr [ecx+38h], 30001h
		jz	short loc_EC4
		push	0FFFFFFFEh
		push	0
		push	0
		push	0
		push	edi
		call	_tls1_check_chain
		add	esp, 14h
		test	eax, eax
		jz	short loc_EA2

loc_EC4:				; CODE XREF: _ssl3_check_client_certificate+39j
		mov	eax, [edi+58h]
		push	ebx
		push	ebp
		push	esi
		mov	eax, [eax+344h]
		test	byte ptr [eax+0Ch], 6
		jz	short loc_F41
		mov	eax, [edi+0C0h]
		mov	ebx, [eax+98h]
		mov	eax, [edi+98h]
		mov	esi, [ebx+4]
		mov	eax, [eax]
		mov	ebp, [eax+4]
		push	ebp
		call	_EVP_PKEY_id
		add	esp, 4
		cmp	eax, 1Ch
		jnz	short loc_F41
		test	esi, esi
		js	short loc_F3B
		lea	eax, ds:0[esi*8]
		sub	eax, esi
		push	dword ptr [ebx+eax*4+0Ch]
		call	_X509_get_pubkey
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	short loc_F3B
		push	ebx
		push	ebp
		call	_EVP_PKEY_cmp_parameters
		push	ebx
		mov	esi, eax
		call	_EVP_PKEY_free
		add	esp, 0Ch
		cmp	esi, 1
		jz	short loc_F3B
		pop	esi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_F3B:				; CODE XREF: _ssl3_check_client_certificate+8Cj
					; _ssl3_check_client_certificate+A7j ...
		mov	eax, [edi+58h]
		or	dword ptr [eax], 10h

loc_F41:				; CODE XREF: _ssl3_check_client_certificate+60j
					; _ssl3_check_client_certificate+88j
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, 1
		pop	edi
		retn
_ssl3_check_client_certificate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl3_check_finished proc near		; CODE XREF: _ssl3_connect+1C0p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	[esp+8+var_4], 0
		cmp	dword ptr [esi], 301h
		jl	loc_1023
		cmp	dword ptr [esi+168h], 0
		jz	loc_1023
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+0E4h], 0
		jz	loc_1023
		mov	eax, [esi+58h]
		lea	ecx, [esp+8+var_4]
		push	ecx
		or	dword ptr [eax], 80h
		push	dword ptr [esi+108h]
		mov	eax, [esi+8]
		push	0FFFFFFFFh
		push	1131h
		push	1130h
		mov	eax, [eax+30h]
		push	esi
		call	eax
		mov	eax, [esi+58h]
		add	esp, 18h
		and	dword ptr [eax], 0FFFFFF7Fh
		cmp	[esp+8+var_4], 0
		jz	short loc_101D
		mov	eax, [esi+58h]
		mov	dword ptr [eax+354h], 1
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+340h], 14h
		jnz	short loc_FEC
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_FEC:				; CODE XREF: _ssl3_check_finished+96j
		cmp	dword ptr [eax+180h], 0
		jz	short loc_1023
		push	0E82h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	85h ; ''
		push	153h
		push	14h
		call	_ERR_put_error
		push	0Ah
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 20h

loc_101D:				; CODE XREF: _ssl3_check_finished+7Dj
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1023:				; CODE XREF: _ssl3_check_finished+1Dj
					; _ssl3_check_finished+2Aj ...
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
_ssl3_check_finished endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1028h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_client_hello
_ssl3_client_hello proc	near		; CODE XREF: _ssl3_connect+14Bp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 0Ch
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		mov	[esp+18h+var_C], 0
		push	edi
		cmp	dword ptr [esi+34h], 1110h
		mov	eax, [esi+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch+var_4], eax
		jnz	loc_1387
		mov	ecx, [esi+0C0h]
		test	ecx, ecx
		jz	short loc_1081
		mov	eax, [ecx]
		cmp	eax, [esi]
		jnz	short loc_1081
		cmp	dword ptr [ecx+44h], 0
		jnz	short loc_1078
		cmp	dword ptr [ecx+0E4h], 0
		jz	short loc_1081

loc_1078:				; CODE XREF: _ssl3_client_hello+45j
		cmp	dword ptr [ecx+94h], 0
		jz	short loc_1090

loc_1081:				; CODE XREF: _ssl3_client_hello+39j
					; _ssl3_client_hello+3Fj ...
		push	0
		push	esi
		call	_ssl_get_new_session
		add	esp, 8
		test	eax, eax
		jz	short $err$51

loc_1090:				; CODE XREF: _ssl3_client_hello+57j
		mov	eax, [esi+8]
		cmp	dword ptr [eax], 1FFFFh
		jnz	loc_1133
		mov	ecx, [esi+100h]
		test	ecx, 8000000h
		jz	short loc_1115
		mov	eax, [esi+98h]
		test	dword ptr [eax+38h], 30000h
		jz	short loc_10EC
		push	2C4h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	183h

loc_10CB:				; CODE XREF: _ssl3_client_hello+DBj
					; _ssl3_client_hello+1B4j ...
		push	83h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err$51:				; CODE XREF: _ssl3_client_hello+66j
					; _ssl3_client_hello+13Ej
		pop	edi
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10EC:				; CODE XREF: _ssl3_client_hello+92j
		test	ecx, 4000000h
		jz	short loc_1105
		push	2CBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10Ah
		jmp	short loc_10CB
; ---------------------------------------------------------------------------

loc_1105:				; CODE XREF: _ssl3_client_hello+CAj
		call	_DTLSv1_client_method
		mov	[esi+8], eax
		mov	dword ptr [esi], 0FEFFh
		jmp	short loc_112B
; ---------------------------------------------------------------------------

loc_1115:				; CODE XREF: _ssl3_client_hello+83j
		test	ecx, 4000000h
		jz	short loc_1125
		call	_DTLSv1_2_client_method
		mov	[esi+8], eax

loc_1125:				; CODE XREF: _ssl3_client_hello+F3j
		mov	dword ptr [esi], 0FEFDh

loc_112B:				; CODE XREF: _ssl3_client_hello+EBj
		mov	eax, [esi]
		mov	[esi+110h], eax

loc_1133:				; CODE XREF: _ssl3_client_hello+71j
		mov	eax, [esi+8]
		mov	ecx, [esi+58h]
		add	ecx, 0C0h ; 'À'
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_1156
		xor	eax, eax

loc_114A:				; CODE XREF: _ssl3_client_hello+12Cj
		cmp	byte ptr [eax+ecx], 0
		jnz	short loc_116C
		inc	eax
		cmp	eax, 20h ; ' '
		jb	short loc_114A

loc_1156:				; CODE XREF: _ssl3_client_hello+11Ej
		push	20h ; ' '
		push	ecx
		push	0
		push	esi
		call	_ssl_fill_hello_random
		add	esp, 10h
		test	eax, eax
		jle	$err$51

loc_116C:				; CODE XREF: _ssl3_client_hello+126j
		mov	eax, [esi+8]
		mov	ecx, [esi+3Ch]
		mov	eax, [eax+64h]
		mov	edi, [eax+3Ch]
		add	edi, [ecx+4]
		mov	eax, [esi+110h]
		mov	ebp, edi
		sar	eax, 8
		mov	[esp+1Ch+var_8], ebp
		mov	[edi], al
		mov	al, [esi+110h]
		mov	[edi+1], al
		mov	eax, [esi+58h]
		movups	xmm0, xmmword ptr [eax+0C0h]
		movups	xmmword	ptr [edi+2], xmm0
		movups	xmm0, xmmword ptr [eax+0D0h]
		movups	xmmword	ptr [edi+12h], xmm0
		cmp	dword ptr [esi+28h], 0
		jz	short loc_11B8
		xor	ebx, ebx
		jmp	short loc_11C1
; ---------------------------------------------------------------------------

loc_11B8:				; CODE XREF: _ssl3_client_hello+18Aj
		mov	eax, [esi+0C0h]
		mov	ebx, [eax+44h]

loc_11C1:				; CODE XREF: _ssl3_client_hello+18Ej
		mov	[edi+22h], bl
		add	edi, 23h ; '#'
		test	ebx, ebx
		jz	short loc_11F7
		cmp	ebx, 20h ; ' '
		jle	short loc_11E1
		push	32Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		jmp	loc_10CB
; ---------------------------------------------------------------------------

loc_11E1:				; CODE XREF: _ssl3_client_hello+1A6j
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		add	eax, 48h ; 'H'
		push	eax		; Src
		push	edi		; Dst
		call	_memcpy
		add	esp, 0Ch
		add	edi, ebx

loc_11F7:				; CODE XREF: _ssl3_client_hello+1A1j
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_124B
		mov	eax, [esi+5Ch]
		cmp	dword ptr [eax+204h], 100h
		jbe	short loc_1223
		push	335h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		jmp	loc_10CB
; ---------------------------------------------------------------------------

loc_1223:				; CODE XREF: _ssl3_client_hello+1E8j
		mov	al, [eax+204h]
		mov	[edi], al
		inc	edi
		mov	eax, [esi+5Ch]
		push	dword ptr [eax+204h] ; Size
		add	eax, 4
		push	eax		; Src
		push	edi		; Dst
		call	_memcpy
		mov	eax, [esi+5Ch]
		add	esp, 0Ch
		add	edi, [eax+204h]

loc_124B:				; CODE XREF: _ssl3_client_hello+1D9j
		push	0
		lea	eax, [edi+2]
		push	eax
		push	esi
		call	_SSL_get_ciphers
		add	esp, 4
		push	eax
		push	esi
		call	_ssl_cipher_list_to_bytes
		mov	ecx, eax
		add	esp, 10h
		test	ecx, ecx
		jnz	short loc_127E
		push	340h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0B5h ; 'µ'
		jmp	loc_10CB
; ---------------------------------------------------------------------------

loc_127E:				; CODE XREF: _ssl3_client_hello+240j
		mov	eax, ecx
		mov	[edi+1], cl
		sar	eax, 8
		mov	[edi], al
		add	edi, ecx
		test	dword ptr [esi+100h], 20000h
		jnz	short loc_12B3
		mov	eax, [esi+0E4h]
		mov	eax, [eax+98h]
		test	eax, eax
		jz	short loc_12B3
		push	eax
		call	_sk_num
		add	esp, 4
		mov	ecx, eax
		jmp	short loc_12B5
; ---------------------------------------------------------------------------

loc_12B3:				; CODE XREF: _ssl3_client_hello+26Cj
					; _ssl3_client_hello+27Cj
		xor	ecx, ecx

loc_12B5:				; CODE XREF: _ssl3_client_hello+289j
		lea	eax, [ecx+1]
		mov	[esp+1Ch+arg_0], ecx
		mov	[edi+2], al
		xor	ebx, ebx
		add	edi, 3
		test	ecx, ecx
		jle	short loc_12ED
		mov	ebp, ecx

loc_12CA:				; CODE XREF: _ssl3_client_hello+2BFj
		mov	eax, [esi+0E4h]
		push	ebx
		push	dword ptr [eax+98h]
		call	_sk_value
		inc	ebx
		add	esp, 8
		mov	al, [eax]
		mov	[edi], al
		inc	edi
		cmp	ebx, ebp
		jl	short loc_12CA
		mov	ebp, [esp+1Ch+var_8]

loc_12ED:				; CODE XREF: _ssl3_client_hello+29Ej
		push	esi
		mov	byte ptr [edi],	0
		call	_ssl_prepare_clienthello_tlsext
		add	esp, 4
		test	eax, eax
		jg	short loc_1311
		push	365h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0E2h ; 'â'
		jmp	loc_10CB
; ---------------------------------------------------------------------------

loc_1311:				; CODE XREF: _ssl3_client_hello+2D3j
		lea	eax, [esp+1Ch+var_C]
		push	eax
		mov	eax, [esp+20h+var_4]
		add	eax, 4000h
		push	eax
		lea	eax, [edi+1]
		push	eax
		push	esi
		call	_ssl_add_clienthello_tlsext
		mov	ecx, eax
		add	esp, 10h
		test	ecx, ecx
		jnz	short loc_136C
		push	[esp+1Ch+var_C]
		push	2
		push	esi
		call	_ssl3_send_alert
		push	36Ch
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	83h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_136C:				; CODE XREF: _ssl3_client_hello+309j
		mov	eax, [esi+8]
		sub	ecx, ebp
		push	ecx
		push	1
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 1111h

loc_1387:				; CODE XREF: _ssl3_client_hello+2Bj
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
_ssl3_client_hello endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_cert_status
_ssl3_get_cert_status proc near		; CODE XREF: _ssl3_connect+563p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	ecx, [esp+4+arg_0]
		push	ecx
		push	4000h
		push	0FFFFFFFFh
		mov	eax, [esi+8]
		push	11F1h
		push	11F0h
		push	esi
		mov	eax, [eax+30h]
		call	eax
		add	esp, 18h
		mov	edx, eax
		cmp	[esp+4+arg_0], 0
		jz	loc_14FB
		mov	eax, [esi+58h]
		push	edi
		cmp	dword ptr [eax+340h], 16h
		jz	short loc_13F0
		mov	dword ptr [eax+354h], 1
		jmp	loc_1486
; ---------------------------------------------------------------------------

loc_13F0:				; CODE XREF: _ssl3_get_cert_status+3Fj
		cmp	edx, 4
		jnb	short loc_140E
		push	942h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	edi, 32h ; '2'
		push	9Fh ; ''
		jmp	loc_14CD
; ---------------------------------------------------------------------------

loc_140E:				; CODE XREF: _ssl3_get_cert_status+53j
		mov	ecx, [esi+40h]
		cmp	byte ptr [ecx],	1
		jz	short loc_142F
		push	948h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	edi, 32h ; '2'
		push	149h
		jmp	loc_14CD
; ---------------------------------------------------------------------------

loc_142F:				; CODE XREF: _ssl3_get_cert_status+74j
		movzx	edi, byte ptr [ecx+1]
		movzx	eax, byte ptr [ecx+2]
		shl	edi, 8
		or	edi, eax
		movzx	eax, byte ptr [ecx+3]
		shl	edi, 8
		or	edi, eax
		lea	eax, [edi+4]
		cmp	eax, edx
		jz	short loc_1462
		push	94Eh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	edi, 32h ; '2'
		push	9Fh ; ''
		jmp	short loc_14CD
; ---------------------------------------------------------------------------

loc_1462:				; CODE XREF: _ssl3_get_cert_status+AAj
		lea	eax, [ecx+4]
		push	edi
		push	eax
		call	_BUF_memdup
		add	esp, 8
		mov	[esi+138h], eax
		test	eax, eax
		jnz	short loc_1480
		push	954h
		jmp	short loc_14C1
; ---------------------------------------------------------------------------

loc_1480:				; CODE XREF: _ssl3_get_cert_status+D7j
		mov	[esi+13Ch], edi

loc_1486:				; CODE XREF: _ssl3_get_cert_status+4Bj
		mov	eax, [esi+0E4h]
		mov	ecx, [eax+13Ch]
		test	ecx, ecx
		jz	short loc_14F5
		push	dword ptr [eax+140h]
		push	esi
		call	ecx
		add	esp, 8
		test	eax, eax
		jnz	short loc_14BA
		push	95Eh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		lea	edi, [eax+71h]
		push	148h
		jmp	short loc_14CD
; ---------------------------------------------------------------------------

loc_14BA:				; CODE XREF: _ssl3_get_cert_status+104j
		jns	short loc_14F5
		push	963h

loc_14C1:				; CODE XREF: _ssl3_get_cert_status+DEj
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		mov	edi, 50h ; 'P'

loc_14CD:				; CODE XREF: _ssl3_get_cert_status+69j
					; _ssl3_get_cert_status+8Aj ...
		push	121h
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$f_err$18:
		push	edi
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_14F5:				; CODE XREF: _ssl3_get_cert_status+F4j
					; _ssl3_get_cert_status:loc_14BAj
		mov	eax, 1
		pop	edi

loc_14FB:				; CODE XREF: _ssl3_get_cert_status+2Ej
		pop	esi
		retn
_ssl3_get_cert_status endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1500h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl3_get_certificate_request(size_t Size)
		public _ssl3_get_certificate_request
_ssl3_get_certificate_request proc near	; CODE XREF: _ssl3_connect+2EFp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Size		= dword	ptr  4

		mov	eax, 1Ch
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+2Ch+Size]
		lea	ecx, [esp+2Ch+var_C]
		push	ecx
		xor	esi, esi
		xor	ebp, ebp
		xor	ebx, ebx
		push	dword ptr [edi+108h]
		mov	eax, [edi+8]
		push	0FFFFFFFFh
		push	1151h
		push	1150h
		mov	eax, [eax+30h]
		push	edi
		call	eax
		add	esp, 18h
		mov	[esp+2Ch+var_14], eax
		cmp	[esp+2Ch+var_C], ebx
		jz	loc_1ABC
		mov	eax, [edi+58h]
		mov	[eax+358h], ebx
		mov	eax, [edi+58h]
		mov	ecx, [eax+340h]
		cmp	ecx, 0Eh
		jnz	short loc_1593
		mov	dword ptr [eax+354h], 1
		mov	eax, [edi+58h]
		cmp	[eax+178h], ebx
		jz	short loc_1586
		push	edi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	$err$67

loc_1586:				; CODE XREF: _ssl3_get_certificate_request+73j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1593:				; CODE XREF: _ssl3_get_certificate_request+5Ej
		cmp	ecx, 0Dh
		jz	short loc_15CC
		push	0Ah
		push	2
		push	edi
		call	_ssl3_send_alert
		push	824h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	106h
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_15CC:				; CODE XREF: _ssl3_get_certificate_request+96j
		cmp	dword ptr [edi], 300h
		jle	short loc_1614
		mov	eax, [eax+344h]
		test	byte ptr [eax+10h], 4
		jz	short loc_1614
		push	0Ah
		push	2
		push	edi
		call	_ssl3_send_alert
		push	82Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0E8h ; 'è'
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_1614:				; CODE XREF: _ssl3_get_certificate_request+D2j
					; _ssl3_get_certificate_request+DEj
		mov	esi, [edi+40h]
		push	offset _ca_dn_cmp
		mov	[esp+30h+var_18], esi
		call	_sk_new
		mov	ebx, eax
		add	esp, 4
		mov	[esp+2Ch+var_1C], ebx
		test	ebx, ebx
		jnz	short loc_165B
		push	835h

loc_1637:				; CODE XREF: _ssl3_get_certificate_request+4CCj
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	dword ptr [edi+34h], 5
		xor	esi, esi
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_165B:				; CODE XREF: _ssl3_get_certificate_request+130j
		mov	eax, [edi+98h]
		movzx	ecx, byte ptr [esi]
		inc	esi
		mov	[esp+2Ch+Size],	ecx
		mov	eax, [eax+11Ch]
		test	eax, eax
		jz	short loc_168C
		push	eax
		call	_CRYPTO_free
		mov	eax, [edi+98h]
		add	esp, 4
		mov	ecx, [esp+2Ch+Size]
		mov	[eax+11Ch], ebp

loc_168C:				; CODE XREF: _ssl3_get_certificate_request+171j
		cmp	ecx, 9
		jbe	short loc_16E0
		push	841h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	ecx
		call	_CRYPTO_malloc
		mov	ecx, [edi+98h]
		mov	[ecx+11Ch], eax
		mov	ecx, [esp+38h+Size]
		mov	eax, [edi+98h]
		push	ecx		; Size
		push	esi		; Src
		push	dword ptr [eax+11Ch] ; Dst
		call	_memcpy
		mov	eax, [edi+98h]
		add	esp, 18h
		mov	ecx, [esp+2Ch+Size]
		mov	[eax+120h], ecx
		mov	ecx, 9
		mov	[esp+2Ch+Size],	ecx

loc_16E0:				; CODE XREF: _ssl3_get_certificate_request+18Fj
		xor	edx, edx
		test	ecx, ecx
		jz	short loc_1704
		mov	ebp, [esp+2Ch+Size]
		nop	word ptr [eax+eax+00h]

loc_16F0:				; CODE XREF: _ssl3_get_certificate_request+200j
		mov	ecx, [edi+58h]
		mov	al, [edx+esi]
		mov	[ecx+edx+360h],	al
		inc	edx
		cmp	edx, ebp
		jb	short loc_16F0
		xor	ebp, ebp

loc_1704:				; CODE XREF: _ssl3_get_certificate_request+1E4j
		movzx	eax, byte ptr [esi-1]
		add	esi, eax
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	loc_18C5
		movzx	ecx, byte ptr [esi]
		movzx	eax, byte ptr [esi+1]
		add	esi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ecx
		mov	[esp+2Ch+var_8], ecx
		sub	eax, [esp+2Ch+var_18]
		add	eax, 2
		add	eax, esi
		cmp	eax, [esp+2Ch+var_14]
		jbe	short loc_1774
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	852h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	92h ; ''
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		xor	esi, esi
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_1774:				; CODE XREF: _ssl3_get_certificate_request+23Cj
		mov	eax, [edi+98h]
		mov	dword ptr [eax+44h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+54h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+60h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+70h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+7Ch], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+8Ch], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+98h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0A8h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0B4h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0C4h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0D0h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0E0h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0ECh], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+0FCh], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+108h], 0
		mov	eax, [edi+98h]
		mov	dword ptr [eax+118h], 0
		test	cl, 1
		jnz	loc_191C
		push	ecx
		push	esi
		push	edi
		call	_tls1_save_sigalgs
		add	esp, 0Ch
		test	eax, eax
		jz	loc_191C
		push	edi
		call	_tls1_process_sigalgs
		add	esp, 4
		test	eax, eax
		jnz	short loc_18C1
		push	50h ; 'P'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	862h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		xor	esi, esi
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_18C1:				; CODE XREF: _ssl3_get_certificate_request+38Cj
		add	esi, [esp+2Ch+var_8]

loc_18C5:				; CODE XREF: _ssl3_get_certificate_request+214j
		movzx	edx, byte ptr [esi]
		movzx	eax, byte ptr [esi+1]
		add	esi, 2
		shl	edx, 8
		or	edx, eax
		mov	eax, edx
		mov	[esp+2Ch+var_4], edx
		sub	eax, [esp+2Ch+var_18]
		add	eax, esi
		cmp	eax, [esp+2Ch+var_14]
		jz	short loc_1952
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	875h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	9Fh ; ''
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		xor	esi, esi
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_191C:				; CODE XREF: _ssl3_get_certificate_request+368j
					; _ssl3_get_certificate_request+37Bj
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	85Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	168h
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [edi+34h], 5
		xor	esi, esi
		jmp	$done$68
; ---------------------------------------------------------------------------

loc_1952:				; CODE XREF: _ssl3_get_certificate_request+3E4j
		xor	ecx, ecx
		test	edx, edx
		jz	loc_1A5C
		nop	dword ptr [eax+00h]

loc_1960:				; CODE XREF: _ssl3_get_certificate_request+4C0j
		movzx	ebx, byte ptr [esi]
		add	ecx, 2
		movzx	eax, byte ptr [esi+1]
		add	esi, 2
		shl	ebx, 8
		or	ebx, eax
		add	ecx, ebx
		mov	[esp+2Ch+var_8], ecx
		cmp	ecx, edx
		ja	loc_1A10
		push	ebx
		lea	eax, [esp+30h+var_10]
		mov	[esp+30h+var_10], esi
		push	eax
		push	0
		call	_d2i_X509_NAME
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jz	short loc_19EC
		add	esi, ebx
		cmp	[esp+2Ch+var_10], esi
		jnz	short loc_19D1
		mov	ebx, [esp+2Ch+var_1C]
		push	ebp
		push	ebx
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_19C7
		mov	ecx, [esp+2Ch+var_8]
		xor	ebp, ebp
		mov	edx, [esp+2Ch+var_4]
		cmp	ecx, edx
		jb	short loc_1960
		jmp	loc_1A5C
; ---------------------------------------------------------------------------

loc_19C7:				; CODE XREF: _ssl3_get_certificate_request+4B2j
		push	897h
		jmp	loc_1637
; ---------------------------------------------------------------------------

loc_19D1:				; CODE XREF: _ssl3_get_certificate_request+4A0j
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	893h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	83h ; ''
		jmp	short loc_1A35
; ---------------------------------------------------------------------------

loc_19EC:				; CODE XREF: _ssl3_get_certificate_request+498j
		test	dword ptr [edi+100h], 20000000h
		jnz	short $cont$69
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	88Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0Dh
		jmp	short loc_1A35
; ---------------------------------------------------------------------------

loc_1A10:				; CODE XREF: _ssl3_get_certificate_request+47Aj
		test	dword ptr [edi+100h], 20000000h
		jnz	short $cont$69
		push	32h ; '2'
		push	2
		push	edi
		call	_ssl3_send_alert
		push	87Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	84h ; ''

loc_1A35:				; CODE XREF: _ssl3_get_certificate_request+4EAj
					; _ssl3_get_certificate_request+50Ej
		push	87h ; ''
		push	14h
		call	_ERR_put_error
		mov	ebx, [esp+4Ch+var_1C]
		add	esp, 20h
		xor	esi, esi

$err$67:				; CODE XREF: _ssl3_get_certificate_request+80j
		mov	dword ptr [edi+34h], 5
		jmp	short $done$68
; ---------------------------------------------------------------------------

$cont$69:				; CODE XREF: _ssl3_get_certificate_request+4F6j
					; _ssl3_get_certificate_request+51Aj
		call	_ERR_clear_error
		mov	ebx, [esp+2Ch+var_1C]

loc_1A5C:				; CODE XREF: _ssl3_get_certificate_request+456j
					; _ssl3_get_certificate_request+4C2j
		mov	eax, [edi+58h]
		mov	ecx, [esp+2Ch+Size]
		mov	dword ptr [eax+358h], 1
		mov	eax, [edi+58h]
		mov	[eax+35Ch], ecx
		mov	eax, [edi+58h]
		mov	eax, [eax+36Ch]
		test	eax, eax
		jz	short loc_1A91
		push	offset _X509_NAME_free
		push	eax
		call	_sk_pop_free
		add	esp, 8

loc_1A91:				; CODE XREF: _ssl3_get_certificate_request+581j
		mov	eax, [edi+58h]
		mov	[eax+36Ch], ebx
		xor	ebx, ebx
		lea	esi, [ebx+1]

$done$68:				; CODE XREF: _ssl3_get_certificate_request+C7j
					; _ssl3_get_certificate_request+10Fj ...
		push	ebp
		call	_X509_NAME_free
		add	esp, 4
		test	ebx, ebx
		jz	short loc_1ABA
		push	offset _X509_NAME_free
		push	ebx
		call	_sk_pop_free
		add	esp, 8

loc_1ABA:				; CODE XREF: _ssl3_get_certificate_request+5AAj
		mov	eax, esi

loc_1ABC:				; CODE XREF: _ssl3_get_certificate_request+43j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
_ssl3_get_certificate_request endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1AC4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_key_exchange
_ssl3_get_key_exchange proc near	; CODE XREF: _ssl3_connect+2B8p

var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= byte ptr -0A0h
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 0D4h ; 'Ô'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0D4h+var_4], eax
		push	ebx
		mov	ebx, [esp+0D8h+arg_0]
		lea	eax, [esp+0D8h+var_A0]
		push	ebp
		push	eax
		mov	[esp+0E0h+var_CC], 0
		mov	[esp+0E0h+var_A8], 0
		mov	[esp+0E0h+var_B0], 0
		mov	[esp+0E0h+var_C0], 0
		mov	[esp+0E0h+var_BC], 0
		mov	[esp+0E0h+var_AC], 0
		mov	[esp+0E0h+var_C4], 0
		call	_EVP_MD_CTX_init
		mov	eax, [ebx+8]
		lea	ecx, [esp+0E0h+var_88]
		push	ecx
		push	dword ptr [ebx+108h]
		mov	eax, [eax+30h]
		push	0FFFFFFFFh
		push	1141h
		push	1140h
		push	ebx
		call	eax
		add	esp, 1Ch
		mov	ebp, eax
		cmp	[esp+0DCh+var_88], 0
		jz	loc_2AA9
		mov	ecx, [ebx+58h]
		push	esi
		push	edi
		cmp	dword ptr [ecx+340h], 0Ch
		mov	eax, [ecx+344h]
		mov	eax, [eax+0Ch]
		mov	[esp+0E4h+var_D4], eax
		jz	loc_1BFA
		test	al, 88h
		jz	short loc_1BA2
		push	582h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0F4h ; 'ô'
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error
		mov	[esp+0F8h+var_D0], 0Ah
		jmp	loc_2A29
; ---------------------------------------------------------------------------

loc_1BA2:				; CODE XREF: _ssl3_get_key_exchange+B4j
		test	eax, 100h
		jz	short loc_1BE3
		call	_ssl_sess_cert_new
		mov	ecx, [ebx+0C0h]
		mov	[ecx+98h], eax
		mov	eax, [ebx+0E4h]
		mov	eax, [eax+14Ch]
		test	eax, eax
		jz	short loc_1BD3
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1BD3:				; CODE XREF: _ssl3_get_key_exchange+104j
		mov	eax, [ebx+0E4h]
		mov	dword ptr [eax+14Ch], 0

loc_1BE3:				; CODE XREF: _ssl3_get_key_exchange+E3j
		mov	eax, [ebx+58h]
		mov	dword ptr [eax+354h], 1
		mov	eax, 1
		jmp	loc_2AA7
; ---------------------------------------------------------------------------

loc_1BFA:				; CODE XREF: _ssl3_get_key_exchange+ACj
		mov	eax, [ebx+0C0h]
		mov	edi, [ebx+40h]
		mov	[esp+0E4h+var_A4], edi
		mov	eax, [eax+98h]
		test	eax, eax
		jz	loc_1CAA
		mov	eax, [eax+0ECh]
		test	eax, eax
		jz	short loc_1C3E
		push	eax
		call	_RSA_free
		mov	eax, [ebx+0C0h]
		add	esp, 4
		mov	eax, [eax+98h]
		mov	dword ptr [eax+0ECh], 0

loc_1C3E:				; CODE XREF: _ssl3_get_key_exchange+159j
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		mov	eax, [eax+0F0h]
		test	eax, eax
		jz	short loc_1C73
		push	eax
		call	_DH_free
		mov	eax, [ebx+0C0h]
		add	esp, 4
		mov	eax, [eax+98h]
		mov	dword ptr [eax+0F0h], 0

loc_1C73:				; CODE XREF: _ssl3_get_key_exchange+18Ej
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		mov	eax, [eax+0F4h]
		test	eax, eax
		jz	short loc_1CBB
		push	eax
		call	_EC_KEY_free
		mov	eax, [ebx+0C0h]
		add	esp, 4
		mov	eax, [eax+98h]
		mov	dword ptr [eax+0F4h], 0
		jmp	short loc_1CBB
; ---------------------------------------------------------------------------

loc_1CAA:				; CODE XREF: _ssl3_get_key_exchange+14Bj
		call	_ssl_sess_cert_new
		mov	ecx, [ebx+0C0h]
		mov	[ecx+98h], eax

loc_1CBB:				; CODE XREF: _ssl3_get_key_exchange+1C3j
					; _ssl3_get_key_exchange+1E4j
		mov	ecx, [ebx+58h]
		mov	eax, [ecx+344h]
		mov	eax, [eax+10h]
		mov	[esp+0E4h+var_C8], eax
		mov	eax, [esp+0E4h+var_D4]
		mov	edx, eax
		and	edx, 100h
		mov	[esp+0E4h+var_D0], 32h ; '2'
		mov	[esp+0E4h+var_B4], edx
		jz	loc_1DDF
		cmp	ebp, 2
		jge	short loc_1D02
		push	5BAh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1D02:				; CODE XREF: _ssl3_get_key_exchange+228j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		cmp	ecx, 80h ; ''
		jle	short loc_1D35
		push	5C7h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 28h ; '('
		push	92h ; ''
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1D35:				; CODE XREF: _ssl3_get_key_exchange+253j
		lea	eax, [ebp-2]
		cmp	ecx, eax
		jle	short loc_1D50
		push	5CCh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	13Ch
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1D50:				; CODE XREF: _ssl3_get_key_exchange+276j
		push	ecx
		push	edi
		lea	esi, [ecx+2]
		call	_BUF_strndup
		mov	ecx, [ebx+0C0h]
		add	esp, 8
		mov	[ecx+8Ch], eax
		mov	eax, [ebx+0C0h]
		cmp	dword ptr [eax+8Ch], 0
		jnz	short loc_1D91
		push	5D4h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 28h ; '('
		push	41h ; 'A'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1D91:				; CODE XREF: _ssl3_get_key_exchange+2B2j
		sub	ebp, esi

loc_1D93:				; CODE XREF: _ssl3_get_key_exchange+BADj
		mov	eax, [esp+0E4h+var_C8]

loc_1D97:				; CODE XREF: _ssl3_get_key_exchange+556j
		mov	edx, [esp+0E4h+var_B4]

loc_1D9B:				; CODE XREF: _ssl3_get_key_exchange+F08j
		test	eax, 404h
		jnz	loc_29D1
		test	edx, edx
		jnz	loc_29D1
		push	ebx
		call	_ssl3_check_cert_and_algorithm
		add	esp, 4
		test	eax, eax
		jz	loc_2A3B
		push	7DEh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_2A3B
; ---------------------------------------------------------------------------

loc_1DDF:				; CODE XREF: _ssl3_get_key_exchange+21Fj
		test	eax, 400h
		jz	loc_2042
		cmp	ebp, 2
		jge	short loc_1E03
		push	5E0h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1E03:				; CODE XREF: _ssl3_get_key_exchange+329j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		lea	eax, [ebp-2]
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_1E31
		push	5E6h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	15Eh
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1E31:				; CODE XREF: _ssl3_get_key_exchange+357j
		push	0
		push	ecx
		push	edi
		lea	esi, [ecx+2]
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	[ebx+1A8h], eax
		test	eax, eax
		jnz	short loc_1E6C
		push	5ECh

loc_1E4F:				; CODE XREF: _ssl3_get_key_exchange+418j
					; _ssl3_get_key_exchange+480j ...
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	3

loc_1E56:				; CODE XREF: _ssl3_get_key_exchange+5C9j
					; _ssl3_get_key_exchange+74Cj ...
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	esi, esi
		jmp	$err$143
; ---------------------------------------------------------------------------

loc_1E6C:				; CODE XREF: _ssl3_get_key_exchange+384j
		add	edi, [esp+0E4h+var_D4]
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 2
		jge	short loc_1E8D
		push	5F2h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1E8D:				; CODE XREF: _ssl3_get_key_exchange+3B3j
		movzx	ecx, byte ptr [edi]
		add	esi, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ebp
		sub	eax, esi
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_1EBF
		push	5FAh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	15Dh
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1EBF:				; CODE XREF: _ssl3_get_key_exchange+3E5j
		push	0
		push	ecx
		push	edi
		add	esi, ecx
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	[ebx+1ACh], eax
		test	eax, eax
		jnz	short loc_1EE1
		push	600h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_1EE1:				; CODE XREF: _ssl3_get_key_exchange+411j
		add	edi, [esp+0E4h+var_D4]
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 1
		jge	short loc_1F02
		push	606h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1F02:				; CODE XREF: _ssl3_get_key_exchange+428j
		movzx	ecx, byte ptr [edi]
		inc	esi
		mov	eax, ebp
		mov	[esp+0E4h+var_D4], ecx
		sub	eax, esi
		inc	edi
		cmp	ecx, eax
		jle	short loc_1F27
		push	60Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	15Fh
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1F27:				; CODE XREF: _ssl3_get_key_exchange+44Dj
		push	0
		push	ecx
		push	edi
		add	esi, ecx
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	[ebx+1B0h], eax
		test	eax, eax
		jnz	short loc_1F49
		push	615h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_1F49:				; CODE XREF: _ssl3_get_key_exchange+479j
		add	edi, [esp+0E4h+var_D4]
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 2
		jge	short loc_1F6A
		push	61Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1F6A:				; CODE XREF: _ssl3_get_key_exchange+490j
		movzx	ecx, byte ptr [edi]
		add	esi, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ebp
		sub	eax, esi
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_1F9C
		push	623h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	15Ch
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1F9C:				; CODE XREF: _ssl3_get_key_exchange+4C2j
		push	0
		push	ecx
		add	esi, ecx
		push	edi
		mov	[esp+0F0h+var_B8], esi
		call	_BN_bin2bn
		add	esp, 0Ch
		mov	[ebx+1B4h], eax
		test	eax, eax
		jnz	short loc_1FC2
		push	629h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_1FC2:				; CODE XREF: _ssl3_get_key_exchange+4F2j
		add	edi, [esp+0E4h+var_D4]
		lea	eax, [esp+0E4h+var_D0]
		push	eax
		push	ebx
		sub	ebp, esi
		call	_srp_verify_server_param
		add	esp, 8
		test	eax, eax
		jnz	short loc_1FEE
		push	630h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	173h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_1FEE:				; CODE XREF: _ssl3_get_key_exchange+514j
		mov	eax, [esp+0E4h+var_C8]
		test	al, 1
		jz	short loc_2018
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+0Ch]
		call	_X509_get_pubkey
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_CC], esi
		jmp	loc_266F
; ---------------------------------------------------------------------------

loc_2018:				; CODE XREF: _ssl3_get_key_exchange+530j
		test	al, 2
		jz	loc_1D97
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+44h]
		call	_X509_get_pubkey
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_CC], esi
		jmp	loc_266F
; ---------------------------------------------------------------------------

loc_2042:				; CODE XREF: _ssl3_get_key_exchange+320j
		test	al, 1
		jz	loc_2215
		mov	eax, [ecx+344h]
		test	byte ptr [eax+20h], 2
		jnz	short loc_2072
		push	64Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 0Ah
		push	0F4h ; 'ô'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2072:				; CODE XREF: _ssl3_get_key_exchange+590j
		call	_RSA_new
		mov	edx, eax
		mov	[esp+0E4h+var_B0], edx
		test	edx, edx
		jnz	short loc_2092
		push	64Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_2092:				; CODE XREF: _ssl3_get_key_exchange+5BBj
		cmp	ebp, 2
		jge	short loc_20AB
		push	655h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_20AB:				; CODE XREF: _ssl3_get_key_exchange+5D1j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		lea	eax, [ebp-2]
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_20D6
		push	65Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	79h ; 'y'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_20D6:				; CODE XREF: _ssl3_get_key_exchange+5FFj
		push	dword ptr [edx+10h]
		lea	esi, [ecx+2]
		push	ecx
		push	edi
		call	_BN_bin2bn
		mov	edx, [esp+0F0h+var_B0]
		add	esp, 0Ch
		mov	[edx+10h], eax
		test	eax, eax
		jnz	short loc_20FB
		push	661h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_20FB:				; CODE XREF: _ssl3_get_key_exchange+62Bj
		add	edi, [esp+0E4h+var_D4]
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 2
		jge	short loc_211C
		push	667h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_211C:				; CODE XREF: _ssl3_get_key_exchange+642j
		movzx	ecx, byte ptr [edi]
		add	esi, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ebp
		sub	eax, esi
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_214B
		push	66Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	78h ; 'x'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_214B:				; CODE XREF: _ssl3_get_key_exchange+674j
		push	dword ptr [edx+14h]
		add	esi, ecx
		push	ecx
		push	edi
		mov	[esp+0F0h+var_B8], esi
		call	_BN_bin2bn
		mov	ecx, [esp+0F0h+var_B0]
		add	esp, 0Ch
		mov	[ecx+14h], eax
		test	eax, eax
		jnz	short loc_2173
		push	675h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_2173:				; CODE XREF: _ssl3_get_key_exchange+6A3j
		add	edi, [esp+0E4h+var_D4]
		sub	ebp, esi
		test	byte ptr [esp+0E4h+var_C8], 1
		jz	loc_2204
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+0Ch]
		call	_X509_get_pubkey
		mov	esi, eax
		push	esi
		mov	[esp+0ECh+var_CC], esi
		call	_EVP_PKEY_bits
		mov	ecx, [ebx+58h]
		add	esp, 8
		mov	edx, 200h
		mov	ecx, [ecx+344h]
		test	byte ptr [ecx+20h], 8
		mov	ecx, 400h
		cmovnz	ecx, edx
		cmp	eax, ecx
		jg	short loc_21E1
		push	687h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 0Ah
		push	0F4h ; 'ô'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_21E1:				; CODE XREF: _ssl3_get_key_exchange+6FFj
		mov	eax, [ebx+0C0h]
		mov	ecx, [esp+0E4h+var_B0]
		mov	[esp+0E4h+var_B0], 0
		mov	eax, [eax+98h]
		mov	[eax+0ECh], ecx
		jmp	loc_266F
; ---------------------------------------------------------------------------

loc_2204:				; CODE XREF: _ssl3_get_key_exchange+6BAj
		push	681h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_2215:				; CODE XREF: _ssl3_get_key_exchange+580j
		test	al, 8
		jz	loc_2442
		call	_DH_new
		mov	[esp+0E4h+var_C0], eax
		test	eax, eax
		jnz	short loc_223B
		push	694h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	5
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_223B:				; CODE XREF: _ssl3_get_key_exchange+764j
		cmp	ebp, 2
		jge	short loc_2254
		push	69Ah
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2254:				; CODE XREF: _ssl3_get_key_exchange+77Aj
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		lea	eax, [ebp-2]
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_227F
		push	6A0h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	6Eh ; 'n'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_227F:				; CODE XREF: _ssl3_get_key_exchange+7A8j
		push	0
		push	ecx
		push	edi
		lea	esi, [ecx+2]
		call	_BN_bin2bn
		mov	ecx, [esp+0F0h+var_C0]
		add	esp, 0Ch
		mov	[ecx+8], eax
		test	eax, eax
		jnz	short loc_22A3
		push	6A6h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_22A3:				; CODE XREF: _ssl3_get_key_exchange+7D3j
		add	edi, [esp+0E4h+var_D4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_22C1
		push	6ACh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	18Bh
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_22C1:				; CODE XREF: _ssl3_get_key_exchange+7E7j
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 2
		jge	short loc_22DE
		push	6B2h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_22DE:				; CODE XREF: _ssl3_get_key_exchange+804j
		movzx	ecx, byte ptr [edi]
		add	esi, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ebp
		sub	eax, esi
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_230D
		push	6BAh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	6Ch ; 'l'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_230D:				; CODE XREF: _ssl3_get_key_exchange+836j
		push	0
		push	ecx
		push	edi
		add	esi, ecx
		call	_BN_bin2bn
		mov	ecx, [esp+0F0h+var_C0]
		add	esp, 0Ch
		mov	[ecx+0Ch], eax
		test	eax, eax
		jnz	short loc_2330
		push	6C0h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_2330:				; CODE XREF: _ssl3_get_key_exchange+860j
		add	edi, [esp+0E4h+var_D4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_234E
		push	6C6h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	177h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_234E:				; CODE XREF: _ssl3_get_key_exchange+874j
		mov	eax, ebp
		sub	eax, esi
		cmp	eax, 2
		jge	short loc_236B
		push	6CBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_236B:				; CODE XREF: _ssl3_get_key_exchange+891j
		movzx	ecx, byte ptr [edi]
		add	esi, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		shl	ecx, 8
		or	ecx, eax
		mov	eax, ebp
		sub	eax, esi
		mov	[esp+0E4h+var_D4], ecx
		cmp	ecx, eax
		jle	short loc_239A
		push	6D3h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	6Dh ; 'm'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_239A:				; CODE XREF: _ssl3_get_key_exchange+8C3j
		push	0
		push	ecx
		add	esi, ecx
		push	edi
		mov	[esp+0F0h+var_B8], esi
		call	_BN_bin2bn
		mov	ecx, [esp+0F0h+var_C0]
		add	esp, 0Ch
		mov	[ecx+14h], eax
		test	eax, eax
		jnz	short loc_23C1
		push	6D9h
		jmp	loc_1E4F
; ---------------------------------------------------------------------------

loc_23C1:				; CODE XREF: _ssl3_get_key_exchange+8F1j
		add	edi, [esp+0E4h+var_D4]
		sub	ebp, esi
		cmp	dword ptr [eax+4], 0
		jnz	short loc_23E1
		push	6E0h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	189h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_23E1:				; CODE XREF: _ssl3_get_key_exchange+907j
		mov	eax, [esp+0E4h+var_C8]
		test	al, 1
		jz	short loc_240C
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+0Ch]

loc_23F8:				; CODE XREF: _ssl3_get_key_exchange+95Bj
		call	_X509_get_pubkey
		mov	ecx, [esp+0E8h+var_C0]
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_CC], esi
		jmp	short loc_2423
; ---------------------------------------------------------------------------

loc_240C:				; CODE XREF: _ssl3_get_key_exchange+923j
		test	al, 2
		jz	short loc_2421
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+44h]
		jmp	short loc_23F8
; ---------------------------------------------------------------------------

loc_2421:				; CODE XREF: _ssl3_get_key_exchange+94Aj
		xor	esi, esi

loc_2423:				; CODE XREF: _ssl3_get_key_exchange+946j
		mov	eax, [ebx+0C0h]
		mov	[esp+0E4h+var_C0], 0
		mov	eax, [eax+98h]
		mov	[eax+0F0h], ecx
		jmp	loc_266F
; ---------------------------------------------------------------------------

loc_2442:				; CODE XREF: _ssl3_get_key_exchange+753j
		test	al, 6
		jnz	loc_2A06
		test	al, al
		jns	loc_29AB
		call	_EC_KEY_new
		mov	[esp+0E4h+var_BC], eax
		test	eax, eax
		jnz	short loc_2470
		push	705h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_2470:				; CODE XREF: _ssl3_get_key_exchange+999j
		cmp	ebp, 4
		jge	short loc_2489
		push	716h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2489:				; CODE XREF: _ssl3_get_key_exchange+9AFj
		push	3
		push	edi
		push	ebx
		call	_tls1_check_curve
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_24AD
		push	71Eh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	17Ah
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_24AD:				; CODE XREF: _ssl3_get_key_exchange+9D3j
		movzx	eax, byte ptr [edi+2]
		push	eax
		call	_tls1_ec_curve_id2nid
		add	esp, 4
		test	eax, eax
		jnz	short loc_24DA
		push	725h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 50h ; 'P'
		push	13Ah
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_24DA:				; CODE XREF: _ssl3_get_key_exchange+9F8j
		push	eax
		call	_EC_GROUP_new_by_curve_name
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_24FA
		push	72Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10h
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_24FA:				; CODE XREF: _ssl3_get_key_exchange+A23j
		mov	ecx, [esp+0E4h+var_BC]
		push	esi
		push	ecx
		call	_EC_KEY_set_group
		add	esp, 8
		test	eax, eax
		jnz	short loc_251D
		push	72Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10h
		jmp	loc_1E56
; ---------------------------------------------------------------------------

loc_251D:				; CODE XREF: _ssl3_get_key_exchange+A46j
		push	esi
		call	_EC_GROUP_free
		push	[esp+0E8h+var_BC]
		call	_EC_KEY_get0_group
		mov	ecx, [ebx+58h]
		add	esp, 8
		mov	esi, eax
		mov	[esp+0E4h+var_D4], esi
		mov	ecx, [ecx+344h]
		test	byte ptr [ecx+20h], 2
		jz	short loc_2570
		push	esi
		call	_EC_GROUP_get_degree
		add	esp, 4
		cmp	eax, 0A3h ; '£'
		jle	short loc_2570
		push	73Ah
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 3Ch ; '<'
		push	136h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2570:				; CODE XREF: _ssl3_get_key_exchange+A7Ej
					; _ssl3_get_key_exchange+A8Ej
		push	esi
		call	_EC_POINT_new
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_C4], esi
		test	esi, esi
		jz	loc_298B
		call	_BN_CTX_new
		mov	[esp+0E4h+var_AC], eax
		test	eax, eax
		jz	loc_298B
		movzx	esi, byte ptr [edi+3]
		lea	ecx, [ebp-4]
		add	edi, 4
		cmp	esi, ecx
		jg	loc_2977
		push	eax
		push	esi
		push	edi
		push	[esp+0F0h+var_C4]
		push	[esp+0F4h+var_D4]
		call	_EC_POINT_oct2point
		add	esp, 14h
		test	eax, eax
		jz	loc_2977
		lea	eax, [esi+4]
		add	edi, esi
		sub	ebp, eax
		mov	[esp+0E4h+var_B8], eax
		mov	eax, [esp+0E4h+var_C8]
		test	al, 1
		jz	short loc_25F7
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+0Ch]
		call	_X509_get_pubkey
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_CC], esi
		jmp	short loc_261F
; ---------------------------------------------------------------------------

loc_25F7:				; CODE XREF: _ssl3_get_key_exchange+B12j
		test	al, 40h
		jz	short loc_261D
		mov	eax, [ebx+0C0h]
		mov	eax, [eax+98h]
		push	dword ptr [eax+98h]
		call	_X509_get_pubkey
		mov	esi, eax
		add	esp, 4
		mov	[esp+0E4h+var_CC], esi
		jmp	short loc_261F
; ---------------------------------------------------------------------------

loc_261D:				; CODE XREF: _ssl3_get_key_exchange+B35j
		xor	esi, esi

loc_261F:				; CODE XREF: _ssl3_get_key_exchange+B31j
					; _ssl3_get_key_exchange+B57j
		push	[esp+0E4h+var_C4]
		push	[esp+0E8h+var_BC]
		call	_EC_KEY_set_public_key
		mov	eax, [ebx+0C0h]
		mov	ecx, [esp+0ECh+var_BC]
		push	[esp+0ECh+var_AC]
		mov	[esp+0F0h+var_BC], 0
		mov	eax, [eax+98h]
		mov	[eax+0F4h], ecx
		call	_BN_CTX_free
		push	[esp+0F0h+var_C4]
		mov	[esp+0F4h+var_AC], 0
		call	_EC_POINT_free
		add	esp, 10h
		mov	[esp+0E4h+var_C4], 0

loc_266F:				; CODE XREF: _ssl3_get_key_exchange+54Fj
					; _ssl3_get_key_exchange+579j ...
		test	esi, esi
		jz	loc_1D93
		mov	eax, [ebx+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jz	short loc_26C5
		cmp	ebp, 2
		jge	short loc_269C
		push	77Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_269C:				; CODE XREF: _ssl3_get_key_exchange+BC2j
		push	esi
		push	edi
		lea	eax, [esp+0ECh+var_A8]
		push	ebx
		push	eax
		call	_tls12_check_peer_sigalg
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jz	loc_2A3B
		test	eax, eax
		jz	$f_err$144
		add	edi, 2
		sub	ebp, 2
		jmp	short loc_26CE
; ---------------------------------------------------------------------------

loc_26C5:				; CODE XREF: _ssl3_get_key_exchange+BBDj
		call	_EVP_sha1
		mov	[esp+0E4h+var_A8], eax

loc_26CE:				; CODE XREF: _ssl3_get_key_exchange+BFFj
		cmp	ebp, 2
		jge	short loc_26E7
		push	78Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0A0h ; ' '
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_26E7:				; CODE XREF: _ssl3_get_key_exchange+C0Dj
		movzx	esi, byte ptr [edi]
		sub	ebp, 2
		movzx	eax, byte ptr [edi+1]
		add	edi, 2
		push	[esp+0E4h+var_CC]
		shl	esi, 8
		or	esi, eax
		call	_EVP_PKEY_size
		add	esp, 4
		cmp	esi, ebp
		jnz	loc_2963
		cmp	ebp, eax
		jg	loc_2963
		test	ebp, ebp
		jle	loc_2963
		mov	eax, [esp+0E4h+var_CC]
		cmp	dword ptr [eax], 6
		jnz	loc_28A9
		mov	eax, [ebx+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	loc_28A9
		mov	esi, [esp+0E4h+var_B8]
		lea	eax, [esp+0E4h+var_84]
		mov	[esp+0E4h+var_D4], 0
		mov	[esp+0E4h+var_C8], eax
		mov	[esp+0E4h+var_B4], 2

loc_2756:				; CODE XREF: _ssl3_get_key_exchange+D65j
		lea	eax, [esp+0E4h+var_A0]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		mov	eax, [ebx+0E4h]
		add	esp, 8
		cmp	[esp+0E4h+var_B4], 2
		jnz	short loc_277A
		mov	eax, [eax+8Ch]
		jmp	short loc_2780
; ---------------------------------------------------------------------------

loc_277A:				; CODE XREF: _ssl3_get_key_exchange+CACj
		mov	eax, [eax+90h]

loc_2780:				; CODE XREF: _ssl3_get_key_exchange+CB4j
		push	0
		push	eax
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_2884
		mov	eax, [ebx+58h]
		add	eax, 0C0h ; 'À'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_2884
		mov	eax, [ebx+58h]
		add	eax, 0A0h ; ' '
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_2884
		push	esi
		push	[esp+0E8h+var_A4]
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_2884
		lea	eax, [esp+0E4h+var_B8]
		push	eax
		push	[esp+0E8h+var_C8]
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_2884
		mov	eax, [esp+0E4h+var_B8]
		mov	ecx, [esp+0E4h+var_D4]
		add	[esp+0E4h+var_C8], eax
		add	ecx, eax
		mov	eax, [esp+0E4h+var_B4]
		dec	eax
		mov	[esp+0E4h+var_D4], ecx
		mov	[esp+0E4h+var_B4], eax
		test	eax, eax
		jg	loc_2756
		mov	eax, [esp+0E4h+var_CC]
		push	dword ptr [eax+14h]
		lea	eax, [esp+0E8h+var_84]
		push	ebp
		push	edi
		push	ecx
		push	eax
		push	72h ; 'r'
		call	_RSA_verify
		add	esp, 18h
		test	eax, eax
		jns	short loc_2865
		push	7BBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 33h ; '3'
		push	76h ; 'v'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2865:				; CODE XREF: _ssl3_get_key_exchange+D86j
		jnz	loc_29E6
		push	7C1h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 33h ; '3'
		push	7Bh ; '{'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2884:				; CODE XREF: _ssl3_get_key_exchange+CCEj
					; _ssl3_get_key_exchange+CEEj ...
		push	7B1h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error
		mov	[esp+0F8h+var_D0], 50h ; 'P'
		jmp	loc_2A29
; ---------------------------------------------------------------------------

loc_28A9:				; CODE XREF: _ssl3_get_key_exchange+C60j
					; _ssl3_get_key_exchange+C70j
		push	0
		push	[esp+0E8h+var_A8]
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_294A
		mov	eax, [ebx+58h]
		add	eax, 0C0h ; 'À'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_294A
		mov	eax, [ebx+58h]
		add	eax, 0A0h ; ' '
		push	20h ; ' '
		push	eax
		lea	eax, [esp+0ECh+var_A0]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_294A
		mov	esi, [esp+0E4h+var_B8]
		lea	eax, [esp+0E4h+var_A0]
		push	esi
		push	[esp+0E8h+var_A4]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_294A
		push	[esp+0E4h+var_CC]
		lea	eax, [esp+0E8h+var_A0]
		push	ebp
		push	edi
		push	eax
		call	_EVP_VerifyFinal
		add	esp, 10h
		test	eax, eax
		jg	loc_29E6
		push	7D4h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 33h ; '3'
		push	7Bh ; '{'
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_294A:				; CODE XREF: _ssl3_get_key_exchange+DFAj
					; _ssl3_get_key_exchange+E1Aj ...
		push	7CEh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 50h ; 'P'
		push	6
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2963:				; CODE XREF: _ssl3_get_key_exchange+C43j
					; _ssl3_get_key_exchange+C4Bj ...
		push	79Bh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	108h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_2977:				; CODE XREF: _ssl3_get_key_exchange+AE0j
					; _ssl3_get_key_exchange+AFBj
		push	74Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	132h
		jmp	loc_2A1D
; ---------------------------------------------------------------------------

loc_298B:				; CODE XREF: _ssl3_get_key_exchange+ABDj
					; _ssl3_get_key_exchange+ACEj
		push	743h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$143
; ---------------------------------------------------------------------------

loc_29AB:				; CODE XREF: _ssl3_get_key_exchange+988j
		test	eax, eax
		jz	short loc_29C8
		push	771h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 0Ah
		push	0F4h ; 'ô'
		jmp	short loc_2A1D
; ---------------------------------------------------------------------------

loc_29C8:				; CODE XREF: _ssl3_get_key_exchange+EE9j
		mov	eax, [esp+0E4h+var_C8]
		jmp	loc_1D9B
; ---------------------------------------------------------------------------

loc_29D1:				; CODE XREF: _ssl3_get_key_exchange+2DCj
					; _ssl3_get_key_exchange+2E4j
		test	ebp, ebp
		jz	short loc_29E6
		push	7E3h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	99h ; ''
		jmp	short loc_2A1D
; ---------------------------------------------------------------------------

loc_29E6:				; CODE XREF: _ssl3_get_key_exchange:loc_2865j
					; _ssl3_get_key_exchange+E67j ...
		push	[esp+0E4h+var_CC]
		call	_EVP_PKEY_free
		lea	eax, [esp+0E8h+var_A0]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 8
		mov	eax, 1
		jmp	loc_2AA7
; ---------------------------------------------------------------------------

loc_2A06:				; CODE XREF: _ssl3_get_key_exchange+980j
		push	6FAh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	[esp+0ECh+var_D0], 2Fh ; '/'
		push	0EBh ; 'ë'

loc_2A1D:				; CODE XREF: _ssl3_get_key_exchange+239j
					; _ssl3_get_key_exchange+26Cj ...
		push	8Dh ; ''
		push	14h
		call	_ERR_put_error

loc_2A29:				; CODE XREF: _ssl3_get_key_exchange+D9j
					; _ssl3_get_key_exchange+DE0j
		add	esp, 14h

$f_err$144:				; CODE XREF: _ssl3_get_key_exchange+BF3j
		push	[esp+0E4h+var_D0]
		push	2
		push	ebx
		call	_ssl3_send_alert
		add	esp, 0Ch

loc_2A3B:				; CODE XREF: _ssl3_get_key_exchange+2F5j
					; _ssl3_get_key_exchange+316j ...
		mov	esi, [esp+0E4h+var_C4]

$err$143:				; CODE XREF: _ssl3_get_key_exchange+3A3j
					; _ssl3_get_key_exchange+EE2j
		push	[esp+0E4h+var_CC]
		call	_EVP_PKEY_free
		mov	eax, [esp+0E8h+var_B0]
		add	esp, 4
		test	eax, eax
		jz	short loc_2A5C
		push	eax
		call	_RSA_free
		add	esp, 4

loc_2A5C:				; CODE XREF: _ssl3_get_key_exchange+F8Dj
		mov	eax, [esp+0E4h+var_C0]
		test	eax, eax
		jz	short loc_2A6D
		push	eax
		call	_DH_free
		add	esp, 4

loc_2A6D:				; CODE XREF: _ssl3_get_key_exchange+F9Ej
		push	[esp+0E4h+var_AC]
		call	_BN_CTX_free
		push	esi
		call	_EC_POINT_free
		mov	eax, [esp+0ECh+var_BC]
		add	esp, 8
		test	eax, eax
		jz	short loc_2A90
		push	eax
		call	_EC_KEY_free
		add	esp, 4

loc_2A90:				; CODE XREF: _ssl3_get_key_exchange+FC1j
		lea	eax, [esp+0E4h+var_A0]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		mov	dword ptr [ebx+34h], 5
		or	eax, 0FFFFFFFFh

loc_2AA7:				; CODE XREF: _ssl3_get_key_exchange+131j
					; _ssl3_get_key_exchange+F3Dj
		pop	edi
		pop	esi

loc_2AA9:				; CODE XREF: _ssl3_get_key_exchange+8Dj
		mov	ecx, [esp+0DCh+var_4]
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0D4h
		retn
_ssl3_get_key_exchange endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2AC0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_new_session_ticket
_ssl3_get_new_session_ticket proc near	; CODE XREF: _ssl3_connect+54Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_0]
		lea	ecx, [esp+8+arg_0]
		push	ecx
		push	4000h
		push	4
		mov	eax, [esi+8]
		push	11E1h
		push	11E0h
		push	esi
		mov	eax, [eax+30h]
		call	eax
		add	esp, 18h
		mov	ecx, eax
		cmp	[esp+8+arg_0], 0
		jz	loc_2CEA
		push	ebx
		push	ebp
		push	edi
		cmp	ecx, 6
		jge	short loc_2B1F
		push	8D1h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	edi, 32h ; '2'
		push	9Fh ; ''
		jmp	loc_2BD9
; ---------------------------------------------------------------------------

loc_2B1F:				; CODE XREF: _ssl3_get_new_session_ticket+44j
		mov	edi, [esi+40h]
		movzx	ebp, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		movzx	ebx, byte ptr [edi+4]
		shl	eax, 10h
		shl	ebp, 18h
		or	ebp, eax
		shl	ebx, 8
		movzx	eax, byte ptr [edi+2]
		shl	eax, 8
		or	ebp, eax
		movzx	eax, byte ptr [edi+3]
		or	ebp, eax
		movzx	eax, byte ptr [edi+5]
		or	ebx, eax
		add	edi, 6
		lea	eax, [ebx+6]
		cmp	eax, ecx
		jz	short loc_2B6D
		push	8DCh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	edi, 32h ; '2'
		push	9Fh ; ''
		jmp	short loc_2BD9
; ---------------------------------------------------------------------------

loc_2B6D:				; CODE XREF: _ssl3_get_new_session_ticket+95j
		test	ebx, ebx
		jz	loc_2CE2
		mov	ecx, [esi+0C0h]
		cmp	dword ptr [ecx+44h], 0
		jbe	loc_2C1C
		mov	eax, [esi+170h]
		mov	edx, [eax+20h]
		test	dl, 1
		jz	short loc_2BB2
		test	edx, 200h
		jz	short loc_2BA8
		mov	edx, [eax+2Ch]
		test	edx, edx
		jz	short loc_2BB2
		push	ecx
		push	eax
		call	edx
		jmp	short loc_2BAF
; ---------------------------------------------------------------------------

loc_2BA8:				; CODE XREF: _ssl3_get_new_session_ticket+D9j
		push	ecx
		push	eax
		call	_SSL_CTX_remove_session

loc_2BAF:				; CODE XREF: _ssl3_get_new_session_ticket+E6j
		add	esp, 8

loc_2BB2:				; CODE XREF: _ssl3_get_new_session_ticket+D1j
					; _ssl3_get_new_session_ticket+E0j
		push	0
		push	dword ptr [esi+0C0h]
		call	_ssl_session_dup
		add	esp, 8
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jnz	short loc_2C04
		push	8FBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		lea	edi, [eax+50h]
		push	41h ; 'A'

loc_2BD9:				; CODE XREF: _ssl3_get_new_session_ticket+5Aj
					; _ssl3_get_new_session_ticket+ABj
		push	11Bh
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$f_err$22:
		push	edi
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_2C04:				; CODE XREF: _ssl3_get_new_session_ticket+108j
		push	dword ptr [esi+0C0h]
		call	_SSL_SESSION_free
		mov	eax, [esp+18h+var_4]
		add	esp, 4
		mov	[esi+0C0h], eax

loc_2C1C:				; CODE XREF: _ssl3_get_new_session_ticket+BFj
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0E4h]
		test	eax, eax
		jz	short loc_2C45
		push	eax
		call	_CRYPTO_free
		mov	eax, [esi+0C0h]
		add	esp, 4
		mov	dword ptr [eax+0E8h], 0

loc_2C45:				; CODE XREF: _ssl3_get_new_session_ticket+16Aj
		push	907h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		mov	[ecx+0E4h], eax
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0E4h]
		test	eax, eax
		jnz	short loc_2C9F
		push	909h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	11Bh
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err$23:
		pop	edi
		pop	ebp
		pop	ebx
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_2C9F:				; CODE XREF: _ssl3_get_new_session_ticket+1B2j
		push	ebx		; Size
		push	edi		; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esi+0C0h]
		add	esp, 0Ch
		mov	[eax+0ECh], ebp
		mov	eax, [esi+0C0h]
		push	0
		mov	[eax+0E8h], ebx
		mov	esi, [esi+0C0h]
		call	_EVP_sha256
		push	eax
		lea	eax, [esi+44h]
		push	eax
		lea	eax, [esi+48h]
		push	eax
		push	ebx
		push	edi
		call	_EVP_Digest
		add	esp, 18h

loc_2CE2:				; CODE XREF: _ssl3_get_new_session_ticket+AFj
		pop	edi
		pop	ebp
		mov	eax, 1
		pop	ebx

loc_2CEA:				; CODE XREF: _ssl3_get_new_session_ticket+38j
		pop	esi
		pop	ecx
		retn
_ssl3_get_new_session_ticket endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2CF0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_server_certificate
_ssl3_get_server_certificate proc near	; CODE XREF: _ssl3_connect+266p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 18h
		call	__chkstk
		push	ebx
		push	ebp
		mov	ebp, [esp+20h+arg_0]
		lea	ecx, [esp+20h+var_8]
		push	esi
		push	edi
		push	ecx
		push	dword ptr [ebp+108h]
		mov	eax, [ebp+8]
		xor	ebx, ebx
		push	0FFFFFFFFh
		push	1131h
		push	1130h
		mov	eax, [eax+30h]
		xor	edi, edi
		push	ebp
		mov	[esp+40h+var_C], 0FFFFFFFFh
		mov	[esp+40h+var_18], ebx
		mov	[esp+40h+var_10], edi
		call	eax
		add	esp, 18h
		mov	esi, eax
		cmp	[esp+28h+var_8], ebx
		jz	loc_315F
		mov	ecx, [ebp+58h]
		mov	edx, [ecx+340h]
		cmp	edx, 0Ch
		jz	loc_3150
		mov	eax, [ecx+344h]
		test	byte ptr [eax+10h], 20h
		jz	short loc_2D6C
		cmp	edx, 0Eh
		jz	loc_3150

loc_2D6C:				; CODE XREF: _ssl3_get_server_certificate+71j
		cmp	edx, 0Bh
		jz	short loc_2D87
		push	4B2h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 0Ah
		push	72h ; 'r'
		jmp	loc_3102
; ---------------------------------------------------------------------------

loc_2D87:				; CODE XREF: _ssl3_get_server_certificate+7Fj
		mov	edi, [ebp+40h]
		call	_sk_new_null
		mov	[esp+28h+var_18], eax
		test	eax, eax
		jnz	short loc_2DB7
		push	4B8h

loc_2D9C:				; CODE XREF: _ssl3_get_server_certificate+1E0j
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	90h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$45
; ---------------------------------------------------------------------------

loc_2DB7:				; CODE XREF: _ssl3_get_server_certificate+A5j
		movzx	ecx, byte ptr [edi]
		movzx	eax, byte ptr [edi+1]
		shl	ecx, 8
		or	ecx, eax
		movzx	eax, byte ptr [edi+2]
		shl	ecx, 8
		add	edi, 3
		or	ecx, eax
		mov	[esp+28h+var_14], ecx
		lea	eax, [ecx+3]
		cmp	eax, esi
		jz	short loc_2DF3
		push	4BFh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 32h ; '2'
		push	9Fh ; ''
		jmp	loc_3102
; ---------------------------------------------------------------------------

loc_2DF3:				; CODE XREF: _ssl3_get_server_certificate+E8j
		xor	edx, edx
		test	ecx, ecx
		jz	short loc_2E78
		nop	dword ptr [eax+00000000h]

loc_2E00:				; CODE XREF: _ssl3_get_server_certificate+186j
		movzx	esi, byte ptr [edi]
		add	edx, 3
		movzx	eax, byte ptr [edi+1]
		shl	esi, 8
		or	esi, eax
		movzx	eax, byte ptr [edi+2]
		shl	esi, 8
		add	edi, 3
		or	esi, eax
		add	edx, esi
		mov	[esp+28h+var_4], edx
		cmp	edx, ecx
		ja	loc_2F04
		push	esi
		lea	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+arg_0], edi
		push	eax
		push	0
		call	_d2i_X509
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	loc_2EEE
		lea	eax, [esi+edi]
		cmp	[esp+28h+arg_0], eax
		jnz	loc_2ED5
		mov	edi, [esp+28h+var_18]
		push	ebx
		push	edi
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short loc_2ECB
		mov	ecx, [esp+28h+var_14]
		xor	ebx, ebx
		mov	edx, [esp+28h+var_4]
		mov	edi, [esp+28h+arg_0]
		cmp	edx, ecx
		jb	short loc_2E00

loc_2E78:				; CODE XREF: _ssl3_get_server_certificate+107j
		mov	edi, [esp+28h+var_18]
		push	edi
		push	ebp
		call	_ssl_verify_cert_chain
		add	esp, 8
		cmp	dword ptr [ebp+0C8h], 0
		jz	loc_2F1D
		test	eax, eax
		jg	loc_2F1D
		push	dword ptr [ebp+0ECh]
		call	_ssl_verify_alarm_type
		push	4EAh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	86h ; ''
		push	90h ; ''
		push	14h
		mov	esi, eax
		call	_ERR_put_error
		add	esp, 18h
		jmp	$f_err$46
; ---------------------------------------------------------------------------

loc_2ECB:				; CODE XREF: _ssl3_get_server_certificate+174j
		push	4D9h
		jmp	loc_2D9C
; ---------------------------------------------------------------------------

loc_2ED5:				; CODE XREF: _ssl3_get_server_certificate+15Ej
		push	4D5h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 32h ; '2'
		push	87h ; ''
		jmp	loc_3102
; ---------------------------------------------------------------------------

loc_2EEE:				; CODE XREF: _ssl3_get_server_certificate+151j
		push	4CFh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 2Ah ; '*'
		push	0Dh
		jmp	loc_3102
; ---------------------------------------------------------------------------

loc_2F04:				; CODE XREF: _ssl3_get_server_certificate+133j
		push	4C7h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 32h ; '2'
		push	87h ; ''
		jmp	loc_3102
; ---------------------------------------------------------------------------

loc_2F1D:				; CODE XREF: _ssl3_get_server_certificate+19Dj
					; _ssl3_get_server_certificate+1A5j
		call	_ERR_clear_error
		call	_ssl_sess_cert_new
		mov	esi, eax
		test	esi, esi
		jz	$err$45
		mov	eax, [ebp+0C0h]
		mov	eax, [eax+98h]
		test	eax, eax
		jz	short loc_2F4A
		push	eax
		call	_ssl_sess_cert_free
		add	esp, 4

loc_2F4A:				; CODE XREF: _ssl3_get_server_certificate+24Fj
		mov	eax, [ebp+0C0h]
		push	0
		push	edi
		mov	[eax+98h], esi
		mov	[esi], edi
		call	_sk_value
		mov	ebx, eax
		mov	[esp+30h+var_18], 0
		push	ebx
		call	_X509_get_pubkey
		mov	edi, eax
		add	esp, 0Ch
		mov	eax, [ebp+58h]
		mov	[esp+28h+var_10], edi
		mov	ecx, [eax+344h]
		test	byte ptr [ecx+0Ch], 10h
		jz	short loc_2F98
		test	byte ptr [ecx+10h], 20h
		jz	short loc_2F98
		mov	[esp+28h+var_14], 0
		jmp	short loc_2FB9
; ---------------------------------------------------------------------------

loc_2F98:				; CODE XREF: _ssl3_get_server_certificate+296j
					; _ssl3_get_server_certificate+29Cj
		mov	[esp+28h+var_14], 1
		test	edi, edi
		jz	loc_30EC
		push	edi
		call	_EVP_PKEY_missing_parameters
		add	esp, 4
		test	eax, eax
		jnz	loc_30EC

loc_2FB9:				; CODE XREF: _ssl3_get_server_certificate+2A6j
		push	edi
		push	ebx
		call	_ssl_cert_type
		add	esp, 8
		mov	edi, eax
		cmp	[esp+28h+var_14], 0
		jz	loc_309B
		test	edi, edi
		jns	short loc_2FE8
		push	51Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0F7h ; '÷'
		jmp	loc_30FB
; ---------------------------------------------------------------------------

loc_2FE8:				; CODE XREF: _ssl3_get_server_certificate+2E2j
		mov	eax, [ebp+58h]
		push	dword ptr [eax+344h]
		call	_ssl_cipher_get_cert_index
		add	esp, 4
		test	eax, eax
		js	short loc_301A
		cmp	edi, eax
		jz	short loc_301A
		push	529h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		mov	esi, 2Fh ; '/'
		push	17Fh
		jmp	loc_3100
; ---------------------------------------------------------------------------

loc_301A:				; CODE XREF: _ssl3_get_server_certificate+30Bj
					; _ssl3_get_server_certificate+30Fj
		push	52Dh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	3
		lea	eax, [ebx+10h]
		mov	[esi+4], edi
		push	1
		push	eax
		call	_CRYPTO_add_lock
		lea	eax, ds:0[edi*8]
		add	esp, 14h
		sub	eax, edi
		add	eax, 3
		lea	edi, [esi+eax*4]
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_3055
		push	eax
		call	_X509_free
		add	esp, 4

loc_3055:				; CODE XREF: _ssl3_get_server_certificate+35Aj
		mov	[edi], ebx
		mov	[esi+8], edi
		mov	eax, [ebp+0C0h]
		mov	eax, [eax+9Ch]
		test	eax, eax
		jz	short loc_3073
		push	eax
		call	_X509_free
		add	esp, 4

loc_3073:				; CODE XREF: _ssl3_get_server_certificate+378j
		push	539h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	3
		lea	eax, [ebx+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [ebp+0C0h]
		add	esp, 14h
		mov	[eax+9Ch], ebx
		jmp	short loc_30CE
; ---------------------------------------------------------------------------

loc_309B:				; CODE XREF: _ssl3_get_server_certificate+2DAj
		mov	[esi+4], edi
		mov	dword ptr [esi+8], 0
		mov	eax, [ebp+0C0h]
		mov	eax, [eax+9Ch]
		test	eax, eax
		jz	short loc_30BE
		push	eax
		call	_X509_free
		add	esp, 4

loc_30BE:				; CODE XREF: _ssl3_get_server_certificate+3C3j
		mov	eax, [ebp+0C0h]
		mov	dword ptr [eax+9Ch], 0

loc_30CE:				; CODE XREF: _ssl3_get_server_certificate+3A9j
		mov	ecx, [ebp+0C0h]
		xor	ebx, ebx
		mov	eax, [ebp+0ECh]
		mov	[esp+28h+var_C], 1
		mov	[ecx+0A0h], eax
		jmp	short loc_3124
; ---------------------------------------------------------------------------

loc_30EC:				; CODE XREF: _ssl3_get_server_certificate+2B2j
					; _ssl3_get_server_certificate+2C3j
		push	516h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0EFh ; 'ï'

loc_30FB:				; CODE XREF: _ssl3_get_server_certificate+2F3j
		mov	esi, 2

loc_3100:				; CODE XREF: _ssl3_get_server_certificate+325j
		xor	ebx, ebx

loc_3102:				; CODE XREF: _ssl3_get_server_certificate+92j
					; _ssl3_get_server_certificate+FEj ...
		push	90h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$f_err$46:				; CODE XREF: _ssl3_get_server_certificate+1D6j
		push	esi
		push	2
		push	ebp
		call	_ssl3_send_alert
		add	esp, 0Ch

$err$45:				; CODE XREF: _ssl3_get_server_certificate+C2j
					; _ssl3_get_server_certificate+23Bj
		mov	dword ptr [ebp+34h], 5

loc_3124:				; CODE XREF: _ssl3_get_server_certificate+3FAj
		push	[esp+28h+var_10]
		call	_EVP_PKEY_free
		push	ebx
		call	_X509_free
		push	offset _X509_free
		push	[esp+34h+var_18]
		call	_sk_pop_free
		mov	eax, [esp+38h+var_C]
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_3150:				; CODE XREF: _ssl3_get_server_certificate+61j
					; _ssl3_get_server_certificate+76j
		mov	dword ptr [ecx+354h], 1
		mov	eax, 1

loc_315F:				; CODE XREF: _ssl3_get_server_certificate+4Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
_ssl3_get_server_certificate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3168h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_get_server_done
_ssl3_get_server_done proc near		; CODE XREF: _ssl3_connect+30Ep

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	ecx, [esp+4+arg_0]
		push	ecx
		push	1Eh
		push	0Eh
		mov	eax, [esi+8]
		push	1161h
		push	1160h
		push	esi
		mov	eax, [eax+30h]
		call	eax
		add	esp, 18h
		cmp	[esp+4+arg_0], 0
		jz	short loc_31D0
		test	eax, eax
		jle	short loc_31CB
		push	32h ; '2'
		push	2
		push	esi
		call	_ssl3_send_alert
		push	97Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	9Fh ; ''
		push	91h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_31CB:				; CODE XREF: _ssl3_get_server_done+2Dj
		mov	eax, 1

loc_31D0:				; CODE XREF: _ssl3_get_server_done+29j
		pop	esi
		retn
_ssl3_get_server_done endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 31D4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl3_get_server_hello(void *Src)
		public _ssl3_get_server_hello
_ssl3_get_server_hello proc near	; CODE XREF: _ssl3_connect+185p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= dword	ptr  4

		mov	eax, 18h
		call	__chkstk
		push	esi
		mov	esi, [esp+1Ch+Src]
		push	edi
		mov	edi, 50h ; 'P'
		mov	ecx, [esi+8]
		mov	eax, [esi+98h]
		mov	[esp+20h+var_10], eax
		mov	eax, [ecx+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_3209
		mov	dword ptr [esi+10Ch], 1

loc_3209:				; CODE XREF: _ssl3_get_server_hello+29j
		lea	eax, [esp+20h+var_C]
		push	eax
		mov	eax, [ecx+30h]
		push	4E20h
		push	0FFFFFFFFh
		push	1121h
		push	1120h
		push	esi
		call	eax
		add	esp, 18h
		mov	[esp+20h+var_8], eax
		cmp	[esp+20h+var_C], 0
		jz	loc_3902
		push	ebx
		mov	ebx, [esi+8]
		push	ebp
		mov	eax, [ebx+64h]
		test	byte ptr [eax+38h], 8
		jz	short loc_329F
		mov	ecx, [esi+58h]
		mov	dword ptr [esi+10Ch], 0
		cmp	dword ptr [ecx+340h], 3
		jnz	short loc_329F
		mov	eax, [esi+5Ch]
		cmp	dword ptr [eax], 0
		jnz	short loc_327A
		mov	dword ptr [ecx+354h], 1

loc_326D:				; CODE XREF: _ssl3_get_server_hello+66Bj
		pop	ebp
		pop	ebx
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_327A:				; CODE XREF: _ssl3_get_server_hello+8Dj
		push	3A0h

loc_327F:				; CODE XREF: _ssl3_get_server_hello+DCj
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	72h ; 'r'
		push	92h ; ''
		push	14h
		mov	edi, 0Ah
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_329F:				; CODE XREF: _ssl3_get_server_hello+6Fj
					; _ssl3_get_server_hello+85j
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+340h], 2
		jz	short loc_32B2
		push	3A8h
		jmp	short loc_327F
; ---------------------------------------------------------------------------

loc_32B2:				; CODE XREF: _ssl3_get_server_hello+D5j
		mov	edx, [esi+40h]
		mov	[esp+28h+Src], edx
		cmp	dword ptr [ebx], 1FFFFh
		mov	[esp+28h+var_4], edx
		jnz	loc_3356
		movzx	ebx, byte ptr [edx]
		movzx	eax, byte ptr [edx+1]
		mov	ecx, [esi+100h]
		shl	ebx, 8
		or	ebx, eax
		cmp	ebx, 0FEFDh
		jnz	short loc_32F2
		test	ecx, 8000000h
		jnz	short loc_32F2
		call	_DTLSv1_2_client_method
		jmp	short loc_3343
; ---------------------------------------------------------------------------

loc_32F2:				; CODE XREF: _ssl3_get_server_hello+10Dj
					; _ssl3_get_server_hello+115j
		mov	eax, [esi+98h]
		test	dword ptr [eax+38h], 30000h
		jz	short loc_3326
		push	3B5h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	183h

loc_3310:				; CODE XREF: _ssl3_get_server_hello+368j
		push	92h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	[esi], ebx
		jmp	loc_38E5
; ---------------------------------------------------------------------------

loc_3326:				; CODE XREF: _ssl3_get_server_hello+12Bj
		cmp	ebx, 0FEFFh
		jnz	loc_352D
		test	ecx, 4000000h
		jnz	loc_352D
		call	_DTLSv1_client_method

loc_3343:				; CODE XREF: _ssl3_get_server_hello+11Cj
		mov	[esi+8], eax
		mov	ecx, [eax]
		mov	eax, [esi+0C0h]
		mov	[esi], ecx
		mov	[eax], ecx
		mov	edx, [esp+28h+Src]

loc_3356:				; CODE XREF: _ssl3_get_server_hello+EFj
		mov	ebx, [esi]
		mov	ecx, ebx
		movzx	eax, byte ptr [edx]
		sar	ecx, 8
		cmp	eax, ecx
		jnz	loc_38B4
		cmp	[edx+1], bl
		jnz	loc_38B4
		mov	eax, [esi+58h]
		add	edx, 2
		mov	[esp+28h+Src], edx
		movups	xmm0, xmmword ptr [edx]
		movups	xmmword	ptr [eax+0A0h],	xmm0
		movups	xmm0, xmmword ptr [edx+10h]
		movups	xmmword	ptr [eax+0B0h],	xmm0
		mov	ebp, [esp+28h+Src]
		add	ebp, 20h ; ' '
		mov	dword ptr [esi+6Ch], 0
		mov	[esp+28h+Src], ebp
		movzx	ebx, byte ptr [ebp+0]
		inc	ebp
		mov	[esp+28h+var_18], ebx
		mov	[esp+28h+Src], ebp
		cmp	ebx, 20h ; ' '
		ja	loc_388F
		cmp	dword ptr [esi], 301h
		jl	short loc_343E
		cmp	dword ptr [esi+168h], 0
		jz	short loc_343E
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+0E4h], 0
		jz	short loc_343E
		mov	[esp+28h+var_14], 0
		mov	dword ptr [eax+10h], 30h ; '0'
		lea	eax, [esp+28h+var_14]
		push	dword ptr [esi+16Ch]
		mov	ecx, [esi+0C0h]
		push	eax
		push	0
		lea	eax, [ecx+10h]
		push	eax
		lea	eax, [ecx+14h]
		push	eax
		mov	eax, [esi+168h]
		push	esi
		call	eax
		add	esp, 18h
		test	eax, eax
		jz	loc_3541
		mov	eax, [esp+28h+var_14]
		test	eax, eax
		jnz	short loc_342E
		mov	eax, [esp+28h+Src]
		add	eax, ebx
		push	eax
		push	esi
		call	_ssl_get_cipher_by_char
		add	esp, 8

loc_342E:				; CODE XREF: _ssl3_get_server_hello+248j
		mov	ecx, [esi+0C0h]
		mov	[ecx+0B4h], eax
		mov	ebp, [esp+28h+Src]

loc_343E:				; CODE XREF: _ssl3_get_server_hello+1EAj
					; _ssl3_get_server_hello+1F3j ...
		test	ebx, ebx
		jz	loc_358D
		mov	eax, [esi+0C0h]
		cmp	ebx, [eax+44h]
		jnz	loc_358D
		lea	edx, [eax+48h]
		mov	ecx, ebp
		sub	ebx, 4
		jb	short loc_3475
		nop	dword ptr [eax+eax+00h]

loc_3464:				; CODE XREF: _ssl3_get_server_hello+29Fj
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_347A
		add	ecx, 4
		add	edx, 4
		sub	ebx, 4
		jnb	short loc_3464

loc_3475:				; CODE XREF: _ssl3_get_server_hello+289j
		cmp	ebx, 0FFFFFFFCh
		jz	short loc_34B7

loc_347A:				; CODE XREF: _ssl3_get_server_hello+294j
		mov	al, [ecx]
		cmp	al, [edx]
		jnz	loc_3589
		cmp	ebx, 0FFFFFFFDh
		jz	short loc_34B7
		mov	al, [ecx+1]
		cmp	al, [edx+1]
		jnz	loc_3589
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_34B7
		mov	al, [ecx+2]
		cmp	al, [edx+2]
		jnz	loc_3589
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_34B7
		mov	al, [ecx+3]
		cmp	al, [edx+3]
		jnz	loc_3589

loc_34B7:				; CODE XREF: _ssl3_get_server_hello+2A4j
					; _ssl3_get_server_hello+2B3j ...
		mov	edx, [esi+0C0h]
		mov	ecx, [esi+9Ch]
		cmp	ecx, [edx+68h]
		jnz	loc_3561
		add	edx, 6Ch ; 'l'
		lea	ebx, [esi+0A0h]
		sub	ecx, 4
		jb	short loc_34EB

loc_34DA:				; CODE XREF: _ssl3_get_server_hello+315j
		mov	eax, [edx]
		cmp	eax, [ebx]
		jnz	short loc_34F0
		add	edx, 4
		add	ebx, 4
		sub	ecx, 4
		jnb	short loc_34DA

loc_34EB:				; CODE XREF: _ssl3_get_server_hello+304j
		cmp	ecx, 0FFFFFFFCh
		jz	short loc_351D

loc_34F0:				; CODE XREF: _ssl3_get_server_hello+30Aj
		mov	al, [edx]
		cmp	al, [ebx]
		jnz	short loc_3561
		cmp	ecx, 0FFFFFFFDh
		jz	short loc_351D
		mov	al, [edx+1]
		cmp	al, [ebx+1]
		jnz	short loc_3561
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_351D
		mov	al, [edx+2]
		cmp	al, [ebx+2]
		jnz	short loc_3561
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_351D
		mov	al, [edx+3]
		cmp	al, [ebx+3]
		jnz	short loc_3561

loc_351D:				; CODE XREF: _ssl3_get_server_hello+31Aj
					; _ssl3_get_server_hello+325j ...
		mov	ebx, [esp+28h+var_18]
		mov	dword ptr [esi+6Ch], 1
		jmp	loc_35D0
; ---------------------------------------------------------------------------

loc_352D:				; CODE XREF: _ssl3_get_server_hello+158j
					; _ssl3_get_server_hello+164j
		push	3BCh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10Ah
		jmp	loc_3310
; ---------------------------------------------------------------------------

loc_3541:				; CODE XREF: _ssl3_get_server_hello+23Cj
		push	3F3h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	92h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_3561:				; CODE XREF: _ssl3_get_server_hello+2F2j
					; _ssl3_get_server_hello+320j ...
		push	401h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	110h
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_3589:				; CODE XREF: _ssl3_get_server_hello+2AAj
					; _ssl3_get_server_hello+2BBj ...
		mov	ebx, [esp+28h+var_18]

loc_358D:				; CODE XREF: _ssl3_get_server_hello+26Cj
					; _ssl3_get_server_hello+27Bj
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+44h], 0
		jbe	short loc_35AC
		push	0
		push	esi
		call	_ssl_get_new_session
		add	esp, 8
		test	eax, eax
		jz	$f_err$71

loc_35AC:				; CODE XREF: _ssl3_get_server_hello+3C3j
		mov	eax, [esi+0C0h]
		push	ebx		; Size
		mov	[eax+44h], ebx
		mov	eax, [esi+0C0h]
		push	[esp+2Ch+Src]	; Src
		add	eax, 48h ; 'H'
		push	eax		; Dst
		call	_memcpy
		mov	ebp, [esp+34h+Src]
		add	esp, 0Ch

loc_35D0:				; CODE XREF: _ssl3_get_server_hello+354j
		add	ebp, ebx
		push	ebp
		push	esi
		mov	[esp+30h+Src], ebp
		call	_ssl_get_cipher_by_char
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_360C
		push	41Ah
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0F8h ; 'ø'
		push	92h ; ''
		push	14h
		lea	edi, [eax+2Fh]
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_360C:				; CODE XREF: _ssl3_get_server_hello+410j
		mov	eax, [esi+8]
		mov	ecx, [esp+28h+var_10]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 10h
		jnz	short loc_3625
		mov	dword ptr [ecx+18h], 4
		jmp	short loc_362C
; ---------------------------------------------------------------------------

loc_3625:				; CODE XREF: _ssl3_get_server_hello+446j
		mov	dword ptr [ecx+18h], 0

loc_362C:				; CODE XREF: _ssl3_get_server_hello+44Fj
		mov	eax, [ebx+1Ch]
		test	[ecx+18h], eax
		jnz	loc_386A
		mov	eax, [ebx+0Ch]
		test	[ecx+8], eax
		jnz	loc_386A
		mov	eax, [ebx+10h]
		test	[ecx+0Ch], eax
		jnz	loc_386A
		mov	eax, [esi+8]
		push	0
		push	0
		mov	eax, [eax+4Ch]
		call	eax
		add	[esp+30h+Src], eax
		push	esi
		call	_ssl_get_ciphers_by_id
		push	ebx
		push	eax
		call	_sk_find
		add	esp, 14h
		test	eax, eax
		jns	short loc_369C
		push	433h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	105h
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_369C:				; CODE XREF: _ssl3_get_server_hello+49Ej
		mov	ecx, [esi+0C0h]
		mov	eax, [ecx+0B4h]
		test	eax, eax
		jz	short loc_36B5
		mov	eax, [eax+8]
		mov	[ecx+0B8h], eax

loc_36B5:				; CODE XREF: _ssl3_get_server_hello+4D6j
		cmp	dword ptr [esi+6Ch], 0
		jz	short loc_36F4
		mov	eax, [esi+0C0h]
		mov	eax, [eax+0B8h]
		cmp	eax, [ebx+8]
		jz	short loc_36F4
		push	446h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0C5h ; 'Å'
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_36F4:				; CODE XREF: _ssl3_get_server_hello+4E5j
					; _ssl3_get_server_hello+4F6j
		mov	eax, [esi+58h]
		mov	[eax+344h], ebx
		mov	eax, [esi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	short loc_371A
		push	esi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	$f_err$71

loc_371A:				; CODE XREF: _ssl3_get_server_hello+533j
		mov	eax, [esp+28h+Src]
		movzx	ecx, byte ptr [eax]
		inc	eax
		cmp	dword ptr [esi+6Ch], 0
		mov	[esp+28h+Src], eax
		jz	short loc_3762
		mov	eax, [esi+0C0h]
		cmp	ecx, [eax+0B0h]
		jz	short loc_3762
		push	467h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	158h
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_3762:				; CODE XREF: _ssl3_get_server_hello+556j
					; _ssl3_get_server_hello+564j
		test	ecx, ecx
		jnz	short loc_37BF

loc_3766:				; CODE XREF: _ssl3_get_server_hello+638j
		mov	eax, [esi+58h]
		mov	edi, [esp+28h+var_8]
		mov	ebx, [esp+28h+var_4]
		push	edi
		mov	[eax+38Ch], ecx
		lea	eax, [esp+2Ch+Src]
		push	ebx
		push	eax
		push	esi
		call	_ssl_parse_serverhello_tlsext
		add	esp, 10h
		test	eax, eax
		jnz	loc_3838
		push	480h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0E3h ; 'ã'
		push	92h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_37BF:				; CODE XREF: _ssl3_get_server_hello+590j
		test	dword ptr [esi+100h], 20000h
		jz	short loc_37F3
		push	46Eh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	157h
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_37F3:				; CODE XREF: _ssl3_get_server_hello+5F5j
		mov	eax, [esi+0E4h]
		push	ecx
		push	dword ptr [eax+98h]
		call	_ssl3_comp_find
		mov	ecx, eax
		add	esp, 8
		test	ecx, ecx
		jnz	loc_3766
		push	476h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	101h
		push	92h ; ''
		push	14h
		lea	edi, [eax+2Fh]
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_3838:				; CODE XREF: _ssl3_get_server_hello+5B5j
		lea	eax, [ebx+edi]
		cmp	[esp+28h+Src], eax
		jz	loc_326D
		push	488h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	73h ; 's'
		push	92h ; ''
		push	14h
		mov	edi, 32h ; '2'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$f_err$71
; ---------------------------------------------------------------------------

loc_386A:				; CODE XREF: _ssl3_get_server_hello+45Ej
					; _ssl3_get_server_hello+46Aj ...
		push	429h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	105h
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short $f_err$71
; ---------------------------------------------------------------------------

loc_388F:				; CODE XREF: _ssl3_get_server_hello+1DEj
		push	3D8h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	12Ch
		push	92h ; ''
		push	14h
		mov	edi, 2Fh ; '/'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short $f_err$71
; ---------------------------------------------------------------------------

loc_38B4:				; CODE XREF: _ssl3_get_server_hello+18Ej
					; _ssl3_get_server_hello+197j
		push	3C5h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10Ah
		push	92h ; ''
		push	14h
		call	_ERR_put_error
		mov	eax, [esp+3Ch+Src]
		add	esp, 14h
		movzx	ecx, byte ptr [eax+1]
		mov	eax, [esi]
		and	eax, 0FF00h
		or	ecx, eax
		mov	[esi], ecx

loc_38E5:				; CODE XREF: _ssl3_get_server_hello+14Dj
		mov	edi, 46h ; 'F'

$f_err$71:				; CODE XREF: _ssl3_get_server_hello+C6j
					; _ssl3_get_server_hello+388j ...
		push	edi
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch

$err$72:
		pop	ebp
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		pop	ebx

loc_3902:				; CODE XREF: _ssl3_get_server_hello+5Dj
		pop	edi
		pop	esi
		add	esp, 18h
		retn
_ssl3_get_server_hello endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3908h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_client_certificate
_ssl3_send_client_certificate proc near	; CODE XREF: _ssl3_connect+365p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 8
		call	__chkstk
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		cmp	dword ptr [esi+34h], 1170h
		jnz	short loc_399A
		mov	eax, [esi+98h]
		mov	ecx, [eax+144h]
		test	ecx, ecx
		jz	short loc_3983
		push	dword ptr [eax+148h]
		push	esi
		call	ecx
		add	esp, 8
		test	eax, eax
		jns	short loc_395F
		mov	dword ptr [esi+18h], 4
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_395F:				; CODE XREF: _ssl3_send_client_certificate+46j
		jnz	short loc_397C
		push	50h ; 'P'
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 5
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_397C:				; CODE XREF: _ssl3_send_client_certificate:loc_395Fj
		mov	dword ptr [esi+18h], 1

loc_3983:				; CODE XREF: _ssl3_send_client_certificate+36j
		push	esi
		call	_ssl3_check_client_certificate
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		add	eax, 1171h
		mov	[esi+34h], eax

loc_399A:				; CODE XREF: _ssl3_send_client_certificate+26j
		cmp	dword ptr [esi+34h], 1171h
		push	edi
		jnz	loc_3AA4
		lea	eax, [esp+10h+var_8]
		push	eax
		lea	eax, [esp+14h+var_4]
		push	eax
		push	esi
		call	_ssl_do_client_cert_cb
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jns	short loc_39D1
		pop	edi
		mov	dword ptr [esi+18h], 4
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_39D1:				; CODE XREF: _ssl3_send_client_certificate+B7j
		mov	dword ptr [esi+18h], 1
		cmp	edi, 1
		jnz	short loc_3A33
		cmp	[esp+10h+var_8], 0
		jz	short loc_3A16
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jz	short loc_3A16
		push	eax
		push	esi
		mov	dword ptr [esi+34h], 1171h
		call	_SSL_use_certificate
		add	esp, 8
		test	eax, eax
		jz	short loc_3A12
		push	[esp+10h+var_8]
		push	esi
		call	_SSL_use_PrivateKey
		add	esp, 8
		test	eax, eax
		jnz	short loc_3A33

loc_3A12:				; CODE XREF: _ssl3_send_client_certificate+F7j
		xor	edi, edi
		jmp	short loc_3A33
; ---------------------------------------------------------------------------

loc_3A16:				; CODE XREF: _ssl3_send_client_certificate+DAj
					; _ssl3_send_client_certificate+E2j
		push	0D75h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	6Ah ; 'j'
		push	97h ; ''
		push	14h
		xor	edi, edi
		call	_ERR_put_error
		add	esp, 14h

loc_3A33:				; CODE XREF: _ssl3_send_client_certificate+D3j
					; _ssl3_send_client_certificate+108j ...
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jz	short loc_3A44
		push	eax
		call	_X509_free
		add	esp, 4

loc_3A44:				; CODE XREF: _ssl3_send_client_certificate+131j
		mov	eax, [esp+10h+var_8]
		test	eax, eax
		jz	short loc_3A55
		push	eax
		call	_EVP_PKEY_free
		add	esp, 4

loc_3A55:				; CODE XREF: _ssl3_send_client_certificate+142j
		test	edi, edi
		jz	short loc_3A66
		push	esi
		call	_ssl3_check_client_certificate
		add	esp, 4
		test	eax, eax
		jnz	short loc_3A9D

loc_3A66:				; CODE XREF: _ssl3_send_client_certificate+14Fj
		cmp	dword ptr [esi], 300h
		mov	eax, [esi+58h]
		jnz	short loc_3A93
		push	29h ; ')'
		push	1
		push	esi
		mov	dword ptr [eax+358h], 0
		call	_ssl3_send_alert
		add	esp, 0Ch
		mov	eax, 1
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_3A93:				; CODE XREF: _ssl3_send_client_certificate+167j
		mov	dword ptr [eax+358h], 2

loc_3A9D:				; CODE XREF: _ssl3_send_client_certificate+15Cj
		mov	dword ptr [esi+34h], 1172h

loc_3AA4:				; CODE XREF: _ssl3_send_client_certificate+9Aj
		cmp	dword ptr [esi+34h], 1172h
		jnz	short loc_3B0E
		mov	eax, [esi+58h]
		mov	dword ptr [esi+34h], 1173h
		cmp	dword ptr [eax+358h], 2
		jnz	short loc_3AC4
		xor	eax, eax
		jmp	short loc_3ACC
; ---------------------------------------------------------------------------

loc_3AC4:				; CODE XREF: _ssl3_send_client_certificate+1B6j
		mov	eax, [esi+98h]
		mov	eax, [eax]

loc_3ACC:				; CODE XREF: _ssl3_send_client_certificate+1BAj
		push	eax
		push	esi
		call	_ssl3_output_cert_chain
		add	esp, 8
		test	eax, eax
		jnz	short loc_3B0E
		push	0D91h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	97h ; ''
		push	14h
		call	_ERR_put_error
		push	50h ; 'P'
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 20h
		mov	dword ptr [esi+34h], 5
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_3B0E:				; CODE XREF: _ssl3_send_client_certificate+1A3j
					; _ssl3_send_client_certificate+1D0j
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 8
		retn
_ssl3_send_client_certificate endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3B24h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_client_key_exchange
_ssl3_send_client_key_exchange proc near ; CODE	XREF: _ssl3_connect+384p

Size		= dword	ptr -370h
var_36C		= dword	ptr -36Ch
var_368		= dword	ptr -368h
Src		= dword	ptr -364h
var_360		= dword	ptr -360h
var_35C		= dword	ptr -35Ch
var_358		= byte ptr -358h
var_357		= byte ptr -357h
var_356		= byte ptr -356h
var_328		= byte ptr -328h
Dst		= byte ptr -308h
var_287		= byte ptr -287h
var_208		= byte ptr -208h
var_207		= byte ptr -207h
var_206		= byte ptr -206h
var_205		= byte ptr -205h
var_204		= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 370h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+370h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+37Ch+arg_0]
		xor	ebp, ebp
		push	edi
		mov	[esp+380h+var_368], 0
		mov	[esp+380h+Size], 0
		cmp	dword ptr [esi+34h], 1180h
		mov	[esp+380h+Src],	ebp
		mov	[esp+380h+var_360], ebp
		jnz	loc_3CE7
		mov	eax, [esi+8]
		mov	ecx, [esi+3Ch]
		mov	eax, [eax+64h]
		mov	edi, [ecx+4]
		add	edi, [eax+3Ch]
		mov	eax, [esi+58h]
		mov	eax, [eax+344h]
		mov	eax, [eax+0Ch]
		test	al, 1
		jz	loc_3D35
		mov	eax, [esi+0C0h]
		mov	eax, [eax+98h]
		test	eax, eax
		jnz	short loc_3BC1
		push	9C1h

loc_3BA6:				; CODE XREF: _ssl3_send_client_key_exchange+293j
					; _ssl3_send_client_key_exchange+9B6j ...
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3BC1:				; CODE XREF: _ssl3_send_client_key_exchange+7Bj
		mov	ebp, [eax+0ECh]
		test	ebp, ebp
		jnz	short loc_3BFD
		push	dword ptr [eax+0Ch]
		call	_X509_get_pubkey
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_3D0F
		cmp	dword ptr [ebx], 6
		jnz	loc_3D0F
		mov	ebp, [ebx+14h]
		test	ebp, ebp
		jz	loc_3D0F
		push	ebx
		call	_EVP_PKEY_free
		add	esp, 4

loc_3BFD:				; CODE XREF: _ssl3_send_client_key_exchange+A5j
		mov	eax, [esi+110h]
		sar	eax, 8
		mov	[esp+380h+var_358], al
		mov	al, [esi+110h]
		mov	[esp+380h+var_357], al
		lea	eax, [esp+380h+var_356]
		push	2Eh ; '.'
		push	eax
		call	_RAND_bytes
		add	esp, 8
		test	eax, eax
		jle	loc_47B7
		mov	eax, [esi+0C0h]
		mov	[esp+380h+var_36C], edi
		mov	dword ptr [eax+10h], 30h ; '0'
		cmp	dword ptr [esi], 300h
		jle	short loc_3C47
		add	edi, 2

loc_3C47:				; CODE XREF: _ssl3_send_client_key_exchange+11Ej
		push	1
		push	ebp
		push	edi
		lea	eax, [esp+38Ch+var_358]
		push	eax
		push	30h ; '0'
		call	_RSA_public_encrypt
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jg	short loc_3C80
		push	9ECh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	77h ; 'w'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3C80:				; CODE XREF: _ssl3_send_client_key_exchange+13Aj
		cmp	dword ptr [esi], 300h
		jle	short loc_3C99
		mov	ecx, [esp+380h+var_36C]
		mov	eax, ebx
		sar	eax, 8
		mov	[ecx+1], bl
		add	ebx, 2
		mov	[ecx], al

loc_3C99:				; CODE XREF: _ssl3_send_client_key_exchange+162j
		mov	eax, [esi+8]
		push	30h ; '0'
		mov	ecx, [eax+64h]
		lea	eax, [esp+384h+var_358]
		push	eax
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	30h ; '0'
		mov	[ecx+10h], eax
		lea	eax, [esp+394h+var_358]
		push	eax
		call	_OPENSSL_cleanse

loc_3CCB:				; CODE XREF: _ssl3_send_client_key_exchange+8AFj
		add	esp, 18h

loc_3CCE:				; CODE XREF: _ssl3_send_client_key_exchange+394j
					; _ssl3_send_client_key_exchange+3D3j ...
		mov	eax, [esi+8]
		push	ebx
		push	10h
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 1181h

loc_3CE7:				; CODE XREF: _ssl3_send_client_key_exchange+44j
		mov	eax, [esi+8]
		push	esi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 4

loc_3CF6:				; CODE XREF: _ssl3_send_client_key_exchange+CD6j
		mov	ecx, [esp+380h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 370h
		retn
; ---------------------------------------------------------------------------

loc_3D0F:				; CODE XREF: _ssl3_send_client_key_exchange+B6j
					; _ssl3_send_client_key_exchange+BFj ...
		push	9CFh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		push	ebx
		call	_EVP_PKEY_free
		add	esp, 18h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3D35:				; CODE XREF: _ssl3_send_client_key_exchange+67j
		test	al, 0Eh
		jz	loc_3EFC
		mov	eax, [esi+0C0h]
		mov	eax, [eax+98h]
		mov	[esp+380h+var_36C], eax
		test	eax, eax
		jnz	short loc_3D6F
		push	0Ah
		push	2
		push	esi
		call	_ssl3_send_alert
		push	0A89h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0F4h ; 'ô'
		jmp	loc_47A8
; ---------------------------------------------------------------------------

loc_3D6F:				; CODE XREF: _ssl3_send_client_key_exchange+22Bj
		mov	ebx, [eax+0F0h]
		test	ebx, ebx
		jnz	short loc_3D8C
		push	eax
		call	_get_server_static_dh_key
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_47B7

loc_3D8C:				; CODE XREF: _ssl3_send_client_key_exchange+253j
		mov	eax, [esi+58h]
		test	byte ptr [eax],	10h
		jz	short loc_3DBC
		mov	eax, [esi+98h]
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_3DB2
		push	eax
		call	_EVP_PKEY_get1_DH
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_3E1E

loc_3DB2:				; CODE XREF: _ssl3_send_client_key_exchange+27Dj
		push	0A9Dh
		jmp	loc_3BA6
; ---------------------------------------------------------------------------

loc_3DBC:				; CODE XREF: _ssl3_send_client_key_exchange+26Ej
		push	ebx
		call	_DHparams_dup
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_3DEB
		push	0AA3h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	5
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3DEB:				; CODE XREF: _ssl3_send_client_key_exchange+2A5j
		push	ebp
		call	_DH_generate_key
		add	esp, 4
		test	eax, eax
		jnz	short loc_3E1E
		push	0AA7h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	5
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		push	ebp
		call	_DH_free
		add	esp, 18h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3E1E:				; CODE XREF: _ssl3_send_client_key_exchange+28Cj
					; _ssl3_send_client_key_exchange+2D2j
		push	ebp
		push	dword ptr [ebx+14h]
		push	edi
		call	_DH_compute_key
		mov	edx, eax
		add	esp, 0Ch
		mov	eax, [esp+380h+var_36C]
		mov	[esp+380h+Size], edx
		cmp	dword ptr [eax+0F0h], 0
		jnz	short loc_3E4B
		push	ebx
		call	_DH_free
		mov	edx, [esp+384h+Size]
		add	esp, 4

loc_3E4B:				; CODE XREF: _ssl3_send_client_key_exchange+318j
		test	edx, edx
		jg	short loc_3E75
		push	0AB7h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	5
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		push	ebp
		call	_DH_free
		add	esp, 18h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_3E75:				; CODE XREF: _ssl3_send_client_key_exchange+329j
		mov	eax, [esi+8]
		push	edx
		push	edi
		mov	ecx, [eax+64h]
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		push	[esp+390h+Size]	; Size
		mov	ecx, [esi+0C0h]
		push	0		; Val
		push	edi		; Dst
		mov	[ecx+10h], eax
		call	_memset
		mov	eax, [esi+58h]
		add	esp, 1Ch
		test	byte ptr [eax],	10h
		jz	short loc_3EBD
		push	ebp
		xor	ebx, ebx
		call	_DH_free
		add	esp, 4
		jmp	loc_3CCE
; ---------------------------------------------------------------------------

loc_3EBD:				; CODE XREF: _ssl3_send_client_key_exchange+387j
		push	dword ptr [ebp+14h]
		call	_BN_num_bits
		add	eax, 7
		cdq
		and	edx, 7
		lea	ebx, [edx+eax]
		sar	ebx, 3
		mov	eax, ebx
		mov	[edi+1], bl
		sar	eax, 8
		mov	[edi], al
		lea	eax, [edi+2]
		push	eax
		push	dword ptr [ebp+14h]
		call	_BN_bn2bin
		add	esp, 0Ch
		add	ebx, 2
		push	ebp
		call	_DH_free
		add	esp, 4
		jmp	loc_3CCE
; ---------------------------------------------------------------------------

loc_3EFC:				; CODE XREF: _ssl3_send_client_key_exchange+213j
		test	al, 0E0h
		jz	loc_4162
		mov	eax, [esi+0C0h]
		mov	eax, [eax+98h]
		test	eax, eax
		jnz	short loc_3F32
		push	0Ah
		push	2
		push	esi
		call	_ssl3_send_alert
		push	0ADDh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0F4h ; 'ô'
		jmp	loc_47A8
; ---------------------------------------------------------------------------

loc_3F32:				; CODE XREF: _ssl3_send_client_key_exchange+3EEj
		mov	ebx, [eax+0F4h]
		test	ebx, ebx
		jnz	short loc_3F70
		push	dword ptr [eax+98h]
		call	_X509_get_pubkey
		mov	ebp, eax
		add	esp, 4
		mov	[esp+380h+Size], ebp
		test	ebp, ebp
		jz	loc_4142
		cmp	dword ptr [ebp+0], 198h
		jnz	loc_4142
		mov	ebx, [ebp+14h]
		test	ebx, ebx
		jz	loc_4142

loc_3F70:				; CODE XREF: _ssl3_send_client_key_exchange+416j
		push	ebx
		call	_EC_KEY_get0_group
		push	ebx
		mov	ebp, eax
		call	_EC_KEY_get0_public_key
		add	esp, 8
		mov	ebx, eax
		test	ebp, ebp
		jz	loc_411E
		test	ebx, ebx
		jz	loc_411E
		call	_EC_KEY_new
		mov	[esp+380h+var_368], eax
		test	eax, eax
		jnz	short loc_3FB1
		push	0B1Ah
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		jmp	loc_412A
; ---------------------------------------------------------------------------

loc_3FB1:				; CODE XREF: _ssl3_send_client_key_exchange+47Aj
		push	ebp
		push	eax
		call	_EC_KEY_set_group
		add	esp, 8
		test	eax, eax
		jnz	short loc_3FD0
		push	0B1Fh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	10h
		jmp	loc_412A
; ---------------------------------------------------------------------------

loc_3FD0:				; CODE XREF: _ssl3_send_client_key_exchange+499j
		push	[esp+380h+var_368]
		call	_EC_KEY_generate_key
		add	esp, 4
		test	eax, eax
		jnz	short loc_3FF1
		push	0B37h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	2Bh ; '+'
		jmp	loc_412A
; ---------------------------------------------------------------------------

loc_3FF1:				; CODE XREF: _ssl3_send_client_key_exchange+4BAj
		push	ebp
		call	_EC_GROUP_get_degree
		add	esp, 4
		test	eax, eax
		jg	short loc_400F
		push	0B43h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	2Bh ; '+'
		jmp	loc_412A
; ---------------------------------------------------------------------------

loc_400F:				; CODE XREF: _ssl3_send_client_key_exchange+4D8j
		add	eax, 7
		cdq
		push	0
		push	[esp+384h+var_368]
		and	edx, 7
		add	eax, edx
		push	ebx
		sar	eax, 3
		push	eax
		push	edi
		call	_ECDH_compute_key
		mov	ebx, eax
		add	esp, 14h
		test	ebx, ebx
		jg	short loc_4043
		push	0B49h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	2Bh ; '+'
		jmp	loc_412A
; ---------------------------------------------------------------------------

loc_4043:				; CODE XREF: _ssl3_send_client_key_exchange+50Cj
		mov	eax, [esi+8]
		push	ebx
		push	edi
		mov	ecx, [eax+64h]
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	ebx		; Size
		push	0		; Val
		push	edi		; Dst
		mov	[ecx+10h], eax
		call	_memset
		add	esp, 1Ch
		push	0
		push	0
		push	0
		push	4
		push	[esp+390h+var_368]
		call	_EC_KEY_get0_public_key
		add	esp, 4
		push	eax
		push	ebp
		call	_EC_POINT_point2oct
		push	0B65h
		mov	ebx, eax
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	ebx
		call	_CRYPTO_malloc
		add	esp, 24h
		mov	[esp+380h+Src],	eax
		call	_BN_CTX_new
		mov	ecx, eax
		mov	eax, [esp+380h+Src]
		mov	[esp+380h+var_360], ecx
		test	eax, eax
		jz	short loc_4110
		test	ecx, ecx
		jz	short loc_4110
		push	ecx
		push	ebx
		push	eax
		push	4
		push	[esp+390h+var_368]
		call	_EC_KEY_get0_public_key
		add	esp, 4
		push	eax
		push	ebp
		call	_EC_POINT_point2oct
		mov	ebp, [esp+398h+Src]
		mov	ebx, eax
		push	ebx		; Size
		lea	eax, [edi+1]
		mov	[edi], bl
		push	ebp		; Src
		push	eax		; Dst
		call	_memcpy
		push	[esp+3A4h+var_360]
		inc	ebx
		call	_BN_CTX_free
		push	ebp
		call	_CRYPTO_free
		push	[esp+3ACh+var_368]
		call	_EC_KEY_free
		push	[esp+3B0h+Size]
		call	_EVP_PKEY_free
		add	esp, 34h
		jmp	loc_3CCE
; ---------------------------------------------------------------------------

loc_4110:				; CODE XREF: _ssl3_send_client_key_exchange+591j
					; _ssl3_send_client_key_exchange+595j
		push	0B69h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		jmp	short loc_412A
; ---------------------------------------------------------------------------

loc_411E:				; CODE XREF: _ssl3_send_client_key_exchange+461j
					; _ssl3_send_client_key_exchange+469j
		push	0B14h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'

loc_412A:				; CODE XREF: _ssl3_send_client_key_exchange+488j
					; _ssl3_send_client_key_exchange+4A7j ...
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		mov	ebp, [esp+394h+Size]
		add	esp, 14h
		jmp	$err$111
; ---------------------------------------------------------------------------

loc_4142:				; CODE XREF: _ssl3_send_client_key_exchange+42Ej
					; _ssl3_send_client_key_exchange+43Bj ...
		push	0B08h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$111
; ---------------------------------------------------------------------------

loc_4162:				; CODE XREF: _ssl3_send_client_key_exchange+3DAj
		test	eax, 200h
		jz	loc_440B
		mov	eax, [esi+0C0h]
		mov	ecx, [eax+98h]
		mov	eax, [ecx+0D0h]
		test	eax, eax
		jnz	short loc_41B0
		mov	eax, [ecx+0B4h]
		test	eax, eax
		jnz	short loc_41B0
		push	0B9Ch
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	14Ah
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_41B0:				; CODE XREF: _ssl3_send_client_key_exchange+65Dj
					; _ssl3_send_client_key_exchange+667j
		push	eax
		call	_X509_get_pubkey
		push	0
		push	eax
		mov	[esp+38Ch+var_36C], eax
		call	_EVP_PKEY_CTX_new
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_41EB
		push	0BA4h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_41EB:				; CODE XREF: _ssl3_send_client_key_exchange+6A5j
		push	ebp
		call	_EVP_PKEY_encrypt_init
		add	esp, 4
		test	eax, eax
		jle	loc_43FE
		lea	eax, [esp+380h+var_328]
		push	20h ; ' '
		push	eax
		call	_RAND_bytes
		add	esp, 8
		test	eax, eax
		jle	loc_43FE
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+358h], 0
		jz	short loc_4241
		mov	eax, [esi+98h]
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4241
		push	eax
		push	ebp
		call	_EVP_PKEY_derive_set_peer
		add	esp, 8
		test	eax, eax
		jg	short loc_4241
		call	_ERR_clear_error

loc_4241:				; CODE XREF: _ssl3_send_client_key_exchange+6F9j
					; _ssl3_send_client_key_exchange+708j ...
		call	_EVP_MD_CTX_create
		push	329h
		mov	ebx, eax
		call	_OBJ_nid2sn
		push	eax
		call	_EVP_get_digestbyname
		push	eax
		push	ebx
		call	_EVP_DigestInit
		add	esp, 10h
		test	eax, eax
		jle	loc_43D8
		mov	eax, [esi+58h]
		push	20h ; ' '
		add	eax, 0C0h ; 'À'
		push	eax
		push	ebx
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_43D8
		mov	eax, [esi+58h]
		push	20h ; ' '
		add	eax, 0A0h ; ' '
		push	eax
		push	ebx
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_43D8
		lea	eax, [esp+380h+var_35C]
		push	eax
		lea	eax, [esp+384h+var_358]
		push	eax
		push	ebx
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_43D8
		push	ebx
		call	_EVP_MD_CTX_destroy
		lea	eax, [esp+384h+var_358]
		push	eax
		push	8
		push	8
		push	100h
		push	0FFFFFFFFh
		push	ebp
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 1Ch
		test	eax, eax
		jns	short loc_4303
		push	0BDCh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	112h
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_4303:				; CODE XREF: _ssl3_send_client_key_exchange+7BAj
		push	20h ; ' '
		lea	eax, [esp+384h+var_328]
		mov	byte ptr [edi],	30h ; '0'
		push	eax
		lea	eax, [esp+388h+Size]
		mov	[esp+388h+Size], 0FFh
		push	eax
		lea	eax, [esp+38Ch+Dst]
		push	eax
		push	ebp
		call	_EVP_PKEY_encrypt
		add	esp, 14h
		test	eax, eax
		jg	short loc_4352
		push	0BE8h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	112h
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_4352:				; CODE XREF: _ssl3_send_client_key_exchange+809j
		mov	eax, [esp+380h+Size]
		cmp	eax, 80h ; ''
		jb	short loc_436C
		mov	byte ptr [edi+1], 81h ;	''
		lea	ebx, [eax+3]
		mov	[edi+2], al
		add	edi, 3
		jmp	short loc_4375
; ---------------------------------------------------------------------------

loc_436C:				; CODE XREF: _ssl3_send_client_key_exchange+837j
		mov	[edi+1], al
		lea	ebx, [eax+2]
		add	edi, 2

loc_4375:				; CODE XREF: _ssl3_send_client_key_exchange+846j
		push	eax		; Size
		lea	eax, [esp+384h+Dst]
		push	eax		; Src
		push	edi		; Dst
		call	_memcpy
		push	0
		push	2
		push	2
		push	0FFFFFFFFh
		push	0FFFFFFFFh
		push	ebp
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 24h
		test	eax, eax
		jle	short loc_439E
		mov	eax, [esi+58h]
		or	dword ptr [eax], 10h

loc_439E:				; CODE XREF: _ssl3_send_client_key_exchange+872j
		push	ebp
		call	_EVP_PKEY_CTX_free
		mov	eax, [esi+8]
		push	20h ; ' '
		mov	ecx, [eax+64h]
		lea	eax, [esp+388h+var_328]
		push	eax
		mov	eax, [esi+0C0h]
		add	eax, 14h
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		push	[esp+394h+var_36C]
		mov	[ecx+10h], eax
		call	_EVP_PKEY_free
		jmp	loc_3CCB
; ---------------------------------------------------------------------------

loc_43D8:				; CODE XREF: _ssl3_send_client_key_exchange+740j
					; _ssl3_send_client_key_exchange+75Cj ...
		push	ebx
		call	_EVP_MD_CTX_destroy
		push	0BD4h

loc_43E3:				; CODE XREF: _ssl3_send_client_key_exchange+8E5j
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 18h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_43FE:				; CODE XREF: _ssl3_send_client_key_exchange+6D2j
					; _ssl3_send_client_key_exchange+6E9j
		push	ebp
		call	_EVP_PKEY_CTX_free
		push	0BB6h
		jmp	short loc_43E3
; ---------------------------------------------------------------------------

loc_440B:				; CODE XREF: _ssl3_send_client_key_exchange+643j
		test	eax, 400h
		jz	loc_44E9
		mov	eax, [esi+1B8h]
		test	eax, eax
		jz	loc_44DF
		push	eax
		call	_BN_num_bits
		add	eax, 7
		cdq
		and	edx, 7
		lea	ebx, [edx+eax]
		sar	ebx, 3
		mov	eax, ebx
		mov	[edi+1], bl
		sar	eax, 8
		mov	[edi], al
		lea	eax, [edi+2]
		push	eax
		push	dword ptr [esi+1B8h]
		call	_BN_bn2bin
		mov	eax, [esi+0C0h]
		add	esp, 0Ch
		add	ebx, 2
		mov	eax, [eax+0F0h]
		test	eax, eax
		jz	short loc_446F
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_446F:				; CODE XREF: _ssl3_send_client_key_exchange+940j
		push	dword ptr [esi+1A4h]
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+0F0h], eax
		mov	eax, [esi+0C0h]
		cmp	[eax+0F0h], ebp
		jnz	short loc_44B7
		push	0C16h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_44B7:				; CODE XREF: _ssl3_send_client_key_exchange+971j
		add	eax, 14h
		push	eax
		push	esi
		call	_SRP_generate_client_master_secret
		mov	ecx, [esi+0C0h]
		add	esp, 8
		mov	[ecx+10h], eax
		test	eax, eax
		jns	loc_3CCE
		push	0C1Fh
		jmp	loc_3BA6
; ---------------------------------------------------------------------------

loc_44DF:				; CODE XREF: _ssl3_send_client_key_exchange+8FAj
		push	0C0Eh
		jmp	loc_3BA6
; ---------------------------------------------------------------------------

loc_44E9:				; CODE XREF: _ssl3_send_client_key_exchange+8ECj
		test	eax, 100h
		jz	loc_4792
		mov	ebp, [esi+0DCh]
		xor	ebx, ebx
		mov	[esp+380h+var_36C], 1
		test	ebp, ebp
		jnz	short loc_452B
		push	0C35h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0E0h ; 'à'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_47B7
; ---------------------------------------------------------------------------

loc_452B:				; CODE XREF: _ssl3_send_client_key_exchange+9E2j
		push	82h ; ''       ; Size
		lea	eax, [esp+384h+Dst]
		push	0		; Val
		push	eax		; Dst
		call	_memset
		push	204h
		lea	eax, [esp+390h+var_208]
		push	eax
		push	81h ; ''
		lea	eax, [esp+398h+Dst]
		push	eax
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+8Ch]
		push	esi
		call	ebp
		mov	edx, eax
		add	esp, 24h
		mov	[esp+380h+Size], edx
		cmp	edx, 100h
		jbe	short loc_4596
		push	0C40h

loc_457B:				; CODE XREF: _ssl3_send_client_key_exchange+AC1j
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$112
; ---------------------------------------------------------------------------

loc_4596:				; CODE XREF: _ssl3_send_client_key_exchange+A50j
		test	edx, edx
		jnz	short loc_45BD
		push	0C44h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0DFh ; 'ß'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		jmp	$psk_err$112
; ---------------------------------------------------------------------------

loc_45BD:				; CODE XREF: _ssl3_send_client_key_exchange+A74j
		lea	ecx, [esp+380h+Dst]
		mov	[esp+380h+var_287], bl
		lea	ebp, [ecx+1]

loc_45CB:				; CODE XREF: _ssl3_send_client_key_exchange+AACj
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_45CB
		sub	ecx, ebp
		mov	[esp+380h+var_35C], ecx
		cmp	ecx, 80h ; ''
		jbe	short loc_45E7
		push	0C4Bh
		jmp	short loc_457B
; ---------------------------------------------------------------------------

loc_45E7:				; CODE XREF: _ssl3_send_client_key_exchange+ABAj
		push	edx		; Size
		lea	eax, [esp+384h+var_208]
		push	eax		; Src
		lea	eax, [esp+388h+var_204]
		add	eax, edx
		lea	ebp, ds:4[edx*2]
		push	eax		; Dst
		call	dword ptr ds:__imp__memmove
		mov	eax, [esp+38Ch+Size]
		mov	ebx, eax
		push	eax		; Size
		mov	[esp+390h+var_207], al
		lea	eax, [esp+390h+var_206]
		push	0		; Val
		shr	ebx, 8
		push	eax		; Dst
		mov	[esp+398h+var_208], bl
		call	_memset
		mov	eax, [esp+398h+Size]
		add	esp, 18h
		mov	[esp+eax+380h+var_206],	bl
		mov	[esp+eax+380h+var_205],	al
		mov	eax, [esi+0C0h]
		mov	eax, [eax+8Ch]
		test	eax, eax
		jz	short loc_465C
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_465C:				; CODE XREF: _ssl3_send_client_key_exchange+B2Dj
		mov	eax, [esi+0E4h]
		push	dword ptr [eax+14Ch]
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+8Ch], eax
		mov	eax, [esi+0E4h]
		cmp	dword ptr [eax+14Ch], 0
		jz	short loc_46BC
		mov	eax, [esi+0C0h]
		cmp	dword ptr [eax+8Ch], 0
		jnz	short loc_46BC
		push	0C5Eh

loc_469F:				; CODE XREF: _ssl3_send_client_key_exchange+BDEj
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	41h ; 'A'
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		jmp	$psk_err$112
; ---------------------------------------------------------------------------

loc_46BC:				; CODE XREF: _ssl3_send_client_key_exchange+B65j
					; _ssl3_send_client_key_exchange+B74j
		mov	eax, [esi+0C0h]
		mov	eax, [eax+90h]
		test	eax, eax
		jz	short loc_46D5
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_46D5:				; CODE XREF: _ssl3_send_client_key_exchange+BA6j
		lea	eax, [esp+380h+Dst]
		push	eax
		call	_BUF_strdup
		mov	ecx, [esi+0C0h]
		add	esp, 4
		mov	[ecx+90h], eax
		mov	edx, [esi+0C0h]
		cmp	dword ptr [edx+90h], 0
		jnz	short loc_4704
		push	0C67h
		jmp	short loc_469F
; ---------------------------------------------------------------------------

loc_4704:				; CODE XREF: _ssl3_send_client_key_exchange+BD7j
		mov	eax, [esi+8]
		push	ebp
		mov	ecx, [eax+64h]
		lea	eax, [esp+384h+var_208]
		push	eax
		lea	eax, [edx+14h]
		push	eax
		mov	eax, [ecx+0Ch]
		push	esi
		call	eax
		mov	ecx, [esi+0C0h]
		mov	ebx, [esp+390h+var_35C]
		push	ebx		; Size
		mov	[ecx+10h], eax
		mov	eax, ebx
		shr	eax, 8
		mov	[edi], al
		lea	eax, [esp+394h+Dst]
		push	eax		; Src
		lea	eax, [edi+2]
		mov	[edi+1], bl
		push	eax		; Dst
		call	_memcpy
		add	esp, 1Ch
		mov	[esp+380h+var_36C], 0
		add	ebx, 2

$psk_err$112:				; CODE XREF: _ssl3_send_client_key_exchange+A6Dj
					; _ssl3_send_client_key_exchange+A94j ...
		lea	eax, [esp+380h+Dst]
		push	82h ; ''
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+388h+var_208]
		push	204h
		push	eax
		call	_OPENSSL_cleanse
		add	esp, 10h
		cmp	[esp+380h+var_36C], 0
		jz	loc_3CCE
		push	28h ; '('
		push	2
		push	esi
		call	_ssl3_send_alert
		add	esp, 0Ch
		jmp	short loc_47B7
; ---------------------------------------------------------------------------

loc_4792:				; CODE XREF: _ssl3_send_client_key_exchange+9CAj
		push	28h ; '('
		push	2
		push	esi
		call	_ssl3_send_alert
		push	0C80h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'

loc_47A8:				; CODE XREF: _ssl3_send_client_key_exchange+246j
					; _ssl3_send_client_key_exchange+409j
		push	98h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 20h

loc_47B7:				; CODE XREF: _ssl3_send_client_key_exchange+98j
					; _ssl3_send_client_key_exchange+101j ...
		xor	ebp, ebp

$err$111:				; CODE XREF: _ssl3_send_client_key_exchange+619j
					; _ssl3_send_client_key_exchange+639j
		push	[esp+380h+var_360]
		call	_BN_CTX_free
		mov	eax, [esp+384h+Src]
		add	esp, 4
		test	eax, eax
		jz	short loc_47D6
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_47D6:				; CODE XREF: _ssl3_send_client_key_exchange+CA7j
		mov	eax, [esp+380h+var_368]
		test	eax, eax
		jz	short loc_47E7
		push	eax
		call	_EC_KEY_free
		add	esp, 4

loc_47E7:				; CODE XREF: _ssl3_send_client_key_exchange+CB8j
		push	ebp
		call	_EVP_PKEY_free
		add	esp, 4
		mov	dword ptr [esi+34h], 5
		or	eax, 0FFFFFFFFh
		jmp	loc_3CF6
_ssl3_send_client_key_exchange endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4800h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_client_verify
_ssl3_send_client_verify proc near	; CODE XREF: _ssl3_connect+3C6p

var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= byte ptr -80h
var_68		= byte ptr -68h
var_58		= byte ptr -58h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 94h ; ''
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+94h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+0A4h+arg_0]
		lea	eax, [esp+0A4h+var_80]
		xor	ebp, ebp
		push	eax
		mov	[esp+0A8h+var_90], ebp
		call	_EVP_MD_CTX_init
		add	esp, 4
		cmp	dword ptr [edi+34h], 1190h
		jnz	loc_4B36
		mov	eax, [edi+8]
		mov	ecx, [edi+3Ch]
		push	ebp
		mov	eax, [eax+64h]
		mov	esi, [ecx+4]
		add	esi, [eax+3Ch]
		mov	eax, [edi+98h]
		mov	eax, [eax]
		mov	ebx, [eax+4]
		push	ebx
		call	_EVP_PKEY_CTX_new
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	loc_4B6E
		push	ebp
		call	_EVP_PKEY_sign_init
		add	esp, 4
		test	eax, eax
		jle	loc_4B6E
		call	_EVP_sha1
		push	eax
		push	0
		push	1
		push	0F8h ; 'ø'
		push	0FFFFFFFFh
		push	ebp
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jle	short loc_48BE
		mov	eax, [edi+8]
		mov	eax, [eax+64h]
		test	byte ptr [eax+38h], 2
		jnz	short loc_48C3
		mov	eax, [eax+1Ch]
		lea	ecx, [esp+0A4h+var_58]
		push	ecx
		push	40h ; '@'
		push	edi
		call	eax
		add	esp, 0Ch
		jmp	short loc_48C3
; ---------------------------------------------------------------------------

loc_48BE:				; CODE XREF: _ssl3_send_client_verify+9Ej
		call	_ERR_clear_error

loc_48C3:				; CODE XREF: _ssl3_send_client_verify+AAj
					; _ssl3_send_client_verify+BCj
		mov	eax, [edi+8]
		mov	ecx, [eax+64h]
		test	byte ptr [ecx+38h], 2
		jz	loc_49B2
		mov	eax, [edi+98h]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[esp+0A4h+var_88], eax
		lea	eax, [esp+0A4h+var_8C]
		push	eax
		mov	eax, [edi+58h]
		push	0
		push	3
		push	dword ptr [eax+178h]
		call	_BIO_ctrl
		add	esp, 10h
		mov	[esp+0A4h+var_84], eax
		test	eax, eax
		jle	loc_49A8
		push	[esp+0A4h+var_88]
		push	ebx
		push	esi
		call	_tls12_get_sigandhash
		add	esp, 0Ch
		test	eax, eax
		jz	loc_49A8
		push	0
		push	[esp+0A8h+var_88]
		lea	eax, [esp+0ACh+var_80]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_4997
		push	[esp+0A4h+var_84]
		lea	eax, [esp+0A8h+var_80]
		push	[esp+0A8h+var_8C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_4997
		push	ebx
		lea	eax, [esp+0A8h+var_90]
		push	eax
		lea	eax, [esi+4]
		push	eax
		lea	eax, [esp+0B0h+var_80]
		push	eax
		call	_EVP_SignFinal
		add	esp, 10h
		test	eax, eax
		jz	short loc_4997
		mov	eax, [esp+0A4h+var_90]
		shr	eax, 8
		mov	[esi+2], al
		mov	al, byte ptr [esp+0A4h+var_90]
		mov	[esi+3], al
		mov	esi, [esp+0A4h+var_90]
		push	edi
		add	esi, 4
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jz	$err$41
		jmp	loc_4B1D
; ---------------------------------------------------------------------------

loc_4997:				; CODE XREF: _ssl3_send_client_verify+133j
					; _ssl3_send_client_verify+14Cj ...
		push	0CCBh
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	6
		jmp	loc_4B7A
; ---------------------------------------------------------------------------

loc_49A8:				; CODE XREF: _ssl3_send_client_verify+102j
					; _ssl3_send_client_verify+118j
		push	0CC0h
		jmp	loc_4B73
; ---------------------------------------------------------------------------

loc_49B2:				; CODE XREF: _ssl3_send_client_verify+CDj
		mov	eax, [ebx]
		cmp	eax, 6
		jnz	short loc_4A11
		lea	eax, [esp+0A4h+var_68]
		push	eax
		mov	eax, [ecx+1Ch]
		push	4
		push	edi
		call	eax
		push	dword ptr [ebx+14h]
		lea	eax, [esp+0B4h+var_90]
		push	eax
		lea	eax, [esi+2]
		push	eax
		push	24h ; '$'
		lea	eax, [esp+0C0h+var_68]
		push	eax
		push	72h ; 'r'
		call	_RSA_sign
		add	esp, 24h
		test	eax, eax
		jg	short loc_49F8
		push	0CD9h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	4
		jmp	loc_4B7A
; ---------------------------------------------------------------------------

loc_49F8:				; CODE XREF: _ssl3_send_client_verify+1E5j
		mov	eax, [esp+0A4h+var_90]
		shr	eax, 8
		mov	[esi], al
		mov	al, byte ptr [esp+0A4h+var_90]
		mov	[esi+1], al
		mov	esi, [esp+0A4h+var_90]
		jmp	loc_4B1A
; ---------------------------------------------------------------------------

loc_4A11:				; CODE XREF: _ssl3_send_client_verify+1B7j
		cmp	eax, 74h ; 't'
		jnz	short loc_4A57
		push	dword ptr [ebx+14h]
		lea	eax, [esp+0A8h+var_94]
		push	eax
		lea	eax, [esi+2]
		push	eax
		push	14h
		lea	eax, [esp+0B4h+var_58]
		push	eax
		push	dword ptr [ebx+4]
		call	_DSA_sign
		add	esp, 18h
		test	eax, eax
		jnz	short loc_4A49
		push	0CE6h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	0Ah
		jmp	loc_4B7A
; ---------------------------------------------------------------------------

loc_4A49:				; CODE XREF: _ssl3_send_client_verify+236j
					; _ssl3_send_client_verify+27Ej
		mov	eax, [esp+0A4h+var_94]
		sar	eax, 8
		mov	[esi], al
		jmp	loc_4B0F
; ---------------------------------------------------------------------------

loc_4A57:				; CODE XREF: _ssl3_send_client_verify+214j
		cmp	eax, 198h
		jnz	short loc_4A91
		push	dword ptr [ebx+14h]
		lea	eax, [esp+0A8h+var_94]
		push	eax
		lea	eax, [esi+2]
		push	eax
		push	14h
		lea	eax, [esp+0B4h+var_58]
		push	eax
		push	dword ptr [ebx+4]
		call	_ECDSA_sign
		add	esp, 18h
		test	eax, eax
		jnz	short loc_4A49
		push	0CF3h
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	2Ah ; '*'
		jmp	loc_4B7A
; ---------------------------------------------------------------------------

loc_4A91:				; CODE XREF: _ssl3_send_client_verify+25Cj
		cmp	eax, 32Ch
		jz	short loc_4AA9
		cmp	eax, 32Bh
		jz	short loc_4AA9
		push	0D0Bh
		jmp	loc_4B73
; ---------------------------------------------------------------------------

loc_4AA9:				; CODE XREF: _ssl3_send_client_verify+296j
					; _ssl3_send_client_verify+29Dj
		lea	eax, [esp+0A4h+var_68]
		mov	[esp+0A4h+var_8C], 40h ; '@'
		push	eax
		mov	eax, [ecx+1Ch]
		push	329h
		push	edi
		call	eax
		push	20h ; ' '
		lea	eax, [esp+0B4h+var_68]
		push	eax
		lea	eax, [esp+0B8h+var_8C]
		push	eax
		lea	eax, [esp+0BCh+var_44]
		push	eax
		push	ebp
		call	_EVP_PKEY_sign
		add	esp, 20h
		test	eax, eax
		jg	short loc_4AE9
		push	0D02h
		jmp	loc_4B73
; ---------------------------------------------------------------------------

loc_4AE9:				; CODE XREF: _ssl3_send_client_verify+2DDj
		xor	ecx, ecx
		mov	edx, 3Fh ; '?'
		mov	[esp+0A4h+var_94], ecx

loc_4AF4:				; CODE XREF: _ssl3_send_client_verify+308j
		mov	al, [esp+edx+0A4h+var_44]
		mov	[esi+ecx+2], al
		mov	ecx, [esp+0A4h+var_94]
		inc	ecx
		sub	edx, 1
		mov	[esp+0A4h+var_94], ecx
		jns	short loc_4AF4
		sar	ecx, 8
		mov	[esi], cl

loc_4B0F:				; CODE XREF: _ssl3_send_client_verify+252j
		mov	al, byte ptr [esp+0A4h+var_94]
		mov	[esi+1], al
		mov	esi, [esp+0A4h+var_94]

loc_4B1A:				; CODE XREF: _ssl3_send_client_verify+20Cj
		add	esi, 2

loc_4B1D:				; CODE XREF: _ssl3_send_client_verify+192j
		mov	eax, [edi+8]
		push	esi
		push	0Fh
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+40h]
		call	eax
		add	esp, 0Ch
		mov	dword ptr [edi+34h], 1191h

loc_4B36:				; CODE XREF: _ssl3_send_client_verify+3Dj
		lea	eax, [esp+0A4h+var_80]
		push	eax
		call	_EVP_MD_CTX_cleanup
		push	ebp
		call	_EVP_PKEY_CTX_free
		mov	eax, [edi+8]
		push	edi
		mov	eax, [eax+64h]
		mov	eax, [eax+44h]
		call	eax
		add	esp, 0Ch

loc_4B55:				; CODE XREF: _ssl3_send_client_verify+3A6j
		mov	ecx, [esp+0A4h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_4B6E:				; CODE XREF: _ssl3_send_client_verify+6Bj
					; _ssl3_send_client_verify+7Cj
		push	0CAAh

loc_4B73:				; CODE XREF: _ssl3_send_client_verify+1ADj
					; _ssl3_send_client_verify+2A4j ...
		push	offset ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ ; ".\\ssl\\s3_clnt.c"
		push	44h ; 'D'

loc_4B7A:				; CODE XREF: _ssl3_send_client_verify+1A3j
					; _ssl3_send_client_verify+1F3j ...
		push	99h ; ''
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err$41:				; CODE XREF: _ssl3_send_client_verify+18Cj
		lea	eax, [esp+0A4h+var_80]
		push	eax
		call	_EVP_MD_CTX_cleanup
		push	ebp
		call	_EVP_PKEY_CTX_free
		add	esp, 8
		mov	dword ptr [edi+34h], 5
		or	eax, 0FFFFFFFFh
		jmp	short loc_4B55
_ssl3_send_client_verify endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4BA8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_send_next_proto
_ssl3_send_next_proto proc near		; CODE XREF: _ssl3_connect+497p

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	dword ptr [edi+34h], 1200h
		jnz	loc_4C40
		movzx	ecx, byte ptr [edi+178h]
		push	ebx
		mov	ebx, 20h ; ' '
		mov	[esp+8+arg_0], ecx
		push	esi
		lea	eax, [ecx+2]
		and	eax, 1Fh
		sub	ebx, eax
		mov	eax, [edi+3Ch]
		push	ecx		; Size
		mov	esi, [eax+4]
		mov	[esi+4], cl
		lea	eax, [esi+5]
		push	dword ptr [edi+174h] ; Src
		push	eax		; Dst
		call	_memcpy
		mov	eax, [esp+18h+arg_0]
		push	ebx		; Size
		push	0		; Val
		mov	[esi+eax+5], bl
		add	eax, 6
		add	eax, esi
		push	eax		; Dst
		call	_memset
		mov	edx, [esp+24h+arg_0]
		add	esp, 18h
		add	edx, ebx
		mov	byte ptr [esi],	43h ; 'C'
		add	bl, 2
		lea	ecx, [edx+2]
		mov	eax, ecx
		shr	ecx, 8
		shr	eax, 10h
		add	bl, byte ptr [esp+0Ch+arg_0]
		mov	[esi+1], al
		lea	eax, [edx+6]
		mov	[esi+3], bl
		mov	[esi+2], cl
		pop	esi
		mov	dword ptr [edi+34h], 1201h
		mov	[edi+44h], eax
		mov	dword ptr [edi+48h], 0
		pop	ebx

loc_4C40:				; CODE XREF: _ssl3_send_next_proto+Cj
		push	16h
		push	edi
		call	_ssl3_do_write
		add	esp, 8
		pop	edi
		retn
_ssl3_send_next_proto endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4C50h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl_do_client_cert_cb
_ssl_do_client_cert_cb proc near	; CODE XREF: _ssl3_send_client_certificate+ABp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		xor	ecx, ecx
		mov	eax, [esi+0E4h]
		cmp	[eax+0FCh], ecx
		jz	short loc_4C95
		push	ecx
		push	ecx
		push	ecx
		push	[esp+10h+arg_8]
		push	[esp+14h+arg_4]
		push	esi
		call	_SSL_get_client_CA_list
		add	esp, 4
		push	eax
		mov	eax, [esi+0E4h]
		push	esi
		push	dword ptr [eax+0FCh]
		call	_ENGINE_load_ssl_client_cert
		mov	ecx, eax
		add	esp, 20h
		test	ecx, ecx
		jnz	short loc_4CB4

loc_4C95:				; CODE XREF: _ssl_do_client_cert_cb+13j
		mov	eax, [esi+0E4h]
		mov	eax, [eax+74h]
		test	eax, eax
		jz	short loc_4CB2
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	esi
		call	eax
		add	esp, 0Ch
		mov	ecx, eax

loc_4CB2:				; CODE XREF: _ssl_do_client_cert_cb+50j
		mov	eax, ecx

loc_4CB4:				; CODE XREF: _ssl_do_client_cert_cb+43j
		pop	esi
		retn
_ssl_do_client_cert_cb endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4CB8h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; time_t __cdecl static	time(time_t *Time)
_time		proc near
		jmp	dword ptr ds:__imp___time64
_time		endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4CC0h
; COMDAT (pick any)
		public ??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@
; `string'
??_C@_0BA@NMKJILMC@?4?2ssl?2s3_clnt?4c?$AA@ db '.\ssl\s3_clnt.c',0
					; DATA XREF: _ssl3_connect+744o
					; _ssl3_connect+775o ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _SSLv3_enc_data:near ; DATA XREF:	.rdata:0000098Co
		extrn _ssl_undefined_function:near ; DATA XREF:	.rdata:00000938o
		extrn _ssl_undefined_void_function:near	; DATA XREF: .rdata:00000990o
		extrn _ssl3_get_cipher_by_char:near ; DATA XREF: .rdata:00000970o
		extrn _ssl3_put_cipher_by_char:near ; DATA XREF: .rdata:00000974o
		extrn _ssl3_get_message:near ; DATA XREF: .rdata:00000958o
		extrn _ssl3_num_ciphers:near ; DATA XREF: .rdata:0000097Co
		extrn _ssl3_get_cipher:near ; DATA XREF: .rdata:00000980o
		extrn _ssl3_renegotiate:near ; DATA XREF: .rdata:00000950o
		extrn _ssl3_renegotiate_check:near ; DATA XREF:	.rdata:00000954o
		extrn _ssl3_dispatch_alert:near	; DATA XREF: .rdata:00000964o
		extrn _ssl3_read_bytes:near ; DATA XREF: .rdata:0000095Co
		extrn _ssl3_write_bytes:near ; DATA XREF: .rdata:00000960o
		extrn _ssl3_new:near	; DATA XREF: .rdata:0000092Co
		extrn _ssl3_free:near	; DATA XREF: .rdata:00000934o
		extrn _ssl3_read:near	; DATA XREF: .rdata:00000940o
		extrn _ssl3_peek:near	; DATA XREF: .rdata:00000944o
		extrn _ssl3_write:near	; DATA XREF: .rdata:00000948o
		extrn _ssl3_shutdown:near ; DATA XREF: .rdata:0000094Co
		extrn _ssl3_clear:near	; DATA XREF: .rdata:00000930o
		extrn _ssl3_ctrl:near	; DATA XREF: .rdata:00000968o
		extrn _ssl3_ctx_ctrl:near ; DATA XREF: .rdata:0000096Co
		extrn _ssl3_callback_ctrl:near ; DATA XREF: .rdata:00000994o
		extrn _ssl3_ctx_callback_ctrl:near ; DATA XREF:	.rdata:00000998o
		extrn _ssl3_pending:near ; DATA	XREF: .rdata:00000978o
		extrn _ssl3_default_timeout:near ; DATA	XREF: .rdata:00000988o
; __time64_t __cdecl __time64(__time64_t *Time)
		extrn __imp___time64:near ; CODE XREF: _ssl3_connect+11p
					; DATA XREF: _ssl3_connect+11r	...
; void *__cdecl	_memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp__memmove:near ; CODE XREF: _ssl3_send_client_key_exchange+ADDp
					; DATA XREF: _ssl3_send_client_key_exchange+ADDr
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn __imp__SetLastError@4:near ; CODE	XREF: _ssl3_connect+49p
					; DATA XREF: _ssl3_connect+49r
		extrn _BUF_MEM_new:near	; CODE XREF: _ssl3_connect+62Bp
		extrn _BUF_MEM_free:near ; CODE	XREF: _ssl3_connect+6C5p
					; _ssl3_connect+7BDp
		extrn _BUF_MEM_grow:near ; CODE	XREF: _ssl3_connect+640p
		extrn _BUF_strdup:near	; CODE XREF: _ssl3_send_client_key_exchange+951p
					; _ssl3_send_client_key_exchange+B44p ...
		extrn _BUF_strndup:near	; CODE XREF: _ssl3_get_key_exchange+291p
		extrn _BUF_memdup:near	; CODE XREF: _ssl3_get_cert_status+C7p
		extrn _sk_num:near	; CODE XREF: _ssl3_client_hello+27Fp
		extrn _sk_value:near	; CODE XREF: _ssl3_client_hello+2AFp
					; _ssl3_get_server_certificate+26Bp
		extrn _sk_new:near	; CODE XREF: _ssl3_get_certificate_request+120p
		extrn _sk_new_null:near	; CODE XREF: _ssl3_get_server_certificate+9Ap
		extrn _sk_pop_free:near	; CODE XREF: _ssl3_get_certificate_request+589p
					; _ssl3_get_certificate_request+5B2p ...
		extrn _sk_find:near	; CODE XREF: _ssl3_get_server_hello+494p
		extrn _sk_push:near	; CODE XREF: _ssl3_get_certificate_request+4A8p
					; _ssl3_get_server_certificate+16Ap
		extrn _CRYPTO_add_lock:near ; CODE XREF: _ssl3_get_server_certificate+33Fp
					; _ssl3_get_server_certificate+395p
		extrn _CRYPTO_malloc:near ; CODE XREF: _ssl3_get_certificate_request+19Cp
					; _ssl3_get_new_session_ticket+190p ...
		extrn _CRYPTO_free:near	; CODE XREF: _ssl3_get_certificate_request+174p
					; _ssl3_get_key_exchange+107p ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _ssl3_send_client_key_exchange+1A2p
					; _ssl3_send_client_key_exchange+C3Ap ...
		extrn _BIO_ctrl:near	; CODE XREF: _ssl3_connect+ECp
					; _ssl3_connect+20Bp ...
		extrn _BIO_push:near	; CODE XREF: _ssl3_connect+177p
		extrn _BN_CTX_new:near	; CODE XREF: _ssl3_get_key_exchange+AC3p
					; _ssl3_send_client_key_exchange+580p
		extrn _BN_CTX_free:near	; CODE XREF: _ssl3_get_key_exchange+B8Ap
					; _ssl3_get_key_exchange+FADp ...
		extrn _BN_num_bits:near	; CODE XREF: _ssl3_check_cert_and_algorithm+2B4p
					; _ssl3_check_cert_and_algorithm+2DBp ...
		extrn _BN_bin2bn:near	; CODE XREF: _ssl3_get_key_exchange+374p
					; _ssl3_get_key_exchange+401p ...
		extrn _BN_bn2bin:near	; CODE XREF: _ssl3_send_client_key_exchange+3BFp
					; _ssl3_send_client_key_exchange+927p
		extrn _RSA_new:near	; CODE XREF: _ssl3_get_key_exchange:loc_2072p
		extrn _RSA_public_encrypt:near
					; CODE XREF: _ssl3_send_client_key_exchange+12Ep
		extrn _RSA_free:near	; CODE XREF: _ssl3_get_key_exchange+15Cp
					; _ssl3_get_key_exchange+F90p
		extrn _RSA_sign:near	; CODE XREF: _ssl3_send_client_verify+1DBp
		extrn _RSA_verify:near	; CODE XREF: _ssl3_get_key_exchange+D7Cp
		extrn _DHparams_dup:near ; CODE	XREF: _ssl3_send_client_key_exchange+299p
		extrn _DH_new:near	; CODE XREF: _ssl3_get_key_exchange+759p
		extrn _DH_free:near	; CODE XREF: _ssl3_check_cert_and_algorithm+2E6p
					; _ssl3_get_key_exchange+191p ...
		extrn _DH_generate_key:near ; CODE XREF: _ssl3_send_client_key_exchange+2C8p
		extrn _DH_compute_key:near ; CODE XREF:	_ssl3_send_client_key_exchange+2FFp
		extrn _DSA_sign:near	; CODE XREF: _ssl3_send_client_verify+22Cp
		extrn _ERR_put_error:near ; CODE XREF: _ssl3_connect+755p
					; _ssl3_connect+786p ...
		extrn _ERR_clear_error:near ; CODE XREF: _ssl3_connect+43p
					; _ssl3_get_certificate_request:$cont$69p ...
		extrn _OBJ_nid2sn:near	; CODE XREF: _ssl3_send_client_key_exchange+729p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _ssl3_get_key_exchange+5Ep
					; _ssl3_send_client_verify+2Ep
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _ssl3_get_key_exchange+F30p
					; _ssl3_get_key_exchange+FD1p ...
		extrn _EVP_MD_CTX_create:near
					; CODE XREF: _ssl3_send_client_key_exchange:loc_4241p
		extrn _EVP_MD_CTX_destroy:near
					; CODE XREF: _ssl3_send_client_key_exchange+79Ap
					; _ssl3_send_client_key_exchange+8B5p
		extrn _EVP_MD_CTX_set_flags:near ; CODE	XREF: _ssl3_get_key_exchange+C99p
		extrn _EVP_DigestInit_ex:near ;	CODE XREF: _ssl3_get_key_exchange+CC4p
					; _ssl3_get_key_exchange+DF0p ...
		extrn _EVP_DigestUpdate:near ; CODE XREF: _ssl3_get_key_exchange+CE4p
					; _ssl3_get_key_exchange+D04p ...
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _ssl3_get_key_exchange+D3Cp
					; _ssl3_send_client_key_exchange+789p
		extrn _EVP_Digest:near	; CODE XREF: _ssl3_get_new_session_ticket+21Ap
		extrn _EVP_DigestInit:near ; CODE XREF:	_ssl3_send_client_key_exchange+736p
		extrn _EVP_SignFinal:near ; CODE XREF: _ssl3_send_client_verify+15Dp
		extrn _EVP_VerifyFinal:near ; CODE XREF: _ssl3_get_key_exchange+E5Dp
		extrn _EVP_sha1:near	; CODE XREF: _ssl3_get_key_exchange:loc_26C5p
					; _ssl3_send_client_verify+82p
		extrn _EVP_sha256:near	; CODE XREF: _ssl3_get_new_session_ticket+20Ap
		extrn _EVP_get_digestbyname:near
					; CODE XREF: _ssl3_send_client_key_exchange+72Fp
		extrn _EVP_PKEY_id:near	; CODE XREF: _ssl3_check_client_certificate+7Dp
		extrn _EVP_PKEY_bits:near ; CODE XREF: _ssl3_check_cert_and_algorithm+10Ep
					; _ssl3_get_key_exchange+6DBp
		extrn _EVP_PKEY_size:near ; CODE XREF: _ssl3_get_key_exchange+C39p
		extrn _EVP_PKEY_get1_DH:near ; CODE XREF: _get_server_static_dh_key+2Bp
					; _ssl3_send_client_key_exchange+280p
		extrn _EVP_PKEY_free:near ; CODE XREF: _get_server_static_dh_key+33p
					; _ssl3_check_cert_and_algorithm+123p ...
		extrn _EVP_PKEY_missing_parameters:near
					; CODE XREF: _ssl3_get_server_certificate+2B9p
		extrn _EVP_PKEY_cmp_parameters:near
					; CODE XREF: _ssl3_check_client_certificate+ABp
		extrn _EVP_PKEY_CTX_new:near
					; CODE XREF: _ssl3_send_client_key_exchange+699p
					; _ssl3_send_client_verify+5Fp
		extrn _EVP_PKEY_CTX_free:near
					; CODE XREF: _ssl3_send_client_key_exchange+87Bp
					; _ssl3_send_client_key_exchange+8DBp ...
		extrn _EVP_PKEY_CTX_ctrl:near
					; CODE XREF: _ssl3_send_client_key_exchange+7B0p
					; _ssl3_send_client_key_exchange+868p ...
		extrn _EVP_PKEY_sign_init:near ; CODE XREF: _ssl3_send_client_verify+72p
		extrn _EVP_PKEY_sign:near ; CODE XREF: _ssl3_send_client_verify+2D3p
		extrn _EVP_PKEY_encrypt_init:near
					; CODE XREF: _ssl3_send_client_key_exchange+6C8p
		extrn _EVP_PKEY_encrypt:near
					; CODE XREF: _ssl3_send_client_key_exchange+7FFp
		extrn _EVP_PKEY_derive_set_peer:near
					; CODE XREF: _ssl3_send_client_key_exchange+70Cp
		extrn _EC_GROUP_free:near ; CODE XREF: _ssl3_get_key_exchange+A5Ap
		extrn _EC_GROUP_get_degree:near	; CODE XREF: _ssl3_get_key_exchange+A81p
					; _ssl3_send_client_key_exchange+4CEp
		extrn _EC_GROUP_new_by_curve_name:near
					; CODE XREF: _ssl3_get_key_exchange+A17p
		extrn _EC_POINT_new:near ; CODE	XREF: _ssl3_get_key_exchange+AADp
		extrn _EC_POINT_free:near ; CODE XREF: _ssl3_get_key_exchange+B9Bp
					; _ssl3_get_key_exchange+FB3p
		extrn _EC_POINT_point2oct:near
					; CODE XREF: _ssl3_send_client_key_exchange+562p
					; _ssl3_send_client_key_exchange+5AAp
		extrn _EC_POINT_oct2point:near ; CODE XREF: _ssl3_get_key_exchange+AF1p
		extrn _EC_KEY_new:near	; CODE XREF: _ssl3_get_key_exchange+98Ep
					; _ssl3_send_client_key_exchange+46Fp
		extrn _EC_KEY_free:near	; CODE XREF: _ssl3_get_key_exchange+1C6p
					; _ssl3_get_key_exchange+FC4p ...
		extrn _EC_KEY_get0_group:near ;	CODE XREF: _ssl3_get_key_exchange+A63p
					; _ssl3_send_client_key_exchange+44Dp
		extrn _EC_KEY_set_group:near ; CODE XREF: _ssl3_get_key_exchange+A3Cp
					; _ssl3_send_client_key_exchange+48Fp
		extrn _EC_KEY_get0_public_key:near
					; CODE XREF: _ssl3_send_client_key_exchange+455p
					; _ssl3_send_client_key_exchange+558p ...
		extrn _EC_KEY_set_public_key:near ; CODE XREF: _ssl3_get_key_exchange+B63p
		extrn _EC_KEY_generate_key:near
					; CODE XREF: _ssl3_send_client_key_exchange+4B0p
		extrn _ECDSA_sign:near	; CODE XREF: _ssl3_send_client_verify+274p
		extrn _ECDH_compute_key:near
					; CODE XREF: _ssl3_send_client_key_exchange+500p
		extrn _X509_NAME_free:near ; CODE XREF:	_ssl3_get_certificate_request+5A0p
					; DATA XREF: _ssl3_get_certificate_request+583o ...
		extrn _d2i_X509_NAME:near ; CODE XREF: _ssl3_get_certificate_request+48Cp
		extrn _X509_free:near	; CODE XREF: _ssl3_get_server_certificate+35Dp
					; _ssl3_get_server_certificate+37Bp ...
		extrn _d2i_X509:near	; CODE XREF: _ssl3_get_server_certificate+145p
		extrn _X509_get_pubkey:near ; CODE XREF: _get_server_static_dh_key+1Cp
					; _ssl3_check_cert_and_algorithm+106p ...
		extrn _X509_certificate_type:near
					; CODE XREF: _ssl3_check_cert_and_algorithm+11Bp
		extrn _X509_NAME_cmp:near ; CODE XREF: _ca_dn_cmp+Cp
		extrn _SRP_Calc_A_param:near ; CODE XREF: _ssl3_connect+333p
		extrn _SRP_generate_client_master_secret:near
					; CODE XREF: _ssl3_send_client_key_exchange+998p
		extrn _SSL_clear:near	; CODE XREF: _ssl3_connect+92p
		extrn _SSL_use_PrivateKey:near
					; CODE XREF: _ssl3_send_client_certificate+FEp
		extrn _SSL_use_certificate:near
					; CODE XREF: _ssl3_send_client_certificate+EDp
		extrn _SSL_SESSION_free:near ; CODE XREF: _ssl3_get_new_session_ticket+14Ap
		extrn _SSL_CTX_remove_session:near
					; CODE XREF: _ssl3_get_new_session_ticket+EAp
		extrn _DTLSv1_client_method:near ; CODE	XREF: _ssl3_client_hello:loc_1105p
					; _ssl3_get_server_hello+16Ap
		extrn _DTLSv1_2_client_method:near ; CODE XREF:	_ssl3_client_hello+F5p
					; _ssl3_get_server_hello+117p
		extrn _SSL_get_ciphers:near ; CODE XREF: _ssl3_client_hello+22Ap
		extrn _SSL_get_client_CA_list:near ; CODE XREF:	_ssl_do_client_cert_cb+21p
		extrn _SSL_state:near	; CODE XREF: _ssl3_connect+72p
					; _ssl3_connect+82p
		extrn _ssl_sess_cert_new:near ;	CODE XREF: _ssl3_get_key_exchange+E5p
					; _ssl3_get_key_exchange:loc_1CAAp ...
		extrn _ssl_sess_cert_free:near
					; CODE XREF: _ssl3_get_server_certificate+252p
		extrn _ssl_get_new_session:near	; CODE XREF: _ssl3_client_hello+5Cp
					; _ssl3_get_server_hello+3C8p
		extrn _ssl_session_dup:near ; CODE XREF: _ssl3_get_new_session_ticket+FAp
		extrn _ssl_cipher_list_to_bytes:near ; CODE XREF: _ssl3_client_hello+234p
		extrn _ssl_update_cache:near ; CODE XREF: _ssl3_connect+700p
		extrn _ssl_cipher_get_cert_index:near
					; CODE XREF: _ssl3_get_server_certificate+301p
		extrn _ssl_get_cipher_by_char:near ; CODE XREF:	_ssl3_get_server_hello+252p
					; _ssl3_get_server_hello+404p
		extrn _ssl_verify_cert_chain:near
					; CODE XREF: _ssl3_get_server_certificate+18Ep
		extrn _ssl_cert_type:near ; CODE XREF: _ssl3_get_server_certificate+2CBp
		extrn _ssl_get_ciphers_by_id:near ; CODE XREF: _ssl3_get_server_hello+48Dp
		extrn _ssl_verify_alarm_type:near
					; CODE XREF: _ssl3_get_server_certificate+1B1p
		extrn _ssl_fill_hello_random:near ; CODE XREF: _ssl3_client_hello+134p
		extrn _ssl3_init_finished_mac:near ; CODE XREF:	_ssl3_connect+67Ap
		extrn _ssl3_get_finished:near ;	CODE XREF: _ssl3_connect+59Ep
		extrn _ssl3_send_change_cipher_spec:near ; CODE	XREF: _ssl3_connect+3EFp
		extrn _ssl3_cleanup_key_block:near ; CODE XREF:	_ssl3_connect+6B5p
		extrn _ssl3_do_write:near ; CODE XREF: _ssl3_send_next_proto+9Bp
		extrn _ssl3_send_alert:near ; CODE XREF: _ssl3_connect+75Fp
					; _ssl3_check_cert_and_algorithm+42Bp ...
		extrn _ssl3_send_finished:near ; CODE XREF: _ssl3_connect+4CCp
		extrn _ssl3_output_cert_chain:near
					; CODE XREF: _ssl3_send_client_certificate+1C6p
		extrn _ssl3_setup_buffers:near ; CODE XREF: _ssl3_connect+656p
		extrn _ssl3_digest_cached_records:near
					; CODE XREF: _ssl3_get_certificate_request+76p
					; _ssl3_get_server_hello+536p ...
		extrn _ssl_init_wbio_buffer:near ; CODE	XREF: _ssl3_connect+669p
		extrn _ssl_free_wbio_buffer:near ; CODE	XREF: _ssl3_connect+6DDp
		extrn _ssl_check_srvr_ecc_cert_and_alg:near
					; CODE XREF: _ssl3_check_cert_and_algorithm+9Ep
		extrn _ssl3_comp_find:near ; CODE XREF:	_ssl3_get_server_hello+62Cp
		extrn _tls1_ec_curve_id2nid:near ; CODE	XREF: _ssl3_get_key_exchange+9EEp
		extrn _tls1_check_curve:near ; CODE XREF: _ssl3_get_key_exchange+9C9p
		extrn _ssl_add_clienthello_tlsext:near ; CODE XREF: _ssl3_client_hello+2FDp
		extrn _ssl_parse_serverhello_tlsext:near
					; CODE XREF: _ssl3_get_server_hello+5ABp
		extrn _ssl_prepare_clienthello_tlsext:near
					; CODE XREF: _ssl3_client_hello+2C9p
		extrn _tls12_get_sigandhash:near ; CODE	XREF: _ssl3_send_client_verify+10Ep
		extrn _tls1_check_chain:near ; CODE XREF: _ssl3_check_client_certificate+44p
		extrn _tls1_save_sigalgs:near
					; CODE XREF: _ssl3_get_certificate_request+371p
		extrn _tls1_process_sigalgs:near
					; CODE XREF: _ssl3_get_certificate_request+382p
		extrn _tls12_check_peer_sigalg:near ; CODE XREF: _ssl3_get_key_exchange+BE0p
		extrn _srp_verify_server_param:near ; CODE XREF: _ssl3_get_key_exchange+50Ap
		extrn _RAND_bytes:near	; CODE XREF: _ssl3_send_client_key_exchange+F7p
					; _ssl3_send_client_key_exchange+6DFp
		extrn _RAND_add:near	; CODE XREF: _ssl3_connect+3Bp
		extrn _ENGINE_load_ssl_client_cert:near
					; CODE XREF: _ssl_do_client_cert_cb+37p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _ssl3_get_key_exchange+FF0p
					; _ssl3_send_client_key_exchange+1DFp ...
		extrn __chkstk:near	; CODE XREF: _ssl3_connect+5p
					; _ssl3_connect+27p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _ssl3_client_hello+1C5p
					; _ssl3_client_hello+212p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ssl3_send_client_key_exchange+379p
					; _ssl3_send_client_key_exchange+544p ...
		extrn ___security_cookie:near ;	DATA XREF: _ssl3_get_key_exchange+Ar
					; _ssl3_send_client_key_exchange+Ar ...
		extrn __fltused:near


		end
