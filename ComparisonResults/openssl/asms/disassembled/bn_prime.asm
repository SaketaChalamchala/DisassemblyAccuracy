;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	B86FE4773752E5804DFB33CEBA4141E0
; Input	CRC32 :	AAA18865

; File Name   :	C:\compspace\Diff\openssl\obj\bn_prime.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_primes		db 2, 0
word_2		dw 3			; DATA XREF: _BN_is_prime_fasttest_ex+16Co
					; _probable_prime:loc_16EAr ...
		dd 70005h, 0D000Bh, 130011h, 1D0017h, 25001Fh, 2B0029h
		dd 35002Fh, 3D003Bh, 470043h, 4F0049h, 590053h,	650061h
		dd 6B0067h, 71006Dh, 83007Fh, 8B0089h, 970095h,	0A3009Dh
		dd 0AD00A7h, 0B500B3h, 0C100BFh, 0C700C5h, 0DF00D3h, 0E500E3h
		dd 0EF00E9h, 0FB00F1h, 1070101h, 10F010Dh, 1190115h, 125011Bh
		dd 1370133h, 13D0139h, 151014Bh, 15D015Bh, 1670161h, 175016Fh
		dd 17F017Bh, 18D0185h, 1990191h, 1A501A3h, 1B101AFh, 1BB01B7h
		dd 1C901C1h, 1CF01CDh, 1DF01D3h, 1EB01E7h, 1F701F3h, 20901FDh
		dd 21D020Bh, 22D0223h, 2390233h, 241023Bh, 251024Bh, 2590257h
		dd 265025Fh, 26B0269h, 2810277h, 2870283h, 293028Dh, 2A10295h
		dd 2AB02A5h, 2BD02B3h, 2CF02C5h, 2DD02D7h, 2E702E3h, 2F502EFh
		dd 30102F9h, 3130305h, 329031Dh, 335032Bh, 33B0337h, 347033Dh
		dd 3590355h, 35F035Bh, 371036Dh, 3770373h, 38F038Bh, 3A10397h
		dd 3AD03A9h, 3B903B3h, 3CB03C7h, 3D703D1h, 3E503DFh, 3F503F1h
		dd 3FD03FBh, 4090407h, 419040Fh, 425041Bh, 42D0427h, 443043Fh
		dd 4490445h, 455044Fh, 463045Dh, 47F0469h, 48B0481h, 49D0493h
		dd 4A904A3h, 4BD04B1h, 4C704C1h, 4CF04CDh, 4E104D5h, 4FD04EBh
		dd 50304FFh, 50B0509h, 5150511h, 51B0517h, 5290527h, 551052Fh
		dd 55D0557h, 5770565h, 58F0581h, 5950593h, 59F0599h, 5AB05A7h
		dd 5B305ADh, 5C905BFh, 5CF05CBh, 5D505D1h, 5E705DBh, 5FB05F3h
		dd 60D0607h, 6170611h, 623061Fh, 62F062Bh, 641063Dh, 6490647h
		dd 653064Dh, 65B0655h, 6790665h, 683067Fh, 69D0685h, 6A306A1h
		dd 6B906ADh, 6C506BBh, 6D306CDh, 6DF06D9h, 6F706F1h, 6FD06FBh
		dd 7130709h, 727071Fh, 7450737h, 74F074Bh, 7550751h, 7610757h
		dd 773076Dh, 78B0779h, 79D078Dh, 7B5079Fh, 7C307BBh, 7CD07C9h
		dd 7D307CFh, 7E107DBh, 7ED07EBh, 80507F7h, 815080Fh, 8230821h
		dd 8290827h, 83F0833h, 8510841h, 8590853h, 85F085Dh, 8710869h
		dd 89B0883h, 8A5089Fh, 8BD08ADh, 8C308BFh, 8DB08CBh, 8E108DDh
		dd 8EF08E9h, 8F908F5h, 9070905h, 923091Dh, 92B0925h, 935092Fh
		dd 9490943h, 94F094Dh, 9590955h, 96B095Fh, 9770971h, 9890985h
		dd 99B098Fh, 9A909A3h, 9C709ADh, 9E309D9h, 9EF09EBh, 9F709F5h
		dd 0A1309FDh, 0A210A1Fh, 0A390A31h, 0A490A3Dh, 0A610A57h
		dd 0A670A63h, 0A750A6Fh, 0A7F0A7Bh, 0A850A81h, 0A930A8Bh
		dd 0A990A97h, 0AA90A9Fh, 0AB50AABh, 0AC10ABDh, 0AD90ACFh
		dd 0AE70AE5h, 0AF10AEDh, 0B030AF3h, 0B150B11h, 0B230B1Bh
		dd 0B2D0B29h, 0B470B3Fh, 0B570B51h, 0B650B5Dh, 0B7B0B6Fh
		dd 0B8D0B89h, 0B990B93h, 0BB70B9Bh, 0BC30BB9h, 0BCF0BCBh
		dd 0BE10BDDh, 0BF50BE9h, 0C070BFBh, 0C110C0Bh, 0C2F0C25h
		dd 0C410C31h, 0C5F0C5Bh, 0C6D0C61h, 0C770C73h, 0C890C83h
		dd 0C950C91h, 0CB30C9Dh, 0CB90CB5h, 0CC70CBBh, 0CE50CE3h
		dd 0CF10CEBh, 0CFB0CF7h, 0D030D01h, 0D130D0Fh, 0D210D1Fh
		dd 0D2D0D2Bh, 0D3F0D3Dh, 0D550D4Fh, 0D790D69h, 0D850D81h
		dd 0D8B0D87h, 0DA30D8Dh, 0DB70DABh, 0DC70DBDh, 0DCD0DC9h
		dd 0DD50DD3h, 0DE50DDBh, 0DF30DE7h, 0DFF0DFDh, 0E170E09h
		dd 0E210E1Dh, 0E2F0E27h, 0E3B0E35h, 0E570E4Bh, 0E5D0E59h
		dd 0E710E6Bh, 0E7D0E75h, 0E8F0E87h, 0E9B0E95h, 0EB70EB1h
		dd 0EC30EB9h, 0ED50ED1h, 0EED0EDBh, 0EF90EEFh, 0F0B0F07h
		dd 0F170F0Dh, 0F290F25h, 0F430F31h, 0F4D0F47h, 0F530F4Fh
		dd 0F5B0F59h, 0F6B0F67h, 0F950F7Fh, 0FA30FA1h, 0FAD0FA7h
		dd 0FB50FB3h, 0FD10FBBh, 0FD90FD3h, 0FEF0FE9h, 0FFD0FFBh
		dd 100F1003h, 1021101Fh, 102B1025h, 103D1039h, 1051103Fh
		dd 10731069h, 107B1079h, 10871085h, 10931091h, 10A3109Dh
		dd 10AF10A5h, 10BB10B1h, 10C910C1h, 10F110E7h, 10FD10F3h
		dd 110B1105h, 11271115h, 1139112Dh, 11471145h, 115F1159h
		dd 11691163h, 1181116Fh, 118D1183h, 11A1119Bh, 11A711A5h
		dd 11C311ABh, 11D111C5h, 11E711D7h, 11F511EFh, 120D11FBh
		dd 121F121Dh, 12291223h, 1231122Bh, 12411237h, 12531247h
		dd 1271125Fh, 12791273h, 128F127Dh, 12AF1297h, 12B512B3h
		dd 12BF12B9h, 12CD12C1h, 12DF12D1h, 130712FDh, 1319130Dh
		dd 132D1327h, 13431337h, 13491345h, 1357134Fh, 1367135Dh
		dd 136D1369h, 1381137Bh, 138B1387h, 13931391h, 139F139Dh
		dd 13BB13AFh, 13D513C3h, 13DF13D9h, 13ED13EBh, 13F913F3h
		dd 141B13FFh, 142F1421h, 143B1433h, 144D1445h, 146B1459h
		dd 1471146Fh, 148D1475h, 149F1499h, 14B114A1h, 14BD14B7h
		dd 14D514CBh, 14E714E3h, 150B1505h, 15171511h, 1525151Fh
		dd 152B1529h, 153D1537h, 15431541h, 155F1549h, 15671565h
		dd 157D156Bh, 1583157Fh, 1591158Fh, 159B1597h, 15BB15B5h
		dd 15C515C1h, 15D715CDh, 160715F7h, 160F1609h, 16151613h
		dd 161B1619h, 16331625h, 163D1639h, 164F1645h, 16691655h
		dd 166F166Dh, 16931675h, 169F1697h, 16AF16A9h, 16BD16B5h
		dd 16CF16C3h, 16D916D3h, 16E116DBh, 16EB16E5h, 16F716EDh
		dd 170916F9h, 1723170Fh, 17331727h, 175D1741h, 17771763h
		dd 178D177Bh, 179B1795h, 17A5179Fh, 17B917B3h, 17C917BFh
		dd 17D517CBh, 17E917E1h, 17F517F3h, 180717FFh, 181D1813h
		dd 18371835h, 1843183Bh, 184D1849h, 18671855h, 18771871h
		dd 187F187Dh, 188F1885h, 189D189Bh, 18AD18A7h, 18B918B3h
		dd 18C718C1h, 18D718D1h, 18DF18D9h, 18EB18E5h, 18FD18F5h
		dd 191B1915h, 19331931h, 19491945h, 195B1951h, 19811979h
		dd 19971993h, 19A31999h, 19AB19A9h, 19B519B1h, 19CF19C7h
		dd 19ED19DBh, 1A0319FDh, 1A111A05h, 1A211A17h, 1A2D1A23h
		dd 1A351A2Fh, 1A4D1A3Fh, 1A691A51h, 1A7B1A6Bh, 1A871A7Dh
		dd 1A931A89h, 1AAB1AA7h, 1AB11AADh, 1AC91AB9h, 1AD51ACFh
		dd 1AE31AD7h, 1AFB1AF3h, 1B051AFFh, 1B251B23h, 1B311B2Fh
		dd 1B3B1B37h, 1B471B41h, 1B551B4Fh, 1B651B59h, 1B731B6Bh
		dd 1B831B7Fh, 1B9D1B91h, 1BBF1BA7h, 1BD11BC5h, 1BD91BD7h
		dd 1BF71BEFh, 1C131C09h, 1C271C19h, 1C2D1C2Bh, 1C3D1C33h
		dd 1C4B1C45h, 1C551C4Fh, 1C811C73h, 1C8D1C8Bh, 1CA31C99h
		dd 1CB51CA5h, 1CC91CB7h, 1CF31CE1h, 1D091CF9h, 1D211D1Bh
		dd 1D351D23h, 1D3F1D39h, 1D4B1D41h, 1D5D1D53h, 1D691D63h
		dd 1D751D71h, 1D7D1D7Bh, 1D891D87h, 1D991D95h, 1DA51D9Fh
		dd 1DB31DA7h, 1DC51DB7h, 1DDB1DD7h, 1DF51DE1h, 1E011DF9h
		dd 1E0B1E07h, 1E171E13h, 1E2B1E25h, 1E3D1E2Fh, 1E4D1E49h
		dd 1E6D1E4Fh, 1E891E71h, 1E951E8Fh, 1EAD1EA1h, 1EC11EBBh
		dd 1EC71EC5h, 1EDD1ECBh, 1EEF1EE3h, 1EFD1EF7h, 1F0D1F01h
		dd 1F1B1F0Fh, 1F491F39h, 1F511F4Bh, 1F751F67h, 1F851F7Bh
		dd 1F971F91h, 1F9D1F99h, 1FAF1FA5h, 1FBB1FB5h, 1FE11FD3h
		dd 1FEB1FE7h
		dd 1FFF1FF3h, 201B2011h, 2027201Dh, 202D2029h, 20472033h
		dd 2051204Dh, 2063205Fh, 20692065h, 207D2077h, 20A12089h
		dd 20B120ABh, 20C320B9h, 20E320C5h, 20ED20E7h, 20FB20EFh
		dd 210D20FFh, 21352113h, 21492141h, 2159214Fh, 215F215Bh
		dd 217D2173h, 21952185h, 21A12197h, 21B321AFh, 21C121B5h
		dd 21D721C7h, 21E521DDh, 21F121E9h, 21FB21F5h, 22092203h
		dd 221B220Fh, 22252221h, 2231222Bh, 224B2239h, 2263224Fh
		dd 22732267h, 227F2275h, 22872285h, 229D2291h, 22A3229Fh
		dd 22BD22B7h, 22E122DBh, 22ED22E5h, 230322F7h, 230B2309h
		dd 23292327h, 2333232Fh, 23452335h, 23532351h, 23632359h
		dd 2383236Bh, 2395238Fh, 23AD23A7h, 23BF23B1h, 23C923C5h
		dd 23DD23D5h, 23EF23E3h, 23F923F3h, 240B2405h, 24192417h
		dd 243D2429h, 24432441h, 245F244Dh, 246B2467h, 247D2479h
		dd 2485247Fh, 24A1249Bh, 24B524AFh, 24C524BBh, 24CD24CBh
		dd 24D924D7h, 24DF24DDh, 24F724F5h, 250124FBh, 25132507h
		dd 25272519h, 253D2531h, 254B2543h, 2573254Fh, 258D2581h
		dd 25972593h, 259F259Dh, 25B125ABh, 25CD25BDh, 25D925CFh
		dd 25F725E1h, 260525F9h, 260F260Bh, 26272615h, 26352629h
		dd 263F263Bh, 2653264Bh, 26652659h, 266F2669h, 2681267Bh
		dd 268F2683h, 269F269Bh, 26B326ADh, 26C926C3h, 26D526CBh
		dd 26EF26DDh, 271726F5h, 27352719h, 274D2737h, 27552753h
		dd 276B275Fh, 2773276Dh, 277F2777h, 279B2795h, 27A7279Dh
		dd 27B327AFh, 27C127B9h, 27D127C5h, 27EF27E3h, 28072803h
		dd 2813280Dh, 281F281Bh, 28312821h, 283F283Dh, 28512849h
		dd 285D285Bh, 28672861h, 28812875h, 289F2897h, 28BD28BBh
		dd 28D528C1h, 28DB28D9h, 28ED28DFh, 290328F7h, 29112905h
		dd 29232921h, 2947293Fh, 2965295Dh, 296F2969h, 29832975h
		dd 298F2987h, 29A1299Bh, 29AB29A7h, 29C329BFh, 29D729D5h
		dd 29E929E3h, 29F329EDh, 2A132A01h, 2A252A1Dh, 2A4F2A2Fh
		dd 2A5F2A55h, 2A6B2A65h, 2A732A6Dh, 2A892A83h, 2A972A8Bh
		dd 2AB92A9Dh, 2AC52ABBh, 2ADD2ACDh, 2AEB2AE3h, 2AFB2AF1h
		dd 2B272B13h, 2B332B31h, 2B3F2B3Dh, 2B4F2B4Bh, 2B692B55h
		dd 2B6F2B6Dh, 2B8D2B7Bh, 2B992B97h, 2BA52BA3h, 2BBD2BA9h
		dd 2BE72BCDh, 2BF32BEBh, 2BFD2BF9h, 2C0F2C09h, 2C232C17h
		dd 2C352C2Fh, 2C412C39h, 2C592C57h, 2C772C69h, 2C872C81h
		dd 2C9F2C93h, 2CB32CADh, 2CCB2CB7h, 2CDB2CCFh, 2CE32CE1h
		dd 2CEF2CE9h, 2D072CFFh, 2D1F2D1Dh, 2D432D3Bh, 2D4D2D49h
		dd 2D652D61h, 2D892D71h, 2DA12D9Dh, 2DB32DA9h, 2DC52DB5h
		dd 2DD32DC7h, 2E012DDFh, 2E072E03h, 2E192E0Dh, 2E252E1Fh
		dd 2E332E2Dh, 2E392E37h, 2E572E3Fh, 2E6F2E5Bh, 2E7F2E79h
		dd 2E932E85h, 2E9D2E97h, 2EA52EA3h, 2EB72EB1h, 2EC32EC1h
		dd 2ED32ECDh, 2EEB2EE7h, 2F092F05h, 2F112F0Bh, 2F292F27h
		dd 2F452F41h, 2F4D2F4Bh, 2F572F51h, 2F752F6Fh, 2F812F7Dh
		dd 2FA52F83h, 2FB32FABh, 2FCF2FC3h, 2FDB2FD1h, 2FE72FDDh
		dd 2FF52FEDh, 30012FF9h, 3023300Dh, 30373029h, 3055303Bh
		dd 305B3059h, 30713067h, 307D3079h, 30913085h, 30A33095h
		dd 30B930A9h, 30C730BFh, 30D130CBh, 30DF30D7h, 30EF30E5h
		dd 30FD30FBh, 31093103h, 31213119h, 312D3127h, 31433139h
		dd 314B3145h, 3161315Dh, 316D3167h, 317F3173h, 31993191h
		dd 31A9319Fh, 31C331B1h, 31D531C7h, 31ED31DBh, 31FF31F7h
		dd 32153209h, 321D3217h, 32353229h, 325D3259h, 326B3263h
		dd 3275326Fh, 327B3277h, 3299328Dh, 32A7329Fh, 32B332ADh
		dd 32C932B7h, 32CF32CBh, 32E932D1h, 32F332EDh, 330732F9h
		dd 332B3325h, 3335332Fh, 33473341h, 335F335Bh, 336B3367h
		dd 33793373h, 3383337Fh, 33A333A1h, 33B933ADh, 33CB33C1h
		dd 33EB33D3h, 33FD33F1h, 340F3401h, 34193413h, 3437341Bh
		dd 34553445h, 34633457h, 346D3469h, 348B3481h, 34973491h
		dd 34A5349Dh, 34BB34AFh, 34D334C9h, 34F134E1h, 350934FFh
		dd 351D3517h, 3533352Dh, 3541353Bh, 35653551h, 3571356Fh
		dd 357B3577h, 3581357Dh, 358F358Dh, 359B3599h, 35B735A1h
		dd 35BF35BDh, 35D535C3h, 35E735DDh, 360535EFh, 36113607h
		dd 36313623h, 36373635h, 364D363Bh, 3653364Fh, 36613659h
		dd 366D366Bh, 368F368Bh, 36AF36ADh, 36BB36B9h, 36D136CDh
		dd 36E936E3h, 370136F7h, 37073703h, 373F371Bh, 37493745h
		dd 375D374Fh, 37753761h, 378D377Fh, 37A937A3h, 37C937ABh
		dd 37DF37D5h, 37F337F1h, 380537F7h, 3821380Bh, 38353833h
		dd 38473841h, 3853384Bh, 385F3857h, 386F3865h, 387D3871h
		dd 3899388Fh, 38B738A7h, 38C938C5h, 38D538CFh, 38DD38D7h
		dd 38E338E1h, 390138FFh, 3923391Dh, 39293925h, 393D392Fh
		dd 394D3941h, 396B395Bh, 397D3979h, 398B3983h, 39953991h
		dd 39A1399Bh, 39AF39A7h, 39BB39B3h, 39CD39BFh, 39E539DDh
		dd 39EF39EBh, 3A0339FBh, 3A153A13h, 3A273A1Fh, 3A313A2Bh
		dd 3A513A4Bh, 3A633A5Bh, 3A6D3A67h, 3A873A79h, 3AA93AA5h
		dd 3ACD3AB7h, 3AE13AD5h, 3AEB3AE5h, 3AFD3AF3h, 3B113B03h
		dd 3B213B1Bh, 3B2D3B23h, 3B453B39h, 3B593B53h, 3B713B5Fh
		dd 3B813B7Bh, 3B9B3B89h, 3BA53B9Fh, 3BAD3BA7h, 3BB93BB7h
		dd 3BCB3BC3h, 3BD73BD1h, 3BE33BE1h, 3BFF3BF5h, 3C0D3C01h
		dd 3C173C11h, 3C293C1Fh, 3C433C35h, 3C533C4Fh, 3C653C5Bh
		dd 3C713C6Bh, 3C893C85h, 3CA73C97h, 3CBF3CB5h, 3CD13CC7h
		dd 3CDF3CDDh, 3CF73CF1h, 3D0D3D03h, 3D1B3D19h, 3D213D1Fh
		dd 3D333D2Dh, 3D3F3D37h, 3D6F3D43h, 3D753D73h, 3D7B3D79h
		dd 3D913D85h, 3D9D3D97h, 3DAF3DABh, 3DBB3DB5h, 3DC93DC1h
		dd 3DF33DCFh, 3E093E05h, 3E113E0Fh, 3E233E1Dh, 3E2F3E29h
		dd 3E413E33h, 3E633E57h, 3E773E65h, 3E873E81h, 3EB93EA1h
		dd 3EBF3EBDh, 3EC53EC3h, 3ED73EC9h, 3EE13EDBh, 3EEF3EE7h
		dd 3F0B3EFFh, 3F373F0Dh, 3F3D3F3Bh, 3F593F41h, 3F653F5Fh
		dd 3F793F67h, 3F8B3F7Dh, 3FAD3F91h, 3FCD3FBFh, 3FDD3FD3h
		dd 3FEB3FE9h, 3FFD3FF1h, 4021401Bh, 402B4025h, 403F4031h
		dd 40454043h, 4061405Dh, 406D4067h, 40914087h, 40A940A3h
		dd 40B740B1h, 40DB40BDh, 40EB40DFh, 40F940F7h, 410B4109h
		dd 41154111h, 41334121h, 413B4135h, 4159413Fh, 416B4165h
		dd 417B4177h, 41AB4193h, 41BD41B7h, 41CB41BFh, 41EF41E7h
		dd 41F941F3h, 42074205h, 421F4219h, 42294223h, 4243422Fh
		dd 42554253h, 4261425Bh, 427D4273h, 42854283h, 42914289h
		dd 429D4297h, 42C542B5h, 42D342CBh, 42E342DDh, 430742F1h
		dd 431F430Fh, 43274325h, 43374333h, 434F4339h, 43694357h
		dd 438D438Bh, 43A54393h, 43AF43A9h, 43BD43B5h, 43CF43C7h
		dd 43E743E1h, 43ED43EBh, 43F943F1h, 440B4409h, 44234417h
		dd 443B4429h, 4445443Fh, 4451444Bh, 44594453h, 446F4465h
		dd 448F4483h, 44A544A1h, 44AD44ABh, 44BF44BDh, 44D744C9h
		dd 44F944DBh, 450544FBh, 45134511h, 4531452Bh, 45494541h
		dd 45554553h, 45774561h, 457F457Dh, 45A3458Fh, 45AF45ADh
		db 0BBh, 45h, 0C7h
byte_FFF	db 45h			; DATA XREF: _BN_is_prime_fasttest_ex+185o
					; _probable_prime_dh:loc_1825o	...
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1000h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BN_GENCB_call
_BN_GENCB_call	proc near		; CODE XREF: _BN_generate_prime_ex+22Fp
					; _BN_is_prime_fasttest_ex+375p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_1040
		mov	ecx, [eax]
		sub	ecx, 1
		jz	short loc_1029
		sub	ecx, 1
		jz	short loc_1017
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1017:				; CODE XREF: _BN_GENCB_call+12j
		push	eax
		push	[esp+4+arg_8]
		mov	eax, [eax+8]
		push	[esp+8+arg_4]
		call	eax
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1029:				; CODE XREF: _BN_GENCB_call+Dj
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1040
		push	dword ptr [eax+4]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		call	ecx
		add	esp, 0Ch

loc_1040:				; CODE XREF: _BN_GENCB_call+6j
					; _BN_GENCB_call+2Ej
		mov	eax, 1
		retn
_BN_GENCB_call	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1048h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BN_generate_prime_ex
_BN_generate_prime_ex proc near

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, 0Ch
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_4]
		mov	[esp+18h+var_4], 0
		mov	[esp+18h+var_C], 0
		cmp	esi, 514h
		jl	short loc_107B
		mov	ebp, 2
		jmp	loc_1118
; ---------------------------------------------------------------------------

loc_107B:				; CODE XREF: _BN_generate_prime_ex+27j
		cmp	esi, 352h
		jl	short loc_108D
		mov	ebp, 3
		jmp	loc_1118
; ---------------------------------------------------------------------------

loc_108D:				; CODE XREF: _BN_generate_prime_ex+39j
		cmp	esi, 28Ah
		jl	short loc_109C
		mov	ebp, 4
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_109C:				; CODE XREF: _BN_generate_prime_ex+4Bj
		cmp	esi, 226h
		jl	short loc_10AB
		mov	ebp, 5
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10AB:				; CODE XREF: _BN_generate_prime_ex+5Aj
		cmp	esi, 1C2h
		jl	short loc_10BA
		mov	ebp, 6
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10BA:				; CODE XREF: _BN_generate_prime_ex+69j
		cmp	esi, 190h
		jl	short loc_10C9
		mov	ebp, 7
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10C9:				; CODE XREF: _BN_generate_prime_ex+78j
		cmp	esi, 15Eh
		jl	short loc_10D8
		mov	ebp, 8
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10D8:				; CODE XREF: _BN_generate_prime_ex+87j
		cmp	esi, 12Ch
		jl	short loc_10E7
		mov	ebp, 9
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10E7:				; CODE XREF: _BN_generate_prime_ex+96j
		cmp	esi, 0FAh ; 'ú'
		jl	short loc_10F6
		mov	ebp, 0Ch
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_10F6:				; CODE XREF: _BN_generate_prime_ex+A5j
		cmp	esi, 0C8h ; 'È'
		jl	short loc_1105
		mov	ebp, 0Fh
		jmp	short loc_1118
; ---------------------------------------------------------------------------

loc_1105:				; CODE XREF: _BN_generate_prime_ex+B4j
		cmp	esi, 96h ; '–'
		mov	ebp, 1Bh
		mov	eax, 12h
		cmovge	ebp, eax

loc_1118:				; CODE XREF: _BN_generate_prime_ex+2Ej
					; _BN_generate_prime_ex+40j ...
		call	_BN_CTX_new
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_12B6
		push	ebx
		call	_BN_CTX_start
		push	ebx
		call	_BN_CTX_get
		add	esp, 8
		mov	[esp+18h+var_8], eax
		test	eax, eax
		jz	$err$88
		mov	edx, [esp+18h+arg_10]
		mov	ecx, [esp+18h+arg_C]
		push	edi
		mov	edi, [esp+1Ch+arg_14]
		jmp	short loc_115C
; ---------------------------------------------------------------------------
		align 8

loc_1158:				; CODE XREF: _BN_generate_prime_ex+205j
					; _BN_generate_prime_ex+246j
		mov	esi, [esp+1Ch+arg_4]

loc_115C:				; CODE XREF: _BN_generate_prime_ex+107j
					; _BN_generate_prime_ex+1C8j
		mov	eax, [esp+1Ch+arg_0]

$loop$89:
		test	ecx, ecx
		jnz	short loc_1170
		push	esi
		push	eax
		call	_probable_prime
		add	esp, 8
		jmp	short loc_118B
; ---------------------------------------------------------------------------

loc_1170:				; CODE XREF: _BN_generate_prime_ex+11Aj
		cmp	[esp+1Ch+arg_8], 0
		push	ebx
		push	edx
		push	ecx
		push	esi
		push	eax
		jz	short loc_1183
		call	_probable_prime_dh_safe
		jmp	short loc_1188
; ---------------------------------------------------------------------------

loc_1183:				; CODE XREF: _BN_generate_prime_ex+132j
		call	_probable_prime_dh

loc_1188:				; CODE XREF: _BN_generate_prime_ex+139j
		add	esp, 14h

loc_118B:				; CODE XREF: _BN_generate_prime_ex+126j
		test	eax, eax
		jz	loc_129B
		test	edi, edi
		jz	short loc_11CD
		mov	eax, [edi]
		sub	eax, 1
		jz	short loc_11B8
		sub	eax, 1
		jz	short loc_11A7
		xor	eax, eax
		jmp	short loc_11D2
; ---------------------------------------------------------------------------

loc_11A7:				; CODE XREF: _BN_generate_prime_ex+159j
		mov	eax, [edi+8]
		push	edi
		push	[esp+20h+var_C]
		push	0
		call	eax
		add	esp, 0Ch
		jmp	short loc_11D2
; ---------------------------------------------------------------------------

loc_11B8:				; CODE XREF: _BN_generate_prime_ex+154j
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_11CD
		push	dword ptr [edi+4]
		push	[esp+20h+var_C]
		push	0
		call	eax
		add	esp, 0Ch

loc_11CD:				; CODE XREF: _BN_generate_prime_ex+14Dj
					; _BN_generate_prime_ex+175j
		mov	eax, 1

loc_11D2:				; CODE XREF: _BN_generate_prime_ex+15Dj
					; _BN_generate_prime_ex+16Ej
		inc	[esp+1Ch+var_C]
		test	eax, eax
		jz	loc_129B
		cmp	[esp+1Ch+arg_8], 0
		mov	eax, [esp+1Ch+arg_0]
		jnz	short loc_1215
		push	edi
		push	0
		push	ebx
		push	ebp
		push	eax
		call	_BN_is_prime_fasttest_ex
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jz	loc_129B
		test	eax, eax
		jnz	loc_1293
		mov	ecx, [esp+1Ch+arg_C]
		mov	edx, [esp+1Ch+arg_10]
		jmp	loc_115C
; ---------------------------------------------------------------------------

loc_1215:				; CODE XREF: _BN_generate_prime_ex+19Fj
		push	eax
		push	[esp+20h+var_8]
		call	_BN_rshift1
		add	esp, 8
		test	eax, eax
		jz	short loc_129B
		xor	esi, esi

loc_1228:				; CODE XREF: _BN_generate_prime_ex+23Cj
		cmp	esi, ebp
		jge	short loc_1293
		push	edi
		push	0
		push	ebx
		push	1
		push	[esp+2Ch+arg_0]
		call	_BN_is_prime_fasttest_ex
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jz	short loc_129B
		mov	ecx, [esp+1Ch+arg_C]
		mov	edx, [esp+1Ch+arg_10]
		test	eax, eax
		jz	loc_1158
		push	edi
		push	0
		push	ebx
		push	1
		push	[esp+2Ch+var_8]
		call	_BN_is_prime_fasttest_ex
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jz	short loc_129B
		test	eax, eax
		jz	short loc_1286
		mov	eax, [esp+1Ch+var_C]
		dec	eax
		push	eax
		push	2
		push	edi
		call	_BN_GENCB_call
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_129B
		inc	esi
		jmp	short loc_1228
; ---------------------------------------------------------------------------

loc_1286:				; CODE XREF: _BN_generate_prime_ex+224j
		mov	ecx, [esp+1Ch+arg_C]
		mov	edx, [esp+1Ch+arg_10]
		jmp	loc_1158
; ---------------------------------------------------------------------------

loc_1293:				; CODE XREF: _BN_generate_prime_ex+1BAj
					; _BN_generate_prime_ex+1E2j
		mov	[esp+1Ch+var_4], 1

loc_129B:				; CODE XREF: _BN_generate_prime_ex+145j
					; _BN_generate_prime_ex+190j ...
		pop	edi

$err$88:				; CODE XREF: _BN_generate_prime_ex+F4j
		push	ebx
		call	_BN_CTX_end
		push	ebx
		call	_BN_CTX_free
		mov	eax, [esp+20h+var_4]
		add	esp, 8
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_12B6:				; CODE XREF: _BN_generate_prime_ex+D9j
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
_BN_generate_prime_ex endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 12C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BN_is_prime_ex
_BN_is_prime_ex	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	[esp+arg_C]
		push	0
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_BN_is_prime_fasttest_ex
		add	esp, 14h
		retn
_BN_is_prime_ex	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 12DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _BN_is_prime_fasttest_ex
_BN_is_prime_fasttest_ex proc near	; CODE XREF: _BN_generate_prime_ex+1A7p
					; _BN_generate_prime_ex+1EEp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 18h
		call	__chkstk
		push	esi
		mov	[esp+1Ch+var_10], 0FFFFFFFFh
		call	_BN_value_one
		mov	esi, [esp+1Ch+arg_0]
		push	eax
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jg	short loc_130D
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_130D:				; CODE XREF: _BN_is_prime_fasttest_ex+28j
		push	ebx
		mov	ebx, [esp+20h+arg_4]
		test	ebx, ebx
		jnz	loc_142A
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 514h
		jl	short loc_1334
		mov	ebx, 2
		jmp	loc_142A
; ---------------------------------------------------------------------------

loc_1334:				; CODE XREF: _BN_is_prime_fasttest_ex+4Cj
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 352h
		jl	short loc_134E
		mov	ebx, 3
		jmp	loc_142A
; ---------------------------------------------------------------------------

loc_134E:				; CODE XREF: _BN_is_prime_fasttest_ex+66j
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 28Ah
		jl	short loc_1368
		mov	ebx, 4
		jmp	loc_142A
; ---------------------------------------------------------------------------

loc_1368:				; CODE XREF: _BN_is_prime_fasttest_ex+80j
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 226h
		jl	short loc_1382
		mov	ebx, 5
		jmp	loc_142A
; ---------------------------------------------------------------------------

loc_1382:				; CODE XREF: _BN_is_prime_fasttest_ex+9Aj
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 1C2h
		jl	short loc_139C
		mov	ebx, 6
		jmp	loc_142A
; ---------------------------------------------------------------------------

loc_139C:				; CODE XREF: _BN_is_prime_fasttest_ex+B4j
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 190h
		jl	short loc_13B3
		mov	ebx, 7
		jmp	short loc_142A
; ---------------------------------------------------------------------------

loc_13B3:				; CODE XREF: _BN_is_prime_fasttest_ex+CEj
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 15Eh
		jl	short loc_13CA
		mov	ebx, 8
		jmp	short loc_142A
; ---------------------------------------------------------------------------

loc_13CA:				; CODE XREF: _BN_is_prime_fasttest_ex+E5j
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 12Ch
		jl	short loc_13E1
		mov	ebx, 9
		jmp	short loc_142A
; ---------------------------------------------------------------------------

loc_13E1:				; CODE XREF: _BN_is_prime_fasttest_ex+FCj
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 0FAh ; 'ú'
		jl	short loc_13F8
		mov	ebx, 0Ch
		jmp	short loc_142A
; ---------------------------------------------------------------------------

loc_13F8:				; CODE XREF: _BN_is_prime_fasttest_ex+113j
		push	esi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, 0C8h ; 'È'
		jl	short loc_140F
		mov	ebx, 0Fh
		jmp	short loc_142A
; ---------------------------------------------------------------------------

loc_140F:				; CODE XREF: _BN_is_prime_fasttest_ex+12Aj
		push	esi
		call	_BN_num_bits
		add	esp, 4
		mov	ebx, 1Bh
		cmp	eax, 96h ; '–'
		mov	ecx, 12h
		cmovge	ebx, ecx

loc_142A:				; CODE XREF: _BN_is_prime_fasttest_ex+38j
					; _BN_is_prime_fasttest_ex+53j	...
		mov	ecx, [esi+4]
		test	ecx, ecx
		jle	loc_1684
		mov	eax, [esi]
		test	byte ptr [eax],	1
		jz	loc_1684
		cmp	[esp+20h+arg_C], 0
		push	edi
		jz	short loc_1496
		mov	edi, offset word_2

loc_144D:				; CODE XREF: _BN_is_prime_fasttest_ex+18Bj
		movzx	eax, word ptr [edi]
		push	eax
		push	esi
		call	_BN_mod_word
		add	esp, 8
		test	eax, eax
		jz	short loc_14B7
		add	edi, 2
		cmp	edi, (offset byte_FFF+1)
		jl	short loc_144D
		mov	ecx, [esp+24h+arg_10]
		test	ecx, ecx
		jz	short loc_1496
		mov	eax, [ecx]
		sub	eax, 1
		jz	short loc_14A2
		sub	eax, 1
		jnz	loc_1586
		mov	eax, [ecx+8]
		push	ecx
		push	0FFFFFFFFh
		push	1
		call	eax
		add	esp, 0Ch
		test	eax, eax
		jz	loc_1586

loc_1496:				; CODE XREF: _BN_is_prime_fasttest_ex+16Aj
					; _BN_is_prime_fasttest_ex+193j ...
		mov	eax, [esp+24h+arg_8]
		test	eax, eax
		jz	short loc_14C0
		mov	edi, eax
		jmp	short loc_14CF
; ---------------------------------------------------------------------------

loc_14A2:				; CODE XREF: _BN_is_prime_fasttest_ex+19Aj
		mov	eax, [ecx+8]
		test	eax, eax
		jz	short loc_1496
		push	dword ptr [ecx+4]
		push	0FFFFFFFFh
		push	1
		call	eax
		add	esp, 0Ch
		jmp	short loc_1496
; ---------------------------------------------------------------------------

loc_14B7:				; CODE XREF: _BN_is_prime_fasttest_ex+180j
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_14C0:				; CODE XREF: _BN_is_prime_fasttest_ex+1C0j
		call	_BN_CTX_new
		mov	edi, eax
		test	edi, edi
		jz	loc_1586

loc_14CF:				; CODE XREF: _BN_is_prime_fasttest_ex+1C4j
		push	ebp
		push	edi
		call	_BN_CTX_start
		add	esp, 4
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_1507
		push	edi
		call	_BN_CTX_get
		mov	ebp, eax
		add	esp, 4
		mov	[esp+28h+var_14], ebp
		test	ebp, ebp
		jz	short loc_1559
		push	esi
		push	ebp
		call	_BN_copy
		add	esp, 8
		mov	dword ptr [ebp+0Ch], 0
		mov	esi, ebp
		jmp	short loc_150B
; ---------------------------------------------------------------------------

loc_1507:				; CODE XREF: _BN_is_prime_fasttest_ex+201j
		mov	[esp+28h+var_14], esi

loc_150B:				; CODE XREF: _BN_is_prime_fasttest_ex+229j
		push	edi
		call	_BN_CTX_get
		push	edi
		mov	ebp, eax
		call	_BN_CTX_get
		push	edi
		mov	[esp+34h+var_4], eax
		call	_BN_CTX_get
		add	esp, 0Ch
		mov	[esp+28h+var_C], eax
		test	eax, eax
		jz	short loc_1559
		push	esi
		push	ebp
		call	_BN_copy
		add	esp, 8
		test	eax, eax
		jz	short loc_1559
		push	1
		push	ebp
		call	_BN_sub_word
		add	esp, 8
		test	eax, eax
		jz	short loc_1559
		cmp	dword ptr [ebp+4], 0
		jnz	short loc_1591
		mov	[esp+28h+var_10], 0

loc_1559:				; CODE XREF: _BN_is_prime_fasttest_ex+214j
					; _BN_is_prime_fasttest_ex+250j ...
		xor	esi, esi

$err$104:				; CODE XREF: _BN_is_prime_fasttest_ex+302j
					; _BN_is_prime_fasttest_ex+318j ...
		pop	ebp
		test	edi, edi
		jz	short loc_1579
		push	edi
		call	_BN_CTX_end
		add	esp, 4
		cmp	[esp+24h+arg_8], 0
		jnz	short loc_1579
		push	edi
		call	_BN_CTX_free
		add	esp, 4

loc_1579:				; CODE XREF: _BN_is_prime_fasttest_ex+282j
					; _BN_is_prime_fasttest_ex+292j
		test	esi, esi
		jz	short loc_1586
		push	esi
		call	_BN_MONT_CTX_free
		add	esp, 4

loc_1586:				; CODE XREF: _BN_is_prime_fasttest_ex+19Fj
					; _BN_is_prime_fasttest_ex+1B4j ...
		mov	eax, [esp+24h+var_10]
		pop	edi
		pop	ebx
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1591:				; CODE XREF: _BN_is_prime_fasttest_ex+273j
		mov	esi, 1
		push	esi
		push	ebp
		mov	[esp+30h+var_8], esi
		call	_BN_is_bit_set
		add	esp, 8
		test	eax, eax
		jnz	short loc_15BF
		nop	dword ptr [eax+00h]

loc_15AC:				; CODE XREF: _BN_is_prime_fasttest_ex+2DDj
		inc	esi
		push	esi
		push	ebp
		call	_BN_is_bit_set
		add	esp, 8
		test	eax, eax
		jz	short loc_15AC
		mov	[esp+28h+var_8], esi

loc_15BF:				; CODE XREF: _BN_is_prime_fasttest_ex+2CAj
		push	esi
		push	ebp
		push	[esp+30h+var_4]
		call	_BN_rshift
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1559
		call	_BN_MONT_CTX_new
		mov	esi, eax
		mov	[esp+28h+var_18], esi
		test	esi, esi
		jz	$err$104
		push	edi
		push	[esp+2Ch+var_14]
		push	esi
		call	_BN_MONT_CTX_set
		add	esp, 0Ch
		test	eax, eax
		jz	$err$104
		xor	esi, esi
		test	ebx, ebx
		jle	short loc_1662

loc_1600:				; CODE XREF: _BN_is_prime_fasttest_ex+384j
		push	ebp
		push	[esp+2Ch+var_C]
		call	_BN_pseudo_rand_range
		add	esp, 8
		test	eax, eax
		jz	short loc_167B
		push	1
		push	[esp+2Ch+var_C]
		call	_BN_add_word
		add	esp, 8
		test	eax, eax
		jz	short loc_167B
		push	[esp+28h+var_18]
		push	edi
		push	[esp+30h+var_8]
		push	[esp+34h+var_4]
		push	ebp
		push	[esp+3Ch+var_14]
		push	[esp+40h+var_C]
		call	_witness
		add	esp, 1Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_167B
		test	eax, eax
		jnz	short loc_1673
		push	esi
		push	1
		push	[esp+30h+arg_10]
		call	_BN_GENCB_call
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_167B
		inc	esi
		cmp	esi, ebx
		jl	short loc_1600

loc_1662:				; CODE XREF: _BN_is_prime_fasttest_ex+322j
		mov	esi, [esp+28h+var_18]
		mov	[esp+28h+var_10], 1
		jmp	$err$104
; ---------------------------------------------------------------------------

loc_1673:				; CODE XREF: _BN_is_prime_fasttest_ex+36Cj
		mov	[esp+28h+var_10], 0

loc_167B:				; CODE XREF: _BN_is_prime_fasttest_ex+333j
					; _BN_is_prime_fasttest_ex+345j ...
		mov	esi, [esp+28h+var_18]
		jmp	$err$104
; ---------------------------------------------------------------------------

loc_1684:				; CODE XREF: _BN_is_prime_fasttest_ex+153j
					; _BN_is_prime_fasttest_ex+15Ej
		cmp	ecx, 1
		jnz	short loc_169E
		mov	eax, [esi]
		cmp	dword ptr [eax], 2
		jnz	short loc_169E
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_169E
		pop	ebx
		mov	eax, ecx
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_169E:				; CODE XREF: _BN_is_prime_fasttest_ex+3ABj
					; _BN_is_prime_fasttest_ex+3B2j ...
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
_BN_is_prime_fasttest_ex endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 16A8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_probable_prime	proc near		; CODE XREF: _BN_generate_prime_ex+11Ep

var_1002	= word ptr -1002h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 1004h
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+1004h+var_4], eax
		push	ebx
		mov	ebx, [esp+1008h+arg_0]
		push	ebp
		mov	ebp, [esp+100Ch+arg_4]
		push	esi
		push	edi
		push	1
		push	1
		push	ebp
		push	ebx
		call	_BN_rand
		add	esp, 10h
		test	eax, eax
		jz	short loc_1750
		nop	dword ptr [eax+00h]

$again$32:				; CODE XREF: _probable_prime+A6j
		xor	esi, esi

loc_16EA:				; CODE XREF: _probable_prime+61j
		movzx	eax, word_2[esi]
		push	eax
		push	ebx
		call	_BN_mod_word
		mov	[esp+esi+101Ch+var_1002], ax
		add	esp, 8
		add	esi, 2
		cmp	esi, 0FFEh
		jl	short loc_16EA
		xor	edi, edi

$loop$33:				; CODE XREF: _probable_prime+94j
		xor	ecx, ecx

loc_170F:				; CODE XREF: _probable_prime+89j
		cmp	ecx, 0FFEh
		jge	short loc_176B
		movzx	eax, [esp+ecx+1014h+var_1002]
		xor	edx, edx
		movzx	esi, word_2[ecx]
		add	eax, edi
		div	esi
		cmp	edx, 1
		jbe	short loc_1733
		add	ecx, 2
		jmp	short loc_170F
; ---------------------------------------------------------------------------

loc_1733:				; CODE XREF: _probable_prime+84j
		add	edi, 2
		cmp	edi, 0FFFFBA38h
		jbe	short $loop$33
		push	1
		push	1
		push	ebp
		push	ebx
		call	_BN_rand
		add	esp, 10h
		test	eax, eax
		jnz	short $again$32

loc_1750:				; CODE XREF: _probable_prime+3Aj
		xor	eax, eax

loc_1752:				; CODE XREF: _probable_prime+D3j
		mov	ecx, [esp+1014h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1004h
		retn
; ---------------------------------------------------------------------------

loc_176B:				; CODE XREF: _probable_prime+6Dj
		push	edi
		push	ebx
		call	_BN_add_word
		add	esp, 8
		neg	eax
		sbb	eax, eax
		neg	eax
		jmp	short loc_1752
_probable_prime	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1780h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_probable_prime_dh proc	near		; CODE XREF: _BN_generate_prime_ex:loc_1183p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 4
		call	__chkstk
		push	ebp
		mov	ebp, [esp+8+arg_10]
		push	esi
		push	ebp
		mov	[esp+10h+var_4], 0
		call	_BN_CTX_start
		push	ebp
		call	_BN_CTX_get
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	$err$46
		push	edi
		mov	edi, [esp+10h+arg_0]
		push	1
		push	0
		push	[esp+18h+arg_4]
		push	edi
		call	_BN_rand
		add	esp, 10h
		test	eax, eax
		jz	loc_186F
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		push	ebx
		push	edi
		push	esi
		push	0
		call	_BN_div
		add	esp, 14h
		test	eax, eax
		jz	loc_186E
		push	esi
		push	edi
		push	edi
		call	_BN_sub
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_186E
		mov	eax, [esp+14h+arg_C]
		test	eax, eax
		jnz	short loc_180E
		push	1
		push	edi
		call	_BN_add_word
		add	esp, 8
		jmp	short loc_1819
; ---------------------------------------------------------------------------

loc_180E:				; CODE XREF: _probable_prime_dh+7Fj
		push	eax
		push	edi
		push	edi
		call	_BN_add
		add	esp, 0Ch

loc_1819:				; CODE XREF: _probable_prime_dh+8Cj
		test	eax, eax
		jz	short loc_186E
		nop	dword ptr [eax]

$loop$47:				; CODE XREF: _probable_prime_dh+D1j
		mov	esi, offset word_2

loc_1825:				; CODE XREF: _probable_prime_dh+C2j
		cmp	esi, (offset byte_FFF+1)
		jge	short loc_1866
		movzx	eax, word ptr [esi]
		push	eax
		push	edi
		call	_BN_mod_word
		add	esp, 8
		cmp	eax, 1
		jbe	short loc_1844
		add	esi, 2
		jmp	short loc_1825
; ---------------------------------------------------------------------------

loc_1844:				; CODE XREF: _probable_prime_dh+BDj
		push	ebx
		push	edi
		push	edi
		call	_BN_add
		add	esp, 0Ch
		test	eax, eax
		jnz	short $loop$47
		pop	ebx
		pop	edi
		push	ebp
		call	_BN_CTX_end
		mov	eax, [esp+10h+var_4]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1866:				; CODE XREF: _probable_prime_dh+ABj
		mov	[esp+14h+var_4], 1

loc_186E:				; CODE XREF: _probable_prime_dh+64j
					; _probable_prime_dh+77j ...
		pop	ebx

loc_186F:				; CODE XREF: _probable_prime_dh+49j
		pop	edi

$err$46:				; CODE XREF: _probable_prime_dh+2Bj
		push	ebp
		call	_BN_CTX_end
		mov	eax, [esp+10h+var_4]
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ecx
		retn
_probable_prime_dh endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1884h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_probable_prime_dh_safe	proc near	; CODE XREF: _BN_generate_prime_ex+134p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 4
		call	__chkstk
		push	ebp
		mov	ebp, [esp+8+arg_10]
		push	esi
		push	edi
		push	ebp
		mov	[esp+14h+var_4], 0
		call	_BN_CTX_start
		push	ebp
		call	_BN_CTX_get
		push	ebp
		mov	esi, eax
		call	_BN_CTX_get
		push	ebp
		mov	edi, eax
		call	_BN_CTX_get
		mov	ebp, eax
		add	esp, 10h
		test	ebp, ebp
		jz	$err$35
		push	[esp+10h+arg_8]
		push	ebp
		call	_BN_rshift1
		add	esp, 8
		test	eax, eax
		jz	$err$35
		mov	eax, [esp+10h+arg_4]
		push	1
		push	0
		dec	eax
		push	eax
		push	edi
		call	_BN_rand
		add	esp, 10h
		test	eax, eax
		jz	$err$35
		push	[esp+10h+arg_10]
		push	ebp
		push	edi
		push	esi
		push	0
		call	_BN_div
		add	esp, 14h
		test	eax, eax
		jz	$err$35
		push	esi
		push	edi
		push	edi
		call	_BN_sub
		add	esp, 0Ch
		test	eax, eax
		jz	$err$35
		mov	eax, [esp+10h+arg_C]
		test	eax, eax
		jnz	short loc_1937
		push	1
		push	edi
		call	_BN_add_word
		add	esp, 8
		jmp	short loc_1954
; ---------------------------------------------------------------------------

loc_1937:				; CODE XREF: _probable_prime_dh_safe+A4j
		push	eax
		push	esi
		call	_BN_rshift1
		add	esp, 8
		test	eax, eax
		jz	$err$35
		push	esi
		push	edi
		push	edi
		call	_BN_add
		add	esp, 0Ch

loc_1954:				; CODE XREF: _probable_prime_dh_safe+B1j
		test	eax, eax
		jz	$err$35
		push	ebx
		mov	ebx, [esp+14h+arg_0]
		push	edi
		push	ebx
		call	_BN_lshift1
		add	esp, 8
		test	eax, eax
		jz	loc_19F7
		push	1
		push	ebx
		call	_BN_add_word
		add	esp, 8
		test	eax, eax
		jz	short loc_19F7
		xchg	ax, ax

$loop$36:				; CODE XREF: _probable_prime_dh_safe+153j
		mov	esi, offset word_2

loc_1989:				; CODE XREF: _probable_prime_dh_safe+132j
		cmp	esi, (offset byte_FFF+1)
		jge	short loc_19EF
		movzx	eax, word ptr [esi]
		push	eax
		push	ebx
		call	_BN_mod_word
		add	esp, 8
		test	eax, eax
		jz	short loc_19B8
		movzx	eax, word ptr [esi]
		push	eax
		push	edi
		call	_BN_mod_word
		add	esp, 8
		test	eax, eax
		jz	short loc_19B8
		add	esi, 2
		jmp	short loc_1989
; ---------------------------------------------------------------------------

loc_19B8:				; CODE XREF: _probable_prime_dh_safe+11Cj
					; _probable_prime_dh_safe+12Dj
		push	[esp+14h+arg_8]
		push	ebx
		push	ebx
		call	_BN_add
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_19F7
		push	ebp
		push	edi
		push	edi
		call	_BN_add
		add	esp, 0Ch
		test	eax, eax
		jnz	short $loop$36
		pop	ebx
		push	[esp+10h+arg_10]
		call	_BN_CTX_end
		mov	eax, [esp+14h+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_19EF:				; CODE XREF: _probable_prime_dh_safe+10Bj
		mov	[esp+14h+var_4], 1

loc_19F7:				; CODE XREF: _probable_prime_dh_safe+E9j
					; _probable_prime_dh_safe+FCj ...
		pop	ebx

$err$35:				; CODE XREF: _probable_prime_dh_safe+3Cj
					; _probable_prime_dh_safe+51j ...
		push	[esp+10h+arg_10]
		call	_BN_CTX_end
		mov	eax, [esp+14h+var_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
_probable_prime_dh_safe	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_witness	proc near		; CODE XREF: _BN_is_prime_fasttest_ex+35Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ebp
		mov	ebp, [esp+4+arg_14]
		push	esi
		push	[esp+8+arg_18]
		mov	esi, [esp+0Ch+arg_0]
		push	ebp
		push	[esp+10h+arg_4]
		push	[esp+14h+arg_C]
		push	esi
		push	esi
		call	_BN_mod_exp_mont
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1A3B
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1A3B:				; CODE XREF: _witness+23j
		cmp	dword ptr [esi+4], 1
		jnz	short loc_1A53
		mov	eax, [esi]
		cmp	dword ptr [eax], 1
		jnz	short loc_1A53
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_1A53
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1A53:				; CODE XREF: _witness+2Fj _witness+36j ...
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebx
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_1A6A
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1A6A:				; CODE XREF: _witness+54j
		push	edi
		mov	edi, [esp+10h+arg_10]
		sub	edi, 1
		jz	short loc_1AAE

loc_1A74:				; CODE XREF: _witness+9Cj
		push	ebp
		push	[esp+14h+arg_4]
		push	esi
		push	esi
		push	esi
		call	_BN_mod_mul
		add	esp, 14h
		test	eax, eax
		jz	short loc_1ABF
		cmp	dword ptr [esi+4], 1
		jnz	short loc_1A9B
		mov	eax, [esi]
		cmp	dword ptr [eax], 1
		jnz	short loc_1A9B
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_1AAE

loc_1A9B:				; CODE XREF: _witness+7Cj _witness+83j
		push	ebx
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_1AB8
		sub	edi, 1
		jnz	short loc_1A74

loc_1AAE:				; CODE XREF: _witness+62j _witness+89j
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, 1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1AB8:				; CODE XREF: _witness+97j
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1ABF:				; CODE XREF: _witness+76j
		pop	edi
		pop	ebx
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
_witness	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _BN_value_one:near ; CODE	XREF: _BN_is_prime_fasttest_ex+13p
		extrn _BN_CTX_new:near	; CODE XREF: _BN_generate_prime_ex:loc_1118p
					; _BN_is_prime_fasttest_ex:loc_14C0p
		extrn _BN_CTX_free:near	; CODE XREF: _BN_generate_prime_ex+25Bp
					; _BN_is_prime_fasttest_ex+295p
		extrn _BN_CTX_start:near ; CODE	XREF: _BN_generate_prime_ex+E0p
					; _BN_is_prime_fasttest_ex+1F5p ...
		extrn _BN_CTX_get:near	; CODE XREF: _BN_generate_prime_ex+E6p
					; _BN_is_prime_fasttest_ex+204p ...
		extrn _BN_CTX_end:near	; CODE XREF: _BN_generate_prime_ex+255p
					; _BN_is_prime_fasttest_ex+285p ...
		extrn _BN_rand:near	; CODE XREF: _probable_prime+30p
					; _probable_prime+9Cp ...
		extrn _BN_pseudo_rand_range:near ; CODE	XREF: _BN_is_prime_fasttest_ex+329p
		extrn _BN_num_bits:near	; CODE XREF: _BN_is_prime_fasttest_ex+3Fp
					; _BN_is_prime_fasttest_ex+59p	...
		extrn _BN_copy:near	; CODE XREF: _BN_is_prime_fasttest_ex+218p
					; _BN_is_prime_fasttest_ex+254p
		extrn _BN_sub:near	; CODE XREF: _probable_prime_dh+6Dp
					; _probable_prime_dh_safe+8Ep
		extrn _BN_add:near	; CODE XREF: _probable_prime_dh+91p
					; _probable_prime_dh+C7p ...
		extrn _BN_div:near	; CODE XREF: _probable_prime_dh+5Ap
					; _probable_prime_dh_safe+7Bp
		extrn _BN_mod_mul:near	; CODE XREF: _witness+6Cp
		extrn _BN_mod_word:near	; CODE XREF: _BN_is_prime_fasttest_ex+176p
					; _probable_prime+4Bp ...
		extrn _BN_add_word:near	; CODE XREF: _BN_is_prime_fasttest_ex+33Bp
					; _probable_prime+C5p ...
		extrn _BN_sub_word:near	; CODE XREF: _BN_is_prime_fasttest_ex+263p
		extrn _BN_cmp:near	; CODE XREF: _BN_is_prime_fasttest_ex+1Ep
					; _witness+4Ap	...
		extrn _BN_is_bit_set:near ; CODE XREF: _BN_is_prime_fasttest_ex+2C0p
					; _BN_is_prime_fasttest_ex+2D3p
		extrn _BN_lshift1:near	; CODE XREF: _probable_prime_dh_safe+DFp
		extrn _BN_mod_exp_mont:near ; CODE XREF: _witness+19p
		extrn _BN_rshift:near	; CODE XREF: _BN_is_prime_fasttest_ex+2E9p
		extrn _BN_rshift1:near	; CODE XREF: _BN_generate_prime_ex+1D2p
					; _probable_prime_dh_safe+47p ...
		extrn _BN_MONT_CTX_new:near ; CODE XREF: _BN_is_prime_fasttest_ex+2F5p
		extrn _BN_MONT_CTX_free:near ; CODE XREF: _BN_is_prime_fasttest_ex+2A2p
		extrn _BN_MONT_CTX_set:near ; CODE XREF: _BN_is_prime_fasttest_ex+30Ep
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _probable_prime+B7p
		extrn __chkstk:near	; CODE XREF: _BN_generate_prime_ex+5p
					; _BN_is_prime_fasttest_ex+5p ...
		extrn ___security_cookie:near ;	DATA XREF: _probable_prime+Ar


		end
