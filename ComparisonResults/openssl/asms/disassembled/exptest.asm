;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	69CD24B13463020E7F7820D2A318B936
; Input	CRC32 :	1B37F996

; File Name   :	C:\compspace\Diff\openssl\obj\exptest.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_rnd_seed	db 'string to make the random number generator think it has entropy',0
					; DATA XREF: _main+Do
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 40h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; _fprintf+Fp ...
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 48h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_a_is_zero_mod_one proc	near		; CODE XREF: _test_exp_mod_zero+B5p
					; _test_exp_mod_zero+F5p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_4]
		cmp	dword ptr [edi+4], 0
		jz	loc_119
		push	esi
		push	[esp+8+arg_0]
		mov	esi, dword ptr ds:__imp____acrt_iob_func
		push	offset ??_C@_0M@EIIACMOD@?$CFs?5failed?3?6?$AA@	; "%s failed:\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 0Ch
		push	offset ??_C@_0CA@KMKOFGEM@a?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@	; "a **	0 mod 1	= r (should be 0)\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	offset ??_C@_04IEIKKLEA@a?5?$DN?5?$AA@ ; "a = "
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	[esp+8+arg_8]
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BN_print_fp
		add	esp, 8
		push	offset ??_C@_05HFLBDDMK@?6r?5?$DN?5?$AA@ ; "\nr	= "
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	edi
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BN_print_fp
		add	esp, 8
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		xor	eax, eax
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_119:				; CODE XREF: _a_is_zero_mod_one+9j
		mov	eax, 1
		pop	edi
		retn
_a_is_zero_mod_one endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 120h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _a_is_zero_mod_one+27p
					; _a_is_zero_mod_one+3Cp ...

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 144h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl main(int argc, const char	**argv,	const char **envp)
		public _main
_main		proc near

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
argc		= dword	ptr  4
argv		= dword	ptr  8
envp		= dword	ptr  0Ch

		mov	eax, 1Ch
		call	__chkstk
		push	edi
		push	40h ; '@'
		push	offset _rnd_seed ; "string to make the random number genera"...
		xor	edi, edi
		call	_RAND_seed
		add	esp, 8
		call	_ERR_load_BN_strings
		call	_BN_CTX_new
		mov	[esp+20h+var_14], eax
		test	eax, eax
		jnz	short $LN37
		push	1		; Code
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN37:					; CODE XREF: _main+2Cj
		push	ebx
		push	ebp
		push	esi
		call	_BN_new
		mov	[esp+20h], eax
		call	_BN_new
		mov	[esp+20h+argc],	eax
		call	_BN_new
		mov	[esp+20h+var_4], eax
		call	_BN_new
		mov	esi, eax
		call	_BN_new
		mov	ebx, eax
		call	_BN_new
		mov	ebp, eax
		call	_BN_new
		mov	[esp+20h+var_C], eax
		cmp	[esp+20h], edi
		jz	$err$42
		cmp	[esp+20h+var_4], edi
		jz	$err$42
		test	ebx, ebx
		jz	$err$42
		test	ebp, ebp
		jz	$err$42
		call	_BIO_s_file
		push	eax
		call	_BIO_new
		add	esp, 4
		mov	edi, eax
		push	1		; Code
		test	edi, edi
		jnz	short $LN38
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN38:					; CODE XREF: _main+AAj
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		push	0
		push	6Ah ; 'j'
		push	edi
		call	_BIO_ctrl
		add	esp, 14h
		mov	[esp+20h+argv],	0
		xchg	ax, ax

loc_214:				; CODE XREF: _main+276j
		lea	eax, [esp+20h+var_10+3]
		push	1
		push	eax
		call	_RAND_bytes
		movzx	eax, byte ptr [esp+28h+var_10+3]
		and	eax, 8000003Fh
		jns	short loc_231
		dec	eax
		or	eax, 0FFFFFFC0h
		inc	eax

loc_231:				; CODE XREF: _main+E6j
		sub	al, 20h	; ' '
		mov	byte ptr [esp+28h+var_10+3], al
		push	0
		movzx	eax, al
		push	0
		sub	eax, 0FFFFFF80h
		push	eax
		push	ebx
		call	_BN_rand
		lea	eax, [esp+38h+var_10+3]
		push	1
		push	eax
		call	_RAND_bytes
		movzx	eax, byte ptr [esp+40h+var_10+3]
		and	eax, 8000003Fh
		jns	short loc_265
		dec	eax
		or	eax, 0FFFFFFC0h
		inc	eax

loc_265:				; CODE XREF: _main+11Aj
		sub	al, 20h	; ' '
		mov	byte ptr [esp+40h+var_10+3], al
		push	0
		movzx	eax, al
		push	0
		sub	eax, 0FFFFFF80h
		push	eax
		push	ebp
		call	_BN_rand
		lea	eax, [esp+50h+var_10+3]
		push	1
		push	eax
		call	_RAND_bytes
		movzx	eax, byte ptr [esp+58h+var_10+3]
		and	eax, 8000003Fh
		jns	short loc_299
		dec	eax
		or	eax, 0FFFFFFC0h
		inc	eax

loc_299:				; CODE XREF: _main+14Ej
		sub	al, 20h	; ' '
		mov	byte ptr [esp+58h+var_10+3], al
		push	1
		movzx	eax, al
		push	0
		sub	eax, 0FFFFFF80h
		push	eax
		push	[esp+64h+var_C]
		call	_BN_rand
		add	esp, 48h
		push	[esp+20h+var_8]
		push	[esp+24h+var_C]
		push	ebx
		push	ebx
		push	0
		call	_BN_div
		push	[esp+34h+var_8]
		push	[esp+38h+var_C]
		push	ebp
		push	ebp
		push	0
		call	_BN_div
		push	0
		push	[esp+4Ch+var_8]
		push	[esp+50h+var_C]
		push	ebp
		push	ebx
		push	dword ptr [esp+5Ch]
		call	_BN_mod_exp_mont
		add	esp, 40h
		test	eax, eax
		jle	loc_575
		push	[esp+20h+var_8]
		push	[esp+24h+var_C]
		push	ebp
		push	ebx
		push	[esp+30h+var_4]
		call	_BN_mod_exp_recp
		add	esp, 14h
		test	eax, eax
		jle	loc_56E
		push	[esp+20h+var_8]
		push	[esp+24h+var_C]
		push	ebp
		push	ebx
		push	esi
		call	_BN_mod_exp_simple
		add	esp, 14h
		test	eax, eax
		jle	$LN41
		push	0
		push	[esp+24h+var_8]
		push	[esp+28h+var_C]
		push	ebp
		push	ebx
		push	[esp+34h+argc]
		call	_BN_mod_exp_mont_consttime
		add	esp, 18h
		test	eax, eax
		jle	$LN40
		push	dword ptr [esp+20h]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	$LN39
		push	[esp+20h+var_4]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	$LN39
		push	[esp+20h+argc]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jnz	$LN39
		push	offset ??_C@_01LFCBOECM@?4?$AA@	; "."
		call	_printf
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax		; File
		call	dword ptr ds:__imp__fflush
		mov	eax, [esp+2Ch+argv]
		add	esp, 0Ch
		inc	eax
		mov	[esp+20h+argv],	eax
		cmp	eax, 0C8h ; 'È'
		jl	loc_214
		push	dword ptr [esp+20h]
		call	_BN_free
		push	[esp+24h+argc]
		call	_BN_free
		push	[esp+28h+var_4]
		call	_BN_free
		push	esi
		call	_BN_free
		push	ebx
		call	_BN_free
		push	ebp
		call	_BN_free
		push	[esp+38h+var_C]
		call	_BN_free
		push	[esp+3Ch+var_8]
		call	_BN_CTX_free
		push	0
		call	_ERR_remove_thread_state
		push	edi
		call	_CRYPTO_mem_leaks
		push	edi
		call	_BIO_free
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		call	_printf
		add	esp, 30h
		call	_test_exp_mod_zero
		test	eax, eax
		jnz	$err$42
		push	offset ??_C@_05KJDAJCPN@done?6?$AA@ ; "done\n"
		call	_printf
		add	esp, 4
		push	0		; Code
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN39:					; CODE XREF: _main+21Cj _main+231j ...
		push	dword ptr [esp+20h]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_45F
		push	offset ??_C@_0CB@FNLKPKDF@?6simple?5and?5mont?5results?5differ?6@ ; "\nsimple and mont results differ\n"
		call	_printf
		add	esp, 4

loc_45F:				; CODE XREF: _main+30Cj
		push	[esp+20h+argc]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_47D
		push	offset ??_C@_0CM@OIINGDJK@?6simple?5and?5mont?5const?5time?5resu@ ; "\nsimple and mont const time results di"...
		call	_printf
		add	esp, 4

loc_47D:				; CODE XREF: _main+32Aj
		push	[esp+20h+var_4]
		push	esi
		call	_BN_cmp
		add	esp, 8
		test	eax, eax
		jz	short loc_49B
		push	offset ??_C@_0CB@DBNNIAPA@?6simple?5and?5recp?5results?5differ?6@ ; "\nsimple and recp results differ\n"
		call	_printf
		add	esp, 4

loc_49B:				; CODE XREF: _main+348j
		push	ebx
		call	_BN_num_bits
		push	eax
		push	offset ??_C@_0L@BNPKAKBL@a?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@	; "a (%3d) = "
		call	_printf
		push	ebx
		push	edi
		call	_BN_print
		push	ebp
		call	_BN_num_bits
		push	eax
		push	offset ??_C@_0M@HOHNPDPI@?6b?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@ ; "\nb (%3d) = "
		call	_printf
		push	ebp
		push	edi
		call	_BN_print
		mov	ebx, [esp+48h+var_C]
		push	ebx
		call	_BN_num_bits
		push	eax
		push	offset ??_C@_0M@ONIFAHDO@?6m?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@ ; "\nm (%3d) = "
		call	_printf
		push	ebx
		push	edi
		call	_BN_print
		push	offset ??_C@_0M@CCKALMG@?6simple?5?5?5?$DN?$AA@	; "\nsimple   ="
		call	_printf
		add	esp, 40h
		push	esi
		push	edi
		call	_BN_print
		push	offset ??_C@_0M@MNGEGLMI@?6recp?5?5?5?5?5?$DN?$AA@ ; "\nrecp	 ="
		call	_printf
		push	[esp+2Ch+var_4]
		push	edi
		call	_BN_print
		push	offset ??_C@_0M@JCENCCKB@?6mont?5?5?5?5?5?$DN?$AA@ ; "\nmont	 ="
		call	_printf
		push	dword ptr [esp+38h]
		push	edi
		call	_BN_print
		push	offset ??_C@_0M@MMDCJDKK@?6mont_ct?5?5?$DN?$AA@	; "\nmont_ct  ="
		call	_printf
		push	[esp+44h+argc]
		push	edi
		call	_BN_print
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		call	_printf
		add	esp, 30h
		push	1		; Code
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN40:					; CODE XREF: _main+207j
		push	offset ??_C@_0CG@DBFFFBBB@BN_mod_exp_mont_consttime?$CI?$CJ?5prob@ ; "BN_mod_exp_mont_consttime() problems\n"

loc_551:				; CODE XREF: _main+428j _main+42Fj ...
		call	_printf
		push	edi
		call	_ERR_print_errors
		add	esp, 8

loc_55F:				; CODE XREF: _main+446j
		push	1		; Code
		call	dword ptr ds:__imp__exit
; ---------------------------------------------------------------------------

$LN41:					; CODE XREF: _main+1E7j
		push	offset ??_C@_0BO@FACLPCBM@BN_mod_exp_simple?$CI?$CJ?5problems?6?$AA@ ; "BN_mod_exp_simple() problems\n"
		jmp	short loc_551
; ---------------------------------------------------------------------------

loc_56E:				; CODE XREF: _main+1CCj
		push	offset ??_C@_0BM@KELHKBEE@BN_mod_exp_recp?$CI?$CJ?5problems?6?$AA@ ; "BN_mod_exp_recp()	problems\n"
		jmp	short loc_551
; ---------------------------------------------------------------------------

loc_575:				; CODE XREF: _main+1AEj
		push	offset ??_C@_0BM@GEHFEMNH@BN_mod_exp_mont?$CI?$CJ?5problems?6?$AA@ ; "BN_mod_exp_mont()	problems\n"
		jmp	short loc_551
; ---------------------------------------------------------------------------

$err$42:				; CODE XREF: _main+76j	_main+80j ...
		call	_ERR_load_crypto_strings
		push	edi
		call	_ERR_print_errors
		add	esp, 4
		jmp	short loc_55F
_main		endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 58Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int printf(const char	*Format, ...)
		public _printf
_printf		proc near		; CODE XREF: _main+251p _main+2D3p ...

Format		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi		; $LN34
		mov	esi, [esp+4+Format]
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		lea	ecx, [esp+4+arg_4]
		push	ecx
		push	0
		push	esi
		push	eax
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		pop	esi
		retn
_printf		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_test_exp_mod_zero proc	near		; CODE XREF: _main+2DBp

var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= byte ptr -3Ch
var_28		= byte ptr -28h
var_14		= byte ptr -14h

		mov	eax, 50h ; 'P'
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	_BN_CTX_new
		mov	edi, eax
		mov	ebx, 1
		lea	eax, [esp+60h+var_14]
		xor	esi, esi
		push	eax
		call	_BN_init
		lea	eax, [esp+64h+var_14]
		push	ebx
		push	eax
		call	_BN_set_word
		lea	eax, [esp+6Ch+var_3C]
		push	eax
		call	_BN_init
		lea	eax, [esp+70h+var_3C]
		push	ebx
		push	eax
		call	_BN_set_word
		lea	eax, [esp+78h+var_28]
		push	eax
		call	_BN_init
		lea	eax, [esp+7Ch+var_28]
		push	esi
		push	eax
		call	_BN_set_word
		lea	eax, [esp+84h+var_50]
		push	eax
		call	_BN_init
		push	esi
		push	esi
		lea	eax, [esp+90h+var_3C]
		push	400h
		push	eax
		call	_BN_rand
		add	esp, 38h
		test	eax, eax
		jz	$err$17
		push	edi
		lea	eax, [esp+64h+var_14]
		push	eax
		lea	eax, [esp+68h+var_28]
		push	eax
		lea	eax, [esp+6Ch+var_3C]
		push	eax
		lea	eax, [esp+70h+var_50]
		push	eax
		call	_BN_mod_exp
		add	esp, 14h
		test	eax, eax
		jz	$err$17
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	eax, [esp+64h+var_50]
		push	eax
		push	offset ??_C@_0L@FBNHIMJG@BN_mod_exp?$AA@ ; "BN_mod_exp"
		call	_a_is_zero_mod_one
		test	eax, eax
		mov	ebp, ebx
		push	edi
		lea	eax, [esp+70h+var_14]
		cmovz	esi, ebp
		push	eax
		lea	eax, [esp+74h+var_28]
		push	eax
		lea	eax, [esp+78h+var_3C]
		push	eax
		lea	eax, [esp+7Ch+var_50]
		push	eax
		call	_BN_mod_exp_recp
		add	esp, 20h
		test	eax, eax
		jz	$err$17
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	eax, [esp+64h+var_50]
		push	eax
		push	offset ??_C@_0BA@MFDDJGKA@BN_mod_exp_recp?$AA@ ; "BN_mod_exp_recp"
		call	_a_is_zero_mod_one
		test	eax, eax
		lea	eax, [esp+6Ch+var_14]
		push	edi
		push	eax
		lea	eax, [esp+74h+var_28]
		cmovz	esi, ebp
		push	eax
		lea	eax, [esp+78h+var_3C]
		push	eax
		lea	eax, [esp+7Ch+var_50]
		push	eax
		call	_BN_mod_exp_simple
		add	esp, 20h
		test	eax, eax
		jz	$err$17
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	eax, [esp+64h+var_50]
		push	eax
		push	offset ??_C@_0BC@IAKJJHKD@BN_mod_exp_simple?$AA@ ; "BN_mod_exp_simple"
		call	_a_is_zero_mod_one
		test	eax, eax
		lea	eax, [esp+6Ch+var_14]
		push	0
		push	edi
		push	eax
		lea	eax, [esp+78h+var_28]
		cmovz	esi, ebp
		push	eax
		lea	eax, [esp+7Ch+var_3C]
		push	eax
		lea	eax, [esp+80h+var_50]
		push	eax
		call	_BN_mod_exp_mont
		add	esp, 24h
		test	eax, eax
		jz	$err$17
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	eax, [esp+64h+var_50]
		push	eax
		push	offset ??_C@_0BA@CEIKCAMA@BN_mod_exp_mont?$AA@ ; "BN_mod_exp_mont"
		call	_a_is_zero_mod_one
		test	eax, eax
		lea	eax, [esp+6Ch+var_14]
		push	0
		push	edi
		push	eax
		lea	eax, [esp+78h+var_28]
		cmovz	esi, ebp
		push	eax
		lea	eax, [esp+7Ch+var_3C]
		push	eax
		lea	eax, [esp+80h+var_50]
		push	eax
		call	_BN_mod_exp_mont_consttime
		add	esp, 24h
		test	eax, eax
		jz	$err$17
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	eax, [esp+64h+var_50]
		push	eax
		push	offset ??_C@_0BK@MLKANOIE@BN_mod_exp_mont_consttime?$AA@ ; "BN_mod_exp_mont_consttime"
		call	_a_is_zero_mod_one
		push	0
		test	eax, eax
		lea	eax, [esp+70h+var_14]
		push	edi
		push	eax
		lea	eax, [esp+78h+var_28]
		cmovz	esi, ebp
		push	eax
		lea	eax, [esp+7Ch+var_50]
		push	ebx
		push	eax
		call	_BN_mod_exp_mont_word
		add	esp, 24h
		test	eax, eax
		jz	$err$17
		cmp	[esp+60h+var_4C], 0
		jz	short loc_81C
		mov	esi, dword ptr ds:__imp____acrt_iob_func
		push	offset ??_C@_0BO@LCLFGOML@BN_mod_exp_mont_word?5failed?3?6?$AA@	; "BN_mod_exp_mont_word	failed:\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	offset ??_C@_0CA@MEJCIDAB@1?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@	; "1 **	0 mod 1	= r (should be 0)\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	offset ??_C@_04KDMKEGBC@r?5?$DN?5?$AA@ ; "r = "
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		lea	eax, [esp+60h+var_50]
		push	eax
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax
		call	_BN_print_fp
		add	esp, 8
		push	offset ??_C@_01EEMJAFIK@?6?$AA@	; "\n"
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn
; ---------------------------------------------------------------------------

loc_81C:				; CODE XREF: _test_exp_mod_zero+1E5j
		mov	ebx, esi

$err$17:				; CODE XREF: _test_exp_mod_zero+7Bj
					; _test_exp_mod_zero+A0j ...
		lea	eax, [esp+60h+var_50]
		push	eax
		call	_BN_free
		lea	eax, [esp+64h+var_3C]
		push	eax
		call	_BN_free
		lea	eax, [esp+68h+var_28]
		push	eax
		call	_BN_free
		lea	eax, [esp+6Ch+var_14]
		push	eax
		call	_BN_free
		push	edi
		call	_BN_CTX_free
		add	esp, 14h
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn
_test_exp_mod_zero endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 85Ch
; COMDAT (pick any)
		public ??_C@_0M@EIIACMOD@?$CFs?5failed?3?6?$AA@
; char `string'[]
??_C@_0M@EIIACMOD@?$CFs?5failed?3?6?$AA@ db '%s failed:',0Ah,0
					; DATA XREF: _a_is_zero_mod_one+1Ao
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 868h
; COMDAT (pick any)
		public ??_C@_0CA@KMKOFGEM@a?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@
; char `string'[]
??_C@_0CA@KMKOFGEM@a?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@ db 'a ** 0 mod 1 = r (should be 0)',0Ah,0
					; DATA XREF: _a_is_zero_mod_one+2Fo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 888h
; COMDAT (pick any)
		public ??_C@_04IEIKKLEA@a?5?$DN?5?$AA@
; char `string'[]
??_C@_04IEIKKLEA@a?5?$DN?5?$AA@	db 'a = ',0 ; DATA XREF: _a_is_zero_mod_one+44o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 890h
; COMDAT (pick any)
		public ??_C@_05HFLBDDMK@?6r?5?$DN?5?$AA@
; char `string'[]
??_C@_05HFLBDDMK@?6r?5?$DN?5?$AA@ db 0Ah ; DATA	XREF: _a_is_zero_mod_one+6Do
		db 'r = ',0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 898h
; COMDAT (pick any)
		public ??_C@_01EEMJAFIK@?6?$AA@
; char `string'[2]
??_C@_01EEMJAFIK@?6?$AA@ db 0Ah,0	; DATA XREF: _a_is_zero_mod_one+93o
					; _main+2CEo ...
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 89Ch
; COMDAT (pick any)
		public ??_C@_0L@FBNHIMJG@BN_mod_exp?$AA@
; `string'
??_C@_0L@FBNHIMJG@BN_mod_exp?$AA@ db 'BN_mod_exp',0 ; DATA XREF: _test_exp_mod_zero+B0o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8A8h
; COMDAT (pick any)
		public ??_C@_0BA@MFDDJGKA@BN_mod_exp_recp?$AA@
; `string'
??_C@_0BA@MFDDJGKA@BN_mod_exp_recp?$AA@	db 'BN_mod_exp_recp',0
					; DATA XREF: _test_exp_mod_zero+F0o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8B8h
; COMDAT (pick any)
		public ??_C@_0BC@IAKJJHKD@BN_mod_exp_simple?$AA@
; `string'
??_C@_0BC@IAKJJHKD@BN_mod_exp_simple?$AA@ db 'BN_mod_exp_simple',0
					; DATA XREF: _test_exp_mod_zero+12Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8CCh
; COMDAT (pick any)
		public ??_C@_0BA@CEIKCAMA@BN_mod_exp_mont?$AA@
; `string'
??_C@_0BA@CEIKCAMA@BN_mod_exp_mont?$AA@	db 'BN_mod_exp_mont',0
					; DATA XREF: _test_exp_mod_zero+16Eo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8DCh
; COMDAT (pick any)
		public ??_C@_0BK@MLKANOIE@BN_mod_exp_mont_consttime?$AA@
; `string'
??_C@_0BK@MLKANOIE@BN_mod_exp_mont_consttime?$AA@ db 'BN_mod_exp_mont_consttime',0
					; DATA XREF: _test_exp_mod_zero+1AEo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 8F8h
; COMDAT (pick any)
		public ??_C@_0BO@LCLFGOML@BN_mod_exp_mont_word?5failed?3?6?$AA@
; char `string'[]
??_C@_0BO@LCLFGOML@BN_mod_exp_mont_word?5failed?3?6?$AA@ db 'BN_mod_exp_mont_word failed:',0Ah,0
					; DATA XREF: _test_exp_mod_zero+1EDo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 918h
; COMDAT (pick any)
		public ??_C@_0CA@MEJCIDAB@1?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@
; char `string'[]
??_C@_0CA@MEJCIDAB@1?5?$CK?$CK?50?5mod?51?5?$DN?5r?5?$CIshould?5be?50?$CJ?6?$AA@ db '1 ** 0 mod 1 = r (should be 0)',0Ah,0
					; DATA XREF: _test_exp_mod_zero+202o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 938h
; COMDAT (pick any)
		public ??_C@_04KDMKEGBC@r?5?$DN?5?$AA@
; char `string'[]
??_C@_04KDMKEGBC@r?5?$DN?5?$AA@	db 'r = ',0 ; DATA XREF: _test_exp_mod_zero+217o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 940h
; COMDAT (pick any)
		public ??_C@_0BM@GEHFEMNH@BN_mod_exp_mont?$CI?$CJ?5problems?6?$AA@
; `string'
??_C@_0BM@GEHFEMNH@BN_mod_exp_mont?$CI?$CJ?5problems?6?$AA@ db 'BN_mod_exp_mont() problems',0Ah,0
					; DATA XREF: _main:loc_575o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 95Ch
; COMDAT (pick any)
		public ??_C@_0BM@KELHKBEE@BN_mod_exp_recp?$CI?$CJ?5problems?6?$AA@
; `string'
??_C@_0BM@KELHKBEE@BN_mod_exp_recp?$CI?$CJ?5problems?6?$AA@ db 'BN_mod_exp_recp() problems',0Ah,0
					; DATA XREF: _main:loc_56Eo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 978h
; COMDAT (pick any)
		public ??_C@_0BO@FACLPCBM@BN_mod_exp_simple?$CI?$CJ?5problems?6?$AA@
; `string'
??_C@_0BO@FACLPCBM@BN_mod_exp_simple?$CI?$CJ?5problems?6?$AA@ db 'BN_mod_exp_simple() problems',0Ah,0
					; DATA XREF: _main:$LN41o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 998h
; COMDAT (pick any)
		public ??_C@_0CG@DBFFFBBB@BN_mod_exp_mont_consttime?$CI?$CJ?5prob@
; char `string'[]
??_C@_0CG@DBFFFBBB@BN_mod_exp_mont_consttime?$CI?$CJ?5prob@ db 'BN_mod_exp_mont_consttime() problems',0Ah,0
					; DATA XREF: _main:$LN40o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9C0h
; COMDAT (pick any)
		public ??_C@_01LFCBOECM@?4?$AA@
; char `string'[2]
??_C@_01LFCBOECM@?4?$AA@ db '.',0       ; DATA XREF: _main+24Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9C4h
; COMDAT (pick any)
		public ??_C@_0CB@FNLKPKDF@?6simple?5and?5mont?5results?5differ?6@
; char `string'[]
??_C@_0CB@FNLKPKDF@?6simple?5and?5mont?5results?5differ?6@ db 0Ah ; DATA XREF: _main+30Eo
		db 'simple and mont results differ',0Ah,0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 9E8h
; COMDAT (pick any)
		public ??_C@_0CM@OIINGDJK@?6simple?5and?5mont?5const?5time?5resu@
; char `string'[]
??_C@_0CM@OIINGDJK@?6simple?5and?5mont?5const?5time?5resu@ db 0Ah ; DATA XREF: _main+32Co
		db 'simple and mont const time results differ',0Ah,0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A14h
; COMDAT (pick any)
		public ??_C@_0CB@DBNNIAPA@?6simple?5and?5recp?5results?5differ?6@
; char `string'[]
??_C@_0CB@DBNNIAPA@?6simple?5and?5recp?5results?5differ?6@ db 0Ah ; DATA XREF: _main+34Ao
		db 'simple and recp results differ',0Ah,0
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A38h
; COMDAT (pick any)
		public ??_C@_0L@BNPKAKBL@a?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@
; char `string'[]
??_C@_0L@BNPKAKBL@a?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@ db 'a (%3d) = ',0 ; DATA XREF: _main+35Eo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A44h
; COMDAT (pick any)
		public ??_C@_0M@HOHNPDPI@?6b?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@
; char `string'[]
??_C@_0M@HOHNPDPI@?6b?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@ db 0Ah ; DATA XREF: _main+376o
		db 'b (%3d) = ',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A50h
; COMDAT (pick any)
		public ??_C@_0M@ONIFAHDO@?6m?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@
; char `string'[]
??_C@_0M@ONIFAHDO@?6m?5?$CI?$CF3d?$CJ?5?$DN?5?$AA@ db 0Ah ; DATA XREF: _main+392o
		db 'm (%3d) = ',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A5Ch
; COMDAT (pick any)
		public ??_C@_0M@CCKALMG@?6simple?5?5?5?$DN?$AA@
; char `string'[]
??_C@_0M@CCKALMG@?6simple?5?5?5?$DN?$AA@ db 0Ah	; DATA XREF: _main+3A3o
		db 'simple   =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A68h
; COMDAT (pick any)
		public ??_C@_0M@MNGEGLMI@?6recp?5?5?5?5?5?$DN?$AA@
; char `string'[]
??_C@_0M@MNGEGLMI@?6recp?5?5?5?5?5?$DN?$AA@ db 0Ah ; DATA XREF:	_main+3B7o
		db 'recp     =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A74h
; COMDAT (pick any)
		public ??_C@_0M@JCENCCKB@?6mont?5?5?5?5?5?$DN?$AA@
; char `string'[]
??_C@_0M@JCENCCKB@?6mont?5?5?5?5?5?$DN?$AA@ db 0Ah ; DATA XREF:	_main+3CBo
		db 'mont     =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A80h
; COMDAT (pick any)
		public ??_C@_0M@MMDCJDKK@?6mont_ct?5?5?$DN?$AA@
; char `string'[]
??_C@_0M@MMDCJDKK@?6mont_ct?5?5?$DN?$AA@ db 0Ah	; DATA XREF: _main+3DFo
		db 'mont_ct  =',0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0A8Ch
; COMDAT (pick any)
		public ??_C@_05KJDAJCPN@done?6?$AA@
; char `string'[]
??_C@_05KJDAJCPN@done?6?$AA@ db	'done',0Ah,0 ; DATA XREF: _main+2E8o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __imp____acrt_iob_func:near ; CODE XREF: _a_is_zero_mod_one+21p
					; _a_is_zero_mod_one+36p ...
; int __cdecl _fflush(FILE *File)
		extrn __imp__fflush:near ; CODE	XREF: _main+25Fp
					; DATA XREF: _main+25Fr
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p	...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:near	; CODE XREF: _main+30p	_main+ACp ...
		extrn _CRYPTO_mem_leaks:near ; CODE XREF: _main+2C3p
		extrn _BIO_s_file:near	; CODE XREF: _main+96p
		extrn _BIO_new:near	; CODE XREF: _main+9Cp
		extrn _BIO_free:near	; CODE XREF: _main+2C9p
		extrn _BIO_ctrl:near	; CODE XREF: _main+BEp
		extrn _BN_CTX_new:near	; CODE XREF: _main+21p
					; _test_exp_mod_zero+Ep
		extrn _BN_CTX_free:near	; CODE XREF: _main+2B6p
					; _test_exp_mod_zero+28Bp
		extrn _BN_rand:near	; CODE XREF: _main+FFp	_main+133p ...
		extrn _BN_num_bits:near	; CODE XREF: _main+358p _main+370p ...
		extrn _BN_new:near	; CODE XREF: _main+39p	_main+42p ...
		extrn _BN_init:near	; CODE XREF: _test_exp_mod_zero+21p
					; _test_exp_mod_zero+36p ...
		extrn _BN_div:near	; CODE XREF: _main+17Ep _main+18Fp
		extrn _BN_set_word:near	; CODE XREF: _test_exp_mod_zero+2Cp
					; _test_exp_mod_zero+41p ...
		extrn _BN_cmp:near	; CODE XREF: _main+212p _main+227p ...
		extrn _BN_free:near	; CODE XREF: _main+280p _main+289p ...
		extrn _BN_mod_exp:near	; CODE XREF: _test_exp_mod_zero+96p
		extrn _BN_mod_exp_mont:near ; CODE XREF: _main+1A4p
					; _test_exp_mod_zero+154p
		extrn _BN_mod_exp_mont_consttime:near ;	CODE XREF: _main+1FDp
					; _test_exp_mod_zero+194p
		extrn _BN_mod_exp_mont_word:near ; CODE	XREF: _test_exp_mod_zero+1D0p
		extrn _BN_mod_exp_simple:near ;	CODE XREF: _main+1DDp
					; _test_exp_mod_zero+114p
		extrn _BN_print_fp:near	; CODE XREF: _a_is_zero_mod_one+65p
					; _a_is_zero_mod_one+8Bp ...
		extrn _BN_print:near	; CODE XREF: _main+36Ap _main+382p ...
		extrn _BN_mod_exp_recp:near ; CODE XREF: _main+1C2p
					; _test_exp_mod_zero+D6p
		extrn _ERR_load_BN_strings:near	; CODE XREF: _main+1Cp
		extrn _RAND_bytes:near	; CODE XREF: _main+D7p	_main+10Bp ...
		extrn _RAND_seed:near	; CODE XREF: _main+14p
		extrn _ERR_print_errors:near ; CODE XREF: _main+413p
					; _main+43Ep
		extrn _ERR_load_crypto_strings:near ; CODE XREF: _main:$err$42p
		extrn _ERR_remove_thread_state:near ; CODE XREF: _main+2BDp
		extrn __chkstk:near	; CODE XREF: _main+5p
					; _test_exp_mod_zero+5p
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso


		end
