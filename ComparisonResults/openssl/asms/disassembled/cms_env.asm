;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	C920CFF52FC5C4C35D05CE8D8FA93BA8
; Input	CRC32 :	8BA76C7B

; File Name   :	C:\compspace\Diff\openssl\obj\cms_env.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_EnvelopedData_create
_CMS_EnvelopedData_create proc near

arg_0		= dword	ptr  4

		push	esi
		call	_CMS_ContentInfo_new
		mov	esi, eax
		test	esi, esi
		jz	short loc_3D
		push	esi
		call	_cms_enveloped_data_init
		add	esp, 4
		test	eax, eax
		jz	short $merr$8
		push	0
		push	0
		push	[esp+0Ch+arg_0]
		push	dword ptr [eax+0Ch]
		call	_cms_EncryptedContent_init
		add	esp, 10h
		test	eax, eax
		jz	short $merr$8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

$merr$8:				; CODE XREF: _CMS_EnvelopedData_create+17j
					; _CMS_EnvelopedData_create+2Ej
		push	esi
		call	_CMS_ContentInfo_free
		add	esp, 4

loc_3D:					; CODE XREF: _CMS_EnvelopedData_create+Aj
		push	0ADh ; '≠'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	7Ch ; '|'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_CMS_EnvelopedData_create endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_decrypt
_CMS_RecipientInfo_decrypt proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [ecx]
		sub	eax, 0
		jz	short loc_AB
		sub	eax, 2
		jz	short loc_A2
		sub	eax, 1
		jz	short loc_92
		push	333h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	9Bh ; 'õ'
		push	86h ; 'Ü'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_92:					; CODE XREF: _CMS_RecipientInfo_decrypt+13j
		push	0
		push	ecx
		push	[esp+8+arg_0]
		call	_cms_RecipientInfo_pwri_crypt
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_A2:					; CODE XREF: _CMS_RecipientInfo_decrypt+Ej
		mov	[esp+arg_4], ecx
		jmp	_cms_RecipientInfo_kekri_decrypt
; ---------------------------------------------------------------------------

loc_AB:					; CODE XREF: _CMS_RecipientInfo_decrypt+9j
		mov	[esp+arg_4], ecx
		jmp	_cms_RecipientInfo_ktri_decrypt
_CMS_RecipientInfo_decrypt endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_encrypt
_CMS_RecipientInfo_encrypt proc	near	; CODE XREF: _cms_EnvelopedData_init_bio+4Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax]
		cmp	ecx, 3		; switch 4 cases
		ja	short loc_F1	; jumptable 000000BF default case
		jmp	ds:$LN12[ecx*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _CMS_RecipientInfo_encrypt+Bj
					; DATA XREF: .text$mn:$LN12o
		mov	[esp+arg_4], eax ; jumptable 000000BF case 0
		jmp	_cms_RecipientInfo_ktri_encrypt
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _CMS_RecipientInfo_encrypt+Bj
					; DATA XREF: .text$mn:$LN12o
		mov	[esp+arg_4], eax ; jumptable 000000BF case 1
		jmp	_cms_RecipientInfo_kari_encrypt
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _CMS_RecipientInfo_encrypt+Bj
					; DATA XREF: .text$mn:$LN12o
		mov	[esp+arg_4], eax ; jumptable 000000BF case 2
		jmp	_cms_RecipientInfo_kekri_encrypt
; ---------------------------------------------------------------------------

$LN7:					; CODE XREF: _CMS_RecipientInfo_encrypt+Bj
					; DATA XREF: .text$mn:$LN12o
		push	1		; jumptable 000000BF case 3
		push	eax
		push	[esp+8+arg_0]
		call	_cms_RecipientInfo_pwri_crypt
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_F1:					; CODE XREF: _CMS_RecipientInfo_encrypt+9j
		push	34Bh		; jumptable 000000BF default case
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	9Ah ; 'ö'
		push	0A9h ; '©'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
_CMS_RecipientInfo_encrypt endp

; ---------------------------------------------------------------------------
		align 4
$LN12		dd offset $LN4		; DATA XREF: _CMS_RecipientInfo_encrypt+Br
		dd offset $LN5		; jump table for switch	statement
		dd offset $LN6
		dd offset $LN7
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 124h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_get0_pkey_ctx
_CMS_RecipientInfo_get0_pkey_ctx proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_135
		mov	eax, [eax+4]
		mov	eax, [eax+18h]
		retn
; ---------------------------------------------------------------------------

loc_135:				; CODE XREF: _CMS_RecipientInfo_get0_pkey_ctx+8j
		cmp	ecx, 1
		jnz	short loc_141
		mov	eax, [eax+4]
		mov	eax, [eax+14h]
		retn
; ---------------------------------------------------------------------------

loc_141:				; CODE XREF: _CMS_RecipientInfo_get0_pkey_ctx+14j
		xor	eax, eax
		retn
_CMS_RecipientInfo_get0_pkey_ctx endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 144h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_kekri_get0_id
_CMS_RecipientInfo_kekri_get0_id proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 2
		jz	short loc_16B
		push	27Dh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Bh ; '{'
		push	89h ; 'â'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_16B:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+7j
		mov	eax, [eax+4]
		mov	ecx, [esp+arg_4]
		mov	edx, [eax+4]
		test	ecx, ecx
		jz	short loc_17E
		mov	eax, [eax+8]
		mov	[ecx], eax

loc_17E:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+33j
		mov	ecx, [esp+arg_8]
		test	ecx, ecx
		jz	short loc_18A
		mov	eax, [edx]
		mov	[ecx], eax

loc_18A:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+40j
		mov	ecx, [esp+arg_C]
		test	ecx, ecx
		jz	short loc_197
		mov	eax, [edx+4]
		mov	[ecx], eax

loc_197:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+4Cj
		mov	ecx, [esp+arg_10]
		test	ecx, ecx
		jz	short loc_1B2
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_1AC
		mov	eax, [eax]
		mov	[ecx], eax
		jmp	short loc_1B2
; ---------------------------------------------------------------------------

loc_1AC:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+60j
		mov	dword ptr [ecx], 0

loc_1B2:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+59j
					; _CMS_RecipientInfo_kekri_get0_id+66j
		mov	ecx, [esp+arg_14]
		test	ecx, ecx
		jz	short loc_1D2
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_1CC
		mov	eax, [eax+4]
		mov	[ecx], eax
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_1CC:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+7Bj
		mov	dword ptr [ecx], 0

loc_1D2:				; CODE XREF: _CMS_RecipientInfo_kekri_get0_id+74j
		mov	eax, 1
		retn
_CMS_RecipientInfo_kekri_get0_id endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_kekri_id_cmp
_CMS_RecipientInfo_kekri_id_cmp	proc near

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 10h
		call	__chkstk
		mov	ecx, [esp+10h+arg_0]
		cmp	dword ptr [ecx], 2
		jz	short loc_20F
		push	1F1h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Bh ; '{'
		push	8Ah ; 'ä'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, 0FFFFFFFEh
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_20F:				; CODE XREF: _CMS_RecipientInfo_kekri_id_cmp+11j
		mov	ecx, [ecx+4]
		mov	eax, [esp+10h+arg_4]
		mov	[esp+10h+var_8], eax
		mov	eax, [esp+10h+arg_8]
		mov	[esp+10h+var_10], eax
		mov	[esp+10h+var_C], 4
		mov	[esp+10h+var_4], 0
		mov	eax, [ecx+4]
		push	dword ptr [eax]
		lea	eax, [esp+14h+var_10]
		push	eax
		call	_ASN1_OCTET_STRING_cmp
		add	esp, 8
		add	esp, 10h
		retn
_CMS_RecipientInfo_kekri_id_cmp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 248h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_ktri_cert_cmp
_CMS_RecipientInfo_ktri_cert_cmp proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_272
		push	14Ah
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Ch ; '|'
		push	8Bh ; 'ã'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_272:				; CODE XREF: _CMS_RecipientInfo_ktri_cert_cmp+7j
		mov	eax, [eax+4]
		push	[esp+arg_4]
		push	dword ptr [eax+4]
		call	_cms_SignerIdentifier_cert_cmp
		add	esp, 8
		retn
_CMS_RecipientInfo_ktri_cert_cmp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 288h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_ktri_get0_algs
_CMS_RecipientInfo_ktri_get0_algs proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_2AF
		push	127h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Ch ; '|'
		push	8Eh ; 'é'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_2AF:				; CODE XREF: _CMS_RecipientInfo_ktri_get0_algs+7j
		mov	edx, [esp+arg_4]
		mov	ecx, [eax+4]
		test	edx, edx
		jz	short loc_2BF
		mov	eax, [ecx+14h]
		mov	[edx], eax

loc_2BF:				; CODE XREF: _CMS_RecipientInfo_ktri_get0_algs+30j
		mov	edx, [esp+arg_8]
		test	edx, edx
		jz	short loc_2CC
		mov	eax, [ecx+10h]
		mov	[edx], eax

loc_2CC:				; CODE XREF: _CMS_RecipientInfo_ktri_get0_algs+3Dj
		mov	edx, [esp+arg_C]
		test	edx, edx
		jz	short loc_2D9
		mov	eax, [ecx+8]
		mov	[edx], eax

loc_2D9:				; CODE XREF: _CMS_RecipientInfo_ktri_get0_algs+4Aj
		mov	eax, 1
		retn
_CMS_RecipientInfo_ktri_get0_algs endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 2E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_ktri_get0_signer_id
_CMS_RecipientInfo_ktri_get0_signer_id proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_307
		push	13Eh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Ch ; '|'
		push	8Fh ; 'è'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_307:				; CODE XREF: _CMS_RecipientInfo_ktri_get0_signer_id+7j
		push	[esp+arg_C]
		mov	eax, [eax+4]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	dword ptr [eax+4]
		call	_cms_SignerIdentifier_get0_signer_id
		add	esp, 10h
		retn
_CMS_RecipientInfo_ktri_get0_signer_id endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 324h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_set0_key
_CMS_RecipientInfo_set0_key proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		cmp	dword ptr [ecx], 2
		jz	short loc_34B
		push	29Bh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Bh ; '{'
		push	90h ; 'ê'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_34B:				; CODE XREF: _CMS_RecipientInfo_set0_key+7j
		mov	ecx, [ecx+4]
		mov	eax, [esp+arg_4]
		mov	[ecx+10h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+14h], eax
		mov	eax, 1
		retn
_CMS_RecipientInfo_set0_key endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 364h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_set0_pkey
_CMS_RecipientInfo_set0_pkey proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		cmp	dword ptr [ecx], 0
		jz	short loc_38B
		push	153h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Ch ; '|'
		push	91h ; 'ë'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_38B:				; CODE XREF: _CMS_RecipientInfo_set0_pkey+7j
		mov	ecx, [ecx+4]
		mov	eax, [esp+arg_4]
		mov	[ecx+14h], eax
		mov	eax, 1
		retn
_CMS_RecipientInfo_set0_pkey endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 39Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_RecipientInfo_type
_CMS_RecipientInfo_type	proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		retn
_CMS_RecipientInfo_type	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add0_recipient_key
_CMS_add0_recipient_key	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 17h
		jz	short loc_3DA
		push	4Fh ; 'O'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Bh ; 'k'
		push	83h ; 'É'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_3DA:				; CODE XREF: _CMS_add0_recipient_key+15j
		mov	eax, [esi+4]
		mov	[esp+10h+arg_0], eax
		test	eax, eax
		jz	loc_5B6
		mov	edi, [esp+10h+arg_4]
		test	edi, edi
		jnz	loc_52D
		mov	ebp, [esp+10h+arg_C]
		cmp	ebp, 10h
		jz	loc_523
		cmp	ebp, 18h
		jz	loc_519
		cmp	ebp, 20h ; ' '
		jz	short loc_42F
		push	22Ch

loc_415:				; CODE XREF: _CMS_add0_recipient_key+1E2j
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	76h ; 'v'
		push	64h ; 'd'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_42F:				; CODE XREF: _CMS_add0_recipient_key+6Aj
		mov	edi, 316h

loc_434:				; CODE XREF: _CMS_add0_recipient_key+17Aj
					; _CMS_add0_recipient_key+184j	...
		call	_CMS_RecipientInfo_it
		push	eax
		call	_ASN1_item_new
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	$merr$35
		call	_CMS_KEKRecipientInfo_it
		push	eax
		call	_ASN1_item_new
		mov	ebx, eax
		add	esp, 4
		mov	[esi+4], ebx
		test	ebx, ebx
		jz	$merr$35
		cmp	[esp+10h+arg_1C], 0
		mov	dword ptr [esi], 2
		jz	short loc_495
		call	_CMS_OtherKeyAttribute_it
		push	eax
		call	_ASN1_item_new
		mov	ecx, [ebx+4]
		add	esp, 4
		mov	[ecx+8], eax
		mov	eax, [ebx+4]
		cmp	dword ptr [eax+8], 0
		jz	$merr$35

loc_495:				; CODE XREF: _CMS_add0_recipient_key+CEj
		mov	eax, [esp+10h+arg_0]
		push	esi
		push	dword ptr [eax+8]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	$merr$35
		mov	eax, [esp+10h+arg_8]
		push	[esp+10h+arg_14]
		mov	[ebx+10h], eax
		mov	eax, [ebx+4]
		push	[esp+14h+arg_10]
		mov	dword ptr [ebx], 4
		mov	[ebx+14h], ebp
		push	dword ptr [eax]
		call	_ASN1_STRING_set0
		mov	ecx, [ebx+4]
		add	esp, 0Ch
		mov	eax, [esp+10h+arg_18]
		mov	[ecx+4], eax
		mov	eax, [ebx+4]
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_4F9
		mov	eax, [esp+10h+arg_1C]
		mov	[ecx], eax
		mov	eax, [ebx+4]
		mov	ecx, [eax+8]
		mov	eax, [esp+10h+arg_20]
		mov	[ecx+4], eax

loc_4F9:				; CODE XREF: _CMS_add0_recipient_key+140j
		push	0
		push	0FFFFFFFFh
		push	edi
		call	_OBJ_nid2obj
		add	esp, 4
		push	eax
		push	dword ptr [ebx+8]
		call	_X509_ALGOR_set0
		add	esp, 10h
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_519:				; CODE XREF: _CMS_add0_recipient_key+61j
		mov	edi, 315h
		jmp	loc_434
; ---------------------------------------------------------------------------

loc_523:				; CODE XREF: _CMS_add0_recipient_key+58j
		mov	edi, 314h
		jmp	loc_434
; ---------------------------------------------------------------------------

loc_52D:				; CODE XREF: _CMS_add0_recipient_key+4Bj
		mov	eax, edi
		sub	eax, 314h
		jz	short loc_570
		sub	eax, 1
		jz	short loc_569
		sub	eax, 1
		jz	short loc_562
		push	236h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	99h ; 'ô'
		push	64h ; 'd'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_562:				; CODE XREF: _CMS_add0_recipient_key+19Aj
		mov	eax, 20h ; ' '
		jmp	short loc_575
; ---------------------------------------------------------------------------

loc_569:				; CODE XREF: _CMS_add0_recipient_key+195j
		mov	eax, 18h
		jmp	short loc_575
; ---------------------------------------------------------------------------

loc_570:				; CODE XREF: _CMS_add0_recipient_key+190j
		mov	eax, 10h

loc_575:				; CODE XREF: _CMS_add0_recipient_key+1C3j
					; _CMS_add0_recipient_key+1CAj
		mov	ebp, [esp+10h+arg_C]
		cmp	ebp, eax
		jz	loc_434
		push	23Bh
		jmp	loc_415
; ---------------------------------------------------------------------------

$merr$35:				; CODE XREF: _CMS_add0_recipient_key+A2j
					; _CMS_add0_recipient_key+BDj ...
		push	26Ch
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	64h ; 'd'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

$err$36:
		test	esi, esi
		jz	short loc_5B6
		call	_CMS_RecipientInfo_it
		push	eax
		push	esi
		call	_ASN1_item_free
		add	esp, 8

loc_5B6:				; CODE XREF: _CMS_add0_recipient_key+3Fj
					; _CMS_add0_recipient_key+201j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_CMS_add0_recipient_key	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 5C0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_add1_recipient_cert
_CMS_add1_recipient_cert proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		xor	esi, esi
		push	dword ptr [edi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 17h
		jz	short loc_5F8
		push	4Fh ; 'O'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Bh ; 'k'
		push	83h ; 'É'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_5F8:				; CODE XREF: _CMS_add1_recipient_cert+17j
		mov	ebp, [edi+4]
		test	ebp, ebp
		jz	loc_6D6
		call	_CMS_RecipientInfo_it
		push	eax
		call	_ASN1_item_new
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	$merr$23
		mov	ebx, [esp+10h+arg_4]
		push	ebx
		call	_X509_get_pubkey
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_63C
		push	0F7h ; '˜'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	71h ; 'q'
		jmp	short loc_6AA
; ---------------------------------------------------------------------------

loc_63C:				; CODE XREF: _CMS_add1_recipient_cert+6Cj
		push	esi
		call	_cms_pkey_get_ri_type
		add	esp, 4
		sub	eax, 0
		jz	short loc_66B
		sub	eax, 1
		jz	short loc_65D
		push	109h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Dh ; '}'
		jmp	short loc_6AA
; ---------------------------------------------------------------------------

loc_65D:				; CODE XREF: _CMS_add1_recipient_cert+8Dj
		push	[esp+10h+arg_8]
		push	esi
		push	ebx
		push	edi
		call	_cms_RecipientInfo_kari_init
		jmp	short loc_677
; ---------------------------------------------------------------------------

loc_66B:				; CODE XREF: _CMS_add1_recipient_cert+88j
		push	[esp+10h+arg_8]
		push	esi
		push	ebx
		push	edi
		call	_cms_RecipientInfo_ktri_init

loc_677:				; CODE XREF: _CMS_add1_recipient_cert+A9j
		add	esp, 10h
		test	eax, eax
		jz	short $err$24
		push	edi
		push	dword ptr [ebp+8]
		call	_sk_push
		add	esp, 8
		test	eax, eax
		jz	short $merr$23
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

$merr$23:				; CODE XREF: _CMS_add1_recipient_cert+55j
					; _CMS_add1_recipient_cert+CCj
		push	116h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'

loc_6AA:				; CODE XREF: _CMS_add1_recipient_cert+7Aj
					; _CMS_add1_recipient_cert+9Bj
		push	65h ; 'e'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

$err$24:				; CODE XREF: _CMS_add1_recipient_cert+BCj
		test	edi, edi
		jz	short loc_6C9
		call	_CMS_RecipientInfo_it
		push	eax
		push	edi
		call	_ASN1_item_free
		add	esp, 8

loc_6C9:				; CODE XREF: _CMS_add1_recipient_cert+F8j
		test	esi, esi
		jz	short loc_6D6
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4

loc_6D6:				; CODE XREF: _CMS_add1_recipient_cert+3Dj
					; _CMS_add1_recipient_cert+10Bj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_CMS_add1_recipient_cert endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6E0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _CMS_get0_RecipientInfos
_CMS_get0_RecipientInfos proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 17h
		jz	short loc_710
		push	4Fh ; 'O'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Bh ; 'k'
		push	83h ; 'É'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_710:				; CODE XREF: _CMS_get0_RecipientInfos+12j
		mov	eax, [esi+4]
		test	eax, eax
		jnz	short loc_719
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_719:				; CODE XREF: _CMS_get0_RecipientInfos+35j
		mov	eax, [eax+8]
		pop	esi
		retn
_CMS_get0_RecipientInfos endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 720h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aes_wrap_keylen proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	eax, 314h
		jz	short loc_744
		sub	eax, 1
		jz	short loc_73E
		sub	eax, 1
		jz	short loc_738
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_738:				; CODE XREF: _aes_wrap_keylen+13j
		mov	eax, 20h ; ' '
		retn
; ---------------------------------------------------------------------------

loc_73E:				; CODE XREF: _aes_wrap_keylen+Ej
		mov	eax, 18h
		retn
; ---------------------------------------------------------------------------

loc_744:				; CODE XREF: _aes_wrap_keylen+9j
		mov	eax, 10h
		retn
_aes_wrap_keylen endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 74Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_EnvelopedData_init_bio
_cms_EnvelopedData_init_bio proc near

arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edi
		mov	eax, [ebp+4]
		mov	edi, [eax+0Ch]
		push	edi
		call	_cms_EncryptedContent_init_bio
		add	esp, 4
		mov	[esp+8+arg_0], eax
		test	eax, eax
		jz	loc_828
		cmp	dword ptr [edi+0Ch], 0
		jz	loc_828
		mov	ecx, [ebp+4]
		push	ebx
		push	esi
		xor	esi, esi
		mov	ebx, [ecx+8]
		push	ebx
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_7B1

loc_78E:				; CODE XREF: _cms_EnvelopedData_init_bio+63j
		push	esi
		push	ebx
		call	_sk_value
		push	eax
		push	ebp
		call	_CMS_RecipientInfo_encrypt
		add	esp, 10h
		test	eax, eax
		jle	short loc_7FE
		push	ebx
		inc	esi
		call	_sk_num
		add	esp, 4
		cmp	esi, eax
		jl	short loc_78E

loc_7B1:				; CODE XREF: _cms_EnvelopedData_init_bio+40j
		push	dword ptr [ebp+4]
		call	_cms_env_set_version
		add	esp, 4
		mov	ebx, 1

$err$17:				; CODE XREF: _cms_EnvelopedData_init_bio+CCj
		mov	eax, [edi+10h]
		mov	dword ptr [edi+0Ch], 0
		test	eax, eax
		jz	short loc_7F1
		push	dword ptr [edi+14h]
		push	eax
		call	_OPENSSL_cleanse
		push	dword ptr [edi+10h]
		call	_CRYPTO_free
		add	esp, 0Ch
		mov	dword ptr [edi+10h], 0
		mov	dword ptr [edi+14h], 0

loc_7F1:				; CODE XREF: _cms_EnvelopedData_init_bio+81j
		pop	esi
		test	ebx, ebx
		pop	ebx
		jz	short loc_81A
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_7FE:				; CODE XREF: _cms_EnvelopedData_init_bio+55j
		push	3A9h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	74h ; 't'
		push	7Dh ; '}'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	ebx, ebx
		jmp	short $err$17
; ---------------------------------------------------------------------------

loc_81A:				; CODE XREF: _cms_EnvelopedData_init_bio+A9j
		push	[esp+8+arg_0]
		call	_BIO_free
		add	esp, 4
		xor	eax, eax

loc_828:				; CODE XREF: _cms_EnvelopedData_init_bio+1Bj
					; _cms_EnvelopedData_init_bio+25j
		pop	edi
		pop	ebp
		retn
_cms_EnvelopedData_init_bio endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 82Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_RecipientInfo_kekri_decrypt proc near ; CODE XREF:	_CMS_RecipientInfo_decrypt+4Aj

var_F8		= byte ptr -0F8h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 0F8h ; '¯'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0F8h+var_4], eax
		mov	ecx, [esp+0F8h+arg_4]
		mov	eax, [esp+0F8h+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [ecx+4]
		xor	ebx, ebx
		mov	eax, [eax+4]
		mov	ebp, [eax+0Ch]
		cmp	[esi+10h], ebx
		jnz	short loc_89D
		push	2EDh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	82h ; 'Ç'

loc_874:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+B9j
		push	87h ; 'á'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+0F8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
; ---------------------------------------------------------------------------

loc_89D:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+37j
		mov	eax, [esi+8]
		push	dword ptr [eax]
		call	_OBJ_obj2nid
		add	esp, 4
		sub	eax, 314h
		jz	short loc_8CD
		sub	eax, 1
		jz	short loc_8C6
		sub	eax, 1
		jz	short loc_8BF
		xor	eax, eax
		jmp	short loc_8D2
; ---------------------------------------------------------------------------

loc_8BF:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+8Dj
		mov	eax, 20h ; ' '
		jmp	short loc_8D2
; ---------------------------------------------------------------------------

loc_8C6:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+88j
		mov	eax, 18h
		jmp	short loc_8D2
; ---------------------------------------------------------------------------

loc_8CD:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+83j
		mov	eax, 10h

loc_8D2:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+91j
					; _cms_RecipientInfo_kekri_decrypt+98j	...
		mov	ecx, [esi+14h]
		cmp	eax, ecx
		jz	short loc_8E7
		push	2F4h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	76h ; 'v'
		jmp	short loc_874
; ---------------------------------------------------------------------------

loc_8E7:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+ABj
		mov	eax, [esi+0Ch]
		cmp	dword ptr [eax], 10h
		jge	short loc_90F
		push	2FCh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	75h ; 'u'
		push	87h ; 'á'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_9D8
; ---------------------------------------------------------------------------

loc_90F:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+C1j
		lea	eax, [esp+104h+var_F8]
		push	eax
		lea	eax, ds:0[ecx*8]
		push	eax
		push	dword ptr [esi+10h]
		call	_AES_set_decrypt_key
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_94B
		push	302h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	73h ; 's'
		push	87h ; 'á'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_9D8
; ---------------------------------------------------------------------------

loc_94B:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+FDj
		mov	eax, [esi+0Ch]
		push	edi
		push	306h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		mov	eax, [eax]
		sub	eax, 8
		push	eax
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_98A
		push	309h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	87h ; 'á'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_9D7
; ---------------------------------------------------------------------------

loc_98A:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+13Fj
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+110h+var_F8]
		push	edi
		push	0
		push	eax
		call	_AES_unwrap_key
		add	esp, 14h
		test	eax, eax
		jg	short loc_9CC
		push	312h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	9Dh ; 'ù'
		push	87h ; 'á'
		push	2Eh ; '.'
		call	_ERR_put_error
		push	edi
		call	_CRYPTO_free
		add	esp, 18h
		jmp	short loc_9D7
; ---------------------------------------------------------------------------

loc_9CC:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+178j
		mov	[ebp+10h], edi
		mov	ebx, 1
		mov	[ebp+14h], eax

loc_9D7:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+15Cj
					; _cms_RecipientInfo_kekri_decrypt+19Ej
		pop	edi

loc_9D8:				; CODE XREF: _cms_RecipientInfo_kekri_decrypt+DEj
					; _cms_RecipientInfo_kekri_decrypt+11Aj
		lea	eax, [esp+104h+var_F8]
		push	0F4h ; 'Ù'
		push	eax
		call	_OPENSSL_cleanse
		mov	ecx, [esp+10Ch+var_4]
		add	esp, 8
		mov	eax, ebx
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
_cms_RecipientInfo_kekri_decrypt endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A04h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_RecipientInfo_kekri_encrypt proc near ; CODE XREF:	_CMS_RecipientInfo_encrypt+28j

var_F8		= byte ptr -0F8h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 0F8h ; '¯'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+0F8h+var_4], eax
		mov	ecx, [esp+0F8h+arg_4]
		mov	eax, [esp+0F8h+arg_0]
		push	ebx
		push	ebp
		push	edi
		mov	edi, [ecx+4]
		xor	ebx, ebx
		mov	eax, [eax+4]
		mov	ecx, [edi+10h]
		mov	ebp, [eax+0Ch]
		test	ecx, ecx
		jnz	short loc_A77
		push	2B6h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	82h ; 'Ç'
		push	88h ; 'à'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+0F8h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
; ---------------------------------------------------------------------------

loc_A77:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+39j
		lea	eax, [esp+104h+var_F8]
		push	eax
		mov	eax, [edi+14h]
		shl	eax, 3
		push	eax
		push	ecx
		call	_AES_set_encrypt_key
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_AB0
		push	2BCh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	73h ; 's'
		push	88h ; 'à'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	loc_B40
; ---------------------------------------------------------------------------

loc_AB0:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+8Aj
		mov	eax, [ebp+14h]
		push	esi
		push	2C0h
		add	eax, 8
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	eax
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_AED
		push	2C3h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	88h ; 'à'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short loc_B3F
; ---------------------------------------------------------------------------

loc_AED:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+CAj
		push	dword ptr [ebp+14h]
		lea	eax, [esp+10Ch+var_F8]
		push	dword ptr [ebp+10h]
		push	esi
		push	0
		push	eax
		call	_AES_wrap_key
		add	esp, 14h
		test	eax, eax
		jg	short loc_B2D
		push	2CAh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	9Fh ; 'ü'
		push	88h ; 'à'
		push	2Eh ; '.'
		call	_ERR_put_error
		push	esi
		call	_CRYPTO_free
		add	esp, 18h
		jmp	short loc_B3F
; ---------------------------------------------------------------------------

loc_B2D:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+101j
		push	eax
		push	esi
		push	dword ptr [edi+0Ch]
		call	_ASN1_STRING_set0
		add	esp, 0Ch
		mov	ebx, 1

loc_B3F:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+E7j
					; _cms_RecipientInfo_kekri_encrypt+127j
		pop	esi

loc_B40:				; CODE XREF: _cms_RecipientInfo_kekri_encrypt+A7j
		lea	eax, [esp+104h+var_F8]
		push	0F4h ; 'Ù'
		push	eax
		call	_OPENSSL_cleanse
		mov	ecx, [esp+10Ch+var_4]
		add	esp, 8
		mov	eax, ebx
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
_cms_RecipientInfo_kekri_encrypt endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_RecipientInfo_ktri_decrypt	proc near ; CODE XREF: _CMS_RecipientInfo_decrypt+53j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		xor	ebp, ebp
		mov	eax, [eax+4]
		push	edi
		xor	edi, edi
		mov	esi, [esi+4]
		mov	ebx, [eax+0Ch]
		mov	ecx, [esi+14h]
		test	ecx, ecx
		jnz	short loc_BB1
		push	1ADh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	85h ; 'Ö'
		push	8Ch ; 'å'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

loc_BAA:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+55j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_BB1:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+1Ej
		push	0
		push	ecx
		call	_EVP_PKEY_CTX_new
		add	esp, 8
		mov	[esi+18h], eax
		test	eax, eax
		jz	short loc_BAA
		push	eax
		call	_EVP_PKEY_decrypt_init
		add	esp, 4
		test	eax, eax
		jle	$err$16
		push	1
		push	[esp+14h+arg_4]
		call	_cms_env_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	$err$16
		push	[esp+10h+arg_4]
		push	0
		push	0Ah
		push	200h
		push	0FFFFFFFFh
		push	dword ptr [esi+18h]
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_C28
		push	1BDh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Eh ; 'n'
		push	8Ch ; 'å'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	$err$16
; ---------------------------------------------------------------------------

loc_C28:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+9Aj
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+18h+arg_0]
		push	eax
		push	0
		push	dword ptr [esi+18h]
		call	_EVP_PKEY_decrypt
		add	esp, 14h
		test	eax, eax
		jle	$err$16
		push	1C6h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	[esp+18h+arg_0]
		call	_CRYPTO_malloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_C83
		push	1C9h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	8Ch ; 'å'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short $err$16
; ---------------------------------------------------------------------------

loc_C83:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+F8j
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		push	dword ptr [eax+8]
		lea	eax, [esp+18h+arg_0]
		push	eax
		push	edi
		push	dword ptr [esi+18h]
		call	_EVP_PKEY_decrypt
		add	esp, 14h
		test	eax, eax
		jg	short loc_CBD
		push	1D0h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	68h ; 'h'
		push	8Ch ; 'å'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		jmp	short $err$16
; ---------------------------------------------------------------------------

loc_CBD:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+132j
		mov	eax, [ebx+10h]
		mov	ebp, 1
		test	eax, eax
		jz	short loc_CDD
		push	dword ptr [ebx+14h]
		push	eax
		call	_OPENSSL_cleanse
		push	dword ptr [ebx+10h]
		call	_CRYPTO_free
		add	esp, 0Ch

loc_CDD:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+15Bj
		mov	[ebx+10h], edi
		mov	eax, [esp+10h+arg_0]
		mov	[ebx+14h], eax

$err$16:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+62j
					; _cms_RecipientInfo_ktri_decrypt+78j ...
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_CFE
		push	eax
		call	_EVP_PKEY_CTX_free
		add	esp, 4
		mov	dword ptr [esi+18h], 0

loc_CFE:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+180j
		test	ebp, ebp
		jnz	short loc_D0F
		test	edi, edi
		jz	short loc_D0F
		push	edi
		call	_CRYPTO_free
		add	esp, 4

loc_D0F:				; CODE XREF: _cms_RecipientInfo_ktri_decrypt+194j
					; _cms_RecipientInfo_ktri_decrypt+198j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
_cms_RecipientInfo_ktri_decrypt	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D18h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_RecipientInfo_ktri_encrypt	proc near ; CODE XREF: _CMS_RecipientInfo_encrypt+16j

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		push	ebx
		mov	ebx, [esp+8+arg_4]
		push	esi
		xor	esi, esi
		cmp	[ebx], esi
		jz	short loc_D4F
		push	168h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Ch ; '|'
		push	8Dh ; 'ç'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_D4F:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+14j
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		mov	ebp, [ebx+4]
		push	edi
		mov	eax, [eax+4]
		push	0
		mov	edi, [ebp+18h]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_4], eax
		test	edi, edi
		jz	short loc_D7A
		push	ebx
		call	_cms_env_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	short loc_DD2
		jmp	short loc_D9E
; ---------------------------------------------------------------------------

loc_D7A:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+51j
		push	dword ptr [ebp+14h]
		call	_EVP_PKEY_CTX_new
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_D91
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_D91:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+71j
		push	edi
		call	_EVP_PKEY_encrypt_init
		add	esp, 4
		test	eax, eax
		jle	short loc_DD2

loc_D9E:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+60j
		push	ebx
		push	0
		push	9
		push	100h
		push	0FFFFFFFFh
		push	edi
		call	_EVP_PKEY_CTX_ctrl
		add	esp, 18h
		test	eax, eax
		jg	short loc_DF9
		push	17Eh
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Eh ; 'n'

loc_DC3:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+127j
		push	8Dh ; 'ç'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

loc_DD2:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+5Ej
					; _cms_RecipientInfo_ktri_encrypt+84j ...
		xor	ebx, ebx

$err$24_0:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+15Bj
		push	edi
		call	_EVP_PKEY_CTX_free
		add	esp, 4
		mov	dword ptr [ebp+18h], 0
		test	esi, esi
		jz	short loc_DF1
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_DF1:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+CEj
		pop	edi
		pop	ebp
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_DF9:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+9Dj
		mov	ebx, [esp+14h+var_4]
		lea	eax, [esp+14h+arg_4]
		push	dword ptr [ebx+14h]
		push	dword ptr [ebx+10h]
		push	eax
		push	0
		push	edi
		call	_EVP_PKEY_encrypt
		add	esp, 14h
		test	eax, eax
		jle	short loc_DD2
		push	185h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	[esp+1Ch+arg_4]
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_E41
		push	188h
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		jmp	short loc_DC3
; ---------------------------------------------------------------------------

loc_E41:				; CODE XREF: _cms_RecipientInfo_ktri_encrypt+119j
		push	dword ptr [ebx+14h]
		lea	eax, [esp+18h+arg_4]
		push	dword ptr [ebx+10h]
		push	eax
		push	esi
		push	edi
		call	_EVP_PKEY_encrypt
		add	esp, 14h
		test	eax, eax
		jle	loc_DD2
		push	[esp+14h+arg_4]
		push	esi
		push	dword ptr [ebp+0Ch]
		call	_ASN1_STRING_set0
		add	esp, 0Ch
		xor	esi, esi
		lea	ebx, [esi+1]
		jmp	$err$24_0
_cms_RecipientInfo_ktri_encrypt	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_RecipientInfo_ktri_init proc near	; CODE XREF: _CMS_add1_recipient_cert+B2p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	edi
		call	_CMS_KeyTransRecipientInfo_it
		push	eax
		call	_ASN1_item_new
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, eax
		add	esp, 4
		mov	[edi+4], esi
		test	esi, esi
		jnz	short loc_E98
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_E98:				; CODE XREF: _cms_RecipientInfo_ktri_init+1Bj
		test	[esp+8+arg_C], 10000h
		mov	dword ptr [edi], 0
		jz	short loc_EB5
		mov	dword ptr [esi], 2
		mov	eax, 1
		jmp	short loc_EBD
; ---------------------------------------------------------------------------

loc_EB5:				; CODE XREF: _cms_RecipientInfo_ktri_init+2Ej
		mov	dword ptr [esi], 0
		xor	eax, eax

loc_EBD:				; CODE XREF: _cms_RecipientInfo_ktri_init+3Bj
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		push	eax
		push	ebx
		push	dword ptr [esi+4]
		call	_cms_set1_SignerIdentifier
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_F3B
		push	0D2h ; '“'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	3
		lea	eax, [ebx+10h]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	ebx, [esp+20h+arg_8]
		push	0D3h ; '”'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	0Ah
		lea	eax, [ebx+8]
		push	1
		push	eax
		call	_CRYPTO_add_lock
		mov	eax, [esp+34h+arg_4]
		add	esp, 28h
		test	[esp+0Ch+arg_C], 40000h
		mov	[esi+14h], ebx
		mov	[esi+10h], eax
		push	0
		jz	short loc_F41
		push	ebx
		call	_EVP_PKEY_CTX_new
		add	esp, 8
		mov	[esi+18h], eax
		test	eax, eax
		jz	short loc_F3B
		push	eax
		call	_EVP_PKEY_encrypt_init
		add	esp, 4
		test	eax, eax
		jg	short loc_F4E

loc_F3B:				; CODE XREF: _cms_RecipientInfo_ktri_init+59j
					; _cms_RecipientInfo_ktri_init+B4j ...
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_F41:				; CODE XREF: _cms_RecipientInfo_ktri_init+A4j
		push	edi
		call	_cms_env_asn1_ctrl
		add	esp, 8
		test	eax, eax
		jz	short loc_F3B

loc_F4E:				; CODE XREF: _cms_RecipientInfo_ktri_init+C1j
		pop	ebx
		pop	edi
		mov	eax, 1
		pop	esi
		retn
_cms_RecipientInfo_ktri_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F58h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_env_asn1_ctrl
_cms_env_asn1_ctrl proc	near		; CODE XREF: _cms_RecipientInfo_ktri_decrypt+6Ep
					; _cms_RecipientInfo_ktri_encrypt+54p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_F6B
		mov	eax, [esi+4]
		mov	eax, [eax+14h]
		jmp	short loc_F87
; ---------------------------------------------------------------------------

loc_F6B:				; CODE XREF: _cms_env_asn1_ctrl+9j
		cmp	eax, 1
		jnz	short loc_FBF
		mov	eax, [esi+4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_FBF
		push	eax
		call	_EVP_PKEY_CTX_get0_pkey
		add	esp, 4
		test	eax, eax
		jz	short loc_FBF

loc_F87:				; CODE XREF: _cms_env_asn1_ctrl+11j
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_FE3
		mov	ecx, [ecx+58h]
		test	ecx, ecx
		jz	short loc_FE3
		push	esi
		push	[esp+8+arg_4]
		push	7
		push	eax
		call	ecx
		add	esp, 10h
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_FC3
		push	7Bh ; '{'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	7Dh ; '}'
		push	0ABh ; '´'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h

loc_FBF:				; CODE XREF: _cms_env_asn1_ctrl+16j
					; _cms_env_asn1_ctrl+20j ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_FC3:				; CODE XREF: _cms_env_asn1_ctrl+4Dj
		test	eax, eax
		jg	short loc_FE3
		push	7Fh ; ''
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Fh ; 'o'
		push	0ABh ; '´'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_FE3:				; CODE XREF: _cms_env_asn1_ctrl+34j
					; _cms_env_asn1_ctrl+3Bj ...
		mov	eax, 1
		pop	esi
		retn
_cms_env_asn1_ctrl endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FECh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_env_set_originfo_version proc near	; CODE XREF: _cms_env_set_version+Bp

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [ebx+4]
		test	esi, esi
		jz	short loc_1078
		push	edi
		push	dword ptr [esi]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1038
		xchg	ax, ax

loc_100C:				; CODE XREF: _cms_env_set_originfo_version+4Aj
		push	edi
		push	dword ptr [esi]
		call	_sk_value
		add	esp, 8
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_1071
		cmp	eax, 3
		jnz	short loc_1029
		cmp	[ebx], eax
		jge	short loc_1029
		mov	[ebx], eax

loc_1029:				; CODE XREF: _cms_env_set_originfo_version+35j
					; _cms_env_set_originfo_version+39j
		push	dword ptr [esi]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_100C

loc_1038:				; CODE XREF: _cms_env_set_originfo_version+1Cj
		push	dword ptr [esi+4]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_1077
		nop	dword ptr [eax]

loc_104C:				; CODE XREF: _cms_env_set_originfo_version+7Fj
		push	edi
		push	dword ptr [esi+4]
		call	_sk_value
		add	esp, 8
		cmp	dword ptr [eax], 1
		jz	short loc_1071
		push	dword ptr [esi+4]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_104C
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1071:				; CODE XREF: _cms_env_set_originfo_version+30j
					; _cms_env_set_originfo_version+6Fj
		mov	dword ptr [ebx], 4

loc_1077:				; CODE XREF: _cms_env_set_originfo_version+5Bj
		pop	edi

loc_1078:				; CODE XREF: _cms_env_set_originfo_version+Bj
		pop	esi
		pop	ebx
		retn
_cms_env_set_originfo_version endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 107Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_env_set_version proc near		; CODE XREF: _cms_EnvelopedData_init_bio+68p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 4
		jge	short loc_1103
		push	esi
		call	_cms_env_set_originfo_version
		add	esp, 4
		cmp	dword ptr [esi], 3
		jge	short loc_1103
		push	edi
		push	dword ptr [esi+8]
		xor	edi, edi
		call	_sk_num
		add	esp, 4
		test	eax, eax
		jle	short loc_10E5
		nop	word ptr [eax+eax+00h]

loc_10AC:				; CODE XREF: _cms_env_set_version+67j
		push	edi
		push	dword ptr [esi+8]
		call	_sk_value
		add	esp, 8
		mov	ecx, [eax]
		cmp	ecx, 3
		jz	short loc_1105
		cmp	ecx, 4
		jz	short loc_1105
		test	ecx, ecx
		jnz	short loc_10CF
		mov	eax, [eax+4]
		cmp	[eax], ecx
		jz	short loc_10D5

loc_10CF:				; CODE XREF: _cms_env_set_version+4Aj
		mov	dword ptr [esi], 2

loc_10D5:				; CODE XREF: _cms_env_set_version+51j
		push	dword ptr [esi+8]
		inc	edi
		call	_sk_num
		add	esp, 4
		cmp	edi, eax
		jl	short loc_10AC

loc_10E5:				; CODE XREF: _cms_env_set_version+28j
		cmp	dword ptr [esi], 2
		jz	short loc_1102
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10F6
		cmp	dword ptr [esi+10h], 0
		jz	short loc_10FC

loc_10F6:				; CODE XREF: _cms_env_set_version+72j
		mov	dword ptr [esi], 2

loc_10FC:				; CODE XREF: _cms_env_set_version+78j
		mov	dword ptr [esi], 0

loc_1102:				; CODE XREF: _cms_env_set_version+6Cj
		pop	edi

loc_1103:				; CODE XREF: _cms_env_set_version+8j
					; _cms_env_set_version+16j
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1105:				; CODE XREF: _cms_env_set_version+41j
					; _cms_env_set_version+46j
		pop	edi
		mov	dword ptr [esi], 3
		pop	esi
		retn
_cms_env_set_version endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1110h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_cms_enveloped_data_init proc near	; CODE XREF: _CMS_EnvelopedData_create+Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_1176
		call	_CMS_EnvelopedData_it
		push	eax
		call	_ASN1_item_new
		add	esp, 4
		mov	[esi+4], eax
		test	eax, eax
		jnz	short loc_1149
		push	5Ah ; 'Z'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	41h ; 'A'
		push	7Eh ; '~'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1149:				; CODE XREF: _cms_enveloped_data_init+1Ej
		push	15h
		mov	dword ptr [eax], 0
		call	_OBJ_nid2obj
		mov	ecx, [esi+4]
		mov	ecx, [ecx+0Ch]
		mov	[ecx], eax
		push	dword ptr [esi]
		call	_ASN1_OBJECT_free
		push	17h
		call	_OBJ_nid2obj
		add	esp, 0Ch
		mov	[esi], eax

loc_1171:				; CODE XREF: _cms_enveloped_data_init+73j
		mov	eax, [esi+4]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1176:				; CODE XREF: _cms_enveloped_data_init+9j
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 17h
		jz	short loc_1171
		push	4Fh ; 'O'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Bh ; 'k'
		push	83h ; 'É'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
_cms_enveloped_data_init endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_get0_enveloped
_cms_get0_enveloped proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	dword ptr [esi]
		call	_OBJ_obj2nid
		add	esp, 4
		cmp	eax, 17h
		jz	short loc_11D4
		push	4Fh ; 'O'
		push	offset ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ ; ".\\crypto\\cms\\cms_env.c"
		push	6Bh ; 'k'
		push	83h ; 'É'
		push	2Eh ; '.'
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_11D4:				; CODE XREF: _cms_get0_enveloped+12j
		mov	eax, [esi+4]
		pop	esi
		retn
_cms_get0_enveloped endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _cms_pkey_get_ri_type
_cms_pkey_get_ri_type proc near		; CODE XREF: _CMS_add1_recipient_cert+7Dp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jz	short loc_1206
		mov	eax, [eax+58h]
		test	eax, eax
		jz	short loc_1206
		lea	edx, [esp+arg_0]
		push	edx
		push	0
		push	8
		push	ecx
		call	eax
		add	esp, 10h
		test	eax, eax
		jle	short loc_1206
		mov	eax, [esp+arg_0]
		retn
; ---------------------------------------------------------------------------

loc_1206:				; CODE XREF: _cms_pkey_get_ri_type+9j
					; _cms_pkey_get_ri_type+10j ...
		xor	eax, eax
		retn
_cms_pkey_get_ri_type endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 120Ch
; COMDAT (pick any)
		public ??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@
; `string'
??_C@_0BH@EJPGDKGA@?4?2crypto?2cms?2cms_env?4c?$AA@ db '.\crypto\cms\cms_env.c',0
					; DATA XREF: _CMS_EnvelopedData_create+42o
					; _CMS_RecipientInfo_decrypt+1Ao ...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _sk_num:near	; CODE XREF: _cms_EnvelopedData_init_bio+36p
					; _cms_EnvelopedData_init_bio+59p ...
		extrn _sk_value:near	; CODE XREF: _cms_EnvelopedData_init_bio+44p
					; _cms_env_set_originfo_version+23p ...
		extrn _sk_push:near	; CODE XREF: _CMS_add0_recipient_key+F9p
					; _CMS_add1_recipient_cert+C2p
		extrn _CRYPTO_add_lock:near ; CODE XREF: _cms_RecipientInfo_ktri_init+6Dp
					; _cms_RecipientInfo_ktri_init+88p
		extrn _CRYPTO_malloc:near ; CODE XREF: _cms_RecipientInfo_kekri_decrypt+133p
					; _cms_RecipientInfo_kekri_encrypt+BEp	...
		extrn _CRYPTO_free:near	; CODE XREF: _cms_EnvelopedData_init_bio+8Fp
					; _cms_RecipientInfo_kekri_decrypt+196p ...
		extrn _OPENSSL_cleanse:near ; CODE XREF: _cms_EnvelopedData_init_bio+87p
					; _cms_RecipientInfo_kekri_decrypt+1B6p ...
		extrn _BIO_free:near	; CODE XREF: _cms_EnvelopedData_init_bio+D2p
		extrn _ERR_put_error:near ; CODE XREF: _CMS_EnvelopedData_create+4Dp
					; _CMS_RecipientInfo_decrypt+2Bp ...
		extrn _ASN1_OBJECT_free:near ; CODE XREF: _cms_enveloped_data_init+50p
		extrn _ASN1_STRING_set0:near ; CODE XREF: _CMS_add0_recipient_key+126p
					; _cms_RecipientInfo_kekri_encrypt+12Ep ...
		extrn _ASN1_OCTET_STRING_cmp:near
					; CODE XREF: _CMS_RecipientInfo_kekri_id_cmp+63p
		extrn _ASN1_item_new:near ; CODE XREF: _CMS_add0_recipient_key+96p
					; _CMS_add0_recipient_key+AEp ...
		extrn _ASN1_item_free:near ; CODE XREF:	_CMS_add0_recipient_key+20Ap
					; _CMS_add1_recipient_cert+101p
		extrn _OBJ_nid2obj:near	; CODE XREF: _CMS_add0_recipient_key+15Ap
					; _cms_enveloped_data_init+41p	...
		extrn _OBJ_obj2nid:near	; CODE XREF: _CMS_add0_recipient_key+Ap
					; _CMS_add1_recipient_cert+Cp ...
		extrn _EVP_PKEY_free:near ; CODE XREF: _CMS_add1_recipient_cert+CFp
					; _CMS_add1_recipient_cert+10Ep
		extrn _EVP_PKEY_CTX_new:near
					; CODE XREF: _cms_RecipientInfo_ktri_decrypt+48p
					; _cms_RecipientInfo_ktri_encrypt+65p ...
		extrn _EVP_PKEY_CTX_free:near
					; CODE XREF: _cms_RecipientInfo_ktri_decrypt+183p
					; _cms_RecipientInfo_ktri_encrypt+BDp
		extrn _EVP_PKEY_CTX_ctrl:near
					; CODE XREF: _cms_RecipientInfo_ktri_decrypt+90p
					; _cms_RecipientInfo_ktri_encrypt+93p
		extrn _EVP_PKEY_CTX_get0_pkey:near ; CODE XREF:	_cms_env_asn1_ctrl+23p
		extrn _EVP_PKEY_encrypt_init:near
					; CODE XREF: _cms_RecipientInfo_ktri_encrypt+7Ap
					; _cms_RecipientInfo_ktri_init+B7p
		extrn _EVP_PKEY_encrypt:near
					; CODE XREF: _cms_RecipientInfo_ktri_encrypt+F3p
					; _cms_RecipientInfo_ktri_encrypt+136p
		extrn _EVP_PKEY_decrypt_init:near
					; CODE XREF: _cms_RecipientInfo_ktri_decrypt+58p
		extrn _EVP_PKEY_decrypt:near
					; CODE XREF: _cms_RecipientInfo_ktri_decrypt+CEp
					; _cms_RecipientInfo_ktri_decrypt+128p
		extrn _X509_ALGOR_set0:near ; CODE XREF: _CMS_add0_recipient_key+166p
		extrn _X509_get_pubkey:near ; CODE XREF: _CMS_add1_recipient_cert+60p
		extrn _CMS_ContentInfo_new:near	; CODE XREF: _CMS_EnvelopedData_create+1p
		extrn _CMS_ContentInfo_free:near ; CODE	XREF: _CMS_EnvelopedData_create+35p
		extrn _AES_set_encrypt_key:near
					; CODE XREF: _cms_RecipientInfo_kekri_encrypt+80p
		extrn _AES_set_decrypt_key:near
					; CODE XREF: _cms_RecipientInfo_kekri_decrypt+F3p
		extrn _AES_wrap_key:near ; CODE	XREF: _cms_RecipientInfo_kekri_encrypt+F7p
		extrn _AES_unwrap_key:near
					; CODE XREF: _cms_RecipientInfo_kekri_decrypt+16Ep
		extrn _CMS_RecipientInfo_it:near
					; CODE XREF: _CMS_add0_recipient_key:loc_434p
					; _CMS_add0_recipient_key+203p	...
		extrn _cms_set1_SignerIdentifier:near
					; CODE XREF: _cms_RecipientInfo_ktri_init+4Fp
		extrn _cms_SignerIdentifier_get0_signer_id:near
					; CODE XREF: _CMS_RecipientInfo_ktri_get0_signer_id+39p
		extrn _cms_SignerIdentifier_cert_cmp:near
					; CODE XREF: _CMS_RecipientInfo_ktri_cert_cmp+34p
		extrn _cms_EncryptedContent_init_bio:near
					; CODE XREF: _cms_EnvelopedData_init_bio+Dp
		extrn _cms_EncryptedContent_init:near
					; CODE XREF: _CMS_EnvelopedData_create+24p
		extrn _cms_RecipientInfo_kari_init:near
					; CODE XREF: _CMS_add1_recipient_cert+A4p
		extrn _cms_RecipientInfo_kari_encrypt:near
					; CODE XREF: _CMS_RecipientInfo_encrypt+1Fj
		extrn _cms_RecipientInfo_pwri_crypt:near
					; CODE XREF: _CMS_RecipientInfo_decrypt+3Dp
					; _CMS_RecipientInfo_encrypt+34p
		extrn _CMS_EnvelopedData_it:near ; CODE	XREF: _cms_enveloped_data_init+Bp
		extrn _CMS_KeyTransRecipientInfo_it:near
					; CODE XREF: _cms_RecipientInfo_ktri_init+2p
		extrn _CMS_KEKRecipientInfo_it:near ; CODE XREF: _CMS_add0_recipient_key+A8p
		extrn _CMS_OtherKeyAttribute_it:near
					; CODE XREF: _CMS_add0_recipient_key+D0p
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _cms_RecipientInfo_kekri_decrypt+65p
					; _cms_RecipientInfo_kekri_decrypt+1CCp ...
		extrn __chkstk:near	; CODE XREF: _CMS_RecipientInfo_kekri_id_cmp+5p
					; _cms_RecipientInfo_kekri_decrypt+5p ...
		extrn ___security_cookie:near
					; DATA XREF: _cms_RecipientInfo_kekri_decrypt+Ar
					; _cms_RecipientInfo_kekri_encrypt+Ar


		end
