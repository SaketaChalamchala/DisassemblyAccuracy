;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	43F9D8A35587E2D72731C46F3D100A4B
; Input	CRC32 :	254D95EB

; File Name   :	C:\compspace\Diff\openssl\obj\s3_enc.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
_ssl3_pad_1	dd 0Ch dup(36363636h)	; DATA XREF: _n_ssl3_mac+102o
					; _n_ssl3_mac+1D6o ...
_ssl3_pad_2	dd 0Ch dup(5C5C5C5Ch)	; DATA XREF: _n_ssl3_mac+2A6o
					; _ssl3_handshake_mac+1E0o
; `ssl3_generate_master_secret'::`2'::salt
?salt@?1??ssl3_generate_master_secret@@9@9 dd offset ??_C@_01FHEEJDEE@A?$AA@
					; DATA XREF: _ssl3_generate_master_secret+38o
					; `string'
		dd offset ??_C@_02LBOPFCME@BB?$AA@ ; `string'
		dd offset ??_C@_03POJCPIGP@CCC?$AA@
					; DATA XREF: _ssl3_generate_master_secret+188o
_data		ends			; `string'

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 6Ch
; COMDAT (pick any)
		public ??_C@_01FHEEJDEE@A?$AA@
; `string'
??_C@_01FHEEJDEE@A?$AA@	db 41h,	0	; DATA XREF: .data:`ssl3_generate_master_secret'::`2'::salto
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 70h
; COMDAT (pick any)
		public ??_C@_02LBOPFCME@BB?$AA@
; `string'
??_C@_02LBOPFCME@BB?$AA@ db 2 dup(42h),	0 ; DATA XREF: .data:00000064o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 74h
; COMDAT (pick any)
		public ??_C@_03POJCPIGP@CCC?$AA@
; `string'
??_C@_03POJCPIGP@CCC?$AA@ dd 434343h	; DATA XREF: .data:00000068o
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 78h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _n_ssl3_mac
_n_ssl3_mac	proc near

var_7D		= byte ptr -7Dh
Size		= dword	ptr -7Ch
Src		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
Dst		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_47		= byte ptr -47h
var_46		= byte ptr -46h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 80h ; 'Ä'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+80h+var_4], eax
		cmp	[esp+80h+arg_8], 0
		push	ebx
		mov	ebx, [esp+84h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+8Ch+arg_0]
		push	edi
		mov	eax, [esi+58h]
		jz	short loc_C0
		mov	ebp, [esi+90h]
		lea	edi, [eax+130h]
		lea	ecx, [eax+60h]
		add	eax, 54h ; 'T'
		jmp	short loc_D2
; ---------------------------------------------------------------------------

loc_C0:					; CODE XREF: _n_ssl3_mac+32j
		mov	ebp, [esi+84h]
		lea	edi, [eax+10Ch]
		lea	ecx, [eax+14h]
		add	eax, 8

loc_D2:					; CODE XREF: _n_ssl3_mac+46j
		push	ebp
		mov	[esp+94h+var_6C], eax
		mov	[esp+94h+Src], ecx
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		mov	ecx, eax
		add	esp, 8
		mov	[esp+90h+var_74], ecx
		test	ecx, ecx
		js	loc_38E
		xor	edx, edx
		mov	[esp+90h+Size],	ecx
		mov	eax, 30h ; '0'
		div	ecx
		imul	eax, ecx
		mov	ecx, [edi]
		mov	[esp+90h+var_70], eax
		mov	eax, ecx
		shr	eax, 8
		add	eax, [esp+90h+var_74]
		add	eax, [edi+4]
		cmp	[esp+90h+arg_8], 0
		mov	[esp+90h+var_74], eax
		movzx	eax, cl
		mov	[edi], eax
		jnz	loc_1F8
		push	dword ptr [esi+80h]
		call	_EVP_CIPHER_CTX_flags
		and	eax, 0F0007h
		add	esp, 4
		cmp	eax, 2
		jnz	loc_1F8
		push	ebp
		call	_ssl3_cbc_record_digest_supported
		add	esp, 4
		test	al, al
		jz	loc_1F8
		mov	esi, [esp+90h+Size]
		lea	eax, [esp+90h+Dst]
		push	esi		; Size
		push	[esp+94h+Src]	; Src
		push	eax		; Dst
		call	_memcpy
		push	[esp+9Ch+var_70] ; Size
		lea	eax, [esp+0A0h+Dst]
		add	eax, esi
		push	offset _ssl3_pad_1 ; Src
		push	eax		; Dst
		call	_memcpy
		mov	ecx, [esp+0A8h+var_6C]
		mov	edx, [esp+0A8h+var_70]
		add	edx, esi
		push	1
		mov	eax, [ecx]
		push	esi
		push	[esp+0B0h+Src]
		mov	[esp+edx+0B4h+Dst], eax
		mov	eax, [ecx+4]
		mov	ecx, [edi+4]
		push	[esp+0B4h+var_74]
		mov	[esp+edx+0B8h+var_4C], eax
		mov	al, [edi]
		mov	[esp+edx+0B8h+var_48], al
		mov	eax, ecx
		shr	eax, 8
		mov	[esp+edx+0B8h+var_47], al
		mov	al, cl
		mov	[esp+edx+0B8h+var_46], al
		lea	eax, [ecx+esi]
		push	eax
		push	dword ptr [edi+10h]
		lea	eax, [esp+0C0h+Dst]
		push	eax
		lea	eax, [esp+0C4h+Size]
		push	eax
		push	ebx
		push	ebp
		call	_ssl3_cbc_digest_record
		add	esp, 40h
		test	eax, eax
		jle	loc_38E
		mov	esi, [esp+90h+var_6C]
		push	esi
		call	_ssl3_record_sequence_update
		mov	eax, [esp+94h+Size]
		add	esp, 4
		jmp	loc_391
; ---------------------------------------------------------------------------

loc_1F8:				; CODE XREF: _n_ssl3_mac+B2j
					; _n_ssl3_mac+CEj ...
		lea	eax, [esp+90h+var_68]
		push	eax
		call	_EVP_MD_CTX_init
		mov	al, [edi]
		mov	[esp+94h+var_7D], al
		mov	al, [edi+5]
		mov	[ebx], al
		mov	al, [edi+4]
		mov	[ebx+1], al
		lea	eax, [esp+94h+var_68]
		push	ebp
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	[esp+90h+Size]
		lea	eax, [esp+94h+var_68]
		push	[esp+94h+Src]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	[esp+90h+var_70]
		lea	eax, [esp+94h+var_68]
		push	offset _ssl3_pad_1
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		mov	esi, [esp+90h+var_6C]
		lea	eax, [esp+90h+var_68]
		push	8
		push	esi
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	1
		lea	eax, [esp+94h+var_7D]
		push	eax
		lea	eax, [esp+98h+var_68]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	2
		lea	eax, [esp+94h+var_68]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	dword ptr [edi+4]
		lea	eax, [esp+94h+var_68]
		push	dword ptr [edi+10h]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		push	0
		lea	eax, [esp+94h+var_68]
		push	ebx
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_381
		lea	eax, [esp+90h+var_68]
		push	ebp
		push	eax
		call	_EVP_MD_CTX_copy_ex
		add	esp, 8
		test	eax, eax
		jle	loc_381
		push	[esp+90h+Size]
		lea	eax, [esp+94h+var_68]
		push	[esp+94h+Src]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_381
		push	[esp+90h+var_70]
		lea	eax, [esp+94h+var_68]
		push	offset _ssl3_pad_2
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_381
		push	[esp+90h+Size]
		lea	eax, [esp+94h+var_68]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_381
		lea	eax, [esp+90h+var_74]
		push	eax
		lea	eax, [esp+94h+var_68]
		push	ebx
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_381
		mov	eax, [esp+90h+var_74]
		mov	[esp+90h+Size],	eax
		lea	eax, [esp+90h+var_68]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		push	esi
		call	_ssl3_record_sequence_update
		mov	eax, [esp+94h+Size]
		add	esp, 4
		jmp	short loc_391
; ---------------------------------------------------------------------------

loc_381:				; CODE XREF: _n_ssl3_mac+1ABj
					; _n_ssl3_mac+1C8j ...
		lea	eax, [esp+90h+var_68]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4

loc_38E:				; CODE XREF: _n_ssl3_mac+79j
					; _n_ssl3_mac+164j
		or	eax, 0FFFFFFFFh

loc_391:				; CODE XREF: _n_ssl3_mac+17Bj
					; _n_ssl3_mac+307j
		mov	ecx, [esp+90h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 80h
		retn
_n_ssl3_mac	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 3ACh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_alert_code
_ssl3_alert_code proc near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 73h ; 's'  ; switch 116 cases
		ja	short $LN35	; jumptable 000003BC default case
		movzx	eax, ds:$LN37[eax]
		jmp	ds:$LN40[eax*4]	; switch jump
; ---------------------------------------------------------------------------

$LN4:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		xor	eax, eax	; jumptable 000003BC case 0
		retn
; ---------------------------------------------------------------------------

$LN5:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 0Ah	; jumptable 000003BC case 10
		retn
; ---------------------------------------------------------------------------

$LN6:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 14h	; jumptable 000003BC cases 20-22
		retn
; ---------------------------------------------------------------------------

$LN9:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 1Eh	; jumptable 000003BC case 30
		retn
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 28h ; '('  ; jumptable 000003BC cases 40,49-51,60,70,71,80,90,110-114
		retn
; ---------------------------------------------------------------------------

$LN11:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 29h ; ')'  ; jumptable 000003BC case 41
		retn
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Ah ; '*'  ; jumptable 000003BC cases 42,48
		retn
; ---------------------------------------------------------------------------

$LN13:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Bh ; '+'  ; jumptable 000003BC case 43
		retn
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Ch ; ','  ; jumptable 000003BC case 44
		retn
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Dh ; '-'  ; jumptable 000003BC case 45
		retn
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Eh ; '.'  ; jumptable 000003BC case 46
		retn
; ---------------------------------------------------------------------------

$LN17:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 2Fh ; '/'  ; jumptable 000003BC case 47
		retn
; ---------------------------------------------------------------------------

$LN33:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 73h ; 's'  ; jumptable 000003BC case 115
		retn
; ---------------------------------------------------------------------------

$LN34:					; CODE XREF: _ssl3_alert_code+10j
					; DATA XREF: .text$mn:$LN40o
		mov	eax, 56h ; 'V'  ; jumptable 000003BC case 86
		retn
; ---------------------------------------------------------------------------

$LN35:					; CODE XREF: _ssl3_alert_code+7j
					; _ssl3_alert_code+10j
					; DATA XREF: ...
		or	eax, 0FFFFFFFFh	; jumptable 000003BC default case
		retn
_ssl3_alert_code endp

; ---------------------------------------------------------------------------
$LN40		dd offset $LN4,	offset $LN5, offset $LN6, offset $LN9
					; DATA XREF: _ssl3_alert_code+10r
		dd offset $LN10, offset	$LN11, offset $LN12, offset $LN13 ; jump table for switch statement
		dd offset $LN14, offset	$LN15, offset $LN16, offset $LN17
		dd offset $LN34, offset	$LN35, offset $LN33, offset $LN35
$LN37		db	0,   0Fh,   0Fh,   0Fh ; DATA XREF: _ssl3_alert_code+9r
		db    0Fh,   0Fh,   0Fh,   0Fh ; indirect table	for switch statement
		db    0Fh,   0Fh,     1,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db	2,     2,     2,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,     3,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db	4,     5,     6,     7
		db	8,     9,   0Ah,   0Bh
		db	6,     4,     4,     4
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db	4,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,     4,     4
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db	4,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Ch,   0Fh
		db    0Fh,   0Fh,     4,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Dh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,   0Fh,   0Fh
		db    0Fh,   0Fh,     4,     4
		db	4,     4,     4,   0Eh
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_cert_verify_mac
_ssl3_cert_verify_mac proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_8]
		push	0
		push	0
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_ssl3_handshake_mac
		add	esp, 14h
		retn
_ssl3_cert_verify_mac endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 4E8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_change_cipher_state
_ssl3_change_cipher_state proc near

var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
Src		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_54		= byte ptr -54h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 90h ; 'ê'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+90h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+9Ch+arg_0]
		push	edi
		mov	[esp+0A0h+var_8C], 0
		mov	ecx, [esi+58h]
		mov	eax, [ecx+344h]
		mov	ebp, [ecx+380h]
		mov	eax, [eax+20h]
		and	eax, 2
		mov	[esp+0A0h+var_7C], eax
		mov	eax, [ecx+37Ch]
		mov	[esp+0A0h+var_88], eax
		test	ebp, ebp
		jnz	short loc_551
		push	offset ??_C@_01GOHFPIOK@m?$AA@ ; `string'
		push	0EBh ; 'Î'
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		call	_OpenSSLDie
		add	esp, 0Ch

loc_551:				; CODE XREF: _ssl3_change_cipher_state+50j
		mov	eax, [esi+58h]
		mov	edi, [eax+38Ch]
		test	edi, edi
		jz	short loc_561
		mov	edi, [edi+8]

loc_561:				; CODE XREF: _ssl3_change_cipher_state+74j
		test	byte ptr [esp+0A0h+arg_4], 1
		jz	loc_69B
		cmp	dword ptr [esi+80h], 0
		jz	short loc_582
		mov	[esp+0A0h+var_8C], 1
		jmp	short loc_5B0
; ---------------------------------------------------------------------------

loc_582:				; CODE XREF: _ssl3_change_cipher_state+8Ej
		push	0F7h ; '˜'
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	8Ch ; 'å'
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+80h], eax
		test	eax, eax
		jz	$err$48
		push	eax
		call	_EVP_CIPHER_CTX_init
		add	esp, 4

loc_5B0:				; CODE XREF: _ssl3_change_cipher_state+98j
		mov	eax, [esi+80h]
		mov	[esp+0A0h+var_84], eax
		lea	eax, [esi+84h]
		push	ebp
		push	eax
		call	_ssl_replace_hash
		add	esp, 8
		test	eax, eax
		jnz	short loc_5DC
		push	101h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		jmp	short loc_623
; ---------------------------------------------------------------------------

loc_5DC:				; CODE XREF: _ssl3_change_cipher_state+E4j
		mov	eax, [esi+88h]
		test	eax, eax
		jz	short loc_5F9
		push	eax
		call	_COMP_CTX_free
		add	esp, 4
		mov	dword ptr [esi+88h], 0

loc_5F9:				; CODE XREF: _ssl3_change_cipher_state+FCj
		test	edi, edi
		jz	loc_685
		push	edi
		call	_COMP_CTX_new
		add	esp, 4
		mov	[esi+88h], eax
		test	eax, eax
		jnz	short loc_64D
		push	10Eh

loc_619:				; CODE XREF: _ssl3_change_cipher_state+269j
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	8Eh ; 'é'

loc_623:				; CODE XREF: _ssl3_change_cipher_state+F2j
					; _ssl3_change_cipher_state+1F3j ...
		push	81h ; 'Å'
		push	14h
		call	_ERR_put_error
		add	esp, 14h

$err2$49:				; CODE XREF: _ssl3_change_cipher_state+2ACj
		xor	eax, eax

loc_634:				; CODE XREF: _ssl3_change_cipher_state+4DCj
		mov	ecx, [esp+0A0h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_64D:				; CODE XREF: _ssl3_change_cipher_state+12Aj
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+120h], 0
		jnz	short loc_679
		push	113h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	4000h
		call	_CRYPTO_malloc
		mov	ecx, [esi+58h]
		add	esp, 0Ch
		mov	[ecx+120h], eax

loc_679:				; CODE XREF: _ssl3_change_cipher_state+16Fj
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+120h], 0
		jz	short $err$48

loc_685:				; CODE XREF: _ssl3_change_cipher_state+113j
		mov	eax, [esi+58h]
		xorps	xmm0, xmm0
		movq	qword ptr [eax+8], xmm0
		mov	ebx, [esi+58h]
		add	ebx, 14h
		jmp	loc_767
; ---------------------------------------------------------------------------

loc_69B:				; CODE XREF: _ssl3_change_cipher_state+81j
		cmp	dword ptr [esi+8Ch], 0
		jz	short loc_6AE
		mov	[esp+0A0h+var_8C], 1
		jmp	short loc_6E9
; ---------------------------------------------------------------------------

loc_6AE:				; CODE XREF: _ssl3_change_cipher_state+1BAj
		push	11Eh
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	8Ch ; 'å'
		call	_CRYPTO_malloc
		add	esp, 0Ch
		mov	[esi+8Ch], eax
		test	eax, eax
		jnz	short loc_6E0

$err$48:				; CODE XREF: _ssl3_change_cipher_state+B9j
					; _ssl3_change_cipher_state+19Bj
		push	195h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	41h ; 'A'
		jmp	loc_623
; ---------------------------------------------------------------------------

loc_6E0:				; CODE XREF: _ssl3_change_cipher_state+1E5j
		push	eax
		call	_EVP_CIPHER_CTX_init
		add	esp, 4

loc_6E9:				; CODE XREF: _ssl3_change_cipher_state+1C4j
		mov	eax, [esi+8Ch]
		mov	[esp+0A0h+var_84], eax
		lea	eax, [esi+90h]
		push	ebp
		push	eax
		call	_ssl_replace_hash
		add	esp, 8
		test	eax, eax
		jnz	short loc_718
		push	127h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		jmp	loc_623
; ---------------------------------------------------------------------------

loc_718:				; CODE XREF: _ssl3_change_cipher_state+21Dj
		mov	eax, [esi+94h]
		test	eax, eax
		jz	short loc_735
		push	eax
		call	_COMP_CTX_free
		add	esp, 4
		mov	dword ptr [esi+94h], 0

loc_735:				; CODE XREF: _ssl3_change_cipher_state+238j
		test	edi, edi
		jz	short loc_756
		push	edi
		call	_COMP_CTX_new
		add	esp, 4
		mov	[esi+94h], eax
		test	eax, eax
		jnz	short loc_756
		push	134h
		jmp	loc_619
; ---------------------------------------------------------------------------

loc_756:				; CODE XREF: _ssl3_change_cipher_state+24Fj
					; _ssl3_change_cipher_state+262j
		mov	eax, [esi+58h]
		xorps	xmm0, xmm0
		movq	qword ptr [eax+54h], xmm0
		mov	ebx, [esi+58h]
		add	ebx, 60h ; '`'

loc_767:				; CODE XREF: _ssl3_change_cipher_state+1AEj
		cmp	[esp+0A0h+var_8C], 0
		jz	short loc_77A
		push	[esp+0A0h+var_84]
		call	_EVP_CIPHER_CTX_cleanup
		add	esp, 4

loc_77A:				; CODE XREF: _ssl3_change_cipher_state+284j
		mov	eax, [esi+58h]
		push	ebp
		mov	eax, [eax+378h]
		mov	[esp+0A4h+var_90], eax
		call	_EVP_MD_size
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		js	$err2$49
		push	[esp+0A0h+var_88]
		call	_EVP_CIPHER_key_length
		add	esp, 4
		mov	edi, eax
		cmp	[esp+0A0h+var_7C], 0
		jz	short loc_7EC
		mov	ecx, [esi+58h]
		mov	edx, [ecx+344h]
		mov	ecx, [edx+20h]
		and	ecx, 8
		jz	short loc_7C7
		mov	eax, 5
		jmp	short loc_7D2
; ---------------------------------------------------------------------------

loc_7C7:				; CODE XREF: _ssl3_change_cipher_state+2D6j
		mov	eax, [edx+14h]
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 8

loc_7D2:				; CODE XREF: _ssl3_change_cipher_state+2DDj
		cmp	edi, eax
		jl	short loc_7EC
		test	ecx, ecx
		jz	short loc_7E1
		mov	edi, 5
		jmp	short loc_7EC
; ---------------------------------------------------------------------------

loc_7E1:				; CODE XREF: _ssl3_change_cipher_state+2F0j
		mov	edi, [edx+14h]
		dec	edi
		neg	edi
		sbb	edi, edi
		add	edi, 8

loc_7EC:				; CODE XREF: _ssl3_change_cipher_state+2C5j
					; _ssl3_change_cipher_state+2ECj ...
		push	[esp+0A0h+var_88]
		call	_EVP_CIPHER_iv_length
		mov	edx, eax
		add	esp, 4
		mov	eax, [esp+0A0h+arg_4]
		mov	[esp+0A0h+var_70], edx
		cmp	eax, 12h
		jz	short loc_848
		cmp	eax, 21h ; '!'
		jz	short loc_848
		mov	eax, [esp+0A0h+var_90]
		lea	ecx, [eax+ebp]
		mov	[esp+0A0h+Src],	ecx
		lea	ecx, [edi+ebp*2]
		lea	edx, [ecx+eax]
		mov	[esp+0A0h+var_8C], edx
		mov	edx, [esp+0A0h+var_70]
		lea	eax, [edx+edi]
		add	ecx, eax
		mov	eax, [esi+58h]
		add	[esp+0A0h+var_90], ecx
		add	ecx, edx
		lea	edx, [eax+0A0h]
		mov	[esp+0A0h+var_78], edx
		lea	edx, [eax+0C0h]
		jmp	short loc_87A
; ---------------------------------------------------------------------------

loc_848:				; CODE XREF: _ssl3_change_cipher_state+320j
					; _ssl3_change_cipher_state+325j
		mov	ecx, [esp+0A0h+var_90]
		lea	eax, ds:0[ebp*2]
		mov	[esp+0A0h+Src],	ecx
		add	ecx, eax
		lea	eax, [eax+edi*2]
		mov	[esp+0A0h+var_8C], ecx
		add	[esp+0A0h+var_90], eax
		lea	ecx, [eax+edx*2]
		mov	eax, [esi+58h]
		lea	edx, [eax+0C0h]
		mov	[esp+0A0h+var_78], edx
		lea	edx, [eax+0A0h]

loc_87A:				; CODE XREF: _ssl3_change_cipher_state+35Ej
		mov	[esp+0A0h+var_74], edx
		cmp	ecx, [eax+374h]
		jle	short loc_897
		push	160h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		jmp	loc_623
; ---------------------------------------------------------------------------

loc_897:				; CODE XREF: _ssl3_change_cipher_state+39Cj
		lea	eax, [esp+0A0h+var_6C]
		push	eax
		call	_EVP_MD_CTX_init
		push	ebp		; Size
		push	[esp+0A8h+Src]	; Src
		push	ebx		; Dst
		call	_memcpy
		add	esp, 10h
		cmp	[esp+0A0h+var_7C], 0
		jz	loc_96B
		push	0
		call	_EVP_md5
		push	eax
		lea	eax, [esp+0A8h+var_6C]
		push	eax
		call	_EVP_DigestInit_ex
		push	edi
		push	[esp+0B0h+var_8C]
		lea	eax, [esp+0B4h+var_6C]
		push	eax
		call	_EVP_DigestUpdate
		mov	edi, [esp+0B8h+var_78]
		lea	eax, [esp+0B8h+var_6C]
		push	20h ; ' '
		push	edi
		push	eax
		call	_EVP_DigestUpdate
		mov	ebx, [esp+0C4h+var_74]
		lea	eax, [esp+0C4h+var_6C]
		push	20h ; ' '
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		push	0
		lea	eax, [esp+0D4h+var_44]
		push	eax
		lea	eax, [esp+0D8h+var_6C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 3Ch
		lea	eax, [esp+0A0h+var_44]
		cmp	[esp+0A0h+var_70], 0
		mov	[esp+0A0h+var_8C], eax
		jle	short loc_96B
		push	0
		call	_EVP_md5
		push	eax
		lea	eax, [esp+0A8h+var_6C]
		push	eax
		call	_EVP_DigestInit_ex
		push	20h ; ' '
		lea	eax, [esp+0B0h+var_6C]
		push	edi
		push	eax
		call	_EVP_DigestUpdate
		push	20h ; ' '
		lea	eax, [esp+0BCh+var_6C]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		push	0
		lea	eax, [esp+0C8h+var_54]
		push	eax
		lea	eax, [esp+0CCh+var_6C]
		push	eax
		call	_EVP_DigestFinal_ex
		lea	eax, [esp+0D0h+var_54]
		add	esp, 30h
		mov	[esp+0A0h+var_90], eax

loc_96B:				; CODE XREF: _ssl3_change_cipher_state+3CCj
					; _ssl3_change_cipher_state+439j
		mov	eax, [esi+0C0h]
		mov	dword ptr [eax+4], 0
		mov	eax, [esp+0A0h+arg_4]
		and	eax, 2
		push	eax
		push	[esp+0A4h+var_90]
		push	[esp+0A8h+var_8C]
		push	0
		push	[esp+0B0h+var_88]
		push	[esp+0B4h+var_84]
		call	_EVP_CipherInit_ex
		lea	eax, [esp+0B8h+var_44]
		push	40h ; '@'
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+0C0h+var_54]
		push	10h
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+0C8h+var_6C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 2Ch
		mov	eax, 1
		jmp	loc_634
_ssl3_change_cipher_state endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 9CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_cleanup_key_block
_ssl3_cleanup_key_block	proc near	; CODE XREF: _ssl3_setup_key_block+CEp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+58h]
		mov	ecx, [eax+378h]
		test	ecx, ecx
		jz	short loc_A0B
		push	dword ptr [eax+374h]
		push	ecx
		call	_OPENSSL_cleanse
		mov	eax, [esi+58h]
		push	dword ptr [eax+378h]
		call	_CRYPTO_free
		mov	eax, [esi+58h]
		add	esp, 0Ch
		mov	dword ptr [eax+378h], 0
		mov	eax, [esi+58h]

loc_A0B:				; CODE XREF: _ssl3_cleanup_key_block+10j
		mov	dword ptr [eax+374h], 0
		pop	esi
		retn
_ssl3_cleanup_key_block	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A18h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_digest_cached_records
_ssl3_digest_cached_records proc near	; CODE XREF: _ssl3_handshake_mac+34p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 8
		call	__chkstk
		push	ebx
		push	edi
		mov	edi, [esp+10h+arg_0]
		push	edi
		call	_ssl3_free_digest_list
		push	261h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	18h
		call	_CRYPTO_malloc
		mov	ecx, [edi+58h]
		xorps	xmm0, xmm0
		mov	[ecx+17Ch], eax
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		movups	xmmword	ptr [eax], xmm0
		movq	qword ptr [eax+10h], xmm0
		lea	eax, [esp+20h+var_4]
		push	eax
		mov	eax, [edi+58h]
		push	0
		push	3
		push	dword ptr [eax+178h]
		call	_BIO_ctrl
		mov	ebx, eax
		add	esp, 20h
		test	ebx, ebx
		jg	short loc_AA2
		push	265h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	14Ch
		push	125h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_AA2:				; CODE XREF: _ssl3_digest_cached_records+62j
		push	esi
		lea	eax, [esp+14h+arg_0]
		xor	esi, esi
		push	eax
		lea	eax, [esp+18h+var_8]
		push	eax
		push	esi
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jz	loc_B45

loc_AC0:				; CODE XREF: _ssl3_digest_cached_records+127j
		push	edi
		call	_ssl_get_algorithm2
		add	esp, 4
		test	[esp+14h+var_8], eax
		jz	short loc_B19
		cmp	[esp+14h+arg_0], 0
		jz	short loc_B19
		call	_EVP_MD_CTX_create
		mov	ecx, [edi+58h]
		push	0
		mov	ecx, [ecx+17Ch]
		mov	[ecx+esi*4], eax
		mov	eax, [edi+58h]
		push	[esp+18h+arg_0]
		mov	eax, [eax+17Ch]
		push	dword ptr [eax+esi*4]
		call	_EVP_DigestInit_ex
		mov	eax, [edi+58h]
		push	ebx
		push	[esp+24h+var_4]
		mov	eax, [eax+17Ch]
		push	dword ptr [eax+esi*4]
		call	_EVP_DigestUpdate
		add	esp, 18h
		jmp	short loc_B29
; ---------------------------------------------------------------------------

loc_B19:				; CODE XREF: _ssl3_digest_cached_records+B5j
					; _ssl3_digest_cached_records+BCj
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		mov	dword ptr [eax+esi*4], 0

loc_B29:				; CODE XREF: _ssl3_digest_cached_records+FFj
		lea	eax, [esp+14h+arg_0]
		inc	esi
		push	eax
		lea	eax, [esp+18h+var_8]
		push	eax
		push	esi
		call	_ssl_get_handshake_digest
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_AC0

loc_B45:				; CODE XREF: _ssl3_digest_cached_records+A2j
		mov	eax, [edi+58h]
		pop	esi
		test	byte ptr [eax],	20h
		jnz	short loc_B69
		push	dword ptr [eax+178h]
		call	_BIO_free
		mov	eax, [edi+58h]
		add	esp, 4
		mov	dword ptr [eax+178h], 0

loc_B69:				; CODE XREF: _ssl3_digest_cached_records+134j
		pop	edi
		mov	eax, 1
		pop	ebx
		add	esp, 8
		retn
_ssl3_digest_cached_records endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B74h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_enc
_ssl3_enc	proc near

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, 4
		call	__chkstk
		cmp	[esp+4+arg_4], 0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_0]
		mov	esi, [edi+58h]
		jz	short loc_B9E
		mov	ebp, [edi+8Ch]
		add	esi, 130h
		jmp	short loc_BAA
; ---------------------------------------------------------------------------

loc_B9E:				; CODE XREF: _ssl3_enc+1Aj
		mov	ebp, [edi+80h]
		add	esi, 10Ch

loc_BAA:				; CODE XREF: _ssl3_enc+28j
		test	ebp, ebp
		jnz	short loc_BB2
		xor	eax, eax
		jmp	short loc_BBB
; ---------------------------------------------------------------------------

loc_BB2:				; CODE XREF: _ssl3_enc+38j
		push	ebp
		call	_EVP_CIPHER_CTX_cipher
		add	esp, 4

loc_BBB:				; CODE XREF: _ssl3_enc+3Cj
		cmp	dword ptr [edi+0C0h], 0
		jz	loc_CB6
		test	ebp, ebp
		jz	loc_CB6
		test	eax, eax
		jz	loc_CB6
		mov	eax, [esi+4]
		push	dword ptr [ebp+0]
		mov	[esp+18h+arg_0], eax
		call	_EVP_CIPHER_block_size
		mov	ecx, [esp+18h+arg_0]
		mov	ebx, eax
		add	esp, 4
		mov	[esp+14h+var_4], ebx
		cmp	ebx, 1
		jz	short loc_C33
		cmp	[esp+14h+arg_4], 0
		jz	short loc_C3A
		mov	eax, ecx
		cdq
		idiv	ebx
		mov	eax, [esi+10h]
		add	eax, [esi+4]
		sub	ebx, edx
		push	ebx		; Size
		add	ecx, ebx
		push	0		; Val
		push	eax		; Dst
		mov	[esp+20h+arg_0], ecx
		call	_memset
		add	[esi+4], ebx
		add	esp, 0Ch
		mov	eax, [esi+10h]
		dec	bl
		mov	ecx, [esp+14h+arg_0]
		mov	[eax+ecx-1], bl
		mov	ebx, [esp+14h+var_4]

loc_C33:				; CODE XREF: _ssl3_enc+83j
		cmp	[esp+14h+arg_4], 0
		jnz	short loc_C50

loc_C3A:				; CODE XREF: _ssl3_enc+8Aj
		test	ecx, ecx
		jz	short loc_C48
		xor	edx, edx
		mov	eax, ecx
		div	ebx
		test	edx, edx
		jz	short loc_C50

loc_C48:				; CODE XREF: _ssl3_enc+C8j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_C50:				; CODE XREF: _ssl3_enc+C4j
					; _ssl3_enc+D2j
		push	ecx
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		push	ebp
		call	_EVP_Cipher
		add	esp, 10h
		cmp	eax, 1
		jge	short loc_C6E
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_C6E:				; CODE XREF: _ssl3_enc+EFj
		push	dword ptr [edi+84h]
		call	_EVP_MD_CTX_md
		add	esp, 4
		test	eax, eax
		jz	short loc_C96
		push	dword ptr [edi+84h]
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		add	esp, 8
		jmp	short loc_C98
; ---------------------------------------------------------------------------

loc_C96:				; CODE XREF: _ssl3_enc+10Aj
		xor	eax, eax

loc_C98:				; CODE XREF: _ssl3_enc+120j
		cmp	ebx, 1
		jz	short loc_CCE
		cmp	[esp+14h+arg_4], 0
		jnz	short loc_CCE
		push	eax
		push	ebx
		push	esi
		push	edi
		call	_ssl3_cbc_remove_padding
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_CB6:				; CODE XREF: _ssl3_enc+4Ej
					; _ssl3_enc+56j ...
		push	dword ptr [esi+4] ; Size
		push	dword ptr [esi+10h] ; Src
		push	dword ptr [esi+0Ch] ; Dst
		call	dword ptr ds:__imp__memmove
		mov	eax, [esi+0Ch]
		add	esp, 0Ch
		mov	[esi+10h], eax

loc_CCE:				; CODE XREF: _ssl3_enc+127j
					; _ssl3_enc+12Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
_ssl3_enc	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CDCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_final_finish_mac
_ssl3_final_finish_mac proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	edi
		mov	edi, [esp+8+arg_C]
		push	edi
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		push	4
		push	[esp+18h+arg_0]
		call	_ssl3_handshake_mac
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_D04

loc_CFF:				; CODE XREF: _ssl3_final_finish_mac+44j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_D04:				; CODE XREF: _ssl3_final_finish_mac+21j
		lea	eax, [esi+edi]
		push	eax
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		push	40h ; '@'
		push	[esp+18h+arg_0]
		call	_ssl3_handshake_mac
		add	esp, 14h
		test	eax, eax
		jz	short loc_CFF
		pop	edi
		add	eax, esi
		pop	esi
		retn
_ssl3_final_finish_mac endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D28h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_finish_mac
_ssl3_finish_mac proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_0]
		mov	eax, [ebp+58h]
		mov	ecx, [eax+178h]
		test	ecx, ecx
		jz	short loc_D49
		test	byte ptr [eax],	20h
		jnz	short loc_D49
		pop	ebp
		mov	[esp+arg_0], ecx
		jmp	_BIO_write
; ---------------------------------------------------------------------------

loc_D49:				; CODE XREF: _ssl3_finish_mac+10j
					; _ssl3_finish_mac+15j
		push	ebx
		mov	ebx, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		xor	esi, esi
		xchg	ax, ax

loc_D58:				; CODE XREF: _ssl3_finish_mac+51j
		mov	eax, [ebp+58h]
		mov	eax, [eax+17Ch]
		mov	eax, [esi+eax]
		test	eax, eax
		jz	short loc_D73
		push	edi
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch

loc_D73:				; CODE XREF: _ssl3_finish_mac+3Ej
		add	esi, 4
		cmp	esi, 18h
		jl	short loc_D58
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
_ssl3_finish_mac endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D80h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_free_digest_list
_ssl3_free_digest_list proc near	; CODE XREF: _ssl3_digest_cached_records+11p
					; _ssl3_init_finished_mac+28p

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+17Ch], 0
		jz	short loc_DD4
		push	esi
		xor	esi, esi

loc_D94:				; CODE XREF: _ssl3_free_digest_list+33j
		mov	eax, [edi+58h]
		mov	eax, [eax+17Ch]
		mov	eax, [esi+eax]
		test	eax, eax
		jz	short loc_DAD
		push	eax
		call	_EVP_MD_CTX_destroy
		add	esp, 4

loc_DAD:				; CODE XREF: _ssl3_free_digest_list+22j
		add	esi, 4
		cmp	esi, 18h
		jl	short loc_D94
		mov	eax, [edi+58h]
		push	dword ptr [eax+17Ch]
		call	_CRYPTO_free
		mov	eax, [edi+58h]
		add	esp, 4
		mov	dword ptr [eax+17Ch], 0
		pop	esi

loc_DD4:				; CODE XREF: _ssl3_free_digest_list+Fj
		pop	edi
		retn
_ssl3_free_digest_list endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0DD8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl ssl3_generate_key_block(int, void	*Dst, int)
_ssl3_generate_key_block proc near	; CODE XREF: _ssl3_setup_key_block+126p

var_65		= byte ptr -65h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= byte ptr -40h
Src		= byte ptr -28h
var_14		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [esp+70h+Dst]
		push	esi
		mov	[esp+74h+var_64], eax
		xor	esi, esi
		lea	eax, [esp+74h+var_58]
		mov	[esp+74h+var_65], 41h ;	'A'
		push	edi
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+7Ch+var_58]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		lea	eax, [esp+84h+var_40]
		push	eax
		call	_EVP_MD_CTX_init
		mov	edi, [esp+88h+arg_8]
		xor	ebx, ebx
		add	esp, 10h
		mov	[esp+78h+var_60], ebx
		test	edi, edi
		jle	loc_F9B
		mov	eax, 10h
		sub	eax, ebp
		mov	[esp+78h+var_5C], eax
		nop

loc_E48:				; CODE XREF: _ssl3_generate_key_block+1BDj
		inc	esi
		cmp	esi, 10h
		ja	loc_FD6
		test	esi, esi
		jz	short loc_E80
		movzx	eax, [esp+78h+var_65]
		lea	edi, [esp+78h+var_14]
		imul	eax, 1010101h
		mov	ecx, esi
		mov	ebx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, ebx
		mov	ebx, [esp+78h+var_60]
		and	ecx, 3
		rep stosb
		mov	edi, [esp+78h+arg_8]

loc_E80:				; CODE XREF: _ssl3_generate_key_block+7Cj
		inc	[esp+78h+var_65]
		push	0
		call	_EVP_sha1
		push	eax
		lea	eax, [esp+80h+var_40]
		push	eax
		call	_EVP_DigestInit_ex
		push	esi
		lea	eax, [esp+88h+var_14]
		push	eax
		lea	eax, [esp+8Ch+var_40]
		push	eax
		call	_EVP_DigestUpdate
		mov	eax, [esp+90h+var_64]
		mov	eax, [eax+0C0h]
		push	dword ptr [eax+10h]
		add	eax, 14h
		push	eax
		lea	eax, [esp+98h+var_40]
		push	eax
		call	_EVP_DigestUpdate
		mov	eax, [esp+9Ch+var_64]
		push	20h ; ' '
		mov	eax, [eax+58h]
		add	eax, 0A0h ; '†'
		push	eax
		lea	eax, [esp+0A4h+var_40]
		push	eax
		call	_EVP_DigestUpdate
		mov	eax, [esp+0A8h+var_64]
		push	20h ; ' '
		mov	eax, [eax+58h]
		add	eax, 0C0h ; '¿'
		push	eax
		lea	eax, [esp+0B0h+var_40]
		push	eax
		call	_EVP_DigestUpdate
		push	0
		lea	eax, [esp+0B8h+Src]
		push	eax
		lea	eax, [esp+0BCh+var_40]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 48h
		push	0
		call	_EVP_md5
		push	eax
		lea	eax, [esp+80h+var_58]
		push	eax
		call	_EVP_DigestInit_ex
		mov	eax, [esp+84h+var_64]
		mov	eax, [eax+0C0h]
		push	dword ptr [eax+10h]
		add	eax, 14h
		push	eax
		lea	eax, [esp+8Ch+var_58]
		push	eax
		call	_EVP_DigestUpdate
		push	14h
		lea	eax, [esp+94h+Src]
		push	eax
		lea	eax, [esp+98h+var_58]
		push	eax
		call	_EVP_DigestUpdate
		mov	eax, [esp+9Ch+var_5C]
		add	esp, 24h
		add	eax, ebp
		push	0
		cmp	eax, edi
		jle	short loc_F7B
		lea	eax, [esp+7Ch+Src]
		push	eax
		lea	eax, [esp+80h+var_58]
		push	eax
		call	_EVP_DigestFinal_ex
		mov	eax, edi
		sub	eax, ebx
		push	eax		; Size
		lea	eax, [esp+88h+Src]
		push	eax		; Src
		push	ebp		; Dst
		call	_memcpy
		add	esp, 18h
		jmp	short loc_F89
; ---------------------------------------------------------------------------

loc_F7B:				; CODE XREF: _ssl3_generate_key_block+17Dj
		lea	eax, [esp+7Ch+var_58]
		push	ebp
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch

loc_F89:				; CODE XREF: _ssl3_generate_key_block+1A1j
		add	ebx, 10h
		add	ebp, 10h
		mov	[esp+78h+var_60], ebx
		cmp	ebx, edi
		jl	loc_E48

loc_F9B:				; CODE XREF: _ssl3_generate_key_block+5Ej
		lea	eax, [esp+78h+Src]
		push	14h
		push	eax
		call	_OPENSSL_cleanse
		lea	eax, [esp+80h+var_58]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+84h+var_40]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+68h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
; ---------------------------------------------------------------------------

loc_FD6:				; CODE XREF: _ssl3_generate_key_block+74j
		push	0B6h ; '∂'
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		push	0EEh ; 'Ó'
		push	14h
		call	_ERR_put_error
		mov	ecx, [esp+8Ch+var_4]
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_ssl3_generate_key_block endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 100Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_generate_master_secret
_ssl3_generate_master_secret proc near

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, 68h ; 'h'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_8]
		push	ebx
		mov	ebx, [esp+6Ch+arg_4]
		push	ebp
		push	esi
		mov	[esp+74h+var_64], eax
		xor	ebp, ebp
		push	edi
		mov	edi, [esp+78h+arg_0]
		lea	eax, [esp+78h+var_5C]
		push	eax
		call	_EVP_MD_CTX_init
		add	esp, 4
		mov	esi, offset ?salt@?1??ssl3_generate_master_secret@@9@9 ; `ssl3_generate_master_secret'::`2'::salt
		nop	dword ptr [eax]

loc_104C:				; CODE XREF: _ssl3_generate_master_secret+18Ej
		mov	eax, [edi+0E4h]
		push	0
		push	dword ptr [eax+90h]
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		mov	edx, [esi]
		mov	ecx, edx
		lea	eax, [ecx+1]
		mov	[esp+78h+var_60], eax
		xchg	ax, ax

loc_107C:				; CODE XREF: _ssl3_generate_master_secret+75j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_107C
		sub	ecx, [esp+78h+var_60]
		lea	eax, [esp+78h+var_5C]
		push	ecx
		push	edx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		push	[esp+78h+arg_C]
		lea	eax, [esp+7Ch+var_5C]
		push	[esp+7Ch+var_64]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		mov	eax, [edi+58h]
		add	eax, 0C0h ; '¿'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		mov	eax, [edi+58h]
		add	eax, 0A0h ; '†'
		push	20h ; ' '
		push	eax
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		lea	eax, [esp+78h+var_68]
		push	eax
		lea	eax, [esp+7Ch+var_44]
		push	eax
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_11A2
		mov	eax, [edi+0E4h]
		push	0
		push	dword ptr [eax+8Ch]
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_11A2
		push	[esp+78h+arg_C]
		lea	eax, [esp+7Ch+var_5C]
		push	[esp+7Ch+var_64]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_11A2
		push	[esp+78h+var_68]
		lea	eax, [esp+7Ch+var_44]
		push	eax
		lea	eax, [esp+80h+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_11A2
		lea	eax, [esp+78h+var_68]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	ebx
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_11A2
		add	ebx, [esp+78h+var_68]
		add	esi, 4
		add	ebp, [esp+78h+var_68]
		cmp	esi, (offset off_68+4)
		jl	loc_104C
		jmp	short loc_11BF
; ---------------------------------------------------------------------------

loc_11A2:				; CODE XREF: _ssl3_generate_master_secret+5Dj
					; _ssl3_generate_master_secret+8Cj ...
		push	36Ah
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		push	184h
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	ebp, ebp

loc_11BF:				; CODE XREF: _ssl3_generate_master_secret+194j
		lea	eax, [esp+78h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+7Ch+var_44]
		push	40h ; '@'
		push	eax
		call	_OPENSSL_cleanse
		mov	ecx, [esp+84h+var_4]
		add	esp, 0Ch
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
_ssl3_generate_master_secret endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11F0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ssl3_handshake_mac proc near		; CODE XREF: _ssl3_cert_verify_mac+10p
					; _ssl3_final_finish_mac+15p ...

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 64h ; 'd'
		call	__chkstk
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		push	ebx
		mov	ebx, [esp+68h+arg_8]
		push	ebp
		mov	ebp, [esp+6Ch+arg_10]
		push	esi
		mov	esi, [esp+70h+arg_0]
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+178h], 0
		jz	short loc_1242
		push	esi
		call	_ssl3_digest_cached_records
		add	esp, 4
		test	eax, eax
		jnz	short loc_1242
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_1242:				; CODE XREF: _ssl3_handshake_mac+31j
					; _ssl3_handshake_mac+3Ej
		xor	ecx, ecx
		push	edi
		mov	edi, [esp+74h+arg_4]
		mov	[esp+74h+var_64], ecx
		nop	dword ptr [eax]

loc_1250:				; CODE XREF: _ssl3_handshake_mac+8Fj
		mov	eax, [esi+58h]
		mov	eax, [eax+17Ch]
		mov	eax, [eax+ecx*4]
		test	eax, eax
		jz	short loc_1277
		push	eax
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_type
		add	esp, 8
		cmp	eax, edi
		jz	short loc_12B4
		mov	ecx, [esp+74h+var_64]

loc_1277:				; CODE XREF: _ssl3_handshake_mac+6Ej
		inc	ecx
		mov	[esp+74h+var_64], ecx
		cmp	ecx, 6
		jb	short loc_1250

loc_1281:				; CODE XREF: _ssl3_handshake_mac+D6j
		push	2B1h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	144h
		push	11Dh
		push	14h
		call	_ERR_put_error
		add	esp, 14h

loc_129F:				; CODE XREF: _ssl3_handshake_mac+110j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+64h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
; ---------------------------------------------------------------------------

loc_12B4:				; CODE XREF: _ssl3_handshake_mac+81j
		mov	eax, [esi+58h]
		mov	ecx, [eax+17Ch]
		mov	eax, [esp+74h+var_64]
		mov	edi, [ecx+eax*4]
		test	edi, edi
		jz	short loc_1281
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_EVP_MD_CTX_init
		lea	eax, [esp+78h+var_5C]
		push	8
		push	eax
		call	_EVP_MD_CTX_set_flags
		lea	eax, [esp+80h+var_5C]
		push	edi
		push	eax
		call	_EVP_MD_CTX_copy_ex
		lea	eax, [esp+88h+var_5C]
		push	eax
		call	_EVP_MD_CTX_md
		push	eax
		call	_EVP_MD_size
		mov	ecx, eax
		add	esp, 1Ch
		test	ecx, ecx
		js	short loc_129F
		mov	eax, 30h ; '0'
		cdq
		idiv	ecx
		mov	edi, eax
		imul	edi, ecx
		test	ebx, ebx
		jz	short loc_1330
		push	[esp+74h+arg_C]
		lea	eax, [esp+78h+var_5C]
		push	ebx
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_1413

loc_1330:				; CODE XREF: _ssl3_handshake_mac+121j
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+10h]
		add	eax, 14h
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_1413
		push	edi
		lea	eax, [esp+78h+var_5C]
		push	offset _ssl3_pad_1
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	loc_1413
		lea	eax, [esp+74h+var_64]
		push	eax
		lea	eax, [esp+78h+var_44]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jle	loc_1413
		lea	eax, [esp+74h+var_5C]
		push	0
		push	eax
		call	_EVP_MD_CTX_md
		add	esp, 4
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestInit_ex
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1413
		mov	eax, [esi+0C0h]
		push	dword ptr [eax+10h]
		add	eax, 14h
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1413
		push	edi
		lea	eax, [esp+78h+var_5C]
		push	offset _ssl3_pad_2
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1413
		push	[esp+74h+var_64]
		lea	eax, [esp+78h+var_44]
		push	eax
		lea	eax, [esp+7Ch+var_5C]
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1413
		lea	eax, [esp+74h+var_60]
		push	eax
		lea	eax, [esp+78h+var_5C]
		push	ebp
		push	eax
		call	_EVP_DigestFinal_ex
		add	esp, 0Ch
		test	eax, eax
		jg	short loc_1436

loc_1413:				; CODE XREF: _ssl3_handshake_mac+13Aj
					; _ssl3_handshake_mac+15Cj ...
		push	2C8h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	44h ; 'D'
		push	11Dh
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		mov	[esp+74h+var_60], 0

loc_1436:				; CODE XREF: _ssl3_handshake_mac+221j
		lea	eax, [esp+74h+var_5C]
		push	eax
		call	_EVP_MD_CTX_cleanup
		mov	ecx, [esp+78h+var_4]
		add	esp, 4
		mov	eax, [esp+74h+var_60]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn
_ssl3_handshake_mac endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 145Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_init_finished_mac
_ssl3_init_finished_mac	proc near

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+58h]
		mov	eax, [eax+178h]
		test	eax, eax
		jz	short loc_1477
		push	eax
		call	_BIO_free
		add	esp, 4

loc_1477:				; CODE XREF: _ssl3_init_finished_mac+10j
		mov	eax, [esi+58h]
		cmp	dword ptr [eax+17Ch], 0
		jz	short loc_148C
		push	esi
		call	_ssl3_free_digest_list
		add	esp, 4

loc_148C:				; CODE XREF: _ssl3_init_finished_mac+25j
		call	_BIO_s_mem
		push	eax
		call	_BIO_new
		mov	ecx, [esi+58h]
		push	0
		push	1
		push	9
		mov	[ecx+178h], eax
		mov	eax, [esi+58h]
		push	dword ptr [eax+178h]
		call	_BIO_ctrl
		add	esp, 14h
		pop	esi
		retn
_ssl3_init_finished_mac	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14BCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_record_sequence_update
_ssl3_record_sequence_update proc near	; CODE XREF: _n_ssl3_mac+16Fp
					; _n_ssl3_mac+2FBp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, 7
		nop	dword ptr [eax+00000000h]

loc_14CC:				; CODE XREF: _ssl3_record_sequence_update+19j
		add	byte ptr [eax+ecx], 1
		jnz	short locret_14D7
		sub	eax, 1
		jns	short loc_14CC

locret_14D7:				; CODE XREF: _ssl3_record_sequence_update+14j
		retn
_ssl3_record_sequence_update endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 14D8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _ssl3_setup_key_block
_ssl3_setup_key_block proc near

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 8
		call	__chkstk
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	eax, [edi+58h]
		cmp	dword ptr [eax+374h], 0
		jz	short loc_14FD
		mov	eax, 1
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_14FD:				; CODE XREF: _ssl3_setup_key_block+19j
		lea	eax, [esp+0Ch+var_4]
		push	eax
		push	0
		push	0
		lea	eax, [esp+18h+var_8]
		push	eax
		lea	eax, [esp+1Ch+arg_0]
		push	eax
		push	dword ptr [edi+0C0h]
		call	_ssl_cipher_get_evp
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1547
		push	1A7h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	8Ah ; 'ä'
		push	9Dh ; 'ù'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1547:				; CODE XREF: _ssl3_setup_key_block+48j
		mov	ecx, [edi+58h]
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		mov	[ecx+37Ch], eax
		mov	ecx, [edi+58h]
		mov	eax, [esp+10h+var_8]
		mov	[ecx+380h], eax
		mov	ecx, [edi+58h]
		mov	eax, [esp+10h+var_4]
		mov	[ecx+38Ch], eax
		push	[esp+10h+var_8]
		call	_EVP_MD_size
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jns	short loc_1589
		pop	ebp
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1589:				; CODE XREF: _ssl3_setup_key_block+A7j
		push	ebx
		push	esi
		push	[esp+18h+arg_0]
		call	_EVP_CIPHER_iv_length
		push	[esp+1Ch+arg_0]
		lea	ebx, [eax+ebp]
		call	_EVP_CIPHER_key_length
		push	edi
		lea	ebx, [ebx+eax]
		add	ebx, ebx
		call	_ssl3_cleanup_key_block
		push	1BCh
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	ebx
		call	_CRYPTO_malloc
		mov	ecx, eax
		add	esp, 18h
		test	ecx, ecx
		jnz	short loc_15E9

$err$14:
		push	1D9h
		push	offset ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ ; ".\\ssl\\s3_enc.c"
		push	41h ; 'A'
		push	9Dh ; 'ù'
		push	14h
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	esi
		pop	ebx
		pop	ebp
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_15E9:				; CODE XREF: _ssl3_setup_key_block+EAj
		mov	eax, [edi+58h]
		push	ebx		; int
		push	ecx		; Dst
		push	edi		; int
		mov	[eax+374h], ebx
		mov	eax, [edi+58h]
		mov	[eax+378h], ecx
		call	_ssl3_generate_key_block
		add	esp, 0Ch
		mov	edx, eax
		test	dword ptr [edi+100h], 800h
		jnz	short loc_1663
		mov	ecx, [edi+58h]
		mov	dword ptr [ecx+0E0h], 1
		mov	ecx, [edi+0C0h]
		mov	ecx, [ecx+0B4h]
		test	ecx, ecx
		jz	short loc_1663
		cmp	dword ptr [ecx+14h], 20h ; ' '
		jnz	short loc_1644
		mov	eax, [edi+58h]
		mov	dword ptr [eax+0E0h], 0

loc_1644:				; CODE XREF: _ssl3_setup_key_block+15Dj
		mov	eax, [edi+0C0h]
		mov	eax, [eax+0B4h]
		cmp	dword ptr [eax+14h], 4
		jnz	short loc_1663
		mov	eax, [edi+58h]
		mov	dword ptr [eax+0E0h], 0

loc_1663:				; CODE XREF: _ssl3_setup_key_block+13Aj
					; _ssl3_setup_key_block+157j ...
		pop	esi
		pop	ebx
		pop	ebp
		mov	eax, edx
		pop	edi
		add	esp, 8
		retn
_ssl3_setup_key_block endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1670h
; COMDAT (pick any)
		public ??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@
; `string'
??_C@_0P@NBDCMPEC@?4?2ssl?2s3_enc?4c?$AA@ db '.\ssl\s3_enc.c',0
					; DATA XREF: _ssl3_change_cipher_state+5Co
					; _ssl3_change_cipher_state+9Fo ...
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1680h
; COMDAT (pick any)
		public ??_C@_01GOHFPIOK@m?$AA@
; `string'
??_C@_01GOHFPIOK@m?$AA@	db 6Dh,	0	; DATA XREF: _ssl3_change_cipher_state+52o
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
; void *__cdecl	_memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp__memmove:near ; CODE XREF: _ssl3_enc+14Bp
					; DATA XREF: _ssl3_enc+14Br
		extrn _CRYPTO_malloc:near ; CODE XREF: _ssl3_change_cipher_state+A9p
					; _ssl3_change_cipher_state+180p ...
		extrn _CRYPTO_free:near	; CODE XREF: _ssl3_cleanup_key_block+27p
					; _ssl3_free_digest_list+3Ep
		extrn _OPENSSL_cleanse:near ; CODE XREF: _ssl3_change_cipher_state+4B9p
					; _ssl3_change_cipher_state+4C5p ...
		extrn _OpenSSLDie:near	; CODE XREF: _ssl3_change_cipher_state+61p
		extrn _COMP_CTX_new:near ; CODE	XREF: _ssl3_change_cipher_state+11Ap
					; _ssl3_change_cipher_state+252p
		extrn _COMP_CTX_free:near ; CODE XREF: _ssl3_change_cipher_state+FFp
					; _ssl3_change_cipher_state+23Bp
		extrn _BIO_new:near	; CODE XREF: _ssl3_init_finished_mac+36p
		extrn _BIO_free:near	; CODE XREF: _ssl3_digest_cached_records+13Cp
					; _ssl3_init_finished_mac+13p
		extrn _BIO_write:near	; CODE XREF: _ssl3_finish_mac+1Cj
		extrn _BIO_ctrl:near	; CODE XREF: _ssl3_digest_cached_records+56p
					; _ssl3_init_finished_mac+53p
		extrn _BIO_s_mem:near	; CODE XREF: _ssl3_init_finished_mac:loc_148Cp
		extrn _ERR_put_error:near ; CODE XREF: _ssl3_change_cipher_state+142p
					; _ssl3_digest_cached_records+7Ap ...
		extrn _EVP_MD_type:near	; CODE XREF: _ssl3_handshake_mac+77p
		extrn _EVP_MD_size:near	; CODE XREF: _n_ssl3_mac+69p
					; _ssl3_change_cipher_state+2A0p ...
		extrn _EVP_MD_CTX_md:near ; CODE XREF: _n_ssl3_mac+63p
					; _ssl3_enc+100p ...
		extrn _EVP_CIPHER_block_size:near ; CODE XREF: _ssl3_enc+6Ep
		extrn _EVP_CIPHER_key_length:near
					; CODE XREF: _ssl3_change_cipher_state+2B6p
					; _ssl3_setup_key_block+C3p
		extrn _EVP_CIPHER_iv_length:near ; CODE	XREF: _ssl3_change_cipher_state+308p
					; _ssl3_setup_key_block+B7p
		extrn _EVP_CIPHER_CTX_cipher:near ; CODE XREF: _ssl3_enc+3Fp
		extrn _EVP_CIPHER_CTX_flags:near ; CODE	XREF: _n_ssl3_mac+BEp
		extrn _EVP_Cipher:near	; CODE XREF: _ssl3_enc+E4p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _n_ssl3_mac+185p
					; _ssl3_change_cipher_state+3B4p ...
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _n_ssl3_mac+2F2p
					; _n_ssl3_mac+30Ep ...
		extrn _EVP_MD_CTX_create:near ;	CODE XREF: _ssl3_digest_cached_records+BEp
		extrn _EVP_MD_CTX_destroy:near ; CODE XREF: _ssl3_free_digest_list+25p
		extrn _EVP_MD_CTX_copy_ex:near ; CODE XREF: _n_ssl3_mac+1A1p
					; _n_ssl3_mac+275p ...
		extrn _EVP_MD_CTX_set_flags:near ; CODE	XREF: _ssl3_generate_key_block+3Dp
					; _ssl3_handshake_mac+E9p
		extrn _EVP_DigestInit_ex:near ;	CODE XREF: _ssl3_change_cipher_state+3DFp
					; _ssl3_change_cipher_state+448p ...
		extrn _EVP_DigestUpdate:near ; CODE XREF: _n_ssl3_mac+1BEp
					; _n_ssl3_mac+1DCp ...
		extrn _EVP_DigestFinal_ex:near ; CODE XREF: _n_ssl3_mac+25Fp
					; _n_ssl3_mac+2D9p ...
		extrn _EVP_CipherInit_ex:near ;	CODE XREF: _ssl3_change_cipher_state+4ADp
		extrn _EVP_CIPHER_CTX_init:near	; CODE XREF: _ssl3_change_cipher_state+C0p
					; _ssl3_change_cipher_state+1F9p
		extrn _EVP_CIPHER_CTX_cleanup:near
					; CODE XREF: _ssl3_change_cipher_state+28Ap
		extrn _EVP_md5:near	; CODE XREF: _ssl3_change_cipher_state+3D4p
					; _ssl3_change_cipher_state+43Dp ...
		extrn _EVP_sha1:near	; CODE XREF: _ssl3_generate_key_block+AEp
		extrn _ssl_cipher_get_evp:near ; CODE XREF: _ssl3_setup_key_block+3Ep
		extrn _ssl_get_handshake_digest:near
					; CODE XREF: _ssl3_digest_cached_records+98p
					; _ssl3_digest_cached_records+11Dp
		extrn _ssl_replace_hash:near ; CODE XREF: _ssl3_change_cipher_state+DAp
					; _ssl3_change_cipher_state+213p
		extrn _ssl_get_algorithm2:near ; CODE XREF: _ssl3_digest_cached_records+A9p
		extrn _ssl3_cbc_remove_padding:near ; CODE XREF: _ssl3_enc+134p
		extrn _ssl3_cbc_record_digest_supported:near ; CODE XREF: _n_ssl3_mac+D5p
		extrn _ssl3_cbc_digest_record:near ; CODE XREF:	_n_ssl3_mac+15Ap
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near ;	CODE XREF: _n_ssl3_mac+326p
					; _ssl3_change_cipher_state+159p ...
		extrn __chkstk:near	; CODE XREF: _n_ssl3_mac+5p
					; _ssl3_change_cipher_state+5p	...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _n_ssl3_mac+F3p
					; _n_ssl3_mac+108p ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ssl3_enc+A3p
		extrn ___security_cookie:near ;	DATA XREF: _n_ssl3_mac+Ar
					; _ssl3_change_cipher_state+Ar	...


		end
