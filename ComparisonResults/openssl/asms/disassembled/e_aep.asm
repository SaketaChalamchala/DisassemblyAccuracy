;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	CC8EE37179193637439EE7EAD51201CD
; Input	CRC32 :	CA8F7A2B

; File Name   :	C:\compspace\Diff\openssl\obj\e_aep.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
_AEPHK_str_functs dd 64000h		; DATA XREF: _ERR_load_AEPHK_strings+1Co
					; _ERR_unload_AEPHK_strings+9o	...
		dd offset ??_C@_08HKHCDLC@AEP_CTRL?$AA@	; "AEP_CTRL"
		dd 65000h
		dd offset ??_C@_0L@FNHAFLFI@AEP_FINISH?$AA@ ; "AEP_FINISH"
		dd 66000h
		dd offset ??_C@_0BD@FFOCLCIO@AEP_GET_CONNECTION?$AA@ ; "AEP_GET_CONNECTION"
		dd 67000h
		dd offset ??_C@_08OANLFICA@AEP_INIT?$AA@ ; "AEP_INIT"
		dd 68000h
		dd offset ??_C@_0M@MGIDDHNC@AEP_MOD_EXP?$AA@ ; "AEP_MOD_EXP"
		dd 69000h
		dd offset ??_C@_0BA@ENNNODEN@AEP_MOD_EXP_CRT?$AA@ ; "AEP_MOD_EXP_CRT"
		dd 6A000h
		dd offset ??_C@_08OAAFOKDB@AEP_RAND?$AA@ ; "AEP_RAND"
		dd 6B000h
		dd offset ??_C@_0BA@NENPOKPO@AEP_RSA_MOD_EXP?$AA@ ; "AEP_RSA_MOD_EXP"
		dd 2 dup(0)
_AEPHK_str_reasons dd offset off_64	; DATA XREF: _ERR_load_AEPHK_strings+31o
					; _ERR_unload_AEPHK_strings+19o ...
		dd offset ??_C@_0P@BJJHFGDF@already?5loaded?$AA@ ; "already loaded"
		dd offset off_64+1
		dd offset ??_C@_0BF@FOJKPHIP@close?5handles?5failed?$AA@ ; "close handles failed"
		dd offset off_64+2
		dd offset ??_C@_0BD@FKLPBJLO@connections?5in?5use?$AA@ ; "connections in use"
		dd offset off_64+3
off_64		dd offset ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@
					; DATA XREF: .data:_AEPHK_str_reasonso
					; .data:00000050o ...
					; "ctrl	command	not implemented"
off_68		dd offset off_68	; DATA XREF: .data:off_68o
					; .data:00000078o ...
off_6C		dd offset ??_C@_0BA@FAECLOCA@finalize?5failed?$AA@
					; DATA XREF: .data:00000088o
					; .data:00000090o ...
					; "finalize failed"
byte_70		db 69h,	2 dup(0)	; DATA XREF: .data:000000A8o
					; .data:000000B0o ...
byte_73		db 0			; DATA XREF: .data:off_C8o
off_74		dd offset ??_C@_0BC@HCJPFNOA@get?5handle?5failed?$AA@
					; DATA XREF: .data:000000C0o
					; "get handle failed"
		dd offset off_68+2
		dd offset ??_C@_0BC@JGPFKCAM@get?5random?5failed?$AA@ ;	"get random failed"
		dd offset off_68+3
		dd offset ??_C@_0N@LFCGIAOA@init?5failure?$AA@ ; "init failure"
		dd offset off_6C
		dd offset ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@ ; "missing key components"
		dd offset off_6C+1
		dd offset ??_C@_0BD@JLFOKAKM@mod?5exp?5crt?5failed?$AA@	; "mod exp crt failed"
		dd offset off_6C+2
		dd offset ??_C@_0P@NGHHJKEC@mod?5exp?5failed?$AA@ ; "mod exp failed"
		dd offset off_6C+3
		dd offset ??_C@_0L@ICAFOIA@not?5loaded?$AA@ ; "not loaded"
		dd offset byte_70
		dd offset ??_C@_02MFDMBIJM@ok?$AA@ ; `string'
		dd offset byte_70+1
		dd offset ??_C@_0BJ@OKCIHIBG@return?5connection?5failed?$AA@ ; "return connection failed"
		dd offset byte_70+2
		dd offset ??_C@_0BG@PJDMHIFC@setbncallback?5failure?$AA@ ; "setbncallback failure"
		dd offset off_74
		dd offset ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ ; "size too large or	too small"
off_C8		dd offset byte_73	; DATA XREF: .rdata:_aep_cmd_defnso
		dd offset ??_C@_0N@JLJLJPMB@unit?5failure?$AA@ ; "unit failure"
		dd 2 dup(0)
_AEPHK_error_init dd 1			; DATA XREF: _ERR_load_AEPHK_strings:loc_F53r
					; _ERR_load_AEPHK_strings+22w ...
_aep_rsa	dd offset ??_C@_0P@LBHLDOJI@Aep?5RSA?5method?$AA@ ; DATA XREF: _bind_aep+33o
					; "Aep RSA method"
dword_E0	dd 0			; DATA XREF: _bind_aep+EBw
dword_E4	dd 0			; DATA XREF: _bind_aep+F4w
dword_E8	dd 0			; DATA XREF: _bind_aep+FDw
dword_EC	dd 0			; DATA XREF: _bind_aep+106w
		dd offset _aep_rsa_mod_exp
		dd offset _aep_mod_exp_mont
		dd 7 dup(0)
_aep_dsa	dd offset ??_C@_0P@PHDIDABA@Aep?5DSA?5method?$AA@ ; DATA XREF: _bind_aep+49o
					; _bind_aep+132w
					; "Aep DSA method"
dword_118	dd 0			; DATA XREF: _bind_aep+113w
dword_11C	dd 0			; DATA XREF: _bind_aep+11Cw
dword_120	dd 0			; DATA XREF: _bind_aep+125w
off_124		xmmword	offset _aep_dsa_mod_exp	; DATA XREF: _bind_aep+13Dw
					; _bind_aep+148w ...
xmmword_134	xmmword	0		; DATA XREF: _bind_aep+15Cw
_aep_dh		dd offset ??_C@_0O@EKBHJLND@Aep?5DH?5method?$AA@ ; DATA	XREF: _bind_aep+5Fo
					; "Aep DH method"
dword_148	dd 0			; DATA XREF: _bind_aep+16Bw
dword_14C	dd 0			; DATA XREF: _bind_aep+174w
off_150		dd offset _aep_mod_exp_dh ; DATA XREF: _bind_aep+17Dw
		dd 5 dup(0)
_engine_aep_id	dd offset ??_C@_03DMACMALI@aep?$AA@ ; DATA XREF: _bind_aep+1r
					; _bind_engine+75r ...
					; `string'
_engine_aep_name dd offset ??_C@_0BM@OJGJAEPI@Aep?5hardware?5engine?5support?$AA@
					; DATA XREF: _bind_aep+1Cr
					; "Aep hardware	engine support"
_max_key_len	dd offset dword_880	; DATA XREF: _aep_mod_exp+1Br
_AEP_F1		dd offset ??_C@_0L@GMKCHEGO@AEP_ModExp?$AA@ ; DATA XREF: _aep_init:loc_162Fr
					; "AEP_ModExp"
_AEP_F2		dd offset ??_C@_0O@KEEFGPGP@AEP_ModExpCrt?$AA@ ; DATA XREF: _aep_init+98r
					; "AEP_ModExpCrt"
_AEP_F4		dd offset ??_C@_0N@CJPMELKJ@AEP_Finalize?$AA@ ;	DATA XREF: _aep_init+B6r
					; "AEP_Finalize"
_AEP_F5		dd offset ??_C@_0P@OFCEAJEJ@AEP_Initialize?$AA@	; DATA XREF: _aep_init+D4r
					; "AEP_Initialize"
_AEP_F6		dd offset ??_C@_0BD@NAIMCHOG@AEP_OpenConnection?$AA@
					; DATA XREF: _aep_init+F2r
					; "AEP_OpenConnection"
_AEP_F7		dd offset ??_C@_0BD@CCHJGDIJ@AEP_SetBNCallBacks?$AA@
					; DATA XREF: _aep_init+10Er
					; "AEP_SetBNCallBacks"
_AEP_F8		dd offset ??_C@_0BE@DNJGABLO@AEP_CloseConnection?$AA@
					; DATA XREF: _aep_init+12Ar
_data		ends			; "AEP_CloseConnection"

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 190h
; COMDAT (pick any)
		public ??_C@_08HKHCDLC@AEP_CTRL?$AA@
; `string'
??_C@_08HKHCDLC@AEP_CTRL?$AA@ db 'AEP_CTRL',0 ; DATA XREF: .data:00000004o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 19Ch
; COMDAT (pick any)
		public ??_C@_0L@FNHAFLFI@AEP_FINISH?$AA@
; `string'
??_C@_0L@FNHAFLFI@AEP_FINISH?$AA@ db 'AEP_FINISH',0 ; DATA XREF: .data:0000000Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1A8h
; COMDAT (pick any)
		public ??_C@_0BD@FFOCLCIO@AEP_GET_CONNECTION?$AA@
; `string'
??_C@_0BD@FFOCLCIO@AEP_GET_CONNECTION?$AA@ db 'AEP_GET_CONNECTION',0
					; DATA XREF: .data:00000014o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1BCh
; COMDAT (pick any)
		public ??_C@_08OANLFICA@AEP_INIT?$AA@
; `string'
??_C@_08OANLFICA@AEP_INIT?$AA@ db 'AEP_INIT',0 ; DATA XREF: .data:0000001Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1C8h
; COMDAT (pick any)
		public ??_C@_0M@MGIDDHNC@AEP_MOD_EXP?$AA@
; `string'
??_C@_0M@MGIDDHNC@AEP_MOD_EXP?$AA@ db 'AEP_MOD_EXP',0 ; DATA XREF: .data:00000024o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1D4h
; COMDAT (pick any)
		public ??_C@_0BA@ENNNODEN@AEP_MOD_EXP_CRT?$AA@
; `string'
??_C@_0BA@ENNNODEN@AEP_MOD_EXP_CRT?$AA@	db 'AEP_MOD_EXP_CRT',0 ; DATA XREF: .data:0000002Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1E4h
; COMDAT (pick any)
		public ??_C@_08OAAFOKDB@AEP_RAND?$AA@
; `string'
??_C@_08OAAFOKDB@AEP_RAND?$AA@ db 'AEP_RAND',0 ; DATA XREF: .data:00000034o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1F0h
; COMDAT (pick any)
		public ??_C@_0BA@NENPOKPO@AEP_RSA_MOD_EXP?$AA@
; `string'
??_C@_0BA@NENPOKPO@AEP_RSA_MOD_EXP?$AA@	db 'AEP_RSA_MOD_EXP',0 ; DATA XREF: .data:0000003Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 200h
; COMDAT (pick any)
		public ??_C@_0P@BJJHFGDF@already?5loaded?$AA@
; `string'
??_C@_0P@BJJHFGDF@already?5loaded?$AA@ db 'already loaded',0 ; DATA XREF: .data:0000004Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 210h
; COMDAT (pick any)
		public ??_C@_0BF@FOJKPHIP@close?5handles?5failed?$AA@
; `string'
??_C@_0BF@FOJKPHIP@close?5handles?5failed?$AA@ db 'close handles failed',0
					; DATA XREF: .data:00000054o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 228h
; COMDAT (pick any)
		public ??_C@_0BD@FKLPBJLO@connections?5in?5use?$AA@
; `string'
??_C@_0BD@FKLPBJLO@connections?5in?5use?$AA@ db	'connections in use',0
					; DATA XREF: .data:0000005Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 23Ch
; COMDAT (pick any)
		public ??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@
; `string'
??_C@_0BN@NJGGMLOG@ctrl?5command?5not?5implemented?$AA@	db 'ctrl command not implemented',0
					; DATA XREF: .data:off_64o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 25Ch
; COMDAT (pick any)
		public ??_C@_0BA@FAECLOCA@finalize?5failed?$AA@
; `string'
??_C@_0BA@FAECLOCA@finalize?5failed?$AA@ db 'finalize failed',0 ; DATA XREF: .data:off_6Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 26Ch
; COMDAT (pick any)
		public ??_C@_0BC@HCJPFNOA@get?5handle?5failed?$AA@
; `string'
??_C@_0BC@HCJPFNOA@get?5handle?5failed?$AA@ db 'get handle failed',0
					; DATA XREF: .data:off_74o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 280h
; COMDAT (pick any)
		public ??_C@_0BC@JGPFKCAM@get?5random?5failed?$AA@
; `string'
??_C@_0BC@JGPFKCAM@get?5random?5failed?$AA@ db 'get random failed',0
					; DATA XREF: .data:0000007Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 294h
; COMDAT (pick any)
		public ??_C@_0N@LFCGIAOA@init?5failure?$AA@
; `string'
??_C@_0N@LFCGIAOA@init?5failure?$AA@ db	'init failure',0 ; DATA XREF: .data:00000084o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2A4h
; COMDAT (pick any)
		public ??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@
; `string'
??_C@_0BH@KAGGBJK@missing?5key?5components?$AA@	db 'missing key components',0
					; DATA XREF: .data:0000008Co
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2BCh
; COMDAT (pick any)
		public ??_C@_0BD@JLFOKAKM@mod?5exp?5crt?5failed?$AA@
; `string'
??_C@_0BD@JLFOKAKM@mod?5exp?5crt?5failed?$AA@ db 'mod exp crt failed',0
					; DATA XREF: .data:00000094o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2D0h
; COMDAT (pick any)
		public ??_C@_0P@NGHHJKEC@mod?5exp?5failed?$AA@
; `string'
??_C@_0P@NGHHJKEC@mod?5exp?5failed?$AA@	db 'mod exp failed',0 ; DATA XREF: .data:0000009Co
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2E0h
; COMDAT (pick any)
		public ??_C@_0L@ICAFOIA@not?5loaded?$AA@
; `string'
??_C@_0L@ICAFOIA@not?5loaded?$AA@ db 'not loaded',0 ; DATA XREF: .data:000000A4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2ECh
; COMDAT (pick any)
		public ??_C@_02MFDMBIJM@ok?$AA@
; `string'
??_C@_02MFDMBIJM@ok?$AA@ db 6Fh, 6Bh, 0	; DATA XREF: .data:000000ACo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 2F0h
; COMDAT (pick any)
		public ??_C@_0BJ@OKCIHIBG@return?5connection?5failed?$AA@
; `string'
??_C@_0BJ@OKCIHIBG@return?5connection?5failed?$AA@ db 'return connection failed',0
					; DATA XREF: .data:000000B4o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 30Ch
; COMDAT (pick any)
		public ??_C@_0BG@PJDMHIFC@setbncallback?5failure?$AA@
; `string'
??_C@_0BG@PJDMHIFC@setbncallback?5failure?$AA@ db 'setbncallback failure',0
					; DATA XREF: .data:000000BCo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 324h
; COMDAT (pick any)
		public ??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@
; `string'
??_C@_0BM@FJIHNEBE@size?5too?5large?5or?5too?5small?$AA@ db 'size too large or too small',0
					; DATA XREF: .data:000000C4o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 340h
; COMDAT (pick any)
		public ??_C@_0N@JLJLJPMB@unit?5failure?$AA@
; `string'
??_C@_0N@JLJLJPMB@unit?5failure?$AA@ db	'unit failure',0 ; DATA XREF: .data:000000CCo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 350h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
_AEPHK_lib_error_code dd ?		; DATA XREF: _aep_rsa_mod_exp+9r
					; _aep_rsa_mod_exp+17w	...
_recorded_pid	dd ?			; DATA XREF: _aep_get_connection+21r
					; _aep_get_connection+2Dw ...
_aep_dso	dd ?			; DATA XREF: _aep_rsa_mod_expr
					; _aep_ctrl+2r	...
_AEP_LIBNAME	dd ?			; DATA XREF: _aep_destroyr
					; _aep_destroy+19w ...
_p_AEP_OpenConnection dd ?		; DATA XREF: _aep_finish+126w
					; _aep_get_connection+ECr ...
_p_AEP_CloseConnection dd ?		; DATA XREF: _aep_close_all_connections+43r
					; _aep_close_connection+3Br ...
_p_AEP_ModExp	dd ?			; DATA XREF: _aep_finish+130w
					; _aep_init+14Fw ...
_p_AEP_ModExpCrt dd ?			; DATA XREF: _aep_finish+13Aw
					; _aep_init+148w ...
_p_AEP_Initialize dd ?			; DATA XREF: _aep_finish+144w
					; _aep_get_connection+39r ...
_p_AEP_Finalize	dd ?			; DATA XREF: _aep_finish:loc_12CAr
					; _aep_finish+14Ew ...
_p_AEP_SetBNCallBacks dd ?		; DATA XREF: _aep_finish+158w
					; _aep_get_connection+90r ...
		align 10h
_aep_app_conn_table dd ?		; DATA XREF: _aep_close_connection+4Aw
					; _aep_get_connection:loc_14D7w ...
dword_384	dd ?			; DATA XREF: _aep_close_all_connections+27o
					; _aep_close_connection:loc_10C4r ...
		dd 13Eh	dup(?)
dword_880	dd 0BFh	dup(?)		; DATA XREF: .data:_max_key_leno
		db 3 dup(?)
byte_B7F	db ?			; DATA XREF: _aep_close_all_connections+5Ao
					; _aep_finish+6Bo ...
_bss		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B80h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_rsa_mod_exp proc near		; DATA XREF: .data:000000F0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	ds:_aep_dso, 0
		jnz	short loc_BB6
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_B9C
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_B9C:				; CODE XREF: _aep_rsa_mod_exp+10j
		push	309h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Fh ; 'o'
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_BB6:				; CODE XREF: _aep_rsa_mod_exp+7j
		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_C1E
		mov	ecx, [esi+24h]
		test	ecx, ecx
		jz	short loc_C1E
		mov	edx, [esi+28h]
		test	edx, edx
		jz	short loc_C1E
		mov	edi, [esi+2Ch]
		test	edi, edi
		jz	short loc_C1E
		push	[esp+8+arg_C]
		push	edi
		mov	edi, [esp+10h+arg_4]
		push	edx
		push	ecx
		push	eax
		push	dword ptr [esi+1Ch]
		push	edi
		push	[esp+24h+arg_0]
		call	_aep_mod_exp_crt
		add	esp, 20h
		cmp	eax, 10101010h
		jnz	short loc_C15
		call	_RSA_PKCS1_SSLeay
		push	[esp+8+arg_C]
		push	esi
		mov	eax, [eax+14h]
		push	edi
		push	[esp+14h+arg_0]
		call	eax
		add	esp, 10h
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_C15:				; CODE XREF: _aep_rsa_mod_exp+79j
		test	eax, eax
		jz	short loc_C46
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_C1E:				; CODE XREF: _aep_rsa_mod_exp+41j
					; _aep_rsa_mod_exp+48j	...
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_C4E
		mov	ecx, [esi+10h]
		test	ecx, ecx
		jz	short loc_C4E
		push	[esp+8+arg_C]
		push	ecx
		push	eax
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_0]
		call	_aep_mod_exp
		add	esp, 14h
		test	eax, eax
		jnz	short loc_C78

loc_C46:				; CODE XREF: _aep_rsa_mod_exp+97j
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_C4E:				; CODE XREF: _aep_rsa_mod_exp+A3j
					; _aep_rsa_mod_exp+AAj
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_C61
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_C61:				; CODE XREF: _aep_rsa_mod_exp+D5j
		push	31Ch
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Ch ; 'l'
		push	6Bh ; 'k'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

loc_C78:				; CODE XREF: _aep_rsa_mod_exp+C4j
		pop	edi
		xor	eax, eax
		pop	esi

$err$24:
		retn
_aep_rsa_mod_exp endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0C80h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_mod_exp_mont proc near		; DATA XREF: .data:000000F4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	[esp+arg_10]
		push	[esp+4+arg_C]
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	_aep_mod_exp
		add	esp, 14h
		retn
_aep_mod_exp_mont endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0CA0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_dsa_mod_exp proc near		; DATA XREF: _bind_aep+148o

var_14		= byte ptr -14h
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, 14h
		call	__chkstk
		push	ebx
		push	ebp
		push	esi
		lea	eax, [esp+20h+var_14]
		xor	esi, esi
		push	edi
		push	eax
		call	_BN_init
		mov	edi, [esp+28h+arg_1C]
		mov	ebx, [esp+28h+arg_18]
		mov	ebp, [esp+28h+arg_4]
		push	edi
		push	ebx
		push	[esp+30h+arg_C]
		push	[esp+34h+arg_8]
		push	ebp
		call	_aep_mod_exp
		add	esp, 18h
		test	eax, eax
		jz	short $end$7
		push	edi
		push	ebx
		push	[esp+2Ch+arg_14]
		lea	eax, [esp+30h+var_14]
		push	[esp+30h+arg_10]
		push	eax
		call	_aep_mod_exp
		add	esp, 14h
		test	eax, eax
		jz	short $end$7
		push	edi
		push	ebx
		lea	eax, [esp+2Ch+var_14]
		push	eax
		push	ebp
		push	ebp
		call	_BN_mod_mul
		add	esp, 14h
		mov	ecx, 1
		test	eax, eax
		cmovnz	esi, ecx

$end$7:					; CODE XREF: _aep_dsa_mod_exp+3Bj
					; _aep_dsa_mod_exp+56j
		lea	eax, [esp+24h+var_14]
		push	eax
		call	_BN_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
_aep_dsa_mod_exp endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D2Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_mod_exp_dsa proc near		; DATA XREF: _bind_aep+152o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	[esp+arg_14]
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		call	_aep_mod_exp
		add	esp, 14h
		retn
_aep_mod_exp_dsa endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0D4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_mod_exp_dh	proc near		; DATA XREF: .data:off_150o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	[esp+arg_14]
		push	[esp+4+arg_10]
		push	[esp+8+arg_C]
		push	[esp+0Ch+arg_8]
		push	[esp+10h+arg_4]
		call	_aep_mod_exp
		add	esp, 14h
		retn
_aep_mod_exp_dh	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D6Ch
_aep_cmd_defns	dd offset off_C8	; DATA XREF: _bind_aep+CDo
		dd offset ??_C@_07EGEBNIPD@SO_PATH?$AA@	; "SO_PATH"
		dd offset ??_C@_0CP@CNPOBGCF@Specifies?5the?5path?5to?5the?5?8aep?8?5@ ; "Specifies the	path to	the 'aep' shared "...
		dd 2, 4	dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D8Ch
; COMDAT (pick any)
		public ??_C@_07EGEBNIPD@SO_PATH?$AA@
; `string'
??_C@_07EGEBNIPD@SO_PATH?$AA@ db 'SO_PATH',0 ; DATA XREF: .rdata:00000D70o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D94h
; COMDAT (pick any)
		public ??_C@_0CP@CNPOBGCF@Specifies?5the?5path?5to?5the?5?8aep?8?5@
; `string'
??_C@_0CP@CNPOBGCF@Specifies?5the?5path?5to?5the?5?8aep?8?5@ db	'Specifies the path to the ',27h,'aep',27h,' shared library',0
					; DATA XREF: .rdata:00000D74o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DC4h
; COMDAT (pick any)
		public ??_C@_0P@LBHLDOJI@Aep?5RSA?5method?$AA@
; `string'
??_C@_0P@LBHLDOJI@Aep?5RSA?5method?$AA@	db 'Aep RSA method',0 ; DATA XREF: .data:_aep_rsao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DD4h
; COMDAT (pick any)
		public ??_C@_0P@PHDIDABA@Aep?5DSA?5method?$AA@
; `string'
??_C@_0P@PHDIDABA@Aep?5DSA?5method?$AA@	db 'Aep DSA method',0 ; DATA XREF: .data:_aep_dsao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DE4h
; COMDAT (pick any)
		public ??_C@_0O@EKBHJLND@Aep?5DH?5method?$AA@
; `string'
??_C@_0O@EKBHJLND@Aep?5DH?5method?$AA@ db 'Aep DH method',0 ; DATA XREF: .data:_aep_dho
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DF4h
; COMDAT (pick any)
		public ??_C@_03DMACMALI@aep?$AA@
; `string'
??_C@_03DMACMALI@aep?$AA@ dd 706561h	; DATA XREF: .data:_engine_aep_ido
					; _aep_init+40o ...
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DF8h
; COMDAT (pick any)
		public ??_C@_0BM@OJGJAEPI@Aep?5hardware?5engine?5support?$AA@
; `string'
??_C@_0BM@OJGJAEPI@Aep?5hardware?5engine?5support?$AA@ db 'Aep hardware engine support',0
					; DATA XREF: .data:_engine_aep_nameo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E14h
; COMDAT (pick any)
		public ??_C@_0L@GMKCHEGO@AEP_ModExp?$AA@
; `string'
??_C@_0L@GMKCHEGO@AEP_ModExp?$AA@ db 'AEP_ModExp',0 ; DATA XREF: .data:_AEP_F1o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E20h
; COMDAT (pick any)
		public ??_C@_0O@KEEFGPGP@AEP_ModExpCrt?$AA@
; `string'
??_C@_0O@KEEFGPGP@AEP_ModExpCrt?$AA@ db	'AEP_ModExpCrt',0 ; DATA XREF: .data:_AEP_F2o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E30h
; COMDAT (pick any)
		public ??_C@_0N@CJPMELKJ@AEP_Finalize?$AA@
; `string'
??_C@_0N@CJPMELKJ@AEP_Finalize?$AA@ db 'AEP_Finalize',0 ; DATA XREF: .data:_AEP_F4o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E40h
; COMDAT (pick any)
		public ??_C@_0P@OFCEAJEJ@AEP_Initialize?$AA@
; `string'
??_C@_0P@OFCEAJEJ@AEP_Initialize?$AA@ db 'AEP_Initialize',0 ; DATA XREF: .data:_AEP_F5o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E50h
; COMDAT (pick any)
		public ??_C@_0BD@NAIMCHOG@AEP_OpenConnection?$AA@
; `string'
??_C@_0BD@NAIMCHOG@AEP_OpenConnection?$AA@ db 'AEP_OpenConnection',0
					; DATA XREF: .data:_AEP_F6o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E64h
; COMDAT (pick any)
		public ??_C@_0BD@CCHJGDIJ@AEP_SetBNCallBacks?$AA@
; `string'
??_C@_0BD@CCHJGDIJ@AEP_SetBNCallBacks?$AA@ db 'AEP_SetBNCallBacks',0
					; DATA XREF: .data:_AEP_F7o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0E78h
; COMDAT (pick any)
		public ??_C@_0BE@DNJGABLO@AEP_CloseConnection?$AA@
; `string'
??_C@_0BE@DNJGABLO@AEP_CloseConnection?$AA@ db 'AEP_CloseConnection',0
					; DATA XREF: .data:_AEP_F8o
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0E8Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ConvertAEPBigNum proc near		; DATA XREF: _aep_get_connection:loc_1439o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		lea	eax, ds:0[ebx*8]
		cmp	eax, 7FFFFFE0h
		jg	short loc_EC4
		lea	eax, ds:1Fh[ebx*8]
		cdq
		and	edx, 1Fh
		add	eax, edx
		sar	eax, 5
		cmp	eax, [edi+8]
		jle	short loc_EC4
		push	eax
		push	edi
		call	_bn_expand2
		add	esp, 8

loc_EC4:				; CODE XREF: _ConvertAEPBigNum+17j
					; _ConvertAEPBigNum+2Cj
		shr	ebx, 2
		xor	esi, esi
		mov	[edi+4], ebx
		test	ebx, ebx
		jle	short loc_F09
		mov	edx, [esp+0Ch+arg_8]
		add	edx, 2
		nop	dword ptr [eax+eax+00h]

loc_EDC:				; CODE XREF: _ConvertAEPBigNum+7Bj
		movzx	ecx, byte ptr [edx+1]
		lea	edx, [edx+4]
		movzx	eax, byte ptr [edx-4]
		shl	ecx, 8
		or	ecx, eax
		movzx	eax, byte ptr [edx-5]
		shl	ecx, 8
		or	ecx, eax
		movzx	eax, byte ptr [edx-6]
		shl	ecx, 8
		or	ecx, eax
		mov	eax, [edi]
		mov	[eax+esi*4], ecx
		inc	esi
		cmp	esi, [edi+4]
		jl	short loc_EDC

loc_F09:				; CODE XREF: _ConvertAEPBigNum+42j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
_ConvertAEPBigNum endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F10h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_AEPHK_error proc near		; CODE XREF: _aep_finish+FFp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_F23
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_F23:				; CODE XREF: _ERR_AEPHK_error+7j
		push	[esp+arg_C]
		push	[esp+4+arg_8]
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		retn
_ERR_AEPHK_error endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F40h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_load_AEPHK_strings	proc near	; CODE XREF: _bind_aep+182p
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_F53
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_F53:				; CODE XREF: _ERR_load_AEPHK_strings+7j
		cmp	_AEPHK_error_init, 0
		jz	short locret_F84
		push	offset _AEPHK_str_functs
		push	eax
		mov	_AEPHK_error_init, 0
		call	_ERR_load_strings
		push	offset _AEPHK_str_reasons
		push	ds:_AEPHK_lib_error_code
		call	_ERR_load_strings
		add	esp, 10h

locret_F84:				; CODE XREF: _ERR_load_AEPHK_strings+1Aj
		retn
_ERR_load_AEPHK_strings	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0F88h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_ERR_unload_AEPHK_strings proc near
		cmp	_AEPHK_error_init, 0
		jnz	short locret_FBE
		push	offset _AEPHK_str_functs
		push	ds:_AEPHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _AEPHK_str_reasons
		push	ds:_AEPHK_lib_error_code
		call	_ERR_unload_strings
		add	esp, 10h
		mov	_AEPHK_error_init, 1

locret_FBE:				; CODE XREF: _ERR_unload_AEPHK_strings+7j
		retn
_ERR_unload_AEPHK_strings endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FC0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_GetBigNumSize	proc near		; DATA XREF: _aep_get_connection+8Bo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [esp+arg_4]
		shl	ecx, 2
		mov	[eax], ecx
		xor	eax, eax
		retn
_GetBigNumSize	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0FD4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_MakeAEPBigNum	proc near		; DATA XREF: _aep_get_connection+86o

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		xor	esi, esi
		cmp	[ebx+4], esi
		jle	short loc_1017
		push	edi
		mov	edi, [esp+0Ch+arg_8]

loc_FE6:				; CODE XREF: _MakeAEPBigNum+40j
		mov	eax, [ebx]
		lea	edi, [edi+4]
		movzx	edx, byte ptr [eax+esi*4+3]
		lea	ecx, [eax+esi*4]
		movzx	eax, byte ptr [ecx+2]
		inc	esi
		shl	edx, 8
		or	edx, eax
		movzx	eax, byte ptr [ecx+1]
		shl	edx, 8
		or	edx, eax
		movzx	eax, byte ptr [ecx]
		shl	edx, 8
		or	edx, eax
		mov	[edi-4], edx
		cmp	esi, [ebx+4]
		jl	short loc_FE6
		pop	edi

loc_1017:				; CODE XREF: _MakeAEPBigNum+Bj
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
_MakeAEPBigNum	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 101Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_close_all_connections proc	near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_4]
		xor	ebx, ebx
		mov	[edi], ebx
		cmp	[esp+8+arg_0], ebx
		jz	short loc_1042
		push	40Eh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		add	esp, 10h

loc_1042:				; CODE XREF: _aep_close_all_connections+Ej
		push	esi
		mov	esi, offset dword_384
		nop	dword ptr [eax+00h]

loc_104C:				; CODE XREF: _aep_close_all_connections+60j
		mov	eax, [esi-4]
		sub	eax, 1
		jz	short loc_105D
		sub	eax, 1
		jnz	short loc_1073
		inc	dword ptr [edi]
		jmp	short loc_1073
; ---------------------------------------------------------------------------

loc_105D:				; CODE XREF: _aep_close_all_connections+36j
		push	dword ptr [esi]
		call	ds:_p_AEP_CloseConnection
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short $end$21
		mov	[esi-4], eax
		mov	[esi], eax

loc_1073:				; CODE XREF: _aep_close_all_connections+3Bj
					; _aep_close_all_connections+3Fj
		add	esi, 8
		cmp	esi, (offset byte_B7F+5)
		jl	short loc_104C

$end$21:				; CODE XREF: _aep_close_all_connections+50j
		cmp	[esp+0Ch+arg_0], 0
		pop	esi
		jz	short loc_109C
		push	421h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h

loc_109C:				; CODE XREF: _aep_close_all_connections+68j
		pop	edi
		mov	eax, ebx
		pop	ebx
		retn
_aep_close_all_connections endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 10A4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_close_connection proc near		; CODE XREF: _aep_mod_exp+E4p
					; _aep_mod_exp_crt+A5p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	3F2h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	9
		xor	edi, edi
		call	_CRYPTO_lock
		mov	eax, [esp+18h+arg_0]
		add	esp, 10h
		xor	esi, esi

loc_10C4:				; CODE XREF: _aep_close_connection+30j
		cmp	ds:dword_384[esi*8], eax
		jz	short loc_10D8
		inc	esi
		cmp	esi, 100h
		jl	short loc_10C4
		jmp	short $end$14
; ---------------------------------------------------------------------------

loc_10D8:				; CODE XREF: _aep_close_connection+27j
		push	ds:dword_384[esi*8]
		call	ds:_p_AEP_CloseConnection
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short $end$14
		mov	ds:_aep_app_conn_table[esi*8], eax
		mov	ds:dword_384[esi*8], eax

$end$14:				; CODE XREF: _aep_close_connection+32j
					; _aep_close_connection+48j
		push	403h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
_aep_close_connection endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1118h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_ctrl	proc near		; DATA XREF: _bind_aep+B7o

arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		xor	eax, eax
		cmp	ds:_aep_dso, eax
		setnz	al
		cmp	[esp+arg_4], 0C8h ; 'È'
		jz	short loc_115A
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1140
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1140:				; CODE XREF: _aep_ctrl+1Cj
		push	254h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	67h ; 'g'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_115A:				; CODE XREF: _aep_ctrl+13j
		mov	ecx, [esp+arg_C]
		test	ecx, ecx
		jnz	short loc_118F
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1175
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1175:				; CODE XREF: _aep_ctrl+51j
		push	249h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	43h ; 'C'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_118F:				; CODE XREF: _aep_ctrl+48j
		test	eax, eax
		jz	short loc_11C0
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_11A6
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_11A6:				; CODE XREF: _aep_ctrl+82j
		push	24Dh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	64h ; 'd'
		push	64h ; 'd'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_11C0:				; CODE XREF: _aep_ctrl+79j
		push	ecx
		call	_set_AEP_LIBNAME
		add	esp, 4
		retn
_aep_ctrl	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 11CCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_destroy	proc near		; DATA XREF: _bind_aep+8Bo
		mov	eax, ds:_AEP_LIBNAME
		test	eax, eax
		jz	short loc_11DE
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_11DE:				; CODE XREF: _aep_destroy+7j
		cmp	_AEPHK_error_init, 0
		mov	ds:_AEP_LIBNAME, 0
		jnz	short loc_121E
		push	offset _AEPHK_str_functs
		push	ds:_AEPHK_lib_error_code
		call	_ERR_unload_strings
		push	offset _AEPHK_str_reasons
		push	ds:_AEPHK_lib_error_code
		call	_ERR_unload_strings
		add	esp, 10h
		mov	_AEPHK_error_init, 1

loc_121E:				; CODE XREF: _aep_destroy+23j
		mov	eax, 1
		retn
_aep_destroy	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1224h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_finish	proc near		; DATA XREF: _bind_aep+A1o
		cmp	ds:_aep_dso, 0
		jnz	short loc_125A
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1240
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1240:				; CODE XREF: _aep_finish+10j
		push	219h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Fh ; 'o'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_125A:				; CODE XREF: _aep_finish+7j
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, offset dword_384
		nop

loc_1264:				; CODE XREF: _aep_finish+71j
		mov	eax, [esi-4]
		sub	eax, 1
		jz	short loc_1274
		sub	eax, 1
		jnz	short loc_128C
		inc	edi
		jmp	short loc_128C
; ---------------------------------------------------------------------------

loc_1274:				; CODE XREF: _aep_finish+46j
		push	dword ptr [esi]
		call	ds:_p_AEP_CloseConnection
		add	esp, 4
		test	eax, eax
		jnz	loc_1388
		mov	[esi-4], eax
		mov	[esi], eax

loc_128C:				; CODE XREF: _aep_finish+4Bj
					; _aep_finish+4Ej
		add	esi, 8
		cmp	esi, (offset byte_B7F+5)
		jl	short loc_1264
		test	edi, edi
		jz	short loc_12CA
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_12AE
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_12AE:				; CODE XREF: _aep_finish+7Ej
		push	223h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	66h ; 'f'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_12CA:				; CODE XREF: _aep_finish+75j
		call	ds:_p_AEP_Finalize
		test	eax, eax
		jz	short loc_1303
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_12E7
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_12E7:				; CODE XREF: _aep_finish+B7j
		push	229h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	68h ; 'h'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1303:				; CODE XREF: _aep_finish+AEj
		push	ds:_aep_dso
		call	_DSO_free
		add	esp, 4
		test	eax, eax
		jnz	short loc_1330
		push	22Eh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	73h ; 's'
		push	65h ; 'e'
		call	_ERR_AEPHK_error
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1330:				; CODE XREF: _aep_finish+EFj
		pop	edi
		mov	ds:_aep_dso, 0
		mov	eax, 1
		mov	ds:_p_AEP_CloseConnection, 0
		mov	ds:_p_AEP_OpenConnection, 0
		mov	ds:_p_AEP_ModExp, 0
		mov	ds:_p_AEP_ModExpCrt, 0
		mov	ds:_p_AEP_Initialize, 0
		mov	ds:_p_AEP_Finalize, 0
		mov	ds:_p_AEP_SetBNCallBacks, 0
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1388:				; CODE XREF: _aep_finish+5Dj
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_139B
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_139B:				; CODE XREF: _aep_finish+16Bj
		push	21Fh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	65h ; 'e'
		push	65h ; 'e'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		xor	eax, eax

$err$44:
		pop	edi
		pop	esi
		retn
_aep_finish	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 13B8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_get_connection proc near		; CODE XREF: _aep_mod_exp+6Cp
					; _aep_mod_exp_crt+Ep

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		push	36Ah
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	9
		xor	edi, edi
		call	_CRYPTO_lock
		add	esp, 10h
		call	dword ptr ds:__imp___getpid
		cmp	ds:_recorded_pid, eax
		jz	loc_14ED
		mov	ds:_recorded_pid, eax
		call	ds:_p_AEP_Finalize
		push	edi
		call	ds:_p_AEP_Initialize
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1439
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1413
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1413:				; CODE XREF: _aep_get_connection+4Fj
		push	384h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Bh ; 'k'

loc_141F:				; CODE XREF: _aep_get_connection+BEj
					; _aep_get_connection+11Aj
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		mov	ds:_recorded_pid, 0
		jmp	$end$47
; ---------------------------------------------------------------------------

loc_1439:				; CODE XREF: _aep_get_connection+46j
		push	offset _ConvertAEPBigNum
		push	offset _MakeAEPBigNum
		push	offset _GetBigNumSize
		call	ds:_p_AEP_SetBNCallBacks
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_1478
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_146A
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_146A:				; CODE XREF: _aep_get_connection+A6j
		push	391h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	72h ; 'r'
		jmp	short loc_141F
; ---------------------------------------------------------------------------

loc_1478:				; CODE XREF: _aep_get_connection+9Dj
		mov	eax, offset dword_384
		db	66h, 66h
		nop	word ptr [eax+eax+00000000h]

loc_1488:				; CODE XREF: _aep_get_connection+E5j
		mov	dword ptr [eax-4], 0
		mov	dword ptr [eax], 0
		add	eax, 8
		cmp	eax, (offset byte_B7F+5)
		jl	short loc_1488
		mov	esi, [esp+0Ch+arg_0]
		push	esi
		call	ds:_p_AEP_OpenConnection
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_14D7
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_14C6
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_14C6:				; CODE XREF: _aep_get_connection+102j
		push	3AAh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	73h ; 's'
		jmp	loc_141F
; ---------------------------------------------------------------------------

loc_14D7:				; CODE XREF: _aep_get_connection+F9j
		mov	ds:_aep_app_conn_table,	2
		mov	eax, [esi]
		mov	ds:dword_384, eax
		jmp	$end$47
; ---------------------------------------------------------------------------

loc_14ED:				; CODE XREF: _aep_get_connection+27j
		xor	ecx, ecx
		nop	word ptr [eax+eax+00000000h]

loc_14F8:				; CODE XREF: _aep_get_connection+151j
		cmp	ds:_aep_app_conn_table[ecx*8], 1
		jz	short loc_157C
		inc	ecx
		cmp	ecx, 100h
		jl	short loc_14F8
		xor	esi, esi

loc_150D:				; CODE XREF: _aep_get_connection+165j
		cmp	ds:_aep_app_conn_table[esi*8], edi
		jz	short loc_1526
		inc	esi
		cmp	esi, 100h
		jl	short loc_150D
		mov	edi, 10000001h
		jmp	short $end$47
; ---------------------------------------------------------------------------

loc_1526:				; CODE XREF: _aep_get_connection+15Cj
		mov	ebx, [esp+0Ch+arg_0]
		push	ebx
		call	ds:_p_AEP_OpenConnection
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1566
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_154D
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_154D:				; CODE XREF: _aep_get_connection+189j
		push	3C9h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	73h ; 's'
		push	66h ; 'f'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		jmp	short $end$47
; ---------------------------------------------------------------------------

loc_1566:				; CODE XREF: _aep_get_connection+180j
		mov	ds:_aep_app_conn_table[esi*8], 2
		mov	eax, [ebx]
		mov	ds:dword_384[esi*8], eax
		jmp	short $end$47
; ---------------------------------------------------------------------------

loc_157C:				; CODE XREF: _aep_get_connection+148j
		mov	eax, [esp+0Ch+arg_0]
		mov	ds:_aep_app_conn_table[ecx*8], 2
		mov	ecx, ds:dword_384[ecx*8]
		mov	[eax], ecx

$end$47:				; CODE XREF: _aep_get_connection+7Cj
					; _aep_get_connection+130j ...
		push	3D4h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
_aep_get_connection endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 15B0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_init	proc near		; DATA XREF: _bind_aep+75o

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	eax, 8
		call	__chkstk
		cmp	ds:_aep_dso, 0
		push	ebx
		push	ebp
		push	esi
		push	edi
		jz	short loc_15EB
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_15DA
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_15DA:				; CODE XREF: _aep_init+1Ej
		push	1CCh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	64h ; 'd'
		jmp	loc_1750
; ---------------------------------------------------------------------------

loc_15EB:				; CODE XREF: _aep_init+15j
		mov	eax, ds:_AEP_LIBNAME
		mov	ecx, offset ??_C@_03DMACMALI@aep?$AA@ ;	`string'
		test	eax, eax
		push	0
		cmovnz	ecx, eax
		push	0
		push	ecx
		push	0
		call	_DSO_load
		add	esp, 10h
		mov	ds:_aep_dso, eax
		test	eax, eax
		jnz	short loc_162F
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1625
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1625:				; CODE XREF: _aep_init+69j
		push	1D4h
		jmp	loc_1749
; ---------------------------------------------------------------------------

loc_162F:				; CODE XREF: _aep_init+60j
		push	_AEP_F1
		push	eax
		call	_DSO_bind_func
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_1731
		push	_AEP_F2
		push	ds:_aep_dso
		call	_DSO_bind_func
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	loc_1731
		push	_AEP_F4
		push	ds:_aep_dso
		call	_DSO_bind_func
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jz	loc_1731
		push	_AEP_F5
		push	ds:_aep_dso
		call	_DSO_bind_func
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	loc_1731
		push	_AEP_F6
		push	ds:_aep_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+18h+var_8], eax
		test	eax, eax
		jz	short loc_1731
		push	_AEP_F7
		push	ds:_aep_dso
		call	_DSO_bind_func
		add	esp, 8
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_1731
		push	_AEP_F8
		push	ds:_aep_dso
		call	_DSO_bind_func
		mov	ecx, eax
		add	esp, 8
		test	ecx, ecx
		jz	short loc_1731
		mov	eax, [esp+18h+var_8]
		mov	ds:_p_AEP_ModExpCrt, edi
		pop	edi
		mov	ds:_p_AEP_ModExp, esi
		pop	esi
		mov	ds:_p_AEP_OpenConnection, eax
		mov	eax, [esp+10h+var_4]
		mov	ds:_p_AEP_Initialize, ebp
		pop	ebp
		mov	ds:_p_AEP_Finalize, ebx
		mov	ds:_p_AEP_SetBNCallBacks, eax
		mov	eax, 1
		mov	ds:_p_AEP_CloseConnection, ecx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1731:				; CODE XREF: _aep_init+92j
					; _aep_init+B0j ...
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1744
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1744:				; CODE XREF: _aep_init+188j
		push	1E2h

loc_1749:				; CODE XREF: _aep_init+7Aj
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Fh ; 'o'

loc_1750:				; CODE XREF: _aep_init+36j
		push	67h ; 'g'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$23:
		mov	eax, ds:_aep_dso
		test	eax, eax
		jz	short loc_176D
		push	eax
		call	_DSO_free
		add	esp, 4

loc_176D:				; CODE XREF: _aep_init+1B2j
		pop	edi
		pop	esi
		pop	ebp
		mov	ds:_aep_dso, 0
		xor	eax, eax
		mov	ds:_p_AEP_OpenConnection, 0
		mov	ds:_p_AEP_ModExp, 0
		mov	ds:_p_AEP_ModExpCrt, 0
		mov	ds:_p_AEP_Initialize, 0
		mov	ds:_p_AEP_Finalize, 0
		mov	ds:_p_AEP_SetBNCallBacks, 0
		mov	ds:_p_AEP_CloseConnection, 0
		pop	ebx
		add	esp, 8
		retn
_aep_init	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 17C8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_mod_exp	proc near		; CODE XREF: _aep_rsa_mod_exp+BAp
					; _aep_mod_exp_mont+14p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, 4
		call	__chkstk
		push	esi
		mov	esi, [esp+8+arg_C]
		push	edi
		push	esi
		xor	edi, edi
		call	_BN_num_bits
		add	esp, 4
		cmp	eax, _max_key_len
		jle	short loc_182F
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_17FE
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_17FE:				; CODE XREF: _aep_mod_exp+2Aj
		push	265h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	74h ; 't'

loc_180A:				; CODE XREF: _aep_mod_exp+97j
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		push	[esp+20h+arg_10]
		push	esi
		push	[esp+28h+arg_8]
		push	[esp+2Ch+arg_4]
		push	[esp+30h+arg_0]
		call	_BN_mod_exp
		add	esp, 28h
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_182F:				; CODE XREF: _aep_mod_exp+21j
		lea	eax, [esp+0Ch+var_4]
		push	eax
		call	_aep_get_connection
		add	esp, 4
		test	eax, eax
		jz	short loc_1861
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1853
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1853:				; CODE XREF: _aep_mod_exp+7Fj
		push	26Eh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	69h ; 'i'
		jmp	short loc_180A
; ---------------------------------------------------------------------------

loc_1861:				; CODE XREF: _aep_mod_exp+76j
		push	0
		push	[esp+10h+arg_0]
		push	esi
		push	[esp+18h+arg_8]
		push	[esp+1Ch+arg_4]
		push	[esp+20h+var_4]
		call	ds:_p_AEP_ModExp
		add	esp, 18h
		test	eax, eax
		jz	short loc_18CE
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1894
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1894:				; CODE XREF: _aep_mod_exp+C0j
		push	279h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Eh ; 'n'
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		push	[esp+20h+var_4]
		call	_aep_close_connection
		push	[esp+24h+arg_10]
		push	esi
		push	[esp+2Ch+arg_8]
		push	[esp+30h+arg_4]
		push	[esp+34h+arg_0]
		call	_BN_mod_exp
		add	esp, 2Ch
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_18CE:				; CODE XREF: _aep_mod_exp+B7j
		push	[esp+0Ch+var_4]
		call	_aep_return_connection
		add	esp, 4
		test	eax, eax
		jz	short loc_190E
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_18F1
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_18F1:				; CODE XREF: _aep_mod_exp+11Dj
		push	283h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	71h ; 'q'
		push	68h ; 'h'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_190E:				; CODE XREF: _aep_mod_exp+114j
		mov	edi, 1

$err$21:
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ecx
		retn
_aep_mod_exp	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 191Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_mod_exp_crt proc near		; CODE XREF: _aep_rsa_mod_exp+6Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	eax, 4
		call	__chkstk
		lea	eax, [esp+4+var_4]
		push	eax
		call	_aep_get_connection
		add	esp, 4
		test	eax, eax
		jz	short loc_1967
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_1949
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_1949:				; CODE XREF: _aep_mod_exp_crt+21j
		push	29Ah
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	69h ; 'i'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h
		mov	eax, 10101010h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1967:				; CODE XREF: _aep_mod_exp_crt+18j
		push	0
		push	[esp+8+arg_0]
		push	[esp+0Ch+arg_18]
		push	[esp+10h+arg_14]
		push	[esp+14h+arg_10]
		push	[esp+18h+arg_C]
		push	[esp+1Ch+arg_8]
		push	[esp+20h+arg_4]
		push	[esp+24h+var_4]
		call	ds:_p_AEP_ModExpCrt
		add	esp, 24h
		test	eax, eax
		jz	short loc_19D0
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_19A9
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_19A9:				; CODE XREF: _aep_mod_exp_crt+81j
		push	2A5h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	6Dh ; 'm'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		push	[esp+18h+var_4]
		call	_aep_close_connection
		add	esp, 18h
		mov	eax, 10101010h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_19D0:				; CODE XREF: _aep_mod_exp_crt+78j
		push	esi
		push	[esp+8+var_4]
		call	_aep_return_connection
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short $err$16
		mov	eax, ds:_AEPHK_lib_error_code
		test	eax, eax
		jnz	short loc_19F6
		call	_ERR_get_next_error_library
		mov	ds:_AEPHK_lib_error_code, eax

loc_19F6:				; CODE XREF: _aep_mod_exp_crt+CEj
		push	2AFh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	71h ; 'q'
		push	69h ; 'i'
		push	eax
		call	_ERR_put_error
		add	esp, 14h

$err$16:				; CODE XREF: _aep_mod_exp_crt+C5j
		mov	eax, esi
		pop	esi
		pop	ecx
		retn
_aep_mod_exp_crt endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A14h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_aep_return_connection proc near	; CODE XREF: _aep_mod_exp+10Ap
					; _aep_mod_exp_crt+B9p

arg_0		= dword	ptr  4

		push	3DCh
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	9
		call	_CRYPTO_lock
		mov	ecx, [esp+10h+arg_0]
		add	esp, 10h
		xor	eax, eax
		nop	dword ptr [eax+00h]

loc_1A34:				; CODE XREF: _aep_return_connection+2Fj
		cmp	ds:dword_384[eax*8], ecx
		jz	short loc_1A47
		inc	eax
		cmp	eax, 100h
		jl	short loc_1A34
		jmp	short loc_1A52
; ---------------------------------------------------------------------------

loc_1A47:				; CODE XREF: _aep_return_connection+27j
		mov	ds:_aep_app_conn_table[eax*8], 1

loc_1A52:				; CODE XREF: _aep_return_connection+31j
		push	3E8h
		push	offset ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ ; ".\\engines\\e_aep.c"
		push	1Eh
		push	0Ah
		call	_CRYPTO_lock
		add	esp, 10h
		xor	eax, eax
		retn
_aep_return_connection endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1A6Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_aep	proc near		; CODE XREF: _bind_engine+B1p
					; _bind_helper+40p

arg_0		= dword	ptr  4

		push	esi
		push	_engine_aep_id
		mov	esi, [esp+8+arg_0]
		push	esi
		call	_ENGINE_set_id
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	_engine_aep_name
		push	esi
		call	_ENGINE_set_name
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_rsa
		push	esi
		call	_ENGINE_set_RSA
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_dsa
		push	esi
		call	_ENGINE_set_DSA
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_dh
		push	esi
		call	_ENGINE_set_DH
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_init
		push	esi
		call	_ENGINE_set_init_function
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_destroy
		push	esi
		call	_ENGINE_set_destroy_function
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_finish
		push	esi
		call	_ENGINE_set_finish_function
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_ctrl
		push	esi
		call	_ENGINE_set_ctrl_function
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		push	offset _aep_cmd_defns
		push	esi
		call	_ENGINE_set_cmd_defns
		add	esp, 8
		test	eax, eax
		jz	loc_1BFA
		call	_RSA_PKCS1_SSLeay
		mov	ecx, [eax+4]
		mov	dword_E0, ecx
		mov	ecx, [eax+8]
		mov	dword_E4, ecx
		mov	ecx, [eax+0Ch]
		mov	dword_E8, ecx
		mov	eax, [eax+10h]
		mov	dword_EC, eax
		call	_DSA_OpenSSL
		mov	ecx, [eax+4]
		mov	dword_118, ecx
		mov	ecx, [eax+8]
		mov	dword_11C, ecx
		mov	eax, [eax+0Ch]
		mov	dword_120, eax
		call	_DSA_get_default_method
		movups	xmm0, xmmword ptr [eax]
		movups	xmmword	ptr _aep_dsa, xmm0
		movups	xmm0, xmmword ptr [eax+10h]
		movups	off_124, xmm0
		movups	xmm0, xmmword ptr [eax+20h]
		mov	dword ptr off_124, offset _aep_dsa_mod_exp
		mov	dword ptr off_124+4, offset _aep_mod_exp_dsa
		movups	xmmword_134, xmm0
		call	_DH_OpenSSL
		mov	ecx, [eax+4]
		mov	dword_148, ecx
		mov	ecx, [eax+8]
		mov	dword_14C, ecx
		mov	eax, [eax+0Ch]
		mov	off_150, eax
		call	_ERR_load_AEPHK_strings
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1BFA:				; CODE XREF: _bind_aep+16j
					; _bind_aep+2Dj ...
		xor	eax, eax
		pop	esi
		retn
_bind_aep	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1C00h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _bind_engine
_bind_engine	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	_ENGINE_get_static_state
		mov	esi, [esp+4+arg_8]
		cmp	eax, [esi]
		jz	short $skip_cbs$19
		push	dword ptr [esi+14h]
		push	dword ptr [esi+10h]
		push	dword ptr [esi+0Ch]
		call	_CRYPTO_set_mem_functions
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1C27

loc_1C23:				; CODE XREF: _bind_engine+5Cj
					; _bind_engine+6Bj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1C27:				; CODE XREF: _bind_engine+21j
		push	dword ptr [esi+18h]
		call	_CRYPTO_set_locking_callback
		push	dword ptr [esi+1Ch]
		call	_CRYPTO_set_add_lock_callback
		push	dword ptr [esi+20h]
		call	_CRYPTO_set_dynlock_create_callback
		push	dword ptr [esi+24h]
		call	_CRYPTO_set_dynlock_lock_callback
		push	dword ptr [esi+28h]
		call	_CRYPTO_set_dynlock_destroy_callback
		push	dword ptr [esi+8]
		call	_CRYPTO_set_ex_data_implementation
		add	esp, 18h
		test	eax, eax
		jz	short loc_1C23
		push	dword ptr [esi+4]
		call	_ERR_set_implementation
		add	esp, 4
		test	eax, eax
		jz	short loc_1C23

$skip_cbs$19:				; CODE XREF: _bind_engine+Cj
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jz	short loc_1CAD
		mov	ecx, _engine_aep_id
		nop	dword ptr [eax+eax+00h]

loc_1C80:				; CODE XREF: _bind_engine+9Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1CA0
		test	dl, dl
		jz	short loc_1C9C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1CA0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1C80

loc_1C9C:				; CODE XREF: _bind_engine+88j
		xor	eax, eax
		jmp	short loc_1CA5
; ---------------------------------------------------------------------------

loc_1CA0:				; CODE XREF: _bind_engine+84j
					; _bind_engine+90j
		sbb	eax, eax
		or	eax, 1

loc_1CA5:				; CODE XREF: _bind_engine+9Ej
		test	eax, eax
		jnz	loc_1C23

loc_1CAD:				; CODE XREF: _bind_engine+73j
		push	[esp+4+arg_0]
		call	_bind_aep
		add	esp, 4
		test	eax, eax
		jz	loc_1C23
		mov	eax, 1
		pop	esi
		retn
_bind_engine	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1CC8h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_bind_helper	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_1D04
		mov	ecx, _engine_aep_id
		xchg	ax, ax

loc_1CD8:				; CODE XREF: _bind_helper+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1CF8
		test	dl, dl
		jz	short loc_1CF4
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1CF8
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1CD8

loc_1CF4:				; CODE XREF: _bind_helper+18j
		xor	eax, eax
		jmp	short loc_1CFD
; ---------------------------------------------------------------------------

loc_1CF8:				; CODE XREF: _bind_helper+14j
					; _bind_helper+20j
		sbb	eax, eax
		or	eax, 1

loc_1CFD:				; CODE XREF: _bind_helper+2Ej
		test	eax, eax
		jz	short loc_1D04
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1D04:				; CODE XREF: _bind_helper+6j
					; _bind_helper+37j
		push	[esp+arg_0]
		call	_bind_aep
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
_bind_helper	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D18h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_free_AEP_LIBNAME proc near
		mov	eax, ds:_AEP_LIBNAME
		test	eax, eax
		jz	short loc_1D2A
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1D2A:				; CODE XREF: _free_AEP_LIBNAME+7j
		mov	ds:_AEP_LIBNAME, 0
		retn
_free_AEP_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D38h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_get_AEP_LIBNAME proc near
		mov	ecx, ds:_AEP_LIBNAME
		mov	eax, offset ??_C@_03DMACMALI@aep?$AA@ ;	`string'
		test	ecx, ecx
		cmovnz	eax, ecx
		retn
_get_AEP_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D4Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_set_AEP_LIBNAME proc near		; CODE XREF: _aep_ctrl+A9p

arg_0		= dword	ptr  4

		mov	eax, ds:_AEP_LIBNAME
		test	eax, eax
		jz	short loc_1D5E
		push	eax
		call	_CRYPTO_free
		add	esp, 4

loc_1D5E:				; CODE XREF: _set_AEP_LIBNAME+7j
		push	[esp+arg_0]
		mov	ds:_AEP_LIBNAME, 0
		call	_BUF_strdup
		xor	ecx, ecx
		mov	ds:_AEP_LIBNAME, eax
		add	esp, 4
		test	eax, eax
		setnz	cl
		mov	eax, ecx
		retn
_set_AEP_LIBNAME endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 1D84h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _v_check
_v_check	proc near

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 20000h
		sbb	eax, eax
		and	eax, 0FFFE0000h
		add	eax, 20000h
		retn
_v_check	endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1D9Ch
; COMDAT (pick any)
		public ??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@
; `string'
??_C@_0BC@COILBPEP@?4?2engines?2e_aep?4c?$AA@ db '.\engines\e_aep.c',0
					; DATA XREF: _aep_rsa_mod_exp+21o
					; _aep_rsa_mod_exp+E6o	...
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _CRYPTO_set_ex_data_implementation:near ;	CODE XREF: _bind_engine+52p
		extrn _CRYPTO_lock:near	; CODE XREF: _aep_close_all_connections+1Ep
					; _aep_close_all_connections+78p ...
		extrn _CRYPTO_set_locking_callback:near	; CODE XREF: _bind_engine+2Ap
		extrn _CRYPTO_set_add_lock_callback:near ; CODE	XREF: _bind_engine+32p
		extrn _CRYPTO_set_dynlock_create_callback:near ; CODE XREF: _bind_engine+3Ap
		extrn _CRYPTO_set_dynlock_lock_callback:near ; CODE XREF: _bind_engine+42p
		extrn _CRYPTO_set_dynlock_destroy_callback:near
					; CODE XREF: _bind_engine+4Ap
		extrn _CRYPTO_set_mem_functions:near ; CODE XREF: _bind_engine+17p
		extrn _CRYPTO_free:near	; CODE XREF: _aep_destroy+Ap
					; _free_AEP_LIBNAME+Ap	...
		extrn _BN_num_bits:near	; CODE XREF: _aep_mod_exp+13p
		extrn _BN_init:near	; CODE XREF: _aep_dsa_mod_exp+15p
		extrn _BN_mod_mul:near	; CODE XREF: _aep_dsa_mod_exp+61p
		extrn _BN_free:near	; CODE XREF: _aep_dsa_mod_exp+78p
		extrn _BN_mod_exp:near	; CODE XREF: _aep_mod_exp+5Bp
					; _aep_mod_exp+FAp
		extrn _bn_expand2:near	; CODE XREF: _ConvertAEPBigNum+30p
		extrn __imp___getpid:near ; CODE XREF: _aep_get_connection+1Bp
					; DATA XREF: _aep_get_connection+1Br
		extrn _DSO_free:near	; CODE XREF: _aep_finish+E5p
					; _aep_init+1B5p
		extrn _DSO_load:near	; CODE XREF: _aep_init+51p
		extrn _DSO_bind_func:near ; CODE XREF: _aep_init+86p
					; _aep_init+A4p ...
		extrn _RSA_PKCS1_SSLeay:near ; CODE XREF: _aep_rsa_mod_exp+7Bp
					; _bind_aep+E3p
		extrn _DH_OpenSSL:near	; CODE XREF: _bind_aep+163p
		extrn _DSA_OpenSSL:near	; CODE XREF: _bind_aep+10Bp
		extrn _DSA_get_default_method:near ; CODE XREF:	_bind_aep+12Ap
		extrn _ERR_put_error:near ; CODE XREF: _aep_rsa_mod_exp+2Bp
					; _aep_rsa_mod_exp+F0p	...
		extrn _ERR_load_strings:near ; CODE XREF: _ERR_load_AEPHK_strings+2Cp
					; _ERR_load_AEPHK_strings+3Cp
		extrn _ERR_unload_strings:near ; CODE XREF: _ERR_unload_AEPHK_strings+14p
					; _ERR_unload_AEPHK_strings+24p ...
		extrn _ERR_get_next_error_library:near ; CODE XREF: _aep_rsa_mod_exp+12p
					; _aep_rsa_mod_exp+D7p	...
		extrn _ERR_set_implementation:near ; CODE XREF:	_bind_engine+61p
		extrn _BUF_strdup:near	; CODE XREF: _set_AEP_LIBNAME+20p
		extrn _ENGINE_set_id:near ; CODE XREF: _bind_aep+Cp
		extrn _ENGINE_set_name:near ; CODE XREF: _bind_aep+23p
		extrn _ENGINE_set_RSA:near ; CODE XREF:	_bind_aep+39p
		extrn _ENGINE_set_DSA:near ; CODE XREF:	_bind_aep+4Fp
		extrn _ENGINE_set_DH:near ; CODE XREF: _bind_aep+65p
		extrn _ENGINE_set_destroy_function:near	; CODE XREF: _bind_aep+91p
		extrn _ENGINE_set_init_function:near ; CODE XREF: _bind_aep+7Bp
		extrn _ENGINE_set_finish_function:near ; CODE XREF: _bind_aep+A7p
		extrn _ENGINE_set_ctrl_function:near ; CODE XREF: _bind_aep+BDp
		extrn _ENGINE_set_cmd_defns:near ; CODE	XREF: _bind_aep+D3p
		extrn _ENGINE_get_static_state:near ; CODE XREF: _bind_engine+1p
		extrn __chkstk:near	; CODE XREF: _aep_dsa_mod_exp+5p
					; _aep_init+5p	...


		end
