;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	2964DA1A258C2D7C9F696CC4FB4EAB27
; Input	CRC32 :	0F44CAFA

; File Name   :	C:\compspace\Diff\openssl\obj\evp_extra_test.obj
; Format      :	COFF (X386MAGIC)
; includelib "MSVCRT"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_kExampleRSAKeyDER dd 5C028230h, 2000102h, 0F8008181h, 0B4836CB8h, 57A8D9BCh
					; DATA XREF: _load_example_rsa_key+14o
					; _main+95o
		dd 59B4A5C0h, 1D548C76h, 5222EB79h, 37D37E04h, 83FD41EBh
		dd 85A6F0F9h, 71753415h, 3CA8845Ah, 4E5AEFD2h, 8A97DED3h
		dd 0CFBBFFDDh, 9286AA0Ah, 0E450B8BEh, 33806FCDh, 8F137630h
		dd 0ECDC7BCAh, 0C763CA5Ah, 0A8EF2503h, 7658838Ah, 7716FA20h
		dd 639279D7h, 0D81A4801h, 52F1677Bh, 0D64E4955h, 0D75C4A6Eh
		dd 0C36377Ah, 448FDDDEh, 2CA7C2E8h, 64AFB52Bh, 207614Bh
		dd 1000103h, 74808102h,	693F6488h, 0C76D3A45h, 0C0A3B97Fh
		dd 0D4DCEC6Eh, 8532B55Ah, 0F8D4195Fh, 0FA3C3FD4h, 0EE5FF6C2h
		dd 7487BAE6h, 0D40CC72Eh, 8566B842h, 61247B9Ch,	0F61116AAh
		dd 0AA4B6B5h, 812E55C9h, 0CB6147A5h, 15C28F25h,	367C0E7Bh
		dd 58DA3A9Fh, 835B1C86h, 0CC2BE679h, 612CFAE6h,	1B8078F2h
		dd 399DF3E2h, 9157652Bh, 7399713Dh, 2079C2A5h, 0E54F078Ch
		dd 991F60B4h, 0C4FB1A2h, 5359BCEFh, 2B17D00h, 7EFC0041h
		dd 0F8706523h, 4140D3CEh, 11D6A80h, 0B6FF01D6h,	593D3D1Bh
		dd 0C0793309h, 2796DE4Fh, 0D9C6184Bh, 35F4F178h, 427CE946h
		dd 0EF9F5D7Ah, 9FF7B854h, 0F36C33C4h, 8746328Ch, 0A77B3067h
		dd 4102E3ACh, 0DF2CFC00h, 0F5880D0Ch, 93A892B1h, 0F5556347h
		dd 0BA4358CAh, 0B69EE51Ch, 0B5CD0595h, 4EBDF82h, 0C2BD9D53h
		dd 62B31638h, 0DB46A1DDh, 9F93976Dh, 649BC38Ah,	32E3427Eh
		dd 0D51B1957h, 0B8FA856Eh, 41028Dh, 6DDE3DBCh, 0BAE897D6h
		dd 1737819Eh, 0C964A0E5h, 0FEE7B700h, 2ED929F4h, 20196B43h
		dd 0E77599BDh, 0AED3F876h, 0EBB87EAFh, 0FE9DF481h, 630B2B07h
		dd 90555A0Bh, 0DBF17D71h, 4141B1D9h, 394E2F68h,	345A4002h
		dd 0E2F5D866h, 0B5187Fh, 2784266Eh, 0FCFB9314h,	275E0FC6h
		dd 0C0E9E1E6h, 0DA34E48Ah, 734BA2E9h, 0BAB98CBCh, 2B7A6C13h
		dd 4AA38451h, 61030E0h,	5A17ED7Eh, 0EFC90014h, 2C52EA85h
		dd 400265BCh, 83F2E351h, 1EC49B19h, 0DF3D502Fh,	0CA18A25Ah
		dd 0AF492E5Fh, 65FACC6Fh, 0A1B59477h, 8AD1A90Ah, 0BF43739h
		dd 2782D7A0h, 1717AE5Eh, 34541EA1h, 8EC46EBFh, 0F1085D99h
		dd 0A59D862Dh, 0DFE51B20h
_kMsg		dd 4030201h, 0		; DATA XREF: _test_EVP_DigestSignInit+57o
					; _test_EVP_DigestSignInit+14Bo ...
_kSignature	dd 478AF0A5h, 0CCB33C5Dh, 4DAF79A9h, 144CAE8Ch,	340BC2EFh
					; DATA XREF: _test_EVP_DigestVerifyInit+61o
		dd 3EF4DE36h, 604ABB3Dh, 2891C85Ch, 47EFBDAh, 13637E96h
		dd 0B4B9CE90h, 9FD7A62h, 7867C73Dh, 52EB0454h, 67246E62h
		dd 57FC40B4h, 67F1C662h, 6A8F97C1h, 4644AEA8h, 1767AB5Eh
		dd 0DA3A1953h, 3E16C85Ah, 71C5D586h, 4823FC2Fh,	0DD130BD9h
		dd 79255A7Bh, 47BA5EFh,	18F644EDh, 0E90AE455h, 0D75D7957h
		dd 45ABA755h, 42609702h
_kExampleRSAKeyPKCS8 dd	76028230h, 30000102h, 2A09060Dh, 0F7864886h, 101010Dh
					; DATA XREF: _main+CCo
		dd 82040005h, 82306002h, 1025C02h, 81810200h, 6CB8F800h
		dd 0D9BCB483h, 0A5C057A8h, 8C7659B4h, 0EB791D54h, 7E045222h
		dd 41EB37D3h, 0F0F983FDh, 341585A6h, 845A7175h,	0EFD23CA8h
		dd 0DED34E5Ah, 0FFDD8A97h, 0AA0ACFBBh, 0B8BE9286h, 6FCDE450h
		dd 76303380h, 7BCA8F13h, 0CA5AECDCh, 2503C763h,	838AA8EFh
		dd 0FA207658h, 79D77716h, 48016392h, 677BD81Ah,	495552F1h
		dd 4A6ED64Eh, 377AD75Ch, 0DDDE0C36h, 0C2E8448Fh, 0B52B2CA7h
		dd 614B64AFh, 1030207h,	81020100h, 64887480h, 3A45693Fh
		dd 0B97FC76Dh, 0EC6EC0A3h, 0B55AD4DCh, 195F8532h, 3FD4F8D4h
		dd 0F6C2FA3Ch, 0BAE6EE5Fh, 0C72E7487h, 0B842D40Ch, 7B9C8566h
		dd 16AA6124h, 0B6B5F611h, 55C90AA4h, 47A5812Eh,	8F25CB61h
		dd 0E7B15C2h, 3A9F367Ch, 1C8658DAh, 0E679835Bh,	0FAE6CC2Bh
		dd 78F2612Ch, 0F3E21B80h, 652B399Dh, 713D9157h,	0C2A57399h
		dd 78C2079h, 60B4E54Fh,	0B1A2991Fh, 0BCEF0C4Fh,	7D005359h
		dd 4102B1h, 65237EFCh, 0D3CEF870h, 6A804140h, 1D6011Dh
		dd 3D1BB6FFh, 3309593Dh, 0DE4FC079h, 184B2796h,	0F178D9C6h
		dd 0E94635F4h, 5D7A427Ch, 0B854EF9Fh, 33C49FF7h, 328CF36Ch
		dd 30678746h, 0E3ACA77Bh, 0FC004102h, 0D0CDF2Ch, 92B1F588h
		dd 634793A8h, 58CAF555h, 0E51CBA43h, 595B69Eh, 0DF82B5CDh
		dd 9D5304EBh, 1638C2BDh, 0A1DD62B3h, 976DDB46h,	0C38A9F93h
		dd 427E649Bh, 195732E3h, 856ED51Bh, 28DB8FAh, 3DBC0041h
		dd 97D66DDEh, 819EBAE8h, 0A0E51737h, 0B700C964h, 29F4FEE7h
		dd 6B432ED9h, 99BD2019h, 0F876E775h, 7EAFAED3h,	0F481EBB8h
		dd 2B07FE9Dh, 5A0B630Bh, 7D719055h, 0B1D9DBF1h,	2F684141h
		dd 4002394Eh, 0D866345Ah, 187FE2F5h, 266E00B5h,	93142784h
		dd 0FC6FCFBh, 0E1E6275Eh, 0E48AC0E9h, 0A2E9DA34h, 8CBC734Bh
		dd 6C13BAB9h, 84512B7Ah, 30E04AA3h, 0ED7E0610h,	145A17h
		dd 0EA85EFC9h, 65BC2C52h, 0E3514002h, 9B1983F2h, 502F1EC4h
		dd 0A25ADF3Dh, 2E5FCA18h, 0CC6FAF49h, 947765FAh, 0A90AA1B5h
		dd 37398AD1h, 0D7A00BF4h, 0AE5E2782h, 1EA11717h, 6EBF3454h
		dd 5D998EC4h, 862DF108h, 1B20A59Dh, 0DFE5h, 0
_kExampleECKeyDER dd 1027730h, 7200401h, 7A72080Fh, 9C4AA0D4h, 4DC959DDh
					; DATA XREF: _main+103o
		dd 8776889h, 5DC96FB5h,	0E80E7730h, 0ACEC9D1h, 0A06AB48Bh
		dd 2A08060Ah, 3DCE4886h, 0A1070103h, 420344h, 692BE604h
		dd 9F65BFE2h, 1E2FBE97h, 4C8A940Dh, 0B76B97D5h,	460D1EA9h
		dd 0A9A9DDFBh, 0BADC9D1Eh, 0D6E7015Ah, 180AA897h, 0A3C4C3F9h
		dd 7CE2561Eh, 16DB4883h, 1DF51C1Ah, 2D94F17Eh, 2272CF4Bh
		dd 0C1h, 0
_kExampleBadECKeyDER dd	1026630h, 6133000h, 48862A07h, 1023DCEh, 862A0806h
					; DATA XREF: _test_EVP_PKCS82PKEY+13o
		dd 33DCE48h, 4C040701h,	1024A30h, 0FF200401h, 0FFFFFFh
		dd 0FF000000h, 0FFFFFFFFh, 0BCFFFFFFh, 0A7ADFAE6h, 0F3849E17h
		dd 0FCC2CAB9h, 0A1512563h, 210323h, 0FFFFFF00h,	0
		dd 2 dup(0FFFFFFFFh), 0ADFAE6BCh, 849E17A7h, 0C2CAB9F3h
		db 0FCh, 63h, 25h
byte_64F	db 51h			; DATA XREF: _test_EVP_PKCS82PKEY+2Fo
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 650h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public ___local_stdio_printf_options
___local_stdio_printf_options proc near	; CODE XREF: __vfprintf_l+10p
					; _fprintf+Fp ...
		mov	eax, offset ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
		retn
___local_stdio_printf_options endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 658h
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl _vfprintf_l(FILE *File, const char *Format, _locale_t Locale, va_list ArgList)
		public __vfprintf_l
__vfprintf_l	proc near

File		= dword	ptr  4
Format		= dword	ptr  8
Locale		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	[esp+ArgList]
		push	[esp+4+Locale]
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
__vfprintf_l	endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 67Ch
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int fprintf(FILE *File, const	char *Format, ...)
		public _fprintf
_fprintf	proc near		; CODE XREF: _main+58p	_main+80p ...

File		= dword	ptr  4
Format		= dword	ptr  8
arg_8		= byte ptr  0Ch

		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	[esp+8+Format]
		push	[esp+0Ch+File]
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		retn
_fprintf	endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 6A0h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_load_example_rsa_key proc near		; CODE XREF: _test_EVP_DigestSignInit+2Cp
					; _test_EVP_DigestVerifyInit+1Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	eax, 8
		call	__chkstk
		push	edi
		push	260h
		lea	eax, [esp+10h+var_4]
		mov	[esp+10h+var_4], offset	_kExampleRSAKeyDER
		push	eax
		lea	eax, [esp+14h+var_8]
		xor	edi, edi
		push	eax
		mov	[esp+18h+var_8], edi
		call	_d2i_RSAPrivateKey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_6D9
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_6D9:				; CODE XREF: _load_example_rsa_key+32j
		push	esi
		call	_EVP_PKEY_new
		mov	esi, eax
		test	esi, esi
		jz	short loc_703
		push	[esp+10h+var_8]
		push	esi
		call	_EVP_PKEY_set1_RSA
		add	esp, 8
		test	eax, eax
		jz	short $out$9
		mov	edi, esi
		jmp	short loc_703
; ---------------------------------------------------------------------------

$out$9:					; CODE XREF: _load_example_rsa_key+54j
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4

loc_703:				; CODE XREF: _load_example_rsa_key+43j
					; _load_example_rsa_key+58j
		mov	ecx, [esp+10h+var_8]
		pop	esi
		test	ecx, ecx
		jz	short loc_715
		push	ecx
		call	_RSA_free
		add	esp, 4

loc_715:				; CODE XREF: _load_example_rsa_key+6Aj
		mov	eax, edi
		pop	edi
		add	esp, 8
		retn
_load_example_rsa_key endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 71Ch
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl main(int argc, const char	**argv,	const char **envp)
		public _main
_main		proc near
		push	offset _CRYPTO_dbg_get_options
		push	offset _CRYPTO_dbg_set_options
		push	offset _CRYPTO_dbg_free
		push	offset _CRYPTO_dbg_realloc
		push	offset _CRYPTO_dbg_malloc
		call	_CRYPTO_set_mem_debug_functions
		push	3
		call	_CRYPTO_set_mem_debug_options
		push	1
		call	_CRYPTO_mem_ctrl
		add	esp, 1Ch
		call	_ERR_load_crypto_strings
		call	_OpenSSL_add_all_ciphers
		call	_OpenSSL_add_all_digests
		call	_test_EVP_DigestSignInit
		test	eax, eax
		jnz	short loc_782
		push	offset ??_C@_0BL@IBNLHNPN@EVP_DigestSignInit?5failed?6?$AA@ ; "EVP_DigestSignInit failed\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_782:				; CODE XREF: _main+45j
		call	_test_EVP_DigestVerifyInit
		test	eax, eax
		jnz	short loc_7AA
		push	offset ??_C@_0BN@FHDGLKFH@EVP_DigestVerifyInit?5failed?6?$AA@ ;	"EVP_DigestVerifyInit failed\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_7AA:				; CODE XREF: _main+6Dj
		push	6
		push	260h
		push	offset _kExampleRSAKeyDER
		call	_test_d2i_AutoPrivateKey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_7E1
		push	offset ??_C@_0CO@LAKIGHEM@d2i_AutoPrivateKey?$CIkExampleRSAKe@ ; "d2i_AutoPrivateKey(kExampleRSAKeyDER)	f"...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_7E1:				; CODE XREF: _main+A4j
		push	6
		push	27Ah
		push	offset _kExampleRSAKeyPKCS8
		call	_test_d2i_AutoPrivateKey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_818
		push	offset ??_C@_0DA@LGCPAHCO@d2i_AutoPrivateKey?$CIkExampleRSAKe@ ; "d2i_AutoPrivateKey(kExampleRSAKeyPKCS8)"...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_818:				; CODE XREF: _main+DBj
		push	198h
		push	79h ; 'y'
		push	offset _kExampleECKeyDER
		call	_test_d2i_AutoPrivateKey
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_84F
		push	offset ??_C@_0CN@OKNBDKMM@d2i_AutoPrivateKey?$CIkExampleECKey@ ; "d2i_AutoPrivateKey(kExampleECKeyDER) fa"...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_84F:				; CODE XREF: _main+112j
		call	_test_EVP_PKCS82PKEY
		test	eax, eax
		jnz	short loc_877
		push	offset ??_C@_0BM@NGKCLFAG@test_EVP_PKCS82PKEY?5failed?6?$AA@ ; "test_EVP_PKCS82PKEY failed\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_877:				; CODE XREF: _main+13Aj
		call	_EVP_cleanup
		call	_CRYPTO_cleanup_all_ex_data
		push	0
		call	_ERR_remove_thread_state
		call	_ERR_free_strings
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		call	_CRYPTO_mem_leaks_fp
		push	offset ??_C@_05GKINPPHN@PASS?6?$AA@ ; "PASS\n"
		call	_printf
		add	esp, 10h
		xor	eax, eax
		retn
_main		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8ACh
; COMDAT (pick any)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int printf(const char	*Format, ...)
		public _printf
_printf		proc near		; CODE XREF: _main+184p

Format		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+Format]
		push	1
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		lea	ecx, [esp+4+arg_4]
		push	ecx
		push	0
		push	esi
		push	eax
		call	___local_stdio_printf_options
		push	dword ptr [eax+4]
		push	dword ptr [eax]
		call	dword ptr ds:__imp____stdio_common_vfprintf
		add	esp, 18h
		pop	esi
		retn
_printf		endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 8DCh
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_test_EVP_DigestSignInit proc near	; CODE XREF: _main+3Ep

var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_18		= byte ptr -18h

		mov	eax, 34h ; '4'
		call	__chkstk
		push	ebx
		push	esi
		lea	eax, [esp+3Ch+var_30]
		xor	ebx, ebx
		push	edi
		push	eax
		xor	esi, esi
		mov	[esp+44h+var_34], ebx
		call	_EVP_MD_CTX_init
		lea	eax, [esp+44h+var_18]
		push	eax
		call	_EVP_MD_CTX_init
		add	esp, 8
		call	_load_example_rsa_key
		mov	edi, eax
		test	edi, edi
		jz	short loc_986
		push	edi
		push	esi
		call	_EVP_sha256
		push	eax
		lea	eax, [esp+4Ch+var_30]
		push	esi
		push	eax
		call	_EVP_DigestSignInit
		add	esp, 14h
		test	eax, eax
		jz	short loc_986
		push	4
		lea	eax, [esp+44h+var_30]
		push	offset _kMsg
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_986
		lea	eax, [esp+40h+var_34]
		push	eax
		lea	eax, [esp+44h+var_30]
		push	esi
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_986
		push	edi
		call	_EVP_PKEY_size
		mov	ecx, [esp+44h+var_34]
		add	esp, 4
		cmp	ecx, eax
		jz	short loc_9D1
		push	offset ??_C@_0BC@DNOAMPI@sig_len?5mismatch?6?$AA@ ; "sig_len mismatch\n"
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8

loc_986:				; CODE XREF: _test_EVP_DigestSignInit+35j
					; _test_EVP_DigestSignInit+4Fj	...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		call	_ERR_print_errors_fp
		add	esp, 8

loc_997:				; CODE XREF: _test_EVP_DigestSignInit+180j
		lea	eax, [esp+40h+var_30]
		push	eax
		call	_EVP_MD_CTX_cleanup
		lea	eax, [esp+44h+var_18]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 8
		test	edi, edi
		jz	short loc_9BB
		push	edi
		call	_EVP_PKEY_free
		add	esp, 4

loc_9BB:				; CODE XREF: _test_EVP_DigestSignInit+D4j
		test	esi, esi
		jz	short loc_9C8
		push	esi
		call	_CRYPTO_free
		add	esp, 4

loc_9C8:				; CODE XREF: _test_EVP_DigestSignInit+E1j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_9D1:				; CODE XREF: _test_EVP_DigestSignInit+8Fj
		push	131h
		push	offset ??_C@_0BO@FOPGGLHI@?4?2crypto?2evp?2evp_extra_test?4c?$AA@ ; ".\\crypto\\evp\\evp_extra_test.c"
		push	ecx
		call	_CRYPTO_malloc
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_986
		lea	eax, [esp+40h+var_34]
		push	eax
		lea	eax, [esp+44h+var_30]
		push	esi
		push	eax
		call	_EVP_DigestSignFinal
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_986
		push	edi
		push	0
		call	_EVP_sha256
		push	eax
		lea	eax, [esp+4Ch+var_18]
		push	0
		push	eax
		call	_EVP_DigestVerifyInit
		add	esp, 14h
		test	eax, eax
		jz	loc_986
		push	4
		lea	eax, [esp+44h+var_18]
		push	offset _kMsg
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	loc_986
		push	[esp+40h+var_34]
		lea	eax, [esp+44h+var_18]
		push	esi
		push	eax
		call	_EVP_DigestVerifyFinal
		add	esp, 0Ch
		test	eax, eax
		jz	loc_986
		mov	ebx, 1
		jmp	loc_997
_test_EVP_DigestSignInit endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0A64h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_test_EVP_DigestVerifyInit proc	near	; CODE XREF: _main:loc_782p

var_18		= byte ptr -18h

		mov	eax, 18h
		call	__chkstk
		push	esi
		push	edi
		lea	eax, [esp+20h+var_18]
		xor	edi, edi
		push	eax
		call	_EVP_MD_CTX_init
		add	esp, 4
		call	_load_example_rsa_key
		mov	esi, eax
		test	esi, esi
		jz	short loc_ADE
		push	esi
		push	edi
		call	_EVP_sha256
		push	eax
		lea	eax, [esp+2Ch+var_18]
		push	edi
		push	eax
		call	_EVP_DigestVerifyInit
		add	esp, 14h
		test	eax, eax
		jz	short loc_ADE
		push	4
		lea	eax, [esp+24h+var_18]
		push	offset _kMsg
		push	eax
		call	_EVP_DigestUpdate
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_ADE
		push	80h ; '€'
		lea	eax, [esp+24h+var_18]
		push	offset _kSignature
		push	eax
		call	_EVP_DigestVerifyFinal
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_ADE
		mov	edi, 1
		jmp	short loc_AEF
; ---------------------------------------------------------------------------

loc_ADE:				; CODE XREF: _test_EVP_DigestVerifyInit+24j
					; _test_EVP_DigestVerifyInit+3Ej ...
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		push	eax
		call	_ERR_print_errors_fp
		add	esp, 8

loc_AEF:				; CODE XREF: _test_EVP_DigestVerifyInit+78j
		lea	eax, [esp+20h+var_18]
		push	eax
		call	_EVP_MD_CTX_cleanup
		add	esp, 4
		test	esi, esi
		jz	short loc_B09
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4

loc_B09:				; CODE XREF: _test_EVP_DigestVerifyInit+9Aj
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 18h
		retn
_test_EVP_DigestVerifyInit endp

; ---------------------------------------------------------------------------
		align 4
_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0B14h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_test_EVP_PKCS82PKEY proc near		; CODE XREF: _main:loc_84Fp

var_4		= dword	ptr -4

		mov	eax, 4
		call	__chkstk
		push	ebx
		push	esi
		push	edi
		push	68h ; 'h'
		lea	eax, [esp+14h+var_4]
		mov	[esp+14h+var_4], offset	_kExampleBadECKeyDER
		push	eax
		xor	esi, esi
		xor	ebx, ebx
		push	esi
		call	_d2i_PKCS8_PRIV_KEY_INFO
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_B6A
		cmp	[esp+10h+var_4], (offset byte_64F+1)
		jnz	short loc_B6A
		push	edi
		call	_EVP_PKCS82PKEY
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_B63
		push	offset ??_C@_0BJ@CCLLHHD@Imported?5invalid?5EC?5key?6?$AA@ ; "Imported invalid EC key\n"
		jmp	short loc_B6F
; ---------------------------------------------------------------------------

loc_B63:				; CODE XREF: _test_EVP_PKCS82PKEY+46j
		mov	ebx, 1
		jmp	short $done$11
; ---------------------------------------------------------------------------

loc_B6A:				; CODE XREF: _test_EVP_PKCS82PKEY+2Dj
					; _test_EVP_PKCS82PKEY+37j
		push	offset ??_C@_0BF@DJEMHPKD@Failed?5to?5parse?5key?6?$AA@	; "Failed to parse key\n"

loc_B6F:				; CODE XREF: _test_EVP_PKCS82PKEY+4Dj
		push	2
		call	dword ptr ds:__imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8

$done$11:				; CODE XREF: _test_EVP_PKCS82PKEY+54j
		test	edi, edi
		jz	short loc_B90
		push	edi
		call	_PKCS8_PRIV_KEY_INFO_free
		add	esp, 4

loc_B90:				; CODE XREF: _test_EVP_PKCS82PKEY+71j
		test	esi, esi
		jz	short loc_B9D
		push	esi
		call	_EVP_PKEY_free
		add	esp, 4

loc_B9D:				; CODE XREF: _test_EVP_PKCS82PKEY+7Ej
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ecx
		retn
_test_EVP_PKCS82PKEY endp

_text$mn	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text$mn	segment	para public 'CODE' use32
		assume cs:_text$mn
		;org 0BA4h
; COMDAT (pick no duplicate)
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


_test_d2i_AutoPrivateKey proc near	; CODE XREF: _main+9Ap	_main+D1p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		lea	eax, [esp+8+arg_0]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	ebx, ebx
		push	edi
		push	ebp
		push	eax
		push	ebx
		mov	[esp+1Ch+arg_0], esi
		call	_d2i_AutoPrivateKey
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_BF1
		lea	eax, [esi+ebp]
		cmp	[esp+10h+arg_0], eax
		jnz	short loc_BF1
		push	edi
		call	_EVP_PKEY_id
		add	esp, 4
		cmp	eax, [esp+10h+arg_8]
		jz	short loc_BEA
		push	offset ??_C@_0BO@BIHHCPMN@Did?5not?5decode?5expected?5type?6?$AA@ ; "Did not decode expected type\n"
		jmp	short loc_BF6
; ---------------------------------------------------------------------------

loc_BEA:				; CODE XREF: _test_d2i_AutoPrivateKey+3Dj
		mov	ebx, 1
		jmp	short loc_C19
; ---------------------------------------------------------------------------

loc_BF1:				; CODE XREF: _test_d2i_AutoPrivateKey+25j
					; _test_d2i_AutoPrivateKey+2Ej
		push	offset ??_C@_0BL@MLDJILLA@d2i_AutoPrivateKey?5failed?6?$AA@ ; "d2i_AutoPrivateKey failed\n"

loc_BF6:				; CODE XREF: _test_d2i_AutoPrivateKey+44j
		mov	esi, dword ptr ds:__imp____acrt_iob_func
		push	2
		call	esi ; __imp____acrt_iob_func
		add	esp, 4
		push	eax		; File
		call	_fprintf
		add	esp, 8
		push	2
		call	esi ; __imp____acrt_iob_func
		push	eax
		call	_ERR_print_errors_fp
		add	esp, 8

loc_C19:				; CODE XREF: _test_d2i_AutoPrivateKey+4Bj
		test	edi, edi
		jz	short loc_C26
		push	edi
		call	_EVP_PKEY_free
		add	esp, 4

loc_C26:				; CODE XREF: _test_d2i_AutoPrivateKey+77j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
_test_d2i_AutoPrivateKey endp

; ---------------------------------------------------------------------------
		align 10h
_text$mn	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C30h
; COMDAT (pick any)
		public ??_C@_0BC@DNOAMPI@sig_len?5mismatch?6?$AA@
; char `string'[]
??_C@_0BC@DNOAMPI@sig_len?5mismatch?6?$AA@ db 'sig_len mismatch',0Ah,0
					; DATA XREF: _test_EVP_DigestSignInit+91o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C44h
; COMDAT (pick any)
		public ??_C@_0BO@FOPGGLHI@?4?2crypto?2evp?2evp_extra_test?4c?$AA@
; `string'
??_C@_0BO@FOPGGLHI@?4?2crypto?2evp?2evp_extra_test?4c?$AA@ db '.\crypto\evp\evp_extra_test.c',0
					; DATA XREF: _test_EVP_DigestSignInit+FAo
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C64h
; COMDAT (pick any)
		public ??_C@_0BL@MLDJILLA@d2i_AutoPrivateKey?5failed?6?$AA@
; char `string'[]
??_C@_0BL@MLDJILLA@d2i_AutoPrivateKey?5failed?6?$AA@ db	'd2i_AutoPrivateKey failed',0Ah,0
					; DATA XREF: _test_d2i_AutoPrivateKey:loc_BF1o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0C80h
; COMDAT (pick any)
		public ??_C@_0BO@BIHHCPMN@Did?5not?5decode?5expected?5type?6?$AA@
; `string'
??_C@_0BO@BIHHCPMN@Did?5not?5decode?5expected?5type?6?$AA@ db 'Did not decode expected type',0Ah,0
					; DATA XREF: _test_d2i_AutoPrivateKey+3Fo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CA0h
; COMDAT (pick any)
		public ??_C@_0BF@DJEMHPKD@Failed?5to?5parse?5key?6?$AA@
; char `string'[]
??_C@_0BF@DJEMHPKD@Failed?5to?5parse?5key?6?$AA@ db 'Failed to parse key',0Ah,0
					; DATA XREF: _test_EVP_PKCS82PKEY:loc_B6Ao
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CB8h
; COMDAT (pick any)
		public ??_C@_0BJ@CCLLHHD@Imported?5invalid?5EC?5key?6?$AA@
; `string'
??_C@_0BJ@CCLLHHD@Imported?5invalid?5EC?5key?6?$AA@ db 'Imported invalid EC key',0Ah,0
					; DATA XREF: _test_EVP_PKCS82PKEY+48o
		align 4
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CD4h
; COMDAT (pick any)
		public ??_C@_0BL@IBNLHNPN@EVP_DigestSignInit?5failed?6?$AA@
; char `string'[]
??_C@_0BL@IBNLHNPN@EVP_DigestSignInit?5failed?6?$AA@ db	'EVP_DigestSignInit failed',0Ah,0
					; DATA XREF: _main+47o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0CF0h
; COMDAT (pick any)
		public ??_C@_0BN@FHDGLKFH@EVP_DigestVerifyInit?5failed?6?$AA@
; char `string'[]
??_C@_0BN@FHDGLKFH@EVP_DigestVerifyInit?5failed?6?$AA@ db 'EVP_DigestVerifyInit failed',0Ah,0
					; DATA XREF: _main+6Fo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D10h
; COMDAT (pick any)
		public ??_C@_0CO@LAKIGHEM@d2i_AutoPrivateKey?$CIkExampleRSAKe@
; char `string'[]
??_C@_0CO@LAKIGHEM@d2i_AutoPrivateKey?$CIkExampleRSAKe@	db 'd2i_AutoPrivateKey(kExampleRSAKeyDER) failed',0Ah,0
					; DATA XREF: _main+A6o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D40h
; COMDAT (pick any)
		public ??_C@_0DA@LGCPAHCO@d2i_AutoPrivateKey?$CIkExampleRSAKe@
; char `string'[]
??_C@_0DA@LGCPAHCO@d2i_AutoPrivateKey?$CIkExampleRSAKe@	db 'd2i_AutoPrivateKey(kExampleRSAKeyPKCS8) failed',0Ah,0
					; DATA XREF: _main+DDo
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0D70h
; COMDAT (pick any)
		public ??_C@_0CN@OKNBDKMM@d2i_AutoPrivateKey?$CIkExampleECKey@
; char `string'[]
??_C@_0CN@OKNBDKMM@d2i_AutoPrivateKey?$CIkExampleECKey@	db 'd2i_AutoPrivateKey(kExampleECKeyDER) failed',0Ah,0
					; DATA XREF: _main+114o
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DA0h
; COMDAT (pick any)
		public ??_C@_0BM@NGKCLFAG@test_EVP_PKCS82PKEY?5failed?6?$AA@
; char `string'[]
??_C@_0BM@NGKCLFAG@test_EVP_PKCS82PKEY?5failed?6?$AA@ db 'test_EVP_PKCS82PKEY failed',0Ah,0
					; DATA XREF: _main+13Co
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 0DBCh
; COMDAT (pick any)
		public ??_C@_05GKINPPHN@PASS?6?$AA@
; char `string'[]
??_C@_05GKINPPHN@PASS?6?$AA@ db	'PASS',0Ah,0 ; DATA XREF: _main+17Fo
_rdata		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __imp____acrt_iob_func:near ; CODE XREF: _main+4Ep
					; _main+76p ...
		extrn __imp____stdio_common_vfprintf:near ; CODE XREF: __vfprintf_l+1Ap
					; _fprintf+19p	...
		extrn _CRYPTO_mem_ctrl:near ; CODE XREF: _main+27p
		extrn _CRYPTO_cleanup_all_ex_data:near ; CODE XREF: _main+160p
		extrn _CRYPTO_set_mem_debug_functions:near ; CODE XREF:	_main+19p
		extrn _CRYPTO_malloc:near ; CODE XREF: _test_EVP_DigestSignInit+100p
		extrn _CRYPTO_free:near	; CODE XREF: _test_EVP_DigestSignInit+E4p
		extrn _CRYPTO_set_mem_debug_options:near ; CODE	XREF: _main+20p
		extrn _CRYPTO_dbg_malloc:near ;	DATA XREF: _main+14o
		extrn _CRYPTO_dbg_realloc:near ; DATA XREF: _main+Fo
		extrn _CRYPTO_dbg_free:near ; DATA XREF: _main+Ao
		extrn _CRYPTO_dbg_set_options:near ; DATA XREF:	_main+5o
		extrn _CRYPTO_dbg_get_options:near ; DATA XREF:	_maino
		extrn _CRYPTO_mem_leaks_fp:near	; CODE XREF: _main+17Ap
		extrn _ERR_print_errors_fp:near	; CODE XREF: _test_EVP_DigestSignInit+B3p
					; _test_EVP_DigestVerifyInit+83p ...
		extrn _ERR_load_crypto_strings:near ; CODE XREF: _main+2Fp
		extrn _ERR_free_strings:near ; CODE XREF: _main+16Cp
		extrn _ERR_remove_thread_state:near ; CODE XREF: _main+167p
		extrn _EVP_MD_CTX_init:near ; CODE XREF: _test_EVP_DigestSignInit+1Ap
					; _test_EVP_DigestSignInit+24p	...
		extrn _EVP_MD_CTX_cleanup:near ; CODE XREF: _test_EVP_DigestSignInit+C0p
					; _test_EVP_DigestSignInit+CAp	...
		extrn _EVP_DigestUpdate:near ; CODE XREF: _test_EVP_DigestSignInit+5Dp
					; _test_EVP_DigestSignInit+151p ...
		extrn _EVP_DigestSignInit:near ; CODE XREF: _test_EVP_DigestSignInit+45p
		extrn _EVP_DigestSignFinal:near	; CODE XREF: _test_EVP_DigestSignInit+74p
					; _test_EVP_DigestSignInit+119p
		extrn _EVP_DigestVerifyInit:near ; CODE	XREF: _test_EVP_DigestSignInit+135p
					; _test_EVP_DigestVerifyInit+34p
		extrn _EVP_DigestVerifyFinal:near ; CODE XREF: _test_EVP_DigestSignInit+16Bp
					; _test_EVP_DigestVerifyInit+67p
		extrn _EVP_sha256:near	; CODE XREF: _test_EVP_DigestSignInit+39p
					; _test_EVP_DigestSignInit+128p ...
		extrn _OpenSSL_add_all_ciphers:near ; CODE XREF: _main+34p
		extrn _OpenSSL_add_all_digests:near ; CODE XREF: _main+39p
		extrn _EVP_cleanup:near	; CODE XREF: _main:loc_877p
		extrn _EVP_PKEY_id:near	; CODE XREF: _test_d2i_AutoPrivateKey+31p
		extrn _EVP_PKEY_size:near ; CODE XREF: _test_EVP_DigestSignInit+81p
		extrn _EVP_PKEY_set1_RSA:near ;	CODE XREF: _load_example_rsa_key+4Ap
		extrn _EVP_PKEY_new:near ; CODE	XREF: _load_example_rsa_key+3Ap
		extrn _EVP_PKEY_free:near ; CODE XREF: _load_example_rsa_key+5Bp
					; _test_EVP_DigestSignInit+D7p	...
		extrn _d2i_AutoPrivateKey:near ; CODE XREF: _test_d2i_AutoPrivateKey+19p
		extrn _RSA_free:near	; CODE XREF: _load_example_rsa_key+6Dp
		extrn _d2i_RSAPrivateKey:near ;	CODE XREF: _load_example_rsa_key+28p
		extrn _PKCS8_PRIV_KEY_INFO_free:near ; CODE XREF: _test_EVP_PKCS82PKEY+74p
		extrn _d2i_PKCS8_PRIV_KEY_INFO:near ; CODE XREF: _test_EVP_PKCS82PKEY+21p
		extrn _EVP_PKCS82PKEY:near ; CODE XREF:	_test_EVP_PKCS82PKEY+3Ap
		extrn __chkstk:near	; CODE XREF: _load_example_rsa_key+5p
					; _test_EVP_DigestSignInit+5p ...
; `__local_stdio_printf_options'::`2'::_OptionsStorage
		extrn ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:near
					; DATA XREF: ___local_stdio_printf_optionso


		end
