;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	BDAC834E55713C732B5788CFE30DECE9
; Input	CRC32 :	C4492E61

; File Name   :	C:\compspace\compare\pgp\dlls\original\PGPLog.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00005902 (  22786.)
; Section size in file		: 00006000 (  24576.)
; Offset to raw	data for section: 00001000
; Flags	60000020: Text Executable Readable
; Alignment	: default
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401000(HWND hWnd, int, int, int)
sub_401000	proc near		; CODE XREF: sub_4011E0+11p

lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 28h
		mov	eax, [esp+28h+arg_C]
		mov	ecx, [esp+28h+arg_4]
		mov	edx, [esp+28h+arg_8]
		push	esi
		mov	esi, [esp+2Ch+hWnd]
		push	edi
		mov	edi, ds:SendMessageA
		push	0		; lParam
		push	0		; wParam
		push	1004h		; Msg
		push	esi		; hWnd
		mov	[esp+40h+lParam], 7
		mov	[esp+40h+var_8], eax
		mov	[esp+40h+var_C], ecx
		mov	[esp+40h+var_14], edx
		mov	[esp+40h+var_20], 0
		call	edi ; SendMessageA
		mov	[esp+30h+var_24], eax
		lea	eax, [esp+30h+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	1007h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		pop	edi
		pop	esi
		add	esp, 28h
		retn
sub_401000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401060(HWND hWnd, int, int, int)
sub_401060	proc near		; CODE XREF: sub_401110+AEp

Rect		= tagRECT ptr -30h
lParam		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 30h
		push	ebx
		push	esi
		push	edi
		push	2		; nIndex
		call	ds:GetSystemMetrics
		mov	edi, [esp+3Ch+hWnd]
		lea	eax, [esp+3Ch+Rect]
		push	eax		; lpRect
		push	edi		; hWnd
		call	ds:GetClientRect
		mov	ebx, [esp+3Ch+arg_C]
		xor	esi, esi
		test	ebx, ebx
		jle	short loc_4010DD
		push	ebp
		mov	ebp, [esp+40h+arg_8]

loc_40108D:				; CODE XREF: sub_401060+6Ej
		mov	ecx, [esp+40h+arg_4]
		mov	eax, [ebp+esi*4+0]
		mov	[esp+40h+lParam], 0Fh
		mov	[esp+40h+var_18], eax
		mov	edx, [ecx+esi*4]
		mov	ecx, esi
		mov	[esp+40h+var_14], edx
		lea	edx, [esp+40h+lParam]
		neg	ecx
		sbb	ecx, ecx
		push	edx		; lParam
		push	esi		; wParam
		and	ecx, 2
		push	101Bh		; Msg
		push	edi		; hWnd
		mov	[esp+50h+var_C], esi
		mov	[esp+50h+var_1C], ecx
		call	ds:SendMessageA
		inc	esi
		cmp	esi, ebx
		jl	short loc_40108D
		pop	ebp
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_4010DD:				; CODE XREF: sub_401060+26j
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 30h
		retn
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4010F0(int, int nWidth, int nHeight)
sub_4010F0	proc near		; CODE XREF: sub_401A60+A4p
					; sub_401A60+182p

arg_0		= dword	ptr  4
nWidth		= dword	ptr  8
nHeight		= dword	ptr  0Ch

		mov	eax, [esp+nHeight]
		mov	ecx, [esp+nWidth]
		mov	edx, [esp+arg_0]
		push	1		; bRepaint
		push	eax		; nHeight
		push	ecx		; nWidth
		mov	eax, [edx+4]
		push	0		; Y
		push	0		; X
		push	eax		; hWnd
		call	ds:MoveWindow
		retn
sub_4010F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401110(HWND hWnd, int, int, int)
sub_401110	proc near		; CODE XREF: sub_401A60+81p

Rect		= tagRECT ptr -10h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+hWnd]
		push	edi
		mov	edi, [esp+20h+arg_4]
		lea	eax, [esp+20h+Rect]
		push	eax		; lpRect
		push	esi		; hWnd
		mov	[edi], esi
		call	ds:GetClientRect
		mov	edx, hInstance
		mov	ecx, [esp+20h+Rect.right]
		mov	ebx, [esp+20h+Rect.left]
		push	0		; lpParam
		push	edx		; hInstance
		push	65h		; hMenu
		push	esi		; hWndParent
		push	0		; nHeight
		push	0		; nWidth
		push	0		; Y
		push	0		; X
		push	50800401h	; dwStyle
		push	offset WindowName ; lpWindowName
		sub	ecx, ebx
		push	offset ClassName ; "SysListView32"
		push	200h		; dwExStyle
		mov	[esp+50h+hWnd],	ecx
		call	ds:CreateWindowExA
		push	5		; nCmdShow
		push	eax		; hWnd
		mov	[edi+4], eax
		call	ds:ShowWindow
		mov	ebx, [esp+20h+arg_C]
		lea	esi, [edi+18h]
		mov	ebp, 4

loc_401181:				; CODE XREF: sub_401110+9Dj
		fld	dword ptr [ebx]
		fcom	ds:dbl_4071C8
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_401197
		call	__ftol
		jmp	short loc_4011A4
; ---------------------------------------------------------------------------

loc_401197:				; CODE XREF: sub_401110+7Ej
		fild	[esp+20h+hWnd]
		fmul	st, st(1)
		call	__ftol
		fstp	st

loc_4011A4:				; CODE XREF: sub_401110+85j
		mov	[esi], eax
		add	ebx, 4
		add	esi, 4
		dec	ebp
		jnz	short loc_401181
		mov	ecx, [edi+4]
		lea	eax, [edi+18h]
		push	4		; int
		push	eax		; int
		mov	eax, [esp+28h+arg_8]
		push	eax		; int
		push	ecx		; hWnd
		call	sub_401060
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_401110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4011E0(HWND hWnd, int)
sub_4011E0	proc near		; CODE XREF: pfnCallback+25Ap

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+hWnd]
		push	eax		; int
		push	offset WindowName ; int
		push	0		; int
		push	ecx		; hWnd
		call	sub_401000
		add	esp, 10h
		retn
sub_4011E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401200(HWND hWnd, WPARAM wParam)
sub_401200	proc near		; CODE XREF: pfnCallback+267p

hWnd		= dword	ptr  4
wParam		= dword	ptr  8

		mov	eax, [esp+wParam]
		mov	ecx, [esp+hWnd]
		push	0		; lParam
		push	eax		; wParam
		push	1013h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		mov	eax, 1
		retn
sub_401200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: start+C9p

Msg		= tagMSG ptr -44h
WndClass	= WNDCLASSA ptr	-28h
hInstance	= dword	ptr  4
hPrevInstance	= dword	ptr  8
lpCmdLine	= dword	ptr  0Ch
nShowCmd	= dword	ptr  10h

		sub	esp, 44h
		push	ebx
		push	esi
		push	offset psz	; "PGPlog"
		push	offset psz	; "PGPlog"
		call	WindowExists
		add	esp, 8
		test	eax, eax
		jz	short loc_401248
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_401248:				; CODE XREF: WinMain(x,x,x,x)+19j
		push	offset dword_408B90
		xor	ebx, ebx
		push	offset dword_408B8C
		push	ebx
		call	InitPGPsc
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40126E
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40126E:				; CODE XREF: WinMain(x,x,x,x)+3Fj
		mov	esi, [esp+4Ch+hInstance]
		push	65h		; lpIconName
		push	esi		; hInstance
		mov	dword_408AF0, ebx
		mov	hInstance, esi
		mov	[esp+54h+WndClass.style], 3
		mov	[esp+54h+WndClass.lpfnWndProc],	offset sub_401A60
		mov	[esp+54h+WndClass.cbClsExtra], ebx
		mov	[esp+54h+WndClass.cbWndExtra], ebx
		mov	[esp+54h+WndClass.hInstance], esi
		call	ds:LoadIconA
		push	7F00h		; lpCursorName
		push	ebx		; hInstance
		mov	[esp+54h+WndClass.hIcon], eax
		call	ds:LoadCursorA
		mov	[esp+4Ch+WndClass.hbrBackground], 6
		mov	[esp+4Ch+WndClass.lpszMenuName], ebx
		mov	[esp+4Ch+WndClass.hCursor], eax
		lea	eax, [esp+4Ch+WndClass]
		push	eax		; lpWndClass
		mov	[esp+50h+WndClass.lpszClassName], offset psz ; "PGPlog"
		call	ds:RegisterClassA
		push	ebx		; lpParam
		push	esi		; hInstance
		push	ebx		; hMenu
		push	ebx		; hWndParent
		push	78h		; nHeight
		push	24Eh		; nWidth
		push	80000000h	; Y
		push	80000000h	; X
		push	0CF0000h	; dwStyle
		push	offset psz	; "PGPlog"
		push	offset psz	; "PGPlog"
		push	ebx		; dwExStyle
		call	ds:CreateWindowExA
		mov	esi, eax
		push	5		; nCmdShow
		push	esi		; hWnd
		call	ds:ShowWindow
		push	esi		; hWnd
		call	ds:UpdateWindow
		push	ebx		; ulRes
		push	1D0000h		; afCmd
		push	offset pfnCallback ; pfnCallback
		push	offset idInst	; pidInst
		call	DdeInitializeA
		test	eax, eax
		jz	short loc_401350
		push	30h		; uType
		push	offset psz	; "PGPlog"
		push	offset Text	; "Could not initialize	PGPlog's DDEML ser"...
		push	esi		; hWnd
		call	ds:MessageBoxA
		push	esi		; hWnd
		call	ds:DestroyWindow
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_401350:				; CODE XREF: WinMain(x,x,x,x)+10Aj
		mov	ecx, idInst
		push	edi
		push	ebx		; iCodePage
		push	offset psz	; "PGPlog"
		push	ecx		; idInst
		call	DdeCreateStringHandleA
		mov	edx, idInst
		push	ebx		; iCodePage
		push	offset aOperation_resu ; "Operation_Results"
		push	edx		; idInst
		mov	hsz, eax
		call	DdeCreateStringHandleA
		mov	ecx, idInst
		mov	dword_408AE8, eax
		mov	eax, hsz
		push	1		; afCmd
		push	ebx		; hsz2
		push	eax		; hsz1
		push	ecx		; idInst
		call	DdeNameService
		mov	edi, ds:GetMessageA
		push	ebx		; wMsgFilterMax
		push	ebx		; wMsgFilterMin
		lea	edx, [esp+58h+Msg]
		push	ebx		; hWnd
		push	edx		; lpMsg
		call	edi ; GetMessageA
		test	eax, eax
		jz	short loc_4013E0
		push	ebp
		mov	ebp, ds:IsDialogMessageA

loc_4013AF:				; CODE XREF: WinMain(x,x,x,x)+1BDj
		lea	eax, [esp+54h+Msg]
		push	eax		; lpMsg
		push	esi		; hDlg
		call	ebp ; IsDialogMessageA
		test	eax, eax
		jnz	short loc_4013D1
		lea	ecx, [esp+54h+Msg]
		push	ecx		; lpMsg
		call	ds:TranslateMessage
		lea	edx, [esp+54h+Msg]
		push	edx		; lpMsg
		call	ds:DispatchMessageA

loc_4013D1:				; CODE XREF: WinMain(x,x,x,x)+199j
		push	ebx		; wMsgFilterMax
		push	ebx		; wMsgFilterMin
		lea	eax, [esp+5Ch+Msg]
		push	ebx		; hWnd
		push	eax		; lpMsg
		call	edi ; GetMessageA
		test	eax, eax
		jnz	short loc_4013AF
		pop	ebp

loc_4013E0:				; CODE XREF: WinMain(x,x,x,x)+186j
		mov	ecx, idInst
		push	ecx		; idInst
		call	DdeUninitialize
		mov	esi, dword_408AF0
		cmp	esi, ebx
		jz	short loc_401448

loc_4013F6:				; CODE XREF: WinMain(x,x,x,x)+226j
		mov	edx, [esi+88h]
		xor	eax, eax
		mov	dword_408AF0, edx
		mov	ecx, [esi+80h]
		mov	edi, [esi+84h]
		mov	edx, ecx
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		mov	eax, [esi+84h]
		push	eax		; void *
		call	_free
		mov	ecx, 23h
		xor	eax, eax
		mov	edi, esi
		push	esi		; void *
		rep stosd
		call	_free
		mov	esi, dword_408AF0
		add	esp, 8
		cmp	esi, ebx
		jnz	short loc_4013F6

loc_401448:				; CODE XREF: WinMain(x,x,x,x)+1D4j
		mov	ecx, dword_408B90
		mov	edx, dword_408B8C
		push	ecx
		push	edx
		push	ebx
		call	UninitPGPsc
		mov	eax, [esp+5Ch+Msg.wParam]
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 44h
		retn	10h
_WinMain@16	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; HDDEDATA __stdcall pfnCallback(UINT wType, UINT wFmt,	HCONV hConv, HSZ hsz1, HSZ hsz2, HDDEDATA hData, DWORD dwData1,	DWORD dwData2)
pfnCallback	proc near		; DATA XREF: WinMain(x,x,x,x)+F9o

var_4EC		= dword	ptr -4ECh
psz		= byte ptr -4E8h
pDst		= byte ptr -3E8h
wType		= dword	ptr  4
wFmt		= dword	ptr  8
hConv		= dword	ptr  0Ch
hsz1		= dword	ptr  10h
hsz2		= dword	ptr  14h
hData		= dword	ptr  18h
dwData1		= dword	ptr  1Ch
dwData2		= dword	ptr  20h

		mov	eax, [esp+wType]
		sub	esp, 4ECh
		cmp	eax, 1062h
		push	ebx
		push	esi
		jz	loc_4016F1
		cmp	eax, 4050h
		jz	short loc_40149B
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 4ECh
		retn	20h
; ---------------------------------------------------------------------------

loc_40149B:				; CODE XREF: pfnCallback+1Cj
		mov	ecx, [esp+4F4h+hData]
		push	ebp
		push	edi
		push	0		; cbOff
		lea	eax, [esp+500h+pDst]
		push	1F4h		; cbMax
		push	eax		; pDst
		push	ecx		; hData
		call	DdeGetData
		push	8Ch		; size_t
		call	_malloc
		mov	ebp, eax
		mov	ecx, 23h
		xor	eax, eax
		mov	edi, ebp
		rep stosd
		mov	edx, dword_408AF0
		lea	edi, [esp+500h+pDst]
		or	ecx, 0FFFFFFFFh
		mov	[ebp+88h], edx
		repne scasb
		not	ecx
		mov	dword_408AF0, ebp
		lea	eax, [ecx]
		push	eax		; size_t
		mov	[ebp+80h], eax
		call	_malloc
		mov	ebx, eax
		lea	edi, [esp+504h+pDst]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		push	offset asc_408110 ; "\n"
		mov	eax, ecx
		mov	esi, edi
		mov	edi, ebx
		push	ebx		; char *
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	[ebp+84h], ebx
		mov	dword ptr [ebp+0], 0
		call	_strstr
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jz	short loc_401548
		mov	byte ptr [edi],	0

loc_401548:				; CODE XREF: pfnCallback+D3j
		push	offset aSignature ; "Signature"
		push	ebx		; char *
		call	_strstr
		add	esp, 8
		test	eax, eax
		jz	loc_4016DF
		mov	esi, offset aGoodSignature ; "Good Signature"

loc_401563:				; CODE XREF: pfnCallback+115j
		mov	cl, [ebx]
		mov	dl, [esi]
		mov	al, cl
		cmp	cl, dl
		jnz	short loc_40158B
		test	al, al
		jz	short loc_401587
		mov	dl, [ebx+1]
		mov	cl, [esi+1]
		mov	al, dl
		cmp	dl, cl
		jnz	short loc_40158B
		add	ebx, 2
		add	esi, 2
		test	al, al
		jnz	short loc_401563

loc_401587:				; CODE XREF: pfnCallback+FFj
		xor	eax, eax
		jmp	short loc_401590
; ---------------------------------------------------------------------------

loc_40158B:				; CODE XREF: pfnCallback+FBj
					; pfnCallback+10Bj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_401590:				; CODE XREF: pfnCallback+119j
		test	eax, eax
		jnz	short loc_40159D
		mov	dword ptr [ebp+4], 1Ch
		jmp	short loc_4015A4
; ---------------------------------------------------------------------------

loc_40159D:				; CODE XREF: pfnCallback+122j
		mov	dword ptr [ebp+4], 1Dh

loc_4015A4:				; CODE XREF: pfnCallback+12Bj
		inc	edi

loc_4015A5:				; CODE XREF: pfnCallback+24Dj
		push	offset asc_408110 ; "\n"
		push	edi		; char *
		call	_strstr
		add	esp, 8
		mov	[esp+4FCh+var_4EC], eax
		test	eax, eax
		jz	short loc_4015BE
		mov	byte ptr [eax],	0

loc_4015BE:				; CODE XREF: pfnCallback+149j
		mov	ecx, [ebp+0]
		mov	eax, 2
		mov	[ebp+ecx*4+8], eax
		mov	edx, [ebp+0]
		mov	[ebp+edx*4+30h], edi
		mov	ecx, [ebp+0]
		cmp	ecx, eax
		jnz	loc_4016AD
		mov	dword ptr [ebp+10h], 3
		mov	ecx, [ebp+0]
		mov	esi, offset aInvalidKey	; "Invalid Key"
		mov	[ebp+ecx*4+58h], eax
		mov	ecx, edi

loc_4015F1:				; CODE XREF: pfnCallback+19Dj
		mov	bl, [ecx]
		mov	dl, bl
		cmp	bl, [esi]
		jnz	short loc_401613
		test	dl, dl
		jz	short loc_40160F
		mov	bl, [ecx+1]
		mov	dl, bl
		cmp	bl, [esi+1]
		jnz	short loc_401613
		add	ecx, eax
		add	esi, eax
		test	dl, dl
		jnz	short loc_4015F1

loc_40160F:				; CODE XREF: pfnCallback+18Bj
		xor	ecx, ecx
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_401613:				; CODE XREF: pfnCallback+187j
					; pfnCallback+195j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_401618:				; CODE XREF: pfnCallback+1A1j
		test	ecx, ecx
		jnz	short loc_401628
		mov	edx, [ebp+0]
		mov	[ebp+edx*4+30h], ecx
		jmp	loc_4016AD
; ---------------------------------------------------------------------------

loc_401628:				; CODE XREF: pfnCallback+1AAj
		mov	esi, offset aMarginalKey ; "Marginal Key"
		mov	ecx, edi

loc_40162F:				; CODE XREF: pfnCallback+1DBj
		mov	bl, [ecx]
		mov	dl, bl
		cmp	bl, [esi]
		jnz	short loc_401651
		test	dl, dl
		jz	short loc_40164D
		mov	bl, [ecx+1]
		mov	dl, bl
		cmp	bl, [esi+1]
		jnz	short loc_401651
		add	ecx, eax
		add	esi, eax
		test	dl, dl
		jnz	short loc_40162F

loc_40164D:				; CODE XREF: pfnCallback+1C9j
		xor	ecx, ecx
		jmp	short loc_401656
; ---------------------------------------------------------------------------

loc_401651:				; CODE XREF: pfnCallback+1C5j
					; pfnCallback+1D3j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_401656:				; CODE XREF: pfnCallback+1DFj
		test	ecx, ecx
		jnz	short loc_401667
		mov	eax, [ebp+0]
		mov	dword ptr [ebp+eax*4+30h], 1
		jmp	short loc_4016AD
; ---------------------------------------------------------------------------

loc_401667:				; CODE XREF: pfnCallback+1E8j
		mov	esi, offset aValidKey ;	"Valid Key"
		mov	ecx, edi

loc_40166E:				; CODE XREF: pfnCallback+21Aj
		mov	bl, [ecx]
		mov	dl, bl
		cmp	bl, [esi]
		jnz	short loc_401690
		test	dl, dl
		jz	short loc_40168C
		mov	bl, [ecx+1]
		mov	dl, bl
		cmp	bl, [esi+1]
		jnz	short loc_401690
		add	ecx, eax
		add	esi, eax
		test	dl, dl
		jnz	short loc_40166E

loc_40168C:				; CODE XREF: pfnCallback+208j
		xor	ecx, ecx
		jmp	short loc_401695
; ---------------------------------------------------------------------------

loc_401690:				; CODE XREF: pfnCallback+204j
					; pfnCallback+212j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_401695:				; CODE XREF: pfnCallback+21Ej
		test	ecx, ecx
		jnz	short loc_4016A2
		mov	ecx, [ebp+0]
		mov	[ebp+ecx*4+30h], eax
		jmp	short loc_4016AD
; ---------------------------------------------------------------------------

loc_4016A2:				; CODE XREF: pfnCallback+227j
		mov	edx, [ebp+0]
		mov	dword ptr [ebp+edx*4+30h], 3

loc_4016AD:				; CODE XREF: pfnCallback+166j
					; pfnCallback+1B3j ...
		mov	edx, [ebp+0]
		mov	eax, [esp+4FCh+var_4EC]
		inc	edx
		test	eax, eax
		mov	[ebp+0], edx
		lea	edi, [eax+1]
		jnz	loc_4015A5
		mov	eax, hWnd
		push	ebp		; int
		push	eax		; hWnd
		call	sub_4011E0
		mov	ecx, hWnd
		push	eax		; wParam
		push	ecx		; hWnd
		call	sub_401200
		add	esp, 10h

loc_4016DF:				; CODE XREF: pfnCallback+E8j
		pop	edi
		pop	ebp
		pop	esi
		mov	eax, 8000h
		pop	ebx
		add	esp, 4ECh
		retn	20h
; ---------------------------------------------------------------------------

loc_4016F1:				; CODE XREF: pfnCallback+11j
		mov	eax, [esp+4F4h+hsz2]
		mov	ecx, idInst
		push	0		; iCodePage
		lea	edx, [esp+4F8h+psz]
		push	100h		; cchMax
		push	edx		; psz
		push	eax		; hsz
		push	ecx		; idInst
		call	DdeQueryStringA
		mov	esi, offset psz	; "PGPlog"
		lea	eax, [esp+4F4h+psz]

loc_40171A:				; CODE XREF: pfnCallback+2CCj
		mov	dl, [eax]
		mov	bl, [esi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_401742
		test	cl, cl
		jz	short loc_40173E
		mov	dl, [eax+1]
		mov	bl, [esi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_401742
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_40171A

loc_40173E:				; CODE XREF: pfnCallback+2B6j
		xor	eax, eax
		jmp	short loc_401747
; ---------------------------------------------------------------------------

loc_401742:				; CODE XREF: pfnCallback+2B2j
					; pfnCallback+2C2j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_401747:				; CODE XREF: pfnCallback+2D0j
		test	eax, eax
		jz	short loc_401758
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 4ECh
		retn	20h
; ---------------------------------------------------------------------------

loc_401758:				; CODE XREF: pfnCallback+2D9j
		mov	ecx, [esp+4F4h+hsz1]
		mov	edx, idInst
		push	0		; iCodePage
		lea	eax, [esp+4F8h+psz]
		push	100h		; cchMax
		push	eax		; psz
		push	ecx		; hsz
		push	edx		; idInst
		call	DdeQueryStringA
		mov	esi, offset aOperation_resu ; "Operation_Results"
		lea	eax, [esp+4F4h+psz]

loc_401781:				; CODE XREF: pfnCallback+333j
		mov	dl, [eax]
		mov	bl, [esi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_4017BB
		test	cl, cl
		jz	short loc_4017A5
		mov	dl, [eax+1]
		mov	bl, [esi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_4017BB
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_401781

loc_4017A5:				; CODE XREF: pfnCallback+31Dj
		xor	eax, eax
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		pop	esi
		mov	eax, ecx
		pop	ebx
		add	esp, 4ECh
		retn	20h
; ---------------------------------------------------------------------------

loc_4017BB:				; CODE XREF: pfnCallback+319j
					; pfnCallback+329j
		sbb	eax, eax
		pop	esi
		sbb	eax, 0FFFFFFFFh
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		mov	eax, ecx
		pop	ebx
		add	esp, 4ECh
		retn	20h
pfnCallback	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4017E0(HKEY hKey, LPCSTR lpValueName,	BYTE Data)
sub_4017E0	proc near		; CODE XREF: sub_401800+42p
					; sub_401800+56p ...

hKey		= dword	ptr  4
lpValueName	= dword	ptr  8
Data		= byte ptr  0Ch

		mov	ecx, [esp+lpValueName]
		mov	edx, [esp+hKey]
		lea	eax, [esp+Data]
		push	4		; cbData
		push	eax		; lpData
		push	4		; dwType
		push	0		; Reserved
		push	ecx		; lpValueName
		push	edx		; hKey
		call	ds:RegSetValueExA
		retn
sub_4017E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401800(HWND hWnd)
sub_401800	proc near		; CODE XREF: sub_401A60+191p

Rect		= tagRECT ptr -10h
hWnd		= dword	ptr  4

		mov	ecx, [esp+hWnd]
		sub	esp, 10h
		lea	eax, [esp+10h+Rect]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:GetWindowRect
		lea	edx, [esp+10h+hWnd]
		push	edx		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "Software\\Network Associates\\PGP\\PGPl"...
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_40189D
		mov	eax, [esp+10h+Rect.left]
		mov	ecx, [esp+10h+hWnd]
		push	eax		; Data
		push	offset ValueName ; "xPos"
		push	ecx		; hKey
		call	sub_4017E0
		mov	edx, [esp+1Ch+Rect.top]
		mov	eax, [esp+1Ch+hWnd]
		push	edx		; Data
		push	offset aYpos	; "yPos"
		push	eax		; hKey
		call	sub_4017E0
		mov	ecx, [esp+28h+Rect.right]
		mov	edx, [esp+28h+Rect.left]
		sub	ecx, edx
		mov	edx, [esp+28h+hWnd]
		push	ecx		; Data
		push	offset aXsize	; "xSize"
		push	edx		; hKey
		call	sub_4017E0
		mov	eax, [esp+34h+Rect.bottom]
		mov	edx, [esp+34h+Rect.top]
		mov	ecx, [esp+34h+hWnd]
		sub	eax, edx
		push	eax		; Data
		push	offset aYsize	; "ySize"
		push	ecx		; hKey
		call	sub_4017E0
		mov	edx, [esp+40h+hWnd]
		add	esp, 30h
		push	edx		; hKey
		call	ds:RegCloseKey

loc_40189D:				; CODE XREF: sub_401800+31j
		add	esp, 10h
		retn
sub_401800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4018B0(HKEY hKey, LPCSTR lpValueName)
sub_4018B0	proc near		; CODE XREF: sub_4018F0+35p
					; sub_4018F0+46p ...

Data		= byte ptr -0Ch
cbData		= dword	ptr -8
Type		= dword	ptr -4
hKey		= dword	ptr  4
lpValueName	= dword	ptr  8

		sub	esp, 0Ch
		lea	ecx, [esp+0Ch+cbData]
		lea	edx, [esp+0Ch+Data]
		push	ecx		; lpcbData
		lea	ecx, [esp+10h+Type]
		xor	eax, eax
		push	edx		; lpData
		mov	edx, [esp+14h+lpValueName]
		push	ecx		; lpType
		mov	dword ptr [esp+18h+Data], eax
		mov	[esp+18h+Type],	eax
		push	eax		; lpReserved
		mov	eax, [esp+1Ch+hKey]
		push	edx		; lpValueName
		push	eax		; hKey
		mov	[esp+24h+cbData], 4
		call	ds:RegQueryValueExA
		mov	eax, dword ptr [esp+0Ch+Data]
		add	esp, 0Ch
		retn
sub_4018B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4018F0(HWND hWnd, int)
sub_4018F0	proc near		; CODE XREF: sub_401A60+AFp

phkResult	= dword	ptr -8
dwDisposition	= dword	ptr -4
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		lea	eax, [esp+8+phkResult]
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "Software\\Network Associates\\PGP\\PGPl"...
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	loc_4019D5
		mov	ecx, [esp+18h+phkResult]
		push	offset ValueName ; "xPos"
		push	ecx		; hKey
		call	sub_4018B0
		mov	edx, [esp+20h+phkResult]
		push	offset aYpos	; "yPos"
		push	edx		; hKey
		mov	esi, eax
		call	sub_4018B0
		mov	ebp, eax
		mov	eax, [esp+28h+phkResult]
		push	offset aXsize	; "xSize"
		push	eax		; hKey
		call	sub_4018B0
		mov	ecx, [esp+30h+phkResult]
		push	offset aYsize	; "ySize"
		push	ecx		; hKey
		mov	edi, eax
		call	sub_4018B0
		mov	edx, [esp+38h+phkResult]
		add	esp, 20h
		mov	ebx, eax
		push	edx		; hKey
		call	ds:RegCloseKey
		test	edi, edi
		jz	short loc_40198D
		test	ebx, ebx
		jz	short loc_40198D
		push	0		; nIndex
		call	ds:GetSystemMetrics
		cmp	esi, eax
		ja	short loc_40198D
		push	1		; nIndex
		call	ds:GetSystemMetrics
		cmp	ebp, eax
		jbe	short loc_4019BA

loc_40198D:				; CODE XREF: sub_4018F0+7Fj
					; sub_4018F0+83j ...
		mov	esi, [esp+18h+arg_4]
		push	0		; nIndex
		mov	edi, [esi+8]
		mov	edx, [esi]
		mov	ebx, [esi+0Ch]
		mov	ecx, [esi+4]
		sub	edi, edx
		sub	ebx, ecx
		call	ds:GetSystemMetrics
		mov	edx, [esi]
		mov	ebp, [esi+8]
		sub	edx, ebp
		add	eax, edx
		cdq
		sub	eax, edx
		mov	esi, eax
		sar	esi, 1
		xor	ebp, ebp

loc_4019BA:				; CODE XREF: sub_4018F0+9Bj
		mov	eax, [esp+18h+hWnd]
		push	4		; uFlags
		push	ebx		; cy
		push	edi		; cx
		push	ebp		; Y
		push	esi		; X
		push	0		; hWndInsertAfter
		push	eax		; hWnd
		call	ds:SetWindowPos
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4019D5:				; CODE XREF: sub_4018F0+25j
		lea	eax, [esp+18h+dwDisposition]
		lea	ecx, [esp+18h+phkResult]
		push	eax		; lpdwDisposition
		push	ecx		; phkResult
		push	0		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	0		; dwOptions
		push	0		; lpClass
		push	0		; Reserved
		push	offset SubKey	; "Software\\Network Associates\\PGP\\PGPl"...
		push	80000002h	; hKey
		call	ds:RegCreateKeyExA
		jmp	short loc_40198D
sub_4018F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401A00	proc near		; CODE XREF: sub_401A60+199p
		mov	eax, hsz
		mov	ecx, idInst
		push	2		; afCmd
		push	0		; hsz2
		push	eax		; hsz1
		push	ecx		; idInst
		call	DdeNameService
		mov	edx, hsz
		mov	eax, idInst
		push	edx		; hsz
		push	eax		; idInst
		call	DdeFreeStringHandle
		mov	ecx, dword_408AE8
		mov	edx, idInst
		push	ecx		; hsz
		push	edx		; idInst
		call	DdeFreeStringHandle
		push	offset dword_408B00
		call	sub_401E20
		add	esp, 4
		push	0		; nExitCode
		call	ds:PostQuitMessage
		retn
sub_401A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_401A60(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_401A60	proc near		; DATA XREF: WinMain(x,x,x,x)+69o

Rect		= tagRECT ptr -4Ch
pvParam		= byte ptr -3Ch
hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		sub	esp, 4Ch
		push	ebx
		mov	ebx, [esp+50h+Msg]
		push	esi
		mov	esi, [esp+54h+lParam]
		lea	eax, [ebx-1]	; switch 44 cases
		push	edi
		mov	edi, [esp+58h+wParam]
		cmp	eax, 2Bh
		ja	loc_401B7A	; jumptable 00401A86 default case
		xor	ecx, ecx
		mov	cl, ds:byte_401C2C[eax]
		jmp	ds:off_401C0C[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_401A8D:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		call	ds:InitCommonControls ;	jumptable 00401A86 case	1
		lea	edx, [esp+58h+pvParam]
		push	0		; fWinIni
		push	edx		; pvParam
		push	3Ch		; uiParam
		push	1Fh		; uiAction
		call	ds:SystemParametersInfoA
		lea	eax, [esp+58h+pvParam]
		push	eax		; lplf
		call	ds:CreateFontIndirectA
		push	offset dword_408B00
		mov	dword_408B44, eax
		call	sub_401C60
		mov	esi, [esp+5Ch+hWnd]
		add	esp, 4
		lea	ecx, [esp+58h+Rect]
		push	ecx		; lpRect
		push	esi		; hWnd
		call	ds:GetClientRect
		push	offset dword_408040 ; int
		push	offset off_408050 ; int
		push	offset dword_408B60 ; int
		push	esi		; hWnd
		call	sub_401110
		add	esp, 10h
		lea	edx, [esp+58h+Rect]
		push	edx		; lpRect
		push	esi		; hWnd
		call	ds:GetWindowRect
		mov	eax, [esp+58h+Rect.bottom]
		mov	ecx, [esp+58h+Rect.right]
		push	eax		; nHeight
		push	ecx		; nWidth
		push	offset dword_408B60 ; int
		call	sub_4010F0
		lea	edx, [esp+64h+Rect]
		push	edx		; int
		push	esi		; hWnd
		call	sub_4018F0
		add	esp, 14h
		push	esi		; hWnd
		call	ds:SetForegroundWindow
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_401B2C:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		mov	eax, [esp+58h+lParam] ;	jumptable 00401A86 case	43
		mov	ecx, [esp+58h+hWnd]
		push	eax
		push	ecx
		call	sub_402530
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_401B4C:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		mov	edx, [esp+58h+lParam] ;	jumptable 00401A86 case	44
		mov	eax, [esp+58h+hWnd]
		push	edx		; int
		push	eax		; hDlg
		call	sub_402570
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_401B6C:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		mov	dword ptr [esi+18h], 15Eh ; jumptable 00401A86 case 36
		mov	dword ptr [esi+1Ch], 78h

loc_401B7A:				; CODE XREF: sub_401A60+18j
					; sub_401A60+26j ...
		mov	edx, [esp+58h+hWnd] ; jumptable	00401A86 default case
		push	esi		; lParam
		push	edi		; wParam
		push	ebx		; Msg
		push	edx		; hWnd
		call	ds:DefWindowProcA
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_401B91:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		test	edi, edi	; jumptable 00401A86 case 25
		jz	short loc_401B7A ; jumptable 00401A86 default case
		mov	ecx, esi
		shr	ecx, 10h
		cmp	ecx, 1
		jz	short loc_401B7A ; jumptable 00401A86 default case
		mov	ebx, ds:GetSysColor
		push	0Fh		; nIndex
		call	ebx ; GetSysColor
		mov	esi, eax
		push	esi		; color
		push	edi		; hdc
		call	ds:SetBkColor
		push	8		; nIndex
		call	ebx ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		push	esi		; color
		call	ds:CreateSolidBrush
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_401BCF:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		mov	edx, esi	; jumptable 00401A86 case 5
		mov	eax, esi
		shr	edx, 10h
		and	eax, 0FFFFh
		push	edx		; nHeight
		push	eax		; nWidth
		push	offset dword_408B60 ; int
		call	sub_4010F0
		add	esp, 0Ch
		jmp	short loc_401B7A ; jumptable 00401A86 default case
; ---------------------------------------------------------------------------

loc_401BEC:				; CODE XREF: sub_401A60+26j
					; DATA XREF: .text:off_401C0Co
		mov	ecx, [esp+58h+hWnd] ; jumptable	00401A86 cases 2,16
		push	ecx		; hWnd
		call	sub_401800
		add	esp, 4
		call	sub_401A00
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 4Ch
		retn	10h
sub_401A60	endp

; ---------------------------------------------------------------------------
		align 4
off_401C0C	dd offset loc_401A8D	; DATA XREF: sub_401A60+26r
		dd offset loc_401BEC	; jump table for switch	statement
		dd offset loc_401BCF
		dd offset loc_401B91
		dd offset loc_401B6C
		dd offset loc_401B2C
		dd offset loc_401B4C
		dd offset loc_401B7A
byte_401C2C	db	0,     1,     7,     7 ; DATA XREF: sub_401A60+20r
		db	2,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     1
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	3,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     4
		db	7,     7,     7,     7
		db	7,     7,     5,     6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401C60	proc near		; CODE XREF: sub_401A60+59p

pvParam		= byte ptr -3Ch
var_28		= byte ptr -28h
var_26		= byte ptr -26h
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+48h+arg_0]
		push	edi
		push	esi
		mov	dword ptr [esi], 0
		mov	eax, dword_408B8C
		push	eax
		call	GetValidityDrawPrefs
		mov	edx, dword_408B8C
		lea	ecx, [esi+4]
		push	ecx
		push	edx
		call	GetMarginalInvalidPref
		mov	edi, ds:GetSysColor
		add	esp, 10h
		push	10h		; nIndex
		call	edi ; GetSysColor
		mov	ebp, ds:CreateSolidBrush
		push	eax		; color
		call	ebp ; CreateSolidBrush
		push	5		; nIndex
		mov	[esi+0Ch], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	3		; iHatch
		call	ds:CreateHatchBrush
		push	8		; nIndex
		mov	[esi+10h], eax
		call	edi ; GetSysColor
		mov	ebx, ds:CreatePen
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ebx ; CreatePen
		push	5		; nIndex
		mov	[esi+14h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ebx ; CreatePen
		push	10h		; nIndex
		mov	[esi+18h], eax
		call	edi ; GetSysColor
		push	10h		; nIndex
		mov	[esi+8], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ebx ; CreatePen
		push	14h		; nIndex
		mov	[esi+24h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ebx ; CreatePen
		push	15h		; nIndex
		mov	[esi+1Ch], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ebx ; CreatePen
		push	0Fh		; nIndex
		mov	[esi+20h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebp ; CreateSolidBrush
		push	0Dh		; nIndex
		mov	[esi+28h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebp ; CreateSolidBrush
		push	5		; nIndex
		mov	[esi+2Ch], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebp ; CreateSolidBrush
		mov	[esi+30h], eax
		lea	eax, [esp+4Ch+pvParam]
		push	0		; fWinIni
		push	eax		; pvParam
		push	3Ch		; uiParam
		push	1Fh		; uiAction
		call	ds:SystemParametersInfoA
		mov	edi, ds:CreateFontIndirectA
		lea	ecx, [esp+4Ch+pvParam]
		push	ecx		; lplf
		call	edi ; CreateFontIndirectA
		mov	bl, [esp+4Ch+var_28]
		mov	[esi+34h], eax
		test	bl, bl
		lea	eax, [esp+4Ch+pvParam]
		setz	dl
		push	eax		; lplf
		mov	[esp+50h+var_28], dl
		call	edi ; CreateFontIndirectA
		mov	cl, [esp+4Ch+var_28]
		lea	edx, [esp+4Ch+pvParam]
		test	cl, cl
		setz	cl
		push	edx		; lplf
		mov	[esi+38h], eax
		mov	[esp+50h+var_28], cl
		mov	[esp+50h+var_26], 1
		call	edi ; CreateFontIndirectA
		push	0		; hWnd
		mov	[esi+3Ch], eax
		call	ds:GetDC
		mov	ebp, ds:GetDeviceCaps
		mov	edi, eax
		push	0Eh		; index
		push	edi		; hdc
		call	ebp ; GetDeviceCaps
		push	0Ch		; index
		push	edi		; hdc
		mov	ebx, eax
		call	ebp ; GetDeviceCaps
		imul	ebx, eax
		push	edi		; hDC
		push	0		; hWnd
		call	ds:ReleaseDC
		cmp	ebx, 8
		push	0		; cGrow
		push	2Fh		; cInitial
		jg	short loc_401DD7
		push	1		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	[esi+40h], eax
		mov	eax, hInstance
		push	68h		; lpBitmapName
		push	eax		; hInstance
		call	ds:LoadBitmapA
		mov	ecx, [esi+40h]
		mov	edi, eax
		push	0FF00FFh
		push	edi
		push	ecx
		jmp	short loc_401E01
; ---------------------------------------------------------------------------

loc_401DD7:				; CODE XREF: sub_401C60+14Aj
		push	19h		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	[esi+40h], eax
		mov	edx, hInstance
		push	67h		; lpBitmapName
		push	edx		; hInstance
		call	ds:LoadBitmapA
		mov	edi, eax
		mov	eax, [esi+40h]
		push	0FF00FFh	; crMask
		push	edi		; hbmImage
		push	eax		; himl

loc_401E01:				; CODE XREF: sub_401C60+175j
		call	ds:ImageList_AddMasked
		push	edi		; ho
		call	ds:DeleteObject
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 3Ch
		retn
sub_401C60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401E20	proc near		; CODE XREF: sub_401A00+40p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ds:DeleteObject
		mov	eax, [esi+0Ch]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+10h]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+14h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+18h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+1Ch]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+20h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+24h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+28h]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+2Ch]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+30h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+34h]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+38h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+3Ch]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+40h]
		push	ecx		; himl
		call	ds:ImageList_Destroy
		pop	edi
		pop	esi
		retn
sub_401E20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401E90(COLORREF color, HDC hDC, RECT *lprcSrc, int, int, HGDIOBJ h)
sub_401E90	proc near		; CODE XREF: sub_402190+10Ep

rcDst		= tagRECT ptr -10h
color		= dword	ptr  4
hDC		= dword	ptr  8
lprcSrc		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
h		= dword	ptr  18h

		mov	eax, [esp+lprcSrc]
		sub	esp, 10h
		lea	ecx, [esp+10h+rcDst]
		push	ebp
		push	esi
		push	edi
		push	eax		; lprcSrc
		push	ecx		; lprcDst
		call	ds:CopyRect
		mov	eax, [esp+1Ch+h]
		mov	edi, [esp+1Ch+color]
		test	eax, eax
		jz	short loc_401ECB
		mov	edx, [edi+2Ch]
		mov	esi, [esp+1Ch+hDC]
		lea	eax, [esp+1Ch+rcDst]
		push	edx		; hbr
		push	eax		; lprc
		push	esi		; hDC
		call	ds:FillRect
		mov	ecx, [edi+18h]
		jmp	short loc_401EE2
; ---------------------------------------------------------------------------

loc_401ECB:				; CODE XREF: sub_401E90+20j
		mov	edx, [edi+30h]
		mov	esi, [esp+1Ch+hDC]
		lea	eax, [esp+1Ch+rcDst]
		push	edx		; hbr
		push	eax		; lprc
		push	esi		; hDC
		call	ds:FillRect
		mov	ecx, [edi+14h]

loc_401EE2:				; CODE XREF: sub_401E90+39j
		mov	ebp, ds:SelectObject
		push	ecx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	[esp+1Ch+lprcSrc], eax
		mov	eax, [esp+1Ch+rcDst.top]
		mov	edx, 5
		mov	ecx, [esp+1Ch+rcDst.left]
		add	eax, edx
		add	ecx, edx
		mov	[esp+1Ch+rcDst.top], eax
		mov	eax, [esp+1Ch+rcDst.bottom]
		sub	eax, edx
		mov	[esp+1Ch+rcDst.left], ecx
		mov	[esp+1Ch+rcDst.bottom],	eax
		mov	eax, [esp+1Ch+rcDst.right]
		sub	eax, edx
		cmp	eax, ecx
		mov	[esp+1Ch+rcDst.right], eax
		jle	loc_4020B6
		mov	edx, [edi+28h]
		push	ebx
		sub	eax, ecx
		push	edx		; h
		push	esi		; hdc
		mov	[esp+28h+color], eax
		call	ebp ; SelectObject
		mov	[esp+20h+h], eax
		mov	eax, [edi+24h]
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	ecx, [esp+20h+rcDst.bottom]
		mov	edx, [esp+20h+rcDst.right]
		mov	eax, [esp+20h+rcDst.top]
		add	ecx, 2
		push	ecx		; bottom
		mov	ecx, [esp+24h+rcDst.left]
		add	edx, 2
		dec	eax
		push	edx		; right
		dec	ecx
		push	eax		; top
		push	ecx		; left
		push	esi		; hdc
		call	ds:Rectangle
		mov	edx, [edi+20h]
		push	edx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	eax, [esp+20h+rcDst.bottom]
		mov	ecx, [esp+20h+rcDst.left]
		push	0		; lppt
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	edx, [esp+20h+rcDst.top]
		mov	eax, [esp+20h+rcDst.left]
		mov	ebx, ds:LineTo
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	ecx, [esp+20h+rcDst.top]
		mov	edx, [esp+20h+rcDst.right]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	eax, [edi+1Ch]
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	ecx, [esp+20h+rcDst.bottom]
		mov	edx, [esp+20h+rcDst.right]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	eax, [esp+20h+rcDst.bottom]
		mov	ecx, [esp+20h+rcDst.left]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	eax, [esp+20h+arg_10]
		test	eax, eax
		jz	short loc_401FFD
		cmp	[esp+20h+arg_C], eax
		jle	short loc_401FDD
		mov	edx, [edi+10h]
		mov	ecx, [esp+20h+rcDst.left]
		mov	eax, [esp+20h+color]
		mov	[esp+20h+hDC], edx
		add	eax, ecx
		jmp	short loc_402003
; ---------------------------------------------------------------------------

loc_401FDD:				; CODE XREF: sub_401E90+138j
		fild	[esp+20h+arg_C]
		mov	ecx, [edi+0Ch]
		mov	[esp+20h+hDC], ecx
		fidiv	[esp+20h+arg_10]
		fimul	[esp+20h+color]
		call	__ftol
		mov	ecx, [esp+20h+rcDst.left]
		add	eax, ecx
		jmp	short loc_402003
; ---------------------------------------------------------------------------

loc_401FFD:				; CODE XREF: sub_401E90+132j
		mov	ecx, [esp+20h+rcDst.left]
		mov	eax, ecx

loc_402003:				; CODE XREF: sub_401E90+14Bj
					; sub_401E90+16Bj
		mov	edx, [esp+20h+rcDst.top]
		mov	[esp+20h+rcDst.right], eax
		inc	edx
		inc	ecx
		cmp	eax, ecx
		mov	[esp+20h+rcDst.top], edx
		mov	[esp+20h+rcDst.left], ecx
		jle	loc_4020A5
		mov	edx, [edi+8]
		push	edx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	[esp+20h+color], eax
		mov	eax, [esp+20h+hDC]
		lea	ecx, [esp+20h+rcDst]
		push	eax		; hbr
		push	ecx		; lprc
		push	esi		; hDC
		call	ds:FillRect
		mov	eax, [esp+20h+rcDst.top]
		mov	ecx, [esp+20h+rcDst.left]
		mov	edx, [esp+20h+rcDst.right]
		dec	eax
		push	0		; lppt
		push	eax		; y
		dec	ecx
		push	edx		; x
		push	esi		; hdc
		mov	[esp+30h+rcDst.top], eax
		mov	[esp+30h+rcDst.left], ecx
		call	ds:MoveToEx
		mov	eax, [esp+20h+rcDst.top]
		mov	ecx, [esp+20h+rcDst.left]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	edx, [esp+20h+rcDst.bottom]
		mov	eax, [esp+20h+rcDst.left]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	ecx, [edi+20h]
		push	ecx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	edx, [esp+20h+rcDst.bottom]
		mov	eax, [esp+20h+rcDst.right]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	ecx, [esp+20h+rcDst.top]
		mov	edx, [esp+20h+rcDst.right]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ebx ; LineTo
		mov	eax, [esp+20h+color]
		push	eax		; color
		push	esi		; hdc
		call	ds:SetBkColor

loc_4020A5:				; CODE XREF: sub_401E90+187j
		mov	ecx, [esp+20h+h]
		push	ecx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	edx, [esp+20h+lprcSrc]
		push	edx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		pop	ebx

loc_4020B6:				; CODE XREF: sub_401E90+8Fj
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 10h
		retn
sub_401E90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4020C0(int, HDC hDC, RECT *lprc, int,	int, int)
sub_4020C0	proc near		; CODE XREF: sub_402190+130p

arg_0		= dword	ptr  4
hDC		= dword	ptr  8
lprc		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_14		= dword	ptr  18h

		mov	eax, [esp+arg_14]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		test	eax, eax
		push	esi
		jz	short loc_4020DF
		mov	eax, [ebp+2Ch]
		mov	esi, [esp+0Ch+lprc]
		mov	ecx, [esp+0Ch+hDC]
		push	eax
		push	esi
		push	ecx
		jmp	short loc_4020ED
; ---------------------------------------------------------------------------

loc_4020DF:				; CODE XREF: sub_4020C0+Dj
		mov	edx, [ebp+30h]
		mov	esi, [esp+0Ch+lprc]
		mov	eax, [esp+0Ch+hDC]
		push	edx		; hbr
		push	esi		; lprc
		push	eax		; hDC

loc_4020ED:				; CODE XREF: sub_4020C0+1Dj
		call	ds:FillRect
		mov	eax, [esi]
		mov	ebx, [esi+8]
		sub	ebx, eax
		mov	[esp+0Ch+arg_0], eax
		cmp	ebx, 10h
		jl	short loc_402161
		mov	eax, [esp+0Ch+arg_C]
		push	edi
		xor	edi, edi
		cmp	eax, 2
		jle	short loc_402114
		mov	edi, 4

loc_402114:				; CODE XREF: sub_4020C0+4Dj
		jnz	short loc_40211B
		mov	edi, 2

loc_40211B:				; CODE XREF: sub_4020C0:loc_402114j
		mov	ecx, [ebp+4]
		test	ecx, ecx
		jnz	short loc_40212C
		cmp	eax, 1
		jnz	short loc_40212C
		mov	edi, 2

loc_40212C:				; CODE XREF: sub_4020C0+60j
					; sub_4020C0+65j
		mov	ecx, [esi+4]
		mov	eax, [esi+0Ch]
		sub	eax, ecx
		push	1		; fStyle
		sub	eax, 10h
		cdq
		sub	eax, edx
		sar	eax, 1
		add	eax, ecx
		mov	ecx, [esp+14h+hDC]
		push	eax		; y
		lea	eax, [ebx-10h]
		mov	ebx, [esp+18h+arg_0]
		cdq
		sub	eax, edx
		mov	edx, [ebp+40h]
		sar	eax, 1
		add	eax, ebx
		push	eax		; x
		push	ecx		; hdcDst
		push	edi		; i
		push	edx		; himl
		call	ds:ImageList_Draw
		pop	edi

loc_402161:				; CODE XREF: sub_4020C0+41j
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_4020C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402170	proc near		; CODE XREF: sub_402190+18p
		mov	eax, offset dword_408B60
		retn
sub_402170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402180	proc near		; CODE XREF: sub_402190+1Ep
		mov	eax, offset dword_408B00
		retn
sub_402180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402190	proc near		; CODE XREF: sub_402320+59p

var_14		= dword	ptr -14h
rcDst		= tagRECT ptr -10h
arg_0		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+20h+arg_0]
		push	edi
		mov	edi, [esi+14h]
		push	edi		; hWnd
		call	ds:GetParent
		push	edi
		mov	ebx, eax
		call	sub_402170
		push	ebx
		call	sub_402180
		mov	edi, [esi+2Ch]
		add	esp, 8
		mov	ebp, eax
		lea	eax, [esi+1Ch]
		lea	ecx, [esp+24h+rcDst]
		push	eax		; lprcSrc
		push	ecx		; lprcDst
		mov	[esp+2Ch+arg_0], edi
		call	ds:CopyRect
		mov	edx, [esp+24h+rcDst.top]
		mov	eax, [esp+24h+rcDst.left]
		mov	ecx, [esi+18h]
		push	1		; fStyle
		push	edx		; y
		mov	edx, [edi+4]
		push	eax		; x
		mov	eax, [ebp+40h]
		push	ecx		; hdcDst
		push	edx		; i
		push	eax		; himl
		call	ds:ImageList_Draw
		mov	eax, [esp+24h+rcDst.left]
		xor	ebx, ebx
		mov	[esp+24h+rcDst.right], eax
		add	eax, 10h
		mov	[esp+24h+rcDst.left], eax
		xor	edi, edi

loc_4021FF:				; CODE XREF: sub_402190+87j
		mov	ecx, [esi+14h]
		push	0		; lParam
		push	edi		; wParam
		push	101Dh		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		add	ebx, eax
		inc	edi
		cmp	edi, 4
		jl	short loc_4021FF
		mov	edx, [esp+24h+arg_0]
		mov	[esp+24h+var_14], ebx
		xor	ebx, ebx
		lea	edi, [edx+30h]

loc_402226:				; CODE XREF: sub_402190+173j
		mov	eax, [esi+14h]
		push	0		; lParam
		push	ebx		; wParam
		push	101Dh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	edx, [esp+24h+rcDst.right]
		add	edx, eax
		mov	[esp+24h+rcDst.right], edx
		mov	eax, [edi-28h]
		dec	eax
		jz	loc_4022D8
		dec	eax
		jz	short loc_4022CA
		dec	eax
		jnz	loc_4022F4
		mov	ecx, [esp+24h+arg_0]
		cmp	dword ptr [ecx+4], 1Dh
		jnz	short loc_402280
		test	byte ptr [esi+10h], 1
		jz	short loc_40227B
		mov	edx, [ebp+2Ch]

loc_402269:				; CODE XREF: sub_402190+EEj
		mov	ecx, [esi+18h]
		lea	eax, [esp+24h+rcDst]
		push	edx		; hbr
		push	eax		; lprc
		push	ecx		; hDC
		call	ds:FillRect
		jmp	short loc_4022F4
; ---------------------------------------------------------------------------

loc_40227B:				; CODE XREF: sub_402190+D4j
		mov	edx, [ebp+30h]
		jmp	short loc_402269
; ---------------------------------------------------------------------------

loc_402280:				; CODE XREF: sub_402190+CEj
		cmp	dword ptr [ebp+0], 0
		jz	short loc_4022A8
		mov	edx, [esi+10h]
		mov	eax, [edi+28h]
		mov	ecx, [edi]
		and	edx, 1
		push	edx		; h
		push	eax		; int
		mov	eax, [esi+18h]
		lea	edx, [esp+2Ch+rcDst]
		push	ecx		; int
		push	edx		; lprcSrc
		push	eax		; hDC
		push	ebp		; color
		call	sub_401E90
		add	esp, 18h
		jmp	short loc_4022F4
; ---------------------------------------------------------------------------

loc_4022A8:				; CODE XREF: sub_402190+F4j
		mov	ecx, [esi+10h]
		mov	edx, [edi+28h]
		mov	eax, [edi]
		and	ecx, 1
		push	ecx		; int
		push	edx		; int
		mov	edx, [esi+18h]
		lea	ecx, [esp+2Ch+rcDst]
		push	eax		; int
		push	ecx		; lprc
		push	edx		; hDC
		push	ebp		; int
		call	sub_4020C0
		add	esp, 18h
		jmp	short loc_4022F4
; ---------------------------------------------------------------------------

loc_4022CA:				; CODE XREF: sub_402190+BDj
		mov	ecx, [edi]
		mov	edx, [esi+18h]
		lea	eax, [esp+24h+rcDst]
		push	eax
		push	ecx
		push	edx
		jmp	short loc_4022EC
; ---------------------------------------------------------------------------

loc_4022D8:				; CODE XREF: sub_402190+B6j
		mov	eax, [esp+24h+var_14]
		lea	ecx, [esp+24h+rcDst]
		mov	[esp+24h+rcDst.right], eax
		mov	edx, [edi]
		mov	eax, [esi+18h]
		push	ecx		; lprect
		push	edx		; lpString2
		push	eax		; hdc

loc_4022EC:				; CODE XREF: sub_402190+146j
		call	sub_4023C0
		add	esp, 0Ch

loc_4022F4:				; CODE XREF: sub_402190+C0j
					; sub_402190+E9j ...
		mov	ecx, [esp+24h+rcDst.right]
		inc	ebx
		add	edi, 4
		cmp	ebx, 4
		mov	[esp+24h+rcDst.left], ecx
		jl	loc_402226
		mov	edx, [esp+24h+var_14]
		pop	edi
		mov	[esi+24h], edx
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_402190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402320	proc near		; CODE XREF: sub_402530+25p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		test	byte ptr [esi+10h], 1
		jz	short loc_402350
		mov	edi, ds:GetSysColor
		push	0Eh		; nIndex
		call	edi ; GetSysColor
		mov	ebp, ds:SetTextColor
		push	eax		; color
		mov	eax, [esi+18h]
		push	eax		; hdc
		call	ebp ; SetTextColor
		push	0Dh		; nIndex
		call	edi ; GetSysColor
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		jmp	short loc_402370
; ---------------------------------------------------------------------------

loc_402350:				; CODE XREF: sub_402320+Cj
		mov	edi, ds:GetSysColor
		push	8		; nIndex
		call	edi ; GetSysColor
		mov	edx, [esi+18h]
		mov	ebp, ds:SetTextColor
		push	eax		; color
		push	edx		; hdc
		call	ebp ; SetTextColor
		push	5		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		mov	eax, [esi+18h]
		push	eax		; hdc

loc_402370:				; CODE XREF: sub_402320+2Ej
		mov	ebx, ds:SetBkColor
		call	ebx ; SetBkColor
		push	esi
		call	sub_402190
		mov	ecx, [esi+1Ch]
		mov	al, [esi+10h]
		add	esp, 4
		add	ecx, 10h
		test	al, 1
		mov	[esi+1Ch], ecx
		jz	short loc_4023A7
		push	8		; nIndex
		call	edi ; GetSysColor
		mov	ecx, [esi+18h]
		push	eax		; color
		push	ecx		; hdc
		call	ebp ; SetTextColor
		push	5		; nIndex
		call	edi ; GetSysColor
		mov	edx, [esi+18h]
		push	eax		; color
		push	edx		; hdc
		call	ebx ; SetBkColor

loc_4023A7:				; CODE XREF: sub_402320+6Fj
		test	byte ptr [esi+10h], 10h
		jz	short loc_4023BB
		lea	eax, [esi+1Ch]
		push	eax		; lprc
		mov	eax, [esi+18h]
		push	eax		; hDC
		call	ds:DrawFocusRect

loc_4023BB:				; CODE XREF: sub_402320+8Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_402320	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4023C0(HDC hdc, LPCSTR lpString2, RECT *lprect)
sub_4023C0	proc near		; CODE XREF: sub_402190:loc_4022ECp

String1		= byte ptr -100h
hdc		= dword	ptr  4
lpString2	= dword	ptr  8
lprect		= dword	ptr  0Ch

		mov	eax, [esp+lpString2]
		sub	esp, 100h
		lea	ecx, [esp+100h+String1]
		push	esi
		push	edi
		push	eax		; lpString2
		push	ecx		; lpString1
		call	ds:lstrcpyA
		mov	esi, [esp+108h+lprect]
		lea	eax, [esp+108h+String1]
		mov	edx, [esi+8]
		mov	edi, [esi]
		sub	edx, edi
		mov	edi, [esp+108h+hdc]
		push	edx		; int
		push	100h		; size_t
		push	eax		; lpString2
		push	edi		; hdc
		call	sub_402440
		add	esp, 10h
		lea	ecx, [esp+108h+String1]
		push	0		; lpDx
		push	ecx		; lpString
		call	ds:lstrlenA
		mov	ecx, [esi]
		push	eax		; c
		mov	eax, [esi+4]
		lea	edx, [esp+110h+String1]
		push	edx		; lpString
		push	esi		; lprect
		inc	eax
		push	6		; options
		add	ecx, 2
		push	eax		; y
		push	ecx		; x
		push	edi		; hdc
		call	ds:ExtTextOutA
		pop	edi
		pop	esi
		add	esp, 100h
		retn
sub_4023C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402440(HDC hdc, LPCSTR lpString2, size_t, int)
sub_402440	proc near		; CODE XREF: sub_4023C0+39p

String		= byte ptr -18h
var_14		= dword	ptr -14h
sz		= tagSIZE ptr -10h
var_8		= tagSIZE ptr -8
hdc		= dword	ptr  4
lpString2	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 18h
		mov	ecx, [esp+18h+arg_8]
		mov	eax, dword_40815C
		push	ebx
		mov	ebx, [esp+1Ch+arg_C]
		push	ebp
		push	esi
		push	edi
		push	ecx		; size_t
		mov	dword ptr [esp+2Ch+String], eax
		mov	[esp+2Ch+var_14], 0
		sub	ebx, 4
		call	_malloc
		mov	edx, [esp+2Ch+lpString2]
		add	esp, 4
		mov	edi, eax
		push	edx		; lpString2
		push	edi		; lpString1
		call	ds:lstrcpyA
		push	edi		; lpString
		call	ds:lstrlenA
		mov	ebp, [esp+28h+hdc]
		mov	esi, eax
		lea	eax, [esp+28h+sz]
		push	eax		; lpsz
		push	esi		; c
		push	edi		; lpString
		push	ebp		; hdc
		call	ds:GetTextExtentPointA
		cmp	[esp+28h+sz._cx], ebx
		jbe	short loc_402510
		lea	ecx, [esp+28h+var_8]
		lea	edx, [esp+28h+String]
		push	ecx		; lpsz
		push	edx		; lpString
		call	ds:lstrlenA
		push	eax		; c
		lea	eax, [esp+30h+String]
		push	eax		; lpString
		push	ebp		; hdc
		call	ds:GetTextExtentPointA
		test	esi, esi
		jle	short loc_402518

loc_4024BC:				; CODE XREF: sub_402440+B4j
		lea	ecx, [esp+28h+sz]
		dec	esi
		push	ecx		; lpsz
		push	esi		; c
		push	edi		; lpString
		push	ebp		; hdc
		mov	byte ptr [esi+edi], 0
		call	ds:GetTextExtentPointA
		mov	edx, [esp+28h+sz._cx]
		mov	eax, [esp+28h+var_8._cx]
		add	eax, edx
		cmp	eax, ebx
		ja	short loc_4024F2
		lea	ecx, [esp+28h+String]
		push	ecx		; lpString
		call	ds:lstrlenA
		mov	ecx, [esp+28h+arg_8]
		add	eax, esi
		cmp	ecx, eax
		jge	short loc_4024F8

loc_4024F2:				; CODE XREF: sub_402440+9Bj
		test	esi, esi
		jg	short loc_4024BC
		jmp	short loc_402518
; ---------------------------------------------------------------------------

loc_4024F8:				; CODE XREF: sub_402440+B0j
		lea	edx, [esp+28h+String]
		push	edx		; lpString2
		push	edi		; lpString1
		call	ds:lstrcatA
		mov	eax, [esp+28h+lpString2]
		push	edi		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA

loc_402510:				; CODE XREF: sub_402440+59j
		mov	[esp+28h+var_14], 1

loc_402518:				; CODE XREF: sub_402440+7Aj
					; sub_402440+B6j
		push	edi		; void *
		call	_free
		mov	eax, [esp+2Ch+var_14]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_402440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402530	proc near		; CODE XREF: sub_401A60+D6p

arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [ecx]
		cmp	eax, 66h
		jz	short loc_402543
		cmp	eax, 2
		jz	short loc_402543
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_402543:				; CODE XREF: sub_402530+9j
					; sub_402530+Ej
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jbe	short loc_40255D
		cmp	eax, 2
		jbe	short loc_402554
		cmp	eax, 4
		jnz	short loc_40255D

loc_402554:				; CODE XREF: sub_402530+1Dj
		push	ecx
		call	sub_402320
		add	esp, 4

loc_40255D:				; CODE XREF: sub_402530+18j
					; sub_402530+22j
		mov	eax, 1
		retn
sub_402530	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402570(HWND hDlg, int)
sub_402570	proc near		; CODE XREF: sub_401A60+F6p

tm		= tagTEXTMETRICA ptr -38h
hDlg		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		push	ebx
		mov	ebx, [esp+3Ch+arg_4]
		push	esi
		push	edi
		mov	eax, [ebx]
		cmp	eax, 66h
		jz	short loc_402586
		cmp	eax, 2
		jnz	short loc_4025E5

loc_402586:				; CODE XREF: sub_402570+Fj
		mov	eax, [ebx+4]
		mov	ecx, [esp+44h+hDlg]
		push	ebp
		push	eax		; nIDDlgItem
		push	ecx		; hDlg
		call	ds:GetDlgItem
		push	0		; lParam
		mov	esi, eax
		push	0		; wParam
		push	31h		; Msg
		push	esi		; hWnd
		call	ds:SendMessageA
		push	esi		; hWnd
		mov	ebp, eax
		call	ds:GetDC
		mov	edi, eax
		push	ebp		; h
		push	edi		; hdc
		call	ds:SelectObject
		lea	edx, [esp+48h+tm]
		push	edx		; lptm
		push	edi		; hdc
		call	ds:GetTextMetricsA
		test	eax, eax
		pop	ebp
		jz	short loc_4025E5
		mov	eax, [esp+44h+tm.tmHeight]
		inc	eax
		cmp	eax, 11h
		mov	[ebx+10h], eax
		jnb	short loc_4025DD
		mov	dword ptr [ebx+10h], 11h

loc_4025DD:				; CODE XREF: sub_402570+64j
		push	edi		; hDC
		push	esi		; hWnd
		call	ds:ReleaseDC

loc_4025E5:				; CODE XREF: sub_402570+14j
					; sub_402570+57j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 38h
		retn
sub_402570	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION DdeUninitialize]
; [00000006 BYTES: COLLAPSED FUNCTION DdeNameService]
; [00000006 BYTES: COLLAPSED FUNCTION DdeCreateStringHandleA]
; [00000006 BYTES: COLLAPSED FUNCTION DdeInitializeA]
; [00000006 BYTES: COLLAPSED FUNCTION DdeQueryStringA]
; [00000006 BYTES: COLLAPSED FUNCTION DdeGetData]
; [00000006 BYTES: COLLAPSED FUNCTION DdeFreeStringHandle]
; [00000006 BYTES: COLLAPSED FUNCTION UninitPGPsc]
; [00000006 BYTES: COLLAPSED FUNCTION InitPGPsc]
; [00000006 BYTES: COLLAPSED FUNCTION WindowExists]
; [00000006 BYTES: COLLAPSED FUNCTION GetMarginalInvalidPref]
; [00000006 BYTES: COLLAPSED FUNCTION GetValidityDrawPrefs]
; [00000017 BYTES: COLLAPSED FUNCTION __fpmath]
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1]
; [00000038 BYTES: COLLAPSED FUNCTION __cfltcvt_init]
; [00000027 BYTES: COLLAPSED FUNCTION __ftol]
; [0000002F BYTES: COLLAPSED FUNCTION _free]
		align 10h
; [00000080 BYTES: COLLAPSED FUNCTION _strstr]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc]
; [00000036 BYTES: COLLAPSED FUNCTION __heap_alloc]
; [000000F6 BYTES: COLLAPSED FUNCTION start]
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit]
; ---------------------------------------------------------------------------
		retn
; [00000012 BYTES: COLLAPSED FUNCTION __setdefaultprecision]
; [0000003E BYTES: COLLAPSED FUNCTION __ms_p5_test_fdiv]
; [00000029 BYTES: COLLAPSED FUNCTION __ms_p5_mp_test_fdiv]
; [0000005A BYTES: COLLAPSED FUNCTION __forcdecpt]
; ---------------------------------------------------------------------------

__cropzeros:				; DATA XREF: __cfltcvt_init+5o
		mov	eax, [esp+4]
		mov	dl, byte_4082E4
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_402A02

loc_4029F6:				; CODE XREF: .text:00402A00j
		cmp	cl, dl
		jz	short loc_402A02
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_4029F6

loc_402A02:				; CODE XREF: .text:004029F4j
					; .text:004029F8j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jz	short locret_402A33

loc_402A09:				; CODE XREF: .text:00402A1Aj
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_402A1C
		cmp	cl, 65h
		jz	short loc_402A1C
		cmp	cl, 45h
		jz	short loc_402A1C
		inc	eax
		jmp	short loc_402A09
; ---------------------------------------------------------------------------

loc_402A1C:				; CODE XREF: .text:00402A0Dj
					; .text:00402A12j ...
		mov	ecx, eax

loc_402A1E:				; CODE XREF: .text:00402A22j
		dec	eax
		cmp	byte ptr [eax],	30h
		jz	short loc_402A1E
		cmp	[eax], dl
		jnz	short loc_402A29
		dec	eax

loc_402A29:				; CODE XREF: .text:00402A26j
					; .text:00402A31j
		mov	dl, [ecx]
		inc	eax
		inc	ecx
		test	dl, dl
		mov	[eax], dl
		jnz	short loc_402A29

locret_402A33:				; CODE XREF: .text:00402A07j
		retn
; ---------------------------------------------------------------------------

__positive:				; DATA XREF: __cfltcvt_init+28o
		mov	eax, [esp+4]
		fld	qword ptr [eax]
		fcomp	ds:dbl_407218
		fnstsw	ax
		sahf
		jb	short loc_402A49
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------

loc_402A49:				; CODE XREF: .text:00402A43j
		xor	eax, eax
		retn
; [0000003E BYTES: COLLAPSED FUNCTION __fassign]
; [00000104 BYTES: COLLAPSED FUNCTION __cftoe]
; [000000DE BYTES: COLLAPSED FUNCTION __cftof]
; [0000009B BYTES: COLLAPSED FUNCTION __cftog]
; [00000027 BYTES: COLLAPSED FUNCTION __cftoe_g]
; [00000023 BYTES: COLLAPSED FUNCTION __cftof_g]
; [00000051 BYTES: COLLAPSED FUNCTION __cfltcvt]
; [00000025 BYTES: COLLAPSED FUNCTION __shift]
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group]
		align 10h
; [00000005 BYTES: COLLAPSED CHUNK OF FUNCTION _strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strchr]
; [000000B6 BYTES: COLLAPSED CHUNK OF FUNCTION _strstr]
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh]
; [0000002D BYTES: COLLAPSED FUNCTION __cinit]
; [00000011 BYTES: COLLAPSED FUNCTION _exit]
; [00000011 BYTES: COLLAPSED FUNCTION __exit]
; [00000099 BYTES: COLLAPSED FUNCTION _doexit]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm]
; [00000141 BYTES: COLLAPSED FUNCTION __XcptFilter]
; [00000043 BYTES: COLLAPSED FUNCTION _xcptlookup]
; [00000058 BYTES: COLLAPSED FUNCTION __wincmdln]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA]
; [000001AB BYTES: COLLAPSED FUNCTION __ioinit]
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_408240
		jmp	short __NLG_Go
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify]
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION __except_handler3]
; [0000001B BYTES: COLLAPSED FUNCTION _seh_longjmp_unwind(x)]
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE]
; [00000035 BYTES: COLLAPSED FUNCTION __control87]
; [00000016 BYTES: COLLAPSED FUNCTION __controlfp]
; [00000092 BYTES: COLLAPSED FUNCTION __abstract_cw]
; [00000089 BYTES: COLLAPSED FUNCTION __hw_cw]
; [00000075 BYTES: COLLAPSED FUNCTION __isctype]
; [000000CB BYTES: COLLAPSED FUNCTION _tolower]
; [00000049 BYTES: COLLAPSED FUNCTION __ZeroTail]
; [00000056 BYTES: COLLAPSED FUNCTION __IncMan]
; [0000008C BYTES: COLLAPSED FUNCTION __RoundMan]
; [0000001B BYTES: COLLAPSED FUNCTION __CopyMan]
; [0000000C BYTES: COLLAPSED FUNCTION __FillZeroMan]
; [0000001B BYTES: COLLAPSED FUNCTION __IsZeroMan]
; [0000008D BYTES: COLLAPSED FUNCTION __ShrMan]
; [0000016C BYTES: COLLAPSED FUNCTION __ld12cvt]

; =============== S U B	R O U T	I N E =======================================


sub_404960	proc near		; CODE XREF: sub_40498C+23p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset dword_4084F8
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	__ld12cvt
		add	esp, 0Ch
		retn
sub_404960	endp


; =============== S U B	R O U T	I N E =======================================


sub_404976	proc near		; CODE XREF: sub_4049B9+23p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset dword_408510
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	__ld12cvt
		add	esp, 0Ch
		retn
sub_404976	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40498C	proc near		; CODE XREF: __fassign+12p

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	[ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	___strgtold12
		push	[ebp+arg_0]
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_404960
		add	esp, 24h
		leave
		retn
sub_40498C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4049B9	proc near		; CODE XREF: __fassign+2Dp

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	[ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	___strgtold12
		push	[ebp+arg_0]
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_404976
		add	esp, 24h
		leave
		retn
sub_4049B9	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat]
; [00000077 BYTES: COLLAPSED FUNCTION __fptostr]
; [00000064 BYTES: COLLAPSED FUNCTION __fltout]
; [000000B6 BYTES: COLLAPSED FUNCTION ___dtold]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy]
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen]
; [00000007 BYTES: COLLAPSED FUNCTION __fptrap]
		db  59h	; Y
		db 0C3h	; 
; [00000011 BYTES: COLLAPSED FUNCTION __ismbblead]
; [00000031 BYTES: COLLAPSED FUNCTION _x_ismbbtype]
; [00000199 BYTES: COLLAPSED FUNCTION __setmbcp]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow]
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt]
; [00000021 BYTES: COLLAPSED FUNCTION ___addl]
; [0000005E BYTES: COLLAPSED FUNCTION ___add_12]
; [0000002E BYTES: COLLAPSED FUNCTION ___shl_12]
; [0000002D BYTES: COLLAPSED FUNCTION ___shr_12]
; [000000C7 BYTES: COLLAPSED FUNCTION ___mtold12]
; [000004A1 BYTES: COLLAPSED FUNCTION ___strgtold12]
off_406368	dd offset loc_405F31	; DATA XREF: ___strgtold12+63r
		dd offset loc_405F80	; jump table for switch	statement
		dd offset loc_405FD7
		dd offset loc_406001
		dd offset loc_40605C
		dd offset loc_4060D3
		dd offset loc_406109
		dd offset loc_406153
		dd offset loc_406132
		dd offset loc_4061B7
		dd offset loc_4061A1
		dd offset loc_40616D
; [00000293 BYTES: COLLAPSED FUNCTION _$I10_OUTPUT]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe]
; [00000220 BYTES: COLLAPSED FUNCTION ___ld12mul]
; [0000007C BYTES: COLLAPSED FUNCTION ___multtenpow12]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 800h
_text		ends

; Section 2. (virtual address 00007000)
; Virtual size			: 00000F30 (   3888.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00007000
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_401800+97p
					; sub_4018F0+77p
					; DATA XREF: ...
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_401800+29p
					; sub_4018F0+1Dp
					; DATA XREF: ...
; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey,	DWORD Reserved,	LPSTR lpClass, DWORD dwOptions,	REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; CODE XREF: sub_4018F0+106p
					; DATA XREF: sub_4018F0+106r
; LSTATUS __stdcall RegSetValueExA(HKEY	hKey, LPCSTR lpValueName, DWORD	Reserved, DWORD	dwType,	const BYTE *lpData, DWORD cbData)
		extrn RegSetValueExA:dword ; CODE XREF:	sub_4017E0+15p
					; DATA XREF: sub_4017E0+15r
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_4018B0+2Fp
					; DATA XREF: sub_4018B0+2Fr

;
; Imports from COMCTL32.dll
;
; HIMAGELIST __stdcall ImageList_Create(int cx,	int cy,	UINT flags, int	cInitial, int cGrow)
		extrn ImageList_Create:dword ; CODE XREF: sub_401C60+152p
					; sub_401C60+17Dp
					; DATA XREF: ...
; BOOL __stdcall ImageList_Destroy(HIMAGELIST himl)
		extrn ImageList_Destroy:dword ;	CODE XREF: sub_401E20+5Ep
					; DATA XREF: sub_401E20+5Er
; BOOL __stdcall ImageList_Draw(HIMAGELIST himl, int i,	HDC hdcDst, int	x, int y, UINT fStyle)
		extrn ImageList_Draw:dword ; CODE XREF:	sub_4020C0+9Ap
					; sub_402190+56p
					; DATA XREF: ...
; int __stdcall	ImageList_AddMasked(HIMAGELIST himl, HBITMAP hbmImage, COLORREF	crMask)
		extrn ImageList_AddMasked:dword	; CODE XREF: sub_401C60:loc_401E01p
					; DATA XREF: sub_401C60:loc_401E01r
; void __stdcall InitCommonControls()
		extrn InitCommonControls:dword ; CODE XREF: sub_401A60:loc_401A8Dp
					; DATA XREF: sub_401A60:loc_401A8Dr

;
; Imports from GDI32.dll
;
; BOOL __stdcall GetTextMetricsA(HDC hdc, LPTEXTMETRICA	lptm)
		extrn GetTextMetricsA:dword ; CODE XREF: sub_402570+4Ep
					; DATA XREF: sub_402570+4Er ...
; BOOL __stdcall LineTo(HDC hdc, int x,	int y)
		extrn LineTo:dword	; CODE XREF: sub_401E90+FCp
					; sub_401E90+109p ...
; BOOL __stdcall GetTextExtentPointA(HDC hdc, LPCSTR lpString, int c, LPSIZE lpsz)
		extrn GetTextExtentPointA:dword	; CODE XREF: sub_402440+4Fp
					; sub_402440+72p ...
; BOOL __stdcall ExtTextOutA(HDC hdc, int x, int y, UINT options, const	RECT *lprect, LPCSTR lpString, UINT c, const INT *lpDx)
		extrn ExtTextOutA:dword	; CODE XREF: sub_4023C0+63p
					; DATA XREF: sub_4023C0+63r
; HGDIOBJ __stdcall SelectObject(HDC hdc, HGDIOBJ h)
		extrn SelectObject:dword ; CODE	XREF: sub_401E90+5Ap
					; sub_401E90+A1p ...
; BOOL __stdcall Rectangle(HDC hdc, int	left, int top, int right, int bottom)
		extrn Rectangle:dword	; CODE XREF: sub_401E90+CBp
					; DATA XREF: sub_401E90+CBr
; BOOL __stdcall MoveToEx(HDC hdc, int x, int y, LPPOINT lppt)
		extrn MoveToEx:dword	; CODE XREF: sub_401E90+E5p
					; sub_401E90+1C8p
					; DATA XREF: ...
; HBRUSH __stdcall CreateSolidBrush(COLORREF color)
		extrn CreateSolidBrush:dword ; CODE XREF: sub_401A60+160p
					; sub_401C60+41p ...
; HBRUSH __stdcall CreateHatchBrush(int	iHatch,	COLORREF color)
		extrn CreateHatchBrush:dword ; CODE XREF: sub_401C60+4Dp
					; DATA XREF: sub_401C60+4Dr
; HPEN __stdcall CreatePen(int iStyle, int cWidth, COLORREF color)
		extrn CreatePen:dword	; CODE XREF: sub_401C60+65p
					; sub_401C60+73p ...
; int __stdcall	GetDeviceCaps(HDC hdc, int index)
		extrn GetDeviceCaps:dword ; CODE XREF: sub_401C60+12Ep
					; sub_401C60+135p
					; DATA XREF: ...
; BOOL __stdcall DeleteObject(HGDIOBJ ho)
		extrn DeleteObject:dword ; CODE	XREF: sub_401C60+1A8p
					; sub_401E20+10p ...
; HFONT	__stdcall CreateFontIndirectA(const LOGFONTA *lplf)
		extrn CreateFontIndirectA:dword	; CODE XREF: sub_401A60+49p
					; sub_401C60+E3p ...
; COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color)
		extrn SetBkColor:dword	; CODE XREF: sub_401A60+14Dp
					; sub_401E90+192p ...
; COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color)
		extrn SetTextColor:dword ; CODE	XREF: sub_401A60+159p
					; sub_402320+23p ...

;
; Imports from KERNEL32.dll
;
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; LPSTR	__stdcall lstrcpyA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcpyA:dword	; CODE XREF: sub_4023C0+12p
					; sub_402440+34p ...
; LPSTR	__stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcatA:dword	; CODE XREF: sub_402440+BEp
					; DATA XREF: sub_402440+BEr
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtGetStringTypeA+C5p
					; ___crtGetStringTypeA+11Bp ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: ___crtMessageBoxA+12p
					; DATA XREF: ___crtMessageBoxA+12r
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+48p
					; _setSBUpLow+14p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __NMSG_WRITE+14Ap
					; DATA XREF: __NMSG_WRITE+14Ar
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+FFp
					; __ioinit+166p
					; DATA XREF: ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+158p
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+19Dp
					; DATA XREF: __ioinit+19Dr
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_403D4Ap
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+93p
					; ___crtGetEnvironmentStringsA+B5p ...
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: __setargv+23p
					; __NMSG_WRITE+6Dp
					; DATA XREF: ...
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+138p
					; DATA XREF: __XcptFilter+138r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+10p
					; DATA XREF: _doexit+10r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+17p
					; DATA XREF: _doexit+17r
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: ___sbh_alloc_new_region+28p
					; DATA XREF: ___sbh_alloc_new_region+28r
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: ___sbh_free_block+257p
					; ___sbh_free_block+2B2p
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; DATA XREF: __heap_init+2Fr
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: sub_4023C0+48p
					; sub_402440+3Bp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	__ms_p5_mp_test_fdiv+15p
					; ___crtMessageBoxA+2Ap ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+9Fp
					; __ioinit+59p
					; DATA XREF: ...
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: start+74p
					; DATA XREF: start+74r
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _fast_error_exit+1Dp
					; _doexit+91p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: start+C2p
					; __ms_p5_mp_test_fdiv+5p
					; DATA XREF: ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+2Ep
					; ___sbh_heap_init+Dp ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+27p
					; ___sbh_free_block+2C4p ...

;
; Imports from PGPsc.dll
;
		extrn __imp_UninitPGPsc:dword ;	DATA XREF: UninitPGPscr
					; .rdata:00407614o
		extrn __imp_InitPGPsc:dword ; DATA XREF: InitPGPscr
		extrn __imp_WindowExists:dword ; DATA XREF: WindowExistsr
		extrn __imp_GetMarginalInvalidPref:dword
					; DATA XREF: GetMarginalInvalidPrefr
		extrn __imp_GetValidityDrawPrefs:dword ; DATA XREF: GetValidityDrawPrefsr

;
; Imports from USER32.dll
;
; LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn SendMessageA:dword ; CODE	XREF: sub_401000+41p
					; sub_401000+54p ...
; BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax)
		extrn GetMessageA:dword	; CODE XREF: WinMain(x,x,x,x)+182p
					; WinMain(x,x,x,x)+1B9p
					; DATA XREF: ...
; BOOL __stdcall TranslateMessage(const	MSG *lpMsg)
		extrn TranslateMessage:dword ; CODE XREF: WinMain(x,x,x,x)+1A0p
					; DATA XREF: WinMain(x,x,x,x)+1A0r
; BOOL __stdcall GetClientRect(HWND hWnd, LPRECT lpRect)
		extrn GetClientRect:dword ; CODE XREF: sub_401060+18p
					; sub_401110+17p ...
; int __stdcall	GetSystemMetrics(int nIndex)
		extrn GetSystemMetrics:dword ; CODE XREF: sub_401060+8p
					; sub_4018F0+87p ...
; BOOL __stdcall MoveWindow(HWND hWnd, int X, int Y, int nWidth, int nHeight, BOOL bRepaint)
		extrn MoveWindow:dword	; CODE XREF: sub_4010F0+18p
					; DATA XREF: sub_4010F0+18r
; BOOL __stdcall DdeUninitialize(DWORD idInst)
		extrn __imp_DdeUninitialize:dword ; DATA XREF: DdeUninitializer
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
		extrn DispatchMessageA:dword ; CODE XREF: WinMain(x,x,x,x)+1ABp
					; DATA XREF: WinMain(x,x,x,x)+1ABr
; HDDEDATA __stdcall DdeNameService(DWORD idInst, HSZ hsz1, HSZ	hsz2, UINT afCmd)
		extrn __imp_DdeNameService:dword ; DATA	XREF: DdeNameServicer
; HSZ __stdcall	DdeCreateStringHandleA(DWORD idInst, LPCSTR psz, int iCodePage)
		extrn __imp_DdeCreateStringHandleA:dword
					; DATA XREF: DdeCreateStringHandleAr
; BOOL __stdcall DestroyWindow(HWND hWnd)
		extrn DestroyWindow:dword ; CODE XREF: WinMain(x,x,x,x)+120p
					; DATA XREF: WinMain(x,x,x,x)+120r
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: WinMain(x,x,x,x)+119p
					; DATA XREF: WinMain(x,x,x,x)+119r
; UINT __stdcall DdeInitializeA(LPDWORD	pidInst, PFNCALLBACK pfnCallback, DWORD	afCmd, DWORD ulRes)
		extrn __imp_DdeInitializeA:dword ; DATA	XREF: DdeInitializeAr
; BOOL __stdcall UpdateWindow(HWND hWnd)
		extrn UpdateWindow:dword ; CODE	XREF: WinMain(x,x,x,x)+EDp
					; DATA XREF: WinMain(x,x,x,x)+EDr
; ATOM __stdcall RegisterClassA(const WNDCLASSA	*lpWndClass)
		extrn RegisterClassA:dword ; CODE XREF:	WinMain(x,x,x,x)+B0p
					; DATA XREF: WinMain(x,x,x,x)+B0r
; HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName)
		extrn LoadCursorA:dword	; CODE XREF: WinMain(x,x,x,x)+8Dp
					; DATA XREF: WinMain(x,x,x,x)+8Dr
; HICON	__stdcall LoadIconA(HINSTANCE hInstance, LPCSTR	lpIconName)
		extrn LoadIconA:dword	; CODE XREF: WinMain(x,x,x,x)+7Dp
					; DATA XREF: WinMain(x,x,x,x)+7Dr
; DWORD	__stdcall DdeQueryStringA(DWORD	idInst,	HSZ hsz, LPSTR psz, DWORD cchMax, int iCodePage)
		extrn __imp_DdeQueryStringA:dword ; DATA XREF: DdeQueryStringAr
; DWORD	__stdcall DdeGetData(HDDEDATA hData, LPBYTE pDst, DWORD	cbMax, DWORD cbOff)
		extrn __imp_DdeGetData:dword ; DATA XREF: DdeGetDatar
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: sub_401800+Dp
					; sub_401A60+8Fp
					; DATA XREF: ...
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: sub_4018F0+D7p
					; DATA XREF: sub_4018F0+D7r
; void __stdcall PostQuitMessage(int nExitCode)
		extrn PostQuitMessage:dword ; CODE XREF: sub_401A00+4Ap
					; DATA XREF: sub_401A00+4Ar
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; CODE XREF: sub_402570+20p
					; DATA XREF: sub_402570+20r
; BOOL __stdcall DrawFocusRect(HDC hDC,	const RECT *lprc)
		extrn DrawFocusRect:dword ; CODE XREF: sub_402320+95p
					; DATA XREF: sub_402320+95r
; HWND __stdcall GetParent(HWND	hWnd)
		extrn GetParent:dword	; CODE XREF: sub_402190+Fp
					; DATA XREF: sub_402190+Fr
; BOOL __stdcall CopyRect(LPRECT lprcDst, const	RECT *lprcSrc)
		extrn CopyRect:dword	; CODE XREF: sub_401E90+10p
					; sub_402190+38p
					; DATA XREF: ...
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
		extrn FillRect:dword	; CODE XREF: sub_401E90+30p
					; sub_401E90+49p ...
; HDC __stdcall	GetDC(HWND hWnd)
		extrn GetDC:dword	; CODE XREF: sub_401C60+11Dp
					; sub_402570+38p
					; DATA XREF: ...
; int __stdcall	ReleaseDC(HWND hWnd, HDC hDC)
		extrn ReleaseDC:dword	; CODE XREF: sub_401C60+13Dp
					; sub_402570+6Fp
					; DATA XREF: ...
; HBITMAP __stdcall LoadBitmapA(HINSTANCE hInstance, LPCSTR lpBitmapName)
		extrn LoadBitmapA:dword	; CODE XREF: sub_401C60+163p
					; sub_401C60+18Fp
					; DATA XREF: ...
; BOOL __stdcall SystemParametersInfoA(UINT uiAction, UINT uiParam, PVOID pvParam, UINT	fWinIni)
		extrn SystemParametersInfoA:dword ; CODE XREF: sub_401A60+3Ep
					; sub_401C60+D2p
					; DATA XREF: ...
; BOOL __stdcall SetForegroundWindow(HWND hWnd)
		extrn SetForegroundWindow:dword	; CODE XREF: sub_401A60+B8p
					; DATA XREF: sub_401A60+B8r
; LRESULT __stdcall DefWindowProcA(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn DefWindowProcA:dword ; CODE XREF:	sub_401A60+122p
					; DATA XREF: sub_401A60+122r
; DWORD	__stdcall GetSysColor(int nIndex)
		extrn GetSysColor:dword	; CODE XREF: sub_401A60+147p
					; sub_401A60+155p ...
; BOOL __stdcall DdeFreeStringHandle(DWORD idInst, HSZ hsz)
		extrn __imp_DdeFreeStringHandle:dword ;	DATA XREF: DdeFreeStringHandler
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
		extrn CreateWindowExA:dword ; CODE XREF: sub_401110+53p
					; WinMain(x,x,x,x)+DBp
					; DATA XREF: ...
; BOOL __stdcall IsDialogMessageA(HWND hDlg, LPMSG lpMsg)
		extrn IsDialogMessageA:dword ; CODE XREF: WinMain(x,x,x,x)+195p
					; DATA XREF: WinMain(x,x,x,x)+189r
; BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow)
		extrn ShowWindow:dword	; CODE XREF: sub_401110+5Fp
					; WinMain(x,x,x,x)+E6p
					; DATA XREF: ...


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 4071C4h
		align 8
dbl_4071C8	dq 1.0			; DATA XREF: sub_401110+73r
					; __ms_p5_test_fdiv+2Ar
stru_4071D0	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_4028AB, offset loc_4028BF>
					; DATA XREF: start+5o
					; SEH scope table for function 4027D4
		align 10h
dbl_4071E0	dq 4195835.0		; DATA XREF: __ms_p5_test_fdiv+Fr
dbl_4071E8	dq 3145727.0		; DATA XREF: __ms_p5_test_fdiv+6r
; CHAR ProcName[]
ProcName	db 'IsProcessorFeaturePresent',0 ; DATA XREF: __ms_p5_mp_test_fdiv+Fo
		align 4
; CHAR ModuleName[]
ModuleName	db 'KERNEL32',0         ; DATA XREF: __ms_p5_mp_test_fdivo
		align 4
dbl_407218	dq 0.0			; DATA XREF: .text:00402A3Ar
; char aE000[]
aE000		db 'e+000',0            ; DATA XREF: __cftoe+93o
		align 4
aRuntimeError	db 'runtime error ',0
		align 4
		db 0Dh,0Ah,0
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0
		align 4
aSingError	db 'SING error',0Dh,0Ah,0
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 4
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 4
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 4
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 10h
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 4
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 4
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 4
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_408254o
		db '- floating point not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_4074DC[]
asc_4074DC	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 10h
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char aProgramNameUnk[]
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 4
; CHAR aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; CHAR aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; CHAR aMessageboxa[]
aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 10h
; CHAR byte_407550[4]
byte_407550	db 4 dup(0)		; DATA XREF: ___crtGetStringTypeA+52o
					; ___crtLCMapStringA+57o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: ___crtGetStringTypeA+39o
					; ___crtLCMapStringA+36o
		align 4
stru_407558	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_405A87, offset loc_405A8B>
					; DATA XREF: ___crtGetStringTypeA+5o
					; SEH scope table for function 40598E
		align 8
stru_407568	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_405BE7, offset loc_405BEB>
					; DATA XREF: ___crtLCMapStringA+5o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_405C9B, offset loc_405C9F> ; SEH scope table for function 405AD7
; char a1Qnan[]
a1Qnan		db '1#QNAN',0           ; DATA XREF: _$I10_OUTPUT:loc_40648Do
		align 4
; char a1Inf[]
a1Inf		db '1#INF',0            ; DATA XREF: _$I10_OUTPUT+D8o
		align 10h
a1Ind		db '1#IND',0            ; DATA XREF: _$I10_OUTPUT+C7o
		align 4
a1Snan		db '1#SNAN',0           ; DATA XREF: _$I10_OUTPUT+ADo
		align 10h
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_40769C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva LCMapStringA	; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_407754 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva SendMessageA	; Import Address Table
__IMPORT_DESCRIPTOR_GDI32 dd rva off_40765C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aGdi32_dll	; DLL Name
		dd rva GetTextMetricsA	; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_40762C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegCloseKey	; Import Address Table
__IMPORT_DESCRIPTOR_COMCTL32 dd	rva off_407644 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aComctl32_dll	; DLL Name
		dd rva ImageList_Create	; Import Address Table
__IMPORT_DESCRIPTOR_PGPsc dd rva off_40773C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aPgpsc_dll	; DLL Name
		dd rva __imp_UninitPGPsc ; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_40762C	dd rva word_407BAA	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_407BB8
		dd rva word_407BDC
		dd rva word_407B98
		dd rva word_407BC8
		dd 0
;
; Import names for COMCTL32.dll
;
off_407644	dd rva word_407C12	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_COMCTL32o
		dd rva word_407C26
		dd rva word_407C3A
		dd rva word_407BFC
		dd 80000011h
		dd 0
;
; Import names for GDI32.dll
;
off_40765C	dd rva word_407B7C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_GDI32o
		dd rva word_407B26
		dd rva word_407B66
		dd rva word_407B58
		dd rva word_407B48
		dd rva word_407B3C
		dd rva word_407B30
		dd rva word_407A9E
		dd rva word_407B12
		dd rva word_407B06
		dd rva word_407AF6
		dd rva word_407AE6
		dd rva word_407AD0
		dd rva word_407AC2
		dd rva word_407AB2
		dd 0
;
; Import names for KERNEL32.dll
;
off_40769C	dd rva word_407F10	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_4077FC
		dd rva word_407808
		dd rva word_407EEC
		dd rva word_407ED6
		dd rva word_407EC6
		dd rva word_407EBA
		dd rva word_407EB0
		dd rva word_407EA4
		dd rva word_407E98
		dd rva word_407E8C
		dd rva word_407E7E
		dd rva word_407E6E
		dd rva word_407E5C
		dd rva word_407E42
		dd rva word_407E2A
		dd rva word_407E14
		dd rva word_407DFA
		dd rva word_407DE0
		dd rva word_407DCA
		dd rva word_407DAE
		dd rva word_407D9A
		dd rva word_407D86
		dd rva word_407D78
		dd rva word_407D68
		dd rva word_407D5A
		dd rva word_407D4C
		dd rva word_407D3E
		dd rva word_4077F0
		dd rva word_407D2C
		dd rva word_407CEC
		dd rva word_407D10
		dd rva word_407CFE
		dd rva word_407EFE
		dd rva word_407F20
		dd rva word_407D1E
		dd rva word_407CD8
		dd rva word_407CCC
		dd rva word_407CC0
		dd 0
;
; Import names for PGPsc.dll
;
off_40773C	dd rva word_407C5A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_PGPsco
		dd rva word_407C68
		dd rva word_407C74
		dd rva word_407C84
		dd rva word_407C9E
		dd 0
;
; Import names for USER32.dll
;
off_407754	dd rva word_407822	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_4078D2
		dd rva word_4078AA
		dd rva word_407832
		dd rva word_407842
		dd rva word_407856
		dd rva word_407884
		dd rva word_407896
		dd rva word_4078E0
		dd rva word_4078F2
		dd rva word_40790C
		dd rva word_40791C
		dd rva word_40792A
		dd rva word_40793C
		dd rva word_40794C
		dd rva word_40795E
		dd rva word_40796C
		dd rva word_407978
		dd rva word_40798A
		dd rva word_407998
		dd rva word_4079A8
		dd rva word_4079B8
		dd rva word_407A84
		dd rva word_407A74
		dd rva word_407A68
		dd rva word_407A5C
		dd rva word_407A50
		dd rva word_407A48
		dd rva word_407A3C
		dd rva word_407A2E
		dd rva word_407A16
		dd rva word_407A00
		dd rva word_4079EE
		dd rva word_4079E0
		dd rva word_4079CA
		dd rva word_407872
		dd rva word_4078BE
		dd rva word_407864
		dd 0
word_4077F0	dw 335h			; DATA XREF: .rdata:0040770Co
		db 'lstrlenA',0
		align 4
word_4077FC	dw 32Fh			; DATA XREF: .rdata:004076A0o
		db 'lstrcpyA',0
		align 4
word_407808	dw 326h			; DATA XREF: .rdata:004076A4o
		db 'lstrcatA',0
		align 4
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:004075ACo
		align 2
word_407822	dw 218h			; DATA XREF: .rdata:off_407754o
		db 'SendMessageA',0
		align 2
word_407832	dw 0F3h			; DATA XREF: .rdata:00407760o
		db 'GetClientRect',0
word_407842	dw 149h			; DATA XREF: .rdata:00407764o
		db 'GetSystemMetrics',0
		align 2
word_407856	dw 1CEh			; DATA XREF: .rdata:00407768o
		db 'MoveWindow',0
		align 4
word_407864	dw 26Fh			; DATA XREF: .rdata:004077E8o
		db 'ShowWindow',0
		align 2
word_407872	dw 5Ah			; DATA XREF: .rdata:004077E0o
		db 'CreateWindowExA',0
word_407884	dw 7Fh			; DATA XREF: .rdata:0040776Co
		db 'DdeUninitialize',0
word_407896	dw 97h			; DATA XREF: .rdata:00407770o
		db 'DispatchMessageA',0
		align 2
word_4078AA	dw 287h			; DATA XREF: .rdata:0040775Co
		db 'TranslateMessage',0
		align 2
word_4078BE	dw 18Ch			; DATA XREF: .rdata:004077E4o
		db 'IsDialogMessageA',0
		align 2
word_4078D2	dw 12Dh			; DATA XREF: .rdata:00407758o
		db 'GetMessageA',0
word_4078E0	dw 75h			; DATA XREF: .rdata:00407774o
		db 'DdeNameService',0
		align 2
word_4078F2	dw 67h			; DATA XREF: .rdata:00407778o
		db 'DdeCreateStringHandleA',0
		align 4
word_40790C	dw 90h			; DATA XREF: .rdata:0040777Co
		db 'DestroyWindow',0
word_40791C	dw 1C3h			; DATA XREF: .rdata:00407780o
		db 'MessageBoxA',0
word_40792A	dw 72h			; DATA XREF: .rdata:00407784o
		db 'DdeInitializeA',0
		align 4
word_40793C	dw 296h			; DATA XREF: .rdata:00407788o
		db 'UpdateWindow',0
		align 4
word_40794C	dw 1F6h			; DATA XREF: .rdata:0040778Co
		db 'RegisterClassA',0
		align 2
word_40795E	dw 19Eh			; DATA XREF: .rdata:00407790o
		db 'LoadCursorA',0
word_40796C	dw 1A2h			; DATA XREF: .rdata:00407794o
		db 'LoadIconA',0
word_407978	dw 79h			; DATA XREF: .rdata:00407798o
		db 'DdeQueryStringA',0
word_40798A	dw 6Eh			; DATA XREF: .rdata:0040779Co
		db 'DdeGetData',0
		align 4
word_407998	dw 160h			; DATA XREF: .rdata:004077A0o
		db 'GetWindowRect',0
word_4079A8	dw 260h			; DATA XREF: .rdata:004077A4o
		db 'SetWindowPos',0
		align 4
word_4079B8	dw 1E5h			; DATA XREF: .rdata:004077A8o
		db 'PostQuitMessage',0
word_4079CA	dw 6Dh			; DATA XREF: .rdata:004077DCo
		db 'DdeFreeStringHandle',0
word_4079E0	dw 146h			; DATA XREF: .rdata:004077D8o
		db 'GetSysColor',0
word_4079EE	dw 86h			; DATA XREF: .rdata:004077D4o
		db 'DefWindowProcA',0
		align 10h
word_407A00	dw 234h			; DATA XREF: .rdata:004077D0o
		db 'SetForegroundWindow',0
word_407A16	dw 276h			; DATA XREF: .rdata:004077CCo
		db 'SystemParametersInfoA',0
word_407A2E	dw 19Ch			; DATA XREF: .rdata:004077C8o
		db 'LoadBitmapA',0
word_407A3C	dw 207h			; DATA XREF: .rdata:004077C4o
		db 'ReleaseDC',0
word_407A48	dw 100h			; DATA XREF: .rdata:004077C0o
		db 'GetDC',0
word_407A50	dw 0D6h			; DATA XREF: .rdata:004077BCo
		db 'FillRect',0
		align 4
word_407A5C	dw 45h			; DATA XREF: .rdata:004077B8o
		db 'CopyRect',0
		align 4
word_407A68	dw 138h			; DATA XREF: .rdata:004077B4o
		db 'GetParent',0
word_407A74	dw 0A8h			; DATA XREF: .rdata:004077B0o
		db 'DrawFocusRect',0
word_407A84	dw 105h			; DATA XREF: .rdata:004077ACo
		db 'GetDlgItem',0
		align 2
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:004075C0o
		align 2
word_407A9E	dw 4Eh			; DATA XREF: .rdata:00407678o
		db 'CreateSolidBrush',0
		align 2
word_407AB2	dw 1FAh			; DATA XREF: .rdata:00407694o
		db 'SetTextColor',0
		align 2
word_407AC2	dw 1D4h			; DATA XREF: .rdata:00407690o
		db 'SetBkColor',0
		align 10h
word_407AD0	dw 38h			; DATA XREF: .rdata:0040768Co
		db 'CreateFontIndirectA',0
word_407AE6	dw 54h			; DATA XREF: .rdata:00407688o
		db 'DeleteObject',0
		align 2
word_407AF6	dw 12Dh			; DATA XREF: .rdata:00407684o
		db 'GetDeviceCaps',0
word_407B06	dw 45h			; DATA XREF: .rdata:00407680o
		db 'CreatePen',0
word_407B12	dw 3Eh			; DATA XREF: .rdata:0040767Co
		db 'CreateHatchBrush',0
		align 2
word_407B26	dw 18Dh			; DATA XREF: .rdata:00407660o
		db 'LineTo',0
		align 10h
word_407B30	dw 191h			; DATA XREF: .rdata:00407674o
		db 'MoveToEx',0
		align 4
word_407B3C	dw 1B6h			; DATA XREF: .rdata:00407670o
		db 'Rectangle',0
word_407B48	dw 1CEh			; DATA XREF: .rdata:0040766Co
		db 'SelectObject',0
		align 4
word_407B58	dw 0A2h			; DATA XREF: .rdata:00407668o
		db 'ExtTextOutA',0
word_407B66	dw 178h			; DATA XREF: .rdata:00407664o
		db 'GetTextExtentPointA',0
word_407B7C	dw 17Eh			; DATA XREF: .rdata:off_40765Co
		db 'GetTextMetricsA',0
aGdi32_dll	db 'GDI32.dll',0        ; DATA XREF: .rdata:004075D4o
word_407B98	dw 1B2h			; DATA XREF: .rdata:00407638o
		db 'RegSetValueExA',0
		align 2
word_407BAA	dw 184h			; DATA XREF: .rdata:off_40762Co
		db 'RegCloseKey',0
word_407BB8	dw 19Dh			; DATA XREF: .rdata:00407630o
		db 'RegOpenKeyExA',0
word_407BC8	dw 1A7h			; DATA XREF: .rdata:0040763Co
		db 'RegQueryValueExA',0
		align 4
word_407BDC	dw 188h			; DATA XREF: .rdata:00407634o
		db 'RegCreateKeyExA',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:004075E8o
		align 4
word_407BFC	dw 1Fh			; DATA XREF: .rdata:00407650o
		db 'ImageList_AddMasked',0
word_407C12	dw 22h			; DATA XREF: .rdata:off_407644o
		db 'ImageList_Create',0
		align 2
word_407C26	dw 23h			; DATA XREF: .rdata:00407648o
		db 'ImageList_Destroy',0
word_407C3A	dw 28h			; DATA XREF: .rdata:0040764Co
		db 'ImageList_Draw',0
		align 4
aComctl32_dll	db 'COMCTL32.dll',0     ; DATA XREF: .rdata:004075FCo
		align 2
word_407C5A	dw 25h			; DATA XREF: .rdata:off_40773Co
		db 'UninitPGPsc',0
word_407C68	dw 19h			; DATA XREF: .rdata:00407740o
		db 'InitPGPsc',0
word_407C74	dw 27h			; DATA XREF: .rdata:00407744o
		db 'WindowExists',0
		align 4
word_407C84	dw 15h			; DATA XREF: .rdata:00407748o
		db 'GetMarginalInvalidPref',0
		align 2
word_407C9E	dw 17h			; DATA XREF: .rdata:0040774Co
		db 'GetValidityDrawPrefs',0
		align 2
aPgpsc_dll	db 'PGPsc.dll',0        ; DATA XREF: .rdata:00407610o
word_407CC0	dw 1BAh			; DATA XREF: .rdata:00407734o
		db 'HeapFree',0
		align 4
word_407CCC	dw 1B4h			; DATA XREF: .rdata:00407730o
		db 'HeapAlloc',0
word_407CD8	dw 13Ah			; DATA XREF: .rdata:0040772Co
		db 'GetModuleHandleA',0
		align 4
word_407CEC	dw 166h			; DATA XREF: .rdata:00407714o
		db 'GetStartupInfoA',0
word_407CFE	dw 0DAh			; DATA XREF: .rdata:0040771Co
		db 'GetCommandLineA',0
word_407D10	dw 18Eh			; DATA XREF: .rdata:00407718o
		db 'GetVersion',0
		align 2
word_407D1E	dw 8Ch			; DATA XREF: .rdata:00407728o
		db 'ExitProcess',0
word_407D2C	dw 153h			; DATA XREF: .rdata:00407710o
		db 'GetProcAddress',0
		align 2
word_407D3E	dw 1B8h			; DATA XREF: .rdata:00407708o
		db 'HeapDestroy',0
word_407D4C	dw 1B6h			; DATA XREF: .rdata:00407704o
		db 'HeapCreate',0
		align 2
word_407D5A	dw 2F1h			; DATA XREF: .rdata:00407700o
		db 'VirtualFree',0
word_407D68	dw 2EEh			; DATA XREF: .rdata:004076FCo
		db 'VirtualAlloc',0
		align 4
word_407D78	dw 1BDh			; DATA XREF: .rdata:004076F8o
		db 'HeapReAlloc',0
word_407D86	dw 2CBh			; DATA XREF: .rdata:004076F4o
		db 'TerminateProcess',0
		align 2
word_407D9A	dw 109h			; DATA XREF: .rdata:004076F0o
		db 'GetCurrentProcess',0
word_407DAE	dw 2DBh			; DATA XREF: .rdata:004076ECo
		db 'UnhandledExceptionFilter',0
		align 2
word_407DCA	dw 138h			; DATA XREF: .rdata:004076E8o
		db 'GetModuleFileNameA',0
		align 10h
word_407DE0	dw 0C1h			; DATA XREF: .rdata:004076E4o
		db 'FreeEnvironmentStringsA',0
word_407DFA	dw 0C2h			; DATA XREF: .rdata:004076E0o
		db 'FreeEnvironmentStringsW',0
word_407E14	dw 301h			; DATA XREF: .rdata:004076DCo
		db 'WideCharToMultiByte',0
word_407E2A	dw 119h			; DATA XREF: .rdata:004076D8o
		db 'GetEnvironmentStrings',0
word_407E42	dw 11Bh			; DATA XREF: .rdata:004076D4o
		db 'GetEnvironmentStringsW',0
		align 4
word_407E5C	dw 298h			; DATA XREF: .rdata:004076D0o
		db 'SetHandleCount',0
		align 2
word_407E6E	dw 168h			; DATA XREF: .rdata:004076CCo
		db 'GetStdHandle',0
		align 2
word_407E7E	dw 128h			; DATA XREF: .rdata:004076C8o
		db 'GetFileType',0
word_407E8C	dw 257h			; DATA XREF: .rdata:004076C4o
		db 'RtlUnwind',0
word_407E98	dw 30Eh			; DATA XREF: .rdata:004076C0o
		db 'WriteFile',0
word_407EA4	dw 0CFh			; DATA XREF: .rdata:004076BCo
		db 'GetCPInfo',0
word_407EB0	dw 0C9h			; DATA XREF: .rdata:004076B8o
		db 'GetACP',0
		align 2
word_407EBA	dw 146h			; DATA XREF: .rdata:004076B4o
		db 'GetOEMCP',0
		align 2
word_407EC6	dw 1DFh			; DATA XREF: .rdata:004076B0o
		db 'LoadLibraryA',0
		align 2
word_407ED6	dw 202h			; DATA XREF: .rdata:004076ACo
		db 'MultiByteToWideChar',0
word_407EEC	dw 169h			; DATA XREF: .rdata:004076A8o
		db 'GetStringTypeA',0
		align 2
word_407EFE	dw 16Ch			; DATA XREF: .rdata:00407720o
		db 'GetStringTypeW',0
		align 10h
word_407F10	dw 1DCh			; DATA XREF: .rdata:off_40769Co
		db 'LCMapStringA',0
		align 10h
word_407F20	dw 1DDh			; DATA XREF: .rdata:00407724o
		db 'LCMapStringW',0
		align 100h
_rdata		ends

; Section 3. (virtual address 00008000)
; Virtual size			: 00000F14 (   3860.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00008000
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 408000h
dword_408000	dd 0			; DATA XREF: __cinit+1Fo
dword_408004	dd 0			; DATA XREF: __cinit+1Ao
dword_408008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initmbctable
dword_408010	dd 0			; DATA XREF: __cinit:loc_403742o
dword_408014	dd 0			; DATA XREF: _doexit+65o
dword_408018	dd 0			; DATA XREF: _doexit:loc_4037E6o
dword_40801C	dd 0			; DATA XREF: _doexit+76o
dword_408020	dd 4 dup(0)		; DATA XREF: _doexit:loc_4037F7o
; CHAR ClassName[]
ClassName	db 'SysListView32',0    ; DATA XREF: sub_401110+45o
		align 10h
dword_408040	dd 3E4CCCCDh, 3E99999Ah, 3DCCCCCDh, 3EC7AE14h ;	DATA XREF: sub_401A60+71o
off_408050	dd offset aName		; DATA XREF: sub_401A60+76o
					; "Name"
		dd offset aSigner	; "Signer"
		dd offset aValidity	; "Validity"
		dd offset aSigned	; "Signed"
aSigned		db 'Signed',0           ; DATA XREF: .data:0040805Co
		align 4
aValidity	db 'Validity',0         ; DATA XREF: .data:00408058o
		align 4
aSigner		db 'Signer',0           ; DATA XREF: .data:00408054o
		align 4
aName		db 'Name',0             ; DATA XREF: .data:off_408050o
		align 4
; CHAR aOperation_resu[]
aOperation_resu	db 'Operation_Results',0 ; DATA XREF: WinMain(x,x,x,x)+14Ao
					; pfnCallback+308o
		align 4
; CHAR Text[]
Text		db 'Could not initialize PGPlog',27h,'s DDEML server!',0
					; DATA XREF: WinMain(x,x,x,x)+113o
; CHAR psz[]
psz		db 'PGPlog',0           ; DATA XREF: WinMain(x,x,x,x)+5o
					; WinMain(x,x,x,x)+Ao ...
		align 4
aValidKey	db 'Valid Key',0        ; DATA XREF: pfnCallback:loc_401667o
		align 4
aMarginalKey	db 'Marginal Key',0     ; DATA XREF: pfnCallback:loc_401628o
		align 4
aInvalidKey	db 'Invalid Key',0      ; DATA XREF: pfnCallback+176o
aGoodSignature	db 'Good Signature',0   ; DATA XREF: pfnCallback+EEo
		align 4
; char aSignature[]
aSignature	db 'Signature',0        ; DATA XREF: pfnCallback:loc_401548o
		align 10h
; char asc_408110[]
asc_408110	db 0Ah,0		; DATA XREF: pfnCallback+A2o
					; pfnCallback:loc_4015A5o
		align 4
; CHAR aYsize[]
aYsize		db 'ySize',0            ; DATA XREF: sub_401800+84o
					; sub_4018F0+60o
		align 4
; CHAR aXsize[]
aXsize		db 'xSize',0            ; DATA XREF: sub_401800+6Ao
					; sub_4018F0+51o
		align 4
; CHAR aYpos[]
aYpos		db 'yPos',0             ; DATA XREF: sub_401800+50o
					; sub_4018F0+3Eo
		align 4
; CHAR ValueName[]
ValueName	db 'xPos',0             ; DATA XREF: sub_401800+3Co
					; sub_4018F0+2Fo
		align 4
; CHAR SubKey[]
SubKey		db 'Software\Network Associates\PGP\PGPlog',0 ; DATA XREF: sub_401800+1Fo
					; sub_4018F0+13o ...
		align 4
; char dword_40815C[]
dword_40815C	dd 2E2E2Eh		; DATA XREF: sub_402440+7r
					; __NMSG_WRITE+BFo
		dd 9875h, 9873h
off_408168	dd offset __fpmath	; DATA XREF: __cinitr
		dd offset nullsub_1
		dd offset nullsub_1
		align 10h
off_408180	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_408184	dd 2			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r
off_408188	dd offset __fptrap	; DATA XREF: __cfltcvt_init+Fw
off_40818C	dd offset __fptrap	; DATA XREF: __cfltcvt_init+5w
off_408190	dd offset __fptrap	; DATA XREF: __cfltcvt_init+14w
off_408194	dd offset __fptrap	; DATA XREF: __cfltcvt_init+1Ew
off_408198	dd offset __fptrap	; DATA XREF: __cfltcvt_init+28w
off_40819C	dd offset __fptrap	; DATA XREF: __cfltcvt_init+32w
		dd 10h
dword_4081A4	dd 3F8h			; DATA XREF: __heap_alloc+5r
		align 10h
dword_4081B0	dd 0C0000005h		; DATA XREF: _xcptlookup+Ar
					; _xcptlookup+11o
		dd 0Bh,	0
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_408228	dd 3			; DATA XREF: __XcptFilter+58r
dword_40822C	dd 7			; DATA XREF: __XcptFilter+5Er
dword_408230	dd 0Ah			; DATA XREF: _xcptlookup+4r
dword_408234	dd 8Ch			; DATA XREF: __XcptFilter+82r
					; __XcptFilter+8Fw ...
		dd 0FFFFFFFFh, 0A00h
dword_408240	dd 19930520h, 3	dup(0)	; DATA XREF: .text:004040C7o
					; __NLG_Notify+2o
dword_408250	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r
off_408254	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do
					; "R6002\r\n- floating point not loaded\r\"...
		dd 8, 407460h, 9, 407434h, 0Ah,	407410h, 10h, 4073E4h
		dd 11h,	4073B4h, 12h, 407390h, 13h, 407364h, 18h, 40732Ch
		dd 19h,	407304h, 1Ah, 4072CCh, 1Bh, 407294h, 1Ch, 40726Ch
		dd 78h,	40725Ch, 79h, 40724Ch, 7Ah, 40723Ch, 0FCh, 407238h
		dd 0FFh, 407228h
dword_4082E0	dd 1			; DATA XREF: __forcdecpt+15r
					; __NMSG_WRITE+1Bo ...
byte_4082E4	db 2Eh			; DATA XREF: __forcdecpt:loc_4029CCr
					; .text:004029EAr ...
		align 4
		dd 1
off_4082EC	dd offset __ctype+2	; DATA XREF: __forcdecpt+30r
					; __isctype+12r ...
		dd offset __ctype+2
		public __ctype
; unsigned __int16 _ctype[]
__ctype		dd    200000h		; DATA XREF: _x_ismbbtype+18r
					; .data:off_4082ECo ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 40h dup(0)
dword_4084F8	dd 400h, 0FFFFFC01h, 35h, 0Bh, 40h, 3FFh ; DATA	XREF: sub_404960o
dword_408510	dd 80h,	0FFFFFF81h, 18h, 8, 20h, 7Fh, 2	dup(0) ; DATA XREF: sub_404976o
byte_408530	db 1			; DATA XREF: __setmbcp+E1r
		db 2, 4, 8
		align 8
dword_408538	dd 3A4h			; DATA XREF: __setmbcp+2Fo
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+11Do
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+C0o
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_408628	dd 2 dup(0)		; DATA XREF: __setmbcp+3Co
dword_408630	dd 2 dup(0)		; DATA XREF: ___multtenpow12+7o
		dd 4002A000h, 2	dup(0)
		dd 4005C800h, 2	dup(0)
		dd 4008FA00h, 2	dup(0)
		dd 400C9C40h, 2	dup(0)
		dd 400FC350h, 2	dup(0)
		dd 4012F424h, 0
		dd 80000000h, 40169896h, 0
		dd 20000000h, 4019BEBCh, 0
		dd 0C9BF0400h, 40348E1Bh, 0A1000000h, 1BCECCEDh, 404ED3C2h
		dd 0B59EF020h, 0ADA82B70h, 40699DC5h, 25FD5DD0h, 4F8E1AE5h
		dd 4083EB19h, 95D79671h, 8D050E43h, 409EAF29h, 44A0BFF9h
		dd 8F1281EDh, 40B98281h, 0A6D53CBFh, 1F49FFCFh,	40D3C278h
		dd 8CE0C66Fh, 47C980E9h, 41A893BAh, 556B85BCh, 0F78D3927h
		dd 427CE070h, 0DE8EDDBCh, 0EBFB9DF9h, 4351AA7Eh, 0E376E6A1h
		dd 2F29F2CCh, 44268184h, 0AA171028h, 0E310AEF8h, 44FAC4C5h
		dd 0F3D4A7EBh, 4AE1EBF7h, 45CF957Ah, 91C7CC65h,	0A0AEA60Eh
		dd 46A3E319h, 0C17650Dh, 75868175h, 4D48C976h, 0A7E44258h
		dd 353B3993h, 53EDB2B8h, 5DE5A74Dh, 3B5DC53Dh, 5A929E8Bh
		dd 0F0A65DFFh, 54C020A1h, 61378CA5h, 5A8BFDD1h,	5D25D88Bh
		dd 67DBF989h, 0F3F895AAh, 0C8A2BF27h, 6E80DD5Dh, 979BC94Ch
		dd 52028A20h, 7525C460h, 0
dword_408790	dd 0CCCDCCCDh, 0CCCCCCCCh, 3FFBCCCCh, 0D70A3D71h, 0A3D70A3h
					; DATA XREF: ___multtenpow12+1Bo
		dd 3FF8A3D7h, 0DF3B645Ah, 6E978D4Fh, 3FF58312h,	652CD3C3h
		dd 1758E219h, 3FF1D1B7h, 84230FD0h, 0AC471B47h,	3FEEA7C5h
		dd 69B6A640h, 0BD05AF6Ch, 3FEB8637h, 42BC3D33h,	94D5E57Ah
		dd 3FE7D6BFh, 0CEFDFDC2h, 77118461h, 3FE4ABCCh,	0E15B4C2Fh
		dd 94BEC44Dh, 3FC9E695h, 3B53C492h, 14CD4475h, 3FAF9ABEh
		dd 94BA67DEh, 1EAD4539h, 3F94CFB1h, 0E2C62324h,	313BBABCh
		dd 3F7A8B61h, 0C1595561h, 7C53B17Eh, 3F5FBB12h,	8D2FEED7h
		dd 8592BE06h, 3F44FB15h, 0E9A53F24h, 0EA27A539h, 3F2AA87Fh
		dd 0E4A1AC7Dh, 467C64BCh, 3E55DDD0h, 0CC067B63h, 83775423h
		dd 3D8191FFh, 193AFA91h, 4325637Ah, 3CACC031h, 38D18921h
		dd 0B8974782h, 3BD7FD00h, 85888DCh, 0E3E8B11Bh,	3B03A686h
		dd 424584C6h, 7599B607h, 3A2EDB37h, 0D21C7133h,	0EE32DB23h
		dd 395A9049h, 0C0BE87A6h, 82A5DA57h, 32B5A2A6h,	11B268E2h
		dd 449F52A7h, 2C10B759h, 2DE44925h, 534F3436h, 256BCEAEh
		dd 0A404598Fh, 7DC2DEC0h, 1EC6E8FBh, 5A88E79Eh,	0BF3C9157h
		dd 18228350h, 62654B4Eh, 0AF8F83FDh, 117D9406h,	9FDE2DE4h
		dd 4C8D2CEh, 0AD8A6DDh,	0
; CHAR WindowName[8]
WindowName	db 8 dup(0)		; DATA XREF: sub_401110+3Eo
					; sub_4011E0+9o
dword_4088F8	dd 0			; DATA XREF: __fpmath+Aw
; char *dword_4088FC
dword_4088FC	dd 0			; DATA XREF: start+84w
					; __setenvp:loc_403A27r ...
		dd 0
dword_408904	dd 0			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
dword_408908	dd 0			; DATA XREF: __cftoe+11r __cftof+1Ar ...
byte_40890C	db 0			; DATA XREF: __cftoe+3r __cftoe+98r ...
		align 10h
dword_408910	dd 0			; DATA XREF: __cftof+11r __cftog+21w ...
byte_408914	db 0			; DATA XREF: __cftog+51w
		align 4
dword_408918	dd 0			; DATA XREF: _mallocr
dword_40891C	dd 0			; DATA XREF: __callnewhr
		dd 3 dup(0)
dword_40892C	dd 0			; DATA XREF: start+52w
dword_408930	dd 0			; DATA XREF: start+49w
dword_408934	dd 0			; DATA XREF: start+3Ew
dword_408938	dd 0			; DATA XREF: start+30w
dword_40893C	dd 0			; DATA XREF: __setargv+91w
dword_408940	dd 0			; DATA XREF: __setargv+89w
		align 8
dword_408948	dd 0			; DATA XREF: __setenvp+44w
		dd 3 dup(0)
dword_408958	dd 0			; DATA XREF: __setargv+2Ew
		align 10h
byte_408960	db 0			; DATA XREF: _doexit+2Dw
		align 4
dword_408964	dd 0			; DATA XREF: _doexit+27w
dword_408968	dd 0			; DATA XREF: _doexit+4r _doexit+8Bw
dword_40896C	dd 0			; DATA XREF: __XcptFilter+3Ar
					; __XcptFilter+46w ...
; CHAR Filename[260]
Filename	db 104h	dup(0)		; DATA XREF: __setargv:loc_403AE5o
dword_408A74	dd 0			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_408A78	dd 0			; DATA XREF: __FF_MSGBANNER+21r
		align 10h
word_408A80	dw 0			; DATA XREF: __fltout+1Ao __fltout+46r
byte_408A82	db 0			; DATA XREF: __fltout+39r
		align 4
dword_408A84	dd 7 dup(0)		; DATA XREF: __fltout+52o
dword_408AA0	dd 0			; DATA XREF: __fltout+40w __fltout+5Co
dword_408AA4	dd 0			; DATA XREF: __fltout+4Dw
dword_408AA8	dd 0			; DATA XREF: __fltout+31w
dword_408AAC	dd 0			; DATA XREF: __fltout+52w
dword_408AB0	dd 0			; DATA XREF: __setmbcp:loc_405261r
					; _getSystemCP+4w ...
dword_408AB4	dd 0			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_408AB8	dd 0			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_405854r
dword_408ABC	dd 0			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
dword_408AC0	dd 0			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_4059F8w
dword_408AC4	dd 0			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
		align 10h
; LCID dword_408AD0
dword_408AD0	dd 0			; DATA XREF: _tolower+4r _tolower+9Dr	...
		align 10h
dword_408AE0	dd 0			; DATA XREF: _getSystemCP+3Ar
					; ___crtGetStringTypeA+A6r ...
		align 8
; HSZ dword_408AE8
dword_408AE8	dd 0			; DATA XREF: WinMain(x,x,x,x)+160w
					; sub_401A00+28r
; HSZ hsz
hsz		dd 0			; DATA XREF: WinMain(x,x,x,x)+150w
					; WinMain(x,x,x,x)+165r ...
; void *dword_408AF0
dword_408AF0	dd 0			; DATA XREF: WinMain(x,x,x,x)+55w
					; WinMain(x,x,x,x)+1CCr ...
; DWORD	idInst
idInst		dd 0			; DATA XREF: WinMain(x,x,x,x)+FEo
					; WinMain(x,x,x,x):loc_401350r	...
; HINSTANCE hInstance
hInstance	dd 0			; DATA XREF: sub_401110+1Dr
					; WinMain(x,x,x,x)+5Bw	...
		align 10h
dword_408B00	dd 11h dup(0)		; DATA XREF: sub_401A00+3Bo
					; sub_401A60+4Fo ...
dword_408B44	dd 0			; DATA XREF: sub_401A60+54w
		align 20h
dword_408B60	dd 0			; DATA XREF: sub_401A60+7Bo
					; sub_401A60+9Fo ...
; HWND hWnd
hWnd		dd 0			; DATA XREF: pfnCallback+253r
					; pfnCallback+25Fr
		dd 9 dup(0)
dword_408B8C	dd 0			; DATA XREF: WinMain(x,x,x,x)+2Fo
					; WinMain(x,x,x,x)+22Er ...
dword_408B90	dd 0			; DATA XREF: WinMain(x,x,x,x):loc_401248o
					; WinMain(x,x,x,x):loc_401448r
; UINT CodePage
CodePage	dd 0			; DATA XREF: __setmbcp+14r
					; __setmbcp+65w ...
		align 10h
dword_408BA0	dd 3 dup(0)		; DATA XREF: __setmbcp+123o
					; __setmbcp+171o ...
dword_408BAC	dd 0			; DATA XREF: __setmbcp+108w
					; __setmbcp+15Dw ...
		align 20h
byte_408BC0	db 0			; DATA XREF: _setSBUpLow:loc_405431w
					; _setSBUpLow:loc_40544Ew ...
		align 4
		dd 3Fh dup(0)
byte_408CC0	db 0			; DATA XREF: __setmbcp+5Co
					; __setmbcp+AFo ...
byte_408CC1	db 0			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(0)
; LCID Locale
Locale		dd 0			; DATA XREF: __setmbcp+6Ew
					; __setmbcp+12Bw ...
		align 20h
dword_408DE0	dd 0			; DATA XREF: __ioinit:loc_403E6Dw
					; __ioinit+45r	...
dword_408DE4	dd 3Fh dup(0)		; DATA XREF: __ioinit+92o
; UINT uNumber
uNumber		dd 0			; DATA XREF: __ioinit+26w
					; __ioinit:loc_403ED7r	...
dword_408EE4	dd 0			; DATA XREF: __setenvp+ADw
dword_408EE8	dd 0			; DATA XREF: __wincmdlnr __setenvp+3r	...
dword_408EEC	dd 0			; DATA XREF: _doexit+3Er
dword_408EF0	dd 0			; DATA XREF: _doexit+35r _doexit+57r
dword_408EF4	dd 0			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_408EF8	dd 0			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_408EFC	dd 0			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *dword_408F00
dword_408F00	dd 0			; DATA XREF: ___sbh_heap_init:loc_402E20w
					; ___sbh_free_block+22Cr ...
dword_408F04	dd 0			; DATA XREF: ___sbh_heap_init+24w
					; ___sbh_find_blockr ...
; LPVOID lpMem
lpMem		dd 0			; DATA XREF: ___sbh_heap_init+15w
					; ___sbh_find_block+8r	...
; HANDLE hHeap
hHeap		dd 0			; DATA XREF: _free+21r
					; __heap_alloc+28r ...
dword_408F10	dd 0			; DATA XREF: start+7Aw	__wincmdln+Fr ...
		align 100h
_data		ends


		end start
