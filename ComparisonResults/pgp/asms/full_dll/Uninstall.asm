;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	F92D2B050DAA3BF33630503D3610747A
; Input	CRC32 :	591CC64E

; File Name   :	C:\compspace\compare\pgp\dlls\full\Uninstall.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00007F02 (  32514.)
; Section size in file		: 00008000 (  32768.)
; Offset to raw	data for section: 00001000
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_401000	proc near		; CODE XREF: sub_401EC0+6p
					; sub_401EC0+1Bp

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	eax, [ebx+30h]
		test	eax, eax
		jz	short loc_401013
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_401013:				; CODE XREF: sub_401000+Bj
		cmp	dword ptr [ebx+14h], 200h
		jz	short loc_401027
		mov	eax, [ebx+10h]
		test	eax, eax
		jnz	loc_4010AD

loc_401027:				; CODE XREF: sub_401000+1Aj
		mov	ecx, [ebx+10h]
		xor	edx, edx
		mov	eax, ecx
		mov	esi, 0Ah
		div	esi
		test	edx, edx
		jnz	short loc_40106E
		lea	eax, [ecx+ecx*4]
		push	edx		; int
		lea	eax, [eax+eax*4]
		shl	eax, 0Bh
		div	dword ptr [ebx+18h]
		push	eax		; wParam
		mov	eax, [ebx+264h]
		push	eax		; int
		call	sub_401B80
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_401061
		mov	dword ptr [ebx+30h], 1

loc_401061:				; CODE XREF: sub_401000+58j
		mov	eax, [ebx+30h]
		test	eax, eax
		jz	short loc_40106E
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40106E:				; CODE XREF: sub_401000+37j
					; sub_401000+66j
		push	edi
		mov	edi, [ebx+28h]
		mov	ecx, 80h
		xor	eax, eax
		rep stosd
		mov	ecx, [ebx]
		mov	edx, [ebx+28h]
		push	ecx		; FILE *
		push	200h		; size_t
		push	1		; size_t
		push	edx		; void *
		call	sub_402570
		mov	esi, [ebx+28h]
		mov	edi, [ebx+24h]
		mov	ecx, 80h
		add	esp, 10h
		rep movsd
		mov	eax, [ebx+10h]
		mov	dword ptr [ebx+14h], 0
		inc	eax
		pop	edi
		mov	[ebx+10h], eax

loc_4010AD:				; CODE XREF: sub_401000+21j
		mov	ecx, [ebx+10h]
		mov	eax, [ebx+14h]
		mov	edx, [ebx+18h]
		add	ecx, 7FFFFFh
		shl	ecx, 9
		add	ecx, eax
		cmp	ecx, edx
		jnz	short loc_4010CB
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4010CB:				; CODE XREF: sub_401000+C3j
		mov	edx, [ebx+24h]
		xor	ecx, ecx
		pop	esi
		mov	cl, [edx+eax]
		inc	eax
		mov	[ebx+14h], eax
		mov	eax, ecx
		pop	ebx
		retn
sub_401000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4010E0	proc near		; CODE XREF: sub_401EC0+15p

Caption		= byte ptr -26Ch
Buffer		= byte ptr -168h
var_104		= byte ptr -104h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 26Ch
		push	ebx
		mov	ebx, [esp+270h+arg_4]
		push	ebp
		xor	ebp, ebp
		mov	eax, [ebx+30h]
		push	esi
		cmp	eax, ebp
		push	edi
		jnz	loc_401458
		cmp	[ebx+40h], ebp
		jz	loc_401415
		mov	eax, [ebx+154h]
		cmp	eax, 4
		jnb	short loc_40113D
		mov	cl, byte ptr [esp+27Ch+arg_0]
		pop	edi
		mov	[eax+ebx+14Ch],	cl
		mov	eax, [ebx+154h]
		inc	eax
		pop	esi
		mov	[ebx+154h], eax
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 26Ch
		retn
; ---------------------------------------------------------------------------

loc_40113D:				; CODE XREF: sub_4010E0+30j
		mov	ecx, [esp+27Ch+arg_0]
		mov	[eax+ebx+40h], cl
		mov	edx, [ebx+154h]
		inc	edx
		cmp	ecx, ebp
		mov	[ebx+154h], edx
		jnz	loc_401458
		mov	eax, [ebx+14Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_4011FE
		or	ecx, eax
		lea	edi, [ebx+158h]
		xor	eax, eax
		lea	edx, [esp+27Ch+Caption]
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+27Ch+Caption]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		rep movsb
		lea	edi, [ebx+44h]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	eax, [esp+27Ch+Caption]
		and	ecx, 3
		push	eax		; char *
		rep movsb
		call	__mkdir
		lea	ecx, [esp+280h+Caption]
		lea	esi, [ebx+260h]
		push	ebp
		push	ecx
		push	esi
		call	sub_401BD0
		mov	edx, [esi]
		add	esp, 10h
		mov	eax, 1
		mov	[edx+104h], eax
		pop	edi
		mov	[ebx+154h], ebp
		pop	esi
		mov	[ebx+40h], eax
		pop	ebp
		pop	ebx
		add	esp, 26Ch
		retn
; ---------------------------------------------------------------------------

loc_4011FE:				; CODE XREF: sub_4010E0+86j
		cmp	eax, ebp
		lea	edi, [ebx+158h]
		jnz	loc_401305
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		lea	edx, [esp+27Ch+var_104]
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+27Ch+var_104]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		push	offset aWb	; "wb"
		rep movsb
		lea	edi, [ebx+44h]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	edx, [esp+280h+Caption]
		and	ecx, 3
		rep movsb
		lea	edi, [esp+280h+var_104]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		lea	ecx, [esp+280h+Caption]
		push	ecx		; char *
		call	_fopen
		add	esp, 8
		cmp	eax, ebp
		mov	[ebx+4], eax
		jnz	short loc_4012C7
		mov	eax, hInstance
		lea	edx, [esp+27Ch+Buffer]
		push	64h		; cchBufferMax
		push	edx		; lpBuffer
		push	13D7h		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		push	10010h
		lea	ecx, [esp+280h+Caption]
		jmp	loc_4013BE
; ---------------------------------------------------------------------------

loc_4012C7:				; CODE XREF: sub_4010E0+1BCj
		lea	ecx, [esp+27Ch+Caption]
		push	ebp
		lea	edx, [ebx+260h]
		push	ecx
		push	edx
		call	sub_401BD0
		mov	eax, [ebx+4]
		push	eax		; FILE *
		call	_fclose
		add	esp, 10h
		mov	[ebx+4], ebp
		mov	[ebx+154h], ebp
		mov	dword ptr [ebx+40h], 1
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 26Ch
		retn
; ---------------------------------------------------------------------------

loc_401305:				; CODE XREF: sub_4010E0+126j
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		lea	edx, [esp+27Ch+var_104]
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+27Ch+var_104]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		push	offset aWb	; "wb"
		rep movsb
		lea	edi, [ebx+44h]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	edx, [esp+280h+Caption]
		and	ecx, 3
		rep movsb
		lea	edi, [esp+280h+var_104]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	[ebx+40h], ebp
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		lea	ecx, [esp+280h+Caption]
		push	ecx		; char *
		call	_fopen
		add	esp, 8
		cmp	eax, ebp
		mov	[ebx+4], eax
		jnz	short loc_4013E4
		mov	eax, hInstance
		lea	edx, [esp+27Ch+Buffer]
		push	64h		; cchBufferMax
		push	edx		; lpBuffer
		push	13D7h		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		push	10010h		; uType
		lea	ecx, [esp+280h+Caption]

loc_4013BE:				; CODE XREF: sub_4010E0+1E2j
		mov	eax, [ebx+2Ch]
		lea	edx, [esp+280h+Buffer]
		push	ecx		; lpCaption
		push	edx		; lpText
		push	eax		; hWnd
		call	ds:MessageBoxA
		mov	eax, 1
		pop	edi
		pop	esi
		mov	[ebx+30h], eax
		pop	ebp
		pop	ebx
		add	esp, 26Ch
		retn
; ---------------------------------------------------------------------------

loc_4013E4:				; CODE XREF: sub_4010E0+2B8j
		lea	ecx, [esp+27Ch+Caption]
		push	ebp
		lea	edx, [ebx+260h]
		push	ecx
		push	edx
		call	sub_401BD0
		add	esp, 0Ch
		mov	[ebx+150h], ebp
		mov	[ebx+154h], ebp
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 26Ch
		retn
; ---------------------------------------------------------------------------

loc_401415:				; CODE XREF: sub_4010E0+21j
		mov	eax, [ebx+4]
		mov	ecx, [esp+27Ch+arg_0]
		push	eax		; FILE *
		push	ecx		; int
		call	_fputc
		mov	edx, [ebx+150h]
		mov	ecx, [ebx+14Ch]
		add	esp, 8
		inc	edx
		mov	eax, edx
		mov	[ebx+150h], edx
		cmp	eax, ecx
		jnz	short loc_401458
		mov	edx, [ebx+4]
		push	edx		; FILE *
		call	_fclose
		add	esp, 4
		mov	[ebx+4], ebp
		mov	dword ptr [ebx+40h], 1

loc_401458:				; CODE XREF: sub_4010E0+18j
					; sub_4010E0+77j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 26Ch
		retn
sub_4010E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401470	proc near		; DATA XREF: sub_401670+25o

hWnd		= dword	ptr -870h
var_86C		= byte ptr -86Ch
var_864		= dword	ptr -864h
var_860		= dword	ptr -860h
var_85C		= dword	ptr -85Ch
var_838		= dword	ptr -838h
var_834		= dword	ptr -834h
var_830		= dword	ptr -830h
var_82C		= dword	ptr -82Ch
var_828		= dword	ptr -828h
var_820		= dword	ptr -820h
var_814		= dword	ptr -814h
var_810		= dword	ptr -810h
var_80C		= dword	ptr -80Ch
var_808		= dword	ptr -808h
var_800		= dword	ptr -800h
var_7FC		= dword	ptr -7FCh
var_7F8		= dword	ptr -7F8h
var_5D4		= dword	ptr -5D4h
Text		= byte ptr -5D0h
Buffer		= byte ptr -56Ch
Filename	= byte ptr -508h
var_400		= byte ptr -400h
var_200		= byte ptr -200h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 870h
		mov	eax, [esp+870h+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [esp+878h+arg_4]
		push	esi
		push	edi
		push	eax
		call	sub_401BC0
		add	esp, 4
		lea	ecx, [esp+880h+Buffer]
		mov	[ebp+108h], eax
		mov	edx, hInstance
		push	64h		; cchBufferMax
		push	ecx		; lpBuffer
		push	13DAh		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		mov	eax, [ebp+108h]
		lea	ecx, [esp+880h+Filename]
		push	104h		; nSize
		push	ecx		; lpFilename
		push	0		; hModule
		mov	[esp+88Ch+hWnd], eax
		call	ds:GetModuleFileNameA
		lea	edx, [esp+880h+Filename]
		push	offset aRb	; "rb"
		push	edx		; char *
		call	_fopen
		mov	ebx, eax
		push	2		; int
		push	0FFFFFFCCh	; __int32
		push	ebx		; FILE *
		call	_fseek
		push	ebx		; FILE *
		push	34h		; size_t
		lea	eax, [esp+89Ch+var_86C]
		push	1		; size_t
		push	eax		; void *
		call	sub_402570
		add	esp, 24h
		mov	ecx, 3
		mov	edi, offset aPgpsea ; "PGPSEA"
		lea	esi, [esp+880h+var_86C]
		xor	edx, edx
		repe cmpsw
		jz	short loc_401563
		mov	ecx, hInstance
		lea	eax, [esp+880h+Text]
		push	64h		; cchBufferMax
		push	eax		; lpBuffer
		push	13DCh		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		mov	ecx, [esp+880h+hWnd]
		lea	edx, [esp+880h+Buffer]
		push	10010h		; uType
		lea	eax, [esp+884h+Text]
		push	edx		; lpCaption
		push	eax		; lpText
		push	ecx		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFD12Dh
		pop	ebx
		add	esp, 870h
		retn
; ---------------------------------------------------------------------------

loc_401563:				; CODE XREF: sub_401470+A5j
		mov	edx, [esp+880h+var_864]
		xor	esi, esi
		push	esi		; int
		push	edx		; __int32
		push	ebx		; FILE *
		call	_fseek
		mov	ecx, 9Ah
		xor	eax, eax
		lea	edi, [esp+88Ch+var_838]
		lea	edx, [esp+88Ch+var_200]
		rep stosd
		mov	eax, [esp+88Ch+var_85C]
		lea	ecx, [esp+88Ch+var_86C]
		mov	[esp+88Ch+var_800], eax
		lea	eax, [esp+88Ch+var_400]
		mov	[esp+88Ch+var_810], eax
		mov	[esp+88Ch+var_830], ecx
		mov	ecx, [esp+88Ch+hWnd]
		mov	[esp+88Ch+var_7FC], ebp
		mov	ebp, [esp+88Ch+arg_0]
		mov	[esp+88Ch+var_814], edx
		mov	edx, [esp+88Ch+var_860]
		lea	eax, [esp+88Ch+var_838]
		push	eax
		mov	[esp+890h+var_838], ebx
		mov	[esp+890h+var_82C], esi
		mov	[esp+890h+var_828], esi
		mov	[esp+890h+var_80C], ecx
		mov	[esp+890h+var_808], esi
		mov	[esp+890h+var_820], edx
		mov	[esp+890h+var_7F8], 1
		mov	[esp+890h+var_5D4], ebp
		call	sub_402190
		add	esp, 10h
		cmp	eax, esi
		jnz	short loc_401662
		lea	ecx, [esp+880h+var_838]
		push	ecx
		call	sub_401EC0
		mov	eax, [esp+884h+var_834]
		add	esp, 4
		cmp	eax, esi
		jz	short loc_40161C
		push	eax		; FILE *
		call	_fclose
		add	esp, 4

loc_40161C:				; CODE XREF: sub_401470+1A1j
		mov	ecx, 80h
		xor	eax, eax
		lea	edi, [esp+880h+var_400]
		push	1		; int
		rep stosd
		mov	ecx, 80h
		lea	edi, [esp+884h+var_200]
		push	64h		; wParam
		push	ebp		; int
		rep stosd
		call	sub_401B80
		lea	edx, [esp+88Ch+var_838]
		push	edx		; int
		push	ebx		; FILE *
		call	sub_4022F0
		mov	eax, [esp+894h+var_808]
		add	esp, 14h
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFD12Dh

loc_401662:				; CODE XREF: sub_401470+18Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 870h
		retn
sub_401470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401670(HWND hWndParent)
sub_401670	proc near		; CODE XREF: WinMain(x,x,x,x)+92p

var_110		= dword	ptr -110h
hWndParent	= dword	ptr  4

		sub	esp, 110h
		xor	eax, eax
		mov	ecx, 44h
		push	edi
		push	eax		; int
		push	eax		; int
		lea	edi, [esp+11Ch+var_110]
		push	eax		; int
		push	eax		; int
		rep stosd
		mov	ecx, [esp+124h+hWndParent]
		push	eax		; int
		lea	eax, [esp+128h+var_110]
		push	eax		; int
		push	offset sub_401470 ; int
		push	ecx		; hWndParent
		call	sub_401AD0
		add	esp, 20h
		pop	edi
		add	esp, 110h
		retn
sub_401670	endp

; ---------------------------------------------------------------------------
		align 10h

loc_4016B0:				; DATA XREF: WinMain(x,x,x,x)+20o
		mov	ecx, [esp+8]
		sub	esp, 10h
		mov	eax, ecx
		dec	eax
		jz	short loc_4016D8
		mov	eax, [esp+20h]
		mov	edx, [esp+1Ch]
		push	eax
		mov	eax, [esp+18h]
		push	edx
		push	ecx
		push	eax
		call	ds:DefWindowProcA
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_4016D8:				; CODE XREF: .text:004016BAj
		push	esi
		mov	esi, [esp+18h]
		lea	ecx, [esp+4]
		push	edi
		push	ecx
		push	esi
		call	ds:GetWindowRect
		mov	edi, ds:GetSystemMetrics
		push	5
		push	0
		push	0
		push	1
		call	edi ; GetSystemMetrics
		mov	edx, [esp+18h]
		mov	ecx, [esp+20h]
		sub	edx, ecx
		add	eax, edx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		call	edi ; GetSystemMetrics
		mov	ecx, [esp+18h]
		mov	edi, [esp+20h]
		sub	ecx, edi
		add	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		push	esi
		call	ds:SetWindowPos
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: start+DBp

WndClass	= WNDCLASSA ptr	-28h
hInstance	= dword	ptr  4
hPrevInstance	= dword	ptr  8
lpCmdLine	= dword	ptr  0Ch
nShowCmd	= dword	ptr  10h

		sub	esp, 28h
		push	esi
		mov	esi, [esp+2Ch+hInstance]
		push	edi
		mov	hInstance, esi
		call	ds:InitCommonControls
		lea	eax, [esp+30h+WndClass]
		xor	edi, edi
		push	eax		; lpWndClass
		mov	[esp+34h+WndClass.style], edi
		mov	[esp+34h+WndClass.lpfnWndProc],	offset loc_4016B0
		mov	[esp+34h+WndClass.cbClsExtra], edi
		mov	[esp+34h+WndClass.cbWndExtra], edi
		mov	[esp+34h+WndClass.hInstance], esi
		mov	[esp+34h+WndClass.hIcon], edi
		mov	[esp+34h+WndClass.hCursor], edi
		mov	[esp+34h+WndClass.hbrBackground], edi
		mov	[esp+34h+WndClass.lpszMenuName], edi
		mov	[esp+34h+WndClass.lpszClassName], offset WindowName ; "PGPsda_Hidden_Window"
		call	ds:RegisterClassA
		push	edi		; lpParam
		push	esi		; hInstance
		push	edi		; hMenu
		push	edi		; hWndParent
		push	80000000h	; nHeight
		push	80000000h	; nWidth
		push	80000000h	; Y
		push	80000000h	; X
		push	0CF0000h	; dwStyle
		push	offset WindowName ; "PGPsda_Hidden_Window"
		push	offset WindowName ; "PGPsda_Hidden_Window"
		push	edi		; dwExStyle
		call	ds:CreateWindowExA
		mov	esi, eax
		push	edi		; nCmdShow
		push	esi		; hWnd
		call	ds:ShowWindow
		push	esi		; hWnd
		call	ds:UpdateWindow
		push	esi		; hWndParent
		call	sub_401670
		add	esp, 4
		call	sub_402510
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 28h
		retn	10h
_WinMain@16	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: DialogFunc+17Do

lpThreadParameter= dword ptr  4

		push	esi
		mov	esi, [esp+4+lpThreadParameter]
		mov	eax, [esi+0Ch]
		push	eax
		push	esi
		call	dword ptr [esi+8]
		mov	ecx, [esi]
		add	esp, 8
		mov	[esi+34h], eax
		push	0		; lParam
		push	0		; wParam
		push	2		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		mov	edx, [esi+2Ch]
		push	0		; lpPreviousCount
		push	1		; lReleaseCount
		push	edx		; hSemaphore
		call	ds:ReleaseSemaphore
		xor	eax, eax
		pop	esi
		retn	4
StartAddress	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DialogFunc(HWND, UINT,	WPARAM,	LPARAM)
DialogFunc	proc near		; DATA XREF: sub_401AD0+74o

Rect		= tagRECT ptr -10h
hDlg		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
dwNewLong	= dword	ptr  10h

		mov	eax, [esp+arg_4]
		sub	esp, 10h
		cmp	eax, 19h
		push	ebx
		push	esi
		push	edi
		ja	short loc_4018A8
		jz	short loc_40186C
		sub	eax, 2
		jz	short loc_401854
		sub	eax, 0Eh
		jz	short loc_401854
		sub	eax, 2
		jnz	loc_401986

loc_401854:				; CODE XREF: DialogFunc+14j
					; DialogFunc+19j
		mov	eax, [esp+1Ch+hDlg]
		push	0		; nResult
		push	eax		; hDlg
		call	ds:EndDialog
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_40186C:				; CODE XREF: DialogFunc+Fj
		mov	edi, [esp+1Ch+arg_8]
		test	edi, edi
		jz	loc_401986
		mov	ebx, ds:GetSysColor
		push	0Fh		; nIndex
		call	ebx ; GetSysColor
		mov	esi, eax
		push	esi		; color
		push	edi		; hdc
		call	ds:SetBkColor
		push	8		; nIndex
		call	ebx ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		push	esi		; color
		call	ds:CreateSolidBrush
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_4018A8:				; CODE XREF: DialogFunc+Dj
		sub	eax, 110h
		jz	loc_401991
		dec	eax
		jz	loc_401959
		sub	eax, 2
		jnz	loc_401986
		mov	edi, [esp+1Ch+hDlg]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_40192D
		mov	ecx, [esi]
		push	ecx		; hWnd
		call	ds:IsWindowEnabled
		test	eax, eax
		mov	eax, [esi+3Ch]
		jnz	short loc_401904
		test	eax, eax
		jz	short loc_40192D
		mov	edx, [esi]
		push	0
		push	0
		push	466h
		push	64h
		mov	dword ptr [esi+3Ch], 0
		push	edx
		jmp	short loc_401920
; ---------------------------------------------------------------------------

loc_401904:				; CODE XREF: DialogFunc+B7j
		test	eax, eax
		jnz	short loc_40192D
		mov	eax, [esi]
		push	0FFFF0000h	; lParam
		push	0FFFFFFFFh	; wParam
		push	465h		; Msg
		push	64h		; nIDDlgItem
		mov	dword ptr [esi+3Ch], 1
		push	eax		; hDlg

loc_401920:				; CODE XREF: DialogFunc+D2j
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA

loc_40192D:				; CODE XREF: DialogFunc+A7j
					; DialogFunc+BBj ...
		mov	eax, [esi+24h]
		mov	ecx, [esi+28h]
		cmp	eax, ecx
		jz	short loc_401986
		push	0		; lParam
		push	eax		; wParam
		push	402h		; Msg
		push	3F2h		; nIDDlgItem
		push	edi		; hDlg
		mov	[esi+28h], eax
		call	ds:SendDlgItemMessageA
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_401959:				; CODE XREF: DialogFunc+84j
		mov	eax, [esp+1Ch+arg_8]
		and	eax, 0FFFFh
		sub	eax, 2
		jnz	short loc_401986
		mov	esi, [esp+1Ch+hDlg]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	0		; nCmdShow
		push	esi		; hWnd
		mov	edi, eax
		call	ds:ShowWindow
		mov	dword ptr [edi+38h], 1

loc_401986:				; CODE XREF: DialogFunc+1Ej
					; DialogFunc+42j ...
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_401991:				; CODE XREF: DialogFunc+7Dj
		mov	esi, [esp+1Ch+dwNewLong]
		mov	edi, [esp+1Ch+hDlg]
		push	ebp
		push	esi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		lea	ecx, [esi+30h]
		mov	[esi], edi
		push	ecx		; lpThreadId
		push	0		; dwCreationFlags
		push	esi		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	0		; dwStackSize
		push	0		; lpThreadAttributes
		call	ds:CreateThread
		mov	ebx, ds:SendDlgItemMessageA
		push	640000h		; lParam
		push	0		; wParam
		push	401h		; Msg
		push	3F2h		; nIDDlgItem
		push	edi		; hDlg
		call	ebx ; SendDlgItemMessageA
		mov	edx, [esi+10h]
		push	0		; lParam
		push	edx		; wParam
		push	402h		; Msg
		push	3F2h		; nIDDlgItem
		push	edi		; hDlg
		call	ebx ; SendDlgItemMessageA
		mov	eax, [esi+14h]
		mov	ebp, ds:SetWindowTextA
		test	eax, eax
		jz	short loc_4019FA
		push	eax		; lpString
		push	edi		; hWnd
		call	ebp ; SetWindowTextA

loc_4019FA:				; CODE XREF: DialogFunc+1C4j
		mov	eax, [esi+18h]
		mov	ebx, ds:GetDlgItem
		test	eax, eax
		jz	short loc_401A15
		push	eax		; lpString
		mov	eax, [esi]
		push	411h		; nIDDlgItem
		push	eax		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; SetWindowTextA

loc_401A15:				; CODE XREF: DialogFunc+1D5j
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	short loc_401A2A
		mov	ecx, [esi]
		push	eax		; lpString
		push	3F4h		; nIDDlgItem
		push	ecx		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; SetWindowTextA

loc_401A2A:				; CODE XREF: DialogFunc+1EAj
		mov	eax, [esi+20h]
		pop	ebp
		test	eax, eax
		jz	short loc_401A54
		xor	edx, edx
		mov	dword ptr [esi+3Ch], 1
		mov	dx, ax
		mov	eax, [esi]
		push	edx		; lParam
		push	0		; wParam
		push	464h		; Msg
		push	64h		; nIDDlgItem
		push	eax		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA

loc_401A54:				; CODE XREF: DialogFunc+200j
		push	0		; lpTimerFunc
		push	4Bh		; uElapse
		push	64h		; nIDEvent
		push	edi		; hWnd
		call	ds:SetTimer
		lea	ecx, [esp+1Ch+Rect]
		push	ecx		; lpRect
		push	edi		; hWnd
		call	ds:GetWindowRect
		mov	esi, ds:GetSystemMetrics
		push	5		; uFlags
		push	0		; cy
		push	0		; cx
		push	1		; nIndex
		call	esi ; GetSystemMetrics
		mov	edx, [esp+28h+Rect.top]
		mov	ecx, [esp+28h+Rect.bottom]
		sub	edx, ecx
		add	eax, edx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax		; Y
		push	0		; nIndex
		call	esi ; GetSystemMetrics
		mov	ecx, [esp+2Ch+Rect.left]
		mov	esi, [esp+2Ch+Rect.right]
		sub	ecx, esi
		add	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax		; X
		push	0		; hWndInsertAfter
		push	edi		; hWnd
		call	ds:SetWindowPos
		push	edi		; hWnd
		call	ds:SetForegroundWindow
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 10h
		retn	10h
DialogFunc	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401AD0(HWND hWndParent, int, int, int, int, int, int,	int)
sub_401AD0	proc near		; CODE XREF: sub_401670+2Bp

hWndParent	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	esi
		push	40h		; size_t
		call	_malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_401AE8
		mov	eax, 0FFFFD121h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_401AE8:				; CODE XREF: sub_401AD0+Fj
		mov	edx, [esp+4+arg_C]
		push	edi
		mov	ecx, 10h
		xor	eax, eax
		mov	edi, esi
		push	0		; lpName
		rep stosd
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_8]
		mov	edi, [esp+0Ch+hWndParent]
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_10]
		mov	[esi+0Ch], ecx
		mov	ecx, [esp+0Ch+arg_14]
		mov	[esi+10h], edx
		mov	edx, [esp+0Ch+arg_18]
		mov	[esi+14h], eax
		mov	eax, [esp+0Ch+arg_1C]
		push	1		; lMaximumCount
		push	0		; lInitialCount
		push	0		; lpSemaphoreAttributes
		mov	[esi+4], edi
		mov	[esi+18h], ecx
		mov	[esi+1Ch], edx
		mov	[esi+20h], eax
		call	ds:CreateSemaphoreA
		push	esi		; dwInitParam
		mov	[esi+2Ch], eax
		mov	ecx, hInstance
		push	offset DialogFunc ; lpDialogFunc
		push	edi		; hWndParent
		push	3FCh		; lpTemplateName
		push	ecx		; hInstance
		call	ds:DialogBoxParamA
		mov	edx, [esi+2Ch]
		push	0FFFFFFFFh	; dwMilliseconds
		push	edx		; hHandle
		call	ds:WaitForSingleObject
		mov	eax, [esi+2Ch]
		push	eax		; hObject
		call	ds:CloseHandle
		mov	edi, [esi+34h]
		push	esi		; void *
		call	_free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_401AD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401B80(int, WPARAM wParam, int)
sub_401B80	proc near		; CODE XREF: sub_401000+4Ep
					; sub_401470+1CFp

arg_0		= dword	ptr  4
wParam		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		mov	eax, [esp+wParam]
		push	esi
		mov	esi, [esp+4+arg_0]
		test	ecx, ecx
		mov	[esi+24h], eax
		jz	short loc_401BAD
		push	0		; lParam
		mov	[esi+28h], eax
		push	eax		; wParam
		mov	eax, [esi]
		push	402h		; Msg
		push	3F2h		; nIDDlgItem
		push	eax		; hDlg
		call	ds:SendDlgItemMessageA

loc_401BAD:				; CODE XREF: sub_401B80+12j
		mov	eax, [esi+38h]
		pop	esi
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFD12Dh
		retn
sub_401B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401BC0	proc near		; CODE XREF: sub_401470+19p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax]
		retn
sub_401BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401BD0	proc near		; CODE XREF: sub_4010E0+F5p
					; sub_4010E0+1F4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jz	short loc_401BE0
		cmp	dword ptr [eax], 0
		jz	short loc_401BE0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_401BE0:				; CODE XREF: sub_401BD0+6j
					; sub_401BD0+Bj
		push	esi
		push	edi
		push	10Ch		; size_t
		call	_malloc
		mov	edx, eax
		mov	ecx, 43h
		xor	eax, eax
		mov	edi, edx
		rep stosd
		mov	edi, [esp+0Ch+arg_4]
		or	ecx, 0FFFFFFFFh
		add	esp, 4
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		mov	eax, [esp+8+arg_0]
		and	ecx, 3
		rep movsb
		mov	ecx, [eax]
		pop	edi
		mov	[edx+108h], ecx
		mov	[eax], edx
		mov	eax, 1
		pop	esi
		retn
sub_401BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401C40	proc near		; CODE XREF: sub_402510+1Ep
					; sub_402510:loc_402559p

TokenHandle	= dword	ptr -0B0h
Luid		= _LUID	ptr -0ACh
NewState	= _TOKEN_PRIVILEGES ptr	-0A4h
VersionInformation= _OSVERSIONINFOA ptr	-94h

		sub	esp, 0B0h
		push	edi
		mov	ecx, 25h
		xor	eax, eax
		lea	edi, [esp+0B4h+VersionInformation]
		rep stosd
		lea	eax, [esp+0B4h+VersionInformation]
		mov	[esp+0B4h+VersionInformation.dwOSVersionInfoSize], 94h
		push	eax		; lpVersionInformation
		call	ds:GetVersionExA
		mov	eax, [esp+0B4h+VersionInformation.dwPlatformId]
		pop	edi
		cmp	eax, 2
		jnz	short loc_401CCF
		lea	ecx, [esp+0B0h+TokenHandle]
		push	ecx		; TokenHandle
		push	28h		; DesiredAccess
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		lea	edx, [esp+0B0h+Luid]
		push	edx		; lpLuid
		push	offset Name	; "SeShutdownPrivilege"
		push	0		; lpSystemName
		call	ds:LookupPrivilegeValueA
		mov	eax, [esp+0B0h+Luid.LowPart]
		mov	ecx, [esp+0B0h+Luid.HighPart]
		push	0		; ReturnLength
		push	0		; PreviousState
		lea	edx, [esp+0B8h+NewState]
		mov	[esp+0B8h+NewState.Privileges.Luid.LowPart], eax
		mov	eax, [esp+0B8h+TokenHandle]
		push	10h		; BufferLength
		push	edx		; NewState
		push	0		; DisableAllPrivileges
		push	eax		; TokenHandle
		mov	[esp+0C8h+NewState.PrivilegeCount], 1
		mov	[esp+0C8h+NewState.Privileges.Luid.HighPart], ecx
		mov	[esp+0C8h+NewState.Privileges.Attributes], 2
		call	ds:AdjustTokenPrivileges

loc_401CCF:				; CODE XREF: sub_401C40+2Fj
		push	0		; dwReason
		push	2		; uFlags
		call	ds:ExitWindowsEx
		add	esp, 0B0h
		retn
sub_401C40	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401CE0(BYTE *lpData)
sub_401CE0	proc near		; CODE XREF: sub_402510+41p

phkResult	= dword	ptr -8
dwDisposition	= dword	ptr -4
lpData		= dword	ptr  4

		sub	esp, 8
		lea	eax, [esp+8+dwDisposition]
		lea	ecx, [esp+8+phkResult]
		push	eax		; lpdwDisposition
		push	ecx		; phkResult
		push	0		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	0		; dwOptions
		push	0		; lpClass
		push	0		; Reserved
		push	offset SubKey	; "SOFTWARE\\Microsoft\\Windows\\CurrentVe"...
		push	80000002h	; hKey
		call	ds:RegCreateKeyExA
		test	eax, eax
		jnz	short loc_401D46
		mov	edx, [esp+8+lpData]
		push	edi
		mov	edi, edx
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		push	ecx		; cbData
		push	edx		; lpData
		mov	edx, [esp+14h+phkResult]
		push	1		; dwType
		push	eax		; Reserved
		push	offset ValueName ; "Run	PGP SEA	Installer on Reboot"
		push	edx		; hKey
		call	ds:RegSetValueExA
		mov	eax, [esp+0Ch+phkResult]
		push	eax		; hKey
		call	ds:RegCloseKey
		mov	eax, 1
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_401D46:				; CODE XREF: sub_401CE0+2Cj
		xor	eax, eax
		add	esp, 8
		retn
sub_401CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401D50	proc near		; CODE XREF: sub_402510+6p

phkResult	= dword	ptr -4

		push	ecx
		lea	eax, [esp+4+phkResult]
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset SubKey	; "SOFTWARE\\Microsoft\\Windows\\CurrentVe"...
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_401D93
		mov	ecx, [esp+4+phkResult]
		push	offset ValueName ; "Run	PGP SEA	Installer on Reboot"
		push	ecx		; hKey
		call	ds:RegDeleteValueA
		mov	edx, [esp+4+phkResult]
		push	edx		; hKey
		call	ds:RegCloseKey
		mov	eax, 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_401D93:				; CODE XREF: sub_401D50+1Fj
		xor	eax, eax
		pop	ecx
		retn
sub_401D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401DA0(BYTE Data)
sub_401DA0	proc near		; CODE XREF: sub_4022F0+Ap

phkResult	= dword	ptr -4
Data		= byte ptr  4

		push	ecx
		lea	eax, [esp+4+phkResult]
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset aSoftwareNetwor ; "Software\\Network Associates\\PGP"
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_401DED
		mov	edx, [esp+4+phkResult]
		lea	ecx, [esp+4+Data]
		push	4		; cbData
		push	ecx		; lpData
		push	4		; dwType
		push	eax		; Reserved
		push	offset aReboot	; "Reboot"
		push	edx		; hKey
		call	ds:RegSetValueExA
		mov	eax, [esp+4+phkResult]
		push	eax		; hKey
		call	ds:RegCloseKey
		mov	eax, 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_401DED:				; CODE XREF: sub_401DA0+1Fj
		xor	eax, eax
		pop	ecx
		retn
sub_401DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401E00	proc near		; CODE XREF: sub_402510+19p

phkResult	= dword	ptr -4

		push	ecx
		lea	eax, [esp+4+phkResult]
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset aSoftwareNetw_0 ; "Software\\Network Associates"
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_401E43
		mov	ecx, [esp+4+phkResult]
		push	offset aPgp	; "PGP"
		push	ecx		; hKey
		call	ds:RegDeleteKeyA
		mov	edx, [esp+4+phkResult]
		push	edx		; hKey
		call	ds:RegCloseKey
		mov	eax, 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_401E43:				; CODE XREF: sub_401E00+1Fj
		xor	eax, eax
		pop	ecx
		retn
sub_401E00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401E50	proc near		; CODE XREF: sub_402510+Bp

Data		= byte ptr -10h
phkResult	= dword	ptr -0Ch
cbData		= dword	ptr -8
Type		= dword	ptr -4

		sub	esp, 10h
		lea	eax, [esp+10h+phkResult]
		mov	dword ptr [esp+10h+Data], 0
		push	eax		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	offset aSoftwareNetwor ; "Software\\Network Associates\\PGP"
		push	80000002h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_401EB3
		lea	ecx, [esp+10h+cbData]
		mov	[esp+10h+Type],	eax
		lea	edx, [esp+10h+Data]
		push	ecx		; lpcbData
		mov	ecx, [esp+14h+phkResult]
		lea	eax, [esp+14h+Type]
		push	edx		; lpData
		push	eax		; lpType
		push	0		; lpReserved
		push	offset aReboot	; "Reboot"
		push	ecx		; hKey
		mov	[esp+28h+cbData], 4
		call	ds:RegQueryValueExA
		mov	edx, [esp+10h+phkResult]
		push	edx		; hKey
		call	ds:RegCloseKey

loc_401EB3:				; CODE XREF: sub_401E50+29j
		mov	eax, dword ptr [esp+10h+Data]
		add	esp, 10h
		retn
sub_401E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401EC0	proc near		; CODE XREF: sub_401470+193p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	sub_401000
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_401EE8

loc_401ED3:				; CODE XREF: sub_401EC0+26j
		push	esi
		push	eax
		call	sub_4010E0
		push	esi
		call	sub_401000
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_401ED3

loc_401EE8:				; CODE XREF: sub_401EC0+11j
		pop	esi
		retn
sub_401EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401EF0(HWND hWnd, int, int)
sub_401EF0	proc near		; CODE XREF: sub_4022F0+12Bp

ProcessInformation= _PROCESS_INFORMATION ptr -1C0h
StartupInfo	= _STARTUPINFOA	ptr -1B0h
Buffer		= byte ptr -16Ch
CommandLine	= byte ptr -108h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1C0h
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+1CCh+arg_4]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		lea	edx, [esp+1CCh+CommandLine]
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+1CCh+CommandLine]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		rep movsb
		mov	edi, [esp+1CCh+arg_8]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	ebx, ecx
		mov	edi, edx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, ebx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, ebx
		lea	edx, [esp+1CCh+StartupInfo]
		and	ecx, 3
		rep movsb
		mov	ecx, 11h
		lea	edi, [esp+1CCh+StartupInfo]
		rep stosd
		mov	[esp+1CCh+ProcessInformation.hProcess],	eax
		lea	ecx, [esp+1CCh+ProcessInformation]
		mov	[esp+1CCh+ProcessInformation.hThread], eax
		push	ecx		; lpProcessInformation
		mov	[esp+1D0h+ProcessInformation.dwProcessId], eax
		push	edx		; lpStartupInfo
		push	eax		; lpCurrentDirectory
		push	eax		; lpEnvironment
		push	20h		; dwCreationFlags
		push	eax		; bInheritHandles
		push	eax		; lpThreadAttributes
		mov	[esp+1E8h+ProcessInformation.dwThreadId], eax
		push	eax		; lpProcessAttributes
		lea	eax, [esp+1ECh+CommandLine]
		mov	esi, 1
		push	eax		; lpCommandLine
		push	0		; lpApplicationName
		mov	[esp+1F4h+StartupInfo.cb], 44h
		mov	[esp+1F4h+StartupInfo.dwFlags],	esi
		mov	[esp+1F4h+StartupInfo.wShowWindow], si
		call	ds:CreateProcessA
		test	eax, eax
		jnz	short loc_401FF2
		mov	edx, hInstance
		lea	ecx, [esp+1CCh+Buffer]
		push	64h		; cchBufferMax
		push	ecx		; lpBuffer
		push	13D8h		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		mov	edx, [esp+1CCh+hWnd]
		lea	eax, [esp+1CCh+CommandLine]
		push	10010h		; uType
		lea	ecx, [esp+1D0h+Buffer]
		push	eax		; lpCaption
		push	ecx		; lpText
		push	edx		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 1C0h
		retn
; ---------------------------------------------------------------------------

loc_401FF2:				; CODE XREF: sub_401EF0+BBj
		mov	eax, [esp+1CCh+ProcessInformation.hProcess]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		mov	ecx, [esp+1CCh+ProcessInformation.hProcess]
		push	ecx		; hObject
		call	ds:CloseHandle
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1C0h
		retn
sub_401EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402020(HWND hWnd, FILE *, int, int, int, __int32, size_t)
sub_402020	proc near		; CODE XREF: sub_4022F0+AFp
					; sub_4022F0+CFp ...

Buffer		= byte ptr -16Ch
Caption		= byte ptr -108h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 16Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+178h+arg_14]
		test	esi, esi
		jz	loc_402173
		mov	ebp, [esp+178h+arg_18]
		push	ebp		; size_t
		call	_malloc
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_402058
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 16Ch
		retn
; ---------------------------------------------------------------------------

loc_402058:				; CODE XREF: sub_402020+2Cj
		mov	ecx, ebp
		push	edi
		mov	edx, ecx
		xor	eax, eax
		mov	edi, ebx
		push	0		; int
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		push	esi		; __int32
		mov	esi, [esp+184h+arg_4]
		and	ecx, 3
		rep stosb
		push	esi		; FILE *
		call	_fseek
		push	esi		; FILE *
		push	ebp		; size_t
		push	1		; size_t
		push	ebx		; void *
		call	sub_402570
		mov	edi, [esp+198h+arg_8]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		lea	edx, [esp+198h+Caption]
		repne scasb
		not	ecx
		sub	edi, ecx
		push	offset aWb	; "wb"
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+19Ch+Caption]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		rep movsb
		mov	edi, [esp+19Ch+arg_10]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	eax, [esp+19Ch+Caption]
		and	ecx, 3
		push	eax		; char *
		rep movsb
		call	_fopen
		add	esp, 24h
		mov	esi, eax
		test	esi, esi
		pop	edi
		jnz	short loc_402143
		mov	edx, hInstance
		lea	ecx, [esp+178h+Buffer]
		push	64h		; cchBufferMax
		push	ecx		; lpBuffer
		push	13D9h		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		mov	edx, [esp+178h+hWnd]
		lea	eax, [esp+178h+Caption]
		push	10010h		; uType
		lea	ecx, [esp+17Ch+Buffer]
		push	eax		; lpCaption
		push	ecx		; lpText
		push	edx		; hWnd
		call	ds:MessageBoxA
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 16Ch
		retn
; ---------------------------------------------------------------------------

loc_402143:				; CODE XREF: sub_402020+DFj
		push	esi		; FILE *
		push	ebp		; size_t
		push	1		; size_t
		push	ebx		; void *
		call	sub_4029B7
		push	esi		; FILE *
		call	_fclose
		mov	ecx, [esp+18Ch+arg_C]
		lea	eax, [esp+18Ch+Caption]
		push	0
		push	eax
		push	ecx
		call	sub_401BD0
		push	ebx		; void *
		call	_free
		add	esp, 24h

loc_402173:				; CODE XREF: sub_402020+12j
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 16Ch
		retn
sub_402020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402190	proc near		; CODE XREF: sub_401470+182p

var_264		= byte ptr -264h
var_25F		= byte ptr -25Fh
Buffer		= byte ptr -200h
Caption		= byte ptr -100h
arg_0		= dword	ptr  4

		sub	esp, 264h
		push	ebx
		push	ebp
		mov	ebp, [esp+26Ch+arg_0]
		push	esi
		lea	ebx, [ebp+158h]
		push	ebx		; lpBuffer
		push	105h		; nBufferLength
		call	ds:GetTempPathA
		test	eax, eax
		jz	loc_402273
		push	edi
		push	0		; time_t *
		call	_time
		push	eax		; unsigned int
		call	_srand
		call	_rand
		mov	esi, eax
		call	_rand
		imul	esi, eax
		push	esi
		lea	edx, [esp+280h+var_264]
		push	offset asc_40B108 ; "%x"
		push	edx		; char *
		call	_sprintf
		or	ecx, 0FFFFFFFFh
		mov	edi, offset aPgp ; "PGP"
		xor	eax, eax
		mov	[esp+288h+var_25F], 0
		repne scasb
		not	ecx
		sub	edi, ecx
		push	ebx		; char *
		mov	edx, ecx
		mov	esi, edi
		or	ecx, 0FFFFFFFFh
		mov	edi, ebx
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		and	ecx, 3
		rep movsb
		lea	edi, [esp+28Ch+var_264]
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edx, ecx
		mov	edi, ebx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		and	ecx, 3
		rep movsb
		mov	edi, offset asc_40B104 ; "\\"
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	edx, ecx
		mov	edi, ebx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		and	ecx, 3
		rep movsb
		call	__mkdir
		add	esp, 18h
		test	eax, eax
		pop	edi
		jz	short loc_4022BA

loc_402273:				; CODE XREF: sub_402190+24j
		mov	ecx, hInstance
		lea	eax, [esp+270h+Buffer]
		push	100h		; cchBufferMax
		push	eax		; lpBuffer
		push	13DEh		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		mov	ecx, [ebp+2Ch]
		lea	edx, [esp+270h+Caption]
		push	10010h		; uType
		lea	eax, [esp+274h+Buffer]
		push	edx		; lpCaption
		push	eax		; lpText
		push	ecx		; hWnd
		call	ds:MessageBoxA
		pop	esi
		pop	ebp
		mov	eax, 0FFFFD12Dh
		pop	ebx
		add	esp, 264h
		retn
; ---------------------------------------------------------------------------

loc_4022BA:				; CODE XREF: sub_402190+E1j
		lea	esi, [ebp+260h]
		push	0
		push	ebx
		push	esi
		call	sub_401BD0
		mov	edx, [esi]
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		pop	ebp
		mov	dword ptr [edx+104h], 1
		pop	ebx
		add	esp, 264h
		retn
sub_402190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4022F0(FILE *, int)
sub_4022F0	proc near		; CODE XREF: sub_401470+1DAp

dwProcessId	= dword	ptr -10Ch
var_108		= dword	ptr -108h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 10Ch
		push	ebx
		push	esi
		push	0		; Data
		call	sub_401DA0
		mov	ebx, [esp+118h+arg_4]
		add	esp, 4
		mov	eax, [ebx+30h]
		test	eax, eax
		jnz	loc_4024B8
		mov	eax, [ebx+2Ch]
		push	ebp
		push	edi
		push	0		; nCmdShow
		push	eax		; hWnd
		call	ds:ShowWindow
		lea	edi, [ebx+158h]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		lea	edx, [esp+11Ch+var_108]
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		lea	edx, [esp+11Ch+var_108]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		xor	eax, eax
		and	ecx, 3
		rep movsb
		mov	edi, offset aDisk1 ; "Disk1\\"
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	esi, edi
		mov	ebp, ecx
		mov	edi, edx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, ebp
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	eax, [ebx+8]
		mov	ecx, ebp
		and	ecx, 3
		rep movsb
		mov	ecx, [eax+18h]
		mov	edx, [eax+14h]
		mov	edi, [esp+11Ch+arg_0]
		push	ecx		; size_t
		mov	ecx, [ebx+2Ch]
		lea	esi, [ebx+260h]
		push	edx		; __int32
		push	offset aPgpadmin_dat ; "PGPadmin.dat"
		lea	eax, [esp+128h+var_108]
		push	esi		; int
		push	eax		; int
		push	edi		; FILE *
		push	ecx		; hWnd
		call	sub_402020
		mov	eax, [ebx+8]
		lea	ecx, [esp+138h+var_108]
		mov	edx, [eax+20h]
		mov	eax, [eax+1Ch]
		push	edx		; size_t
		mov	edx, [ebx+2Ch]
		push	eax		; __int32
		push	offset aPgpclient_dat ;	"PGPclient.dat"
		push	esi		; int
		push	ecx		; int
		push	edi		; FILE *
		push	edx		; hWnd
		call	sub_402020
		mov	eax, [ebx+8]
		mov	ecx, [eax+28h]
		mov	edx, [eax+24h]
		push	ecx		; size_t
		mov	ecx, [ebx+2Ch]
		push	edx		; __int32
		push	offset aPgpnet_dat ; "PGPnet.dat"
		lea	eax, [esp+160h+var_108]
		push	esi		; int
		push	eax		; int
		push	edi		; FILE *
		push	ecx		; hWnd
		call	sub_402020
		mov	eax, [ebx+8]
		add	esp, 54h
		lea	ecx, [esp+11Ch+var_108]
		mov	edx, [eax+30h]
		mov	eax, [eax+2Ch]
		push	edx		; size_t
		mov	edx, [ebx+2Ch]
		push	eax		; __int32
		push	offset aSetup_ini ; "setup.ini"
		push	esi		; int
		push	ecx		; int
		push	edi		; FILE *
		push	edx		; hWnd
		call	sub_402020
		push	edi		; FILE *
		call	_fclose
		mov	ecx, [ebx+2Ch]
		lea	eax, [esp+13Ch+var_108]
		push	offset aSetup_exe ; "Setup.exe"
		push	eax		; int
		push	ecx		; hWnd
		call	sub_401EF0
		mov	ebp, ds:GetWindowThreadProcessId
		add	esp, 2Ch

loc_402429:				; CODE XREF: sub_4022F0+1B9j
					; sub_4022F0+1C0j
		xor	edi, edi
		push	edi		; lpWindowName
		push	offset ClassName ; "InstallShield_Win"
		call	ds:FindWindowA
		test	eax, eax
		jz	short loc_40246C
		lea	edx, [esp+11Ch+dwProcessId]
		mov	edi, 1
		push	edx		; lpdwProcessId
		push	eax		; hWnd
		call	ebp ; GetWindowThreadProcessId
		mov	eax, [esp+11Ch+dwProcessId]
		push	eax		; dwProcessId
		push	0		; bInheritHandle
		push	1F0FFFh		; dwDesiredAccess
		call	ds:OpenProcess
		mov	esi, eax
		push	0FFFFFFFFh	; dwMilliseconds
		push	esi		; hHandle
		call	ds:WaitForSingleObject
		push	esi		; hObject
		call	ds:CloseHandle

loc_40246C:				; CODE XREF: sub_4022F0+149j
		push	0		; lpWindowName
		push	offset aIsdelete ; "isdelete"
		call	ds:FindWindowA
		test	eax, eax
		jz	short loc_4024AE
		lea	ecx, [esp+11Ch+dwProcessId]
		push	ecx		; lpdwProcessId
		push	eax		; hWnd
		call	ebp ; GetWindowThreadProcessId
		mov	edx, [esp+11Ch+dwProcessId]
		push	edx		; dwProcessId
		push	0		; bInheritHandle
		push	1F0FFFh		; dwDesiredAccess
		call	ds:OpenProcess
		mov	esi, eax
		push	0FFFFFFFFh	; dwMilliseconds
		push	esi		; hHandle
		call	ds:WaitForSingleObject
		push	esi		; hObject
		call	ds:CloseHandle
		jmp	loc_402429
; ---------------------------------------------------------------------------

loc_4024AE:				; CODE XREF: sub_4022F0+18Bj
		test	edi, edi
		jnz	loc_402429
		pop	edi
		pop	ebp

loc_4024B8:				; CODE XREF: sub_4022F0+1Ej
		mov	esi, [ebx+260h]
		test	esi, esi
		jz	short loc_4024FB

loc_4024C2:				; CODE XREF: sub_4022F0+209j
		mov	eax, [esi+108h]
		push	esi		; char *
		mov	[ebx+260h], eax
		mov	eax, [esi+104h]
		test	eax, eax
		jz	short loc_4024E0
		call	__rmdir
		jmp	short loc_4024E5
; ---------------------------------------------------------------------------

loc_4024E0:				; CODE XREF: sub_4022F0+1E7j
		call	__unlink

loc_4024E5:				; CODE XREF: sub_4022F0+1EEj
		add	esp, 4
		push	esi		; void *
		call	_free
		mov	esi, [ebx+260h]
		add	esp, 4
		test	esi, esi
		jnz	short loc_4024C2

loc_4024FB:				; CODE XREF: sub_4022F0+1D0j
		pop	esi
		pop	ebx
		add	esp, 10Ch
		retn
sub_4022F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402510	proc near		; CODE XREF: WinMain(x,x,x,x)+9Ap

Filename	= byte ptr -108h

		sub	esp, 108h
		call	sub_401D50
		call	sub_401E50
		dec	eax
		jz	short loc_402559
		dec	eax
		jz	short loc_40253A
		dec	eax
		jnz	short loc_40255E
		call	sub_401E00
		call	sub_401C40
		add	esp, 108h
		retn
; ---------------------------------------------------------------------------

loc_40253A:				; CODE XREF: sub_402510+14j
		lea	eax, [esp+108h+Filename]
		push	104h		; nSize
		push	eax		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		lea	ecx, [esp+108h+Filename]
		push	ecx		; lpData
		call	sub_401CE0
		add	esp, 4

loc_402559:				; CODE XREF: sub_402510+11j
		call	sub_401C40

loc_40255E:				; CODE XREF: sub_402510+17j
		add	esp, 108h
		retn
sub_402510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402570(void *, size_t, size_t, FILE *)
sub_402570	proc near		; CODE XREF: sub_401000+89p
					; sub_401470+8Ap ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_C]
		call	__lock_file
		push	[ebp+arg_C]	; FILE *
		push	[ebp+arg_8]	; size_t
		push	[ebp+arg_4]	; size_t
		push	[ebp+arg_0]	; void *
		call	_fread
		push	[ebp+arg_C]
		mov	esi, eax
		call	__unlock_file
		add	esp, 18h
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_402570	endp

; [000000E8 BYTES: COLLAPSED FUNCTION _fread]
; [0000003B BYTES: COLLAPSED FUNCTION _fputc]
; [00000031 BYTES: COLLAPSED FUNCTION _fclose]
; [0000004C BYTES: COLLAPSED FUNCTION __fclose_lk]
; [00000031 BYTES: COLLAPSED FUNCTION __fsopen]
; [00000013 BYTES: COLLAPSED FUNCTION _fopen]
; [0000002C BYTES: COLLAPSED FUNCTION __mkdir]
; [0000002C BYTES: COLLAPSED FUNCTION _fseek]
; [0000008D BYTES: COLLAPSED FUNCTION __fseek_lk]
; [00000048 BYTES: COLLAPSED FUNCTION _free]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc]
; [0000004E BYTES: COLLAPSED FUNCTION __heap_alloc]
; [00000052 BYTES: COLLAPSED FUNCTION _sprintf]
		align 10h
; [00000027 BYTES: COLLAPSED FUNCTION _strrchr]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4029B7(void *, size_t, size_t, FILE *)
sub_4029B7	proc near		; CODE XREF: sub_402020+128p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_C]
		call	__lock_file
		push	[ebp+arg_C]	; FILE *
		push	[ebp+arg_8]	; size_t
		push	[ebp+arg_4]	; size_t
		push	[ebp+arg_0]	; void *
		call	_fwrite
		push	[ebp+arg_C]
		mov	esi, eax
		call	__unlock_file
		add	esp, 18h
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_4029B7	endp

; [0000010A BYTES: COLLAPSED FUNCTION _fwrite]
; [0000000D BYTES: COLLAPSED FUNCTION _srand]
; [00000022 BYTES: COLLAPSED FUNCTION _rand]
; [000000DC BYTES: COLLAPSED FUNCTION _time]
; [0000002A BYTES: COLLAPSED FUNCTION _remove]
; [0000000B BYTES: COLLAPSED FUNCTION __unlink]
; [0000002A BYTES: COLLAPSED FUNCTION __rmdir]
; [00000108 BYTES: COLLAPSED FUNCTION start]
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit]
; ---------------------------------------------------------------------------
		retn
; [000000A8 BYTES: COLLAPSED FUNCTION ___initstdio]
; [00000014 BYTES: COLLAPSED FUNCTION ___endstdio]
; [0000002F BYTES: COLLAPSED FUNCTION __lock_file]
; [00000023 BYTES: COLLAPSED FUNCTION __lock_file2]
; [0000002F BYTES: COLLAPSED FUNCTION __unlock_file]
; [00000023 BYTES: COLLAPSED FUNCTION __unlock_file2]
; [000000DC BYTES: COLLAPSED FUNCTION __filbuf]
; [00000065 BYTES: COLLAPSED FUNCTION __read]
; [000001D9 BYTES: COLLAPSED FUNCTION __read_lk]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy]
; [00000118 BYTES: COLLAPSED FUNCTION __flsbuf]
; [0000005D BYTES: COLLAPSED FUNCTION __close]
; [00000083 BYTES: COLLAPSED FUNCTION __close_lk]
; [0000002B BYTES: COLLAPSED FUNCTION __freebuf]
; [0000002E BYTES: COLLAPSED FUNCTION __fflush_lk]
; [0000005C BYTES: COLLAPSED FUNCTION __flush]

; =============== S U B	R O U T	I N E =======================================


sub_403812	proc near		; CODE XREF: ___endstdiop
		push	1
		call	_flsall
		pop	ecx
		retn
sub_403812	endp

; [000000A4 BYTES: COLLAPSED FUNCTION _flsall]
; [00000170 BYTES: COLLAPSED FUNCTION __openfile]
; [000000C8 BYTES: COLLAPSED FUNCTION __getstream]
; [00000073 BYTES: COLLAPSED FUNCTION __dosmaperr]
; [00000009 BYTES: COLLAPSED FUNCTION __errno]
; [00000009 BYTES: COLLAPSED FUNCTION ___doserrno]
; [00000065 BYTES: COLLAPSED FUNCTION __lseek]
; [00000073 BYTES: COLLAPSED FUNCTION __lseek_lk]
; [00000161 BYTES: COLLAPSED FUNCTION __ftell_lk]
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init]
; [00000029 BYTES: COLLAPSED FUNCTION __mtinitlocks]
; [00000061 BYTES: COLLAPSED FUNCTION __lock]
; [00000015 BYTES: COLLAPSED FUNCTION __unlock]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group]
; [000002F6 BYTES: COLLAPSED FUNCTION ___sbh_resize_block]
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh]
; [00000721 BYTES: COLLAPSED FUNCTION __output]
off_40510B	dd offset $NORMAL_STATE$1535 ; DATA XREF: __output+6Er
		dd offset loc_404A5F	; jump table for switch	statement
		dd offset loc_404A7A
		dd offset loc_404AC6
		dd offset loc_404AFD
		dd offset loc_404B05
		dd offset loc_404B3A
		dd offset loc_404BCD
; [00000035 BYTES: COLLAPSED FUNCTION _write_char]
; [00000031 BYTES: COLLAPSED FUNCTION _write_multi_char]
; [00000038 BYTES: COLLAPSED FUNCTION _write_string]
; [0000000D BYTES: COLLAPSED FUNCTION _get_int_arg]
; [00000010 BYTES: COLLAPSED FUNCTION _get_int64_arg]
; [0000000E BYTES: COLLAPSED FUNCTION _get_short_arg]
; [00000065 BYTES: COLLAPSED FUNCTION __write]
; [0000018B BYTES: COLLAPSED FUNCTION __write_lk]
; [00000054 BYTES: COLLAPSED FUNCTION __mtinit]
; [00000013 BYTES: COLLAPSED FUNCTION __initptd]
; [00000067 BYTES: COLLAPSED FUNCTION __getptd]
; [000000C2 BYTES: COLLAPSED FUNCTION ___loctotime_t]
; [0000002D BYTES: COLLAPSED FUNCTION __cinit]
; [00000011 BYTES: COLLAPSED FUNCTION _exit]
; [00000011 BYTES: COLLAPSED FUNCTION __exit]
; [000000A3 BYTES: COLLAPSED FUNCTION _doexit]
; ---------------------------------------------------------------------------
		pop	edi
		retn
; [00000009 BYTES: COLLAPSED FUNCTION __lockexit]
; [00000009 BYTES: COLLAPSED FUNCTION __unlockexit]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm]
; [0000013E BYTES: COLLAPSED FUNCTION __XcptFilter]
; [0000003A BYTES: COLLAPSED FUNCTION _xcptlookup]
; [00000058 BYTES: COLLAPSED FUNCTION __wincmdln]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA]
; [000001BC BYTES: COLLAPSED FUNCTION __ioinit]
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_40B6FC
		jmp	short __NLG_Go
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify]
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION __except_handler3]
; [0000001B BYTES: COLLAPSED FUNCTION _seh_longjmp_unwind(x)]
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE]
; [0000008D BYTES: COLLAPSED FUNCTION _calloc]
; [00000081 BYTES: COLLAPSED FUNCTION __fcloseall]
; [00000044 BYTES: COLLAPSED FUNCTION __getbuf]
; [00000123 BYTES: COLLAPSED FUNCTION __alloc_osfhnd]
; [0000007C BYTES: COLLAPSED FUNCTION __set_osfhnd]
; [0000007F BYTES: COLLAPSED FUNCTION __free_osfhnd]
; [00000042 BYTES: COLLAPSED FUNCTION __get_osfhandle]
; [0000005F BYTES: COLLAPSED FUNCTION __lock_fhandle]
; [00000022 BYTES: COLLAPSED FUNCTION __unlock_fhandle]
; [00000029 BYTES: COLLAPSED FUNCTION __isatty]
; [00000093 BYTES: COLLAPSED FUNCTION __commit]
; [000002CF BYTES: COLLAPSED FUNCTION __sopen]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0]
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen]
; [00000059 BYTES: COLLAPSED FUNCTION _wctomb]
; [00000069 BYTES: COLLAPSED FUNCTION __wctomb_lk]
		align 10h
; [00000068 BYTES: COLLAPSED FUNCTION __aulldiv]
		align 10h
; [00000075 BYTES: COLLAPSED FUNCTION __aullrem]
; [0000002E BYTES: COLLAPSED FUNCTION ___tzset]
; [00000287 BYTES: COLLAPSED FUNCTION __tzset_lk]
; [00000021 BYTES: COLLAPSED FUNCTION __isindst]
; [000001AC BYTES: COLLAPSED FUNCTION __isindst_0]
; [00000140 BYTES: COLLAPSED FUNCTION _cvtdate]
; [00000011 BYTES: COLLAPSED FUNCTION __ismbblead]
; [00000031 BYTES: COLLAPSED FUNCTION _x_ismbbtype]
; [000001AD BYTES: COLLAPSED FUNCTION __setmbcp]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow]
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable]
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset]
; [00000125 BYTES: COLLAPSED FUNCTION __chsize_lk]
; [00000007 BYTES: COLLAPSED FUNCTION __fptrap]
		db  59h	; Y
		db 0C3h	; 
; [0000008B BYTES: COLLAPSED FUNCTION _atol]
		align 10h
; [00000084 BYTES: COLLAPSED FUNCTION _strcmp]
; [0000007D BYTES: COLLAPSED FUNCTION _getenv]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA]
; [00000061 BYTES: COLLAPSED FUNCTION __setmode_lk]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe]
		align 10h
; [0000003E BYTES: COLLAPSED FUNCTION _strcspn]
		align 10h
; [00000038 BYTES: COLLAPSED FUNCTION _strncmp]
		align 10h
; [0000003A BYTES: COLLAPSED FUNCTION _strpbrk]
; [00000075 BYTES: COLLAPSED FUNCTION __isctype]
		align 10h

__allmul:
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		or	ecx, eax
		mov	ecx, [esp+0Ch]
		jnz	short hard
		mov	eax, [esp+4]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

hard:					; CODE XREF: .text:004083BEj
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		mul	dword ptr [esp+14h]
		add	ebx, eax
		mov	eax, [esp+8]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
; [0000003F BYTES: COLLAPSED FUNCTION __mbsnbicoll]
; [0000006E BYTES: COLLAPSED FUNCTION ___wtomb_environ]
		align 10h
; [000000D0 BYTES: COLLAPSED FUNCTION __strcmpi]
; [00000101 BYTES: COLLAPSED FUNCTION __strnicmp]
; [0000027D BYTES: COLLAPSED FUNCTION ___crtCompareStringA]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt]
; [00000187 BYTES: COLLAPSED FUNCTION ___crtsetenv]
; [00000058 BYTES: COLLAPSED FUNCTION _findenv]
; [00000067 BYTES: COLLAPSED FUNCTION _copy_environ]
; [000000CB BYTES: COLLAPSED FUNCTION _tolower]
; [00000138 BYTES: COLLAPSED FUNCTION _realloc]
; [00000097 BYTES: COLLAPSED FUNCTION __mbschr]
; [0000002B BYTES: COLLAPSED FUNCTION __strdup]
		align 10h
; [00000005 BYTES: COLLAPSED CHUNK OF FUNCTION _strchr]
		align 10h
; [000000BC BYTES: COLLAPSED FUNCTION _strchr]
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 100h
_text		ends

; Section 2. (virtual address 00009000)
; Virtual size			: 00001152 (   4434.)
; Section size in file		: 00002000 (   8192.)
; Offset to raw	data for section: 00009000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegSetValueExA(HKEY	hKey, LPCSTR lpValueName, DWORD	Reserved, DWORD	dwType,	const BYTE *lpData, DWORD cbData)
		extrn RegSetValueExA:dword ; CODE XREF:	sub_401CE0+4Bp
					; sub_401DA0+35p
					; DATA XREF: ...
; BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL	DisableAllPrivileges, PTOKEN_PRIVILEGES	NewState, DWORD	BufferLength, PTOKEN_PRIVILEGES	PreviousState, PDWORD ReturnLength)
		extrn AdjustTokenPrivileges:dword ; CODE XREF: sub_401C40+89p
					; DATA XREF: sub_401C40+89r
; BOOL __stdcall LookupPrivilegeValueA(LPCSTR lpSystemName, LPCSTR lpName, PLUID lpLuid)
		extrn LookupPrivilegeValueA:dword ; CODE XREF: sub_401C40+51p
					; DATA XREF: sub_401C40+51r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_401C40+3Fp
					; DATA XREF: sub_401C40+3Fr
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_401CE0+56p
					; sub_401D50+36p ...
; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey,	DWORD Reserved,	LPSTR lpClass, DWORD dwOptions,	REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; CODE XREF: sub_401CE0+24p
					; DATA XREF: sub_401CE0+24r
; LSTATUS __stdcall RegDeleteValueA(HKEY hKey, LPCSTR lpValueName)
		extrn RegDeleteValueA:dword ; CODE XREF: sub_401D50+2Bp
					; DATA XREF: sub_401D50+2Br
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_401D50+17p
					; sub_401DA0+17p ...
; LSTATUS __stdcall RegDeleteKeyA(HKEY hKey, LPCSTR lpSubKey)
		extrn RegDeleteKeyA:dword ; CODE XREF: sub_401E00+2Bp
					; DATA XREF: sub_401E00+2Br
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_401E50+52p
					; DATA XREF: sub_401E50+52r

;
; Imports from COMCTL32.dll
;
; void __stdcall InitCommonControls()
		extrn InitCommonControls:dword ; CODE XREF: WinMain(x,x,x,x)+Fp
					; DATA XREF: WinMain(x,x,x,x)+Fr ...

;
; Imports from GDI32.dll
;
; COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color)
		extrn SetTextColor:dword ; CODE	XREF: DialogFunc+62p
					; DATA XREF: DialogFunc+62r ...
; HBRUSH __stdcall CreateSolidBrush(COLORREF color)
		extrn CreateSolidBrush:dword ; CODE XREF: DialogFunc+69p
					; DATA XREF: DialogFunc+69r
; COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color)
		extrn SetBkColor:dword	; CODE XREF: DialogFunc+56p
					; DATA XREF: DialogFunc+56r

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn GetVersionExA:dword ; CODE XREF: sub_401C40+21p
					; DATA XREF: sub_401C40+21r ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_401C40+38p
					; _doexit+15p
					; DATA XREF: ...
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	sub_401EF0+B3p
					; DATA XREF: sub_401EF0+B3r
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_4022F0+164p
					; sub_4022F0+1A1p
					; DATA XREF: ...
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_402190+1Cp
					; DATA XREF: sub_402190+1Cr
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_401AD0+96p
					; sub_401EF0+114p ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: DialogFunc+186p
					; DATA XREF: DialogFunc+186r
; BOOL __stdcall ReleaseSemaphore(HANDLE hSemaphore, LONG lReleaseCount, LPLONG	lpPreviousCount)
		extrn ReleaseSemaphore:dword ; CODE XREF: StartAddress+2Ap
					; DATA XREF: StartAddress+2Ar
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_401470+5Cp
					; sub_402510+36p ...
; HANDLE __stdcall CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCSTR	lpName)
		extrn CreateSemaphoreA:dword ; CODE XREF: sub_401AD0+64p
					; DATA XREF: sub_401AD0+64r
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_401AD0+8Cp
					; sub_401EF0+109p ...
; BOOL __stdcall RemoveDirectoryA(LPCSTR lpPathName)
		extrn RemoveDirectoryA:dword ; CODE XREF: __rmdir+4p
					; DATA XREF: __rmdir+4r
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
		extrn SetEnvironmentVariableA:dword ; CODE XREF: ___crtsetenv+173p
					; DATA XREF: ___crtsetenv+173r
; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, PCNZWCH lpString1, int cchCount1,	PCNZWCH	lpString2, int cchCount2)
		extrn CompareStringW:dword ; CODE XREF:	___crtCompareStringA+3Ep
					; ___crtCompareStringA+261p
					; DATA XREF: ...
; int __stdcall	CompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1,	int cchCount1, PCNZCH lpString2, int cchCount2)
		extrn CompareStringA:dword ; CODE XREF:	___crtCompareStringA+5Bp
					; ___crtCompareStringA+B9p
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtLCMapStringA+DFp
					; ___crtLCMapStringA+137p ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: ___crtMessageBoxA+12p
					; DATA XREF: ___crtMessageBoxA+12r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	___crtMessageBoxA+2Ap
					; ___crtMessageBoxA+3Bp ...
; BOOL __stdcall SetEndOfFile(HANDLE hFile)
		extrn SetEndOfFile:dword ; CODE	XREF: __chsize_lk+DDp
					; DATA XREF: __chsize_lk+DDr
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+51p
					; _setSBUpLow+14p ...
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
		extrn InterlockedDecrement:dword ; CODE	XREF: _wctomb+23p
					; _wctomb+4Fp
					; DATA XREF: ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: __sopen+1B3p
					; DATA XREF: __sopen+1B3r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: __mkdir+10p _remove+Ep ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: __mkdir+6p
					; DATA XREF: __mkdir+6r
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+40p
					; ___sbh_free_block+2C4p ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+45p
					; ___sbh_heap_init+Dp ...
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; CODE XREF:	_time+6Cp
					; __tzset_lk+4Ep
					; DATA XREF: ...
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
		extrn GetSystemTime:dword ; CODE XREF: _time+17p
					; DATA XREF: _time+17r
; void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime)
		extrn GetLocalTime:dword ; CODE	XREF: _time+Dp
					; DATA XREF: _time+Dr
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: _remove+4p
					; DATA XREF: _remove+4r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: __mtinit+3Fp
					; __getptd+45p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: start+D4p
					; DATA XREF: start+D4r
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+B1p
					; __ioinit+5Ep
					; DATA XREF: ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: start+86p
					; DATA XREF: start+86r
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _fast_error_exit+1Dp
					; _doexit+9Dp
					; DATA XREF: ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: __lock_file+28p
					; __lock_file2+1Cp ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: __unlock_file+28p
					; __unlock_file2+1Cp ...
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: __read_lk+7Ap
					; __read_lk+14Ap
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: __getstream+84p
					; __mtinitlocks+Dp ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	__lseek_lk+2Ap
					; DATA XREF: __lseek_lk+2Ar
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; DATA XREF: __heap_init+2Fr
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: ___sbh_free_block+257p
					; ___sbh_free_block+2B2p
					; DATA XREF: ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: __fcloseall+4Dp
					; DATA XREF: __fcloseall+4Dr
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+1Cp
					; DATA XREF: _doexit+1Cr
; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
		extrn InterlockedIncrement:dword ; CODE	XREF: _wctomb+Cp
					; DATA XREF: _wctomb+Cr
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: ___sbh_alloc_new_region+28p
					; _realloc+108p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __write_lk+C7p
					; __write_lk+12Cp ...
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn TlsSetValue:dword	; CODE XREF: __mtinit+2Ep __getptd+34p
					; DATA XREF: ...
; DWORD	__stdcall TlsAlloc()
		extrn TlsAlloc:dword	; CODE XREF: __mtinit+6p
					; DATA XREF: __mtinit+6r
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: __getptd+5Cp
					; DATA XREF: __getptd+5Cr
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: __getptd+10p
					; DATA XREF: __getptd+10r
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+134p
					; DATA XREF: __XcptFilter+134r
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+16Cp
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+93p
					; ___crtGetEnvironmentStringsA+B5p ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_405B99p
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+1B1p
					; DATA XREF: __ioinit+1B1r
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn SetStdHandle:dword ; CODE	XREF: __set_osfhnd:loc_40647Cp
					; __free_osfhnd:loc_4064FBp
					; DATA XREF: ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+109p
					; __ioinit+17Ap ...
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: __commit+47p
					; DATA XREF: __commit+47r

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_4010E0+2EBp
					; sub_401470+DDp ...
; int __stdcall	LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax)
		extrn LoadStringA:dword	; CODE XREF: sub_4010E0+1D3p
					; sub_4010E0+2CFp ...
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: .text:004016E4p
					; DialogFunc+237p
					; DATA XREF: ...
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: .text:00401725p
					; DialogFunc+278p
					; DATA XREF: ...
; int __stdcall	GetSystemMetrics(int nIndex)
		extrn GetSystemMetrics:dword ; CODE XREF: .text:004016F8p
					; .text:0040170Ep ...
; BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow)
		extrn ShowWindow:dword	; CODE XREF: WinMain(x,x,x,x)+84p
					; DialogFunc+149p ...
; LRESULT __stdcall DefWindowProcA(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn DefWindowProcA:dword ; CODE XREF:	.text:004016CCp
					; DATA XREF: .text:004016CCr
; BOOL __stdcall UpdateWindow(HWND hWnd)
		extrn UpdateWindow:dword ; CODE	XREF: WinMain(x,x,x,x)+8Bp
					; DATA XREF: WinMain(x,x,x,x)+8Br
; LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn SendMessageA:dword ; CODE	XREF: StartAddress+1Cp
					; DialogFunc+F7p ...
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
		extrn CreateWindowExA:dword ; CODE XREF: WinMain(x,x,x,x)+7Ap
					; DATA XREF: WinMain(x,x,x,x)+7Ar
; ATOM __stdcall RegisterClassA(const WNDCLASSA	*lpWndClass)
		extrn RegisterClassA:dword ; CODE XREF:	WinMain(x,x,x,x)+4Cp
					; DATA XREF: WinMain(x,x,x,x)+4Cr
; BOOL __stdcall SetWindowTextA(HWND hWnd, LPCSTR lpString)
		extrn SetWindowTextA:dword ; CODE XREF:	DialogFunc+1C8p
					; DialogFunc+1E3p ...
; BOOL __stdcall SetForegroundWindow(HWND hWnd)
		extrn SetForegroundWindow:dword	; CODE XREF: DialogFunc+27Fp
					; DATA XREF: DialogFunc+27Fr
; UINT_PTR __stdcall SetTimer(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc)
		extrn SetTimer:dword	; CODE XREF: DialogFunc+22Bp
					; DATA XREF: DialogFunc+22Br
; LONG __stdcall SetWindowLongA(HWND hWnd, int nIndex, LONG dwNewLong)
		extrn SetWindowLongA:dword ; CODE XREF:	DialogFunc+16Ep
					; DATA XREF: DialogFunc+16Er
; LRESULT __stdcall SendDlgItemMessageA(HWND hDlg, int nIDDlgItem, UINT	Msg, WPARAM wParam, LPARAM lParam)
		extrn SendDlgItemMessageA:dword	; CODE XREF: DialogFunc+118p
					; DialogFunc+1A4p ...
; BOOL __stdcall ExitWindowsEx(UINT uFlags, DWORD dwReason)
		extrn ExitWindowsEx:dword ; CODE XREF: sub_401C40+93p
					; DATA XREF: sub_401C40+93r
; DWORD	__stdcall GetWindowThreadProcessId(HWND	hWnd, LPDWORD lpdwProcessId)
		extrn GetWindowThreadProcessId:dword ; CODE XREF: sub_4022F0+156p
					; sub_4022F0+193p
					; DATA XREF: ...
; HWND __stdcall FindWindowA(LPCSTR lpClassName, LPCSTR	lpWindowName)
		extrn FindWindowA:dword	; CODE XREF: sub_4022F0+141p
					; sub_4022F0+183p
					; DATA XREF: ...
; DWORD	__stdcall GetSysColor(int nIndex)
		extrn GetSysColor:dword	; CODE XREF: DialogFunc+50p
					; DialogFunc+5Ep
					; DATA XREF: ...
; INT_PTR __stdcall DialogBoxParamA(HINSTANCE hInstance, LPCSTR	lpTemplateName,	HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam)
		extrn DialogBoxParamA:dword ; CODE XREF: sub_401AD0+80p
					; DATA XREF: sub_401AD0+80r
; BOOL __stdcall EndDialog(HWND	hDlg, INT_PTR nResult)
		extrn EndDialog:dword	; CODE XREF: DialogFunc+2Bp
					; DATA XREF: DialogFunc+2Br ...
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; CODE XREF: DialogFunc:loc_401920p
					; DialogFunc+1E0p ...
; LONG __stdcall GetWindowLongA(HWND hWnd, int nIndex)
		extrn GetWindowLongA:dword ; CODE XREF:	DialogFunc+9Ap
					; DialogFunc+13Ep
					; DATA XREF: ...
; BOOL __stdcall IsWindowEnabled(HWND hWnd)
		extrn IsWindowEnabled:dword ; CODE XREF: DialogFunc+ACp
					; DATA XREF: DialogFunc+ACr


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4091D0h
stru_4091D0	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_402D43, offset loc_402D57>
					; DATA XREF: start+5o
					; SEH scope table for function 402C5A
byte_4091DC	db 6			; DATA XREF: __output:loc_404A41r
		db 2 dup(0), 6
		dd 100h, 6030010h, 10020600h, 45454504h, 5050505h, 303505h
		dd 50h,	38282000h, 8075850h, 30303700h,	75057h,	8202000h
		dd 0
		db 8,'`h````',0
		dd 78707000h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
		dd 8
aNull_0:				; DATA XREF: .data:off_40B644o
		unicode	0, <(null)>,0
		align 4
aNull		db '(null)',0           ; DATA XREF: .data:off_40B640o
		align 10h
aRuntimeError	db 'runtime error ',0
		align 10h
		db 0Dh,0Ah,0
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0
		align 4
aSingError	db 'SING error',0Dh,0Ah,0
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 4
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 4
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 4
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 4
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 4
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 4
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_40B714o
		db '- floating point not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_409504[]
asc_409504	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char a___[]
a___		db '...',0              ; DATA XREF: __NMSG_WRITE+BFo
; char aProgramNameUnk[]
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 10h
aSunmontuewedth	db 'SunMonTueWedThuFriSat',0
		align 4
aJanfebmaraprma	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
		align 10h
; char aTz[3]
aTz		db 'TZ',0               ; DATA XREF: __tzset_lk+2Ao
		align 4
; CHAR aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; CHAR aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; CHAR ProcName[]
ProcName	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 10h
; CHAR String1[4]
String1		db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o ...
; const	WCHAR String2
String2		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o ...
		align 4
stru_4095C8	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_407F91, offset loc_407F95>
					; DATA XREF: ___crtLCMapStringA+5o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_408045, offset loc_408049> ; SEH scope table for function 407E81
stru_4095E0	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_40819E, offset loc_4081A2>
					; DATA XREF: ___crtGetStringTypeA+5o
					; SEH scope table for function 4080A5
aHMmSs		db 'H:mm:ss',0          ; DATA XREF: .data:0040BDC0o
aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:0040BDBCo
aMDYy		db 'M/d/yy',0           ; DATA XREF: .data:0040BDB8o
		align 10h
aPm		db 'PM',0               ; DATA XREF: .data:0040BDB4o
		align 4
aAm		db 'AM',0               ; DATA XREF: .data:0040BDB0o
		align 4
aDecember	db 'December',0         ; DATA XREF: .data:0040BDACo
		align 4
aNovember	db 'November',0         ; DATA XREF: .data:0040BDA8o
		align 10h
aOctober	db 'October',0          ; DATA XREF: .data:0040BDA4o
aSeptember	db 'September',0        ; DATA XREF: .data:0040BDA0o
		align 4
aAugust		db 'August',0           ; DATA XREF: .data:0040BD9Co
		align 4
aJuly		db 'July',0             ; DATA XREF: .data:0040BD98o
		align 4
aJune		db 'June',0             ; DATA XREF: .data:0040BD94o
		align 4
aApril		db 'April',0            ; DATA XREF: .data:0040BD8Co
		align 4
aMarch		db 'March',0            ; DATA XREF: .data:0040BD88o
		align 4
aFebruary	db 'February',0         ; DATA XREF: .data:0040BD84o
		align 4
aJanuary	db 'January',0          ; DATA XREF: .data:0040BD80o
aDec		db 'Dec',0              ; DATA XREF: .data:0040BD7Co
aNov		db 'Nov',0              ; DATA XREF: .data:0040BD78o
aOct		db 'Oct',0              ; DATA XREF: .data:0040BD74o
aSep		db 'Sep',0              ; DATA XREF: .data:0040BD70o
aAug		db 'Aug',0              ; DATA XREF: .data:0040BD6Co
aJul		db 'Jul',0              ; DATA XREF: .data:0040BD68o
aJun		db 'Jun',0              ; DATA XREF: .data:0040BD64o
aMay		db 'May',0              ; DATA XREF: .data:0040BD60o
					; .data:0040BD90o
aApr		db 'Apr',0              ; DATA XREF: .data:0040BD5Co
aMar		db 'Mar',0              ; DATA XREF: .data:0040BD58o
aFeb		db 'Feb',0              ; DATA XREF: .data:0040BD54o
aJan		db 'Jan',0              ; DATA XREF: .data:0040BD50o
aSaturday	db 'Saturday',0         ; DATA XREF: .data:0040BD4Co
		align 4
aFriday		db 'Friday',0           ; DATA XREF: .data:0040BD48o
		align 4
aThursday	db 'Thursday',0         ; DATA XREF: .data:0040BD44o
		align 10h
aWednesday	db 'Wednesday',0        ; DATA XREF: .data:0040BD40o
		align 4
aTuesday	db 'Tuesday',0          ; DATA XREF: .data:0040BD3Co
aMonday		db 'Monday',0           ; DATA XREF: .data:0040BD38o
		align 4
aSunday		db 'Sunday',0           ; DATA XREF: .data:0040BD34o
		align 4
aSat		db 'Sat',0              ; DATA XREF: .data:0040BD30o
aFri		db 'Fri',0              ; DATA XREF: .data:0040BD2Co
aThu		db 'Thu',0              ; DATA XREF: .data:0040BD28o
aWed		db 'Wed',0              ; DATA XREF: .data:0040BD24o
aTue		db 'Tue',0              ; DATA XREF: .data:0040BD20o
aMon		db 'Mon',0              ; DATA XREF: .data:0040BD1Co
aSun		db 'Sun',0              ; DATA XREF: .data:off_40BD18o
stru_409710	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_408828, offset loc_40882C>
					; DATA XREF: ___crtCompareStringA+5o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_408897, offset loc_40889B> ; SEH scope table for function 408671
__IMPORT_DESCRIPTOR_COMCTL32 dd	rva dword_4097CC ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aComctl32_dll	; DLL Name
		dd rva InitCommonControls ; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_4097E4 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva GetVersionExA	; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_409908 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva MessageBoxA	; Import Address Table
__IMPORT_DESCRIPTOR_GDI32 dd rva off_4097D4 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aGdi32_dll	; DLL Name
		dd rva SetTextColor	; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_4097A0 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegSetValueExA	; Import Address Table
		align 20h
;
; Import names for ADVAPI32.dll
;
off_4097A0	dd rva word_409C94	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_409C42
		dd rva word_409C5A
		dd rva word_409C72
		dd rva word_409C86
		dd rva word_409CA6
		dd rva word_409CB8
		dd rva word_409CCA
		dd rva word_409CDA
		dd rva word_409CEA
		dd 0
;
; Import names for COMCTL32.dll
;
dword_4097CC	dd 80000011h		; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_COMCTL32o
		dd 0
;
; Import names for GDI32.dll
;
off_4097D4	dd rva word_409C1A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_GDI32o
		dd rva word_409C06
		dd rva word_409C2A
		dd 0
;
; Import names for KERNEL32.dll
;
off_4097E4	dd rva word_409A04	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_4099F0
		dd rva word_409A14
		dd rva word_409A36
		dd rva word_409A26
		dd rva word_4099B8
		dd rva word_4099A8
		dd rva word_409994
		dd rva word_40997E
		dd rva word_4099DC
		dd rva word_4099C6
		dd rva word_409D90
		dd rva word_409EA4
		dd rva word_40A138
		dd rva word_40A126
		dd rva word_40A114
		dd rva word_40A0F0
		dd rva word_40A0E0
		dd rva word_40A102
		dd rva word_40A0BA
		dd rva word_40A0D0
		dd rva word_40A09A
		dd rva word_40A088
		dd rva word_40A0AA
		dd rva word_40A072
		dd rva word_40A066
		dd rva word_40A07C
		dd rva word_40A036
		dd rva word_40A028
		dd rva word_409D0C
		dd rva word_409D1C
		dd rva word_409D30
		dd rva word_409D3C
		dd rva word_409D48
		dd rva word_409D62
		dd rva word_409D72
		dd rva word_409D82
		dd rva word_409ECE
		dd rva word_409DA4
		dd rva word_409DB8
		dd rva word_409DCA
		dd rva word_409DDC
		dd rva word_409DEA
		dd rva word_409DF8
		dd rva word_409E10
		dd rva word_409E28
		dd rva word_409E34
		dd rva word_409E50
		dd rva word_409E62
		dd rva word_409E70
		dd rva word_409E7E
		dd rva word_409E8C
		dd rva word_409F1C
		dd rva word_40A04E
		dd rva word_409EB4
		dd rva word_409EC2
		dd rva word_409F66
		dd rva word_409EE4
		dd rva word_409EF2
		dd rva word_409EFE
		dd rva word_409F0E
		dd rva word_409FAE
		dd rva word_409F30
		dd rva word_409F4C
		dd rva word_409FDA
		dd rva word_409F80
		dd rva word_409F96
		dd rva word_409FC8
		dd rva word_40A004
		dd rva word_409FEA
		dd rva word_409FF8
		dd rva word_40A014
		dd 0
;
; Import names for USER32.dll
;
off_409908	dd rva word_409A52	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_409A60
		dd rva word_409A92
		dd rva word_409A6E
		dd rva word_409A7E
		dd rva word_409AC4
		dd rva word_409AA2
		dd rva word_409AB4
		dd rva word_409AF6
		dd rva word_409AD2
		dd rva word_409AE4
		dd rva word_409B28
		dd rva word_409B06
		dd rva word_409B1C
		dd rva word_409B3A
		dd rva word_409B4C
		dd rva word_409BC0
		dd rva word_409BDE
		dd rva word_409BD0
		dd rva word_409B94
		dd rva word_409BAE
		dd rva word_409BA2
		dd rva word_409B62
		dd rva word_409B82
		dd rva word_409B70
		dd 0
aComctl32_dll	db 'COMCTL32.dll',0     ; DATA XREF: .rdata:00409734o
		align 2
word_40997E	dw 138h			; DATA XREF: .rdata:00409804o
		db 'GetModuleFileNameA',0
		align 4
word_409994	dw 24Ah			; DATA XREF: .rdata:00409800o
		db 'ReleaseSemaphore',0
		align 4
word_4099A8	dw 4Dh			; DATA XREF: .rdata:004097FCo
		db 'CreateThread',0
		align 4
word_4099B8	dw 1Eh			; DATA XREF: .rdata:004097F8o
		db 'CloseHandle',0
word_4099C6	dw 2FDh			; DATA XREF: .rdata:0040980Co
		db 'WaitForSingleObject',0
word_4099DC	dw 4Ah			; DATA XREF: .rdata:00409808o
		db 'CreateSemaphoreA',0
		align 10h
word_4099F0	dw 109h			; DATA XREF: .rdata:004097E8o
		db 'GetCurrentProcess',0
word_409A04	dw 18Fh			; DATA XREF: .rdata:off_4097E4o
		db 'GetVersionExA',0
word_409A14	dw 47h			; DATA XREF: .rdata:004097ECo
		db 'CreateProcessA',0
		align 2
word_409A26	dw 17Eh			; DATA XREF: .rdata:004097F4o
		db 'GetTempPathA',0
		align 2
word_409A36	dw 211h			; DATA XREF: .rdata:004097F0o
		db 'OpenProcess',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:00409748o
		align 2
word_409A52	dw 1C3h			; DATA XREF: .rdata:off_409908o
		db 'MessageBoxA',0
word_409A60	dw 1AFh			; DATA XREF: .rdata:0040990Co
		db 'LoadStringA',0
word_409A6E	dw 260h			; DATA XREF: .rdata:00409914o
		db 'SetWindowPos',0
		align 2
word_409A7E	dw 149h			; DATA XREF: .rdata:00409918o
		db 'GetSystemMetrics',0
		align 2
word_409A92	dw 160h			; DATA XREF: .rdata:00409910o
		db 'GetWindowRect',0
word_409AA2	dw 86h			; DATA XREF: .rdata:00409920o
		db 'DefWindowProcA',0
		align 4
word_409AB4	dw 296h			; DATA XREF: .rdata:00409924o
		db 'UpdateWindow',0
		align 4
word_409AC4	dw 26Fh			; DATA XREF: .rdata:0040991Co
		db 'ShowWindow',0
		align 2
word_409AD2	dw 5Ah			; DATA XREF: .rdata:0040992Co
		db 'CreateWindowExA',0
word_409AE4	dw 1F6h			; DATA XREF: .rdata:00409930o
		db 'RegisterClassA',0
		align 2
word_409AF6	dw 218h			; DATA XREF: .rdata:00409928o
		db 'SendMessageA',0
		align 2
word_409B06	dw 234h			; DATA XREF: .rdata:00409938o
		db 'SetForegroundWindow',0
word_409B1C	dw 257h			; DATA XREF: .rdata:0040993Co
		db 'SetTimer',0
		align 4
word_409B28	dw 263h			; DATA XREF: .rdata:00409934o
		db 'SetWindowTextA',0
		align 2
word_409B3A	dw 25Dh			; DATA XREF: .rdata:00409940o
		db 'SetWindowLongA',0
		align 4
word_409B4C	dw 213h			; DATA XREF: .rdata:00409944o
		db 'SendDlgItemMessageA',0
word_409B62	dw 105h			; DATA XREF: .rdata:00409960o
		db 'GetDlgItem',0
		align 10h
word_409B70	dw 194h			; DATA XREF: .rdata:00409968o
		db 'IsWindowEnabled',0
word_409B82	dw 15Ah			; DATA XREF: .rdata:00409964o
		db 'GetWindowLongA',0
		align 4
word_409B94	dw 146h			; DATA XREF: .rdata:00409954o
		db 'GetSysColor',0
word_409BA2	dw 0BBh			; DATA XREF: .rdata:0040995Co
		db 'EndDialog',0
word_409BAE	dw 95h			; DATA XREF: .rdata:00409958o
		db 'DialogBoxParamA',0
word_409BC0	dw 0D5h			; DATA XREF: .rdata:00409948o
		db 'ExitWindowsEx',0
word_409BD0	dw 0D7h			; DATA XREF: .rdata:00409950o
		db 'FindWindowA',0
word_409BDE	dw 166h			; DATA XREF: .rdata:0040994Co
		db 'GetWindowThreadProcessId',0
		align 2
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:0040975Co
		align 2
word_409C06	dw 4Eh			; DATA XREF: .rdata:004097D8o
		db 'CreateSolidBrush',0
		align 2
word_409C1A	dw 1FAh			; DATA XREF: .rdata:off_4097D4o
		db 'SetTextColor',0
		align 2
word_409C2A	dw 1D4h			; DATA XREF: .rdata:004097DCo
		db 'SetBkColor',0
		align 4
aGdi32_dll	db 'GDI32.dll',0        ; DATA XREF: .rdata:00409770o
word_409C42	dw 19h			; DATA XREF: .rdata:004097A4o
		db 'AdjustTokenPrivileges',0
word_409C5A	dw 118h			; DATA XREF: .rdata:004097A8o
		db 'LookupPrivilegeValueA',0
word_409C72	dw 167h			; DATA XREF: .rdata:004097ACo
		db 'OpenProcessToken',0
		align 2
word_409C86	dw 184h			; DATA XREF: .rdata:004097B0o
		db 'RegCloseKey',0
word_409C94	dw 1B2h			; DATA XREF: .rdata:off_4097A0o
		db 'RegSetValueExA',0
		align 2
word_409CA6	dw 188h			; DATA XREF: .rdata:004097B4o
		db 'RegCreateKeyExA',0
word_409CB8	dw 18Dh			; DATA XREF: .rdata:004097B8o
		db 'RegDeleteValueA',0
word_409CCA	dw 19Dh			; DATA XREF: .rdata:004097BCo
		db 'RegOpenKeyExA',0
word_409CDA	dw 18Bh			; DATA XREF: .rdata:004097C0o
		db 'RegDeleteKeyA',0
word_409CEA	dw 1A7h			; DATA XREF: .rdata:004097C4o
		db 'RegQueryValueExA',0
		align 2
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:00409784o
		align 4
word_409D0C	dw 12Dh			; DATA XREF: .rdata:00409858o
		db 'GetLastError',0
		align 4
word_409D1C	dw 30h			; DATA XREF: .rdata:0040985Co
		db 'CreateDirectoryA',0
		align 10h
word_409D30	dw 1BAh			; DATA XREF: .rdata:00409860o
		db 'HeapFree',0
		align 4
word_409D3C	dw 1B4h			; DATA XREF: .rdata:00409864o
		db 'HeapAlloc',0
word_409D48	dw 189h			; DATA XREF: .rdata:00409868o
		db 'GetTimeZoneInformation',0
		align 2
word_409D62	dw 174h			; DATA XREF: .rdata:0040986Co
		db 'GetSystemTime',0
word_409D72	dw 12Fh			; DATA XREF: .rdata:00409870o
		db 'GetLocalTime',0
		align 2
word_409D82	dw 5Ch			; DATA XREF: .rdata:00409874o
		db 'DeleteFileA',0
word_409D90	dw 24Bh			; DATA XREF: .rdata:00409810o
		db 'RemoveDirectoryA',0
		align 4
word_409DA4	dw 13Ah			; DATA XREF: .rdata:0040987Co
		db 'GetModuleHandleA',0
		align 4
word_409DB8	dw 166h			; DATA XREF: .rdata:00409880o
		db 'GetStartupInfoA',0
word_409DCA	dw 0DAh			; DATA XREF: .rdata:00409884o
		db 'GetCommandLineA',0
word_409DDC	dw 18Eh			; DATA XREF: .rdata:00409888o
		db 'GetVersion',0
		align 2
word_409DEA	dw 8Ch			; DATA XREF: .rdata:0040988Co
		db 'ExitProcess',0
word_409DF8	dw 6Fh			; DATA XREF: .rdata:00409890o
		db 'EnterCriticalSection',0
		align 10h
word_409E10	dw 1DEh			; DATA XREF: .rdata:00409894o
		db 'LeaveCriticalSection',0
		align 4
word_409E28	dw 23Dh			; DATA XREF: .rdata:00409898o
		db 'ReadFile',0
		align 4
word_409E34	dw 1C5h			; DATA XREF: .rdata:0040989Co
		db 'InitializeCriticalSection',0
word_409E50	dw 295h			; DATA XREF: .rdata:004098A0o
		db 'SetFilePointer',0
		align 2
word_409E62	dw 1B8h			; DATA XREF: .rdata:004098A4o
		db 'HeapDestroy',0
word_409E70	dw 1B6h			; DATA XREF: .rdata:004098A8o
		db 'HeapCreate',0
		align 2
word_409E7E	dw 2F1h			; DATA XREF: .rdata:004098ACo
		db 'VirtualFree',0
word_409E8C	dw 5Ah			; DATA XREF: .rdata:004098B0o
		db 'DeleteCriticalSection',0
word_409EA4	dw 2EEh			; DATA XREF: .rdata:00409814o
		db 'VirtualAlloc',0
		align 4
word_409EB4	dw 1BDh			; DATA XREF: .rdata:004098BCo
		db 'HeapReAlloc',0
word_409EC2	dw 30Eh			; DATA XREF: .rdata:004098C0o
		db 'WriteFile',0
word_409ECE	dw 10Ch			; DATA XREF: .rdata:00409878o
		db 'GetCurrentThreadId',0
		align 4
word_409EE4	dw 2D3h			; DATA XREF: .rdata:004098C8o
		db 'TlsSetValue',0
word_409EF2	dw 2D0h			; DATA XREF: .rdata:004098CCo
		db 'TlsAlloc',0
		align 2
word_409EFE	dw 29Ch			; DATA XREF: .rdata:004098D0o
		db 'SetLastError',0
		align 2
word_409F0E	dw 2D2h			; DATA XREF: .rdata:004098D4o
		db 'TlsGetValue',0
word_409F1C	dw 2CBh			; DATA XREF: .rdata:004098B4o
		db 'TerminateProcess',0
		align 10h
word_409F30	dw 2DBh			; DATA XREF: .rdata:004098DCo
		db 'UnhandledExceptionFilter',0
		align 4
word_409F4C	dw 0C1h			; DATA XREF: .rdata:004098E0o
		db 'FreeEnvironmentStringsA',0
word_409F66	dw 0C2h			; DATA XREF: .rdata:004098C4o
		db 'FreeEnvironmentStringsW',0
word_409F80	dw 301h			; DATA XREF: .rdata:004098E8o
		db 'WideCharToMultiByte',0
word_409F96	dw 119h			; DATA XREF: .rdata:004098ECo
		db 'GetEnvironmentStrings',0
word_409FAE	dw 11Bh			; DATA XREF: .rdata:004098D8o
		db 'GetEnvironmentStringsW',0
		align 4
word_409FC8	dw 298h			; DATA XREF: .rdata:004098F0o
		db 'SetHandleCount',0
		align 2
word_409FDA	dw 168h			; DATA XREF: .rdata:004098E4o
		db 'GetStdHandle',0
		align 2
word_409FEA	dw 128h			; DATA XREF: .rdata:004098F8o
		db 'GetFileType',0
word_409FF8	dw 257h			; DATA XREF: .rdata:004098FCo
		db 'RtlUnwind',0
word_40A004	dw 2A8h			; DATA XREF: .rdata:004098F4o
		db 'SetStdHandle',0
		align 4
word_40A014	dw 0B9h			; DATA XREF: .rdata:00409900o
		db 'FlushFileBuffers',0
		align 4
word_40A028	dw 37h			; DATA XREF: .rdata:00409854o
		db 'CreateFileA',0
word_40A036	dw 1C8h			; DATA XREF: .rdata:00409850o
		db 'InterlockedDecrement',0
		align 2
word_40A04E	dw 1CBh			; DATA XREF: .rdata:004098B8o
		db 'InterlockedIncrement',0
		align 2
word_40A066	dw 0CFh			; DATA XREF: .rdata:00409848o
		db 'GetCPInfo',0
word_40A072	dw 0C9h			; DATA XREF: .rdata:00409844o
		db 'GetACP',0
		align 4
word_40A07C	dw 146h			; DATA XREF: .rdata:0040984Co
		db 'GetOEMCP',0
		align 4
word_40A088	dw 153h			; DATA XREF: .rdata:0040983Co
		db 'GetProcAddress',0
		align 2
word_40A09A	dw 1DFh			; DATA XREF: .rdata:00409838o
		db 'LoadLibraryA',0
		align 2
word_40A0AA	dw 28Ch			; DATA XREF: .rdata:00409840o
		db 'SetEndOfFile',0
		align 2
word_40A0BA	dw 202h			; DATA XREF: .rdata:00409830o
		db 'MultiByteToWideChar',0
word_40A0D0	dw 1DCh			; DATA XREF: .rdata:00409834o
		db 'LCMapStringA',0
		align 10h
word_40A0E0	dw 1DDh			; DATA XREF: .rdata:00409828o
		db 'LCMapStringW',0
		align 10h
word_40A0F0	dw 169h			; DATA XREF: .rdata:00409824o
		db 'GetStringTypeA',0
		align 2
word_40A102	dw 16Ch			; DATA XREF: .rdata:0040982Co
		db 'GetStringTypeW',0
		align 4
word_40A114	dw 24h			; DATA XREF: .rdata:00409820o
		db 'CompareStringA',0
		align 2
word_40A126	dw 25h			; DATA XREF: .rdata:0040981Co
		db 'CompareStringW',0
		align 4
word_40A138	dw 28Dh			; DATA XREF: .rdata:00409818o
		db 'SetEnvironmentVariableA',0
		align 1000h
_rdata		ends

; Section 3. (virtual address 0000B000)
; Virtual size			: 00002508 (   9480.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0000B000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 40B000h
dword_40B000	dd 0			; DATA XREF: __cinit+1Fo
dword_40B004	dd 0			; DATA XREF: __cinit+1Ao
dword_40B008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initstdio
		dd offset ___initmbctable
dword_40B014	dd 0			; DATA XREF: __cinit:loc_40557Fo
dword_40B018	dd 0			; DATA XREF: _doexit+6Ao
		dd offset ___endstdio
dword_40B020	dd 0			; DATA XREF: _doexit:loc_405628o
dword_40B024	dd 0			; DATA XREF: _doexit+7Bo
dword_40B028	dd 2 dup(0)		; DATA XREF: _doexit:loc_405639o
; char aWb[3]
aWb		db 'wb',0               ; DATA XREF: sub_4010E0+157o
					; sub_4010E0+250o ...
		align 4
aPgpsea		db 'PGPSEA',0           ; DATA XREF: sub_401470+97o
		align 4
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_401470+69o
		align 10h
; CHAR WindowName[]
WindowName	db 'PGPsda_Hidden_Window',0 ; DATA XREF: WinMain(x,x,x,x)+44o
					; WinMain(x,x,x,x)+6Fo	...
		align 4
; CHAR Name[]
Name		db 'SeShutdownPrivilege',0 ; DATA XREF: sub_401C40+4Ao
; CHAR ValueName[]
ValueName	db 'Run PGP SEA Installer on Reboot',0 ; DATA XREF: sub_401CE0+45o
					; sub_401D50+25o
; CHAR SubKey[]
SubKey		db 'SOFTWARE\Microsoft\Windows\CurrentVersion\Run',0
					; DATA XREF: sub_401CE0+1Ao
					; sub_401D50+Do
		align 4
; CHAR aReboot[]
aReboot		db 'Reboot',0           ; DATA XREF: sub_401DA0+2Fo
					; sub_401E50+44o
		align 4
; CHAR aSoftwareNetwor[]
aSoftwareNetwor	db 'Software\Network Associates\PGP',0 ; DATA XREF: sub_401DA0+Do
					; sub_401E50+17o
; CHAR aPgp[]
aPgp		db 'PGP',0              ; DATA XREF: sub_401E00+25o
					; sub_402190+5Ao
; CHAR aSoftwareNetw_0[]
aSoftwareNetw_0	db 'Software\Network Associates',0 ; DATA XREF: sub_401E00+Do
asc_40B104	db '\',0                ; DATA XREF: sub_402190+AEo
		align 4
; char asc_40B108[]
asc_40B108	db '%x',0               ; DATA XREF: sub_402190+4Co
		align 4
; CHAR aIsdelete[]
aIsdelete	db 'isdelete',0         ; DATA XREF: sub_4022F0+17Eo
		align 4
; CHAR ClassName[]
ClassName	db 'InstallShield_Win',0 ; DATA XREF: sub_4022F0+13Co
		align 4
aSetup_exe	db 'Setup.exe',0        ; DATA XREF: sub_4022F0+124o
		align 4
aSetup_ini	db 'setup.ini',0        ; DATA XREF: sub_4022F0+109o
		align 4
aPgpnet_dat	db 'PGPnet.dat',0       ; DATA XREF: sub_4022F0+E2o
		align 10h
aPgpclient_dat	db 'PGPclient.dat',0    ; DATA XREF: sub_4022F0+C6o
		align 10h
aPgpadmin_dat	db 'PGPadmin.dat',0     ; DATA XREF: sub_4022F0+A2o
		align 10h
aDisk1		db 'Disk1\',0           ; DATA XREF: sub_4022F0+5Fo
		align 10h
off_40B180	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_40B184	dd 2			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r ...
off_40B188	dd offset dword_40C500	; DATA XREF: ___initstdio+55o
					; __lock_file+4o ...
		dd 0
		dd offset dword_40C500
		dd 101h
dword_40B198	dd 2 dup(0)		; DATA XREF: ___initstdio+72o
		dd 1000h, 0
dword_40B1A8	dd 3 dup(0)		; DATA XREF: __flsbuf+50o
		dd 2, 1, 3 dup(0)
dword_40B1C8	dd 3 dup(0)		; DATA XREF: __flsbuf+58o
		dd 2 dup(2), 7 dup(0)
dword_40B1F8	dd 7Ch dup(0)		; DATA XREF: ___initstdio+9Eo
dword_40B3E8	dd 8 dup(0)		; DATA XREF: __lock_file+Do
					; __unlock_file+Do
dword_40B408	dd 2 dup(0)		; DATA XREF: ___initstdio+69o
dword_40B410	dd 1			; DATA XREF: __dosmaperr+Eo
dword_40B414	dd 16h			; DATA XREF: __dosmaperr+3Er
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
dword_40B578	dd 10h			; DATA XREF: __dosmaperr+1Bo
; LPCRITICAL_SECTION dword_40B57C
dword_40B57C	dd 0			; DATA XREF: __lock+7r	__unlock+6r
; LPCRITICAL_SECTION off_40B580
off_40B580	dd offset dword_40BE38	; DATA XREF: __mtinitlocks+1Fr
		align 20h
; LPCRITICAL_SECTION off_40B5A0
off_40B5A0	dd offset dword_40BE68	; DATA XREF: __mtinitlocks+17r
		align 10h
; LPCRITICAL_SECTION off_40B5B0
off_40B5B0	dd offset dword_40BE80	; DATA XREF: __mtinitlocks+Fr
		align 10h
; LPCRITICAL_SECTION lpCriticalSection
lpCriticalSection dd offset dword_40BE50 ; DATA	XREF: __mtinitlocks+7r
		dd 1Eh dup(0)
dword_40B63C	dd 3F8h			; DATA XREF: __heap_alloc+5r
					; _calloc+27r ...
; char *off_40B640
off_40B640	dd offset aNull		; DATA XREF: __output:loc_404D4Er
					; __output+457r
					; "(null)"
off_40B644	dd offset aNull_0	; DATA XREF: __output+259r
					; "(null)"
; DWORD	dwTlsIndex
dwTlsIndex	dd 0FFFFFFFFh		; DATA XREF: __mtinit+Fw __mtinit+28r	...
		align 10h
dword_40B650	dd 0C0000005h, 0Bh, 0	; DATA XREF: __initptd+4o
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_40B6C8	dd 3			; DATA XREF: __XcptFilter+62r
					; __XcptFilter+86r
dword_40B6CC	dd 7			; DATA XREF: __XcptFilter+68r
					; __XcptFilter+8Cr
		dd 78h
dword_40B6D4	dd 0Ah			; DATA XREF: _xcptlookup+4r
dword_40B6D8	dd 0FFFFFFFFh, 0A00h, 7	dup(0) ; DATA XREF: __filbuf:loc_402F8Fo
					; __flsbuf:loc_403625o
dword_40B6FC	dd 19930520h, 4	dup(0)	; DATA XREF: .text:00405F27o
					; __NLG_Notify+2o
dword_40B710	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r
off_40B714	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do
					; "R6002\r\n- floating point not loaded\r\"...
		dd 8, 409488h, 9, 40945Ch, 0Ah,	409438h, 10h, 40940Ch
		dd 11h,	4093DCh, 12h, 4093B8h, 13h, 40938Ch, 18h, 409354h
		dd 19h,	40932Ch, 1Ah, 4092F4h, 1Bh, 4092BCh, 1Ch, 409294h
		dd 78h,	409284h, 79h, 409274h, 7Ah, 409264h, 0FCh, 409260h
		dd 0FFh, 409250h
off_40B7A0	dd offset __fptrap	; DATA XREF: __output+3AAr
					; __NMSG_WRITE+1Bo
off_40B7A4	dd offset __fptrap	; DATA XREF: __output+3E2r
		dd offset __fptrap
off_40B7AC	dd offset __fptrap	; DATA XREF: __output+3CBr
		dd offset __fptrap
		dd offset __fptrap
off_40B7B8	dd offset __ctype+2	; DATA XREF: __output:$NORMAL_STATE$1535r
					; _atol+23r ...
		dd offset __ctype+2
		public __ctype
; unsigned __int16 _ctype[]
__ctype		dd    200000h		; DATA XREF: _x_ismbbtype+18r
					; .data:off_40B7B8o ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 43h dup(0)
dword_40B9D0	dd 7080h		; DATA XREF: ___loctotime_t+76r
					; __tzset_lk+75w ...
dword_40B9D4	dd 1			; DATA XREF: ___loctotime_t+98r
					; __tzset_lk+A2w ...
dword_40B9D8	dd 0FFFFF1F0h		; DATA XREF: ___loctotime_t:loc_405564r
					; __tzset_lk+ABw ...
dword_40B9DC	dd 545350h, 0Fh	dup(0)	; DATA XREF: .data:lpMultiByteStro
dword_40BA1C	dd 544450h, 0Fh	dup(0)	; DATA XREF: .data:off_40BA60o
; LPSTR	lpMultiByteStr
lpMultiByteStr	dd offset dword_40B9DC	; DATA XREF: __tzset_lk+D0r
					; __tzset_lk+EFr ...
; LPSTR	off_40BA60
off_40BA60	dd offset dword_40BA1C	; DATA XREF: __tzset_lk+109r
					; __tzset_lk+130r ...
		align 8
dword_40BA68	dd 0FFFFFFFFh		; DATA XREF: __tzset_lk+1Dw
					; __isindst_0+1Er ...
dword_40BA6C	dd 0			; DATA XREF: __isindst_0:loc_4072EFr
					; _cvtdate+BFw
dword_40BA70	dd 0			; DATA XREF: __isindst_0+192r
					; _cvtdate+E0w
		align 8
dword_40BA78	dd 0FFFFFFFFh		; DATA XREF: __tzset_lk+16w
					; __isindst_0+26r ...
dword_40BA7C	dd 0			; DATA XREF: __isindst_0+13Ar
					; _cvtdate+EAw	...
dword_40BA80	dd 0			; DATA XREF: __isindst_0+1A1r
					; _cvtdate+23r	...
dword_40BA84	dd 0FFFFFFFFh		; DATA XREF: _cvtdate+84r
		dd 1Eh,	3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h,	0F3h, 111h, 130h
		dd 14Eh
dword_40BAB4	dd 16Dh			; DATA XREF: ___loctotime_t+2Ar
					; _cvtdate+2Er	...
dword_40BAB8	dd 0FFFFFFFFh		; DATA XREF: _cvtdate:loc_4073F3r
		dd 1Eh,	3Ah, 59h, 77h, 96h, 0B4h, 0D3h,	0F2h, 110h, 12Fh
		dd 14Dh, 16Ch, 0
byte_40BAF0	db 1			; DATA XREF: __setmbcp+EDr
		db 2, 4, 8
		align 8
dword_40BAF8	dd 3A4h			; DATA XREF: __setmbcp+38o
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+129o
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+CCo
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_40BBE8	dd 2 dup(0)		; DATA XREF: __setmbcp+45o
		dd 2 dup(43h), 20h dup(0)
		dd 43h,	20h dup(0)
; int cbMultiByte
cbMultiByte	dd 1			; DATA XREF: __wctomb_lk+31r
					; _atol:loc_407CEEr ...
		dd 2Eh,	1, 2 dup(0)
		dd offset off_40BD18
		align 8
off_40BD18	dd offset aSun		; DATA XREF: .data:0040BD10o
					; "Sun"
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
		dd offset aSunday	; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
		dd offset aJanuary	; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
		dd offset aAm		; "AM"
		dd offset aPm		; "PM"
		dd offset aMDYy		; "M/d/yy"
		dd offset aDdddMmmmDdYyyy ; "dddd, MMMM	dd, yyyy"
		dd offset aHMmSs	; "H:mm:ss"
		align 8
dword_40BDC8	dd 2Eh,	0		; DATA XREF: .data:0040BDD0o
		dd offset dword_40BDC8
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd offset dword_40C168
		dd 2 dup(7F7F7F7Fh), 40BDD0h, 3	dup(0)
dword_40BE10	dd 0			; DATA XREF: _time+5Er	_time+A4w
		align 8
word_40BE18	dw 0			; DATA XREF: _time+55r	_time+9Ao
word_40BE1A	dw 0			; DATA XREF: _time+48r
		db 2 dup(0)
word_40BE1E	dw 0			; DATA XREF: _time+3Br
word_40BE20	dw 0			; DATA XREF: _time+2Er
word_40BE22	dw 0			; DATA XREF: _time+21r
		align 8
; char *dword_40BE28
dword_40BE28	dd 0			; DATA XREF: start+96w
					; __setenvp:loc_405876r ...
		align 10h
dword_40BE30	dd 0			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
dword_40BE34	dd 0			; DATA XREF: __openfile+154w __getbufw
dword_40BE38	dd 6 dup(0)		; DATA XREF: .data:off_40B580o
dword_40BE50	dd 6 dup(0)		; DATA XREF: .data:lpCriticalSectiono
dword_40BE68	dd 6 dup(0)		; DATA XREF: .data:off_40B5A0o
dword_40BE80	dd 6 dup(0)		; DATA XREF: .data:off_40B5B0o
dword_40BE98	dd 0			; DATA XREF: _mallocr
					; _calloc:loc_406215r ...
dword_40BE9C	dd 0			; DATA XREF: __callnewhr
dword_40BEA0	dd 0			; DATA XREF: __sopen+13Ar
dword_40BEA4	dd 0			; DATA XREF: start+52w
dword_40BEA8	dd 0			; DATA XREF: start+49w
dword_40BEAC	dd 0			; DATA XREF: start+3Ew
dword_40BEB0	dd 0			; DATA XREF: start+30w
dword_40BEB4	dd 0			; DATA XREF: __setargv+91w
dword_40BEB8	dd 0			; DATA XREF: __setargv+89w
		align 10h
; void *dword_40BEC0
dword_40BEC0	dd 0			; DATA XREF: __setenvp+44w _getenv+9r	...
dword_40BEC4	dd 0			; DATA XREF: ___crtsetenv+36r
dword_40BEC8	dd 0			; DATA XREF: _getenv+16r
					; ___wtomb_environ+4r ...
		align 10h
dword_40BED0	dd 0			; DATA XREF: __setargv+2Ew
		align 8
byte_40BED8	db 0			; DATA XREF: ___endstdio+5r
					; _doexit+32w
		align 4
dword_40BEDC	dd 0			; DATA XREF: _doexit+2Cw
dword_40BEE0	dd 0			; DATA XREF: _doexit+9r _doexit+97w
; CHAR Filename[260]
Filename	db 104h	dup(0)		; DATA XREF: __setargv:loc_405934o
dword_40BFE8	dd 0			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_40BFEC	dd 0			; DATA XREF: __FF_MSGBANNER+21r
dword_40BFF0	dd 0			; DATA XREF: __openfile+7r
		align 8
dword_40BFF8	dd 0			; DATA XREF: __tzset_lk+24w
					; __tzset_lk+7Aw ...
		align 10h
; struct _TIME_ZONE_INFORMATION	TimeZoneInformation
TimeZoneInformation _TIME_ZONE_INFORMATION <?> ; DATA XREF: __tzset_lk+47o
					; __tzset_lk+5Dr ...
; char *dword_40C0AC
dword_40C0AC	dd ?			; DATA XREF: __tzset_lk+147r
					; __tzset_lk:loc_407074r ...
dword_40C0B0	dd ?			; DATA XREF: ___tzsetr	___tzset+10r ...
dword_40C0B4	dd ?			; DATA XREF: __setmbcp:loc_40766Cr
					; _getSystemCP+4w ...
dword_40C0B8	dd ?			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_40C0BC	dd ?			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_407A1Fr
dword_40C0C0	dd ?			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
dword_40C0C4	dd ?			; DATA XREF: __sopen+3Fr
		dd 3 dup(?)
dword_40C0D4	dd 2 dup(?)		; DATA XREF: __strcmpi+Co
					; __strnicmp+17o
; LCID dword_40C0DC
dword_40C0DC	dd ?			; DATA XREF: __wctomb_lk:loc_406DA0r
					; ___crtGetStringTypeA+7Br ...
		dd 3 dup(?)
; UINT CodePage
CodePage	dd ?			; DATA XREF: __wctomb_lk+43r
					; __tzset_lk+DEr ...
		dd ?
dword_40C0F4	dd ?			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_40C0F8	dd ?			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_40810Fw
		dd 1Bh dup(?)
dword_40C168	dd 2 dup(?)		; DATA XREF: .data:0040BDD4o
					; .data:0040BDD8o ...
dword_40C170	dd ?			; DATA XREF: ___crtCompareStringA+28r
					; ___crtCompareStringA+48w ...
		dd 2 dup(?)
; HINSTANCE hInstance
hInstance	dd ?			; DATA XREF: sub_4010E0+1BEr
					; sub_4010E0+2BAr ...
dword_40C180	dd ?			; DATA XREF: _wctomb+1Ar __strcmpi+5Ar ...
; volatile LONG	Addend
Addend		dd ?			; DATA XREF: _wctomb+5o
					; __strcmpi:notclocalew ...
; UINT dword_40C188
dword_40C188	dd ?			; DATA XREF: __setmbcp+1Br
					; __setmbcp+79w ...
		align 10h
dword_40C190	dd 3 dup(?)		; DATA XREF: __setmbcp+12Fo
					; __setmbcp+179o ...
dword_40C19C	dd ?			; DATA XREF: __setmbcp+114w
					; __setmbcp+168w ...
byte_40C1A0	db ?			; DATA XREF: _setSBUpLow:loc_407848w
					; _setSBUpLow:loc_407865w ...
		align 4
		dd 3Fh dup(?)
byte_40C2A0	db ?			; DATA XREF: __setmbcp+6Eo
					; __setmbcp+BEo ...
byte_40C2A1	db ?			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(?)
; LCID Locale
Locale		dd ?			; DATA XREF: __setmbcp+64w
					; __setmbcp+137w ...
		align 20h
dword_40C3C0	dd ?			; DATA XREF: ___initstdio+81r
					; __filbuf+75r	...
dword_40C3C4	dd 3Fh dup(?)		; DATA XREF: __ioinit+98o
; UINT uNumber
uNumber		dd ?			; DATA XREF: __read+5r	__close+5r ...
dword_40C4C4	dd ?			; DATA XREF: __setenvp+ADw _getenvr
dword_40C4C8	dd ?			; DATA XREF: __wincmdlnr __setenvp+3r	...
dword_40C4CC	dd ?			; DATA XREF: _doexit+43r
dword_40C4D0	dd ?			; DATA XREF: _doexit+3Ar _doexit+5Cr
dword_40C4D4	dd ?			; DATA XREF: __cinitr
dword_40C4D8	dd ?			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_40C4DC	dd ?			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_40C4E0	dd ?			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *dword_40C4E4
dword_40C4E4	dd ?			; DATA XREF: ___sbh_heap_init:loc_403EADw
					; ___sbh_free_block+22Cr ...
dword_40C4E8	dd ?			; DATA XREF: ___sbh_heap_init+24w
					; ___sbh_find_blockr ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: ___sbh_heap_init+15w
					; ___sbh_find_block+8r	...
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: _free+3Ar
					; __heap_alloc+3Fr ...
dword_40C4F4	dd ?			; DATA XREF: ___initstdio+28w
					; ___initstdio+41w ...
		align 10h
dword_40C500	dd 400h	dup(?)		; DATA XREF: .data:off_40B188o
					; .data:0040B190o
; size_t dword_40D500
dword_40D500	dd ?			; DATA XREF: ___initstdior
					; ___initstdio:loc_402DC5w ...
dword_40D504	dd ?			; DATA XREF: start+8Cw	__wincmdln+Fr ...
		align 1000h
_data		ends


		end start
