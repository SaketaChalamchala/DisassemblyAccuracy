;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	C5F41A034F4CEC97813E0FCE01547165
; Input	CRC32 :	8E75BD94

; File Name   :	C:\compspace\compare\pgp\dlls\full\Install.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 000049AA (  18858.)
; Section size in file		: 00005000 (  20480.)
; Offset to raw	data for section: 00001000
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes
; Exported entry   6. CreateIISVDir
; Exported entry  15. UninstInitialize
; OS type	  :  MS	Windows
; Application type:  DLL 32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public UninstInitialize
UninstInitialize proc near		; DATA XREF: .rdata:off_10006E78o
		xor	eax, eax	; CreateIISVDir
		retn
UninstInitialize endp

; ---------------------------------------------------------------------------
		align 10h
; [00000008 BYTES: COLLAPSED FUNCTION DllMain(x,x,x)]
		align 10h

loc_10001020:				; DATA XREF: sub_100011D0+74o
		mov	eax, [esp+8]
		sub	esp, 10h
		cmp	eax, 110h
		jnz	short loc_1000109C
		push	ebx
		push	esi
		mov	esi, [esp+1Ch]
		lea	eax, [esp+8]
		push	edi
		mov	edi, ds:GetParent
		push	eax
		push	esi
		call	edi ; GetParent
		push	eax
		call	ds:GetWindowRect
		mov	ebx, ds:GetSystemMetrics
		push	45h
		push	0
		push	0
		push	1
		call	ebx ; GetSystemMetrics
		mov	ecx, [esp+1Ch]
		mov	edx, [esp+24h]
		sub	ecx, edx
		add	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		call	ebx ; GetSystemMetrics
		mov	edx, [esp+1Ch]
		mov	ebx, [esp+24h]
		sub	edx, ebx
		add	eax, edx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		push	esi
		call	edi ; GetParent
		push	eax
		call	ds:SetWindowPos
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_1000109C:				; CODE XREF: .text:1000102Cj
		mov	eax, 1
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

loc_100010B0:				; DATA XREF: MyBrowseForFolder32+50o
		mov	eax, [esp+8]
		sub	esp, 10h
		dec	eax
		jnz	short loc_1000111A
		push	esi
		mov	esi, [esp+18h]
		lea	eax, [esp+4]
		push	edi
		push	eax
		push	esi
		call	ds:GetWindowRect
		mov	edi, ds:GetSystemMetrics
		push	45h
		push	0
		push	0
		push	1
		call	edi ; GetSystemMetrics
		mov	ecx, [esp+18h]
		mov	edx, [esp+20h]
		sub	ecx, edx
		add	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		call	edi ; GetSystemMetrics
		mov	edx, [esp+18h]
		mov	ecx, [esp+20h]
		sub	edx, ecx
		add	eax, edx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		push	esi
		call	ds:SetWindowPos
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------

loc_1000111A:				; CODE XREF: .text:100010B8j
		mov	eax, 1
		add	esp, 10h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  10. MyBrowseForFolder32

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	MyBrowseForFolder32(int, LPSTR pszPath)
		public MyBrowseForFolder32
MyBrowseForFolder32 proc near		; DATA XREF: .rdata:off_10006E78o

ppMalloc	= dword	ptr -108h
var_104		= byte ptr -104h
arg_0		= dword	ptr  4
pszPath		= dword	ptr  8

		sub	esp, 108h
		lea	eax, [esp+108h+ppMalloc]
		push	esi
		push	edi
		push	eax		; ppMalloc
		call	ds:SHGetMalloc
		lea	edx, [esp+110h+var_104]
		push	offset bi	; lpbi
		mov	ecx, [esp+114h+arg_0]
		mov	edi, [esp+114h+pszPath]
		mov	bi.hwndOwner, ecx
		mov	bi.pidlRoot, 0
		mov	bi.pszDisplayName, edx
		mov	bi.lpszTitle, edi
		mov	bi.ulFlags, 0
		mov	bi.lpfn, offset	loc_100010B0
		mov	bi.lParam, 0
		call	ds:SHBrowseForFolderA
		mov	esi, eax
		test	esi, esi
		jz	short loc_100011C3
		push	edi		; pszPath
		push	esi		; pidl
		call	ds:SHGetPathFromIDListA
		push	esi
		mov	eax, [esp+114h+ppMalloc]
		push	eax
		mov	ecx, [eax]
		call	dword ptr [ecx+14h]
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 108h
		retn	8
; ---------------------------------------------------------------------------

loc_100011C3:				; CODE XREF: MyBrowseForFolder32+6Ej
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 108h
		retn	8
MyBrowseForFolder32 endp


; =============== S U B	R O U T	I N E =======================================


sub_100011D0	proc near		; CODE XREF: MyGetOpenFileName32p
		mov	ecx, off_10008030
		xor	eax, eax
		mov	stru_10008E90.lStructSize, 4Ch
		mov	stru_10008E90.hwndOwner, eax
		mov	stru_10008E90.hInstance, eax
		mov	stru_10008E90.lpstrFilter, ecx
		mov	stru_10008E90.lpstrCustomFilter, eax
		mov	stru_10008E90.nMaxCustFilter, eax
		mov	stru_10008E90.nFilterIndex, eax
		mov	stru_10008E90.lpstrFile, eax
		mov	stru_10008E90.nMaxFile,	104h
		mov	stru_10008E90.lpstrFileTitle, eax
		mov	stru_10008E90.nMaxFileTitle, 200h
		mov	stru_10008E90.lpstrInitialDir, eax
		mov	stru_10008E90.lpstrTitle, eax
		mov	stru_10008E90.Flags, eax
		mov	stru_10008E90.nFileOffset, ax
		mov	stru_10008E90.nFileExtension, ax
		mov	stru_10008E90.lpstrDefExt, eax
		mov	stru_10008E90.lCustData, eax
		mov	stru_10008E90.lpfnHook,	offset loc_10001020
		mov	stru_10008E90.lpTemplateName, eax
		retn
sub_100011D0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. MyGetOpenFileName32

; =============== S U B	R O U T	I N E =======================================


		public MyGetOpenFileName32
MyGetOpenFileName32 proc near		; DATA XREF: .rdata:off_10006E78o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		call	sub_100011D0
		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001272
		mov	stru_10008E90.hwndOwner, eax

loc_10001272:				; CODE XREF: MyGetOpenFileName32+Bj
		mov	eax, [esp+arg_4]
		cmp	byte ptr [eax],	0
		jz	short loc_10001280
		mov	stru_10008E90.lpstrFilter, eax

loc_10001280:				; CODE XREF: MyGetOpenFileName32+19j
		mov	eax, [esp+arg_8]
		mov	stru_10008E90.lpstrFile, eax
		mov	eax, [esp+arg_C]
		cmp	byte ptr [eax],	0
		jz	short loc_10001297
		mov	stru_10008E90.lpstrTitle, eax

loc_10001297:				; CODE XREF: MyGetOpenFileName32+30j
		mov	eax, [esp+arg_10]
		mov	stru_10008E90.Flags, 80024h
		cmp	byte ptr [eax],	0
		jz	short loc_100012AF
		mov	stru_10008E90.lpstrDefExt, eax

loc_100012AF:				; CODE XREF: MyGetOpenFileName32+48j
		push	0		; pvReserved
		call	ds:OleInitialize
		push	offset stru_10008E90 ; LPOPENFILENAMEA
		call	GetOpenFileNameA
		mov	dword_10008F18,	eax
		call	ds:OleUninitialize
		mov	eax, dword_10008F18
		retn	14h
MyGetOpenFileName32 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  12. PGPclStartMemLockDriver

; =============== S U B	R O U T	I N E =======================================


		public PGPclStartMemLockDriver
PGPclStartMemLockDriver	proc near	; DATA XREF: .rdata:off_10006E78o

ServiceStatus	= _SERVICE_STATUS ptr -1B4h
Buffer		= byte ptr -198h
VersionInformation= _OSVERSIONINFOA ptr	-94h

		sub	esp, 1B4h
		push	ebx
		push	ebp
		lea	eax, [esp+1BCh+VersionInformation]
		push	edi
		push	eax		; lpVersionInformation
		mov	[esp+1C4h+VersionInformation.dwOSVersionInfoSize], 94h
		call	ds:GetVersionExA
		cmp	[esp+1C0h+VersionInformation.dwPlatformId], 2
		jz	short loc_1000131B
		pop	edi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1B4h
		retn
; ---------------------------------------------------------------------------

loc_1000131B:				; CODE XREF: PGPclStartMemLockDriver+2Aj
		push	esi
		push	2		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	ebp, ds:CloseServiceHandle
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_1000134E
		call	ds:GetLastError
		mov	edi, eax
		sub	edi, 5
		neg	edi
		sbb	edi, edi
		and	edi, 3
		add	edi, 2
		jmp	loc_10001457
; ---------------------------------------------------------------------------

loc_1000134E:				; CODE XREF: PGPclStartMemLockDriver+52j
		push	14h		; dwDesiredAccess
		push	offset DisplayName ; "PGPmemlock"
		push	ebx		; hSCManager
		call	ds:OpenServiceA
		mov	edi, ds:GetLastError
		mov	esi, eax
		test	esi, esi
		jnz	loc_10001411
		call	edi ; GetLastError
		cmp	eax, 424h
		jz	short loc_1000137F
		mov	edi, 5
		jmp	loc_10001450
; ---------------------------------------------------------------------------

loc_1000137F:				; CODE XREF: PGPclStartMemLockDriver+93j
		lea	ecx, [esp+1C4h+Buffer]
		push	104h		; uSize
		push	ecx		; lpBuffer
		call	ds:GetSystemDirectoryA
		lea	edx, [esp+1C4h+Buffer]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	cl, byte ptr [esp+eax+1C4h+ServiceStatus.dwWaitHint+3]
		mov	esi, ds:lstrcatA
		cmp	cl, 5Ch
		jz	short loc_100013B5
		lea	eax, [esp+1C4h+Buffer]
		push	offset String2	; "\\"
		push	eax		; lpString1
		call	esi ; lstrcatA

loc_100013B5:				; CODE XREF: PGPclStartMemLockDriver+C7j
		lea	ecx, [esp+1C4h+Buffer]
		push	offset aDrivers	; "drivers\\"
		push	ecx		; lpString1
		call	esi ; lstrcatA
		lea	edx, [esp+1C4h+Buffer]
		push	offset DisplayName ; "PGPmemlock"
		push	edx		; lpString1
		call	esi ; lstrcatA
		lea	eax, [esp+1C4h+Buffer]
		push	offset a_sys	; ".sys"
		push	eax		; lpString1
		call	esi ; lstrcatA
		push	0		; lpPassword
		push	0		; lpServiceStartName
		push	0		; lpDependencies
		push	0		; lpdwTagId
		lea	ecx, [esp+1D4h+Buffer]
		push	0		; lpLoadOrderGroup
		push	ecx		; lpBinaryPathName
		push	1		; dwErrorControl
		push	2		; dwStartType
		push	1		; dwServiceType
		push	0F01FFh		; dwDesiredAccess
		push	offset DisplayName ; "PGPmemlock"
		push	offset DisplayName ; "PGPmemlock"
		push	ebx		; hSCManager
		call	ds:CreateServiceA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10001411
		mov	edi, 3
		jmp	short loc_10001450
; ---------------------------------------------------------------------------

loc_10001411:				; CODE XREF: PGPclStartMemLockDriver+86j
					; PGPclStartMemLockDriver+128j
		lea	edx, [esp+1C4h+ServiceStatus]
		push	edx		; lpServiceStatus
		push	esi		; hService
		call	ds:QueryServiceStatus
		test	eax, eax
		jnz	short loc_10001428
		mov	edi, 5
		jmp	short loc_10001450
; ---------------------------------------------------------------------------

loc_10001428:				; CODE XREF: PGPclStartMemLockDriver+13Fj
		cmp	[esp+1C4h+ServiceStatus.dwCurrentState], 1
		jnz	short loc_1000144B
		push	0		; lpServiceArgVectors
		push	0		; dwNumServiceArgs
		push	esi		; hService
		call	ds:StartServiceA
		test	eax, eax
		jnz	short loc_10001447
		call	edi ; GetLastError
		mov	edi, 5
		jmp	short loc_10001450
; ---------------------------------------------------------------------------

loc_10001447:				; CODE XREF: PGPclStartMemLockDriver+15Cj
		xor	edi, edi
		jmp	short loc_10001450
; ---------------------------------------------------------------------------

loc_1000144B:				; CODE XREF: PGPclStartMemLockDriver+14Dj
		mov	edi, 4

loc_10001450:				; CODE XREF: PGPclStartMemLockDriver+9Aj
					; PGPclStartMemLockDriver+12Fj	...
		test	esi, esi
		jz	short loc_10001457
		push	esi		; hSCObject
		call	ebp ; CloseServiceHandle

loc_10001457:				; CODE XREF: PGPclStartMemLockDriver+69j
					; PGPclStartMemLockDriver+172j
		test	ebx, ebx
		pop	esi
		jz	short loc_1000145F
		push	ebx		; hSCObject
		call	ebp ; CloseServiceHandle

loc_1000145F:				; CODE XREF: PGPclStartMemLockDriver+17Aj
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 1B4h
		retn
PGPclStartMemLockDriver	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. UninstUnInitialize

; =============== S U B	R O U T	I N E =======================================


		public UninstUnInitialize
UninstUnInitialize proc	near		; DATA XREF: .rdata:off_10006E78o
		retn
UninstUnInitialize endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   5. CreateAndWait

; =============== S U B	R O U T	I N E =======================================


; int __cdecl CreateAndWait(LPCSTR lpszLongPath, int, LPCSTR lpText)
		public CreateAndWait
CreateAndWait	proc near		; DATA XREF: .rdata:off_10006E78o

ProcessInformation= _PROCESS_INFORMATION ptr -54h
StartupInfo	= _STARTUPINFOA	ptr -44h
lpszLongPath	= dword	ptr  4
arg_4		= dword	ptr  8
lpText		= dword	ptr  0Ch

		sub	esp, 54h
		push	ebx
		push	esi
		push	edi
		mov	ecx, 11h
		xor	eax, eax
		lea	edi, [esp+60h+StartupInfo]
		rep stosd
		mov	edi, [esp+60h+arg_4]
		mov	[esp+60h+ProcessInformation.hProcess], eax
		mov	[esp+60h+ProcessInformation.hThread], eax
		or	ecx, 0FFFFFFFFh
		mov	[esp+60h+ProcessInformation.dwProcessId], eax
		mov	ebx, [esp+60h+lpszLongPath]
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	[esp+60h+ProcessInformation.dwThreadId], eax
		mov	esi, edi
		mov	edx, ecx
		mov	edi, ebx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		mov	[esp+60h+StartupInfo.cb], 44h
		and	ecx, 3
		mov	[esp+60h+StartupInfo.dwFlags], 1
		rep movsb
		mov	edi, ebx
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		push	ecx		; cchBuffer
		push	ebx		; lpszShortPath
		push	ebx		; lpszLongPath
		mov	[esp+6Ch+StartupInfo.wShowWindow], 1
		call	ds:GetShortPathNameA
		lea	eax, [esp+60h+ProcessInformation]
		lea	ecx, [esp+60h+StartupInfo]
		push	eax		; lpProcessInformation
		push	ecx		; lpStartupInfo
		push	0		; lpCurrentDirectory
		push	0		; lpEnvironment
		push	20h		; dwCreationFlags
		push	0		; bInheritHandles
		push	0		; lpThreadAttributes
		push	0		; lpProcessAttributes
		push	ebx		; lpCommandLine
		push	0		; lpApplicationName
		call	ds:CreateProcessA
		test	eax, eax
		jnz	short loc_1000153C
		mov	edx, [esp+60h+lpText]
		push	10h		; uType
		push	offset Caption	; "ERROR"
		push	edx		; lpText
		call	ds:GetFocus
		push	eax		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000153C:				; CODE XREF: CreateAndWait+98j
		mov	eax, [esp+60h+ProcessInformation.hProcess]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		mov	ecx, [esp+60h+ProcessInformation.hThread]
		mov	esi, ds:CloseHandle
		push	ecx		; hObject
		call	esi ; CloseHandle
		mov	edx, [esp+60h+ProcessInformation.hProcess]
		push	edx		; hObject
		call	esi ; CloseHandle
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		add	esp, 54h
		retn
CreateAndWait	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  14. StopService

; =============== S U B	R O U T	I N E =======================================


; int __cdecl StopService(LPCSTR lpServiceName)
		public StopService
StopService	proc near		; DATA XREF: .rdata:off_10006E78o

ServiceStatus	= _SERVICE_STATUS ptr -1Ch
lpServiceName	= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	esi, eax
		mov	eax, [esp+28h+lpServiceName]
		push	0F01FFh		; dwDesiredAccess
		push	eax		; lpServiceName
		push	esi		; hSCManager
		call	ds:OpenServiceA
		lea	ecx, [esp+28h+ServiceStatus]
		mov	edi, eax
		push	ecx		; lpServiceStatus
		push	1		; dwControl
		push	edi		; hService
		call	ds:ControlService
		push	edi		; hSCObject
		mov	edi, ds:CloseServiceHandle
		mov	ebx, eax
		call	edi ; CloseServiceHandle
		push	esi		; hSCObject
		call	edi ; CloseServiceHandle
		pop	edi
		mov	eax, ebx
		pop	esi
		pop	ebx
		add	esp, 1Ch
		retn
StopService	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   7. DelSrv

; =============== S U B	R O U T	I N E =======================================


		public DelSrv
DelSrv		proc near		; DATA XREF: .rdata:off_10006E78o

var_20		= dword	ptr -20h
ServiceStatus	= _SERVICE_STATUS ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 20h
		mov	eax, [esp+20h+arg_0]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		sub	eax, esi
		mov	[esp+30h+var_20], esi
		jz	loc_100016B5
		dec	eax
		jnz	loc_100016BF
		mov	[esp+30h+var_20], 1

loc_100015E8:				; CODE XREF: DelSrv+FAj
		push	2		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	ebx, ds:OpenServiceA
		mov	ebp, ds:Sleep
		cmp	esi, 1
		mov	edi, eax
		jnz	short loc_10001654
		push	0F01FFh		; dwDesiredAccess
		push	offset ServiceName ; "PGP Certificate Server"
		push	edi		; hSCManager
		call	ebx ; OpenServiceA
		mov	esi, eax
		test	esi, esi
		jz	loc_100016AD
		lea	eax, [esp+30h+ServiceStatus]
		push	eax		; lpServiceStatus
		push	esi		; hService
		call	ds:QueryServiceStatus
		cmp	[esp+30h+ServiceStatus.dwCurrentState],	1
		jz	short loc_10001646
		lea	ecx, [esp+30h+ServiceStatus]
		push	ecx		; lpServiceStatus
		push	1		; dwControl
		push	esi		; hService
		call	ds:ControlService
		push	1F4h		; dwMilliseconds
		call	ebp ; Sleep

loc_10001646:				; CODE XREF: DelSrv+6Fj
		push	esi		; hService
		call	ds:DeleteService
		push	esi		; hSCObject
		call	ds:CloseServiceHandle

loc_10001654:				; CODE XREF: DelSrv+45j
		cmp	[esp+30h+var_20], 1
		jnz	short loc_100016A6
		push	0F01FFh		; dwDesiredAccess
		push	offset aPgpReplication ; "PGP Replication Engine"
		push	edi		; hSCManager
		call	ebx ; OpenServiceA
		lea	edx, [esp+30h+ServiceStatus]
		mov	esi, eax
		push	edx		; lpServiceStatus
		push	esi		; hService
		call	ds:QueryServiceStatus
		cmp	[esp+30h+ServiceStatus.dwCurrentState],	1
		jz	short loc_10001692
		lea	eax, [esp+30h+ServiceStatus]
		push	eax		; lpServiceStatus
		push	1		; dwControl
		push	esi		; hService
		call	ds:ControlService
		push	1F4h		; dwMilliseconds
		call	ebp ; Sleep

loc_10001692:				; CODE XREF: DelSrv+BBj
		push	esi		; hService
		call	ds:DeleteService
		push	1		; dwMilliseconds
		test	eax, eax
		call	ebp ; Sleep
		push	esi		; hSCObject
		call	ds:CloseServiceHandle

loc_100016A6:				; CODE XREF: DelSrv+99j
		push	edi		; hSCObject
		call	ds:CloseServiceHandle

loc_100016AD:				; CODE XREF: DelSrv+58j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100016B5:				; CODE XREF: DelSrv+13j
		mov	esi, 1
		jmp	loc_100015E8
; ---------------------------------------------------------------------------

loc_100016BF:				; CODE XREF: DelSrv+1Aj
		push	10h		; uType
		push	offset aDelsrv_0 ; "DelSrv"
		push	offset Text	; "bad parm delsrv"
		push	0		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
DelSrv		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   3. AddSrv

; =============== S U B	R O U T	I N E =======================================


		public AddSrv
AddSrv		proc near		; DATA XREF: .rdata:off_10006E78o

var_204		= dword	ptr -204h
Filename	= byte ptr -200h
arg_0		= dword	ptr  4

		sub	esp, 204h
		mov	eax, [esp+204h+arg_0]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		sub	eax, esi
		mov	[esp+214h+var_204], esi
		jz	loc_10001809
		dec	eax
		jnz	loc_10001813
		mov	[esp+214h+var_204], 1

loc_1000170E:				; CODE XREF: AddSrv+12Ej
		push	2		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	ebp, eax
		test	ebp, ebp
		jz	loc_10001911
		mov	ebx, ds:CreateServiceA
		cmp	esi, 1
		jnz	loc_10001839
		mov	ecx, 80h
		xor	eax, eax
		lea	edi, [esp+214h+Filename]
		push	200h		; nSize
		rep stosd
		lea	eax, [esp+218h+Filename]
		push	eax		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		lea	ecx, [esp+214h+Filename]
		push	5Ch		; int
		push	ecx		; char *
		call	_strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_10001768
		mov	byte ptr [eax],	0

loc_10001768:				; CODE XREF: AddSrv+83j
		mov	edi, offset String2 ; "\\"
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		lea	edx, [esp+214h+Filename]
		repne scasb
		not	ecx
		sub	edi, ecx
		push	eax		; lpPassword
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	edx, [esp+218h+Filename]
		and	ecx, 3
		push	eax		; lpServiceStartName
		rep movsb
		mov	edi, offset aPgpcertd_exe ; "PGPcertd.exe"
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		push	eax		; lpDependencies
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		push	eax		; lpdwTagId
		push	eax		; lpLoadOrderGroup
		lea	eax, [esp+228h+Filename]
		mov	ecx, edx
		push	eax		; lpBinaryPathName
		push	1		; dwErrorControl
		push	2		; dwStartType
		push	110h		; dwServiceType
		push	0F01FFh		; dwDesiredAccess
		and	ecx, 3
		push	offset ServiceName ; "PGP Certificate Server"
		push	offset ServiceName ; "PGP Certificate Server"
		rep movsb
		push	ebp		; hSCManager
		call	ebx ; CreateServiceA
		test	eax, eax
		jnz	short loc_10001832
		push	10h		; uType
		push	offset byte_10008E68 ; lpCaption
		push	offset aCanTCreateServ ; "Can't create Service.(It may already ex"...
		push	eax		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 204h
		retn
; ---------------------------------------------------------------------------

loc_10001809:				; CODE XREF: AddSrv+19j
		mov	esi, 1
		jmp	loc_1000170E
; ---------------------------------------------------------------------------

loc_10001813:				; CODE XREF: AddSrv+20j
		push	10h		; uType
		push	offset aAddsrv_0 ; "AddSrv"
		push	offset aBadParmAddsrv ;	"bad parm addsrv"
		push	0		; hWnd
		call	ds:MessageBoxA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 204h
		retn
; ---------------------------------------------------------------------------

loc_10001832:				; CODE XREF: AddSrv+109j
		push	eax		; hSCObject
		call	ds:CloseServiceHandle

loc_10001839:				; CODE XREF: AddSrv+4Dj
		cmp	[esp+214h+var_204], 1
		jnz	loc_1000190A
		mov	ecx, 80h
		xor	eax, eax
		lea	edi, [esp+214h+Filename]
		push	200h		; nSize
		rep stosd
		lea	ecx, [esp+218h+Filename]
		push	ecx		; lpFilename
		push	eax		; hModule
		call	ds:GetModuleFileNameA
		lea	edx, [esp+214h+Filename]
		push	5Ch		; int
		push	edx		; char *
		call	_strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_10001878
		mov	byte ptr [eax],	0

loc_10001878:				; CODE XREF: AddSrv+193j
		mov	edi, offset String2 ; "\\"
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		lea	edx, [esp+214h+Filename]
		repne scasb
		not	ecx
		sub	edi, ecx
		push	eax		; lpPassword
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		lea	edx, [esp+218h+Filename]
		and	ecx, 3
		push	eax		; lpServiceStartName
		rep movsb
		mov	edi, offset aPgprepd_exe ; "PGPrepd.exe"
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		push	eax		; lpDependencies
		mov	esi, edi
		mov	edi, edx
		mov	edx, ecx
		or	ecx, 0FFFFFFFFh
		repne scasb
		mov	ecx, edx
		dec	edi
		shr	ecx, 2
		rep movsd
		push	eax		; lpdwTagId
		push	eax		; lpLoadOrderGroup
		lea	eax, [esp+228h+Filename]
		mov	ecx, edx
		push	eax		; lpBinaryPathName
		push	1		; dwErrorControl
		push	3		; dwStartType
		push	110h		; dwServiceType
		push	0F01FFh		; dwDesiredAccess
		and	ecx, 3
		push	offset aPgpReplication ; "PGP Replication Engine"
		push	offset aPgpReplication ; "PGP Replication Engine"
		rep movsb
		push	ebp		; hSCManager
		call	ebx ; CreateServiceA
		mov	esi, eax
		push	1		; dwMilliseconds
		test	esi, esi
		call	ds:Sleep
		push	esi		; hSCObject
		call	ds:CloseServiceHandle

loc_1000190A:				; CODE XREF: AddSrv+15Ej
		push	ebp		; hSCObject
		call	ds:CloseServiceHandle

loc_10001911:				; CODE XREF: AddSrv+3Ej
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 204h
		retn
AddSrv		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. StartServ

; =============== S U B	R O U T	I N E =======================================


; int __cdecl StartServ(LPCSTR lpServiceName)
		public StartServ
StartServ	proc near		; DATA XREF: .rdata:off_10006E78o

ServiceStatus	= _SERVICE_STATUS ptr -1Ch
lpServiceName	= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0F003Fh		; dwDesiredAccess
		push	0		; lpDatabaseName
		push	0		; lpMachineName
		call	ds:OpenSCManagerA
		mov	ebp, eax
		mov	eax, [esp+2Ch+lpServiceName]
		push	0F01FFh		; dwDesiredAccess
		push	eax		; lpServiceName
		push	ebp		; hSCManager
		call	ds:OpenServiceA
		mov	esi, eax
		push	0		; lpServiceArgVectors
		push	0		; dwNumServiceArgs
		push	esi		; hService
		call	ds:StartServiceA
		mov	edi, ds:QueryServiceStatus
		lea	ecx, [esp+2Ch+ServiceStatus]
		push	ecx		; lpServiceStatus
		push	esi		; hService
		call	edi ; QueryServiceStatus
		test	eax, eax
		jz	short loc_10001988
		mov	ebx, ds:Sleep

loc_1000196E:				; CODE XREF: StartServ+66j
		cmp	[esp+2Ch+ServiceStatus.dwCurrentState],	2
		jnz	short loc_10001988
		push	4E2h		; dwMilliseconds
		call	ebx ; Sleep
		lea	edx, [esp+2Ch+ServiceStatus]
		push	edx		; lpServiceStatus
		push	esi		; hService
		call	edi ; QueryServiceStatus
		test	eax, eax
		jnz	short loc_1000196E

loc_10001988:				; CODE XREF: StartServ+46j
					; StartServ+53j
		push	esi		; hSCObject
		mov	esi, ds:CloseServiceHandle
		call	esi ; CloseServiceHandle
		push	ebp		; hSCObject
		call	esi ; CloseServiceHandle
		mov	ecx, [esp+2Ch+ServiceStatus.dwCurrentState]
		xor	eax, eax
		pop	edi
		cmp	ecx, 4
		pop	esi
		pop	ebp
		setz	al
		pop	ebx
		add	esp, 1Ch
		retn
StartServ	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. SetRegPermissions

; =============== S U B	R O U T	I N E =======================================


		public SetRegPermissions
SetRegPermissions proc near		; DATA XREF: .rdata:off_10006E78o
		xor	eax, eax
		retn	8
SetRegPermissions endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. SetPermissions

; =============== S U B	R O U T	I N E =======================================


		public SetPermissions
SetPermissions	proc near		; DATA XREF: .rdata:off_10006E78o
		xor	eax, eax
		retn	4
SetPermissions	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100019D0	proc near		; CODE XREF: IsWin95OSR2Compatiblep
					; IsWin2000Compatiblep

VersionInformation= _OSVERSIONINFOA ptr	-94h

		sub	esp, 94h
		push	ebx
		lea	eax, [esp+98h+VersionInformation]
		push	esi
		push	eax		; lpVersionInformation
		mov	[esp+0A0h+VersionInformation.dwOSVersionInfoSize], 94h
		call	ds:GetVersionExA
		test	eax, eax
		jnz	short loc_100019FD

loc_100019EF:				; CODE XREF: sub_100019D0+39j
					; sub_100019D0+167j
		pop	esi
		mov	eax, 0Bh
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_100019FD:				; CODE XREF: sub_100019D0+1Dj
		mov	eax, [esp+9Ch+VersionInformation.dwPlatformId]
		dec	eax
		jz	loc_10001B4B
		dec	eax
		jnz	short loc_100019EF
		mov	eax, [esp+9Ch+VersionInformation.dwMajorVersion]
		cmp	eax, 3
		jnz	short loc_10001A1D
		pop	esi
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001A1D:				; CODE XREF: sub_100019D0+42j
		cmp	eax, 4
		jnz	loc_10001B34
		push	edi
		lea	edi, [esp+0A0h+VersionInformation.szCSDVersion]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		pop	edi
		jnz	short loc_10001A46
		pop	esi
		mov	eax, 4
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001A46:				; CODE XREF: sub_100019D0+66j
		mov	esi, offset aServicePack1 ; "Service Pack 1"
		lea	eax, [esp+9Ch+VersionInformation.szCSDVersion]

loc_10001A4F:				; CODE XREF: sub_100019D0+A1j
		mov	dl, [eax]
		mov	bl, [esi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001A77
		test	cl, cl
		jz	short loc_10001A73
		mov	dl, [eax+1]
		mov	bl, [esi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001A77
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_10001A4F

loc_10001A73:				; CODE XREF: sub_100019D0+8Bj
		xor	eax, eax
		jmp	short loc_10001A7C
; ---------------------------------------------------------------------------

loc_10001A77:				; CODE XREF: sub_100019D0+87j
					; sub_100019D0+97j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10001A7C:				; CODE XREF: sub_100019D0+A5j
		test	eax, eax
		jnz	short loc_10001A8E
		pop	esi
		mov	eax, 5
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001A8E:				; CODE XREF: sub_100019D0+AEj
		mov	esi, offset aServicePack2 ; "Service Pack 2"
		lea	eax, [esp+9Ch+VersionInformation.szCSDVersion]

loc_10001A97:				; CODE XREF: sub_100019D0+E9j
		mov	dl, [eax]
		mov	bl, [esi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001ABF
		test	cl, cl
		jz	short loc_10001ABB
		mov	dl, [eax+1]
		mov	bl, [esi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001ABF
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_10001A97

loc_10001ABB:				; CODE XREF: sub_100019D0+D3j
		xor	eax, eax
		jmp	short loc_10001AC4
; ---------------------------------------------------------------------------

loc_10001ABF:				; CODE XREF: sub_100019D0+CFj
					; sub_100019D0+DFj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10001AC4:				; CODE XREF: sub_100019D0+EDj
		test	eax, eax
		jnz	short loc_10001AD6
		pop	esi
		mov	eax, 6
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001AD6:				; CODE XREF: sub_100019D0+F6j
		mov	esi, offset aServicePack3 ; "Service Pack 3"
		lea	eax, [esp+9Ch+VersionInformation.szCSDVersion]

loc_10001ADF:				; CODE XREF: sub_100019D0+131j
		mov	dl, [eax]
		mov	bl, [esi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001B1A
		test	cl, cl
		jz	short loc_10001B03
		mov	dl, [eax+1]
		mov	bl, [esi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_10001B1A
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_10001ADF

loc_10001B03:				; CODE XREF: sub_100019D0+11Bj
		xor	eax, eax
		xor	ecx, ecx
		test	eax, eax
		setnz	cl
		add	ecx, 7
		pop	esi
		mov	eax, ecx
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001B1A:				; CODE XREF: sub_100019D0+117j
					; sub_100019D0+127j
		sbb	eax, eax
		pop	esi
		sbb	eax, 0FFFFFFFFh
		xor	ecx, ecx
		test	eax, eax
		setnz	cl
		add	ecx, 7
		pop	ebx
		mov	eax, ecx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001B34:				; CODE XREF: sub_100019D0+50j
		cmp	eax, 5
		jnz	loc_100019EF
		pop	esi
		mov	eax, 0Ah
		pop	ebx
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001B4B:				; CODE XREF: sub_100019D0+32j
		mov	eax, [esp+9Ch+VersionInformation.dwMinorVersion]
		test	eax, eax
		jnz	short loc_10001B71
		mov	edx, [esp+9Ch+VersionInformation.dwBuildNumber]
		mov	eax, 438h
		and	edx, 0FFFFh
		pop	esi
		cmp	eax, edx
		pop	ebx
		sbb	eax, eax
		neg	eax
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_10001B71:				; CODE XREF: sub_100019D0+181j
		pop	esi
		mov	eax, 2
		pop	ebx
		add	esp, 94h
		retn
sub_100019D0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   9. IsWin95OSR2Compatible

; =============== S U B	R O U T	I N E =======================================


		public IsWin95OSR2Compatible
IsWin95OSR2Compatible proc near		; DATA XREF: .rdata:off_10006E78o
		call	sub_100019D0
		test	eax, eax
		jle	short loc_10001B94
		cmp	eax, 2
		jg	short loc_10001B94
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10001B94:				; CODE XREF: IsWin95OSR2Compatible+7j
					; IsWin95OSR2Compatible+Cj
		xor	eax, eax
		retn
IsWin95OSR2Compatible endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   8. IsWin2000Compatible

; =============== S U B	R O U T	I N E =======================================


		public IsWin2000Compatible
IsWin2000Compatible proc near		; DATA XREF: .rdata:off_10006E78o
		call	sub_100019D0
		xor	ecx, ecx
		cmp	eax, 0Ah
		setz	cl
		mov	eax, ecx
		retn
IsWin2000Compatible endp

; Exported entry   4. CopyRegistryKeyValues

; =============== S U B	R O U T	I N E =======================================


; int __cdecl CopyRegistryKeyValues(char *, char *)
		public CopyRegistryKeyValues
CopyRegistryKeyValues proc near		; DATA XREF: .rdata:off_10006E78o

phkResult	= dword	ptr -124h
cchValueName	= dword	ptr -120h
cbData		= dword	ptr -11Ch
var_118		= dword	ptr -118h
Type		= dword	ptr -114h
hKey		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
lpSubKey	= dword	ptr -108h
dwDisposition	= dword	ptr -104h
ValueName	= byte ptr -100h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		sub	esp, 124h
		lea	eax, [esp+124h+lpSubKey]
		push	esi
		push	edi
		push	eax		; int
		push	ecx		; char *
		call	sub_10001D30
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_10001C3D
		mov	eax, [esp+12Ch+arg_4]
		lea	edx, [esp+12Ch+var_10C]
		push	edx		; int
		push	eax		; char *
		call	sub_10001D30
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10001C3D
		mov	edx, [esp+12Ch+lpSubKey]
		lea	ecx, [esp+12Ch+phkResult]
		push	ecx		; phkResult
		push	0F003Fh		; samDesired
		push	0		; ulOptions
		push	edx		; lpSubKey
		push	edi		; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_10001C3D
		mov	edx, [esp+12Ch+var_10C]
		lea	eax, [esp+12Ch+dwDisposition]
		lea	ecx, [esp+12Ch+hKey]
		push	eax		; lpdwDisposition
		push	ecx		; phkResult
		push	0		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	0		; dwOptions
		push	0		; lpClass
		push	0		; Reserved
		push	edx		; lpSubKey
		push	esi		; hKey
		call	ds:RegCreateKeyExA
		test	eax, eax
		mov	[esp+12Ch+var_118], eax
		jz	short loc_10001C48
		mov	eax, [esp+12Ch+phkResult]
		push	eax		; hKey
		call	ds:RegCloseKey

loc_10001C3D:				; CODE XREF: CopyRegistryKeyValues+1Ej
					; CopyRegistryKeyValues+39j ...
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 124h
		retn
; ---------------------------------------------------------------------------

loc_10001C48:				; CODE XREF: CopyRegistryKeyValues+80j
		push	ebx
		push	ebp
		mov	ebp, ds:RegEnumValueA
		xor	ebx, ebx

loc_10001C52:				; CODE XREF: CopyRegistryKeyValues+13Cj
		lea	ecx, [esp+134h+cbData]
		lea	edx, [esp+134h+Type]
		push	ecx		; lpcbData
		push	0		; lpData
		push	edx		; lpType
		mov	edx, [esp+140h+phkResult]
		lea	eax, [esp+140h+cchValueName]
		push	0		; lpReserved
		lea	ecx, [esp+144h+ValueName]
		push	eax		; lpcchValueName
		push	ecx		; lpValueName
		mov	edi, 100h
		push	ebx		; dwIndex
		push	edx		; hKey
		mov	[esp+154h+cchValueName], edi
		call	ebp ; RegEnumValueA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10001CE1
		mov	eax, [esp+134h+cbData]
		mov	[esp+134h+cchValueName], edi
		push	eax		; size_t
		call	_malloc
		add	esp, 4
		lea	ecx, [esp+134h+cbData]
		mov	edi, eax
		lea	edx, [esp+134h+Type]
		push	ecx		; lpcbData
		push	edi		; lpData
		push	edx		; lpType
		mov	edx, [esp+140h+phkResult]
		lea	eax, [esp+140h+cchValueName]
		push	esi		; lpReserved
		lea	ecx, [esp+144h+ValueName]
		push	eax		; lpcchValueName
		push	ecx		; lpValueName
		push	ebx		; dwIndex
		push	edx		; hKey
		call	ebp ; RegEnumValueA
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10001CD8
		mov	eax, [esp+134h+cbData]
		mov	ecx, [esp+134h+Type]
		push	eax		; cbData
		mov	eax, [esp+138h+hKey]
		push	edi		; lpData
		push	ecx		; dwType
		lea	edx, [esp+140h+ValueName]
		push	esi		; Reserved
		push	edx		; lpValueName
		push	eax		; hKey
		call	ds:RegSetValueExA
		mov	[esp+134h+var_118], eax

loc_10001CD8:				; CODE XREF: CopyRegistryKeyValues+106j
		push	edi		; void *
		call	_free
		add	esp, 4

loc_10001CE1:				; CODE XREF: CopyRegistryKeyValues+CFj
		inc	ebx
		test	esi, esi
		jnz	short loc_10001CF2
		mov	eax, [esp+134h+var_118]
		test	eax, eax
		jz	loc_10001C52

loc_10001CF2:				; CODE XREF: CopyRegistryKeyValues+134j
		mov	ecx, [esp+134h+phkResult]
		mov	edi, ds:RegCloseKey
		push	ecx		; hKey
		call	edi ; RegCloseKey
		mov	edx, [esp+134h+hKey]
		push	edx		; hKey
		call	edi ; RegCloseKey
		pop	ebp
		cmp	esi, 103h
		pop	ebx
		jnz	loc_10001C3D
		mov	eax, [esp+12Ch+var_118]
		test	eax, eax
		jnz	loc_10001C3D
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 124h
		retn
CopyRegistryKeyValues endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10001D30(char	*, int)
sub_10001D30	proc near		; CODE XREF: CopyRegistryKeyValues+12p
					; CopyRegistryKeyValues+2Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jnz	short loc_10001D3F
		pop	edi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001D3F:				; CODE XREF: sub_10001D30+8j
		mov	eax, [esp+8+arg_4]
		test	eax, eax
		jnz	short loc_10001D4A
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001D4A:				; CODE XREF: sub_10001D30+15j
		push	5Ch		; int
		push	edi		; char *
		mov	dword ptr [eax], 0
		call	_strchr
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jnz	short loc_10001D64
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001D64:				; CODE XREF: sub_10001D30+2Fj
		push	ebx
		push	esi
		mov	esi, ebp
		xor	ebx, ebx
		sub	esi, edi
		dec	esi
		push	esi		; size_t
		push	offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001D93
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000000h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001D93:				; CODE XREF: sub_10001D30+4Ej
		push	esi		; size_t
		push	offset aHkey_current_u ; "HKEY_CURRENT_USER"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001DB9
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000001h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001DB9:				; CODE XREF: sub_10001D30+74j
		push	esi		; size_t
		push	offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001DDF
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000002h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001DDF:				; CODE XREF: sub_10001D30+9Aj
		push	esi		; size_t
		push	offset aHkey_users ; "HKEY_USERS"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001E05
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000003h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001E05:				; CODE XREF: sub_10001D30+C0j
		push	esi		; size_t
		push	offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001E2B
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000004h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001E2B:				; CODE XREF: sub_10001D30+E6j
		push	esi		; size_t
		push	offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001E51
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000005h
		pop	esi
		mov	[eax], ebp
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10001E51:				; CODE XREF: sub_10001D30+10Cj
		push	esi		; size_t
		push	offset aHkey_dyn_data ;	"HKEY_DYN_DATA"
		push	edi		; char *
		call	_strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10001E70
		mov	eax, [esp+10h+arg_4]
		inc	ebp
		mov	ebx, 80000006h
		mov	[eax], ebp

loc_10001E70:				; CODE XREF: sub_10001D30+132j
		mov	eax, ebx
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_10001D30	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetOpenFileNameA]
		align 10h
; [00000027 BYTES: COLLAPSED FUNCTION _strrchr]
; [00000048 BYTES: COLLAPSED FUNCTION _free]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc]
; [0000004E BYTES: COLLAPSED FUNCTION __heap_alloc]
		align 10h
; [00000038 BYTES: COLLAPSED FUNCTION _strncmp]
		align 10h
; [00000005 BYTES: COLLAPSED CHUNK OF FUNCTION _strchr]
		align 10h
; [000000BC BYTES: COLLAPSED FUNCTION _strchr]
; [000000D9 BYTES: COLLAPSED FUNCTION _CRT_INIT(x,x,x)]
; [0000009D BYTES: COLLAPSED FUNCTION DllEntryPoint]
; [00000030 BYTES: COLLAPSED FUNCTION __amsg_exit]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init]
; [00000075 BYTES: COLLAPSED FUNCTION __heap_term]
; [00000029 BYTES: COLLAPSED FUNCTION __mtinitlocks]
; [0000006C BYTES: COLLAPSED FUNCTION __mtdeletelocks]
; [00000061 BYTES: COLLAPSED FUNCTION __lock]
; [00000015 BYTES: COLLAPSED FUNCTION __unlock]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group]
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh]
; [0000002D BYTES: COLLAPSED FUNCTION __cinit]
; [00000011 BYTES: COLLAPSED FUNCTION __exit]
; [0000000F BYTES: COLLAPSED FUNCTION __cexit]
; [000000A3 BYTES: COLLAPSED FUNCTION _doexit]
; ---------------------------------------------------------------------------
		pop	edi
		retn
; [00000009 BYTES: COLLAPSED FUNCTION __lockexit]
; [00000009 BYTES: COLLAPSED FUNCTION __unlockexit]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm]
; [00000054 BYTES: COLLAPSED FUNCTION __mtinit]
; [0000001E BYTES: COLLAPSED FUNCTION __mtterm]
; [00000013 BYTES: COLLAPSED FUNCTION __initptd]
; [00000067 BYTES: COLLAPSED FUNCTION __getptd]
; [000000A0 BYTES: COLLAPSED FUNCTION __freeptd]
; [000001BC BYTES: COLLAPSED FUNCTION __ioinit]
; [00000054 BYTES: COLLAPSED FUNCTION __ioterm]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA]
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy]
; [00000073 BYTES: COLLAPSED FUNCTION __lseek_lk]
; [00000065 BYTES: COLLAPSED FUNCTION __write]
; [0000018B BYTES: COLLAPSED FUNCTION __write_lk]
; [000000A8 BYTES: COLLAPSED FUNCTION ___initstdio]
; [00000014 BYTES: COLLAPSED FUNCTION ___endstdio]
; [0000002F BYTES: COLLAPSED FUNCTION __lock_file]

; =============== S U B	R O U T	I N E =======================================


sub_10003D73	proc near		; CODE XREF: _flsall+2Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, 14h
		jge	short loc_10003D87
		add	eax, 1Ch
		push	eax
		call	__lock
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003D87:				; CODE XREF: sub_10003D73+7j
		mov	eax, [esp+arg_4]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		retn
sub_10003D73	endp

; [0000002F BYTES: COLLAPSED FUNCTION __unlock_file]

; =============== S U B	R O U T	I N E =======================================


sub_10003DC5	proc near		; CODE XREF: _flsall+7Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, 14h
		jge	short loc_10003DD9
		add	eax, 1Ch
		push	eax
		call	__unlock
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003DD9:				; CODE XREF: sub_10003DC5+7j
		mov	eax, [esp+arg_4]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		retn
sub_10003DC5	endp

; ---------------------------------------------------------------------------
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen]
		align 10h

__aulldiv:
		push	ebx
		push	esi
		mov	eax, [esp+18h]
		or	eax, eax
		jnz	short loc_10003E92
		mov	ecx, [esp+14h]
		mov	eax, [esp+10h]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+0Ch]
		div	ecx
		mov	edx, ebx
		jmp	short loc_10003ED3
; ---------------------------------------------------------------------------

loc_10003E92:				; CODE XREF: .text:10003E78j
		mov	ecx, eax
		mov	ebx, [esp+14h]
		mov	edx, [esp+10h]
		mov	eax, [esp+0Ch]

loc_10003EA0:				; CODE XREF: .text:10003EAAj
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_10003EA0
		div	ebx
		mov	esi, eax
		mul	dword ptr [esp+18h]
		mov	ecx, eax
		mov	eax, [esp+14h]
		mul	esi
		add	edx, ecx
		jb	short loc_10003ECE
		cmp	edx, [esp+10h]
		ja	short loc_10003ECE
		jb	short loc_10003ECF
		cmp	eax, [esp+0Ch]
		jbe	short loc_10003ECF

loc_10003ECE:				; CODE XREF: .text:10003EBEj
					; .text:10003EC4j
		dec	esi

loc_10003ECF:				; CODE XREF: .text:10003EC6j
					; .text:10003ECCj
		xor	edx, edx
		mov	eax, esi

loc_10003ED3:				; CODE XREF: .text:10003E90j
		pop	esi
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

__aullrem:
		push	ebx
		mov	eax, [esp+14h]
		or	eax, eax
		jnz	short loc_10003F01
		mov	ecx, [esp+10h]
		mov	eax, [esp+0Ch]
		xor	edx, edx
		div	ecx
		mov	eax, [esp+8]
		div	ecx
		mov	eax, edx
		xor	edx, edx
		jmp	short loc_10003F51
; ---------------------------------------------------------------------------

loc_10003F01:				; CODE XREF: .text:10003EE7j
		mov	ecx, eax
		mov	ebx, [esp+10h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]

loc_10003F0F:				; CODE XREF: .text:10003F19j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_10003F0F
		div	ebx
		mov	ecx, eax
		mul	dword ptr [esp+14h]
		xchg	eax, ecx
		mul	dword ptr [esp+10h]
		add	edx, ecx
		jb	short loc_10003F3A
		cmp	edx, [esp+0Ch]
		ja	short loc_10003F3A
		jb	short loc_10003F42
		cmp	eax, [esp+8]
		jbe	short loc_10003F42

loc_10003F3A:				; CODE XREF: .text:10003F2Aj
					; .text:10003F30j
		sub	eax, [esp+10h]
		sbb	edx, [esp+14h]

loc_10003F42:				; CODE XREF: .text:10003F32j
					; .text:10003F38j
		sub	eax, [esp+8]
		sbb	edx, [esp+0Ch]
		neg	edx
		neg	eax
		sbb	edx, 0

loc_10003F51:				; CODE XREF: .text:10003EFFj
		pop	ebx
		retn	10h
; [0000008D BYTES: COLLAPSED FUNCTION _calloc]
		align 10h
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat]
; [000001AD BYTES: COLLAPSED FUNCTION __setmbcp]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow]
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA]
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy]
; [00000073 BYTES: COLLAPSED FUNCTION __dosmaperr]
; [00000009 BYTES: COLLAPSED FUNCTION __errno]
; [00000009 BYTES: COLLAPSED FUNCTION ___doserrno]
; [0000007F BYTES: COLLAPSED FUNCTION __free_osfhnd]
; [00000042 BYTES: COLLAPSED FUNCTION __get_osfhandle]
; [0000005F BYTES: COLLAPSED FUNCTION __lock_fhandle]
; [00000022 BYTES: COLLAPSED FUNCTION __unlock_fhandle]
; [00000081 BYTES: COLLAPSED FUNCTION __fcloseall]
; [0000002E BYTES: COLLAPSED FUNCTION __fflush_lk]
; [0000005C BYTES: COLLAPSED FUNCTION __flush]

; =============== S U B	R O U T	I N E =======================================


sub_10004C70	proc near		; CODE XREF: ___endstdiop
		push	1
		call	_flsall
		pop	ecx
		retn
sub_10004C70	endp

; [000000A4 BYTES: COLLAPSED FUNCTION _flsall]

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_10004D1D	proc near		; DATA XREF: .data:off_100085F0o
					; .data:100085F4o ...
		push	2		; NumberOfBytesWritten
		call	__amsg_exit
sub_10004D1D	endp

; ---------------------------------------------------------------------------
		db  59h	; Y
		db 0C3h	; 
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA]
; [00000031 BYTES: COLLAPSED FUNCTION _fclose]
; [0000004C BYTES: COLLAPSED FUNCTION __fclose_lk]
; [00000093 BYTES: COLLAPSED FUNCTION __commit]
; [00000084 BYTES: COLLAPSED FUNCTION _strcmp]
		align 10h
; [0000003E BYTES: COLLAPSED FUNCTION _strcspn]
		align 10h
; [0000003A BYTES: COLLAPSED FUNCTION _strpbrk]
		align 4
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_10008C30
		jmp	short __NLG_Go
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify]
		align 4
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION __except_handler3]
; [0000001B BYTES: COLLAPSED FUNCTION _seh_longjmp_unwind(x)]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe]
; [0000005D BYTES: COLLAPSED FUNCTION __close]
; [00000083 BYTES: COLLAPSED FUNCTION __close_lk]
; [0000002B BYTES: COLLAPSED FUNCTION __freebuf]
		align 10h
; [000000D0 BYTES: COLLAPSED FUNCTION __strcmpi]
; [00000101 BYTES: COLLAPSED FUNCTION __strnicmp]
; [00000075 BYTES: COLLAPSED FUNCTION __isctype]
; [000000CB BYTES: COLLAPSED FUNCTION _tolower]
		align 10h

__allmul:
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		or	ecx, eax
		mov	ecx, [esp+0Ch]
		jnz	short hard
		mov	eax, [esp+4]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

hard:					; CODE XREF: .text:1000597Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		mul	dword ptr [esp+14h]
		add	ebx, eax
		mov	eax, [esp+8]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 800h
_text		ends

; Section 2. (virtual address 00006000)
; Virtual size			: 00001029 (   4137.)
; Section size in file		: 00002000 (   8192.)
; Offset to raw	data for section: 00006000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: CopyRegistryKeyValues+4Dp
					; DATA XREF: CopyRegistryKeyValues+4Dr	...
; BOOL __stdcall CloseServiceHandle(SC_HANDLE hSCObject)
		extrn CloseServiceHandle:dword ; CODE XREF: PGPclStartMemLockDriver+175p
					; PGPclStartMemLockDriver+17Dp	...
; SC_HANDLE __stdcall OpenServiceA(SC_HANDLE hSCManager, LPCSTR	lpServiceName, DWORD dwDesiredAccess)
		extrn OpenServiceA:dword ; CODE	XREF: PGPclStartMemLockDriver+76p
					; StopService+22p ...
; SC_HANDLE __stdcall CreateServiceA(SC_HANDLE hSCManager, LPCSTR lpServiceName, LPCSTR	lpDisplayName, DWORD dwDesiredAccess, DWORD dwServiceType, DWORD dwStartType, DWORD dwErrorControl, LPCSTR lpBinaryPathName, LPCSTR lpLoadOrderGroup, LPDWORD lpdwTagId, LPCSTR	lpDependencies,	LPCSTR lpServiceStartName, LPCSTR lpPassword)
		extrn CreateServiceA:dword ; CODE XREF:	PGPclStartMemLockDriver+11Ep
					; AddSrv+105p ...
; BOOL __stdcall QueryServiceStatus(SC_HANDLE hService,	LPSERVICE_STATUS lpServiceStatus)
		extrn QueryServiceStatus:dword ; CODE XREF: PGPclStartMemLockDriver+137p
					; DelSrv+64p ...
; BOOL __stdcall StartServiceA(SC_HANDLE hService, DWORD dwNumServiceArgs, LPCSTR *lpServiceArgVectors)
		extrn StartServiceA:dword ; CODE XREF: PGPclStartMemLockDriver+154p
					; StartServ+30p
					; DATA XREF: ...
; SC_HANDLE __stdcall OpenSCManagerA(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD	dwDesiredAccess)
		extrn OpenSCManagerA:dword ; CODE XREF:	PGPclStartMemLockDriver+42p
					; StopService+Fp ...
; BOOL __stdcall ControlService(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus)
		extrn ControlService:dword ; CODE XREF:	StopService+32p
					; DelSrv+79p ...
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: CopyRegistryKeyValues+87p
					; CopyRegistryKeyValues+14Dp ...
; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey,	DWORD Reserved,	LPSTR lpClass, DWORD dwOptions,	REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; CODE XREF: CopyRegistryKeyValues+74p
					; DATA XREF: CopyRegistryKeyValues+74r
; LSTATUS __stdcall RegSetValueExA(HKEY	hKey, LPCSTR lpValueName, DWORD	Reserved, DWORD	dwType,	const BYTE *lpData, DWORD cbData)
		extrn RegSetValueExA:dword ; CODE XREF:	CopyRegistryKeyValues+11Ep
					; DATA XREF: CopyRegistryKeyValues+11Er
; BOOL __stdcall DeleteService(SC_HANDLE hService)
		extrn DeleteService:dword ; CODE XREF: DelSrv+87p DelSrv+D3p
					; DATA XREF: ...
; LSTATUS __stdcall RegEnumValueA(HKEY hKey, DWORD dwIndex, LPSTR lpValueName, LPDWORD lpcchValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData)
		extrn RegEnumValueA:dword ; CODE XREF: CopyRegistryKeyValues+C9p
					; CopyRegistryKeyValues+100p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: AddSrv+6Cp
					; AddSrv+17Cp ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: DelSrv+84p DelSrv+D0p ...
; DWORD	__stdcall GetShortPathNameA(LPCSTR lpszLongPath, LPSTR lpszShortPath, DWORD cchBuffer)
		extrn GetShortPathNameA:dword ;	CODE XREF: CreateAndWait+71p
					; DATA XREF: CreateAndWait+71r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	CreateAndWait+90p
					; DATA XREF: CreateAndWait+90r
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: CreateAndWait+C3p
					; DATA XREF: CreateAndWait+C3r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: CreateAndWait+D4p
					; CreateAndWait+DBp ...
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn GetVersionExA:dword ; CODE XREF: PGPclStartMemLockDriver+1Cp
					; sub_100019D0+15p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: PGPclStartMemLockDriver+54p
					; PGPclStartMemLockDriver+8Cp ...
; UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize)
		extrn GetSystemDirectoryA:dword	; CODE XREF: PGPclStartMemLockDriver+A9p
					; DATA XREF: PGPclStartMemLockDriver+A9r
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: PGPclStartMemLockDriver+B4p
					; DATA XREF: PGPclStartMemLockDriver+B4r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: __lock+58p
					; __lock_file+28p ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: __getptd+5Cp
					; DATA XREF: __getptd+5Cr
; DWORD	__stdcall TlsAlloc()
		extrn TlsAlloc:dword	; CODE XREF: __mtinit+6p
					; DATA XREF: __mtinit+6r
; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
		extrn TlsFree:dword	; CODE XREF: __mtterm+10p
					; DATA XREF: __mtterm+10r
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: __commit+47p
					; DATA XREF: __commit+47r
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+40p	__heap_term+46p ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+45p
					; ___sbh_heap_init+Dp ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: _CRT_INIT(x,x,x):loc_10002100p
					; DATA XREF: _CRT_INIT(x,x,x):loc_10002100r
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: _CRT_INIT(x,x,x)+Dp
					; DATA XREF: _CRT_INIT(x,x,x)+Dr
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; __heap_term+6Cp
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: __heap_term+2Ep
					; __heap_term+39p ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: __mtinitlocks+Dp
					; __mtinitlocks+15p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: __mtdeletelocks+34p
					; __mtdeletelocks+4Fp ...
; LPSTR	__stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcatA:dword	; CODE XREF: PGPclStartMemLockDriver+D3p
					; PGPclStartMemLockDriver+DFp ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: __unlock+Dp
					; __unlock_file+28p ...
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _doexit+9Dp
					; DATA XREF: _doexit+9Dr
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: ___sbh_alloc_new_region+28p
					; DATA XREF: ___sbh_alloc_new_region+28r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+1Cp
					; DATA XREF: _doexit+1Cr
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+15p
					; DATA XREF: _doexit+15r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: __mtinit+3Fp
					; __getptd+45p
					; DATA XREF: ...
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn TlsSetValue:dword	; CODE XREF: __mtinit+2Ep __getptd+34p ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtLCMapStringA+DFp
					; ___crtLCMapStringA+137p ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: __getptd+10p
					; __freeptd+18p
					; DATA XREF: ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+1B1p
					; DATA XREF: __ioinit+1B1r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+16Cp
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __ioinit+109p
					; __ioinit+17Ap
					; DATA XREF: ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: __ioinit+5Ep
					; DATA XREF: __ioinit+5Er
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+93p
					; ___crtGetEnvironmentStringsA+B5p ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_10003454p
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+51p
					; _setSBUpLow+14p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __NMSG_WRITE+14Ap
					; __write_lk+C7p ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	__lseek_lk+2Ap
					; DATA XREF: __lseek_lk+2Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	___crtMessageBoxA+2Ap
					; ___crtMessageBoxA+3Bp ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: ___crtMessageBoxA+12p
					; DATA XREF: ___crtMessageBoxA+12r
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn SetStdHandle:dword ; CODE	XREF: __free_osfhnd:loc_10004A79p
					; DATA XREF: __free_osfhnd:loc_10004A79r

;
; Imports from SHELL32.dll
;
; HRESULT __stdcall SHGetMalloc(IMalloc	**ppMalloc)
		extrn SHGetMalloc:dword	; CODE XREF: MyBrowseForFolder32+Dp
					; DATA XREF: MyBrowseForFolder32+Dr ...
; LPITEMIDLIST __stdcall SHBrowseForFolderA(LPBROWSEINFOA lpbi)
		extrn SHBrowseForFolderA:dword ; CODE XREF: MyBrowseForFolder32+64p
					; DATA XREF: MyBrowseForFolder32+64r
; BOOL __stdcall SHGetPathFromIDListA(LPCITEMIDLIST pidl, LPSTR	pszPath)
		extrn SHGetPathFromIDListA:dword ; CODE	XREF: MyBrowseForFolder32+72p
					; DATA XREF: MyBrowseForFolder32+72r

;
; Imports from USER32.dll
;
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: .text:10001088p
					; .text:10001107p
					; DATA XREF: ...
; int __stdcall	GetSystemMetrics(int nIndex)
		extrn GetSystemMetrics:dword ; CODE XREF: .text:10001058p
					; .text:1000106Ep ...
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: .text:10001044p
					; .text:100010C6p
					; DATA XREF: ...
; HWND __stdcall GetParent(HWND	hWnd)
		extrn GetParent:dword	; CODE XREF: .text:10001041p
					; .text:10001085p
					; DATA XREF: ...
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: CreateAndWait+ADp
					; DelSrv+10Dp ...
; HWND __stdcall GetFocus()
		extrn GetFocus:dword	; CODE XREF: CreateAndWait+A6p
					; DATA XREF: CreateAndWait+A6r

;
; Imports from comdlg32.dll
;
; BOOL __stdcall GetOpenFileNameA(LPOPENFILENAMEA)
		extrn __imp_GetOpenFileNameA:dword ; DATA XREF:	GetOpenFileNameAr
					; .rdata:100066C8o

;
; Imports from ole32.dll
;
; HRESULT __stdcall OleInitialize(LPVOID pvReserved)
		extrn OleInitialize:dword ; CODE XREF: MyGetOpenFileName32+51p
					; DATA XREF: MyGetOpenFileName32+51r ...
; void __stdcall OleUninitialize()
		extrn OleUninitialize:dword ; CODE XREF: MyGetOpenFileName32+66p
					; DATA XREF: MyGetOpenFileName32+66r


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 10006160h
		dd 6000006h, 100h, 6030010h, 10020600h,	45454504h, 5050505h
		dd 303505h, 50h, 38282000h, 8075850h, 30303700h, 75057h
		dd 8202000h, 0
		db 8,'`h````',0
dword_100061A0	dd 78707000h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
		dd 8, 6E0028h, 6C0075h,	29006Ch, 0
aNull		db '(null)',0           ; DATA XREF: .data:100082ACo
		align 4
aRuntimeError	db 'runtime error ',0   ; DATA XREF: .data:1000836Co
		align 4
asc_100061E4	db 0Dh,0Ah,0		; DATA XREF: .data:10008364o
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0 ; DATA XREF: .data:1000835Co
		align 4
aSingError	db 'SING error',0Dh,0Ah,0 ; DATA XREF: .data:10008354o
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0 ; DATA XREF: .data:1000834Co
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah      ; DATA XREF: .data:10008344o
		db '- unable to initialize heap',0Dh,0Ah,0
		align 10h
aR6027NotEnough	db 'R6027',0Dh,0Ah      ; DATA XREF: .data:1000833Co
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah      ; DATA XREF: .data:10008334o
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 10h
aR6025PureVirtu	db 'R6025',0Dh,0Ah      ; DATA XREF: .data:1000832Co
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah      ; DATA XREF: .data:10008324o
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 10h
aR6019UnableToO	db 'R6019',0Dh,0Ah      ; DATA XREF: .data:1000831Co
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah      ; DATA XREF: .data:10008314o
		db '- unexpected heap error',0Dh,0Ah,0
		align 10h
aR6017Unexpecte	db 'R6017',0Dh,0Ah      ; DATA XREF: .data:1000830Co
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 10h
aR6016NotEnough	db 'R6016',0Dh,0Ah      ; DATA XREF: .data:10008304o
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah		; DATA XREF: .data:100082FCo
		db 'abnormal program termination',0Dh,0Ah,0
		align 10h
aR6009NotEnough	db 'R6009',0Dh,0Ah      ; DATA XREF: .data:100082F4o
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah      ; DATA XREF: .data:100082ECo
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_100082E4o
		db '- floating point not loaded',0Dh,0Ah,0
		align 10h
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_10006488[]
asc_10006488	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char a___[]
a___		db '...',0              ; DATA XREF: __NMSG_WRITE+BFo
; char aProgramNameUnk[]
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 4
; CHAR aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; CHAR aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; CHAR ProcName[]
ProcName	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 10h
; CHAR byte_10006500[4]
byte_10006500	db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o
		align 4
stru_10006508	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_10004E98, \
					; DATA XREF: ___crtLCMapStringA+5o
				   offset loc_10004E9C>	; SEH scope table for function 10004D88
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_10004F4C, \
				   offset loc_10004F50>
stru_10006520	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100050D0, \
					; DATA XREF: ___crtGetStringTypeA+5o
				   offset loc_100050D4>	; SEH scope table for function 10004FD7
aHMmSs		db 'H:mm:ss',0          ; DATA XREF: .data:10008CF0o
aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:10008CECo
aMDYy		db 'M/d/yy',0           ; DATA XREF: .data:10008CE8o
		align 10h
aPm		db 'PM',0               ; DATA XREF: .data:10008CE4o
		align 4
aAm		db 'AM',0               ; DATA XREF: .data:10008CE0o
		align 4
aDecember	db 'December',0         ; DATA XREF: .data:10008CDCo
		align 4
aNovember	db 'November',0         ; DATA XREF: .data:10008CD8o
		align 10h
aOctober	db 'October',0          ; DATA XREF: .data:10008CD4o
aSeptember	db 'September',0        ; DATA XREF: .data:10008CD0o
		align 4
aAugust		db 'August',0           ; DATA XREF: .data:10008CCCo
		align 4
aJuly		db 'July',0             ; DATA XREF: .data:10008CC8o
		align 4
aJune		db 'June',0             ; DATA XREF: .data:10008CC4o
		align 4
aApril		db 'April',0            ; DATA XREF: .data:10008CBCo
		align 4
aMarch		db 'March',0            ; DATA XREF: .data:10008CB8o
		align 4
aFebruary	db 'February',0         ; DATA XREF: .data:10008CB4o
		align 4
aJanuary	db 'January',0          ; DATA XREF: .data:10008CB0o
aDec		db 'Dec',0              ; DATA XREF: .data:10008CACo
aNov		db 'Nov',0              ; DATA XREF: .data:10008CA8o
aOct		db 'Oct',0              ; DATA XREF: .data:10008CA4o
aSep		db 'Sep',0              ; DATA XREF: .data:10008CA0o
aAug		db 'Aug',0              ; DATA XREF: .data:10008C9Co
aJul		db 'Jul',0              ; DATA XREF: .data:10008C98o
aJun		db 'Jun',0              ; DATA XREF: .data:10008C94o
aMay		db 'May',0              ; DATA XREF: .data:10008C90o
					; .data:10008CC0o
aApr		db 'Apr',0              ; DATA XREF: .data:10008C8Co
aMar		db 'Mar',0              ; DATA XREF: .data:10008C88o
aFeb		db 'Feb',0              ; DATA XREF: .data:10008C84o
aJan		db 'Jan',0              ; DATA XREF: .data:10008C80o
aSaturday	db 'Saturday',0         ; DATA XREF: .data:10008C7Co
		align 4
aFriday		db 'Friday',0           ; DATA XREF: .data:10008C78o
		align 4
aThursday	db 'Thursday',0         ; DATA XREF: .data:10008C74o
		align 10h
aWednesday	db 'Wednesday',0        ; DATA XREF: .data:10008C70o
		align 4
aTuesday	db 'Tuesday',0          ; DATA XREF: .data:10008C6Co
aMonday		db 'Monday',0           ; DATA XREF: .data:10008C68o
		align 4
aSunday		db 'Sunday',0           ; DATA XREF: .data:10008C64o
		align 4
aSat		db 'Sat',0              ; DATA XREF: .data:10008C60o
aFri		db 'Fri',0              ; DATA XREF: .data:10008C5Co
aThu		db 'Thu',0              ; DATA XREF: .data:10008C58o
aWed		db 'Wed',0              ; DATA XREF: .data:10008C54o
aTue		db 'Tue',0              ; DATA XREF: .data:10008C50o
aMon		db 'Mon',0              ; DATA XREF: .data:10008C4Co
aSun		db 'Sun',0              ; DATA XREF: .data:off_10008C48o
aSunmontuewedth	db 'SunMonTueWedThuFriSat',0
		align 4
aJanfebmaraprma	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
		align 10h
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_10006754 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva GetModuleFileNameA ; Import Address Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_1000684C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva SetWindowPos	; Import Address Table
__IMPORT_DESCRIPTOR_comdlg32 dd	rva off_10006868 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aComdlg32_dll	; DLL Name
		dd rva __imp_GetOpenFileNameA ;	Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_1000671C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegOpenKeyExA	; Import Address Table
__IMPORT_DESCRIPTOR_SHELL32 dd rva off_1000683C	; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aShell32_dll	; DLL Name
		dd rva SHGetMalloc	; Import Address Table
__IMPORT_DESCRIPTOR_ole32 dd rva off_10006870 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aOle32_dll	; DLL Name
		dd rva OleInitialize	; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_1000671C	dd rva word_10006A9C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_10006A10
		dd rva word_10006A00
		dd rva word_100069EE
		dd rva word_100069D8
		dd rva word_100069C8
		dd rva word_10006A26
		dd rva word_10006A38
		dd rva word_10006A7C
		dd rva word_10006A8A
		dd rva word_10006A5A
		dd rva word_10006A4A
		dd rva word_10006A6C
		dd 0
;
; Import names for KERNEL32.dll
;
off_10006754	dd rva word_1000691C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_10006914
		dd rva word_10006900
		dd rva word_100068EE
		dd rva word_100068D8
		dd rva word_100068CA
		dd rva word_100068BA
		dd rva word_100068AA
		dd rva word_10006894
		dd rva word_10006888
		dd rva word_10006BC4
		dd rva word_10006C82
		dd rva word_10006C6C
		dd rva word_10006C78
		dd rva word_10006E3E
		dd rva word_10006E2A
		dd rva word_10006E18
		dd rva word_10006E06
		dd rva word_10006DF6
		dd rva word_10006DE6
		dd rva word_10006B2E
		dd rva word_10006B3A
		dd rva word_10006B46
		dd rva word_10006B58
		dd rva word_10006B66
		dd rva word_10006B74
		dd rva word_10006B82
		dd rva word_10006B90
		dd rva word_10006BAC
		dd rva word_1000687C
		dd rva word_10006BDC
		dd rva word_10006BF4
		dd rva word_10006C02
		dd rva word_10006C12
		dd rva word_10006C20
		dd rva word_10006C34
		dd rva word_10006C48
		dd rva word_10006C5E
		dd rva word_10006DD0
		dd rva word_10006D44
		dd rva word_10006C92
		dd rva word_10006CA0
		dd rva word_10006CB2
		dd rva word_10006CC2
		dd rva word_10006CD0
		dd rva word_10006CE2
		dd rva word_10006CFC
		dd rva word_10006D16
		dd rva word_10006D2C
		dd rva word_10006D7C
		dd rva word_10006D5E
		dd rva word_10006D6A
		dd rva word_10006D88
		dd rva word_10006D92
		dd rva word_10006D9E
		dd rva word_10006DB0
		dd rva word_10006DC0
		dd 0
;
; Import names for SHELL32.dll
;
off_1000683C	dd rva word_10006AE8	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_SHELL32o
		dd rva word_10006AD2
		dd rva word_10006ABA
		dd 0
;
; Import names for USER32.dll
;
off_1000684C	dd rva word_10006940	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_10006950
		dd rva word_10006964
		dd rva word_10006974
		dd rva word_10006980
		dd rva word_1000698E
		dd 0
;
; Import names for comdlg32.dll
;
off_10006868	dd rva word_100069A6	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_comdlg32o
		dd 0
;
; Import names for ole32.dll
;
off_10006870	dd rva word_10006B14	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ole32o
		dd rva word_10006B02
		dd 0
word_1000687C	dw 326h			; DATA XREF: .rdata:100067C8o
		db 'lstrcatA',0
		align 4
word_10006888	dw 335h			; DATA XREF: .rdata:10006778o
		db 'lstrlenA',0
		align 4
word_10006894	dw 170h			; DATA XREF: .rdata:10006774o
		db 'GetSystemDirectoryA',0
word_100068AA	dw 12Dh			; DATA XREF: .rdata:10006770o
		db 'GetLastError',0
		align 2
word_100068BA	dw 18Fh			; DATA XREF: .rdata:1000676Co
		db 'GetVersionExA',0
word_100068CA	dw 1Eh			; DATA XREF: .rdata:10006768o
		db 'CloseHandle',0
word_100068D8	dw 2FDh			; DATA XREF: .rdata:10006764o
		db 'WaitForSingleObject',0
word_100068EE	dw 47h			; DATA XREF: .rdata:10006760o
		db 'CreateProcessA',0
		align 10h
word_10006900	dw 164h			; DATA XREF: .rdata:1000675Co
		db 'GetShortPathNameA',0
word_10006914	dw 2C3h			; DATA XREF: .rdata:10006758o
		db 'Sleep',0
word_1000691C	dw 138h			; DATA XREF: .rdata:off_10006754o
		db 'GetModuleFileNameA',0
		align 2
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:1000669Co
		align 10h
word_10006940	dw 260h			; DATA XREF: .rdata:off_1000684Co
		db 'SetWindowPos',0
		align 10h
word_10006950	dw 149h			; DATA XREF: .rdata:10006850o
		db 'GetSystemMetrics',0
		align 4
word_10006964	dw 160h			; DATA XREF: .rdata:10006854o
		db 'GetWindowRect',0
word_10006974	dw 138h			; DATA XREF: .rdata:10006858o
		db 'GetParent',0
word_10006980	dw 1C3h			; DATA XREF: .rdata:1000685Co
		db 'MessageBoxA',0
word_1000698E	dw 10Ah			; DATA XREF: .rdata:10006860o
		db 'GetFocus',0
		align 2
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:100066B0o
		align 2
word_100069A6	dw 9			; DATA XREF: .rdata:off_10006868o
		db 'GetOpenFileNameA',0
		align 2
aComdlg32_dll	db 'comdlg32.dll',0     ; DATA XREF: .rdata:100066C4o
		align 4
word_100069C8	dw 1E4h			; DATA XREF: .rdata:10006730o
		db 'StartServiceA',0
word_100069D8	dw 17Dh			; DATA XREF: .rdata:1000672Co
		db 'QueryServiceStatus',0
		align 2
word_100069EE	dw 5Ah			; DATA XREF: .rdata:10006728o
		db 'CreateServiceA',0
		align 10h
word_10006A00	dw 16Ah			; DATA XREF: .rdata:10006724o
		db 'OpenServiceA',0
		align 10h
word_10006A10	dw 3Ah			; DATA XREF: .rdata:10006720o
		db 'CloseServiceHandle',0
		align 2
word_10006A26	dw 168h			; DATA XREF: .rdata:10006734o
		db 'OpenSCManagerA',0
		align 4
word_10006A38	dw 3Dh			; DATA XREF: .rdata:10006738o
		db 'ControlService',0
		align 2
word_10006A4A	dw 87h			; DATA XREF: .rdata:10006748o
		db 'DeleteService',0
word_10006A5A	dw 1B2h			; DATA XREF: .rdata:10006744o
		db 'RegSetValueExA',0
		align 4
word_10006A6C	dw 194h			; DATA XREF: .rdata:1000674Co
		db 'RegEnumValueA',0
word_10006A7C	dw 184h			; DATA XREF: .rdata:1000673Co
		db 'RegCloseKey',0
word_10006A8A	dw 188h			; DATA XREF: .rdata:10006740o
		db 'RegCreateKeyExA',0
word_10006A9C	dw 19Dh			; DATA XREF: .rdata:off_1000671Co
		db 'RegOpenKeyExA',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:100066D8o
		align 2
word_10006ABA	dw 5Eh			; DATA XREF: .rdata:10006844o
		db 'SHGetPathFromIDListA',0
		align 2
word_10006AD2	dw 3Bh			; DATA XREF: .rdata:10006840o
		db 'SHBrowseForFolderA',0
		align 4
word_10006AE8	dw 59h			; DATA XREF: .rdata:off_1000683Co
		db 'SHGetMalloc',0
aShell32_dll	db 'SHELL32.dll',0      ; DATA XREF: .rdata:100066ECo
word_10006B02	dw 0EEh			; DATA XREF: .rdata:10006874o
		db 'OleUninitialize',0
word_10006B14	dw 0D7h			; DATA XREF: .rdata:off_10006870o
		db 'OleInitialize',0
aOle32_dll	db 'ole32.dll',0        ; DATA XREF: .rdata:10006700o
word_10006B2E	dw 1BAh			; DATA XREF: .rdata:100067A4o
		db 'HeapFree',0
		align 2
word_10006B3A	dw 1B4h			; DATA XREF: .rdata:100067A8o
		db 'HeapAlloc',0
word_10006B46	dw 0DAh			; DATA XREF: .rdata:100067ACo
		db 'GetCommandLineA',0
word_10006B58	dw 18Eh			; DATA XREF: .rdata:100067B0o
		db 'GetVersion',0
		align 2
word_10006B66	dw 1B8h			; DATA XREF: .rdata:100067B4o
		db 'HeapDestroy',0
word_10006B74	dw 1B6h			; DATA XREF: .rdata:100067B8o
		db 'HeapCreate',0
		align 2
word_10006B82	dw 2F1h			; DATA XREF: .rdata:100067BCo
		db 'VirtualFree',0
word_10006B90	dw 1C5h			; DATA XREF: .rdata:100067C0o
		db 'InitializeCriticalSection',0
word_10006BAC	dw 5Ah			; DATA XREF: .rdata:100067C4o
		db 'DeleteCriticalSection',0
word_10006BC4	dw 6Fh			; DATA XREF: .rdata:1000677Co
		db 'EnterCriticalSection',0
		align 4
word_10006BDC	dw 1DEh			; DATA XREF: .rdata:100067CCo
		db 'LeaveCriticalSection',0
		align 4
word_10006BF4	dw 8Ch			; DATA XREF: .rdata:100067D0o
		db 'ExitProcess',0
word_10006C02	dw 2EEh			; DATA XREF: .rdata:100067D4o
		db 'VirtualAlloc',0
		align 2
word_10006C12	dw 1BDh			; DATA XREF: .rdata:100067D8o
		db 'HeapReAlloc',0
word_10006C20	dw 2CBh			; DATA XREF: .rdata:100067DCo
		db 'TerminateProcess',0
		align 4
word_10006C34	dw 109h			; DATA XREF: .rdata:100067E0o
		db 'GetCurrentProcess',0
word_10006C48	dw 10Ch			; DATA XREF: .rdata:100067E4o
		db 'GetCurrentThreadId',0
		align 2
word_10006C5E	dw 2D3h			; DATA XREF: .rdata:100067E8o
		db 'TlsSetValue',0
word_10006C6C	dw 2D0h			; DATA XREF: .rdata:10006784o
		db 'TlsAlloc',0
		align 4
word_10006C78	dw 2D1h			; DATA XREF: .rdata:10006788o
		db 'TlsFree',0
word_10006C82	dw 29Ch			; DATA XREF: .rdata:10006780o
		db 'SetLastError',0
		align 2
word_10006C92	dw 2D2h			; DATA XREF: .rdata:100067F4o
		db 'TlsGetValue',0
word_10006CA0	dw 298h			; DATA XREF: .rdata:100067F8o
		db 'SetHandleCount',0
		align 2
word_10006CB2	dw 168h			; DATA XREF: .rdata:100067FCo
		db 'GetStdHandle',0
		align 2
word_10006CC2	dw 128h			; DATA XREF: .rdata:10006800o
		db 'GetFileType',0
word_10006CD0	dw 166h			; DATA XREF: .rdata:10006804o
		db 'GetStartupInfoA',0
word_10006CE2	dw 0C1h			; DATA XREF: .rdata:10006808o
		db 'FreeEnvironmentStringsA',0
word_10006CFC	dw 0C2h			; DATA XREF: .rdata:1000680Co
		db 'FreeEnvironmentStringsW',0
word_10006D16	dw 301h			; DATA XREF: .rdata:10006810o
		db 'WideCharToMultiByte',0
word_10006D2C	dw 119h			; DATA XREF: .rdata:10006814o
		db 'GetEnvironmentStrings',0
word_10006D44	dw 11Bh			; DATA XREF: .rdata:100067F0o
		db 'GetEnvironmentStringsW',0
		align 2
word_10006D5E	dw 30Eh			; DATA XREF: .rdata:1000681Co
		db 'WriteFile',0
word_10006D6A	dw 295h			; DATA XREF: .rdata:10006820o
		db 'SetFilePointer',0
		align 4
word_10006D7C	dw 0CFh			; DATA XREF: .rdata:10006818o
		db 'GetCPInfo',0
word_10006D88	dw 0C9h			; DATA XREF: .rdata:10006824o
		db 'GetACP',0
		align 2
word_10006D92	dw 146h			; DATA XREF: .rdata:10006828o
		db 'GetOEMCP',0
		align 2
word_10006D9E	dw 153h			; DATA XREF: .rdata:1000682Co
		db 'GetProcAddress',0
		align 10h
word_10006DB0	dw 1DFh			; DATA XREF: .rdata:10006830o
		db 'LoadLibraryA',0
		align 10h
word_10006DC0	dw 2A8h			; DATA XREF: .rdata:10006834o
		db 'SetStdHandle',0
		align 10h
word_10006DD0	dw 202h			; DATA XREF: .rdata:100067ECo
		db 'MultiByteToWideChar',0
word_10006DE6	dw 1DCh			; DATA XREF: .rdata:100067A0o
		db 'LCMapStringA',0
		align 2
word_10006DF6	dw 1DDh			; DATA XREF: .rdata:1000679Co
		db 'LCMapStringW',0
		align 2
word_10006E06	dw 169h			; DATA XREF: .rdata:10006798o
		db 'GetStringTypeA',0
		align 4
word_10006E18	dw 16Ch			; DATA XREF: .rdata:10006794o
		db 'GetStringTypeW',0
		align 2
word_10006E2A	dw 0B9h			; DATA XREF: .rdata:10006790o
		db 'FlushFileBuffers',0
		align 2
word_10006E3E	dw 257h			; DATA XREF: .rdata:1000678Co
		db 'RtlUnwind',0
		align 10h
;
; Export directory for INSTALL.dll
;
		dd 0			; Characteristics
		dd 39A0501Fh		; TimeDateStamp: Sun Aug 20 21:39:43 2000
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aInstall_dll	; Name
		dd 1			; Base
		dd 10h			; NumberOfFunctions
		dd 10h			; NumberOfNames
		dd rva off_10006E78	; AddressOfFunctions
		dd rva off_10006EB8	; AddressOfNames
		dd rva word_10006EF8	; AddressOfNameOrdinals
;
; Export Address Table for INSTALL.dll
;
off_10006E78	dd rva SetPermissions, rva SetRegPermissions, rva AddSrv
					; DATA XREF: .rdata:10006E6Co
		dd rva CopyRegistryKeyValues, rva CreateAndWait, rva UninstInitialize
		dd rva DelSrv, rva IsWin2000Compatible,	rva IsWin95OSR2Compatible
		dd rva MyBrowseForFolder32, rva	MyGetOpenFileName32, rva PGPclStartMemLockDriver
		dd rva StartServ, rva StopService, rva UninstInitialize
		dd rva UninstUnInitialize
;
; Export Names Table for INSTALL.dll
;
off_10006EB8	dd rva aAddsrv,	rva aCopyregistryke, rva aCreateandwait
					; DATA XREF: .rdata:10006E70o
		dd rva aCreateiisvdir, rva aDelsrv, rva	aIswin2000compa	; "SetPermissions"
		dd rva aIswin95osr2com,	rva aMybrowseforfol, rva aMygetopenfilen
		dd rva aPgpclstartmeml,	rva aSetpermissions, rva aSetregpermissi
		dd rva aStartserv, rva aStopservice, rva aUninstinitiali
		dd rva aUninstuninitia
;
; Export Ordinals Table	for INSTALL.dll
;
word_10006EF8	dw 2, 3, 4, 5, 6, 7, 8,	9, 0Ah,	0Bh, 0,	1, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:10006E74o
		dw 0Fh
aInstall_dll	db 'INSTALL.dll',0      ; DATA XREF: .rdata:10006E5Co
aSetpermissions	db 'SetPermissions',0   ; DATA XREF: .rdata:off_10006EB8o
aSetregpermissi	db 'SetRegPermissions',0 ; DATA XREF: .rdata:off_10006EB8o
aAddsrv		db 'AddSrv',0           ; DATA XREF: .rdata:off_10006EB8o
aCopyregistryke	db 'CopyRegistryKeyValues',0 ; DATA XREF: .rdata:off_10006EB8o
aCreateandwait	db 'CreateAndWait',0    ; DATA XREF: .rdata:off_10006EB8o
aCreateiisvdir	db 'CreateIISVDir',0    ; DATA XREF: .rdata:off_10006EB8o
aDelsrv		db 'DelSrv',0           ; DATA XREF: .rdata:off_10006EB8o
aIswin2000compa	db 'IsWin2000Compatible',0 ; DATA XREF: .rdata:off_10006EB8o
aIswin95osr2com	db 'IsWin95OSR2Compatible',0 ; DATA XREF: .rdata:off_10006EB8o
aMybrowseforfol	db 'MyBrowseForFolder32',0 ; DATA XREF: .rdata:off_10006EB8o
aMygetopenfilen	db 'MyGetOpenFileName32',0 ; DATA XREF: .rdata:off_10006EB8o
aPgpclstartmeml	db 'PGPclStartMemLockDriver',0 ; DATA XREF: .rdata:off_10006EB8o
aStartserv	db 'StartServ',0        ; DATA XREF: .rdata:off_10006EB8o
aStopservice	db 'StopService',0      ; DATA XREF: .rdata:off_10006EB8o
aUninstinitiali	db 'UninstInitialize',0 ; DATA XREF: .rdata:off_10006EB8o
aUninstuninitia	db 'UninstUnInitialize',0 ; DATA XREF: .rdata:off_10006EB8o
		align 1000h
_rdata		ends

; Section 3. (virtual address 00008000)
; Virtual size			: 0000261C (   9756.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00008000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 10008000h
dword_10008000	dd 0			; DATA XREF: __cinit+1Fo
dword_10008004	dd 0			; DATA XREF: __cinit+1Ao
dword_10008008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initstdio
		dd offset ___initmbctable
dword_10008014	dd 0			; DATA XREF: __cinit:loc_10002C70o
dword_10008018	dd 0			; DATA XREF: _doexit+6Ao
		dd offset ___endstdio
dword_10008020	dd 0			; DATA XREF: _doexit:loc_10002D17o
dword_10008024	dd 0			; DATA XREF: _doexit+7Bo
dword_10008028	dd 2 dup(0)		; DATA XREF: _doexit:loc_10002D28o
off_10008030	dd offset aAllFiles	; DATA XREF: sub_100011D0r
					; "All Files"
		dd offset dword_1000803C
		dd offset byte_10008E68
dword_1000803C	dd 2A2E2Ah		; DATA XREF: .data:10008034o
aAllFiles	db 'All Files',0        ; DATA XREF: .data:off_10008030o
		align 4
; CHAR a_sys[]
a_sys		db '.sys',0             ; DATA XREF: PGPclStartMemLockDriver+F1o
		align 4
; CHAR aDrivers[]
aDrivers	db 'drivers\',0         ; DATA XREF: PGPclStartMemLockDriver+D9o
		align 10h
; CHAR String2[]
String2		db '\',0                ; DATA XREF: PGPclStartMemLockDriver+CDo
					; AddSrv:loc_10001768o	...
		align 4
; CHAR DisplayName[]
DisplayName	db 'PGPmemlock',0       ; DATA XREF: PGPclStartMemLockDriver+70o
					; PGPclStartMemLockDriver+E5o ...
		align 10h
; CHAR Caption[]
Caption		db 'ERROR',0            ; DATA XREF: CreateAndWait+A0o
		align 4
; CHAR Text[]
Text		db 'bad parm delsrv',0  ; DATA XREF: DelSrv+106o
; CHAR aDelsrv_0[]
aDelsrv_0	db 'DelSrv',0           ; DATA XREF: DelSrv+101o
		align 10h
; CHAR aPgpReplication[]
aPgpReplication	db 'PGP Replication Engine',0 ; DATA XREF: DelSrv+A0o
					; AddSrv+208o ...
		align 4
; CHAR ServiceName[]
ServiceName	db 'PGP Certificate Server',0 ; DATA XREF: DelSrv+4Co
					; AddSrv+F8o ...
		align 10h
aPgprepd_exe	db 'PGPrepd.exe',0      ; DATA XREF: AddSrv+1CCo
; CHAR aBadParmAddsrv[]
aBadParmAddsrv	db 'bad parm addsrv',0  ; DATA XREF: AddSrv+13Ao
; CHAR aAddsrv_0[]
aAddsrv_0	db 'AddSrv',0           ; DATA XREF: AddSrv+135o
		align 4
; CHAR aCanTCreateServ[]
aCanTCreateServ	db 'Can',27h,'t create Service.(It may already exist)',0
					; DATA XREF: AddSrv+112o
aPgpcertd_exe	db 'PGPcertd.exe',0     ; DATA XREF: AddSrv+BCo
		align 10h
aServicePack3	db 'Service Pack 3',0   ; DATA XREF: sub_100019D0:loc_10001AD6o
		align 10h
aServicePack2	db 'Service Pack 2',0   ; DATA XREF: sub_100019D0:loc_10001A8Eo
		align 10h
aServicePack1	db 'Service Pack 1',0   ; DATA XREF: sub_100019D0:loc_10001A46o
		align 10h
; char aHkey_dyn_data[]
aHkey_dyn_data	db 'HKEY_DYN_DATA',0    ; DATA XREF: sub_10001D30+122o
		align 10h
; char aHkey_current_c[]
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_10001D30+FCo
; char aHkey_performan[]
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_10001D30+D6o
		align 4
; char aHkey_users[]
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_10001D30+B0o
		align 4
; char aHkey_local_mac[]
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_10001D30+8Ao
		align 4
; char aHkey_current_u[]
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_10001D30+64o
		align 10h
; char aHkey_classes_r[]
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_10001D30+3Eo
		align 10h
off_100081E0	dd offset __exit	; DATA XREF: __amsg_exit+2Ar
		dd 10h
; LPCRITICAL_SECTION dword_100081E8
dword_100081E8	dd 0			; DATA XREF: __mtdeletelocks+8o
					; __lock+7r ...
; LPCRITICAL_SECTION off_100081EC
off_100081EC	dd offset dword_10008F30 ; DATA	XREF: __mtinitlocks+1Fr
					; __mtdeletelocks+2Bo ...
		dd 7 dup(0)
; LPCRITICAL_SECTION off_1000820C
off_1000820C	dd offset dword_10008F60 ; DATA	XREF: __mtinitlocks+17r
					; __mtdeletelocks+23o ...
		dd 3 dup(0)
; LPCRITICAL_SECTION off_1000821C
off_1000821C	dd offset dword_10008F78 ; DATA	XREF: __mtinitlocks+Fr
					; __mtdeletelocks+1Bo ...
		dd 3 dup(0)
; LPCRITICAL_SECTION lpCriticalSection
lpCriticalSection dd offset dword_10008F48 ; DATA XREF:	__mtinitlocks+7r
					; __mtdeletelocks+13o ...
		dd 1Eh dup(0)
dword_100082A8	dd 3F8h			; DATA XREF: __heap_alloc+5r
					; __mtdeletelocks+41o ...
		dd offset aNull		; "(null)"
		dd offset dword_100061A0+1Ch
; DWORD	dwTlsIndex
dwTlsIndex	dd 0FFFFFFFFh		; DATA XREF: __mtinit+Fw __mtinit+28r	...
		dd 0FFFFFFFFh, 0A00h, 8	dup(0)
dword_100082E0	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r
off_100082E4	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do
					; "R6002\r\n- floating point not loaded\r\"...
		dd 8
		dd offset aR6008NotEnough ; "R6008\r\n-	not enough space for argumen"...
		dd 9
		dd offset aR6009NotEnough ; "R6009\r\n-	not enough space for environ"...
		dd 0Ah
		dd offset aAbnormalProgra ; "\r\nabnormal program termination\r\n"
		dd 10h
		dd offset aR6016NotEnough ; "R6016\r\n-	not enough space for thread "...
		dd 11h
		dd offset aR6017Unexpecte ; "R6017\r\n-	unexpected multithread lock "...
		dd 12h
		dd offset aR6018Unexpecte ; "R6018\r\n-	unexpected heap	error\r\n"
		dd 13h
		dd offset aR6019UnableToO ; "R6019\r\n-	unable to open console devic"...
		dd 18h
		dd offset aR6024NotEnough ; "R6024\r\n-	not enough space for _onexit"...
		dd 19h
		dd offset aR6025PureVirtu ; "R6025\r\n-	pure virtual function call\r"...
		dd 1Ah
		dd offset aR6026NotEnough ; "R6026\r\n-	not enough space for stdio i"...
		dd 1Bh
		dd offset aR6027NotEnough ; "R6027\r\n-	not enough space for lowio i"...
		dd 1Ch
		dd offset aR6028UnableToI ; "R6028\r\n-	unable to initialize heap\r\"...
		dd 78h
		dd offset aDomainError	; "DOMAIN error\r\n"
		dd 79h
		dd offset aSingError	; "SING	error\r\n"
		dd 7Ah
		dd offset aTlossError	; "TLOSS error\r\n"
		dd 0FCh
		dd offset asc_100061E4	; "\r\n"
		dd 0FFh
		dd offset aRuntimeError	; "runtime error "
off_10008370	dd offset dword_100094C0 ; DATA	XREF: __NMSG_WRITE+1Bo
					; ___initstdio+55o ...
		align 8
		dd offset dword_100094C0
		dd 101h
dword_10008380	dd 2 dup(0)		; DATA XREF: ___initstdio+72o
		dd 1000h, 4 dup(0)
		dd 2, 1, 6 dup(0)
		dd 2 dup(2), 7 dup(0)
dword_100083E0	dd 7Ch dup(0)		; DATA XREF: ___initstdio+9Eo
dword_100085D0	dd 8 dup(0)		; DATA XREF: __lock_file+Do
					; __unlock_file+Do
off_100085F0	dd offset sub_10004D1D	; DATA XREF: ___initstdio+69o
		dd offset sub_10004D1D
		dd offset sub_10004D1D
		dd offset sub_10004D1D
		dd offset sub_10004D1D
		dd offset sub_10004D1D
off_10008608	dd offset word_10008612	; DATA XREF: __isctype+12r
					; __isctype+21r ...
		dd offset word_10008612
		db 2 dup(0)
word_10008612	dw 20h			; DATA XREF: .data:off_10008608o
					; .data:1000860Co
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 43h dup(0)
dword_10008820	dd 0C0000005h, 0Bh, 0	; DATA XREF: __initptd+4o
					; __freeptd+7Bo
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
		dd 3, 7, 78h, 0Ah, 2 dup(0)
byte_100088B0	db 1			; DATA XREF: __setmbcp+EDr
		db 2, 4, 8
		align 8
dword_100088B8	dd 3A4h			; DATA XREF: __setmbcp+38o
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+129o
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+CCo
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_100089A8	dd 2 dup(0)		; DATA XREF: __setmbcp+45o
dword_100089B0	dd 1			; DATA XREF: __dosmaperr+Eo
dword_100089B4	dd 16h			; DATA XREF: __dosmaperr+3Er
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
dword_10008B18	dd 2 dup(43h), 20h dup(0) ; DATA XREF: __dosmaperr+1Bo
		dd 43h,	20h dup(0)
dword_10008C24	dd 1			; DATA XREF: _tolower+3Cr
		dd 2Eh,	1
dword_10008C30	dd 19930520h, 3	dup(0)	; DATA XREF: .text:1000540Bo
					; __NLG_Notify+2o
		dd offset off_10008C48
		align 8
off_10008C48	dd offset aSun		; DATA XREF: .data:10008C40o
					; "Sun"
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
		dd offset aSunday	; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
		dd offset aJanuary	; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
		dd offset aAm		; "AM"
		dd offset aPm		; "PM"
		dd offset aMDYy		; "M/d/yy"
		dd offset aDdddMmmmDdYyyy ; "dddd, MMMM	dd, yyyy"
		dd offset aHMmSs	; "H:mm:ss"
		align 8
dword_10008CF8	dd 2Eh,	0		; DATA XREF: .data:off_10008D00o
off_10008D00	dd offset dword_10008CF8 ; DATA	XREF: .data:10008D30o
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd offset dword_1000919C
		dd 2 dup(7F7F7F7Fh)
		dd offset off_10008D00
		align 10h
dword_10008D40	dd 7080h, 1, 0FFFFF1F0h, 545350h, 0Fh dup(0) ; DATA XREF: .data:10008DCCo
dword_10008D8C	dd 544450h, 0Fh	dup(0)	; DATA XREF: .data:10008DD0o
		dd offset dword_10008D40+0Ch
		dd offset dword_10008D8C
		align 8
		dd 0FFFFFFFFh, 3 dup(0)
		dd 0FFFFFFFFh, 5 dup(0)
		dd 0FFFFFFFFh, 1Eh, 3Bh, 5Ah, 78h, 97h,	0B5h, 0D4h, 0F3h
		dd 111h, 130h, 14Eh, 16Dh, 0FFFFFFFFh, 1Eh, 3Ah, 59h, 77h
		dd 96h,	0B4h, 0D3h, 0F2h, 110h,	12Fh, 14Dh, 16Ch
; CHAR byte_10008E68[40]
byte_10008E68	db 28h dup(0)		; DATA XREF: AddSrv+10Do
					; .data:10008038o
; struct tagOFNA stru_10008E90
stru_10008E90	tagOFNA	<0>		; DATA XREF: sub_100011D0+8w
					; MyGetOpenFileName32+57o ...
		dd 7 dup(0)
; struct _browseinfoA bi
bi		_browseinfoA <0>	; DATA XREF: MyBrowseForFolder32+17o
					; MyBrowseForFolder32+2Aw ...
dword_10008F18	dd 0			; DATA XREF: MyGetOpenFileName32+61w
					; MyGetOpenFileName32+6Cr
dword_10008F1C	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+8Dw
					; _CRT_INIT(x,x,x)+9Br	...
; char *dword_10008F20
dword_10008F20	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+74w
					; __setenvp:loc_10003131r ...
		align 8
dword_10008F28	dd 0			; DATA XREF: __amsg_exitr
					; __FF_MSGBANNERr ...
dword_10008F2C	dd 0			; DATA XREF: __amsg_exit+Er
					; __FF_MSGBANNER+Er ...
dword_10008F30	dd 6 dup(0)		; DATA XREF: .data:off_100081ECo
dword_10008F48	dd 6 dup(0)		; DATA XREF: .data:lpCriticalSectiono
dword_10008F60	dd 6 dup(0)		; DATA XREF: .data:off_1000820Co
dword_10008F78	dd 6 dup(0)		; DATA XREF: .data:off_1000821Co
dword_10008F90	dd 0			; DATA XREF: _mallocr
					; _calloc:loc_10003FB6r
dword_10008F94	dd 0			; DATA XREF: __callnewhr
		dd 0
dword_10008F9C	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+15w
					; _CRT_INIT(x,x,x)+24r	...
dword_10008FA0	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+4Dw
dword_10008FA4	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+3Dw
dword_10008FA8	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+42w
dword_10008FAC	dd 0			; DATA XREF: __setargv+91w
dword_10008FB0	dd 0			; DATA XREF: __setargv+89w
		align 8
dword_10008FB8	dd 0			; DATA XREF: __setenvp+44w
		dd 3 dup(0)
dword_10008FC8	dd 0			; DATA XREF: __setargv+2Ew
		align 10h
byte_10008FD0	db 0			; DATA XREF: _doexit+32w
					; ___endstdio+5r
		align 4
dword_10008FD4	dd 0			; DATA XREF: _CRT_INIT(x,x,x)+A9r
					; _doexit+2Cw
dword_10008FD8	dd 0			; DATA XREF: _doexit+9r _doexit+97w
; CHAR Filename[260]
Filename	db 24h dup(0), 0E0h dup(?) ; DATA XREF:	__setargv:loc_100031EFo
dword_100090E0	dd ?			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_100090E4	dd ?			; DATA XREF: __FF_MSGBANNER+21r
		dd ?
dword_100090EC	dd ?			; DATA XREF: __setmbcp:loc_10004263r
					; _getSystemCP+4w ...
dword_100090F0	dd ?			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_100090F4	dd ?			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_10004864r
dword_100090F8	dd ?			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
		dd 3 dup(?)
dword_10009108	dd 2 dup(?)		; DATA XREF: __strcmpi+Co
					; __strnicmp+17o
; LCID dword_10009110
dword_10009110	dd ?			; DATA XREF: ___crtGetStringTypeA+7Br
					; _tolower+4r ...
		align 10h
dword_10009120	dd ?			; DATA XREF: _getSystemCP+3Ar
					; ___crtLCMapStringA+C0r ...
		align 8
dword_10009128	dd ?			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_1000912C	dd ?			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_10005041w
		dd 1Bh dup(?)
dword_1000919C	dd 35h dup(?)		; DATA XREF: .data:10008D04o
					; .data:10008D08o ...
dword_10009270	dd ?			; DATA XREF: __strcmpi+5Ar
					; __strnicmp+78r
dword_10009274	dd ?			; DATA XREF: __strcmpi:notclocalew
					; __strcmpi:do_lockw ...
; UINT CodePage
CodePage	dd ?			; DATA XREF: __setmbcp+1Br
					; __setmbcp+79w ...
		align 10h
dword_10009280	dd 3 dup(?)		; DATA XREF: __setmbcp+12Fo
					; __setmbcp+179o ...
dword_1000928C	dd ?			; DATA XREF: __setmbcp+114w
					; __setmbcp+168w ...
		align 20h
byte_100092A0	db ?			; DATA XREF: _setSBUpLow:loc_1000443Fw
					; _setSBUpLow:loc_1000445Cw ...
		align 4
		dd 3Fh dup(?)
byte_100093A0	db ?			; DATA XREF: __setmbcp+6Eo
					; __setmbcp+BEo ...
byte_100093A1	db ?			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(?)
; LCID Locale
Locale		dd ?			; DATA XREF: __setmbcp+64w
					; __setmbcp+137w ...
dword_100094A8	dd ?			; DATA XREF: ___initstdio+28w
					; ___initstdio+41w ...
		align 20h
dword_100094C0	dd 400h	dup(?)		; DATA XREF: .data:off_10008370o
					; .data:10008378o
; size_t dword_1000A4C0
dword_1000A4C0	dd ?			; DATA XREF: ___initstdior
					; ___initstdio:loc_10003CA2w ...
		align 20h
dword_1000A4E0	dd ?			; DATA XREF: __ioinit:loc_10002F31w
					; __ioinit+4Br	...
dword_1000A4E4	dd 3Fh dup(?)		; DATA XREF: __ioinit+98o
; UINT uNumber
uNumber		dd ?			; DATA XREF: __ioinit+28w
					; __ioinit:loc_10002F9Fr ...
dword_1000A5E4	dd ?			; DATA XREF: __setenvp+ADw
dword_1000A5E8	dd ?			; DATA XREF: __setenvp+3r __setargv+8r ...
dword_1000A5EC	dd ?			; DATA XREF: _doexit+43r
dword_1000A5F0	dd ?			; DATA XREF: _doexit+3Ar _doexit+5Cr
dword_1000A5F4	dd ?			; DATA XREF: __cinitr
dword_1000A5F8	dd ?			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_1000A5FC	dd ?			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_1000A600	dd ?			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *dword_1000A604
dword_1000A604	dd ?			; DATA XREF: ___sbh_heap_init:loc_1000241Ew
					; ___sbh_free_block+22Cr ...
dword_1000A608	dd ?			; DATA XREF: __heap_term+3r
					; __heap_term+4Cr ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: __heap_term+12r
					; __heap_term:loc_100022D7r ...
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: _free+3Ar
					; __heap_alloc+3Fr ...
dword_1000A614	dd ?			; DATA XREF: _CRT_INIT(x,x,x)+6Aw
					; __setargv+29r
dword_1000A618	dd ?			; DATA XREF: DllEntryPoint:loc_1000219Br
					; DllEntryPoint+82r
		align 1000h
_data		ends


		end DllEntryPoint
