;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	1CCFD42CE8E8EA9EBC393FC1672392E6
; Input	CRC32 :	AB8E0AD3

; File Name   :	C:\compspace\compare\pgp\dlls\full\PGPKeys.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00022348 ( 140104.)
; Section size in file		: 00023000 ( 143360.)
; Offset to raw	data for section: 00001000
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes
; OS type	  :  MS	Windows
; Application type:  Executable	32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401000(HWND hWnd)
sub_401000	proc near		; CODE XREF: sub_412530+D42p

Rect		= tagRECT ptr -10h
hWnd		= dword	ptr  4

		sub	esp, 10h
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+1Ch+hWnd]
		push	offset aChoicelist ; "ChoiceList"
		push	edi		; hWnd
		call	ds:GetPropA
		push	8		; size_t
		mov	ebx, eax
		call	_malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_40107A
		push	ebp
		xor	ebp, ebp
		test	ebx, ebx
		jz	short loc_401031
		mov	ebp, [ebx]

loc_401031:				; CODE XREF: sub_401000+2Dj
		lea	eax, [esp+20h+Rect]
		mov	dword ptr [esi], 0
		push	eax		; lpRect
		push	edi		; hWnd
		call	ds:GetClientRect
		push	ebp		; dwInitParam
		push	offset sub_401260 ; lpDialogFunc
		push	edi		; hWndParent
		push	837h		; lpTemplateName
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		push	eax		; hInstance
		call	ds:CreateDialogParamA
		push	esi		; hData
		push	offset aChoicelist ; "ChoiceList"
		push	edi		; hWnd
		mov	[esi], eax
		mov	[esi+4], ebx
		call	ds:SetPropA
		pop	ebp
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_40107A:				; CODE XREF: sub_401000+26j
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
sub_401000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401090(HWND hWnd, int)
sub_401090	proc near		; CODE XREF: sub_412530+C6p
					; sub_412530+C57p ...

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+hWnd]
		push	offset aChoicelist ; "ChoiceList"
		push	edi		; hWnd
		xor	esi, esi
		call	ds:GetPropA
		test	eax, eax
		jz	short loc_4010C9
		mov	edx, [esp+8+arg_4]
		mov	ecx, [eax]
		mov	esi, [eax+4]
		push	eax		; void *
		mov	[edx], ecx
		call	_free
		add	esp, 4
		push	esi		; hData
		push	offset aChoicelist ; "ChoiceList"
		push	edi		; hWnd
		call	ds:SetPropA

loc_4010C9:				; CODE XREF: sub_401090+16j
		mov	eax, esi
		pop	edi
		pop	esi
		retn
sub_401090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4010D0(HWND hWnd)
sub_4010D0	proc near		; CODE XREF: sub_401260+129p
					; sub_412530+B36p

hWnd		= dword	ptr  4

		mov	eax, [esp+hWnd]
		push	esi
		push	offset aChoicelist ; "ChoiceList"
		push	eax		; hWnd
		xor	esi, esi
		call	ds:GetPropA
		test	eax, eax
		jz	short loc_4010EF

loc_4010E7:				; CODE XREF: sub_4010D0+1Dj
		mov	eax, [eax+4]
		inc	esi
		test	eax, eax
		jnz	short loc_4010E7

loc_4010EF:				; CODE XREF: sub_4010D0+15j
		mov	eax, esi
		pop	esi
		retn
sub_4010D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401100(HWND hWnd)
sub_401100	proc near		; CODE XREF: sub_412530+588p
					; sub_412530+99Fp ...

hWnd		= dword	ptr  4

		mov	eax, [esp+hWnd]
		push	offset aChoicelist ; "ChoiceList"
		push	eax		; hWnd
		call	ds:GetPropA
		retn
sub_401100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401120	proc near		; CODE XREF: sub_412530+5E1p
					; sub_412530+A0Fp ...

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_40112C
		mov	eax, [eax+4]
		retn
; ---------------------------------------------------------------------------

loc_40112C:				; CODE XREF: sub_401120+6j
		xor	eax, eax
		retn
sub_401120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_401130(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_401130	proc near		; DATA XREF: sub_401260+1E4o
					; sub_401260+21Bo ...

hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+hWnd]
		push	edi
		mov	edi, ds:GetPropA
		push	offset aOldproc	; "oldproc"
		push	esi		; hWnd
		call	edi ; GetPropA
		push	offset aHwnd	; "hwnd"
		push	esi		; hWnd
		mov	ebx, eax
		call	edi ; GetPropA
		mov	edi, eax
		mov	ebp, [esp+10h+Msg]
		cmp	ebp, 100h
		ja	loc_40122E
		jz	short loc_4011C0
		mov	eax, ebp
		sub	eax, 2
		jz	short loc_4011A5
		sub	eax, 85h
		jnz	loc_401242
		mov	eax, [esp+10h+lParam]
		test	eax, eax
		jz	loc_401242
		cmp	dword ptr [eax+4], 100h
		jnz	loc_401242
		cmp	dword ptr [eax+8], 0Dh
		jnz	loc_401242
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 4
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------

loc_4011A5:				; CODE XREF: sub_401130+39j
		push	ebx		; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		push	offset aOldproc	; "oldproc"
		push	esi		; hWnd
		call	ds:RemovePropA
		jmp	loc_401242
; ---------------------------------------------------------------------------

loc_4011C0:				; CODE XREF: sub_401130+32j
		cmp	[esp+10h+wParam], 0Dh
		jnz	short loc_401242
		mov	ebx, ds:GetDlgItem
		push	0BB8h		; nIDDlgItem
		push	edi		; hDlg
		call	ebx ; GetDlgItem
		mov	ebp, ds:IsWindowEnabled
		mov	esi, eax
		push	esi		; hWnd
		call	ebp ; IsWindowEnabled
		test	eax, eax
		jz	short loc_4011F7
		push	esi		; hWnd
		call	ds:IsWindowVisible
		test	eax, eax
		jz	short loc_4011F7
		push	esi
		push	0BB8h
		jmp	short loc_401219
; ---------------------------------------------------------------------------

loc_4011F7:				; CODE XREF: sub_401130+B2j
					; sub_401130+BDj
		push	421h		; nIDDlgItem
		push	edi		; hDlg
		call	ebx ; GetDlgItem
		mov	esi, eax
		push	esi		; hWnd
		call	ebp ; IsWindowEnabled
		test	eax, eax
		jz	short loc_401225
		push	esi		; hWnd
		call	ds:IsWindowVisible
		test	eax, eax
		jz	short loc_401225
		push	esi		; lParam
		push	421h		; wParam

loc_401219:				; CODE XREF: sub_401130+C5j
		push	111h		; Msg
		push	edi		; hWnd
		call	ds:SendMessageA

loc_401225:				; CODE XREF: sub_401130+D6j
					; sub_401130+E1j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------

loc_40122E:				; CODE XREF: sub_401130+2Cj
		cmp	ebp, 102h
		jnz	short loc_401242
		mov	al, byte ptr [esp+10h+wParam]
		cmp	al, 0Ah
		jz	short loc_401225
		cmp	al, 0Dh
		jz	short loc_401225

loc_401242:				; CODE XREF: sub_401130+40j
					; sub_401130+4Cj ...
		mov	eax, [esp+10h+lParam]
		mov	ecx, [esp+10h+wParam]
		push	eax		; lParam
		push	ecx		; wParam
		push	ebp		; Msg
		push	esi		; hWnd
		push	ebx		; lpPrevWndFunc
		call	ds:CallWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	10h
sub_401130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall sub_401260(HWND, UINT,	WPARAM,	LPARAM)
sub_401260	proc near		; DATA XREF: sub_401000+44o

Rect		= tagRECT ptr -30h
var_20		= tagRECT ptr -20h
var_10		= tagRECT ptr -10h
hDlg		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		sub	esp, 30h
		sub	eax, 5
		push	ebx
		push	ebp
		push	esi
		push	edi
		jz	loc_401558
		sub	eax, 10Bh
		jz	short loc_4012BF
		dec	eax
		jz	short loc_40128A
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 30h
		retn	10h
; ---------------------------------------------------------------------------

loc_40128A:				; CODE XREF: sub_401260+1Cj
		mov	eax, [esp+40h+arg_8]
		cmp	ax, 0BBDh
		jnz	loc_401666
		mov	ecx, [esp+40h+arg_C]
		mov	edx, [esp+40h+hDlg]
		push	ecx		; hWnd
		push	eax		; int
		push	111h		; int
		push	edx		; int
		call	sub_4114A0
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn	10h
; ---------------------------------------------------------------------------

loc_4012BF:				; CODE XREF: sub_401260+19j
		mov	esi, [esp+40h+hDlg]
		mov	ebp, ds:GetDlgItem
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		mov	edi, eax
		lea	eax, [esp+40h+Rect]
		push	eax		; lpRect
		push	edi		; hWnd
		call	ds:GetClientRect
		lea	ecx, [esp+40h+Rect]
		push	2		; cPoints
		push	ecx		; lpPoints
		push	esi		; hWndTo
		push	edi		; hWndFrom
		call	ds:MapWindowPoints
		mov	edx, hModule
		push	0		; lpParam
		mov	ecx, [esp+44h+Rect.bottom]
		mov	eax, [esp+44h+Rect.top]
		sub	ecx, eax
		push	edx		; hInstance
		mov	edx, [esp+48h+Rect.right]
		push	0		; hMenu
		add	ecx, 2
		push	esi		; hWndParent
		push	ecx		; nHeight
		mov	ecx, [esp+54h+Rect.left]
		sub	edx, ecx
		dec	eax
		push	edx		; nWidth
		push	eax		; Y
		push	ecx		; X
		push	50810000h	; dwStyle
		push	offset aDatetime ; "DateTime"
		push	offset aSysdatetimepic ; "SysDateTimePick32"
		push	0		; dwExStyle
		call	ds:CreateWindowExA
		push	3		; uFlags
		push	0		; cy
		push	0		; cx
		push	0		; Y
		push	0		; X
		push	0BBEh		; nIDDlgItem
		push	esi		; hDlg
		mov	ebx, eax
		call	ebp ; GetDlgItem
		push	eax		; hWndInsertAfter
		push	ebx		; hWnd
		call	ds:SetWindowPos
		push	0Fh		; nIndex
		call	ds:GetSysColor
		push	eax		; lParam
		push	4		; wParam
		push	1006h		; Msg
		push	ebx		; hWnd
		call	ds:SendMessageA
		push	0		; nCmdShow
		push	ebx		; hWnd
		call	ds:ShowWindow
		mov	edi, ds:SetPropA
		push	ebx		; hData
		push	offset aHwndtime ; "hwndTime"
		push	esi		; hWnd
		call	edi ; SetPropA
		push	esi		; hWnd
		mov	eax, [esp+44h+arg_C]
		mov	hWndFrom, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	sub_4010D0
		inc	eax
		mov	ecx, 7
		cdq
		idiv	ecx
		push	edx		; WPARAM
		push	esi		; hDlg
		call	sub_411790
		add	esp, 0Ch
		lea	edx, [esp+40h+Rect]
		push	edx		; lpRect
		push	esi		; hWnd
		call	ds:GetClientRect
		push	0BBFh		; nIDDlgItem
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hDlg
		call	ebp ; GetDlgItem
		mov	[esp+40h+hDlg],	eax
		lea	eax, [esp+40h+Rect]
		push	eax		; lpRect
		push	esi		; hWnd
		call	ds:GetClientRect
		lea	ecx, [esp+40h+var_10]
		mov	edx, [esp+40h+hDlg]
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:GetWindowRect
		lea	eax, [esp+40h+var_10]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ds:MapWindowPoints
		mov	eax, hWndFrom
		test	eax, eax
		jz	short loc_401403
		lea	ecx, [esp+40h+var_20]
		push	ecx		; lpRect
		push	eax		; hWnd
		call	ds:GetClientRect
		jmp	short loc_40141E
; ---------------------------------------------------------------------------

loc_401403:				; CODE XREF: sub_401260+193j
		push	0BC0h		; nIDDlgItem
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hDlg
		call	ebp ; GetDlgItem
		lea	edx, [esp+40h+var_20]
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:GetWindowRect

loc_40141E:				; CODE XREF: sub_401260+1A1j
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hData
		push	offset aHwnd	; "hwnd"
		push	ebx		; hWnd
		mov	[esp+4Ch+hDlg],	eax
		call	edi ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebx		; hWnd
		call	edi ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		call	ds:SetWindowLongA
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		mov	ebx, eax
		mov	eax, [esp+40h+hDlg]
		push	eax		; hData
		push	offset aHwnd	; "hwnd"
		push	ebx		; hWnd
		call	edi ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebx		; hWnd
		call	edi ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		call	ds:SetWindowLongA
		push	0BC5h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		mov	ebx, eax
		mov	ecx, [esp+40h+hDlg]
		push	ecx		; hData
		push	offset aHwnd	; "hwnd"
		push	ebx		; hWnd
		call	edi ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebx		; hWnd
		call	edi ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebx		; hWnd
		mov	ebx, ds:SetWindowLongA
		call	ebx ; SetWindowLongA
		push	0BC4h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		mov	ebp, eax
		mov	edx, [esp+40h+hDlg]
		push	edx		; hData
		push	offset aHwnd	; "hwnd"
		push	ebp		; hWnd
		call	edi ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebp		; hWnd
		call	edi ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ebx ; SetWindowLongA
		push	2		; cPoints
		lea	eax, [esp+44h+Rect]
		mov	ebx, ds:GetParent
		push	eax		; lpPoints
		push	esi		; hWnd
		call	ebx ; GetParent
		mov	edi, ds:MapWindowPoints
		push	eax		; hWndTo
		push	esi		; hWndFrom
		call	edi ; MapWindowPoints
		lea	ecx, [esp+40h+var_20]
		push	2		; cPoints
		push	ecx		; lpPoints
		push	esi		; hWnd
		call	ebx ; GetParent
		mov	edx, hWndFrom
		push	eax		; hWndTo
		push	edx		; hWndFrom
		call	edi ; MapWindowPoints
		mov	ebp, [esp+40h+Rect.top]
		push	1
		mov	eax, [esp+44h+Rect.bottom]
		mov	ecx, [esp+44h+var_20.bottom]
		sub	eax, ebp
		mov	edx, [esp+44h+var_10.right]
		inc	ecx
		mov	[esp+44h+Rect.right], edx
		add	eax, ecx
		mov	[esp+44h+Rect.top], ecx
		mov	[esp+44h+Rect.bottom], eax
		sub	eax, ecx
		push	eax
		mov	eax, [esp+48h+Rect.left]
		sub	edx, eax
		push	edx
		push	ecx
		push	eax
		push	esi
		jmp	loc_401660
; ---------------------------------------------------------------------------

loc_401558:				; CODE XREF: sub_401260+Ej
		mov	esi, [esp+40h+hDlg]
		push	0BBFh		; nIDDlgItem
		push	esi		; hWnd
		call	ds:GetParent
		mov	edi, ds:GetDlgItem
		push	eax		; hDlg
		call	edi ; GetDlgItem
		mov	ebx, ds:GetWindowRect
		lea	edx, [esp+40h+var_20]
		push	edx		; lpRect
		push	eax		; hWnd
		call	ebx ; GetWindowRect
		mov	ebp, ds:MapWindowPoints
		lea	eax, [esp+40h+var_20]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebp ; MapWindowPoints
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		lea	ecx, [esp+40h+Rect]
		push	ecx		; lpRect
		push	eax		; hWnd
		mov	[esp+48h+hDlg],	eax
		call	ebx ; GetWindowRect
		lea	edx, [esp+40h+Rect]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebp ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+44h+Rect.bottom]
		mov	eax, [esp+44h+Rect.top]
		mov	edx, [esp+44h+var_20.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+48h+var_20.left]
		sub	edx, ecx
		mov	ecx, [esp+48h+hDlg]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+50h+Rect.left]
		push	eax		; X
		push	ecx		; hWnd
		call	ds:MoveWindow
		push	0BC4h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		lea	edx, [esp+40h+Rect]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+48h+hDlg],	eax
		call	ebx ; GetWindowRect
		lea	eax, [esp+40h+Rect]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebp ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+44h+Rect.bottom]
		mov	eax, [esp+44h+Rect.top]
		mov	edx, [esp+44h+var_20.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+48h+var_20.left]
		sub	edx, ecx
		mov	ecx, [esp+48h+hDlg]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+50h+Rect.left]
		push	eax		; X
		push	ecx		; hWnd
		call	ds:MoveWindow
		push	0BC5h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	edi, eax
		lea	edx, [esp+40h+Rect]
		push	edx		; lpRect
		push	edi		; hWnd
		call	ebx ; GetWindowRect
		lea	eax, [esp+40h+Rect]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebp ; MapWindowPoints
		mov	ebx, [esp+40h+var_20.left]
		push	1		; bRepaint
		mov	ecx, [esp+44h+Rect.bottom]
		mov	eax, [esp+44h+Rect.top]
		mov	edx, [esp+44h+var_20.right]
		sub	ecx, eax
		sub	edx, ebx
		push	ecx		; nHeight
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+50h+Rect.left]
		push	eax		; X
		push	edi		; hWnd

loc_401660:				; CODE XREF: sub_401260+2F3j
		call	ds:MoveWindow

loc_401666:				; CODE XREF: sub_401260+32j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 30h
		retn	10h
sub_401260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401680	proc near		; DATA XREF: .rdata:off_4246C0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		push	esi
		push	edi
		mov	ecx, 4
		mov	edi, offset dword_42B610
		mov	esi, eax
		xor	edx, edx
		repe cmpsd
		jz	short loc_4016BA
		mov	esi, eax
		mov	ecx, 4
		mov	edi, offset dword_42B600
		xor	eax, eax
		repe cmpsd
		jz	short loc_4016BA
		mov	ecx, [esp+8+arg_8]
		pop	edi
		pop	esi
		mov	[ecx], eax
		mov	eax, 80004002h
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4016BA:				; CODE XREF: sub_401680+16j
					; sub_401680+28j
		mov	edx, [esp+8+arg_8]
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		mov	[edx], eax
		mov	ecx, [eax+4]
		inc	ecx
		mov	[eax+4], ecx
		xor	eax, eax
		retn	0Ch
sub_401680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4016E0	proc near		; DATA XREF: .rdata:004246C4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		inc	ecx
		mov	[eax+4], ecx
		mov	eax, ecx
		retn	4
sub_4016E0	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_4016F0(void	*)
sub_4016F0	proc near		; DATA XREF: .rdata:004246C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+4]
		dec	eax
		mov	[ecx+4], eax
		jnz	short locret_401708
		push	ecx		; void *
		call	sub_41BE1A
		add	esp, 4
		xor	eax, eax

locret_401708:				; CODE XREF: sub_4016F0+Bj
		retn	4
sub_4016F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401710	proc near		; CODE XREF: sub_401930+1Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		mov	eax, ecx
		xor	ecx, ecx
		mov	[eax+18h], edx
		mov	edx, [esp+arg_0]
		mov	dword ptr [eax], offset	off_4246C0
		mov	dword ptr [eax+4], 1
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		mov	[eax+14h], edx
		mov	[eax+8], ecx
		retn	8
sub_401710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401740	proc near		; CODE XREF: sub_401970+9p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+10h], eax
		retn	4
sub_401740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401750	proc near		; DATA XREF: .rdata:004246CCo

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_14		= dword	ptr  18h

		sub	esp, 14h
		xor	eax, eax
		push	ebx
		mov	ebx, [esp+18h+arg_0]
		push	ebp
		mov	ebp, [esp+1Ch+arg_14]
		mov	[ebx+0Ch], eax
		mov	[ebp+0], eax
		mov	ecx, [ebx+10h]
		cmp	ecx, eax
		jnz	short loc_401774
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn	18h
; ---------------------------------------------------------------------------

loc_401774:				; CODE XREF: sub_401750+1Aj
		push	esi
		mov	esi, [esp+20h+arg_4]
		lea	ecx, [esp+20h+var_14]
		push	edi
		mov	[esp+24h+var_10], eax
		mov	eax, [esi]
		mov	edi, 1
		push	ecx
		push	esi
		mov	word ptr [esp+2Ch+var_14], di
		mov	[esp+2Ch+var_C], edi
		mov	[esp+2Ch+var_8], 0FFFFFFFFh
		mov	[esp+2Ch+var_4], edi
		call	dword ptr [eax+14h]
		test	eax, eax
		jnz	short loc_4017B0
		mov	[ebx+0Ch], edi
		mov	[ebx+8], edi
		mov	[ebp+0], edi

loc_4017B0:				; CODE XREF: sub_401750+55j
		mov	edx, [esi]
		lea	eax, [esp+1Ch+var_C]
		push	eax
		push	esi
		mov	word ptr [esp+24h+var_C], 0Fh
		mov	[esp+24h+var_8], 0
		mov	[esp+24h+var_4], edi
		mov	dword ptr [esp+24h], 0FFFFFFFFh
		mov	[esp+24h+arg_0], edi
		call	dword ptr [edx+14h]
		test	eax, eax
		jnz	short loc_4017EB
		mov	[ebx+0Ch], edi
		mov	dword ptr [ebx+8], 0Fh
		mov	[ebp+0], edi

loc_4017EB:				; CODE XREF: sub_401750+8Cj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn	18h
sub_401750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401800	proc near		; DATA XREF: .rdata:004246D0o

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_10]
		mov	dword ptr [esi], 0
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_401843
		mov	ecx, [eax+10h]
		test	ecx, ecx
		jz	short loc_401843
		cmp	dword ptr [eax+8], 0Fh
		jz	short loc_40183D
		mov	ecx, [esp+4+arg_C]
		mov	edx, [esp+4+arg_8]
		mov	eax, [eax+18h]
		push	ecx
		push	edx
		push	eax
		call	sub_405180
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_401843

loc_40183D:				; CODE XREF: sub_401800+21j
		mov	dword ptr [esi], 1

loc_401843:				; CODE XREF: sub_401800+14j
					; sub_401800+1Bj ...
		xor	eax, eax
		pop	esi
		retn	14h
sub_401800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401850	proc near		; DATA XREF: .rdata:004246D4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		xor	eax, eax
		retn	4
sub_401850	endp


; =============== S U B	R O U T	I N E =======================================


sub_401860	proc near		; DATA XREF: .rdata:004246D8o

var_20		= STGMEDIUM ptr	-20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_14		= dword	ptr  18h

		sub	esp, 20h
		xor	eax, eax
		push	ebx
		mov	ebx, [esp+24h+arg_0]
		push	ebp
		mov	ebp, [esp+28h+arg_14]
		push	esi
		push	edi
		mov	[ebp+0], eax
		mov	ecx, [ebx+0Ch]
		cmp	ecx, eax
		jz	loc_401922
		cmp	[ebx+10h], eax
		jz	loc_401922
		mov	esi, [esp+30h+arg_4]
		lea	ecx, [esp+30h+var_20]
		lea	edx, [esp+30h+var_14]
		mov	[esp+30h+var_10], eax
		mov	eax, [esi]
		push	ecx
		mov	edi, 1
		push	edx
		push	esi
		mov	word ptr [esp+3Ch+var_14], di
		mov	[esp+3Ch+var_C], edi
		mov	[esp+3Ch+var_8], 0FFFFFFFFh
		mov	[esp+3Ch+var_4], edi
		call	dword ptr [eax+0Ch]
		test	eax, eax
		jl	short loc_4018CE
		mov	eax, dword ptr [esp+30h+var_20.anonymous_0]
		mov	ecx, [ebx+18h]
		push	eax		; hMem
		push	ecx		; int
		call	sub_403E90
		jmp	short loc_40190F
; ---------------------------------------------------------------------------

loc_4018CE:				; CODE XREF: sub_401860+5Cj
		mov	eax, [esi]
		lea	ecx, [esp+30h+var_20]
		lea	edx, [esp+30h+var_14]
		push	ecx
		push	edx
		push	esi
		mov	word ptr [esp+3Ch+var_14], 0Fh
		mov	[esp+3Ch+var_10], 0
		mov	[esp+3Ch+var_C], edi
		mov	[esp+3Ch+var_8], 0FFFFFFFFh
		mov	[esp+3Ch+var_4], edi
		call	dword ptr [eax+0Ch]
		test	eax, eax
		jl	short loc_401922
		mov	eax, dword ptr [esp+30h+var_20.anonymous_0]
		mov	ecx, [ebx+18h]
		push	eax		; hDrop
		push	ecx		; int
		call	sub_4040F0

loc_40190F:				; CODE XREF: sub_401860+6Cj
		add	esp, 8
		lea	edx, [esp+30h+var_20]
		push	edx		; LPSTGMEDIUM
		call	ds:ReleaseStgMedium
		mov	[ebp+0], edi
		xor	eax, eax

loc_401922:				; CODE XREF: sub_401860+19j
					; sub_401860+22j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn	18h
sub_401860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401930	proc near		; CODE XREF: sub_404530+1B4p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	1Ch
		call	sub_41BE25
		add	esp, 4
		test	eax, eax
		jz	short loc_401950
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	ecx
		push	edx
		mov	ecx, eax
		call	sub_401710
		retn
; ---------------------------------------------------------------------------

loc_401950:				; CODE XREF: sub_401930+Cj
		xor	eax, eax
		retn
sub_401930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401960	proc near		; CODE XREF: sub_405110+1Ep

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		mov	ecx, [eax]
		call	dword ptr [ecx+8]
		retn
sub_401960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401970	proc near		; CODE XREF: sub_4030D0+1C0p
					; sub_4030D0+1F2p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	eax
		call	sub_401740
		retn
sub_401970	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401980	proc near		; CODE XREF: sub_401D70+10Ap

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
arg_0		= dword	ptr  4

		sub	esp, 30h
		push	esi
		mov	esi, [esp+34h+arg_0]
		push	esi
		call	sub_4030B0
		add	esp, 4
		test	eax, eax
		jz	short loc_4019B3
		mov	eax, [esi+0Ch]
		lea	ecx, [esp+34h+var_30]
		push	ecx
		push	0
		push	1015h
		mov	[esp+40h+var_30], offset sub_4019F0
		mov	[esp+40h+var_2C], eax
		push	eax
		jmp	short loc_4019D0
; ---------------------------------------------------------------------------

loc_4019B3:				; CODE XREF: sub_401980+13j
		push	esi
		call	sub_4030A0
		mov	ecx, [esi+0Ch]
		add	esp, 4
		mov	[esp+34h+var_24], eax
		lea	eax, [esp+34h+lParam]
		push	eax		; lParam
		push	5		; wParam
		push	1002h		; Msg
		push	ecx		; hWnd

loc_4019D0:				; CODE XREF: sub_401980+31j
		call	ds:SendMessageA
		mov	edx, [esi+0Ch]
		push	1		; bErase
		push	0		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		mov	eax, 1
		pop	esi
		add	esp, 30h
		retn
sub_401980	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_4019F0(LPARAM lParam, int)
sub_4019F0	proc near		; DATA XREF: sub_401980+24o

lParam		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+lParam]
		mov	ecx, [esp+arg_4]
		push	eax		; lParam
		push	5		; wParam
		mov	edx, [ecx+4]
		push	1002h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		mov	eax, 1
		retn	8
sub_4019F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401A20	proc near		; CODE XREF: sub_401D70+F9p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
arg_0		= dword	ptr  4

		sub	esp, 30h
		push	esi
		mov	esi, [esp+34h+arg_0]
		push	esi
		call	sub_4030B0
		add	esp, 4
		test	eax, eax
		jz	short loc_401A53
		mov	eax, [esi+0Ch]
		lea	ecx, [esp+34h+var_30]
		push	ecx
		push	0
		push	1015h
		mov	[esp+40h+var_30], offset sub_401A90
		mov	[esp+40h+var_2C], eax
		push	eax
		jmp	short loc_401A70
; ---------------------------------------------------------------------------

loc_401A53:				; CODE XREF: sub_401A20+13j
		push	esi
		call	sub_4030A0
		mov	ecx, [esi+0Ch]
		add	esp, 4
		mov	[esp+34h+var_24], eax
		lea	eax, [esp+34h+lParam]
		push	eax		; lParam
		push	4		; wParam
		push	1002h		; Msg
		push	ecx		; hWnd

loc_401A70:				; CODE XREF: sub_401A20+31j
		call	ds:SendMessageA
		mov	edx, [esi+0Ch]
		push	1		; bErase
		push	0		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		mov	eax, 1
		pop	esi
		add	esp, 30h
		retn
sub_401A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_401A90(LPARAM lParam, int)
sub_401A90	proc near		; DATA XREF: sub_401A20+24o

lParam		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+lParam]
		mov	ecx, [esp+arg_4]
		push	eax		; lParam
		push	4		; wParam
		mov	edx, [ecx+4]
		push	1002h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		mov	eax, 1
		retn	8
sub_401A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401AC0	proc near		; CODE XREF: sub_401C70:loc_401C84p
		push	1		; format
		call	ds:IsClipboardFormatAvailable
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
sub_401AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401AD0	proc near		; CODE XREF: sub_401D70+1Ep
					; sub_4030D0+5Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_401ADB
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_401ADB:				; CODE XREF: sub_401AD0+6j
		mov	eax, [esp+arg_4]
		mov	edx, [ecx+13Ch]
		test	eax, edx
		jz	short loc_401AEC
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_401AEC:				; CODE XREF: sub_401AD0+17j
		cmp	eax, 100h
		ja	short loc_401B60
		jz	short loc_401B56
		add	eax, 0FFFFFFFEh	; switch 127 cases
		cmp	eax, 7Eh
		ja	loc_401BB4	; jumptable 00401B09 default case
		xor	edx, edx
		mov	dl, ds:byte_401BEC[eax]
		jmp	ds:off_401BCC[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_401B10:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 2
		call	sub_401C70
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B1A:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 4
		call	sub_401CB0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B24:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 8
		call	sub_401D40
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B2E:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 16
		call	sub_401C90
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B38:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 32
		call	sub_401CB0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B42:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 64
		call	sub_401C90
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B4C:				; CODE XREF: sub_401AD0+39j
					; DATA XREF: .text:off_401BCCo
		push	ecx		; jumptable 00401B09 case 128
		call	sub_401CB0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B56:				; CODE XREF: sub_401AD0+23j
		push	ecx
		call	sub_401D10
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B60:				; CODE XREF: sub_401AD0+21j
		cmp	eax, 2000h
		ja	short loc_401BA6
		jz	short loc_401B9C
		cmp	eax, 400h
		jz	short loc_401B92
		cmp	eax, 800h
		jz	short loc_401B88
		cmp	eax, 1000h
		jnz	short loc_401BB4 ; jumptable 00401B09 default case
		push	ecx
		call	sub_401D40
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B88:				; CODE XREF: sub_401AD0+A5j
		push	ecx
		call	sub_401CF0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B92:				; CODE XREF: sub_401AD0+9Ej
		push	ecx
		call	sub_401CD0
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401B9C:				; CODE XREF: sub_401AD0+97j
		push	ecx
		call	sub_401D40
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401BA6:				; CODE XREF: sub_401AD0+95j
		cmp	eax, 4000h
		jz	short loc_401BC1
		cmp	eax, 10000000h
		jz	short loc_401BB7

loc_401BB4:				; CODE XREF: sub_401AD0+2Bj
					; sub_401AD0+39j ...
		xor	eax, eax	; jumptable 00401B09 default case
		retn
; ---------------------------------------------------------------------------

loc_401BB7:				; CODE XREF: sub_401AD0+E2j
		push	ecx
		call	sub_401D50
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_401BC1:				; CODE XREF: sub_401AD0+DBj
		push	ecx
		call	sub_401D40
		add	esp, 4
		retn
sub_401AD0	endp

; ---------------------------------------------------------------------------
		align 4
off_401BCC	dd offset loc_401B10, offset loc_401B1A, offset	loc_401B24
					; DATA XREF: sub_401AD0+39r
		dd offset loc_401B2E, offset loc_401B38, offset	loc_401B42 ; jump table	for switch statement
		dd offset loc_401B4C, offset loc_401BB4
byte_401BEC	db	0,     7,     1,     7 ; DATA XREF: sub_401AD0+33r
		db	7,     7,     2,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     3,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     4,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     5,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401C70	proc near		; CODE XREF: sub_401AD0+41p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_4030B0
		add	esp, 4
		test	eax, eax
		jz	short loc_401C84
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_401C84:				; CODE XREF: sub_401C70+Fj
		call	sub_401AC0
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
sub_401C70	endp


; =============== S U B	R O U T	I N E =======================================


sub_401C90	proc near		; CODE XREF: sub_401AD0+5Fp
					; sub_401AD0+73p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_403080
		add	esp, 4
		xor	ecx, ecx
		cmp	eax, 0FFFFFFFFh
		setz	cl
		mov	eax, ecx
		retn
sub_401C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401CB0	proc near		; CODE XREF: sub_401AD0+4Bp
					; sub_401AD0+69p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_403080
		add	esp, 4
		xor	ecx, ecx
		cmp	eax, 0FFFFFFFFh
		setnz	cl
		mov	eax, ecx
		retn
sub_401CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401CD0	proc near		; CODE XREF: sub_401AD0+C3p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_403090
		add	esp, 4
		xor	ecx, ecx
		cmp	eax, 2
		setz	cl
		mov	eax, ecx
		retn
sub_401CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401CF0	proc near		; CODE XREF: sub_401AD0+B9p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_403090
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		retn
sub_401CF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401D10	proc near		; CODE XREF: sub_401AD0+87p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	sub_4030B0
		add	esp, 4
		test	eax, eax
		jz	short loc_401D26
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_401D26:				; CODE XREF: sub_401D10+10j
		push	esi
		call	sub_403090
		add	esp, 4
		neg	eax
		sbb	eax, eax
		pop	esi
		neg	eax
		retn
sub_401D10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401D40	proc near		; CODE XREF: sub_401AD0+55p
					; sub_401AD0+AFp ...
		mov	eax, 1
		retn
sub_401D40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401D50	proc near		; CODE XREF: sub_401AD0+E8p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		mov	edx, [ecx+14Ch]
		test	edx, edx
		setz	al
		retn
sub_401D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401D70(UINT uID, int)
sub_401D70	proc near		; CODE XREF: sub_4030D0+74p
					; .text:0040D982p ...

lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
uID		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 28h
		push	esi
		mov	esi, [esp+2Ch+uID]
		test	esi, esi
		push	edi
		jnz	short loc_401D88
		pop	edi
		mov	eax, 0FFFFD120h
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401D88:				; CODE XREF: sub_401D70+Bj
		mov	edi, [esp+30h+arg_4]
		push	edi
		push	esi
		call	sub_401AD0
		add	esp, 8
		test	eax, eax
		jnz	short loc_401DA5
		pop	edi
		mov	eax, 0FFFFD12Eh
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401DA5:				; CODE XREF: sub_401D70+28j
		cmp	edi, 100h
		ja	loc_401E9B
		jz	loc_401E8A
		lea	eax, [edi-2]	; switch 127 cases
		cmp	eax, 7Eh
		ja	loc_401F48	; jumptable 00401DCB default case
		xor	ecx, ecx
		mov	cl, ds:byte_401F68[eax]
		jmp	ds:off_401F50[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_401DD2:				; CODE XREF: sub_401D70+5Bj
					; DATA XREF: .text:off_401F50o
		push	esi		; jumptable 00401DCB case 2
		call	sub_403FB0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401DE3:				; CODE XREF: sub_401D70+5Bj
					; DATA XREF: .text:off_401F50o
		push	esi		; jumptable 00401DCB case 4
		call	sub_4035C0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401DF4:				; CODE XREF: sub_401D70+5Bj
					; DATA XREF: .text:off_401F50o
		mov	edx, [esi+0Ch]	; jumptable 00401DCB case 8
		push	ebx
		mov	ebx, ds:SendMessageA
		push	0		; lParam
		push	0		; wParam
		push	1014h		; Msg
		push	edx		; hWnd
		call	ebx ; SendMessageA
		mov	eax, [esi+0Ch]
		push	0		; lParam
		push	0		; wParam
		push	1012h		; Msg
		push	eax		; hWnd
		call	ebx ; SendMessageA
		mov	edi, eax
		test	edi, edi
		mov	[esp+34h+var_24], edi
		jz	short loc_401E49
		mov	edx, [esi+0Ch]
		lea	ecx, [esp+34h+lParam]
		push	ecx		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	edx		; hWnd
		mov	[esp+44h+lParam], 40h
		call	ebx ; SendMessageA
		mov	eax, [esp+34h+var_24]
		test	eax, eax
		jz	short loc_401E49
		push	1
		jmp	short loc_401E4B
; ---------------------------------------------------------------------------

loc_401E49:				; CODE XREF: sub_401D70+B1j
					; sub_401D70+D3j
		push	0

loc_401E4B:				; CODE XREF: sub_401D70+D7j
		push	edi
		push	esi
		call	sub_402E20
		mov	eax, [esi+0Ch]
		add	esp, 0Ch
		push	eax		; hWnd
		call	ds:SetFocus
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401E68:				; CODE XREF: sub_401D70+5Bj
					; DATA XREF: .text:off_401F50o
		push	esi		; jumptable 00401DCB cases 16,32
		call	sub_401A20
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401E79:				; CODE XREF: sub_401D70+5Bj
					; DATA XREF: .text:off_401F50o
		push	esi		; jumptable 00401DCB cases 64,128
		call	sub_401980
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401E8A:				; CODE XREF: sub_401D70+41j
		push	esi		; uID
		call	sub_4028D0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401E9B:				; CODE XREF: sub_401D70+3Bj
		cmp	edi, 2000h
		ja	short loc_401F07
		jz	short loc_401EF6
		cmp	edi, 400h
		jz	short loc_401EE5
		cmp	edi, 800h
		jz	short loc_401ED4
		cmp	edi, 1000h
		jnz	loc_401F48	; jumptable 00401DCB default case
		push	0		; hDrop
		push	esi		; int
		call	sub_4040F0
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401ED4:				; CODE XREF: sub_401D70+143j
		push	esi
		call	sub_402440
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401EE5:				; CODE XREF: sub_401D70+13Bj
		push	esi
		call	sub_404000
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401EF6:				; CODE XREF: sub_401D70+133j
		push	esi
		call	sub_402770
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401F07:				; CODE XREF: sub_401D70+131j
		cmp	edi, 4000h
		jz	short loc_401F3F
		cmp	edi, 10000000h
		jnz	short loc_401F48 ; jumptable 00401DCB default case
		mov	ecx, [esi+0Ch]
		push	0		; lParam
		push	1		; wParam
		push	100Bh		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		push	0
		push	0
		push	esi
		call	sub_402E20
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_401F3F:				; CODE XREF: sub_401D70+19Dj
		push	esi
		call	sub_402810
		add	esp, 4

loc_401F48:				; CODE XREF: sub_401D70+4Dj
					; sub_401D70+5Bj ...
		pop	edi		; jumptable 00401DCB default case
		xor	eax, eax
		pop	esi
		add	esp, 28h
		retn
sub_401D70	endp

; ---------------------------------------------------------------------------
off_401F50	dd offset loc_401DD2, offset loc_401DE3, offset	loc_401DF4
					; DATA XREF: sub_401D70+5Br
		dd offset loc_401E68, offset loc_401E79, offset	loc_401F48 ; jump table	for switch statement
byte_401F68	db	0,     5,     1,     5 ; DATA XREF: sub_401D70+55r
		db	5,     5,     2,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     3,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     3,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     4,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     4
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_401FF0(size_t)
sub_401FF0	proc near		; CODE XREF: sub_402440+59p
					; sub_404530+14p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax		; size_t
		call	_malloc
		add	esp, 4
		retn
sub_401FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_402000(HWND hWnd, UINT uID, UINT, int)
sub_402000	proc near		; CODE XREF: sub_402440+12Dp
					; sub_402440+15Ap ...

Buffer		= byte ptr -280h
Text		= byte ptr -200h
hWnd		= dword	ptr  4
uID		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+uID]
		mov	edx, hModule
		sub	esp, 280h
		lea	eax, [esp+280h+Buffer]
		push	esi
		mov	esi, ds:LoadStringA
		push	80h		; cchBufferMax
		push	eax		; lpBuffer
		push	ecx		; uID
		push	edx		; hInstance
		call	esi ; LoadStringA
		mov	ecx, [esp+284h+arg_8]
		mov	edx, hModule
		lea	eax, [esp+284h+Text]
		push	200h		; cchBufferMax
		push	eax		; lpBuffer
		push	ecx		; uID
		push	edx		; hInstance
		call	esi ; LoadStringA
		mov	eax, [esp+284h+arg_C]
		lea	ecx, [esp+284h+Buffer]
		or	eax, 10000h
		lea	edx, [esp+284h+Text]
		push	eax		; uType
		mov	eax, [esp+288h+hWnd]
		push	ecx		; lpCaption
		push	edx		; lpText
		push	eax		; hWnd
		call	ds:MessageBoxA
		pop	esi
		add	esp, 280h
		retn
sub_402000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402080	proc near		; CODE XREF: sub_4043E0+D9p
					; sub_404D60+99p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	eax, 2
		jz	short loc_402095
		dec	eax
		jz	short loc_40208F
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_40208F:				; CODE XREF: sub_402080+Aj
		mov	eax, 2
		retn
; ---------------------------------------------------------------------------

loc_402095:				; CODE XREF: sub_402080+7j
		mov	eax, 1
		retn
sub_402080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4020A0	proc near		; CODE XREF: sub_404530+ADp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		lea	eax, [esp+8+arg_0]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		push	eax
		mov	ecx, [esi]
		lea	edi, [esi+17Ah]
		push	ecx
		mov	word ptr [esi+174h], 0
		mov	word ptr [esi+176h], 1
		mov	word ptr [esi+178h], 2
		mov	word ptr [edi],	0F0h
		mov	word ptr [esi+17Ch], 32h
		mov	word ptr [esi+17Eh], 0C8h
		mov	dword ptr [esi+134h], 2
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	loc_402193
		mov	ecx, [esp+10h+arg_0]
		lea	edx, [esp+10h+var_4]
		lea	eax, [esp+10h+var_8]
		push	edx
		push	eax
		push	25Fh
		push	ecx
		call	sub_41B0C0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_402183
		mov	eax, [esp+10h+var_8]
		push	ebx
		mov	ebx, [esp+14h+var_4]
		cmp	eax, 10h
		jnz	short loc_402174
		mov	ecx, ebx
		mov	edx, 3

loc_402142:				; CODE XREF: sub_4020A0+C9j
		mov	ax, [ecx]
		cmp	ax, 3
		jnb	short loc_40214F
		mov	[edi-6], ax

loc_40214F:				; CODE XREF: sub_4020A0+A9j
		mov	ax, [ecx+6]
		cmp	ax, 0Ah
		jb	short loc_402162
		cmp	ax, 3E8h
		ja	short loc_402162
		mov	[edi], ax

loc_402162:				; CODE XREF: sub_4020A0+B7j
					; sub_4020A0+BDj
		add	ecx, 2
		add	edi, 2
		dec	edx
		jnz	short loc_402142
		mov	edx, [ebx+0Ch]
		mov	[esi+134h], edx

loc_402174:				; CODE XREF: sub_4020A0+99j
		mov	eax, [esp+14h+arg_0]
		push	ebx
		push	eax
		call	sub_41B260
		add	esp, 8
		pop	ebx

loc_402183:				; CODE XREF: sub_4020A0+8Bj
		mov	ecx, [esp+10h+arg_0]
		push	0
		push	ecx
		call	ds:PGPclCloseClientPrefs
		add	esp, 8

loc_402193:				; CODE XREF: sub_4020A0+67j
		pop	edi
		pop	esi
		add	esp, 8
		retn
sub_4020A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4021A0	proc near		; CODE XREF: sub_4034E0+Cp
					; sub_4034E0+CEp ...

var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_A		= byte ptr -0Ah
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 14h
		lea	eax, [esp+14h+var_14]
		push	ebx
		mov	ebx, [esp+18h+arg_0]
		push	eax
		mov	ecx, [ebx]
		push	ecx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	loc_40225C
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		lea	ebp, [esp+24h+var_A]
		add	ebx, 174h

loc_4021D9:				; CODE XREF: sub_4021A0+83j
		mov	ax, [ebx]
		mov	[ebp-6], ax
		and	eax, 0FFFFh
		test	esi, esi
		mov	edi, eax
		jz	short loc_4021EF
		test	edi, edi
		jz	short loc_402211

loc_4021EF:				; CODE XREF: sub_4021A0+49j
		mov	edx, [esp+24h+arg_0]
		push	0		; lParam
		push	esi		; wParam
		push	101Dh		; Msg
		mov	eax, [edx+0Ch]
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	ecx, [esp+24h+arg_0]
		mov	[ecx+edi*2+17Ah], ax

loc_402211:				; CODE XREF: sub_4021A0+4Dj
		mov	dx, [ebx+6]
		inc	esi
		mov	[ebp+0], dx
		add	ebx, 2
		add	ebp, 2
		cmp	esi, 3
		jl	short loc_4021D9
		mov	eax, [esp+24h+arg_0]
		lea	edx, [esp+24h+var_10]
		push	edx		; void *
		push	10h		; size_t
		mov	ecx, [eax+134h]
		mov	eax, [esp+2Ch+var_14]
		push	25Fh		; int
		push	eax		; int
		mov	[esp+34h+var_4], ecx
		call	sub_41B170
		mov	ecx, [esp+34h+var_14]
		push	1
		push	ecx
		call	ds:PGPclCloseClientPrefs
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp

loc_40225C:				; CODE XREF: sub_4021A0+24j
		pop	ebx
		add	esp, 14h
		retn
sub_4021A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402270	proc near		; CODE XREF: sub_402770+4Ep
					; sub_4028D0+134p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		mov	edx, [esp+0Ch+arg_0]
		push	esi
		xor	eax, eax
		mov	ecx, [edx+28h]
		mov	esi, [edx+20h]
		mov	edx, [edx+134h]
		mov	[esp+10h+var_C], esi
		add	edx, 0FFFFFFFEh
		mov	[esp+10h+var_8], ecx
		cmp	edx, 5		; switch 6 cases
		pop	esi
		ja	short loc_4022D8 ; jumptable 00402297 default case
		jmp	ds:off_4022DC[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40229E:				; CODE XREF: sub_402270+27j
					; DATA XREF: .text:off_4022DCo
		lea	eax, [esp+0Ch+var_C] ; jumptable 00402297 cases	0,4
		mov	[esp+0Ch+var_4], 1
		push	eax
		push	offset loc_402300
		push	ecx
		call	PGPSortGroupSet
		add	esp, 0Ch
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_4022BD:				; CODE XREF: sub_402270+27j
					; DATA XREF: .text:off_4022DCo
		lea	edx, [esp+0Ch+var_C] ; jumptable 00402297 cases	1,5
		mov	[esp+0Ch+var_4], 1
		push	edx
		push	offset loc_402300
		push	ecx
		call	PGPSortGroupSet
		add	esp, 0Ch

loc_4022D8:				; CODE XREF: sub_402270+25j
					; sub_402270+27j
					; DATA XREF: ...
		add	esp, 0Ch	; jumptable 00402297 default case
		retn
sub_402270	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
off_4022DC	dd offset loc_40229E	; DATA XREF: sub_402270+27r
		dd offset loc_4022BD	; jump table for switch	statement
		dd offset loc_4022D8
		dd offset loc_4022D8
		dd offset loc_40229E
		dd offset loc_4022BD
		align 10h

loc_402300:				; DATA XREF: sub_402270+3Bo
					; sub_402270+5Ao
		mov	ecx, [esp+4]
		sub	esp, 118h
		mov	eax, [ecx]
		push	ebx
		mov	ebx, [esp+124h]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+134h]
		cmp	eax, 2
		mov	esi, [edi]
		mov	ebp, [edi+8]
		jz	short loc_402392
		cmp	dword ptr [ebx], 2
		jz	short loc_402392
		lea	eax, [esp+10h]
		push	eax
		push	esi
		push	ecx
		call	sub_402410
		lea	ecx, [esp+20h]
		mov	edi, eax
		push	ecx
		push	esi
		push	ebx
		call	sub_402410
		add	esp, 18h
		test	edi, edi
		jz	short loc_40235F
		test	eax, eax
		jz	short loc_40239C
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------

loc_40235F:				; CODE XREF: .text:0040234Cj
		test	eax, eax
		jz	short loc_402370
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------

loc_402370:				; CODE XREF: .text:00402361j
		mov	edx, [esp+14h]
		mov	eax, [esp+10h]
		push	2
		push	edx
		push	eax
		call	PGPCompareKeys
		add	esp, 0Ch
		imul	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------

loc_402392:				; CODE XREF: .text:00402326j
					; .text:0040232Bj
		cmp	eax, 2
		jnz	short loc_4023AB
		cmp	dword ptr [ebx], 1
		jnz	short loc_4023AB

loc_40239C:				; CODE XREF: .text:00402350j
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		neg	eax
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------

loc_4023AB:				; CODE XREF: .text:00402395j
					; .text:0040239Aj
		cmp	eax, 1
		jnz	short loc_4023C2
		cmp	dword ptr [ebx], 2
		jnz	short loc_4023C2
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------

loc_4023C2:				; CODE XREF: .text:004023AEj
					; .text:004023B3j
		mov	eax, [ecx+8]
		mov	ecx, [edi+4]
		lea	edx, [esp+0A0h]
		push	edx
		push	eax
		push	ecx
		call	PGPGetGroupInfo
		mov	eax, [ebx+8]
		mov	ecx, [edi+4]
		lea	edx, [esp+24h]
		push	edx
		push	eax
		push	ecx
		call	PGPGetGroupInfo
		add	esp, 18h
		lea	edx, [esp+1Ch]
		lea	eax, [esp+0A4h]
		push	edx
		push	eax
		call	ds:lstrcmpiA
		imul	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 118h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402410	proc near		; CODE XREF: .text:00402334p
					; .text:00402342p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		call	PGPGetKeySetContext
		mov	eax, [esp+8+arg_8]
		push	eax
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [eax+8]
		add	eax, 0Ch
		push	ecx
		push	eax
		push	esi
		call	PGPGetKeyByKeyID
		add	esp, 14h
		pop	esi
		retn
sub_402410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402440	proc near		; CODE XREF: sub_401D70+165p

var_1C		= dword	ptr -1Ch
lParam		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	esi
		mov	esi, [esp+20h+arg_0]
		lea	ecx, [esp+20h+lParam]
		push	edi
		mov	edx, [esi+0Ch]
		mov	eax, [esi]
		mov	edi, ds:SendMessageA
		push	ecx		; lParam
		push	0		; wParam
		push	1015h		; Msg
		push	edx		; hWnd
		mov	[esp+34h+var_1C], 0
		mov	[esp+34h+var_10], eax
		mov	[esp+34h+var_14], esi
		mov	[esp+34h+var_8], 0
		mov	[esp+34h+lParam], offset loc_4025B0
		call	edi ; SendMessageA
		mov	eax, [esp+24h+var_8]
		test	eax, eax
		jz	loc_40258D
		mov	ecx, eax
		shl	ecx, 4
		add	ecx, eax
		shl	ecx, 1
		push	ecx		; size_t
		call	sub_401FF0
		add	esp, 4
		lea	edx, [esp+24h+lParam]
		mov	[esp+24h+var_4], eax
		mov	eax, [esi+0Ch]
		push	edx		; lParam
		push	0		; wParam
		push	1015h		; Msg
		push	eax		; hWnd
		mov	[esp+34h+var_8], 0
		mov	[esp+34h+lParam], offset loc_402640
		call	edi ; SendMessageA
		mov	edx, [esi+20h]
		mov	eax, [esp+24h+var_8]
		lea	ecx, [esp+24h+var_1C]
		push	ecx
		mov	ecx, [esp+28h+var_4]
		push	edx
		mov	edx, [esi+8]
		push	2
		push	eax
		mov	eax, [esi+4]
		push	ecx
		mov	ecx, [esi]
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclSearchServerForKeyIDs
		mov	edx, [esp+44h+var_4]
		mov	edi, eax
		push	edx		; void *
		call	sub_40BF20
		add	esp, 24h
		cmp	edi, 0FFFFD12Dh
		jz	loc_4025A2
		test	edi, edi
		jz	short loc_402523
		push	edi
		push	0
		call	ds:PGPclErrorBox
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_402523:				; CODE XREF: sub_402440+CAj
		mov	eax, [esp+24h+var_1C]
		test	eax, eax
		jz	short loc_402582
		lea	ecx, [esp+24h+arg_0]
		push	ecx
		push	eax
		call	PGPCountKeys
		mov	eax, [esp+2Ch+arg_0]
		add	esp, 8
		test	eax, eax
		jbe	short loc_402560
		mov	edx, [esi+20h]
		mov	eax, [esp+24h+var_1C]
		mov	ecx, [esi+8]
		push	edx
		mov	edx, [esi+4]
		push	eax
		mov	eax, [esi]
		push	ecx
		push	edx
		push	eax
		call	ds:PGPclQueryAddKeys
		add	esp, 14h
		jmp	short loc_402575
; ---------------------------------------------------------------------------

loc_402560:				; CODE XREF: sub_402440+FFj
		mov	ecx, [esi+8]
		push	30h		; int
		push	4C2h		; UINT
		push	3		; uID
		push	ecx		; hWnd
		call	sub_402000
		add	esp, 10h

loc_402575:				; CODE XREF: sub_402440+11Ej
		mov	edx, [esp+24h+var_1C]
		push	edx
		call	PGPFreeKeySet
		add	esp, 4

loc_402582:				; CODE XREF: sub_402440+E9j
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40258D:				; CODE XREF: sub_402440+49j
		mov	eax, [esi+8]
		push	30h		; int
		push	830h		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		add	esp, 10h

loc_4025A2:				; CODE XREF: sub_402440+C2j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 1Ch
		retn
sub_402440	endp

; ---------------------------------------------------------------------------
		align 10h

loc_4025B0:				; DATA XREF: sub_402440+39o
		mov	ecx, [esp+4]
		sub	esp, 40h
		cmp	dword ptr [ecx+18h], 23h
		jnz	short loc_402626
		mov	eax, [ecx+24h]
		push	esi
		mov	esi, [esp+4Ch]
		shr	eax, 10h
		jz	short loc_4025EC
		lea	edx, [esp+4]
		push	edx
		xor	edx, edx
		mov	dx, [ecx+24h]
		push	edx
		push	eax
		mov	eax, [esi+4]
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPGetIndGroupItem
		mov	eax, [esp+1Ch]
		add	esp, 10h
		jmp	short loc_4025F2
; ---------------------------------------------------------------------------

loc_4025EC:				; CODE XREF: .text:004025C8j
		xor	eax, eax
		mov	ax, [ecx+24h]

loc_4025F2:				; CODE XREF: .text:004025EAj
		lea	edx, [esp+48h]
		lea	ecx, [esp+4Ch]
		push	edx
		mov	edx, [esi+4]
		push	ecx
		push	1
		push	eax
		mov	eax, [edx+28h]
		push	eax
		call	PGPCountGroupItems
		mov	ecx, [esp+60h]
		mov	eax, [esi+10h]
		add	esp, 14h
		add	eax, ecx
		mov	[esi+10h], eax
		mov	eax, 1
		pop	esi
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------

loc_402626:				; CODE XREF: .text:004025BBj
		mov	eax, [esp+48h]
		mov	ecx, [eax+10h]
		inc	ecx
		mov	[eax+10h], ecx
		mov	eax, 1
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------
		align 10h

loc_402640:				; DATA XREF: sub_402440+7Do
		mov	edx, [esp+4]
		sub	esp, 40h
		xor	ecx, ecx
		mov	eax, [edx+24h]
		mov	cx, [edx+24h]
		shr	eax, 10h
		push	ebx
		mov	ebx, [esp+4Ch]
		test	eax, eax
		jz	short loc_4026B3
		lea	edx, [esp+4]
		push	edx
		push	ecx
		push	eax
		mov	eax, [ebx+4]
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPGetIndGroupItem
		mov	eax, [esp+14h]
		add	esp, 10h
		cmp	eax, 1
		jnz	short loc_4026AF
		mov	eax, [ebx+10h]
		push	esi
		mov	edx, eax
		push	edi
		shl	edx, 4
		add	edx, eax
		mov	eax, [ebx+14h]
		mov	ecx, 8
		lea	esi, [esp+18h]
		lea	edi, [eax+edx*2]
		rep movsd
		movsw
		mov	eax, [ebx+10h]
		pop	edi
		inc	eax
		pop	esi
		mov	[ebx+10h], eax
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------

loc_4026AF:				; CODE XREF: .text:00402679j
		mov	ecx, [esp+0Ch]

loc_4026B3:				; CODE XREF: .text:0040265Aj
		test	ecx, ecx
		jz	short loc_4026C1
		push	ecx
		push	ebx
		call	sub_4026D0
		add	esp, 8

loc_4026C1:				; CODE XREF: .text:004026B5j
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4026D0	proc near		; CODE XREF: .text:004026B9p
					; sub_4026D0+80p

var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 44h
		mov	edx, [esp+44h+arg_4]
		lea	eax, [esp+44h+arg_0]
		lea	ecx, [esp+44h+var_44]
		push	ebx
		mov	ebx, [esp+48h+arg_0]
		push	ebp
		push	eax
		mov	eax, [ebx+4]
		push	ecx
		push	0
		push	edx
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPCountGroupItems
		mov	eax, [esp+60h+arg_0]
		add	esp, 14h
		xor	ebp, ebp
		test	eax, eax
		jle	short loc_402763
		push	esi
		push	edi

loc_402705:				; CODE XREF: sub_4026D0+8Fj
		mov	ecx, [ebx+4]
		mov	eax, [esp+54h+arg_4]
		lea	edx, [esp+54h+var_40]
		push	edx
		mov	edx, [ecx+28h]
		push	ebp
		push	eax
		push	edx
		call	PGPGetIndGroupItem
		mov	eax, [esp+64h+var_40]
		add	esp, 10h
		cmp	eax, 1
		jnz	short loc_40274A
		mov	eax, [ebx+10h]
		mov	edx, [ebx+14h]
		mov	ecx, eax
		lea	esi, [esp+54h+var_34]
		shl	ecx, 4
		add	ecx, eax
		lea	edi, [edx+ecx*2]
		mov	ecx, 8
		rep movsd
		movsw
		inc	dword ptr [ebx+10h]
		jmp	short loc_402758
; ---------------------------------------------------------------------------

loc_40274A:				; CODE XREF: sub_4026D0+56j
		mov	eax, [esp+54h+var_38]
		push	eax
		push	ebx
		call	sub_4026D0
		add	esp, 8

loc_402758:				; CODE XREF: sub_4026D0+78j
		mov	eax, [esp+54h+arg_0]
		inc	ebp
		cmp	ebp, eax
		jl	short loc_402705
		pop	edi
		pop	esi

loc_402763:				; CODE XREF: sub_4026D0+31j
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
sub_4026D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402770	proc near		; CODE XREF: sub_401D70+187p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		lea	eax, [esp+8+var_4]
		push	edi
		mov	ecx, [esi+20h]
		mov	edx, [esi+8]
		push	eax
		mov	eax, [esi+4]
		push	ecx
		mov	ecx, [esi]
		push	edx
		push	eax
		push	ecx
		mov	[esp+20h+var_4], 0
		call	ds:PGPclGetGroupsFromRootServer
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		jnz	short loc_4027FC
		mov	eax, [esp+0Ch+var_4]
		test	eax, eax
		jz	short loc_4027FC
		mov	edx, [esi+28h]
		push	edx
		push	eax
		call	PGPMergeGroupSets
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_4027EF
		push	esi
		call	sub_402270
		push	1
		push	esi
		call	sub_402840
		push	edi
		push	1
		push	edi
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 1Ch
		push	1		; bErase
		push	edi		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ds:UpdateWindow

loc_4027EF:				; CODE XREF: sub_402770+4Bj
		mov	edx, [esp+0Ch+var_4]
		push	edx
		call	PGPFreeGroupSet
		add	esp, 4

loc_4027FC:				; CODE XREF: sub_402770+30j
					; sub_402770+38j
		mov	eax, [esi+8]
		push	edi
		push	eax
		call	ds:PGPclErrorBox
		add	esp, 8
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_402770	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402810	proc near		; CODE XREF: sub_401D70+1D0p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+28h]
		mov	ecx, [esi+20h]
		mov	edx, [esi+8]
		push	eax
		mov	eax, [esi+4]
		push	ecx
		mov	ecx, [esi]
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclSendGroupsToRootServer
		mov	edx, [esi+8]
		push	eax
		push	edx
		call	ds:PGPclErrorBox
		add	esp, 1Ch
		pop	esi
		retn
sub_402810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402840	proc near		; CODE XREF: sub_402770+56p
					; sub_4028D0+13Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		xor	esi, esi
		mov	eax, [edi+28h]
		push	eax
		call	PGPGroupSetNeedsCommit
		add	esp, 4
		test	al, al
		jz	short loc_4028C3
		push	ebp
		push	7F02h		; lpCursorName
		push	esi		; hInstance
		call	ds:LoadCursorA
		mov	ebx, ds:SetCursor
		push	eax		; hCursor
		call	ebx ; SetCursor
		mov	ecx, [edi+24h]
		mov	ebp, eax
		push	ecx
		call	ds:PGPclSaveGroupFile
		add	esp, 4
		mov	esi, eax
		push	ebp		; hCursor
		call	ebx ; SetCursor
		push	esi
		push	0
		call	ds:PGPclErrorBox
		add	esp, 8
		test	eax, eax
		pop	ebp
		jnz	short loc_4028C3
		mov	eax, [esp+0Ch+arg_4]
		test	eax, eax
		jz	short loc_4028C3
		push	offset String	; "PGPM_RELOADKEYRING"
		call	ds:RegisterWindowMessageA
		mov	ebx, eax
		call	ds:GetCurrentProcessId
		xor	edx, edx
		push	eax		; lParam
		mov	dx, [edi+8]
		push	edx		; wParam
		push	ebx		; Msg
		push	0FFFFh		; hWnd
		call	ds:PostMessageA

loc_4028C3:				; CODE XREF: sub_402840+17j
					; sub_402840+52j ...
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_402840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4028D0(UINT uID)
sub_4028D0	proc near		; CODE XREF: sub_401D70+11Bp

lParam		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
var_168		= dword	ptr -168h
var_15C		= dword	ptr -15Ch
dwInitParam	= dword	ptr -158h
var_150		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
String1		= byte ptr -148h
var_109		= byte ptr -109h
var_C8		= byte ptr -0C8h
var_C0		= dword	ptr -0C0h
var_88		= byte ptr -88h
String2		= byte ptr -84h
var_44		= byte ptr -44h
uID		= dword	ptr  4

		sub	esp, 180h
		push	esi
		mov	esi, [esp+184h+uID]
		push	edi
		push	esi
		mov	[esp+18Ch+dwInitParam],	esi
		mov	[esp+18Ch+var_14C], 0
		call	sub_4030A0
		mov	ecx, [esi+0Ch]
		mov	edi, ds:SendMessageA
		add	esp, 4
		mov	[esp+188h+var_17C], eax
		lea	eax, [esp+188h+lParam]
		mov	[esp+188h+lParam], 6
		push	eax		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	ecx		; hWnd
		call	edi ; SendMessageA
		cmp	[esp+188h+var_168], 23h
		jz	short loc_40296B
		push	esi
		call	sub_4030A0
		add	esp, 4
		lea	edx, [esp+188h+lParam]
		mov	[esp+188h+var_17C], eax
		mov	eax, [esi+0Ch]
		push	edx		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	eax		; hWnd
		mov	[esp+198h+lParam], 80h
		call	edi ; SendMessageA
		mov	edx, [esi+0Ch]
		lea	ecx, [esp+188h+lParam]
		push	ecx		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	edx		; hWnd
		mov	[esp+198h+lParam], 6
		call	edi ; SendMessageA
		cmp	[esp+188h+var_168], 23h
		jnz	loc_402A40

loc_40296B:				; CODE XREF: sub_4028D0+4Dj
		mov	eax, [esp+188h+var_15C]
		mov	ecx, eax
		shr	ecx, 10h
		mov	[esp+188h+var_150], ecx
		jz	short loc_40299E
		lea	edx, [esp+188h+var_C8]
		and	eax, 0FFFFh
		push	edx
		push	eax
		mov	eax, [esi+28h]
		push	ecx
		push	eax
		call	PGPGetIndGroupItem
		mov	eax, [esp+198h+var_C0]
		add	esp, 10h
		jmp	short loc_4029A3
; ---------------------------------------------------------------------------

loc_40299E:				; CODE XREF: sub_4028D0+A8j
		and	eax, 0FFFFh

loc_4029A3:				; CODE XREF: sub_4028D0+CCj
		mov	edx, [esi+28h]
		lea	ecx, [esp+188h+var_88]
		push	ecx
		push	eax
		push	edx
		mov	[esp+194h+var_150], eax
		call	PGPGetGroupInfo
		mov	edi, ds:lstrcpyA
		add	esp, 0Ch
		lea	eax, [esp+188h+String2]
		lea	ecx, [esp+188h+String1]
		push	eax		; lpString2
		push	ecx		; lpString1
		call	edi ; lstrcpyA
		lea	edx, [esp+188h+var_44]
		lea	eax, [esp+188h+var_109]
		push	edx		; lpString2
		push	eax		; lpString1
		call	edi ; lstrcpyA
		mov	edx, [esi+8]
		mov	eax, hModule
		lea	ecx, [esp+188h+dwInitParam]
		push	ecx		; dwInitParam
		push	offset DialogFunc ; lpDialogFunc
		push	edx		; hWndParent
		push	0D1h		; lpTemplateName
		push	eax		; hInstance
		call	ds:DialogBoxParamA
		test	eax, eax
		jz	short loc_402A40
		push	esi
		call	sub_402270
		push	1
		push	esi
		call	sub_402840
		push	esi		; uID
		call	sub_4051E0
		mov	ecx, [esi+0Ch]
		add	esp, 10h
		push	0		; bErase
		push	0		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		mov	edx, [esi+0Ch]
		push	edx		; hWnd
		call	ds:UpdateWindow
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 180h
		retn
; ---------------------------------------------------------------------------

loc_402A40:				; CODE XREF: sub_4028D0+95j
					; sub_4028D0+131j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 180h
		retn
sub_4028D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DialogFunc(HWND, UINT,	WPARAM,	LPARAM)
DialogFunc	proc near		; DATA XREF: sub_4028D0+11Do
					; sub_402D60+1Do

Buffer		= byte ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
dwNewLong	= dword	ptr  10h

		mov	eax, [esp+arg_4]
		sub	esp, 40h
		add	eax, 0FFFFFFADh	; switch 191 cases
		push	ebx
		push	ebp
		push	esi
		cmp	eax, 0BEh
		push	edi
		ja	loc_402B32	; jumptable 00402A71 default case
		xor	ecx, ecx
		mov	cl, ds:byte_402C9C[eax]
		jmp	ds:off_402C88[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_402A78:				; CODE XREF: DialogFunc+21j
					; DATA XREF: .text:off_402C88o
		mov	edi, [esp+50h+dwNewLong] ; jumptable 00402A71 case 272
		mov	esi, [esp+50h+hWnd]
		push	edi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	ebx, ds:SendDlgItemMessageA
		push	0		; lParam
		push	3Fh		; wParam
		push	0C5h		; Msg
		push	3FAh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SendDlgItemMessageA
		push	0		; lParam
		push	3Fh		; wParam
		push	0C5h		; Msg
		push	415h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SendDlgItemMessageA
		mov	eax, [edi+0Ch]
		test	eax, eax
		jnz	short loc_402AFB
		mov	eax, hModule
		lea	edx, [esp+50h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	82Dh		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		lea	ecx, [esp+50h+Buffer]
		push	ecx		; lpString
		push	esi		; hWnd
		call	ds:SetWindowTextA
		mov	ebx, ds:SetDlgItemTextA
		lea	edx, [edi+10h]
		push	edx		; lpString
		push	3FAh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		add	edi, 4Fh
		push	edi		; lpString
		push	415h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA

loc_402AFB:				; CODE XREF: DialogFunc+67j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402B0A:				; CODE XREF: DialogFunc+21j
					; DATA XREF: .text:off_402C88o
		mov	eax, [esp+50h+hWnd] ; jumptable	00402A71 case 83
		push	0FFFFFFEBh	; nIndex
		push	eax		; hWnd
		call	ds:GetWindowLongA
		mov	ecx, [eax]
		push	offset dword_42F08C ; dwData
		mov	edx, [esp+54h+dwNewLong]
		add	ecx, 30h
		push	0Ch		; uCommand
		push	ecx		; lpszHelp
		mov	eax, [edx+0Ch]
		push	eax		; hWndMain
		call	ds:WinHelpA

loc_402B32:				; CODE XREF: DialogFunc+13j
					; DialogFunc+21j
					; DATA XREF: ...
		pop	edi		; jumptable 00402A71 default case
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402B3E:				; CODE XREF: DialogFunc+21j
					; DATA XREF: .text:off_402C88o
		mov	ecx, [esp+50h+hWnd] ; jumptable	00402A71 case 123
		push	0FFFFFFEBh	; nIndex
		push	ecx		; hWnd
		call	ds:GetWindowLongA
		mov	edx, [eax]
		push	offset dword_42F08C ; dwData
		mov	eax, [esp+54h+arg_8]
		add	edx, 30h
		push	0Ah		; uCommand
		push	edx		; lpszHelp
		push	eax		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402B6F:				; CODE XREF: DialogFunc+21j
					; DATA XREF: .text:off_402C88o
		mov	eax, [esp+50h+arg_8] ; jumptable 00402A71 case 273
		and	eax, 0FFFFh
		dec	eax
		jz	short loc_402BA9
		dec	eax
		jz	short loc_402B8D
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402B8D:				; CODE XREF: DialogFunc+12Cj
		mov	ecx, [esp+50h+hWnd]
		push	0		; nResult
		push	ecx		; hDlg
		call	ds:EndDialog
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402BA9:				; CODE XREF: DialogFunc+129j
		mov	ebx, [esp+50h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	ebx		; hWnd
		call	ds:GetWindowLongA
		mov	esi, eax
		push	3Fh		; cchMax
		lea	ebp, [esi+10h]
		push	ebp		; lpString
		push	3FAh		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:GetDlgItemTextA
		test	eax, eax
		jnz	short loc_402BEF
		push	30h		; int
		push	829h		; UINT
		push	3		; uID
		push	ebx		; hWnd
		call	sub_402000
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402BEF:				; CODE XREF: DialogFunc+17Cj
		lea	edi, [esi+4Fh]
		push	3Fh		; cchMax
		push	edi		; lpString
		push	415h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:GetDlgItemTextA
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_402C1E
		mov	eax, [esi]
		lea	edx, [esi+8]
		push	edx
		push	edi
		mov	ecx, [eax+28h]
		push	ebp
		push	ecx
		call	PGPNewGroup
		add	esp, 10h
		jmp	short loc_402C48
; ---------------------------------------------------------------------------

loc_402C1E:				; CODE XREF: DialogFunc+1B6j
		mov	eax, [esi]
		mov	edx, [esi+8]
		push	ebp
		push	edx
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPSetGroupName
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_402C4C
		mov	eax, [esi]
		mov	edx, [esi+8]
		push	edi
		push	edx
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPSetGroupDescription
		add	esp, 0Ch

loc_402C48:				; CODE XREF: DialogFunc+1CCj
		test	eax, eax
		jz	short loc_402C70

loc_402C4C:				; CODE XREF: DialogFunc+1E3j
		push	eax
		push	0
		call	ds:PGPclErrorBox
		add	esp, 8
		push	0		; nResult
		push	ebx		; hDlg
		call	ds:EndDialog
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_402C70:				; CODE XREF: DialogFunc+1FAj
		push	1		; nResult
		push	ebx		; hDlg
		call	ds:EndDialog
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 40h
		retn	10h
DialogFunc	endp

; ---------------------------------------------------------------------------
off_402C88	dd offset loc_402B0A, offset loc_402B3E, offset	loc_402A78
					; DATA XREF: DialogFunc+21r
		dd offset loc_402B6F, offset loc_402B32	; jump table for switch	statement
byte_402C9C	db	0,     4,     4,     4 ; DATA XREF: DialogFunc+1Br
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	1,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     2,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402D60	proc near		; CODE XREF: .text:0040F07Bp

dwInitParam	= dword	ptr -90h
var_84		= dword	ptr -84h
arg_0		= dword	ptr  4

		sub	esp, 90h
		mov	edx, hModule
		push	esi
		mov	esi, [esp+94h+arg_0]
		lea	eax, [esp+94h+dwInitParam]
		push	edi
		push	eax		; dwInitParam
		mov	ecx, [esi+8]
		push	offset DialogFunc ; lpDialogFunc
		push	ecx		; hWndParent
		push	0D1h		; lpTemplateName
		push	edx		; hInstance
		xor	edi, edi
		mov	[esp+0ACh+dwInitParam],	esi
		mov	[esp+0ACh+var_84], 1
		call	ds:DialogBoxParamA
		test	eax, eax
		jz	short loc_402E0D
		push	ebx
		push	1
		push	esi
		call	sub_402840
		mov	eax, [esi+0Ch]
		add	esp, 8
		push	edi		; lParam
		push	edi		; wParam
		push	1003h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	ecx, [esi+0Ch]
		push	1		; bErase
		push	edi		; lpRect
		mov	edi, ds:InvalidateRect
		push	ecx		; hWnd
		call	edi ; InvalidateRect
		mov	edx, [esi+0Ch]
		mov	ebx, ds:UpdateWindow
		push	edx		; hWnd
		call	ebx ; UpdateWindow
		push	esi
		call	sub_402270
		push	0
		push	0
		push	1
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 14h
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	edi ; InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ebx ; UpdateWindow
		pop	ebx
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 90h
		retn
; ---------------------------------------------------------------------------

loc_402E0D:				; CODE XREF: sub_402D60+3Fj
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 90h
		retn
sub_402D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402E20	proc near		; CODE XREF: sub_401D70+DDp
					; sub_401D70+1BFp ...

lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		mov	eax, [esp+arg_4]
		sub	esp, 28h
		push	esi
		mov	esi, [esp+2Ch+arg_0]
		push	edi
		xor	edi, edi
		cmp	ecx, edi
		mov	[esi+15Ch], eax
		mov	[esi+148h], ecx
		jnz	short loc_402E49
		mov	[esi+150h], edi

loc_402E49:				; CODE XREF: sub_402E20+21j
		cmp	eax, edi
		jz	loc_402F0C
		mov	ecx, [esi+0Ch]
		mov	[esp+30h+var_24], eax
		lea	eax, [esp+30h+lParam]
		mov	[esp+30h+lParam], 6
		push	eax		; lParam
		push	edi		; wParam
		push	100Ch		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		test	eax, eax
		jz	loc_402F2B
		mov	eax, [esp+30h+var_10]
		mov	edx, [esp+30h+var_4]
		mov	[esi+154h], eax
		inc	eax
		cmp	eax, 24h	; switch 37 cases
		mov	[esi+160h], edx
		ja	loc_402F22	; jumptable 00402EA0 default case
		xor	ecx, ecx
		mov	cl, ds:byte_402F44[eax]
		jmp	ds:off_402F34[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_402EA7:				; CODE XREF: sub_402E20+80j
					; DATA XREF: .text:off_402F34o
		push	esi		; jumptable 00402EA0 case 0
		mov	[esi+158h], edi
		call	sub_402F70
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_402EBC:				; CODE XREF: sub_402E20+80j
					; DATA XREF: .text:off_402F34o
		mov	ecx, [esi+150h]	; jumptable 00402EA0 cases 7-24
		mov	eax, 2
		or	ecx, eax
		push	esi
		mov	[esi+158h], eax
		mov	[esi+150h], ecx
		call	sub_402F70
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_402EE4:				; CODE XREF: sub_402E20+80j
					; DATA XREF: .text:off_402F34o
		mov	ecx, [esi+150h]	; jumptable 00402EA0 case 36
		mov	eax, 1
		or	ecx, eax
		push	esi
		mov	[esi+158h], eax
		mov	[esi+150h], ecx
		call	sub_402F70
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_402F0C:				; CODE XREF: sub_402E20+2Bj
		mov	dword ptr [esi+154h], 0FFFFFFFFh
		mov	[esi+158h], edi
		mov	[esi+160h], edi

loc_402F22:				; CODE XREF: sub_402E20+72j
					; sub_402E20+80j
					; DATA XREF: ...
		push	esi		; jumptable 00402EA0 default case
		call	sub_402F70
		add	esp, 4

loc_402F2B:				; CODE XREF: sub_402E20+54j
		pop	edi
		pop	esi
		add	esp, 28h
		retn
sub_402E20	endp

; ---------------------------------------------------------------------------
		align 4
off_402F34	dd offset loc_402EA7	; DATA XREF: sub_402E20+80r
		dd offset loc_402EBC	; jump table for switch	statement
		dd offset loc_402EE4
		dd offset loc_402F22
byte_402F44	db	0,     3,     3,     3 ; DATA XREF: sub_402E20+7Ar
		db	3,     3,     3,     1 ; indirect table	for switch statement
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     1,     1,     1
		db	1,     3,     3,     3
		db	3,     3,     3,     3
		db	3,     3,     3,     3
		db	2
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_402F70	proc near		; CODE XREF: sub_402E20+8Ep
					; sub_402E20+B6p ...

lParam		= dword	ptr -108h
var_104		= dword	ptr -104h
String1		= byte ptr -100h
Buffer		= byte ptr -80h
arg_0		= dword	ptr  4

		sub	esp, 108h
		push	esi
		mov	esi, [esp+10Ch+arg_0]
		mov	eax, [esi+14h]
		test	eax, eax
		jz	loc_40304E
		mov	eax, [esi+150h]
		push	ebx
		sub	eax, 0
		push	edi
		jz	short loc_402FB1
		dec	eax
		jz	short loc_402FAA
		dec	eax
		jz	short loc_402FA3
		mov	ebx, 4AEh
		jmp	short loc_402FB3
; ---------------------------------------------------------------------------

loc_402FA3:				; CODE XREF: sub_402F70+2Aj
		mov	ebx, 4ABh
		jmp	short loc_402FB3
; ---------------------------------------------------------------------------

loc_402FAA:				; CODE XREF: sub_402F70+27j
		mov	ebx, 4ACh
		jmp	short loc_402FB3
; ---------------------------------------------------------------------------

loc_402FB1:				; CODE XREF: sub_402F70+24j
		xor	ebx, ebx

loc_402FB3:				; CODE XREF: sub_402F70+31j
					; sub_402F70+38j ...
		mov	eax, [esi+148h]
		mov	edi, ds:SendMessageA
		test	eax, eax
		jz	short loc_402FE7
		mov	ecx, [esi+0Ch]
		lea	eax, [esp+114h+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	1015h		; Msg
		push	ecx		; hWnd
		mov	[esp+124h+lParam], offset loc_403060
		mov	[esp+124h+var_104], 0
		call	edi ; SendMessageA
		jmp	short loc_402FEF
; ---------------------------------------------------------------------------

loc_402FE7:				; CODE XREF: sub_402F70+51j
		mov	[esp+114h+var_104], 1

loc_402FEF:				; CODE XREF: sub_402F70+75j
		test	ebx, ebx
		jz	short loc_40302A
		mov	eax, hModule
		lea	edx, [esp+114h+Buffer]
		push	80h		; cchBufferMax
		push	edx		; lpBuffer
		push	ebx		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		mov	ecx, [esp+114h+var_104]
		lea	edx, [esp+114h+Buffer]
		push	ecx
		lea	eax, [esp+118h+String1]
		push	edx		; LPCSTR
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		jmp	short loc_40303A
; ---------------------------------------------------------------------------

loc_40302A:				; CODE XREF: sub_402F70+81j
		lea	ecx, [esp+114h+String1]
		push	offset byte_430394 ; lpString2
		push	ecx		; lpString1
		call	ds:lstrcpyA

loc_40303A:				; CODE XREF: sub_402F70+B8j
		mov	eax, [esi+14h]
		lea	edx, [esp+114h+String1]
		push	edx		; lParam
		push	1		; wParam
		push	401h		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		pop	edi
		pop	ebx

loc_40304E:				; CODE XREF: sub_402F70+13j
		pop	esi
		add	esp, 108h
		retn
sub_402F70	endp

; ---------------------------------------------------------------------------
		align 10h

loc_403060:				; DATA XREF: sub_402F70+63o
		mov	eax, [esp+8]
		mov	ecx, [eax+4]
		inc	ecx
		mov	[eax+4], ecx
		mov	eax, 1
		retn	8
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403080	proc near		; CODE XREF: sub_401C90+5p
					; sub_401CB0+5p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+154h]
		retn
sub_403080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403090	proc near		; CODE XREF: sub_401CD0+5p
					; sub_401CF0+5p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+158h]
		retn
sub_403090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4030A0	proc near		; CODE XREF: sub_401980+34p
					; sub_401A20+34p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+15Ch]
		retn
sub_4030A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4030B0	proc near		; CODE XREF: sub_401980+9p
					; sub_401A20+9p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+148h]
		retn
sub_4030B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4030C0	proc near		; CODE XREF: sub_4030D0+45p
					; sub_4030D0+AEp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+150h]
		retn
sub_4030C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4030D0(UINT uID, int)
sub_4030D0	proc near		; CODE XREF: .text:0040DAA8p

Points		= tagPOINT ptr -8
uID		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+uID]
		test	esi, esi
		jnz	short loc_4030E6
		mov	eax, 0FFFFD120h
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4030E6:				; CODE XREF: sub_4030D0+Aj
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	eax, [edi+8]
		add	eax, 74h	; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_40336C	; jumptable 004030FA default case
		jmp	ds:off_403374[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_403101:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		mov	eax, [edi+0Ch]	; jumptable 004030FA case -102
		mov	ecx, [edi+40h]
		and	eax, 80h
		push	eax
		push	ecx
		push	esi
		call	sub_402E20
		push	esi
		call	sub_4030C0
		add	esp, 10h
		mov	[edi+0Ch], eax
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_403128:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		push	100h		; jumptable 004030FA case -105
		push	esi
		call	sub_401AD0
		add	esp, 8
		test	eax, eax
		jz	loc_40336C	; jumptable 004030FA default case
		push	400h		; int
		push	esi		; uID
		call	sub_401D70
		mov	edx, [esi+18h]
		push	20000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_403163:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		push	ebx		; jumptable 004030FA case -114
		mov	ebx, [edi+40h]
		push	esi
		call	sub_4030A0
		add	esp, 4
		cmp	eax, ebx
		jz	short loc_4031B9
		push	0
		push	ebx
		push	esi
		call	sub_402E20
		push	esi
		call	sub_4030C0
		add	esp, 10h
		mov	[edi+0Ch], eax
		mov	eax, [esi+8]
		push	eax		; hwndLock
		call	ds:ImageList_DragLeave
		mov	ecx, [esi+0Ch]
		push	1		; bErase
		push	0		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		mov	edx, [esi+0Ch]
		push	edx		; hWnd
		call	ds:UpdateWindow
		mov	eax, [esi+8]
		push	0		; y
		push	0		; x
		push	eax		; hwndLock
		call	ds:ImageList_DragEnter

loc_4031B9:				; CODE XREF: sub_4030D0+A2j
		mov	ecx, [edi+64h]
		mov	edx, [edi+68h]
		mov	[esp+14h+Points.x], ecx
		mov	ecx, [esi+8]
		lea	eax, [esp+14h+Points]
		mov	[esp+14h+Points.y], edx
		mov	edx, [esi+0Ch]
		push	1		; cPoints
		push	eax		; lpPoints
		push	ecx		; hWndTo
		push	edx		; hWndFrom
		call	ds:MapWindowPoints
		mov	eax, [esi+170h]
		mov	ebx, [esp+14h+Points.y]
		mov	ecx, [esi+16Ch]
		mov	edx, [esp+14h+Points.x]
		add	eax, ebx
		add	ecx, edx
		push	eax		; y
		push	ecx		; x
		call	ds:ImageList_DragMove
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_403205:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		mov	edx, [esi+8]	; jumptable 004030FA case -116
		push	edx		; hwndLock
		call	ds:ImageList_DragLeave
		mov	eax, [esi+0Ch]
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ds:UpdateWindow
		mov	edx, [esi+8]
		push	0		; y
		push	0		; x
		push	edx		; hwndLock
		call	ds:ImageList_DragEnter
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_40323D:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		cmp	word ptr [edi+0Ch], 2Eh	; jumptable 004030FA case -112
		jnz	loc_40336C	; jumptable 004030FA default case
		push	esi		; uID
		call	sub_4035C0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_403259:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		push	esi		; jumptable 004030FA case -109
		call	sub_4030C0
		add	esp, 4
		mov	[edi+0Ch], eax
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_40326D:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		push	esi		; jumptable 004030FA case -115
		call	sub_4034E0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_40327E:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		push	esi		; jumptable 004030FA case -107
		call	sub_4030A0
		mov	[esi+164h], eax
		mov	eax, [esi+2Ch]
		push	0
		push	eax
		call	sub_401970
		push	esi
		call	sub_4033B0
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4032A6:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		mov	eax, [edi+10h]	; jumptable 004030FA case -108
		test	eax, eax
		jz	short loc_4032B6
		push	esi
		call	sub_403BD0
		add	esp, 4

loc_4032B6:				; CODE XREF: sub_4030D0+1DBj
		push	esi
		call	sub_4034C0
		mov	ecx, [esi+2Ch]
		push	1
		push	ecx
		call	sub_401970
		mov	edx, [esi+164h]
		push	0
		push	edx
		push	esi
		call	sub_402E20
		add	esp, 18h
		xor	eax, eax
		pop	edi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4032E1:				; CODE XREF: sub_4030D0+2Aj
					; DATA XREF: .text:off_403374o
		mov	edi, [edi+10h]	; jumptable 004030FA case -103
		mov	ecx, [esi+134h]
		xor	eax, eax
		mov	edx, ecx
		mov	ax, [esi+edi*2+174h]
		sub	eax, 0
		jz	short loc_40330B
		dec	eax
		jnz	short loc_403316
		xor	edx, edx
		cmp	ecx, 6
		setz	dl
		add	edx, 6
		jmp	short loc_403316
; ---------------------------------------------------------------------------

loc_40330B:				; CODE XREF: sub_4030D0+229j
		xor	edx, edx
		cmp	ecx, 2
		setz	dl
		add	edx, 2

loc_403316:				; CODE XREF: sub_4030D0+22Cj
					; sub_4030D0+239j
		cmp	edx, ecx
		jz	short loc_40336C ; jumptable 004030FA default case
		mov	eax, [esi+0Ch]
		push	0		; lParam
		push	0		; wParam
		push	1003h		; Msg
		push	eax		; hWnd
		mov	[esi+134h], edx
		call	ds:SendMessageA
		mov	ecx, [esi+0Ch]
		mov	edi, ds:InvalidateRect
		push	1		; bErase
		push	0		; lpRect
		push	ecx		; hWnd
		call	edi ; InvalidateRect
		mov	edx, [esi+0Ch]
		push	edx		; hWnd
		call	ds:UpdateWindow
		push	esi
		call	sub_402270
		push	0
		push	0
		push	1
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 14h
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	edi ; InvalidateRect

loc_40336C:				; CODE XREF: sub_4030D0+24j
					; sub_4030D0+2Aj ...
		pop	edi		; jumptable 004030FA default case
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
sub_4030D0	endp

; ---------------------------------------------------------------------------
off_403374	dd offset loc_403205	; DATA XREF: sub_4030D0+2Ar
		dd offset loc_40326D	; jump table for switch	statement
		dd offset loc_403163
		dd offset loc_40336C
		dd offset loc_40323D
		dd offset loc_40336C
		dd offset loc_40336C
		dd offset loc_403259
		dd offset loc_4032A6
		dd offset loc_40327E
		dd offset loc_40336C
		dd offset loc_403128
		dd offset loc_40336C
		dd offset loc_4032E1
		dd offset loc_403101

; =============== S U B	R O U T	I N E =======================================


sub_4033B0	proc near		; CODE XREF: sub_4030D0+1C6p

lParam		= dword	ptr -174h
var_170		= dword	ptr -170h
cy		= dword	ptr -16Ch
Point		= tagPOINT ptr -168h
dxHotspot	= dword	ptr -160h
dyHotspot	= dword	ptr -15Ch
var_158		= dword	ptr -158h
pvParam		= dword	ptr -154h
var_150		= dword	ptr -150h
var_140		= dword	ptr -140h
var_B8		= dword	ptr -0B8h
arg_0		= dword	ptr  4

		sub	esp, 174h
		push	esi
		push	edi
		lea	eax, [esp+17Ch+pvParam]
		push	0		; fWinIni
		push	eax		; pvParam
		push	154h		; uiParam
		push	29h		; uiAction
		mov	[esp+18Ch+pvParam], 154h
		call	ds:SystemParametersInfoA
		mov	esi, [esp+17Ch+arg_0]
		mov	eax, [esp+17Ch+var_150]
		mov	ecx, [esp+17Ch+var_140]
		mov	edx, [esi+8]
		add	ecx, eax
		push	edx		; hWnd
		mov	[esi+16Ch], eax
		mov	[esi+170h], ecx
		call	ds:GetMenu
		test	eax, eax
		jz	short loc_403414
		mov	eax, [esp+17Ch+var_B8]
		mov	ecx, [esi+170h]
		add	ecx, eax
		mov	[esi+170h], ecx

loc_403414:				; CODE XREF: sub_4033B0+4Dj
		lea	ecx, [esp+17Ch+Point]
		push	ecx		; lpPoint
		call	ds:GetCursorPos
		mov	eax, [esi+0Ch]
		lea	edx, [esp+17Ch+Point]
		push	edx		; lpPoint
		push	eax		; hWnd
		call	ds:ScreenToClient
		mov	edx, [esi+0Ch]
		lea	ecx, [esp+17Ch+lParam]
		push	ecx		; lParam
		push	0		; wParam
		push	100Fh		; Msg
		push	edx		; hWnd
		mov	[esp+18Ch+var_158], 0
		call	ds:SendMessageA
		mov	eax, [esp+17Ch+cy]
		mov	ecx, [esp+17Ch+var_170]
		push	1		; cGrow
		push	1		; cInitial
		push	0FFh		; flags
		push	eax		; cy
		push	ecx		; cx
		call	ds:ImageList_Create
		push	5		; nIndex
		mov	edi, eax
		call	ds:GetSysColor
		mov	edx, [esp+17Ch+lParam]
		push	eax		; crMask
		push	edx		; hbmImage
		push	edi		; himl
		call	ds:ImageList_AddMasked
		mov	eax, [esp+17Ch+lParam]
		push	eax		; ho
		call	ds:DeleteObject
		mov	ecx, [esp+17Ch+dyHotspot]
		mov	edx, [esp+17Ch+dxHotspot]
		push	ecx		; dyHotspot
		push	edx		; dxHotspot
		push	0		; iTrack
		push	edi		; himlTrack
		call	ds:ImageList_BeginDrag
		push	edi		; himl
		call	ds:ImageList_Destroy
		mov	eax, [esp+17Ch+Point.y]
		mov	ecx, [esp+17Ch+Point.x]
		mov	edx, [esi+8]
		push	eax		; y
		push	ecx		; x
		push	edx		; hwndLock
		call	ds:ImageList_DragEnter
		pop	edi
		pop	esi
		add	esp, 174h
		retn
sub_4033B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4034C0	proc near		; CODE XREF: sub_4030D0+1E7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+8]
		push	ecx		; hwndLock
		call	ds:ImageList_DragLeave
		jmp	ds:ImageList_EndDrag
sub_4034C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4034E0(UINT uID)
sub_4034E0	proc near		; CODE XREF: sub_4030D0+19Ep

var_14		= word ptr -14h
lParam		= dword	ptr -0Ch
uID		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+20h+uID]
		push	edi
		push	esi
		call	sub_4021A0
		lea	ebp, [esi+174h]
		add	esp, 4
		mov	edi, 1
		lea	edx, [esp+24h+var_14]
		mov	ecx, ebp
		mov	ebx, 3

loc_40350A:				; CODE XREF: sub_4034E0+3Dj
		mov	ax, [ecx]
		test	ax, ax
		mov	[edx], ax
		jz	short loc_403516
		inc	edi

loc_403516:				; CODE XREF: sub_4034E0+33j
		add	ecx, 2
		add	edx, 2
		dec	ebx
		jnz	short loc_40350A
		mov	ecx, [esi+0Ch]
		mov	ebx, ds:SendMessageA
		lea	eax, [esp+24h+lParam]
		push	eax		; lParam
		push	edi		; wParam
		push	101Eh		; Msg
		push	ecx		; hWnd
		call	ebx ; SendMessageA
		test	edi, edi
		jle	short loc_403556
		lea	ecx, [esp+24h+lParam]
		mov	eax, ebp
		mov	edx, edi

loc_403542:				; CODE XREF: sub_4034E0+74j
		mov	edi, [ecx]
		add	eax, 2
		add	ecx, 4
		dec	edx
		mov	di, [esp+edi*2+24h+var_14]
		mov	[eax-2], di
		jnz	short loc_403542

loc_403556:				; CODE XREF: sub_4034E0+58j
		mov	edx, [esi+0Ch]
		push	0		; lParam
		push	1		; wParam
		push	1003h		; Msg
		push	edx		; hWnd
		call	ebx ; SendMessageA
		mov	eax, [esi+0Ch]
		push	0		; lParam
		push	0		; wParam
		push	1019h		; Msg
		push	eax		; hWnd
		call	ebx ; SendMessageA
		mov	ecx, [esi+0Ch]
		mov	edi, ds:InvalidateRect
		push	1		; bErase
		push	0		; lpRect
		push	ecx		; hWnd
		call	edi ; InvalidateRect
		mov	edx, [esi+0Ch]
		push	edx		; hWnd
		call	ds:UpdateWindow
		push	esi		; uID
		call	sub_4043E0
		push	1
		push	0
		push	0
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 14h
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	edi ; InvalidateRect
		push	esi
		call	sub_4021A0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_4034E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4035C0(UINT uID)
sub_4035C0	proc near		; CODE XREF: sub_401D70+74p
					; sub_4030D0+179p

lParam		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
uID		= dword	ptr  4

		sub	esp, 4Ch
		push	ebx
		push	esi
		mov	esi, [esp+54h+uID]
		lea	ecx, [esp+54h+lParam]
		push	edi
		mov	edi, ds:SendMessageA
		mov	edx, [esi+0Ch]
		mov	eax, [esi]
		xor	ebx, ebx
		push	ecx		; lParam
		push	ebx		; wParam
		push	1015h		; Msg
		push	edx		; hWnd
		mov	[esp+68h+lParam], offset loc_4036F0
		mov	[esp+68h+var_48], eax
		mov	[esp+68h+var_44], esi
		mov	[esp+68h+var_3C], ebx
		mov	[esp+68h+var_38], ebx
		mov	[esp+68h+var_30], ebx
		mov	[esp+68h+var_34], ebx
		mov	[esp+68h+var_2C], ebx
		call	edi ; SendMessageA
		mov	eax, [esp+58h+var_3C]
		cmp	eax, ebx
		jz	loc_4036E0
		push	1
		push	esi
		call	sub_402840
		mov	eax, [esp+60h+var_38]
		add	esp, 8
		cmp	eax, ebx
		push	ebx		; lParam
		jz	short loc_403651
		mov	eax, [esi+0Ch]
		push	1		; wParam
		push	1003h		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		push	esi		; uID
		call	sub_4043E0
		push	esi
		call	sub_402270
		push	1
		push	ebx
		push	ebx
		push	esi
		call	sub_404720
		add	esp, 18h
		jmp	short loc_40365C
; ---------------------------------------------------------------------------

loc_403651:				; CODE XREF: sub_4035C0+67j
		push	ebx
		push	ebx
		push	esi
		call	sub_404720
		add	esp, 10h

loc_40365C:				; CODE XREF: sub_4035C0+8Fj
		mov	eax, [esp+58h+var_34]
		cmp	eax, ebx
		mov	eax, [esp+58h+var_2C]
		jz	short loc_403683
		cmp	eax, ebx
		jz	short loc_4036C4
		mov	edx, [esi+0Ch]
		lea	ecx, [esp+58h+var_28]
		push	ecx		; lParam
		push	ebx		; wParam
		push	100Bh		; Msg
		push	edx		; hWnd
		mov	[esp+68h+var_24], eax
		call	edi ; SendMessageA
		jmp	short loc_4036CF
; ---------------------------------------------------------------------------

loc_403683:				; CODE XREF: sub_4035C0+A6j
		cmp	eax, ebx
		jz	short loc_4036C4
		mov	ecx, [esi+0Ch]
		mov	[esp+58h+var_24], eax
		lea	eax, [esp+58h+var_28]
		push	eax		; lParam
		push	1		; wParam
		push	100Bh		; Msg
		push	ecx		; hWnd
		call	edi ; SendMessageA
		mov	eax, [esi+0Ch]
		lea	edx, [esp+58h+var_28]
		push	edx		; lParam
		push	ebx		; wParam
		push	100Dh		; Msg
		push	eax		; hWnd
		mov	[esp+68h+var_1C], 2
		mov	[esp+68h+var_20], ebx
		mov	[esp+68h+var_28], 8
		call	edi ; SendMessageA
		jmp	short loc_4036CF
; ---------------------------------------------------------------------------

loc_4036C4:				; CODE XREF: sub_4035C0+AAj
					; sub_4035C0+C5j
		push	ebx
		push	ebx
		push	esi
		call	sub_402E20
		add	esp, 0Ch

loc_4036CF:				; CODE XREF: sub_4035C0+C1j
					; sub_4035C0+102j
		mov	ecx, [esi+0Ch]
		push	1		; bErase
		push	ebx		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		mov	eax, [esp+58h+var_3C]

loc_4036E0:				; CODE XREF: sub_4035C0+4Fj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 4Ch
		retn
sub_4035C0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_4036F0:				; DATA XREF: sub_4035C0+23o
		push	esi
		mov	esi, [esp+8]
		push	edi
		mov	edi, [esp+10h]
		mov	eax, [esi+18h]
		push	edi
		cmp	eax, 23h
		jz	short loc_40377E
		push	0Dh
		push	esi
		call	sub_403820
		add	esp, 0Ch
		cmp	eax, 6
		jnz	short loc_403772
		mov	eax, [esi+24h]
		shr	eax, 10h
		jz	short loc_403768
		mov	edx, [edi+8]
		xor	ecx, ecx
		mov	cx, [esi+24h]
		push	ecx
		push	eax
		mov	eax, [edx+28h]
		push	eax
		call	PGPDeleteIndItemFromGroup
		mov	eax, [edi+18h]
		add	esp, 0Ch
		test	eax, eax
		mov	dword ptr [edi+10h], 1
		jnz	short loc_403753
		mov	ecx, [edi+8]
		push	esi
		mov	edx, [ecx+0Ch]
		push	edx
		call	sub_403B40
		add	esp, 8
		mov	[edi+20h], eax

loc_403753:				; CODE XREF: .text:0040373Ej
		mov	eax, [edi+8]
		push	esi
		push	0
		push	1001h
		mov	ecx, [eax+0Ch]
		push	ecx
		call	ds:SendMessageA

loc_403768:				; CODE XREF: .text:00403719j
					; .text:00403775j ...
		pop	edi
		mov	eax, 1
		pop	esi
		retn	8
; ---------------------------------------------------------------------------

loc_403772:				; CODE XREF: .text:00403711j
		cmp	eax, 2
		jnz	short loc_403768
		pop	edi
		xor	eax, eax
		pop	esi
		retn	8
; ---------------------------------------------------------------------------

loc_40377E:				; CODE XREF: .text:00403701j
		push	82Bh
		push	esi
		call	sub_403820
		add	esp, 0Ch
		cmp	eax, 6
		jnz	short loc_40380F
		mov	eax, [esi+24h]
		shr	eax, 10h
		jz	short loc_4037B2
		xor	edx, edx
		mov	dx, [esi+24h]
		push	edx
		push	eax
		mov	eax, [edi+8]
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPDeleteIndItemFromGroup
		add	esp, 0Ch
		jmp	short loc_4037CF
; ---------------------------------------------------------------------------

loc_4037B2:				; CODE XREF: .text:00403797j
		mov	eax, [edi+8]
		xor	edx, edx
		mov	dx, [esi+24h]
		mov	ecx, [eax+28h]
		push	edx
		push	ecx
		call	PGPDeleteGroup
		add	esp, 8
		mov	dword ptr [edi+14h], 1

loc_4037CF:				; CODE XREF: .text:004037B0j
		mov	eax, [edi+18h]
		mov	dword ptr [edi+10h], 1
		test	eax, eax
		jnz	short loc_4037F0
		mov	edx, [edi+8]
		push	esi
		mov	eax, [edx+0Ch]
		push	eax
		call	sub_403B40
		add	esp, 8
		mov	[edi+20h], eax

loc_4037F0:				; CODE XREF: .text:004037DBj
		mov	ecx, [edi+8]
		push	esi
		push	0
		push	1001h
		mov	edx, [ecx+0Ch]
		push	edx
		call	ds:SendMessageA
		pop	edi
		mov	eax, 1
		pop	esi
		retn	8
; ---------------------------------------------------------------------------

loc_40380F:				; CODE XREF: .text:0040378Fj
		cmp	eax, 2
		jnz	loc_403768
		pop	edi
		xor	eax, eax
		pop	esi
		retn	8
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403820(int, UINT uID,	LPARAM dwInitParam)
sub_403820	proc near		; CODE XREF: .text:00403706p
					; .text:00403784p

Buffer		= byte ptr -300h
Text		= byte ptr -200h
arg_0		= dword	ptr  4
uID		= dword	ptr  8
dwInitParam	= dword	ptr  0Ch

		sub	esp, 300h
		push	esi
		mov	esi, [esp+304h+dwInitParam]
		mov	eax, [esi+1Ch]
		test	eax, eax
		jz	short loc_403842
		mov	eax, 6
		pop	esi
		add	esp, 300h
		retn
; ---------------------------------------------------------------------------

loc_403842:				; CODE XREF: sub_403820+13j
		mov	ecx, [esp+304h+uID]
		mov	edx, hModule
		push	ebx
		push	edi
		mov	edi, ds:LoadStringA
		lea	eax, [esp+30Ch+Buffer]
		push	100h		; cchBufferMax
		push	eax		; lpBuffer
		push	ecx		; uID
		push	edx		; hInstance
		call	edi ; LoadStringA
		mov	ebx, [esp+30Ch+arg_0]
		lea	ecx, [esp+30Ch+Buffer]
		lea	edx, [esp+30Ch+Text]
		mov	eax, [ebx+10h]
		push	eax
		push	ecx		; LPCSTR
		push	edx		; LPSTR
		call	ds:wsprintfA
		mov	eax, [esi+8]
		push	eax
		call	sub_4030B0
		add	esp, 10h
		test	eax, eax
		jz	short loc_4038DF
		mov	edx, [esi+8]
		lea	ecx, [esp+30Ch+Text]
		mov	[esi+0Ch], ecx
		mov	ecx, hModule
		mov	eax, [edx+8]
		push	esi		; dwInitParam
		push	offset sub_403920 ; lpDialogFunc
		push	eax		; hWndParent
		push	91h		; lpTemplateName
		push	ecx		; hInstance
		call	ds:DialogBoxParamA
		mov	ecx, [esi+18h]
		test	ecx, ecx
		jnz	short loc_403913
		cmp	eax, 7
		jnz	short loc_403913
		mov	dword ptr [esi+18h], 1
		mov	edx, [ebx+4]
		pop	edi
		mov	[esi+20h], edx
		pop	ebx
		pop	esi
		add	esp, 300h
		retn
; ---------------------------------------------------------------------------

loc_4038DF:				; CODE XREF: sub_403820+71j
		mov	ecx, hModule
		lea	eax, [esp+30Ch+Buffer]
		push	100h		; cchBufferMax
		push	eax		; lpBuffer
		push	0Bh		; uID
		push	ecx		; hInstance
		call	edi ; LoadStringA
		mov	ecx, [esi+8]
		lea	edx, [esp+30Ch+Buffer]
		push	2134h		; uType
		push	edx		; lpCaption
		mov	edx, [ecx+8]
		lea	eax, [esp+314h+Text]
		push	eax		; lpText
		push	edx		; hWnd
		call	ds:MessageBoxA

loc_403913:				; CODE XREF: sub_403820+A1j
					; sub_403820+A6j
		pop	edi
		pop	ebx
		pop	esi
		add	esp, 300h
		retn
sub_403820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall sub_403920(HWND, UINT,	WPARAM,	LPARAM)
sub_403920	proc near		; DATA XREF: sub_403820+8Ao

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
dwNewLong	= dword	ptr  10h

		mov	eax, [esp+arg_4]
		push	esi
		add	eax, 0FFFFFFADh	; switch 191 cases
		push	edi
		cmp	eax, 0BEh
		ja	short loc_403991 ; jumptable 00403938 default case
		xor	ecx, ecx
		mov	cl, ds:byte_403A60[eax]
		jmp	ds:off_403A4C[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40393F:				; CODE XREF: sub_403920+18j
					; DATA XREF: .text:off_403A4Co
		mov	esi, [esp+8+dwNewLong] ; jumptable 00403938 case 272
		mov	edi, [esp+8+hWnd]
		push	esi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		mov	edx, [esi+0Ch]
		push	edx		; lpString
		push	40Dh		; nIDDlgItem
		push	edi		; hDlg
		call	ds:SetDlgItemTextA
		pop	edi
		xor	eax, eax
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_403968:				; CODE XREF: sub_403920+18j
					; DATA XREF: .text:off_403A4Co
		mov	eax, [esp+8+hWnd] ; jumptable 00403938 case 83
		push	0FFFFFFEBh	; nIndex
		push	eax		; hWnd
		call	ds:GetWindowLongA
		mov	ecx, [eax+8]
		push	offset dword_42F0A4 ; dwData
		mov	edx, [esp+0Ch+dwNewLong]
		add	ecx, 30h
		push	0Ch		; uCommand
		push	ecx		; lpszHelp
		mov	eax, [edx+0Ch]
		push	eax		; hWndMain
		call	ds:WinHelpA

loc_403991:				; CODE XREF: sub_403920+Ej
					; sub_403920+18j
					; DATA XREF: ...
		pop	edi		; jumptable 00403938 default case
		xor	eax, eax
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_403998:				; CODE XREF: sub_403920+18j
					; DATA XREF: .text:off_403A4Co
		mov	ecx, [esp+8+hWnd] ; jumptable 00403938 case 123
		push	0FFFFFFEBh	; nIndex
		push	ecx		; hWnd
		call	ds:GetWindowLongA
		mov	edx, [eax+8]
		push	offset dword_42F0A4 ; dwData
		mov	eax, [esp+0Ch+arg_8]
		add	edx, 30h
		push	0Ah		; uCommand
		push	edx		; lpszHelp
		push	eax		; hWndMain
		call	ds:WinHelpA
		pop	edi
		xor	eax, eax
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_4039C5:				; CODE XREF: sub_403920+18j
					; DATA XREF: .text:off_403A4Co
		mov	ecx, [esp+8+arg_8] ; jumptable 00403938	case 273
		mov	edi, 1
		and	ecx, 0FFFFh
		lea	eax, [ecx-1]	; switch 7 cases
		cmp	eax, 6
		ja	short loc_403A44 ; jumptable 004039DC default case
		jmp	ds:off_403B20[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4039E3:				; CODE XREF: sub_403920+BCj
					; DATA XREF: .text:off_403B20o
		mov	esi, [esp+8+hWnd] ; jumptable 004039DC case 2
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	2		; nResult
		push	esi		; hDlg
		mov	[eax+18h], edi
		call	ds:EndDialog
		mov	eax, edi
		pop	edi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_403A03:				; CODE XREF: sub_403920+BCj
					; DATA XREF: .text:off_403B20o
		mov	edx, [esp+8+hWnd] ; jumptable 004039DC cases 1,6
		push	6		; nResult
		push	edx		; hDlg
		call	ds:EndDialog
		mov	eax, edi
		pop	edi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_403A17:				; CODE XREF: sub_403920+BCj
					; DATA XREF: .text:off_403B20o
		mov	eax, [esp+8+hWnd] ; jumptable 004039DC case 7
		push	7		; nResult
		push	eax		; hDlg
		call	ds:EndDialog
		mov	eax, edi
		pop	edi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_403A2B:				; CODE XREF: sub_403920+BCj
					; DATA XREF: .text:off_403B20o
		mov	esi, [esp+8+hWnd] ; jumptable 004039DC case 3
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	6		; nResult
		push	esi		; hDlg
		mov	[eax+1Ch], edi
		call	ds:EndDialog

loc_403A44:				; CODE XREF: sub_403920+BAj
					; sub_403920+BCj
					; DATA XREF: ...
		mov	eax, edi	; jumptable 004039DC default case
		pop	edi
		pop	esi
		retn	10h
sub_403920	endp

; ---------------------------------------------------------------------------
		align 4
off_403A4C	dd offset loc_403968, offset loc_403998, offset	loc_40393F
					; DATA XREF: sub_403920+18r
		dd offset loc_4039C5, offset loc_403991	; jump table for switch	statement
byte_403A60	db	0,     4,     4,     4 ; DATA XREF: sub_403920+12r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	1,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     2,     3
		align 10h
off_403B20	dd offset loc_403A03	; DATA XREF: sub_403920+BCr
		dd offset loc_4039E3	; jump table for switch	statement
		dd offset loc_403A2B
		dd offset loc_403A44
		dd offset loc_403A44
		dd offset loc_403A03
		dd offset loc_403A17
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403B40(HWND hWnd, int)
sub_403B40	proc near		; CODE XREF: .text:00403748p
					; .text:004037E5p

lParam		= dword	ptr -28h
wParam		= dword	ptr -24h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 28h
		push	ebx
		mov	ebx, ds:SendMessageA
		push	esi
		mov	esi, [esp+30h+arg_4]
		lea	ecx, [esp+30h+lParam]
		push	edi
		mov	edi, [esp+34h+hWnd]
		mov	eax, [esi+4]
		push	ecx		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	edi		; hWnd
		mov	[esp+44h+wParam], eax
		mov	[esp+44h+lParam], 40h
		call	ebx ; SendMessageA
		mov	eax, [esp+34h+wParam]
		test	eax, eax
		jnz	short loc_403BC1
		mov	edx, [esi+4]
		lea	eax, [esp+34h+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	edi		; hWnd
		mov	[esp+44h+wParam], edx
		mov	[esp+44h+lParam], 100h
		call	ebx ; SendMessageA
		mov	eax, [esp+34h+wParam]
		test	eax, eax
		jnz	short loc_403BC1
		mov	ecx, [esi+4]
		lea	edx, [esp+34h+lParam]
		push	edx		; lParam
		push	eax		; wParam
		push	100Ch		; Msg
		push	edi		; hWnd
		mov	[esp+44h+wParam], ecx
		mov	[esp+44h+lParam], 80h
		call	ebx ; SendMessageA
		mov	eax, [esp+34h+wParam]

loc_403BC1:				; CODE XREF: sub_403B40+38j
					; sub_403B40+5Ej
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
sub_403B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403BD0	proc near		; CODE XREF: sub_4030D0+1DEp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 38h
		push	esi
		mov	esi, [esp+3Ch+arg_0]
		push	edi
		push	esi
		call	sub_4030A0
		mov	ecx, [esi+0Ch]
		mov	edi, ds:SendMessageA
		add	esp, 4
		mov	[esp+40h+var_24], eax
		lea	eax, [esp+40h+lParam]
		mov	[esp+40h+lParam], 6
		push	eax		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	ecx		; hWnd
		call	edi ; SendMessageA
		cmp	[esp+40h+var_10], 23h
		jnz	short loc_403C22
		mov	ecx, [esp+40h+var_4]
		mov	eax, ecx
		shr	eax, 10h
		jnz	short loc_403C2D
		and	ecx, 0FFFFh
		mov	eax, ecx
		jmp	short loc_403C29
; ---------------------------------------------------------------------------

loc_403C22:				; CODE XREF: sub_403BD0+3Bj
		mov	eax, [esp+40h+var_4]
		shr	eax, 10h

loc_403C29:				; CODE XREF: sub_403BD0+50j
		test	eax, eax
		jz	short loc_403C57

loc_403C2D:				; CODE XREF: sub_403BD0+46j
		lea	edx, [esp+40h+var_38]
		mov	[esp+40h+var_30], eax
		mov	eax, [esi+0Ch]
		push	edx		; lParam
		push	0		; wParam
		push	1015h		; Msg
		push	eax		; hWnd
		mov	[esp+50h+var_38], offset loc_403CA0
		mov	[esp+50h+var_34], esi
		mov	[esp+50h+var_2C], 0
		call	edi ; SendMessageA

loc_403C57:				; CODE XREF: sub_403BD0+5Bj
		mov	eax, [esp+40h+var_2C]
		test	eax, eax
		jz	short loc_403C94
		push	esi
		call	sub_402270
		push	1
		push	esi
		call	sub_402840
		push	0
		push	1
		push	0
		push	esi
		call	sub_404720
		mov	ecx, [esi+0Ch]
		add	esp, 1Ch
		push	1		; bErase
		push	0		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		mov	edx, [esi+0Ch]
		push	edx		; hWnd
		call	ds:UpdateWindow

loc_403C94:				; CODE XREF: sub_403BD0+8Dj
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 38h
		retn
sub_403BD0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_403CA0:				; DATA XREF: sub_403BD0+71o
		mov	ecx, [esp+4]
		sub	esp, 40h
		mov	eax, [ecx+18h]
		push	esi
		cmp	eax, 23h
		mov	eax, [ecx+24h]
		jz	short loc_403D10
		shr	eax, 10h
		jz	loc_403D5E
		mov	esi, [esp+4Ch]
		lea	edx, [esp+4]
		push	edx
		xor	edx, edx
		mov	dx, [ecx+24h]
		push	edx
		push	eax
		mov	eax, [esi+4]
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPGetIndGroupItem
		mov	edx, [esi+8]
		mov	ecx, [esi+4]
		mov	dword ptr [esp+18h], 0
		push	edx
		mov	edx, [ecx+28h]
		lea	eax, [esp+18h]
		push	eax
		push	edx
		call	PGPAddItemToGroup
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_403D5E
		mov	dword ptr [esi+0Ch], 1
		mov	eax, 1
		pop	esi
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------

loc_403D10:				; CODE XREF: .text:00403CB1j
		shr	eax, 10h
		jnz	short loc_403D1F
		xor	eax, eax
		mov	ax, [ecx+24h]
		test	eax, eax
		jz	short loc_403D5E

loc_403D1F:				; CODE XREF: .text:00403D13j
		mov	esi, [esp+4Ch]
		mov	ecx, [esi+8]
		cmp	eax, ecx
		jz	short loc_403D5E
		push	ecx
		mov	ecx, [esi+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ecx+28h]
		lea	eax, [esp+8]
		push	eax
		push	edx
		call	PGPAddItemToGroup
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_403D5E
		mov	dword ptr [esi+0Ch], 1

loc_403D5E:				; CODE XREF: .text:00403CB6j
					; .text:00403CFBj ...
		mov	eax, 1
		pop	esi
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403D70	proc near		; CODE XREF: sub_403E90+8Cp

var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
lParam		= dword	ptr -68h
var_64		= dword	ptr -64h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_34		= byte ptr -34h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 74h
		push	esi
		push	edi
		mov	edi, [esp+7Ch+arg_0]
		push	edi
		call	sub_4030A0
		mov	ecx, [edi+0Ch]
		add	esp, 4
		mov	[esp+7Ch+var_64], eax
		lea	eax, [esp+7Ch+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	100Ch		; Msg
		push	ecx		; hWnd
		mov	[esp+8Ch+lParam], 6
		call	ds:SendMessageA
		cmp	[esp+7Ch+var_50], 23h
		jnz	short loc_403DC2
		mov	eax, [esp+7Ch+var_44]
		mov	esi, eax
		shr	esi, 10h
		jnz	short loc_403DD1
		and	eax, 0FFFFh
		mov	esi, eax
		jmp	short loc_403DC9
; ---------------------------------------------------------------------------

loc_403DC2:				; CODE XREF: sub_403D70+3Cj
		mov	esi, [esp+7Ch+var_44]
		shr	esi, 10h

loc_403DC9:				; CODE XREF: sub_403D70+50j
		test	esi, esi
		jz	loc_403E7A

loc_403DD1:				; CODE XREF: sub_403D70+47j
		mov	eax, [esp+7Ch+arg_4]
		lea	edx, [esp+7Ch+var_6C]
		push	edx
		push	1
		push	eax
		call	PGPOrderKeySet
		mov	edx, [esp+88h+var_6C]
		lea	ecx, [esp+88h+var_70]
		push	ecx
		push	edx
		call	PGPNewKeyIter
		mov	ecx, [esp+90h+var_70]
		lea	eax, [esp+90h+var_74]
		push	eax
		push	ecx
		call	PGPKeyIterNext
		mov	eax, [esp+98h+var_74]
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_403E63

loc_403E0E:				; CODE XREF: sub_403D70+F1j
		lea	edx, [esp+7Ch+var_38]
		mov	[esp+7Ch+var_40], 1
		push	edx
		push	14h
		push	eax
		mov	[esp+88h+var_3C], 0
		call	PGPGetKeyNumber
		mov	ecx, [esp+88h+var_74]
		lea	eax, [esp+88h+var_34]
		push	eax
		push	ecx
		call	PGPGetKeyIDFromKey
		mov	eax, [edi+28h]
		lea	edx, [esp+90h+var_40]
		push	esi
		push	edx
		push	eax
		call	PGPAddItemToGroup
		mov	edx, [esp+9Ch+var_70]
		lea	ecx, [esp+9Ch+var_74]
		push	ecx
		push	edx
		call	PGPKeyIterNext
		mov	eax, [esp+0A4h+var_74]
		add	esp, 28h
		test	eax, eax
		jnz	short loc_403E0E

loc_403E63:				; CODE XREF: sub_403D70+9Cj
		mov	eax, [esp+7Ch+var_70]
		push	eax
		call	PGPFreeKeyIter
		mov	ecx, [esp+80h+var_6C]
		push	ecx
		call	PGPFreeKeyList
		add	esp, 8

loc_403E7A:				; CODE XREF: sub_403D70+5Bj
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 74h
		retn
sub_403D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_403E90(int, HGLOBAL hMem)
sub_403E90	proc near		; CODE XREF: sub_401860+67p
					; sub_403FB0+21p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
hMem		= dword	ptr  8

		push	ecx
		mov	eax, [esp+4+hMem]
		push	ebp
		xor	ebp, ebp
		push	esi
		test	eax, eax
		push	edi
		jz	loc_403F9A
		push	eax		; hMem
		call	ds:GlobalLock
		mov	edi, eax
		test	edi, edi
		jz	loc_403F9A
		push	ebx
		push	edi		; lpString
		call	ds:lstrlenA
		mov	esi, [esp+14h+arg_0]
		mov	ebx, eax
		mov	eax, [esi]
		push	eax
		call	PGPOLastOption
		mov	ecx, [esi]
		add	esp, 4
		push	eax
		push	ebx
		push	edi
		push	ecx
		call	PGPOInputBuffer
		add	esp, 0Ch
		lea	edx, [esp+18h+var_4]
		push	eax
		mov	eax, [esi]
		push	edx
		push	eax
		call	PGPImportKeySet
		push	eax
		push	ebp
		call	ds:PGPclErrorBox
		add	esp, 18h
		test	eax, eax
		mov	eax, [esp+14h+var_4]
		pop	ebx
		jz	short loc_403F00
		test	eax, eax
		jnz	short loc_403F56

loc_403F00:				; CODE XREF: sub_403E90+6Aj
		lea	ecx, [esp+10h+arg_0]
		push	ecx
		push	eax
		call	PGPCountKeys
		mov	eax, [esp+18h+arg_0]
		add	esp, 8
		test	eax, eax
		jbe	short loc_403F49
		mov	edx, [esp+10h+var_4]
		push	edx
		push	esi
		call	sub_403D70
		mov	eax, [esi+0Ch]
		add	esp, 8
		push	0		; lParam
		push	1		; wParam
		push	100Bh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		push	0
		push	0
		push	esi
		call	sub_402E20
		add	esp, 0Ch
		mov	ebp, 1

loc_403F49:				; CODE XREF: sub_403E90+84j
		mov	ecx, [esp+10h+var_4]
		push	ecx
		call	PGPFreeKeySet
		add	esp, 4

loc_403F56:				; CODE XREF: sub_403E90+6Ej
		mov	edx, [esp+10h+hMem]
		push	edx		; hMem
		call	ds:GlobalUnlock
		test	ebp, ebp
		jz	short loc_403F9A
		push	esi
		call	sub_402270
		push	1
		push	esi
		call	sub_402840
		push	0
		push	1
		push	0
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 1Ch
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ds:UpdateWindow

loc_403F9A:				; CODE XREF: sub_403E90+Cj
					; sub_403E90+1Dj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_403E90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_403FB0	proc near		; CODE XREF: sub_401D70+63p

arg_0		= dword	ptr  4

		push	esi
		xor	esi, esi
		push	edi
		push	esi		; hWndNewOwner
		call	ds:OpenClipboard
		mov	edi, [esp+8+arg_0]
		test	eax, eax
		jz	short loc_403FE5
		push	1		; uFormat
		call	ds:GetClipboardData
		test	eax, eax
		jz	short loc_403FDB
		push	eax		; hMem
		push	edi		; int
		call	sub_403E90
		add	esp, 8
		mov	esi, eax

loc_403FDB:				; CODE XREF: sub_403FB0+1Dj
		call	ds:CloseClipboard
		test	esi, esi
		jnz	short loc_403FFA

loc_403FE5:				; CODE XREF: sub_403FB0+11j
		mov	eax, [edi+8]
		push	30h		; int
		push	82Fh		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		add	esp, 10h

loc_403FFA:				; CODE XREF: sub_403FB0+33j
		mov	eax, esi
		pop	edi
		pop	esi
		retn
sub_403FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404000	proc near		; CODE XREF: sub_401D70+176p

lParam		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_0]
		lea	eax, [esp+10h+lParam]
		mov	[esp+10h+lParam], offset sub_404050
		mov	ecx, [esi+0Ch]
		push	eax		; lParam
		push	0		; wParam
		push	1015h		; Msg
		push	ecx		; hWnd
		mov	[esp+20h+var_8], esi
		mov	[esp+20h+var_4], 1
		mov	dword ptr [esi+14Ch], 1
		call	ds:SendMessageA
		mov	dword ptr [esi+14Ch], 0
		mov	eax, 1
		pop	esi
		add	esp, 0Ch
		retn
sub_404000	endp


; =============== S U B	R O U T	I N E =======================================


sub_404050	proc near		; DATA XREF: sub_404000+Co

var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		sub	esp, 40h
		cmp	dword ptr [ecx+18h], 23h
		jz	short loc_4040D9
		mov	eax, [ecx+24h]
		shr	eax, 10h
		jz	short loc_4040D1
		lea	edx, [esp+40h+var_40]
		push	esi
		mov	esi, [esp+44h+arg_4]
		push	edx
		xor	edx, edx
		mov	dx, [ecx+24h]
		push	edx
		push	eax
		mov	eax, [esi+4]
		mov	ecx, [eax+28h]
		push	ecx
		call	PGPGetIndGroupItem
		mov	eax, [esp+54h+var_38]
		lea	edx, [esp+54h+arg_0]
		push	edx
		mov	edx, [esi+4]
		push	eax
		lea	ecx, [esp+5Ch+var_34]
		mov	eax, [edx+20h]
		push	ecx
		push	eax
		call	PGPGetKeyByKeyID
		add	esp, 20h
		test	eax, eax
		jnz	short loc_4040C5
		mov	ecx, [esi+8]
		mov	eax, [esi+4]
		mov	edx, [esp+44h+arg_0]
		push	ecx
		mov	ecx, [eax+18h]
		push	edx
		push	ecx
		call	ds:PGPkmSelectKey
		add	esp, 0Ch
		mov	dword ptr [esi+8], 0

loc_4040C5:				; CODE XREF: sub_404050+53j
		mov	eax, 1
		pop	esi
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------

loc_4040D1:				; CODE XREF: sub_404050+13j
		xor	eax, eax
		add	esp, 40h
		retn	8
; ---------------------------------------------------------------------------

loc_4040D9:				; CODE XREF: sub_404050+Bj
		mov	eax, 1
		add	esp, 40h
		retn	8
sub_404050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4040F0(int, HDROP hDrop)
sub_4040F0	proc near		; CODE XREF: sub_401860+AAp
					; sub_401D70+154p

var_298		= dword	ptr -298h
var_294		= dword	ptr -294h
var_290		= tagOFNA ptr -290h
var_244		= byte ptr -244h
szFile		= byte ptr -204h
Buffer		= byte ptr -100h
arg_0		= dword	ptr  4
hDrop		= dword	ptr  8

		sub	esp, 298h
		mov	eax, [esp+298h+hDrop]
		push	ebx
		xor	ebx, ebx
		push	ebp
		push	esi
		cmp	eax, ebx
		push	edi
		mov	[esp+2A8h+var_298], ebx
		jz	loc_4041F7
		lea	ecx, [esp+2A8h+szFile]
		push	104h		; cch
		push	ecx		; lpszFile
		push	ebx		; iFile
		push	eax		; hDrop
		xor	ebp, ebp
		xor	edi, edi
		call	ds:DragQueryFileA
		mov	esi, [esp+2A8h+arg_0]
		test	eax, eax
		jz	loc_4041D5

loc_404137:				; CODE XREF: sub_4040F0+D7j
		mov	ecx, [esi]
		lea	edx, [esp+2A8h+var_294]
		lea	eax, [esp+2A8h+szFile]
		push	edx
		push	eax
		push	ecx
		call	PGPNewFileSpecFromFullPath
		mov	eax, [esp+2B4h+var_294]
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_4041A8
		lea	edx, [esp+2A8h+var_298]
		mov	[esp+2A8h+var_298], ebx
		push	edx
		push	eax
		mov	eax, [esi]
		push	eax
		call	PGPNewGroupSetFromFile
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40418A
		mov	ecx, [esi+28h]
		mov	edx, [esp+2A8h+var_298]
		push	ecx
		push	edx
		call	PGPMergeGroupSets
		add	esp, 8
		test	eax, eax
		jnz	short loc_40418A
		mov	edi, 1

loc_40418A:				; CODE XREF: sub_4040F0+7Ej
					; sub_4040F0+93j
		mov	eax, [esp+2A8h+var_298]
		cmp	eax, ebx
		jz	short loc_40419B
		push	eax
		call	PGPFreeGroupSet
		add	esp, 4

loc_40419B:				; CODE XREF: sub_4040F0+A0j
		mov	eax, [esp+2A8h+var_294]
		push	eax
		call	PGPFreeFileSpec
		add	esp, 4

loc_4041A8:				; CODE XREF: sub_4040F0+65j
		mov	edx, [esp+2A8h+hDrop]
		lea	ecx, [esp+2A8h+szFile]
		inc	ebp
		push	104h		; cch
		push	ecx		; lpszFile
		push	ebp		; iFile
		push	edx		; hDrop
		call	ds:DragQueryFileA
		test	eax, eax
		jnz	loc_404137
		cmp	edi, ebx
		jnz	loc_404391

loc_4041D5:				; CODE XREF: sub_4040F0+41j
		mov	eax, [esi+8]
		push	30h		; int
		push	82Ch		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 298h
		retn
; ---------------------------------------------------------------------------

loc_4041F7:				; CODE XREF: sub_4040F0+19j
		lea	ecx, [esp+2A8h+szFile]
		push	offset byte_430394 ; lpString2
		push	ecx		; lpString1
		call	ds:lstrcpyA
		mov	eax, hModule
		mov	esi, ds:LoadStringA
		lea	edx, [esp+2A8h+Buffer]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	3Fh		; uID
		push	eax		; hInstance
		call	esi ; LoadStringA
		lea	ecx, [esp+2A8h+Buffer]
		push	40h		; int
		push	ecx		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_404255

loc_40423D:				; CODE XREF: sub_4040F0+163j
		lea	edx, [esp+2A8h+Buffer]
		push	40h		; int
		push	edx		; char *
		mov	[eax], bl
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_40423D

loc_404255:				; CODE XREF: sub_4040F0+14Bj
		mov	ecx, hModule
		lea	eax, [esp+2A8h+var_244]
		push	40h		; cchBufferMax
		push	eax		; lpBuffer
		push	9		; uID
		push	ecx		; hInstance
		call	esi ; LoadStringA
		mov	esi, [esp+2A8h+arg_0]
		mov	eax, hModule
		lea	ecx, [esp+2A8h+Buffer]
		mov	[esp+2A8h+var_290.hInstance], eax
		mov	edx, [esi+8]
		mov	[esp+2A8h+var_290.lpstrFilter],	ecx
		mov	[esp+2A8h+var_290.hwndOwner], edx
		lea	ecx, [esp+2A8h+var_290]
		lea	edx, [esp+2A8h+szFile]
		lea	eax, [esp+2A8h+var_244]
		push	ecx		; LPOPENFILENAMEA
		mov	[esp+2ACh+var_290.lStructSize],	4Ch
		mov	[esp+2ACh+var_290.lpstrCustomFilter], ebx
		mov	[esp+2ACh+var_290.nMaxCustFilter], ebx
		mov	[esp+2ACh+var_290.nFilterIndex], 1
		mov	[esp+2ACh+var_290.lpstrFile], edx
		mov	[esp+2ACh+var_290.nMaxFile], 104h
		mov	[esp+2ACh+var_290.lpstrFileTitle], ebx
		mov	[esp+2ACh+var_290.nMaxFileTitle], ebx
		mov	[esp+2ACh+var_290.lpstrInitialDir], ebx
		mov	[esp+2ACh+var_290.lpstrTitle], eax
		mov	[esp+2ACh+var_290.Flags], 0Ch
		mov	[esp+2ACh+var_290.nFileOffset],	bx
		mov	[esp+2ACh+var_290.nFileExtension], bx
		mov	[esp+2ACh+var_290.lpstrDefExt],	offset byte_430394
		mov	[esp+2ACh+var_290.lCustData], ebx
		xor	edi, edi
		call	GetOpenFileNameA
		test	eax, eax
		jz	loc_4043C3
		mov	ecx, [esi]
		lea	edx, [esp+2A8h+var_294]
		lea	eax, [esp+2A8h+szFile]
		push	edx
		push	eax
		push	ecx
		call	PGPNewFileSpecFromFullPath
		mov	eax, [esp+2B4h+var_294]
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_40436F
		lea	edx, [esp+2A8h+var_298]
		mov	[esp+2A8h+var_298], ebx
		push	edx
		push	eax
		mov	eax, [esi]
		push	eax
		call	PGPNewGroupSetFromFile
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40434D
		mov	ecx, [esi+28h]
		mov	edx, [esp+2A8h+var_298]
		push	ecx
		push	edx
		call	PGPMergeGroupSets
		add	esp, 8
		test	eax, eax
		jnz	short loc_40434D
		mov	edi, 1

loc_40434D:				; CODE XREF: sub_4040F0+241j
					; sub_4040F0+256j
		mov	eax, [esp+2A8h+var_298]
		cmp	eax, ebx
		jz	short loc_40435E
		push	eax
		call	PGPFreeGroupSet
		add	esp, 4

loc_40435E:				; CODE XREF: sub_4040F0+263j
		mov	eax, [esp+2A8h+var_294]
		push	eax
		call	PGPFreeFileSpec
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_404391

loc_40436F:				; CODE XREF: sub_4040F0+228j
		mov	ecx, [esi+8]
		push	30h		; int
		push	82Ch		; UINT
		push	3		; uID
		push	ecx		; hWnd
		call	sub_402000
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 298h
		retn
; ---------------------------------------------------------------------------

loc_404391:				; CODE XREF: sub_4040F0+DFj
					; sub_4040F0+27Dj
		push	esi
		call	sub_402270
		push	1
		push	esi
		call	sub_402840
		push	ebx
		push	1
		push	ebx
		push	esi
		call	sub_404720
		mov	edx, [esi+0Ch]
		add	esp, 1Ch
		push	1		; bErase
		push	ebx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		mov	eax, [esi+0Ch]
		push	eax		; hWnd
		call	ds:UpdateWindow

loc_4043C3:				; CODE XREF: sub_4040F0+204j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 298h
		retn
sub_4040F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_4043D0	proc near		; CODE XREF: .text:0040CF5Cp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_4043D9
		retn
; ---------------------------------------------------------------------------

loc_4043D9:				; CODE XREF: sub_4043D0+6j
		mov	eax, [eax+0Ch]
		retn
sub_4043D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4043E0(UINT uID)
sub_4043E0	proc near		; CODE XREF: sub_4034E0+AFp
					; sub_4035C0+77p ...

lParam		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Buffer		= byte ptr -40h
uID		= dword	ptr  4

		sub	esp, 60h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+6Ch+uID]
		xor	ebx, ebx
		push	edi
		mov	eax, [esi+0Ch]
		mov	edi, ds:SendMessageA
		push	ebx		; lParam
		push	ebx		; wParam
		push	1019h		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		lea	ecx, [esp+70h+Buffer]
		lea	eax, [esp+70h+Buffer]
		mov	[esp+70h+var_54], ecx
		mov	ecx, hModule
		xor	edx, edx
		push	40h		; cchBufferMax
		mov	dx, [esi+17Ah]
		push	eax		; lpBuffer
		mov	ebp, 1
		push	826h		; uID
		push	ecx		; hInstance
		mov	[esp+80h+lParam], 0BFh
		mov	[esp+80h+var_4C], ebx
		mov	[esp+80h+var_5C], ebx
		mov	[esp+80h+var_48], ebp
		mov	[esp+80h+var_58], edx
		mov	[esp+80h+var_44], ebx
		call	ds:LoadStringA
		mov	eax, [esi+0Ch]
		lea	edx, [esp+70h+lParam]
		push	edx		; lParam
		push	ebx		; wParam
		push	101Bh		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		lea	ecx, [esi+176h]
		mov	[esp+70h+uID], ecx
		mov	ebx, [esp+70h+uID]

loc_40446A:				; CODE XREF: sub_4043E0+13Cj
		mov	edx, [esp+70h+uID]
		xor	edi, edi
		xor	ecx, ecx
		mov	di, [edx]
		cmp	edi, ecx
		jz	loc_40450D
		mov	eax, edi
		dec	eax
		jz	short loc_40449C
		dec	eax
		jnz	short loc_4044D5
		mov	ebx, 828h
		mov	[esp+70h+var_5C], ecx
		mov	[esp+70h+var_48], 1
		mov	[esp+70h+var_44], ecx
		jmp	short loc_4044D5
; ---------------------------------------------------------------------------

loc_40449C:				; CODE XREF: sub_4043E0+A0j
		mov	eax, [esi+138h]
		push	3
		and	eax, 0FFh
		mov	ebx, 827h
		and	eax, 1
		or	al, 2
		shl	eax, 1
		mov	[esp+74h+var_5C], eax
		call	sub_402080
		add	esp, 4
		mov	[esp+70h+var_50], eax
		mov	[esp+70h+var_48], 2
		mov	[esp+70h+var_44], 0

loc_4044D5:				; CODE XREF: sub_4043E0+A3j
					; sub_4043E0+BAj
		mov	edx, hModule
		lea	ecx, [esp+70h+Buffer]
		push	40h		; cchBufferMax
		push	ecx		; lpBuffer
		push	ebx		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		mov	edx, [esi+0Ch]
		lea	ecx, [esp+70h+lParam]
		xor	eax, eax
		push	ecx		; lParam
		mov	ax, [esi+edi*2+17Ah]
		push	ebp		; wParam
		push	101Bh		; Msg
		push	edx		; hWnd
		mov	[esp+80h+var_58], eax
		call	ds:SendMessageA

loc_40450D:				; CODE XREF: sub_4043E0+97j
		mov	ecx, [esp+70h+uID]
		inc	ebp
		add	ecx, 2
		cmp	ebp, 3
		mov	[esp+70h+uID], ecx
		jl	loc_40446A
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 60h
		retn
sub_4043E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_404530(int, int, HWND	hWndParent, HMENU hMenu, int X,	int Y, int nWidth, int nHeight)
sub_404530	proc near		; CODE XREF: .text:0040CF50p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
hWndParent	= dword	ptr  0Ch
hMenu		= dword	ptr  10h
X		= dword	ptr  14h
Y		= dword	ptr  18h
nWidth		= dword	ptr  1Ch
nHeight		= dword	ptr  20h

		push	ebx
		push	ebp
		push	esi
		push	edi
		call	ds:InitCommonControls
		call	sub_414910
		push	180h		; size_t
		call	sub_401FF0
		mov	esi, eax
		xor	ebx, ebx
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_40455B
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40455B:				; CODE XREF: sub_404530+22j
		mov	ebp, [esp+10h+hMenu]
		mov	ecx, 60h
		xor	eax, eax
		mov	edi, esi
		rep stosd
		mov	edi, [esp+10h+hWndParent]
		lea	eax, [esi+30h]
		push	offset byte_430394 ; lpString2
		push	eax		; lpString1
		mov	[esi+8], edi
		mov	[esi+0Ch], ebx
		mov	[esi+28h], ebx
		mov	[esi+10h], ebp
		mov	[esi+1Ch], ebx
		mov	[esi+2Ch], ebx
		call	ds:lstrcpyA
		mov	ecx, [esp+10h+arg_0]
		mov	edx, [esp+10h+arg_4]
		push	esi
		mov	[esi], ecx
		mov	[esi+4], edx
		mov	[esi+138h], ebx
		mov	[esi+13Ch], ebx
		mov	[esi+148h], ebx
		mov	[esi+14Ch], ebx
		mov	[esi+150h], ebx
		mov	[esi+154h], ebx
		mov	[esi+158h], ebx
		mov	[esi+15Ch], ebx
		mov	[esi+160h], ebx
		mov	dword ptr [esi+168h], 1
		call	sub_4020A0
		mov	eax, hModule
		mov	ecx, [esp+14h+nHeight]
		mov	edx, [esp+14h+nWidth]
		add	esp, 4
		push	ebx		; lpParam
		push	eax		; hInstance
		mov	eax, [esp+18h+Y]
		push	ebp		; hMenu
		push	edi		; hWndParent
		push	ecx		; nHeight
		mov	ecx, [esp+24h+X]
		push	edx		; nWidth
		push	eax		; Y
		push	ecx		; X
		push	508300DBh	; dwStyle
		push	offset byte_430394 ; lpWindowName
		push	offset aTreelistctrl32 ; "TreeListCtrl32"
		push	200h		; dwExStyle
		call	ds:CreateWindowExA
		cmp	eax, ebx
		mov	[esi+0Ch], eax
		jnz	short loc_40462A
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_40462A:				; CODE XREF: sub_404530+F1j
		push	ebx		; hWnd
		call	ds:GetDC
		mov	edi, eax
		push	0Eh		; index
		push	edi		; hdc
		call	ds:GetDeviceCaps
		push	0Ch		; index
		push	edi		; hdc
		mov	ebp, eax
		call	ds:GetDeviceCaps
		imul	ebp, eax
		push	edi		; hDC
		push	ebx		; hWnd
		call	ds:ReleaseDC
		cmp	ebp, 8
		push	ebx		; cGrow
		push	2Fh		; cInitial
		jg	short loc_404689
		push	1		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	[esi+1Ch], eax
		mov	edx, hModule
		push	0CFh		; lpBitmapName
		push	edx		; hInstance
		call	ds:LoadBitmapA
		mov	edi, eax
		mov	eax, [esi+1Ch]
		push	0FF00FFh
		push	edi
		push	eax
		jmp	short loc_4046B6
; ---------------------------------------------------------------------------

loc_404689:				; CODE XREF: sub_404530+128j
		push	19h		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	[esi+1Ch], eax
		mov	ecx, hModule
		push	0D0h		; lpBitmapName
		push	ecx		; hInstance
		call	ds:LoadBitmapA
		mov	edx, [esi+1Ch]
		mov	edi, eax
		push	0FF00FFh	; crMask
		push	edi		; hbmImage
		push	edx		; himl

loc_4046B6:				; CODE XREF: sub_404530+157j
		call	ds:ImageList_AddMasked
		push	edi		; ho
		call	ds:DeleteObject
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+0Ch]
		push	eax		; lParam
		push	ebx		; wParam
		push	1009h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		push	ebx
		push	ebx
		push	esi
		call	sub_402E20
		mov	edx, [esi+8]
		push	esi
		push	edx
		call	sub_401930
		add	esp, 14h
		mov	[esi+2Ch], eax
		push	1		; fLastUnlockReleases
		push	1		; fLock
		push	eax		; pUnk
		call	ds:CoLockObjectExternal
		mov	eax, [esi+2Ch]
		mov	ecx, [esi+0Ch]
		push	eax		; pDropTarget
		push	ecx		; hwnd
		call	ds:RegisterDragDrop
		mov	edx, [esi+2Ch]
		push	ebx
		push	edx
		call	sub_401970
		add	esp, 8
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_404530	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404720	proc near		; CODE XREF: sub_402770+60p
					; sub_402D60+86p ...

var_30		= dword	ptr -30h
hCursor		= dword	ptr -2Ch
lParam		= dword	ptr -28h
var_24		= dword	ptr -24h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 30h
		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+3Ch+arg_0]
		mov	ebx, 0FFFF0001h
		mov	ebp, 1
		mov	eax, [edi+28h]
		test	eax, eax
		jz	loc_4047F9
		push	esi
		push	7F02h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ds:SetCursor
		mov	ecx, [edi+28h]
		mov	[esp+40h+hCursor], eax
		lea	eax, [esp+40h+arg_0]
		push	eax
		push	ecx
		call	PGPCountGroupsInSet
		mov	eax, [esp+48h+arg_0]
		add	esp, 8
		xor	esi, esi
		test	eax, eax
		jle	short loc_4047B2

loc_404773:				; CODE XREF: sub_404720+90j
		mov	eax, [edi+28h]
		lea	edx, [esp+40h+var_30]
		push	edx
		push	esi
		push	eax
		call	PGPGetIndGroupID
		mov	ecx, [esp+4Ch+arg_8]
		mov	edx, [esp+4Ch+arg_C]
		mov	eax, [esp+4Ch+arg_4]
		push	ebx
		push	0
		push	ebp
		push	ecx
		mov	ecx, [esp+5Ch+var_30]
		push	edx
		push	eax
		push	0
		push	ecx
		push	edi
		call	sub_404810
		add	esp, 30h
		mov	ebx, eax
		mov	eax, [esp+40h+arg_0]
		xor	ebp, ebp
		inc	esi
		cmp	esi, eax
		jl	short loc_404773

loc_4047B2:				; CODE XREF: sub_404720+51j
		mov	edx, [esp+40h+hCursor]
		push	edx		; hCursor
		call	ds:SetCursor
		mov	eax, [esp+40h+arg_8]
		pop	esi
		test	eax, eax
		jz	short loc_4047ED
		push	edi
		call	sub_4030A0
		add	esp, 4
		mov	[esp+3Ch+var_24], eax
		test	eax, eax
		jz	short loc_4047ED
		mov	ecx, [edi+0Ch]
		lea	eax, [esp+3Ch+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	101Ch		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA

loc_4047ED:				; CODE XREF: sub_404720+A4j
					; sub_404720+B5j
		pop	edi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_4047F9:				; CODE XREF: sub_404720+19j
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 30h
		retn
sub_404720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404810	proc near		; CODE XREF: sub_404720+7Dp
					; sub_404810+3C5p

var_298		= dword	ptr -298h
var_294		= dword	ptr -294h
var_290		= dword	ptr -290h
var_28C		= dword	ptr -28Ch
var_288		= dword	ptr -288h
var_284		= dword	ptr -284h
var_280		= dword	ptr -280h
var_27C		= dword	ptr -27Ch
var_278		= byte ptr -278h
var_274		= byte ptr -274h
var_270		= dword	ptr -270h
var_26C		= dword	ptr -26Ch
var_268		= dword	ptr -268h
var_264		= byte ptr -264h
lParam		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_208		= byte ptr -208h
String		= byte ptr -204h
var_1C4		= byte ptr -1C4h
var_184		= dword	ptr -184h
Buffer		= byte ptr -180h
String2		= byte ptr -80h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 298h
		mov	eax, [esp+298h+arg_18]
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		cmp	eax, esi
		mov	[esp+2A8h+var_290], esi
		mov	[esp+2A8h+var_28C], 0FFFF0001h
		jz	short loc_404839
		mov	dword_430398, esi

loc_404839:				; CODE XREF: sub_404810+21j
		mov	ebp, [esp+2A8h+arg_1C]
		cmp	ebp, esi
		jz	short loc_40488C
		mov	edx, [esp+2A8h+arg_8]
		mov	eax, [esp+2A8h+arg_4]
		mov	edi, [esp+2A8h+arg_0]
		lea	ecx, [esp+2A8h+var_270]
		push	ecx
		push	edx
		mov	[esp+2B0h+var_298], eax
		push	eax
		mov	eax, [edi+28h]
		push	eax
		call	PGPGetIndGroupItem
		mov	ebx, [esp+2B8h+var_268]
		mov	edx, [edi+28h]
		lea	ecx, [esp+2B8h+var_208]
		push	ecx
		push	ebx
		push	edx
		call	PGPGetGroupInfo
		mov	eax, [esp+2C4h+var_26C]
		add	esp, 1Ch
		jmp	short loc_4048B6
; ---------------------------------------------------------------------------

loc_40488C:				; CODE XREF: sub_404810+32j
		mov	edi, [esp+2A8h+arg_0]
		mov	ebx, [esp+2A8h+arg_4]
		lea	eax, [esp+2A8h+var_208]
		mov	ecx, [edi+28h]
		push	eax
		push	ebx
		push	ecx
		call	PGPGetGroupInfo
		mov	eax, [esp+2B4h+var_184]
		add	esp, 0Ch

loc_4048B6:				; CODE XREF: sub_404810+7Aj
		test	eax, eax
		jnz	short loc_4048D2
		mov	ecx, [esp+2A8h+arg_14]
		mov	[esp+2A8h+var_290], 1
		test	ecx, ecx
		jz	short loc_4048D2
		mov	esi, 2

loc_4048D2:				; CODE XREF: sub_404810+A8j
					; sub_404810+BBj
		mov	ecx, [esp+2A8h+arg_10]
		test	ecx, ecx
		jz	short loc_4048DF
		xor	eax, eax

loc_4048DF:				; CODE XREF: sub_404810+CBj
		test	ebp, ebp
		jz	short loc_404945
		mov	edx, [esp+2A8h+var_298]
		mov	ecx, [esp+2A8h+arg_8]
		and	edx, 0FFFFh
		and	ecx, 0FFFFh
		shl	edx, 10h
		or	edx, ecx
		lea	ecx, [esp+2A8h+String]
		push	edx		; int
		mov	edx, [esp+2ACh+arg_20]
		push	esi		; int
		push	23h		; int
		push	edx		; int
		push	ecx		; lpString
		push	ebp		; int
		mov	ebp, [esp+2C0h+arg_C]
		push	eax		; int
		push	ebp		; int
		push	edi		; int
		call	sub_404CA0
		mov	edx, [esp+2CCh+arg_8]
		mov	ecx, [edi+28h]
		mov	esi, eax
		mov	eax, [esp+2CCh+var_298]
		push	esi
		push	edx
		push	eax
		push	ecx
		mov	[esp+2DCh+var_294], esi
		call	PGPSetIndGroupItemUserValue
		add	esp, 34h
		jmp	short loc_404988
; ---------------------------------------------------------------------------

loc_404945:				; CODE XREF: sub_404810+D1j
		mov	ecx, [esp+2A8h+arg_20]
		mov	edx, ebx
		mov	ebp, [esp+2A8h+arg_C]
		and	edx, 0FFFFh
		push	edx		; int
		push	esi		; int
		push	23h		; int
		lea	edx, [esp+2B4h+String]
		push	ecx		; int
		push	edx		; lpString
		push	0		; int
		push	eax		; int
		push	ebp		; int
		push	edi		; int
		call	sub_404CA0
		mov	[esp+2CCh+var_294], eax
		push	eax
		mov	eax, [edi+28h]
		push	ebx
		push	eax
		call	PGPSetGroupUserValue
		mov	esi, [esp+2D8h+var_294]
		add	esp, 30h

loc_404988:				; CODE XREF: sub_404810+133j
		test	ebp, ebp
		jnz	loc_404C84
		lea	ecx, [esp+2A8h+var_1C4]
		push	ecx
		push	ebx
		push	esi
		push	edi
		call	sub_404D60
		mov	eax, [esp+2B8h+arg_1C]
		add	esp, 10h
		test	eax, eax
		jnz	loc_404C84
		mov	ecx, [edi+28h]
		lea	edx, [esp+2A8h+var_280]
		lea	eax, [esp+2A8h+var_278]
		push	edx
		push	eax
		push	ebp
		push	ebx
		push	ecx
		call	PGPCountGroupItems
		mov	eax, [esp+2BCh+var_280]
		add	esp, 14h
		test	eax, eax
		jle	loc_404BF4

loc_4049D6:				; CODE XREF: sub_404810+3DEj
		mov	eax, [edi+28h]
		lea	edx, [esp+2A8h+var_270]
		push	edx
		push	ebp
		push	ebx
		push	eax
		call	PGPGetIndGroupItem
		mov	eax, [esp+2B8h+var_270]
		add	esp, 10h
		cmp	eax, 1
		jnz	loc_404BB8
		mov	edx, [esp+2A8h+var_268]
		lea	ecx, [esp+2A8h+var_288]
		push	ecx
		mov	ecx, [edi+20h]
		lea	eax, [esp+2ACh+var_264]
		push	edx
		push	eax
		push	ecx
		call	PGPGetKeyByKeyID
		add	esp, 10h
		test	eax, eax
		jnz	loc_404AEB
		mov	ecx, [esp+2A8h+var_288]
		test	ecx, ecx
		jz	loc_404AEB
		mov	[esp+2A8h+var_284], eax
		mov	eax, [esp+2A8h+var_26C]
		test	eax, eax
		mov	[esp+2A8h+var_298], eax
		jnz	short loc_404A3D
		mov	[esp+2A8h+var_290], 1

loc_404A3D:				; CODE XREF: sub_404810+223j
		lea	edx, [esp+2A8h+var_274]
		lea	eax, [esp+2A8h+Buffer]
		push	edx
		push	eax
		push	100h
		push	ecx
		call	PGPGetPrimaryUserIDNameBuffer
		mov	eax, [esp+2B8h+arg_10]
		add	esp, 10h
		test	eax, eax
		jz	short loc_404A6B
		mov	[esp+2A8h+var_298], 0

loc_404A6B:				; CODE XREF: sub_404810+251j
		mov	edx, [esp+2A8h+var_288]
		lea	ecx, [esp+2A8h+var_27C]
		push	ecx
		push	edx
		call	sub_404FA0
		mov	ecx, [esp+2B0h+var_27C]
		add	esp, 8
		test	ecx, ecx
		jz	short loc_404A8D
		mov	[esp+2A8h+var_284], 10h

loc_404A8D:				; CODE XREF: sub_404810+273j
		mov	ecx, ebx
		mov	edx, ebp
		and	ecx, 0FFFFh
		and	edx, 0FFFFh
		shl	ecx, 10h
		or	ecx, edx
		mov	edx, [esp+2A8h+var_28C]
		push	ecx		; int
		mov	ecx, [esp+2ACh+var_284]
		push	ecx		; int
		mov	ecx, [esp+2B0h+var_298]
		push	eax		; int
		lea	eax, [esp+2B4h+Buffer]
		push	edx		; int
		push	eax		; lpString
		push	esi		; int
		push	ecx		; int
		push	0		; int
		push	edi		; int
		call	sub_404CA0
		mov	edx, [edi+28h]
		mov	esi, eax
		push	esi
		push	ebp
		push	ebx
		push	edx
		call	PGPSetIndGroupItemUserValue
		mov	eax, [esp+2DCh+var_288]
		push	offset byte_430394
		push	eax
		push	esi
		push	edi
		call	sub_404E80
		add	esp, 44h
		jmp	loc_404BDF
; ---------------------------------------------------------------------------

loc_404AEB:				; CODE XREF: sub_404810+203j
					; sub_404810+20Fj
		mov	eax, [esp+2A8h+var_26C]
		test	eax, eax
		mov	[esp+2A8h+var_298], eax
		jnz	short loc_404AFF
		mov	[esp+2A8h+var_290], 1

loc_404AFF:				; CODE XREF: sub_404810+2E5j
		mov	eax, [esp+2A8h+arg_10]
		test	eax, eax
		jz	short loc_404B12
		mov	[esp+2A8h+var_298], 0

loc_404B12:				; CODE XREF: sub_404810+2F8j
		mov	esi, [esp+2A8h+var_268]
		mov	edx, hModule
		dec	esi
		lea	ecx, [esp+2A8h+Buffer]
		neg	esi
		sbb	esi, esi
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		and	esi, 9
		push	82Ah		; uID
		push	edx		; hInstance
		add	esi, 7
		call	ds:LoadStringA
		lea	eax, [esp+2A8h+String2]
		lea	ecx, [esp+2A8h+var_264]
		push	eax
		push	2
		push	ecx
		call	PGPGetKeyIDString
		add	esp, 0Ch
		lea	edx, [esp+2A8h+String2]
		lea	eax, [esp+2A8h+Buffer]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcatA
		mov	ecx, ebx
		mov	eax, [esp+2A8h+var_28C]
		and	ecx, 0FFFFh
		mov	edx, ebp
		shl	ecx, 10h
		and	edx, 0FFFFh
		or	ecx, edx
		mov	edx, [esp+2A8h+var_294]
		push	ecx		; int
		push	10h		; int
		push	esi		; int
		lea	ecx, [esp+2B4h+Buffer]
		push	eax		; int
		mov	eax, [esp+2B8h+var_298]
		push	ecx		; lpString
		push	edx		; int
		push	eax		; int
		push	0		; int
		push	edi		; int
		call	sub_404CA0
		mov	ecx, [edi+28h]
		mov	esi, eax
		push	esi
		push	ebp
		push	ebx
		push	ecx
		call	PGPSetIndGroupItemUserValue
		add	esp, 34h
		jmp	short loc_404BDF
; ---------------------------------------------------------------------------

loc_404BB8:				; CODE XREF: sub_404810+1E0j
		mov	edx, [esp+2A8h+var_28C]
		mov	eax, [esp+2A8h+arg_14]
		mov	ecx, [esp+2A8h+arg_10]
		push	edx
		push	esi
		push	0
		push	eax
		push	ecx
		push	0
		push	ebp
		push	ebx
		push	edi
		call	sub_404810
		add	esp, 24h
		mov	esi, eax

loc_404BDF:				; CODE XREF: sub_404810+2D6j
					; sub_404810+3A6j
		mov	eax, [esp+2A8h+var_280]
		inc	ebp
		mov	[esp+2A8h+var_28C], esi
		mov	esi, [esp+2A8h+var_294]
		cmp	ebp, eax
		jl	loc_4049D6

loc_404BF4:				; CODE XREF: sub_404810+1C0j
		mov	eax, [esp+2A8h+arg_14]
		test	eax, eax
		jz	loc_404C84
		mov	eax, [esp+2A8h+var_290]
		test	eax, eax
		jz	short loc_404C84
		mov	eax, dword_430398
		mov	[esp+2A8h+var_22C], esi
		test	eax, eax
		jnz	short loc_404C59
		mov	eax, [edi+0Ch]
		mov	ebx, ds:SendMessageA
		lea	edx, [esp+2A8h+lParam]
		push	edx		; lParam
		push	1		; wParam
		push	100Bh		; Msg
		push	eax		; hWnd
		call	ebx ; SendMessageA
		mov	edx, [edi+0Ch]
		lea	ecx, [esp+2A8h+lParam]
		push	ecx		; lParam
		push	5		; wParam
		push	1002h		; Msg
		push	edx		; hWnd
		call	ebx ; SendMessageA
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		mov	dword_430398, 1
		pop	ebx
		add	esp, 298h
		retn
; ---------------------------------------------------------------------------

loc_404C59:				; CODE XREF: sub_404810+406j
		push	1
		push	edi
		call	sub_4030A0
		add	esp, 4
		push	eax
		push	edi
		call	sub_402E20
		mov	ecx, [edi+0Ch]
		add	esp, 0Ch
		lea	eax, [esp+2A8h+lParam]
		push	eax		; lParam
		push	5		; wParam
		push	1002h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA

loc_404C84:				; CODE XREF: sub_404810+17Aj
					; sub_404810+19Cj ...
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 298h
		retn
sub_404810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_404CA0(int, int, int,	int, LPCSTR lpString, int, int,	int, int)
sub_404CA0	proc near		; CODE XREF: sub_404810+10Ep
					; sub_404810+15Dp ...

lParam		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
lpString	= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 58h
		mov	eax, [esp+58h+arg_1C]
		push	esi
		mov	esi, [esp+5Ch+arg_8]
		mov	ecx, eax
		mov	[esp+5Ch+var_50], eax
		mov	eax, [esp+5Ch+lpString]
		or	ecx, 18h
		push	eax		; lpString
		mov	[esp+60h+var_54], esi
		mov	[esp+60h+lParam], 0Fh
		mov	[esp+60h+var_4C], ecx
		mov	[esp+60h+var_48], eax
		call	ds:lstrlenA
		mov	edx, [esp+5Ch+arg_20]
		mov	[esp+5Ch+var_44], eax
		mov	eax, [esp+5Ch+arg_18]
		mov	[esp+5Ch+var_34], edx
		mov	[esp+5Ch+var_40], eax
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [esp+5Ch+arg_4]
		test	eax, eax
		jnz	short loc_404D1C
		test	esi, esi
		jz	short loc_404D1C
		mov	ecx, [esp+5Ch+arg_0]
		lea	eax, [esp+5Ch+lParam]
		push	eax		; lParam
		push	0		; wParam
		mov	edx, [ecx+0Ch]
		push	100Dh		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		mov	eax, esi
		pop	esi
		add	esp, 58h
		retn
; ---------------------------------------------------------------------------

loc_404D1C:				; CODE XREF: sub_404CA0+55j
					; sub_404CA0+59j
		mov	eax, [esp+5Ch+arg_14]
		push	edi
		mov	ecx, 0Ah
		lea	esi, [esp+60h+lParam]
		lea	edi, [esp+60h+var_28]
		lea	edx, [esp+60h+var_30]
		rep movsd
		mov	ecx, [esp+60h+arg_C]
		mov	[esp+60h+var_2C], eax
		mov	eax, [esp+60h+arg_0]
		mov	[esp+60h+var_30], ecx
		push	edx		; lParam
		push	0		; wParam
		mov	ecx, [eax+0Ch]
		push	1000h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		add	esp, 58h
		retn
sub_404CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404D60	proc near		; CODE XREF: sub_404810+18Bp

lParam		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 20h
		mov	eax, [esp+20h+arg_4]
		push	ebx
		mov	ebx, ds:SendMessageA
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_0]
		push	edi
		mov	[esp+30h+var_14], eax
		mov	[esp+30h+var_18], 80h
		mov	edi, 1
		lea	ebp, [esi+176h]

loc_404D8C:				; CODE XREF: sub_404D60+107j
		xor	ecx, ecx
		mov	cx, [ebp+0]
		test	ecx, ecx
		jz	loc_404E60
		dec	ecx
		jz	short loc_404DC1
		dec	ecx
		jnz	loc_404E4A
		mov	eax, [esp+30h+arg_C]
		mov	[esp+30h+var_1C], 80h
		mov	[esp+30h+lParam], 9
		mov	[esp+30h+var_C], eax
		jmp	loc_404E4A
; ---------------------------------------------------------------------------

loc_404DC1:				; CODE XREF: sub_404D60+3Bj
		mov	eax, [esi+20h]
		lea	ecx, [esp+30h+arg_0]
		lea	edx, [esp+30h+arg_4]
		push	ecx
		mov	ecx, [esp+34h+arg_8]
		push	edx
		mov	edx, [esi+28h]
		push	eax
		push	ecx
		push	edx
		mov	[esp+44h+var_C], 0
		call	PGPGetGroupLowestValidity
		mov	eax, [esp+44h+arg_0]
		add	esp, 14h
		test	eax, eax
		jle	short loc_404DF4
		xor	eax, eax
		jmp	short loc_404E01
; ---------------------------------------------------------------------------

loc_404DF4:				; CODE XREF: sub_404D60+8Ej
		mov	eax, [esp+30h+arg_4]
		push	eax
		call	sub_402080
		add	esp, 4

loc_404E01:				; CODE XREF: sub_404D60+92j
		mov	cl, [esi+138h]
		mov	[esp+30h+arg_4], eax
		test	cl, 1
		mov	[esp+30h+var_1C], 80h
		mov	[esp+30h+lParam], 28h
		jz	short loc_404E46
		cmp	eax, 2
		jle	short loc_404E2F
		mov	[esp+30h+var_4], 4
		jmp	short loc_404E4A
; ---------------------------------------------------------------------------

loc_404E2F:				; CODE XREF: sub_404D60+C3j
		mov	edx, [esi+168h]
		xor	ecx, ecx
		cmp	eax, edx
		setl	cl
		dec	ecx
		and	ecx, 2
		mov	[esp+30h+var_4], ecx
		jmp	short loc_404E4A
; ---------------------------------------------------------------------------

loc_404E46:				; CODE XREF: sub_404D60+BEj
		mov	[esp+30h+var_4], eax

loc_404E4A:				; CODE XREF: sub_404D60+3Ej
					; sub_404D60+5Cj ...
		mov	eax, [esi+0Ch]
		lea	edx, [esp+30h+lParam]
		push	edx		; lParam
		push	0		; wParam
		push	1007h		; Msg
		push	eax		; hWnd
		mov	[esp+40h+var_10], edi
		call	ebx ; SendMessageA

loc_404E60:				; CODE XREF: sub_404D60+34j
		inc	edi
		add	ebp, 2
		cmp	edi, 3
		jl	loc_404D8C
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_404D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404E80	proc near		; CODE XREF: sub_404810+2CEp

lParam		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 20h
		mov	eax, [esp+20h+arg_4]
		push	ebx
		mov	ebx, ds:SendMessageA
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_0]
		push	edi
		mov	[esp+30h+var_14], eax
		mov	[esp+30h+var_18], 80h
		mov	edi, 1
		lea	ebp, [esi+176h]

loc_404EAC:				; CODE XREF: sub_404E80+111j
		xor	ecx, ecx
		mov	cx, [ebp+0]
		test	ecx, ecx
		jz	loc_404F8A
		dec	ecx
		jz	short loc_404EE1
		dec	ecx
		jnz	loc_404F74
		mov	eax, [esp+30h+arg_C]
		mov	[esp+30h+var_1C], 80h
		mov	[esp+30h+lParam], 9
		mov	[esp+30h+var_C], eax
		jmp	loc_404F74
; ---------------------------------------------------------------------------

loc_404EE1:				; CODE XREF: sub_404E80+3Bj
		mov	edx, [esp+30h+arg_8]
		lea	ecx, [esp+30h+arg_0]
		push	ecx
		push	edx
		call	PGPGetPrimaryUserIDValidity
		mov	eax, [esp+38h+arg_0]
		push	eax
		call	sub_402080
		mov	edx, [esp+3Ch+arg_8]
		lea	ecx, [esp+3Ch+arg_4]
		push	ecx
		push	3Dh
		push	edx
		mov	[esp+48h+arg_0], eax
		call	PGPGetKeyBoolean
		mov	al, byte ptr [esp+48h+arg_4]
		add	esp, 18h
		test	al, al
		jz	short loc_404F2B
		push	3
		call	sub_402080
		add	esp, 4
		inc	eax
		mov	[esp+30h+arg_0], eax
		jmp	short loc_404F2F
; ---------------------------------------------------------------------------

loc_404F2B:				; CODE XREF: sub_404E80+98j
		mov	eax, [esp+30h+arg_0]

loc_404F2F:				; CODE XREF: sub_404E80+A9j
		mov	cl, [esi+138h]
		mov	[esp+30h+var_1C], 80h
		test	cl, 1
		mov	[esp+30h+lParam], 28h
		jz	short loc_404F70
		cmp	eax, 2
		jle	short loc_404F59
		mov	[esp+30h+var_4], 4
		jmp	short loc_404F74
; ---------------------------------------------------------------------------

loc_404F59:				; CODE XREF: sub_404E80+CDj
		mov	edx, [esi+168h]
		xor	ecx, ecx
		cmp	eax, edx
		setl	cl
		dec	ecx
		and	ecx, 2
		mov	[esp+30h+var_4], ecx
		jmp	short loc_404F74
; ---------------------------------------------------------------------------

loc_404F70:				; CODE XREF: sub_404E80+C8j
		mov	[esp+30h+var_4], eax

loc_404F74:				; CODE XREF: sub_404E80+3Ej
					; sub_404E80+5Cj ...
		mov	eax, [esi+0Ch]
		lea	edx, [esp+30h+lParam]
		push	edx		; lParam
		push	0		; wParam
		push	1007h		; Msg
		push	eax		; hWnd
		mov	[esp+40h+var_10], edi
		call	ebx ; SendMessageA

loc_404F8A:				; CODE XREF: sub_404E80+34j
		inc	edi
		add	ebp, 2
		cmp	edi, 3
		jl	loc_404EAC
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_404E80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_404FA0	proc near		; CODE XREF: sub_404810+265p

var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		lea	eax, [esp+8+var_8]
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	eax
		push	3Eh
		push	esi
		call	PGPGetKeyBoolean
		lea	ecx, [esp+1Ch+var_7]
		push	ecx
		push	3Ch
		push	esi
		call	PGPGetKeyBoolean
		lea	edx, [esp+28h+var_5]
		push	edx
		push	3Fh
		push	esi
		call	PGPGetKeyBoolean
		lea	eax, [esp+34h+arg_0]
		push	eax
		push	41h
		push	esi
		call	PGPGetKeyBoolean
		lea	ecx, [esp+40h+var_6]
		push	ecx
		push	4Ah
		push	esi
		call	PGPGetKeyBoolean
		lea	edx, [esp+4Ch+var_4]
		push	edx
		push	14h
		push	esi
		call	PGPGetKeyNumber
		mov	eax, [esp+58h+var_4]
		mov	bl, [esp+58h+var_5]
		add	esp, 48h
		cmp	eax, 1
		mov	al, [esp+10h+var_7]
		jnz	short loc_40507A
		mov	cl, [esp+10h+var_8]
		test	al, al
		jz	short loc_405054
		test	cl, cl
		jz	short loc_405021
		mov	eax, 0Ch
		jmp	loc_4050DB
; ---------------------------------------------------------------------------

loc_405021:				; CODE XREF: sub_404FA0+75j
		mov	al, byte ptr [esp+10h+arg_0]
		test	al, al
		jz	short loc_405033
		mov	eax, 0Dh
		jmp	loc_4050DB
; ---------------------------------------------------------------------------

loc_405033:				; CODE XREF: sub_404FA0+87j
		test	bl, bl
		jz	short loc_405041
		mov	eax, 0Bh
		jmp	loc_4050DB
; ---------------------------------------------------------------------------

loc_405041:				; CODE XREF: sub_404FA0+95j
		mov	al, [esp+10h+var_6]
		neg	al
		sbb	eax, eax
		and	eax, 4
		add	eax, 0Ah
		jmp	loc_4050DB
; ---------------------------------------------------------------------------

loc_405054:				; CODE XREF: sub_404FA0+71j
		test	cl, cl
		jz	short loc_40505F
		mov	eax, 8
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_40505F:				; CODE XREF: sub_404FA0+B6j
		mov	al, byte ptr [esp+10h+arg_0]
		test	al, al
		jz	short loc_40506E
		mov	eax, 9
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_40506E:				; CODE XREF: sub_404FA0+C5j
		xor	eax, eax
		test	bl, bl
		setnz	al
		add	eax, 6
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_40507A:				; CODE XREF: sub_404FA0+69j
		mov	cl, [esp+10h+var_8]
		test	al, al
		jz	short loc_4050B7
		test	cl, cl
		jz	short loc_40508D
		mov	eax, 15h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_40508D:				; CODE XREF: sub_404FA0+E4j
		mov	al, byte ptr [esp+10h+arg_0]
		test	al, al
		jz	short loc_40509C
		mov	eax, 16h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_40509C:				; CODE XREF: sub_404FA0+F3j
		test	bl, bl
		jz	short loc_4050A7
		mov	eax, 14h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_4050A7:				; CODE XREF: sub_404FA0+FEj
		mov	al, [esp+10h+var_6]
		neg	al
		sbb	eax, eax
		and	eax, 4
		add	eax, 13h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_4050B7:				; CODE XREF: sub_404FA0+E0j
		test	cl, cl
		jz	short loc_4050C2
		mov	eax, 11h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_4050C2:				; CODE XREF: sub_404FA0+119j
		mov	al, byte ptr [esp+10h+arg_0]
		test	al, al
		jz	short loc_4050D1
		mov	eax, 12h
		jmp	short loc_4050DB
; ---------------------------------------------------------------------------

loc_4050D1:				; CODE XREF: sub_404FA0+128j
		xor	eax, eax
		test	bl, bl
		setnz	al
		add	eax, 0Fh

loc_4050DB:				; CODE XREF: sub_404FA0+7Cj
					; sub_404FA0+8Ej ...
		mov	edx, [esp+10h+arg_4]
		test	edx, edx
		jz	short loc_405104
		test	cl, cl
		jnz	short loc_4050FD
		mov	cl, byte ptr [esp+10h+arg_0]
		test	cl, cl
		jnz	short loc_4050FD
		test	bl, bl
		jnz	short loc_4050FD
		xor	ecx, ecx
		pop	esi
		mov	[edx], ecx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4050FD:				; CODE XREF: sub_404FA0+145j
					; sub_404FA0+14Dj ...
		mov	ecx, 1
		mov	[edx], ecx

loc_405104:				; CODE XREF: sub_404FA0+141j
		pop	esi
		pop	ebx
		add	esp, 8
		retn
sub_404FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405110	proc near		; CODE XREF: .text:0040D522p
					; .text:0040D549p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_405120
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_405120:				; CODE XREF: sub_405110+7j
		mov	eax, [esi+0Ch]
		push	eax		; hwnd
		call	ds:RevokeDragDrop
		mov	ecx, [esi+2Ch]
		push	ecx
		call	sub_401960
		mov	edx, [esi+2Ch]
		add	esp, 4
		push	1		; fLastUnlockReleases
		push	0		; fLock
		push	edx		; pUnk
		call	ds:CoLockObjectExternal
		mov	eax, [esi+24h]
		push	eax
		call	ds:PGPclCloseGroupFile
		push	esi
		call	sub_4021A0
		mov	ecx, [esi+0Ch]
		add	esp, 8
		push	0		; lParam
		push	0		; wParam
		push	10h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		mov	edx, [esi+1Ch]
		push	edx		; himl
		call	ds:ImageList_Destroy
		xor	eax, eax
		pop	esi
		retn
sub_405110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405180	proc near		; CODE XREF: sub_401800+31p

Points		= tagPOINT ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_4]
		mov	ecx, [esp+8+arg_8]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	[esp+0Ch+Points.x], eax
		lea	edx, [esp+0Ch+Points]
		mov	eax, [esi+0Ch]
		push	1		; cPoints
		push	edx		; lpPoints
		push	eax		; hWndTo
		push	0		; hWndFrom
		mov	[esp+1Ch+Points.y], ecx
		call	ds:MapWindowPoints
		mov	ecx, [esp+0Ch+Points.y]
		mov	edx, [esp+0Ch+Points.x]
		mov	eax, [esi+0Ch]
		and	ecx, 0FFFFh
		shl	ecx, 10h
		and	edx, 0FFFFh
		or	ecx, edx
		push	ecx		; lParam
		push	0		; wParam
		push	100Eh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	esi
		add	esp, 8
		retn
sub_405180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4051E0(UINT uID)
sub_4051E0	proc near		; CODE XREF: sub_4028D0+142p
					; sub_40C1A0+122p ...

uID		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+uID]
		test	esi, esi
		jnz	short loc_4051F0
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4051F0:				; CODE XREF: sub_4051E0+7j
		mov	eax, [esi+28h]
		test	eax, eax
		jz	short loc_40522B
		push	0
		push	0
		push	esi
		call	sub_402E20
		mov	eax, [esi+0Ch]
		add	esp, 0Ch
		push	0		; lParam
		push	1		; wParam
		push	1003h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	ecx, [esi+24h]
		push	ecx
		call	ds:PGPclCloseGroupFile
		add	esp, 4
		mov	dword ptr [esi+28h], 0

loc_40522B:				; CODE XREF: sub_4051E0+15j
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_40526F
		mov	edx, [esi]
		push	edi
		lea	edi, [esi+24h]
		push	edi
		push	edx
		call	ds:PGPclOpenGroupFile
		mov	eax, [edi]
		push	esi		; uID
		mov	ecx, [eax+4]
		mov	[esi+28h], ecx
		call	sub_4043E0
		push	esi
		call	sub_402270
		push	1
		push	0
		push	0
		push	esi
		call	sub_404720
		mov	edx, [esi+2Ch]
		push	1
		push	edx
		call	sub_401970
		add	esp, 28h
		pop	edi

loc_40526F:				; CODE XREF: sub_4051E0+50j
		mov	eax, [esi+0Ch]
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ds:UpdateWindow
		xor	eax, eax
		pop	esi
		retn
sub_4051E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405290	proc near		; CODE XREF: .text:0040F112p
					; .text:0040F877p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_4052A0
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4052A0:				; CODE XREF: sub_405290+7j
		mov	eax, [esi+28h]
		test	eax, eax
		jnz	short loc_4052AE
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4052AE:				; CODE XREF: sub_405290+15j
		push	esi
		call	sub_402270
		push	0
		push	1
		push	0
		push	esi
		call	sub_404720
		mov	eax, [esi+0Ch]
		add	esp, 14h
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	ecx, [esi+0Ch]
		push	ecx		; hWnd
		call	ds:UpdateWindow
		xor	eax, eax
		pop	esi
		retn
sub_405290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4052E0	proc near		; CODE XREF: sub_405330+2Ap

Buffer		= byte ptr -104h
arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	esp, 104h
		push	esi
		lea	esi, [eax+30h]
		push	104h
		push	esi
		call	ds:PGPclGetPGPPath
		mov	edx, hModule
		add	esp, 8
		lea	ecx, [esp+108h+Buffer]
		push	104h		; cchBufferMax
		push	ecx		; lpBuffer
		push	44h		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+108h+Buffer]
		push	eax		; lpString2
		push	esi		; lpString1
		call	ds:lstrcatA
		pop	esi
		add	esp, 104h
		retn
sub_4052E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405330	proc near		; CODE XREF: sub_40C1A0+116p
					; .text:0040D2B2p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_405340
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_405340:				; CODE XREF: sub_405330+7j
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_405359
		push	eax		; lpString2
		lea	eax, [esi+30h]
		push	eax		; lpString1
		call	ds:lstrcpyA
		jmp	short loc_405362
; ---------------------------------------------------------------------------

loc_405359:				; CODE XREF: sub_405330+1Aj
		push	esi
		call	sub_4052E0
		add	esp, 4

loc_405362:				; CODE XREF: sub_405330+27j
		mov	ecx, [edi]
		mov	[esi+18h], ecx
		mov	edx, [edi+4]
		mov	[esi+20h], edx
		mov	eax, [edi+0Ch]
		mov	[esi+138h], eax
		mov	ecx, [edi+14h]
		mov	[esi+14h], ecx
		mov	cl, [esi+138h]
		mov	eax, 2
		pop	edi
		test	al, cl
		jz	short loc_405396
		mov	[esi+168h], eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_405396:				; CODE XREF: sub_405330+5Aj
		mov	dword ptr [esi+168h], 1
		xor	eax, eax
		pop	esi
		retn
sub_405330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4053B0	proc near		; CODE XREF: sub_405510+6p

VersionInformation= _OSVERSIONINFOA ptr	-94h

		sub	esp, 94h
		lea	eax, [esp+94h+VersionInformation]
		mov	[esp+94h+VersionInformation.dwOSVersionInfoSize], 94h
		push	eax		; lpVersionInformation
		call	ds:GetVersionExA
		mov	eax, [esp+94h+VersionInformation.dwPlatformId]
		sub	eax, 0
		jz	short loc_40540B
		dec	eax
		jz	short loc_4053DF
		dec	eax
		jnz	short loc_40540B
		cmp	[esp+94h+VersionInformation.dwMajorVersion], 4
		jb	short loc_4053EB

loc_4053DF:				; CODE XREF: sub_4053B0+23j
		mov	eax, 1
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_4053EB:				; CODE XREF: sub_4053B0+2Dj
		push	30h		; uType
		push	offset Caption	; "PGPkeys Warning"
		push	offset Text	; "PGPkeys is not supported on Windows NT "...
		push	0		; hWnd
		call	ds:MessageBoxA
		mov	eax, 1
		add	esp, 94h
		retn
; ---------------------------------------------------------------------------

loc_40540B:				; CODE XREF: sub_4053B0+20j
					; sub_4053B0+26j
		xor	eax, eax
		add	esp, 94h
		retn
sub_4053B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405420(LPCSTR	lpName,	LPCSTR lpClassName, LPCSTR lpWindowName)
sub_405420	proc near		; CODE XREF: sub_405510+25p

lParam		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpName		= dword	ptr  4
lpClassName	= dword	ptr  8
lpWindowName	= dword	ptr  0Ch

		mov	eax, [esp+lpName]
		sub	esp, 0Ch
		push	esi
		push	eax		; lpName
		push	1		; lMaximumCount
		push	0		; lInitialCount
		push	0		; lpSemaphoreAttributes
		call	ds:CreateSemaphoreA
		mov	esi, eax
		test	esi, esi
		jz	short loc_4054B8
		call	ds:GetLastError
		cmp	eax, 0B7h
		jnz	short loc_4054B8
		push	esi		; hObject
		call	ds:CloseHandle
		mov	ecx, [esp+10h+lpWindowName]
		mov	edx, [esp+10h+lpClassName]
		push	ecx		; lpWindowName
		push	edx		; lpClassName
		call	ds:FindWindowA
		mov	esi, eax
		test	esi, esi
		jz	short loc_4054AE
		push	esi		; hWnd
		call	ds:IsZoomed
		test	eax, eax
		jnz	short loc_405479
		push	9		; nCmdShow
		push	esi		; hWnd
		call	ds:ShowWindow

loc_405479:				; CODE XREF: sub_405420+4Ej
		push	esi		; hWnd
		call	ds:SetForegroundWindow
		mov	[esp+10h+lParam], 40001h
		call	ds:GetCommandLineA
		push	eax		; lpString
		mov	[esp+14h+var_4], eax
		call	ds:lstrlenA
		inc	eax
		mov	[esp+10h+var_8], eax
		lea	eax, [esp+10h+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	4Ah		; Msg
		push	esi		; hWnd
		call	ds:SendMessageA

loc_4054AE:				; CODE XREF: sub_405420+43j
		mov	eax, 1
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_4054B8:				; CODE XREF: sub_405420+19j
					; sub_405420+26j
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
sub_405420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4054C0	proc near		; CODE XREF: WinMain(x,x,x,x)+163p

Buffer		= byte ptr -80h

		sub	esp, 80h
		push	104h
		push	offset szHelp
		call	ds:PGPclGetPGPPath
		mov	ecx, hModule
		add	esp, 8
		lea	eax, [esp+80h+Buffer]
		push	80h		; cchBufferMax
		push	eax		; lpBuffer
		push	44h		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		lea	edx, [esp+80h+Buffer]
		push	edx		; lpString2
		push	offset szHelp	; lpString1
		call	ds:lstrcatA
		add	esp, 80h
		retn
sub_4054C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405510(HINSTANCE hInstance, int)
sub_405510	proc near		; CODE XREF: WinMain(x,x,x,x)+44p

WndClass	= WNDCLASSA ptr	-28h
hInstance	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 28h
		push	ebx
		push	esi
		push	edi
		call	sub_4053B0
		test	eax, eax
		jnz	short loc_405526
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_405526:				; CODE XREF: sub_405510+Dj
		push	offset WindowName ; "PGPkeys"
		push	offset ClassName ; "PGPkeysMainWinClass"
		push	offset Name	; "PGPkeysInstSem"
		call	sub_405420
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_40554A
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_40554A:				; CODE XREF: sub_405510+2Fj
		mov	edi, [esp+34h+hInstance]
		mov	esi, ds:RegisterWindowMessageA
		push	offset String	; "PGPM_RELOADKEYRING"
		mov	hModule, edi
		call	esi ; RegisterWindowMessageA
		push	offset aPgpm_reloadpre ; "PGPM_RELOADPREFS"
		mov	Msg, eax
		call	esi ; RegisterWindowMessageA
		push	offset aPgpm_reloadk_0 ; "PGPM_RELOADKEYSERVERPREFS"
		mov	dword_4303A8, eax
		call	esi ; RegisterWindowMessageA
		push	offset aPgpm_purgepass ; "PGPM_PURGEPASSPHRASECACHE"
		mov	dword_4303AC, eax
		call	esi ; RegisterWindowMessageA
		push	offset aMswheel_rollms ; "MSWHEEL_ROLLMSG"
		mov	dword_4303B0, eax
		call	esi ; RegisterWindowMessageA
		push	offset dword_430850
		push	3002010h
		mov	dword_4303B4, eax
		call	PGPNewContext
		xor	ebx, ebx
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_4055E4
		cmp	eax, 0FFFFD139h
		jnz	short loc_4055D0
		push	10h		; int
		push	852h		; UINT
		push	3		; uID
		push	ebx		; hWnd
		call	sub_402000
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_4055D0:				; CODE XREF: sub_405510+A3j
		push	eax
		push	ebx
		call	ds:PGPclErrorBox
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_4055E4:				; CODE XREF: sub_405510+9Cj
		mov	eax, dword_430850
		push	offset dword_4303B8
		push	eax
		call	PGPNewTLSContext
		mov	esi, ds:PGPclErrorBox
		push	eax
		push	ebx
		call	esi ; PGPclErrorBox
		mov	ecx, dword_430850
		push	ecx
		call	ds:PGPclInitLibrary
		add	esp, 14h
		cmp	eax, ebx
		jz	short loc_40562F
		cmp	eax, 0FFFFCED0h
		jnz	short loc_40561F
		cmp	[esp+34h+arg_4], ebx
		jnz	short loc_40562F

loc_40561F:				; CODE XREF: sub_405510+107j
		push	eax
		push	ebx
		call	esi ; PGPclErrorBox
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_40562F:				; CODE XREF: sub_405510+100j
					; sub_405510+10Dj
		push	85h		; lpIconName
		push	edi		; hInstance
		mov	[esp+3Ch+WndClass.style], ebx
		mov	[esp+3Ch+WndClass.lpfnWndProc],	offset loc_40CDF0
		mov	[esp+3Ch+WndClass.cbClsExtra], ebx
		mov	[esp+3Ch+WndClass.cbWndExtra], ebx
		mov	[esp+3Ch+WndClass.hInstance], edi
		call	ds:LoadIconA
		push	7F00h		; lpCursorName
		push	ebx		; hInstance
		mov	[esp+3Ch+WndClass.hIcon], eax
		call	ds:LoadCursorA
		lea	edx, [esp+34h+WndClass]
		mov	[esp+34h+WndClass.hCursor], eax
		push	edx		; lpWndClass
		mov	[esp+38h+WndClass.hbrBackground], 10h
		mov	[esp+38h+WndClass.lpszMenuName], ebx
		mov	[esp+38h+WndClass.lpszClassName], offset ClassName ; "PGPkeysMainWinClass"
		call	ds:RegisterClassA
		pop	edi
		pop	esi
		and	eax, 0FFFFh
		pop	ebx
		add	esp, 28h
		retn
sub_405510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LRESULT __stdcall fn(int code, WPARAM	wParam,	LPARAM lParam)
fn		proc near		; DATA XREF: WinMain(x,x,x,x)+65o

code		= dword	ptr  4
wParam		= dword	ptr  8
lParam		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+code]
		test	esi, esi
		jl	short loc_4056AE
		call	PGPGlobalRandomPoolMouseMoved

loc_4056AE:				; CODE XREF: fn+7j
		mov	eax, [esp+4+lParam]
		mov	ecx, [esp+4+wParam]
		mov	edx, hhk
		push	eax		; lParam
		push	ecx		; wParam
		push	esi		; nCode
		push	edx		; hhk
		call	ds:CallNextHookEx
		pop	esi
		retn	0Ch
fn		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LRESULT __stdcall sub_4056D0(int code, WPARAM	wParam,	LPARAM lParam)
sub_4056D0	proc near		; DATA XREF: WinMain(x,x,x,x)+78o

code		= dword	ptr  4
wParam		= dword	ptr  8
lParam		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+code]
		push	edi
		mov	edi, [esp+8+wParam]
		test	esi, esi
		jl	short loc_4056E7
		push	edi
		call	PGPGlobalRandomPoolAddKeystroke
		add	esp, 4

loc_4056E7:				; CODE XREF: sub_4056D0+Cj
		mov	eax, [esp+8+lParam]
		mov	ecx, dword_43039C
		push	eax		; lParam
		push	edi		; wParam
		push	esi		; nCode
		push	ecx		; hhk
		call	ds:CallNextHookEx
		pop	edi
		pop	esi
		retn	0Ch
sub_4056D0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405700(BOOL bEnable)
sub_405700	proc near		; CODE XREF: .text:0040D4C5p

bEnable		= dword	ptr  4

		push	esi
		mov	esi, dword_4303C4
		test	esi, esi
		jz	short loc_405726
		push	ebx
		mov	ebx, ds:EnableWindow
		push	edi
		mov	edi, [esp+0Ch+bEnable]

loc_405717:				; CODE XREF: sub_405700+22j
		mov	eax, [esi]
		push	edi		; bEnable
		push	eax		; hWnd
		call	ebx ; EnableWindow
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_405717
		pop	edi
		pop	ebx

loc_405726:				; CODE XREF: sub_405700+9j
		pop	esi
		retn
sub_405700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405730	proc near		; CODE XREF: .text:0040D08Bp
					; .text:0040D5D0p
					; DATA XREF: ...

Rect		= tagRECT ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		sub	esp, 10h
		test	eax, eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		jz	short loc_405768
		mov	ecx, [esp+20h+arg_4]
		push	eax
		test	ecx, ecx
		jz	short loc_405758
		call	sub_4057D0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_405758:				; CODE XREF: sub_405730+16j
		call	sub_405800
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_405768:				; CODE XREF: sub_405730+Dj
		mov	eax, [esp+20h+arg_C]
		test	eax, eax
		jz	short loc_4057C7
		mov	edi, [esp+20h+arg_8]
		mov	dword ptr [eax], 0
		test	edi, edi
		jz	short loc_4057C7
		mov	esi, dword_4303C4
		test	esi, esi
		jz	short loc_4057C7
		mov	ebx, ds:GetWindowRect
		mov	ebp, ds:PtInRect

loc_405794:				; CODE XREF: sub_405730+85j
		mov	ecx, [esi]
		lea	eax, [esp+20h+Rect]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ebx ; GetWindowRect
		mov	edx, [edi+4]
		mov	eax, [edi]
		push	edx
		lea	ecx, [esp+24h+Rect]
		push	eax		; pt
		push	ecx		; lprc
		call	ebp ; PtInRect
		test	eax, eax
		jnz	short loc_4057BF
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_405794
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_4057BF:				; CODE XREF: sub_405730+7Ej
		mov	eax, [esp+20h+arg_C]
		mov	edx, [esi]
		mov	[eax], edx

loc_4057C7:				; CODE XREF: sub_405730+3Ej
					; sub_405730+4Cj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_405730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4057D0	proc near		; CODE XREF: sub_405730+18p

arg_0		= dword	ptr  4

		push	8		; size_t
		call	sub_40BEF0
		add	esp, 4
		test	eax, eax
		jz	short locret_4057F2
		mov	ecx, [esp+arg_0]
		mov	[eax], ecx
		mov	edx, dword_4303C4
		mov	[eax+4], edx
		mov	dword_4303C4, eax

locret_4057F2:				; CODE XREF: sub_4057D0+Cj
		retn
sub_4057D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405800	proc near		; CODE XREF: sub_405730:loc_405758p

arg_0		= dword	ptr  4

		mov	ecx, dword_4303C4
		push	esi
		test	ecx, ecx
		jz	short loc_40584B
		mov	edx, [esp+4+arg_0]
		mov	esi, [ecx]
		cmp	esi, edx
		mov	eax, ecx
		jnz	short loc_405822
		mov	ecx, [ecx+4]
		mov	dword_4303C4, ecx
		jmp	short loc_40583E
; ---------------------------------------------------------------------------

loc_405822:				; CODE XREF: sub_405800+15j
		mov	eax, [ecx+4]
		test	eax, eax
		jz	short loc_40584B

loc_405829:				; CODE XREF: sub_405800+34j
		cmp	[eax], edx
		jz	short loc_405838
		mov	ecx, eax
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_405829
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_405838:				; CODE XREF: sub_405800+2Bj
		mov	edx, [eax+4]
		mov	[ecx+4], edx

loc_40583E:				; CODE XREF: sub_405800+20j
		test	eax, eax
		jz	short loc_40584B
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4

loc_40584B:				; CODE XREF: sub_405800+9j
					; sub_405800+27j ...
		pop	esi
		retn
sub_405800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
_WinMain@16	proc near		; CODE XREF: start+DBp

var_54		= dword	ptr -54h
nHeight		= dword	ptr -50h
nWidth		= dword	ptr -4Ch
Y		= dword	ptr -48h
X		= dword	ptr -44h
var_40		= byte ptr -40h
Msg		= tagMSG ptr -3Ch
Buffer		= byte ptr -20h
hInstance	= dword	ptr  4
hPrevInstance	= dword	ptr  8
lpCmdLine	= dword	ptr  0Ch
nShowCmd	= dword	ptr  10h

		sub	esp, 54h
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	sub_40C0F0
		push	0		; pvReserved
		call	ds:OleInitialize
		mov	ebp, ds:LoadStringA
		lea	eax, [esp+64h+Buffer]
		mov	esi, [esp+64h+hInstance]
		push	20h		; cchBufferMax
		push	eax		; lpBuffer
		push	84Ch		; uID
		push	esi		; hInstance
		call	ebp ; LoadStringA
		lea	ecx, [esp+64h+Buffer]
		mov	edx, [esp+64h+lpCmdLine]
		push	ecx		; char *
		push	edx		; char *
		call	_strstr
		neg	eax
		sbb	eax, eax
		neg	eax
		push	eax		; int
		push	esi		; hInstance
		call	sub_405510
		add	esp, 10h
		test	eax, eax
		jz	loc_405B26
		mov	edi, ds:GetCurrentThreadId
		call	edi ; GetCurrentThreadId
		mov	ebx, ds:SetWindowsHookExA
		push	eax		; dwThreadId
		push	0		; hmod
		push	offset fn	; lpfn
		push	7		; idHook
		call	ebx ; SetWindowsHookExA
		mov	hhk, eax
		call	edi ; GetCurrentThreadId
		push	eax		; dwThreadId
		push	0		; hmod
		push	offset sub_4056D0 ; lpfn
		push	2		; idHook
		call	ebx ; SetWindowsHookExA
		mov	ecx, hhk
		mov	dword_43039C, eax
		test	ecx, ecx
		jz	loc_405B26
		test	eax, eax
		jz	loc_405B26
		push	0
		call	ds:PGPclIsExpired
		add	esp, 4
		test	eax, eax
		jnz	loc_405B26
		lea	eax, [esp+64h+Buffer]
		push	20h		; cchBufferMax
		push	eax		; lpBuffer
		push	57h		; uID
		push	esi		; hInstance
		call	ebp ; LoadStringA
		lea	ecx, [esp+64h+Buffer]
		mov	edx, [esp+64h+lpCmdLine]
		push	ecx		; char *
		push	edx		; char *
		call	_strstr
		add	esp, 8
		test	eax, eax
		jnz	short loc_405936
		push	9C4h
		push	eax
		mov	eax, dword_430850
		push	eax
		call	ds:PGPclSplash
		add	esp, 0Ch

loc_405936:				; CODE XREF: WinMain(x,x,x,x)+CFj
		mov	edx, dword_430850
		lea	ecx, [esp+64h+var_54]
		push	ecx
		push	edx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	eax, [esp+6Ch+var_54]
		push	offset byte_4303BC
		push	0Bh
		push	eax
		call	sub_41B3D0
		mov	ecx, [esp+78h+var_54]
		push	offset byte_4303BD
		push	0Ah
		push	ecx
		call	sub_41B3D0
		push	offset dword_430964
		push	offset dword_43084C
		lea	edx, [esp+8Ch+nHeight]
		push	offset dword_430854
		lea	eax, [esp+90h+nWidth]
		push	edx
		lea	ecx, [esp+94h+Y]
		push	eax
		lea	edx, [esp+98h+X]
		push	ecx
		lea	eax, [esp+9Ch+var_40]
		push	edx
		push	eax
		call	sub_40BF30
		mov	ecx, [esp+0A4h+var_54]
		add	esp, 40h
		push	0
		push	ecx
		call	ds:PGPclCloseClientPrefs
		add	esp, 8
		call	sub_4054C0
		push	70h		; lpMenuName
		push	esi		; hInstance
		call	ds:LoadMenuA
		push	0		; lpParam
		push	esi		; hInstance
		mov	edx, [esp+6Ch+nHeight]
		mov	ecx, [esp+6Ch+Y]
		push	eax		; hMenu
		mov	eax, [esp+70h+nWidth]
		push	0		; hWndParent
		push	edx		; nHeight
		mov	edx, [esp+78h+X]
		push	eax		; nWidth
		push	ecx		; Y
		push	edx		; X
		push	0CF0000h	; dwStyle
		push	offset WindowName ; "PGPkeys"
		push	offset ClassName ; "PGPkeysMainWinClass"
		push	0		; dwExStyle
		call	ds:CreateWindowExA
		test	eax, eax
		mov	hWnd, eax
		jz	loc_405B26
		mov	ecx, [esp+64h+nShowCmd]
		push	ecx		; nCmdShow
		push	eax		; hWnd
		call	ds:ShowWindow
		mov	edx, hWnd
		push	edx		; hWnd
		call	ds:UpdateWindow
		mov	eax, hModule
		mov	esi, ds:LoadAcceleratorsA
		push	80h		; lpTableName
		push	eax		; hInstance
		call	esi ; LoadAcceleratorsA
		mov	ecx, hModule
		push	0E2h		; lpTableName
		push	ecx		; hInstance
		mov	ebx, eax
		call	esi ; LoadAcceleratorsA
		push	0		; wMsgFilterMax
		push	0		; wMsgFilterMin
		lea	edx, [esp+6Ch+Msg]
		push	0		; hWnd
		push	edx		; lpMsg
		mov	ebp, eax
		call	ds:GetMessageA
		test	eax, eax
		jz	short loc_405AC7
		mov	edi, ds:TranslateAcceleratorA

loc_405A58:				; CODE XREF: WinMain(x,x,x,x)+275j
		mov	esi, dword_4303C4
		test	esi, esi
		jz	short loc_405A89

loc_405A62:				; CODE XREF: WinMain(x,x,x,x)+237j
		mov	eax, [esi]
		mov	ecx, hWnd
		cmp	eax, ecx
		jz	short loc_405A82
		lea	ecx, [esp+64h+Msg]
		push	ecx		; lpMsg
		push	eax		; hDlg
		call	ds:IsDialogMessageA
		test	eax, eax
		jnz	loc_405B19

loc_405A82:				; CODE XREF: WinMain(x,x,x,x)+21Cj
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_405A62

loc_405A89:				; CODE XREF: WinMain(x,x,x,x)+210j
		mov	edx, hWnd
		lea	ecx, [esp+64h+Msg]
		push	ecx		; lpMsg
		push	ebx		; hAccTable
		push	edx		; hWnd
		call	edi ; TranslateAcceleratorA
		test	eax, eax
		jnz	short loc_405AB2
		lea	eax, [esp+64h+Msg]
		push	eax		; lpMsg
		call	ds:TranslateMessage
		lea	ecx, [esp+64h+Msg]
		push	ecx		; lpMsg
		call	ds:DispatchMessageA

loc_405AB2:				; CODE XREF: WinMain(x,x,x,x)+24Aj
					; WinMain(x,x,x,x)+2D4j
		push	0		; wMsgFilterMax
		push	0		; wMsgFilterMin
		lea	edx, [esp+6Ch+Msg]
		push	0		; hWnd
		push	edx		; lpMsg
		call	ds:GetMessageA
		test	eax, eax
		jnz	short loc_405A58

loc_405AC7:				; CODE XREF: WinMain(x,x,x,x)+200j
		call	ds:PGPclCloseLibrary
		mov	eax, dword_4303B8
		test	eax, eax
		jz	short loc_405ADF
		push	eax
		call	PGPFreeTLSContext
		add	esp, 4

loc_405ADF:				; CODE XREF: WinMain(x,x,x,x)+284j
		mov	eax, dword_430850
		push	eax
		call	PGPFreeContext
		add	esp, 4
		call	ds:OleUninitialize
		mov	ecx, dword_43039C
		mov	esi, ds:UnhookWindowsHookEx
		push	ecx		; hhk
		call	esi ; UnhookWindowsHookEx
		mov	edx, hhk
		push	edx		; hhk
		call	esi ; UnhookWindowsHookEx
		pop	edi
		pop	esi
		mov	eax, [esp+5Ch+Msg.wParam]
		pop	ebp
		pop	ebx
		add	esp, 54h
		retn	10h
; ---------------------------------------------------------------------------

loc_405B19:				; CODE XREF: WinMain(x,x,x,x)+22Cj
		mov	eax, [esi]
		lea	edx, [esp+64h+Msg]
		push	edx		; lpMsg
		push	ebp		; hAccTable
		push	eax		; hWnd
		call	edi ; TranslateAcceleratorA
		jmp	short loc_405AB2
; ---------------------------------------------------------------------------

loc_405B26:				; CODE XREF: WinMain(x,x,x,x)+4Ej
					; WinMain(x,x,x,x)+8Ej	...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 54h
		retn	10h
_WinMain@16	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405B40(HWND hWnd, int)
sub_405B40	proc near		; CODE XREF: .text:0040E5F3p
					; .text:0040E96Ep

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	0
		call	ds:PGPclSetSplashParent
		mov	esi, [esp+8+hWnd]
		add	esp, 4
		push	0		; bEnable
		push	esi		; hWnd
		call	ds:EnableWindow
		mov	eax, [esp+4+arg_4]
		push	esi		; hWnd
		mov	dword_430400, 0
		mov	dword_4303DC, eax
		call	sub_405B80
		add	esp, 4
		pop	esi
		retn
sub_405B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405B80(HWND hWnd)
sub_405B80	proc near		; CODE XREF: sub_405B40+2Dp

var_380		= dword	ptr -380h
var_37C		= PROPSHEETHEADERA ptr -37Ch
var_348		= dword	ptr -348h
var_344		= dword	ptr -344h
ho		= dword	ptr -340h
var_33C		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
var_330		= dword	ptr -330h
lpString	= dword	ptr -32Ch
lParam		= dword	ptr -2DCh
var_2D4		= dword	ptr -2D4h
wParam		= dword	ptr -2ACh
var_2A8		= byte ptr -2A8h
var_2A4		= byte ptr -2A4h
var_29C		= dword	ptr -29Ch
var_290		= dword	ptr -290h
var_274		= dword	ptr -274h
var_268		= dword	ptr -268h
var_24C		= dword	ptr -24Ch
var_240		= dword	ptr -240h
var_224		= dword	ptr -224h
var_218		= dword	ptr -218h
var_1FC		= dword	ptr -1FCh
var_1F0		= dword	ptr -1F0h
var_1D4		= dword	ptr -1D4h
var_1C8		= dword	ptr -1C8h
var_1AC		= dword	ptr -1ACh
var_1A0		= dword	ptr -1A0h
var_184		= dword	ptr -184h
var_178		= dword	ptr -178h
var_15C		= dword	ptr -15Ch
var_150		= dword	ptr -150h
var_134		= dword	ptr -134h
var_128		= dword	ptr -128h
var_10C		= dword	ptr -10Ch
var_100		= dword	ptr -100h
var_E4		= dword	ptr -0E4h
var_D8		= dword	ptr -0D8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_94		= dword	ptr -94h
var_88		= dword	ptr -88h
var_6C		= dword	ptr -6Ch
var_60		= dword	ptr -60h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
hWnd		= dword	ptr  4

		sub	esp, 380h
		mov	eax, dword_430850
		mov	ecx, dword_4303B8
		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		push	esi		; hWnd
		mov	dword ptr [esp+394h+var_37C.anonymous_3], eax
		mov	[esp+394h+var_37C.hplWatermark], ecx
		mov	[esp+394h+var_2D4], esi
		mov	[esp+394h+lParam], esi
		mov	dword ptr [esp+394h+var_37C.anonymous_4], esi
		mov	[esp+394h+var_348], esi
		mov	[esp+394h+var_344], esi
		mov	[esp+394h+var_33C], esi
		mov	[esp+394h+lpString], esi
		mov	[esp+394h+var_338], esi
		mov	[esp+394h+var_334], esi
		mov	[esp+394h+var_330], esi
		call	ds:GetDC
		mov	ebp, ds:GetDeviceCaps
		mov	ebx, eax
		push	0Eh		; index
		push	ebx		; hdc
		call	ebp ; GetDeviceCaps
		push	0Ch		; index
		push	ebx		; hdc
		mov	edi, eax
		call	ebp ; GetDeviceCaps
		imul	edi, eax
		push	ebx		; hDC
		push	esi		; hWnd
		call	ds:ReleaseDC
		cmp	edi, 1
		jg	short loc_405BFF
		mov	eax, 0BDh
		jmp	short loc_405C0C
; ---------------------------------------------------------------------------

loc_405BFF:				; CODE XREF: sub_405B80+76j
		xor	eax, eax
		cmp	edi, 4
		setle	al
		add	eax, 0BBh

loc_405C0C:				; CODE XREF: sub_405B80+7Dj
		lea	edx, [esp+390h+var_33C]
		and	eax, 0FFFFh
		push	edx		; int
		push	eax		; lpName
		mov	eax, hModule
		push	eax		; hModule
		call	sub_40ADE0
		mov	ecx, hModule
		mov	[esp+39Ch+ho], eax
		add	esp, 0Ch
		lea	eax, [esp+390h+var_2A4]
		mov	edx, 11h
		mov	edi, 28h

loc_405C40:				; CODE XREF: sub_405B80+E8j
		mov	[eax-4], edi
		mov	dword ptr [eax], 20h
		mov	[eax+4], ecx
		mov	[eax+8], esi
		mov	[eax+0Ch], esi
		mov	[eax+10h], esi
		lea	ebx, [esp+390h+var_37C.anonymous_3]
		mov	[eax+14h], esi
		mov	[eax+18h], ebx
		mov	[eax+1Ch], esi
		mov	[eax+20h], esi
		add	eax, edi
		dec	edx
		jnz	short loc_405C40
		mov	ebx, [esp+390h+hWnd]
		mov	[esp+390h+var_37C.hInstance], ecx
		lea	ecx, [esp+390h+var_2A8]
		mov	[esp+390h+var_29C], 459h
		mov	[esp+390h+var_290], offset loc_40AC00
		mov	[esp+390h+var_274], 45Ah
		mov	[esp+390h+var_268], offset sub_40A910
		mov	[esp+390h+var_24C], 45Bh
		mov	[esp+390h+var_240], offset loc_40A6C0
		mov	[esp+390h+var_224], 45Ch
		mov	[esp+390h+var_218], offset sub_40A020
		mov	[esp+390h+var_1FC], 45Dh
		mov	[esp+390h+var_1F0], offset loc_409BB0
		mov	[esp+390h+var_1D4], 0C9h
		mov	[esp+390h+var_1C8], offset loc_4099F0
		mov	[esp+390h+var_1AC], 0CAh
		mov	[esp+390h+var_1A0], offset loc_409840
		mov	[esp+390h+var_184], 0E1h
		mov	[esp+390h+var_178], offset loc_409680
		mov	[esp+390h+var_15C], 45Eh
		mov	[esp+390h+var_150], offset sub_408DD0
		mov	[esp+390h+var_134], 0C8h
		mov	[esp+390h+var_128], offset loc_408A20
		mov	[esp+390h+var_10C], 45Fh
		mov	[esp+390h+var_100], offset sub_4086D0
		mov	[esp+390h+var_E4], 460h
		mov	[esp+390h+var_D8], offset sub_4078B0
		mov	[esp+390h+var_BC], 0BAh
		mov	[esp+390h+var_B0], offset sub_407120
		mov	[esp+390h+var_94], 47Ch
		mov	[esp+390h+var_88], offset loc_406F20
		mov	[esp+390h+var_6C], 462h
		mov	[esp+390h+var_60], offset sub_406A90
		mov	[esp+390h+var_44], 0E5h
		mov	[esp+390h+var_38], offset sub_406360
		mov	[esp+390h+var_1C], 461h
		mov	[esp+390h+var_10], offset loc_406170
		mov	[esp+390h+var_37C.dwSize], edi
		mov	[esp+390h+var_37C.dwFlags], edi
		mov	[esp+390h+var_37C.hwndParent], ebx
		mov	dword ptr [esp+390h+var_37C.anonymous_0], esi
		mov	[esp+390h+var_37C.pszCaption], esi
		mov	[esp+390h+var_37C.nPages], 11h
		mov	dword ptr [esp+390h+var_37C.anonymous_1], esi
		mov	dword ptr [esp+390h+var_37C.anonymous_2], ecx
		mov	[esp+390h+var_37C.pfnCallback],	esi
		call	sub_405FB0
		lea	edx, [esp+390h+var_37C.anonymous_3]
		push	edx
		call	sub_4060C0
		add	esp, 4
		test	eax, eax
		jz	short loc_405E68
		mov	ecx, dword_430850
		lea	eax, [esp+390h+var_348]
		push	eax
		push	ecx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		lea	edx, [esp+390h+var_37C]
		push	edx		; LPCPROPSHEETHEADERA
		call	ds:PropertySheetA
		mov	eax, [esp+390h+var_348]
		push	esi
		push	eax
		call	ds:PGPclCloseClientPrefs
		add	esp, 8

loc_405E68:				; CODE XREF: sub_405B80+2AEj
		mov	eax, dword ptr [esp+390h+var_37C.anonymous_4]
		cmp	eax, esi
		jz	short loc_405E7B
		push	esi
		push	eax
		call	ds:PGPclCloseAdminPrefs
		add	esp, 8

loc_405E7B:				; CODE XREF: sub_405B80+2EEj
		call	__mtinitlocks
		mov	eax, [esp+390h+lpString]
		mov	dword_430400, esi
		cmp	eax, esi
		jz	short loc_405E9B
		push	eax		; lpString
		call	sub_405F70
		add	esp, 4
		mov	[esp+390h+lpString], esi

loc_405E9B:				; CODE XREF: sub_405B80+30Cj
		mov	eax, [esp+390h+var_338]
		cmp	eax, esi
		jz	short loc_405EB0
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		mov	[esp+390h+var_338], esi

loc_405EB0:				; CODE XREF: sub_405B80+321j
		mov	eax, [esp+390h+var_334]
		cmp	eax, esi
		jz	short loc_405EC5
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		mov	[esp+390h+var_334], esi

loc_405EC5:				; CODE XREF: sub_405B80+336j
		mov	eax, [esp+390h+var_330]
		cmp	eax, esi
		jz	short loc_405EDA
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		mov	[esp+390h+var_330], esi

loc_405EDA:				; CODE XREF: sub_405B80+34Bj
		mov	ecx, [esp+390h+ho]
		push	ecx		; ho
		call	ds:DeleteObject
		cmp	[esp+390h+var_2D4], esi
		jnz	short loc_405F41
		mov	eax, [esp+390h+lParam]
		cmp	eax, esi
		jz	short loc_405F3A
		lea	edx, [esp+390h+var_380]
		push	edx
		push	eax
		call	PGPNewSingletonKeySet
		mov	edi, ds:PGPclErrorBox
		push	eax
		push	esi
		call	edi ; PGPclErrorBox
		mov	eax, dword_4303DC
		mov	ecx, [esp+3A0h+var_380]
		push	eax
		push	ecx
		call	PGPRemoveKeys
		push	eax
		push	esi
		call	edi ; PGPclErrorBox
		mov	edx, [esp+3B0h+var_380]
		push	edx
		call	PGPFreeKeySet
		mov	eax, dword_4303DC
		push	eax
		call	PGPCommitKeyRingChanges
		add	esp, 28h

loc_405F3A:				; CODE XREF: sub_405B80+377j
		mov	[esp+390h+wParam], esi

loc_405F41:				; CODE XREF: sub_405B80+36Cj
		mov	ecx, [esp+390h+lParam]
		mov	edx, [esp+390h+wParam]
		push	ecx		; lParam
		push	edx		; wParam
		push	8063h		; Msg
		push	ebx		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 380h
		retn
sub_405B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_405F70(LPCSTR	lpString)
sub_405F70	proc near		; CODE XREF: sub_405B80+30Fp
					; sub_407120+177p ...

lpString	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpString]
		test	esi, esi
		jz	short loc_405F9F
		push	edi
		push	esi		; lpString
		call	ds:lstrlenA
		mov	ecx, eax
		xor	eax, eax
		mov	edx, ecx
		mov	edi, esi
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		push	esi
		and	ecx, 3
		rep stosb
		call	PGPFreeData
		add	esp, 4
		pop	edi

loc_405F9F:				; CODE XREF: sub_405F70+7j
		pop	esi
		retn
sub_405F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_405FB0	proc near		; CODE XREF: sub_405B80+29Ap
		push	esi
		push	edi
		call	ds:GetCurrentThreadId
		mov	edi, ds:SetWindowsHookExA
		mov	esi, eax
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406030 ; lpfn
		push	2		; idHook
		call	edi ; SetWindowsHookExA
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406070 ; lpfn
		push	0		; idHook
		mov	dword_4303CC, eax
		call	edi ; SetWindowsHookExA
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406070 ; lpfn
		push	5		; idHook
		mov	dword_4303F0, eax
		call	edi ; SetWindowsHookExA
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406070 ; lpfn
		push	3		; idHook
		mov	dword_4303F8, eax
		call	edi ; SetWindowsHookExA
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406070 ; lpfn
		push	0FFFFFFFFh	; idHook
		mov	dword_4303D4, eax
		call	edi ; SetWindowsHookExA
		push	esi		; dwThreadId
		push	0		; hmod
		push	offset sub_406070 ; lpfn
		push	6		; idHook
		mov	dword_4303E8, eax
		call	edi ; SetWindowsHookExA
		pop	edi
		mov	dword_4303E8, eax
		pop	esi
		retn
sub_405FB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LRESULT __stdcall sub_406030(int code, WPARAM	wParam,	LPARAM lParam)
sub_406030	proc near		; DATA XREF: sub_405FB0+13o

code		= dword	ptr  4
wParam		= dword	ptr  8
lParam		= dword	ptr  0Ch

		mov	eax, dword_430400
		test	eax, eax
		jz	short loc_406064
		mov	eax, [esp+wParam]
		push	eax
		call	PGPGlobalRandomPoolAddKeystroke
		mov	ecx, dword_430400
		add	esp, 4
		push	0		; lParam
		push	0		; wParam
		push	200h		; Msg
		push	ecx		; hWnd
		call	ds:PostMessageA
		mov	eax, 1
		retn	0Ch
; ---------------------------------------------------------------------------

loc_406064:				; CODE XREF: sub_406030+7j
		xor	eax, eax
		retn	0Ch
sub_406030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LRESULT __stdcall sub_406070(int code, WPARAM	wParam,	LPARAM lParam)
sub_406070	proc near		; DATA XREF: sub_405FB0+1Fo
					; sub_405FB0+30o ...

code		= dword	ptr  4
wParam		= dword	ptr  8
lParam		= dword	ptr  0Ch

		xor	eax, eax
		retn	0Ch
sub_406070	endp

; ---------------------------------------------------------------------------
		align 10h
; [0000003D BYTES: COLLAPSED FUNCTION __mtinitlocks]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4060C0	proc near		; CODE XREF: sub_405B80+2A4p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		push	edi
		push	edi
		push	1
		mov	dword ptr [esi+5Ch], 11h
		mov	dword ptr [esi+60h], 800h
		mov	dword ptr [esi+64h], 400h
		mov	[esi+68h], edi
		mov	[esi+28h], edi
		mov	[esi+58h], edi
		mov	[esi+70h], edi
		mov	[esi+74h], edi
		mov	[esi+78h], edi
		mov	[esi+7Ch], edi
		mov	[esi+80h], edi
		mov	[esi+84h], edi
		mov	[esi+88h], edi
		mov	[esi+8Ch], edi
		mov	[esi+90h], edi
		mov	[esi+0A4h], edi
		mov	[esi+0A8h], edi
		mov	[esi+48h], edi
		mov	dword ptr [esi+4Ch], 8
		mov	[esi+40h], edi
		mov	[esi+44h], edi
		mov	dword ptr [esi+50h], 1
		call	ds:PGPclCheckSDKSupportForPKAlg
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_406147
		mov	[esi+50h], edi

loc_406147:				; CODE XREF: sub_4060C0+82j
		mov	[esi+2Ch], edi
		mov	[esi+30h], edi
		mov	[esi+38h], edi
		mov	[esi+34h], edi
		mov	[esi+3Ch], edi
		mov	[esi+94h], edi
		mov	dword ptr [esi+54h], 400h
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_4060C0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_406170:				; DATA XREF: sub_405B80+267o
		mov	eax, [esp+8]
		sub	esp, 140h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_406301
		cmp	eax, 4Eh
		jz	short loc_4061C3
		cmp	eax, 110h
		jnz	loc_406348
		mov	eax, [esp+160h]
		mov	edx, [esp+154h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	edx
		call	ds:SetWindowLongA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 140h
		retn	10h
; ---------------------------------------------------------------------------

loc_4061C3:				; CODE XREF: .text:0040618Cj
		mov	eax, [esp+160h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF30h
		jz	loc_4062E5
		cmp	eax, 0FFFFFF33h
		jz	loc_4062BC
		cmp	eax, 0FFFFFF38h
		jnz	loc_406348
		mov	esi, [esp+154h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+90h]
		test	eax, eax
		jnz	short loc_406218
		mov	eax, [edi+94h]
		test	eax, eax
		jnz	short loc_406218
		push	5
		jmp	short loc_40621A
; ---------------------------------------------------------------------------

loc_406218:				; CODE XREF: .text:00406208j
					; .text:00406212j
		push	4

loc_40621A:				; CODE XREF: .text:00406216j
		mov	ebx, ds:GetParent
		push	0
		push	470h
		push	esi
		call	ebx ; GetParent
		push	eax
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		mov	eax, [edi+90h]
		test	eax, eax
		jz	short loc_406273
		mov	eax, [edi+0A4h]
		test	eax, eax
		jz	short loc_406273
		push	0
		push	2
		push	esi
		call	ebx ; GetParent
		push	eax
		call	ds:GetDlgItem
		push	eax
		call	ds:EnableWindow
		jmp	short loc_40629F
; ---------------------------------------------------------------------------

loc_406273:				; CODE XREF: .text:00406250j
					; .text:0040625Aj
		mov	eax, hModule
		lea	edx, [esp+50h]
		push	100h
		push	edx
		push	487h
		push	eax
		call	ds:LoadStringA
		lea	ecx, [esp+50h]
		push	ecx
		push	420h
		push	esi
		call	ds:SetDlgItemTextA

loc_40629F:				; CODE XREF: .text:00406271j
					; .text:004062FFj
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 140h
		retn	10h
; ---------------------------------------------------------------------------

loc_4062BC:				; CODE XREF: .text:004061DDj
		mov	edx, [esp+154h]
		push	7DEh
		push	1
		push	offset szHelp
		push	edx
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 140h
		retn	10h
; ---------------------------------------------------------------------------

loc_4062E5:				; CODE XREF: .text:004061D2j
		mov	esi, [esp+154h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	dword ptr [eax+80h], 1
		jmp	short loc_40629F
; ---------------------------------------------------------------------------

loc_406301:				; CODE XREF: .text:00406183j
		mov	edi, [esp+154h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_406348
		lea	eax, [esp+10h]
		push	eax
		push	edi
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	0
		push	ecx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	edx, [esp+10h]
		push	edx
		push	edi
		call	ds:EndPaint

loc_406348:				; CODE XREF: .text:00406193j
					; .text:004061E8j ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 140h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_406360(HWND	hWnd, int, int,	int)
sub_406360	proc near		; DATA XREF: sub_405B80+251o

var_84		= dword	ptr -84h
Buffer		= byte ptr -80h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		sub	esp, 84h
		mov	eax, [esp+84h+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+94h+var_84], ebp
		ja	loc_40677F
		jz	loc_406753
		cmp	eax, 0Fh
		jz	loc_4066E8
		cmp	eax, 4Eh
		jnz	loc_4067E9	; jumptable 004063D3 default case
		mov	esi, [esp+94h+hWnd]
		mov	ebp, ds:GetWindowLongA
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	edi, eax
		mov	ebx, [esp+94h+arg_C]
		mov	eax, [ebx+8]
		cmp	eax, 0FFFFFF2Fh
		ja	loc_4065A4
		jz	loc_40651B
		dec	eax
		cmp	eax, 3		; switch 4 cases
		ja	loc_4067E9	; jumptable 004063D3 default case
		jmp	ds:off_4067FC[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4063DA:				; CODE XREF: sub_406360+73j
					; DATA XREF: .text:off_4067FCo
		mov	ecx, [edi+98h]	; jumptable 004063D3 case 1
		xor	eax, eax
		cmp	ecx, eax
		jnz	short loc_406424
		mov	ecx, 1
		mov	[edi+9Ch], eax
		mov	[edi+98h], ecx
		mov	edx, [ebx+14h]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_406416
		push	eax		; lpTimerFunc
		push	64h		; uElapse
		push	929h		; nIDEvent
		push	esi		; hWnd
		mov	[edi+0A0h], ecx
		call	ds:SetTimer
		jmp	short loc_40644E
; ---------------------------------------------------------------------------

loc_406416:				; CODE XREF: sub_406360+9Dj
		mov	[edi+0A0h], eax
		mov	[edi+9Ch], eax
		jmp	short loc_40644E
; ---------------------------------------------------------------------------

loc_406424:				; CODE XREF: sub_406360+84j
		cmp	dword ptr [ebx+14h], 0FFFFFFFFh
		jz	short loc_40644E
		mov	[edi+0A0h], eax
		mov	eax, [ebx+14h]
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		lea	eax, [eax+eax*8]
		cdq
		idiv	dword ptr [ebx+18h]
		mov	[edi+9Ch], eax
		call	sub_406810
		add	esp, 8

loc_40644E:				; CODE XREF: sub_406360+B4j
					; sub_406360+C2j ...
		lea	eax, [ebx+1Ch]
		push	eax		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	ecx, [edi+84h]
		pop	edi
		pop	esi
		mov	[ebx+10h], ecx
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406476:				; CODE XREF: sub_406360+73j
					; DATA XREF: .text:off_4067FCo
		mov	dword ptr [edi+0A4h], 1	; jumptable 004063D3 case 0

loc_406480:				; CODE XREF: sub_406360+73j
					; DATA XREF: .text:off_4067FCo
		push	0FFFFFFEBh	; jumptable 004063D3 cases 2,3
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		push	929h		; uIDEvent
		push	esi		; hWnd
		mov	edi, eax
		call	ds:KillTimer
		push	0		; bErase
		push	0		; lpRect
		push	esi		; hWnd
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	dword ptr [edi+0A0h], 1
		call	ds:InvalidateRect
		lea	edx, [ebx+1Ch]
		push	edx		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	ebp, ds:GetParent
		push	2		; lParam
		push	0		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		call	ebp ; GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		push	0		; bEnable
		push	2		; nIDDlgItem
		push	esi		; hWnd
		call	ebp ; GetParent
		mov	ebp, ds:GetDlgItem
		push	eax		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		push	0		; nCmdShow
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ds:ShowWindow
		mov	eax, [edi+84h]
		pop	edi
		pop	esi
		mov	[ebx+10h], eax
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40651B:				; CODE XREF: sub_406360+63j
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	ecx, [eax+0A4h]
		test	ecx, ecx
		jz	short loc_40654E
		push	0		; dwNewLong

loc_40652C:				; CODE XREF: sub_406360+278j
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+8Ch+var_84], 1
		pop	ebp
		mov	eax, [esp+88h+var_84]
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40654E:				; CODE XREF: sub_406360+1C8j
		mov	edi, 1
		lea	ecx, [esp+94h+Buffer]
		mov	[eax+84h], edi
		mov	edx, hModule
		push	80h		; cchBufferMax
		push	ecx		; lpBuffer
		push	47Dh		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+94h+Buffer]
		push	eax		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	eax, edi
		mov	[esp+94h+var_84], edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_4065A4:				; CODE XREF: sub_406360+5Dj
		cmp	eax, 0FFFFFF33h
		jz	loc_4066C4
		cmp	eax, 0FFFFFF37h
		jz	loc_4066A7
		cmp	eax, 0FFFFFF38h
		jnz	loc_4067E9	; jumptable 004063D3 default case
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+94h]
		test	eax, eax
		jnz	short loc_4065DD
		push	0FFFFFFFFh
		jmp	loc_40652C
; ---------------------------------------------------------------------------

loc_4065DD:				; CODE XREF: sub_406360+274j
		push	0		; lParam
		push	0		; wParam
		mov	ebx, 1
		push	470h		; Msg
		push	esi		; hWnd
		mov	dword ptr [edi+98h], 0
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	[edi+0A0h], ebx
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx		; lParam
		push	0		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		mov	edx, [edi+78h]
		push	offset dword_430414
		push	edx
		call	PGPNewSingletonKeySet
		mov	eax, [edi+28h]
		mov	ecx, dword_430414
		mov	edx, dword_4303DC
		push	eax
		mov	eax, [edi+4]
		push	ecx
		mov	ecx, [edi]
		push	0
		push	edx
		push	esi
		push	eax
		push	ecx
		call	ds:PGPclSendCertificateRequestToServerNotify
		mov	edi, eax
		push	edi
		push	esi
		call	ds:PGPclErrorBox
		add	esp, 2Ch
		test	edi, edi
		jz	short loc_406689
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+8Ch+var_84], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406689:				; CODE XREF: sub_406360+309j
		push	0		; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+8Ch+var_84], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_4066A7:				; CODE XREF: sub_406360+254j
		push	929h		; uIDEvent
		push	esi		; hWnd
		call	ds:KillTimer
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_4066C4:				; CODE XREF: sub_406360+249j
		push	7DDh		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	esi		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_4066E8:				; CODE XREF: sub_406360+2Bj
		mov	esi, [esp+94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	short loc_40672C
		lea	edx, [esp+94h+Buffer]
		push	edx		; lpPaint
		push	esi		; hWnd
		call	ds:BeginPaint
		mov	edi, eax
		mov	eax, [ebx+18h]
		push	ebp		; bForceBkgd
		push	eax		; hPal
		push	edi		; hdc
		call	ds:SelectPalette
		push	edi		; hdc
		call	ds:RealizePalette
		lea	ecx, [esp+94h+Buffer]
		push	ecx		; lpPaint
		push	esi		; hWnd
		call	ds:EndPaint

loc_40672C:				; CODE XREF: sub_406360+39Dj
		push	ebx		; int
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	sub_406860
		mov	eax, [esp+9Ch+var_84]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406753:				; CODE XREF: sub_406360+22j
		mov	edx, [esp+94h+arg_C]
		mov	ecx, [esp+94h+hWnd]
		mov	eax, [edx+1Ch]
		push	eax		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	ecx		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40677F:				; CODE XREF: sub_406360+1Cj
		cmp	eax, 113h
		jnz	short loc_4067E9 ; jumptable 004063D3 default case
		mov	esi, [esp+94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	edx, [eax+0A0h]
		mov	edi, [eax+9Ch]
		add	edi, edx
		mov	ecx, edi
		mov	[eax+9Ch], edi
		cmp	ecx, ebp
		jg	short loc_4067C2
		mov	[eax+9Ch], ebp
		mov	dword ptr [eax+0A0h], 1
		jmp	short loc_4067DB
; ---------------------------------------------------------------------------

loc_4067C2:				; CODE XREF: sub_406360+44Ej
		cmp	ecx, 9
		jl	short loc_4067DB
		mov	dword ptr [eax+9Ch], 9
		mov	dword ptr [eax+0A0h], 0FFFFFFFFh

loc_4067DB:				; CODE XREF: sub_406360+460j
					; sub_406360+465j
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_406810
		add	esp, 8

loc_4067E9:				; CODE XREF: sub_406360+34j
					; sub_406360+6Dj ...
		mov	eax, [esp+94h+var_84] ;	jumptable 004063D3 default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
sub_406360	endp

; ---------------------------------------------------------------------------
		align 4
off_4067FC	dd offset loc_406476	; DATA XREF: sub_406360+73r
		dd offset loc_4063DA	; jump table for switch	statement
		dd offset loc_406480
		dd offset loc_406480
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406810(HWND hDlg, int	nIDDlgItem)
sub_406810	proc near		; CODE XREF: sub_406360+E6p
					; sub_406360+481p ...

Rect		= tagRECT ptr -10h
hDlg		= dword	ptr  4
nIDDlgItem	= dword	ptr  8

		mov	ecx, [esp+nIDDlgItem]
		sub	esp, 10h
		lea	eax, [esp+10h+Rect]
		push	esi
		mov	esi, [esp+14h+hDlg]
		push	eax		; lpRect
		push	ecx		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:GetWindowRect
		lea	edx, [esp+14h+Rect]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ds:MapWindowPoints
		lea	eax, [esp+14h+Rect]
		push	0		; bErase
		push	eax		; lpRect
		push	esi		; hWnd
		call	ds:InvalidateRect
		pop	esi
		add	esp, 10h
		retn
sub_406810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_406860(HWND hWnd, int)
sub_406860	proc near		; CODE XREF: sub_406360+3DAp
					; sub_406A90+3B2p ...

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
y		= dword	ptr -68h
var_64		= dword	ptr -64h
h		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
ho		= dword	ptr -54h
Rect		= tagRECT ptr -50h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		sub	esp, 70h
		cmp	dword ptr [eax+9Ch], 0FFFFFFFFh
		jl	loc_406A87
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+80h+hWnd]
		lea	ecx, [esp+80h+Paint]
		push	ecx		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		lea	edx, [esp+80h+Rect]
		mov	esi, eax
		push	edx		; lpRect
		push	edi		; hWnd
		call	ds:GetClientRect
		mov	ecx, [esp+80h+Rect.bottom]
		mov	eax, [esp+80h+Rect.top]
		mov	edi, [esp+80h+Rect.left]
		inc	eax
		lea	ebx, [ecx-2]
		mov	ecx, [esp+80h+Rect.right]
		mov	[esp+80h+y], eax
		sub	ecx, edi
		mov	eax, 66666667h
		mov	[esp+80h+var_5C], 0Ah
		imul	ecx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	edi, 4
		lea	ecx, [edx+eax-2]
		mov	[esp+80h+var_70], ecx

loc_4068D5:				; CODE XREF: sub_406860+AFj
		mov	edx, [esp+80h+var_70]
		push	0		; lppt
		push	ebx		; y
		push	edi		; x
		push	esi		; hdc
		lea	ebp, [edi+edx]
		call	ds:MoveToEx
		push	ebx		; y
		push	ebp		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	eax, [esp+80h+y]
		push	eax		; y
		push	ebp		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	ecx, [esp+80h+var_70]
		lea	eax, [ecx+2]
		add	edi, eax
		mov	eax, [esp+80h+var_5C]
		dec	eax
		mov	[esp+80h+var_5C], eax
		jnz	short loc_4068D5
		push	808080h		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		mov	ebp, ds:SelectObject
		push	eax		; h
		push	esi		; hdc
		mov	[esp+88h+ho], eax
		call	ebp ; SelectObject
		mov	edi, ds:CreateSolidBrush
		push	0FF00h		; color
		mov	[esp+84h+var_58], eax
		call	edi ; CreateSolidBrush
		push	8000h		; color
		mov	[esp+84h+h], eax
		call	edi ; CreateSolidBrush
		mov	edx, [esp+80h+Rect.left]
		mov	ecx, [esp+80h+arg_4]
		mov	[esp+80h+var_5C], eax
		lea	edi, [edx+4]
		mov	edx, [ecx+0A0h]
		test	edx, edx
		jz	short loc_4069DF
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	[esp+80h+var_64], eax
		mov	[esp+80h+var_6C], 0

loc_406976:				; CODE XREF: sub_406860+17Bj
		mov	eax, [esp+80h+var_70]
		mov	ecx, [esp+80h+arg_4]
		mov	edx, [esp+80h+var_6C]
		add	eax, edi
		cmp	edx, [ecx+9Ch]
		jnz	short loc_4069B7
		mov	eax, [esp+80h+h]
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	ecx, [esp+80h+var_70]
		mov	edx, [esp+80h+y]
		push	ebx		; bottom
		lea	eax, [edi+ecx]
		push	eax		; right
		push	edx		; top
		push	edi		; left
		push	esi		; hdc
		call	ds:Rectangle
		mov	eax, [esp+80h+var_5C]
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		jmp	short loc_4069C6
; ---------------------------------------------------------------------------

loc_4069B7:				; CODE XREF: sub_406860+12Dj
		mov	ecx, [esp+80h+y]
		push	ebx		; bottom
		push	eax		; right
		push	ecx		; top
		push	edi		; left
		push	esi		; hdc
		call	ds:Rectangle

loc_4069C6:				; CODE XREF: sub_406860+155j
		mov	edx, [esp+80h+var_70]
		lea	eax, [edx+2]
		add	edi, eax
		mov	eax, [esp+80h+var_6C]
		inc	eax
		cmp	eax, 0Ah
		mov	[esp+80h+var_6C], eax
		jl	short loc_406976
		jmp	short loc_406A45
; ---------------------------------------------------------------------------

loc_4069DF:				; CODE XREF: sub_406860+104j
		mov	edx, [ecx+9Ch]
		test	edx, edx
		jl	short loc_4069ED
		mov	eax, [esp+80h+h]

loc_4069ED:				; CODE XREF: sub_406860+187j
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	[esp+80h+var_64], eax
		mov	[esp+80h+var_6C], 0

loc_4069FD:				; CODE XREF: sub_406860+1E3j
		mov	ecx, [esp+80h+arg_4]
		mov	edx, [esp+80h+var_6C]
		cmp	edx, [ecx+9Ch]
		jle	short loc_406A18
		mov	eax, [esp+80h+var_5C]
		push	eax		; h
		push	esi		; hdc
		call	ebp ; SelectObject

loc_406A18:				; CODE XREF: sub_406860+1AEj
		mov	ecx, [esp+80h+var_70]
		mov	edx, [esp+80h+y]
		push	ebx		; bottom
		lea	eax, [edi+ecx]
		push	eax		; right
		push	edx		; top
		push	edi		; left
		push	esi		; hdc
		call	ds:Rectangle
		mov	eax, [esp+80h+var_70]
		add	eax, 2
		add	edi, eax
		mov	eax, [esp+80h+var_6C]
		inc	eax
		cmp	eax, 0Ah
		mov	[esp+80h+var_6C], eax
		jl	short loc_4069FD

loc_406A45:				; CODE XREF: sub_406860+17Dj
		mov	ecx, [esp+80h+var_64]
		push	ecx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	edx, [esp+80h+var_58]
		push	edx		; h
		push	esi		; hdc
		call	ebp ; SelectObject
		mov	eax, [esp+80h+ho]
		mov	esi, ds:DeleteObject
		push	eax		; ho
		call	esi ; DeleteObject
		mov	ecx, [esp+80h+h]
		push	ecx		; ho
		call	esi ; DeleteObject
		mov	edx, [esp+80h+var_5C]
		push	edx		; ho
		call	esi ; DeleteObject
		mov	ecx, [esp+80h+hWnd]
		lea	eax, [esp+80h+Paint]
		push	eax		; lpPaint
		push	ecx		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx

loc_406A87:				; CODE XREF: sub_406860+Ej
		add	esp, 70h
		retn
sub_406860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_406A90(HWND	hWnd, int, int,	int)
sub_406A90	proc near		; DATA XREF: sub_405B80+23Bo

var_84		= dword	ptr -84h
Buffer		= byte ptr -80h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		sub	esp, 84h
		mov	eax, [esp+84h+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+94h+var_84], ebp
		ja	loc_406E87
		jz	loc_406E5B
		cmp	eax, 0Fh
		jz	loc_406DF0
		cmp	eax, 4Eh
		jnz	loc_406EF1	; jumptable 00406B03 default case
		mov	esi, [esp+94h+hWnd]
		mov	ebp, ds:GetWindowLongA
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	edi, eax
		mov	ebx, [esp+94h+arg_C]
		mov	eax, [ebx+8]
		cmp	eax, 0FFFFFF2Fh
		ja	loc_406CC1
		jz	loc_406C59
		dec	eax
		cmp	eax, 3		; switch 4 cases
		ja	loc_406EF1	; jumptable 00406B03 default case
		jmp	ds:off_406F04[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_406B0A:				; CODE XREF: sub_406A90+73j
					; DATA XREF: .text:off_406F04o
		mov	ecx, [edi+98h]	; jumptable 00406B03 case 1
		xor	eax, eax
		cmp	ecx, eax
		jnz	short loc_406B54
		mov	ecx, 1
		mov	[edi+9Ch], eax
		mov	[edi+98h], ecx
		mov	edx, [ebx+14h]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_406B46
		push	eax		; lpTimerFunc
		push	64h		; uElapse
		push	929h		; nIDEvent
		push	esi		; hWnd
		mov	[edi+0A0h], ecx
		call	ds:SetTimer
		jmp	short loc_406B7E
; ---------------------------------------------------------------------------

loc_406B46:				; CODE XREF: sub_406A90+9Dj
		mov	[edi+0A0h], eax
		mov	[edi+9Ch], eax
		jmp	short loc_406B7E
; ---------------------------------------------------------------------------

loc_406B54:				; CODE XREF: sub_406A90+84j
		cmp	dword ptr [ebx+14h], 0FFFFFFFFh
		jz	short loc_406B7E
		mov	[edi+0A0h], eax
		mov	eax, [ebx+14h]
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		lea	eax, [eax+eax*8]
		cdq
		idiv	dword ptr [ebx+18h]
		mov	[edi+9Ch], eax
		call	sub_406810
		add	esp, 8

loc_406B7E:				; CODE XREF: sub_406A90+B4j
					; sub_406A90+C2j ...
		lea	eax, [ebx+1Ch]
		push	eax		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	ecx, [edi+84h]
		pop	edi
		pop	esi
		mov	[ebx+10h], ecx
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406BA6:				; CODE XREF: sub_406A90+73j
					; DATA XREF: .text:off_406F04o
		mov	dword ptr [edi+0A4h], 1	; jumptable 00406B03 case 0

loc_406BB0:				; CODE XREF: sub_406A90+73j
					; DATA XREF: .text:off_406F04o
		push	0FFFFFFEBh	; jumptable 00406B03 cases 2,3
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		push	929h		; uIDEvent
		push	esi		; hWnd
		mov	edi, eax
		call	ds:KillTimer
		push	0		; bErase
		push	0		; lpRect
		push	esi		; hWnd
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	dword ptr [edi+0A0h], 1
		call	ds:InvalidateRect
		lea	edx, [ebx+1Ch]
		push	edx		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	ebp, ds:GetParent
		push	2		; lParam
		push	0		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		call	ebp ; GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		push	0		; bEnable
		push	2		; nIDDlgItem
		push	esi		; hWnd
		call	ebp ; GetParent
		mov	ebp, ds:GetDlgItem
		push	eax		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		push	0		; nCmdShow
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ds:ShowWindow
		mov	eax, dword_430418
		push	eax
		call	PGPFreeKeySet
		mov	ecx, [edi+84h]
		add	esp, 4
		mov	[ebx+10h], ecx
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406C59:				; CODE XREF: sub_406A90+63j
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	ecx, [eax+0A4h]
		test	ecx, ecx
		jnz	loc_406EF1	; jumptable 00406B03 default case
		mov	edi, 1
		lea	edx, [esp+94h+Buffer]
		mov	[eax+84h], edi
		mov	eax, hModule
		push	80h		; cchBufferMax
		push	edx		; lpBuffer
		push	47Dh		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		lea	ecx, [esp+94h+Buffer]
		push	ecx		; lpString
		push	42Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	eax, edi
		mov	[esp+94h+var_84], edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406CC1:				; CODE XREF: sub_406A90+5Dj
		cmp	eax, 0FFFFFF33h
		jz	loc_406DCC
		cmp	eax, 0FFFFFF37h
		jz	loc_406DAF
		cmp	eax, 0FFFFFF38h
		jnz	loc_406EF1	; jumptable 00406B03 default case
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebp ; GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+90h]
		test	eax, eax
		jnz	short loc_406D17
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+8Ch+var_84], 1
		pop	ebp
		mov	eax, [esp+88h+var_84]
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406D17:				; CODE XREF: sub_406A90+261j
		push	0		; lParam
		push	0		; wParam
		mov	ebx, 1
		push	470h		; Msg
		push	esi		; hWnd
		mov	dword ptr [edi+98h], 0
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	[edi+0A0h], ebx
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	edx, [edi+14h]
		push	edx		; lParam
		push	0		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		mov	eax, [edi+78h]
		push	offset dword_430418
		push	eax
		call	PGPNewSingletonKeySet
		mov	ecx, dword_430418
		mov	edx, dword_4303DC
		mov	eax, [edi+4]
		push	ecx
		mov	ecx, [edi]
		push	edx
		push	esi
		push	eax
		push	ecx
		call	ds:PGPclSendKeysToRootServerNotify
		add	esp, 1Ch
		push	0		; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+8Ch+var_84], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406DAF:				; CODE XREF: sub_406A90+241j
		push	929h		; uIDEvent
		push	esi		; hWnd
		call	ds:KillTimer
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406DCC:				; CODE XREF: sub_406A90+236j
		push	7DDh		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	esi		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406DF0:				; CODE XREF: sub_406A90+2Bj
		mov	esi, [esp+94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	short loc_406E34
		lea	edx, [esp+94h+Buffer]
		push	edx		; lpPaint
		push	esi		; hWnd
		call	ds:BeginPaint
		mov	edi, eax
		mov	eax, [ebx+18h]
		push	ebp		; bForceBkgd
		push	eax		; hPal
		push	edi		; hdc
		call	ds:SelectPalette
		push	edi		; hdc
		call	ds:RealizePalette
		lea	ecx, [esp+94h+Buffer]
		push	ecx		; lpPaint
		push	esi		; hWnd
		call	ds:EndPaint

loc_406E34:				; CODE XREF: sub_406A90+375j
		push	ebx		; int
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	sub_406860
		mov	eax, [esp+9Ch+var_84]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406E5B:				; CODE XREF: sub_406A90+22j
		mov	edx, [esp+94h+arg_C]
		mov	ecx, [esp+94h+hWnd]
		mov	eax, [edx+1Ch]
		push	eax		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	ecx		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	eax, [esp+8Ch+var_84]
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
; ---------------------------------------------------------------------------

loc_406E87:				; CODE XREF: sub_406A90+1Cj
		cmp	eax, 113h
		jnz	short loc_406EF1 ; jumptable 00406B03 default case
		mov	esi, [esp+94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	edx, [eax+0A0h]
		mov	edi, [eax+9Ch]
		add	edi, edx
		mov	ecx, edi
		mov	[eax+9Ch], edi
		cmp	ecx, ebp
		jg	short loc_406ECA
		mov	[eax+9Ch], ebp
		mov	dword ptr [eax+0A0h], 1
		jmp	short loc_406EE3
; ---------------------------------------------------------------------------

loc_406ECA:				; CODE XREF: sub_406A90+426j
		cmp	ecx, 9
		jl	short loc_406EE3
		mov	dword ptr [eax+9Ch], 9
		mov	dword ptr [eax+0A0h], 0FFFFFFFFh

loc_406EE3:				; CODE XREF: sub_406A90+438j
					; sub_406A90+43Dj
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_406810
		add	esp, 8

loc_406EF1:				; CODE XREF: sub_406A90+34j
					; sub_406A90+6Dj ...
		mov	eax, [esp+94h+var_84] ;	jumptable 00406B03 default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 84h
		retn	10h
sub_406A90	endp

; ---------------------------------------------------------------------------
		align 4
off_406F04	dd offset loc_406BA6	; DATA XREF: sub_406A90+73r
		dd offset loc_406B0A	; jump table for switch	statement
		dd offset loc_406BB0
		dd offset loc_406BB0
		align 10h

loc_406F20:				; DATA XREF: sub_405B80+225o
		mov	eax, [esp+8]
		sub	esp, 40h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		ja	loc_4070CB
		jz	loc_40709D
		cmp	eax, 0Fh
		jz	loc_40704C
		cmp	eax, 4Eh
		jnz	loc_407113
		mov	eax, [esp+60h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_407029
		cmp	eax, 0FFFFFF37h
		jz	short loc_406FC9
		cmp	eax, 0FFFFFF38h
		jnz	loc_407113
		mov	esi, [esp+54h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		push	2
		push	ebp
		push	470h
		push	esi
		mov	edi, eax
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	ebp
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	ebp
		push	ebp
		push	esi
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_406FC9:				; CODE XREF: .text:00406F67j
		mov	esi, [esp+54h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		push	41Fh
		push	esi
		mov	edi, eax
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_407009
		push	ebp
		push	ebp
		push	esi
		mov	[edi+90h], eax
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_407009:				; CODE XREF: .text:00406FE7j
		push	ebp
		push	ebp
		push	esi
		mov	[edi+90h], ebp
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_407029:				; CODE XREF: .text:00406F5Cj
		mov	edx, [esp+54h]
		push	7DCh
		push	1
		push	offset szHelp
		push	edx
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40704C:				; CODE XREF: .text:00406F41j
		mov	edi, [esp+54h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	loc_407113
		lea	eax, [esp+10h]
		push	eax
		push	edi
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	ebp
		push	ecx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	edx, [esp+10h]
		push	edx
		push	edi
		call	ds:EndPaint
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40709D:				; CODE XREF: .text:00406F38j
		mov	eax, [esp+60h]
		mov	esi, [esp+54h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	esi
		call	ds:SetWindowLongA
		push	ebp
		push	41Fh
		push	esi
		call	ds:CheckDlgButton
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_4070CB:				; CODE XREF: .text:00406F32j
		cmp	eax, 111h
		jnz	short loc_407113
		cmp	word ptr [esp+5Ch], 41Fh
		jnz	short loc_407113
		mov	esi, [esp+54h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		push	41Fh
		push	esi
		mov	edi, eax
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40710D
		mov	[edi+90h], eax
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40710D:				; CODE XREF: .text:004070F9j
		mov	[edi+90h], ebp

loc_407113:				; CODE XREF: .text:00406F4Aj
					; .text:00406F6Ej ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_407120(HWND	hWnd, int, CHAR	String,	int)
sub_407120	proc near		; DATA XREF: sub_405B80+20Fo

var_44		= dword	ptr -44h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
String		= byte ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 44h
		mov	eax, [esp+44h+arg_4]
		push	ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+50h+var_44], 0
		ja	loc_4074E0
		jz	loc_40748D
		sub	eax, 2
		jz	loc_407446
		sub	eax, 0Dh
		jz	loc_4073F1
		sub	eax, 3Fh
		jnz	loc_4075AC
		mov	eax, [esp+50h+arg_C]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_4073CD
		cmp	eax, 0FFFFFF37h
		jz	loc_407267
		cmp	eax, 0FFFFFF38h
		jnz	loc_4075AC
		mov	esi, [esp+50h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+7Ch]
		test	eax, eax
		jnz	short loc_4071A3
		push	0FFFFFFFFh
		jmp	loc_407249
; ---------------------------------------------------------------------------

loc_4071A3:				; CODE XREF: sub_407120+7Aj
		push	2		; lParam
		push	0		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx		; lParam
		push	0		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		mov	ebp, ds:CheckDlgButton
		push	1		; uCheck
		push	46Eh		; nIDButton
		push	esi		; hDlg
		mov	dword_42F1BC, 1
		call	ebp ; CheckDlgButton
		push	1		; uCheck
		push	0BBh		; nIDButton
		push	esi		; hDlg
		call	ebp ; CheckDlgButton
		mov	eax, [edi+7Ch]
		lea	edx, [esp+50h+hWnd]
		push	edx
		push	42h
		push	eax
		call	PGPGetKeyBoolean
		mov	al, byte ptr [esp+5Ch+hWnd]
		add	esp, 0Ch
		test	al, al
		jnz	short loc_407247
		push	offset byte_430394 ; lpString
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	edi, ds:GetDlgItem
		push	0		; bEnable
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, ds:EnableWindow
		push	eax		; hWnd
		call	ebp ; EnableWindow
		push	0		; bEnable
		push	46Eh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow

loc_407247:				; CODE XREF: sub_407120+EEj
		push	0		; dwNewLong

loc_407249:				; CODE XREF: sub_407120+7Ej
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+48h+var_44], 1
		pop	ebp
		mov	eax, [esp+44h+var_44]
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_407267:				; CODE XREF: sub_407120+55j
		mov	edi, [esp+50h+hWnd]
		push	0BBh		; nIDButton
		push	edi		; hDlg
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	loc_4075AC
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		xor	ebp, ebp
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, lpString
		test	eax, eax
		jz	short loc_4072A5
		push	eax		; lpString
		call	sub_405F70
		add	esp, 4
		mov	lpString, ebp

loc_4072A5:				; CODE XREF: sub_407120+174j
		push	0		; lParam
		push	0		; wParam
		push	0Eh		; Msg
		push	479h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:SendDlgItemMessageA
		inc	eax
		push	eax
		mov	dword_43040C, eax
		call	sub_4075C0
		add	esp, 4
		mov	lpString, eax
		test	eax, eax
		jz	loc_4073AD
		lea	ecx, [esp+50h+String]
		push	4		; cchMax
		push	ecx		; lpString
		push	479h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItemTextA
		mov	eax, lpString
		test	eax, eax
		jz	loc_4073AD
		mov	eax, [esi+78h]
		lea	edx, [esp+50h+arg_C]
		push	edx
		push	eax
		call	PGPGetPrimaryUserID
		mov	eax, [esp+58h+arg_C]
		add	esp, 8
		test	eax, eax
		jz	short loc_407382
		mov	ecx, [esi+10h]
		mov	edx, [esi]
		push	0
		push	ecx
		push	edx
		call	ds:PGPclRandom
		mov	eax, [esi]
		push	eax
		call	PGPOLastOption
		mov	ecx, lpString
		mov	edx, [esi]
		add	esp, 10h
		push	eax
		push	ecx
		push	edx
		call	PGPOPassphrase
		mov	ecx, [esp+5Ch+arg_C]
		add	esp, 8
		push	eax
		mov	eax, [esi+7Ch]
		push	eax
		push	ecx
		call	PGPSignUserID
		add	esp, 10h
		cmp	eax, 0FFFFD314h
		jnz	short loc_407369
		push	10h		; int
		push	47Ah		; UINT
		push	44Dh		; uID
		push	edi		; hWnd
		call	sub_402000
		add	esp, 10h
		jmp	short loc_407382
; ---------------------------------------------------------------------------

loc_407369:				; CODE XREF: sub_407120+230j
		test	eax, eax
		jz	short loc_40737D
		mov	edx, [esi+10h]
		push	eax
		push	edx
		call	ds:PGPclErrorBox
		add	esp, 8
		jmp	short loc_407382
; ---------------------------------------------------------------------------

loc_40737D:				; CODE XREF: sub_407120+24Bj
		mov	ebp, 1

loc_407382:				; CODE XREF: sub_407120+1EAj
					; sub_407120+247j ...
		mov	eax, lpString
		push	eax		; lpString
		call	sub_405F70
		push	479h		; nIDDlgItem
		push	edi		; hDlg
		mov	lpString, 0
		call	sub_4113C0
		add	esp, 0Ch
		test	ebp, ebp
		jnz	loc_4075AC

loc_4073AD:				; CODE XREF: sub_407120+1ADj
					; sub_407120+1CDj
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+48h+var_44], 1
		pop	ebp
		mov	eax, [esp+44h+var_44]
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_4073CD:				; CODE XREF: sub_407120+4Aj
		mov	ecx, [esp+50h+hWnd]
		push	7DBh		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	ecx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+48h+var_44]
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_4073F1:				; CODE XREF: sub_407120+2Fj
		mov	edi, [esp+50h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebp, eax
		mov	eax, [ebp+18h]
		test	eax, eax
		jz	loc_4075AC
		lea	edx, [esp+50h+Paint]
		push	edx		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		mov	esi, eax
		mov	eax, [ebp+18h]
		push	0		; bForceBkgd
		push	eax		; hPal
		push	esi		; hdc
		call	ds:SelectPalette
		push	esi		; hdc
		call	ds:RealizePalette
		lea	ecx, [esp+50h+Paint]
		push	ecx		; lpPaint
		push	edi		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		mov	eax, [esp+48h+var_44]
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_407446:				; CODE XREF: sub_407120+26j
		mov	edx, lpPrevWndFunc
		mov	esi, [esp+50h+hWnd]
		push	edx		; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetWindowLongA
		mov	eax, ho
		push	eax		; ho
		call	ds:DeleteObject
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		mov	eax, [esp+58h+var_44]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40748D:				; CODE XREF: sub_407120+1Dj
		mov	ecx, [esp+50h+arg_C]
		mov	esi, [esp+50h+hWnd]
		mov	edi, ds:SetWindowLongA
		mov	edx, [ecx+1Ch]
		push	edx		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	edi ; SetWindowLongA
		push	offset sub_4075E0 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	edi ; SetWindowLongA
		push	5		; nIndex
		mov	lpPrevWndFunc, eax
		call	ds:GetSysColor
		push	eax		; color
		call	ds:CreateSolidBrush
		pop	edi
		mov	ho, eax
		mov	eax, [esp+4Ch+var_44]
		pop	esi
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_4074E0:				; CODE XREF: sub_407120+17j
		sub	eax, 111h
		jz	loc_407571
		sub	eax, 22h
		jnz	loc_4075AC
		mov	esi, [esp+50h+hWnd]
		mov	edi, ds:GetDlgItem
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, [esp+50h+arg_C]
		cmp	ebp, eax
		jz	short loc_40751E
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		cmp	ebp, eax
		jnz	loc_4075AC

loc_40751E:				; CODE XREF: sub_407120+3ECj
		mov	esi, ds:GetSysColor
		push	5		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		mov	edi, dword ptr [esp+54h+String]
		push	edi		; hdc
		call	ds:SetBkColor
		mov	eax, dword_42F1BC
		test	eax, eax
		jz	short loc_407557
		push	5		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		mov	eax, ho
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_407557:				; CODE XREF: sub_407120+41Bj
		push	8		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		mov	eax, ho
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_407571:				; CODE XREF: sub_407120+3C5j
		cmp	word ptr [esp+50h+String], 46Eh
		jnz	short loc_4075AC
		mov	esi, [esp+50h+hWnd]
		push	46Eh		; nIDButton
		push	esi		; hDlg
		call	ds:IsDlgButtonChecked
		dec	eax
		push	1		; bErase
		neg	eax
		sbb	eax, eax
		push	0		; lpRect
		inc	eax
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		mov	dword_42F1BC, eax
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:InvalidateRect

loc_4075AC:				; CODE XREF: sub_407120+38j
					; sub_407120+60j ...
		mov	eax, [esp+50h+var_44]
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 44h
		retn	10h
sub_407120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4075C0	proc near		; CODE XREF: sub_407120+19Ep
					; sub_408DD0+1A6p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, dword_430850
		push	0
		push	eax
		push	ecx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	PGPNewSecureData
		add	esp, 0Ch
		retn
sub_4075C0	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_4075E0(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_4075E0	proc near		; DATA XREF: sub_407120+384o

hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		mov	eax, [esp+lParam]
		push	ebp
		mov	ebp, [esp+4+Msg]
		push	esi
		mov	esi, [esp+8+wParam]
		push	edi
		mov	edi, [esp+0Ch+hWnd]
		push	eax
		push	esi		; hdc
		push	ebp		; int
		push	edi		; hWnd
		call	sub_4076A0
		add	esp, 10h
		test	eax, eax
		jz	short loc_40760B
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------

loc_40760B:				; CODE XREF: sub_4075E0+21j
		cmp	ebp, 0Dh
		jz	short loc_407672
		cmp	ebp, 102h
		jnz	short loc_407682
		cmp	esi, 9
		jz	short loc_407642
		cmp	esi, 0Dh
		jnz	short loc_407682
		push	ebx
		mov	ebx, ds:GetParent
		push	edi		; hWnd
		call	ebx ; GetParent
		push	eax		; hWnd
		call	ebx ; GetParent
		push	0		; lParam
		push	1		; wParam
		push	471h		; Msg
		push	eax		; hWnd
		call	ds:PostMessageA
		pop	ebx
		jmp	short loc_407682
; ---------------------------------------------------------------------------

loc_407642:				; CODE XREF: sub_4075E0+3Bj
		push	10h		; nVirtKey
		call	ds:GetKeyState
		test	ah, 80h
		jz	short loc_40766B
		push	0BBh		; nIDDlgItem

loc_407654:				; CODE XREF: sub_4075E0+90j
		push	edi		; hWnd
		call	ds:GetParent
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		jmp	short loc_407682
; ---------------------------------------------------------------------------

loc_40766B:				; CODE XREF: sub_4075E0+6Dj
		push	46Eh
		jmp	short loc_407654
; ---------------------------------------------------------------------------

loc_407672:				; CODE XREF: sub_4075E0+2Ej
		mov	ecx, lpString
		mov	esi, dword_43040C
		mov	[esp+0Ch+lParam], ecx

loc_407682:				; CODE XREF: sub_4075E0+36j
					; sub_4075E0+40j ...
		mov	edx, [esp+0Ch+lParam]
		mov	eax, lpPrevWndFunc
		push	edx		; lParam
		push	esi		; wParam
		push	ebp		; Msg
		push	edi		; hWnd
		push	eax		; lpPrevWndFunc
		call	ds:CallWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		retn	10h
sub_4075E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4076A0(HWND hWnd, int, HDC hdc)
sub_4076A0	proc near		; CODE XREF: sub_4075E0+17p
					; sub_409460+2Ap ...

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
hdc		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		push	esi
		cmp	eax, 200h
		push	edi
		ja	loc_407757
		jz	loc_407797	; jumptable 004076C9 case 123
		add	eax, 0FFFFFFF9h	; switch 250 cases
		cmp	eax, 0F9h
		ja	short loc_4076FF ; jumptable 004076C9 default case
		xor	ecx, ecx
		mov	cl, ds:byte_4077B4[eax]
		jmp	ds:off_4077A0[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4076D0:				; CODE XREF: sub_4076A0+29j
					; DATA XREF: .text:off_4077A0o
		mov	esi, [esp+8+hdc] ; jumptable 004076C9 case 15
		test	esi, esi
		jz	short loc_4076FF ; jumptable 004076C9 default case
		mov	edi, ds:GetSysColor
		push	5		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	eax, dword_42F1BC
		test	eax, eax
		jz	short loc_407704
		push	5		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		push	esi		; hdc
		call	ds:SetTextColor

loc_4076FF:				; CODE XREF: sub_4076A0+1Fj
					; sub_4076A0+29j ...
		pop	edi		; jumptable 004076C9 default case
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407704:				; CODE XREF: sub_4076A0+51j
		push	8		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		push	esi		; hdc
		call	ds:SetTextColor
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407715:				; CODE XREF: sub_4076A0+29j
					; DATA XREF: .text:off_4077A0o
		push	10h		; jumptable 004076C9 case 256
		call	ds:GetKeyState
		test	ah, 80h
		jz	short loc_4076FF ; jumptable 004076C9 default case
		mov	eax, [esp+8+hdc]
		cmp	eax, 21h
		jb	short loc_4076FF ; jumptable 004076C9 default case
		cmp	eax, 28h
		ja	short loc_4076FF ; jumptable 004076C9 default case
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407738:				; CODE XREF: sub_4076A0+29j
					; DATA XREF: .text:off_4077A0o
		mov	edx, [esp+8+hWnd] ; jumptable 004076C9 case 7
		push	0FFFFh		; lParam
		push	0FFFFh		; wParam
		push	0B1h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407757:				; CODE XREF: sub_4076A0+Bj
		cmp	eax, 204h
		ja	short loc_407781
		cmp	eax, 203h
		jnb	short loc_407797 ; jumptable 004076C9 case 123
		cmp	eax, 201h
		jnz	short loc_4076FF ; jumptable 004076C9 default case
		push	10h		; nVirtKey
		call	ds:GetKeyState
		test	ah, 80h
		jz	short loc_4076FF ; jumptable 004076C9 default case
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_407781:				; CODE XREF: sub_4076A0+BCj
		cmp	eax, 300h
		jb	loc_4076FF	; jumptable 004076C9 default case
		cmp	eax, 303h
		ja	loc_4076FF	; jumptable 004076C9 default case

loc_407797:				; CODE XREF: sub_4076A0+11j
					; sub_4076A0+29j ...
		pop	edi		; jumptable 004076C9 case 123
		mov	eax, 1
		pop	esi
		retn
sub_4076A0	endp

; ---------------------------------------------------------------------------
		align 10h
off_4077A0	dd offset loc_407738, offset loc_4076D0, offset	loc_407797
					; DATA XREF: sub_4076A0+29r
		dd offset loc_407715, offset loc_4076FF	; jump table for switch	statement
byte_4077B4	db 0, 4, 4, 4, 4, 4, 4,	4, 1, 4, 4, 4, 4, 4, 4,	4, 4, 4
					; DATA XREF: sub_4076A0+23r
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4	; indirect table for switch statement
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 2, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	3
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_4078B0(HWND	hWnd, int, int,	UINT uID)
sub_4078B0	proc near		; DATA XREF: sub_405B80+1F9o

var_C8		= dword	ptr -0C8h
ThreadId	= dword	ptr -0C4h
Buffer		= byte ptr -0C0h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
uID		= dword	ptr  10h

		sub	esp, 0C8h
		mov	eax, [esp+0C8h+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 111h
		push	edi
		mov	[esp+0D8h+var_C8], ebp
		ja	loc_407C71
		jz	loc_407C00
		cmp	eax, 0Fh
		jz	loc_407B83
		cmp	eax, 4Eh
		jz	loc_407976
		cmp	eax, 110h
		jnz	loc_407F57	; jumptable 00407996 default case
		mov	eax, [esp+0D8h+uID]
		mov	edi, [esp+0D8h+hWnd]
		mov	esi, [eax+1Ch]
		push	esi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		lea	ecx, [esp+0D8h+Buffer]
		mov	dword ptr [esi+8Ch], 2Ah
		mov	edx, hModule
		push	80h		; cchBufferMax
		push	ecx		; lpBuffer
		push	2Ah		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+0D8h+Buffer]
		push	eax		; lpString
		push	408h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:SetDlgItemTextA
		lea	ecx, [esp+0D8h+ThreadId]
		mov	[esi+10h], edi
		push	ecx		; lpThreadId
		push	ebp		; dwCreationFlags
		push	esi		; int
		push	offset sub_408020 ; int
		push	ebp		; dwStackSize
		push	ebp		; lpThreadAttributes
		mov	dword ptr [esi+88h], 1
		call	__beginthreadex
		add	esp, 18h
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407976:				; CODE XREF: sub_4078B0+34j
		mov	edx, [esp+0D8h+uID]
		mov	eax, [edx+8]
		add	eax, 0D1h	; switch 10 cases
		cmp	eax, 9
		ja	loc_407F57	; jumptable 00407996 default case
		xor	ecx, ecx
		mov	cl, ds:byte_407F7C[eax]
		jmp	ds:off_407F68[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40799D:				; CODE XREF: sub_4078B0+E6j
					; DATA XREF: .text:off_407F68o
		mov	esi, [esp+0D8h+hWnd] ; jumptable 00407996 case -200
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	ebp		; lParam
		push	ebp		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		mov	edi, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	edx, [edi+14h]
		push	edx		; lParam
		push	ebp		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		push	ebp		; lpTimerFunc
		mov	ebx, 1
		push	64h		; uElapse
		push	929h		; nIDEvent
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	[edi+0A0h], ebx
		push	esi		; hWnd
		mov	dword_4303D8, ebx
		mov	dword_4303D0, ebp
		mov	dword_4303C8, ebp
		call	ds:SetTimer
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+0D0h+var_C8], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407A2C:				; CODE XREF: sub_4078B0+E6j
					; DATA XREF: .text:off_407F68o
		mov	ecx, hModule	; jumptable 00407996 case -201
		lea	eax, [esp+0D8h+Buffer]
		push	80h		; cchBufferMax
		push	eax		; lpBuffer
		push	47Dh		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		lea	edx, [esp+0D8h+Buffer]
		mov	esi, [esp+0D8h+hWnd]
		push	edx		; lpString
		push	408h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		mov	eax, dword_4303D8
		mov	dword_4303D0, 1
		cmp	eax, ebp
		jz	short loc_407A9E
		push	ebp		; lParam
		push	ebp		; wParam
		push	464h		; Msg
		push	413h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407A9E:				; CODE XREF: sub_4078B0+1C1j
		push	929h		; uIDEvent
		push	esi		; hWnd
		call	ds:KillTimer
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407ABB:				; CODE XREF: sub_4078B0+E6j
					; DATA XREF: .text:off_407F68o
		mov	eax, [esp+0D8h+hWnd] ; jumptable 00407996 case -205
		push	7DAh		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	eax		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407AE6:				; CODE XREF: sub_4078B0+E6j
					; DATA XREF: .text:off_407F68o
		mov	edi, [esp+0D8h+hWnd] ; jumptable 00407996 case -209
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	ebx, 1
		cmp	[esi+88h], ebp
		jz	short loc_407B67
		cmp	[esi+84h], ebp
		jnz	short loc_407B43
		push	24h		; int
		push	459h		; UINT
		push	44Dh		; uID
		push	edi		; hWnd
		call	sub_402000
		add	esp, 10h
		cmp	eax, 6
		jnz	short loc_407B43
		cmp	[esi+88h], ebp
		jz	short loc_407B67
		push	ebp		; lParam
		push	ebp		; wParam
		push	8061h		; Msg
		push	edi		; hWnd
		mov	[esi+84h], ebx
		call	ds:PostMessageA

loc_407B43:				; CODE XREF: sub_4078B0+25Bj
					; sub_4078B0+275j
		cmp	[esi+88h], ebp
		jz	short loc_407B67
		push	ebx		; dwNewLong
		push	ebp		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+0D0h+var_C8], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407B67:				; CODE XREF: sub_4078B0+253j
					; sub_4078B0+27Dj ...
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+0D0h+var_C8], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407B83:				; CODE XREF: sub_4078B0+2Bj
		mov	esi, [esp+0D8h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	short loc_407BCD
		lea	ecx, [esp+0D8h+Paint]
		push	ecx		; lpPaint
		push	esi		; hWnd
		call	ds:BeginPaint
		mov	edx, [ebx+18h]
		mov	edi, eax
		push	ebp		; bForceBkgd
		push	edx		; hPal
		push	edi		; hdc
		call	ds:SelectPalette
		push	edi		; hdc
		call	ds:RealizePalette
		lea	eax, [esp+0D8h+Paint]
		push	eax		; lpPaint
		push	esi		; hWnd
		call	ds:EndPaint

loc_407BCD:				; CODE XREF: sub_4078B0+2E8j
		cmp	dword_4303D8, ebp
		jnz	loc_407F57	; jumptable 00407996 default case
		push	ebx		; int
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	sub_406860
		mov	eax, [esp+0E0h+var_C8]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407C00:				; CODE XREF: sub_4078B0+22j
		mov	eax, [esp+0D8h+arg_8]
		mov	ecx, eax
		shr	ecx, 10h
		jnz	loc_407F57	; jumptable 00407996 default case
		cmp	ax, 475h
		jnz	short loc_407C45
		mov	edx, [esp+0D8h+hWnd]
		push	1		; bEnable
		push	476h		; nIDDlgItem
		push	edx		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407C45:				; CODE XREF: sub_4078B0+366j
		mov	eax, [esp+0D8h+hWnd]
		push	ebp		; bEnable
		push	476h		; nIDDlgItem
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407C71:				; CODE XREF: sub_4078B0+1Cj
		sub	eax, 113h
		jz	loc_407DE5
		sub	eax, 7F4Dh
		jz	loc_407D95
		dec	eax
		jnz	loc_407F57	; jumptable 00407996 default case
		mov	esi, [esp+0D8h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, dword_4303D8
		cmp	eax, ebp
		mov	ebp, ds:SendMessageA
		mov	ebx, 1
		jz	short loc_407CD7
		mov	eax, dword_4303D0
		test	eax, eax
		jz	short loc_407CFE
		push	0		; lParam
		push	0		; wParam
		push	466h		; Msg
		push	413h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ebp ; SendMessageA
		jmp	short loc_407CFE
; ---------------------------------------------------------------------------

loc_407CD7:				; CODE XREF: sub_4078B0+402j
		push	929h		; uIDEvent
		push	esi		; hWnd
		call	ds:KillTimer
		push	0		; bErase
		push	0		; lpRect
		push	esi		; hWnd
		mov	dword ptr [edi+9Ch], 0FFFFFFFFh
		mov	[edi+0A0h], ebx
		call	ds:InvalidateRect

loc_407CFE:				; CODE XREF: sub_4078B0+40Bj
					; sub_4078B0+425j
		mov	eax, [edi+84h]
		test	eax, eax
		jz	short loc_407D20
		mov	edx, hModule
		lea	ecx, [esp+0D8h+Buffer]
		push	80h
		push	ecx
		push	47Dh
		push	edx
		jmp	short loc_407D6B
; ---------------------------------------------------------------------------

loc_407D20:				; CODE XREF: sub_4078B0+456j
		mov	eax, [edi+0A8h]
		push	80h		; cchBufferMax
		test	eax, eax
		jz	short loc_407D5B
		mov	ecx, hModule
		lea	eax, [esp+0DCh+Buffer]
		push	eax		; lpBuffer
		push	45Ah		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		push	2		; lParam
		push	0		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	ebp ; SendMessageA
		jmp	short loc_407D71
; ---------------------------------------------------------------------------

loc_407D5B:				; CODE XREF: sub_4078B0+47Dj
		mov	eax, hModule
		lea	edx, [esp+0DCh+Buffer]
		push	edx		; lpBuffer
		push	81Ch		; uID
		push	eax		; hInstance

loc_407D6B:				; CODE XREF: sub_4078B0+46Ej
		call	ds:LoadStringA

loc_407D71:				; CODE XREF: sub_4078B0+4A9j
		lea	ecx, [esp+0D8h+Buffer]
		push	ecx		; lpString
		push	408h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		mov	[esp+0D0h+var_C8], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407D95:				; CODE XREF: sub_4078B0+3D1j
		mov	eax, [esp+0D8h+uID]
		mov	ecx, hModule
		lea	edx, [esp+0D8h+Buffer]
		push	80h		; cchBufferMax
		push	edx		; lpBuffer
		push	eax		; uID
		push	ecx		; hInstance
		mov	[esp+0E8h+var_C8], 1
		call	ds:LoadStringA
		lea	edx, [esp+0D8h+Buffer]
		mov	eax, [esp+0D8h+hWnd]
		push	edx		; lpString
		push	408h		; nIDDlgItem
		push	eax		; hDlg
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407DE5:				; CODE XREF: sub_4078B0+3C6j
		cmp	[esp+0D8h+arg_8], 929h
		jnz	loc_407F57	; jumptable 00407996 default case
		cmp	dword_4303D8, ebp
		jz	loc_407EF4
		mov	esi, [esp+0D8h+hWnd]
		push	929h		; uIDEvent
		push	esi		; hWnd
		call	ds:KillTimer
		mov	eax, dword_4303C8
		mov	ebx, 1
		cmp	eax, ebp
		mov	[esp+0D8h+var_C8], ebx
		jz	short loc_407E6B
		cmp	dword_4303D0, ebp
		jnz	loc_407F57	; jumptable 00407996 default case
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		mov	dword_4303D0, ebx
		call	ds:GetWindowLongA
		cmp	[eax+88h], ebp
		jnz	loc_407F57	; jumptable 00407996 default case
		push	ebp		; lParam
		push	ebp		; wParam
		push	8061h		; Msg
		push	esi		; hWnd
		call	ds:PostMessageA
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407E6B:				; CODE XREF: sub_4078B0+575j
		mov	edi, ds:GetDlgItem
		push	413h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	sub_407F90
		add	esp, 4
		cmp	eax, ebp
		mov	dword_4303D8, eax
		push	5		; nCmdShow
		jz	short loc_407EC5
		push	413h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ds:ShowWindow
		push	ebp		; lpTimerFunc
		push	2AF8h		; uElapse
		push	929h		; nIDEvent
		push	esi		; hWnd
		call	ds:SetTimer
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		mov	dword_4303C8, ebx
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407EC5:				; CODE XREF: sub_4078B0+5DBj
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ds:ShowWindow
		push	ebp		; lpTimerFunc
		push	64h		; uElapse
		push	929h		; nIDEvent
		push	esi		; hWnd
		call	ds:SetTimer
		pop	edi
		pop	esi
		mov	eax, [esp+0D0h+var_C8]
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
; ---------------------------------------------------------------------------

loc_407EF4:				; CODE XREF: sub_4078B0+54Cj
		mov	esi, [esp+0D8h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	ecx, [eax+0A0h]
		mov	edi, [eax+9Ch]
		add	edi, ecx
		mov	ecx, edi
		mov	[eax+9Ch], edi
		cmp	ecx, ebp
		jg	short loc_407F30
		mov	[eax+9Ch], ebp
		mov	dword ptr [eax+0A0h], 1
		jmp	short loc_407F49
; ---------------------------------------------------------------------------

loc_407F30:				; CODE XREF: sub_4078B0+66Cj
		cmp	ecx, 9
		jl	short loc_407F49
		mov	dword ptr [eax+9Ch], 9
		mov	dword ptr [eax+0A0h], 0FFFFFFFFh

loc_407F49:				; CODE XREF: sub_4078B0+67Ej
					; sub_4078B0+683j
		push	463h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_406810
		add	esp, 8

loc_407F57:				; CODE XREF: sub_4078B0+3Fj
					; sub_4078B0+D8j ...
		mov	eax, [esp+0D8h+var_C8] ; jumptable 00407996 default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C8h
		retn	10h
sub_4078B0	endp

; ---------------------------------------------------------------------------
off_407F68	dd offset loc_407AE6	; DATA XREF: sub_4078B0+E6r
		dd offset loc_407ABB	; jump table for switch	statement
		dd offset loc_407A2C
		dd offset loc_40799D
		dd offset loc_407F57
byte_407F7C	db	0,     4,     4,     4 ; DATA XREF: sub_4078B0+E0r
		db	1,     4,     4,     4 ; indirect table	for switch statement
		db	2,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_407F90(HWND hWnd)
sub_407F90	proc near		; CODE XREF: sub_4078B0+5CAp

Buffer		= byte ptr -124h
String1		= byte ptr -104h
hWnd		= dword	ptr  4

		sub	esp, 124h
		lea	eax, [esp+124h+String1]
		push	esi
		push	edi
		push	104h
		push	eax
		call	ds:PGPclGetPGPPath
		mov	edx, hModule
		add	esp, 8
		lea	ecx, [esp+12Ch+Buffer]
		push	20h		; cchBufferMax
		push	ecx		; lpBuffer
		push	485h		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+12Ch+Buffer]
		lea	ecx, [esp+12Ch+String1]
		push	eax		; lpString2
		push	ecx		; lpString1
		call	ds:lstrcatA
		mov	esi, [esp+12Ch+hWnd]
		mov	edi, ds:SendMessageA
		lea	edx, [esp+12Ch+String1]
		push	edx		; lParam
		push	0		; wParam
		push	464h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		test	eax, eax
		jz	short loc_408011
		push	0FFFF0000h	; lParam
		push	0FFFFFFFFh	; wParam
		push	465h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 124h
		retn
; ---------------------------------------------------------------------------

loc_408011:				; CODE XREF: sub_407F90+62j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 124h
		retn
sub_407F90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408020	proc near		; DATA XREF: sub_4078B0+9Eo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4

		sub	esp, 28h
		mov	ecx, dword_4303DC
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+34h+arg_0]
		lea	eax, [esp+34h+var_10]
		xor	ebx, ebx
		push	eax
		mov	esi, [edi]
		push	ecx
		mov	[esp+3Ch+var_14], 1
		mov	[esp+3Ch+var_18], ebx
		mov	[esp+3Ch+var_20], ebx
		mov	[esp+3Ch+var_1C], ebx
		mov	[esp+3Ch+var_28], ebx
		mov	[esp+3Ch+var_24], ebx
		call	PGPGetDefaultPrivateKey
		mov	eax, [esp+3Ch+var_10]
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_40806A
		mov	[esp+34h+var_14], ebx

loc_40806A:				; CODE XREF: sub_408020+44j
		mov	edx, [edi+20h]
		mov	eax, [edi+1Ch]
		push	ebp
		lea	ebp, [edi+24h]
		push	edx		; LPCSTR
		push	eax		; lpString
		push	ebp		; int
		call	sub_4085E0
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_4083EA
		cmp	dword ptr [edi+5Ch], 11h
		jnz	short loc_4080A0
		mov	edx, [ebp+0]
		lea	ecx, [edi+7Ch]
		push	ecx
		push	edx
		push	esi
		call	sub_408490
		add	esp, 0Ch

loc_4080A0:				; CODE XREF: sub_408020+6Dj
		mov	ecx, [edi+0Ch]
		lea	eax, [esp+38h+arg_0]
		push	eax
		push	6
		push	ecx
		call	sub_41B3D0
		mov	ecx, [edi+0Ch]
		lea	edx, [esp+44h+var_24]
		lea	eax, [esp+44h+var_18]
		push	edx
		push	eax
		push	260h
		push	ecx
		call	sub_41B0C0
		mov	ebx, [esp+54h+var_18]
		push	esi
		shr	ebx, 2
		call	PGPOLastOption
		add	esp, 20h
		push	eax
		push	edi
		push	offset loc_408660
		push	esi
		call	PGPOEventHandler
		mov	edx, [esp+48h+var_24]
		add	esp, 0Ch
		push	eax
		push	ebx
		push	edx
		push	esi
		call	PGPOPreferredAlgorithms
		add	esp, 0Ch
		push	eax
		mov	eax, [edi+68h]
		push	eax
		push	esi
		call	PGPOExpiration
		mov	ecx, [edi+28h]
		add	esp, 8
		push	eax
		push	ecx
		push	esi
		call	PGPOPassphrase
		mov	edx, [ebp+0]
		add	esp, 8
		push	eax
		push	edx		; lpString
		call	ds:lstrlenA
		push	eax
		mov	eax, [ebp+0]
		push	eax
		push	esi
		call	PGPOKeyGenName
		mov	ecx, [esp+58h+arg_0]
		add	esp, 0Ch
		push	eax
		push	ecx
		push	esi
		call	PGPOKeyGenFast
		mov	edx, [edi+60h]
		add	esp, 8
		push	eax
		mov	eax, [edi+5Ch]
		push	edx
		push	eax
		push	esi
		call	PGPOKeyGenParams
		mov	ecx, dword_4303DC
		add	esp, 0Ch
		push	eax
		push	ecx
		push	esi
		call	PGPOKeySetRef
		add	esp, 8
		lea	edx, [esp+58h+var_28]
		push	eax
		push	edx
		push	esi
		call	PGPBuildOptionList
		add	esp, 2Ch
		mov	ebx, eax
		test	ebx, ebx
		jnz	loc_4083EA
		mov	eax, [edi+2Ch]
		test	eax, eax
		jz	short loc_4081DD
		mov	ecx, [edi+30h]
		lea	edx, [esp+38h+var_20]
		neg	ecx
		sbb	cl, cl
		push	edx
		and	ecx, 80h
		push	eax
		mov	byte ptr [esp+40h+var_C], cl
		call	PGPNewSingletonKeySet
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	loc_4083EA
		push	esi
		call	PGPOLastOption
		mov	ecx, [esp+3Ch+var_20]
		add	esp, 4
		push	eax
		mov	eax, [esp+3Ch+var_C]
		push	eax
		push	ecx
		push	esi
		call	PGPOAdditionalRecipientRequestKeySet
		mov	edx, [esp+48h+var_28]
		add	esp, 0Ch
		push	eax
		push	edx
		call	PGPAppendOptionList
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_4083EA

loc_4081DD:				; CODE XREF: sub_408020+15Dj
		mov	eax, [edi+3Ch]
		test	eax, eax
		jz	short loc_408232
		cmp	dword ptr [edi+5Ch], 1
		jz	short loc_408232
		lea	ecx, [esp+38h+var_1C]
		push	ecx
		push	eax
		call	PGPNewSingletonKeySet
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	loc_4083EA
		push	esi
		call	PGPOLastOption
		mov	edx, [esp+3Ch+var_1C]
		add	esp, 4
		push	eax
		push	edx
		push	esi
		call	PGPORevocationKeySet
		add	esp, 8
		push	eax
		mov	eax, [esp+40h+var_28]
		push	eax
		call	PGPAppendOptionList
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_4083EA

loc_408232:				; CODE XREF: sub_408020+1C2j
					; sub_408020+1C8j
		push	esi
		lea	ebp, [edi+78h]
		call	PGPOLastOption
		mov	ecx, [esp+3Ch+var_28]
		push	eax
		push	ecx
		push	ebp
		push	esi
		call	PGPGenerateKey
		mov	ebx, eax
		add	esp, 14h
		cmp	ebx, 0FFFFD121h
		jnz	short loc_40825F
		mov	ebx, 0FFFFD12Dh
		jmp	loc_4083EA
; ---------------------------------------------------------------------------

loc_40825F:				; CODE XREF: sub_408020+233j
		test	ebx, ebx
		jnz	loc_4083EA
		cmp	dword ptr [edi+5Ch], 11h
		jnz	loc_4082FE
		push	esi
		call	PGPOLastOption
		add	esp, 4
		push	eax
		push	edi
		push	offset loc_408660
		push	esi
		call	PGPOEventHandler
		mov	edx, [edi+68h]
		add	esp, 0Ch
		push	eax
		push	edx
		push	esi
		call	PGPOExpiration
		add	esp, 8
		push	eax
		mov	eax, [edi+28h]
		push	eax
		push	esi
		call	PGPOPassphrase
		mov	ecx, [esp+4Ch+arg_0]
		add	esp, 8
		push	eax
		push	ecx
		push	esi
		call	PGPOKeyGenFast
		mov	edx, [edi+64h]
		add	esp, 8
		push	eax
		push	edx
		push	10h
		push	esi
		call	PGPOKeyGenParams
		add	esp, 0Ch
		push	eax
		mov	eax, [ebp+0]
		push	eax
		push	esi
		call	PGPOKeyGenMasterKey
		add	esp, 8
		lea	ecx, [esp+50h+var_4]
		push	eax
		push	ecx
		push	esi
		call	PGPGenerateSubKey
		mov	ebx, eax
		add	esp, 24h
		cmp	ebx, 0FFFFD121h
		jnz	short loc_4082F6
		mov	ebx, 0FFFFD12Dh
		jmp	loc_4083EA
; ---------------------------------------------------------------------------

loc_4082F6:				; CODE XREF: sub_408020+2CAj
		test	ebx, ebx
		jnz	loc_4083EA

loc_4082FE:				; CODE XREF: sub_408020+24Bj
		mov	eax, [edi+84h]
		test	eax, eax
		jnz	loc_4083EA
		mov	eax, [edi+34h]
		test	eax, eax
		jz	loc_4083A3
		lea	edx, [esp+38h+var_8]
		push	edx
		push	eax
		call	PGPGetPrimaryUserID
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_4083A3
		mov	ebx, [edi+38h]
		push	eax
		mov	eax, [edi+10h]
		neg	ebx
		sbb	ebx, ebx
		push	eax
		push	esi
		and	ebx, 2
		call	ds:PGPclRandom
		push	esi
		call	PGPOLastOption
		add	esp, 10h
		push	eax
		push	6
		push	ebx
		push	esi
		call	PGPOSigTrust
		add	esp, 0Ch
		push	eax
		push	0
		push	esi
		call	PGPOExportable
		add	esp, 8
		push	eax
		push	0
		push	esi
		call	PGPOExpiration
		mov	ecx, [edi+28h]
		add	esp, 8
		push	eax
		push	ecx
		push	esi
		call	PGPOPassphrase
		mov	edx, [ebp+0]
		add	esp, 8
		push	eax
		mov	eax, [esp+4Ch+var_8]
		push	edx
		push	eax
		call	PGPSignUserID
		mov	ebx, eax
		add	esp, 1Ch
		test	ebx, ebx
		jnz	short loc_4083A3
		mov	ecx, [edi+34h]
		push	6
		push	ecx
		call	PGPSetKeyTrust
		add	esp, 8

loc_4083A3:				; CODE XREF: sub_408020+2F1j
					; sub_408020+309j ...
		mov	edx, [edi+10h]
		mov	esi, ds:PGPclErrorBox
		push	ebx
		push	edx
		call	esi ; PGPclErrorBox
		add	esp, 8
		test	eax, eax
		jnz	short loc_4083EA
		mov	eax, dword_4303DC
		push	eax
		call	PGPCommitKeyRingChanges
		mov	ecx, [edi+10h]
		mov	ebx, eax
		push	ebx
		push	ecx
		call	esi ; PGPclErrorBox
		mov	eax, [esp+44h+var_14]
		add	esp, 0Ch
		test	eax, eax
		mov	dword ptr [edi+0A8h], 1
		jz	short loc_4083EA
		mov	dword ptr [edi+0A8h], 3

loc_4083EA:				; CODE XREF: sub_408020+63j
					; sub_408020+152j ...
		mov	eax, [esp+38h+var_24]
		pop	ebp
		test	eax, eax
		jz	short loc_408400
		mov	edx, [edi+0Ch]
		push	eax
		push	edx
		call	sub_41B260
		add	esp, 8

loc_408400:				; CODE XREF: sub_408020+3D1j
		mov	eax, [esp+34h+var_20]
		test	eax, eax
		jz	short loc_408411
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_408411:				; CODE XREF: sub_408020+3E6j
		mov	eax, [esp+34h+var_1C]
		test	eax, eax
		jz	short loc_408422
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_408422:				; CODE XREF: sub_408020+3F7j
		mov	eax, [esp+34h+var_28]
		test	eax, eax
		jz	short loc_408433
		push	eax
		call	PGPFreeOptionList
		add	esp, 4

loc_408433:				; CODE XREF: sub_408020+408j
		mov	eax, [edi+10h]
		push	ebx
		push	eax
		mov	dword ptr [edi+88h], 0
		call	ds:PGPclErrorBox
		mov	eax, [edi+84h]
		add	esp, 8
		test	eax, eax
		push	0		; lParam
		jz	short loc_408476
		mov	ecx, [edi+10h]
		push	5		; wParam
		push	471h		; Msg
		push	ecx		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_408476:				; CODE XREF: sub_408020+435j
		mov	edx, [edi+10h]
		push	0		; wParam
		push	8061h		; Msg
		push	edx		; hWnd
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 28h
		retn
sub_408020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408490	proc near		; CODE XREF: sub_408020+78p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 10h
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		lea	eax, [esp+10h+var_10]
		push	edi
		mov	edi, [esp+14h+arg_8]
		push	eax
		push	1
		push	ecx
		push	edx
		mov	[esp+24h+var_10], 0
		mov	[esp+24h+var_C], 0
		mov	dword ptr [edi], 0
		call	PGPNewUserIDStringFilter
		add	esp, 10h
		test	eax, eax
		jnz	loc_4085D7
		mov	ecx, [esp+14h+var_10]
		mov	edx, dword_4303DC
		lea	eax, [esp+14h+var_C]
		push	esi
		push	eax
		push	ecx
		push	edx
		call	PGPFilterKeySet
		mov	esi, eax
		mov	eax, [esp+24h+var_10]
		push	eax
		call	PGPFreeFilter
		add	esp, 10h
		test	esi, esi
		pop	esi
		jnz	loc_4085D7
		mov	eax, [esp+14h+var_C]
		test	eax, eax
		jz	loc_4085D7
		lea	ecx, [esp+14h+var_8]
		push	ecx
		push	0Eh
		push	eax
		call	PGPOrderKeySet
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_4085CA
		mov	eax, [esp+14h+var_8]
		lea	edx, [esp+14h+arg_0]
		push	edx
		push	eax
		call	PGPNewKeyIter
		add	esp, 8
		test	eax, eax
		jnz	loc_4085BD
		mov	edx, [esp+14h+arg_0]
		lea	ecx, [esp+14h+arg_4]
		push	ecx
		push	edx
		call	PGPKeyIterNext
		mov	eax, [esp+1Ch+arg_4]
		add	esp, 8
		test	eax, eax
		jz	short loc_4085B0

loc_408556:				; CODE XREF: sub_408490+11Ej
		cmp	dword ptr [edi], 0
		jnz	short loc_4085B0
		lea	ecx, [esp+14h+arg_8]
		push	ecx
		push	3Ch
		push	eax
		call	PGPGetKeyBoolean
		mov	al, byte ptr [esp+20h+arg_8]
		add	esp, 0Ch
		test	al, al
		jz	short loc_408596
		mov	eax, [esp+14h+arg_4]
		lea	edx, [esp+14h+var_4]
		push	edx
		push	14h
		push	eax
		call	PGPGetKeyNumber
		mov	eax, [esp+20h+var_4]
		add	esp, 0Ch
		cmp	eax, 1
		jnz	short loc_408596
		mov	ecx, [esp+14h+arg_4]
		mov	[edi], ecx

loc_408596:				; CODE XREF: sub_408490+E1j
					; sub_408490+FEj
		mov	eax, [esp+14h+arg_0]
		lea	edx, [esp+14h+arg_4]
		push	edx
		push	eax
		call	PGPKeyIterNext
		mov	eax, [esp+1Ch+arg_4]
		add	esp, 8
		test	eax, eax
		jnz	short loc_408556

loc_4085B0:				; CODE XREF: sub_408490+C4j
					; sub_408490+C9j
		mov	ecx, [esp+14h+arg_0]
		push	ecx
		call	PGPFreeKeyIter
		add	esp, 4

loc_4085BD:				; CODE XREF: sub_408490+A6j
		mov	edx, [esp+14h+var_8]
		push	edx
		call	PGPFreeKeyList
		add	esp, 4

loc_4085CA:				; CODE XREF: sub_408490+8Cj
		mov	eax, [esp+14h+var_C]
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_4085D7:				; CODE XREF: sub_408490+39j
					; sub_408490+68j ...
		pop	edi
		add	esp, 10h
		retn
sub_408490	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4085E0(int, LPCSTR lpString, LPCSTR)
sub_4085E0	proc near		; CODE XREF: sub_408020+57p

arg_0		= dword	ptr  4
lpString	= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+lpString]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ds:lstrlenA
		push	eax		; lpString
		xor	ebp, ebp
		call	edi ; lstrlenA
		mov	ebx, [esp+10h+arg_8]
		mov	esi, eax
		push	ebx		; lpString
		inc	esi
		call	edi ; lstrlenA
		test	eax, eax
		jz	short loc_40860D
		push	ebx		; lpString
		mov	ebp, 1
		call	edi ; lstrlenA
		lea	esi, [esi+eax+3]

loc_40860D:				; CODE XREF: sub_4085E0+1Fj
		push	esi		; size_t
		call	sub_40BEF0
		mov	ecx, [esp+14h+arg_0]
		add	esp, 4
		test	eax, eax
		mov	[ecx], eax
		jz	short loc_408653
		test	ebp, ebp
		jz	short loc_408640
		mov	edx, [esp+10h+lpString]
		push	ebx
		push	edx
		push	offset aSS	; "%s <%s>"
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_408640:				; CODE XREF: sub_4085E0+42j
		mov	ecx, [esp+10h+lpString]
		push	ecx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_408653:				; CODE XREF: sub_4085E0+3Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFD121h
		pop	ebx
		retn
sub_4085E0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_408660:				; DATA XREF: sub_408020+BAo
					; sub_408020+25Co
		mov	edx, [esp+8]
		push	ebx
		push	esi
		push	edi
		mov	eax, [edx+0Ch]
		xor	edi, edi
		cmp	eax, 11h
		jnz	short loc_4086BA
		mov	eax, [esp+18h]
		mov	ebx, [eax+84h]
		mov	ecx, [eax+8Ch]
		test	ebx, ebx
		mov	esi, ecx
		jnz	short loc_4086C0
		cmp	dword ptr [edx+10h], 20h
		jnz	short loc_40869E
		xor	edx, edx
		cmp	ecx, 2Ah
		setz	dl
		add	edx, 2Ah
		mov	[eax+8Ch], edx

loc_40869E:				; CODE XREF: .text:0040868Bj
		mov	ecx, [eax+8Ch]
		cmp	esi, ecx
		jz	short loc_4086BA
		mov	eax, [eax+10h]
		push	ecx
		push	0
		push	8060h
		push	eax
		call	ds:PostMessageA

loc_4086BA:				; CODE XREF: .text:0040866Fj
					; .text:004086A6j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4086C0:				; CODE XREF: .text:00408685j
		pop	edi
		pop	esi
		mov	eax, 0FFFFD134h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_4086D0(HWND	hWnd, int, int,	int)
sub_4086D0	proc near		; DATA XREF: sub_405B80+1E3o

var_4C		= dword	ptr -4Ch
var_48		= qword	ptr -48h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		sub	esp, 4Ch
		mov	eax, [esp+4Ch+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+5Ch+var_4C], ebp
		ja	loc_40894D
		jz	loc_40892A
		cmp	eax, 0Fh
		jz	loc_4088D7
		cmp	eax, 4Eh
		jnz	loc_4089E4	; jumptable 00408721 default case
		mov	eax, [esp+5Ch+arg_C]
		mov	eax, [eax+8]
		add	eax, 0D1h	; switch 10 cases
		cmp	eax, 9
		ja	loc_4089E4	; jumptable 00408721 default case
		xor	ecx, ecx
		mov	cl, ds:byte_408A08[eax]
		jmp	ds:off_4089F4[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_408728:				; CODE XREF: sub_4086D0+51j
					; DATA XREF: .text:off_4089F4o
		mov	edi, [esp+5Ch+hWnd] ; jumptable	00408721 case -200
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		push	ebp		; lParam
		push	ebp		; wParam
		push	470h		; Msg
		push	edi		; hWnd
		mov	esi, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	edx, [esi+14h]
		push	edx		; lParam
		push	ebp		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:SendDlgItemMessageA
		mov	ebx, [esi]
		lea	eax, [esp+5Ch+hWnd]
		mov	dword_430400, edi
		mov	ecx, [esi+0Ch]
		push	eax
		push	6
		push	ecx
		call	sub_41B3D0
		push	ebx
		call	PGPOLastOption
		mov	edx, [esp+6Ch+hWnd]
		add	esp, 10h
		push	eax
		push	edx
		push	ebx
		call	PGPOKeyGenFast
		mov	ecx, [esi+5Ch]
		add	esp, 8
		push	eax
		mov	eax, [esi+60h]
		push	eax
		push	ecx
		push	ebx
		call	PGPOKeyGenParams
		add	esp, 0Ch
		push	eax
		push	ebx
		call	PGPGetKeyEntropyNeeded
		mov	ebp, eax
		mov	eax, [esi+5Ch]
		add	esp, 10h
		cmp	eax, 11h
		jnz	short loc_4087EE
		push	ebx
		call	PGPOLastOption
		mov	edx, [esp+60h+hWnd]
		add	esp, 4
		push	eax
		push	edx
		push	ebx
		call	PGPOKeyGenFast
		add	esp, 8
		push	eax
		mov	eax, [esi+64h]
		push	eax
		push	10h
		push	ebx
		call	PGPOKeyGenParams
		mov	ecx, [esi]
		add	esp, 0Ch
		push	eax
		push	ecx
		call	PGPGetKeyEntropyNeeded
		add	esp, 10h
		add	ebp, eax

loc_4087EE:				; CODE XREF: sub_4086D0+E6j
		call	PGPGlobalRandomPoolGetSize
		cmp	ebp, eax
		jl	short loc_4087F9
		mov	ebp, eax

loc_4087F9:				; CODE XREF: sub_4086D0+125j
		mov	[esi+70h], ebp
		call	PGPGlobalRandomPoolGetEntropy
		mov	edx, [esi+70h]
		sub	edx, eax
		test	edx, edx
		jle	short loc_40885E
		call	PGPGlobalRandomPoolGetEntropy
		push	640000h		; lParam
		push	0		; wParam
		push	401h		; Msg
		mov	[esi+74h], eax
		mov	esi, ds:SendDlgItemMessageA
		push	463h		; nIDDlgItem
		push	edi		; hDlg
		call	esi ; SendDlgItemMessageA
		push	0		; lParam
		push	0		; wParam
		push	402h		; Msg
		push	463h		; nIDDlgItem
		push	edi		; hDlg
		call	esi ; SendDlgItemMessageA
		push	0		; dwNewLong
		push	0		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+54h+var_4C], 1
		pop	ebp
		mov	eax, [esp+50h+var_4C]
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_40885E:				; CODE XREF: sub_4086D0+138j
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+54h+var_4C], 1
		pop	ebp
		mov	eax, [esp+50h+var_4C]
		mov	dword_430400, 0
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_408889:				; CODE XREF: sub_4086D0+51j
					; DATA XREF: .text:off_4089F4o
		mov	eax, [esp+5Ch+hWnd] ; jumptable	00408721 case -201
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	eax		; hWnd
		call	ds:SetWindowLongA
		mov	[esp+5Ch+var_4C], 1

loc_40889E:				; CODE XREF: sub_4086D0+51j
					; DATA XREF: .text:off_4089F4o
		mov	eax, [esp+5Ch+var_4C] ;	jumptable 00408721 case	-209
		pop	edi
		mov	dword_430400, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4088B2:				; CODE XREF: sub_4086D0+51j
					; DATA XREF: .text:off_4089F4o
		mov	ecx, [esp+5Ch+hWnd] ; jumptable	00408721 case -205
		push	7D9h		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	ecx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+54h+var_4C]
		pop	ebp
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4088D7:				; CODE XREF: sub_4086D0+25j
		mov	edi, [esp+5Ch+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	loc_4089E4	; jumptable 00408721 default case
		lea	edx, [esp+5Ch+Paint]
		push	edx		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		mov	esi, eax
		mov	eax, [ebx+18h]
		push	ebp		; bForceBkgd
		push	eax		; hPal
		push	esi		; hdc
		call	ds:SelectPalette
		push	esi		; hdc
		call	ds:RealizePalette
		lea	ecx, [esp+5Ch+Paint]
		push	ecx		; lpPaint
		push	edi		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		mov	eax, [esp+54h+var_4C]
		pop	ebp
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_40892A:				; CODE XREF: sub_4086D0+1Cj
		mov	edx, [esp+5Ch+arg_C]
		mov	ecx, [esp+5Ch+hWnd]
		mov	eax, [edx+1Ch]
		push	eax		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	ecx		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	eax, [esp+54h+var_4C]
		pop	ebp
		pop	ebx
		add	esp, 4Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_40894D:				; CODE XREF: sub_4086D0+16j
		cmp	eax, 200h
		jnz	loc_4089E4	; jumptable 00408721 default case
		mov	ebx, [esp+5Ch+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	ebx		; hWnd
		call	ds:GetWindowLongA
		mov	esi, eax
		cmp	[esi+70h], ebp
		jz	short loc_4089E4 ; jumptable 00408721 default case
		call	PGPGlobalRandomPoolGetEntropy
		mov	dword ptr [esp+5Ch+var_48], eax
		mov	dword ptr [esp+5Ch+var_48+4], ebp
		fild	[esp+5Ch+var_48]
		fild	dword ptr [esi+74h]
		fstp	[esp+5Ch+hWnd]
		fsub	[esp+5Ch+hWnd]
		fild	dword ptr [esi+70h]
		fsub	[esp+5Ch+hWnd]
		fld	st(1)
		fdiv	st, st(1)
		fmul	ds:dbl_426800
		call	__ftol
		fxch	st(1)
		fcomp	st(1)
		mov	edi, eax
		fnstsw	ax
		test	ah, 1
		fstp	st
		jnz	short loc_4089D1
		push	3		; lParam
		push	ebp		; wParam
		push	470h		; Msg
		mov	[esi+70h], ebp
		push	ebx		; hWnd
		mov	edi, 64h
		mov	dword_430400, ebp
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:SendMessageA

loc_4089D1:				; CODE XREF: sub_4086D0+2DBj
		push	ebp		; lParam
		push	edi		; wParam
		push	402h		; Msg
		push	463h		; nIDDlgItem
		push	ebx		; hDlg
		call	ds:SendDlgItemMessageA

loc_4089E4:				; CODE XREF: sub_4086D0+2Ej
					; sub_4086D0+43j ...
		mov	eax, [esp+5Ch+var_4C] ;	jumptable 00408721 default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 4Ch
		retn	10h
sub_4086D0	endp

; ---------------------------------------------------------------------------
		align 4
off_4089F4	dd offset loc_40889E	; DATA XREF: sub_4086D0+51r
		dd offset loc_4088B2	; jump table for switch	statement
		dd offset loc_408889
		dd offset loc_408728
		dd offset loc_4089E4
byte_408A08	db	0,     4,     4,     4 ; DATA XREF: sub_4086D0+4Br
		db	1,     4,     4,     4 ; indirect table	for switch statement
		db	2,     3
		align 10h

loc_408A20:				; DATA XREF: sub_405B80+1CDo
		mov	eax, [esp+8]
		sub	esp, 114h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_408D7A
		cmp	eax, 4Eh
		jz	short loc_408A73
		cmp	eax, 110h
		jnz	loc_408DC1
		mov	eax, [esp+134h]
		mov	edx, [esp+128h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	edx
		call	ds:SetWindowLongA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 114h
		retn	10h
; ---------------------------------------------------------------------------

loc_408A73:				; CODE XREF: .text:00408A3Cj
		mov	eax, [esp+134h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_408D51
		cmp	eax, 0FFFFFF38h
		jnz	loc_408DC1
		mov	esi, [esp+128h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+58h]
		test	eax, eax
		jnz	short loc_408AC9
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 114h
		retn	10h
; ---------------------------------------------------------------------------

loc_408AC9:				; CODE XREF: .text:00408AAAj
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		mov	eax, [edi+48h]
		mov	ebx, ds:LoadStringA
		neg	eax
		sbb	eax, eax
		lea	edx, [esp+24h]
		and	al, 0FDh
		push	80h
		add	eax, 816h
		push	edx
		push	eax
		mov	eax, hModule
		push	eax
		call	ebx ; LoadStringA
		mov	ecx, [edi+4Ch]
		lea	edx, [esp+24h]
		push	ecx
		lea	eax, [esp+0A8h]
		push	edx
		push	eax
		call	ds:wsprintfA
		mov	ebp, ds:SetDlgItemTextA
		add	esp, 0Ch
		lea	ecx, [esp+0A4h]
		push	ecx
		push	426h
		push	esi
		call	ebp ; SetDlgItemTextA
		mov	eax, [edi+40h]
		lea	edx, [esp+24h]
		neg	eax
		sbb	eax, eax
		push	80h
		and	al, 0FDh
		push	edx
		add	eax, 817h
		push	eax
		mov	eax, hModule
		push	eax
		call	ebx ; LoadStringA
		mov	ecx, [edi+44h]
		lea	edx, [esp+24h]
		push	ecx
		lea	eax, [esp+0A8h]
		push	edx
		push	eax
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	ecx, [esp+0A4h]
		push	ecx
		push	43Dh
		push	esi
		call	ebp ; SetDlgItemTextA
		mov	ecx, [edi+48h]
		xor	eax, eax
		cmp	ecx, eax
		mov	[esp+14h], eax
		mov	[esp+20h], eax
		mov	[esp+1Ch], eax
		mov	[esp+18h], eax
		jz	short loc_408BB0
		test	byte ptr [edi+58h], 1
		jz	short loc_408BB0
		mov	ecx, 1
		mov	[esp+20h], ecx
		mov	[esp+14h], ecx
		jmp	short loc_408BB5
; ---------------------------------------------------------------------------

loc_408BB0:				; CODE XREF: .text:00408B99j
					; .text:00408B9Fj
		mov	ecx, 1

loc_408BB5:				; CODE XREF: .text:00408BAEj
		cmp	[edi+40h], eax
		jz	short loc_408BC8
		test	byte ptr [edi+58h], 2
		jz	short loc_408BC8
		mov	[esp+1Ch], ecx
		mov	[esp+14h], ecx

loc_408BC8:				; CODE XREF: .text:00408BB8j
					; .text:00408BBEj
		test	byte ptr [edi+58h], 4
		jz	short loc_408BD8
		mov	[esp+18h], ecx
		mov	[esp+14h], ecx
		jmp	short loc_408BDE
; ---------------------------------------------------------------------------

loc_408BD8:				; CODE XREF: .text:00408BCCj
		cmp	[esp+14h], eax
		jz	short loc_408C06

loc_408BDE:				; CODE XREF: .text:00408BD6j
		mov	eax, hModule
		lea	edx, [esp+24h]
		push	80h
		push	edx
		push	818h
		push	eax
		call	ebx ; LoadStringA
		lea	ecx, [esp+24h]
		push	ecx
		push	42Ch
		push	esi
		call	ebp ; SetDlgItemTextA
		push	1
		jmp	short loc_408C2C
; ---------------------------------------------------------------------------

loc_408C06:				; CODE XREF: .text:00408BDCj
		mov	eax, hModule
		lea	edx, [esp+24h]
		push	80h
		push	edx
		push	819h
		push	eax
		call	ebx ; LoadStringA
		lea	ecx, [esp+24h]
		push	ecx
		push	42Ch
		push	esi
		call	ebp ; SetDlgItemTextA
		push	3

loc_408C2C:				; CODE XREF: .text:00408C04j
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		test	byte ptr [edi+58h], 1
		mov	dword ptr [esp+10h], 0
		jz	short loc_408C67
		mov	eax, [esp+14h]
		test	eax, eax
		jz	short loc_408C5F
		mov	eax, [esp+20h]
		test	eax, eax
		jz	short loc_408C67

loc_408C5F:				; CODE XREF: .text:00408C55j
		mov	dword ptr [esp+10h], 5

loc_408C67:				; CODE XREF: .text:00408C4Dj
					; .text:00408C5Dj
		mov	edx, [esp+10h]
		mov	ebp, ds:GetDlgItem
		push	edx
		push	426h
		push	esi
		call	ebp ; GetDlgItem
		mov	ebx, ds:ShowWindow
		push	eax
		call	ebx ; ShowWindow
		mov	eax, [esp+10h]
		push	eax
		push	43Fh
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		mov	eax, [esp+10h]
		test	eax, eax
		jnz	short loc_408CD5
		test	byte ptr [edi+58h], 4
		jz	short loc_408CB9
		mov	eax, [esp+14h]
		test	eax, eax
		jz	short loc_408CB1
		mov	eax, [esp+18h]
		test	eax, eax
		jz	short loc_408CB9

loc_408CB1:				; CODE XREF: .text:00408CA7j
		mov	dword ptr [esp+10h], 5

loc_408CB9:				; CODE XREF: .text:00408C9Fj
					; .text:00408CAFj
		mov	ecx, [esp+10h]
		push	ecx
		push	428h
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		mov	edx, [esp+10h]
		push	edx
		push	43Fh
		jmp	short loc_408CDC
; ---------------------------------------------------------------------------

loc_408CD5:				; CODE XREF: .text:00408C99j
		push	0
		push	428h

loc_408CDC:				; CODE XREF: .text:00408CD3j
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		test	byte ptr [edi+58h], 2
		mov	dword ptr [esp+10h], 0
		jz	short loc_408D08
		mov	eax, [esp+14h]
		test	eax, eax
		jz	short loc_408D00
		mov	eax, [esp+1Ch]
		test	eax, eax
		jz	short loc_408D08

loc_408D00:				; CODE XREF: .text:00408CF6j
		mov	dword ptr [esp+10h], 5

loc_408D08:				; CODE XREF: .text:00408CEEj
					; .text:00408CFEj
		mov	eax, [esp+10h]
		push	eax
		push	43Dh
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		mov	edi, [esp+10h]
		push	edi
		push	43Eh
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		push	edi
		push	440h
		push	esi
		call	ebp ; GetDlgItem
		push	eax
		call	ebx ; ShowWindow
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 114h
		retn	10h
; ---------------------------------------------------------------------------

loc_408D51:				; CODE XREF: .text:00408A82j
		mov	ecx, [esp+128h]
		push	7D8h
		push	1
		push	offset szHelp
		push	ecx
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 114h
		retn	10h
; ---------------------------------------------------------------------------

loc_408D7A:				; CODE XREF: .text:00408A33j
		mov	edi, [esp+128h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_408DC1
		lea	edx, [esp+24h]
		push	edx
		push	edi
		call	ds:BeginPaint
		mov	esi, eax
		mov	eax, [ebx+18h]
		push	0
		push	eax
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	ecx, [esp+24h]
		push	ecx
		push	edi
		call	ds:EndPaint

loc_408DC1:				; CODE XREF: .text:00408A43j
					; .text:00408A8Dj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 114h
		retn	10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_408DD0(HWND	hWnd, int, HDC hdc, int)
sub_408DD0	proc near		; DATA XREF: sub_405B80+1B7o

var_248		= dword	ptr -248h
String		= byte ptr -244h
Paint		= tagPAINTSTRUCT ptr -240h
Buffer		= byte ptr -200h
var_100		= byte ptr -100h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
hdc		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 248h
		mov	eax, [esp+248h+arg_4]
		push	ebx
		push	ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+258h+var_248], 0
		ja	loc_409333
		jz	loc_409273
		sub	eax, 2
		jz	loc_409202
		sub	eax, 0Dh
		jz	loc_4091A6
		sub	eax, 3Fh
		jnz	loc_409429	; jumptable 00408E2D default case
		mov	eax, [esp+258h+arg_C]
		mov	eax, [eax+8]
		add	eax, 0CFh	; switch 8 cases
		cmp	eax, 7
		ja	loc_409429	; jumptable 00408E2D default case
		jmp	ds:off_40943C[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_408E34:				; CODE XREF: sub_408DD0+5Dj
					; DATA XREF: .text:off_40943Co
		mov	esi, [esp+258h+hWnd] ; jumptable 00408E2D case -200
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	3		; lParam
		push	0		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		mov	ebp, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	ecx, [ebp+14h]
		mov	edi, ds:SendDlgItemMessageA
		push	ecx		; lParam
		push	0		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		push	0		; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		push	1		; uCheck
		push	46Eh		; nIDButton
		push	esi		; hDlg
		mov	dword_42F1BC, 1
		call	ds:CheckDlgButton
		mov	eax, [ebp+40h]
		test	eax, eax
		jz	short loc_408EC9
		push	640000h		; lParam
		push	0		; wParam
		push	401h		; Msg
		push	431h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		mov	edx, [ebp+44h]
		push	0		; lParam
		push	edx		; wParam
		push	402h		; Msg
		push	431h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		jmp	short loc_408EEF
; ---------------------------------------------------------------------------

loc_408EC9:				; CODE XREF: sub_408DD0+CEj
		mov	ebp, ds:GetDlgItem
		push	0		; nCmdShow
		push	431h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		mov	ebx, ds:ShowWindow
		push	eax		; hWnd
		call	ebx ; ShowWindow
		push	0		; nCmdShow
		push	442h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ebx ; ShowWindow

loc_408EEF:				; CODE XREF: sub_408DD0+F7j
		push	640000h		; lParam
		push	0		; wParam
		push	401h		; Msg
		push	430h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		push	0		; lParam
		push	0		; wParam
		push	402h		; Msg
		push	430h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		pop	edi
		pop	esi
		mov	[esp+250h+var_248], 1
		pop	ebp
		mov	eax, [esp+24Ch+var_248]
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_408F2D:				; CODE XREF: sub_408DD0+5Dj
					; DATA XREF: .text:off_40943Co
		mov	esi, [esp+258h+hWnd] ; jumptable 00408E2D case -207
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		mov	ebp, eax
		mov	eax, lpString
		test	eax, eax
		jz	short loc_408F5B
		push	eax		; lpString
		call	sub_405F70
		add	esp, 4
		mov	lpString, 0

loc_408F5B:				; CODE XREF: sub_408DD0+176j
		mov	edi, ds:SendDlgItemMessageA
		push	0		; lParam
		push	0		; wParam
		push	0Eh		; Msg
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		inc	eax
		push	eax
		mov	dword_43040C, eax
		call	sub_4075C0
		mov	ebx, ds:GetDlgItemTextA
		add	esp, 4
		test	eax, eax
		mov	lpString, eax
		jz	short loc_408F9C
		lea	eax, [esp+258h+String]
		push	4		; cchMax
		push	eax		; lpString
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItemTextA

loc_408F9C:				; CODE XREF: sub_408DD0+1BBj
		mov	eax, dword_430408
		test	eax, eax
		jz	short loc_408FB8
		push	eax		; lpString
		call	sub_405F70
		add	esp, 4
		mov	dword_430408, 0

loc_408FB8:				; CODE XREF: sub_408DD0+1D3j
		push	0		; lParam
		push	0		; wParam
		push	0Eh		; Msg
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		inc	eax
		push	eax
		mov	dword_430410, eax
		call	sub_4075C0
		xor	edi, edi
		add	esp, 4
		cmp	eax, edi
		mov	dword_430408, eax
		jz	short loc_408FF4
		lea	ecx, [esp+258h+String]
		push	4		; cchMax
		push	ecx		; lpString
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItemTextA
		mov	eax, dword_430408

loc_408FF4:				; CODE XREF: sub_408DD0+20Ej
		mov	ecx, lpString
		cmp	ecx, edi
		jz	loc_409122
		cmp	eax, edi
		jz	loc_40910A
		mov	[ebp+58h], edi
		mov	edi, dword_430408
		mov	eax, lpString

loc_409018:				; CODE XREF: sub_408DD0+26Aj
		mov	dl, [eax]
		mov	bl, [edi]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_409040
		test	cl, cl
		jz	short loc_40903C
		mov	dl, [eax+1]
		mov	bl, [edi+1]
		mov	cl, dl
		cmp	dl, bl
		jnz	short loc_409040
		add	eax, 2
		add	edi, 2
		test	cl, cl
		jnz	short loc_409018

loc_40903C:				; CODE XREF: sub_408DD0+254j
		xor	eax, eax
		jmp	short loc_409045
; ---------------------------------------------------------------------------

loc_409040:				; CODE XREF: sub_408DD0+250j
					; sub_408DD0+260j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_409045:				; CODE XREF: sub_408DD0+26Ej
		test	eax, eax
		jz	short loc_409050
		mov	dword ptr [ebp+58h], 4

loc_409050:				; CODE XREF: sub_408DD0+277j
		mov	eax, lpString
		push	eax		; lpString
		call	ds:lstrlenA
		cmp	eax, [ebp+4Ch]
		jge	short loc_409069
		mov	eax, [ebp+58h]
		or	al, 1
		mov	[ebp+58h], eax

loc_409069:				; CODE XREF: sub_408DD0+28Fj
		mov	ecx, lpString
		push	ecx
		call	PGPEstimatePassphraseQuality
		mov	ecx, [ebp+44h]
		add	esp, 4
		cmp	eax, ecx
		jge	short loc_409087
		mov	eax, [ebp+58h]
		or	al, 2
		mov	[ebp+58h], eax

loc_409087:				; CODE XREF: sub_408DD0+2ADj
		mov	eax, [ebp+28h]
		test	eax, eax
		jz	short loc_40909E
		push	eax		; lpString
		call	sub_405F70
		add	esp, 4
		mov	dword ptr [ebp+28h], 0

loc_40909E:				; CODE XREF: sub_408DD0+2BCj
		mov	edx, dword_43040C
		push	edx
		call	sub_4075C0
		add	esp, 4
		mov	[ebp+28h], eax
		mov	ecx, lpString
		push	ecx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		add	esp, 10h
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		push	0		; dwNewLong
		push	0		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	ecx, lpString
		mov	eax, dword_430408
		mov	[esp+258h+var_248], 1
		xor	edi, edi

loc_40910A:				; CODE XREF: sub_408DD0+234j
		cmp	ecx, edi
		jz	short loc_409122
		push	ecx		; lpString
		call	sub_405F70
		mov	eax, dword_430408
		add	esp, 4
		mov	lpString, edi

loc_409122:				; CODE XREF: sub_408DD0+22Cj
					; sub_408DD0+33Cj
		cmp	eax, edi
		jz	loc_409429	; jumptable 00408E2D default case
		push	eax		; lpString
		call	sub_405F70
		mov	eax, [esp+25Ch+var_248]
		add	esp, 4
		mov	dword_430408, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_40914A:				; CODE XREF: sub_408DD0+5Dj
					; DATA XREF: .text:off_40943Co
		mov	esi, [esp+258h+hWnd] ; jumptable 00408E2D case -206
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		mov	eax, [esp+268h+var_248]
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_40917B:				; CODE XREF: sub_408DD0+5Dj
					; DATA XREF: .text:off_40943Co
		mov	edx, [esp+258h+hWnd] ; jumptable 00408E2D case -205
		push	7D7h		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	edx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+250h+var_248]
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_4091A6:				; CODE XREF: sub_408DD0+36j
		mov	edi, [esp+258h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	loc_409429	; jumptable 00408E2D default case
		lea	eax, [esp+258h+Paint]
		push	eax		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	0		; bForceBkgd
		push	ecx		; hPal
		push	esi		; hdc
		call	ds:SelectPalette
		push	esi		; hdc
		call	ds:RealizePalette
		lea	edx, [esp+258h+Paint]
		push	edx		; lpPaint
		push	edi		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		mov	eax, [esp+250h+var_248]
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_409202:				; CODE XREF: sub_408DD0+2Dj
		mov	eax, lpPrevWndFunc
		mov	esi, [esp+258h+hWnd]
		mov	edi, ds:GetDlgItem
		push	eax		; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebx, ds:SetWindowLongA
		push	eax		; hWnd
		call	ebx ; SetWindowLongA
		mov	ecx, dword_4303FC
		push	ecx		; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ebx ; SetWindowLongA
		mov	edx, dword_4303F4
		push	edx		; ho
		call	ds:DeleteObject
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	sub_4113C0
		mov	eax, [esp+268h+var_248]
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_409273:				; CODE XREF: sub_408DD0+24j
		mov	eax, [esp+258h+arg_C]
		mov	esi, [esp+258h+hWnd]
		mov	ebx, ds:SetWindowLongA
		mov	edi, [eax+1Ch]
		push	edi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ebx ; SetWindowLongA
		mov	ebp, ds:GetDlgItem
		push	offset sub_409460 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ebx ; SetWindowLongA
		push	offset loc_4095C0 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		mov	lpPrevWndFunc, eax
		call	ebp ; GetDlgItem
		push	eax		; hWnd
		call	ebx ; SetWindowLongA
		push	5		; nIndex
		mov	dword_4303FC, eax
		call	ds:GetSysColor
		push	eax		; color
		call	ds:CreateSolidBrush
		mov	edx, hModule
		lea	ecx, [esp+258h+Buffer]
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		push	824h		; uID
		push	edx		; hInstance
		mov	dword_4303F4, eax
		call	ds:LoadStringA
		mov	eax, [edi+4Ch]
		lea	ecx, [esp+258h+Buffer]
		push	eax
		lea	edx, [esp+25Ch+var_100]
		push	ecx		; LPCSTR
		push	edx		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [esp+258h+var_100]
		push	eax		; lpString
		push	43Ah		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		mov	eax, [esp+250h+var_248]
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_409333:				; CODE XREF: sub_408DD0+1Ej
		sub	eax, 111h
		jz	loc_4093D5
		sub	eax, 22h
		jnz	loc_409429	; jumptable 00408E2D default case
		mov	esi, [esp+258h+hWnd]
		mov	edi, ds:GetDlgItem
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebx, [esp+258h+arg_C]
		cmp	ebx, eax
		jz	short loc_409377
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		cmp	ebx, eax
		jnz	loc_409429	; jumptable 00408E2D default case

loc_409377:				; CODE XREF: sub_408DD0+595j
		mov	esi, ds:GetSysColor
		push	5		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		mov	edi, [esp+25Ch+hdc]
		push	edi		; hdc
		call	ds:SetBkColor
		mov	eax, dword_42F1BC
		test	eax, eax
		jz	short loc_4093B7
		push	5		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		mov	eax, dword_4303F4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_4093B7:				; CODE XREF: sub_408DD0+5C7j
		push	8		; nIndex
		call	esi ; GetSysColor
		push	eax		; color
		push	edi		; hdc
		call	ds:SetTextColor
		mov	eax, dword_4303F4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
; ---------------------------------------------------------------------------

loc_4093D5:				; CODE XREF: sub_408DD0+568j
		cmp	word ptr [esp+258h+hdc], 46Eh
		jnz	short loc_409429 ; jumptable 00408E2D default case
		mov	esi, [esp+258h+hWnd]
		push	46Eh		; nIDButton
		push	esi		; hDlg
		call	ds:IsDlgButtonChecked
		mov	edi, ds:GetDlgItem
		dec	eax
		neg	eax
		sbb	eax, eax
		push	1		; bErase
		push	0		; lpRect
		inc	eax
		push	479h		; nIDDlgItem
		push	esi		; hDlg
		mov	dword_42F1BC, eax
		call	edi ; GetDlgItem
		mov	ebx, ds:InvalidateRect
		push	eax		; hWnd
		call	ebx ; InvalidateRect
		push	1		; bErase
		push	0		; lpRect
		push	46Ch		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ebx ; InvalidateRect

loc_409429:				; CODE XREF: sub_408DD0+3Fj
					; sub_408DD0+57j ...
		mov	eax, [esp+258h+var_248]	; jumptable 00408E2D default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 248h
		retn	10h
sub_408DD0	endp

; ---------------------------------------------------------------------------
		align 4
off_40943C	dd offset loc_408F2D	; DATA XREF: sub_408DD0+5Dr
		dd offset loc_40914A	; jump table for switch	statement
		dd offset loc_40917B
		dd offset loc_409429
		dd offset loc_409429
		dd offset loc_409429
		dd offset loc_409429
		dd offset loc_408E34
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_409460(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_409460	proc near		; DATA XREF: sub_408DD0+4C6o

var_100		= dword	ptr -100h
hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		sub	esp, 100h
		push	ebx
		mov	ebx, [esp+104h+lParam]
		push	ebp
		mov	ebp, [esp+108h+Msg]
		push	esi
		mov	esi, [esp+10Ch+hWnd]
		push	edi
		mov	edi, [esp+110h+wParam]
		push	ebx
		push	edi		; hdc
		push	ebp		; int
		push	esi		; hWnd
		call	sub_4076A0
		add	esp, 10h
		test	eax, eax
		jz	short loc_4094A5
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 100h
		retn	10h
; ---------------------------------------------------------------------------

loc_4094A5:				; CODE XREF: sub_409460+34j
		cmp	ebp, 0Dh
		jz	loc_409587
		cmp	ebp, 102h
		jnz	loc_409593
		cmp	edi, 9
		jz	loc_409557
		cmp	edi, 0Dh
		jz	short loc_409537
		mov	eax, lpPrevWndFunc
		push	ebx		; lParam
		push	edi		; wParam
		mov	edi, ds:CallWindowProcA
		push	ebp		; Msg
		push	esi		; hWnd
		push	eax		; lpPrevWndFunc
		call	edi ; CallWindowProcA
		mov	edx, lpPrevWndFunc
		lea	ecx, [esp+110h+var_100]
		push	ecx		; lParam
		push	100h		; wParam
		push	0Dh		; Msg
		push	esi		; hWnd
		push	edx		; lpPrevWndFunc
		mov	ebx, eax
		call	edi ; CallWindowProcA
		lea	eax, [esp+110h+var_100]
		push	eax
		call	PGPEstimatePassphraseQuality
		add	esp, 4
		mov	edx, eax
		xor	eax, eax
		mov	ecx, 40h
		push	eax		; lParam
		push	edx		; wParam
		lea	edi, [esp+118h+var_100]
		push	402h		; Msg
		push	430h		; nIDDlgItem
		push	esi		; hWnd
		rep stosd
		call	ds:GetParent
		push	eax		; hDlg
		call	ds:SendDlgItemMessageA
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 100h
		retn	10h
; ---------------------------------------------------------------------------

loc_409537:				; CODE XREF: sub_409460+66j
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:GetParent
		push	0		; lParam
		push	1		; wParam
		push	471h		; Msg
		push	eax		; hWnd
		call	ds:PostMessageA
		jmp	short loc_409593
; ---------------------------------------------------------------------------

loc_409557:				; CODE XREF: sub_409460+5Dj
		push	10h		; nVirtKey
		call	ds:GetKeyState
		test	ah, 80h
		jz	short loc_409580
		push	41Fh		; nIDDlgItem

loc_409569:				; CODE XREF: sub_409460+125j
		push	esi		; hWnd
		call	ds:GetParent
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		jmp	short loc_409593
; ---------------------------------------------------------------------------

loc_409580:				; CODE XREF: sub_409460+102j
		push	46Ch
		jmp	short loc_409569
; ---------------------------------------------------------------------------

loc_409587:				; CODE XREF: sub_409460+48j
		mov	edi, dword_43040C
		mov	ebx, lpString

loc_409593:				; CODE XREF: sub_409460+54j
					; sub_409460+F5j ...
		mov	ecx, lpPrevWndFunc
		push	ebx		; lParam
		push	edi		; wParam
		push	ebp		; Msg
		push	esi		; hWnd
		push	ecx		; lpPrevWndFunc
		call	ds:CallWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 100h
		retn	10h
sub_409460	endp

; ---------------------------------------------------------------------------
		align 10h

loc_4095C0:				; DATA XREF: sub_408DD0+4D8o
		mov	eax, [esp+10h]
		push	ebp
		mov	ebp, [esp+0Ch]
		push	esi
		mov	esi, [esp+14h]
		push	edi
		mov	edi, [esp+10h]
		push	eax
		push	esi
		push	ebp
		push	edi
		call	sub_4076A0
		add	esp, 10h
		test	eax, eax
		jz	short loc_4095EB
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------

loc_4095EB:				; CODE XREF: .text:004095E1j
		cmp	ebp, 0Dh
		jz	short loc_409652
		cmp	ebp, 102h
		jnz	short loc_409662
		cmp	esi, 9
		jz	short loc_409622
		cmp	esi, 0Dh
		jnz	short loc_409662
		push	ebx
		mov	ebx, ds:GetParent
		push	edi
		call	ebx ; GetParent
		push	eax
		call	ebx ; GetParent
		push	0
		push	1
		push	471h
		push	eax
		call	ds:PostMessageA
		pop	ebx
		jmp	short loc_409662
; ---------------------------------------------------------------------------

loc_409622:				; CODE XREF: .text:004095FBj
		push	10h
		call	ds:GetKeyState
		test	ah, 80h
		jz	short loc_40964B
		push	479h

loc_409634:				; CODE XREF: .text:00409650j
		push	edi
		call	ds:GetParent
		push	eax
		call	ds:GetDlgItem
		push	eax
		call	ds:SetFocus
		jmp	short loc_409662
; ---------------------------------------------------------------------------

loc_40964B:				; CODE XREF: .text:0040962Dj
		push	46Eh
		jmp	short loc_409634
; ---------------------------------------------------------------------------

loc_409652:				; CODE XREF: .text:004095EEj
		mov	ecx, dword_430408
		mov	esi, dword_430410
		mov	[esp+1Ch], ecx

loc_409662:				; CODE XREF: .text:004095F6j
					; .text:00409600j ...
		mov	edx, [esp+1Ch]
		mov	eax, dword_4303FC
		push	edx
		push	esi
		push	ebp
		push	edi
		push	eax
		call	ds:CallWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

loc_409680:				; DATA XREF: sub_405B80+1A1o
		mov	eax, [esp+8]
		sub	esp, 144h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_4097DB
		cmp	eax, 4Eh
		jz	short loc_4096D3
		cmp	eax, 110h
		jnz	loc_409822
		mov	eax, [esp+164h]
		mov	edx, [esp+158h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	edx
		call	ds:SetWindowLongA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_4096D3:				; CODE XREF: .text:0040969Cj
		mov	eax, [esp+164h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_4097B2
		cmp	eax, 0FFFFFF38h
		jnz	loc_409822
		mov	esi, [esp+158h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+3Ch]
		test	eax, eax
		jz	loc_409795
		cmp	dword ptr [edi+5Ch], 1
		jz	short loc_409795
		push	3
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ecx, [edi+3Ch]
		lea	edx, [esp+10h]
		lea	eax, [esp+54h]
		push	edx
		push	eax
		push	100h
		push	ecx
		mov	dword ptr [esp+20h], 100h
		call	PGPGetPrimaryUserIDNameBuffer
		add	esp, 10h
		lea	edx, [esp+54h]
		push	edx
		push	44Bh
		push	esi
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409795:				; CODE XREF: .text:0040970Aj
					; .text:00409714j
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_4097B2:				; CODE XREF: .text:004096E2j
		mov	eax, [esp+158h]
		push	7DFh
		push	1
		push	offset szHelp
		push	eax
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_4097DB:				; CODE XREF: .text:00409693j
		mov	edi, [esp+158h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_409822
		lea	ecx, [esp+14h]
		push	ecx
		push	edi
		call	ds:BeginPaint
		mov	edx, [ebx+18h]
		mov	esi, eax
		push	0
		push	edx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	eax, [esp+14h]
		push	eax
		push	edi
		call	ds:EndPaint

loc_409822:				; CODE XREF: .text:004096A3j
					; .text:004096EDj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

loc_409840:				; DATA XREF: sub_405B80+18Bo
		mov	eax, [esp+8]
		sub	esp, 144h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_409991
		cmp	eax, 4Eh
		jz	short loc_409893
		cmp	eax, 110h
		jnz	loc_4099D8
		mov	eax, [esp+164h]
		mov	edx, [esp+158h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	edx
		call	ds:SetWindowLongA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409893:				; CODE XREF: .text:0040985Cj
		mov	eax, [esp+164h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_409968
		cmp	eax, 0FFFFFF38h
		jnz	loc_4099D8
		mov	esi, [esp+158h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+34h]
		test	eax, eax
		jz	short loc_40994B
		push	3
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ecx, [edi+34h]
		lea	edx, [esp+10h]
		lea	eax, [esp+54h]
		push	edx
		push	eax
		push	100h
		push	ecx
		mov	dword ptr [esp+20h], 100h
		call	PGPGetPrimaryUserIDNameBuffer
		add	esp, 10h
		lea	edx, [esp+54h]
		push	edx
		push	42Bh
		push	esi
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_40994B:				; CODE XREF: .text:004098CAj
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409968:				; CODE XREF: .text:004098A2j
		mov	eax, [esp+158h]
		push	7D6h
		push	1
		push	offset szHelp
		push	eax
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409991:				; CODE XREF: .text:00409853j
		mov	edi, [esp+158h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_4099D8
		lea	ecx, [esp+14h]
		push	ecx
		push	edi
		call	ds:BeginPaint
		mov	edx, [ebx+18h]
		mov	esi, eax
		push	0
		push	edx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	eax, [esp+14h]
		push	eax
		push	edi
		call	ds:EndPaint

loc_4099D8:				; CODE XREF: .text:00409863j
					; .text:004098ADj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

loc_4099F0:				; DATA XREF: sub_405B80+175o
		mov	eax, [esp+8]
		sub	esp, 144h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_409B4B
		cmp	eax, 4Eh
		jz	short loc_409A43
		cmp	eax, 110h
		jnz	loc_409B92
		mov	eax, [esp+164h]
		mov	edx, [esp+158h]
		mov	ecx, [eax+1Ch]
		push	ecx
		push	0FFFFFFEBh
		push	edx
		call	ds:SetWindowLongA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409A43:				; CODE XREF: .text:00409A0Cj
		mov	eax, [esp+164h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_409B22
		cmp	eax, 0FFFFFF38h
		jnz	loc_409B92
		mov	esi, [esp+158h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+2Ch]
		test	eax, eax
		jz	loc_409B05
		cmp	dword ptr [edi+5Ch], 1
		jz	short loc_409B05
		push	3
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ecx, [edi+2Ch]
		lea	edx, [esp+10h]
		lea	eax, [esp+54h]
		push	edx
		push	eax
		push	100h
		push	ecx
		mov	dword ptr [esp+20h], 100h
		call	PGPGetPrimaryUserIDNameBuffer
		add	esp, 10h
		lea	edx, [esp+54h]
		push	edx
		push	42Ah
		push	esi
		call	ds:SetDlgItemTextA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409B05:				; CODE XREF: .text:00409A7Aj
					; .text:00409A84j
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409B22:				; CODE XREF: .text:00409A52j
		mov	eax, [esp+158h]
		push	7D5h
		push	1
		push	offset szHelp
		push	eax
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------

loc_409B4B:				; CODE XREF: .text:00409A03j
		mov	edi, [esp+158h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_409B92
		lea	ecx, [esp+14h]
		push	ecx
		push	edi
		call	ds:BeginPaint
		mov	edx, [ebx+18h]
		mov	esi, eax
		push	0
		push	edx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	eax, [esp+14h]
		push	eax
		push	edi
		call	ds:EndPaint

loc_409B92:				; CODE XREF: .text:00409A13j
					; .text:00409A5Dj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 144h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

loc_409BB0:				; DATA XREF: sub_405B80+15Fo
		mov	eax, [esp+8]
		sub	esp, 60h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		ja	loc_409F3E
		jz	loc_409E32
		cmp	eax, 0Fh
		jz	loc_409DDE
		cmp	eax, 4Eh
		jnz	loc_40A008
		mov	eax, [esp+80h]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		ja	loc_409D21
		jz	loc_409CFE
		cmp	eax, 0FFFFFD09h
		jz	short loc_409C7A
		cmp	eax, 0FFFFFF31h
		jnz	loc_40A008
		mov	edi, [esp+74h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		push	477h
		push	edi
		mov	esi, eax
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_409C3E
		xor	eax, eax
		pop	edi
		mov	[esi+68h], eax
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409C3E:				; CODE XREF: .text:00409C2Bj
		mov	edx, [esi+6Ch]
		lea	ecx, [esp+10h]
		push	ecx
		push	0
		push	1001h
		push	edx
		call	ds:SendMessageA
		lea	eax, [esp+74h]
		lea	ecx, [esp+10h]
		push	eax
		push	ecx
		call	ds:PGPclSystemTimeToDays
		mov	eax, [esp+7Ch]
		add	esp, 8
		mov	[esi+68h], eax
		mov	eax, ebp
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409C7A:				; CODE XREF: .text:00409C00j
		mov	esi, [esp+74h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	eax, [eax+6Ch]
		lea	edx, [esp+10h]
		push	edx
		push	0
		push	1001h
		push	eax
		call	ds:SendMessageA
		lea	ecx, [esp+74h]
		lea	edx, [esp+10h]
		push	ecx
		push	edx
		call	ds:PGPclSystemTimeToDays
		mov	eax, [esp+7Ch]
		add	esp, 8
		test	eax, eax
		jle	short loc_409CDB
		push	3
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409CDB:				; CODE XREF: .text:00409CB6j
		push	1
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409CFE:				; CODE XREF: .text:00409BF5j
		mov	eax, [esp+74h]
		push	7D4h
		push	1
		push	offset szHelp
		push	eax
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409D21:				; CODE XREF: .text:00409BEFj
		cmp	eax, 0FFFFFF38h
		jnz	loc_40A008
		mov	esi, [esp+74h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	ebx, ds:GetParent
		push	3
		push	0
		push	470h
		push	esi
		mov	edi, eax
		call	ebx ; GetParent
		mov	ebp, ds:PostMessageA
		push	eax
		call	ebp ; PostMessageA
		mov	ecx, [edi+14h]
		push	ecx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		mov	eax, [edi+6Ch]
		lea	edx, [esp+10h]
		push	edx
		push	0
		push	1001h
		push	eax
		call	ds:SendMessageA
		lea	ecx, [esp+74h]
		lea	edx, [esp+10h]
		push	ecx
		push	edx
		call	ds:PGPclSystemTimeToDays
		mov	eax, [esp+7Ch]
		add	esp, 8
		test	eax, eax
		jg	short loc_409DB3
		push	477h
		push	esi
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jz	short loc_409DB3
		push	1
		jmp	short loc_409DB5
; ---------------------------------------------------------------------------

loc_409DB3:				; CODE XREF: .text:00409D9Cj
					; .text:00409DADj
		push	3

loc_409DB5:				; CODE XREF: .text:00409DB1j
		push	0
		push	470h
		push	esi
		call	ebx ; GetParent
		push	eax
		call	ebp ; PostMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409DDE:				; CODE XREF: .text:00409BD1j
		mov	edi, [esp+74h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	loc_40A008
		lea	eax, [esp+30h]
		push	eax
		push	edi
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	0
		push	ecx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	edx, [esp+30h]
		push	edx
		push	edi
		call	ds:EndPaint
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409E32:				; CODE XREF: .text:00409BC8j
		mov	eax, [esp+80h]
		mov	edi, [esp+74h]
		mov	esi, [eax+1Ch]
		push	esi
		push	0FFFFFFEBh
		push	edi
		call	ds:SetWindowLongA
		lea	ecx, [esp+20h]
		push	ecx
		push	444h
		push	edi
		call	ds:GetDlgItem
		push	eax
		call	ds:GetWindowRect
		lea	edx, [esp+20h]
		push	2
		push	edx
		push	edi
		push	0
		call	ds:MapWindowPoints
		mov	eax, hModule
		push	0
		mov	ecx, [esp+30h]
		mov	edx, [esp+2Ch]
		push	eax
		mov	eax, [esp+2Ch]
		push	0
		sub	ecx, eax
		push	edi
		push	ecx
		mov	ecx, [esp+34h]
		sub	edx, ecx
		push	edx
		push	eax
		push	ecx
		push	50810000h
		push	offset aDatetime ; "DateTime"
		push	offset aSysdatetimepic ; "SysDateTimePick32"
		push	0
		call	ds:CreateWindowExA
		push	0Fh
		mov	[esi+6Ch], eax
		call	ds:GetSysColor
		mov	ebx, ds:SendMessageA
		push	eax
		mov	eax, [esi+6Ch]
		push	4
		push	1006h
		push	eax
		call	ebx ; SendMessageA
		lea	ecx, [esp+10h]
		push	ecx
		call	ds:GetLocalTime
		inc	word ptr [esp+10h]
		mov	eax, [esi+6Ch]
		lea	edx, [esp+10h]
		push	edx
		push	0
		push	1002h
		push	eax
		call	ebx ; SendMessageA
		mov	eax, [esi+68h]
		push	1
		test	eax, eax
		jnz	short loc_409F1A
		push	477h
		push	edi
		call	ds:CheckDlgButton
		mov	ecx, [esi+6Ch]
		push	0
		push	ecx
		call	ds:EnableWindow
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409F1A:				; CODE XREF: .text:00409EF4j
		push	475h
		push	edi
		call	ds:CheckDlgButton
		mov	edx, [esi+6Ch]
		push	1
		push	edx
		call	ds:EnableWindow
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409F3E:				; CODE XREF: .text:00409BC2j
		cmp	eax, 111h
		jnz	loc_40A008
		mov	edi, [esp+74h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, [esp+7Ch]
		and	eax, 0FFFFh
		sub	eax, 444h
		jz	loc_409FFE
		sub	eax, 31h
		jz	short loc_409F7A
		sub	eax, 2
		jnz	loc_40A008

loc_409F7A:				; CODE XREF: .text:00409F6Fj
		push	475h
		push	edi
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_409FEE
		push	eax
		mov	eax, [esi+6Ch]
		push	eax
		call	ds:EnableWindow
		mov	edx, [esi+6Ch]
		lea	ecx, [esp+10h]
		push	ecx
		push	0
		push	1001h
		push	edx
		call	ds:SendMessageA
		lea	eax, [esp+74h]
		lea	ecx, [esp+10h]
		push	eax
		push	ecx
		call	ds:PGPclSystemTimeToDays
		mov	eax, [esp+7Ch]
		add	esp, 8
		test	eax, eax
		jle	short loc_409FCB
		push	3
		jmp	short loc_409FCD
; ---------------------------------------------------------------------------

loc_409FCB:				; CODE XREF: .text:00409FC5j
		push	1

loc_409FCD:				; CODE XREF: .text:00409FC9j
					; .text:00409FFCj
		push	0
		push	470h
		push	edi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------

loc_409FEE:				; CODE XREF: .text:00409F89j
		mov	edx, [esi+6Ch]
		push	0
		push	edx
		call	ds:EnableWindow
		push	3
		jmp	short loc_409FCD
; ---------------------------------------------------------------------------

loc_409FFE:				; CODE XREF: .text:00409F66j
		mov	eax, [esi+6Ch]
		push	eax
		call	ds:SetFocus

loc_40A008:				; CODE XREF: .text:00409BDAj
					; .text:00409C07j ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 60h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_40A020(HWND	hWnd, int, int,	int)
sub_40A020	proc near		; DATA XREF: sub_405B80+149o

var_C84		= dword	ptr -0C84h
Buffer		= byte ptr -0C80h
String		= byte ptr -0C40h
Caption		= byte ptr -0C00h
var_800		= byte ptr -800h
Text		= byte ptr -400h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0C84h
		mov	eax, [esp+0C84h+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 110h
		push	edi
		mov	[esp+0C94h+var_C84], ebp
		ja	loc_40A600
		jz	loc_40A475
		cmp	eax, 0Fh
		jz	loc_40A41C
		cmp	eax, 4Eh
		jnz	loc_40A68C
		mov	eax, [esp+0C94h+arg_C]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_40A3F1
		cmp	eax, 0FFFFFF37h
		jz	loc_40A27A
		cmp	eax, 0FFFFFF38h
		jnz	loc_40A68C
		mov	esi, [esp+0C94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	3		; lParam
		push	ebp		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		mov	ebx, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	ecx, [ebx+14h]
		push	ecx		; lParam
		push	ebp		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	eax, [ebx+5Ch]
		cmp	eax, 11h
		mov	[esp+0C94h+var_C84], 1
		jnz	loc_40A1BE
		mov	edi, ds:GetDlgItem
		push	5		; nCmdShow
		push	46Fh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, ds:ShowWindow
		push	eax		; hWnd
		call	ebp ; ShowWindow
		push	5		; nCmdShow
		push	421h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; ShowWindow
		mov	eax, hModule
		mov	edi, ds:LoadStringA
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	47Eh		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		mov	ecx, [ebx+54h]
		lea	edx, [esp+0C94h+Buffer]
		push	ecx
		lea	eax, [esp+0C98h+String]
		push	edx		; LPCSTR
		push	eax		; LPSTR
		call	ds:wsprintfA
		mov	ebx, ds:SetDlgItemTextA
		add	esp, 0Ch
		lea	ecx, [esp+0C94h+String]
		push	ecx		; lpString
		push	471h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		mov	eax, hModule
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	47Fh		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		lea	ecx, [esp+0C94h+Buffer]
		push	ecx		; lpString
		push	46Bh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		mov	eax, hModule
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	480h		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		lea	ecx, [esp+0C94h+Buffer]
		push	ecx		; lpString
		push	46Dh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		mov	eax, hModule
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	481h		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		lea	ecx, [esp+0C94h+Buffer]
		push	ecx		; lpString
		push	46Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A1BE:				; CODE XREF: sub_40A020+BAj
		mov	edi, ds:GetDlgItem
		push	ebp		; nCmdShow
		push	46Fh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, ds:ShowWindow
		push	eax		; hWnd
		call	ebp ; ShowWindow
		push	0		; nCmdShow
		push	421h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; ShowWindow
		mov	eax, hModule
		mov	edi, ds:LoadStringA
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	482h		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		mov	ecx, [ebx+54h]
		lea	edx, [esp+0C94h+Buffer]
		push	ecx
		lea	eax, [esp+0C98h+String]
		push	edx		; LPCSTR
		push	eax		; LPSTR
		call	ds:wsprintfA
		mov	ebx, ds:SetDlgItemTextA
		add	esp, 0Ch
		lea	ecx, [esp+0C94h+String]
		push	ecx		; lpString
		push	471h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		mov	eax, hModule
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	483h		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		lea	ecx, [esp+0C94h+Buffer]
		push	ecx		; lpString
		push	46Bh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		mov	eax, hModule
		lea	edx, [esp+0C94h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	484h		; uID
		push	eax		; hInstance
		call	edi ; LoadStringA
		lea	ecx, [esp+0C94h+Buffer]
		push	ecx		; lpString
		push	46Dh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; SetDlgItemTextA
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A27A:				; CODE XREF: sub_40A020+54j
		mov	edi, [esp+0C94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	esi, ds:IsDlgButtonChecked
		push	46Ah		; nIDButton
		push	edi		; hDlg
		mov	ebx, eax
		call	esi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A2A6
		mov	ebp, 400h
		jmp	short loc_40A301
; ---------------------------------------------------------------------------

loc_40A2A6:				; CODE XREF: sub_40A020+27Dj
		push	46Bh		; nIDButton
		push	edi		; hDlg
		call	esi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A2BA
		mov	ebp, 600h
		jmp	short loc_40A301
; ---------------------------------------------------------------------------

loc_40A2BA:				; CODE XREF: sub_40A020+291j
		push	46Dh		; nIDButton
		push	edi		; hDlg
		call	esi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A2CE
		mov	ebp, 800h
		jmp	short loc_40A301
; ---------------------------------------------------------------------------

loc_40A2CE:				; CODE XREF: sub_40A020+2A5j
		push	46Fh		; nIDButton
		push	edi		; hDlg
		call	esi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A2E2
		mov	ebp, 0C00h
		jmp	short loc_40A301
; ---------------------------------------------------------------------------

loc_40A2E2:				; CODE XREF: sub_40A020+2B9j
		push	471h		; nIDButton
		push	edi		; hDlg
		call	esi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A301
		push	0		; bSigned
		push	0		; lpTranslated
		push	473h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItemInt
		mov	ebp, eax

loc_40A301:				; CODE XREF: sub_40A020+284j
					; sub_40A020+298j ...
		mov	eax, [ebx+5Ch]
		mov	ecx, [ebx+54h]
		mov	esi, eax
		dec	esi
		neg	esi
		sbb	esi, esi
		and	esi, 800h
		add	esi, 800h
		cmp	ebp, ecx
		jb	short loc_40A35B
		cmp	ebp, esi
		ja	short loc_40A35B
		cmp	eax, 11h
		jnz	short loc_40A347
		push	ebp
		call	sub_40A6A0
		add	esp, 4
		mov	[ebx+64h], ebp
		mov	[ebx+60h], eax
		mov	eax, [esp+0C94h+var_C84]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A347:				; CODE XREF: sub_40A020+305j
		mov	eax, [esp+0C94h+var_C84]
		pop	edi
		mov	[ebx+60h], ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A35B:				; CODE XREF: sub_40A020+2FCj
					; sub_40A020+300j
		mov	eax, hModule
		mov	ebp, ds:LoadStringA
		lea	edx, [esp+0C94h+var_800]
		push	400h		; cchBufferMax
		push	edx		; lpBuffer
		push	44Ch		; uID
		push	eax		; hInstance
		call	ebp ; LoadStringA
		mov	edx, hModule
		lea	ecx, [esp+0C94h+Caption]
		push	400h		; cchBufferMax
		push	ecx		; lpBuffer
		push	44Dh		; uID
		push	edx		; hInstance
		call	ebp ; LoadStringA
		mov	eax, [ebx+54h]
		push	esi
		lea	ecx, [esp+0C98h+var_800]
		push	eax
		lea	edx, [esp+0C9Ch+Text]
		push	ecx		; LPCSTR
		push	edx		; LPSTR
		call	ds:wsprintfA
		add	esp, 10h
		lea	eax, [esp+0C94h+Caption]
		lea	ecx, [esp+0C94h+Text]
		push	10h		; uType
		push	eax		; lpCaption
		push	ecx		; lpText
		push	edi		; hWnd
		call	ds:MessageBoxA
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+0C8Ch+var_C84], 1
		pop	ebp
		mov	eax, [esp+0C88h+var_C84]
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A3F1:				; CODE XREF: sub_40A020+49j
		mov	edx, [esp+0C94h+hWnd]
		push	7D3h		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	edx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A41C:				; CODE XREF: sub_40A020+2Bj
		mov	edi, [esp+0C94h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	loc_40A68C
		lea	eax, [esp+0C94h+String]
		push	eax		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	ebp		; bForceBkgd
		push	ecx		; hPal
		push	esi		; hdc
		call	ds:SelectPalette
		push	esi		; hdc
		call	ds:RealizePalette
		lea	edx, [esp+0C94h+String]
		push	edx		; lpPaint
		push	edi		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A475:				; CODE XREF: sub_40A020+22j
		mov	eax, [esp+0C94h+arg_C]
		mov	esi, [esp+0C94h+hWnd]
		mov	edi, [eax+1Ch]
		push	edi		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		push	ebp		; lParam
		push	4		; wParam
		push	0C5h		; Msg
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		mov	ebx, ds:GetDlgItem
		push	ebp		; bEnable
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		mov	ebp, ds:EnableWindow
		push	eax		; hWnd
		call	ebp ; EnableWindow
		mov	eax, [edi+54h]
		mov	ecx, [edi+60h]
		cmp	ecx, eax
		jnb	short loc_40A4C9
		mov	[edi+60h], eax

loc_40A4C9:				; CODE XREF: sub_40A020+4A4j
		mov	ecx, [edi+60h]
		push	0		; bSigned
		push	ecx		; uValue
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SetDlgItemInt
		cmp	dword ptr [edi+54h], 400h
		jbe	short loc_40A4F1
		push	0		; bEnable
		push	46Ah		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow

loc_40A4F1:				; CODE XREF: sub_40A020+4C2j
		cmp	dword ptr [edi+54h], 600h
		jbe	short loc_40A507
		push	0		; bEnable
		push	46Bh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow

loc_40A507:				; CODE XREF: sub_40A020+4D8j
		cmp	dword ptr [edi+54h], 800h
		jbe	short loc_40A51D
		push	0		; bEnable
		push	46Dh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow

loc_40A51D:				; CODE XREF: sub_40A020+4EEj
		cmp	dword ptr [edi+54h], 0C00h
		jbe	short loc_40A533
		push	0		; bEnable
		push	46Fh		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow

loc_40A533:				; CODE XREF: sub_40A020+504j
		mov	edi, [edi+60h]
		cmp	edi, 800h
		ja	short loc_40A5AD
		jz	short loc_40A58E
		cmp	edi, 400h
		jz	short loc_40A56F
		cmp	edi, 600h
		jnz	short loc_40A5B5
		push	1		; uCheck
		push	46Bh		; nIDButton
		push	esi		; hDlg
		call	ds:CheckDlgButton
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A56F:				; CODE XREF: sub_40A020+526j
		push	1		; uCheck
		push	46Ah		; nIDButton
		push	esi		; hDlg
		call	ds:CheckDlgButton
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A58E:				; CODE XREF: sub_40A020+51Ej
		push	1		; uCheck
		push	46Dh		; nIDButton
		push	esi		; hDlg
		call	ds:CheckDlgButton
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A5AD:				; CODE XREF: sub_40A020+51Cj
		cmp	edi, 0C00h
		jz	short loc_40A5E1

loc_40A5B5:				; CODE XREF: sub_40A020+52Ej
		push	1		; uCheck
		push	471h		; nIDButton
		push	esi		; hDlg
		call	ds:CheckDlgButton
		push	1		; bEnable
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	ebx ; GetDlgItem
		push	eax		; hWnd
		call	ebp ; EnableWindow
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A5E1:				; CODE XREF: sub_40A020+593j
		push	1		; uCheck
		push	46Fh		; nIDButton
		push	esi		; hDlg
		call	ds:CheckDlgButton
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A600:				; CODE XREF: sub_40A020+1Cj
		cmp	eax, 111h
		jnz	loc_40A68C
		mov	eax, [esp+0C94h+arg_8]
		mov	edx, eax
		shr	edx, 10h
		jnz	short loc_40A68C
		cmp	ax, 471h
		jnz	short loc_40A671
		mov	esi, [esp+0C94h+hWnd]
		mov	edi, ds:GetDlgItem
		push	1		; bEnable
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		push	0FFFFFFFFh	; lParam
		push	ebp		; wParam
		push	0B1h		; Msg
		push	473h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		pop	edi
		pop	esi
		mov	eax, [esp+0C8Ch+var_C84]
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A671:				; CODE XREF: sub_40A020+5FDj
		mov	eax, [esp+0C94h+hWnd]
		push	ebp		; bEnable
		push	473h		; nIDDlgItem
		push	eax		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow

loc_40A68C:				; CODE XREF: sub_40A020+34j
					; sub_40A020+5Fj ...
		mov	eax, [esp+0C94h+var_C84]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0C84h
		retn	10h
sub_40A020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A6A0	proc near		; CODE XREF: sub_40A020+308p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 400h
		jbe	short locret_40A6B0
		mov	eax, 400h

locret_40A6B0:				; CODE XREF: sub_40A6A0+9j
		retn
sub_40A6A0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_40A6C0:				; DATA XREF: sub_405B80+133o
		mov	eax, [esp+8]
		sub	esp, 40h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		jz	loc_40A8B8
		cmp	eax, 4Eh
		jz	loc_40A777
		cmp	eax, 110h
		jnz	loc_40A8FC
		mov	eax, [esp+60h]
		mov	edi, [esp+54h]
		mov	esi, [eax+1Ch]
		push	esi
		push	0FFFFFFEBh
		push	edi
		call	ds:SetWindowLongA
		mov	eax, [esi+50h]
		test	eax, eax
		jnz	short loc_40A734
		mov	ebx, ds:GetDlgItem
		push	ebp
		push	468h
		push	edi
		mov	dword ptr [esi+5Ch], 11h
		call	ebx ; GetDlgItem
		push	eax
		call	ds:EnableWindow
		push	5
		push	420h
		push	edi
		call	ebx ; GetDlgItem
		push	eax
		call	ds:ShowWindow

loc_40A734:				; CODE XREF: .text:0040A704j
		mov	esi, [esi+5Ch]
		dec	esi
		jz	short loc_40A75D
		sub	esi, 10h
		jnz	loc_40A8FC
		push	1
		push	466h
		push	edi
		call	ds:CheckDlgButton
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A75D:				; CODE XREF: .text:0040A738j
		push	1
		push	468h
		push	edi
		call	ds:CheckDlgButton
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A777:				; CODE XREF: .text:0040A6D9j
		mov	ecx, [esp+60h]
		mov	eax, [ecx+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_40A895
		cmp	eax, 0FFFFFF37h
		jz	loc_40A81B
		cmp	eax, 0FFFFFF38h
		jnz	loc_40A8FC
		mov	esi, [esp+54h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, eax
		mov	eax, [edi+50h]
		test	eax, eax
		jnz	short loc_40A7D1
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A7D1:				; CODE XREF: .text:0040A7B3j
		push	3
		push	0
		push	470h
		push	esi
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	edx, [edi+14h]
		push	edx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A81B:				; CODE XREF: .text:0040A78Ej
		mov	esi, [esp+54h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	edi, ds:IsDlgButtonChecked
		push	468h
		push	esi
		mov	ebx, eax
		call	edi ; IsDlgButtonChecked
		mov	ebp, ds:SetWindowLongA
		cmp	eax, 1
		jnz	short loc_40A863
		mov	eax, 1

loc_40A848:				; CODE XREF: .text:0040A875j
		mov	[ebx+5Ch], eax

loc_40A84B:				; CODE XREF: .text:0040A893j
		push	0
		push	0
		push	esi
		call	ebp ; SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A863:				; CODE XREF: .text:0040A841j
		push	466h
		push	esi
		call	edi ; IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_40A877
		mov	eax, 11h
		jmp	short loc_40A848
; ---------------------------------------------------------------------------

loc_40A877:				; CODE XREF: .text:0040A86Ej
		push	10h
		push	44Eh
		push	44Dh
		push	esi
		call	sub_402000
		add	esp, 10h
		push	0FFFFFFFFh
		push	0
		push	esi
		call	ebp ; SetWindowLongA
		jmp	short loc_40A84B
; ---------------------------------------------------------------------------

loc_40A895:				; CODE XREF: .text:0040A783j
		mov	eax, [esp+54h]
		push	7D2h
		push	1
		push	offset szHelp
		push	eax
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A8B8:				; CODE XREF: .text:0040A6D0j
		mov	edi, [esp+54h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_40A8FC
		lea	ecx, [esp+10h]
		push	ecx
		push	edi
		call	ds:BeginPaint
		mov	edx, [ebx+18h]
		mov	esi, eax
		push	0
		push	edx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	eax, [esp+10h]
		push	eax
		push	edi
		call	ds:EndPaint

loc_40A8FC:				; CODE XREF: .text:0040A6E4j
					; .text:0040A73Dj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 40h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_40A910(HWND	hWnd, int, int,	int)
sub_40A910	proc near		; DATA XREF: sub_405B80+11Do

var_44		= dword	ptr -44h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		sub	esp, 44h
		mov	eax, [esp+44h+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 0Fh
		push	edi
		mov	[esp+54h+var_44], ebp
		jz	loc_40AB89
		cmp	eax, 4Eh
		jz	short loc_40A981
		cmp	eax, 110h
		jnz	loc_40ABCA	; jumptable 0040A99F default case
		mov	eax, [esp+54h+arg_C]
		mov	esi, [esp+54h+hWnd]
		mov	ecx, [eax+1Ch]
		push	ecx		; dwNewLong
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		mov	edi, ds:SendDlgItemMessageA
		push	ebp		; lParam
		push	7Eh		; wParam
		push	0C5h		; Msg
		push	465h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		push	ebp		; lParam
		push	7Eh		; wParam
		push	0C5h		; Msg
		push	467h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; SendDlgItemMessageA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A981:				; CODE XREF: sub_40A910+1Dj
		mov	edx, [esp+54h+arg_C]
		mov	ebx, 1
		mov	[esp+54h+arg_4], ebx
		mov	eax, [edx+8]
		add	eax, 0CFh	; switch 8 cases
		cmp	eax, 7
		ja	loc_40ABCA	; jumptable 0040A99F default case
		jmp	ds:off_40ABD8[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40A9A6:				; CODE XREF: sub_40A910+8Fj
					; DATA XREF: .text:off_40ABD8o
		mov	esi, [esp+54h+hWnd] ; jumptable	0040A99F case -200
		push	0FFFFFFEBh	; nIndex
		push	esi		; hWnd
		call	ds:GetWindowLongA
		push	3		; lParam
		push	ebp		; wParam
		push	470h		; Msg
		push	esi		; hWnd
		mov	edi, eax
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:PostMessageA
		mov	eax, [edi+14h]
		push	eax		; lParam
		push	ebp		; wParam
		push	172h		; Msg
		push	422h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:SendDlgItemMessageA
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	esi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+4Ch+var_44], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40A9FA:				; CODE XREF: sub_40A910+8Fj
					; DATA XREF: .text:off_40ABD8o
		mov	ecx, [esp+54h+hWnd] ; jumptable	0040A99F case -201
		push	ebp		; dwNewLong
		push	ebp		; nIndex
		push	ecx		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+4Ch+var_44], ebx
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AA17:				; CODE XREF: sub_40A910+8Fj
					; DATA XREF: .text:off_40ABD8o
		mov	edx, [esp+54h+hWnd] ; jumptable	0040A99F case -205
		push	7D1h		; dwData
		push	ebx		; uCommand
		push	offset szHelp	; lpszHelp
		push	edx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		mov	eax, [esp+4Ch+var_44]
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AA3B:				; CODE XREF: sub_40A910+8Fj
					; DATA XREF: .text:off_40ABD8o
		mov	edi, [esp+54h+hWnd] ; jumptable	0040A99F case -207
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+1Ch]
		cmp	eax, ebp
		jz	short loc_40AA5D
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		mov	[ebx+1Ch], ebp

loc_40AA5D:				; CODE XREF: sub_40A910+13Fj
		mov	eax, [ebx+20h]
		cmp	eax, ebp
		jz	short loc_40AA70
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		mov	[ebx+20h], ebp

loc_40AA70:				; CODE XREF: sub_40A910+152j
		push	ebp		; lParam
		push	ebp		; wParam
		mov	ebp, ds:SendDlgItemMessageA
		push	0Eh		; Msg
		push	465h		; nIDDlgItem
		push	edi		; hDlg
		call	ebp ; SendDlgItemMessageA
		mov	esi, eax
		inc	esi
		push	esi		; size_t
		call	sub_40BEF0
		add	esp, 4
		mov	[ebx+1Ch], eax
		test	eax, eax
		jz	short loc_40AAA3
		push	esi		; cchMax
		push	eax		; lpString
		push	465h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItemTextA

loc_40AAA3:				; CODE XREF: sub_40A910+183j
		cmp	esi, 1
		jg	short loc_40AAD5
		push	30h		; int
		push	456h		; UINT
		push	44Dh		; uID
		push	edi		; hWnd
		call	sub_402000
		add	esp, 10h
		push	465h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		jmp	loc_40AB68
; ---------------------------------------------------------------------------

loc_40AAD5:				; CODE XREF: sub_40A910+196j
		push	0		; lParam
		push	0		; wParam
		push	0Eh		; Msg
		push	467h		; nIDDlgItem
		push	edi		; hDlg
		call	ebp ; SendDlgItemMessageA
		mov	esi, eax
		inc	esi
		push	esi		; size_t
		call	sub_40BEF0
		xor	ebp, ebp
		add	esp, 4
		cmp	eax, ebp
		mov	[ebx+20h], eax
		jz	short loc_40AB06
		push	esi		; cchMax
		push	eax		; lpString
		push	467h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItemTextA

loc_40AB06:				; CODE XREF: sub_40A910+1E6j
		cmp	esi, 1
		jg	loc_40ABCA	; jumptable 0040A99F default case
		cmp	[ebx+94h], ebp
		jz	short loc_40AB2E
		push	30h		; int
		push	858h		; UINT
		push	44Dh		; uID
		push	edi		; hWnd
		call	sub_402000
		add	esp, 10h
		jmp	short loc_40AB4B
; ---------------------------------------------------------------------------

loc_40AB2E:				; CODE XREF: sub_40A910+205j
		push	134h		; int
		push	455h		; UINT
		push	44Dh		; uID
		push	edi		; hWnd
		call	sub_402000
		add	esp, 10h
		cmp	eax, 6
		jz	short loc_40AB4F

loc_40AB4B:				; CODE XREF: sub_40A910+21Cj
		mov	[esp+54h+arg_4], ebp

loc_40AB4F:				; CODE XREF: sub_40A910+239j
		push	467h		; nIDDlgItem
		push	edi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		cmp	[esp+54h+arg_4], ebp
		jnz	short loc_40ABCA ; jumptable 0040A99F default case

loc_40AB68:				; CODE XREF: sub_40A910+1C0j
		push	0FFFFFFFFh	; dwNewLong
		push	0		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		pop	edi
		pop	esi
		mov	[esp+4Ch+var_44], 1
		pop	ebp
		mov	eax, [esp+48h+var_44]
		pop	ebx
		add	esp, 44h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AB89:				; CODE XREF: sub_40A910+14j
		mov	edi, [esp+54h+hWnd]
		push	0FFFFFFEBh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	ebx, eax
		cmp	[ebx+18h], ebp
		jz	short loc_40ABCA ; jumptable 0040A99F default case
		lea	eax, [esp+54h+Paint]
		push	eax		; lpPaint
		push	edi		; hWnd
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	ebp		; bForceBkgd
		push	ecx		; hPal
		push	esi		; hdc
		call	ds:SelectPalette
		push	esi		; hdc
		call	ds:RealizePalette
		lea	edx, [esp+54h+Paint]
		push	edx		; lpPaint
		push	edi		; hWnd
		call	ds:EndPaint

loc_40ABCA:				; CODE XREF: sub_40A910+24j
					; sub_40A910+89j ...
		mov	eax, [esp+54h+var_44] ;	jumptable 0040A99F default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn	10h
sub_40A910	endp

; ---------------------------------------------------------------------------
off_40ABD8	dd offset loc_40AA3B	; DATA XREF: sub_40A910+8Fr
		dd offset loc_40ABCA	; jump table for switch	statement
		dd offset loc_40AA17
		dd offset loc_40ABCA
		dd offset loc_40ABCA
		dd offset loc_40ABCA
		dd offset loc_40A9FA
		dd offset loc_40A9A6
		align 10h

loc_40AC00:				; DATA XREF: sub_405B80+107o
		mov	eax, [esp+8]
		sub	esp, 50h
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		cmp	eax, 4Eh
		push	edi
		ja	loc_40AD54
		jz	short loc_40AC94
		cmp	eax, 6
		jz	short loc_40AC79
		cmp	eax, 0Fh
		jnz	loc_40ADC9
		mov	edi, [esp+64h]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebx, eax
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	loc_40ADC9
		lea	eax, [esp+20h]
		push	eax
		push	edi
		call	ds:BeginPaint
		mov	ecx, [ebx+18h]
		mov	esi, eax
		push	ebp
		push	ecx
		push	esi
		call	ds:SelectPalette
		push	esi
		call	ds:RealizePalette
		lea	edx, [esp+20h]
		push	edx
		push	edi
		call	ds:EndPaint
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AC79:				; CODE XREF: .text:0040AC1Bj
		mov	eax, [esp+64h]
		push	1
		push	0
		push	eax
		call	ds:InvalidateRect
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AC94:				; CODE XREF: .text:0040AC16j
		mov	ecx, [esp+70h]
		mov	eax, [ecx+8]
		cmp	eax, 0FFFFFF33h
		jz	loc_40AD31
		cmp	eax, 0FFFFFF37h
		jz	short loc_40AD11
		cmp	eax, 0FFFFFF38h
		jnz	loc_40ADC9
		mov	esi, [esp+64h]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		push	2
		push	0
		push	470h
		push	esi
		mov	edi, eax
		call	ds:GetParent
		push	eax
		call	ds:PostMessageA
		mov	edx, [edi+14h]
		push	edx
		push	0
		push	172h
		push	422h
		push	esi
		call	ds:SendDlgItemMessageA
		push	0
		push	0
		push	esi
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AD11:				; CODE XREF: .text:0040ACABj
		mov	eax, [esp+64h]
		push	0
		push	0
		push	eax
		call	ds:SetWindowLongA
		mov	ebp, 1
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AD31:				; CODE XREF: .text:0040ACA0j
		mov	ecx, [esp+64h]
		push	7D0h
		push	1
		push	offset szHelp
		push	ecx
		call	ds:WinHelpA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------

loc_40AD54:				; CODE XREF: .text:0040AC10j
		cmp	eax, 110h
		jnz	short loc_40ADC9
		mov	edx, [esp+70h]
		mov	esi, [esp+64h]
		mov	eax, [edx+1Ch]
		push	eax
		push	0FFFFFFEBh
		push	esi
		call	ds:SetWindowLongA
		mov	edi, ds:GetParent
		lea	ecx, [esp+10h]
		push	ecx
		push	esi
		call	edi ; GetParent
		push	eax
		call	ds:GetWindowRect
		mov	ebx, ds:GetSystemMetrics
		push	5
		push	0
		push	0
		push	1
		call	ebx ; GetSystemMetrics
		mov	edx, [esp+20h]
		mov	ecx, [esp+28h]
		sub	edx, ecx
		add	eax, edx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		call	ebx ; GetSystemMetrics
		mov	ecx, [esp+20h]
		mov	ebx, [esp+28h]
		sub	ecx, ebx
		add	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax
		push	0
		push	esi
		call	edi ; GetParent
		push	eax
		call	ds:SetWindowPos

loc_40ADC9:				; CODE XREF: .text:0040AC20j
					; .text:0040AC3Aj ...
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 50h
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40ADE0(HMODULE hModule, LPCSTR lpName, int)
sub_40ADE0	proc near		; CODE XREF: sub_405B80+9Dp

hModule		= dword	ptr  4
lpName		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+lpName]
		push	esi
		mov	esi, [esp+4+hModule]
		push	edi
		push	2		; lpType
		push	eax		; lpName
		push	esi		; hModule
		xor	edi, edi
		call	ds:FindResourceA
		test	eax, eax
		jz	short loc_40AE71
		push	ebx
		push	eax		; hResInfo
		push	esi		; hModule
		call	ds:LoadResource
		mov	ebx, eax
		push	ebx		; hResData
		call	ds:LockResource
		push	edi		; hWnd
		mov	esi, eax
		call	ds:GetDC
		lea	ecx, [esp+0Ch+lpName]
		mov	edi, eax
		push	ecx
		push	esi
		call	sub_40AE80
		mov	edx, [esp+14h+arg_8]
		add	esp, 8
		test	eax, eax
		mov	[edx], eax
		jz	short loc_40AE40
		push	0		; bForceBkgd
		push	eax		; hPal
		push	edi		; hdc
		call	ds:SelectPalette
		push	edi		; hdc
		call	ds:RealizePalette

loc_40AE40:				; CODE XREF: sub_40ADE0+4Dj
		mov	eax, [esi]
		mov	ecx, [esp+0Ch+lpName]
		push	0		; iUsage
		push	esi		; pbmi
		lea	edx, [eax+ecx*4]
		add	edx, esi
		push	edx		; pjBits
		push	4		; flInit
		push	esi		; pbmih
		push	edi		; hdc
		call	ds:CreateDIBitmap
		push	edi		; hDC
		push	0		; hWnd
		mov	esi, eax
		call	ds:ReleaseDC
		push	ebx		; hResData
		call	ds:FreeResource
		pop	ebx
		mov	eax, esi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_40AE71:				; CODE XREF: sub_40ADE0+18j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_40ADE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AE80	proc near		; CODE XREF: sub_40ADE0+3Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		push	esi
		mov	cx, [ecx+0Eh]
		cmp	cx, 8
		ja	short loc_40AEA0
		mov	esi, [esp+4+arg_4]
		mov	edx, 1
		shl	edx, cl
		mov	[esi], edx
		jmp	short loc_40AEAA
; ---------------------------------------------------------------------------

loc_40AEA0:				; CODE XREF: sub_40AE80+Fj
		mov	esi, [esp+4+arg_4]
		mov	dword ptr [esi], 0

loc_40AEAA:				; CODE XREF: sub_40AE80+1Ej
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_40AF2A
		push	ebx
		push	ebp
		lea	eax, ds:8[ecx*4]
		push	edi
		push	eax		; dwBytes
		push	42h		; uFlags
		call	ds:GlobalAlloc
		mov	ebx, eax
		push	ebx		; hMem
		call	ds:GlobalLock
		mov	ebp, eax
		xor	edi, edi
		mov	word ptr [ebp+0], 300h
		mov	cx, [esi]
		mov	[ebp+2], cx
		mov	eax, [esi]
		test	eax, eax
		jle	short loc_40AF0E
		mov	edx, [esp+10h+arg_0]
		lea	ecx, [ebp+5]
		add	edx, 29h

loc_40AEED:				; CODE XREF: sub_40AE80+8Cj
		mov	al, [edx+1]
		inc	edi
		mov	[ecx-1], al
		mov	al, [edx]
		mov	[ecx], al
		mov	al, [edx-1]
		mov	[ecx+1], al
		mov	byte ptr [ecx+2], 0
		mov	eax, [esi]
		add	edx, 4
		add	ecx, 4
		cmp	edi, eax
		jl	short loc_40AEED

loc_40AF0E:				; CODE XREF: sub_40AE80+61j
		push	ebp		; plpal
		call	ds:CreatePalette
		push	ebx		; hMem
		mov	esi, eax
		call	ds:GlobalUnlock
		push	ebx		; hMem
		call	ds:GlobalFree
		pop	edi
		pop	ebp
		mov	eax, esi
		pop	ebx

loc_40AF2A:				; CODE XREF: sub_40AE80+2Ej
		pop	esi
		retn
sub_40AE80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40AF30(HMENU hMenu)
sub_40AF30	proc near		; CODE XREF: .text:0040CF15p

hMenu		= dword	ptr  4

		mov	eax, [esp+hMenu]
		push	esi
		push	edi
		push	4		; nPos
		push	eax		; hMenu
		call	ds:GetSubMenu
		mov	edi, ds:DeleteMenu
		mov	esi, eax
		push	0		; uFlags
		push	9C90h		; uPosition
		push	esi		; hMenu
		call	edi ; DeleteMenu
		push	0		; uFlags
		push	9C8Fh		; uPosition
		push	esi		; hMenu
		call	edi ; DeleteMenu
		push	0		; uFlags
		push	9C8Bh		; uPosition
		push	esi		; hMenu
		call	edi ; DeleteMenu
		pop	edi
		pop	esi
		retn
sub_40AF30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40AF70	proc near		; CODE XREF: .text:0040F33Ap

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	ecx, dword_430850
		lea	eax, [esp+0Ch+var_C]
		push	eax
		push	ecx
		mov	[esp+14h+var_4], 0
		mov	[esp+14h+var_8], 0
		mov	[esp+14h+var_C], 0
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	loc_40B083
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		lea	edx, [esp+18h+var_4]
		lea	eax, [esp+18h+var_8]
		cmp	edi, 0A028h
		push	edx
		push	eax
		jnz	short loc_40B000
		mov	ecx, [esp+20h+var_C]
		push	offset byte_430394
		push	ecx
		call	PGPCreateKeyServerPath
		add	esp, 10h
		test	eax, eax
		jnz	loc_40B070
		mov	eax, [esp+18h+var_8]
		mov	edi, [esp+18h+arg_4]
		mov	ecx, 0B5h
		mov	esi, eax
		rep movsd
		push	eax
		call	PGPDisposeKeyServerPath
		add	esp, 4
		jmp	short loc_40B070
; ---------------------------------------------------------------------------

loc_40B000:				; CODE XREF: sub_40AF70+58j
		mov	ecx, [esp+20h+var_C]
		push	ecx
		call	PGPGetKeyServerPrefs
		mov	edx, [esp+24h+var_4]
		mov	ebx, [esp+24h+var_8]
		lea	eax, [edi-0A028h]
		add	esp, 0Ch
		cmp	eax, edx
		ja	short loc_40B05E
		xor	eax, eax
		mov	esi, 0A029h
		test	edx, edx
		jbe	short loc_40B05E
		lea	ecx, [ebx+290h]

loc_40B030:				; CODE XREF: sub_40AF70+D3j
		test	byte ptr [ecx],	1
		jz	short loc_40B03A
		cmp	edi, esi
		jz	short loc_40B047
		inc	esi

loc_40B03A:				; CODE XREF: sub_40AF70+C3j
		inc	eax
		add	ecx, 2D4h
		cmp	eax, edx
		jb	short loc_40B030
		jmp	short loc_40B05E
; ---------------------------------------------------------------------------

loc_40B047:				; CODE XREF: sub_40AF70+C7j
		lea	ecx, [eax+eax*4]
		mov	edi, [esp+18h+arg_4]
		lea	ecx, [ecx+ecx*8]
		lea	edx, [eax+ecx*4]
		mov	ecx, 0B5h
		lea	esi, [ebx+edx*4]
		rep movsd

loc_40B05E:				; CODE XREF: sub_40AF70+ADj
					; sub_40AF70+B8j ...
		test	ebx, ebx
		jz	short loc_40B070
		mov	eax, [esp+18h+var_C]
		push	ebx
		push	eax
		call	sub_41B260
		add	esp, 8

loc_40B070:				; CODE XREF: sub_40AF70+6Ej
					; sub_40AF70+8Ej ...
		mov	ecx, [esp+18h+var_C]
		push	0
		push	ecx
		call	ds:PGPclCloseClientPrefs
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebx

loc_40B083:				; CODE XREF: sub_40AF70+3Bj
		add	esp, 0Ch
		retn
sub_40AF70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40B090	proc near		; CODE XREF: .text:0040E2EDp

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
Buffer		= byte ptr -40h
arg_0		= dword	ptr  4

		sub	esp, 48h
		push	ebx
		push	ebp
		mov	ebp, [esp+50h+arg_0]
		push	esi
		push	edi
		push	1		; nPos
		mov	ecx, [ebp+31Ch]
		mov	eax, [ebp+338h]
		mov	esi, [ebp+14h]
		push	ecx		; hMenu
		mov	[esp+60h+var_44], eax
		call	ds:GetSubMenu
		mov	edi, ds:PGPkmIsActionEnabled
		push	1
		push	esi
		mov	ebx, eax
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C60h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	eax, [ebp+334h]
		add	esp, 14h
		test	eax, eax
		push	2
		jz	short loc_40B11E
		mov	edx, [esp+5Ch+var_44]
		push	edx
		call	sub_401AD0
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	eax, [esp+6Ch+var_44]
		push	4
		push	eax
		call	sub_401AD0
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	ecx, [esp+80h+var_44]
		push	80h
		push	ecx
		call	sub_401AD0
		jmp	short loc_40B146
; ---------------------------------------------------------------------------

loc_40B11E:				; CODE XREF: sub_40B090+4Dj
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	4
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	80h
		push	esi
		call	edi ; PGPkmIsActionEnabled

loc_40B146:				; CODE XREF: sub_40B090+8Cj
		neg	eax
		sbb	eax, eax
		inc	eax
		push	eax		; int
		push	ebx		; hmenu
		call	sub_40B640
		mov	edx, [ebp+31Ch]
		add	esp, 38h
		push	2		; nPos
		push	edx		; hMenu
		call	ds:GetSubMenu
		mov	ebx, eax
		lea	eax, [esp+58h+var_48]
		push	eax
		push	esi
		call	ds:PGPkmGetSelectedColumns
		mov	al, [esp+60h+var_48]
		add	esp, 8
		test	al, 1
		jz	short loc_40B181
		push	8
		jmp	short loc_40B183
; ---------------------------------------------------------------------------

loc_40B181:				; CODE XREF: sub_40B090+EBj
		push	0		; uCheck

loc_40B183:				; CODE XREF: sub_40B090+EFj
		mov	ebp, ds:CheckMenuItem
		push	9C7Fh		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 2
		jz	short loc_40B19C
		push	8
		jmp	short loc_40B19E
; ---------------------------------------------------------------------------

loc_40B19C:				; CODE XREF: sub_40B090+106j
		push	0		; uCheck

loc_40B19E:				; CODE XREF: sub_40B090+10Aj
		push	9C80h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 4
		jz	short loc_40B1B1
		push	8
		jmp	short loc_40B1B3
; ---------------------------------------------------------------------------

loc_40B1B1:				; CODE XREF: sub_40B090+11Bj
		push	0		; uCheck

loc_40B1B3:				; CODE XREF: sub_40B090+11Fj
		push	9C81h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 8
		jz	short loc_40B1C6
		push	8
		jmp	short loc_40B1C8
; ---------------------------------------------------------------------------

loc_40B1C6:				; CODE XREF: sub_40B090+130j
		push	0		; uCheck

loc_40B1C8:				; CODE XREF: sub_40B090+134j
		push	9C82h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 10h
		jz	short loc_40B1DB
		push	8
		jmp	short loc_40B1DD
; ---------------------------------------------------------------------------

loc_40B1DB:				; CODE XREF: sub_40B090+145j
		push	0		; uCheck

loc_40B1DD:				; CODE XREF: sub_40B090+149j
		push	9C83h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 20h
		jz	short loc_40B1F0
		push	8
		jmp	short loc_40B1F2
; ---------------------------------------------------------------------------

loc_40B1F0:				; CODE XREF: sub_40B090+15Aj
		push	0		; uCheck

loc_40B1F2:				; CODE XREF: sub_40B090+15Ej
		push	9C84h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 40h
		jz	short loc_40B205
		push	8
		jmp	short loc_40B207
; ---------------------------------------------------------------------------

loc_40B205:				; CODE XREF: sub_40B090+16Fj
		push	0		; uCheck

loc_40B207:				; CODE XREF: sub_40B090+173j
		push	9C85h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		test	[esp+58h+var_48], 80h
		jz	short loc_40B21A
		push	8
		jmp	short loc_40B21C
; ---------------------------------------------------------------------------

loc_40B21A:				; CODE XREF: sub_40B090+184j
		push	0		; uCheck

loc_40B21C:				; CODE XREF: sub_40B090+188j
		push	9C86h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		mov	ecx, [esp+58h+arg_0]
		mov	eax, [ecx+324h]
		test	eax, eax
		jle	short loc_40B236
		push	8
		jmp	short loc_40B238
; ---------------------------------------------------------------------------

loc_40B236:				; CODE XREF: sub_40B090+1A0j
		push	0		; uCheck

loc_40B238:				; CODE XREF: sub_40B090+1A4j
		push	9C87h		; uIDCheckItem
		push	ebx		; hMenu
		call	ebp ; CheckMenuItem
		mov	ebp, [esp+58h+arg_0]
		push	3		; nPos
		mov	edx, [ebp+31Ch]
		push	edx		; hMenu
		call	ds:GetSubMenu
		push	100h
		push	esi
		mov	ebx, eax
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C48h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	200h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C54h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	400h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C53h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	1000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		add	esp, 44h
		push	eax		; int
		push	9C4Ah		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	1000000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C88h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	4000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		add	esp, 28h
		test	eax, eax
		jz	short loc_40B2E6
		push	0		; int
		push	ebx		; hmenu
		call	sub_40B780
		add	esp, 8
		push	0		; uEnable
		push	9C6Ah		; uIDEnableItem
		push	ebx		; hMenu
		call	ds:EnableMenuItem
		jmp	short loc_40B305
; ---------------------------------------------------------------------------

loc_40B2E6:				; CODE XREF: sub_40B090+239j
		push	1		; int
		push	ebx		; hmenu
		call	sub_40B780
		push	2000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C6Ah		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		add	esp, 1Ch

loc_40B305:				; CODE XREF: sub_40B090+254j
		mov	eax, dword_4303C0
		test	eax, eax
		jnz	short loc_40B31E
		mov	al, byte ptr dword_42F0DC
		test	al, al
		jz	short loc_40B31E
		mov	eax, 1
		jmp	short loc_40B320
; ---------------------------------------------------------------------------

loc_40B31E:				; CODE XREF: sub_40B090+27Cj
					; sub_40B090+285j
		xor	eax, eax

loc_40B320:				; CODE XREF: sub_40B090+28Cj
		push	eax		; int
		push	9C69h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	2000000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C89h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	8000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C5Bh		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	10000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C5Ch		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		add	esp, 48h
		push	20000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		add	esp, 14h
		push	2		; nPos
		push	ebx		; hMenu
		call	ds:GetSubMenu
		push	800h
		push	esi
		mov	ebx, eax
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C59h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	4000000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C8Ch		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	8000000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C91h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	al, byte ptr dword_42F0DC+1
		add	esp, 3Ch
		test	al, al
		jz	short loc_40B3EB
		push	800000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40B3EB
		mov	eax, 1
		jmp	short loc_40B3ED
; ---------------------------------------------------------------------------

loc_40B3EB:				; CODE XREF: sub_40B090+343j
					; sub_40B090+352j
		xor	eax, eax

loc_40B3ED:				; CODE XREF: sub_40B090+359j
		push	eax		; int
		push	9C94h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	eax, [ebp+31Ch]
		add	esp, 0Ch
		push	4		; nPos
		push	eax		; hMenu
		call	ds:GetSubMenu
		mov	ebx, eax
		push	400h		; uFlags
		push	0		; uPosition
		push	ebx		; hMenu
		call	ds:DeleteMenu
		mov	edx, hModule
		lea	ecx, [esp+58h+Buffer]
		push	40h		; cchBufferMax
		push	ecx		; lpBuffer
		push	81Eh		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		push	40000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40B464
		call	sub_40B510
		lea	ecx, [esp+58h+Buffer]
		mov	[ebp+320h], eax
		push	ecx		; lpNewItem
		push	eax		; uIDNewItem
		push	410h		; uFlags
		push	0		; uPosition
		push	ebx		; hMenu
		call	ds:InsertMenuA
		jmp	short loc_40B48C
; ---------------------------------------------------------------------------

loc_40B464:				; CODE XREF: sub_40B090+3B1j
		lea	edx, [esp+58h+Buffer]
		push	edx		; lpNewItem
		push	9C74h		; uIDNewItem
		push	400h		; uFlags
		push	0		; uPosition
		push	ebx		; hMenu
		call	ds:InsertMenuA
		push	0		; int
		push	9C74h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		add	esp, 0Ch

loc_40B48C:				; CODE XREF: sub_40B090+3D2j
		push	80000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		push	400000h
		push	esi
		call	edi ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C95h		; uIDEnableItem
		push	ebx		; hMenu
		call	sub_40B800
		mov	eax, [ebp+31Ch]
		add	esp, 28h
		push	5		; nPos
		push	eax		; hMenu
		call	ds:GetSubMenu
		mov	esi, eax
		mov	eax, [ebp+330h]
		test	eax, eax
		jz	short loc_40B4F8
		mov	ecx, [esp+58h+var_44]
		push	100h
		push	ecx
		call	sub_401AD0
		push	eax		; int
		push	9C78h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 14h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_40B4F8:				; CODE XREF: sub_40B090+440j
		push	0		; int
		push	9C78h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 48h
		retn
sub_40B090	endp


; =============== S U B	R O U T	I N E =======================================


sub_40B510	proc near		; CODE XREF: sub_40B090+3B3p
					; sub_40B830+398p ...

var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
Buffer		= byte ptr -100h

		sub	esp, 110h
		mov	ecx, dword_430850
		lea	eax, [esp+110h+var_10C]
		push	ebx
		xor	ebx, ebx
		push	eax
		push	ecx
		mov	[esp+11Ch+var_110], ebx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jz	short loc_40B549
		xor	eax, eax
		pop	ebx
		add	esp, 110h
		retn
; ---------------------------------------------------------------------------

loc_40B549:				; CODE XREF: sub_40B510+2Dj
		push	edi
		call	ds:CreatePopupMenu
		mov	ecx, [esp+118h+var_10C]
		mov	edi, eax
		lea	edx, [esp+118h+var_110]
		lea	eax, [esp+118h+var_104]
		push	edx
		push	eax
		push	ecx
		call	PGPGetKeyServerPrefs
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_40B61B
		mov	eax, hModule
		push	ebp
		lea	edx, [esp+11Ch+Buffer]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	84Dh		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		mov	ebp, ds:AppendMenuA
		lea	ecx, [esp+11Ch+Buffer]
		push	ecx		; lpNewItem
		push	0A028h		; uIDNewItem
		push	ebx		; uFlags
		push	edi		; hMenu
		call	ebp ; AppendMenuA
		push	ebx		; lpNewItem
		push	ebx		; uIDNewItem
		push	800h		; uFlags
		push	edi		; hMenu
		call	ebp ; AppendMenuA
		mov	eax, [esp+11Ch+var_110]
		mov	[esp+11Ch+var_108], ebx
		cmp	eax, ebx
		jbe	short loc_40B602
		push	esi
		mov	esi, 0A029h

loc_40B5BD:				; CODE XREF: sub_40B510+EFj
		mov	edx, [esp+120h+var_104]
		mov	cl, [ebx+edx+290h]
		lea	eax, [ebx+edx]
		test	cl, 1
		jz	short loc_40B5EA
		lea	ecx, [esp+120h+Buffer]
		push	ecx
		push	eax
		call	PGPGetKeyServerURL
		add	esp, 8
		lea	edx, [esp+120h+Buffer]
		push	edx		; lpNewItem
		push	esi		; uIDNewItem
		push	0		; uFlags
		push	edi		; hMenu
		call	ebp ; AppendMenuA
		inc	esi

loc_40B5EA:				; CODE XREF: sub_40B510+BEj
		mov	eax, [esp+120h+var_108]
		mov	ecx, [esp+120h+var_110]
		inc	eax
		add	ebx, 2D4h
		cmp	eax, ecx
		mov	[esp+120h+var_108], eax
		jb	short loc_40B5BD
		pop	esi

loc_40B602:				; CODE XREF: sub_40B510+A5j
		mov	eax, [esp+11Ch+var_104]
		xor	ebx, ebx
		cmp	eax, ebx
		pop	ebp
		jz	short loc_40B61B
		push	eax
		mov	eax, [esp+11Ch+var_10C]
		push	eax
		call	sub_41B260
		add	esp, 8

loc_40B61B:				; CODE XREF: sub_40B510+5Bj
					; sub_40B510+FBj
		mov	ecx, [esp+118h+var_10C]
		push	ebx
		push	ecx
		call	ds:PGPclCloseClientPrefs
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	ebx
		add	esp, 110h
		retn
sub_40B510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B640(HMENU hmenu, int)
sub_40B640	proc near		; CODE XREF: sub_40B090+BDp

mii		= MENUITEMINFOA	ptr -6Ch
hmenu		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 6Ch
		mov	eax, [esp+6Ch+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+7Ch+mii.cbSize], 2Ch
		test	eax, eax
		mov	[esp+7Ch+mii.fMask], 10h
		mov	[esp+7Ch+mii.fType], 0
		push	40h		; cchBufferMax
		jz	loc_40B6F3
		mov	ecx, hModule
		mov	esi, ds:LoadStringA
		lea	eax, [esp+80h+mii.hbmpItem]
		push	eax		; lpBuffer
		push	40h		; uID
		push	ecx		; hInstance
		call	esi ; LoadStringA
		mov	edi, ds:lstrlenA
		lea	eax, [esp+7Ch+mii.hbmpItem]
		lea	edx, [esp+7Ch+mii.hbmpItem]
		push	eax		; lpString
		mov	[esp+80h+mii.dwTypeData], edx
		call	edi ; lstrlenA
		mov	ebx, [esp+7Ch+hmenu]
		mov	ebp, ds:SetMenuItemInfoA
		lea	ecx, [esp+7Ch+mii]
		mov	[esp+7Ch+mii.cch], eax
		push	ecx		; lpmii
		push	0		; fByPositon
		push	9C57h		; item
		push	ebx		; hmenu
		call	ebp ; SetMenuItemInfoA
		mov	eax, hModule
		lea	edx, [esp+7Ch+mii.hbmpItem]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	41h		; uID
		push	eax		; hInstance
		call	esi ; LoadStringA
		lea	edx, [esp+7Ch+mii.hbmpItem]
		lea	ecx, [esp+7Ch+mii.hbmpItem]
		push	edx		; lpString
		mov	[esp+80h+mii.dwTypeData], ecx
		call	edi ; lstrlenA
		mov	[esp+7Ch+mii.cch], eax
		lea	eax, [esp+7Ch+mii]
		push	eax		; lpmii
		push	0		; fByPositon
		push	9C58h		; item
		push	ebx		; hmenu
		call	ebp ; SetMenuItemInfoA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn
; ---------------------------------------------------------------------------

loc_40B6F3:				; CODE XREF: sub_40B640+27j
		mov	edx, hModule
		mov	esi, ds:LoadStringA
		lea	ecx, [esp+80h+mii.hbmpItem]
		push	ecx		; lpBuffer
		push	42h		; uID
		push	edx		; hInstance
		call	esi ; LoadStringA
		mov	edi, ds:lstrlenA
		lea	ecx, [esp+7Ch+mii.hbmpItem]
		lea	eax, [esp+7Ch+mii.hbmpItem]
		push	ecx		; lpString
		mov	[esp+80h+mii.dwTypeData], eax
		call	edi ; lstrlenA
		mov	ebx, [esp+7Ch+hmenu]
		mov	ebp, ds:SetMenuItemInfoA
		lea	edx, [esp+7Ch+mii]
		mov	[esp+7Ch+mii.cch], eax
		push	edx		; lpmii
		push	0		; fByPositon
		push	9C57h		; item
		push	ebx		; hmenu
		call	ebp ; SetMenuItemInfoA
		mov	ecx, hModule
		lea	eax, [esp+7Ch+mii.hbmpItem]
		push	40h		; cchBufferMax
		push	eax		; lpBuffer
		push	43h		; uID
		push	ecx		; hInstance
		call	esi ; LoadStringA
		lea	eax, [esp+7Ch+mii.hbmpItem]
		lea	edx, [esp+7Ch+mii.hbmpItem]
		push	eax		; lpString
		mov	[esp+80h+mii.dwTypeData], edx
		call	edi ; lstrlenA
		lea	ecx, [esp+7Ch+mii]
		mov	[esp+7Ch+mii.cch], eax
		push	ecx		; lpmii
		push	0		; fByPositon
		push	9C58h		; item
		push	ebx		; hmenu
		call	ebp ; SetMenuItemInfoA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn
sub_40B640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B780(HMENU hmenu, int)
sub_40B780	proc near		; CODE XREF: sub_40B090+23Ep
					; sub_40B090+259p

mii		= MENUITEMINFOA	ptr -6Ch
hmenu		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 6Ch
		mov	eax, [esp+6Ch+arg_4]
		push	40h		; cchBufferMax
		test	eax, eax
		lea	eax, [esp+70h+mii.hbmpItem]
		mov	[esp+70h+mii.cbSize], 2Ch
		mov	[esp+70h+mii.fMask], 10h
		mov	[esp+70h+mii.fType], 0
		push	eax		; lpBuffer
		jz	short loc_40B7B1
		push	45Bh
		jmp	short loc_40B7B6
; ---------------------------------------------------------------------------

loc_40B7B1:				; CODE XREF: sub_40B780+28j
		push	45Ch		; uID

loc_40B7B6:				; CODE XREF: sub_40B780+2Fj
		mov	ecx, hModule
		push	ecx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+6Ch+mii.hbmpItem]
		lea	edx, [esp+6Ch+mii.hbmpItem]
		push	eax		; lpString
		mov	[esp+70h+mii.dwTypeData], edx
		call	ds:lstrlenA
		mov	edx, [esp+6Ch+hmenu]
		lea	ecx, [esp+6Ch+mii]
		push	ecx		; lpmii
		push	0		; fByPositon
		push	9C6Ah		; item
		push	edx		; hmenu
		mov	[esp+7Ch+mii.cch], eax
		call	ds:SetMenuItemInfoA
		add	esp, 6Ch
		retn
sub_40B780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B800(HMENU hMenu, UINT uIDEnableItem, int)
sub_40B800	proc near		; CODE XREF: sub_40B090+3Bp
					; sub_40B090+60p ...

hMenu		= dword	ptr  4
uIDEnableItem	= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jz	short loc_40B81B
		mov	eax, [esp+uIDEnableItem]
		mov	ecx, [esp+hMenu]
		push	0		; uEnable
		push	eax		; uIDEnableItem
		push	ecx		; hMenu
		call	ds:EnableMenuItem
		retn
; ---------------------------------------------------------------------------

loc_40B81B:				; CODE XREF: sub_40B800+6j
		mov	edx, [esp+uIDEnableItem]
		mov	eax, [esp+hMenu]
		push	1		; uEnable
		push	edx		; uIDEnableItem
		push	eax		; hMenu
		call	ds:EnableMenuItem
		retn
sub_40B800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40B830(HMENU hMenu, HWND hWnd, int x,	int y)
sub_40B830	proc near		; CODE XREF: .text:0040D9F0p

nPos		= dword	ptr -44h
Buffer		= byte ptr -40h
hMenu		= dword	ptr  4
hWnd		= dword	ptr  8
x		= dword	ptr  0Ch
y		= dword	ptr  10h

		mov	eax, [esp+hMenu]
		sub	esp, 44h
		mov	ecx, [eax+334h]
		push	ebx
		push	ebp
		push	esi
		test	ecx, ecx
		push	edi
		jz	loc_40B9C9
		mov	edi, [eax+338h]
		mov	eax, [eax+354h]
		sub	eax, 0
		jz	loc_40BE84
		dec	eax
		jz	loc_40B954
		dec	eax
		jz	short loc_40B8C8
		mov	eax, hModule
		push	0D5h		; lpMenuName
		push	eax		; hInstance
		call	ds:LoadMenuA
		mov	esi, eax
		push	0		; int
		push	9C61h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	4
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	800h
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	0		; int
		push	9C78h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 40h
		jmp	loc_40BE52
; ---------------------------------------------------------------------------

loc_40B8C8:				; CODE XREF: sub_40B830+36j
		mov	ecx, hModule
		push	0D6h		; lpMenuName
		push	ecx		; hInstance
		call	ds:LoadMenuA
		push	2
		push	edi
		mov	esi, eax
		call	sub_401AD0
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	4
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	400h
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C7Bh		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	800h
		push	edi
		call	sub_401AD0
		add	esp, 44h
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	400h
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 20h
		jmp	loc_40BE52
; ---------------------------------------------------------------------------

loc_40B954:				; CODE XREF: sub_40B830+2Fj
		mov	edx, hModule
		push	0D5h		; lpMenuName
		push	edx		; hInstance
		call	ds:LoadMenuA
		push	2
		push	edi
		mov	esi, eax
		call	sub_401AD0
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	4
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	800h
		push	edi
		call	sub_401AD0
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	100h
		push	edi
		call	sub_401AD0
		add	esp, 44h
		push	eax		; int
		push	9C78h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		jmp	loc_40BE52
; ---------------------------------------------------------------------------

loc_40B9C9:				; CODE XREF: sub_40B830+13j
		mov	ecx, [eax+10h]
		mov	edi, [eax+14h]
		cmp	ecx, 4		; switch 5 cases
		ja	loc_40BDFD	; jumptable 0040B9D8 default case
		jmp	ds:off_40BE8C[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40B9DF:				; CODE XREF: sub_40B830+1A8j
					; DATA XREF: .text:off_40BE8Co
		mov	eax, hModule	; jumptable 0040B9D8 case 0
		push	73h		; lpMenuName
		push	eax		; hInstance
		call	ds:LoadMenuA
		push	2
		push	edi
		mov	esi, eax
		call	ds:PGPkmIsActionEnabled
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 14h
		jmp	loc_40BE52
; ---------------------------------------------------------------------------

loc_40BA0C:				; CODE XREF: sub_40B830+1A8j
					; DATA XREF: .text:off_40BE8Co
		mov	ecx, [eax+4]	; jumptable 0040B9D8 case 1
		mov	ebx, ds:PGPkmIsActionEnabled
		test	ecx, ecx
		jz	short loc_40BA34
		mov	ecx, hModule
		push	67h		; lpMenuName
		push	ecx		; hInstance
		call	ds:LoadMenuA
		mov	esi, eax
		mov	[esp+54h+nPos],	6
		jmp	short loc_40BA8B
; ---------------------------------------------------------------------------

loc_40BA34:				; CODE XREF: sub_40B830+1E7j
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_40BA59
		mov	edx, hModule
		push	0CCh		; lpMenuName
		push	edx		; hInstance
		call	ds:LoadMenuA
		mov	esi, eax
		mov	[esp+54h+nPos],	6
		jmp	short loc_40BA74
; ---------------------------------------------------------------------------

loc_40BA59:				; CODE XREF: sub_40B830+209j
		mov	eax, hModule
		push	0CBh		; lpMenuName
		push	eax		; hInstance
		call	ds:LoadMenuA
		mov	esi, eax
		mov	[esp+54h+nPos],	7

loc_40BA74:				; CODE XREF: sub_40B830+227j
		push	10000000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C71h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 14h

loc_40BA8B:				; CODE XREF: sub_40B830+202j
		push	0		; nPos
		push	esi		; hMenu
		call	ds:GetSubMenu
		push	1
		push	edi
		mov	ebp, eax
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C60h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	2
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C61h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	4
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	100000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 44h
		push	eax		; int
		push	9C75h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	100h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C48h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	200h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C54h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		mov	ecx, [esp+88h+hMenu]
		add	esp, 34h
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jz	short loc_40BB20
		push	400h
		jmp	short loc_40BB25
; ---------------------------------------------------------------------------

loc_40BB20:				; CODE XREF: sub_40B830+2E7j
		push	200000h

loc_40BB25:				; CODE XREF: sub_40B830+2EEj
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C53h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 14h
		push	2000000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C89h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	1000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C4Ah		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	1000000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C88h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	2000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 44h
		push	eax		; int
		push	9C6Ah		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	10000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C5Ch		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		mov	eax, hModule
		add	esp, 20h
		lea	edx, [esp+54h+Buffer]
		push	40h		; cchBufferMax
		push	edx		; lpBuffer
		push	81Eh		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		push	40000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40BBED
		call	sub_40B510
		mov	ecx, [esp+54h+hMenu]
		lea	edx, [esp+54h+Buffer]
		push	edx		; lpNewItem
		push	eax		; uIDNewItem
		push	410h		; uFlags
		push	0Dh		; uPosition
		push	ebp		; hMenu
		mov	[ecx+320h], eax
		call	ds:InsertMenuA
		jmp	short loc_40BC15
; ---------------------------------------------------------------------------

loc_40BBED:				; CODE XREF: sub_40B830+396j
		lea	eax, [esp+54h+Buffer]
		push	eax		; lpNewItem
		push	9C74h		; uIDNewItem
		push	400h		; uFlags
		push	0Dh		; uPosition
		push	esi		; hMenu
		call	ds:InsertMenuA
		push	0		; int
		push	9C74h		; uIDEnableItem
		push	ebp		; hMenu
		call	sub_40B800
		add	esp, 0Ch

loc_40BC15:				; CODE XREF: sub_40B830+3BBj
		push	80000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	20000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		mov	ecx, [esp+7Ch+nPos]
		add	esp, 28h
		push	ecx		; nPos
		push	ebp		; hMenu
		call	ds:GetSubMenu
		push	800h
		push	edi
		mov	[esp+5Ch+hMenu], eax
		call	ebx ; PGPkmIsActionEnabled
		mov	edx, [esp+5Ch+hMenu]
		push	eax		; int
		push	9C59h		; uIDEnableItem
		push	edx		; hMenu
		call	sub_40B800
		push	4000000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		mov	eax, [esp+74h+hMenu]
		push	9C8Ch		; uIDEnableItem
		push	eax		; hMenu
		call	sub_40B800
		push	8000000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		mov	ecx, [esp+84h+hMenu]
		push	eax		; int
		push	9C91h		; uIDEnableItem
		push	ecx		; hMenu
		call	sub_40B800
		mov	al, byte ptr dword_42F0DC+1
		add	esp, 3Ch
		test	al, al
		jz	short loc_40BCBD
		push	800000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40BCBD
		mov	eax, 1
		jmp	short loc_40BCBF
; ---------------------------------------------------------------------------

loc_40BCBD:				; CODE XREF: sub_40B830+475j
					; sub_40B830+484j
		xor	eax, eax

loc_40BCBF:				; CODE XREF: sub_40B830+48Bj
		mov	edx, [esp+54h+hMenu]
		push	eax		; int
		push	9C94h		; uIDEnableItem
		push	edx		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		jmp	loc_40BE5D
; ---------------------------------------------------------------------------

loc_40BCD7:				; CODE XREF: sub_40B830+1A8j
					; DATA XREF: .text:off_40BE8Co
		mov	eax, hModule	; jumptable 0040B9D8 case 2
		push	69h		; lpMenuName
		push	eax		; hInstance
		call	ds:LoadMenuA
		mov	ebx, ds:PGPkmIsActionEnabled
		push	4
		push	edi
		mov	esi, eax
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	100h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C48h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	4000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C6Ah		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	20000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 44h
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		push	0		; nPos
		push	esi		; hMenu
		call	ds:GetSubMenu
		mov	ebp, eax
		push	4		; nPos
		push	ebp		; hMenu
		call	ds:GetSubMenu
		mov	[esp+54h+hMenu], eax
		mov	al, byte ptr dword_42F0DC+1
		test	al, al
		jz	short loc_40BD77
		push	800000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40BD77
		mov	eax, 1
		jmp	short loc_40BD79
; ---------------------------------------------------------------------------

loc_40BD77:				; CODE XREF: sub_40B830+52Fj
					; sub_40B830+53Ej
		xor	eax, eax

loc_40BD79:				; CODE XREF: sub_40B830+545j
		mov	ecx, [esp+54h+hMenu]
		push	eax		; int
		push	9C94h		; uIDEnableItem
		push	ecx		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		jmp	loc_40BE5D
; ---------------------------------------------------------------------------

loc_40BD91:				; CODE XREF: sub_40B830+1A8j
					; DATA XREF: .text:off_40BE8Co
		mov	edx, hModule	; jumptable 0040B9D8 case 4
		push	6Ah		; lpMenuName
		push	edx		; hInstance
		call	ds:LoadMenuA
		mov	ebx, ds:PGPkmIsActionEnabled
		push	4
		push	edi
		mov	esi, eax
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	1000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C4Ah		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	80000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C73h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	20000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 44h
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 0Ch
		jmp	short loc_40BE52
; ---------------------------------------------------------------------------

loc_40BDFD:				; CODE XREF: sub_40B830+1A2j
					; sub_40B830+1A8j
					; DATA XREF: ...
		mov	eax, hModule	; jumptable 0040B9D8 default case
		push	0BEh		; lpMenuName
		push	eax		; hInstance
		call	ds:LoadMenuA
		mov	ebx, ds:PGPkmIsActionEnabled
		push	4
		push	edi
		mov	esi, eax
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C46h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	100h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C48h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		push	20000h
		push	edi
		call	ebx ; PGPkmIsActionEnabled
		push	eax		; int
		push	9C55h		; uIDEnableItem
		push	esi		; hMenu
		call	sub_40B800
		add	esp, 3Ch

loc_40BE52:				; CODE XREF: sub_40B830+93j
					; sub_40B830+11Fj ...
		push	0		; nPos
		push	esi		; hMenu
		call	ds:GetSubMenu
		mov	ebp, eax

loc_40BE5D:				; CODE XREF: sub_40B830+4A2j
					; sub_40B830+55Cj
		test	esi, esi
		jz	short loc_40BE84
		mov	ecx, [esp+54h+hWnd]
		mov	edx, [esp+54h+y]
		mov	eax, [esp+54h+x]
		push	0		; prcRect
		push	ecx		; hWnd
		push	0		; nReserved
		push	edx		; y
		push	eax		; x
		push	2		; uFlags
		push	ebp		; hMenu
		call	ds:TrackPopupMenu
		push	esi		; hMenu
		call	ds:DestroyMenu

loc_40BE84:				; CODE XREF: sub_40B830+28j
					; sub_40B830+62Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
sub_40B830	endp

; ---------------------------------------------------------------------------
off_40BE8C	dd offset loc_40B9DF	; DATA XREF: sub_40B830+1A8r
		dd offset loc_40BA0C	; jump table for switch	statement
		dd offset loc_40BCD7
		dd offset loc_40BDFD
		dd offset loc_40BD91

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40BEA0(HWND hWnd, int)
sub_40BEA0	proc near		; CODE XREF: .text:0040F3A0p

Point		= tagPOINT ptr -8
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	esi
		call	sub_40B510
		mov	esi, eax
		lea	eax, [esp+0Ch+Point]
		push	eax		; lpPoint
		call	ds:GetCursorPos
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+hWnd]
		push	0		; prcRect
		push	ecx		; hWnd
		mov	edx, [eax+0Ch]
		mov	eax, [eax]
		add	edx, 4
		push	0		; nReserved
		add	eax, 2
		push	edx		; y
		push	eax		; x
		push	0		; uFlags
		push	esi		; hMenu
		call	ds:TrackPopupMenu
		push	esi		; hMenu
		call	ds:DestroyMenu
		pop	esi
		add	esp, 8
		retn
sub_40BEA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40BEF0(size_t)
sub_40BEF0	proc near		; CODE XREF: sub_4057D0+2p
					; sub_4085E0+2Ep ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi		; size_t
		call	_malloc
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jz	short loc_40BF1C
		mov	ecx, esi
		push	edi
		xor	eax, eax
		mov	edi, edx
		shr	ecx, 2
		rep stosd
		mov	ecx, esi
		and	ecx, 3
		rep stosb
		pop	edi
		mov	eax, edx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_40BF1C:				; CODE XREF: sub_40BEF0+12j
		mov	eax, edx
		pop	esi
		retn
sub_40BEF0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40BF20(void *)
sub_40BF20	proc near		; CODE XREF: sub_402440+B4p
					; sub_405800+43p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short locret_40BF2F
		push	eax		; void *
		call	_free
		pop	ecx

locret_40BF2F:				; CODE XREF: sub_40BF20+6j
		retn
sub_40BF20	endp


; =============== S U B	R O U T	I N E =======================================


sub_40BF30	proc near		; CODE XREF: WinMain(x,x,x,x)+14Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, [esp+arg_10]
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [esp+8+arg_C]
		mov	ecx, [esp+8+arg_14]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	edx, [esp+0Ch+arg_18]
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	dword ptr [esi], 1
		mov	dword ptr [edi], 55h
		mov	dword ptr [ebx], 5Ah
		mov	dword ptr [ebp+0], 208h
		mov	dword ptr [eax], 12Ch
		mov	eax, [esp+10h+arg_1C]
		mov	dword ptr [ecx], 0
		mov	dword ptr [edx], 1Eh
		lea	ecx, [esp+10h+arg_0]
		mov	dword ptr [eax], 1Ch
		mov	edx, dword_430850
		push	ecx
		push	edx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	loc_40C039
		mov	edx, [esp+10h+arg_0]
		mov	[esp+10h+arg_4], eax
		lea	eax, [esp+10h+arg_C]
		lea	ecx, [esp+10h+arg_4]
		push	eax
		push	ecx
		push	25Dh
		push	edx
		call	sub_41B0C0
		mov	[esp+20h+arg_8], eax
		mov	eax, [esp+20h+arg_0]
		push	0
		push	eax
		call	ds:PGPclCloseClientPrefs
		mov	eax, [esp+28h+arg_8]
		add	esp, 18h
		test	eax, eax
		jnz	short loc_40C039
		mov	eax, [esp+10h+arg_4]
		cmp	eax, 20h
		mov	eax, [esp+10h+arg_C]
		jnz	short loc_40C02B
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	edx, [eax+4]
		mov	[edi], edx
		mov	ecx, [eax+8]
		mov	[ebx], ecx
		mov	edx, [eax+0Ch]
		mov	[ebp+0], edx
		mov	edx, [esp+10h+arg_10]
		mov	ecx, [eax+10h]
		mov	[edx], ecx
		mov	edx, [esp+10h+arg_14]
		xor	ecx, ecx
		mov	cl, [eax+14h]
		mov	[edx], ecx
		mov	edx, [esp+10h+arg_18]
		mov	ecx, [eax+18h]
		mov	[edx], ecx
		mov	edx, [esp+10h+arg_1C]
		mov	ecx, [eax+1Ch]
		mov	[edx], ecx

loc_40C02B:				; CODE XREF: sub_40BF30+BFj
		push	eax
		mov	eax, [esp+14h+arg_0]
		push	eax
		call	sub_41B260
		add	esp, 8

loc_40C039:				; CODE XREF: sub_40BF30+75j
					; sub_40BF30+B2j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_40BF30	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40C040(HWND hWnd, char, int, int)
sub_40C040	proc near		; CODE XREF: .text:0040D3B3p

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
wndpl		= WINDOWPLACEMENT ptr -2Ch
hWnd		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 4Ch
		mov	ecx, [esp+4Ch+hWnd]
		lea	eax, [esp+4Ch+wndpl]
		push	eax		; lpwndpl
		push	ecx		; hWnd
		mov	[esp+54h+wndpl.length],	2Ch
		call	ds:GetWindowPlacement
		mov	eax, dword_430850
		lea	edx, [esp+4Ch+hWnd]
		push	edx
		push	eax
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	short loc_40C0E6
		mov	ecx, [esp+4Ch+wndpl.showCmd]
		mov	eax, [esp+4Ch+wndpl.rcNormalPosition.left]
		mov	edx, [esp+4Ch+wndpl.rcNormalPosition.right]
		mov	[esp+4Ch+var_4C], ecx
		mov	ecx, [esp+4Ch+wndpl.rcNormalPosition.top]
		mov	[esp+4Ch+var_48], eax
		sub	edx, eax
		mov	eax, [esp+4Ch+wndpl.rcNormalPosition.bottom]
		mov	[esp+4Ch+var_44], ecx
		sub	eax, ecx
		mov	cl, [esp+4Ch+arg_4]
		mov	[esp+4Ch+var_40], edx
		mov	edx, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_38], cl
		lea	ecx, [esp+4Ch+var_4C]
		mov	[esp+4Ch+var_34], edx
		mov	edx, [esp+4Ch+hWnd]
		push	ecx		; void *
		mov	[esp+50h+var_3C], eax
		mov	eax, [esp+50h+arg_C]
		push	20h		; size_t
		push	25Dh		; int
		push	edx		; int
		mov	[esp+5Ch+var_30], eax
		call	sub_41B170
		mov	eax, [esp+5Ch+hWnd]
		push	1
		push	eax
		call	ds:PGPclCloseClientPrefs
		add	esp, 18h

loc_40C0E6:				; CODE XREF: sub_40C040+3Aj
		add	esp, 4Ch
		retn
sub_40C040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40C0F0	proc near		; CODE XREF: WinMain(x,x,x,x)+7p

phkResult	= dword	ptr -20Ch
dwDisposition	= dword	ptr -208h
Filename	= byte ptr -204h
Buffer		= byte ptr -100h

		mov	ecx, hModule
		sub	esp, 20Ch
		lea	eax, [esp+20Ch+Buffer]
		push	100h		; cchBufferMax
		push	eax		; lpBuffer
		push	1Eh		; uID
		push	ecx		; hInstance
		call	ds:LoadStringA
		lea	edx, [esp+20Ch+dwDisposition]
		lea	eax, [esp+20Ch+phkResult]
		push	edx		; lpdwDisposition
		push	eax		; phkResult
		push	0		; lpSecurityAttributes
		push	0F003Fh		; samDesired
		push	0		; dwOptions
		push	0		; lpClass
		lea	ecx, [esp+224h+Buffer]
		push	0		; Reserved
		push	ecx		; lpSubKey
		push	80000002h	; hKey
		call	ds:RegCreateKeyExA
		test	eax, eax
		jnz	short loc_40C199
		lea	edx, [esp+20Ch+Filename]
		push	104h		; nSize
		push	edx		; lpFilename
		push	eax		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [esp+20Ch+Filename]
		push	5Ch		; int
		push	eax		; char *
		call	_strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_40C168
		mov	byte ptr [eax+1], 0

loc_40C168:				; CODE XREF: sub_40C0F0+72j
		lea	ecx, [esp+20Ch+Filename]
		push	ecx		; lpString
		call	ds:lstrlenA
		inc	eax
		lea	edx, [esp+20Ch+Filename]
		push	eax		; cbData
		mov	eax, [esp+210h+phkResult]
		push	edx		; lpData
		push	1		; dwType
		push	0		; Reserved
		push	offset ValueName ; "InstallPath"
		push	eax		; hKey
		call	ds:RegSetValueExA
		mov	ecx, [esp+20Ch+phkResult]
		push	ecx		; hKey
		call	ds:RegCloseKey

loc_40C199:				; CODE XREF: sub_40C0F0+4Ej
		add	esp, 20Ch
		retn
sub_40C0F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_40C1A0	proc near		; CODE XREF: sub_40C2D0+58p
					; .text:0040F7A3p

var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	ecx, dword_430850
		sub	esp, 8
		lea	eax, [esp+8+var_4]
		push	ebx
		push	esi
		push	eax
		push	ecx
		xor	bl, bl
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	eax, [esp+18h+var_4]
		lea	edx, [esp+18h+var_5]
		push	edx
		push	0Bh
		push	eax
		call	sub_41B3D0
		mov	al, [esp+24h+var_5]
		mov	cl, byte_4303BC
		mov	esi, [esp+24h+arg_0]
		add	esp, 14h
		cmp	al, cl
		jz	short loc_40C21A
		mov	byte_4303BC, al
		mov	ecx, [esi+20h]
		test	al, al
		mov	bl, 1
		jnz	short loc_40C206
		mov	eax, [esi+348h]
		or	ecx, 4
		mov	[esi+20h], ecx
		or	al, bl
		jmp	short loc_40C214
; ---------------------------------------------------------------------------

loc_40C206:				; CODE XREF: sub_40C1A0+54j
		mov	eax, [esi+348h]
		and	ecx, 0FFFFFFFBh
		mov	[esi+20h], ecx
		and	al, 0FEh

loc_40C214:				; CODE XREF: sub_40C1A0+64j
		mov	[esi+348h], eax

loc_40C21A:				; CODE XREF: sub_40C1A0+46j
		mov	edx, [esp+10h+var_4]
		lea	ecx, [esp+10h+var_5]
		push	ecx
		push	0Ah
		push	edx
		call	sub_41B3D0
		mov	al, [esp+1Ch+var_5]
		mov	cl, byte_4303BD
		add	esp, 0Ch
		cmp	al, cl
		jz	short loc_40C26E
		mov	byte_4303BD, al
		mov	ecx, [esi+20h]
		test	al, al
		mov	bl, 1
		jz	short loc_40C25A
		mov	eax, [esi+348h]
		or	ch, 8
		mov	[esi+20h], ecx
		or	al, 2
		jmp	short loc_40C268
; ---------------------------------------------------------------------------

loc_40C25A:				; CODE XREF: sub_40C1A0+A8j
		mov	eax, [esi+348h]
		and	ch, 0F7h
		mov	[esi+20h], ecx
		and	al, 0FDh

loc_40C268:				; CODE XREF: sub_40C1A0+B8j
		mov	[esi+348h], eax

loc_40C26E:				; CODE XREF: sub_40C1A0+9Aj
		mov	eax, [esp+10h+var_4]
		push	0
		push	eax
		call	ds:PGPclCloseClientPrefs
		add	esp, 8
		test	bl, bl
		jz	short loc_40C2CA
		mov	ecx, [esi+14h]
		lea	eax, [esi+18h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 4
		call	ds:PGPkmConfigure
		mov	eax, [esi+318h]
		mov	edx, [esi+14h]
		push	eax
		push	eax
		push	edx
		call	ds:PGPkmLoadKeySet
		mov	ecx, [esi+338h]
		lea	eax, [esi+33Ch]
		push	eax
		push	ecx
		call	sub_405330
		mov	edx, [esi+338h]
		push	edx		; uID
		call	sub_4051E0
		add	esp, 20h

loc_40C2CA:				; CODE XREF: sub_40C1A0+E0j
		pop	esi
		pop	ebx
		add	esp, 8
		retn
sub_40C1A0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40C2D0(int, HWND hWnd, int)
sub_40C2D0	proc near		; CODE XREF: .text:0040E85Fp
					; sub_4100C0+D1p ...

arg_0		= dword	ptr  4
hWnd		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, ds:EnableWindow
		push	esi
		mov	esi, [esp+0Ch+hWnd]
		push	edi
		push	0		; bEnable
		push	esi		; hWnd
		call	ebp ; EnableWindow
		mov	edi, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_8]
		mov	edx, dword_430850
		mov	eax, [edi+318h]
		push	eax
		push	ecx
		push	esi
		push	edx
		call	ds:PGPclPreferences
		mov	ebx, eax
		add	esp, 10h
		cmp	ebx, 0FFFFCEC9h
		jz	short loc_40C315
		push	esi		; hWnd
		call	ds:SetForegroundWindow

loc_40C315:				; CODE XREF: sub_40C2D0+3Cj
		push	1		; bEnable
		push	esi		; hWnd
		call	ebp ; EnableWindow
		mov	eax, [edi+308h]
		push	eax		; hWnd
		call	ds:SetFocus
		push	edi
		call	sub_40C1A0
		add	esp, 4
		xor	eax, eax
		test	ebx, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		setz	al
		retn
sub_40C2D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40C340	proc near		; CODE XREF: sub_40C3B0+88p
					; sub_40C3B0+E0p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		push	7F02h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		mov	edi, ds:SetCursor
		push	eax		; hCursor
		call	edi ; SetCursor
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_0]
		push	eax
		call	PGPCommitKeyRingChanges
		mov	esi, eax
		push	esi
		push	0
		call	ds:PGPclErrorBox
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_40C3A5
		mov	eax, [esp+0Ch+arg_4]
		test	eax, eax
		jz	short loc_40C3A5
		call	ds:GetCurrentProcessId
		mov	ecx, hWnd
		mov	edx, Msg
		and	ecx, 0FFFFh
		push	eax		; lParam
		push	ecx		; wParam
		push	edx		; Msg
		push	0FFFFh		; hWnd
		call	ds:PostMessageA

loc_40C3A5:				; CODE XREF: sub_40C340+35j
					; sub_40C340+3Dj
		push	ebx		; hCursor
		call	edi ; SetCursor
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_40C340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40C3B0(HWND hWnd, HCURSOR hCursor, int)
sub_40C3B0	proc near		; CODE XREF: .text:0040E64Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
hWnd		= dword	ptr  4
hCursor		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	ebx
		mov	ecx, dword_4303B8
		push	ebp
		mov	ebp, [esp+10h+hWnd]
		mov	edx, dword_430850
		push	esi
		push	edi
		mov	edi, [esp+18h+hCursor]
		lea	eax, [esp+18h+var_8]
		xor	ebx, ebx
		push	eax
		push	edi
		push	1
		push	edi
		push	ebp
		push	ecx
		push	edx
		mov	[esp+34h+var_8], ebx
		call	ds:PGPclUpdateKeySetFromServer
		mov	esi, eax
		add	esp, 1Ch
		test	esi, esi
		jnz	loc_40C4B1
		mov	eax, [esp+18h+var_8]
		test	eax, eax
		jz	loc_40C4C2
		mov	ecx, [esp+18h+arg_8]
		test	ecx, ecx
		jz	short loc_40C44F
		push	7F02h		; lpCursorName
		push	esi		; hInstance
		call	ds:LoadCursorA
		mov	ebp, ds:SetCursor
		push	eax		; hCursor
		call	ebp ; SetCursor
		mov	[esp+18h+hCursor], eax
		mov	eax, [esp+18h+var_8]
		push	edi
		push	eax
		call	PGPAddKeys
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_40C442
		mov	ebx, 1
		push	ebx
		push	edi
		call	sub_40C340
		add	esp, 8
		mov	esi, eax

loc_40C442:				; CODE XREF: sub_40C3B0+7Fj
		mov	ecx, [esp+18h+hCursor]
		push	ecx		; hCursor
		call	ebp ; SetCursor
		mov	ebp, [esp+18h+hWnd]
		jmp	short loc_40C4B1
; ---------------------------------------------------------------------------

loc_40C44F:				; CODE XREF: sub_40C3B0+52j
		lea	edx, [esp+18h+var_4]
		push	edx
		push	eax
		call	PGPCountKeys
		mov	eax, [esp+20h+var_4]
		add	esp, 8
		test	eax, eax
		jle	short loc_40C49C
		mov	eax, [esp+18h+var_8]
		mov	ecx, dword_4303B8
		mov	edx, dword_430850
		push	edi
		push	eax
		push	ebp
		push	ecx
		push	edx
		call	ds:PGPclQueryAddKeys
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_40C4B1
		mov	ebx, 1
		push	ebx
		push	edi
		call	sub_40C340
		add	esp, 8
		mov	esi, eax
		jmp	short loc_40C4B1
; ---------------------------------------------------------------------------

loc_40C49C:				; CODE XREF: sub_40C3B0+B3j
		push	30h		; int
		push	854h		; UINT
		push	855h		; uID
		push	ebp		; hWnd
		call	sub_402000
		add	esp, 10h

loc_40C4B1:				; CODE XREF: sub_40C3B0+3Aj
					; sub_40C3B0+9Dj ...
		mov	eax, [esp+18h+var_8]
		test	eax, eax
		jz	short loc_40C4C2
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40C4C2:				; CODE XREF: sub_40C3B0+46j
					; sub_40C3B0+107j
		push	esi
		push	ebp
		call	ds:PGPclErrorBox
		add	esp, 8
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_40C3B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40C4E0(HWND hWnd, int, int)
sub_40C4E0	proc near		; CODE XREF: .text:0040E672p
					; .text:0040EFDDp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+2Ch+arg_4]
		lea	eax, [esp+2Ch+var_18]
		xor	ebx, ebx
		push	eax
		push	edi
		mov	[esp+34h+var_18], ebx
		mov	[esp+34h+var_10], ebx
		mov	[esp+34h+var_1C], ebx
		mov	[esp+34h+var_8], ebx
		mov	[esp+34h+var_14], ebx
		mov	[esp+34h+var_C], ebx
		call	sub_40C7A0
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	loc_40C6AD
		mov	edx, [esp+2Ch+var_18]
		lea	ecx, [esp+2Ch+arg_4]
		push	ecx
		push	edx
		call	PGPCountKeys
		mov	eax, [esp+34h+arg_4]
		add	esp, 8
		cmp	eax, ebx
		jle	short loc_40C569
		mov	ecx, [esp+2Ch+var_18]
		mov	edx, [esp+2Ch+hWnd]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	eax, dword_4303B8
		push	edi
		push	3
		push	ecx
		mov	ecx, dword_430850
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclUpdateKeySetFromServer
		mov	esi, eax
		add	esp, 1Ch
		cmp	esi, ebx
		jnz	loc_40C6AD

loc_40C569:				; CODE XREF: sub_40C4E0+55j
		mov	eax, [esp+2Ch+var_10]
		mov	ebp, ds:SetCursor
		cmp	eax, ebx
		jz	short loc_40C5BE
		push	7F02h		; lpCursorName
		push	ebx		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ebp ; SetCursor
		mov	edx, [esp+2Ch+var_10]
		push	edi
		push	edx
		mov	ebx, eax
		call	PGPAddKeys
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_40C5B1
		push	1
		push	edi
		mov	[esp+34h+var_C], 1
		call	sub_40C340
		add	esp, 8
		mov	esi, eax

loc_40C5B1:				; CODE XREF: sub_40C4E0+BAj
		push	ebx		; hCursor
		call	ebp ; SetCursor
		test	esi, esi
		jnz	loc_40C6AB
		xor	ebx, ebx

loc_40C5BE:				; CODE XREF: sub_40C4E0+95j
		mov	ecx, dword_430850
		lea	eax, [esp+2Ch+var_1C]
		push	eax
		push	ecx
		call	PGPNewKeySet
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	loc_40C6AD
		mov	eax, [esp+2Ch+var_18]
		lea	edx, [esp+2Ch+var_8]
		push	edx
		push	1
		push	eax
		call	PGPOrderKeySet
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebx
		jnz	loc_40C6AD
		mov	edx, [esp+2Ch+var_8]
		lea	ecx, [esp+2Ch+var_14]
		push	ecx
		push	edx
		call	PGPNewKeyIter
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	loc_40C6AD
		mov	ecx, [esp+2Ch+var_14]
		lea	eax, [esp+2Ch+var_4]
		push	eax
		push	ecx
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jnz	short loc_40C664

loc_40C62C:				; CODE XREF: sub_40C4E0+182j
		mov	eax, [esp+2Ch+var_4]
		cmp	eax, ebx
		jz	short loc_40C664
		mov	edx, [esp+2Ch+var_1C]
		push	edx
		push	edi
		push	eax
		mov	eax, [esp+38h+hWnd]
		push	eax
		call	sub_40CA90
		mov	esi, eax
		add	esp, 10h
		cmp	esi, ebx
		jnz	short loc_40C6AD
		mov	edx, [esp+2Ch+var_14]
		lea	ecx, [esp+2Ch+var_4]
		push	ecx
		push	edx
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jz	short loc_40C62C

loc_40C664:				; CODE XREF: sub_40C4E0+14Aj
					; sub_40C4E0+152j
		cmp	[esp+2Ch+arg_8], ebx
		jz	loc_40C71D
		push	7F02h		; lpCursorName
		push	ebx		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ebp ; SetCursor
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_1C]
		push	edi
		push	eax
		call	PGPAddKeys
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_40C6A8
		push	1
		push	edi
		mov	[esp+34h+var_C], 1
		call	sub_40C340
		add	esp, 8
		mov	esi, eax

loc_40C6A8:				; CODE XREF: sub_40C4E0+1B1j
		push	ebx		; hCursor
		call	ebp ; SetCursor

loc_40C6AB:				; CODE XREF: sub_40C4E0+D6j
		xor	ebx, ebx

loc_40C6AD:				; CODE XREF: sub_40C4E0+37j
					; sub_40C4E0+83j ...
		mov	eax, [esp+2Ch+var_8]
		cmp	eax, ebx
		jz	short loc_40C6BE
		push	eax
		call	PGPFreeKeyList
		add	esp, 4

loc_40C6BE:				; CODE XREF: sub_40C4E0+1D3j
		mov	eax, [esp+2Ch+var_14]
		cmp	eax, ebx
		jz	short loc_40C6CF
		push	eax
		call	PGPFreeKeyIter
		add	esp, 4

loc_40C6CF:				; CODE XREF: sub_40C4E0+1E4j
		mov	eax, [esp+2Ch+var_10]
		cmp	eax, ebx
		jz	short loc_40C6E0
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40C6E0:				; CODE XREF: sub_40C4E0+1F5j
		mov	eax, [esp+2Ch+var_18]
		cmp	eax, ebx
		jz	short loc_40C6F1
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40C6F1:				; CODE XREF: sub_40C4E0+206j
		mov	eax, [esp+2Ch+var_1C]
		cmp	eax, ebx
		jz	short loc_40C702
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40C702:				; CODE XREF: sub_40C4E0+217j
		mov	edx, [esp+2Ch+hWnd]
		push	esi
		push	edx
		call	ds:PGPclErrorBox
		mov	eax, [esp+34h+var_C]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_40C71D:				; CODE XREF: sub_40C4E0+188j
		mov	edx, [esp+2Ch+var_1C]
		lea	ecx, [esp+2Ch+arg_4]
		push	ecx
		push	edx
		call	PGPCountKeys
		mov	eax, [esp+34h+arg_4]
		add	esp, 8
		cmp	eax, ebx
		jle	short loc_40C77C
		mov	eax, [esp+2Ch+var_1C]
		mov	ecx, [esp+2Ch+hWnd]
		mov	edx, dword_4303B8
		push	edi
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edx
		push	eax
		call	ds:PGPclQueryAddKeys
		mov	esi, eax
		add	esp, 14h
		cmp	esi, ebx
		jnz	loc_40C6AD
		push	1
		push	edi
		mov	[esp+34h+var_C], 1
		call	sub_40C340
		add	esp, 8
		mov	esi, eax
		jmp	loc_40C6AD
; ---------------------------------------------------------------------------

loc_40C77C:				; CODE XREF: sub_40C4E0+255j
		mov	ecx, [esp+2Ch+hWnd]
		push	30h		; int
		push	853h		; UINT
		push	855h		; uID
		push	ecx		; hWnd
		call	sub_402000
		add	esp, 10h
		jmp	loc_40C6AD
sub_40C4E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40C7A0	proc near		; CODE XREF: sub_40C4E0+2Bp

var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 30h
		mov	ecx, dword_430850
		push	ebx
		push	ebp
		push	esi
		lea	eax, [esp+3Ch+var_14]
		push	edi
		xor	esi, esi
		push	eax
		push	ecx
		mov	[esp+48h+var_18], esi
		mov	[esp+48h+var_2C], esi
		mov	[esp+48h+var_28], esi
		mov	[esp+48h+var_24], esi
		mov	[esp+48h+var_20], esi
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	eax, [esp+48h+var_14]
		lea	edx, [esp+48h+var_30]
		push	edx
		push	0Ah
		push	eax
		call	sub_41B3D0
		mov	ecx, [esp+54h+var_14]
		push	esi
		push	ecx
		call	ds:PGPclCloseClientPrefs
		mov	al, [esp+5Ch+var_30]
		mov	ecx, dword_430850
		xor	edx, edx
		mov	ebp, 2
		test	al, al
		setnz	dl
		lea	eax, [esp+5Ch+var_24]
		add	edx, ebp
		push	eax
		push	ecx
		mov	[esp+64h+var_C], edx
		call	PGPNewKeySet
		mov	edi, eax
		add	esp, 24h
		cmp	edi, esi
		jnz	loc_40CA40
		mov	eax, [esp+40h+arg_0]
		lea	edx, [esp+40h+var_18]
		push	edx
		push	1
		push	eax
		call	PGPOrderKeySet
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, esi
		jnz	loc_40CA40
		mov	edx, [esp+40h+var_18]
		lea	ecx, [esp+40h+var_2C]
		push	ecx
		push	edx
		call	PGPNewKeyIter
		mov	edi, eax
		add	esp, 8
		cmp	edi, esi
		jnz	loc_40CA40
		mov	ecx, [esp+40h+var_2C]
		lea	eax, [esp+40h+var_28]
		push	eax
		push	ecx
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jnz	loc_40CA30

loc_40C87D:				; CODE XREF: sub_40C7A0+28Aj
		mov	eax, [esp+40h+var_28]
		cmp	eax, esi
		jz	loc_40CA30
		lea	edx, [esp+40h+var_2E]
		xor	bl, bl
		push	edx
		push	41h
		push	eax
		call	PGPGetKeyBoolean
		mov	ecx, [esp+4Ch+var_28]
		lea	eax, [esp+4Ch+arg_0]
		push	eax
		push	3Eh
		push	ecx
		call	PGPGetKeyBoolean
		mov	eax, [esp+58h+var_28]
		lea	edx, [esp+58h+var_2F]
		push	edx
		push	3Fh
		push	eax
		call	PGPGetKeyBoolean
		mov	edx, [esp+64h+var_28]
		lea	ecx, [esp+64h+var_8]
		push	ecx
		push	edx
		call	PGPGetPrimaryUserIDValidity
		mov	al, [esp+6Ch+var_2F]
		add	esp, 2Ch
		test	al, al
		jnz	loc_40CA16
		mov	al, [esp+40h+var_2E]
		test	al, al
		jnz	loc_40CA16
		mov	al, byte ptr [esp+40h+arg_0]
		test	al, al
		jnz	loc_40CA16
		mov	eax, [esp+40h+var_C]
		mov	ecx, [esp+40h+var_8]
		cmp	ecx, eax
		jl	loc_40CA16
		mov	edx, [esp+40h+var_2C]
		lea	ecx, [esp+40h+var_10]
		push	ecx
		push	edx
		call	PGPKeyIterNextUserID
		add	esp, 8
		test	eax, eax
		jnz	loc_40CA16

loc_40C91A:				; CODE XREF: sub_40C7A0+22Bj
		cmp	[esp+40h+var_10], esi
		jz	loc_40C9D1
		test	bl, bl
		jnz	loc_40C9D5
		mov	ecx, [esp+40h+var_2C]
		lea	eax, [esp+40h+var_1C]
		push	eax
		push	ecx
		call	PGPKeyIterNextUIDSig
		add	esp, 8
		test	eax, eax
		jnz	short loc_40C9B7

loc_40C942:				; CODE XREF: sub_40C7A0+215j
		mov	eax, [esp+40h+var_1C]
		cmp	eax, esi
		jz	short loc_40C9B7
		test	bl, bl
		jnz	short loc_40C9B7
		lea	edx, [esp+40h+arg_0]
		push	edx
		push	0B4h
		push	eax
		call	PGPGetSigBoolean
		mov	ecx, [esp+4Ch+var_1C]
		lea	eax, [esp+4Ch+var_2D]
		push	eax
		push	0B9h
		push	ecx
		call	PGPGetSigBoolean
		mov	eax, [esp+58h+var_1C]
		lea	edx, [esp+58h+var_4]
		push	edx
		push	8Dh
		push	eax
		call	PGPGetSigNumber
		mov	al, byte ptr [esp+64h+arg_0]
		add	esp, 24h
		test	al, al
		jnz	short loc_40C9A1
		mov	al, [esp+40h+var_2D]
		test	al, al
		jnz	short loc_40C9A1
		cmp	[esp+40h+var_4], ebp
		jnz	short loc_40C9A1
		mov	bl, 1

loc_40C9A1:				; CODE XREF: sub_40C7A0+1EFj
					; sub_40C7A0+1F7j ...
		mov	edx, [esp+40h+var_2C]
		lea	ecx, [esp+40h+var_1C]
		push	ecx
		push	edx
		call	PGPKeyIterNextUIDSig
		add	esp, 8
		test	eax, eax
		jz	short loc_40C942

loc_40C9B7:				; CODE XREF: sub_40C7A0+1A0j
					; sub_40C7A0+1A8j ...
		mov	ecx, [esp+40h+var_2C]
		lea	eax, [esp+40h+var_10]
		push	eax
		push	ecx
		call	PGPKeyIterNextUserID
		add	esp, 8
		test	eax, eax
		jz	loc_40C91A

loc_40C9D1:				; CODE XREF: sub_40C7A0+17Ej
		test	bl, bl
		jz	short loc_40CA16

loc_40C9D5:				; CODE XREF: sub_40C7A0+186j
		mov	eax, [esp+40h+var_28]
		lea	edx, [esp+40h+var_20]
		push	edx
		push	eax
		call	PGPNewSingletonKeySet
		mov	edi, eax
		add	esp, 8
		cmp	edi, esi
		jnz	short loc_40CA40
		mov	ecx, [esp+40h+var_24]
		mov	edx, [esp+40h+var_20]
		push	ecx
		push	edx
		call	PGPAddKeys
		mov	edi, eax
		add	esp, 8
		cmp	edi, esi
		jnz	short loc_40CA40
		mov	eax, [esp+40h+var_20]
		push	eax
		call	PGPFreeKeySet
		add	esp, 4
		mov	[esp+40h+var_20], esi

loc_40CA16:				; CODE XREF: sub_40C7A0+132j
					; sub_40C7A0+13Ej ...
		mov	edx, [esp+40h+var_2C]
		lea	ecx, [esp+40h+var_28]
		push	ecx
		push	edx
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jz	loc_40C87D

loc_40CA30:				; CODE XREF: sub_40C7A0+D7j
					; sub_40C7A0+E3j
		mov	ecx, [esp+40h+arg_4]
		mov	eax, [esp+40h+var_24]
		mov	[esp+40h+var_24], esi
		mov	[ecx], eax
		jmp	short loc_40CA51
; ---------------------------------------------------------------------------

loc_40CA40:				; CODE XREF: sub_40C7A0+83j
					; sub_40C7A0+A1j ...
		mov	eax, [esp+40h+var_24]
		cmp	eax, esi
		jz	short loc_40CA51
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40CA51:				; CODE XREF: sub_40C7A0+29Ej
					; sub_40C7A0+2A6j
		mov	eax, [esp+40h+var_20]
		cmp	eax, esi
		jz	short loc_40CA62
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40CA62:				; CODE XREF: sub_40C7A0+2B7j
		mov	eax, [esp+40h+var_2C]
		cmp	eax, esi
		jz	short loc_40CA73
		push	eax
		call	PGPFreeKeyIter
		add	esp, 4

loc_40CA73:				; CODE XREF: sub_40C7A0+2C8j
		mov	eax, [esp+40h+var_18]
		cmp	eax, esi
		jz	short loc_40CA84
		push	eax
		call	PGPFreeKeyList
		add	esp, 4

loc_40CA84:				; CODE XREF: sub_40C7A0+2D9j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
sub_40C7A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CA90	proc near		; CODE XREF: sub_40C4E0+160p

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_24		= byte ptr -24h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 64h
		mov	ecx, [esp+64h+arg_4]
		push	ebx
		push	ebp
		push	esi
		lea	eax, [esp+70h+var_48]
		push	edi
		xor	edi, edi
		push	eax
		push	ecx
		mov	[esp+7Ch+var_54], edi
		mov	[esp+7Ch+var_58], edi
		mov	[esp+7Ch+var_64], edi
		mov	[esp+7Ch+var_5C], edi
		mov	[esp+7Ch+var_60], edi
		call	PGPGetKeyIDFromKey
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	loc_40CD07
		mov	ecx, dword_430850
		lea	edx, [esp+74h+var_54]
		lea	eax, [esp+74h+var_48]
		push	edx
		push	eax
		push	ecx
		call	PGPNewSigKeyIDFilter
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, edi
		jnz	loc_40CD07
		mov	eax, [esp+74h+arg_8]
		mov	ecx, [esp+74h+var_54]
		lea	edx, [esp+74h+var_5C]
		push	edx
		mov	edx, [esp+78h+arg_0]
		push	eax
		mov	eax, dword_4303B8
		push	3
		push	ecx
		mov	ecx, dword_430850
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclSearchServerWithFilter
		mov	esi, eax
		add	esp, 1Ch
		cmp	esi, edi
		jnz	loc_40CD07
		mov	eax, [esp+74h+var_5C]
		cmp	eax, edi
		jz	loc_40CD0B
		lea	edx, [esp+74h+var_58]
		mov	ebp, 1
		push	edx
		push	ebp
		push	eax
		call	PGPOrderKeySet
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, edi
		jnz	loc_40CD07
		mov	ecx, [esp+74h+var_58]
		lea	eax, [esp+74h+var_64]
		push	eax
		push	ecx
		call	PGPNewKeyIter
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	loc_40CD07
		mov	eax, [esp+74h+var_64]
		lea	edx, [esp+74h+arg_4]
		push	edx
		push	eax
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jnz	loc_40CD07

loc_40CB85:				; CODE XREF: sub_40CA90+271j
		cmp	[esp+74h+arg_4], edi
		jz	loc_40CD07
		mov	edx, [esp+74h+var_64]
		lea	ecx, [esp+74h+var_50]
		push	ecx
		push	edx
		xor	bl, bl
		call	PGPKeyIterNextUserID
		add	esp, 8
		test	eax, eax
		jnz	loc_40CCED

loc_40CBAB:				; CODE XREF: sub_40CA90+20Fj
		cmp	[esp+74h+var_50], edi
		jz	loc_40CCA5
		test	bl, bl
		jnz	loc_40CCA9
		mov	ecx, [esp+74h+var_64]
		lea	eax, [esp+74h+arg_0]
		push	eax
		push	ecx
		call	PGPKeyIterNextUIDSig
		add	esp, 8
		test	eax, eax
		jnz	loc_40CC8B

loc_40CBD7:				; CODE XREF: sub_40CA90+1F5j
		mov	eax, [esp+74h+arg_0]
		cmp	eax, edi
		jz	loc_40CC8B
		test	bl, bl
		jnz	loc_40CC8B
		lea	edx, [esp+74h+var_24]
		push	edx
		push	eax
		call	PGPGetKeyIDOfCertifier
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	loc_40CD07
		mov	ecx, [esp+74h+arg_0]
		lea	eax, [esp+74h+arg_8]
		push	eax
		push	0B9h
		push	ecx
		call	PGPGetSigBoolean
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, edi
		jnz	loc_40CD07
		mov	eax, [esp+74h+arg_0]
		lea	edx, [esp+74h+var_4C]
		push	edx
		push	8Dh
		push	eax
		call	PGPGetSigNumber
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, edi
		jnz	loc_40CD07
		mov	al, byte ptr [esp+74h+arg_8]
		test	al, al
		jz	short loc_40CC71
		cmp	[esp+74h+var_4C], ebp
		jnz	short loc_40CC71
		lea	ecx, [esp+74h+var_24]
		lea	edx, [esp+74h+var_48]
		push	ecx
		push	edx
		call	PGPCompareKeyIDs
		add	esp, 8
		test	eax, eax
		jnz	short loc_40CC71
		mov	bl, 1

loc_40CC71:				; CODE XREF: sub_40CA90+1C1j
					; sub_40CA90+1C7j ...
		mov	ecx, [esp+74h+var_64]
		lea	eax, [esp+74h+arg_0]
		push	eax
		push	ecx
		call	PGPKeyIterNextUIDSig
		add	esp, 8
		test	eax, eax
		jz	loc_40CBD7

loc_40CC8B:				; CODE XREF: sub_40CA90+141j
					; sub_40CA90+14Dj ...
		mov	eax, [esp+74h+var_64]
		lea	edx, [esp+74h+var_50]
		push	edx
		push	eax
		call	PGPKeyIterNextUserID
		add	esp, 8
		test	eax, eax
		jz	loc_40CBAB

loc_40CCA5:				; CODE XREF: sub_40CA90+11Fj
		test	bl, bl
		jz	short loc_40CCED

loc_40CCA9:				; CODE XREF: sub_40CA90+127j
		mov	edx, [esp+74h+arg_4]
		lea	ecx, [esp+74h+var_60]
		push	ecx
		push	edx
		call	PGPNewSingletonKeySet
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_40CD07
		mov	eax, [esp+74h+arg_C]
		mov	ecx, [esp+74h+var_60]
		push	eax
		push	ecx
		call	PGPAddKeys
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_40CD07
		mov	edx, [esp+74h+var_60]
		push	edx
		call	PGPFreeKeySet
		add	esp, 4
		mov	[esp+74h+var_60], edi

loc_40CCED:				; CODE XREF: sub_40CA90+115j
					; sub_40CA90+217j
		mov	ecx, [esp+74h+var_64]
		lea	eax, [esp+74h+arg_4]
		push	eax
		push	ecx
		call	PGPKeyIterNext
		add	esp, 8
		test	eax, eax
		jz	loc_40CB85

loc_40CD07:				; CODE XREF: sub_40CA90+33j
					; sub_40CA90+56j ...
		mov	eax, [esp+74h+var_5C]

loc_40CD0B:				; CODE XREF: sub_40CA90+9Bj
		mov	ecx, [esp+74h+var_60]
		cmp	ecx, edi
		jz	short loc_40CD20
		push	ecx
		call	PGPFreeKeySet
		mov	eax, [esp+78h+var_5C]
		add	esp, 4

loc_40CD20:				; CODE XREF: sub_40CA90+281j
		cmp	eax, edi
		jz	short loc_40CD2D
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40CD2D:				; CODE XREF: sub_40CA90+292j
		mov	eax, [esp+74h+var_58]
		cmp	eax, edi
		jz	short loc_40CD3E
		push	eax
		call	PGPFreeKeyList
		add	esp, 4

loc_40CD3E:				; CODE XREF: sub_40CA90+2A3j
		mov	eax, [esp+74h+var_64]
		cmp	eax, edi
		jz	short loc_40CD4F
		push	eax
		call	PGPFreeKeyIter
		add	esp, 4

loc_40CD4F:				; CODE XREF: sub_40CA90+2B4j
		mov	eax, [esp+74h+var_54]
		cmp	eax, edi
		jz	short loc_40CD60
		push	eax
		call	PGPFreeFilter
		add	esp, 4

loc_40CD60:				; CODE XREF: sub_40CA90+2C5j
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 64h
		retn
sub_40CA90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40CD70(HWND hWnd, int, int)
sub_40CD70	proc near		; CODE XREF: .text:0040E69Dp
					; .text:0040F017p

hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_4303B8
		mov	ecx, dword_430850
		push	esi
		mov	esi, [esp+4+hWnd]
		push	edi
		mov	edi, [esp+8+arg_8]
		push	edi
		push	esi
		push	eax
		push	ecx
		call	ds:PGPclGetCertificateRevocationsFromServer
		add	esp, 10h
		cmp	eax, 0FFFFCED3h
		jnz	short loc_40CDB0
		push	40h		; int
		push	857h		; UINT
		push	3		; uID
		push	esi		; hWnd
		call	sub_402000
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_40CDB0:				; CODE XREF: sub_40CD70+27j
		push	eax
		push	esi
		call	ds:PGPclErrorBox
		add	esp, 8
		test	eax, eax
		jnz	short loc_40CDD7
		push	1
		push	edi
		call	sub_40C340
		mov	edx, [esp+10h+arg_4]
		push	0
		push	edx
		call	ds:PGPkmReLoadKeySet
		add	esp, 10h

loc_40CDD7:				; CODE XREF: sub_40CD70+4Dj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_40CD70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40CDE0	proc near		; CODE XREF: .text:0040D398p
					; .text:0040E609p
		xor	eax, eax
		retn
sub_40CDE0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_40CDF0:				; DATA XREF: sub_405510+129o
		mov	eax, [esp+8]
		sub	esp, 188h
		cmp	eax, 4Eh
		push	ebx
		push	ebp
		push	esi
		push	edi
		ja	loc_40E295
		jz	loc_40D945
		lea	ecx, [eax-1]	; switch 74 cases
		cmp	ecx, 49h
		ja	loc_40F709	; jumptable 0040CE21 default case
		xor	edx, edx
		mov	dl, ds:byte_40F9EC[ecx]
		jmp	ds:off_40F9BC[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40CE28:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		push	490h		; jumptable 0040CE21 case 1
		call	sub_40BEF0
		mov	esi, eax
		xor	edi, edi
		add	esp, 4
		cmp	esi, edi
		jnz	short loc_40CE4D
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40CE4D:				; CODE XREF: .text:0040CE3Bj
		mov	ebx, [esp+19Ch]
		push	esi
		push	0FFFFFFEBh
		push	ebx
		call	ds:SetWindowLongA
		lea	eax, [esp+10h]
		push	eax
		push	ebx
		call	ds:GetClientRect
		mov	ebp, ds:SendMessageA
		mov	eax, [esp+1A8h]
		cmp	[eax], edi
		jnz	loc_40CFA3
		mov	eax, 1
		mov	[esi], ebx
		mov	[esi+4], eax
		mov	ecx, dword_430964
		mov	[esi+324h], ecx
		mov	edx, [esp+1Ch]
		sub	edx, ecx
		mov	ecx, [esp+14h]
		sub	edx, ecx
		sub	edx, 14h
		mov	[esi+328h], edx
		mov	[esi+330h], edi
		mov	ecx, dword_43084C
		mov	[esi+360h], ecx
		mov	[esi+35Ch], edi
		mov	[esi+0Ch], eax
		mov	[esi+318h], edi
		mov	[esi+314h], edi
		mov	dword ptr [esi+20h], 0B2h
		mov	al, byte_4303BC
		test	al, al
		jnz	short loc_40CEE8
		mov	dword ptr [esi+20h], 0B6h

loc_40CEE8:				; CODE XREF: .text:0040CEDFj
		mov	al, byte_4303BD
		test	al, al
		jz	short loc_40CEFA
		mov	eax, [esi+20h]
		or	ah, 8
		mov	[esi+20h], eax

loc_40CEFA:				; CODE XREF: .text:0040CEEFj
		mov	dword ptr [esi+24h], 10000000h
		push	ebx
		mov	[esi+320h], edi
		call	ds:GetMenu
		push	eax
		mov	[esi+31Ch], eax
		call	sub_40AF30
		mov	edx, [esp+1Ch]
		mov	ecx, [esp+14h]
		mov	eax, [esi+35Ch]
		sub	edx, ecx
		mov	ecx, [esp+20h]
		push	eax
		push	edx
		mov	edx, [esp+20h]
		sub	ecx, eax
		mov	eax, dword_430850
		sub	ecx, edx
		mov	edx, dword_4303B8
		sub	ecx, 14h
		push	ecx
		push	edi
		push	192h
		push	ebx
		push	edx
		push	eax
		call	sub_404530
		push	eax
		mov	[esi+338h], eax
		call	sub_4043D0
		mov	[esi+358h], eax
		mov	[esi+348h], edi
		mov	al, byte_4303BC
		add	esp, 28h
		test	al, al
		jnz	short loc_40CF83
		mov	dword ptr [esi+348h], 1

loc_40CF83:				; CODE XREF: .text:0040CF77j
		push	ebx
		mov	[esi+34Ch], edi
		mov	[esi+340h], edi
		call	sub_4106C0
		add	esp, 4
		mov	[esi+30Ch], eax
		jmp	loc_40D086
; ---------------------------------------------------------------------------

loc_40CFA3:				; CODE XREF: .text:0040CE79j
		mov	dword_430428, ebx
		mov	[esi+4], edi
		mov	dword ptr [esi+324h], 64h
		mov	ecx, [esp+1Ch]
		sub	ecx, [esp+14h]
		sub	ecx, 78h
		mov	[esi+328h], ecx
		mov	[esi+330h], edi
		mov	[esi+35Ch], edi
		mov	[esi+360h], edi
		mov	dword ptr [esi+0Ch], 1
		mov	edx, [eax]
		mov	[esi+318h], edx
		mov	[esi+314h], edi
		mov	dword ptr [esi+20h], 20h
		mov	al, byte_4303BC
		test	al, al
		jnz	short loc_40D005
		mov	dword ptr [esi+20h], 24h

loc_40D005:				; CODE XREF: .text:0040CFFCj
		mov	al, byte_4303BD
		test	al, al
		jz	short loc_40D017
		mov	eax, [esi+20h]
		or	ah, 8
		mov	[esi+20h], eax

loc_40D017:				; CODE XREF: .text:0040D00Cj
		mov	dword ptr [esi+24h], 3FFFFFFFh
		mov	[esi+320h], edi
		mov	[esi+32Ch], edi
		mov	[esi+31Ch], edi
		call	sub_411440
		test	eax, eax
		jz	short loc_40D080
		mov	eax, hModule
		push	ebx
		push	eax
		call	sub_411460
		mov	ecx, [esi+318h]
		add	esp, 8
		mov	[esi+310h], eax
		push	ecx
		push	edi
		push	806Eh
		push	eax
		call	ebp ; SendMessageA
		mov	eax, [esi+310h]
		lea	edx, [esp+10h]
		push	edx
		push	eax
		call	ds:GetWindowRect
		mov	ecx, [esp+1Ch]
		mov	eax, [esp+14h]
		sub	ecx, eax
		mov	[esi+324h], ecx

loc_40D080:				; CODE XREF: .text:0040D037j
		mov	[esi+30Ch], edi

loc_40D086:				; CODE XREF: .text:0040CF9Ej
		push	edi
		push	edi
		push	1
		push	ebx
		call	sub_405730
		mov	edx, [esi+328h]
		mov	ecx, [esi+324h]
		push	edi
		mov	[esi+334h], edi
		mov	[esi+10h], edi
		mov	[esi+354h], edi
		mov	[esi+36Ch], edi
		mov	[esi+364h], edi
		mov	[esi+368h], edi
		mov	eax, [esp+2Ch]
		push	edx
		mov	edx, [esp+28h]
		sub	eax, edx
		mov	edx, dword_4303B8
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edi
		push	offset sub_405730
		push	191h
		push	ebx
		push	edx
		push	eax
		call	ds:PGPkmCreateKeyManagerEx
		add	esp, 38h
		mov	[esi+14h], eax
		mov	[esi+1Ch], edi
		mov	[esi+34h], edi
		push	3333h
		push	ebx
		push	offset byte_430394
		push	50000010h
		mov	[esi+28h], edi
		mov	[esi+2Ch], edi
		mov	[esi+370h], edi
		mov	dword ptr [esi+374h], 0FFFFFFFEh
		mov	dword ptr [esi+37Ch], 1
		call	ds:CreateStatusWindowA
		mov	ecx, [esi+4]
		mov	[esi+30h], eax
		mov	eax, [esp+18h]
		neg	ecx
		sbb	ecx, ecx
		lea	edx, [eax-6Ah]
		add	eax, 0FFFFFFF0h
		and	ecx, 0FFFFFFEEh
		mov	[esp+54h], eax
		add	ecx, 12h
		lea	eax, [esp+4Ch]
		mov	[esp+4Ch], ecx
		mov	[esp+50h], edx
		mov	ecx, [esi+30h]
		push	eax
		push	3
		push	404h
		push	ecx
		call	ebp ; SendMessageA
		mov	edx, [esi+30h]
		push	edi
		push	1200h
		push	401h
		push	edx
		call	ebp ; SendMessageA
		mov	eax, [esi+30h]
		push	edi
		push	1002h
		push	401h
		push	eax
		call	ebp ; SendMessageA
		cmp	himl, edi
		jnz	loc_40D240
		push	edi
		call	ds:GetDC
		mov	ebp, eax
		push	0Eh
		push	ebp
		call	ds:GetDeviceCaps
		push	0Ch
		push	ebp
		mov	[esp+2Ch], eax
		call	ds:GetDeviceCaps
		push	ebp
		push	edi
		mov	ecx, [esp+2Ch]
		imul	ecx, eax
		mov	[esp+2Ch], ecx
		call	ds:ReleaseDC
		push	edi
		push	2Fh
		cmp	dword ptr [esp+2Ch], 8
		jg	short loc_40D201
		push	1
		push	10h
		push	10h
		call	ds:ImageList_Create
		mov	edx, hModule
		push	0CFh
		push	edx
		mov	himl, eax
		call	ds:LoadBitmapA
		mov	ebp, eax
		mov	eax, himl
		push	0FF00FFh
		push	ebp
		push	eax
		jmp	short loc_40D233
; ---------------------------------------------------------------------------

loc_40D201:				; CODE XREF: .text:0040D1CCj
		push	19h
		push	10h
		push	10h
		call	ds:ImageList_Create
		mov	ecx, hModule
		push	0D0h
		push	ecx
		mov	himl, eax
		call	ds:LoadBitmapA
		mov	edx, himl
		mov	ebp, eax
		push	0FF00FFh
		push	ebp
		push	edx

loc_40D233:				; CODE XREF: .text:0040D1FFj
		call	ds:ImageList_AddMasked
		push	ebp
		call	ds:DeleteObject

loc_40D240:				; CODE XREF: .text:0040D18Cj
		lea	eax, [esi+18h]
		mov	[esi+380h], edi
		push	eax
		mov	byte ptr [esi+384h], 0
		mov	dword ptr [eax], 7Fh
		mov	eax, [esi+14h]
		push	eax
		mov	[esi+488h], edi
		call	ds:PGPkmConfigure
		mov	ecx, [esi+14h]
		push	ecx
		call	ds:PGPkmGetManagerWindow
		mov	[esi+308h], eax
		mov	eax, [esi+4]
		add	esp, 0Ch
		cmp	eax, edi
		jz	short loc_40D2D1
		mov	edx, [esi+14h]
		push	offset dword_43042C
		push	edx
		call	ds:PGPkmGetSelectedColumns
		mov	ecx, [esi+14h]
		mov	edx, [esi+30h]
		lea	eax, [esi+33Ch]
		mov	[esi+344h], edi
		push	eax
		mov	[esi+350h], edx
		mov	[eax], ecx
		mov	eax, [esi+338h]
		push	eax
		call	sub_405330
		push	ebx
		call	ds:PGPclSetSplashParent
		add	esp, 14h
		push	edi
		push	edi
		push	8062h
		push	ebx
		call	ds:PostMessageA
		jmp	short loc_40D302
; ---------------------------------------------------------------------------

loc_40D2D1:				; CODE XREF: .text:0040D27Fj
		mov	ecx, [esi+318h]
		mov	edx, [esi+314h]
		mov	eax, [esi+14h]
		push	ecx
		push	edx
		push	eax
		call	ds:PGPkmLoadKeySet
		mov	ecx, [esi+30h]
		add	esp, 0Ch
		mov	dword ptr [esi+374h], 0FFFFFFFFh
		push	edi
		push	edi
		push	ecx
		call	ds:InvalidateRect

loc_40D302:				; CODE XREF: .text:0040D2CFj
		push	esi
		call	sub_4109A0
		push	esi
		call	sub_410630
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D320:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	edi, [esp+19Ch]	; jumptable 0040CE21 case 16
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, [esi+4]
		test	eax, eax
		jz	loc_40D3F7
		mov	eax, [esi+14h]
		lea	edx, [esp+24h]
		push	edx
		push	eax
		call	ds:PGPkmOKToClose
		add	esp, 8
		test	eax, eax
		jnz	short loc_40D36B
		cmp	dword ptr [esp+24h], 1
		jnz	short loc_40D36B
		push	edi
		call	sub_410D60
		add	esp, 4
		test	eax, eax
		jz	loc_40F7AB

loc_40D36B:				; CODE XREF: .text:0040D351j
					; .text:0040D358j
		mov	eax, dword_43041C
		test	eax, eax
		jz	short loc_40D38A
		push	offset dword_430420
		push	edi
		call	sub_410C80
		add	esp, 8
		test	eax, eax
		jz	loc_40F7AB

loc_40D38A:				; CODE XREF: .text:0040D372j
		mov	ecx, [esi+318h]
		mov	edx, dword_430850
		push	ecx
		push	edx
		call	sub_40CDE0
		mov	eax, [esi+324h]
		mov	ecx, [esi+360h]
		mov	edx, [esi+330h]
		push	eax
		push	ecx
		push	edx
		push	edi
		call	sub_40C040
		add	esp, 18h
		push	0
		push	2
		push	offset szHelp
		push	edi
		call	ds:WinHelpA
		mov	eax, dword_430428
		test	eax, eax
		jz	short loc_40D40A
		push	0
		push	0
		push	10h
		push	eax
		call	ds:SendMessageA
		push	edi
		call	ds:DestroyWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D3F7:				; CODE XREF: .text:0040D337j
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	dword_430428, 0

loc_40D40A:				; CODE XREF: .text:0040D3D2j
		push	edi
		call	ds:DestroyWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D420:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		cmp	word ptr [esp+1A4h], 0 ; jumptable 0040CE21 case 6
		jz	loc_40F7AB
		mov	eax, [esp+19Ch]
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_40D488
		mov	ecx, [eax+334h]
		test	ecx, ecx
		jz	short loc_40D46C
		mov	ecx, [eax+358h]
		push	ecx
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D46C:				; CODE XREF: .text:0040D44Ej
		mov	edx, [eax+308h]
		push	edx
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D488:				; CODE XREF: .text:0040D444j
		mov	eax, [eax+308h]
		push	eax
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D4A4:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	ecx, [esp+19Ch]	; jumptable 0040CE21 case 10
		push	0FFFFFFEBh
		push	ecx
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	edi, [esp+1A4h]
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_40D4CD
		push	edi
		call	sub_405700
		add	esp, 4

loc_40D4CD:				; CODE XREF: .text:0040D4C2j
		mov	eax, [esi+20h]
		test	edi, edi
		jz	short loc_40D4D9
		and	ah, 0FDh
		jmp	short loc_40D4DC
; ---------------------------------------------------------------------------

loc_40D4D9:				; CODE XREF: .text:0040D4D2j
		or	ah, 2

loc_40D4DC:				; CODE XREF: .text:0040D4D7j
		mov	edx, [esi+14h]
		mov	[esi+20h], eax
		lea	eax, [esi+18h]
		push	eax
		push	edx
		mov	dword ptr [eax], 4
		call	ds:PGPkmConfigure
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D505:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	edi, [esp+19Ch]	; jumptable 0040CE21 case 2
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, [esi+338h]
		test	eax, eax
		jz	short loc_40D534
		push	eax
		call	sub_405110
		add	esp, 4
		mov	dword ptr [esi+338h], 0

loc_40D534:				; CODE XREF: .text:0040D51Fj
		mov	eax, [esi+4]
		mov	ecx, [esi+14h]
		push	eax
		push	ecx
		call	ds:PGPkmDestroyKeyManager
		mov	edx, [esi+338h]
		push	edx
		call	sub_405110
		mov	eax, [esi+4]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_40D5A3
		mov	eax, [esi+318h]
		test	eax, eax
		jz	short loc_40D56B
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40D56B:				; CODE XREF: .text:0040D560j
		mov	eax, dword_430420
		test	eax, eax
		jz	short loc_40D57D
		push	edi
		call	sub_410D90
		add	esp, 4

loc_40D57D:				; CODE XREF: .text:0040D572j
		mov	eax, [esi+30Ch]
		push	eax
		call	sub_410890
		mov	ecx, himl
		add	esp, 4
		push	ecx
		call	ds:ImageList_Destroy
		push	0
		call	ds:PostQuitMessage
		jmp	short loc_40D5B6
; ---------------------------------------------------------------------------

loc_40D5A3:				; CODE XREF: .text:0040D556j
		mov	eax, [esi+314h]
		test	eax, eax
		jz	short loc_40D5B6
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40D5B6:				; CODE XREF: .text:0040D5A1j
					; .text:0040D5ABj
		mov	eax, [esi+484h]
		test	eax, eax
		jz	short loc_40D5C9
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40D5C9:				; CODE XREF: .text:0040D5BEj
		push	0
		push	0
		push	0
		push	edi
		call	sub_405730
		push	esi
		call	sub_40BF20
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D5ED:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	edx, [esp+19Ch]	; jumptable 0040CE21 case 5
		push	0FFFFFFEBh
		push	edx
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	ebx, [esp+1A8h]
		mov	eax, [esi+330h]
		test	eax, eax
		jz	short loc_40D686
		mov	ecx, [esi+360h]
		mov	edi, ebx
		shr	edi, 10h
		imul	ecx, edi
		mov	eax, 51EB851Fh
		mov	ebp, ebx
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		mov	ecx, edi
		shr	eax, 1Fh
		add	edx, eax
		mov	eax, [esi+324h]
		sub	ecx, eax
		and	ebp, 0FFFFh
		sub	ecx, edx
		push	6
		mov	[esi+35Ch], edx
		mov	edx, [esi+308h]
		lea	eax, [ecx-16h]
		push	eax
		push	ebp
		push	0
		push	0
		push	0
		push	edx
		mov	[esi+328h], eax
		call	ds:SetWindowPos
		mov	eax, [esi+35Ch]
		push	4
		sub	edi, eax
		push	eax
		mov	eax, [esi+358h]
		sub	edi, 14h
		push	ebp
		push	edi
		push	0
		push	0
		push	eax
		jmp	short loc_40D6B5
; ---------------------------------------------------------------------------

loc_40D686:				; CODE XREF: .text:0040D60Ej
		mov	ebp, [esi+324h]
		mov	ecx, ebx
		shr	ecx, 10h
		sub	ecx, ebp
		mov	edx, [esi+308h]
		mov	ebp, ebx
		push	6
		lea	eax, [ecx-14h]
		and	ebp, 0FFFFh
		push	eax
		push	ebp
		push	0
		push	0
		push	0
		mov	[esi+328h], eax
		push	edx

loc_40D6B5:				; CODE XREF: .text:0040D684j
		call	ds:SetWindowPos
		mov	eax, [esi+30h]
		mov	edi, ds:SendMessageA
		push	ebx
		mov	ebx, [esp+1A8h]
		push	ebx
		push	5
		push	eax
		call	edi ; SendMessageA
		mov	ecx, [esi+4]
		lea	edx, [ebp-6Ah]
		neg	ecx
		sbb	ecx, ecx
		lea	eax, [ebp-10h]
		and	ecx, 0FFFFFFEEh
		mov	[esp+50h], edx
		add	ecx, 12h
		mov	[esp+54h], eax
		mov	[esp+4Ch], ecx
		mov	edx, [esi+30h]
		lea	ecx, [esp+4Ch]
		push	ecx
		push	3
		push	404h
		push	edx
		call	edi ; SendMessageA
		mov	eax, [esi+310h]
		test	eax, eax
		jz	short loc_40D733
		xor	ecx, ecx
		mov	cx, [esi+324h]
		shl	ecx, 10h
		or	ecx, ebp
		push	ecx
		push	ebx
		push	5
		push	eax
		call	edi ; SendMessageA
		mov	edx, [esi+310h]
		push	0
		push	0
		push	edx
		call	ds:InvalidateRect

loc_40D733:				; CODE XREF: .text:0040D70Bj
		mov	eax, [esi+30Ch]
		test	eax, eax
		jz	short loc_40D757
		mov	ecx, [esi+324h]
		push	6
		sub	ecx, 4
		push	ecx
		push	ebp
		push	0
		push	0
		push	0
		push	eax
		call	ds:SetWindowPos

loc_40D757:				; CODE XREF: .text:0040D73Bj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D766:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	edx, [esp+19Ch]	; jumptable 0040CE21 case 21
		push	0FFFFFFEBh
		push	edx
		call	ds:GetWindowLongA
		mov	eax, [eax+308h]
		push	0
		push	0
		push	15h
		push	eax
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D798:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	ecx, [esp+19Ch]	; jumptable 0040CE21 case 26
		push	0FFFFFFEBh
		push	ecx
		call	ds:GetWindowLongA
		cmp	dword ptr [esp+1A4h], 69h
		jnz	short loc_40D7CA
		push	eax
		call	sub_410630
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D7CA:				; CODE XREF: .text:0040D7B0j
		mov	edx, [eax+308h]
		push	0
		push	0
		push	15h
		push	edx
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D7EC:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		cmp	dword ptr [esp+1A4h], 3333h ; jumptable	0040CE21 case 43
		jnz	loc_40F7AB
		mov	eax, [esp+19Ch]
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		push	eax
		mov	ecx, [esp+1ACh]
		push	ecx
		call	sub_410320
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D830:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	edx, [esp+19Ch]	; jumptable 0040CE21 case 74
		push	0FFFFFFEBh
		push	edx
		call	ds:GetWindowLongA
		mov	ecx, [esp+1A8h]
		push	ecx
		push	eax
		call	sub_40FF80
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D863:				; CODE XREF: .text:0040CE21j
					; DATA XREF: .text:off_40F9BCo
		mov	ebx, [esp+19Ch]	; jumptable 0040CE21 case 15
		push	0FFFFFFEBh
		push	ebx
		call	ds:GetWindowLongA
		lea	edx, [esp+58h]
		mov	edi, eax
		push	edx
		push	ebx
		call	ds:BeginPaint
		mov	esi, eax
		mov	eax, [edi+30Ch]
		test	eax, eax
		jz	loc_40D92A
		mov	eax, [edi+324h]
		test	eax, eax
		jle	loc_40D92A
		lea	eax, [esp+38h]
		mov	ecx, ebx
		push	eax
		push	ecx
		call	ds:GetWindowRect
		mov	edi, [esp+40h]
		mov	ebx, [esp+38h]
		mov	ebp, ds:GetSysColor
		push	10h
		sub	edi, ebx
		call	ebp ; GetSysColor
		push	eax
		push	0
		push	0
		call	ds:CreatePen
		mov	ebx, ds:SelectObject
		push	eax
		push	esi
		call	ebx ; SelectObject
		push	0
		push	0
		push	0
		push	esi
		mov	[esp+34h], eax
		call	ds:MoveToEx
		push	0
		push	edi
		push	esi
		call	ds:LineTo
		push	14h
		call	ebp ; GetSysColor
		push	eax
		push	0
		push	0
		call	ds:CreatePen
		push	eax
		push	esi
		call	ebx ; SelectObject
		push	0
		push	1
		push	0
		push	esi
		call	ds:MoveToEx
		push	1
		push	edi
		push	esi
		call	ds:LineTo
		mov	edx, [esp+24h]
		push	edx
		push	esi
		call	ebx ; SelectObject
		mov	ebx, [esp+19Ch]

loc_40D92A:				; CODE XREF: .text:0040D88Bj
					; .text:0040D899j
		lea	eax, [esp+58h]
		push	eax
		push	ebx
		call	ds:EndPaint
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D945:				; CODE XREF: .text:0040CE07j
		mov	edi, [esp+19Ch]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	ebp, eax
		mov	eax, [esp+1A4h]
		cmp	eax, 191h
		jnz	loc_40DA76
		mov	esi, [esp+1A8h]
		cmp	dword ptr [esi+8], 0FFFFFF9Ah
		jnz	short loc_40D98A
		mov	ecx, [ebp+338h]
		push	10000000h
		push	ecx
		call	sub_401D70
		add	esp, 8

loc_40D98A:				; CODE XREF: .text:0040D974j
		mov	edx, [ebp+14h]
		push	esi
		push	edx
		call	ds:PGPkmDefaultNotificationProc
		mov	eax, [esi+8]
		add	esp, 8
		cmp	eax, 0FFFFFF90h
		jz	short loc_40DA07
		cmp	eax, 0FFFFFF93h
		jz	short loc_40D9D6
		cmp	eax, 0FFFFFF9Ah
		jnz	loc_40F7AB
		mov	dword ptr [ebp+334h], 0
		mov	eax, [esi+0Ch]
		push	ebp
		mov	[ebp+10h], eax
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40D9D6:				; CODE XREF: .text:0040D9A3j
		mov	dword ptr [ebp+334h], 0
		mov	ecx, [esi+0Ch]
		mov	[ebp+10h], ecx

loc_40D9E6:				; CODE XREF: .text:0040DB08j
		mov	edx, [esi+68h]
		mov	eax, [esi+64h]
		push	edx
		push	eax
		push	edi
		push	ebp
		call	sub_40B830
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40DA07:				; CODE XREF: .text:0040D99Ej
		mov	eax, [ebp+330h]
		test	eax, eax
		jz	loc_40F7AB

loc_40DA15:				; CODE XREF: .text:0040DAB6j
		cmp	word ptr [esi+0Ch], 9
		jnz	loc_40F7AB
		mov	ecx, [ebp+30h]
		push	offset byte_430394
		push	1
		push	401h
		push	ecx
		call	ds:SendMessageA
		mov	edx, [ebp+334h]
		xor	eax, eax
		test	edx, edx
		setz	al
		test	eax, eax
		mov	[ebp+334h], eax
		jz	loc_40DB0D
		mov	edx, [ebp+358h]
		push	edx
		call	ds:SetFocus
		push	ebp
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40DA76:				; CODE XREF: .text:0040D963j
		cmp	eax, 192h
		jnz	loc_40DB32
		mov	esi, [esp+1A8h]
		cmp	dword ptr [esi+8], 0FFFFFF9Ah
		jnz	short loc_40DAA0
		mov	ecx, [ebp+14h]
		push	20000000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8

loc_40DAA0:				; CODE XREF: .text:0040DA8Cj
		mov	edx, [ebp+338h]
		push	esi
		push	edx
		call	sub_4030D0
		mov	eax, [esi+8]
		add	esp, 8
		cmp	eax, 0FFFFFF90h
		jz	loc_40DA15
		cmp	eax, 0FFFFFF93h
		jz	short loc_40DAF5
		cmp	eax, 0FFFFFF9Ah
		jnz	loc_40F7AB
		mov	dword ptr [ebp+334h], 1
		mov	eax, [esi+0Ch]
		push	ebp
		mov	[ebp+354h], eax
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40DAF5:				; CODE XREF: .text:0040DABFj
		mov	dword ptr [ebp+334h], 1
		mov	ecx, [esi+0Ch]
		mov	[ebp+354h], ecx
		jmp	loc_40D9E6
; ---------------------------------------------------------------------------

loc_40DB0D:				; CODE XREF: .text:0040DA4Bj
		mov	eax, [ebp+308h]
		push	eax
		call	ds:SetFocus
		push	ebp
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40DB32:				; CODE XREF: .text:0040DA7Bj
		mov	eax, [ebp+310h]
		mov	ebx, [esp+1A8h]
		test	eax, eax
		jz	loc_40E18E
		mov	ecx, [ebx]
		cmp	ecx, eax
		jnz	loc_40E18E
		mov	eax, [ebx+8]
		add	eax, 0FFFF7F9Ch	; switch 6 cases
		cmp	eax, 5
		ja	loc_40E14E	; jumptable 0040DB62 default case
		jmp	ds:off_40FA38[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40DB69:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		mov	edx, [ebp+308h]	; jumptable 0040DB62 case 32870
		lea	ecx, [esp+38h]
		push	ecx
		push	edx
		call	ds:GetClientRect
		mov	ebp, [esp+3Ch]
		mov	ecx, [ebx+0Ch]
		mov	eax, [esp+44h]
		add	ecx, 32h
		sub	eax, ebp
		xor	edx, edx
		cmp	eax, ecx
		pop	edi
		setnle	dl
		pop	esi
		pop	ebp
		mov	eax, edx
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40DBA1:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		lea	eax, [esp+24h]	; jumptable 0040DB62 case 32869
		push	eax
		push	ecx
		call	ds:GetWindowRect
		mov	ecx, [esp+30h]
		mov	edx, [esp+28h]
		sub	ecx, edx
		lea	edx, [esp+38h]
		push	edx
		push	edi
		mov	[ebp+324h], ecx
		call	ds:GetClientRect
		mov	eax, [ebp+324h]
		mov	ebx, [esp+3Ch]
		mov	ecx, [esp+44h]
		mov	edx, [esp+40h]
		sub	ecx, eax
		push	4
		sub	ecx, ebx
		mov	ebx, [esp+3Ch]
		sub	ecx, 14h
		sub	edx, ebx
		push	ecx
		push	edx
		push	eax
		mov	eax, [ebp+308h]
		push	0
		push	0
		push	eax
		call	ds:SetWindowPos
		push	0
		push	0
		push	edi
		call	ds:InvalidateRect
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40DC0E:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		mov	eax, [ebp+370h]	; jumptable 0040DB62 case 32868
		mov	esi, ds:UpdateWindow
		test	eax, eax
		jz	short loc_40DC4F
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	ecx, [ebp+30h]
		push	0
		push	0
		push	ecx
		mov	dword ptr [ebp+370h], 0
		mov	dword ptr [ebp+374h], 0FFFFFFFFh
		call	ds:InvalidateRect
		mov	edx, [ebp+30h]
		push	edx
		call	esi ; UpdateWindow

loc_40DC4F:				; CODE XREF: .text:0040DC1Cj
		mov	eax, [ebx+2E4h]
		test	eax, eax
		jz	short loc_40DCB8
		cmp	eax, 0FFFFD3ECh
		jz	short loc_40DCB8
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	eax, [ebp+30h]
		push	offset byte_430394
		push	1
		push	401h
		push	eax
		mov	dword ptr [ebp+370h], 0
		mov	dword ptr [ebp+374h], 0FFFFFFFFh
		call	ds:SendMessageA
		mov	ecx, [ebp+30h]
		push	0
		push	0
		push	ecx
		call	ds:InvalidateRect
		mov	edx, [ebx+2E4h]
		push	edx
		push	0
		call	ds:PGPclErrorBox
		add	esp, 8
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40DCB8:				; CODE XREF: .text:0040DC57j
					; .text:0040DC5Ej
		mov	ecx, hModule
		lea	eax, [esp+58h]
		push	40h
		push	eax
		push	825h
		push	ecx
		call	ds:LoadStringA
		mov	eax, [ebp+30h]
		lea	edx, [esp+58h]
		push	edx
		push	1
		push	401h
		push	eax
		call	ds:SendMessageA
		mov	ecx, [ebp+30h]
		push	ecx
		call	esi ; UpdateWindow
		push	7F02h
		push	0
		call	ds:LoadCursorA
		push	eax
		call	ds:SetCursor
		mov	edx, [ebp+314h]
		mov	[esp+34h], eax
		mov	eax, [ebx+0Ch]
		mov	[ebp+314h], eax
		mov	al, [ebx+2E8h]
		test	al, 1
		mov	[esp+24h], edx
		jz	short loc_40DD72
		mov	eax, 1
		mov	dword ptr [ebp+34h], 0
		mov	[ebp+0Ch], eax
		mov	dword ptr [ebp+20h], 0A2h
		mov	cl, byte_4303BC
		test	cl, cl
		jnz	short loc_40DD49
		mov	dword ptr [ebp+20h], 0A6h

loc_40DD49:				; CODE XREF: .text:0040DD40j
		mov	cl, byte_4303BD
		test	cl, cl
		jz	short loc_40DD5C
		mov	ecx, [ebp+20h]
		or	ch, 8
		mov	[ebp+20h], ecx

loc_40DD5C:				; CODE XREF: .text:0040DD51j
		mov	ecx, dword_4303C0
		test	ecx, ecx
		jz	short loc_40DD69
		or	[ebp+20h], eax

loc_40DD69:				; CODE XREF: .text:0040DD64j
		mov	dword ptr [ebp+24h], 1000E002h
		jmp	short loc_40DDCF
; ---------------------------------------------------------------------------

loc_40DD72:				; CODE XREF: .text:0040DD20j
		lea	esi, [ebx+10h]
		lea	edi, [ebp+34h]
		mov	ecx, 0B5h
		mov	dword ptr [ebp+0Ch], 0
		rep movsd
		mov	dword ptr [ebp+20h], 20h
		mov	al, byte_4303BC
		test	al, al
		jnz	short loc_40DD9D
		mov	dword ptr [ebp+20h], 24h

loc_40DD9D:				; CODE XREF: .text:0040DD94j
		mov	al, byte_4303BD
		test	al, al
		jz	short loc_40DDAF
		mov	eax, [ebp+20h]
		or	ah, 8
		mov	[ebp+20h], eax

loc_40DDAF:				; CODE XREF: .text:0040DDA4j
		test	byte ptr [ebx+2E8h], 4
		jz	short loc_40DDC1
		mov	eax, [ebp+20h]
		or	ah, 1
		mov	[ebp+20h], eax

loc_40DDC1:				; CODE XREF: .text:0040DDB6j
		mov	edi, [esp+19Ch]
		mov	dword ptr [ebp+24h], 0E002h

loc_40DDCF:				; CODE XREF: .text:0040DD70j
		mov	ecx, [ebp+14h]
		lea	eax, [ebp+18h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 0Eh
		call	ds:PGPkmConfigure
		mov	edx, [ebp+318h]
		mov	eax, [ebp+314h]
		mov	ecx, [ebp+14h]
		mov	esi, ds:PGPkmLoadKeySet
		push	edx
		push	eax
		push	ecx
		call	esi ; PGPkmLoadKeySet
		mov	edx, [ebp+308h]
		add	esp, 14h
		push	edx
		call	ds:SetFocus
		mov	eax, [ebp+314h]
		mov	ecx, [ebp+318h]
		mov	edx, dword_430850
		push	eax
		push	ecx
		push	edx
		call	ds:PGPclSyncKeySets
		mov	eax, [ebp+318h]
		mov	ecx, [ebp+314h]
		mov	edx, [ebp+14h]
		push	eax
		push	ecx
		push	edx
		call	esi ; PGPkmLoadKeySet
		mov	eax, [ebx+2E4h]
		mov	ecx, [ebp+30h]
		mov	edx, [ebp+314h]
		push	eax
		push	ecx
		push	edx
		call	sub_410580
		mov	eax, [ebp+370h]
		add	esp, 24h
		test	eax, eax
		jz	short loc_40DE8B
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	eax, [ebp+30h]
		push	0
		push	0
		push	eax
		mov	dword ptr [ebp+370h], 0
		mov	dword ptr [ebp+374h], 0FFFFFFFFh
		call	ds:InvalidateRect

loc_40DE8B:				; CODE XREF: .text:0040DE5Ej
		mov	eax, [esp+24h]
		test	eax, eax
		jz	short loc_40DE9C
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40DE9C:				; CODE XREF: .text:0040DE91j
		mov	ecx, [esp+34h]
		push	ecx
		call	ds:SetCursor
		mov	edx, [ebp+310h]
		push	0
		push	0
		push	8070h
		push	edx
		call	ds:SendMessageA
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40DEC2:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		mov	eax, [ebx+110h]	; jumptable 0040DB62 case 32871
		mov	esi, 1
		test	eax, eax
		mov	eax, [ebp+370h]
		jz	loc_40DF8E
		test	eax, eax
		jnz	short loc_40DF5B
		mov	edx, [ebp+20h]
		lea	eax, [ebp+18h]
		push	eax
		or	dh, 10h
		mov	dword ptr [eax], 4
		mov	eax, [ebp+14h]
		push	eax
		mov	[ebp+370h], esi
		mov	[ebp+20h], edx
		call	ds:PGPkmConfigure
		mov	dword ptr [ebp+374h], 0
		mov	eax, [ebx+10Ch]
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40DF2F
		push	0
		push	64h
		push	6Fh
		push	edi
		mov	[ebp+37Ch], esi
		call	ds:SetTimer
		jmp	short loc_40DF3D
; ---------------------------------------------------------------------------

loc_40DF2F:				; CODE XREF: .text:0040DF18j
		xor	eax, eax
		mov	[ebp+37Ch], eax
		mov	[ebp+374h], eax

loc_40DF3D:				; CODE XREF: .text:0040DF2Dj
		mov	ecx, [ebp+30h]
		push	0
		push	1200h
		push	401h
		push	ecx
		call	ds:SendMessageA
		mov	[ebp+380h], esi
		jmp	short loc_40DFBD
; ---------------------------------------------------------------------------

loc_40DF5B:				; CODE XREF: .text:0040DEDDj
		cmp	dword ptr [ebx+10Ch], 0FFFFFFFFh
		jz	short loc_40DFBD
		mov	dword ptr [ebp+37Ch], 0
		mov	eax, [ebx+10Ch]
		push	0
		push	0
		lea	eax, [eax+eax*8]
		cdq
		idiv	dword ptr [ebx+110h]
		mov	edx, [ebp+30h]
		push	edx
		mov	[ebp+374h], eax
		jmp	short loc_40DFB7
; ---------------------------------------------------------------------------

loc_40DF8E:				; CODE XREF: .text:0040DED5j
		test	eax, eax
		jz	short loc_40DFBD
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	eax, [ebp+30h]
		push	0
		push	0
		mov	dword ptr [ebp+370h], 0
		mov	dword ptr [ebp+374h], 0FFFFFFFFh
		push	eax

loc_40DFB7:				; CODE XREF: .text:0040DF8Cj
		call	ds:InvalidateRect

loc_40DFBD:				; CODE XREF: .text:0040DF59j
					; .text:0040DF62j ...
		mov	ecx, [ebp+30h]
		add	ebx, 0Ch
		push	ebx
		push	esi
		push	401h
		push	ecx
		call	ds:SendMessageA
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40DFD6:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		mov	edx, [ebx+0Ch]	; jumptable 0040DB62 case 32873
		mov	eax, [ebp+30h]
		push	edx
		push	1200h
		push	401h
		push	eax
		call	ds:SendMessageA
		mov	eax, [ebx+0Ch]
		test	eax, eax
		jz	loc_40E0BF
		lea	ecx, [ebx+10h]
		lea	edx, [ebp+384h]
		push	ecx
		push	edx
		mov	dword ptr [ebp+380h], 2
		call	ds:lstrcpyA
		mov	eax, [ebx+114h]
		lea	esi, [ebp+484h]
		mov	[ebp+48Ch], eax
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_40E035
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_40E035:				; CODE XREF: .text:0040E02Aj
		mov	edx, [ebx+110h]
		lea	ecx, [esp+48h]
		push	ecx
		push	edx
		call	PGPNewSingletonKeySet
		mov	eax, dword_430850
		push	esi
		push	eax
		call	PGPNewKeySet
		mov	ecx, [esi]
		mov	edx, [esp+58h]
		push	ecx
		push	edx
		call	PGPAddKeys
		mov	eax, [esi]
		push	eax
		call	PGPCommitKeyRingChanges
		mov	ecx, [esp+64h]
		push	ecx
		call	PGPFreeKeySet
		mov	eax, [esi]
		lea	edx, [esp+44h]
		push	edx
		push	1
		push	eax
		call	PGPOrderKeySet
		mov	edx, [esp+50h]
		lea	ecx, [esp+60h]
		push	ecx
		push	edx
		call	PGPNewKeyIter
		mov	ecx, [esp+68h]
		lea	eax, [ebp+488h]
		push	eax
		push	ecx
		call	PGPKeyIterNext
		mov	edx, [esp+70h]
		push	edx
		call	PGPFreeKeyIter
		mov	eax, [esp+64h]
		add	esp, 40h
		push	eax
		call	PGPFreeKeyList
		add	esp, 4
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40E0BF:				; CODE XREF: .text:0040DFF3j
		mov	dword ptr [ebp+380h], 1
		jmp	loc_40E14E	; jumptable 0040DB62 default case
; ---------------------------------------------------------------------------

loc_40E0CE:				; CODE XREF: .text:0040DB62j
					; DATA XREF: .text:off_40FA38o
		mov	eax, [ebp+370h]	; jumptable 0040DB62 case 32872
		test	eax, eax
		jz	short loc_40E103
		push	6Fh
		push	edi
		call	ds:KillTimer
		mov	ecx, [ebp+30h]
		push	0
		push	0
		push	ecx
		mov	dword ptr [ebp+370h], 0
		mov	dword ptr [ebp+374h], 0FFFFFFFFh
		call	ds:InvalidateRect

loc_40E103:				; CODE XREF: .text:0040E0D6j
		mov	eax, hModule
		lea	edx, [esp+98h]
		push	100h
		push	edx
		push	822h
		push	eax
		call	ds:LoadStringA
		mov	edx, [ebp+30h]
		mov	edi, ds:SendMessageA
		lea	ecx, [esp+98h]
		push	ecx
		push	1
		push	401h
		push	edx
		call	edi ; SendMessageA
		mov	eax, [ebp+310h]
		push	0
		push	0
		push	8070h
		push	eax
		call	edi ; SendMessageA

loc_40E14E:				; CODE XREF: .text:0040DB5Cj
					; .text:0040DC09j ...
		mov	eax, [ebp+370h]	; jumptable 0040DB62 default case
		test	eax, eax
		jnz	loc_40F7AB
		mov	edi, [ebp+20h]
		mov	ecx, [ebp+14h]
		lea	eax, [ebp+18h]
		and	edi, 0FFFFEFFFh
		push	eax
		push	ecx
		mov	[ebp+20h], edi
		mov	dword ptr [eax], 4
		call	ds:PGPkmConfigure
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E18E:				; CODE XREF: .text:0040DB41j
					; .text:0040DB4Bj
		mov	eax, [ebp+30h]
		test	eax, eax
		jz	loc_40E270
		cmp	[ebx], eax
		jnz	loc_40E270
		cmp	dword ptr [ebx+8], 0FFFFFFFEh
		jnz	loc_40F7AB
		mov	eax, [ebp+4]
		test	eax, eax
		jnz	loc_40F7AB
		lea	edx, [esp+24h]
		push	edx
		call	ds:GetCursorPos
		mov	ecx, [ebp+30h]
		lea	eax, [esp+24h]
		push	eax
		push	ecx
		call	ds:ScreenToClient
		cmp	dword ptr [esp+24h], 12h
		jg	loc_40F7AB
		mov	eax, [ebp+380h]
		sub	eax, 0
		jz	short loc_40E24F
		dec	eax
		jz	short loc_40E22E
		dec	eax
		jnz	loc_40F7AB
		mov	edx, [ebp+318h]
		mov	eax, [ebp+48Ch]
		mov	ecx, [ebp+488h]
		push	0
		push	edx
		mov	edx, dword_430850
		push	eax
		add	ebp, 384h
		push	ecx
		push	ebp
		push	edi
		push	edx
		call	ds:PGPclConfirmRemoteAuthentication
		add	esp, 1Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E22E:				; CODE XREF: .text:0040E1E7j
		push	30h
		push	84Eh
		push	3
		push	edi
		call	sub_402000
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E24F:				; CODE XREF: .text:0040E1E4j
		push	30h
		push	84Fh
		push	3
		push	edi
		call	sub_402000
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E270:				; CODE XREF: .text:0040E193j
					; .text:0040E19Bj
		cmp	dword ptr [ebx+8], 0FFFFFDF8h
		jnz	loc_40F7AB
		push	ebx
		call	sub_4108D0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E295:				; CODE XREF: .text:0040CE01j
		cmp	eax, 202h
		ja	loc_40F3EE
		jz	loc_40F3B7
		lea	ecx, [eax-111h]	; switch 241 cases
		cmp	ecx, 0F0h
		ja	loc_40F709	; jumptable 0040CE21 default case
		xor	edx, edx
		mov	dl, ds:byte_40FA68[ecx]
		jmp	ds:off_40FA50[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40E2C7:				; CODE XREF: .text:0040E2C0j
					; DATA XREF: .text:off_40FA50o
		mov	eax, [esp+19Ch]	; jumptable 0040E2C0 case 278
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	edx, [eax+31Ch]
		mov	ecx, [esp+1A4h]
		cmp	ecx, edx
		jnz	loc_40F7AB
		push	eax
		call	sub_40B090
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E304:				; CODE XREF: .text:0040E2C0j
					; DATA XREF: .text:off_40FA50o
		mov	edi, [esp+19Ch]	; jumptable 0040E2C0 case 512
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	eax, [esi+330h]
		test	eax, eax
		jz	loc_40F7AB
		mov	ebx, [esp+1A8h]
		mov	eax, [esi+368h]
		shr	ebx, 10h
		test	eax, eax
		jz	loc_40E3F7
		lea	edx, [esp+10h]
		push	edx
		push	edi
		call	ds:GetClientRect
		mov	edi, [esp+1Ch]
		sub	edi, [esp+14h]
		test	edi, edi
		jle	loc_40F7AB
		mov	ecx, edi
		sub	ecx, ebx
		sub	ecx, 16h
		cmp	ecx, 32h
		jle	short loc_40E383
		lea	eax, [edi-32h]
		cmp	ecx, eax
		jge	short loc_40E383
		lea	eax, [ecx+ecx*4]
		mov	[esi+35Ch], ecx
		lea	eax, [eax+eax*4]
		shl	eax, 2
		cdq
		idiv	edi
		mov	[esi+360h], eax

loc_40E383:				; CODE XREF: .text:0040E362j
					; .text:0040E369j
		mov	ebp, [esi+324h]
		mov	ebx, [esi+35Ch]
		mov	ecx, edi
		push	6
		sub	ecx, ebp
		sub	ecx, ebx
		mov	ebx, ds:SetWindowPos
		lea	eax, [ecx-16h]
		mov	[esi+328h], eax
		mov	edx, [esp+1Ch]
		mov	ebp, [esp+14h]
		push	eax
		mov	eax, [esi+308h]
		sub	edx, ebp
		push	edx
		push	0
		push	0
		push	0
		push	eax
		call	ebx ; SetWindowPos
		mov	eax, [esi+35Ch]
		mov	ebp, [esp+10h]
		mov	ecx, [esp+18h]
		mov	edx, [esi+358h]
		sub	edi, eax
		push	4
		sub	ecx, ebp
		push	eax
		sub	edi, 14h
		push	ecx
		push	edi
		push	0
		push	0
		push	edx
		call	ebx ; SetWindowPos
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E3F7:				; CODE XREF: .text:0040E336j
		mov	eax, [esi+328h]
		mov	ebp, [esi+324h]
		add	eax, ebp
		lea	ecx, [eax-2]
		cmp	ebx, ecx
		jl	short loc_40E44D
		add	eax, 4
		cmp	ebx, eax
		jg	short loc_40E44D
		push	7F85h
		push	0
		mov	dword ptr [esi+364h], 1
		call	ds:LoadCursorA
		push	eax
		call	ds:SetCursor
		push	edi
		mov	[esi+36Ch], eax
		call	ds:SetCapture
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E44D:				; CODE XREF: .text:0040E40Aj
					; .text:0040E411j
		mov	eax, [esi+364h]
		test	eax, eax
		jz	loc_40F7AB
		mov	edx, [esi+36Ch]
		mov	dword ptr [esi+364h], 0
		push	edx
		call	ds:SetCursor
		call	ds:ReleaseCapture
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E487:				; CODE XREF: .text:0040E2C0j
					; DATA XREF: .text:off_40FA50o
		mov	eax, [esp+19Ch]	; jumptable 0040E2C0 case 513
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	ecx, [eax+364h]
		test	ecx, ecx
		jz	loc_40F7AB
		pop	edi
		pop	esi
		mov	dword ptr [eax+368h], 1
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E4BE:				; CODE XREF: .text:0040E2C0j
					; DATA XREF: .text:off_40FA50o
		mov	edi, [esp+19Ch]	; jumptable 0040E2C0 case 275
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		xor	ebp, ebp
		cmp	dword ptr [esp+1A4h], 458h
		jnz	loc_40E6EF
		push	458h
		push	edi
		call	ds:KillTimer
		push	esi
		mov	dword_430424, 1
		call	sub_4100C0
		add	esp, 4
		test	eax, eax
		jz	loc_40E740
		push	ebp
		push	ebp
		push	edi
		call	ds:InvalidateRect
		cmp	dword_42F1D4, ebp
		jz	loc_40E6B4
		mov	dword_42F1D4, ebp
		mov	ecx, [esi+318h]
		push	ecx
		push	1
		push	1
		call	ds:GetCommandLineA
		push	eax
		call	sub_40FDC0
		mov	edx, [esi+318h]
		push	edx
		call	sub_4100B0
		mov	ebx, ds:PGPkmReLoadKeySet
		add	esp, 14h
		test	eax, eax
		jnz	short loc_40E55F
		mov	eax, [esi+14h]
		push	ebp
		push	eax
		call	ebx ; PGPkmReLoadKeySet
		add	esp, 8

loc_40E55F:				; CODE XREF: .text:0040E553j
		cmp	dword_430854, ebp
		jz	short loc_40E579
		push	ebp
		push	9C6Dh
		push	111h
		push	edi
		call	ds:PostMessageA

loc_40E579:				; CODE XREF: .text:0040E565j
		mov	al, byte ptr dword_42F0DC
		test	al, al
		jz	short loc_40E5FB
		mov	edx, dword_430850
		lea	ecx, [esp+24h]
		push	ecx
		push	edx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	ecx, [esp+2Ch]
		lea	eax, [esp+2Ah]
		push	eax
		push	0Ch
		push	ecx
		call	sub_41B3D0
		mov	edx, [esp+38h]
		push	ebp
		push	edx
		call	ds:PGPclCloseClientPrefs
		mov	al, [esp+3Eh]
		add	esp, 1Ch
		test	al, al
		jnz	short loc_40E5FB
		mov	eax, [esi+318h]
		push	eax
		call	sub_40FD20
		add	esp, 4
		test	eax, eax
		jnz	short loc_40E5FB
		mov	ecx, hWnd
		push	ebp
		push	ecx
		call	ds:ShowWindow
		mov	edx, [esi+318h]
		mov	eax, hWnd
		push	edx
		push	eax
		call	sub_405B40
		add	esp, 8

loc_40E5FB:				; CODE XREF: .text:0040E580j
					; .text:0040E5C3j ...
		mov	ecx, [esi+318h]
		mov	edx, dword_430850
		push	ecx
		push	edx
		call	sub_40CDE0
		add	esp, 8
		lea	eax, [esp+21h]
		lea	ecx, [esp+20h]
		lea	edx, [esp+23h]
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edx
		push	1
		push	eax
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclCheckAutoUpdate
		mov	al, [esp+37h]
		add	esp, 14h
		test	al, al
		jz	short loc_40E661
		mov	ecx, [esi+318h]
		push	ebp
		push	ecx
		push	edi
		call	sub_40C3B0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_40E661
		mov	edx, [esi+14h]
		push	ebp
		push	edx
		call	ebx ; PGPkmReLoadKeySet
		add	esp, 8

loc_40E661:				; CODE XREF: .text:0040E640j
					; .text:0040E655j
		mov	al, [esp+20h]
		test	al, al
		jz	short loc_40E689
		mov	eax, [esi+318h]
		push	ebp
		push	eax
		push	edi
		call	sub_40C4E0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_40E689
		mov	ecx, [esi+14h]
		push	1
		push	ecx
		call	ebx ; PGPkmReLoadKeySet
		add	esp, 8

loc_40E689:				; CODE XREF: .text:0040E667j
					; .text:0040E67Cj
		mov	al, [esp+21h]
		test	al, al
		jz	short loc_40E6B4
		mov	edx, [esi+318h]
		mov	eax, [esi+14h]
		push	edx
		push	eax
		push	edi
		call	sub_40CD70
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_40E6B4
		mov	ecx, [esi+14h]
		push	1
		push	ecx
		call	ebx ; PGPkmReLoadKeySet
		add	esp, 8

loc_40E6B4:				; CODE XREF: .text:0040E519j
					; .text:0040E68Fj ...
		cmp	[esi+4], ebp
		jz	loc_40E740
		mov	eax, dword_430428
		cmp	eax, ebp
		jz	short loc_40E740
		mov	edx, [esi+318h]
		push	edx
		push	ebp
		push	8062h
		push	eax
		call	ds:PostMessageA
		pop	edi
		mov	dword_430424, ebp
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E6EF:				; CODE XREF: .text:0040E4DDj
		mov	eax, [esi+37Ch]
		mov	edx, [esi+374h]
		add	edx, eax
		mov	eax, edx
		mov	[esi+374h], edx
		cmp	eax, ebp
		jg	short loc_40E71B
		mov	[esi+374h], ebp
		mov	dword ptr [esi+37Ch], 1
		jmp	short loc_40E734
; ---------------------------------------------------------------------------

loc_40E71B:				; CODE XREF: .text:0040E707j
		cmp	eax, 9
		jl	short loc_40E734
		mov	dword ptr [esi+374h], 9
		mov	dword ptr [esi+37Ch], 0FFFFFFFFh

loc_40E734:				; CODE XREF: .text:0040E719j
					; .text:0040E71Ej
		mov	ecx, [esi+30h]
		push	ebp
		push	ebp
		push	ecx
		call	ds:InvalidateRect

loc_40E740:				; CODE XREF: .text:0040E504j
					; .text:0040E6B7j ...
		pop	edi
		mov	dword_430424, ebp
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E755:				; CODE XREF: .text:0040E2C0j
					; DATA XREF: .text:off_40FA50o
		mov	edi, [esp+19Ch]	; jumptable 0040E2C0 case 273
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	ebp, [esp+1A4h]
		mov	eax, ebp
		and	eax, 0FFFFh
		cmp	eax, 0A028h
		jg	loc_40F323
		jz	loc_40F2E2
		lea	ecx, [eax-9C46h] ; switch 82 cases
		cmp	ecx, 51h
		ja	loc_40F32A	; jumptable 0040E79D default case
		xor	edx, edx
		mov	dl, ds:byte_40FC2C[ecx]
		jmp	ds:off_40FB5C[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40E7A4:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	0		; jumptable 0040E79D case 40038
		push	0
		push	10h
		push	edi
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E7C0:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+318h]	; jumptable 0040E79D case 40074
		mov	ecx, dword_4303B8
		mov	edx, dword_430850
		push	eax
		push	edi
		push	ecx
		push	edx
		call	ds:PGPclSendShares
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E7EE:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	edi		; jumptable 0040E79D case 40016
		call	sub_4113A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E806:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, hModule	; jumptable 0040E79D case 40087
		lea	eax, [esp+58h]
		push	40h
		push	eax
		push	83Bh
		push	ecx
		call	ds:LoadStringA
		lea	edx, [esp+58h]
		push	edx
		call	ds:PGPclWebBrowse
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E83C:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	0		; jumptable 0040E79D case 40014
		push	0Bh
		push	offset szHelp
		push	edi
		call	ds:WinHelpA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E85B:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	0		; jumptable 0040E79D case 40083
		push	edi
		push	esi
		call	sub_40C2D0
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E876:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	100h		; jumptable 0040E79D case 40008

loc_40E87B:				; CODE XREF: .text:0040ED54j
		mov	eax, [esi+14h]
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E897:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+4]	; jumptable 0040E79D case 40019
		test	eax, eax
		jnz	short loc_40E8CC
		mov	eax, [esi+0Ch]
		test	eax, eax
		jnz	short loc_40E8CC
		cmp	dword ptr [esi+10h], 1
		jnz	short loc_40E8CC
		mov	ecx, [esi+14h]
		push	200000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E8CC:				; CODE XREF: .text:0040E89Cj
					; .text:0040E8A3j ...
		push	400h

loc_40E8D1:				; CODE XREF: .text:0040E918j
		mov	edx, [esi+14h]
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E8ED:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40020
		push	200h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E90E:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40006
		push	4
		test	eax, eax
		jz	short loc_40E8D1
		mov	ecx, [esi+338h]
		push	ecx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E938:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40053
		push	100000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E959:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	al, byte ptr dword_42F0DC ; jumptable 0040E79D case 40041
		test	al, al
		jz	loc_40F7AB
		mov	ecx, [esi+318h]
		push	ecx
		push	edi
		call	sub_405B40
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E985:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+14h]	; jumptable 0040E79D case 40042
		push	4000h
		push	edx
		call	ds:PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40E9BC
		mov	eax, [esi+14h]
		push	4000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E9BC:				; CODE XREF: .text:0040E999j
		mov	ecx, [esi+14h]
		push	2000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40E9DD:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40021
		test	eax, eax
		jz	short loc_40EA19
		mov	edx, [esi+338h]
		push	400h
		push	edx
		call	sub_401D70
		mov	eax, [esi+14h]
		push	20000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EA19:				; CODE XREF: .text:0040E9E5j
		mov	ecx, [esi+14h]
		push	20000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EA3A:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+338h]	; jumptable 0040E79D case 40056
		push	100h
		push	edx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EA5D:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40027
		push	8000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EA7E:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+338h]	; jumptable 0040E79D case 40061
		push	1000h
		push	ecx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EAA1:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+14h]	; jumptable 0040E79D case 40028
		push	10000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EAC2:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40051
		test	eax, eax
		jz	short loc_40EAEF
		mov	eax, [esi+338h]
		push	800h
		push	eax
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EAEF:				; CODE XREF: .text:0040EACAj
		mov	ecx, [esi+14h]
		push	80000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EB10:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+14h]	; jumptable 0040E79D case 40085
		push	400000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EB31:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40049
		push	10000000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EB52:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40024
		push	80h
		test	eax, eax
		jz	short loc_40EBB7
		mov	ecx, [esi+338h]
		push	ecx
		call	sub_401AD0
		add	esp, 8
		test	eax, eax
		jz	short loc_40EB97
		mov	edx, [esi+338h]
		push	80h
		push	edx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EB97:				; CODE XREF: .text:0040EB72j
		mov	eax, [esi+338h]
		push	40h
		push	eax
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EBB7:				; CODE XREF: .text:0040EB5Fj
		mov	ecx, [esi+14h]
		push	ecx
		call	ds:PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40EBE9
		mov	edx, [esi+14h]
		push	80h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EBE9:				; CODE XREF: .text:0040EBC6j
		mov	eax, [esi+14h]
		push	40h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EC07:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40023
		push	20h
		test	eax, eax
		jz	short loc_40EC66
		mov	ecx, [esi+338h]
		push	ecx
		call	sub_401AD0
		add	esp, 8
		test	eax, eax
		jz	short loc_40EC46
		mov	edx, [esi+338h]
		push	20h
		push	edx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EC46:				; CODE XREF: .text:0040EC24j
		mov	eax, [esi+338h]
		push	10h
		push	eax
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EC66:				; CODE XREF: .text:0040EC11j
		mov	ecx, [esi+14h]
		push	ecx
		call	ds:PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_40EC95
		mov	edx, [esi+14h]
		push	20h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EC95:				; CODE XREF: .text:0040EC75j
		mov	eax, [esi+14h]
		push	10h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ECB3:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40030
		push	8
		test	eax, eax
		jz	short loc_40ECE6
		mov	ecx, [esi+338h]
		push	ecx
		call	sub_401D70
		add	esp, 8
		push	esi
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ECE6:				; CODE XREF: .text:0040ECBDj
		mov	edx, [esi+14h]
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		push	esi
		call	sub_4109A0
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ED0B:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40010
		push	1000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ED2C:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+14h]	; jumptable 0040E79D case 40032
		push	1
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ED4A:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+334h]	; jumptable 0040E79D case 40033
		push	2
		test	eax, eax
		jz	loc_40E87B
		mov	edx, [esi+338h]
		push	edx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ED78:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+14h]	; jumptable 0040E79D case 40025
		push	800h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40ED99:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+14h]	; jumptable 0040E79D case 40076
		push	4000000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EDBA:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40081
		push	8000000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EDDB:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+14h]	; jumptable 0040E79D case 40084
		push	800000h
		push	ecx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EDFC:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+14h]	; jumptable 0040E79D case 40073
		push	2000000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EE1D:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+14h]	; jumptable 0040E79D case 40072
		push	1000000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EE3E:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40063
		xor	eax, 1

loc_40EE46:				; CODE XREF: .text:0040EECAj
					; .text:0040EF09j
		mov	dword_43042C, eax
		mov	ecx, [esi+14h]
		push	1
		push	eax
		push	ecx

loc_40EE52:				; CODE XREF: .text:0040EEE3j
					; .text:0040EEFCj ...
		call	ds:PGPkmSelectColumns
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EE6A:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40064
		push	1
		xor	eax, 2
		mov	dword_43042C, eax
		mov	edx, [esi+14h]
		push	eax
		push	edx
		call	ds:PGPkmSelectColumns
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EE96:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40065
		push	1
		xor	eax, 4
		mov	dword_43042C, eax
		push	eax
		mov	eax, [esi+14h]
		push	eax
		call	ds:PGPkmSelectColumns
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EEC2:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40066
		xor	eax, 8
		jmp	loc_40EE46
; ---------------------------------------------------------------------------

loc_40EECF:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40067
		push	1
		xor	eax, 10h
		mov	dword_43042C, eax
		mov	edx, [esi+14h]
		push	eax
		push	edx
		jmp	loc_40EE52
; ---------------------------------------------------------------------------

loc_40EEE8:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40068
		push	1
		xor	eax, 20h
		mov	dword_43042C, eax
		push	eax
		mov	eax, [esi+14h]
		push	eax
		jmp	loc_40EE52
; ---------------------------------------------------------------------------

loc_40EF01:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40069
		xor	eax, 40h
		jmp	loc_40EE46
; ---------------------------------------------------------------------------

loc_40EF0E:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, dword_43042C ; jumptable 0040E79D case 40070
		push	1
		xor	eax, 80h
		mov	dword_43042C, eax
		mov	edx, [esi+14h]
		push	eax
		push	edx
		jmp	loc_40EE52
; ---------------------------------------------------------------------------

loc_40EF29:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+324h]	; jumptable 0040E79D case 40071
		lea	ecx, [esp+10h]
		neg	eax
		sbb	eax, eax
		push	ecx
		and	al, 0E4h
		push	edi
		add	eax, 1Ch
		mov	[esi+324h], eax
		call	ds:GetClientRect
		mov	ebp, [esi+324h]
		mov	ebx, [esp+14h]
		mov	edx, [esp+1Ch]
		mov	ecx, [esi+35Ch]
		sub	edx, ebp
		sub	edx, ebx
		test	ecx, ecx
		lea	eax, [edx-14h]
		mov	[esi+328h], eax
		jz	short loc_40EF7A
		sub	eax, ecx
		sub	eax, 2
		mov	[esi+328h], eax

loc_40EF7A:				; CODE XREF: .text:0040EF6Dj
		push	0
		push	0
		push	805Fh
		push	edi
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EF99:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+338h]	; jumptable 0040E79D case 40059
		push	400h
		push	eax
		call	sub_401D70
		mov	ecx, [esi+308h]
		add	esp, 8
		mov	dword ptr [esi+334h], 0
		push	ecx
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40EFD3:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+318h]	; jumptable 0040E79D case 40075
		push	0
		push	edx
		push	edi
		call	sub_40C4E0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_40F7AB
		mov	eax, [esi+14h]
		push	1
		push	eax
		call	ds:PGPkmReLoadKeySet
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F00B:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+318h]	; jumptable 0040E79D case 40086
		mov	edx, [esi+14h]
		push	ecx
		push	edx
		push	edi
		call	sub_40CD70
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F02E:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+338h]	; jumptable 0040E79D case 40079
		push	2000h
		push	eax
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F051:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	ecx, [esi+338h]	; jumptable 0040E79D case 40080
		push	4000h
		push	ecx
		call	sub_401D70
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F074:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	edx, [esi+338h]	; jumptable 0040E79D case 40047
		push	edx
		call	sub_402D60
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F092:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+330h]	; jumptable 0040E79D case 40045
		xor	ebx, ebx
		cmp	eax, ebx
		jz	short loc_40F101
		mov	eax, [esi+31Ch]
		push	ebx
		push	9C6Dh
		push	eax
		mov	[esi+330h], ebx
		call	ds:CheckMenuItem
		lea	ecx, [esp+10h]
		mov	[esi+35Ch], ebx
		push	ecx
		push	edi
		call	ds:GetClientRect
		mov	ecx, [esi+324h]
		push	ebx
		mov	edx, [esp+20h]
		mov	eax, [esp+18h]
		sub	edx, ecx
		push	ebx
		sub	edx, eax
		push	805Fh
		sub	edx, 14h
		push	edi
		mov	[esi+328h], edx
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F101:				; CODE XREF: .text:0040F09Cj
		mov	eax, [esi+338h]
		mov	dword ptr [esi+330h], 1
		push	eax
		call	sub_405290
		mov	ecx, [esi+31Ch]
		add	esp, 4
		push	8
		push	9C6Dh
		push	ecx
		call	ds:CheckMenuItem
		lea	edx, [esp+10h]
		push	edx
		push	edi
		call	ds:GetClientRect
		mov	eax, 51EB851Fh
		push	ebx
		mov	ecx, [esp+20h]
		mov	edx, [esp+18h]
		sub	ecx, edx
		push	ebx
		imul	ecx, [esi+360h]
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		push	805Fh
		shr	eax, 1Fh
		add	edx, eax
		mov	eax, [esi+324h]
		mov	[esi+35Ch], edx
		mov	ecx, [esp+28h]
		sub	ecx, eax
		mov	eax, [esp+20h]
		sub	ecx, edx
		push	edi
		sub	ecx, eax
		sub	ecx, 16h
		mov	[esi+328h], ecx
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F19C:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		mov	eax, [esi+318h]	; jumptable 0040E79D case 40046
		test	eax, eax
		jz	loc_40F7AB
		mov	eax, dword_430428
		test	eax, eax
		jz	short loc_40F1D8
		push	9
		push	eax
		call	ds:ShowWindow
		mov	edx, dword_430428
		push	edx
		call	ds:SetForegroundWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F1D8:				; CODE XREF: .text:0040F1B1j
		mov	ecx, [esi+14h]
		lea	eax, [esp+24h]
		push	eax
		push	ecx
		call	ds:PGPkmGetSelectedColumns
		mov	edx, [esp+2Ch]
		mov	eax, [esi+14h]
		push	0
		push	edx
		push	eax
		call	ds:PGPkmSelectColumns
		mov	edx, hModule
		add	esp, 14h
		lea	ecx, [esp+58h]
		push	40h
		push	ecx
		push	490h
		push	edx
		call	ds:LoadStringA
		lea	eax, [esp+38h]
		push	eax
		push	edi
		call	ds:GetWindowRect
		mov	edi, [esp+40h]
		sub	edi, [esp+38h]
		cmp	edi, 1CCh
		jge	short loc_40F235
		mov	edi, 1CCh

loc_40F235:				; CODE XREF: .text:0040F22Ej
		mov	eax, [esp+44h]
		mov	edx, [esp+3Ch]
		sub	eax, edx
		lea	ebx, [eax+eax*2]
		sar	ebx, 2
		cmp	ebx, 104h
		jge	short loc_40F252
		mov	ebx, 104h

loc_40F252:				; CODE XREF: .text:0040F24Bj
		mov	ebp, ds:GetSystemMetrics
		push	0
		call	ebp ; GetSystemMetrics
		mov	ecx, [esp+38h]
		lea	edx, [ecx+edi+3Ch]
		cmp	edx, eax
		jle	short loc_40F27B
		push	0
		call	ebp ; GetSystemMetrics
		mov	ecx, eax
		mov	eax, 0FFFFFFC4h
		sub	eax, edi
		add	ecx, eax
		mov	[esp+38h], ecx

loc_40F27B:				; CODE XREF: .text:0040F266j
		mov	edx, [esi+318h]
		mov	eax, hModule
		push	edx
		mov	edx, [esp+40h]
		push	eax
		push	0
		push	0
		push	ebx
		add	edx, 3Ch
		push	edi
		add	ecx, 3Ch
		push	edx
		push	ecx
		lea	eax, [esp+78h]
		push	10CF0000h
		push	eax
		push	offset ClassName ; "PGPkeysMainWinClass"
		push	0
		call	ds:CreateWindowExA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F2C0:				; CODE XREF: .text:0040E79Dj
					; DATA XREF: .text:off_40FB5Co
		push	0		; jumptable 0040E79D case 40082
		push	0A028h
		push	111h
		push	edi
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F2E2:				; CODE XREF: .text:0040E780j
		mov	ecx, 0B5h
		xor	eax, eax
		lea	edi, [esi+34h]
		rep stosd
		mov	ecx, [esi+14h]
		lea	eax, [esi+18h]
		push	eax
		push	ecx
		mov	dword ptr [eax], 2
		call	ds:PGPkmConfigure
		mov	edx, [esi+14h]
		push	40000h
		push	edx
		call	ds:PGPkmPerformAction
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F323:				; CODE XREF: .text:0040E77Aj
		cmp	eax, 0A410h
		jz	short loc_40F374

loc_40F32A:				; CODE XREF: .text:0040E78Fj
					; .text:0040E79Dj
					; DATA XREF: ...
		cmp	bp, 0A028h	; jumptable 0040E79D default case
		jbe	loc_40F7AB
		lea	ecx, [esi+34h]
		push	ecx
		push	eax
		call	sub_40AF70
		mov	edx, [esi+14h]
		lea	eax, [esi+18h]
		push	eax
		push	edx
		mov	dword ptr [eax], 2
		call	ds:PGPkmConfigure
		mov	eax, [esi+14h]
		push	40000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 18h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F374:				; CODE XREF: .text:0040F328j
		mov	edx, [esi+30Ch]
		lea	ecx, [esp+10h]
		push	ecx
		push	edx
		call	sub_4108B0
		mov	ecx, [esi]
		add	esp, 8
		lea	eax, [esp+10h]
		push	2
		push	eax
		push	0
		push	ecx
		call	ds:MapWindowPoints
		lea	edx, [esp+10h]
		push	edx
		push	edi
		call	sub_40BEA0
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F3B7:				; CODE XREF: .text:0040E2A0j
		mov	eax, [esp+19Ch]
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	ecx, [eax+368h]
		test	ecx, ecx
		jz	loc_40F7AB
		pop	edi
		pop	esi
		mov	dword ptr [eax+368h], 0
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F3EE:				; CODE XREF: .text:0040E29Aj
		lea	ecx, [eax-805Fh] ; switch 129 cases
		cmp	ecx, 80h
		ja	loc_40F709	; jumptable 0040CE21 default case
		xor	edx, edx
		mov	dl, ds:byte_40FC98[ecx]
		jmp	ds:off_40FC80[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_40F40F:				; CODE XREF: .text:0040F408j
					; DATA XREF: .text:off_40FC80o
		mov	ebx, [esp+19Ch]	; jumptable 0040F408 case 32866
		push	0FFFFFFEBh
		push	ebx
		call	ds:GetWindowLongA
		mov	ebp, ds:PGPkmLoadKeySet
		mov	esi, eax
		xor	edi, edi
		mov	eax, [esi+14h]
		push	edi
		push	edi
		push	eax
		call	ebp ; PGPkmLoadKeySet
		mov	eax, [esi+4]
		add	esp, 0Ch
		cmp	eax, edi
		jz	short loc_40F48C
		mov	eax, dword_430428
		cmp	eax, edi
		jz	short loc_40F452
		push	edi
		push	edi
		push	8062h
		push	eax
		call	ds:SendMessageA

loc_40F452:				; CODE XREF: .text:0040F442j
		mov	eax, [esi+318h]
		cmp	eax, edi
		jz	short loc_40F46B
		push	eax
		call	PGPFreeKeySet
		add	esp, 4
		mov	[esi+318h], edi

loc_40F46B:				; CODE XREF: .text:0040F45Aj
		push	edi
		push	0C8h
		push	458h
		push	ebx
		call	ds:SetTimer
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F48C:				; CODE XREF: .text:0040F439j
		mov	eax, [esi+314h]
		cmp	eax, edi
		jz	short loc_40F4A5
		push	eax
		call	PGPFreeKeySet
		add	esp, 4
		mov	[esi+314h], edi

loc_40F4A5:				; CODE XREF: .text:0040F494j
		mov	eax, [esp+1A8h]
		cmp	eax, edi
		jz	short loc_40F4B6
		mov	[esi+318h], eax

loc_40F4B6:				; CODE XREF: .text:0040F4AEj
		mov	ecx, [esi+318h]
		mov	edx, [esi+314h]
		mov	eax, [esi+14h]
		push	ecx
		push	edx
		push	eax
		call	ebp ; PGPkmLoadKeySet
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F4DC:				; CODE XREF: .text:0040F408j
					; DATA XREF: .text:off_40FC80o
		mov	edi, [esp+19Ch]	; jumptable 0040F408 case 32867
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		push	5
		push	edi
		mov	esi, eax
		call	ds:ShowWindow
		push	1
		push	edi
		call	ds:EnableWindow
		push	edi
		call	ds:SetForegroundWindow
		mov	eax, [esi+334h]
		test	eax, eax
		jz	short loc_40F51A
		mov	ecx, [esi+358h]
		push	ecx
		jmp	short loc_40F521
; ---------------------------------------------------------------------------

loc_40F51A:				; CODE XREF: .text:0040F50Fj
		mov	edx, [esi+308h]
		push	edx

loc_40F521:				; CODE XREF: .text:0040F518j
		call	ds:SetFocus
		mov	bl, [esp+1A4h]
		test	bl, 1
		jz	loc_40F5C2
		mov	ecx, dword_430850
		lea	eax, [esp+24h]
		push	eax
		push	ecx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	edx, [esp+2Ch]
		push	1
		push	0Ch
		push	edx
		call	sub_41B430
		mov	eax, [esp+38h]
		push	1
		push	eax
		call	ds:PGPclCloseClientPrefs
		mov	dword_43041C, 1
		mov	ecx, [esi+318h]
		push	1
		push	ecx
		call	sub_40C340
		mov	edx, [esi+14h]
		push	1
		push	edx
		call	ds:PGPkmReLoadKeySet
		add	esp, 2Ch
		test	bl, 2
		jz	short loc_40F5AB
		mov	eax, [esi+14h]
		push	2000h
		push	eax
		call	ds:PGPkmPerformAction
		add	esp, 8

loc_40F5AB:				; CODE XREF: .text:0040F597j
		mov	ecx, [esp+1A8h]
		mov	edx, [esi+14h]
		push	1
		push	ecx
		push	edx
		call	ds:PGPkmSelectKey
		add	esp, 0Ch

loc_40F5C2:				; CODE XREF: .text:0040F531j
		push	0
		push	0
		push	edi
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F5DF:				; CODE XREF: .text:0040F408j
					; DATA XREF: .text:off_40FC80o
		mov	eax, [esp+19Ch]	; jumptable 0040F408 case 32990
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	ecx, [eax+14h]
		push	ecx
		call	ds:PGPkmSynchronizeThreadAccessToSDK
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F60B:				; CODE XREF: .text:0040F408j
					; DATA XREF: .text:off_40FC80o
		mov	edx, [esp+19Ch]	; jumptable 0040F408 case 32991
		push	0FFFFFFEBh
		push	edx
		call	ds:GetWindowLongA
		mov	eax, [eax+14h]
		mov	ecx, [esp+1A8h]
		mov	edx, [esp+1A4h]
		push	ecx
		push	edx
		push	eax
		call	ds:PGPkmProcessKeyPropMessage
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F647:				; CODE XREF: .text:0040F408j
					; DATA XREF: .text:off_40FC80o
		mov	ebx, [esp+19Ch]	; jumptable 0040F408 case 32863
		push	0FFFFFFEBh
		push	ebx
		call	ds:GetWindowLongA
		lea	ecx, [esp+10h]
		mov	esi, eax
		push	ecx
		push	ebx
		call	ds:GetClientRect
		mov	eax, [esi+30Ch]
		mov	edi, ds:SetWindowPos
		test	eax, eax
		jz	short loc_40F692
		mov	ecx, [esp+18h]
		mov	ebp, [esp+10h]
		mov	edx, [esi+324h]
		push	6
		sub	ecx, ebp
		push	edx
		push	ecx
		push	0
		push	0
		push	0
		push	eax
		call	edi ; SetWindowPos

loc_40F692:				; CODE XREF: .text:0040F673j
		mov	eax, [esi+308h]
		test	eax, eax
		jz	short loc_40F6BE
		mov	edx, [esi+328h]
		mov	ecx, [esp+18h]
		mov	ebp, [esp+10h]
		push	4
		push	edx
		mov	edx, [esi+324h]
		sub	ecx, ebp
		push	ecx
		push	edx
		push	0
		push	0
		push	eax
		call	edi ; SetWindowPos

loc_40F6BE:				; CODE XREF: .text:0040F69Aj
		mov	eax, [esi+358h]
		test	eax, eax
		jz	short loc_40F6F3
		mov	esi, [esi+35Ch]
		mov	edx, [esp+1Ch]
		mov	ecx, [esp+18h]
		mov	ebp, [esp+10h]
		push	4
		push	esi
		sub	edx, esi
		mov	esi, [esp+1Ch]
		sub	edx, esi
		sub	ecx, ebp
		sub	edx, 14h
		push	ecx
		push	edx
		push	0
		push	0
		push	eax
		call	edi ; SetWindowPos

loc_40F6F3:				; CODE XREF: .text:0040F6C6j
		push	ebx
		call	ds:UpdateWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F709:				; CODE XREF: .text:0040CE13j
					; .text:0040CE21j ...
		cmp	eax, dword_4303B4 ; jumptable 0040CE21 default case
		jnz	short loc_40F78A
		mov	eax, [esp+19Ch]
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		mov	ecx, [eax+334h]
		push	0
		test	ecx, ecx
		mov	ecx, [esp+1A8h]
		jz	short loc_40F75F
		mov	edx, [eax+358h]
		and	ecx, 0FFFFh
		shl	ecx, 10h
		push	ecx
		push	20Ah
		push	edx
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F75F:				; CODE XREF: .text:0040F732j
		mov	edx, [eax+308h]
		and	ecx, 0FFFFh
		shl	ecx, 10h
		push	ecx
		push	20Ah
		push	edx
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F78A:				; CODE XREF: .text:0040F70Fj
		cmp	eax, dword_4303A8
		jnz	short loc_40F7BA
		mov	eax, [esp+19Ch]
		push	0FFFFFFEBh
		push	eax
		call	ds:GetWindowLongA
		push	eax
		call	sub_40C1A0
		add	esp, 4

loc_40F7AB:				; CODE XREF: .text:0040D365j
					; .text:0040D384j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F7BA:				; CODE XREF: .text:0040F790j
		cmp	eax, Msg
		jnz	loc_40F90A
		mov	edi, [esp+19Ch]
		push	0FFFFFFEBh
		push	edi
		call	ds:GetWindowLongA
		mov	esi, eax
		test	byte ptr [esi+20h], 80h
		jz	loc_40F8F8
		mov	eax, [esi+4]
		test	eax, eax
		jz	loc_40F891
		call	ds:GetCurrentProcessId
		cmp	[esp+1A8h], eax
		jz	short loc_40F82B
		mov	eax, dword_430424
		test	eax, eax
		jnz	loc_40F8F8
		push	0
		push	0
		push	8062h
		push	edi
		call	ds:PostMessageA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F82B:				; CODE XREF: .text:0040F7FAj
		mov	eax, [esp+1A4h]
		cmp	ax, di
		jz	short loc_40F862
		shr	eax, 10h
		jz	short loc_40F84D
		mov	ecx, [esi+14h]
		push	1
		push	ecx
		call	ds:PGPkmReLoadKeySet
		add	esp, 8
		jmp	short loc_40F862
; ---------------------------------------------------------------------------

loc_40F84D:				; CODE XREF: .text:0040F83Aj
		mov	eax, [esi+318h]
		mov	edx, [esi+14h]
		push	eax
		push	eax
		push	edx
		call	ds:PGPkmLoadKeySet
		add	esp, 0Ch

loc_40F862:				; CODE XREF: .text:0040F835j
					; .text:0040F84Bj
		mov	eax, [esi+330h]
		test	eax, eax
		jz	loc_40F8F8
		mov	eax, [esi+338h]
		push	eax
		call	sub_405290
		add	esp, 4
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F891:				; CODE XREF: .text:0040F7E7j
		call	ds:GetCurrentProcessId
		cmp	[esp+1A8h], eax
		jnz	short loc_40F8AA
		cmp	[esp+1A4h], di
		jz	short loc_40F8F8

loc_40F8AA:				; CODE XREF: .text:0040F89Ej
		mov	eax, [esi+314h]
		test	eax, eax
		jz	short loc_40F8C7
		push	eax
		call	PGPFreeKeySet
		add	esp, 4
		mov	dword ptr [esi+314h], 0

loc_40F8C7:				; CODE XREF: .text:0040F8B2j
		mov	ecx, [esi+318h]
		mov	edx, [esi+314h]
		mov	eax, [esi+14h]
		push	ecx
		push	edx
		push	eax
		call	ds:PGPkmLoadKeySet
		mov	ecx, [esi+310h]
		add	esp, 0Ch
		push	0
		push	0
		push	806Fh
		push	ecx
		call	ds:SendMessageA

loc_40F8F8:				; CODE XREF: .text:0040F7DCj
					; .text:0040F803j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F90A:				; CODE XREF: .text:0040F7C0j
		cmp	eax, dword_4303AC
		jnz	short loc_40F965
		mov	esi, [esp+19Ch]
		push	0FFFFFFEBh
		push	esi
		call	ds:GetWindowLongA
		mov	ecx, [eax+4]
		test	ecx, ecx
		jnz	short loc_40F953
		mov	eax, [eax+310h]
		lea	edx, [esp+24h]
		push	edx
		push	0
		push	4Eh
		push	eax
		mov	[esp+34h], esi
		mov	dword ptr [esp+38h], 0
		mov	dword ptr [esp+3Ch], 8078h
		call	ds:SendMessageA

loc_40F953:				; CODE XREF: .text:0040F927j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F965:				; CODE XREF: .text:0040F910j
		cmp	eax, dword_4303B0
		jnz	short loc_40F990
		mov	ecx, [esp+1A4h]
		push	ecx
		call	ds:PGPclPurgeCachedPassphrase
		add	esp, 4
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------

loc_40F990:				; CODE XREF: .text:0040F96Bj
		mov	edx, [esp+1A8h]
		mov	ecx, [esp+1A4h]
		push	edx
		mov	edx, [esp+1A0h]
		push	ecx
		push	eax
		push	edx
		call	ds:DefWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 188h
		retn	10h
; ---------------------------------------------------------------------------
off_40F9BC	dd offset loc_40CE28, offset loc_40D505, offset	loc_40D5ED
					; DATA XREF: .text:0040CE21r
		dd offset loc_40D420, offset loc_40D4A4, offset	loc_40D863 ; jump table	for switch statement
		dd offset loc_40D320, offset loc_40D766, offset	loc_40D798
		dd offset loc_40D7EC, offset loc_40D830, offset	loc_40F709
byte_40F9EC	db	0,     1,   0Bh,   0Bh ; DATA XREF: .text:0040CE1Br
		db	2,     3,   0Bh,   0Bh ; indirect table	for switch statement
		db    0Bh,     4,   0Bh,   0Bh
		db    0Bh,   0Bh,     5,     6
		db    0Bh,   0Bh,   0Bh,   0Bh
		db	7,   0Bh,   0Bh,   0Bh
		db    0Bh,     8,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,     9,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Ah
		align 4
off_40FA38	dd offset loc_40DC0E	; DATA XREF: .text:0040DB62r
		dd offset loc_40DBA1	; jump table for switch	statement
		dd offset loc_40DB69
		dd offset loc_40DEC2
		dd offset loc_40E0CE
		dd offset loc_40DFD6
off_40FA50	dd offset loc_40E755, offset loc_40E4BE, offset	loc_40E2C7
					; DATA XREF: .text:0040E2C0r
		dd offset loc_40E304, offset loc_40E487, offset	loc_40F709 ; jump table	for switch statement
byte_40FA68	db 0, 5, 1, 5, 5, 2, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
					; DATA XREF: .text:0040E2BAr
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5	; indirect table for switch statement
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 5, 5,	5, 5, 5, 5, 5, 5, 5, 5,	5, 5, 5
		db 5, 5, 5, 5, 5, 3, 4
		align 4
off_40FB5C	dd offset loc_40E90E, offset loc_40E876, offset	loc_40ED0B
					; DATA XREF: .text:0040E79Dr
		dd offset loc_40E83C, offset loc_40E7EE, offset	loc_40E897 ; jump table	for switch statement
		dd offset loc_40E8ED, offset loc_40E9DD, offset	loc_40EC07
		dd offset loc_40EB52, offset loc_40ED78, offset	loc_40EA5D
		dd offset loc_40EAA1, offset loc_40ECB3, offset	loc_40ED2C
		dd offset loc_40ED4A, offset loc_40E7A4, offset	loc_40E959
		dd offset loc_40E985, offset loc_40F092, offset	loc_40F19C
		dd offset loc_40F074, offset loc_40EB31, offset	loc_40EAC2
		dd offset loc_40E938, offset loc_40EA3A, offset	loc_40EF99
		dd offset loc_40EA7E, offset loc_40EE3E, offset	loc_40EE6A
		dd offset loc_40EE96, offset loc_40EEC2, offset	loc_40EECF
		dd offset loc_40EEE8, offset loc_40EF01, offset	loc_40EF0E
		dd offset loc_40EF29, offset loc_40EE1D, offset	loc_40EDFC
		dd offset loc_40E7C0, offset loc_40EFD3, offset	loc_40ED99
		dd offset loc_40F02E, offset loc_40F051, offset	loc_40EDBA
		dd offset loc_40F2C0, offset loc_40E85B, offset	loc_40EDDB
		dd offset loc_40EB10, offset loc_40F00B, offset	loc_40E806
		dd offset loc_40F32A
byte_40FC2C	db	0,   33h,     1,   33h ; DATA XREF: .text:0040E797r
		db	2,   33h,   33h,   33h ; indirect table	for switch statement
		db	3,   33h,     4,   33h
		db    33h,     5,     6,     7
		db    33h,     8,     9,   0Ah
		db    33h,   0Bh,   0Ch,   33h
		db    0Dh,   33h,   0Eh,   0Fh
		db    33h,   33h,   33h,   33h
		db    10h,   33h,   33h,   11h
		db    12h,   33h,   33h,   13h
		db    14h,   15h,   33h,   16h
		db    33h,   17h,   33h,   18h
		db    33h,   33h,   19h,   33h
		db    33h,   1Ah,   33h,   1Bh
		db    33h,   1Ch,   1Dh,   1Eh
		db    1Fh,   20h,   21h,   22h
		db    23h,   24h,   25h,   26h
		db    27h,   28h,   29h,   33h
		db    33h,   2Ah,   2Bh,   2Ch
		db    2Dh,   2Eh,   2Fh,   30h
		db    31h,   32h
		align 10h
off_40FC80	dd offset loc_40F647, offset loc_40F40F, offset	loc_40F4DC
					; DATA XREF: .text:0040F408r
		dd offset loc_40F5DF, offset loc_40F60B, offset	loc_40F709 ; jump table	for switch statement
byte_40FC98	db	0,     5,     5,     1 ; DATA XREF: .text:0040F402r
		db	2,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     3
		db	4
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40FD20	proc near		; CODE XREF: .text:0040E5CCp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		sub	esp, 0Ch
		lea	eax, [esp+0Ch+var_4]
		push	esi
		push	eax
		push	1
		push	ecx
		call	PGPOrderKeySet
		mov	eax, [esp+1Ch+var_4]
		lea	edx, [esp+1Ch+var_8]
		push	edx
		push	eax
		call	PGPNewKeyIter
		mov	edx, [esp+24h+var_8]
		lea	ecx, [esp+24h+var_C]
		push	ecx
		push	edx
		xor	esi, esi
		call	PGPKeyIterNext
		mov	eax, [esp+2Ch+var_C]
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_40FD9B

loc_40FD60:				; CODE XREF: sub_40FD20+79j
		test	esi, esi
		jnz	short loc_40FD9B
		lea	ecx, [esp+10h+arg_0]
		push	ecx
		push	3Ch
		push	eax
		call	PGPGetKeyBoolean
		mov	al, byte ptr [esp+1Ch+arg_0]
		add	esp, 0Ch
		test	al, al
		jz	short loc_40FD81
		mov	esi, 1

loc_40FD81:				; CODE XREF: sub_40FD20+5Aj
		mov	eax, [esp+10h+var_8]
		lea	edx, [esp+10h+var_C]
		push	edx
		push	eax
		call	PGPKeyIterNext
		mov	eax, [esp+18h+var_C]
		add	esp, 8
		test	eax, eax
		jnz	short loc_40FD60

loc_40FD9B:				; CODE XREF: sub_40FD20+3Ej
					; sub_40FD20+42j
		mov	ecx, [esp+10h+var_8]
		push	ecx
		call	PGPFreeKeyIter
		mov	edx, [esp+14h+var_4]
		push	edx
		call	PGPFreeKeyList
		add	esp, 8
		mov	eax, esi
		pop	esi
		add	esp, 0Ch
		retn
sub_40FD20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40FDC0	proc near		; CODE XREF: .text:0040E537p
					; sub_40FF80+48p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		test	eax, eax
		jz	short loc_40FE18
		mov	al, [esi]
		test	al, al
		jz	short loc_40FDE2

loc_40FDD6:				; CODE XREF: sub_40FDC0+20j
		cmp	al, 20h
		jnz	short loc_40FDE2
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_40FDD6

loc_40FDE2:				; CODE XREF: sub_40FDC0+14j
					; sub_40FDC0+18j
		mov	al, [esi]
		test	al, al
		jz	short loc_40FDF5
		cmp	al, 22h
		jnz	short loc_40FDF1
		inc	esi
		mov	bl, al
		jmp	short loc_40FDF9
; ---------------------------------------------------------------------------

loc_40FDF1:				; CODE XREF: sub_40FDC0+2Aj
		mov	bl, 20h
		jmp	short loc_40FDF9
; ---------------------------------------------------------------------------

loc_40FDF5:				; CODE XREF: sub_40FDC0+26j
		mov	bl, byte ptr [esp+10h+arg_0]

loc_40FDF9:				; CODE XREF: sub_40FDC0+2Fj
					; sub_40FDC0+33j
		mov	al, [esi]
		test	al, al
		jz	short loc_40FE0B

loc_40FDFF:				; CODE XREF: sub_40FDC0+49j
		cmp	al, bl
		jz	short loc_40FE0B
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_40FDFF

loc_40FE0B:				; CODE XREF: sub_40FDC0+3Dj
					; sub_40FDC0+41j
		cmp	byte ptr [esi],	0
		jz	short loc_40FE1C
		cmp	bl, 22h
		jnz	short loc_40FE1C
		inc	esi
		jmp	short loc_40FE1C
; ---------------------------------------------------------------------------

loc_40FE18:				; CODE XREF: sub_40FDC0+Ej
		mov	bl, byte ptr [esp+10h+arg_0]

loc_40FE1C:				; CODE XREF: sub_40FDC0+4Ej
					; sub_40FDC0+53j ...
		test	esi, esi
		jz	loc_40FF6E
		mov	ebp, [esp+10h+arg_C]

loc_40FE28:				; CODE XREF: sub_40FDC0+1A8j
		mov	al, [esi]
		test	al, al
		jz	loc_40FF6E

loc_40FE32:				; CODE XREF: sub_40FDC0+7Cj
		cmp	al, 20h
		jnz	short loc_40FE3E
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_40FE32

loc_40FE3E:				; CODE XREF: sub_40FDC0+74j
		mov	al, [esi]
		test	al, al
		jz	loc_40FF49
		cmp	al, 22h
		jnz	short loc_40FE51
		inc	esi
		mov	bl, al
		jmp	short loc_40FE53
; ---------------------------------------------------------------------------

loc_40FE51:				; CODE XREF: sub_40FDC0+8Aj
		mov	bl, 20h

loc_40FE53:				; CODE XREF: sub_40FDC0+8Fj
		movsx	eax, bl
		push	eax		; int
		push	esi		; char *
		call	_strchr
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_40FE6F
		cmp	byte ptr [edi+2], 3Ah
		jnz	short loc_40FE6F
		mov	byte ptr [edi],	0

loc_40FE6F:				; CODE XREF: sub_40FDC0+A4j
					; sub_40FDC0+AAj
		mov	edx, dword_430850
		lea	ecx, [esp+10h+arg_4]
		push	ecx
		push	esi
		push	edx
		call	PGPNewFileSpecFromFullPath
		mov	eax, [esp+1Ch+arg_4]
		add	esp, 0Ch
		test	eax, eax
		jz	loc_40FF42
		mov	eax, dword_430850
		push	eax
		call	PGPOLastOption
		mov	ecx, [esp+14h+arg_4]
		mov	edx, dword_430850
		add	esp, 4
		push	eax
		push	ecx
		push	edx
		call	PGPOInputFile
		mov	ecx, dword_430850
		add	esp, 8
		push	eax
		lea	eax, [esp+18h+arg_0]
		push	eax
		push	ecx
		call	PGPImportKeySet
		mov	eax, [esp+20h+arg_0]
		add	esp, 10h
		test	eax, eax
		jz	short loc_40FF35
		lea	edx, [esp+10h+arg_C]
		push	edx
		push	eax
		call	PGPCountKeys
		mov	eax, [esp+18h+arg_C]
		add	esp, 8
		test	eax, eax
		jle	short loc_40FF28
		mov	eax, [esp+10h+arg_8]
		push	ebp
		test	eax, eax
		jz	short loc_40FF13
		mov	eax, [esp+14h+arg_0]
		mov	ecx, hWnd
		mov	edx, dword_4303B8
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edx
		push	eax
		call	ds:PGPclQueryAddKeys
		add	esp, 14h
		jmp	short loc_40FF28
; ---------------------------------------------------------------------------

loc_40FF13:				; CODE XREF: sub_40FDC0+12Dj
		mov	ecx, [esp+14h+arg_0]
		push	ecx
		call	PGPAddKeys
		push	1
		push	ebp
		call	sub_40C340
		add	esp, 10h

loc_40FF28:				; CODE XREF: sub_40FDC0+124j
					; sub_40FDC0+151j
		mov	edx, [esp+10h+arg_0]
		push	edx
		call	PGPFreeKeySet
		add	esp, 4

loc_40FF35:				; CODE XREF: sub_40FDC0+10Ej
		mov	eax, [esp+10h+arg_4]
		push	eax
		call	PGPFreeFileSpec
		add	esp, 4

loc_40FF42:				; CODE XREF: sub_40FDC0+CAj
		test	edi, edi
		jz	short loc_40FF49
		mov	byte ptr [edi],	20h

loc_40FF49:				; CODE XREF: sub_40FDC0+82j
					; sub_40FDC0+184j
		mov	al, [esi]
		test	al, al
		jz	short loc_40FF5B

loc_40FF4F:				; CODE XREF: sub_40FDC0+199j
		cmp	al, bl
		jz	short loc_40FF5B
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_40FF4F

loc_40FF5B:				; CODE XREF: sub_40FDC0+18Dj
					; sub_40FDC0+191j
		cmp	byte ptr [esi],	0
		jz	short loc_40FF66
		cmp	bl, 22h
		jnz	short loc_40FF66
		inc	esi

loc_40FF66:				; CODE XREF: sub_40FDC0+19Ej
					; sub_40FDC0+1A3j
		test	esi, esi
		jnz	loc_40FE28

loc_40FF6E:				; CODE XREF: sub_40FDC0+5Ej
					; sub_40FDC0+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_40FDC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40FF80	proc near		; CODE XREF: .text:0040D849p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	[esp+0Ch+var_4], 0
		mov	eax, [edi]
		mov	esi, eax
		and	eax, 0FFFF0000h
		and	esi, 1
		cmp	eax, 10000h
		jz	short loc_40FFE9
		cmp	eax, 20000h
		jz	short loc_40FFD9
		cmp	eax, 40000h
		jz	short loc_40FFB6
		pop	edi
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_40FFB6:				; CODE XREF: sub_40FF80+2Ej
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [eax+318h]
		push	ecx
		push	esi
		push	1

loc_40FFC4:				; CODE XREF: sub_40FF80+67j
		mov	edx, [edi+8]
		push	edx
		call	sub_40FDC0
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_40FFD9:				; CODE XREF: sub_40FF80+27j
		mov	eax, [esp+0Ch+arg_0]
		mov	ecx, [eax+318h]
		push	ecx
		push	esi
		push	0
		jmp	short loc_40FFC4
; ---------------------------------------------------------------------------

loc_40FFE9:				; CODE XREF: sub_40FF80+20j
		mov	eax, dword_430850
		push	eax
		call	PGPOLastOption
		mov	ecx, [edi+4]
		mov	edx, [edi+8]
		add	esp, 4
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edx
		push	eax
		call	PGPOInputBuffer
		mov	edx, dword_430850
		add	esp, 0Ch
		lea	ecx, [esp+10h+var_4]
		push	eax
		push	ecx
		push	edx
		call	PGPImportKeySet
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_410090
		mov	eax, [esp+0Ch+var_4]
		test	eax, eax
		jz	short loc_4100A1
		test	esi, esi
		jz	short loc_410060
		mov	ecx, [esp+0Ch+arg_0]
		mov	edx, [ecx+318h]
		mov	ecx, dword_4303B8
		push	edx
		mov	edx, dword_430850
		push	eax
		mov	eax, hWnd
		push	eax
		push	ecx
		push	edx
		call	ds:PGPclQueryAddKeys
		add	esp, 14h
		jmp	short loc_410090
; ---------------------------------------------------------------------------

loc_410060:				; CODE XREF: sub_40FF80+B3j
		mov	esi, [esp+0Ch+arg_0]
		mov	ecx, [esi+318h]
		push	ecx
		push	eax
		call	PGPAddKeys
		mov	edx, [esi+318h]
		push	1
		push	edx
		mov	edi, eax
		call	sub_40C340
		mov	eax, [esi+14h]
		push	1
		push	eax
		call	ds:PGPkmReLoadKeySet
		add	esp, 18h

loc_410090:				; CODE XREF: sub_40FF80+A7j
					; sub_40FF80+DEj
		mov	eax, [esp+0Ch+var_4]
		test	eax, eax
		jz	short loc_4100A1
		push	eax
		call	PGPFreeKeySet
		add	esp, 4

loc_4100A1:				; CODE XREF: sub_40FF80+AFj
					; sub_40FF80+116j
		xor	eax, eax
		test	edi, edi
		pop	edi
		pop	esi
		setz	al
		pop	ecx
		retn
sub_40FF80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4100B0	proc near		; CODE XREF: .text:0040E543p
		mov	eax, 0FFFFD134h
		retn
sub_4100B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4100C0	proc near		; CODE XREF: .text:0040E4FAp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	7F02h		; lpCursorName
		push	0		; hInstance
		mov	[esp+20h+var_8], 1
		mov	[esp+20h+var_4], 0
		call	ds:LoadCursorA
		mov	ebp, ds:SetCursor
		push	eax		; hCursor
		call	ebp ; SetCursor
		mov	edi, eax
		mov	eax, dword_430850
		push	eax
		call	PGPsdkLoadDefaultPrefs
		mov	esi, [esp+1Ch+arg_0]
		mov	ecx, dword_430850
		lea	eax, [esi+318h]
		push	eax
		push	2
		push	ecx
		call	PGPOpenDefaultKeyRings
		add	esp, 10h

loc_410116:				; CODE XREF: sub_4100C0+162j
		push	edi		; hCursor
		mov	ebx, eax
		call	ebp ; SetCursor
		mov	eax, [esi+318h]
		test	eax, eax
		jz	short loc_41013C
		mov	edx, [esi+14h]
		push	eax
		push	eax
		push	edx
		call	ds:PGPkmLoadKeySet
		add	esp, 0Ch
		test	eax, eax
		jz	loc_410227

loc_41013C:				; CODE XREF: sub_4100C0+63j
		add	ebx, 2EDDh	; switch 4 cases
		cmp	ebx, 3
		ja	short loc_4101BF ; jumptable 00410147 default case
		jmp	ds:off_410310[ebx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_41014E:				; CODE XREF: sub_4100C0+87j
					; DATA XREF: .text:off_410310o
		mov	[esp+18h+var_8], 0 ; jumptable 00410147	case -11995
		jmp	loc_4101EA
; ---------------------------------------------------------------------------

loc_41015B:				; CODE XREF: sub_4100C0+87j
					; DATA XREF: .text:off_410310o
		mov	eax, [esp+18h+var_4] ; jumptable 00410147 case -11994
		inc	eax
		cmp	eax, 3
		mov	[esp+18h+var_4], eax
		jge	short loc_410176
		push	5DCh		; dwMilliseconds
		call	ds:Sleep
		jmp	short loc_4101EA
; ---------------------------------------------------------------------------

loc_410176:				; CODE XREF: sub_4100C0+A7j
		mov	eax, hWnd
		push	10h		; int
		push	61h		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		mov	ecx, hWnd
		push	1		; int
		push	ecx		; hWnd
		push	esi		; int
		call	sub_40C2D0
		add	esp, 1Ch
		test	eax, eax
		jz	loc_4102B7
		jmp	short loc_4101EA
; ---------------------------------------------------------------------------

loc_4101A3:				; CODE XREF: sub_4100C0+87j
					; DATA XREF: .text:off_410310o
		mov	edx, hWnd	; jumptable 00410147 cases -11997,-11996
		push	1		; int
		push	edx		; hWnd
		push	esi		; int
		call	sub_40C2D0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_4102D4
		jmp	short loc_4101EA
; ---------------------------------------------------------------------------

loc_4101BF:				; CODE XREF: sub_4100C0+85j
		mov	eax, hWnd	; jumptable 00410147 default case
		push	10h		; int
		push	54h		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		mov	ecx, hWnd
		push	1		; int
		push	ecx		; hWnd
		push	esi		; int
		call	sub_40C2D0
		add	esp, 1Ch
		test	eax, eax
		jz	loc_4102F1

loc_4101EA:				; CODE XREF: sub_4100C0+96j
					; sub_4100C0+B4j ...
		push	7F02h		; lpCursorName
		push	0		; hInstance
		call	ds:LoadCursorA
		push	eax		; hCursor
		call	ebp ; SetCursor
		mov	ecx, [esp+18h+var_8]
		mov	edi, eax
		xor	eax, eax
		test	ecx, ecx
		jz	short loc_41020B
		mov	eax, 2

loc_41020B:				; CODE XREF: sub_4100C0+144j
		mov	edx, dword_430850
		lea	ecx, [esi+318h]
		push	ecx
		push	eax
		push	edx
		call	PGPOpenDefaultKeyRings
		add	esp, 0Ch
		jmp	loc_410116
; ---------------------------------------------------------------------------

loc_410227:				; CODE XREF: sub_4100C0+76j
		mov	eax, [esi+318h]
		push	eax
		call	PGPPropagateTrust
		mov	edx, [esp+1Ch+var_8]
		add	esp, 4
		xor	eax, eax
		test	edx, edx
		setz	al
		test	eax, eax
		mov	dword_4303C0, eax
		jz	short loc_410260
		mov	edi, [esi+20h]
		mov	ecx, [esi]
		or	edi, 1
		push	ecx		; hWndParent
		mov	[esi+20h], edi
		call	sub_4112A0
		add	esp, 4
		jmp	short loc_410268
; ---------------------------------------------------------------------------

loc_410260:				; CODE XREF: sub_4100C0+188j
		mov	eax, [esi+20h]
		and	al, 0FEh
		mov	[esi+20h], eax

loc_410268:				; CODE XREF: sub_4100C0+19Ej
		mov	edx, [esi+14h]
		lea	eax, [esi+18h]
		push	eax
		push	edx
		mov	dword ptr [eax], 4
		call	ds:PGPkmConfigure
		mov	edx, [esi+338h]
		mov	eax, [esi+318h]
		lea	ecx, [esi+33Ch]
		mov	[esi+340h], eax
		push	ecx
		push	edx
		call	sub_405330
		mov	eax, [esi+338h]
		push	eax		; uID
		call	sub_4051E0
		add	esp, 14h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4102B7:				; CODE XREF: sub_4100C0+DBj
		mov	ecx, hWnd
		push	0		; lParam
		push	0		; wParam
		push	10h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4102D4:				; CODE XREF: sub_4100C0+F7j
		mov	edx, hWnd
		push	0		; lParam
		push	0		; wParam
		push	10h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4102F1:				; CODE XREF: sub_4100C0+124j
		mov	eax, hWnd
		push	0		; lParam
		push	0		; wParam
		push	10h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
sub_4100C0	endp

; ---------------------------------------------------------------------------
		align 10h
off_410310	dd offset loc_4101A3	; DATA XREF: sub_4100C0+87r
		dd offset loc_4101A3	; jump table for switch	statement
		dd offset loc_41014E
		dd offset loc_41015B

; =============== S U B	R O U T	I N E =======================================


sub_410320	proc near		; CODE XREF: .text:0040D816p

right		= dword	ptr -1Ch
y		= dword	ptr -18h
var_14		= dword	ptr -14h
h		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
ho		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		push	esi
		mov	esi, [esp+20h+arg_0]
		mov	eax, [esi+8]
		cmp	eax, 2
		jnz	loc_41053D
		mov	eax, [esp+20h+arg_4]
		cmp	dword ptr [eax+374h], 0FFFFFFFFh
		jl	loc_41056F
		mov	eax, [esi+20h]
		push	ebx
		mov	ebx, [esi+28h]
		push	ebp
		push	edi
		mov	edi, [esi+1Ch]
		add	eax, 3
		sub	ebx, 5
		add	edi, 4
		mov	[esp+2Ch+y], eax
		mov	[esp+2Ch+arg_0], 0Ah
		lea	ebp, [edi+6]

loc_410369:				; CODE XREF: sub_410320+82j
		mov	ecx, [esi+18h]
		push	0		; lppt
		push	ebx		; y
		push	edi		; x
		push	ecx		; hdc
		call	ds:MoveToEx
		mov	edx, [esi+18h]
		push	ebx		; y
		push	ebp		; x
		push	edx		; hdc
		call	ds:LineTo
		mov	eax, [esp+2Ch+y]
		mov	ecx, [esi+18h]
		push	eax		; y
		push	ebp		; x
		push	ecx		; hdc
		call	ds:LineTo
		mov	eax, [esp+2Ch+arg_0]
		add	edi, 8
		add	ebp, 8
		dec	eax
		mov	[esp+2Ch+arg_0], eax
		jnz	short loc_410369
		push	808080h		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		mov	edx, [esi+18h]
		mov	ebp, ds:SelectObject
		push	eax		; h
		push	edx		; hdc
		mov	[esp+34h+ho], eax
		call	ebp ; SelectObject
		mov	edi, ds:CreateSolidBrush
		push	0FF00h		; color
		mov	[esp+30h+var_8], eax
		call	edi ; CreateSolidBrush
		push	8000h		; color
		mov	[esp+30h+h], eax
		call	edi ; CreateSolidBrush
		mov	ecx, [esp+2Ch+arg_4]
		mov	edi, [esi+1Ch]
		add	edi, 4
		mov	[esp+2Ch+var_C], eax
		mov	edx, [ecx+37Ch]
		test	edx, edx
		jz	loc_410488
		push	eax		; h
		mov	eax, [esi+18h]
		push	eax		; hdc
		call	ebp ; SelectObject
		lea	ecx, [edi+6]
		mov	[esp+2Ch+var_14], eax
		mov	[esp+2Ch+arg_0], 0
		mov	[esp+2Ch+right], ecx

loc_410416:				; CODE XREF: sub_410320+164j
		mov	edx, [esp+2Ch+arg_4]
		mov	eax, [esp+2Ch+arg_0]
		cmp	eax, [edx+374h]
		jnz	short loc_410454
		mov	ecx, [esp+2Ch+h]
		mov	edx, [esi+18h]
		push	ecx		; h
		push	edx		; hdc
		call	ebp ; SelectObject
		mov	eax, [esp+2Ch+right]
		mov	ecx, [esp+2Ch+y]
		mov	edx, [esi+18h]
		push	ebx		; bottom
		push	eax		; right
		push	ecx		; top
		push	edi		; left
		push	edx		; hdc
		call	ds:Rectangle
		mov	eax, [esp+2Ch+var_C]
		mov	ecx, [esi+18h]
		push	eax		; h
		push	ecx		; hdc
		call	ebp ; SelectObject
		jmp	short loc_41046A
; ---------------------------------------------------------------------------

loc_410454:				; CODE XREF: sub_410320+104j
		mov	edx, [esp+2Ch+right]
		mov	eax, [esp+2Ch+y]
		mov	ecx, [esi+18h]
		push	ebx		; bottom
		push	edx		; right
		push	eax		; top
		push	edi		; left
		push	ecx		; hdc
		call	ds:Rectangle

loc_41046A:				; CODE XREF: sub_410320+132j
		mov	eax, [esp+2Ch+right]
		add	edi, 8
		add	eax, 8
		mov	[esp+2Ch+right], eax
		mov	eax, [esp+2Ch+arg_0]
		inc	eax
		cmp	eax, 0Ah
		mov	[esp+2Ch+arg_0], eax
		jl	short loc_410416
		jmp	short loc_410504
; ---------------------------------------------------------------------------

loc_410488:				; CODE XREF: sub_410320+D6j
		mov	edx, [ecx+374h]
		test	edx, edx
		jl	short loc_41049D
		mov	edx, [esp+2Ch+h]
		mov	eax, [esi+18h]
		push	edx
		push	eax
		jmp	short loc_4104A2
; ---------------------------------------------------------------------------

loc_41049D:				; CODE XREF: sub_410320+170j
		mov	ecx, [esi+18h]
		push	eax		; h
		push	ecx		; hdc

loc_4104A2:				; CODE XREF: sub_410320+17Bj
		call	ebp ; SelectObject
		lea	edx, [edi+6]
		mov	[esp+2Ch+var_14], eax
		mov	[esp+2Ch+arg_0], 0
		mov	[esp+2Ch+right], edx

loc_4104B7:				; CODE XREF: sub_410320+1E2j
		mov	eax, [esp+2Ch+arg_4]
		mov	ecx, [esp+2Ch+arg_0]
		cmp	ecx, [eax+374h]
		jle	short loc_4104D2
		mov	edx, [esp+2Ch+var_C]
		mov	eax, [esi+18h]
		push	edx		; h
		push	eax		; hdc
		call	ebp ; SelectObject

loc_4104D2:				; CODE XREF: sub_410320+1A5j
		mov	ecx, [esp+2Ch+right]
		mov	edx, [esp+2Ch+y]
		mov	eax, [esi+18h]
		push	ebx		; bottom
		push	ecx		; right
		push	edx		; top
		push	edi		; left
		push	eax		; hdc
		call	ds:Rectangle
		mov	eax, [esp+2Ch+right]
		add	edi, 8
		add	eax, 8
		mov	[esp+2Ch+right], eax
		mov	eax, [esp+2Ch+arg_0]
		inc	eax
		cmp	eax, 0Ah
		mov	[esp+2Ch+arg_0], eax
		jl	short loc_4104B7

loc_410504:				; CODE XREF: sub_410320+166j
		mov	ecx, [esp+2Ch+var_14]
		mov	edx, [esi+18h]
		push	ecx		; h
		push	edx		; hdc
		call	ebp ; SelectObject
		mov	eax, [esp+2Ch+var_8]
		mov	ecx, [esi+18h]
		push	eax		; h
		push	ecx		; hdc
		call	ebp ; SelectObject
		mov	edx, [esp+2Ch+ho]
		mov	esi, ds:DeleteObject
		push	edx		; ho
		call	esi ; DeleteObject
		mov	eax, [esp+2Ch+h]
		push	eax		; ho
		call	esi ; DeleteObject
		mov	ecx, [esp+2Ch+var_C]
		push	ecx		; ho
		call	esi ; DeleteObject
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_41053D:				; CODE XREF: sub_410320+Ej
		test	eax, eax
		jnz	short loc_41056F
		mov	eax, [esi+2Ch]
		test	eax, eax
		jz	short loc_41054D
		mov	eax, 1

loc_41054D:				; CODE XREF: sub_410320+226j
		mov	edx, [esi+18h]
		xor	ecx, ecx
		test	eax, eax
		push	1		; fStyle
		push	3		; y
		setnz	cl
		push	1		; x
		push	edx		; hdcDst
		mov	edx, himl
		add	ecx, 28h
		push	ecx		; i
		push	edx		; himl
		call	ds:ImageList_Draw

loc_41056F:				; CODE XREF: sub_410320+1Fj
					; sub_410320+21Fj
		pop	esi
		add	esp, 1Ch
		retn
sub_410320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_410580(int, HWND hWnd, int)
sub_410580	proc near		; CODE XREF: .text:0040DE4Ep

var_204		= dword	ptr -204h
Buffer		= byte ptr -200h
var_100		= byte ptr -100h
arg_0		= dword	ptr  4
hWnd		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		sub	esp, 204h
		test	eax, eax
		jz	short loc_41059E
		lea	ecx, [esp+204h+var_204]
		push	ecx
		push	eax
		call	PGPCountKeys
		add	esp, 8
		jmp	short loc_4105A6
; ---------------------------------------------------------------------------

loc_41059E:				; CODE XREF: sub_410580+Cj
		mov	[esp+204h+var_204], 0

loc_4105A6:				; CODE XREF: sub_410580+1Cj
		mov	eax, [esp+204h+arg_8]
		push	100h		; cchBufferMax
		cmp	eax, 0FFFFD3ECh
		jnz	short loc_4105CB
		mov	eax, hModule
		lea	edx, [esp+208h+Buffer]
		push	edx
		push	831h
		push	eax
		jmp	short loc_4105DC
; ---------------------------------------------------------------------------

loc_4105CB:				; CODE XREF: sub_410580+37j
		mov	edx, hModule
		lea	ecx, [esp+208h+Buffer]
		push	ecx		; lpBuffer
		push	823h		; uID
		push	edx		; hInstance

loc_4105DC:				; CODE XREF: sub_410580+49j
		call	ds:LoadStringA
		mov	eax, [esp+204h+var_204]
		lea	ecx, [esp+204h+Buffer]
		push	eax
		lea	edx, [esp+208h+var_100]
		push	ecx		; LPCSTR
		push	edx		; LPSTR
		call	ds:wsprintfA
		mov	ecx, [esp+210h+hWnd]
		add	esp, 0Ch
		lea	eax, [esp+204h+var_100]
		push	eax		; lParam
		push	1		; wParam
		push	401h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		mov	eax, [esp+204h+var_204]
		add	esp, 204h
		retn
sub_410580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_410630	proc near		; CODE XREF: .text:0040D309p
					; .text:0040D7B3p

pvParam		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		push	edi
		lea	eax, [esp+0Ch+pvParam]
		push	0		; fWinIni
		push	eax		; pvParam
		push	0		; uiParam
		push	68h		; uiAction
		call	ds:SystemParametersInfoA
		mov	edi, ds:SendMessageA
		test	eax, eax
		jnz	short loc_41067F
		push	offset aMsh_scroll_lin ; "MSH_SCROLL_LINES_MSG"
		call	ds:RegisterWindowMessageA
		push	offset aMagellanMswhee ; "Magellan MSWHEEL"
		push	offset aMousez	; "MouseZ"
		mov	esi, eax
		call	ds:FindWindowA
		test	eax, eax
		jz	short loc_41067F
		test	esi, esi
		jz	short loc_41067F
		push	0		; lParam
		push	0		; wParam
		push	esi		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		mov	[esp+0Ch+pvParam], eax

loc_41067F:				; CODE XREF: sub_410630+1Cj
					; sub_410630+3Dj ...
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+308h]
		test	eax, eax
		jz	short loc_41069C
		mov	ecx, [esp+0Ch+pvParam]
		push	ecx		; lParam
		push	0		; wParam
		push	101Fh		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA

loc_41069C:				; CODE XREF: sub_410630+5Bj
		mov	eax, [esi+358h]
		test	eax, eax
		jz	short loc_4106B5
		mov	edx, [esp+0Ch+pvParam]
		push	edx		; lParam
		push	0		; wParam
		push	101Fh		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA

loc_4106B5:				; CODE XREF: sub_410630+74j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_410630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4106C0(HWND hWndParent)
sub_4106C0	proc near		; CODE XREF: .text:0040CF90p

lParam		= dword	ptr -104h
var_100		= dword	ptr -100h
var_D8		= dword	ptr -0D8h
var_C4		= dword	ptr -0C4h
var_B0		= dword	ptr -0B0h
var_88		= dword	ptr -88h
var_74		= dword	ptr -74h
var_60		= dword	ptr -60h
var_4C		= dword	ptr -4Ch
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
hWndParent	= dword	ptr  4

		mov	eax, hModule
		sub	esp, 104h
		mov	ecx, [esp+104h+hWndParent]
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0		; lpParam
		push	eax		; hInstance
		push	3334h		; hMenu
		push	ecx		; hWndParent
		push	0		; nHeight
		push	0		; nWidth
		push	4		; Y
		push	4		; X
		push	5600094Ch	; dwStyle
		push	0		; lpWindowName
		push	offset aToolbarwindow3 ; "ToolbarWindow32"
		push	80h		; dwExStyle
		call	ds:CreateWindowExA
		mov	esi, ds:SendMessageA
		push	0		; lParam
		mov	ebp, eax
		push	14h		; wParam
		push	41Eh		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	100010h		; lParam
		push	0		; wParam
		push	420h		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	120018h		; lParam
		push	0		; wParam
		push	41Fh		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	0		; hWnd
		call	ds:GetDC
		mov	ebx, ds:GetDeviceCaps
		mov	esi, eax
		push	0Eh		; index
		push	esi		; hdc
		call	ebx ; GetDeviceCaps
		push	0Ch		; index
		push	esi		; hdc
		mov	edi, eax
		call	ebx ; GetDeviceCaps
		imul	edi, eax
		xor	ebx, ebx
		push	esi		; hDC
		push	ebx		; hWnd
		call	ds:ReleaseDC
		cmp	edi, 8
		push	ebx		; cGrow
		push	0Dh		; cInitial
		jg	short loc_41077D
		push	1		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	edx, hModule
		push	0DFh
		mov	esi, eax
		push	edx
		jmp	short loc_410796
; ---------------------------------------------------------------------------

loc_41077D:				; CODE XREF: sub_4106C0+9Fj
		push	19h		; flags
		push	10h		; cy
		push	10h		; cx
		call	ds:ImageList_Create
		mov	esi, eax
		mov	eax, hModule
		push	0E0h		; lpBitmapName
		push	eax		; hInstance

loc_410796:				; CODE XREF: sub_4106C0+BBj
		call	ds:LoadBitmapA
		mov	edi, eax
		push	0FF00FFh	; crMask
		push	edi		; hbmImage
		push	esi		; himl
		call	ds:ImageList_AddMasked
		push	edi		; ho
		call	ds:DeleteObject
		push	esi		; lParam
		mov	esi, ds:SendMessageA
		push	ebx		; wParam
		push	430h		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		xor	edx, edx
		mov	ecx, offset dword_42F20C
		lea	eax, [esp+114h+var_100]

loc_4107CD:				; CODE XREF: sub_4106C0+141j
		mov	edi, [ecx]
		mov	[eax-4], edx
		mov	[eax], ebx
		mov	byte ptr [eax+5], 0
		mov	[eax+8], ebx
		cmp	edi, ebx
		mov	[eax+0Ch], edx
		jz	short loc_4107EC
		mov	byte ptr [eax+4], 0
		mov	byte ptr [eax+5], 1
		jmp	short loc_4107F5
; ---------------------------------------------------------------------------

loc_4107EC:				; CODE XREF: sub_4106C0+120j
		mov	byte ptr [eax+4], 4
		mov	byte ptr [eax+5], 0
		inc	edx

loc_4107F5:				; CODE XREF: sub_4106C0+12Aj
		add	ecx, 4
		add	eax, 14h
		cmp	ecx, offset aToolbarwindow3 ; "ToolbarWindow32"
		jl	short loc_4107CD
		lea	ecx, [esp+114h+lParam]
		mov	[esp+114h+var_100], 9C69h
		push	ecx		; lParam
		push	0Dh		; wParam
		push	414h		; Msg
		push	ebp		; hWnd
		mov	[esp+124h+var_D8], 9C4Ah
		mov	[esp+124h+var_C4], 9C48h
		mov	[esp+124h+var_B0], 9C46h
		mov	[esp+124h+var_88], 9C6Eh
		mov	[esp+124h+var_60], 9C73h
		mov	[esp+124h+var_74], 0A410h
		mov	[esp+124h+var_4C], 9C55h
		mov	[esp+124h+var_24], 9C5Bh
		mov	[esp+124h+var_10], 9C5Ch
		call	esi ; SendMessageA
		pop	edi
		mov	eax, ebp
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 104h
		retn
sub_4106C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_410890(HWND hWnd)
sub_410890	proc near		; CODE XREF: .text:0040D584p

hWnd		= dword	ptr  4

		mov	eax, [esp+hWnd]
		push	0		; lParam
		push	0		; wParam
		push	431h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		test	eax, eax
		jz	short locret_4108AF
		push	eax		; himl
		call	ds:ImageList_Destroy

locret_4108AF:				; CODE XREF: sub_410890+16j
		retn
sub_410890	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4108B0(HWND hWnd, LPARAM lParam)
sub_4108B0	proc near		; CODE XREF: .text:0040F380p

hWnd		= dword	ptr  4
lParam		= dword	ptr  8

		mov	eax, [esp+lParam]
		mov	ecx, [esp+hWnd]
		push	eax		; lParam
		push	7		; wParam
		push	41Dh		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		retn
sub_4108B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4108D0	proc near		; CODE XREF: .text:0040E27Ep

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, hModule
		mov	[ecx+60h], eax
		mov	eax, [ecx+4]
		cmp	eax, 9C5Ch
		ja	short loc_410931
		jz	short loc_410929
		add	eax, 0FFFF63BAh	; switch 22 cases
		cmp	eax, 15h
		ja	short locret_41096C ; jumptable	004108FA default case
		xor	edx, edx
		mov	dl, ds:byte_410988[eax]
		jmp	ds:off_410970[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_410901:				; CODE XREF: sub_4108D0+2Aj
					; DATA XREF: .text:off_410970o
		mov	dword ptr [ecx+0Ch], 840h ; jumptable 004108FA case 40010
		retn
; ---------------------------------------------------------------------------

loc_410909:				; CODE XREF: sub_4108D0+2Aj
					; DATA XREF: .text:off_410970o
		mov	dword ptr [ecx+0Ch], 841h ; jumptable 004108FA case 40008
		retn
; ---------------------------------------------------------------------------

loc_410911:				; CODE XREF: sub_4108D0+2Aj
					; DATA XREF: .text:off_410970o
		mov	dword ptr [ecx+0Ch], 842h ; jumptable 004108FA case 40006
		retn
; ---------------------------------------------------------------------------

loc_410919:				; CODE XREF: sub_4108D0+2Aj
					; DATA XREF: .text:off_410970o
		mov	dword ptr [ecx+0Ch], 847h ; jumptable 004108FA case 40021
		retn
; ---------------------------------------------------------------------------

loc_410921:				; CODE XREF: sub_4108D0+2Aj
					; DATA XREF: .text:off_410970o
		mov	dword ptr [ecx+0Ch], 848h ; jumptable 004108FA case 40027
		retn
; ---------------------------------------------------------------------------

loc_410929:				; CODE XREF: sub_4108D0+16j
		mov	dword ptr [ecx+0Ch], 849h
		retn
; ---------------------------------------------------------------------------

loc_410931:				; CODE XREF: sub_4108D0+14j
		cmp	eax, 9C73h
		ja	short loc_41095E
		jz	short loc_410956
		sub	eax, 9C69h
		jz	short loc_41094E
		sub	eax, 5
		jnz	short locret_41096C ; jumptable	004108FA default case
		mov	dword ptr [ecx+0Ch], 843h
		retn
; ---------------------------------------------------------------------------

loc_41094E:				; CODE XREF: sub_4108D0+6Fj
		mov	dword ptr [ecx+0Ch], 83Fh
		retn
; ---------------------------------------------------------------------------

loc_410956:				; CODE XREF: sub_4108D0+68j
		mov	dword ptr [ecx+0Ch], 845h
		retn
; ---------------------------------------------------------------------------

loc_41095E:				; CODE XREF: sub_4108D0+66j
		cmp	eax, 0A410h
		jnz	short locret_41096C ; jumptable	004108FA default case
		mov	dword ptr [ecx+0Ch], 846h

locret_41096C:				; CODE XREF: sub_4108D0+20j
					; sub_4108D0+2Aj ...
		retn			; jumptable 004108FA default case
sub_4108D0	endp

; ---------------------------------------------------------------------------
		align 10h
off_410970	dd offset loc_410911	; DATA XREF: sub_4108D0+2Ar
		dd offset loc_410909	; jump table for switch	statement
		dd offset loc_410901
		dd offset loc_410919
		dd offset loc_410921
		dd offset locret_41096C
byte_410988	db	0,     5,     1,     5 ; DATA XREF: sub_4108D0+24r
		db	2,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     3
		db	5,     5,     5,     5
		db	5,     4
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4109A0(WPARAM)
sub_4109A0	proc near		; CODE XREF: .text:0040D303p
					; .text:0040D9BFp ...

var_18		= dword	ptr -18h
lParam		= dword	ptr -14h
wParam		= dword	ptr -10h
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+28h+arg_0]
		xor	ebp, ebp
		cmp	[edi+334h], ebp
		jz	loc_410A99
		mov	ebx, ds:SendMessageA
		mov	eax, offset dword_42F20C
		mov	[esp+28h+arg_0], eax

loc_4109C8:				; CODE XREF: sub_4109A0+EBj
		cmp	dword ptr [eax], 0
		jnz	loc_410A7A
		mov	ecx, [edi+30Ch]
		lea	eax, [esp+28h+lParam]
		push	eax		; lParam
		push	ebp		; wParam
		push	417h		; Msg
		push	ecx		; hWnd
		call	ebx ; SendMessageA
		mov	edx, [esp+28h+wParam]
		mov	esi, 10h
		lea	eax, [edx-9C46h] ; switch 41 cases
		cmp	eax, 28h
		ja	short loc_410A5C ; jumptable 00410A01 default case
		xor	ecx, ecx
		mov	cl, ds:byte_410C1C[eax]
		jmp	ds:off_410C04[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_410A08:				; CODE XREF: sub_4109A0+61j
					; DATA XREF: .text:off_410C04o
		mov	eax, dword_4303C0 ; jumptable 00410A01 case 40041
		test	eax, eax
		jnz	short loc_410A5C ; jumptable 00410A01 default case
		mov	eax, dword_42F0DC
		test	eax, eax
		jz	short loc_410A5C ; jumptable 00410A01 default case
		jmp	short loc_410A57 ; jumptable 00410A01 case 40046
; ---------------------------------------------------------------------------

loc_410A1C:				; CODE XREF: sub_4109A0+61j
					; DATA XREF: .text:off_410C04o
		mov	edx, [edi+338h]	; jumptable 00410A01 case 40006
		push	4
		push	edx

loc_410A25:				; CODE XREF: sub_4109A0+9Fj
		call	sub_401AD0
		add	esp, 8
		test	eax, eax
		jz	short loc_410A5C ; jumptable 00410A01 default case
		jmp	short loc_410A57 ; jumptable 00410A01 case 40046
; ---------------------------------------------------------------------------

loc_410A33:				; CODE XREF: sub_4109A0+61j
					; DATA XREF: .text:off_410C04o
		mov	eax, [edi+338h]	; jumptable 00410A01 case 40021
		push	400h
		push	eax
		jmp	short loc_410A25
; ---------------------------------------------------------------------------

loc_410A41:				; CODE XREF: sub_4109A0+61j
					; DATA XREF: .text:off_410C04o
		mov	ecx, [edi+14h]	; jumptable 00410A01 case 40027
		push	8000h
		push	ecx
		call	ds:PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_410A5C ; jumptable 00410A01 default case

loc_410A57:				; CODE XREF: sub_4109A0+61j
					; sub_4109A0+7Aj ...
		mov	esi, 4		; jumptable 00410A01 case 40046

loc_410A5C:				; CODE XREF: sub_4109A0+57j
					; sub_4109A0+61j ...
		mov	eax, [esp+28h+wParam] ;	jumptable 00410A01 default case
		test	eax, eax
		jz	short loc_410A7A
		mov	edx, [edi+30Ch]
		and	esi, 0FFFFh
		push	esi		; lParam
		push	eax		; wParam
		push	411h		; Msg
		push	edx		; hWnd
		call	ebx ; SendMessageA

loc_410A7A:				; CODE XREF: sub_4109A0+2Bj
					; sub_4109A0+C2j
		mov	eax, [esp+28h+arg_0]
		inc	ebp
		add	eax, 4
		cmp	eax, offset aToolbarwindow3 ; "ToolbarWindow32"
		mov	[esp+28h+arg_0], eax
		jl	loc_4109C8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_410A99:				; CODE XREF: sub_4109A0+13j
		mov	ebx, ds:PGPkmIsActionEnabled
		mov	eax, offset dword_42F20C
		mov	[esp+28h+arg_0], ebp
		mov	ebp, ds:SendMessageA
		mov	[esp+28h+var_18], eax

loc_410AB2:				; CODE XREF: sub_4109A0+256j
		cmp	dword ptr [eax], 0
		jnz	loc_410BDD
		mov	ecx, [esp+28h+arg_0]
		mov	edx, [edi+30Ch]
		lea	eax, [esp+28h+lParam]
		push	eax		; lParam
		push	ecx		; wParam
		push	417h		; Msg
		push	edx		; hWnd
		call	ebp ; SendMessageA
		mov	ecx, [esp+28h+wParam]
		mov	esi, 10h
		cmp	ecx, 9C5Ch
		jg	short loc_410B54
		jz	short loc_410B40
		lea	eax, [ecx-9C46h] ; switch 22 cases
		cmp	eax, 15h
		ja	loc_410BBF	; jumptable 00410AFD default case
		xor	ecx, ecx
		mov	cl, ds:byte_410C60[eax]
		jmp	ds:off_410C48[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_410B04:				; CODE XREF: sub_4109A0+15Dj
					; DATA XREF: .text:off_410C48o
		push	1000h		; jumptable 00410AFD case 40010
		jmp	loc_410B91
; ---------------------------------------------------------------------------

loc_410B0E:				; CODE XREF: sub_4109A0+15Dj
					; DATA XREF: .text:off_410C48o
		mov	eax, [edi+14h]	; jumptable 00410AFD case 40008
		push	100h
		push	eax
		jmp	short loc_410B95
; ---------------------------------------------------------------------------

loc_410B19:				; CODE XREF: sub_4109A0+15Dj
					; DATA XREF: .text:off_410C48o
		mov	ecx, [edi+14h]	; jumptable 00410AFD case 40006
		push	4
		push	ecx
		jmp	short loc_410B95
; ---------------------------------------------------------------------------

loc_410B21:				; CODE XREF: sub_4109A0+15Dj
					; DATA XREF: .text:off_410C48o
		push	20000h		; jumptable 00410AFD case 40021
		jmp	short loc_410B91
; ---------------------------------------------------------------------------

loc_410B28:				; CODE XREF: sub_4109A0+15Dj
					; DATA XREF: .text:off_410C48o
		mov	eax, [edi+14h]	; jumptable 00410AFD case 40027
		push	8000h
		push	eax
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	loc_410BBF	; jumptable 00410AFD default case
		jmp	short loc_410BBA
; ---------------------------------------------------------------------------

loc_410B40:				; CODE XREF: sub_4109A0+144j
		mov	ecx, [edi+14h]
		push	10000h
		push	ecx
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_410BBF ; jumptable 00410AFD default case
		jmp	short loc_410BBA
; ---------------------------------------------------------------------------

loc_410B54:				; CODE XREF: sub_4109A0+142j
		cmp	ecx, 9C73h
		jg	short loc_410BA0
		jz	short loc_410B8C
		mov	eax, ecx
		sub	eax, 9C69h
		jz	short loc_410B73
		sub	eax, 5
		jnz	short loc_410BBF ; jumptable 00410AFD default case
		mov	esi, 4
		jmp	short loc_410BC7
; ---------------------------------------------------------------------------

loc_410B73:				; CODE XREF: sub_4109A0+1C5j
		mov	eax, dword_4303C0
		test	eax, eax
		jnz	short loc_410BC7
		mov	eax, dword_42F0DC
		test	eax, eax
		jz	short loc_410BC7
		mov	esi, 4
		jmp	short loc_410BC7
; ---------------------------------------------------------------------------

loc_410B8C:				; CODE XREF: sub_4109A0+1BCj
		push	80000h

loc_410B91:				; CODE XREF: sub_4109A0+169j
					; sub_4109A0+186j
		mov	edx, [edi+14h]
		push	edx

loc_410B95:				; CODE XREF: sub_4109A0+177j
					; sub_4109A0+17Fj
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_410BBF ; jumptable 00410AFD default case
		jmp	short loc_410BBA
; ---------------------------------------------------------------------------

loc_410BA0:				; CODE XREF: sub_4109A0+1BAj
		cmp	ecx, 0A410h
		jnz	short loc_410BBF ; jumptable 00410AFD default case
		mov	eax, [edi+14h]
		push	40000h
		push	eax
		call	ebx ; PGPkmIsActionEnabled
		add	esp, 8
		test	eax, eax
		jz	short loc_410BBF ; jumptable 00410AFD default case

loc_410BBA:				; CODE XREF: sub_4109A0+19Ej
					; sub_4109A0+1B2j ...
		mov	esi, 4

loc_410BBF:				; CODE XREF: sub_4109A0+14Fj
					; sub_4109A0+15Dj ...
		mov	ecx, [esp+28h+wParam] ;	jumptable 00410AFD default case
		test	ecx, ecx
		jz	short loc_410BDD

loc_410BC7:				; CODE XREF: sub_4109A0+1D1j
					; sub_4109A0+1DAj ...
		and	esi, 0FFFFh
		push	esi		; lParam
		push	ecx		; wParam
		mov	ecx, [edi+30Ch]
		push	411h		; Msg
		push	ecx		; hWnd
		call	ebp ; SendMessageA

loc_410BDD:				; CODE XREF: sub_4109A0+115j
					; sub_4109A0+225j
		mov	eax, [esp+28h+var_18]
		mov	esi, [esp+28h+arg_0]
		add	eax, 4
		inc	esi
		cmp	eax, offset aToolbarwindow3 ; "ToolbarWindow32"
		mov	[esp+28h+arg_0], esi
		mov	[esp+28h+var_18], eax
		jl	loc_410AB2
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_4109A0	endp

; ---------------------------------------------------------------------------
off_410C04	dd offset loc_410A1C	; DATA XREF: sub_4109A0+61r
		dd offset loc_410A33	; jump table for switch	statement
		dd offset loc_410A41
		dd offset loc_410A08
		dd offset loc_410A57
		dd offset loc_410A5C
byte_410C1C	db	0,     5,     5,     5 ; DATA XREF: sub_4109A0+5Br
		db	5,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     1
		db	5,     5,     5,     5
		db	5,     2,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     3
		db	5,     5,     5,     5
		db	4
		align 4
off_410C48	dd offset loc_410B19	; DATA XREF: sub_4109A0+15Dr
		dd offset loc_410B0E	; jump table for switch	statement
		dd offset loc_410B04
		dd offset loc_410B21
		dd offset loc_410B28
		dd offset loc_410BBF
byte_410C60	db	0,     5,     1,     5 ; DATA XREF: sub_4109A0+157r
		db	2,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     3
		db	5,     5,     5,     5
		db	5,     4
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_410C80(HWND hWndParent, int)
sub_410C80	proc near		; CODE XREF: .text:0040D37Ap

hWndParent	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+hWndParent]
		mov	ecx, hModule
		push	0		; dwInitParam
		push	offset sub_410CE0 ; lpDialogFunc
		push	eax		; hWndParent
		push	7Eh		; lpTemplateName
		push	ecx		; hInstance
		call	ds:DialogBoxParamA
		cmp	eax, 2
		jnz	short loc_410CAD
		mov	edx, [esp+arg_4]
		xor	eax, eax
		mov	dword ptr [edx], 0
		retn
; ---------------------------------------------------------------------------

loc_410CAD:				; CODE XREF: sub_410C80+1Ej
		cmp	eax, 40Eh
		jnz	short loc_410CC4
		mov	eax, [esp+arg_4]
		mov	dword ptr [eax], 1
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_410CC4:				; CODE XREF: sub_410C80+32j
		mov	ecx, [esp+arg_4]
		mov	eax, 1
		mov	dword ptr [ecx], 0
		retn
sub_410C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall sub_410CE0(HWND, UINT,	WPARAM,	LPARAM)
sub_410CE0	proc near		; DATA XREF: sub_410C80+Co

hDlg		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		sub	eax, 110h
		jz	short loc_410D4A
		dec	eax
		jz	short loc_410CF3
		xor	eax, eax
		retn	10h
; ---------------------------------------------------------------------------

loc_410CF3:				; CODE XREF: sub_410CE0+Cj
		mov	eax, [esp+arg_8]
		and	eax, 0FFFFh
		sub	eax, 2
		jz	short loc_410D3D
		sub	eax, 40Ch
		jz	short loc_410D25
		sub	eax, 28h
		jnz	short loc_410D4A
		mov	eax, [esp+hDlg]
		push	436h		; nResult
		push	eax		; hDlg
		call	ds:EndDialog
		mov	eax, 1
		retn	10h
; ---------------------------------------------------------------------------

loc_410D25:				; CODE XREF: sub_410CE0+26j
		mov	ecx, [esp+hDlg]
		push	40Eh		; nResult
		push	ecx		; hDlg
		call	ds:EndDialog
		mov	eax, 1
		retn	10h
; ---------------------------------------------------------------------------

loc_410D3D:				; CODE XREF: sub_410CE0+1Fj
		mov	edx, [esp+hDlg]
		push	2		; nResult
		push	edx		; hDlg
		call	ds:EndDialog

loc_410D4A:				; CODE XREF: sub_410CE0+9j
					; sub_410CE0+2Bj
		mov	eax, 1
		retn	10h
sub_410CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_410D60(HWND hWnd)
sub_410D60	proc near		; CODE XREF: .text:0040D35Bp

hWnd		= dword	ptr  4

		mov	eax, [esp+hWnd]
		push	34h		; int
		push	83Ch		; UINT
		push	3		; uID
		push	eax		; hWnd
		call	sub_402000
		add	esp, 10h
		xor	ecx, ecx
		cmp	eax, 6
		setz	cl
		mov	eax, ecx
		retn
sub_410D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_410D90(HWND hWnd)
sub_410D90	proc near		; CODE XREF: .text:0040D575p

lpString2	= dword	ptr -470h
var_46C		= dword	ptr -46Ch
var_468		= byte ptr -468h
var_460		= tagOFNA ptr -460h
cbData		= dword	ptr -414h
phkResult	= dword	ptr -410h
Type		= dword	ptr -40Ch
String1		= byte ptr -408h
Buffer		= byte ptr -304h
Data		= byte ptr -204h
var_100		= byte ptr -100h
hWnd		= dword	ptr  4

		sub	esp, 470h
		push	ebx
		push	ebp
		mov	ebp, [esp+478h+hWnd]
		push	esi
		mov	esi, ds:LoadStringA
		push	edi
		xor	ebx, ebx

loc_410DA9:				; CODE XREF: sub_410D90+2A6j
					; sub_410D90+4F5j
		lea	eax, [esp+480h+phkResult]
		xor	edi, edi
		push	eax		; phkResult
		push	20019h		; samDesired
		push	ebx		; ulOptions
		push	offset SubKey	; "Software\\Microsoft\\Windows\\CurrentVe"...
		push	80000001h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	loc_41128B
		lea	ecx, [esp+480h+cbData]
		lea	edx, [esp+480h+Data]
		push	ecx		; lpcbData
		mov	ecx, [esp+484h+phkResult]
		lea	eax, [esp+484h+Type]
		push	edx		; lpData
		push	eax		; lpType
		push	ebx		; lpReserved
		push	offset aDesktop	; "Desktop"
		push	ecx		; hKey
		mov	[esp+498h+cbData], 104h
		call	ds:RegQueryValueExA
		test	eax, eax
		jz	short loc_410E17
		mov	eax, hModule
		lea	edx, [esp+480h+Data]
		push	104h		; cchBufferMax
		push	edx		; lpBuffer
		push	1Dh		; uID
		push	eax		; hInstance
		call	esi ; LoadStringA

loc_410E17:				; CODE XREF: sub_410D90+6Ej
		mov	eax, hModule
		lea	ecx, [esp+480h+Buffer]
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		push	48Bh		; uID
		push	eax		; hInstance
		mov	[esp+490h+var_460.lStructSize],	4Ch
		mov	[esp+490h+var_460.hwndOwner], ebp
		mov	[esp+490h+var_460.hInstance], eax
		call	esi ; LoadStringA
		lea	edx, [esp+480h+Buffer]
		push	40h		; int
		push	edx		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_410E6F

loc_410E57:				; CODE XREF: sub_410D90+DDj
		mov	[eax], bl
		lea	eax, [esp+480h+Buffer]
		push	40h		; int
		push	eax		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_410E57

loc_410E6F:				; CODE XREF: sub_410D90+C5j
		mov	eax, dword_430850
		lea	edx, [esp+480h+var_46C]
		push	edx
		lea	ecx, [esp+484h+Buffer]
		push	5
		push	eax
		mov	[esp+48Ch+var_460.lpstrFilter],	ecx
		mov	[esp+48Ch+var_460.lpstrCustomFilter], ebx
		mov	[esp+48Ch+var_460.nMaxCustFilter], ebx
		mov	[esp+48Ch+var_460.nFilterIndex], 1
		call	PGPsdkPrefGetFileSpec
		push	eax
		push	ebx
		call	ds:PGPclErrorBox
		add	esp, 14h
		test	eax, eax
		jnz	short loc_410F14
		mov	edx, [esp+480h+var_46C]
		lea	ecx, [esp+480h+lpString2]
		push	ecx
		push	edx
		call	PGPGetFullPathFromFileSpec
		mov	eax, [esp+488h+lpString2]
		push	5Ch		; int
		push	eax		; char *
		call	_strrchr
		add	esp, 10h
		cmp	eax, ebx
		jz	short loc_410ED6
		inc	eax
		lea	ecx, [esp+480h+String1]
		push	eax
		push	ecx
		jmp	short loc_410EE0
; ---------------------------------------------------------------------------

loc_410ED6:				; CODE XREF: sub_410D90+13Bj
		mov	edx, [esp+480h+lpString2]
		lea	eax, [esp+480h+String1]
		push	edx		; lpString2
		push	eax		; lpString1

loc_410EE0:				; CODE XREF: sub_410D90+144j
		call	ds:lstrcpyA
		lea	ecx, [esp+480h+String1]
		push	2Eh		; int
		push	ecx		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_410EFB
		mov	[eax], bl

loc_410EFB:				; CODE XREF: sub_410D90+167j
		mov	edx, [esp+480h+lpString2]
		push	edx
		call	PGPFreeData
		mov	eax, [esp+484h+var_46C]
		push	eax
		call	PGPFreeFileSpec
		add	esp, 8
		jmp	short loc_410F2C
; ---------------------------------------------------------------------------

loc_410F14:				; CODE XREF: sub_410D90+119j
		mov	edx, hModule
		lea	ecx, [esp+480h+String1]
		push	104h		; cchBufferMax
		push	ecx		; lpBuffer
		push	488h		; uID
		push	edx		; hInstance
		call	esi ; LoadStringA

loc_410F2C:				; CODE XREF: sub_410D90+182j
		lea	eax, [esp+480h+String1]
		lea	edx, [esp+480h+var_100]
		mov	[esp+480h+var_460.lpstrFile], eax
		mov	eax, hModule
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		lea	ecx, [esp+488h+Data]
		push	48Ah		; uID
		push	eax		; hInstance
		mov	[esp+490h+var_460.nMaxFile], 104h
		mov	[esp+490h+var_460.lpstrFileTitle], ebx
		mov	[esp+490h+var_460.nMaxFileTitle], ebx
		mov	[esp+490h+var_460.lpstrInitialDir], ecx
		call	esi ; LoadStringA
		mov	eax, hModule
		lea	edx, [esp+480h+var_468]
		push	8		; cchBufferMax
		push	edx		; lpBuffer
		lea	ecx, [esp+488h+var_100]
		push	489h		; uID
		push	eax		; hInstance
		mov	[esp+490h+var_460.lpstrTitle], ecx
		mov	[esp+490h+var_460.Flags], 800Eh
		mov	[esp+490h+var_460.nFileOffset],	bx
		mov	[esp+490h+var_460.nFileExtension], bx
		call	esi ; LoadStringA
		lea	edx, [esp+480h+var_460]
		lea	ecx, [esp+480h+var_468]
		push	edx		; LPOPENFILENAMEA
		mov	[esp+484h+var_460.lpstrDefExt],	ecx
		mov	[esp+484h+var_460.lCustData], ebx
		call	GetSaveFileNameA
		test	eax, eax
		jz	loc_41103C
		mov	ecx, dword_430850
		lea	eax, [esp+480h+var_46C]
		push	eax
		push	5
		push	ecx
		call	PGPsdkPrefGetFileSpec
		push	eax
		push	ebx
		call	ds:PGPclErrorBox
		add	esp, 14h
		test	eax, eax
		jnz	loc_411127
		mov	eax, [esp+480h+var_46C]
		lea	edx, [esp+480h+lpString2]
		push	edx
		push	eax
		call	PGPGetFullPathFromFileSpec
		mov	edx, [esp+488h+lpString2]
		add	esp, 8
		lea	ecx, [esp+480h+String1]
		push	ebx		; bFailIfExists
		push	ecx		; lpNewFileName
		push	edx		; lpExistingFileName
		call	ds:CopyFileA
		test	eax, eax
		jnz	short loc_41100A
		mov	edi, 1

loc_41100A:				; CODE XREF: sub_410D90+273j
		mov	eax, [esp+480h+lpString2]
		push	eax
		call	PGPFreeData
		mov	ecx, [esp+484h+var_46C]
		push	ecx
		call	PGPFreeFileSpec
		add	esp, 8
		cmp	edi, ebx
		jz	short loc_41103C

loc_411025:				; CODE XREF: sub_410D90+39Cj
		push	10h		; int
		push	33h		; UINT
		push	3		; uID
		push	ebp		; hWnd
		call	sub_402000
		add	esp, 10h
		cmp	edi, ebx
		jnz	loc_410DA9

loc_41103C:				; CODE XREF: sub_410D90+222j
					; sub_410D90+293j
		lea	edx, [esp+480h+String1]
		lea	eax, [esp+480h+Data]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		lea	ecx, [esp+480h+Data]
		push	5Ch		; int
		push	ecx		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_411067
		mov	[eax], bl

loc_411067:				; CODE XREF: sub_410D90+2D3j
		mov	eax, hModule
		lea	edx, [esp+480h+Buffer]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	48Ch		; uID
		push	eax		; hInstance
		mov	[esp+490h+var_460.lStructSize],	4Ch
		mov	[esp+490h+var_460.hwndOwner], ebp
		mov	[esp+490h+var_460.hInstance], eax
		call	esi ; LoadStringA
		lea	eax, [esp+480h+Buffer]
		push	40h		; int
		push	eax		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_4110BF

loc_4110A7:				; CODE XREF: sub_410D90+32Dj
		lea	ecx, [esp+480h+Buffer]
		push	40h		; int
		push	ecx		; char *
		mov	[eax], bl
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_4110A7

loc_4110BF:				; CODE XREF: sub_410D90+315j
		mov	ecx, dword_430850
		lea	eax, [esp+480h+var_46C]
		push	eax
		lea	edx, [esp+484h+Buffer]
		push	6
		push	ecx
		mov	[esp+48Ch+var_460.lpstrFilter],	edx
		mov	[esp+48Ch+var_460.lpstrCustomFilter], ebx
		mov	[esp+48Ch+var_460.nMaxCustFilter], ebx
		mov	[esp+48Ch+var_460.nFilterIndex], 1
		call	PGPsdkPrefGetFileSpec
		push	eax
		push	ebx
		call	ds:PGPclErrorBox
		add	esp, 14h
		test	eax, eax
		jnz	short loc_41116F
		mov	eax, [esp+480h+var_46C]
		lea	edx, [esp+480h+lpString2]
		push	edx
		push	eax
		call	PGPGetFullPathFromFileSpec
		mov	ecx, [esp+488h+lpString2]
		push	5Ch		; int
		push	ecx		; char *
		call	_strrchr
		add	esp, 10h
		cmp	eax, ebx
		jz	short loc_411131
		inc	eax
		lea	edx, [esp+480h+String1]
		push	eax
		push	edx
		jmp	short loc_41113B
; ---------------------------------------------------------------------------

loc_411127:				; CODE XREF: sub_410D90+248j
		mov	edi, 1
		jmp	loc_411025
; ---------------------------------------------------------------------------

loc_411131:				; CODE XREF: sub_410D90+38Cj
		mov	eax, [esp+480h+lpString2]
		lea	ecx, [esp+480h+String1]
		push	eax		; lpString2
		push	ecx		; lpString1

loc_41113B:				; CODE XREF: sub_410D90+395j
		call	ds:lstrcpyA
		lea	edx, [esp+480h+String1]
		push	2Eh		; int
		push	edx		; char *
		call	_strrchr
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_411156
		mov	[eax], bl

loc_411156:				; CODE XREF: sub_410D90+3C2j
		mov	eax, [esp+480h+lpString2]
		push	eax
		call	PGPFreeData
		mov	ecx, [esp+484h+var_46C]
		push	ecx
		call	PGPFreeFileSpec
		add	esp, 8
		jmp	short loc_411183
; ---------------------------------------------------------------------------

loc_41116F:				; CODE XREF: sub_410D90+36Aj
		mov	eax, hModule
		lea	edx, [esp+480h+String1]
		push	104h		; cchBufferMax
		push	edx		; lpBuffer
		push	1Ch		; uID
		push	eax		; hInstance
		call	esi ; LoadStringA

loc_411183:				; CODE XREF: sub_410D90+3DDj
		lea	ecx, [esp+480h+String1]
		lea	eax, [esp+480h+var_100]
		mov	[esp+480h+var_460.lpstrFile], ecx
		mov	ecx, hModule
		push	100h		; cchBufferMax
		push	eax		; lpBuffer
		lea	edx, [esp+488h+Data]
		push	1Bh		; uID
		push	ecx		; hInstance
		mov	[esp+490h+var_460.nMaxFile], 104h
		mov	[esp+490h+var_460.lpstrFileTitle], ebx
		mov	[esp+490h+var_460.nMaxFileTitle], ebx
		mov	[esp+490h+var_460.lpstrInitialDir], edx
		call	esi ; LoadStringA
		mov	ecx, hModule
		lea	eax, [esp+480h+var_468]
		push	8		; cchBufferMax
		push	eax		; lpBuffer
		lea	edx, [esp+488h+var_100]
		push	50h		; uID
		push	ecx		; hInstance
		mov	[esp+490h+var_460.lpstrTitle], edx
		mov	[esp+490h+var_460.Flags], 800Eh
		mov	[esp+490h+var_460.nFileOffset],	bx
		mov	[esp+490h+var_460.nFileExtension], bx
		call	esi ; LoadStringA
		lea	eax, [esp+480h+var_460]
		lea	edx, [esp+480h+var_468]
		push	eax		; LPOPENFILENAMEA
		mov	[esp+484h+var_460.lpstrDefExt],	edx
		mov	[esp+484h+var_460.lCustData], ebx
		call	GetSaveFileNameA
		test	eax, eax
		jz	loc_41128B
		mov	edx, dword_430850
		lea	ecx, [esp+480h+var_46C]
		push	ecx
		push	6
		push	edx
		call	PGPsdkPrefGetFileSpec
		push	eax
		push	ebx
		call	ds:PGPclErrorBox
		add	esp, 14h
		test	eax, eax
		jnz	short loc_411296
		mov	ecx, [esp+480h+var_46C]
		lea	eax, [esp+480h+lpString2]
		push	eax
		push	ecx
		call	PGPGetFullPathFromFileSpec
		mov	eax, [esp+488h+lpString2]
		add	esp, 8
		lea	edx, [esp+480h+String1]
		push	ebx		; bFailIfExists
		push	edx		; lpNewFileName
		push	eax		; lpExistingFileName
		call	ds:CopyFileA
		test	eax, eax
		jnz	short loc_411259
		mov	edi, 1

loc_411259:				; CODE XREF: sub_410D90+4C2j
		mov	ecx, [esp+480h+lpString2]
		push	ecx
		call	PGPFreeData
		mov	edx, [esp+484h+var_46C]
		push	edx
		call	PGPFreeFileSpec
		add	esp, 8
		cmp	edi, ebx
		jz	short loc_41128B

loc_411274:				; CODE XREF: sub_410D90+50Bj
		push	10h		; int
		push	33h		; UINT
		push	3		; uID
		push	ebp		; hWnd
		call	sub_402000
		add	esp, 10h
		cmp	edi, ebx
		jnz	loc_410DA9

loc_41128B:				; CODE XREF: sub_410D90+38j
					; sub_410D90+475j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 470h
		retn
; ---------------------------------------------------------------------------

loc_411296:				; CODE XREF: sub_410D90+49Bj
		mov	edi, 1
		jmp	short loc_411274
sub_410D90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4112A0(HWND hWndParent)
sub_4112A0	proc near		; CODE XREF: sub_4100C0+196p

var_5		= byte ptr -5
var_4		= dword	ptr -4
hWndParent	= dword	ptr  4

		sub	esp, 8
		mov	ecx, dword_430850
		lea	eax, [esp+8+var_4]
		push	eax
		push	ecx
		mov	[esp+10h+var_5], 1
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		test	eax, eax
		jnz	short loc_411338
		mov	eax, [esp+8+var_4]
		lea	edx, [esp+8+var_5]
		push	edx
		push	12h
		push	eax
		call	sub_41B3D0
		mov	al, [esp+14h+var_5]
		add	esp, 0Ch
		test	al, al
		jz	short loc_41131E
		mov	ecx, [esp+8+hWndParent]
		mov	edx, hModule
		push	0		; dwInitParam
		push	offset sub_411340 ; lpDialogFunc
		push	ecx		; hWndParent
		push	0B7h		; lpTemplateName
		push	edx		; hInstance
		call	ds:DialogBoxParamA
		test	eax, eax
		jz	short loc_41131E
		mov	eax, [esp+8+var_4]
		push	0
		push	12h
		push	eax
		mov	[esp+14h+var_5], 0
		call	sub_41B430
		add	esp, 0Ch

loc_41131E:				; CODE XREF: sub_4112A0+44j
					; sub_4112A0+66j
		mov	al, [esp+8+var_5]
		mov	edx, [esp+8+var_4]
		xor	ecx, ecx
		test	al, al
		setz	cl
		push	ecx
		push	edx
		call	ds:PGPclCloseClientPrefs
		add	esp, 8

loc_411338:				; CODE XREF: sub_4112A0+28j
		add	esp, 8
		retn
sub_4112A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall sub_411340(HWND, UINT,	WPARAM,	LPARAM)
sub_411340	proc near		; DATA XREF: sub_4112A0+52o

hDlg		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	[esp+arg_4], 111h
		jz	short loc_41134F
		xor	eax, eax
		retn	10h
; ---------------------------------------------------------------------------

loc_41134F:				; CODE XREF: sub_411340+8j
		mov	eax, [esp+arg_8]
		push	esi
		and	eax, 0FFFFh
		dec	eax
		jnz	short loc_41138B
		mov	esi, [esp+4+hDlg]
		push	416h		; nIDButton
		push	esi		; hDlg
		call	ds:IsDlgButtonChecked
		cmp	eax, 1
		jnz	short loc_411382
		push	eax		; nResult
		push	esi		; hDlg
		call	ds:EndDialog
		mov	eax, 1
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------

loc_411382:				; CODE XREF: sub_411340+2Fj
		push	0		; nResult
		push	esi		; hDlg
		call	ds:EndDialog

loc_41138B:				; CODE XREF: sub_411340+1Aj
		mov	eax, 1
		pop	esi
		retn	10h
sub_411340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4113A0	proc near		; CODE XREF: .text:0040E7EFp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, dword_430850
		push	0
		push	0
		push	0
		push	eax
		push	ecx
		call	ds:PGPclHelpAbout
		add	esp, 14h
		retn
sub_4113A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4113C0(HWND hDlg, int	nIDDlgItem)
sub_4113C0	proc near		; CODE XREF: sub_407120+27Dp
					; sub_407120+358p ...

hDlg		= dword	ptr  4
nIDDlgItem	= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+nIDDlgItem]
		push	ebp
		mov	ebp, [esp+8+hDlg]
		push	edi
		push	0		; lParam
		push	0		; wParam
		push	0Eh		; Msg
		push	ebx		; nIDDlgItem
		push	ebp		; hDlg
		call	ds:SendDlgItemMessageA
		mov	edi, eax
		test	edi, edi
		jle	short loc_411431
		lea	eax, [edi+1]
		push	esi
		push	eax		; size_t
		call	sub_40BEF0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_41141F
		mov	ecx, edi
		mov	eax, 20202020h
		mov	edx, ecx
		mov	edi, esi
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		push	esi		; lParam
		push	0		; wParam
		and	ecx, 3
		push	0Ch		; Msg
		push	ebx		; nIDDlgItem
		rep stosb
		push	ebp		; hDlg
		call	ds:SendDlgItemMessageA
		push	esi		; void *
		call	sub_40BF20
		add	esp, 4

loc_41141F:				; CODE XREF: sub_4113C0+30j
		push	offset byte_430394 ; lParam
		push	0		; wParam
		push	0Ch		; Msg
		push	ebx		; nIDDlgItem
		push	ebp		; hDlg
		call	ds:SendDlgItemMessageA
		pop	esi

loc_411431:				; CODE XREF: sub_4113C0+1Dj
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_4113C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_411440	proc near		; CODE XREF: .text:0040D030p
		call	ds:InitCommonControls
		mov	eax, 1
		retn
sub_411440	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_2]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_411460(HINSTANCE hInstance, HWND hWnd)
sub_411460	proc near		; CODE XREF: .text:0040D040p

Rect		= tagRECT ptr -10h
hInstance	= dword	ptr  4
hWnd		= dword	ptr  8

		sub	esp, 10h
		lea	eax, [esp+10h+Rect]
		push	esi
		mov	esi, [esp+14h+hWnd]
		push	eax		; lpRect
		push	esi		; hWnd
		call	ds:GetClientRect
		mov	ecx, [esp+14h+hInstance]
		push	0		; dwInitParam
		push	offset sub_412530 ; lpDialogFunc
		push	esi		; hWndParent
		push	835h		; lpTemplateName
		push	ecx		; hInstance
		call	ds:CreateDialogParamA
		pop	esi
		add	esp, 10h
		retn
sub_411460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4114A0(int, int, int,	HWND hWnd)
sub_4114A0	proc near		; CODE XREF: sub_401260+48p
					; sub_412530+C2Ep

arg_8		= dword	ptr  0Ch
hWnd		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		shr	eax, 10h
		cmp	eax, 1
		jnz	short locret_4114C3
		mov	ecx, [esp+hWnd]
		push	ecx		; hWnd
		call	sub_4119D0
		add	esp, 4
		mov	dword_430438, 0

locret_4114C3:				; CODE XREF: sub_4114A0+Aj
		retn
sub_4114A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4114D0(HWND hDlg)
sub_4114D0	proc near		; CODE XREF: sub_412530+30Bp

var_418		= dword	ptr -418h
wParam		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
lParam		= dword	ptr -408h
var_404		= dword	ptr -404h
Buffer		= byte ptr -400h
var_3FF		= byte ptr -3FFh
String		= byte ptr -200h
var_1FF		= byte ptr -1FFh
hDlg		= dword	ptr  4

		sub	esp, 418h
		push	ebp
		push	esi
		push	edi
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	ebp, eax
		mov	ecx, 7Fh
		xor	eax, eax
		lea	edi, [esp+424h+var_3FF]
		mov	[esp+424h+Buffer], 0
		mov	[esp+424h+String], 0
		rep stosd
		stosw
		stosb
		mov	ecx, 7Fh
		xor	eax, eax
		lea	edi, [esp+424h+var_1FF]
		push	0BBAh		; nIDDlgItem
		rep stosd
		stosw
		stosb
		mov	eax, [esp+428h+hDlg]
		push	eax		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+424h+String]
		mov	esi, eax
		push	200h		; nMaxCount
		push	ecx		; lpString
		push	esi		; hWnd
		call	ds:GetWindowTextA
		test	esi, esi
		jz	loc_41177E
		push	ebx
		mov	ebx, ds:LoadStringA
		lea	edx, [esp+428h+Buffer]
		push	200h		; cchBufferMax
		push	edx		; lpBuffer
		push	7EFh		; uID
		push	ebp		; hInstance
		call	ebx ; LoadStringA
		mov	edi, ds:SendMessageA
		lea	eax, [esp+428h+Buffer]
		push	eax		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		lea	ecx, [esp+428h+Buffer]
		push	200h		; cchBufferMax
		push	ecx		; lpBuffer
		push	7EEh		; uID
		push	ebp		; hInstance
		mov	[esp+438h+wParam], eax
		call	ebx ; LoadStringA
		lea	edx, [esp+428h+Buffer]
		push	edx		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	[esp+428h+var_410], eax
		mov	eax, [esp+428h+wParam]
		push	0		; lParam
		push	eax		; wParam
		push	150h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	ecx, [esp+428h+var_410]
		push	0		; lParam
		push	ecx		; wParam
		push	150h		; Msg
		push	esi		; hWnd
		mov	[esp+438h+var_404], eax
		call	edi ; SendMessageA
		push	0		; lParam
		push	0		; wParam
		push	14Bh		; Msg
		push	esi		; hWnd
		mov	[esp+438h+lParam], eax
		call	edi ; SendMessageA
		mov	edx, [esp+428h+hDlg]
		push	offset aSearchpath ; "SearchPath"
		push	edx		; hWnd
		call	ds:GetPropA
		test	eax, eax
		mov	[esp+428h+var_418], eax
		jz	short loc_41161E
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_4115FF
		mov	eax, [eax]
		push	ecx
		push	eax
		call	sub_41B260
		mov	eax, [esp+430h+var_418]
		add	esp, 8

loc_4115FF:				; CODE XREF: sub_4114D0+11Dj
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_411615
		push	0
		push	ecx
		call	ds:PGPclCloseClientPrefs
		mov	eax, [esp+430h+var_418]
		add	esp, 8

loc_411615:				; CODE XREF: sub_4114D0+133j
		push	eax		; void *
		call	_free
		add	esp, 4

loc_41161E:				; CODE XREF: sub_4114D0+116j
		mov	edx, dword_430850
		lea	ecx, [esp+428h+var_410]
		push	ecx
		push	edx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		add	esp, 8
		mov	[esp+428h+wParam], eax
		test	eax, eax
		jnz	short loc_4116A1
		mov	edx, [esp+428h+var_410]
		lea	eax, [esp+428h+var_418]
		lea	ecx, [esp+428h+var_40C]
		push	eax
		push	ecx
		push	edx
		call	PGPGetKeyServerPrefs
		add	esp, 0Ch
		mov	[esp+428h+wParam], eax
		test	eax, eax
		jnz	short loc_4116A1
		push	0Ch		; size_t
		call	_malloc
		mov	edx, eax
		xor	ecx, ecx
		add	esp, 4
		mov	[edx], ecx
		push	eax		; hData
		push	offset aSearchpath ; "SearchPath"
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	ecx, [esp+430h+var_410]
		mov	[eax], ecx
		mov	edx, [esp+430h+var_40C]
		mov	[eax+4], edx
		mov	edx, [esp+430h+hDlg]
		mov	ecx, [esp+430h+var_418]
		push	edx		; hWnd
		mov	[eax+8], ecx
		call	ds:SetPropA

loc_4116A1:				; CODE XREF: sub_4114D0+172j
					; sub_4114D0+191j
		lea	eax, [esp+428h+Buffer]
		push	200h		; cchBufferMax
		push	eax		; lpBuffer
		push	7EEh		; uID
		push	ebp		; hInstance
		call	ebx ; LoadStringA
		lea	ecx, [esp+428h+Buffer]
		push	ecx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	edx, [esp+428h+lParam]
		push	edx		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		lea	eax, [esp+428h+Buffer]
		push	200h		; cchBufferMax
		push	eax		; lpBuffer
		push	7EFh		; uID
		push	ebp		; hInstance
		call	ebx ; LoadStringA
		lea	ecx, [esp+428h+Buffer]
		push	ecx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	edx, [esp+428h+var_404]
		push	edx		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	eax, [esp+428h+wParam]
		test	eax, eax
		jnz	short loc_41175F
		mov	eax, [esp+428h+var_418]
		xor	ebx, ebx
		test	eax, eax
		jbe	short loc_41175F
		xor	ebp, ebp

loc_411713:				; CODE XREF: sub_4114D0+28Dj
		mov	eax, [esp+428h+var_40C]
		add	eax, ebp
		test	byte ptr [eax+290h], 1
		jz	short loc_411750
		lea	ecx, [esp+428h+Buffer]
		push	ecx
		push	eax
		call	PGPGetKeyServerURL
		add	esp, 8
		lea	edx, [esp+428h+Buffer]
		push	edx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	ecx, [esp+428h+var_40C]
		lea	edx, [ecx+ebp]
		push	edx		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA

loc_411750:				; CODE XREF: sub_4114D0+250j
		mov	eax, [esp+428h+var_418]
		inc	ebx
		add	ebp, 2D4h
		cmp	ebx, eax
		jb	short loc_411713

loc_41175F:				; CODE XREF: sub_4114D0+235j
					; sub_4114D0+23Fj
		push	0		; lParam
		push	2		; wParam
		push	14Eh		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		lea	eax, [esp+428h+String]
		push	eax		; lParam
		push	0		; wParam
		push	14Dh		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		pop	ebx

loc_41177E:				; CODE XREF: sub_4114D0+6Ej
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 418h
		retn
sub_4114D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_411790(HWND hDlg, WPARAM)
sub_411790	proc near		; CODE XREF: sub_401260+139p
					; sub_412530+1046p

var_214		= dword	ptr -214h
var_210		= dword	ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= dword	ptr -208h
wParam		= dword	ptr -204h
Buffer		= byte ptr -200h
var_1FF		= byte ptr -1FFh
hDlg		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 214h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	ebx, eax
		mov	ecx, 7Fh
		xor	eax, eax
		lea	edi, [esp+224h+var_1FF]
		mov	[esp+224h+Buffer], 0
		push	0BBAh		; nIDDlgItem
		rep stosd
		stosw
		stosb
		mov	eax, [esp+228h+hDlg]
		push	eax		; hDlg
		call	ds:GetDlgItem
		mov	edi, ds:SendMessageA
		mov	esi, eax
		test	esi, esi
		jz	loc_41195B
		mov	edx, dword_430850
		lea	ecx, [esp+224h+var_20C]
		push	ecx
		push	edx
		mov	[esp+22Ch+wParam], 2
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jnz	short loc_41187A
		mov	edx, [esp+224h+var_20C]
		lea	eax, [esp+224h+var_214]
		lea	ecx, [esp+224h+var_210]
		push	eax
		push	ecx
		push	edx
		call	PGPGetKeyServerPrefs
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_41187A
		push	0Ch		; size_t
		call	_malloc
		mov	edx, eax
		xor	ecx, ecx
		add	esp, 4
		mov	[edx], ecx
		push	eax		; hData
		push	offset aSearchpath ; "SearchPath"
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	ecx, [esp+22Ch+var_20C]
		mov	[eax], ecx
		mov	edx, [esp+22Ch+var_210]
		mov	[eax+4], edx
		mov	edx, [esp+22Ch+hDlg]
		mov	ecx, [esp+22Ch+var_214]
		push	edx		; hWnd
		mov	[eax+8], ecx
		call	ds:SetPropA
		mov	ecx, [esp+224h+var_20C]
		lea	eax, [esp+224h+wParam]
		push	eax
		push	0D3h
		push	ecx
		call	sub_41B450
		add	esp, 0Ch

loc_41187A:				; CODE XREF: sub_411790+76j
					; sub_411790+93j
		lea	edx, [esp+224h+Buffer]
		push	200h		; cchBufferMax
		push	edx		; lpBuffer
		push	7EEh		; uID
		push	ebx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+224h+Buffer]
		push	eax		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		push	0		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		lea	ecx, [esp+224h+Buffer]
		push	200h		; cchBufferMax
		push	ecx		; lpBuffer
		push	7EFh		; uID
		push	ebx		; hInstance
		call	ds:LoadStringA
		lea	edx, [esp+224h+Buffer]
		push	edx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		push	0		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		test	ebp, ebp
		jnz	short loc_41193E
		mov	eax, [esp+224h+var_214]
		mov	[esp+224h+var_208], ebp
		test	eax, eax
		jbe	short loc_41193E

loc_4118EA:				; CODE XREF: sub_411790+1ACj
		mov	eax, [esp+224h+var_210]
		add	eax, ebp
		test	byte ptr [eax+290h], 1
		jz	short loc_411927
		lea	ecx, [esp+224h+Buffer]
		push	ecx
		push	eax
		call	PGPGetKeyServerURL
		add	esp, 8
		lea	edx, [esp+224h+Buffer]
		push	edx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	ecx, [esp+224h+var_210]
		lea	edx, [ecx+ebp]
		push	edx		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA

loc_411927:				; CODE XREF: sub_411790+167j
		mov	eax, [esp+224h+var_208]
		mov	ecx, [esp+224h+var_214]
		inc	eax
		add	ebp, 2D4h
		cmp	eax, ecx
		mov	[esp+224h+var_208], eax
		jb	short loc_4118EA

loc_41193E:				; CODE XREF: sub_411790+14Cj
					; sub_411790+158j
		push	0		; hData
		push	offset aLastsearchtype ; "LastSearchType"
		push	esi		; hWnd
		call	ds:SetPropA
		mov	eax, [esp+224h+wParam]
		push	0		; lParam
		push	eax		; wParam
		push	14Eh		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA

loc_41195B:				; CODE XREF: sub_411790+46j
		mov	ecx, [esp+224h+hDlg]
		push	0BBDh		; nIDDlgItem
		push	ecx		; hDlg
		call	ds:GetDlgItem
		mov	ebp, eax
		mov	esi, 7D1h

loc_411975:				; CODE XREF: sub_411790+20Dj
		lea	edx, [esp+224h+Buffer]
		push	200h		; cchBufferMax
		push	edx		; lpBuffer
		push	esi		; uID
		push	ebx		; hInstance
		call	ds:LoadStringA
		lea	eax, [esp+224h+Buffer]
		push	eax		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	ebp		; hWnd
		call	edi ; SendMessageA
		inc	esi
		cmp	esi, 7D8h
		jl	short loc_411975
		mov	ecx, [esp+224h+arg_4]
		push	0		; lParam
		push	ecx		; wParam
		push	14Eh		; Msg
		push	ebp		; hWnd
		call	edi ; SendMessageA
		push	ebp		; hWnd
		call	sub_4119D0
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 214h
		retn
sub_411790	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4119D0(HWND hWnd)
sub_4119D0	proc near		; CODE XREF: sub_4114A0+11p
					; sub_411790+222p ...

var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
hInstance	= dword	ptr -104h
Buffer		= byte ptr -100h
var_FF		= byte ptr -0FFh
lParam		= dword	ptr -0FEh
hWnd		= dword	ptr  4

		sub	esp, 10Ch
		push	ebx
		push	ebp
		mov	ebp, ds:SendMessageA
		push	esi
		mov	esi, [esp+118h+hWnd]
		push	edi
		push	0		; lParam
		push	0		; wParam
		push	147h		; Msg
		push	esi		; hWnd
		call	ebp ; SendMessageA
		push	0		; lpModuleName
		mov	[esp+120h+var_10C], eax
		call	ds:GetModuleHandleA
		push	esi		; hWnd
		mov	[esp+120h+hInstance], eax
		call	ds:GetParent
		mov	ebx, eax
		push	offset aHwndtime ; "hwndTime"
		push	ebx		; hWnd
		call	ds:GetPropA
		mov	[esp+11Ch+var_108], eax
		mov	ecx, 3Fh
		xor	eax, eax
		lea	edi, [esp+11Ch+var_FF]
		mov	[esp+11Ch+Buffer], 0
		push	0BBEh		; nIDDlgItem
		rep stosd
		stosw
		push	ebx		; hDlg
		stosb
		call	ds:GetDlgItem
		push	0		; lParam
		mov	edi, eax
		push	0		; wParam
		push	14Bh		; Msg
		push	edi		; hWnd
		call	ebp ; SendMessageA
		mov	ecx, [esp+11Ch+var_10C]
		mov	edx, [esp+11Ch+hInstance]
		lea	eax, [esp+11Ch+Buffer]
		push	100h		; cchBufferMax
		add	ecx, 7DBh
		push	eax		; lpBuffer
		push	ecx		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		lea	ecx, [esp+11Ch+Buffer]
		lea	eax, [esp+11Ch+Buffer]
		test	ecx, ecx
		lea	esi, [esp+11Ch+Buffer]
		jz	short loc_411AAD

loc_411A7B:				; CODE XREF: sub_4119D0+DBj
		cmp	byte ptr [eax],	0
		jz	short loc_411AAD
		test	esi, esi
		jz	short loc_411AA9

loc_411A84:				; CODE XREF: sub_4119D0+C0j
		mov	cl, [esi]
		test	cl, cl
		jz	short loc_411A94
		cmp	cl, 2Ch
		jz	short loc_411A94
		inc	esi
		jnz	short loc_411A84
		jmp	short loc_411AA9
; ---------------------------------------------------------------------------

loc_411A94:				; CODE XREF: sub_4119D0+B8j
					; sub_4119D0+BDj
		test	esi, esi
		jz	short loc_411AA9
		push	eax		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	edi		; hWnd
		mov	byte ptr [esi],	0
		call	ebp ; SendMessageA
		inc	esi
		mov	eax, esi

loc_411AA9:				; CODE XREF: sub_4119D0+B2j
					; sub_4119D0+C2j ...
		test	eax, eax
		jnz	short loc_411A7B

loc_411AAD:				; CODE XREF: sub_4119D0+A9j
					; sub_4119D0+AEj
		mov	esi, [esp+11Ch+var_10C]
		push	0		; lParam
		test	esi, esi
		jnz	short loc_411ABB
		push	2
		jmp	short loc_411ABD
; ---------------------------------------------------------------------------

loc_411ABB:				; CODE XREF: sub_4119D0+E5j
		push	0		; wParam

loc_411ABD:				; CODE XREF: sub_4119D0+E9j
		push	14Eh		; Msg
		push	edi		; hWnd
		call	ebp ; SendMessageA
		mov	eax, [esp+11Ch+hInstance]
		lea	edx, [esp+11Ch+Buffer]
		push	100h		; cchBufferMax
		add	esi, 7E5h
		push	edx		; lpBuffer
		push	esi		; uID
		push	eax		; hInstance
		call	ds:LoadStringA
		mov	esi, ds:GetDlgItem
		push	0BBFh		; nIDDlgItem
		push	ebx		; hDlg
		call	esi ; GetDlgItem
		mov	edi, eax
		push	0BC5h		; nIDDlgItem
		push	ebx		; hDlg
		mov	[esp+124h+var_10C], edi
		call	esi ; GetDlgItem
		push	0BC4h		; nIDDlgItem
		push	ebx		; hDlg
		mov	ebp, eax
		call	esi ; GetDlgItem
		mov	esi, ds:SendMessageA
		push	0		; lParam
		push	0		; wParam
		push	14Bh		; Msg
		push	edi		; hWnd
		mov	ebx, eax
		call	esi ; SendMessageA
		push	0		; lParam
		push	0		; wParam
		push	14Bh		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		cmp	[esp+11Ch+Buffer], 20h
		jz	loc_411C31
		mov	esi, offset aDate ; "Date"
		lea	eax, [esp+11Ch+Buffer]

loc_411B3B:				; CODE XREF: sub_4119D0+189j
		mov	dl, [eax]
		mov	cl, dl
		cmp	dl, [esi]
		jnz	short loc_411B5F
		test	cl, cl
		jz	short loc_411B5B
		mov	dl, [eax+1]
		mov	cl, dl
		cmp	dl, [esi+1]
		jnz	short loc_411B5F
		add	eax, 2
		add	esi, 2
		test	cl, cl
		jnz	short loc_411B3B

loc_411B5B:				; CODE XREF: sub_4119D0+175j
		xor	eax, eax
		jmp	short loc_411B64
; ---------------------------------------------------------------------------

loc_411B5F:				; CODE XREF: sub_4119D0+171j
					; sub_4119D0+17Fj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_411B64:				; CODE XREF: sub_4119D0+18Dj
		test	eax, eax
		push	0		; nCmdShow
		jnz	short loc_411B91
		mov	esi, ds:ShowWindow
		push	edi		; hWnd
		call	esi ; ShowWindow
		push	0		; nCmdShow
		push	ebp		; hWnd
		call	esi ; ShowWindow
		push	0		; nCmdShow
		push	ebx		; hWnd
		call	esi ; ShowWindow
		mov	eax, [esp+11Ch+var_108]
		push	5		; nCmdShow
		push	eax		; hWnd
		call	esi ; ShowWindow
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10Ch
		retn
; ---------------------------------------------------------------------------

loc_411B91:				; CODE XREF: sub_4119D0+198j
		mov	edi, ds:ShowWindow
		push	ebx		; hWnd
		call	edi ; ShowWindow
		mov	ecx, [esp+11Ch+var_108]
		push	0		; nCmdShow
		push	ecx		; hWnd
		call	edi ; ShowWindow
		mov	al, [esp+11Ch+Buffer]
		lea	ebx, [esp+11Ch+Buffer]
		cmp	al, 2Ah
		lea	esi, [esp+11Ch+Buffer]
		jnz	short loc_411BCB
		mov	edx, [esp+11Ch+var_10C]
		push	0		; nCmdShow
		push	edx		; hWnd
		call	edi ; ShowWindow
		push	5		; nCmdShow
		push	ebp		; hWnd
		call	edi ; ShowWindow
		lea	esi, [esp+11Ch+lParam]
		lea	ebx, [esp+11Ch+lParam]
		jmp	short loc_411BDD
; ---------------------------------------------------------------------------

loc_411BCB:				; CODE XREF: sub_4119D0+1E1j
		mov	eax, [esp+11Ch+var_10C]
		push	5		; nCmdShow
		push	eax		; hWnd
		call	edi ; ShowWindow
		push	0		; nCmdShow
		push	ebp		; hWnd
		call	edi ; ShowWindow
		mov	ebp, [esp+11Ch+var_10C]

loc_411BDD:				; CODE XREF: sub_4119D0+1F9j
		test	ebx, ebx
		jz	short loc_411C16

loc_411BE1:				; CODE XREF: sub_4119D0+244j
		cmp	byte ptr [ebx],	0
		jz	short loc_411C16
		test	esi, esi
		jz	short loc_411C12

loc_411BEA:				; CODE XREF: sub_4119D0+225j
		mov	al, [esi]
		test	al, al
		jz	short loc_411BF9
		cmp	al, 2Ch
		jz	short loc_411BF9
		inc	esi
		jnz	short loc_411BEA
		jmp	short loc_411C12
; ---------------------------------------------------------------------------

loc_411BF9:				; CODE XREF: sub_4119D0+21Ej
					; sub_4119D0+222j
		test	esi, esi
		jz	short loc_411C12
		push	ebx		; lParam
		push	0		; wParam
		push	143h		; Msg
		push	ebp		; hWnd
		mov	byte ptr [esi],	0
		call	ds:SendMessageA
		inc	esi
		mov	ebx, esi

loc_411C12:				; CODE XREF: sub_4119D0+218j
					; sub_4119D0+227j ...
		test	ebx, ebx
		jnz	short loc_411BE1

loc_411C16:				; CODE XREF: sub_4119D0+20Fj
					; sub_4119D0+214j
		push	0		; lParam
		push	0		; wParam
		push	14Eh		; Msg
		push	ebp		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10Ch
		retn
; ---------------------------------------------------------------------------

loc_411C31:				; CODE XREF: sub_4119D0+15Cj
		mov	esi, ds:ShowWindow
		push	0		; nCmdShow
		push	edi		; hWnd
		call	esi ; ShowWindow
		push	0		; nCmdShow
		push	ebp		; hWnd
		call	esi ; ShowWindow
		push	5		; nCmdShow
		push	ebx		; hWnd
		call	esi ; ShowWindow
		mov	ecx, [esp+11Ch+var_108]
		push	0		; nCmdShow
		push	ecx		; hWnd
		call	esi ; ShowWindow
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10Ch
		retn
sub_4119D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_411C60(HWND hDlg, int, HWND hWnd)
sub_411C60	proc near		; CODE XREF: sub_412530+988p
					; sub_412530+9C2p

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
lParam		= dword	ptr -34h
var_2E		= dword	ptr -2Eh
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
hDlg		= dword	ptr  4
arg_4		= dword	ptr  8
hWnd		= dword	ptr  0Ch

		sub	esp, 44h
		mov	eax, [esp+44h+hWnd]
		push	ebx
		push	ebp
		mov	ebp, ds:GetDlgItem
		push	esi
		push	edi
		mov	edi, [esp+54h+hDlg]
		xor	esi, esi
		push	0BBDh		; nIDDlgItem
		push	edi		; hDlg
		mov	[esp+5Ch+var_44], esi
		mov	dword ptr [eax], 2
		call	ebp ; GetDlgItem
		push	0BBEh		; nIDDlgItem
		push	edi		; hDlg
		mov	ebx, eax
		call	ebp ; GetDlgItem
		push	0BC4h		; nIDDlgItem
		push	edi		; hDlg
		mov	[esp+5Ch+hWnd],	eax
		call	ebp ; GetDlgItem
		push	0BBFh		; nIDDlgItem
		push	edi		; hDlg
		mov	[esp+5Ch+hDlg],	eax
		call	ebp ; GetDlgItem
		push	0BC5h		; nIDDlgItem
		push	edi		; hDlg
		mov	[esp+5Ch+var_3C], eax
		call	ebp ; GetDlgItem
		push	offset aHwndtime ; "hwndTime"
		push	edi		; hWnd
		mov	[esp+5Ch+var_40], eax
		call	ds:GetPropA
		mov	edi, ds:SendMessageA
		push	esi		; lParam
		push	esi		; wParam
		push	147h		; Msg
		push	ebx		; hWnd
		mov	ebp, eax
		call	edi ; SendMessageA
		mov	ecx, [esp+54h+hWnd]
		push	esi		; lParam
		push	esi		; wParam
		push	147h		; Msg
		push	ecx		; hWnd
		mov	[esp+64h+var_38], eax
		call	edi ; SendMessageA
		mov	edx, [esp+54h+var_3C]
		push	esi		; lParam
		push	esi		; wParam
		push	147h		; Msg
		push	edx		; hWnd
		mov	[esp+64h+hWnd],	eax
		call	edi ; SendMessageA
		mov	ebx, eax
		test	ebx, ebx
		jge	short loc_411D13
		mov	eax, [esp+54h+var_40]
		push	esi		; lParam
		push	esi		; wParam
		push	147h		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA
		mov	ebx, eax

loc_411D13:				; CODE XREF: sub_411C60+A1j
		lea	ecx, [esp+54h+lParam]
		push	ecx		; lParam
		push	0		; wParam
		push	1001h		; Msg
		push	ebp		; hWnd
		call	edi ; SendMessageA
		mov	eax, [esp+54h+var_2E]
		mov	edx, [esp+54h+lParam+2]
		mov	ebp, [esp+54h+lParam]
		and	eax, 0FFFFh
		and	edx, 0FFFFh
		mov	[esp+54h+var_40], eax
		mov	eax, [esp+54h+var_38]
		and	ebp, 0FFFFh
		dec	edx
		sub	ebp, 76Ch
		cmp	eax, 6		; switch 7 cases
		ja	loc_4123DC	; jumptable 00411D57 default case
		jmp	ds:off_4123F8[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_411D5E:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		mov	ebx, [esp+54h+hDlg] ; jumptable	00411D57 case 0
		push	ebx		; hWnd
		call	ds:GetWindowTextLengthA
		mov	edi, eax
		inc	edi
		push	edi		; size_t
		call	_malloc
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_4123CD
		push	edi		; nMaxCount
		push	ebp		; lpString
		push	ebx		; hWnd
		call	ds:GetWindowTextA
		mov	eax, [esp+54h+hWnd]
		cmp	eax, 5		; switch 6 cases
		ja	loc_411F4C	; jumptable 00411D95 default case
		jmp	ds:off_412414[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_411D9C:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	ebx, 1		; jumptable 00411D95 case 1
		jmp	short loc_411DA7
; ---------------------------------------------------------------------------

loc_411DA3:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	ebx, [esp+54h+var_44] ;	jumptable 00411D95 case	0

loc_411DA7:				; CODE XREF: sub_411C60+141j
		mov	edi, [esp+54h+arg_4]
		mov	edx, dword_430850
		push	edi
		push	1
		push	ebp
		push	edx
		call	PGPNewUserIDStringFilter
		add	esp, 10h
		mov	esi, eax
		test	ebx, ebx
		jz	loc_411F4C	; jumptable 00411D95 default case
		test	esi, esi
		jnz	loc_411F4C	; jumptable 00411D95 default case
		mov	ecx, [edi]
		mov	[esp+54h+arg_4], eax
		lea	eax, [esp+54h+arg_4]
		push	eax
		push	ecx
		call	PGPNegateFilter
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	loc_411F4C	; jumptable 00411D95 default case
		mov	edx, [esp+54h+arg_4]
		push	ebp		; void *
		mov	[edi], edx
		call	_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_411E07:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	ebx, 1		; jumptable 00411D95 case 3
		jmp	short loc_411E12
; ---------------------------------------------------------------------------

loc_411E0E:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	ebx, [esp+54h+var_44] ;	jumptable 00411D95 case	2

loc_411E12:				; CODE XREF: sub_411C60+1ACj
		mov	edi, [esp+54h+arg_4]
		mov	eax, dword_430850
		push	edi
		push	4
		push	ebp
		push	eax
		call	PGPNewUserIDStringFilter
		add	esp, 10h
		mov	esi, eax
		test	ebx, ebx
		jz	loc_411F4C	; jumptable 00411D95 default case
		test	esi, esi
		jnz	loc_411F4C	; jumptable 00411D95 default case
		mov	edx, [edi]
		lea	ecx, [esp+54h+arg_4]
		push	ecx
		push	edx
		mov	[esp+5Ch+arg_4], eax
		call	PGPNegateFilter
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	loc_411F4C	; jumptable 00411D95 default case
		mov	eax, [esp+54h+arg_4]
		push	ebp		; void *
		mov	[edi], eax
		call	_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_411E71:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	[esp+54h+var_44], 1 ; jumptable	00411D95 case 5

loc_411E79:				; CODE XREF: sub_411C60+135j
					; DATA XREF: .text:off_412414o
		mov	edx, dword_430850 ; jumptable 00411D95 case 4
		lea	ecx, [esp+54h+hWnd]
		xor	edi, edi
		push	ecx
		push	edi
		push	edx
		mov	[esp+60h+hWnd],	edi
		mov	[esp+60h+hDlg],	edi
		call	PGPOpenDefaultKeyRings
		mov	ebx, [esp+60h+arg_4]
		mov	esi, eax
		mov	eax, [esp+60h+hWnd]
		add	esp, 0Ch
		cmp	eax, edi
		jz	short loc_411F22
		cmp	esi, edi
		jnz	short loc_411F22
		mov	ecx, dword_430850
		lea	eax, [esp+54h+arg_4]
		push	eax
		push	4
		push	ebp
		push	ecx
		mov	[esp+64h+arg_4], edi
		call	PGPNewUserIDStringFilter
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	short loc_411F0C
		mov	eax, [esp+54h+arg_4]
		mov	ecx, [esp+54h+hWnd]
		lea	edx, [esp+54h+hDlg]
		push	edx
		push	eax
		push	ecx
		call	PGPFilterKeySet
		mov	edx, [esp+60h+arg_4]
		mov	esi, eax
		push	edx
		call	PGPFreeFilter
		add	esp, 10h
		cmp	esi, edi
		jnz	short loc_411F0C
		mov	eax, [esp+54h+hDlg]
		push	ebx
		push	eax
		call	sub_412430
		mov	ecx, [esp+5Ch+hDlg]
		mov	esi, eax
		push	ecx
		call	PGPFreeKeySet
		add	esp, 0Ch

loc_411F0C:				; CODE XREF: sub_411C60+269j
					; sub_411C60+290j
		cmp	[ebx], edi
		jnz	short loc_411F15
		mov	esi, 0FFFFCECDh

loc_411F15:				; CODE XREF: sub_411C60+2AEj
		mov	edx, [esp+54h+hWnd]
		push	edx
		call	PGPFreeKeySet
		add	esp, 4

loc_411F22:				; CODE XREF: sub_411C60+244j
					; sub_411C60+248j
		cmp	[esp+54h+var_44], edi
		jz	short loc_411F4C ; jumptable 00411D95 default case
		cmp	esi, edi
		jnz	short loc_411F4C ; jumptable 00411D95 default case
		mov	ecx, [ebx]
		lea	eax, [esp+54h+arg_4]
		push	eax
		push	ecx
		mov	[esp+5Ch+arg_4], edi
		call	PGPNegateFilter
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_411F4C ; jumptable 00411D95 default case
		mov	edx, [esp+54h+arg_4]
		mov	[ebx], edx

loc_411F4C:				; CODE XREF: sub_411C60+12Fj
					; sub_411C60+162j ...
		push	ebp		; jumptable 00411D95 default case
		call	_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_411F5F:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		mov	ebp, [esp+54h+hDlg] ; jumptable	00411D57 case 1
		push	ebp		; hWnd
		call	ds:GetWindowTextLengthA
		mov	edi, eax
		inc	edi
		push	edi		; size_t
		call	_malloc
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_4123CD
		push	edi		; nMaxCount
		push	ebx		; lpString
		push	ebp		; hWnd
		call	ds:GetWindowTextA
		mov	eax, [esp+54h+hWnd]
		sub	eax, 0
		jz	short loc_411FA0
		dec	eax
		jnz	loc_4123BA
		mov	ebp, 1
		jmp	short loc_411FA4
; ---------------------------------------------------------------------------

loc_411FA0:				; CODE XREF: sub_411C60+330j
		mov	ebp, [esp+54h+var_44]

loc_411FA4:				; CODE XREF: sub_411C60+33Ej
		lea	eax, [esp+54h+var_24]
		push	eax
		push	ebx
		call	PGPGetKeyIDFromString
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	loc_4123BA
		mov	edi, [esp+54h+arg_4]
		mov	edx, dword_430850
		lea	ecx, [esp+54h+var_24]
		push	edi
		push	ecx
		push	edx
		call	PGPNewKeyIDFilter
		add	esp, 0Ch
		mov	esi, eax
		test	ebp, ebp
		jz	loc_4123BA
		test	esi, esi
		jnz	loc_4123BA
		mov	ecx, [edi]
		mov	[esp+54h+arg_4], eax
		lea	eax, [esp+54h+arg_4]
		push	eax
		push	ecx
		call	PGPNegateFilter
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	loc_4123BA
		mov	edx, [esp+54h+arg_4]
		push	ebx		; void *
		mov	[edi], edx
		call	_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_41201E:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		test	ebx, ebx	; jumptable 00411D57 case 2
		mov	byte ptr [esp+54h+hWnd], 0
		jnz	short loc_41202E
		mov	byte ptr [esp+54h+hWnd], 10h
		jmp	short loc_412037
; ---------------------------------------------------------------------------

loc_41202E:				; CODE XREF: sub_411C60+3C5j
		cmp	ebx, 1
		jnz	short loc_412037
		mov	byte ptr [esp+54h+hWnd], bl

loc_412037:				; CODE XREF: sub_411C60+3CCj
					; sub_411C60+3D1j
		mov	ecx, [esp+54h+hWnd]
		mov	eax, [esp+54h+arg_4]
		mov	edx, dword_430850
		and	ecx, 0FFh
		push	eax
		push	ecx
		push	edx
		call	PGPNewKeyEncryptAlgorithmFilter
		add	esp, 0Ch
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_412060:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		mov	ecx, 9		; jumptable 00411D57 case 3
		xor	eax, eax
		lea	edi, [esp+54h+var_24]
		rep stosd
		mov	eax, [esp+54h+var_40]
		xor	edi, edi
		mov	[esp+54h+var_18], eax
		mov	eax, [esp+54h+hWnd]
		sub	eax, edi
		mov	[esp+54h+var_14], edx
		mov	[esp+54h+var_10], ebp
		jz	short loc_4120EE
		dec	eax
		jz	short loc_4120D0
		dec	eax
		jnz	loc_4123ED
		mov	ecx, [esp+54h+arg_4]
		mov	[esp+54h+var_24], edi
		push	ecx
		mov	[esp+58h+var_20], edi
		mov	[esp+58h+var_1C], edi
		push	2

loc_4120A4:				; CODE XREF: sub_411C60+48Cj
		lea	edx, [esp+5Ch+var_24]
		push	edx		; time_t
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		add	esp, 8
		push	eax
		mov	eax, dword_430850
		push	eax
		call	PGPNewKeyCreationTimeFilter
		add	esp, 10h
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_4120D0:				; CODE XREF: sub_411C60+428j
		mov	ecx, [esp+54h+arg_4]
		mov	eax, 3Bh
		push	ecx
		mov	[esp+58h+var_24], eax
		mov	[esp+58h+var_20], eax
		mov	[esp+58h+var_1C], 17h
		push	3
		jmp	short loc_4120A4
; ---------------------------------------------------------------------------

loc_4120EE:				; CODE XREF: sub_411C60+425j
		lea	ecx, [esp+54h+hDlg]
		lea	edx, [esp+54h+var_24]
		push	ecx
		push	2
		push	edx		; time_t
		mov	[esp+60h+var_24], edi
		mov	[esp+60h+var_20], edi
		mov	[esp+60h+var_1C], edi
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		add	esp, 8
		push	eax
		mov	eax, dword_430850
		push	eax
		call	PGPNewKeyCreationTimeFilter
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	loc_4123ED
		lea	ecx, [esp+54h+hWnd]
		lea	edx, [esp+54h+var_24]
		push	ecx
		mov	eax, 3Bh
		push	3
		push	edx		; time_t
		mov	[esp+60h+var_24], eax
		mov	[esp+60h+var_20], eax
		mov	[esp+60h+var_1C], 17h
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		add	esp, 8
		push	eax
		mov	eax, dword_430850
		push	eax
		call	PGPNewKeyCreationTimeFilter
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	loc_4123ED
		mov	ecx, [esp+54h+arg_4]
		mov	edx, [esp+54h+hWnd]
		mov	eax, [esp+54h+hDlg]
		push	ecx
		push	edx
		push	eax
		call	PGPIntersectFilters
		add	esp, 0Ch
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_412196:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		mov	ecx, 9		; jumptable 00411D57 case 4
		xor	eax, eax
		lea	edi, [esp+54h+var_24]
		rep stosd
		mov	eax, [esp+54h+hWnd]
		mov	ecx, [esp+54h+var_40]
		xor	edi, edi
		mov	[esp+54h+var_18], ecx
		sub	eax, edi
		mov	[esp+54h+var_14], edx
		mov	[esp+54h+var_10], ebp
		jz	short loc_412225
		dec	eax
		jz	short loc_4121DC
		dec	eax
		jnz	loc_4123ED
		mov	edx, [esp+54h+arg_4]
		mov	[esp+54h+var_24], edi
		push	edx
		mov	[esp+58h+var_20], edi
		mov	[esp+58h+var_1C], edi
		push	2
		jmp	short loc_4121F8
; ---------------------------------------------------------------------------

loc_4121DC:				; CODE XREF: sub_411C60+55Ej
		mov	edx, [esp+54h+arg_4]
		mov	eax, 3Bh
		push	edx
		mov	[esp+58h+var_24], eax
		mov	[esp+58h+var_20], eax
		mov	[esp+58h+var_1C], 17h
		push	3

loc_4121F8:				; CODE XREF: sub_411C60+57Aj
		lea	eax, [esp+5Ch+var_24]
		push	eax		; time_t
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		mov	ecx, dword_430850
		add	esp, 8
		push	eax
		push	ecx
		call	PGPNewKeyExpirationTimeFilter
		add	esp, 10h
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_412225:				; CODE XREF: sub_411C60+55Bj
		lea	edx, [esp+54h+hDlg]
		lea	eax, [esp+54h+var_24]
		push	edx
		push	2
		push	eax		; time_t
		mov	[esp+60h+var_24], edi
		mov	[esp+60h+var_20], edi
		mov	[esp+60h+var_1C], edi
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		mov	ecx, dword_430850
		add	esp, 8
		push	eax
		push	ecx
		call	PGPNewKeyExpirationTimeFilter
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	loc_4123ED
		mov	eax, 3Bh
		lea	edx, [esp+54h+hWnd]
		mov	[esp+54h+var_24], eax
		mov	[esp+54h+var_20], eax
		push	edx
		lea	eax, [esp+58h+var_24]
		push	3
		push	eax		; time_t
		mov	[esp+60h+var_1C], 17h
		call	sub_41C207
		push	eax
		call	PGPGetPGPTimeFromStdTime
		mov	ecx, dword_430850
		add	esp, 8
		push	eax
		push	ecx
		call	PGPNewKeyExpirationTimeFilter
		mov	esi, eax
		add	esp, 10h
		cmp	esi, edi
		jnz	loc_4123ED
		mov	edx, [esp+54h+arg_4]
		mov	eax, [esp+54h+hWnd]
		mov	ecx, [esp+54h+hDlg]
		push	edx
		push	eax
		push	ecx
		call	PGPIntersectFilters
		add	esp, 0Ch
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_4122CF:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		test	ebx, ebx	; jumptable 00411D57 case 5
		jnz	short loc_4122FB
		mov	edi, [esp+54h+hWnd]
		mov	edx, [esp+54h+arg_4]
		mov	ecx, dword_430850
		push	edx
		test	edi, edi
		setz	al
		push	eax
		push	ecx
		call	PGPNewKeyRevokedFilter
		add	esp, 0Ch
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_4122FB:				; CODE XREF: sub_411C60+671j
		cmp	ebx, 1
		jnz	loc_4123ED
		mov	edi, [esp+54h+hWnd]
		mov	edx, [esp+54h+arg_4]
		mov	ecx, dword_430850
		push	edx
		test	edi, edi
		setz	al
		push	eax
		push	ecx
		call	PGPNewKeyDisabledFilter
		add	esp, 0Ch
		mov	esi, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_41232C:				; CODE XREF: sub_411C60+F7j
					; DATA XREF: .text:off_4123F8o
		mov	ebp, [esp+54h+var_3C] ;	jumptable 00411D57 case	6
		push	ebp		; hWnd
		call	ds:GetWindowTextLengthA
		mov	edi, eax
		inc	edi
		push	edi		; size_t
		call	_malloc
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_4123CD
		push	edi		; nMaxCount
		push	ebx		; lpString
		push	ebp		; hWnd
		call	ds:GetWindowTextA
		mov	eax, [esp+54h+hWnd]
		sub	eax, 0
		jz	short loc_412398
		dec	eax
		jz	short loc_41237E
		dec	eax
		jnz	short loc_4123BA
		mov	edx, [esp+54h+arg_4]
		push	edx
		push	3
		push	ebx		; char *
		call	_atol
		add	esp, 4
		push	eax
		mov	eax, dword_430850
		push	eax
		jmp	short loc_4123B0
; ---------------------------------------------------------------------------

loc_41237E:				; CODE XREF: sub_411C60+700j
		mov	ecx, [esp+54h+arg_4]
		push	ecx
		push	2
		push	ebx		; char *
		call	_atol
		mov	edx, dword_430850
		add	esp, 4
		push	eax
		push	edx
		jmp	short loc_4123B0
; ---------------------------------------------------------------------------

loc_412398:				; CODE XREF: sub_411C60+6FDj
		mov	eax, [esp+54h+arg_4]
		push	eax
		push	1
		push	ebx		; char *
		call	_atol
		mov	ecx, dword_430850
		add	esp, 4
		push	eax
		push	ecx

loc_4123B0:				; CODE XREF: sub_411C60+71Cj
					; sub_411C60+736j
		call	PGPNewKeyEncryptKeySizeFilter
		add	esp, 10h
		mov	esi, eax

loc_4123BA:				; CODE XREF: sub_411C60+333j
					; sub_411C60+356j ...
		push	ebx		; void *
		call	_free
		add	esp, 4
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_4123CD:				; CODE XREF: sub_411C60+119j
					; sub_411C60+31Aj ...
		mov	esi, 0FFFFD121h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_4123DC:				; CODE XREF: sub_411C60+F1j
		push	0		; jumptable 00411D57 default case
		push	0		; lpCaption
		push	offset aDefaultfilterU ; "DefaultFilter: Unknown Attribute"
		push	0		; hWnd
		call	ds:MessageBoxA

loc_4123ED:				; CODE XREF: sub_411C60+42Bj
					; sub_411C60+4C7j ...
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 44h
		retn
sub_411C60	endp

; ---------------------------------------------------------------------------
		align 4
off_4123F8	dd offset loc_411D5E	; DATA XREF: sub_411C60+F7r
		dd offset loc_411F5F	; jump table for switch	statement
		dd offset loc_41201E
		dd offset loc_412060
		dd offset loc_412196
		dd offset loc_4122CF
		dd offset loc_41232C
off_412414	dd offset loc_411DA3	; DATA XREF: sub_411C60+135r
		dd offset loc_411D9C	; jump table for switch	statement
		dd offset loc_411E0E
		dd offset loc_411E07
		dd offset loc_411E79
		dd offset loc_411E71
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_412430	proc near		; CODE XREF: sub_411C60+298p

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 34h
		mov	ecx, [esp+34h+arg_0]
		push	ebx
		push	esi
		lea	eax, [esp+3Ch+var_2C]
		push	edi
		push	eax
		xor	ebx, ebx
		push	1
		push	ecx
		mov	[esp+4Ch+var_2C], ebx
		mov	[esp+4Ch+var_30], ebx
		mov	[esp+4Ch+var_28], ebx
		mov	[esp+4Ch+var_34], ebx
		xor	edi, edi
		call	PGPOrderKeySet
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	loc_41251C
		mov	eax, [esp+40h+var_2C]
		lea	edx, [esp+40h+var_30]
		push	edx
		push	eax
		call	PGPNewKeyIter
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	loc_412503

loc_412482:				; CODE XREF: sub_412430+C4j
		mov	edx, [esp+40h+var_30]
		lea	ecx, [esp+40h+var_28]
		push	ecx
		push	edx
		call	PGPKeyIterNext
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_4124F6
		mov	ecx, [esp+40h+var_28]
		lea	eax, [esp+40h+var_24]
		push	eax
		push	ecx
		call	PGPGetKeyIDFromKey
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	short loc_4124F6
		mov	ecx, dword_430850
		lea	edx, [esp+40h+var_34]
		lea	eax, [esp+40h+var_24]
		push	edx
		push	eax
		push	ecx
		call	PGPNewSigKeyIDFilter
		add	esp, 0Ch
		cmp	edi, ebx
		mov	esi, eax
		jnz	short loc_4124D5
		mov	edi, [esp+40h+var_34]
		jmp	short loc_4124F2
; ---------------------------------------------------------------------------

loc_4124D5:				; CODE XREF: sub_412430+9Dj
		mov	eax, [esp+40h+var_34]
		lea	edx, [esp+40h+arg_0]
		push	edx
		push	eax
		push	edi
		mov	[esp+4Ch+arg_0], ebx
		call	PGPUnionFilters
		mov	edi, [esp+4Ch+arg_0]
		add	esp, 0Ch
		mov	esi, eax

loc_4124F2:				; CODE XREF: sub_412430+A3j
		cmp	esi, ebx
		jz	short loc_412482

loc_4124F6:				; CODE XREF: sub_412430+66j
					; sub_412430+7Ej
		mov	ecx, [esp+40h+var_30]
		push	ecx
		call	PGPFreeKeyIter
		add	esp, 4

loc_412503:				; CODE XREF: sub_412430+4Cj
		mov	edx, [esp+40h+var_2C]
		push	edx
		call	PGPFreeKeyList
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_41251A
		mov	eax, [esp+40h+arg_4]
		mov	[eax], edi

loc_41251A:				; CODE XREF: sub_412430+E2j
		mov	eax, esi

loc_41251C:				; CODE XREF: sub_412430+30j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 34h
		retn
sub_412430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall sub_412530(HWND, UINT,	WPARAM,	LPARAM)
sub_412530	proc near		; DATA XREF: sub_411460+1Ao

rc		= RECT ptr -1A4h
hData		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= dword	ptr -18Ch
qrc		= tagRECT ptr -188h
var_178		= dword	ptr -178h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= tagRECT ptr -168h
Rect		= tagRECT ptr -158h
var_148		= byte ptr -148h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
lParam		= dword	ptr -100h
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 1A4h
		push	ebx
		mov	ebx, ds:GetPropA
		push	ebp
		push	esi
		mov	esi, [esp+1B0h+hWnd]
		push	edi
		push	offset aOldwidth ; "oldWidth"
		push	esi		; hWnd
		call	ebx ; GetPropA
		push	offset aOldheight ; "oldHeight"
		push	esi		; hWnd
		mov	edi, eax
		call	ebx ; GetPropA
		mov	[esp+1B4h+var_16C], eax
		mov	eax, [esp+1B4h+arg_4]
		cmp	eax, 7Bh
		ja	loc_412CE8
		jz	loc_412CBF
		add	eax, 0FFFFFFFEh	; switch 77 cases
		cmp	eax, 4Ch
		ja	loc_41379B	; jumptable 00412587 default case
		xor	ecx, ecx
		mov	cl, ds:byte_4137C8[eax]
		jmp	ds:off_4137AC[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_41258E:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		push	0		; jumptable 00412587 case 2
		call	ds:GetModuleHandleA
		push	offset aSearchinfo ; "SearchInfo"
		push	esi		; hWnd
		mov	[esp+1BCh+var_18C], 0
		call	ebx ; GetPropA
		mov	edi, eax
		test	edi, edi
		jz	short loc_4125C5
		mov	eax, [edi+4]
		test	eax, eax
		jz	short loc_4125BC
		push	0		; dwExitCode
		push	eax		; hThread
		call	ds:TerminateThread

loc_4125BC:				; CODE XREF: sub_412530+81j
		push	edi		; void *
		call	_free
		add	esp, 4

loc_4125C5:				; CODE XREF: sub_412530+7Aj
		push	offset aKeyserverlock ;	"KeyserverLock"
		push	esi		; hWnd
		call	ebx ; GetPropA
		mov	edi, eax
		test	edi, edi
		jz	short loc_4125EA
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	edi		; lpCriticalSection
		call	ds:DeleteCriticalSection
		push	edi		; void *
		call	_free
		add	esp, 4

loc_4125EA:				; CODE XREF: sub_412530+A1j
		mov	ebp, ds:DestroyWindow

loc_4125F0:				; CODE XREF: sub_412530+D9j
		lea	edx, [esp+1B4h+var_18C]
		push	edx		; int
		push	esi		; hWnd
		call	sub_401090
		add	esp, 8
		mov	edi, eax
		mov	eax, [esp+1B4h+var_18C]
		push	eax		; hWnd
		call	ebp ; DestroyWindow
		test	edi, edi
		jnz	short loc_4125F0
		push	0BBAh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	edi		; lParam
		push	edi		; wParam
		push	147h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		push	offset aSearchpath ; "SearchPath"
		push	esi		; hWnd
		mov	edi, eax
		call	ebx ; GetPropA
		mov	esi, eax
		test	esi, esi
		jz	short loc_412663
		mov	ecx, [esi+4]
		mov	edx, [esi]
		push	ecx
		push	edx
		call	sub_41B260
		mov	eax, [esi]
		push	edi
		push	0D3h
		push	eax
		call	sub_41B4C0
		mov	ecx, [esi]
		push	1
		push	ecx
		call	ds:PGPclCloseClientPrefs
		push	esi		; void *
		call	_free
		add	esp, 20h

loc_412663:				; CODE XREF: sub_412530+103j
		call	nullsub_2
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41267A:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		mov	eax, [esp+1B4h+arg_C] ;	jumptable 00412587 case	44
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jz	short loc_41268B
		add	dword ptr [eax+10h], 2

loc_41268B:				; CODE XREF: sub_412530+155j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41269D:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		mov	esi, [esp+1B4h+arg_C] ;	jumptable 00412587 case	43
		mov	[esp+1B4h+var_18C], 2
		cmp	dword ptr [esi+8], 0FFFFFFFFh
		jz	loc_41379B	; jumptable 00412587 default case
		mov	edx, [esi+1Ch]
		mov	eax, [esi+20h]
		mov	ecx, [esi+24h]
		mov	ebx, ds:GetSysColor
		mov	[esp+1B4h+rc.left], edx
		mov	edx, [esi+28h]
		push	5		; nIndex
		mov	[esp+1B8h+rc.top], eax
		mov	[esp+1B8h+rc.right], ecx
		mov	[esp+1B8h+rc.bottom], edx
		call	ebx ; GetSysColor
		mov	ebp, ds:CreateSolidBrush
		push	eax		; color
		call	ebp ; CreateSolidBrush
		mov	ecx, [esi+18h]
		mov	edi, eax
		lea	eax, [esp+1B4h+rc]
		push	edi		; hbr
		push	eax		; lprc
		push	ecx		; hDC
		call	ds:FillRect
		push	edi		; ho
		call	ds:DeleteObject
		mov	eax, [esi+10h]
		test	al, 10h
		jz	short loc_41274C
		test	ah, 10h
		jnz	short loc_41272C
		mov	eax, [esi+8]
		cmp	eax, 1
		jnz	short loc_412723
		mov	[esp+1B4h+var_18C], eax
		mov	eax, [esp+1B4h+rc.bottom]
		sub	eax, 2
		mov	[esp+1B4h+rc.bottom], eax
		jmp	short loc_41272C
; ---------------------------------------------------------------------------

loc_412723:				; CODE XREF: sub_412530+1E0j
		cmp	eax, 2
		jnz	short loc_41272C
		inc	[esp+1B4h+rc.top]

loc_41272C:				; CODE XREF: sub_412530+1D8j
					; sub_412530+1F1j ...
		push	0Dh		; nIndex
		call	ebx ; GetSysColor
		push	eax		; color
		call	ebp ; CreateSolidBrush
		mov	edi, eax
		mov	eax, [esi+18h]
		lea	edx, [esp+1B4h+rc]
		push	edi		; hbr
		push	edx		; lprc
		push	eax		; hDC
		call	ds:FillRect
		push	edi		; ho
		call	ds:DeleteObject

loc_41274C:				; CODE XREF: sub_412530+1D3j
		mov	edx, [esi+8]
		mov	eax, [esi+14h]
		lea	ecx, [esp+1B4h+lParam]
		push	ecx		; lParam
		push	edx		; wParam
		push	148h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	ecx, [esi+18h]
		push	1		; mode
		push	ecx		; hdc
		call	ds:SetBkMode
		mov	edx, [esi+10h]
		and	dl, 10h
		neg	dl
		sbb	edx, edx
		and	edx, 0FFFFFFFCh
		add	edx, 12h
		push	edx		; nIndex
		call	ebx ; GetSysColor
		push	eax		; color
		mov	eax, [esi+18h]
		push	eax		; hdc
		call	ds:SetTextColor
		lea	edi, [esp+1B4h+lParam]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		mov	edx, [esi+20h]
		repne scasb
		mov	ebp, [esp+1B4h+var_18C]
		mov	eax, [esi+18h]
		not	ecx
		dec	ecx
		add	edx, ebp
		push	ecx		; c
		lea	ecx, [esp+1B8h+lParam]
		push	ecx		; lpString
		push	edx		; y
		push	4		; x
		push	eax		; hdc
		call	ds:TextOutA
		mov	ecx, [esi+1Ch]
		mov	eax, [esi+24h]
		mov	edx, [esi+20h]
		mov	[esp+1B4h+qrc.left], ecx
		mov	ecx, [esi+10h]
		mov	[esp+1B4h+qrc.right], eax
		mov	eax, [esi+28h]
		mov	[esp+1B4h+qrc.top], edx
		test	ch, 10h
		mov	[esp+1B4h+qrc.bottom], eax
		jnz	short loc_412803
		cmp	dword ptr [esi+8], 1
		jnz	short loc_412803
		mov	edx, [esi+18h]
		push	2		; grfFlags
		lea	ecx, [esp+1B8h+qrc]
		push	6		; edge
		dec	eax
		push	ecx		; qrc
		push	edx		; hdc
		mov	[esp+1C4h+qrc.top], eax
		call	ds:DrawEdge

loc_412803:				; CODE XREF: sub_412530+2B3j
					; sub_412530+2B9j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412815:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		mov	eax, [esp+1B4h+arg_C] ;	jumptable 00412587 case	78
		cmp	dword ptr [eax+8], 8078h
		jnz	loc_41379B	; jumptable 00412587 default case
		push	offset aKeyserverlock ;	"KeyserverLock"
		push	esi		; hWnd
		call	ebx ; GetPropA
		mov	edi, eax
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	esi		; hDlg
		call	sub_4114D0
		add	esp, 4
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412859:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		mov	ecx, [esp+1B4h+arg_C] ;	jumptable 00412587 case	5
		mov	edx, ecx
		mov	eax, ecx
		shr	edx, 10h
		and	ecx, 0FFFFh
		mov	[esp+1B4h+var_178], edx
		mov	edx, ecx
		sub	edx, edi
		mov	[esp+1B4h+hData], edx
		mov	edx, dword_430444
		cmp	ecx, edx
		jge	short loc_41288D
		mov	eax, edx
		sub	eax, edi
		mov	[esp+1B4h+hData], eax
		mov	eax, edx

loc_41288D:				; CODE XREF: sub_412530+351j
		and	eax, 0FFFFh
		cmp	eax, edx
		jl	loc_412C30
		push	eax		; hData
		push	offset aOldwidth ; "oldWidth"
		push	esi		; hWnd
		call	ds:SetPropA
		push	0BB8h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		mov	edi, ds:GetWindowRect
		lea	ecx, [esp+1B4h+rc]
		mov	ebp, eax
		push	ecx		; lpRect
		push	ebp		; hWnd
		call	edi ; GetWindowRect
		mov	ebx, ds:MapWindowPoints
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+hData]
		add	ecx, eax
		push	ecx		; X
		push	ebp		; hWnd
		mov	ebp, ds:MoveWindow
		call	ebp ; MoveWindow
		push	421h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+rc]
		push	ecx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+hData]
		add	ecx, eax
		push	ecx		; X
		mov	ecx, [esp+1C8h+var_190]
		push	ecx		; hWnd
		call	ebp ; MoveWindow
		push	0BB9h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	eax, [esp+1B4h+rc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+hData]
		add	ecx, eax
		push	ecx		; X
		mov	ecx, [esp+1C8h+var_190]
		push	ecx		; hWnd
		call	ebp ; MoveWindow
		push	9		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	eax, [esp+1B4h+rc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+hData]
		add	ecx, eax
		push	ecx		; X
		mov	ecx, [esp+1C8h+var_190]
		push	ecx		; hWnd
		call	ebp ; MoveWindow
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	eax, [esp+1B4h+rc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		add	edx, [esp+1BCh+hData]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		push	0BC4h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+rc]
		push	ecx		; lpRect
		mov	[esp+1B8h+var_190], eax
		push	eax		; hWnd
		call	edi ; GetWindowRect
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		add	edx, [esp+1BCh+hData]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		push	0BC5h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+rc]
		push	ecx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		add	edx, [esp+1BCh+hData]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		push	esi		; hWnd
		call	sub_401100
		add	esp, 4
		mov	[esp+1B4h+var_18C], eax
		test	eax, eax
		jz	short loc_412B21

loc_412AC8:				; CODE XREF: sub_412530+5EFj
		mov	ecx, [esp+1B4h+var_18C]
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		mov	eax, [ecx]
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	eax, [esp+1B4h+rc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		add	edx, [esp+1BCh+hData]
		push	edx		; nWidth
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		mov	ecx, [esp+1B4h+var_18C]
		push	ecx
		push	esi
		call	sub_401120
		add	esp, 8
		mov	[esp+1B4h+var_18C], eax
		test	eax, eax
		jnz	short loc_412AC8

loc_412B21:				; CODE XREF: sub_412530+596j
		mov	eax, [esp+1B4h+var_178]
		mov	ecx, [esp+1B4h+var_16C]
		and	eax, 0FFFFh
		cmp	ecx, eax
		jz	loc_412C30
		mov	edx, [esp+1B4h+var_16C]
		mov	ecx, eax
		push	eax		; hData
		sub	ecx, edx
		push	offset aOldheight ; "oldHeight"
		push	esi		; hWnd
		mov	[esp+1C0h+hData], ecx
		call	ds:SetPropA
		push	0BBBh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	eax, [esp+1B4h+rc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		mov	edx, [esp+1C0h+hData]
		add	eax, edx
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		push	0BBCh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+rc]
		push	ecx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		mov	edx, [esp+1C0h+hData]
		add	eax, edx
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow
		push	437h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+rc]
		push	ecx		; lpRect
		push	eax		; hWnd
		mov	[esp+1BCh+var_190], eax
		call	edi ; GetWindowRect
		lea	edx, [esp+1B4h+rc]
		push	2		; cPoints
		push	edx		; lpPoints
		push	esi		; hWndTo
		push	0		; hWndFrom
		call	ebx ; MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.bottom]
		mov	eax, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		sub	ecx, eax
		push	ecx		; nHeight
		mov	ecx, [esp+1BCh+rc.left]
		sub	edx, ecx
		push	edx		; nWidth
		mov	edx, [esp+1C0h+hData]
		add	eax, edx
		push	eax		; Y
		mov	eax, [esp+1C4h+var_190]
		push	ecx		; X
		push	eax		; hWnd
		call	ebp ; MoveWindow

loc_412C30:				; CODE XREF: sub_412530+364j
					; sub_412530+600j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412C42:				; CODE XREF: sub_412530+57j
					; DATA XREF: .text:off_4137ACo
		mov	ebx, ds:GetClientRect ;	jumptable 00412587 case	15
		lea	ecx, [esp+1B4h+qrc]
		push	ecx		; lpRect
		push	esi		; hWnd
		call	ebx ; GetClientRect
		mov	edi, ds:GetParent
		lea	edx, [esp+1B4h+rc]
		push	edx		; lpRect
		push	esi		; hWnd
		call	edi ; GetParent
		push	eax		; hWnd
		call	ebx ; GetClientRect
		mov	eax, [esp+1B4h+qrc.right]
		mov	ecx, [esp+1B4h+rc.right]
		cmp	eax, ecx
		jz	loc_41379B	; jumptable 00412587 default case
		lea	ecx, [esp+1B4h+qrc]
		push	2		; cPoints
		push	ecx		; lpPoints
		push	esi		; hWnd
		call	edi ; GetParent
		push	eax		; hWndTo
		push	esi		; hWndFrom
		call	ds:MapWindowPoints
		mov	edi, [esp+1B4h+qrc.bottom]
		push	1		; bRepaint
		mov	edx, [esp+1B8h+rc.top]
		mov	eax, [esp+1B8h+rc.right]
		mov	ecx, [esp+1B8h+rc.left]
		mov	[esp+1B8h+qrc.right], eax
		sub	edi, edx
		sub	eax, ecx
		push	edi		; nHeight
		push	eax		; nWidth
		push	edx		; Y
		push	ecx		; X
		push	esi		; hWnd
		mov	[esp+1CCh+qrc.left], ecx
		mov	[esp+1CCh+qrc.top], edx
		call	ds:MoveWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412CBF:				; CODE XREF: sub_412530+3Dj
		mov	edx, [esp+1B4h+arg_8]
		push	offset asc_42F2E4 ; "\v"
		push	0Ah		; uCommand
		push	offset szHelp	; lpszHelp
		push	edx		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412CE8:				; CODE XREF: sub_412530+37j
		cmp	eax, 806Eh
		ja	loc_4136F6
		jz	loc_41369E
		sub	eax, 87h
		jz	loc_41368C
		sub	eax, 89h
		jz	loc_4133EC
		dec	eax
		jnz	loc_41379B	; jumptable 00412587 default case
		mov	ecx, [esp+1B4h+arg_8]
		mov	eax, ecx
		mov	edi, ecx
		and	eax, 0FFFFh
		shr	edi, 10h
		cmp	eax, 0BBAh
		jg	loc_41313A
		jz	loc_4130E0
		cmp	eax, 0BB8h
		jg	loc_41305A
		jz	loc_412E8A
		cmp	eax, 9
		jz	loc_412E5C
		cmp	eax, 421h
		jnz	loc_4133DA
		test	di, di
		jnz	loc_4133DA
		mov	edi, ds:GetDlgItem
		push	0BB8h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	421h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	edi, eax
		push	edi		; hWnd
		call	ds:IsWindowEnabled
		test	eax, eax
		jz	loc_4133DA
		push	offset aSearchinfo ; "SearchInfo"
		push	esi		; hWnd
		call	ebx ; GetPropA
		push	0		; bEnable
		push	edi		; hWnd
		mov	ebx, eax
		call	ds:EnableWindow
		test	ebx, ebx
		jz	loc_4133DA
		mov	eax, [ebx+2E8h]
		test	eax, eax
		jz	short loc_412DC5
		push	eax
		call	PGPCancelKeyServerCall
		push	eax
		push	esi
		call	ds:PGPclErrorBox
		add	esp, 0Ch

loc_412DC5:				; CODE XREF: sub_412530+882j
		mov	ecx, 12h
		xor	eax, eax
		lea	edi, [esp+1B4h+var_148]
		push	ebx
		rep stosd
		mov	eax, [esp+1B8h+var_174]
		lea	ecx, [esp+1B8h+var_148]
		mov	edx, 0FFFFD12Dh
		push	ecx
		push	0
		mov	[esp+1C0h+var_13C], 3
		mov	[esp+1C0h+var_138], edx
		mov	[esp+1C0h+var_134], eax
		call	sub_414060
		mov	ebx, [ebx]
		xor	edx, edx
		add	esp, 0Ch
		mov	[esp+1B4h+rc.left], edx
		lea	eax, [esp+1B4h+rc]
		mov	[esp+1B4h+rc.top], edx
		push	eax		; lParam
		mov	[esp+1B8h+rc.right], edx
		push	ebx		; wParam
		push	4Eh		; Msg
		mov	[esp+1C0h+rc.bottom], edx
		push	ebx		; hWnd
		mov	[esp+1C4h+rc.left], ebx
		mov	[esp+1C4h+rc.top], 835h
		mov	[esp+1C4h+rc.right], 8068h
		mov	[esp+1C4h+rc.bottom], 0FFFFD12Dh
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412E5C:				; CODE XREF: sub_412530+81Ej
		test	di, di
		jnz	loc_4133DA
		push	834h		; dwData
		push	1		; uCommand
		push	offset szHelp	; lpszHelp
		push	esi		; hWndMain
		call	ds:WinHelpA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_412E8A:				; CODE XREF: sub_412530+815j
		xor	eax, eax
		cmp	di, ax
		mov	[esp+1B4h+hData], eax
		mov	[esp+1B4h+var_18C], eax
		jnz	loc_4133DA
		push	421h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		lea	ecx, [esp+1B4h+var_18C]
		lea	edx, [esp+1B4h+hData]
		push	ecx		; hWnd
		push	edx		; int
		push	esi		; hDlg
		mov	[esp+1C0h+var_178], eax
		call	sub_411C60
		mov	ebp, [esp+1C0h+hData]
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	loc_412F51
		push	esi		; hWnd
		call	sub_401100
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_412F65

loc_412EE1:				; CODE XREF: sub_412530+A1Bj
		test	edi, edi
		jnz	short loc_412F51
		mov	edx, [ebx]
		lea	eax, [esp+1B4h+var_18C]
		lea	ecx, [esp+1B4h+hData]
		push	eax		; hWnd
		push	ecx		; int
		push	edx		; hDlg
		call	sub_411C60
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_412F3D
		mov	[esp+1B4h+var_190], eax
		mov	eax, [esp+1B4h+var_18C]
		cmp	eax, 1
		jnz	short loc_412F1F
		mov	ecx, [esp+1B4h+hData]
		lea	eax, [esp+1B4h+var_190]
		push	eax
		push	ebp
		push	ecx
		call	PGPUnionFilters
		jmp	short loc_412F34
; ---------------------------------------------------------------------------

loc_412F1F:				; CODE XREF: sub_412530+9DBj
		cmp	eax, 2
		jnz	short loc_412F39
		mov	eax, [esp+1B4h+hData]
		lea	edx, [esp+1B4h+var_190]
		push	edx
		push	ebp
		push	eax
		call	PGPIntersectFilters

loc_412F34:				; CODE XREF: sub_412530+9EDj
		add	esp, 0Ch
		mov	edi, eax

loc_412F39:				; CODE XREF: sub_412530+9F2j
		mov	ebp, [esp+1B4h+var_190]

loc_412F3D:				; CODE XREF: sub_412530+9CEj
		push	ebx
		push	esi
		call	sub_401120
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_412EE1
		test	edi, edi
		jz	short loc_412F65

loc_412F51:				; CODE XREF: sub_412530+998j
					; sub_412530+9B3j
		push	edi
		push	0
		call	ds:PGPclErrorBox
		add	esp, 8
		test	edi, edi
		jnz	loc_413005

loc_412F65:				; CODE XREF: sub_412530+9ABj
					; sub_412530+A1Fj
		push	offset aSearchinfo ; "SearchInfo"
		push	esi		; hWnd
		call	ds:GetPropA
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_4133DA
		mov	eax, [ebx+4]
		test	eax, eax
		jnz	loc_4133DA
		mov	ecx, 0BDh
		xor	eax, eax
		mov	edi, ebx
		push	ebx		; hData
		push	offset aSearchinfo ; "SearchInfo"
		push	esi		; hWnd
		rep stosd
		mov	[ebx], esi
		mov	[ebx+0Ch], ebp
		mov	[ebx+2ECh], eax
		mov	[ebx+2F0h], eax
		call	ds:SetPropA
		mov	esi, ds:EnableWindow
		push	1		; bEnable
		mov	edi, [esp+1B8h+var_178]
		push	edi		; hWnd
		call	esi ; EnableWindow
		push	5		; nCmdShow
		push	edi		; hWnd
		mov	edi, ds:ShowWindow
		call	edi ; ShowWindow
		push	0		; bEnable
		mov	ebp, [esp+1B8h+arg_C]
		push	ebp		; hWnd
		call	esi ; EnableWindow
		push	0		; nCmdShow
		push	ebp		; hWnd
		call	edi ; ShowWindow
		lea	ecx, [ebx+8]
		push	ecx		; lpThreadId
		push	0		; dwCreationFlags
		push	ebx		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	0		; dwStackSize
		push	0		; lpThreadAttributes
		call	ds:CreateThread
		pop	edi
		pop	esi
		mov	[ebx+4], eax
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_413005:				; CODE XREF: sub_412530+A2Fj
		mov	eax, [esp+1B4h+hData]
		test	eax, eax
		jz	short loc_413016
		push	eax
		call	PGPFreeFilter
		add	esp, 4

loc_413016:				; CODE XREF: sub_412530+ADBj
		lea	edx, [esp+1B4h+qrc]
		mov	[esp+1B4h+qrc.left], esi
		push	edx		; lParam
		push	esi		; wParam
		push	4Eh		; Msg
		push	esi		; hWnd
		mov	[esp+1C4h+qrc.top], 835h
		mov	[esp+1C4h+qrc.right], 8068h
		mov	[esp+1C4h+qrc.bottom], 0FFFFD12Dh
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41305A:				; CODE XREF: sub_412530+80Fj
		cmp	eax, 0BB9h
		jnz	loc_4133DA
		push	esi		; hWnd
		call	sub_4010D0
		add	esp, 4
		test	di, di
		jnz	loc_4133DA
		mov	ebx, ds:SendMessageA
		test	eax, eax
		jle	short loc_413095
		mov	edi, eax

loc_413083:				; CODE XREF: sub_412530+B63j
		push	0		; lParam
		push	0BBCh		; wParam
		push	111h		; Msg
		push	esi		; hWnd
		call	ebx ; SendMessageA
		dec	edi
		jnz	short loc_413083

loc_413095:				; CODE XREF: sub_412530+B4Fj
		mov	ebp, ds:GetDlgItem
		push	0BBDh		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	0		; lParam
		mov	edi, eax
		push	0		; wParam
		push	14Eh		; Msg
		push	edi		; hWnd
		call	ebx ; SendMessageA
		push	edi		; hWnd
		call	sub_4119D0
		add	esp, 4
		push	0BC4h		; nIDDlgItem
		push	esi		; hDlg
		call	ebp ; GetDlgItem
		push	offset byte_430394 ; lpString
		push	eax		; hWnd
		call	ds:SetWindowTextA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_4130E0:				; CODE XREF: sub_412530+804j
		cmp	di, 7
		jnz	short loc_41310B
		mov	ecx, [esp+1B4h+arg_C]
		lea	eax, [esp+1B4h+Rect]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:GetWindowRect
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41310B:				; CODE XREF: sub_412530+BB4j
		cmp	di, 1
		jnz	loc_4133DA
		mov	eax, [esp+1B4h+arg_C]
		lea	edx, [esp+1B4h+Rect]
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:GetWindowRect
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41313A:				; CODE XREF: sub_412530+7FEj
		sub	eax, 0BBBh
		jz	loc_413268
		dec	eax
		jz	short loc_413178
		dec	eax
		jnz	loc_4133DA
		mov	edx, [esp+1B4h+arg_C]
		push	edx		; hWnd
		push	ecx		; int
		push	111h		; int
		push	esi		; int
		call	sub_4114A0
		add	esp, 10h
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_413178:				; CODE XREF: sub_412530+C16j
		test	di, di
		jnz	loc_4133DA
		lea	eax, [esp+1B4h+var_16C]
		push	eax		; int
		push	esi		; hWnd
		call	sub_401090
		mov	ebx, ds:GetClientRect
		add	esp, 8
		lea	ecx, [esp+1B4h+rc]
		mov	edi, eax
		push	ecx		; lpRect
		push	esi		; hWnd
		call	ebx ; GetClientRect
		lea	edx, [esp+1B4h+qrc]
		mov	eax, [esp+1B4h+var_16C]
		push	edx		; lpRect
		push	eax		; hWnd
		call	ebx ; GetClientRect
		mov	ebp, ds:GetParent
		lea	eax, [esp+1B4h+rc]
		mov	ecx, [esp+1B4h+qrc.top]
		mov	ebx, [esp+1B4h+qrc.bottom]
		mov	edx, [esp+1B4h+rc.top]
		sub	ecx, ebx
		sub	ecx, edx
		mov	edx, [esp+1B4h+rc.bottom]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWnd
		lea	ebx, [ecx+edx-1]
		call	ebp ; GetParent
		push	eax		; hWndTo
		push	esi		; hWndFrom
		call	ds:MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+rc.top]
		mov	edx, [esp+1B8h+rc.right]
		lea	eax, [ecx+ebx]
		mov	[esp+1B8h+rc.bottom], eax
		sub	eax, ecx
		push	eax		; nHeight
		mov	eax, [esp+1BCh+rc.left]
		sub	edx, eax
		push	edx		; nWidth
		push	ecx		; Y
		push	eax		; X
		push	esi		; hWnd
		call	ds:MoveWindow
		test	edi, edi
		jnz	short loc_413217
		push	edi		; bEnable
		push	0BBCh		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow

loc_413217:				; CODE XREF: sub_412530+CD1j
		mov	eax, [esp+1B4h+var_16C]
		push	eax		; hWnd
		call	ds:DestroyWindow
		xor	ecx, ecx
		lea	edx, [esp+1B4h+var_178]
		mov	[esp+1B4h+var_178], ecx
		push	edx		; lParam
		mov	[esp+1B8h+var_174], ecx
		push	esi		; wParam
		push	4Eh		; Msg
		mov	[esp+1C0h+var_170], ecx
		push	esi		; hWnd
		mov	[esp+1C4h+var_178], esi
		mov	[esp+1C4h+var_174], 835h
		mov	[esp+1C4h+var_170], 8065h
		call	ebp ; GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_413268:				; CODE XREF: sub_412530+C0Fj
		test	di, di
		jnz	loc_4133DA
		push	esi		; hWnd
		call	sub_401000
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_4133DA
		mov	edi, ds:GetClientRect
		lea	eax, [esp+1B4h+qrc]
		push	eax		; lpRect
		push	esi		; hWnd
		call	edi ; GetClientRect
		mov	edx, [ebp+0]
		lea	ecx, [esp+1B4h+var_168]
		push	ecx		; lpRect
		push	edx		; hWnd
		call	edi ; GetClientRect
		mov	ebx, ds:GetParent
		lea	ecx, [esp+1B4h+rc]
		mov	edi, [esp+1B4h+var_168.bottom]
		mov	eax, [esp+1B4h+var_168.top]
		sub	edi, eax
		xor	eax, eax
		mov	[esp+1B4h+rc.left], eax
		push	ecx		; lParam
		mov	[esp+1B8h+rc.top], eax
		push	esi		; wParam
		mov	[esp+1BCh+rc.right], eax
		inc	edi
		push	4Eh		; Msg
		mov	[esp+1C0h+rc.bottom], eax
		push	esi		; hWnd
		mov	[esp+1C4h+rc.left], esi
		mov	[esp+1C4h+rc.top], 835h
		mov	[esp+1C4h+rc.right], 8066h
		mov	[esp+1C4h+rc.bottom], edi
		call	ebx ; GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		test	eax, eax
		jz	loc_4133C1
		mov	edx, [esp+1B4h+qrc.bottom]
		mov	ecx, [esp+1B4h+qrc.top]
		lea	eax, [esp+1B4h+qrc]
		push	2		; cPoints
		sub	edx, ecx
		push	eax		; lpPoints
		push	esi		; hWnd
		add	edi, edx
		call	ebx ; GetParent
		push	eax		; hWndTo
		push	esi		; hWndFrom
		call	ds:MapWindowPoints
		push	1		; bRepaint
		mov	ecx, [esp+1B8h+qrc.top]
		mov	edx, [esp+1B8h+qrc.right]
		lea	eax, [ecx+edi]
		mov	[esp+1B8h+qrc.bottom], eax
		sub	eax, ecx
		push	eax		; nHeight
		mov	eax, [esp+1BCh+qrc.left]
		sub	edx, eax
		push	edx		; nWidth
		push	ecx		; Y
		push	eax		; X
		push	esi		; hWnd
		call	ds:MoveWindow
		mov	eax, [ebp+0]
		push	5		; nCmdShow
		push	eax		; hWnd
		call	ds:ShowWindow
		mov	edi, ds:GetDlgItem
		push	1		; bEnable
		push	0BBCh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	eax		; hWnd
		call	ds:EnableWindow
		xor	ecx, ecx
		lea	edx, [esp+1B4h+var_178]
		mov	[esp+1B4h+var_178], ecx
		push	edx		; lParam
		mov	[esp+1B8h+var_174], ecx
		push	esi		; wParam
		push	4Eh		; Msg
		mov	[esp+1C0h+var_170], ecx
		push	esi		; hWnd
		mov	[esp+1C4h+var_178], esi
		mov	[esp+1C4h+var_174], 835h
		mov	[esp+1C4h+var_170], 8065h
		call	ebx ; GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		push	0BBBh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebx, ds:InvalidateRect
		push	0		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ebx ; InvalidateRect
		push	0BBCh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		push	0		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ebx ; InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_4133C1:				; CODE XREF: sub_412530+DBCj
		lea	eax, [esp+1B4h+var_178]
		push	eax		; int
		push	esi		; hWnd
		call	sub_401090
		mov	ecx, [esp+1BCh+var_178]
		add	esp, 8
		push	ecx		; hWnd
		call	ds:DestroyWindow

loc_4133DA:				; CODE XREF: sub_412530+829j
					; sub_412530+832j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_4133EC:				; CODE XREF: sub_412530+7D9j
		mov	edi, ds:GetDlgItem
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebx, eax
		push	0BB8h		; nIDDlgItem
		push	esi		; hDlg
		mov	[esp+1BCh+var_16C], ebx
		call	edi ; GetDlgItem
		push	437h		; nIDDlgItem
		push	esi		; hDlg
		mov	[esp+1BCh+var_178], eax
		call	edi ; GetDlgItem
		lea	edx, [esp+1B4h+qrc]
		push	edx		; lpRect
		push	ebx		; hWnd
		call	ds:GetClientRect
		lea	eax, [esp+1B4h+qrc]
		push	2		; cPoints
		push	eax		; lpPoints
		push	esi		; hWndTo
		push	ebx		; hWndFrom
		call	ds:MapWindowPoints
		mov	ecx, hModule
		push	0		; lpParam
		mov	edx, [esp+1B8h+qrc.bottom]
		mov	eax, [esp+1B8h+qrc.top]
		sub	edx, eax
		push	ecx		; hInstance
		mov	ecx, [esp+1BCh+qrc.left]
		push	0		; hMenu
		add	edx, 2
		push	esi		; hWndParent
		push	edx		; nHeight
		mov	edx, [esp+1C8h+qrc.right]
		sub	edx, ecx
		dec	eax
		push	edx		; nWidth
		push	eax		; Y
		push	ecx		; X
		push	50810000h	; dwStyle
		push	offset aDatetime ; "DateTime"
		push	offset aSysdatetimepic ; "SysDateTimePick32"
		push	0		; dwExStyle
		call	ds:CreateWindowExA
		push	3		; uFlags
		push	0		; cy
		push	0		; cx
		push	0		; Y
		push	0		; X
		push	0BBEh		; nIDDlgItem
		push	esi		; hDlg
		mov	ebp, eax
		call	edi ; GetDlgItem
		push	eax		; hWndInsertAfter
		push	ebp		; hWnd
		call	ds:SetWindowPos
		push	0Fh		; nIndex
		call	ds:GetSysColor
		push	eax		; lParam
		push	4		; wParam
		push	1006h		; Msg
		push	ebp		; hWnd
		call	ds:SendMessageA
		push	0		; nCmdShow
		push	ebp		; hWnd
		call	ds:ShowWindow
		mov	ebx, ds:SetPropA
		push	ebp		; hData
		push	offset aHwndtime ; "hwndTime"
		push	esi		; hWnd
		call	ebx ; SetPropA
		lea	eax, [esp+1B4h+rc]
		push	eax		; lpRect
		push	esi		; hWnd
		call	ds:GetWindowRect
		lea	ecx, [esp+1B4h+var_168]
		mov	edx, [esp+1B4h+var_178]
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:GetWindowRect
		mov	ecx, [esp+1B4h+var_16C]
		lea	eax, [esp+1B4h+Rect]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:GetWindowRect
		mov	eax, [esp+1B4h+rc.right]
		mov	ecx, [esp+1B4h+var_168.right]
		mov	edx, eax
		sub	edx, ecx
		mov	ecx, [esp+1B4h+var_168.left]
		mov	dword_43043C, edx
		mov	edx, [esp+1B4h+Rect.right]
		sub	ecx, edx
		mov	edx, [esp+1B4h+rc.left]
		sub	eax, edx
		mov	dword_430440, ecx
		push	eax		; hData
		push	offset aOldwidth ; "oldWidth"
		push	esi		; hWnd
		mov	[esp+1C0h+var_178], eax
		call	ebx ; SetPropA
		mov	edx, [esp+1B4h+rc.bottom]
		mov	ecx, [esp+1B4h+rc.top]
		sub	edx, ecx
		push	edx		; hData
		push	offset aOldheight ; "oldHeight"
		push	esi		; hWnd
		call	ebx ; SetPropA
		push	0		; hData
		push	offset aChoicelist ; "ChoiceList"
		mov	eax, [esp+1BCh+var_178]
		push	esi		; hWnd
		mov	dword_430444, eax
		call	ebx ; SetPropA
		push	18h		; size_t
		call	_malloc
		add	esp, 4
		mov	[esp+1B4h+hData], eax
		test	eax, eax
		jz	short loc_413568
		mov	ecx, eax
		push	ecx		; lpCriticalSection
		call	ds:InitializeCriticalSection
		mov	edx, [esp+1B4h+hData]
		push	edx		; hData
		push	offset aKeyserverlock ;	"KeyserverLock"
		push	esi		; hWnd
		call	ebx ; SetPropA

loc_413568:				; CODE XREF: sub_412530+1020j
		mov	eax, [esp+1B4h+hData]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	0		; WPARAM
		push	esi		; hDlg
		call	sub_411790
		mov	ecx, [esp+1BCh+hData]
		add	esp, 8
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	2F4h		; size_t
		call	_malloc
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jz	short loc_4135B6
		mov	ecx, 0BDh
		xor	eax, eax
		mov	edi, edx
		push	edx		; hData
		push	offset aSearchinfo ; "SearchInfo"
		push	esi		; hWnd
		rep stosd
		call	ebx ; SetPropA
		mov	edi, ds:GetDlgItem

loc_4135B6:				; CODE XREF: sub_412530+106Aj
		push	esi		; hData
		push	offset aHwnd	; "hwnd"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:SetWindowLongA
		push	0BBFh		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, eax
		push	esi		; hData
		push	offset aHwnd	; "hwnd"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:SetWindowLongA
		push	0BC5h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	ebp, eax
		push	esi		; hData
		push	offset aHwnd	; "hwnd"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	ebp		; hWnd
		call	ebx ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	ebp		; hWnd
		mov	ebp, ds:SetWindowLongA
		call	ebp ; SetWindowLongA
		push	0BC4h		; nIDDlgItem
		push	esi		; hDlg
		call	edi ; GetDlgItem
		mov	edi, eax
		push	esi		; hData
		push	offset aHwnd	; "hwnd"
		push	edi		; hWnd
		call	ebx ; SetPropA
		push	0FFFFFFFCh	; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		push	eax		; hData
		push	offset aOldproc	; "oldproc"
		push	edi		; hWnd
		call	ebx ; SetPropA
		push	offset sub_401130 ; dwNewLong
		push	0FFFFFFFCh	; nIndex
		push	edi		; hWnd
		call	ebp ; SetWindowLongA
		push	edi		; hWnd
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41368C:				; CODE XREF: sub_412530+7CEj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 4
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_41369E:				; CODE XREF: sub_412530+7C3j
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	ebx, eax
		mov	ecx, 3Fh
		xor	eax, eax
		lea	edi, [esp+1B4h+lParam+1]
		mov	byte ptr [esp+1B4h+lParam], 0
		push	0BBAh		; nIDDlgItem
		rep stosd
		stosw
		push	esi		; hDlg
		stosb
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+lParam]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	7EEh		; uID
		push	ebx		; hInstance
		mov	esi, eax
		call	ds:LoadStringA
		lea	eax, [esp+1B4h+lParam]
		jmp	loc_413779
; ---------------------------------------------------------------------------

loc_4136F6:				; CODE XREF: sub_412530+7BDj
		sub	eax, 806Fh
		jz	short loc_413726
		dec	eax
		jnz	loc_41379B	; jumptable 00412587 default case
		push	0BB8h		; nIDDlgItem
		push	esi		; hDlg
		call	ds:GetDlgItem
		push	eax		; hWnd
		call	ds:SetFocus
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
; ---------------------------------------------------------------------------

loc_413726:				; CODE XREF: sub_412530+11CBj
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	ebx, eax
		mov	ecx, 3Fh
		xor	eax, eax
		lea	edi, [esp+1B4h+lParam+1]
		mov	byte ptr [esp+1B4h+lParam], 0
		push	0BBAh		; nIDDlgItem
		rep stosd
		stosw
		push	esi		; hDlg
		stosb
		call	ds:GetDlgItem
		lea	edx, [esp+1B4h+lParam]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	7EFh		; uID
		push	ebx		; hInstance
		mov	esi, eax
		call	ds:LoadStringA
		lea	eax, [esp+1B4h+lParam]

loc_413779:				; CODE XREF: sub_412530+11C1j
		mov	edi, ds:SendMessageA
		push	eax		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA
		mov	ecx, [esp+1B4h+arg_C]
		push	ecx		; lParam
		push	eax		; wParam
		push	151h		; Msg
		push	esi		; hWnd
		call	edi ; SendMessageA

loc_41379B:				; CODE XREF: sub_412530+49j
					; sub_412530+57j ...
		pop	edi		; jumptable 00412587 default case
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1A4h
		retn	10h
sub_412530	endp

; ---------------------------------------------------------------------------
		align 4
off_4137AC	dd offset loc_41258E, offset loc_412859, offset	loc_412C42
					; DATA XREF: sub_412530+57r
		dd offset loc_41269D, offset loc_41267A, offset	loc_412815 ; jump table	for switch statement
		dd offset loc_41379B
byte_4137C8	db	0,     6,     6,     1 ; DATA XREF: sub_412530+51r
		db	6,     6,     6,     6 ; indirect table	for switch statement
		db	6,     6,     6,     6
		db	6,     2,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     3,     4,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	5
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_413820(HWND hWnd, int, int, int, int)
sub_413820	proc near		; CODE XREF: StartAddress+6Fp

var_544		= dword	ptr -544h
hInstance	= dword	ptr -540h
var_53C		= dword	ptr -53Ch
var_538		= dword	ptr -538h
var_534		= dword	ptr -534h
lpCriticalSection= dword ptr -530h
var_52C		= dword	ptr -52Ch
wParam		= dword	ptr -528h
var_524		= dword	ptr -524h
var_520		= dword	ptr -520h
var_51C		= dword	ptr -51Ch
var_518		= dword	ptr -518h
Buffer		= byte ptr -514h
var_513		= byte ptr -513h
lParam		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= byte ptr -408h
var_308		= dword	ptr -308h
var_304		= dword	ptr -304h
var_300		= byte ptr -300h
var_200		= byte ptr -200h
var_1FF		= byte ptr -1FFh
hWnd		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 544h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		mov	esi, eax
		xor	ebx, ebx
		mov	ecx, 3Fh
		xor	eax, eax
		lea	edi, [esp+554h+var_513]
		mov	[esp+554h+Buffer], bl
		rep stosd
		mov	ebp, [esp+554h+hWnd]
		push	offset aKeyserverlock ;	"KeyserverLock"
		stosw
		push	ebp		; hWnd
		mov	[esp+55Ch+hInstance], esi
		stosb
		call	ds:GetParent
		mov	edi, ds:GetPropA
		push	eax		; hWnd
		call	edi ; GetPropA
		mov	[esp+554h+lpCriticalSection], eax
		call	PGPKeyServerInit
		lea	eax, [esp+554h+var_518]
		push	eax
		call	PGPKeyServerCreateThreadStorage
		mov	ecx, [esp+558h+lpCriticalSection]
		add	esp, 4
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	offset aLastsearchtype ; "LastSearchType"
		push	ebp		; hWnd
		call	edi ; GetPropA
		mov	edi, ds:LoadStringA
		lea	edx, [esp+554h+Buffer]
		push	100h		; cchBufferMax
		push	edx		; lpBuffer
		push	7F0h		; uID
		push	esi		; hInstance
		mov	[esp+564h+var_520], eax
		call	edi ; LoadStringA
		mov	esi, ds:SendMessageA
		lea	eax, [esp+554h+Buffer]
		push	eax		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		mov	edx, [esp+554h+hInstance]
		lea	ecx, [esp+554h+Buffer]
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		push	7EEh		; uID
		push	edx		; hInstance
		mov	[esp+564h+var_52C], eax
		call	edi ; LoadStringA
		lea	eax, [esp+554h+Buffer]
		push	eax		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		mov	edx, [esp+554h+hInstance]
		lea	ecx, [esp+554h+Buffer]
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		push	7EFh		; uID
		push	edx		; hInstance
		mov	[esp+564h+wParam], eax
		call	edi ; LoadStringA
		lea	eax, [esp+554h+Buffer]
		push	eax		; lParam
		push	0FFFFFFFFh	; wParam
		push	14Ch		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	ebx		; lParam
		mov	[esp+558h+var_524], eax
		push	ebx		; wParam
		push	147h		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	ebx		; lParam
		push	eax		; wParam
		push	150h		; Msg
		push	ebp		; hWnd
		mov	[esp+564h+hInstance], eax
		call	esi ; SendMessageA
		mov	ecx, [esp+554h+wParam]
		push	ebx		; lParam
		push	ecx		; wParam
		mov	edi, eax
		push	150h		; Msg
		push	ebp		; hWnd
		mov	[esp+564h+var_538], edi
		call	esi ; SendMessageA
		mov	edx, [esp+554h+arg_4]
		mov	[edx+2E4h], eax
		mov	eax, [esp+554h+lpCriticalSection]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	eax, eax
		cmp	edi, eax
		jnz	short loc_413972
		mov	ecx, [esp+554h+arg_10]
		mov	[ecx], eax
		jmp	loc_413ED5
; ---------------------------------------------------------------------------

loc_413972:				; CODE XREF: sub_413820+142j
		mov	ecx, [esp+554h+hInstance]
		mov	edx, [esp+554h+var_52C]
		cmp	ecx, edx
		jnz	loc_413CCB
		mov	[esp+554h+var_534], eax
		mov	[esp+554h+var_53C], eax
		mov	[esp+554h+var_52C], eax
		mov	[esp+554h+hInstance], eax
		mov	[esp+554h+var_51C], eax
		mov	ecx, 7Fh
		xor	eax, eax
		lea	edi, [esp+554h+var_1FF]
		mov	[esp+554h+var_200], 0
		mov	edx, [esp+554h+arg_C]
		rep stosd
		stosw
		push	2		; hData
		push	offset aLastsearchtype ; "LastSearchType"
		push	ebp		; hWnd
		mov	dword ptr [edx], 2
		stosb
		call	ds:SetPropA
		lea	eax, [esp+554h+var_51C]
		lea	ecx, [esp+554h+hInstance]
		push	eax		; int
		push	ecx		; hWnd
		push	ebp		; hWnd
		call	ds:GetParent
		push	eax		; hDlg
		call	sub_414540
		mov	eax, [esp+560h+hInstance]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_4139FF
		lea	edx, [esp+554h+var_200]
		push	edx
		push	eax
		call	PGPFindEmailDomain
		add	esp, 8

loc_4139FF:				; CODE XREF: sub_413820+1CCj
		mov	ecx, dword_430850
		lea	eax, [esp+554h+wParam]
		push	eax
		push	ecx
		call	PGPGetContextMemoryMgr
		add	esp, 4
		push	eax
		call	ds:PGPclOpenClientPrefs
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	loc_413CB1
		lea	edx, [esp+554h+var_52C]
		lea	eax, [esp+554h+var_53C]
		push	edx
		mov	edx, [esp+558h+wParam]
		lea	ecx, [esp+558h+var_200]
		push	eax
		push	ecx
		push	edx
		call	PGPCreateKeyServerPath
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	loc_413CA1
		mov	[esp+554h+var_538], eax
		mov	eax, [esp+554h+var_52C]
		test	eax, eax
		jbe	loc_413C94
		mov	eax, [esp+554h+arg_8]
		mov	[esp+554h+var_544], ebx
		neg	eax
		sbb	eax, eax
		and	eax, 2
		inc	eax
		mov	[esp+554h+var_520], eax
		jmp	short loc_413A7D
; ---------------------------------------------------------------------------

loc_413A79:				; CODE XREF: sub_413820+43Fj
		mov	ebx, [esp+554h+var_544]

loc_413A7D:				; CODE XREF: sub_413820+257j
		mov	ecx, 45h
		xor	eax, eax
		lea	edi, [esp+554h+lParam]
		push	ebp		; hWnd
		rep stosd
		mov	edi, ds:GetParent
		call	edi ; GetParent
		mov	ecx, hModule
		mov	[esp+554h+lParam], eax
		or	eax, 0FFFFFFFFh
		push	100h		; cchBufferMax
		mov	[esp+558h+var_308], eax
		mov	[esp+558h+var_304], eax
		lea	eax, [esp+558h+var_300]
		mov	[esp+558h+var_410], 835h
		push	eax		; lpBuffer
		push	81Fh		; uID
		push	ecx		; hInstance
		mov	[esp+564h+var_40C], 8067h
		call	ds:LoadStringA
		mov	edx, [esp+554h+var_53C]
		lea	ecx, [esp+554h+var_300]
		lea	eax, [ebx+edx+108h]
		lea	edx, [esp+554h+var_408]
		push	eax
		push	ecx		; LPCSTR
		push	edx		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		lea	eax, [esp+554h+lParam]
		push	eax		; lParam
		push	ebp		; hWnd
		call	edi ; GetParent
		push	eax		; wParam
		push	4Eh		; Msg
		push	ebp		; hWnd
		call	edi ; GetParent
		push	eax		; hWnd
		call	edi ; GetParent
		push	eax		; hWnd
		call	esi ; SendMessageA
		mov	ecx, [esp+554h+arg_4]
		mov	eax, [esp+554h+var_53C]
		mov	edx, [esp+554h+var_520]
		add	ecx, 2E8h
		push	ecx
		mov	ecx, [ebx+eax+4]
		push	edx
		mov	dx, [ebx+eax+208h]
		push	2
		push	ecx
		mov	ecx, dword_430850
		lea	eax, [ebx+eax+108h]
		push	edx
		push	eax
		push	ecx
		call	PGPNewKeyServerFromHostName
		mov	ebx, eax
		add	esp, 1Ch
		test	ebx, ebx
		jnz	loc_413C42
		mov	edx, [esp+554h+var_53C]
		mov	eax, [esp+554h+var_544]
		mov	ecx, 0B5h
		lea	esi, [eax+edx]
		mov	eax, [esp+554h+arg_4]
		push	eax
		push	offset sub_414060
		lea	edi, [eax+10h]
		rep movsd
		mov	ecx, [eax+2E8h]
		lea	esi, [eax+2E8h]
		push	ecx
		call	PGPSetKeyServerEventHandler
		mov	ebx, eax
		xor	edi, edi
		add	esp, 0Ch
		cmp	ebx, edi
		jnz	short loc_413C16
		mov	edx, [esp+554h+var_53C]
		mov	eax, [esp+554h+var_544]
		mov	eax, [eax+edx+4]
		cmp	eax, 3
		jz	short loc_413BBC
		cmp	eax, 4
		jnz	short loc_413BD8

loc_413BBC:				; CODE XREF: sub_413820+395j
		mov	edx, dword_4303B8
		lea	ecx, [esp+554h+var_534]
		push	ecx
		push	edx
		call	PGPNewTLSSession
		add	esp, 8
		test	eax, eax
		jz	short loc_413BD8
		mov	[esp+554h+var_534], edi

loc_413BD8:				; CODE XREF: sub_413820+39Aj
					; sub_413820+3B2j
		mov	eax, [esp+554h+var_534]
		mov	ecx, [esi]
		push	eax
		push	ecx
		call	PGPKeyServerOpen
		mov	ebx, eax
		add	esp, 8
		cmp	ebx, edi
		jnz	short loc_413C16
		mov	eax, [esp+554h+arg_4]
		mov	edx, [esp+554h+arg_10]
		push	edx
		mov	edx, [esi]
		mov	ecx, [eax+0Ch]
		push	ecx
		push	edx
		call	PGPQueryKeyServer
		mov	ebx, eax
		mov	eax, [esi]
		push	eax
		call	PGPKeyServerClose
		add	esp, 10h

loc_413C16:				; CODE XREF: sub_413820+384j
					; sub_413820+3CCj
		mov	ecx, [esi]
		push	ecx
		call	PGPFreeKeyServer
		mov	eax, [esp+558h+var_534]
		add	esp, 4
		cmp	eax, edi
		mov	[esi], edi
		jz	short loc_413C38
		push	eax
		call	PGPFreeTLSSession
		add	esp, 4
		mov	[esp+554h+var_534], edi

loc_413C38:				; CODE XREF: sub_413820+409j
		cmp	ebx, edi
		jz	short loc_413C67
		mov	esi, ds:SendMessageA

loc_413C42:				; CODE XREF: sub_413820+341j
		mov	eax, [esp+554h+var_538]
		mov	edx, [esp+554h+var_544]
		mov	ecx, [esp+554h+var_52C]
		inc	eax
		add	edx, 2D4h
		cmp	eax, ecx
		mov	[esp+554h+var_538], eax
		mov	[esp+554h+var_544], edx
		jb	loc_413A79
		jmp	short loc_413C94
; ---------------------------------------------------------------------------

loc_413C67:				; CODE XREF: sub_413820+41Aj
		mov	esi, [esp+554h+lpCriticalSection]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [esp+554h+arg_10]
		mov	ecx, [esp+554h+var_524]
		mov	eax, [edx]
		push	eax		; lParam
		push	ecx		; wParam
		push	151h		; Msg
		push	ebp		; hWnd
		call	ds:SendMessageA
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_413C94:				; CODE XREF: sub_413820+23Aj
					; sub_413820+445j
		mov	edx, [esp+554h+var_53C]
		push	edx
		call	PGPDisposeKeyServerPath
		add	esp, 4

loc_413CA1:				; CODE XREF: sub_413820+22Aj
		mov	eax, [esp+554h+wParam]
		push	0
		push	eax
		call	ds:PGPclCloseClientPrefs
		add	esp, 8

loc_413CB1:				; CODE XREF: sub_413820+201j
		mov	eax, [esp+554h+hInstance]
		test	eax, eax
		jz	loc_413ED5
		push	eax		; void *
		call	_free
		add	esp, 4
		jmp	loc_413ED5
; ---------------------------------------------------------------------------

loc_413CCB:				; CODE XREF: sub_413820+15Cj
		cmp	ecx, [esp+554h+wParam]
		jz	loc_413E4D
		cmp	ecx, [esp+554h+var_524]
		jz	loc_413E53
		mov	ecx, [esp+554h+arg_C]
		push	2		; hData
		push	offset aLastsearchtype ; "LastSearchType"
		push	ebp		; hWnd
		mov	[esp+560h+var_544], eax
		mov	dword ptr [ecx], 2
		call	ds:SetPropA
		mov	edx, [esp+554h+arg_8]
		mov	esi, [esp+554h+arg_4]
		neg	edx
		mov	cx, [edi+208h]
		lea	eax, [esi+2E8h]
		sbb	edx, edx
		push	eax
		mov	eax, [edi+4]
		and	edx, 2
		inc	edx
		add	edi, 108h
		push	edx
		mov	edx, dword_430850
		push	2
		push	eax
		push	ecx
		push	edi
		push	edx
		call	PGPNewKeyServerFromHostName
		mov	ebx, eax
		lea	edi, [esi+10h]
		mov	esi, [esp+570h+var_538]
		add	esp, 1Ch
		mov	ecx, 0B5h
		test	ebx, ebx
		rep movsd
		jnz	loc_413ED5
		mov	edi, [esp+554h+arg_4]
		push	edi
		push	offset sub_414060
		mov	eax, [edi+2E8h]
		lea	esi, [edi+2E8h]
		push	eax
		call	PGPSetKeyServerEventHandler
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_413DE7
		mov	ecx, [esp+554h+var_538]
		mov	eax, [ecx+4]
		cmp	eax, 3
		jz	short loc_413D91
		cmp	eax, 4
		jnz	short loc_413DB0

loc_413D91:				; CODE XREF: sub_413820+56Aj
		mov	eax, dword_4303B8
		lea	edx, [esp+554h+var_544]
		push	edx
		push	eax
		call	PGPNewTLSSession
		add	esp, 8
		test	eax, eax
		jz	short loc_413DB0
		mov	[esp+554h+var_544], 0

loc_413DB0:				; CODE XREF: sub_413820+56Fj
					; sub_413820+586j
		mov	ecx, [esp+554h+var_544]
		mov	edx, [esi]
		push	ecx
		push	edx
		call	PGPKeyServerOpen
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_413DE7
		mov	eax, [esp+554h+arg_10]
		mov	ecx, [edi+0Ch]
		mov	edx, [esi]
		push	eax
		push	ecx
		push	edx
		call	PGPQueryKeyServer
		mov	ebx, eax
		mov	eax, [esi]
		push	eax
		call	PGPKeyServerClose
		add	esp, 10h

loc_413DE7:				; CODE XREF: sub_413820+55Ej
					; sub_413820+5A4j
		mov	ecx, [esi]
		push	ecx
		call	PGPFreeKeyServer
		mov	eax, [esp+558h+var_544]
		add	esp, 4
		test	eax, eax
		mov	dword ptr [esi], 0
		jz	short loc_413E11
		push	eax
		call	PGPFreeTLSSession
		add	esp, 4
		mov	[esp+554h+var_544], 0

loc_413E11:				; CODE XREF: sub_413820+5DEj
		test	ebx, ebx
		jz	short loc_413E21
		cmp	ebx, 0FFFFD3ECh
		jnz	loc_413ED5

loc_413E21:				; CODE XREF: sub_413820+5F3j
		mov	esi, [esp+554h+lpCriticalSection]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [esp+554h+arg_10]
		mov	ecx, [esp+554h+var_524]
		mov	eax, [edx]
		push	eax		; lParam
		push	ecx		; wParam
		push	151h		; Msg
		push	ebp		; hWnd
		call	ds:SendMessageA
		push	esi
		jmp	loc_413ECF
; ---------------------------------------------------------------------------

loc_413E4D:				; CODE XREF: sub_413820+4AFj
		cmp	ecx, [esp+554h+var_524]
		jnz	short loc_413E62

loc_413E53:				; CODE XREF: sub_413820+4B9j
		mov	edx, [esp+554h+arg_C]
		mov	eax, [esp+554h+var_520]
		mov	[edx], eax
		jmp	short loc_413E7D
; ---------------------------------------------------------------------------

loc_413E62:				; CODE XREF: sub_413820+631j
		mov	ecx, [esp+554h+arg_C]
		push	1		; hData
		push	offset aLastsearchtype ; "LastSearchType"
		push	ebp		; hWnd
		mov	dword ptr [ecx], 1
		call	ds:SetPropA

loc_413E7D:				; CODE XREF: sub_413820+640j
		mov	eax, [esp+554h+arg_4]
		mov	edx, [esp+554h+arg_10]
		push	edx
		mov	ecx, [eax+0Ch]
		push	ecx
		push	edi
		call	PGPFilterKeySet
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_413EAC
		mov	edx, [esp+554h+arg_10]
		mov	dword ptr [edx], 0

loc_413EAC:				; CODE XREF: sub_413820+67Dj
		mov	edi, [esp+554h+lpCriticalSection]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+554h+arg_10]
		mov	edx, [esp+554h+var_524]
		mov	ecx, [eax]
		push	ecx		; lParam
		push	edx		; wParam
		push	151h		; Msg
		push	ebp		; hWnd
		call	esi ; SendMessageA
		push	edi		; lpCriticalSection

loc_413ECF:				; CODE XREF: sub_413820+628j
		call	ds:LeaveCriticalSection

loc_413ED5:				; CODE XREF: sub_413820+14Dj
					; sub_413820+497j ...
		mov	eax, [esp+554h+var_518]
		push	eax
		call	PGPKeyServerDisposeThreadStorage
		add	esp, 4
		call	PGPKeyServerCleanup
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 544h
		retn
sub_413820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: sub_412530+AB1o

var_300		= dword	ptr -300h
var_2FC		= dword	ptr -2FCh
var_2F8		= dword	ptr -2F8h
var_2F4		= dword	ptr -2F4h
hWnd		= dword	ptr -2F0h
lParam		= dword	ptr -2ECh
var_2E8		= dword	ptr -2E8h
var_2E4		= dword	ptr -2E4h
var_2E0		= dword	ptr -2E0h
var_2DC		= byte ptr -2DCh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpThreadParameter= dword ptr  4

		sub	esp, 300h
		push	ebx
		push	ebp
		mov	ebp, [esp+308h+lpThreadParameter]
		push	esi
		mov	esi, ds:GetDlgItem
		push	edi
		mov	ebx, [ebp+0]
		xor	eax, eax
		push	0BBAh		; nIDDlgItem
		push	ebx		; hDlg
		mov	[esp+318h+var_300], eax
		mov	[esp+318h+var_2FC], eax
		call	esi ; GetDlgItem
		push	0BB8h		; nIDDlgItem
		push	ebx		; hDlg
		mov	edi, eax
		call	esi ; GetDlgItem
		push	421h		; nIDDlgItem
		push	ebx		; hDlg
		mov	[esp+318h+var_2F4], eax
		call	esi ; GetDlgItem
		push	437h		; nIDDlgItem
		push	ebx		; hDlg
		mov	[esp+318h+hWnd], eax
		call	esi ; GetDlgItem
		push	0		; lParam
		push	0		; wParam
		push	0F0h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		lea	ecx, [esp+310h+var_300]
		lea	edx, [esp+310h+var_2FC]
		push	ecx		; int
		push	edx		; int
		push	eax		; int
		push	ebp		; int
		push	edi		; hWnd
		mov	[esp+324h+var_2F8], eax
		call	sub_413820
		mov	edx, eax
		xor	eax, eax
		add	esp, 14h
		mov	ecx, 0BBh
		lea	edi, [esp+310h+lParam]
		cmp	edx, eax
		rep stosd
		jz	short loc_413FA6
		cmp	edx, 0FFFFD3ECh
		jz	short loc_413FA6
		mov	[esp+310h+var_2E0], eax
		mov	[esp+310h+var_4], eax
		mov	[esp+310h+var_8], edx
		jmp	short loc_413FDF
; ---------------------------------------------------------------------------

loc_413FA6:				; CODE XREF: StartAddress+88j
					; StartAddress+90j
		mov	eax, [esp+310h+var_300]
		lea	esi, [ebp+10h]
		mov	[esp+310h+var_2E0], eax
		mov	eax, [esp+310h+var_2FC]
		mov	ecx, 0B5h
		lea	edi, [esp+310h+var_2DC]
		mov	[esp+310h+var_4], eax
		mov	[esp+310h+var_8], edx
		rep movsd
		mov	ecx, [esp+310h+var_2F8]
		test	ecx, ecx
		jz	short loc_413FDF
		or	al, 4
		mov	[esp+310h+var_4], eax

loc_413FDF:				; CODE XREF: StartAddress+A4j
					; StartAddress+D4j
		lea	ecx, [esp+310h+lParam]
		mov	[esp+310h+lParam], ebx
		push	ecx		; lParam
		push	ebx		; wParam
		push	4Eh		; Msg
		push	ebx		; hWnd
		mov	[esp+320h+var_2E8], 835h
		mov	[esp+320h+var_2E4], 8064h
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		mov	eax, [ebp+0Ch]
		test	eax, eax
		jz	short loc_414019
		push	eax
		call	PGPFreeFilter
		add	esp, 4

loc_414019:				; CODE XREF: StartAddress+10Ej
		mov	esi, ds:EnableWindow
		mov	ecx, 0BDh
		xor	eax, eax
		mov	edi, ebp
		rep stosd
		mov	edi, [esp+310h+hWnd]
		push	eax		; bEnable
		push	edi		; hWnd
		call	esi ; EnableWindow
		push	0		; nCmdShow
		push	edi		; hWnd
		mov	edi, ds:ShowWindow
		call	edi ; ShowWindow
		push	5		; nCmdShow
		mov	ebx, [esp+314h+var_2F4]
		push	ebx		; hWnd
		call	edi ; ShowWindow
		push	1		; bEnable
		push	ebx		; hWnd
		call	esi ; EnableWindow
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 300h
		retn	4
StartAddress	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414060	proc near		; CODE XREF: sub_412530+8CCp
					; DATA XREF: sub_413820+35Fo ...

var_17C		= dword	ptr -17Ch
var_178		= dword	ptr -178h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
lParam		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
Buffer		= byte ptr -154h
var_150		= byte ptr -150h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_24		= byte ptr -24h
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 17Ch
		mov	edx, [esp+17Ch+arg_4]
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	eax, [edx+0Ch]
		push	esi
		mov	esi, [esp+188h+arg_8]
		add	eax, 0FFFFFFFEh	; switch 19 cases
		cmp	eax, 12h
		push	edi
		mov	[esp+18Ch+var_16C], ebp
		ja	loc_414486	; jumptable 00414095 default case
		xor	ecx, ecx
		mov	cl, ds:byte_4144BC[eax]
		jmp	ds:off_4144A8[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_41409C:				; CODE XREF: sub_414060+35j
					; DATA XREF: .text:off_4144A8o
		mov	eax, [edx+10h]	; jumptable 00414095 case 3
		mov	edx, [edx+14h]
		cmp	eax, 0FFFFD12Dh
		mov	[esp+18Ch+var_164], edx
		jnz	loc_414486	; jumptable 00414095 default case
		mov	eax, [esp+18Ch+arg_8]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax+2ECh], 1
		xor	eax, eax
		pop	ebx
		add	esp, 17Ch
		retn
; ---------------------------------------------------------------------------

loc_4140CF:				; CODE XREF: sub_414060+35j
					; DATA XREF: .text:off_4144A8o
		mov	ecx, [edx+10h]	; jumptable 00414095 case 18
		xor	eax, eax
		mov	[esp+18Ch+var_168], ecx
		mov	ecx, 45h
		lea	edi, [esp+18Ch+lParam]
		mov	edx, [edx+14h]
		rep stosd
		mov	eax, [esi]
		mov	[esp+18Ch+var_15C], 835h
		mov	[esp+18Ch+lParam], eax
		or	eax, 0FFFFFFFFh
		mov	[esp+18Ch+var_54], eax
		mov	[esp+18Ch+var_50], eax
		mov	eax, [esi+2ECh]
		mov	[esp+18Ch+var_158], 8067h
		cmp	eax, ebp
		jnz	short loc_41411B
		mov	eax, edx
		jmp	short loc_41412E
; ---------------------------------------------------------------------------

loc_41411B:				; CODE XREF: sub_414060+B5j
		mov	eax, 821h
		mov	[esp+18Ch+var_54], ebp
		mov	[esp+18Ch+var_50], ebp

loc_41412E:				; CODE XREF: sub_414060+B9j
		push	eax
		call	sub_4144D0
		mov	edx, hModule
		add	esp, 4
		lea	ecx, [esp+18Ch+Buffer]
		push	100h		; cchBufferMax
		push	ecx		; lpBuffer
		push	eax		; uID
		push	edx		; hInstance
		call	ds:LoadStringA
		mov	eax, [esi]
		lea	ecx, [esp+18Ch+lParam]
		push	ecx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	ds:SendMessageA
		jmp	loc_414486	; jumptable 00414095 default case
; ---------------------------------------------------------------------------

loc_41416C:				; CODE XREF: sub_414060+35j
					; DATA XREF: .text:off_4144A8o
		lea	eax, [edx+10h]	; jumptable 00414095 case 20
		lea	edi, [esp+18Ch+lParam]
		mov	ecx, [eax]
		mov	[esp+18Ch+var_17C], ecx
		mov	ecx, 46h
		mov	ebx, [eax+4]
		mov	eax, [eax+8]
		mov	[esp+18Ch+var_174], eax
		xor	eax, eax
		rep stosd
		mov	ecx, [esi]
		mov	edi, ds:SendMessageA
		cmp	ebx, 0Ah
		mov	[esp+18Ch+lParam], ecx
		mov	[esp+18Ch+var_15C], 835h
		mov	[esp+18Ch+var_158], 8069h
		mov	dword ptr [esp+18Ch+Buffer], ebp
		jnz	loc_41446A
		mov	ebx, [edx+18h]
		lea	edx, [esp+18Ch+var_50]
		push	ebp
		push	edx
		push	ebx
		call	PGPtlsGetRemoteAuthenticatedKey
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_414486	; jumptable 00414095 default case
		lea	eax, [esp+18Ch+var_4C]
		push	eax
		push	ebx
		call	PGPtlsGetNegotiatedCipherSuite
		add	esp, 8
		test	eax, eax
		jnz	loc_414486	; jumptable 00414095 default case
		lea	ecx, [esp+18Ch+var_150]
		lea	ebx, [esi+10h]
		push	ecx
		push	ebx
		call	PGPGetKeyServerURL
		mov	eax, [esp+194h+var_50]
		lea	edx, [esp+194h+var_48]
		push	edx
		push	eax
		call	PGPGetKeyIDFromKey
		add	esp, 10h
		test	eax, eax
		jnz	loc_414486	; jumptable 00414095 default case
		mov	edx, [esp+18Ch+var_50]
		lea	ecx, [esp+18Ch+var_168]
		push	ecx
		push	14h
		push	edx
		call	PGPGetKeyNumber
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_414486	; jumptable 00414095 default case
		mov	eax, [esi+29Ch]
		mov	ebp, 1
		cmp	eax, 0FFFFFFFFh
		jz	loc_41437D
		lea	ecx, [esp+18Ch+var_24]
		lea	eax, [esi+21Ah]
		push	ecx
		push	eax
		call	PGPGetKeyIDFromString
		add	esp, 8
		test	eax, eax
		jnz	loc_414484
		lea	edx, [esp+18Ch+var_48]
		lea	eax, [esp+18Ch+var_24]
		push	edx
		push	eax
		call	PGPCompareKeyIDs
		add	esp, 8
		test	eax, eax
		jz	loc_414321
		mov	ecx, [esi+2E4h]
		mov	edx, [esp+18Ch+var_4C]
		mov	eax, [esp+18Ch+var_50]
		push	3
		push	ecx
		push	edx
		mov	edx, [esi]
		lea	ecx, [esp+198h+var_150]
		push	eax
		mov	eax, dword_430850
		push	ecx
		push	edx
		push	eax
		call	ds:PGPclConfirmRemoteAuthentication
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_414413
		lea	eax, [esi+21Ah]
		lea	ecx, [esp+18Ch+var_48]
		push	eax
		push	3
		push	ecx
		call	PGPGetKeyIDString
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_414484
		mov	edx, [esp+18Ch+var_168]
		push	ebx
		mov	[esi+29Ch], edx
		mov	eax, dword_430850
		push	eax
		call	ds:PGPclSyncKeyserverPrefs
		mov	eax, [esi]
		add	esp, 8
		mov	dword ptr [esp+18Ch+Buffer], ebp
		mov	[esp+18Ch+var_17C], eax
		mov	[esp+18Ch+var_178], 835h
		mov	[esp+18Ch+var_174], 8078h
		lea	ecx, [esp+18Ch+var_17C]
		jmp	loc_41440C
; ---------------------------------------------------------------------------

loc_414321:				; CODE XREF: sub_414060+225j
		mov	edx, [esi+2E4h]
		mov	eax, [esp+18Ch+var_4C]
		mov	ecx, [esp+18Ch+var_50]
		push	4
		push	edx
		push	eax
		mov	eax, [esi]
		lea	edx, [esp+198h+var_150]
		push	ecx
		mov	ecx, dword_430850
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclConfirmRemoteAuthentication
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_414413
		mov	dword ptr [esp+18Ch+Buffer], 1

loc_414362:				; CODE XREF: sub_414060+3B7j
					; sub_414060+405j
		xor	ebp, ebp

loc_414364:				; CODE XREF: sub_414060+40Dj
					; sub_414060+417j
		mov	eax, [esi]
		lea	edx, [esp+18Ch+lParam]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	ds:GetParent
		push	eax		; hWnd
		call	edi ; SendMessageA
		jmp	loc_414486	; jumptable 00414095 default case
; ---------------------------------------------------------------------------

loc_41437D:				; CODE XREF: sub_414060+1E6j
		mov	edx, [esi+2E4h]
		mov	eax, [esp+18Ch+var_4C]
		mov	ecx, [esp+18Ch+var_50]
		push	2
		push	edx
		push	eax
		mov	eax, [esi]
		lea	edx, [esp+198h+var_150]
		push	ecx
		mov	ecx, dword_430850
		push	edx
		push	eax
		push	ecx
		call	ds:PGPclConfirmRemoteAuthentication
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_414413
		lea	edx, [esi+21Ah]
		lea	eax, [esp+18Ch+var_48]
		push	edx
		push	3
		push	eax
		call	PGPGetKeyIDString
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_414484
		mov	ecx, [esp+18Ch+var_168]
		push	ebx
		mov	[esi+29Ch], ecx
		mov	edx, dword_430850
		push	edx
		call	ds:PGPclSyncKeyserverPrefs
		mov	eax, [esi]
		add	esp, 8
		mov	dword ptr [esp+18Ch+Buffer], ebp
		mov	[esp+18Ch+var_17C], eax
		mov	[esp+18Ch+var_178], 835h
		mov	[esp+18Ch+var_174], 8078h
		lea	ecx, [esp+18Ch+var_17C]

loc_41440C:				; CODE XREF: sub_414060+2BCj
		push	ecx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	edi ; SendMessageA

loc_414413:				; CODE XREF: sub_414060+25Dj
					; sub_414060+2F4j ...
		cmp	dword ptr [esp+18Ch+Buffer], ebp
		jz	loc_414362
		mov	eax, [esi]
		xor	edx, edx
		mov	[esp+18Ch+var_17C], edx
		lea	ecx, [esp+18Ch+var_17C]
		mov	[esp+18Ch+var_178], edx
		push	ecx		; lParam
		mov	[esp+190h+var_174], edx
		push	eax		; wParam
		push	4Eh		; Msg
		mov	[esp+198h+var_170], edx
		push	eax		; hWnd
		mov	[esi+2ECh], ebp
		mov	[esp+19Ch+var_17C], eax
		mov	[esp+19Ch+var_178], 835h
		mov	[esp+19Ch+var_174], 8068h
		mov	[esp+19Ch+var_170], 0FFFFD12Dh
		call	ds:GetParent
		push	eax		; hWnd
		call	edi ; SendMessageA
		jmp	loc_414362
; ---------------------------------------------------------------------------

loc_41446A:				; CODE XREF: sub_414060+14Fj
		cmp	ebx, 9
		jnz	loc_414364
		mov	dword ptr [esp+18Ch+Buffer], ebp
		jmp	loc_414364
; ---------------------------------------------------------------------------

loc_41447C:				; CODE XREF: sub_414060+35j
					; DATA XREF: .text:off_4144A8o
		mov	[esi+2F0h], ebp	; jumptable 00414095 case 2
		jmp	short loc_414486 ; jumptable 00414095 default case
; ---------------------------------------------------------------------------

loc_414484:				; CODE XREF: sub_414060+205j
					; sub_414060+27Ej ...
		xor	ebp, ebp

loc_414486:				; CODE XREF: sub_414060+27j
					; sub_414060+35j ...
		cmp	[esi+2ECh], ebp	; jumptable 00414095 default case
		jz	short loc_414496
		mov	[esp+18Ch+var_16C], 0FFFFD12Dh

loc_414496:				; CODE XREF: sub_414060+42Cj
		mov	eax, [esp+18Ch+var_16C]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 17Ch
		retn
sub_414060	endp

; ---------------------------------------------------------------------------
		align 4
off_4144A8	dd offset loc_41447C	; DATA XREF: sub_414060+35r
		dd offset loc_41409C	; jump table for switch	statement
		dd offset loc_4140CF
		dd offset loc_41416C
		dd offset loc_414486
byte_4144BC	db	0,     1,     4,     4 ; DATA XREF: sub_414060+2Fr
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	2,     4,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4144D0	proc near		; CODE XREF: sub_414060+CFp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		dec	eax
		cmp	eax, 7		; switch 8 cases
		ja	short loc_414511 ; jumptable 004144DA default case
		jmp	ds:off_414518[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4144E1:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 80Dh	; jumptable 004144DA case 0
		retn
; ---------------------------------------------------------------------------

loc_4144E7:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 80Eh	; jumptable 004144DA case 1
		retn
; ---------------------------------------------------------------------------

loc_4144ED:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 856h	; jumptable 004144DA case 2
		retn
; ---------------------------------------------------------------------------

loc_4144F3:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 80Fh	; jumptable 004144DA case 3
		retn
; ---------------------------------------------------------------------------

loc_4144F9:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 810h	; jumptable 004144DA case 4
		retn
; ---------------------------------------------------------------------------

loc_4144FF:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 850h	; jumptable 004144DA case 5
		retn
; ---------------------------------------------------------------------------

loc_414505:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 851h	; jumptable 004144DA case 6
		retn
; ---------------------------------------------------------------------------

loc_41450B:				; CODE XREF: sub_4144D0+Aj
					; DATA XREF: .text:off_414518o
		mov	eax, 811h	; jumptable 004144DA case 7
		retn
; ---------------------------------------------------------------------------

loc_414511:				; CODE XREF: sub_4144D0+8j
		mov	eax, 80Ch	; jumptable 004144DA default case
		retn
sub_4144D0	endp

; ---------------------------------------------------------------------------
		align 4
off_414518	dd offset loc_4144E1	; DATA XREF: sub_4144D0+Ar
		dd offset loc_4144E7	; jump table for switch	statement
		dd offset loc_4144ED
		dd offset loc_4144F3
		dd offset loc_4144F9
		dd offset loc_4144FF
		dd offset loc_414505
		dd offset loc_41450B
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_414540(HWND hDlg, HWND hWnd, int)
sub_414540	proc near		; CODE XREF: sub_413820+1BEp

hDlg		= dword	ptr  4
hWnd		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+hDlg]
		push	esi
		mov	esi, [esp+0Ch+arg_8]
		push	edi
		mov	edi, [esp+10h+hWnd]
		push	0BBDh		; nIDDlgItem
		push	ebp		; hDlg
		mov	dword ptr [edi], 0
		mov	dword ptr [esi], 0
		call	ds:GetDlgItem
		push	0BC4h		; nIDDlgItem
		push	ebp		; hDlg
		mov	ebx, eax
		call	ds:GetDlgItem
		push	0		; lParam
		push	0		; wParam
		push	147h		; Msg
		push	ebx		; hWnd
		mov	ebp, eax
		call	ds:SendMessageA
		test	eax, eax
		jnz	short loc_4145B0
		push	ebp		; hWnd
		call	ds:GetWindowTextLengthA
		inc	eax
		push	eax		; size_t
		mov	[esi], eax
		call	_malloc
		add	esp, 4
		mov	[edi], eax
		test	eax, eax
		jz	short loc_4145B0
		mov	ecx, [esi]
		push	ecx		; nMaxCount
		push	eax		; lpString
		push	ebp		; hWnd
		call	ds:GetWindowTextA

loc_4145B0:				; CODE XREF: sub_414540+4Aj
					; sub_414540+63j
		mov	edx, [esp+10h+hDlg]
		push	edx		; hWnd
		call	sub_401100
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_414668

loc_4145C7:				; CODE XREF: sub_414540+122j
		mov	eax, [ebx]
		push	0BBDh		; nIDDlgItem
		push	eax		; hDlg
		call	ds:GetDlgItem
		mov	ecx, [ebx]
		push	0BC4h		; nIDDlgItem
		push	ecx		; hDlg
		mov	ebp, eax
		call	ds:GetDlgItem
		push	0		; lParam
		push	0		; wParam
		push	147h		; Msg
		push	ebp		; hWnd
		mov	[esp+20h+hWnd],	eax
		call	ds:SendMessageA
		test	eax, eax
		jnz	short loc_414650
		mov	edx, [esp+10h+hWnd]
		push	edx		; hWnd
		call	ds:GetWindowTextLengthA
		mov	ecx, [esi]
		lea	ebp, [eax+ecx+1]
		mov	eax, [edi]
		test	eax, eax
		push	ebp		; size_t
		jnz	short loc_41461F
		call	_malloc
		add	esp, 4
		jmp	short loc_414628
; ---------------------------------------------------------------------------

loc_41461F:				; CODE XREF: sub_414540+D3j
		push	eax		; void *
		call	_realloc
		add	esp, 8

loc_414628:				; CODE XREF: sub_414540+DDj
		mov	ecx, eax
		mov	[edi], eax
		test	ecx, ecx
		jz	short loc_414650
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_41463B
		mov	byte ptr [ecx+eax-1], 20h

loc_41463B:				; CODE XREF: sub_414540+F4j
		mov	edx, [edi]
		mov	ecx, [esi]
		mov	eax, [esp+10h+hWnd]
		add	edx, ecx
		push	ebp		; nMaxCount
		push	edx		; lpString
		push	eax		; hWnd
		call	ds:GetWindowTextA
		mov	[esi], ebp

loc_414650:				; CODE XREF: sub_414540+BBj
					; sub_414540+EEj
		mov	ecx, [esp+10h+hDlg]
		push	ebx
		push	ecx
		call	sub_401120
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	loc_4145C7

loc_414668:				; CODE XREF: sub_414540+81j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_414540	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetOpenFileNameA]
; [00000006 BYTES: COLLAPSED FUNCTION GetSaveFileNameA]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetContextMemoryMgr]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSortGroupSet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetGroupInfo]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCompareKeys]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyByKeyID]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeySetContext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCountKeys]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCountGroupItems]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetIndGroupItem]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeGroupSet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPMergeGroupSets]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGroupSetNeedsCommit]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetGroupDescription]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetGroupName]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewGroup]
; [00000006 BYTES: COLLAPSED FUNCTION PGPDeleteGroup]
; [00000006 BYTES: COLLAPSED FUNCTION PGPDeleteIndItemFromGroup]
; [00000006 BYTES: COLLAPSED FUNCTION PGPAddItemToGroup]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeKeyList]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeKeyIter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyIDFromKey]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyNumber]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyIterNext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyIter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOrderKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPImportKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOInputBuffer]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOLastOption]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeFileSpec]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewGroupSetFromFile]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewFileSpecFromFullPath]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetIndGroupID]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCountGroupsInSet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyIDString]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetPrimaryUserIDNameBuffer]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetGroupUserValue]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetIndGroupItemUserValue]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetGroupLowestValidity]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyBoolean]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetPrimaryUserIDValidity]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewContext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGlobalRandomPoolMouseMoved]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGlobalRandomPoolAddKeystroke]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeContext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCommitKeyRingChanges]
; [00000006 BYTES: COLLAPSED FUNCTION PGPRemoveKeys]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewSingletonKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeData]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSignUserID]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOPassphrase]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetPrimaryUserID]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewSecureData]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeOptionList]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetKeyTrust]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOExportable]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOSigTrust]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGenerateSubKey]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOKeyGenMasterKey]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGenerateKey]
; [00000006 BYTES: COLLAPSED FUNCTION PGPORevocationKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPAppendOptionList]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOAdditionalRecipientRequestKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPBuildOptionList]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOKeySetRef]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOKeyGenParams]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOKeyGenFast]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOKeyGenName]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOExpiration]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOPreferredAlgorithms]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOEventHandler]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetDefaultPrivateKey]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFilterKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewUserIDStringFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGlobalRandomPoolGetEntropy]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGlobalRandomPoolGetSize]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyEntropyNeeded]
; [00000006 BYTES: COLLAPSED FUNCTION PGPAddKeys]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeySet]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetSigNumber]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetSigBoolean]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyIterNextUIDSig]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyIterNextUserID]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCompareKeyIDs]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyIDOfCertifier]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewSigKeyIDFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOInputFile]
; [00000006 BYTES: COLLAPSED FUNCTION PGPPropagateTrust]
; [00000006 BYTES: COLLAPSED FUNCTION PGPOpenDefaultKeyRings]
; [00000006 BYTES: COLLAPSED FUNCTION PGPsdkLoadDefaultPrefs]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetFullPathFromFileSpec]
; [00000006 BYTES: COLLAPSED FUNCTION PGPsdkPrefGetFileSpec]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyEncryptKeySizeFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyDisabledFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyRevokedFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyExpirationTimeFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPIntersectFilters]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyCreationTimeFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetPGPTimeFromStdTime]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyEncryptAlgorithmFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyIDFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyIDFromString]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNegateFilter]
; [00000006 BYTES: COLLAPSED FUNCTION PGPUnionFilters]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyServerPrefs]
; [00000006 BYTES: COLLAPSED FUNCTION PGPDisposeKeyServerPath]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCreateKeyServerPath]
; [00000006 BYTES: COLLAPSED FUNCTION PGPGetKeyServerURL]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFindEmailDomain]

; =============== S U B	R O U T	I N E =======================================


sub_414910	proc near		; CODE XREF: sub_404530+Ap

WndClass	= WNDCLASSA ptr	-28h

		sub	esp, 28h
		push	esi
		call	ds:InitCommonControls
		xor	esi, esi
		push	7F00h		; lpCursorName
		push	esi		; hInstance
		mov	[esp+34h+WndClass.style], 4088h
		mov	[esp+34h+WndClass.lpfnWndProc],	offset sub_414980
		mov	[esp+34h+WndClass.cbClsExtra], esi
		mov	[esp+34h+WndClass.cbWndExtra], 4
		mov	[esp+34h+WndClass.hInstance], esi
		mov	[esp+34h+WndClass.hIcon], esi
		call	ds:LoadCursorA
		mov	[esp+2Ch+WndClass.hbrBackground], 6
		mov	[esp+2Ch+WndClass.lpszMenuName], esi
		mov	[esp+2Ch+WndClass.hCursor], eax
		lea	eax, [esp+2Ch+WndClass]
		push	eax		; lpWndClass
		mov	[esp+30h+WndClass.lpszClassName], offset aTreelistctrl32 ; "TreeListCtrl32"
		call	ds:RegisterClassA
		pop	esi
		add	esp, 28h
		retn
sub_414910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_414980(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
sub_414980	proc near		; DATA XREF: sub_414910+1Ao

var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Paint		= tagPAINTSTRUCT ptr -40h
hWnd		= dword	ptr  4
Msg		= dword	ptr  8
wParam		= dword	ptr  0Ch
lParam		= dword	ptr  10h

		sub	esp, 6Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+7Ch+hWnd]
		xor	ebx, ebx
		push	ebx		; nIndex
		push	edi		; hWnd
		call	ds:GetWindowLongA
		mov	esi, eax
		mov	ecx, [esp+7Ch+wParam]
		mov	eax, [esp+7Ch+lParam]
		mov	ebp, [esp+7Ch+Msg]
		cmp	esi, ebx
		jnz	short loc_414A0A
		cmp	ebp, 81h
		jnz	short loc_4149E8
		push	1B8h		; size_t
		call	sub_416830
		mov	esi, eax
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_4149DA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4149DA:				; CODE XREF: sub_414980+4Cj
		push	esi		; dwNewLong
		push	ebx		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		jmp	loc_414DC6
; ---------------------------------------------------------------------------

loc_4149E8:				; CODE XREF: sub_414980+39j
		mov	eax, [esp+7Ch+lParam]
		mov	ecx, [esp+7Ch+wParam]
		push	eax		; lParam
		push	ecx		; wParam
		push	ebp		; Msg
		push	edi		; hWnd
		call	ds:DefWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414A0A:				; CODE XREF: sub_414980+31j
		cmp	ebp, 82h
		jnz	short loc_414A2B
		push	esi		; void *
		call	sub_40BF20
		add	esp, 4
		xor	esi, esi
		push	ebx		; dwNewLong
		push	ebx		; nIndex
		push	edi		; hWnd
		call	ds:SetWindowLongA
		jmp	loc_414DC6
; ---------------------------------------------------------------------------

loc_414A2B:				; CODE XREF: sub_414980+90j
		cmp	ebp, 47h
		ja	loc_414D90
		jz	loc_414D73
		lea	eax, [ebp-1]	; switch 21 cases
		cmp	eax, 14h
		ja	loc_4154DA	; jumptable 00414A4E default case
		xor	edx, edx
		mov	dl, ds:byte_415528[eax]
		jmp	ds:off_415504[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_414A55:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 00414A4E case	1
		mov	[esi], edi
		mov	ecx, [eax+0Ch]
		mov	[esi+10h], ebx
		mov	[esi+4], ecx
		mov	edx, [eax+8]
		mov	[esi+28h], edx
		mov	eax, [eax+20h]
		mov	[esi+2Ch], eax
		mov	[esi+30h], ebx
		mov	[esi+130h], ebx
		mov	[esi+0C8h], ebx
		mov	[esi+0DCh], ebx
		mov	[esi+0B8h], ebx
		call	ds:GetCursor
		push	offset CursorName ; "TreeListDraggingCursor"
		push	ebx		; lpModuleName
		mov	[esi+0BCh], eax
		call	ds:GetModuleHandleA
		mov	ebp, ds:LoadCursorA
		push	eax		; hInstance
		call	ebp ; LoadCursorA
		cmp	eax, ebx
		mov	[esi+0C0h], eax
		jnz	short loc_414AC5
		call	ds:GetCursor
		mov	[esi+0C0h], eax

loc_414AC5:				; CODE XREF: sub_414980+137j
		push	7F88h		; lpCursorName
		push	ebx		; hInstance
		call	ebp ; LoadCursorA
		cmp	eax, ebx
		mov	[esi+0C4h], eax
		jnz	short loc_414AE3
		call	ds:GetCursor
		mov	[esi+0C4h], eax

loc_414AE3:				; CODE XREF: sub_414980+155j
		lea	eax, [esi+190h]
		push	esi
		mov	[esi+0D0h], ebx
		mov	[esi+0CCh], ebx
		mov	[esi+0E0h], ebx
		mov	[esi+0ECh], ebx
		mov	[esi+0F4h], ebx
		mov	[esi+100h], ebx
		mov	dword ptr [esi+104h], 3
		mov	[esi+34h], ebx
		mov	[esi+0D4h], ebx
		mov	[esi+128h], ebx
		mov	[esi+38h], edi
		mov	[esi+12Ch], ebx
		mov	[eax], bl
		mov	[esi+1B0h], eax
		mov	[esi+1B4h], ebx
		call	sub_4192C0
		mov	edx, [esi]
		add	esp, 4
		lea	ecx, [esi+108h]
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:GetClientRect
		mov	cl, [esi+2Ch]
		mov	eax, 50000002h
		test	cl, 80h
		jz	short loc_414B68
		mov	eax, 50000042h

loc_414B68:				; CODE XREF: sub_414980+1E1j
		mov	ecx, [esp+7Ch+lParam]
		push	ebx		; lpParam
		mov	ebp, ds:CreateWindowExA
		mov	edx, [ecx+4]
		mov	ecx, [esi+0FCh]
		push	edx		; hInstance
		push	64h		; hMenu
		inc	ecx
		push	edi		; hWndParent
		push	ecx		; nHeight
		push	7530h		; nWidth
		push	ebx		; Y
		push	ebx		; X
		push	eax		; dwStyle
		push	ebx		; lpWindowName
		push	offset aSysheader32 ; "SysHeader32"
		push	ebx		; dwExStyle
		call	ebp ; CreateWindowExA
		mov	edx, [esi+1Ch]
		push	ebx		; lParam
		push	edx		; wParam
		push	30h		; Msg
		push	eax		; hWnd
		mov	[esi+8], eax
		call	ds:SendMessageA
		push	ebx		; lpParam
		mov	eax, [esp+80h+lParam]
		mov	ecx, [eax+4]
		push	ecx		; hInstance
		push	ebx		; hMenu
		push	edi		; hWndParent
		push	80000000h	; nHeight
		push	80000000h	; nWidth
		push	80000000h	; Y
		push	80000000h	; X
		push	ebx		; dwStyle
		push	ebx		; lpWindowName
		push	offset aTooltips_class ; "tooltips_class32"
		push	ebx		; dwExStyle
		call	ebp ; CreateWindowExA
		cmp	eax, ebx
		mov	[esi+0Ch], eax
		jz	loc_4154DA	; jumptable 00414A4E default case
		mov	eax, [esi]
		mov	edx, [esi+4]
		mov	ecx, [esp+7Ch+lParam]
		mov	ebp, ds:SendMessageA
		mov	[esp+7Ch+var_60], eax
		lea	eax, [esp+7Ch+var_6C]
		mov	[esp+7Ch+var_64], edx
		mov	edx, [ecx+4]
		mov	ecx, [esi+0Ch]
		push	eax		; lParam
		push	ebx		; wParam
		push	404h		; Msg
		push	ecx		; hWnd
		mov	[esp+8Ch+var_6C], 2Ch
		mov	[esp+8Ch+var_68], 1A1h
		mov	[esp+8Ch+var_4C], edx
		mov	[esp+8Ch+var_48], offset aTestIsTheTime	; "Test	is the time"
		mov	[esp+8Ch+var_44], ebx
		call	ebp ; SendMessageA
		mov	eax, [esi+0Ch]
		lea	edx, [esp+7Ch+var_6C]
		push	edx		; lParam
		push	ebx		; wParam
		push	411h		; Msg
		push	eax		; hWnd
		call	ebp ; SendMessageA
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414C42:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		cmp	[esi+128h], ebx	; jumptable 00414A4E case 8
		jnz	short loc_414C56
		push	ebx		; bErase
		push	ebx		; lpRect
		push	edi		; hWnd
		mov	[esi+30h], ebx
		call	ds:InvalidateRect

loc_414C56:				; CODE XREF: sub_414980+2C8j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414C62:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		mov	eax, [esi+0CCh]	; jumptable 00414A4E case 7
		mov	ecx, 1
		cmp	eax, ebx
		mov	[esi+30h], ecx
		jnz	short loc_414CA1
		mov	eax, [esi+0C8h]
		cmp	eax, ebx
		jz	short loc_414CAA
		mov	[esi+0CCh], eax
		mov	edx, [eax+44h]
		push	ebx		; bErase
		or	edx, ecx
		push	ebx		; lpRect
		push	edi		; hWnd
		mov	[eax+44h], edx
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414CA1:				; CODE XREF: sub_414980+2F2j
		mov	esi, [esi+0CCh]
		or	[esi+44h], ecx

loc_414CAA:				; CODE XREF: sub_414980+2FCj
		push	ebx		; bErase
		push	ebx		; lpRect
		push	edi		; hWnd
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414CBF:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		push	esi		; jumptable 00414A4E case 15
		call	sub_41AB80
		mov	edx, [esi]
		add	esp, 4
		lea	ecx, [esp+7Ch+Paint]
		push	ecx		; lpPaint
		push	edx		; hWnd
		call	ds:BeginPaint
		lea	ecx, [esp+7Ch+Paint]
		push	ecx		; int
		push	eax		; hdc
		push	esi		; int
		call	sub_41AE00
		mov	eax, [esi]
		add	esp, 0Ch
		lea	edx, [esp+7Ch+Paint]
		push	edx		; lpPaint
		push	eax		; hWnd
		call	ds:EndPaint
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414CFF:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		push	esi		; jumptable 00414A4E case 21
		call	sub_419640
		push	esi
		call	sub_4192C0
		mov	ecx, [esi+0FCh]
		mov	edx, [esi+8]
		add	esp, 8
		inc	ecx
		push	6		; uFlags
		push	ecx		; cy
		push	7530h		; cx
		push	ebx		; Y
		push	ebx		; X
		push	ebx		; hWndInsertAfter
		push	edx		; hWnd
		call	ds:SetWindowPos
		mov	eax, [esi+1Ch]
		mov	ecx, [esi+8]
		push	ebx		; lParam
		push	eax		; wParam
		push	30h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414D40:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		push	esi		; jumptable 00414A4E case 16
		call	sub_41ADC0
		push	esi
		call	sub_419640
		mov	edx, [esi+0C8h]
		push	edx		; void *
		push	esi		; int
		call	sub_4162D0
		push	esi
		mov	[esi+0C8h], ebx
		call	sub_416350
		add	esp, 14h
		mov	[esi+0DCh], ebx
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414D73:				; CODE XREF: sub_414980+B4j
		mov	eax, [esp+7Ch+lParam]
		push	eax
		push	esi
		call	sub_419040
		add	esp, 8
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414D90:				; CODE XREF: sub_414980+AEj
		cmp	ebp, 1007h
		ja	loc_415293
		jz	loc_415270
		cmp	ebp, 202h
		ja	loc_4150D5
		jz	loc_4150A1
		cmp	ebp, 113h
		ja	loc_414FAD
		jz	loc_414F0C

loc_414DC6:				; CODE XREF: sub_414980+63j
					; sub_414980+A6j
		lea	eax, [ebp-4Eh]	; switch 181 cases
		cmp	eax, 0B4h
		ja	loc_4154DA	; jumptable 00414A4E default case
		xor	ecx, ecx
		mov	cl, ds:byte_415558[eax]
		jmp	ds:off_415540[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_414DE3:				; CODE XREF: sub_414980+45Cj
					; DATA XREF: .text:off_415540o
		pop	edi		; jumptable 00414DDC case 135
		pop	esi
		pop	ebp
		mov	eax, 81h
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414DF2:				; CODE XREF: sub_414980+45Cj
					; DATA XREF: .text:off_415540o
		cmp	[esp+7Ch+wParam], 64h ;	jumptable 00414DDC case	78
		jnz	loc_4154DA	; jumptable 00414A4E default case
		mov	edx, [esp+7Ch+lParam]
		push	edx
		push	esi
		call	sub_418EB0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414E1B:				; CODE XREF: sub_414980+45Cj
					; DATA XREF: .text:off_415540o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 00414DDC case	256
		mov	ecx, [esp+7Ch+wParam]
		push	eax
		push	ecx
		push	esi
		call	sub_416970
		add	esp, 0Ch
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414E39:				; CODE XREF: sub_414980+45Cj
					; DATA XREF: .text:off_415540o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 00414DDC case	123
		mov	ecx, [esi+28h]
		mov	edx, eax
		mov	dword ptr [esi+40h], 0FFFFFF93h
		shr	eax, 10h
		mov	[esi+0A0h], eax
		and	edx, 0FFFFh
		lea	eax, [esi+38h]
		mov	[esi+9Ch], edx
		mov	edx, [esi+4]
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA

loc_414E72:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		pop	edi		; jumptable 00414A4E cases 3,5
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_414E7E:				; CODE XREF: sub_414980+45Cj
					; DATA XREF: .text:off_415540o
		test	byte ptr [esi+2Ch], 8 ;	jumptable 00414DDC case	258
		jz	short loc_414ECA
		mov	eax, [esp+7Ch+lParam]
		and	eax, 80000000h
		not	eax
		test	eax, eax
		jz	short loc_414ECA
		mov	ecx, [esi+12Ch]
		mov	edx, [esp+7Ch+wParam]
		push	ecx
		push	edx
		push	esi
		call	sub_4173F0
		add	esp, 0Ch
		mov	dword ptr [esi+12Ch], 1
		push	ebx		; lpTimerFunc
		push	3E8h		; uElapse
		push	457h		; nIDEvent
		push	edi		; hWnd
		call	ds:SetTimer

loc_414ECA:				; CODE XREF: sub_414980+502j
					; sub_414980+514j
		mov	ax, word ptr [esp+7Ch+wParam]
		mov	ecx, [esp+7Ch+lParam]
		mov	[esi+0B0h], ax
		mov	eax, [esi+28h]
		lea	edx, [esi+0A4h]
		mov	[esi+0B2h], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		mov	dword ptr [esi+0ACh], 0FFFFFF8Fh
		call	ds:SendMessageA
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414F0C:				; CODE XREF: sub_414980+440j
		lea	eax, [ecx-457h]	; switch 4 cases
		cmp	eax, 3
		ja	loc_4154DA	; jumptable 00414A4E default case
		jmp	ds:off_415610[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_414F22:				; CODE XREF: sub_414980+59Bj
					; DATA XREF: .text:off_415610o
		mov	edx, [esp+7Ch+wParam] ;	jumptable 00414F1B case	1111
		push	edx		; uIDEvent
		push	edi		; hWnd
		call	ds:KillTimer
		mov	[esi+12Ch], ebx
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414F3C:				; CODE XREF: sub_414980+59Bj
					; DATA XREF: .text:off_415610o
		mov	eax, [esp+7Ch+wParam] ;	jumptable 00414F1B case	1112
		push	eax		; uIDEvent
		push	edi		; hWnd
		call	ds:KillTimer
		mov	edx, [esi+28h]
		mov	eax, [esi+4]
		lea	ecx, [esi+38h]
		mov	dword ptr [esi+40h], 0FFFFFF8Dh
		push	ecx		; lParam
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414F6B:				; CODE XREF: sub_414980+59Bj
					; DATA XREF: .text:off_415610o
		mov	ecx, [esp+7Ch+wParam] ;	jumptable 00414F1B case	1113
		push	ecx		; uIDEvent
		push	edi		; hWnd
		call	ds:KillTimer
		push	esi
		call	sub_418550
		add	esp, 4
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414F88:				; CODE XREF: sub_414980+59Bj
					; DATA XREF: .text:off_415610o
		push	esi		; jumptable 00414F1B case 1114
		call	sub_4176E0
		add	esp, 4
		test	eax, eax
		jz	loc_4154DA	; jumptable 00414A4E default case
		mov	edx, [esp+7Ch+wParam]
		push	edx		; uIDEvent
		push	edi		; hWnd
		call	ds:KillTimer
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_414FAD:				; CODE XREF: sub_414980+43Aj
		lea	eax, [ebp-114h]	; switch 238 cases
		cmp	eax, 0EDh
		ja	loc_4154DA	; jumptable 00414A4E default case
		xor	ecx, ecx
		mov	cl, ds:byte_415634[eax]
		jmp	ds:off_415620[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_414FCD:				; CODE XREF: sub_414980+646j
					; DATA XREF: .text:off_415620o
		push	edi		; jumptable 00414FC6 case 513
		call	ds:SetFocus
		mov	edi, [esp+7Ch+lParam]
		push	edi
		push	esi
		call	sub_418140
		mov	edx, [esp+84h+wParam]
		push	edi
		push	edx
		push	esi
		mov	[esi+128h], ebx
		call	sub_4181E0
		mov	eax, edi
		add	esp, 14h
		shr	edi, 10h
		and	eax, 0FFFFh
		mov	[esi+138h], edi
		mov	[esi+134h], eax
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41501C:				; CODE XREF: sub_414980+646j
					; DATA XREF: .text:off_415620o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 00414FC6 case	512
		mov	edx, [esp+7Ch+wParam]
		push	ecx
		push	edx
		push	esi
		call	sub_417FC0
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415041:				; CODE XREF: sub_414980+646j
					; DATA XREF: .text:off_415620o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 00414FC6 case	276
		push	eax
		mov	eax, [esp+80h+wParam]
		mov	ecx, eax
		and	eax, 0FFFFh
		shr	ecx, 10h
		push	ecx
		push	eax
		push	esi
		call	sub_418F80
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415071:				; CODE XREF: sub_414980+646j
					; DATA XREF: .text:off_415620o
		mov	eax, [esp+7Ch+wParam] ;	jumptable 00414FC6 case	277
		mov	edx, [esp+7Ch+lParam]
		mov	ecx, eax
		push	edx
		shr	ecx, 10h
		and	eax, 0FFFFh
		push	ecx
		push	eax
		push	esi
		call	sub_419130
		add	esp, 10h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4150A1:				; CODE XREF: sub_414980+42Ej
		mov	edx, [esi+128h]
		push	eax
		cmp	edx, ebx
		jz	short loc_4150C0
		push	esi
		call	sub_418140
		add	esp, 8
		mov	[esi+128h], ebx
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_4150C0:				; CODE XREF: sub_414980+72Aj
		push	ecx
		push	esi
		call	sub_4187D0
		add	esp, 0Ch
		mov	[esi+128h], ebx
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_4150D5:				; CODE XREF: sub_414980+428j
		cmp	ebp, 1000h
		ja	loc_4151BE
		jz	loc_4151A3
		lea	eax, [ebp-203h]	; switch 8 cases
		cmp	eax, 7
		ja	loc_4154DA	; jumptable 00414A4E default case
		jmp	ds:off_415724[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4150FD:				; CODE XREF: sub_414980+776j
					; DATA XREF: .text:off_415724o
		push	edi		; jumptable 004150F6 case 516
		call	ds:SetFocus
		mov	edi, [esp+7Ch+lParam]
		push	edi
		push	esi
		call	sub_418140
		mov	edx, [esp+84h+wParam]
		push	edi
		push	edx
		push	esi
		mov	[esi+128h], ebx
		call	sub_418BD0
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415136:				; CODE XREF: sub_414980+776j
					; DATA XREF: .text:off_415724o
		push	edi		; jumptable 004150F6 case 515
		call	ds:SetFocus
		mov	edi, [esp+7Ch+lParam]
		push	edi
		push	esi
		call	sub_418140
		mov	eax, [esp+84h+wParam]
		push	edi
		push	eax
		push	esi
		mov	[esi+128h], ebx
		call	sub_418A80
		add	esp, 14h
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41516F:				; CODE XREF: sub_414980+776j
					; DATA XREF: .text:off_415724o
		push	edi		; jumptable 004150F6 case 518
		call	ds:SetFocus
		jmp	loc_4154DA	; jumptable 00414A4E default case
; ---------------------------------------------------------------------------

loc_41517B:				; CODE XREF: sub_414980+776j
					; DATA XREF: .text:off_415724o
		mov	eax, [esp+7Ch+wParam] ;	jumptable 004150F6 case	522
		mov	ecx, eax
		and	eax, 0FFFFh
		shr	ecx, 10h
		push	ecx
		push	eax
		push	esi
		call	sub_4191F0
		add	esp, 0Ch
		xor	eax, eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4151A3:				; CODE XREF: sub_414980+761j
		mov	edx, [esp+7Ch+lParam]
		push	edx
		push	esi
		call	sub_415840
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4151BE:				; CODE XREF: sub_414980+75Bj
		lea	eax, [ebp-1001h] ; switch 4 cases
		cmp	eax, 3
		ja	loc_4154DA	; jumptable 00414A4E default case
		jmp	ds:off_415744[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4151D4:				; CODE XREF: sub_414980+84Dj
					; DATA XREF: .text:off_415744o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 004151CD case	4100
		push	eax
		push	esi
		call	sub_4157C0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4151EF:				; CODE XREF: sub_414980+84Dj
					; DATA XREF: .text:off_415744o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004151CD case	4097
		push	ecx
		push	esi
		call	sub_415D10
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41520A:				; CODE XREF: sub_414980+84Dj
					; DATA XREF: .text:off_415744o
		mov	edx, [esp+7Ch+wParam] ;	jumptable 004151CD case	4098
		mov	eax, [esp+7Ch+lParam]
		push	edx
		push	eax
		push	esi
		call	sub_415FB0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41522D:				; CODE XREF: sub_414980+84Dj
					; DATA XREF: .text:off_415744o
		cmp	[esp+7Ch+wParam], ebx ;	jumptable 004151CD case	4099
		jz	short loc_415246
		mov	ecx, [esi+0C8h]
		push	ecx		; void *
		push	esi		; int
		call	sub_4162D0
		add	esp, 8

loc_415246:				; CODE XREF: sub_414980+8B4j
		mov	[esi+0C8h], ebx
		mov	[esi+0CCh], ebx
		mov	[esi+0D0h], ebx
		mov	[esi+34h], ebx
		mov	[esi+0F4h], ebx

loc_415261:				; CODE XREF: sub_414980+CEj
					; DATA XREF: .text:off_415504o
		pop	edi		; jumptable 00414A4E case 20
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415270:				; CODE XREF: sub_414980+41Cj
		mov	edx, [esp+7Ch+wParam]
		mov	eax, [esp+7Ch+lParam]
		push	edx
		push	eax
		push	esi
		call	sub_4166B0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415293:				; CODE XREF: sub_414980+416j
		lea	eax, [ebp-1008h] ; switch 24 cases
		cmp	eax, 17h
		ja	loc_4154DA	; jumptable 00414A4E default case
		jmp	ds:off_415754[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_4152A9:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		push	esi		; jumptable 004152A2 case 4112
		call	sub_41AB80
		mov	ecx, [esi]
		add	esp, 4
		push	400h		; flags
		push	ebx		; hrgnClip
		push	ecx		; hWnd
		call	ds:GetDCEx
		mov	edi, eax
		push	ebx		; int
		push	edi		; hdc
		push	esi		; int
		call	sub_41AE00
		mov	edx, [esi]
		add	esp, 0Ch
		push	edi		; hDC
		push	edx		; hWnd
		call	ds:ReleaseDC
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4152E4:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		push	esi		; jumptable 004152A2 case 4111
		call	sub_41AB80
		mov	eax, [esp+80h+lParam]
		push	eax		; h
		push	esi		; int
		call	sub_41AFB0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415305:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4110
		mov	dword ptr [esi+30h], 1
		push	ecx
		push	esi
		call	sub_4185C0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415327:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4108
		push	edx
		push	esi
		call	sub_415DA0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415342:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4109
		push	eax
		push	esi
		call	sub_415E50
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41535D:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	eax, [esi+0C8h]	; jumptable 004152A2 case 4114
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41536D:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4123
		mov	edx, [esp+7Ch+wParam]
		push	ecx		; int
		push	edx		; wParam
		push	esi		; int
		call	sub_4163B0
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415390:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4122
		mov	ecx, [esp+7Ch+wParam]
		push	eax		; int
		push	ecx		; wParam
		push	esi		; int
		call	sub_416580
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4153B3:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		push	esi		; jumptable 004152A2 case 4121
		call	sub_416350
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4153C6:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+wParam] ;	jumptable 004152A2 case	4125
		push	edx
		push	esi
		call	sub_416670
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4153E1:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4105
		pop	edi
		mov	[esi+0B8h], eax
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4153FA:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4104
		push	ecx
		push	esi
		call	sub_416780
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415415:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+wParam] ;	jumptable 004152A2 case	4107
		mov	eax, [esp+7Ch+lParam]
		push	edx
		push	eax
		push	esi
		call	sub_416180
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415438:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4116
		push	ecx
		push	esi
		call	sub_416260
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415453:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4124
		push	edx
		push	esi
		call	sub_416800
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_41546E:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	eax, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4117
		push	eax
		push	esi
		call	sub_4173D0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_415489:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	ecx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4106
		push	ecx
		push	esi
		call	sub_415CD0
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4154A4:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4126
		mov	eax, [esp+7Ch+wParam]
		mov	ecx, [esi+8]
		push	edx		; lParam
		push	eax		; wParam
		push	1211h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
; ---------------------------------------------------------------------------

loc_4154CD:				; CODE XREF: sub_414980+922j
					; DATA XREF: .text:off_415754o
		mov	edx, [esp+7Ch+lParam] ;	jumptable 004152A2 case	4127
		mov	[esi+104h], edx

loc_4154DA:				; CODE XREF: sub_414980+C0j
					; sub_414980+CEj ...
		mov	eax, [esp+7Ch+lParam] ;	jumptable 00414A4E default case
		mov	ecx, [esp+7Ch+wParam]
		mov	edx, [esp+7Ch+Msg]
		push	eax		; lParam
		push	ecx		; wParam
		push	edx		; Msg
		push	edi		; hWnd
		call	ds:DefWindowProcA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 6Ch
		retn	10h
sub_414980	endp

; ---------------------------------------------------------------------------
		align 4
off_415504	dd offset loc_414A55	; DATA XREF: sub_414980+CEr
		dd offset loc_414E72	; jump table for switch	statement
		dd offset loc_414C62
		dd offset loc_414C42
		dd offset loc_414CBF
		dd offset loc_414D40
		dd offset loc_415261
		dd offset loc_414CFF
		dd offset loc_4154DA
byte_415528	db	0,     8,     1,     8 ; DATA XREF: sub_414980+C8r
		db	1,     8,     2,     3 ; indirect table	for switch statement
		db	8,     8,     8,     8
		db	8,     8,     4,     5
		db	8,     8,     8,     6
		db	7
		align 10h
off_415540	dd offset loc_414DF2, offset loc_414E39, offset	loc_414DE3
					; DATA XREF: sub_414980+45Cr
		dd offset loc_414E1B, offset loc_414E7E, offset	loc_4154DA ; jump table	for switch statement
byte_415558	db	0,     5,     5,     5 ; DATA XREF: sub_414980+456r
		db	5,     5,     5,     5 ; indirect table	for switch statement
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     1,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     2,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     5,     5
		db	5,     5,     3,     5
		db	4
		align 10h
off_415610	dd offset loc_414F22	; DATA XREF: sub_414980+59Br
		dd offset loc_414F3C	; jump table for switch	statement
		dd offset loc_414F6B
		dd offset loc_414F88
off_415620	dd offset loc_415041, offset loc_415071, offset	loc_41501C
					; DATA XREF: sub_414980+646r
		dd offset loc_414FCD, offset loc_4154DA	; jump table for switch	statement
byte_415634	db 0, 1, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
					; DATA XREF: sub_414980+640r
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4	; indirect table for switch statement
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 4, 4,	4, 4, 4
		db 4, 4, 2, 3
		align 4
off_415724	dd offset loc_415136	; DATA XREF: sub_414980+776r
		dd offset loc_4150FD	; jump table for switch	statement
		dd offset loc_4154DA
		dd offset loc_41516F
		dd offset loc_4154DA
		dd offset loc_4154DA
		dd offset loc_4154DA
		dd offset loc_41517B
off_415744	dd offset loc_4151EF	; DATA XREF: sub_414980+84Dr
		dd offset loc_41520A	; jump table for switch	statement
		dd offset loc_41522D
		dd offset loc_4151D4
off_415754	dd offset loc_4153FA	; DATA XREF: sub_414980+922r
		dd offset loc_4153E1	; jump table for switch	statement
		dd offset loc_415489
		dd offset loc_415415
		dd offset loc_415327
		dd offset loc_415342
		dd offset loc_415305
		dd offset loc_4152E4
		dd offset loc_4152A9
		dd offset loc_4154DA
		dd offset loc_41535D
		dd offset loc_4154DA
		dd offset loc_415438
		dd offset loc_41546E
		dd offset loc_4154DA
		dd offset loc_4154DA
		dd offset loc_4154DA
		dd offset loc_4153B3
		dd offset loc_415390
		dd offset loc_41536D
		dd offset loc_415453
		dd offset loc_4153C6
		dd offset loc_4154A4
		dd offset loc_4154CD
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4157C0	proc near		; CODE XREF: sub_414980+85Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		mov	edi, [esp+4+arg_4]
		mov	eax, [edi+0Ch]
		test	eax, eax
		jz	short loc_4157E5
		push	esi
		mov	esi, [esp+8+arg_0]
		push	eax
		push	esi
		call	sub_4157F0
		push	edi
		push	esi
		call	sub_415840
		add	esp, 10h
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_4157E5:				; CODE XREF: sub_4157C0+Aj
		xor	eax, eax
		pop	edi
		retn
sub_4157C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4157F0	proc near		; CODE XREF: sub_4157C0+13p
					; sub_415D10+17p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		xor	edx, edx
		push	esi
		mov	ecx, [eax+4]
		cmp	ecx, edx
		jz	short loc_415804
		mov	esi, [eax]
		mov	[ecx], esi
		jmp	short loc_41581E
; ---------------------------------------------------------------------------

loc_415804:				; CODE XREF: sub_4157F0+Cj
		mov	ecx, [eax+0Ch]
		cmp	ecx, edx
		jz	short loc_415812
		mov	esi, [eax]
		mov	[ecx+8], esi
		jmp	short loc_41581E
; ---------------------------------------------------------------------------

loc_415812:				; CODE XREF: sub_4157F0+19j
		mov	esi, [esp+4+arg_0]
		mov	ecx, [eax]
		mov	[esi+0C8h], ecx

loc_41581E:				; CODE XREF: sub_4157F0+12j
					; sub_4157F0+20j
		mov	ecx, [eax]
		cmp	ecx, edx
		jz	short loc_41582A
		mov	esi, [eax+4]
		mov	[ecx+4], esi

loc_41582A:				; CODE XREF: sub_4157F0+32j
		mov	ecx, [eax+0Ch]
		cmp	ecx, edx
		jz	short loc_415834
		dec	dword ptr [ecx+54h]

loc_415834:				; CODE XREF: sub_4157F0+3Fj
		mov	[eax], edx
		mov	[eax+4], edx
		pop	esi
		retn
sub_4157F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415840	proc near		; CODE XREF: sub_414980+82Cp
					; sub_4157C0+1Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		xor	ebp, ebp
		mov	esi, [edi+0Ch]
		cmp	esi, ebp
		jnz	short loc_415872
		push	5Ch		; size_t
		call	sub_416830
		mov	esi, eax
		add	esp, 4
		cmp	esi, ebp
		jnz	short loc_415866
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_415866:				; CODE XREF: sub_415840+1Ej
		mov	[esi+44h], ebp
		mov	[esi+8], ebp
		mov	[esi+10h], ebp
		mov	[esi+54h], ebp

loc_415872:				; CODE XREF: sub_415840+Ej
		push	ebx
		mov	ebx, [edi]
		mov	[esi+0Ch], ebx
		mov	eax, [edi+4]
		cmp	ebx, ebp
		jz	loc_415A33
		cmp	eax, 0FFFF0001h
		jnz	short loc_4158A4
		mov	eax, [ebx+8]
		cmp	eax, ebp
		mov	[esi], eax
		jz	short loc_415896
		mov	[eax+4], esi

loc_415896:				; CODE XREF: sub_415840+51j
		mov	[ebx+8], esi
		mov	[esi+4], ebp
		inc	dword ptr [ebx+54h]
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_4158A4:				; CODE XREF: sub_415840+48j
		cmp	eax, 0FFFF0002h
		jnz	short loc_4158E7
		mov	eax, [ebx+8]
		cmp	eax, ebp
		jz	short loc_4158D3
		mov	ecx, [eax]
		cmp	ecx, ebp
		jz	short loc_4158C0

loc_4158B8:				; CODE XREF: sub_415840+7Ej
		mov	eax, ecx
		mov	ecx, [eax]
		cmp	ecx, ebp
		jnz	short loc_4158B8

loc_4158C0:				; CODE XREF: sub_415840+76j
		mov	[eax], esi
		mov	[esi+4], eax
		mov	[esi], ebp
		mov	eax, [ebx+54h]
		inc	eax
		mov	[ebx+54h], eax
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_4158D3:				; CODE XREF: sub_415840+70j
		mov	[ebx+8], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		mov	eax, [ebx+54h]
		inc	eax
		mov	[ebx+54h], eax
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_4158E7:				; CODE XREF: sub_415840+69j
		cmp	eax, 0FFFF0003h
		jnz	short loc_41596B
		mov	edi, [ebx+8]
		cmp	edi, ebp
		jnz	short loc_415909
		mov	edi, [esp+10h+arg_4]
		mov	[ebx+8], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		inc	dword ptr [ebx+54h]
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415909:				; CODE XREF: sub_415840+B3j
		mov	eax, [esp+10h+arg_4]
		mov	edx, [edi+48h]
		mov	ebp, ds:lstrcmpA
		mov	ecx, [eax+18h]
		push	ecx		; lpString2
		push	edx		; lpString1
		call	ebp ; lstrcmpA
		test	eax, eax
		jge	loc_4159A9
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_415945

loc_41592B:				; CODE XREF: sub_415840+103j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [eax+48h]
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebp ; lstrcmpA
		test	eax, eax
		jge	short loc_415945
		mov	edi, [edi]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_41592B

loc_415945:				; CODE XREF: sub_415840+E9j
					; sub_415840+FBj
		mov	eax, [edi]
		test	eax, eax
		mov	[esi], eax
		jz	loc_4159FC
		mov	[eax+4], esi
		mov	[edi], esi
		mov	[esi+4], edi
		mov	eax, [ebx+54h]
		mov	edi, [esp+10h+arg_4]
		xor	ebp, ebp
		inc	eax
		mov	[ebx+54h], eax
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_41596B:				; CODE XREF: sub_415840+ACj
		cmp	eax, 0FFFF0004h
		jnz	loc_415A13
		mov	edi, [ebx+8]
		cmp	edi, ebp
		jnz	short loc_415991
		mov	edi, [esp+10h+arg_4]
		mov	[ebx+8], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		inc	dword ptr [ebx+54h]
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415991:				; CODE XREF: sub_415840+13Bj
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [edi+48h]
		mov	ebp, ds:lstrcmpA
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebp ; lstrcmpA
		test	eax, eax
		jg	short loc_4159D1

loc_4159A9:				; CODE XREF: sub_415840+DFj
		mov	eax, [ebx+8]
		test	eax, eax
		mov	[esi], eax
		jz	short loc_4159B5
		mov	[eax+4], esi

loc_4159B5:				; CODE XREF: sub_415840+170j
		mov	edi, [esp+10h+arg_4]
		mov	[ebx+8], esi
		mov	dword ptr [esi+4], 0
		mov	eax, [ebx+54h]
		xor	ebp, ebp
		inc	eax
		mov	[ebx+54h], eax
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_4159D1:				; CODE XREF: sub_415840+167j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_4159F1

loc_4159D7:				; CODE XREF: sub_415840+1AFj
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [eax+48h]
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebp ; lstrcmpA
		test	eax, eax
		jle	short loc_4159F1
		mov	edi, [edi]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_4159D7

loc_4159F1:				; CODE XREF: sub_415840+195j
					; sub_415840+1A7j
		mov	eax, [edi]
		test	eax, eax
		mov	[esi], eax
		jz	short loc_4159FC
		mov	[eax+4], esi

loc_4159FC:				; CODE XREF: sub_415840+10Bj
					; sub_415840+1B7j
		mov	[edi], esi
		mov	[esi+4], edi
		mov	eax, [ebx+54h]
		mov	edi, [esp+10h+arg_4]
		xor	ebp, ebp
		inc	eax
		mov	[ebx+54h], eax
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415A13:				; CODE XREF: sub_415840+130j
		cmp	eax, ebp
		jz	short loc_415A2B
		mov	[esi+4], eax
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	[eax], esi
		mov	eax, [esi]
		cmp	eax, ebp
		jz	short loc_415A2B
		mov	edx, eax
		mov	[edx+4], esi

loc_415A2B:				; CODE XREF: sub_415840+1D5j
					; sub_415840+1E4j
		inc	dword ptr [ebx+54h]
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415A33:				; CODE XREF: sub_415840+3Dj
		cmp	eax, 0FFFF0001h
		jnz	short loc_415A5B
		mov	ecx, [esp+10h+arg_0]
		mov	eax, [ecx+0C8h]
		cmp	eax, ebp
		mov	[esi], eax
		jz	short loc_415A4D
		mov	[eax+4], esi

loc_415A4D:				; CODE XREF: sub_415840+208j
		mov	[esi+4], ebp
		mov	[ecx+0C8h], esi
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415A5B:				; CODE XREF: sub_415840+1F8j
		cmp	eax, 0FFFF0002h
		jnz	short loc_415A9A
		mov	ecx, [esp+10h+arg_0]
		mov	eax, [ecx+0C8h]
		cmp	eax, ebp
		jz	short loc_415A8A
		mov	ecx, [eax]
		cmp	ecx, ebp
		jz	short loc_415A7E

loc_415A76:				; CODE XREF: sub_415840+23Cj
		mov	eax, ecx
		mov	ecx, [eax]
		cmp	ecx, ebp
		jnz	short loc_415A76

loc_415A7E:				; CODE XREF: sub_415840+234j
		mov	[eax], esi
		mov	[esi+4], eax
		mov	[esi], ebp
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415A8A:				; CODE XREF: sub_415840+22Ej
		mov	[ecx+0C8h], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415A9A:				; CODE XREF: sub_415840+220j
		cmp	eax, 0FFFF0003h
		jnz	loc_415B41
		mov	eax, [esp+10h+arg_0]
		mov	edi, [eax+0C8h]
		cmp	edi, ebp
		jnz	short loc_415AC7
		mov	edi, [esp+10h+arg_4]
		mov	[eax+0C8h], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415AC7:				; CODE XREF: sub_415840+271j
		mov	eax, [esp+10h+arg_4]
		mov	edx, [edi+48h]
		mov	ebx, ds:lstrcmpA
		mov	ecx, [eax+18h]
		push	ecx		; lpString2
		push	edx		; lpString1
		call	ebx ; lstrcmpA
		test	eax, eax
		jl	short loc_415B08
		mov	ecx, [esp+10h+arg_0]
		mov	eax, [ecx+0C8h]
		cmp	eax, ebp
		mov	[esi], eax
		jz	loc_415B99
		mov	edi, [esp+10h+arg_4]
		mov	[eax+4], esi
		mov	[ecx+0C8h], esi
		mov	[esi+4], ebp
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415B08:				; CODE XREF: sub_415840+29Dj
		mov	eax, [edi]
		cmp	eax, ebp
		jz	short loc_415B28

loc_415B0E:				; CODE XREF: sub_415840+2E6j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [eax+48h]
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcmpA
		test	eax, eax
		jge	short loc_415B28
		mov	edi, [edi]
		mov	eax, [edi]
		cmp	eax, ebp
		jnz	short loc_415B0E

loc_415B28:				; CODE XREF: sub_415840+2CCj
					; sub_415840+2DEj
		mov	eax, [edi]
		cmp	eax, ebp
		mov	[esi], eax
		jz	short loc_415B33
		mov	[eax+4], esi

loc_415B33:				; CODE XREF: sub_415840+2EEj
					; sub_415840+38Ej
		mov	[edi], esi
		mov	[esi+4], edi
		mov	edi, [esp+10h+arg_4]
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415B41:				; CODE XREF: sub_415840+25Fj
		cmp	eax, 0FFFF0004h
		jnz	loc_415BE2
		mov	eax, [esp+10h+arg_0]
		mov	edi, [eax+0C8h]
		cmp	edi, ebp
		jnz	short loc_415B6E
		mov	edi, [esp+10h+arg_4]
		mov	[eax+0C8h], esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		jmp	loc_415BFA
; ---------------------------------------------------------------------------

loc_415B6E:				; CODE XREF: sub_415840+318j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [edi+48h]
		mov	ebx, ds:lstrcmpA
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcmpA
		test	eax, eax
		jg	short loc_415BA8
		mov	ecx, [esp+10h+arg_0]
		mov	eax, [ecx+0C8h]
		cmp	eax, ebp
		mov	[esi], eax
		jz	short loc_415B99
		mov	[eax+4], esi

loc_415B99:				; CODE XREF: sub_415840+2ADj
					; sub_415840+354j
		mov	edi, [esp+10h+arg_4]
		mov	[ecx+0C8h], esi
		mov	[esi+4], ebp
		jmp	short loc_415BFA
; ---------------------------------------------------------------------------

loc_415BA8:				; CODE XREF: sub_415840+344j
		mov	eax, [edi]
		cmp	eax, ebp
		jz	short loc_415BC8

loc_415BAE:				; CODE XREF: sub_415840+386j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [eax+48h]
		mov	edx, [ecx+18h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcmpA
		test	eax, eax
		jle	short loc_415BC8
		mov	edi, [edi]
		mov	eax, [edi]
		cmp	eax, ebp
		jnz	short loc_415BAE

loc_415BC8:				; CODE XREF: sub_415840+36Cj
					; sub_415840+37Ej
		mov	eax, [edi]
		cmp	eax, ebp
		mov	[esi], eax
		jz	loc_415B33
		mov	[eax+4], esi
		mov	[edi], esi
		mov	[esi+4], edi
		mov	edi, [esp+10h+arg_4]
		jmp	short loc_415BFA
; ---------------------------------------------------------------------------

loc_415BE2:				; CODE XREF: sub_415840+306j
		cmp	eax, ebp
		jz	short loc_415BFA
		mov	[esi+4], eax
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	[eax], esi
		mov	eax, [esi]
		cmp	eax, ebp
		jz	short loc_415BFA
		mov	edx, eax
		mov	[edx+4], esi

loc_415BFA:				; CODE XREF: sub_415840+5Fj
					; sub_415840+8Ej ...
		cmp	[edi+0Ch], ebp
		jnz	loc_415CBB
		test	byte ptr [edi+8], 1
		jz	short loc_415C31
		mov	eax, [edi+18h]
		push	eax		; lpString
		call	ds:lstrlenA
		inc	eax
		push	eax		; size_t
		call	sub_416830
		add	esp, 4
		cmp	eax, ebp
		mov	[esi+48h], eax
		jz	short loc_415C34
		mov	ecx, [edi+18h]
		push	ecx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		jmp	short loc_415C34
; ---------------------------------------------------------------------------

loc_415C31:				; CODE XREF: sub_415840+3C7j
		mov	[esi+48h], ebp

loc_415C34:				; CODE XREF: sub_415840+3E2j
					; sub_415840+3EFj
		mov	al, [edi+8]
		mov	ebx, 2
		test	bl, al
		jz	short loc_415C48
		mov	edx, [edi+20h]
		mov	[esi+4Ch], edx
		jmp	short loc_415C4B
; ---------------------------------------------------------------------------

loc_415C48:				; CODE XREF: sub_415840+3FEj
		mov	[esi+4Ch], ebp

loc_415C4B:				; CODE XREF: sub_415840+406j
		test	byte ptr [edi+8], 4
		jz	short loc_415C59
		mov	eax, [edi+2Ch]
		mov	[esi+58h], eax
		jmp	short loc_415C5C
; ---------------------------------------------------------------------------

loc_415C59:				; CODE XREF: sub_415840+40Fj
		mov	[esi+58h], ebp

loc_415C5C:				; CODE XREF: sub_415840+417j
		test	byte ptr [edi+8], 8
		jz	short loc_415C7A
		mov	ecx, [edi+14h]
		mov	eax, [esi+44h]
		not	ecx
		and	eax, ecx
		mov	[esi+44h], eax
		mov	edx, [edi+10h]
		and	edx, [edi+14h]
		or	edx, eax
		mov	[esi+44h], edx

loc_415C7A:				; CODE XREF: sub_415840+420j
		mov	eax, [esp+10h+arg_0]
		cmp	dword ptr [eax+0E0h], 1
		jle	short loc_415CBB
		push	10h		; size_t
		call	sub_416830
		mov	ebp, [esp+14h+arg_0]
		mov	[esi+10h], eax
		mov	edi, eax
		add	esp, 4
		cmp	[ebp+0E0h], ebx
		jle	short loc_415CBB

loc_415CA2:				; CODE XREF: sub_415840+479j
		push	10h		; size_t
		call	sub_416830
		mov	[edi], eax
		add	esp, 4
		mov	edi, eax
		mov	eax, [ebp+0E0h]
		inc	ebx
		cmp	ebx, eax
		jl	short loc_415CA2

loc_415CBB:				; CODE XREF: sub_415840+3BDj
					; sub_415840+445j ...
		pop	ebx
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_415840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415CD0	proc near		; CODE XREF: sub_414980+B12p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [eax+4]
		test	esi, esi
		jz	short loc_415D06
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_415D06
		mov	ecx, [esp+4+arg_0]
		push	eax		; void *
		push	ecx		; int
		call	sub_4162D0
		add	esp, 8
		mov	dword ptr [esi+8], 0
		mov	dword ptr [esi+54h], 0
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415D06:				; CODE XREF: sub_415CD0+Aj
					; sub_415CD0+11j
		xor	eax, eax
		pop	esi
		retn
sub_415CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415D10	proc near		; CODE XREF: sub_414980+878p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	edi
		mov	edi, [eax+4]
		test	edi, edi
		jnz	short loc_415D20
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_415D20:				; CODE XREF: sub_415D10+Aj
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		push	esi
		call	sub_4157F0
		mov	eax, [edi+8]
		add	esp, 8
		test	eax, eax
		jz	short loc_415D40
		push	eax		; void *
		push	esi		; int
		call	sub_4162D0
		add	esp, 8

loc_415D40:				; CODE XREF: sub_415D10+24j
		cmp	[esi+0CCh], edi
		jnz	short loc_415D52
		mov	dword ptr [esi+0CCh], 0

loc_415D52:				; CODE XREF: sub_415D10+36j
		cmp	[esi+0D0h], edi
		jnz	short loc_415D64
		mov	dword ptr [esi+0D0h], 0

loc_415D64:				; CODE XREF: sub_415D10+48j
		mov	esi, [edi+10h]
		test	esi, esi
		jz	short loc_415D85

loc_415D6B:				; CODE XREF: sub_415D10+73j
		mov	ecx, [esi+8]
		push	ecx		; void *
		call	sub_40BF20
		mov	eax, esi
		mov	esi, [esi]
		push	eax		; void *
		call	sub_40BF20
		add	esp, 8
		test	esi, esi
		jnz	short loc_415D6B

loc_415D85:				; CODE XREF: sub_415D10+59j
		mov	edx, [edi+48h]
		push	edx		; void *
		call	sub_40BF20
		push	edi		; void *
		call	sub_40BF20
		add	esp, 8
		mov	eax, 1
		pop	esi
		pop	edi
		retn
sub_415D10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415DA0	proc near		; CODE XREF: sub_414980+9B0p

arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esi+4]
		test	edi, edi
		jnz	short loc_415DB2
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415DB2:				; CODE XREF: sub_415DA0+Bj
		test	byte ptr [esi],	1
		jz	short loc_415DD4
		mov	eax, [edi+48h]
		push	eax		; lpString
		call	ds:lstrlenA
		cmp	[esi+14h], eax
		jle	short loc_415E05
		mov	ecx, [edi+48h]
		mov	edx, [esi+10h]
		push	ecx		; lpString2
		push	edx		; lpString1
		call	ds:lstrcpyA

loc_415DD4:				; CODE XREF: sub_415DA0+15j
		mov	eax, [esi]
		test	al, 2
		jz	short loc_415DE0
		mov	ecx, [edi+4Ch]
		mov	[esi+18h], ecx

loc_415DE0:				; CODE XREF: sub_415DA0+38j
		test	al, 4
		jz	short loc_415DEA
		mov	edx, [edi+58h]
		mov	[esi+24h], edx

loc_415DEA:				; CODE XREF: sub_415DA0+42j
		test	al, 8
		jz	short loc_415DF4
		mov	ecx, [edi+44h]
		mov	[esi+8], ecx

loc_415DF4:				; CODE XREF: sub_415DA0+4Cj
		test	al, 40h
		jz	short loc_415E11
		mov	edx, [edi]
		pop	edi
		mov	[esi+4], edx
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415E05:				; CODE XREF: sub_415DA0+24j
		mov	dword ptr [esi+10h], 0
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415E11:				; CODE XREF: sub_415DA0+56j
		test	ah, 1
		jz	short loc_415E24
		mov	eax, [edi+4]
		pop	edi
		mov	[esi+4], eax
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415E24:				; CODE XREF: sub_415DA0+74j
		test	al, 80h
		jz	short loc_415E36
		mov	ecx, [edi+0Ch]
		pop	edi
		mov	[esi+4], ecx
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415E36:				; CODE XREF: sub_415DA0+86j
		test	ah, 2
		jz	short loc_415E41
		mov	edx, [edi+8]
		mov	[esi+4], edx

loc_415E41:				; CODE XREF: sub_415DA0+99j
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_415DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415E50	proc near		; CODE XREF: sub_414980+9CBp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, [esi+4]
		test	edi, edi
		jnz	short loc_415E62
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_415E62:				; CODE XREF: sub_415E50+Bj
		test	byte ptr [esi],	1
		jz	short loc_415E8D
		mov	eax, [esi+10h]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	ecx, [edi+48h]
		inc	eax
		push	eax		; size_t
		push	ecx		; void *
		call	sub_416880
		add	esp, 8
		mov	[edi+48h], eax
		mov	edx, [esi+10h]
		push	edx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA

loc_415E8D:				; CODE XREF: sub_415E50+15j
		test	byte ptr [esi],	2
		jz	short loc_415E98
		mov	eax, [esi+18h]
		mov	[edi+4Ch], eax

loc_415E98:				; CODE XREF: sub_415E50+40j
		test	byte ptr [esi],	4
		jz	short loc_415EA3
		mov	ecx, [esi+24h]
		mov	[edi+58h], ecx

loc_415EA3:				; CODE XREF: sub_415E50+4Bj
		test	byte ptr [esi],	8
		jz	short loc_415EC0
		mov	edx, [esi+0Ch]
		mov	eax, [edi+44h]
		not	edx
		and	eax, edx
		mov	[edi+44h], eax
		mov	ecx, [esi+8]
		and	ecx, [esi+0Ch]
		or	ecx, eax
		mov	[edi+44h], ecx

loc_415EC0:				; CODE XREF: sub_415E50+56j
		mov	edx, [esp+8+arg_0]
		push	edi
		push	edx
		call	sub_419940
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		retn
sub_415E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415EE0	proc near		; CODE XREF: sub_415EE0+26p
					; sub_415FB0+41p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		xor	ebx, ebx
		xor	ebp, ebp
		cmp	edi, ebx
		jz	loc_415F78
		push	esi
		mov	esi, [esp+10h+arg_0]

loc_415EF8:				; CODE XREF: sub_415EE0+8Fj
		mov	eax, [edi+8]
		cmp	eax, ebx
		jz	short loc_415F10
		mov	ecx, [esp+10h+arg_8]
		push	ecx
		push	eax
		push	esi
		call	sub_415EE0
		add	esp, 0Ch
		mov	ebp, eax

loc_415F10:				; CODE XREF: sub_415EE0+1Dj
		cmp	edi, [esp+10h+arg_8]
		jz	short loc_415F6B
		mov	eax, [edi+44h]
		test	al, 2
		jz	short loc_415F38
		and	al, 0FDh
		push	edi
		mov	[edi+44h], eax
		mov	ebp, [esi+34h]
		dec	ebp
		push	esi
		mov	[esi+34h], ebp
		call	sub_419940
		add	esp, 8
		mov	ebp, 1

loc_415F38:				; CODE XREF: sub_415EE0+3Bj
		mov	eax, [edi+44h]
		test	al, 1
		jz	short loc_415F6B
		and	al, 0FEh
		lea	edx, [esi+38h]
		mov	[edi+44h], eax
		mov	eax, [esi+28h]
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		mov	[esi+44h], ebx
		mov	[esi+50h], ebx
		mov	[esi+78h], ebx
		mov	[esi+7Ch], ebx
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA

loc_415F6B:				; CODE XREF: sub_415EE0+34j
					; sub_415EE0+5Dj
		mov	edi, [edi]
		cmp	edi, ebx
		jnz	short loc_415EF8
		pop	esi
		mov	eax, ebp
		pop	edi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_415F78:				; CODE XREF: sub_415EE0+Dj
		mov	eax, ebp
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_415EE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415F80	proc near		; CODE XREF: sub_415F80+1Dp
					; sub_415FB0+170p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_415FAB

loc_415F89:				; CODE XREF: sub_415F80+29j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_415FA5
		mov	edx, [esi+44h]
		mov	eax, [esi+8]
		or	edx, 4
		push	eax
		mov	[esi+44h], edx
		call	sub_415F80
		add	esp, 4

loc_415FA5:				; CODE XREF: sub_415F80+Ej
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_415F89

loc_415FAB:				; CODE XREF: sub_415F80+7j
		pop	esi
		retn
sub_415F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415FB0	proc near		; CODE XREF: sub_414980+89Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		dec	eax
		push	edi
		cmp	eax, 4		; switch 5 cases
		ja	loc_416163	; jumptable 00415FC0 default case
		jmp	ds:off_416168[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_415FC7:				; CODE XREF: sub_415FB0+10j
					; DATA XREF: .text:off_416168o
		mov	ecx, [esp+8+arg_4] ; jumptable 00415FC0	case 0
		mov	esi, [ecx+4]
		test	esi, esi
		jz	loc_416163	; jumptable 00415FC0 default case
		mov	eax, [esi+44h]
		test	al, 4
		jz	loc_416163	; jumptable 00415FC0 default case
		mov	edx, [esi+8]
		mov	edi, [esp+8+arg_0]
		push	0
		and	al, 0FBh
		push	edx
		push	edi
		mov	[esi+44h], eax
		call	sub_415EE0
		push	esi
		push	edi
		call	sub_4198C0
		add	esp, 14h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_416008:				; CODE XREF: sub_415FB0+10j
					; DATA XREF: .text:off_416168o
		mov	eax, [esp+8+arg_4] ; jumptable 00415FC0	case 1
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	loc_416163	; jumptable 00415FC0 default case
		mov	eax, [ecx+44h]
		test	al, 4
		jnz	loc_416163	; jumptable 00415FC0 default case
		or	al, 4
		push	ecx
		mov	[ecx+44h], eax
		mov	ecx, [esp+0Ch+arg_0]
		push	ecx
		call	sub_419850
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41603D:				; CODE XREF: sub_415FB0+10j
					; DATA XREF: .text:off_416168o
		mov	edx, [esp+8+arg_4] ; jumptable 00415FC0	case 2
		mov	esi, [edx+4]
		test	esi, esi
		jz	loc_416163	; jumptable 00415FC0 default case
		mov	eax, [esi+44h]
		test	al, 4
		jz	short loc_41607A
		mov	edi, [esp+8+arg_0]
		and	al, 0FBh
		mov	[esi+44h], eax
		mov	eax, [esi+8]
		push	0
		push	eax
		push	edi
		call	sub_415EE0
		push	esi
		push	edi
		call	sub_4198C0
		add	esp, 14h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41607A:				; CODE XREF: sub_415FB0+A1j
		or	al, 4
		pop	edi
		mov	[esi+44h], eax
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_416087:				; CODE XREF: sub_415FB0+10j
					; DATA XREF: .text:off_416168o
		mov	eax, [esp+8+arg_4] ; jumptable 00415FC0	case 3
		test	eax, eax
		jz	short loc_4160C0
		mov	esi, [eax+4]
		test	esi, esi
		jz	short loc_4160C0
		mov	eax, [esi+44h]
		mov	ecx, [esi+8]
		mov	edi, [esp+8+arg_0]
		push	0
		and	al, 0FBh
		push	ecx
		push	edi
		mov	[esi+44h], eax
		call	sub_415EE0
		push	esi
		push	edi
		call	sub_4198C0
		add	esp, 14h
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4160C0:				; CODE XREF: sub_415FB0+DDj
					; sub_415FB0+E4j
		mov	edi, [esp+8+arg_0]
		mov	esi, [edi+0C8h]
		test	esi, esi
		jz	short loc_4160EC

loc_4160CE:				; CODE XREF: sub_415FB0+13Aj
		mov	edx, [esi+44h]
		push	0
		and	edx, 0FFFFFFFBh
		mov	[esi+44h], edx
		mov	edx, [esi+8]
		push	edx
		push	edi
		call	sub_415EE0
		mov	esi, [esi]
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_4160CE

loc_4160EC:				; CODE XREF: sub_415FB0+11Cj
		mov	eax, [edi+0C8h]
		push	eax
		push	edi
		call	sub_4198C0
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_416104:				; CODE XREF: sub_415FB0+10j
					; DATA XREF: .text:off_416168o
		mov	eax, [esp+8+arg_4] ; jumptable 00415FC0	case 4
		test	eax, eax
		jz	short loc_41613B
		mov	esi, [eax+4]
		test	esi, esi
		jz	short loc_41613B
		mov	ecx, [esi+44h]
		or	ecx, 4
		mov	[esi+44h], ecx
		mov	ecx, [esi+8]
		push	ecx
		call	sub_415F80
		mov	edx, [esp+0Ch+arg_0]
		push	esi
		push	edx
		call	sub_419850
		add	esp, 0Ch
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41613B:				; CODE XREF: sub_415FB0+15Aj
					; sub_415FB0+161j
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+0C8h]
		push	eax
		call	sub_415F80
		mov	ecx, [esi+0C8h]
		push	ecx
		push	esi
		call	sub_419850
		add	esp, 0Ch
		mov	eax, 1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_416163:				; CODE XREF: sub_415FB0+Aj
					; sub_415FB0+20j ...
		pop	edi		; jumptable 00415FC0 default case
		xor	eax, eax
		pop	esi
		retn
sub_415FB0	endp

; ---------------------------------------------------------------------------
off_416168	dd offset loc_415FC7	; DATA XREF: sub_415FB0+10r
		dd offset loc_416008	; jump table for switch	statement
		dd offset loc_41603D
		dd offset loc_416087
		dd offset loc_416104
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416180	proc near		; CODE XREF: sub_414980+AA6p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	eax, [esi+0CCh]
		test	eax, eax
		jz	short loc_416194
		and	dword ptr [eax+44h], 0FFFFFFFEh

loc_416194:				; CODE XREF: sub_416180+Ej
		mov	eax, [esp+8+arg_8]
		test	eax, eax
		jz	short loc_4161B5
		mov	eax, [esi+0C8h]
		push	0
		push	eax
		push	esi
		call	sub_415EE0
		add	esp, 0Ch
		mov	dword ptr [esi+34h], 0

loc_4161B5:				; CODE XREF: sub_416180+1Aj
		mov	eax, [esp+8+arg_4]
		test	eax, eax
		jz	loc_416255
		mov	edi, [eax+4]
		test	edi, edi
		jnz	short loc_4161CD
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4161CD:				; CODE XREF: sub_416180+46j
		mov	eax, [edi+44h]
		push	edi
		or	al, 3
		push	esi
		mov	[edi+44h], eax
		mov	edx, [esi+34h]
		inc	edx
		mov	[esi+0CCh], edi
		mov	[esi+0D0h], edi
		mov	[esi+34h], edx
		call	sub_4198C0
		add	esp, 8
		test	eax, eax
		jz	short loc_41620A
		mov	edx, [esi]
		lea	ecx, [esi+118h]
		push	1		; bErase
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		jmp	short loc_416214
; ---------------------------------------------------------------------------

loc_41620A:				; CODE XREF: sub_416180+74j
		push	edi
		push	esi
		call	sub_419940
		add	esp, 8

loc_416214:				; CODE XREF: sub_416180+88j
		cmp	dword ptr [esi+34h], 1
		jle	short loc_416223
		mov	dword ptr [esi+44h], 80h
		jmp	short loc_41622A
; ---------------------------------------------------------------------------

loc_416223:				; CODE XREF: sub_416180+98j
		mov	dword ptr [esi+44h], 0

loc_41622A:				; CODE XREF: sub_416180+A1j
		mov	edx, [esi+28h]
		mov	dword ptr [esi+50h], 0
		mov	[esi+78h], edi
		mov	eax, [edi+44h]
		lea	ecx, [esi+38h]
		mov	[esi+7Ch], eax
		mov	eax, [esi+4]
		push	ecx		; lParam
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA

loc_416255:				; CODE XREF: sub_416180+3Bj
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_416180	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416260	proc near		; CODE XREF: sub_414980+AC1p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		push	0
		mov	eax, [edi+0C8h]
		push	eax
		push	edi
		call	sub_415EE0
		mov	eax, [esp+14h+arg_4]
		add	esp, 0Ch
		test	eax, eax
		mov	dword ptr [edi+34h], 0
		jnz	short loc_416295
		mov	esi, [edi+0C8h]
		mov	[edi+0CCh], esi
		jmp	short loc_41629F
; ---------------------------------------------------------------------------

loc_416295:				; CODE XREF: sub_416260+25j
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4162A3
		mov	esi, [eax+8]

loc_41629F:				; CODE XREF: sub_416260+33j
		test	esi, esi
		jnz	short loc_4162A8

loc_4162A3:				; CODE XREF: sub_416260+3Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4162A8:				; CODE XREF: sub_416260+41j
					; sub_416260+66j
		mov	edx, [esi+44h]
		push	esi
		or	edx, 2
		push	edi
		mov	[esi+44h], edx
		mov	ecx, [edi+34h]
		inc	ecx
		mov	[edi+34h], ecx
		call	sub_419940
		mov	esi, [esi]
		add	esp, 8
		test	esi, esi
		jnz	short loc_4162A8
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_416260	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4162D0(int, void *)
sub_4162D0	proc near		; CODE XREF: sub_414980+3D4p
					; sub_414980+8BEp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		mov	edi, [esp+8+arg_4]
		xor	ebp, ebp
		cmp	edi, ebp
		jz	short loc_41634C
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	esi

loc_4162E2:				; CODE XREF: sub_4162D0+78j
		cmp	[ebx+0CCh], edi
		jnz	short loc_4162F0
		mov	[ebx+0CCh], ebp

loc_4162F0:				; CODE XREF: sub_4162D0+18j
		cmp	[ebx+0D0h], edi
		jnz	short loc_4162FE
		mov	[ebx+0D0h], ebp

loc_4162FE:				; CODE XREF: sub_4162D0+26j
		mov	eax, [edi+8]
		cmp	eax, ebp
		jz	short loc_41630F
		push	eax		; void *
		push	ebx		; int
		call	sub_4162D0
		add	esp, 8

loc_41630F:				; CODE XREF: sub_4162D0+33j
		mov	esi, [edi+10h]
		cmp	esi, ebp
		jz	short loc_416330

loc_416316:				; CODE XREF: sub_4162D0+5Ej
		mov	eax, [esi+8]
		push	eax		; void *
		call	sub_40BF20
		mov	eax, esi
		mov	esi, [esi]
		push	eax		; void *
		call	sub_40BF20
		add	esp, 8
		cmp	esi, ebp
		jnz	short loc_416316

loc_416330:				; CODE XREF: sub_4162D0+44j
		mov	ecx, [edi+48h]
		push	ecx		; void *
		call	sub_40BF20
		mov	eax, edi
		mov	edi, [edi]
		push	eax		; void *
		call	sub_40BF20
		add	esp, 8
		cmp	edi, ebp
		jnz	short loc_4162E2
		pop	esi
		pop	ebx

loc_41634C:				; CODE XREF: sub_4162D0+Aj
		pop	edi
		pop	ebp
		retn
sub_4162D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416350	proc near		; CODE XREF: sub_414980+3E0p
					; sub_414980+A34p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, [edi+0E0h]
		dec	esi
		js	short loc_416378
		push	ebx
		mov	ebx, ds:SendMessageA

loc_416366:				; CODE XREF: sub_416350+25j
		mov	eax, [edi+8]
		push	0		; lParam
		push	esi		; wParam
		push	1202h		; Msg
		push	eax		; hWnd
		call	ebx ; SendMessageA
		dec	esi
		jns	short loc_416366
		pop	ebx

loc_416378:				; CODE XREF: sub_416350+Dj
		mov	esi, [edi+0DCh]
		test	esi, esi
		jz	short loc_416393

loc_416382:				; CODE XREF: sub_416350+41j
		mov	eax, esi
		mov	esi, [esi]
		push	eax		; void *
		call	sub_40BF20
		add	esp, 4
		test	esi, esi
		jnz	short loc_416382

loc_416393:				; CODE XREF: sub_416350+30j
		mov	dword ptr [edi+0DCh], 0
		mov	dword ptr [edi+0E0h], 0
		pop	edi
		mov	eax, 1
		pop	esi
		retn
sub_416350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4163B0(int, WPARAM wParam, int)
sub_4163B0	proc near		; CODE XREF: sub_414980+9FEp

lParam		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
wParam		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	eax, [esp+2Ch+wParam]
		push	ebx
		test	eax, eax
		mov	[esp+30h+lParam], 0
		jnz	short loc_416431
		mov	eax, [esp+30h+arg_8]
		test	byte ptr [eax],	2
		mov	ecx, [esp+30h+arg_0]
		jz	short loc_4163DA
		mov	edx, [eax+8]
		mov	[ecx+0E4h], edx

loc_4163DA:				; CODE XREF: sub_4163B0+1Fj
		mov	edx, [eax+4]
		mov	ebx, [ecx+0E0h]
		mov	[esp+30h+var_18], edx
		mov	edx, [eax+8]
		mov	[esp+30h+var_28], edx
		mov	edx, [eax+0Ch]
		inc	ebx
		mov	[esp+30h+var_24], edx
		mov	[ecx+0E0h], ebx
		mov	edx, [eax+8]
		mov	[ecx+0E4h], edx
		mov	eax, [eax+8]
		lea	edx, [esp+30h+lParam]
		mov	[ecx+0E8h], eax
		mov	eax, [ecx+8]
		push	edx		; lParam
		push	0		; wParam
		push	1201h		; Msg
		push	eax		; hWnd
		mov	[esp+40h+lParam], 7
		call	ds:SendMessageA
		pop	ebx
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_416431:				; CODE XREF: sub_4163B0+12j
		mov	ebx, [esp+30h+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+38h+arg_8]
		mov	edx, [ebx+0E8h]
		mov	esi, [ebx+0DCh]
		mov	ecx, [edi+8]
		add	edx, ecx
		test	esi, esi
		mov	[ebx+0E8h], edx
		jz	short loc_416472
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_416464

loc_41645C:				; CODE XREF: sub_4163B0+B2j
		mov	esi, eax
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_41645C

loc_416464:				; CODE XREF: sub_4163B0+AAj
		push	20h		; size_t
		call	sub_416830
		add	esp, 4
		mov	[esi], eax
		jmp	short loc_416482
; ---------------------------------------------------------------------------

loc_416472:				; CODE XREF: sub_4163B0+A4j
		push	20h		; size_t
		call	sub_416830
		add	esp, 4
		mov	[ebx+0DCh], eax

loc_416482:				; CODE XREF: sub_4163B0+C0j
		mov	esi, [esp+38h+wParam]
		mov	ecx, eax
		mov	[ecx+4], esi
		mov	al, [edi]
		test	al, 10h
		jz	short loc_416497
		mov	edx, [edi+18h]
		mov	[ecx+8], edx

loc_416497:				; CODE XREF: sub_4163B0+DFj
		test	byte ptr [edi],	20h
		jz	short loc_4164A2
		mov	eax, [edi+10h]
		mov	[ecx+10h], eax

loc_4164A2:				; CODE XREF: sub_4163B0+EAj
		test	byte ptr [edi],	1
		jz	short loc_4164E1
		mov	eax, [esp+38h+lParam]
		or	al, 4
		mov	[esp+38h+lParam], eax
		mov	eax, [edi+4]
		cmp	eax, 5
		mov	[esp+38h+var_18], eax
		jz	short loc_4164D6
		cmp	eax, 4
		jz	short loc_4164D6
		cmp	eax, 6
		jz	short loc_4164D6
		cmp	eax, 7
		jnz	short loc_4164DE
		mov	[esp+38h+var_18], 0
		jmp	short loc_4164DE
; ---------------------------------------------------------------------------

loc_4164D6:				; CODE XREF: sub_4163B0+10Bj
					; sub_4163B0+110j ...
		mov	[esp+38h+var_18], 2

loc_4164DE:				; CODE XREF: sub_4163B0+11Aj
					; sub_4163B0+124j
		mov	[ecx+0Ch], eax

loc_4164E1:				; CODE XREF: sub_4163B0+F5j
		test	byte ptr [edi],	2
		jz	short loc_416513
		mov	eax, [esp+38h+lParam]
		or	al, 1
		mov	[esp+38h+lParam], eax
		mov	eax, [edi+8]
		mov	[esp+38h+var_28], eax
		cmp	eax, 10h
		mov	[ecx+14h], eax
		jl	short loc_41650C
		sub	eax, 10h
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ecx+1Ch], eax
		jmp	short loc_416513
; ---------------------------------------------------------------------------

loc_41650C:				; CODE XREF: sub_4163B0+14Dj
		mov	dword ptr [ecx+1Ch], 0

loc_416513:				; CODE XREF: sub_4163B0+134j
					; sub_4163B0+15Aj
		mov	eax, [edi]
		test	al, 4
		jz	short loc_41652B
		mov	edx, [esp+38h+lParam]
		or	edx, 2
		mov	[esp+38h+lParam], edx
		mov	edx, [edi+0Ch]
		mov	[esp+38h+var_24], edx

loc_41652B:				; CODE XREF: sub_4163B0+167j
		test	al, 8
		jz	short loc_416541
		mov	edx, [esp+38h+lParam]
		or	edx, 8
		mov	[esp+38h+lParam], edx
		mov	edx, [edi+14h]
		mov	[esp+38h+var_14], edx

loc_416541:				; CODE XREF: sub_4163B0+17Dj
		test	al, 80h
		jz	short loc_41654B
		mov	eax, [edi+1Ch]
		mov	[ecx+18h], eax

loc_41654B:				; CODE XREF: sub_4163B0+193j
		mov	eax, [ebx+0E0h]
		mov	edx, [ebx+8]
		lea	ecx, [esp+38h+lParam]
		inc	eax
		push	ecx		; lParam
		push	esi		; wParam
		push	1201h		; Msg
		push	edx		; hWnd
		mov	[ebx+0E0h], eax
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 2Ch
		retn
sub_4163B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_416580(int, WPARAM wParam, int)
sub_416580	proc near		; CODE XREF: sub_414980+A21p

lParam		= dword	ptr -2Ch
var_28		= dword	ptr -28h
arg_0		= dword	ptr  4
wParam		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		push	ebx
		push	edi
		mov	edi, [esp+34h+wParam]
		cmp	edi, 1
		jge	short loc_416597
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_416597:				; CODE XREF: sub_416580+Cj
		mov	ebx, [esp+34h+arg_0]
		cmp	edi, [ebx+0E0h]
		jl	short loc_4165AC
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_4165AC:				; CODE XREF: sub_416580+21j
		mov	ecx, [ebx+0DCh]
		cmp	edi, 1
		mov	[esp+34h+lParam], 0
		jle	short loc_4165CB
		lea	eax, [edi-1]

loc_4165C2:				; CODE XREF: sub_416580+49j
		test	ecx, ecx
		jz	short loc_4165C8
		mov	ecx, [ecx]

loc_4165C8:				; CODE XREF: sub_416580+44j
		dec	eax
		jnz	short loc_4165C2

loc_4165CB:				; CODE XREF: sub_416580+3Dj
		push	esi
		mov	esi, [esp+38h+arg_8]
		mov	[ecx+4], edi
		test	byte ptr [esi],	10h
		jz	short loc_4165DE
		mov	eax, [esi+18h]
		mov	[ecx+8], eax

loc_4165DE:				; CODE XREF: sub_416580+56j
		test	byte ptr [esi],	1
		jz	short loc_4165E9
		mov	edx, [esi+4]
		mov	[ecx+0Ch], edx

loc_4165E9:				; CODE XREF: sub_416580+61j
		test	byte ptr [esi],	20h
		jz	short loc_4165F4
		mov	eax, [esi+10h]
		mov	[ecx+10h], eax

loc_4165F4:				; CODE XREF: sub_416580+6Cj
		test	byte ptr [esi],	2
		jz	short loc_416637
		mov	eax, [esi+8]
		cmp	eax, 10h
		mov	[ecx+14h], eax
		jl	short loc_416611
		sub	eax, 10h
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ecx+1Ch], eax
		jmp	short loc_416618
; ---------------------------------------------------------------------------

loc_416611:				; CODE XREF: sub_416580+82j
		mov	dword ptr [ecx+1Ch], 0

loc_416618:				; CODE XREF: sub_416580+8Fj
		mov	esi, [esi+8]
		mov	eax, [ebx+0E8h]
		add	eax, esi
		mov	[esp+38h+lParam], 1
		mov	[esp+38h+var_28], esi
		mov	[ebx+0E8h], eax
		jmp	short loc_41663F
; ---------------------------------------------------------------------------

loc_416637:				; CODE XREF: sub_416580+77j
		mov	eax, [esp+38h+lParam]
		test	eax, eax
		jz	short loc_416654

loc_41663F:				; CODE XREF: sub_416580+B5j
		mov	edx, [ebx+8]
		lea	ecx, [esp+38h+lParam]
		push	ecx		; lParam
		push	edi		; wParam
		push	1204h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA

loc_416654:				; CODE XREF: sub_416580+BDj
		mov	eax, [ebx]
		push	1		; bErase
		push	0		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		mov	eax, edi
		pop	esi
		pop	edi
		pop	ebx
		add	esp, 2Ch
		retn
sub_416580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416670	proc near		; CODE XREF: sub_414980+A4Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jge	short loc_41667C
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_41667C:				; CODE XREF: sub_416670+6j
		mov	ecx, [esp+arg_0]
		cmp	eax, [ecx+0E0h]
		jl	short loc_41668C
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_41668C:				; CODE XREF: sub_416670+16j
		test	eax, eax
		jnz	short loc_416697
		mov	eax, [ecx+0E4h]
		retn
; ---------------------------------------------------------------------------

loc_416697:				; CODE XREF: sub_416670+1Ej
		mov	ecx, [ecx+0DCh]
		cmp	eax, 1
		jle	short loc_4166AC
		dec	eax

loc_4166A3:				; CODE XREF: sub_416670+3Aj
		test	ecx, ecx
		jz	short loc_4166A9
		mov	ecx, [ecx]

loc_4166A9:				; CODE XREF: sub_416670+35j
		dec	eax
		jnz	short loc_4166A3

loc_4166AC:				; CODE XREF: sub_416670+30j
		mov	eax, [ecx+14h]
		retn
sub_416670	endp


; =============== S U B	R O U T	I N E =======================================


sub_4166B0	proc near		; CODE XREF: sub_414980+901p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jnz	short loc_4166C0
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4166C0:				; CODE XREF: sub_4166B0+8j
		mov	eax, [edi+10h]
		cmp	eax, 1
		jge	short loc_4166CE
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4166CE:				; CODE XREF: sub_4166B0+16j
		mov	ebx, [esp+8+arg_0]
		cmp	eax, [ebx+0E0h]
		jl	short loc_4166E0
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4166E0:				; CODE XREF: sub_4166B0+28j
		mov	ecx, [edi+0Ch]
		push	esi
		cmp	eax, 1
		mov	esi, [ecx+10h]
		jle	short loc_4166F2
		dec	eax

loc_4166ED:				; CODE XREF: sub_4166B0+40j
		mov	esi, [esi]
		dec	eax
		jnz	short loc_4166ED

loc_4166F2:				; CODE XREF: sub_4166B0+3Aj
		test	byte ptr [edi],	8
		jz	short loc_41670F
		mov	edx, [edi+8]
		mov	eax, [esi+4]
		not	edx
		and	eax, edx
		mov	[esi+4], eax
		mov	ecx, [edi+4]
		and	ecx, [edi+8]
		or	ecx, eax
		mov	[esi+4], ecx

loc_41670F:				; CODE XREF: sub_4166B0+45j
		test	byte ptr [edi],	1
		jz	short loc_41674F
		mov	edx, [esi+8]
		push	edx		; void *
		call	sub_40BF20
		mov	eax, [edi+14h]
		add	esp, 4
		test	eax, eax
		jz	short loc_416748
		push	eax		; lpString
		call	ds:lstrlenA
		inc	eax
		push	eax		; size_t
		call	sub_416830
		add	esp, 4
		mov	[esi+8], eax
		mov	ecx, [edi+14h]
		push	ecx		; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		jmp	short loc_41674F
; ---------------------------------------------------------------------------

loc_416748:				; CODE XREF: sub_4166B0+75j
		mov	dword ptr [esi+8], 0

loc_41674F:				; CODE XREF: sub_4166B0+62j
					; sub_4166B0+96j
		test	byte ptr [edi],	20h
		jz	short loc_41675A
		mov	edx, [edi+1Ch]
		mov	[esi+0Ch], edx

loc_41675A:				; CODE XREF: sub_4166B0+A2j
		mov	eax, [esp+0Ch+arg_8]
		pop	esi
		test	eax, eax
		jz	short loc_416770
		mov	eax, [edi+0Ch]
		push	eax
		push	ebx
		call	sub_419940
		add	esp, 8

loc_416770:				; CODE XREF: sub_4166B0+B1j
		mov	eax, [edi+10h]
		pop	edi
		pop	ebx
		retn
sub_4166B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416780	proc near		; CODE XREF: sub_414980+A83p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		test	esi, esi
		jnz	short loc_41678E
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41678E:				; CODE XREF: sub_416780+7j
		mov	eax, [esi+10h]
		cmp	eax, 1
		jge	short loc_41679B
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41679B:				; CODE XREF: sub_416780+14j
		mov	ecx, [esp+4+arg_0]
		cmp	eax, [ecx+0E0h]
		jl	short loc_4167AC
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4167AC:				; CODE XREF: sub_416780+25j
		mov	edx, [esi+0Ch]
		push	edi
		cmp	eax, 1
		mov	edi, [edx+10h]
		jle	short loc_4167BE
		dec	eax

loc_4167B9:				; CODE XREF: sub_416780+3Cj
		mov	edi, [edi]
		dec	eax
		jnz	short loc_4167B9

loc_4167BE:				; CODE XREF: sub_416780+36j
		test	byte ptr [esi],	1
		jz	short loc_4167E7
		mov	eax, [esi+14h]
		test	eax, eax
		jz	short loc_4167E7
		mov	eax, [edi+8]
		push	eax		; lpString
		call	ds:lstrlenA
		cmp	eax, [esi+18h]
		jge	short loc_4167E7
		mov	ecx, [edi+8]
		mov	edx, [esi+14h]
		push	ecx		; lpString2
		push	edx		; lpString1
		call	ds:lstrcpyA

loc_4167E7:				; CODE XREF: sub_416780+41j
					; sub_416780+48j ...
		test	byte ptr [esi],	20h
		jz	short loc_4167F2
		mov	eax, [edi+0Ch]
		mov	[esi+1Ch], eax

loc_4167F2:				; CODE XREF: sub_416780+6Aj
		mov	eax, [esi+10h]
		pop	edi
		pop	esi
		retn
sub_416780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416800	proc near		; CODE XREF: sub_414980+ADCp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41680C
		retn
; ---------------------------------------------------------------------------

loc_41680C:				; CODE XREF: sub_416800+9j
		mov	ecx, [esp+arg_0]
		mov	edx, [ecx+0C8h]
		test	edx, edx
		jnz	short loc_41681D
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_41681D:				; CODE XREF: sub_416800+18j
		push	eax
		push	ecx
		call	sub_4198C0
		add	esp, 8
		retn
sub_416800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_416830(size_t)
sub_416830	proc near		; CODE XREF: sub_414980+40p
					; sub_415840+12p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		push	edi		; size_t
		call	_malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_41685C
		push	eax		; uType
		push	offset aError	; "Error"
		push	offset aMemoryAllocati ; "Memory allocation failure"
		push	eax		; hWnd
		call	ds:MessageBoxA
		mov	eax, esi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41685C:				; CODE XREF: sub_416830+13j
		mov	ecx, edi
		xor	eax, eax
		mov	edx, ecx
		mov	edi, esi
		shr	ecx, 2
		rep stosd
		mov	ecx, edx
		and	ecx, 3
		rep stosb
		mov	eax, esi
		pop	edi
		pop	esi
		retn
sub_416830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_416880(void *, size_t)
sub_416880	proc near		; CODE XREF: sub_415E50+27p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_41689C
		push	eax		; void *
		call	_free
		mov	eax, [esp+4+arg_4]
		push	eax		; size_t
		call	sub_416830
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_41689C:				; CODE XREF: sub_416880+6j
		xor	eax, eax
		retn
sub_416880	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4168A0	proc near		; CODE XREF: sub_4168C0+32p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 0
		jnz	short loc_4168B5

loc_4168A9:				; CODE XREF: sub_4168A0+13j
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4168B8
		cmp	dword ptr [eax], 0
		jz	short loc_4168A9

loc_4168B5:				; CODE XREF: sub_4168A0+7j
		mov	eax, [eax]
		retn
; ---------------------------------------------------------------------------

loc_4168B8:				; CODE XREF: sub_4168A0+Ej
		xor	eax, eax
		retn
sub_4168A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4168C0	proc near		; CODE XREF: sub_416970+B3p
					; sub_416970+4EDp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		test	eax, eax
		jz	short loc_4168D7
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_4168FE
		mov	esi, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_4168D7:				; CODE XREF: sub_4168C0+Bj
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_4168E4
		test	byte ptr [esi+44h], 4
		jnz	short loc_416900

loc_4168E4:				; CODE XREF: sub_4168C0+1Cj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_416900
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_4168FE
		push	eax
		call	sub_4168A0
		add	esp, 4
		test	eax, eax
		jnz	short loc_416900

loc_4168FE:				; CODE XREF: sub_4168C0+11j
					; sub_4168C0+2Fj
		mov	eax, esi

loc_416900:				; CODE XREF: sub_4168C0+22j
					; sub_4168C0+28j ...
		pop	esi
		retn
sub_4168C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416910	proc near		; CODE XREF: sub_416940+1Bp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	short locret_416939
		mov	dl, 4

loc_41691D:				; CODE XREF: sub_416910+27j
		test	[eax+44h], dl
		jz	short locret_416939
		mov	eax, ecx
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_416932

loc_41692A:				; CODE XREF: sub_416910+20j
		mov	eax, ecx
		mov	ecx, [eax]
		test	ecx, ecx
		jnz	short loc_41692A

loc_416932:				; CODE XREF: sub_416910+18j
		mov	ecx, [eax+8]
		test	ecx, ecx
		jnz	short loc_41691D

locret_416939:				; CODE XREF: sub_416910+9j
					; sub_416910+10j
		retn
sub_416910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416940	proc near		; CODE XREF: sub_416970+1A2p
					; sub_416970+5ECp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		jz	short loc_416956
		test	ecx, ecx
		jz	short locret_41696D
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_416956:				; CODE XREF: sub_416940+Dj
		test	ecx, ecx
		jz	short loc_416964
		push	ecx
		call	sub_416910
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_416964:				; CODE XREF: sub_416940+18j
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short locret_41696D
		mov	eax, ecx

locret_41696D:				; CODE XREF: sub_416940+11j
					; sub_416940+29j
		retn
sub_416940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416970	proc near		; CODE XREF: sub_414980+4ACp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		test	byte ptr [esi+2Ch], 20h
		jz	short loc_416985
		xor	ebp, ebp
		xor	ebx, ebx
		jmp	short loc_4169B1
; ---------------------------------------------------------------------------

loc_416985:				; CODE XREF: sub_416970+Dj
		mov	edi, ds:GetKeyState
		xor	ebx, ebx
		push	10h		; nVirtKey
		mov	[esp+18h+var_4], ebx
		xor	ebp, ebp
		call	edi ; GetKeyState
		test	ah, 80h
		jz	short loc_4169A3
		mov	ebp, 1
		jmp	short loc_4169B5
; ---------------------------------------------------------------------------

loc_4169A3:				; CODE XREF: sub_416970+2Aj
		push	11h		; nVirtKey
		call	edi ; GetKeyState
		test	ah, 80h
		jz	short loc_4169B5
		mov	ebx, 1

loc_4169B1:				; CODE XREF: sub_416970+13j
		mov	[esp+14h+var_4], ebx

loc_4169B5:				; CODE XREF: sub_416970+31j
					; sub_416970+3Aj
		mov	eax, [esp+14h+arg_4]
		xor	edi, edi
		cmp	eax, 1Bh
		mov	[esi+44h], edi
		jnz	short loc_4169F4
		cmp	[esi+128h], edi
		jz	short loc_4169F4
		test	byte ptr [esi+2Ch], 40h
		jz	short loc_4169F4
		push	0FFFFFFFFh
		push	esi
		call	sub_418140
		mov	ecx, [esi]
		add	esp, 8
		lea	eax, [esi+118h]
		mov	[esi+128h], edi
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect

loc_4169F4:				; CODE XREF: sub_416970+51j
					; sub_416970+59j ...
		mov	eax, [esi+0CCh]
		cmp	eax, edi
		jz	loc_417211	; jumptable 00416A1A default case
		mov	edx, [esp+14h+arg_4]
		lea	ecx, [edx-0Dh]	; switch 97 cases
		cmp	ecx, 60h
		ja	loc_417211	; jumptable 00416A1A default case
		xor	edx, edx
		mov	dl, ds:byte_4172D0[ecx]
		jmp	ds:off_4172A8[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_416A21:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		push	ebp		; jumptable 00416A1A case 40
		push	eax
		call	sub_4168C0
		mov	edi, eax
		mov	eax, [esi+0CCh]
		add	esp, 8
		cmp	edi, eax
		jz	loc_417215
		mov	edx, [eax+44h]
		and	edx, 0FFFFFFFEh
		mov	[eax+44h], edx
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebx, ebx
		jnz	short loc_416AC5
		mov	ecx, [esi+0C8h]
		push	ebx
		push	ecx
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_416A7F
		mov	[esi+0D0h], edi

loc_416A7F:				; CODE XREF: sub_416970+107j
		test	ebp, ebp
		jnz	short loc_416A92
		mov	dword ptr [esi+34h], 1
		mov	[esi+0D0h], edi
		jmp	short loc_416AAA
; ---------------------------------------------------------------------------

loc_416A92:				; CODE XREF: sub_416970+111j
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch

loc_416AAA:				; CODE XREF: sub_416970+120j
					; sub_416970+59Fj
		mov	eax, [esi+0CCh]
		mov	ecx, 2
		mov	edx, [eax+44h]
		or	edx, ecx
		mov	[eax+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416AC5:				; CODE XREF: sub_416970+ECj
					; sub_416970+56Fj ...
		mov	eax, [esi+0CCh]
		mov	ebx, [eax+44h]
		or	ebx, 1
		mov	[eax+44h], ebx
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		mov	ecx, [esi+0CCh]
		push	ecx

loc_416AE8:				; CODE XREF: sub_416970+375j
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	loc_417215
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		jmp	loc_417215
; ---------------------------------------------------------------------------

loc_416B10:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		push	ebp		; jumptable 00416A1A case 38
		push	eax
		call	sub_416940
		mov	edi, eax
		mov	eax, [esi+0CCh]
		add	esp, 8
		cmp	edi, eax
		jz	loc_417215
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebx, ebx
		jnz	short loc_416BB4
		mov	edx, [esi+0C8h]
		push	ebx
		push	edx
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_416B6E
		mov	[esi+0D0h], edi

loc_416B6E:				; CODE XREF: sub_416970+1F6j
		test	ebp, ebp
		jnz	short loc_416B81
		mov	dword ptr [esi+34h], 1
		mov	[esi+0D0h], edi
		jmp	short loc_416B99
; ---------------------------------------------------------------------------

loc_416B81:				; CODE XREF: sub_416970+200j
		mov	eax, [esi+0C8h]
		push	edi
		push	eax
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch

loc_416B99:				; CODE XREF: sub_416970+20Fj
					; sub_416970+6AEj
		mov	eax, [esi+0CCh]
		mov	ecx, 2
		mov	edx, [eax+44h]
		or	edx, ecx
		mov	[eax+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416BB4:				; CODE XREF: sub_416970+1DBj
					; sub_416970+66Ej ...
		mov	eax, [esi+0CCh]
		mov	ebx, [eax+44h]
		or	ebx, 1
		mov	[eax+44h], ebx
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_419940
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	loc_417215
		mov	ecx, [esi]
		lea	eax, [esi+118h]
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		jmp	loc_417215
; ---------------------------------------------------------------------------

loc_416BFF:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		test	ebp, ebp	; jumptable 00416A1A cases 37,109
		jnz	loc_417211	; jumptable 00416A1A default case
		mov	ecx, [eax+44h]
		test	cl, 4
		jz	short loc_416C62
		test	ebx, ebx
		mov	edi, eax
		jnz	short loc_416C42
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		call	sub_415EE0
		mov	dword ptr [esi+34h], 1
		mov	edx, [edi+44h]
		mov	ecx, 2
		add	esp, 0Ch
		or	edx, ecx
		mov	[edi+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416C42:				; CODE XREF: sub_416970+2A3j
		mov	ebx, [edi+44h]
		lea	eax, [esi+118h]
		and	ebx, 0FFFFFFFBh
		push	1		; bErase
		mov	[edi+44h], ebx
		mov	ecx, [esi]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		jmp	loc_417215
; ---------------------------------------------------------------------------

loc_416C62:				; CODE XREF: sub_416970+29Dj
		cmp	[esp+14h+arg_4], 6Dh
		jz	loc_417211	; jumptable 00416A1A default case
		mov	edx, [eax+0Ch]
		test	edx, edx
		jz	loc_417211	; jumptable 00416A1A default case
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_419940
		mov	eax, [esi+0CCh]
		add	esp, 8
		test	ebx, ebx
		mov	edi, [eax+0Ch]
		mov	[esi+0CCh], edi
		jnz	short loc_416CD4
		mov	ecx, [esi+0C8h]
		push	ebx
		push	ecx
		push	esi
		call	sub_415EE0
		mov	[esi+0D0h], edi
		mov	dword ptr [esi+34h], 1
		mov	edx, [edi+44h]
		mov	ecx, 2
		or	edx, ecx
		add	esp, 0Ch
		mov	[edi+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416CD4:				; CODE XREF: sub_416970+32Fj
		mov	ebx, [edi+44h]
		push	edi
		or	ebx, 1
		push	esi
		mov	[edi+44h], ebx
		call	sub_419940
		push	edi
		jmp	loc_416AE8
; ---------------------------------------------------------------------------

loc_416CEA:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		test	ebp, ebp	; jumptable 00416A1A cases 13,39,107
		jnz	loc_417211	; jumptable 00416A1A default case
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	loc_417211	; jumptable 00416A1A default case
		mov	ecx, [eax+44h]
		test	cl, 4
		jz	loc_416DA9
		cmp	[esp+14h+arg_4], 6Bh
		jz	loc_417211	; jumptable 00416A1A default case
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_419940
		mov	edx, [esi+0CCh]
		add	esp, 8
		test	ebx, ebx
		mov	edi, [edx+8]
		mov	[esi+0CCh], edi
		jnz	short loc_416D70
		mov	eax, [esi+0C8h]
		push	ebx
		push	eax
		push	esi
		call	sub_415EE0
		mov	[esi+0D0h], edi
		mov	dword ptr [esi+34h], 1
		mov	edx, [edi+44h]
		mov	ecx, 2
		or	edx, ecx
		add	esp, 0Ch
		mov	[edi+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416D70:				; CODE XREF: sub_416970+3CBj
		mov	ebx, [edi+44h]
		push	edi
		or	ebx, 1
		push	esi
		mov	[edi+44h], ebx
		call	sub_419940
		push	edi

loc_416D81:				; CODE XREF: sub_416970+76Ej
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	loc_417215
		mov	edx, [esi]
		lea	ecx, [esi+118h]
		push	1		; bErase
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		jmp	loc_417215
; ---------------------------------------------------------------------------

loc_416DA9:				; CODE XREF: sub_416970+393j
		test	ebx, ebx
		mov	edi, eax
		jnz	short loc_416DDC
		mov	eax, [esi+0C8h]
		push	edi
		push	eax
		push	esi
		call	sub_415EE0
		mov	dword ptr [esi+34h], 1
		mov	edx, [edi+44h]
		mov	ecx, 2
		add	esp, 0Ch
		or	edx, ecx
		mov	[edi+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_416DDC:				; CODE XREF: sub_416970+43Dj
		mov	ecx, [edi+44h]
		push	1		; bErase
		or	ecx, 4
		mov	[edi+44h], ecx
		mov	edx, [esi]
		lea	ecx, [esi+118h]
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419850
		add	esp, 8
		jmp	loc_417215
; ---------------------------------------------------------------------------

loc_416E0C:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		mov	edx, [esi+0C8h]	; jumptable 00416A1A case 34
		lea	ecx, [esp+14h+arg_0]
		push	ecx
		push	eax
		push	edx
		mov	[esp+20h+arg_0], 0
		call	sub_419800
		mov	eax, [esi+0F0h]
		mov	ecx, [esi+0F4h]
		add	esp, 0Ch
		lea	ebx, [ecx+eax-1]
		mov	ecx, [esp+14h+arg_0]
		cmp	ecx, ebx
		jl	short loc_416E45
		lea	ebx, [eax+ecx-1]

loc_416E45:				; CODE XREF: sub_416970+4CFj
		mov	eax, [esi+0F8h]
		cmp	ebx, eax
		jle	short loc_416E51
		mov	ebx, eax

loc_416E51:				; CODE XREF: sub_416970+4DDj
		mov	edi, [esi+0CCh]
		cmp	ecx, ebx
		jge	short loc_416E74

loc_416E5B:				; CODE XREF: sub_416970+502j
		push	ebp
		push	edi
		call	sub_4168C0
		mov	edi, eax
		mov	eax, [esp+1Ch+arg_0]
		add	esp, 8
		inc	eax
		cmp	eax, ebx
		mov	[esp+14h+arg_0], eax
		jl	short loc_416E5B

loc_416E74:				; CODE XREF: sub_416970+4E9j
		mov	eax, [esi+0CCh]
		cmp	edi, eax
		jz	loc_417215
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebp, ebp
		jz	short loc_416EE4
		mov	eax, [esi+0C8h]
		push	0
		push	eax
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_416EC7
		mov	[esi+0D0h], edi

loc_416EC7:				; CODE XREF: sub_416970+54Fj
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch
		jmp	loc_416AC5
; ---------------------------------------------------------------------------

loc_416EE4:				; CODE XREF: sub_416970+533j
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jnz	loc_416AC5
		mov	edx, [esi+0C8h]
		push	0
		push	edx
		push	esi
		call	sub_415EE0
		add	esp, 0Ch
		mov	[esi+0D0h], edi
		mov	dword ptr [esi+34h], 1
		jmp	loc_416AAA
; ---------------------------------------------------------------------------

loc_416F14:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		mov	edx, [esi+0C8h]	; jumptable 00416A1A case 33
		lea	ecx, [esp+14h+arg_0]
		push	ecx
		push	eax
		push	edx
		mov	[esp+20h+arg_0], 0
		call	sub_419800
		mov	ebx, [esi+0F4h]
		mov	eax, [esp+20h+arg_0]
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	short loc_416F4A
		mov	edx, [esi+0F0h]
		mov	ebx, eax
		sub	ebx, edx
		inc	ebx

loc_416F4A:				; CODE XREF: sub_416970+5CDj
		test	ebx, ebx
		jge	short loc_416F50
		xor	ebx, ebx

loc_416F50:				; CODE XREF: sub_416970+5DCj
		mov	edi, [esi+0CCh]
		cmp	eax, ebx
		jle	short loc_416F73

loc_416F5A:				; CODE XREF: sub_416970+601j
		push	ebp
		push	edi
		call	sub_416940
		mov	edi, eax
		mov	eax, [esp+1Ch+arg_0]
		add	esp, 8
		dec	eax
		cmp	eax, ebx
		mov	[esp+14h+arg_0], eax
		jg	short loc_416F5A

loc_416F73:				; CODE XREF: sub_416970+5E8j
		mov	eax, [esi+0CCh]
		cmp	edi, eax
		jz	loc_417215
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebp, ebp
		jz	short loc_416FE3
		mov	ecx, [esi+0C8h]
		push	0
		push	ecx
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_416FC6
		mov	[esi+0D0h], edi

loc_416FC6:				; CODE XREF: sub_416970+64Ej
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch
		jmp	loc_416BB4
; ---------------------------------------------------------------------------

loc_416FE3:				; CODE XREF: sub_416970+632j
		mov	eax, [esp+14h+var_4]
		test	eax, eax
		jnz	loc_416BB4
		mov	eax, [esi+0C8h]
		push	0
		push	eax
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_417011
		mov	[esi+0D0h], edi

loc_417011:				; CODE XREF: sub_416970+699j
		mov	[esi+0D0h], edi
		mov	dword ptr [esi+34h], 1
		jmp	loc_416B99
; ---------------------------------------------------------------------------

loc_417023:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		mov	edi, [esi+0C8h]	; jumptable 00416A1A case 36
		cmp	edi, eax
		jz	loc_417215
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebx, ebx
		jnz	short loc_4170BB
		mov	eax, [esi+0C8h]
		push	ebx
		push	eax
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_417075
		mov	[esi+0D0h], edi

loc_417075:				; CODE XREF: sub_416970+6FDj
		test	ebp, ebp
		jnz	short loc_417088
		mov	dword ptr [esi+34h], 1
		mov	[esi+0D0h], edi
		jmp	short loc_4170A0
; ---------------------------------------------------------------------------

loc_417088:				; CODE XREF: sub_416970+707j
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch

loc_4170A0:				; CODE XREF: sub_416970+716j
		mov	eax, [esi+0CCh]
		mov	ecx, 2
		mov	edx, [eax+44h]
		or	edx, ecx
		mov	[eax+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_4170BB:				; CODE XREF: sub_416970+6E2j
		mov	eax, [esi+0CCh]
		mov	ebp, [eax+44h]
		or	ebp, 1
		mov	[eax+44h], ebp
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_419940
		mov	eax, [esi+0CCh]
		push	eax
		jmp	loc_416D81
; ---------------------------------------------------------------------------

loc_4170E3:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		mov	edi, [esi+0C8h]	; jumptable 00416A1A case 35
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_4170F7

loc_4170EF:				; CODE XREF: sub_416970+785j
		mov	edi, ecx
		mov	ecx, [edi]
		test	ecx, ecx
		jnz	short loc_4170EF

loc_4170F7:				; CODE XREF: sub_416970+77Dj
		cmp	edi, eax
		jz	loc_417215
		mov	edx, [eax+44h]
		and	edx, 0FFFFFFFEh
		mov	[eax+44h], edx
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		add	esp, 8
		mov	[esi+0CCh], edi
		test	ebx, ebx
		jnz	short loc_417189
		mov	ecx, [esi+0C8h]
		push	ebx
		push	ecx
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0D0h]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_417143
		mov	[esi+0D0h], edi

loc_417143:				; CODE XREF: sub_416970+7CBj
		test	ebp, ebp
		jnz	short loc_417156
		mov	dword ptr [esi+34h], 1
		mov	[esi+0D0h], edi
		jmp	short loc_41716E
; ---------------------------------------------------------------------------

loc_417156:				; CODE XREF: sub_416970+7D5j
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		add	esp, 0Ch

loc_41716E:				; CODE XREF: sub_416970+7E4j
		mov	eax, [esi+0CCh]
		mov	ecx, 2
		mov	edx, [eax+44h]
		or	edx, ecx
		mov	[eax+44h], edx
		mov	eax, [esi+44h]
		or	eax, ecx
		mov	[esi+44h], eax

loc_417189:				; CODE XREF: sub_416970+7B0j
		mov	eax, [esi+0CCh]
		mov	ebx, [eax+44h]
		or	ebx, 1
		mov	[eax+44h], ebx
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	short loc_417215
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		jmp	short loc_417215
; ---------------------------------------------------------------------------

loc_4171CD:				; CODE XREF: sub_416970+AAj
					; DATA XREF: .text:off_4172A8o
		test	ebx, ebx	; jumptable 00416A1A case 32
		jz	short loc_417211 ; jumptable 00416A1A default case
		mov	edx, [eax+44h]
		mov	ecx, 2
		test	cl, dl
		mov	edi, eax
		jz	short loc_4171EB
		and	edx, 0FFFFFFFDh
		mov	[eax+44h], edx
		mov	eax, [esi+34h]
		dec	eax
		jmp	short loc_4171F4
; ---------------------------------------------------------------------------

loc_4171EB:				; CODE XREF: sub_416970+86Dj
		or	edx, ecx
		mov	[eax+44h], edx
		mov	eax, [esi+34h]
		inc	eax

loc_4171F4:				; CODE XREF: sub_416970+879j
		mov	ebx, [esi+44h]
		mov	[esi+34h], eax
		or	ebx, ecx
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		mov	[esi+44h], ebx
		call	sub_419940
		add	esp, 8
		jmp	short loc_417215
; ---------------------------------------------------------------------------

loc_417211:				; CODE XREF: sub_416970+8Cj
					; sub_416970+9Cj ...
		mov	edi, [esp+14h+arg_4] ; jumptable 00416A1A default case

loc_417215:				; CODE XREF: sub_416970+C5j
					; sub_416970+183j ...
		mov	eax, [esi+44h]
		xor	edx, edx
		cmp	eax, edx
		jz	short loc_417266
		mov	ecx, [esi+34h]
		cmp	ecx, 1
		jle	short loc_41722B
		or	al, 80h
		mov	[esi+44h], eax

loc_41722B:				; CODE XREF: sub_416970+8B4j
		cmp	ecx, edx
		mov	[esi+50h], edx
		jle	short loc_41723A
		mov	[esi+78h], edi
		mov	edx, [edi+44h]
		jmp	short loc_41723D
; ---------------------------------------------------------------------------

loc_41723A:				; CODE XREF: sub_416970+8C0j
		mov	[esi+78h], edx

loc_41723D:				; CODE XREF: sub_416970+8C8j
		mov	ecx, [esi+28h]
		lea	eax, [esi+38h]
		mov	[esi+7Ch], edx
		mov	edx, [esi+4]
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_417266:				; CODE XREF: sub_416970+8ACj
		mov	ax, word ptr [esp+14h+arg_4]
		mov	ecx, [esp+14h+arg_8]
		mov	[esi+0B0h], ax
		mov	eax, [esi+28h]
		lea	edx, [esi+0A4h]
		mov	[esi+0B2h], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		mov	dword ptr [esi+0ACh], 0FFFFFF90h
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_416970	endp

; ---------------------------------------------------------------------------
		align 4
off_4172A8	dd offset loc_416CEA, offset loc_4171CD, offset	loc_416F14
					; DATA XREF: sub_416970+AAr
		dd offset loc_416E0C, offset loc_4170E3, offset	loc_417023 ; jump table	for switch statement
		dd offset loc_416BFF, offset loc_416B10, offset	loc_416A21
		dd offset loc_417211
byte_4172D0	db	0,     9,     9,     9 ; DATA XREF: sub_416970+A4r
		db	9,     9,     9,     9 ; indirect table	for switch statement
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     1
		db	2,     3,     4,     5
		db	6,     7,     0,     8
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     9,     9
		db	9,     9,     0,     9
		db	6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417340	proc near		; CODE XREF: sub_417340+3Ap
					; sub_4173D0+10p

var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 28h
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_0]
		push	edi
		mov	edi, [esp+34h+arg_4]
		test	esi, esi
		mov	ebp, [edi]
		jnz	short loc_41735D

loc_417354:				; CODE XREF: sub_417340+6Ej
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_41735D:				; CODE XREF: sub_417340+12j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_41736B

loc_417363:				; CODE XREF: sub_417340+29j
		mov	esi, eax
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_417363

loc_41736B:				; CODE XREF: sub_417340+21j
		test	esi, esi
		jz	short loc_4173B9

loc_41736F:				; CODE XREF: sub_417340+77j
		test	byte ptr [esi+44h], 4
		jz	short loc_417382
		mov	eax, [esi+8]
		push	edi
		push	eax
		call	sub_417340
		add	esp, 8

loc_417382:				; CODE XREF: sub_417340+33j
		test	byte ptr [esi+44h], 2
		jz	short loc_4173B2
		mov	[esp+34h+var_24], esi
		mov	ecx, [esi+48h]
		mov	[esp+34h+var_18], ecx
		mov	edx, [esi+4Ch]
		mov	[esp+34h+var_10], edx
		mov	eax, [esi+58h]
		lea	ecx, [esp+34h+var_28]
		push	edi
		mov	[esp+38h+var_4], eax
		mov	esi, [esi+4]
		push	ecx
		call	ebp
		test	eax, eax
		jz	short loc_417354
		jmp	short loc_4173B5
; ---------------------------------------------------------------------------

loc_4173B2:				; CODE XREF: sub_417340+46j
		mov	esi, [esi+4]

loc_4173B5:				; CODE XREF: sub_417340+70j
		test	esi, esi
		jnz	short loc_41736F

loc_4173B9:				; CODE XREF: sub_417340+2Dj
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebp
		add	esp, 28h
		retn
sub_417340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4173D0	proc near		; CODE XREF: sub_414980+AF7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		push	eax
		mov	edx, [ecx+0C8h]
		push	edx
		call	sub_417340
		add	esp, 8
		retn
sub_4173D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4173F0	proc near		; CODE XREF: sub_414980+526p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_42F624
		push	ebp
		push	esi
		cmp	eax, 1
		push	edi
		jle	short loc_417411
		mov	esi, [esp+0Ch+arg_4]
		push	157h		; int
		push	esi		; int
		call	__isctype
		add	esp, 8
		jmp	short loc_417423
; ---------------------------------------------------------------------------

loc_417411:				; CODE XREF: sub_4173F0+Bj
		mov	esi, [esp+0Ch+arg_4]
		mov	eax, off_42F418
		mov	ax, [eax+esi*2]
		and	eax, 157h

loc_417423:				; CODE XREF: sub_4173F0+1Fj
		xor	ebp, ebp
		cmp	eax, ebp
		jnz	short loc_41742F
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41742F:				; CODE XREF: sub_4173F0+37j
		cmp	esi, 1Bh
		jnz	loc_4174BF
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+0CCh]
		lea	ecx, [esi+190h]
		cmp	eax, ebp
		mov	[esi+1B0h], ecx
		mov	[esi+1B4h], ebp
		jz	short loc_41747F
		mov	edx, [eax+44h]
		and	edx, 0FFFFFFFEh
		mov	[eax+44h], edx
		mov	edx, [esi+0CCh]
		push	edx
		push	esi
		call	sub_419940
		mov	eax, [esi+0C8h]
		push	ebp
		push	eax
		push	esi
		call	sub_415EE0
		add	esp, 14h

loc_41747F:				; CODE XREF: sub_4173F0+66j
		mov	edx, [esi+28h]
		mov	eax, [esi+4]
		lea	ecx, [esi+38h]
		mov	[esi+0CCh], ebp
		push	ecx		; lParam
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		mov	[esi+0D0h], ebp
		mov	[esi+34h], ebp
		mov	dword ptr [esi+44h], 2
		mov	[esi+50h], ebp
		mov	[esi+78h], ebp
		mov	[esi+7Ch], ebp
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4174BF:				; CODE XREF: sub_4173F0+42j
		movsx	ecx, byte ptr [esp+0Ch+arg_4]
		push	ecx		; int
		call	_tolower
		mov	esi, [esp+10h+arg_0]
		add	esp, 4
		mov	edi, [esi+0CCh]
		cmp	edi, ebp
		jz	short loc_4174ED
		mov	ecx, [edi+0Ch]
		cmp	ecx, ebp
		jz	short loc_4174F3

loc_4174E2:				; CODE XREF: sub_4173F0+F9j
		mov	edi, ecx
		mov	ecx, [edi+0Ch]
		cmp	ecx, ebp
		jnz	short loc_4174E2
		jmp	short loc_4174F3
; ---------------------------------------------------------------------------

loc_4174ED:				; CODE XREF: sub_4173F0+E9j
		mov	edi, [esi+0C8h]

loc_4174F3:				; CODE XREF: sub_4173F0+F0j
					; sub_4173F0+FBj
		cmp	edi, ebp
		jnz	short loc_4174FD
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4174FD:				; CODE XREF: sub_4173F0+105j
		mov	ecx, [esi+1B4h]
		push	ebx
		mov	ebx, edi
		cmp	ecx, 1
		mov	[esp+10h+arg_4], ebx
		jnz	short loc_417574
		cmp	[esi+190h], al
		jnz	short loc_417574
		mov	edi, [edi]
		cmp	edi, ebp
		jnz	short loc_417523
		mov	edi, [esi+0C8h]

loc_417523:				; CODE XREF: sub_4173F0+12Bj
		mov	edx, [edi+48h]
		movsx	eax, byte ptr [edx]
		push	eax		; int
		call	_tolower
		movsx	ecx, byte ptr [esi+190h]
		add	esp, 4
		cmp	eax, ecx
		jz	loc_417617

loc_417541:				; CODE XREF: sub_4173F0+17Dj
		mov	edi, [edi]
		cmp	edi, ebp
		jnz	short loc_41754D
		mov	edi, [esi+0C8h]

loc_41754D:				; CODE XREF: sub_4173F0+155j
		cmp	edi, ebx
		jz	loc_4176CC
		mov	edx, [edi+48h]
		movsx	eax, byte ptr [edx]
		push	eax		; int
		call	_tolower
		movsx	ecx, byte ptr [esi+190h]
		add	esp, 4
		cmp	eax, ecx
		jnz	short loc_417541
		jmp	loc_417617
; ---------------------------------------------------------------------------

loc_417574:				; CODE XREF: sub_4173F0+11Dj
					; sub_4173F0+125j
		cmp	[esp+10h+arg_8], ebp
		jnz	short loc_41758C
		lea	edx, [esi+190h]
		mov	[esi+1B4h], ebp
		mov	[esi+1B0h], edx

loc_41758C:				; CODE XREF: sub_4173F0+188j
		cmp	dword ptr [esi+1B4h], 1Fh
		jge	loc_4176CC
		mov	ecx, [esi+1B0h]
		mov	[ecx], al
		mov	ebx, [esi+1B0h]
		inc	ebx
		mov	eax, ebx
		mov	[esi+1B0h], ebx
		mov	byte ptr [eax],	0
		mov	edx, [esi+1B4h]
		inc	edx
		mov	[esi+1B4h], edx
		mov	eax, [edi]
		cmp	eax, ebp
		jz	short loc_4175C8
		mov	edi, eax

loc_4175C8:				; CODE XREF: sub_4173F0+1D4j
		lea	ebp, [esi+190h]
		push	ebp		; lpString
		call	ds:lstrlenA
		mov	edx, [edi+48h]
		mov	ebx, eax
		push	ebx		; size_t
		push	ebp		; char *
		push	edx		; char *
		call	__strnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_417611

loc_4175E9:				; CODE XREF: sub_4173F0+21Fj
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_4175F5
		mov	edi, [esi+0C8h]

loc_4175F5:				; CODE XREF: sub_4173F0+1FDj
		cmp	edi, [esp+10h+arg_4]
		jz	loc_4176CC
		mov	eax, [edi+48h]
		push	ebx		; size_t
		push	ebp		; char *
		push	eax		; char *
		call	__strnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_4175E9

loc_417611:				; CODE XREF: sub_4173F0+1F7j
		mov	ebx, [esp+10h+arg_4]
		xor	ebp, ebp

loc_417617:				; CODE XREF: sub_4173F0+14Bj
					; sub_4173F0+17Fj
		cmp	edi, ebx
		jz	loc_4176CC
		mov	eax, [esi+0CCh]
		cmp	eax, ebp
		jz	short loc_417650
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_419940
		mov	edx, [esi+0C8h]
		push	ebp
		push	edx
		push	esi
		call	sub_415EE0
		add	esp, 14h

loc_417650:				; CODE XREF: sub_4173F0+237j
		mov	[esi+0CCh], edi
		mov	dword ptr [esi+34h], 1
		mov	[esi+0D0h], edi
		mov	eax, [edi+44h]
		or	al, 3
		mov	[edi+44h], eax
		mov	eax, [esi+0CCh]
		push	eax
		push	esi
		call	sub_419940
		mov	ecx, [esi+0CCh]
		push	ecx
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	short loc_41769E
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect

loc_41769E:				; CODE XREF: sub_4173F0+29Aj
		mov	eax, [esi+28h]
		mov	dword ptr [esi+44h], 2
		mov	[esi+50h], ebp
		mov	[esi+78h], edi
		mov	ecx, [edi+44h]
		lea	edx, [esi+38h]
		mov	[esi+7Ch], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA

loc_4176CC:				; CODE XREF: sub_4173F0+15Fj
					; sub_4173F0+1A3j ...
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebp
		retn
sub_4173F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4176E0	proc near		; CODE XREF: sub_414980+609p

Point		= tagPOINT ptr -18h
Rect		= tagRECT ptr -10h
arg_0		= dword	ptr  4

		sub	esp, 18h
		lea	eax, [esp+18h+Point]
		push	esi
		push	eax		; lpPoint
		call	ds:GetCursorPos
		mov	esi, [esp+1Ch+arg_0]
		lea	ecx, [esp+1Ch+Point]
		push	ecx		; lpPoint
		mov	edx, [esi]
		push	edx		; hWnd
		call	ds:ScreenToClient
		mov	ecx, [esi]
		lea	eax, [esp+1Ch+Rect]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:GetClientRect
		mov	edx, [esp+1Ch+Point.y]
		mov	eax, [esp+1Ch+Point.x]
		push	edx
		lea	ecx, [esp+20h+Rect]
		push	eax		; pt
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_417743
		mov	edx, [esi+0Ch]
		push	eax		; lParam
		push	eax		; wParam
		push	411h		; Msg
		push	edx		; hWnd
		call	ds:SendMessageA
		mov	eax, 1
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_417743:				; CODE XREF: sub_4176E0+46j
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
sub_4176E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_417750(int, int, int,	POINT pt)
sub_417750	proc near		; CODE XREF: sub_4177E0+7Fp

rc		= RECT ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
pt		= POINT	ptr  10h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_0]
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		mov	ebp, [ebx+10h]
		test	esi, esi
		push	edi
		mov	[esp+20h+arg_0], 0
		jz	short loc_4177C8
		mov	edi, [esp+20h+arg_8]

loc_417772:				; CODE XREF: sub_417750+76j
		test	ebp, ebp
		jz	short loc_4177C8
		mov	ecx, [esp+20h+arg_0]
		mov	al, [ebp+4]
		inc	ecx
		test	al, 80h
		mov	[esp+20h+arg_0], ecx
		jz	short loc_4177BA
		mov	ecx, [ebx+18h]
		mov	edx, [ebx+20h]
		mov	[esp+20h+rc.left], edi
		mov	eax, [esi+14h]
		add	eax, edi
		mov	[esp+20h+rc.top], ecx
		mov	ecx, [esp+20h+pt.x]
		mov	[esp+20h+rc.right], eax
		mov	eax, [esp+20h+pt.y]
		mov	[esp+20h+rc.bottom], edx
		push	eax
		lea	edx, [esp+24h+rc]
		push	ecx		; pt
		push	edx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_4177D2

loc_4177BA:				; CODE XREF: sub_417750+34j
		mov	ecx, [esi+14h]
		mov	esi, [esi]
		mov	ebp, [ebp+0]
		add	edi, ecx
		test	esi, esi
		jnz	short loc_417772

loc_4177C8:				; CODE XREF: sub_417750+1Cj
					; sub_417750+24j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_4177D2:				; CODE XREF: sub_417750+68j
		mov	eax, [esp+20h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_417750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4177E0(int, int, int,	POINT pt, int)
sub_4177E0	proc near		; CODE XREF: sub_4177E0+4Fp
					; sub_417FC0+6Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
pt		= POINT	ptr  10h
arg_14		= dword	ptr  18h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		push	edi
		jz	short loc_41784B
		mov	ebx, [esp+10h+arg_14]
		mov	edi, [esp+10h+pt.y]
		mov	ebp, [esp+10h+pt.x]

loc_4177F8:				; CODE XREF: sub_4177E0+69j
		push	edi
		lea	eax, [esi+14h]
		push	ebp		; pt
		push	eax		; lprc
		call	ds:PtInRect
		test	eax, eax
		jz	short loc_417818
		push	edi
		lea	ecx, [esi+24h]
		push	ebp		; pt
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_417852

loc_417818:				; CODE XREF: sub_4177E0+26j
		test	byte ptr [esi+44h], 4
		jz	short loc_41783B
		mov	edx, [esp+10h+arg_8]
		mov	eax, [esp+10h+arg_4]
		mov	ecx, [esi+8]
		push	ebx		; int
		push	edi
		push	ebp		; pt
		push	edx		; int
		push	eax		; int
		push	ecx		; int
		call	sub_4177E0
		add	esp, 18h
		test	eax, eax
		jnz	short loc_41784D

loc_41783B:				; CODE XREF: sub_4177E0+3Cj
		mov	edx, [esi+3Ch]
		mov	eax, [esi+34h]
		cmp	edx, eax
		jl	short loc_41784B
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_4177F8

loc_41784B:				; CODE XREF: sub_4177E0+Aj
					; sub_4177E0+63j
		xor	eax, eax

loc_41784D:				; CODE XREF: sub_4177E0+59j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417852:				; CODE XREF: sub_4177E0+36j
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		push	edi
		push	ebp		; pt
		push	eax		; int
		push	ecx		; int
		push	esi		; int
		call	sub_417750
		add	esp, 14h
		mov	[ebx], eax
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_4177E0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_417870(int, int, int,	POINT pt)
sub_417870	proc near		; CODE XREF: sub_417910+25p
					; sub_417FC0+CBp

rc		= RECT ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
pt		= POINT	ptr  10h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_0]
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		mov	ebp, [ebx+10h]
		test	esi, esi
		push	edi
		mov	[esp+20h+arg_0], 1
		jz	short loc_4178F1
		mov	edi, [esp+20h+arg_8]

loc_417892:				; CODE XREF: sub_417870+7Fj
		test	ebp, ebp
		jz	short loc_4178F1
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_4178DA
		test	byte ptr [ebp+4], 80h
		jz	short loc_4178DA
		mov	eax, [esi+1Ch]
		mov	ecx, [ebx+20h]
		add	eax, edi
		mov	edx, [esp+20h+pt.y]
		mov	[esp+20h+rc.left], eax
		add	eax, 10h
		mov	[esp+20h+rc.right], eax
		mov	eax, [ebx+18h]
		mov	[esp+20h+rc.top], eax
		mov	eax, [esp+20h+pt.x]
		mov	[esp+20h+rc.bottom], ecx
		push	edx
		lea	ecx, [esp+24h+rc]
		push	eax		; pt
		push	ecx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_4178FB

loc_4178DA:				; CODE XREF: sub_417870+2Bj
					; sub_417870+31j
		mov	edx, [esp+20h+arg_0]
		mov	ecx, [esi+14h]
		mov	esi, [esi]
		mov	ebp, [ebp+0]
		inc	edx
		add	edi, ecx
		test	esi, esi
		mov	[esp+20h+arg_0], edx
		jnz	short loc_417892

loc_4178F1:				; CODE XREF: sub_417870+1Cj
					; sub_417870+24j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_4178FB:				; CODE XREF: sub_417870+68j
		mov	eax, [esp+20h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_417870	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_417910(int, int, int,	POINT pt, int, int)
sub_417910	proc near		; CODE XREF: sub_417910+6Fp
					; sub_4181E0+8Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
pt		= POINT	ptr  10h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		push	edi
		jz	short loc_41799B
		mov	ebx, [esp+10h+arg_18]
		mov	edi, [esp+10h+pt.y]
		mov	ebp, [esp+10h+pt.x]

loc_417928:				; CODE XREF: sub_417910+89j
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		push	edi
		push	ebp		; pt
		push	eax		; int
		push	ecx		; int
		push	esi		; int
		call	sub_417870
		add	esp, 14h
		mov	[ebx], eax
		test	eax, eax
		jnz	short loc_4179AC
		lea	eax, [esi+34h]
		push	edi
		push	ebp		; pt
		push	eax		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_4179BD
		push	edi
		lea	edx, [esi+14h]
		push	ebp		; pt
		push	edx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_4179CE
		test	byte ptr [esi+44h], 4
		jz	short loc_41798B
		mov	eax, [esp+10h+arg_14]
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_4]
		push	ebx		; int
		push	eax		; int
		mov	eax, [esi+8]
		push	edi
		push	ebp		; pt
		push	ecx		; int
		push	edx		; int
		push	eax		; int
		call	sub_417910
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_4179A7

loc_41798B:				; CODE XREF: sub_417910+57j
		mov	ecx, [esi+3Ch]
		mov	eax, [esi+34h]
		cmp	ecx, eax
		jl	short loc_4179DF
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_417928

loc_41799B:				; CODE XREF: sub_417910+Aj
		mov	eax, [esp+10h+arg_14]
		mov	dword ptr [eax], 0
		xor	eax, eax

loc_4179A7:				; CODE XREF: sub_417910+79j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4179AC:				; CODE XREF: sub_417910+31j
		mov	edx, [esp+10h+arg_14]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [edx], 3
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4179BD:				; CODE XREF: sub_417910+41j
		mov	eax, [esp+10h+arg_14]
		pop	edi
		mov	dword ptr [eax], 1
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4179CE:				; CODE XREF: sub_417910+51j
		mov	ecx, [esp+10h+arg_14]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [ecx], 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4179DF:				; CODE XREF: sub_417910+83j
		mov	edx, [esp+10h+arg_14]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [edx], 0
		xor	eax, eax
		pop	ebx
		retn
sub_417910	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4179F0(int, POINT pt,	int)
sub_4179F0	proc near		; CODE XREF: sub_4179F0+45p
					; sub_417C00+3Ep ...

arg_0		= dword	ptr  4
pt		= POINT	ptr  8
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		push	edi
		jz	short loc_417A50
		mov	edi, [esp+10h+pt.y]
		mov	ebp, [esp+10h+pt.x]

loc_417A04:				; CODE XREF: sub_4179F0+5Ej
		lea	ebx, [esi+34h]
		push	edi
		push	ebp		; pt
		push	ebx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_417A61
		push	edi
		lea	eax, [esi+14h]
		push	ebp		; pt
		push	eax		; lprc
		call	ds:PtInRect
		test	eax, eax
		jnz	short loc_417A72
		test	byte ptr [esi+44h], 4
		jz	short loc_417A41
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esi+8]
		push	ecx		; int
		push	edi
		push	ebp		; pt
		push	edx		; int
		call	sub_4179F0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_417A5C

loc_417A41:				; CODE XREF: sub_4179F0+38j
		mov	eax, [esi+3Ch]
		mov	ecx, [ebx]
		cmp	eax, ecx
		jl	short loc_417A83
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_417A04

loc_417A50:				; CODE XREF: sub_4179F0+Aj
		mov	ecx, [esp+10h+arg_C]
		xor	eax, eax
		mov	dword ptr [ecx], 0

loc_417A5C:				; CODE XREF: sub_4179F0+4Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417A61:				; CODE XREF: sub_4179F0+22j
		mov	ecx, [esp+10h+arg_C]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [ecx], 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417A72:				; CODE XREF: sub_4179F0+32j
		mov	edx, [esp+10h+arg_C]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [edx], 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417A83:				; CODE XREF: sub_4179F0+58j
		mov	eax, [esp+10h+arg_C]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 0
		xor	eax, eax
		pop	ebx
		retn
sub_4179F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417AA0	proc near		; CODE XREF: sub_416970+132p
					; sub_416970+221p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, [esp+10h+arg_0]
		xor	ebp, ebp
		cmp	ebx, [edi+0D0h]
		jnz	short loc_417ADE
		mov	esi, [ebx+44h]
		push	ebx
		or	esi, 2
		push	edi
		mov	[ebx+44h], esi
		mov	dword ptr [edi+34h], 1
		call	sub_419940
		add	esp, 8
		mov	eax, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417ADE:				; CODE XREF: sub_417AA0+18j
		test	esi, esi
		jz	loc_417B98

loc_417AE6:				; CODE XREF: sub_417AA0+AEj
		test	ebp, ebp
		jnz	short loc_417B5E
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_417B0A
		test	byte ptr [esi+44h], 4
		jz	short loc_417B0A
		push	ebx
		push	eax
		push	edi
		call	sub_417AA0
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_417B8E

loc_417B0A:				; CODE XREF: sub_417AA0+4Fj
					; sub_417AA0+55j
		cmp	esi, ebx
		jnz	short loc_417B1F
		mov	eax, [edi+0D0h]
		mov	ebp, 1
		mov	[esp+10h+arg_4], eax
		jmp	short loc_417B30
; ---------------------------------------------------------------------------

loc_417B1F:				; CODE XREF: sub_417AA0+6Cj
		cmp	esi, [edi+0D0h]
		jnz	short loc_417B4A
		mov	ebp, 1
		mov	[esp+10h+arg_4], ebx

loc_417B30:				; CODE XREF: sub_417AA0+7Dj
		mov	ecx, [esi+44h]
		push	esi
		or	ecx, 2
		push	edi
		mov	[esi+44h], ecx
		mov	eax, [edi+34h]
		inc	eax
		mov	[edi+34h], eax
		call	sub_419940
		add	esp, 8

loc_417B4A:				; CODE XREF: sub_417AA0+85j
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_417AE6
		test	ebp, ebp
		jz	short loc_417B98
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417B5E:				; CODE XREF: sub_417AA0+48j
		test	esi, esi
		jz	short loc_417B8E

loc_417B62:				; CODE XREF: sub_417AA0+ECj
		test	ebp, ebp
		jz	short loc_417B8E
		cmp	esi, [esp+10h+arg_4]
		jnz	short loc_417B6E
		xor	ebp, ebp

loc_417B6E:				; CODE XREF: sub_417AA0+CAj
		mov	ecx, [esi+44h]
		push	esi
		or	ecx, 2
		push	edi
		mov	[esi+44h], ecx
		mov	eax, [edi+34h]
		inc	eax
		mov	[edi+34h], eax
		call	sub_419940
		mov	esi, [esi]
		add	esp, 8
		test	esi, esi
		jnz	short loc_417B62

loc_417B8E:				; CODE XREF: sub_417AA0+64j
					; sub_417AA0+C0j ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417B98:				; CODE XREF: sub_417AA0+40j
					; sub_417AA0+B2j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_417AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417BA0	proc near		; CODE XREF: sub_417BA0+1Fp
					; sub_417C00+152p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		xor	eax, eax
		test	esi, esi
		jz	short loc_417BF0
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	edi
		mov	edi, [esp+0Ch+arg_0]

loc_417BB5:				; CODE XREF: sub_417BA0+4Cj
		mov	ecx, [esi+8]
		test	ecx, ecx
		jz	short loc_417BC7
		push	ebx
		push	ecx
		push	edi
		call	sub_417BA0
		add	esp, 0Ch

loc_417BC7:				; CODE XREF: sub_417BA0+1Aj
		cmp	esi, ebx
		jz	short loc_417BE8
		mov	ecx, [esi+44h]
		test	ch, 1
		jz	short loc_417BE8
		and	ch, 0FEh
		push	esi
		push	edi
		mov	[esi+44h], ecx
		call	sub_419940
		add	esp, 8
		mov	eax, 1

loc_417BE8:				; CODE XREF: sub_417BA0+29j
					; sub_417BA0+31j
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_417BB5
		pop	edi
		pop	ebx

loc_417BF0:				; CODE XREF: sub_417BA0+9j
		pop	esi
		retn
sub_417BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417C00	proc near		; CODE XREF: sub_417FC0+98p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		mov	eax, [esp+8+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	ebp, eax
		lea	ecx, [esp+14h+arg_0]
		push	edi
		mov	edx, [esi+0C8h]
		and	ebp, 0FFFFh
		shr	eax, 10h
		push	ecx		; int
		push	eax
		xor	edi, edi
		push	ebp		; pt
		push	edx		; int
		mov	[esp+28h+var_8], ebp
		mov	[esp+28h+var_4], eax
		mov	[esi+40h], edi
		mov	[esi+78h], edi
		mov	[esi+7Ch], edi
		mov	[esi+50h], edi
		call	sub_4179F0
		mov	ebx, eax
		mov	eax, [esp+28h+arg_0]
		add	esp, 10h
		cmp	eax, edi
		jz	loc_417DB7
		cmp	[esi+130h], edi
		jnz	loc_417D49
		mov	ecx, [esi+0C8h]
		lea	eax, [esp+18h+arg_4]
		push	eax
		push	ebx
		push	ecx
		mov	[esp+24h+arg_4], edi
		call	sub_419800
		mov	eax, [esi+0F4h]
		mov	ecx, [esp+24h+arg_4]
		mov	ebp, ds:SetTimer
		add	esp, 0Ch
		cmp	ecx, eax
		jnz	short loc_417CE4
		dec	eax
		cmp	eax, edi
		mov	[esi+0F4h], eax
		jge	short loc_417CA0
		mov	[esi+0F4h], edi
		jmp	short loc_417CE4
; ---------------------------------------------------------------------------

loc_417CA0:				; CODE XREF: sub_417C00+96j
		mov	edx, [esi]
		push	edi		; lpTimerFunc
		push	0FAh		; uElapse
		push	459h		; nIDEvent
		push	edx		; hWnd
		call	ebp ; SetTimer
		mov	edx, [esi+44h]
		mov	ecx, [esi+28h]
		or	edx, 1
		lea	eax, [esi+38h]
		mov	[esi+44h], edx
		mov	edx, [esi+4]
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	dword ptr [esi+130h], 2
		mov	[esi+78h], edi
		mov	[esi+7Ch], edi
		mov	dword ptr [esi+40h], 0FFFFFF8Ch
		call	ds:SendMessageA

loc_417CE4:				; CODE XREF: sub_417C00+8Bj
					; sub_417C00+9Ej
		mov	eax, [esi+0F4h]
		mov	ecx, [esi+0F0h]
		mov	edx, [esp+18h+arg_4]
		add	ecx, eax
		cmp	edx, ecx
		jnz	short loc_417D45
		mov	edx, [esi]
		push	edi		; lpTimerFunc
		push	0FAh		; uElapse
		inc	eax
		push	459h		; nIDEvent
		push	edx		; hWnd
		mov	[esi+0F4h], eax
		call	ebp ; SetTimer
		mov	ecx, [esi+44h]
		mov	edx, [esi+4]
		mov	eax, 1
		mov	[esi+78h], edi
		or	ecx, eax
		mov	[esi+130h], eax
		mov	[esi+44h], ecx
		mov	ecx, [esi+28h]
		lea	eax, [esi+38h]
		mov	[esi+7Ch], edi
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	dword ptr [esi+40h], 0FFFFFF8Ch
		call	ds:SendMessageA

loc_417D45:				; CODE XREF: sub_417C00+F8j
		mov	ebp, [esp+18h+var_8]

loc_417D49:				; CODE XREF: sub_417C00+5Aj
		mov	eax, [esi+0C8h]
		push	ebx
		push	eax
		push	esi
		call	sub_417BA0
		mov	ecx, [esi+0C0h]
		add	esp, 0Ch
		push	ecx		; hCursor
		call	ds:SetCursor
		mov	[esi+34h], edi
		mov	eax, [ebx+44h]
		or	ah, 1
		mov	[ebx+44h], eax
		mov	edx, [esi+34h]
		mov	eax, [esi+0CCh]
		inc	edx
		mov	[esi+34h], edx
		mov	[esi+78h], ebx
		mov	edx, [ebx+44h]
		cmp	eax, ebx
		mov	[esi+7Ch], edx
		mov	dword ptr [esi+40h], 0FFFFFF8Eh
		jz	short loc_417DB0
		cmp	eax, edi
		jz	short loc_417DB0
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	eax, [esi+0CCh]
		mov	[esi+50h], eax
		mov	eax, [eax+44h]
		mov	[esi+54h], eax

loc_417DB0:				; CODE XREF: sub_417C00+192j
					; sub_417C00+196j
		mov	ebx, 1
		jmp	short loc_417DFA
; ---------------------------------------------------------------------------

loc_417DB7:				; CODE XREF: sub_417C00+4Ej
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		call	sub_417BA0
		mov	edx, [esi+0C4h]
		add	esp, 0Ch
		push	edx		; hCursor
		call	ds:SetCursor
		mov	eax, [esi+0CCh]
		mov	[esi+0D0h], edi
		cmp	eax, edi
		jz	short loc_417DEB
		mov	[esi+0CCh], edi

loc_417DEB:				; CODE XREF: sub_417C00+1E3j
		mov	[esi+78h], edi
		mov	[esi+7Ch], edi
		mov	dword ptr [esi+40h], 0FFFFFF8Eh
		xor	ebx, ebx

loc_417DFA:				; CODE XREF: sub_417C00+1B5j
		cmp	[esi+40h], edi
		jz	short loc_417E2B
		mov	eax, [esi+44h]
		mov	edx, [esi+28h]
		or	al, 1
		lea	ecx, [esi+38h]
		mov	[esi+44h], eax
		mov	eax, [esp+18h+var_4]
		mov	[esi+9Ch], ebp
		mov	[esi+0A0h], eax
		mov	eax, [esi+4]
		push	ecx		; lParam
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA

loc_417E2B:				; CODE XREF: sub_417C00+1FDj
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_417C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417E40	proc near		; CODE XREF: sub_417FC0+7Bp

Point		= tagPOINT ptr -34h
lParam		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_4]
		sub	esp, 34h
		test	ecx, ecx
		push	ebx
		push	esi
		mov	esi, [esp+3Ch+arg_0]
		push	edi
		jz	loc_417F9D
		mov	eax, [esi+30h]
		test	eax, eax
		jz	loc_417F9D
		mov	edx, [esp+40h+arg_8]
		test	edx, edx
		jnz	short loc_417E8A
		mov	ebx, [ecx+44h]
		test	bh, 2
		jz	loc_417F9D
		mov	eax, [ecx+24h]
		mov	edx, [ecx+28h]
		mov	ecx, [ecx+48h]
		dec	eax
		dec	edx
		mov	[esp+40h+Point.x], eax
		mov	[esp+40h+Point.y], edx
		jmp	short loc_417EE3
; ---------------------------------------------------------------------------

loc_417E8A:				; CODE XREF: sub_417E40+27j
		mov	edi, [ecx+10h]
		cmp	edx, 1
		jle	short loc_417E9A
		lea	eax, [edx-1]

loc_417E95:				; CODE XREF: sub_417E40+58j
		mov	edi, [edi]
		dec	eax
		jnz	short loc_417E95

loc_417E9A:				; CODE XREF: sub_417E40+50j
		mov	eax, [edi+4]
		test	ah, 2
		jz	loc_417F9D
		mov	eax, [esi+0E4h]
		mov	ebx, [esi+0ECh]
		mov	ecx, [ecx+18h]
		sub	eax, ebx
		add	eax, 3
		dec	ecx
		mov	[esp+40h+Point.y], ecx
		mov	ecx, [esi+0DCh]
		cmp	edx, 1
		mov	[esp+40h+Point.x], eax
		jle	short loc_417EDD
		dec	edx

loc_417ECF:				; CODE XREF: sub_417E40+9Bj
		mov	ebx, [ecx+14h]
		add	eax, ebx
		dec	edx
		mov	[esp+40h+Point.x], eax
		mov	ecx, [ecx]
		jnz	short loc_417ECF

loc_417EDD:				; CODE XREF: sub_417E40+8Cj
		mov	ecx, [edi+8]
		mov	ebx, [edi+4]

loc_417EE3:				; CODE XREF: sub_417E40+48j
		mov	edx, [esi+4]
		mov	eax, [esi]
		mov	edi, ds:SendMessageA
		mov	[esp+40h+var_8], ecx
		lea	ecx, [esp+40h+lParam]
		mov	[esp+40h+var_24], edx
		mov	edx, [esi+0Ch]
		push	ecx		; lParam
		push	1		; wParam
		push	411h		; Msg
		push	edx		; hWnd
		mov	[esp+50h+lParam], 2Ch
		mov	[esp+50h+var_28], 0
		mov	[esp+50h+var_20], eax
		call	edi ; SendMessageA
		mov	ecx, [esi]
		lea	eax, [esp+40h+Point]
		push	eax		; lpPoint
		push	ecx		; hWnd
		call	ds:ClientToScreen
		mov	edx, [esp+40h+Point.y]
		mov	eax, [esp+40h+Point.x]
		mov	ecx, [esi+0Ch]
		and	edx, 0FFFFh
		shl	edx, 10h
		and	eax, 0FFFFh
		or	edx, eax
		push	edx		; lParam
		push	0		; wParam
		push	412h		; Msg
		push	ecx		; hWnd
		call	edi ; SendMessageA
		test	bl, 10h
		push	0		; lParam
		jz	short loc_417F63
		mov	edx, [esi+20h]
		mov	eax, [esi+0Ch]
		push	edx
		push	30h
		push	eax
		jmp	short loc_417F6D
; ---------------------------------------------------------------------------

loc_417F63:				; CODE XREF: sub_417E40+115j
		mov	ecx, [esi+1Ch]
		mov	edx, [esi+0Ch]
		push	ecx		; wParam
		push	30h		; Msg
		push	edx		; hWnd

loc_417F6D:				; CODE XREF: sub_417E40+121j
		call	edi ; SendMessageA
		mov	ecx, [esi+0Ch]
		lea	eax, [esp+40h+lParam]
		push	eax		; lParam
		push	0		; wParam
		push	40Ch		; Msg
		push	ecx		; hWnd
		call	edi ; SendMessageA
		mov	edx, [esi]
		push	0		; lpTimerFunc
		push	0FAh		; uElapse
		push	45Ah		; nIDEvent
		push	edx		; hWnd
		call	ds:SetTimer
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 34h
		retn
; ---------------------------------------------------------------------------

loc_417F9D:				; CODE XREF: sub_417E40+10j
					; sub_417E40+1Bj ...
		mov	eax, [esi+0Ch]
		push	0		; lParam
		push	0		; wParam
		push	411h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 34h
		retn
sub_417E40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417FC0	proc near		; CODE XREF: sub_414980+6ADp
					; sub_418550+57p

lParam		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		sub	esp, 0Ch
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		push	edi
		mov	ebp, eax
		mov	edi, eax
		mov	ecx, [esi+128h]
		and	ebp, 0FFFFh
		shr	edi, 10h
		test	bl, 1
		jnz	short loc_41804B
		test	ecx, ecx
		jz	short loc_418003
		push	eax
		push	esi
		call	sub_418140
		add	esp, 8
		mov	dword ptr [esi+128h], 0

loc_418003:				; CODE XREF: sub_417FC0+2Dj
		test	ebx, ebx
		jnz	loc_41812B
		mov	ecx, [esi+0E4h]
		mov	edx, [esi+0DCh]
		lea	eax, [esp+1Ch+arg_0]
		push	eax		; int
		mov	eax, [esi+0C8h]
		push	edi
		mov	edi, [esi+0ECh]
		sub	ecx, edi
		push	ebp		; pt
		push	ecx		; int
		push	edx		; int
		push	eax		; int
		call	sub_4177E0
		mov	ecx, [esp+34h+arg_0]
		push	ecx
		push	eax
		push	esi
		call	sub_417E40
		add	esp, 24h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_41804B:				; CODE XREF: sub_417FC0+29j
		test	ecx, ecx
		mov	bl, 40h
		jz	short loc_418068
		test	[esi+2Ch], bl
		jz	short loc_418068
		push	eax
		push	esi
		call	sub_417C00
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_418068:				; CODE XREF: sub_417FC0+8Fj
					; sub_417FC0+94j
		mov	eax, [esi+0D4h]
		test	eax, eax
		jz	short loc_4180C3
		mov	edx, [esi+0E4h]
		mov	ecx, [esi+0ECh]
		push	edi
		sub	edx, ecx
		mov	ecx, [esi+0DCh]
		push	ebp		; pt
		push	edx		; int
		push	ecx		; int
		push	eax		; int
		call	sub_417870
		add	esp, 14h
		test	eax, eax
		mov	eax, [esi+0D8h]
		mov	ecx, [eax+4]
		jz	short loc_4180A5
		or	ecx, 20h
		jmp	short loc_4180A8
; ---------------------------------------------------------------------------

loc_4180A5:				; CODE XREF: sub_417FC0+DEj
		and	ecx, 0FFFFFFDFh

loc_4180A8:				; CODE XREF: sub_417FC0+E3j
		mov	[eax+4], ecx
		mov	edx, [esi+0D4h]
		push	edx
		push	esi
		call	sub_419940
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_4180C3:				; CODE XREF: sub_417FC0+B0j
		test	ecx, ecx
		jnz	short loc_41812B
		mov	eax, [esi+34h]
		test	eax, eax
		jle	short loc_41812B
		mov	eax, [esi+134h]
		test	eax, eax
		jle	short loc_41812B
		sub	eax, ebp
		cdq
		xor	eax, edx
		sub	eax, edx
		cmp	eax, 2
		jg	short loc_4180F6
		mov	eax, [esi+138h]
		sub	eax, edi
		cdq
		xor	eax, edx
		sub	eax, edx
		cmp	eax, 2
		jle	short loc_41812B

loc_4180F6:				; CODE XREF: sub_417FC0+122j
		mov	ecx, [esi+28h]
		mov	edx, [esi+4]
		lea	eax, [esp+1Ch+lParam]
		mov	dword ptr [esi+128h], 1
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	[esp+2Ch+var_4], 0FFFFFF95h
		call	ds:SendMessageA
		test	[esi+2Ch], bl
		jz	short loc_41812B
		mov	eax, [esi]
		push	eax		; hWnd
		call	ds:SetCapture

loc_41812B:				; CODE XREF: sub_417FC0+45j
					; sub_417FC0+105j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_417FC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418140	proc near		; CODE XREF: sub_414980+65Dp
					; sub_414980+72Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+128h]
		test	eax, eax
		jz	loc_4181D9
		call	ds:ReleaseCapture
		mov	eax, [esi+0BCh]
		push	eax		; hCursor
		call	ds:SetCursor
		test	byte ptr [esi+2Ch], 40h
		jz	short loc_4181D9
		mov	ecx, [esi+0C8h]
		push	0
		push	ecx
		push	esi
		call	sub_417BA0
		mov	eax, [esp+10h+arg_4]
		add	esp, 0Ch
		mov	ecx, eax
		lea	edx, [esi+118h]
		shr	eax, 10h
		and	ecx, 0FFFFh
		push	eax
		push	ecx		; pt
		push	edx		; lprc
		call	ds:PtInRect
		test	eax, eax
		jz	short loc_4181A9
		mov	dword ptr [esi+48h], 1
		jmp	short loc_4181B0
; ---------------------------------------------------------------------------

loc_4181A9:				; CODE XREF: sub_418140+5Ej
		mov	dword ptr [esi+48h], 0

loc_4181B0:				; CODE XREF: sub_418140+67j
		mov	ecx, [esi+28h]
		mov	edx, [esi+4]
		lea	eax, [esi+38h]
		mov	dword ptr [esi+78h], 0
		push	eax		; lParam
		push	ecx		; wParam
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	dword ptr [esi+50h], 0
		mov	dword ptr [esi+40h], 0FFFFFF94h
		call	ds:SendMessageA

loc_4181D9:				; CODE XREF: sub_418140+Dj
					; sub_418140+2Aj
		pop	esi
		retn
sub_418140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4181E0	proc near		; CODE XREF: sub_414980+672p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_8]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		push	edi
		mov	edi, eax
		shr	eax, 10h
		mov	[esp+18h+var_4], eax
		mov	al, [esi+2Ch]
		and	edi, 0FFFFh
		test	al, 20h
		mov	[esp+18h+var_8], edi
		jz	short loc_418211
		xor	eax, eax
		xor	ebp, ebp
		xor	ebx, ebx
		jmp	short loc_418234
; ---------------------------------------------------------------------------

loc_418211:				; CODE XREF: sub_4181E0+27j
		mov	ebp, [esp+18h+arg_4]
		push	10h		; nVirtKey
		and	ebp, 0FFh
		shr	ebp, 3
		and	ebp, 1
		call	ds:GetKeyState
		mov	bx, ax
		shr	ebx, 0Fh
		and	ebx, 1
		xor	eax, eax

loc_418234:				; CODE XREF: sub_4181E0+2Fj
		mov	edx, [esp+18h+var_4]
		mov	[esi+40h], eax
		mov	[esi+78h], eax
		mov	[esi+7Ch], eax
		mov	[esi+50h], eax
		lea	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+arg_8]
		push	eax		; int
		mov	eax, [esi+0E4h]
		push	ecx		; int
		mov	ecx, [esi+0DCh]
		push	edx
		mov	edx, [esi+0ECh]
		push	edi		; pt
		sub	eax, edx
		mov	edx, [esi+0C8h]
		push	eax		; int
		push	ecx		; int
		push	edx		; int
		call	sub_417910
		mov	edi, eax
		mov	eax, [esp+34h+arg_8]
		add	esp, 1Ch
		cmp	eax, 3		; switch 4 cases
		ja	loc_4184A6	; jumptable 00418284 default case
		jmp	ds:off_418538[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_41828B:				; CODE XREF: sub_4181E0+A4j
					; DATA XREF: .text:off_418538o
		xor	edi, edi	; jumptable 00418284 case 0
		cmp	ebp, edi
		jnz	loc_4184F0
		cmp	ebx, edi
		jnz	loc_4184F0
		mov	eax, [esi+0C8h]
		push	edi
		push	eax
		push	esi
		call	sub_415EE0
		mov	eax, [esi+0CCh]
		add	esp, 0Ch
		cmp	eax, edi
		mov	[esi+0D0h], edi
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		jz	loc_4184A6	; jumptable 00418284 default case
		mov	[esi+0CCh], edi
		push	eax
		jmp	loc_41849D
; ---------------------------------------------------------------------------

loc_4182D5:				; CODE XREF: sub_4181E0+A4j
					; DATA XREF: .text:off_418538o
		mov	eax, [edi+44h]	; jumptable 00418284 case 1
		test	al, 4
		jz	short loc_41832D
		mov	ecx, [edi+8]
		push	0
		and	al, 0FBh
		push	ecx
		push	esi
		mov	[edi+44h], eax
		call	sub_415EE0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_41834C
		mov	edx, [esi+0C8h]
		push	0
		push	edx
		push	esi
		call	sub_415EE0
		mov	dword ptr [esi+34h], 1
		mov	eax, [edi+44h]
		add	esp, 0Ch
		or	al, 3
		mov	[edi+44h], eax
		mov	[esi+78h], edi
		mov	eax, [edi+44h]
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		mov	[esi+7Ch], eax
		mov	[esi+0CCh], edi
		jmp	short loc_41834C
; ---------------------------------------------------------------------------

loc_41832D:				; CODE XREF: sub_4181E0+FAj
		or	al, 4
		test	ebp, ebp
		mov	[edi+44h], eax
		jz	short loc_418342
		mov	ecx, [edi+8]
		push	ecx
		call	sub_415F80
		add	esp, 4

loc_418342:				; CODE XREF: sub_4181E0+154j
		push	edi
		push	esi
		call	sub_419850
		add	esp, 8

loc_41834C:				; CODE XREF: sub_4181E0+112j
					; sub_4181E0+14Bj
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect
		jmp	loc_4184A6	; jumptable 00418284 default case
; ---------------------------------------------------------------------------

loc_418363:				; CODE XREF: sub_4181E0+A4j
					; DATA XREF: .text:off_418538o
		mov	ecx, [esp+18h+arg_0] ; jumptable 00418284 case 3
		mov	eax, [esi+0DCh]
		cmp	ecx, 1
		jle	short loc_41837A
		lea	edx, [ecx-1]

loc_418375:				; CODE XREF: sub_4181E0+198j
		mov	eax, [eax]
		dec	edx
		jnz	short loc_418375

loc_41837A:				; CODE XREF: sub_4181E0+190j
		cmp	dword ptr [eax+0Ch], 6
		jnz	short loc_4183AD ; jumptable 00418284 case 2
		mov	[esi+0D4h], edi
		mov	eax, [edi+10h]
		cmp	ecx, 1
		jle	short loc_418394
		dec	ecx

loc_41838F:				; CODE XREF: sub_4181E0+1B2j
		mov	eax, [eax]
		dec	ecx
		jnz	short loc_41838F

loc_418394:				; CODE XREF: sub_4181E0+1ACj
		mov	ecx, [eax+4]
		push	edi
		or	ecx, 20h
		push	esi
		mov	[eax+4], ecx
		mov	[esi+0D8h], eax
		call	sub_419940
		add	esp, 8

loc_4183AD:				; CODE XREF: sub_4181E0+A4j
					; sub_4181E0+19Ej
					; DATA XREF: ...
		mov	ecx, [esi+0Ch]	; jumptable 00418284 case 2
		push	0		; lParam
		push	0		; wParam
		push	411h		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA
		mov	eax, [esi+0D0h]
		test	eax, eax
		jnz	short loc_4183D0
		mov	[esi+0D0h], edi

loc_4183D0:				; CODE XREF: sub_4181E0+1E8j
		test	ebx, ebx
		jnz	short loc_4183DA
		mov	[esi+0D0h], edi

loc_4183DA:				; CODE XREF: sub_4181E0+1F2j
		mov	edx, [esi+0D0h]
		mov	eax, [edi+0Ch]
		cmp	eax, [edx+0Ch]
		jz	loc_4184F8
		test	byte ptr [esi+2Ch], 10h
		jz	loc_4184A6	; jumptable 00418284 default case
		test	ebx, ebx
		jnz	loc_4184A6	; jumptable 00418284 default case

loc_4183FE:				; CODE XREF: sub_4181E0+31Aj
		mov	al, [edi+44h]
		mov	ebx, 2
		test	bl, al
		jnz	short loc_41845E
		test	ebp, ebp
		jnz	short loc_41845E
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		call	sub_415EE0
		mov	[esi+34h], ebp
		mov	ecx, [edi+44h]
		or	ecx, ebx
		push	edi
		mov	[edi+44h], ecx
		mov	eax, [esi+34h]
		inc	eax
		push	esi
		mov	[esi+34h], eax
		call	sub_4198C0
		add	esp, 14h
		test	eax, eax
		jz	short loc_41844E
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect

loc_41844E:				; CODE XREF: sub_4181E0+25Aj
		mov	[esi+78h], edi
		mov	ecx, [edi+44h]
		mov	[esi+7Ch], ecx

loc_418457:				; CODE XREF: sub_4181E0+350j
		mov	dword ptr [esi+40h], 0FFFFFF9Ah

loc_41845E:				; CODE XREF: sub_4181E0+228j
					; sub_4181E0+22Cj
		mov	eax, [esi+0CCh]
		cmp	eax, edi
		jz	short loc_41849C
		test	eax, eax
		jz	short loc_41848E
		mov	ebx, [eax+44h]
		and	ebx, 0FFFFFFFEh
		mov	[eax+44h], ebx
		mov	eax, [esi+0CCh]
		mov	[esi+50h], eax
		push	eax
		mov	edx, [eax+44h]
		push	esi
		mov	[esi+54h], edx
		call	sub_419940
		add	esp, 8

loc_41848E:				; CODE XREF: sub_4181E0+28Aj
		mov	eax, [edi+44h]
		or	al, 1
		mov	[edi+44h], eax
		mov	[esi+0CCh], edi

loc_41849C:				; CODE XREF: sub_4181E0+286j
		push	edi

loc_41849D:				; CODE XREF: sub_4181E0+F0j
		push	esi
		call	sub_419940
		add	esp, 8

loc_4184A6:				; CODE XREF: sub_4181E0+9Ej
					; sub_4181E0+E3j ...
		mov	eax, [esi+40h]	; jumptable 00418284 default case
		test	eax, eax
		jz	short loc_4184F0
		mov	edi, [esi+44h]
		mov	edx, [esi+34h]
		mov	ecx, 1
		or	edi, ecx
		cmp	edx, ecx
		mov	[esi+44h], edi
		mov	eax, edi
		jle	short loc_4184C8
		or	al, 80h
		mov	[esi+44h], eax

loc_4184C8:				; CODE XREF: sub_4181E0+2E1j
		mov	eax, [esp+18h+var_8]
		mov	ecx, [esp+18h+var_4]
		mov	[esi+9Ch], eax
		mov	eax, [esi+28h]
		lea	edx, [esi+38h]
		mov	[esi+0A0h], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA

loc_4184F0:				; CODE XREF: sub_4181E0+AFj
					; sub_4181E0+B7j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_4184F8:				; CODE XREF: sub_4181E0+206j
		test	ebx, ebx
		jz	loc_4183FE
		mov	ecx, [esi+0C8h]
		push	0
		push	ecx
		push	esi
		call	sub_415EE0
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		mov	dword ptr [esi+34h], 0
		call	sub_417AA0
		mov	[esi+78h], edi
		mov	eax, [edi+44h]
		add	esp, 18h
		mov	[esi+7Ch], eax
		jmp	loc_418457
sub_4181E0	endp

; ---------------------------------------------------------------------------
		align 4
off_418538	dd offset loc_41828B	; DATA XREF: sub_4181E0+A4r
		dd offset loc_4182D5	; jump table for switch	statement
		dd offset loc_4183AD
		dd offset loc_418363
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418550	proc near		; CODE XREF: sub_414980+5FBp

Point		= tagPOINT ptr -8
arg_0		= dword	ptr  4

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+128h]
		mov	dword ptr [esi+130h], 0
		test	eax, eax
		jz	short loc_4185AF
		test	byte ptr [esi+2Ch], 40h
		jz	short loc_4185AF
		lea	eax, [esp+0Ch+Point]
		push	eax		; lpPoint
		call	ds:GetCursorPos
		mov	edx, [esi]
		lea	ecx, [esp+0Ch+Point]
		push	ecx		; lpPoint
		push	edx		; hWnd
		call	ds:ScreenToClient
		mov	eax, [esp+0Ch+Point.y]
		mov	ecx, [esp+0Ch+Point.x]
		and	eax, 0FFFFh
		and	ecx, 0FFFFh
		shl	eax, 10h
		or	eax, ecx
		push	eax
		push	1
		push	esi
		call	sub_417FC0
		add	esp, 0Ch

loc_4185AF:				; CODE XREF: sub_418550+1Aj
					; sub_418550+20j
		pop	esi
		add	esp, 8
		retn
sub_418550	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4185C0	proc near		; CODE XREF: sub_414980+995p

var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_C]
		push	edi
		mov	ebx, eax
		lea	edx, [esp+1Ch+arg_0]
		push	ecx		; int
		mov	ecx, [esi+0DCh]
		push	edx		; int
		mov	edx, [esi+0ECh]
		and	ebx, 0FFFFh
		shr	eax, 10h
		mov	[esp+24h+var_4], eax
		push	eax
		mov	eax, [esi+0E4h]
		push	ebx		; pt
		sub	eax, edx
		mov	edx, [esi+0C8h]
		push	eax		; int
		xor	ebp, ebp
		push	ecx		; int
		push	edx		; int
		mov	[esi+40h], ebp
		mov	[esi+78h], ebp
		mov	[esi+7Ch], ebp
		mov	[esi+50h], ebp
		call	sub_417910
		mov	edi, eax
		mov	eax, [esp+38h+arg_0]
		add	esp, 1Ch
		cmp	eax, ebp
		jz	loc_418756
		cmp	[esi+130h], ebp
		jnz	loc_4186E8
		mov	ecx, [esi+0C8h]
		lea	eax, [esp+1Ch+arg_4]
		push	eax
		push	edi
		push	ecx
		mov	[esp+28h+arg_4], ebp
		call	sub_419800
		mov	eax, [esi+0F4h]
		mov	ecx, [esp+28h+arg_4]
		add	esp, 0Ch
		cmp	ecx, eax
		jnz	short loc_41866F
		dec	eax
		cmp	eax, ebp
		mov	[esi+0F4h], eax
		jge	short loc_4186B8
		mov	[esi+0F4h], ebp

loc_41866F:				; CODE XREF: sub_4185C0+9Cj
		mov	eax, [esi+0F4h]
		mov	edx, [esi+0F0h]
		add	edx, eax
		cmp	ecx, edx
		jnz	short loc_4186E8
		inc	eax
		push	ebp		; lpTimerFunc
		mov	[esi+0F4h], eax
		mov	eax, [esi]
		push	0FAh		; uElapse
		push	459h		; nIDEvent
		push	eax		; hWnd
		call	ds:SetTimer
		mov	dword ptr [esi+130h], 1
		mov	[esi+78h], ebp
		mov	[esi+7Ch], ebp
		mov	dword ptr [esi+40h], 0FFFFFF8Ch
		jmp	loc_418790
; ---------------------------------------------------------------------------

loc_4186B8:				; CODE XREF: sub_4185C0+A7j
		mov	edx, [esi]
		push	ebp		; lpTimerFunc
		push	0FAh		; uElapse
		push	459h		; nIDEvent
		push	edx		; hWnd
		call	ds:SetTimer
		mov	dword ptr [esi+130h], 2
		mov	[esi+78h], ebp
		mov	[esi+7Ch], ebp
		mov	dword ptr [esi+40h], 0FFFFFF8Ch
		jmp	loc_418790
; ---------------------------------------------------------------------------

loc_4186E8:				; CODE XREF: sub_4185C0+71j
					; sub_4185C0+BFj
		mov	[esi+0D0h], edi
		mov	al, [edi+44h]
		test	al, 2
		jnz	short loc_418729
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		call	sub_415EE0
		mov	[esi+34h], ebp
		mov	ecx, [edi+44h]
		or	ecx, 2
		add	esp, 0Ch
		mov	[edi+44h], ecx
		mov	eax, [esi+34h]
		inc	eax
		mov	[esi+78h], edi
		mov	[esi+34h], eax
		mov	edx, [edi+44h]
		mov	[esi+7Ch], edx
		mov	dword ptr [esi+40h], 0FFFFFF8Eh

loc_418729:				; CODE XREF: sub_4185C0+133j
		mov	eax, [esi+0CCh]
		cmp	eax, edi
		jz	short loc_41874F
		cmp	eax, ebp
		jz	short loc_41874F
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	eax, [esi+0CCh]
		mov	[esi+50h], eax
		mov	eax, [eax+44h]
		mov	[esi+54h], eax

loc_41874F:				; CODE XREF: sub_4185C0+171j
					; sub_4185C0+175j
		mov	edi, 1
		jmp	short loc_418792
; ---------------------------------------------------------------------------

loc_418756:				; CODE XREF: sub_4185C0+65j
		mov	ecx, [esi+0C8h]
		push	ebp
		push	ecx
		push	esi
		mov	[esi+130h], ebp
		call	sub_415EE0
		mov	eax, [esi+0CCh]
		add	esp, 0Ch
		cmp	eax, ebp
		mov	[esi+0D0h], ebp
		jz	short loc_418783
		mov	[esi+0CCh], ebp

loc_418783:				; CODE XREF: sub_4185C0+1BBj
		mov	[esi+78h], ebp
		mov	[esi+7Ch], ebp
		mov	dword ptr [esi+40h], 0FFFFFF8Eh

loc_418790:				; CODE XREF: sub_4185C0+F3j
					; sub_4185C0+123j
		xor	edi, edi

loc_418792:				; CODE XREF: sub_4185C0+194j
		cmp	[esi+40h], ebp
		jz	short loc_4187C4
		mov	edx, [esp+1Ch+var_4]
		mov	ecx, [esi+28h]
		mov	ebp, [esi+44h]
		lea	eax, [esi+38h]
		mov	[esi+9Ch], ebx
		mov	[esi+0A0h], edx
		mov	edx, [esi+4]
		push	eax		; lParam
		push	ecx		; wParam
		or	ebp, 1
		push	4Eh		; Msg
		push	edx		; hWnd
		mov	[esi+44h], ebp
		call	ds:SendMessageA

loc_4187C4:				; CODE XREF: sub_4185C0+1D5j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_4185C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4187D0	proc near		; CODE XREF: sub_414980+742p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_8]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		push	edi
		mov	edi, eax
		shr	eax, 10h
		mov	[esp+18h+var_4], eax
		mov	al, [esi+2Ch]
		and	edi, 0FFFFh
		test	al, 20h
		mov	[esp+18h+var_8], edi
		jz	short loc_418801
		xor	eax, eax
		xor	ebp, ebp
		xor	ebx, ebx
		jmp	short loc_418824
; ---------------------------------------------------------------------------

loc_418801:				; CODE XREF: sub_4187D0+27j
		mov	ebp, [esp+18h+arg_4]
		push	10h		; nVirtKey
		and	ebp, 0FFh
		shr	ebp, 3
		and	ebp, 1
		call	ds:GetKeyState
		mov	bx, ax
		shr	ebx, 0Fh
		and	ebx, 1
		xor	eax, eax

loc_418824:				; CODE XREF: sub_4187D0+2Fj
		mov	edx, [esp+18h+var_4]
		mov	[esi+40h], eax
		mov	[esi+78h], eax
		mov	[esi+7Ch], eax
		mov	[esi+50h], eax
		lea	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+arg_8]
		push	eax		; int
		mov	eax, [esi+0E4h]
		push	ecx		; int
		mov	ecx, [esi+0DCh]
		push	edx
		mov	edx, [esi+0ECh]
		push	edi		; pt
		sub	eax, edx
		mov	edx, [esi+0C8h]
		push	eax		; int
		push	ecx		; int
		push	edx		; int
		call	sub_417910
		mov	edi, eax
		mov	eax, [esp+34h+arg_8]
		add	esp, 1Ch
		sub	eax, 2
		jz	short loc_41889F
		dec	eax
		jnz	loc_4189F8
		cmp	edi, [esi+0D4h]
		jnz	loc_4189F8
		mov	ecx, [esp+18h+arg_0]
		mov	[esi+78h], edi
		mov	eax, [edi+44h]
		mov	dword ptr [esi+40h], 0FFFFFF98h
		mov	[esi+7Ch], eax
		mov	[esi+48h], ecx
		jmp	loc_4189F8
; ---------------------------------------------------------------------------

loc_41889F:				; CODE XREF: sub_4187D0+9Ej
		mov	eax, [esi+0D0h]
		test	eax, eax
		jnz	short loc_4188AF
		mov	[esi+0D0h], edi

loc_4188AF:				; CODE XREF: sub_4187D0+D7j
		test	ebx, ebx
		jnz	short loc_4188B9
		mov	[esi+0D0h], edi

loc_4188B9:				; CODE XREF: sub_4187D0+E1j
		mov	edx, [esi+0D0h]
		mov	eax, [edi+0Ch]
		cmp	eax, [edx+0Ch]
		jz	short loc_4188DB
		test	byte ptr [esi+2Ch], 10h
		jz	loc_4189F8
		test	ebx, ebx
		jnz	loc_4189F8
		jmp	short loc_4188E3
; ---------------------------------------------------------------------------

loc_4188DB:				; CODE XREF: sub_4187D0+F5j
		test	ebx, ebx
		jnz	loc_4189AF

loc_4188E3:				; CODE XREF: sub_4187D0+109j
		mov	eax, [edi+44h]
		test	al, 2
		jz	short loc_418964
		test	ebp, ebp
		jz	short loc_418912
		and	al, 0FDh
		push	edi
		mov	[edi+44h], eax
		mov	ebx, [esi+34h]
		dec	ebx
		push	esi
		mov	[esi+34h], ebx
		call	sub_419940
		mov	[esi+78h], edi
		mov	ecx, [edi+44h]
		add	esp, 8
		mov	[esi+7Ch], ecx
		jmp	loc_4189A8
; ---------------------------------------------------------------------------

loc_418912:				; CODE XREF: sub_4187D0+11Cj
		mov	edx, [esi+0C8h]
		push	edi
		push	edx
		push	esi
		call	sub_415EE0
		mov	eax, [edi+44h]
		push	edi
		or	al, 2
		push	esi
		mov	[edi+44h], eax
		mov	dword ptr [esi+34h], 1
		call	sub_4198C0
		add	esp, 14h
		test	eax, eax
		jz	short loc_41894F
		mov	ecx, [esi]
		lea	eax, [esi+118h]
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect

loc_41894F:				; CODE XREF: sub_4187D0+16Bj
		mov	[esi+78h], edi
		mov	edx, [edi+44h]
		mov	[esi+7Ch], edx
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		jmp	loc_4189F8
; ---------------------------------------------------------------------------

loc_418964:				; CODE XREF: sub_4187D0+118j
		test	ebp, ebp
		jz	loc_4189F8
		or	al, 2
		push	edi
		mov	[edi+44h], eax
		mov	ebx, [esi+34h]
		inc	ebx
		push	esi
		mov	[esi+34h], ebx
		call	sub_419940
		push	edi
		push	esi
		call	sub_4198C0
		add	esp, 10h
		test	eax, eax
		jz	short loc_41899F
		mov	ecx, [esi]
		lea	eax, [esi+118h]
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect

loc_41899F:				; CODE XREF: sub_4187D0+1BBj
		mov	[esi+78h], edi
		mov	edx, [edi+44h]
		mov	[esi+7Ch], edx

loc_4189A8:				; CODE XREF: sub_4187D0+13Dj
		mov	dword ptr [esi+40h], 0FFFFFF9Ah

loc_4189AF:				; CODE XREF: sub_4187D0+10Dj
		mov	eax, [esi+0CCh]
		cmp	eax, edi
		jz	short loc_4189F8
		test	eax, eax
		jz	short loc_4189DF
		mov	ebx, [eax+44h]
		and	ebx, 0FFFFFFFEh
		mov	[eax+44h], ebx
		mov	eax, [esi+0CCh]
		mov	[esi+50h], eax
		push	eax
		mov	ecx, [eax+44h]
		push	esi
		mov	[esi+54h], ecx
		call	sub_419940
		add	esp, 8

loc_4189DF:				; CODE XREF: sub_4187D0+1EBj
		mov	ebx, [edi+44h]
		push	edi
		or	ebx, 1
		push	esi
		mov	[edi+44h], ebx
		mov	[esi+0CCh], edi
		call	sub_419940
		add	esp, 8

loc_4189F8:				; CODE XREF: sub_4187D0+A1j
					; sub_4187D0+ADj ...
		mov	eax, [esi+0D4h]
		test	eax, eax
		jz	short loc_418A2B
		mov	eax, [esi+0D8h]
		mov	ebx, [eax+4]
		and	ebx, 0FFFFFFDFh
		mov	[eax+4], ebx
		mov	edx, [esi+0D4h]
		push	edx
		push	esi
		call	sub_419940
		add	esp, 8
		mov	dword ptr [esi+0D4h], 0

loc_418A2B:				; CODE XREF: sub_4187D0+230j
		mov	eax, [esi+40h]
		test	eax, eax
		jz	short loc_418A75
		mov	edi, [esi+44h]
		mov	edx, [esi+34h]
		mov	ecx, 1
		or	edi, ecx
		cmp	edx, ecx
		mov	[esi+44h], edi
		mov	eax, edi
		jle	short loc_418A4D
		or	al, 80h
		mov	[esi+44h], eax

loc_418A4D:				; CODE XREF: sub_4187D0+276j
		mov	eax, [esp+18h+var_8]
		mov	ecx, [esp+18h+var_4]
		mov	[esi+9Ch], eax
		mov	eax, [esi+28h]
		lea	edx, [esi+38h]
		mov	[esi+0A0h], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		call	ds:SendMessageA

loc_418A75:				; CODE XREF: sub_4187D0+260j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_4187D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418A80	proc near		; CODE XREF: sub_414980+7DBp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		mov	eax, [esp+8+arg_8]
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	ebp, eax
		lea	ecx, [esp+14h+arg_8]
		mov	edx, [esi+0C8h]
		push	edi
		shr	eax, 10h
		and	ebp, 0FFFFh
		and	ebx, 0FFh
		push	ecx		; int
		push	eax
		shr	ebx, 3
		push	ebp		; pt
		push	edx		; int
		mov	[esp+28h+var_4], eax
		and	ebx, 1
		call	sub_4179F0
		mov	edi, eax
		mov	eax, [esp+28h+arg_8]
		add	esp, 10h
		dec	eax
		jz	loc_418B85
		dec	eax
		jnz	loc_418BC4
		mov	ecx, [edi+8]
		test	ecx, ecx
		jz	short loc_418B3B
		mov	eax, [edi+44h]
		test	al, 4
		jz	short loc_418B05
		and	al, 0FBh
		push	1		; bErase
		mov	[edi+44h], eax
		mov	ecx, [esi]
		lea	eax, [esi+118h]
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_418B05:				; CODE XREF: sub_418A80+64j
		or	al, 4
		test	ebx, ebx
		mov	[edi+44h], eax
		jz	short loc_418B17
		push	ecx
		call	sub_415F80
		add	esp, 4

loc_418B17:				; CODE XREF: sub_418A80+8Cj
		push	edi
		push	esi
		call	sub_419850
		mov	ecx, [esi]
		add	esp, 8
		lea	eax, [esi+118h]
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_418B3B:				; CODE XREF: sub_418A80+5Dj
		mov	eax, [esp+18h+var_4]
		mov	dword ptr [esi+50h], 0
		mov	[esi+78h], edi
		mov	edx, [edi+44h]
		mov	[esi+7Ch], edx
		mov	edx, [esi+28h]
		lea	ecx, [esi+38h]
		mov	[esi+9Ch], ebp
		mov	[esi+0A0h], eax
		mov	eax, [esi+4]
		push	ecx		; lParam
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		mov	dword ptr [esi+44h], 1
		mov	dword ptr [esi+40h], 0FFFFFF97h
		call	ds:SendMessageA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_418B85:				; CODE XREF: sub_418A80+4Bj
		mov	eax, [edi+44h]
		test	al, 4
		jz	short loc_418B93
		and	al, 0FBh
		mov	[edi+44h], eax
		jmp	short loc_418BB2
; ---------------------------------------------------------------------------

loc_418B93:				; CODE XREF: sub_418A80+10Aj
		or	al, 4
		test	ebx, ebx
		mov	[edi+44h], eax
		jz	short loc_418BA8
		mov	ecx, [edi+8]
		push	ecx
		call	sub_415F80
		add	esp, 4

loc_418BA8:				; CODE XREF: sub_418A80+11Aj
		push	edi
		push	esi
		call	sub_419850
		add	esp, 8

loc_418BB2:				; CODE XREF: sub_418A80+111j
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect

loc_418BC4:				; CODE XREF: sub_418A80+52j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_418A80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418BD0	proc near		; CODE XREF: sub_414980+7A2p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	al, byte ptr [esp+arg_4]
		sub	esp, 8
		test	al, 8
		push	ebp
		push	esi
		jnz	loc_418D5F
		push	10h		; nVirtKey
		call	ds:GetKeyState
		test	ah, 80h
		jnz	loc_418D5F
		mov	eax, [esp+10h+arg_8]
		mov	esi, [esp+10h+arg_0]
		push	ebx
		mov	ebp, eax
		mov	edx, [esi+0C8h]
		lea	ecx, [esp+14h+arg_4]
		push	edi
		and	ebp, 0FFFFh
		shr	eax, 10h
		push	ecx		; int
		push	eax
		xor	ebx, ebx
		push	ebp		; pt
		push	edx		; int
		mov	[esp+28h+var_4], eax
		mov	[esi+44h], ebx
		mov	[esi+78h], ebx
		mov	[esi+50h], ebx
		call	sub_4179F0
		mov	edi, eax
		mov	eax, [esp+28h+arg_4]
		add	esp, 10h
		sub	eax, ebx
		jz	loc_418CE6
		sub	eax, 2
		jnz	loc_418D20
		mov	eax, [esi+0Ch]
		push	ebx		; lParam
		push	ebx		; wParam
		push	411h		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		test	byte ptr [edi+44h], 2
		jnz	short loc_418CA9
		mov	ecx, [esi+0C8h]
		push	edi
		push	ecx
		push	esi
		call	sub_415EE0
		mov	edx, [edi+44h]
		push	edi
		or	edx, 2
		push	esi
		mov	[edi+44h], edx
		mov	dword ptr [esi+34h], 1
		call	sub_4198C0
		add	esp, 14h
		test	eax, eax
		jz	short loc_418C98
		mov	eax, [esi]
		lea	edx, [esi+118h]
		push	1		; bErase
		push	edx		; lpRect
		push	eax		; hWnd
		call	ds:InvalidateRect

loc_418C98:				; CODE XREF: sub_418BD0+B4j
		mov	eax, [esi+44h]
		mov	[esi+78h], edi
		mov	ecx, [edi+44h]
		or	al, 1
		mov	[esi+7Ch], ecx
		mov	[esi+44h], eax

loc_418CA9:				; CODE XREF: sub_418BD0+88j
		mov	eax, [esi+0CCh]
		cmp	eax, ebx
		jz	short loc_418CD5
		mov	ecx, [eax+44h]
		and	ecx, 0FFFFFFFEh
		mov	[eax+44h], ecx
		mov	eax, [esi+0CCh]
		mov	[esi+50h], eax
		push	eax
		mov	edx, [eax+44h]
		push	esi
		mov	[esi+54h], edx
		call	sub_419940
		add	esp, 8

loc_418CD5:				; CODE XREF: sub_418BD0+E1j
		mov	eax, [edi+44h]
		push	edi
		or	al, 1
		mov	[edi+44h], eax
		mov	[esi+0CCh], edi
		jmp	short loc_418D17
; ---------------------------------------------------------------------------

loc_418CE6:				; CODE XREF: sub_418BD0+64j
		mov	eax, [esi+0C8h]
		push	ebx
		push	eax
		push	esi
		call	sub_415EE0
		mov	edx, [esi+44h]
		mov	eax, [esi+0CCh]
		add	esp, 0Ch
		or	edx, 1
		cmp	eax, ebx
		mov	[esi+0D0h], ebx
		mov	[esi+44h], edx
		jz	short loc_418D20
		mov	[esi+0CCh], ebx
		push	eax

loc_418D17:				; CODE XREF: sub_418BD0+114j
		push	esi
		call	sub_419940
		add	esp, 8

loc_418D20:				; CODE XREF: sub_418BD0+6Dj
					; sub_418BD0+13Ej
		mov	eax, [esi+44h]
		pop	edi
		cmp	eax, ebx
		pop	ebx
		jz	short loc_418D5F
		cmp	dword ptr [esi+34h], 1
		jle	short loc_418D34
		or	al, 80h
		mov	[esi+44h], eax

loc_418D34:				; CODE XREF: sub_418BD0+15Dj
		mov	ecx, [esp+10h+var_4]
		mov	eax, [esi+28h]
		lea	edx, [esi+38h]
		mov	[esi+9Ch], ebp
		mov	[esi+0A0h], ecx
		mov	ecx, [esi+4]
		push	edx		; lParam
		push	eax		; wParam
		push	4Eh		; Msg
		push	ecx		; hWnd
		mov	dword ptr [esi+40h], 0FFFFFF9Ah
		call	ds:SendMessageA

loc_418D5F:				; CODE XREF: sub_418BD0+Bj
					; sub_418BD0+1Cj ...
		pop	esi
		pop	ebp
		add	esp, 8
		retn
sub_418BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418D70	proc near		; CODE XREF: sub_418EB0+32p

lParam		= dword	ptr -2Ch
var_28		= dword	ptr -28h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+34h+arg_4]
		push	esi
		push	edi
		mov	eax, [ebp+10h]
		test	eax, eax
		jnz	loc_418E9C
		mov	esi, [esp+3Ch+arg_0]
		mov	ebx, [ebp+0Ch]
		test	ebx, ebx
		mov	edx, [esi+0E4h]
		mov	edi, edx
		jnz	short loc_418DAB
		mov	eax, [ebp+14h]
		mov	eax, [eax+4]
		mov	edi, eax
		mov	[esi+0E4h], eax
		sub	edi, edx
		jmp	short loc_418DF1
; ---------------------------------------------------------------------------

loc_418DAB:				; CODE XREF: sub_418D70+27j
		mov	ecx, [esi+0DCh]
		mov	eax, [ecx+14h]
		add	edi, eax
		cmp	ebx, 1
		jle	short loc_418DC8
		dec	ebx

loc_418DBC:				; CODE XREF: sub_418D70+56j
		mov	ecx, [ecx]
		add	edx, eax
		mov	eax, [ecx+14h]
		add	edi, eax
		dec	ebx
		jnz	short loc_418DBC

loc_418DC8:				; CODE XREF: sub_418D70+49j
		mov	edx, [ebp+14h]
		mov	ebx, [ecx+14h]
		mov	eax, [edx+4]
		mov	edi, eax
		mov	[ecx+14h], eax
		sub	edi, ebx
		cmp	eax, 10h
		jl	short loc_418DEA
		sub	eax, 10h
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ecx+1Ch], eax
		jmp	short loc_418DF1
; ---------------------------------------------------------------------------

loc_418DEA:				; CODE XREF: sub_418D70+6Bj
		mov	dword ptr [ecx+1Ch], 0

loc_418DF1:				; CODE XREF: sub_418D70+39j
					; sub_418D70+78j
		mov	ecx, [esi+0E4h]
		mov	eax, [esi+0DCh]
		mov	[esi+0E8h], ecx
		mov	ecx, [esi+0E0h]
		cmp	ecx, 1
		jle	short loc_418E25
		dec	ecx

loc_418E0F:				; CODE XREF: sub_418D70+B3j
		mov	edx, [eax+14h]
		mov	ebx, [esi+0E8h]
		add	ebx, edx
		dec	ecx
		mov	[esi+0E8h], ebx
		mov	eax, [eax]
		jnz	short loc_418E0F

loc_418E25:				; CODE XREF: sub_418D70+9Cj
		mov	eax, [ebp+14h]
		mov	[esp+3Ch+lParam], 1
		lea	edx, [esp+3Ch+lParam]
		mov	ecx, [eax+4]
		mov	eax, [ebp+0Ch]
		mov	ebp, ds:SendMessageA
		mov	[esp+3Ch+var_28], ecx
		mov	ecx, [esi+8]
		push	edx		; lParam
		push	eax		; wParam
		push	1204h		; Msg
		push	ecx		; hWnd
		call	ebp ; SendMessageA
		mov	edx, [esi]
		lea	ebx, [esi+118h]
		push	0		; bErase
		push	ebx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect
		test	edi, edi
		jge	short loc_418E9C
		mov	eax, [esi+0ECh]
		test	eax, eax
		jle	short loc_418E9C
		add	eax, edi
		test	eax, eax
		jge	short loc_418E79
		xor	eax, eax

loc_418E79:				; CODE XREF: sub_418D70+105j
		and	eax, 0FFFFh
		push	0		; lParam
		shl	eax, 10h
		or	al, 4
		push	eax		; wParam
		mov	eax, [esi]
		push	114h		; Msg
		push	eax		; hWnd
		call	ebp ; SendMessageA
		mov	ecx, [esi]
		push	1		; bErase
		push	ebx		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect

loc_418E9C:				; CODE XREF: sub_418D70+10j
					; sub_418D70+F5j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 2Ch
		retn
sub_418D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418EB0	proc near		; CODE XREF: sub_414980+489p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		add	ecx, 137h	; switch 10 cases
		cmp	ecx, 9
		ja	loc_418F4F	; jumptable 00418ECE default case
		xor	edx, edx
		mov	dl, ds:byte_418F68[ecx]
		jmp	ds:off_418F54[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_418ED5:				; CODE XREF: sub_418EB0+1Ej
					; DATA XREF: .text:off_418F54o
		mov	ecx, [eax+10h]	; jumptable 00418ECE cases -308,-307
		test	ecx, ecx
		jnz	short loc_418F4F ; jumptable 00418ECE default case
		push	eax
		mov	eax, [esp+4+arg_0]
		push	eax
		call	sub_418D70
		add	esp, 8
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_418EED:				; CODE XREF: sub_418EB0+1Ej
					; DATA XREF: .text:off_418F54o
		mov	ecx, [eax+10h]	; jumptable 00418ECE case -302
		test	ecx, ecx
		jnz	short loc_418F4F ; jumptable 00418ECE default case
		mov	ecx, [esp+arg_0]
		mov	dword ptr [ecx+40h], 0FFFFFF99h
		mov	edx, [eax+0Ch]
		mov	[ecx+48h], edx
		mov	edx, [ecx+28h]
		lea	eax, [ecx+38h]
		push	eax		; lParam
		mov	eax, [ecx+4]
		push	edx		; wParam
		push	4Eh		; Msg
		push	eax		; hWnd
		call	ds:SendMessageA
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_418F1C:				; CODE XREF: sub_418EB0+1Ej
					; DATA XREF: .text:off_418F54o
		mov	ecx, [eax+0Ch]	; jumptable 00418ECE case -311
		test	ecx, ecx
		jnz	short loc_418F29
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_418F29:				; CODE XREF: sub_418EB0+71j
		mov	ecx, [eax+14h]
		mov	eax, [ecx+20h]
		test	eax, eax
		jnz	short loc_418F39
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_418F39:				; CODE XREF: sub_418EB0+81j
		mov	edx, [esp+arg_0]
		push	0		; lpTimerFunc
		push	0Ah		; uElapse
		push	458h		; nIDEvent
		mov	eax, [edx]
		push	eax		; hWnd
		call	ds:SetTimer

loc_418F4F:				; CODE XREF: sub_418EB0+10j
					; sub_418EB0+1Ej ...
		xor	eax, eax	; jumptable 00418ECE default case
		retn
sub_418EB0	endp

; ---------------------------------------------------------------------------
		align 4
off_418F54	dd offset loc_418F1C	; DATA XREF: sub_418EB0+1Er
		dd offset loc_418F4F	; jump table for switch	statement
		dd offset loc_418ED5
		dd offset loc_418EED
		dd offset loc_418F4F
byte_418F68	db	0,     1,     4,     2 ; DATA XREF: sub_418EB0+18r
		db	2,     4,     4,     4 ; indirect table	for switch statement
		db	4,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418F80	proc near		; CODE XREF: sub_414980+6DDp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	ecx, [esi+120h]
		mov	eax, [esi+118h]
		mov	edi, [esi+0ECh]
		sub	ecx, eax
		cmp	edx, 7		; switch 8 cases
		mov	eax, edi
		ja	short loc_419012 ; jumptable 00418FA5 default case
		jmp	ds:off_419018[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_418FAC:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		mov	eax, [esi+0E8h]	; jumptable 00418FA5 case 7
		sub	eax, ecx
		jmp	short loc_418FE2
; ---------------------------------------------------------------------------

loc_418FB6:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		sub	eax, ecx	; jumptable 00418FA5 case 2
		jns	short loc_418FE2
		xor	eax, eax
		jmp	short loc_418FE2
; ---------------------------------------------------------------------------

loc_418FBE:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		add	eax, ecx	; jumptable 00418FA5 case 3
		jmp	short loc_418FCE
; ---------------------------------------------------------------------------

loc_418FC2:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		sub	eax, 3		; jumptable 00418FA5 case 0
		jns	short loc_418FE2

loc_418FC7:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		xor	eax, eax	; jumptable 00418FA5 case 6
		jmp	short loc_418FE2
; ---------------------------------------------------------------------------

loc_418FCB:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		add	eax, 3		; jumptable 00418FA5 case 1

loc_418FCE:				; CODE XREF: sub_418F80+40j
		mov	edx, [esi+0E8h]
		sub	edx, ecx
		cmp	eax, edx
		jle	short loc_418FE2
		mov	eax, edx
		jmp	short loc_418FE2
; ---------------------------------------------------------------------------

loc_418FDE:				; CODE XREF: sub_418F80+25j
					; DATA XREF: .text:off_419018o
		mov	eax, [esp+8+arg_8] ; jumptable 00418FA5	cases 4,5

loc_418FE2:				; CODE XREF: sub_418F80+34j
					; sub_418F80+38j ...
		sub	edi, eax
		mov	[esi+0ECh], eax
		mov	ecx, edi
		jz	short loc_419012 ; jumptable 00418FA5 default case
		push	3		; flags
		push	0		; prcUpdate
		lea	eax, [esi+108h]
		push	0		; hrgnUpdate
		push	eax		; prcClip
		push	0		; prcScroll
		push	0		; dy
		push	ecx		; dx
		mov	ecx, [esi]
		push	ecx		; hWnd
		call	ds:ScrollWindowEx
		mov	edx, [esi]
		push	edx		; hWnd
		call	ds:UpdateWindow

loc_419012:				; CODE XREF: sub_418F80+23j
					; sub_418F80+6Cj
		pop	edi		; jumptable 00418FA5 default case
		pop	esi
		retn
sub_418F80	endp

; ---------------------------------------------------------------------------
		align 4
off_419018	dd offset loc_418FC2	; DATA XREF: sub_418F80+25r
		dd offset loc_418FCB	; jump table for switch	statement
		dd offset loc_418FB6
		dd offset loc_418FBE
		dd offset loc_418FDE
		dd offset loc_418FDE
		dd offset loc_418FC7
		dd offset loc_418FAC
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_419040	proc near		; CODE XREF: sub_414980+3FCp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		mov	ebx, ds:SendMessageA
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	ecx, [ebp+10h]
		push	edi
		mov	eax, [esi+110h]
		sub	eax, ecx
		jns	short loc_419086
		mov	ecx, [esi+0ECh]
		test	ecx, ecx
		jle	short loc_419086
		add	eax, ecx
		jns	short loc_41906F
		xor	eax, eax

loc_41906F:				; CODE XREF: sub_419040+2Bj
		and	eax, 0FFFFh
		push	0		; lParam
		shl	eax, 10h
		or	al, 4
		push	eax		; wParam
		mov	eax, [esi]
		push	114h		; Msg
		push	eax		; hWnd
		call	ebx ; SendMessageA

loc_419086:				; CODE XREF: sub_419040+1Dj
					; sub_419040+27j
		mov	ecx, [ebp+10h]
		mov	edx, [esi+114h]
		mov	[esi+110h], ecx
		mov	eax, [ebp+14h]
		sub	edx, eax
		jns	short loc_4190D3
		mov	edi, [esi+0F4h]
		test	edi, edi
		jle	short loc_4190D3
		mov	ecx, [esi+0FCh]
		mov	eax, ecx
		imul	eax, edi
		add	eax, edx
		cdq
		idiv	ecx
		test	eax, eax
		jge	short loc_4190BC
		xor	eax, eax

loc_4190BC:				; CODE XREF: sub_419040+78j
		mov	edx, [esi]
		and	eax, 0FFFFh
		shl	eax, 10h
		or	al, 4
		push	0		; lParam
		push	eax		; wParam
		push	115h		; Msg
		push	edx		; hWnd
		call	ebx ; SendMessageA

loc_4190D3:				; CODE XREF: sub_419040+5Aj
					; sub_419040+64j
		mov	eax, [ebp+14h]
		push	esi
		mov	[esi+114h], eax
		call	sub_41ADC0
		lea	eax, [esi+118h]
		lea	ecx, [esi+108h]
		mov	edx, eax
		add	esp, 4
		mov	edi, [ecx]
		mov	[edx], edi
		push	1		; bErase
		mov	edi, [ecx+4]
		push	eax		; lpRect
		mov	[edx+4], edi
		mov	eax, [esi]
		mov	edi, [ecx+8]
		push	eax		; hWnd
		mov	[edx+8], edi
		mov	ecx, [ecx+0Ch]
		mov	[edx+0Ch], ecx
		mov	edx, [esi+0FCh]
		mov	ebx, [esi+11Ch]
		inc	edx
		add	ebx, edx
		mov	[esi+11Ch], ebx
		call	ds:InvalidateRect
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_419040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_419130	proc near		; CODE XREF: sub_414980+70Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		mov	edx, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, [ecx+0F4h]
		cmp	edx, 7		; switch 8 cases
		mov	eax, edi
		ja	short loc_4191C6 ; jumptable 00419147 default case
		jmp	ds:off_4191CC[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_41914E:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		mov	eax, [ecx+0F8h]	; jumptable 00419147 case 7
		mov	edx, [ecx+0F0h]
		sub	eax, edx
		jmp	short loc_4191A6
; ---------------------------------------------------------------------------

loc_41915E:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		sub	eax, [ecx+0F0h]	; jumptable 00419147 case 2
		jns	short loc_4191A6
		xor	eax, eax
		jmp	short loc_4191A6
; ---------------------------------------------------------------------------

loc_41916A:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		mov	esi, [ecx+0F0h]	; jumptable 00419147 case 3
		mov	edx, [ecx+0F8h]
		add	eax, esi
		sub	edx, esi
		cmp	eax, edx
		jle	short loc_4191A6
		lea	eax, [edx+1]
		jmp	short loc_4191A6
; ---------------------------------------------------------------------------

loc_419183:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		dec	eax		; jumptable 00419147 case 0
		jns	short loc_4191A6

loc_419186:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		xor	eax, eax	; jumptable 00419147 case 6
		jmp	short loc_4191A6
; ---------------------------------------------------------------------------

loc_41918A:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		mov	edx, [ecx+0F8h]	; jumptable 00419147 case 1
		mov	esi, [ecx+0F0h]
		inc	eax
		sub	edx, esi
		cmp	eax, edx
		jle	short loc_4191A6
		lea	eax, [edx+1]
		jmp	short loc_4191A6
; ---------------------------------------------------------------------------

loc_4191A2:				; CODE XREF: sub_419130+17j
					; DATA XREF: .text:off_4191CCo
		mov	eax, [esp+8+arg_8] ; jumptable 00419147	cases 4,5

loc_4191A6:				; CODE XREF: sub_419130+2Cj
					; sub_419130+34j ...
		sub	edi, eax
		mov	[ecx+0F4h], eax
		mov	[esp+8+arg_0], edi
		jz	short loc_4191C6 ; jumptable 00419147 default case
		lea	eax, [ecx+118h]
		mov	ecx, [ecx]
		push	1		; bErase
		push	eax		; lpRect
		push	ecx		; hWnd
		call	ds:InvalidateRect

loc_4191C6:				; CODE XREF: sub_419130+15j
					; sub_419130+82j
		pop	edi		; jumptable 00419147 default case
		pop	esi
		retn
sub_419130	endp

; ---------------------------------------------------------------------------
		align 4
off_4191CC	dd offset loc_419183	; DATA XREF: sub_419130+17r
		dd offset loc_41918A	; jump table for switch	statement
		dd offset loc_41915E
		dd offset loc_41916A
		dd offset loc_4191A2
		dd offset loc_4191A2
		dd offset loc_419186
		dd offset loc_41914E
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4191F0	proc near		; CODE XREF: sub_414980+80Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, [eax+0F4h]
		test	edx, edx
		mov	ecx, edi
		jnz	loc_4192B0
		movsx	edx, word ptr [esp+8+arg_8]
		mov	esi, [eax+100h]
		add	esi, edx
		mov	edx, esi
		mov	[eax+100h], esi
		cmp	edx, 78h
		jl	short loc_419251
		mov	edx, [eax+104h]
		cmp	edx, 0FFFFFFFFh
		jz	short loc_419237
		cmp	edx, [eax+0F0h]
		jle	short loc_41923D

loc_419237:				; CODE XREF: sub_4191F0+3Dj
		mov	edx, [eax+0F0h]

loc_41923D:				; CODE XREF: sub_4191F0+45j
		sub	ecx, edx
		mov	dword ptr [eax+100h], 0
		test	ecx, ecx
		jge	short loc_419290
		xor	ecx, ecx
		jmp	short loc_419290
; ---------------------------------------------------------------------------

loc_419251:				; CODE XREF: sub_4191F0+32j
		cmp	edx, 0FFFFFF88h
		jg	short loc_4192B0
		mov	edx, [eax+104h]
		cmp	edx, 0FFFFFFFFh
		jz	short loc_41926F
		mov	esi, [eax+0F0h]
		cmp	edx, esi
		jg	short loc_41926F
		add	ecx, edx
		jmp	short loc_419277
; ---------------------------------------------------------------------------

loc_41926F:				; CODE XREF: sub_4191F0+6Fj
					; sub_4191F0+79j
		mov	esi, [eax+0F0h]
		add	ecx, esi

loc_419277:				; CODE XREF: sub_4191F0+7Dj
		mov	edx, [eax+0F8h]
		mov	dword ptr [eax+100h], 0
		sub	edx, esi
		cmp	ecx, edx
		jle	short loc_419290
		lea	ecx, [edx+1]

loc_419290:				; CODE XREF: sub_4191F0+5Bj
					; sub_4191F0+5Fj ...
		sub	edi, ecx
		mov	[eax+0F4h], ecx
		mov	[esp+8+arg_8], edi
		jz	short loc_4192B0
		mov	edx, [eax]
		lea	ecx, [eax+118h]
		push	1		; bErase
		push	ecx		; lpRect
		push	edx		; hWnd
		call	ds:InvalidateRect

loc_4192B0:				; CODE XREF: sub_4191F0+14j
					; sub_4191F0+64j ...
		pop	edi
		pop	esi
		retn
sub_4191F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4192C0	proc near		; CODE XREF: sub_414980+1BEp
					; sub_414980+386p

ho		= dword	ptr -90h
h		= dword	ptr -8Ch
hDC		= dword	ptr -88h
rc		= RECT ptr -84h
pvParam		= byte ptr -74h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
tm		= tagTEXTMETRICA ptr -38h
arg_0		= dword	ptr  4

		sub	esp, 90h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	0		; hdc
		call	ds:CreateCompatibleDC
		mov	edi, ds:GetSysColor
		push	0Dh		; nIndex
		mov	ebp, eax
		call	edi ; GetSysColor
		mov	ebx, ds:CreateSolidBrush
		push	eax		; color
		call	ebx ; CreateSolidBrush
		mov	esi, [esp+0A0h+arg_0]
		push	5		; nIndex
		mov	[esi+13Ch], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebx ; CreateSolidBrush
		push	0Eh		; nIndex
		mov	[esi+140h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebx ; CreateSolidBrush
		push	8		; nIndex
		mov	[esi+144h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebx ; CreateSolidBrush
		push	0Fh		; nIndex
		mov	[esi+148h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebx ; CreateSolidBrush
		push	0Dh		; nIndex
		mov	[esi+14Ch], eax
		call	edi ; GetSysColor
		mov	cl, 7Fh
		mov	dl, al
		cmp	cl, dl
		mov	[esi+16Ch], eax
		sbb	dl, dl
		xor	ecx, ecx
		mov	cl, [esi+16Dh]
		and	dl, 1
		dec	dl
		push	0Eh		; nIndex
		mov	byte ptr [esp+0A4h+ho],	dl
		mov	dl, 7Fh
		cmp	dl, cl
		sbb	cl, cl
		and	cl, 1
		shr	eax, 10h
		dec	cl
		cmp	dl, al
		sbb	al, al
		mov	byte ptr [esp+0A4h+h], cl
		and	al, 1
		mov	edx, [esp+0A4h+h]
		dec	al
		and	edx, 0FFh
		mov	byte ptr [esp+0A4h+hDC], al
		mov	eax, [esp+0A4h+ho]
		mov	ecx, [esp+0A4h+hDC]
		and	eax, 0FFh
		and	ecx, 0FFh
		or	ch, 2
		shl	ecx, 8
		or	ecx, edx
		shl	ecx, 8
		or	ecx, eax
		mov	[esi+168h], ecx
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	8		; nIndex
		mov	[esi+174h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	10h		; nIndex
		mov	[esi+178h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	10h		; nIndex
		mov	[esi+17Ch], eax
		call	edi ; GetSysColor
		push	10h		; nIndex
		mov	[esi+164h], eax
		call	edi ; GetSysColor
		push	10h		; nIndex
		mov	[esi+160h], eax
		call	edi ; GetSysColor
		push	eax		; color
		call	ebx ; CreateSolidBrush
		push	0Eh		; nIndex
		mov	[esi+150h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	3		; iHatch
		call	ds:CreateHatchBrush
		push	14h		; nIndex
		mov	[esi+158h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	15h		; nIndex
		mov	[esi+180h], eax
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	18h		; index
		push	ebp		; hdc
		mov	[esi+184h], eax
		call	ds:GetDeviceCaps
		test	eax, eax
		jle	loc_419511
		push	0		; hWnd
		call	ds:GetDC
		push	8		; cy
		push	8		; cx
		push	eax		; hdc
		mov	[esp+0ACh+hDC],	eax
		call	ds:CreateCompatibleBitmap
		mov	ebx, ds:SelectObject
		push	eax		; h
		push	ebp		; hdc
		mov	[esi+170h], eax
		call	ebx ; SelectObject
		mov	ecx, [esi+140h]
		mov	[esp+0A0h+h], eax
		xor	eax, eax
		lea	edx, [esp+0A0h+rc]
		mov	[esp+0A0h+rc.left], eax
		mov	[esp+0A0h+rc.top], eax
		push	ecx		; hbr
		mov	eax, 8
		push	edx		; lprc
		push	ebp		; hDC
		mov	[esp+0ACh+rc.bottom], eax
		mov	[esp+0ACh+rc.right], eax
		call	ds:FillRect
		push	16h		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		push	0		; cWidth
		push	0		; iStyle
		call	ds:CreatePen
		push	eax		; h
		push	ebp		; hdc
		mov	[esp+0A8h+ho], eax
		call	ebx ; SelectObject
		mov	edi, 0FFFFFFF8h

loc_4194B8:				; CODE XREF: sub_4192C0+217j
		push	0		; lppt
		push	0		; y
		push	edi		; x
		push	ebp		; hdc
		call	ds:MoveToEx
		lea	eax, [edi+8]
		push	8		; y
		push	eax		; x
		push	ebp		; hdc
		call	ds:LineTo
		add	edi, 2
		cmp	edi, 8
		jl	short loc_4194B8
		mov	ecx, [esp+0A0h+ho]
		push	ecx		; ho
		call	ds:DeleteObject
		mov	edx, [esi+170h]
		push	edx		; hbm
		call	ds:CreatePatternBrush
		mov	[esi+154h], eax
		mov	eax, [esp+0A0h+h]
		push	eax		; h
		push	ebp		; hdc
		call	ebx ; SelectObject
		mov	ecx, [esp+0A0h+hDC]
		push	ecx		; hDC
		push	0		; hWnd
		call	ds:ReleaseDC
		jmp	loc_419599
; ---------------------------------------------------------------------------

loc_419511:				; CODE XREF: sub_4192C0+181j
		push	0Fh		; nIndex
		call	edi ; GetSysColor
		mov	ecx, eax
		mov	eax, 0FFh
		mov	edx, ecx
		mov	[esp+0A0h+h], ecx
		shr	edx, 10h
		and	edx, 0FFh
		mov	edi, [esp+0A0h+h]
		sub	eax, edx
		and	edi, 0FFh
		cdq
		sub	eax, edx
		or	dl, 0FFh
		sar	eax, 1
		sub	dl, al
		xor	eax, eax
		mov	ah, dl
		xor	edx, edx
		mov	dl, ch
		mov	ecx, eax
		and	edx, 0FFh
		mov	eax, 0FFh
		sub	eax, edx
		cdq
		sub	eax, edx
		or	dl, 0FFh
		sar	eax, 1
		sub	dl, al
		mov	eax, 0FFh
		sub	eax, edi
		mov	cl, dl
		cdq
		sub	eax, edx
		or	dl, 0FFh
		sar	eax, 1
		sub	dl, al
		mov	dword ptr [esi+170h], 0
		shl	ecx, 8
		and	edx, 0FFh
		or	ecx, edx
		push	ecx		; color
		call	ebx ; CreateSolidBrush
		mov	ebx, ds:SelectObject
		mov	[esi+154h], eax

loc_419599:				; CODE XREF: sub_4192C0+24Cj
		lea	eax, [esp+0A0h+pvParam]
		push	0		; fWinIni
		push	eax		; pvParam
		push	3Ch		; uiParam
		push	1Fh		; uiAction
		call	ds:SystemParametersInfoA
		mov	edi, ds:CreateFontIndirectA
		lea	ecx, [esp+0A0h+pvParam]
		push	ecx		; lplf
		call	edi ; CreateFontIndirectA
		mov	[esi+1Ch], eax
		mov	al, [esp+0A0h+var_60]
		test	al, al
		lea	eax, [esp+0A0h+pvParam]
		setz	dl
		push	eax		; lplf
		mov	[esp+0A4h+var_60], dl
		call	edi ; CreateFontIndirectA
		mov	cl, [esp+0A0h+var_60]
		lea	edx, [esp+0A0h+pvParam]
		test	cl, cl
		setz	cl
		push	edx		; lplf
		mov	[esi+20h], eax
		mov	[esp+0A4h+var_60], cl
		mov	[esp+0A4h+var_64], 2BCh
		call	edi ; CreateFontIndirectA
		mov	[esi+24h], eax
		mov	eax, [esi+1Ch]
		push	eax		; h
		push	ebp		; hdc
		call	ebx ; SelectObject
		lea	ecx, [esp+0A0h+tm]
		push	ecx		; lptm
		push	ebp		; hdc
		call	ds:GetTextMetricsA
		mov	edx, [esp+0A0h+tm.tmHeight]
		lea	eax, [edx+3]
		cmp	eax, 10h
		mov	[esi+0FCh], eax
		jg	short loc_41961F
		mov	dword ptr [esi+0FCh], 11h

loc_41961F:				; CODE XREF: sub_4192C0+353j
		push	ebp		; hdc
		call	ds:DeleteDC
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 90h
		retn
sub_4192C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_419640	proc near		; CODE XREF: sub_414980+380p
					; sub_414980+3C7p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ds:DeleteObject
		mov	eax, [esi+13Ch]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+140h]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+144h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+148h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+14Ch]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+150h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+158h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+154h]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+174h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+178h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+17Ch]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+180h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+184h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	ecx, [esi+1Ch]
		push	ecx		; ho
		call	edi ; DeleteObject
		mov	edx, [esi+20h]
		push	edx		; ho
		call	edi ; DeleteObject
		mov	eax, [esi+24h]
		push	eax		; ho
		call	edi ; DeleteObject
		mov	esi, [esi+170h]
		test	esi, esi
		jz	short loc_4196E0
		push	esi		; ho
		call	edi ; DeleteObject

loc_4196E0:				; CODE XREF: sub_419640+9Bj
		pop	edi
		pop	esi
		retn
sub_419640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4196F0(HDC hdc, LPCSTR lpString2, int, LPSTR lpString1)
sub_4196F0	proc near		; CODE XREF: sub_4199C0+202p
					; sub_4199C0+782p ...

var_C		= dword	ptr -0Ch
psizl		= tagSIZE ptr -8
hdc		= dword	ptr  4
lpString2	= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpString1	= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+lpString1]
		push	edi
		mov	edi, [esp+1Ch+lpString2]
		push	edi		; lpString2
		push	esi		; lpString1
		mov	[esp+24h+var_C], 0
		call	ds:lstrcpyA
		mov	ebp, ds:lstrlenA
		lea	eax, [esp+1Ch+psizl]
		push	eax		; psizl
		push	edi		; lpString
		call	ebp ; lstrlenA
		mov	ecx, [esp+20h+hdc]
		push	eax		; c
		push	edi		; lpString
		push	ecx		; hdc
		call	ds:GetTextExtentPoint32A
		mov	edx, [esp+1Ch+psizl._cx]
		push	edi		; lpString
		lea	ebx, [edx+4]
		call	ebp ; lstrlenA
		cmp	eax, 3
		jge	short loc_41975A
		cmp	ebx, [esp+1Ch+arg_8]
		jle	short loc_4197BB
		push	offset byte_430394 ; lpString2
		push	esi		; lpString1
		mov	edi, 1
		call	ds:lstrcpyA
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_41975A:				; CODE XREF: sub_4196F0+47j
		push	edi		; lpString
		call	ebp ; lstrlenA
		mov	edi, eax
		mov	eax, [esp+1Ch+arg_8]
		sub	edi, 3
		cmp	ebx, eax
		jle	short loc_4197AB
		lea	ebx, [edi+esi]

loc_41976D:				; CODE XREF: sub_4196F0+B9j
		test	edi, edi
		jl	short loc_4197AF
		push	offset a___	; "..."
		push	ebx		; lpString1
		mov	[esp+24h+var_C], 1
		call	ds:lstrcpyA
		lea	eax, [esp+1Ch+psizl]
		push	eax		; psizl
		push	esi		; lpString
		call	ebp ; lstrlenA
		mov	ecx, [esp+20h+hdc]
		push	eax		; c
		push	esi		; lpString
		push	ecx		; hdc
		call	ds:GetTextExtentPoint32A
		mov	edx, [esp+1Ch+psizl._cx]
		mov	eax, [esp+1Ch+arg_8]
		dec	edi
		add	edx, 4
		dec	ebx
		cmp	edx, eax
		jg	short loc_41976D

loc_4197AB:				; CODE XREF: sub_4196F0+78j
		test	edi, edi
		jge	short loc_4197BB

loc_4197AF:				; CODE XREF: sub_4196F0+7Fj
		push	offset byte_430394 ; lpString2
		push	esi		; lpString1
		call	ds:lstrcpyA

loc_4197BB:				; CODE XREF: sub_4196F0+4Dj
					; sub_4196F0+BDj
		mov	eax, [esp+1Ch+var_C]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_4196F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4197D0	proc near		; CODE XREF: sub_4197D0+1Bp
					; sub_41AB80+63p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		test	esi, esi
		jz	short loc_4197FB

loc_4197DC:				; CODE XREF: sub_4197D0+29j
		mov	eax, [esi+8]
		inc	edi
		test	eax, eax
		jz	short loc_4197F5
		test	byte ptr [esi+44h], 4
		jz	short loc_4197F5
		push	eax
		call	sub_4197D0
		add	esp, 4
		add	edi, eax

loc_4197F5:				; CODE XREF: sub_4197D0+12j
					; sub_4197D0+18j
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_4197DC

loc_4197FB:				; CODE XREF: sub_4197D0+Aj
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_4197D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_419800	proc near		; CODE XREF: sub_416970+4B1p
					; sub_416970+5B9p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		test	esi, esi
		jz	short loc_41983E
		mov	edi, [esp+0Ch+arg_8]
		mov	ebp, [esp+0Ch+arg_4]

loc_419813:				; CODE XREF: sub_419800+3Cj
		cmp	ebp, esi
		jz	short loc_419844
		mov	edx, [edi]
		inc	edx
		mov	[edi], edx
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_419838
		test	byte ptr [esi+44h], 4
		jz	short loc_419838
		push	edi
		push	ebp
		push	eax
		call	sub_419800
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_419844

loc_419838:				; CODE XREF: sub_419800+21j
					; sub_419800+27j
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_419813

loc_41983E:				; CODE XREF: sub_419800+9j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_419844:				; CODE XREF: sub_419800+15j
					; sub_419800+36j
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebp
		retn
sub_419800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_419850	proc near		; CODE XREF: sub_415FB0+7Dp
					; sub_415FB0+17Bp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	ecx, [esi+0C8h]
		lea	eax, [esp+0Ch+var_4]
		push	eax
		push	edi
		push	ecx
		mov	[esp+18h+var_4], 0
		call	sub_419800
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_4198B9
		mov	eax, [edi+54h]
		mov	edx, [esi+0F4h]
		mov	ecx, [esi+0F0h]
		mov	edi, eax
		sub	edi, edx
		mov	edx, [esp+0Ch+var_4]
		add	edi, edx
		cmp	edi, ecx
		jl	short loc_4198B9
		cmp	eax, ecx
		jge	short loc_4198A3
		sub	eax, ecx
		lea	edx, [eax+edx+1]

loc_4198A3:				; CODE XREF: sub_419850+4Bj
		mov	eax, edx
		mov	[esi+0F4h], edx
		test	eax, eax
		jge	short loc_4198B9
		mov	dword ptr [esi+0F4h], 0

loc_4198B9:				; CODE XREF: sub_419850+2Aj
					; sub_419850+47j ...
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_419850	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4198C0	proc near		; CODE XREF: sub_415FB0+48p
					; sub_415FB0+BAp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	ecx, [esp+4+arg_4]
		push	esi
		mov	esi, [esp+8+arg_0]
		lea	eax, [esp+8+var_4]
		push	eax
		push	ecx
		mov	edx, [esi+0C8h]
		mov	[esp+10h+var_4], 0
		push	edx
		call	sub_419800
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_419936
		mov	eax, [esp+8+var_4]
		mov	edx, [esi+0F4h]
		mov	ecx, [esi+0F0h]
		push	ebx
		mov	ebx, eax
		sub	ebx, edx
		cmp	ebx, ecx
		pop	ebx
		jl	short loc_419924
		sub	eax, ecx
		inc	eax
		test	eax, eax
		mov	[esi+0F4h], eax
		jge	short loc_41991C
		mov	dword ptr [esi+0F4h], 0

loc_41991C:				; CODE XREF: sub_4198C0+50j
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_419924:				; CODE XREF: sub_4198C0+43j
		cmp	eax, edx
		jge	short loc_419936
		mov	[esi+0F4h], eax
		mov	eax, 1
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_419936:				; CODE XREF: sub_4198C0+29j
					; sub_4198C0+66j
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
sub_4198C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_419940	proc near		; CODE XREF: sub_415E50+76p
					; sub_415EE0+4Bp ...

Rect		= RECT ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 10h
		mov	eax, [esp+10h+arg_4]
		push	1		; bErase
		add	eax, 24h
		mov	ecx, [eax]
		mov	[esp+14h+Rect.left], ecx
		mov	edx, [eax+4]
		mov	[esp+14h+Rect.top], edx
		mov	ecx, [eax+8]
		mov	[esp+14h+Rect.right], ecx
		mov	edx, [eax+0Ch]
		mov	eax, [esp+14h+arg_0]
		mov	[esp+14h+Rect.bottom], edx
		lea	edx, [esp+14h+Rect]
		mov	ecx, [eax+118h]
		mov	eax, [eax]
		push	edx		; lpRect
		push	eax		; hWnd
		mov	[esp+1Ch+Rect.left], ecx
		call	ds:InvalidateRect
		add	esp, 10h
		retn
sub_419940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; void __stdcall Proc(int, int,	LPARAM)
Proc		proc near		; DATA XREF: sub_4199C0+297o
					; sub_4199C0+2B8o ...

x		= dword	ptr  4
y		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+x]
		mov	edx, [esp+y]
		lea	eax, [ecx+edx]
		test	al, 1
		jnz	short locret_4199B4
		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, [eax+4]
		push	esi		; color
		push	edx		; y
		push	ecx		; x
		mov	ecx, [eax]
		push	ecx		; hdc
		call	ds:SetPixel
		pop	esi

locret_4199B4:				; CODE XREF: Proc+Dj
		retn	0Ch
Proc		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4199C0(HDC hdc, int, int, int, int, int)
sub_4199C0	proc near		; CODE XREF: sub_4199C0+BD4p
					; sub_4199C0+E39p ...

hbr		= dword	ptr -150h
x		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
y		= dword	ptr -134h
h		= dword	ptr -130h
data		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
psizl		= tagSIZE ptr -108h
String		= byte ptr -100h
hdc		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 150h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+160h+arg_4]
		mov	ebp, [esp+160h+arg_14]
		mov	esi, [esp+160h+hdc]
		mov	eax, [edi+188h]
		mov	ecx, [edi+18Ch]
		mov	[esp+160h+var_120], eax
		mov	eax, [esp+160h+arg_10]
		mov	[esp+160h+var_10C], ecx
		mov	ecx, [edi+0ECh]
		sub	eax, ecx
		mov	[esp+160h+data], esi
		test	ebp, ebp
		mov	[esp+160h+var_124], eax
		jz	loc_41A838

loc_419A12:				; CODE XREF: sub_4199C0+E46j
		mov	eax, [esp+160h+arg_8]
		mov	ebx, ds:GetSysColor
		mov	ecx, [eax]
		inc	ecx
		mov	[eax], ecx
		mov	ecx, [edi+0F4h]
		mov	edx, [edi+0F0h]
		lea	edx, [edx+ecx+2]
		mov	ecx, [eax]
		cmp	ecx, edx
		jg	loc_41A817
		cmp	ecx, [edi+0F4h]
		jle	loc_41A7B8
		mov	eax, [edi+30h]
		test	eax, eax
		mov	eax, [ebp+44h]
		jz	short loc_419A93
		test	eax, 102h
		jz	short loc_419A7D
		mov	eax, [edi+13Ch]
		mov	ecx, [edi+168h]
		push	0Dh		; nIndex
		mov	[esp+164h+hbr],	eax
		mov	[esp+164h+var_128], ecx
		call	ebx ; GetSysColor
		mov	[edi+15Ch], eax
		push	0Eh
		jmp	short loc_419ADA
; ---------------------------------------------------------------------------

loc_419A7D:				; CODE XREF: sub_4199C0+99j
		mov	edx, [edi+140h]
		mov	eax, [edi+16Ch]
		mov	[esp+160h+hbr],	edx
		mov	[esp+160h+var_128], eax
		jmp	short loc_419ACE
; ---------------------------------------------------------------------------

loc_419A93:				; CODE XREF: sub_4199C0+92j
		test	eax, 102h
		jz	short loc_419ABA
		mov	eax, [edi+2Ch]
		test	ah, 1
		jz	short loc_419ABA
		mov	ecx, [edi+14Ch]
		mov	edx, [edi+16Ch]
		mov	[esp+160h+hbr],	ecx
		mov	[esp+160h+var_128], edx
		push	0Fh
		jmp	short loc_419AD0
; ---------------------------------------------------------------------------

loc_419ABA:				; CODE XREF: sub_4199C0+D8j
					; sub_4199C0+E0j
		mov	eax, [edi+140h]
		mov	ecx, [edi+16Ch]
		mov	[esp+160h+hbr],	eax
		mov	[esp+160h+var_128], ecx

loc_419ACE:				; CODE XREF: sub_4199C0+D1j
		push	5		; nIndex

loc_419AD0:				; CODE XREF: sub_4199C0+F8j
		call	ebx ; GetSysColor
		mov	[edi+15Ch], eax
		push	8		; nIndex

loc_419ADA:				; CODE XREF: sub_4199C0+BBj
		call	ebx ; GetSysColor
		push	eax		; color
		push	esi		; hdc
		call	ds:SetTextColor
		mov	edx, [edi+15Ch]
		push	edx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	ebx, [esp+160h+var_124]
		mov	edx, [esp+160h+arg_C]
		lea	ecx, [ebx+12h]
		mov	[ebp+14h], ecx
		mov	eax, [edi+120h]
		mov	[ebp+1Ch], eax
		mov	eax, [edx]
		inc	eax
		mov	[ebp+18h], eax
		add	eax, [edi+0FCh]
		mov	[ebp+20h], eax
		mov	eax, [ebp+54h]
		test	eax, eax
		jz	short loc_419B40
		test	byte ptr [edi+2Ch], 1
		jz	short loc_419B40
		mov	[ebp+34h], ebx
		mov	[ebp+3Ch], ecx
		mov	eax, [edx]
		mov	[ebp+38h], eax
		mov	ecx, [edi+0FCh]
		add	eax, ecx
		mov	[ebp+40h], eax
		jmp	short loc_419B52
; ---------------------------------------------------------------------------

loc_419B40:				; CODE XREF: sub_4199C0+160j
					; sub_4199C0+166j
		mov	[ebp+34h], ecx
		mov	[ebp+3Ch], ecx
		mov	ecx, [edx]
		mov	dword ptr [ebp+40h], 0
		mov	[ebp+38h], ecx

loc_419B52:				; CODE XREF: sub_4199C0+17Ej
		mov	ecx, [edi+0E4h]
		lea	eax, [ebx+26h]
		cmp	eax, ecx
		jl	short loc_419B61
		mov	eax, ecx

loc_419B61:				; CODE XREF: sub_4199C0+19Dj
		mov	edx, [esp+160h+arg_C]
		lea	ebx, [ebp+24h]
		mov	ecx, [ebp+18h]
		mov	[ebx], eax
		mov	eax, [edx]
		inc	eax
		mov	[ebp+28h], eax
		mov	edx, [edi+0FCh]
		mov	al, [ebp+44h]
		add	ecx, edx
		test	al, 8
		mov	[ebp+30h], ecx
		jz	short loc_419B8E
		mov	edx, [edi+24h]
		push	edx
		jmp	short loc_419B9E
; ---------------------------------------------------------------------------

loc_419B8E:				; CODE XREF: sub_4199C0+1C6j
		test	byte ptr [ebp+44h], 10h
		jz	short loc_419B9A
		mov	eax, [edi+20h]
		push	eax
		jmp	short loc_419B9E
; ---------------------------------------------------------------------------

loc_419B9A:				; CODE XREF: sub_4199C0+1D2j
		mov	ecx, [edi+1Ch]
		push	ecx		; h

loc_419B9E:				; CODE XREF: sub_4199C0+1CCj
					; sub_4199C0+1D8j
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [edi+0E4h]
		mov	ecx, [esp+160h+arg_10]
		sub	eax, ecx
		mov	ecx, [ebp+48h]
		lea	edx, [esp+160h+String]
		sub	eax, 26h
		push	edx		; lpString1
		push	eax		; int
		push	ecx		; lpString2
		push	esi		; hdc
		call	sub_4196F0
		add	esp, 10h
		test	eax, eax
		mov	eax, [ebp+44h]
		jz	short loc_419BD6
		or	ah, 2
		jmp	short loc_419BD9
; ---------------------------------------------------------------------------

loc_419BD6:				; CODE XREF: sub_4199C0+20Fj
		and	ah, 0FDh

loc_419BD9:				; CODE XREF: sub_4199C0+214j
		mov	[ebp+44h], eax
		lea	edx, [esp+160h+psizl]
		lea	eax, [esp+160h+String]
		push	edx		; psizl
		push	eax		; lpString
		call	ds:lstrlenA
		lea	ecx, [esp+164h+String]
		push	eax		; c
		push	ecx		; lpString
		push	esi		; hdc
		call	ds:GetTextExtentPoint32A
		mov	edx, [ebx]
		mov	eax, [esp+160h+psizl._cx]
		lea	ecx, [edx+eax+4]
		mov	[ebp+2Ch], ecx
		mov	eax, [edi+0DCh]
		mov	ecx, [ebp+10h]
		mov	edx, [edi+0E4h]
		test	eax, eax
		jz	short loc_419C31

loc_419C19:				; CODE XREF: sub_4199C0+26Fj
		test	ecx, ecx
		jz	short loc_419C31
		add	edx, [eax+14h]
		test	byte ptr [ecx+4], 80h
		jz	short loc_419C29
		mov	[ebp+2Ch], edx

loc_419C29:				; CODE XREF: sub_4199C0+264j
		mov	eax, [eax]
		mov	ecx, [ecx]
		test	eax, eax
		jnz	short loc_419C19

loc_419C31:				; CODE XREF: sub_4199C0+257j
					; sub_4199C0+25Bj
		mov	edx, [esp+160h+hbr]
		push	edx		; hbr
		push	ebx		; lprc
		push	esi		; hDC
		call	ds:FillRect
		mov	eax, [edi+30h]
		test	eax, eax
		jz	short loc_419CC2
		test	byte ptr [ebp+44h], 1
		jz	short loc_419CC2
		mov	edx, [ebp+2Ch]
		mov	eax, [ebp+28h]
		lea	ecx, [esp+160h+data]
		dec	edx
		push	ecx		; data
		push	offset Proc	; lpProc
		push	eax		; yEnd
		push	edx		; xEnd
		push	eax		; yStart
		mov	eax, [ebx]
		push	eax		; xStart
		call	ds:LineDDA
		mov	eax, [ebp+2Ch]
		mov	edx, [ebp+30h]
		lea	ecx, [esp+160h+data]
		dec	eax
		push	ecx		; data
		mov	ecx, [ebp+28h]
		dec	edx
		push	offset Proc	; lpProc
		push	edx		; yEnd
		push	eax		; xEnd
		push	ecx		; yStart
		push	eax		; xStart
		call	ds:LineDDA
		mov	eax, [ebp+30h]
		mov	ecx, [ebx]
		lea	edx, [esp+160h+data]
		dec	eax
		push	edx		; data
		mov	edx, [ebp+2Ch]
		push	offset Proc	; lpProc
		push	eax		; yEnd
		push	ecx		; xEnd
		dec	edx
		push	eax		; yStart
		push	edx		; xStart
		call	ds:LineDDA
		mov	edx, [ebp+28h]
		mov	eax, [ebx]
		lea	ecx, [esp+160h+data]
		push	ecx		; data
		mov	ecx, [ebp+30h]
		push	offset Proc	; lpProc
		push	edx		; yEnd
		dec	ecx
		push	eax		; xEnd
		push	ecx		; yStart
		push	eax		; xStart
		call	ds:LineDDA

loc_419CC2:				; CODE XREF: sub_4199C0+283j
					; sub_4199C0+289j
		mov	eax, [ebp+28h]
		push	0		; align
		inc	eax
		push	esi		; hdc
		mov	[esp+168h+y], eax
		call	ds:SetTextAlign
		lea	edx, [esp+160h+String]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	edx, [ebx]
		mov	ecx, [esp+160h+y]
		push	eax		; c
		lea	eax, [esp+164h+String]
		push	eax		; lpString
		add	edx, 2
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:TextOutA
		mov	eax, [ebp+3Ch]
		mov	edx, [edi+0E4h]
		lea	ecx, [eax+10h]
		cmp	edx, ecx
		jl	short loc_419D25
		mov	edx, [ebp+28h]
		mov	ebx, [esp+160h+var_10C]
		mov	ecx, [edi+0B8h]
		add	edx, ebx
		push	1		; fStyle
		push	edx		; y
		push	eax		; x
		mov	eax, [ebp+4Ch]
		push	esi		; hdcDst
		push	eax		; i
		push	ecx		; himl
		call	ds:ImageList_Draw

loc_419D25:				; CODE XREF: sub_4199C0+344j
		mov	edx, [edi+1Ch]
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [ebp+10h]
		mov	ecx, [edi+0ECh]
		mov	ebx, [edi+0DCh]
		mov	[esp+160h+var_13C], eax
		mov	eax, [edi+0E4h]
		sub	eax, ecx
		test	ebx, ebx
		mov	[esp+160h+var_138], eax
		jz	loc_41A45E

loc_419D57:				; CODE XREF: sub_4199C0+A98j
		mov	eax, [esp+160h+var_13C]
		test	eax, eax
		jz	loc_41A45E
		mov	ecx, [eax+4]
		test	cl, 80h
		jz	loc_41A43D
		mov	eax, [ebx+8]
		dec	eax
		jz	loc_41A365
		dec	eax
		jnz	loc_41A43D
		mov	eax, [ebx+0Ch]
		add	eax, 0FFFFFFFCh	; switch 4 cases
		cmp	eax, 3
		ja	loc_41A310	; jumptable 00419D8F default case
		jmp	ds:off_41A844[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_419D96:				; CODE XREF: sub_4199C0+3CFj
					; DATA XREF: .text:off_41A844o
		mov	eax, [ebx+14h]	; jumptable 00419D8F case 4
		sub	eax, 0Ch
		test	eax, eax
		mov	[esp+160h+var_110], eax
		jle	loc_41A43D
		mov	eax, [esp+160h+var_138]
		lea	ecx, [eax+6]
		mov	[esp+160h+x], ecx
		mov	ecx, [esp+160h+y]
		lea	edx, [ecx+4]
		mov	[esp+160h+var_148], edx
		mov	edx, [ebx+14h]
		lea	eax, [edx+eax-7]
		mov	edx, [edi+0FCh]
		mov	[esp+160h+var_144], eax
		lea	eax, [edx+ecx-6]
		mov	ecx, [edi+154h]
		push	ecx		; h
		push	esi		; hdc
		mov	[esp+168h+var_140], eax
		call	ds:SelectObject
		mov	edx, [edi+17Ch]
		mov	[esp+160h+h], eax
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	ecx, [esp+160h+var_144]
		mov	edx, [esp+160h+var_148]
		mov	[esp+160h+hbr],	eax
		mov	eax, [esp+160h+var_140]
		add	eax, 2
		add	ecx, 2
		push	eax		; bottom
		mov	eax, [esp+164h+x]
		dec	edx
		push	ecx		; right
		dec	eax
		push	edx		; top
		push	eax		; left
		push	esi		; hdc
		call	ds:Rectangle
		mov	ecx, [edi+184h]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+x]
		push	0		; lppt
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	ecx, [esp+160h+var_148]
		mov	edx, [esp+160h+x]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	eax, [esp+160h+var_148]
		mov	ecx, [esp+160h+var_144]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [edi+180h]
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [esp+160h+var_140]
		mov	ecx, [esp+160h+var_144]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+x]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	eax, [ebx+10h]
		test	eax, eax
		mov	[esp+160h+var_11C], eax
		jz	short loc_419EE4
		mov	ecx, [esp+160h+var_13C]
		mov	ecx, [ecx+0Ch]
		cmp	ecx, eax
		mov	[esp+160h+var_114], ecx
		jle	short loc_419EC1
		mov	edx, [edi+158h]
		mov	ecx, [esp+160h+x]
		mov	eax, [esp+160h+var_110]
		mov	[esp+160h+var_118], edx
		add	eax, ecx
		jmp	short loc_419EEA
; ---------------------------------------------------------------------------

loc_419EC1:				; CODE XREF: sub_4199C0+4E9j
		fild	[esp+160h+var_114]
		mov	ecx, [edi+150h]
		mov	[esp+160h+var_118], ecx
		fidiv	[esp+160h+var_11C]
		fimul	[esp+160h+var_110]
		call	__ftol
		mov	ecx, [esp+160h+x]
		add	eax, ecx
		jmp	short loc_419EEA
; ---------------------------------------------------------------------------

loc_419EE4:				; CODE XREF: sub_4199C0+4DAj
		mov	ecx, [esp+160h+x]
		mov	eax, ecx

loc_419EEA:				; CODE XREF: sub_4199C0+4FFj
					; sub_4199C0+522j
		mov	edx, [esp+160h+var_148]
		mov	[esp+160h+var_144], eax
		inc	edx
		inc	ecx
		cmp	eax, ecx
		mov	[esp+160h+var_148], edx
		mov	[esp+160h+x], ecx
		jle	loc_419F96

loc_419F04:				; CODE XREF: sub_4199C0+767j
		mov	edx, [edi+160h]
		push	edx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	eax, [esp+160h+var_118]
		lea	ecx, [esp+160h+x]
		push	eax		; hbr
		push	ecx		; lprc
		push	esi		; hDC
		call	ds:FillRect
		mov	eax, [esp+160h+var_148]
		mov	ecx, [esp+160h+x]
		mov	edx, [esp+160h+var_144]
		dec	eax
		push	0		; lppt
		push	eax		; y
		dec	ecx
		push	edx		; x
		push	esi		; hdc
		mov	[esp+170h+var_148], eax
		mov	[esp+170h+x], ecx
		call	ds:MoveToEx
		mov	eax, [esp+160h+var_148]
		mov	ecx, [esp+160h+x]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+x]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	ecx, [edi+184h]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+var_144]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	ecx, [esp+160h+var_148]
		mov	edx, [esp+160h+var_144]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:LineTo

loc_419F96:				; CODE XREF: sub_4199C0+53Ej
					; sub_4199C0+761j
		mov	eax, [esp+160h+h]
		push	eax		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	ecx, [esp+160h+hbr]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		jmp	loc_41A43D
; ---------------------------------------------------------------------------

loc_419FB3:				; CODE XREF: sub_4199C0+3CFj
					; DATA XREF: .text:off_41A844o
		mov	eax, [esp+160h+var_138]	; jumptable 00419D8F case 5
		mov	ecx, [esp+160h+y]
		lea	edx, [eax+6]
		mov	[esp+160h+x], edx
		lea	edx, [ecx+4]
		mov	[esp+160h+var_148], edx
		mov	edx, [ebx+14h]
		lea	eax, [edx+eax-7]
		mov	edx, [edi+0FCh]
		mov	[esp+160h+var_144], eax
		lea	eax, [edx+ecx-6]
		mov	ecx, [edi+154h]
		push	ecx		; h
		push	esi		; hdc
		mov	[esp+168h+var_140], eax
		call	ds:SelectObject
		mov	edx, [edi+17Ch]
		mov	[esp+160h+h], eax
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	ecx, [esp+160h+var_144]
		mov	edx, [esp+160h+var_148]
		mov	[esp+160h+hbr],	eax
		mov	eax, [esp+160h+var_140]
		add	eax, 2
		add	ecx, 2
		push	eax		; bottom
		mov	eax, [esp+164h+x]
		dec	edx
		push	ecx		; right
		dec	eax
		push	edx		; top
		push	eax		; left
		push	esi		; hdc
		call	ds:Rectangle
		mov	ecx, [edi+184h]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+x]
		push	0		; lppt
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	ecx, [esp+160h+var_148]
		mov	edx, [esp+160h+x]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	eax, [esp+160h+var_148]
		mov	ecx, [esp+160h+var_144]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [edi+180h]
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [esp+160h+var_140]
		mov	ecx, [esp+160h+var_144]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [esp+160h+var_140]
		mov	eax, [esp+160h+x]
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	eax, [ebx+10h]
		test	eax, eax
		mov	[esp+160h+var_11C], eax
		jz	short loc_41A107
		mov	ecx, [esp+160h+var_13C]
		mov	ecx, [ecx+0Ch]
		cmp	ecx, eax
		mov	[esp+160h+var_114], ecx
		jle	short loc_41A0CC
		mov	edx, [edi+158h]
		mov	ecx, [esp+160h+x]
		mov	eax, [esp+160h+var_110]
		mov	[esp+160h+var_118], edx
		add	eax, ecx
		jmp	short loc_41A10D
; ---------------------------------------------------------------------------

loc_41A0CC:				; CODE XREF: sub_4199C0+6F4j
		fild	[esp+160h+var_114]
		mov	ecx, [edi+150h]
		mov	[esp+160h+var_118], ecx
		fidiv	[esp+160h+var_11C]
		fadd	ds:dbl_42B628
		fldln2
		fxch	st(1)
		fyl2x
		fldln2
		fld	ds:dbl_42B620
		fyl2x
		fdivp	st(1), st
		fimul	[esp+160h+var_110]
		call	__ftol
		mov	ecx, [esp+160h+x]
		add	eax, ecx
		jmp	short loc_41A10D
; ---------------------------------------------------------------------------

loc_41A107:				; CODE XREF: sub_4199C0+6E5j
		mov	ecx, [esp+160h+x]
		mov	eax, ecx

loc_41A10D:				; CODE XREF: sub_4199C0+70Aj
					; sub_4199C0+745j
		mov	edx, [esp+160h+var_148]
		mov	[esp+160h+var_144], eax
		inc	edx
		inc	ecx
		cmp	eax, ecx
		mov	[esp+160h+var_148], edx
		mov	[esp+160h+x], ecx
		jle	loc_419F96
		jmp	loc_419F04
; ---------------------------------------------------------------------------

loc_41A12C:				; CODE XREF: sub_4199C0+3CFj
					; DATA XREF: .text:off_41A844o
		mov	edx, [esp+160h+var_13C]	; jumptable 00419D8F case 6
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_41A175
		mov	edx, [ebx+14h]
		lea	ecx, [esp+160h+String]
		push	ecx		; lpString1
		push	edx		; int
		push	eax		; lpString2
		push	esi		; hdc
		call	sub_4196F0
		add	esp, 10h
		test	eax, eax
		mov	eax, [esp+160h+var_13C]
		mov	ecx, [eax+4]
		jz	short loc_41A15A
		or	ch, 2
		jmp	short loc_41A15D
; ---------------------------------------------------------------------------

loc_41A15A:				; CODE XREF: sub_4199C0+793j
		and	ch, 0FDh

loc_41A15D:				; CODE XREF: sub_4199C0+798j
		mov	[eax+4], ecx
		mov	eax, [edi+15Ch]
		push	eax		; color
		push	esi		; hdc
		call	ds:SetBkColor
		push	6
		jmp	loc_41A202
; ---------------------------------------------------------------------------

loc_41A175:				; CODE XREF: sub_4199C0+775j
		cmp	dword ptr [ebx+14h], 10h
		jl	loc_41A43D
		xor	eax, eax
		test	cl, 20h
		jz	short loc_41A18B
		mov	eax, 1

loc_41A18B:				; CODE XREF: sub_4199C0+7C4j
		mov	edx, [ebp+28h]
		mov	ecx, [esp+160h+var_10C]
		add	edx, ecx
		mov	ecx, [ebx+1Ch]
		push	1		; fStyle
		push	edx		; y
		mov	edx, [esp+168h+var_138]
		add	ecx, edx
		mov	edx, [esp+168h+var_13C]
		push	ecx		; x
		push	esi		; hdcDst
		mov	ecx, [edx+0Ch]
		mov	edx, [edi+0B8h]
		add	ecx, eax
		push	ecx		; i
		push	edx		; himl
		call	ds:ImageList_Draw
		jmp	loc_41A43D
; ---------------------------------------------------------------------------

loc_41A1BE:				; CODE XREF: sub_4199C0+3CFj
					; DATA XREF: .text:off_41A844o
		mov	eax, [esp+160h+var_13C]	; jumptable 00419D8F case 7
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41A230
		mov	edx, [ebx+14h]
		lea	ecx, [esp+160h+String]
		push	ecx		; lpString1
		push	edx		; int
		push	eax		; lpString2
		push	esi		; hdc
		call	sub_4196F0
		add	esp, 10h
		test	eax, eax
		mov	eax, [esp+160h+var_13C]
		mov	ecx, [eax+4]
		jz	short loc_41A1EC
		or	ch, 2
		jmp	short loc_41A1EF
; ---------------------------------------------------------------------------

loc_41A1EC:				; CODE XREF: sub_4199C0+825j
		and	ch, 0FDh

loc_41A1EF:				; CODE XREF: sub_4199C0+82Aj
		mov	[eax+4], ecx
		mov	eax, [edi+15Ch]
		push	eax		; color
		push	esi		; hdc
		call	ds:SetBkColor
		push	0		; align

loc_41A202:				; CODE XREF: sub_4199C0+7B0j
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	ecx, [esp+160h+String]
		push	ecx		; lpString
		call	ds:lstrlenA
		mov	ecx, [ebx+14h]
		push	eax
		mov	eax, [esp+164h+y]
		lea	edx, [esp+164h+String]
		push	edx
		push	eax
		mov	eax, [esp+16Ch+var_138]
		sar	ecx, 1
		add	ecx, eax
		push	ecx
		jmp	loc_41A436
; ---------------------------------------------------------------------------

loc_41A230:				; CODE XREF: sub_4199C0+807j
		mov	eax, [esp+160h+var_138]
		mov	ecx, 10h
		mov	edx, 1
		sub	ecx, eax
		mov	[esp+160h+h], 0
		mov	[esp+160h+var_11C], edx
		mov	[esp+160h+hbr],	eax
		mov	[esp+160h+var_114], ecx
		jmp	short loc_41A25A
; ---------------------------------------------------------------------------

loc_41A256:				; CODE XREF: sub_4199C0+945j
		mov	ecx, [esp+160h+var_114]

loc_41A25A:				; CODE XREF: sub_4199C0+894j
		mov	eax, [esp+160h+var_13C]
		test	[eax+0Ch], edx
		jz	loc_41A2EC
		mov	edx, [esp+160h+hbr]
		mov	eax, [ebx+14h]
		add	ecx, edx
		cmp	ecx, eax
		jg	short loc_41A29F
		mov	eax, [ebp+28h]
		mov	edx, [esp+160h+var_10C]
		mov	ecx, [esp+160h+hbr]
		add	eax, edx
		mov	edx, [esp+160h+h]
		push	1		; fStyle
		push	eax		; y
		mov	eax, [edi+0B8h]
		push	ecx		; x
		push	esi		; hdcDst
		push	edx		; i
		push	eax		; himl
		call	ds:ImageList_Draw
		add	[esp+160h+hbr],	12h
		jmp	short loc_41A2EC
; ---------------------------------------------------------------------------

loc_41A29F:				; CODE XREF: sub_4199C0+8B2j
		lea	ecx, [esp+160h+String]
		push	ecx		; lpString1
		push	eax		; int
		push	offset a___	; "..."
		push	esi		; hdc
		call	sub_4196F0
		mov	edx, [edi+15Ch]
		add	esp, 10h
		push	edx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		push	0		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	eax, [esp+160h+String]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	edx, [esp+160h+y]
		lea	ecx, [esp+160h+String]
		push	eax		; c
		mov	eax, [esp+164h+hbr]
		push	ecx		; lpString
		push	edx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:TextOutA

loc_41A2EC:				; CODE XREF: sub_4199C0+8A1j
					; sub_4199C0+8DDj
		mov	edx, [esp+160h+var_11C]
		mov	ecx, [esp+160h+h]
		shl	edx, 1
		inc	ecx
		mov	[esp+160h+var_11C], edx
		test	edx, 80000000h
		mov	[esp+160h+h], ecx
		jz	loc_41A256
		jmp	loc_41A43D
; ---------------------------------------------------------------------------

loc_41A310:				; CODE XREF: sub_4199C0+3C9j
		mov	ecx, [esp+160h+var_13C]	; jumptable 00419D8F default case
		lea	eax, [esp+160h+String]
		mov	edx, [ecx+0Ch]
		push	edx
		push	offset aI	; "%i"
		push	eax		; LPSTR
		call	ds:wsprintfA
		mov	ecx, [edi+15Ch]
		add	esp, 0Ch
		push	ecx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		push	0		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	edx, [esp+160h+String]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	edx, [esp+160h+var_138]
		mov	ecx, [esp+160h+y]
		push	eax
		lea	eax, [esp+164h+String]
		push	eax
		add	edx, 6
		push	ecx
		push	edx
		jmp	loc_41A436
; ---------------------------------------------------------------------------

loc_41A365:				; CODE XREF: sub_4199C0+3B3j
		mov	edx, [esp+160h+var_13C]
		mov	ecx, [ebx+14h]
		lea	eax, [esp+160h+String]
		push	eax		; lpString1
		mov	eax, [edx+8]
		push	ecx		; int
		push	eax		; lpString2
		push	esi		; hdc
		call	sub_4196F0
		add	esp, 10h
		test	eax, eax
		mov	eax, [esp+160h+var_13C]
		mov	ecx, [eax+4]
		jz	short loc_41A38F
		or	ch, 2
		jmp	short loc_41A392
; ---------------------------------------------------------------------------

loc_41A38F:				; CODE XREF: sub_4199C0+9C8j
		and	ch, 0FDh

loc_41A392:				; CODE XREF: sub_4199C0+9CDj
		mov	[eax+4], ecx
		mov	ecx, [edi+15Ch]
		push	ecx		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	eax, [ebx+0Ch]
		sub	eax, 0
		jz	short loc_41A40F
		dec	eax
		jz	short loc_41A3E2
		dec	eax
		jnz	loc_41A43D
		push	6		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	edx, [esp+160h+String]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	edx, [ebx+14h]
		mov	ecx, [esp+160h+y]
		push	eax
		lea	eax, [esp+164h+String]
		push	eax
		mov	eax, [esp+168h+var_138]
		sar	edx, 1
		add	edx, eax
		push	ecx
		push	edx
		jmp	short loc_41A436
; ---------------------------------------------------------------------------

loc_41A3E2:				; CODE XREF: sub_4199C0+9ECj
		push	2		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	eax, [esp+160h+String]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	edx, [esp+160h+y]
		lea	ecx, [esp+160h+String]
		push	eax
		mov	eax, [ebx+14h]
		push	ecx
		mov	ecx, [esp+168h+var_138]
		push	edx
		lea	edx, [eax+ecx-6]
		push	edx
		jmp	short loc_41A436
; ---------------------------------------------------------------------------

loc_41A40F:				; CODE XREF: sub_4199C0+9E9j
		push	0		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	eax, [esp+160h+String]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	edx, [esp+160h+y]
		push	eax		; c
		mov	eax, [esp+164h+var_138]
		lea	ecx, [esp+164h+String]
		push	ecx		; lpString
		add	eax, 6
		push	edx		; y
		push	eax		; x

loc_41A436:				; CODE XREF: sub_4199C0+86Bj
					; sub_4199C0+9A0j ...
		push	esi		; hdc
		call	ds:TextOutA

loc_41A43D:				; CODE XREF: sub_4199C0+3A9j
					; sub_4199C0+3BAj ...
		mov	ecx, [ebx+14h]
		mov	edx, [esp+160h+var_138]
		mov	ebx, [ebx]
		add	edx, ecx
		mov	[esp+160h+var_138], edx
		mov	edx, [esp+160h+var_13C]
		test	ebx, ebx
		mov	eax, [edx]
		mov	[esp+160h+var_13C], eax
		jnz	loc_419D57

loc_41A45E:				; CODE XREF: sub_4199C0+391j
					; sub_4199C0+39Dj
		mov	eax, [esp+160h+arg_C]
		mov	ecx, [edi+0FCh]
		mov	edx, [eax]
		add	edx, ecx
		mov	[eax], edx
		mov	eax, [edi+0E4h]
		mov	ecx, [ebp+3Ch]
		mov	[esp+160h+h], edx
		cmp	eax, ecx
		mov	eax, [ebp+54h]
		jl	loc_41A78D
		test	eax, eax
		jz	loc_41A6FA
		mov	ecx, [edi+17Ch]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	edx, [ebp+38h]
		mov	ebx, [esp+160h+var_120]
		mov	ecx, [ebp+34h]
		mov	[esp+160h+hbr],	eax
		lea	eax, [ebx+edx-4]
		push	0		; lppt
		add	ecx, 5
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		add	ecx, 0Dh
		lea	eax, [ebx+edx-4]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		add	ecx, 0Dh
		lea	eax, [ebx+edx+4]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		add	ecx, 5
		lea	eax, [ebx+edx+4]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		add	ecx, 5
		lea	eax, [ebx+edx-4]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [esp+160h+hbr]
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject
		test	byte ptr [ebp+44h], 4
		mov	eax, [edi+178h]
		push	eax		; h
		push	esi		; hdc
		jz	short loc_41A59E
		call	ds:SelectObject
		mov	edx, [ebp+34h]
		mov	[esp+160h+hbr],	eax
		mov	eax, [ebp+38h]
		mov	ecx, ebx
		add	ecx, eax
		push	0		; lppt
		add	edx, 7
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	ecx, [ebp+38h]
		mov	eax, [ebp+34h]
		add	ebx, ecx
		add	eax, 0Ch
		push	ebx		; y
		push	eax		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	ecx, [esp+160h+hbr]
		push	ecx		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [esp+160h+arg_10]
		mov	edx, [ebp+8]
		mov	ecx, [esp+160h+arg_C]
		add	eax, 10h
		push	edx		; int
		mov	edx, [esp+164h+arg_8]
		push	eax		; int
		push	ecx		; int
		push	edx		; int
		push	edi		; int
		push	esi		; hdc
		call	sub_4199C0
		add	esp, 18h
		jmp	short loc_41A610
; ---------------------------------------------------------------------------

loc_41A59E:				; CODE XREF: sub_4199C0+B6Fj
		call	ds:SelectObject
		mov	edx, [ebp+34h]
		mov	[esp+160h+hbr],	eax
		mov	eax, [ebp+38h]
		mov	ecx, ebx
		add	ecx, eax
		push	0		; lppt
		add	edx, 7
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		mov	eax, ebx
		add	ecx, 0Ch
		add	eax, edx
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		push	0		; lppt
		add	ecx, 9
		lea	eax, [ebx+edx-2]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:MoveToEx
		mov	edx, [ebp+38h]
		mov	ecx, [ebp+34h]
		add	ecx, 9
		lea	eax, [ebx+edx+3]
		push	eax		; y
		push	ecx		; x
		push	esi		; hdc
		call	ds:LineTo
		mov	edx, [esp+160h+hbr]
		push	edx		; h
		push	esi		; hdc
		call	ds:SelectObject

loc_41A610:				; CODE XREF: sub_4199C0+BDCj
		mov	eax, [edi+2Ch]
		test	al, 2
		jz	loc_41A801
		mov	ecx, [ebp+0Ch]
		test	ecx, ecx
		jnz	short loc_41A62A
		test	al, 4
		jz	loc_41A801

loc_41A62A:				; CODE XREF: sub_4199C0+C60j
		mov	eax, [edi+164h]
		mov	[esp+160h+var_128], eax
		mov	eax, [ebp+4]
		test	eax, eax
		jnz	short loc_41A646
		mov	ecx, [ebp+0Ch]
		test	ecx, ecx
		jz	short loc_41A69C
		test	eax, eax
		jz	short loc_41A674

loc_41A646:				; CODE XREF: sub_4199C0+C79j
		mov	edx, [ebp+38h]
		mov	ebx, [esp+160h+var_124]
		lea	ecx, [esp+160h+data]
		push	ecx		; data
		mov	ecx, [esp+164h+var_120]
		lea	eax, [ebx+9]
		push	offset Proc	; lpProc
		lea	edx, [ecx+edx-4]
		mov	ecx, [ebp+4]
		push	edx		; yEnd
		push	eax		; xEnd
		mov	ecx, [ecx+20h]
		push	ecx		; yStart
		push	eax		; xStart
		call	ds:LineDDA
		jmp	short loc_41A6A0
; ---------------------------------------------------------------------------

loc_41A674:				; CODE XREF: sub_4199C0+C84j
		mov	eax, [ebp+38h]
		mov	ebx, [esp+160h+var_124]
		lea	edx, [esp+160h+data]
		push	edx		; data
		mov	edx, [esp+164h+var_120]
		lea	ecx, [ebx+9]
		push	offset Proc	; lpProc
		lea	edx, [eax+edx-4]
		push	edx		; yEnd
		push	ecx		; xEnd
		push	eax		; yStart
		push	ecx		; xStart
		call	ds:LineDDA
		jmp	short loc_41A6A0
; ---------------------------------------------------------------------------

loc_41A69C:				; CODE XREF: sub_4199C0+C80j
		mov	ebx, [esp+160h+var_124]

loc_41A6A0:				; CODE XREF: sub_4199C0+CB2j
					; sub_4199C0+CDAj
		cmp	dword ptr [ebp+0], 0
		jz	short loc_41A6D2
		mov	edx, [esp+160h+arg_C]
		lea	ecx, [esp+160h+data]
		push	ecx		; data
		push	offset Proc	; lpProc
		mov	ecx, [edx]
		mov	edx, [ebp+38h]
		inc	ecx
		lea	eax, [ebx+9]
		push	ecx		; yEnd
		mov	ecx, [esp+16Ch+var_120]
		push	eax		; xEnd
		lea	edx, [ecx+edx+4]
		push	edx		; yStart
		push	eax		; xStart
		call	ds:LineDDA

loc_41A6D2:				; CODE XREF: sub_4199C0+CE4j
		mov	eax, [ebp+38h]
		mov	ecx, [esp+160h+var_120]
		lea	edx, [esp+160h+data]
		add	eax, ecx
		push	edx		; data
		push	offset Proc	; lpProc
		lea	ecx, [ebx+12h]
		push	eax		; yEnd
		push	ecx		; xEnd
		add	ebx, 0Dh
		push	eax		; yStart
		push	ebx		; xStart
		call	ds:LineDDA
		jmp	loc_41A801
; ---------------------------------------------------------------------------

loc_41A6FA:				; CODE XREF: sub_4199C0+ACBj
		mov	eax, [edi+2Ch]
		test	al, 2
		jz	loc_41A801
		mov	ecx, [ebp+0Ch]
		test	ecx, ecx
		jnz	short loc_41A714
		test	al, 4
		jz	loc_41A801

loc_41A714:				; CODE XREF: sub_4199C0+D4Aj
		mov	eax, [edi+164h]
		mov	[esp+160h+var_128], eax
		mov	ecx, [ebp+4]
		test	ecx, ecx
		jz	short loc_41A733
		mov	edx, [esp+160h+var_124]
		mov	ecx, [ecx+20h]
		lea	ebx, [edx+9]
		mov	eax, ebx
		jmp	short loc_41A73F
; ---------------------------------------------------------------------------

loc_41A733:				; CODE XREF: sub_4199C0+D63j
		mov	eax, [esp+160h+var_124]
		mov	ecx, [ebp+38h]
		lea	ebx, [eax+9]
		mov	eax, ebx

loc_41A73F:				; CODE XREF: sub_4199C0+D71j
		cmp	dword ptr [ebp+0], 0
		lea	edx, [esp+160h+data]
		push	edx		; data
		push	offset Proc	; lpProc
		jz	short loc_41A756
		mov	edx, [esp+168h+h]
		inc	edx
		jmp	short loc_41A75D
; ---------------------------------------------------------------------------

loc_41A756:				; CODE XREF: sub_4199C0+D8Dj
		mov	edx, [esp+168h+var_120]
		add	edx, [ebp+38h]

loc_41A75D:				; CODE XREF: sub_4199C0+D94j
		push	edx		; yEnd
		push	ebx		; xEnd
		push	ecx		; yStart
		push	eax		; xStart
		call	ds:LineDDA
		mov	eax, [ebp+38h]
		mov	ecx, [esp+160h+var_120]
		add	eax, ecx
		mov	ecx, [esp+160h+var_124]
		lea	edx, [esp+160h+data]
		add	ecx, 12h
		push	edx		; data
		push	offset Proc	; lpProc
		push	eax		; yEnd
		push	ecx		; xEnd
		push	eax		; yStart
		push	ebx		; xStart
		call	ds:LineDDA
		jmp	short loc_41A801
; ---------------------------------------------------------------------------

loc_41A78D:				; CODE XREF: sub_4199C0+AC3j
		test	eax, eax
		jz	short loc_41A801
		test	byte ptr [ebp+44h], 4
		jz	short loc_41A801
		mov	eax, [esp+160h+arg_10]
		mov	edx, [ebp+8]
		mov	ecx, [esp+160h+arg_C]
		add	eax, 10h
		push	edx
		mov	edx, [esp+164h+arg_8]
		push	eax
		push	ecx
		push	edx
		jmp	short loc_41A7F7
; ---------------------------------------------------------------------------

loc_41A7B8:				; CODE XREF: sub_4199C0+84j
		mov	edx, [ebp+54h]
		xor	ecx, ecx
		cmp	edx, ecx
		mov	[ebp+14h], ecx
		mov	[ebp+1Ch], ecx
		mov	[ebp+18h], ecx
		mov	[ebp+20h], ecx
		mov	[ebp+34h], ecx
		mov	[ebp+3Ch], ecx
		mov	[ebp+38h], ecx
		mov	[ebp+40h], ecx
		jz	short loc_41A801
		test	byte ptr [ebp+44h], 4
		jz	short loc_41A801
		mov	ecx, [ebp+8]
		mov	edx, [esp+160h+arg_10]
		push	ecx		; int
		mov	ecx, [esp+164h+arg_C]
		add	edx, 10h
		push	edx		; int
		push	ecx		; int
		push	eax		; int

loc_41A7F7:				; CODE XREF: sub_4199C0+DF6j
		push	edi		; int
		push	esi		; hdc
		call	sub_4199C0
		add	esp, 18h

loc_41A801:				; CODE XREF: sub_4199C0+C55j
					; sub_4199C0+C64j ...
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	loc_419A12
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 150h
		retn
; ---------------------------------------------------------------------------

loc_41A817:				; CODE XREF: sub_4199C0+78j
		xor	eax, eax
		cmp	ebp, eax
		jz	short loc_41A838
		or	ecx, 0FFFFFFFFh
		mov	[ebp+14h], eax
		mov	[ebp+1Ch], ecx
		mov	[ebp+18h], eax
		mov	[ebp+20h], ecx
		mov	[ebp+34h], eax
		mov	[ebp+3Ch], ecx
		mov	[ebp+38h], eax
		mov	[ebp+40h], ecx

loc_41A838:				; CODE XREF: sub_4199C0+4Cj
					; sub_4199C0+E5Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 150h
		retn
sub_4199C0	endp

; ---------------------------------------------------------------------------
		align 4
off_41A844	dd offset loc_419D96	; DATA XREF: sub_4199C0+3CFr
		dd offset loc_419FB3	; jump table for switch	statement
		dd offset loc_41A12C
		dd offset loc_41A1BE
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41A860(HDC hdc, int, int, int, int, int, int,	int)
sub_41A860	proc near		; CODE XREF: sub_41A860+1F7p
					; sub_41AEF0+48p

var_114		= dword	ptr -114h
psizl		= tagSIZE ptr -108h
String		= byte ptr -100h
hdc		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 118h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ds:GetSysColor
		push	8		; nIndex
		call	edi ; GetSysColor
		mov	esi, [esp+128h+hdc]
		push	eax		; color
		push	esi		; hdc
		call	ds:SetTextColor
		push	5		; nIndex
		call	edi ; GetSysColor
		push	eax		; color
		push	esi		; hdc
		call	ds:SetBkColor
		mov	ebp, [esp+128h+arg_18]
		test	ebp, ebp
		jz	loc_41AA6A
		mov	edi, [esp+128h+arg_4]

loc_41A8A5:				; CODE XREF: sub_41A860+204j
		mov	eax, [esp+128h+arg_C]
		mov	ecx, [eax]
		inc	ecx
		mov	[eax], ecx
		mov	edx, [edi+0F4h]
		mov	ebx, [edi+0F0h]
		lea	ebx, [edx+ebx+2]
		cmp	ecx, ebx
		jg	loc_41AA6A
		cmp	ecx, edx
		jle	loc_41AA22
		mov	ecx, [edi+30h]
		test	ecx, ecx
		jz	loc_41A9E0
		test	byte ptr [ebp+44h], 2
		jz	loc_41A9E0
		mov	ebx, [esp+128h+arg_14]
		test	ebx, ebx
		jz	short loc_41A8FF
		test	byte ptr [esp+128h+arg_8], 1
		jnz	loc_41A9E0

loc_41A8FF:				; CODE XREF: sub_41A860+8Fj
		mov	eax, [esp+128h+arg_1C]
		mov	ecx, [esp+128h+arg_10]
		shl	ebx, 4
		mov	dword ptr [eax], 1
		mov	eax, [ecx]
		inc	eax
		mov	[esp+128h+var_114], eax
		mov	eax, [ebp+44h]
		test	al, 8
		jz	short loc_41A92A
		mov	edx, [edi+24h]
		push	edx
		jmp	short loc_41A938
; ---------------------------------------------------------------------------

loc_41A92A:				; CODE XREF: sub_41A860+C2j
		test	al, 10h
		jz	short loc_41A934
		mov	eax, [edi+20h]
		push	eax
		jmp	short loc_41A938
; ---------------------------------------------------------------------------

loc_41A934:				; CODE XREF: sub_41A860+CCj
		mov	ecx, [edi+1Ch]
		push	ecx		; h

loc_41A938:				; CODE XREF: sub_41A860+C8j
					; sub_41A860+D2j
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [edi+0E4h]
		mov	ecx, [ebp+48h]
		lea	edx, [esp+128h+String]
		sub	eax, 26h
		push	edx		; lpString1
		push	eax		; int
		push	ecx		; lpString2
		push	esi		; hdc
		call	sub_4196F0
		add	esp, 10h
		lea	edx, [esp+128h+psizl]
		lea	eax, [esp+128h+String]
		push	edx		; psizl
		push	eax		; lpString
		call	ds:lstrlenA
		lea	ecx, [esp+12Ch+String]
		push	eax		; c
		push	ecx		; lpString
		push	esi		; hdc
		call	ds:GetTextExtentPoint32A
		push	0		; align
		push	esi		; hdc
		call	ds:SetTextAlign
		lea	edx, [esp+128h+String]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	ecx, [esp+128h+var_114]
		push	eax		; c
		lea	eax, [esp+12Ch+String]
		inc	ecx
		push	eax		; lpString
		lea	edx, [ebx+16h]
		push	ecx		; y
		push	edx		; x
		push	esi		; hdc
		call	ds:TextOutA
		cmp	dword ptr [edi+0E4h], 22h
		jl	short loc_41A9CE
		mov	eax, [edi+18Ch]
		mov	edx, [esp+128h+var_114]
		mov	ecx, [ebp+4Ch]
		add	eax, edx
		mov	edx, [edi+0B8h]
		push	1		; fStyle
		push	eax		; y
		push	ebx		; x
		push	esi		; hdcDst
		push	ecx		; i
		push	edx		; himl
		call	ds:ImageList_Draw

loc_41A9CE:				; CODE XREF: sub_41A860+14Aj
		mov	eax, [edi+1Ch]
		push	eax		; h
		push	esi		; hdc
		call	ds:SelectObject
		mov	eax, [esp+128h+arg_C]

loc_41A9E0:				; CODE XREF: sub_41A860+76j
					; sub_41A860+80j ...
		mov	edx, [esp+128h+arg_1C]
		cmp	dword ptr [edx], 0
		jz	short loc_41A9FD
		mov	ecx, [esp+128h+arg_10]
		mov	ebx, [edi+0FCh]
		add	[ecx], ebx
		jmp	short loc_41AA04
; ---------------------------------------------------------------------------

loc_41A9FD:				; CODE XREF: sub_41A860+18Aj
		mov	ecx, [esp+128h+arg_10]

loc_41AA04:				; CODE XREF: sub_41A860+19Bj
		mov	ebx, [ebp+54h]
		test	ebx, ebx
		jz	short loc_41AA5F
		test	byte ptr [ebp+44h], 4
		jz	short loc_41AA5F
		push	edx
		mov	edx, [ebp+8]
		push	edx
		mov	edx, [esp+130h+arg_14]
		inc	edx
		push	edx
		push	ecx
		jmp	short loc_41AA4C
; ---------------------------------------------------------------------------

loc_41AA22:				; CODE XREF: sub_41A860+6Bj
		mov	ecx, [ebp+54h]
		test	ecx, ecx
		jz	short loc_41AA5F
		test	byte ptr [ebp+44h], 4
		jz	short loc_41AA5F
		mov	ecx, [esp+128h+arg_1C]
		mov	edx, [ebp+8]
		push	ecx		; int
		mov	ecx, [esp+12Ch+arg_14]
		push	edx		; int
		mov	edx, [esp+130h+arg_10]
		inc	ecx
		push	ecx		; int
		push	edx		; int

loc_41AA4C:				; CODE XREF: sub_41A860+1C0j
		push	eax		; int
		mov	eax, [esp+13Ch+arg_8]
		push	eax		; int
		push	edi		; int
		push	esi		; hdc
		call	sub_41A860
		add	esp, 20h

loc_41AA5F:				; CODE XREF: sub_41A860+1A9j
					; sub_41A860+1AFj ...
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	loc_41A8A5

loc_41AA6A:				; CODE XREF: sub_41A860+38j
					; sub_41A860+63j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 118h
		retn
sub_41A860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41AA80	proc near		; CODE XREF: sub_41AA80+E8p
					; sub_41AF50+4Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_14]
		push	esi
		test	ebp, ebp
		push	edi
		jz	loc_41AB7B
		mov	esi, [esp+10h+arg_0]
		mov	ebx, [esp+10h+arg_1C]
		mov	edi, [esp+10h+arg_C]

loc_41AA9C:				; CODE XREF: sub_41AA80+F5j
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [eax]
		inc	ecx
		mov	[eax], ecx
		mov	ecx, [esi+0F4h]
		mov	edx, [esi+0F0h]
		lea	edx, [edx+ecx+2]
		mov	ecx, [eax]
		cmp	ecx, edx
		jg	loc_41AB7B
		cmp	ecx, [esi+0F4h]
		jle	short loc_41AB43
		mov	ecx, [esi+30h]
		test	ecx, ecx
		jz	short loc_41AB11
		test	byte ptr [ebp+44h], 2
		jz	short loc_41AB11
		mov	ecx, [esp+10h+arg_10]
		test	ecx, ecx
		jz	short loc_41AAE3
		test	byte ptr [esp+10h+arg_4], 1
		jnz	short loc_41AB11

loc_41AAE3:				; CODE XREF: sub_41AA80+5Aj
		mov	ecx, [esp+10h+arg_18]
		cmp	dword ptr [ecx], 0
		jz	short loc_41AAFB
		mov	ecx, [esi+0FCh]
		mov	edx, [edi]
		add	ecx, edx
		mov	[ebx+0Ch], ecx
		jmp	short loc_41AB11
; ---------------------------------------------------------------------------

loc_41AAFB:				; CODE XREF: sub_41AA80+6Aj
		mov	edx, [edi]
		mov	[ebx+4], edx
		mov	edx, [esi+0FCh]
		add	edx, [edi]
		mov	[ebx+0Ch], edx
		mov	dword ptr [ecx], 1

loc_41AB11:				; CODE XREF: sub_41AA80+4Cj
					; sub_41AA80+52j ...
		mov	ecx, [esi+0FCh]
		mov	edx, [edi]
		add	edx, ecx
		mov	[edi], edx
		mov	ecx, [ebp+54h]
		test	ecx, ecx
		jz	short loc_41AB70
		test	byte ptr [ebp+44h], 4
		jz	short loc_41AB70
		mov	edx, [esp+10h+arg_18]
		mov	ecx, [ebp+8]
		push	ebx
		push	edx
		mov	edx, [esp+18h+arg_10]
		push	ecx
		inc	edx
		push	edx
		push	edi
		push	eax
		mov	eax, [esp+28h+arg_4]
		push	eax
		jmp	short loc_41AB67
; ---------------------------------------------------------------------------

loc_41AB43:				; CODE XREF: sub_41AA80+45j
		mov	ecx, [ebp+54h]
		test	ecx, ecx
		jz	short loc_41AB70
		test	byte ptr [ebp+44h], 4
		jz	short loc_41AB70
		mov	ecx, [esp+10h+arg_18]
		mov	edx, [ebp+8]
		push	ebx
		push	ecx
		mov	ecx, [esp+18h+arg_10]
		push	edx
		mov	edx, [esp+1Ch+arg_4]
		inc	ecx
		push	ecx
		push	edi
		push	eax
		push	edx

loc_41AB67:				; CODE XREF: sub_41AA80+C1j
		push	esi
		call	sub_41AA80
		add	esp, 20h

loc_41AB70:				; CODE XREF: sub_41AA80+A2j
					; sub_41AA80+A8j ...
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jnz	loc_41AA9C

loc_41AB7B:				; CODE XREF: sub_41AA80+Aj
					; sub_41AA80+39j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_41AA80	endp


; =============== S U B	R O U T	I N E =======================================


sub_41AB80	proc near		; CODE XREF: sub_414980+340p
					; sub_414980+92Ap ...

var_1C		= SCROLLINFO ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	esi
		mov	esi, [esp+24h+arg_0]
		push	edi
		mov	ecx, [esi+0FCh]
		lea	ebx, [esi+118h]
		mov	eax, ecx
		cdq
		sub	eax, edx
		mov	edx, ebx
		sar	eax, 1
		add	eax, 2
		mov	[esi+188h], eax
		add	eax, 0FFFFFFF7h
		mov	[esi+18Ch], eax
		lea	eax, [esi+108h]
		inc	ecx
		mov	edi, [eax]
		mov	[edx], edi
		mov	edi, [eax+4]
		mov	[edx+4], edi
		mov	edi, [eax+8]
		mov	[edx+8], edi
		mov	eax, [eax+0Ch]
		mov	[edx+0Ch], eax
		mov	edi, [esi+11Ch]
		add	edi, ecx
		mov	ecx, [esi+0C8h]
		push	ecx
		mov	[esi+11Ch], edi
		call	sub_4197D0
		mov	edi, [esi+0FCh]
		mov	ecx, eax
		mov	eax, edi
		add	esp, 4
		cdq
		sub	eax, edx
		mov	[esi+0F8h], ecx
		mov	edx, eax
		mov	eax, [esi+124h]
		sar	edx, 1
		sub	eax, edx
		mov	edx, [esi+11Ch]
		sub	eax, edx
		cdq
		idiv	edi
		mov	edi, ds:GetSystemMetrics
		cmp	eax, ecx
		mov	[esi+0F0h], eax
		jg	short loc_41AC39
		push	2		; nIndex
		call	edi ; GetSystemMetrics
		mov	ecx, [esi+110h]
		sub	ecx, eax
		mov	[esi+120h], ecx
		jmp	short loc_41AC4F
; ---------------------------------------------------------------------------

loc_41AC39:				; CODE XREF: sub_41AB80+A3j
		mov	edx, [esi+110h]
		mov	dword ptr [esi+0F4h], 0
		mov	[esi+120h], edx

loc_41AC4F:				; CODE XREF: sub_41AB80+B7j
		mov	eax, [esi+120h]
		mov	edx, [ebx]
		mov	ecx, [esi+0E8h]
		sub	eax, edx
		cmp	ecx, eax
		jle	short loc_41AC77
		push	3		; nIndex
		call	edi ; GetSystemMetrics
		mov	ecx, [esi+114h]
		sub	ecx, eax
		mov	[esi+124h], ecx
		jmp	short loc_41AC83
; ---------------------------------------------------------------------------

loc_41AC77:				; CODE XREF: sub_41AB80+E1j
		mov	edx, [esi+114h]
		mov	[esi+124h], edx

loc_41AC83:				; CODE XREF: sub_41AB80+F5j
		mov	ecx, [esi+0FCh]
		mov	edi, [esi+11Ch]
		mov	eax, ecx
		push	1		; redraw
		cdq
		sub	eax, edx
		mov	[esp+2Ch+var_1C.cbSize], 1Ch
		mov	edx, eax
		mov	eax, [esi+124h]
		sar	edx, 1
		sub	eax, edx
		mov	[esp+2Ch+var_1C.fMask],	7
		sub	eax, edi
		mov	edi, ds:SetScrollInfo
		cdq
		idiv	ecx
		mov	ecx, [esi+0F8h]
		mov	edx, [esi+0F4h]
		mov	[esp+2Ch+var_1C.nMax], ecx
		mov	ecx, [esi]
		mov	[esp+2Ch+var_1C.nMin], 0
		mov	[esp+2Ch+var_1C.nPos], edx
		mov	[esi+0F0h], eax
		mov	[esp+2Ch+var_1C.nPage],	eax
		lea	eax, [esp+2Ch+var_1C]
		push	eax		; lpsi
		push	1		; nBar
		push	ecx		; hwnd
		call	edi ; SetScrollInfo
		mov	edx, [esi+0E8h]
		mov	eax, [esi+120h]
		mov	ecx, [ebx]
		mov	[esp+28h+var_1C.nMax], edx
		sub	eax, ecx
		mov	ecx, [esi+0ECh]
		lea	edx, [esp+28h+var_1C]
		mov	[esp+28h+var_1C.nPage],	eax
		mov	eax, [esi]
		push	1		; redraw
		push	edx		; lpsi
		push	0		; nBar
		push	eax		; hwnd
		mov	[esp+38h+var_1C.nPos], ecx
		call	edi ; SetScrollInfo
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1Ch
		retn
sub_41AB80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41AD30(int, HDC hdc)
sub_41AD30	proc near		; CODE XREF: sub_41AE00+AFp

h		= dword	ptr -4
arg_0		= dword	ptr  4
hdc		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ds:SelectObject
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		mov	edi, [esp+14h+hdc]
		mov	eax, [esi+1Ch]
		push	eax		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		mov	ecx, [esi+158h]
		mov	ebp, eax
		push	ecx		; h
		call	ds:UnrealizeObject
		mov	edx, [esi+0ECh]
		push	0		; lppt
		neg	edx
		push	0		; y
		push	edx		; x
		push	edi		; hdc
		call	ds:SetBrushOrgEx
		mov	eax, [esi+158h]
		push	eax		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		mov	ecx, [esi+11Ch]
		mov	edx, [esi+0C8h]
		mov	[esp+14h+h], eax
		mov	[esp+14h+arg_0], ecx
		push	edx		; int
		lea	eax, [esp+18h+arg_0]
		push	0		; int
		lea	ecx, [esp+1Ch+hdc]
		push	eax		; int
		push	ecx		; int
		push	esi		; int
		push	edi		; hdc
		mov	[esp+2Ch+hdc], 0
		call	sub_4199C0
		mov	edx, [esp+2Ch+h]
		add	esp, 18h
		push	edx		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		push	ebp		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_41AD30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41ADC0	proc near		; CODE XREF: sub_414980+3C1p
					; sub_419040+9Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_41ADF2
		mov	ecx, [esi+18h]
		push	ecx		; h
		push	eax		; hdc
		call	ds:SelectObject
		mov	edx, [esi+14h]
		push	edx		; ho
		call	ds:DeleteObject
		mov	eax, [esi+10h]
		push	eax		; hdc
		call	ds:DeleteDC
		mov	dword ptr [esi+10h], 0

loc_41ADF2:				; CODE XREF: sub_41ADC0+Aj
		pop	esi
		retn
sub_41ADC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41AE00(int, HDC hdc, int)
sub_41AE00	proc near		; CODE XREF: sub_414980+35Dp
					; sub_414980+946p

Rect		= tagRECT ptr -10h
arg_0		= dword	ptr  4
hdc		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 10h
		lea	eax, [esp+10h+Rect]
		push	esi
		mov	esi, [esp+14h+arg_0]
		push	edi
		push	eax		; lpRect
		mov	ecx, [esi]
		push	ecx		; hWnd
		call	ds:GetClientRect
		mov	eax, [esi+10h]
		mov	edi, [esp+18h+hdc]
		test	eax, eax
		jnz	short loc_41AE64
		push	edi		; hdc
		call	ds:CreateCompatibleDC
		mov	edx, [esp+18h+Rect.bottom]
		mov	ecx, [esp+18h+Rect.top]
		sub	edx, ecx
		mov	[esi+10h], eax
		mov	eax, [esp+18h+Rect.right]
		push	edx		; cy
		sub	eax, [esp+1Ch+Rect.left]
		push	eax		; cx
		push	edi		; hdc
		call	ds:CreateCompatibleBitmap
		mov	ecx, [esi+10h]
		push	eax		; h
		push	ecx		; hdc
		mov	[esi+14h], eax
		call	ds:SelectObject
		mov	edx, [esi+10h]
		push	1		; mode
		push	edx		; hdc
		mov	[esi+18h], eax
		call	ds:SetBkMode

loc_41AE64:				; CODE XREF: sub_41AE00+20j
		mov	eax, [esp+18h+arg_8]
		test	eax, eax
		jz	short loc_41AE94
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_41AE94
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_41AE94
		mov	ecx, [eax+10h]
		mov	edx, [esi+110h]
		cmp	ecx, edx
		jz	short loc_41AE94
		mov	edx, [eax+14h]
		mov	eax, [esi+114h]
		cmp	edx, eax
		jnz	short loc_41AEB7

loc_41AE94:				; CODE XREF: sub_41AE00+6Aj
					; sub_41AE00+71j ...
		mov	eax, [esi+140h]
		mov	edx, [esi+10h]
		lea	ecx, [esp+18h+Rect]
		push	eax		; hbr
		push	ecx		; lprc
		push	edx		; hDC
		call	ds:FillRect
		mov	eax, [esi+10h]
		push	eax		; hdc
		push	esi		; int
		call	sub_41AD30
		add	esp, 8

loc_41AEB7:				; CODE XREF: sub_41AE00+92j
		mov	edx, [esp+18h+Rect.bottom]
		mov	eax, [esp+18h+Rect.top]
		mov	ecx, [esi+10h]
		push	0CC0020h	; rop
		push	0		; y1
		push	0		; x1
		sub	edx, eax
		push	ecx		; hdcSrc
		mov	ecx, [esp+28h+Rect.left]
		push	edx		; cy
		mov	edx, [esp+2Ch+Rect.right]
		sub	edx, ecx
		push	edx		; cx
		push	eax		; y
		push	ecx		; x
		push	edi		; hdc
		call	ds:BitBlt
		pop	edi
		pop	esi
		add	esp, 10h
		retn
sub_41AE00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41AEF0(int, int, HDC hdc)
sub_41AEF0	proc near		; CODE XREF: sub_41AFB0+D8p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
hdc		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ds:SelectObject
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		mov	edi, [esp+14h+hdc]
		mov	eax, [esi+1Ch]
		push	eax		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		mov	edx, [esi+0C8h]
		lea	ecx, [esp+14h+arg_0]
		mov	ebp, eax
		xor	eax, eax
		push	ecx		; int
		push	edx		; int
		mov	edx, [esp+1Ch+arg_4]
		mov	[esp+1Ch+hdc], eax
		mov	[esp+1Ch+var_4], eax
		mov	[esp+1Ch+arg_0], eax
		push	eax		; int
		lea	eax, [esp+20h+hdc]
		lea	ecx, [esp+20h+var_4]
		push	eax		; int
		push	ecx		; int
		push	edx		; int
		push	esi		; int
		push	edi		; hdc
		call	sub_41A860
		add	esp, 20h
		push	ebp		; h
		push	edi		; hdc
		call	ebx ; SelectObject
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_41AEF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41AF50	proc near		; CODE XREF: sub_41AFB0+24p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	eax, [esp+4+arg_8]
		mov	ecx, [esp+4+arg_0]
		push	eax
		mov	dword ptr [eax], 12h
		mov	edx, [ecx+0E4h]
		add	edx, 12h
		mov	[eax+8], edx
		xor	edx, edx
		mov	[eax+4], edx
		mov	[eax+0Ch], edx
		lea	eax, [esp+8+arg_8]
		mov	[esp+8+arg_0], edx
		push	eax
		mov	eax, [ecx+0C8h]
		push	eax
		mov	[esp+10h+var_4], edx
		mov	[esp+10h+arg_8], edx
		push	edx
		lea	edx, [esp+14h+arg_0]
		lea	eax, [esp+14h+var_4]
		push	edx
		mov	edx, [esp+18h+arg_4]
		push	eax
		push	edx
		push	ecx
		call	sub_41AA80
		add	esp, 24h
		retn
sub_41AF50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41AFB0(int, HGDIOBJ h)
sub_41AFB0	proc near		; CODE XREF: sub_414980+973p

rc		= RECT ptr -10h
arg_0		= dword	ptr  4
h		= dword	ptr  8

		sub	esp, 10h
		push	esi
		mov	esi, [esp+14h+h]
		test	esi, esi
		jnz	short loc_41AFC3
		xor	eax, eax
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_41AFC3:				; CODE XREF: sub_41AFB0+Aj
		mov	ecx, [esi+1Ch]
		push	ebx
		mov	ebx, [esp+18h+arg_0]
		push	ebp
		lea	eax, [esp+1Ch+rc]
		push	edi
		push	eax
		push	ecx
		push	ebx
		call	sub_41AF50
		mov	edx, [esp+2Ch+rc.right]
		mov	eax, [esp+2Ch+rc.left]
		mov	ecx, [esp+2Ch+rc.top]
		sub	edx, eax
		mov	[esi+4], edx
		mov	edx, [esp+2Ch+rc.bottom]
		sub	edx, ecx
		add	esp, 0Ch
		mov	[esi+8], edx
		mov	edx, [esi+0Ch]
		sub	edx, eax
		mov	eax, [esi+10h]
		mov	[esi+14h], edx
		mov	edx, [ebx+11Ch]
		sub	eax, edx
		push	0		; hdc
		sub	eax, ecx
		mov	[esi+18h], eax
		call	ds:CreateCompatibleDC
		mov	ecx, [ebx]
		mov	edi, eax
		push	ecx		; hWnd
		call	ds:GetDC
		mov	edx, [esi+8]
		mov	ebp, eax
		mov	eax, [esi+4]
		push	edx		; cy
		push	eax		; cx
		push	ebp		; hdc
		call	ds:CreateCompatibleBitmap
		mov	[esi], eax
		mov	ecx, [ebx]
		push	ebp		; hDC
		push	ecx		; hWnd
		call	ds:ReleaseDC
		mov	edx, [esi]
		mov	ebp, ds:SelectObject
		push	edx		; h
		push	edi		; hdc
		call	ebp ; SelectObject
		push	1		; mode
		push	edi		; hdc
		mov	[esp+28h+h], eax
		call	ds:SetBkMode
		mov	edx, [ebx+140h]
		xor	eax, eax
		mov	ecx, [esi+8]
		mov	[esp+20h+rc.left], eax
		mov	[esp+20h+rc.top], eax
		mov	eax, [esi+4]
		mov	[esp+20h+rc.right], eax
		lea	eax, [esp+20h+rc]
		push	edx		; hbr
		push	eax		; lprc
		push	edi		; hDC
		mov	[esp+2Ch+rc.bottom], ecx
		call	ds:FillRect
		mov	ecx, [esi+1Ch]
		push	edi		; hdc
		push	ecx		; int
		push	ebx		; int
		call	sub_41AEF0
		mov	edx, [esp+2Ch+h]
		add	esp, 0Ch
		push	edx		; h
		push	edi		; hdc
		call	ebp ; SelectObject
		push	edi		; hdc
		call	ds:DeleteDC
		mov	eax, 1
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 10h
		retn
sub_41AFB0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION PGPEstimatePassphraseQuality]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B0C0	proc near		; CODE XREF: sub_4020A0+81p
					; sub_408020+A3p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		push	edi
		test	ebx, ebx
		jz	short loc_41B0D1
		mov	dword ptr [ebx], 0

loc_41B0D1:				; CODE XREF: sub_41B0C0+9j
		mov	edi, [esp+0Ch+arg_C]
		test	edi, edi
		jz	short loc_41B0F4
		test	ebx, ebx
		mov	dword ptr [edi], 0
		jnz	short loc_41B0EC
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B0EC:				; CODE XREF: sub_41B0C0+21j
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jnz	short loc_41B0FD

loc_41B0F4:				; CODE XREF: sub_41B0C0+17j
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B0FD:				; CODE XREF: sub_41B0C0+32j
		mov	ecx, [esp+0Ch+arg_4]
		lea	eax, [esp+0Ch+arg_8]
		push	eax
		push	ecx
		push	esi
		call	sub_41B290
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_41B163
		mov	eax, [esp+0Ch+arg_8]
		test	eax, eax
		jnz	short loc_41B125
		pop	edi
		pop	esi
		mov	eax, 0FFFFD135h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B125:				; CODE XREF: sub_41B0C0+5Aj
		mov	edx, [eax+4]
		mov	eax, [esi]
		push	1
		push	edx
		push	eax
		call	PGPNewData
		add	esp, 0Ch
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_41B145
		pop	edi
		pop	esi
		mov	eax, 0FFFFD121h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B145:				; CODE XREF: sub_41B0C0+7Aj
		mov	eax, [esp+0Ch+arg_8]
		mov	ecx, [eax+4]
		mov	[ebx], ecx
		mov	edx, [eax+4]
		mov	ecx, [edi]
		push	edx		; size_t
		mov	edx, [eax+8]
		push	ecx		; void *
		push	edx		; void *
		call	sub_41B4F0
		add	esp, 0Ch
		xor	eax, eax

loc_41B163:				; CODE XREF: sub_41B0C0+52j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_41B0C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41B170(int, int, size_t, void	*)
sub_41B170	proc near		; CODE XREF: sub_4021A0+A4p
					; sub_40C040+91p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		test	esi, esi
		jnz	short loc_41B184
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B184:				; CODE XREF: sub_41B170+9j
		mov	ebx, [esp+0Ch+arg_C]
		test	ebx, ebx
		jnz	short loc_41B195
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B195:				; CODE XREF: sub_41B170+1Aj
		mov	edi, [esp+0Ch+arg_4]
		lea	eax, [esp+0Ch+arg_0]
		push	eax
		push	edi
		push	esi
		call	sub_41B290
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_41B252
		mov	eax, [esp+0Ch+arg_0]
		test	eax, eax
		jnz	short loc_41B1F3
		mov	ecx, [esi]
		push	1
		push	14h
		push	ecx
		call	PGPNewData
		add	esp, 0Ch
		mov	[esp+0Ch+arg_0], eax
		test	eax, eax
		jnz	short loc_41B1D8
		pop	edi
		pop	esi
		mov	eax, 0FFFFD121h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B1D8:				; CODE XREF: sub_41B170+5Dj
		mov	[eax], edi
		mov	edx, [esp+0Ch+arg_0]
		mov	dword ptr [edx+8], 0
		mov	eax, [esp+0Ch+arg_0]
		push	eax
		push	esi
		call	sub_41B2E0
		add	esp, 8

loc_41B1F3:				; CODE XREF: sub_41B170+46j
		mov	ecx, [esp+0Ch+arg_0]
		mov	edi, [esp+0Ch+arg_8]
		mov	[ecx+4], edi
		mov	edx, [esp+0Ch+arg_0]
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_41B212
		push	eax
		call	PGPFreeData
		add	esp, 4

loc_41B212:				; CODE XREF: sub_41B170+97j
		mov	eax, [esi]
		push	1
		push	edi
		push	eax
		call	PGPNewData
		mov	ecx, [esp+18h+arg_0]
		add	esp, 0Ch
		mov	[ecx+8], eax
		mov	ecx, [esp+0Ch+arg_0]
		mov	eax, [ecx+8]
		test	eax, eax
		jnz	short loc_41B245
		push	ecx
		push	esi
		call	sub_41B330
		add	esp, 8
		mov	eax, 0FFFFD121h
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B245:				; CODE XREF: sub_41B170+C0j
		push	edi		; size_t
		push	eax		; void *
		push	ebx		; void *
		call	sub_41B4F0
		add	esp, 0Ch
		xor	eax, eax

loc_41B252:				; CODE XREF: sub_41B170+3Aj
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_41B170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B260	proc near		; CODE XREF: sub_4020A0+DAp
					; sub_408020+3D8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_41B26E
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B26E:				; CODE XREF: sub_41B260+6j
		mov	eax, [esp+arg_4]
		test	eax, eax
		jnz	short loc_41B27C
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B27C:				; CODE XREF: sub_41B260+14j
		push	eax
		call	PGPFreeData
		add	esp, 4
		xor	eax, eax
		retn
sub_41B260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B290	proc near		; CODE XREF: sub_41B0C0+48p
					; sub_41B170+30p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	edi
		mov	edi, [esp+4+arg_8]
		test	edi, edi
		jz	short loc_41B2A7
		mov	eax, [esp+4+arg_0]
		mov	dword ptr [edi], 0
		test	eax, eax
		jnz	short loc_41B2AE

loc_41B2A7:				; CODE XREF: sub_41B290+7j
		mov	eax, 0FFFFD120h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_41B2AE:				; CODE XREF: sub_41B290+15j
		mov	eax, [eax+8]
		push	esi
		test	eax, eax
		mov	[esp+8+arg_8], eax
		jz	short loc_41B2D8
		mov	esi, [esp+8+arg_4]

loc_41B2BE:				; CODE XREF: sub_41B290+46j
		cmp	[eax], esi
		jz	short loc_41B2D8
		lea	ecx, [esp+8+arg_8]
		push	ecx
		push	eax
		call	sub_41B3A0
		mov	eax, [esp+10h+arg_8]
		add	esp, 8
		test	eax, eax
		jnz	short loc_41B2BE

loc_41B2D8:				; CODE XREF: sub_41B290+28j
					; sub_41B290+30j
		mov	[edi], eax
		pop	esi
		xor	eax, eax
		pop	edi
		retn
sub_41B290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B2E0	proc near		; CODE XREF: sub_41B170+7Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_41B2EE
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B2EE:				; CODE XREF: sub_41B2E0+6j
		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jnz	short loc_41B2FC
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B2FC:				; CODE XREF: sub_41B2E0+14j
		mov	edx, [eax+8]
		test	edx, edx
		jnz	short loc_41B306
		mov	[eax+8], ecx

loc_41B306:				; CODE XREF: sub_41B2E0+21j
		mov	edx, [eax+0Ch]
		test	edx, edx
		jz	short loc_41B310
		mov	[edx+0Ch], ecx

loc_41B310:				; CODE XREF: sub_41B2E0+2Bj
		mov	edx, [eax+0Ch]
		mov	dword ptr [ecx+0Ch], 0
		mov	[ecx+10h], edx
		mov	[eax+0Ch], ecx
		xor	eax, eax
		retn
sub_41B2E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B330	proc near		; CODE XREF: sub_41B170+C4p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jnz	short loc_41B342
		pop	edi
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41B342:				; CODE XREF: sub_41B330+8j
		mov	esi, [esp+8+arg_4]
		test	esi, esi
		jnz	short loc_41B352
		pop	edi
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41B352:				; CODE XREF: sub_41B330+18j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_41B362
		push	eax
		call	PGPFreeData
		add	esp, 4

loc_41B362:				; CODE XREF: sub_41B330+27j
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_41B36F
		mov	ecx, [esi+10h]
		mov	[eax+10h], ecx

loc_41B36F:				; CODE XREF: sub_41B330+37j
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_41B37C
		mov	edx, [esi+0Ch]
		mov	[eax+0Ch], edx

loc_41B37C:				; CODE XREF: sub_41B330+44j
		cmp	[edi+8], esi
		jnz	short loc_41B387
		mov	eax, [esi+0Ch]
		mov	[edi+8], eax

loc_41B387:				; CODE XREF: sub_41B330+4Fj
		cmp	[edi+0Ch], esi
		jnz	short loc_41B392
		mov	ecx, [esi+10h]
		mov	[edi+0Ch], ecx

loc_41B392:				; CODE XREF: sub_41B330+5Aj
		push	esi
		call	PGPFreeData
		add	esp, 4
		xor	eax, eax
		pop	edi
		pop	esi
		retn
sub_41B330	endp


; =============== S U B	R O U T	I N E =======================================


sub_41B3A0	proc near		; CODE XREF: sub_41B290+38p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_41B3B6
		mov	ecx, [esp+arg_0]
		mov	dword ptr [eax], 0
		test	ecx, ecx
		jnz	short loc_41B3BC

loc_41B3B6:				; CODE XREF: sub_41B3A0+6j
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B3BC:				; CODE XREF: sub_41B3A0+14j
		mov	ecx, [ecx+0Ch]
		mov	[eax], ecx
		xor	eax, eax
		retn
sub_41B3A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B3D0	proc near		; CODE XREF: WinMain(x,x,x,x)+10Dp
					; WinMain(x,x,x,x)+11Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		test	edi, edi
		jz	short loc_41B414
		mov	edx, [esp+8+arg_4]
		mov	esi, [esp+8+arg_0]
		lea	eax, [esp+8+arg_8]
		lea	ecx, [esp+8+arg_4]
		push	eax
		push	ecx
		push	edx
		push	esi
		mov	byte ptr [edi],	0
		call	sub_41B0C0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_41B42C
		mov	eax, [esp+8+arg_4]
		cmp	eax, 1
		mov	eax, [esp+8+arg_8]
		jz	short loc_41B41C
		push	eax
		push	esi
		call	sub_41B260
		add	esp, 8

loc_41B414:				; CODE XREF: sub_41B3D0+8j
		pop	edi
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41B41C:				; CODE XREF: sub_41B3D0+38j
		mov	cl, [eax]
		push	eax
		push	esi
		mov	[edi], cl
		call	sub_41B260
		add	esp, 8
		xor	eax, eax

loc_41B42C:				; CODE XREF: sub_41B3D0+2Bj
		pop	edi
		pop	esi
		retn
sub_41B3D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B430	proc near		; CODE XREF: .text:0040F55Bp
					; sub_4112A0+76p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		lea	eax, [esp+arg_8]
		push	eax		; void *
		push	1		; size_t
		push	ecx		; int
		push	edx		; int
		call	sub_41B170
		add	esp, 10h
		retn
sub_41B430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B450	proc near		; CODE XREF: sub_411790+E2p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_8]
		test	edi, edi
		jz	short loc_41B495
		mov	edx, [esp+8+arg_4]
		mov	esi, [esp+8+arg_0]
		lea	eax, [esp+8+arg_8]
		lea	ecx, [esp+8+arg_4]
		push	eax
		push	ecx
		push	edx
		push	esi
		mov	dword ptr [edi], 0
		call	sub_41B0C0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_41B4BB
		cmp	[esp+8+arg_4], 4
		jz	short loc_41B49D
		mov	eax, [esp+8+arg_8]
		push	eax
		push	esi
		call	sub_41B260
		add	esp, 8

loc_41B495:				; CODE XREF: sub_41B450+8j
		pop	edi
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41B49D:				; CODE XREF: sub_41B450+35j
		mov	ecx, [esp+8+arg_8]
		push	ecx
		push	0
		call	sub_41B510
		mov	edx, [esp+10h+arg_8]
		mov	[edi], eax
		push	edx
		push	esi
		call	sub_41B260
		add	esp, 10h
		xor	eax, eax

loc_41B4BB:				; CODE XREF: sub_41B450+2Ej
		pop	edi
		pop	esi
		retn
sub_41B450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B4C0	proc near		; CODE XREF: sub_412530+11Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		lea	eax, [esp+arg_8]
		push	eax
		push	0
		push	ecx
		call	sub_41B560
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_0]
		lea	edx, [esp+0Ch+arg_8]
		push	edx		; void *
		push	4		; size_t
		push	eax		; int
		push	ecx		; int
		call	sub_41B170
		add	esp, 1Ch
		retn
sub_41B4C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41B4F0(void *, void *, size_t)
sub_41B4F0	proc near		; CODE XREF: sub_41B0C0+99p
					; sub_41B170+D8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_0]
		mov	edx, [esp+arg_4]
		push	eax		; void *
		push	ecx		; void *
		push	edx		; void *
		call	near ptr _memcpy
		add	esp, 0Ch
		retn
sub_41B4F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B510	proc near		; CODE XREF: sub_41B450+54p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_41B53A
		mov	eax, [esp+arg_4]
		xor	ecx, ecx
		xor	edx, edx
		mov	ch, [eax]
		mov	dl, [eax+2]
		mov	cl, [eax+1]
		shl	ecx, 8
		or	ecx, edx
		xor	edx, edx
		mov	dl, [eax+3]
		shl	ecx, 8
		or	ecx, edx
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_41B53A:				; CODE XREF: sub_41B510+6j
		mov	eax, [esp+arg_4]
		xor	ecx, ecx
		xor	edx, edx
		mov	ch, [eax+3]
		mov	dl, [eax+1]
		mov	cl, [eax+2]
		shl	ecx, 8
		or	ecx, edx
		xor	edx, edx
		mov	dl, [eax]
		shl	ecx, 8
		or	ecx, edx
		mov	eax, ecx
		retn
sub_41B510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B560	proc near		; CODE XREF: sub_41B4C0+Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		test	eax, eax
		mov	eax, [esp+arg_0]
		jnz	short loc_41B58B
		mov	ecx, [esp+arg_8]
		mov	edx, eax
		shr	edx, 18h
		mov	[ecx], dl
		mov	edx, eax
		shr	edx, 10h
		mov	[ecx+1], dl
		mov	edx, eax
		shr	edx, 8
		mov	[ecx+2], dl
		mov	[ecx+3], al
		retn
; ---------------------------------------------------------------------------

loc_41B58B:				; CODE XREF: sub_41B560+Aj
		mov	ecx, [esp+arg_8]
		mov	[ecx], al
		shr	eax, 8
		mov	[ecx+1], al
		shr	eax, 8
		mov	[ecx+2], al
		shr	eax, 8
		mov	[ecx+3], al
		retn
sub_41B560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B5B0	proc near		; CODE XREF: sub_41B5D0+6p
					; sub_41B600+5p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_41B5CD
		cmp	dword ptr [eax], 5047494Fh
		jnz	short loc_41B5CD
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_41B5CD
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_41B5CD:				; CODE XREF: sub_41B5B0+6j
					; sub_41B5B0+Ej ...
		xor	eax, eax
		retn
sub_41B5B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_41B5D0	proc near		; DATA XREF: .rdata:0042B630o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	esi
		call	sub_41B5B0
		add	esp, 4
		test	al, al
		jnz	short loc_41B5E9
		mov	eax, 0FFFFD120h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41B5E9:				; CODE XREF: sub_41B5D0+10j
		xor	eax, eax
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		pop	esi
		retn
sub_41B5D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B600	proc near		; DATA XREF: .rdata:0042B634o
					; .rdata:0042B644o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_41B5B0
		add	esp, 4
		neg	al
		sbb	eax, eax
		and	eax, 2EE0h
		add	eax, 0FFFFD120h
		retn
sub_41B600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B620	proc near		; DATA XREF: .rdata:0042B640o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [eax+10h]
		mov	[ecx], edx
		mov	eax, [eax+14h]
		mov	[ecx+4], eax
		xor	eax, eax
		retn
sub_41B620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B640	proc near		; DATA XREF: .rdata:0042B638o
					; .rdata:0042B63Co ...
		mov	eax, 0FFFFD128h
		retn
sub_41B640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B650	proc near		; DATA XREF: .rdata:0042B64Co
					; .rdata:0042B660o
		xor	eax, eax
		retn
sub_41B650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B660	proc near		; CODE XREF: sub_41B820+9p
					; sub_41B8E0+9p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_41B676
		cmp	dword ptr [eax], 251DEA9Bh
		jnz	short loc_41B676
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_41B676:				; CODE XREF: sub_41B660+6j
					; sub_41B660+Ej
		xor	eax, eax
		retn
sub_41B660	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B680	proc near		; CODE XREF: sub_41B9D0+67p
					; sub_41BA70+84p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		push	ebp
		xor	ebp, ebp
		push	edi
		cmp	eax, ebp
		jnz	short loc_41B694
		pop	edi
		mov	eax, 0FFFFD120h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41B694:				; CODE XREF: sub_41B680+Aj
		mov	edi, [esp+8+arg_0]
		mov	[eax], ebp
		push	edi
		call	PGPMemoryMgrIsValid
		add	esp, 4
		test	al, al
		jnz	short loc_41B6AF
		pop	edi
		mov	eax, 0FFFFD120h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41B6AF:				; CODE XREF: sub_41B680+25j
		push	ebx
		push	esi
		push	1
		push	18h
		push	edi
		call	PGPNewData
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebp
		jz	short loc_41B719
		mov	eax, [esp+10h+arg_4]
		mov	ebx, [esp+10h+arg_8]
		push	eax
		mov	dword ptr [esi], 251DEA9Bh
		mov	[esi+8], eax
		mov	[esi+4], edi
		mov	[esi+0Ch], ebx
		mov	[esi+14h], ebp
		call	sub_41BCD0
		add	esp, 4
		mov	[esi+10h], eax
		test	ebx, ebx
		jz	short loc_41B71E
		push	1
		push	ebx
		push	edi
		call	PGPNewData
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_41B70E
		mov	[esi+14h], eax
		mov	eax, [esp+10h+arg_C]
		mov	[eax], esi
		pop	esi
		pop	ebx
		mov	eax, ebp
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41B70E:				; CODE XREF: sub_41B680+7Cj
		push	esi
		call	PGPFreeData
		add	esp, 4
		xor	esi, esi

loc_41B719:				; CODE XREF: sub_41B680+42j
		mov	ebp, 0FFFFD121h

loc_41B71E:				; CODE XREF: sub_41B680+6Cj
		mov	eax, [esp+10h+arg_C]
		mov	[eax], esi
		pop	esi
		pop	ebx
		mov	eax, ebp
		pop	edi
		pop	ebp
		retn
sub_41B680	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_41BCD0

loc_41B730:				; CODE XREF: sub_41BCD0:loc_41BCDAj
		mov	eax, offset off_42B650
		retn
; END OF FUNCTION CHUNK	FOR sub_41BCD0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B740	proc near		; DATA XREF: .rdata:off_42B650o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [edx+14h]
		push	edi
		mov	edi, esi
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		xor	ebp, ebp
		repne scasb
		not	ecx
		dec	ecx
		push	eax
		mov	eax, [edx+4]
		mov	ebx, ecx
		inc	ebx
		push	ebx
		push	eax
		call	PGPNewData
		mov	edx, eax
		add	esp, 0Ch
		test	edx, edx
		jz	short loc_41B7A2
		mov	edi, esi
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		mov	eax, ebp
		and	ecx, 3
		rep movsb
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[ecx], edx
		mov	edx, [esp+4+arg_8]
		mov	[edx], ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B7A2:				; CODE XREF: sub_41B740+2Ej
		mov	ecx, [esp+10h+arg_4]
		mov	ebp, 0FFFFD121h
		pop	edi
		mov	eax, ebp
		mov	[ecx], edx
		mov	edx, [esp+0Ch+arg_8]
		pop	esi
		pop	ebp
		mov	[edx], ebx
		pop	ebx
		retn
sub_41B740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B7C0	proc near		; DATA XREF: .rdata:0042B654o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	al, [edi+ebp-1]
		test	al, al
		jz	short loc_41B7DA
		pop	edi
		mov	eax, 0FFFFD120h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41B7DA:				; CODE XREF: sub_41B7C0+10j
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	0
		push	ebp
		mov	eax, [esi+4]
		lea	ebx, [esi+14h]
		push	ebx
		push	eax
		call	PGPReallocData
		mov	edx, eax
		add	esp, 10h
		test	edx, edx
		jnz	short loc_41B817
		or	ecx, 0FFFFFFFFh
		mov	[esi+0Ch], ebp
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, [ebx]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb

loc_41B817:				; CODE XREF: sub_41B7C0+37j
		pop	esi
		pop	ebx
		pop	edi
		mov	eax, edx
		pop	ebp
		retn
sub_41B7C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B820	proc near		; DATA XREF: .rdata:0042B658o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		xor	ebx, ebx
		push	esi
		call	sub_41B660
		add	esp, 4
		test	al, al
		jnz	short loc_41B83D
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B83D:				; CODE XREF: sub_41B820+13j
		mov	eax, [esi+14h]
		test	eax, eax
		jnz	short loc_41B84C
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B84C:				; CODE XREF: sub_41B820+22j
		push	edi
		push	eax		; char *
		call	sub_41B8A0
		mov	edx, eax
		add	esp, 4
		test	edx, edx
		jz	short loc_41B895
		mov	edi, edx
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		cmp	ecx, 100h
		ja	short loc_41B895
		mov	edi, edx
		or	ecx, 0FFFFFFFFh
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, [esp+0Ch+arg_4]
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		mov	eax, ebx
		and	ecx, 3
		rep movsb
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41B895:				; CODE XREF: sub_41B820+3Aj
					; sub_41B820+4Ej
		mov	ebx, 0FFFFD120h
		pop	edi
		mov	eax, ebx
		pop	esi
		pop	ebx
		retn
sub_41B820	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41B8A0(char *)
sub_41B8A0	proc near		; CODE XREF: sub_41B820+2Ep
					; sub_41B8E0+5Cp ...

arg_0		= dword	ptr  4

		mov	al, ds:byte_42B680
		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		test	al, al
		mov	esi, offset byte_42B680
		jz	short loc_41B8D0

loc_41B8B4:				; CODE XREF: sub_41B8A0+2Ej
		movsx	eax, byte ptr [esi]
		push	eax		; int
		push	edi		; char *
		call	_strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_41B8C8
		lea	edi, [eax+1]

loc_41B8C8:				; CODE XREF: sub_41B8A0+23j
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_41B8B4

loc_41B8D0:				; CODE XREF: sub_41B8A0+12j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_41B8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B8E0	proc near		; CODE XREF: sub_41BC40+44p
					; DATA XREF: .rdata:0042B65Co

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	edi
		push	ebp
		call	sub_41B660
		add	esp, 4
		test	al, al
		jnz	short loc_41B8FF
		pop	edi
		pop	ebp
		mov	eax, 0FFFFD120h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_41B8FF:				; CODE XREF: sub_41B8E0+13j
		mov	ebx, [ebp+14h]
		test	ebx, ebx
		jnz	short loc_41B910
		pop	edi
		pop	ebp
		mov	eax, 0FFFFD120h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_41B910:				; CODE XREF: sub_41B8E0+24j
		mov	edi, [esp+10h+arg_4]
		test	edi, edi
		jnz	short loc_41B922
		pop	edi
		pop	ebp
		mov	eax, 0FFFFD120h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_41B922:				; CODE XREF: sub_41B8E0+36j
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	edi, ecx
		jnz	short loc_41B93A
		pop	edi
		pop	ebp
		mov	eax, 0FFFFD120h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_41B93A:				; CODE XREF: sub_41B8E0+4Ej
		push	esi
		push	ebx		; char *
		call	sub_41B8A0
		mov	esi, eax
		mov	ecx, [ebp+4]
		sub	esi, ebx
		push	0
		mov	[esp+1Ch+arg_0], ebx
		lea	eax, [esi+edi+1]
		mov	[esp+1Ch+var_4], eax
		push	eax
		lea	eax, [esp+20h+arg_0]
		push	eax
		push	ecx
		call	PGPReallocData
		mov	edx, eax
		add	esp, 14h
		test	edx, edx
		jnz	short loc_41B99D
		mov	eax, [esp+14h+arg_0]
		mov	edi, [esp+14h+arg_4]
		mov	[ebp+14h], eax
		or	ecx, 0FFFFFFFFh
		lea	ebx, [eax+esi]
		xor	eax, eax
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, ebx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	ecx, [esp+14h+var_4]
		mov	[ebp+0Ch], ecx

loc_41B99D:				; CODE XREF: sub_41B8E0+89j
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, edx
		pop	ebx
		pop	ecx
		retn
sub_41B8E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B9B0	proc near		; DATA XREF: .rdata:0042B674o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+14h]
		test	ecx, ecx
		jnz	short loc_41B9C1
		mov	eax, 0FFFFD120h
		retn
; ---------------------------------------------------------------------------

loc_41B9C1:				; CODE XREF: sub_41B9B0+9j
		mov	ecx, [esp+arg_4]
		xor	eax, eax
		mov	dword ptr [ecx], 0FFh
		retn
sub_41B9B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41B9D0	proc near		; DATA XREF: .rdata:0042B678o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	[esp+0Ch+arg_0], 0
		mov	edi, [esi+4]
		test	eax, eax
		jnz	short loc_41B9F3
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41B9F3:				; CODE XREF: sub_41B9D0+18j
		push	edi
		mov	dword ptr [eax], 0
		call	PGPMemoryMgrIsValid
		add	esp, 4
		test	al, al
		jnz	short loc_41BA0F
		pop	edi
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41BA0F:				; CODE XREF: sub_41B9D0+34j
		mov	ebp, [esi+14h]
		push	ebp		; char *
		call	sub_41B8A0
		mov	esi, eax
		add	esp, 4
		sub	esi, ebp
		cmp	esi, 1
		ja	short loc_41BA2D
		pop	edi
		pop	esi
		mov	eax, 0FFFFD123h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41BA2D:				; CODE XREF: sub_41B9D0+52j
		lea	eax, [esp+0Ch+arg_0]
		push	ebx
		push	eax
		push	esi
		push	0Eh
		push	edi
		call	sub_41B680
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_41BA5E
		mov	ecx, [esp+10h+arg_0]
		lea	edx, [esi-1]
		push	edx		; size_t
		mov	edi, [ecx+14h]
		push	edi		; void *
		push	ebp		; void *
		call	sub_41B4F0
		add	esp, 0Ch
		mov	[edi+esi-1], bl

loc_41BA5E:				; CODE XREF: sub_41B9D0+73j
		mov	ecx, [esp+10h+arg_4]
		mov	eax, [esp+10h+arg_0]
		mov	[ecx], eax
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_41B9D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41BA70	proc near		; DATA XREF: .rdata:0042B67Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		test	eax, eax
		mov	ebx, [esi+4]
		mov	[esp+8+arg_0], 0
		jnz	short loc_41BA91
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41BA91:				; CODE XREF: sub_41BA70+17j
		push	ebx
		mov	dword ptr [eax], 0
		call	PGPMemoryMgrIsValid
		add	esp, 4
		test	al, al
		jnz	short loc_41BAAC
		pop	esi
		mov	eax, 0FFFFD120h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41BAAC:				; CODE XREF: sub_41BA70+32j
		push	ebp
		mov	ebp, [esi+14h]
		push	edi
		mov	edi, ebp
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	esi, ecx
		jz	short loc_41BAD9
		movsx	eax, byte ptr [esi+ebp-1]
		push	eax		; int
		push	offset byte_42B680 ; char *
		call	_strchr
		add	esp, 8
		test	eax, eax
		jz	short loc_41BAD9
		dec	esi

loc_41BAD9:				; CODE XREF: sub_41BA70+4Fj
					; sub_41BA70+66j
		mov	edi, [esp+10h+arg_4]
		lea	ecx, [esp+10h+arg_0]
		push	ecx
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		lea	edx, [ecx+esi+2]
		push	edx
		push	0Eh
		push	ebx
		call	sub_41B680
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_41BB42
		mov	eax, [esp+10h+arg_0]
		push	esi		; size_t
		mov	edi, [eax+14h]
		push	edi		; void *
		push	ebp		; void *
		call	sub_41B4F0
		mov	cl, ds:byte_42B680
		lea	edx, [edi+esi+1]
		mov	[edi+esi], cl
		mov	edi, [esp+1Ch+arg_4]
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		add	esp, 0Ch
		repne scasb
		not	ecx
		sub	edi, ecx
		mov	eax, ecx
		mov	esi, edi
		mov	edi, edx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb

loc_41BB42:				; CODE XREF: sub_41BA70+90j
		mov	edx, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_0]
		pop	edi
		pop	ebp
		mov	eax, ebx
		pop	esi
		mov	[edx], ecx
		pop	ebx
		retn
sub_41BA70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41BB60	proc near		; DATA XREF: .rdata:0042B664o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		push	offset aRb	; "rb"
		xor	esi, esi
		mov	eax, [eax+14h]
		push	eax		; char *
		call	sub_41D0FF
		add	esp, 8
		test	eax, eax
		jz	short loc_41BB90
		push	eax		; FILE *
		call	_fclose
		mov	ecx, [esp+8+arg_4]
		add	esp, 4
		mov	eax, esi
		mov	byte ptr [ecx],	1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41BB90:				; CODE XREF: sub_41BB60+1Aj
		call	__errno
		cmp	dword ptr [eax], 0Dh
		jnz	short loc_41BBA8
		mov	edx, [esp+4+arg_4]
		mov	eax, 0FFFFD124h
		pop	esi
		mov	byte ptr [edx],	1
		retn
; ---------------------------------------------------------------------------

loc_41BBA8:				; CODE XREF: sub_41BB60+38j
		call	__errno
		cmp	dword ptr [eax], 2
		jnz	short loc_41BBBD
		mov	eax, [esp+4+arg_4]
		mov	byte ptr [eax],	0
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41BBBD:				; CODE XREF: sub_41BB60+50j
		call	__errno
		cmp	dword ptr [eax], 0Bh
		jnz	short loc_41BBD2
		mov	ecx, [esp+4+arg_4]
		mov	eax, esi
		pop	esi
		mov	byte ptr [ecx],	0
		retn
; ---------------------------------------------------------------------------

loc_41BBD2:				; CODE XREF: sub_41BB60+65j
		call	__errno
		cmp	dword ptr [eax], 0
		jnz	short loc_41BBE7
		mov	edx, [esp+4+arg_4]
		mov	eax, esi
		pop	esi
		mov	byte ptr [edx],	0
		retn
; ---------------------------------------------------------------------------

loc_41BBE7:				; CODE XREF: sub_41BB60+7Aj
		mov	eax, 0FFFFD124h
		pop	esi
		retn
sub_41BB60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41BBF0	proc near		; DATA XREF: .rdata:0042B668o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	offset aAb	; "ab+"
		xor	esi, esi
		mov	eax, [eax+14h]
		push	eax		; char *
		call	sub_41D0FF
		add	esp, 8
		test	eax, eax
		jz	short loc_41BC19
		push	eax		; FILE *
		call	_fclose
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41BC19:				; CODE XREF: sub_41BBF0+1Aj
		mov	eax, 0FFFFD129h
		pop	esi
		retn
sub_41BBF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_41BC20	proc near		; DATA XREF: .rdata:0042B66Co

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		xor	esi, esi
		mov	eax, [eax+14h]
		push	eax		; lpFileName
		call	sub_41D18F
		add	esp, 4
		test	eax, eax
		mov	eax, 0FFFFD129h
		jnz	short loc_41BC3E
		mov	eax, esi

loc_41BC3E:				; CODE XREF: sub_41BC20+1Aj
		pop	esi
		retn
sub_41BC20	endp


; =============== S U B	R O U T	I N E =======================================


sub_41BC40	proc near		; DATA XREF: .rdata:0042B670o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		or	ecx, 0FFFFFFFFh
		xor	eax, eax
		mov	edi, [esi+14h]
		mov	edx, [esi+4]
		repne scasb
		not	ecx
		push	0
		push	ecx
		push	edx
		call	PGPNewData
		mov	ebx, eax
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_41BCC5
		mov	edx, [esi+14h]
		or	ecx, 0FFFFFFFFh
		mov	edi, edx
		xor	eax, eax
		repne scasb
		not	ecx
		push	ecx		; size_t
		push	ebx		; void *
		push	edx		; void *
		call	sub_41B4F0
		mov	eax, [esp+18h+arg_4]
		push	eax
		push	esi
		call	sub_41B8E0
		mov	ecx, [esi+14h]
		mov	edi, eax
		push	ecx		; lpNewFileName
		push	ebx		; lpExistingFileName
		call	sub_41D1B9
		add	esp, 1Ch
		test	eax, eax
		jz	short loc_41BCB6
		mov	edx, [esi+14h]
		mov	edi, 0FFFFD129h
		push	edx
		call	PGPFreeData
		add	esp, 4
		mov	eax, edi
		mov	[esi+14h], ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41BCB6:				; CODE XREF: sub_41BC40+5Aj
		push	ebx
		call	PGPFreeData
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_41BCC5:				; CODE XREF: sub_41BC40+26j
		pop	edi
		pop	esi
		mov	eax, 0FFFFD121h
		pop	ebx
		retn
sub_41BC40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41BCD0	proc near		; CODE XREF: sub_41B680+5Fp

arg_0		= dword	ptr  4

; FUNCTION CHUNK AT 0041B730 SIZE 00000006 BYTES

		cmp	[esp+arg_0], 0Eh
		jz	short loc_41BCDA
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_41BCDA:				; CODE XREF: sub_41BCD0+5j
		jmp	loc_41B730
sub_41BCD0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewTLSContext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeTLSContext]
; [00000006 BYTES: COLLAPSED FUNCTION PGPCancelKeyServerCall]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerCleanup]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerDisposeThreadStorage]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeTLSSession]
; [00000006 BYTES: COLLAPSED FUNCTION PGPFreeKeyServer]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerClose]
; [00000006 BYTES: COLLAPSED FUNCTION PGPQueryKeyServer]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerOpen]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewTLSSession]
; [00000006 BYTES: COLLAPSED FUNCTION PGPSetKeyServerEventHandler]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewKeyServerFromHostName]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerCreateThreadStorage]
; [00000006 BYTES: COLLAPSED FUNCTION PGPKeyServerInit]
; [00000006 BYTES: COLLAPSED FUNCTION PGPtlsGetNegotiatedCipherSuite]
; [00000006 BYTES: COLLAPSED FUNCTION PGPtlsGetRemoteAuthenticatedKey]
; [00000012 BYTES: COLLAPSED FUNCTION _malloc]
; [0000002C BYTES: COLLAPSED FUNCTION __nh_malloc]
; [0000004E BYTES: COLLAPSED FUNCTION __heap_alloc]
; [00000048 BYTES: COLLAPSED FUNCTION _free]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41BE1A(void *)
sub_41BE1A	proc near		; CODE XREF: sub_4016F0+Ep

arg_0		= dword	ptr  4

		push	[esp+arg_0]	; void *
		call	_free
		pop	ecx
		retn
sub_41BE1A	endp


; =============== S U B	R O U T	I N E =======================================


sub_41BE25	proc near		; CODE XREF: sub_401930+2p

arg_0		= dword	ptr  4

		push	1
		push	[esp+4+arg_0]
		call	__nh_malloc
		pop	ecx
		pop	ecx
		retn
sub_41BE25	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000027 BYTES: COLLAPSED FUNCTION _strrchr]
		align 10h
; [00000080 BYTES: COLLAPSED FUNCTION _strstr]
; [0000006B BYTES: COLLAPSED FUNCTION __beginthreadex]
; [00000065 BYTES: COLLAPSED FUNCTION _threadstartex(x)]
		db  59h	; Y
		db  83h	; 
		db  4Dh	; M
		db 0FCh	; 
		db 0FFh
		db  33h	; 3
		db 0C0h	; 
		db  8Bh	; 
		db  4Dh	; M
		db 0F0h	; 
		db  64h	; d
		db  89h	; 
		db  0Dh
		db    0
		db    0
		db    0
		db    0
		db  5Fh	; _
		db  5Eh	; ^
		db  5Bh	; [
		db 0C9h	; 
		db 0C2h	; 
		db    4
		db    0
; ---------------------------------------------------------------------------
; [0000001F BYTES: COLLAPSED CHUNK OF FUNCTION _threadstartex(x)]
; [00000030 BYTES: COLLAPSED FUNCTION __endthreadex]
; ---------------------------------------------------------------------------
		pop	esi
		retn
; [00000017 BYTES: COLLAPSED FUNCTION __fpmath]
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1]
; [00000038 BYTES: COLLAPSED FUNCTION __cfltcvt_init]
		align 4
; [00000027 BYTES: COLLAPSED FUNCTION __ftol]
		align 10h
; [00000005 BYTES: COLLAPSED CHUNK OF FUNCTION _strchr]
		align 10h
; [000000BC BYTES: COLLAPSED FUNCTION _strchr]
; [0000008B BYTES: COLLAPSED FUNCTION _atol]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41C207(time_t)
sub_41C207	proc near		; CODE XREF: sub_411C60+449p
					; sub_411C60+4A6p ...

arg_0		= dword	ptr  4

		push	1		; int
		push	[esp+4+arg_0]	; time_t
		call	__make_time_t
		pop	ecx
		pop	ecx
		retn
sub_41C207	endp

; [000001E4 BYTES: COLLAPSED FUNCTION __make_time_t]
; [00000138 BYTES: COLLAPSED FUNCTION _realloc]
; [00000108 BYTES: COLLAPSED FUNCTION start]
; [00000022 BYTES: COLLAPSED FUNCTION __amsg_exit]
; ---------------------------------------------------------------------------
		pop	ecx
		pop	ecx
		retn
; [00000023 BYTES: COLLAPSED FUNCTION _fast_error_exit]
; ---------------------------------------------------------------------------
		retn
; [0000006F BYTES: COLLAPSED FUNCTION _tolower]
; [000000CB BYTES: COLLAPSED FUNCTION _tolower_0]
; [00000075 BYTES: COLLAPSED FUNCTION __isctype]
		align 10h
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy]
; [0000005D BYTES: COLLAPSED FUNCTION __close]
; [00000083 BYTES: COLLAPSED FUNCTION __close_lk]
; [00000125 BYTES: COLLAPSED FUNCTION __chsize_lk]
; [000002CF BYTES: COLLAPSED FUNCTION __sopen]
; [00000073 BYTES: COLLAPSED FUNCTION __dosmaperr]
; [00000009 BYTES: COLLAPSED FUNCTION __errno]
; [00000009 BYTES: COLLAPSED FUNCTION ___doserrno]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41D0CE(char *, int, int)
sub_41D0CE	proc near		; CODE XREF: sub_41D0FF+Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	__getstream
		mov	esi, eax
		test	esi, esi
		jnz	short loc_41D0DC
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_41D0DC:				; CODE XREF: sub_41D0CE+Aj
		push	edi
		push	esi		; int
		push	[esp+0Ch+arg_8]	; int
		push	[esp+10h+arg_4]	; int
		push	[esp+14h+arg_0]	; char *
		call	__openfile
		push	esi
		mov	edi, eax
		call	__unlock_file
		add	esp, 14h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_41D0CE	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41D0FF(char *, int)
sub_41D0FF	proc near		; CODE XREF: sub_41BB60+10p
					; sub_41BBF0+10p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	40h		; int
		push	[esp+4+arg_4]	; int
		push	[esp+8+arg_0]	; char *
		call	sub_41D0CE
		add	esp, 0Ch
		retn
sub_41D0FF	endp

; [00000031 BYTES: COLLAPSED FUNCTION _fclose]
; [0000004C BYTES: COLLAPSED FUNCTION __fclose_lk]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41D18F(LPCSTR	lpFileName)
sub_41D18F	proc near		; CODE XREF: sub_41BC20+Bp

lpFileName	= dword	ptr  4

		push	[esp+lpFileName] ; lpFileName
		call	ds:DeleteFileA
		test	eax, eax
		jnz	short loc_41D1A5
		call	ds:GetLastError
		jmp	short loc_41D1A7
; ---------------------------------------------------------------------------

loc_41D1A5:				; CODE XREF: sub_41D18F+Cj
		xor	eax, eax

loc_41D1A7:				; CODE XREF: sub_41D18F+14j
		test	eax, eax
		jz	short loc_41D1B6
		push	eax
		call	__dosmaperr
		pop	ecx
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_41D1B6:				; CODE XREF: sub_41D18F+1Aj
		xor	eax, eax
		retn
sub_41D18F	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41D1B9(LPCSTR	lpExistingFileName, LPCSTR lpNewFileName)
sub_41D1B9	proc near		; CODE XREF: sub_41BC40+50p

lpExistingFileName= dword ptr  4
lpNewFileName	= dword	ptr  8

		push	[esp+lpNewFileName] ; lpNewFileName
		push	[esp+4+lpExistingFileName] ; lpExistingFileName
		call	ds:MoveFileA
		test	eax, eax
		jnz	short loc_41D1D3
		call	ds:GetLastError
		jmp	short loc_41D1D5
; ---------------------------------------------------------------------------

loc_41D1D3:				; CODE XREF: sub_41D1B9+10j
		xor	eax, eax

loc_41D1D5:				; CODE XREF: sub_41D1B9+18j
		test	eax, eax
		jz	short loc_41D1E4
		push	eax
		call	__dosmaperr
		pop	ecx
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_41D1E4:				; CODE XREF: sub_41D1B9+1Ej
		xor	eax, eax
		retn
sub_41D1B9	endp

; [0000002E BYTES: COLLAPSED FUNCTION __fflush_lk]
; [0000005C BYTES: COLLAPSED FUNCTION __flush]

; =============== S U B	R O U T	I N E =======================================


sub_41D271	proc near		; CODE XREF: ___endstdiop
		push	1
		call	_flsall
		pop	ecx
		retn
sub_41D271	endp

; [000000A4 BYTES: COLLAPSED FUNCTION _flsall]
		align 10h
; [00000038 BYTES: COLLAPSED FUNCTION _strncmp]
; [0000001B BYTES: COLLAPSED FUNCTION __callnewh]
; [0000003C BYTES: COLLAPSED FUNCTION __heap_init]
; [00000029 BYTES: COLLAPSED FUNCTION __mtinitlocks_0]
; [00000061 BYTES: COLLAPSED FUNCTION __lock]
; [00000015 BYTES: COLLAPSED FUNCTION __unlock]
; [0000003E BYTES: COLLAPSED FUNCTION ___sbh_heap_init]
; [0000002B BYTES: COLLAPSED FUNCTION ___sbh_find_block]
; [0000032B BYTES: COLLAPSED FUNCTION ___sbh_free_block]
; [00000309 BYTES: COLLAPSED FUNCTION ___sbh_alloc_block]
; [000000B1 BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_region]
; [000000FB BYTES: COLLAPSED FUNCTION ___sbh_alloc_new_group]
; [000002F6 BYTES: COLLAPSED FUNCTION ___sbh_resize_block]
; [00000054 BYTES: COLLAPSED FUNCTION __mtinit]
; [00000013 BYTES: COLLAPSED FUNCTION __initptd]
; [00000067 BYTES: COLLAPSED FUNCTION __getptd]
; [000000A0 BYTES: COLLAPSED FUNCTION __freeptd]
; [0000008D BYTES: COLLAPSED FUNCTION _calloc]
; [0000002D BYTES: COLLAPSED FUNCTION __cinit]
; [00000011 BYTES: COLLAPSED FUNCTION _exit]
; [00000011 BYTES: COLLAPSED FUNCTION __exit]
; [000000A3 BYTES: COLLAPSED FUNCTION _doexit]
; ---------------------------------------------------------------------------
		pop	edi
		retn
; [00000009 BYTES: COLLAPSED FUNCTION __lockexit]
; [00000009 BYTES: COLLAPSED FUNCTION __unlockexit]
; [0000001A BYTES: COLLAPSED FUNCTION __initterm]
; [0000013E BYTES: COLLAPSED FUNCTION __XcptFilter]
; [0000003A BYTES: COLLAPSED FUNCTION _xcptlookup]
; [00000020 BYTES: COLLAPSED FUNCTION __global_unwind2]
; [00000022 BYTES: COLLAPSED FUNCTION __unwind_handler]
; [00000068 BYTES: COLLAPSED FUNCTION __local_unwind2]
; [00000023 BYTES: COLLAPSED FUNCTION __abnormal_termination]
; ---------------------------------------------------------------------------

__NLG_Notify1:
		push	ebx
		push	ecx
		mov	ebx, offset dword_42F8F8
		jmp	short __NLG_Go
; [00000018 BYTES: COLLAPSED FUNCTION __NLG_Notify]
		align 10h
		push	esi
		inc	ebx
		xor	dh, [eax]
		pop	eax
		inc	ebx
		xor	[eax], dh
; [000000BD BYTES: COLLAPSED FUNCTION __except_handler3]
; [0000001B BYTES: COLLAPSED FUNCTION _seh_longjmp_unwind(x)]
; [00000012 BYTES: COLLAPSED FUNCTION __setdefaultprecision]
; [0000003E BYTES: COLLAPSED FUNCTION __ms_p5_test_fdiv]
; [00000029 BYTES: COLLAPSED FUNCTION __ms_p5_mp_test_fdiv]
; [0000005A BYTES: COLLAPSED FUNCTION __forcdecpt]
; ---------------------------------------------------------------------------

__cropzeros:				; DATA XREF: __cfltcvt_init+5o
		mov	eax, [esp+4]
		mov	dl, byte_42F628
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_41E6DF

loc_41E6D3:				; CODE XREF: .text:0041E6DDj
		cmp	cl, dl
		jz	short loc_41E6DF
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_41E6D3

loc_41E6DF:				; CODE XREF: .text:0041E6D1j
					; .text:0041E6D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jz	short locret_41E710

loc_41E6E6:				; CODE XREF: .text:0041E6F7j
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_41E6F9
		cmp	cl, 65h
		jz	short loc_41E6F9
		cmp	cl, 45h
		jz	short loc_41E6F9
		inc	eax
		jmp	short loc_41E6E6
; ---------------------------------------------------------------------------

loc_41E6F9:				; CODE XREF: .text:0041E6EAj
					; .text:0041E6EFj ...
		mov	ecx, eax

loc_41E6FB:				; CODE XREF: .text:0041E6FFj
		dec	eax
		cmp	byte ptr [eax],	30h
		jz	short loc_41E6FB
		cmp	[eax], dl
		jnz	short loc_41E706
		dec	eax

loc_41E706:				; CODE XREF: .text:0041E703j
					; .text:0041E70Ej
		mov	dl, [ecx]
		inc	eax
		inc	ecx
		test	dl, dl
		mov	[eax], dl
		jnz	short loc_41E706

locret_41E710:				; CODE XREF: .text:0041E6E4j
		retn
; ---------------------------------------------------------------------------

__positive:				; DATA XREF: __cfltcvt_init+28o
		mov	eax, [esp+4]
		fld	qword ptr [eax]
		fcomp	ds:dbl_42B6E0
		fnstsw	ax
		sahf
		jb	short loc_41E726
		push	1
		pop	eax
		retn
; ---------------------------------------------------------------------------

loc_41E726:				; CODE XREF: .text:0041E720j
		xor	eax, eax
		retn
; [0000003E BYTES: COLLAPSED FUNCTION __fassign]
; [00000061 BYTES: COLLAPSED FUNCTION __cftoe]
; [000000C2 BYTES: COLLAPSED FUNCTION __cftoe2]
; [00000055 BYTES: COLLAPSED FUNCTION __cftof]
; [000000A7 BYTES: COLLAPSED FUNCTION __cftof2]
; [00000093 BYTES: COLLAPSED FUNCTION __cftog]
; [00000051 BYTES: COLLAPSED FUNCTION __cfltcvt]
; [00000025 BYTES: COLLAPSED FUNCTION __shift]
		align 10h

__allmul:
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		or	ecx, eax
		mov	ecx, [esp+0Ch]
		jnz	short hard
		mov	eax, [esp+4]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

hard:					; CODE XREF: .text:0041EA9Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		mul	dword ptr [esp+14h]
		add	ebx, eax
		mov	eax, [esp+8]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
; [0000010A BYTES: COLLAPSED FUNCTION _gmtime]
; [00000160 BYTES: COLLAPSED FUNCTION _localtime]
; [0000002E BYTES: COLLAPSED FUNCTION ___tzset]
; [00000287 BYTES: COLLAPSED FUNCTION __tzset_lk]
; [00000021 BYTES: COLLAPSED FUNCTION __isindst]
; [000001AC BYTES: COLLAPSED FUNCTION __isindst_0]
; [00000140 BYTES: COLLAPSED FUNCTION _cvtdate]
; [00000335 BYTES: COLLAPSED FUNCTION _memcpy_0]
; [00000058 BYTES: COLLAPSED FUNCTION __wincmdln]
; [000000B9 BYTES: COLLAPSED FUNCTION __setenvp]
; [00000099 BYTES: COLLAPSED FUNCTION __setargv]
; [000001B4 BYTES: COLLAPSED FUNCTION _parse_cmdline]
; [00000132 BYTES: COLLAPSED FUNCTION ___crtGetEnvironmentStringsA]
; [000001BC BYTES: COLLAPSED FUNCTION __ioinit]
; [00000039 BYTES: COLLAPSED FUNCTION __FF_MSGBANNER]
; [00000153 BYTES: COLLAPSED FUNCTION __NMSG_WRITE]
; [00000224 BYTES: COLLAPSED FUNCTION ___crtLCMapStringA]
; [00000149 BYTES: COLLAPSED FUNCTION ___crtGetStringTypeA]
; [00000123 BYTES: COLLAPSED FUNCTION __alloc_osfhnd]
; [0000007C BYTES: COLLAPSED FUNCTION __set_osfhnd]
; [0000007F BYTES: COLLAPSED FUNCTION __free_osfhnd]
; [00000042 BYTES: COLLAPSED FUNCTION __get_osfhandle]
; [0000005F BYTES: COLLAPSED FUNCTION __lock_fhandle]
; [00000022 BYTES: COLLAPSED FUNCTION __unlock_fhandle]
; [00000065 BYTES: COLLAPSED FUNCTION __write]
; [0000018B BYTES: COLLAPSED FUNCTION __write_lk]
; [00000061 BYTES: COLLAPSED FUNCTION __setmode_lk]
		align 10h
; [00000058 BYTES: COLLAPSED FUNCTION _memset]
; [00000073 BYTES: COLLAPSED FUNCTION __lseek_lk]
		align 10h
; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe]
; [000001D9 BYTES: COLLAPSED FUNCTION __read_lk]
; [000000A8 BYTES: COLLAPSED FUNCTION ___initstdio]
; [00000014 BYTES: COLLAPSED FUNCTION ___endstdio]
; [0000002F BYTES: COLLAPSED FUNCTION __lock_file]
; [00000023 BYTES: COLLAPSED FUNCTION __lock_file2]
; [0000002F BYTES: COLLAPSED FUNCTION __unlock_file]
; [00000023 BYTES: COLLAPSED FUNCTION __unlock_file2]
; [00000170 BYTES: COLLAPSED FUNCTION __openfile]
; [000000C8 BYTES: COLLAPSED FUNCTION __getstream]
; [00000007 BYTES: COLLAPSED FUNCTION _strcpy]
		align 10h
; [000000E0 BYTES: COLLAPSED FUNCTION _strcat]
; [0000002B BYTES: COLLAPSED FUNCTION __strdup]
; [0000006D BYTES: COLLAPSED FUNCTION __rmtmp]
; [0000002B BYTES: COLLAPSED FUNCTION __freebuf]
; [00000093 BYTES: COLLAPSED FUNCTION __commit]
; [00000035 BYTES: COLLAPSED FUNCTION __control87]
; [00000016 BYTES: COLLAPSED FUNCTION __controlfp]
; [00000092 BYTES: COLLAPSED FUNCTION __abstract_cw]
; [00000089 BYTES: COLLAPSED FUNCTION __hw_cw]
; [00000049 BYTES: COLLAPSED FUNCTION __ZeroTail]
; [00000056 BYTES: COLLAPSED FUNCTION __IncMan]
; [0000008C BYTES: COLLAPSED FUNCTION __RoundMan]
; [0000001B BYTES: COLLAPSED FUNCTION __CopyMan]
; [0000000C BYTES: COLLAPSED FUNCTION __FillZeroMan]
; [0000001B BYTES: COLLAPSED FUNCTION __IsZeroMan]
; [0000008D BYTES: COLLAPSED FUNCTION __ShrMan]
; [0000016C BYTES: COLLAPSED FUNCTION __ld12cvt]

; =============== S U B	R O U T	I N E =======================================


sub_421422	proc near		; CODE XREF: sub_42144E+23p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset dword_42FEA0
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	__ld12cvt
		add	esp, 0Ch
		retn
sub_421422	endp


; =============== S U B	R O U T	I N E =======================================


sub_421438	proc near		; CODE XREF: sub_42147B+23p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	offset dword_42FEB8
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	__ld12cvt
		add	esp, 0Ch
		retn
sub_421438	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42144E	proc near		; CODE XREF: __fassign+12p

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	[ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	___strgtold12
		push	[ebp+arg_0]
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_421422
		add	esp, 24h
		leave
		retn
sub_42144E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42147B	proc near		; CODE XREF: __fassign+2Dp

var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	[ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	___strgtold12
		push	[ebp+arg_0]
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_421438
		add	esp, 24h
		leave
		retn
sub_42147B	endp

; [00000077 BYTES: COLLAPSED FUNCTION __fptostr]
; [0000005C BYTES: COLLAPSED FUNCTION __fltout2]
; [000000B6 BYTES: COLLAPSED FUNCTION ___dtold]
		align 10h
; [0000007B BYTES: COLLAPSED FUNCTION _strlen]
; [00000007 BYTES: COLLAPSED FUNCTION __fptrap]
		db  59h	; Y
		db 0C3h	; 
		align 10h
; [000000FE BYTES: COLLAPSED FUNCTION _strncpy]
		align 10h
; [00000084 BYTES: COLLAPSED FUNCTION _strcmp]
; [0000007D BYTES: COLLAPSED FUNCTION _getenv]
; [00000011 BYTES: COLLAPSED FUNCTION __ismbblead]
; [00000031 BYTES: COLLAPSED FUNCTION _x_ismbbtype]
; [000001AD BYTES: COLLAPSED FUNCTION __setmbcp]
; [0000004A BYTES: COLLAPSED FUNCTION _getSystemCP]
; [00000033 BYTES: COLLAPSED FUNCTION _CPtoLCID]
; [00000029 BYTES: COLLAPSED FUNCTION _setSBCS]
; [00000185 BYTES: COLLAPSED FUNCTION _setSBUpLow]
; [0000001C BYTES: COLLAPSED FUNCTION ___initmbctable]
; [00000089 BYTES: COLLAPSED FUNCTION ___crtMessageBoxA]
; [0000003E BYTES: COLLAPSED FUNCTION _strcspn]
		align 10h
; [0000003A BYTES: COLLAPSED FUNCTION _strpbrk]
; [00000081 BYTES: COLLAPSED FUNCTION __fcloseall]
		align 10h

__aulldiv:
		push	ebx
		push	esi
		mov	eax, [esp+18h]
		or	eax, eax
		jnz	short loc_421EB2
		mov	ecx, [esp+14h]
		mov	eax, [esp+10h]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+0Ch]
		div	ecx
		mov	edx, ebx
		jmp	short loc_421EF3
; ---------------------------------------------------------------------------

loc_421EB2:				; CODE XREF: .text:00421E98j
		mov	ecx, eax
		mov	ebx, [esp+14h]
		mov	edx, [esp+10h]
		mov	eax, [esp+0Ch]

loc_421EC0:				; CODE XREF: .text:00421ECAj
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_421EC0
		div	ebx
		mov	esi, eax
		mul	dword ptr [esp+18h]
		mov	ecx, eax
		mov	eax, [esp+14h]
		mul	esi
		add	edx, ecx
		jb	short loc_421EEE
		cmp	edx, [esp+10h]
		ja	short loc_421EEE
		jb	short loc_421EEF
		cmp	eax, [esp+0Ch]
		jbe	short loc_421EEF

loc_421EEE:				; CODE XREF: .text:00421EDEj
					; .text:00421EE4j
		dec	esi

loc_421EEF:				; CODE XREF: .text:00421EE6j
					; .text:00421EECj
		xor	edx, edx
		mov	eax, esi

loc_421EF3:				; CODE XREF: .text:00421EB0j
		pop	esi
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------
		align 10h

__aullrem:
		push	ebx
		mov	eax, [esp+14h]
		or	eax, eax
		jnz	short loc_421F21
		mov	ecx, [esp+10h]
		mov	eax, [esp+0Ch]
		xor	edx, edx
		div	ecx
		mov	eax, [esp+8]
		div	ecx
		mov	eax, edx
		xor	edx, edx
		jmp	short loc_421F71
; ---------------------------------------------------------------------------

loc_421F21:				; CODE XREF: .text:00421F07j
		mov	ecx, eax
		mov	ebx, [esp+10h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]

loc_421F2F:				; CODE XREF: .text:00421F39j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_421F2F
		div	ebx
		mov	ecx, eax
		mul	dword ptr [esp+14h]
		xchg	eax, ecx
		mul	dword ptr [esp+10h]
		add	edx, ecx
		jb	short loc_421F5A
		cmp	edx, [esp+0Ch]
		ja	short loc_421F5A
		jb	short loc_421F62
		cmp	eax, [esp+8]
		jbe	short loc_421F62

loc_421F5A:				; CODE XREF: .text:00421F4Aj
					; .text:00421F50j
		sub	eax, [esp+10h]
		sbb	edx, [esp+14h]

loc_421F62:				; CODE XREF: .text:00421F52j
					; .text:00421F58j
		sub	eax, [esp+8]
		sbb	edx, [esp+0Ch]
		neg	edx
		neg	eax
		sbb	edx, 0

loc_421F71:				; CODE XREF: .text:00421F1Fj
		pop	ebx
		retn	10h
; [00000021 BYTES: COLLAPSED FUNCTION ___addl]
; [0000005E BYTES: COLLAPSED FUNCTION ___add_12]
; [0000002E BYTES: COLLAPSED FUNCTION ___shl_12]
; [0000002D BYTES: COLLAPSED FUNCTION ___shr_12]
; [000000C7 BYTES: COLLAPSED FUNCTION ___mtold12]
; [000004A1 BYTES: COLLAPSED FUNCTION ___strgtold12]
off_4225B7	dd offset loc_422180	; DATA XREF: ___strgtold12+63r
		dd offset loc_4221CF	; jump table for switch	statement
		dd offset loc_422226
		dd offset loc_422250
		dd offset loc_4222AB
		dd offset loc_422322
		dd offset loc_422358
		dd offset loc_4223A2
		dd offset loc_422381
		dd offset loc_422406
		dd offset loc_4223F0
		dd offset loc_4223BC
; [00000293 BYTES: COLLAPSED FUNCTION _$I10_OUTPUT]
; [0000003F BYTES: COLLAPSED FUNCTION __mbsnbicoll]
; [0000006E BYTES: COLLAPSED FUNCTION ___wtomb_environ]
		align 10h
; [000000D0 BYTES: COLLAPSED FUNCTION __strcmpi]
; [00000101 BYTES: COLLAPSED FUNCTION __strnicmp]
; [00000220 BYTES: COLLAPSED FUNCTION ___ld12mul]
; [0000007C BYTES: COLLAPSED FUNCTION ___multtenpow12]
; [0000027D BYTES: COLLAPSED FUNCTION ___crtCompareStringA]
; [0000002B BYTES: COLLAPSED FUNCTION _strncnt]
; [00000187 BYTES: COLLAPSED FUNCTION ___crtsetenv]
; [00000058 BYTES: COLLAPSED FUNCTION _findenv]
; [00000067 BYTES: COLLAPSED FUNCTION _copy_environ]
; [00000097 BYTES: COLLAPSED FUNCTION __mbschr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
; [00000006 BYTES: COLLAPSED FUNCTION PGPNewData]
; [00000006 BYTES: COLLAPSED FUNCTION PGPMemoryMgrIsValid]
; [00000006 BYTES: COLLAPSED FUNCTION PGPReallocData]
		align 1000h
_text		ends

; Section 2. (virtual address 00024000)
; Virtual size			: 0000A480 (  42112.)
; Section size in file		: 0000B000 (  45056.)
; Offset to raw	data for section: 00024000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_410D90+30p
					; DATA XREF: sub_410D90+30r ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_410D90+66p
					; DATA XREF: sub_410D90+66r
; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey,	DWORD Reserved,	LPSTR lpClass, DWORD dwOptions,	REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; CODE XREF: sub_40C0F0+46p
					; DATA XREF: sub_40C0F0+46r
; LSTATUS __stdcall RegSetValueExA(HKEY	hKey, LPCSTR lpValueName, DWORD	Reserved, DWORD	dwType,	const BYTE *lpData, DWORD cbData)
		extrn RegSetValueExA:dword ; CODE XREF:	sub_40C0F0+98p
					; DATA XREF: sub_40C0F0+98r
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_40C0F0+A3p
					; DATA XREF: sub_40C0F0+A3r

;
; Imports from COMCTL32.dll
;
; BOOL __stdcall ImageList_DragMove(int	x, int y)
		extrn ImageList_DragMove:dword ; CODE XREF: sub_4030D0+126p
					; DATA XREF: sub_4030D0+126r ...
; BOOL __stdcall ImageList_Destroy(HIMAGELIST himl)
		extrn ImageList_Destroy:dword ;	CODE XREF: sub_4033B0+EBp
					; sub_405110+5Bp ...
; BOOL __stdcall ImageList_BeginDrag(HIMAGELIST	himlTrack, int iTrack, int dxHotspot, int dyHotspot)
		extrn ImageList_BeginDrag:dword	; CODE XREF: sub_4033B0+E4p
					; DATA XREF: sub_4033B0+E4r
; BOOL __stdcall ImageList_DragEnter(HWND hwndLock, int	x, int y)
		extrn ImageList_DragEnter:dword	; CODE XREF: sub_4030D0+E3p
					; sub_4030D0+15Fp ...
; INT_PTR __stdcall PropertySheetA(LPCPROPSHEETHEADERA)
		extrn PropertySheetA:dword ; CODE XREF:	sub_405B80+2D3p
					; DATA XREF: sub_405B80+2D3r
; HIMAGELIST __stdcall ImageList_Create(int cx,	int cy,	UINT flags, int	cInitial, int cGrow)
		extrn ImageList_Create:dword ; CODE XREF: sub_4033B0+AFp
					; sub_404530+130p ...
; void __stdcall ImageList_EndDrag()
		extrn ImageList_EndDrag:dword ;	DATA XREF: sub_4034C0+Er
; void __stdcall InitCommonControls()
		extrn InitCommonControls:dword ; CODE XREF: sub_404530+4p
					; sub_411440p ...
; int __stdcall	ImageList_AddMasked(HIMAGELIST himl, HBITMAP hbmImage, COLORREF	crMask)
		extrn ImageList_AddMasked:dword	; CODE XREF: sub_4033B0+C6p
					; sub_404530:loc_4046B6p ...
; HWND __stdcall CreateStatusWindowA(LONG style, LPCSTR	lpszText, HWND hwndParent, UINT	wID)
		extrn CreateStatusWindowA:dword	; CODE XREF: .text:0040D126p
					; DATA XREF: .text:0040D126r
; BOOL __stdcall ImageList_Draw(HIMAGELIST himl, int i,	HDC hdcDst, int	x, int y, UINT fStyle)
		extrn ImageList_Draw:dword ; CODE XREF:	sub_410320+249p
					; sub_4199C0+35Fp ...
; BOOL __stdcall ImageList_DragLeave(HWND hwndLock)
		extrn ImageList_DragLeave:dword	; CODE XREF: sub_4030D0+BDp
					; sub_4030D0+139p ...

;
; Imports from GDI32.dll
;
; BOOL __stdcall TextOutA(HDC hdc, int x, int y, LPCSTR	lpString, int c)
		extrn TextOutA:dword	; CODE XREF: sub_412530+28Bp
					; sub_4199C0+330p ...
; HPALETTE __stdcall CreatePalette(const LOGPALETTE *plpal)
		extrn CreatePalette:dword ; CODE XREF: sub_40AE80+8Fp
					; DATA XREF: sub_40AE80+8Fr
; HBITMAP __stdcall CreateDIBitmap(HDC hdc, const BITMAPINFOHEADER *pbmih, DWORD flInit, const void *pjBits, const BITMAPINFO *pbmi, UINT iUsage)
		extrn CreateDIBitmap:dword ; CODE XREF:	sub_40ADE0+73p
					; DATA XREF: sub_40ADE0+73r
; COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color)
		extrn SetBkColor:dword	; CODE XREF: sub_407120+40Ep
					; sub_4076A0+44p ...
; COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color)
		extrn SetTextColor:dword ; CODE	XREF: sub_407120+423p
					; sub_407120+43Dp ...
; BOOL __stdcall MoveToEx(HDC hdc, int x, int y, LPPOINT lppt)
		extrn MoveToEx:dword	; CODE XREF: sub_406860+81p
					; .text:0040D8E1p ...
; BOOL __stdcall LineTo(HDC hdc, int x,	int y)
		extrn LineTo:dword	; CODE XREF: sub_406860+8Ap
					; sub_406860+97p ...
; HPEN __stdcall CreatePen(int iStyle, int cWidth, COLORREF color)
		extrn CreatePen:dword	; CODE XREF: sub_406860+BAp
					; .text:0040D8C6p ...
; HGDIOBJ __stdcall SelectObject(HDC hdc, HGDIOBJ h)
		extrn SelectObject:dword ; CODE	XREF: sub_406860+CCp
					; sub_406860+108p ...
; HBRUSH __stdcall CreateSolidBrush(COLORREF color)
		extrn CreateSolidBrush:dword ; CODE XREF: sub_406860+DDp
					; sub_406860+E8p ...
; BOOL __stdcall Rectangle(HDC hdc, int	left, int top, int right, int bottom)
		extrn Rectangle:dword	; CODE XREF: sub_406860+147p
					; sub_406860+160p ...
; HPALETTE __stdcall SelectPalette(HDC hdc, HPALETTE hPal, BOOL	bForceBkgd)
		extrn SelectPalette:dword ; CODE XREF: .text:0040632Fp
					; sub_406360+3B3p ...
; UINT __stdcall RealizePalette(HDC hdc)
		extrn RealizePalette:dword ; CODE XREF:	.text:00406336p
					; sub_406360+3BAp ...
; int __stdcall	GetDeviceCaps(HDC hdc, int index)
		extrn GetDeviceCaps:dword ; CODE XREF: sub_404530+106p
					; sub_404530+111p ...
; HBRUSH __stdcall CreateHatchBrush(int	iHatch,	COLORREF color)
		extrn CreateHatchBrush:dword ; CODE XREF: sub_4192C0+140p
					; DATA XREF: sub_4192C0+140r
; HBITMAP __stdcall CreateCompatibleBitmap(HDC hdc, int	cx, int	cy)
		extrn CreateCompatibleBitmap:dword ; CODE XREF:	sub_4192C0+198p
					; sub_41AE00+41p ...
; BOOL __stdcall DeleteObject(HGDIOBJ ho)
		extrn DeleteObject:dword ; CODE	XREF: sub_4033B0+D1p
					; sub_404530+18Dp ...
; BOOL __stdcall BitBlt(HDC hdc, int x,	int y, int cx, int cy, HDC hdcSrc, int x1, int y1, DWORD rop)
		extrn BitBlt:dword	; CODE XREF: sub_41AE00+DDp
					; DATA XREF: sub_41AE00+DDr
; BOOL __stdcall UnrealizeObject(HGDIOBJ h)
		extrn UnrealizeObject:dword ; CODE XREF: sub_41AD30+23p
					; DATA XREF: sub_41AD30+23r
; BOOL __stdcall SetBrushOrgEx(HDC hdc,	int x, int y, LPPOINT lppt)
		extrn SetBrushOrgEx:dword ; CODE XREF: sub_41AD30+37p
					; DATA XREF: sub_41AD30+37r
; BOOL __stdcall LineDDA(int xStart, int yStart, int xEnd, int yEnd, LINEDDAPROC lpProc, LPARAM	data)
		extrn LineDDA:dword	; CODE XREF: sub_4199C0+2A2p
					; sub_4199C0+2C1p ...
; UINT __stdcall SetTextAlign(HDC hdc, UINT align)
		extrn SetTextAlign:dword ; CODE	XREF: sub_4199C0+30Dp
					; sub_4199C0+843p ...
; COLORREF __stdcall SetPixel(HDC hdc, int x, int y, COLORREF color)
		extrn SetPixel:dword	; CODE XREF: Proc+1Dp
					; DATA XREF: Proc+1Dr
; BOOL __stdcall GetTextExtentPoint32A(HDC hdc,	LPCSTR lpString, int c,	LPSIZE psizl)
		extrn GetTextExtentPoint32A:dword ; CODE XREF: sub_4196F0+34p
					; sub_4196F0+A4p ...
; HDC __stdcall	CreateCompatibleDC(HDC hdc)
		extrn CreateCompatibleDC:dword ; CODE XREF: sub_4192C0+Cp
					; sub_41AE00+23p ...
; int __stdcall	SetBkMode(HDC hdc, int mode)
		extrn SetBkMode:dword	; CODE XREF: sub_412530+23Dp
					; sub_41AE00+5Ep ...
; BOOL __stdcall DeleteDC(HDC hdc)
		extrn DeleteDC:dword	; CODE XREF: sub_4192C0+360p
					; sub_41ADC0+25p ...
; HBRUSH __stdcall CreatePatternBrush(HBITMAP hbm)
		extrn CreatePatternBrush:dword ; CODE XREF: sub_4192C0+22Bp
					; DATA XREF: sub_4192C0+22Br
; HFONT	__stdcall CreateFontIndirectA(const LOGFONTA *lplf)
		extrn CreateFontIndirectA:dword	; CODE XREF: sub_4192C0+2F5p
					; sub_4192C0+30Cp ...
; BOOL __stdcall GetTextMetricsA(HDC hdc, LPTEXTMETRICA	lptm)
		extrn GetTextMetricsA:dword ; CODE XREF: sub_4192C0+33Dp
					; DATA XREF: sub_4192C0+33Dr

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
		extrn SetEnvironmentVariableA:dword ; CODE XREF: ___crtsetenv+173p
					; DATA XREF: ___crtsetenv+173r	...
; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, PCNZWCH lpString1, int cchCount1,	PCNZWCH	lpString2, int cchCount2)
		extrn CompareStringW:dword ; CODE XREF:	___crtCompareStringA+3Ep
					; ___crtCompareStringA+261p
					; DATA XREF: ...
; int __stdcall	CompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1,	int cchCount1, PCNZCH lpString2, int cchCount2)
		extrn CompareStringA:dword ; CODE XREF:	___crtCompareStringA+5Bp
					; ___crtCompareStringA+B9p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: ___crtMessageBoxA+12p
					; DATA XREF: ___crtMessageBoxA+12r
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; DATA XREF: _getSystemCP+1Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; DATA XREF: _getSystemCP+2Fr
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: __setmbcp+51p
					; _setSBUpLow+14p ...
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: __commit+47p
					; DATA XREF: __commit+47r
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: __read_lk+7Ap
					; __read_lk+14Ap
					; DATA XREF: ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	__lseek_lk+2Ap
					; DATA XREF: __lseek_lk+2Ar
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn SetStdHandle:dword ; CODE	XREF: __set_osfhnd:loc_4202E0p
					; __free_osfhnd:loc_42035Fp
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	___crtGetStringTypeA+3Fp
					; ___crtGetStringTypeA+12Dp
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	___crtGetStringTypeA+59p
					; ___crtGetStringTypeA+8Dp
					; DATA XREF: ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: ___crtLCMapStringA+42p
					; ___crtLCMapStringA+14Dp ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: ___crtLCMapStringA+5Ep
					; ___crtLCMapStringA+A7p
					; DATA XREF: ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: ___crtLCMapStringA+DFp
					; ___crtLCMapStringA+137p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: __NMSG_WRITE+14Ap
					; __write_lk+C7p ...
; HGLOBAL __stdcall GlobalFree(HGLOBAL hMem)
		extrn GlobalFree:dword	; CODE XREF: sub_40AE80+9Fp
					; DATA XREF: sub_40AE80+9Fr
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+1Bp
					; ___crtGetEnvironmentStringsA+5Bp
					; DATA XREF: ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword
					; CODE XREF: ___crtGetEnvironmentStringsA:loc_41F9B2p
					; ___crtGetEnvironmentStringsA+E1p
					; DATA XREF: ...
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; CODE XREF:	__tzset_lk+4Ep
					; DATA XREF: __tzset_lk+4Er
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: __tzset_lk+E4p
					; __tzset_lk+11Dp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	__ms_p5_mp_test_fdiv+15p
					; ___crtMessageBoxA+2Ap ...
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: __XcptFilter+134p
					; DATA XREF: __XcptFilter+134r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: _doexit+15p
					; DATA XREF: _doexit+15r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: _doexit+1Cp
					; DATA XREF: _doexit+1Cr
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: __getptd+10p
					; __freeptd+18p
					; DATA XREF: ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: __getptd+5Cp
					; DATA XREF: __getptd+5Cr
; DWORD	__stdcall TlsAlloc()
		extrn TlsAlloc:dword	; CODE XREF: __mtinit+6p
					; DATA XREF: __mtinit+6r
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: ___sbh_alloc_new_region+76p
					; ___sbh_alloc_new_group+51p
					; DATA XREF: ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: ___sbh_free_block+257p
					; ___sbh_free_block+2B2p
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: __heap_init+11p
					; DATA XREF: __heap_init+11r
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: __heap_init+2Fp
					; DATA XREF: __heap_init+2Fr
; BOOL __stdcall MoveFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName)
		extrn MoveFileA:dword	; CODE XREF: sub_41D1B9+8p
					; DATA XREF: sub_41D1B9+8r
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: sub_41D18F+4p
					; DATA XREF: sub_41D18F+4r
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: __sopen+1B3p
					; DATA XREF: __sopen+1B3r
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: __sopen+1D4p
					; __ioinit+109p ...
; BOOL __stdcall SetEndOfFile(HANDLE hFile)
		extrn SetEndOfFile:dword ; CODE	XREF: __chsize_lk+DDp
					; DATA XREF: __chsize_lk+DDr
; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
		extrn InterlockedIncrement:dword ; CODE	XREF: _tolower+26p
					; DATA XREF: _tolower+26r
; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
		extrn InterlockedDecrement:dword ; CODE	XREF: _tolower+3Bp
					; _tolower+65p
					; DATA XREF: ...
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: _fast_error_exit+1Dp
					; _doexit+9Dp
					; DATA XREF: ...
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: start+26p
					; DATA XREF: start+26r
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: start+B1p
					; __ioinit+5Ep
					; DATA XREF: ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: _realloc+108p
					; ___sbh_alloc_new_region+28p
					; DATA XREF: ...
; void __stdcall __noreturn ExitThread(DWORD dwExitCode)
		extrn ExitThread:dword	; CODE XREF: __endthreadex+2Ap
					; DATA XREF: __endthreadex+2Ar
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn TlsSetValue:dword	; CODE XREF: _threadstartex(x)+30p
					; __mtinit+2Ep	...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: _free+40p
					; ___sbh_free_block+2C4p ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: __heap_alloc+45p
					; _realloc+B5p	...
; int __stdcall	lstrcmpA(LPCSTR	lpString1, LPCSTR lpString2)
		extrn lstrcmpA:dword	; CODE XREF: sub_415840+DBp
					; sub_415840+F7p ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_401000+51p
					; sub_4114D0+Bp ...
; HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC	hResInfo)
		extrn LoadResource:dword ; CODE	XREF: sub_40ADE0+1Dp
					; DATA XREF: sub_40ADE0+1Dr
; LPVOID __stdcall LockResource(HGLOBAL	hResData)
		extrn LockResource:dword ; CODE	XREF: sub_40ADE0+26p
					; DATA XREF: sub_40ADE0+26r
; BOOL __stdcall FreeResource(HGLOBAL hResData)
		extrn FreeResource:dword ; CODE	XREF: sub_40ADE0+85p
					; DATA XREF: sub_40ADE0+85r
; void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime)
		extrn GetLocalTime:dword ; CODE	XREF: .text:00409ED0p
					; DATA XREF: .text:00409ED0r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: WinMain(x,x,x,x)+5Ap
					; WinMain(x,x,x,x)+73p	...
; HANDLE __stdcall CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCSTR	lpName)
		extrn CreateSemaphoreA:dword ; CODE XREF: sub_405420+Fp
					; DATA XREF: sub_405420+Fr
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_405420+1Bp
					; __beginthreadex+4Bp ...
; BOOL __stdcall TerminateThread(HANDLE	hThread, DWORD dwExitCode)
		extrn TerminateThread:dword ; CODE XREF: sub_412530+86p
					; DATA XREF: sub_412530+86r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_412530+A4p
					; sub_412530+304p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_412530+ABp
					; __fcloseall+4Dp
					; DATA XREF: ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_412530+314p
					; sub_412530+1053p ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_412530+ABAp
					; __beginthreadex+41p
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_412530+1025p
					; __mtinitlocks_0+Dp ...
; BOOL __stdcall CopyFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists)
		extrn CopyFileA:dword	; CODE XREF: sub_410D90+26Bp
					; sub_410D90+4BAp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_4100C0+AEp
					; DATA XREF: sub_4100C0+AEr
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40C0F0+5Bp
					; __setargv+23p ...
; HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes)
		extrn GlobalAlloc:dword	; CODE XREF: sub_40AE80+3Dp
					; DATA XREF: sub_40AE80+3Dr
; HRSRC	__stdcall FindResourceA(HMODULE	hModule, LPCSTR	lpName,	LPCSTR lpType)
		extrn FindResourceA:dword ; CODE XREF: sub_40ADE0+10p
					; DATA XREF: sub_40ADE0+10r
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+11Fp
					; DATA XREF: ___crtGetEnvironmentStringsA+11Fr
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn GetVersionExA:dword ; CODE XREF: sub_4053B0+13p
					; DATA XREF: sub_4053B0+13r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_405420+29p
					; __close_lk+3Ap ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: sub_405420+68p
					; .text:0040E530p ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: __ioinit+16Cp
					; __NMSG_WRITE+143p
					; DATA XREF: ...
; LPSTR	__stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcatA:dword	; CODE XREF: sub_404810+357p
					; sub_4052E0+3Cp ...
; LPVOID __stdcall GlobalLock(HGLOBAL hMem)
		extrn GlobalLock:dword	; CODE XREF: sub_403E90+13p
					; sub_40AE80+46p
					; DATA XREF: ...
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: sub_403E90+25p
					; sub_404CA0+2Ep ...
; BOOL __stdcall GlobalUnlock(HGLOBAL hMem)
		extrn GlobalUnlock:dword ; CODE	XREF: sub_403E90+CBp
					; sub_40AE80+98p
					; DATA XREF: ...
; LPSTR	__stdcall lstrcpyA(LPSTR lpString1, LPCSTR lpString2)
		extrn lstrcpyA:dword	; CODE XREF: sub_4028D0+FFp
					; sub_4028D0+10Ep ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_402840+69p
					; sub_40C340+3Fp ...
; int __stdcall	lstrcmpiA(LPCSTR lpString1, LPCSTR lpString2)
		extrn lstrcmpiA:dword	; CODE XREF: .text:004023F9p
					; DATA XREF: .text:004023F9r
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword
					; CODE XREF: ___crtGetEnvironmentStringsA+CEp
					; DATA XREF: ___crtGetEnvironmentStringsA+CEr
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	__ioinit+1B1p
					; DATA XREF: __ioinit+1B1r

;
; Imports from PGP_SDK.dll
;
		extrn __imp_PGPGetPrimaryUserID:dword ;	DATA XREF: PGPGetPrimaryUserIDr
					; .rdata:0042BD08o
		extrn __imp_PGPGetPrimaryUserIDNameBuffer:dword
					; DATA XREF: PGPGetPrimaryUserIDNameBufferr
		extrn __imp_PGPReallocData:dword ; DATA	XREF: PGPReallocDatar
		extrn __imp_PGPMemoryMgrIsValid:dword ;	DATA XREF: PGPMemoryMgrIsValidr
		extrn __imp_PGPNewData:dword ; DATA XREF: PGPNewDatar
		extrn __imp_PGPUnionFilters:dword ; DATA XREF: PGPUnionFiltersr
		extrn __imp_PGPNegateFilter:dword ; DATA XREF: PGPNegateFilterr
		extrn __imp_PGPGetKeyIDFromString:dword	; DATA XREF: PGPGetKeyIDFromStringr
		extrn __imp_PGPNewKeyIDFilter:dword ; DATA XREF: PGPNewKeyIDFilterr
		extrn __imp_PGPNewKeyEncryptAlgorithmFilter:dword
					; DATA XREF: PGPNewKeyEncryptAlgorithmFilterr
		extrn __imp_PGPGetPGPTimeFromStdTime:dword
					; DATA XREF: PGPGetPGPTimeFromStdTimer
		extrn __imp_PGPNewKeyCreationTimeFilter:dword
					; DATA XREF: PGPNewKeyCreationTimeFilterr
		extrn __imp_PGPIntersectFilters:dword ;	DATA XREF: PGPIntersectFiltersr
		extrn __imp_PGPNewKeyExpirationTimeFilter:dword
					; DATA XREF: PGPNewKeyExpirationTimeFilterr
		extrn __imp_PGPNewKeyRevokedFilter:dword
					; DATA XREF: PGPNewKeyRevokedFilterr
		extrn __imp_PGPNewKeyDisabledFilter:dword
					; DATA XREF: PGPNewKeyDisabledFilterr
		extrn __imp_PGPNewKeyEncryptKeySizeFilter:dword
					; DATA XREF: PGPNewKeyEncryptKeySizeFilterr
		extrn __imp_PGPsdkPrefGetFileSpec:dword	; DATA XREF: PGPsdkPrefGetFileSpecr
		extrn __imp_PGPGetFullPathFromFileSpec:dword
					; DATA XREF: PGPGetFullPathFromFileSpecr
		extrn __imp_PGPGetContextMemoryMgr:dword
					; DATA XREF: PGPGetContextMemoryMgrr
		extrn __imp_PGPSortGroupSet:dword ; DATA XREF: PGPSortGroupSetr
		extrn __imp_PGPGetGroupInfo:dword ; DATA XREF: PGPGetGroupInfor
		extrn __imp_PGPCompareKeys:dword ; DATA	XREF: PGPCompareKeysr
		extrn __imp_PGPGetKeyByKeyID:dword ; DATA XREF:	PGPGetKeyByKeyIDr
		extrn __imp_PGPGetKeySetContext:dword ;	DATA XREF: PGPGetKeySetContextr
		extrn __imp_PGPFreeKeySet:dword	; DATA XREF: PGPFreeKeySetr
		extrn __imp_PGPCountKeys:dword ; DATA XREF: PGPCountKeysr
		extrn __imp_PGPCountGroupItems:dword ; DATA XREF: PGPCountGroupItemsr
		extrn __imp_PGPGetIndGroupItem:dword ; DATA XREF: PGPGetIndGroupItemr
		extrn __imp_PGPFreeGroupSet:dword ; DATA XREF: PGPFreeGroupSetr
		extrn __imp_PGPMergeGroupSets:dword ; DATA XREF: PGPMergeGroupSetsr
		extrn __imp_PGPGroupSetNeedsCommit:dword
					; DATA XREF: PGPGroupSetNeedsCommitr
		extrn __imp_PGPSetGroupDescription:dword
					; DATA XREF: PGPSetGroupDescriptionr
		extrn __imp_PGPSetGroupName:dword ; DATA XREF: PGPSetGroupNamer
		extrn __imp_PGPNewGroup:dword ;	DATA XREF: PGPNewGroupr
		extrn __imp_PGPDeleteGroup:dword ; DATA	XREF: PGPDeleteGroupr
		extrn __imp_PGPDeleteIndItemFromGroup:dword
					; DATA XREF: PGPDeleteIndItemFromGroupr
		extrn __imp_PGPAddItemToGroup:dword ; DATA XREF: PGPAddItemToGroupr
		extrn __imp_PGPFreeKeyList:dword ; DATA	XREF: PGPFreeKeyListr
		extrn __imp_PGPFreeKeyIter:dword ; DATA	XREF: PGPFreeKeyIterr
		extrn __imp_PGPGetKeyIDFromKey:dword ; DATA XREF: PGPGetKeyIDFromKeyr
		extrn __imp_PGPGetKeyNumber:dword ; DATA XREF: PGPGetKeyNumberr
		extrn __imp_PGPKeyIterNext:dword ; DATA	XREF: PGPKeyIterNextr
		extrn __imp_PGPNewKeyIter:dword	; DATA XREF: PGPNewKeyIterr
		extrn __imp_PGPOrderKeySet:dword ; DATA	XREF: PGPOrderKeySetr
		extrn __imp_PGPImportKeySet:dword ; DATA XREF: PGPImportKeySetr
		extrn __imp_PGPOInputBuffer:dword ; DATA XREF: PGPOInputBufferr
		extrn __imp_PGPOLastOption:dword ; DATA	XREF: PGPOLastOptionr
		extrn __imp_PGPFreeFileSpec:dword ; DATA XREF: PGPFreeFileSpecr
		extrn __imp_PGPNewGroupSetFromFile:dword
					; DATA XREF: PGPNewGroupSetFromFiler
		extrn __imp_PGPNewFileSpecFromFullPath:dword
					; DATA XREF: PGPNewFileSpecFromFullPathr
		extrn __imp_PGPGetIndGroupID:dword ; DATA XREF:	PGPGetIndGroupIDr
		extrn __imp_PGPCountGroupsInSet:dword ;	DATA XREF: PGPCountGroupsInSetr
		extrn __imp_PGPGetKeyIDString:dword ; DATA XREF: PGPGetKeyIDStringr
		extrn __imp_PGPOpenDefaultKeyRings:dword
					; DATA XREF: PGPOpenDefaultKeyRingsr
		extrn __imp_PGPSetGroupUserValue:dword ; DATA XREF: PGPSetGroupUserValuer
		extrn __imp_PGPSetIndGroupItemUserValue:dword
					; DATA XREF: PGPSetIndGroupItemUserValuer
		extrn __imp_PGPGetGroupLowestValidity:dword
					; DATA XREF: PGPGetGroupLowestValidityr
		extrn __imp_PGPGetKeyBoolean:dword ; DATA XREF:	PGPGetKeyBooleanr
		extrn __imp_PGPGetPrimaryUserIDValidity:dword
					; DATA XREF: PGPGetPrimaryUserIDValidityr
		extrn __imp_PGPNewContext:dword	; DATA XREF: PGPNewContextr
		extrn __imp_PGPGlobalRandomPoolMouseMoved:dword
					; DATA XREF: PGPGlobalRandomPoolMouseMovedr
		extrn __imp_PGPGlobalRandomPoolAddKeystroke:dword
					; DATA XREF: PGPGlobalRandomPoolAddKeystroker
		extrn __imp_PGPFreeContext:dword ; DATA	XREF: PGPFreeContextr
		extrn __imp_PGPCommitKeyRingChanges:dword
					; DATA XREF: PGPCommitKeyRingChangesr
		extrn __imp_PGPRemoveKeys:dword	; DATA XREF: PGPRemoveKeysr
		extrn __imp_PGPNewSingletonKeySet:dword	; DATA XREF: PGPNewSingletonKeySetr
		extrn __imp_PGPFreeData:dword ;	DATA XREF: PGPFreeDatar
		extrn __imp_PGPSignUserID:dword	; DATA XREF: PGPSignUserIDr
		extrn __imp_PGPOPassphrase:dword ; DATA	XREF: PGPOPassphraser
		extrn __imp_PGPsdkLoadDefaultPrefs:dword
					; DATA XREF: PGPsdkLoadDefaultPrefsr
		extrn __imp_PGPNewSecureData:dword ; DATA XREF:	PGPNewSecureDatar
		extrn __imp_PGPFreeOptionList:dword ; DATA XREF: PGPFreeOptionListr
		extrn __imp_PGPSetKeyTrust:dword ; DATA	XREF: PGPSetKeyTrustr
		extrn __imp_PGPOExportable:dword ; DATA	XREF: PGPOExportabler
		extrn __imp_PGPOSigTrust:dword ; DATA XREF: PGPOSigTrustr
		extrn __imp_PGPGenerateSubKey:dword ; DATA XREF: PGPGenerateSubKeyr
		extrn __imp_PGPOKeyGenMasterKey:dword ;	DATA XREF: PGPOKeyGenMasterKeyr
		extrn __imp_PGPGenerateKey:dword ; DATA	XREF: PGPGenerateKeyr
		extrn __imp_PGPORevocationKeySet:dword ; DATA XREF: PGPORevocationKeySetr
		extrn __imp_PGPAppendOptionList:dword ;	DATA XREF: PGPAppendOptionListr
		extrn __imp_PGPOAdditionalRecipientRequestKeySet:dword
					; DATA XREF: PGPOAdditionalRecipientRequestKeySetr
		extrn __imp_PGPBuildOptionList:dword ; DATA XREF: PGPBuildOptionListr
		extrn __imp_PGPOKeySetRef:dword	; DATA XREF: PGPOKeySetRefr
		extrn __imp_PGPOKeyGenParams:dword ; DATA XREF:	PGPOKeyGenParamsr
		extrn __imp_PGPOKeyGenFast:dword ; DATA	XREF: PGPOKeyGenFastr
		extrn __imp_PGPOKeyGenName:dword ; DATA	XREF: PGPOKeyGenNamer
		extrn __imp_PGPOExpiration:dword ; DATA	XREF: PGPOExpirationr
		extrn __imp_PGPOPreferredAlgorithms:dword
					; DATA XREF: PGPOPreferredAlgorithmsr
		extrn __imp_PGPOEventHandler:dword ; DATA XREF:	PGPOEventHandlerr
		extrn __imp_PGPGetDefaultPrivateKey:dword
					; DATA XREF: PGPGetDefaultPrivateKeyr
		extrn __imp_PGPFreeFilter:dword	; DATA XREF: PGPFreeFilterr
		extrn __imp_PGPFilterKeySet:dword ; DATA XREF: PGPFilterKeySetr
		extrn __imp_PGPNewUserIDStringFilter:dword
					; DATA XREF: PGPNewUserIDStringFilterr
		extrn __imp_PGPGlobalRandomPoolGetEntropy:dword
					; DATA XREF: PGPGlobalRandomPoolGetEntropyr
		extrn __imp_PGPGlobalRandomPoolGetSize:dword
					; DATA XREF: PGPGlobalRandomPoolGetSizer
		extrn __imp_PGPGetKeyEntropyNeeded:dword
					; DATA XREF: PGPGetKeyEntropyNeededr
		extrn __imp_PGPAddKeys:dword ; DATA XREF: PGPAddKeysr
		extrn __imp_PGPNewKeySet:dword ; DATA XREF: PGPNewKeySetr
		extrn __imp_PGPGetSigNumber:dword ; DATA XREF: PGPGetSigNumberr
		extrn __imp_PGPGetSigBoolean:dword ; DATA XREF:	PGPGetSigBooleanr
		extrn __imp_PGPKeyIterNextUIDSig:dword ; DATA XREF: PGPKeyIterNextUIDSigr
		extrn __imp_PGPKeyIterNextUserID:dword ; DATA XREF: PGPKeyIterNextUserIDr
		extrn __imp_PGPCompareKeyIDs:dword ; DATA XREF:	PGPCompareKeyIDsr
		extrn __imp_PGPGetKeyIDOfCertifier:dword
					; DATA XREF: PGPGetKeyIDOfCertifierr
		extrn __imp_PGPNewSigKeyIDFilter:dword ; DATA XREF: PGPNewSigKeyIDFilterr
		extrn __imp_PGPOInputFile:dword	; DATA XREF: PGPOInputFiler
		extrn __imp_PGPPropagateTrust:dword ; DATA XREF: PGPPropagateTrustr

;
; Imports from PGPcl.dll
;
		extrn PGPclSystemTimeToDays:dword ; CODE XREF: .text:00409C5Ep
					; .text:00409CA7p ...
		extrn __imp_PGPDisposeKeyServerPath:dword
					; DATA XREF: PGPDisposeKeyServerPathr
		extrn __imp_PGPCreateKeyServerPath:dword
					; DATA XREF: PGPCreateKeyServerPathr
		extrn PGPclIsExpired:dword ; CODE XREF:	WinMain(x,x,x,x)+9Ep
					; DATA XREF: WinMain(x,x,x,x)+9Er
		extrn PGPclSyncKeyserverPrefs:dword ; CODE XREF: sub_414060+295p
					; sub_414060+385p
					; DATA XREF: ...
		extrn __imp_PGPFindEmailDomain:dword ; DATA XREF: PGPFindEmailDomainr
		extrn PGPclHelpAbout:dword ; CODE XREF:	sub_4113A0+12p
					; DATA XREF: sub_4113A0+12r
		extrn PGPkmCreateKeyManagerEx:dword ; CODE XREF: .text:0040D0E4p
					; DATA XREF: .text:0040D0E4r
		extrn PGPclCheckSDKSupportForPKAlg:dword ; CODE	XREF: sub_4060C0+77p
					; DATA XREF: sub_4060C0+77r
		extrn PGPclSendCertificateRequestToServerNotify:dword
					; CODE XREF: sub_406360+2F4p
					; DATA XREF: sub_406360+2F4r
		extrn PGPclSyncKeySets:dword ; CODE XREF: .text:0040DE22p
					; DATA XREF: .text:0040DE22r
		extrn PGPkmGetManagerWindow:dword ; CODE XREF: .text:0040D26Bp
					; DATA XREF: .text:0040D26Br
		extrn PGPkmOKToClose:dword ; CODE XREF:	.text:0040D346p
					; DATA XREF: .text:0040D346r
		extrn PGPkmDefaultNotificationProc:dword ; CODE	XREF: .text:0040D98Fp
					; DATA XREF: .text:0040D98Fr
		extrn PGPclSendKeysToRootServerNotify:dword ; CODE XREF: sub_406A90+2F8p
					; DATA XREF: sub_406A90+2F8r
		extrn PGPclSendShares:dword ; CODE XREF: .text:0040E7D6p
					; DATA XREF: .text:0040E7D6r
		extrn PGPclCloseClientPrefs:dword ; CODE XREF: sub_4020A0+EAp
					; sub_4021A0+B0p ...
		extrn PGPclOpenClientPrefs:dword ; CODE	XREF: sub_4020A0+5Cp
					; sub_4021A0+19p ...
		extrn PGPclQueryAddKeys:dword ;	CODE XREF: sub_402440+115p
					; sub_40C3B0+CAp ...
		extrn PGPclErrorBox:dword ; CODE XREF: sub_402440+CFp
					; sub_402770+91p ...
		extrn PGPclSearchServerForKeyIDs:dword ; CODE XREF: sub_402440+A7p
					; DATA XREF: sub_402440+A7r
		extrn PGPclGetGroupsFromRootServer:dword ; CODE	XREF: sub_402770+23p
					; DATA XREF: sub_402770+23r
		extrn PGPclSendGroupsToRootServer:dword	; CODE XREF: sub_402810+18p
					; DATA XREF: sub_402810+18r
		extrn PGPclSaveGroupFile:dword ; CODE XREF: sub_402840+35p
					; DATA XREF: sub_402840+35r
		extrn PGPkmPerformAction:dword ; CODE XREF: sub_4030D0+82p
					; .text:0040DA97p ...
		extrn PGPkmSelectKey:dword ; CODE XREF:	sub_404050+65p
					; .text:0040F5B9p
					; DATA XREF: ...
		extrn PGPclCloseGroupFile:dword	; CODE XREF: sub_405110+38p
					; sub_4051E0+3Bp
					; DATA XREF: ...
		extrn PGPclOpenGroupFile:dword ; CODE XREF: sub_4051E0+5Ap
					; DATA XREF: sub_4051E0+5Ar
		extrn PGPclGetPGPPath:dword ; CODE XREF: sub_4052E0+14p
					; sub_4054C0+10p ...
		extrn PGPclInitLibrary:dword ; CODE XREF: sub_405510+F5p
					; DATA XREF: sub_405510+F5r
		extrn PGPclCloseLibrary:dword ;	CODE XREF: WinMain(x,x,x,x):loc_405AC7p
					; DATA XREF: WinMain(x,x,x,x):loc_405AC7r
		extrn PGPclSplash:dword	; CODE XREF: WinMain(x,x,x,x)+DDp
					; DATA XREF: WinMain(x,x,x,x)+DDr
		extrn PGPkmDestroyKeyManager:dword ; CODE XREF:	.text:0040D53Cp
					; DATA XREF: .text:0040D53Cr
		extrn PGPclSetSplashParent:dword ; CODE	XREF: sub_405B40+3p
					; .text:0040D2B8p
					; DATA XREF: ...
		extrn PGPclCloseAdminPrefs:dword ; CODE	XREF: sub_405B80+2F2p
					; DATA XREF: sub_405B80+2F2r
		extrn PGPclConfirmRemoteAuthentication:dword ; CODE XREF: .text:0040E216p
					; sub_414060+252p ...
		extrn PGPclWebBrowse:dword ; CODE XREF:	.text:0040E824p
					; DATA XREF: .text:0040E824r
		extrn PGPclCheckAutoUpdate:dword ; CODE	XREF: .text:0040E631p
					; DATA XREF: .text:0040E631r
		extrn PGPclRandom:dword	; CODE XREF: sub_407120+1F5p
					; sub_408020+31Bp
					; DATA XREF: ...
		extrn PGPclPreferences:dword ; CODE XREF: sub_40C2D0+2Bp
					; DATA XREF: sub_40C2D0+2Br
		extrn __imp_PGPGetKeyServerPrefs:dword ; DATA XREF: PGPGetKeyServerPrefsr
		extrn PGPclUpdateKeySetFromServer:dword	; CODE XREF: sub_40C3B0+2Dp
					; sub_40C4E0+76p
					; DATA XREF: ...
		extrn PGPkmSynchronizeThreadAccessToSDK:dword ;	CODE XREF: .text:0040F5F3p
					; DATA XREF: .text:0040F5F3r
		extrn PGPkmGetSelectedColumns:dword ; CODE XREF: sub_40B090+DCp
					; .text:0040D28Ap ...
		extrn PGPkmIsActionEnabled:dword ; CODE	XREF: sub_40B090+32p
					; sub_40B090+8Fp ...
		extrn __imp_PGPGetKeyServerURL:dword ; DATA XREF: PGPGetKeyServerURLr
		extrn PGPkmLoadKeySet:dword ; CODE XREF: sub_40C1A0+102p
					; .text:0040D2E3p ...
		extrn PGPkmConfigure:dword ; CODE XREF:	sub_40C1A0+F0p
					; .text:0040D261p ...
		extrn PGPkmProcessKeyPropMessage:dword ; CODE XREF: .text:0040F62Fp
					; DATA XREF: .text:0040F62Fr
		extrn PGPkmSelectColumns:dword ; CODE XREF: .text:loc_40EE52p
					; .text:0040EE7Ep ...
		extrn PGPclSearchServerWithFilter:dword	; CODE XREF: sub_40CA90+82p
					; DATA XREF: sub_40CA90+82r
		extrn PGPkmReLoadKeySet:dword ;	CODE XREF: sub_40CD70+5Ep
					; .text:0040E55Ap ...
		extrn PGPclGetCertificateRevocationsFromServer:dword
					; CODE XREF: sub_40CD70+19p
					; DATA XREF: sub_40CD70+19r
		extrn PGPclPurgeCachedPassphrase:dword ; CODE XREF: .text:0040F975p
					; DATA XREF: .text:0040F975r

;
; Imports from PGPsdkNL.dll
;
		extrn __imp_PGPSetKeyServerEventHandler:dword
					; DATA XREF: PGPSetKeyServerEventHandlerr
					; .rdata:0042BD44o
		extrn __imp_PGPKeyServerOpen:dword ; DATA XREF:	PGPKeyServerOpenr
		extrn __imp_PGPQueryKeyServer:dword ; DATA XREF: PGPQueryKeyServerr
		extrn __imp_PGPKeyServerInit:dword ; DATA XREF:	PGPKeyServerInitr
		extrn __imp_PGPNewKeyServerFromHostName:dword
					; DATA XREF: PGPNewKeyServerFromHostNamer
		extrn __imp_PGPKeyServerCreateThreadStorage:dword
					; DATA XREF: PGPKeyServerCreateThreadStorager
		extrn __imp_PGPtlsGetNegotiatedCipherSuite:dword
					; DATA XREF: PGPtlsGetNegotiatedCipherSuiter
		extrn __imp_PGPtlsGetRemoteAuthenticatedKey:dword
					; DATA XREF: PGPtlsGetRemoteAuthenticatedKeyr
		extrn __imp_PGPNewTLSSession:dword ; DATA XREF:	PGPNewTLSSessionr
		extrn __imp_PGPKeyServerDisposeThreadStorage:dword
					; DATA XREF: PGPKeyServerDisposeThreadStorager
		extrn __imp_PGPKeyServerClose:dword ; DATA XREF: PGPKeyServerCloser
		extrn __imp_PGPFreeKeyServer:dword ; DATA XREF:	PGPFreeKeyServerr
		extrn __imp_PGPFreeTLSSession:dword ; DATA XREF: PGPFreeTLSSessionr
		extrn __imp_PGPNewTLSContext:dword ; DATA XREF:	PGPNewTLSContextr
		extrn __imp_PGPKeyServerCleanup:dword ;	DATA XREF: PGPKeyServerCleanupr
		extrn __imp_PGPCancelKeyServerCall:dword
					; DATA XREF: PGPCancelKeyServerCallr
		extrn __imp_PGPFreeTLSContext:dword ; DATA XREF: PGPFreeTLSContextr

;
; Imports from PGPsdkUI.dll
;
		extrn __imp_PGPEstimatePassphraseQuality:dword
					; DATA XREF: PGPEstimatePassphraseQualityr
					; .rdata:0042BD30o

;
; Imports from SHELL32.dll
;
; UINT __stdcall DragQueryFileA(HDROP hDrop, UINT iFile, LPSTR lpszFile, UINT cch)
		extrn DragQueryFileA:dword ; CODE XREF:	sub_4040F0+32p
					; sub_4040F0+CFp
					; DATA XREF: ...

;
; Imports from USER32.dll
;
; BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags)
		extrn DrawEdge:dword	; CODE XREF: sub_412530+2CDp
					; DATA XREF: sub_412530+2CDr ...
; int __stdcall	FillRect(HDC hDC, const	RECT *lprc, HBRUSH hbr)
		extrn FillRect:dword	; CODE XREF: sub_412530+1C1p
					; sub_412530+20Fp ...
; int __stdcall	GetWindowTextLengthA(HWND hWnd)
		extrn GetWindowTextLengthA:dword ; CODE	XREF: sub_411C60+103p
					; sub_411C60+304p ...
; int __stdcall	GetWindowTextA(HWND hWnd, LPSTR	lpString, int nMaxCount)
		extrn GetWindowTextA:dword ; CODE XREF:	sub_4114D0+66p
					; sub_411C60+122p ...
; BOOL __stdcall DestroyWindow(HWND hWnd)
		extrn DestroyWindow:dword ; CODE XREF: .text:0040D3E2p
					; .text:0040D40Bp ...
; void __stdcall PostQuitMessage(int nExitCode)
		extrn PostQuitMessage:dword ; CODE XREF: .text:0040D59Bp
					; DATA XREF: .text:0040D59Br
; BOOL __stdcall GetWindowPlacement(HWND hWnd, WINDOWPLACEMENT *lpwndpl)
		extrn GetWindowPlacement:dword ; CODE XREF: sub_40C040+15p
					; DATA XREF: sub_40C040+15r
; HANDLE __stdcall GetClipboardData(UINT uFormat)
		extrn GetClipboardData:dword ; CODE XREF: sub_403FB0+15p
					; DATA XREF: sub_403FB0+15r
; BOOL __stdcall CloseClipboard()
		extrn CloseClipboard:dword ; CODE XREF:	sub_403FB0:loc_403FDBp
					; DATA XREF: sub_403FB0:loc_403FDBr
; HWND __stdcall CreateDialogParamA(HINSTANCE hInstance, LPCSTR	lpTemplateName,	HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam)
		extrn CreateDialogParamA:dword ; CODE XREF: sub_401000+58p
					; sub_411460+26p
					; DATA XREF: ...
; BOOL __stdcall GetClientRect(HWND hWnd, LPRECT lpRect)
		extrn GetClientRect:dword ; CODE XREF: sub_401000+3Dp
					; sub_401260+79p ...
; BOOL __stdcall SetPropA(HWND hWnd, LPCSTR lpString, HANDLE hData)
		extrn SetPropA:dword	; CODE XREF: sub_401000+6Ap
					; sub_401090+33p ...
; BOOL __stdcall OpenClipboard(HWND hWndNewOwner)
		extrn OpenClipboard:dword ; CODE XREF: sub_403FB0+5p
					; DATA XREF: sub_403FB0+5r
; LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn SendMessageA:dword ; CODE	XREF: sub_401130+EFp
					; sub_401260+FAp ...
; BOOL __stdcall ReleaseCapture()
		extrn ReleaseCapture:dword ; CODE XREF:	.text:0040E472p
					; sub_418140+13p
					; DATA XREF: ...
; LRESULT __stdcall DefWindowProcA(HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn DefWindowProcA:dword ; CODE XREF:	.text:0040F9A9p
					; sub_414980+7Ap ...
; HWND __stdcall SetCapture(HWND hWnd)
		extrn SetCapture:dword	; CODE XREF: .text:0040E438p
					; sub_417FC0+165p
					; DATA XREF: ...
; BOOL __stdcall TrackPopupMenu(HMENU hMenu, UINT uFlags, int x, int y,	int nReserved, HWND hWnd, const	RECT *prcRect)
		extrn TrackPopupMenu:dword ; CODE XREF:	sub_40B830+647p
					; sub_40BEA0+33p
					; DATA XREF: ...
; BOOL __stdcall DestroyMenu(HMENU hMenu)
		extrn DestroyMenu:dword	; CODE XREF: sub_40B830+64Ep
					; sub_40BEA0+3Ap
					; DATA XREF: ...
; BOOL __stdcall SetMenuItemInfoA(HMENU	hmenu, UINT item, BOOL fByPositon, LPCMENUITEMINFOA lpmii)
		extrn SetMenuItemInfoA:dword ; CODE XREF: sub_40B640+76p
					; sub_40B640+A9p ...
; HMENU	__stdcall CreatePopupMenu()
		extrn CreatePopupMenu:dword ; CODE XREF: sub_40B510+3Ap
					; DATA XREF: sub_40B510+3Ar
; BOOL __stdcall AppendMenuA(HMENU hMenu, UINT uFlags, UINT_PTR	uIDNewItem, LPCSTR lpNewItem)
		extrn AppendMenuA:dword	; CODE XREF: sub_40B510+8Fp
					; sub_40B510+99p ...
; DWORD	__stdcall CheckMenuItem(HMENU hMenu, UINT uIDCheckItem,	UINT uCheck)
		extrn CheckMenuItem:dword ; CODE XREF: sub_40B090+FFp
					; sub_40B090+114p ...
; BOOL __stdcall EnableMenuItem(HMENU hMenu, UINT uIDEnableItem, UINT uEnable)
		extrn EnableMenuItem:dword ; CODE XREF:	sub_40B090+24Ep
					; sub_40B800+14p ...
; BOOL __stdcall InsertMenuA(HMENU hMenu, UINT uPosition, UINT uFlags, UINT_PTR	uIDNewItem, LPCSTR lpNewItem)
		extrn InsertMenuA:dword	; CODE XREF: sub_40B090+3CCp
					; sub_40B090+3E6p ...
; HMENU	__stdcall GetSubMenu(HMENU hMenu, int nPos)
		extrn GetSubMenu:dword	; CODE XREF: sub_40AF30+9p
					; sub_40B090+21p ...
; BOOL __stdcall DeleteMenu(HMENU hMenu, UINT uPosition, UINT uFlags)
		extrn DeleteMenu:dword	; CODE XREF: sub_40AF30+1Fp
					; sub_40AF30+29p ...
; int __stdcall	GetSystemMetrics(int nIndex)
		extrn GetSystemMetrics:dword ; CODE XREF: .text:0040AD93p
					; .text:0040ADA9p ...
; UINT __stdcall GetDlgItemInt(HWND hDlg, int nIDDlgItem, BOOL *lpTranslated, BOOL bSigned)
		extrn GetDlgItemInt:dword ; CODE XREF: sub_40A020+2D9p
					; DATA XREF: sub_40A020+2D9r
; BOOL __stdcall SetDlgItemInt(HWND hDlg, int nIDDlgItem, UINT uValue, BOOL bSigned)
		extrn SetDlgItemInt:dword ; CODE XREF: sub_40A020+4B5p
					; DATA XREF: sub_40A020+4B5r
; SHORT	__stdcall GetKeyState(int nVirtKey)
		extrn GetKeyState:dword	; CODE XREF: sub_4075E0+64p
					; sub_4076A0+77p ...
; UINT __stdcall IsDlgButtonChecked(HWND hDlg, int nIDButton)
		extrn IsDlgButtonChecked:dword ; CODE XREF: .text:00406FDEp
					; .text:004070F0p ...
; BOOL __stdcall CheckDlgButton(HWND hDlg, int nIDButton, UINT uCheck)
		extrn CheckDlgButton:dword ; CODE XREF:	.text:004070B9p
					; sub_407120+C9p ...
; UINT_PTR __stdcall SetTimer(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc)
		extrn SetTimer:dword	; CODE XREF: sub_406360+AEp
					; sub_406A90+AEp ...
; BOOL __stdcall KillTimer(HWND	hWnd, UINT_PTR uIDEvent)
		extrn KillTimer:dword	; CODE XREF: sub_406360+12Dp
					; sub_406360+34Dp ...
; HDC __stdcall	BeginPaint(HWND	hWnd, LPPAINTSTRUCT lpPaint)
		extrn BeginPaint:dword	; CODE XREF: .text:00406320p
					; sub_406360+3A5p ...
; BOOL __stdcall EndPaint(HWND hWnd, const PAINTSTRUCT *lpPaint)
		extrn EndPaint:dword	; CODE XREF: .text:00406342p
					; sub_406360+3C6p ...
; HHOOK	__stdcall SetWindowsHookExA(int	idHook,	HOOKPROC lpfn, HINSTANCE hmod, DWORD dwThreadId)
		extrn SetWindowsHookExA:dword ;	CODE XREF: WinMain(x,x,x,x)+6Cp
					; WinMain(x,x,x,x)+7Fp	...
; HMENU	__stdcall LoadMenuA(HINSTANCE hInstance, LPCSTR	lpMenuName)
		extrn LoadMenuA:dword	; CODE XREF: WinMain(x,x,x,x)+16Bp
					; sub_40B830+43p ...
; HACCEL __stdcall LoadAcceleratorsA(HINSTANCE hInstance, LPCSTR lpTableName)
		extrn LoadAcceleratorsA:dword ;	CODE XREF: WinMain(x,x,x,x)+1D9p
					; WinMain(x,x,x,x)+1E9p
					; DATA XREF: ...
; BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax)
		extrn GetMessageA:dword	; CODE XREF: WinMain(x,x,x,x)+1F8p
					; WinMain(x,x,x,x)+26Dp
					; DATA XREF: ...
; int __stdcall	TranslateAcceleratorA(HWND hWnd, HACCEL	hAccTable, LPMSG lpMsg)
		extrn TranslateAcceleratorA:dword ; CODE XREF: WinMain(x,x,x,x)+246p
					; WinMain(x,x,x,x)+2D2p
					; DATA XREF: ...
; BOOL __stdcall IsDialogMessageA(HWND hDlg, LPMSG lpMsg)
		extrn IsDialogMessageA:dword ; CODE XREF: WinMain(x,x,x,x)+224p
					; DATA XREF: WinMain(x,x,x,x)+224r
; BOOL __stdcall TranslateMessage(const	MSG *lpMsg)
		extrn TranslateMessage:dword ; CODE XREF: WinMain(x,x,x,x)+251p
					; DATA XREF: WinMain(x,x,x,x)+251r
; LRESULT __stdcall DispatchMessageA(const MSG *lpMsg)
		extrn DispatchMessageA:dword ; CODE XREF: WinMain(x,x,x,x)+25Cp
					; DATA XREF: WinMain(x,x,x,x)+25Cr
; BOOL __stdcall UnhookWindowsHookEx(HHOOK hhk)
		extrn UnhookWindowsHookEx:dword	; CODE XREF: WinMain(x,x,x,x)+2B0p
					; WinMain(x,x,x,x)+2B9p ...
; BOOL __stdcall PtInRect(const	RECT *lprc, POINT pt)
		extrn PtInRect:dword	; CODE XREF: sub_405730+7Ap
					; sub_4176E0+3Ep ...
; BOOL __stdcall EnableWindow(HWND hWnd, BOOL bEnable)
		extrn EnableWindow:dword ; CODE	XREF: sub_405700+1Bp
					; sub_405B40+13p ...
; LRESULT __stdcall CallNextHookEx(HHOOK hhk, int nCode, WPARAM	wParam,	LPARAM lParam)
		extrn CallNextHookEx:dword ; CODE XREF:	fn+20p	sub_4056D0+25p
					; DATA XREF: ...
; HICON	__stdcall LoadIconA(HINSTANCE hInstance, LPCSTR	lpIconName)
		extrn LoadIconA:dword	; CODE XREF: sub_405510+13Dp
					; DATA XREF: sub_405510+13Dr
; ATOM __stdcall RegisterClassA(const WNDCLASSA	*lpWndClass)
		extrn RegisterClassA:dword ; CODE XREF:	sub_405510+170p
					; sub_414910+59p
					; DATA XREF: ...
; HWND __stdcall FindWindowA(LPCSTR lpClassName, LPCSTR	lpWindowName)
		extrn FindWindowA:dword	; CODE XREF: sub_405420+39p
					; sub_410630+35p
					; DATA XREF: ...
; BOOL __stdcall IsZoomed(HWND hWnd)
		extrn IsZoomed:dword	; CODE XREF: sub_405420+46p
					; DATA XREF: sub_405420+46r
; BOOL __stdcall SetForegroundWindow(HWND hWnd)
		extrn SetForegroundWindow:dword	; CODE XREF: sub_405420+5Ap
					; sub_40C2D0+3Fp ...
; HDC __stdcall	GetDC(HWND hWnd)
		extrn GetDC:dword	; CODE XREF: sub_404530+FBp
					; sub_405B80+4Ep ...
; int __stdcall	ReleaseDC(HWND hWnd, HDC hDC)
		extrn ReleaseDC:dword	; CODE XREF: sub_404530+11Cp
					; sub_405B80+6Dp ...
; HBITMAP __stdcall LoadBitmapA(HINSTANCE hInstance, LPCSTR lpBitmapName)
		extrn LoadBitmapA:dword	; CODE XREF: sub_404530+145p
					; sub_404530+174p ...
; HWND __stdcall SetFocus(HWND hWnd)
		extrn SetFocus:dword	; CODE XREF: sub_401D70+E9p
					; sub_4075E0+83p ...
; HANDLE __stdcall GetPropA(HWND hWnd, LPCSTR lpString)
		extrn GetPropA:dword	; CODE XREF: sub_401000+10p
					; sub_401090+Ep ...
; BOOL __stdcall IsClipboardFormatAvailable(UINT format)
		extrn IsClipboardFormatAvailable:dword ; CODE XREF: sub_401AC0+2p
					; DATA XREF: sub_401AC0+2r
; BOOL __stdcall SystemParametersInfoA(UINT uiAction, UINT uiParam, PVOID pvParam, UINT	fWinIni)
		extrn SystemParametersInfoA:dword ; CODE XREF: sub_4033B0+1Ep
					; sub_410630+Ep ...
; HMENU	__stdcall GetMenu(HWND hWnd)
		extrn GetMenu:dword	; CODE XREF: sub_4033B0+45p
					; .text:0040CF08p
					; DATA XREF: ...
; BOOL __stdcall GetCursorPos(LPPOINT lpPoint)
		extrn GetCursorPos:dword ; CODE	XREF: sub_4033B0+69p
					; sub_40BEA0+10p ...
; BOOL __stdcall ScreenToClient(HWND hWnd, LPPOINT lpPoint)
		extrn ScreenToClient:dword ; CODE XREF:	sub_4033B0+78p
					; .text:0040E1CAp ...
; int wsprintfA(LPSTR, LPCSTR, ...)
		extrn wsprintfA:dword	; CODE XREF: sub_402F70+AFp
					; sub_403820+5Dp ...
; LRESULT __stdcall SendDlgItemMessageA(HWND hDlg, int nIDDlgItem, UINT	Msg, WPARAM wParam, LPARAM lParam)
		extrn SendDlgItemMessageA:dword	; CODE XREF: DialogFunc+4Fp
					; DialogFunc+60p ...
; BOOL __stdcall SetWindowTextA(HWND hWnd, LPCSTR lpString)
		extrn SetWindowTextA:dword ; CODE XREF:	DialogFunc+87p
					; sub_412530+B98p
					; DATA XREF: ...
; BOOL __stdcall SetDlgItemTextA(HWND hDlg, int	nIDDlgItem, LPCSTR lpString)
		extrn SetDlgItemTextA:dword ; CODE XREF: DialogFunc+9Dp
					; DialogFunc+A9p ...
; BOOL __stdcall WinHelpA(HWND hWndMain, LPCSTR	lpszHelp, UINT uCommand, ULONG_PTR dwData)
		extrn WinHelpA:dword	; CODE XREF: DialogFunc+DCp
					; DialogFunc+10Dp ...
; BOOL __stdcall EndDialog(HWND	hDlg, INT_PTR nResult)
		extrn EndDialog:dword	; CODE XREF: DialogFunc+144p
					; DialogFunc+20Bp ...
; UINT __stdcall GetDlgItemTextA(HWND hDlg, int	nIDDlgItem, LPSTR lpString, int	cchMax)
		extrn GetDlgItemTextA:dword ; CODE XREF: DialogFunc+174p
					; DialogFunc+1ABp ...
; INT_PTR __stdcall DialogBoxParamA(HINSTANCE hInstance, LPCSTR	lpTemplateName,	HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam)
		extrn DialogBoxParamA:dword ; CODE XREF: sub_4028D0+129p
					; sub_402D60+37p ...
; HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName)
		extrn LoadCursorA:dword	; CODE XREF: sub_402840+20p
					; sub_404720+27p ...
; HCURSOR __stdcall SetCursor(HCURSOR hCursor)
		extrn SetCursor:dword	; CODE XREF: sub_402840+2Dp
					; sub_402840+41p ...
; UINT __stdcall RegisterWindowMessageA(LPCSTR lpString)
		extrn RegisterWindowMessageA:dword ; CODE XREF:	sub_402840+61p
					; sub_405510+4Fp ...
; BOOL __stdcall PostMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
		extrn PostMessageA:dword ; CODE	XREF: sub_402840+7Dp
					; sub_406030+26p ...
; BOOL __stdcall UpdateWindow(HWND hWnd)
		extrn UpdateWindow:dword ; CODE	XREF: sub_402770+79p
					; sub_4028D0+15Cp ...
; int __stdcall	LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax)
		extrn LoadStringA:dword	; CODE XREF: sub_402000+23p
					; sub_402000+41p ...
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_402000+65p
					; sub_403820+EDp ...
; DWORD	__stdcall GetSysColor(int nIndex)
		extrn GetSysColor:dword	; CODE XREF: sub_401260+EBp
					; sub_4033B0+B9p ...
; BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow)
		extrn ShowWindow:dword	; CODE XREF: sub_401260+103p
					; sub_405420+53p ...
; BOOL __stdcall InvalidateRect(HWND hWnd, const RECT *lpRect, BOOL bErase)
		extrn InvalidateRect:dword ; CODE XREF:	sub_401980+5Ep
					; sub_401A20+5Ep ...
; HDC __stdcall	GetDCEx(HWND hWnd, HRGN	hrgnClip, DWORD	flags)
		extrn GetDCEx:dword	; CODE XREF: sub_414980+93Bp
					; DATA XREF: sub_414980+93Br
; HCURSOR __stdcall GetCursor()
		extrn GetCursor:dword	; CODE XREF: sub_414980+10Ep
					; sub_414980+139p ...
; BOOL __stdcall ClientToScreen(HWND hWnd, LPPOINT lpPoint)
		extrn ClientToScreen:dword ; CODE XREF:	sub_417E40+E4p
					; DATA XREF: sub_417E40+E4r
; int __stdcall	ScrollWindowEx(HWND hWnd, int dx, int dy, const	RECT *prcScroll, const RECT *prcClip, HRGN hrgnUpdate, LPRECT prcUpdate, UINT flags)
		extrn ScrollWindowEx:dword ; CODE XREF:	sub_418F80+83p
					; DATA XREF: sub_418F80+83r
; int __stdcall	SetScrollInfo(HWND hwnd, int nBar, LPCSCROLLINFO lpsi, BOOL redraw)
		extrn SetScrollInfo:dword ; CODE XREF: sub_41AB80+16Dp
					; sub_41AB80+19Dp
					; DATA XREF: ...
; int __stdcall	MapWindowPoints(HWND hWndFrom, HWND hWndTo, LPPOINT lpPoints, UINT cPoints)
		extrn MapWindowPoints:dword ; CODE XREF: sub_401260+88p
					; sub_401260+186p ...
; HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y,	int nWidth, int	nHeight, HWND hWndParent, HMENU	hMenu, HINSTANCE hInstance, LPVOID lpParam)
		extrn CreateWindowExA:dword ; CODE XREF: sub_401260+C7p
					; sub_404530+E6p ...
; BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags)
		extrn SetWindowPos:dword ; CODE	XREF: sub_401260+E3p
					; .text:0040ADC3p ...
; LONG __stdcall SetWindowLongA(HWND hWnd, int nIndex, LONG dwNewLong)
		extrn SetWindowLongA:dword ; CODE XREF:	sub_401130+79p
					; sub_401260+1ECp ...
; BOOL __stdcall MoveWindow(HWND hWnd, int X, int Y, int nWidth, int nHeight, BOOL bRepaint)
		extrn MoveWindow:dword	; CODE XREF: sub_401260+374p
					; sub_401260+3BDp ...
; HWND __stdcall GetParent(HWND	hWnd)
		extrn GetParent:dword	; CODE XREF: sub_401260+122p
					; sub_401260+153p ...
; BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect)
		extrn GetWindowRect:dword ; CODE XREF: sub_401260+176p
					; sub_401260+1B8p ...
; LONG __stdcall GetWindowLongA(HWND hWnd, int nIndex)
		extrn GetWindowLongA:dword ; CODE XREF:	sub_401260+1D5p
					; sub_401260+20Cp ...
; BOOL __stdcall IsWindowVisible(HWND hWnd)
		extrn IsWindowVisible:dword ; CODE XREF: sub_401130+B5p
					; sub_401130+D9p
					; DATA XREF: ...
; LRESULT __stdcall CallWindowProcA(WNDPROC lpPrevWndFunc, HWND	hWnd, UINT Msg,	WPARAM wParam, LPARAM lParam)
		extrn CallWindowProcA:dword ; CODE XREF: sub_401130+11Fp
					; sub_4075E0+B0p ...
; HANDLE __stdcall RemovePropA(HWND hWnd, LPCSTR lpString)
		extrn RemovePropA:dword	; CODE XREF: sub_401130+85p
					; DATA XREF: sub_401130+85r
; HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem)
		extrn GetDlgItem:dword	; CODE XREF: sub_401130+A3p
					; sub_401130+CDp ...
; BOOL __stdcall IsWindowEnabled(HWND hWnd)
		extrn IsWindowEnabled:dword ; CODE XREF: sub_401130+AEp
					; sub_401130+D2p ...

;
; Imports from comdlg32.dll
;
; BOOL __stdcall GetSaveFileNameA(LPOPENFILENAMEA)
		extrn __imp_GetSaveFileNameA:dword ; DATA XREF:	GetSaveFileNameAr
					; .rdata:0042BCA4o
; BOOL __stdcall GetOpenFileNameA(LPOPENFILENAMEA)
		extrn __imp_GetOpenFileNameA:dword ; DATA XREF:	GetOpenFileNameAr

;
; Imports from ole32.dll
;
; HRESULT __stdcall RevokeDragDrop(HWND	hwnd)
		extrn RevokeDragDrop:dword ; CODE XREF:	sub_405110+14p
					; DATA XREF: sub_405110+14r ...
; void __stdcall OleUninitialize()
		extrn OleUninitialize:dword ; CODE XREF: WinMain(x,x,x,x)+29Dp
					; DATA XREF: WinMain(x,x,x,x)+29Dr
; void __stdcall ReleaseStgMedium(LPSTGMEDIUM)
		extrn ReleaseStgMedium:dword ; CODE XREF: sub_401860+B7p
					; DATA XREF: sub_401860+B7r
; HRESULT __stdcall CoLockObjectExternal(LPUNKNOWN pUnk, BOOL fLock, BOOL fLastUnlockReleases)
		extrn CoLockObjectExternal:dword ; CODE	XREF: sub_404530+1C4p
					; sub_405110+2Ep
					; DATA XREF: ...
; HRESULT __stdcall RegisterDragDrop(HWND hwnd,	LPDROPTARGET pDropTarget)
		extrn RegisterDragDrop:dword ; CODE XREF: sub_404530+1D2p
					; DATA XREF: sub_404530+1D2r
; HRESULT __stdcall OleInitialize(LPVOID pvReserved)
		extrn OleInitialize:dword ; CODE XREF: WinMain(x,x,x,x)+Ep
					; DATA XREF: WinMain(x,x,x,x)+Er


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 4246BCh
		align 10h
off_4246C0	dd offset sub_401680	; DATA XREF: sub_401710+Fo
		dd offset sub_4016E0
		dd offset sub_4016F0
		dd offset sub_401750
		dd offset sub_401800
		dd offset sub_401850
		dd offset sub_401860
		align 10h
		dd 2D4h, 1, 40h	dup(0)
aCertserver_pgp	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit_ed	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 4246E0h, 5A8h, 260h, 3, 424C88h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_0	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__0	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 425298h, 5A8h, 260h, 3, 425840h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_1	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__1	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 425E50h, 5A8h, 260h, 3, 4263F8h, 0Ch, 3Fh
		dd 0
dbl_426800	dq 100.0		; DATA XREF: sub_4086D0+2C3r
		dd 4 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_2	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__2	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 426A10h, 5A8h, 260h, 3, 426FB8h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_3	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__3	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 4275C8h, 5A8h, 260h, 3, 427B70h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_4	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__4	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 428180h, 5A8h, 260h, 3, 428728h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_5	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__5	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 428D38h, 5A8h, 260h, 3, 4292E0h, 0Ch, 3Fh
		dd 5 dup(0)
		dd 1, 3	dup(0)
		dd 2, 3	dup(0)
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 3	dup(0)
		dd 7, 3	dup(0)
		dd 8, 0
		dd 1, 0
		dd 9, 0
		dd 1, 0
		dd 0Ah,	0
		dd 1, 0
		dd 0Bh,	3 dup(0)
		dd 0Ch,	0
		dd 1, 0
		dd 0Dh,	3 dup(0)
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	3 dup(0)
		dd 0C9h, 1, 5, 0
		dd 0CAh, 1, 3Ch, 0
		dd 0CBh, 1, 11h, 0
		dd 0CCh, 1, 11h, 0
		dd 0CDh, 1, 400h, 0
		dd 0CEh, 1, 2 dup(0)
		dd 0CFh, 1, 2 dup(0)
		dd 0D2h, 1, 11h, 0
		dd 0D3h, 1, 11h, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 20h,	0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_6	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__6	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 4298F0h, 5A8h, 260h, 3, 429E98h, 0Ch, 3Fh
		dd 0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_7	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__7	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 42A2A0h, 5A8h, 260h, 3, 42A848h, 0Ch, 3Fh
		dd 0
		dd 2D4h, 1, 40h	dup(0)
aCertserver_p_8	db 'certserver.pgp.com',0
		align 4
		dd 5Ch dup(0)
		dd 0FFFFFFFFh, 3, 10h dup(0)
		dd 2D4h, 2, 40h	dup(0)
aPgpkeys_mit__8	db 'pgpkeys.mit.edu',0
		dd 3Ch dup(0)
		dd 2C6Bh, 20h dup(0)
		dd 0FFFFFFFFh, 1, 10h dup(0)
		dd 3, 2, 1, 5 dup(0)
		dd 1, 0
		dd 1, 0
		dd 2, 0
		dd 1, 0
		dd 3, 3	dup(0)
		dd 4, 3	dup(0)
		dd 5, 3	dup(0)
		dd 6, 0
		dd 1, 0
		dd 7, 0
		dd 1, 0
		dd 8, 3	dup(0)
		dd 9, 3	dup(0)
		dd 0Ah,	3 dup(0)
		dd 0Bh,	3 dup(0)
		dd 0Ch,	3 dup(0)
		dd 0Dh,	0
		dd 1, 0
		dd 0Eh,	3 dup(0)
		dd 0Fh,	3 dup(0)
		dd 10h,	3 dup(0)
		dd 11h,	3 dup(0)
		dd 16h,	3 dup(0)
		dd 12h,	0
		dd 1, 0
		dd 13h,	0
		dd 1, 0
		dd 14h,	3 dup(0)
		dd 15h,	0
		dd 1, 0
		dd 17h,	0
		dd 1, 0
		dd 18h,	0
		dd 1, 0
		dd 19h,	0
		dd 1, 0
		dd 1Ah,	3 dup(0)
		dd 1Bh,	3 dup(0)
		dd 1Ch,	3 dup(0)
		dd 1Dh,	3 dup(0)
		dd 1Eh,	3 dup(0)
		dd 1Fh,	3 dup(0)
		dd 0C9h, 1, 46h, 0
		dd 0CAh, 1, 78h, 0
		dd 0CBh, 1, 78h, 0
		dd 0CCh, 1, 2 dup(0)
		dd 0CDh, 1, 3, 0
		dd 0CEh, 1, 0E0000000h,	0
		dd 0CFh, 1, 3, 0
		dd 0D0h, 1, 2 dup(0)
		dd 0D1h, 1, 8, 0
		dd 0D2h, 1, 3, 0
		dd 0D4h, 1, 2 dup(0)
		dd 0D5h, 1, 2 dup(0)
		dd 0D6h, 1, 2 dup(0)
		dd 0D7h, 1, 11h, 0
		dd 0D8h, 1, 0FFFFFFFFh,	0
		dd 0D9h, 1, 0FFFFFFFFh,	0
		dd 0DAh, 1, 2 dup(0)
		dd 0DBh, 1, 2 dup(0)
		dd 0DCh, 1, 2 dup(0)
		dd 0DDh, 1, 0Fh, 0
		dd 0D3h, 1, 2, 0
		dd 190h, 2, 430394h, 0
		dd 191h, 2, 430394h, 0
		dd 192h, 2, 430394h, 0
		dd 193h, 2, 430394h, 0
		dd 195h, 2, 430394h, 0
		dd 196h, 2, 430394h, 0
		dd 197h, 2, 430394h, 0
		dd 198h, 2, 430394h, 0
		dd 25Ch, 3, 42AC50h, 5A8h, 260h, 3, 42B1F8h, 0Ch, 3Fh
		dd 0
dword_42B600	dd 122h, 0		; DATA XREF: sub_401680+1Fo
		dd 0C0h, 46000000h
dword_42B610	dd 2 dup(0)		; DATA XREF: sub_401680+Bo
		dd 0C0h, 46000000h
dbl_42B620	dq 2.0			; DATA XREF: sub_4199C0+72Cr
dbl_42B628	dq 1.0			; DATA XREF: sub_4199C0+71Er
					; __ms_p5_test_fdiv+2Ar
		dd offset sub_41B5D0
		dd offset sub_41B600
		dd offset sub_41B640
		dd offset sub_41B640
		dd offset sub_41B620
		dd offset sub_41B600
		dd offset sub_41B640
		dd offset sub_41B650
off_42B650	dd offset sub_41B740	; DATA XREF: sub_41BCD0:loc_41B730o
		dd offset sub_41B7C0
		dd offset sub_41B820
		dd offset sub_41B8E0
		dd offset sub_41B650
		dd offset sub_41BB60
		dd offset sub_41BBF0
		dd offset sub_41BC20
		dd offset sub_41BC40
		dd offset sub_41B9B0
		dd offset sub_41B9D0
		dd offset sub_41BA70
; char byte_42B680
byte_42B680	db 5Ch			; DATA XREF: sub_41B8A0r sub_41B8A0+Do ...
		db 2Fh,	2 dup(0)
		align 8
stru_42B688	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_41BFD8, offset loc_41BFEC>
					; DATA XREF: _threadstartex(x)+5o
					; SEH scope table for function 41BF5B
		align 8
stru_42B698	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_41C61A, offset loc_41C62E>
					; DATA XREF: start+5o
					; SEH scope table for function 41C531
		align 8
dbl_42B6A8	dq 4195835.0		; DATA XREF: __ms_p5_test_fdiv+Fr
dbl_42B6B0	dq 3145727.0		; DATA XREF: __ms_p5_test_fdiv+6r
; CHAR ProcName[]
ProcName	db 'IsProcessorFeaturePresent',0 ; DATA XREF: __ms_p5_mp_test_fdiv+Fo
		align 4
; CHAR ModuleName[]
ModuleName	db 'KERNEL32',0         ; DATA XREF: __ms_p5_mp_test_fdivo
		align 10h
dbl_42B6E0	dq 0.0			; DATA XREF: .text:0041E717r
; char aE000[]
aE000		db 'e+000',0            ; DATA XREF: __cftoe2+57o
		align 10h
aSunmontuewedth	db 'SunMonTueWedThuFriSat',0
		align 4
aJanfebmaraprma	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
		align 10h
; char aTz[3]
aTz		db 'TZ',0               ; DATA XREF: __tzset_lk+2Ao
		align 4
aRuntimeError	db 'runtime error ',0
		align 4
		db 0Dh,0Ah,0
		align 4
aTlossError	db 'TLOSS error',0Dh,0Ah,0
		align 4
aSingError	db 'SING error',0Dh,0Ah,0
		align 4
aDomainError	db 'DOMAIN error',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah
		db '- unable to initialize heap',0Dh,0Ah,0
		align 10h
aR6027NotEnough	db 'R6027',0Dh,0Ah
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 10h
aR6025PureVirtu	db 'R6025',0Dh,0Ah
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 10h
aR6019UnableToO	db 'R6019',0Dh,0Ah
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah
		db '- unexpected heap error',0Dh,0Ah,0
		align 10h
aR6017Unexpecte	db 'R6017',0Dh,0Ah
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 10h
aR6016NotEnough	db 'R6016',0Dh,0Ah
		db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra	db 0Dh,0Ah
		db 'abnormal program termination',0Dh,0Ah,0
		align 10h
aR6009NotEnough	db 'R6009',0Dh,0Ah
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:off_42FA6Co
		db '- floating point not loaded',0Dh,0Ah,0
		align 10h
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: __NMSG_WRITE+119o
		align 4
; char asc_42B9E8[]
asc_42B9E8	db 0Ah			; DATA XREF: __NMSG_WRITE+F1o
		db 0Ah,0
		align 4
; char aRuntimeErrorPr[]
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: __NMSG_WRITE+D3o
		db 0Ah
		db 'Program: ',0
		align 4
; char aProgramNameUnk[]
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: __NMSG_WRITE+7Do
		align 10h
; CHAR byte_42BA20[4]
byte_42BA20	db 4 dup(0)		; DATA XREF: ___crtLCMapStringA+57o
					; ___crtGetStringTypeA+52o ...
; const	WCHAR String2
String2		dw 0			; DATA XREF: ___crtLCMapStringA+36o
					; ___crtGetStringTypeA+39o ...
		align 4
stru_42BA28	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_41FF0D, offset loc_41FF11>
					; DATA XREF: ___crtLCMapStringA+5o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_41FFC1, offset loc_41FFC5> ; SEH scope table for function 41FDFD
stru_42BA40	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_42011A, offset loc_42011E>
					; DATA XREF: ___crtGetStringTypeA+5o
					; SEH scope table for function 420021
		dd 6000006h, 100h, 6030010h, 10020600h,	45454504h, 5050505h
		dd 303505h, 50h, 38282000h, 8075850h, 30303700h, 75057h
		dd 8202000h, 0
		db 8,'`h````',0
		dd 78707000h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
		dd 8, 6E0028h, 6C0075h,	29006Ch, 0
aNull		db '(null)',0
		align 10h
; CHAR aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: ___crtMessageBoxA+3Do
		align 4
; CHAR aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+35o
; CHAR aMessageboxa[]
aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+24o
; CHAR LibFileName[]
LibFileName	db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+Do
		align 4
; char a1Qnan[]
a1Qnan		db '1#QNAN',0           ; DATA XREF: _$I10_OUTPUT:loc_4226DCo
		align 4
; char a1Inf[]
a1Inf		db '1#INF',0            ; DATA XREF: _$I10_OUTPUT+D8o
		align 4
a1Ind		db '1#IND',0            ; DATA XREF: _$I10_OUTPUT+C7o
		align 4
a1Snan		db '1#SNAN',0           ; DATA XREF: _$I10_OUTPUT+ADo
		align 4
aHMmSs		db 'H:mm:ss',0          ; DATA XREF: .data:00430080o
aDdddMmmmDdYyyy	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:0043007Co
aMDYy		db 'M/d/yy',0           ; DATA XREF: .data:00430078o
		align 10h
aPm		db 'PM',0               ; DATA XREF: .data:00430074o
		align 4
aAm		db 'AM',0               ; DATA XREF: .data:00430070o
		align 4
aDecember	db 'December',0         ; DATA XREF: .data:0043006Co
		align 4
aNovember	db 'November',0         ; DATA XREF: .data:00430068o
		align 10h
aOctober	db 'October',0          ; DATA XREF: .data:00430064o
aSeptember	db 'September',0        ; DATA XREF: .data:00430060o
		align 4
aAugust		db 'August',0           ; DATA XREF: .data:0043005Co
		align 4
aJuly		db 'July',0             ; DATA XREF: .data:00430058o
		align 4
aJune		db 'June',0             ; DATA XREF: .data:00430054o
		align 4
aApril		db 'April',0            ; DATA XREF: .data:0043004Co
		align 4
aMarch		db 'March',0            ; DATA XREF: .data:00430048o
		align 4
aFebruary	db 'February',0         ; DATA XREF: .data:00430044o
		align 4
aJanuary	db 'January',0          ; DATA XREF: .data:00430040o
aDec		db 'Dec',0              ; DATA XREF: .data:0043003Co
aNov		db 'Nov',0              ; DATA XREF: .data:00430038o
aOct		db 'Oct',0              ; DATA XREF: .data:00430034o
aSep		db 'Sep',0              ; DATA XREF: .data:00430030o
aAug		db 'Aug',0              ; DATA XREF: .data:0043002Co
aJul		db 'Jul',0              ; DATA XREF: .data:00430028o
aJun		db 'Jun',0              ; DATA XREF: .data:00430024o
aMay		db 'May',0              ; DATA XREF: .data:00430020o
					; .data:00430050o
aApr		db 'Apr',0              ; DATA XREF: .data:0043001Co
aMar		db 'Mar',0              ; DATA XREF: .data:00430018o
aFeb		db 'Feb',0              ; DATA XREF: .data:00430014o
aJan		db 'Jan',0              ; DATA XREF: .data:00430010o
aSaturday	db 'Saturday',0         ; DATA XREF: .data:0043000Co
		align 4
aFriday		db 'Friday',0           ; DATA XREF: .data:00430008o
		align 4
aThursday	db 'Thursday',0         ; DATA XREF: .data:00430004o
		align 10h
aWednesday	db 'Wednesday',0        ; DATA XREF: .data:00430000o
		align 4
aTuesday	db 'Tuesday',0          ; DATA XREF: .data:0042FFFCo
aMonday		db 'Monday',0           ; DATA XREF: .data:0042FFF8o
		align 4
aSunday		db 'Sunday',0           ; DATA XREF: .data:0042FFF4o
		align 4
aSat		db 'Sat',0              ; DATA XREF: .data:0042FFF0o
aFri		db 'Fri',0              ; DATA XREF: .data:0042FFECo
aThu		db 'Thu',0              ; DATA XREF: .data:0042FFE8o
aWed		db 'Wed',0              ; DATA XREF: .data:0042FFE4o
aTue		db 'Tue',0              ; DATA XREF: .data:0042FFE0o
aMon		db 'Mon',0              ; DATA XREF: .data:0042FFDCo
aSun		db 'Sun',0              ; DATA XREF: .data:off_42FFD8o
stru_42BC40	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_422F54, offset loc_422F58>
					; DATA XREF: ___crtCompareStringA+5o
		_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_422FC3, offset loc_422FC7> ; SEH scope table for function 422D9D
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_42BE24 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva SetEnvironmentVariableA ; Import	Address	Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_42C25C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva DrawEdge		; Import Address Table
__IMPORT_DESCRIPTOR_GDI32 dd rva off_42BDA8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aGdi32_dll	; DLL Name
		dd rva TextOutA		; Import Address Table
__IMPORT_DESCRIPTOR_comdlg32 dd	rva off_42C3F0 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aComdlg32_dll	; DLL Name
		dd rva __imp_GetSaveFileNameA ;	Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_42BD5C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegOpenKeyExA	; Import Address Table
__IMPORT_DESCRIPTOR_SHELL32 dd rva off_42C254 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aShell32_dll	; DLL Name
		dd rva DragQueryFileA	; Import Address Table
__IMPORT_DESCRIPTOR_ole32 dd rva off_42C3FC ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aOle32_dll	; DLL Name
		dd rva RevokeDragDrop	; Import Address Table
__IMPORT_DESCRIPTOR_COMCTL32 dd	rva off_42BD74 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aComctl32_dll	; DLL Name
		dd rva ImageList_DragMove ; Import Address Table
__IMPORT_DESCRIPTOR_PGP_SDK dd rva off_42BF74 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aPgp_sdk_dll	; DLL Name
		dd rva __imp_PGPGetPrimaryUserID ; Import Address Table
__IMPORT_DESCRIPTOR_PGPcl dd rva off_42C128 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aPgpcl_dll	; DLL Name
		dd rva PGPclSystemTimeToDays ; Import Address Table
__IMPORT_DESCRIPTOR_PGPsdkUI dd	rva off_42C24C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aPgpsdkui_dll	; DLL Name
		dd rva __imp_PGPEstimatePassphraseQuality ; Import Address Table
__IMPORT_DESCRIPTOR_PGPsdkNL dd	rva off_42C204 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aPgpsdknl_dll	; DLL Name
		dd rva __imp_PGPSetKeyServerEventHandler ; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_42BD5C	dd rva word_42CDBA	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_42CDA6
		dd rva word_42CD94
		dd rva word_42CD82
		dd rva word_42CD74
		dd 0
;
; Import names for COMCTL32.dll
;
off_42BD74	dd rva word_42CE74	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_COMCTL32o
		dd rva word_42CEB6
		dd rva word_42CECA
		dd rva word_42CE8A
		dd rva word_42CF1E
		dd rva word_42CEF6
		dd rva word_42CF0A
		dd 80000011h
		dd rva word_42CEE0
		dd 80000006h
		dd rva word_42CF30
		dd rva word_42CEA0
		dd 0
;
; Import names for GDI32.dll
;
off_42BDA8	dd rva word_42CD1C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_GDI32o
		dd rva word_42CD0C
		dd rva word_42CCFA
		dd rva word_42CCEC
		dd rva word_42CCDC
		dd rva word_42CCD0
		dd rva word_42CCC6
		dd rva word_42CCBA
		dd rva word_42CCAA
		dd rva word_42CC96
		dd rva word_42CC8A
		dd rva word_42CC7A
		dd rva word_42CC68
		dd rva word_42CC58
		dd rva word_42E3B6
		dd rva word_42E39C
		dd rva word_42CC48
		dd rva word_42E440
		dd rva word_42E42E
		dd rva word_42E41E
		dd rva word_42E414
		dd rva word_42E404
		dd rva word_42E3F8
		dd rva word_42E3E0
		dd rva word_42E3CA
		dd rva word_42CD28
		dd rva word_42E352
		dd rva word_42E386
		dd rva word_42E370
		dd rva word_42E35E
		dd 0
;
; Import names for KERNEL32.dll
;
off_42BE24	dd rva word_42E2EE	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_42E2DC
		dd rva word_42E2CA
		dd rva word_42E2BA
		dd rva word_42E2AE
		dd rva word_42E2A4
		dd rva word_42E298
		dd rva word_42E284
		dd rva word_42E278
		dd rva word_42E266
		dd rva word_42E256
		dd rva word_42E244
		dd rva word_42E232
		dd rva word_42E222
		dd rva word_42E212
		dd rva word_42E1FC
		dd rva word_42E1F0
		dd rva word_42C54A
		dd rva word_42E1B4
		dd rva word_42E19C
		dd rva word_42E14E
		dd rva word_42E138
		dd rva word_42E126
		dd rva word_42E11A
		dd rva word_42E0FE
		dd rva word_42E0EA
		dd rva word_42E0D6
		dd rva word_42E0C8
		dd rva word_42E0B8
		dd rva word_42E0AC
		dd rva word_42E09C
		dd rva word_42E08E
		dd rva word_42E080
		dd rva word_42E072
		dd rva word_42E066
		dd rva word_42E058
		dd rva word_42E04A
		dd rva word_42E03C
		dd rva word_42E02C
		dd rva word_42E014
		dd rva word_42DFFC
		dd rva word_42DFEE
		dd rva word_42DFE0
		dd rva word_42DFCE
		dd rva word_42DFC0
		dd rva word_42DFB2
		dd rva word_42DFA4
		dd rva word_42DF98
		dd rva word_42DF8C
		dd rva word_42DF80
		dd rva word_42C418
		dd rva word_42C52A
		dd rva word_42C51A
		dd rva word_42C50A
		dd rva word_42C4FA
		dd rva word_42C4E4
		dd rva word_42C4D0
		dd rva word_42C4C0
		dd rva word_42C604
		dd rva word_42C5EC
		dd rva word_42C5D4
		dd rva word_42C5BC
		dd rva word_42C5AC
		dd rva word_42C590
		dd rva word_42C584
		dd rva word_42C57C
		dd rva word_42C566
		dd rva word_42C558
		dd rva word_42C53A
		dd rva word_42E168
		dd rva word_42C490
		dd rva word_42C4B2
		dd rva word_42C4A0
		dd rva word_42E1E0
		dd rva word_42C484
		dd rva word_42C476
		dd rva word_42C46A
		dd rva word_42C45A
		dd rva word_42C44E
		dd rva word_42C438
		dd rva word_42C42C
		dd rva word_42E182
		dd rva word_42E1CE
		dd 0
;
; Import names for PGP_SDK.dll
;
off_42BF74	dd rva word_42D38A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_PGP_SDKo
		dd rva word_42D210
		dd rva word_42E46E
		dd rva word_42E458
		dd rva word_42E44A
		dd rva word_42D848
		dd rva word_42D836
		dd rva word_42D81E
		dd rva word_42D80A
		dd rva word_42D7E8
		dd rva word_42D7CC
		dd rva word_42D7AE
		dd rva word_42D798
		dd rva word_42D778
		dd rva word_42D75E
		dd rva word_42D744
		dd rva word_42D724
		dd rva word_42D70C
		dd rva word_42D6EE
		dd rva word_42CF50
		dd rva word_42CF6A
		dd rva word_42CF7C
		dd rva word_42CF8E
		dd rva word_42CFA0
		dd rva word_42CFB4
		dd rva word_42CFCA
		dd rva word_42CFDA
		dd rva word_42CFEA
		dd rva word_42D000
		dd rva word_42D016
		dd rva word_42D028
		dd rva word_42D03C
		dd rva word_42D056
		dd rva word_42D070
		dd rva word_42D082
		dd rva word_42D090
		dd rva word_42D0A2
		dd rva word_42D0BE
		dd rva word_42D0D2
		dd rva word_42D0E4
		dd rva word_42D0F6
		dd rva word_42D10C
		dd rva word_42D11E
		dd rva word_42D130
		dd rva word_42D140
		dd rva word_42D152
		dd rva word_42D164
		dd rva word_42D176
		dd rva word_42D188
		dd rva word_42D19A
		dd rva word_42D1B4
		dd rva word_42D1D2
		dd rva word_42D1E6
		dd rva word_42D1FC
		dd rva word_42D6BA
		dd rva word_42D230
		dd rva word_42D248
		dd rva word_42D266
		dd rva word_42D282
		dd rva word_42D296
		dd rva word_42D2B4
		dd rva word_42D2C4
		dd rva word_42D2E4
		dd rva word_42D306
		dd rva word_42D318
		dd rva word_42D332
		dd rva word_42D342
		dd rva word_42D35A
		dd rva word_42D368
		dd rva word_42D378
		dd rva word_42D6D4
		dd rva word_42D3A0
		dd rva word_42D3B4
		dd rva word_42D3C8
		dd rva word_42D3DA
		dd rva word_42D3EC
		dd rva word_42D3FC
		dd rva word_42D410
		dd rva word_42D426
		dd rva word_42D438
		dd rva word_42D450
		dd rva word_42D466
		dd rva word_42D48E
		dd rva word_42D4A4
		dd rva word_42D4B4
		dd rva word_42D4C8
		dd rva word_42D4DA
		dd rva word_42D4EC
		dd rva word_42D4FE
		dd rva word_42D518
		dd rva word_42D52C
		dd rva word_42D546
		dd rva word_42D556
		dd rva word_42D568
		dd rva word_42D584
		dd rva word_42D5A4
		dd rva word_42D5C2
		dd rva word_42D5DC
		dd rva word_42D5EA
		dd rva word_42D5FA
		dd rva word_42D60C
		dd rva word_42D620
		dd rva word_42D638
		dd rva word_42D650
		dd rva word_42D664
		dd rva word_42D67E
		dd rva word_42D696
		dd rva word_42D6A6
		dd 0
;
; Import names for PGPcl.dll
;
off_42C128	dd rva word_42DA86	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_PGPclo
		dd rva word_42DAB6
		dd rva word_42DAD0
		dd rva word_42D9C8
		dd rva word_42DD76
		dd rva word_42DD60
		dd rva word_42DD4E
		dd rva word_42DD34
		dd rva word_42DA0A
		dd rva word_42DA2A
		dd rva word_42DCBC
		dd rva word_42DD1C
		dd rva word_42DD0A
		dd rva word_42DCD0
		dd rva word_42DA56
		dd rva word_42DC6E
		dd rva word_42D866
		dd rva word_42D87E
		dd rva word_42D896
		dd rva word_42D8AA
		dd rva word_42D8BA
		dd rva word_42D8D8
		dd rva word_42D8F8
		dd rva word_42D916
		dd rva word_42D92C
		dd rva word_42D942
		dd rva word_42D954
		dd rva word_42D96A
		dd rva word_42D980
		dd rva word_42D992
		dd rva word_42D9A6
		dd rva word_42D9BA
		dd rva word_42DCF0
		dd rva word_42D9DA
		dd rva word_42D9F2
		dd rva word_42DC98
		dd rva word_42DC5C
		dd rva word_42DC80
		dd rva word_42DA78
		dd rva word_42DB56
		dd rva word_42DA9E
		dd rva word_42DB6A
		dd rva word_42DC22
		dd rva word_42DAEA
		dd rva word_42DB04
		dd rva word_42DB1C
		dd rva word_42DB32
		dd rva word_42DB44
		dd rva word_42DC04
		dd rva word_42DC46
		dd rva word_42DB88
		dd rva word_42DBA6
		dd rva word_42DBBA
		dd rva word_42DBE6
		dd 0
;
; Import names for PGPsdkNL.dll
;
off_42C204	dd rva word_42DEBC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_PGPsdkNLo
		dd rva word_42DE94
		dd rva word_42DE80
		dd rva word_42DF1A
		dd rva word_42DEDA
		dd rva word_42DEF8
		dd rva word_42DF2E
		dd rva word_42DF50
		dd rva word_42DEA8
		dd rva word_42DE20
		dd rva word_42DE6C
		dd rva word_42DE58
		dd rva word_42DE44
		dd rva word_42DDC8
		dd rva word_42DE0A
		dd rva word_42DDF0
		dd rva word_42DDDC
		dd 0
;
; Import names for PGPsdkUI.dll
;
off_42C24C	dd rva word_42DD9A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_PGPsdkUIo
		dd 0
;
; Import names for SHELL32.dll
;
off_42C254	dd rva word_42CDD8	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_SHELL32o
		dd 0
;
; Import names for USER32.dll
;
off_42C25C	dd rva word_42CC24	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_42CC30
		dd rva word_42CC0C
		dd rva word_42CBFA
		dd rva word_42CBEA
		dd rva word_42CBD8
		dd rva word_42CB90
		dd rva word_42C8E6
		dd rva word_42C8D4
		dd rva word_42C630
		dd rva word_42C646
		dd rva word_42C624
		dd rva word_42C8FA
		dd rva word_42C674
		dd rva word_42CBB8
		dd rva word_42CBA6
		dd rva word_42CBCA
		dd rva word_42CB7E
		dd rva word_42CB70
		dd rva word_42CB5C
		dd rva word_42CB4A
		dd rva word_42CB3C
		dd rva word_42CB2C
		dd rva word_42CB1A
		dd rva word_42CB0C
		dd rva word_42CAFE
		dd rva word_42CAF0
		dd rva word_42CADC
		dd rva word_42CACC
		dd rva word_42CABC
		dd rva word_42CAAE
		dd rva word_42CA98
		dd rva word_42CA86
		dd rva word_42CA7A
		dd rva word_42CA6E
		dd rva word_42CA60
		dd rva word_42CA54
		dd rva word_42CA40
		dd rva word_42CA34
		dd rva word_42CA20
		dd rva word_42CA12
		dd rva word_42C9FA
		dd rva word_42C9E6
		dd rva word_42C9D2
		dd rva word_42C9BE
		dd rva word_42C9A8
		dd rva word_42C99C
		dd rva word_42C98C
		dd rva word_42C97A
		dd rva word_42C96E
		dd rva word_42C95C
		dd rva word_42C94E
		dd rva word_42C942
		dd rva word_42C92C
		dd rva word_42C924
		dd rva word_42C918
		dd rva word_42C90A
		dd rva word_42C792
		dd rva word_42C656
		dd rva word_42C774
		dd rva word_42C8BC
		dd rva word_42C8B2
		dd rva word_42C8A2
		dd rva word_42C890
		dd rva word_42C884
		dd rva word_42C86E
		dd rva word_42C85C
		dd rva word_42C84A
		dd rva word_42C83E
		dd rva word_42C832
		dd rva word_42C820
		dd rva word_42C80E
		dd rva word_42C800
		dd rva word_42C7F4
		dd rva word_42C7DA
		dd rva word_42C7CA
		dd rva word_42C7BA
		dd rva word_42C7AC
		dd rva word_42C79E
		dd rva word_42C720
		dd rva word_42C712
		dd rva word_42C762
		dd rva word_42E308
		dd rva word_42E312
		dd rva word_42E31E
		dd rva word_42E330
		dd rva word_42E342
		dd rva word_42C750
		dd rva word_42C73E
		dd rva word_42C72E
		dd rva word_42C6C4
		dd rva word_42C6D6
		dd rva word_42C706
		dd rva word_42C6F6
		dd rva word_42C6E4
		dd rva word_42C684
		dd rva word_42C662
		dd rva word_42C6B6
		dd rva word_42C6A8
		dd rva word_42C696
		dd 0
;
; Import names for comdlg32.dll
;
off_42C3F0	dd rva word_42CD52	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_comdlg32o
		dd rva word_42CD3E
		dd 0
;
; Import names for ole32.dll
;
off_42C3FC	dd rva word_42CE36	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ole32o
		dd rva word_42CE48
		dd rva word_42CDF6
		dd rva word_42CE1E
		dd rva word_42CE0A
		dd rva word_42CE5A
		dd 0
word_42C418	dw 13Ah			; DATA XREF: .rdata:0042BEECo
		db 'GetModuleHandleA',0
		align 4
word_42C42C	dw 32Ch			; DATA XREF: .rdata:0042BF64o
		db 'lstrcmpiA',0
word_42C438	dw 10Ah			; DATA XREF: .rdata:0042BF60o
		db 'GetCurrentProcessId',0
word_42C44E	dw 32Fh			; DATA XREF: .rdata:0042BF5Co
		db 'lstrcpyA',0
		align 2
word_42C45A	dw 1AEh			; DATA XREF: .rdata:0042BF58o
		db 'GlobalUnlock',0
		align 2
word_42C46A	dw 335h			; DATA XREF: .rdata:0042BF54o
		db 'lstrlenA',0
		align 2
word_42C476	dw 1A7h			; DATA XREF: .rdata:0042BF50o
		db 'GlobalLock',0
		align 4
word_42C484	dw 326h			; DATA XREF: .rdata:0042BF4Co
		db 'lstrcatA',0
		align 10h
word_42C490	dw 18Fh			; DATA XREF: .rdata:0042BF3Co
		db 'GetVersionExA',0
word_42C4A0	dw 0DAh			; DATA XREF: .rdata:0042BF44o
		db 'GetCommandLineA',0
word_42C4B2	dw 1Eh			; DATA XREF: .rdata:0042BF40o
		db 'CloseHandle',0
word_42C4C0	dw 12Dh			; DATA XREF: .rdata:0042BF08o
		db 'GetLastError',0
		align 10h
word_42C4D0	dw 4Ah			; DATA XREF: .rdata:0042BF04o
		db 'CreateSemaphoreA',0
		align 4
word_42C4E4	dw 10Ch			; DATA XREF: .rdata:0042BF00o
		db 'GetCurrentThreadId',0
		align 2
word_42C4FA	dw 12Fh			; DATA XREF: .rdata:0042BEFCo
		db 'GetLocalTime',0
		align 2
word_42C50A	dw 0C5h			; DATA XREF: .rdata:0042BEF8o
		db 'FreeResource',0
		align 2
word_42C51A	dw 1F2h			; DATA XREF: .rdata:0042BEF4o
		db 'LockResource',0
		align 2
word_42C52A	dw 1E4h			; DATA XREF: .rdata:0042BEF0o
		db 'LoadResource',0
		align 2
word_42C53A	dw 0B2h			; DATA XREF: .rdata:0042BF34o
		db 'FindResourceA',0
word_42C54A	dw 1A3h			; DATA XREF: .rdata:0042BE68o
		db 'GlobalFree',0
		align 4
word_42C558	dw 19Ch			; DATA XREF: .rdata:0042BF30o
		db 'GlobalAlloc',0
word_42C566	dw 138h			; DATA XREF: .rdata:0042BF2Co
		db 'GetModuleFileNameA',0
		align 4
word_42C57C	dw 2C3h			; DATA XREF: .rdata:0042BF28o
		db 'Sleep',0
word_42C584	dw 2Bh			; DATA XREF: .rdata:0042BF24o
		db 'CopyFileA',0
word_42C590	dw 1C5h			; DATA XREF: .rdata:0042BF20o
		db 'InitializeCriticalSection',0
word_42C5AC	dw 4Dh			; DATA XREF: .rdata:0042BF1Co
		db 'CreateThread',0
		align 4
word_42C5BC	dw 1DEh			; DATA XREF: .rdata:0042BF18o
		db 'LeaveCriticalSection',0
		align 4
word_42C5D4	dw 5Ah			; DATA XREF: .rdata:0042BF14o
		db 'DeleteCriticalSection',0
word_42C5EC	dw 6Fh			; DATA XREF: .rdata:0042BF10o
		db 'EnterCriticalSection',0
		align 4
word_42C604	dw 2CCh			; DATA XREF: .rdata:0042BF0Co
		db 'TerminateThread',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:0042BC64o
		align 4
word_42C624	dw 247h			; DATA XREF: .rdata:0042C288o
		db 'SetPropA',0
		align 10h
word_42C630	dw 50h			; DATA XREF: .rdata:0042C280o
		db 'CreateDialogParamA',0
		align 2
word_42C646	dw 0F3h			; DATA XREF: .rdata:0042C284o
		db 'GetClientRect',0
word_42C656	dw 13Dh			; DATA XREF: .rdata:0042C344o
		db 'GetPropA',0
		align 2
word_42C662	dw 16h			; DATA XREF: .rdata:0042C3DCo
		db 'CallWindowProcA',0
word_42C674	dw 218h			; DATA XREF: .rdata:0042C290o
		db 'SendMessageA',0
		align 4
word_42C684	dw 196h			; DATA XREF: .rdata:0042C3D8o
		db 'IsWindowVisible',0
word_42C696	dw 194h			; DATA XREF: .rdata:0042C3E8o
		db 'IsWindowEnabled',0
word_42C6A8	dw 105h			; DATA XREF: .rdata:0042C3E4o
		db 'GetDlgItem',0
		align 2
word_42C6B6	dw 209h			; DATA XREF: .rdata:0042C3E0o
		db 'RemovePropA',0
word_42C6C4	dw 25Dh			; DATA XREF: .rdata:0042C3C4o
		db 'SetWindowLongA',0
		align 2
word_42C6D6	dw 1CEh			; DATA XREF: .rdata:0042C3C8o
		db 'MoveWindow',0
		align 4
word_42C6E4	dw 15Ah			; DATA XREF: .rdata:0042C3D4o
		db 'GetWindowLongA',0
		align 2
word_42C6F6	dw 160h			; DATA XREF: .rdata:0042C3D0o
		db 'GetWindowRect',0
word_42C706	dw 138h			; DATA XREF: .rdata:0042C3CCo
		db 'GetParent',0
word_42C712	dw 26Fh			; DATA XREF: .rdata:0042C39Co
		db 'ShowWindow',0
		align 10h
word_42C720	dw 146h			; DATA XREF: .rdata:0042C398o
		db 'GetSysColor',0
word_42C72E	dw 260h			; DATA XREF: .rdata:0042C3C0o
		db 'SetWindowPos',0
		align 2
word_42C73E	dw 5Ah			; DATA XREF: .rdata:0042C3BCo
		db 'CreateWindowExA',0
word_42C750	dw 1BEh			; DATA XREF: .rdata:0042C3B8o
		db 'MapWindowPoints',0
word_42C762	dw 17Eh			; DATA XREF: .rdata:0042C3A0o
		db 'InvalidateRect',0
		align 4
word_42C774	dw 18Ah			; DATA XREF: .rdata:0042C348o
		db 'IsClipboardFormatAvailable',0
		align 2
word_42C792	dw 233h			; DATA XREF: .rdata:0042C340o
		db 'SetFocus',0
		align 2
word_42C79E	dw 1C3h			; DATA XREF: .rdata:0042C394o
		db 'MessageBoxA',0
word_42C7AC	dw 1AFh			; DATA XREF: .rdata:0042C390o
		db 'LoadStringA',0
word_42C7BA	dw 296h			; DATA XREF: .rdata:0042C38Co
		db 'UpdateWindow',0
		align 2
word_42C7CA	dw 1E3h			; DATA XREF: .rdata:0042C388o
		db 'PostMessageA',0
		align 2
word_42C7DA	dw 204h			; DATA XREF: .rdata:0042C384o
		db 'RegisterWindowMessageA',0
		align 4
word_42C7F4	dw 22Ah			; DATA XREF: .rdata:0042C380o
		db 'SetCursor',0
word_42C800	dw 19Eh			; DATA XREF: .rdata:0042C37Co
		db 'LoadCursorA',0
word_42C80E	dw 95h			; DATA XREF: .rdata:0042C378o
		db 'DialogBoxParamA',0
word_42C820	dw 107h			; DATA XREF: .rdata:0042C374o
		db 'GetDlgItemTextA',0
word_42C832	dw 0BBh			; DATA XREF: .rdata:0042C370o
		db 'EndDialog',0
word_42C83E	dw 2ADh			; DATA XREF: .rdata:0042C36Co
		db 'WinHelpA',0
		align 2
word_42C84A	dw 230h			; DATA XREF: .rdata:0042C368o
		db 'SetDlgItemTextA',0
word_42C85C	dw 263h			; DATA XREF: .rdata:0042C364o
		db 'SetWindowTextA',0
		align 2
word_42C86E	dw 213h			; DATA XREF: .rdata:0042C360o
		db 'SendDlgItemMessageA',0
word_42C884	dw 2B3h			; DATA XREF: .rdata:0042C35Co
		db 'wsprintfA',0
word_42C890	dw 20Eh			; DATA XREF: .rdata:0042C358o
		db 'ScreenToClient',0
		align 2
word_42C8A2	dw 0FFh			; DATA XREF: .rdata:0042C354o
		db 'GetCursorPos',0
		align 2
word_42C8B2	dw 11Fh			; DATA XREF: .rdata:0042C350o
		db 'GetMenu',0
word_42C8BC	dw 276h			; DATA XREF: .rdata:0042C34Co
		db 'SystemParametersInfoA',0
word_42C8D4	dw 3Dh			; DATA XREF: .rdata:0042C27Co
		db 'CloseClipboard',0
		align 2
word_42C8E6	dw 0F5h			; DATA XREF: .rdata:0042C278o
		db 'GetClipboardData',0
		align 2
word_42C8FA	dw 1D8h			; DATA XREF: .rdata:0042C28Co
		db 'OpenClipboard',0
word_42C90A	dw 19Ch			; DATA XREF: .rdata:0042C33Co
		db 'LoadBitmapA',0
word_42C918	dw 207h			; DATA XREF: .rdata:0042C338o
		db 'ReleaseDC',0
word_42C924	dw 100h			; DATA XREF: .rdata:0042C334o
		db 'GetDC',0
word_42C92C	dw 234h			; DATA XREF: .rdata:0042C330o
		db 'SetForegroundWindow',0
word_42C942	dw 197h			; DATA XREF: .rdata:0042C32Co
		db 'IsZoomed',0
		align 2
word_42C94E	dw 0D7h			; DATA XREF: .rdata:0042C328o
		db 'FindWindowA',0
word_42C95C	dw 1F6h			; DATA XREF: .rdata:0042C324o
		db 'RegisterClassA',0
		align 2
word_42C96E	dw 1A2h			; DATA XREF: .rdata:0042C320o
		db 'LoadIconA',0
word_42C97A	dw 15h			; DATA XREF: .rdata:0042C31Co
		db 'CallNextHookEx',0
		align 4
word_42C98C	dw 0B9h			; DATA XREF: .rdata:0042C318o
		db 'EnableWindow',0
		align 4
word_42C99C	dw 1EEh			; DATA XREF: .rdata:0042C314o
		db 'PtInRect',0
		align 4
word_42C9A8	dw 28Bh			; DATA XREF: .rdata:0042C310o
		db 'UnhookWindowsHookEx',0
word_42C9BE	dw 97h			; DATA XREF: .rdata:0042C30Co
		db 'DispatchMessageA',0
		align 2
word_42C9D2	dw 287h			; DATA XREF: .rdata:0042C308o
		db 'TranslateMessage',0
		align 2
word_42C9E6	dw 18Ch			; DATA XREF: .rdata:0042C304o
		db 'IsDialogMessageA',0
		align 2
word_42C9FA	dw 284h			; DATA XREF: .rdata:0042C300o
		db 'TranslateAcceleratorA',0
word_42CA12	dw 12Dh			; DATA XREF: .rdata:0042C2FCo
		db 'GetMessageA',0
word_42CA20	dw 19Ah			; DATA XREF: .rdata:0042C2F8o
		db 'LoadAcceleratorsA',0
word_42CA34	dw 1AAh			; DATA XREF: .rdata:0042C2F4o
		db 'LoadMenuA',0
word_42CA40	dw 267h			; DATA XREF: .rdata:0042C2F0o
		db 'SetWindowsHookExA',0
word_42CA54	dw 0BDh			; DATA XREF: .rdata:0042C2ECo
		db 'EndPaint',0
		align 10h
word_42CA60	dw 0Ch			; DATA XREF: .rdata:0042C2E8o
		db 'BeginPaint',0
		align 2
word_42CA6E	dw 199h			; DATA XREF: .rdata:0042C2E4o
		db 'KillTimer',0
word_42CA7A	dw 257h			; DATA XREF: .rdata:0042C2E0o
		db 'SetTimer',0
		align 2
word_42CA86	dw 33h			; DATA XREF: .rdata:0042C2DCo
		db 'CheckDlgButton',0
		align 4
word_42CA98	dw 18Eh			; DATA XREF: .rdata:0042C2D8o
		db 'IsDlgButtonChecked',0
		align 2
word_42CAAE	dw 115h			; DATA XREF: .rdata:0042C2D4o
		db 'GetKeyState',0
word_42CABC	dw 22Fh			; DATA XREF: .rdata:0042C2D0o
		db 'SetDlgItemInt',0
word_42CACC	dw 106h			; DATA XREF: .rdata:0042C2CCo
		db 'GetDlgItemInt',0
word_42CADC	dw 149h			; DATA XREF: .rdata:0042C2C8o
		db 'GetSystemMetrics',0
		align 10h
word_42CAF0	dw 89h			; DATA XREF: .rdata:0042C2C4o
		db 'DeleteMenu',0
		align 2
word_42CAFE	dw 145h			; DATA XREF: .rdata:0042C2C0o
		db 'GetSubMenu',0
		align 4
word_42CB0C	dw 178h			; DATA XREF: .rdata:0042C2BCo
		db 'InsertMenuA',0
word_42CB1A	dw 0B7h			; DATA XREF: .rdata:0042C2B8o
		db 'EnableMenuItem',0
		align 4
word_42CB2C	dw 34h			; DATA XREF: .rdata:0042C2B4o
		db 'CheckMenuItem',0
word_42CB3C	dw 7			; DATA XREF: .rdata:0042C2B0o
		db 'AppendMenuA',0
word_42CB4A	dw 59h			; DATA XREF: .rdata:0042C2ACo
		db 'CreatePopupMenu',0
word_42CB5C	dw 23Fh			; DATA XREF: .rdata:0042C2A8o
		db 'SetMenuItemInfoA',0
		align 10h
word_42CB70	dw 8Fh			; DATA XREF: .rdata:0042C2A4o
		db 'DestroyMenu',0
word_42CB7E	dw 281h			; DATA XREF: .rdata:0042C2A0o
		db 'TrackPopupMenu',0
		align 10h
word_42CB90	dw 15Fh			; DATA XREF: .rdata:0042C274o
		db 'GetWindowPlacement',0
		align 2
word_42CBA6	dw 86h			; DATA XREF: .rdata:0042C298o
		db 'DefWindowProcA',0
		align 4
word_42CBB8	dw 206h			; DATA XREF: .rdata:0042C294o
		db 'ReleaseCapture',0
		align 2
word_42CBCA	dw 221h			; DATA XREF: .rdata:0042C29Co
		db 'SetCapture',0
		align 4
word_42CBD8	dw 1E5h			; DATA XREF: .rdata:0042C270o
		db 'PostQuitMessage',0
word_42CBEA	dw 90h			; DATA XREF: .rdata:0042C26Co
		db 'DestroyWindow',0
word_42CBFA	dw 162h			; DATA XREF: .rdata:0042C268o
		db 'GetWindowTextA',0
		align 4
word_42CC0C	dw 163h			; DATA XREF: .rdata:0042C264o
		db 'GetWindowTextLengthA',0
		align 4
word_42CC24	dw 0A7h			; DATA XREF: .rdata:off_42C25Co
		db 'DrawEdge',0
		align 10h
word_42CC30	dw 0D6h			; DATA XREF: .rdata:0042C260o
		db 'FillRect',0
		align 4
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:0042BC78o
		align 4
word_42CC48	dw 54h			; DATA XREF: .rdata:0042BDE8o
		db 'DeleteObject',0
		align 4
word_42CC58	dw 12Dh			; DATA XREF: .rdata:0042BDDCo
		db 'GetDeviceCaps',0
word_42CC68	dw 1B3h			; DATA XREF: .rdata:0042BDD8o
		db 'RealizePalette',0
		align 2
word_42CC7A	dw 1CFh			; DATA XREF: .rdata:0042BDD4o
		db 'SelectPalette',0
word_42CC8A	dw 1B6h			; DATA XREF: .rdata:0042BDD0o
		db 'Rectangle',0
word_42CC96	dw 4Eh			; DATA XREF: .rdata:0042BDCCo
		db 'CreateSolidBrush',0
		align 2
word_42CCAA	dw 1CEh			; DATA XREF: .rdata:0042BDC8o
		db 'SelectObject',0
		align 2
word_42CCBA	dw 45h			; DATA XREF: .rdata:0042BDC4o
		db 'CreatePen',0
word_42CCC6	dw 18Dh			; DATA XREF: .rdata:0042BDC0o
		db 'LineTo',0
		align 10h
word_42CCD0	dw 191h			; DATA XREF: .rdata:0042BDBCo
		db 'MoveToEx',0
		align 4
word_42CCDC	dw 1FAh			; DATA XREF: .rdata:0042BDB8o
		db 'SetTextColor',0
		align 4
word_42CCEC	dw 1D4h			; DATA XREF: .rdata:0042BDB4o
		db 'SetBkColor',0
		align 2
word_42CCFA	dw 31h			; DATA XREF: .rdata:0042BDB0o
		db 'CreateDIBitmap',0
		align 4
word_42CD0C	dw 43h			; DATA XREF: .rdata:0042BDACo
		db 'CreatePalette',0
word_42CD1C	dw 20Ch			; DATA XREF: .rdata:off_42BDA8o
		db 'TextOutA',0
		align 4
word_42CD28	dw 1D5h			; DATA XREF: .rdata:0042BE0Co
		db 'SetBkMode',0
aGdi32_dll	db 'GDI32.dll',0        ; DATA XREF: .rdata:0042BC8Co
word_42CD3E	dw 9			; DATA XREF: .rdata:0042C3F4o
		db 'GetOpenFileNameA',0
		align 2
word_42CD52	dw 0Bh			; DATA XREF: .rdata:off_42C3F0o
		db 'GetSaveFileNameA',0
		align 2
aComdlg32_dll	db 'comdlg32.dll',0     ; DATA XREF: .rdata:0042BCA0o
		align 4
word_42CD74	dw 184h			; DATA XREF: .rdata:0042BD6Co
		db 'RegCloseKey',0
word_42CD82	dw 1B2h			; DATA XREF: .rdata:0042BD68o
		db 'RegSetValueExA',0
		align 4
word_42CD94	dw 188h			; DATA XREF: .rdata:0042BD64o
		db 'RegCreateKeyExA',0
word_42CDA6	dw 1A7h			; DATA XREF: .rdata:0042BD60o
		db 'RegQueryValueExA',0
		align 2
word_42CDBA	dw 19Dh			; DATA XREF: .rdata:off_42BD5Co
		db 'RegOpenKeyExA',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:0042BCB4o
		align 4
word_42CDD8	dw 15h			; DATA XREF: .rdata:off_42C254o
		db 'DragQueryFileA',0
		align 2
aShell32_dll	db 'SHELL32.dll',0      ; DATA XREF: .rdata:0042BCC8o
word_42CDF6	dw 0FDh			; DATA XREF: .rdata:0042C404o
		db 'ReleaseStgMedium',0
		align 2
word_42CE0A	dw 0FCh			; DATA XREF: .rdata:0042C40Co
		db 'RegisterDragDrop',0
		align 2
word_42CE1E	dw 39h			; DATA XREF: .rdata:0042C408o
		db 'CoLockObjectExternal',0
		align 2
word_42CE36	dw 0FEh			; DATA XREF: .rdata:off_42C3FCo
		db 'RevokeDragDrop',0
		align 4
word_42CE48	dw 0EEh			; DATA XREF: .rdata:0042C400o
		db 'OleUninitialize',0
word_42CE5A	dw 0D7h			; DATA XREF: .rdata:0042C410o
		db 'OleInitialize',0
aOle32_dll	db 'ole32.dll',0        ; DATA XREF: .rdata:0042BCDCo
word_42CE74	dw 26h			; DATA XREF: .rdata:off_42BD74o
		db 'ImageList_DragMove',0
		align 2
word_42CE8A	dw 24h			; DATA XREF: .rdata:0042BD80o
		db 'ImageList_DragEnter',0
word_42CEA0	dw 25h			; DATA XREF: .rdata:0042BDA0o
		db 'ImageList_DragLeave',0
word_42CEB6	dw 23h			; DATA XREF: .rdata:0042BD78o
		db 'ImageList_Destroy',0
word_42CECA	dw 20h			; DATA XREF: .rdata:0042BD7Co
		db 'ImageList_BeginDrag',0
word_42CEE0	dw 1Fh			; DATA XREF: .rdata:0042BD94o
		db 'ImageList_AddMasked',0
word_42CEF6	dw 22h			; DATA XREF: .rdata:0042BD88o
		db 'ImageList_Create',0
		align 2
word_42CF0A	dw 2Ch			; DATA XREF: .rdata:0042BD8Co
		db 'ImageList_EndDrag',0
word_42CF1E	dw 4Dh			; DATA XREF: .rdata:0042BD84o
		db 'PropertySheetA',0
		align 10h
word_42CF30	dw 28h			; DATA XREF: .rdata:0042BD9Co
		db 'ImageList_Draw',0
		align 2
aComctl32_dll	db 'COMCTL32.dll',0     ; DATA XREF: .rdata:0042BCF0o
		align 10h
word_42CF50	dw 73h			; DATA XREF: .rdata:0042BFC0o
		db 'PGPGetContextMemoryMgr',0
		align 2
word_42CF6A	dw 195h			; DATA XREF: .rdata:0042BFC4o
		db 'PGPSortGroupSet',0
word_42CF7C	dw 7Ah			; DATA XREF: .rdata:0042BFC8o
		db 'PGPGetGroupInfo',0
word_42CF8E	dw 38h			; DATA XREF: .rdata:0042BFCCo
		db 'PGPCompareKeys',0
		align 10h
word_42CFA0	dw 86h			; DATA XREF: .rdata:0042BFD0o
		db 'PGPGetKeyByKeyID',0
		align 4
word_42CFB4	dw 93h			; DATA XREF: .rdata:0042BFD4o
		db 'PGPGetKeySetContext',0
word_42CFCA	dw 6Ah			; DATA XREF: .rdata:0042BFD8o
		db 'PGPFreeKeySet',0
word_42CFDA	dw 49h			; DATA XREF: .rdata:0042BFDCo
		db 'PGPCountKeys',0
		align 2
word_42CFEA	dw 47h			; DATA XREF: .rdata:0042BFE0o
		db 'PGPCountGroupItems',0
		align 10h
word_42D000	dw 80h			; DATA XREF: .rdata:0042BFE4o
		db 'PGPGetIndGroupItem',0
		align 2
word_42D016	dw 65h			; DATA XREF: .rdata:0042BFE8o
		db 'PGPFreeGroupSet',0
word_42D028	dw 0EBh			; DATA XREF: .rdata:0042BFECo
		db 'PGPMergeGroupSets',0
word_42D03C	dw 0C5h			; DATA XREF: .rdata:0042BFF0o
		db 'PGPGroupSetNeedsCommit',0
		align 2
word_42D056	dw 187h			; DATA XREF: .rdata:0042BFF4o
		db 'PGPSetGroupDescription',0
		align 10h
word_42D070	dw 188h			; DATA XREF: .rdata:0042BFF8o
		db 'PGPSetGroupName',0
word_42D082	dw 0F7h			; DATA XREF: .rdata:0042BFFCo
		db 'PGPNewGroup',0
word_42D090	dw 4Fh			; DATA XREF: .rdata:0042C000o
		db 'PGPDeleteGroup',0
		align 2
word_42D0A2	dw 50h			; DATA XREF: .rdata:0042C004o
		db 'PGPDeleteIndItemFromGroup',0
word_42D0BE	dw 5			; DATA XREF: .rdata:0042C008o
		db 'PGPAddItemToGroup',0
word_42D0D2	dw 69h			; DATA XREF: .rdata:0042C00Co
		db 'PGPFreeKeyList',0
		align 4
word_42D0E4	dw 68h			; DATA XREF: .rdata:0042C010o
		db 'PGPFreeKeyIter',0
		align 2
word_42D0F6	dw 89h			; DATA XREF: .rdata:0042C014o
		db 'PGPGetKeyIDFromKey',0
		align 4
word_42D10C	dw 90h			; DATA XREF: .rdata:0042C018o
		db 'PGPGetKeyNumber',0
word_42D11E	dw 0D4h			; DATA XREF: .rdata:0042C01Co
		db 'PGPKeyIterNext',0
		align 10h
word_42D130	dw 105h			; DATA XREF: .rdata:0042C020o
		db 'PGPNewKeyIter',0
word_42D140	dw 16Ch			; DATA XREF: .rdata:0042C024o
		db 'PGPOrderKeySet',0
		align 2
word_42D152	dw 0C9h			; DATA XREF: .rdata:0042C028o
		db 'PGPImportKeySet',0
word_42D164	dw 146h			; DATA XREF: .rdata:0042C02Co
		db 'PGPOInputBuffer',0
word_42D176	dw 14Eh			; DATA XREF: .rdata:0042C030o
		db 'PGPOLastOption',0
		align 4
word_42D188	dw 62h			; DATA XREF: .rdata:0042C034o
		db 'PGPFreeFileSpec',0
word_42D19A	dw 0FAh			; DATA XREF: .rdata:0042C038o
		db 'PGPNewGroupSetFromFile',0
		align 4
word_42D1B4	dw 0F5h			; DATA XREF: .rdata:0042C03Co
		db 'PGPNewFileSpecFromFullPath',0
		align 2
word_42D1D2	dw 7Fh			; DATA XREF: .rdata:0042C040o
		db 'PGPGetIndGroupID',0
		align 2
word_42D1E6	dw 48h			; DATA XREF: .rdata:0042C044o
		db 'PGPCountGroupsInSet',0
word_42D1FC	dw 8Dh			; DATA XREF: .rdata:0042C048o
		db 'PGPGetKeyIDString',0
word_42D210	dw 9Ch			; DATA XREF: .rdata:0042BF78o
		db 'PGPGetPrimaryUserIDNameBuffer',0
word_42D230	dw 189h			; DATA XREF: .rdata:0042C050o
		db 'PGPSetGroupUserValue',0
		align 4
word_42D248	dw 18Ah			; DATA XREF: .rdata:0042C054o
		db 'PGPSetIndGroupItemUserValue',0
word_42D266	dw 7Bh			; DATA XREF: .rdata:0042C058o
		db 'PGPGetGroupLowestValidity',0
word_42D282	dw 85h			; DATA XREF: .rdata:0042C05Co
		db 'PGPGetKeyBoolean',0
		align 2
word_42D296	dw 9Dh			; DATA XREF: .rdata:0042C060o
		db 'PGPGetPrimaryUserIDValidity',0
word_42D2B4	dw 0F1h			; DATA XREF: .rdata:0042C064o
		db 'PGPNewContext',0
word_42D2C4	dw 0C3h			; DATA XREF: .rdata:0042C068o
		db 'PGPGlobalRandomPoolMouseMoved',0
word_42D2E4	dw 0BCh			; DATA XREF: .rdata:0042C06Co
		db 'PGPGlobalRandomPoolAddKeystroke',0
word_42D306	dw 60h			; DATA XREF: .rdata:0042C070o
		db 'PGPFreeContext',0
		align 4
word_42D318	dw 36h			; DATA XREF: .rdata:0042C074o
		db 'PGPCommitKeyRingChanges',0
word_42D332	dw 177h			; DATA XREF: .rdata:0042C078o
		db 'PGPRemoveKeys',0
word_42D342	dw 119h			; DATA XREF: .rdata:0042C07Co
		db 'PGPNewSingletonKeySet',0
word_42D35A	dw 61h			; DATA XREF: .rdata:0042C080o
		db 'PGPFreeData',0
word_42D368	dw 193h			; DATA XREF: .rdata:0042C084o
		db 'PGPSignUserID',0
word_42D378	dw 15Bh			; DATA XREF: .rdata:0042C088o
		db 'PGPOPassphrase',0
		align 2
word_42D38A	dw 9Bh			; DATA XREF: .rdata:off_42BF74o
		db 'PGPGetPrimaryUserID',0
word_42D3A0	dw 113h			; DATA XREF: .rdata:0042C090o
		db 'PGPNewSecureData',0
		align 4
word_42D3B4	dw 6Ch			; DATA XREF: .rdata:0042C094o
		db 'PGPFreeOptionList',0
word_42D3C8	dw 18Ch			; DATA XREF: .rdata:0042C098o
		db 'PGPSetKeyTrust',0
		align 2
word_42D3DA	dw 140h			; DATA XREF: .rdata:0042C09Co
		db 'PGPOExportable',0
		align 4
word_42D3EC	dw 164h			; DATA XREF: .rdata:0042C0A0o
		db 'PGPOSigTrust',0
		align 4
word_42D3FC	dw 71h			; DATA XREF: .rdata:0042C0A4o
		db 'PGPGenerateSubKey',0
word_42D410	dw 14Ah			; DATA XREF: .rdata:0042C0A8o
		db 'PGPOKeyGenMasterKey',0
word_42D426	dw 70h			; DATA XREF: .rdata:0042C0ACo
		db 'PGPGenerateKey',0
		align 4
word_42D438	dw 160h			; DATA XREF: .rdata:0042C0B0o
		db 'PGPORevocationKeySet',0
		align 10h
word_42D450	dw 0Ah			; DATA XREF: .rdata:0042C0B4o
		db 'PGPAppendOptionList',0
word_42D466	dw 126h			; DATA XREF: .rdata:0042C0B8o
		db 'PGPOAdditionalRecipientRequestKeySet',0
		align 2
word_42D48E	dw 27h			; DATA XREF: .rdata:0042C0BCo
		db 'PGPBuildOptionList',0
		align 4
word_42D4A4	dw 14Dh			; DATA XREF: .rdata:0042C0C0o
		db 'PGPOKeySetRef',0
word_42D4B4	dw 14Ch			; DATA XREF: .rdata:0042C0C4o
		db 'PGPOKeyGenParams',0
		align 4
word_42D4C8	dw 149h			; DATA XREF: .rdata:0042C0C8o
		db 'PGPOKeyGenFast',0
		align 2
word_42D4DA	dw 14Bh			; DATA XREF: .rdata:0042C0CCo
		db 'PGPOKeyGenName',0
		align 4
word_42D4EC	dw 138h			; DATA XREF: .rdata:0042C0D0o
		db 'PGPOExpiration',0
		align 2
word_42D4FE	dw 15Dh			; DATA XREF: .rdata:0042C0D4o
		db 'PGPOPreferredAlgorithms',0
word_42D518	dw 137h			; DATA XREF: .rdata:0042C0D8o
		db 'PGPOEventHandler',0
		align 4
word_42D52C	dw 76h			; DATA XREF: .rdata:0042C0DCo
		db 'PGPGetDefaultPrivateKey',0
word_42D546	dw 63h			; DATA XREF: .rdata:0042C0E0o
		db 'PGPFreeFilter',0
word_42D556	dw 5Ah			; DATA XREF: .rdata:0042C0E4o
		db 'PGPFilterKeySet',0
word_42D568	dw 125h			; DATA XREF: .rdata:0042C0E8o
		db 'PGPNewUserIDStringFilter',0
		align 4
word_42D584	dw 0BFh			; DATA XREF: .rdata:0042C0ECo
		db 'PGPGlobalRandomPoolGetEntropy',0
word_42D5A4	dw 0C1h			; DATA XREF: .rdata:0042C0F0o
		db 'PGPGlobalRandomPoolGetSize',0
		align 2
word_42D5C2	dw 88h			; DATA XREF: .rdata:0042C0F4o
		db 'PGPGetKeyEntropyNeeded',0
		align 4
word_42D5DC	dw 8			; DATA XREF: .rdata:0042C0F8o
		db 'PGPAddKeys',0
		align 2
word_42D5EA	dw 109h			; DATA XREF: .rdata:0042C0FCo
		db 'PGPNewKeySet',0
		align 2
word_42D5FA	dw 0A5h			; DATA XREF: .rdata:0042C100o
		db 'PGPGetSigNumber',0
word_42D60C	dw 0A2h			; DATA XREF: .rdata:0042C104o
		db 'PGPGetSigBoolean',0
		align 10h
word_42D620	dw 0D6h			; DATA XREF: .rdata:0042C108o
		db 'PGPKeyIterNextUIDSig',0
		align 4
word_42D638	dw 0D7h			; DATA XREF: .rdata:0042C10Co
		db 'PGPKeyIterNextUserID',0
		align 10h
word_42D650	dw 37h			; DATA XREF: .rdata:0042C110o
		db 'PGPCompareKeyIDs',0
		align 4
word_42D664	dw 8Ch			; DATA XREF: .rdata:0042C114o
		db 'PGPGetKeyIDOfCertifier',0
		align 2
word_42D67E	dw 115h			; DATA XREF: .rdata:0042C118o
		db 'PGPNewSigKeyIDFilter',0
		align 2
word_42D696	dw 147h			; DATA XREF: .rdata:0042C11Co
		db 'PGPOInputFile',0
word_42D6A6	dw 171h			; DATA XREF: .rdata:0042C120o
		db 'PGPPropagateTrust',0
word_42D6BA	dw 169h			; DATA XREF: .rdata:0042C04Co
		db 'PGPOpenDefaultKeyRings',0
		align 4
word_42D6D4	dw 1A3h			; DATA XREF: .rdata:0042C08Co
		db 'PGPsdkLoadDefaultPrefs',0
		align 2
word_42D6EE	dw 79h			; DATA XREF: .rdata:0042BFBCo
		db 'PGPGetFullPathFromFileSpec',0
		align 4
word_42D70C	dw 1A6h			; DATA XREF: .rdata:0042BFB8o
		db 'PGPsdkPrefGetFileSpec',0
word_42D724	dw 101h			; DATA XREF: .rdata:0042BFB4o
		db 'PGPNewKeyEncryptKeySizeFilter',0
word_42D744	dw 0FFh			; DATA XREF: .rdata:0042BFB0o
		db 'PGPNewKeyDisabledFilter',0
word_42D75E	dw 108h			; DATA XREF: .rdata:0042BFACo
		db 'PGPNewKeyRevokedFilter',0
		align 4
word_42D778	dw 102h			; DATA XREF: .rdata:0042BFA8o
		db 'PGPNewKeyExpirationTimeFilter',0
word_42D798	dw 0D0h			; DATA XREF: .rdata:0042BFA4o
		db 'PGPIntersectFilters',0
word_42D7AE	dw 0FEh			; DATA XREF: .rdata:0042BFA0o
		db 'PGPNewKeyCreationTimeFilter',0
word_42D7CC	dw 99h			; DATA XREF: .rdata:0042BF9Co
		db 'PGPGetPGPTimeFromStdTime',0
		align 4
word_42D7E8	dw 100h			; DATA XREF: .rdata:0042BF98o
		db 'PGPNewKeyEncryptAlgorithmFilter',0
word_42D80A	dw 104h			; DATA XREF: .rdata:0042BF94o
		db 'PGPNewKeyIDFilter',0
word_42D81E	dw 8Ah			; DATA XREF: .rdata:0042BF90o
		db 'PGPGetKeyIDFromString',0
word_42D836	dw 0ECh			; DATA XREF: .rdata:0042BF8Co
		db 'PGPNegateFilter',0
word_42D848	dw 19Ah			; DATA XREF: .rdata:0042BF88o
		db 'PGPUnionFilters',0
aPgp_sdk_dll	db 'PGP_SDK.dll',0      ; DATA XREF: .rdata:0042BD04o
word_42D866	dw 0Ch			; DATA XREF: .rdata:0042C168o
		db 'PGPclCloseClientPrefs',0
word_42D87E	dw 39h			; DATA XREF: .rdata:0042C16Co
		db 'PGPclOpenClientPrefs',0
		align 2
word_42D896	dw 3Dh			; DATA XREF: .rdata:0042C170o
		db 'PGPclQueryAddKeys',0
word_42D8AA	dw 15h			; DATA XREF: .rdata:0042C174o
		db 'PGPclErrorBox',0
word_42D8BA	dw 47h			; DATA XREF: .rdata:0042C178o
		db 'PGPclSearchServerForKeyIDs',0
		align 4
word_42D8D8	dw 21h			; DATA XREF: .rdata:0042C17Co
		db 'PGPclGetGroupsFromRootServer',0
		align 4
word_42D8F8	dw 4Fh			; DATA XREF: .rdata:0042C180o
		db 'PGPclSendGroupsToRootServer',0
word_42D916	dw 46h			; DATA XREF: .rdata:0042C184o
		db 'PGPclSaveGroupFile',0
		align 4
word_42D92C	dw 6Dh			; DATA XREF: .rdata:0042C188o
		db 'PGPkmPerformAction',0
		align 2
word_42D942	dw 71h			; DATA XREF: .rdata:0042C18Co
		db 'PGPkmSelectKey',0
		align 4
word_42D954	dw 0Dh			; DATA XREF: .rdata:0042C190o
		db 'PGPclCloseGroupFile',0
word_42D96A	dw 3Ah			; DATA XREF: .rdata:0042C194o
		db 'PGPclOpenGroupFile',0
		align 10h
word_42D980	dw 23h			; DATA XREF: .rdata:0042C198o
		db 'PGPclGetPGPPath',0
word_42D992	dw 2Eh			; DATA XREF: .rdata:0042C19Co
		db 'PGPclInitLibrary',0
		align 2
word_42D9A6	dw 0Eh			; DATA XREF: .rdata:0042C1A0o
		db 'PGPclCloseLibrary',0
word_42D9BA	dw 5Ah			; DATA XREF: .rdata:0042C1A4o
		db 'PGPclSplash',0
word_42D9C8	dw 31h			; DATA XREF: .rdata:0042C134o
		db 'PGPclIsExpired',0
		align 2
word_42D9DA	dw 58h			; DATA XREF: .rdata:0042C1ACo
		db 'PGPclSetSplashParent',0
		align 2
word_42D9F2	dw 0Bh			; DATA XREF: .rdata:0042C1B0o
		db 'PGPclCloseAdminPrefs',0
		align 2
word_42DA0A	dw 0Ah			; DATA XREF: .rdata:0042C148o
		db 'PGPclCheckSDKSupportForPKAlg',0
		align 2
word_42DA2A	dw 4Eh			; DATA XREF: .rdata:0042C14Co
		db 'PGPclSendCertificateRequestToServerNotify',0
word_42DA56	dw 50h			; DATA XREF: .rdata:0042C160o
		db 'PGPclSendKeysToRootServerNotify',0
word_42DA78	dw 41h			; DATA XREF: .rdata:0042C1C0o
		db 'PGPclRandom',0
word_42DA86	dw 5Eh			; DATA XREF: .rdata:off_42C128o
		db 'PGPclSystemTimeToDays',0
word_42DA9E	dw 3			; DATA XREF: .rdata:0042C1C8o
		db 'PGPGetKeyServerPrefs',0
		align 2
word_42DAB6	dw 1			; DATA XREF: .rdata:0042C12Co
		db 'PGPDisposeKeyServerPath',0
word_42DAD0	dw 0			; DATA XREF: .rdata:0042C130o
		db 'PGPCreateKeyServerPath',0
		align 2
word_42DAEA	dw 68h			; DATA XREF: .rdata:0042C1D4o
		db 'PGPkmGetSelectedColumns',0
word_42DB04	dw 6Ah			; DATA XREF: .rdata:0042C1D8o
		db 'PGPkmIsActionEnabled',0
		align 4
word_42DB1C	dw 4			; DATA XREF: .rdata:0042C1DCo
		db 'PGPGetKeyServerURL',0
		align 2
word_42DB32	dw 6Bh			; DATA XREF: .rdata:0042C1E0o
		db 'PGPkmLoadKeySet',0
word_42DB44	dw 62h			; DATA XREF: .rdata:0042C1E4o
		db 'PGPkmConfigure',0
		align 2
word_42DB56	dw 3Bh			; DATA XREF: .rdata:0042C1C4o
		db 'PGPclPreferences',0
		align 2
word_42DB6A	dw 5Fh			; DATA XREF: .rdata:0042C1CCo
		db 'PGPclUpdateKeySetFromServer',0
word_42DB88	dw 49h			; DATA XREF: .rdata:0042C1F0o
		db 'PGPclSearchServerWithFilter',0
word_42DBA6	dw 6Fh			; DATA XREF: .rdata:0042C1F4o
		db 'PGPkmReLoadKeySet',0
word_42DBBA	dw 1Fh			; DATA XREF: .rdata:0042C1F8o
		db 'PGPclGetCertificateRevocationsFromServer',0
		align 2
word_42DBE6	dw 3Ch			; DATA XREF: .rdata:0042C1FCo
		db 'PGPclPurgeCachedPassphrase',0
		align 4
word_42DC04	dw 6Eh			; DATA XREF: .rdata:0042C1E8o
		db 'PGPkmProcessKeyPropMessage',0
		align 2
word_42DC22	dw 72h			; DATA XREF: .rdata:0042C1D0o
		db 'PGPkmSynchronizeThreadAccessToSDK',0
word_42DC46	dw 70h			; DATA XREF: .rdata:0042C1ECo
		db 'PGPkmSelectColumns',0
		align 4
word_42DC5C	dw 60h			; DATA XREF: .rdata:0042C1B8o
		db 'PGPclWebBrowse',0
		align 2
word_42DC6E	dw 52h			; DATA XREF: .rdata:0042C164o
		db 'PGPclSendShares',0
word_42DC80	dw 8			; DATA XREF: .rdata:0042C1BCo
		db 'PGPclCheckAutoUpdate',0
		align 4
word_42DC98	dw 0Fh			; DATA XREF: .rdata:0042C1B4o
		db 'PGPclConfirmRemoteAuthentication',0
		align 4
word_42DCBC	dw 5Ch			; DATA XREF: .rdata:0042C150o
		db 'PGPclSyncKeySets',0
		align 10h
word_42DCD0	dw 65h			; DATA XREF: .rdata:0042C15Co
		db 'PGPkmDefaultNotificationProc',0
		align 10h
word_42DCF0	dw 66h			; DATA XREF: .rdata:0042C1A8o
		db 'PGPkmDestroyKeyManager',0
		align 2
word_42DD0A	dw 6Ch			; DATA XREF: .rdata:0042C158o
		db 'PGPkmOKToClose',0
		align 4
word_42DD1C	dw 67h			; DATA XREF: .rdata:0042C154o
		db 'PGPkmGetManagerWindow',0
word_42DD34	dw 64h			; DATA XREF: .rdata:0042C144o
		db 'PGPkmCreateKeyManagerEx',0
word_42DD4E	dw 2Dh			; DATA XREF: .rdata:0042C140o
		db 'PGPclHelpAbout',0
		align 10h
word_42DD60	dw 2			; DATA XREF: .rdata:0042C13Co
		db 'PGPFindEmailDomain',0
		align 2
word_42DD76	dw 5Dh			; DATA XREF: .rdata:0042C138o
		db 'PGPclSyncKeyserverPrefs',0
aPgpcl_dll	db 'PGPcl.dll',0        ; DATA XREF: .rdata:0042BD18o
word_42DD9A	dw 5			; DATA XREF: .rdata:off_42C24Co
		db 'PGPEstimatePassphraseQuality',0
		align 2
aPgpsdkui_dll	db 'PGPsdkUI.dll',0     ; DATA XREF: .rdata:0042BD2Co
		align 4
word_42DDC8	dw 3Bh			; DATA XREF: .rdata:0042C238o
		db 'PGPNewTLSContext',0
		align 4
word_42DDDC	dw 0Ch			; DATA XREF: .rdata:0042C244o
		db 'PGPFreeTLSContext',0
word_42DDF0	dw 2			; DATA XREF: .rdata:0042C240o
		db 'PGPCancelKeyServerCall',0
		align 2
word_42DE0A	dw 2Ch			; DATA XREF: .rdata:0042C23Co
		db 'PGPKeyServerCleanup',0
word_42DE20	dw 2Fh			; DATA XREF: .rdata:0042C228o
		db 'PGPKeyServerDisposeThreadStorage',0
		align 4
word_42DE44	dw 0Dh			; DATA XREF: .rdata:0042C234o
		db 'PGPFreeTLSSession',0
word_42DE58	dw 0Ah			; DATA XREF: .rdata:0042C230o
		db 'PGPFreeKeyServer',0
		align 4
word_42DE6C	dw 2Dh			; DATA XREF: .rdata:0042C22Co
		db 'PGPKeyServerClose',0
word_42DE80	dw 48h			; DATA XREF: .rdata:0042C20Co
		db 'PGPQueryKeyServer',0
word_42DE94	dw 31h			; DATA XREF: .rdata:0042C208o
		db 'PGPKeyServerOpen',0
		align 4
word_42DEA8	dw 3Ch			; DATA XREF: .rdata:0042C224o
		db 'PGPNewTLSSession',0
		align 4
word_42DEBC	dw 54h			; DATA XREF: .rdata:off_42C204o
		db 'PGPSetKeyServerEventHandler',0
word_42DEDA	dw 38h			; DATA XREF: .rdata:0042C214o
		db 'PGPNewKeyServerFromHostName',0
word_42DEF8	dw 2Eh			; DATA XREF: .rdata:0042C218o
		db 'PGPKeyServerCreateThreadStorage',0
word_42DF1A	dw 30h			; DATA XREF: .rdata:0042C210o
		db 'PGPKeyServerInit',0
		align 2
word_42DF2E	dw 65h			; DATA XREF: .rdata:0042C21Co
		db 'PGPtlsGetNegotiatedCipherSuite',0
		align 10h
word_42DF50	dw 66h			; DATA XREF: .rdata:0042C220o
		db 'PGPtlsGetRemoteAuthenticatedKey',0
aPgpsdknl_dll	db 'PGPsdkNL.dll',0     ; DATA XREF: .rdata:0042BD40o
		align 10h
word_42DF80	dw 329h			; DATA XREF: .rdata:0042BEE8o
		db 'lstrcmpA',0
		align 4
word_42DF8C	dw 1B4h			; DATA XREF: .rdata:0042BEE4o
		db 'HeapAlloc',0
word_42DF98	dw 1BAh			; DATA XREF: .rdata:0042BEE0o
		db 'HeapFree',0
		align 4
word_42DFA4	dw 2D3h			; DATA XREF: .rdata:0042BEDCo
		db 'TlsSetValue',0
word_42DFB2	dw 8Dh			; DATA XREF: .rdata:0042BED8o
		db 'ExitThread',0
		align 10h
word_42DFC0	dw 1BDh			; DATA XREF: .rdata:0042BED4o
		db 'HeapReAlloc',0
word_42DFCE	dw 166h			; DATA XREF: .rdata:0042BED0o
		db 'GetStartupInfoA',0
word_42DFE0	dw 18Eh			; DATA XREF: .rdata:0042BECCo
		db 'GetVersion',0
		align 2
word_42DFEE	dw 8Ch			; DATA XREF: .rdata:0042BEC8o
		db 'ExitProcess',0
word_42DFFC	dw 1C8h			; DATA XREF: .rdata:0042BEC4o
		db 'InterlockedDecrement',0
		align 4
word_42E014	dw 1CBh			; DATA XREF: .rdata:0042BEC0o
		db 'InterlockedIncrement',0
		align 4
word_42E02C	dw 28Ch			; DATA XREF: .rdata:0042BEBCo
		db 'SetEndOfFile',0
		align 4
word_42E03C	dw 128h			; DATA XREF: .rdata:0042BEB8o
		db 'GetFileType',0
word_42E04A	dw 37h			; DATA XREF: .rdata:0042BEB4o
		db 'CreateFileA',0
word_42E058	dw 5Ch			; DATA XREF: .rdata:0042BEB0o
		db 'DeleteFileA',0
word_42E066	dw 1FBh			; DATA XREF: .rdata:0042BEACo
		db 'MoveFileA',0
word_42E072	dw 1B8h			; DATA XREF: .rdata:0042BEA8o
		db 'HeapDestroy',0
word_42E080	dw 1B6h			; DATA XREF: .rdata:0042BEA4o
		db 'HeapCreate',0
		align 2
word_42E08E	dw 2F1h			; DATA XREF: .rdata:0042BEA0o
		db 'VirtualFree',0
word_42E09C	dw 2EEh			; DATA XREF: .rdata:0042BE9Co
		db 'VirtualAlloc',0
		align 4
word_42E0AC	dw 2D0h			; DATA XREF: .rdata:0042BE98o
		db 'TlsAlloc',0
		align 4
word_42E0B8	dw 29Ch			; DATA XREF: .rdata:0042BE94o
		db 'SetLastError',0
		align 4
word_42E0C8	dw 2D2h			; DATA XREF: .rdata:0042BE90o
		db 'TlsGetValue',0
word_42E0D6	dw 2CBh			; DATA XREF: .rdata:0042BE8Co
		db 'TerminateProcess',0
		align 2
word_42E0EA	dw 109h			; DATA XREF: .rdata:0042BE88o
		db 'GetCurrentProcess',0
word_42E0FE	dw 2DBh			; DATA XREF: .rdata:0042BE84o
		db 'UnhandledExceptionFilter',0
		align 2
word_42E11A	dw 257h			; DATA XREF: .rdata:0042BE80o
		db 'RtlUnwind',0
word_42E126	dw 153h			; DATA XREF: .rdata:0042BE7Co
		db 'GetProcAddress',0
		align 4
word_42E138	dw 301h			; DATA XREF: .rdata:0042BE78o
		db 'WideCharToMultiByte',0
word_42E14E	dw 189h			; DATA XREF: .rdata:0042BE74o
		db 'GetTimeZoneInformation',0
		align 4
word_42E168	dw 0C1h			; DATA XREF: .rdata:0042BF38o
		db 'FreeEnvironmentStringsA',0
word_42E182	dw 0C2h			; DATA XREF: .rdata:0042BF68o
		db 'FreeEnvironmentStringsW',0
word_42E19C	dw 119h			; DATA XREF: .rdata:0042BE70o
		db 'GetEnvironmentStrings',0
word_42E1B4	dw 11Bh			; DATA XREF: .rdata:0042BE6Co
		db 'GetEnvironmentStringsW',0
		align 2
word_42E1CE	dw 298h			; DATA XREF: .rdata:0042BF6Co
		db 'SetHandleCount',0
		align 10h
word_42E1E0	dw 168h			; DATA XREF: .rdata:0042BF48o
		db 'GetStdHandle',0
		align 10h
word_42E1F0	dw 30Eh			; DATA XREF: .rdata:0042BE64o
		db 'WriteFile',0
word_42E1FC	dw 202h			; DATA XREF: .rdata:0042BE60o
		db 'MultiByteToWideChar',0
word_42E212	dw 1DCh			; DATA XREF: .rdata:0042BE5Co
		db 'LCMapStringA',0
		align 2
word_42E222	dw 1DDh			; DATA XREF: .rdata:0042BE58o
		db 'LCMapStringW',0
		align 2
word_42E232	dw 169h			; DATA XREF: .rdata:0042BE54o
		db 'GetStringTypeA',0
		align 4
word_42E244	dw 16Ch			; DATA XREF: .rdata:0042BE50o
		db 'GetStringTypeW',0
		align 2
word_42E256	dw 2A8h			; DATA XREF: .rdata:0042BE4Co
		db 'SetStdHandle',0
		align 2
word_42E266	dw 295h			; DATA XREF: .rdata:0042BE48o
		db 'SetFilePointer',0
		align 4
word_42E278	dw 23Dh			; DATA XREF: .rdata:0042BE44o
		db 'ReadFile',0
		align 4
word_42E284	dw 0B9h			; DATA XREF: .rdata:0042BE40o
		db 'FlushFileBuffers',0
		align 4
word_42E298	dw 0CFh			; DATA XREF: .rdata:0042BE3Co
		db 'GetCPInfo',0
word_42E2A4	dw 0C9h			; DATA XREF: .rdata:0042BE38o
		db 'GetACP',0
		align 2
word_42E2AE	dw 146h			; DATA XREF: .rdata:0042BE34o
		db 'GetOEMCP',0
		align 2
word_42E2BA	dw 1DFh			; DATA XREF: .rdata:0042BE30o
		db 'LoadLibraryA',0
		align 2
word_42E2CA	dw 24h			; DATA XREF: .rdata:0042BE2Co
		db 'CompareStringA',0
		align 4
word_42E2DC	dw 25h			; DATA XREF: .rdata:0042BE28o
		db 'CompareStringW',0
		align 2
word_42E2EE	dw 28Dh			; DATA XREF: .rdata:off_42BE24o
		db 'SetEnvironmentVariableA',0
word_42E308	dw 101h			; DATA XREF: .rdata:0042C3A4o
		db 'GetDCEx',0
word_42E312	dw 0FCh			; DATA XREF: .rdata:0042C3A8o
		db 'GetCursor',0
word_42E31E	dw 3Bh			; DATA XREF: .rdata:0042C3ACo
		db 'ClientToScreen',0
		align 10h
word_42E330	dw 212h			; DATA XREF: .rdata:0042C3B0o
		db 'ScrollWindowEx',0
		align 2
word_42E342	dw 24Bh			; DATA XREF: .rdata:0042C3B4o
		db 'SetScrollInfo',0
word_42E352	dw 51h			; DATA XREF: .rdata:0042BE10o
		db 'DeleteDC',0
		align 2
word_42E35E	dw 17Eh			; DATA XREF: .rdata:0042BE1Co
		db 'GetTextMetricsA',0
word_42E370	dw 38h			; DATA XREF: .rdata:0042BE18o
		db 'CreateFontIndirectA',0
word_42E386	dw 44h			; DATA XREF: .rdata:0042BE14o
		db 'CreatePatternBrush',0
		align 4
word_42E39C	dw 2Ah			; DATA XREF: .rdata:0042BDE4o
		db 'CreateCompatibleBitmap',0
		align 2
word_42E3B6	dw 3Eh			; DATA XREF: .rdata:0042BDE0o
		db 'CreateHatchBrush',0
		align 2
word_42E3CA	dw 2Bh			; DATA XREF: .rdata:0042BE08o
		db 'CreateCompatibleDC',0
		align 10h
word_42E3E0	dw 176h			; DATA XREF: .rdata:0042BE04o
		db 'GetTextExtentPoint32A',0
word_42E3F8	dw 1EFh			; DATA XREF: .rdata:0042BE00o
		db 'SetPixel',0
		align 4
word_42E404	dw 1F8h			; DATA XREF: .rdata:0042BDFCo
		db 'SetTextAlign',0
		align 4
word_42E414	dw 18Ch			; DATA XREF: .rdata:0042BDF8o
		db 'LineDDA',0
word_42E41E	dw 1D7h			; DATA XREF: .rdata:0042BDF4o
		db 'SetBrushOrgEx',0
word_42E42E	dw 210h			; DATA XREF: .rdata:0042BDF0o
		db 'UnrealizeObject',0
word_42E440	dw 12h			; DATA XREF: .rdata:0042BDECo
		db 'BitBlt',0
		align 2
word_42E44A	dw 0F3h			; DATA XREF: .rdata:0042BF84o
		db 'PGPNewData',0
		align 4
word_42E458	dw 0E9h			; DATA XREF: .rdata:0042BF80o
		db 'PGPMemoryMgrIsValid',0
word_42E46E	dw 175h			; DATA XREF: .rdata:0042BF7Co
		db 'PGPReallocData',0
		align 1000h
_rdata		ends

; Section 3. (virtual address 0002F000)
; Virtual size			: 00002CF4 (  11508.)
; Section size in file		: 00002000 (   8192.)
; Offset to raw	data for section: 0002F000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 42F000h
dword_42F000	dd 0			; DATA XREF: __cinit+1Fo
dword_42F004	dd 0			; DATA XREF: __cinit+1Ao
dword_42F008	dd 0			; DATA XREF: __cinit+10o
		dd offset ___initstdio
		dd offset ___initmbctable
dword_42F014	dd 0			; DATA XREF: __cinit:loc_41E193o
dword_42F018	dd 0			; DATA XREF: _doexit+6Ao
		dd offset ___endstdio
		dd offset __rmtmp
dword_42F024	dd 0			; DATA XREF: _doexit:loc_41E23Co
dword_42F028	dd 0			; DATA XREF: _doexit+7Bo
dword_42F02C	dd 0			; DATA XREF: _doexit:loc_41E24Do
; CHAR aChoicelist[]
aChoicelist	db 'ChoiceList',0       ; DATA XREF: sub_401000+Ao
					; sub_401000+5Fo ...
		align 4
; CHAR aHwnd[]
aHwnd		db 'hwnd',0             ; DATA XREF: sub_401130+16o
					; sub_401260+1C6o ...
		align 4
; CHAR aOldproc[]
aOldproc	db 'oldproc',0          ; DATA XREF: sub_401130+Eo
					; sub_401130+7Fo ...
; CHAR aHwndtime[]
aHwndtime	db 'hwndTime',0         ; DATA XREF: sub_401260+110o
					; sub_4119D0+3Co ...
		align 4
; CHAR aSysdatetimepic[]
aSysdatetimepic	db 'SysDateTimePick32',0 ; DATA XREF: sub_401260+C0o
					; .text:00409E9Fo ...
		align 4
; CHAR aDatetime[]
aDatetime	db 'DateTime',0         ; DATA XREF: sub_401260+BBo
					; .text:00409E9Ao ...
		align 4
; CHAR String[]
String		db 'PGPM_RELOADKEYRING',0 ; DATA XREF: sub_402840+5Co
					; sub_405510+44o
		align 4
dword_42F08C	dd 3FAh, 0A29h,	415h, 0A2Ah, 2 dup(0) ;	DATA XREF: DialogFunc+C9o
					; DialogFunc+FDo
dword_42F0A4	dd 1, 0A8Dh, 3,	0A8Eh, 7, 0A8Fh, 2, 0A90h, 2 dup(0)
					; DATA XREF: sub_403920+58o
					; sub_403920+88o
; CHAR aTreelistctrl32[]
aTreelistctrl32	db 'TreeListCtrl32',0   ; DATA XREF: sub_404530+DCo
					; sub_414910+51o
		align 4
dword_42F0DC	dd 101h			; DATA XREF: sub_40B090+27Er
					; .text:loc_40E579r ...
; CHAR Text[]
Text		db 'PGPkeys is not supported on Windows NT 3.51',0Ah
					; DATA XREF: sub_4053B0+42o
		db 0Ah
		db 'Use at your own risk.',0
		align 4
; CHAR Caption[]
Caption		db 'PGPkeys Warning',0  ; DATA XREF: sub_4053B0+3Do
; CHAR aMswheel_rollms[]
aMswheel_rollms	db 'MSWHEEL_ROLLMSG',0  ; DATA XREF: sub_405510+75o
; CHAR aPgpm_purgepass[]
aPgpm_purgepass	db 'PGPM_PURGEPASSPHRASECACHE',0 ; DATA XREF: sub_405510+69o
		align 10h
; CHAR aPgpm_reloadk_0[]
aPgpm_reloadk_0	db 'PGPM_RELOADKEYSERVERPREFS',0 ; DATA XREF: sub_405510+5Do
		align 4
; CHAR aPgpm_reloadpre[]
aPgpm_reloadpre	db 'PGPM_RELOADPREFS',0 ; DATA XREF: sub_405510+51o
		align 10h
; CHAR Name[]
Name		db 'PGPkeysInstSem',0   ; DATA XREF: sub_405510+20o
		align 10h
; CHAR ClassName[]
ClassName	db 'PGPkeysMainWinClass',0 ; DATA XREF: sub_405510+1Bo
					; sub_405510+168o ...
; CHAR WindowName[]
WindowName	db 'PGPkeys',0          ; DATA XREF: sub_405510:loc_405526o
					; WinMain(x,x,x,x)+190o
dword_42F1BC	dd 1			; DATA XREF: sub_407120+BFw
					; sub_407120+414r ...
; CHAR aSS[]
aSS		db '%s <%s>',0          ; DATA XREF: sub_4085E0+4Ao
; CHAR ValueName[]
ValueName	db 'InstallPath',0      ; DATA XREF: sub_40C0F0+92o
dword_42F1D4	dd 1			; DATA XREF: .text:0040E513r
					; .text:0040E51Fw
; CHAR aMousez[]
aMousez		db 'MouseZ',0           ; DATA XREF: sub_410630+2Eo
		align 10h
; CHAR aMagellanMswhee[]
aMagellanMswhee	db 'Magellan MSWHEEL',0 ; DATA XREF: sub_410630+29o
		align 4
; CHAR aMsh_scroll_lin[]
aMsh_scroll_lin	db 'MSH_SCROLL_LINES_MSG',0 ; DATA XREF: sub_410630+1Eo
		align 4
dword_42F20C	dd 0			; DATA XREF: sub_4106C0+104o
					; sub_4109A0+1Fo ...
		dd 1, 3	dup(0)
		dd 1, 4	dup(0)
		dd 1, 2	dup(0)
; CHAR aToolbarwindow3[]
aToolbarwindow3	db 'ToolbarWindow32',0  ; DATA XREF: sub_4106C0+2Eo
					; sub_4106C0+13Bo ...
; CHAR aDesktop[]
aDesktop	db 'Desktop',0          ; DATA XREF: sub_410D90+55o
; CHAR SubKey[]
SubKey		db 'Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders',0
					; DATA XREF: sub_410D90+26o
		align 4
; CHAR aSearchpath[]
aSearchpath	db 'SearchPath',0       ; DATA XREF: sub_4114D0+104o
					; sub_4114D0+1A4o ...
		align 4
; CHAR aLastsearchtype[]
aLastsearchtype	db 'LastSearchType',0   ; DATA XREF: sub_411790+1B0o
					; sub_413820+6Bo ...
		align 4
aDate		db 'Date',0             ; DATA XREF: sub_4119D0+162o
		align 10h
; CHAR aDefaultfilterU[]
aDefaultfilterU	db 'DefaultFilter: Unknown Attribute',0 ; DATA XREF: sub_411C60+780o
		align 4
asc_42F2E4	db '',0Bh,0            ; DATA XREF: sub_412530+796o
		align 4
		dd 0AF1h, 421h,	0AF2h, 0BB9h, 0AF3h, 0BBAh, 0AF4h, 0BBDh
		dd 0AF5h, 0BBEh, 0AF6h,	0BBBh, 0AFBh, 0BBCh, 0AFCh, 437h
		dd 0AFDh, 2 dup(0)
; CHAR aKeyserverlock[]
aKeyserverlock	db 'KeyserverLock',0    ; DATA XREF: sub_412530:loc_4125C5o
					; sub_412530+2F9o ...
		align 4
; CHAR aSearchinfo[]
aSearchinfo	db 'SearchInfo',0       ; DATA XREF: sub_412530+66o
					; sub_412530+85Fo ...
		align 10h
; CHAR aOldheight[]
aOldheight	db 'oldHeight',0        ; DATA XREF: sub_412530+1Fo
					; sub_412530+60Fo ...
		align 4
; CHAR aOldwidth[]
aOldwidth	db 'oldWidth',0         ; DATA XREF: sub_412530+17o
					; sub_412530+36Bo ...
		align 4
aTestIsTheTime	db 'Test is the time',0 ; DATA XREF: sub_414980+29Eo
		align 4
; CHAR aTooltips_class[]
aTooltips_class	db 'tooltips_class32',0 ; DATA XREF: sub_414980+24Bo
		align 10h
; CHAR aSysheader32[]
aSysheader32	db 'SysHeader32',0      ; DATA XREF: sub_414980+20Eo
; CHAR CursorName[]
CursorName	db 'TreeListDraggingCursor',0 ; DATA XREF: sub_414980+114o
		align 4
; CHAR aMemoryAllocati[]
aMemoryAllocati	db 'Memory allocation failure',0 ; DATA XREF: sub_416830+1Bo
		align 10h
; CHAR aError[]
aError		db 'Error',0            ; DATA XREF: sub_416830+16o
		align 4
; char a___[4]
a___		db '...',0              ; DATA XREF: sub_4196F0+81o
					; sub_4199C0+8E5o ...
; CHAR aI[]
aI		db '%i',0               ; DATA XREF: sub_4199C0+95Co
		align 10h
aRb		db 'rb',0               ; DATA XREF: sub_41BB60+5o
		align 4
aAb		db 'ab+',0              ; DATA XREF: sub_41BBF0+5o
		align 10h
aUs		db 'u',0
		align 4
aSs		db 's',0
		align 4
off_42F3F8	dd offset __fpmath	; DATA XREF: __cinitr
off_42F3FC	dd offset nullsub_1	; DATA XREF: _threadstartex(x)+4Ar
off_42F400	dd offset nullsub_1	; DATA XREF: __endthreadexr
		align 10h
off_42F410	dd offset __exit	; DATA XREF: __amsg_exit+1Cr
dword_42F414	dd 2			; DATA XREF: __FF_MSGBANNER+Er
					; __NMSG_WRITE+46r ...
off_42F418	dd offset __ctype+2	; DATA XREF: sub_4173F0+25r _atol+23r	...
		dd offset __ctype+2
		public __ctype
; unsigned __int16 _ctype[]
__ctype		dd    200000h		; DATA XREF: _x_ismbbtype+18r
					; .data:off_42F418o ...
		unicode	0, <	    (((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(810081h), 0Ah dup(10001h), 3 dup(100010h), 3 dup(820082h)
		dd 0Ah dup(20002h), 2 dup(100010h), 20h, 40h dup(0)
dword_42F624	dd 1			; DATA XREF: sub_4173F0r
					; _atol:loc_41C184r ...
byte_42F628	db 2Eh			; DATA XREF: __forcdecpt:loc_41E6A9r
					; .text:0041E6C7r ...
		align 4
		dd 1
dword_42F630	dd 1			; DATA XREF: __dosmaperr+Eo
dword_42F634	dd 16h			; DATA XREF: __dosmaperr+3Er
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
dword_42F798	dd 2 dup(0)		; DATA XREF: __dosmaperr+1Bo
		dd 10h
; LPCRITICAL_SECTION dword_42F7A4
dword_42F7A4	dd 0			; DATA XREF: __lock+7r	__unlock+6r
; LPCRITICAL_SECTION off_42F7A8
off_42F7A8	dd offset dword_4304C8	; DATA XREF: __mtinitlocks_0+1Fr
		dd 7 dup(0)
; LPCRITICAL_SECTION off_42F7C8
off_42F7C8	dd offset dword_4304F8	; DATA XREF: __mtinitlocks_0+17r
		dd 3 dup(0)
; LPCRITICAL_SECTION off_42F7D8
off_42F7D8	dd offset dword_430510	; DATA XREF: __mtinitlocks_0+Fr
		dd 3 dup(0)
; LPCRITICAL_SECTION lpCriticalSection
lpCriticalSection dd offset dword_4304E0 ; DATA	XREF: __mtinitlocks_0+7r
		dd 1Eh dup(0)
dword_42F864	dd 3F8h			; DATA XREF: __heap_alloc+5r
					; _realloc+55r	...
; DWORD	dwTlsIndex
dwTlsIndex	dd 0FFFFFFFFh		; DATA XREF: _threadstartex(x)+2Ar
					; __mtinit+Fw ...
		align 10h
dword_42F870	dd 0C0000005h, 0Bh, 0	; DATA XREF: __initptd+4o
					; __freeptd+7Bo
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_42F8E8	dd 3			; DATA XREF: __XcptFilter+62r
					; __XcptFilter+86r
dword_42F8EC	dd 7			; DATA XREF: __XcptFilter+68r
					; __XcptFilter+8Cr
		dd 78h
dword_42F8F4	dd 0Ah			; DATA XREF: _xcptlookup+4r
dword_42F8F8	dd 19930520h, 3	dup(0)	; DATA XREF: .text:0041E4EFo
					; __NLG_Notify+2o
off_42F908	dd offset __fptrap	; DATA XREF: __cfltcvt_init+Fw
off_42F90C	dd offset __fptrap	; DATA XREF: __cfltcvt_init+5w
off_42F910	dd offset __fptrap	; DATA XREF: __cfltcvt_init+14w
off_42F914	dd offset __fptrap	; DATA XREF: __cfltcvt_init+1Ew
off_42F918	dd offset __fptrap	; DATA XREF: __cfltcvt_init+28w
off_42F91C	dd offset __fptrap	; DATA XREF: __cfltcvt_init+32w
dword_42F920	dd 7080h		; DATA XREF: __make_time_t+18Ar
					; _localtime+28r ...
dword_42F924	dd 1			; DATA XREF: _localtime+3Ar
					; __tzset_lk+A2w ...
dword_42F928	dd 0FFFFF1F0h		; DATA XREF: __make_time_t:loc_41C3C4r
					; _localtime+59r ...
dword_42F92C	dd 545350h, 0Fh	dup(0)	; DATA XREF: .data:lpMultiByteStro
dword_42F96C	dd 544450h, 0Fh	dup(0)	; DATA XREF: .data:off_42F9B0o
; LPSTR	lpMultiByteStr
lpMultiByteStr	dd offset dword_42F92C	; DATA XREF: __tzset_lk+D0r
					; __tzset_lk+EFr ...
; LPSTR	off_42F9B0
off_42F9B0	dd offset dword_42F96C	; DATA XREF: __tzset_lk+109r
					; __tzset_lk+130r ...
		align 8
dword_42F9B8	dd 0FFFFFFFFh		; DATA XREF: __tzset_lk+1Dw
					; __isindst_0+1Er ...
dword_42F9BC	dd 0			; DATA XREF: __isindst_0:loc_41F138r
					; _cvtdate+BFw
dword_42F9C0	dd 0			; DATA XREF: __isindst_0+192r
					; _cvtdate+E0w
		align 8
dword_42F9C8	dd 0FFFFFFFFh		; DATA XREF: __tzset_lk+16w
					; __isindst_0+26r ...
dword_42F9CC	dd 0			; DATA XREF: __isindst_0+13Ar
					; _cvtdate+EAw	...
dword_42F9D0	dd 0			; DATA XREF: __isindst_0+1A1r
					; _cvtdate+23r	...
dword_42F9D4	dd 0FFFFFFFFh		; DATA XREF: _gmtime+86o _cvtdate+84r
		dd 1Eh,	3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h,	0F3h, 111h, 130h
		dd 14Eh
dword_42FA04	dd 16Dh			; DATA XREF: _cvtdate+2Er
					; _cvtdate:loc_41F25Cr
dword_42FA08	dd 0FFFFFFFFh		; DATA XREF: __make_time_t+68r
					; _gmtime+9Ao ...
		dd 1Eh,	3Ah, 59h, 77h, 96h, 0B4h, 0D3h,	0F2h, 110h, 12Fh
		dd 14Dh, 16Ch, 0
		dd 0FFFFFFFFh, 0A00h, 8	dup(0)
dword_42FA68	dd 2			; DATA XREF: __NMSG_WRITE+Eo
					; __NMSG_WRITE+28r
off_42FA6C	dd offset aR6002FloatingP ; DATA XREF: __NMSG_WRITE+FCr
					; __NMSG_WRITE+12Do
					; "R6002\r\n- floating point not loaded\r\"...
		dd 8, 42B96Ch, 9, 42B940h, 0Ah,	42B91Ch, 10h, 42B8F0h
		dd 11h,	42B8C0h, 12h, 42B89Ch, 13h, 42B870h, 18h, 42B838h
		dd 19h,	42B810h, 1Ah, 42B7D8h, 1Bh, 42B7A0h, 1Ch, 42B778h
		dd 78h,	42B768h, 79h, 42B758h, 7Ah, 42B748h, 0FCh, 42B744h
		dd 0FFh, 42B734h
dword_42FAF8	dd 2 dup(43h), 20h dup(0) ; DATA XREF: __NMSG_WRITE+1Bo
		dd 43h,	23h dup(0)
off_42FC10	dd offset dword_430BA0	; DATA XREF: ___initstdio+55o
					; __lock_file+4o ...
		align 8
		dd offset dword_430BA0
		dd 101h
dword_42FC20	dd 2 dup(0)		; DATA XREF: ___initstdio+72o
		dd 1000h, 4 dup(0)
		dd 2, 1, 6 dup(0)
		dd 2 dup(2), 7 dup(0)
dword_42FC80	dd 7Ch dup(0)		; DATA XREF: ___initstdio+9Eo
dword_42FE70	dd 8 dup(0)		; DATA XREF: __lock_file+Do
					; __unlock_file+Do
dword_42FE90	dd 2 dup(1), 42BAB8h, 42BAA8h ;	DATA XREF: ___initstdio+69o
dword_42FEA0	dd 400h, 0FFFFFC01h, 35h, 0Bh, 40h, 3FFh ; DATA	XREF: sub_421422o
dword_42FEB8	dd 80h,	0FFFFFF81h, 18h, 8, 20h, 7Fh ; DATA XREF: sub_421438o
byte_42FED0	db 1			; DATA XREF: __setmbcp+EDr
		db 2, 4, 8
		align 8
dword_42FED8	dd 3A4h			; DATA XREF: __setmbcp+38o
aVyv		db '`y!',0            ; DATA XREF: __setmbcp+129o
		align 8
aJ		db '',0               ; DATA XREF: __setmbcp+CCo
		align 10h
aBe		db '',0
		align 8
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
dword_42FFC8	dd 2 dup(0)		; DATA XREF: __setmbcp+45o
		dd offset off_42FFD8
		align 8
off_42FFD8	dd offset aSun		; DATA XREF: .data:0042FFD0o
					; "Sun"
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
		dd offset aSunday	; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
		dd offset aJanuary	; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
		dd offset aAm		; "AM"
		dd offset aPm		; "PM"
		dd offset aMDYy		; "M/d/yy"
		dd offset aDdddMmmmDdYyyy ; "dddd, MMMM	dd, yyyy"
		dd offset aHMmSs	; "H:mm:ss"
		align 8
dword_430088	dd 2Eh,	0		; DATA XREF: .data:00430090o
		dd offset dword_430088
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd offset dword_430834
		dd 2 dup(7F7F7F7Fh), 430090h, 3	dup(0)
dword_4300D0	dd 2 dup(0)		; DATA XREF: ___multtenpow12+7o
		dd 4002A000h, 2	dup(0)
		dd 4005C800h, 2	dup(0)
		dd 4008FA00h, 2	dup(0)
		dd 400C9C40h, 2	dup(0)
		dd 400FC350h, 2	dup(0)
		dd 4012F424h, 0
		dd 80000000h, 40169896h, 0
		dd 20000000h, 4019BEBCh, 0
		dd 0C9BF0400h, 40348E1Bh, 0A1000000h, 1BCECCEDh, 404ED3C2h
		dd 0B59EF020h, 0ADA82B70h, 40699DC5h, 25FD5DD0h, 4F8E1AE5h
		dd 4083EB19h, 95D79671h, 8D050E43h, 409EAF29h, 44A0BFF9h
		dd 8F1281EDh, 40B98281h, 0A6D53CBFh, 1F49FFCFh,	40D3C278h
		dd 8CE0C66Fh, 47C980E9h, 41A893BAh, 556B85BCh, 0F78D3927h
		dd 427CE070h, 0DE8EDDBCh, 0EBFB9DF9h, 4351AA7Eh, 0E376E6A1h
		dd 2F29F2CCh, 44268184h, 0AA171028h, 0E310AEF8h, 44FAC4C5h
		dd 0F3D4A7EBh, 4AE1EBF7h, 45CF957Ah, 91C7CC65h,	0A0AEA60Eh
		dd 46A3E319h, 0C17650Dh, 75868175h, 4D48C976h, 0A7E44258h
		dd 353B3993h, 53EDB2B8h, 5DE5A74Dh, 3B5DC53Dh, 5A929E8Bh
		dd 0F0A65DFFh, 54C020A1h, 61378CA5h, 5A8BFDD1h,	5D25D88Bh
		dd 67DBF989h, 0F3F895AAh, 0C8A2BF27h, 6E80DD5Dh, 979BC94Ch
		dd 52028A20h, 7525C460h, 0
dword_430230	dd 0CCCDCCCDh, 0CCCCCCCCh, 3FFBCCCCh, 0D70A3D71h, 0A3D70A3h
					; DATA XREF: ___multtenpow12+1Bo
		dd 3FF8A3D7h, 0DF3B645Ah, 6E978D4Fh, 3FF58312h,	652CD3C3h
		dd 1758E219h, 3FF1D1B7h, 84230FD0h, 0AC471B47h,	3FEEA7C5h
		dd 69B6A640h, 0BD05AF6Ch, 3FEB8637h, 42BC3D33h,	94D5E57Ah
		dd 3FE7D6BFh, 0CEFDFDC2h, 77118461h, 3FE4ABCCh,	0E15B4C2Fh
		dd 94BEC44Dh, 3FC9E695h, 3B53C492h, 14CD4475h, 3FAF9ABEh
		dd 94BA67DEh, 1EAD4539h, 3F94CFB1h, 0E2C62324h,	313BBABCh
		dd 3F7A8B61h, 0C1595561h, 7C53B17Eh, 3F5FBB12h,	8D2FEED7h
		dd 8592BE06h, 3F44FB15h, 0E9A53F24h, 0EA27A539h, 3F2AA87Fh
		dd 0E4A1AC7Dh, 467C64BCh, 3E55DDD0h, 0CC067B63h, 83775423h
		dd 3D8191FFh, 193AFA91h, 4325637Ah, 3CACC031h, 38D18921h
		dd 0B8974782h, 3BD7FD00h, 85888DCh, 0E3E8B11Bh,	3B03A686h
		dd 424584C6h, 7599B607h, 3A2EDB37h, 0D21C7133h,	0EE32DB23h
		dd 395A9049h, 0C0BE87A6h, 82A5DA57h, 32B5A2A6h,	11B268E2h
		dd 449F52A7h, 2C10B759h, 2DE44925h, 534F3436h, 256BCEAEh
		dd 0A404598Fh, 7DC2DEC0h, 1EC6E8FBh, 5A88E79Eh,	0BF3C9157h
		dd 18228350h, 62654B4Eh, 0AF8F83FDh, 117D9406h,	9FDE2DE4h
		dd 4C8D2CEh, 0AD8A6DDh,	0
; HWND hWndFrom
hWndFrom	dd 0			; DATA XREF: sub_401260+11Dw
					; sub_401260+18Cr ...
; CHAR byte_430394[4]
byte_430394	db 4 dup(0)		; DATA XREF: sub_402F70+BEo
					; sub_4040F0+10Eo ...
dword_430398	dd 0			; DATA XREF: sub_404810+23w
					; sub_404810+3FBr ...
; HHOOK	dword_43039C
dword_43039C	dd 0			; DATA XREF: sub_4056D0+1Br
					; WinMain(x,x,x,x)+87w	...
; HHOOK	hhk
hhk		dd 0			; DATA XREF: fn+16r
					; WinMain(x,x,x,x)+6Ew	...
; UINT Msg
Msg		dd 0			; DATA XREF: sub_405510+56w
					; sub_40C340+4Br ...
dword_4303A8	dd 0			; DATA XREF: sub_405510+62w
					; .text:loc_40F78Ar
dword_4303AC	dd 0			; DATA XREF: sub_405510+6Ew
					; .text:loc_40F90Ar
dword_4303B0	dd 0			; DATA XREF: sub_405510+7Aw
					; .text:loc_40F965r
dword_4303B4	dd 0			; DATA XREF: sub_405510+8Bw
					; .text:loc_40F709r
dword_4303B8	dd 0			; DATA XREF: sub_405510+D9o
					; WinMain(x,x,x,x)+27Dr ...
byte_4303BC	db 0			; DATA XREF: WinMain(x,x,x,x)+105o
					; sub_40C1A0+37r ...
byte_4303BD	db 0			; DATA XREF: WinMain(x,x,x,x)+116o
					; sub_40C1A0+8Fr ...
		align 10h
dword_4303C0	dd 0			; DATA XREF: sub_40B090:loc_40B305r
					; .text:loc_40DD5Cr ...
; void *dword_4303C4
dword_4303C4	dd 0			; DATA XREF: sub_405700+1r
					; sub_405730+4Er ...
dword_4303C8	dd 0			; DATA XREF: sub_4078B0+154w
					; sub_4078B0+565r ...
; HHOOK	dword_4303CC
dword_4303CC	dd 0			; DATA XREF: sub_405FB0+26w
					; __mtinitlocks+32r
dword_4303D0	dd 0			; DATA XREF: sub_4078B0+14Ew
					; sub_4078B0+1B5w ...
; HHOOK	dword_4303D4
dword_4303D4	dd 0			; DATA XREF: sub_405FB0+59w
					; __mtinitlocks+18r
dword_4303D8	dd 0			; DATA XREF: sub_4078B0+148w
					; sub_4078B0+1B0r ...
dword_4303DC	dd 0			; DATA XREF: sub_405B40+28w
					; sub_405B80+38Er ...
; HGDIOBJ ho
ho		dd 0			; DATA XREF: sub_407120+346r
					; sub_407120+3AFw ...
; HHOOK	dword_4303E4
dword_4303E4	dd 0			; DATA XREF: __mtinitlocksr
; HHOOK	dword_4303E8
dword_4303E8	dd 0			; DATA XREF: sub_405FB0+6Aw
					; sub_405FB0+72w ...
; LONG lpPrevWndFunc
lpPrevWndFunc	dd 0			; DATA XREF: sub_407120:loc_407446r
					; sub_407120+39Cw ...
; HHOOK	dword_4303F0
dword_4303F0	dd 0			; DATA XREF: sub_405FB0+37w
					; __mtinitlocks+29r
; HGDIOBJ dword_4303F4
dword_4303F4	dd 0			; DATA XREF: sub_408DD0+46Cr
					; sub_408DD0+519w ...
; HHOOK	dword_4303F8
dword_4303F8	dd 0			; DATA XREF: sub_405FB0+48w
					; __mtinitlocks+21r
; LONG dword_4303FC
dword_4303FC	dd 0			; DATA XREF: sub_408DD0+458r
					; sub_408DD0+4F1w ...
; HWND dword_430400
dword_430400	dd 0			; DATA XREF: sub_405B40+1Ew
					; sub_405B80+304w ...
; LPCSTR lpString
lpString	dd 0			; DATA XREF: sub_407120+16Dr
					; sub_407120+17Fw ...
; LPCSTR dword_430408
dword_430408	dd 0			; DATA XREF: sub_408DD0:loc_408F9Cr
					; sub_408DD0+1DEw ...
dword_43040C	dd 0			; DATA XREF: sub_407120+199w
					; sub_4075E0+98r ...
dword_430410	dd 0			; DATA XREF: sub_408DD0+1F8w
					; .text:00409658r
dword_430414	dd 0			; DATA XREF: sub_406360+2CDo
					; sub_406360+2DBr
dword_430418	dd 0			; DATA XREF: sub_406A90+1A3r
					; sub_406A90+2D7o ...
dword_43041C	dd 0			; DATA XREF: .text:loc_40D36Br
					; .text:0040F56Dw
dword_430420	dd 0			; DATA XREF: .text:0040D374o
					; .text:loc_40D56Br
dword_430424	dd 0			; DATA XREF: .text:0040E4F0w
					; .text:0040E6DBw ...
dword_430428	dd 0			; DATA XREF: .text:loc_40CFA3w
					; .text:0040D3CBr ...
dword_43042C	dd 0			; DATA XREF: .text:0040D284o
					; .text:loc_40EE3Er ...
; HIMAGELIST himl
himl		dd 0			; DATA XREF: .text:0040D186r
					; .text:0040D1E6w ...
		align 8
dword_430438	dd 0			; DATA XREF: sub_4114A0+19w
dword_43043C	dd 0			; DATA XREF: sub_412530+FC5w
dword_430440	dd 0			; DATA XREF: sub_412530+FD7w
dword_430444	dd 0			; DATA XREF: sub_412530+349r
					; sub_412530+1009w
		dd 11h dup(0)
dword_43048C	dd 0			; DATA XREF: __fpmath+Aw
; char *dword_430490
dword_430490	dd 0			; DATA XREF: start+96w
					; __setenvp:loc_41F68Fr ...
		align 8
dword_430498	dd 0			; DATA XREF: __amsg_exitr
					; _fast_error_exitr ...
		dd 8 dup(0)
dword_4304BC	dd 0			; DATA XREF: _mallocr
					; _realloc:loc_41C50Dr	...
dword_4304C0	dd 0			; DATA XREF: __callnewhr
		align 8
dword_4304C8	dd 6 dup(0)		; DATA XREF: .data:off_42F7A8o
dword_4304E0	dd 6 dup(0)		; DATA XREF: .data:lpCriticalSectiono
dword_4304F8	dd 6 dup(0)		; DATA XREF: .data:off_42F7C8o
dword_430510	dd 6 dup(0)		; DATA XREF: .data:off_42F7D8o
dword_430528	dd 0			; DATA XREF: __sopen+13Ar
dword_43052C	dd 0			; DATA XREF: start+52w
dword_430530	dd 0			; DATA XREF: start+49w
dword_430534	dd 0			; DATA XREF: start+3Ew
dword_430538	dd 0			; DATA XREF: start+30w
dword_43053C	dd 0			; DATA XREF: __setargv+91w
dword_430540	dd 0			; DATA XREF: __setargv+89w
		align 8
; void *dword_430548
dword_430548	dd 0			; DATA XREF: __setenvp+44w _getenv+9r	...
dword_43054C	dd 0			; DATA XREF: ___crtsetenv+36r
dword_430550	dd 0			; DATA XREF: _getenv+16r
					; ___wtomb_environ+4r ...
		align 8
dword_430558	dd 0			; DATA XREF: __setargv+2Ew
		align 10h
byte_430560	db 0			; DATA XREF: _doexit+32w
					; ___endstdio+5r
		align 4
dword_430564	dd 0			; DATA XREF: _doexit+2Cw
dword_430568	dd 0			; DATA XREF: _doexit+9r _doexit+97w
		align 10h
dword_430570	dd 0Ah dup(0)		; DATA XREF: _gmtime+30o
dword_430598	dd 0			; DATA XREF: __tzset_lk+24w
					; __tzset_lk+7Aw ...
		align 10h
; struct _TIME_ZONE_INFORMATION	TimeZoneInformation
TimeZoneInformation _TIME_ZONE_INFORMATION <0> ; DATA XREF: __tzset_lk+47o
					; __tzset_lk+5Dr ...
; char *dword_43064C
dword_43064C	dd 0			; DATA XREF: __tzset_lk+147r
					; __tzset_lk:loc_41EEBDr ...
dword_430650	dd 0			; DATA XREF: ___tzsetr	___tzset+10r ...
; CHAR Filename[260]
Filename	db 104h	dup(0)		; DATA XREF: __setargv:loc_41F74Do
dword_430758	dd 0			; DATA XREF: ___crtGetEnvironmentStringsA+2r
					; ___crtGetEnvironmentStringsA+23w ...
dword_43075C	dd 0			; DATA XREF: __FF_MSGBANNER+21r
		dd 3 dup(0)
dword_43076C	dd 2 dup(0)		; DATA XREF: __strcmpi+Co
					; __strnicmp+17o
; LCID Locale
Locale		dd 0			; DATA XREF: _tolower+3r _tolower_0+4r ...
		dd 3 dup(0)
; UINT CodePage
CodePage	dd 0			; DATA XREF: __tzset_lk+DEr
					; __tzset_lk+117r ...
		dd 0
dword_43078C	dd 0			; DATA XREF: ___crtLCMapStringA+28r
					; ___crtLCMapStringA+4Cw ...
dword_430790	dd 0			; DATA XREF: ___crtGetStringTypeA+26r
					; ___crtGetStringTypeA:loc_42008Bw
dword_430794	dd 0			; DATA XREF: __sopen+3Fr
dword_430798	dd 0			; DATA XREF: __openfile+154w
dword_43079C	dd 0			; DATA XREF: __openfile+7r
		dd 0
dword_4307A4	dd 0			; DATA XREF: __setmbcp:loc_421A96r
					; _getSystemCP+4w ...
dword_4307A8	dd 0			; DATA XREF: ___crtMessageBoxA+3r
					; ___crtMessageBoxA+2Ew ...
dword_4307AC	dd 0			; DATA XREF: ___crtMessageBoxA+43w
					; ___crtMessageBoxA:loc_421D56r
dword_4307B0	dd 0			; DATA XREF: ___crtMessageBoxA+4Aw
					; ___crtMessageBoxA+60r
		dd 20h dup(0)
dword_430834	dd 2 dup(0)		; DATA XREF: .data:00430094o
					; .data:00430098o ...
dword_43083C	dd 0			; DATA XREF: ___crtCompareStringA+28r
					; ___crtCompareStringA+48w ...
		dd 2 dup(0)
; HINSTANCE hModule
hModule		dd 0			; DATA XREF: sub_401260+8Er
					; sub_402000+4r ...
dword_43084C	dd 0			; DATA XREF: WinMain(x,x,x,x)+128o
					; .text:0040CEB0r
dword_430850	dd 0			; DATA XREF: sub_405510+81o
					; sub_405510:loc_4055E4r ...
dword_430854	dd 0			; DATA XREF: WinMain(x,x,x,x)+131o
					; .text:loc_40E55Fr
; HWND hWnd
hWnd		dd 0			; DATA XREF: WinMain(x,x,x,x)+1A4w
					; WinMain(x,x,x,x)+1BBr ...
		align 10h
; CHAR szHelp[260]
szHelp		db 104h	dup(0)		; DATA XREF: sub_4054C0+Bo
					; sub_4054C0+37o ...
dword_430964	dd 0			; DATA XREF: WinMain(x,x,x,x)+123o
					; .text:0040CE89r
; UINT dword_430968
dword_430968	dd 0			; DATA XREF: __setmbcp+1Br
					; __setmbcp+79w ...
		align 10h
dword_430970	dd 3 dup(0)		; DATA XREF: __setmbcp+12Fo
					; __setmbcp+179o ...
dword_43097C	dd 0			; DATA XREF: __setmbcp+114w
					; __setmbcp+168w ...
byte_430980	db 0			; DATA XREF: _setSBUpLow:loc_421C72w
					; _setSBUpLow:loc_421C8Fw ...
		align 4
		dd 3Fh dup(0)
byte_430A80	db 0			; DATA XREF: __setmbcp+6Eo
					; __setmbcp+BEo ...
byte_430A81	db 0			; DATA XREF: _parse_cmdline+3Fr
					; _parse_cmdline+84r ...
		align 4
		dd 40h dup(0)
; LCID dword_430B84
dword_430B84	dd 0			; DATA XREF: __setmbcp+64w
					; __setmbcp+137w ...
dword_430B88	dd 0			; DATA XREF: _flsall:loc_41D293r
					; _flsall+32r ...
		align 20h
dword_430BA0	dd 118h	dup(0)		; DATA XREF: .data:off_42FC10o
					; .data:0042FC18o
		dd 2E8h	dup(?)
; size_t dword_431BA0
dword_431BA0	dd ?			; DATA XREF: _flsall+11r _flsall+85r ...
dword_431BA4	dd ?			; DATA XREF: _tolower+2Cr
					; __strcmpi+5Ar ...
; volatile LONG	Addend
Addend		dd ?			; DATA XREF: _tolower+1Fo
					; __strcmpi:notclocalew ...
		align 20h
dword_431BC0	dd ?			; DATA XREF: __close+17r
					; __close_lk+5Fr ...
dword_431BC4	dd 3Fh dup(?)		; DATA XREF: __ioinit+98o
; UINT uNumber
uNumber		dd ?			; DATA XREF: __close+5r __ioinit+28w ...
dword_431CC4	dd ?			; DATA XREF: __setenvp+ADw _getenvr
dword_431CC8	dd ?			; DATA XREF: __wincmdlnr __setenvp+3r	...
dword_431CCC	dd ?			; DATA XREF: _doexit+43r
dword_431CD0	dd ?			; DATA XREF: _doexit+3Ar _doexit+5Cr
dword_431CD4	dd ?			; DATA XREF: ___sbh_heap_init+32w
					; ___sbh_alloc_new_region+5r ...
dword_431CD8	dd ?			; DATA XREF: ___sbh_free_block+239r
					; ___sbh_free_block+259r ...
dword_431CDC	dd ?			; DATA XREF: ___sbh_heap_init+2Dw
					; ___sbh_free_block+310w ...
; void *dword_431CE0
dword_431CE0	dd ?			; DATA XREF: ___sbh_heap_init:loc_41D46Bw
					; ___sbh_free_block+22Cr ...
dword_431CE4	dd ?			; DATA XREF: ___sbh_heap_init+24w
					; ___sbh_find_blockr ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: ___sbh_heap_init+15w
					; ___sbh_find_block+8r	...
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: __heap_alloc+3Fr
					; _free+3Ar ...
dword_431CF0	dd ?			; DATA XREF: start+8Cw	__wincmdln+Fr ...
		align 400h
_data		ends


		end start
